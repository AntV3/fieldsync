function Zk(t,e){for(var r=0;r<e.length;r++){const a=e[r];if(typeof a!="string"&&!Array.isArray(a)){for(const n in a)if(n!=="default"&&!(n in t)){const i=Object.getOwnPropertyDescriptor(a,n);i&&Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:()=>a[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var BU=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $v(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Qk(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function a(){var n=!1;try{n=this instanceof a}catch{}return n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(a){var n=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(r,a,n.get?n:{enumerable:!0,get:function(){return t[a]}})}),r}var ng={exports:{}},C0={};var f_;function eA(){if(f_)return C0;f_=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(a,n,i){var o=null;if(i!==void 0&&(o=""+i),n.key!==void 0&&(o=""+n.key),"key"in n){i={};for(var c in n)c!=="key"&&(i[c]=n[c])}else i=n;return n=i.ref,{$$typeof:t,type:a,key:o,ref:n!==void 0?n:null,props:i}}return C0.Fragment=e,C0.jsx=r,C0.jsxs=r,C0}var h_;function tA(){return h_||(h_=1,ng.exports=eA()),ng.exports}var p=tA(),ig={exports:{}},yr={};var d_;function rA(){if(d_)return yr;d_=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),y=Symbol.iterator;function g(Q){return Q===null||typeof Q!="object"?null:(Q=y&&Q[y]||Q["@@iterator"],typeof Q=="function"?Q:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,E={};function A(Q,N,M){this.props=Q,this.context=N,this.refs=E,this.updater=M||b}A.prototype.isReactComponent={},A.prototype.setState=function(Q,N){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,N,"setState")},A.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function O(){}O.prototype=A.prototype;function T(Q,N,M){this.props=Q,this.context=N,this.refs=E,this.updater=M||b}var R=T.prototype=new O;R.constructor=T,w(R,A.prototype),R.isPureReactComponent=!0;var H=Array.isArray;function z(){}var F={H:null,A:null,T:null,S:null},W=Object.prototype.hasOwnProperty;function D(Q,N,M){var B=M.ref;return{$$typeof:t,type:Q,key:N,ref:B!==void 0?B:null,props:M}}function Y(Q,N){return D(Q.type,N,Q.props)}function I(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function L(Q){var N={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(M){return N[M]})}var ee=/\/+/g;function oe(Q,N){return typeof Q=="object"&&Q!==null&&Q.key!=null?L(""+Q.key):N.toString(36)}function ge(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(z,z):(Q.status="pending",Q.then(function(N){Q.status==="pending"&&(Q.status="fulfilled",Q.value=N)},function(N){Q.status==="pending"&&(Q.status="rejected",Q.reason=N)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function ie(Q,N,M,B,q){var K=typeof Q;(K==="undefined"||K==="boolean")&&(Q=null);var se=!1;if(Q===null)se=!0;else switch(K){case"bigint":case"string":case"number":se=!0;break;case"object":switch(Q.$$typeof){case t:case e:se=!0;break;case d:return se=Q._init,ie(se(Q._payload),N,M,B,q)}}if(se)return q=q(Q),se=B===""?"."+oe(Q,0):B,H(q)?(M="",se!=null&&(M=se.replace(ee,"$&/")+"/"),ie(q,N,M,"",function(Se){return Se})):q!=null&&(I(q)&&(q=Y(q,M+(q.key==null||Q&&Q.key===q.key?"":(""+q.key).replace(ee,"$&/")+"/")+se)),N.push(q)),1;se=0;var me=B===""?".":B+":";if(H(Q))for(var we=0;we<Q.length;we++)B=Q[we],K=me+oe(B,we),se+=ie(B,N,M,K,q);else if(we=g(Q),typeof we=="function")for(Q=we.call(Q),we=0;!(B=Q.next()).done;)B=B.value,K=me+oe(B,we++),se+=ie(B,N,M,K,q);else if(K==="object"){if(typeof Q.then=="function")return ie(ge(Q),N,M,B,q);throw N=String(Q),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.")}return se}function he(Q,N,M){if(Q==null)return Q;var B=[],q=0;return ie(Q,B,"","",function(K){return N.call(M,K,q++)}),B}function de(Q){if(Q._status===-1){var N=Q._result;N=N(),N.then(function(M){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=M)},function(M){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=M)}),Q._status===-1&&(Q._status=0,Q._result=N)}if(Q._status===1)return Q._result.default;throw Q._result}var Z=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var N=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent(N))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)},Ne={map:he,forEach:function(Q,N,M){he(Q,function(){N.apply(this,arguments)},M)},count:function(Q){var N=0;return he(Q,function(){N++}),N},toArray:function(Q){return he(Q,function(N){return N})||[]},only:function(Q){if(!I(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}};return yr.Activity=v,yr.Children=Ne,yr.Component=A,yr.Fragment=r,yr.Profiler=n,yr.PureComponent=T,yr.StrictMode=a,yr.Suspense=u,yr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,yr.__COMPILER_RUNTIME={__proto__:null,c:function(Q){return F.H.useMemoCache(Q)}},yr.cache=function(Q){return function(){return Q.apply(null,arguments)}},yr.cacheSignal=function(){return null},yr.cloneElement=function(Q,N,M){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var B=w({},Q.props),q=Q.key;if(N!=null)for(K in N.key!==void 0&&(q=""+N.key),N)!W.call(N,K)||K==="key"||K==="__self"||K==="__source"||K==="ref"&&N.ref===void 0||(B[K]=N[K]);var K=arguments.length-2;if(K===1)B.children=M;else if(1<K){for(var se=Array(K),me=0;me<K;me++)se[me]=arguments[me+2];B.children=se}return D(Q.type,q,B)},yr.createContext=function(Q){return Q={$$typeof:o,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:i,_context:Q},Q},yr.createElement=function(Q,N,M){var B,q={},K=null;if(N!=null)for(B in N.key!==void 0&&(K=""+N.key),N)W.call(N,B)&&B!=="key"&&B!=="__self"&&B!=="__source"&&(q[B]=N[B]);var se=arguments.length-2;if(se===1)q.children=M;else if(1<se){for(var me=Array(se),we=0;we<se;we++)me[we]=arguments[we+2];q.children=me}if(Q&&Q.defaultProps)for(B in se=Q.defaultProps,se)q[B]===void 0&&(q[B]=se[B]);return D(Q,K,q)},yr.createRef=function(){return{current:null}},yr.forwardRef=function(Q){return{$$typeof:c,render:Q}},yr.isValidElement=I,yr.lazy=function(Q){return{$$typeof:d,_payload:{_status:-1,_result:Q},_init:de}},yr.memo=function(Q,N){return{$$typeof:h,type:Q,compare:N===void 0?null:N}},yr.startTransition=function(Q){var N=F.T,M={};F.T=M;try{var B=Q(),q=F.S;q!==null&&q(M,B),typeof B=="object"&&B!==null&&typeof B.then=="function"&&B.then(z,Z)}catch(K){Z(K)}finally{N!==null&&M.types!==null&&(N.types=M.types),F.T=N}},yr.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},yr.use=function(Q){return F.H.use(Q)},yr.useActionState=function(Q,N,M){return F.H.useActionState(Q,N,M)},yr.useCallback=function(Q,N){return F.H.useCallback(Q,N)},yr.useContext=function(Q){return F.H.useContext(Q)},yr.useDebugValue=function(){},yr.useDeferredValue=function(Q,N){return F.H.useDeferredValue(Q,N)},yr.useEffect=function(Q,N){return F.H.useEffect(Q,N)},yr.useEffectEvent=function(Q){return F.H.useEffectEvent(Q)},yr.useId=function(){return F.H.useId()},yr.useImperativeHandle=function(Q,N,M){return F.H.useImperativeHandle(Q,N,M)},yr.useInsertionEffect=function(Q,N){return F.H.useInsertionEffect(Q,N)},yr.useLayoutEffect=function(Q,N){return F.H.useLayoutEffect(Q,N)},yr.useMemo=function(Q,N){return F.H.useMemo(Q,N)},yr.useOptimistic=function(Q,N){return F.H.useOptimistic(Q,N)},yr.useReducer=function(Q,N,M){return F.H.useReducer(Q,N,M)},yr.useRef=function(Q){return F.H.useRef(Q)},yr.useState=function(Q){return F.H.useState(Q)},yr.useSyncExternalStore=function(Q,N,M){return F.H.useSyncExternalStore(Q,N,M)},yr.useTransition=function(){return F.H.useTransition()},yr.version="19.2.3",yr}var p_;function Xv(){return p_||(p_=1,ig.exports=rA()),ig.exports}var ke=Xv();const aA=$v(ke);var sg={exports:{}},O0={},og={exports:{}},lg={};var m_;function nA(){return m_||(m_=1,(function(t){function e(ie,he){var de=ie.length;ie.push(he);e:for(;0<de;){var Z=de-1>>>1,Ne=ie[Z];if(0<n(Ne,he))ie[Z]=he,ie[de]=Ne,de=Z;else break e}}function r(ie){return ie.length===0?null:ie[0]}function a(ie){if(ie.length===0)return null;var he=ie[0],de=ie.pop();if(de!==he){ie[0]=de;e:for(var Z=0,Ne=ie.length,Q=Ne>>>1;Z<Q;){var N=2*(Z+1)-1,M=ie[N],B=N+1,q=ie[B];if(0>n(M,de))B<Ne&&0>n(q,M)?(ie[Z]=q,ie[B]=de,Z=B):(ie[Z]=M,ie[N]=de,Z=N);else if(B<Ne&&0>n(q,de))ie[Z]=q,ie[B]=de,Z=B;else break e}}return he}function n(ie,he){var de=ie.sortIndex-he.sortIndex;return de!==0?de:ie.id-he.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],h=[],d=1,v=null,y=3,g=!1,b=!1,w=!1,E=!1,A=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function R(ie){for(var he=r(h);he!==null;){if(he.callback===null)a(h);else if(he.startTime<=ie)a(h),he.sortIndex=he.expirationTime,e(u,he);else break;he=r(h)}}function H(ie){if(w=!1,R(ie),!b)if(r(u)!==null)b=!0,z||(z=!0,L());else{var he=r(h);he!==null&&ge(H,he.startTime-ie)}}var z=!1,F=-1,W=5,D=-1;function Y(){return E?!0:!(t.unstable_now()-D<W)}function I(){if(E=!1,z){var ie=t.unstable_now();D=ie;var he=!0;try{e:{b=!1,w&&(w=!1,O(F),F=-1),g=!0;var de=y;try{t:{for(R(ie),v=r(u);v!==null&&!(v.expirationTime>ie&&Y());){var Z=v.callback;if(typeof Z=="function"){v.callback=null,y=v.priorityLevel;var Ne=Z(v.expirationTime<=ie);if(ie=t.unstable_now(),typeof Ne=="function"){v.callback=Ne,R(ie),he=!0;break t}v===r(u)&&a(u),R(ie)}else a(u);v=r(u)}if(v!==null)he=!0;else{var Q=r(h);Q!==null&&ge(H,Q.startTime-ie),he=!1}}break e}finally{v=null,y=de,g=!1}he=void 0}}finally{he?L():z=!1}}}var L;if(typeof T=="function")L=function(){T(I)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,oe=ee.port2;ee.port1.onmessage=I,L=function(){oe.postMessage(null)}}else L=function(){A(I,0)};function ge(ie,he){F=A(function(){ie(t.unstable_now())},he)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(ie){switch(y){case 1:case 2:case 3:var he=3;break;default:he=y}var de=y;y=he;try{return ie()}finally{y=de}},t.unstable_requestPaint=function(){E=!0},t.unstable_runWithPriority=function(ie,he){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var de=y;y=ie;try{return he()}finally{y=de}},t.unstable_scheduleCallback=function(ie,he,de){var Z=t.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?Z+de:Z):de=Z,ie){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=de+Ne,ie={id:d++,callback:he,priorityLevel:ie,startTime:de,expirationTime:Ne,sortIndex:-1},de>Z?(ie.sortIndex=de,e(h,ie),r(u)===null&&ie===r(h)&&(w?(O(F),F=-1):w=!0,ge(H,de-Z))):(ie.sortIndex=Ne,e(u,ie),b||g||(b=!0,z||(z=!0,L()))),ie},t.unstable_shouldYield=Y,t.unstable_wrapCallback=function(ie){var he=y;return function(){var de=y;y=he;try{return ie.apply(this,arguments)}finally{y=de}}}})(lg)),lg}var g_;function iA(){return g_||(g_=1,og.exports=nA()),og.exports}var cg={exports:{}},xi={};var v_;function sA(){if(v_)return xi;v_=1;var t=Xv();function e(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)h+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function i(u,h,d){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:v==null?null:""+v,children:u,containerInfo:h,implementation:d}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,h){if(u==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return xi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,xi.createPortal=function(u,h){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return i(u,h,null,d)},xi.flushSync=function(u){var h=o.T,d=a.p;try{if(o.T=null,a.p=2,u)return u()}finally{o.T=h,a.p=d,a.d.f()}},xi.preconnect=function(u,h){typeof u=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,a.d.C(u,h))},xi.prefetchDNS=function(u){typeof u=="string"&&a.d.D(u)},xi.preinit=function(u,h){if(typeof u=="string"&&h&&typeof h.as=="string"){var d=h.as,v=c(d,h.crossOrigin),y=typeof h.integrity=="string"?h.integrity:void 0,g=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;d==="style"?a.d.S(u,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:v,integrity:y,fetchPriority:g}):d==="script"&&a.d.X(u,{crossOrigin:v,integrity:y,fetchPriority:g,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},xi.preinitModule=function(u,h){if(typeof u=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var d=c(h.as,h.crossOrigin);a.d.M(u,{crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&a.d.M(u)},xi.preload=function(u,h){if(typeof u=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var d=h.as,v=c(d,h.crossOrigin);a.d.L(u,d,{crossOrigin:v,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},xi.preloadModule=function(u,h){if(typeof u=="string")if(h){var d=c(h.as,h.crossOrigin);a.d.m(u,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else a.d.m(u)},xi.requestFormReset=function(u){a.d.r(u)},xi.unstable_batchedUpdates=function(u,h){return u(h)},xi.useFormState=function(u,h,d){return o.H.useFormState(u,h,d)},xi.useFormStatus=function(){return o.H.useHostTransitionStatus()},xi.version="19.2.3",xi}var x_;function oA(){if(x_)return cg.exports;x_=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),cg.exports=sA(),cg.exports}var y_;function lA(){if(y_)return O0;y_=1;var t=iA(),e=Xv(),r=oA();function a(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(i(s)!==s)throw Error(a(188))}function h(s){var l=s.alternate;if(!l){if(l=i(s),l===null)throw Error(a(188));return l!==s?null:s}for(var f=s,m=l;;){var _=f.return;if(_===null)break;var k=_.alternate;if(k===null){if(m=_.return,m!==null){f=m;continue}break}if(_.child===k.child){for(k=_.child;k;){if(k===f)return u(_),s;if(k===m)return u(_),l;k=k.sibling}throw Error(a(188))}if(f.return!==m.return)f=_,m=k;else{for(var U=!1,ne=_.child;ne;){if(ne===f){U=!0,f=_,m=k;break}if(ne===m){U=!0,m=_,f=k;break}ne=ne.sibling}if(!U){for(ne=k.child;ne;){if(ne===f){U=!0,f=k,m=_;break}if(ne===m){U=!0,m=k,f=_;break}ne=ne.sibling}if(!U)throw Error(a(189))}}if(f.alternate!==m)throw Error(a(190))}if(f.tag!==3)throw Error(a(188));return f.stateNode.current===f?s:l}function d(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=d(s),l!==null)return l;s=s.sibling}return null}var v=Object.assign,y=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),O=Symbol.for("react.consumer"),T=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),Y=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function L(s){return s===null||typeof s!="object"?null:(s=I&&s[I]||s["@@iterator"],typeof s=="function"?s:null)}var ee=Symbol.for("react.client.reference");function oe(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ee?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case A:return"Profiler";case E:return"StrictMode";case H:return"Suspense";case z:return"SuspenseList";case D:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case b:return"Portal";case T:return s.displayName||"Context";case O:return(s._context.displayName||"Context")+".Consumer";case R:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case F:return l=s.displayName||null,l!==null?l:oe(s.type)||"Memo";case W:l=s._payload,s=s._init;try{return oe(s(l))}catch{}}return null}var ge=Array.isArray,ie=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de={pending:!1,data:null,method:null,action:null},Z=[],Ne=-1;function Q(s){return{current:s}}function N(s){0>Ne||(s.current=Z[Ne],Z[Ne]=null,Ne--)}function M(s,l){Ne++,Z[Ne]=s.current,s.current=l}var B=Q(null),q=Q(null),K=Q(null),se=Q(null);function me(s,l){switch(M(K,l),M(q,s),M(B,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?Ly(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=Ly(l),s=Dy(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}N(B),M(B,s)}function we(){N(B),N(q),N(K)}function Se(s){s.memoizedState!==null&&M(se,s);var l=B.current,f=Dy(l,s.type);l!==f&&(M(q,s),M(B,f))}function Ee(s){q.current===s&&(N(B),N(q)),se.current===s&&(N(se),A0._currentValue=de)}var ae,rt;function Je(s){if(ae===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);ae=l&&l[1]||"",rt=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ae+s+rt}var V=!1;function Ie(s,l){if(!s||V)return"";V=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(l){var ut=function(){throw Error()};if(Object.defineProperty(ut.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ut,[])}catch(Ze){var Xe=Ze}Reflect.construct(s,[],ut)}else{try{ut.call()}catch(Ze){Xe=Ze}s.call(ut.prototype)}}else{try{throw Error()}catch(Ze){Xe=Ze}(ut=s())&&typeof ut.catch=="function"&&ut.catch(function(){})}}catch(Ze){if(Ze&&Xe&&typeof Ze.stack=="string")return[Ze.stack,Xe.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=m.DetermineComponentFrameRoot(),U=k[0],ne=k[1];if(U&&ne){var Ae=U.split(`
`),$e=ne.split(`
`);for(_=m=0;m<Ae.length&&!Ae[m].includes("DetermineComponentFrameRoot");)m++;for(;_<$e.length&&!$e[_].includes("DetermineComponentFrameRoot");)_++;if(m===Ae.length||_===$e.length)for(m=Ae.length-1,_=$e.length-1;1<=m&&0<=_&&Ae[m]!==$e[_];)_--;for(;1<=m&&0<=_;m--,_--)if(Ae[m]!==$e[_]){if(m!==1||_!==1)do if(m--,_--,0>_||Ae[m]!==$e[_]){var it=`
`+Ae[m].replace(" at new "," at ");return s.displayName&&it.includes("<anonymous>")&&(it=it.replace("<anonymous>",s.displayName)),it}while(1<=m&&0<=_);break}}}finally{V=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?Je(f):""}function Le(s,l){switch(s.tag){case 26:case 27:case 5:return Je(s.type);case 16:return Je("Lazy");case 13:return s.child!==l&&l!==null?Je("Suspense Fallback"):Je("Suspense");case 19:return Je("SuspenseList");case 0:case 15:return Ie(s.type,!1);case 11:return Ie(s.type.render,!1);case 1:return Ie(s.type,!0);case 31:return Je("Activity");default:return""}}function gt(s){try{var l="",f=null;do l+=Le(s,f),f=s,s=s.return;while(s);return l}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var et=Object.prototype.hasOwnProperty,wt=t.unstable_scheduleCallback,vt=t.unstable_cancelCallback,Ct=t.unstable_shouldYield,Et=t.unstable_requestPaint,It=t.unstable_now,er=t.unstable_getCurrentPriorityLevel,Vt=t.unstable_ImmediatePriority,Oe=t.unstable_UserBlockingPriority,Ye=t.unstable_NormalPriority,He=t.unstable_LowPriority,ct=t.unstable_IdlePriority,mt=t.log,Ht=t.unstable_setDisableYieldValue,Rt=null,Wt=null;function nr(s){if(typeof mt=="function"&&Ht(s),Wt&&typeof Wt.setStrictMode=="function")try{Wt.setStrictMode(Rt,s)}catch{}}var br=Math.clz32?Math.clz32:Zt,Yt=Math.log,Wr=Math.LN2;function Zt(s){return s>>>=0,s===0?32:31-(Yt(s)/Wr|0)|0}var ir=256,Vr=262144,pr=4194304;function Dt(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Tr(s,l,f){var m=s.pendingLanes;if(m===0)return 0;var _=0,k=s.suspendedLanes,U=s.pingedLanes;s=s.warmLanes;var ne=m&134217727;return ne!==0?(m=ne&~k,m!==0?_=Dt(m):(U&=ne,U!==0?_=Dt(U):f||(f=ne&~s,f!==0&&(_=Dt(f))))):(ne=m&~k,ne!==0?_=Dt(ne):U!==0?_=Dt(U):f||(f=m&~s,f!==0&&(_=Dt(f)))),_===0?0:l!==0&&l!==_&&(l&k)===0&&(k=_&-_,f=l&-l,k>=f||k===32&&(f&4194048)!==0)?l:_}function Qn(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function Ka(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _t(){var s=pr;return pr<<=1,(pr&62914560)===0&&(pr=4194304),s}function Ja(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function Kt(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function fs(s,l,f,m,_,k){var U=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var ne=s.entanglements,Ae=s.expirationTimes,$e=s.hiddenUpdates;for(f=U&~f;0<f;){var it=31-br(f),ut=1<<it;ne[it]=0,Ae[it]=-1;var Xe=$e[it];if(Xe!==null)for($e[it]=null,it=0;it<Xe.length;it++){var Ze=Xe[it];Ze!==null&&(Ze.lane&=-536870913)}f&=~ut}m!==0&&zi(s,m,0),k!==0&&_===0&&s.tag!==0&&(s.suspendedLanes|=k&~(U&~l))}function zi(s,l,f){s.pendingLanes|=l,s.suspendedLanes&=~l;var m=31-br(l);s.entangledLanes|=l,s.entanglements[m]=s.entanglements[m]|1073741824|f&261930}function On(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var m=31-br(f),_=1<<m;_&l|s[m]&l&&(s[m]|=l),f&=~_}}function ei(s,l){var f=l&-l;return f=(f&42)!==0?1:ha(f),(f&(s.suspendedLanes|l))!==0?0:f}function ha(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Da(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function J(){var s=he.p;return s!==0?s:(s=window.event,s===void 0?32:n_(s.type))}function ye(s,l){var f=he.p;try{return he.p=s,l()}finally{he.p=f}}var ce=Math.random().toString(36).slice(2),ue="__reactFiber$"+ce,pe="__reactProps$"+ce,be="__reactContainer$"+ce,Be="__reactEvents$"+ce,Qe="__reactListeners$"+ce,qe="__reactHandles$"+ce,ze="__reactResources$"+ce,Ve="__reactMarker$"+ce;function pt(s){delete s[ue],delete s[pe],delete s[Be],delete s[Qe],delete s[qe]}function bt(s){var l=s[ue];if(l)return l;for(var f=s.parentNode;f;){if(l=f[be]||f[ue]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=zy(s);s!==null;){if(f=s[ue])return f;s=zy(s)}return l}s=f,f=s.parentNode}return null}function Tt(s){if(s=s[ue]||s[be]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function yt(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(a(33))}function kt(s){var l=s[ze];return l||(l=s[ze]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Lt(s){s[Ve]=!0}var ea=new Set,jr={};function na(s,l){ti(s,l),ti(s+"Capture",l)}function ti(s,l){for(jr[s]=l,s=0;s<l.length;s++)ea.add(l[s])}var hs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ds={},Fi={};function $o(s){return et.call(Fi,s)?!0:et.call(ds,s)?!1:hs.test(s)?Fi[s]=!0:(ds[s]=!0,!1)}function ka(s,l,f){if($o(l))if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var m=l.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+f)}}function lo(s,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+f)}}function ps(s,l,f,m){if(m===null)s.removeAttribute(f);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(l,f,""+m)}}function Gr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function lu(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Ds(s,l,f){var m=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var _=m.get,k=m.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return _.call(this)},set:function(U){f=""+U,k.call(this,U)}}),Object.defineProperty(s,l,{enumerable:m.enumerable}),{getValue:function(){return f},setValue:function(U){f=""+U},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Xo(s){if(!s._valueTracker){var l=lu(s)?"checked":"value";s._valueTracker=Ds(s,l,""+s[l])}}function cu(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),m="";return s&&(m=lu(s)?s.checked?"true":"false":s.value),s=m,s!==f?(l.setValue(s),!0):!1}function ri(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var fn=/[\n"\\]/g;function Za(s){return s.replace(fn,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function uc(s,l,f,m,_,k,U,ne){s.name="",U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?s.type=U:s.removeAttribute("type"),l!=null?U==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+Gr(l)):s.value!==""+Gr(l)&&(s.value=""+Gr(l)):U!=="submit"&&U!=="reset"||s.removeAttribute("value"),l!=null?uu(s,U,Gr(l)):f!=null?uu(s,U,Gr(f)):m!=null&&s.removeAttribute("value"),_==null&&k!=null&&(s.defaultChecked=!!k),_!=null&&(s.checked=_&&typeof _!="function"&&typeof _!="symbol"),ne!=null&&typeof ne!="function"&&typeof ne!="symbol"&&typeof ne!="boolean"?s.name=""+Gr(ne):s.removeAttribute("name")}function xf(s,l,f,m,_,k,U,ne){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(s.type=k),l!=null||f!=null){if(!(k!=="submit"&&k!=="reset"||l!=null)){Xo(s);return}f=f!=null?""+Gr(f):"",l=l!=null?""+Gr(l):f,ne||l===s.value||(s.value=l),s.defaultValue=l}m=m??_,m=typeof m!="function"&&typeof m!="symbol"&&!!m,s.checked=ne?s.checked:!!m,s.defaultChecked=!!m,U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(s.name=U),Xo(s)}function uu(s,l,f){l==="number"&&ri(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function ai(s,l,f,m){if(s=s.options,l){l={};for(var _=0;_<f.length;_++)l["$"+f[_]]=!0;for(f=0;f<s.length;f++)_=l.hasOwnProperty("$"+s[f].value),s[f].selected!==_&&(s[f].selected=_),_&&m&&(s[f].defaultSelected=!0)}else{for(f=""+Gr(f),l=null,_=0;_<s.length;_++){if(s[_].value===f){s[_].selected=!0,m&&(s[_].defaultSelected=!0);return}l!==null||s[_].disabled||(l=s[_])}l!==null&&(l.selected=!0)}}function fu(s,l,f){if(l!=null&&(l=""+Gr(l),l!==s.value&&(s.value=l),f==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=f!=null?""+Gr(f):""}function hu(s,l,f,m){if(l==null){if(m!=null){if(f!=null)throw Error(a(92));if(ge(m)){if(1<m.length)throw Error(a(93));m=m[0]}f=m}f==null&&(f=""),l=f}f=Gr(l),s.defaultValue=f,m=s.textContent,m===f&&m!==""&&m!==null&&(s.value=m),Xo(s)}function ms(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var El=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function yf(s,l,f){var m=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?m?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":m?s.setProperty(l,f):typeof f!="number"||f===0||El.has(l)?l==="float"?s.cssFloat=f:s[l]=(""+f).trim():s[l]=f+"px"}function _f(s,l,f){if(l!=null&&typeof l!="object")throw Error(a(62));if(s=s.style,f!=null){for(var m in f)!f.hasOwnProperty(m)||l!=null&&l.hasOwnProperty(m)||(m.indexOf("--")===0?s.setProperty(m,""):m==="float"?s.cssFloat="":s[m]="");for(var _ in l)m=l[_],l.hasOwnProperty(_)&&f[_]!==m&&yf(s,_,m)}else for(var k in l)l.hasOwnProperty(k)&&yf(s,k,l[k])}function du(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mi(s){return wf.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function gs(){}var co=null;function kl(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Yo=null,sr=null;function bf(s){var l=Tt(s);if(l&&(s=l.stateNode)){var f=s[pe]||null;e:switch(s=l.stateNode,l.type){case"input":if(uc(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Za(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var m=f[l];if(m!==s&&m.form===s.form){var _=m[pe]||null;if(!_)throw Error(a(90));uc(m,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(l=0;l<f.length;l++)m=f[l],m.form===s.form&&cu(m)}break e;case"textarea":fu(s,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&ai(s,!!f.multiple,l,!1)}}}var mu=!1;function Sf(s,l,f){if(mu)return s(l,f);mu=!0;try{var m=s(l);return m}finally{if(mu=!1,(Yo!==null||sr!==null)&&(Jd(),Yo&&(l=Yo,s=sr,sr=Yo=null,bf(l),s)))for(l=0;l<s.length;l++)bf(s[l])}}function Ri(s,l){var f=s.stateNode;if(f===null)return null;var m=f[pe]||null;if(m===null)return null;f=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(a(231,l,typeof f));return f}var Fn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gu=!1;if(Fn)try{var Al={};Object.defineProperty(Al,"passive",{get:function(){gu=!0}}),window.addEventListener("test",Al,Al),window.removeEventListener("test",Al,Al)}catch{gu=!1}var Li=null,Nl=null,Ps=null;function Ef(){if(Ps)return Ps;var s,l=Nl,f=l.length,m,_="value"in Li?Li.value:Li.textContent,k=_.length;for(s=0;s<f&&l[s]===_[s];s++);var U=f-s;for(m=1;m<=U&&l[f-m]===_[k-m];m++);return Ps=_.slice(s,1<m?1-m:void 0)}function Hi(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function fc(){return!0}function hc(){return!1}function wn(s){function l(f,m,_,k,U){this._reactName=f,this._targetInst=_,this.type=m,this.nativeEvent=k,this.target=U,this.currentTarget=null;for(var ne in s)s.hasOwnProperty(ne)&&(f=s[ne],this[ne]=f?f(k):k[ne]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?fc:hc,this.isPropagationStopped=hc,this}return v(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=fc)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=fc)},persist:function(){},isPersistent:fc}),l}var Ms={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wi=wn(Ms),uo=v({},Ms,{view:0,detail:0}),dc=wn(uo),Tl,fo,ho,jl=v({},uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ho&&(ho&&s.type==="mousemove"?(Tl=s.screenX-ho.screenX,fo=s.screenY-ho.screenY):fo=Tl=0,ho=s),Tl)},movementY:function(s){return"movementY"in s?s.movementY:fo}}),vu=wn(jl),po=v({},jl,{dataTransfer:0}),mo=wn(po),kf=v({},uo,{relatedTarget:0}),go=wn(kf),Af=v({},Ms,{animationName:0,elapsedTime:0,pseudoElement:0}),j=wn(Af),G=v({},Ms,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),_e=wn(G),Te=v({},Ms,{data:0}),De=wn(Te),st={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ht={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gt(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=Bt[s])?!!l[s]:!1}function cr(){return Gt}var vr=v({},uo,{key:function(s){if(s.key){var l=st[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Hi(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ht[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cr,charCode:function(s){return s.type==="keypress"?Hi(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Hi(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ir=wn(vr),Aa=v({},jl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qa=wn(Aa),da=v({},uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cr}),hn=wn(da),Qa=v({},Ms,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rn=wn(Qa),vo=v({},jl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),vs=wn(vo),xo=v({},Ms,{newState:0,oldState:0}),xu=wn(xo),pc=[9,13,27,32],Is=Fn&&"CompositionEvent"in window,xs=null;Fn&&"documentMode"in document&&(xs=document.documentMode);var Cl=Fn&&"TextEvent"in window&&!xs,yo=Fn&&(!Is||xs&&8<xs&&11>=xs),bn=" ",Ko=!1;function Jo(s,l){switch(s){case"keyup":return pc.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Bs=!1;function ni(s,l){switch(s){case"compositionend":return mc(l);case"keypress":return l.which!==32?null:(Ko=!0,bn);case"textInput":return s=l.data,s===bn&&Ko?null:s;default:return null}}function _o(s,l){if(Bs)return s==="compositionend"||!Is&&Jo(s,l)?(s=Ef(),Ps=Nl=Li=null,Bs=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return yo&&l.locale!=="ko"?null:l.data;default:return null}}var gc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yu(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!gc[s.type]:l==="textarea"}function Di(s,l,f,m){Yo?sr?sr.push(m):sr=[m]:Yo=m,l=n1(l,"onChange"),0<l.length&&(f=new Wi("onChange","change",null,f,m),s.push({event:f,listeners:l}))}var ys=null,wo=null;function _u(s){Ty(s,0)}function _s(s){var l=yt(s);if(cu(l))return s}function Zo(s,l){if(s==="change")return l}var gi=!1;if(Fn){var ii;if(Fn){var Us="oninput"in document;if(!Us){var qs=document.createElement("div");qs.setAttribute("oninput","return;"),Us=typeof qs.oninput=="function"}ii=Us}else ii=!1;gi=ii&&(!document.documentMode||9<document.documentMode)}function bo(){ys&&(ys.detachEvent("onpropertychange",vc),wo=ys=null)}function vc(s){if(s.propertyName==="value"&&_s(wo)){var l=[];Di(l,wo,s,kl(s)),Sf(_u,l)}}function xc(s,l,f){s==="focusin"?(bo(),ys=l,wo=f,ys.attachEvent("onpropertychange",vc)):s==="focusout"&&bo()}function za(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return _s(wo)}function Nf(s,l){if(s==="click")return _s(l)}function zs(s,l){if(s==="input"||s==="change")return _s(l)}function Hs(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var Ln=typeof Object.is=="function"?Object.is:Hs;function So(s,l){if(Ln(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),m=Object.keys(l);if(f.length!==m.length)return!1;for(m=0;m<f.length;m++){var _=f[m];if(!et.call(l,_)||!Ln(s[_],l[_]))return!1}return!0}function yc(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function _c(s,l){var f=yc(s);s=0;for(var m;f;){if(f.nodeType===3){if(m=s+f.textContent.length,s<=l&&m>=l)return{node:f,offset:l-s};s=m}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=yc(f)}}function Eo(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?Eo(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function ko(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=ri(s.document);l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=ri(s.document)}return l}function Ws(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var Ol=Fn&&"documentMode"in document&&11>=document.documentMode,Pi=null,Ao=null,Hn=null,Vi=!1;function $r(s,l,f){var m=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Vi||Pi==null||Pi!==ri(m)||(m=Pi,"selectionStart"in m&&Ws(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Hn&&So(Hn,m)||(Hn=m,m=n1(Ao,"onSelect"),0<m.length&&(l=new Wi("onSelect","select",null,l,f),s.push({event:l,listeners:m}),l.target=Pi)))}function Br(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var pa={animationend:Br("Animation","AnimationEnd"),animationiteration:Br("Animation","AnimationIteration"),animationstart:Br("Animation","AnimationStart"),transitionrun:Br("Transition","TransitionRun"),transitionstart:Br("Transition","TransitionStart"),transitioncancel:Br("Transition","TransitionCancel"),transitionend:Br("Transition","TransitionEnd")},Ha={},Vs={};Fn&&(Vs=document.createElement("div").style,"AnimationEvent"in window||(delete pa.animationend.animation,delete pa.animationiteration.animation,delete pa.animationstart.animation),"TransitionEvent"in window||delete pa.transitionend.transition);function ws(s){if(Ha[s])return Ha[s];if(!pa[s])return s;var l=pa[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in Vs)return Ha[s]=l[f];return s}var Fl=ws("animationend"),wu=ws("animationiteration"),Yh=ws("animationstart"),Nd=ws("transitionrun"),Td=ws("transitionstart"),jd=ws("transitioncancel"),Kh=ws("transitionend"),Jh=new Map,Rl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Rl.push("scrollEnd");function Gi(s,l){Jh.set(s,l),na(l,[s])}var bu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Mi=[],Ll=0,Tf=0;function Su(){for(var s=Ll,l=Tf=Ll=0;l<s;){var f=Mi[l];Mi[l++]=null;var m=Mi[l];Mi[l++]=null;var _=Mi[l];Mi[l++]=null;var k=Mi[l];if(Mi[l++]=null,m!==null&&_!==null){var U=m.pending;U===null?_.next=_:(_.next=U.next,U.next=_),m.pending=_}k!==0&&ku(f,_,k)}}function Eu(s,l,f,m){Mi[Ll++]=s,Mi[Ll++]=l,Mi[Ll++]=f,Mi[Ll++]=m,Tf|=m,s.lanes|=m,s=s.alternate,s!==null&&(s.lanes|=m)}function jf(s,l,f,m){return Eu(s,l,f,m),Wn(s)}function No(s,l){return Eu(s,null,null,l),Wn(s)}function ku(s,l,f){s.lanes|=f;var m=s.alternate;m!==null&&(m.lanes|=f);for(var _=!1,k=s.return;k!==null;)k.childLanes|=f,m=k.alternate,m!==null&&(m.childLanes|=f),k.tag===22&&(s=k.stateNode,s===null||s._visibility&1||(_=!0)),s=k,k=k.return;return s.tag===3?(k=s.stateNode,_&&l!==null&&(_=31-br(f),s=k.hiddenUpdates,m=s[_],m===null?s[_]=[l]:m.push(l),l.lane=f|536870912),k):null}function Wn(s){if(50<y0)throw y0=0,Tm=null,Error(a(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var Dn={};function Cf(s,l,f,m){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(s,l,f,m){return new Cf(s,l,f,m)}function Of(s){return s=s.prototype,!(!s||!s.isReactComponent)}function $i(s,l){var f=s.alternate;return f===null?(f=Vn(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function Au(s,l){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,l=f.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function wc(s,l,f,m,_,k){var U=0;if(m=s,typeof s=="function")Of(s)&&(U=1);else if(typeof s=="string")U=Uk(s,f,B.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case D:return s=Vn(31,f,l,_),s.elementType=D,s.lanes=k,s;case w:return Qo(f.children,_,k,l);case E:U=8,_|=24;break;case A:return s=Vn(12,f,l,_|2),s.elementType=A,s.lanes=k,s;case H:return s=Vn(13,f,l,_),s.elementType=H,s.lanes=k,s;case z:return s=Vn(19,f,l,_),s.elementType=z,s.lanes=k,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case T:U=10;break e;case O:U=9;break e;case R:U=11;break e;case F:U=14;break e;case W:U=16,m=null;break e}U=29,f=Error(a(130,s===null?"null":typeof s,"")),m=null}return l=Vn(U,f,l,_),l.elementType=s,l.type=m,l.lanes=k,l}function Qo(s,l,f,m){return s=Vn(7,s,m,l),s.lanes=f,s}function Nu(s,l,f){return s=Vn(6,s,null,l),s.lanes=f,s}function Ff(s){var l=Vn(18,null,null,0);return l.stateNode=s,l}function bc(s,l,f){return l=Vn(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var Rf=new WeakMap;function Xi(s,l){if(typeof s=="object"&&s!==null){var f=Rf.get(s);return f!==void 0?f:(l={value:s,source:l,stack:gt(l)},Rf.set(s,l),l)}return{value:s,source:l,stack:gt(l)}}var Sc=[],Dl=0,Lf=null,Tu=0,Yi=[],Ki=0,el=null,Ji=1,Zi="";function Ii(s,l){Sc[Dl++]=Tu,Sc[Dl++]=Lf,Lf=s,Tu=l}function Cd(s,l,f){Yi[Ki++]=Ji,Yi[Ki++]=Zi,Yi[Ki++]=el,el=s;var m=Ji;s=Zi;var _=32-br(m)-1;m&=~(1<<_),f+=1;var k=32-br(l)+_;if(30<k){var U=_-_%5;k=(m&(1<<U)-1).toString(32),m>>=U,_-=U,Ji=1<<32-br(l)+_|f<<_|m,Zi=k+s}else Ji=1<<k|f<<_|m,Zi=s}function Zh(s){s.return!==null&&(Ii(s,1),Cd(s,1,0))}function Df(s){for(;s===Lf;)Lf=Sc[--Dl],Sc[Dl]=null,Tu=Sc[--Dl],Sc[Dl]=null;for(;s===el;)el=Yi[--Ki],Yi[Ki]=null,Zi=Yi[--Ki],Yi[Ki]=null,Ji=Yi[--Ki],Yi[Ki]=null}function Od(s,l){Yi[Ki++]=Ji,Yi[Ki++]=Zi,Yi[Ki++]=el,Ji=l.id,Zi=l.overflow,el=s}var Pn=null,_a=null,Rr=!1,si=null,Pa=!1,bs=Error(a(519));function tl(s){var l=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ec(Xi(l,s)),bs}function Qh(s){var l=s.stateNode,f=s.type,m=s.memoizedProps;switch(l[ue]=s,l[pe]=m,f){case"dialog":Dr("cancel",l),Dr("close",l);break;case"iframe":case"object":case"embed":Dr("load",l);break;case"video":case"audio":for(f=0;f<w0.length;f++)Dr(w0[f],l);break;case"source":Dr("error",l);break;case"img":case"image":case"link":Dr("error",l),Dr("load",l);break;case"details":Dr("toggle",l);break;case"input":Dr("invalid",l),xf(l,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":Dr("invalid",l);break;case"textarea":Dr("invalid",l),hu(l,m.value,m.defaultValue,m.children)}f=m.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||m.suppressHydrationWarning===!0||Fy(l.textContent,f)?(m.popover!=null&&(Dr("beforetoggle",l),Dr("toggle",l)),m.onScroll!=null&&Dr("scroll",l),m.onScrollEnd!=null&&Dr("scrollend",l),m.onClick!=null&&(l.onclick=gs),l=!0):l=!1,l||tl(s,!0)}function To(s){for(Pn=s.return;Pn;)switch(Pn.tag){case 5:case 31:case 13:Pa=!1;return;case 27:case 3:Pa=!0;return;default:Pn=Pn.return}}function Mn(s){if(s!==Pn)return!1;if(!Rr)return To(s),Rr=!0,!1;var l=s.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||Hm(s.type,s.memoizedProps)),f=!f),f&&_a&&tl(s),To(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));_a=qy(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));_a=qy(s)}else l===27?(l=_a,Ic(s.type)?(s=Xm,Xm=null,_a=s):_a=l):_a=Pn?Ys(s.stateNode.nextSibling):null;return!0}function Pl(){_a=Pn=null,Rr=!1}function e0(){var s=si;return s!==null&&(ns===null?ns=s:ns.push.apply(ns,s),si=null),s}function Ec(s){si===null?si=[s]:si.push(s)}var Pf=Q(null),rl=null,Gs=null;function al(s,l,f){M(Pf,l._currentValue),l._currentValue=f}function Qi(s){s._currentValue=Pf.current,N(Pf)}function kc(s,l,f){for(;s!==null;){var m=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),s===f)break;s=s.return}}function Ml(s,l,f,m){var _=s.child;for(_!==null&&(_.return=s);_!==null;){var k=_.dependencies;if(k!==null){var U=_.child;k=k.firstContext;e:for(;k!==null;){var ne=k;k=_;for(var Ae=0;Ae<l.length;Ae++)if(ne.context===l[Ae]){k.lanes|=f,ne=k.alternate,ne!==null&&(ne.lanes|=f),kc(k.return,f,s),m||(U=null);break e}k=ne.next}}else if(_.tag===18){if(U=_.return,U===null)throw Error(a(341));U.lanes|=f,k=U.alternate,k!==null&&(k.lanes|=f),kc(U,f,s),U=null}else U=_.child;if(U!==null)U.return=_;else for(U=_;U!==null;){if(U===s){U=null;break}if(_=U.sibling,_!==null){_.return=U.return,U=_;break}U=U.return}_=U}}function nl(s,l,f,m){s=null;for(var _=l,k=!1;_!==null;){if(!k){if((_.flags&524288)!==0)k=!0;else if((_.flags&262144)!==0)break}if(_.tag===10){var U=_.alternate;if(U===null)throw Error(a(387));if(U=U.memoizedProps,U!==null){var ne=_.type;Ln(_.pendingProps.value,U.value)||(s!==null?s.push(ne):s=[ne])}}else if(_===se.current){if(U=_.alternate,U===null)throw Error(a(387));U.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(s!==null?s.push(A0):s=[A0])}_=_.return}s!==null&&Ml(l,s,f,m),l.flags|=262144}function Mf(s){for(s=s.firstContext;s!==null;){if(!Ln(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function il(s){rl=s,Gs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function In(s){return Fd(rl,s)}function If(s,l){return rl===null&&il(s),Fd(s,l)}function Fd(s,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},Gs===null){if(s===null)throw Error(a(308));Gs=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else Gs=Gs.next=l;return f}var $p=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(f,m){s.push(m)}};this.abort=function(){l.aborted=!0,s.forEach(function(f){return f()})}},Xp=t.unstable_scheduleCallback,Yp=t.unstable_NormalPriority,Wa={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ac(){return{controller:new $p,data:new Map,refCount:0}}function ju(s){s.refCount--,s.refCount===0&&Xp(Yp,function(){s.controller.abort()})}var Cu=null,Bf=0,x=0,S=null;function C(s,l){if(Cu===null){var f=Cu=[];Bf=0,x=Lm(),S={status:"pending",value:void 0,then:function(m){f.push(m)}}}return Bf++,l.then(P,P),l}function P(){if(--Bf===0&&Cu!==null){S!==null&&(S.status="fulfilled");var s=Cu;Cu=null,x=0,S=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function X(s,l){var f=[],m={status:"pending",value:null,reason:null,then:function(_){f.push(_)}};return s.then(function(){m.status="fulfilled",m.value=l;for(var _=0;_<f.length;_++)(0,f[_])(l)},function(_){for(m.status="rejected",m.reason=_,_=0;_<f.length;_++)(0,f[_])(void 0)}),m}var te=ie.S;ie.S=function(s,l){ry=It(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&C(s,l),te!==null&&te(s,l)};var re=Q(null);function le(){var s=re.current;return s!==null?s:ba.pooledCache}function fe(s,l){l===null?M(re,re.current):M(re,l.pool)}function xe(){var s=le();return s===null?null:{parent:Wa._currentValue,pool:s}}var je=Error(a(460)),We=Error(a(474)),ve=Error(a(542)),Fe={then:function(){}};function Me(s){return s=s.status,s==="fulfilled"||s==="rejected"}function at(s,l,f){switch(f=s[f],f===void 0?s.push(l):f!==l&&(l.then(gs,gs),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,xt(s),s;default:if(typeof l.status=="string")l.then(gs,gs);else{if(s=ba,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=l,s.status="pending",s.then(function(m){if(l.status==="pending"){var _=l;_.status="fulfilled",_.value=m}},function(m){if(l.status==="pending"){var _=l;_.status="rejected",_.reason=m}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,xt(s),s}throw tt=l,je}}function Ue(s){try{var l=s._init;return l(s._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(tt=f,je):f}}var tt=null;function ot(){if(tt===null)throw Error(a(459));var s=tt;return tt=null,s}function xt(s){if(s===je||s===ve)throw Error(a(483))}var ft=null,qt=0;function Ot(s){var l=qt;return qt+=1,ft===null&&(ft=[]),at(ft,s,l)}function mr(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Pt(s,l){throw l.$$typeof===y?Error(a(525)):(s=Object.prototype.toString.call(l),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function Or(s){function l(Pe,Ce){if(s){var Ge=Pe.deletions;Ge===null?(Pe.deletions=[Ce],Pe.flags|=16):Ge.push(Ce)}}function f(Pe,Ce){if(!s)return null;for(;Ce!==null;)l(Pe,Ce),Ce=Ce.sibling;return null}function m(Pe){for(var Ce=new Map;Pe!==null;)Pe.key!==null?Ce.set(Pe.key,Pe):Ce.set(Pe.index,Pe),Pe=Pe.sibling;return Ce}function _(Pe,Ce){return Pe=$i(Pe,Ce),Pe.index=0,Pe.sibling=null,Pe}function k(Pe,Ce,Ge){return Pe.index=Ge,s?(Ge=Pe.alternate,Ge!==null?(Ge=Ge.index,Ge<Ce?(Pe.flags|=67108866,Ce):Ge):(Pe.flags|=67108866,Ce)):(Pe.flags|=1048576,Ce)}function U(Pe){return s&&Pe.alternate===null&&(Pe.flags|=67108866),Pe}function ne(Pe,Ce,Ge,lt){return Ce===null||Ce.tag!==6?(Ce=Nu(Ge,Pe.mode,lt),Ce.return=Pe,Ce):(Ce=_(Ce,Ge),Ce.return=Pe,Ce)}function Ae(Pe,Ce,Ge,lt){var rr=Ge.type;return rr===w?it(Pe,Ce,Ge.props.children,lt,Ge.key):Ce!==null&&(Ce.elementType===rr||typeof rr=="object"&&rr!==null&&rr.$$typeof===W&&Ue(rr)===Ce.type)?(Ce=_(Ce,Ge.props),mr(Ce,Ge),Ce.return=Pe,Ce):(Ce=wc(Ge.type,Ge.key,Ge.props,null,Pe.mode,lt),mr(Ce,Ge),Ce.return=Pe,Ce)}function $e(Pe,Ce,Ge,lt){return Ce===null||Ce.tag!==4||Ce.stateNode.containerInfo!==Ge.containerInfo||Ce.stateNode.implementation!==Ge.implementation?(Ce=bc(Ge,Pe.mode,lt),Ce.return=Pe,Ce):(Ce=_(Ce,Ge.children||[]),Ce.return=Pe,Ce)}function it(Pe,Ce,Ge,lt,rr){return Ce===null||Ce.tag!==7?(Ce=Qo(Ge,Pe.mode,lt,rr),Ce.return=Pe,Ce):(Ce=_(Ce,Ge),Ce.return=Pe,Ce)}function ut(Pe,Ce,Ge){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return Ce=Nu(""+Ce,Pe.mode,Ge),Ce.return=Pe,Ce;if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case g:return Ge=wc(Ce.type,Ce.key,Ce.props,null,Pe.mode,Ge),mr(Ge,Ce),Ge.return=Pe,Ge;case b:return Ce=bc(Ce,Pe.mode,Ge),Ce.return=Pe,Ce;case W:return Ce=Ue(Ce),ut(Pe,Ce,Ge)}if(ge(Ce)||L(Ce))return Ce=Qo(Ce,Pe.mode,Ge,null),Ce.return=Pe,Ce;if(typeof Ce.then=="function")return ut(Pe,Ot(Ce),Ge);if(Ce.$$typeof===T)return ut(Pe,If(Pe,Ce),Ge);Pt(Pe,Ce)}return null}function Xe(Pe,Ce,Ge,lt){var rr=Ce!==null?Ce.key:null;if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint")return rr!==null?null:ne(Pe,Ce,""+Ge,lt);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case g:return Ge.key===rr?Ae(Pe,Ce,Ge,lt):null;case b:return Ge.key===rr?$e(Pe,Ce,Ge,lt):null;case W:return Ge=Ue(Ge),Xe(Pe,Ce,Ge,lt)}if(ge(Ge)||L(Ge))return rr!==null?null:it(Pe,Ce,Ge,lt,null);if(typeof Ge.then=="function")return Xe(Pe,Ce,Ot(Ge),lt);if(Ge.$$typeof===T)return Xe(Pe,Ce,If(Pe,Ge),lt);Pt(Pe,Ge)}return null}function Ze(Pe,Ce,Ge,lt,rr){if(typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint")return Pe=Pe.get(Ge)||null,ne(Ce,Pe,""+lt,rr);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case g:return Pe=Pe.get(lt.key===null?Ge:lt.key)||null,Ae(Ce,Pe,lt,rr);case b:return Pe=Pe.get(lt.key===null?Ge:lt.key)||null,$e(Ce,Pe,lt,rr);case W:return lt=Ue(lt),Ze(Pe,Ce,Ge,lt,rr)}if(ge(lt)||L(lt))return Pe=Pe.get(Ge)||null,it(Ce,Pe,lt,rr,null);if(typeof lt.then=="function")return Ze(Pe,Ce,Ge,Ot(lt),rr);if(lt.$$typeof===T)return Ze(Pe,Ce,Ge,If(Ce,lt),rr);Pt(Ce,lt)}return null}function Ut(Pe,Ce,Ge,lt){for(var rr=null,Jr=null,$t=Ce,kr=Ce=0,Mr=null;$t!==null&&kr<Ge.length;kr++){$t.index>kr?(Mr=$t,$t=null):Mr=$t.sibling;var Zr=Xe(Pe,$t,Ge[kr],lt);if(Zr===null){$t===null&&($t=Mr);break}s&&$t&&Zr.alternate===null&&l(Pe,$t),Ce=k(Zr,Ce,kr),Jr===null?rr=Zr:Jr.sibling=Zr,Jr=Zr,$t=Mr}if(kr===Ge.length)return f(Pe,$t),Rr&&Ii(Pe,kr),rr;if($t===null){for(;kr<Ge.length;kr++)$t=ut(Pe,Ge[kr],lt),$t!==null&&(Ce=k($t,Ce,kr),Jr===null?rr=$t:Jr.sibling=$t,Jr=$t);return Rr&&Ii(Pe,kr),rr}for($t=m($t);kr<Ge.length;kr++)Mr=Ze($t,Pe,kr,Ge[kr],lt),Mr!==null&&(s&&Mr.alternate!==null&&$t.delete(Mr.key===null?kr:Mr.key),Ce=k(Mr,Ce,kr),Jr===null?rr=Mr:Jr.sibling=Mr,Jr=Mr);return s&&$t.forEach(function(Hc){return l(Pe,Hc)}),Rr&&Ii(Pe,kr),rr}function lr(Pe,Ce,Ge,lt){if(Ge==null)throw Error(a(151));for(var rr=null,Jr=null,$t=Ce,kr=Ce=0,Mr=null,Zr=Ge.next();$t!==null&&!Zr.done;kr++,Zr=Ge.next()){$t.index>kr?(Mr=$t,$t=null):Mr=$t.sibling;var Hc=Xe(Pe,$t,Zr.value,lt);if(Hc===null){$t===null&&($t=Mr);break}s&&$t&&Hc.alternate===null&&l(Pe,$t),Ce=k(Hc,Ce,kr),Jr===null?rr=Hc:Jr.sibling=Hc,Jr=Hc,$t=Mr}if(Zr.done)return f(Pe,$t),Rr&&Ii(Pe,kr),rr;if($t===null){for(;!Zr.done;kr++,Zr=Ge.next())Zr=ut(Pe,Zr.value,lt),Zr!==null&&(Ce=k(Zr,Ce,kr),Jr===null?rr=Zr:Jr.sibling=Zr,Jr=Zr);return Rr&&Ii(Pe,kr),rr}for($t=m($t);!Zr.done;kr++,Zr=Ge.next())Zr=Ze($t,Pe,kr,Zr.value,lt),Zr!==null&&(s&&Zr.alternate!==null&&$t.delete(Zr.key===null?kr:Zr.key),Ce=k(Zr,Ce,kr),Jr===null?rr=Zr:Jr.sibling=Zr,Jr=Zr);return s&&$t.forEach(function(Jk){return l(Pe,Jk)}),Rr&&Ii(Pe,kr),rr}function xa(Pe,Ce,Ge,lt){if(typeof Ge=="object"&&Ge!==null&&Ge.type===w&&Ge.key===null&&(Ge=Ge.props.children),typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case g:e:{for(var rr=Ge.key;Ce!==null;){if(Ce.key===rr){if(rr=Ge.type,rr===w){if(Ce.tag===7){f(Pe,Ce.sibling),lt=_(Ce,Ge.props.children),lt.return=Pe,Pe=lt;break e}}else if(Ce.elementType===rr||typeof rr=="object"&&rr!==null&&rr.$$typeof===W&&Ue(rr)===Ce.type){f(Pe,Ce.sibling),lt=_(Ce,Ge.props),mr(lt,Ge),lt.return=Pe,Pe=lt;break e}f(Pe,Ce);break}else l(Pe,Ce);Ce=Ce.sibling}Ge.type===w?(lt=Qo(Ge.props.children,Pe.mode,lt,Ge.key),lt.return=Pe,Pe=lt):(lt=wc(Ge.type,Ge.key,Ge.props,null,Pe.mode,lt),mr(lt,Ge),lt.return=Pe,Pe=lt)}return U(Pe);case b:e:{for(rr=Ge.key;Ce!==null;){if(Ce.key===rr)if(Ce.tag===4&&Ce.stateNode.containerInfo===Ge.containerInfo&&Ce.stateNode.implementation===Ge.implementation){f(Pe,Ce.sibling),lt=_(Ce,Ge.children||[]),lt.return=Pe,Pe=lt;break e}else{f(Pe,Ce);break}else l(Pe,Ce);Ce=Ce.sibling}lt=bc(Ge,Pe.mode,lt),lt.return=Pe,Pe=lt}return U(Pe);case W:return Ge=Ue(Ge),xa(Pe,Ce,Ge,lt)}if(ge(Ge))return Ut(Pe,Ce,Ge,lt);if(L(Ge)){if(rr=L(Ge),typeof rr!="function")throw Error(a(150));return Ge=rr.call(Ge),lr(Pe,Ce,Ge,lt)}if(typeof Ge.then=="function")return xa(Pe,Ce,Ot(Ge),lt);if(Ge.$$typeof===T)return xa(Pe,Ce,If(Pe,Ge),lt);Pt(Pe,Ge)}return typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint"?(Ge=""+Ge,Ce!==null&&Ce.tag===6?(f(Pe,Ce.sibling),lt=_(Ce,Ge),lt.return=Pe,Pe=lt):(f(Pe,Ce),lt=Nu(Ge,Pe.mode,lt),lt.return=Pe,Pe=lt),U(Pe)):f(Pe,Ce)}return function(Pe,Ce,Ge,lt){try{qt=0;var rr=xa(Pe,Ce,Ge,lt);return ft=null,rr}catch($t){if($t===je||$t===ve)throw $t;var Jr=Vn(29,$t,null,Pe.mode);return Jr.lanes=lt,Jr.return=Pe,Jr}}}var wa=Or(!0),xr=Or(!1),Ft=!1;function Nt(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Na(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function or(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function wr(s,l,f){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,(aa&2)!==0){var _=m.pending;return _===null?l.next=l:(l.next=_.next,_.next=l),m.pending=l,l=Wn(s),ku(s,null,f),l}return Eu(s,m,l,f),Wn(s)}function ta(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var m=l.lanes;m&=s.pendingLanes,f|=m,l.lanes=f,On(s,f)}}function dn(s,l){var f=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,f===m)){var _=null,k=null;if(f=f.firstBaseUpdate,f!==null){do{var U={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};k===null?_=k=U:k=k.next=U,f=f.next}while(f!==null);k===null?_=k=l:k=k.next=l}else _=k=l;f={baseState:m.baseState,firstBaseUpdate:_,lastBaseUpdate:k,shared:m.shared,callbacks:m.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}var Bn=!1;function ma(){if(Bn){var s=S;if(s!==null)throw s}}function en(s,l,f,m){Bn=!1;var _=s.updateQueue;Ft=!1;var k=_.firstBaseUpdate,U=_.lastBaseUpdate,ne=_.shared.pending;if(ne!==null){_.shared.pending=null;var Ae=ne,$e=Ae.next;Ae.next=null,U===null?k=$e:U.next=$e,U=Ae;var it=s.alternate;it!==null&&(it=it.updateQueue,ne=it.lastBaseUpdate,ne!==U&&(ne===null?it.firstBaseUpdate=$e:ne.next=$e,it.lastBaseUpdate=Ae))}if(k!==null){var ut=_.baseState;U=0,it=$e=Ae=null,ne=k;do{var Xe=ne.lane&-536870913,Ze=Xe!==ne.lane;if(Ze?(Pr&Xe)===Xe:(m&Xe)===Xe){Xe!==0&&Xe===x&&(Bn=!0),it!==null&&(it=it.next={lane:0,tag:ne.tag,payload:ne.payload,callback:null,next:null});e:{var Ut=s,lr=ne;Xe=l;var xa=f;switch(lr.tag){case 1:if(Ut=lr.payload,typeof Ut=="function"){ut=Ut.call(xa,ut,Xe);break e}ut=Ut;break e;case 3:Ut.flags=Ut.flags&-65537|128;case 0:if(Ut=lr.payload,Xe=typeof Ut=="function"?Ut.call(xa,ut,Xe):Ut,Xe==null)break e;ut=v({},ut,Xe);break e;case 2:Ft=!0}}Xe=ne.callback,Xe!==null&&(s.flags|=64,Ze&&(s.flags|=8192),Ze=_.callbacks,Ze===null?_.callbacks=[Xe]:Ze.push(Xe))}else Ze={lane:Xe,tag:ne.tag,payload:ne.payload,callback:ne.callback,next:null},it===null?($e=it=Ze,Ae=ut):it=it.next=Ze,U|=Xe;if(ne=ne.next,ne===null){if(ne=_.shared.pending,ne===null)break;Ze=ne,ne=Ze.next,Ze.next=null,_.lastBaseUpdate=Ze,_.shared.pending=null}}while(!0);it===null&&(Ae=ut),_.baseState=Ae,_.firstBaseUpdate=$e,_.lastBaseUpdate=it,k===null&&(_.shared.lanes=0),Rc|=U,s.lanes=U,s.memoizedState=ut}}function Gn(s,l){if(typeof s!="function")throw Error(a(191,s));s.call(l)}function tn(s,l){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)Gn(f[s],l)}var Nr=Q(null),qr=Q(0);function Ta(s,l){s=$l,M(qr,s),M(Nr,l),$l=s|l.baseLanes}function Xr(){M(qr,$l),M(Nr,Nr.current)}function pn(){$l=qr.current,N(Nr),N(qr)}var ja=Q(null),zr=null;function Va(s){var l=s.alternate;M(Ur,Ur.current&1),M(ja,s),zr===null&&(l===null||Nr.current!==null||l.memoizedState!==null)&&(zr=s)}function ra(s){M(Ur,Ur.current),M(ja,s),zr===null&&(zr=s)}function rn(s){s.tag===22?(M(Ur,Ur.current),M(ja,s),zr===null&&(zr=s)):an()}function an(){M(Ur,Ur.current),M(ja,ja.current)}function ia(s){N(ja),zr===s&&(zr=null),N(Ur)}var Ur=Q(0);function $n(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Gm(f)||$m(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Ma=0,Qt=null,tr=null,Hr=null,vi=!1,es=!1,oi=!1,nn=0,sl=0,ol=null,Uf=0;function ga(){throw Error(a(321))}function t0(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!Ln(s[f],l[f]))return!1;return!0}function r0(s,l,f,m,_,k){return Ma=k,Qt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,ie.H=s===null||s.memoizedState===null?dx:am,oi=!1,k=f(m,_),oi=!1,es&&(k=jo(l,f,m,_)),qf(s),k}function qf(s){ie.H=u0;var l=tr!==null&&tr.next!==null;if(Ma=0,Hr=tr=Qt=null,vi=!1,sl=0,ol=null,l)throw Error(a(300));s===null||En||(s=s.dependencies,s!==null&&Mf(s)&&(En=!0))}function jo(s,l,f,m){Qt=s;var _=0;do{if(es&&(ol=null),sl=0,es=!1,25<=_)throw Error(a(301));if(_+=1,Hr=tr=null,s.updateQueue!=null){var k=s.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}ie.H=px,k=l(f,m)}while(es);return k}function Kp(){var s=ie.H,l=s.useState()[0];return l=typeof l.then=="function"?ll(l):l,s=s.useState()[0],(tr!==null?tr.memoizedState:null)!==s&&(Qt.flags|=1024),l}function a0(){var s=nn!==0;return nn=0,s}function n0(s,l,f){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~f}function zf(s){if(vi){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}vi=!1}Ma=0,Hr=tr=Qt=null,es=!1,sl=nn=0,ol=null}function Sn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hr===null?Qt.memoizedState=Hr=s:Hr=Hr.next=s,Hr}function Ia(){if(tr===null){var s=Qt.alternate;s=s!==null?s.memoizedState:null}else s=tr.next;var l=Hr===null?Qt.memoizedState:Hr.next;if(l!==null)Hr=l,tr=s;else{if(s===null)throw Qt.alternate===null?Error(a(467)):Error(a(310));tr=s,s={memoizedState:tr.memoizedState,baseState:tr.baseState,baseQueue:tr.baseQueue,queue:tr.queue,next:null},Hr===null?Qt.memoizedState=Hr=s:Hr=Hr.next=s}return Hr}function Ou(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ll(s){var l=sl;return sl+=1,ol===null&&(ol=[]),s=at(ol,s,l),l=Qt,(Hr===null?l.memoizedState:Hr.next)===null&&(l=l.alternate,ie.H=l===null||l.memoizedState===null?dx:am),s}function Nc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return ll(s);if(s.$$typeof===T)return In(s)}throw Error(a(438,String(s)))}function Il(s){var l=null,f=Qt.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var m=Qt.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(l={data:m.data.map(function(_){return _.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=Ou(),Qt.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(s),m=0;m<s;m++)f[m]=Y;return l.index++,f}function $s(s,l){return typeof l=="function"?l(s):l}function Hf(s){var l=Ia();return Tc(l,tr,s)}function Tc(s,l,f){var m=s.queue;if(m===null)throw Error(a(311));m.lastRenderedReducer=f;var _=s.baseQueue,k=m.pending;if(k!==null){if(_!==null){var U=_.next;_.next=k.next,k.next=U}l.baseQueue=_=k,m.pending=null}if(k=s.baseState,_===null)s.memoizedState=k;else{l=_.next;var ne=U=null,Ae=null,$e=l,it=!1;do{var ut=$e.lane&-536870913;if(ut!==$e.lane?(Pr&ut)===ut:(Ma&ut)===ut){var Xe=$e.revertLane;if(Xe===0)Ae!==null&&(Ae=Ae.next={lane:0,revertLane:0,gesture:null,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null}),ut===x&&(it=!0);else if((Ma&Xe)===Xe){$e=$e.next,Xe===x&&(it=!0);continue}else ut={lane:0,revertLane:$e.revertLane,gesture:null,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null},Ae===null?(ne=Ae=ut,U=k):Ae=Ae.next=ut,Qt.lanes|=Xe,Rc|=Xe;ut=$e.action,oi&&f(k,ut),k=$e.hasEagerState?$e.eagerState:f(k,ut)}else Xe={lane:ut,revertLane:$e.revertLane,gesture:$e.gesture,action:$e.action,hasEagerState:$e.hasEagerState,eagerState:$e.eagerState,next:null},Ae===null?(ne=Ae=Xe,U=k):Ae=Ae.next=Xe,Qt.lanes|=ut,Rc|=ut;$e=$e.next}while($e!==null&&$e!==l);if(Ae===null?U=k:Ae.next=ne,!Ln(k,s.memoizedState)&&(En=!0,it&&(f=S,f!==null)))throw f;s.memoizedState=k,s.baseState=U,s.baseQueue=Ae,m.lastRenderedState=k}return _===null&&(m.lanes=0),[s.memoizedState,m.dispatch]}function Wf(s){var l=Ia(),f=l.queue;if(f===null)throw Error(a(311));f.lastRenderedReducer=s;var m=f.dispatch,_=f.pending,k=l.memoizedState;if(_!==null){f.pending=null;var U=_=_.next;do k=s(k,U.action),U=U.next;while(U!==_);Ln(k,l.memoizedState)||(En=!0),l.memoizedState=k,l.baseQueue===null&&(l.baseState=k),f.lastRenderedState=k}return[k,m]}function Vf(s,l,f){var m=Qt,_=Ia(),k=Rr;if(k){if(f===void 0)throw Error(a(407));f=f()}else f=l();var U=!Ln((tr||_).memoizedState,f);if(U&&(_.memoizedState=f,En=!0),_=_.queue,Jp(s0.bind(null,m,_,s),[s]),_.getSnapshot!==l||U||Hr!==null&&Hr.memoizedState.tag&1){if(m.flags|=2048,Ul(9,{destroy:void 0},i0.bind(null,m,_,f,l),null),ba===null)throw Error(a(349));k||(Ma&127)!==0||Co(m,l,f)}return f}function Co(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=Qt.updateQueue,l===null?(l=Ou(),Qt.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function i0(s,l,f,m){l.value=f,l.getSnapshot=m,Rd(l)&&o0(s)}function s0(s,l,f){return f(function(){Rd(l)&&o0(s)})}function Rd(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!Ln(s,f)}catch{return!0}}function o0(s){var l=No(s,2);l!==null&&is(l,s,2)}function cl(s){var l=Sn();if(typeof s=="function"){var f=s;if(s=f(),oi){nr(!0);try{f()}finally{nr(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:s},l}function Ld(s,l,f,m){return s.baseState=f,Tc(s,tr,typeof m=="function"?m:$s)}function Dd(s,l,f,m,_){if(Bd(s))throw Error(a(485));if(s=l.action,s!==null){var k={payload:_,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(U){k.listeners.push(U)}};ie.T!==null?f(!0):k.isTransition=!1,m(k),f=l.pending,f===null?(k.next=l.pending=k,Pd(l,k)):(k.next=f.next,l.pending=f.next=k)}}function Pd(s,l){var f=l.action,m=l.payload,_=s.state;if(l.isTransition){var k=ie.T,U={};ie.T=U;try{var ne=f(_,m),Ae=ie.S;Ae!==null&&Ae(U,ne),l0(s,l,ne)}catch($e){Bl(s,l,$e)}finally{k!==null&&U.types!==null&&(k.types=U.types),ie.T=k}}else try{k=f(_,m),l0(s,l,k)}catch($e){Bl(s,l,$e)}}function l0(s,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(m){Md(s,l,m)},function(m){return Bl(s,l,m)}):Md(s,l,f)}function Md(s,l,f){l.status="fulfilled",l.value=f,Gf(l),s.state=f,l=s.pending,l!==null&&(f=l.next,f===l?s.pending=null:(f=f.next,l.next=f,Pd(s,f)))}function Bl(s,l,f){var m=s.pending;if(s.pending=null,m!==null){m=m.next;do l.status="rejected",l.reason=f,Gf(l),l=l.next;while(l!==m)}s.action=null}function Gf(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function Fu(s,l){return l}function Xs(s,l){if(Rr){var f=ba.formState;if(f!==null){e:{var m=Qt;if(Rr){if(_a){t:{for(var _=_a,k=Pa;_.nodeType!==8;){if(!k){_=null;break t}if(_=Ys(_.nextSibling),_===null){_=null;break t}}k=_.data,_=k==="F!"||k==="F"?_:null}if(_){_a=Ys(_.nextSibling),m=_.data==="F!";break e}}tl(m)}m=!1}m&&(l=f[0])}}return f=Sn(),f.memoizedState=f.baseState=l,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fu,lastRenderedState:l},f.queue=m,f=ux.bind(null,Qt,m),m.dispatch=f,m=cl(!1),k=rm.bind(null,Qt,!1,m.queue),m=Sn(),_={state:l,dispatch:null,action:s,pending:null},m.queue=_,f=Dd.bind(null,Qt,_,k,f),_.dispatch=f,m.memoizedState=s,[l,f,!1]}function Oo(s){var l=Ia();return Fo(l,tr,s)}function Fo(s,l,f){if(l=Tc(s,l,Fu)[0],s=Hf($s)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var m=ll(l)}catch(U){throw U===je?ve:U}else m=l;l=Ia();var _=l.queue,k=_.dispatch;return f!==l.memoizedState&&(Qt.flags|=2048,Ul(9,{destroy:void 0},$f.bind(null,_,f),null)),[m,k,s]}function $f(s,l){s.action=l}function Xf(s){var l=Ia(),f=tr;if(f!==null)return Fo(l,f,s);Ia(),l=l.memoizedState,f=Ia();var m=f.queue.dispatch;return f.memoizedState=s,[l,m,!1]}function Ul(s,l,f,m){return s={tag:s,create:f,deps:m,inst:l,next:null},l=Qt.updateQueue,l===null&&(l=Ou(),Qt.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=s.next=s:(m=f.next,f.next=s,s.next=m,l.lastEffect=s),s}function Id(){return Ia().memoizedState}function jc(s,l,f,m){var _=Sn();Qt.flags|=s,_.memoizedState=Ul(1|l,{destroy:void 0},f,m===void 0?null:m)}function Cc(s,l,f,m){var _=Ia();m=m===void 0?null:m;var k=_.memoizedState.inst;tr!==null&&m!==null&&t0(m,tr.memoizedState.deps)?_.memoizedState=Ul(l,k,f,m):(Qt.flags|=s,_.memoizedState=Ul(1|l,k,f,m))}function K2(s,l){jc(8390656,8,s,l)}function Jp(s,l){Cc(2048,8,s,l)}function VE(s){Qt.flags|=4;var l=Qt.updateQueue;if(l===null)l=Ou(),Qt.updateQueue=l,l.events=[s];else{var f=l.events;f===null?l.events=[s]:f.push(s)}}function J2(s){var l=Ia().memoizedState;return VE({ref:l,nextImpl:s}),function(){if((aa&2)!==0)throw Error(a(440));return l.impl.apply(void 0,arguments)}}function Z2(s,l){return Cc(4,2,s,l)}function Q2(s,l){return Cc(4,4,s,l)}function ex(s,l){if(typeof l=="function"){s=s();var f=l(s);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function tx(s,l,f){f=f!=null?f.concat([s]):null,Cc(4,4,ex.bind(null,l,s),f)}function Zp(){}function rx(s,l){var f=Ia();l=l===void 0?null:l;var m=f.memoizedState;return l!==null&&t0(l,m[1])?m[0]:(f.memoizedState=[s,l],s)}function ax(s,l){var f=Ia();l=l===void 0?null:l;var m=f.memoizedState;if(l!==null&&t0(l,m[1]))return m[0];if(m=s(),oi){nr(!0);try{s()}finally{nr(!1)}}return f.memoizedState=[m,l],m}function Qp(s,l,f){return f===void 0||(Ma&1073741824)!==0&&(Pr&261930)===0?s.memoizedState=l:(s.memoizedState=f,s=ny(),Qt.lanes|=s,Rc|=s,f)}function nx(s,l,f,m){return Ln(f,l)?f:Nr.current!==null?(s=Qp(s,f,m),Ln(s,l)||(En=!0),s):(Ma&42)===0||(Ma&1073741824)!==0&&(Pr&261930)===0?(En=!0,s.memoizedState=f):(s=ny(),Qt.lanes|=s,Rc|=s,l)}function ix(s,l,f,m,_){var k=he.p;he.p=k!==0&&8>k?k:8;var U=ie.T,ne={};ie.T=ne,rm(s,!1,l,f);try{var Ae=_(),$e=ie.S;if($e!==null&&$e(ne,Ae),Ae!==null&&typeof Ae=="object"&&typeof Ae.then=="function"){var it=X(Ae,m);c0(s,l,it,ks(s))}else c0(s,l,m,ks(s))}catch(ut){c0(s,l,{then:function(){},status:"rejected",reason:ut},ks())}finally{he.p=k,U!==null&&ne.types!==null&&(U.types=ne.types),ie.T=U}}function GE(){}function em(s,l,f,m){if(s.tag!==5)throw Error(a(476));var _=sx(s).queue;ix(s,_,l,de,f===null?GE:function(){return ox(s),f(m)})}function sx(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:de,baseState:de,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:de},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:f},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function ox(s){var l=sx(s);l.next===null&&(l=s.alternate.memoizedState),c0(s,l.next.queue,{},ks())}function tm(){return In(A0)}function lx(){return Ia().memoizedState}function cx(){return Ia().memoizedState}function $E(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var f=ks();s=or(f);var m=wr(l,s,f);m!==null&&(is(m,l,f),ta(m,l,f)),l={cache:Ac()},s.payload=l;return}l=l.return}}function XE(s,l,f){var m=ks();f={lane:m,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Bd(s)?fx(l,f):(f=jf(s,l,f,m),f!==null&&(is(f,s,m),hx(f,l,m)))}function ux(s,l,f){var m=ks();c0(s,l,f,m)}function c0(s,l,f,m){var _={lane:m,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Bd(s))fx(l,_);else{var k=s.alternate;if(s.lanes===0&&(k===null||k.lanes===0)&&(k=l.lastRenderedReducer,k!==null))try{var U=l.lastRenderedState,ne=k(U,f);if(_.hasEagerState=!0,_.eagerState=ne,Ln(ne,U))return Eu(s,l,_,0),ba===null&&Su(),!1}catch{}if(f=jf(s,l,_,m),f!==null)return is(f,s,m),hx(f,l,m),!0}return!1}function rm(s,l,f,m){if(m={lane:2,revertLane:Lm(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Bd(s)){if(l)throw Error(a(479))}else l=jf(s,f,m,2),l!==null&&is(l,s,2)}function Bd(s){var l=s.alternate;return s===Qt||l!==null&&l===Qt}function fx(s,l){es=vi=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function hx(s,l,f){if((f&4194048)!==0){var m=l.lanes;m&=s.pendingLanes,f|=m,l.lanes=f,On(s,f)}}var u0={readContext:In,use:Nc,useCallback:ga,useContext:ga,useEffect:ga,useImperativeHandle:ga,useLayoutEffect:ga,useInsertionEffect:ga,useMemo:ga,useReducer:ga,useRef:ga,useState:ga,useDebugValue:ga,useDeferredValue:ga,useTransition:ga,useSyncExternalStore:ga,useId:ga,useHostTransitionStatus:ga,useFormState:ga,useActionState:ga,useOptimistic:ga,useMemoCache:ga,useCacheRefresh:ga};u0.useEffectEvent=ga;var dx={readContext:In,use:Nc,useCallback:function(s,l){return Sn().memoizedState=[s,l===void 0?null:l],s},useContext:In,useEffect:K2,useImperativeHandle:function(s,l,f){f=f!=null?f.concat([s]):null,jc(4194308,4,ex.bind(null,l,s),f)},useLayoutEffect:function(s,l){return jc(4194308,4,s,l)},useInsertionEffect:function(s,l){jc(4,2,s,l)},useMemo:function(s,l){var f=Sn();l=l===void 0?null:l;var m=s();if(oi){nr(!0);try{s()}finally{nr(!1)}}return f.memoizedState=[m,l],m},useReducer:function(s,l,f){var m=Sn();if(f!==void 0){var _=f(l);if(oi){nr(!0);try{f(l)}finally{nr(!1)}}}else _=l;return m.memoizedState=m.baseState=_,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:_},m.queue=s,s=s.dispatch=XE.bind(null,Qt,s),[m.memoizedState,s]},useRef:function(s){var l=Sn();return s={current:s},l.memoizedState=s},useState:function(s){s=cl(s);var l=s.queue,f=ux.bind(null,Qt,l);return l.dispatch=f,[s.memoizedState,f]},useDebugValue:Zp,useDeferredValue:function(s,l){var f=Sn();return Qp(f,s,l)},useTransition:function(){var s=cl(!1);return s=ix.bind(null,Qt,s.queue,!0,!1),Sn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,f){var m=Qt,_=Sn();if(Rr){if(f===void 0)throw Error(a(407));f=f()}else{if(f=l(),ba===null)throw Error(a(349));(Pr&127)!==0||Co(m,l,f)}_.memoizedState=f;var k={value:f,getSnapshot:l};return _.queue=k,K2(s0.bind(null,m,k,s),[s]),m.flags|=2048,Ul(9,{destroy:void 0},i0.bind(null,m,k,f,l),null),f},useId:function(){var s=Sn(),l=ba.identifierPrefix;if(Rr){var f=Zi,m=Ji;f=(m&~(1<<32-br(m)-1)).toString(32)+f,l="_"+l+"R_"+f,f=nn++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=Uf++,l="_"+l+"r_"+f.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:tm,useFormState:Xs,useActionState:Xs,useOptimistic:function(s){var l=Sn();l.memoizedState=l.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=rm.bind(null,Qt,!0,f),f.dispatch=l,[s,l]},useMemoCache:Il,useCacheRefresh:function(){return Sn().memoizedState=$E.bind(null,Qt)},useEffectEvent:function(s){var l=Sn(),f={impl:s};return l.memoizedState=f,function(){if((aa&2)!==0)throw Error(a(440));return f.impl.apply(void 0,arguments)}}},am={readContext:In,use:Nc,useCallback:rx,useContext:In,useEffect:Jp,useImperativeHandle:tx,useInsertionEffect:Z2,useLayoutEffect:Q2,useMemo:ax,useReducer:Hf,useRef:Id,useState:function(){return Hf($s)},useDebugValue:Zp,useDeferredValue:function(s,l){var f=Ia();return nx(f,tr.memoizedState,s,l)},useTransition:function(){var s=Hf($s)[0],l=Ia().memoizedState;return[typeof s=="boolean"?s:ll(s),l]},useSyncExternalStore:Vf,useId:lx,useHostTransitionStatus:tm,useFormState:Oo,useActionState:Oo,useOptimistic:function(s,l){var f=Ia();return Ld(f,tr,s,l)},useMemoCache:Il,useCacheRefresh:cx};am.useEffectEvent=J2;var px={readContext:In,use:Nc,useCallback:rx,useContext:In,useEffect:Jp,useImperativeHandle:tx,useInsertionEffect:Z2,useLayoutEffect:Q2,useMemo:ax,useReducer:Wf,useRef:Id,useState:function(){return Wf($s)},useDebugValue:Zp,useDeferredValue:function(s,l){var f=Ia();return tr===null?Qp(f,s,l):nx(f,tr.memoizedState,s,l)},useTransition:function(){var s=Wf($s)[0],l=Ia().memoizedState;return[typeof s=="boolean"?s:ll(s),l]},useSyncExternalStore:Vf,useId:lx,useHostTransitionStatus:tm,useFormState:Xf,useActionState:Xf,useOptimistic:function(s,l){var f=Ia();return tr!==null?Ld(f,tr,s,l):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:Il,useCacheRefresh:cx};px.useEffectEvent=J2;function nm(s,l,f,m){l=s.memoizedState,f=f(m,l),f=f==null?l:v({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var im={enqueueSetState:function(s,l,f){s=s._reactInternals;var m=ks(),_=or(m);_.payload=l,f!=null&&(_.callback=f),l=wr(s,_,m),l!==null&&(is(l,s,m),ta(l,s,m))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var m=ks(),_=or(m);_.tag=1,_.payload=l,f!=null&&(_.callback=f),l=wr(s,_,m),l!==null&&(is(l,s,m),ta(l,s,m))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=ks(),m=or(f);m.tag=2,l!=null&&(m.callback=l),l=wr(s,m,f),l!==null&&(is(l,s,f),ta(l,s,f))}};function mx(s,l,f,m,_,k,U){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,k,U):l.prototype&&l.prototype.isPureReactComponent?!So(f,m)||!So(_,k):!0}function gx(s,l,f,m){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,m),l.state!==s&&im.enqueueReplaceState(l,l.state,null)}function Ru(s,l){var f=l;if("ref"in l){f={};for(var m in l)m!=="ref"&&(f[m]=l[m])}if(s=s.defaultProps){f===l&&(f=v({},f));for(var _ in s)f[_]===void 0&&(f[_]=s[_])}return f}function vx(s){bu(s)}function xx(s){console.error(s)}function yx(s){bu(s)}function Ud(s,l){try{var f=s.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(m){setTimeout(function(){throw m})}}function _x(s,l,f){try{var m=s.onCaughtError;m(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function sm(s,l,f){return f=or(f),f.tag=3,f.payload={element:null},f.callback=function(){Ud(s,l)},f}function wx(s){return s=or(s),s.tag=3,s}function bx(s,l,f,m){var _=f.type.getDerivedStateFromError;if(typeof _=="function"){var k=m.value;s.payload=function(){return _(k)},s.callback=function(){_x(l,f,m)}}var U=f.stateNode;U!==null&&typeof U.componentDidCatch=="function"&&(s.callback=function(){_x(l,f,m),typeof _!="function"&&(Lc===null?Lc=new Set([this]):Lc.add(this));var ne=m.stack;this.componentDidCatch(m.value,{componentStack:ne!==null?ne:""})})}function YE(s,l,f,m,_){if(f.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(l=f.alternate,l!==null&&nl(l,f,_,!0),f=ja.current,f!==null){switch(f.tag){case 31:case 13:return zr===null?Zd():f.alternate===null&&sn===0&&(sn=3),f.flags&=-257,f.flags|=65536,f.lanes=_,m===Fe?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([m]):l.add(m),Om(s,m,_)),!1;case 22:return f.flags|=65536,m===Fe?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([m])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([m]):f.add(m)),Om(s,m,_)),!1}throw Error(a(435,f.tag))}return Om(s,m,_),Zd(),!1}if(Rr)return l=ja.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=_,m!==bs&&(s=Error(a(422),{cause:m}),Ec(Xi(s,f)))):(m!==bs&&(l=Error(a(423),{cause:m}),Ec(Xi(l,f))),s=s.current.alternate,s.flags|=65536,_&=-_,s.lanes|=_,m=Xi(m,f),_=sm(s.stateNode,m,_),dn(s,_),sn!==4&&(sn=2)),!1;var k=Error(a(520),{cause:m});if(k=Xi(k,f),x0===null?x0=[k]:x0.push(k),sn!==4&&(sn=2),l===null)return!0;m=Xi(m,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,s=_&-_,f.lanes|=s,s=sm(f.stateNode,m,s),dn(f,s),!1;case 1:if(l=f.type,k=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Lc===null||!Lc.has(k))))return f.flags|=65536,_&=-_,f.lanes|=_,_=wx(_),bx(_,s,f,m),dn(f,_),!1}f=f.return}while(f!==null);return!1}var om=Error(a(461)),En=!1;function li(s,l,f,m){l.child=s===null?xr(l,null,f,m):wa(l,s.child,f,m)}function Sx(s,l,f,m,_){f=f.render;var k=l.ref;if("ref"in m){var U={};for(var ne in m)ne!=="ref"&&(U[ne]=m[ne])}else U=m;return il(l),m=r0(s,l,f,U,k,_),ne=a0(),s!==null&&!En?(n0(s,l,_),ql(s,l,_)):(Rr&&ne&&Zh(l),l.flags|=1,li(s,l,m,_),l.child)}function Ex(s,l,f,m,_){if(s===null){var k=f.type;return typeof k=="function"&&!Of(k)&&k.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=k,kx(s,l,k,m,_)):(s=wc(f.type,null,m,l,l.mode,_),s.ref=l.ref,s.return=l,l.child=s)}if(k=s.child,!mm(s,_)){var U=k.memoizedProps;if(f=f.compare,f=f!==null?f:So,f(U,m)&&s.ref===l.ref)return ql(s,l,_)}return l.flags|=1,s=$i(k,m),s.ref=l.ref,s.return=l,l.child=s}function kx(s,l,f,m,_){if(s!==null){var k=s.memoizedProps;if(So(k,m)&&s.ref===l.ref)if(En=!1,l.pendingProps=m=k,mm(s,_))(s.flags&131072)!==0&&(En=!0);else return l.lanes=s.lanes,ql(s,l,_)}return lm(s,l,f,m,_)}function Ax(s,l,f,m){var _=m.children,k=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((l.flags&128)!==0){if(k=k!==null?k.baseLanes|f:f,s!==null){for(m=l.child=s.child,_=0;m!==null;)_=_|m.lanes|m.childLanes,m=m.sibling;m=_&~k}else m=0,l.child=null;return Nx(s,l,k,f,m)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&fe(l,k!==null?k.cachePool:null),k!==null?Ta(l,k):Xr(),rn(l);else return m=l.lanes=536870912,Nx(s,l,k!==null?k.baseLanes|f:f,f,m)}else k!==null?(fe(l,k.cachePool),Ta(l,k),an(),l.memoizedState=null):(s!==null&&fe(l,null),Xr(),an());return li(s,l,_,f),l.child}function f0(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function Nx(s,l,f,m,_){var k=le();return k=k===null?null:{parent:Wa._currentValue,pool:k},l.memoizedState={baseLanes:f,cachePool:k},s!==null&&fe(l,null),Xr(),rn(l),s!==null&&nl(s,l,m,!0),l.childLanes=_,null}function qd(s,l){return l=Hd({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function Tx(s,l,f){return wa(l,s.child,null,f),s=qd(l,l.pendingProps),s.flags|=2,ia(l),l.memoizedState=null,s}function KE(s,l,f){var m=l.pendingProps,_=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(Rr){if(m.mode==="hidden")return s=qd(l,m),l.lanes=536870912,f0(null,s);if(ra(l),(s=_a)?(s=Uy(s,Pa),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:el!==null?{id:Ji,overflow:Zi}:null,retryLane:536870912,hydrationErrors:null},f=Ff(s),f.return=l,l.child=f,Pn=l,_a=null)):s=null,s===null)throw tl(l);return l.lanes=536870912,null}return qd(l,m)}var k=s.memoizedState;if(k!==null){var U=k.dehydrated;if(ra(l),_)if(l.flags&256)l.flags&=-257,l=Tx(s,l,f);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(a(558));else if(En||nl(s,l,f,!1),_=(f&s.childLanes)!==0,En||_){if(m=ba,m!==null&&(U=ei(m,f),U!==0&&U!==k.retryLane))throw k.retryLane=U,No(s,U),is(m,s,U),om;Zd(),l=Tx(s,l,f)}else s=k.treeContext,_a=Ys(U.nextSibling),Pn=l,Rr=!0,si=null,Pa=!1,s!==null&&Od(l,s),l=qd(l,m),l.flags|=4096;return l}return s=$i(s.child,{mode:m.mode,children:m.children}),s.ref=l.ref,l.child=s,s.return=l,s}function zd(s,l){var f=l.ref;if(f===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(a(284));(s===null||s.ref!==f)&&(l.flags|=4194816)}}function lm(s,l,f,m,_){return il(l),f=r0(s,l,f,m,void 0,_),m=a0(),s!==null&&!En?(n0(s,l,_),ql(s,l,_)):(Rr&&m&&Zh(l),l.flags|=1,li(s,l,f,_),l.child)}function jx(s,l,f,m,_,k){return il(l),l.updateQueue=null,f=jo(l,m,f,_),qf(s),m=a0(),s!==null&&!En?(n0(s,l,k),ql(s,l,k)):(Rr&&m&&Zh(l),l.flags|=1,li(s,l,f,k),l.child)}function Cx(s,l,f,m,_){if(il(l),l.stateNode===null){var k=Dn,U=f.contextType;typeof U=="object"&&U!==null&&(k=In(U)),k=new f(m,k),l.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=im,l.stateNode=k,k._reactInternals=l,k=l.stateNode,k.props=m,k.state=l.memoizedState,k.refs={},Nt(l),U=f.contextType,k.context=typeof U=="object"&&U!==null?In(U):Dn,k.state=l.memoizedState,U=f.getDerivedStateFromProps,typeof U=="function"&&(nm(l,f,U,m),k.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(U=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),U!==k.state&&im.enqueueReplaceState(k,k.state,null),en(l,m,k,_),ma(),k.state=l.memoizedState),typeof k.componentDidMount=="function"&&(l.flags|=4194308),m=!0}else if(s===null){k=l.stateNode;var ne=l.memoizedProps,Ae=Ru(f,ne);k.props=Ae;var $e=k.context,it=f.contextType;U=Dn,typeof it=="object"&&it!==null&&(U=In(it));var ut=f.getDerivedStateFromProps;it=typeof ut=="function"||typeof k.getSnapshotBeforeUpdate=="function",ne=l.pendingProps!==ne,it||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(ne||$e!==U)&&gx(l,k,m,U),Ft=!1;var Xe=l.memoizedState;k.state=Xe,en(l,m,k,_),ma(),$e=l.memoizedState,ne||Xe!==$e||Ft?(typeof ut=="function"&&(nm(l,f,ut,m),$e=l.memoizedState),(Ae=Ft||mx(l,f,Ae,m,Xe,$e,U))?(it||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(l.flags|=4194308)):(typeof k.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=$e),k.props=m,k.state=$e,k.context=U,m=Ae):(typeof k.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{k=l.stateNode,Na(s,l),U=l.memoizedProps,it=Ru(f,U),k.props=it,ut=l.pendingProps,Xe=k.context,$e=f.contextType,Ae=Dn,typeof $e=="object"&&$e!==null&&(Ae=In($e)),ne=f.getDerivedStateFromProps,($e=typeof ne=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(U!==ut||Xe!==Ae)&&gx(l,k,m,Ae),Ft=!1,Xe=l.memoizedState,k.state=Xe,en(l,m,k,_),ma();var Ze=l.memoizedState;U!==ut||Xe!==Ze||Ft||s!==null&&s.dependencies!==null&&Mf(s.dependencies)?(typeof ne=="function"&&(nm(l,f,ne,m),Ze=l.memoizedState),(it=Ft||mx(l,f,it,m,Xe,Ze,Ae)||s!==null&&s.dependencies!==null&&Mf(s.dependencies))?($e||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(m,Ze,Ae),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(m,Ze,Ae)),typeof k.componentDidUpdate=="function"&&(l.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof k.componentDidUpdate!="function"||U===s.memoizedProps&&Xe===s.memoizedState||(l.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||U===s.memoizedProps&&Xe===s.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=Ze),k.props=m,k.state=Ze,k.context=Ae,m=it):(typeof k.componentDidUpdate!="function"||U===s.memoizedProps&&Xe===s.memoizedState||(l.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||U===s.memoizedProps&&Xe===s.memoizedState||(l.flags|=1024),m=!1)}return k=m,zd(s,l),m=(l.flags&128)!==0,k||m?(k=l.stateNode,f=m&&typeof f.getDerivedStateFromError!="function"?null:k.render(),l.flags|=1,s!==null&&m?(l.child=wa(l,s.child,null,_),l.child=wa(l,null,f,_)):li(s,l,f,_),l.memoizedState=k.state,s=l.child):s=ql(s,l,_),s}function Ox(s,l,f,m){return Pl(),l.flags|=256,li(s,l,f,m),l.child}var cm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function um(s){return{baseLanes:s,cachePool:xe()}}function fm(s,l,f){return s=s!==null?s.childLanes&~f:0,l&&(s|=Es),s}function Fx(s,l,f){var m=l.pendingProps,_=!1,k=(l.flags&128)!==0,U;if((U=k)||(U=s!==null&&s.memoizedState===null?!1:(Ur.current&2)!==0),U&&(_=!0,l.flags&=-129),U=(l.flags&32)!==0,l.flags&=-33,s===null){if(Rr){if(_?Va(l):an(),(s=_a)?(s=Uy(s,Pa),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:el!==null?{id:Ji,overflow:Zi}:null,retryLane:536870912,hydrationErrors:null},f=Ff(s),f.return=l,l.child=f,Pn=l,_a=null)):s=null,s===null)throw tl(l);return $m(s)?l.lanes=32:l.lanes=536870912,null}var ne=m.children;return m=m.fallback,_?(an(),_=l.mode,ne=Hd({mode:"hidden",children:ne},_),m=Qo(m,_,f,null),ne.return=l,m.return=l,ne.sibling=m,l.child=ne,m=l.child,m.memoizedState=um(f),m.childLanes=fm(s,U,f),l.memoizedState=cm,f0(null,m)):(Va(l),hm(l,ne))}var Ae=s.memoizedState;if(Ae!==null&&(ne=Ae.dehydrated,ne!==null)){if(k)l.flags&256?(Va(l),l.flags&=-257,l=dm(s,l,f)):l.memoizedState!==null?(an(),l.child=s.child,l.flags|=128,l=null):(an(),ne=m.fallback,_=l.mode,m=Hd({mode:"visible",children:m.children},_),ne=Qo(ne,_,f,null),ne.flags|=2,m.return=l,ne.return=l,m.sibling=ne,l.child=m,wa(l,s.child,null,f),m=l.child,m.memoizedState=um(f),m.childLanes=fm(s,U,f),l.memoizedState=cm,l=f0(null,m));else if(Va(l),$m(ne)){if(U=ne.nextSibling&&ne.nextSibling.dataset,U)var $e=U.dgst;U=$e,m=Error(a(419)),m.stack="",m.digest=U,Ec({value:m,source:null,stack:null}),l=dm(s,l,f)}else if(En||nl(s,l,f,!1),U=(f&s.childLanes)!==0,En||U){if(U=ba,U!==null&&(m=ei(U,f),m!==0&&m!==Ae.retryLane))throw Ae.retryLane=m,No(s,m),is(U,s,m),om;Gm(ne)||Zd(),l=dm(s,l,f)}else Gm(ne)?(l.flags|=192,l.child=s.child,l=null):(s=Ae.treeContext,_a=Ys(ne.nextSibling),Pn=l,Rr=!0,si=null,Pa=!1,s!==null&&Od(l,s),l=hm(l,m.children),l.flags|=4096);return l}return _?(an(),ne=m.fallback,_=l.mode,Ae=s.child,$e=Ae.sibling,m=$i(Ae,{mode:"hidden",children:m.children}),m.subtreeFlags=Ae.subtreeFlags&65011712,$e!==null?ne=$i($e,ne):(ne=Qo(ne,_,f,null),ne.flags|=2),ne.return=l,m.return=l,m.sibling=ne,l.child=m,f0(null,m),m=l.child,ne=s.child.memoizedState,ne===null?ne=um(f):(_=ne.cachePool,_!==null?(Ae=Wa._currentValue,_=_.parent!==Ae?{parent:Ae,pool:Ae}:_):_=xe(),ne={baseLanes:ne.baseLanes|f,cachePool:_}),m.memoizedState=ne,m.childLanes=fm(s,U,f),l.memoizedState=cm,f0(s.child,m)):(Va(l),f=s.child,s=f.sibling,f=$i(f,{mode:"visible",children:m.children}),f.return=l,f.sibling=null,s!==null&&(U=l.deletions,U===null?(l.deletions=[s],l.flags|=16):U.push(s)),l.child=f,l.memoizedState=null,f)}function hm(s,l){return l=Hd({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Hd(s,l){return s=Vn(22,s,null,l),s.lanes=0,s}function dm(s,l,f){return wa(l,s.child,null,f),s=hm(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function Rx(s,l,f){s.lanes|=l;var m=s.alternate;m!==null&&(m.lanes|=l),kc(s.return,l,f)}function pm(s,l,f,m,_,k){var U=s.memoizedState;U===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:f,tailMode:_,treeForkCount:k}:(U.isBackwards=l,U.rendering=null,U.renderingStartTime=0,U.last=m,U.tail=f,U.tailMode=_,U.treeForkCount=k)}function Lx(s,l,f){var m=l.pendingProps,_=m.revealOrder,k=m.tail;m=m.children;var U=Ur.current,ne=(U&2)!==0;if(ne?(U=U&1|2,l.flags|=128):U&=1,M(Ur,U),li(s,l,m,f),m=Rr?Tu:0,!ne&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Rx(s,f,l);else if(s.tag===19)Rx(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(_){case"forwards":for(f=l.child,_=null;f!==null;)s=f.alternate,s!==null&&$n(s)===null&&(_=f),f=f.sibling;f=_,f===null?(_=l.child,l.child=null):(_=f.sibling,f.sibling=null),pm(l,!1,_,f,k,m);break;case"backwards":case"unstable_legacy-backwards":for(f=null,_=l.child,l.child=null;_!==null;){if(s=_.alternate,s!==null&&$n(s)===null){l.child=_;break}s=_.sibling,_.sibling=f,f=_,_=s}pm(l,!0,f,null,k,m);break;case"together":pm(l,!1,null,null,void 0,m);break;default:l.memoizedState=null}return l.child}function ql(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),Rc|=l.lanes,(f&l.childLanes)===0)if(s!==null){if(nl(s,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(a(153));if(l.child!==null){for(s=l.child,f=$i(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=$i(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function mm(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Mf(s)))}function JE(s,l,f){switch(l.tag){case 3:me(l,l.stateNode.containerInfo),al(l,Wa,s.memoizedState.cache),Pl();break;case 27:case 5:Se(l);break;case 4:me(l,l.stateNode.containerInfo);break;case 10:al(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,ra(l),null;break;case 13:var m=l.memoizedState;if(m!==null)return m.dehydrated!==null?(Va(l),l.flags|=128,null):(f&l.child.childLanes)!==0?Fx(s,l,f):(Va(l),s=ql(s,l,f),s!==null?s.sibling:null);Va(l);break;case 19:var _=(s.flags&128)!==0;if(m=(f&l.childLanes)!==0,m||(nl(s,l,f,!1),m=(f&l.childLanes)!==0),_){if(m)return Lx(s,l,f);l.flags|=128}if(_=l.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),M(Ur,Ur.current),m)break;return null;case 22:return l.lanes=0,Ax(s,l,f,l.pendingProps);case 24:al(l,Wa,s.memoizedState.cache)}return ql(s,l,f)}function Dx(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps)En=!0;else{if(!mm(s,f)&&(l.flags&128)===0)return En=!1,JE(s,l,f);En=(s.flags&131072)!==0}else En=!1,Rr&&(l.flags&1048576)!==0&&Cd(l,Tu,l.index);switch(l.lanes=0,l.tag){case 16:e:{var m=l.pendingProps;if(s=Ue(l.elementType),l.type=s,typeof s=="function")Of(s)?(m=Ru(s,m),l.tag=1,l=Cx(null,l,s,m,f)):(l.tag=0,l=lm(null,l,s,m,f));else{if(s!=null){var _=s.$$typeof;if(_===R){l.tag=11,l=Sx(null,l,s,m,f);break e}else if(_===F){l.tag=14,l=Ex(null,l,s,m,f);break e}}throw l=oe(s)||s,Error(a(306,l,""))}}return l;case 0:return lm(s,l,l.type,l.pendingProps,f);case 1:return m=l.type,_=Ru(m,l.pendingProps),Cx(s,l,m,_,f);case 3:e:{if(me(l,l.stateNode.containerInfo),s===null)throw Error(a(387));m=l.pendingProps;var k=l.memoizedState;_=k.element,Na(s,l),en(l,m,null,f);var U=l.memoizedState;if(m=U.cache,al(l,Wa,m),m!==k.cache&&Ml(l,[Wa],f,!0),ma(),m=U.element,k.isDehydrated)if(k={element:m,isDehydrated:!1,cache:U.cache},l.updateQueue.baseState=k,l.memoizedState=k,l.flags&256){l=Ox(s,l,m,f);break e}else if(m!==_){_=Xi(Error(a(424)),l),Ec(_),l=Ox(s,l,m,f);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(_a=Ys(s.firstChild),Pn=l,Rr=!0,si=null,Pa=!0,f=xr(l,null,m,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Pl(),m===_){l=ql(s,l,f);break e}li(s,l,m,f)}l=l.child}return l;case 26:return zd(s,l),s===null?(f=Gy(l.type,null,l.pendingProps,null))?l.memoizedState=f:Rr||(f=l.type,s=l.pendingProps,m=i1(K.current).createElement(f),m[ue]=l,m[pe]=s,ci(m,f,s),Lt(m),l.stateNode=m):l.memoizedState=Gy(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Se(l),s===null&&Rr&&(m=l.stateNode=Hy(l.type,l.pendingProps,K.current),Pn=l,Pa=!0,_=_a,Ic(l.type)?(Xm=_,_a=Ys(m.firstChild)):_a=_),li(s,l,l.pendingProps.children,f),zd(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&Rr&&((_=m=_a)&&(m=Nk(m,l.type,l.pendingProps,Pa),m!==null?(l.stateNode=m,Pn=l,_a=Ys(m.firstChild),Pa=!1,_=!0):_=!1),_||tl(l)),Se(l),_=l.type,k=l.pendingProps,U=s!==null?s.memoizedProps:null,m=k.children,Hm(_,k)?m=null:U!==null&&Hm(_,U)&&(l.flags|=32),l.memoizedState!==null&&(_=r0(s,l,Kp,null,null,f),A0._currentValue=_),zd(s,l),li(s,l,m,f),l.child;case 6:return s===null&&Rr&&((s=f=_a)&&(f=Tk(f,l.pendingProps,Pa),f!==null?(l.stateNode=f,Pn=l,_a=null,s=!0):s=!1),s||tl(l)),null;case 13:return Fx(s,l,f);case 4:return me(l,l.stateNode.containerInfo),m=l.pendingProps,s===null?l.child=wa(l,null,m,f):li(s,l,m,f),l.child;case 11:return Sx(s,l,l.type,l.pendingProps,f);case 7:return li(s,l,l.pendingProps,f),l.child;case 8:return li(s,l,l.pendingProps.children,f),l.child;case 12:return li(s,l,l.pendingProps.children,f),l.child;case 10:return m=l.pendingProps,al(l,l.type,m.value),li(s,l,m.children,f),l.child;case 9:return _=l.type._context,m=l.pendingProps.children,il(l),_=In(_),m=m(_),l.flags|=1,li(s,l,m,f),l.child;case 14:return Ex(s,l,l.type,l.pendingProps,f);case 15:return kx(s,l,l.type,l.pendingProps,f);case 19:return Lx(s,l,f);case 31:return KE(s,l,f);case 22:return Ax(s,l,f,l.pendingProps);case 24:return il(l),m=In(Wa),s===null?(_=le(),_===null&&(_=ba,k=Ac(),_.pooledCache=k,k.refCount++,k!==null&&(_.pooledCacheLanes|=f),_=k),l.memoizedState={parent:m,cache:_},Nt(l),al(l,Wa,_)):((s.lanes&f)!==0&&(Na(s,l),en(l,null,null,f),ma()),_=s.memoizedState,k=l.memoizedState,_.parent!==m?(_={parent:m,cache:m},l.memoizedState=_,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=_),al(l,Wa,m)):(m=k.cache,al(l,Wa,m),m!==_.cache&&Ml(l,[Wa],f,!0))),li(s,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(a(156,l.tag))}function zl(s){s.flags|=4}function gm(s,l,f,m,_){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(_&335544128)===_)if(s.stateNode.complete)s.flags|=8192;else if(ly())s.flags|=8192;else throw tt=Fe,We}else s.flags&=-16777217}function Px(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Jy(l))if(ly())s.flags|=8192;else throw tt=Fe,We}function Wd(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?_t():536870912,s.lanes|=l,Zf|=l)}function h0(s,l){if(!Rr)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var m=null;f!==null;)f.alternate!==null&&(m=f),f=f.sibling;m===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function Ca(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,m=0;if(l)for(var _=s.child;_!==null;)f|=_.lanes|_.childLanes,m|=_.subtreeFlags&65011712,m|=_.flags&65011712,_.return=s,_=_.sibling;else for(_=s.child;_!==null;)f|=_.lanes|_.childLanes,m|=_.subtreeFlags,m|=_.flags,_.return=s,_=_.sibling;return s.subtreeFlags|=m,s.childLanes=f,l}function ZE(s,l,f){var m=l.pendingProps;switch(Df(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ca(l),null;case 1:return Ca(l),null;case 3:return f=l.stateNode,m=null,s!==null&&(m=s.memoizedState.cache),l.memoizedState.cache!==m&&(l.flags|=2048),Qi(Wa),we(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(Mn(l)?zl(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,e0())),Ca(l),null;case 26:var _=l.type,k=l.memoizedState;return s===null?(zl(l),k!==null?(Ca(l),Px(l,k)):(Ca(l),gm(l,_,null,m,f))):k?k!==s.memoizedState?(zl(l),Ca(l),Px(l,k)):(Ca(l),l.flags&=-16777217):(s=s.memoizedProps,s!==m&&zl(l),Ca(l),gm(l,_,s,m,f)),null;case 27:if(Ee(l),f=K.current,_=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==m&&zl(l);else{if(!m){if(l.stateNode===null)throw Error(a(166));return Ca(l),null}s=B.current,Mn(l)?Qh(l):(s=Hy(_,m,f),l.stateNode=s,zl(l))}return Ca(l),null;case 5:if(Ee(l),_=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==m&&zl(l);else{if(!m){if(l.stateNode===null)throw Error(a(166));return Ca(l),null}if(k=B.current,Mn(l))Qh(l);else{var U=i1(K.current);switch(k){case 1:k=U.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:k=U.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":k=U.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":k=U.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":k=U.createElement("div"),k.innerHTML="<script><\/script>",k=k.removeChild(k.firstChild);break;case"select":k=typeof m.is=="string"?U.createElement("select",{is:m.is}):U.createElement("select"),m.multiple?k.multiple=!0:m.size&&(k.size=m.size);break;default:k=typeof m.is=="string"?U.createElement(_,{is:m.is}):U.createElement(_)}}k[ue]=l,k[pe]=m;e:for(U=l.child;U!==null;){if(U.tag===5||U.tag===6)k.appendChild(U.stateNode);else if(U.tag!==4&&U.tag!==27&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===l)break e;for(;U.sibling===null;){if(U.return===null||U.return===l)break e;U=U.return}U.sibling.return=U.return,U=U.sibling}l.stateNode=k;e:switch(ci(k,_,m),_){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&zl(l)}}return Ca(l),gm(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,f),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==m&&zl(l);else{if(typeof m!="string"&&l.stateNode===null)throw Error(a(166));if(s=K.current,Mn(l)){if(s=l.stateNode,f=l.memoizedProps,m=null,_=Pn,_!==null)switch(_.tag){case 27:case 5:m=_.memoizedProps}s[ue]=l,s=!!(s.nodeValue===f||m!==null&&m.suppressHydrationWarning===!0||Fy(s.nodeValue,f)),s||tl(l,!0)}else s=i1(s).createTextNode(m),s[ue]=l,l.stateNode=s}return Ca(l),null;case 31:if(f=l.memoizedState,s===null||s.memoizedState!==null){if(m=Mn(l),f!==null){if(s===null){if(!m)throw Error(a(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(557));s[ue]=l}else Pl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Ca(l),s=!1}else f=e0(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),s=!0;if(!s)return l.flags&256?(ia(l),l):(ia(l),null);if((l.flags&128)!==0)throw Error(a(558))}return Ca(l),null;case 13:if(m=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(_=Mn(l),m!==null&&m.dehydrated!==null){if(s===null){if(!_)throw Error(a(318));if(_=l.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(a(317));_[ue]=l}else Pl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Ca(l),_=!1}else _=e0(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=_),_=!0;if(!_)return l.flags&256?(ia(l),l):(ia(l),null)}return ia(l),(l.flags&128)!==0?(l.lanes=f,l):(f=m!==null,s=s!==null&&s.memoizedState!==null,f&&(m=l.child,_=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(_=m.alternate.memoizedState.cachePool.pool),k=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(k=m.memoizedState.cachePool.pool),k!==_&&(m.flags|=2048)),f!==s&&f&&(l.child.flags|=8192),Wd(l,l.updateQueue),Ca(l),null);case 4:return we(),s===null&&Im(l.stateNode.containerInfo),Ca(l),null;case 10:return Qi(l.type),Ca(l),null;case 19:if(N(Ur),m=l.memoizedState,m===null)return Ca(l),null;if(_=(l.flags&128)!==0,k=m.rendering,k===null)if(_)h0(m,!1);else{if(sn!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(k=$n(s),k!==null){for(l.flags|=128,h0(m,!1),s=k.updateQueue,l.updateQueue=s,Wd(l,s),l.subtreeFlags=0,s=f,f=l.child;f!==null;)Au(f,s),f=f.sibling;return M(Ur,Ur.current&1|2),Rr&&Ii(l,m.treeForkCount),l.child}s=s.sibling}m.tail!==null&&It()>Yd&&(l.flags|=128,_=!0,h0(m,!1),l.lanes=4194304)}else{if(!_)if(s=$n(k),s!==null){if(l.flags|=128,_=!0,s=s.updateQueue,l.updateQueue=s,Wd(l,s),h0(m,!0),m.tail===null&&m.tailMode==="hidden"&&!k.alternate&&!Rr)return Ca(l),null}else 2*It()-m.renderingStartTime>Yd&&f!==536870912&&(l.flags|=128,_=!0,h0(m,!1),l.lanes=4194304);m.isBackwards?(k.sibling=l.child,l.child=k):(s=m.last,s!==null?s.sibling=k:l.child=k,m.last=k)}return m.tail!==null?(s=m.tail,m.rendering=s,m.tail=s.sibling,m.renderingStartTime=It(),s.sibling=null,f=Ur.current,M(Ur,_?f&1|2:f&1),Rr&&Ii(l,m.treeForkCount),s):(Ca(l),null);case 22:case 23:return ia(l),pn(),m=l.memoizedState!==null,s!==null?s.memoizedState!==null!==m&&(l.flags|=8192):m&&(l.flags|=8192),m?(f&536870912)!==0&&(l.flags&128)===0&&(Ca(l),l.subtreeFlags&6&&(l.flags|=8192)):Ca(l),f=l.updateQueue,f!==null&&Wd(l,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),m=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),m!==f&&(l.flags|=2048),s!==null&&N(re),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),Qi(Wa),Ca(l),null;case 25:return null;case 30:return null}throw Error(a(156,l.tag))}function QE(s,l){switch(Df(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return Qi(Wa),we(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return Ee(l),null;case 31:if(l.memoizedState!==null){if(ia(l),l.alternate===null)throw Error(a(340));Pl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(ia(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(a(340));Pl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return N(Ur),null;case 4:return we(),null;case 10:return Qi(l.type),null;case 22:case 23:return ia(l),pn(),s!==null&&N(re),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return Qi(Wa),null;case 25:return null;default:return null}}function Mx(s,l){switch(Df(l),l.tag){case 3:Qi(Wa),we();break;case 26:case 27:case 5:Ee(l);break;case 4:we();break;case 31:l.memoizedState!==null&&ia(l);break;case 13:ia(l);break;case 19:N(Ur);break;case 10:Qi(l.type);break;case 22:case 23:ia(l),pn(),s!==null&&N(re);break;case 24:Qi(Wa)}}function d0(s,l){try{var f=l.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var _=m.next;f=_;do{if((f.tag&s)===s){m=void 0;var k=f.create,U=f.inst;m=k(),U.destroy=m}f=f.next}while(f!==_)}}catch(ne){oa(l,l.return,ne)}}function Oc(s,l,f){try{var m=l.updateQueue,_=m!==null?m.lastEffect:null;if(_!==null){var k=_.next;m=k;do{if((m.tag&s)===s){var U=m.inst,ne=U.destroy;if(ne!==void 0){U.destroy=void 0,_=l;var Ae=f,$e=ne;try{$e()}catch(it){oa(_,Ae,it)}}}m=m.next}while(m!==k)}}catch(it){oa(l,l.return,it)}}function Ix(s){var l=s.updateQueue;if(l!==null){var f=s.stateNode;try{tn(l,f)}catch(m){oa(s,s.return,m)}}}function Bx(s,l,f){f.props=Ru(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(m){oa(s,l,m)}}function p0(s,l){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var m=s.stateNode;break;case 30:m=s.stateNode;break;default:m=s.stateNode}typeof f=="function"?s.refCleanup=f(m):f.current=m}}catch(_){oa(s,l,_)}}function ul(s,l){var f=s.ref,m=s.refCleanup;if(f!==null)if(typeof m=="function")try{m()}catch(_){oa(s,l,_)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(_){oa(s,l,_)}else f.current=null}function Ux(s){var l=s.type,f=s.memoizedProps,m=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&m.focus();break e;case"img":f.src?m.src=f.src:f.srcSet&&(m.srcset=f.srcSet)}}catch(_){oa(s,s.return,_)}}function vm(s,l,f){try{var m=s.stateNode;wk(m,s.type,f,l),m[pe]=l}catch(_){oa(s,s.return,_)}}function qx(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Ic(s.type)||s.tag===4}function xm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||qx(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Ic(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function ym(s,l,f){var m=s.tag;if(m===5||m===6)s=s.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(s),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=gs));else if(m!==4&&(m===27&&Ic(s.type)&&(f=s.stateNode,l=null),s=s.child,s!==null))for(ym(s,l,f),s=s.sibling;s!==null;)ym(s,l,f),s=s.sibling}function Vd(s,l,f){var m=s.tag;if(m===5||m===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(m!==4&&(m===27&&Ic(s.type)&&(f=s.stateNode),s=s.child,s!==null))for(Vd(s,l,f),s=s.sibling;s!==null;)Vd(s,l,f),s=s.sibling}function zx(s){var l=s.stateNode,f=s.memoizedProps;try{for(var m=s.type,_=l.attributes;_.length;)l.removeAttributeNode(_[0]);ci(l,m,f),l[ue]=s,l[pe]=f}catch(k){oa(s,s.return,k)}}var Hl=!1,kn=!1,_m=!1,Hx=typeof WeakSet=="function"?WeakSet:Set,Xn=null;function ek(s,l){if(s=s.containerInfo,qm=h1,s=ko(s),Ws(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var m=f.getSelection&&f.getSelection();if(m&&m.rangeCount!==0){f=m.anchorNode;var _=m.anchorOffset,k=m.focusNode;m=m.focusOffset;try{f.nodeType,k.nodeType}catch{f=null;break e}var U=0,ne=-1,Ae=-1,$e=0,it=0,ut=s,Xe=null;t:for(;;){for(var Ze;ut!==f||_!==0&&ut.nodeType!==3||(ne=U+_),ut!==k||m!==0&&ut.nodeType!==3||(Ae=U+m),ut.nodeType===3&&(U+=ut.nodeValue.length),(Ze=ut.firstChild)!==null;)Xe=ut,ut=Ze;for(;;){if(ut===s)break t;if(Xe===f&&++$e===_&&(ne=U),Xe===k&&++it===m&&(Ae=U),(Ze=ut.nextSibling)!==null)break;ut=Xe,Xe=ut.parentNode}ut=Ze}f=ne===-1||Ae===-1?null:{start:ne,end:Ae}}else f=null}f=f||{start:0,end:0}}else f=null;for(zm={focusedElem:s,selectionRange:f},h1=!1,Xn=l;Xn!==null;)if(l=Xn,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,Xn=s;else for(;Xn!==null;){switch(l=Xn,k=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(f=0;f<s.length;f++)_=s[f],_.ref.impl=_.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&k!==null){s=void 0,f=l,_=k.memoizedProps,k=k.memoizedState,m=f.stateNode;try{var Ut=Ru(f.type,_);s=m.getSnapshotBeforeUpdate(Ut,k),m.__reactInternalSnapshotBeforeUpdate=s}catch(lr){oa(f,f.return,lr)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,f=s.nodeType,f===9)Vm(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Vm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=l.sibling,s!==null){s.return=l.return,Xn=s;break}Xn=l.return}}function Wx(s,l,f){var m=f.flags;switch(f.tag){case 0:case 11:case 15:Vl(s,f),m&4&&d0(5,f);break;case 1:if(Vl(s,f),m&4)if(s=f.stateNode,l===null)try{s.componentDidMount()}catch(U){oa(f,f.return,U)}else{var _=Ru(f.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(_,l,s.__reactInternalSnapshotBeforeUpdate)}catch(U){oa(f,f.return,U)}}m&64&&Ix(f),m&512&&p0(f,f.return);break;case 3:if(Vl(s,f),m&64&&(s=f.updateQueue,s!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{tn(s,l)}catch(U){oa(f,f.return,U)}}break;case 27:l===null&&m&4&&zx(f);case 26:case 5:Vl(s,f),l===null&&m&4&&Ux(f),m&512&&p0(f,f.return);break;case 12:Vl(s,f);break;case 31:Vl(s,f),m&4&&$x(s,f);break;case 13:Vl(s,f),m&4&&Xx(s,f),m&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=ck.bind(null,f),jk(s,f))));break;case 22:if(m=f.memoizedState!==null||Hl,!m){l=l!==null&&l.memoizedState!==null||kn,_=Hl;var k=kn;Hl=m,(kn=l)&&!k?Gl(s,f,(f.subtreeFlags&8772)!==0):Vl(s,f),Hl=_,kn=k}break;case 30:break;default:Vl(s,f)}}function Vx(s){var l=s.alternate;l!==null&&(s.alternate=null,Vx(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&pt(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Ba=null,ts=!1;function Wl(s,l,f){for(f=f.child;f!==null;)Gx(s,l,f),f=f.sibling}function Gx(s,l,f){if(Wt&&typeof Wt.onCommitFiberUnmount=="function")try{Wt.onCommitFiberUnmount(Rt,f)}catch{}switch(f.tag){case 26:kn||ul(f,l),Wl(s,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:kn||ul(f,l);var m=Ba,_=ts;Ic(f.type)&&(Ba=f.stateNode,ts=!1),Wl(s,l,f),S0(f.stateNode),Ba=m,ts=_;break;case 5:kn||ul(f,l);case 6:if(m=Ba,_=ts,Ba=null,Wl(s,l,f),Ba=m,ts=_,Ba!==null)if(ts)try{(Ba.nodeType===9?Ba.body:Ba.nodeName==="HTML"?Ba.ownerDocument.body:Ba).removeChild(f.stateNode)}catch(k){oa(f,l,k)}else try{Ba.removeChild(f.stateNode)}catch(k){oa(f,l,k)}break;case 18:Ba!==null&&(ts?(s=Ba,Iy(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),sh(s)):Iy(Ba,f.stateNode));break;case 4:m=Ba,_=ts,Ba=f.stateNode.containerInfo,ts=!0,Wl(s,l,f),Ba=m,ts=_;break;case 0:case 11:case 14:case 15:Oc(2,f,l),kn||Oc(4,f,l),Wl(s,l,f);break;case 1:kn||(ul(f,l),m=f.stateNode,typeof m.componentWillUnmount=="function"&&Bx(f,l,m)),Wl(s,l,f);break;case 21:Wl(s,l,f);break;case 22:kn=(m=kn)||f.memoizedState!==null,Wl(s,l,f),kn=m;break;default:Wl(s,l,f)}}function $x(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{sh(s)}catch(f){oa(l,l.return,f)}}}function Xx(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{sh(s)}catch(f){oa(l,l.return,f)}}function tk(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new Hx),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new Hx),l;default:throw Error(a(435,s.tag))}}function Gd(s,l){var f=tk(s);l.forEach(function(m){if(!f.has(m)){f.add(m);var _=uk.bind(null,s,m);m.then(_,_)}})}function rs(s,l){var f=l.deletions;if(f!==null)for(var m=0;m<f.length;m++){var _=f[m],k=s,U=l,ne=U;e:for(;ne!==null;){switch(ne.tag){case 27:if(Ic(ne.type)){Ba=ne.stateNode,ts=!1;break e}break;case 5:Ba=ne.stateNode,ts=!1;break e;case 3:case 4:Ba=ne.stateNode.containerInfo,ts=!0;break e}ne=ne.return}if(Ba===null)throw Error(a(160));Gx(k,U,_),Ba=null,ts=!1,k=_.alternate,k!==null&&(k.return=null),_.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)Yx(l,s),l=l.sibling}var Ro=null;function Yx(s,l){var f=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:rs(l,s),as(s),m&4&&(Oc(3,s,s.return),d0(3,s),Oc(5,s,s.return));break;case 1:rs(l,s),as(s),m&512&&(kn||f===null||ul(f,f.return)),m&64&&Hl&&(s=s.updateQueue,s!==null&&(m=s.callbacks,m!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?m:f.concat(m))));break;case 26:var _=Ro;if(rs(l,s),as(s),m&512&&(kn||f===null||ul(f,f.return)),m&4){var k=f!==null?f.memoizedState:null;if(m=s.memoizedState,f===null)if(m===null)if(s.stateNode===null){e:{m=s.type,f=s.memoizedProps,_=_.ownerDocument||_;t:switch(m){case"title":k=_.getElementsByTagName("title")[0],(!k||k[Ve]||k[ue]||k.namespaceURI==="http://www.w3.org/2000/svg"||k.hasAttribute("itemprop"))&&(k=_.createElement(m),_.head.insertBefore(k,_.querySelector("head > title"))),ci(k,m,f),k[ue]=s,Lt(k),m=k;break e;case"link":var U=Yy("link","href",_).get(m+(f.href||""));if(U){for(var ne=0;ne<U.length;ne++)if(k=U[ne],k.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&k.getAttribute("rel")===(f.rel==null?null:f.rel)&&k.getAttribute("title")===(f.title==null?null:f.title)&&k.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){U.splice(ne,1);break t}}k=_.createElement(m),ci(k,m,f),_.head.appendChild(k);break;case"meta":if(U=Yy("meta","content",_).get(m+(f.content||""))){for(ne=0;ne<U.length;ne++)if(k=U[ne],k.getAttribute("content")===(f.content==null?null:""+f.content)&&k.getAttribute("name")===(f.name==null?null:f.name)&&k.getAttribute("property")===(f.property==null?null:f.property)&&k.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&k.getAttribute("charset")===(f.charSet==null?null:f.charSet)){U.splice(ne,1);break t}}k=_.createElement(m),ci(k,m,f),_.head.appendChild(k);break;default:throw Error(a(468,m))}k[ue]=s,Lt(k),m=k}s.stateNode=m}else Ky(_,s.type,s.stateNode);else s.stateNode=Xy(_,m,s.memoizedProps);else k!==m?(k===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):k.count--,m===null?Ky(_,s.type,s.stateNode):Xy(_,m,s.memoizedProps)):m===null&&s.stateNode!==null&&vm(s,s.memoizedProps,f.memoizedProps)}break;case 27:rs(l,s),as(s),m&512&&(kn||f===null||ul(f,f.return)),f!==null&&m&4&&vm(s,s.memoizedProps,f.memoizedProps);break;case 5:if(rs(l,s),as(s),m&512&&(kn||f===null||ul(f,f.return)),s.flags&32){_=s.stateNode;try{ms(_,"")}catch(Ut){oa(s,s.return,Ut)}}m&4&&s.stateNode!=null&&(_=s.memoizedProps,vm(s,_,f!==null?f.memoizedProps:_)),m&1024&&(_m=!0);break;case 6:if(rs(l,s),as(s),m&4){if(s.stateNode===null)throw Error(a(162));m=s.memoizedProps,f=s.stateNode;try{f.nodeValue=m}catch(Ut){oa(s,s.return,Ut)}}break;case 3:if(l1=null,_=Ro,Ro=s1(l.containerInfo),rs(l,s),Ro=_,as(s),m&4&&f!==null&&f.memoizedState.isDehydrated)try{sh(l.containerInfo)}catch(Ut){oa(s,s.return,Ut)}_m&&(_m=!1,Kx(s));break;case 4:m=Ro,Ro=s1(s.stateNode.containerInfo),rs(l,s),as(s),Ro=m;break;case 12:rs(l,s),as(s);break;case 31:rs(l,s),as(s),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,Gd(s,m)));break;case 13:rs(l,s),as(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Xd=It()),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,Gd(s,m)));break;case 22:_=s.memoizedState!==null;var Ae=f!==null&&f.memoizedState!==null,$e=Hl,it=kn;if(Hl=$e||_,kn=it||Ae,rs(l,s),kn=it,Hl=$e,as(s),m&8192)e:for(l=s.stateNode,l._visibility=_?l._visibility&-2:l._visibility|1,_&&(f===null||Ae||Hl||kn||Lu(s)),f=null,l=s;;){if(l.tag===5||l.tag===26){if(f===null){Ae=f=l;try{if(k=Ae.stateNode,_)U=k.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none";else{ne=Ae.stateNode;var ut=Ae.memoizedProps.style,Xe=ut!=null&&ut.hasOwnProperty("display")?ut.display:null;ne.style.display=Xe==null||typeof Xe=="boolean"?"":(""+Xe).trim()}}catch(Ut){oa(Ae,Ae.return,Ut)}}}else if(l.tag===6){if(f===null){Ae=l;try{Ae.stateNode.nodeValue=_?"":Ae.memoizedProps}catch(Ut){oa(Ae,Ae.return,Ut)}}}else if(l.tag===18){if(f===null){Ae=l;try{var Ze=Ae.stateNode;_?By(Ze,!0):By(Ae.stateNode,!1)}catch(Ut){oa(Ae,Ae.return,Ut)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}m&4&&(m=s.updateQueue,m!==null&&(f=m.retryQueue,f!==null&&(m.retryQueue=null,Gd(s,f))));break;case 19:rs(l,s),as(s),m&4&&(m=s.updateQueue,m!==null&&(s.updateQueue=null,Gd(s,m)));break;case 30:break;case 21:break;default:rs(l,s),as(s)}}function as(s){var l=s.flags;if(l&2){try{for(var f,m=s.return;m!==null;){if(qx(m)){f=m;break}m=m.return}if(f==null)throw Error(a(160));switch(f.tag){case 27:var _=f.stateNode,k=xm(s);Vd(s,k,_);break;case 5:var U=f.stateNode;f.flags&32&&(ms(U,""),f.flags&=-33);var ne=xm(s);Vd(s,ne,U);break;case 3:case 4:var Ae=f.stateNode.containerInfo,$e=xm(s);ym(s,$e,Ae);break;default:throw Error(a(161))}}catch(it){oa(s,s.return,it)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function Kx(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;Kx(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function Vl(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)Wx(s,l.alternate,l),l=l.sibling}function Lu(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:Oc(4,l,l.return),Lu(l);break;case 1:ul(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&Bx(l,l.return,f),Lu(l);break;case 27:S0(l.stateNode);case 26:case 5:ul(l,l.return),Lu(l);break;case 22:l.memoizedState===null&&Lu(l);break;case 30:Lu(l);break;default:Lu(l)}s=s.sibling}}function Gl(s,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var m=l.alternate,_=s,k=l,U=k.flags;switch(k.tag){case 0:case 11:case 15:Gl(_,k,f),d0(4,k);break;case 1:if(Gl(_,k,f),m=k,_=m.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch($e){oa(m,m.return,$e)}if(m=k,_=m.updateQueue,_!==null){var ne=m.stateNode;try{var Ae=_.shared.hiddenCallbacks;if(Ae!==null)for(_.shared.hiddenCallbacks=null,_=0;_<Ae.length;_++)Gn(Ae[_],ne)}catch($e){oa(m,m.return,$e)}}f&&U&64&&Ix(k),p0(k,k.return);break;case 27:zx(k);case 26:case 5:Gl(_,k,f),f&&m===null&&U&4&&Ux(k),p0(k,k.return);break;case 12:Gl(_,k,f);break;case 31:Gl(_,k,f),f&&U&4&&$x(_,k);break;case 13:Gl(_,k,f),f&&U&4&&Xx(_,k);break;case 22:k.memoizedState===null&&Gl(_,k,f),p0(k,k.return);break;case 30:break;default:Gl(_,k,f)}l=l.sibling}}function wm(s,l){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&ju(f))}function bm(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&ju(s))}function Lo(s,l,f,m){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)Jx(s,l,f,m),l=l.sibling}function Jx(s,l,f,m){var _=l.flags;switch(l.tag){case 0:case 11:case 15:Lo(s,l,f,m),_&2048&&d0(9,l);break;case 1:Lo(s,l,f,m);break;case 3:Lo(s,l,f,m),_&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&ju(s)));break;case 12:if(_&2048){Lo(s,l,f,m),s=l.stateNode;try{var k=l.memoizedProps,U=k.id,ne=k.onPostCommit;typeof ne=="function"&&ne(U,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Ae){oa(l,l.return,Ae)}}else Lo(s,l,f,m);break;case 31:Lo(s,l,f,m);break;case 13:Lo(s,l,f,m);break;case 23:break;case 22:k=l.stateNode,U=l.alternate,l.memoizedState!==null?k._visibility&2?Lo(s,l,f,m):m0(s,l):k._visibility&2?Lo(s,l,f,m):(k._visibility|=2,Yf(s,l,f,m,(l.subtreeFlags&10256)!==0||!1)),_&2048&&wm(U,l);break;case 24:Lo(s,l,f,m),_&2048&&bm(l.alternate,l);break;default:Lo(s,l,f,m)}}function Yf(s,l,f,m,_){for(_=_&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var k=s,U=l,ne=f,Ae=m,$e=U.flags;switch(U.tag){case 0:case 11:case 15:Yf(k,U,ne,Ae,_),d0(8,U);break;case 23:break;case 22:var it=U.stateNode;U.memoizedState!==null?it._visibility&2?Yf(k,U,ne,Ae,_):m0(k,U):(it._visibility|=2,Yf(k,U,ne,Ae,_)),_&&$e&2048&&wm(U.alternate,U);break;case 24:Yf(k,U,ne,Ae,_),_&&$e&2048&&bm(U.alternate,U);break;default:Yf(k,U,ne,Ae,_)}l=l.sibling}}function m0(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=s,m=l,_=m.flags;switch(m.tag){case 22:m0(f,m),_&2048&&wm(m.alternate,m);break;case 24:m0(f,m),_&2048&&bm(m.alternate,m);break;default:m0(f,m)}l=l.sibling}}var g0=8192;function Kf(s,l,f){if(s.subtreeFlags&g0)for(s=s.child;s!==null;)Zx(s,l,f),s=s.sibling}function Zx(s,l,f){switch(s.tag){case 26:Kf(s,l,f),s.flags&g0&&s.memoizedState!==null&&qk(f,Ro,s.memoizedState,s.memoizedProps);break;case 5:Kf(s,l,f);break;case 3:case 4:var m=Ro;Ro=s1(s.stateNode.containerInfo),Kf(s,l,f),Ro=m;break;case 22:s.memoizedState===null&&(m=s.alternate,m!==null&&m.memoizedState!==null?(m=g0,g0=16777216,Kf(s,l,f),g0=m):Kf(s,l,f));break;default:Kf(s,l,f)}}function Qx(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function v0(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var m=l[f];Xn=m,ty(m,s)}Qx(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)ey(s),s=s.sibling}function ey(s){switch(s.tag){case 0:case 11:case 15:v0(s),s.flags&2048&&Oc(9,s,s.return);break;case 3:v0(s);break;case 12:v0(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,$d(s)):v0(s);break;default:v0(s)}}function $d(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var m=l[f];Xn=m,ty(m,s)}Qx(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:Oc(8,l,l.return),$d(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,$d(l));break;default:$d(l)}s=s.sibling}}function ty(s,l){for(;Xn!==null;){var f=Xn;switch(f.tag){case 0:case 11:case 15:Oc(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var m=f.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:ju(f.memoizedState.cache)}if(m=f.child,m!==null)m.return=f,Xn=m;else e:for(f=s;Xn!==null;){m=Xn;var _=m.sibling,k=m.return;if(Vx(m),m===f){Xn=null;break e}if(_!==null){_.return=k,Xn=_;break e}Xn=k}}}var rk={getCacheForType:function(s){var l=In(Wa),f=l.data.get(s);return f===void 0&&(f=s(),l.data.set(s,f)),f},cacheSignal:function(){return In(Wa).controller.signal}},ak=typeof WeakMap=="function"?WeakMap:Map,aa=0,ba=null,Lr=null,Pr=0,sa=0,Ss=null,Fc=!1,Jf=!1,Sm=!1,$l=0,sn=0,Rc=0,Du=0,Em=0,Es=0,Zf=0,x0=null,ns=null,km=!1,Xd=0,ry=0,Yd=1/0,Kd=null,Lc=null,Un=0,Dc=null,Qf=null,Xl=0,Am=0,Nm=null,ay=null,y0=0,Tm=null;function ks(){return(aa&2)!==0&&Pr!==0?Pr&-Pr:ie.T!==null?Lm():J()}function ny(){if(Es===0)if((Pr&536870912)===0||Rr){var s=Vr;Vr<<=1,(Vr&3932160)===0&&(Vr=262144),Es=s}else Es=536870912;return s=ja.current,s!==null&&(s.flags|=32),Es}function is(s,l,f){(s===ba&&(sa===2||sa===9)||s.cancelPendingCommit!==null)&&(eh(s,0),Pc(s,Pr,Es,!1)),Kt(s,f),((aa&2)===0||s!==ba)&&(s===ba&&((aa&2)===0&&(Du|=f),sn===4&&Pc(s,Pr,Es,!1)),fl(s))}function iy(s,l,f){if((aa&6)!==0)throw Error(a(327));var m=!f&&(l&127)===0&&(l&s.expiredLanes)===0||Qn(s,l),_=m?sk(s,l):Cm(s,l,!0),k=m;do{if(_===0){Jf&&!m&&Pc(s,l,0,!1);break}else{if(f=s.current.alternate,k&&!nk(f)){_=Cm(s,l,!1),k=!1;continue}if(_===2){if(k=l,s.errorRecoveryDisabledLanes&k)var U=0;else U=s.pendingLanes&-536870913,U=U!==0?U:U&536870912?536870912:0;if(U!==0){l=U;e:{var ne=s;_=x0;var Ae=ne.current.memoizedState.isDehydrated;if(Ae&&(eh(ne,U).flags|=256),U=Cm(ne,U,!1),U!==2){if(Sm&&!Ae){ne.errorRecoveryDisabledLanes|=k,Du|=k,_=4;break e}k=ns,ns=_,k!==null&&(ns===null?ns=k:ns.push.apply(ns,k))}_=U}if(k=!1,_!==2)continue}}if(_===1){eh(s,0),Pc(s,l,0,!0);break}e:{switch(m=s,k=_,k){case 0:case 1:throw Error(a(345));case 4:if((l&4194048)!==l)break;case 6:Pc(m,l,Es,!Fc);break e;case 2:ns=null;break;case 3:case 5:break;default:throw Error(a(329))}if((l&62914560)===l&&(_=Xd+300-It(),10<_)){if(Pc(m,l,Es,!Fc),Tr(m,0,!0)!==0)break e;Xl=l,m.timeoutHandle=Py(sy.bind(null,m,f,ns,Kd,km,l,Es,Du,Zf,Fc,k,"Throttled",-0,0),_);break e}sy(m,f,ns,Kd,km,l,Es,Du,Zf,Fc,k,null,-0,0)}}break}while(!0);fl(s)}function sy(s,l,f,m,_,k,U,ne,Ae,$e,it,ut,Xe,Ze){if(s.timeoutHandle=-1,ut=l.subtreeFlags,ut&8192||(ut&16785408)===16785408){ut={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:gs},Zx(l,k,ut);var Ut=(k&62914560)===k?Xd-It():(k&4194048)===k?ry-It():0;if(Ut=zk(ut,Ut),Ut!==null){Xl=k,s.cancelPendingCommit=Ut(py.bind(null,s,l,k,f,m,_,U,ne,Ae,it,ut,null,Xe,Ze)),Pc(s,k,U,!$e);return}}py(s,l,k,f,m,_,U,ne,Ae)}function nk(s){for(var l=s;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var m=0;m<f.length;m++){var _=f[m],k=_.getSnapshot;_=_.value;try{if(!Ln(k(),_))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Pc(s,l,f,m){l&=~Em,l&=~Du,s.suspendedLanes|=l,s.pingedLanes&=~l,m&&(s.warmLanes|=l),m=s.expirationTimes;for(var _=l;0<_;){var k=31-br(_),U=1<<k;m[k]=-1,_&=~U}f!==0&&zi(s,f,l)}function Jd(){return(aa&6)===0?(_0(0),!1):!0}function jm(){if(Lr!==null){if(sa===0)var s=Lr.return;else s=Lr,Gs=rl=null,zf(s),ft=null,qt=0,s=Lr;for(;s!==null;)Mx(s.alternate,s),s=s.return;Lr=null}}function eh(s,l){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,Ek(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),Xl=0,jm(),ba=s,Lr=f=$i(s.current,null),Pr=l,sa=0,Ss=null,Fc=!1,Jf=Qn(s,l),Sm=!1,Zf=Es=Em=Du=Rc=sn=0,ns=x0=null,km=!1,(l&8)!==0&&(l|=l&32);var m=s.entangledLanes;if(m!==0)for(s=s.entanglements,m&=l;0<m;){var _=31-br(m),k=1<<_;l|=s[_],m&=~k}return $l=l,Su(),f}function oy(s,l){Qt=null,ie.H=u0,l===je||l===ve?(l=ot(),sa=3):l===We?(l=ot(),sa=4):sa=l===om?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Ss=l,Lr===null&&(sn=1,Ud(s,Xi(l,s.current)))}function ly(){var s=ja.current;return s===null?!0:(Pr&4194048)===Pr?zr===null:(Pr&62914560)===Pr||(Pr&536870912)!==0?s===zr:!1}function cy(){var s=ie.H;return ie.H=u0,s===null?u0:s}function uy(){var s=ie.A;return ie.A=rk,s}function Zd(){sn=4,Fc||(Pr&4194048)!==Pr&&ja.current!==null||(Jf=!0),(Rc&134217727)===0&&(Du&134217727)===0||ba===null||Pc(ba,Pr,Es,!1)}function Cm(s,l,f){var m=aa;aa|=2;var _=cy(),k=uy();(ba!==s||Pr!==l)&&(Kd=null,eh(s,l)),l=!1;var U=sn;e:do try{if(sa!==0&&Lr!==null){var ne=Lr,Ae=Ss;switch(sa){case 8:jm(),U=6;break e;case 3:case 2:case 9:case 6:ja.current===null&&(l=!0);var $e=sa;if(sa=0,Ss=null,th(s,ne,Ae,$e),f&&Jf){U=0;break e}break;default:$e=sa,sa=0,Ss=null,th(s,ne,Ae,$e)}}ik(),U=sn;break}catch(it){oy(s,it)}while(!0);return l&&s.shellSuspendCounter++,Gs=rl=null,aa=m,ie.H=_,ie.A=k,Lr===null&&(ba=null,Pr=0,Su()),U}function ik(){for(;Lr!==null;)fy(Lr)}function sk(s,l){var f=aa;aa|=2;var m=cy(),_=uy();ba!==s||Pr!==l?(Kd=null,Yd=It()+500,eh(s,l)):Jf=Qn(s,l);e:do try{if(sa!==0&&Lr!==null){l=Lr;var k=Ss;t:switch(sa){case 1:sa=0,Ss=null,th(s,l,k,1);break;case 2:case 9:if(Me(k)){sa=0,Ss=null,hy(l);break}l=function(){sa!==2&&sa!==9||ba!==s||(sa=7),fl(s)},k.then(l,l);break e;case 3:sa=7;break e;case 4:sa=5;break e;case 7:Me(k)?(sa=0,Ss=null,hy(l)):(sa=0,Ss=null,th(s,l,k,7));break;case 5:var U=null;switch(Lr.tag){case 26:U=Lr.memoizedState;case 5:case 27:var ne=Lr;if(U?Jy(U):ne.stateNode.complete){sa=0,Ss=null;var Ae=ne.sibling;if(Ae!==null)Lr=Ae;else{var $e=ne.return;$e!==null?(Lr=$e,Qd($e)):Lr=null}break t}}sa=0,Ss=null,th(s,l,k,5);break;case 6:sa=0,Ss=null,th(s,l,k,6);break;case 8:jm(),sn=6;break e;default:throw Error(a(462))}}ok();break}catch(it){oy(s,it)}while(!0);return Gs=rl=null,ie.H=m,ie.A=_,aa=f,Lr!==null?0:(ba=null,Pr=0,Su(),sn)}function ok(){for(;Lr!==null&&!Ct();)fy(Lr)}function fy(s){var l=Dx(s.alternate,s,$l);s.memoizedProps=s.pendingProps,l===null?Qd(s):Lr=l}function hy(s){var l=s,f=l.alternate;switch(l.tag){case 15:case 0:l=jx(f,l,l.pendingProps,l.type,void 0,Pr);break;case 11:l=jx(f,l,l.pendingProps,l.type.render,l.ref,Pr);break;case 5:zf(l);default:Mx(f,l),l=Lr=Au(l,$l),l=Dx(f,l,$l)}s.memoizedProps=s.pendingProps,l===null?Qd(s):Lr=l}function th(s,l,f,m){Gs=rl=null,zf(l),ft=null,qt=0;var _=l.return;try{if(YE(s,_,l,f,Pr)){sn=1,Ud(s,Xi(f,s.current)),Lr=null;return}}catch(k){if(_!==null)throw Lr=_,k;sn=1,Ud(s,Xi(f,s.current)),Lr=null;return}l.flags&32768?(Rr||m===1?s=!0:Jf||(Pr&536870912)!==0?s=!1:(Fc=s=!0,(m===2||m===9||m===3||m===6)&&(m=ja.current,m!==null&&m.tag===13&&(m.flags|=16384))),dy(l,s)):Qd(l)}function Qd(s){var l=s;do{if((l.flags&32768)!==0){dy(l,Fc);return}s=l.return;var f=ZE(l.alternate,l,$l);if(f!==null){Lr=f;return}if(l=l.sibling,l!==null){Lr=l;return}Lr=l=s}while(l!==null);sn===0&&(sn=5)}function dy(s,l){do{var f=QE(s.alternate,s);if(f!==null){f.flags&=32767,Lr=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(s=s.sibling,s!==null)){Lr=s;return}Lr=s=f}while(s!==null);sn=6,Lr=null}function py(s,l,f,m,_,k,U,ne,Ae){s.cancelPendingCommit=null;do e1();while(Un!==0);if((aa&6)!==0)throw Error(a(327));if(l!==null){if(l===s.current)throw Error(a(177));if(k=l.lanes|l.childLanes,k|=Tf,fs(s,f,k,U,ne,Ae),s===ba&&(Lr=ba=null,Pr=0),Qf=l,Dc=s,Xl=f,Am=k,Nm=_,ay=m,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,fk(Ye,function(){return yy(),null})):(s.callbackNode=null,s.callbackPriority=0),m=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||m){m=ie.T,ie.T=null,_=he.p,he.p=2,U=aa,aa|=4;try{ek(s,l,f)}finally{aa=U,he.p=_,ie.T=m}}Un=1,my(),gy(),vy()}}function my(){if(Un===1){Un=0;var s=Dc,l=Qf,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=ie.T,ie.T=null;var m=he.p;he.p=2;var _=aa;aa|=4;try{Yx(l,s);var k=zm,U=ko(s.containerInfo),ne=k.focusedElem,Ae=k.selectionRange;if(U!==ne&&ne&&ne.ownerDocument&&Eo(ne.ownerDocument.documentElement,ne)){if(Ae!==null&&Ws(ne)){var $e=Ae.start,it=Ae.end;if(it===void 0&&(it=$e),"selectionStart"in ne)ne.selectionStart=$e,ne.selectionEnd=Math.min(it,ne.value.length);else{var ut=ne.ownerDocument||document,Xe=ut&&ut.defaultView||window;if(Xe.getSelection){var Ze=Xe.getSelection(),Ut=ne.textContent.length,lr=Math.min(Ae.start,Ut),xa=Ae.end===void 0?lr:Math.min(Ae.end,Ut);!Ze.extend&&lr>xa&&(U=xa,xa=lr,lr=U);var Pe=_c(ne,lr),Ce=_c(ne,xa);if(Pe&&Ce&&(Ze.rangeCount!==1||Ze.anchorNode!==Pe.node||Ze.anchorOffset!==Pe.offset||Ze.focusNode!==Ce.node||Ze.focusOffset!==Ce.offset)){var Ge=ut.createRange();Ge.setStart(Pe.node,Pe.offset),Ze.removeAllRanges(),lr>xa?(Ze.addRange(Ge),Ze.extend(Ce.node,Ce.offset)):(Ge.setEnd(Ce.node,Ce.offset),Ze.addRange(Ge))}}}}for(ut=[],Ze=ne;Ze=Ze.parentNode;)Ze.nodeType===1&&ut.push({element:Ze,left:Ze.scrollLeft,top:Ze.scrollTop});for(typeof ne.focus=="function"&&ne.focus(),ne=0;ne<ut.length;ne++){var lt=ut[ne];lt.element.scrollLeft=lt.left,lt.element.scrollTop=lt.top}}h1=!!qm,zm=qm=null}finally{aa=_,he.p=m,ie.T=f}}s.current=l,Un=2}}function gy(){if(Un===2){Un=0;var s=Dc,l=Qf,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=ie.T,ie.T=null;var m=he.p;he.p=2;var _=aa;aa|=4;try{Wx(s,l.alternate,l)}finally{aa=_,he.p=m,ie.T=f}}Un=3}}function vy(){if(Un===4||Un===3){Un=0,Et();var s=Dc,l=Qf,f=Xl,m=ay;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Un=5:(Un=0,Qf=Dc=null,xy(s,s.pendingLanes));var _=s.pendingLanes;if(_===0&&(Lc=null),Da(f),l=l.stateNode,Wt&&typeof Wt.onCommitFiberRoot=="function")try{Wt.onCommitFiberRoot(Rt,l,void 0,(l.current.flags&128)===128)}catch{}if(m!==null){l=ie.T,_=he.p,he.p=2,ie.T=null;try{for(var k=s.onRecoverableError,U=0;U<m.length;U++){var ne=m[U];k(ne.value,{componentStack:ne.stack})}}finally{ie.T=l,he.p=_}}(Xl&3)!==0&&e1(),fl(s),_=s.pendingLanes,(f&261930)!==0&&(_&42)!==0?s===Tm?y0++:(y0=0,Tm=s):y0=0,_0(0)}}function xy(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,ju(l)))}function e1(){return my(),gy(),vy(),yy()}function yy(){if(Un!==5)return!1;var s=Dc,l=Am;Am=0;var f=Da(Xl),m=ie.T,_=he.p;try{he.p=32>f?32:f,ie.T=null,f=Nm,Nm=null;var k=Dc,U=Xl;if(Un=0,Qf=Dc=null,Xl=0,(aa&6)!==0)throw Error(a(331));var ne=aa;if(aa|=4,ey(k.current),Jx(k,k.current,U,f),aa=ne,_0(0,!1),Wt&&typeof Wt.onPostCommitFiberRoot=="function")try{Wt.onPostCommitFiberRoot(Rt,k)}catch{}return!0}finally{he.p=_,ie.T=m,xy(s,l)}}function _y(s,l,f){l=Xi(f,l),l=sm(s.stateNode,l,2),s=wr(s,l,2),s!==null&&(Kt(s,2),fl(s))}function oa(s,l,f){if(s.tag===3)_y(s,s,f);else for(;l!==null;){if(l.tag===3){_y(l,s,f);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Lc===null||!Lc.has(m))){s=Xi(f,s),f=wx(2),m=wr(l,f,2),m!==null&&(bx(f,m,l,s),Kt(m,2),fl(m));break}}l=l.return}}function Om(s,l,f){var m=s.pingCache;if(m===null){m=s.pingCache=new ak;var _=new Set;m.set(l,_)}else _=m.get(l),_===void 0&&(_=new Set,m.set(l,_));_.has(f)||(Sm=!0,_.add(f),s=lk.bind(null,s,l,f),l.then(s,s))}function lk(s,l,f){var m=s.pingCache;m!==null&&m.delete(l),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,ba===s&&(Pr&f)===f&&(sn===4||sn===3&&(Pr&62914560)===Pr&&300>It()-Xd?(aa&2)===0&&eh(s,0):Em|=f,Zf===Pr&&(Zf=0)),fl(s)}function wy(s,l){l===0&&(l=_t()),s=No(s,l),s!==null&&(Kt(s,l),fl(s))}function ck(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),wy(s,f)}function uk(s,l){var f=0;switch(s.tag){case 31:case 13:var m=s.stateNode,_=s.memoizedState;_!==null&&(f=_.retryLane);break;case 19:m=s.stateNode;break;case 22:m=s.stateNode._retryCache;break;default:throw Error(a(314))}m!==null&&m.delete(l),wy(s,f)}function fk(s,l){return wt(s,l)}var t1=null,rh=null,Fm=!1,r1=!1,Rm=!1,Mc=0;function fl(s){s!==rh&&s.next===null&&(rh===null?t1=rh=s:rh=rh.next=s),r1=!0,Fm||(Fm=!0,dk())}function _0(s,l){if(!Rm&&r1){Rm=!0;do for(var f=!1,m=t1;m!==null;){if(s!==0){var _=m.pendingLanes;if(_===0)var k=0;else{var U=m.suspendedLanes,ne=m.pingedLanes;k=(1<<31-br(42|s)+1)-1,k&=_&~(U&~ne),k=k&201326741?k&201326741|1:k?k|2:0}k!==0&&(f=!0,ky(m,k))}else k=Pr,k=Tr(m,m===ba?k:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(k&3)===0||Qn(m,k)||(f=!0,ky(m,k));m=m.next}while(f);Rm=!1}}function hk(){by()}function by(){r1=Fm=!1;var s=0;Mc!==0&&Sk()&&(s=Mc);for(var l=It(),f=null,m=t1;m!==null;){var _=m.next,k=Sy(m,l);k===0?(m.next=null,f===null?t1=_:f.next=_,_===null&&(rh=f)):(f=m,(s!==0||(k&3)!==0)&&(r1=!0)),m=_}Un!==0&&Un!==5||_0(s),Mc!==0&&(Mc=0)}function Sy(s,l){for(var f=s.suspendedLanes,m=s.pingedLanes,_=s.expirationTimes,k=s.pendingLanes&-62914561;0<k;){var U=31-br(k),ne=1<<U,Ae=_[U];Ae===-1?((ne&f)===0||(ne&m)!==0)&&(_[U]=Ka(ne,l)):Ae<=l&&(s.expiredLanes|=ne),k&=~ne}if(l=ba,f=Pr,f=Tr(s,s===l?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),m=s.callbackNode,f===0||s===l&&(sa===2||sa===9)||s.cancelPendingCommit!==null)return m!==null&&m!==null&&vt(m),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||Qn(s,f)){if(l=f&-f,l===s.callbackPriority)return l;switch(m!==null&&vt(m),Da(f)){case 2:case 8:f=Oe;break;case 32:f=Ye;break;case 268435456:f=ct;break;default:f=Ye}return m=Ey.bind(null,s),f=wt(f,m),s.callbackPriority=l,s.callbackNode=f,l}return m!==null&&m!==null&&vt(m),s.callbackPriority=2,s.callbackNode=null,2}function Ey(s,l){if(Un!==0&&Un!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(e1()&&s.callbackNode!==f)return null;var m=Pr;return m=Tr(s,s===ba?m:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),m===0?null:(iy(s,m,l),Sy(s,It()),s.callbackNode!=null&&s.callbackNode===f?Ey.bind(null,s):null)}function ky(s,l){if(e1())return null;iy(s,l,!0)}function dk(){kk(function(){(aa&6)!==0?wt(Vt,hk):by()})}function Lm(){if(Mc===0){var s=x;s===0&&(s=ir,ir<<=1,(ir&261888)===0&&(ir=256)),Mc=s}return Mc}function Ay(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:mi(""+s)}function Ny(s,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,s.id&&f.setAttribute("form",s.id),l.parentNode.insertBefore(f,l),s=new FormData(s),f.parentNode.removeChild(f),s}function pk(s,l,f,m,_){if(l==="submit"&&f&&f.stateNode===_){var k=Ay((_[pe]||null).action),U=m.submitter;U&&(l=(l=U[pe]||null)?Ay(l.formAction):U.getAttribute("formAction"),l!==null&&(k=l,U=null));var ne=new Wi("action","action",null,m,_);s.push({event:ne,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Mc!==0){var Ae=U?Ny(_,U):new FormData(_);em(f,{pending:!0,data:Ae,method:_.method,action:k},null,Ae)}}else typeof k=="function"&&(ne.preventDefault(),Ae=U?Ny(_,U):new FormData(_),em(f,{pending:!0,data:Ae,method:_.method,action:k},k,Ae))},currentTarget:_}]})}}for(var Dm=0;Dm<Rl.length;Dm++){var Pm=Rl[Dm],mk=Pm.toLowerCase(),gk=Pm[0].toUpperCase()+Pm.slice(1);Gi(mk,"on"+gk)}Gi(Fl,"onAnimationEnd"),Gi(wu,"onAnimationIteration"),Gi(Yh,"onAnimationStart"),Gi("dblclick","onDoubleClick"),Gi("focusin","onFocus"),Gi("focusout","onBlur"),Gi(Nd,"onTransitionRun"),Gi(Td,"onTransitionStart"),Gi(jd,"onTransitionCancel"),Gi(Kh,"onTransitionEnd"),ti("onMouseEnter",["mouseout","mouseover"]),ti("onMouseLeave",["mouseout","mouseover"]),ti("onPointerEnter",["pointerout","pointerover"]),ti("onPointerLeave",["pointerout","pointerover"]),na("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),na("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),na("onBeforeInput",["compositionend","keypress","textInput","paste"]),na("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),na("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),na("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var w0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vk=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(w0));function Ty(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var m=s[f],_=m.event;m=m.listeners;e:{var k=void 0;if(l)for(var U=m.length-1;0<=U;U--){var ne=m[U],Ae=ne.instance,$e=ne.currentTarget;if(ne=ne.listener,Ae!==k&&_.isPropagationStopped())break e;k=ne,_.currentTarget=$e;try{k(_)}catch(it){bu(it)}_.currentTarget=null,k=Ae}else for(U=0;U<m.length;U++){if(ne=m[U],Ae=ne.instance,$e=ne.currentTarget,ne=ne.listener,Ae!==k&&_.isPropagationStopped())break e;k=ne,_.currentTarget=$e;try{k(_)}catch(it){bu(it)}_.currentTarget=null,k=Ae}}}}function Dr(s,l){var f=l[Be];f===void 0&&(f=l[Be]=new Set);var m=s+"__bubble";f.has(m)||(jy(l,s,2,!1),f.add(m))}function Mm(s,l,f){var m=0;l&&(m|=4),jy(f,s,m,l)}var a1="_reactListening"+Math.random().toString(36).slice(2);function Im(s){if(!s[a1]){s[a1]=!0,ea.forEach(function(f){f!=="selectionchange"&&(vk.has(f)||Mm(f,!1,s),Mm(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[a1]||(l[a1]=!0,Mm("selectionchange",!1,l))}}function jy(s,l,f,m){switch(n_(l)){case 2:var _=Vk;break;case 8:_=Gk;break;default:_=Qm}f=_.bind(null,l,f,s),_=void 0,!gu||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(_=!0),m?_!==void 0?s.addEventListener(l,f,{capture:!0,passive:_}):s.addEventListener(l,f,!0):_!==void 0?s.addEventListener(l,f,{passive:_}):s.addEventListener(l,f,!1)}function Bm(s,l,f,m,_){var k=m;if((l&1)===0&&(l&2)===0&&m!==null)e:for(;;){if(m===null)return;var U=m.tag;if(U===3||U===4){var ne=m.stateNode.containerInfo;if(ne===_)break;if(U===4)for(U=m.return;U!==null;){var Ae=U.tag;if((Ae===3||Ae===4)&&U.stateNode.containerInfo===_)return;U=U.return}for(;ne!==null;){if(U=bt(ne),U===null)return;if(Ae=U.tag,Ae===5||Ae===6||Ae===26||Ae===27){m=k=U;continue e}ne=ne.parentNode}}m=m.return}Sf(function(){var $e=k,it=kl(f),ut=[];e:{var Xe=Jh.get(s);if(Xe!==void 0){var Ze=Wi,Ut=s;switch(s){case"keypress":if(Hi(f)===0)break e;case"keydown":case"keyup":Ze=Ir;break;case"focusin":Ut="focus",Ze=go;break;case"focusout":Ut="blur",Ze=go;break;case"beforeblur":case"afterblur":Ze=go;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ze=vu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ze=mo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ze=hn;break;case Fl:case wu:case Yh:Ze=j;break;case Kh:Ze=Rn;break;case"scroll":case"scrollend":Ze=dc;break;case"wheel":Ze=vs;break;case"copy":case"cut":case"paste":Ze=_e;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ze=qa;break;case"toggle":case"beforetoggle":Ze=xu}var lr=(l&4)!==0,xa=!lr&&(s==="scroll"||s==="scrollend"),Pe=lr?Xe!==null?Xe+"Capture":null:Xe;lr=[];for(var Ce=$e,Ge;Ce!==null;){var lt=Ce;if(Ge=lt.stateNode,lt=lt.tag,lt!==5&&lt!==26&&lt!==27||Ge===null||Pe===null||(lt=Ri(Ce,Pe),lt!=null&&lr.push(b0(Ce,lt,Ge))),xa)break;Ce=Ce.return}0<lr.length&&(Xe=new Ze(Xe,Ut,null,f,it),ut.push({event:Xe,listeners:lr}))}}if((l&7)===0){e:{if(Xe=s==="mouseover"||s==="pointerover",Ze=s==="mouseout"||s==="pointerout",Xe&&f!==co&&(Ut=f.relatedTarget||f.fromElement)&&(bt(Ut)||Ut[be]))break e;if((Ze||Xe)&&(Xe=it.window===it?it:(Xe=it.ownerDocument)?Xe.defaultView||Xe.parentWindow:window,Ze?(Ut=f.relatedTarget||f.toElement,Ze=$e,Ut=Ut?bt(Ut):null,Ut!==null&&(xa=i(Ut),lr=Ut.tag,Ut!==xa||lr!==5&&lr!==27&&lr!==6)&&(Ut=null)):(Ze=null,Ut=$e),Ze!==Ut)){if(lr=vu,lt="onMouseLeave",Pe="onMouseEnter",Ce="mouse",(s==="pointerout"||s==="pointerover")&&(lr=qa,lt="onPointerLeave",Pe="onPointerEnter",Ce="pointer"),xa=Ze==null?Xe:yt(Ze),Ge=Ut==null?Xe:yt(Ut),Xe=new lr(lt,Ce+"leave",Ze,f,it),Xe.target=xa,Xe.relatedTarget=Ge,lt=null,bt(it)===$e&&(lr=new lr(Pe,Ce+"enter",Ut,f,it),lr.target=Ge,lr.relatedTarget=xa,lt=lr),xa=lt,Ze&&Ut)t:{for(lr=xk,Pe=Ze,Ce=Ut,Ge=0,lt=Pe;lt;lt=lr(lt))Ge++;lt=0;for(var rr=Ce;rr;rr=lr(rr))lt++;for(;0<Ge-lt;)Pe=lr(Pe),Ge--;for(;0<lt-Ge;)Ce=lr(Ce),lt--;for(;Ge--;){if(Pe===Ce||Ce!==null&&Pe===Ce.alternate){lr=Pe;break t}Pe=lr(Pe),Ce=lr(Ce)}lr=null}else lr=null;Ze!==null&&Cy(ut,Xe,Ze,lr,!1),Ut!==null&&xa!==null&&Cy(ut,xa,Ut,lr,!0)}}e:{if(Xe=$e?yt($e):window,Ze=Xe.nodeName&&Xe.nodeName.toLowerCase(),Ze==="select"||Ze==="input"&&Xe.type==="file")var Jr=Zo;else if(yu(Xe))if(gi)Jr=zs;else{Jr=za;var $t=xc}else Ze=Xe.nodeName,!Ze||Ze.toLowerCase()!=="input"||Xe.type!=="checkbox"&&Xe.type!=="radio"?$e&&du($e.elementType)&&(Jr=Zo):Jr=Nf;if(Jr&&(Jr=Jr(s,$e))){Di(ut,Jr,f,it);break e}$t&&$t(s,Xe,$e),s==="focusout"&&$e&&Xe.type==="number"&&$e.memoizedProps.value!=null&&uu(Xe,"number",Xe.value)}switch($t=$e?yt($e):window,s){case"focusin":(yu($t)||$t.contentEditable==="true")&&(Pi=$t,Ao=$e,Hn=null);break;case"focusout":Hn=Ao=Pi=null;break;case"mousedown":Vi=!0;break;case"contextmenu":case"mouseup":case"dragend":Vi=!1,$r(ut,f,it);break;case"selectionchange":if(Ol)break;case"keydown":case"keyup":$r(ut,f,it)}var kr;if(Is)e:{switch(s){case"compositionstart":var Mr="onCompositionStart";break e;case"compositionend":Mr="onCompositionEnd";break e;case"compositionupdate":Mr="onCompositionUpdate";break e}Mr=void 0}else Bs?Jo(s,f)&&(Mr="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(Mr="onCompositionStart");Mr&&(yo&&f.locale!=="ko"&&(Bs||Mr!=="onCompositionStart"?Mr==="onCompositionEnd"&&Bs&&(kr=Ef()):(Li=it,Nl="value"in Li?Li.value:Li.textContent,Bs=!0)),$t=n1($e,Mr),0<$t.length&&(Mr=new De(Mr,s,null,f,it),ut.push({event:Mr,listeners:$t}),kr?Mr.data=kr:(kr=mc(f),kr!==null&&(Mr.data=kr)))),(kr=Cl?ni(s,f):_o(s,f))&&(Mr=n1($e,"onBeforeInput"),0<Mr.length&&($t=new De("onBeforeInput","beforeinput",null,f,it),ut.push({event:$t,listeners:Mr}),$t.data=kr)),pk(ut,s,$e,f,it)}Ty(ut,l)})}function b0(s,l,f){return{instance:s,listener:l,currentTarget:f}}function n1(s,l){for(var f=l+"Capture",m=[];s!==null;){var _=s,k=_.stateNode;if(_=_.tag,_!==5&&_!==26&&_!==27||k===null||(_=Ri(s,f),_!=null&&m.unshift(b0(s,_,k)),_=Ri(s,l),_!=null&&m.push(b0(s,_,k))),s.tag===3)return m;s=s.return}return[]}function xk(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Cy(s,l,f,m,_){for(var k=l._reactName,U=[];f!==null&&f!==m;){var ne=f,Ae=ne.alternate,$e=ne.stateNode;if(ne=ne.tag,Ae!==null&&Ae===m)break;ne!==5&&ne!==26&&ne!==27||$e===null||(Ae=$e,_?($e=Ri(f,k),$e!=null&&U.unshift(b0(f,$e,Ae))):_||($e=Ri(f,k),$e!=null&&U.push(b0(f,$e,Ae)))),f=f.return}U.length!==0&&s.push({event:l,listeners:U})}var yk=/\r\n?/g,_k=/\u0000|\uFFFD/g;function Oy(s){return(typeof s=="string"?s:""+s).replace(yk,`
`).replace(_k,"")}function Fy(s,l){return l=Oy(l),Oy(s)===l}function va(s,l,f,m,_,k){switch(f){case"children":typeof m=="string"?l==="body"||l==="textarea"&&m===""||ms(s,m):(typeof m=="number"||typeof m=="bigint")&&l!=="body"&&ms(s,""+m);break;case"className":lo(s,"class",m);break;case"tabIndex":lo(s,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":lo(s,f,m);break;case"style":_f(s,m,k);break;case"data":if(l!=="object"){lo(s,"data",m);break}case"src":case"href":if(m===""&&(l!=="a"||f!=="href")){s.removeAttribute(f);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){s.removeAttribute(f);break}m=mi(""+m),s.setAttribute(f,m);break;case"action":case"formAction":if(typeof m=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(f==="formAction"?(l!=="input"&&va(s,l,"name",_.name,_,null),va(s,l,"formEncType",_.formEncType,_,null),va(s,l,"formMethod",_.formMethod,_,null),va(s,l,"formTarget",_.formTarget,_,null)):(va(s,l,"encType",_.encType,_,null),va(s,l,"method",_.method,_,null),va(s,l,"target",_.target,_,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){s.removeAttribute(f);break}m=mi(""+m),s.setAttribute(f,m);break;case"onClick":m!=null&&(s.onclick=gs);break;case"onScroll":m!=null&&Dr("scroll",s);break;case"onScrollEnd":m!=null&&Dr("scrollend",s);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(a(61));if(f=m.__html,f!=null){if(_.children!=null)throw Error(a(60));s.innerHTML=f}}break;case"multiple":s.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":s.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){s.removeAttribute("xlink:href");break}f=mi(""+m),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(f,""+m):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":m===!0?s.setAttribute(f,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?s.setAttribute(f,m):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?s.setAttribute(f,m):s.removeAttribute(f);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?s.removeAttribute(f):s.setAttribute(f,m);break;case"popover":Dr("beforetoggle",s),Dr("toggle",s),ka(s,"popover",m);break;case"xlinkActuate":ps(s,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":ps(s,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":ps(s,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":ps(s,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":ps(s,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":ps(s,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":ps(s,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":ps(s,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":ps(s,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":ka(s,"is",m);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=pu.get(f)||f,ka(s,f,m))}}function Um(s,l,f,m,_,k){switch(f){case"style":_f(s,m,k);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(a(61));if(f=m.__html,f!=null){if(_.children!=null)throw Error(a(60));s.innerHTML=f}}break;case"children":typeof m=="string"?ms(s,m):(typeof m=="number"||typeof m=="bigint")&&ms(s,""+m);break;case"onScroll":m!=null&&Dr("scroll",s);break;case"onScrollEnd":m!=null&&Dr("scrollend",s);break;case"onClick":m!=null&&(s.onclick=gs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!jr.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(_=f.endsWith("Capture"),l=f.slice(2,_?f.length-7:void 0),k=s[pe]||null,k=k!=null?k[f]:null,typeof k=="function"&&s.removeEventListener(l,k,_),typeof m=="function")){typeof k!="function"&&k!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(l,m,_);break e}f in s?s[f]=m:m===!0?s.setAttribute(f,""):ka(s,f,m)}}}function ci(s,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Dr("error",s),Dr("load",s);var m=!1,_=!1,k;for(k in f)if(f.hasOwnProperty(k)){var U=f[k];if(U!=null)switch(k){case"src":m=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,l));default:va(s,l,k,U,f,null)}}_&&va(s,l,"srcSet",f.srcSet,f,null),m&&va(s,l,"src",f.src,f,null);return;case"input":Dr("invalid",s);var ne=k=U=_=null,Ae=null,$e=null;for(m in f)if(f.hasOwnProperty(m)){var it=f[m];if(it!=null)switch(m){case"name":_=it;break;case"type":U=it;break;case"checked":Ae=it;break;case"defaultChecked":$e=it;break;case"value":k=it;break;case"defaultValue":ne=it;break;case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(a(137,l));break;default:va(s,l,m,it,f,null)}}xf(s,k,ne,Ae,$e,U,_,!1);return;case"select":Dr("invalid",s),m=U=k=null;for(_ in f)if(f.hasOwnProperty(_)&&(ne=f[_],ne!=null))switch(_){case"value":k=ne;break;case"defaultValue":U=ne;break;case"multiple":m=ne;default:va(s,l,_,ne,f,null)}l=k,f=U,s.multiple=!!m,l!=null?ai(s,!!m,l,!1):f!=null&&ai(s,!!m,f,!0);return;case"textarea":Dr("invalid",s),k=_=m=null;for(U in f)if(f.hasOwnProperty(U)&&(ne=f[U],ne!=null))switch(U){case"value":m=ne;break;case"defaultValue":_=ne;break;case"children":k=ne;break;case"dangerouslySetInnerHTML":if(ne!=null)throw Error(a(91));break;default:va(s,l,U,ne,f,null)}hu(s,m,_,k);return;case"option":for(Ae in f)if(f.hasOwnProperty(Ae)&&(m=f[Ae],m!=null))switch(Ae){case"selected":s.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:va(s,l,Ae,m,f,null)}return;case"dialog":Dr("beforetoggle",s),Dr("toggle",s),Dr("cancel",s),Dr("close",s);break;case"iframe":case"object":Dr("load",s);break;case"video":case"audio":for(m=0;m<w0.length;m++)Dr(w0[m],s);break;case"image":Dr("error",s),Dr("load",s);break;case"details":Dr("toggle",s);break;case"embed":case"source":case"link":Dr("error",s),Dr("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($e in f)if(f.hasOwnProperty($e)&&(m=f[$e],m!=null))switch($e){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,l));default:va(s,l,$e,m,f,null)}return;default:if(du(l)){for(it in f)f.hasOwnProperty(it)&&(m=f[it],m!==void 0&&Um(s,l,it,m,f,void 0));return}}for(ne in f)f.hasOwnProperty(ne)&&(m=f[ne],m!=null&&va(s,l,ne,m,f,null))}function wk(s,l,f,m){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,k=null,U=null,ne=null,Ae=null,$e=null,it=null;for(Ze in f){var ut=f[Ze];if(f.hasOwnProperty(Ze)&&ut!=null)switch(Ze){case"checked":break;case"value":break;case"defaultValue":Ae=ut;default:m.hasOwnProperty(Ze)||va(s,l,Ze,null,m,ut)}}for(var Xe in m){var Ze=m[Xe];if(ut=f[Xe],m.hasOwnProperty(Xe)&&(Ze!=null||ut!=null))switch(Xe){case"type":k=Ze;break;case"name":_=Ze;break;case"checked":$e=Ze;break;case"defaultChecked":it=Ze;break;case"value":U=Ze;break;case"defaultValue":ne=Ze;break;case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(a(137,l));break;default:Ze!==ut&&va(s,l,Xe,Ze,m,ut)}}uc(s,U,ne,Ae,$e,it,k,_);return;case"select":Ze=U=ne=Xe=null;for(k in f)if(Ae=f[k],f.hasOwnProperty(k)&&Ae!=null)switch(k){case"value":break;case"multiple":Ze=Ae;default:m.hasOwnProperty(k)||va(s,l,k,null,m,Ae)}for(_ in m)if(k=m[_],Ae=f[_],m.hasOwnProperty(_)&&(k!=null||Ae!=null))switch(_){case"value":Xe=k;break;case"defaultValue":ne=k;break;case"multiple":U=k;default:k!==Ae&&va(s,l,_,k,m,Ae)}l=ne,f=U,m=Ze,Xe!=null?ai(s,!!f,Xe,!1):!!m!=!!f&&(l!=null?ai(s,!!f,l,!0):ai(s,!!f,f?[]:"",!1));return;case"textarea":Ze=Xe=null;for(ne in f)if(_=f[ne],f.hasOwnProperty(ne)&&_!=null&&!m.hasOwnProperty(ne))switch(ne){case"value":break;case"children":break;default:va(s,l,ne,null,m,_)}for(U in m)if(_=m[U],k=f[U],m.hasOwnProperty(U)&&(_!=null||k!=null))switch(U){case"value":Xe=_;break;case"defaultValue":Ze=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(a(91));break;default:_!==k&&va(s,l,U,_,m,k)}fu(s,Xe,Ze);return;case"option":for(var Ut in f)if(Xe=f[Ut],f.hasOwnProperty(Ut)&&Xe!=null&&!m.hasOwnProperty(Ut))switch(Ut){case"selected":s.selected=!1;break;default:va(s,l,Ut,null,m,Xe)}for(Ae in m)if(Xe=m[Ae],Ze=f[Ae],m.hasOwnProperty(Ae)&&Xe!==Ze&&(Xe!=null||Ze!=null))switch(Ae){case"selected":s.selected=Xe&&typeof Xe!="function"&&typeof Xe!="symbol";break;default:va(s,l,Ae,Xe,m,Ze)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var lr in f)Xe=f[lr],f.hasOwnProperty(lr)&&Xe!=null&&!m.hasOwnProperty(lr)&&va(s,l,lr,null,m,Xe);for($e in m)if(Xe=m[$e],Ze=f[$e],m.hasOwnProperty($e)&&Xe!==Ze&&(Xe!=null||Ze!=null))switch($e){case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(a(137,l));break;default:va(s,l,$e,Xe,m,Ze)}return;default:if(du(l)){for(var xa in f)Xe=f[xa],f.hasOwnProperty(xa)&&Xe!==void 0&&!m.hasOwnProperty(xa)&&Um(s,l,xa,void 0,m,Xe);for(it in m)Xe=m[it],Ze=f[it],!m.hasOwnProperty(it)||Xe===Ze||Xe===void 0&&Ze===void 0||Um(s,l,it,Xe,m,Ze);return}}for(var Pe in f)Xe=f[Pe],f.hasOwnProperty(Pe)&&Xe!=null&&!m.hasOwnProperty(Pe)&&va(s,l,Pe,null,m,Xe);for(ut in m)Xe=m[ut],Ze=f[ut],!m.hasOwnProperty(ut)||Xe===Ze||Xe==null&&Ze==null||va(s,l,ut,Xe,m,Ze)}function Ry(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function bk(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,f=performance.getEntriesByType("resource"),m=0;m<f.length;m++){var _=f[m],k=_.transferSize,U=_.initiatorType,ne=_.duration;if(k&&ne&&Ry(U)){for(U=0,ne=_.responseEnd,m+=1;m<f.length;m++){var Ae=f[m],$e=Ae.startTime;if($e>ne)break;var it=Ae.transferSize,ut=Ae.initiatorType;it&&Ry(ut)&&(Ae=Ae.responseEnd,U+=it*(Ae<ne?1:(ne-$e)/(Ae-$e)))}if(--m,l+=8*(k+U)/(_.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var qm=null,zm=null;function i1(s){return s.nodeType===9?s:s.ownerDocument}function Ly(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Dy(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function Hm(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Wm=null;function Sk(){var s=window.event;return s&&s.type==="popstate"?s===Wm?!1:(Wm=s,!0):(Wm=null,!1)}var Py=typeof setTimeout=="function"?setTimeout:void 0,Ek=typeof clearTimeout=="function"?clearTimeout:void 0,My=typeof Promise=="function"?Promise:void 0,kk=typeof queueMicrotask=="function"?queueMicrotask:typeof My<"u"?function(s){return My.resolve(null).then(s).catch(Ak)}:Py;function Ak(s){setTimeout(function(){throw s})}function Ic(s){return s==="head"}function Iy(s,l){var f=l,m=0;do{var _=f.nextSibling;if(s.removeChild(f),_&&_.nodeType===8)if(f=_.data,f==="/$"||f==="/&"){if(m===0){s.removeChild(_),sh(l);return}m--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")m++;else if(f==="html")S0(s.ownerDocument.documentElement);else if(f==="head"){f=s.ownerDocument.head,S0(f);for(var k=f.firstChild;k;){var U=k.nextSibling,ne=k.nodeName;k[Ve]||ne==="SCRIPT"||ne==="STYLE"||ne==="LINK"&&k.rel.toLowerCase()==="stylesheet"||f.removeChild(k),k=U}}else f==="body"&&S0(s.ownerDocument.body);f=_}while(f);sh(l)}function By(s,l){var f=s;s=0;do{var m=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),m&&m.nodeType===8)if(f=m.data,f==="/$"){if(s===0)break;s--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||s++;f=m}while(f)}function Vm(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Vm(f),pt(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function Nk(s,l,f,m){for(;s.nodeType===1;){var _=f;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!m&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(m){if(!s[Ve])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(k=s.getAttribute("rel"),k==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(k!==_.rel||s.getAttribute("href")!==(_.href==null||_.href===""?null:_.href)||s.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||s.getAttribute("title")!==(_.title==null?null:_.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(k=s.getAttribute("src"),(k!==(_.src==null?null:_.src)||s.getAttribute("type")!==(_.type==null?null:_.type)||s.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&k&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var k=_.name==null?null:""+_.name;if(_.type==="hidden"&&s.getAttribute("name")===k)return s}else return s;if(s=Ys(s.nextSibling),s===null)break}return null}function Tk(s,l,f){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=Ys(s.nextSibling),s===null))return null;return s}function Uy(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Ys(s.nextSibling),s===null))return null;return s}function Gm(s){return s.data==="$?"||s.data==="$~"}function $m(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function jk(s,l){var f=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||f.readyState!=="loading")l();else{var m=function(){l(),f.removeEventListener("DOMContentLoaded",m)};f.addEventListener("DOMContentLoaded",m),s._reactRetry=m}}function Ys(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var Xm=null;function qy(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"||f==="/&"){if(l===0)return Ys(s.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}s=s.nextSibling}return null}function zy(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return s;l--}else f!=="/$"&&f!=="/&"||l++}s=s.previousSibling}return null}function Hy(s,l,f){switch(l=i1(f),s){case"html":if(s=l.documentElement,!s)throw Error(a(452));return s;case"head":if(s=l.head,!s)throw Error(a(453));return s;case"body":if(s=l.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function S0(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);pt(s)}var Ks=new Map,Wy=new Set;function s1(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Yl=he.d;he.d={f:Ck,r:Ok,D:Fk,C:Rk,L:Lk,m:Dk,X:Mk,S:Pk,M:Ik};function Ck(){var s=Yl.f(),l=Jd();return s||l}function Ok(s){var l=Tt(s);l!==null&&l.tag===5&&l.type==="form"?ox(l):Yl.r(s)}var ah=typeof document>"u"?null:document;function Vy(s,l,f){var m=ah;if(m&&typeof l=="string"&&l){var _=Za(l);_='link[rel="'+s+'"][href="'+_+'"]',typeof f=="string"&&(_+='[crossorigin="'+f+'"]'),Wy.has(_)||(Wy.add(_),s={rel:s,crossOrigin:f,href:l},m.querySelector(_)===null&&(l=m.createElement("link"),ci(l,"link",s),Lt(l),m.head.appendChild(l)))}}function Fk(s){Yl.D(s),Vy("dns-prefetch",s,null)}function Rk(s,l){Yl.C(s,l),Vy("preconnect",s,l)}function Lk(s,l,f){Yl.L(s,l,f);var m=ah;if(m&&s&&l){var _='link[rel="preload"][as="'+Za(l)+'"]';l==="image"&&f&&f.imageSrcSet?(_+='[imagesrcset="'+Za(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(_+='[imagesizes="'+Za(f.imageSizes)+'"]')):_+='[href="'+Za(s)+'"]';var k=_;switch(l){case"style":k=nh(s);break;case"script":k=ih(s)}Ks.has(k)||(s=v({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:s,as:l},f),Ks.set(k,s),m.querySelector(_)!==null||l==="style"&&m.querySelector(E0(k))||l==="script"&&m.querySelector(k0(k))||(l=m.createElement("link"),ci(l,"link",s),Lt(l),m.head.appendChild(l)))}}function Dk(s,l){Yl.m(s,l);var f=ah;if(f&&s){var m=l&&typeof l.as=="string"?l.as:"script",_='link[rel="modulepreload"][as="'+Za(m)+'"][href="'+Za(s)+'"]',k=_;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=ih(s)}if(!Ks.has(k)&&(s=v({rel:"modulepreload",href:s},l),Ks.set(k,s),f.querySelector(_)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(k0(k)))return}m=f.createElement("link"),ci(m,"link",s),Lt(m),f.head.appendChild(m)}}}function Pk(s,l,f){Yl.S(s,l,f);var m=ah;if(m&&s){var _=kt(m).hoistableStyles,k=nh(s);l=l||"default";var U=_.get(k);if(!U){var ne={loading:0,preload:null};if(U=m.querySelector(E0(k)))ne.loading=5;else{s=v({rel:"stylesheet",href:s,"data-precedence":l},f),(f=Ks.get(k))&&Ym(s,f);var Ae=U=m.createElement("link");Lt(Ae),ci(Ae,"link",s),Ae._p=new Promise(function($e,it){Ae.onload=$e,Ae.onerror=it}),Ae.addEventListener("load",function(){ne.loading|=1}),Ae.addEventListener("error",function(){ne.loading|=2}),ne.loading|=4,o1(U,l,m)}U={type:"stylesheet",instance:U,count:1,state:ne},_.set(k,U)}}}function Mk(s,l){Yl.X(s,l);var f=ah;if(f&&s){var m=kt(f).hoistableScripts,_=ih(s),k=m.get(_);k||(k=f.querySelector(k0(_)),k||(s=v({src:s,async:!0},l),(l=Ks.get(_))&&Km(s,l),k=f.createElement("script"),Lt(k),ci(k,"link",s),f.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},m.set(_,k))}}function Ik(s,l){Yl.M(s,l);var f=ah;if(f&&s){var m=kt(f).hoistableScripts,_=ih(s),k=m.get(_);k||(k=f.querySelector(k0(_)),k||(s=v({src:s,async:!0,type:"module"},l),(l=Ks.get(_))&&Km(s,l),k=f.createElement("script"),Lt(k),ci(k,"link",s),f.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},m.set(_,k))}}function Gy(s,l,f,m){var _=(_=K.current)?s1(_):null;if(!_)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=nh(f.href),f=kt(_).hoistableStyles,m=f.get(l),m||(m={type:"style",instance:null,count:0,state:null},f.set(l,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=nh(f.href);var k=kt(_).hoistableStyles,U=k.get(s);if(U||(_=_.ownerDocument||_,U={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},k.set(s,U),(k=_.querySelector(E0(s)))&&!k._p&&(U.instance=k,U.state.loading=5),Ks.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},Ks.set(s,f),k||Bk(_,s,f,U.state))),l&&m===null)throw Error(a(528,""));return U}if(l&&m!==null)throw Error(a(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=ih(f),f=kt(_).hoistableScripts,m=f.get(l),m||(m={type:"script",instance:null,count:0,state:null},f.set(l,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function nh(s){return'href="'+Za(s)+'"'}function E0(s){return'link[rel="stylesheet"]['+s+"]"}function $y(s){return v({},s,{"data-precedence":s.precedence,precedence:null})}function Bk(s,l,f,m){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?m.loading=1:(l=s.createElement("link"),m.preload=l,l.addEventListener("load",function(){return m.loading|=1}),l.addEventListener("error",function(){return m.loading|=2}),ci(l,"link",f),Lt(l),s.head.appendChild(l))}function ih(s){return'[src="'+Za(s)+'"]'}function k0(s){return"script[async]"+s}function Xy(s,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var m=s.querySelector('style[data-href~="'+Za(f.href)+'"]');if(m)return l.instance=m,Lt(m),m;var _=v({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return m=(s.ownerDocument||s).createElement("style"),Lt(m),ci(m,"style",_),o1(m,f.precedence,s),l.instance=m;case"stylesheet":_=nh(f.href);var k=s.querySelector(E0(_));if(k)return l.state.loading|=4,l.instance=k,Lt(k),k;m=$y(f),(_=Ks.get(_))&&Ym(m,_),k=(s.ownerDocument||s).createElement("link"),Lt(k);var U=k;return U._p=new Promise(function(ne,Ae){U.onload=ne,U.onerror=Ae}),ci(k,"link",m),l.state.loading|=4,o1(k,f.precedence,s),l.instance=k;case"script":return k=ih(f.src),(_=s.querySelector(k0(k)))?(l.instance=_,Lt(_),_):(m=f,(_=Ks.get(k))&&(m=v({},f),Km(m,_)),s=s.ownerDocument||s,_=s.createElement("script"),Lt(_),ci(_,"link",m),s.head.appendChild(_),l.instance=_);case"void":return null;default:throw Error(a(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(m=l.instance,l.state.loading|=4,o1(m,f.precedence,s));return l.instance}function o1(s,l,f){for(var m=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=m.length?m[m.length-1]:null,k=_,U=0;U<m.length;U++){var ne=m[U];if(ne.dataset.precedence===l)k=ne;else if(k!==_)break}k?k.parentNode.insertBefore(s,k.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(s,l.firstChild))}function Ym(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function Km(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var l1=null;function Yy(s,l,f){if(l1===null){var m=new Map,_=l1=new Map;_.set(f,m)}else _=l1,m=_.get(f),m||(m=new Map,_.set(f,m));if(m.has(s))return m;for(m.set(s,null),f=f.getElementsByTagName(s),_=0;_<f.length;_++){var k=f[_];if(!(k[Ve]||k[ue]||s==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!=="http://www.w3.org/2000/svg"){var U=k.getAttribute(l)||"";U=s+U;var ne=m.get(U);ne?ne.push(k):m.set(U,[k])}}return m}function Ky(s,l,f){s=s.ownerDocument||s,s.head.insertBefore(f,l==="title"?s.querySelector("head > title"):null)}function Uk(s,l,f){if(f===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function Jy(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function qk(s,l,f,m){if(f.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var _=nh(m.href),k=l.querySelector(E0(_));if(k){l=k._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=c1.bind(s),l.then(s,s)),f.state.loading|=4,f.instance=k,Lt(k);return}k=l.ownerDocument||l,m=$y(m),(_=Ks.get(_))&&Ym(m,_),k=k.createElement("link"),Lt(k);var U=k;U._p=new Promise(function(ne,Ae){U.onload=ne,U.onerror=Ae}),ci(k,"link",m),f.instance=k}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(s.count++,f=c1.bind(s),l.addEventListener("load",f),l.addEventListener("error",f))}}var Jm=0;function zk(s,l){return s.stylesheets&&s.count===0&&f1(s,s.stylesheets),0<s.count||0<s.imgCount?function(f){var m=setTimeout(function(){if(s.stylesheets&&f1(s,s.stylesheets),s.unsuspend){var k=s.unsuspend;s.unsuspend=null,k()}},6e4+l);0<s.imgBytes&&Jm===0&&(Jm=62500*bk());var _=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&f1(s,s.stylesheets),s.unsuspend)){var k=s.unsuspend;s.unsuspend=null,k()}},(s.imgBytes>Jm?50:800)+l);return s.unsuspend=f,function(){s.unsuspend=null,clearTimeout(m),clearTimeout(_)}}:null}function c1(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)f1(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var u1=null;function f1(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,u1=new Map,l.forEach(Hk,s),u1=null,c1.call(s))}function Hk(s,l){if(!(l.state.loading&4)){var f=u1.get(s);if(f)var m=f.get(null);else{f=new Map,u1.set(s,f);for(var _=s.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<_.length;k++){var U=_[k];(U.nodeName==="LINK"||U.getAttribute("media")!=="not all")&&(f.set(U.dataset.precedence,U),m=U)}m&&f.set(null,m)}_=l.instance,U=_.getAttribute("data-precedence"),k=f.get(U)||m,k===m&&f.set(null,_),f.set(U,_),this.count++,m=c1.bind(this),_.addEventListener("load",m),_.addEventListener("error",m),k?k.parentNode.insertBefore(_,k.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(_,s.firstChild)),l.state.loading|=4}}var A0={$$typeof:T,Provider:null,Consumer:null,_currentValue:de,_currentValue2:de,_threadCount:0};function Wk(s,l,f,m,_,k,U,ne,Ae){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ja(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ja(0),this.hiddenUpdates=Ja(null),this.identifierPrefix=m,this.onUncaughtError=_,this.onCaughtError=k,this.onRecoverableError=U,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ae,this.incompleteTransitions=new Map}function Zy(s,l,f,m,_,k,U,ne,Ae,$e,it,ut){return s=new Wk(s,l,f,U,Ae,$e,it,ut,ne),l=1,k===!0&&(l|=24),k=Vn(3,null,null,l),s.current=k,k.stateNode=s,l=Ac(),l.refCount++,s.pooledCache=l,l.refCount++,k.memoizedState={element:m,isDehydrated:f,cache:l},Nt(k),s}function Qy(s){return s?(s=Dn,s):Dn}function e_(s,l,f,m,_,k){_=Qy(_),m.context===null?m.context=_:m.pendingContext=_,m=or(l),m.payload={element:f},k=k===void 0?null:k,k!==null&&(m.callback=k),f=wr(s,m,l),f!==null&&(is(f,s,l),ta(f,s,l))}function t_(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function Zm(s,l){t_(s,l),(s=s.alternate)&&t_(s,l)}function r_(s){if(s.tag===13||s.tag===31){var l=No(s,67108864);l!==null&&is(l,s,67108864),Zm(s,67108864)}}function a_(s){if(s.tag===13||s.tag===31){var l=ks();l=ha(l);var f=No(s,l);f!==null&&is(f,s,l),Zm(s,l)}}var h1=!0;function Vk(s,l,f,m){var _=ie.T;ie.T=null;var k=he.p;try{he.p=2,Qm(s,l,f,m)}finally{he.p=k,ie.T=_}}function Gk(s,l,f,m){var _=ie.T;ie.T=null;var k=he.p;try{he.p=8,Qm(s,l,f,m)}finally{he.p=k,ie.T=_}}function Qm(s,l,f,m){if(h1){var _=eg(m);if(_===null)Bm(s,l,m,d1,f),i_(s,m);else if(Xk(_,s,l,f,m))m.stopPropagation();else if(i_(s,m),l&4&&-1<$k.indexOf(s)){for(;_!==null;){var k=Tt(_);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var U=Dt(k.pendingLanes);if(U!==0){var ne=k;for(ne.pendingLanes|=2,ne.entangledLanes|=2;U;){var Ae=1<<31-br(U);ne.entanglements[1]|=Ae,U&=~Ae}fl(k),(aa&6)===0&&(Yd=It()+500,_0(0))}}break;case 31:case 13:ne=No(k,2),ne!==null&&is(ne,k,2),Jd(),Zm(k,2)}if(k=eg(m),k===null&&Bm(s,l,m,d1,f),k===_)break;_=k}_!==null&&m.stopPropagation()}else Bm(s,l,m,null,f)}}function eg(s){return s=kl(s),tg(s)}var d1=null;function tg(s){if(d1=null,s=bt(s),s!==null){var l=i(s);if(l===null)s=null;else{var f=l.tag;if(f===13){if(s=o(l),s!==null)return s;s=null}else if(f===31){if(s=c(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return d1=s,null}function n_(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(er()){case Vt:return 2;case Oe:return 8;case Ye:case He:return 32;case ct:return 268435456;default:return 32}default:return 32}}var rg=!1,Bc=null,Uc=null,qc=null,N0=new Map,T0=new Map,zc=[],$k="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function i_(s,l){switch(s){case"focusin":case"focusout":Bc=null;break;case"dragenter":case"dragleave":Uc=null;break;case"mouseover":case"mouseout":qc=null;break;case"pointerover":case"pointerout":N0.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":T0.delete(l.pointerId)}}function j0(s,l,f,m,_,k){return s===null||s.nativeEvent!==k?(s={blockedOn:l,domEventName:f,eventSystemFlags:m,nativeEvent:k,targetContainers:[_]},l!==null&&(l=Tt(l),l!==null&&r_(l)),s):(s.eventSystemFlags|=m,l=s.targetContainers,_!==null&&l.indexOf(_)===-1&&l.push(_),s)}function Xk(s,l,f,m,_){switch(l){case"focusin":return Bc=j0(Bc,s,l,f,m,_),!0;case"dragenter":return Uc=j0(Uc,s,l,f,m,_),!0;case"mouseover":return qc=j0(qc,s,l,f,m,_),!0;case"pointerover":var k=_.pointerId;return N0.set(k,j0(N0.get(k)||null,s,l,f,m,_)),!0;case"gotpointercapture":return k=_.pointerId,T0.set(k,j0(T0.get(k)||null,s,l,f,m,_)),!0}return!1}function s_(s){var l=bt(s.target);if(l!==null){var f=i(l);if(f!==null){if(l=f.tag,l===13){if(l=o(f),l!==null){s.blockedOn=l,ye(s.priority,function(){a_(f)});return}}else if(l===31){if(l=c(f),l!==null){s.blockedOn=l,ye(s.priority,function(){a_(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function p1(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=eg(s.nativeEvent);if(f===null){f=s.nativeEvent;var m=new f.constructor(f.type,f);co=m,f.target.dispatchEvent(m),co=null}else return l=Tt(f),l!==null&&r_(l),s.blockedOn=f,!1;l.shift()}return!0}function o_(s,l,f){p1(s)&&f.delete(l)}function Yk(){rg=!1,Bc!==null&&p1(Bc)&&(Bc=null),Uc!==null&&p1(Uc)&&(Uc=null),qc!==null&&p1(qc)&&(qc=null),N0.forEach(o_),T0.forEach(o_)}function m1(s,l){s.blockedOn===l&&(s.blockedOn=null,rg||(rg=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Yk)))}var g1=null;function l_(s){g1!==s&&(g1=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){g1===s&&(g1=null);for(var l=0;l<s.length;l+=3){var f=s[l],m=s[l+1],_=s[l+2];if(typeof m!="function"){if(tg(m||f)===null)continue;break}var k=Tt(f);k!==null&&(s.splice(l,3),l-=3,em(k,{pending:!0,data:_,method:f.method,action:m},m,_))}}))}function sh(s){function l(Ae){return m1(Ae,s)}Bc!==null&&m1(Bc,s),Uc!==null&&m1(Uc,s),qc!==null&&m1(qc,s),N0.forEach(l),T0.forEach(l);for(var f=0;f<zc.length;f++){var m=zc[f];m.blockedOn===s&&(m.blockedOn=null)}for(;0<zc.length&&(f=zc[0],f.blockedOn===null);)s_(f),f.blockedOn===null&&zc.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(m=0;m<f.length;m+=3){var _=f[m],k=f[m+1],U=_[pe]||null;if(typeof k=="function")U||l_(f);else if(U){var ne=null;if(k&&k.hasAttribute("formAction")){if(_=k,U=k[pe]||null)ne=U.formAction;else if(tg(_)!==null)continue}else ne=U.action;typeof ne=="function"?f[m+1]=ne:(f.splice(m,3),m-=3),l_(f)}}}function c_(){function s(k){k.canIntercept&&k.info==="react-transition"&&k.intercept({handler:function(){return new Promise(function(U){return _=U})},focusReset:"manual",scroll:"manual"})}function l(){_!==null&&(_(),_=null),m||setTimeout(f,20)}function f(){if(!m&&!navigation.transition){var k=navigation.currentEntry;k&&k.url!=null&&navigation.navigate(k.url,{state:k.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,_=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){m=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),_!==null&&(_(),_=null)}}}function ag(s){this._internalRoot=s}v1.prototype.render=ag.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(a(409));var f=l.current,m=ks();e_(f,m,s,l,null,null)},v1.prototype.unmount=ag.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;e_(s.current,2,null,s,null,null),Jd(),l[be]=null}};function v1(s){this._internalRoot=s}v1.prototype.unstable_scheduleHydration=function(s){if(s){var l=J();s={blockedOn:null,target:s,priority:l};for(var f=0;f<zc.length&&l!==0&&l<zc[f].priority;f++);zc.splice(f,0,s),f===0&&s_(s)}};var u_=e.version;if(u_!=="19.2.3")throw Error(a(527,u_,"19.2.3"));he.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=h(l),s=s!==null?d(s):null,s=s===null?null:s.stateNode,s};var Kk={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:ie,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var x1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!x1.isDisabled&&x1.supportsFiber)try{Rt=x1.inject(Kk),Wt=x1}catch{}}return O0.createRoot=function(s,l){if(!n(s))throw Error(a(299));var f=!1,m="",_=vx,k=xx,U=yx;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(_=l.onUncaughtError),l.onCaughtError!==void 0&&(k=l.onCaughtError),l.onRecoverableError!==void 0&&(U=l.onRecoverableError)),l=Zy(s,1,!1,null,null,f,m,null,_,k,U,c_),s[be]=l.current,Im(s),new ag(l)},O0.hydrateRoot=function(s,l,f){if(!n(s))throw Error(a(299));var m=!1,_="",k=vx,U=xx,ne=yx,Ae=null;return f!=null&&(f.unstable_strictMode===!0&&(m=!0),f.identifierPrefix!==void 0&&(_=f.identifierPrefix),f.onUncaughtError!==void 0&&(k=f.onUncaughtError),f.onCaughtError!==void 0&&(U=f.onCaughtError),f.onRecoverableError!==void 0&&(ne=f.onRecoverableError),f.formState!==void 0&&(Ae=f.formState)),l=Zy(s,1,!0,l,f??null,m,_,Ae,k,U,ne,c_),l.context=Qy(null),f=l.current,m=ks(),m=ha(m),_=or(m),_.callback=null,wr(f,_,m),f=m,l.current.lanes=f,Kt(l,f),fl(l),s[be]=l.current,Im(s),new v1(l)},O0.version="19.2.3",O0}var __;function cA(){if(__)return sg.exports;__=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),sg.exports=lA(),sg.exports}var uA=cA();const fA=$v(uA);var nv=function(t,e){return nv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},nv(t,e)};function bb(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");nv(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var np=function(){return np=Object.assign||function(e){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},np.apply(this,arguments)};function zh(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(t);n<a.length;n++)e.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(r[a[n]]=t[a[n]]);return r}function Sb(t,e,r,a){var n=arguments.length,i=n<3?e:a===null?a=Object.getOwnPropertyDescriptor(e,r):a,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,a);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(n<3?o(i):n>3?o(e,r,i):o(e,r))||i);return n>3&&i&&Object.defineProperty(e,r,i),i}function Eb(t,e){return function(r,a){e(r,a,t)}}function kb(t,e,r,a,n,i){function o(A){if(A!==void 0&&typeof A!="function")throw new TypeError("Function expected");return A}for(var c=a.kind,u=c==="getter"?"get":c==="setter"?"set":"value",h=!e&&t?a.static?t:t.prototype:null,d=e||(h?Object.getOwnPropertyDescriptor(h,a.name):{}),v,y=!1,g=r.length-1;g>=0;g--){var b={};for(var w in a)b[w]=w==="access"?{}:a[w];for(var w in a.access)b.access[w]=a.access[w];b.addInitializer=function(A){if(y)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(A||null))};var E=(0,r[g])(c==="accessor"?{get:d.get,set:d.set}:d[u],b);if(c==="accessor"){if(E===void 0)continue;if(E===null||typeof E!="object")throw new TypeError("Object expected");(v=o(E.get))&&(d.get=v),(v=o(E.set))&&(d.set=v),(v=o(E.init))&&n.unshift(v)}else(v=o(E))&&(c==="field"?n.unshift(v):d[u]=v)}h&&Object.defineProperty(h,a.name,d),y=!0}function Ab(t,e,r){for(var a=arguments.length>2,n=0;n<e.length;n++)r=a?e[n].call(t,r):e[n].call(t);return a?r:void 0}function Nb(t){return typeof t=="symbol"?t:"".concat(t)}function Tb(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function jb(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Mt(t,e,r,a){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(d){try{h(a.next(d))}catch(v){o(v)}}function u(d){try{h(a.throw(d))}catch(v){o(v)}}function h(d){d.done?i(d.value):n(d.value).then(c,u)}h((a=a.apply(t,e||[])).next())})}function Cb(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,n,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=c(0),o.throw=c(1),o.return=c(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(d){return u([h,d])}}function u(h){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,h[0]&&(r=0)),r;)try{if(a=1,n&&(i=h[0]&2?n.return:h[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,h[1])).done)return i;switch(n=0,i&&(h=[h[0]&2,i.value]),h[0]){case 0:case 1:i=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!i||h[1]>i[0]&&h[1]<i[3])){r.label=h[1];break}if(h[0]===6&&r.label<i[1]){r.label=i[1],i=h;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(h);break}i[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(d){h=[6,d],n=0}finally{a=i=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}var Op=Object.create?(function(t,e,r,a){a===void 0&&(a=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,a,n)}):(function(t,e,r,a){a===void 0&&(a=r),t[a]=e[r]});function Ob(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Op(e,t,r)}function ip(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],a=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&a>=t.length&&(t=void 0),{value:t&&t[a++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Yv(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var a=r.call(t),n,i=[],o;try{for(;(e===void 0||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function Fb(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Yv(arguments[e]));return t}function Rb(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var a=Array(t),n=0,e=0;e<r;e++)for(var i=arguments[e],o=0,c=i.length;o<c;o++,n++)a[n]=i[o];return a}function Lb(t,e,r){if(r||arguments.length===2)for(var a=0,n=e.length,i;a<n;a++)(i||!(a in e))&&(i||(i=Array.prototype.slice.call(e,0,a)),i[a]=e[a]);return t.concat(i||Array.prototype.slice.call(e))}function Ph(t){return this instanceof Ph?(this.v=t,this):new Ph(t)}function Db(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r.apply(t,e||[]),n,i=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",o),n[Symbol.asyncIterator]=function(){return this},n;function o(g){return function(b){return Promise.resolve(b).then(g,v)}}function c(g,b){a[g]&&(n[g]=function(w){return new Promise(function(E,A){i.push([g,w,E,A])>1||u(g,w)})},b&&(n[g]=b(n[g])))}function u(g,b){try{h(a[g](b))}catch(w){y(i[0][3],w)}}function h(g){g.value instanceof Ph?Promise.resolve(g.value.v).then(d,v):y(i[0][2],g)}function d(g){u("next",g)}function v(g){u("throw",g)}function y(g,b){g(b),i.shift(),i.length&&u(i[0][0],i[0][1])}}function Pb(t){var e,r;return e={},a("next"),a("throw",function(n){throw n}),a("return"),e[Symbol.iterator]=function(){return this},e;function a(n,i){e[n]=t[n]?function(o){return(r=!r)?{value:Ph(t[n](o)),done:!1}:i?i(o):o}:i}}function Mb(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ip=="function"?ip(t):t[Symbol.iterator](),r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r);function a(i){r[i]=t[i]&&function(o){return new Promise(function(c,u){o=t[i](o),n(c,u,o.done,o.value)})}}function n(i,o,c,u){Promise.resolve(u).then(function(h){i({value:h,done:c})},o)}}function Ib(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var hA=Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e},iv=function(t){return iv=Object.getOwnPropertyNames||function(e){var r=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[r.length]=a);return r},iv(t)};function Bb(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=iv(t),a=0;a<r.length;a++)r[a]!=="default"&&Op(e,t,r[a]);return hA(e,t),e}function Ub(t){return t&&t.__esModule?t:{default:t}}function qb(t,e,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(t):a?a.value:e.get(t)}function zb(t,e,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}function Hb(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function Wb(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var a,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");a=e[Symbol.asyncDispose]}if(a===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");a=e[Symbol.dispose],r&&(n=a)}if(typeof a!="function")throw new TypeError("Object not disposable.");n&&(a=function(){try{n.call(this)}catch(i){return Promise.reject(i)}}),t.stack.push({value:e,dispose:a,async:r})}else r&&t.stack.push({async:!0});return e}var dA=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var a=new Error(r);return a.name="SuppressedError",a.error=t,a.suppressed=e,a};function Vb(t){function e(i){t.error=t.hasError?new dA(i,t.error,"An error was suppressed during disposal."):i,t.hasError=!0}var r,a=0;function n(){for(;r=t.stack.pop();)try{if(!r.async&&a===1)return a=0,t.stack.push(r),Promise.resolve().then(n);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return a|=2,Promise.resolve(i).then(n,function(o){return e(o),n()})}else a|=1}catch(o){e(o)}if(a===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return n()}function Gb(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,a,n,i,o){return a?e?".jsx":".js":n&&(!i||!o)?r:n+i+"."+o.toLowerCase()+"js"}):t}const pA={__extends:bb,__assign:np,__rest:zh,__decorate:Sb,__param:Eb,__esDecorate:kb,__runInitializers:Ab,__propKey:Nb,__setFunctionName:Tb,__metadata:jb,__awaiter:Mt,__generator:Cb,__createBinding:Op,__exportStar:Ob,__values:ip,__read:Yv,__spread:Fb,__spreadArrays:Rb,__spreadArray:Lb,__await:Ph,__asyncGenerator:Db,__asyncDelegator:Pb,__asyncValues:Mb,__makeTemplateObject:Ib,__importStar:Bb,__importDefault:Ub,__classPrivateFieldGet:qb,__classPrivateFieldSet:zb,__classPrivateFieldIn:Hb,__addDisposableResource:Wb,__disposeResources:Vb,__rewriteRelativeImportExtension:Gb},mA=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Wb,get __assign(){return np},__asyncDelegator:Pb,__asyncGenerator:Db,__asyncValues:Mb,__await:Ph,__awaiter:Mt,__classPrivateFieldGet:qb,__classPrivateFieldIn:Hb,__classPrivateFieldSet:zb,__createBinding:Op,__decorate:Sb,__disposeResources:Vb,__esDecorate:kb,__exportStar:Ob,__extends:bb,__generator:Cb,__importDefault:Ub,__importStar:Bb,__makeTemplateObject:Ib,__metadata:jb,__param:Eb,__propKey:Nb,__read:Yv,__rest:zh,__rewriteRelativeImportExtension:Gb,__runInitializers:Ab,__setFunctionName:Tb,__spread:Fb,__spreadArray:Lb,__spreadArrays:Rb,__values:ip,default:pA},Symbol.toStringTag,{value:"Module"})),gA=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Fp extends Error{constructor(e,r="FunctionsError",a){super(e),this.name=r,this.context=a}}class $b extends Fp{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class sv extends Fp{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ov extends Fp{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var sp;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(sp||(sp={}));class vA{constructor(e,{headers:r={},customFetch:a,region:n=sp.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=gA(a)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Mt(this,arguments,void 0,function*(r,a={}){var n;let i,o;try{const{headers:c,method:u,body:h,signal:d,timeout:v}=a;let y={},{region:g}=a;g||(g=this.region);const b=new URL(`${this.url}/${r}`);g&&g!=="any"&&(y["x-region"]=g,b.searchParams.set("forceFunctionRegion",g));let w;h&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",w=h):typeof h=="string"?(y["Content-Type"]="text/plain",w=h):typeof FormData<"u"&&h instanceof FormData?w=h:(y["Content-Type"]="application/json",w=JSON.stringify(h)):w=h;let E=d;v&&(o=new AbortController,i=setTimeout(()=>o.abort(),v),d?(E=o.signal,d.addEventListener("abort",()=>o.abort())):E=o.signal);const A=yield this.fetch(b.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),c),body:w,signal:E}).catch(H=>{throw new $b(H)}),O=A.headers.get("x-relay-error");if(O&&O==="true")throw new sv(A);if(!A.ok)throw new ov(A);let T=((n=A.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),R;return T==="application/json"?R=yield A.json():T==="application/octet-stream"||T==="application/pdf"?R=yield A.blob():T==="text/event-stream"?R=A:T==="multipart/form-data"?R=yield A.formData():R=yield A.text(),{data:R,error:null,response:A}}catch(c){return{data:null,error:c,response:c instanceof ov||c instanceof sv?c.context:void 0}}finally{i&&clearTimeout(i)}})}}var yi={};const Hh=Qk(mA);var y1={},_1={},w1={},b1={},S1={},E1={},w_;function Xb(){if(w_)return E1;w_=1,Object.defineProperty(E1,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return E1.default=t,E1}var b_;function Yb(){if(b_)return S1;b_=1,Object.defineProperty(S1,"__esModule",{value:!0});const e=Hh.__importDefault(Xb());class r{constructor(n){var i,o;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(i=n.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=n.signal,this.isMaybeSingle=(o=n.isMaybeSingle)!==null&&o!==void 0?o:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,i){return this.headers=new Headers(this.headers),this.headers.set(n,i),this}then(n,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let c=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async u=>{var h,d,v,y;let g=null,b=null,w=null,E=u.status,A=u.statusText;if(u.ok){if(this.method!=="HEAD"){const H=await u.text();H===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((h=this.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?b=H:b=JSON.parse(H))}const T=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),R=(v=u.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");T&&R&&R.length>1&&(w=parseInt(R[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(g={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,w=null,E=406,A="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const T=await u.text();try{g=JSON.parse(T),Array.isArray(g)&&u.status===404&&(b=[],g=null,E=200,A="OK")}catch{u.status===404&&T===""?(E=204,A="No Content"):g={message:T}}if(g&&this.isMaybeSingle&&(!((y=g?.details)===null||y===void 0)&&y.includes("0 rows"))&&(g=null,E=200,A="OK"),g&&this.shouldThrowOnError)throw new e.default(g)}return{error:g,data:b,count:w,status:E,statusText:A}});return this.shouldThrowOnError||(c=c.catch(u=>{var h,d,v,y,g,b;let w="";const E=u?.cause;if(E){const A=(h=E?.message)!==null&&h!==void 0?h:"",O=(d=E?.code)!==null&&d!==void 0?d:"";w=`${(v=u?.name)!==null&&v!==void 0?v:"FetchError"}: ${u?.message}`,w+=`

Caused by: ${(y=E?.name)!==null&&y!==void 0?y:"Error"}: ${A}`,O&&(w+=` (${O})`),E?.stack&&(w+=`
${E.stack}`)}else w=(g=u?.stack)!==null&&g!==void 0?g:"";return{error:{message:`${(b=u?.name)!==null&&b!==void 0?b:"FetchError"}: ${u?.message}`,details:w,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),c.then(n,i)}returns(){return this}overrideTypes(){return this}}return S1.default=r,S1}var S_;function Kb(){if(S_)return b1;S_=1,Object.defineProperty(b1,"__esModule",{value:!0});const e=Hh.__importDefault(Yb());class r extends e.default{select(n){let i=!1;const o=(n??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:i=!0,nullsFirst:o,foreignTable:c,referencedTable:u=c}={}){const h=u?`${u}.order`:"order",d=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${d?`${d},`:""}${n}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:i,referencedTable:o=i}={}){const c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(c,`${n}`),this}range(n,i,{foreignTable:o,referencedTable:c=o}={}){const u=typeof c>"u"?"offset":`${c}.offset`,h=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(u,`${n}`),this.url.searchParams.set(h,`${i-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:i=!1,settings:o=!1,buffers:c=!1,wal:u=!1,format:h="text"}={}){var d;const v=[n?"analyze":null,i?"verbose":null,o?"settings":null,c?"buffers":null,u?"wal":null].filter(Boolean).join("|"),y=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${h}; for="${y}"; options=${v};`),h==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return b1.default=r,b1}var E_;function Kv(){if(E_)return w1;E_=1,Object.defineProperty(w1,"__esModule",{value:!0});const e=Hh.__importDefault(Kb()),r=new RegExp("[,()]");class a extends e.default{eq(i,o){return this.url.searchParams.append(i,`eq.${o}`),this}neq(i,o){return this.url.searchParams.append(i,`neq.${o}`),this}gt(i,o){return this.url.searchParams.append(i,`gt.${o}`),this}gte(i,o){return this.url.searchParams.append(i,`gte.${o}`),this}lt(i,o){return this.url.searchParams.append(i,`lt.${o}`),this}lte(i,o){return this.url.searchParams.append(i,`lte.${o}`),this}like(i,o){return this.url.searchParams.append(i,`like.${o}`),this}likeAllOf(i,o){return this.url.searchParams.append(i,`like(all).{${o.join(",")}}`),this}likeAnyOf(i,o){return this.url.searchParams.append(i,`like(any).{${o.join(",")}}`),this}ilike(i,o){return this.url.searchParams.append(i,`ilike.${o}`),this}ilikeAllOf(i,o){return this.url.searchParams.append(i,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(i,o){return this.url.searchParams.append(i,`ilike(any).{${o.join(",")}}`),this}regexMatch(i,o){return this.url.searchParams.append(i,`match.${o}`),this}regexIMatch(i,o){return this.url.searchParams.append(i,`imatch.${o}`),this}is(i,o){return this.url.searchParams.append(i,`is.${o}`),this}isDistinct(i,o){return this.url.searchParams.append(i,`isdistinct.${o}`),this}in(i,o){const c=Array.from(new Set(o)).map(u=>typeof u=="string"&&r.test(u)?`"${u}"`:`${u}`).join(",");return this.url.searchParams.append(i,`in.(${c})`),this}contains(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cs.{${o.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(o)}`),this}containedBy(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cd.{${o.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(o)}`),this}rangeGt(i,o){return this.url.searchParams.append(i,`sr.${o}`),this}rangeGte(i,o){return this.url.searchParams.append(i,`nxl.${o}`),this}rangeLt(i,o){return this.url.searchParams.append(i,`sl.${o}`),this}rangeLte(i,o){return this.url.searchParams.append(i,`nxr.${o}`),this}rangeAdjacent(i,o){return this.url.searchParams.append(i,`adj.${o}`),this}overlaps(i,o){return typeof o=="string"?this.url.searchParams.append(i,`ov.${o}`):this.url.searchParams.append(i,`ov.{${o.join(",")}}`),this}textSearch(i,o,{config:c,type:u}={}){let h="";u==="plain"?h="pl":u==="phrase"?h="ph":u==="websearch"&&(h="w");const d=c===void 0?"":`(${c})`;return this.url.searchParams.append(i,`${h}fts${d}.${o}`),this}match(i){return Object.entries(i).forEach(([o,c])=>{this.url.searchParams.append(o,`eq.${c}`)}),this}not(i,o,c){return this.url.searchParams.append(i,`not.${o}.${c}`),this}or(i,{foreignTable:o,referencedTable:c=o}={}){const u=c?`${c}.or`:"or";return this.url.searchParams.append(u,`(${i})`),this}filter(i,o,c){return this.url.searchParams.append(i,`${o}.${c}`),this}}return w1.default=a,w1}var k_;function Jb(){if(k_)return _1;k_=1,Object.defineProperty(_1,"__esModule",{value:!0});const e=Hh.__importDefault(Kv());class r{constructor(n,{headers:i={},schema:o,fetch:c}){this.url=n,this.headers=new Headers(i),this.schema=o,this.fetch=c}select(n,i){const{head:o=!1,count:c}=i??{},u=o?"HEAD":"GET";let h=!1;const d=(n??"*").split("").map(v=>/\s/.test(v)&&!h?"":(v==='"'&&(h=!h),v)).join("");return this.url.searchParams.set("select",d),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:i,defaultToNull:o=!0}={}){var c;const u="POST";if(i&&this.headers.append("Prefer",`count=${i}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const h=n.reduce((d,v)=>d.concat(Object.keys(v)),[]);if(h.length>0){const d=[...new Set(h)].map(v=>`"${v}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}upsert(n,{onConflict:i,ignoreDuplicates:o=!1,count:c,defaultToNull:u=!0}={}){var h;const d="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),c&&this.headers.append("Prefer",`count=${c}`),u||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const v=n.reduce((y,g)=>y.concat(Object.keys(g)),[]);if(v.length>0){const y=[...new Set(v)].map(g=>`"${g}"`);this.url.searchParams.set("columns",y.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}update(n,{count:i}={}){var o;const c="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:n}={}){var i;const o="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return _1.default=r,_1}var A_;function xA(){if(A_)return y1;A_=1,Object.defineProperty(y1,"__esModule",{value:!0});const t=Hh,e=t.__importDefault(Jb()),r=t.__importDefault(Kv());class a{constructor(i,{headers:o={},schema:c,fetch:u}={}){this.url=i,this.headers=new Headers(o),this.schemaName=c,this.fetch=u}from(i){if(!i||typeof i!="string"||i.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new a(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:c=!1,get:u=!1,count:h}={}){var d;let v;const y=new URL(`${this.url}/rpc/${i}`);let g;c||u?(v=c?"HEAD":"GET",Object.entries(o).filter(([w,E])=>E!==void 0).map(([w,E])=>[w,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([w,E])=>{y.searchParams.append(w,E)})):(v="POST",g=o);const b=new Headers(this.headers);return h&&b.set("Prefer",`count=${h}`),new r.default({method:v,url:y,headers:b,schema:this.schemaName,body:g,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return y1.default=a,y1}var N_;function yA(){if(N_)return yi;N_=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.PostgrestError=yi.PostgrestBuilder=yi.PostgrestTransformBuilder=yi.PostgrestFilterBuilder=yi.PostgrestQueryBuilder=yi.PostgrestClient=void 0;const t=Hh,e=t.__importDefault(xA());yi.PostgrestClient=e.default;const r=t.__importDefault(Jb());yi.PostgrestQueryBuilder=r.default;const a=t.__importDefault(Kv());yi.PostgrestFilterBuilder=a.default;const n=t.__importDefault(Kb());yi.PostgrestTransformBuilder=n.default;const i=t.__importDefault(Yb());yi.PostgrestBuilder=i.default;const o=t.__importDefault(Xb());return yi.PostgrestError=o.default,yi.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:i.default,PostgrestError:o.default},yi}var Zb=yA();const Qb=$v(Zb),_A=Zk({__proto__:null,default:Qb},[Zb]),{PostgrestClient:wA,PostgrestQueryBuilder:UU,PostgrestFilterBuilder:qU,PostgrestTransformBuilder:zU,PostgrestBuilder:HU,PostgrestError:bA}=Qb||_A;class e4{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,n=parseInt(a.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const a=this.getWebSocketConstructor();return new a(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const SA="2.87.3",EA=`realtime-js/${SA}`,t4="1.0.0",kA="2.0.0",T_=t4,lv=1e4,AA=1e3,NA=100;var zu;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(zu||(zu={}));var Nn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Nn||(Nn={}));var Bo;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Bo||(Bo={}));var cv;(function(t){t.websocket="websocket"})(cv||(cv={}));var Hu;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Hu||(Hu={}));class TA{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let a=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,a;const n=(a=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var r,a;const n=(a=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},o=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,r,a){var n,i;const o=e.topic,c=(n=e.ref)!==null&&n!==void 0?n:"",u=(i=e.join_ref)!==null&&i!==void 0?i:"",h=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},v=Object.keys(d).length===0?"":JSON.stringify(d);if(u.length>255)throw new Error(`joinRef length ${u.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`userEvent length ${h.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`metadata length ${v.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+c.length+o.length+h.length+v.length,g=new ArrayBuffer(this.HEADER_LENGTH+y);let b=new DataView(g),w=0;b.setUint8(w++,this.KINDS.userBroadcastPush),b.setUint8(w++,u.length),b.setUint8(w++,c.length),b.setUint8(w++,o.length),b.setUint8(w++,h.length),b.setUint8(w++,v.length),b.setUint8(w++,r),Array.from(u,A=>b.setUint8(w++,A.charCodeAt(0))),Array.from(c,A=>b.setUint8(w++,A.charCodeAt(0))),Array.from(o,A=>b.setUint8(w++,A.charCodeAt(0))),Array.from(h,A=>b.setUint8(w++,A.charCodeAt(0))),Array.from(v,A=>b.setUint8(w++,A.charCodeAt(0)));var E=new Uint8Array(g.byteLength+a.byteLength);return E.set(new Uint8Array(g),0),E.set(new Uint8Array(a),g.byteLength),E.buffer}decode(e,r){if(this._isArrayBuffer(e)){let a=this._binaryDecode(e);return r(a)}if(typeof e=="string"){const a=JSON.parse(e),[n,i,o,c,u]=a;return r({join_ref:n,ref:i,topic:o,event:c,payload:u})}return r({})}_binaryDecode(e){const r=new DataView(e),a=r.getUint8(0),n=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,n)}}_decodeUserBroadcast(e,r,a){const n=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),c=r.getUint8(4);let u=this.HEADER_LENGTH+4;const h=a.decode(e.slice(u,u+n));u=u+n;const d=a.decode(e.slice(u,u+i));u=u+i;const v=a.decode(e.slice(u,u+o));u=u+o;const y=e.slice(u,e.byteLength),g=c===this.JSON_ENCODING?JSON.parse(a.decode(y)):y,b={type:this.BROADCAST_EVENT,event:d,payload:g};return o>0&&(b.meta=JSON.parse(v)),{join_ref:null,ref:null,topic:h,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([a])=>r.includes(a)))}}class r4{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ea;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ea||(Ea={}));const j_=(t,e,r={})=>{var a;const n=(a=r.skipTypes)!==null&&a!==void 0?a:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=jA(o,t,e,n),i),{}):{}},jA=(t,e,r,a)=>{const n=e.find(c=>c.name===t),i=n?.type,o=r[t];return i&&!a.includes(i)?a4(i,o):uv(o)},a4=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return RA(e,r)}switch(t){case Ea.bool:return CA(e);case Ea.float4:case Ea.float8:case Ea.int2:case Ea.int4:case Ea.int8:case Ea.numeric:case Ea.oid:return OA(e);case Ea.json:case Ea.jsonb:return FA(e);case Ea.timestamp:return LA(e);case Ea.abstime:case Ea.date:case Ea.daterange:case Ea.int4range:case Ea.int8range:case Ea.money:case Ea.reltime:case Ea.text:case Ea.time:case Ea.timestamptz:case Ea.timetz:case Ea.tsrange:case Ea.tstzrange:return uv(e);default:return uv(e)}},uv=t=>t,CA=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},OA=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},FA=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},RA=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,a=t[r];if(t[0]==="{"&&a==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(c=>a4(e,c))}return t},LA=t=>typeof t=="string"?t.replace(" ","T"):t,n4=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class ug{constructor(e,r,a={},n=lv){this.channel=e,this.event=r,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var a;return this._hasReceived(e)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(a=>a.status===e).forEach(a=>a.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var fv;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(fv||(fv={}));class Eh{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Eh.syncState(this.state,n,i,o),this.pendingDiffs.forEach(u=>{this.state=Eh.syncDiff(this.state,u,i,o)}),this.pendingDiffs=[],c()}),this.channel._on(a.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Eh.syncDiff(this.state,n,i,o),c())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,a,n){const i=this.cloneDeep(e),o=this.transformState(r),c={},u={};return this.map(i,(h,d)=>{o[h]||(u[h]=d)}),this.map(o,(h,d)=>{const v=i[h];if(v){const y=d.map(E=>E.presence_ref),g=v.map(E=>E.presence_ref),b=d.filter(E=>g.indexOf(E.presence_ref)<0),w=v.filter(E=>y.indexOf(E.presence_ref)<0);b.length>0&&(c[h]=b),w.length>0&&(u[h]=w)}else c[h]=d}),this.syncDiff(i,{joins:c,leaves:u},a,n)}static syncDiff(e,r,a,n){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(i,(c,u)=>{var h;const d=(h=e[c])!==null&&h!==void 0?h:[];if(e[c]=this.cloneDeep(u),d.length>0){const v=e[c].map(g=>g.presence_ref),y=d.filter(g=>v.indexOf(g.presence_ref)<0);e[c].unshift(...y)}a(c,d,u)}),this.map(o,(c,u)=>{let h=e[c];if(!h)return;const d=u.map(v=>v.presence_ref);h=h.filter(v=>d.indexOf(v.presence_ref)<0),e[c]=h,n(c,h,u),h.length===0&&delete e[c]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(a=>r(a,e[a]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,a)=>{const n=e[a];return"metas"in n?r[a]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[a]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var hv;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(hv||(hv={}));var kh;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(kh||(kh={}));var vl;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(vl||(vl={}));const DA=Nn;class Gu{constructor(e,r={config:{}},a){var n,i;if(this.topic=e,this.params=r,this.socket=a,this.bindings={},this.state=Nn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new ug(this,Bo.join,this.params,this.timeout),this.rejoinTimer=new r4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Nn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Nn.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Nn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Nn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Nn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Bo.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new Eh(this),this.broadcastEndpointURL=n4(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var a,n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Nn.closed){const{config:{broadcast:o,presence:c,private:u}}=this.params,h=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(g=>g.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[kh.PRESENCE]&&this.bindings[kh.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,v={},y={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:d}),postgres_changes:h,private:u};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(g=>e?.(vl.CHANNEL_ERROR,g)),this._onClose(()=>e?.(vl.CLOSED)),this.updateJoinPayload(Object.assign({config:y},v)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:g})=>{var b;if(this.socket._isManualToken()||this.socket.setAuth(),g===void 0){e?.(vl.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,E=(b=w?.length)!==null&&b!==void 0?b:0,A=[];for(let O=0;O<E;O++){const T=w[O],{filter:{event:R,schema:H,table:z,filter:F}}=T,W=g&&g[O];if(W&&W.event===R&&Gu.isFilterValueEqual(W.schema,H)&&Gu.isFilterValueEqual(W.table,z)&&Gu.isFilterValueEqual(W.filter,F))A.push(Object.assign(Object.assign({},T),{id:W.id}));else{this.unsubscribe(),this.state=Nn.errored,e?.(vl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,e&&e(vl.SUBSCRIBED);return}}).receive("error",g=>{this.state=Nn.errored,e?.(vl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e?.(vl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,a){return this.state===Nn.joined&&e===kh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,a)}async httpSend(e,r,a={}){var n;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(n=a.timeout)!==null&&n!==void 0?n:this.timeout);if(c.status===202)return{success:!0};let u=c.statusText;try{const h=await c.json();u=h.error||h.message||u}catch{}return Promise.reject(new Error(u))}async send(e,r={}){var a,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=h.body)===null||n===void 0?void 0:n.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,c,u;const h=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),h.receive("ok",()=>i("ok")),h.receive("error",()=>i("error")),h.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Nn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Bo.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new ug(this,Bo.leave,{},e),a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Nn.closed,this.bindings={}}async _fetchWithTimeout(e,r,a){const n=new AbortController,i=setTimeout(()=>n.abort(),a),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),o}_push(e,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new ug(this,e,r,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>NA){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,a){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,a){var n,i;const o=e.toLocaleLowerCase(),{close:c,error:u,leave:h,join:d}=Bo;if(a&&[c,u,h,d].indexOf(o)>=0&&a!==this._joinRef())return;let y=this._onMessage(o,r,a);if(r&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(g=>{var b,w,E;return((b=g.filter)===null||b===void 0?void 0:b.event)==="*"||((E=(w=g.filter)===null||w===void 0?void 0:w.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===o}).map(g=>g.callback(y,a)):(i=this.bindings[o])===null||i===void 0||i.filter(g=>{var b,w,E,A,O,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in g){const R=g.id,H=(b=g.filter)===null||b===void 0?void 0:b.event;return R&&((w=r.ids)===null||w===void 0?void 0:w.includes(R))&&(H==="*"||H?.toLocaleLowerCase()===((E=r.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const R=(O=(A=g?.filter)===null||A===void 0?void 0:A.event)===null||O===void 0?void 0:O.toLocaleLowerCase();return R==="*"||R===((T=r?.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===o}).map(g=>{if(typeof y=="object"&&"ids"in y){const b=y.data,{schema:w,table:E,commit_timestamp:A,type:O,errors:T}=b;y=Object.assign(Object.assign({},{schema:w,table:E,commit_timestamp:A,eventType:O,new:{},old:{},errors:T}),this._getPayloadRecords(b))}g.callback(y,a)})}_isClosed(){return this.state===Nn.closed}_isJoined(){return this.state===Nn.joined}_isJoining(){return this.state===Nn.joining}_isLeaving(){return this.state===Nn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,a){const n=e.toLocaleLowerCase(),i={type:n,filter:r,callback:a};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,r){const a=e.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===a&&Gu.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const a in e)if(e[a]!==r[a])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Bo.close,{},e)}_onError(e){this._on(Bo.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Nn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=j_(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=j_(e.columns,e.old_record)),r}}const fg=()=>{},k1={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},PA=[1e3,2e3,5e3,1e4],MA=1e4,IA=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class i4{constructor(e,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=lv,this.transport=null,this.heartbeatIntervalMs=k1.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=fg,this.ref=0,this.reconnectTimer=null,this.vsn=T_,this.logger=fg,this.conn=null,this.sendBuffer=[],this.serializer=new TA,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...i)=>n(...i):(...i)=>fetch(...i),!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${cv.websocket}`,this.httpEndpoint=n4(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=e4.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,a){this.logger(e,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case zu.connecting:return Hu.Connecting;case zu.open:return Hu.Open;case zu.closing:return Hu.Closing;default:return Hu.Closed}}isConnected(){return this.connectionState()===Hu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const a=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===a);if(n)return n;{const i=new Gu(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:a,payload:n,ref:i}=e,o=()=>{this.encode(e,c=>{var u;(u=this.conn)===null||u===void 0||u.send(c)})};this.log("push",`${r} ${a} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(AA,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},k1.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(a=>a.topic===e&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(h){this.log("error","error in heartbeat callback",h)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:n,payload:i,ref:o}=r,c=o?`(${o})`:"",u=i.status||"";this.log("receive",`${u} ${a} ${n} ${c}`.trim(),i),this.channels.filter(h=>h._isMember(a)).forEach(h=>h._trigger(n,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===zu.open||this.conn.readyState===zu.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Bo.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const a=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${a}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const a=new Blob([IA],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,a=!1;if(e)r=e,a=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),r=this.accessTokenValue}else r=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:EA};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Bo.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(a=>{try{a(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(a){this.log("error",`error triggering ${e} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new r4(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},k1.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,a,n,i,o,c,u,h,d,v,y,g;switch(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=e?.timeout)!==null&&a!==void 0?a:lv,this.heartbeatIntervalMs=(n=e?.heartbeatIntervalMs)!==null&&n!==void 0?n:k1.HEARTBEAT_INTERVAL,this.worker=(i=e?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=e?.heartbeatCallback)!==null&&c!==void 0?c:fg,this.vsn=(u=e?.vsn)!==null&&u!==void 0?u:T_,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e?.reconnectAfterMs)!==null&&h!==void 0?h:(b=>PA[b-1]||MA),this.vsn){case t4:this.encode=(d=e?.encode)!==null&&d!==void 0?d:((b,w)=>w(JSON.stringify(b))),this.decode=(v=e?.decode)!==null&&v!==void 0?v:((b,w)=>w(JSON.parse(b)));break;case kA:this.encode=(y=e?.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(g=e?.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class Rp extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function $a(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class BA extends Rp{constructor(e,r,a){super(e),this.name="StorageApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class dv extends Rp{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const Jv=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),UA=()=>Response,pv=t=>{if(Array.isArray(t))return t.map(r=>pv(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,a])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=pv(a)}),e},qA=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},zA=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t),hg=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},HA=(t,e,r)=>Mt(void 0,void 0,void 0,function*(){const a=yield UA();t instanceof a&&!r?.noResolveJson?t.json().then(n=>{const i=t.status||500,o=n?.statusCode||i+"";e(new BA(hg(n),i,o))}).catch(n=>{e(new dv(hg(n),n))}):e(new dv(hg(t),t))}),WA=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"||!a?n:(qA(a)?(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(a)):n.body=a,e?.duplex&&(n.duplex=e.duplex),Object.assign(Object.assign({},n),r))};function vd(t,e,r,a,n,i){return Mt(this,void 0,void 0,function*(){return new Promise((o,c)=>{t(r,WA(e,a,n,i)).then(u=>{if(!u.ok)throw u;return a?.noResolveJson?u:u.json()}).then(u=>o(u)).catch(u=>HA(u,c,a))})})}function Q0(t,e,r,a){return Mt(this,void 0,void 0,function*(){return vd(t,"GET",e,r,a)})}function Io(t,e,r,a,n){return Mt(this,void 0,void 0,function*(){return vd(t,"POST",e,a,n,r)})}function mv(t,e,r,a,n){return Mt(this,void 0,void 0,function*(){return vd(t,"PUT",e,a,n,r)})}function VA(t,e,r,a){return Mt(this,void 0,void 0,function*(){return vd(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}function Zv(t,e,r,a,n){return Mt(this,void 0,void 0,function*(){return vd(t,"DELETE",e,a,n,r)})}class GA{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return Mt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if($a(e))return{data:null,error:e};throw e}})}}var s4;class $A{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[s4]="BlobDownloadBuilder",this.promise=null}asStream(){return new GA(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Mt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if($a(e))return{data:null,error:e};throw e}})}}s4=Symbol.toStringTag;const XA={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},C_={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class YA{constructor(e,r={},a,n){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=a,this.fetch=Jv(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,a,n){return Mt(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},C_),n);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const u=o.metadata;typeof Blob<"u"&&a instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),u&&i.append("metadata",this.encodeMetadata(u)),i.append("",a)):typeof FormData<"u"&&a instanceof FormData?(i=a,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),u&&!i.has("metadata")&&i.append("metadata",this.encodeMetadata(u))):(i=a,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,u&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(u))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),n?.headers&&(c=Object.assign(Object.assign({},c),n.headers));const h=this._removeEmptyFolders(r),d=this._getFinalPath(h),v=yield(e=="PUT"?mv:Io)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:c},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:h,id:v.Id,fullPath:v.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if($a(i))return{data:null,error:i};throw i}})}upload(e,r,a){return Mt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,a)})}uploadToSignedUrl(e,r,a,n){return Mt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),c=new URL(this.url+`/object/upload/sign/${o}`);c.searchParams.set("token",r);try{let u;const h=Object.assign({upsert:C_.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&a instanceof Blob?(u=new FormData,u.append("cacheControl",h.cacheControl),u.append("",a)):typeof FormData<"u"&&a instanceof FormData?(u=a,u.append("cacheControl",h.cacheControl)):(u=a,d["cache-control"]=`max-age=${h.cacheControl}`,d["content-type"]=h.contentType);const v=yield mv(this.fetch,c.toString(),u,{headers:d});return{data:{path:i,fullPath:v.Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if($a(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,r){return Mt(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e);const n=Object.assign({},this.headers);r?.upsert&&(n["x-upsert"]="true");const i=yield Io(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:n}),o=new URL(this.url+i.url),c=o.searchParams.get("token");if(!c)throw new Rp("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:c},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if($a(a))return{data:null,error:a};throw a}})}update(e,r,a){return Mt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,a)})}move(e,r,a){return Mt(this,void 0,void 0,function*(){try{return{data:yield Io(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($a(n))return{data:null,error:n};throw n}})}copy(e,r,a){return Mt(this,void 0,void 0,function*(){try{return{data:{path:(yield Io(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($a(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,a){return Mt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield Io(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},a?.transform?{transform:a.transform}:{}),{headers:this.headers});const o=a?.download?`&download=${a.download===!0?"":a.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($a(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,a){return Mt(this,void 0,void 0,function*(){try{const n=yield Io(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=a?.download?`&download=${a.download===!0?"":a.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($a(n))return{data:null,error:n};throw n}})}download(e,r){const n=typeof r?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(r?.transform||{}),o=i?`?${i}`:"",c=this._getFinalPath(e),u=()=>Q0(this.fetch,`${this.url}/${n}/${c}${o}`,{headers:this.headers,noResolveJson:!0});return new $A(u,this.shouldThrowOnError)}info(e){return Mt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const a=yield Q0(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:pv(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if($a(a))return{data:null,error:a};throw a}})}exists(e){return Mt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield VA(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if($a(a)&&a instanceof dv){const n=a.originalError;if([400,404].includes(n?.status))return{data:!1,error:a}}throw a}})}getPublicUrl(e,r){const a=this._getFinalPath(e),n=[],i=r?.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&n.push(i);const c=typeof r?.transform<"u"?"render/image":"object",u=this.transformOptsToQueryString(r?.transform||{});u!==""&&n.push(u);let h=n.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${a}${h}`)}}}remove(e){return Mt(this,void 0,void 0,function*(){try{return{data:yield Zv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($a(r))return{data:null,error:r};throw r}})}list(e,r,a){return Mt(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},XA),r),{prefix:e||""});return{data:yield Io(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},a),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($a(n))return{data:null,error:n};throw n}})}listV2(e,r){return Mt(this,void 0,void 0,function*(){try{const a=Object.assign({},e);return{data:yield Io(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if($a(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const o4="2.87.3",l4={"X-Client-Info":`storage-js/${o4}`};class KA{constructor(e,r={},a,n){this.shouldThrowOnError=!1;const i=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},l4),r),this.fetch=Jv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return Mt(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield Q0(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($a(r))return{data:null,error:r};throw r}})}getBucket(e){return Mt(this,void 0,void 0,function*(){try{return{data:yield Q0(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($a(r))return{data:null,error:r};throw r}})}createBucket(e){return Mt(this,arguments,void 0,function*(r,a={public:!1}){try{return{data:yield Io(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($a(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return Mt(this,void 0,void 0,function*(){try{return{data:yield mv(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if($a(a))return{data:null,error:a};throw a}})}emptyBucket(e){return Mt(this,void 0,void 0,function*(){try{return{data:yield Io(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($a(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Mt(this,void 0,void 0,function*(){try{return{data:yield Zv(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($a(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}var ed=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function JA(t,e,r){const a=new URL(e,t);if(r)for(const[n,i]of Object.entries(r))i!==void 0&&a.searchParams.set(n,i);return a.toString()}async function ZA(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function QA(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:n,body:i,headers:o}){const c=JA(t.baseUrl,a,n),u=await ZA(t.auth),h=await e(c,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...u,...o},body:i?JSON.stringify(i):void 0}),d=await h.text(),v=(h.headers.get("content-type")||"").includes("application/json"),y=v&&d?JSON.parse(d):d;if(!h.ok){const g=v?y:void 0,b=g?.error;throw new ed(b?.message??`Request failed with status ${h.status}`,{status:h.status,icebergType:b?.type,icebergCode:b?.code,details:g})}return{status:h.status,headers:h.headers,data:y}}}}function A1(t){return t.join("")}var e6=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:A1(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${A1(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${A1(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${A1(t.namespace)}`}),!0}catch(e){if(e instanceof ed&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof ed&&r.status===409)return;throw r}}};function oh(t){return t.join("")}var t6=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${oh(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${oh(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${oh(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${oh(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${oh(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${oh(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof ed&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof ed&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},r6=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=QA({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new e6(this.client,e),this.tableOps=new t6(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}};class a6{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},l4),r),this.fetch=Jv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Mt(this,void 0,void 0,function*(){try{return{data:yield Io(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($a(r))return{data:null,error:r};throw r}})}listBuckets(e){return Mt(this,void 0,void 0,function*(){try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const a=r.toString(),n=a?`${this.url}/bucket?${a}`:`${this.url}/bucket`;return{data:yield Q0(this.fetch,n,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($a(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Mt(this,void 0,void 0,function*(){try{return{data:yield Zv(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($a(r))return{data:null,error:r};throw r}})}from(e){if(!zA(e))throw new Rp("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new r6({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>Mt(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(i,o){const c=i[o];return typeof c!="function"?c:(...u)=>Mt(this,void 0,void 0,function*(){try{return{data:yield c.apply(i,u),error:null}}catch(h){if(a)throw h;return{data:null,error:h}}})}})}}const Qv={"X-Client-Info":`storage-js/${o4}`,"Content-Type":"application/json"};class c4 extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function js(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class dg extends c4{constructor(e,r,a){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class n6 extends c4{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var O_;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(O_||(O_={}));const e2=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),i6=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},F_=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),s6=(t,e,r)=>Mt(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!r?.noResolveJson){const n=t.status||500,i=t;if(typeof i.json=="function")i.json().then(o=>{const c=o?.statusCode||o?.code||n+"";e(new dg(F_(o),n,c))}).catch(()=>{const o=n+"",c=i.statusText||`HTTP ${n} error`;e(new dg(c,n,o))});else{const o=n+"",c=i.statusText||`HTTP ${n} error`;e(new dg(c,n,o))}}else e(new n6(F_(t),t))}),o6=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return a?(i6(a)?(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(a)):n.body=a,Object.assign(Object.assign({},n),r)):n};function l6(t,e,r,a,n,i){return Mt(this,void 0,void 0,function*(){return new Promise((o,c)=>{t(r,o6(e,a,n,i)).then(u=>{if(!u.ok)throw u;if(a?.noResolveJson)return u;const h=u.headers.get("content-type");return!h||!h.includes("application/json")?{}:u.json()}).then(u=>o(u)).catch(u=>s6(u,c,a))})})}function Cs(t,e,r,a,n){return Mt(this,void 0,void 0,function*(){return l6(t,"POST",e,a,n,r)})}class c6{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Qv),r),this.fetch=e2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return Mt(this,void 0,void 0,function*(){try{return{data:(yield Cs(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(js(r))return{data:null,error:r};throw r}})}getIndex(e,r){return Mt(this,void 0,void 0,function*(){try{return{data:yield Cs(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(js(a))return{data:null,error:a};throw a}})}listIndexes(e){return Mt(this,void 0,void 0,function*(){try{return{data:yield Cs(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(js(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return Mt(this,void 0,void 0,function*(){try{return{data:(yield Cs(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(js(a))return{data:null,error:a};throw a}})}}class u6{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Qv),r),this.fetch=e2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return Mt(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Cs(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(js(r))return{data:null,error:r};throw r}})}getVectors(e){return Mt(this,void 0,void 0,function*(){try{return{data:yield Cs(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(js(r))return{data:null,error:r};throw r}})}listVectors(e){return Mt(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Cs(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(js(r))return{data:null,error:r};throw r}})}queryVectors(e){return Mt(this,void 0,void 0,function*(){try{return{data:yield Cs(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(js(r))return{data:null,error:r};throw r}})}deleteVectors(e){return Mt(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Cs(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(js(r))return{data:null,error:r};throw r}})}}class f6{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Qv),r),this.fetch=e2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Mt(this,void 0,void 0,function*(){try{return{data:(yield Cs(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(js(r))return{data:null,error:r};throw r}})}getBucket(e){return Mt(this,void 0,void 0,function*(){try{return{data:yield Cs(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(js(r))return{data:null,error:r};throw r}})}listBuckets(){return Mt(this,arguments,void 0,function*(e={}){try{return{data:yield Cs(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(js(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Mt(this,void 0,void 0,function*(){try{return{data:(yield Cs(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(js(r))return{data:null,error:r};throw r}})}}class h6 extends f6{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new d6(this.url,this.headers,e,this.fetch)}createBucket(e){const r=Object.create(null,{createBucket:{get:()=>super.createBucket}});return Mt(this,void 0,void 0,function*(){return r.createBucket.call(this,e)})}getBucket(e){const r=Object.create(null,{getBucket:{get:()=>super.getBucket}});return Mt(this,void 0,void 0,function*(){return r.getBucket.call(this,e)})}listBuckets(){const e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return Mt(this,arguments,void 0,function*(r={}){return e.listBuckets.call(this,r)})}deleteBucket(e){const r=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return Mt(this,void 0,void 0,function*(){return r.deleteBucket.call(this,e)})}}class d6 extends c6{constructor(e,r,a,n){super(e,r,n),this.vectorBucketName=a}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Mt(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Mt(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Mt(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Mt(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new p6(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class p6 extends u6{constructor(e,r,a,n,i){super(e,r,i),this.vectorBucketName=a,this.indexName=n}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Mt(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Mt(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Mt(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Mt(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Mt(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class m6 extends KA{constructor(e,r={},a,n){super(e,r,a,n)}from(e){return new YA(this.url,this.headers,e,this.fetch)}get vectors(){return new h6(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new a6(this.url+"/iceberg",this.headers,this.fetch)}}const g6="2.87.3";let P0="";typeof Deno<"u"?P0="deno":typeof document<"u"?P0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?P0="react-native":P0="node";const v6={"X-Client-Info":`supabase-js-${P0}/${g6}`},x6={headers:v6},y6={schema:"public"},_6={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},w6={},b6=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),S6=()=>Headers,E6=(t,e,r)=>{const a=b6(r),n=S6();return async(i,o)=>{var c;const u=(c=await e())!==null&&c!==void 0?c:t;let h=new n(o?.headers);return h.has("apikey")||h.set("apikey",t),h.has("Authorization")||h.set("Authorization",`Bearer ${u}`),a(i,Object.assign(Object.assign({},o),{headers:h}))}};function k6(t){return t.endsWith("/")?t:t+"/"}function A6(t,e){var r,a;const{db:n,auth:i,realtime:o,global:c}=t,{db:u,auth:h,realtime:d,global:v}=e,y={db:Object.assign(Object.assign({},u),n),auth:Object.assign(Object.assign({},h),i),realtime:Object.assign(Object.assign({},d),o),storage:{},global:Object.assign(Object.assign(Object.assign({},v),c),{headers:Object.assign(Object.assign({},(r=v?.headers)!==null&&r!==void 0?r:{}),(a=c?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return t.accessToken?y.accessToken=t.accessToken:delete y.accessToken,y}function N6(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(k6(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const u4="2.87.3",vh=30*1e3,gv=3,pg=gv*vh,T6="http://localhost:9999",j6="supabase.auth.token",C6={"X-Client-Info":`gotrue-js/${u4}`},vv="X-Supabase-Api-Version",f4={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},O6=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,F6=600*1e3;class Mh extends Error{constructor(e,r,a){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function Xt(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class h4 extends Mh{constructor(e,r,a){super(e,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function d4(t){return Xt(t)&&t.name==="AuthApiError"}class Xc extends Mh{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class _l extends Mh{constructor(e,r,a,n){super(e,a,n),this.name=r,this.status=a}}class ss extends _l{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function p4(t){return Xt(t)&&t.name==="AuthSessionMissingError"}class Iu extends _l{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class M0 extends _l{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class I0 extends _l{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function m4(t){return Xt(t)&&t.name==="AuthImplicitGrantRedirectError"}class xv extends _l{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class g4 extends _l{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}function R6(t){return Xt(t)&&t.name==="AuthPKCECodeVerifierMissingError"}class op extends _l{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function K1(t){return Xt(t)&&t.name==="AuthRetryableFetchError"}class yv extends _l{constructor(e,r,a){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}function L6(t){return Xt(t)&&t.name==="AuthWeakPasswordError"}class lp extends _l{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const cp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),R_=` 	
\r=`.split(""),D6=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<R_.length;e+=1)t[R_[e].charCodeAt(0)]=-2;for(let e=0;e<cp.length;e+=1)t[cp[e].charCodeAt(0)]=e;return t})();function L_(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;r(cp[a]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;r(cp[a]),e.queuedBits-=6}}function v4(t,e,r){const a=D6[t];if(a>-1)for(e.queue=e.queue<<6|a,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function D_(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{I6(o,a,r)};for(let o=0;o<t.length;o+=1)v4(t.charCodeAt(o),n,i);return e.join("")}function P6(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function M6(t,e){for(let r=0;r<t.length;r+=1){let a=t.charCodeAt(r);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}P6(a,e)}}function I6(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let a=1;a<6;a+=1)if((t>>7-a&1)===0){e.utf8seq=a;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Ah(t){const e=[],r={queue:0,queuedBits:0},a=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)v4(t.charCodeAt(n),r,a);return new Uint8Array(e)}function B6(t){const e=[];return M6(t,r=>e.push(r)),new Uint8Array(e)}function $u(t){const e=[],r={queue:0,queuedBits:0},a=n=>{e.push(n)};return t.forEach(n=>L_(n,r,a)),L_(null,r,a),e.join("")}function U6(t){return Math.round(Date.now()/1e3)+t}function q6(){return Symbol("auth-callback")}const fi=()=>typeof window<"u"&&typeof document<"u",Pu={tested:!1,writable:!1},x4=()=>{if(!fi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Pu.tested)return Pu.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Pu.tested=!0,Pu.writable=!0}catch{Pu.tested=!0,Pu.writable=!1}return Pu.writable};function z6(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return r.searchParams.forEach((a,n)=>{e[n]=a}),e}const y4=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),H6=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",xh=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Mu=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ui=async(t,e)=>{await t.removeItem(e)};class Lp{constructor(){this.promise=new Lp.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Lp.promiseConstructor=Promise;function mg(t){const e=t.split(".");if(e.length!==3)throw new lp("Invalid JWT structure");for(let a=0;a<e.length;a++)if(!O6.test(e[a]))throw new lp("JWT not in base64url format");return{header:JSON.parse(D_(e[0])),payload:JSON.parse(D_(e[1])),signature:Ah(e[2]),raw:{header:e[0],payload:e[1]}}}async function W6(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function V6(t,e){return new Promise((a,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){a(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function G6(t){return("0"+t.toString(16)).substr(-2)}function $6(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(e),Array.from(e,G6).join("")}async function X6(t){const r=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(a);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function Y6(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await X6(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function lh(t,e,r=!1){const a=$6();let n=a;r&&(n+="/PASSWORD_RECOVERY"),await xh(t,`${e}-code-verifier`,n);const i=await Y6(a);return[i,a===i?"plain":"s256"]}const K6=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function J6(t){const e=t.headers.get(vv);if(!e||!e.match(K6))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Z6(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Q6(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const eN=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ch(t){if(!eN.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function gg(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function tN(t,e){return new Proxy(t,{get:(r,a,n)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const i=a.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,n)}return!e.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,a,n)}})}function P_(t){return JSON.parse(JSON.stringify(t))}const Bu=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),rN=[502,503,504];async function M_(t){var e;if(!H6(t))throw new op(Bu(t),0);if(rN.includes(t.status))throw new op(Bu(t),t.status);let r;try{r=await t.json()}catch(i){throw new Xc(Bu(i),i)}let a;const n=J6(t);if(n&&n.getTime()>=f4["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new yv(Bu(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(a==="session_not_found")throw new ss}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new yv(Bu(r),t.status,r.weak_password.reasons);throw new h4(Bu(r),t.status||500,a)}const aN=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),r))};async function ur(t,e,r,a){var n;const i=Object.assign({},a?.headers);i[vv]||(i[vv]=f4["2024-01-01"].name),a?.jwt&&(i.Authorization=`Bearer ${a.jwt}`);const o=(n=a?.query)!==null&&n!==void 0?n:{};a?.redirectTo&&(o.redirect_to=a.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",u=await nN(t,e,r+c,{headers:i,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(u):{data:Object.assign({},u),error:null}}async function nN(t,e,r,a,n,i){const o=aN(e,a,n,i);let c;try{c=await t(r,Object.assign({},o))}catch(u){throw console.error(u),new op(Bu(u),0)}if(c.ok||await M_(c),a?.noResolveJson)return c;try{return await c.json()}catch(u){await M_(u)}}function Mo(t){var e;let r=null;oN(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=U6(t.expires_in)));const a=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:a},error:null}}function I_(t){const e=Mo(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Yc(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function iN(t){return{data:t,error:null}}function sN(t){const{action_link:e,email_otp:r,hashed_token:a,redirect_to:n,verification_type:i}=t,o=zh(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:r,hashed_token:a,redirect_to:n,verification_type:i},u=Object.assign({},o);return{data:{properties:c,user:u},error:null}}function B_(t){return t}function oN(t){return t.access_token&&t.refresh_token&&t.expires_in}const J1=["global","local","others"];class t2{constructor({url:e="",headers:r={},fetch:a}){this.url=e,this.headers=r,this.fetch=y4(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=J1[0]){if(J1.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${J1.join(", ")}`);try{return await ur(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(a){if(Xt(a))return{data:null,error:a};throw a}}async inviteUserByEmail(e,r={}){try{return await ur(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Yc})}catch(a){if(Xt(a))return{data:{user:null},error:a};throw a}}async generateLink(e){try{const{options:r}=e,a=zh(e,["options"]),n=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(n.new_email=a?.newEmail,delete n.newEmail),await ur(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:sN,redirectTo:r?.redirectTo})}catch(r){if(Xt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await ur(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Yc})}catch(r){if(Xt(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,a,n,i,o,c,u;try{const h={nextPage:null,lastPage:0,total:0},d=await ur(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:B_});if(d.error)throw d.error;const v=await d.json(),y=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,g=(u=(c=d.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&u!==void 0?u:[];return g.length>0&&(g.forEach(b=>{const w=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(b.split(";")[1].split("=")[1]);h[`${E}Page`]=w}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},v),h),error:null}}catch(h){if(Xt(h))return{data:{users:[]},error:h};throw h}}async getUserById(e){ch(e);try{return await ur(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Yc})}catch(r){if(Xt(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){ch(e);try{return await ur(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Yc})}catch(a){if(Xt(a))return{data:{user:null},error:a};throw a}}async deleteUser(e,r=!1){ch(e);try{return await ur(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Yc})}catch(a){if(Xt(a))return{data:{user:null},error:a};throw a}}async _listFactors(e){ch(e.userId);try{const{data:r,error:a}=await ur(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:a}}catch(r){if(Xt(r))return{data:null,error:r};throw r}}async _deleteFactor(e){ch(e.userId),ch(e.id);try{return{data:await ur(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(Xt(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,a,n,i,o,c,u;try{const h={nextPage:null,lastPage:0,total:0},d=await ur(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:B_});if(d.error)throw d.error;const v=await d.json(),y=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,g=(u=(c=d.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&u!==void 0?u:[];return g.length>0&&(g.forEach(b=>{const w=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(b.split(";")[1].split("=")[1]);h[`${E}Page`]=w}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},v),h),error:null}}catch(h){if(Xt(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(e){try{return await ur(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Xt(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await ur(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Xt(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await ur(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Xt(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(e){try{return await ur(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Xt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await ur(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Xt(r))return{data:null,error:r};throw r}}}function U_(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const Uu={debug:!!(globalThis&&x4()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class r2 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class _4 extends r2{}class lN extends r2{}async function w4(t,e,r){Uu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const a=new globalThis.AbortController;return e>0&&setTimeout(()=>{a.abort(),Uu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){Uu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{Uu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Uu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new _4(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Uu.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}const q_={};async function cN(t,e,r){var a;const n=(a=q_[t])!==null&&a!==void 0?a:Promise.resolve(),i=Promise.race([n.catch(()=>null),e>=0?new Promise((o,c)=>{setTimeout(()=>{c(new lN(`Acquiring process lock with name "${t}" timed out`))},e)}):null].filter(o=>o)).catch(o=>{if(o&&o.isAcquireTimeout)throw o;return null}).then(async()=>await r());return q_[t]=i.catch(async o=>{if(o&&o.isAcquireTimeout)return await n,null;throw o}),await i}function uN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function b4(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function fN(t){return parseInt(t,16)}function hN(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,a=>a.toString(16).padStart(2,"0")).join("")}function dN(t){var e;const{chainId:r,domain:a,expirationTime:n,issuedAt:i=new Date,nonce:o,notBefore:c,requestId:u,resources:h,scheme:d,uri:v,version:y}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!v)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const g=b4(t.address),b=d?`${d}://${a}`:a,w=t.statement?`${t.statement}
`:"",E=`${b} wants you to sign in with your Ethereum account:
${g}

${w}`;let A=`URI: ${v}
Version: ${y}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(n&&(A+=`
Expiration Time: ${n.toISOString()}`),c&&(A+=`
Not Before: ${c.toISOString()}`),u&&(A+=`
Request ID: ${u}`),h){let O=`
Resources:`;for(const T of h){if(!T||typeof T!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${T}`);O+=`
- ${T}`}A+=O}return`${E}
${A}`}class Cn extends Error{constructor({message:e,code:r,cause:a,name:n}){var i;super(e,{cause:a}),this.__isWebAuthnError=!0,this.name=(i=n??(a instanceof Error?a.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class up extends Cn{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function pN({error:t,options:e}){var r,a,n;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Cn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Cn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Cn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Cn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Cn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Cn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new Cn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Cn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(S4(o)){if(i.rp.id!==o)return new Cn({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Cn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Cn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Cn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Cn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function mN({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Cn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Cn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if(S4(a)){if(r.rpId!==a)return new Cn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Cn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Cn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Cn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class gN{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const vN=new gN;function xN(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:a}=t,n=zh(t,["challenge","user","excludeCredentials"]),i=Ah(e).buffer,o=Object.assign(Object.assign({},r),{id:Ah(r.id).buffer}),c=Object.assign(Object.assign({},n),{challenge:i,user:o});if(a&&a.length>0){c.excludeCredentials=new Array(a.length);for(let u=0;u<a.length;u++){const h=a[u];c.excludeCredentials[u]=Object.assign(Object.assign({},h),{id:Ah(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return c}function yN(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,a=zh(t,["challenge","allowCredentials"]),n=Ah(e).buffer,i=Object.assign(Object.assign({},a),{challenge:n});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const c=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},c),{id:Ah(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return i}function _N(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:$u(new Uint8Array(t.response.attestationObject)),clientDataJSON:$u(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function wN(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,a=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:$u(new Uint8Array(n.authenticatorData)),clientDataJSON:$u(new Uint8Array(n.clientDataJSON)),signature:$u(new Uint8Array(n.signature)),userHandle:n.userHandle?$u(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function S4(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function z_(){var t,e;return!!(fi()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function bN(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new up("Browser returned unexpected credential type",e)}:{data:null,error:new up("Empty credential response",e)}}catch(e){return{data:null,error:pN({error:e,options:t})}}}async function SN(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new up("Browser returned unexpected credential type",e)}:{data:null,error:new up("Empty credential response",e)}}catch(e){return{data:null,error:mN({error:e,options:t})}}}const EN={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},kN={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function fp(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),a={};for(const n of t)if(n)for(const i in n){const o=n[i];if(o!==void 0)if(Array.isArray(o))a[i]=o;else if(r(o))a[i]=o;else if(e(o)){const c=a[i];e(c)?a[i]=fp(c,o):a[i]=fp(o)}else a[i]=o}return a}function AN(t,e){return fp(EN,t,e||{})}function NN(t,e){return fp(kN,t,e||{})}class TN{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:a,signal:n},i){try{const{data:o,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!o)return{data:null,error:c};const u=n??vN.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:h}=o.webauthn.credential_options.publicKey;h.name||(h.name=`${h.id}:${a}`),h.displayName||(h.displayName=h.name)}switch(o.webauthn.type){case"create":{const h=AN(o.webauthn.credential_options.publicKey,i?.create),{data:d,error:v}=await bN({publicKey:h,signal:u});return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:v}}case"request":{const h=NN(o.webauthn.credential_options.publicKey,i?.request),{data:d,error:v}=await SN(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:h,signal:u}));return d?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:v}}}}catch(o){return Xt(o)?{data:null,error:o}:{data:null,error:new Xc("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:a})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new Mh("rpId is required for WebAuthn authentication")};try{if(!z_())return{data:null,error:new Xc("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:a},signal:n},{request:i});if(!o)return{data:null,error:c};const{webauthn:u}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:u.type,rpId:r,rpOrigins:a,credential_response:u.credential_response}})}catch(o){return Xt(o)?{data:null,error:o}:{data:null,error:new Xc("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new Mh("rpId is required for WebAuthn registration")};try{if(!z_())return{data:null,error:new Xc("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(d=>{var v;return(v=d.data)===null||v===void 0?void 0:v.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===e&&y.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d?.id}):void 0),{data:null,error:c};const{data:u,error:h}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:n},{create:i});return u?this._verify({factorId:o.id,challengeId:u.challengeId,webauthn:{rpId:r,rpOrigins:a,type:u.webauthn.type,credential_response:u.webauthn.credential_response}}):{data:null,error:h}}catch(o){return Xt(o)?{data:null,error:o}:{data:null,error:new Xc("Unexpected error in register",o)}}}}uN();const jN={url:T6,storageKey:j6,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:C6,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function H_(t,e,r){return await r()}const uh={};class Ih{get jwks(){var e,r;return(r=(e=uh[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){uh[this.storageKey]=Object.assign(Object.assign({},uh[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=uh[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){uh[this.storageKey]=Object.assign(Object.assign({},uh[this.storageKey]),{cachedAt:e})}constructor(e){var r,a,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},jN),e);if(this.storageKey=i.storageKey,this.instanceID=(r=Ih.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Ih.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&fi()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new t2({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=y4(i.fetch),this.lock=i.lock||H_,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&fi()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=w4:this.lock=H_,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new TN(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:x4()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=U_(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=U_(this.memoryStorage)),fi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${u4}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},a="none";if(fi()&&(r=z6(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),fi()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,a);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),m4(i)){const u=(e=i.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:c}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Xt(r)?this._returnResult({error:r}):this._returnResult({error:new Xc("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,a,n;try{const i=await ur(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Mo}),{data:o,error:c}=i;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const u=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:h,session:u},error:null})}catch(i){if(Xt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var r,a,n;try{let i;if("email"in e){const{email:d,password:v,options:y}=e;let g=null,b=null;this.flowType==="pkce"&&([g,b]=await lh(this.storage,this.storageKey)),i=await ur(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:d,password:v,data:(r=y?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:g,code_challenge_method:b},xform:Mo})}else if("phone"in e){const{phone:d,password:v,options:y}=e;i=await ur(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:v,data:(a=y?.data)!==null&&a!==void 0?a:{},channel:(n=y?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:Mo})}else throw new M0("You must provide either an email or phone number and a password");const{data:o,error:c}=i;if(c||!o)return await ui(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const u=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:h,session:u},error:null})}catch(i){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Xt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:c}=e;r=await ur(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:I_})}else if("phone"in e){const{phone:i,password:o,options:c}=e;r=await ur(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:I_})}else throw new M0("You must provide either an email or phone number and a password");const{data:a,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!a||!a.session||!a.user){const i=new Iu;return this._returnResult({data:{user:null,session:null},error:i})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(r){if(Xt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,a,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,a,n,i,o,c,u,h,d,v,y;let g,b;if("message"in e)g=e.message,b=e.signature;else{const{chain:w,wallet:E,statement:A,options:O}=e;let T;if(fi())if(typeof E=="object")T=E;else{const D=window;if("ethereum"in D&&typeof D.ethereum=="object"&&"request"in D.ethereum&&typeof D.ethereum.request=="function")T=D.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!O?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=E}const R=new URL((r=O?.url)!==null&&r!==void 0?r:window.location.href),H=await T.request({method:"eth_requestAccounts"}).then(D=>D).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!H||H.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const z=b4(H[0]);let F=(a=O?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!F){const D=await T.request({method:"eth_chainId"});F=fN(D)}const W={domain:R.host,address:z,statement:A,uri:R.href,version:"1",chainId:F,nonce:(n=O?.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(o=(i=O?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(c=O?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(u=O?.signInWithEthereum)===null||u===void 0?void 0:u.notBefore,requestId:(h=O?.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(d=O?.signInWithEthereum)===null||d===void 0?void 0:d.resources};g=dN(W),b=await T.request({method:"personal_sign",params:[hN(g),z]})}try{const{data:w,error:E}=await ur(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:b},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Mo});if(E)throw E;if(!w||!w.session||!w.user){const A=new Iu;return this._returnResult({data:{user:null,session:null},error:A})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:E})}catch(w){if(Xt(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(e){var r,a,n,i,o,c,u,h,d,v,y,g;let b,w;if("message"in e)b=e.message,w=e.signature;else{const{chain:E,wallet:A,statement:O,options:T}=e;let R;if(fi())if(typeof A=="object")R=A;else{const z=window;if("solana"in z&&typeof z.solana=="object"&&("signIn"in z.solana&&typeof z.solana.signIn=="function"||"signMessage"in z.solana&&typeof z.solana.signMessage=="function"))R=z.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");R=A}const H=new URL((r=T?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in R&&R.signIn){const z=await R.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T?.signInWithSolana),{version:"1",domain:H.host,uri:H.href}),O?{statement:O}:null));let F;if(Array.isArray(z)&&z[0]&&typeof z[0]=="object")F=z[0];else if(z&&typeof z=="object"&&"signedMessage"in z&&"signature"in z)F=z;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)b=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),w=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in R)||typeof R.signMessage!="function"||!("publicKey"in R)||typeof R!="object"||!R.publicKey||!("toBase58"in R.publicKey)||typeof R.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${H.host} wants you to sign in with your Solana account:`,R.publicKey.toBase58(),...O?["",O,""]:[""],"Version: 1",`URI: ${H.href}`,`Issued At: ${(n=(a=T?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=T?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((o=T?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((c=T?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((u=T?.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((h=T?.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((v=(d=T?.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||v===void 0)&&v.length?["Resources",...T.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const z=await R.signMessage(new TextEncoder().encode(b),"utf8");if(!z||!(z instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=z}}try{const{data:E,error:A}=await ur(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:$u(w)},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Mo});if(A)throw A;if(!E||!E.session||!E.user){const O=new Iu;return this._returnResult({data:{user:null,session:null},error:O})}return E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),this._returnResult({data:Object.assign({},E),error:A})}catch(E){if(Xt(E))return this._returnResult({data:{user:null,session:null},error:E});throw E}}async _exchangeCodeForSession(e){const r=await Mu(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(r??"").split("/");try{if(!a&&this.flowType==="pkce")throw new g4;const{data:i,error:o}=await ur(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:a},xform:Mo});if(await ui(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const c=new Iu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Xt(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:r,provider:a,token:n,access_token:i,nonce:o}=e,c=await ur(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Mo}),{data:u,error:h}=c;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!u||!u.session||!u.user){const d=new Iu;return this._returnResult({data:{user:null,session:null},error:d})}return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),this._returnResult({data:u,error:h})}catch(r){if(Xt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,a,n,i,o;try{if("email"in e){const{email:c,options:u}=e;let h=null,d=null;this.flowType==="pkce"&&([h,d]=await lh(this.storage,this.storageKey));const{error:v}=await ur(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=u?.data)!==null&&r!==void 0?r:{},create_user:(a=u?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},code_challenge:h,code_challenge_method:d},redirectTo:u?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:v})}if("phone"in e){const{phone:c,options:u}=e,{data:h,error:d}=await ur(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(n=u?.data)!==null&&n!==void 0?n:{},create_user:(i=u?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},channel:(o=u?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:d})}throw new M0("You must provide either an email or phone number.")}catch(c){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Xt(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var r,a;try{let n,i;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(a=e.options)===null||a===void 0?void 0:a.captchaToken);const{data:o,error:c}=await ur(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Mo});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const u=o.session,h=o.user;return u?.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),this._returnResult({data:{user:h,session:u},error:null})}catch(n){if(Xt(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,a,n,i,o;try{let c=null,u=null;this.flowType==="pkce"&&([c,u]=await lh(this.storage,this.storageKey));const h=await ur(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(a=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:u}),headers:this.headers,xform:iN});return!((i=h.data)===null||i===void 0)&&i.url&&fi()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(h.data.url),this._returnResult(h)}catch(c){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Xt(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:a}=e;if(a)throw a;if(!r)throw new ss;const{error:n}=await ur(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(Xt(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:a,type:n,options:i}=e,{error:o}=await ur(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:a,type:n,options:i}=e,{data:o,error:c}=await ur(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:c})}throw new M0("You must provide either an email or phone number and a type")}catch(r){if(Xt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Mu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const a=e.expires_at?e.expires_at*1e3-Date.now()<pg:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",e.expires_at),!a){if(this.userStorage){const o=await Mu(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=gg()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=tN(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await ur(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Yc}):await this._useSession(async r=>{var a,n,i;const{data:o,error:c}=r;if(c)throw c;return!(!((a=o.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ss}:await ur(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Yc})})}catch(r){if(Xt(r))return p4(r)&&(await this._removeSession(),await ui(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async a=>{const{data:n,error:i}=a;if(i)throw i;if(!n.session)throw new ss;const o=n.session;let c=null,u=null;this.flowType==="pkce"&&e.email!=null&&([c,u]=await lh(this.storage,this.storageKey));const{data:h,error:d}=await ur(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:u}),jwt:o.access_token,xform:Yc});if(d)throw d;return o.user=h.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(a){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Xt(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ss;const r=Date.now()/1e3;let a=r,n=!0,i=null;const{payload:o}=mg(e.access_token);if(o.exp&&(a=o.exp,n=a<=r),n){const{data:c,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:u}=await this._getUser(e.access_token);if(u)throw u;i={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(Xt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var a;if(!e){const{data:o,error:c}=r;if(c)throw c;e=(a=o.session)!==null&&a!==void 0?a:void 0}if(!e?.refresh_token)throw new ss;const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Xt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!fi())throw new I0("No browser detected.");if(e.error||e.error_description||e.error_code)throw new I0(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new xv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new I0("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new xv("No code detected.");const{data:O,error:T}=await this._exchangeCodeForSession(e.code);if(T)throw T;const R=new URL(window.location.href);return R.searchParams.delete("code"),window.history.replaceState(window.history.state,"",R.toString()),{data:{session:O.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:c,expires_at:u,token_type:h}=e;if(!i||!c||!o||!h)throw new I0("No session defined in URL");const d=Math.round(Date.now()/1e3),v=parseInt(c);let y=d+v;u&&(y=parseInt(u));const g=y-d;g*1e3<=vh&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${v}s`);const b=y-v;d-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,y,d):d-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,y,d);const{data:w,error:E}=await this._getUser(i);if(E)throw E;const A={provider_token:a,provider_refresh_token:n,access_token:i,expires_in:v,expires_at:y,refresh_token:o,token_type:h,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:A,redirectType:e.type},error:null})}catch(a){if(Xt(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Mu(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:n,error:i}=r;if(i)return this._returnResult({error:i});const o=(a=n.session)===null||a===void 0?void 0:a.access_token;if(o){const{error:c}=await this.admin.signOut(o,e);if(c&&!(d4(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await ui(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=q6(),a={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(e){return await this._useSession(async r=>{var a,n;try{const{data:{session:i},error:o}=r;if(o)throw o;await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await lh(this.storage,this.storageKey,!0));try{return await ur(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Xt(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(Xt(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:a,error:n}=await this._useSession(async i=>{var o,c,u,h,d;const{data:v,error:y}=i;if(y)throw y;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await ur(this.fetch,"GET",g,{headers:this.headers,jwt:(d=(h=v.session)===null||h===void 0?void 0:h.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return fi()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:e.provider,url:a?.url},error:null})}catch(a){if(Xt(a))return this._returnResult({data:{provider:e.provider,url:null},error:a});throw a}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var a;try{const{error:n,data:{session:i}}=r;if(n)throw n;const{options:o,provider:c,token:u,access_token:h,nonce:d}=e,v=await ur(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=i?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:c,id_token:u,access_token:h,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Mo}),{data:y,error:g}=v;return g?this._returnResult({data:{user:null,session:null},error:g}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new Iu}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:g}))}catch(n){if(await ui(this.storage,`${this.storageKey}-code-verifier`),Xt(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var a,n;const{data:i,error:o}=r;if(o)throw o;return await ur(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(Xt(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await V6(async n=>(n>0&&await W6(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await ur(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Mo})),(n,i)=>{const o=200*Math.pow(2,n);return i&&K1(i)&&Date.now()+o-a<vh})}catch(a){if(this._debug(r,"error",a),Xt(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",a),fi()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:e,url:a},error:null}}async _recoverAndRefresh(){var e,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await Mu(this.storage,this.storageKey);if(n&&this.userStorage){let o=await Mu(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await xh(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o?.user)!==null&&e!==void 0?e:gg()}else if(n&&!n.user&&!n.user){const o=await Mu(this.storage,this.storageKey+"-user");o&&o?.user?(n.user=o.user,await ui(this.storage,this.storageKey+"-user"),await xh(this.storage,this.storageKey,n)):n.user=gg()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<pg;if(this._debug(a,`session has${i?"":" not"} expired with margin of ${pg}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),K1(o)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(n.access_token);!c&&o?.user?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(a,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n),console.error(n);return}finally{this._debug(a,"end")}}async _callRefreshToken(e){var r,a;if(!e)throw new ss;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Lp;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new ss;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={data:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(n,"error",i),Xt(i)){const o={data:null,error:i};return K1(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,a=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,r)}catch(u){i.push(u)}});if(await Promise.all(o),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ui(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await xh(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=P_(n);await xh(this.storage,this.storageKey,i)}else{const n=P_(r);await xh(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await ui(this.storage,this.storageKey),await ui(this.storage,this.storageKey+"-code-verifier"),await ui(this.storage,this.storageKey+"-user"),this.userStorage&&await ui(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&fi()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),vh);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-e)/vh);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${vh}ms, refresh threshold is ${gv} ticks`),n<=gv&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof r2)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!fi()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,a){const n=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[i,o]=await lh(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(c.toString())}if(a?.queryParams){const i=new URLSearchParams(a.queryParams);n.push(i.toString())}return a?.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var a;const{data:n,error:i}=r;return i?this._returnResult({data:null,error:i}):await ur(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(Xt(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var a,n;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:u,error:h}=await ur(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(a=i?.session)===null||a===void 0?void 0:a.access_token});return h?this._returnResult({data:null,error:h}):(e.factorType==="totp"&&u.type==="totp"&&(!((n=u?.totp)===null||n===void 0)&&n.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),this._returnResult({data:u,error:null}))})}catch(r){if(Xt(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?_N(e.webauthn.credential_response):wN(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:u}=await ur(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token});return u?this._returnResult({data:null,error:u}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:u}))})}catch(r){if(Xt(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await ur(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token});if(o.error)return o;const{data:c}=o;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:xN(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:yN(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Xt(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:a}=await this._challenge({factorId:e.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const n={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=r?.factors)!==null&&e!==void 0?e:[])n.all.push(i),i.status==="verified"&&n[i.factor_type].push(i);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:a},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=mg(a.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((r=(e=a.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const h=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?await ur(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:a.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new ss})})}catch(r){if(Xt(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async a=>{const{data:{session:n},error:i}=a;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new ss});const o=await ur(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&fi()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(a){if(Xt(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(e,r){try{return await this._useSession(async a=>{const{data:{session:n},error:i}=a;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new ss});const o=await ur(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&fi()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(a){if(Xt(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:a}=e;return a?this._returnResult({data:null,error:a}):r?await ur(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new ss})})}catch(e){if(Xt(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?(await ur(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ss})})}catch(r){if(Xt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let a=r.keys.find(c=>c.kid===e);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(c=>c.kid===e),a&&this.jwks_cached_at+F6>n)return a;const{data:i,error:o}=await ur(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,a=i.keys.find(c=>c.kid===e),!a)?null:a}async getClaims(e,r={}){try{let a=e;if(!a){const{data:g,error:b}=await this.getSession();if(b||!g.session)return this._returnResult({data:null,error:b});a=g.session.access_token}const{header:n,payload:i,signature:o,raw:{header:c,payload:u}}=mg(a);r?.allowExpired||Z6(i.exp);const h=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!h){const{error:g}=await this.getUser(a);if(g)throw g;return{data:{claims:i,header:n,signature:o},error:null}}const d=Q6(n.alg),v=await crypto.subtle.importKey("jwk",h,d,!0,["verify"]);if(!await crypto.subtle.verify(d,v,o,B6(`${c}.${u}`)))throw new lp("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(a){if(Xt(a))return this._returnResult({data:null,error:a});throw a}}}Ih.nextInstanceID={};const CN=t2,E4=Ih;class ON extends E4{constructor(e){super(e)}}class k4{constructor(e,r,a){var n,i,o;this.supabaseUrl=e,this.supabaseKey=r;const c=N6(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,h={db:y6,realtime:w6,auth:Object.assign(Object.assign({},_6),{storageKey:u}),global:x6},d=A6(a??{},h);this.storageKey=(n=d.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(v,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=E6(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(v=>this.realtime.setAuth(v)).catch(v=>console.warn("Failed to set initial Realtime auth token:",v)),this.rest=new wA(new URL("rest/v1",c).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new m6(this.storageUrl.href,this.headers,this.fetch,a?.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new vA(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},a={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,a)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:a}=await this.auth.getSession();return(r=(e=a.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:i,storageKey:o,flowType:c,lock:u,debug:h,throwOnError:d},v,y){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ON({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),v),storageKey:o,autoRefreshToken:e,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:i,flowType:c,lock:u,debug:h,throwOnError:d,fetch:y,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new i4(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a?.access_token)})}_handleTokenChanged(e,r,a){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const FN=(t,e,r)=>new k4(t,e,r);function RN(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}RN()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const LN=Object.freeze(Object.defineProperty({__proto__:null,AuthAdminApi:CN,AuthApiError:h4,AuthClient:E4,AuthError:Mh,AuthImplicitGrantRedirectError:I0,AuthInvalidCredentialsError:M0,AuthInvalidJwtError:lp,AuthInvalidTokenResponseError:Iu,AuthPKCECodeVerifierMissingError:g4,AuthPKCEGrantCodeExchangeError:xv,AuthRetryableFetchError:op,AuthSessionMissingError:ss,AuthUnknownError:Xc,AuthWeakPasswordError:yv,CustomAuthError:_l,get FunctionRegion(){return sp},FunctionsError:Fp,FunctionsFetchError:$b,FunctionsHttpError:ov,FunctionsRelayError:sv,GoTrueAdminApi:t2,GoTrueClient:Ih,NavigatorLockAcquireTimeoutError:_4,PostgrestError:bA,REALTIME_CHANNEL_STATES:DA,get REALTIME_LISTEN_TYPES(){return kh},get REALTIME_POSTGRES_CHANGES_LISTEN_EVENT(){return hv},get REALTIME_PRESENCE_LISTEN_EVENTS(){return fv},get REALTIME_SUBSCRIBE_STATES(){return vl},RealtimeChannel:Gu,RealtimeClient:i4,RealtimePresence:Eh,SIGN_OUT_SCOPES:J1,SupabaseClient:k4,WebSocketFactory:e4,createClient:FN,isAuthApiError:d4,isAuthError:Xt,isAuthImplicitGrantRedirectError:m4,isAuthPKCECodeVerifierMissingError:R6,isAuthRetryableFetchError:K1,isAuthSessionMissingError:p4,isAuthWeakPasswordError:L6,lockInternals:Uu,navigatorLock:w4,processLock:cN},Symbol.toStringTag,{value:"Module"})),{createClient:DN}=LN,A4="",PN="",N1=[{id:"da92028d-3056-4b0c-a467-e3fbe4ce8466",name:"GGG"},{id:"bf01ee1a-e29e-4ef8-8742-53cda36d9452",name:"Miller"}],Ke=!!A4,Re=Ke?DN(A4,PN):null,N4="fieldsync_data",_v="fieldsync_user",Sr=()=>{const t=localStorage.getItem(N4);return t?JSON.parse(t):{projects:[],areas:[],users:[],assignments:[]}},Ga=t=>{localStorage.setItem(N4,JSON.stringify(t))},T1=()=>{const t=localStorage.getItem(_v);return t?JSON.parse(t):null},j1=t=>{t?localStorage.setItem(_v,JSON.stringify(t)):localStorage.removeItem(_v)},MN={async signUp(t,e,r,a){if(Ke){const{data:n,error:i}=await Re.auth.signUp({email:t,password:e,options:{data:{name:r,role:a}}});if(i)throw i;return n}else{const n=Sr(),i={id:crypto.randomUUID(),email:t,name:r,role:a,created_at:new Date().toISOString()};return n.users.push(i),Ga(n),j1(i),{user:i}}},async signIn(t,e){if(Ke){const{data:r,error:a}=await Re.auth.signInWithPassword({email:t,password:e});if(a)throw a;return r}else{const a=Sr().users.find(n=>n.email===t);if(!a)throw new Error("User not found");return j1(a),{user:a}}},async signOut(){if(Ke){const{error:t}=await Re.auth.signOut();if(t)throw t}else j1(null)},async getUser(){if(Ke){const{data:{user:t}}=await Re.auth.getUser();return t}else return T1()},async getProfile(){if(Ke){const{data:{user:t}}=await Re.auth.getUser();if(!t)return null;const{data:e,error:r}=await Re.from("users").select("*").eq("id",t.id).single();return r?{id:t.id,email:t.email,name:t.user_metadata?.name||"",role:t.user_metadata?.role||"foreman"}:e}else return T1()},async updateRole(t,e){if(Ke){const{data:r,error:a}=await Re.from("users").update({role:e}).eq("id",t).select().single();if(a)throw a;return r}else{const r=Sr(),a=r.users.find(n=>n.id===t);return a&&(a.role=e,Ga(r),T1()?.id===t&&j1(a)),a}},onAuthStateChange(t){if(Ke)return Re.auth.onAuthStateChange(t);{const e=T1();return t(e?"SIGNED_IN":"SIGNED_OUT",{user:e}),{data:{subscription:{unsubscribe:()=>{}}}}}}},jt={async getProjects(t=null,e=!1){if(Ke){let r=Re.from("projects").select("*").order("created_at",{ascending:!1});t&&(r=r.eq("company_id",t)),e||(r=r.eq("status","active"));const{data:a,error:n}=await r;if(n)throw n;return a}else{const r=Sr().projects;return e?r:r.filter(a=>a.status!=="archived")}},async getArchivedProjects(t){if(Ke){const{data:e,error:r}=await Re.from("projects").select("*").eq("company_id",t).eq("status","archived").order("archived_at",{ascending:!1});if(r)throw r;return e}else return Sr().projects.filter(e=>e.status==="archived")},async getProjectCount(t){if(Ke){const{count:e,error:r}=await Re.from("projects").select("*",{count:"exact",head:!0}).eq("company_id",t).in("status",["active","archived"]);if(r)throw r;return e||0}else return Sr().projects.filter(r=>r.company_id===t&&r.status!=="deleted").length},async archiveProject(t){if(Ke){const{data:e,error:r}=await Re.from("projects").update({status:"archived",archived_at:new Date().toISOString()}).eq("id",t).select().single();if(r)throw r;return e}else{const e=Sr(),r=e.projects.find(a=>a.id===t);return r&&(r.status="archived",r.archived_at=new Date().toISOString(),Ga(e)),r}},async restoreProject(t){if(Ke){const{data:e,error:r}=await Re.from("projects").update({status:"active",archived_at:null}).eq("id",t).select().single();if(r)throw r;return e}else{const e=Sr(),r=e.projects.find(a=>a.id===t);return r&&(r.status="active",r.archived_at=null,Ga(e)),r}},async getProject(t){if(Ke){const{data:e,error:r}=await Re.from("projects").select("*").eq("id",t).single();if(r)throw r;return e}else return Sr().projects.find(e=>e.id===t)},async createProject(t){if(Ke){const{data:e,error:r}=await Re.from("projects").insert({...t,status:"active"}).select().single();if(r)throw r;return e}else{const e=Sr(),r={...t,id:crypto.randomUUID(),status:"active",created_at:new Date().toISOString()};return e.projects.push(r),Ga(e),r}},async getProjectByPin(t){if(Ke){const{data:e,error:r}=await Re.from("projects").select("*").eq("pin",t).eq("status","active").single();return r?null:e}else return Sr().projects.find(r=>r.pin===t&&r.status==="active")||null},async getProjectByPinAndCompany(t,e){if(Ke){const{data:r,error:a}=await Re.from("projects").select("*").eq("pin",t).eq("company_id",e).eq("status","active").single();return a?null:r}else return Sr().projects.find(a=>a.pin===t&&a.company_id===e&&a.status==="active")||null},async isPinAvailable(t,e=null){if(Ke){let r=Re.from("projects").select("id").eq("pin",t);e&&(r=r.neq("id",e));const{data:a,error:n}=await r;if(n)throw n;return a.length===0}else return!Sr().projects.some(a=>a.pin===t&&a.id!==e)},async updateProjectPin(t,e){if(Ke){const{data:r,error:a}=await Re.from("projects").update({pin:e}).eq("id",t).select().single();if(a)throw a;return r}else{const r=Sr(),a=r.projects.find(n=>n.id===t);return a&&(a.pin=e,Ga(r)),a}},async updateProject(t,e){if(Ke){const{data:r,error:a}=await Re.from("projects").update(e).eq("id",t).select().single();if(a)throw a;return r}else{const r=Sr(),a=r.projects.find(n=>n.id===t);return a&&(Object.assign(a,e),Ga(r)),a}},async updateProjectStatus(t,e){return this.updateProject(t,{status:e})},async deleteProject(t){if(Ke){const{error:e}=await Re.from("projects").delete().eq("id",t);if(e)throw e}else{const e=Sr();e.projects=e.projects.filter(r=>r.id!==t),e.areas=e.areas.filter(r=>r.project_id!==t),Ga(e)}},async getAreas(t){if(Ke){const{data:e,error:r}=await Re.from("areas").select("*").eq("project_id",t).order("sort_order",{ascending:!0});if(r)throw r;return e}else return Sr().areas.filter(e=>e.project_id===t)},async createArea(t){if(Ke){const{data:e,error:r}=await Re.from("areas").insert(t).select().single();if(r)throw r;return e}else{const e=Sr(),r={...t,id:crypto.randomUUID(),created_at:new Date().toISOString()};return e.areas.push(r),Ga(e),r}},async updateAreaStatus(t,e){if(Ke){const{data:r,error:a}=await Re.from("areas").update({status:e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return r}else{const r=Sr(),a=r.areas.find(n=>n.id===t);return a&&(a.status=e,a.updated_at=new Date().toISOString()),Ga(r),a}},async updateArea(t,e){if(Ke){const{data:r,error:a}=await Re.from("areas").update({...e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return r}else{const r=Sr(),a=r.areas.find(n=>n.id===t);return a&&(Object.assign(a,e),a.updated_at=new Date().toISOString()),Ga(r),a}},async deleteArea(t){if(Ke){const{error:e}=await Re.from("areas").delete().eq("id",t);if(e)throw e}else{const e=Sr();e.areas=e.areas.filter(r=>r.id!==t),Ga(e)}},subscribeToAreas(t,e){return Ke?Re.channel(`areas:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"areas",filter:`project_id=eq.${t}`},e).subscribe():null},unsubscribe(t){t&&Ke&&Re.removeChannel(t)},async getAssignedProjects(t){if(Ke){const{data:e,error:r}=await Re.from("project_assignments").select(`
          project_id,
          projects (*)
        `).eq("user_id",t);if(r)throw r;return e.map(a=>a.projects)}else{const e=Sr();return(e.assignments?.filter(a=>a.user_id===t)||[]).map(a=>e.projects.find(n=>n.id===a.project_id)).filter(Boolean)}},async assignUserToProject(t,e,r){if(Ke){const{data:a,error:n}=await Re.from("project_assignments").insert({project_id:t,user_id:e,assigned_by:r}).select().single();if(n)throw n;return a}else{const a=Sr();a.assignments||(a.assignments=[]);const n={id:crypto.randomUUID(),project_id:t,user_id:e,assigned_by:r,assigned_at:new Date().toISOString()};return a.assignments.push(n),Ga(a),n}},async removeUserFromProject(t,e){if(Ke){const{error:r}=await Re.from("project_assignments").delete().eq("project_id",t).eq("user_id",e);if(r)throw r}else{const r=Sr();r.assignments=r.assignments?.filter(a=>!(a.project_id===t&&a.user_id===e))||[],Ga(r)}},async getProjectAssignments(t){if(Ke){const{data:e,error:r}=await Re.from("project_assignments").select(`
          user_id,
          users (id, email, name, role)
        `).eq("project_id",t);if(r)throw r;return e.map(a=>a.users)}else{const e=Sr();return(e.assignments?.filter(a=>a.project_id===t)||[]).map(a=>e.users.find(n=>n.id===a.user_id)).filter(Boolean)}},async getAllUsers(){if(Ke){const{data:t,error:e}=await Re.from("users").select("*").order("name");if(e)throw e;return t}else return Sr().users||[]},async getForemen(){if(Ke){const{data:t,error:e}=await Re.from("users").select("*").eq("role","foreman").order("name");if(e)throw e;return t}else return(Sr().users||[]).filter(t=>t.role==="foreman")},async logActivity(t,e,r,a,n,i){if(Ke){const{error:o}=await Re.from("activity_log").insert({user_id:t,project_id:e,area_id:r,action:a,old_value:n,new_value:i});o&&console.error("Error logging activity:",o)}},async getProjectActivity(t,e=50){if(Ke){const{data:r,error:a}=await Re.from("activity_log").select(`
          *,
          users (name, email),
          areas (name)
        `).eq("project_id",t).order("created_at",{ascending:!1}).limit(e);if(a)throw a;return r}return[]},async getMaterialsEquipment(t){if(Ke){const{data:e,error:r}=await Re.from("materials_equipment").select("*").eq("company_id",t).eq("active",!0).order("category").order("name");if(r)throw r;return e}return[]},async getMaterialsEquipmentByCategory(t,e){if(Ke){const{data:r,error:a}=await Re.from("materials_equipment").select("*").eq("company_id",t).eq("category",e).eq("active",!0).order("name");if(a)throw a;return r}return[]},async getAllMaterialsEquipment(t){if(Ke){const{data:e,error:r}=await Re.from("materials_equipment").select("*").eq("company_id",t).order("category").order("name");if(r)throw r;return e}return[]},async createMaterialEquipment(t){if(Ke){const{data:e,error:r}=await Re.from("materials_equipment").insert(t).select().single();if(r)throw r;return e}return null},async updateMaterialEquipment(t,e){if(Ke){const{data:r,error:a}=await Re.from("materials_equipment").update(e).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteMaterialEquipment(t){if(Ke){const{error:e}=await Re.from("materials_equipment").update({active:!1}).eq("id",t);if(e)throw e}},async getTMTickets(t){if(Ke){const{data:e,error:r}=await Re.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).order("created_at",{ascending:!1});if(r)throw r;return e}return[]},async getTMTicketsByStatus(t,e){if(Ke){const{data:r,error:a}=await Re.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).eq("status",e).order("created_at",{ascending:!1});if(a)throw a;return r}return[]},async createTMTicket(t){if(Ke){const{data:e,error:r}=await Re.from("t_and_m_tickets").insert({project_id:t.project_id,work_date:t.work_date,ce_pco_number:t.ce_pco_number||null,notes:t.notes,photos:t.photos||[],status:"pending",created_by_name:t.created_by_name||"Field User"}).select().single();if(r)throw r;return e}return null},async addTMWorkers(t,e){if(Ke){const r=e.map(n=>({ticket_id:t,name:n.name,hours:n.hours,overtime_hours:n.overtime_hours||0,time_started:n.time_started||null,time_ended:n.time_ended||null,role:n.role||"Laborer"})),{error:a}=await Re.from("t_and_m_workers").insert(r);if(a)throw a}},async addTMItems(t,e){if(Ke){const r=e.map(n=>({ticket_id:t,material_equipment_id:n.material_equipment_id||null,custom_name:n.custom_name||null,custom_category:n.custom_category||null,quantity:n.quantity})),{error:a}=await Re.from("t_and_m_items").insert(r);if(a)throw a}},async updateTMTicketStatus(t,e){if(Ke){const{data:r,error:a}=await Re.from("t_and_m_tickets").update({status:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async approveTMTicket(t,e,r){if(Ke){const{data:a,error:n}=await Re.from("t_and_m_tickets").update({status:"approved",approved_by_user_id:e,approved_by_name:r,approved_at:new Date().toISOString(),rejected_by_user_id:null,rejected_by_name:null,rejected_at:null,rejection_reason:null}).eq("id",t).select().single();if(n)throw n;return a}return null},async rejectTMTicket(t,e,r,a=""){if(Ke){const{data:n,error:i}=await Re.from("t_and_m_tickets").update({status:"rejected",rejected_by_user_id:e,rejected_by_name:r,rejected_at:new Date().toISOString(),rejection_reason:a,approved_by_user_id:null,approved_by_name:null,approved_at:null}).eq("id",t).select().single();if(i)throw i;return n}return null},canApproveTickets(t){return["owner","admin","manager"].includes(t)},async updateTMTicketPhotos(t,e){if(Ke){const{data:r,error:a}=await Re.from("t_and_m_tickets").update({photos:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteTMTicket(t){if(Ke){const{error:e}=await Re.from("t_and_m_tickets").delete().eq("id",t);if(e)throw e}},async getCompanyByCode(t){if(Ke){const{data:e,error:r}=await Re.from("companies").select("*").eq("code",t.toUpperCase().trim()).single();return r?(console.error("Error fetching company by code:",{code:t,error:r.message,hint:r.hint,details:r.details}),null):e}return null},async getCompany(t){if(Ke){const{data:e,error:r}=await Re.from("companies").select("*").eq("id",t).single();if(r)throw r;return e}return null},async getUserCompanies(t){if(!Ke)return[];try{const{data:e,error:r}=await Re.from("user_companies").select(`
          *,
          companies (*)
        `).eq("user_id",t).order("created_at",{ascending:!0});return r?(console.error("Error fetching user companies:",r),[]):e?.map(a=>({...a.companies,userRole:a.role}))||[]}catch(e){return console.error("Error fetching user companies:",e),[]}},async getUsersForCompany(t){if(!Ke)return[];try{const{data:e,error:r}=await Re.from("user_companies").select(`
          user_id,
          users (id, email, name, role)
        `).eq("company_id",t);return r?(console.error("Error fetching users for company:",r),[]):e?.map(a=>a.users).filter(Boolean)||[]}catch(e){return console.error("Error fetching users for company:",e),[]}},async getCompanyUsers(t){if(!Ke)return[];try{const{data:e,error:r}=await Re.from("users").select("id, email, name, role, created_at").eq("company_id",t).order("created_at",{ascending:!1});return r?(console.error("Error fetching company users:",r),[]):e||[]}catch(e){return console.error("Error fetching company users:",e),[]}},async updateUserRole(t,e){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{error:r}=await Re.from("users").update({role:e}).eq("id",t);return r?(console.error("Error updating user role:",r),{success:!1,error:r.message}):{success:!0}}catch(r){return console.error("Error updating user role:",r),{success:!1,error:r.message}}},async uploadPhoto(t,e,r,a){if(!Ke)return null;const n=Date.now(),i=Math.random().toString(36).substring(7),o=a.name?.split(".").pop()||"jpg",c=`${n}-${i}.${o}`,u=`${t}/${e}/${r}/${c}`,{data:h,error:d}=await Re.storage.from("tm-photos").upload(u,a,{cacheControl:"3600",upsert:!1});if(d)throw d;const{data:v}=Re.storage.from("tm-photos").getPublicUrl(u);return v.publicUrl},async uploadPhotoBase64(t,e,r,a,n="photo.jpg"){if(!Ke)return null;const o=await(await fetch(a)).blob(),c=Date.now(),u=Math.random().toString(36).substring(7),h=n.split(".").pop()||"jpg",d=`${c}-${u}.${h}`,v=`${t}/${e}/${r}/${d}`,{data:y,error:g}=await Re.storage.from("tm-photos").upload(v,o,{cacheControl:"3600",upsert:!1,contentType:o.type});if(g)throw g;const{data:b}=Re.storage.from("tm-photos").getPublicUrl(v);return b.publicUrl},async deletePhoto(t){if(!Ke)return;const r=new URL(t).pathname.match(/\/tm-photos\/(.+)$/);if(!r)return;const a=r[1],{error:n}=await Re.storage.from("tm-photos").remove([a]);if(n)throw n},async getCrewCheckin(t,e=null){if(!Ke)return null;const r=e||new Date().toISOString().split("T")[0],{data:a,error:n}=await Re.from("crew_checkins").select("*").eq("project_id",t).eq("check_in_date",r).single();return n&&n.code!=="PGRST116"&&console.error("Error fetching crew checkin:",n),a},async saveCrewCheckin(t,e,r=null,a=null){if(!Ke)return null;const n=a||new Date().toISOString().split("T")[0],{data:i,error:o}=await Re.from("crew_checkins").upsert({project_id:t,check_in_date:n,workers:e,created_by:r,updated_at:new Date().toISOString()},{onConflict:"project_id,check_in_date"}).select().single();if(o)throw console.error("Error saving crew checkin:",o),o;return i},async addCrewMember(t,e,r=null){if(!Ke)return null;const a=await this.getCrewCheckin(t),n=a?.workers||[];return n.find(i=>i.name.toLowerCase()===e.name.toLowerCase())?a:(n.push(e),await this.saveCrewCheckin(t,n,r))},async removeCrewMember(t,e){if(!Ke)return null;const r=await this.getCrewCheckin(t);if(!r)return null;const a=r.workers.filter(n=>n.name.toLowerCase()!==e.toLowerCase());return await this.saveCrewCheckin(t,a,r.created_by)},async getCrewCheckinHistory(t,e=30){if(!Ke)return[];const{data:r,error:a}=await Re.from("crew_checkins").select("*").eq("project_id",t).order("check_in_date",{ascending:!1}).limit(e);return a?(console.error("Error fetching crew history:",a),[]):r||[]},async getDailyReport(t,e=null){if(!Ke)return null;const r=e||new Date().toISOString().split("T")[0],{data:a,error:n}=await Re.from("daily_reports").select("*").eq("project_id",t).eq("report_date",r).single();return n&&n.code!=="PGRST116"&&console.error("Error fetching daily report:",n),a},async compileDailyReport(t,e=null){if(!Ke)return null;const r=e||new Date().toISOString().split("T")[0],a=await this.getCrewCheckin(t,r),{data:n}=await Re.from("areas").select("*").eq("project_id",t),i=n?.filter(u=>u.status==="done"&&u.completed_at?.startsWith(r))||[],{data:o}=await Re.from("t_and_m_tickets").select("*").eq("project_id",t).eq("work_date",r),c=o?.reduce((u,h)=>u+(h.photos?.length||0),0)||0;return{crew_count:a?.workers?.length||0,crew_list:a?.workers||[],tasks_completed:i.length,tasks_total:n?.length||0,completed_tasks:i.map(u=>({name:u.name,group:u.group_name})),tm_tickets_count:o?.length||0,photos_count:c}},async saveDailyReport(t,e,r=null){if(!Ke)return null;const a=r||new Date().toISOString().split("T")[0],{data:n,error:i}=await Re.from("daily_reports").upsert({project_id:t,report_date:a,...e,updated_at:new Date().toISOString()},{onConflict:"project_id,report_date"}).select().single();if(i)throw console.error("Error saving daily report:",i),i;return n},async submitDailyReport(t,e,r=null){if(!Ke)return null;const a=r||new Date().toISOString().split("T")[0],n=await this.compileDailyReport(t,a),{data:i,error:o}=await Re.from("daily_reports").upsert({project_id:t,report_date:a,...n,status:"submitted",submitted_at:new Date().toISOString(),submitted_by:e,updated_at:new Date().toISOString()},{onConflict:"project_id,report_date"}).select().single();if(o)throw console.error("Error submitting daily report:",o),o;return i},async getDailyReports(t,e=30){if(!Ke)return[];const{data:r,error:a}=await Re.from("daily_reports").select("*").eq("project_id",t).order("report_date",{ascending:!1}).limit(e);return a?(console.error("Error fetching daily reports:",a),[]):r||[]},async sendMessage(t,e,r,a,n=null,i=null,o="general",c=null){if(!Ke)return null;const{data:u,error:h}=await Re.from("messages").insert({project_id:t,sender_type:r,sender_name:a,sender_user_id:n,message:e,photo_url:i,message_type:o,parent_message_id:c}).select().single();if(h)throw console.error("Error sending message:",h),h;return u},async getMessages(t,e=50){if(!Ke)return[];const{data:r,error:a}=await Re.from("messages").select("*").eq("project_id",t).order("created_at",{ascending:!1}).limit(e);return a?(console.error("Error fetching messages:",a),[]):r||[]},async getUnreadCount(t,e){if(!Ke)return 0;const r=e==="field"?"office":"field",{count:a,error:n}=await Re.from("messages").select("*",{count:"exact",head:!0}).eq("project_id",t).eq("sender_type",r).eq("is_read",!1);return n?(console.error("Error getting unread count:",n),0):a||0},async markMessagesRead(t,e){if(!Ke)return;const r=e==="field"?"office":"field",{error:a}=await Re.from("messages").update({is_read:!0,read_at:new Date().toISOString()}).eq("project_id",t).eq("sender_type",r).eq("is_read",!1);a&&console.error("Error marking messages read:",a)},async createMaterialRequest(t,e,r,a=null,n="normal",i=null){if(!Ke)return null;const{data:o,error:c}=await Re.from("material_requests").insert({project_id:t,items:e,requested_by:r,needed_by:a,priority:n,notes:i}).select().single();if(c)throw console.error("Error creating material request:",c),c;if(o)try{const{data:u}=await Re.from("projects").select("name, company_id").eq("id",t).single();if(u){const h=n==="urgent"?"material_request_urgent":"material_request_submitted",{data:d}=await Re.from("user_notification_roles").select(`
              user_id,
              notification_roles!inner(company_id, role_key)
            `).eq("notification_roles.company_id",u.company_id).eq("notification_roles.role_key","materials_manager");if(d&&d.length>0){const v=e.map(b=>`${b.quantity} ${b.unit} ${b.name}`).join(", "),y=n==="urgent"?" Urgent Material Request":" New Material Request",g=`${r} requested: ${v} for ${u.name}`;for(const b of d)await this.createNotification(u.company_id,h,b.user_id,y,g,`/projects/${t}`,{request_id:o.id,project_id:t,priority:n,items_count:e.length})}}}catch(u){console.error("Error sending material request notification:",u)}return o},async getMaterialRequests(t,e=null){if(!Ke)return[];let r=Re.from("material_requests").select("*").eq("project_id",t).order("created_at",{ascending:!1});e&&(r=r.eq("status",e));const{data:a,error:n}=await r;return n?(console.error("Error fetching material requests:",n),[]):a||[]},async getPendingRequestsCount(t){if(!Ke)return 0;const{count:e,error:r}=await Re.from("material_requests").select("*",{count:"exact",head:!0}).eq("project_id",t).eq("status","pending");return r?0:e||0},async updateMaterialRequest(t,e,r,a=null,n=null){if(!Ke)return null;const i={status:e,responded_by:r,responded_at:new Date().toISOString(),response_notes:a,updated_at:new Date().toISOString()};n&&(i.expected_delivery=n),e==="delivered"&&(i.delivered_at=new Date().toISOString());const{data:o,error:c}=await Re.from("material_requests").update(i).eq("id",t).select().single();if(c)throw console.error("Error updating material request:",c),c;return o},generateShareToken(){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let e="";for(let r=0;r<12;r++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},async createProjectShare(t,e,r,a=null){if(!Ke){const u=Sr();u.projectShares||(u.projectShares=[]);const h={id:crypto.randomUUID(),project_id:t,share_token:this.generateShareToken(),created_by:e,expires_at:a,is_active:!0,permissions:r,view_count:0,last_viewed_at:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return u.projectShares.push(h),Ga(u),h}const{data:n,error:i}=await Re.rpc("generate_share_token");if(i)throw console.error("Error generating share token:",i),i;const{data:o,error:c}=await Re.from("project_shares").insert({project_id:t,share_token:n,created_by:e,expires_at:a,permissions:r}).select().single();if(c)throw console.error("Error creating project share:",c),c;return o},async getShareByToken(t){if(!Ke){const a=Sr();if(!a.projectShares)return null;const n=a.projectShares.find(i=>i.share_token===t&&i.is_active&&(!i.expires_at||new Date(i.expires_at)>new Date));return n&&(n.view_count++,n.last_viewed_at=new Date().toISOString(),Ga(a)),n}const{data:e,error:r}=await Re.from("project_shares").select("*, projects(*)").eq("share_token",t).eq("is_active",!0).single();return r?(console.error("Error fetching share by token:",r),null):e.expires_at&&new Date(e.expires_at)<new Date?null:(await Re.rpc("increment_share_view_count",{token:t}),e)},async getProjectShares(t){if(!Ke){const a=Sr();return a.projectShares?a.projectShares.filter(n=>n.project_id===t):[]}const{data:e,error:r}=await Re.from("project_shares").select("*, users(name, email)").eq("project_id",t).order("created_at",{ascending:!1});return r?(console.error("Error fetching project shares:",r),[]):e||[]},async updateProjectShare(t,e){if(!Ke){const n=Sr();if(!n.projectShares)return null;const i=n.projectShares.findIndex(o=>o.id===t);return i===-1?null:(n.projectShares[i]={...n.projectShares[i],...e,updated_at:new Date().toISOString()},Ga(n),n.projectShares[i])}const{data:r,error:a}=await Re.from("project_shares").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating project share:",a),a;return r},async revokeProjectShare(t){return this.updateProjectShare(t,{is_active:!1})},async deleteProjectShare(t){if(!Ke){const r=Sr();if(!r.projectShares)return;r.projectShares=r.projectShares.filter(a=>a.id!==t),Ga(r);return}const{error:e}=await Re.from("project_shares").delete().eq("id",t);if(e)throw console.error("Error deleting project share:",e),e},async getPublicProjectData(t){const e=await this.getShareByToken(t);if(!e)return null;const r=e.project_id||e.projects?.id;if(!Ke){const i=Sr(),o=i.projects.find(v=>v.id===r);if(!o)return null;const c=i.areas.filter(v=>v.project_id===r),u=c.reduce((v,y)=>v+parseFloat(y.weight||0),0),h=c.filter(v=>v.status==="done").reduce((v,y)=>v+parseFloat(y.weight||0),0),d=u>0?Math.round(h/u*100):0;return{share:e,project:o,progress:d,areas:e.permissions.progress?c:[],photos:[],dailyReports:[],tmTickets:[]}}const a=e.projects||await this.getProject(r);if(!a)return null;const n={share:e,project:a,areas:[],photos:[],dailyReports:[],tmTickets:[]};if(e.permissions.progress){n.areas=await this.getAreas(r);const i=n.areas.reduce((c,u)=>c+parseFloat(u.weight||0),0),o=n.areas.filter(c=>c.status==="done").reduce((c,u)=>c+parseFloat(u.weight||0),0);n.progress=i>0?Math.round(o/i*100):0}if(e.permissions.photos){const{data:i}=await Re.from("t_and_m_tickets").select("photos, work_date").eq("project_id",r).not("photos","is",null).order("work_date",{ascending:!1}).limit(20);n.photos=i?.flatMap(o=>(o.photos||[]).map(c=>({url:c,date:o.work_date})))||[]}if(e.permissions.daily_reports){const{data:i}=await Re.from("daily_reports").select("*").eq("project_id",r).order("report_date",{ascending:!1}).limit(10);n.dailyReports=i||[]}return e.permissions.tm_tickets&&(n.tmTickets=await this.getTMTickets(r)),n},async createInjuryReport(t){if(!Ke){const a=Sr();a.injuryReports||(a.injuryReports=[]);const n={id:crypto.randomUUID(),...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return a.injuryReports.push(n),Ga(a),n}const{data:e,error:r}=await Re.from("injury_reports").insert(t).select().single();if(r)throw console.error("Error creating injury report:",r),r;return e},async getInjuryReports(t){if(!Ke){const a=Sr();return a.injuryReports?a.injuryReports.filter(n=>n.project_id===t).sort((n,i)=>new Date(i.incident_date)-new Date(n.incident_date)):[]}const{data:e,error:r}=await Re.from("injury_reports").select("*").eq("project_id",t).order("incident_date",{ascending:!1});return r?(console.error("Error fetching injury reports:",r),[]):e||[]},async getCompanyInjuryReports(t,e=null){if(!Ke){const i=Sr();if(!i.injuryReports)return[];let o=i.injuryReports.filter(c=>c.company_id===t);return e&&(o=o.filter(c=>c.status===e)),o.sort((c,u)=>new Date(u.incident_date)-new Date(c.incident_date))}let r=Re.from("injury_reports").select("*, projects(name)").eq("company_id",t).order("incident_date",{ascending:!1});e&&(r=r.eq("status",e));const{data:a,error:n}=await r;return n?(console.error("Error fetching company injury reports:",n),[]):a||[]},async getInjuryReport(t){if(!Ke){const a=Sr();return a.injuryReports?a.injuryReports.find(n=>n.id===t):null}const{data:e,error:r}=await Re.from("injury_reports").select("*, projects(name, pin), users(name, email)").eq("id",t).single();return r?(console.error("Error fetching injury report:",r),null):e},async updateInjuryReport(t,e){if(!Ke){const n=Sr();if(!n.injuryReports)return null;const i=n.injuryReports.findIndex(o=>o.id===t);return i===-1?null:(n.injuryReports[i]={...n.injuryReports[i],...e,updated_at:new Date().toISOString()},Ga(n),n.injuryReports[i])}const{data:r,error:a}=await Re.from("injury_reports").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating injury report:",a),a;return r},async closeInjuryReport(t,e){return this.updateInjuryReport(t,{status:"closed",closed_at:new Date().toISOString(),closed_by:e})},async deleteInjuryReport(t){if(!Ke){const r=Sr();if(!r.injuryReports)return;r.injuryReports=r.injuryReports.filter(a=>a.id!==t),Ga(r);return}const{error:e}=await Re.from("injury_reports").delete().eq("id",t);if(e)throw console.error("Error deleting injury report:",e),e},async getInjuryStatistics(t,e=null,r=null){if(!Ke){const i=Sr();if(!i.injuryReports)return{total_incidents:0,minor_injuries:0,serious_injuries:0,critical_injuries:0,near_misses:0,osha_recordable:0,total_days_away:0,total_restricted_days:0};let o=i.injuryReports.filter(c=>c.company_id===t);return e&&(o=o.filter(c=>new Date(c.incident_date)>=new Date(e))),r&&(o=o.filter(c=>new Date(c.incident_date)<=new Date(r))),{total_incidents:o.length,minor_injuries:o.filter(c=>c.injury_type==="minor").length,serious_injuries:o.filter(c=>c.injury_type==="serious").length,critical_injuries:o.filter(c=>c.injury_type==="critical").length,near_misses:o.filter(c=>c.injury_type==="near_miss").length,osha_recordable:o.filter(c=>c.osha_recordable).length,total_days_away:o.reduce((c,u)=>c+(u.days_away_from_work||0),0),total_restricted_days:o.reduce((c,u)=>c+(u.restricted_work_days||0),0)}}const{data:a,error:n}=await Re.rpc("get_injury_statistics",{comp_id:t,start_date:e,end_date:r});return n?(console.error("Error fetching injury statistics:",n),null):a[0]||null},async addWitness(t,e){if(!Ke){const n=Sr();if(!n.injuryReports)return null;const i=n.injuryReports.findIndex(u=>u.id===t);if(i===-1)return null;const o=n.injuryReports[i],c=o.witnesses||[];return c.push(e),n.injuryReports[i]={...o,witnesses:c,updated_at:new Date().toISOString()},Ga(n),n.injuryReports[i]}const r=await this.getInjuryReport(t);if(!r)return null;const a=r.witnesses||[];return a.push(e),this.updateInjuryReport(t,{witnesses:a})},async removeWitness(t,e){if(!Ke){const n=Sr();if(!n.injuryReports)return null;const i=n.injuryReports.findIndex(u=>u.id===t);if(i===-1)return null;const o=n.injuryReports[i],c=o.witnesses||[];return c.splice(e,1),n.injuryReports[i]={...o,witnesses:c,updated_at:new Date().toISOString()},Ga(n),n.injuryReports[i]}const r=await this.getInjuryReport(t);if(!r)return null;const a=r.witnesses||[];return a.splice(e,1),this.updateInjuryReport(t,{witnesses:a})},async getDashboardMetrics(t){if(!Ke)return{activeProjects:0,crewToday:0,pendingTMCount:0,pendingTMValue:0,urgentRequests:0,unreadMessages:0};try{const{count:e}=await Re.from("projects").select("*",{count:"exact",head:!0}).eq("company_id",t);return{activeProjects:e||0,crewToday:0,pendingTMCount:0,pendingTMValue:0,urgentRequests:0,unreadMessages:0}}catch(e){return console.error("Error fetching dashboard metrics:",e),{activeProjects:0,crewToday:0,pendingTMCount:0,pendingTMValue:0,urgentRequests:0,unreadMessages:0}}},async getDashboardMetricsWithBreakdown(t){if(!Ke)return{activeProjects:{count:0,list:[]},totalContractValue:{total:0,breakdown:[]},tmApproved:{total:0,count:0,breakdown:[]},tmBilled:{total:0,count:0,breakdown:[]},materialRequestsPending:{total:0,breakdown:[]},revenueAtRisk:{total:0,breakdown:[]}};try{const{data:e,error:r}=await Re.from("projects").select("id, name, contract_value, status").eq("company_id",t).eq("status","active");if(r)throw r;const a=e||[],n=a.length,i=a.reduce((Y,I)=>Y+(parseFloat(I.contract_value)||0),0),o=a.filter(Y=>Y.contract_value>0).map(Y=>({projectId:Y.id,projectName:Y.name,value:parseFloat(Y.contract_value)||0})).sort((Y,I)=>I.value-Y.value),{data:c,error:u}=await Re.from("t_and_m_tickets").select(`
          id,
          project_id,
          status,
          t_and_m_workers (hours),
          t_and_m_items (
            quantity,
            materials_equipment (cost_per_unit)
          ),
          projects (name)
        `).in("project_id",a.map(Y=>Y.id));u&&console.error("Error fetching tickets:",u);const h=c||[],d=Y=>{const I=(Y.t_and_m_workers||[]).reduce((ee,oe)=>ee+(parseFloat(oe.hours)||0)*50,0),L=(Y.t_and_m_items||[]).reduce((ee,oe)=>{const ge=parseFloat(oe.quantity)||0,ie=parseFloat(oe.materials_equipment?.cost_per_unit)||0;return ee+ge*ie},0);return I+L},v=h.filter(Y=>Y.status==="approved"),y={};v.forEach(Y=>{const I=Y.projects?.name||"Unknown Project";y[Y.project_id]||(y[Y.project_id]={projectId:Y.project_id,projectName:I,value:0,ticketCount:0}),y[Y.project_id].value+=d(Y),y[Y.project_id].ticketCount+=1});const g=Object.values(y).sort((Y,I)=>I.value-Y.value),b=g.reduce((Y,I)=>Y+I.value,0),w=v.length,E=h.filter(Y=>Y.status==="billed"),A={};E.forEach(Y=>{const I=Y.projects?.name||"Unknown Project";A[Y.project_id]||(A[Y.project_id]={projectId:Y.project_id,projectName:I,value:0,ticketCount:0}),A[Y.project_id].value+=d(Y),A[Y.project_id].ticketCount+=1});const O=Object.values(A).sort((Y,I)=>I.value-Y.value),T=O.reduce((Y,I)=>Y+I.value,0),R=E.length,z=(await Promise.all(a.map(async Y=>{const{data:I}=await Re.from("areas").select("weight, status").eq("project_id",Y.id),L=(I||[]).reduce((ge,ie)=>ge+(parseFloat(ie.weight)||0),0),ee=(I||[]).filter(ge=>ge.status==="done").reduce((ge,ie)=>ge+(parseFloat(ie.weight)||0),0),oe=L>0?Math.round(ee/L*100):0;return{projectId:Y.id,projectName:Y.name,contractValue:parseFloat(Y.contract_value)||0,progress:oe}}))).filter(Y=>Y.progress<50&&Y.contractValue>0).map(Y=>({projectId:Y.projectId,projectName:Y.projectName,contractValue:Y.contractValue,progress:Y.progress,atRisk:Math.round(Y.contractValue*(1-Y.progress/100)),reason:`Low progress (${Y.progress}%)`})).sort((Y,I)=>I.atRisk-Y.atRisk),F=z.reduce((Y,I)=>Y+I.atRisk,0);let W=[],D=0;try{const{data:Y,error:I}=await Re.from("material_requests").select("project_id, projects (name)").in("project_id",a.map(L=>L.id)).eq("status","pending");if(!I&&Y){const L={};Y.forEach(ee=>{L[ee.project_id]||(L[ee.project_id]={projectId:ee.project_id,projectName:ee.projects?.name||"Unknown Project",count:0}),L[ee.project_id].count+=1}),W=Object.values(L).sort((ee,oe)=>oe.count-ee.count),D=Y.length}}catch{console.log("Material requests table not available yet")}return{activeProjects:{count:n,list:a.map(Y=>({id:Y.id,name:Y.name,status:Y.status}))},totalContractValue:{total:i,breakdown:o},tmApproved:{total:b,count:w,breakdown:g},tmBilled:{total:T,count:R,breakdown:O},materialRequestsPending:{total:D,breakdown:W},revenueAtRisk:{total:F,breakdown:z}}}catch(e){return console.error("Error fetching dashboard metrics:",e),{activeProjects:{count:0,list:[]},totalContractValue:{total:0,breakdown:[]},tmApproved:{total:0,count:0,breakdown:[]},tmBilled:{total:0,count:0,breakdown:[]},materialRequestsPending:{total:0,breakdown:[]},revenueAtRisk:{total:0,breakdown:[]}}}},async getProjectSummaries(t){if(!Ke)return[];try{const{data:e,error:r}=await Re.from("projects").select("*").eq("company_id",t).order("created_at",{ascending:!1});if(r)throw r;return e?await Promise.all(e.map(async n=>{const{data:i}=await Re.from("areas").select("*").eq("project_id",n.id),o=i?.reduce((d,v)=>d+parseFloat(v.weight||0),0)||0,c=i?.filter(d=>d.status==="done").reduce((d,v)=>d+parseFloat(v.weight||0),0)||0,u=o>0?Math.round(c/o*100):0;let h="green";return u<30?h="red":u<70&&(h="yellow"),{...n,progress:u,crewToday:0,pendingItems:0,statusColor:h}})):[]}catch(e){return console.error("Error fetching project summaries:",e),[]}},async getNeedsAttention(t){return{pendingTM:[],pendingMaterials:[],missingReports:[],overBudget:[],unreadMessages:[]}},async getRecentActivity(t,e=20){return[]},async getNotificationRoles(t){if(!Ke)return[];try{const{data:e,error:r}=await Re.from("notification_roles").select("*").eq("company_id",t).order("role_name");if(r)throw r;return e||[]}catch(e){return console.error("Error fetching notification roles:",e),[]}},async getUsersByNotificationRole(t){if(!Ke)return[];try{const{data:e,error:r}=await Re.from("user_notification_roles").select(`
          *,
          users (id, email, name)
        `).eq("role_id",t);if(r)throw r;return e||[]}catch(e){return console.error("Error fetching users by role:",e),[]}},async getUserNotificationRoles(t){if(!Ke)return[];try{const{data:e,error:r}=await Re.from("user_notification_roles").select(`
          *,
          notification_roles (*)
        `).eq("user_id",t);if(r)throw r;return e||[]}catch(e){return console.error("Error fetching user roles:",e),[]}},async assignNotificationRole(t,e,r){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{error:a}=await Re.from("user_notification_roles").insert({user_id:t,role_id:e,assigned_by:r});if(a)throw a;return{success:!0}}catch(a){return console.error("Error assigning notification role:",a),{success:!1,error:a.message}}},async removeNotificationRole(t,e){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{error:r}=await Re.from("user_notification_roles").delete().eq("user_id",t).eq("role_id",e);if(r)throw r;return{success:!0}}catch(r){return console.error("Error removing notification role:",r),{success:!1,error:r.message}}},async createNotificationRole(t,e,r,a){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{data:n,error:i}=await Re.from("notification_roles").insert({company_id:t,role_name:e,role_key:r,description:a}).select().single();if(i)throw i;return{success:!0,data:n}}catch(n){return console.error("Error creating notification role:",n),{success:!1,error:n.message}}},async getNotificationTypes(){if(!Ke)return[];try{const{data:t,error:e}=await Re.from("notification_types").select("*").order("category",{ascending:!0}).order("type_name",{ascending:!0});if(e)throw e;return t||[]}catch(t){return console.error("Error fetching notification types:",t),[]}},async getNotificationPreferences(t,e){if(!Ke)return[];try{const{data:r,error:a}=await Re.from("notification_preferences").select(`
          *,
          notification_types (*)
        `).eq("user_id",t).eq("company_id",e);if(a)throw a;return r||[]}catch(r){return console.error("Error fetching notification preferences:",r),[]}},async updateNotificationPreference(t,e,r,a){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{error:n}=await Re.from("notification_preferences").upsert({user_id:t,company_id:e,notification_type_id:r,email_enabled:a.email_enabled,in_app_enabled:a.in_app_enabled,sms_enabled:a.sms_enabled||!1,updated_at:new Date().toISOString()});if(n)throw n;return{success:!0}}catch(n){return console.error("Error updating notification preference:",n),{success:!1,error:n.message}}},async createNotification(t,e,r,a,n,i,o){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{data:c}=await Re.from("notification_types").select("id").eq("type_key",e).single();if(!c)throw new Error(`Notification type ${e} not found`);const{data:u,error:h}=await Re.from("notifications").insert({company_id:t,notification_type_id:c.id,user_id:r,title:a,message:n,link_url:i,metadata:o||{}}).select().single();if(h)throw h;return{success:!0,data:u}}catch(c){return console.error("Error creating notification:",c),{success:!1,error:c.message}}},async getUnreadNotifications(t,e=50){if(!Ke)return[];try{const{data:r,error:a}=await Re.from("notifications").select(`
          *,
          notification_types (type_name, category)
        `).eq("user_id",t).eq("in_app_read",!1).order("created_at",{ascending:!1}).limit(e);if(a)throw a;return r||[]}catch(r){return console.error("Error fetching unread notifications:",r),[]}},async markNotificationRead(t){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{error:e}=await Re.from("notifications").update({in_app_read:!0,in_app_read_at:new Date().toISOString()}).eq("id",t);if(e)throw e;return{success:!0}}catch(e){return console.error("Error marking notification as read:",e),{success:!1,error:e.message}}},async markAllNotificationsRead(t){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{error:e}=await Re.from("notifications").update({in_app_read:!0,in_app_read_at:new Date().toISOString()}).eq("user_id",t).eq("in_app_read",!1);if(e)throw e;return{success:!0}}catch(e){return console.error("Error marking all notifications as read:",e),{success:!1,error:e.message}}},async getUsersForNotification(t,e,r){if(!Ke)return[];try{const{data:a}=await Re.from("notification_roles").select("id").eq("company_id",t).eq("role_key",r).single();if(!a)return[];const{data:n}=await Re.from("user_notification_roles").select(`
          user_id,
          users (id, email, name)
        `).eq("role_id",a.id);if(!n)return[];const{data:i}=await Re.from("notification_types").select("id").eq("type_key",e).single();return i?(await Promise.all(n.map(async c=>{const{data:u}=await Re.from("notification_preferences").select("email_enabled, in_app_enabled").eq("user_id",c.user_id).eq("company_id",t).eq("notification_type_id",i.id).single();return!u||u.email_enabled||u.in_app_enabled?c.users:null}))).filter(c=>c!==null):n.map(c=>c.users)}catch(a){return console.error("Error getting users for notification:",a),[]}},async getExternalRecipientsByRole(t){if(!Ke)return[];try{const{data:e,error:r}=await Re.from("external_notification_recipients").select("*").eq("role_id",t).order("email");if(r)throw r;return e||[]}catch(e){return console.error("Error fetching external recipients:",e),[]}},async addExternalRecipient(t,e,r,a,n){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{data:i,error:o}=await Re.from("external_notification_recipients").insert({role_id:t,email:e.toLowerCase().trim(),name:r?.trim()||null,notes:a?.trim()||null,created_by:n}).select().single();if(o)throw o;return{success:!0,data:i}}catch(i){return console.error("Error adding external recipient:",i),{success:!1,error:i.message}}},async removeExternalRecipient(t){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{error:e}=await Re.from("external_notification_recipients").delete().eq("id",t);if(e)throw e;return{success:!0}}catch(e){return console.error("Error removing external recipient:",e),{success:!1,error:e.message}}},async getAllRecipientsForNotification(t,e,r){if(!Ke)return{users:[],externalEmails:[]};try{const{data:a}=await Re.from("notification_roles").select("id").eq("company_id",t).eq("role_key",r).single();if(!a)return{users:[],externalEmails:[]};const n=await this.getUsersForNotification(t,e,r),{data:i}=await Re.from("external_notification_recipients").select("email, name").eq("role_id",a.id),o=i?.map(c=>({email:c.email,name:c.name||c.email}))||[];return{users:n,externalEmails:o}}catch(a){return console.error("Error getting all recipients:",a),{users:[],externalEmails:[]}}},async getProjectTeam(t){if(!Ke)return[];try{const{data:e,error:r}=await Re.from("project_users").select(`
          id,
          project_id,
          user_id,
          project_role,
          joined_at,
          invited_by,
          users:user_id (
            id,
            name,
            email,
            role
          )
        `).eq("project_id",t).order("joined_at");if(r)throw r;return e||[]}catch(e){return console.error("Error fetching project team:",e),[]}},async getUserProjectRole(t,e){if(!Ke)return null;try{const{data:r,error:a}=await Re.from("project_users").select("project_role").eq("user_id",t).eq("project_id",e).single();if(a)throw a;return r?.project_role||null}catch(r){return console.error("Error fetching user project role:",r),null}},async getUserProjects(t){if(!Ke)return[];try{const{data:e,error:r}=await Re.from("project_users").select(`
          id,
          project_role,
          joined_at,
          projects:project_id (
            id,
            name,
            location,
            status,
            created_at,
            companies:company_id (
              id,
              name
            )
          )
        `).eq("user_id",t).order("joined_at",{ascending:!1});if(r)throw r;return e||[]}catch(e){return console.error("Error fetching user projects:",e),[]}},async inviteUserToProject(t,e,r,a){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{data:n,error:i}=await Re.from("project_users").insert({project_id:t,user_id:e,project_role:r,invited_by:a}).select().single();if(i)throw i;return{success:!0,data:n}}catch(n){return console.error("Error inviting user to project:",n),{success:!1,error:n.message}}},async removeUserFromProject(t){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{error:e}=await Re.from("project_users").delete().eq("id",t);if(e)throw e;return{success:!0}}catch(e){return console.error("Error removing user from project:",e),{success:!1,error:e.message}}},async updateUserProjectRole(t,e){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{data:r,error:a}=await Re.from("project_users").update({project_role:e}).eq("id",t).select().single();if(a)throw a;return{success:!0,data:r}}catch(r){return console.error("Error updating user project role:",r),{success:!1,error:r.message}}},async getUserProjectPermissions(t,e){if(!Ke)return[];try{const{data:r,error:a}=await Re.from("project_users").select(`
          id,
          project_role,
          project_user_permissions (
            permission_key
          )
        `).eq("user_id",t).eq("project_id",e).single();if(a)throw a;return r?.project_role==="owner"||r?.project_role==="manager"?["*"]:r?.project_user_permissions?.map(n=>n.permission_key)||[]}catch(r){return console.error("Error fetching user project permissions:",r),[]}},async userHasProjectPermission(t,e,r){if(!Ke)return!1;try{const a=await this.getUserProjectPermissions(t,e);return a.includes("*")?!0:a.includes(r)}catch(a){return console.error("Error checking permission:",a),!1}},async grantProjectPermissions(t,e,r){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const a=e.map(o=>({project_user_id:t,permission_key:o,granted_by:r})),{data:n,error:i}=await Re.from("project_user_permissions").insert(a).select();if(i)throw i;return{success:!0,data:n}}catch(a){return console.error("Error granting permissions:",a),{success:!1,error:a.message}}},async revokeProjectPermissions(t,e){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{error:r}=await Re.from("project_user_permissions").delete().eq("project_user_id",t).in("permission_key",e);if(r)throw r;return{success:!0}}catch(r){return console.error("Error revoking permissions:",r),{success:!1,error:r.message}}},async setProjectPermissions(t,e,r){if(!Ke)return{success:!1,error:"Supabase not configured"};try{if(await Re.from("project_user_permissions").delete().eq("project_user_id",t),e.length>0){const a=e.map(o=>({project_user_id:t,permission_key:o,granted_by:r})),{data:n,error:i}=await Re.from("project_user_permissions").insert(a).select();if(i)throw i;return{success:!0,data:n}}return{success:!0}}catch(a){return console.error("Error setting permissions:",a),{success:!1,error:a.message}}},async getAllPermissions(){if(!Ke)return[];try{const{data:t,error:e}=await Re.from("project_permissions").select("*").order("category, permission_name");if(e)throw e;return t||[]}catch(t){return console.error("Error fetching permissions:",t),[]}},async getRoleTemplates(){if(!Ke)return[];try{const{data:t,error:e}=await Re.from("role_templates").select("*").order("role_name");if(e)throw e;return t||[]}catch(t){return console.error("Error fetching role templates:",t),[]}},async getRoleTemplate(t){if(!Ke)return null;try{const{data:e,error:r}=await Re.from("role_templates").select("*").eq("role_key",t).single();if(r)throw r;return e}catch(e){return console.error("Error fetching role template:",e),null}},async getProjectNotificationRoles(t){if(!Ke)return[];try{const{data:e,error:r}=await Re.from("notification_roles").select("*").eq("project_id",t).order("role_name");if(r)throw r;return e||[]}catch(e){return console.error("Error fetching project notification roles:",e),[]}},async createProjectNotificationRole(t,e,r,a){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{data:n,error:i}=await Re.from("notification_roles").insert({project_id:t,role_name:e,role_key:r,description:a}).select().single();if(i)throw i;return{success:!0,data:n}}catch(n){return console.error("Error creating project notification role:",n),{success:!1,error:n.message}}},async verifyCompanyOfficePin(t,e){if(!Ke)return null;try{const{data:r,error:a}=await Re.from("companies").select("id, name, field_code").ilike("name",t).eq("office_pin",e).single();if(a)throw a;return r}catch(r){return console.error("Error verifying company office PIN:",r),null}},async verifyFieldAccess(t,e){if(!Ke)return null;try{const{data:r,error:a}=await Re.from("projects").select(`
          id,
          name,
          company_id,
          companies (
            id,
            name
          )
        `).eq("companies.field_code",t).eq("pin",e).single();if(a)throw a;return{project_id:r.id,project_name:r.name,company_id:r.companies.id,company_name:r.companies.name}}catch(r){return console.error("Error verifying field access:",r),null}},async createOfficeUser({company_id:t,name:e,email:r,password:a,role:n}){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{data:i,error:o}=await Re.auth.signUp({email:r,password:a,options:{data:{name:e,role:n}}});if(o)throw o;const{data:c,error:u}=await Re.from("users").insert({id:i.user.id,company_id:t,name:e,email:r,role:n}).select().single();if(u)throw u;if(N1.length>0){const h=N1.map(v=>({user_id:i.user.id,company_id:v.id,role:n||"user"})),{error:d}=await Re.from("user_companies").insert(h);d&&console.warn("Could not add user to user_companies:",d)}return{success:!0,data:c}}catch(i){return console.error("Error creating office user:",i),{success:!1,error:i.message}}},async logFieldAccess({company_id:t,project_id:e,foreman_name:r,company_code_used:a,project_pin_used:n}){if(!Ke)return{success:!1};try{const{error:i}=await Re.from("field_access_log").insert({company_id:t,project_id:e,foreman_name:r,company_code_used:a,project_pin_used:n});if(i)throw i;return{success:!0}}catch(i){return console.error("Error logging field access:",i),{success:!1,error:i.message}}},async logFieldActivity({project_id:t,foreman_name:e,activity_type:r,activity_id:a,description:n}){if(!Ke)return{success:!1};try{const{error:i}=await Re.from("field_activity_log").insert({project_id:t,foreman_name:e,activity_type:r,activity_id:a,description:n});if(i)throw i;return{success:!0}}catch(i){return console.error("Error logging field activity:",i),{success:!1,error:i.message}}},async getFieldAccessHistory(t,e=50){if(!Ke)return[];try{const{data:r,error:a}=await Re.from("field_access_log").select("*").eq("project_id",t).order("accessed_at",{ascending:!1}).limit(e);if(a)throw a;return r||[]}catch(r){return console.error("Error fetching field access history:",r),[]}},async getFieldActivityHistory(t,e=100){if(!Ke)return[];try{const{data:r,error:a}=await Re.from("field_activity_log").select("*").eq("project_id",t).order("created_at",{ascending:!1}).limit(e);if(a)throw a;return r||[]}catch(r){return console.error("Error fetching field activity history:",r),[]}},async createCompanyWithAdmin({company_name:t,field_code:e,office_pin:r,admin_name:a,admin_email:n,admin_password:i}){if(!Ke)return{success:!1,error:"Supabase not configured"};try{const{data:o}=await Re.from("companies").select("id").eq("field_code",e).single();if(o)return{success:!1,error:"Field code already in use. Please choose another."};const{data:c}=await Re.from("companies").select("id").eq("office_pin",r).single();if(c)return{success:!1,error:"Office PIN already in use. Please generate a new one."};const{data:u,error:h}=await Re.from("companies").insert({name:t,field_code:e,office_pin:r}).select().single();if(h)throw h;const{data:d,error:v}=await Re.auth.signUp({email:n,password:i,options:{data:{name:a,role:"admin"}}});if(v)throw await Re.from("companies").delete().eq("id",u.id),v;const{error:y}=await Re.from("users").insert({id:d.user.id,company_id:u.id,name:a,email:n,role:"admin"});if(y)throw await Re.from("companies").delete().eq("id",u.id),y;if(N1.length>0){const g=N1.map(w=>({user_id:d.user.id,company_id:w.id,role:"admin"})),{error:b}=await Re.from("user_companies").insert(g);b&&console.warn("Could not add admin to user_companies:",b)}return{success:!0,company:u,admin:d.user}}catch(o){return console.error("Error creating company with admin:",o),{success:!1,error:o.message}}}},T4=ke.createContext(),Js={logo_url:null,favicon_url:null,login_background_url:null,primary_color:"#3B82F6",secondary_color:"#1E40AF",custom_app_name:"FieldSync",hide_fieldsync_branding:!1,email_from_name:"FieldSync",email_from_address:null,custom_domain:null,domain_verified:!1};function F0({children:t,companyId:e}){const[r,a]=ke.useState(Js),[n,i]=ke.useState(!0);ke.useEffect(()=>{e?o(e):c()},[e]),ke.useEffect(()=>{d(r)},[r]);const o=async g=>{try{if(i(!0),!Ke){a(Js),i(!1);return}const{data:b,error:w}=await Re.from("company_branding").select("*").eq("company_id",g).single();w?(w.code==="PGRST116"?await u(g):console.error("Error loading branding:",w),a(Js)):a({...Js,...b})}catch(b){console.error("Error in loadBranding:",b),a(Js)}finally{i(!1)}},c=async()=>{try{i(!0);const g=window.location.hostname;if(g==="localhost"||g==="127.0.0.1"){a(Js),i(!1);return}if(!Ke){a(Js),i(!1);return}const{data:b,error:w}=await Re.rpc("get_branding_by_domain",{domain_name:g});w||!b||b.length===0?a(Js):a({...Js,...b[0]})}catch(g){console.error("Error loading branding by domain:",g),a(Js)}finally{i(!1)}},u=async g=>{try{const{data:b,error:w}=await Re.from("company_branding").insert({company_id:g,...Js}).select().single();w&&console.error("Error creating default branding:",w)}catch(b){console.error("Error in createDefaultBranding:",b)}},h=async g=>{try{if(!Ke)return a(E=>({...E,...g})),{success:!0};if(!e)return{success:!1,error:"No company ID"};const{data:b,error:w}=await Re.from("company_branding").upsert({company_id:e,...g},{onConflict:"company_id"}).select().single();return w?(console.error("Error updating branding:",w),{success:!1,error:w.message}):(a({...Js,...b}),{success:!0,data:b})}catch(b){return console.error("Error in updateBranding:",b),{success:!1,error:b.message}}},d=g=>{const b=document.documentElement;if(b.style.setProperty("--primary-color",g.primary_color),b.style.setProperty("--secondary-color",g.secondary_color),g.favicon_url){let w=document.querySelector("link[rel*='icon']");w||(w=document.createElement("link"),w.rel="icon",document.head.appendChild(w)),w.href=g.favicon_url}document.title=g.custom_app_name||"FieldSync"},y={branding:r,loading:n,updateBranding:h,uploadBrandingImage:async(g,b)=>{try{if(!Ke)return{success:!0,url:URL.createObjectURL(g)};const w=g.name.split(".").pop(),A=`branding/${`${e}/${b}-${Date.now()}.${w}`}`,{data:O,error:T}=await Re.storage.from("public").upload(A,g,{cacheControl:"3600",upsert:!0});if(T)return console.error("Error uploading image:",T),{success:!1,error:T.message};const{data:{publicUrl:R}}=Re.storage.from("public").getPublicUrl(A);return{success:!0,url:R}}catch(w){return console.error("Error in uploadBrandingImage:",w),{success:!1,error:w.message}}},refreshBranding:()=>e?o(e):c()};return p.jsx(T4.Provider,{value:y,children:t})}function a2(){const t=ke.useContext(T4);if(!t)throw new Error("useBranding must be used within a BrandingProvider");return t}function Kc({className:t="",showPoweredBy:e=!1}){const{branding:r}=a2();return p.jsxs("div",{className:`app-logo ${t}`,children:[r.logo_url?p.jsx("img",{src:r.logo_url,alt:r.custom_app_name||"Logo",className:"custom-logo"}):p.jsx("div",{className:"logo",children:r.custom_app_name?r.custom_app_name:p.jsxs(p.Fragment,{children:["Field",p.jsx("span",{children:"Sync"})]})}),e&&!r.hide_fieldsync_branding&&p.jsx("div",{className:"powered-by",children:"Powered by FieldSync"})]})}function IN({onComplete:t,onShowToast:e}){const[r,a]=ke.useState(!1),[n,i]=ke.useState(""),[o,c]=ke.useState(""),[u,h]=ke.useState(""),[d,v]=ke.useState(""),[y,g]=ke.useState(""),[b,w]=ke.useState(""),E=()=>{const T=n.toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,10);c(T)},A=()=>{const T=Math.floor(1e3+Math.random()*9e3).toString();h(T)},O=async T=>{T.preventDefault(),a(!0);try{if(!o||!u){e?.("Please generate access codes","error"),a(!1);return}const R=await jt.createCompanyWithAdmin({company_name:n.trim(),field_code:o.trim().toUpperCase(),office_pin:u.trim(),admin_name:d.trim(),admin_email:y.trim().toLowerCase(),admin_password:b});R.success?(e?.("Company registered successfully! Check your email for details.","success"),t?.({company:R.company,codes:{field_code:o,office_pin:u}})):e?.(R.error||"Failed to register company","error")}catch(R){console.error("Error registering company:",R),e?.("Failed to register company","error")}finally{a(!1)}};return p.jsx("div",{className:"login-container",children:p.jsxs("div",{className:"login-card registration-card",children:[p.jsxs("div",{className:"login-header",children:[p.jsx("h1",{children:"FieldSync"}),p.jsx("h2",{children:"Register Your Company"}),p.jsx("p",{children:"Set up your company and create your admin account"})]}),p.jsxs("form",{onSubmit:O,className:"login-form",children:[p.jsxs("div",{className:"form-section",children:[p.jsx("h3",{children:"Company Information"}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Company Name *"}),p.jsx("input",{type:"text",value:n,onChange:T=>i(T.target.value),placeholder:"e.g., GGG Construction",required:!0,disabled:r,autoFocus:!0})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Field Code *"}),p.jsxs("div",{className:"input-with-button",children:[p.jsx("input",{type:"text",value:o,onChange:T=>c(T.target.value.toUpperCase()),placeholder:"e.g., GGG2024",required:!0,disabled:r,style:{textTransform:"uppercase"}}),p.jsx("button",{type:"button",onClick:E,className:"btn-secondary",disabled:r||!n,children:"Auto-Generate"})]}),p.jsx("small",{children:"Your foremen will use this code to access projects"})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Office PIN *"}),p.jsxs("div",{className:"input-with-button",children:[p.jsx("input",{type:"text",value:u,onChange:T=>h(T.target.value),placeholder:"e.g., 8765",maxLength:6,required:!0,disabled:r}),p.jsx("button",{type:"button",onClick:A,className:"btn-secondary",disabled:r,children:"Generate"})]}),p.jsx("small",{children:"Office staff will need this PIN to create accounts"})]})]}),p.jsxs("div",{className:"form-section",children:[p.jsx("h3",{children:"Your Admin Account"}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Your Name *"}),p.jsx("input",{type:"text",value:d,onChange:T=>v(T.target.value),placeholder:"John Smith",required:!0,disabled:r})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Email *"}),p.jsx("input",{type:"email",value:y,onChange:T=>g(T.target.value),placeholder:"john@company.com",required:!0,disabled:r})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Password *"}),p.jsx("input",{type:"password",value:b,onChange:T=>w(T.target.value),placeholder:"",minLength:6,required:!0,disabled:r}),p.jsx("small",{children:"At least 6 characters"})]})]}),p.jsx("button",{type:"submit",className:"btn-primary btn-block",disabled:r,children:r?"Creating Company...":"Create Company"})]}),p.jsx("div",{className:"login-footer",children:p.jsxs("p",{children:["Already have an account? ",p.jsx("a",{href:"/",children:"Sign in"})]})})]})})}function BN({company:t,codes:e,onContinue:r}){const[a,n]=ke.useState(!1),i=()=>{const o=`
FieldSync Access Codes for ${t.name}

Field Code (for foremen): ${e.field_code}
Office PIN (for office staff): ${e.office_pin}

Keep these codes secure!
    `.trim();navigator.clipboard.writeText(o),n(!0),setTimeout(()=>n(!1),2e3)};return p.jsx("div",{className:"login-container",children:p.jsxs("div",{className:"login-card success-card",children:[p.jsx("div",{className:"success-icon",children:""}),p.jsx("h1",{children:"Company Registered!"}),p.jsx("h2",{children:t.name}),p.jsxs("div",{className:"codes-display",children:[p.jsxs("div",{className:"code-box",children:[p.jsx("h3",{children:" Field Code"}),p.jsx("div",{className:"code",children:e.field_code}),p.jsx("small",{children:"Give this to your foremen"})]}),p.jsxs("div",{className:"code-box",children:[p.jsx("h3",{children:" Office PIN"}),p.jsx("div",{className:"code",children:e.office_pin}),p.jsx("small",{children:"Share this with office staff"})]})]}),p.jsxs("div",{className:"success-actions",children:[p.jsx("button",{onClick:i,className:"btn-secondary",children:a?" Copied!":"Copy Codes"}),p.jsx("button",{onClick:r,className:"btn-primary",children:"Continue to Dashboard"})]}),p.jsxs("div",{className:"success-message",children:[p.jsxs("p",{children:[p.jsx("strong",{children:"Important:"})," Save these codes! You'll need them to:"]}),p.jsxs("ul",{children:[p.jsx("li",{children:"Give Field Code to foremen for project access"}),p.jsx("li",{children:"Share Office PIN with office staff to create accounts"})]}),p.jsx("p",{children:"You can change these codes anytime in Company Settings."})]})]})})}function UN({onLogin:t,onShowToast:e}){const[r,a]=ke.useState(""),[n,i]=ke.useState(""),[o,c]=ke.useState(!1),u=async h=>{h.preventDefault(),c(!0);try{console.log("Attempting login for:",r);const{data:d,error:v}=await Re.auth.signInWithPassword({email:r.trim(),password:n});if(v){console.error("Auth error:",v),e?.(v.message||"Login failed","error"),c(!1);return}console.log("Auth successful, user ID:",d.user.id);const{data:y,error:g}=await Re.from("users").select("*").eq("id",d.user.id).single();if(g||!y){console.error("User error:",g),e?.("User profile not found","error"),c(!1);return}console.log("User found:",y);const{data:b,error:w}=await Re.from("companies").select("*").eq("id",y.company_id).single();if(w||!b){console.error("Company error:",w),e?.("Company not found","error"),c(!1);return}console.log("Company found:",b.name),t?.(y,b),e?.(`Welcome to ${b.name}!`,"success")}catch(d){console.error("Login exception:",d),e?.("Login failed - check console","error")}finally{c(!1)}};return p.jsx("div",{className:"login-container",children:p.jsxs("div",{className:"login-card",children:[p.jsxs("div",{className:"login-header",children:[p.jsx("h1",{children:"FieldSync"}),p.jsx("h2",{children:"Office Login"})]}),p.jsxs("form",{onSubmit:u,className:"login-form",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Email"}),p.jsx("input",{type:"email",value:r,onChange:h=>a(h.target.value),placeholder:"your@email.com",required:!0,autoFocus:!0,disabled:o})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Password"}),p.jsx("input",{type:"password",value:n,onChange:h=>i(h.target.value),placeholder:"",required:!0,disabled:o})]}),p.jsx("button",{type:"submit",className:"btn-primary btn-block",disabled:o,children:o?"Signing in...":"Sign In"})]}),p.jsx("div",{className:"login-footer",children:p.jsx("p",{children:p.jsxs("small",{children:["Field worker? ",p.jsx("a",{href:"/field",children:"Enter here"})]})})})]})})}function qN({onForemanAccess:t,onOfficeLogin:e,onShowToast:r}){const[a,n]=ke.useState(null),[i,o]=ke.useState(null),[c,u]=ke.useState(""),[h,d]=ke.useState(null),[v,y]=ke.useState(""),[g,b]=ke.useState(!1),[w,E]=ke.useState(1),[A,O]=ke.useState(null),[T,R]=ke.useState(""),[H,z]=ke.useState(""),[F,W]=ke.useState(""),D=Z=>{const Ne=Z.toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,20);u(Ne)},Y=async()=>{if(c.length<2){r("Enter company code","error");return}b(!0);try{const Z=await jt.getCompanyByCode(c);Z?d(Z):(r("Invalid company code","error"),u(""))}catch{r("Error checking code","error")}finally{b(!1)}},I=async Z=>{if(Z.length===4){b(!0);try{const Ne=await jt.getProjectByPinAndCompany(Z,h.id);Ne?t(Ne):(r("Invalid PIN","error"),y(""))}catch{r("Error checking PIN","error")}finally{b(!1)}}},L=Z=>{if(v.length<4){const Ne=v+Z;y(Ne),Ne.length===4&&setTimeout(()=>I(Ne),200)}},ee=()=>{y(Z=>Z.slice(0,-1))},oe=()=>{d(null),y("")},ge=async()=>{if(c.length<2){r("Enter company code","error");return}b(!0);try{const Z=await jt.getCompanyByCode(c);Z?(O(Z),E(2)):(r("Invalid company code","error"),u(""))}catch{r("Error checking code","error")}finally{b(!1)}},ie=async()=>{if(!T.trim()){r("Enter your name","error");return}if(!H.trim()||!H.includes("@")){r("Enter valid email","error");return}if(F.length<6){r("Password must be 6+ characters","error");return}b(!0);try{const{data:Z}=await Re.from("users").select("*").eq("email",H).single();if(Z){const{data:q}=await Re.from("user_companies").select("*").eq("user_id",Z.id).eq("company_id",A.id).single();if(q){r("You already belong to this company! Just sign in.","error"),n("office");return}const{error:K}=await Re.from("user_companies").insert({user_id:Z.id,company_id:A.id,role:"member"});if(K)throw K;r(`Added to ${A.name}! Sign in to continue.`,"success"),n("office");return}const{data:Ne,error:Q}=await Re.auth.signUp({email:H,password:F});if(Q)throw Q;const N=Ne.user?.id;if(!N)throw new Error("Failed to create user");const{error:M}=await Re.from("users").insert({id:N,email:H,password_hash:"managed_by_supabase_auth",name:T.trim(),company_id:A.id,role:"member",is_active:!0});if(M)throw M;const{error:B}=await Re.from("user_companies").insert({user_id:N,company_id:A.id,role:"member"});if(B)throw B;r("Account created! Logging you in...","success"),setTimeout(()=>{window.location.reload()},1e3)}catch(Z){console.error("Join error:",Z),r(Z.message||"Error creating account","error")}finally{b(!1)}},he=Z=>{o(Z),n("registration-success")},de=()=>{n("office"),r("Please sign in with your new account","info")};if(a===null)return p.jsx("div",{className:"entry-container",children:p.jsxs("div",{className:"entry-card",children:[p.jsx(Kc,{className:"entry-logo",showPoweredBy:!1}),p.jsxs("div",{className:"entry-buttons",children:[p.jsxs("button",{className:"entry-mode-btn foreman",onClick:()=>n("foreman"),children:[p.jsx("span",{className:"entry-mode-icon",children:""}),p.jsx("span",{className:"entry-mode-title",children:"Foreman"}),p.jsx("span",{className:"entry-mode-desc",children:"Enter project PIN"})]}),p.jsxs("button",{className:"entry-mode-btn office",onClick:()=>n("office"),children:[p.jsx("span",{className:"entry-mode-icon",children:""}),p.jsx("span",{className:"entry-mode-title",children:"Office"}),p.jsx("span",{className:"entry-mode-desc",children:"Sign in to dashboard"})]})]}),p.jsxs("div",{className:"entry-footer",children:[p.jsx("p",{className:"entry-footer-text",children:"New company?"}),p.jsx("button",{className:"entry-register-link",onClick:()=>n("register"),children:"Register here"})]})]})});if(a==="foreman")return h?p.jsx("div",{className:"entry-container",children:p.jsxs("div",{className:"entry-card",children:[p.jsx("button",{className:"entry-back",onClick:oe,children:""}),p.jsx(Kc,{className:"entry-logo",showPoweredBy:!1}),p.jsx("div",{className:"entry-company-badge",children:h.name}),p.jsx("p",{className:"entry-subtitle",children:"Enter project PIN"}),p.jsx("div",{className:"pin-display",children:[0,1,2,3].map(Z=>p.jsx("div",{className:`pin-dot ${v.length>Z?"filled":""}`,children:v.length>Z?"":""},Z))}),p.jsxs("div",{className:"number-pad",children:[[1,2,3,4,5,6,7,8,9].map(Z=>p.jsx("button",{className:"num-btn",onClick:()=>L(Z.toString()),disabled:g,children:Z},Z)),p.jsx("button",{className:"num-btn empty",disabled:!0}),p.jsx("button",{className:"num-btn",onClick:()=>L("0"),disabled:g,children:"0"}),p.jsx("button",{className:"num-btn backspace",onClick:ee,disabled:g||v.length===0,children:""})]}),g&&p.jsx("div",{className:"entry-loading",children:p.jsx("div",{className:"spinner"})})]})}):p.jsx("div",{className:"entry-container",children:p.jsxs("div",{className:"entry-card",children:[p.jsx("button",{className:"entry-back",onClick:()=>n(null),children:""}),p.jsx(Kc,{className:"entry-logo",showPoweredBy:!1}),p.jsx("p",{className:"entry-subtitle",children:"Enter company code"}),p.jsxs("div",{className:"entry-input-group",children:[p.jsx("input",{type:"text",value:c,onChange:Z=>D(Z.target.value),placeholder:"Company Code",disabled:g,autoFocus:!0,onKeyDown:Z=>{Z.key==="Enter"&&Y()}}),p.jsx("button",{className:"entry-submit-btn",onClick:Y,disabled:g||c.length<2,children:g?"...":""})]})]})});if(a==="office")return p.jsxs(p.Fragment,{children:[p.jsx("button",{className:"entry-back-fixed",onClick:()=>n(null),style:{position:"fixed",top:"2rem",left:"2rem",background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"8px",padding:"0.5rem 1rem",cursor:"pointer",fontSize:"1rem",zIndex:1e3},children:" Back"}),p.jsx(UN,{onLogin:e,onShowToast:r})]});if(a==="register")return p.jsxs(p.Fragment,{children:[p.jsx("button",{className:"entry-back-fixed",onClick:()=>n(null),style:{position:"fixed",top:"2rem",left:"2rem",background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"8px",padding:"0.5rem 1rem",cursor:"pointer",fontSize:"1rem",zIndex:1e3},children:" Back"}),p.jsx(IN,{onComplete:he,onShowToast:r})]});if(a==="registration-success"&&i)return p.jsx(BN,{company:i.company,codes:i.codes,onContinue:de});if(a==="join")return w===1?p.jsx("div",{className:"entry-container",children:p.jsxs("div",{className:"entry-card",children:[p.jsx("button",{className:"entry-back",onClick:()=>n("office"),children:""}),p.jsx(Kc,{className:"entry-logo",showPoweredBy:!1}),p.jsx("p",{className:"entry-subtitle",children:"Enter your company code"}),p.jsx("p",{className:"entry-hint",children:"Ask your manager or admin for the code"}),p.jsxs("div",{className:"entry-input-group",children:[p.jsx("input",{type:"text",value:c,onChange:Z=>D(Z.target.value),placeholder:"Company Code",disabled:g,autoFocus:!0,onKeyDown:Z=>{Z.key==="Enter"&&ge()}}),p.jsx("button",{className:"entry-submit-btn",onClick:ge,disabled:g||c.length<2,children:g?"...":""})]})]})}):p.jsx("div",{className:"entry-container",children:p.jsxs("div",{className:"entry-card",children:[p.jsx("button",{className:"entry-back",onClick:()=>{E(1),O(null)},children:""}),p.jsx(Kc,{className:"entry-logo",showPoweredBy:!1}),p.jsx("div",{className:"entry-company-badge",children:A?.name}),p.jsx("p",{className:"entry-subtitle",children:"Create your account"}),p.jsxs("div",{className:"entry-form",children:[p.jsx("input",{type:"text",value:T,onChange:Z=>R(Z.target.value),placeholder:"Your Name",autoFocus:!0}),p.jsx("input",{type:"email",value:H,onChange:Z=>z(Z.target.value),placeholder:"Email"}),p.jsx("input",{type:"password",value:F,onChange:Z=>W(Z.target.value),placeholder:"Password (6+ characters)",onKeyDown:Z=>{Z.key==="Enter"&&ie()}}),p.jsx("button",{className:"entry-login-btn",onClick:ie,disabled:g,children:g?"Creating...":"Join Company"})]}),p.jsx("p",{className:"entry-join-note",children:"You'll join as a team member. Your admin can update your role."})]})})}function Kl(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}function j4(t){if(!t||t.length===0)return 0;let e=0;return t.forEach(r=>{r.status==="done"&&(e+=r.weight)}),Math.round(e)}function zN(t){return t==="not_started"?"Not Started":t==="working"?"Working":t==="done"?"Done":t}const W_=["Containment","PPE","Disposal","Equipment"];function HN({project:t,companyId:e,maxPhotos:r=3,onSubmit:a,onCancel:n,onShowToast:i}){const[o,c]=ke.useState(1),[u,h]=ke.useState(new Date().toISOString().split("T")[0]),[d,v]=ke.useState(""),[y,g]=ke.useState(""),[b,w]=ke.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}]),[E,A]=ke.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}]),[O,T]=ke.useState([]),[R,H]=ke.useState(""),[z,F]=ke.useState([]),[W,D]=ke.useState(!1),[Y,I]=ke.useState([]),[L,ee]=ke.useState(!1),[oe,ge]=ke.useState(null),[ie,he]=ke.useState([]),[de,Z]=ke.useState(!1),[Ne,Q]=ke.useState(!1),[N,M]=ke.useState({name:"",category:"",quantity:""});ke.useEffect(()=>{B()},[t.id]);const B=async()=>{try{const Oe=await jt.getCrewCheckin(t.id);Oe?.workers&&I(Oe.workers)}catch(Oe){console.error("Error loading crew:",Oe)}};ke.useEffect(()=>{oe&&e&&q(oe)},[oe,e]);const q=async Oe=>{Z(!0);try{const Ye=await jt.getMaterialsEquipmentByCategory(e,Oe);he(Ye)}catch(Ye){console.error("Error loading items:",Ye),i("Error loading items","error")}finally{Z(!1)}},K=()=>{w([...b,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}])},se=(Oe,Ye,He)=>{w(b.map((ct,mt)=>mt===Oe?{...ct,[Ye]:He}:ct))},me=Oe=>{b.length>1?w(b.filter((Ye,He)=>He!==Oe)):w([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}])},we=()=>{A([...E,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},Se=(Oe,Ye,He)=>{A(E.map((ct,mt)=>mt===Oe?{...ct,[Ye]:He}:ct))},Ee=Oe=>{E.length>1?A(E.filter((Ye,He)=>He!==Oe)):A([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},ae=Oe=>{const Ye=O.findIndex(He=>He.material_equipment_id===Oe.id);Ye>=0?T(O.map((He,ct)=>ct===Ye?{...He,quantity:He.quantity+1}:He)):T([...O,{material_equipment_id:Oe.id,name:Oe.name,unit:Oe.unit,category:Oe.category,quantity:1,isCustom:!1}]),i(`Added ${Oe.name}`,"success")},rt=()=>{if(!N.name||!N.category||!N.quantity){i("Fill in all fields","error");return}T([...O,{material_equipment_id:null,custom_name:N.name,custom_category:N.category,name:N.name,category:N.category,quantity:parseFloat(N.quantity),unit:"each",isCustom:!0}]),M({name:"",category:"",quantity:""}),Q(!1),ge(null),i("Custom item added","success")},Je=(Oe,Ye)=>{const He=parseFloat(Ye)||0;He<=0?V(Oe):T(O.map((ct,mt)=>mt===Oe?{...ct,quantity:He}:ct))},V=Oe=>{T(O.filter((Ye,He)=>He!==Oe))},Ie=Oe=>{const Ye=Array.from(Oe.target.files);if(Ye.length===0)return;const He=r===-1?1/0:r-z.length;if(He<=0){i(`Photo limit reached (${r} max)`,"error"),Oe.target.value="";return}const ct=Ye.slice(0,He);ct.length<Ye.length&&i(`Only ${ct.length} photo(s) added (${r} max)`,"error"),ct.forEach(mt=>{if(!mt.type.startsWith("image/")){i("Please select an image file","error");return}const Ht=URL.createObjectURL(mt);F(Rt=>[...Rt,{id:Date.now()+Math.random(),file:mt,previewUrl:Ht,name:mt.name}])}),Oe.target.value=""},Le=Oe=>{const Ye=z.find(He=>He.id===Oe);Ye?.previewUrl&&URL.revokeObjectURL(Ye.previewUrl),F(z.filter(He=>He.id!==Oe))},gt=()=>{if(o===1){const Oe=b.some(He=>He.name.trim()&&(parseFloat(He.hours)>0||parseFloat(He.overtimeHours)>0)),Ye=E.some(He=>He.name.trim()&&(parseFloat(He.hours)>0||parseFloat(He.overtimeHours)>0));return Oe||Ye}return!0},et=()=>{o<3&&c(o+1)},wt=()=>{oe?(ge(null),Q(!1)):Ne?Q(!1):o>1?c(o-1):n()},vt=async()=>{if(!y.trim()){i("Enter your name to submit","error");return}const Oe=b.filter(He=>He.name.trim()&&(parseFloat(He.hours)>0||parseFloat(He.overtimeHours)>0)),Ye=E.filter(He=>He.name.trim()&&(parseFloat(He.hours)>0||parseFloat(He.overtimeHours)>0));if(Oe.length===0&&Ye.length===0){i("Add at least one worker","error");return}D(!0);try{const He=await jt.createTMTicket({project_id:t.id,work_date:u,ce_pco_number:d.trim()||null,notes:R.trim()||null,photos:[],created_by_name:y.trim()}),ct=[];for(const Ht of z)try{const Rt=await jt.uploadPhoto(e,t.id,He.id,Ht.file);Rt&&ct.push(Rt)}catch(Rt){console.error("Error uploading photo:",Rt)}ct.length>0&&await jt.updateTMTicketPhotos(He.id,ct);const mt=[...Oe.map(Ht=>({name:Ht.name.trim(),hours:parseFloat(Ht.hours)||0,overtime_hours:parseFloat(Ht.overtimeHours)||0,time_started:Ht.timeStarted||null,time_ended:Ht.timeEnded||null,role:Ht.role})),...Ye.map(Ht=>({name:Ht.name.trim(),hours:parseFloat(Ht.hours)||0,overtime_hours:parseFloat(Ht.overtimeHours)||0,time_started:Ht.timeStarted||null,time_ended:Ht.timeEnded||null,role:"Laborer"}))];await jt.addTMWorkers(He.id,mt),O.length>0&&await jt.addTMItems(He.id,O.map(Ht=>({material_equipment_id:Ht.material_equipment_id,custom_name:Ht.custom_name||null,custom_category:Ht.custom_category||null,quantity:Ht.quantity}))),z.forEach(Ht=>{Ht.previewUrl&&URL.revokeObjectURL(Ht.previewUrl)}),i("T&M submitted!","success"),a()}catch(He){console.error("Error submitting T&M:",He),i("Error submitting T&M","error")}finally{D(!1)}},Ct=b.filter(Oe=>Oe.name.trim()&&(parseFloat(Oe.hours)>0||parseFloat(Oe.overtimeHours)>0)),Et=E.filter(Oe=>Oe.name.trim()&&(parseFloat(Oe.hours)>0||parseFloat(Oe.overtimeHours)>0)),It=Ct.length+Et.length,er=[...Ct,...Et].reduce((Oe,Ye)=>Oe+parseFloat(Ye.hours||0),0),Vt=[...Ct,...Et].reduce((Oe,Ye)=>Oe+parseFloat(Ye.overtimeHours||0),0);return O.reduce((Oe,Ye)=>Oe+Ye.quantity,0),o===2&&(oe||Ne)?p.jsxs("div",{className:"tm-wizard",children:[p.jsxs("div",{className:"tm-wizard-header",children:[p.jsx("button",{className:"tm-back-btn",onClick:wt,children:""}),p.jsx("h2",{children:Ne?"Add Custom Item":oe}),p.jsxs("div",{className:"tm-item-count",children:[O.length," items"]})]}),Ne?p.jsxs("div",{className:"tm-custom-form",children:[p.jsxs("div",{className:"tm-field",children:[p.jsx("label",{children:"Item Name"}),p.jsx("input",{type:"text",placeholder:"What did you use?",value:N.name,onChange:Oe=>M({...N,name:Oe.target.value}),autoFocus:!0})]}),p.jsxs("div",{className:"tm-field",children:[p.jsx("label",{children:"Category"}),p.jsx("div",{className:"tm-category-select",children:W_.map(Oe=>p.jsx("button",{className:`tm-cat-chip ${N.category===Oe?"active":""}`,onClick:()=>M({...N,category:Oe}),children:Oe},Oe))})]}),p.jsxs("div",{className:"tm-field",children:[p.jsx("label",{children:"Quantity"}),p.jsx("input",{type:"number",placeholder:"How many?",value:N.quantity,onChange:Oe=>M({...N,quantity:Oe.target.value})})]}),p.jsx("button",{className:"tm-big-btn primary",onClick:rt,children:"Add Custom Item"})]}):p.jsx("div",{className:"tm-item-grid",children:de?p.jsx("div",{className:"tm-loading",children:"Loading..."}):p.jsxs(p.Fragment,{children:[ie.map(Oe=>{const Ye=O.find(He=>He.material_equipment_id===Oe.id);return p.jsxs("button",{className:`tm-item-card ${Ye?"added":""}`,onClick:()=>ae(Oe),children:[p.jsx("span",{className:"tm-item-name",children:Oe.name}),p.jsx("span",{className:"tm-item-unit",children:Oe.unit}),Ye&&p.jsx("span",{className:"tm-item-badge",children:Ye.quantity})]},Oe.id)}),p.jsxs("button",{className:"tm-item-card custom",onClick:()=>Q(!0),children:[p.jsx("span",{className:"tm-item-name",children:"+ Add Other"}),p.jsx("span",{className:"tm-item-unit",children:"Not on list"})]})]})}),!Ne&&O.length>0&&p.jsx("div",{className:"tm-wizard-footer",children:p.jsxs("button",{className:"tm-big-btn primary",onClick:()=>ge(null),children:["Done Adding (",O.length," items)"]})})]}):p.jsxs("div",{className:"tm-wizard",children:[p.jsxs("div",{className:"tm-wizard-header",children:[p.jsx("button",{className:"tm-back-btn",onClick:wt,children:""}),p.jsxs("h2",{children:[o===1&&"Workers",o===2&&"Materials & Equipment",o===3&&"Review"]}),p.jsxs("div",{className:"tm-step-dots",children:[p.jsx("span",{className:`tm-dot ${o>=1?"active":""}`}),p.jsx("span",{className:`tm-dot ${o>=2?"active":""}`}),p.jsx("span",{className:`tm-dot ${o>=3?"active":""}`})]})]}),o===1&&p.jsxs("div",{className:"tm-step-content",children:[p.jsxs("div",{className:"tm-project-info",children:[t.job_number&&p.jsxs("div",{className:"tm-project-detail",children:[p.jsx("span",{className:"tm-project-label",children:"Job #"}),p.jsx("span",{className:"tm-project-value",children:t.job_number})]}),p.jsxs("div",{className:"tm-project-detail",children:[p.jsx("span",{className:"tm-project-label",children:"Project"}),p.jsx("span",{className:"tm-project-value",children:t.name})]}),t.address&&p.jsxs("div",{className:"tm-project-detail",children:[p.jsx("span",{className:"tm-project-label",children:"Address"}),p.jsx("span",{className:"tm-project-value",children:t.address})]}),t.general_contractor&&p.jsxs("div",{className:"tm-project-detail",children:[p.jsx("span",{className:"tm-project-label",children:"GC"}),p.jsx("span",{className:"tm-project-value",children:t.general_contractor})]})]}),p.jsxs("div",{className:"tm-field-row",children:[p.jsxs("div",{className:"tm-field tm-field-half",children:[p.jsx("label",{children:"Date"}),p.jsx("input",{type:"date",value:u,onChange:Oe=>h(Oe.target.value),className:"tm-date"})]}),p.jsxs("div",{className:"tm-field tm-field-half",children:[p.jsx("label",{children:"CE / PCO #"}),p.jsx("input",{type:"text",placeholder:"Change Event / PCO",value:d,onChange:Oe=>v(Oe.target.value),className:"tm-input"})]})]}),Y.length>0&&p.jsxs("div",{className:"tm-crew-picker",children:[p.jsxs("button",{className:"tm-crew-picker-btn",onClick:()=>ee(!L),children:[" ",L?"Hide":"Select from"," Today's Crew (",Y.length,")"]}),L&&p.jsx("div",{className:"tm-crew-list",children:Y.map((Oe,Ye)=>{const He=b.some(ct=>ct.name.toLowerCase()===Oe.name.toLowerCase())||E.some(ct=>ct.name.toLowerCase()===Oe.name.toLowerCase());return p.jsxs("button",{className:`tm-crew-item ${He?"added":""}`,onClick:()=>{if(!He){if(Oe.role==="Foreman"||Oe.role==="Supervisor"){const ct=b.findIndex(mt=>!mt.name.trim());ct>=0?se(ct,"name",Oe.name):w([...b,{name:Oe.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:Oe.role==="Supervisor"?"Superintendent":"Foreman"}])}else{const ct=E.findIndex(mt=>!mt.name.trim());ct>=0?Se(ct,"name",Oe.name):A([...E,{name:Oe.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])}i(`Added ${Oe.name}`,"success")}},disabled:He,children:[p.jsx("span",{className:"tm-crew-item-name",children:Oe.name}),p.jsx("span",{className:`tm-crew-item-role ${Oe.role.toLowerCase()}`,children:Oe.role}),He&&p.jsx("span",{className:"tm-crew-item-check",children:""})]},Ye)})})]}),p.jsxs("div",{className:"tm-field",children:[p.jsx("label",{children:"Supervision"}),p.jsx("div",{className:"tm-workers-list",children:b.map((Oe,Ye)=>p.jsxs("div",{className:"tm-worker-card-expanded",children:[p.jsxs("div",{className:"tm-worker-row-top",children:[p.jsx("div",{className:"tm-role-select",children:p.jsxs("select",{value:Oe.role,onChange:He=>se(Ye,"role",He.target.value),children:[p.jsx("option",{value:"Foreman",children:"Foreman"}),p.jsx("option",{value:"Superintendent",children:"Superintendent"})]})}),p.jsx("input",{type:"text",placeholder:"First & Last Name",value:Oe.name,onChange:He=>se(Ye,"name",He.target.value),className:"tm-worker-input"}),p.jsx("button",{className:"tm-remove",onClick:()=>me(Ye),children:""})]}),p.jsxs("div",{className:"tm-worker-row-bottom",children:[p.jsxs("div",{className:"tm-time-group",children:[p.jsx("label",{children:"Start"}),p.jsx("input",{type:"time",value:Oe.timeStarted,onChange:He=>se(Ye,"timeStarted",He.target.value)})]}),p.jsxs("div",{className:"tm-time-group",children:[p.jsx("label",{children:"End"}),p.jsx("input",{type:"time",value:Oe.timeEnded,onChange:He=>se(Ye,"timeEnded",He.target.value)})]}),p.jsxs("div",{className:"tm-time-group",children:[p.jsx("label",{children:"Reg Hrs"}),p.jsx("input",{type:"number",placeholder:"0",value:Oe.hours,onChange:He=>se(Ye,"hours",He.target.value)})]}),p.jsxs("div",{className:"tm-time-group",children:[p.jsx("label",{children:"OT Hrs"}),p.jsx("input",{type:"number",placeholder:"0",value:Oe.overtimeHours,onChange:He=>se(Ye,"overtimeHours",He.target.value)})]})]})]},Ye))}),p.jsx("button",{className:"tm-add-btn",onClick:K,children:"+ Add Supervision"})]}),p.jsxs("div",{className:"tm-field",children:[p.jsx("label",{children:"Laborers"}),p.jsx("div",{className:"tm-workers-list",children:E.map((Oe,Ye)=>p.jsxs("div",{className:"tm-worker-card-expanded",children:[p.jsxs("div",{className:"tm-worker-row-top",children:[p.jsx("input",{type:"text",placeholder:"First & Last Name",value:Oe.name,onChange:He=>Se(Ye,"name",He.target.value),className:"tm-worker-input"}),p.jsx("button",{className:"tm-remove",onClick:()=>Ee(Ye),children:""})]}),p.jsxs("div",{className:"tm-worker-row-bottom",children:[p.jsxs("div",{className:"tm-time-group",children:[p.jsx("label",{children:"Start"}),p.jsx("input",{type:"time",value:Oe.timeStarted,onChange:He=>Se(Ye,"timeStarted",He.target.value)})]}),p.jsxs("div",{className:"tm-time-group",children:[p.jsx("label",{children:"End"}),p.jsx("input",{type:"time",value:Oe.timeEnded,onChange:He=>Se(Ye,"timeEnded",He.target.value)})]}),p.jsxs("div",{className:"tm-time-group",children:[p.jsx("label",{children:"Reg Hrs"}),p.jsx("input",{type:"number",placeholder:"0",value:Oe.hours,onChange:He=>Se(Ye,"hours",He.target.value)})]}),p.jsxs("div",{className:"tm-time-group",children:[p.jsx("label",{children:"OT Hrs"}),p.jsx("input",{type:"number",placeholder:"0",value:Oe.overtimeHours,onChange:He=>Se(Ye,"overtimeHours",He.target.value)})]})]})]},Ye))}),p.jsx("button",{className:"tm-add-btn",onClick:we,children:"+ Add Laborer"})]}),p.jsxs("div",{className:"tm-field",children:[p.jsx("label",{children:"Description of Work"}),p.jsx("textarea",{placeholder:"What work was performed today?",value:R,onChange:Oe=>H(Oe.target.value),rows:3,className:"tm-description"})]}),p.jsxs("div",{className:"tm-field",children:[p.jsxs("label",{children:[" Photos",r!==-1&&p.jsxs("span",{className:"tm-photo-count",children:["(",z.length,"/",r,")"]})]}),z.length>0&&p.jsx("div",{className:"tm-photo-grid",children:z.map(Oe=>p.jsxs("div",{className:"tm-photo-item",children:[p.jsx("img",{src:Oe.previewUrl,alt:Oe.name}),p.jsx("button",{className:"tm-photo-remove",onClick:()=>Le(Oe.id),children:""})]},Oe.id))}),(r===-1||z.length<r)&&p.jsxs("label",{className:"tm-photo-btn",children:[p.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:Ie,style:{display:"none"}})," ",z.length>0?"Add More Photos":"Add Photos"]}),r!==-1&&z.length>=r&&p.jsxs("div",{className:"tm-photo-limit-reached",children:["Photo limit reached (",r," max)"]})]})]}),o===2&&!oe&&p.jsxs("div",{className:"tm-step-content",children:[p.jsxs("div",{className:"tm-field",children:[p.jsx("label",{children:"What was used?"}),p.jsx("div",{className:"tm-category-grid",children:W_.map(Oe=>{const Ye=O.filter(He=>He.category===Oe);return p.jsxs("button",{className:"tm-category-card",onClick:()=>ge(Oe),children:[p.jsx("span",{className:"tm-cat-name",children:Oe}),Ye.length>0&&p.jsx("span",{className:"tm-cat-count",children:Ye.length})]},Oe)})})]}),O.length>0&&p.jsxs("div",{className:"tm-field",children:[p.jsxs("label",{children:["Added Items (",O.length,")"]}),p.jsx("div",{className:"tm-added-list",children:O.map((Oe,Ye)=>p.jsxs("div",{className:"tm-added-item",children:[p.jsxs("div",{className:"tm-added-info",children:[Oe.isCustom&&p.jsx("span",{className:"tm-custom-badge",children:"Custom"}),p.jsx("span",{className:"tm-added-name",children:Oe.name})]}),p.jsxs("div",{className:"tm-added-qty",children:[p.jsx("button",{onClick:()=>Je(Ye,Oe.quantity-1),children:""}),p.jsx("span",{children:Oe.quantity}),p.jsx("button",{onClick:()=>Je(Ye,Oe.quantity+1),children:"+"})]})]},Ye))})]})]}),o===3&&p.jsxs("div",{className:"tm-step-content",children:[p.jsx("div",{className:"tm-review-section",children:p.jsxs("div",{className:"tm-review-header",children:[p.jsx("span",{children:" Date"}),p.jsx("span",{children:new Date(u).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})]})}),R&&p.jsxs("div",{className:"tm-review-section",children:[p.jsx("div",{className:"tm-review-header",children:p.jsx("span",{children:" Description"})}),p.jsx("div",{className:"tm-review-notes",children:R})]}),z.length>0&&p.jsxs("div",{className:"tm-review-section",children:[p.jsxs("div",{className:"tm-review-header",children:[p.jsx("span",{children:" Photos"}),p.jsx("span",{children:z.length})]}),p.jsx("div",{className:"tm-review-photos",children:z.map(Oe=>p.jsx("img",{src:Oe.previewUrl,alt:Oe.name},Oe.id))})]}),Ct.length>0&&p.jsxs("div",{className:"tm-review-section",children:[p.jsxs("div",{className:"tm-review-header",children:[p.jsx("span",{children:" Supervision"}),p.jsxs("span",{children:[Ct.reduce((Oe,Ye)=>Oe+parseFloat(Ye.hours||0)+parseFloat(Ye.overtimeHours||0),0)," hrs"]})]}),p.jsx("div",{className:"tm-review-list",children:Ct.map((Oe,Ye)=>p.jsxs("div",{className:"tm-review-row-detailed",children:[p.jsxs("div",{className:"tm-review-worker-name",children:[p.jsx("span",{className:"tm-role-badge",children:Oe.role})," ",Oe.name]}),p.jsxs("div",{className:"tm-review-worker-details",children:[Oe.timeStarted&&Oe.timeEnded&&p.jsxs("span",{className:"tm-review-time",children:[Oe.timeStarted," - ",Oe.timeEnded]}),p.jsxs("span",{className:"tm-review-hours",children:[Oe.hours||0," reg",parseFloat(Oe.overtimeHours)>0?` + ${Oe.overtimeHours} OT`:""]})]})]},Ye))})]}),Et.length>0&&p.jsxs("div",{className:"tm-review-section",children:[p.jsxs("div",{className:"tm-review-header",children:[p.jsx("span",{children:" Laborers"}),p.jsxs("span",{children:[Et.reduce((Oe,Ye)=>Oe+parseFloat(Ye.hours||0)+parseFloat(Ye.overtimeHours||0),0)," hrs"]})]}),p.jsx("div",{className:"tm-review-list",children:Et.map((Oe,Ye)=>p.jsxs("div",{className:"tm-review-row-detailed",children:[p.jsx("div",{className:"tm-review-worker-name",children:Oe.name}),p.jsxs("div",{className:"tm-review-worker-details",children:[Oe.timeStarted&&Oe.timeEnded&&p.jsxs("span",{className:"tm-review-time",children:[Oe.timeStarted," - ",Oe.timeEnded]}),p.jsxs("span",{className:"tm-review-hours",children:[Oe.hours||0," reg",parseFloat(Oe.overtimeHours)>0?` + ${Oe.overtimeHours} OT`:""]})]})]},Ye))})]}),O.length>0&&p.jsxs("div",{className:"tm-review-section",children:[p.jsxs("div",{className:"tm-review-header",children:[p.jsx("span",{children:" Materials & Equipment"}),p.jsxs("span",{children:[O.length," items"]})]}),p.jsx("div",{className:"tm-review-list",children:O.map((Oe,Ye)=>p.jsxs("div",{className:"tm-review-row",children:[p.jsxs("span",{children:[Oe.isCustom&&" ",Oe.name]}),p.jsxs("span",{children:[Oe.quantity," ",Oe.unit]})]},Ye))})]}),p.jsxs("div",{className:"tm-review-section tm-certification",children:[p.jsx("div",{className:"tm-review-header",children:p.jsx("span",{children:" Submitted By"})}),p.jsx("input",{type:"text",className:"tm-certification-input",placeholder:"Enter your name",value:y,onChange:Oe=>g(Oe.target.value)}),p.jsx("p",{className:"tm-certification-note",children:"By submitting, you certify this T&M is accurate."})]})]}),p.jsxs("div",{className:"tm-wizard-footer",children:[o<3?p.jsx("button",{className:"tm-big-btn primary",onClick:et,disabled:o===1&&!gt(),children:o===1?`Next: Materials (${It} workers, ${er+Vt} hrs)`:o===2?`Review (${O.length} items)`:"Next"}):p.jsx("button",{className:"tm-big-btn submit",onClick:vt,disabled:W,children:W?"Submitting...":" Submit T&M"}),o===2&&p.jsx("button",{className:"tm-skip-btn",onClick:et,children:"Skip (no materials)"})]})]})}var hp={};hp.version="0.18.5";var C4=1252,WN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],n2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},i2=function(t){WN.indexOf(t)!=-1&&(C4=n2[0]=t)};function VN(){i2(1252)}var Uo=function(t){i2(t)};function s2(){Uo(1200),VN()}function V_(t){for(var e=[],r=0,a=t.length;r<a;++r)e[r]=t.charCodeAt(r);return e}function GN(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function O4(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var B0=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?GN(t.slice(2)):e==254&&r==255?O4(t.slice(2)):e==65279?t.slice(1):t},C1=function(e){return String.fromCharCode(e)},G_=function(e){return String.fromCharCode(e)},td,Jc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function rd(t){for(var e="",r=0,a=0,n=0,i=0,o=0,c=0,u=0,h=0;h<t.length;)r=t.charCodeAt(h++),i=r>>2,a=t.charCodeAt(h++),o=(r&3)<<4|a>>4,n=t.charCodeAt(h++),c=(a&15)<<2|n>>6,u=n&63,isNaN(a)?c=u=64:isNaN(n)&&(u=64),e+=Jc.charAt(i)+Jc.charAt(o)+Jc.charAt(c)+Jc.charAt(u);return e}function Ls(t){var e="",r=0,a=0,n=0,i=0,o=0,c=0,u=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)i=Jc.indexOf(t.charAt(h++)),o=Jc.indexOf(t.charAt(h++)),r=i<<2|o>>4,e+=String.fromCharCode(r),c=Jc.indexOf(t.charAt(h++)),a=(o&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(a)),u=Jc.indexOf(t.charAt(h++)),n=(c&3)<<6|u,u!==64&&(e+=String.fromCharCode(n));return e}var Cr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),oc=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function eu(t){return Cr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function $_(t){return Cr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Os=function(e){return Cr?oc(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Dp(t){if(typeof ArrayBuffer>"u")return Os(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),a=0;a!=t.length;++a)r[a]=t.charCodeAt(a)&255;return e}function iu(t){if(Array.isArray(t))return t.map(function(a){return String.fromCharCode(a)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function $N(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function o2(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return o2(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Jn=Cr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:oc(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var a=new Uint8Array(r),n=0;for(e=0,r=0;e<t.length;r+=n,++e)if(n=t[e].length,t[e]instanceof Uint8Array)a.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";a.set(new Uint8Array(t[e]),r)}return a}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function XN(t){for(var e=[],r=0,a=t.length+250,n=eu(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=t.charCodeAt(++i)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|c>>6&15|(o&3)<<4,n[r++]=128|c&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>a&&(e.push(n.slice(0,r)),r=0,n=eu(65535),a=65530)}return e.push(n.slice(0,r)),Jn(e)}var qi=/\u0000/g,U0=/[\u0001-\u0006]/g;function Nh(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function qo(t,e){var r=""+t;return r.length>=e?r:ln("0",e-r.length)+r}function l2(t,e){var r=""+t;return r.length>=e?r:ln(" ",e-r.length)+r}function dp(t,e){var r=""+t;return r.length>=e?r:r+ln(" ",e-r.length)}function YN(t,e){var r=""+Math.round(t);return r.length>=e?r:ln("0",e-r.length)+r}function KN(t,e){var r=""+t;return r.length>=e?r:ln("0",e-r.length)+r}var X_=Math.pow(2,32);function fh(t,e){if(t>X_||t<-X_)return YN(t,e);var r=Math.round(t);return KN(r,e)}function pp(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Y_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],vg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function JN(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var fr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},K_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ZN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function mp(t,e,r){for(var a=t<0?-1:1,n=t*a,i=0,o=1,c=0,u=1,h=0,d=0,v=Math.floor(n);h<e&&(v=Math.floor(n),c=v*o+i,d=v*h+u,!(n-v<5e-8));)n=1/(n-v),i=o,o=c,u=h,h=d;if(d>e&&(h>e?(d=u,c=i):(d=h,c=o)),!r)return[0,a*c,d];var y=Math.floor(a*c/d);return[y,a*c-y*d,d]}function Xu(t,e,r){if(t>2958465||t<0)return null;var a=t|0,n=Math.floor(86400*(t-a)),i=0,o=[],c={D:a,T:n,u:86400*(t-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++n==86400&&(c.T=n=0,++a,++c.D)),a===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var u=new Date(1900,0,1);u.setDate(u.getDate()+a-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),a<60&&(i=(i+6)%7),r&&(i=n8(u,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=n%60,n=Math.floor(n/60),c.M=n%60,n=Math.floor(n/60),c.H=n,c.q=i,c}var F4=new Date(1899,11,31,0,0,0),QN=F4.getTime(),e8=new Date(1900,2,1,0,0,0);function R4(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=e8&&(r+=1440*60*1e3),(r-(QN+(t.getTimezoneOffset()-F4.getTimezoneOffset())*6e4))/(1440*60*1e3)}function c2(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function t8(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function r8(t){var e=t<0?12:11,r=c2(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function a8(t){var e=c2(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function ad(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=r8(t):e===10?r=t.toFixed(10).substr(0,12):r=a8(t),c2(t8(r.toUpperCase()))}function tf(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):ad(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return io(14,R4(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function n8(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function i8(t,e,r,a){var n="",i=0,o=0,c=r.y,u,h=0;switch(t){case 98:c=r.y+543;case 121:switch(e.length){case 1:case 2:u=c%100,h=2;break;default:u=c%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:u=r.m,h=e.length;break;case 3:return vg[r.m-1][1];case 5:return vg[r.m-1][0];default:return vg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:u=r.d,h=e.length;break;case 3:return Y_[r.q][0];default:return Y_[r.q][1]}break;case 104:switch(e.length){case 1:case 2:u=1+(r.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:u=r.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:u=r.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?qo(r.S,e.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),e==="s"?i===0?"0":""+i/o:(n=qo(i,2+a),e==="ss"?n.substr(0,2):"."+n.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:u=c,h=1;break}var d=h>0?qo(u,h):"";return d}function Zc(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,a=t.substr(0,r);r!=t.length;r+=e)a+=(a.length>0?",":"")+t.substr(r,e);return a}var L4=/%/g;function s8(t,e,r){var a=e.replace(L4,""),n=e.length-a.length;return rc(t,a,r*Math.pow(10,2*n))+ln("%",n)}function o8(t,e,r){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return rc(t,e.substr(0,a),r/Math.pow(10,3*(e.length-a)))}function D4(t,e){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+D4(t,-e);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(e/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,d){return u+h+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=e.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var P4=/# (\?+)( ?)\/( ?)(\d+)/;function l8(t,e,r){var a=parseInt(t[4],10),n=Math.round(e*a),i=Math.floor(n/a),o=n-i*a,c=a;return r+(i===0?"":""+i)+" "+(o===0?ln(" ",t[1].length+1+t[4].length):l2(o,t[1].length)+t[2]+"/"+t[3]+qo(c,t[4].length))}function c8(t,e,r){return r+(e===0?"":""+e)+ln(" ",t[1].length+2+t[4].length)}var M4=/^#*0*\.([0#]+)/,I4=/\).*[0#]/,B4=/\(###\) ###\\?-####/;function Bi(t){for(var e="",r,a=0;a!=t.length;++a)switch(r=t.charCodeAt(a)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function J_(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Z_(t,e){var r=t-Math.floor(t),a=Math.pow(10,e);return e<(""+Math.round(r*a)).length?0:Math.round(r*a)}function u8(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function f8(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Qs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(I4)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Qs("n",a,r):"("+Qs("n",a,-r)+")"}if(e.charCodeAt(e.length-1)===44)return o8(t,e,r);if(e.indexOf("%")!==-1)return s8(t,e,r);if(e.indexOf("E")!==-1)return D4(e,r);if(e.charCodeAt(0)===36)return"$"+Qs(t,e.substr(e.charAt(1)==" "?2:1),r);var n,i,o,c,u=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+fh(u,e.length);if(e.match(/^[#?]+$/))return n=fh(r,0),n==="0"&&(n=""),n.length>e.length?n:Bi(e.substr(0,e.length-n.length))+n;if(i=e.match(P4))return l8(i,u,h);if(e.match(/^#+0+$/))return h+fh(u,e.length-e.indexOf("0"));if(i=e.match(M4))return n=J_(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Bi(i[1])).replace(/\.$/,"."+Bi(i[1])).replace(/\.(\d*)$/,function(b,w){return"."+w+ln("0",Bi(i[1]).length-w.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return h+J_(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return h+Zc(fh(u,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Qs(t,e,-r):Zc(""+(Math.floor(r)+u8(r,i[1].length)))+"."+qo(Z_(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Qs(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Nh(Qs(t,e.replace(/[\\-]/g,""),r)),o=0,Nh(Nh(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<n.length?n.charAt(o++):b==="0"?"0":""}));if(e.match(B4))return n=Qs(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=mp(u,Math.pow(10,o)-1,!1),n=""+h,d=rc("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=dp(c[2],o),d.length<i[4].length&&(d=Bi(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=mp(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?l2(c[1],o)+i[2]+"/"+i[3]+dp(c[2],o):ln(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return n=fh(r,0),e.length<=n.length?n:Bi(e.substr(0,e.length-n.length))+n;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var v=e.indexOf(".")-o,y=e.length-n.length-v;return Bi(e.substr(0,v)+n+e.substr(e.length-y))}if(i=e.match(/^00,000\.([#0]*0)$/))return o=Z_(r,i[1].length),r<0?"-"+Qs(t,e,-r):Zc(f8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?qo(0,3-b.length):"")+b})+"."+qo(o,i[1].length);switch(e){case"###,##0.00":return Qs(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=Zc(fh(u,0));return g!=="0"?h+g:"";case"###,###.00":return Qs(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Qs(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function h8(t,e,r){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return rc(t,e.substr(0,a),r/Math.pow(10,3*(e.length-a)))}function d8(t,e,r){var a=e.replace(L4,""),n=e.length-a.length;return rc(t,a,r*Math.pow(10,2*n))+ln("%",n)}function U4(t,e){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+U4(t,-e);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(e/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,d){return u+h+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=e.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function pl(t,e,r){if(t.charCodeAt(0)===40&&!e.match(I4)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?pl("n",a,r):"("+pl("n",a,-r)+")"}if(e.charCodeAt(e.length-1)===44)return h8(t,e,r);if(e.indexOf("%")!==-1)return d8(t,e,r);if(e.indexOf("E")!==-1)return U4(e,r);if(e.charCodeAt(0)===36)return"$"+pl(t,e.substr(e.charAt(1)==" "?2:1),r);var n,i,o,c,u=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+qo(u,e.length);if(e.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>e.length?n:Bi(e.substr(0,e.length-n.length))+n;if(i=e.match(P4))return c8(i,u,h);if(e.match(/^#+0+$/))return h+qo(u,e.length-e.indexOf("0"));if(i=e.match(M4))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Bi(i[1])).replace(/\.$/,"."+Bi(i[1])),n=n.replace(/\.(\d*)$/,function(b,w){return"."+w+ln("0",Bi(i[1]).length-w.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return h+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return h+Zc(""+u);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+pl(t,e,-r):Zc(""+r)+"."+ln("0",i[1].length);if(i=e.match(/^#,#*,#0/))return pl(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Nh(pl(t,e.replace(/[\\-]/g,""),r)),o=0,Nh(Nh(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<n.length?n.charAt(o++):b==="0"?"0":""}));if(e.match(B4))return n=pl(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=mp(u,Math.pow(10,o)-1,!1),n=""+h,d=rc("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=dp(c[2],o),d.length<i[4].length&&(d=Bi(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=mp(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?l2(c[1],o)+i[2]+"/"+i[3]+dp(c[2],o):ln(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return n=""+r,e.length<=n.length?n:Bi(e.substr(0,e.length-n.length))+n;if(i=e.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var v=e.indexOf(".")-o,y=e.length-n.length-v;return Bi(e.substr(0,v)+n+e.substr(e.length-y))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+pl(t,e,-r):Zc(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?qo(0,3-b.length):"")+b})+"."+qo(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=Zc(""+u);return g!=="0"?h+g:"";default:if(e.match(/\.[0#?]*$/))return pl(t,e.slice(0,e.lastIndexOf(".")),r)+Bi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function rc(t,e,r){return(r|0)===r?pl(t,e,r):Qs(t,e,r)}function p8(t){for(var e=[],r=!1,a=0,n=0;a<t.length;++a)switch(t.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:e[e.length]=t.substr(n,a-n),n=a+1}if(e[e.length]=t.substr(n),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var q4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Wh(t){for(var e=0,r="",a="";e<t.length;)switch(r=t.charAt(e)){case"G":pp(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(a=r;t.charAt(e++)!=="]"&&e<t.length;)a+=t.charAt(e);if(a.match(q4))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function m8(t,e,r,a){for(var n=[],i="",o=0,c="",u="t",h,d,v,y="H";o<t.length;)switch(c=t.charAt(o)){case"G":if(!pp(t,o))throw new Error("unrecognized character "+c+" in "+t);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(v=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(v);n[n.length]={t:"t",v:i},++o;break;case"\\":var g=t.charAt(++o),b=g==="("||g===")"?g:"t";n[n.length]={t:b,v:g},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(h==null&&(h=Xu(e,r,t.charAt(o+1)==="2"),h==null))return"";n[n.length]={t:"X",v:t.substr(o,2)},u=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=Xu(e,r),h==null))return"";for(i=c;++o<t.length&&t.charAt(o).toLowerCase()===c;)i+=c;c==="m"&&u.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=y),n[n.length]={t:c,v:i},u=c;break;case"A":case"a":case"":var w={t:c,v:c};if(h==null&&(h=Xu(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(w.v=h.H>=12?"P":"A"),w.t="T",y="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(w.v=h.H>=12?"PM":"AM"),w.t="T",o+=5,y="h"):t.substr(o,5).toUpperCase()==="/"?(h!=null&&(w.v=h.H>=12?"":""),w.t="T",o+=5,y="h"):(w.t="t",++o),h==null&&w.t==="T")return"";n[n.length]=w,u=c;break;case"[":for(i=c;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(q4)){if(h==null&&(h=Xu(e,r),h==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Wh(t)||(n[n.length]={t:"t",v:i}));break;case".":if(h!=null){for(i=c;++o<t.length&&(c=t.charAt(o))==="0";)i+=c;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++o<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(o))>-1;)i+=c;n[n.length]={t:"n",v:i};break;case"?":for(i=c;t.charAt(++o)===c;)i+=c;n[n.length]={t:c,v:i},u=c;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:a===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:c,v:c},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);n[n.length]={t:"t",v:c},++o;break}var E=0,A=0,O;for(o=n.length-1,u="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=y,u="h",E<1&&(E=1);break;case"s":(O=n[o].v.match(/\.0+$/))&&(A=Math.max(A,O[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":u=n[o].t;break;case"m":u==="s"&&(n[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&n[o].v.match(/[Hh]/)&&(E=1),E<2&&n[o].v.match(/[Mm]/)&&(E=2),E<3&&n[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var T="",R;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=i8(n[o].t.charCodeAt(0),n[o].v,h,A),n[o].t="t";break;case"n":case"?":for(R=o+1;n[R]!=null&&((c=n[R].t)==="?"||c==="D"||(c===" "||c==="t")&&n[R+1]!=null&&(n[R+1].t==="?"||n[R+1].t==="t"&&n[R+1].v==="/")||n[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(n[R].v==="/"||n[R].v===" "&&n[R+1]!=null&&n[R+1].t=="?"));)n[o].v+=n[R].v,n[R]={v:"",t:";"},++R;T+=n[o].v,o=R-1;break;case"G":n[o].t="t",n[o].v=tf(e,r);break}var H="",z,F;if(T.length>0){T.charCodeAt(0)==40?(z=e<0&&T.charCodeAt(0)===45?-e:e,F=rc("n",T,z)):(z=e<0&&a>1?-e:e,F=rc("n",T,z),z<0&&n[0]&&n[0].t=="t"&&(F=F.substr(1),n[0].v="-"+n[0].v)),R=F.length-1;var W=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){W=o;break}var D=n.length;if(W===n.length&&F.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(R>=n[o].v.length-1?(R-=n[o].v.length,n[o].v=F.substr(R+1,n[o].v.length)):R<0?n[o].v="":(n[o].v=F.substr(0,R+1),R=-1),n[o].t="t",D=o);R>=0&&D<n.length&&(n[D].v=F.substr(0,R+1)+n[D].v)}else if(W!==n.length&&F.indexOf("E")===-1){for(R=F.indexOf(".")-1,o=W;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(d=n[o].v.indexOf(".")>-1&&o===W?n[o].v.indexOf(".")-1:n[o].v.length-1,H=n[o].v.substr(d+1);d>=0;--d)R>=0&&(n[o].v.charAt(d)==="0"||n[o].v.charAt(d)==="#")&&(H=F.charAt(R--)+H);n[o].v=H,n[o].t="t",D=o}for(R>=0&&D<n.length&&(n[D].v=F.substr(0,R+1)+n[D].v),R=F.indexOf(".")+1,o=W;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==W)){for(d=n[o].v.indexOf(".")>-1&&o===W?n[o].v.indexOf(".")+1:0,H=n[o].v.substr(0,d);d<n[o].v.length;++d)R<F.length&&(H+=F.charAt(R++));n[o].v=H,n[o].t="t",D=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(z=a>1&&e<0&&o>0&&n[o-1].v==="-"?-e:e,n[o].v=rc(n[o].t,n[o].v,z),n[o].t="t");var Y="";for(o=0;o!==n.length;++o)n[o]!=null&&(Y+=n[o].v);return Y}var Q_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ew(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function g8(t,e){var r=p8(t),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Q_),c=r[1].match(Q_);return ew(e,o)?[a,r[0]]:ew(e,c)?[a,r[1]]:[a,r[o!=null&&c!=null?2:1]]}return[a,i]}function io(t,e,r){r==null&&(r={});var a="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?a=r.dateNF:a=t;break;case"number":t==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:fr)[t],a==null&&(a=r.table&&r.table[K_[t]]||fr[K_[t]]),a==null&&(a=ZN[t]||"General");break}if(pp(a,0))return tf(e,r);e instanceof Date&&(e=R4(e,r.date1904));var n=g8(a,e);if(pp(n[1]))return tf(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return m8(n[1],e,r,n[0])}function ac(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(fr[r]==null){e<0&&(e=r);continue}if(fr[r]==t){e=r;break}}e<0&&(e=391)}return fr[e]=t,e}function Pp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&ac(t[e],e)}function Vh(){fr=JN()}var v8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},z4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function x8(t){var e=typeof t=="number"?fr[t]:t;return e=e.replace(z4,"(\\d+)"),new RegExp("^"+e+"$")}function y8(t,e,r){var a=-1,n=-1,i=-1,o=-1,c=-1,u=-1;(e.match(z4)||[]).forEach(function(v,y){var g=parseInt(r[y+1],10);switch(v.toLowerCase().charAt(0)){case"y":a=g;break;case"d":i=g;break;case"h":o=g;break;case"s":u=g;break;case"m":o>=0?c=g:n=g;break}}),u>=0&&c==-1&&n>=0&&(c=n,n=-1);var h=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&c==-1&&u==-1?h:a==-1&&n==-1&&i==-1?d:h+"T"+d}var _8=(function(){var t={};t.version="1.2.0";function e(){for(var F=0,W=new Array(256),D=0;D!=256;++D)F=D,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,W[D]=F;return typeof Int32Array<"u"?new Int32Array(W):W}var r=e();function a(F){var W=0,D=0,Y=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Y=0;Y!=256;++Y)I[Y]=F[Y];for(Y=0;Y!=256;++Y)for(D=F[Y],W=256+Y;W<4096;W+=256)D=I[W]=D>>>8^F[D&255];var L=[];for(Y=1;Y!=16;++Y)L[Y-1]=typeof Int32Array<"u"?I.subarray(Y*256,Y*256+256):I.slice(Y*256,Y*256+256);return L}var n=a(r),i=n[0],o=n[1],c=n[2],u=n[3],h=n[4],d=n[5],v=n[6],y=n[7],g=n[8],b=n[9],w=n[10],E=n[11],A=n[12],O=n[13],T=n[14];function R(F,W){for(var D=W^-1,Y=0,I=F.length;Y<I;)D=D>>>8^r[(D^F.charCodeAt(Y++))&255];return~D}function H(F,W){for(var D=W^-1,Y=F.length-15,I=0;I<Y;)D=T[F[I++]^D&255]^O[F[I++]^D>>8&255]^A[F[I++]^D>>16&255]^E[F[I++]^D>>>24]^w[F[I++]]^b[F[I++]]^g[F[I++]]^y[F[I++]]^v[F[I++]]^d[F[I++]]^h[F[I++]]^u[F[I++]]^c[F[I++]]^o[F[I++]]^i[F[I++]]^r[F[I++]];for(Y+=15;I<Y;)D=D>>>8^r[(D^F[I++])&255];return~D}function z(F,W){for(var D=W^-1,Y=0,I=F.length,L=0,ee=0;Y<I;)L=F.charCodeAt(Y++),L<128?D=D>>>8^r[(D^L)&255]:L<2048?(D=D>>>8^r[(D^(192|L>>6&31))&255],D=D>>>8^r[(D^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,ee=F.charCodeAt(Y++)&1023,D=D>>>8^r[(D^(240|L>>8&7))&255],D=D>>>8^r[(D^(128|L>>2&63))&255],D=D>>>8^r[(D^(128|ee>>6&15|(L&3)<<4))&255],D=D>>>8^r[(D^(128|ee&63))&255]):(D=D>>>8^r[(D^(224|L>>12&15))&255],D=D>>>8^r[(D^(128|L>>6&63))&255],D=D>>>8^r[(D^(128|L&63))&255]);return~D}return t.table=r,t.bstr=R,t.buf=H,t.str=z,t})(),ar=(function(){var e={};e.version="1.2.1";function r(J,ye){for(var ce=J.split("/"),ue=ye.split("/"),pe=0,be=0,Be=Math.min(ce.length,ue.length);pe<Be;++pe){if(be=ce[pe].length-ue[pe].length)return be;if(ce[pe]!=ue[pe])return ce[pe]<ue[pe]?-1:1}return ce.length-ue.length}function a(J){if(J.charAt(J.length-1)=="/")return J.slice(0,-1).indexOf("/")===-1?J:a(J.slice(0,-1));var ye=J.lastIndexOf("/");return ye===-1?J:J.slice(0,ye+1)}function n(J){if(J.charAt(J.length-1)=="/")return n(J.slice(0,-1));var ye=J.lastIndexOf("/");return ye===-1?J:J.slice(ye+1)}function i(J,ye){typeof ye=="string"&&(ye=new Date(ye));var ce=ye.getHours();ce=ce<<6|ye.getMinutes(),ce=ce<<5|ye.getSeconds()>>>1,J.write_shift(2,ce);var ue=ye.getFullYear()-1980;ue=ue<<4|ye.getMonth()+1,ue=ue<<5|ye.getDate(),J.write_shift(2,ue)}function o(J){var ye=J.read_shift(2)&65535,ce=J.read_shift(2)&65535,ue=new Date,pe=ce&31;ce>>>=5;var be=ce&15;ce>>>=4,ue.setMilliseconds(0),ue.setFullYear(ce+1980),ue.setMonth(be-1),ue.setDate(pe);var Be=ye&31;ye>>>=5;var Qe=ye&63;return ye>>>=6,ue.setHours(ye),ue.setMinutes(Qe),ue.setSeconds(Be<<1),ue}function c(J){di(J,0);for(var ye={},ce=0;J.l<=J.length-4;){var ue=J.read_shift(2),pe=J.read_shift(2),be=J.l+pe,Be={};switch(ue){case 21589:ce=J.read_shift(1),ce&1&&(Be.mtime=J.read_shift(4)),pe>5&&(ce&2&&(Be.atime=J.read_shift(4)),ce&4&&(Be.ctime=J.read_shift(4))),Be.mtime&&(Be.mt=new Date(Be.mtime*1e3));break}J.l=be,ye[ue]=Be}return ye}var u;function h(){return u||(u={})}function d(J,ye){if(J[0]==80&&J[1]==75)return ir(J,ye);if((J[0]|32)==109&&(J[1]|32)==105)return Kt(J,ye);if(J.length<512)throw new Error("CFB file size "+J.length+" < 512");var ce=3,ue=512,pe=0,be=0,Be=0,Qe=0,qe=0,ze=[],Ve=J.slice(0,512);di(Ve,0);var pt=v(Ve);switch(ce=pt[0],ce){case 3:ue=512;break;case 4:ue=4096;break;case 0:if(pt[1]==0)return ir(J,ye);default:throw new Error("Major Version: Expected 3 or 4 saw "+ce)}ue!==512&&(Ve=J.slice(0,ue),di(Ve,28));var bt=J.slice(0,ue);y(Ve,ce);var Tt=Ve.read_shift(4,"i");if(ce===3&&Tt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Tt);Ve.l+=4,Be=Ve.read_shift(4,"i"),Ve.l+=4,Ve.chk("00100000","Mini Stream Cutoff Size: "),Qe=Ve.read_shift(4,"i"),pe=Ve.read_shift(4,"i"),qe=Ve.read_shift(4,"i"),be=Ve.read_shift(4,"i");for(var yt=-1,kt=0;kt<109&&(yt=Ve.read_shift(4,"i"),!(yt<0));++kt)ze[kt]=yt;var Lt=g(J,ue);E(qe,be,Lt,ue,ze);var ea=O(Lt,Be,ze,ue);ea[Be].name="!Directory",pe>0&&Qe!==ee&&(ea[Qe].name="!MiniFAT"),ea[ze[0]].name="!FAT",ea.fat_addrs=ze,ea.ssz=ue;var jr={},na=[],ti=[],hs=[];T(Be,ea,Lt,na,pe,jr,ti,Qe),b(ti,hs,na),na.shift();var ds={FileIndex:ti,FullPaths:hs};return ye&&ye.raw&&(ds.raw={header:bt,sectors:Lt}),ds}function v(J){if(J[J.l]==80&&J[J.l+1]==75)return[0,0];J.chk(oe,"Header Signature: "),J.l+=16;var ye=J.read_shift(2,"u");return[J.read_shift(2,"u"),ye]}function y(J,ye){var ce=9;switch(J.l+=2,ce=J.read_shift(2)){case 9:if(ye!=3)throw new Error("Sector Shift: Expected 9 saw "+ce);break;case 12:if(ye!=4)throw new Error("Sector Shift: Expected 12 saw "+ce);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ce)}J.chk("0600","Mini Sector Shift: "),J.chk("000000000000","Reserved: ")}function g(J,ye){for(var ce=Math.ceil(J.length/ye)-1,ue=[],pe=1;pe<ce;++pe)ue[pe-1]=J.slice(pe*ye,(pe+1)*ye);return ue[ce-1]=J.slice(ce*ye),ue}function b(J,ye,ce){for(var ue=0,pe=0,be=0,Be=0,Qe=0,qe=ce.length,ze=[],Ve=[];ue<qe;++ue)ze[ue]=Ve[ue]=ue,ye[ue]=ce[ue];for(;Qe<Ve.length;++Qe)ue=Ve[Qe],pe=J[ue].L,be=J[ue].R,Be=J[ue].C,ze[ue]===ue&&(pe!==-1&&ze[pe]!==pe&&(ze[ue]=ze[pe]),be!==-1&&ze[be]!==be&&(ze[ue]=ze[be])),Be!==-1&&(ze[Be]=ue),pe!==-1&&ue!=ze[ue]&&(ze[pe]=ze[ue],Ve.lastIndexOf(pe)<Qe&&Ve.push(pe)),be!==-1&&ue!=ze[ue]&&(ze[be]=ze[ue],Ve.lastIndexOf(be)<Qe&&Ve.push(be));for(ue=1;ue<qe;++ue)ze[ue]===ue&&(be!==-1&&ze[be]!==be?ze[ue]=ze[be]:pe!==-1&&ze[pe]!==pe&&(ze[ue]=ze[pe]));for(ue=1;ue<qe;++ue)if(J[ue].type!==0){if(Qe=ue,Qe!=ze[Qe])do Qe=ze[Qe],ye[ue]=ye[Qe]+"/"+ye[ue];while(Qe!==0&&ze[Qe]!==-1&&Qe!=ze[Qe]);ze[ue]=-1}for(ye[0]+="/",ue=1;ue<qe;++ue)J[ue].type!==2&&(ye[ue]+="/")}function w(J,ye,ce){for(var ue=J.start,pe=J.size,be=[],Be=ue;ce&&pe>0&&Be>=0;)be.push(ye.slice(Be*L,Be*L+L)),pe-=L,Be=Wu(ce,Be*4);return be.length===0?nt(0):Jn(be).slice(0,J.size)}function E(J,ye,ce,ue,pe){var be=ee;if(J===ee){if(ye!==0)throw new Error("DIFAT chain shorter than expected")}else if(J!==-1){var Be=ce[J],Qe=(ue>>>2)-1;if(!Be)return;for(var qe=0;qe<Qe&&(be=Wu(Be,qe*4))!==ee;++qe)pe.push(be);E(Wu(Be,ue-4),ye-1,ce,ue,pe)}}function A(J,ye,ce,ue,pe){var be=[],Be=[];pe||(pe=[]);var Qe=ue-1,qe=0,ze=0;for(qe=ye;qe>=0;){pe[qe]=!0,be[be.length]=qe,Be.push(J[qe]);var Ve=ce[Math.floor(qe*4/ue)];if(ze=qe*4&Qe,ue<4+ze)throw new Error("FAT boundary crossed: "+qe+" 4 "+ue);if(!J[Ve])break;qe=Wu(J[Ve],ze)}return{nodes:be,data:hw([Be])}}function O(J,ye,ce,ue){var pe=J.length,be=[],Be=[],Qe=[],qe=[],ze=ue-1,Ve=0,pt=0,bt=0,Tt=0;for(Ve=0;Ve<pe;++Ve)if(Qe=[],bt=Ve+ye,bt>=pe&&(bt-=pe),!Be[bt]){qe=[];var yt=[];for(pt=bt;pt>=0;){yt[pt]=!0,Be[pt]=!0,Qe[Qe.length]=pt,qe.push(J[pt]);var kt=ce[Math.floor(pt*4/ue)];if(Tt=pt*4&ze,ue<4+Tt)throw new Error("FAT boundary crossed: "+pt+" 4 "+ue);if(!J[kt]||(pt=Wu(J[kt],Tt),yt[pt]))break}be[bt]={nodes:Qe,data:hw([qe])}}return be}function T(J,ye,ce,ue,pe,be,Be,Qe){for(var qe=0,ze=ue.length?2:0,Ve=ye[J].data,pt=0,bt=0,Tt;pt<Ve.length;pt+=128){var yt=Ve.slice(pt,pt+128);di(yt,64),bt=yt.read_shift(2),Tt=g2(yt,0,bt-ze),ue.push(Tt);var kt={name:Tt,type:yt.read_shift(1),color:yt.read_shift(1),L:yt.read_shift(4,"i"),R:yt.read_shift(4,"i"),C:yt.read_shift(4,"i"),clsid:yt.read_shift(16),state:yt.read_shift(4,"i"),start:0,size:0},Lt=yt.read_shift(2)+yt.read_shift(2)+yt.read_shift(2)+yt.read_shift(2);Lt!==0&&(kt.ct=R(yt,yt.l-8));var ea=yt.read_shift(2)+yt.read_shift(2)+yt.read_shift(2)+yt.read_shift(2);ea!==0&&(kt.mt=R(yt,yt.l-8)),kt.start=yt.read_shift(4,"i"),kt.size=yt.read_shift(4,"i"),kt.size<0&&kt.start<0&&(kt.size=kt.type=0,kt.start=ee,kt.name=""),kt.type===5?(qe=kt.start,pe>0&&qe!==ee&&(ye[qe].name="!StreamData")):kt.size>=4096?(kt.storage="fat",ye[kt.start]===void 0&&(ye[kt.start]=A(ce,kt.start,ye.fat_addrs,ye.ssz)),ye[kt.start].name=kt.name,kt.content=ye[kt.start].data.slice(0,kt.size)):(kt.storage="minifat",kt.size<0?kt.size=0:qe!==ee&&kt.start!==ee&&ye[qe]&&(kt.content=w(kt,ye[qe].data,(ye[Qe]||{}).data))),kt.content&&di(kt.content,0),be[Tt]=kt,Be.push(kt)}}function R(J,ye){return new Date((Ts(J,ye+4)/1e7*Math.pow(2,32)+Ts(J,ye)/1e7-11644473600)*1e3)}function H(J,ye){return h(),d(u.readFileSync(J),ye)}function z(J,ye){var ce=ye&&ye.type;switch(ce||Cr&&Buffer.isBuffer(J)&&(ce="buffer"),ce||"base64"){case"file":return H(J,ye);case"base64":return d(Os(Ls(J)),ye);case"binary":return d(Os(J),ye)}return d(J,ye)}function F(J,ye){var ce=ye||{},ue=ce.root||"Root Entry";if(J.FullPaths||(J.FullPaths=[]),J.FileIndex||(J.FileIndex=[]),J.FullPaths.length!==J.FileIndex.length)throw new Error("inconsistent CFB structure");J.FullPaths.length===0&&(J.FullPaths[0]=ue+"/",J.FileIndex[0]={name:ue,type:5}),ce.CLSID&&(J.FileIndex[0].clsid=ce.CLSID),W(J)}function W(J){var ye="Sh33tJ5";if(!ar.find(J,"/"+ye)){var ce=nt(4);ce[0]=55,ce[1]=ce[3]=50,ce[2]=54,J.FileIndex.push({name:ye,type:2,content:ce,size:4,L:69,R:69,C:69}),J.FullPaths.push(J.FullPaths[0]+ye),D(J)}}function D(J,ye){F(J);for(var ce=!1,ue=!1,pe=J.FullPaths.length-1;pe>=0;--pe){var be=J.FileIndex[pe];switch(be.type){case 0:ue?ce=!0:(J.FileIndex.pop(),J.FullPaths.pop());break;case 1:case 2:case 5:ue=!0,isNaN(be.R*be.L*be.C)&&(ce=!0),be.R>-1&&be.L>-1&&be.R==be.L&&(ce=!0);break;default:ce=!0;break}}if(!(!ce&&!ye)){var Be=new Date(1987,1,19),Qe=0,qe=Object.create?Object.create(null):{},ze=[];for(pe=0;pe<J.FullPaths.length;++pe)qe[J.FullPaths[pe]]=!0,J.FileIndex[pe].type!==0&&ze.push([J.FullPaths[pe],J.FileIndex[pe]]);for(pe=0;pe<ze.length;++pe){var Ve=a(ze[pe][0]);ue=qe[Ve],ue||(ze.push([Ve,{name:n(Ve).replace("/",""),type:1,clsid:ie,ct:Be,mt:Be,content:null}]),qe[Ve]=!0)}for(ze.sort(function(Tt,yt){return r(Tt[0],yt[0])}),J.FullPaths=[],J.FileIndex=[],pe=0;pe<ze.length;++pe)J.FullPaths[pe]=ze[pe][0],J.FileIndex[pe]=ze[pe][1];for(pe=0;pe<ze.length;++pe){var pt=J.FileIndex[pe],bt=J.FullPaths[pe];if(pt.name=n(bt).replace("/",""),pt.L=pt.R=pt.C=-(pt.color=1),pt.size=pt.content?pt.content.length:0,pt.start=0,pt.clsid=pt.clsid||ie,pe===0)pt.C=ze.length>1?1:-1,pt.size=0,pt.type=5;else if(bt.slice(-1)=="/"){for(Qe=pe+1;Qe<ze.length&&a(J.FullPaths[Qe])!=bt;++Qe);for(pt.C=Qe>=ze.length?-1:Qe,Qe=pe+1;Qe<ze.length&&a(J.FullPaths[Qe])!=a(bt);++Qe);pt.R=Qe>=ze.length?-1:Qe,pt.type=1}else a(J.FullPaths[pe+1]||"")==a(bt)&&(pt.R=pe+1),pt.type=2}}}function Y(J,ye){var ce=ye||{};if(ce.fileType=="mad")return fs(J,ce);switch(D(J),ce.fileType){case"zip":return pr(J,ce)}var ue=(function(Tt){for(var yt=0,kt=0,Lt=0;Lt<Tt.FileIndex.length;++Lt){var ea=Tt.FileIndex[Lt];if(ea.content){var jr=ea.content.length;jr>0&&(jr<4096?yt+=jr+63>>6:kt+=jr+511>>9)}}for(var na=Tt.FullPaths.length+3>>2,ti=yt+7>>3,hs=yt+127>>7,ds=ti+kt+na+hs,Fi=ds+127>>7,$o=Fi<=109?0:Math.ceil((Fi-109)/127);ds+Fi+$o+127>>7>Fi;)$o=++Fi<=109?0:Math.ceil((Fi-109)/127);var ka=[1,$o,Fi,hs,na,kt,yt,0];return Tt.FileIndex[0].size=yt<<6,ka[7]=(Tt.FileIndex[0].start=ka[0]+ka[1]+ka[2]+ka[3]+ka[4]+ka[5])+(ka[6]+7>>3),ka})(J),pe=nt(ue[7]<<9),be=0,Be=0;{for(be=0;be<8;++be)pe.write_shift(1,ge[be]);for(be=0;be<8;++be)pe.write_shift(2,0);for(pe.write_shift(2,62),pe.write_shift(2,3),pe.write_shift(2,65534),pe.write_shift(2,9),pe.write_shift(2,6),be=0;be<3;++be)pe.write_shift(2,0);for(pe.write_shift(4,0),pe.write_shift(4,ue[2]),pe.write_shift(4,ue[0]+ue[1]+ue[2]+ue[3]-1),pe.write_shift(4,0),pe.write_shift(4,4096),pe.write_shift(4,ue[3]?ue[0]+ue[1]+ue[2]-1:ee),pe.write_shift(4,ue[3]),pe.write_shift(-4,ue[1]?ue[0]-1:ee),pe.write_shift(4,ue[1]),be=0;be<109;++be)pe.write_shift(-4,be<ue[2]?ue[1]+be:-1)}if(ue[1])for(Be=0;Be<ue[1];++Be){for(;be<236+Be*127;++be)pe.write_shift(-4,be<ue[2]?ue[1]+be:-1);pe.write_shift(-4,Be===ue[1]-1?ee:Be+1)}var Qe=function(Tt){for(Be+=Tt;be<Be-1;++be)pe.write_shift(-4,be+1);Tt&&(++be,pe.write_shift(-4,ee))};for(Be=be=0,Be+=ue[1];be<Be;++be)pe.write_shift(-4,he.DIFSECT);for(Be+=ue[2];be<Be;++be)pe.write_shift(-4,he.FATSECT);Qe(ue[3]),Qe(ue[4]);for(var qe=0,ze=0,Ve=J.FileIndex[0];qe<J.FileIndex.length;++qe)Ve=J.FileIndex[qe],Ve.content&&(ze=Ve.content.length,!(ze<4096)&&(Ve.start=Be,Qe(ze+511>>9)));for(Qe(ue[6]+7>>3);pe.l&511;)pe.write_shift(-4,he.ENDOFCHAIN);for(Be=be=0,qe=0;qe<J.FileIndex.length;++qe)Ve=J.FileIndex[qe],Ve.content&&(ze=Ve.content.length,!(!ze||ze>=4096)&&(Ve.start=Be,Qe(ze+63>>6)));for(;pe.l&511;)pe.write_shift(-4,he.ENDOFCHAIN);for(be=0;be<ue[4]<<2;++be){var pt=J.FullPaths[be];if(!pt||pt.length===0){for(qe=0;qe<17;++qe)pe.write_shift(4,0);for(qe=0;qe<3;++qe)pe.write_shift(4,-1);for(qe=0;qe<12;++qe)pe.write_shift(4,0);continue}Ve=J.FileIndex[be],be===0&&(Ve.start=Ve.size?Ve.start-1:ee);var bt=be===0&&ce.root||Ve.name;if(ze=2*(bt.length+1),pe.write_shift(64,bt,"utf16le"),pe.write_shift(2,ze),pe.write_shift(1,Ve.type),pe.write_shift(1,Ve.color),pe.write_shift(-4,Ve.L),pe.write_shift(-4,Ve.R),pe.write_shift(-4,Ve.C),Ve.clsid)pe.write_shift(16,Ve.clsid,"hex");else for(qe=0;qe<4;++qe)pe.write_shift(4,0);pe.write_shift(4,Ve.state||0),pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(4,Ve.start),pe.write_shift(4,Ve.size),pe.write_shift(4,0)}for(be=1;be<J.FileIndex.length;++be)if(Ve=J.FileIndex[be],Ve.size>=4096)if(pe.l=Ve.start+1<<9,Cr&&Buffer.isBuffer(Ve.content))Ve.content.copy(pe,pe.l,0,Ve.size),pe.l+=Ve.size+511&-512;else{for(qe=0;qe<Ve.size;++qe)pe.write_shift(1,Ve.content[qe]);for(;qe&511;++qe)pe.write_shift(1,0)}for(be=1;be<J.FileIndex.length;++be)if(Ve=J.FileIndex[be],Ve.size>0&&Ve.size<4096)if(Cr&&Buffer.isBuffer(Ve.content))Ve.content.copy(pe,pe.l,0,Ve.size),pe.l+=Ve.size+63&-64;else{for(qe=0;qe<Ve.size;++qe)pe.write_shift(1,Ve.content[qe]);for(;qe&63;++qe)pe.write_shift(1,0)}if(Cr)pe.l=pe.length;else for(;pe.l<pe.length;)pe.write_shift(1,0);return pe}function I(J,ye){var ce=J.FullPaths.map(function(qe){return qe.toUpperCase()}),ue=ce.map(function(qe){var ze=qe.split("/");return ze[ze.length-(qe.slice(-1)=="/"?2:1)]}),pe=!1;ye.charCodeAt(0)===47?(pe=!0,ye=ce[0].slice(0,-1)+ye):pe=ye.indexOf("/")!==-1;var be=ye.toUpperCase(),Be=pe===!0?ce.indexOf(be):ue.indexOf(be);if(Be!==-1)return J.FileIndex[Be];var Qe=!be.match(U0);for(be=be.replace(qi,""),Qe&&(be=be.replace(U0,"!")),Be=0;Be<ce.length;++Be)if((Qe?ce[Be].replace(U0,"!"):ce[Be]).replace(qi,"")==be||(Qe?ue[Be].replace(U0,"!"):ue[Be]).replace(qi,"")==be)return J.FileIndex[Be];return null}var L=64,ee=-2,oe="d0cf11e0a1b11ae1",ge=[208,207,17,224,161,177,26,225],ie="00000000000000000000000000000000",he={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ee,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function de(J,ye,ce){h();var ue=Y(J,ce);u.writeFileSync(ye,ue)}function Z(J){for(var ye=new Array(J.length),ce=0;ce<J.length;++ce)ye[ce]=String.fromCharCode(J[ce]);return ye.join("")}function Ne(J,ye){var ce=Y(J,ye);switch(ye&&ye.type||"buffer"){case"file":return h(),u.writeFileSync(ye.filename,ce),ce;case"binary":return typeof ce=="string"?ce:Z(ce);case"base64":return rd(typeof ce=="string"?ce:Z(ce));case"buffer":if(Cr)return Buffer.isBuffer(ce)?ce:oc(ce);case"array":return typeof ce=="string"?Os(ce):ce}return ce}var Q;function N(J){try{var ye=J.InflateRaw,ce=new ye;if(ce._processChunk(new Uint8Array([3,0]),ce._finishFlushFlag),ce.bytesRead)Q=J;else throw new Error("zlib does not expose bytesRead")}catch(ue){console.error("cannot use native zlib: "+(ue.message||ue))}}function M(J,ye){if(!Q)return Wr(J,ye);var ce=Q.InflateRaw,ue=new ce,pe=ue._processChunk(J.slice(J.l),ue._finishFlushFlag);return J.l+=ue.bytesRead,pe}function B(J){return Q?Q.deflateRawSync(J):ct(J)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(J){var ye=(J<<1|J<<11)&139536|(J<<5|J<<15)&558144;return(ye>>16|ye>>8|ye)&255}for(var we=typeof Uint8Array<"u",Se=we?new Uint8Array(256):[],Ee=0;Ee<256;++Ee)Se[Ee]=me(Ee);function ae(J,ye){var ce=Se[J&255];return ye<=8?ce>>>8-ye:(ce=ce<<8|Se[J>>8&255],ye<=16?ce>>>16-ye:(ce=ce<<8|Se[J>>16&255],ce>>>24-ye))}function rt(J,ye){var ce=ye&7,ue=ye>>>3;return(J[ue]|(ce<=6?0:J[ue+1]<<8))>>>ce&3}function Je(J,ye){var ce=ye&7,ue=ye>>>3;return(J[ue]|(ce<=5?0:J[ue+1]<<8))>>>ce&7}function V(J,ye){var ce=ye&7,ue=ye>>>3;return(J[ue]|(ce<=4?0:J[ue+1]<<8))>>>ce&15}function Ie(J,ye){var ce=ye&7,ue=ye>>>3;return(J[ue]|(ce<=3?0:J[ue+1]<<8))>>>ce&31}function Le(J,ye){var ce=ye&7,ue=ye>>>3;return(J[ue]|(ce<=1?0:J[ue+1]<<8))>>>ce&127}function gt(J,ye,ce){var ue=ye&7,pe=ye>>>3,be=(1<<ce)-1,Be=J[pe]>>>ue;return ce<8-ue||(Be|=J[pe+1]<<8-ue,ce<16-ue)||(Be|=J[pe+2]<<16-ue,ce<24-ue)||(Be|=J[pe+3]<<24-ue),Be&be}function et(J,ye,ce){var ue=ye&7,pe=ye>>>3;return ue<=5?J[pe]|=(ce&7)<<ue:(J[pe]|=ce<<ue&255,J[pe+1]=(ce&7)>>8-ue),ye+3}function wt(J,ye,ce){var ue=ye&7,pe=ye>>>3;return ce=(ce&1)<<ue,J[pe]|=ce,ye+1}function vt(J,ye,ce){var ue=ye&7,pe=ye>>>3;return ce<<=ue,J[pe]|=ce&255,ce>>>=8,J[pe+1]=ce,ye+8}function Ct(J,ye,ce){var ue=ye&7,pe=ye>>>3;return ce<<=ue,J[pe]|=ce&255,ce>>>=8,J[pe+1]=ce&255,J[pe+2]=ce>>>8,ye+16}function Et(J,ye){var ce=J.length,ue=2*ce>ye?2*ce:ye+5,pe=0;if(ce>=ye)return J;if(Cr){var be=$_(ue);if(J.copy)J.copy(be);else for(;pe<J.length;++pe)be[pe]=J[pe];return be}else if(we){var Be=new Uint8Array(ue);if(Be.set)Be.set(J);else for(;pe<ce;++pe)Be[pe]=J[pe];return Be}return J.length=ue,J}function It(J){for(var ye=new Array(J),ce=0;ce<J;++ce)ye[ce]=0;return ye}function er(J,ye,ce){var ue=1,pe=0,be=0,Be=0,Qe=0,qe=J.length,ze=we?new Uint16Array(32):It(32);for(be=0;be<32;++be)ze[be]=0;for(be=qe;be<ce;++be)J[be]=0;qe=J.length;var Ve=we?new Uint16Array(qe):It(qe);for(be=0;be<qe;++be)ze[pe=J[be]]++,ue<pe&&(ue=pe),Ve[be]=0;for(ze[0]=0,be=1;be<=ue;++be)ze[be+16]=Qe=Qe+ze[be-1]<<1;for(be=0;be<qe;++be)Qe=J[be],Qe!=0&&(Ve[be]=ze[Qe+16]++);var pt=0;for(be=0;be<qe;++be)if(pt=J[be],pt!=0)for(Qe=ae(Ve[be],ue)>>ue-pt,Be=(1<<ue+4-pt)-1;Be>=0;--Be)ye[Qe|Be<<pt]=pt&15|be<<4;return ue}var Vt=we?new Uint16Array(512):It(512),Oe=we?new Uint16Array(32):It(32);if(!we){for(var Ye=0;Ye<512;++Ye)Vt[Ye]=0;for(Ye=0;Ye<32;++Ye)Oe[Ye]=0}(function(){for(var J=[],ye=0;ye<32;ye++)J.push(5);er(J,Oe,32);var ce=[];for(ye=0;ye<=143;ye++)ce.push(8);for(;ye<=255;ye++)ce.push(9);for(;ye<=279;ye++)ce.push(7);for(;ye<=287;ye++)ce.push(8);er(ce,Vt,288)})();var He=(function(){for(var ye=we?new Uint8Array(32768):[],ce=0,ue=0;ce<se.length-1;++ce)for(;ue<se[ce+1];++ue)ye[ue]=ce;for(;ue<32768;++ue)ye[ue]=29;var pe=we?new Uint8Array(259):[];for(ce=0,ue=0;ce<K.length-1;++ce)for(;ue<K[ce+1];++ue)pe[ue]=ce;function be(Qe,qe){for(var ze=0;ze<Qe.length;){var Ve=Math.min(65535,Qe.length-ze),pt=ze+Ve==Qe.length;for(qe.write_shift(1,+pt),qe.write_shift(2,Ve),qe.write_shift(2,~Ve&65535);Ve-- >0;)qe[qe.l++]=Qe[ze++]}return qe.l}function Be(Qe,qe){for(var ze=0,Ve=0,pt=we?new Uint16Array(32768):[];Ve<Qe.length;){var bt=Math.min(65535,Qe.length-Ve);if(bt<10){for(ze=et(qe,ze,+(Ve+bt==Qe.length)),ze&7&&(ze+=8-(ze&7)),qe.l=ze/8|0,qe.write_shift(2,bt),qe.write_shift(2,~bt&65535);bt-- >0;)qe[qe.l++]=Qe[Ve++];ze=qe.l*8;continue}ze=et(qe,ze,+(Ve+bt==Qe.length)+2);for(var Tt=0;bt-- >0;){var yt=Qe[Ve];Tt=(Tt<<5^yt)&32767;var kt=-1,Lt=0;if((kt=pt[Tt])&&(kt|=Ve&-32768,kt>Ve&&(kt-=32768),kt<Ve))for(;Qe[kt+Lt]==Qe[Ve+Lt]&&Lt<250;)++Lt;if(Lt>2){yt=pe[Lt],yt<=22?ze=vt(qe,ze,Se[yt+1]>>1)-1:(vt(qe,ze,3),ze+=5,vt(qe,ze,Se[yt-23]>>5),ze+=3);var ea=yt<8?0:yt-4>>2;ea>0&&(Ct(qe,ze,Lt-K[yt]),ze+=ea),yt=ye[Ve-kt],ze=vt(qe,ze,Se[yt]>>3),ze-=3;var jr=yt<4?0:yt-2>>1;jr>0&&(Ct(qe,ze,Ve-kt-se[yt]),ze+=jr);for(var na=0;na<Lt;++na)pt[Tt]=Ve&32767,Tt=(Tt<<5^Qe[Ve])&32767,++Ve;bt-=Lt-1}else yt<=143?yt=yt+48:ze=wt(qe,ze,1),ze=vt(qe,ze,Se[yt]),pt[Tt]=Ve&32767,++Ve}ze=vt(qe,ze,0)-1}return qe.l=(ze+7)/8|0,qe.l}return function(qe,ze){return qe.length<8?be(qe,ze):Be(qe,ze)}})();function ct(J){var ye=nt(50+Math.floor(J.length*1.1)),ce=He(J,ye);return ye.slice(0,ce)}var mt=we?new Uint16Array(32768):It(32768),Ht=we?new Uint16Array(32768):It(32768),Rt=we?new Uint16Array(128):It(128),Wt=1,nr=1;function br(J,ye){var ce=Ie(J,ye)+257;ye+=5;var ue=Ie(J,ye)+1;ye+=5;var pe=V(J,ye)+4;ye+=4;for(var be=0,Be=we?new Uint8Array(19):It(19),Qe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],qe=1,ze=we?new Uint8Array(8):It(8),Ve=we?new Uint8Array(8):It(8),pt=Be.length,bt=0;bt<pe;++bt)Be[q[bt]]=be=Je(J,ye),qe<be&&(qe=be),ze[be]++,ye+=3;var Tt=0;for(ze[0]=0,bt=1;bt<=qe;++bt)Ve[bt]=Tt=Tt+ze[bt-1]<<1;for(bt=0;bt<pt;++bt)(Tt=Be[bt])!=0&&(Qe[bt]=Ve[Tt]++);var yt=0;for(bt=0;bt<pt;++bt)if(yt=Be[bt],yt!=0){Tt=Se[Qe[bt]]>>8-yt;for(var kt=(1<<7-yt)-1;kt>=0;--kt)Rt[Tt|kt<<yt]=yt&7|bt<<3}var Lt=[];for(qe=1;Lt.length<ce+ue;)switch(Tt=Rt[Le(J,ye)],ye+=Tt&7,Tt>>>=3){case 16:for(be=3+rt(J,ye),ye+=2,Tt=Lt[Lt.length-1];be-- >0;)Lt.push(Tt);break;case 17:for(be=3+Je(J,ye),ye+=3;be-- >0;)Lt.push(0);break;case 18:for(be=11+Le(J,ye),ye+=7;be-- >0;)Lt.push(0);break;default:Lt.push(Tt),qe<Tt&&(qe=Tt);break}var ea=Lt.slice(0,ce),jr=Lt.slice(ce);for(bt=ce;bt<286;++bt)ea[bt]=0;for(bt=ue;bt<30;++bt)jr[bt]=0;return Wt=er(ea,mt,286),nr=er(jr,Ht,30),ye}function Yt(J,ye){if(J[0]==3&&!(J[1]&3))return[eu(ye),2];for(var ce=0,ue=0,pe=$_(ye||1<<18),be=0,Be=pe.length>>>0,Qe=0,qe=0;(ue&1)==0;){if(ue=Je(J,ce),ce+=3,ue>>>1)ue>>1==1?(Qe=9,qe=5):(ce=br(J,ce),Qe=Wt,qe=nr);else{ce&7&&(ce+=8-(ce&7));var ze=J[ce>>>3]|J[(ce>>>3)+1]<<8;if(ce+=32,ze>0)for(!ye&&Be<be+ze&&(pe=Et(pe,be+ze),Be=pe.length);ze-- >0;)pe[be++]=J[ce>>>3],ce+=8;continue}for(;;){!ye&&Be<be+32767&&(pe=Et(pe,be+32767),Be=pe.length);var Ve=gt(J,ce,Qe),pt=ue>>>1==1?Vt[Ve]:mt[Ve];if(ce+=pt&15,pt>>>=4,(pt>>>8&255)===0)pe[be++]=pt;else{if(pt==256)break;pt-=257;var bt=pt<8?0:pt-4>>2;bt>5&&(bt=0);var Tt=be+K[pt];bt>0&&(Tt+=gt(J,ce,bt),ce+=bt),Ve=gt(J,ce,qe),pt=ue>>>1==1?Oe[Ve]:Ht[Ve],ce+=pt&15,pt>>>=4;var yt=pt<4?0:pt-2>>1,kt=se[pt];for(yt>0&&(kt+=gt(J,ce,yt),ce+=yt),!ye&&Be<Tt&&(pe=Et(pe,Tt+100),Be=pe.length);be<Tt;)pe[be]=pe[be-kt],++be}}}return ye?[pe,ce+7>>>3]:[pe.slice(0,be),ce+7>>>3]}function Wr(J,ye){var ce=J.slice(J.l||0),ue=Yt(ce,ye);return J.l+=ue[1],ue[0]}function Zt(J,ye){if(J)typeof console<"u"&&console.error(ye);else throw new Error(ye)}function ir(J,ye){var ce=J;di(ce,0);var ue=[],pe=[],be={FileIndex:ue,FullPaths:pe};F(be,{root:ye.root});for(var Be=ce.length-4;(ce[Be]!=80||ce[Be+1]!=75||ce[Be+2]!=5||ce[Be+3]!=6)&&Be>=0;)--Be;ce.l=Be+4,ce.l+=4;var Qe=ce.read_shift(2);ce.l+=6;var qe=ce.read_shift(4);for(ce.l=qe,Be=0;Be<Qe;++Be){ce.l+=20;var ze=ce.read_shift(4),Ve=ce.read_shift(4),pt=ce.read_shift(2),bt=ce.read_shift(2),Tt=ce.read_shift(2);ce.l+=8;var yt=ce.read_shift(4),kt=c(ce.slice(ce.l+pt,ce.l+pt+bt));ce.l+=pt+bt+Tt;var Lt=ce.l;ce.l=yt+4,Vr(ce,ze,Ve,be,kt),ce.l=Lt}return be}function Vr(J,ye,ce,ue,pe){J.l+=2;var be=J.read_shift(2),Be=J.read_shift(2),Qe=o(J);if(be&8257)throw new Error("Unsupported ZIP encryption");for(var qe=J.read_shift(4),ze=J.read_shift(4),Ve=J.read_shift(4),pt=J.read_shift(2),bt=J.read_shift(2),Tt="",yt=0;yt<pt;++yt)Tt+=String.fromCharCode(J[J.l++]);if(bt){var kt=c(J.slice(J.l,J.l+bt));(kt[21589]||{}).mt&&(Qe=kt[21589].mt),((pe||{})[21589]||{}).mt&&(Qe=pe[21589].mt)}J.l+=bt;var Lt=J.slice(J.l,J.l+ze);switch(Be){case 8:Lt=M(J,Ve);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Be)}var ea=!1;be&8&&(qe=J.read_shift(4),qe==134695760&&(qe=J.read_shift(4),ea=!0),ze=J.read_shift(4),Ve=J.read_shift(4)),ze!=ye&&Zt(ea,"Bad compressed size: "+ye+" != "+ze),Ve!=ce&&Zt(ea,"Bad uncompressed size: "+ce+" != "+Ve),On(ue,Tt,Lt,{unsafe:!0,mt:Qe})}function pr(J,ye){var ce=ye||{},ue=[],pe=[],be=nt(1),Be=ce.compression?8:0,Qe=0,qe=0,ze=0,Ve=0,pt=0,bt=J.FullPaths[0],Tt=bt,yt=J.FileIndex[0],kt=[],Lt=0;for(qe=1;qe<J.FullPaths.length;++qe)if(Tt=J.FullPaths[qe].slice(bt.length),yt=J.FileIndex[qe],!(!yt.size||!yt.content||Tt=="Sh33tJ5")){var ea=Ve,jr=nt(Tt.length);for(ze=0;ze<Tt.length;++ze)jr.write_shift(1,Tt.charCodeAt(ze)&127);jr=jr.slice(0,jr.l),kt[pt]=_8.buf(yt.content,0);var na=yt.content;Be==8&&(na=B(na)),be=nt(30),be.write_shift(4,67324752),be.write_shift(2,20),be.write_shift(2,Qe),be.write_shift(2,Be),yt.mt?i(be,yt.mt):be.write_shift(4,0),be.write_shift(-4,kt[pt]),be.write_shift(4,na.length),be.write_shift(4,yt.content.length),be.write_shift(2,jr.length),be.write_shift(2,0),Ve+=be.length,ue.push(be),Ve+=jr.length,ue.push(jr),Ve+=na.length,ue.push(na),be=nt(46),be.write_shift(4,33639248),be.write_shift(2,0),be.write_shift(2,20),be.write_shift(2,Qe),be.write_shift(2,Be),be.write_shift(4,0),be.write_shift(-4,kt[pt]),be.write_shift(4,na.length),be.write_shift(4,yt.content.length),be.write_shift(2,jr.length),be.write_shift(2,0),be.write_shift(2,0),be.write_shift(2,0),be.write_shift(2,0),be.write_shift(4,0),be.write_shift(4,ea),Lt+=be.l,pe.push(be),Lt+=jr.length,pe.push(jr),++pt}return be=nt(22),be.write_shift(4,101010256),be.write_shift(2,0),be.write_shift(2,0),be.write_shift(2,pt),be.write_shift(2,pt),be.write_shift(4,Lt),be.write_shift(4,Ve),be.write_shift(2,0),Jn([Jn(ue),Jn(pe),be])}var Dt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Tr(J,ye){if(J.ctype)return J.ctype;var ce=J.name||"",ue=ce.match(/\.([^\.]+)$/);return ue&&Dt[ue[1]]||ye&&(ue=(ce=ye).match(/[\.\\]([^\.\\])+$/),ue&&Dt[ue[1]])?Dt[ue[1]]:"application/octet-stream"}function Qn(J){for(var ye=rd(J),ce=[],ue=0;ue<ye.length;ue+=76)ce.push(ye.slice(ue,ue+76));return ce.join(`\r
`)+`\r
`}function Ka(J){var ye=J.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ze){var Ve=ze.charCodeAt(0).toString(16).toUpperCase();return"="+(Ve.length==1?"0"+Ve:Ve)});ye=ye.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ye.charAt(0)==`
`&&(ye="=0D"+ye.slice(1)),ye=ye.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ce=[],ue=ye.split(`\r
`),pe=0;pe<ue.length;++pe){var be=ue[pe];if(be.length==0){ce.push("");continue}for(var Be=0;Be<be.length;){var Qe=76,qe=be.slice(Be,Be+Qe);qe.charAt(Qe-1)=="="?Qe--:qe.charAt(Qe-2)=="="?Qe-=2:qe.charAt(Qe-3)=="="&&(Qe-=3),qe=be.slice(Be,Be+Qe),Be+=Qe,Be<be.length&&(qe+="="),ce.push(qe)}}return ce.join(`\r
`)}function _t(J){for(var ye=[],ce=0;ce<J.length;++ce){for(var ue=J[ce];ce<=J.length&&ue.charAt(ue.length-1)=="=";)ue=ue.slice(0,ue.length-1)+J[++ce];ye.push(ue)}for(var pe=0;pe<ye.length;++pe)ye[pe]=ye[pe].replace(/[=][0-9A-Fa-f]{2}/g,function(be){return String.fromCharCode(parseInt(be.slice(1),16))});return Os(ye.join(`\r
`))}function Ja(J,ye,ce){for(var ue="",pe="",be="",Be,Qe=0;Qe<10;++Qe){var qe=ye[Qe];if(!qe||qe.match(/^\s*$/))break;var ze=qe.match(/^(.*?):\s*([^\s].*)$/);if(ze)switch(ze[1].toLowerCase()){case"content-location":ue=ze[2].trim();break;case"content-type":be=ze[2].trim();break;case"content-transfer-encoding":pe=ze[2].trim();break}}switch(++Qe,pe.toLowerCase()){case"base64":Be=Os(Ls(ye.slice(Qe).join("")));break;case"quoted-printable":Be=_t(ye.slice(Qe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+pe)}var Ve=On(J,ue.slice(ce.length),Be,{unsafe:!0});be&&(Ve.ctype=be)}function Kt(J,ye){if(Z(J.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ce=ye&&ye.root||"",ue=(Cr&&Buffer.isBuffer(J)?J.toString("binary"):Z(J)).split(`\r
`),pe=0,be="";for(pe=0;pe<ue.length;++pe)if(be=ue[pe],!!/^Content-Location:/i.test(be)&&(be=be.slice(be.indexOf("file")),ce||(ce=be.slice(0,be.lastIndexOf("/")+1)),be.slice(0,ce.length)!=ce))for(;ce.length>0&&(ce=ce.slice(0,ce.length-1),ce=ce.slice(0,ce.lastIndexOf("/")+1),be.slice(0,ce.length)!=ce););var Be=(ue[1]||"").match(/boundary="(.*?)"/);if(!Be)throw new Error("MAD cannot find boundary");var Qe="--"+(Be[1]||""),qe=[],ze=[],Ve={FileIndex:qe,FullPaths:ze};F(Ve);var pt,bt=0;for(pe=0;pe<ue.length;++pe){var Tt=ue[pe];Tt!==Qe&&Tt!==Qe+"--"||(bt++&&Ja(Ve,ue.slice(pt,pe),ce),pt=pe)}return Ve}function fs(J,ye){var ce=ye||{},ue=ce.boundary||"SheetJS";ue="------="+ue;for(var pe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ue.slice(2)+'"',"","",""],be=J.FullPaths[0],Be=be,Qe=J.FileIndex[0],qe=1;qe<J.FullPaths.length;++qe)if(Be=J.FullPaths[qe].slice(be.length),Qe=J.FileIndex[qe],!(!Qe.size||!Qe.content||Be=="Sh33tJ5")){Be=Be.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Lt){return"_x"+Lt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Lt){return"_u"+Lt.charCodeAt(0).toString(16)+"_"});for(var ze=Qe.content,Ve=Cr&&Buffer.isBuffer(ze)?ze.toString("binary"):Z(ze),pt=0,bt=Math.min(1024,Ve.length),Tt=0,yt=0;yt<=bt;++yt)(Tt=Ve.charCodeAt(yt))>=32&&Tt<128&&++pt;var kt=pt>=bt*4/5;pe.push(ue),pe.push("Content-Location: "+(ce.root||"file:///C:/SheetJS/")+Be),pe.push("Content-Transfer-Encoding: "+(kt?"quoted-printable":"base64")),pe.push("Content-Type: "+Tr(Qe,Be)),pe.push(""),pe.push(kt?Ka(Ve):Qn(Ve))}return pe.push(ue+`--\r
`),pe.join(`\r
`)}function zi(J){var ye={};return F(ye,J),ye}function On(J,ye,ce,ue){var pe=ue&&ue.unsafe;pe||F(J);var be=!pe&&ar.find(J,ye);if(!be){var Be=J.FullPaths[0];ye.slice(0,Be.length)==Be?Be=ye:(Be.slice(-1)!="/"&&(Be+="/"),Be=(Be+ye).replace("//","/")),be={name:n(ye),type:2},J.FileIndex.push(be),J.FullPaths.push(Be),pe||ar.utils.cfb_gc(J)}return be.content=ce,be.size=ce?ce.length:0,ue&&(ue.CLSID&&(be.clsid=ue.CLSID),ue.mt&&(be.mt=ue.mt),ue.ct&&(be.ct=ue.ct)),be}function ei(J,ye){F(J);var ce=ar.find(J,ye);if(ce){for(var ue=0;ue<J.FileIndex.length;++ue)if(J.FileIndex[ue]==ce)return J.FileIndex.splice(ue,1),J.FullPaths.splice(ue,1),!0}return!1}function ha(J,ye,ce){F(J);var ue=ar.find(J,ye);if(ue){for(var pe=0;pe<J.FileIndex.length;++pe)if(J.FileIndex[pe]==ue)return J.FileIndex[pe].name=n(ce),J.FullPaths[pe]=ce,!0}return!1}function Da(J){D(J,!0)}return e.find=I,e.read=z,e.parse=d,e.write=Ne,e.writeFile=de,e.utils={cfb_new:zi,cfb_add:On,cfb_del:ei,cfb_mov:ha,cfb_gc:Da,ReadShift:z0,CheckField:u3,prep_blob:di,bconcat:Jn,use_zlib:N,_deflateRaw:ct,_inflateRaw:Wr,consts:he},e})();function w8(t){return typeof t=="string"?Dp(t):Array.isArray(t)?$N(t):t}function xd(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Dp(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var a=r=="utf8"?xl(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,t);if(typeof Blob<"u"){var n=new Blob([w8(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,t);if(typeof saveAs<"u")return saveAs(n,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(t);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=iu(e)),c.write(e),c.close(),e}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+t)}function b8(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+t)}function un(t){for(var e=Object.keys(t),r=[],a=0;a<e.length;++a)Object.prototype.hasOwnProperty.call(t,e[a])&&r.push(e[a]);return r}function tw(t,e){for(var r=[],a=un(t),n=0;n!==a.length;++n)r[t[a[n]][e]]==null&&(r[t[a[n]][e]]=a[n]);return r}function Mp(t){for(var e=[],r=un(t),a=0;a!==r.length;++a)e[t[r[a]]]=r[a];return e}function Ip(t){for(var e=[],r=un(t),a=0;a!==r.length;++a)e[t[r[a]]]=parseInt(r[a],10);return e}function S8(t){for(var e=[],r=un(t),a=0;a!==r.length;++a)e[t[r[a]]]==null&&(e[t[r[a]]]=[]),e[t[r[a]]].push(r[a]);return e}var gp=new Date(1899,11,30,0,0,0);function zn(t,e){var r=t.getTime(),a=gp.getTime()+(t.getTimezoneOffset()-gp.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var H4=new Date,E8=gp.getTime()+(H4.getTimezoneOffset()-gp.getTimezoneOffset())*6e4,rw=H4.getTimezoneOffset();function Bp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+E8),e.getTimezoneOffset()!==rw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-rw)*6e4),e}function k8(t){var e=0,r=0,a=!1,n=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(n[i],10)}return e}var aw=new Date("2017-02-19T19:06:09.000Z"),W4=isNaN(aw.getFullYear())?new Date("2/19/17"):aw,A8=W4.getFullYear()==2017;function Ra(t,e){var r=new Date(t);if(A8)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(W4.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return t.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function rf(t,e){if(Cr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return xl(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return xl(O4(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return xl(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return xl(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var a=[],n=0;n!=t.length;++n)a.push(String.fromCharCode(t[n]));return a.join("")}function La(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=La(t[r]));return e}function ln(t,e){for(var r="";r.length<e;)r+=t;return r}function zo(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,a=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(e=Number(a)))?e/r:e}var N8=["january","february","march","april","may","june","july","august","september","october","november","december"];function Bh(t){var e=new Date(t),r=new Date(NaN),a=e.getYear(),n=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&N8.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||i>1)&&a!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var T8=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(t||typeof a=="string")return r.split(a);for(var i=r.split(a),o=[i[0]],c=1;c<i.length;++c)o.push(n),o.push(i[c]);return o}})();function V4(t){return t?t.content&&t.type?rf(t.content,!0):t.data?B0(t.data):t.asNodeBuffer&&Cr?B0(t.asNodeBuffer().toString("binary")):t.asBinary?B0(t.asBinary()):t._data&&t._data.getContent?B0(rf(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function G4(t){if(!t)return null;if(t.data)return V_(t.data);if(t.asNodeBuffer&&Cr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?V_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function j8(t){return t&&t.name.slice(-4)===".bin"?G4(t):V4(t)}function ro(t,e){for(var r=t.FullPaths||un(t.files),a=e.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||n==o)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function u2(t,e){var r=ro(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Tn(t,e,r){if(!r)return j8(u2(t,e));if(!e)return null;try{return Tn(t,e)}catch{return null}}function Fs(t,e,r){if(!r)return V4(u2(t,e));if(!e)return null;try{return Fs(t,e)}catch{return null}}function C8(t,e,r){return G4(u2(t,e))}function nw(t){for(var e=t.FullPaths||un(t.files),r=[],a=0;a<e.length;++a)e[a].slice(-1)!="/"&&r.push(e[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Ar(t,e,r){if(t.FullPaths){if(typeof r=="string"){var a;return Cr?a=oc(r):a=XN(r),ar.utils.cfb_add(t,e,a)}ar.utils.cfb_add(t,e,r)}else t.file(e,r)}function f2(){return ar.utils.cfb_new()}function $4(t,e){switch(e.type){case"base64":return ar.read(t,{type:"base64"});case"binary":return ar.read(t,{type:"binary"});case"buffer":case"array":return ar.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function q0(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var a=t.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var _n=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,O8=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,iw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,F8=/<[^>]*>/g,Oi=_n.match(iw)?iw:F8,R8=/<\w*:/,L8=/<(\/?)\w+:/;function dr(t,e,r){for(var a={},n=0,i=0;n!==t.length&&!((i=t.charCodeAt(n))===32||i===10||i===13);++n);if(e||(a[0]=t.slice(0,n)),n===t.length)return a;var o=t.match(O8),c=0,u="",h=0,d="",v="",y=1;if(o)for(h=0;h!=o.length;++h){for(v=o[h],i=0;i!=v.length&&v.charCodeAt(i)!==61;++i);for(d=v.slice(0,i).trim();v.charCodeAt(i+1)==32;)++i;for(y=(n=v.charCodeAt(i+1))==34||n==39?1:0,u=v.slice(i+1+y,v.length-y),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=u,a[d.toLowerCase()]=u;else{var g=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(a[g]&&d.slice(c-3,c)=="ext")continue;a[g]=u,a[g.toLowerCase()]=u}}return a}function wl(t){return t.replace(L8,"<$1")}var X4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},h2=Mp(X4),Yr=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(t,function(c,u){return X4[c]||String.fromCharCode(parseInt(u,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,u){return String.fromCharCode(parseInt(u,16))});var o=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,o)+r(n.slice(o+3))}})(),d2=/[&<>'"]/g,D8=/[\u0000-\u0008\u000b-\u001f]/g;function fa(t){var e=t+"";return e.replace(d2,function(r){return h2[r]}).replace(D8,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function sw(t){return fa(t).replace(/ /g,"_x0020_")}var Y4=/[\u0000-\u001f]/g;function p2(t){var e=t+"";return e.replace(d2,function(r){return h2[r]}).replace(/\n/g,"<br/>").replace(Y4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function P8(t){var e=t+"";return e.replace(d2,function(r){return h2[r]}).replace(Y4,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var ow=(function(){var t=/&#(\d+);/g;function e(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(t,e)}})();function M8(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Oa(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function xg(t){for(var e="",r=0,a=0,n=0,i=0,o=0,c=0;r<t.length;){if(a=t.charCodeAt(r++),a<128){e+=String.fromCharCode(a);continue}if(n=t.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=n&63,e+=String.fromCharCode(o);continue}if(i=t.charCodeAt(r++),a<240){e+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}o=t.charCodeAt(r++),c=((a&7)<<18|(n&63)<<12|(i&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function lw(t){var e=eu(2*t.length),r,a,n=1,i=0,o=0,c;for(a=0;a<t.length;a+=n)n=1,(c=t.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(t.charCodeAt(a+1)&63),n=2):c<240?(r=(c&15)*4096+(t.charCodeAt(a+1)&63)*64+(t.charCodeAt(a+2)&63),n=3):(n=4,r=(c&7)*262144+(t.charCodeAt(a+1)&63)*4096+(t.charCodeAt(a+2)&63)*64+(t.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[i++]=o&255,e[i++]=o>>>8,o=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function cw(t){return oc(t,"binary").toString("utf8")}var O1="foo bar baz",ya=Cr&&(cw(O1)==xg(O1)&&cw||lw(O1)==xg(O1)&&lw)||xg,xl=Cr?function(t){return oc(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,a=0,n=0;r<t.length;)switch(a=t.charCodeAt(r++),!0){case a<128:e.push(String.fromCharCode(a));break;case a<2048:e.push(String.fromCharCode(192+(a>>6))),e.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=t.charCodeAt(r++)-56320+(a<<10),e.push(String.fromCharCode(240+(n>>18&7))),e.push(String.fromCharCode(144+(n>>12&63))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)));break;default:e.push(String.fromCharCode(224+(a>>12))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)))}return e.join("")},nd=(function(){var t={};return function(r,a){var n=r+"|"+(a||"");return t[n]?t[n]:t[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),K4=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<t.length;++n)a=a.replace(t[n][0],t[n][1]);return a}})(),I8=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),B8=/<\/?(?:vt:)?variant>/g,U8=/<(?:vt:)([^>]*)>([\s\S]*)</;function uw(t,e){var r=dr(t),a=t.match(I8(r.baseType))||[],n=[];if(a.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(i){var o=i.replace(B8,"").match(U8);o&&n.push({v:ya(o[2]),t:o[1]})}),n}var J4=/(^\s|\s$|\n)/;function pi(t,e){return"<"+t+(e.match(J4)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function id(t){return un(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function St(t,e,r){return"<"+t+(r!=null?id(r):"")+(e!=null?(e.match(J4)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function wv(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function q8(t,e){switch(typeof t){case"string":var r=St("vt:lpwstr",fa(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return St((t|0)==t?"vt:i4":"vt:r8",fa(String(t)));case"boolean":return St("vt:bool",t?"true":"false")}if(t instanceof Date)return St("vt:filetime",wv(t));throw new Error("Unable to serialize "+t)}function m2(t){if(Cr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return ya(iu(o2(t)));throw new Error("Bad input format: expected Buffer or string")}var sd=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,qn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},uf=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ns={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function z8(t,e){for(var r=1-2*(t[e+7]>>>7),a=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),n=t[e+6]&15,i=5;i>=0;--i)n=n*256+t[e+i];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function H8(t,e,r){var a=(e<0||1/e==-1/0?1:0)<<7,n=0,i=0,o=a?-e:e;isFinite(o)?o==0?n=i=0:(n=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(e)?26985:0);for(var c=0;c<=5;++c,i/=256)t[r+c]=i&255;t[r+6]=(n&15)<<4|i&15,t[r+7]=n>>4|a}var fw=function(t){for(var e=[],r=10240,a=0;a<t[0].length;++a)if(t[0][a])for(var n=0,i=t[0][a].length;n<i;n+=r)e.push.apply(e,t[0][a].slice(n,n+r));return e},hw=Cr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:oc(e)})):fw(t)}:fw,dw=function(t,e,r){for(var a=[],n=e;n<r;n+=2)a.push(String.fromCharCode(ec(t,n)));return a.join("").replace(qi,"")},g2=Cr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(qi,""):dw(t,e,r)}:dw,pw=function(t,e,r){for(var a=[],n=e;n<e+r;++n)a.push(("0"+t[n].toString(16)).slice(-2));return a.join("")},Z4=Cr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):pw(t,e,r)}:pw,mw=function(t,e,r){for(var a=[],n=e;n<r;n++)a.push(String.fromCharCode(yh(t,n)));return a.join("")},yd=Cr?function(e,r,a){return Buffer.isBuffer(e)?e.toString("utf8",r,a):mw(e,r,a)}:mw,Q4=function(t,e){var r=Ts(t,e);return r>0?yd(t,e+4,e+4+r-1):""},e3=Q4,t3=function(t,e){var r=Ts(t,e);return r>0?yd(t,e+4,e+4+r-1):""},r3=t3,a3=function(t,e){var r=2*Ts(t,e);return r>0?yd(t,e+4,e+4+r-1):""},n3=a3,i3=function(e,r){var a=Ts(e,r);return a>0?g2(e,r+4,r+4+a):""},s3=i3,o3=function(t,e){var r=Ts(t,e);return r>0?yd(t,e+4,e+4+r):""},l3=o3,c3=function(t,e){return z8(t,e)},vp=c3,v2=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Cr&&(e3=function(e,r){if(!Buffer.isBuffer(e))return Q4(e,r);var a=e.readUInt32LE(r);return a>0?e.toString("utf8",r+4,r+4+a-1):""},r3=function(e,r){if(!Buffer.isBuffer(e))return t3(e,r);var a=e.readUInt32LE(r);return a>0?e.toString("utf8",r+4,r+4+a-1):""},n3=function(e,r){if(!Buffer.isBuffer(e))return a3(e,r);var a=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+a-1)},s3=function(e,r){if(!Buffer.isBuffer(e))return i3(e,r);var a=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+a)},l3=function(e,r){if(!Buffer.isBuffer(e))return o3(e,r);var a=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+a)},vp=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):c3(e,r)},v2=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var yh=function(t,e){return t[e]},ec=function(t,e){return t[e+1]*256+t[e]},W8=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Ts=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Wu=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},V8=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function z0(t,e){var r="",a,n,i=[],o,c,u,h;switch(e){case"dbcs":if(h=this.l,Cr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(u=0;u<t;++u)r+=String.fromCharCode(ec(this,h)),h+=2;t*=2;break;case"utf8":r=yd(this,this.l,this.l+t);break;case"utf16le":t*=2,r=g2(this,this.l,this.l+t);break;case"wstr":return z0.call(this,t,"dbcs");case"lpstr-ansi":r=e3(this,this.l),t=4+Ts(this,this.l);break;case"lpstr-cp":r=r3(this,this.l),t=4+Ts(this,this.l);break;case"lpwstr":r=n3(this,this.l),t=4+2*Ts(this,this.l);break;case"lpp4":t=4+Ts(this,this.l),r=s3(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ts(this,this.l),r=l3(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=yh(this,this.l+t++))!==0;)i.push(C1(o));r=i.join("");break;case"_wstr":for(t=0,r="";(o=ec(this,this.l+t))!==0;)i.push(C1(o)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",h=this.l,u=0;u<t;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=yh(this,h),this.l=h+1,c=z0.call(this,t-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(C1(ec(this,h))),h+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,u=0;u!=t;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=yh(this,h),this.l=h+1,c=z0.call(this,t-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(C1(yh(this,h))),h+=1}r=i.join("");break;default:switch(t){case 1:return a=yh(this,this.l),this.l++,a;case 2:return a=(e==="i"?W8:ec)(this,this.l),this.l+=2,a;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(a=(t>0?Wu:V8)(this,this.l),this.l+=4,a):(n=Ts(this,this.l),this.l+=4,n);case 8:case-8:if(e==="f")return t==8?n=vp(this,this.l):n=vp([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;t=8;case 16:r=Z4(this,this.l,t);break}}return this.l+=t,r}var G8=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},$8=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},X8=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function Y8(t,e,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=e.length;++n)X8(this,e.charCodeAt(n),this.l+2*n);a=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=e.length;++n)this[this.l+n]=e.charCodeAt(n)&255;a=e.length}else if(r==="hex"){for(;n<t;++n)this[this.l++]=parseInt(e.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(n=0;n<Math.min(e.length,t);++n){var o=e.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:a=1,this[this.l]=e&255;break;case 2:a=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:a=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:a=4,G8(this,e,this.l);break;case 8:if(a=8,r==="f"){H8(this,e,this.l);break}case 16:break;case-4:a=4,$8(this,e,this.l);break}return this.l+=a,this}function u3(t,e){var r=Z4(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function di(t,e){t.l=e,t.read_shift=z0,t.chk=u3,t.write_shift=Y8}function Ci(t,e){t.l+=e}function nt(t){var e=eu(t);return di(e,0),e}function lc(t,e,r){if(t){var a,n,i;di(t,t.l||0);for(var o=t.length,c=0,u=0;t.l<o;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var h=hd[c]||hd[65535];for(a=t.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=t.read_shift(1))&127)<<7*n;u=t.l+i;var d=h.f&&h.f(t,i,r);if(t.l=u,e(d,h,c))return}}}function ls(){var t=[],e=Cr?256:2048,r=function(h){var d=nt(h);return di(d,0),d},a=r(e),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&t.push(a),a=null)},i=function(h){return a&&h<a.length-a.l?a:(n(),a=r(Math.max(h+1,e)))},o=function(){return n(),Jn(t)},c=function(h){n(),a=h,a.l==null&&(a.l=a.length),i(e)};return{next:i,push:c,end:o,_bufs:t}}function dt(t,e,r,a){var n=+e,i;if(!isNaN(n)){a||(a=hd[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var o=t.next(i);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var c=0;c!=4;++c)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&v2(r)&&t.push(r)}}function H0(t,e,r){var a=La(t);if(e.s?(a.cRel&&(a.c+=e.s.c),a.rRel&&(a.r+=e.s.r)):(a.cRel&&(a.c+=e.c),a.rRel&&(a.r+=e.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function gw(t,e,r){var a=La(t);return a.s=H0(a.s,e.s,r),a.e=H0(a.e,e.s,r),a}function W0(t,e){if(t.cRel&&t.c<0)for(t=La(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=La(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=hr(t);return!t.cRel&&t.cRel!=null&&(r=Z8(r)),!t.rRel&&t.rRel!=null&&(r=K8(r)),r}function yg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Xa(t.s.c)+":"+(t.e.cRel?"":"$")+Xa(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+yn(t.s.r)+":"+(t.e.rRel?"":"$")+yn(t.e.r):W0(t.s,e.biff)+":"+W0(t.e,e.biff)}function x2(t){return parseInt(J8(t),10)-1}function yn(t){return""+(t+1)}function K8(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function J8(t){return t.replace(/\$(\d+)$/,"$1")}function y2(t){for(var e=Q8(t),r=0,a=0;a!==e.length;++a)r=26*r+e.charCodeAt(a)-64;return r-1}function Xa(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Z8(t){return t.replace(/^([A-Z])/,"$$$1")}function Q8(t){return t.replace(/^\$([A-Z])/,"$1")}function eT(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ya(t){for(var e=0,r=0,a=0;a<t.length;++a){var n=t.charCodeAt(a);n>=48&&n<=57?e=10*e+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:e-1}}function hr(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function cs(t){var e=t.indexOf(":");return e==-1?{s:Ya(t),e:Ya(t)}:{s:Ya(t.slice(0,e)),e:Ya(t.slice(e+1))}}function Er(t,e){return typeof e>"u"||typeof e=="number"?Er(t.s,t.e):(typeof t!="string"&&(t=hr(t)),typeof e!="string"&&(e=hr(e)),t==e?t:t+":"+e)}function Kr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,i=t.length;for(r=0;a<i&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(e.s.c=--r,r=0;a<i&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(e.s.r=--r,a===i||n!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++a,r=0;a!=i&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(e.e.c=--r,r=0;a!=i&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return e.e.r=--r,e}function vw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=io(t.z,r?zn(e):e)}catch{}try{return t.w=io((t.XF||{}).numFmtId||(r?14:0),r?zn(e):e)}catch{return""+e}}function ic(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?cc[t.v]||t.v:e==null?vw(t,t.v):vw(t,e))}function su(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",a={};return a[r]=t,{SheetNames:[r],Sheets:a}}function f3(t,e,r){var a=r||{},n=t?Array.isArray(t):a.dense,i=t||(n?[]:{}),o=0,c=0;if(i&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var u=typeof a.origin=="string"?Ya(a.origin):a.origin;o=u.r,c=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Kr(i["!ref"]);h.s.c=d.s.c,h.s.r=d.s.r,h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),o==-1&&(h.e.r=o=d.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=e[v].length;++y)if(!(typeof e[v][y]>"u")){var g={v:e[v][y]},b=o+v,w=c+y;if(h.s.r>b&&(h.s.r=b),h.s.c>w&&(h.s.c=w),h.e.r<b&&(h.e.r=b),h.e.c<w&&(h.e.c=w),e[v][y]&&typeof e[v][y]=="object"&&!Array.isArray(e[v][y])&&!(e[v][y]instanceof Date))g=e[v][y];else if(Array.isArray(g.v)&&(g.f=e[v][y][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(a.nullError)g.t="e",g.v=0;else if(a.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=a.dateNF||fr[14],a.cellDates?(g.t="d",g.w=io(g.z,zn(g.v))):(g.t="n",g.v=zn(g.v),g.w=io(g.z,g.v))):g.t="s";if(n)i[b]||(i[b]=[]),i[b][w]&&i[b][w].z&&(g.z=i[b][w].z),i[b][w]=g;else{var E=hr({c:w,r:b});i[E]&&i[E].z&&(g.z=i[E].z),i[E]=g}}}return h.s.c<1e7&&(i["!ref"]=Er(h)),i}function Gh(t,e){return f3(null,t,e)}function tT(t){return t.read_shift(4,"i")}function Ho(t,e){return e||(e=nt(4)),e.write_shift(4,t),e}function ji(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Zn(t,e){var r=!1;return e==null&&(r=!0,e=nt(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function rT(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function aT(t,e){return e||(e=nt(4)),e.write_shift(2,0),e.write_shift(2,0),e}function _2(t,e){var r=t.l,a=t.read_shift(1),n=ji(t),i=[],o={t:n,h:n};if((a&1)!==0){for(var c=t.read_shift(4),u=0;u!=c;++u)i.push(rT(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function nT(t,e){var r=!1;return e==null&&(r=!0,e=nt(15+4*t.t.length)),e.write_shift(1,0),Zn(t.t,e),r?e.slice(0,e.l):e}var iT=_2;function sT(t,e){var r=!1;return e==null&&(r=!0,e=nt(23+4*t.t.length)),e.write_shift(1,1),Zn(t.t,e),e.write_shift(4,1),aT({},e),r?e.slice(0,e.l):e}function oo(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ff(t,e){return e==null&&(e=nt(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function hf(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function df(t,e){return e==null&&(e=nt(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var oT=ji,h3=Zn;function w2(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function xp(t,e){var r=!1;return e==null&&(r=!0,e=nt(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var lT=ji,bv=w2,b2=xp;function S2(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,a=e[0]&2;t.l+=4;var n=a===0?vp([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Wu(e,0)>>2;return r?n/100:n}function d3(t,e){e==null&&(e=nt(4));var r=0,a=0,n=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)e.write_shift(-4,((r?n:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function p3(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function cT(t,e){return e||(e=nt(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var pf=p3,$h=cT;function Ti(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function af(t,e){return(e||nt(8)).write_shift(8,t,"f")}function uT(t){var e={},r=t.read_shift(1),a=r>>>1,n=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),c=t.read_shift(1),u=t.read_shift(1);switch(t.l++,a){case 0:e.auto=1;break;case 1:e.index=n;var h=Ku[n];h&&(e.rgb=ld(h));break;case 2:e.rgb=ld([o,c,u]);break;case 3:e.theme=n;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function yp(t,e){if(e||(e=nt(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var a=t.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),e.write_shift(1,parseInt(a.slice(0,2),16)),e.write_shift(1,parseInt(a.slice(2,4),16)),e.write_shift(1,parseInt(a.slice(4,6),16)),e.write_shift(1,255)}return e}function fT(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function hT(t,e){e||(e=nt(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function m3(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=t.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function dT(t){return m3(t,1)}function pT(t){return m3(t,2)}var E2=2,os=3,F1=11,xw=12,_p=19,R1=64,mT=65,gT=71,vT=4108,xT=4126,Yn=80,g3=81,yT=[Yn,g3],Sv={1:{n:"CodePage",t:E2},2:{n:"Category",t:Yn},3:{n:"PresentationFormat",t:Yn},4:{n:"ByteCount",t:os},5:{n:"LineCount",t:os},6:{n:"ParagraphCount",t:os},7:{n:"SlideCount",t:os},8:{n:"NoteCount",t:os},9:{n:"HiddenCount",t:os},10:{n:"MultimediaClipCount",t:os},11:{n:"ScaleCrop",t:F1},12:{n:"HeadingPairs",t:vT},13:{n:"TitlesOfParts",t:xT},14:{n:"Manager",t:Yn},15:{n:"Company",t:Yn},16:{n:"LinksUpToDate",t:F1},17:{n:"CharacterCount",t:os},19:{n:"SharedDoc",t:F1},22:{n:"HyperlinksChanged",t:F1},23:{n:"AppVersion",t:os,p:"version"},24:{n:"DigSig",t:mT},26:{n:"ContentType",t:Yn},27:{n:"ContentStatus",t:Yn},28:{n:"Language",t:Yn},29:{n:"Version",t:Yn},255:{},2147483648:{n:"Locale",t:_p},2147483651:{n:"Behavior",t:_p},1919054434:{}},Ev={1:{n:"CodePage",t:E2},2:{n:"Title",t:Yn},3:{n:"Subject",t:Yn},4:{n:"Author",t:Yn},5:{n:"Keywords",t:Yn},6:{n:"Comments",t:Yn},7:{n:"Template",t:Yn},8:{n:"LastAuthor",t:Yn},9:{n:"RevNumber",t:Yn},10:{n:"EditTime",t:R1},11:{n:"LastPrinted",t:R1},12:{n:"CreatedDate",t:R1},13:{n:"ModifiedDate",t:R1},14:{n:"PageCount",t:os},15:{n:"WordCount",t:os},16:{n:"CharCount",t:os},17:{n:"Thumbnail",t:gT},18:{n:"Application",t:Yn},19:{n:"DocSecurity",t:os},255:{},2147483648:{n:"Locale",t:_p},2147483651:{n:"Behavior",t:_p},1919054434:{}},yw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},_T=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function wT(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var bT=wT([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ku=La(bT),cc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},v3={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},kv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},L1={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function k2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ST(t){var e=k2();if(!t||!t.match)return e;var r={};if((t.match(Oi)||[]).forEach(function(a){var n=dr(a);switch(n[0].replace(R8,"<")){case"<?xml":break;case"<Types":e.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":e[kv[n.ContentType]]!==void 0&&e[kv[n.ContentType]].push(n.PartName);break}}),e.xmlns!==qn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function x3(t,e){var r=S8(kv),a=[],n;a[a.length]=_n,a[a.length]=St("Types",null,{xmlns:qn.CT,"xmlns:xsd":qn.xsd,"xmlns:xsi":qn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return St("Default",null,{Extension:u[0],ContentType:u[1]})}));var i=function(u){t[u]&&t[u].length>0&&(n=t[u][0],a[a.length]=St("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:L1[u][e.bookType]||L1[u].xlsx}))},o=function(u){(t[u]||[]).forEach(function(h){a[a.length]=St("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:L1[u][e.bookType]||L1[u].xlsx})})},c=function(u){(t[u]||[]).forEach(function(h){a[a.length]=St("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[u][0]})})};return i("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Fr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function od(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function V0(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var a={};return(t.match(Oi)||[]).forEach(function(n){var i=dr(n);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:q0(i.Target,e);r[c]=o,a[i.Id]=o}}),r["!id"]=a,r}function Th(t){var e=[_n,St("Relationships",null,{xmlns:qn.RELS})];return un(t["!id"]).forEach(function(r){e[e.length]=St("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ca(t,e,r,a,n,i){if(n||(n={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,n.Id="rId"+e,n.Type=a,n.Target=r,[Fr.HLINK,Fr.XPATH,Fr.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),t["!id"][n.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][n.Id]=n,t[("/"+n.Target).replace("//","/")]=n,e}var ET="application/vnd.oasis.opendocument.spreadsheet";function kT(t,e){for(var r=m2(t),a,n;a=sd.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=dr(a[0],!1),n.path=="/"&&n.type!==ET)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw a}}function AT(t){var e=[_n];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function _w(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function NT(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function TT(t){var e=[_n];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(_w(t[r][0],t[r][1])),e.push(NT("",t[r][0]));return e.push(_w("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function y3(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+hp.version+"</meta:generator></office:meta></office:document-meta>"}var no=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],jT=(function(){for(var t=new Array(no.length),e=0;e<no.length;++e){var r=no[e],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return t})();function _3(t){var e={};t=ya(t);for(var r=0;r<no.length;++r){var a=no[r],n=t.match(jT[r]);n!=null&&n.length>0&&(e[a[1]]=Yr(n[1])),a[2]==="date"&&e[a[1]]&&(e[a[1]]=Ra(e[a[1]]))}return e}function _g(t,e,r,a,n){n[t]!=null||e==null||e===""||(n[t]=e,e=fa(e),a[a.length]=r?St(t,e,r):pi(t,e))}function w3(t,e){var r=e||{},a=[_n,St("cp:coreProperties",null,{"xmlns:cp":qn.CORE_PROPS,"xmlns:dc":qn.dc,"xmlns:dcterms":qn.dcterms,"xmlns:dcmitype":qn.dcmitype,"xmlns:xsi":qn.xsi})],n={};if(!t&&!r.Props)return a.join("");t&&(t.CreatedDate!=null&&_g("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:wv(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),t.ModifiedDate!=null&&_g("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:wv(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=no.length;++i){var o=no[i],c=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&_g(o[0],c,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Ju=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],b3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function S3(t,e,r,a){var n=[];if(typeof t=="string")n=uw(t,a);else for(var i=0;i<t.length;++i)n=n.concat(t[i].map(function(d){return{v:d}}));var o=typeof e=="string"?uw(e,a).map(function(d){return d.v}):e,c=0,u=0;if(o.length>0)for(var h=0;h!==n.length;h+=2){switch(u=+n[h+1].v,n[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(c,c+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(c,c+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(c,c+u);break}c+=u}}function CT(t,e,r){var a={};return e||(e={}),t=ya(t),Ju.forEach(function(n){var i=(t.match(nd(n[0]))||[])[1];switch(n[2]){case"string":i&&(e[n[1]]=Yr(i));break;case"bool":e[n[1]]=i==="true";break;case"raw":var o=t.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(a[n[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&S3(a.HeadingPairs,a.TitlesOfParts,e,r),e}function E3(t){var e=[],r=St;return t||(t={}),t.Application="SheetJS",e[e.length]=_n,e[e.length]=St("Properties",null,{xmlns:qn.EXT_PROPS,"xmlns:vt":qn.vt}),Ju.forEach(function(a){if(t[a[1]]!==void 0){var n;switch(a[2]){case"string":n=fa(String(t[a[1]]));break;case"bool":n=t[a[1]]?"true":"false";break}n!==void 0&&(e[e.length]=r(a[0],n))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(a){return"<vt:lpstr>"+fa(a)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var OT=/<[^>]+>[^<]*/g;function FT(t,e){var r={},a="",n=t.match(OT);if(n)for(var i=0;i!=n.length;++i){var o=n[i],c=dr(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Yr(c.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),h=u[0].slice(4),d=u[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[a]=Yr(d);break;case"bool":r[a]=Oa(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(d);break;case"filetime":case"date":r[a]=Ra(d);break;case"cy":case"error":r[a]=Yr(d);break;default:if(h.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,u)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function k3(t){var e=[_n,St("Properties",null,{xmlns:qn.CUST_PROPS,"xmlns:vt":qn.vt})];if(!t)return e.join("");var r=1;return un(t).forEach(function(n){++r,e[e.length]=St("property",q8(t[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:fa(n)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Av={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},wg;function RT(t,e,r){wg||(wg=Mp(Av)),e=wg[e]||e,t[e]=r}function LT(t,e){var r=[];return un(Av).map(function(a){for(var n=0;n<no.length;++n)if(no[n][1]==a)return no[n];for(n=0;n<Ju.length;++n)if(Ju[n][1]==a)return Ju[n];throw a}).forEach(function(a){if(t[a[1]]!=null){var n=e&&e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:t[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(pi(Av[a[1]]||a[1],n))}}),St("DocumentProperties",r.join(""),{xmlns:Ns.o})}function DT(t,e){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return t&&un(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<no.length;++o)if(i==no[o][1])return;for(o=0;o<Ju.length;++o)if(i==Ju[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var c=t[i],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c=String(c),n.push(St(sw(i),c,{"dt:dt":u}))}}),e&&un(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),n.push(St(sw(i),o,{"dt:dt":c}))}}),"<"+a+' xmlns="'+Ns.o+'">'+n.join("")+"</"+a+">"}function A2(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function PT(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var o=nt(8);return o.write_shift(4,a),o.write_shift(4,n),o}function A3(t,e,r){var a=t.l,n=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-a&3;)++t.l;return n}function N3(t,e,r){var a=t.read_shift(0,"lpwstr");return a}function T3(t,e,r){return e===31?N3(t):A3(t,e,r)}function Nv(t,e,r){return T3(t,e,r===!1?0:4)}function MT(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return T3(t,e,0)}function IT(t){for(var e=t.read_shift(4),r=[],a=0;a!=e;++a){var n=t.l;r[a]=t.read_shift(0,"lpwstr").replace(qi,""),t.l-n&2&&(t.l+=2)}return r}function BT(t){for(var e=t.read_shift(4),r=[],a=0;a!=e;++a)r[a]=t.read_shift(0,"lpstr-cp").replace(qi,"");return r}function UT(t){var e=t.l,r=wp(t,g3);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var a=wp(t,os);return[r,a]}function qT(t){for(var e=t.read_shift(4),r=[],a=0;a<e/2;++a)r.push(UT(t));return r}function ww(t,e){for(var r=t.read_shift(4),a={},n=0;n!=r;++n){var i=t.read_shift(4),o=t.read_shift(4);a[i]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(qi,"").replace(U0,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),a}function j3(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function zT(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function wp(t,e,r){var a=t.read_shift(2),n,i=r||{};if(t.l+=2,e!==xw&&a!==e&&yT.indexOf(e)===-1&&!((e&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+e+" saw "+a);switch(e===xw?a:e){case 2:return n=t.read_shift(2,"i"),i.raw||(t.l+=2),n;case 3:return n=t.read_shift(4,"i"),n;case 11:return t.read_shift(4)!==0;case 19:return n=t.read_shift(4),n;case 30:return A3(t,a,4).replace(qi,"");case 31:return N3(t);case 64:return A2(t);case 65:return j3(t);case 71:return zT(t);case 80:return Nv(t,a,!i.raw).replace(qi,"");case 81:return MT(t,a).replace(qi,"");case 4108:return qT(t);case 4126:case 4127:return a==4127?IT(t):BT(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+a)}}function bw(t,e){var r=nt(4),a=nt(4);switch(r.write_shift(4,t==80?31:t),t){case 3:a.write_shift(-4,e);break;case 5:a=nt(8),a.write_shift(8,e,"f");break;case 11:a.write_shift(4,e?1:0);break;case 64:a=PT(e);break;case 31:case 80:for(a=nt(4+2*(e.length+1)+(e.length%2?0:2)),a.write_shift(4,e.length+1),a.write_shift(0,e,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Jn([r,a])}function Sw(t,e){var r=t.l,a=t.read_shift(4),n=t.read_shift(4),i=[],o=0,c=0,u=-1,h={};for(o=0;o!=n;++o){var d=t.read_shift(4),v=t.read_shift(4);i[o]=[d,v+r]}i.sort(function(O,T){return O[1]-T[1]});var y={};for(o=0;o!=n;++o){if(t.l!==i[o][1]){var g=!0;if(o>0&&e)switch(e[i[o-1][0]].t){case 2:t.l+2===i[o][1]&&(t.l+=2,g=!1);break;case 80:t.l<=i[o][1]&&(t.l=i[o][1],g=!1);break;case 4108:t.l<=i[o][1]&&(t.l=i[o][1],g=!1);break}if((!e||o==0)&&t.l<=i[o][1]&&(g=!1,t.l=i[o][1]),g)throw new Error("Read Error: Expected address "+i[o][1]+" at "+t.l+" :"+o)}if(e){var b=e[i[o][0]];if(y[b.n]=wp(t,b.t,{raw:!0}),b.p==="version"&&(y[b.n]=String(y[b.n]>>16)+"."+("0000"+String(y[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(y[b.n]){case 0:y[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Uo(c=y[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[b.n])}}else if(i[o][0]===1){if(c=y.CodePage=wp(t,E2),Uo(c),u!==-1){var w=t.l;t.l=i[u][1],h=ww(t,c),t.l=w}}else if(i[o][0]===0){if(c===0){u=o,t.l=i[o+1][1];continue}h=ww(t,c)}else{var E=h[i[o][0]],A;switch(t[t.l]){case 65:t.l+=4,A=j3(t);break;case 30:t.l+=4,A=Nv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,A=Nv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,A=t.read_shift(4,"i");break;case 19:t.l+=4,A=t.read_shift(4);break;case 5:t.l+=4,A=t.read_shift(8,"f");break;case 11:t.l+=4,A=mn(t,4);break;case 64:t.l+=4,A=Ra(A2(t));break;default:throw new Error("unparsed value: "+t[t.l])}y[E]=A}}return t.l=r+a,y}var C3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function HT(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Ew(t,e,r){var a=nt(8),n=[],i=[],o=8,c=0,u=nt(8),h=nt(8);if(u.write_shift(4,2),u.write_shift(4,1200),h.write_shift(4,1),i.push(u),n.push(h),o+=8+u.length,!e){h=nt(8),h.write_shift(4,0),n.unshift(h);var d=[nt(4)];for(d[0].write_shift(4,t.length),c=0;c<t.length;++c){var v=t[c][0];for(u=nt(8+2*(v.length+1)+(v.length%2?0:2)),u.write_shift(4,c+2),u.write_shift(4,v.length+1),u.write_shift(0,v,"dbcs");u.l!=u.length;)u.write_shift(1,0);d.push(u)}u=Jn(d),i.unshift(u),o+=8+u.length}for(c=0;c<t.length;++c)if(!(e&&!e[t[c][0]])&&!(C3.indexOf(t[c][0])>-1||b3.indexOf(t[c][0])>-1)&&t[c][1]!=null){var y=t[c][1],g=0;if(e){g=+e[t[c][0]];var b=r[g];if(b.p=="version"&&typeof y=="string"){var w=y.split(".");y=(+w[0]<<16)+(+w[1]||0)}u=bw(b.t,y)}else{var E=HT(y);E==-1&&(E=31,y=String(y)),u=bw(E,y)}i.push(u),h=nt(8),h.write_shift(4,e?g:2+c),n.push(h),o+=8+u.length}var A=8*(i.length+1);for(c=0;c<i.length;++c)n[c].write_shift(4,A),A+=i[c].length;return a.write_shift(4,o),a.write_shift(4,i.length),Jn([a].concat(n).concat(i))}function kw(t,e,r){var a=t.content;if(!a)return{};di(a,0);var n,i,o,c,u=0;a.chk("feff","Byte Order: "),a.read_shift(2);var h=a.read_shift(4),d=a.read_shift(16);if(d!==ar.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),c=a.read_shift(4),n===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);n===2&&(o=a.read_shift(16),u=a.read_shift(4));var v=Sw(a,e),y={SystemIdentifier:h};for(var g in v)y[g]=v[g];if(y.FMTID=i,n===1)return y;if(u-a.l==2&&(a.l+=2),a.l!==u)throw new Error("Length mismatch 2: "+a.l+" !== "+u);var b;try{b=Sw(a,null)}catch{}for(g in b)y[g]=b[g];return y.FMTID=[i,o],y}function Aw(t,e,r,a,n,i){var o=nt(n?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,ar.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,n?68:48);var u=Ew(t,r,a);if(c.push(u),n){var h=Ew(n,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+u.length),c.push(h)}return Jn(c)}function Wc(t,e){return t.read_shift(e),null}function WT(t,e){e||(e=nt(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function VT(t,e,r){for(var a=[],n=t.l+e;t.l<n;)a.push(r(t,n-t.l));if(n!==t.l)throw new Error("Slurp error");return a}function mn(t,e){return t.read_shift(e)===1}function Ui(t,e){return e||(e=nt(2)),e.write_shift(2,+!!t),e}function jn(t){return t.read_shift(2,"u")}function ao(t,e){return e||(e=nt(2)),e.write_shift(2,t),e}function O3(t,e){return VT(t,e,jn)}function GT(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function F3(t,e,r){return r||(r=nt(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function _d(t,e,r){var a=t.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=a?t.read_shift(a,n):"";return o}function $T(t){var e=t.read_shift(2),r=t.read_shift(1),a=r&4,n=r&8,i=1+(r&1),o=0,c,u={};n&&(o=t.read_shift(2)),a&&(c=t.read_shift(4));var h=i==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,h);return n&&(t.l+=4*o),a&&(t.l+=c),u.t=d,n||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function XT(t){var e=t.t||"",r=nt(3);r.write_shift(2,e.length),r.write_shift(1,1);var a=nt(2*e.length);a.write_shift(2*e.length,e,"utf16le");var n=[r,a];return Jn(n)}function nf(t,e,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var n=t.read_shift(1);return n===0?a=t.read_shift(e,"sbcs-cont"):a=t.read_shift(e,"dbcs-cont"),a}function wd(t,e,r){var a=t.read_shift(r&&r.biff==2?1:2);return a===0?(t.l++,""):nf(t,a,r)}function mf(t,e,r){if(r.biff>5)return wd(t,e,r);var a=t.read_shift(1);return a===0?(t.l++,""):t.read_shift(a,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function R3(t,e,r){return r||(r=nt(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function YT(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function KT(t){var e=t.read_shift(4),r=t.l,a=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),t.l=r);var n=t.read_shift((a?e-24:e)>>1,"utf16le").replace(qi,"");return a&&(t.l+=24),n}function JT(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var a=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=t.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(i>>1,"utf16le").replace(qi,"");return r+o}function ZT(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return KT(t);case"0303000000000000c000000000000046":return JT(t);default:throw new Error("Unsupported Moniker "+r)}}function D1(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(qi,""):"";return r}function Nw(t,e){e||(e=nt(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function QT(t,e){var r=t.l+e,a=t.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=t.read_shift(2);t.l+=2;var i,o,c,u,h="",d,v;n&16&&(i=D1(t,r-t.l)),n&128&&(o=D1(t,r-t.l)),(n&257)===257&&(c=D1(t,r-t.l)),(n&257)===1&&(u=ZT(t,r-t.l)),n&8&&(h=D1(t,r-t.l)),n&32&&(d=t.read_shift(16)),n&64&&(v=A2(t)),t.l=r;var y=o||c||u||"";y&&h&&(y+="#"+h),y||(y="#"+h),n&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var g={Target:y};return d&&(g.guid=d),v&&(g.time=v),i&&(g.Tooltip=i),g}function ej(t){var e=nt(512),r=0,a=t.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(i==28)a=a.slice(1),Nw(a,e);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var c=n>-1?a.slice(0,n):a;for(e.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)e.write_shift(2,c.charCodeAt(r));e.write_shift(2,0),i&8&&Nw(n>-1?a.slice(n+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var u=0;a.slice(u*3,u*3+3)=="../"||a.slice(u*3,u*3+3)=="..\\";)++u;for(e.write_shift(2,u),e.write_shift(4,a.length-3*u+1),r=0;r<a.length-3*u;++r)e.write_shift(1,a.charCodeAt(r+3*u)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function L3(t){var e=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1),n=t.read_shift(1);return[e,r,a,n]}function D3(t,e){var r=L3(t);return r[3]=0,r}function bl(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{r:e,c:r,ixfe:a}}function sf(t,e,r,a){return a||(a=nt(6)),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(2,r||0),a}function tj(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function rj(t,e,r){return e===0?"":mf(t,e,r)}function aj(t,e,r){var a=r.biff>8?4:2,n=t.read_shift(a),i=t.read_shift(a,"i"),o=t.read_shift(a,"i");return[n,i,o]}function P3(t){var e=t.read_shift(2),r=S2(t);return[e,r]}function nj(t,e,r){t.l+=4,e-=4;var a=t.l+e,n=_d(t,e,r),i=t.read_shift(2);if(a-=t.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return t.l+=i,n}function Up(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2);return{s:{c:a,r:e},e:{c:n,r}}}function M3(t,e){return e||(e=nt(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function I3(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(1),n=t.read_shift(1);return{s:{c:a,r:e},e:{c:n,r}}}var ij=I3;function B3(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return t.l+=12,[r,e,a]}function sj(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function oj(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function _i(t){t.l+=2,t.l+=t.read_shift(2)}var lj={0:_i,4:_i,5:_i,6:_i,7:oj,8:_i,9:_i,10:_i,11:_i,12:_i,13:sj,14:_i,15:_i,16:_i,17:_i,18:_i,19:_i,20:_i,21:B3};function cj(t,e){for(var r=t.l+e,a=[];t.l<r;){var n=t.read_shift(2);t.l-=2;try{a.push(lj[n](t,r-t.l))}catch{return t.l=r,a}}return t.l!=r&&(t.l=r),a}function P1(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function N2(t,e,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=nt(n);return i.write_shift(2,a),i.write_shift(2,e),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function uj(t,e){return e===0||t.read_shift(2),1200}function fj(t,e,r){if(r.enc)return t.l+=e,"";var a=t.l,n=mf(t,0,r);return t.read_shift(e+a-t.l),n}function hj(t,e){var r=!e||e.biff==8,a=nt(r?112:54);for(a.write_shift(e.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function dj(t,e,r){var a=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function pj(t,e,r){var a=t.read_shift(4),n=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=_d(t,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:n,dt:i,name:o}}function mj(t,e){var r=!e||e.biff>=8?2:1,a=nt(8+r*t.name.length);a.write_shift(4,t.pos),a.write_shift(1,t.hs||0),a.write_shift(1,t.dt),a.write_shift(1,t.name.length),e.biff>=8&&a.write_shift(1,1),a.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function gj(t,e){for(var r=t.l+e,a=t.read_shift(4),n=t.read_shift(4),i=[],o=0;o!=n&&t.l<r;++o)i.push($T(t));return i.Count=a,i.Unique=n,i}function vj(t,e){var r=nt(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var a=[],n=0;n<t.length;++n)a[n]=XT(t[n]);var i=Jn([r].concat(a));return i.parts=[r.length].concat(a.map(function(o){return o.length})),i}function xj(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function yj(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var a=t.read_shift(1);return t.l+=3,a&7&&(e.level=a&7),a&32&&(e.hidden=!0),a&64&&(e.hpt=r/20),e}function _j(t){var e=tj(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function wj(t){return t.read_shift(2),t.read_shift(4)}function Tw(t,e,r){var a=0;r&&r.biff==2||(a=t.read_shift(2));var n=t.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function bj(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2);return{Pos:[e,r],Dim:[a,n],Flags:i,CurTab:o,FirstTab:c,Selected:u,TabRatio:h}}function Sj(){var t=nt(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Ej(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=t.read_shift(2);return{RTL:a&64}}function kj(t){var e=nt(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Aj(){}function Nj(t,e,r){var a={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return a.name=_d(t,0,r),a}function Tj(t,e){var r=t.name||"Arial",a=e&&e.biff==5,n=a?15+r.length:16+2*r.length,i=nt(n);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function jj(t){var e=bl(t);return e.isst=t.read_shift(4),e}function Cj(t,e,r,a){var n=nt(10);return sf(t,e,a,n),n.write_shift(4,r),n}function Oj(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=t.l+e,n=bl(t);r.biff==2&&t.l++;var i=wd(t,a-t.l,r);return n.val=i,n}function Fj(t,e,r,a,n){var i=!n||n.biff==8,o=nt(8+ +i+(1+i)*r.length);return sf(t,e,a,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function Rj(t,e,r){var a=t.read_shift(2),n=mf(t,0,r);return[a,n]}function Lj(t,e,r,a){var n=r&&r.biff==5;a||(a=nt(n?3+e.length:5+2*e.length)),a.write_shift(2,t),a.write_shift(n?1:2,e.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var Dj=mf;function jw(t,e,r){var a=t.l+e,n=r.biff==8||!r.biff?4:2,i=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(2),u=t.read_shift(2);return t.l=a,{s:{r:i,c},e:{r:o,c:u}}}function Pj(t,e){var r=e.biff==8||!e.biff?4:2,a=nt(2*r+6);return a.write_shift(r,t.s.r),a.write_shift(r,t.e.r+1),a.write_shift(2,t.s.c),a.write_shift(2,t.e.c+1),a.write_shift(2,0),a}function Mj(t){var e=t.read_shift(2),r=t.read_shift(2),a=P3(t);return{r:e,c:r,ixfe:a[0],rknum:a[1]}}function Ij(t,e){for(var r=t.l+e-2,a=t.read_shift(2),n=t.read_shift(2),i=[];t.l<r;)i.push(P3(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(i.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:o,rkrec:i}}function Bj(t,e){for(var r=t.l+e-2,a=t.read_shift(2),n=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(i.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:o,ixfe:i}}function Uj(t,e,r,a){var n={},i=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(4),u=t.read_shift(2);return n.patternType=_T[c>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=c&127,n.icvBottom=c>>7&127,n.icvDiag=c>>14&127,n.dgDiag=c>>21&15,n.icvFore=u&127,n.icvBack=u>>7&127,n.fsxButton=u>>14&1),n}function qj(t,e,r){var a={};return a.ifnt=t.read_shift(2),a.numFmtId=t.read_shift(2),a.flags=t.read_shift(2),a.fStyle=a.flags>>2&1,e-=6,a.data=Uj(t,e,a.fStyle,r),a}function Cw(t,e,r,a){var n=r&&r.biff==5;a||(a=nt(n?16:20)),a.write_shift(2,0),t.style?(a.write_shift(2,t.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,t.numFmtId||0),a.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function zj(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Hj(t){var e=nt(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Ow(t,e,r){var a=bl(t);(r.biff==2||e==9)&&++t.l;var n=GT(t);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function Wj(t,e,r,a,n,i){var o=nt(8);return sf(t,e,a,o),F3(r,i,o),o}function Vj(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=bl(t),n=Ti(t);return a.val=n,a}function Gj(t,e,r,a){var n=nt(14);return sf(t,e,a,n),af(r,n),n}var Fw=rj;function $j(t,e,r){var a=t.l+e,n=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=nf(t,i),c=[];a>t.l;)c.push(wd(t));return[i,n,o,c]}function Rw(t,e,r){var a=t.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=nj(t,e-2,r)),i.body=n||t.read_shift(e-2),typeof n=="string"&&(i.Name=n),i}var Xj=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Lw(t,e,r){var a=t.l+e,n=t.read_shift(2),i=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),u=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var h=nf(t,o,r);n&32&&(h=Xj[h.charCodeAt(0)]);var d=a-t.l;r&&r.biff==2&&--d;var v=a==t.l||c===0||!(d>0)?[]:cR(t,d,r,c);return{chKey:i,Name:h,itab:u,rgce:v}}function U3(t,e,r){if(r.biff<8)return Yj(t,e,r);for(var a=[],n=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)a.push(aj(t,r.biff>8?12:6,r));if(t.l!=n)throw new Error("Bad ExternSheet: "+t.l+" != "+n);return a}function Yj(t,e,r){t[t.l+1]==3&&t[t.l]++;var a=_d(t,e,r);return a.charCodeAt(0)==3?a.slice(1):a}function Kj(t,e,r){if(r.biff<8){t.l+=e;return}var a=t.read_shift(2),n=t.read_shift(2),i=nf(t,a,r),o=nf(t,n,r);return[i,o]}function Jj(t,e,r){var a=I3(t);t.l++;var n=t.read_shift(1);return e-=8,[uR(t,e,r),n,a]}function Dw(t,e,r){var a=ij(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[a,oR(t,e,r)]}function Zj(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,a=t.read_shift(4);return[e,r,a]}function Qj(t,e,r){if(!(r.biff<8)){var a=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=mf(t,0,r);return r.biff<8&&t.read_shift(1),[{r:a,c:n},c,o,i]}}function eC(t,e,r){return Qj(t,e,r)}function tC(t,e){for(var r=[],a=t.read_shift(2);a--;)r.push(Up(t));return r}function rC(t){var e=nt(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)M3(t[r],e);return e}function aC(t,e,r){if(r&&r.biff<8)return iC(t,e,r);var a=B3(t),n=cj(t,e-22,a[1]);return{cmo:a,ft:n}}var nC={8:function(t,e){var r=t.l+e;t.l+=10;var a=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var n=t.read_shift(1);return t.l+=n,t.l=r,{fmt:a}}};function iC(t,e,r){t.l+=4;var a=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((nC[a]||Ci)(t,e,r)),{cmo:[n,a,i],ft:o}}function sC(t,e,r){var a=t.l,n="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:o=YT(t,6,r);var c=t.read_shift(2);t.read_shift(2),jn(t,2);var u=t.read_shift(2);t.l+=u;for(var h=1;h<t.lens.length-1;++h){if(t.l-a!=t.lens[h])throw new Error("TxO: bad continue record");var d=t[t.l],v=nf(t,t.lens[h+1]-t.lens[h]-1);if(n+=v,n.length>=(d?c:2*c))break}if(n.length!==c&&n.length!==c*2)throw new Error("cchText: "+c+" != "+n.length);return t.l=a+e,{t:n}}catch{return t.l=a+e,{t:n}}}function oC(t,e){var r=Up(t);t.l+=16;var a=QT(t,e-24);return[r,a]}function lC(t){var e=nt(24),r=Ya(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)e.write_shift(1,parseInt(a[n],16));return Jn([e,ej(t[1])])}function cC(t,e){t.read_shift(2);var r=Up(t),a=t.read_shift((e-10)/2,"dbcs-cont");return a=a.replace(qi,""),[r,a]}function uC(t){var e=t[1].Tooltip,r=nt(10+2*(e.length+1));r.write_shift(2,2048);var a=Ya(t[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<e.length;++n)r.write_shift(2,e.charCodeAt(n));return r.write_shift(2,0),r}function fC(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=yw[r]||r,r=t.read_shift(2),e[1]=yw[r]||r,e}function hC(t){return t||(t=nt(4)),t.write_shift(2,1),t.write_shift(2,1),t}function dC(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(D3(t));return r}function pC(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(D3(t));return r}function mC(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function q3(t,e,r){if(!r.cellStyles)return Ci(t,e);var a=r&&r.biff>=12?4:2,n=t.read_shift(a),i=t.read_shift(a),o=t.read_shift(a),c=t.read_shift(a),u=t.read_shift(2);a==2&&(t.l+=2);var h={s:n,e:i,w:o,ixfe:c,flags:u};return(r.biff>=5||!r.biff)&&(h.level=u>>8&7),h}function gC(t,e){var r=nt(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var a=0;return t.hidden&&(a|=1),r.write_shift(1,a),a=t.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function vC(t,e){var r={};return e<32||(t.l+=16,r.header=Ti(t),r.footer=Ti(t),t.l+=2),r}function xC(t,e,r){var a={area:!1};if(r.biff!=5)return t.l+=e,a;var n=t.read_shift(1);return t.l+=3,n&16&&(a.area=!0),a}function yC(t){for(var e=nt(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var _C=bl,wC=O3,bC=wd;function SC(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n={fmt:e,env:r,len:a,data:t.slice(t.l,t.l+a)};return t.l+=a,n}function EC(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=bl(t);++t.l;var n=mf(t,e-7,r);return a.t="str",a.val=n,a}function kC(t){var e=bl(t);++t.l;var r=Ti(t);return e.t="n",e.val=r,e}function AC(t,e,r){var a=nt(15);return kd(a,t,e),a.write_shift(8,r,"f"),a}function NC(t){var e=bl(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function TC(t,e,r){var a=nt(9);return kd(a,t,e),a.write_shift(2,r),a}function jC(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function CC(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function OC(t,e,r){var a=t.l+e,n=bl(t),i=t.read_shift(2),o=nf(t,i,r);return t.l=a,n.t="str",n.val=o,n}var FC=[2,3,48,49,131,139,140,245],Tv=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Mp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,u){var h=[],d=eu(1);switch(u.type){case"base64":d=Os(Ls(c));break;case"binary":d=Os(c);break;case"buffer":case"array":d=c;break}di(d,0);var v=d.read_shift(1),y=!!(v&136),g=!1,b=!1;switch(v){case 2:break;case 3:break;case 48:g=!0,y=!0;break;case 49:g=!0,y=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var w=0,E=521;v==2&&(w=d.read_shift(2)),d.l+=3,v!=2&&(w=d.read_shift(4)),w>1048576&&(w=1e6),v!=2&&(E=d.read_shift(2));var A=d.read_shift(2),O=u.codepage||1252;v!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(O=t[d[d.l]]),d.l+=1,d.l+=2),b&&(d.l+=36);for(var T=[],R={},H=Math.min(d.length,v==2?521:E-10-(g?264:0)),z=b?32:11;d.l<H&&d[d.l]!=13;)switch(R={},R.name=td.utils.decode(O,d.slice(d.l,d.l+z)).replace(/[\u0000\r\n].*$/g,""),d.l+=z,R.type=String.fromCharCode(d.read_shift(1)),v!=2&&!b&&(R.offset=d.read_shift(4)),R.len=d.read_shift(1),v==2&&(R.offset=d.read_shift(2)),R.dec=d.read_shift(1),R.name.length&&T.push(R),v!=2&&(d.l+=b?13:14),R.type){case"B":(!g||R.len!=8)&&u.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(d[d.l]!==13&&(d.l=E-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=E;var F=0,W=0;for(h[0]=[],W=0;W!=T.length;++W)h[0][W]=T[W].name;for(;w-- >0;){if(d[d.l]===42){d.l+=A;continue}for(++d.l,h[++F]=[],W=0,W=0;W!=T.length;++W){var D=d.slice(d.l,d.l+T[W].len);d.l+=T[W].len,di(D,0);var Y=td.utils.decode(O,D);switch(T[W].type){case"C":Y.trim().length&&(h[F][W]=Y.replace(/\s+$/,""));break;case"D":Y.length===8?h[F][W]=new Date(+Y.slice(0,4),+Y.slice(4,6)-1,+Y.slice(6,8)):h[F][W]=Y;break;case"F":h[F][W]=parseFloat(Y.trim());break;case"+":case"I":h[F][W]=b?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(Y.trim().toUpperCase()){case"Y":case"T":h[F][W]=!0;break;case"N":case"F":h[F][W]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Y+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));h[F][W]="##MEMO##"+(b?parseInt(Y.trim(),10):D.read_shift(4));break;case"N":Y=Y.replace(/\u0000/g,"").trim(),Y&&Y!="."&&(h[F][W]=+Y||0);break;case"@":h[F][W]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":h[F][W]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":h[F][W]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[F][W]=-D.read_shift(-8,"f");break;case"B":if(g&&T[W].len==8){h[F][W]=D.read_shift(8,"f");break}case"G":case"P":D.l+=T[W].len;break;case"0":if(T[W].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[W].type)}}}if(v!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(h=h.slice(0,u.sheetRows)),u.DBF=T,h}function a(c,u){var h=u||{};h.dateNF||(h.dateNF="yyyymmdd");var d=Gh(r(c,h),h);return d["!cols"]=h.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete h.DBF,d}function n(c,u){try{return su(a(c,u),u)}catch(h){if(u&&u.WTF)throw h}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,u){var h=u||{};if(+h.codepage>=0&&Uo(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var d=ls(),v=Ep(c,{header:1,raw:!0,cellDates:!0}),y=v[0],g=v.slice(1),b=c["!cols"]||[],w=0,E=0,A=0,O=1;for(w=0;w<y.length;++w){if(((b[w]||{}).DBF||{}).name){y[w]=b[w].DBF.name,++A;continue}if(y[w]!=null){if(++A,typeof y[w]=="number"&&(y[w]=y[w].toString(10)),typeof y[w]!="string")throw new Error("DBF Invalid column name "+y[w]+" |"+typeof y[w]+"|");if(y.indexOf(y[w])!==w){for(E=0;E<1024;++E)if(y.indexOf(y[w]+"_"+E)==-1){y[w]+="_"+E;break}}}}var T=Kr(c["!ref"]),R=[],H=[],z=[];for(w=0;w<=T.e.c-T.s.c;++w){var F="",W="",D=0,Y=[];for(E=0;E<g.length;++E)g[E][w]!=null&&Y.push(g[E][w]);if(Y.length==0||y[w]==null){R[w]="?";continue}for(E=0;E<Y.length;++E){switch(typeof Y[E]){case"number":W="B";break;case"string":W="C";break;case"boolean":W="L";break;case"object":W=Y[E]instanceof Date?"D":"C";break;default:W="C"}D=Math.max(D,String(Y[E]).length),F=F&&F!=W?"C":W}D>250&&(D=250),W=((b[w]||{}).DBF||{}).type,W=="C"&&b[w].DBF.len>D&&(D=b[w].DBF.len),F=="B"&&W=="N"&&(F="N",z[w]=b[w].DBF.dec,D=b[w].DBF.len),H[w]=F=="C"||W=="N"?D:i[F]||0,O+=H[w],R[w]=F}var I=d.next(32);for(I.write_shift(4,318902576),I.write_shift(4,g.length),I.write_shift(2,296+32*A),I.write_shift(2,O),w=0;w<4;++w)I.write_shift(4,0);for(I.write_shift(4,0|(+e[C4]||3)<<8),w=0,E=0;w<y.length;++w)if(y[w]!=null){var L=d.next(32),ee=(y[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,ee,"sbcs"),L.write_shift(1,R[w]=="?"?"C":R[w],"sbcs"),L.write_shift(4,E),L.write_shift(1,H[w]||i[R[w]]||0),L.write_shift(1,z[w]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),E+=H[w]||i[R[w]]||0}var oe=d.next(264);for(oe.write_shift(4,13),w=0;w<65;++w)oe.write_shift(4,0);for(w=0;w<g.length;++w){var ge=d.next(O);for(ge.write_shift(1,0),E=0;E<y.length;++E)if(y[E]!=null)switch(R[E]){case"L":ge.write_shift(1,g[w][E]==null?63:g[w][E]?84:70);break;case"B":ge.write_shift(8,g[w][E]||0,"f");break;case"N":var ie="0";for(typeof g[w][E]=="number"&&(ie=g[w][E].toFixed(z[E]||0)),A=0;A<H[E]-ie.length;++A)ge.write_shift(1,32);ge.write_shift(1,ie,"sbcs");break;case"D":g[w][E]?(ge.write_shift(4,("0000"+g[w][E].getFullYear()).slice(-4),"sbcs"),ge.write_shift(2,("00"+(g[w][E].getMonth()+1)).slice(-2),"sbcs"),ge.write_shift(2,("00"+g[w][E].getDate()).slice(-2),"sbcs")):ge.write_shift(8,"00000000","sbcs");break;case"C":var he=String(g[w][E]!=null?g[w][E]:"").slice(0,H[E]);for(ge.write_shift(1,he,"sbcs"),A=0;A<H[E]-he.length;++A)ge.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:a,from_sheet:o}})(),z3=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+un(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(y,g){var b=t[g];return typeof b=="number"?G_(b):b},a=function(y,g,b){var w=g.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return w==59?y:G_(w)};t["|"]=254;function n(y,g){switch(g.type){case"base64":return i(Ls(y),g);case"binary":return i(y,g);case"buffer":return i(Cr&&Buffer.isBuffer(y)?y.toString("binary"):iu(y),g);case"array":return i(rf(y),g)}throw new Error("Unrecognized type "+g.type)}function i(y,g){var b=y.split(/[\n\r]+/),w=-1,E=-1,A=0,O=0,T=[],R=[],H=null,z={},F=[],W=[],D=[],Y=0,I;for(+g.codepage>=0&&Uo(+g.codepage);A!==b.length;++A){Y=0;var L=b[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(e,r),ee=L.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),oe=ee[0],ge;if(L.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ee[1].charAt(0)=="P"&&R.push(L.slice(3).replace(/;;/g,";"));break;case"C":var ie=!1,he=!1,de=!1,Z=!1,Ne=-1,Q=-1;for(O=1;O<ee.length;++O)switch(ee[O].charAt(0)){case"A":break;case"X":E=parseInt(ee[O].slice(1))-1,he=!0;break;case"Y":for(w=parseInt(ee[O].slice(1))-1,he||(E=0),I=T.length;I<=w;++I)T[I]=[];break;case"K":ge=ee[O].slice(1),ge.charAt(0)==='"'?ge=ge.slice(1,ge.length-1):ge==="TRUE"?ge=!0:ge==="FALSE"?ge=!1:isNaN(zo(ge))?isNaN(Bh(ge).getDate())||(ge=Ra(ge)):(ge=zo(ge),H!==null&&Wh(H)&&(ge=Bp(ge))),ie=!0;break;case"E":Z=!0;var N=jh(ee[O].slice(1),{r:w,c:E});T[w][E]=[T[w][E],N];break;case"S":de=!0,T[w][E]=[T[w][E],"S5S"];break;case"G":break;case"R":Ne=parseInt(ee[O].slice(1))-1;break;case"C":Q=parseInt(ee[O].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+L)}if(ie&&(T[w][E]&&T[w][E].length==2?T[w][E][0]=ge:T[w][E]=ge,H=null),de){if(Z)throw new Error("SYLK shared formula cannot have own formula");var M=Ne>-1&&T[Ne][Q];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");T[w][E][1]=sS(M[1],{r:w-Ne,c:E-Q})}break;case"F":var B=0;for(O=1;O<ee.length;++O)switch(ee[O].charAt(0)){case"X":E=parseInt(ee[O].slice(1))-1,++B;break;case"Y":for(w=parseInt(ee[O].slice(1))-1,I=T.length;I<=w;++I)T[I]=[];break;case"M":Y=parseInt(ee[O].slice(1))/20;break;case"F":break;case"G":break;case"P":H=R[parseInt(ee[O].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=ee[O].slice(1).split(" "),I=parseInt(D[0],10);I<=parseInt(D[1],10);++I)Y=parseInt(D[2],10),W[I-1]=Y===0?{hidden:!0}:{wch:Y},tu(W[I-1]);break;case"C":E=parseInt(ee[O].slice(1))-1,W[E]||(W[E]={});break;case"R":w=parseInt(ee[O].slice(1))-1,F[w]||(F[w]={}),Y>0?(F[w].hpt=Y,F[w].hpx=qh(Y)):Y===0&&(F[w].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+L)}B<1&&(H=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+L)}}return F.length>0&&(z["!rows"]=F),W.length>0&&(z["!cols"]=W),g&&g.sheetRows&&(T=T.slice(0,g.sheetRows)),[T,z]}function o(y,g){var b=n(y,g),w=b[0],E=b[1],A=Gh(w,g);return un(E).forEach(function(O){A[O]=E[O]}),A}function c(y,g){return su(o(y,g),g)}function u(y,g,b,w){var E="C;Y"+(b+1)+";X"+(w+1)+";K";switch(y.t){case"n":E+=y.v||0,y.f&&!y.F&&(E+=";E"+R2(y.f,{r:b,c:w}));break;case"b":E+=y.v?"TRUE":"FALSE";break;case"e":E+=y.w||y.v;break;case"d":E+='"'+(y.w||y.v)+'"';break;case"s":E+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function h(y,g){g.forEach(function(b,w){var E="F;W"+(w+1)+" "+(w+1)+" ";b.hidden?E+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=cd(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=ud(b.wpx)),typeof b.wch=="number"&&(E+=Math.round(b.wch))),E.charAt(E.length-1)!=" "&&y.push(E)})}function d(y,g){g.forEach(function(b,w){var E="F;";b.hidden?E+="M0;":b.hpt?E+="M"+20*b.hpt+";":b.hpx&&(E+="M"+20*fd(b.hpx)+";"),E.length>2&&y.push(E+"R"+(w+1))})}function v(y,g){var b=["ID;PWXL;N;E"],w=[],E=Kr(y["!ref"]),A,O=Array.isArray(y),T=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),y["!cols"]&&h(b,y["!cols"]),y["!rows"]&&d(b,y["!rows"]),b.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var R=E.s.r;R<=E.e.r;++R)for(var H=E.s.c;H<=E.e.c;++H){var z=hr({r:R,c:H});A=O?(y[R]||[])[H]:y[z],!(!A||A.v==null&&(!A.f||A.F))&&w.push(u(A,y,R,H))}return b.join(T)+T+w.join(T)+T+"E"+T}return{to_workbook:c,to_sheet:o,from_sheet:v}})(),H3=(function(){function t(i,o){switch(o.type){case"base64":return e(Ls(i),o);case"binary":return e(i,o);case"buffer":return e(Cr&&Buffer.isBuffer(i)?i.toString("binary"):iu(i),o);case"array":return e(rf(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){for(var c=i.split(`
`),u=-1,h=-1,d=0,v=[];d!==c.length;++d){if(c[d].trim()==="BOT"){v[++u]=[],h=0;continue}if(!(u<0)){var y=c[d].trim().split(","),g=y[0],b=y[1];++d;for(var w=c[d]||"";(w.match(/["]/g)||[]).length&1&&d<c.length-1;)w+=`
`+c[++d];switch(w=w.trim(),+g){case-1:if(w==="BOT"){v[++u]=[],h=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?v[u][h]=!0:w==="FALSE"?v[u][h]=!1:isNaN(zo(b))?isNaN(Bh(b).getDate())?v[u][h]=b:v[u][h]=Ra(b):v[u][h]=zo(b),++h;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),v[u][h++]=w!==""?w:null;break}if(w==="EOD")break}}return o&&o.sheetRows&&(v=v.slice(0,o.sheetRows)),v}function r(i,o){return Gh(t(i,o),o)}function a(i,o){return su(r(i,o),o)}var n=(function(){var i=function(u,h,d,v,y){u.push(h),u.push(d+","+v),u.push('"'+y.replace(/"/g,'""')+'"')},o=function(u,h,d,v){u.push(h+","+d),u.push(h==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(u){var h=[],d=Kr(u["!ref"]),v,y=Array.isArray(u);i(h,"TABLE",0,1,"sheetjs"),i(h,"VECTORS",0,d.e.r-d.s.r+1,""),i(h,"TUPLES",0,d.e.c-d.s.c+1,""),i(h,"DATA",0,0,"");for(var g=d.s.r;g<=d.e.r;++g){o(h,-1,0,"BOT");for(var b=d.s.c;b<=d.e.c;++b){var w=hr({r:g,c:b});if(v=y?(u[g]||[])[b]:u[w],!v){o(h,1,0,"");continue}switch(v.t){case"n":var E=v.w;!E&&v.v!=null&&(E=v.v),E==null?v.f&&!v.F?o(h,1,0,"="+v.f):o(h,1,0,""):o(h,0,E,"V");break;case"b":o(h,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=io(v.z||fr[14],zn(Ra(v.v)))),o(h,0,v.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var A=`\r
`,O=h.join(A);return O}})();return{to_workbook:a,to_sheet:r,from_sheet:n}})(),W3=(function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,y){for(var g=v.split(`
`),b=-1,w=-1,E=0,A=[];E!==g.length;++E){var O=g[E].trim().split(":");if(O[0]==="cell"){var T=Ya(O[1]);if(A.length<=T.r)for(b=A.length;b<=T.r;++b)A[b]||(A[b]=[]);switch(b=T.r,w=T.c,O[2]){case"t":A[b][w]=t(O[3]);break;case"v":A[b][w]=+O[3];break;case"vtf":var R=O[O.length-1];case"vtc":switch(O[3]){case"nl":A[b][w]=!!+O[4];break;default:A[b][w]=+O[4];break}O[2]=="vtf"&&(A[b][w]=[A[b][w],R])}}}return y&&y.sheetRows&&(A=A.slice(0,y.sheetRows)),A}function a(v,y){return Gh(r(v,y),y)}function n(v,y){return su(a(v,y),y)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function h(v){if(!v||!v["!ref"])return"";for(var y=[],g=[],b,w="",E=cs(v["!ref"]),A=Array.isArray(v),O=E.s.r;O<=E.e.r;++O)for(var T=E.s.c;T<=E.e.c;++T)if(w=hr({r:O,c:T}),b=A?(v[O]||[])[T]:v[w],!(!b||b.v==null||b.t==="z")){switch(g=["cell",w,"t"],b.t){case"s":case"str":g.push(e(b.v));break;case"n":b.f?(g[2]="vtf",g[3]="n",g[4]=b.v,g[5]=e(b.f)):(g[2]="v",g[3]=b.v);break;case"b":g[2]="vt"+(b.f?"f":"c"),g[3]="nl",g[4]=b.v?"1":"0",g[5]=e(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var R=zn(Ra(b.v));g[2]="vtc",g[3]="nd",g[4]=""+R,g[5]=b.w||io(b.z||fr[14],R);break;case"e":continue}y.push(g.join(":"))}return y.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function d(v){return[i,o,c,o,h(v),u].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:d}})(),Uh=(function(){function t(d,v,y,g,b){b.raw?v[y][g]=d:d===""||(d==="TRUE"?v[y][g]=!0:d==="FALSE"?v[y][g]=!1:isNaN(zo(d))?isNaN(Bh(d).getDate())?v[y][g]=d:v[y][g]=Ra(d):v[y][g]=zo(d))}function e(d,v){var y=v||{},g=[];if(!d||d.length===0)return g;for(var b=d.split(/[\r\n]/),w=b.length-1;w>=0&&b[w].length===0;)--w;for(var E=10,A=0,O=0;O<=w;++O)A=b[O].indexOf(" "),A==-1?A=b[O].length:A++,E=Math.max(E,A);for(O=0;O<=w;++O){g[O]=[];var T=0;for(t(b[O].slice(0,E).trim(),g,O,T,y),T=1;T<=(b[O].length-E)/10+1;++T)t(b[O].slice(E+(T-1)*10,E+T*10).trim(),g,O,T,y)}return y.sheetRows&&(g=g.slice(0,y.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(d){for(var v={},y=!1,g=0,b=0;g<d.length;++g)(b=d.charCodeAt(g))==34?y=!y:!y&&b in r&&(v[b]=(v[b]||0)+1);b=[];for(g in v)Object.prototype.hasOwnProperty.call(v,g)&&b.push([v[g],g]);if(!b.length){v=a;for(g in v)Object.prototype.hasOwnProperty.call(v,g)&&b.push([v[g],g])}return b.sort(function(w,E){return w[0]-E[0]||a[w[1]]-a[E[1]]}),r[b.pop()[1]]||44}function i(d,v){var y=v||{},g="",b=y.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(g=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(g=d.charAt(4),d=d.slice(6)):g=n(d.slice(0,1024)):y&&y.FS?g=y.FS:g=n(d.slice(0,1024));var E=0,A=0,O=0,T=0,R=0,H=g.charCodeAt(0),z=!1,F=0,W=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var D=y.dateNF!=null?x8(y.dateNF):null;function Y(){var I=d.slice(T,R),L={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)L.t="z";else if(y.raw)L.t="s",L.v=I;else if(I.trim().length===0)L.t="s",L.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(L.t="s",L.v=I.slice(2,-1).replace(/""/g,'"')):$O(I)?(L.t="n",L.f=I.slice(1)):(L.t="s",L.v=I);else if(I=="TRUE")L.t="b",L.v=!0;else if(I=="FALSE")L.t="b",L.v=!1;else if(!isNaN(O=zo(I)))L.t="n",y.cellText!==!1&&(L.w=I),L.v=O;else if(!isNaN(Bh(I).getDate())||D&&I.match(D)){L.z=y.dateNF||fr[14];var ee=0;D&&I.match(D)&&(I=y8(I,y.dateNF,I.match(D)||[]),ee=1),y.cellDates?(L.t="d",L.v=Ra(I,ee)):(L.t="n",L.v=zn(Ra(I,ee))),y.cellText!==!1&&(L.w=io(L.z,L.v instanceof Date?zn(L.v):L.v)),y.cellNF||delete L.z}else L.t="s",L.v=I;if(L.t=="z"||(y.dense?(b[E]||(b[E]=[]),b[E][A]=L):b[hr({c:A,r:E})]=L),T=R+1,W=d.charCodeAt(T),w.e.c<A&&(w.e.c=A),w.e.r<E&&(w.e.r=E),F==H)++A;else if(A=0,++E,y.sheetRows&&y.sheetRows<=E)return!0}e:for(;R<d.length;++R)switch(F=d.charCodeAt(R)){case 34:W===34&&(z=!z);break;case H:case 10:case 13:if(!z&&Y())break e;break}return R-T>0&&Y(),b["!ref"]=Er(w),b}function o(d,v){return!(v&&v.PRN)||v.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,v):Gh(e(d,v),v)}function c(d,v){var y="",g=v.type=="string"?[0,0,0,0]:q2(d,v);switch(v.type){case"base64":y=Ls(d);break;case"binary":y=d;break;case"buffer":v.codepage==65001?y=d.toString("utf8"):v.codepage&&typeof td<"u"||(y=Cr&&Buffer.isBuffer(d)?d.toString("binary"):iu(d));break;case"array":y=rf(d);break;case"string":y=d;break;default:throw new Error("Unrecognized type "+v.type)}return g[0]==239&&g[1]==187&&g[2]==191?y=ya(y.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?y=ya(y):v.type=="binary"&&typeof td<"u",y.slice(0,19)=="socialcalc:version:"?W3.to_sheet(v.type=="string"?y:ya(y),v):o(y,v)}function u(d,v){return su(c(d,v),v)}function h(d){for(var v=[],y=Kr(d["!ref"]),g,b=Array.isArray(d),w=y.s.r;w<=y.e.r;++w){for(var E=[],A=y.s.c;A<=y.e.c;++A){var O=hr({r:w,c:A});if(g=b?(d[w]||[])[A]:d[O],!g||g.v==null){E.push("          ");continue}for(var T=(g.w||(ic(g),g.w)||"").slice(0,10);T.length<10;)T+=" ";E.push(T+(A===0?" ":""))}v.push(E.join(""))}return v.join(`
`)}return{to_workbook:u,to_sheet:c,from_sheet:h}})();function RC(t,e){var r=e||{},a=!!r.WTF;r.WTF=!0;try{var n=z3.to_workbook(t,r);return r.WTF=a,n}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Uh.to_workbook(t,e)}}var Zu=(function(){function t(N,M,B){if(N){di(N,N.l||0);for(var q=B.Enum||Ne;N.l<N.length;){var K=N.read_shift(2),se=q[K]||q[65535],me=N.read_shift(2),we=N.l+me,Se=se.f&&se.f(N,me,B);if(N.l=we,M(Se,se,K))return}}}function e(N,M){switch(M.type){case"base64":return r(Os(Ls(N)),M);case"binary":return r(Os(N),M);case"buffer":case"array":return r(N,M)}throw"Unsupported type "+M.type}function r(N,M){if(!N)return N;var B=M||{},q=B.dense?[]:{},K="Sheet1",se="",me=0,we={},Se=[],Ee=[],ae={s:{r:0,c:0},e:{r:0,c:0}},rt=B.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)B.Enum=Ne,t(N,function(Le,gt,et){switch(et){case 0:B.vers=Le,Le>=4096&&(B.qpro=!0);break;case 6:ae=Le;break;case 204:Le&&(se=Le);break;case 222:se=Le;break;case 15:case 51:B.qpro||(Le[1].v=Le[1].v.slice(1));case 13:case 14:case 16:et==14&&(Le[2]&112)==112&&(Le[2]&15)>1&&(Le[2]&15)<15&&(Le[1].z=B.dateNF||fr[14],B.cellDates&&(Le[1].t="d",Le[1].v=Bp(Le[1].v))),B.qpro&&Le[3]>me&&(q["!ref"]=Er(ae),we[K]=q,Se.push(K),q=B.dense?[]:{},ae={s:{r:0,c:0},e:{r:0,c:0}},me=Le[3],K=se||"Sheet"+(me+1),se="");var wt=B.dense?(q[Le[0].r]||[])[Le[0].c]:q[hr(Le[0])];if(wt){wt.t=Le[1].t,wt.v=Le[1].v,Le[1].z!=null&&(wt.z=Le[1].z),Le[1].f!=null&&(wt.f=Le[1].f);break}B.dense?(q[Le[0].r]||(q[Le[0].r]=[]),q[Le[0].r][Le[0].c]=Le[1]):q[hr(Le[0])]=Le[1];break}},B);else if(N[2]==26||N[2]==14)B.Enum=Q,N[2]==14&&(B.qpro=!0,N.l=0),t(N,function(Le,gt,et){switch(et){case 204:K=Le;break;case 22:Le[1].v=Le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Le[3]>me&&(q["!ref"]=Er(ae),we[K]=q,Se.push(K),q=B.dense?[]:{},ae={s:{r:0,c:0},e:{r:0,c:0}},me=Le[3],K="Sheet"+(me+1)),rt>0&&Le[0].r>=rt)break;B.dense?(q[Le[0].r]||(q[Le[0].r]=[]),q[Le[0].r][Le[0].c]=Le[1]):q[hr(Le[0])]=Le[1],ae.e.c<Le[0].c&&(ae.e.c=Le[0].c),ae.e.r<Le[0].r&&(ae.e.r=Le[0].r);break;case 27:Le[14e3]&&(Ee[Le[14e3][0]]=Le[14e3][1]);break;case 1537:Ee[Le[0]]=Le[1],Le[0]==me&&(K=Le[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(q["!ref"]=Er(ae),we[se||K]=q,Se.push(se||K),!Ee.length)return{SheetNames:Se,Sheets:we};for(var Je={},V=[],Ie=0;Ie<Ee.length;++Ie)we[Se[Ie]]?(V.push(Ee[Ie]||Se[Ie]),Je[Ee[Ie]]=we[Ee[Ie]]||we[Se[Ie]]):(V.push(Ee[Ie]),Je[Ee[Ie]]={"!ref":"A1"});return{SheetNames:V,Sheets:Je}}function a(N,M){var B=M||{};if(+B.codepage>=0&&Uo(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var q=ls(),K=Kr(N["!ref"]),se=Array.isArray(N),me=[];At(q,0,i(1030)),At(q,6,u(K));for(var we=Math.min(K.e.r,8191),Se=K.s.r;Se<=we;++Se)for(var Ee=yn(Se),ae=K.s.c;ae<=K.e.c;++ae){Se===K.s.r&&(me[ae]=Xa(ae));var rt=me[ae]+Ee,Je=se?(N[Se]||[])[ae]:N[rt];if(!(!Je||Je.t=="z"))if(Je.t=="n")(Je.v|0)==Je.v&&Je.v>=-32768&&Je.v<=32767?At(q,13,g(Se,ae,Je.v)):At(q,14,w(Se,ae,Je.v));else{var V=ic(Je);At(q,15,v(Se,ae,V.slice(0,239)))}}return At(q,1),q.end()}function n(N,M){var B=M||{};if(+B.codepage>=0&&Uo(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var q=ls();At(q,0,o(N));for(var K=0,se=0;K<N.SheetNames.length;++K)(N.Sheets[N.SheetNames[K]]||{})["!ref"]&&At(q,27,Z(N.SheetNames[K],se++));var me=0;for(K=0;K<N.SheetNames.length;++K){var we=N.Sheets[N.SheetNames[K]];if(!(!we||!we["!ref"])){for(var Se=Kr(we["!ref"]),Ee=Array.isArray(we),ae=[],rt=Math.min(Se.e.r,8191),Je=Se.s.r;Je<=rt;++Je)for(var V=yn(Je),Ie=Se.s.c;Ie<=Se.e.c;++Ie){Je===Se.s.r&&(ae[Ie]=Xa(Ie));var Le=ae[Ie]+V,gt=Ee?(we[Je]||[])[Ie]:we[Le];if(!(!gt||gt.t=="z"))if(gt.t=="n")At(q,23,Y(Je,Ie,me,gt.v));else{var et=ic(gt);At(q,22,F(Je,Ie,me,et.slice(0,239)))}}++me}}return At(q,1),q.end()}function i(N){var M=nt(2);return M.write_shift(2,N),M}function o(N){var M=nt(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var B=0,q=0,K=0,se=0;se<N.SheetNames.length;++se){var me=N.SheetNames[se],we=N.Sheets[me];if(!(!we||!we["!ref"])){++K;var Se=cs(we["!ref"]);B<Se.e.r&&(B=Se.e.r),q<Se.e.c&&(q=Se.e.c)}}return B>8191&&(B=8191),M.write_shift(2,B),M.write_shift(1,K),M.write_shift(1,q),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function c(N,M,B){var q={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&B.qpro?(q.s.c=N.read_shift(1),N.l++,q.s.r=N.read_shift(2),q.e.c=N.read_shift(1),N.l++,q.e.r=N.read_shift(2),q):(q.s.c=N.read_shift(2),q.s.r=N.read_shift(2),M==12&&B.qpro&&(N.l+=2),q.e.c=N.read_shift(2),q.e.r=N.read_shift(2),M==12&&B.qpro&&(N.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function u(N){var M=nt(8);return M.write_shift(2,N.s.c),M.write_shift(2,N.s.r),M.write_shift(2,N.e.c),M.write_shift(2,N.e.r),M}function h(N,M,B){var q=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(q[0].c=N.read_shift(1),q[3]=N.read_shift(1),q[0].r=N.read_shift(2),N.l+=2):(q[2]=N.read_shift(1),q[0].c=N.read_shift(2),q[0].r=N.read_shift(2)),q}function d(N,M,B){var q=N.l+M,K=h(N,M,B);if(K[1].t="s",B.vers==20768){N.l++;var se=N.read_shift(1);return K[1].v=N.read_shift(se,"utf8"),K}return B.qpro&&N.l++,K[1].v=N.read_shift(q-N.l,"cstr"),K}function v(N,M,B){var q=nt(7+B.length);q.write_shift(1,255),q.write_shift(2,M),q.write_shift(2,N),q.write_shift(1,39);for(var K=0;K<q.length;++K){var se=B.charCodeAt(K);q.write_shift(1,se>=128?95:se)}return q.write_shift(1,0),q}function y(N,M,B){var q=h(N,M,B);return q[1].v=N.read_shift(2,"i"),q}function g(N,M,B){var q=nt(7);return q.write_shift(1,255),q.write_shift(2,M),q.write_shift(2,N),q.write_shift(2,B,"i"),q}function b(N,M,B){var q=h(N,M,B);return q[1].v=N.read_shift(8,"f"),q}function w(N,M,B){var q=nt(13);return q.write_shift(1,255),q.write_shift(2,M),q.write_shift(2,N),q.write_shift(8,B,"f"),q}function E(N,M,B){var q=N.l+M,K=h(N,M,B);if(K[1].v=N.read_shift(8,"f"),B.qpro)N.l=q;else{var se=N.read_shift(2);R(N.slice(N.l,N.l+se),K),N.l+=se}return K}function A(N,M,B){var q=M&32768;return M&=-32769,M=(q?N:0)+(M>=8192?M-16384:M),(q?"":"$")+(B?Xa(M):yn(M))}var O={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(N,M){di(N,0);for(var B=[],q=0,K="",se="",me="",we="";N.l<N.length;){var Se=N[N.l++];switch(Se){case 0:B.push(N.read_shift(8,"f"));break;case 1:se=A(M[0].c,N.read_shift(2),!0),K=A(M[0].r,N.read_shift(2),!1),B.push(se+K);break;case 2:{var Ee=A(M[0].c,N.read_shift(2),!0),ae=A(M[0].r,N.read_shift(2),!1);se=A(M[0].c,N.read_shift(2),!0),K=A(M[0].r,N.read_shift(2),!1),B.push(Ee+ae+":"+se+K)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(N.read_shift(2));break;case 6:{for(var rt="";Se=N[N.l++];)rt+=String.fromCharCode(Se);B.push('"'+rt.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:we=B.pop(),me=B.pop(),B.push(["AND","OR"][Se-20]+"("+me+","+we+")");break;default:if(Se<32&&T[Se])we=B.pop(),me=B.pop(),B.push(me+T[Se]+we);else if(O[Se]){if(q=O[Se][1],q==69&&(q=N[N.l++]),q>B.length){console.error("WK1 bad formula parse 0x"+Se.toString(16)+":|"+B.join("|")+"|");return}var Je=B.slice(-q);B.length-=q,B.push(O[Se][0]+"("+Je.join(",")+")")}else return Se<=7?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=24?console.error("WK1 unsupported op "+Se.toString(16)):Se<=30?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=115?console.error("WK1 unsupported function opcode "+Se.toString(16)):console.error("WK1 unrecognized opcode "+Se.toString(16))}}B.length==1?M[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function H(N){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=N.read_shift(2),M[3]=N[N.l++],M[0].c=N[N.l++],M}function z(N,M){var B=H(N);return B[1].t="s",B[1].v=N.read_shift(M-4,"cstr"),B}function F(N,M,B,q){var K=nt(6+q.length);K.write_shift(2,N),K.write_shift(1,B),K.write_shift(1,M),K.write_shift(1,39);for(var se=0;se<q.length;++se){var me=q.charCodeAt(se);K.write_shift(1,me>=128?95:me)}return K.write_shift(1,0),K}function W(N,M){var B=H(N);B[1].v=N.read_shift(2);var q=B[1].v>>1;if(B[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return B[1].v=q,B}function D(N,M){var B=H(N),q=N.read_shift(4),K=N.read_shift(4),se=N.read_shift(2);if(se==65535)return q===0&&K===3221225472?(B[1].t="e",B[1].v=15):q===0&&K===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var me=se&32768;return se=(se&32767)-16446,B[1].v=(1-me*2)*(K*Math.pow(2,se+32)+q*Math.pow(2,se)),B}function Y(N,M,B,q){var K=nt(14);if(K.write_shift(2,N),K.write_shift(1,B),K.write_shift(1,M),q==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var se=0,me=0,we=0,Se=0;return q<0&&(se=1,q=-q),me=Math.log2(q)|0,q/=Math.pow(2,me-31),Se=q>>>0,(Se&2147483648)==0&&(q/=2,++me,Se=q>>>0),q-=Se,Se|=2147483648,Se>>>=0,q*=Math.pow(2,32),we=q>>>0,K.write_shift(4,we),K.write_shift(4,Se),me+=16383+(se?32768:0),K.write_shift(2,me),K}function I(N,M){var B=D(N);return N.l+=M-14,B}function L(N,M){var B=H(N),q=N.read_shift(4);return B[1].v=q>>6,B}function ee(N,M){var B=H(N),q=N.read_shift(8,"f");return B[1].v=q,B}function oe(N,M){var B=ee(N);return N.l+=M-10,B}function ge(N,M){return N[N.l+M-1]==0?N.read_shift(M,"cstr"):""}function ie(N,M){var B=N[N.l++];B>M-1&&(B=M-1);for(var q="";q.length<B;)q+=String.fromCharCode(N[N.l++]);return q}function he(N,M,B){if(!(!B.qpro||M<21)){var q=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var K=N.read_shift(M-21,"cstr");return[q,K]}}function de(N,M){for(var B={},q=N.l+M;N.l<q;){var K=N.read_shift(2);if(K==14e3){for(B[K]=[0,""],B[K][0]=N.read_shift(2);N[N.l];)B[K][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return B}function Z(N,M){var B=nt(5+N.length);B.write_shift(2,14e3),B.write_shift(2,M);for(var q=0;q<N.length;++q){var K=N.charCodeAt(q);B[B.l++]=K>127?95:K}return B[B.l++]=0,B}var Ne={0:{n:"BOF",f:jn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ge},222:{n:"SHEETNAMELP",f:ie},65535:{n:""}},Q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:W},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:de},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:ee},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ge},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:he},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:e}})();function LC(t){var e={},r=t.match(Oi),a=0,n=!1;if(r)for(;a!=r.length;++a){var i=dr(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=n2[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return e}var DC=(function(){var t=nd("t"),e=nd("rPr");function r(i){var o=i.match(t);if(!o)return{t:"s",v:""};var c={t:"s",v:Yr(o[1])},u=i.match(e);return u&&(c.s=LC(u[1])),c}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(n).map(r).filter(function(c){return c.v})}})(),PC=(function(){var e=/(\r\n|\n)/g;function r(n,i,o){var c=[];n.u&&c.push("text-decoration: underline;"),n.uval&&c.push("text-underline-style:"+n.uval+";"),n.sz&&c.push("font-size:"+n.sz+"pt;"),n.outline&&c.push("text-effect: outline;"),n.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),n.b&&(i.push("<b>"),o.push("</b>")),n.i&&(i.push("<i>"),o.push("</i>")),n.strike&&(i.push("<s>"),o.push("</s>"));var u=n.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(i.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}})(),MC=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,IC=/<(?:\w+:)?r>/,BC=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function T2(t,e){var r=e?e.cellHTML:!0,a={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Yr(ya(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=ya(t),r&&(a.h=p2(a.t))):t.match(IC)&&(a.r=ya(t),a.t=Yr(ya((t.replace(BC,"").match(MC)||[]).join("").replace(Oi,""))),r&&(a.h=PC(DC(a.r)))),a):{t:""}}var UC=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,qC=/<(?:\w+:)?(?:si|sstItem)>/g,zC=/<\/(?:\w+:)?(?:si|sstItem)>/;function HC(t,e){var r=[],a="";if(!t)return r;var n=t.match(UC);if(n){a=n[2].replace(qC,"").split(zC);for(var i=0;i!=a.length;++i){var o=T2(a[i].trim(),e);o!=null&&(r[r.length]=o)}n=dr(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var WC=/^\s|\s$|[\t\n\r]/;function V3(t,e){if(!e.bookSST)return"";var r=[_n];r[r.length]=St("sst",null,{xmlns:uf[0],count:t.Count,uniqueCount:t.Unique});for(var a=0;a!=t.length;++a)if(t[a]!=null){var n=t[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(WC)&&(i+=' xml:space="preserve"'),i+=">"+fa(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function VC(t){return[t.read_shift(4),t.read_shift(4)]}function GC(t,e){var r=[],a=!1;return lc(t,function(i,o,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function $C(t,e){return e||(e=nt(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var XC=nT;function YC(t){var e=ls();dt(e,159,$C(t));for(var r=0;r<t.length;++r)dt(e,19,XC(t[r]));return dt(e,160),e.end()}function G3(t){for(var e=[],r=t.split(""),a=0;a<r.length;++a)e[a]=r[a].charCodeAt(0);return e}function nc(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function KC(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=nc(t,4),e.U=nc(t,4),e.W=nc(t,4),e}function JC(t){for(var e=t.read_shift(4),r=t.l+e-4,a={},n=t.read_shift(4),i=[];n-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(a.name=t.read_shift(0,"lpp4"),a.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return a}function ZC(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(JC(t));return e}function QC(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function e7(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=nc(t,4),e.U=nc(t,4),e.W=nc(t,4),e}function t7(t){var e=e7(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function $3(t,e){var r=t.l+e,a={};a.Flags=t.read_shift(4)&63,t.l+=4,a.AlgID=t.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=t.read_shift(4),a.KeySize=t.read_shift(4),a.ProviderType=t.read_shift(4),t.l+=8,a.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,a}function X3(t,e){var r={},a=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,a),t.l=a,r}function r7(t){var e=nc(t);switch(e.Minor){case 2:return[e.Minor,a7(t)];case 3:return[e.Minor,n7()];case 4:return[e.Minor,i7(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function a7(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),a=$3(t,r),n=X3(t,t.length-t.l);return{t:"Std",h:a,v:n}}function n7(){throw new Error("File is password-protected: ECMA-376 Extensible")}function i7(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),a={};return r.replace(Oi,function(i){var o=dr(i);switch(wl(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){a[c]=o[c]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function s7(t,e){var r={},a=r.EncryptionVersionInfo=nc(t,4);if(e-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=t.read_shift(4),e-=4;var n=t.read_shift(4);return e-=4,r.EncryptionHeader=$3(t,n),e-=n,r.EncryptionVerifier=X3(t,e),r}function o7(t){var e={},r=e.EncryptionVersionInfo=nc(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function j2(t){var e=0,r,a=G3(t),n=a.length+1,i,o,c,u,h;for(r=eu(n),r[0]=a.length,i=1;i!=n;++i)r[i]=a[i-1];for(i=n-1;i>=0;--i)o=r[i],c=(e&16384)===0?0:1,u=e<<1&32767,h=c|u,e=h^o;return e^52811}var Y3=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},n=function(o,c){return a(o^c)},i=function(o){for(var c=e[o.length-1],u=104,h=o.length-1;h>=0;--h)for(var d=o[h],v=0;v!=7;++v)d&64&&(c^=r[u]),d*=2,--u;return c};return function(o){for(var c=G3(o),u=i(c),h=c.length,d=eu(16),v=0;v!=16;++v)d[v]=0;var y,g,b;for((h&1)===1&&(y=u>>8,d[h]=n(t[0],y),--h,y=u&255,g=c[c.length-1],d[h]=n(g,y));h>0;)--h,y=u>>8,d[h]=n(c[h],y),--h,y=u&255,d[h]=n(c[h],y);for(h=15,b=15-c.length;b>0;)y=u>>8,d[h]=n(t[b],y),--h,--b,y=u&255,d[h]=n(c[h],y),--h,--b;return d}})(),l7=function(t,e,r,a,n){n||(n=e),a||(a=Y3(t));var i,o;for(i=0;i!=e.length;++i)o=e[i],o^=a[r],o=(o>>5|o<<3)&255,n[i]=o,++r;return[n,r,a]},c7=function(t){var e=0,r=Y3(t);return function(a){var n=l7("",a,e,r);return e=n[1],n[0]}};function u7(t,e,r,a){var n={key:jn(t),verificationBytes:jn(t)};return r.password&&(n.verifier=j2(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=c7(r.password)),n}function f7(t,e,r){var a=r||{};return a.Info=t.read_shift(2),t.l-=2,a.Info===1?a.Data=o7(t):a.Data=s7(t,e),a}function h7(t,e,r){var a={Type:r.biff>=8?t.read_shift(2):0};return a.Type?f7(t,e-2,a):u7(t,r.biff>=8?e:e-2,r,a),a}var K3=(function(){function t(n,i){switch(i.type){case"base64":return e(Ls(n),i);case"binary":return e(n,i);case"buffer":return e(Cr&&Buffer.isBuffer(n)?n.toString("binary"):iu(n),i);case"array":return e(rf(n),i)}throw new Error("Unrecognized type "+i.type)}function e(n,i){var o=i||{},c=o.dense?[]:{},u=n.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,v){Array.isArray(c)&&(c[v]=[]);for(var y=/\\\w+\b/g,g=0,b,w=-1;b=y.exec(d);){switch(b[0]){case"\\cell":var E=d.slice(g,y.lastIndex-b[0].length);if(E[0]==" "&&(E=E.slice(1)),++w,E.length){var A={v:E,t:"s"};Array.isArray(c)?c[v][w]=A:c[hr({r:v,c:w})]=A}break}g=y.lastIndex}w>h.e.c&&(h.e.c=w)}),c["!ref"]=Er(h),c}function r(n,i){return su(t(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],o=Kr(n["!ref"]),c,u=Array.isArray(n),h=o.s.r;h<=o.e.r;++h){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var v=hr({r:h,c:d});c=u?(n[h]||[])[d]:n[v],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(ic(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:a}})();function d7(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function ld(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function p7(t){var e=t[0]/255,r=t[1]/255,a=t[2]/255,n=Math.max(e,r,a),i=Math.min(e,r,a),o=n-i;if(o===0)return[0,0,e];var c=0,u=0,h=n+i;switch(u=o/(h>1?2-h:h),n){case e:c=((r-a)/o+6)%6;break;case r:c=(a-e)/o+2;break;case a:c=(e-r)/o+4;break}return[c/6,u,h/2]}function m7(t){var e=t[0],r=t[1],a=t[2],n=r*2*(a<.5?a:1-a),i=a-n/2,o=[i,i,i],c=6*e,u;if(r!==0)switch(c|0){case 0:case 6:u=n*c,o[0]+=n,o[1]+=u;break;case 1:u=n*(2-c),o[0]+=u,o[1]+=n;break;case 2:u=n*(c-2),o[1]+=n,o[2]+=u;break;case 3:u=n*(4-c),o[1]+=u,o[2]+=n;break;case 4:u=n*(c-4),o[2]+=n,o[0]+=u;break;case 5:u=n*(6-c),o[2]+=u,o[0]+=n;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function bp(t,e){if(e===0)return t;var r=p7(d7(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),ld(m7(r))}var J3=6,g7=15,v7=1,Ni=J3;function cd(t){return Math.floor((t+Math.round(128/Ni)/256)*Ni)}function ud(t){return Math.floor((t-5)/Ni*100+.5)/100}function Sp(t){return Math.round((t*Ni+5)/Ni*256)/256}function bg(t){return Sp(ud(cd(t)))}function C2(t){var e=Math.abs(t-bg(t)),r=Ni;if(e>.005)for(Ni=v7;Ni<g7;++Ni)Math.abs(t-bg(t))<=e&&(e=Math.abs(t-bg(t)),r=Ni);Ni=r}function tu(t){t.width?(t.wpx=cd(t.width),t.wch=ud(t.wpx),t.MDW=Ni):t.wpx?(t.wch=ud(t.wpx),t.width=Sp(t.wch),t.MDW=Ni):typeof t.wch=="number"&&(t.width=Sp(t.wch),t.wpx=cd(t.width),t.MDW=Ni),t.customWidth&&delete t.customWidth}var x7=96,Z3=x7;function fd(t){return t*96/Z3}function qh(t){return t*Z3/96}var y7={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _7(t,e,r,a){e.Borders=[];var n={},i=!1;(t[0].match(Oi)||[]).forEach(function(o){var c=dr(o);switch(wl(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},c.diagonalUp&&(n.diagonalUp=Oa(c.diagonalUp)),c.diagonalDown&&(n.diagonalDown=Oa(c.diagonalDown)),e.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function w7(t,e,r,a){e.Fills=[];var n={},i=!1;(t[0].match(Oi)||[]).forEach(function(o){var c=dr(o);switch(wl(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},e.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":c.patternType&&(n.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),c.indexed&&(n.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(n.bgColor.theme=parseInt(c.theme,10)),c.tint&&(n.bgColor.tint=parseFloat(c.tint)),c.rgb&&(n.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),c.theme&&(n.fgColor.theme=parseInt(c.theme,10)),c.tint&&(n.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(n.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function b7(t,e,r,a){e.Fonts=[];var n={},i=!1;(t[0].match(Oi)||[]).forEach(function(o){var c=dr(o);switch(wl(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(n),n={};break;case"<name":c.val&&(n.name=ya(c.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=c.val?Oa(c.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=c.val?Oa(c.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(c.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=c.val?Oa(c.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=c.val?Oa(c.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=c.val?Oa(c.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=c.val?Oa(c.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=c.val?Oa(c.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":c.val&&(n.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(n.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(n.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(n.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=n2[parseInt(c.val,10)];break;case"<color":if(n.color||(n.color={}),c.auto&&(n.color.auto=Oa(c.auto)),c.rgb)n.color.rgb=c.rgb.slice(-6);else if(c.indexed){n.color.index=parseInt(c.indexed,10);var u=Ku[n.color.index];n.color.index==81&&(u=Ku[1]),u||(u=Ku[1]),n.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else c.theme&&(n.color.theme=parseInt(c.theme,10),c.tint&&(n.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=bp(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function S7(t,e,r){e.NumberFmt=[];for(var a=un(fr),n=0;n<a.length;++n)e.NumberFmt[a[n]]=fr[a[n]];var i=t[0].match(Oi);if(i)for(n=0;n<i.length;++n){var o=dr(i[n]);switch(wl(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Yr(ya(o.formatCode)),u=parseInt(o.numFmtId,10);if(e.NumberFmt[u]=c,u>0){if(u>392){for(u=392;u>60&&e.NumberFmt[u]!=null;--u);e.NumberFmt[u]=c}ac(c,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function E7(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)t[a]!=null&&(e[e.length]=St("numFmt",null,{numFmtId:a,formatCode:fa(t[a])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=St("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var M1=["numFmtId","fillId","fontId","borderId","xfId"],I1=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function k7(t,e,r){e.CellXf=[];var a,n=!1;(t[0].match(Oi)||[]).forEach(function(i){var o=dr(i),c=0;switch(wl(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],c=0;c<M1.length;++c)a[M1[c]]&&(a[M1[c]]=parseInt(a[M1[c]],10));for(c=0;c<I1.length;++c)a[I1[c]]&&(a[I1[c]]=Oa(a[I1[c]]));if(e.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[a.numFmtId]==e.NumberFmt[c]){a.numFmtId=c;break}}e.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=Oa(o.wrapText)),a.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function A7(t){var e=[];return e[e.length]=St("cellXfs",null),t.forEach(function(r){e[e.length]=St("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=St("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var N7=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,u,h){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=c.match(e))&&S7(v,d,h),(v=c.match(n))&&b7(v,d,u,h),(v=c.match(a))&&w7(v,d,u,h),(v=c.match(i))&&_7(v,d,u,h),(v=c.match(r))&&k7(v,d,h),d}})();function Q3(t,e){var r=[_n,St("styleSheet",null,{xmlns:uf[0],"xmlns:vt":qn.vt})],a;return t.SSF&&(a=E7(t.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=A7(e.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function T7(t,e){var r=t.read_shift(2),a=ji(t);return[r,a]}function j7(t,e,r){r||(r=nt(6+4*e.length)),r.write_shift(2,t),Zn(e,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function C7(t,e,r){var a={};a.sz=t.read_shift(2)/20;var n=fT(t);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=t.read_shift(2);switch(i===700&&(a.bold=1),t.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(a.underline=o);var c=t.read_shift(1);c>0&&(a.family=c);var u=t.read_shift(1);switch(u>0&&(a.charset=u),t.l++,a.color=uT(t),t.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=ji(t),a}function O7(t,e){e||(e=nt(153)),e.write_shift(2,t.sz*20),hT(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),yp(t.color,e);var a=0;return a=2,e.write_shift(1,a),Zn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var F7=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Sg,R7=Ci;function Pw(t,e){e||(e=nt(84)),Sg||(Sg=Mp(F7));var r=Sg[t.patternType];r==null&&(r=40),e.write_shift(4,r);var a=0;if(r!=40)for(yp({auto:1},e),yp({auto:1},e);a<12;++a)e.write_shift(4,0);else{for(;a<4;++a)e.write_shift(4,0);for(;a<12;++a)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function L7(t,e){var r=t.l+e,a=t.read_shift(2),n=t.read_shift(2);return t.l=r,{ixfe:a,numFmtId:n}}function eS(t,e,r){r||(r=nt(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function R0(t,e){return e||(e=nt(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var D7=Ci;function P7(t,e){return e||(e=nt(51)),e.write_shift(1,0),R0(null,e),R0(null,e),R0(null,e),R0(null,e),R0(null,e),e.length>e.l?e.slice(0,e.l):e}function M7(t,e){return e||(e=nt(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),xp(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function I7(t,e,r){var a=nt(2052);return a.write_shift(4,t),xp(e,a),xp(r,a),a.length>a.l?a.slice(0,a.l):a}function B7(t,e,r){var a={};a.NumberFmt=[];for(var n in fr)a.NumberFmt[n]=fr[n];a.CellXf=[],a.Fonts=[];var i=[],o=!1;return lc(t,function(u,h,d){switch(d){case 44:a.NumberFmt[u[0]]=u[1],ac(u[1],u[0]);break;case 43:a.Fonts.push(u),u.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(u.color.rgb=bp(e.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(d),o=!0;break;case 38:i.pop(),o=!1;break;default:if(h.T>0)i.push(d);else if(h.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function U7(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&++r}),r!=0&&(dt(t,615,Ho(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&dt(t,44,j7(n,e[n]))}),dt(t,616))}}function q7(t){var e=1;dt(t,611,Ho(e)),dt(t,43,O7({sz:12,color:{theme:1},name:"Calibri",family:2})),dt(t,612)}function z7(t){var e=2;dt(t,603,Ho(e)),dt(t,45,Pw({patternType:"none"})),dt(t,45,Pw({patternType:"gray125"})),dt(t,604)}function H7(t){var e=1;dt(t,613,Ho(e)),dt(t,46,P7()),dt(t,614)}function W7(t){var e=1;dt(t,626,Ho(e)),dt(t,47,eS({numFmtId:0},65535)),dt(t,627)}function V7(t,e){dt(t,617,Ho(e.length)),e.forEach(function(r){dt(t,47,eS(r,0))}),dt(t,618)}function G7(t){var e=1;dt(t,619,Ho(e)),dt(t,48,M7({xfId:0,name:"Normal"})),dt(t,620)}function $7(t){var e=0;dt(t,505,Ho(e)),dt(t,506)}function X7(t){var e=0;dt(t,508,I7(e,"TableStyleMedium9","PivotStyleMedium4")),dt(t,509)}function Y7(t,e){var r=ls();return dt(r,278),U7(r,t.SSF),q7(r),z7(r),H7(r),W7(r),V7(r,e.cellXfs),G7(r),$7(r),X7(r),dt(r,279),r.end()}var K7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function J7(t,e,r){e.themeElements.clrScheme=[];var a={};(t[0].match(Oi)||[]).forEach(function(n){var i=dr(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[K7.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Z7(){}function Q7(){}var eO=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,tO=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,rO=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function aO(t,e,r){e.themeElements={};var a;[["clrScheme",eO,J7],["fontScheme",tO,Z7],["fmtScheme",rO,Q7]].forEach(function(n){if(!(a=t.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,e,r)})}var nO=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function tS(t,e){(!t||t.length===0)&&(t=O2());var r,a={};if(!(r=t.match(nO)))throw new Error("themeElements not found in theme");return aO(r[0],a,e),a.raw=t,a}function O2(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[_n];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function iO(t,e,r){var a=t.l+e,n=t.read_shift(4);if(n!==124226){if(!r.cellStyles){t.l=a;return}var i=t.slice(t.l);t.l=a;var o;try{o=$4(i,{type:"array"})}catch{return}var c=Fs(o,"theme/theme/theme1.xml",!0);if(c)return tS(c,r)}}function sO(t){return t.read_shift(4)}function oO(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=lO(t,4);break;case 2:e.xclrValue=L3(t);break;case 3:e.xclrValue=sO(t);break;case 4:t.l+=4;break}return t.l+=8,e}function lO(t,e){return Ci(t,e)}function cO(t,e){return Ci(t,e)}function uO(t){var e=t.read_shift(2),r=t.read_shift(2)-4,a=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=oO(t);break;case 6:a[1]=cO(t,r);break;case 14:case 15:a[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return a}function fO(t,e){var r=t.l+e;t.l+=2;var a=t.read_shift(2);t.l+=2;for(var n=t.read_shift(2),i=[];n-- >0;)i.push(uO(t,r-t.l));return{ixfe:a,ext:i}}function hO(t,e){e.forEach(function(r){r[0]})}function dO(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:ji(t)}}function pO(t){var e=nt(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Zn(t.name,e),e.slice(0,e.l)}function mO(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function gO(t){var e=nt(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function vO(t,e){var r=nt(8+2*e.length);return r.write_shift(4,t),Zn(e,r),r.slice(0,r.l)}function xO(t){return t.l+=4,t.read_shift(4)!=0}function yO(t,e){var r=nt(8);return r.write_shift(4,t),r.write_shift(4,1),r}function _O(t,e,r){var a={Types:[],Cell:[],Value:[]},n=r||{},i=[],o=!1,c=2;return lc(t,function(u,h,d){switch(d){case 335:a.Types.push({name:u.name});break;case 51:u.forEach(function(v){c==1?a.Cell.push({type:a.Types[v[0]-1].name,index:v[1]}):c==0&&a.Value.push({type:a.Types[v[0]-1].name,index:v[1]})});break;case 337:c=u?1:0;break;case 338:c=2;break;case 35:i.push(d),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!h.T){if(!o||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),a}function wO(){var t=ls();return dt(t,332),dt(t,334,Ho(1)),dt(t,335,pO({name:"XLDAPR",version:12e4,flags:3496657072})),dt(t,336),dt(t,339,vO(1,"XLDAPR")),dt(t,52),dt(t,35,Ho(514)),dt(t,4096,Ho(0)),dt(t,4097,ao(1)),dt(t,36),dt(t,53),dt(t,340),dt(t,337,yO(1)),dt(t,51,gO([[1,0]])),dt(t,338),dt(t,333),t.end()}function bO(t,e,r){var a={Types:[],Cell:[],Value:[]};if(!t)return a;var n=!1,i=2,o;return t.replace(Oi,function(c){var u=dr(c);switch(wl(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<a.Types.length;++h)a.Types[h].name==u.name&&(o=a.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[u.t-1].name,index:+u.v}):i==0&&a.Value.push({type:a.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return c}),a}function rS(){var t=[_n];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function SO(t){var e=[];if(!t)return e;var r=1;return(t.match(Oi)||[]).forEach(function(a){var n=dr(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,e.push(n);break}}),e}function EO(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=hr(r);var a=t.read_shift(1);return a&2&&(e.l="1"),a&8&&(e.a="1"),e}function kO(t,e,r){var a=[];return lc(t,function(i,o,c){switch(c){case 63:a.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function AO(t,e,r,a){if(!t)return t;var n=a||{},i=!1;lc(t,function(c,u,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!u.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},n)}function NO(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var bh=1024;function aS(t,e){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[St("xml",null,{"xmlns:v":Ns.v,"xmlns:o":Ns.o,"xmlns:x":Ns.x,"xmlns:mv":Ns.mv}).replace(/\/>/,">"),St("o:shapelayout",St("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),St("v:shapetype",[St("v:stroke",null,{joinstyle:"miter"}),St("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];bh<t*1e3;)bh+=1e3;return e.forEach(function(i){var o=Ya(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var u=c.type=="gradient"?St("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=St("v:fill",u,c),d={on:"t",obscured:"t"};++bh,n=n.concat(["<v:shape"+id({id:"_x0000_s"+bh,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,St("v:shadow",null,d),St("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",pi("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),pi("x:AutoFill","False"),pi("x:Row",String(o.r)),pi("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function Mw(t,e,r,a){var n=Array.isArray(t),i;e.forEach(function(o){var c=Ya(o.ref);if(n?(t[c.r]||(t[c.r]=[]),i=t[c.r][c.c]):i=t[o.ref],!i){i={t:"z"},n?t[c.r][c.c]=i:t[o.ref]=i;var u=Kr(t["!ref"]||"BDWGO1000001:A1");u.s.r>c.r&&(u.s.r=c.r),u.e.r<c.r&&(u.e.r=c.r),u.s.c>c.c&&(u.s.c=c.c),u.e.c<c.c&&(u.e.c=c.c);var h=Er(u);h!==t["!ref"]&&(t["!ref"]=h)}i.c||(i.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var v=i.c.length-1;v>=0;--v){if(!r&&i.c[v].T)return;r&&!i.c[v].T&&i.c.splice(v,1)}if(r&&a){for(v=0;v<a.length;++v)if(d.a==a[v].id){d.a=a[v].name||d.a;break}}i.c.push(d)})}function TO(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var u=dr(c[0]),h={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Ya(u.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var v=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!v&&!!v[1]&&T2(v[1])||{r:"",t:"",h:""};h.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),h.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(h.h=y.h),a.push(h)}}}}),a}function nS(t){var e=[_n,St("comments",null,{xmlns:uf[0]})],r=[];return e.push("<authors>"),t.forEach(function(a){a[1].forEach(function(n){var i=fa(n.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),e.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(u){u.a&&(n=r.indexOf(fa(u.a))),i.push(u.t||"")}),e.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)e.push(pi("t",fa(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)o+=`Reply:
    `+i[c]+`
`;e.push(pi("t",fa(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function jO(t,e){var r=[],a=!1,n={},i=0;return t.replace(Oi,function(c,u){var h=dr(c);switch(wl(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=u+c.length;break;case"</text>":n.t=t.slice(i,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&e.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),r}function CO(t,e,r){var a=[_n,St("ThreadedComments",null,{xmlns:qn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(n){var i="";(n[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var u={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=u.id:u.parentId=i,o.ID=u.id,o.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),a.push(St("threadedComment",pi("text",o.t||""),u))})}),a.push("</ThreadedComments>"),a.join("")}function OO(t,e){var r=[],a=!1;return t.replace(Oi,function(i){var o=dr(i);switch(wl(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function FO(t){var e=[_n,St("personList",null,{xmlns:qn.TCMNT,"xmlns:x":uf[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,a){e.push(St("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function RO(t){var e={};e.iauthor=t.read_shift(4);var r=pf(t);return e.rfx=r.s,e.ref=hr(r.s),t.l+=16,e}function LO(t,e){return e==null&&(e=nt(36)),e.write_shift(4,t[1].iauthor),$h(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var DO=ji;function PO(t){return Zn(t.slice(0,54))}function MO(t,e){var r=[],a=[],n={},i=!1;return lc(t,function(c,u,h){switch(h){case 632:a.push(c);break;case 635:n=c;break;case 637:n.t=c.t,n.h=c.h,n.r=c.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,e.sheetRows&&n.rfx&&e.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function IO(t){var e=ls(),r=[];return dt(e,628),dt(e,630),t.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),dt(e,632,PO(n.a)))})}),dt(e,631),dt(e,633),t.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:Ya(a[0]),e:Ya(a[0])};dt(e,635,LO([i,n])),n.t&&n.t.length>0&&dt(e,637,sT(n)),dt(e,636),delete n.iauthor})}),dt(e,634),dt(e,629),e.end()}var BO="application/vnd.ms-office.vbaProject";function UO(t){var e=ar.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ar.utils.cfb_add(e,n,t.FileIndex[a].content)}}),ar.write(e)}function qO(t,e){e.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&ar.utils.cfb_add(t,n,e.FileIndex[a].content)}})}var iS=["xlsb","xlsm","xlam","biff8","xla"];function zO(){return{"!type":"dialog"}}function HO(){return{"!type":"dialog"}}function WO(){return{"!type":"macro"}}function VO(){return{"!type":"macro"}}var jh=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(a,n,i,o){var c=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var h=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return c?d+=e.c:--d,u?h+=e.r:--h,n+(c?"":"$")+Xa(d)+(u?"":"$")+yn(h)}return function(n,i){return e=i,n.replace(t,r)}})(),F2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,R2=(function(){return function(e,r){return e.replace(F2,function(a,n,i,o,c,u){var h=y2(o)-(i?0:r.c),d=x2(u)-(c?0:r.r),v=d==0?"":c?d+1:"["+d+"]",y=h==0?"":i?h+1:"["+h+"]";return n+"R"+v+"C"+y})}})();function sS(t,e){return t.replace(F2,function(r,a,n,i,o,c){return a+(n=="$"?n+i:Xa(y2(i)+e.c))+(o=="$"?o+c:yn(x2(c)+e.r))})}function GO(t,e,r){var a=cs(e),n=a.s,i=Ya(r),o={r:i.r-n.r,c:i.c-n.c};return sS(t,o)}function $O(t){return t.length!=1}function Iw(t){return t.replace(/_xlfn\./g,"")}function An(t){t.l+=1}function ru(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function oS(t,e,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return lS(t);r.biff==12&&(a=4)}var n=t.read_shift(a),i=t.read_shift(a),o=ru(t),c=ru(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function lS(t){var e=ru(t),r=ru(t),a=t.read_shift(1),n=t.read_shift(1);return{s:{r:e[0],c:a,cRel:e[1],rRel:e[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function XO(t,e,r){if(r.biff<8)return lS(t);var a=t.read_shift(r.biff==12?4:2),n=t.read_shift(r.biff==12?4:2),i=ru(t),o=ru(t);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function cS(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return YO(t);var a=t.read_shift(r&&r.biff==12?4:2),n=ru(t);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function YO(t){var e=ru(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function KO(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function JO(t,e,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return ZO(t);var n=t.read_shift(a>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;n>524287;)n-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:o,rRel:c}}function ZO(t){var e=t.read_shift(2),r=t.read_shift(1),a=(e&32768)>>15,n=(e&16384)>>14;return e&=16383,a==1&&e>=8192&&(e=e-16384),n==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:n,rRel:a}}function QO(t,e,r){var a=(t[t.l++]&96)>>5,n=oS(t,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function eF(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=oS(t,i,r);return[a,n,o]}function tF(t,e,r){var a=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function rF(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[a,n]}function aF(t,e,r){var a=(t[t.l++]&96)>>5,n=XO(t,e-1,r);return[a,n]}function nF(t,e,r){var a=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[a]}function Bw(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function iF(t,e,r){t.l+=2;for(var a=t.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(t.read_shift(r&&r.biff==2?1:2));return n}function sF(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function oF(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function lF(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function cF(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[a]}function uS(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function uF(t){return t.read_shift(2),uS(t)}function fF(t){return t.read_shift(2),uS(t)}function hF(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=cS(t,0,r);return[a,n]}function dF(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=JO(t,0,r);return[a,n]}function pF(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=cS(t,0,r);return[a,n,i]}function mF(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(r&&r.biff<=3?1:2);return[xR[n],dS[n],a]}function gF(t,e,r){var a=t[t.l++],n=t.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,t.read_shift(1)]:vF(t);return[n,(i[0]===0?dS:vR)[i[1]]]}function vF(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function xF(t,e,r){t.l+=r&&r.biff==2?3:4}function yF(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var a=t.read_shift(2),n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function _F(t){return t.l++,cc[t.read_shift(1)]}function wF(t){return t.l++,t.read_shift(2)}function bF(t){return t.l++,t.read_shift(1)!==0}function SF(t){return t.l++,Ti(t)}function EF(t,e,r){return t.l++,_d(t,e-1,r)}function kF(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=mn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=cc[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Ti(t);break;case 2:r[1]=mf(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function AF(t,e,r){for(var a=t.read_shift(r.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((r.biff==12?pf:Up)(t));return n}function NF(t,e,r){var a=0,n=0;r.biff==12?(a=t.read_shift(4),n=t.read_shift(4)):(n=1+t.read_shift(1),a=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var i=0,o=[];i!=a&&(o[i]=[]);++i)for(var c=0;c!=n;++c)o[i][c]=kF(t,r.biff);return o}function TF(t,e,r){var a=t.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=t.read_shift(n);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[a,0,i]}function jF(t,e,r){if(r.biff==5)return CF(t);var a=t.read_shift(1)>>>5&3,n=t.read_shift(2),i=t.read_shift(4);return[a,n,i]}function CF(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var a=t.read_shift(2);return t.l+=12,[e,r,a]}function OF(t,e,r){var a=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function FF(t,e,r){var a=t.read_shift(1)>>>5&3,n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function RF(t,e,r){var a=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[a]}function LF(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[a,n]}var DF=Ci,PF=Ci,MF=Ci;function bd(t,e,r){return t.l+=2,[KO(t)]}function L2(t){return t.l+=6,[]}var IF=bd,BF=L2,UF=L2,qF=bd;function fS(t){return t.l+=2,[jn(t),t.read_shift(2)&1]}var zF=bd,HF=fS,WF=L2,VF=bd,GF=bd,$F=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function XF(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n=t.read_shift(2),i=t.read_shift(2),o=$F[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:a,c:n,C:i}}function YF(t){return t.l+=2,[t.read_shift(4)]}function KF(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function JF(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function ZF(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function QF(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function eR(t){return t.l+=4,[0,0]}var Uw={1:{n:"PtgExp",f:yF},2:{n:"PtgTbl",f:MF},3:{n:"PtgAdd",f:An},4:{n:"PtgSub",f:An},5:{n:"PtgMul",f:An},6:{n:"PtgDiv",f:An},7:{n:"PtgPower",f:An},8:{n:"PtgConcat",f:An},9:{n:"PtgLt",f:An},10:{n:"PtgLe",f:An},11:{n:"PtgEq",f:An},12:{n:"PtgGe",f:An},13:{n:"PtgGt",f:An},14:{n:"PtgNe",f:An},15:{n:"PtgIsect",f:An},16:{n:"PtgUnion",f:An},17:{n:"PtgRange",f:An},18:{n:"PtgUplus",f:An},19:{n:"PtgUminus",f:An},20:{n:"PtgPercent",f:An},21:{n:"PtgParen",f:An},22:{n:"PtgMissArg",f:An},23:{n:"PtgStr",f:EF},26:{n:"PtgSheet",f:KF},27:{n:"PtgEndSheet",f:JF},28:{n:"PtgErr",f:_F},29:{n:"PtgBool",f:bF},30:{n:"PtgInt",f:wF},31:{n:"PtgNum",f:SF},32:{n:"PtgArray",f:nF},33:{n:"PtgFunc",f:mF},34:{n:"PtgFuncVar",f:gF},35:{n:"PtgName",f:TF},36:{n:"PtgRef",f:hF},37:{n:"PtgArea",f:QO},38:{n:"PtgMemArea",f:OF},39:{n:"PtgMemErr",f:DF},40:{n:"PtgMemNoMem",f:PF},41:{n:"PtgMemFunc",f:FF},42:{n:"PtgRefErr",f:RF},43:{n:"PtgAreaErr",f:tF},44:{n:"PtgRefN",f:dF},45:{n:"PtgAreaN",f:aF},46:{n:"PtgMemAreaN",f:ZF},47:{n:"PtgMemNoMemN",f:QF},57:{n:"PtgNameX",f:jF},58:{n:"PtgRef3d",f:pF},59:{n:"PtgArea3d",f:eF},60:{n:"PtgRefErr3d",f:LF},61:{n:"PtgAreaErr3d",f:rF},255:{}},tR={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},rR={1:{n:"PtgElfLel",f:fS},2:{n:"PtgElfRw",f:VF},3:{n:"PtgElfCol",f:IF},6:{n:"PtgElfRwV",f:GF},7:{n:"PtgElfColV",f:qF},10:{n:"PtgElfRadical",f:zF},11:{n:"PtgElfRadicalS",f:WF},13:{n:"PtgElfColS",f:BF},15:{n:"PtgElfColSV",f:UF},16:{n:"PtgElfRadicalLel",f:HF},25:{n:"PtgList",f:XF},29:{n:"PtgSxName",f:YF},255:{}},aR={0:{n:"PtgAttrNoop",f:eR},1:{n:"PtgAttrSemi",f:cF},2:{n:"PtgAttrIf",f:oF},4:{n:"PtgAttrChoose",f:iF},8:{n:"PtgAttrGoto",f:sF},16:{n:"PtgAttrSum",f:xF},32:{n:"PtgAttrBaxcel",f:Bw},33:{n:"PtgAttrBaxcel",f:Bw},64:{n:"PtgAttrSpace",f:uF},65:{n:"PtgAttrSpaceSemi",f:fF},128:{n:"PtgAttrIfError",f:lF},255:{}};function Sd(t,e,r,a){if(a.biff<8)return Ci(t,e);for(var n=t.l+e,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=NF(t,0,a),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=AF(t,r[o][1],a),i.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=t.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=n-t.l,e!==0&&i.push(Ci(t,e)),i}function Ed(t,e,r){for(var a=t.l+e,n,i,o=[];a!=t.l;)e=a-t.l,i=t[t.l],n=Uw[i]||Uw[tR[i]],(i===24||i===25)&&(n=(i===24?rR:aR)[t[t.l+1]]),!n||!n.f?Ci(t,e):o.push([n.n,n.f(t,e,r)]);return o}function nR(t){for(var e=[],r=0;r<t.length;++r){for(var a=t[r],n=[],i=0;i<a.length;++i){var o=a[i];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}e.push(n.join(","))}return e.join(";")}var iR={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sR(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function hS(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var a=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(t[a[0]][0]){case 357:return n=a[1]==-1?"#REF":t.SheetNames[a[1]],a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[a[0]][0];case 355:default:return"SH33TJSSRC"+t[a[0]][0]}switch(t[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":t.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 14849:return t[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[a[0]][0][3]?(n=a[1]==-1?"#REF":t[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+t[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function qw(t,e,r){var a=hS(t,e,r);return a=="#REF"?a:sR(a,r)}function Ai(t,e,r,a,n){var i=n&&n.biff||8,o={s:{c:0,r:0}},c=[],u,h,d,v=0,y=0,g,b="";if(!t[0]||!t[0][0])return"";for(var w=-1,E="",A=0,O=t[0].length;A<O;++A){var T=t[0][A];switch(T[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=c.pop(),h=c.pop(),w>=0){switch(t[0][w][1][0]){case 0:E=ln(" ",t[0][w][1][1]);break;case 1:E=ln("\r",t[0][w][1][1]);break;default:if(E="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}h=h+E,w=-1}c.push(h+iR[T[0]]+u);break;case"PtgIsect":u=c.pop(),h=c.pop(),c.push(h+" "+u);break;case"PtgUnion":u=c.pop(),h=c.pop(),c.push(h+","+u);break;case"PtgRange":u=c.pop(),h=c.pop(),c.push(h+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=H0(T[1][1],o,n),c.push(W0(d,i));break;case"PtgRefN":d=r?H0(T[1][1],r,n):T[1][1],c.push(W0(d,i));break;case"PtgRef3d":v=T[1][1],d=H0(T[1][2],o,n),b=qw(a,v,n),c.push(b+"!"+W0(d,i));break;case"PtgFunc":case"PtgFuncVar":var R=T[1][0],H=T[1][1];R||(R=0),R&=127;var z=R==0?[]:c.slice(-R);c.length-=R,H==="User"&&(H=z.shift()),c.push(H+"("+z.join(",")+")");break;case"PtgBool":c.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(T[1]);break;case"PtgNum":c.push(String(T[1]));break;case"PtgStr":c.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(T[1]);break;case"PtgAreaN":g=gw(T[1][1],r?{s:r}:o,n),c.push(yg(g,n));break;case"PtgArea":g=gw(T[1][1],o,n),c.push(yg(g,n));break;case"PtgArea3d":v=T[1][1],g=T[1][2],b=qw(a,v,n),c.push(b+"!"+yg(g,n));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=T[1][2];var F=(a.names||[])[y-1]||(a[0]||[])[y],W=F?F.Name:"SH33TJSNAME"+String(y);W&&W.slice(0,6)=="_xlfn."&&!n.xlfn&&(W=W.slice(6)),c.push(W);break;case"PtgNameX":var D=T[1][1];y=T[1][2];var Y;if(n.biff<=5)D<0&&(D=-D),a[D]&&(Y=a[D][y]);else{var I="";if(((a[D]||[])[0]||[])[0]==14849||(((a[D]||[])[0]||[])[0]==1025?a[D][y]&&a[D][y].itab>0&&(I=a.SheetNames[a[D][y].itab-1]+"!"):I=a.SheetNames[y-1]+"!"),a[D]&&a[D][y])I+=a[D][y].Name;else if(a[0]&&a[0][y])I+=a[0][y].Name;else{var L=(hS(a,D,n)||"").split(";;");L[y-1]?I=L[y-1]:I+="SH33TJSERRX"}c.push(I);break}Y||(Y={Name:"SH33TJSERRY"}),c.push(Y.Name);break;case"PtgParen":var ee="(",oe=")";if(w>=0){switch(E="",t[0][w][1][0]){case 2:ee=ln(" ",t[0][w][1][1])+ee;break;case 3:ee=ln("\r",t[0][w][1][1])+ee;break;case 4:oe=ln(" ",t[0][w][1][1])+oe;break;case 5:oe=ln("\r",t[0][w][1][1])+oe;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}w=-1}c.push(ee+c.pop()+oe);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:T[1][1],r:T[1][0]};var ge={c:r.c,r:r.r};if(a.sharedf[hr(d)]){var ie=a.sharedf[hr(d)];c.push(Ai(ie,o,ge,a,n))}else{var he=!1;for(u=0;u!=a.arrayf.length;++u)if(h=a.arrayf[u],!(d.c<h[0].s.c||d.c>h[0].e.c)&&!(d.r<h[0].s.r||d.r>h[0].e.r)){c.push(Ai(h[1],o,ge,a,n)),he=!0;break}he||c.push(T[1])}break;case"PtgArray":c.push("{"+nR(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var de=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&w>=0&&de.indexOf(t[0][A][0])==-1){T=t[0][w];var Z=!0;switch(T[1][0]){case 4:Z=!1;case 0:E=ln(" ",T[1][1]);break;case 5:Z=!1;case 1:E=ln("\r",T[1][1]);break;default:if(E="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}c.push((Z?E:"")+c.pop()+(Z?"":E)),w=-1}}if(c.length>1&&n.WTF)throw new Error("bad formula stack");return c[0]}function oR(t,e,r){var a=t.l+e,n=r.biff==2?1:2,i,o=t.read_shift(n);if(o==65535)return[[],Ci(t,e-2)];var c=Ed(t,o,r);return e!==o+n&&(i=Sd(t,e-o-n,c,r)),t.l=a,[c,i]}function lR(t,e,r){var a=t.l+e,n=r.biff==2?1:2,i,o=t.read_shift(n);if(o==65535)return[[],Ci(t,e-2)];var c=Ed(t,o,r);return e!==o+n&&(i=Sd(t,e-o-n,c,r)),t.l=a,[c,i]}function cR(t,e,r,a){var n=t.l+e,i=Ed(t,a,r),o;return n!==t.l&&(o=Sd(t,n-t.l,i,r)),[i,o]}function uR(t,e,r){var a=t.l+e,n,i=t.read_shift(2),o=Ed(t,i,r);return i==65535?[[],Ci(t,e-2)]:(e!==i+2&&(n=Sd(t,a-i-2,o,r)),[o,n])}function fR(t){var e;if(ec(t,t.l+6)!==65535)return[Ti(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function hR(t){if(t==null){var e=nt(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return af(t);return af(0)}function Eg(t,e,r){var a=t.l+e,n=bl(t);r.biff==2&&++t.l;var i=fR(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var c=lR(t,a-t.l,r);return{cell:n,val:i[0],formula:c,shared:o>>3&1,tt:i[1]}}function dR(t,e,r,a,n){var i=sf(e,r,n),o=hR(t.v),c=nt(6),u=33;c.write_shift(2,u),c.write_shift(4,0);for(var h=nt(t.bf.length),d=0;d<t.bf.length;++d)h[d]=t.bf[d];var v=Jn([i,o,c,h]);return v}function qp(t,e,r){var a=t.read_shift(4),n=Ed(t,a,r),i=t.read_shift(4),o=i>0?Sd(t,i,n,r):null;return[n,o]}var pR=qp,zp=qp,mR=qp,gR=qp,vR={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},dS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},xR={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function zw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function yR(t){var e="of:="+t.replace(F2,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function kg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function _R(t){return t.replace(/\./,"!")}var G0={},Ch={},$0=typeof Map<"u";function D2(t,e,r){var a=0,n=t.length;if(r){if($0?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=$0?r.get(e):r[e];a<i.length;++a)if(t[i[a]].t===e)return t.Count++,i[a]}}else for(;a<n;++a)if(t[a].t===e)return t.Count++,a;return t[n]={t:e},t.Count++,t.Unique++,r&&($0?(r.has(e)||r.set(e,[]),r.get(e).push(n)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(n))),n}function Hp(t,e){var r={min:t+1,max:t+1},a=-1;return e.MDW&&(Ni=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?a=ud(e.wpx):e.wch!=null&&(a=e.wch),a>-1?(r.width=Sp(a),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Qu(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function ou(t,e,r){var a=r.revssf[e.z!=null?e.z:"General"],n=60,i=t.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){ac(e.z,n),r.ssf[n]=e.z,r.revssf[e.z]=a=n;break}}for(n=0;n!=i;++n)if(t[n].numFmtId===a)return n;return t[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function pS(t,e,r,a,n,i){try{a.cellNF&&(t.z=fr[e])}catch(c){if(a.WTF)throw c}if(!(t.t==="z"&&!a.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Ra(t.v)),(!a||a.cellText!==!1)&&t.t!=="z")try{if(fr[e]==null&&ac(v8[e]||"General",e),t.t==="e")t.w=t.w||cc[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ad(t.v);else if(t.t==="d"){var o=zn(t.v);(o|0)===o?t.w=o.toString(10):t.w=ad(o)}else{if(t.v===void 0)return"";t.w=tf(t.v,Ch)}else t.t==="d"?t.w=io(e,zn(t.v),Ch):t.w=io(e,t.v,Ch)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=bp(n.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),a.WTF&&(t.s.fgColor.raw_rgb=n.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=bp(n.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),a.WTF&&(t.s.bgColor.raw_rgb=n.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&i.Fills)throw c}}}function wR(t,e,r){if(t&&t["!ref"]){var a=Kr(t["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function bR(t,e){var r=Kr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Er(r))}var SR=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,ER=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,kR=/<(?:\w:)?hyperlink [^>]*>/mg,AR=/"(\w*:\w*)"/,NR=/<(?:\w:)?col\b[^>]*[\/]?>/g,TR=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,jR=/<(?:\w:)?pageMargins[^>]*\/>/g,mS=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,CR=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,OR=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function FR(t,e,r,a,n,i,o){if(!t)return t;a||(a={"!id":{}});var c=e.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",d="",v=t.match(ER);v?(h=t.slice(0,v.index),d=t.slice(v.index+v[0].length)):h=d=t;var y=h.match(mS);y?P2(y[0],c,n,r):(y=h.match(CR))&&LR(y[0],y[1]||"",c,n,r);var g=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var b=h.slice(g,g+50).match(AR);b&&bR(c,b[1])}var w=h.match(OR);w&&w[1]&&$R(w[1],n);var E=[];if(e.cellStyles){var A=h.match(NR);A&&zR(E,A)}v&&KR(v[1],c,e,u,i,o);var O=d.match(TR);O&&(c["!autofilter"]=WR(O[0]));var T=[],R=d.match(SR);if(R)for(g=0;g!=R.length;++g)T[g]=Kr(R[g].slice(R[g].indexOf('"')+1));var H=d.match(kR);H&&BR(c,H,a);var z=d.match(jR);if(z&&(c["!margins"]=UR(dr(z[0]))),!c["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(c["!ref"]=Er(u)),e.sheetRows>0&&c["!ref"]){var F=Kr(c["!ref"]);e.sheetRows<=+F.e.r&&(F.e.r=e.sheetRows-1,F.e.r>u.e.r&&(F.e.r=u.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>u.e.c&&(F.e.c=u.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Er(F))}return E.length>0&&(c["!cols"]=E),T.length>0&&(c["!merges"]=T),c}function RR(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Er(t[r])+'"/>';return e+"</mergeCells>"}function P2(t,e,r,a){var n=dr(t);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Yr(ya(n.codeName)))}function LR(t,e,r,a,n){P2(t.slice(0,t.indexOf(">")),r,a,n)}function DR(t,e,r,a,n){var i=!1,o={},c=null;if(a.bookType!=="xlsx"&&e.vbaraw){var u=e.SheetNames[r];try{e.Workbook&&(u=e.Workbook.Sheets[r].CodeName||u)}catch{}i=!0,o.codeName=xl(fa(u))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),c=(c||"")+St("outlinePr",null,h)}!i&&!c||(n[n.length]=St("sheetPr",c,o))}var PR=["objects","scenarios","selectLockedCells","selectUnlockedCells"],MR=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function IR(t){var e={sheet:1};return PR.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),MR.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=j2(t.password).toString(16).toUpperCase()),St("sheetProtection",null,e)}function BR(t,e,r){for(var a=Array.isArray(t),n=0;n!=e.length;++n){var i=dr(ya(e[n]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Yr(i.location))):(i.Target="#"+Yr(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=Kr(i.ref),u=c.s.r;u<=c.e.r;++u)for(var h=c.s.c;h<=c.e.c;++h){var d=hr({c:h,r:u});a?(t[u]||(t[u]=[]),t[u][h]||(t[u][h]={t:"z",v:void 0}),t[u][h].l=i):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=i)}}}function UR(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function qR(t){return Qu(t),St("pageMargins",null,t)}function zR(t,e){for(var r=!1,a=0;a!=e.length;++a){var n=dr(e[a],!0);n.hidden&&(n.hidden=Oa(n.hidden));var i=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,C2(n.width)),tu(n);i<=o;)t[i++]=La(n)}}function HR(t,e){for(var r=["<cols>"],a,n=0;n!=e.length;++n)(a=e[n])&&(r[r.length]=St("col",null,Hp(n,a)));return r[r.length]="</cols>",r.join("")}function WR(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function VR(t,e,r,a){var n=typeof t.ref=="string"?t.ref:Er(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=cs(n);o.s.r==o.e.r&&(o.e.r=cs(e["!ref"]).e.r,n=Er(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==a){u.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),St("autoFilter",null,{ref:n})}var GR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function $R(t,e){e.Views||(e.Views=[{}]),(t.match(GR)||[]).forEach(function(r,a){var n=dr(r);e.Views[a]||(e.Views[a]={}),+n.zoomScale&&(e.Views[a].zoom=+n.zoomScale),Oa(n.rightToLeft)&&(e.Views[a].RTL=!0)})}function XR(t,e,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),St("sheetViews",St("sheetView",null,n),{})}function YR(t,e,r,a){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var n="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":n=t.v?"1":"0";break;case"n":n=""+t.v;break;case"e":n=cc[t.v];break;case"d":a&&a.cellDates?n=Ra(t.v,-1).toISOString():(t=La(t),t.t="n",n=""+(t.v=zn(Ra(t.v)))),typeof t.z>"u"&&(t.z=fr[14]);break;default:n=t.v;break}var c=pi("v",fa(n)),u={r:e},h=ou(a.cellXfs,t,a);switch(h!==0&&(u.s=h),t.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){c=pi("v",""+D2(a.Strings,t.v,a.revStrings)),u.t="s";break}u.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;c=St("f",fa(t.f),d)+(t.v!=null?c:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(u.cm=1),St("c",c,u)}var KR=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=nd("v"),o=nd("f");return function(u,h,d,v,y,g){for(var b=0,w="",E=[],A=[],O=0,T=0,R=0,H="",z,F,W=0,D=0,Y,I,L=0,ee=0,oe=Array.isArray(g.CellXf),ge,ie=[],he=[],de=Array.isArray(h),Z=[],Ne={},Q=!1,N=!!d.sheetStubs,M=u.split(e),B=0,q=M.length;B!=q;++B){w=M[B].trim();var K=w.length;if(K!==0){var se=0;e:for(b=0;b<K;++b)switch(w[b]){case">":if(w[b-1]!="/"){++b;break e}if(d&&d.cellStyles){if(F=dr(w.slice(se,b),!0),W=F.r!=null?parseInt(F.r,10):W+1,D=-1,d.sheetRows&&d.sheetRows<W)continue;Ne={},Q=!1,F.ht&&(Q=!0,Ne.hpt=parseFloat(F.ht),Ne.hpx=qh(Ne.hpt)),F.hidden=="1"&&(Q=!0,Ne.hidden=!0),F.outlineLevel!=null&&(Q=!0,Ne.level=+F.outlineLevel),Q&&(Z[W-1]=Ne)}break;case"<":se=b;break}if(se>=b)break;if(F=dr(w.slice(se,b),!0),W=F.r!=null?parseInt(F.r,10):W+1,D=-1,!(d.sheetRows&&d.sheetRows<W)){v.s.r>W-1&&(v.s.r=W-1),v.e.r<W-1&&(v.e.r=W-1),d&&d.cellStyles&&(Ne={},Q=!1,F.ht&&(Q=!0,Ne.hpt=parseFloat(F.ht),Ne.hpx=qh(Ne.hpt)),F.hidden=="1"&&(Q=!0,Ne.hidden=!0),F.outlineLevel!=null&&(Q=!0,Ne.level=+F.outlineLevel),Q&&(Z[W-1]=Ne)),E=w.slice(b).split(t);for(var me=0;me!=E.length&&E[me].trim().charAt(0)=="<";++me);for(E=E.slice(me),b=0;b!=E.length;++b)if(w=E[b].trim(),w.length!==0){if(A=w.match(r),O=b,T=0,R=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,A!=null&&A.length===2){for(O=0,H=A[1],T=0;T!=H.length&&!((R=H.charCodeAt(T)-64)<1||R>26);++T)O=26*O+R;--O,D=O}else++D;for(T=0;T!=w.length&&w.charCodeAt(T)!==62;++T);if(++T,F=dr(w.slice(0,T),!0),F.r||(F.r=hr({r:W-1,c:D})),H=w.slice(T),z={t:""},(A=H.match(i))!=null&&A[1]!==""&&(z.v=Yr(A[1])),d.cellFormula){if((A=H.match(o))!=null&&A[1]!==""){if(z.f=Yr(ya(A[1])).replace(/\r\n/g,`
`),d.xlfn||(z.f=Iw(z.f)),A[0].indexOf('t="array"')>-1)z.F=(H.match(n)||[])[1],z.F.indexOf(":")>-1&&ie.push([Kr(z.F),z.F]);else if(A[0].indexOf('t="shared"')>-1){I=dr(A[0]);var we=Yr(ya(A[1]));d.xlfn||(we=Iw(we)),he[parseInt(I.si,10)]=[I,we,F.r]}}else(A=H.match(/<f[^>]*\/>/))&&(I=dr(A[0]),he[I.si]&&(z.f=GO(he[I.si][1],he[I.si][2],F.r)));var Se=Ya(F.r);for(T=0;T<ie.length;++T)Se.r>=ie[T][0].s.r&&Se.r<=ie[T][0].e.r&&Se.c>=ie[T][0].s.c&&Se.c<=ie[T][0].e.c&&(z.F=ie[T][1])}if(F.t==null&&z.v===void 0)if(z.f||z.F)z.v=0,z.t="n";else if(N)z.t="z";else continue;else z.t=F.t||"n";switch(v.s.c>D&&(v.s.c=D),v.e.c<D&&(v.e.c=D),z.t){case"n":if(z.v==""||z.v==null){if(!N)continue;z.t="z"}else z.v=parseFloat(z.v);break;case"s":if(typeof z.v>"u"){if(!N)continue;z.t="z"}else Y=G0[parseInt(z.v,10)],z.v=Y.t,z.r=Y.r,d.cellHTML&&(z.h=Y.h);break;case"str":z.t="s",z.v=z.v!=null?ya(z.v):"",d.cellHTML&&(z.h=p2(z.v));break;case"inlineStr":A=H.match(a),z.t="s",A!=null&&(Y=T2(A[1]))?(z.v=Y.t,d.cellHTML&&(z.h=Y.h)):z.v="";break;case"b":z.v=Oa(z.v);break;case"d":d.cellDates?z.v=Ra(z.v,1):(z.v=zn(Ra(z.v,1)),z.t="n");break;case"e":(!d||d.cellText!==!1)&&(z.w=z.v),z.v=v3[z.v];break}if(L=ee=0,ge=null,oe&&F.s!==void 0&&(ge=g.CellXf[F.s],ge!=null&&(ge.numFmtId!=null&&(L=ge.numFmtId),d.cellStyles&&ge.fillId!=null&&(ee=ge.fillId))),pS(z,L,ee,d,y,g),d.cellDates&&oe&&z.t=="n"&&Wh(fr[L])&&(z.t="d",z.v=Bp(z.v)),F.cm&&d.xlmeta){var Ee=(d.xlmeta.Cell||[])[+F.cm-1];Ee&&Ee.type=="XLDAPR"&&(z.D=!0)}if(de){var ae=Ya(F.r);h[ae.r]||(h[ae.r]=[]),h[ae.r][ae.c]=z}else h[F.r]=z}}}}Z.length>0&&(h["!rows"]=Z)}})();function JR(t,e,r,a){var n=[],i=[],o=Kr(t["!ref"]),c="",u,h="",d=[],v=0,y=0,g=t["!rows"],b=Array.isArray(t),w={r:h},E,A=-1;for(y=o.s.c;y<=o.e.c;++y)d[y]=Xa(y);for(v=o.s.r;v<=o.e.r;++v){for(i=[],h=yn(v),y=o.s.c;y<=o.e.c;++y){u=d[y]+h;var O=b?(t[v]||[])[y]:t[u];O!==void 0&&(c=YR(O,u,t,e))!=null&&i.push(c)}(i.length>0||g&&g[v])&&(w={r:h},g&&g[v]&&(E=g[v],E.hidden&&(w.hidden=1),A=-1,E.hpx?A=fd(E.hpx):E.hpt&&(A=E.hpt),A>-1&&(w.ht=A,w.customHeight=1),E.level&&(w.outlineLevel=E.level)),n[n.length]=St("row",i.join(""),w))}if(g)for(;v<g.length;++v)g&&g[v]&&(w={r:v+1},E=g[v],E.hidden&&(w.hidden=1),A=-1,E.hpx?A=fd(E.hpx):E.hpt&&(A=E.hpt),A>-1&&(w.ht=A,w.customHeight=1),E.level&&(w.outlineLevel=E.level),n[n.length]=St("row","",w));return n.join("")}function gS(t,e,r,a){var n=[_n,St("worksheet",null,{xmlns:uf[0],"xmlns:r":qn.r})],i=r.SheetNames[t],o=0,c="",u=r.Sheets[i];u==null&&(u={});var h=u["!ref"]||"A1",d=Kr(h);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),h=Er(d)}a||(a={}),u["!comments"]=[];var v=[];DR(u,r,t,e,n),n[n.length]=St("dimension",null,{ref:h}),n[n.length]=XR(u,e,t,r),e.sheetFormat&&(n[n.length]=St("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(n[n.length]=HR(u,u["!cols"])),n[o=n.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(c=JR(u,e),c.length>0&&(n[n.length]=c)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),u["!protect"]&&(n[n.length]=IR(u["!protect"])),u["!autofilter"]!=null&&(n[n.length]=VR(u["!autofilter"],u,r,t)),u["!merges"]!=null&&u["!merges"].length>0&&(n[n.length]=RR(u["!merges"]));var y=-1,g,b=-1;return u["!links"].length>0&&(n[n.length]="<hyperlinks>",u["!links"].forEach(function(w){w[1].Target&&(g={ref:w[0]},w[1].Target.charAt(0)!="#"&&(b=ca(a,-1,fa(w[1].Target).replace(/#.*$/,""),Fr.HLINK),g["r:id"]="rId"+b),(y=w[1].Target.indexOf("#"))>-1&&(g.location=fa(w[1].Target.slice(y+1))),w[1].Tooltip&&(g.tooltip=fa(w[1].Tooltip)),n[n.length]=St("hyperlink",null,g))}),n[n.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(n[n.length]=qR(u["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(n[n.length]=pi("ignoredErrors",St("ignoredError",null,{numberStoredAsText:1,sqref:h}))),v.length>0&&(b=ca(a,-1,"../drawings/drawing"+(t+1)+".xml",Fr.DRAW),n[n.length]=St("drawing",null,{"r:id":"rId"+b}),u["!drawing"]=v),u["!comments"].length>0&&(b=ca(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Fr.VML),n[n.length]=St("legacyDrawing",null,{"r:id":"rId"+b}),u["!legacy"]=b),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function ZR(t,e){var r={},a=t.l+e;r.r=t.read_shift(4),t.l+=4;var n=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function QR(t,e,r){var a=nt(145),n=(r["!rows"]||[])[t]||{};a.write_shift(4,t),a.write_shift(4,0);var i=320;n.hpx?i=fd(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var c=0,u=a.l;a.l+=4;for(var h={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var v=-1,y=-1,g=d<<10;g<d+1<<10;++g){h.c=g;var b=Array.isArray(r)?(r[h.r]||[])[h.c]:r[hr(h)];b&&(v<0&&(v=g),y=g)}v<0||(++c,a.write_shift(4,v),a.write_shift(4,y))}var w=a.l;return a.l=u,a.write_shift(4,c),a.l=w,a.length>a.l?a.slice(0,a.l):a}function eL(t,e,r,a){var n=QR(a,r,e);(n.length>17||(e["!rows"]||[])[a])&&dt(t,0,n)}var tL=pf,rL=$h;function aL(){}function nL(t,e){var r={},a=t[t.l];return++t.l,r.above=!(a&64),r.left=!(a&128),t.l+=18,r.name=oT(t),r}function iL(t,e,r){r==null&&(r=nt(84+4*t.length));var a=192;e&&(e.above&&(a&=-65),e.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return yp({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),h3(t,r),r.slice(0,r.l)}function sL(t){var e=oo(t);return[e]}function oL(t,e,r){return r==null&&(r=nt(8)),ff(e,r)}function lL(t){var e=hf(t);return[e]}function cL(t,e,r){return r==null&&(r=nt(4)),df(e,r)}function uL(t){var e=oo(t),r=t.read_shift(1);return[e,r,"b"]}function fL(t,e,r){return r==null&&(r=nt(9)),ff(e,r),r.write_shift(1,t.v?1:0),r}function hL(t){var e=hf(t),r=t.read_shift(1);return[e,r,"b"]}function dL(t,e,r){return r==null&&(r=nt(5)),df(e,r),r.write_shift(1,t.v?1:0),r}function pL(t){var e=oo(t),r=t.read_shift(1);return[e,r,"e"]}function mL(t,e,r){return r==null&&(r=nt(9)),ff(e,r),r.write_shift(1,t.v),r}function gL(t){var e=hf(t),r=t.read_shift(1);return[e,r,"e"]}function vL(t,e,r){return r==null&&(r=nt(8)),df(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function xL(t){var e=oo(t),r=t.read_shift(4);return[e,r,"s"]}function yL(t,e,r){return r==null&&(r=nt(12)),ff(e,r),r.write_shift(4,e.v),r}function _L(t){var e=hf(t),r=t.read_shift(4);return[e,r,"s"]}function wL(t,e,r){return r==null&&(r=nt(8)),df(e,r),r.write_shift(4,e.v),r}function bL(t){var e=oo(t),r=Ti(t);return[e,r,"n"]}function SL(t,e,r){return r==null&&(r=nt(16)),ff(e,r),af(t.v,r),r}function vS(t){var e=hf(t),r=Ti(t);return[e,r,"n"]}function EL(t,e,r){return r==null&&(r=nt(12)),df(e,r),af(t.v,r),r}function kL(t){var e=oo(t),r=S2(t);return[e,r,"n"]}function AL(t,e,r){return r==null&&(r=nt(12)),ff(e,r),d3(t.v,r),r}function NL(t){var e=hf(t),r=S2(t);return[e,r,"n"]}function TL(t,e,r){return r==null&&(r=nt(8)),df(e,r),d3(t.v,r),r}function jL(t){var e=oo(t),r=_2(t);return[e,r,"is"]}function CL(t){var e=oo(t),r=ji(t);return[e,r,"str"]}function OL(t,e,r){return r==null&&(r=nt(12+4*t.v.length)),ff(e,r),Zn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function FL(t){var e=hf(t),r=ji(t);return[e,r,"str"]}function RL(t,e,r){return r==null&&(r=nt(8+4*t.v.length)),df(e,r),Zn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function LL(t,e,r){var a=t.l+e,n=oo(t);n.r=r["!row"];var i=t.read_shift(1),o=[n,i,"b"];if(r.cellFormula){t.l+=2;var c=zp(t,a-t.l,r);o[3]=Ai(c,null,n,r.supbooks,r)}else t.l=a;return o}function DL(t,e,r){var a=t.l+e,n=oo(t);n.r=r["!row"];var i=t.read_shift(1),o=[n,i,"e"];if(r.cellFormula){t.l+=2;var c=zp(t,a-t.l,r);o[3]=Ai(c,null,n,r.supbooks,r)}else t.l=a;return o}function PL(t,e,r){var a=t.l+e,n=oo(t);n.r=r["!row"];var i=Ti(t),o=[n,i,"n"];if(r.cellFormula){t.l+=2;var c=zp(t,a-t.l,r);o[3]=Ai(c,null,n,r.supbooks,r)}else t.l=a;return o}function ML(t,e,r){var a=t.l+e,n=oo(t);n.r=r["!row"];var i=ji(t),o=[n,i,"str"];if(r.cellFormula){t.l+=2;var c=zp(t,a-t.l,r);o[3]=Ai(c,null,n,r.supbooks,r)}else t.l=a;return o}var IL=pf,BL=$h;function UL(t,e){return e==null&&(e=nt(4)),e.write_shift(4,t),e}function qL(t,e){var r=t.l+e,a=pf(t),n=w2(t),i=ji(t),o=ji(t),c=ji(t);t.l=r;var u={rfx:a,relId:n,loc:i,display:c};return o&&(u.Tooltip=o),u}function zL(t,e){var r=nt(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));$h({s:Ya(t[0]),e:Ya(t[0])},r),b2("rId"+e,r);var a=t[1].Target.indexOf("#"),n=a==-1?"":t[1].Target.slice(a+1);return Zn(n||"",r),Zn(t[1].Tooltip||"",r),Zn("",r),r.slice(0,r.l)}function HL(){}function WL(t,e,r){var a=t.l+e,n=p3(t),i=t.read_shift(1),o=[n];if(o[2]=i,r.cellFormula){var c=pR(t,a-t.l,r);o[1]=c}else t.l=a;return o}function VL(t,e,r){var a=t.l+e,n=pf(t),i=[n];if(r.cellFormula){var o=gR(t,a-t.l,r);i[1]=o,t.l=a}else t.l=a;return i}function GL(t,e,r){r==null&&(r=nt(18));var a=Hp(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return e.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),e.level&&(n|=e.level<<8),r.write_shift(2,n),r}var xS=["left","right","top","bottom","header","footer"];function $L(t){var e={};return xS.forEach(function(r){e[r]=Ti(t)}),e}function XL(t,e){return e==null&&(e=nt(48)),Qu(t),xS.forEach(function(r){af(t[r],e)}),e}function YL(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function KL(t,e,r){r==null&&(r=nt(30));var a=924;return(((e||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function JL(t){var e=nt(24);return e.write_shift(4,4),e.write_shift(4,1),$h(t,e),e}function ZL(t,e){return e==null&&(e=nt(66)),e.write_shift(2,t.password?j2(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function QL(){}function eD(){}function tD(t,e,r,a,n,i,o){if(!t)return t;var c=e||{};a||(a={"!id":{}});var u=c.dense?[]:{},h,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,y=!1,g,b,w,E,A,O,T,R,H,z=[];c.biff=12,c["!row"]=0;var F=0,W=!1,D=[],Y={},I=c.supbooks||n.supbooks||[[]];if(I.sharedf=Y,I.arrayf=D,I.SheetNames=n.SheetNames||n.Sheets.map(function(de){return de.name}),!c.supbooks&&(c.supbooks=I,n.Names))for(var L=0;L<n.Names.length;++L)I[0][L+1]=n.Names[L];var ee=[],oe=[],ge=!1;hd[16]={n:"BrtShortReal",f:vS};var ie;if(lc(t,function(Z,Ne,Q){if(!y)switch(Q){case 148:h=Z;break;case 0:g=Z,c.sheetRows&&c.sheetRows<=g.r&&(y=!0),R=yn(E=g.r),c["!row"]=g.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=qh(Z.hpt)),oe[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:Z[2]},Z[2]){case"n":b.v=Z[1];break;case"s":T=G0[Z[1]],b.v=T.t,b.r=T.r;break;case"b":b.v=!!Z[1];break;case"e":b.v=Z[1],c.cellText!==!1&&(b.w=cc[b.v]);break;case"str":b.t="s",b.v=Z[1];break;case"is":b.t="s",b.v=Z[1].t;break}if((w=o.CellXf[Z[0].iStyleRef])&&pS(b,w.numFmtId,null,c,i,o),A=Z[0].c==-1?A+1:Z[0].c,c.dense?(u[E]||(u[E]=[]),u[E][A]=b):u[Xa(A)+R]=b,c.cellFormula){for(W=!1,F=0;F<D.length;++F){var N=D[F];g.r>=N[0].s.r&&g.r<=N[0].e.r&&A>=N[0].s.c&&A<=N[0].e.c&&(b.F=Er(N[0]),W=!0)}!W&&Z.length>3&&(b.f=Z[3])}if(d.s.r>g.r&&(d.s.r=g.r),d.s.c>A&&(d.s.c=A),d.e.r<g.r&&(d.e.r=g.r),d.e.c<A&&(d.e.c=A),c.cellDates&&w&&b.t=="n"&&Wh(fr[w.numFmtId])){var M=Xu(b.v);M&&(b.t="d",b.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}ie&&(ie.type=="XLDAPR"&&(b.D=!0),ie=void 0);break;case 1:case 12:if(!c.sheetStubs||v)break;b={t:"z",v:void 0},A=Z[0].c==-1?A+1:Z[0].c,c.dense?(u[E]||(u[E]=[]),u[E][A]=b):u[Xa(A)+R]=b,d.s.r>g.r&&(d.s.r=g.r),d.s.c>A&&(d.s.c=A),d.e.r<g.r&&(d.e.r=g.r),d.e.c<A&&(d.e.c=A),ie&&(ie.type=="XLDAPR"&&(b.D=!0),ie=void 0);break;case 176:z.push(Z);break;case 49:ie=((c.xlmeta||{}).Cell||[])[Z-1];break;case 494:var B=a["!id"][Z.relId];for(B?(Z.Target=B.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=B):Z.relId==""&&(Z.Target="#"+Z.loc),E=Z.rfx.s.r;E<=Z.rfx.e.r;++E)for(A=Z.rfx.s.c;A<=Z.rfx.e.c;++A)c.dense?(u[E]||(u[E]=[]),u[E][A]||(u[E][A]={t:"z",v:void 0}),u[E][A].l=Z):(O=hr({c:A,r:E}),u[O]||(u[O]={t:"z",v:void 0}),u[O].l=Z);break;case 426:if(!c.cellFormula)break;D.push(Z),H=c.dense?u[E][A]:u[Xa(A)+R],H.f=Ai(Z[1],d,{r:g.r,c:A},I,c),H.F=Er(Z[0]);break;case 427:if(!c.cellFormula)break;Y[hr(Z[0].s)]=Z[1],H=c.dense?u[E][A]:u[Xa(A)+R],H.f=Ai(Z[1],d,{r:g.r,c:A},I,c);break;case 60:if(!c.cellStyles)break;for(;Z.e>=Z.s;)ee[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},ge||(ge=!0,C2(Z.w/256)),tu(ee[Z.e+1]);break;case 161:u["!autofilter"]={ref:Er(Z)};break;case 476:u["!margins"]=Z;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),Z.name&&(n.Sheets[r].CodeName=Z.name),(Z.above||Z.left)&&(u["!outline"]={above:Z.above,left:Z.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),Z.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!Ne.T){if(!v||c.WTF)throw new Error("Unexpected record 0x"+Q.toString(16))}}},c),delete c.supbooks,delete c["!row"],!u["!ref"]&&(d.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(u["!ref"]=Er(h||d)),c.sheetRows&&u["!ref"]){var he=Kr(u["!ref"]);c.sheetRows<=+he.e.r&&(he.e.r=c.sheetRows-1,he.e.r>d.e.r&&(he.e.r=d.e.r),he.e.r<he.s.r&&(he.s.r=he.e.r),he.e.c>d.e.c&&(he.e.c=d.e.c),he.e.c<he.s.c&&(he.s.c=he.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Er(he))}return z.length>0&&(u["!merges"]=z),ee.length>0&&(u["!cols"]=ee),oe.length>0&&(u["!rows"]=oe),u}function rD(t,e,r,a,n,i,o){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=La(e),e.z=e.z||fr[14],e.v=zn(Ra(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var u={r,c:a};switch(u.s=ou(n.cellXfs,e,n),e.l&&i["!links"].push([hr(u),e.l]),e.c&&i["!comments"].push([hr(u),e.c]),e.t){case"s":case"str":return n.bookSST?(c=D2(n.Strings,e.v,n.revStrings),u.t="s",u.v=c,o?dt(t,18,wL(e,u)):dt(t,7,yL(e,u))):(u.t="str",o?dt(t,17,RL(e,u)):dt(t,6,OL(e,u))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?dt(t,13,TL(e,u)):dt(t,2,AL(e,u)):o?dt(t,16,EL(e,u)):dt(t,5,SL(e,u)),!0;case"b":return u.t="b",o?dt(t,15,dL(e,u)):dt(t,4,fL(e,u)),!0;case"e":return u.t="e",o?dt(t,14,vL(e,u)):dt(t,3,mL(e,u)),!0}return o?dt(t,12,cL(e,u)):dt(t,1,oL(e,u)),!0}function aD(t,e,r,a){var n=Kr(e["!ref"]||"A1"),i,o="",c=[];dt(t,145);var u=Array.isArray(e),h=n.e.r;e["!rows"]&&(h=Math.max(n.e.r,e["!rows"].length-1));for(var d=n.s.r;d<=h;++d){o=yn(d),eL(t,e,n,d);var v=!1;if(d<=n.e.r)for(var y=n.s.c;y<=n.e.c;++y){d===n.s.r&&(c[y]=Xa(y)),i=c[y]+o;var g=u?(e[d]||[])[y]:e[i];if(!g){v=!1;continue}v=rD(t,g,d,y,a,e,v)}}dt(t,146)}function nD(t,e){!e||!e["!merges"]||(dt(t,177,UL(e["!merges"].length)),e["!merges"].forEach(function(r){dt(t,176,BL(r))}),dt(t,178))}function iD(t,e){!e||!e["!cols"]||(dt(t,390),e["!cols"].forEach(function(r,a){r&&dt(t,60,GL(a,r))}),dt(t,391))}function sD(t,e){!e||!e["!ref"]||(dt(t,648),dt(t,649,JL(Kr(e["!ref"]))),dt(t,650))}function oD(t,e,r){e["!links"].forEach(function(a){if(a[1].Target){var n=ca(r,-1,a[1].Target.replace(/#.*$/,""),Fr.HLINK);dt(t,494,zL(a,n))}}),delete e["!links"]}function lD(t,e,r,a){if(e["!comments"].length>0){var n=ca(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Fr.VML);dt(t,551,b2("rId"+n)),e["!legacy"]=n}}function cD(t,e,r,a){if(e["!autofilter"]){var n=e["!autofilter"],i=typeof n.ref=="string"?n.ref:Er(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,c=cs(i);c.s.r==c.e.r&&(c.e.r=cs(e["!ref"]).e.r,i=Er(c));for(var u=0;u<o.length;++u){var h=o[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==a){h.Ref="'"+r.SheetNames[a]+"'!"+i;break}}u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),dt(t,161,$h(Kr(i))),dt(t,162)}}function uD(t,e,r){dt(t,133),dt(t,137,KL(e,r)),dt(t,138),dt(t,134)}function fD(t,e){e["!protect"]&&dt(t,535,ZL(e["!protect"]))}function hD(t,e,r,a){var n=ls(),i=r.SheetNames[t],o=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}var u=Kr(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],dt(n,129),(r.vbaraw||o["!outline"])&&dt(n,147,iL(c,o["!outline"])),dt(n,148,rL(u)),uD(n,o,r.Workbook),iD(n,o),aD(n,o,t,e),fD(n,o),cD(n,o,r,t),nD(n,o),oD(n,o,a),o["!margins"]&&dt(n,476,XL(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&sD(n,o),lD(n,o,t,a),dt(n,130),n.end()}function dD(t){var e=[],r=t.match(/^<c:numCache>/),a;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var n=Yr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[e,n,a]}function pD(t,e,r,a,n,i){var o=i||{"!type":"chart"};if(!t)return i;var c=0,u=0,h="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var y=dD(v);d.s.r=d.s.c=0,d.e.c=c,h=Xa(c),y[0].forEach(function(g,b){o[h+yn(b)]={t:"n",v:g,z:y[1]},u=b}),d.e.r<u&&(d.e.r=u),++c}),c>0&&(o["!ref"]=Er(d)),o}function mD(t,e,r,a,n){if(!t)return t;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,c=t.match(mS);return c&&P2(c[0],i,n,r),(o=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function gD(t,e){t.l+=10;var r=ji(t);return{name:r}}function vD(t,e,r,a,n){if(!t)return t;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return lc(t,function(u,h,d){switch(d){case 550:i["!rel"]=u;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),u.name&&(n.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var M2=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],xD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],yD=[],_D=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Hw(t,e){for(var r=0;r!=t.length;++r)for(var a=t[r],n=0;n!=e.length;++n){var i=e[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=Oa(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function Ww(t,e){for(var r=0;r!=e.length;++r){var a=e[r];if(t[a[0]]==null)t[a[0]]=a[1];else switch(a[2]){case"bool":typeof t[a[0]]=="string"&&(t[a[0]]=Oa(t[a[0]]));break;case"int":typeof t[a[0]]=="string"&&(t[a[0]]=parseInt(t[a[0]],10));break}}}function yS(t){Ww(t.WBProps,M2),Ww(t.CalcPr,_D),Hw(t.WBView,xD),Hw(t.Sheets,yD),Ch.date1904=Oa(t.WBProps.date1904)}function wD(t){return!t.Workbook||!t.Workbook.WBProps?"false":Oa(t.Workbook.WBProps.date1904)?"true":"false"}var bD="][*?/\\".split("");function _S(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return bD.forEach(function(a){if(t.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function SD(t,e,r){t.forEach(function(a,n){_S(a);for(var i=0;i<n;++i)if(a==t[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=e&&e[n]&&e[n].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function ED(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];SD(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)wR(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var kD=/<\w+:workbook/;function AD(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},o=0;if(t.replace(Oi,function(u,h){var d=dr(u);switch(wl(d[0])){case"<?xml":break;case"<workbook":u.match(kD)&&(n="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":M2.forEach(function(v){if(d[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=Oa(d[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(d[v[0]],10);break;default:r.WBProps[v[0]]=d[v[0]]}}),d.codeName&&(r.WBProps.CodeName=ya(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Yr(ya(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=ya(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),Oa(d.hidden||"0")&&(i.Hidden=!0),o=h+u.length;break;case"</definedName>":i.Ref=Yr(ya(t.slice(o,h))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),uf.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return yS(r),r}function wS(t){var e=[_n];e[e.length]=St("workbook",null,{xmlns:uf[0],"xmlns:r":qn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(M2.forEach(function(c){t.Workbook.WBProps[c[0]]!=null&&t.Workbook.WBProps[c[0]]!=c[1]&&(a[c[0]]=t.Workbook.WBProps[c[0]])}),t.Workbook.WBProps.CodeName&&(a.codeName=t.Workbook.WBProps.CodeName,delete a.CodeName)),e[e.length]=St("workbookPr",null,a);var n=t.Workbook&&t.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:fa(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=St("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(c){var u={name:c.Name};c.Comment&&(u.comment=c.Comment),c.Sheet!=null&&(u.localSheetId=""+c.Sheet),c.Hidden&&(u.hidden="1"),c.Ref&&(e[e.length]=St("definedName",fa(c.Ref),u))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function ND(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=bv(t),r.name=ji(t),r}function TD(t,e){return e||(e=nt(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),b2(t.strRelID,e),Zn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function jD(t,e){var r={},a=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var n=e>8?ji(t):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function CD(t,e){e||(e=nt(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),h3(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function OD(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function FD(t,e,r){var a=t.l+e;t.l+=4,t.l+=1;var n=t.read_shift(4),i=lT(t),o=mR(t,0,r),c=w2(t);t.l=a;var u={Name:i,Ptg:o};return n<268435455&&(u.Sheet=n),c&&(u.Comment=c),u}function RD(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;e||(e={}),e.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],hd[16]={n:"BrtFRTArchID$",f:OD},lc(t,function(u,h,d){switch(d){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(e.SID=u.Sheet),u.Ref=Ai(u.Ptg,null,null,o,e),delete e.SID,delete u.Ptg,i.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,u]):o[0]=[d,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(d),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(d),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!h.T){if(!n||e.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),yS(r),r.Names=i,r.supbooks=o,r}function LD(t,e){dt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var a=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};dt(t,156,TD(n))}dt(t,144)}function DD(t,e){e||(e=nt(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Zn("SheetJS",e),Zn(hp.version,e),Zn(hp.version,e),Zn("7262",e),e.length>e.l?e.slice(0,e.l):e}function PD(t,e){e||(e=nt(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function MD(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,a=0,n=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&i==-1&&(i=a);i>n||(dt(t,135),dt(t,158,PD(n)),dt(t,136))}}function ID(t,e){var r=ls();return dt(r,131),dt(r,128,DD()),dt(r,153,CD(t.Workbook&&t.Workbook.WBProps||null)),MD(r,t),LD(r,t),dt(r,132),r.end()}function BD(t,e,r){return e.slice(-4)===".bin"?RD(t,r):AD(t,r)}function UD(t,e,r,a,n,i,o,c){return e.slice(-4)===".bin"?tD(t,a,r,n,i,o,c):FR(t,a,r,n,i,o,c)}function qD(t,e,r,a,n,i,o,c){return e.slice(-4)===".bin"?vD(t,a,r,n,i):mD(t,a,r,n,i)}function zD(t,e,r,a,n,i,o,c){return e.slice(-4)===".bin"?WO():VO()}function HD(t,e,r,a,n,i,o,c){return e.slice(-4)===".bin"?zO():HO()}function WD(t,e,r,a){return e.slice(-4)===".bin"?B7(t,r,a):N7(t,r,a)}function VD(t,e,r){return tS(t,r)}function GD(t,e,r){return e.slice(-4)===".bin"?GC(t,r):HC(t,r)}function $D(t,e,r){return e.slice(-4)===".bin"?MO(t,r):TO(t,r)}function XD(t,e,r){return e.slice(-4)===".bin"?kO(t):SO(t)}function YD(t,e,r,a){return r.slice(-4)===".bin"?AO(t,e,r,a):void 0}function KD(t,e,r){return e.slice(-4)===".bin"?_O(t,e,r):bO(t,e,r)}function JD(t,e,r){return(e.slice(-4)===".bin"?ID:wS)(t)}function ZD(t,e,r,a,n){return(e.slice(-4)===".bin"?hD:gS)(t,r,a,n)}function QD(t,e,r){return(e.slice(-4)===".bin"?Y7:Q3)(t,r)}function eP(t,e,r){return(e.slice(-4)===".bin"?YC:V3)(t,r)}function tP(t,e,r){return(e.slice(-4)===".bin"?IO:nS)(t)}function rP(t){return(t.slice(-4)===".bin"?wO:rS)()}var bS=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,SS=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Do(t,e){var r=t.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=t.match(bS),i,o,c,u;if(n)for(u=0;u!=n.length;++u)i=n[u].match(SS),(o=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(o+1),a[c]=i[2].slice(1,i[2].length-1));return a}function aP(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var a=t.match(bS),n,i,o,c;if(a)for(c=0;c!=a.length;++c)n=a[c].match(SS),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(i+1),r[o]=n[2].slice(1,n[2].length-1));return r}var X0;function nP(t,e){var r=X0[t]||Yr(t);return r==="General"?tf(e):io(r,e)}function iP(t,e,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Oa(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Ra(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Yr(e)]=n}function sP(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||cc[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ad(t.v):t.w=tf(t.v):t.w=nP(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var a=X0[e]||e||"General";if(r.cellNF&&(t.z=a),r.cellDates&&t.t=="n"&&Wh(a)){var n=Xu(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function oP(t,e,r){if(r.cellStyles&&e.Interior){var a=e.Interior;a.Pattern&&(a.patternType=y7[a.Pattern]||a.Pattern)}t[e.ID]=e}function lP(t,e,r,a,n,i,o,c,u,h){var d="General",v=a.StyleID,y={};h=h||{};var g=[],b=0;for(v===void 0&&c&&(v=c.StyleID),v===void 0&&o&&(v=o.StyleID);i[v]!==void 0&&(i[v].nf&&(d=i[v].nf),i[v].Interior&&g.push(i[v].Interior),!!i[v].Parent);)v=i[v].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=Oa(t);break;case"String":a.t="s",a.r=ow(Yr(t)),a.v=t.indexOf("<")>-1?Yr(e||t).replace(/<.*?>/g,""):a.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),a.v=(Ra(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Yr(t):a.v<60&&(a.v=a.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+t),a.t||(a.t="n");break;case"Error":a.t="e",a.v=v3[t],h.cellText!==!1&&(a.w=t);break;default:t==""&&e==""?a.t="z":(a.t="s",a.v=ow(e||t));break}if(sP(a,d,h),h.cellFormula!==!1)if(a.Formula){var w=Yr(a.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),a.f=jh(w,n),delete a.Formula,a.ArrayRange=="RC"?a.F=jh("RC:RC",n):a.ArrayRange&&(a.F=jh(a.ArrayRange,n),u.push([Kr(a.F),a.F]))}else for(b=0;b<u.length;++b)n.r>=u[b][0].s.r&&n.r<=u[b][0].e.r&&n.c>=u[b][0].s.c&&n.c<=u[b][0].e.c&&(a.F=u[b][1]);h.cellStyles&&(g.forEach(function(E){!y.patternType&&E.patternType&&(y.patternType=E.patternType)}),a.s=y),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function cP(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Ag(t,e){var r=e||{};Vh();var a=B0(m2(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=ya(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=La(r);return o.type="string",Uh.to_workbook(a,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(gt){n.indexOf("<"+gt)>=0&&(i=!0)}),i)return XP(a,r);X0={"General Number":"General","General Date":fr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":fr[15],"Short Date":fr[14],"Long Time":fr[19],"Medium Time":fr[18],"Short Time":fr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:fr[2],Standard:fr[4],Percent:fr[10],Scientific:fr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,u=[],h,d={},v=[],y=r.dense?[]:{},g="",b={},w={},E=Do('<Data ss:Type="String">'),A=0,O=0,T=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},H={},z={},F="",W=0,D=[],Y={},I={},L=0,ee=[],oe=[],ge={},ie=[],he,de=!1,Z=[],Ne=[],Q={},N=0,M=0,B={Sheets:[],WBProps:{date1904:!1}},q={};sd.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";c=sd.exec(a);)switch(c[3]=(K=c[3]).toLowerCase()){case"data":if(K=="data"){if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break}if(u[u.length-1][1])break;c[1]==="/"?lP(a.slice(A,c.index),F,E,u[u.length-1][0]=="comment"?ge:b,{c:O,r:T},H,ie[O],w,Z,r):(F="",E=Do(c[0]),A=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(oe.length>0&&(b.c=oe),(!r.sheetRows||r.sheetRows>T)&&b.v!==void 0&&(r.dense?(y[T]||(y[T]=[]),y[T][O]=b):y[Xa(O)+yn(T)]=b),b.HRef&&(b.l={Target:Yr(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(N=O+(parseInt(b.MergeAcross,10)|0),M=T+(parseInt(b.MergeDown,10)|0),D.push({s:{c:O,r:T},e:{c:N,r:M}})),!r.sheetStubs)b.MergeAcross?O=N+1:++O;else if(b.MergeAcross||b.MergeDown){for(var se=O;se<=N;++se)for(var me=T;me<=M;++me)(se>O||me>T)&&(r.dense?(y[me]||(y[me]=[]),y[me][se]={t:"z"}):y[Xa(se)+yn(me)]={t:"z"});O=N+1}else++O;else b=aP(c[0]),b.Index&&(O=+b.Index-1),O<R.s.c&&(R.s.c=O),O>R.e.c&&(R.e.c=O),c[0].slice(-2)==="/>"&&++O,oe=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(T<R.s.r&&(R.s.r=T),T>R.e.r&&(R.e.r=T),c[0].slice(-2)==="/>"&&(w=Do(c[0]),w.Index&&(T=+w.Index-1)),O=0,++T):(w=Do(c[0]),w.Index&&(T=+w.Index-1),Q={},(w.AutoFitHeight=="0"||w.Height)&&(Q.hpx=parseInt(w.Height,10),Q.hpt=fd(Q.hpx),Ne[T]=Q),w.Hidden=="1"&&(Q.hidden=!0,Ne[T]=Q));break;case"worksheet":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));v.push(g),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(y["!ref"]=Er(R),r.sheetRows&&r.sheetRows<=R.e.r&&(y["!fullref"]=y["!ref"],R.e.r=r.sheetRows-1,y["!ref"]=Er(R))),D.length&&(y["!merges"]=D),ie.length>0&&(y["!cols"]=ie),Ne.length>0&&(y["!rows"]=Ne),d[g]=y}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=O=0,u.push([c[3],!1]),h=Do(c[0]),g=Yr(h.Name),y=r.dense?[]:{},D=[],Z=[],Ne=[],q={name:g,Hidden:0},B.Sheets.push(q);break;case"table":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;u.push([c[3],!1]),ie=[],de=!1}break;case"style":c[1]==="/"?oP(H,z,r):z=Do(c[0]);break;case"numberformat":z.nf=Yr(Do(c[0]).Format||"General"),X0[z.nf]&&(z.nf=X0[z.nf]);for(var we=0;we!=392&&fr[we]!=z.nf;++we);if(we==392){for(we=57;we!=392;++we)if(fr[we]==null){ac(z.nf,we);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(he=Do(c[0]),he.Hidden&&(he.hidden=!0,delete he.Hidden),he.Width&&(he.wpx=parseInt(he.Width,10)),!de&&he.wpx>10){de=!0,Ni=J3;for(var Se=0;Se<ie.length;++Se)ie[Se]&&tu(ie[Se])}de&&tu(he),ie[he.Index-1||ie.length]=he;for(var Ee=0;Ee<+he.Span;++Ee)ie[ie.length]=La(he);break;case"namedrange":if(c[1]==="/")break;B.Names||(B.Names=[]);var ae=dr(c[0]),rt={Name:ae.Name,Ref:jh(ae.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(rt.Sheet=B.Sheets.length-1),B.Names.push(rt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?F+=a.slice(W,c.index):W=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;z.Interior=Do(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?RT(Y,K,a.slice(L,c.index)):L=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else u.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));cP(ge),oe.push(ge)}else u.push([c[3],!1]),h=Do(c[0]),ge={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Je=Do(c[0]);y["!autofilter"]={ref:jh(Je.Range).replace(/\$/g,"")},u.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"null":break;default:if(u.length==0&&c[3]=="document"||u.length==0&&c[3]=="uof")return Yw(a,r);var V=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:V=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:V=!1}break;case"excelworkbook":switch(c[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:V=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:V=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(L,c.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else L=c.index+c[0].length;break;case"header":y["!margins"]||Qu(y["!margins"]={},"xlml"),isNaN(+dr(c[0]).Margin)||(y["!margins"].header=+dr(c[0]).Margin);break;case"footer":y["!margins"]||Qu(y["!margins"]={},"xlml"),isNaN(+dr(c[0]).Margin)||(y["!margins"].footer=+dr(c[0]).Margin);break;case"pagemargins":var Ie=dr(c[0]);y["!margins"]||Qu(y["!margins"]={},"xlml"),isNaN(+Ie.Top)||(y["!margins"].top=+Ie.Top),isNaN(+Ie.Left)||(y["!margins"].left=+Ie.Left),isNaN(+Ie.Right)||(y["!margins"].right=+Ie.Right),isNaN(+Ie.Bottom)||(y["!margins"].bottom=+Ie.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:V=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:V=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:V=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:V=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:V=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:V=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:V=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:V=!1}break;case"smarttags":break;default:V=!1;break}if(V||c[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?iP(I,K,ee,a.slice(L,c.index)):(ee=c,L=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+u.join("|")}var Le={};return!r.bookSheets&&!r.bookProps&&(Le.Sheets=d),Le.SheetNames=v,Le.Workbook=B,Le.SSF=La(fr),Le.Props=Y,Le.Custprops=I,Le}function jv(t,e){switch(B2(e=e||{}),e.type||"base64"){case"base64":return Ag(Ls(t),e);case"binary":case"buffer":case"file":return Ag(t,e);case"array":return Ag(iu(t),e)}}function uP(t,e){var r=[];return t.Props&&r.push(LT(t.Props,e)),t.Custprops&&r.push(DT(t.Props,t.Custprops)),r.join("")}function fP(){return""}function hP(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(a,n){var i=[];i.push(St("NumberFormat",null,{"ss:Format":fa(fr[a.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(St("Style",i.join(""),o))}),St("Styles",r.join(""))}function ES(t){return St("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+R2(t.Ref,{r:0,c:0})})}function dP(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],a=0;a<e.length;++a){var n=e[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(ES(n)))}return St("Names",r.join(""))}function pP(t,e,r,a){if(!t||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],o=0;o<n.length;++o){var c=n[o];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(ES(c)))}return i.join("")}function mP(t,e,r,a){if(!t)return"";var n=[];if(t["!margins"]&&(n.push("<PageSetup>"),t["!margins"].header&&n.push(St("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&n.push(St("Footer",null,{"x:Margin":t["!margins"].footer})),n.push(St("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(St("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),t["!protect"]&&(n.push(pi("ProtectContents","True")),t["!protect"].objects&&n.push(pi("ProtectObjects","True")),t["!protect"].scenarios&&n.push(pi("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?n.push(pi("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&n.push(pi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":St("WorksheetOptions",n.join(""),{xmlns:Ns.x})}function gP(t){return t.map(function(e){var r=M8(e.t||""),a=St("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return St("Comment",a,{"ss:Author":e.a})}).join("")}function vP(t,e,r,a,n,i,o){if(!t||t.v==null&&t.f==null)return"";var c={};if(t.f&&(c["ss:Formula"]="="+fa(R2(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var u=Ya(t.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(u.r==o.r?"":"["+(u.r-o.r)+"]")+"C"+(u.c==o.c?"":"["+(u.c-o.c)+"]")}if(t.l&&t.l.Target&&(c["ss:HRef"]=fa(t.l.Target),t.l.Tooltip&&(c["x:HRefScreenTip"]=fa(t.l.Tooltip))),r["!merges"])for(var h=r["!merges"],d=0;d!=h.length;++d)h[d].s.c!=o.c||h[d].s.r!=o.r||(h[d].e.c>h[d].s.c&&(c["ss:MergeAcross"]=h[d].e.c-h[d].s.c),h[d].e.r>h[d].s.r&&(c["ss:MergeDown"]=h[d].e.r-h[d].s.r));var v="",y="";switch(t.t){case"z":if(!a.sheetStubs)return"";break;case"n":v="Number",y=String(t.v);break;case"b":v="Boolean",y=t.v?"1":"0";break;case"e":v="Error",y=cc[t.v];break;case"d":v="DateTime",y=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||fr[14]);break;case"s":v="String",y=P8(t.v||"");break}var g=ou(a.cellXfs,t,a);c["ss:StyleID"]="s"+(21+g),c["ss:Index"]=o.c+1;var b=t.v!=null?y:"",w=t.t=="z"?"":'<Data ss:Type="'+v+'">'+b+"</Data>";return(t.c||[]).length>0&&(w+=gP(t.c)),St("Cell",w,c)}function xP(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=qh(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function yP(t,e,r,a){if(!t["!ref"])return"";var n=Kr(t["!ref"]),i=t["!merges"]||[],o=0,c=[];t["!cols"]&&t["!cols"].forEach(function(E,A){tu(E);var O=!!E.width,T=Hp(A,E),R={"ss:Index":A+1};O&&(R["ss:Width"]=cd(T.width)),E.hidden&&(R["ss:Hidden"]="1"),c.push(St("Column",null,R))});for(var u=Array.isArray(t),h=n.s.r;h<=n.e.r;++h){for(var d=[xP(h,(t["!rows"]||[])[h])],v=n.s.c;v<=n.e.c;++v){var y=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>v)&&!(i[o].s.r>h)&&!(i[o].e.c<v)&&!(i[o].e.r<h)){(i[o].s.c!=v||i[o].s.r!=h)&&(y=!0);break}if(!y){var g={r:h,c:v},b=hr(g),w=u?(t[h]||[])[v]:t[b];d.push(vP(w,b,t,e,r,a,g))}}d.push("</Row>"),d.length>2&&c.push(d.join(""))}return c.join("")}function _P(t,e,r){var a=[],n=r.SheetNames[t],i=r.Sheets[n],o=i?pP(i,e,t,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=i?yP(i,e,t,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(mP(i,e,t,r)),a.join("")}function wP(t,e){e||(e={}),t.SSF||(t.SSF=La(fr)),t.SSF&&(Vh(),Pp(t.SSF),e.revssf=Ip(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],ou(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(uP(t,e)),r.push(fP()),r.push(""),r.push("");for(var a=0;a<t.SheetNames.length;++a)r.push(St("Worksheet",_P(a,e,t),{"ss:Name":fa(t.SheetNames[a])}));return r[2]=hP(t,e),r[3]=dP(t),_n+St("Workbook",r.join(""),{xmlns:Ns.ss,"xmlns:o":Ns.o,"xmlns:x":Ns.x,"xmlns:ss":Ns.ss,"xmlns:dt":Ns.dt,"xmlns:html":Ns.html})}function bP(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=dT(r),r.length-r.l<=4)return e;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(e.UnicodeClipboardFormat=pT(r),a=r.read_shift(4),a==0||a>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var SP=[60,1084,2066,2165,2175];function EP(t,e,r,a,n){var i=a,o=[],c=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(c)}o.push(c),r.l+=i;for(var u=ec(r,r.l),h=Cv[u],d=0;h!=null&&SP.indexOf(u)>-1;)i=ec(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),c=r.slice(d,r.l+4+i),o.push(c),r.l+=4+i,h=Cv[u=ec(r,r.l)];var v=Jn(o);di(v,0);var y=0;v.lens=[];for(var g=0;g<o.length;++g)v.lens.push(y),y+=o[g].length;if(v.length<a)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+a;return e.f(v,v.length,n)}function hl(t,e,r){if(t.t!=="z"&&t.XF){var a=0;try{a=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=fr[a])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||cc[t.v]:a===0||a=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ad(t.v):t.w=tf(t.v):t.w=io(a,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&a&&t.t=="n"&&Wh(fr[a]||String(a))){var n=Xu(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function B1(t,e,r){return{v:t,ixfe:e,t:r}}function kP(t,e){var r={opts:{}},a={},n=e.dense?[]:{},i={},o={},c=null,u=[],h="",d={},v,y="",g,b,w,E,A={},O=[],T,R,H=[],z=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},W={},D=function(ct){return ct<8?Ku[ct]:ct<64&&z[ct-8]||Ku[ct]},Y=function(ct,mt,Ht){var Rt=mt.XF.data;if(!(!Rt||!Rt.patternType||!Ht||!Ht.cellStyles)){mt.s={},mt.s.patternType=Rt.patternType;var Wt;(Wt=ld(D(Rt.icvFore)))&&(mt.s.fgColor={rgb:Wt}),(Wt=ld(D(Rt.icvBack)))&&(mt.s.bgColor={rgb:Wt})}},I=function(ct,mt,Ht){if(!(Q>1)&&!(Ht.sheetRows&&ct.r>=Ht.sheetRows)){if(Ht.cellStyles&&mt.XF&&mt.XF.data&&Y(ct,mt,Ht),delete mt.ixfe,delete mt.XF,v=ct,y=hr(ct),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ct.r<o.s.r&&(o.s.r=ct.r),ct.c<o.s.c&&(o.s.c=ct.c),ct.r+1>o.e.r&&(o.e.r=ct.r+1),ct.c+1>o.e.c&&(o.e.c=ct.c+1),Ht.cellFormula&&mt.f){for(var Rt=0;Rt<O.length;++Rt)if(!(O[Rt][0].s.c>ct.c||O[Rt][0].s.r>ct.r)&&!(O[Rt][0].e.c<ct.c||O[Rt][0].e.r<ct.r)){mt.F=Er(O[Rt][0]),(O[Rt][0].s.c!=ct.c||O[Rt][0].s.r!=ct.r)&&delete mt.f,mt.f&&(mt.f=""+Ai(O[Rt][1],o,ct,Z,L));break}}Ht.dense?(n[ct.r]||(n[ct.r]=[]),n[ct.r][ct.c]=mt):n[y]=mt}},L={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:O,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(L.password=e.password);var ee,oe=[],ge=[],ie=[],he=[],de=!1,Z=[];Z.SheetNames=L.snames,Z.sharedf=L.sharedf,Z.arrayf=L.arrayf,Z.names=[],Z.XTI=[];var Ne=0,Q=0,N=0,M=[],B=[],q;L.codepage=1200,Uo(1200);for(var K=!1;t.l<t.length-1;){var se=t.l,me=t.read_shift(2);if(me===0&&Ne===10)break;var we=t.l===t.length?0:t.read_shift(2),Se=Cv[me];if(Se&&Se.f){if(e.bookSheets&&Ne===133&&me!==133)break;if(Ne=me,Se.r===2||Se.r==12){var Ee=t.read_shift(2);if(we-=2,!L.enc&&Ee!==me&&((Ee&255)<<8|Ee>>8)!==me)throw new Error("rt mismatch: "+Ee+"!="+me);Se.r==12&&(t.l+=10,we-=10)}var ae={};if(me===10?ae=Se.f(t,we,L):ae=EP(me,Se,t,we,L),Q==0&&[9,521,1033,2057].indexOf(Ne)===-1)continue;switch(me){case 34:r.opts.Date1904=F.WBProps.date1904=ae;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(t.l=0),L.enc=ae,!e.password)throw new Error("File is password-protected");if(ae.valid==null)throw new Error("Encryption scheme unsupported");if(!ae.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=ae;break;case 66:var rt=Number(ae);switch(rt){case 21010:rt=1200;break;case 32768:rt=1e4;break;case 32769:rt=1252;break}Uo(L.codepage=rt),K=!0;break;case 317:L.rrtabid=ae;break;case 25:L.winlocked=ae;break;case 439:r.opts.RefreshAll=ae;break;case 12:r.opts.CalcCount=ae;break;case 16:r.opts.CalcDelta=ae;break;case 17:r.opts.CalcIter=ae;break;case 13:r.opts.CalcMode=ae;break;case 14:r.opts.CalcPrecision=ae;break;case 95:r.opts.CalcSaveRecalc=ae;break;case 15:L.CalcRefMode=ae;break;case 2211:r.opts.FullCalc=ae;break;case 129:ae.fDialog&&(n["!type"]="dialog"),ae.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),ae.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:H.push(ae);break;case 430:Z.push([ae]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(ae);break;case 24:case 536:q={Name:ae.Name,Ref:Ai(ae.rgce,o,null,Z,L)},ae.itab>0&&(q.Sheet=ae.itab-1),Z.names.push(q),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(ae),ae.Name=="_xlnm._FilterDatabase"&&ae.itab>0&&ae.rgce&&ae.rgce[0]&&ae.rgce[0][0]&&ae.rgce[0][0][0]=="PtgArea3d"&&(B[ae.itab-1]={ref:Er(ae.rgce[0][0][1][2])});break;case 22:L.ExternCount=ae;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(ae),Z.XTI=Z.XTI.concat(ae);break;case 2196:if(L.biff<8)break;q!=null&&(q.Comment=ae[1]);break;case 18:n["!protect"]=ae;break;case 19:ae!==0&&L.WTF&&console.error("Password verifier: "+ae);break;case 133:i[ae.pos]=ae,L.snames.push(ae.name);break;case 10:{if(--Q)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=Er(o),e.sheetRows&&e.sheetRows<=o.e.r){var Je=o.e.r;o.e.r=e.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Er(o),o.e.r=Je}o.e.r++,o.e.c++}oe.length>0&&(n["!merges"]=oe),ge.length>0&&(n["!objects"]=ge),ie.length>0&&(n["!cols"]=ie),he.length>0&&(n["!rows"]=he),F.Sheets.push(W)}h===""?d=n:a[h]=n,n=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[me]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ae.BIFFVer]||8),L.biffguess=ae.BIFFVer==0,ae.BIFFVer==0&&ae.dt==4096&&(L.biff=5,K=!0,Uo(L.codepage=28591)),L.biff==8&&ae.BIFFVer==0&&ae.dt==16&&(L.biff=2),Q++)break;if(n=e.dense?[]:{},L.biff<8&&!K&&(K=!0,Uo(L.codepage=e.codepage||1252)),L.biff<5||ae.BIFFVer==0&&ae.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var V={pos:t.l-we,name:h};i[V.pos]=V,L.snames.push(h)}else h=(i[se]||{name:""}).name;ae.dt==32&&(n["!type"]="chart"),ae.dt==64&&(n["!type"]="macro"),oe=[],ge=[],L.arrayf=O=[],ie=[],he=[],de=!1,W={Hidden:(i[se]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(e.dense?(n[ae.r]||[])[ae.c]:n[hr({c:ae.c,r:ae.r})])&&++ae.c,T={ixfe:ae.ixfe,XF:H[ae.ixfe]||{},v:ae.val,t:"n"},N>0&&(T.z=M[T.ixfe>>8&63]),hl(T,e,r.opts.Date1904),I({c:ae.c,r:ae.r},T,e);break;case 5:case 517:T={ixfe:ae.ixfe,XF:H[ae.ixfe],v:ae.val,t:ae.t},N>0&&(T.z=M[T.ixfe>>8&63]),hl(T,e,r.opts.Date1904),I({c:ae.c,r:ae.r},T,e);break;case 638:T={ixfe:ae.ixfe,XF:H[ae.ixfe],v:ae.rknum,t:"n"},N>0&&(T.z=M[T.ixfe>>8&63]),hl(T,e,r.opts.Date1904),I({c:ae.c,r:ae.r},T,e);break;case 189:for(var Ie=ae.c;Ie<=ae.C;++Ie){var Le=ae.rkrec[Ie-ae.c][0];T={ixfe:Le,XF:H[Le],v:ae.rkrec[Ie-ae.c][1],t:"n"},N>0&&(T.z=M[T.ixfe>>8&63]),hl(T,e,r.opts.Date1904),I({c:Ie,r:ae.r},T,e)}break;case 6:case 518:case 1030:{if(ae.val=="String"){c=ae;break}if(T=B1(ae.val,ae.cell.ixfe,ae.tt),T.XF=H[T.ixfe],e.cellFormula){var gt=ae.formula;if(gt&&gt[0]&&gt[0][0]&&gt[0][0][0]=="PtgExp"){var et=gt[0][0][1][0],wt=gt[0][0][1][1],vt=hr({r:et,c:wt});A[vt]?T.f=""+Ai(ae.formula,o,ae.cell,Z,L):T.F=((e.dense?(n[et]||[])[wt]:n[vt])||{}).F}else T.f=""+Ai(ae.formula,o,ae.cell,Z,L)}N>0&&(T.z=M[T.ixfe>>8&63]),hl(T,e,r.opts.Date1904),I(ae.cell,T,e),c=ae}break;case 7:case 519:if(c)c.val=ae,T=B1(ae,c.cell.ixfe,"s"),T.XF=H[T.ixfe],e.cellFormula&&(T.f=""+Ai(c.formula,o,c.cell,Z,L)),N>0&&(T.z=M[T.ixfe>>8&63]),hl(T,e,r.opts.Date1904),I(c.cell,T,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{O.push(ae);var Ct=hr(ae[0].s);if(g=e.dense?(n[ae[0].s.r]||[])[ae[0].s.c]:n[Ct],e.cellFormula&&g){if(!c||!Ct||!g)break;g.f=""+Ai(ae[1],o,ae[0],Z,L),g.F=Er(ae[0])}}break;case 1212:{if(!e.cellFormula)break;if(y){if(!c)break;A[hr(c.cell)]=ae[0],g=e.dense?(n[c.cell.r]||[])[c.cell.c]:n[hr(c.cell)],(g||{}).f=""+Ai(ae[0],o,v,Z,L)}}break;case 253:T=B1(u[ae.isst].t,ae.ixfe,"s"),u[ae.isst].h&&(T.h=u[ae.isst].h),T.XF=H[T.ixfe],N>0&&(T.z=M[T.ixfe>>8&63]),hl(T,e,r.opts.Date1904),I({c:ae.c,r:ae.r},T,e);break;case 513:e.sheetStubs&&(T={ixfe:ae.ixfe,XF:H[ae.ixfe],t:"z"},N>0&&(T.z=M[T.ixfe>>8&63]),hl(T,e,r.opts.Date1904),I({c:ae.c,r:ae.r},T,e));break;case 190:if(e.sheetStubs)for(var Et=ae.c;Et<=ae.C;++Et){var It=ae.ixfe[Et-ae.c];T={ixfe:It,XF:H[It],t:"z"},N>0&&(T.z=M[T.ixfe>>8&63]),hl(T,e,r.opts.Date1904),I({c:Et,r:ae.r},T,e)}break;case 214:case 516:case 4:T=B1(ae.val,ae.ixfe,"s"),T.XF=H[T.ixfe],N>0&&(T.z=M[T.ixfe>>8&63]),hl(T,e,r.opts.Date1904),I({c:ae.c,r:ae.r},T,e);break;case 0:case 512:Q===1&&(o=ae);break;case 252:u=ae;break;case 1054:if(L.biff==4){M[N++]=ae[1];for(var er=0;er<N+163&&fr[er]!=ae[1];++er);er>=163&&ac(ae[1],N+163)}else ac(ae[1],ae[0]);break;case 30:{M[N++]=ae;for(var Vt=0;Vt<N+163&&fr[Vt]!=ae;++Vt);Vt>=163&&ac(ae,N+163)}break;case 229:oe=oe.concat(ae);break;case 93:ge[ae.cmo[0]]=L.lastobj=ae;break;case 438:L.lastobj.TxO=ae;break;case 127:L.lastobj.ImData=ae;break;case 440:for(E=ae[0].s.r;E<=ae[0].e.r;++E)for(w=ae[0].s.c;w<=ae[0].e.c;++w)g=e.dense?(n[E]||[])[w]:n[hr({c:w,r:E})],g&&(g.l=ae[1]);break;case 2048:for(E=ae[0].s.r;E<=ae[0].e.r;++E)for(w=ae[0].s.c;w<=ae[0].e.c;++w)g=e.dense?(n[E]||[])[w]:n[hr({c:w,r:E})],g&&g.l&&(g.l.Tooltip=ae[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;g=e.dense?(n[ae[0].r]||[])[ae[0].c]:n[hr(ae[0])];var Oe=ge[ae[2]];g||(e.dense?(n[ae[0].r]||(n[ae[0].r]=[]),g=n[ae[0].r][ae[0].c]={t:"z"}):g=n[hr(ae[0])]={t:"z"},o.e.r=Math.max(o.e.r,ae[0].r),o.s.r=Math.min(o.s.r,ae[0].r),o.e.c=Math.max(o.e.c,ae[0].c),o.s.c=Math.min(o.s.c,ae[0].c)),g.c||(g.c=[]),b={a:ae[1],t:Oe.TxO.t},g.c.push(b)}break;case 2173:hO(H[ae.ixfe],ae.ext);break;case 125:{if(!L.cellStyles)break;for(;ae.e>=ae.s;)ie[ae.e--]={width:ae.w/256,level:ae.level||0,hidden:!!(ae.flags&1)},de||(de=!0,C2(ae.w/256)),tu(ie[ae.e+1])}break;case 520:{var Ye={};ae.level!=null&&(he[ae.r]=Ye,Ye.level=ae.level),ae.hidden&&(he[ae.r]=Ye,Ye.hidden=!0),ae.hpt&&(he[ae.r]=Ye,Ye.hpt=ae.hpt,Ye.hpx=qh(ae.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Qu(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[me]]=ae;break;case 161:n["!margins"]||Qu(n["!margins"]={}),n["!margins"].header=ae.header,n["!margins"].footer=ae.footer;break;case 574:ae.RTL&&(F.Views[0].RTL=!0);break;case 146:z=ae;break;case 2198:ee=ae;break;case 140:R=ae;break;case 442:h?W.CodeName=ae||W.name:F.WBProps.CodeName=ae||"ThisWorkbook";break}}else Se||console.error("Missing Info for XLS Record 0x"+me.toString(16)),t.l+=we}return r.SheetNames=un(i).sort(function(He,ct){return Number(He)-Number(ct)}).map(function(He){return i[He].name}),e.bookSheets||(r.Sheets=a),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&B.forEach(function(He,ct){r.Sheets[r.SheetNames[ct]]["!autofilter"]=He}),r.Strings=u,r.SSF=La(fr),L.enc&&(r.Encryption=L.enc),ee&&(r.Themes=ee),r.Metadata={},R!==void 0&&(r.Metadata.Country=R),Z.names.length>0&&(F.Names=Z.names),r.Workbook=F,r}var Y0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function AP(t,e,r){var a=ar.find(t,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=kw(a,Sv,Y0.DSI);for(var i in n)e[i]=n[i]}catch(h){if(r.WTF)throw h}var o=ar.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var c=kw(o,Ev,Y0.SI);for(var u in c)e[u]==null&&(e[u]=c[u])}catch(h){if(r.WTF)throw h}e.HeadingPairs&&e.TitlesOfParts&&(S3(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function NP(t,e){var r=[],a=[],n=[],i=0,o,c=tw(Sv,"n"),u=tw(Ev,"n");if(t.Props)for(o=un(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(u,o[i])?a:n).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=un(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(u,o[i])?a:n).push([o[i],t.Custprops[o[i]]]);var h=[];for(i=0;i<n.length;++i)C3.indexOf(n[i][0])>-1||b3.indexOf(n[i][0])>-1||n[i][1]!=null&&h.push(n[i]);a.length&&ar.utils.cfb_add(e,"/SummaryInformation",Aw(a,Y0.SI,u,Ev)),(r.length||h.length)&&ar.utils.cfb_add(e,"/DocumentSummaryInformation",Aw(r,Y0.DSI,c,Sv,h.length?h:null,Y0.UDI))}function kS(t,e){e||(e={}),B2(e),s2(),e.codepage&&i2(e.codepage);var r,a;if(t.FullPaths){if(ar.find(t,"/encryption"))throw new Error("File is password-protected");r=ar.find(t,"!CompObj"),a=ar.find(t,"/Workbook")||ar.find(t,"/Book")}else{switch(e.type){case"base64":t=Os(Ls(t));break;case"binary":t=Os(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}di(t,0),a={content:t}}var n,i;if(r&&bP(r),e.bookProps&&!e.bookSheets)n={};else{var o=Cr?"buffer":"array";if(a&&a.content)n=kP(a.content,e);else if((i=ar.find(t,"PerfectOffice_MAIN"))&&i.content)n=Zu.to_workbook(i.content,(e.type=o,e));else if((i=ar.find(t,"NativeContent_MAIN"))&&i.content)n=Zu.to_workbook(i.content,(e.type=o,e));else throw(i=ar.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&ar.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=UO(t))}var c={};return t.FullPaths&&AP(t,c,e),n.Props=n.Custprops=c,e.bookFiles&&(n.cfb=t),n}function TP(t,e){var r=e||{},a=ar.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ar.utils.cfb_add(a,n,AS(t,r)),r.biff==8&&(t.Props||t.Custprops)&&NP(t,a),r.biff==8&&t.vbaraw&&qO(a,ar.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),a}var hd={0:{f:ZR},1:{f:sL},2:{f:kL},3:{f:pL},4:{f:uL},5:{f:bL},6:{f:CL},7:{f:xL},8:{f:ML},9:{f:PL},10:{f:LL},11:{f:DL},12:{f:lL},13:{f:NL},14:{f:gL},15:{f:hL},16:{f:vS},17:{f:FL},18:{f:_L},19:{f:_2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:FD},40:{},42:{},43:{f:C7},44:{f:T7},45:{f:R7},46:{f:D7},47:{f:L7},48:{},49:{f:tT},50:{},51:{f:mO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:q3},62:{f:jL},63:{f:EO},64:{f:QL},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ci,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:YL},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:nL},148:{f:tL,p:16},151:{f:HL},152:{},153:{f:jD},154:{},155:{},156:{f:ND},157:{},158:{},159:{T:1,f:VC},160:{T:-1},161:{T:1,f:pf},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:IL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:dO},336:{T:-1},337:{f:xO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:bv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:U3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:WL},427:{f:VL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:$L},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:aL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:qL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:bv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:DO},633:{T:1},634:{T:-1},635:{T:1,f:RO},636:{T:-1},637:{f:iT},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:gD},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:eD},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Cv={6:{f:Eg},10:{f:Wc},12:{f:jn},13:{f:jn},14:{f:mn},15:{f:mn},16:{f:Ti},17:{f:mn},18:{f:mn},19:{f:jn},20:{f:Fw},21:{f:Fw},23:{f:U3},24:{f:Lw},25:{f:mn},26:{},27:{},28:{f:eC},29:{},34:{f:mn},35:{f:Rw},38:{f:Ti},39:{f:Ti},40:{f:Ti},41:{f:Ti},42:{f:mn},43:{f:mn},47:{f:h7},49:{f:Nj},51:{f:jn},60:{},61:{f:bj},64:{f:mn},65:{f:Aj},66:{f:jn},77:{},80:{},81:{},82:{},85:{f:jn},89:{},90:{},91:{},92:{f:fj},93:{f:aC},94:{},95:{f:mn},96:{},97:{},99:{f:mn},125:{f:q3},128:{f:zj},129:{f:dj},130:{f:jn},131:{f:mn},132:{f:mn},133:{f:pj},134:{},140:{f:fC},141:{f:jn},144:{},146:{f:pC},151:{},152:{},153:{},154:{},155:{},156:{f:jn},157:{},158:{},160:{f:wC},161:{f:vC},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Ij},190:{f:Bj},193:{f:Wc},197:{},198:{},199:{},200:{},201:{},202:{f:mn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:jn},220:{},221:{f:mn},222:{},224:{f:qj},225:{f:uj},226:{f:Wc},227:{},229:{f:tC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:gj},253:{f:jj},255:{f:xj},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:O3},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:mn},353:{f:Wc},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:$j},431:{f:mn},432:{},433:{},434:{},437:{},438:{f:sC},439:{f:mn},440:{f:oC},441:{},442:{f:wd},443:{},444:{f:jn},445:{},446:{},448:{f:Wc},449:{f:wj,r:2},450:{f:Wc},512:{f:jw},513:{f:_C},515:{f:Vj},516:{f:Oj},517:{f:Ow},519:{f:bC},520:{f:yj},523:{},545:{f:Dw},549:{f:Tw},566:{},574:{f:Ej},638:{f:Mj},659:{},1048:{},1054:{f:Rj},1084:{},1212:{f:Jj},2048:{f:cC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:P1},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Wc},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:mC,r:12},2173:{f:fO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:mn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Kj,r:12},2197:{},2198:{f:iO,r:12},2199:{},2200:{},2201:{},2202:{f:Zj,r:12},2203:{f:Wc},2204:{},2205:{},2206:{},2207:{},2211:{f:_j},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:jn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:xC},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:dC},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:jw},1:{},2:{f:NC},3:{f:kC},4:{f:EC},5:{f:Ow},7:{f:jC},8:{},9:{f:P1},11:{},22:{f:jn},30:{f:Dj},31:{},32:{},33:{f:Dw},36:{},37:{f:Tw},50:{f:CC},62:{},52:{},67:{},68:{f:jn},69:{},86:{},126:{},127:{f:SC},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:OC},223:{},234:{},354:{},421:{},518:{f:Eg},521:{f:P1},536:{f:Lw},547:{f:Rw},561:{},579:{},1030:{f:Eg},1033:{f:P1},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function At(t,e,r,a){var n=e;if(!isNaN(n)){var i=a||(r||[]).length||0,o=t.next(4);o.write_shift(2,n),o.write_shift(2,i),i>0&&v2(r)&&t.push(r)}}function jP(t,e,r,a){var n=(r||[]).length||0;if(n<=8224)return At(t,e,r,n);var i=e;if(!isNaN(i)){for(var o=r.parts||[],c=0,u=0,h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;var d=t.next(4);for(d.write_shift(2,i),d.write_shift(2,h),t.push(r.slice(u,u+h)),u+=h;u<n;){for(d=t.next(4),d.write_shift(2,60),h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;d.write_shift(2,h),t.push(r.slice(u,u+h)),u+=h}}}function kd(t,e,r){return t||(t=nt(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function CP(t,e,r,a){var n=nt(9);return kd(n,t,e),F3(r,a||"b",n),n}function OP(t,e,r){var a=nt(8+2*r.length);return kd(a,t,e),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function FP(t,e,r,a){if(e.v!=null)switch(e.t){case"d":case"n":var n=e.t=="d"?zn(Ra(e.v)):e.v;n==(n|0)&&n>=0&&n<65536?At(t,2,TC(r,a,n)):At(t,3,AC(r,a,n));return;case"b":case"e":At(t,5,CP(r,a,e.v,e.t));return;case"s":case"str":At(t,4,OP(r,a,(e.v||"").slice(0,255)));return}At(t,1,kd(null,r,a))}function RP(t,e,r,a){var n=Array.isArray(e),i=Kr(e["!ref"]||"A1"),o,c="",u=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Er(i)}for(var h=i.s.r;h<=i.e.r;++h){c=yn(h);for(var d=i.s.c;d<=i.e.c;++d){h===i.s.r&&(u[d]=Xa(d)),o=u[d]+c;var v=n?(e[h]||[])[d]:e[o];v&&FP(t,v,h,d)}}}function LP(t,e){for(var r=e||{},a=ls(),n=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return At(a,r.biff==4?1033:r.biff==3?521:9,N2(t,16,r)),RP(a,t.Sheets[t.SheetNames[n]],n,r),At(a,10),a.end()}function DP(t,e,r){At(t,49,Tj({sz:12,name:"Arial"},r))}function PP(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&At(t,1054,Lj(n,e[n],r))})}function MP(t,e){var r=nt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),At(t,2151,r),r=nt(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),M3(Kr(e["!ref"]||"A1"),r),r.write_shift(4,4),At(t,2152,r)}function IP(t,e){for(var r=0;r<16;++r)At(t,224,Cw({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(a){At(t,224,Cw(a,0,e))})}function BP(t,e){for(var r=0;r<e["!links"].length;++r){var a=e["!links"][r];At(t,440,lC(a)),a[1].Tooltip&&At(t,2048,uC(a))}delete e["!links"]}function UP(t,e){if(e){var r=0;e.forEach(function(a,n){++r<=256&&a&&At(t,125,gC(Hp(n,a),n))})}}function qP(t,e,r,a,n){var i=16+ou(n.cellXfs,e,n);if(e.v==null&&!e.bf){At(t,513,sf(r,a,i));return}if(e.bf)At(t,6,dR(e,r,a,n,i));else switch(e.t){case"d":case"n":var o=e.t=="d"?zn(Ra(e.v)):e.v;At(t,515,Gj(r,a,o,i));break;case"b":case"e":At(t,517,Wj(r,a,e.v,i,n,e.t));break;case"s":case"str":if(n.bookSST){var c=D2(n.Strings,e.v,n.revStrings);At(t,253,Cj(r,a,c,i))}else At(t,516,Fj(r,a,(e.v||"").slice(0,255),i,n));break;default:At(t,513,sf(r,a,i))}}function zP(t,e,r){var a=ls(),n=r.SheetNames[t],i=r.Sheets[n]||{},o=(r||{}).Workbook||{},c=(o.Sheets||[])[t]||{},u=Array.isArray(i),h=e.biff==8,d,v="",y=[],g=Kr(i["!ref"]||"A1"),b=h?65536:16384;if(g.e.c>255||g.e.r>=b){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,b-1)}At(a,2057,N2(r,16,e)),At(a,13,ao(1)),At(a,12,ao(100)),At(a,15,Ui(!0)),At(a,17,Ui(!1)),At(a,16,af(.001)),At(a,95,Ui(!0)),At(a,42,Ui(!1)),At(a,43,Ui(!1)),At(a,130,ao(1)),At(a,128,Hj()),At(a,131,Ui(!1)),At(a,132,Ui(!1)),h&&UP(a,i["!cols"]),At(a,512,Pj(g,e)),h&&(i["!links"]=[]);for(var w=g.s.r;w<=g.e.r;++w){v=yn(w);for(var E=g.s.c;E<=g.e.c;++E){w===g.s.r&&(y[E]=Xa(E)),d=y[E]+v;var A=u?(i[w]||[])[E]:i[d];A&&(qP(a,A,w,E,e),h&&A.l&&i["!links"].push([d,A.l]))}}var O=c.CodeName||c.name||n;return h&&At(a,574,kj((o.Views||[])[0])),h&&(i["!merges"]||[]).length&&At(a,229,rC(i["!merges"])),h&&BP(a,i),At(a,442,R3(O)),h&&MP(a,i),At(a,10),a.end()}function HP(t,e,r){var a=ls(),n=(t||{}).Workbook||{},i=n.Sheets||[],o=n.WBProps||{},c=r.biff==8,u=r.biff==5;if(At(a,2057,N2(t,5,r)),r.bookType=="xla"&&At(a,135),At(a,225,c?ao(1200):null),At(a,193,WT(2)),u&&At(a,191),u&&At(a,192),At(a,226),At(a,92,hj("SheetJS",r)),At(a,66,ao(c?1200:1252)),c&&At(a,353,ao(0)),c&&At(a,448),At(a,317,yC(t.SheetNames.length)),c&&t.vbaraw&&At(a,211),c&&t.vbaraw){var h=o.CodeName||"ThisWorkbook";At(a,442,R3(h))}At(a,156,ao(17)),At(a,25,Ui(!1)),At(a,18,Ui(!1)),At(a,19,ao(0)),c&&At(a,431,Ui(!1)),c&&At(a,444,ao(0)),At(a,61,Sj()),At(a,64,Ui(!1)),At(a,141,ao(0)),At(a,34,Ui(wD(t)=="true")),At(a,14,Ui(!0)),c&&At(a,439,Ui(!1)),At(a,218,ao(0)),DP(a,t,r),PP(a,t.SSF,r),IP(a,r),c&&At(a,352,Ui(!1));var d=a.end(),v=ls();c&&At(v,140,hC()),c&&r.Strings&&jP(v,252,vj(r.Strings)),At(v,10);var y=v.end(),g=ls(),b=0,w=0;for(w=0;w<t.SheetNames.length;++w)b+=(c?12:11)+(c?2:1)*t.SheetNames[w].length;var E=d.length+b+y.length;for(w=0;w<t.SheetNames.length;++w){var A=i[w]||{};At(g,133,mj({pos:E,hs:A.Hidden||0,dt:0,name:t.SheetNames[w]},r)),E+=e[w].length}var O=g.end();if(b!=O.length)throw new Error("BS8 "+b+" != "+O.length);var T=[];return d.length&&T.push(d),O.length&&T.push(O),y.length&&T.push(y),Jn(T)}function WP(t,e){var r=e||{},a=[];t&&!t.SSF&&(t.SSF=La(fr)),t&&t.SSF&&(Vh(),Pp(t.SSF),r.revssf=Ip(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,U2(r),r.cellXfs=[],ou(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var n=0;n<t.SheetNames.length;++n)a[a.length]=zP(n,r,t);return a.unshift(HP(t,a,r)),Jn(a)}function AS(t,e){for(var r=0;r<=t.SheetNames.length;++r){var a=t.Sheets[t.SheetNames[r]];if(!(!a||!a["!ref"])){var n=cs(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return WP(t,e);case 4:case 3:case 2:return LP(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Vw(t,e){var r=e||{},a=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var n=t.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),o=n.index,c=i&&i.index||t.length,u=T8(t.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,d=0,v=0,y=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(o=0;o<u.length;++o){var w=u[o].trim(),E=w.slice(0,3).toLowerCase();if(E=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}d=0;continue}if(!(E!="<td"&&E!="<th")){var A=w.split(/<\/t[dh]>/i);for(c=0;c<A.length;++c){var O=A[c].trim();if(O.match(/<t[dh]/i)){for(var T=O,R=0;T.charAt(0)=="<"&&(R=T.indexOf(">"))>-1;)T=T.slice(R+1);for(var H=0;H<b.length;++H){var z=b[H];z.s.c==d&&z.s.r<h&&h<=z.e.r&&(d=z.e.c+1,H=-1)}var F=dr(O.slice(0,O.indexOf(">")));y=F.colspan?+F.colspan:1,((v=+F.rowspan)>1||y>1)&&b.push({s:{r:h,c:d},e:{r:h+(v||1)-1,c:d+y-1}});var W=F.t||F["data-t"]||"";if(!T.length){d+=y;continue}if(T=K4(T),g.s.r>h&&(g.s.r=h),g.e.r<h&&(g.e.r=h),g.s.c>d&&(g.s.c=d),g.e.c<d&&(g.e.c=d),!T.length){d+=y;continue}var D={t:"s",v:T};r.raw||!T.trim().length||W=="s"||(T==="TRUE"?D={t:"b",v:!0}:T==="FALSE"?D={t:"b",v:!1}:isNaN(zo(T))?isNaN(Bh(T).getDate())||(D={t:"d",v:Ra(T)},r.cellDates||(D={t:"n",v:zn(D.v)}),D.z=r.dateNF||fr[14]):D={t:"n",v:zo(T)}),r.dense?(a[h]||(a[h]=[]),a[h][d]=D):a[hr({r:h,c:d})]=D,d+=y}}}}return a["!ref"]=Er(g),b.length&&(a["!merges"]=b),a}function VP(t,e,r,a){for(var n=t["!merges"]||[],i=[],o=e.s.c;o<=e.e.c;++o){for(var c=0,u=0,h=0;h<n.length;++h)if(!(n[h].s.r>r||n[h].s.c>o)&&!(n[h].e.r<r||n[h].e.c<o)){if(n[h].s.r<r||n[h].s.c<o){c=-1;break}c=n[h].e.r-n[h].s.r+1,u=n[h].e.c-n[h].s.c+1;break}if(!(c<0)){var d=hr({r,c:o}),v=a.dense?(t[r]||[])[o]:t[d],y=v&&v.v!=null&&(v.h||p2(v.w||(ic(v),v.w)||""))||"",g={};c>1&&(g.rowspan=c),u>1&&(g.colspan=u),a.editable?y='<span contenteditable="true">'+y+"</span>":v&&(g["data-t"]=v&&v.t||"z",v.v!=null&&(g["data-v"]=v.v),v.z!=null&&(g["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+v.l.Target+'">'+y+"</a>")),g.id=(a.id||"sjs")+"-"+d,i.push(St("td",y,g))}}var b="<tr>";return b+i.join("")+"</tr>"}var GP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$P="</body></html>";function XP(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return su(Vw(r[0],e),e);var a=H2();return r.forEach(function(n,i){W2(a,Vw(n,e),"Sheet"+(i+1))}),a}function YP(t,e,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function NS(t,e){var r=e||{},a=r.header!=null?r.header:GP,n=r.footer!=null?r.footer:$P,i=[a],o=cs(t["!ref"]);r.dense=Array.isArray(t),i.push(YP(t,o,r));for(var c=o.s.r;c<=o.e.r;++c)i.push(VP(t,o,c,r));return i.push("</table>"+n),i.join("")}function TS(t,e,r){var a=r||{},n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var o=typeof a.origin=="string"?Ya(a.origin):a.origin;n=o.r,i=o.c}var c=e.getElementsByTagName("tr"),u=Math.min(a.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:n,c:i}};if(t["!ref"]){var d=cs(t["!ref"]);h.s.r=Math.min(h.s.r,d.s.r),h.s.c=Math.min(h.s.c,d.s.c),h.e.r=Math.max(h.e.r,d.e.r),h.e.c=Math.max(h.e.c,d.e.c),n==-1&&(h.e.r=n=d.e.r+1)}var v=[],y=0,g=t["!rows"]||(t["!rows"]=[]),b=0,w=0,E=0,A=0,O=0,T=0;for(t["!cols"]||(t["!cols"]=[]);b<c.length&&w<u;++b){var R=c[b];if(Gw(R)){if(a.display)continue;g[w]={hidden:!0}}var H=R.children;for(E=A=0;E<H.length;++E){var z=H[E];if(!(a.display&&Gw(z))){var F=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):K4(z.innerHTML),W=z.getAttribute("data-z")||z.getAttribute("z");for(y=0;y<v.length;++y){var D=v[y];D.s.c==A+i&&D.s.r<w+n&&w+n<=D.e.r&&(A=D.e.c+1-i,y=-1)}T=+z.getAttribute("colspan")||1,((O=+z.getAttribute("rowspan")||1)>1||T>1)&&v.push({s:{r:w+n,c:A+i},e:{r:w+n+(O||1)-1,c:A+i+(T||1)-1}});var Y={t:"s",v:F},I=z.getAttribute("data-t")||z.getAttribute("t")||"";F!=null&&(F.length==0?Y.t=I||"z":a.raw||F.trim().length==0||I=="s"||(F==="TRUE"?Y={t:"b",v:!0}:F==="FALSE"?Y={t:"b",v:!1}:isNaN(zo(F))?isNaN(Bh(F).getDate())||(Y={t:"d",v:Ra(F)},a.cellDates||(Y={t:"n",v:zn(Y.v)}),Y.z=a.dateNF||fr[14]):Y={t:"n",v:zo(F)})),Y.z===void 0&&W!=null&&(Y.z=W);var L="",ee=z.getElementsByTagName("A");if(ee&&ee.length)for(var oe=0;oe<ee.length&&!(ee[oe].hasAttribute("href")&&(L=ee[oe].getAttribute("href"),L.charAt(0)!="#"));++oe);L&&L.charAt(0)!="#"&&(Y.l={Target:L}),a.dense?(t[w+n]||(t[w+n]=[]),t[w+n][A+i]=Y):t[hr({c:A+i,r:w+n})]=Y,h.e.c<A+i&&(h.e.c=A+i),A+=T}}++w}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),h.e.r=Math.max(h.e.r,w-1+n),t["!ref"]=Er(h),w>=u&&(t["!fullref"]=Er((h.e.r=c.length-b+w-1+n,h))),t}function jS(t,e){var r=e||{},a=r.dense?[]:{};return TS(a,t,e)}function KP(t,e){return su(jS(t,e),e)}function Gw(t){var e="",r=JP(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function JP(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function ZP(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Yr(e.replace(/<[^>]*>/g,""));return[r]}var $w={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function CS(t,e){var r=e||{},a=m2(t),n=[],i,o,c={name:""},u="",h=0,d,v,y={},g=[],b=r.dense?[]:{},w,E,A={value:""},O="",T=0,R=[],H=-1,z=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},W=0,D={},Y=[],I={},L=0,ee=0,oe=[],ge=1,ie=1,he=[],de={Names:[]},Z={},Ne=["",""],Q=[],N={},M="",B=0,q=!1,K=!1,se=0;for(sd.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=sd.exec(a);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?b["!ref"]=Er(F):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=F.e.r&&(b["!fullref"]=b["!ref"],F.e.r=r.sheetRows-1,b["!ref"]=Er(F)),Y.length&&(b["!merges"]=Y),oe.length&&(b["!rows"]=oe),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),g.push(d.name),y[d.name]=b,K=!1):w[0].charAt(w[0].length-2)!=="/"&&(d=dr(w[0],!1),H=z=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,b=r.dense?[]:{},Y=[],oe=[],K=!0);break;case"table-row-group":w[1]==="/"?--W:++W;break;case"table-row":case"":if(w[1]==="/"){H+=ge,ge=1;break}if(v=dr(w[0],!1),v.?H=v.-1:H==-1&&(H=0),ge=+v["number-rows-repeated"]||1,ge<10)for(se=0;se<ge;++se)W>0&&(oe[H+se]={level:W});z=-1;break;case"covered-table-cell":w[1]!=="/"&&++z,r.sheetStubs&&(r.dense?(b[H]||(b[H]=[]),b[H][z]={t:"z"}):b[hr({r:H,c:z})]={t:"z"}),O="",R=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++z,A=dr(w[0],!1),ie=parseInt(A["number-columns-repeated"]||"1",10),E={t:"z",v:null},A.formula&&r.cellFormula!=!1&&(E.f=zw(Yr(A.formula))),(A.||A["value-type"])=="string"&&(E.t="s",E.v=Yr(A["string-value"]||""),r.dense?(b[H]||(b[H]=[]),b[H][z]=E):b[hr({r:H,c:z})]=E),z+=ie-1;else if(w[1]!=="/"){++z,O="",T=0,R=[],ie=1;var me=ge?H+ge-1:H;if(z>F.e.c&&(F.e.c=z),z<F.s.c&&(F.s.c=z),H<F.s.r&&(F.s.r=H),me>F.e.r&&(F.e.r=me),A=dr(w[0],!1),Q=[],N={},E={t:A.||A["value-type"],v:null},r.cellFormula)if(A.formula&&(A.formula=Yr(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(L=parseInt(A["number-matrix-rows-spanned"],10)||0,ee=parseInt(A["number-matrix-columns-spanned"],10)||0,I={s:{r:H,c:z},e:{r:H+L-1,c:z+ee-1}},E.F=Er(I),he.push([I,E.F])),A.formula)E.f=zw(A.formula);else for(se=0;se<he.length;++se)H>=he[se][0].s.r&&H<=he[se][0].e.r&&z>=he[se][0].s.c&&z<=he[se][0].e.c&&(E.F=he[se][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(L=parseInt(A["number-rows-spanned"],10)||0,ee=parseInt(A["number-columns-spanned"],10)||0,I={s:{r:H,c:z},e:{r:H+L-1,c:z+ee-1}},Y.push(I)),A["number-columns-repeated"]&&(ie=parseInt(A["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=Oa(A["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(A.value);break;case"percentage":E.t="n",E.v=parseFloat(A.value);break;case"currency":E.t="n",E.v=parseFloat(A.value);break;case"date":E.t="d",E.v=Ra(A["date-value"]),r.cellDates||(E.t="n",E.v=zn(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=k8(A["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Bp(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(A.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",A["string-value"]!=null&&(O=Yr(A["string-value"]),R=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(q=!1,E.t==="s"&&(E.v=O||"",R.length&&(E.R=R),q=T==0),Z.Target&&(E.l=Z),Q.length>0&&(E.c=Q,Q=[]),O&&r.cellText!==!1&&(E.w=O),q&&(E.t="z",delete E.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=H))for(var we=0;we<ge;++we){if(ie=parseInt(A["number-columns-repeated"]||"1",10),r.dense)for(b[H+we]||(b[H+we]=[]),b[H+we][z]=we==0?E:La(E);--ie>0;)b[H+we][z+ie]=La(E);else for(b[hr({r:H+we,c:z})]=E;--ie>0;)b[hr({r:H+we,c:z+ie})]=La(E);F.e.c<=z&&(F.e.c=z)}ie=parseInt(A["number-columns-repeated"]||"1",10),z+=ie-1,ie=0,E={},O="",R=[]}Z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((i=n.pop())[0]!==w[3])throw"Bad state: "+i}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((i=n.pop())[0]!==w[3])throw"Bad state: "+i;N.t=O,R.length&&(N.R=R),N.a=M,Q.push(N)}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!1]);M="",B=0,O="",T=0,R=[];break;case"creator":w[1]==="/"?M=a.slice(B,w.index):B=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((i=n.pop())[0]!==w[3])throw"Bad state: "+i}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!1]);O="",T=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(D[c.name]=u,(i=n.pop())[0]!==w[3])throw"Bad state: "+i}else w[0].charAt(w[0].length-2)!=="/"&&(u="",c=dr(w[0],!1),n.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=dr(w[0],!1),u+=$w[w[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=dr(w[0],!1),u+=$w[w[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":u+=a.slice(h,w.index);break}else h=w.index+w[0].length;break;case"named-range":o=dr(w[0],!1),Ne=kg(o["cell-range-address"]);var Se={Name:o.name,Ref:Ne[0]+"!"+Ne[1]};K&&(Se.Sheet=g.length),de.Names.push(Se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(w[1]==="/"&&(!A||!A["string-value"])){var Ee=ZP(a.slice(T,w.index));O=(O.length>0?O+`
`:"")+Ee[0]}else dr(w[0],!1),T=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{Ne=kg(dr(w[0])["target-range-address"]),y[Ne[0]]["!autofilter"]={ref:Ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(Z=dr(w[0],!1),!Z.href)break;Z.Target=Yr(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(Ne=kg(Z.Target.slice(1)),Z.Target="#"+Ne[0]+"!"+Ne[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var ae={Sheets:y,SheetNames:g,Workbook:de};return r.bookSheets&&delete ae.Sheets,ae}function Xw(t,e){e=e||{},ro(t,"META-INF/manifest.xml")&&kT(Tn(t,"META-INF/manifest.xml"),e);var r=Fs(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=CS(ya(r),e);return ro(t,"meta.xml")&&(a.Props=_3(Tn(t,"meta.xml"))),a}function Yw(t,e){return CS(t,e)}var QP=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+id({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return _n+e}})(),Kw=(function(){var t=function(i){return fa(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,o,c){var u=[];u.push('      <table:table table:name="'+fa(o.SheetNames[c])+`" table:style-name="ta1">
`);var h=0,d=0,v=cs(i["!ref"]||"A1"),y=i["!merges"]||[],g=0,b=Array.isArray(i);if(i["!cols"])for(d=0;d<=v.e.c;++d)u.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var w="",E=i["!rows"]||[];for(h=0;h<v.s.r;++h)w=E[h]?' table:style-name="ro'+E[h].ods+'"':"",u.push("        <table:table-row"+w+`></table:table-row>
`);for(;h<=v.e.r;++h){for(w=E[h]?' table:style-name="ro'+E[h].ods+'"':"",u.push("        <table:table-row"+w+`>
`),d=0;d<v.s.c;++d)u.push(e);for(;d<=v.e.c;++d){var A=!1,O={},T="";for(g=0;g!=y.length;++g)if(!(y[g].s.c>d)&&!(y[g].s.r>h)&&!(y[g].e.c<d)&&!(y[g].e.r<h)){(y[g].s.c!=d||y[g].s.r!=h)&&(A=!0),O["table:number-columns-spanned"]=y[g].e.c-y[g].s.c+1,O["table:number-rows-spanned"]=y[g].e.r-y[g].s.r+1;break}if(A){u.push(r);continue}var R=hr({r:h,c:d}),H=b?(i[h]||[])[d]:i[R];if(H&&H.f&&(O["table:formula"]=fa(yR(H.f)),H.F&&H.F.slice(0,R.length)==R)){var z=cs(H.F);O["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,O["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!H){u.push(e);continue}switch(H.t){case"b":T=H.v?"TRUE":"FALSE",O["office:value-type"]="boolean",O["office:boolean-value"]=H.v?"true":"false";break;case"n":T=H.w||String(H.v||0),O["office:value-type"]="float",O["office:value"]=H.v||0;break;case"s":case"str":T=H.v==null?"":H.v,O["office:value-type"]="string";break;case"d":T=H.w||Ra(H.v).toISOString(),O["office:value-type"]="date",O["office:date-value"]=Ra(H.v).toISOString(),O["table:style-name"]="ce1";break;default:u.push(e);continue}var F=t(T);if(H.l&&H.l.Target){var W=H.l.Target;W=W.charAt(0)=="#"?"#"+_R(W.slice(1)):W,W.charAt(0)!="#"&&!W.match(/^\w+:/)&&(W="../"+W),F=St("text:a",F,{"xlink:href":W.replace(/&/g,"&amp;")})}u.push("          "+St("table:table-cell",St("text:p",F,{}),O)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},n=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var d=0;d<h["!cols"].length;++d)if(h["!cols"][d]){var v=h["!cols"][d];if(v.width==null&&v.wpx==null&&v.wch==null)continue;tu(v),v.ods=c;var y=h["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),i.push(`  </style:style>
`),++c}}});var u=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var d=0;d<h["!rows"].length;++d)if(h["!rows"][d]){h["!rows"][d].ods=u;var v=h["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),i.push(`  </style:style>
`),++u}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,c){var u=[_n],h=id({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=id({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(u.push("<office:document"+h+d+`>
`),u.push(y3().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+h+`>
`),n(u,o),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var v=0;v!=o.SheetNames.length;++v)u.push(a(o.Sheets[o.SheetNames[v]],o,v));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),c.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function OS(t,e){if(e.bookType=="fods")return Kw(t,e);var r=f2(),a="",n=[],i=[];return a="mimetype",Ar(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Ar(r,a,Kw(t,e)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",Ar(r,a,QP(t,e)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",Ar(r,a,_n+y3()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",Ar(r,a,TT(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Ar(r,a,AT(n)),r}function of(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ov(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):ya(iu(t))}function e9(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Os(xl(t))}function t9(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var a=0;a<e.length;++a)if(t[r+a]!=e[a])continue e;return!0}return!1}function au(t){var e=t.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(e),a=0;return t.forEach(function(n){r.set(n,a),a+=n.length}),r}function Jw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function r9(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,a=t[e+14]&1,n=e+13;n>=e;--n)a=a*256+t[n];return(t[e+15]&128?-a:a)*Math.pow(10,r-6176)}function a9(t,e,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);t[e+15]|=a>>7,t[e+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)t[e+i]=n&255;t[e+15]|=r>=0?0:128}function dd(t,e){var r=e?e[0]:0,a=t[r]&127;e:if(t[r++]>=128&&(a|=(t[r]&127)<<7,t[r++]<128||(a|=(t[r]&127)<<14,t[r++]<128)||(a|=(t[r]&127)<<21,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),a}function la(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function cn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Qr(t){for(var e=[],r=[0];r[0]<t.length;){var a=r[0],n=dd(t,r),i=n&7;n=Math.floor(n/8);var o=0,c;if(n==0)break;switch(i){case 0:{for(var u=r[0];t[r[0]++]>=128;);c=t.slice(u,r[0])}break;case 5:o=4,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=dd(t,r),c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var h={data:c,type:i};e[n]==null?e[n]=[h]:e[n].push(h)}return e}function hi(t){var e=[];return t.forEach(function(r,a){r.forEach(function(n){n.data&&(e.push(la(a*8+n.type)),n.type==2&&e.push(la(n.data.length)),e.push(n.data))})}),au(e)}function I2(t,e){return t?.map(function(r){return e(r.data)})||[]}function eo(t){for(var e,r=[],a=[0];a[0]<t.length;){var n=dd(t,a),i=Qr(t.slice(a[0],a[0]+n));a[0]+=n;var o={id:cn(i[1][0].data),messages:[]};i[2].forEach(function(c){var u=Qr(c.data),h=cn(u[3][0].data);o.messages.push({meta:u,data:t.slice(a[0],a[0]+h)}),a[0]+=h}),(e=i[3])!=null&&e[0]&&(o.merge=cn(i[3][0].data)>>>0>0),r.push(o)}return r}function hh(t){var e=[];return t.forEach(function(r){var a=[];a[1]=[{data:la(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:la(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:la(o.data.length)}],a[2].push({data:hi(o.meta),type:2})});var i=hi(a);e.push(la(i.length)),e.push(i),n.forEach(function(o){return e.push(o)})}),au(e)}function n9(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],a=dd(e,r),n=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=e[r[0]],c>1&&(o|=e[r[0]+1]<<8),c>2&&(o|=e[r[0]+2]<<16),c>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}n.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,h=0;if(i==1?(h=(e[r[0]]>>2&7)+4,u=(e[r[0]++]&224)<<3,u|=e[r[0]++]):(h=(e[r[0]++]>>2)+1,i==2?(u=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(u=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),n=[au(n)],u==0)throw new Error("Invalid offset 0");if(u>n[0].length)throw new Error("Invalid offset beyond length");if(h>=u)for(n.push(n[0].slice(-u)),h-=u;h>=n[n.length-1].length;)n.push(n[n.length-1]),h-=n[n.length-1].length;n.push(n[0].slice(-u,-u+h))}}var d=au(n);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function to(t){for(var e=[],r=0;r<t.length;){var a=t[r++],n=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(n9(a,t.slice(r,r+n))),r+=n}if(r!==t.length)throw new Error("data is not a valid framed stream!");return au(e)}function dh(t){for(var e=[],r=0;r<t.length;){var a=Math.min(t.length-r,268435455),n=new Uint8Array(4);e.push(n);var i=la(a),o=i.length;e.push(i),a<=60?(o++,e.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,e.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,e.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,e.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,e.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),e.push(t.slice(r,r+a)),o+=a,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=a}return au(e)}function i9(t,e,r,a){var n=of(t),i=n.getUint32(4,!0),o=(a>1?12:8)+Jw(i&(a>1?3470:398))*4,c=-1,u=-1,h=NaN,d=new Date(2001,0,1);i&512&&(c=n.getUint32(o,!0),o+=4),o+=Jw(i&(a>1?12288:4096))*4,i&16&&(u=n.getUint32(o,!0),o+=4),i&32&&(h=n.getFloat64(o,!0),o+=8),i&64&&(d.setTime(d.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:e[u]};break;case 5:v={t:"d",v:d};break;case 6:v={t:"b",v:h>0};break;case 7:v={t:"n",v:h/86400};break;case 8:v={t:"e",v:0};break;case 9:if(c>-1)v={t:"s",v:r[c]};else if(u>-1)v={t:"s",v:e[u]};else if(!isNaN(h))v={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function s9(t,e,r){var a=of(t),n=a.getUint32(8,!0),i=12,o=-1,c=-1,u=NaN,h=NaN,d=new Date(2001,0,1);n&1&&(u=r9(t,i),i+=16),n&2&&(h=a.getFloat64(i,!0),i+=8),n&4&&(d.setTime(d.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(c=a.getUint32(i,!0),i+=4),n&16&&(o=a.getUint32(i,!0),i+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:u};break;case 3:v={t:"s",v:e[c]};break;case 5:v={t:"d",v:d};break;case 6:v={t:"b",v:h>0};break;case 7:v={t:"n",v:h/86400};break;case 8:v={t:"e",v:0};break;case 9:if(o>-1)v={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)))}return v}function Ng(t,e){var r=new Uint8Array(32),a=of(r),n=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,a9(r,n,t.v),i|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,t.v?1:0,!0),i|=2,n+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,a.setUint32(n,e.indexOf(t.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(8,i,!0),r.slice(0,n)}function Tg(t,e){var r=new Uint8Array(32),a=of(r),n=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,a.setFloat64(n,t.v,!0),i|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,t.v?1:0,!0),i|=32,n+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,a.setUint32(n,e.indexOf(t.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(4,i,!0),r.slice(0,n)}function o9(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return i9(t,e,r,t[0]);case 5:return s9(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ki(t){var e=Qr(t);return dd(e[1][0].data)}function Zw(t,e){var r=Qr(e.data),a=cn(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(o){var c=Qr(o.data),u=cn(c[1][0].data)>>>0;switch(a){case 1:i[u]=Ov(c[3][0].data);break;case 8:{var h=t[ki(c[9][0].data)][0],d=Qr(h.data),v=t[ki(d[1][0].data)][0],y=cn(v.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var g=Qr(v.data);i[u]=g[3].map(function(b){return Ov(b.data)}).join("")}break}}),i}function l9(t,e){var r,a,n,i,o,c,u,h,d,v,y,g,b,w,E=Qr(t),A=cn(E[1][0].data)>>>0,O=cn(E[2][0].data)>>>0,T=((a=(r=E[8])==null?void 0:r[0])==null?void 0:a.data)&&cn(E[8][0].data)>0||!1,R,H;if((i=(n=E[7])==null?void 0:n[0])!=null&&i.data&&e!=0)R=(c=(o=E[7])==null?void 0:o[0])==null?void 0:c.data,H=(h=(u=E[6])==null?void 0:u[0])==null?void 0:h.data;else if((v=(d=E[4])==null?void 0:d[0])!=null&&v.data&&e!=1)R=(g=(y=E[4])==null?void 0:y[0])==null?void 0:g.data,H=(w=(b=E[3])==null?void 0:b[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var z=T?4:1,F=of(R),W=[],D=0;D<R.length/2;++D){var Y=F.getUint16(D*2,!0);Y<65535&&W.push([D,Y])}if(W.length!=O)throw"Expected ".concat(O," cells, found ").concat(W.length);var I=[];for(D=0;D<W.length-1;++D)I[W[D][0]]=H.subarray(W[D][1]*z,W[D+1][1]*z);return W.length>=1&&(I[W[W.length-1][0]]=H.subarray(W[W.length-1][1]*z)),{R:A,cells:I}}function c9(t,e){var r,a=Qr(e.data),n=(r=a?.[7])!=null&&r[0]?cn(a[7][0].data)>>>0>0?1:0:-1,i=I2(a[5],function(o){return l9(o,n)});return{nrows:cn(a[4][0].data)>>>0,data:i.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(u,h){if(o[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));o[c.R][h]=u}),o},[])}}function u9(t,e,r){var a,n=Qr(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(cn(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(cn(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Er(i);var o=Qr(n[4][0].data),c=Zw(t,t[ki(o[4][0].data)][0]),u=(a=o[17])!=null&&a[0]?Zw(t,t[ki(o[17][0].data)][0]):[],h=Qr(o[3][0].data),d=0;h[1].forEach(function(v){var y=Qr(v.data),g=t[ki(y[2][0].data)][0],b=cn(g.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var w=c9(t,g);w.data.forEach(function(E,A){E.forEach(function(O,T){var R=hr({r:d+A,c:T}),H=o9(O,c,u);H&&(r[R]=H)})}),d+=w.nrows})}function f9(t,e){var r=Qr(e.data),a={"!ref":"A1"},n=t[ki(r[2][0].data)],i=cn(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return u9(t,n[0],a),a}function h9(t,e){var r,a=Qr(e.data),n={name:(r=a[1])!=null&&r[0]?Ov(a[1][0].data):"",sheets:[]},i=I2(a[2],ki);return i.forEach(function(o){t[o].forEach(function(c){var u=cn(c.meta[1][0].data);u==6e3&&n.sheets.push(f9(t,c))})}),n}function d9(t,e){var r=H2(),a=Qr(e.data),n=I2(a[1],ki);if(n.forEach(function(i){t[i].forEach(function(o){var c=cn(o.meta[1][0].data);if(c==2){var u=h9(t,o);u.sheets.forEach(function(h,d){W2(r,h,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function jg(t){var e,r,a,n,i={},o=[];if(t.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var h;try{h=to(u.content)}catch(v){return console.log("?? "+u.content.length+" "+(v.message||v))}var d;try{d=eo(h)}catch(v){return console.log("## "+(v.message||v))}d.forEach(function(v){i[v.id]=v.messages,o.push(v.id)})}}),!o.length)throw new Error("File has no messages");var c=((n=(a=(r=(e=i?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&cn(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||o.forEach(function(u){i[u].forEach(function(h){var d=cn(h.meta[1][0].data)>>>0;if(d==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return d9(i,c)}function p9(t,e,r){var a,n,i,o;if(!((a=t[6])!=null&&a[0])||!((n=t[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var c=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&cn(t[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var u=0,h=of(t[7][0].data),d=0,v=[],y=of(t[4][0].data),g=0,b=[],w=0;w<e.length;++w){if(e[w]==null){h.setUint16(w*2,65535,!0),y.setUint16(w*2,65535);continue}h.setUint16(w*2,d,!0),y.setUint16(w*2,g,!0);var E,A;switch(typeof e[w]){case"string":E=Ng({t:"s",v:e[w]},r),A=Tg({t:"s",v:e[w]},r);break;case"number":E=Ng({t:"n",v:e[w]},r),A=Tg({t:"n",v:e[w]},r);break;case"boolean":E=Ng({t:"b",v:e[w]},r),A=Tg({t:"b",v:e[w]},r);break;default:throw new Error("Unsupported value "+e[w])}v.push(E),d+=E.length,b.push(A),g+=A.length,++u}for(t[2][0].data=la(u);w<t[7][0].data.length/2;++w)h.setUint16(w*2,65535,!0),y.setUint16(w*2,65535,!0);return t[6][0].data=au(v),t[3][0].data=au(b),u}function m9(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=cs(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Er(a)));var i=Ep(r,{range:a,header:1}),o=["~Sh33tJ5~"];i.forEach(function(M){return M.forEach(function(B){typeof B=="string"&&o.push(B)})});var c={},u=[],h=ar.read(e.numbers,{type:"base64"});h.FileIndex.map(function(M,B){return[M,h.FullPaths[B]]}).forEach(function(M){var B=M[0],q=M[1];if(B.type==2&&B.name.match(/\.iwa/)){var K=B.content,se=to(K),me=eo(se);me.forEach(function(we){u.push(we.id),c[we.id]={deps:[],location:q,type:cn(we.messages[0].meta[1][0].data)}})}}),u.sort(function(M,B){return M-B});var d=u.filter(function(M){return M>1}).map(function(M){return[M,la(M)]});h.FileIndex.map(function(M,B){return[M,h.FullPaths[B]]}).forEach(function(M){var B=M[0];if(M[1],!!B.name.match(/\.iwa/)){var q=eo(to(B.content));q.forEach(function(K){K.messages.forEach(function(se){d.forEach(function(me){K.messages.some(function(we){return cn(we.meta[1][0].data)!=11006&&t9(we.data,me[1])})&&c[me[0]].deps.push(K.id)})})})}});for(var v=ar.find(h,c[1].location),y=eo(to(v.content)),g,b=0;b<y.length;++b){var w=y[b];w.id==1&&(g=w)}var E=ki(Qr(g.messages[0].data)[1][0].data);for(v=ar.find(h,c[E].location),y=eo(to(v.content)),b=0;b<y.length;++b)w=y[b],w.id==E&&(g=w);for(E=ki(Qr(g.messages[0].data)[2][0].data),v=ar.find(h,c[E].location),y=eo(to(v.content)),b=0;b<y.length;++b)w=y[b],w.id==E&&(g=w);for(E=ki(Qr(g.messages[0].data)[2][0].data),v=ar.find(h,c[E].location),y=eo(to(v.content)),b=0;b<y.length;++b)w=y[b],w.id==E&&(g=w);var A=Qr(g.messages[0].data);{A[6][0].data=la(a.e.r+1),A[7][0].data=la(a.e.c+1);var O=ki(A[46][0].data),T=ar.find(h,c[O].location),R=eo(to(T.content));{for(var H=0;H<R.length&&R[H].id!=O;++H);if(R[H].id!=O)throw"Bad ColumnRowUIDMapArchive";var z=Qr(R[H].messages[0].data);z[1]=[],z[2]=[],z[3]=[];for(var F=0;F<=a.e.c;++F){var W=[];W[1]=W[2]=[{type:0,data:la(F+420690)}],z[1].push({type:2,data:hi(W)}),z[2].push({type:0,data:la(F)}),z[3].push({type:0,data:la(F)})}z[4]=[],z[5]=[],z[6]=[];for(var D=0;D<=a.e.r;++D)W=[],W[1]=W[2]=[{type:0,data:la(D+726270)}],z[4].push({type:2,data:hi(W)}),z[5].push({type:0,data:la(D)}),z[6].push({type:0,data:la(D)});R[H].messages[0].data=hi(z)}T.content=dh(hh(R)),T.size=T.content.length,delete A[46];var Y=Qr(A[4][0].data);{Y[7][0].data=la(a.e.r+1);var I=Qr(Y[1][0].data),L=ki(I[2][0].data);T=ar.find(h,c[L].location),R=eo(to(T.content));{if(R[0].id!=L)throw"Bad HeaderStorageBucket";var ee=Qr(R[0].messages[0].data);for(D=0;D<i.length;++D){var oe=Qr(ee[2][0].data);oe[1][0].data=la(D),oe[4][0].data=la(i[D].length),ee[2][D]={type:ee[2][0].type,data:hi(oe)}}R[0].messages[0].data=hi(ee)}T.content=dh(hh(R)),T.size=T.content.length;var ge=ki(Y[2][0].data);T=ar.find(h,c[ge].location),R=eo(to(T.content));{if(R[0].id!=ge)throw"Bad HeaderStorageBucket";for(ee=Qr(R[0].messages[0].data),F=0;F<=a.e.c;++F)oe=Qr(ee[2][0].data),oe[1][0].data=la(F),oe[4][0].data=la(a.e.r+1),ee[2][F]={type:ee[2][0].type,data:hi(oe)};R[0].messages[0].data=hi(ee)}T.content=dh(hh(R)),T.size=T.content.length;var ie=ki(Y[4][0].data);(function(){for(var M=ar.find(h,c[ie].location),B=eo(to(M.content)),q,K=0;K<B.length;++K){var se=B[K];se.id==ie&&(q=se)}var me=Qr(q.messages[0].data);{me[3]=[];var we=[];o.forEach(function(ae,rt){we[1]=[{type:0,data:la(rt)}],we[2]=[{type:0,data:la(1)}],we[3]=[{type:2,data:e9(ae)}],me[3].push({type:2,data:hi(we)})})}q.messages[0].data=hi(me);var Se=hh(B),Ee=dh(Se);M.content=Ee,M.size=M.content.length})();var he=Qr(Y[3][0].data);{var de=he[1][0];delete he[2];var Z=Qr(de.data);{var Ne=ki(Z[2][0].data);(function(){for(var M=ar.find(h,c[Ne].location),B=eo(to(M.content)),q,K=0;K<B.length;++K){var se=B[K];se.id==Ne&&(q=se)}var me=Qr(q.messages[0].data);{delete me[6],delete he[7];var we=new Uint8Array(me[5][0].data);me[5]=[];for(var Se=0,Ee=0;Ee<=a.e.r;++Ee){var ae=Qr(we);Se+=p9(ae,i[Ee],o),ae[1][0].data=la(Ee),me[5].push({data:hi(ae),type:2})}me[1]=[{type:0,data:la(a.e.c+1)}],me[2]=[{type:0,data:la(a.e.r+1)}],me[3]=[{type:0,data:la(Se)}],me[4]=[{type:0,data:la(a.e.r+1)}]}q.messages[0].data=hi(me);var rt=hh(B),Je=dh(rt);M.content=Je,M.size=M.content.length})()}de.data=hi(Z)}Y[3][0].data=hi(he)}A[4][0].data=hi(Y)}g.messages[0].data=hi(A);var Q=hh(y),N=dh(Q);return v.content=N,v.size=v.content.length,h}function FS(t){return function(r){for(var a=0;a!=t.length;++a){var n=t[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function B2(t){FS([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function U2(t){FS([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function g9(t){return Fr.WS.indexOf(t)>-1?"sheet":t==Fr.CS?"chart":t==Fr.DS?"dialog":t==Fr.MS?"macro":t&&t.length?t:"sheet"}function v9(t,e){if(!t)return 0;try{t=e.map(function(a){return a.id||(a.id=a.strRelID),[a.name,t["!id"][a.id].Target,g9(t["!id"][a.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function x9(t,e,r,a,n,i,o,c,u,h,d,v){try{i[a]=V0(Fs(t,r,!0),e);var y=Tn(t,e),g;switch(c){case"sheet":g=UD(y,e,n,u,i[a],h,d,v);break;case"chart":if(g=qD(y,e,n,u,i[a],h,d,v),!g||!g["!drawel"])break;var b=q0(g["!drawel"].Target,e),w=od(b),E=NO(Fs(t,b,!0),V0(Fs(t,w,!0),b)),A=q0(E,b),O=od(A);g=pD(Fs(t,A,!0),A,u,V0(Fs(t,O,!0),A),h,g);break;case"macro":g=zD(y,e,n,u,i[a],h,d,v);break;case"dialog":g=HD(y,e,n,u,i[a],h,d,v);break;default:throw new Error("Unrecognized sheet type "+c)}o[a]=g;var T=[];i&&i[a]&&un(i[a]).forEach(function(R){var H="";if(i[a][R].Type==Fr.CMNT){H=q0(i[a][R].Target,e);var z=$D(Tn(t,H,!0),H,u);if(!z||!z.length)return;Mw(g,z,!1)}i[a][R].Type==Fr.TCMNT&&(H=q0(i[a][R].Target,e),T=T.concat(jO(Tn(t,H,!0),u)))}),T&&T.length&&Mw(g,T,!0,u.people||[])}catch(R){if(u.WTF)throw R}}function Zs(t){return t.charAt(0)=="/"?t.slice(1):t}function y9(t,e){if(Vh(),e=e||{},B2(e),ro(t,"META-INF/manifest.xml")||ro(t,"objectdata.xml"))return Xw(t,e);if(ro(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof jg<"u"){if(t.FileIndex)return jg(t);var r=ar.utils.cfb_new();return nw(t).forEach(function(oe){Ar(r,oe,C8(t,oe))}),jg(r)}throw new Error("Unsupported NUMBERS file")}if(!ro(t,"[Content_Types].xml"))throw ro(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ro(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=nw(t),n=ST(Fs(t,"[Content_Types].xml")),i=!1,o,c;if(n.workbooks.length===0&&(c="xl/workbook.xml",Tn(t,c,!0)&&n.workbooks.push(c)),n.workbooks.length===0){if(c="xl/workbook.bin",!Tn(t,c,!0))throw new Error("Could not find workbook");n.workbooks.push(c),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var u={},h={};if(!e.bookSheets&&!e.bookProps){if(G0=[],n.sst)try{G0=GD(Tn(t,Zs(n.sst)),n.sst,e)}catch(oe){if(e.WTF)throw oe}e.cellStyles&&n.themes.length&&(u=VD(Fs(t,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],e)),n.style&&(h=WD(Tn(t,Zs(n.style)),n.style,u,e))}n.links.map(function(oe){try{var ge=V0(Fs(t,od(Zs(oe))),oe);return YD(Tn(t,Zs(oe)),ge,oe,e)}catch{}});var d=BD(Tn(t,Zs(n.workbooks[0])),n.workbooks[0],e),v={},y="";n.coreprops.length&&(y=Tn(t,Zs(n.coreprops[0]),!0),y&&(v=_3(y)),n.extprops.length!==0&&(y=Tn(t,Zs(n.extprops[0]),!0),y&&CT(y,v,e)));var g={};(!e.bookSheets||e.bookProps)&&n.custprops.length!==0&&(y=Fs(t,Zs(n.custprops[0]),!0),y&&(g=FT(y,e)));var b={};if((e.bookSheets||e.bookProps)&&(d.Sheets?o=d.Sheets.map(function(ge){return ge.name}):v.Worksheets&&v.SheetNames.length>0&&(o=v.SheetNames),e.bookProps&&(b.Props=v,b.Custprops=g),e.bookSheets&&typeof o<"u"&&(b.SheetNames=o),e.bookSheets?b.SheetNames:e.bookProps))return b;o={};var w={};e.bookDeps&&n.calcchain&&(w=XD(Tn(t,Zs(n.calcchain)),n.calcchain));var E=0,A={},O,T;{var R=d.Sheets;v.Worksheets=R.length,v.SheetNames=[];for(var H=0;H!=R.length;++H)v.SheetNames[H]=R[H].name}var z=i?"bin":"xml",F=n.workbooks[0].lastIndexOf("/"),W=(n.workbooks[0].slice(0,F+1)+"_rels/"+n.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");ro(t,W)||(W="xl/_rels/workbook."+z+".rels");var D=V0(Fs(t,W,!0),W.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(e.xlmeta=KD(Tn(t,Zs(n.metadata[0])),n.metadata[0],e)),(n.people||[]).length>=1&&(e.people=OO(Tn(t,Zs(n.people[0])),e)),D&&(D=v9(D,d.Sheets));var Y=Tn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=v.Worksheets;++E){var I="sheet";if(D&&D[E]?(O="xl/"+D[E][1].replace(/[\/]?xl\//,""),ro(t,O)||(O=D[E][1]),ro(t,O)||(O=W.replace(/_rels\/.*$/,"")+D[E][1]),I=D[E][2]):(O="xl/worksheets/sheet"+(E+1-Y)+"."+z,O=O.replace(/sheet0\./,"sheet.")),T=O.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(v.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var L=!1,ee=0;ee!=e.sheets.length;++ee)typeof e.sheets[ee]=="number"&&e.sheets[ee]==E&&(L=1),typeof e.sheets[ee]=="string"&&e.sheets[ee].toLowerCase()==v.SheetNames[E].toLowerCase()&&(L=1);if(!L)continue e}}x9(t,O,T,v.SheetNames[E],E,A,o,I,e,d,u,h)}return b={Directory:n,Workbook:d,Props:v,Custprops:g,Deps:w,Sheets:o,SheetNames:v.SheetNames,Strings:G0,Styles:h,Themes:u,SSF:La(fr)},e&&e.bookFiles&&(t.files?(b.keys=a,b.files=t.files):(b.keys=[],b.files={},t.FullPaths.forEach(function(oe,ge){oe=oe.replace(/^Root Entry[\/]/,""),b.keys.push(oe),b.files[oe]=t.FileIndex[ge]}))),e&&e.bookVBA&&(n.vba.length>0?b.vbaraw=Tn(t,Zs(n.vba[0]),!0):n.defaults&&n.defaults.bin===BO&&(b.vbaraw=Tn(t,"xl/vbaProject.bin",!0))),b}function _9(t,e){var r=e||{},a="Workbook",n=ar.find(t,a);try{if(a="/!DataSpaces/Version",n=ar.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(KC(n.content),a="/!DataSpaces/DataSpaceMap",n=ar.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=ZC(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=ar.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=QC(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=ar.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);t7(n.content)}catch{}if(a="/EncryptionInfo",n=ar.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=r7(n.content);if(a="/EncryptedPackage",n=ar.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],n.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function w9(t,e){return e.bookType=="ods"?OS(t,e):e.bookType=="numbers"?m9(t,e):e.bookType=="xlsb"?b9(t,e):S9(t,e)}function b9(t,e){bh=1024,t&&!t.SSF&&(t.SSF=La(fr)),t&&t.SSF&&(Vh(),Pp(t.SSF),e.revssf=Ip(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,$0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",a=iS.indexOf(e.bookType)>-1,n=k2();U2(e=e||{});var i=f2(),o="",c=0;if(e.cellXfs=[],ou(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Ar(i,o,w3(t.Props,e)),n.coreprops.push(o),ca(e.rels,2,o,Fr.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(t.SheetNames[h]);t.Props.SheetNames=u}for(t.Props.Worksheets=t.Props.SheetNames.length,Ar(i,o,E3(t.Props)),n.extprops.push(o),ca(e.rels,3,o,Fr.EXT_PROPS),t.Custprops!==t.Props&&un(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Ar(i,o,k3(t.Custprops)),n.custprops.push(o),ca(e.rels,4,o,Fr.CUST_PROPS)),c=1;c<=t.SheetNames.length;++c){var d={"!id":{}},v=t.Sheets[t.SheetNames[c-1]],y=(v||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,Ar(i,o,ZD(c-1,o,e,t,d)),n.sheets.push(o),ca(e.wbrels,-1,"worksheets/sheet"+c+"."+r,Fr.WS[0])}if(v){var g=v["!comments"],b=!1,w="";g&&g.length>0&&(w="xl/comments"+c+"."+r,Ar(i,w,tP(g,w)),n.comments.push(w),ca(d,-1,"../comments"+c+"."+r,Fr.CMNT),b=!0),v["!legacy"]&&b&&Ar(i,"xl/drawings/vmlDrawing"+c+".vml",aS(c,v["!comments"])),delete v["!comments"],delete v["!legacy"]}d["!id"].rId1&&Ar(i,od(o),Th(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Ar(i,o,eP(e.Strings,o,e)),n.strs.push(o),ca(e.wbrels,-1,"sharedStrings."+r,Fr.SST)),o="xl/workbook."+r,Ar(i,o,JD(t,o)),n.workbooks.push(o),ca(e.rels,1,o,Fr.WB),o="xl/theme/theme1.xml",Ar(i,o,O2(t.Themes,e)),n.themes.push(o),ca(e.wbrels,-1,"theme/theme1.xml",Fr.THEME),o="xl/styles."+r,Ar(i,o,QD(t,o,e)),n.styles.push(o),ca(e.wbrels,-1,"styles."+r,Fr.STY),t.vbaraw&&a&&(o="xl/vbaProject.bin",Ar(i,o,t.vbaraw),n.vba.push(o),ca(e.wbrels,-1,"vbaProject.bin",Fr.VBA)),o="xl/metadata."+r,Ar(i,o,rP(o)),n.metadata.push(o),ca(e.wbrels,-1,"metadata."+r,Fr.XLMETA),Ar(i,"[Content_Types].xml",x3(n,e)),Ar(i,"_rels/.rels",Th(e.rels)),Ar(i,"xl/_rels/workbook."+r+".rels",Th(e.wbrels)),delete e.revssf,delete e.ssf,i}function S9(t,e){bh=1024,t&&!t.SSF&&(t.SSF=La(fr)),t&&t.SSF&&(Vh(),Pp(t.SSF),e.revssf=Ip(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,$0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",a=iS.indexOf(e.bookType)>-1,n=k2();U2(e=e||{});var i=f2(),o="",c=0;if(e.cellXfs=[],ou(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Ar(i,o,w3(t.Props,e)),n.coreprops.push(o),ca(e.rels,2,o,Fr.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(t.SheetNames[h]);t.Props.SheetNames=u}t.Props.Worksheets=t.Props.SheetNames.length,Ar(i,o,E3(t.Props)),n.extprops.push(o),ca(e.rels,3,o,Fr.EXT_PROPS),t.Custprops!==t.Props&&un(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Ar(i,o,k3(t.Custprops)),n.custprops.push(o),ca(e.rels,4,o,Fr.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,c=1;c<=t.SheetNames.length;++c){var v={"!id":{}},y=t.Sheets[t.SheetNames[c-1]],g=(y||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,Ar(i,o,gS(c-1,e,t,v)),n.sheets.push(o),ca(e.wbrels,-1,"worksheets/sheet"+c+"."+r,Fr.WS[0])}if(y){var b=y["!comments"],w=!1,E="";if(b&&b.length>0){var A=!1;b.forEach(function(O){O[1].forEach(function(T){T.T==!0&&(A=!0)})}),A&&(E="xl/threadedComments/threadedComment"+c+"."+r,Ar(i,E,CO(b,d,e)),n.threadedcomments.push(E),ca(v,-1,"../threadedComments/threadedComment"+c+"."+r,Fr.TCMNT)),E="xl/comments"+c+"."+r,Ar(i,E,nS(b)),n.comments.push(E),ca(v,-1,"../comments"+c+"."+r,Fr.CMNT),w=!0}y["!legacy"]&&w&&Ar(i,"xl/drawings/vmlDrawing"+c+".vml",aS(c,y["!comments"])),delete y["!comments"],delete y["!legacy"]}v["!id"].rId1&&Ar(i,od(o),Th(v))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Ar(i,o,V3(e.Strings,e)),n.strs.push(o),ca(e.wbrels,-1,"sharedStrings."+r,Fr.SST)),o="xl/workbook."+r,Ar(i,o,wS(t)),n.workbooks.push(o),ca(e.rels,1,o,Fr.WB),o="xl/theme/theme1.xml",Ar(i,o,O2(t.Themes,e)),n.themes.push(o),ca(e.wbrels,-1,"theme/theme1.xml",Fr.THEME),o="xl/styles."+r,Ar(i,o,Q3(t,e)),n.styles.push(o),ca(e.wbrels,-1,"styles."+r,Fr.STY),t.vbaraw&&a&&(o="xl/vbaProject.bin",Ar(i,o,t.vbaraw),n.vba.push(o),ca(e.wbrels,-1,"vbaProject.bin",Fr.VBA)),o="xl/metadata."+r,Ar(i,o,rS()),n.metadata.push(o),ca(e.wbrels,-1,"metadata."+r,Fr.XLMETA),d.length>1&&(o="xl/persons/person.xml",Ar(i,o,FO(d)),n.people.push(o),ca(e.wbrels,-1,"persons/person.xml",Fr.PEOPLE)),Ar(i,"[Content_Types].xml",x3(n,e)),Ar(i,"_rels/.rels",Th(e.rels)),Ar(i,"xl/_rels/workbook."+r+".rels",Th(e.wbrels)),delete e.revssf,delete e.ssf,i}function q2(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ls(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function E9(t,e){return ar.find(t,"EncryptedPackage")?_9(t,e):kS(t,e)}function k9(t,e){var r,a=t,n=e||{};return n.type||(n.type=Cr&&Buffer.isBuffer(t)?"buffer":"base64"),r=$4(a,n),y9(r,n)}function RS(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return jv(t.slice(r),e);default:break e}return Uh.to_workbook(t,e)}function A9(t,e){var r="",a=q2(t,e);switch(e.type){case"base64":r=Ls(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=rf(t);break;default:throw new Error("Unrecognized type "+e.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=ya(r)),e.type="binary",RS(r,e)}function N9(t,e){var r=t;return e.type=="base64"&&(r=Ls(r)),r=td.utils.decode(1200,r.slice(2),"str"),e.type="binary",RS(r,e)}function T9(t){return t.match(/[^\x00-\x7F]/)?xl(t):t}function Cg(t,e,r,a){return a?(r.type="string",Uh.to_workbook(t,r)):Uh.to_workbook(e,r)}function Fv(t,e){s2();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Fv(new Uint8Array(t),(r=La(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=t,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ch={},r.dateNF&&(Ch.dateNF=r.dateNF),r.type||(r.type=Cr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Cr?"buffer":"binary",a=b8(t),typeof Uint8Array<"u"&&!Cr&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=T9(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return r=La(r),r.type="array",Fv(o2(a),r)}switch((n=q2(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return E9(ar.read(a,r),r);break;case 9:if(n[1]<=8)return kS(a,r);break;case 60:return jv(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return RC(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return H3.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?k9(a,r):Cg(t,a,r,i);case 239:return n[3]===60?jv(a,r):Cg(t,a,r,i);case 255:if(n[1]===254)return N9(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Zu.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Zu.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Tv.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return K3.to_workbook(a,r);break;case 10:case 13:case 32:return A9(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return FC.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Tv.to_workbook(a,r):Cg(t,a,r,i)}function LS(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return xd(e.file,ar.write(t,{type:Cr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return ar.write(t,e)}function j9(t,e){var r=La(e||{}),a=w9(t,r);return C9(a,r)}function C9(t,e){var r={},a=Cr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=a;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+e.type)}var n=t.FullPaths?ar.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(e.type=="binary"||e.type=="base64")return n;n=new Uint8Array(Dp(n))}return e.password&&typeof encrypt_agile<"u"?LS(encrypt_agile(n,e.password),e):e.type==="file"?xd(e.file,n):e.type=="string"?ya(n):n}function O9(t,e){var r=e||{},a=TP(t,r);return LS(a,r)}function ml(t,e,r){r||(r="");var a=r+t;switch(e.type){case"base64":return rd(xl(a));case"binary":return xl(a);case"string":return t;case"file":return xd(e.file,a,"utf8");case"buffer":return Cr?oc(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):ml(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function F9(t,e){switch(e.type){case"base64":return rd(t);case"binary":return t;case"string":return t;case"file":return xd(e.file,t,"binary");case"buffer":return Cr?oc(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function U1(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",a=0;a<t.length;++a)r+=String.fromCharCode(t[a]);return e.type=="base64"?rd(r):e.type=="string"?ya(r):r;case"file":return xd(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function DS(t,e){s2(),ED(t);var r=La(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=DS(t,r);return r.type="array",Dp(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=t.SheetNames.indexOf(r.sheet),!t.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ml(wP(t,r),r);case"slk":case"sylk":return ml(z3.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"htm":case"html":return ml(NS(t.Sheets[t.SheetNames[n]],r),r);case"txt":return F9(PS(t.Sheets[t.SheetNames[n]],r),r);case"csv":return ml(z2(t.Sheets[t.SheetNames[n]],r),r,"\uFEFF");case"dif":return ml(H3.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"dbf":return U1(Tv.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"prn":return ml(Uh.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"rtf":return ml(K3.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"eth":return ml(W3.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"fods":return ml(OS(t,r),r);case"wk1":return U1(Zu.sheet_to_wk1(t.Sheets[t.SheetNames[n]],r),r);case"wk3":return U1(Zu.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),U1(AS(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),O9(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return j9(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function R9(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function L9(t,e,r){var a={};return a.type="file",a.file=e,R9(a),DS(t,a)}function D9(t,e,r,a,n,i,o,c){var u=yn(r),h=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),v=!0,y=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:r,enumerable:!1})}catch{y.__rowNum__=r}else y.__rowNum__=r;if(!o||t[r])for(var g=e.s.c;g<=e.e.c;++g){var b=o?t[r][g]:t[a[g]+u];if(b===void 0||b.t===void 0){if(h===void 0)continue;i[g]!=null&&(y[i[g]]=h);continue}var w=b.v;switch(b.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(i[g]!=null){if(w==null)if(b.t=="e"&&w===null)y[i[g]]=null;else if(h!==void 0)y[i[g]]=h;else if(d&&w===null)y[i[g]]=null;else continue;else y[i[g]]=d&&(b.t!=="n"||b.t==="n"&&c.rawNumbers!==!1)?w:ic(b,w,c);w!=null&&(v=!1)}}return{row:y,isempty:v}}function Ep(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,i=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},d=h.range!=null?h.range:t["!ref"];switch(h.header===1?a=1:h.header==="A"?a=2:Array.isArray(h.header)?a=3:h.header==null&&(a=0),typeof d){case"string":u=Kr(d);break;case"number":u=Kr(t["!ref"]),u.s.r=d;break;default:u=d}a>0&&(n=0);var v=yn(u.s.r),y=[],g=[],b=0,w=0,E=Array.isArray(t),A=u.s.r,O=0,T={};E&&!t[A]&&(t[A]=[]);var R=h.skipHidden&&t["!cols"]||[],H=h.skipHidden&&t["!rows"]||[];for(O=u.s.c;O<=u.e.c;++O)if(!(R[O]||{}).hidden)switch(y[O]=Xa(O),r=E?t[A][O]:t[y[O]+v],a){case 1:i[O]=O-u.s.c;break;case 2:i[O]=y[O];break;case 3:i[O]=h.header[O-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=ic(r,null,h),w=T[o]||0,!w)T[o]=1;else{do c=o+"_"+w++;while(T[c]);T[o]=w,T[c]=1}i[O]=c}for(A=u.s.r+n;A<=u.e.r;++A)if(!(H[A]||{}).hidden){var z=D9(t,u,A,y,a,i,E,h);(z.isempty===!1||(a===1?h.blankrows!==!1:h.blankrows))&&(g[b++]=z.row)}return g.length=b,g}var Qw=/"/g;function P9(t,e,r,a,n,i,o,c){for(var u=!0,h=[],d="",v=yn(r),y=e.s.c;y<=e.e.c;++y)if(a[y]){var g=c.dense?(t[r]||[])[y]:t[a[y]+v];if(g==null)d="";else if(g.v!=null){u=!1,d=""+(c.rawNumbers&&g.t=="n"?g.v:ic(g,null,c));for(var b=0,w=0;b!==d.length;++b)if((w=d.charCodeAt(b))===n||w===i||w===34||c.forceQuotes){d='"'+d.replace(Qw,'""')+'"';break}d=="ID"&&(d='"ID"')}else g.f!=null&&!g.F?(u=!1,d="="+g.f,d.indexOf(",")>=0&&(d='"'+d.replace(Qw,'""')+'"')):d="";h.push(d)}return c.blankrows===!1&&u?null:h.join(o)}function z2(t,e){var r=[],a=e??{};if(t==null||t["!ref"]==null)return"";var n=Kr(t["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,u=c.charCodeAt(0),h=new RegExp((i=="|"?"\\|":i)+"+$"),d="",v=[];a.dense=Array.isArray(t);for(var y=a.skipHidden&&t["!cols"]||[],g=a.skipHidden&&t["!rows"]||[],b=n.s.c;b<=n.e.c;++b)(y[b]||{}).hidden||(v[b]=Xa(b));for(var w=0,E=n.s.r;E<=n.e.r;++E)(g[E]||{}).hidden||(d=P9(t,n,E,v,o,u,i,a),d!=null&&(a.strip&&(d=d.replace(h,"")),(d||a.blankrows!==!1)&&r.push((w++?c:"")+d)));return delete a.dense,r.join("")}function PS(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=z2(t,e);return r}function M9(t){var e="",r,a="";if(t==null||t["!ref"]==null)return[];var n=Kr(t["!ref"]),i="",o=[],c,u=[],h=Array.isArray(t);for(c=n.s.c;c<=n.e.c;++c)o[c]=Xa(c);for(var d=n.s.r;d<=n.e.r;++d)for(i=yn(d),c=n.s.c;c<=n.e.c;++c)if(e=o[c]+i,r=h?(t[d]||[])[c]:t[e],a="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;a=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}u[u.length]=e+"="+a}return u}function MS(t,e,r){var a=r||{},n=+!a.skipHeader,i=t||{},o=0,c=0;if(i&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var u=typeof a.origin=="string"?Ya(a.origin):a.origin;o=u.r,c=u.c}var h,d={s:{c:0,r:0},e:{c,r:o+e.length-1+n}};if(i["!ref"]){var v=Kr(i["!ref"]);d.e.c=Math.max(d.e.c,v.e.c),d.e.r=Math.max(d.e.r,v.e.r),o==-1&&(o=v.e.r+1,d.e.r=o+e.length-1+n)}else o==-1&&(o=0,d.e.r=e.length-1+n);var y=a.header||[],g=0;e.forEach(function(w,E){un(w).forEach(function(A){(g=y.indexOf(A))==-1&&(y[g=y.length]=A);var O=w[A],T="z",R="",H=hr({c:c+g,r:o+E+n});h=pd(i,H),O&&typeof O=="object"&&!(O instanceof Date)?i[H]=O:(typeof O=="number"?T="n":typeof O=="boolean"?T="b":typeof O=="string"?T="s":O instanceof Date?(T="d",a.cellDates||(T="n",O=zn(O)),R=a.dateNF||fr[14]):O===null&&a.nullError&&(T="e",O=0),h?(h.t=T,h.v=O,delete h.w,delete h.R,R&&(h.z=R)):i[H]=h={t:T,v:O},R&&(h.z=R))})}),d.e.c=Math.max(d.e.c,c+y.length-1);var b=yn(o);if(n)for(g=0;g<y.length;++g)i[Xa(g+c)+b]={t:"s",v:y[g]};return i["!ref"]=Er(d),i}function I9(t,e){return MS(null,t,e)}function pd(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var a=Ya(e);return t[a.r]||(t[a.r]=[]),t[a.r][a.c]||(t[a.r][a.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?pd(t,hr(e)):pd(t,hr({r:e,c:r||0}))}function B9(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function H2(){return{SheetNames:[],Sheets:{}}}function W2(t,e,r,a){var n=1;if(!r)for(;n<=65535&&t.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var o=i&&i[1]||r;for(++n;n<=65535&&t.SheetNames.indexOf(r=o+n)!=-1;++n);}if(_S(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function U9(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var a=B9(t,e);switch(t.Workbook.Sheets[a]||(t.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[a].Hidden=r}function q9(t,e){return t.z=e,t}function IS(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function z9(t,e,r){return IS(t,"#"+e,r)}function H9(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function W9(t,e,r,a){for(var n=typeof e!="string"?e:Kr(e),i=typeof e=="string"?e:Er(e),o=n.s.r;o<=n.e.r;++o)for(var c=n.s.c;c<=n.e.c;++c){var u=pd(t,o,c);u.t="n",u.F=i,delete u.v,o==n.s.r&&c==n.s.c&&(u.f=r,a&&(u.D=!0))}return t}var $c={encode_col:Xa,encode_row:yn,encode_cell:hr,encode_range:Er,decode_col:y2,decode_row:x2,split_cell:eT,decode_cell:Ya,decode_range:cs,format_cell:ic,sheet_add_aoa:f3,sheet_add_json:MS,sheet_add_dom:TS,aoa_to_sheet:Gh,json_to_sheet:I9,table_to_sheet:jS,table_to_book:KP,sheet_to_csv:z2,sheet_to_txt:PS,sheet_to_json:Ep,sheet_to_html:NS,sheet_to_formulae:M9,sheet_to_row_object_array:Ep,sheet_get_cell:pd,book_new:H2,book_append_sheet:W2,book_set_sheet_visibility:U9,cell_set_number_format:q9,cell_set_hyperlink:IS,cell_set_internal_link:z9,cell_add_comment:H9,sheet_set_array_formula:W9,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const V9="modulepreload",G9=function(t){return"/"+t},e5={},Og=function(e,r,a){let n=Promise.resolve();if(r&&r.length>0){let u=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");n=u(r.map(h=>{if(h=G9(h),h in e5)return;e5[h]=!0;const d=h.endsWith(".css"),v=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${v}`))return;const y=document.createElement("link");if(y.rel=d?"stylesheet":V9,d||(y.as="script"),y.crossOrigin="",y.href=h,c&&y.setAttribute("nonce",c),document.head.appendChild(y),d)return new Promise((g,b)=>{y.addEventListener("load",g),y.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return n.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})};function ua(t){"@babel/helpers - typeof";return ua=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ua(t)}var Wo=Uint8Array,Rs=Uint16Array,V2=Int32Array,G2=new Wo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$2=new Wo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),t5=new Wo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),BS=function(t,e){for(var r=new Rs(31),a=0;a<31;++a)r[a]=e+=1<<t[a-1];for(var n=new V2(r[30]),a=1;a<30;++a)for(var i=r[a];i<r[a+1];++i)n[i]=i-r[a]<<5|a;return{b:r,r:n}},US=BS(G2,2),$9=US.b,Rv=US.r;$9[28]=258,Rv[258]=28;var X9=BS($2,0),r5=X9.r,Lv=new Rs(32768);for(var Fa=0;Fa<32768;++Fa){var Vc=(Fa&43690)>>1|(Fa&21845)<<1;Vc=(Vc&52428)>>2|(Vc&13107)<<2,Vc=(Vc&61680)>>4|(Vc&3855)<<4,Lv[Fa]=((Vc&65280)>>8|(Vc&255)<<8)>>1}var K0=(function(t,e,r){for(var a=t.length,n=0,i=new Rs(e);n<a;++n)t[n]&&++i[t[n]-1];var o=new Rs(e);for(n=1;n<e;++n)o[n]=o[n-1]+i[n-1]<<1;var c;if(r){c=new Rs(1<<e);var u=15-e;for(n=0;n<a;++n)if(t[n])for(var h=n<<4|t[n],d=e-t[n],v=o[t[n]-1]++<<d,y=v|(1<<d)-1;v<=y;++v)c[Lv[v]>>u]=h}else for(c=new Rs(a),n=0;n<a;++n)t[n]&&(c[n]=Lv[o[t[n]-1]++]>>15-t[n]);return c}),lf=new Wo(288);for(var Fa=0;Fa<144;++Fa)lf[Fa]=8;for(var Fa=144;Fa<256;++Fa)lf[Fa]=9;for(var Fa=256;Fa<280;++Fa)lf[Fa]=7;for(var Fa=280;Fa<288;++Fa)lf[Fa]=8;var kp=new Wo(32);for(var Fa=0;Fa<32;++Fa)kp[Fa]=5;var Y9=K0(lf,9,0),K9=K0(kp,5,0),qS=function(t){return(t+7)/8|0},J9=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Wo(t.subarray(e,r))},Jl=function(t,e,r){r<<=e&7;var a=e/8|0;t[a]|=r,t[a+1]|=r>>8},L0=function(t,e,r){r<<=e&7;var a=e/8|0;t[a]|=r,t[a+1]|=r>>8,t[a+2]|=r>>16},Fg=function(t,e){for(var r=[],a=0;a<t.length;++a)t[a]&&r.push({s:a,f:t[a]});var n=r.length,i=r.slice();if(!n)return{t:HS,l:0};if(n==1){var o=new Wo(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(H,z){return H.f-z.f}),r.push({s:-1,f:25001});var c=r[0],u=r[1],h=0,d=1,v=2;for(r[0]={s:-1,f:c.f+u.f,l:c,r:u};d!=n-1;)c=r[r[h].f<r[v].f?h++:v++],u=r[h!=d&&r[h].f<r[v].f?h++:v++],r[d++]={s:-1,f:c.f+u.f,l:c,r:u};for(var y=i[0].s,a=1;a<n;++a)i[a].s>y&&(y=i[a].s);var g=new Rs(y+1),b=Dv(r[d-1],g,0);if(b>e){var a=0,w=0,E=b-e,A=1<<E;for(i.sort(function(z,F){return g[F.s]-g[z.s]||z.f-F.f});a<n;++a){var O=i[a].s;if(g[O]>e)w+=A-(1<<b-g[O]),g[O]=e;else break}for(w>>=E;w>0;){var T=i[a].s;g[T]<e?w-=1<<e-g[T]++-1:++a}for(;a>=0&&w;--a){var R=i[a].s;g[R]==e&&(--g[R],++w)}b=e}return{t:new Wo(g),l:b}},Dv=function(t,e,r){return t.s==-1?Math.max(Dv(t.l,e,r+1),Dv(t.r,e,r+1)):e[t.s]=r},a5=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Rs(++e),a=0,n=t[0],i=1,o=function(u){r[a++]=u},c=1;c<=e;++c)if(t[c]==n&&c!=e)++i;else{if(!n&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(n),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(n);i=1,n=t[c]}return{c:r.subarray(0,a),n:e}},D0=function(t,e){for(var r=0,a=0;a<e.length;++a)r+=t[a]*e[a];return r},zS=function(t,e,r){var a=r.length,n=qS(e+2);t[n]=a&255,t[n+1]=a>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var i=0;i<a;++i)t[n+i+4]=r[i];return(n+4+a)*8},n5=function(t,e,r,a,n,i,o,c,u,h,d){Jl(e,d++,r),++n[256];for(var v=Fg(n,15),y=v.t,g=v.l,b=Fg(i,15),w=b.t,E=b.l,A=a5(y),O=A.c,T=A.n,R=a5(w),H=R.c,z=R.n,F=new Rs(19),W=0;W<O.length;++W)++F[O[W]&31];for(var W=0;W<H.length;++W)++F[H[W]&31];for(var D=Fg(F,7),Y=D.t,I=D.l,L=19;L>4&&!Y[t5[L-1]];--L);var ee=h+5<<3,oe=D0(n,lf)+D0(i,kp)+o,ge=D0(n,y)+D0(i,w)+o+14+3*L+D0(F,Y)+2*F[16]+3*F[17]+7*F[18];if(u>=0&&ee<=oe&&ee<=ge)return zS(e,d,t.subarray(u,u+h));var ie,he,de,Z;if(Jl(e,d,1+(ge<oe)),d+=2,ge<oe){ie=K0(y,g,0),he=y,de=K0(w,E,0),Z=w;var Ne=K0(Y,I,0);Jl(e,d,T-257),Jl(e,d+5,z-1),Jl(e,d+10,L-4),d+=14;for(var W=0;W<L;++W)Jl(e,d+3*W,Y[t5[W]]);d+=3*L;for(var Q=[O,H],N=0;N<2;++N)for(var M=Q[N],W=0;W<M.length;++W){var B=M[W]&31;Jl(e,d,Ne[B]),d+=Y[B],B>15&&(Jl(e,d,M[W]>>5&127),d+=M[W]>>12)}}else ie=Y9,he=lf,de=K9,Z=kp;for(var W=0;W<c;++W){var q=a[W];if(q>255){var B=q>>18&31;L0(e,d,ie[B+257]),d+=he[B+257],B>7&&(Jl(e,d,q>>23&31),d+=G2[B]);var K=q&31;L0(e,d,de[K]),d+=Z[K],K>3&&(L0(e,d,q>>5&8191),d+=$2[K])}else L0(e,d,ie[q]),d+=he[q]}return L0(e,d,ie[256]),d+he[256]},Z9=new V2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),HS=new Wo(0),Q9=function(t,e,r,a,n,i){var o=i.z||t.length,c=new Wo(a+o+5*(1+Math.ceil(o/7e3))+n),u=c.subarray(a,c.length-n),h=i.l,d=(i.r||0)&7;if(e){d&&(u[0]=i.r>>3);for(var v=Z9[e-1],y=v>>13,g=v&8191,b=(1<<r)-1,w=i.p||new Rs(32768),E=i.h||new Rs(b+1),A=Math.ceil(r/3),O=2*A,T=function(Je){return(t[Je]^t[Je+1]<<A^t[Je+2]<<O)&b},R=new V2(25e3),H=new Rs(288),z=new Rs(32),F=0,W=0,D=i.i||0,Y=0,I=i.w||0,L=0;D+2<o;++D){var ee=T(D),oe=D&32767,ge=E[ee];if(w[oe]=ge,E[ee]=oe,I<=D){var ie=o-D;if((F>7e3||Y>24576)&&(ie>423||!h)){d=n5(t,u,0,R,H,z,W,Y,L,D-L,d),Y=F=W=0,L=D;for(var he=0;he<286;++he)H[he]=0;for(var he=0;he<30;++he)z[he]=0}var de=2,Z=0,Ne=g,Q=oe-ge&32767;if(ie>2&&ee==T(D-Q))for(var N=Math.min(y,ie)-1,M=Math.min(32767,D),B=Math.min(258,ie);Q<=M&&--Ne&&oe!=ge;){if(t[D+de]==t[D+de-Q]){for(var q=0;q<B&&t[D+q]==t[D+q-Q];++q);if(q>de){if(de=q,Z=Q,q>N)break;for(var K=Math.min(Q,q-2),se=0,he=0;he<K;++he){var me=D-Q+he&32767,we=w[me],Se=me-we&32767;Se>se&&(se=Se,ge=me)}}}oe=ge,ge=w[oe],Q+=oe-ge&32767}if(Z){R[Y++]=268435456|Rv[de]<<18|r5[Z];var Ee=Rv[de]&31,ae=r5[Z]&31;W+=G2[Ee]+$2[ae],++H[257+Ee],++z[ae],I=D+de,++F}else R[Y++]=t[D],++H[t[D]]}}for(D=Math.max(D,I);D<o;++D)R[Y++]=t[D],++H[t[D]];d=n5(t,u,h,R,H,z,W,Y,L,D-L,d),h||(i.r=d&7|u[d/8|0]<<3,d-=7,i.h=E,i.p=w,i.i=D,i.w=I)}else{for(var D=i.w||0;D<o+h;D+=65535){var rt=D+65535;rt>=o&&(u[d/8|0]=h,rt=o),d=zS(u,d+1,t.subarray(D,rt))}i.i=o}return J9(c,0,a+qS(d)+n)},WS=function(){var t=1,e=0;return{p:function(r){for(var a=t,n=e,i=r.length|0,o=0;o!=i;){for(var c=Math.min(o+2655,i);o<c;++o)n+=a+=r[o];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}t=a,e=n},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},eM=function(t,e,r,a,n){if(!n&&(n={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),o=new Wo(i.length+t.length);o.set(i),o.set(t,i.length),t=o,n.w=i.length}return Q9(t,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,a,n)},VS=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},tM=function(t,e){var r=e.level,a=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=a<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var n=WS();n.p(e.dictionary),VS(t,2,n.d())}};function Pv(t,e){e||(e={});var r=WS();r.p(t);var a=eM(t,e,e.dictionary?6:2,4);return tM(a,e),VS(a,a.length-4,r.d()),a}var rM=typeof TextDecoder<"u"&&new TextDecoder,aM=0;try{rM.decode(HS,{stream:!0}),aM=1}catch{}function nM(t){if(Array.isArray(t))return t}function iM(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var a,n,i,o,c=[],u=!0,h=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(u=(a=i.call(r)).done)&&(c.push(a.value),c.length!==e);u=!0);}catch(d){h=!0,n=d}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(h)throw n}}return c}}function i5(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}function sM(t,e){if(t){if(typeof t=="string")return i5(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i5(t,e):void 0}}function oM(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s5(t,e){return nM(t)||iM(t,e)||sM(t,e)||oM()}function o5(t,e="utf8"){return new TextDecoder(e).decode(t)}const lM=new TextEncoder;function cM(t){return lM.encode(t)}const uM=1024*8,fM=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),Rg={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class X2{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=uM,r={}){let a=!1;typeof e=="number"?e=new ArrayBuffer(e):(a=!0,this.lastWrittenByte=e.byteLength);const n=r.offset?r.offset>>>0:0,i=e.byteLength-n;let o=n;(ArrayBuffer.isView(e)||e instanceof X2)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+n),e=e.buffer),a?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=e,this.length=i,this.byteLength=i,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,i),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const a=(this.offset+e)*2,n=new Uint8Array(a);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const a=Rg[r].BYTES_PER_ELEMENT*e,n=this.byteOffset+this.offset,i=this.buffer.slice(n,n+a);if(this.littleEndian===fM&&r!=="uint8"&&r!=="int8"){const c=new Uint8Array(this.buffer.slice(n,n+a));c.reverse();const u=new Rg[r](c.buffer);return this.offset+=a,u.reverse(),u}const o=new Rg[r](i);return this.offset+=a,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let a=0;a<e;a++)r+=this.readChar();return r}readUtf8(e=1){return o5(this.readBytes(e))}decodeText(e=1,r="utf8"){return o5(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(cM(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Xh(t){let e=t.length;for(;--e>=0;)t[e]=0}const hM=3,dM=258,GS=29,pM=256,mM=pM+1+GS,$S=30,gM=512,vM=new Array((mM+2)*2);Xh(vM);const xM=new Array($S*2);Xh(xM);const yM=new Array(gM);Xh(yM);const _M=new Array(dM-hM+1);Xh(_M);const wM=new Array(GS);Xh(wM);const bM=new Array($S);Xh(bM);const SM=(t,e,r,a)=>{let n=t&65535|0,i=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do n=n+e[a++]|0,i=i+n|0;while(--o);n%=65521,i%=65521}return n|i<<16|0};var Mv=SM;const EM=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var a=0;a<8;a++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},kM=new Uint32Array(EM()),AM=(t,e,r,a)=>{const n=kM,i=a+r;t^=-1;for(let o=a;o<i;o++)t=t>>>8^n[(t^e[o])&255];return t^-1};var dl=AM,Iv={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},XS={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const NM=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var TM=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const a in r)NM(r,a)&&(t[a]=r[a])}}return t},jM=t=>{let e=0;for(let a=0,n=t.length;a<n;a++)e+=t[a].length;const r=new Uint8Array(e);for(let a=0,n=0,i=t.length;a<i;a++){let o=t[a];r.set(o,n),n+=o.length}return r},YS={assign:TM,flattenChunks:jM};let KS=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{KS=!1}const md=new Uint8Array(256);for(let t=0;t<256;t++)md[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;md[254]=md[254]=1;var CM=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,a,n,i,o=t.length,c=0;for(n=0;n<o;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<o&&(a=t.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),c+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(c),i=0,n=0;i<c;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<o&&(a=t.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),r<128?e[i++]=r:r<2048?(e[i++]=192|r>>>6,e[i++]=128|r&63):r<65536?(e[i++]=224|r>>>12,e[i++]=128|r>>>6&63,e[i++]=128|r&63):(e[i++]=240|r>>>18,e[i++]=128|r>>>12&63,e[i++]=128|r>>>6&63,e[i++]=128|r&63);return e};const OM=(t,e)=>{if(e<65534&&t.subarray&&KS)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let a=0;a<e;a++)r+=String.fromCharCode(t[a]);return r};var FM=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let a,n;const i=new Array(r*2);for(n=0,a=0;a<r;){let o=t[a++];if(o<128){i[n++]=o;continue}let c=md[o];if(c>4){i[n++]=65533,a+=c-1;continue}for(o&=c===2?31:c===3?15:7;c>1&&a<r;)o=o<<6|t[a++]&63,c--;if(c>1){i[n++]=65533;continue}o<65536?i[n++]=o:(o-=65536,i[n++]=55296|o>>10&1023,i[n++]=56320|o&1023)}return OM(i,n)},RM=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+md[t[r]]>e?r:e},Bv={string2buf:CM,buf2string:FM,utf8border:RM};function LM(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var DM=LM;const q1=16209,PM=16191;var MM=function(e,r){let a,n,i,o,c,u,h,d,v,y,g,b,w,E,A,O,T,R,H,z,F,W,D,Y;const I=e.state;a=e.next_in,D=e.input,n=a+(e.avail_in-5),i=e.next_out,Y=e.output,o=i-(r-e.avail_out),c=i+(e.avail_out-257),u=I.dmax,h=I.wsize,d=I.whave,v=I.wnext,y=I.window,g=I.hold,b=I.bits,w=I.lencode,E=I.distcode,A=(1<<I.lenbits)-1,O=(1<<I.distbits)-1;e:do{b<15&&(g+=D[a++]<<b,b+=8,g+=D[a++]<<b,b+=8),T=w[g&A];t:for(;;){if(R=T>>>24,g>>>=R,b-=R,R=T>>>16&255,R===0)Y[i++]=T&65535;else if(R&16){H=T&65535,R&=15,R&&(b<R&&(g+=D[a++]<<b,b+=8),H+=g&(1<<R)-1,g>>>=R,b-=R),b<15&&(g+=D[a++]<<b,b+=8,g+=D[a++]<<b,b+=8),T=E[g&O];r:for(;;){if(R=T>>>24,g>>>=R,b-=R,R=T>>>16&255,R&16){if(z=T&65535,R&=15,b<R&&(g+=D[a++]<<b,b+=8,b<R&&(g+=D[a++]<<b,b+=8)),z+=g&(1<<R)-1,z>u){e.msg="invalid distance too far back",I.mode=q1;break e}if(g>>>=R,b-=R,R=i-o,z>R){if(R=z-R,R>d&&I.sane){e.msg="invalid distance too far back",I.mode=q1;break e}if(F=0,W=y,v===0){if(F+=h-R,R<H){H-=R;do Y[i++]=y[F++];while(--R);F=i-z,W=Y}}else if(v<R){if(F+=h+v-R,R-=v,R<H){H-=R;do Y[i++]=y[F++];while(--R);if(F=0,v<H){R=v,H-=R;do Y[i++]=y[F++];while(--R);F=i-z,W=Y}}}else if(F+=v-R,R<H){H-=R;do Y[i++]=y[F++];while(--R);F=i-z,W=Y}for(;H>2;)Y[i++]=W[F++],Y[i++]=W[F++],Y[i++]=W[F++],H-=3;H&&(Y[i++]=W[F++],H>1&&(Y[i++]=W[F++]))}else{F=i-z;do Y[i++]=Y[F++],Y[i++]=Y[F++],Y[i++]=Y[F++],H-=3;while(H>2);H&&(Y[i++]=Y[F++],H>1&&(Y[i++]=Y[F++]))}}else if((R&64)===0){T=E[(T&65535)+(g&(1<<R)-1)];continue r}else{e.msg="invalid distance code",I.mode=q1;break e}break}}else if((R&64)===0){T=w[(T&65535)+(g&(1<<R)-1)];continue t}else if(R&32){I.mode=PM;break e}else{e.msg="invalid literal/length code",I.mode=q1;break e}break}}while(a<n&&i<c);H=b>>3,a-=H,b-=H<<3,g&=(1<<b)-1,e.next_in=a,e.next_out=i,e.avail_in=a<n?5+(n-a):5-(a-n),e.avail_out=i<c?257+(c-i):257-(i-c),I.hold=g,I.bits=b};const ph=15,l5=852,c5=592,u5=0,Lg=1,f5=2,IM=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),BM=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),UM=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),qM=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),zM=(t,e,r,a,n,i,o,c)=>{const u=c.bits;let h=0,d=0,v=0,y=0,g=0,b=0,w=0,E=0,A=0,O=0,T,R,H,z,F,W=null,D;const Y=new Uint16Array(ph+1),I=new Uint16Array(ph+1);let L=null,ee,oe,ge;for(h=0;h<=ph;h++)Y[h]=0;for(d=0;d<a;d++)Y[e[r+d]]++;for(g=u,y=ph;y>=1&&Y[y]===0;y--);if(g>y&&(g=y),y===0)return n[i++]=1<<24|64<<16|0,n[i++]=1<<24|64<<16|0,c.bits=1,0;for(v=1;v<y&&Y[v]===0;v++);for(g<v&&(g=v),E=1,h=1;h<=ph;h++)if(E<<=1,E-=Y[h],E<0)return-1;if(E>0&&(t===u5||y!==1))return-1;for(I[1]=0,h=1;h<ph;h++)I[h+1]=I[h]+Y[h];for(d=0;d<a;d++)e[r+d]!==0&&(o[I[e[r+d]]++]=d);if(t===u5?(W=L=o,D=20):t===Lg?(W=IM,L=BM,D=257):(W=UM,L=qM,D=0),O=0,d=0,h=v,F=i,b=g,w=0,H=-1,A=1<<g,z=A-1,t===Lg&&A>l5||t===f5&&A>c5)return 1;for(;;){ee=h-w,o[d]+1<D?(oe=0,ge=o[d]):o[d]>=D?(oe=L[o[d]-D],ge=W[o[d]-D]):(oe=96,ge=0),T=1<<h-w,R=1<<b,v=R;do R-=T,n[F+(O>>w)+R]=ee<<24|oe<<16|ge|0;while(R!==0);for(T=1<<h-1;O&T;)T>>=1;if(T!==0?(O&=T-1,O+=T):O=0,d++,--Y[h]===0){if(h===y)break;h=e[r+o[d]]}if(h>g&&(O&z)!==H){for(w===0&&(w=g),F+=v,b=h-w,E=1<<b;b+w<y&&(E-=Y[b+w],!(E<=0));)b++,E<<=1;if(A+=1<<b,t===Lg&&A>l5||t===f5&&A>c5)return 1;H=O&z,n[H]=g<<24|b<<16|F-i|0}}return O!==0&&(n[F+O]=h-w<<24|64<<16|0),c.bits=g,0};var J0=zM;const HM=0,JS=1,ZS=2,{Z_FINISH:h5,Z_BLOCK:WM,Z_TREES:z1,Z_OK:cf,Z_STREAM_END:VM,Z_NEED_DICT:GM,Z_STREAM_ERROR:so,Z_DATA_ERROR:QS,Z_MEM_ERROR:eE,Z_BUF_ERROR:$M,Z_DEFLATED:d5}=XS,Wp=16180,p5=16181,m5=16182,g5=16183,v5=16184,x5=16185,y5=16186,_5=16187,w5=16188,b5=16189,Ap=16190,Zl=16191,Dg=16192,S5=16193,Pg=16194,E5=16195,k5=16196,A5=16197,N5=16198,H1=16199,W1=16200,T5=16201,j5=16202,C5=16203,O5=16204,F5=16205,Mg=16206,R5=16207,L5=16208,Ua=16209,tE=16210,rE=16211,XM=852,YM=592,KM=15,JM=KM,D5=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function ZM(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const gf=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Wp||e.mode>rE?1:0},aE=t=>{if(gf(t))return so;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=Wp,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(XM),e.distcode=e.distdyn=new Int32Array(YM),e.sane=1,e.back=-1,cf},nE=t=>{if(gf(t))return so;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,aE(t)},iE=(t,e)=>{let r;if(gf(t))return so;const a=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?so:(a.window!==null&&a.wbits!==e&&(a.window=null),a.wrap=r,a.wbits=e,nE(t))},sE=(t,e)=>{if(!t)return so;const r=new ZM;t.state=r,r.strm=t,r.window=null,r.mode=Wp;const a=iE(t,e);return a!==cf&&(t.state=null),a},QM=t=>sE(t,JM);let P5=!0,Ig,Bg;const eI=t=>{if(P5){Ig=new Int32Array(512),Bg=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(J0(JS,t.lens,0,288,Ig,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;J0(ZS,t.lens,0,32,Bg,0,t.work,{bits:5}),P5=!1}t.lencode=Ig,t.lenbits=9,t.distcode=Bg,t.distbits=5},oE=(t,e,r,a)=>{let n;const i=t.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),a>=i.wsize?(i.window.set(e.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(n=i.wsize-i.wnext,n>a&&(n=a),i.window.set(e.subarray(r-a,r-a+n),i.wnext),a-=n,a?(i.window.set(e.subarray(r-a,r),0),i.wnext=a,i.whave=i.wsize):(i.wnext+=n,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=n))),0},tI=(t,e)=>{let r,a,n,i,o,c,u,h,d,v,y,g,b,w,E=0,A,O,T,R,H,z,F,W;const D=new Uint8Array(4);let Y,I;const L=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(gf(t)||!t.output||!t.input&&t.avail_in!==0)return so;r=t.state,r.mode===Zl&&(r.mode=Dg),o=t.next_out,n=t.output,u=t.avail_out,i=t.next_in,a=t.input,c=t.avail_in,h=r.hold,d=r.bits,v=c,y=u,W=cf;e:for(;;)switch(r.mode){case Wp:if(r.wrap===0){r.mode=Dg;break}for(;d<16;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}if(r.wrap&2&&h===35615){r.wbits===0&&(r.wbits=15),r.check=0,D[0]=h&255,D[1]=h>>>8&255,r.check=dl(r.check,D,2,0),h=0,d=0,r.mode=p5;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((h&255)<<8)+(h>>8))%31){t.msg="incorrect header check",r.mode=Ua;break}if((h&15)!==d5){t.msg="unknown compression method",r.mode=Ua;break}if(h>>>=4,d-=4,F=(h&15)+8,r.wbits===0&&(r.wbits=F),F>15||F>r.wbits){t.msg="invalid window size",r.mode=Ua;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=h&512?b5:Zl,h=0,d=0;break;case p5:for(;d<16;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}if(r.flags=h,(r.flags&255)!==d5){t.msg="unknown compression method",r.mode=Ua;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Ua;break}r.head&&(r.head.text=h>>8&1),r.flags&512&&r.wrap&4&&(D[0]=h&255,D[1]=h>>>8&255,r.check=dl(r.check,D,2,0)),h=0,d=0,r.mode=m5;case m5:for(;d<32;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}r.head&&(r.head.time=h),r.flags&512&&r.wrap&4&&(D[0]=h&255,D[1]=h>>>8&255,D[2]=h>>>16&255,D[3]=h>>>24&255,r.check=dl(r.check,D,4,0)),h=0,d=0,r.mode=g5;case g5:for(;d<16;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}r.head&&(r.head.xflags=h&255,r.head.os=h>>8),r.flags&512&&r.wrap&4&&(D[0]=h&255,D[1]=h>>>8&255,r.check=dl(r.check,D,2,0)),h=0,d=0,r.mode=v5;case v5:if(r.flags&1024){for(;d<16;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}r.length=h,r.head&&(r.head.extra_len=h),r.flags&512&&r.wrap&4&&(D[0]=h&255,D[1]=h>>>8&255,r.check=dl(r.check,D,2,0)),h=0,d=0}else r.head&&(r.head.extra=null);r.mode=x5;case x5:if(r.flags&1024&&(g=r.length,g>c&&(g=c),g&&(r.head&&(F=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(i,i+g),F)),r.flags&512&&r.wrap&4&&(r.check=dl(r.check,a,g,i)),c-=g,i+=g,r.length-=g),r.length))break e;r.length=0,r.mode=y5;case y5:if(r.flags&2048){if(c===0)break e;g=0;do F=a[i+g++],r.head&&F&&r.length<65536&&(r.head.name+=String.fromCharCode(F));while(F&&g<c);if(r.flags&512&&r.wrap&4&&(r.check=dl(r.check,a,g,i)),c-=g,i+=g,F)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=_5;case _5:if(r.flags&4096){if(c===0)break e;g=0;do F=a[i+g++],r.head&&F&&r.length<65536&&(r.head.comment+=String.fromCharCode(F));while(F&&g<c);if(r.flags&512&&r.wrap&4&&(r.check=dl(r.check,a,g,i)),c-=g,i+=g,F)break e}else r.head&&(r.head.comment=null);r.mode=w5;case w5:if(r.flags&512){for(;d<16;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}if(r.wrap&4&&h!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Ua;break}h=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Zl;break;case b5:for(;d<32;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}t.adler=r.check=D5(h),h=0,d=0,r.mode=Ap;case Ap:if(r.havedict===0)return t.next_out=o,t.avail_out=u,t.next_in=i,t.avail_in=c,r.hold=h,r.bits=d,GM;t.adler=r.check=1,r.mode=Zl;case Zl:if(e===WM||e===z1)break e;case Dg:if(r.last){h>>>=d&7,d-=d&7,r.mode=Mg;break}for(;d<3;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}switch(r.last=h&1,h>>>=1,d-=1,h&3){case 0:r.mode=S5;break;case 1:if(eI(r),r.mode=H1,e===z1){h>>>=2,d-=2;break e}break;case 2:r.mode=k5;break;case 3:t.msg="invalid block type",r.mode=Ua}h>>>=2,d-=2;break;case S5:for(h>>>=d&7,d-=d&7;d<32;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}if((h&65535)!==(h>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Ua;break}if(r.length=h&65535,h=0,d=0,r.mode=Pg,e===z1)break e;case Pg:r.mode=E5;case E5:if(g=r.length,g){if(g>c&&(g=c),g>u&&(g=u),g===0)break e;n.set(a.subarray(i,i+g),o),c-=g,i+=g,u-=g,o+=g,r.length-=g;break}r.mode=Zl;break;case k5:for(;d<14;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}if(r.nlen=(h&31)+257,h>>>=5,d-=5,r.ndist=(h&31)+1,h>>>=5,d-=5,r.ncode=(h&15)+4,h>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Ua;break}r.have=0,r.mode=A5;case A5:for(;r.have<r.ncode;){for(;d<3;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}r.lens[L[r.have++]]=h&7,h>>>=3,d-=3}for(;r.have<19;)r.lens[L[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Y={bits:r.lenbits},W=J0(HM,r.lens,0,19,r.lencode,0,r.work,Y),r.lenbits=Y.bits,W){t.msg="invalid code lengths set",r.mode=Ua;break}r.have=0,r.mode=N5;case N5:for(;r.have<r.nlen+r.ndist;){for(;E=r.lencode[h&(1<<r.lenbits)-1],A=E>>>24,O=E>>>16&255,T=E&65535,!(A<=d);){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}if(T<16)h>>>=A,d-=A,r.lens[r.have++]=T;else{if(T===16){for(I=A+2;d<I;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}if(h>>>=A,d-=A,r.have===0){t.msg="invalid bit length repeat",r.mode=Ua;break}F=r.lens[r.have-1],g=3+(h&3),h>>>=2,d-=2}else if(T===17){for(I=A+3;d<I;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}h>>>=A,d-=A,F=0,g=3+(h&7),h>>>=3,d-=3}else{for(I=A+7;d<I;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}h>>>=A,d-=A,F=0,g=11+(h&127),h>>>=7,d-=7}if(r.have+g>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Ua;break}for(;g--;)r.lens[r.have++]=F}}if(r.mode===Ua)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Ua;break}if(r.lenbits=9,Y={bits:r.lenbits},W=J0(JS,r.lens,0,r.nlen,r.lencode,0,r.work,Y),r.lenbits=Y.bits,W){t.msg="invalid literal/lengths set",r.mode=Ua;break}if(r.distbits=6,r.distcode=r.distdyn,Y={bits:r.distbits},W=J0(ZS,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Y),r.distbits=Y.bits,W){t.msg="invalid distances set",r.mode=Ua;break}if(r.mode=H1,e===z1)break e;case H1:r.mode=W1;case W1:if(c>=6&&u>=258){t.next_out=o,t.avail_out=u,t.next_in=i,t.avail_in=c,r.hold=h,r.bits=d,MM(t,y),o=t.next_out,n=t.output,u=t.avail_out,i=t.next_in,a=t.input,c=t.avail_in,h=r.hold,d=r.bits,r.mode===Zl&&(r.back=-1);break}for(r.back=0;E=r.lencode[h&(1<<r.lenbits)-1],A=E>>>24,O=E>>>16&255,T=E&65535,!(A<=d);){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}if(O&&(O&240)===0){for(R=A,H=O,z=T;E=r.lencode[z+((h&(1<<R+H)-1)>>R)],A=E>>>24,O=E>>>16&255,T=E&65535,!(R+A<=d);){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}h>>>=R,d-=R,r.back+=R}if(h>>>=A,d-=A,r.back+=A,r.length=T,O===0){r.mode=F5;break}if(O&32){r.back=-1,r.mode=Zl;break}if(O&64){t.msg="invalid literal/length code",r.mode=Ua;break}r.extra=O&15,r.mode=T5;case T5:if(r.extra){for(I=r.extra;d<I;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}r.length+=h&(1<<r.extra)-1,h>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=j5;case j5:for(;E=r.distcode[h&(1<<r.distbits)-1],A=E>>>24,O=E>>>16&255,T=E&65535,!(A<=d);){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}if((O&240)===0){for(R=A,H=O,z=T;E=r.distcode[z+((h&(1<<R+H)-1)>>R)],A=E>>>24,O=E>>>16&255,T=E&65535,!(R+A<=d);){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}h>>>=R,d-=R,r.back+=R}if(h>>>=A,d-=A,r.back+=A,O&64){t.msg="invalid distance code",r.mode=Ua;break}r.offset=T,r.extra=O&15,r.mode=C5;case C5:if(r.extra){for(I=r.extra;d<I;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}r.offset+=h&(1<<r.extra)-1,h>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Ua;break}r.mode=O5;case O5:if(u===0)break e;if(g=y-u,r.offset>g){if(g=r.offset-g,g>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Ua;break}g>r.wnext?(g-=r.wnext,b=r.wsize-g):b=r.wnext-g,g>r.length&&(g=r.length),w=r.window}else w=n,b=o-r.offset,g=r.length;g>u&&(g=u),u-=g,r.length-=g;do n[o++]=w[b++];while(--g);r.length===0&&(r.mode=W1);break;case F5:if(u===0)break e;n[o++]=r.length,u--,r.mode=W1;break;case Mg:if(r.wrap){for(;d<32;){if(c===0)break e;c--,h|=a[i++]<<d,d+=8}if(y-=u,t.total_out+=y,r.total+=y,r.wrap&4&&y&&(t.adler=r.check=r.flags?dl(r.check,n,y,o-y):Mv(r.check,n,y,o-y)),y=u,r.wrap&4&&(r.flags?h:D5(h))!==r.check){t.msg="incorrect data check",r.mode=Ua;break}h=0,d=0}r.mode=R5;case R5:if(r.wrap&&r.flags){for(;d<32;){if(c===0)break e;c--,h+=a[i++]<<d,d+=8}if(r.wrap&4&&h!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Ua;break}h=0,d=0}r.mode=L5;case L5:W=VM;break e;case Ua:W=QS;break e;case tE:return eE;case rE:default:return so}return t.next_out=o,t.avail_out=u,t.next_in=i,t.avail_in=c,r.hold=h,r.bits=d,(r.wsize||y!==t.avail_out&&r.mode<Ua&&(r.mode<Mg||e!==h5))&&oE(t,t.output,t.next_out,y-t.avail_out),v-=t.avail_in,y-=t.avail_out,t.total_in+=v,t.total_out+=y,r.total+=y,r.wrap&4&&y&&(t.adler=r.check=r.flags?dl(r.check,n,y,t.next_out-y):Mv(r.check,n,y,t.next_out-y)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Zl?128:0)+(r.mode===H1||r.mode===Pg?256:0),(v===0&&y===0||e===h5)&&W===cf&&(W=$M),W},rI=t=>{if(gf(t))return so;let e=t.state;return e.window&&(e.window=null),t.state=null,cf},aI=(t,e)=>{if(gf(t))return so;const r=t.state;return(r.wrap&2)===0?so:(r.head=e,e.done=!1,cf)},nI=(t,e)=>{const r=e.length;let a,n,i;return gf(t)||(a=t.state,a.wrap!==0&&a.mode!==Ap)?so:a.mode===Ap&&(n=1,n=Mv(n,e,r,0),n!==a.check)?QS:(i=oE(t,e,r,r),i?(a.mode=tE,eE):(a.havedict=1,cf))};var iI=nE,sI=iE,oI=aE,lI=QM,cI=sE,uI=tI,fI=rI,hI=aI,dI=nI,pI="pako inflate (from Nodeca project)",Ql={inflateReset:iI,inflateReset2:sI,inflateResetKeep:oI,inflateInit:lI,inflateInit2:cI,inflate:uI,inflateEnd:fI,inflateGetHeader:hI,inflateSetDictionary:dI,inflateInfo:pI};function mI(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gI=mI;const lE=Object.prototype.toString,{Z_NO_FLUSH:vI,Z_FINISH:xI,Z_OK:gd,Z_STREAM_END:Ug,Z_NEED_DICT:qg,Z_STREAM_ERROR:yI,Z_DATA_ERROR:M5,Z_MEM_ERROR:_I}=XS;function Ad(t){this.options=YS.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new DM,this.strm.avail_out=0;let r=Ql.inflateInit2(this.strm,e.windowBits);if(r!==gd)throw new Error(Iv[r]);if(this.header=new gI,Ql.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Bv.string2buf(e.dictionary):lE.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Ql.inflateSetDictionary(this.strm,e.dictionary),r!==gd)))throw new Error(Iv[r])}Ad.prototype.push=function(t,e){const r=this.strm,a=this.options.chunkSize,n=this.options.dictionary;let i,o,c;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?xI:vI,lE.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),i=Ql.inflate(r,o),i===qg&&n&&(i=Ql.inflateSetDictionary(r,n),i===gd?i=Ql.inflate(r,o):i===M5&&(i=qg));r.avail_in>0&&i===Ug&&r.state.wrap>0&&t[r.next_in]!==0;)Ql.inflateReset(r),i=Ql.inflate(r,o);switch(i){case yI:case M5:case qg:case _I:return this.onEnd(i),this.ended=!0,!1}if(c=r.avail_out,r.next_out&&(r.avail_out===0||i===Ug))if(this.options.to==="string"){let u=Bv.utf8border(r.output,r.next_out),h=r.next_out-u,d=Bv.buf2string(r.output,u);r.next_out=h,r.avail_out=a-h,h&&r.output.set(r.output.subarray(u,u+h),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===gd&&c===0)){if(i===Ug)return i=Ql.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Ad.prototype.onData=function(t){this.chunks.push(t)};Ad.prototype.onEnd=function(t){t===gd&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=YS.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function wI(t,e){const r=new Ad(e);if(r.push(t),r.err)throw r.msg||Iv[r.err];return r.result}var bI=Ad,SI=wI,EI={Inflate:bI,inflate:SI};const{Inflate:kI,inflate:AI}=EI;var I5=kI,NI=AI;const cE=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;cE[t]=e}const B5=4294967295;function TI(t,e,r){let a=t;for(let n=0;n<r;n++)a=cE[(a^e[n])&255]^a>>>8;return a}function jI(t,e){return(TI(B5,t,e)^B5)>>>0}function U5(t,e,r){const a=t.readUint32(),n=jI(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(n!==a)throw new Error(`CRC mismatch for chunk ${r}. Expected ${a}, found ${n}`)}function uE(t,e,r){for(let a=0;a<r;a++)e[a]=t[a]}function fE(t,e,r,a){let n=0;for(;n<a;n++)e[n]=t[n];for(;n<r;n++)e[n]=t[n]+e[n-a]&255}function hE(t,e,r,a){let n=0;if(r.length===0)for(;n<a;n++)e[n]=t[n];else for(;n<a;n++)e[n]=t[n]+r[n]&255}function dE(t,e,r,a,n){let i=0;if(r.length===0){for(;i<n;i++)e[i]=t[i];for(;i<a;i++)e[i]=t[i]+(e[i-n]>>1)&255}else{for(;i<n;i++)e[i]=t[i]+(r[i]>>1)&255;for(;i<a;i++)e[i]=t[i]+(e[i-n]+r[i]>>1)&255}}function pE(t,e,r,a,n){let i=0;if(r.length===0){for(;i<n;i++)e[i]=t[i];for(;i<a;i++)e[i]=t[i]+e[i-n]&255}else{for(;i<n;i++)e[i]=t[i]+r[i]&255;for(;i<a;i++)e[i]=t[i]+CI(e[i-n],r[i],r[i-n])&255}}function CI(t,e,r){const a=t+e-r,n=Math.abs(a-t),i=Math.abs(a-e),o=Math.abs(a-r);return n<=i&&n<=o?t:i<=o?e:r}function OI(t,e,r,a,n,i){switch(t){case 0:uE(e,r,n);break;case 1:fE(e,r,n,i);break;case 2:hE(e,r,a,n);break;case 3:dE(e,r,a,n,i);break;case 4:pE(e,r,a,n,i);break;default:throw new Error(`Unsupported filter: ${t}`)}}const FI=new Uint16Array([255]),RI=new Uint8Array(FI.buffer),LI=RI[0]===255;function DI(t){const{data:e,width:r,height:a,channels:n,depth:i}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],c=Math.ceil(i/8)*n,u=new Uint8Array(a*r*c);let h=0;for(let d=0;d<7;d++){const v=o[d],y=Math.ceil((r-v.x)/v.xStep),g=Math.ceil((a-v.y)/v.yStep);if(y<=0||g<=0)continue;const b=y*c,w=new Uint8Array(b);for(let E=0;E<g;E++){const A=e[h++],O=e.subarray(h,h+b);h+=b;const T=new Uint8Array(b);OI(A,O,T,w,b,c),w.set(T);for(let R=0;R<y;R++){const H=v.x+R*v.xStep,z=v.y+E*v.yStep;if(!(H>=r||z>=a))for(let F=0;F<c;F++)u[(z*r+H)*c+F]=T[R*c+F]}}}if(i===16){const d=new Uint16Array(u.buffer);if(LI)for(let v=0;v<d.length;v++)d[v]=PI(d[v]);return d}else return u}function PI(t){return(t&255)<<8|t>>8&255}const MI=new Uint16Array([255]),II=new Uint8Array(MI.buffer),BI=II[0]===255,UI=new Uint8Array(0);function q5(t){const{data:e,width:r,height:a,channels:n,depth:i}=t,o=Math.ceil(i/8)*n,c=Math.ceil(i/8*n*r),u=new Uint8Array(a*c);let h=UI,d=0,v,y;for(let g=0;g<a;g++){switch(v=e.subarray(d+1,d+1+c),y=u.subarray(g*c,(g+1)*c),e[d]){case 0:uE(v,y,c);break;case 1:fE(v,y,c,o);break;case 2:hE(v,y,h,c);break;case 3:dE(v,y,h,c,o);break;case 4:pE(v,y,h,c,o);break;default:throw new Error(`Unsupported filter: ${e[d]}`)}h=y,d+=c+1}if(i===16){const g=new Uint16Array(u.buffer);if(BI)for(let b=0;b<g.length;b++)g[b]=qI(g[b]);return g}else return u}function qI(t){return(t&255)<<8|t>>8&255}const Z1=Uint8Array.of(137,80,78,71,13,10,26,10);function z5(t){if(!zI(t.readBytes(Z1.length)))throw new Error("wrong PNG signature")}function zI(t){if(t.length<Z1.length)return!1;for(let e=0;e<Z1.length;e++)if(t[e]!==Z1[e])return!1;return!0}const HI="tEXt",WI=0,mE=new TextDecoder("latin1");function VI(t){if($I(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const GI=/^[\u0000-\u00FF]*$/;function $I(t){if(!GI.test(t))throw new Error("invalid latin1 text")}function XI(t,e,r){const a=gE(e);t[a]=YI(e,r-a.length-1)}function gE(t){for(t.mark();t.readByte()!==WI;);const e=t.offset;t.reset();const r=mE.decode(t.readBytes(e-t.offset-1));return t.skip(1),VI(r),r}function YI(t,e){return mE.decode(t.readBytes(e))}const As={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},zg={UNKNOWN:-1,DEFLATE:0},H5={UNKNOWN:-1,ADAPTIVE:0},Hg={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},V1={NONE:0,BACKGROUND:1,PREVIOUS:2},Wg={SOURCE:0,OVER:1};class KI extends X2{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,r={}){super(e);const{checkCrc:a=!1}=r;this._checkCrc=a,this._inflator=new I5,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=zg.UNKNOWN,this._filterMethod=H5.UNKNOWN,this._interlaceMethod=Hg.UNKNOWN,this._colorType=As.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(z5(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeChunk(e,r)}return this.decodeImage(),this._png}decodeApng(){for(z5(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(e,r)}return this.decodeApngImage(),this._apng}decodeChunk(e,r){const a=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case HI:XI(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-a!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?U5(this,e+4,r):this.skip(4)}decodeApngChunk(e,r){const a=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,r),this.offset=a+e;break}if(this.offset-a!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?U5(this,e+4,r):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=JI(this.readUint8());const r=this.readUint8();this._colorType=r;let a;switch(r){case As.GREYSCALE:a=1;break;case As.TRUECOLOUR:a=3;break;case As.INDEXED_COLOUR:a=1;break;case As.GREYSCALE_ALPHA:a=2;break;case As.TRUECOLOUR_ALPHA:a=4;break;case As.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==zg.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const r=e/3;this._hasPalette=!0;const a=[];this._palette=a;for(let n=0;n<r;n++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const r=e,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let r=e,a=this.offset+this.byteOffset;if(a+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case As.GREYSCALE:case As.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let r=0;r<e/2;r++)this._transparency[r]=this.readUint16();break}case As.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let r=0;for(;r<e;r++){const a=this.readByte();this._palette[r].push(a)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case As.UNKNOWN:case As.GREYSCALE_ALPHA:case As.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const r=gE(this),a=this.readUint8();if(a!==zg.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const n=this.readBytes(e-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:NI(n)}}decodepHYs(){const e=this.readUint32(),r=this.readUint32(),a=this.readByte();this._png.resolution={x:e,y:r,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const r={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(e);if(a){if(a.data=q5({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)r.data=a.data;else{const n=this._apng.frames.at(e-1);this.disposeFrame(a,n,r),this.addFrameDataToCanvas(r,a)}this._apng.frames.push(r)}}return this._apng}disposeFrame(e,r,a){switch(e.disposeOp){case V1.NONE:break;case V1.BACKGROUND:for(let n=0;n<this._png.height;n++)for(let i=0;i<this._png.width;i++){const o=(n*e.width+i)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[o+c]=0}break;case V1.PREVIOUS:a.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,r){const a=1<<this._png.depth,n=(i,o)=>{const c=((i+r.yOffset)*this._png.width+r.xOffset+o)*this._png.channels,u=(i*r.width+o)*this._png.channels;return{index:c,frameIndex:u}};switch(r.blendOp){case Wg.SOURCE:for(let i=0;i<r.height;i++)for(let o=0;o<r.width;o++){const{index:c,frameIndex:u}=n(i,o);for(let h=0;h<this._png.channels;h++)e.data[c+h]=r.data[u+h]}break;case Wg.OVER:for(let i=0;i<r.height;i++)for(let o=0;o<r.width;o++){const{index:c,frameIndex:u}=n(i,o);for(let h=0;h<this._png.channels;h++){const d=r.data[u+this._png.channels-1]/a,v=h%(this._png.channels-1)===0?1:r.data[u+h],y=Math.floor(d*v+(1-d)*e.data[c+h]);e.data[c+h]+=y}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==H5.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Hg.NO_INTERLACE)this._png.data=q5({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Hg.ADAM7)this._png.data=DI({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,r=this._frames.at(-1);r?r.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:V1.NONE,blendOp:Wg.SOURCE,data:e}),this._inflator=new I5,this._writingDataChunks=!1}}function JI(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var W5;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(W5||(W5={}));function ZI(t,e){return new KI(t,e).decode()}var gr=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Vg(){gr.console&&typeof gr.console.log=="function"&&gr.console.log.apply(gr.console,arguments)}var Sa={log:Vg,warn:function(t){gr.console&&(typeof gr.console.warn=="function"?gr.console.warn.apply(gr.console,arguments):Vg.call(null,arguments))},error:function(t){gr.console&&(typeof gr.console.error=="function"?gr.console.error.apply(gr.console,arguments):Vg(t))}};function Gg(t,e,r){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="blob",a.onload=function(){qu(a.response,e,r)},a.onerror=function(){Sa.error("could not download file")},a.send()}function V5(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function G1(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var qu=gr.saveAs||((typeof window>"u"?"undefined":ua(window))!=="object"||window!==gr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var a=gr.URL||gr.webkitURL,n=document.createElement("a");e=e||t.name||"download",n.download=e,n.rel="noopener",typeof t=="string"?(n.href=t,n.origin!==location.origin?V5(n.href)?Gg(t,e,r):G1(n,n.target="_blank"):G1(n)):(n.href=a.createObjectURL(t),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){G1(n)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(V5(t))Gg(t,e,r);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout(function(){G1(a)})}else navigator.msSaveOrOpenBlob((function(n,i){return i===void 0?i={autoBom:!1}:ua(i)!=="object"&&(Sa.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(t,r),e)}:function(t,e,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof t=="string")return Gg(t,e,r);var n=t.type==="application/octet-stream",i=/constructor/i.test(gr.HTMLElement)||gr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||n&&i)&&(typeof FileReader>"u"?"undefined":ua(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var d=c.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=d:location=d,a=null},c.readAsDataURL(t)}else{var u=gr.URL||gr.webkitURL,h=u.createObjectURL(t);a?a.location=h:location.href=h,a=null,setTimeout(function(){u.revokeObjectURL(h)},4e4)}});function vE(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,i=r[a].process,o=n.exec(t);o&&(e=i(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),u=this.g.toString(16),h=this.b.toString(16);return c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),h.length==1&&(h="0"+h),"#"+c+u+h}}var Q1=gr.atob.bind(gr),G5=gr.btoa.bind(gr);function $g(t,e){var r=t[0],a=t[1],n=t[2],i=t[3];r=wi(r,a,n,i,e[0],7,-680876936),i=wi(i,r,a,n,e[1],12,-389564586),n=wi(n,i,r,a,e[2],17,606105819),a=wi(a,n,i,r,e[3],22,-1044525330),r=wi(r,a,n,i,e[4],7,-176418897),i=wi(i,r,a,n,e[5],12,1200080426),n=wi(n,i,r,a,e[6],17,-1473231341),a=wi(a,n,i,r,e[7],22,-45705983),r=wi(r,a,n,i,e[8],7,1770035416),i=wi(i,r,a,n,e[9],12,-1958414417),n=wi(n,i,r,a,e[10],17,-42063),a=wi(a,n,i,r,e[11],22,-1990404162),r=wi(r,a,n,i,e[12],7,1804603682),i=wi(i,r,a,n,e[13],12,-40341101),n=wi(n,i,r,a,e[14],17,-1502002290),r=bi(r,a=wi(a,n,i,r,e[15],22,1236535329),n,i,e[1],5,-165796510),i=bi(i,r,a,n,e[6],9,-1069501632),n=bi(n,i,r,a,e[11],14,643717713),a=bi(a,n,i,r,e[0],20,-373897302),r=bi(r,a,n,i,e[5],5,-701558691),i=bi(i,r,a,n,e[10],9,38016083),n=bi(n,i,r,a,e[15],14,-660478335),a=bi(a,n,i,r,e[4],20,-405537848),r=bi(r,a,n,i,e[9],5,568446438),i=bi(i,r,a,n,e[14],9,-1019803690),n=bi(n,i,r,a,e[3],14,-187363961),a=bi(a,n,i,r,e[8],20,1163531501),r=bi(r,a,n,i,e[13],5,-1444681467),i=bi(i,r,a,n,e[2],9,-51403784),n=bi(n,i,r,a,e[7],14,1735328473),r=Si(r,a=bi(a,n,i,r,e[12],20,-1926607734),n,i,e[5],4,-378558),i=Si(i,r,a,n,e[8],11,-2022574463),n=Si(n,i,r,a,e[11],16,1839030562),a=Si(a,n,i,r,e[14],23,-35309556),r=Si(r,a,n,i,e[1],4,-1530992060),i=Si(i,r,a,n,e[4],11,1272893353),n=Si(n,i,r,a,e[7],16,-155497632),a=Si(a,n,i,r,e[10],23,-1094730640),r=Si(r,a,n,i,e[13],4,681279174),i=Si(i,r,a,n,e[0],11,-358537222),n=Si(n,i,r,a,e[3],16,-722521979),a=Si(a,n,i,r,e[6],23,76029189),r=Si(r,a,n,i,e[9],4,-640364487),i=Si(i,r,a,n,e[12],11,-421815835),n=Si(n,i,r,a,e[15],16,530742520),r=Ei(r,a=Si(a,n,i,r,e[2],23,-995338651),n,i,e[0],6,-198630844),i=Ei(i,r,a,n,e[7],10,1126891415),n=Ei(n,i,r,a,e[14],15,-1416354905),a=Ei(a,n,i,r,e[5],21,-57434055),r=Ei(r,a,n,i,e[12],6,1700485571),i=Ei(i,r,a,n,e[3],10,-1894986606),n=Ei(n,i,r,a,e[10],15,-1051523),a=Ei(a,n,i,r,e[1],21,-2054922799),r=Ei(r,a,n,i,e[8],6,1873313359),i=Ei(i,r,a,n,e[15],10,-30611744),n=Ei(n,i,r,a,e[6],15,-1560198380),a=Ei(a,n,i,r,e[13],21,1309151649),r=Ei(r,a,n,i,e[4],6,-145523070),i=Ei(i,r,a,n,e[11],10,-1120210379),n=Ei(n,i,r,a,e[2],15,718787259),a=Ei(a,n,i,r,e[9],21,-343485551),t[0]=Qc(r,t[0]),t[1]=Qc(a,t[1]),t[2]=Qc(n,t[2]),t[3]=Qc(i,t[3])}function Vp(t,e,r,a,n,i){return e=Qc(Qc(e,t),Qc(a,i)),Qc(e<<n|e>>>32-n,r)}function wi(t,e,r,a,n,i,o){return Vp(e&r|~e&a,t,e,n,i,o)}function bi(t,e,r,a,n,i,o){return Vp(e&a|r&~a,t,e,n,i,o)}function Si(t,e,r,a,n,i,o){return Vp(e^r^a,t,e,n,i,o)}function Ei(t,e,r,a,n,i,o){return Vp(r^(e|~a),t,e,n,i,o)}function xE(t){var e,r=t.length,a=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)$g(a,QI(t.substring(e-64,e)));t=t.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)n[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for($g(a,n),e=0;e<16;e++)n[e]=0;return n[14]=8*r,$g(a,n),a}function QI(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var $5="0123456789abcdef".split("");function eB(t){for(var e="",r=0;r<4;r++)e+=$5[t>>8*r+4&15]+$5[t>>8*r&15];return e}function tB(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Uv(t){return xE(t).map(tB).join("")}var rB=(function(t){for(var e=0;e<t.length;e++)t[e]=eB(t[e]);return t.join("")})(xE("hello"))!="5d41402abc4b2a76b9719d911017c592";function Qc(t,e){if(rB){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}function qv(t,e){var r,a,n,i;if(t!==r){for(var o=(n=t,i=1+(256/t.length|0),new Array(i+1).join(n)),c=[],u=0;u<256;u++)c[u]=u;var h=0;for(u=0;u<256;u++){var d=c[u];h=(h+d+o.charCodeAt(u))%256,c[u]=c[h],c[h]=d}r=t,a=c}else c=a;var v=e.length,y=0,g=0,b="";for(u=0;u<v;u++)g=(g+(d=c[y=(y+1)%256]))%256,c[y]=c[g],c[g]=d,o=c[(c[y]+c[g])%256],b+=String.fromCharCode(e.charCodeAt(u)^o);return b}var X5={print:4,modify:8,copy:16,"annot-forms":32};function _h(t,e,r,a){this.v=1,this.r=2;var n=192;t.forEach(function(c){if(X5.perm!==void 0)throw new Error("Invalid permission: "+c);n+=X5[c]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^n)),this.encryptionKey=Uv(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=qv(this.encryptionKey,this.padding)}function wh(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,a=0;a<r;a++){var n=t.charCodeAt(a);e+=n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?"#"+("0"+n.toString(16)).slice(-2):t[a]}return e}function Y5(t){if(ua(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var i=Math.random().toString(35);return e[r][i]=[a,!!n],i},this.unsubscribe=function(r){for(var a in e)if(e[a][r])return delete e[a][r],Object.keys(e[a]).length===0&&delete e[a],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var i in e[r]){var o=e[r][i];try{o[0].apply(t,a)}catch(c){gr.console&&Sa.error("jsPDF PubSub Error",c.message,c)}o[1]&&n.push(i)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Np(t){if(!(this instanceof Np))return new Np(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function yE(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Vu(t,e,r,a,n){if(!(this instanceof Vu))return new Vu(t,e,r,a,n);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,yE.call(this,a,n)}function Sh(t,e,r,a,n){if(!(this instanceof Sh))return new Sh(t,e,r,a,n);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,yE.call(this,a,n)}function Jt(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],i=arguments[3],o=[],c=1,u=16,h="S",d=null;ua(t=t||{})==="object"&&(r=t.orientation,a=t.unit||a,n=t.format||n,i=t.compress||t.compressPdf||i,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),c=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(u=t.floatPrecision),h=t.defaultPathOperation||"S"),o=t.filters||(i===!0?["FlateEncode"]:o),a=a||"mm",r=(""+(r||"P")).toLowerCase();var v=t.putOnlyUsedFonts||!1,y={},g={internal:{},__private__:{}};g.__private__.PubSub=Y5;var b="1.3",w=g.__private__.getPdfVersion=function(){return b};g.__private__.setPdfVersion=function(j){b=j};var E={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return E};var A=g.__private__.getPageFormat=function(j){return E[j]};n=n||"a4";var O="compat",T="advanced",R=O;function H(){this.saveGraphicsState(),V(new Kt(ct,0,0,-ct,0,go()*ct).toString()+" cm"),this.setFontSize(this.getFontSize()/ct),h="n",R=T}function z(){this.restoreGraphicsState(),h="S",R=O}var F=g.__private__.combineFontStyleAndFontWeight=function(j,G){if(j=="bold"&&G=="normal"||j=="bold"&&G==400||j=="normal"&&G=="italic"||j=="bold"&&G=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return G&&(j=G==400||G==="normal"?j==="italic"?"italic":"normal":G!=700&&G!=="bold"||j!=="normal"?(G==700?"bold":G)+""+j:"bold"),j};g.advancedAPI=function(j){var G=R===O;return G&&H.call(this),typeof j!="function"||(j(this),G&&z.call(this)),this},g.compatAPI=function(j){var G=R===T;return G&&z.call(this),typeof j!="function"||(j(this),G&&H.call(this)),this},g.isAdvancedAPI=function(){return R===T};var W,D=function(j){if(R!==T)throw new Error(j+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Y=g.roundToPrecision=g.__private__.roundToPrecision=function(j,G){var _e=e||G;if(isNaN(j)||isNaN(_e))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return j.toFixed(_e).replace(/0+$/,"")};W=g.hpf=g.__private__.hpf=typeof u=="number"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return Y(j,u)}:u==="smart"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return Y(j,j>-1&&j<1?16:5)}:function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return Y(j,16)};var I=g.f2=g.__private__.f2=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f2");return Y(j,2)},L=g.__private__.f3=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f3");return Y(j,3)},ee=g.scale=g.__private__.scale=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.scale");return R===O?j*ct:R===T?j:void 0},oe=function(j){return ee((function(G){return R===O?go()-G:R===T?G:void 0})(j))};g.__private__.setPrecision=g.setPrecision=function(j){typeof parseInt(j,10)=="number"&&(e=parseInt(j,10))};var ge,ie="00000000000000000000000000000000",he=g.__private__.getFileId=function(){return ie},de=g.__private__.setFileId=function(j){return ie=j!==void 0&&/^[a-fA-F0-9]{32}$/.test(j)?j.toUpperCase():ie.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(fn=new _h(d.userPermissions,d.userPassword,d.ownerPassword,ie)),ie};g.setFileId=function(j){return de(j),this},g.getFileId=function(){return he()};var Z=g.__private__.convertDateToPDFDate=function(j){var G=j.getTimezoneOffset(),_e=G<0?"+":"-",Te=Math.floor(Math.abs(G/60)),De=Math.abs(G%60),st=[_e,B(Te),"'",B(De),"'"].join("");return["D:",j.getFullYear(),B(j.getMonth()+1),B(j.getDate()),B(j.getHours()),B(j.getMinutes()),B(j.getSeconds()),st].join("")},Ne=g.__private__.convertPDFDateToDate=function(j){var G=parseInt(j.substr(2,4),10),_e=parseInt(j.substr(6,2),10)-1,Te=parseInt(j.substr(8,2),10),De=parseInt(j.substr(10,2),10),st=parseInt(j.substr(12,2),10),ht=parseInt(j.substr(14,2),10);return new Date(G,_e,Te,De,st,ht,0)},Q=g.__private__.setCreationDate=function(j){var G;if(j===void 0&&(j=new Date),j instanceof Date)G=Z(j);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(j))throw new Error("Invalid argument passed to jsPDF.setCreationDate");G=j}return ge=G},N=g.__private__.getCreationDate=function(j){var G=ge;return j==="jsDate"&&(G=Ne(ge)),G};g.setCreationDate=function(j){return Q(j),this},g.getCreationDate=function(j){return N(j)};var M,B=g.__private__.padd2=function(j){return("0"+parseInt(j)).slice(-2)},q=g.__private__.padd2Hex=function(j){return("00"+(j=j.toString())).substr(j.length)},K=0,se=[],me=[],we=0,Se=[],Ee=[],ae=!1,rt=me;g.__private__.setCustomOutputDestination=function(j){ae=!0,rt=j};var Je=function(j){ae||(rt=j)};g.__private__.resetCustomOutputDestination=function(){ae=!1,rt=me};var V=g.__private__.out=function(j){return j=j.toString(),we+=j.length+1,rt.push(j),rt},Ie=g.__private__.write=function(j){return V(arguments.length===1?j.toString():Array.prototype.join.call(arguments," "))},Le=g.__private__.getArrayBuffer=function(j){for(var G=j.length,_e=new ArrayBuffer(G),Te=new Uint8Array(_e);G--;)Te[G]=j.charCodeAt(G);return _e},gt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return gt};var et=t.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(j){return et=R===T?j/ct:j,this};var wt,vt=g.__private__.getFontSize=g.getFontSize=function(){return R===O?et:et*ct},Ct=t.R2L||!1;g.__private__.setR2L=g.setR2L=function(j){return Ct=j,this},g.__private__.getR2L=g.getR2L=function(){return Ct};var Et,It=g.__private__.setZoomMode=function(j){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(j))wt=j;else if(isNaN(j)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(j)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+j+'" is not recognized.');wt=j}else wt=parseInt(j,10)};g.__private__.getZoomMode=function(){return wt};var er,Vt=g.__private__.setPageMode=function(j){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(j)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+j+'" is not recognized.');Et=j};g.__private__.getPageMode=function(){return Et};var Oe=g.__private__.setLayoutMode=function(j){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(j)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+j+'" is not recognized.');er=j};g.__private__.getLayoutMode=function(){return er},g.__private__.setDisplayMode=g.setDisplayMode=function(j,G,_e){return It(j),Oe(G),Vt(_e),this};var Ye={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(j){if(Object.keys(Ye).indexOf(j)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ye[j]},g.__private__.getDocumentProperties=function(){return Ye},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(j){for(var G in Ye)Ye.hasOwnProperty(G)&&j[G]&&(Ye[G]=j[G]);return this},g.__private__.setDocumentProperty=function(j,G){if(Object.keys(Ye).indexOf(j)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ye[j]=G};var He,ct,mt,Ht,Rt,Wt={},nr={},br=[],Yt={},Wr={},Zt={},ir={},Vr=null,pr=0,Dt=[],Tr=new Y5(g),Qn=t.hotfixes||[],Ka={},_t={},Ja=[],Kt=function j(G,_e,Te,De,st,ht){if(!(this instanceof j))return new j(G,_e,Te,De,st,ht);isNaN(G)&&(G=1),isNaN(_e)&&(_e=0),isNaN(Te)&&(Te=0),isNaN(De)&&(De=1),isNaN(st)&&(st=0),isNaN(ht)&&(ht=0),this._matrix=[G,_e,Te,De,st,ht]};Object.defineProperty(Kt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(Kt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(Kt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(Kt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(Kt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(Kt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(Kt.prototype,"a",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(Kt.prototype,"b",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(Kt.prototype,"c",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(Kt.prototype,"d",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(Kt.prototype,"e",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(Kt.prototype,"f",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(Kt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Kt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Kt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Kt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Kt.prototype.join=function(j){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(W).join(j)},Kt.prototype.multiply=function(j){var G=j.sx*this.sx+j.shy*this.shx,_e=j.sx*this.shy+j.shy*this.sy,Te=j.shx*this.sx+j.sy*this.shx,De=j.shx*this.shy+j.sy*this.sy,st=j.tx*this.sx+j.ty*this.shx+this.tx,ht=j.tx*this.shy+j.ty*this.sy+this.ty;return new Kt(G,_e,Te,De,st,ht)},Kt.prototype.decompose=function(){var j=this.sx,G=this.shy,_e=this.shx,Te=this.sy,De=this.tx,st=this.ty,ht=Math.sqrt(j*j+G*G),Bt=(j/=ht)*_e+(G/=ht)*Te;_e-=j*Bt,Te-=G*Bt;var Gt=Math.sqrt(_e*_e+Te*Te);return Bt/=Gt,j*(Te/=Gt)<G*(_e/=Gt)&&(j=-j,G=-G,Bt=-Bt,ht=-ht),{scale:new Kt(ht,0,0,Gt,0,0),translate:new Kt(1,0,0,1,De,st),rotate:new Kt(j,G,-G,j,0,0),skew:new Kt(1,0,Bt,1,0,0)}},Kt.prototype.toString=function(j){return this.join(" ")},Kt.prototype.inversed=function(){var j=this.sx,G=this.shy,_e=this.shx,Te=this.sy,De=this.tx,st=this.ty,ht=1/(j*Te-G*_e),Bt=Te*ht,Gt=-G*ht,cr=-_e*ht,vr=j*ht;return new Kt(Bt,Gt,cr,vr,-Bt*De-cr*st,-Gt*De-vr*st)},Kt.prototype.applyToPoint=function(j){var G=j.x*this.sx+j.y*this.shx+this.tx,_e=j.x*this.shy+j.y*this.sy+this.ty;return new Wi(G,_e)},Kt.prototype.applyToRectangle=function(j){var G=this.applyToPoint(j),_e=this.applyToPoint(new Wi(j.x+j.w,j.y+j.h));return new uo(G.x,G.y,_e.x-G.x,_e.y-G.y)},Kt.prototype.clone=function(){var j=this.sx,G=this.shy,_e=this.shx,Te=this.sy,De=this.tx,st=this.ty;return new Kt(j,G,_e,Te,De,st)},g.Matrix=Kt;var fs=g.matrixMult=function(j,G){return G.multiply(j)},zi=new Kt(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=zi;var On=function(j,G){if(!Wr[j]){var _e=(G instanceof Vu?"Sh":"P")+(Object.keys(Yt).length+1).toString(10);G.id=_e,Wr[j]=_e,Yt[_e]=G,Tr.publish("addPattern",G)}};g.ShadingPattern=Vu,g.TilingPattern=Sh,g.addShadingPattern=function(j,G){return D("addShadingPattern()"),On(j,G),this},g.beginTilingPattern=function(j){D("beginTilingPattern()"),Tl(j.boundingBox[0],j.boundingBox[1],j.boundingBox[2]-j.boundingBox[0],j.boundingBox[3]-j.boundingBox[1],j.matrix)},g.endTilingPattern=function(j,G){D("endTilingPattern()"),G.stream=Ee[M].join(`
`),On(j,G),Tr.publish("endTilingPattern",G),Ja.pop().restore()};var ei,ha=g.__private__.newObject=function(){var j=Da();return J(j,!0),j},Da=g.__private__.newObjectDeferred=function(){return K++,se[K]=function(){return we},K},J=function(j,G){return G=typeof G=="boolean"&&G,se[j]=we,G&&V(j+" 0 obj"),j},ye=g.__private__.newAdditionalObject=function(){var j={objId:Da(),content:""};return Se.push(j),j},ce=Da(),ue=Da(),pe=g.__private__.decodeColorString=function(j){var G=j.split(" ");if(G.length!==2||G[1]!=="g"&&G[1]!=="G")G.length!==5||G[4]!=="k"&&G[4]!=="K"||(G=[(1-G[0])*(1-G[3]),(1-G[1])*(1-G[3]),(1-G[2])*(1-G[3]),"r"]);else{var _e=parseFloat(G[0]);G=[_e,_e,_e,"r"]}for(var Te="#",De=0;De<3;De++)Te+=("0"+Math.floor(255*parseFloat(G[De])).toString(16)).slice(-2);return Te},be=g.__private__.encodeColorString=function(j){var G;typeof j=="string"&&(j={ch1:j});var _e=j.ch1,Te=j.ch2,De=j.ch3,st=j.ch4,ht=j.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof _e=="string"&&_e.charAt(0)!=="#"){var Bt=new vE(_e);if(Bt.ok)_e=Bt.toHex();else if(!/^\d*\.?\d*$/.test(_e))throw new Error('Invalid color "'+_e+'" passed to jsPDF.encodeColorString.')}if(typeof _e=="string"&&/^#[0-9A-Fa-f]{3}$/.test(_e)&&(_e="#"+_e[1]+_e[1]+_e[2]+_e[2]+_e[3]+_e[3]),typeof _e=="string"&&/^#[0-9A-Fa-f]{6}$/.test(_e)){var Gt=parseInt(_e.substr(1),16);_e=Gt>>16&255,Te=Gt>>8&255,De=255&Gt}if(Te===void 0||st===void 0&&_e===Te&&Te===De)G=typeof _e=="string"?_e+" "+ht[0]:j.precision===2?I(_e/255)+" "+ht[0]:L(_e/255)+" "+ht[0];else if(st===void 0||ua(st)==="object"){if(st&&!isNaN(st.a)&&st.a===0)return["1.","1.","1.",ht[1]].join(" ");G=typeof _e=="string"?[_e,Te,De,ht[1]].join(" "):j.precision===2?[I(_e/255),I(Te/255),I(De/255),ht[1]].join(" "):[L(_e/255),L(Te/255),L(De/255),ht[1]].join(" ")}else G=typeof _e=="string"?[_e,Te,De,st,ht[2]].join(" "):j.precision===2?[I(_e),I(Te),I(De),I(st),ht[2]].join(" "):[L(_e),L(Te),L(De),L(st),ht[2]].join(" ");return G},Be=g.__private__.getFilters=function(){return o},Qe=g.__private__.putStream=function(j){var G=(j=j||{}).data||"",_e=j.filters||Be(),Te=j.alreadyAppliedFilters||[],De=j.addLength1||!1,st=G.length,ht=j.objectId,Bt=function(hn){return hn};if(d!==null&&ht===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Bt=fn.encryptor(ht,0));var Gt={};_e===!0&&(_e=["FlateEncode"]);var cr=j.additionalKeyValues||[],vr=(Gt=Jt.API.processDataByFilters!==void 0?Jt.API.processDataByFilters(G,_e):{data:G,reverseChain:[]}).reverseChain+(Array.isArray(Te)?Te.join(" "):Te.toString());if(Gt.data.length!==0&&(cr.push({key:"Length",value:Gt.data.length}),De===!0&&cr.push({key:"Length1",value:st})),vr.length!=0)if(vr.split("/").length-1==1)cr.push({key:"Filter",value:vr});else{cr.push({key:"Filter",value:"["+vr+"]"});for(var Ir=0;Ir<cr.length;Ir+=1)if(cr[Ir].key==="DecodeParms"){for(var Aa=[],qa=0;qa<Gt.reverseChain.split("/").length-1;qa+=1)Aa.push("null");Aa.push(cr[Ir].value),cr[Ir].value="["+Aa.join(" ")+"]"}}V("<<");for(var da=0;da<cr.length;da++)V("/"+cr[da].key+" "+cr[da].value);V(">>"),Gt.data.length!==0&&(V("stream"),V(Bt(Gt.data)),V("endstream"))},qe=g.__private__.putPage=function(j){var G=j.number,_e=j.data,Te=j.objId,De=j.contentsObjId;J(Te,!0),V("<</Type /Page"),V("/Parent "+j.rootDictionaryObjId+" 0 R"),V("/Resources "+j.resourceDictionaryObjId+" 0 R"),V("/MediaBox ["+parseFloat(W(j.mediaBox.bottomLeftX))+" "+parseFloat(W(j.mediaBox.bottomLeftY))+" "+W(j.mediaBox.topRightX)+" "+W(j.mediaBox.topRightY)+"]"),j.cropBox!==null&&V("/CropBox ["+W(j.cropBox.bottomLeftX)+" "+W(j.cropBox.bottomLeftY)+" "+W(j.cropBox.topRightX)+" "+W(j.cropBox.topRightY)+"]"),j.bleedBox!==null&&V("/BleedBox ["+W(j.bleedBox.bottomLeftX)+" "+W(j.bleedBox.bottomLeftY)+" "+W(j.bleedBox.topRightX)+" "+W(j.bleedBox.topRightY)+"]"),j.trimBox!==null&&V("/TrimBox ["+W(j.trimBox.bottomLeftX)+" "+W(j.trimBox.bottomLeftY)+" "+W(j.trimBox.topRightX)+" "+W(j.trimBox.topRightY)+"]"),j.artBox!==null&&V("/ArtBox ["+W(j.artBox.bottomLeftX)+" "+W(j.artBox.bottomLeftY)+" "+W(j.artBox.topRightX)+" "+W(j.artBox.topRightY)+"]"),typeof j.userUnit=="number"&&j.userUnit!==1&&V("/UserUnit "+j.userUnit),Tr.publish("putPage",{objId:Te,pageContext:Dt[G],pageNumber:G,page:_e}),V("/Contents "+De+" 0 R"),V(">>"),V("endobj");var st=_e.join(`
`);return R===T&&(st+=`
Q`),J(De,!0),Qe({data:st,filters:Be(),objectId:De}),V("endobj"),Te},ze=g.__private__.putPages=function(){var j,G,_e=[];for(j=1;j<=pr;j++)Dt[j].objId=Da(),Dt[j].contentsObjId=Da();for(j=1;j<=pr;j++)_e.push(qe({number:j,data:Ee[j],objId:Dt[j].objId,contentsObjId:Dt[j].contentsObjId,mediaBox:Dt[j].mediaBox,cropBox:Dt[j].cropBox,bleedBox:Dt[j].bleedBox,trimBox:Dt[j].trimBox,artBox:Dt[j].artBox,userUnit:Dt[j].userUnit,rootDictionaryObjId:ce,resourceDictionaryObjId:ue}));J(ce,!0),V("<</Type /Pages");var Te="/Kids [";for(G=0;G<pr;G++)Te+=_e[G]+" 0 R ";V(Te+"]"),V("/Count "+pr),V(">>"),V("endobj"),Tr.publish("postPutPages")},Ve=function(j){Tr.publish("putFont",{font:j,out:V,newObject:ha,putStream:Qe}),j.isAlreadyPutted!==!0&&(j.objectNumber=ha(),V("<<"),V("/Type /Font"),V("/BaseFont /"+wh(j.postScriptName)),V("/Subtype /Type1"),typeof j.encoding=="string"&&V("/Encoding /"+j.encoding),V("/FirstChar 32"),V("/LastChar 255"),V(">>"),V("endobj"))},pt=function(j){j.objectNumber=ha();var G=[];G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Form"}),G.push({key:"BBox",value:"["+[W(j.x),W(j.y),W(j.x+j.width),W(j.y+j.height)].join(" ")+"]"}),G.push({key:"Matrix",value:"["+j.matrix.toString()+"]"});var _e=j.pages[1].join(`
`);Qe({data:_e,additionalKeyValues:G,objectId:j.objectNumber}),V("endobj")},bt=function(j,G){G||(G=21);var _e=ha(),Te=(function(ht,Bt){var Gt,cr=[],vr=1/(Bt-1);for(Gt=0;Gt<1;Gt+=vr)cr.push(Gt);if(cr.push(1),ht[0].offset!=0){var Ir={offset:0,color:ht[0].color};ht.unshift(Ir)}if(ht[ht.length-1].offset!=1){var Aa={offset:1,color:ht[ht.length-1].color};ht.push(Aa)}for(var qa="",da=0,hn=0;hn<cr.length;hn++){for(Gt=cr[hn];Gt>ht[da+1].offset;)da++;var Qa=ht[da].offset,Rn=(Gt-Qa)/(ht[da+1].offset-Qa),vo=ht[da].color,vs=ht[da+1].color;qa+=q(Math.round((1-Rn)*vo[0]+Rn*vs[0]).toString(16))+q(Math.round((1-Rn)*vo[1]+Rn*vs[1]).toString(16))+q(Math.round((1-Rn)*vo[2]+Rn*vs[2]).toString(16))}return qa.trim()})(j.colors,G),De=[];De.push({key:"FunctionType",value:"0"}),De.push({key:"Domain",value:"[0.0 1.0]"}),De.push({key:"Size",value:"["+G+"]"}),De.push({key:"BitsPerSample",value:"8"}),De.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),De.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Qe({data:Te,additionalKeyValues:De,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:_e}),V("endobj"),j.objectNumber=ha(),V("<< /ShadingType "+j.type),V("/ColorSpace /DeviceRGB");var st="/Coords ["+W(parseFloat(j.coords[0]))+" "+W(parseFloat(j.coords[1]))+" ";j.type===2?st+=W(parseFloat(j.coords[2]))+" "+W(parseFloat(j.coords[3])):st+=W(parseFloat(j.coords[2]))+" "+W(parseFloat(j.coords[3]))+" "+W(parseFloat(j.coords[4]))+" "+W(parseFloat(j.coords[5])),V(st+="]"),j.matrix&&V("/Matrix ["+j.matrix.toString()+"]"),V("/Function "+_e+" 0 R"),V("/Extend [true true]"),V(">>"),V("endobj")},Tt=function(j,G){var _e=Da(),Te=ha();G.push({resourcesOid:_e,objectOid:Te}),j.objectNumber=Te;var De=[];De.push({key:"Type",value:"/Pattern"}),De.push({key:"PatternType",value:"1"}),De.push({key:"PaintType",value:"1"}),De.push({key:"TilingType",value:"1"}),De.push({key:"BBox",value:"["+j.boundingBox.map(W).join(" ")+"]"}),De.push({key:"XStep",value:W(j.xStep)}),De.push({key:"YStep",value:W(j.yStep)}),De.push({key:"Resources",value:_e+" 0 R"}),j.matrix&&De.push({key:"Matrix",value:"["+j.matrix.toString()+"]"}),Qe({data:j.stream,additionalKeyValues:De,objectId:j.objectNumber}),V("endobj")},yt=function(j){for(var G in j.objectNumber=ha(),V("<<"),j)switch(G){case"opacity":V("/ca "+I(j[G]));break;case"stroke-opacity":V("/CA "+I(j[G]))}V(">>"),V("endobj")},kt=function(j){J(j.resourcesOid,!0),V("<<"),V("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var G in V("/Font <<"),Wt)Wt.hasOwnProperty(G)&&(v===!1||v===!0&&y.hasOwnProperty(G))&&V("/"+G+" "+Wt[G].objectNumber+" 0 R");V(">>")})(),(function(){if(Object.keys(Yt).length>0){for(var G in V("/Shading <<"),Yt)Yt.hasOwnProperty(G)&&Yt[G]instanceof Vu&&Yt[G].objectNumber>=0&&V("/"+G+" "+Yt[G].objectNumber+" 0 R");Tr.publish("putShadingPatternDict"),V(">>")}})(),(function(G){if(Object.keys(Yt).length>0){for(var _e in V("/Pattern <<"),Yt)Yt.hasOwnProperty(_e)&&Yt[_e]instanceof g.TilingPattern&&Yt[_e].objectNumber>=0&&Yt[_e].objectNumber<G&&V("/"+_e+" "+Yt[_e].objectNumber+" 0 R");Tr.publish("putTilingPatternDict"),V(">>")}})(j.objectOid),(function(){if(Object.keys(Zt).length>0){var G;for(G in V("/ExtGState <<"),Zt)Zt.hasOwnProperty(G)&&Zt[G].objectNumber>=0&&V("/"+G+" "+Zt[G].objectNumber+" 0 R");Tr.publish("putGStateDict"),V(">>")}})(),(function(){for(var G in V("/XObject <<"),Ka)Ka.hasOwnProperty(G)&&Ka[G].objectNumber>=0&&V("/"+G+" "+Ka[G].objectNumber+" 0 R");Tr.publish("putXobjectDict"),V(">>")})(),V(">>"),V("endobj")},Lt=function(j){nr[j.fontName]=nr[j.fontName]||{},nr[j.fontName][j.fontStyle]=j.id},ea=function(j,G,_e,Te,De){var st={id:"F"+(Object.keys(Wt).length+1).toString(10),postScriptName:j,fontName:G,fontStyle:_e,encoding:Te,isStandardFont:De||!1,metadata:{}};return Tr.publish("addFont",{font:st,instance:this}),Wt[st.id]=st,Lt(st),st.id},jr=g.__private__.pdfEscape=g.pdfEscape=function(j,G){return(function(_e,Te){var De,st,ht,Bt,Gt,cr,vr,Ir,Aa;if(ht=(Te=Te||{}).sourceEncoding||"Unicode",Gt=Te.outputEncoding,(Te.autoencode||Gt)&&Wt[He].metadata&&Wt[He].metadata[ht]&&Wt[He].metadata[ht].encoding&&(Bt=Wt[He].metadata[ht].encoding,!Gt&&Wt[He].encoding&&(Gt=Wt[He].encoding),!Gt&&Bt.codePages&&(Gt=Bt.codePages[0]),typeof Gt=="string"&&(Gt=Bt[Gt]),Gt)){for(vr=!1,cr=[],De=0,st=_e.length;De<st;De++)(Ir=Gt[_e.charCodeAt(De)])?cr.push(String.fromCharCode(Ir)):cr.push(_e[De]),cr[De].charCodeAt(0)>>8&&(vr=!0);_e=cr.join("")}for(De=_e.length;vr===void 0&&De!==0;)_e.charCodeAt(De-1)>>8&&(vr=!0),De--;if(!vr)return _e;for(cr=Te.noBOM?[]:[254,255],De=0,st=_e.length;De<st;De++){if((Aa=(Ir=_e.charCodeAt(De))>>8)>>8)throw new Error("Character at position "+De+" of string '"+_e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");cr.push(Aa),cr.push(Ir-(Aa<<8))}return String.fromCharCode.apply(void 0,cr)})(j,G).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},na=g.__private__.beginPage=function(j){Ee[++pr]=[],Dt[pr]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(j[0]),topRightY:Number(j[1])}},ds(pr),Je(Ee[M])},ti=function(j,G){var _e,Te,De;switch(r=G||r,typeof j=="string"&&(_e=A(j.toLowerCase()),Array.isArray(_e)&&(Te=_e[0],De=_e[1])),Array.isArray(j)&&(Te=j[0]*ct,De=j[1]*ct),isNaN(Te)&&(Te=n[0],De=n[1]),(Te>14400||De>14400)&&(Sa.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Te=Math.min(14400,Te),De=Math.min(14400,De)),n=[Te,De],r.substr(0,1)){case"l":De>Te&&(n=[De,Te]);break;case"p":Te>De&&(n=[De,Te])}na(n),sr(kl),V(Li),hc!==0&&V(hc+" J"),wn!==0&&V(wn+" j"),Tr.publish("addPage",{pageNumber:pr})},hs=function(j){j>0&&j<=pr&&(Ee.splice(j,1),Dt.splice(j,1),pr--,M>pr&&(M=pr),this.setPage(M))},ds=function(j){j>0&&j<=pr&&(M=j)},Fi=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return Ee.length-1},$o=function(j,G,_e){var Te,De=void 0;return _e=_e||{},j=j!==void 0?j:Wt[He].fontName,G=G!==void 0?G:Wt[He].fontStyle,Te=j.toLowerCase(),nr[Te]!==void 0&&nr[Te][G]!==void 0?De=nr[Te][G]:nr[j]!==void 0&&nr[j][G]!==void 0?De=nr[j][G]:_e.disableWarning===!1&&Sa.warn("Unable to look up font label for font '"+j+"', '"+G+"'. Refer to getFontList() for available fonts."),De||_e.noFallback||(De=nr.times[G])==null&&(De=nr.times.normal),De},ka=g.__private__.putInfo=function(){var j=ha(),G=function(Te){return Te};for(var _e in d!==null&&(G=fn.encryptor(j,0)),V("<<"),V("/Producer ("+jr(G("jsPDF "+Jt.version))+")"),Ye)Ye.hasOwnProperty(_e)&&Ye[_e]&&V("/"+_e.substr(0,1).toUpperCase()+_e.substr(1)+" ("+jr(G(Ye[_e]))+")");V("/CreationDate ("+jr(G(ge))+")"),V(">>"),V("endobj")},lo=g.__private__.putCatalog=function(j){var G=(j=j||{}).rootDictionaryObjId||ce;switch(ha(),V("<<"),V("/Type /Catalog"),V("/Pages "+G+" 0 R"),wt||(wt="fullwidth"),wt){case"fullwidth":V("/OpenAction [3 0 R /FitH null]");break;case"fullheight":V("/OpenAction [3 0 R /FitV null]");break;case"fullpage":V("/OpenAction [3 0 R /Fit]");break;case"original":V("/OpenAction [3 0 R /XYZ null null 1]");break;default:var _e=""+wt;_e.substr(_e.length-1)==="%"&&(wt=parseInt(wt)/100),typeof wt=="number"&&V("/OpenAction [3 0 R /XYZ null null "+I(wt)+"]")}switch(er||(er="continuous"),er){case"continuous":V("/PageLayout /OneColumn");break;case"single":V("/PageLayout /SinglePage");break;case"two":case"twoleft":V("/PageLayout /TwoColumnLeft");break;case"tworight":V("/PageLayout /TwoColumnRight")}Et&&V("/PageMode /"+Et),Tr.publish("putCatalog"),V(">>"),V("endobj")},ps=g.__private__.putTrailer=function(){V("trailer"),V("<<"),V("/Size "+(K+1)),V("/Root "+K+" 0 R"),V("/Info "+(K-1)+" 0 R"),d!==null&&V("/Encrypt "+fn.oid+" 0 R"),V("/ID [ <"+ie+"> <"+ie+"> ]"),V(">>")},Gr=g.__private__.putHeader=function(){V("%PDF-"+b),V("%")},lu=g.__private__.putXRef=function(){var j="0000000000";V("xref"),V("0 "+(K+1)),V("0000000000 65535 f ");for(var G=1;G<=K;G++)typeof se[G]=="function"?V((j+se[G]()).slice(-10)+" 00000 n "):se[G]!==void 0?V((j+se[G]).slice(-10)+" 00000 n "):V("0000000000 00000 n ")},Ds=g.__private__.buildDocument=function(){var j;K=0,we=0,me=[],se=[],Se=[],ce=Da(),ue=Da(),Je(me),Tr.publish("buildDocument"),Gr(),ze(),(function(){Tr.publish("putAdditionalObjects");for(var _e=0;_e<Se.length;_e++){var Te=Se[_e];J(Te.objId,!0),V(Te.content),V("endobj")}Tr.publish("postPutAdditionalObjects")})(),j=[],(function(){for(var _e in Wt)Wt.hasOwnProperty(_e)&&(v===!1||v===!0&&y.hasOwnProperty(_e))&&Ve(Wt[_e])})(),(function(){var _e;for(_e in Zt)Zt.hasOwnProperty(_e)&&yt(Zt[_e])})(),(function(){for(var _e in Ka)Ka.hasOwnProperty(_e)&&pt(Ka[_e])})(),(function(_e){var Te;for(Te in Yt)Yt.hasOwnProperty(Te)&&(Yt[Te]instanceof Vu?bt(Yt[Te]):Yt[Te]instanceof Sh&&Tt(Yt[Te],_e))})(j),Tr.publish("putResources"),j.forEach(kt),kt({resourcesOid:ue,objectOid:Number.MAX_SAFE_INTEGER}),Tr.publish("postPutResources"),d!==null&&(fn.oid=ha(),V("<<"),V("/Filter /Standard"),V("/V "+fn.v),V("/R "+fn.r),V("/U <"+fn.toHexString(fn.U)+">"),V("/O <"+fn.toHexString(fn.O)+">"),V("/P "+fn.P),V(">>"),V("endobj")),ka(),lo();var G=we;return lu(),ps(),V("startxref"),V(""+G),V("%%EOF"),Je(Ee[M]),me.join(`
`)},Xo=g.__private__.getBlob=function(j){return new Blob([Le(j)],{type:"application/pdf"})},cu=g.output=g.__private__.output=(ei=function(j,G){switch(typeof(G=G||{})=="string"?G={filename:G}:G.filename=G.filename||"generated.pdf",j){case void 0:return Ds();case"save":g.save(G.filename);break;case"arraybuffer":return Le(Ds());case"blob":return Xo(Ds());case"bloburi":case"bloburl":if(gr.URL!==void 0&&typeof gr.URL.createObjectURL=="function")return gr.URL&&gr.URL.createObjectURL(Xo(Ds()))||void 0;Sa.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var _e="",Te=Ds();try{_e=G5(Te)}catch{_e=G5(unescape(encodeURIComponent(Te)))}return"data:application/pdf;filename="+G.filename+";base64,"+_e;case"pdfobjectnewwindow":if(Object.prototype.toString.call(gr)==="[object Window]"){var De="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",st=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';G.pdfObjectUrl&&(De=G.pdfObjectUrl,st="");var ht='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+De+'"'+st+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(G)+");<\/script></body></html>",Bt=gr.open();return Bt!==null&&Bt.document.write(ht),Bt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(gr)==="[object Window]"){var Gt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(G.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+G.filename+'" width="500px" height="400px" /></body></html>',cr=gr.open();if(cr!==null){cr.document.write(Gt);var vr=this;cr.document.documentElement.querySelector("#pdfViewer").onload=function(){cr.document.title=G.filename,cr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(vr.output("bloburl"))}}return cr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(gr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ir='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",G)+'"></iframe></body></html>',Aa=gr.open();if(Aa!==null&&(Aa.document.write(Ir),Aa.document.title=G.filename),Aa||typeof safari>"u")return Aa;break;case"datauri":case"dataurl":return gr.document.location.href=this.output("datauristring",G);default:return null}},ei.foo=function(){try{return ei.apply(this,arguments)}catch(_e){var j=_e.stack||"";~j.indexOf(" at ")&&(j=j.split(" at ")[1]);var G="Error in function "+j.split(`
`)[0].split("<")[0]+": "+_e.message;if(!gr.console)throw new Error(G);gr.console.error(G,_e),gr.alert&&alert(G)}},ei.foo.bar=ei,ei.foo),ri=function(j){return Array.isArray(Qn)===!0&&Qn.indexOf(j)>-1};switch(a){case"pt":ct=1;break;case"mm":ct=72/25.4;break;case"cm":ct=72/2.54;break;case"in":ct=72;break;case"px":ct=ri("px_scaling")==1?.75:96/72;break;case"pc":case"em":ct=12;break;case"ex":ct=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);ct=a}var fn=null;Q(),de();var Za=g.__private__.getPageInfo=g.getPageInfo=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Dt[j].objId,pageNumber:j,pageContext:Dt[j]}},uc=g.__private__.getPageInfoByObjId=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var G in Dt)if(Dt[G].objId===j)break;return Za(G)},xf=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:Dt[M].objId,pageNumber:M,pageContext:Dt[M]}};g.addPage=function(){return ti.apply(this,arguments),this},g.setPage=function(){return ds.apply(this,arguments),Je.call(this,Ee[M]),this},g.insertPage=function(j){return this.addPage(),this.movePage(M,j),this},g.movePage=function(j,G){var _e,Te;if(j>G){_e=Ee[j],Te=Dt[j];for(var De=j;De>G;De--)Ee[De]=Ee[De-1],Dt[De]=Dt[De-1];Ee[G]=_e,Dt[G]=Te,this.setPage(G)}else if(j<G){_e=Ee[j],Te=Dt[j];for(var st=j;st<G;st++)Ee[st]=Ee[st+1],Dt[st]=Dt[st+1];Ee[G]=_e,Dt[G]=Te,this.setPage(G)}return this},g.deletePage=function(){return hs.apply(this,arguments),this},g.__private__.text=g.text=function(j,G,_e,Te,De){var st,ht,Bt,Gt,cr,vr,Ir,Aa,qa,da=(Te=Te||{}).scope||this;if(typeof j=="number"&&typeof G=="number"&&(typeof _e=="string"||Array.isArray(_e))){var hn=_e;_e=G,G=j,j=hn}if(arguments[3]instanceof Kt==0?(Bt=arguments[4],Gt=arguments[5],ua(Ir=arguments[3])==="object"&&Ir!==null||(typeof Bt=="string"&&(Gt=Bt,Bt=null),typeof Ir=="string"&&(Gt=Ir,Ir=null),typeof Ir=="number"&&(Bt=Ir,Ir=null),Te={flags:Ir,angle:Bt,align:Gt})):(D("The transform parameter of text() with a Matrix value"),qa=De),isNaN(G)||isNaN(_e)||j==null)throw new Error("Invalid arguments passed to jsPDF.text");if(j.length===0)return da;var Qa,Rn="",vo=typeof Te.lineHeightFactor=="number"?Te.lineHeightFactor:co,vs=da.internal.scaleFactor;function xo($r){return $r=$r.split("	").join(Array(Te.TabLen||9).join(" ")),jr($r,Ir)}function xu($r){for(var Br,pa=$r.concat(),Ha=[],Vs=pa.length;Vs--;)typeof(Br=pa.shift())=="string"?Ha.push(Br):Array.isArray($r)&&(Br.length===1||Br[1]===void 0&&Br[2]===void 0)?Ha.push(Br[0]):Ha.push([Br[0],Br[1],Br[2]]);return Ha}function pc($r,Br){var pa;if(typeof $r=="string")pa=Br($r)[0];else if(Array.isArray($r)){for(var Ha,Vs,ws=$r.concat(),Fl=[],wu=ws.length;wu--;)typeof(Ha=ws.shift())=="string"?Fl.push(Br(Ha)[0]):Array.isArray(Ha)&&typeof Ha[0]=="string"&&(Vs=Br(Ha[0],Ha[1],Ha[2]),Fl.push([Vs[0],Vs[1],Vs[2]]));pa=Fl}return pa}var Is=!1,xs=!0;if(typeof j=="string")Is=!0;else if(Array.isArray(j)){var Cl=j.concat();ht=[];for(var yo,bn=Cl.length;bn--;)(typeof(yo=Cl.shift())!="string"||Array.isArray(yo)&&typeof yo[0]!="string")&&(xs=!1);Is=xs}if(Is===!1)throw new Error('Type of text must be string or Array. "'+j+'" is not recognized.');typeof j=="string"&&(j=j.match(/[\r?\n]/)?j.split(/\r\n|\r|\n/g):[j]);var Ko=et/da.internal.scaleFactor,Jo=Ko*(vo-1);switch(Te.baseline){case"bottom":_e-=Jo;break;case"top":_e+=Ko-Jo;break;case"hanging":_e+=Ko-2*Jo;break;case"middle":_e+=Ko/2-Jo}if((vr=Te.maxWidth||0)>0&&(typeof j=="string"?j=da.splitTextToSize(j,vr):Object.prototype.toString.call(j)==="[object Array]"&&(j=j.reduce(function($r,Br){return $r.concat(da.splitTextToSize(Br,vr))},[]))),st={text:j,x:G,y:_e,options:Te,mutex:{pdfEscape:jr,activeFontKey:He,fonts:Wt,activeFontSize:et}},Tr.publish("preProcessText",st),j=st.text,Bt=(Te=st.options).angle,qa instanceof Kt==0&&Bt&&typeof Bt=="number"){Bt*=Math.PI/180,Te.rotationDirection===0&&(Bt=-Bt),R===T&&(Bt=-Bt);var mc=Math.cos(Bt),Bs=Math.sin(Bt);qa=new Kt(mc,Bs,-Bs,mc,0,0)}else Bt&&Bt instanceof Kt&&(qa=Bt);R!==T||qa||(qa=zi),(cr=Te.charSpace||Hi)!==void 0&&(Rn+=W(ee(cr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Aa=Te.horizontalScale)!==void 0&&(Rn+=W(100*Aa)+` Tz
`),Te.lang;var ni=-1,_o=Te.renderingMode!==void 0?Te.renderingMode:Te.stroke,gc=da.internal.getCurrentPageInfo().pageContext;switch(_o){case 0:case!1:case"fill":ni=0;break;case 1:case!0:case"stroke":ni=1;break;case 2:case"fillThenStroke":ni=2;break;case 3:case"invisible":ni=3;break;case 4:case"fillAndAddForClipping":ni=4;break;case 5:case"strokeAndAddPathForClipping":ni=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ni=6;break;case 7:case"addToPathForClipping":ni=7}var yu=gc.usedRenderingMode!==void 0?gc.usedRenderingMode:-1;ni!==-1?Rn+=ni+` Tr
`:yu!==-1&&(Rn+=`0 Tr
`),ni!==-1&&(gc.usedRenderingMode=ni),Gt=Te.align||"left";var Di,ys=et*vo,wo=da.internal.pageSize.getWidth(),_u=Wt[He];cr=Te.charSpace||Hi,vr=Te.maxWidth||0,Ir=Object.assign({autoencode:!0,noBOM:!0},Te.flags);var _s=[],Zo=function($r){return da.getStringUnitWidth($r,{font:_u,charSpace:cr,fontSize:et,doKerning:!1})*et/vs};if(Object.prototype.toString.call(j)==="[object Array]"){var gi;ht=xu(j),Gt!=="left"&&(Di=ht.map(Zo));var ii,Us=0;if(Gt==="right"){G-=Di[0],j=[],bn=ht.length;for(var qs=0;qs<bn;qs++)qs===0?(ii=Ri(G),gi=Fn(_e)):(ii=ee(Us-Di[qs]),gi=-ys),j.push([ht[qs],ii,gi]),Us=Di[qs]}else if(Gt==="center"){G-=Di[0]/2,j=[],bn=ht.length;for(var bo=0;bo<bn;bo++)bo===0?(ii=Ri(G),gi=Fn(_e)):(ii=ee((Us-Di[bo])/2),gi=-ys),j.push([ht[bo],ii,gi]),Us=Di[bo]}else if(Gt==="left"){j=[],bn=ht.length;for(var vc=0;vc<bn;vc++)j.push(ht[vc])}else if(Gt==="justify"&&_u.encoding==="Identity-H"){j=[],bn=ht.length,vr=vr!==0?vr:wo;for(var xc=0,za=0;za<bn;za++)if(gi=za===0?Fn(_e):-ys,ii=za===0?Ri(G):xc,za<bn-1){var Nf=ee((vr-Di[za])/(ht[za].split(" ").length-1)),zs=ht[za].split(" ");j.push([zs[0]+" ",ii,gi]),xc=0;for(var Hs=1;Hs<zs.length;Hs++){var Ln=(Zo(zs[Hs-1]+" "+zs[Hs])-Zo(zs[Hs]))*vs+Nf;Hs==zs.length-1?j.push([zs[Hs],Ln,0]):j.push([zs[Hs]+" ",Ln,0]),xc-=Ln}}else j.push([ht[za],ii,gi]);j.push(["",xc,0])}else{if(Gt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(j=[],bn=ht.length,vr=vr!==0?vr:wo,za=0;za<bn;za++){gi=za===0?Fn(_e):-ys,ii=za===0?Ri(G):0;var So=ht[za].split(" ").length-1,yc=So>0?(vr-Di[za])/So:0;za<bn-1?_s.push(W(ee(yc))):_s.push(0),j.push([ht[za],ii,gi])}}}(typeof Te.R2L=="boolean"?Te.R2L:Ct)===!0&&(j=pc(j,function($r,Br,pa){return[$r.split("").reverse().join(""),Br,pa]})),st={text:j,x:G,y:_e,options:Te,mutex:{pdfEscape:jr,activeFontKey:He,fonts:Wt,activeFontSize:et}},Tr.publish("postProcessText",st),j=st.text,Qa=st.mutex.isHex||!1;var _c=Wt[He].encoding;_c!=="WinAnsiEncoding"&&_c!=="StandardEncoding"||(j=pc(j,function($r,Br,pa){return[xo($r),Br,pa]})),ht=xu(j),j=[];for(var Eo,ko,Ws,Ol=Array.isArray(ht[0])?1:0,Pi="",Ao=function($r,Br,pa){var Ha="";return pa instanceof Kt?(pa=typeof Te.angle=="number"?fs(pa,new Kt(1,0,0,1,$r,Br)):fs(new Kt(1,0,0,1,$r,Br),pa),R===T&&(pa=fs(new Kt(1,0,0,-1,0,0),pa)),Ha=pa.join(" ")+` Tm
`):Ha=W($r)+" "+W(Br)+` Td
`,Ha},Hn=0;Hn<ht.length;Hn++){switch(Pi="",Ol){case 1:Ws=(Qa?"<":"(")+ht[Hn][0]+(Qa?">":")"),Eo=parseFloat(ht[Hn][1]),ko=parseFloat(ht[Hn][2]);break;case 0:Ws=(Qa?"<":"(")+ht[Hn]+(Qa?">":")"),Eo=Ri(G),ko=Fn(_e)}_s!==void 0&&_s[Hn]!==void 0&&(Pi=_s[Hn]+` Tw
`),Hn===0?j.push(Pi+Ao(Eo,ko,qa)+Ws):Ol===0?j.push(Pi+Ws):Ol===1&&j.push(Pi+Ao(Eo,ko,qa)+Ws)}j=Ol===0?j.join(` Tj
T* `):j.join(` Tj
`),j+=` Tj
`;var Vi=`BT
/`;return Vi+=He+" "+et+` Tf
`,Vi+=W(et*vo)+` TL
`,Vi+=Ps+`
`,Vi+=Rn,Vi+=j,V(Vi+="ET"),y[He]=!0,da};var uu=g.__private__.clip=g.clip=function(j){return V(j==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return uu("evenodd")},g.__private__.discardPath=g.discardPath=function(){return V("n"),this};var ai=g.__private__.isValidStyle=function(j){var G=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(j)!==-1&&(G=!0),G};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(j){return ai(j)&&(h=j),this};var fu=g.__private__.getStyle=g.getStyle=function(j){var G=h;switch(j){case"D":case"S":G="S";break;case"F":G="f";break;case"FD":case"DF":G="B";break;case"f":case"f*":case"B":case"B*":G=j}return G},hu=g.close=function(){return V("h"),this};g.stroke=function(){return V("S"),this},g.fill=function(j){return ms("f",j),this},g.fillEvenOdd=function(j){return ms("f*",j),this},g.fillStroke=function(j){return ms("B",j),this},g.fillStrokeEvenOdd=function(j){return ms("B*",j),this};var ms=function(j,G){ua(G)==="object"?_f(G,j):V(j)},El=function(j){j===null||R===T&&j===void 0||(j=fu(j),V(j))};function yf(j,G,_e,Te,De){var st=new Sh(G||this.boundingBox,_e||this.xStep,Te||this.yStep,this.gState,De||this.matrix);st.stream=this.stream;var ht=j+"$$"+this.cloneIndex+++"$$";return On(ht,st),st}var _f=function(j,G){var _e=Wr[j.key],Te=Yt[_e];if(Te instanceof Vu)V("q"),V(du(G)),Te.gState&&g.setGState(Te.gState),V(j.matrix.toString()+" cm"),V("/"+_e+" sh"),V("Q");else if(Te instanceof Sh){var De=new Kt(1,0,0,-1,0,go());j.matrix&&(De=De.multiply(j.matrix||zi),_e=yf.call(Te,j.key,j.boundingBox,j.xStep,j.yStep,De).id),V("q"),V("/Pattern cs"),V("/"+_e+" scn"),Te.gState&&g.setGState(Te.gState),V(G),V("Q")}},du=function(j){switch(j){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},pu=g.moveTo=function(j,G){return V(W(ee(j))+" "+W(oe(G))+" m"),this},wf=g.lineTo=function(j,G){return V(W(ee(j))+" "+W(oe(G))+" l"),this},mi=g.curveTo=function(j,G,_e,Te,De,st){return V([W(ee(j)),W(oe(G)),W(ee(_e)),W(oe(Te)),W(ee(De)),W(oe(st)),"c"].join(" ")),this};g.__private__.line=g.line=function(j,G,_e,Te,De){if(isNaN(j)||isNaN(G)||isNaN(_e)||isNaN(Te)||!ai(De))throw new Error("Invalid arguments passed to jsPDF.line");return R===O?this.lines([[_e-j,Te-G]],j,G,[1,1],De||"S"):this.lines([[_e-j,Te-G]],j,G,[1,1]).stroke()},g.__private__.lines=g.lines=function(j,G,_e,Te,De,st){var ht,Bt,Gt,cr,vr,Ir,Aa,qa,da,hn,Qa,Rn;if(typeof j=="number"&&(Rn=_e,_e=G,G=j,j=Rn),Te=Te||[1,1],st=st||!1,isNaN(G)||isNaN(_e)||!Array.isArray(j)||!Array.isArray(Te)||!ai(De)||typeof st!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(pu(G,_e),ht=Te[0],Bt=Te[1],cr=j.length,hn=G,Qa=_e,Gt=0;Gt<cr;Gt++)(vr=j[Gt]).length===2?(hn=vr[0]*ht+hn,Qa=vr[1]*Bt+Qa,wf(hn,Qa)):(Ir=vr[0]*ht+hn,Aa=vr[1]*Bt+Qa,qa=vr[2]*ht+hn,da=vr[3]*Bt+Qa,hn=vr[4]*ht+hn,Qa=vr[5]*Bt+Qa,mi(Ir,Aa,qa,da,hn,Qa));return st&&hu(),El(De),this},g.path=function(j){for(var G=0;G<j.length;G++){var _e=j[G],Te=_e.c;switch(_e.op){case"m":pu(Te[0],Te[1]);break;case"l":wf(Te[0],Te[1]);break;case"c":mi.apply(this,Te);break;case"h":hu()}}return this},g.__private__.rect=g.rect=function(j,G,_e,Te,De){if(isNaN(j)||isNaN(G)||isNaN(_e)||isNaN(Te)||!ai(De))throw new Error("Invalid arguments passed to jsPDF.rect");return R===O&&(Te=-Te),V([W(ee(j)),W(oe(G)),W(ee(_e)),W(ee(Te)),"re"].join(" ")),El(De),this},g.__private__.triangle=g.triangle=function(j,G,_e,Te,De,st,ht){if(isNaN(j)||isNaN(G)||isNaN(_e)||isNaN(Te)||isNaN(De)||isNaN(st)||!ai(ht))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[_e-j,Te-G],[De-_e,st-Te],[j-De,G-st]],j,G,[1,1],ht,!0),this},g.__private__.roundedRect=g.roundedRect=function(j,G,_e,Te,De,st,ht){if(isNaN(j)||isNaN(G)||isNaN(_e)||isNaN(Te)||isNaN(De)||isNaN(st)||!ai(ht))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Bt=4/3*(Math.SQRT2-1);return De=Math.min(De,.5*_e),st=Math.min(st,.5*Te),this.lines([[_e-2*De,0],[De*Bt,0,De,st-st*Bt,De,st],[0,Te-2*st],[0,st*Bt,-De*Bt,st,-De,st],[2*De-_e,0],[-De*Bt,0,-De,-st*Bt,-De,-st],[0,2*st-Te],[0,-st*Bt,De*Bt,-st,De,-st]],j+De,G,[1,1],ht,!0),this},g.__private__.ellipse=g.ellipse=function(j,G,_e,Te,De){if(isNaN(j)||isNaN(G)||isNaN(_e)||isNaN(Te)||!ai(De))throw new Error("Invalid arguments passed to jsPDF.ellipse");var st=4/3*(Math.SQRT2-1)*_e,ht=4/3*(Math.SQRT2-1)*Te;return pu(j+_e,G),mi(j+_e,G-ht,j+st,G-Te,j,G-Te),mi(j-st,G-Te,j-_e,G-ht,j-_e,G),mi(j-_e,G+ht,j-st,G+Te,j,G+Te),mi(j+st,G+Te,j+_e,G+ht,j+_e,G),El(De),this},g.__private__.circle=g.circle=function(j,G,_e,Te){if(isNaN(j)||isNaN(G)||isNaN(_e)||!ai(Te))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(j,G,_e,_e,Te)},g.setFont=function(j,G,_e){return _e&&(G=F(G,_e)),He=$o(j,G,{disableWarning:!1}),this};var gs=g.__private__.getFont=g.getFont=function(){return Wt[$o.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var j,G,_e={};for(j in nr)if(nr.hasOwnProperty(j))for(G in _e[j]=[],nr[j])nr[j].hasOwnProperty(G)&&_e[j].push(G);return _e},g.addFont=function(j,G,_e,Te,De){var st=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&st.indexOf(arguments[3])!==-1?De=arguments[3]:arguments[3]&&st.indexOf(arguments[3])==-1&&(_e=F(_e,Te)),ea.call(this,j,G,_e,De=De||"Identity-H")};var co,kl=t.lineWidth||.200025,Yo=g.__private__.getLineWidth=g.getLineWidth=function(){return kl},sr=g.__private__.setLineWidth=g.setLineWidth=function(j){return kl=j,V(W(ee(j))+" w"),this};g.__private__.setLineDash=Jt.API.setLineDash=Jt.API.setLineDashPattern=function(j,G){if(j=j||[],G=G||0,isNaN(G)||!Array.isArray(j))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return j=j.map(function(_e){return W(ee(_e))}).join(" "),G=W(ee(G)),V("["+j+"] "+G+" d"),this};var bf=g.__private__.getLineHeight=g.getLineHeight=function(){return et*co};g.__private__.getLineHeight=g.getLineHeight=function(){return et*co};var mu=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(j){return typeof(j=j||1.15)=="number"&&(co=j),this},Sf=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return co};mu(t.lineHeight);var Ri=g.__private__.getHorizontalCoordinate=function(j){return ee(j)},Fn=g.__private__.getVerticalCoordinate=function(j){return R===T?j:Dt[M].mediaBox.topRightY-Dt[M].mediaBox.bottomLeftY-ee(j)},gu=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(j){return W(Ri(j))},Al=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(j){return W(Fn(j))},Li=t.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return pe(Li)},g.__private__.setStrokeColor=g.setDrawColor=function(j,G,_e,Te){return Li=be({ch1:j,ch2:G,ch3:_e,ch4:Te,pdfColorType:"draw",precision:2}),V(Li),this};var Nl=t.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return pe(Nl)},g.__private__.setFillColor=g.setFillColor=function(j,G,_e,Te){return Nl=be({ch1:j,ch2:G,ch3:_e,ch4:Te,pdfColorType:"fill",precision:2}),V(Nl),this};var Ps=t.textColor||"0 g",Ef=g.__private__.getTextColor=g.getTextColor=function(){return pe(Ps)};g.__private__.setTextColor=g.setTextColor=function(j,G,_e,Te){return Ps=be({ch1:j,ch2:G,ch3:_e,ch4:Te,pdfColorType:"text",precision:3}),this};var Hi=t.charSpace,fc=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(Hi||0)};g.__private__.setCharSpace=g.setCharSpace=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Hi=j,this};var hc=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(j){var G=g.CapJoinStyles[j];if(G===void 0)throw new Error("Line cap style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return hc=G,V(G+" J"),this};var wn=0;g.__private__.setLineJoin=g.setLineJoin=function(j){var G=g.CapJoinStyles[j];if(G===void 0)throw new Error("Line join style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return wn=G,V(G+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(j){if(j=j||0,isNaN(j))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return V(W(ee(j))+" M"),this},g.GState=Np,g.setGState=function(j){(j=typeof j=="string"?Zt[ir[j]]:Ms(null,j)).equals(Vr)||(V("/"+j.id+" gs"),Vr=j)};var Ms=function(j,G){if(!j||!ir[j]){var _e=!1;for(var Te in Zt)if(Zt.hasOwnProperty(Te)&&Zt[Te].equals(G)){_e=!0;break}if(_e)G=Zt[Te];else{var De="GS"+(Object.keys(Zt).length+1).toString(10);Zt[De]=G,G.id=De}return j&&(ir[j]=G.id),Tr.publish("addGState",G),G}};g.addGState=function(j,G){return Ms(j,G),this},g.saveGraphicsState=function(){return V("q"),br.push({key:He,size:et,color:Ps}),this},g.restoreGraphicsState=function(){V("Q");var j=br.pop();return He=j.key,et=j.size,Ps=j.color,Vr=null,this},g.setCurrentTransformationMatrix=function(j){return V(j.toString()+" cm"),this},g.comment=function(j){return V("#"+j),this};var Wi=function(j,G){var _e=j||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return _e},set:function(st){isNaN(st)||(_e=parseFloat(st))}});var Te=G||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Te},set:function(st){isNaN(st)||(Te=parseFloat(st))}});var De="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return De},set:function(st){De=st.toString()}}),this},uo=function(j,G,_e,Te){Wi.call(this,j,G),this.type="rect";var De=_e||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return De},set:function(ht){isNaN(ht)||(De=parseFloat(ht))}});var st=Te||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return st},set:function(ht){isNaN(ht)||(st=parseFloat(ht))}}),this},dc=function(){this.page=pr,this.currentPage=M,this.pages=Ee.slice(0),this.pagesContext=Dt.slice(0),this.x=mt,this.y=Ht,this.matrix=Rt,this.width=ho(M),this.height=vu(M),this.outputDestination=rt,this.id="",this.objectNumber=-1};dc.prototype.restore=function(){pr=this.page,M=this.currentPage,Dt=this.pagesContext,Ee=this.pages,mt=this.x,Ht=this.y,Rt=this.matrix,jl(M,this.width),po(M,this.height),rt=this.outputDestination};var Tl=function(j,G,_e,Te,De){Ja.push(new dc),pr=M=0,Ee=[],mt=j,Ht=G,Rt=De,na([_e,Te])};for(var fo in g.beginFormObject=function(j,G,_e,Te,De){return Tl(j,G,_e,Te,De),this},g.endFormObject=function(j){return(function(G){if(_t[G])Ja.pop().restore();else{var _e=new dc,Te="Xo"+(Object.keys(Ka).length+1).toString(10);_e.id=Te,_t[G]=Te,Ka[Te]=_e,Tr.publish("addFormObject",_e),Ja.pop().restore()}})(j),this},g.doFormObject=function(j,G){var _e=Ka[_t[j]];return V("q"),V(G.toString()+" cm"),V("/"+_e.id+" Do"),V("Q"),this},g.getFormObject=function(j){var G=Ka[_t[j]];return{x:G.x,y:G.y,width:G.width,height:G.height,matrix:G.matrix}},g.save=function(j,G){return j=j||"generated.pdf",(G=G||{}).returnPromise=G.returnPromise||!1,G.returnPromise===!1?(qu(Xo(Ds()),j),typeof qu.unload=="function"&&gr.setTimeout&&setTimeout(qu.unload,911),this):new Promise(function(_e,Te){try{var De=qu(Xo(Ds()),j);typeof qu.unload=="function"&&gr.setTimeout&&setTimeout(qu.unload,911),_e(De)}catch(st){Te(st.message)}})},Jt.API)Jt.API.hasOwnProperty(fo)&&(fo==="events"&&Jt.API.events.length?(function(j,G){var _e,Te,De;for(De=G.length-1;De!==-1;De--)_e=G[De][0],Te=G[De][1],j.subscribe.apply(j,[_e].concat(typeof Te=="function"?[Te]:Te))})(Tr,Jt.API.events):g[fo]=Jt.API[fo]);function ho(j){return Dt[j].mediaBox.topRightX-Dt[j].mediaBox.bottomLeftX}function jl(j,G){Dt[j].mediaBox.topRightX=G+Dt[j].mediaBox.bottomLeftX}function vu(j){return Dt[j].mediaBox.topRightY-Dt[j].mediaBox.bottomLeftY}function po(j,G){Dt[j].mediaBox.topRightY=G+Dt[j].mediaBox.bottomLeftY}var mo=g.getPageWidth=function(j){return ho(j=j||M)/ct},kf=g.setPageWidth=function(j,G){jl(j,G*ct)},go=g.getPageHeight=function(j){return vu(j=j||M)/ct},Af=g.setPageHeight=function(j,G){po(j,G*ct)};return g.internal={pdfEscape:jr,getStyle:fu,getFont:gs,getFontSize:vt,getCharSpace:fc,getTextColor:Ef,getLineHeight:bf,getLineHeightFactor:Sf,getLineWidth:Yo,write:Ie,getHorizontalCoordinate:Ri,getVerticalCoordinate:Fn,getCoordinateString:gu,getVerticalCoordinateString:Al,collections:{},newObject:ha,newAdditionalObject:ye,newObjectDeferred:Da,newObjectDeferredBegin:J,getFilters:Be,putStream:Qe,events:Tr,scaleFactor:ct,pageSize:{getWidth:function(){return mo(M)},setWidth:function(j){kf(M,j)},getHeight:function(){return go(M)},setHeight:function(j){Af(M,j)}},encryptionOptions:d,encryption:fn,getEncryptor:function(j){return d!==null?fn.encryptor(j,0):function(G){return G}},output:cu,getNumberOfPages:Fi,get pages(){return Ee},out:V,f2:I,f3:L,getPageInfo:Za,getPageInfoByObjId:uc,getCurrentPageInfo:xf,getPDFVersion:w,Point:Wi,Rectangle:uo,Matrix:Kt,hasHotfix:ri},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return mo(M)},set:function(j){kf(M,j)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return go(M)},set:function(j){Af(M,j)},enumerable:!0,configurable:!0}),(function(j){for(var G=0,_e=gt.length;G<_e;G++){var Te=ea.call(this,j[G][0],j[G][1],j[G][2],gt[G][3],!0);v===!1&&(y[Te]=!0);var De=j[G][0].split("-");Lt({id:Te,fontName:De[0],fontStyle:De[1]||""})}Tr.publish("addFonts",{fonts:Wt,dictionary:nr})}).call(g,gt),He="F1",ti(n,r),Tr.publish("initialized"),g}_h.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},_h.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},_h.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},_h.prototype.processOwnerPassword=function(t,e){return qv(Uv(e).substr(0,5),t)},_h.prototype.encryptor=function(t,e){var r=Uv(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(a){return qv(r,a)}},Np.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||ua(t)!==ua(this))return!1;var a=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;a++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&a--;return a===0},Jt.API={events:[]},Jt.version="3.0.4";var on=Jt.API,Y2=1,vf=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},mh=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},_r=function(t){return t.toFixed(2)},Gc=function(t){return t.toFixed(5)};on.__acroform__={};var us=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},K5=function(t){return t*Y2},gl=function(t){var e=new wE,r=zt.internal.getHeight(t)||0,a=zt.internal.getWidth(t)||0;return e.BBox=[0,0,Number(_r(a)),Number(_r(r))],e},aB=on.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},nB=on.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},iB=on.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},gn=on.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return iB(t,e-1)},vn=on.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return aB(t,e-1)},xn=on.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return nB(t,e-1)},sB=on.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,a=e.internal.getVerticalCoordinate,n=t[0],i=t[1],o=t[2],c=t[3],u={};return u.lowerLeft_X=r(n)||0,u.lowerLeft_Y=a(i+c)||0,u.upperRight_X=r(n+o)||0,u.upperRight_Y=a(i)||0,[Number(_r(u.lowerLeft_X)),Number(_r(u.lowerLeft_Y)),Number(_r(u.upperRight_X)),Number(_r(u.upperRight_Y))]},oB=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,a=zv(t,r),n=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+n+" "+_r(a.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(a.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=gl(t);return i.scope=t.scope,i.stream=e.join(`
`),i}},zv=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,a={text:"",fontSize:""},n=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");n=t.multiline?n.map(function(I){return I.split(`
`)}):n.map(function(I){return[I]});var i=r,o=zt.internal.getHeight(t)||0;o=o<0?-o:o;var c=zt.internal.getWidth(t)||0;c=c<0?-c:c;var u=function(I,L,ee){if(I+1<n.length){var oe=L+" "+n[I+1][0];return $1(oe,t,ee).width<=c-4}return!1};i++;e:for(;i>0;){e="",i--;var h,d,v=$1("3",t,i).height,y=t.multiline?o-i:(o-v)/2,g=y+=2,b=0,w=0,E=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+$1(e,t,i=12).width+", FieldWidth:"+c+`
`;break}for(var A="",O=0,T=0;T<n.length;T++)if(n.hasOwnProperty(T)){var R=!1;if(n[T].length!==1&&E!==n[T].length-1){if((v+2)*(O+2)+2>o)continue e;A+=n[T][E],R=!0,w=T,T--}else{A=(A+=n[T][E]+" ").substr(A.length-1)==" "?A.substr(0,A.length-1):A;var H=parseInt(T),z=u(H,A,i),F=T>=n.length-1;if(z&&!F){A+=" ",E=0;continue}if(z||F){if(F)w=H;else if(t.multiline&&(v+2)*(O+2)+2>o)continue e}else{if(!t.multiline||(v+2)*(O+2)+2>o)continue e;w=H}}for(var W="",D=b;D<=w;D++){var Y=n[D];if(t.multiline){if(D===w){W+=Y[E]+" ",E=(E+1)%Y.length;continue}if(D===b){W+=Y[Y.length-1]+" ";continue}}W+=Y[0]+" "}switch(W=W.substr(W.length-1)==" "?W.substr(0,W.length-1):W,d=$1(W,t,i).width,t.textAlign){case"right":h=c-d-2;break;case"center":h=(c-d)/2;break;default:h=2}e+=_r(h)+" "+_r(g)+` Td
`,e+="("+vf(W)+`) Tj
`,e+=-_r(h)+` 0 Td
`,g=-(i+2),d=0,b=R?w:w+1,O++,A=""}break}return a.text=e,a.fontSize=i,a},$1=function(t,e,r){var a=e.scope.internal.getFont(e.fontName,e.fontStyle),n=e.scope.getStringUnitWidth(t,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},lB={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},cB=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},uB=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Vo.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(lB)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Y2=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new bE,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var i=a[n];i.objId=void 0,i.hasAnnotation&&cB(i,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(a,n){var i=!a;for(var o in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(o)){var c=a[o],u=[],h=c.Rect;if(c.Rect&&(c.Rect=sB(c.Rect,n)),n.internal.newObjectDeferredBegin(c.objId,!0),c.DA=zt.createDefaultAppearanceStream(c),ua(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(u=c.getKeyValueListForStream()),c.Rect=h,c.hasAppearanceStream&&!c.appearanceStreamContent){var d=oB(c);u.push({key:"AP",value:"<</N "+d+">>"}),n.internal.acroformPlugin.xForms.push(d)}if(c.appearanceStreamContent){var v="";for(var y in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(y)){var g=c.appearanceStreamContent[y];if(v+="/"+y+" ",v+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var o in g)if(g.hasOwnProperty(o)){var b=g[o];typeof b=="function"&&(b=b.call(n,c)),v+="/"+o+" "+b+" ",n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b)}}else typeof(b=g)=="function"&&(b=b.call(n,c)),v+="/"+o+" "+b,n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b);v+=">>"}u.push({key:"AP",value:`<<
`+v+">>"})}n.internal.putStream({additionalKeyValues:u,objectId:c.objId}),n.internal.out("endobj")}i&&(function(w,E){for(var A in w)if(w.hasOwnProperty(A)){var O=A,T=w[A];E.internal.newObjectDeferredBegin(T.objId,!0),ua(T)==="object"&&typeof T.putStream=="function"&&T.putStream(),delete w[O]}})(n.internal.acroformPlugin.xForms,n)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},_E=on.__acroform__.arrayToPdfArray=function(t,e,r){var a=function(o){return o};if(Array.isArray(t)){for(var n="[",i=0;i<t.length;i++)switch(i!==0&&(n+=" "),ua(t[i])){case"boolean":case"number":case"object":n+=t[i].toString();break;case"string":t[i].substr(0,1)!=="/"?(e!==void 0&&r&&(a=r.internal.getEncryptor(e)),n+="("+vf(a(t[i].toString()))+")"):n+=t[i].toString()}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Xg=function(t,e,r){var a=function(n){return n};return e!==void 0&&r&&(a=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+vf(a(t))+")"},yl=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};yl.prototype.toString=function(){return this.objId+" 0 R"},yl.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},yl.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var a=e[r],n=this[a];n&&(Array.isArray(n)?t.push({key:a,value:_E(n,this.objId,this.scope)}):n instanceof yl?(n.scope=this.scope,t.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&t.push({key:a,value:n}))}return t};var wE=function(){yl.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};us(wE,yl);var bE=function(){yl.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+vf(r(t))+")"}},set:function(r){t=r}})};us(bE,yl);var Vo=function t(){yl.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(A){if(isNaN(A))throw new Error('Invalid value "'+A+'" for attribute F supplied.');e=A}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!gn(e,3)},set:function(A){A?this.F=vn(e,3):this.F=xn(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(A){if(isNaN(A))throw new Error('Invalid value "'+A+'" for attribute Ff supplied.');r=A}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(A){a=A!==void 0?A:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(A){a[0]=A}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(A){a[1]=A}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(A){a[2]=A}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(A){a[3]=A}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(A){switch(A){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=A;break;default:throw new Error('Invalid value "'+A+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Tp)return;i="FieldObject"+t.FieldNum++}var A=function(O){return O};return this.scope&&(A=this.scope.internal.getEncryptor(this.objId)),"("+vf(A(i))+")"},set:function(A){i=A.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(A){i=A}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(A){o=A}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(A){c=A}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(A){u=A}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/Y2:h},set:function(A){h=A}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(A){d=A}});var v="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!v||this instanceof Tp||this instanceof ef))return Xg(v,this.objId,this.scope)},set:function(A){A=A.toString(),v=A}});var y=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(y)return this instanceof Kn==0?Xg(y,this.objId,this.scope):y},set:function(A){A=A.toString(),y=this instanceof Kn==0?A.substr(0,1)==="("?mh(A.substr(1,A.length-2)):mh(A):A}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Kn==1?mh(y.substr(1,y.length-1)):y},set:function(A){A=A.toString(),y=this instanceof Kn==1?"/"+A:A}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(A){this.V=A}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof Kn==0?Xg(g,this.objId,this.scope):g},set:function(A){A=A.toString(),g=this instanceof Kn==0?A.substr(0,1)==="("?mh(A.substr(1,A.length-2)):mh(A):A}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Kn==1?mh(g.substr(1,g.length-1)):g},set:function(A){A=A.toString(),g=this instanceof Kn==1?"/"+A:A}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,w=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return w},set:function(A){A=!!A,w=A}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(A){b=A}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,1)},set:function(A){A?this.Ff=vn(this.Ff,1):this.Ff=xn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,2)},set:function(A){A?this.Ff=vn(this.Ff,2):this.Ff=xn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,3)},set:function(A){A?this.Ff=vn(this.Ff,3):this.Ff=xn(this.Ff,3)}});var E=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(E!==null)return E},set:function(A){if([0,1,2].indexOf(A)===-1)throw new Error('Invalid value "'+A+'" for attribute Q supplied.');E=A}}),Object.defineProperty(this,"textAlign",{get:function(){var A;switch(E){case 0:default:A="left";break;case 1:A="center";break;case 2:A="right"}return A},configurable:!0,enumerable:!0,set:function(A){switch(A){case"right":case 2:E=2;break;case"center":case 1:E=1;break;default:E=0}}})};us(Vo,yl);var Oh=function(){Vo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return _E(e,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=(function(i,o,c){c||(c=1);for(var u,h=[];u=o.exec(i);)h.push(u[c]);return h})(a,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,18)},set:function(r){r?this.Ff=vn(this.Ff,18):this.Ff=xn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=vn(this.Ff,19):this.Ff=xn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,20)},set:function(r){r?(this.Ff=vn(this.Ff,20),e.sort()):this.Ff=xn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,22)},set:function(r){r?this.Ff=vn(this.Ff,22):this.Ff=xn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,23)},set:function(r){r?this.Ff=vn(this.Ff,23):this.Ff=xn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,27)},set:function(r){r?this.Ff=vn(this.Ff,27):this.Ff=xn(this.Ff,27)}}),this.hasAppearanceStream=!1};us(Oh,Vo);var Fh=function(){Oh.call(this),this.fontName="helvetica",this.combo=!1};us(Fh,Oh);var Rh=function(){Fh.call(this),this.combo=!0};us(Rh,Fh);var ep=function(){Rh.call(this),this.edit=!0};us(ep,Rh);var Kn=function(){Vo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,15)},set:function(r){r?this.Ff=vn(this.Ff,15):this.Ff=xn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,16)},set:function(r){r?this.Ff=vn(this.Ff,16):this.Ff=xn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,17)},set:function(r){r?this.Ff=vn(this.Ff,17):this.Ff=xn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,26)},set:function(r){r?this.Ff=vn(this.Ff,26):this.Ff=xn(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var a,n=[];for(a in n.push("<<"),e)n.push("/"+a+" ("+vf(r(e[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){ua(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};us(Kn,Vo);var tp=function(){Kn.call(this),this.pushButton=!0};us(tp,Kn);var Lh=function(){Kn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};us(Lh,Kn);var Tp=function(){var t,e;Vo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(n){e=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(c){return c};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),a)o.push("/"+i+" ("+vf(n(a[i]))+")");return o.push(">>"),o.join(`
`)},set:function(n){ua(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=zt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};us(Tp,Vo),Lh.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Lh.prototype.createOption=function(t){var e=new Tp;return e.Parent=this,e.optionName=t,this.Kids.push(e),fB.call(this.scope,e),e};var rp=function(){Kn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=zt.CheckBox.createAppearanceStream()};us(rp,Kn);var ef=function(){Vo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,13)},set:function(e){e?this.Ff=vn(this.Ff,13):this.Ff=xn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,21)},set:function(e){e?this.Ff=vn(this.Ff,21):this.Ff=xn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,23)},set:function(e){e?this.Ff=vn(this.Ff,23):this.Ff=xn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,24)},set:function(e){e?this.Ff=vn(this.Ff,24):this.Ff=xn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,25)},set:function(e){e?this.Ff=vn(this.Ff,25):this.Ff=xn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,26)},set:function(e){e?this.Ff=vn(this.Ff,26):this.Ff=xn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};us(ef,Vo);var ap=function(){ef.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!gn(this.Ff,14)},set:function(t){t?this.Ff=vn(this.Ff,14):this.Ff=xn(this.Ff,14)}}),this.password=!0};us(ap,ef);var zt={CheckBox:{createAppearanceStream:function(){return{N:{On:zt.CheckBox.YesNormal},D:{On:zt.CheckBox.YesPushDown,Off:zt.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=gl(t);e.scope=t.scope;var r=[],a=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=zv(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+_r(zt.internal.getWidth(t))+" "+_r(zt.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+_r(i.fontSize)+" Tf "+n),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=gl(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),n=[],i=zt.internal.getHeight(t),o=zt.internal.getWidth(t),c=zv(t,t.caption);return n.push("1 g"),n.push("0 0 "+_r(o)+" "+_r(i)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+_r(o-1)+" "+_r(i-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+_r(c.fontSize)+" Tf "+a),n.push(c.text),n.push("ET"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=gl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+_r(zt.internal.getWidth(t))+" "+_r(zt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:zt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=zt.RadioButton.Circle.YesNormal,e.D[t]=zt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=gl(t);e.scope=t.scope;var r=[],a=zt.internal.getWidth(t)<=zt.internal.getHeight(t)?zt.internal.getWidth(t)/4:zt.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=zt.internal.Bezier_C,i=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Gc(zt.internal.getWidth(t)/2)+" "+Gc(zt.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=gl(t);e.scope=t.scope;var r=[],a=zt.internal.getWidth(t)<=zt.internal.getHeight(t)?zt.internal.getWidth(t)/4:zt.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),i=Number((n*zt.internal.Bezier_C).toFixed(5)),o=Number((a*zt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Gc(zt.internal.getWidth(t)/2)+" "+Gc(zt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Gc(zt.internal.getWidth(t)/2)+" "+Gc(zt.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+o+" "+o+" "+a+" 0 "+a+" c"),r.push("-"+o+" "+a+" -"+a+" "+o+" -"+a+" 0 c"),r.push("-"+a+" -"+o+" -"+o+" -"+a+" 0 -"+a+" c"),r.push(o+" -"+a+" "+a+" -"+o+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=gl(t);e.scope=t.scope;var r=[],a=zt.internal.getWidth(t)<=zt.internal.getHeight(t)?zt.internal.getWidth(t)/4:zt.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),i=Number((n*zt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Gc(zt.internal.getWidth(t)/2)+" "+Gc(zt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:zt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=zt.RadioButton.Cross.YesNormal,e.D[t]=zt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=gl(t);e.scope=t.scope;var r=[],a=zt.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+_r(zt.internal.getWidth(t)-2)+" "+_r(zt.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(_r(a.x1.x)+" "+_r(a.x1.y)+" m"),r.push(_r(a.x2.x)+" "+_r(a.x2.y)+" l"),r.push(_r(a.x4.x)+" "+_r(a.x4.y)+" m"),r.push(_r(a.x3.x)+" "+_r(a.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=gl(t);e.scope=t.scope;var r=zt.internal.calculateCross(t),a=[];return a.push("0.749023 g"),a.push("0 0 "+_r(zt.internal.getWidth(t))+" "+_r(zt.internal.getHeight(t))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+_r(zt.internal.getWidth(t)-2)+" "+_r(zt.internal.getHeight(t)-2)+" re"),a.push("W"),a.push("n"),a.push(_r(r.x1.x)+" "+_r(r.x1.y)+" m"),a.push(_r(r.x2.x)+" "+_r(r.x2.y)+" l"),a.push(_r(r.x4.x)+" "+_r(r.x4.y)+" m"),a.push(_r(r.x3.x)+" "+_r(r.x3.y)+" l"),a.push("s"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(t){var e=gl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+_r(zt.internal.getWidth(t))+" "+_r(zt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};zt.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=zt.internal.getWidth(t),r=zt.internal.getHeight(t),a=Math.min(e,r);return{x1:{x:(e-a)/2,y:(r-a)/2+a},x2:{x:(e-a)/2+a,y:(r-a)/2},x3:{x:(e-a)/2,y:(r-a)/2},x4:{x:(e-a)/2+a,y:(r-a)/2+a}}}},zt.internal.getWidth=function(t){var e=0;return ua(t)==="object"&&(e=K5(t.Rect[2])),e},zt.internal.getHeight=function(t){var e=0;return ua(t)==="object"&&(e=K5(t.Rect[3])),e};var fB=on.addField=function(t){if(uB(this,t),!(t instanceof Vo))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};on.AcroFormChoiceField=Oh,on.AcroFormListBox=Fh,on.AcroFormComboBox=Rh,on.AcroFormEditBox=ep,on.AcroFormButton=Kn,on.AcroFormPushButton=tp,on.AcroFormRadioButton=Lh,on.AcroFormCheckBox=rp,on.AcroFormTextField=ef,on.AcroFormPasswordField=ap,on.AcroFormAppearance=zt,on.AcroForm={ChoiceField:Oh,ListBox:Fh,ComboBox:Rh,EditBox:ep,Button:Kn,PushButton:tp,RadioButton:Lh,CheckBox:rp,TextField:ef,PasswordField:ap,Appearance:zt},Jt.AcroForm={ChoiceField:Oh,ListBox:Fh,ComboBox:Rh,EditBox:ep,Button:Kn,PushButton:tp,RadioButton:Lh,CheckBox:rp,TextField:ef,PasswordField:ap,Appearance:zt};Jt.AcroForm;function SE(t){return t.reduce(function(e,r,a){return e[r]=a,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(I,L){var ee,oe,ge,ie,he,de=r;if((L=L||r)==="RGBA"||I.data!==void 0&&I.data instanceof Uint8ClampedArray&&"height"in I&&"width"in I)return"RGBA";if(z(I))for(he in a)for(ge=a[he],ee=0;ee<ge.length;ee+=1){for(ie=!0,oe=0;oe<ge[ee].length;oe+=1)if(ge[ee][oe]!==void 0&&ge[ee][oe]!==I[oe]){ie=!1;break}if(ie===!0){de=he;break}}else for(he in a)for(ge=a[he],ee=0;ee<ge.length;ee+=1){for(ie=!0,oe=0;oe<ge[ee].length;oe+=1)if(ge[ee][oe]!==void 0&&ge[ee][oe]!==I.charCodeAt(oe)){ie=!1;break}if(ie===!0){de=he;break}}return de===r&&L!==r&&(de=L),de},i=function I(L){for(var ee=this.internal.write,oe=this.internal.putStream,ge=(0,this.internal.getFilters)();ge.indexOf("FlateEncode")!==-1;)ge.splice(ge.indexOf("FlateEncode"),1);L.objectId=this.internal.newObject();var ie=[];if(ie.push({key:"Type",value:"/XObject"}),ie.push({key:"Subtype",value:"/Image"}),ie.push({key:"Width",value:L.width}),ie.push({key:"Height",value:L.height}),L.colorSpace===A.INDEXED?ie.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(L.palette.length/3-1)+" "+("sMask"in L&&L.sMask!==void 0?L.objectId+2:L.objectId+1)+" 0 R]"}):(ie.push({key:"ColorSpace",value:"/"+L.colorSpace}),L.colorSpace===A.DEVICE_CMYK&&ie.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ie.push({key:"BitsPerComponent",value:L.bitsPerComponent}),"decodeParameters"in L&&L.decodeParameters!==void 0&&ie.push({key:"DecodeParms",value:"<<"+L.decodeParameters+">>"}),"transparency"in L&&Array.isArray(L.transparency)&&L.transparency.length>0){for(var he="",de=0,Z=L.transparency.length;de<Z;de++)he+=L.transparency[de]+" "+L.transparency[de]+" ";ie.push({key:"Mask",value:"["+he+"]"})}L.sMask!==void 0&&ie.push({key:"SMask",value:L.objectId+1+" 0 R"});var Ne=L.filter!==void 0?["/"+L.filter]:void 0;if(oe({data:L.data,additionalKeyValues:ie,alreadyAppliedFilters:Ne,objectId:L.objectId}),ee("endobj"),"sMask"in L&&L.sMask!==void 0){var Q,N=(Q=L.sMaskBitsPerComponent)!==null&&Q!==void 0?Q:L.bitsPerComponent,M={width:L.width,height:L.height,colorSpace:"DeviceGray",bitsPerComponent:N,data:L.sMask};"filter"in L&&(M.decodeParameters="/Predictor ".concat(L.predictor," /Colors 1 /BitsPerComponent ").concat(N," /Columns ").concat(L.width),M.filter=L.filter),I.call(this,M)}if(L.colorSpace===A.INDEXED){var B=this.internal.newObject();oe({data:W(new Uint8Array(L.palette)),objectId:B}),ee("endobj")}},o=function(){var I=this.internal.collections[e+"images"];for(var L in I)i.call(this,I[L])},c=function(){var I,L=this.internal.collections[e+"images"],ee=this.internal.write;for(var oe in L)ee("/I"+(I=L[oe]).index,I.objectId,"0","R")},u=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",c))},h=function(){var I=this.internal.collections[e+"images"];return u.call(this),I},d=function(){return Object.keys(this.internal.collections[e+"images"]).length},v=function(I){return typeof t["process"+I.toUpperCase()]=="function"},y=function(I){return ua(I)==="object"&&I.nodeType===1},g=function(I,L){if(I.nodeName==="IMG"&&I.hasAttribute("src")){var ee=""+I.getAttribute("src");if(ee.indexOf("data:image/")===0)return Q1(unescape(ee).split("base64,").pop());var oe=t.loadFile(ee,!0);if(oe!==void 0)return oe}if(I.nodeName==="CANVAS"){if(I.width===0||I.height===0)throw new Error("Given canvas must have data. Canvas width: "+I.width+", height: "+I.height);var ge;switch(L){case"PNG":ge="image/png";break;case"WEBP":ge="image/webp";break;default:ge="image/jpeg"}return Q1(I.toDataURL(ge,1).split("base64,").pop())}},b=function(I){var L=this.internal.collections[e+"images"];if(L){for(var ee in L)if(I===L[ee].alias)return L[ee]}},w=function(I,L,ee){return I||L||(I=-96,L=-96),I<0&&(I=-1*ee.width*72/I/this.internal.scaleFactor),L<0&&(L=-1*ee.height*72/L/this.internal.scaleFactor),I===0&&(I=L*ee.width/ee.height),L===0&&(L=I*ee.height/ee.width),[I,L]},E=function(I,L,ee,oe,ge,ie){var he=w.call(this,ee,oe,ge),de=this.internal.getCoordinateString,Z=this.internal.getVerticalCoordinateString,Ne=h.call(this);if(ee=he[0],oe=he[1],Ne[ge.index]=ge,ie){ie*=Math.PI/180;var Q=Math.cos(ie),N=Math.sin(ie),M=function(q){return q.toFixed(4)},B=[M(Q),M(N),M(-1*N),M(Q),0,0,"cm"]}this.internal.write("q"),ie?(this.internal.write([1,"0","0",1,de(I),Z(L+oe),"cm"].join(" ")),this.internal.write(B.join(" ")),this.internal.write([de(ee),"0","0",de(oe),"0","0","cm"].join(" "))):this.internal.write([de(ee),"0","0",de(oe),de(I),Z(L+oe),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ge.index+" Do"),this.internal.write("Q")},A=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var O=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},T=t.__addimage__.sHashCode=function(I){var L,ee,oe=0;if(typeof I=="string")for(ee=I.length,L=0;L<ee;L++)oe=(oe<<5)-oe+I.charCodeAt(L),oe|=0;else if(z(I))for(ee=I.byteLength/2,L=0;L<ee;L++)oe=(oe<<5)-oe+I[L],oe|=0;return oe},R=t.__addimage__.validateStringAsBase64=function(I){(I=I||"").toString().trim();var L=!0;return I.length===0&&(L=!1),I.length%4!=0&&(L=!1),/^[A-Za-z0-9+/]+$/.test(I.substr(0,I.length-2))===!1&&(L=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(I.substr(-2))===!1&&(L=!1),L},H=t.__addimage__.extractImageFromDataUrl=function(I){if(I==null||!(I=I.trim()).startsWith("data:"))return null;var L=I.indexOf(",");return L<0?null:I.substring(0,L).trim().endsWith("base64")?I.substring(L+1):null};t.__addimage__.isArrayBuffer=function(I){return I instanceof ArrayBuffer};var z=t.__addimage__.isArrayBufferView=function(I){return I instanceof Int8Array||I instanceof Uint8Array||I instanceof Uint8ClampedArray||I instanceof Int16Array||I instanceof Uint16Array||I instanceof Int32Array||I instanceof Uint32Array||I instanceof Float32Array||I instanceof Float64Array},F=t.__addimage__.binaryStringToUint8Array=function(I){for(var L=I.length,ee=new Uint8Array(L),oe=0;oe<L;oe++)ee[oe]=I.charCodeAt(oe);return ee},W=t.__addimage__.arrayBufferToBinaryString=function(I){for(var L="",ee=z(I)?I:new Uint8Array(I),oe=0;oe<ee.length;oe+=8192)L+=String.fromCharCode.apply(null,ee.subarray(oe,oe+8192));return L};t.addImage=function(){var I,L,ee,oe,ge,ie,he,de,Z;if(typeof arguments[1]=="number"?(L=r,ee=arguments[1],oe=arguments[2],ge=arguments[3],ie=arguments[4],he=arguments[5],de=arguments[6],Z=arguments[7]):(L=arguments[1],ee=arguments[2],oe=arguments[3],ge=arguments[4],ie=arguments[5],he=arguments[6],de=arguments[7],Z=arguments[8]),ua(I=arguments[0])==="object"&&!y(I)&&"imageData"in I){var Ne=I;I=Ne.imageData,L=Ne.format||L||r,ee=Ne.x||ee||0,oe=Ne.y||oe||0,ge=Ne.w||Ne.width||ge,ie=Ne.h||Ne.height||ie,he=Ne.alias||he,de=Ne.compression||de,Z=Ne.rotation||Ne.angle||Z}var Q=this.internal.getFilters();if(de===void 0&&Q.indexOf("FlateEncode")!==-1&&(de="SLOW"),isNaN(ee)||isNaN(oe))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var N=D.call(this,I,L,he,de);return E.call(this,ee,oe,ge,ie,N,Z),this};var D=function(I,L,ee,oe){var ge,ie,he;if(typeof I=="string"&&n(I)===r){I=unescape(I);var de=Y(I,!1);(de!==""||(de=t.loadFile(I,!0))!==void 0)&&(I=de)}if(y(I)&&(I=g(I,L)),L=n(I,L),!v(L))throw new Error("addImage does not support files of type '"+L+"', please ensure that a plugin for '"+L+"' support is added.");if(((he=ee)==null||he.length===0)&&(ee=(function(Z){return typeof Z=="string"||z(Z)?T(Z):z(Z.data)?T(Z.data):null})(I)),(ge=b.call(this,ee))||(I instanceof Uint8Array||L==="RGBA"||(ie=I,I=F(I)),ge=this["process"+L.toUpperCase()](I,d.call(this),ee,(function(Z){return Z&&typeof Z=="string"&&(Z=Z.toUpperCase()),Z in t.image_compression?Z:O.NONE})(oe),ie)),!ge)throw new Error("An unknown error occurred whilst processing the image.");return ge},Y=t.__addimage__.convertBase64ToBinaryString=function(I,L){L=typeof L!="boolean"||L;var ee,oe="";if(typeof I=="string"){var ge;ee=(ge=H(I))!==null&&ge!==void 0?ge:I;try{oe=Q1(ee)}catch(ie){if(L)throw R(ee)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ie.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return oe};t.getImageProperties=function(I){var L,ee,oe="";if(y(I)&&(I=g(I)),typeof I=="string"&&n(I)===r&&((oe=Y(I,!1))===""&&(oe=t.loadFile(I)||""),I=oe),ee=n(I),!v(ee))throw new Error("addImage does not support files of type '"+ee+"', please ensure that a plugin for '"+ee+"' support is added.");if(I instanceof Uint8Array||(I=F(I)),!(L=this["process"+ee.toUpperCase()](I)))throw new Error("An unknown error occurred whilst processing the image");return L.fileType=ee,L}})(Jt.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};Jt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var a,n,i,o=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(r.objId),h=r.pageContext.annotations,d=!1,v=0;v<h.length&&!d;v++)switch((a=h[v]).type){case"link":(e(a.options.url)||e(a.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var y=0;y<h.length;y++){a=h[y];var g=this.internal.pdfEscape,b=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var w=this.internal.newAdditionalObject(),E=this.internal.newAdditionalObject(),A=this.internal.getEncryptor(w.objId),O=a.title||"Note";i="<</Type /Annot /Subtype /Text "+(n="/Rect ["+o(a.bounds.x)+" "+c(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y)+"] ")+"/Contents ("+g(A(a.contents))+")",i+=" /Popup "+E.objId+" 0 R",i+=" /P "+u.objId+" 0 R",i+=" /T ("+g(A(O))+") >>",w.content=i;var T=w.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+o(a.bounds.x+30)+" "+c(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w+30)+" "+c(a.bounds.y)+"] ")+" /Parent "+T,a.open&&(i+=" /Open true"),i+=" >>",E.content=i,this.internal.write(w.objId,"0 R",E.objId,"0 R");break;case"freetext":n="/Rect ["+o(a.bounds.x)+" "+c(a.bounds.y)+" "+o(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y+a.bounds.h)+"] ";var R=a.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+g(b(a.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+R+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(a.options.name){var H=this.annotations._nameMap[a.options.name];a.options.pageNumber=H.page,a.options.top=H.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",i="",a.options.url)i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+g(b(a.options.url))+") >>";else if(a.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,i+=" /FitV "+a.options.left+"]";break;default:var z=c(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),i+=" /XYZ "+a.options.left+" "+z+" "+a.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},t.link=function(r,a,n,i,o){var c=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:u(r),y:h(a),w:u(r+n),h:h(a+i)},options:o,type:"link"})},t.textWithLink=function(r,a,n,i){var o,c,u=this.getTextWidth(r),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){c=i.maxWidth;var d=this.splitTextToSize(r,c).length;o=Math.ceil(h*d)}else c=u,o=h;return this.text(r,a,n,i),n+=.2*h,i.align==="center"&&(a-=u/2),i.align==="right"&&(a-=u),this.link(a,n-h,c,o,i),u},t.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}})(Jt.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];t.__arabicParser__={};var i=t.__arabicParser__.isInArabicSubstitutionA=function(w){return e[w.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(w){return typeof w=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(w)},c=t.__arabicParser__.isArabicEndLetter=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length<=2},u=t.__arabicParser__.isArabicAlfLetter=function(w){return o(w)&&n.indexOf(w.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length>=1};var h=t.__arabicParser__.arabicLetterHasFinalForm=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length==4},v=t.__arabicParser__.resolveLigatures=function(w){var E=0,A=r,O="",T=0;for(E=0;E<w.length;E+=1)A[w.charCodeAt(E)]!==void 0?(T++,typeof(A=A[w.charCodeAt(E)])=="number"&&(O+=String.fromCharCode(A),A=r,T=0),E===w.length-1&&(A=r,O+=w.charAt(E-(T-1)),E-=T-1,T=0)):(A=r,O+=w.charAt(E-T),E-=T,T=0);return O};t.__arabicParser__.isArabicDiacritic=function(w){return w!==void 0&&a[w.charCodeAt(0)]!==void 0};var y=t.__arabicParser__.getCorrectForm=function(w,E,A){return o(w)?i(w)===!1?-1:!h(w)||!o(E)&&!o(A)||!o(A)&&c(E)||c(w)&&!o(E)||c(w)&&u(E)||c(w)&&c(E)?0:d(w)&&o(E)&&!c(E)&&o(A)&&h(A)?3:c(w)||!o(A)?1:2:-1},g=function(w){var E=0,A=0,O=0,T="",R="",H="",z=(w=w||"").split("\\s+"),F=[];for(E=0;E<z.length;E+=1){for(F.push(""),A=0;A<z[E].length;A+=1)T=z[E][A],R=z[E][A-1],H=z[E][A+1],o(T)?(O=y(T,R,H),F[E]+=O!==-1?String.fromCharCode(e[T.charCodeAt(0)][O]):T):F[E]+=T;F[E]=v(F[E])}return F.join(" ")},b=t.__arabicParser__.processArabic=t.processArabic=function(){var w,E=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,A=[];if(Array.isArray(E)){var O=0;for(A=[],O=0;O<E.length;O+=1)Array.isArray(E[O])?A.push([g(E[O][0]),E[O][1],E[O][2]]):A.push([g(E[O])]);w=A}else w=g(E);return typeof arguments[0]=="string"?w:(arguments[0].text=w,arguments[0])};t.events.push(["preProcessText",b])})(Jt.API),Jt.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(c){r=c}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(c){a=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(c){i=c}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(c){o=c}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(Jt.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(w){u=w}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(w){h=w}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(w){d=w}});var v=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return v},set:function(w){v=w}});var y=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return y},set:function(w){y=w}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(w){g=w}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(w){b=w}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(u){return a.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},t.getTextDimensions=function(u,h){a.call(this);var d=(h=h||{}).fontSize||this.getFontSize(),v=h.font||this.getFont(),y=h.scaleFactor||this.internal.scaleFactor,g=0,b=0,w=0,E=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var A=h.maxWidth;A>0?typeof u=="string"?u=this.splitTextToSize(u,A):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(T,R){return T.concat(E.splitTextToSize(R,A))},[])):u=Array.isArray(u)?u:[u];for(var O=0;O<u.length;O++)g<(w=this.getStringUnitWidth(u[O],{font:v})*d)&&(g=w);return g!==0&&(b=u.length),{w:g/=y,h:Math.max((b*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/y,0)}},t.cellAddPage=function(){a.call(this),this.addPage();var u=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var u;u=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),a.call(this);var h=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,v=this.internal.__cell__.margins||e,y=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===u.lineNumber?(u.x=(h.x||0)+(h.width||0),u.y=h.y||0):h.y+h.height+u.height+v.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=v.top,g&&y&&(this.printHeaderRow(u.lineNumber,!0),u.y+=y[0].height)):u.y=h.y+h.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,r===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-d,u.y+d,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+d,{align:"center",baseline:"top",maxWidth:u.width-d-d}):this.text(u.text,u.x+d,u.y+d,{align:"left",baseline:"top",maxWidth:u.width-d-d})),this.internal.__cell__.lastCell=u,this};t.table=function(u,h,d,v,y){if(a.call(this),!d)throw new Error("No data for PDF table.");var g,b,w,E,A=[],O=[],T=[],R={},H={},z=[],F=[],W=(y=y||{}).autoSize||!1,D=y.printHeaders!==!1,Y=y.css&&y.css["font-size"]!==void 0?16*y.css["font-size"]:y.fontSize||12,I=y.margins||Object.assign({width:this.getPageWidth()},e),L=typeof y.padding=="number"?y.padding:3,ee=y.headerBackgroundColor||"#c8c8c8",oe=y.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=D,this.internal.__cell__.margins=I,this.internal.__cell__.table_font_size=Y,this.internal.__cell__.padding=L,this.internal.__cell__.headerBackgroundColor=ee,this.internal.__cell__.headerTextColor=oe,this.setFontSize(Y),v==null)O=A=Object.keys(d[0]),T=A.map(function(){return"left"});else if(Array.isArray(v)&&ua(v[0])==="object")for(A=v.map(function(Ne){return Ne.name}),O=v.map(function(Ne){return Ne.prompt||Ne.name||""}),T=v.map(function(Ne){return Ne.align||"left"}),g=0;g<v.length;g+=1)H[v[g].name]=.7499990551181103*v[g].width;else Array.isArray(v)&&typeof v[0]=="string"&&(O=A=v,T=A.map(function(){return"left"}));if(W||Array.isArray(v)&&typeof v[0]=="string")for(g=0;g<A.length;g+=1){for(R[E=A[g]]=d.map(function(Ne){return Ne[E]}),this.setFont(void 0,"bold"),z.push(this.getTextDimensions(O[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=R[E],this.setFont(void 0,"normal"),w=0;w<b.length;w+=1)z.push(this.getTextDimensions(b[w],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);H[E]=Math.max.apply(null,z)+L+L,z=[]}if(D){var ge={};for(g=0;g<A.length;g+=1)ge[A[g]]={},ge[A[g]].text=O[g],ge[A[g]].align=T[g];var ie=c.call(this,ge,H);F=A.map(function(Ne){return new i(u,h,H[Ne],ie,ge[Ne].text,void 0,ge[Ne].align)}),this.setTableHeaderRow(F),this.printHeaderRow(1,!1)}var he=v.reduce(function(Ne,Q){return Ne[Q.name]=Q.align,Ne},{});for(g=0;g<d.length;g+=1){"rowStart"in y&&y.rowStart instanceof Function&&y.rowStart({row:g,data:d[g]},this);var de=c.call(this,d[g],H);for(w=0;w<A.length;w+=1){var Z=d[g][A[w]];"cellStart"in y&&y.cellStart instanceof Function&&y.cellStart({row:g,col:w,data:Z},this),o.call(this,new i(u,h,H[A[w]],de,Z,g+2,he[A[w]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=h,this};var c=function(u,h){var d=this.internal.__cell__.padding,v=this.internal.__cell__.table_font_size,y=this.internal.scaleFactor;return Object.keys(u).map(function(g){var b=u[g];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,h[g]-d-d)},this).map(function(g){return this.getLineHeightFactor()*g.length*v/y+d+d},this).reduce(function(g,b){return Math.max(g,b)},0)};t.setTableHeaderRow=function(u){a.call(this),this.internal.__cell__.tableHeaderRow=u},t.printHeaderRow=function(u,h){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var v=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(v[0],v[1],v[2],v[3],void 0,-1)}this.setFont(void 0,"bold");for(var y=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){d=this.internal.__cell__.tableHeaderRow[g].clone(),h&&(d.y=this.internal.__cell__.margins.top||0,y.push(d)),d.lineNumber=u;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(b)}y.length>0&&this.setTableHeaderRow(y),this.setFont(void 0,"normal"),r=!1}})(Jt.API);var EE={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},kE=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Hv=SE(kE),AE=[100,200,300,400,500,600,700,800,900],hB=SE(AE);function Yg(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(i){return EE[i=i||"normal"]?i:"normal"})(t.style),a=(function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400})(t.weight),n=(function(i){return typeof Hv[i=i||"normal"]=="number"?i:"normal"})(t.stretch);return{family:e,style:r,weight:a,stretch:n,src:t.src||[],ref:t.ref||{name:e,style:[n,r,a].join(" ")}}}function J5(t,e,r,a){var n;for(n=r;n>=0&&n<e.length;n+=a)if(t[e[n]])return t[e[n]];for(n=r;n>=0&&n<e.length;n-=a)if(t[e[n]])return t[e[n]]}var dB={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Z5={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Q5(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function eb(t){return t.trimLeft()}function pB(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function mB(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var X1,tb,rb,gh,Y1,ab,nb,ib,Kg=["times"];function sb(t,e,r,a,n){var i=4,o=lb;switch(n){case Jt.API.image_compression.FAST:i=1,o=ob;break;case Jt.API.image_compression.MEDIUM:i=6,o=cb;break;case Jt.API.image_compression.SLOW:i=9,o=ub}t=(function(u,h,d,v){for(var y,g=u.length/h,b=new Uint8Array(u.length+g),w=[gB,ob,lb,cb,ub],E=0;E<g;E+=1){var A=E*h,O=u.subarray(A,A+h);if(v)b.set(v(O,d,y),A+E);else{for(var T=w.length,R=[],H=0;H<T;H+=1)R[H]=w[H](O,d,y);var z=xB(R.concat());b.set(R[z],A+E)}y=O}return b})(t,e,Math.ceil(r*a/8),o);var c=Pv(t,{level:i});return Jt.API.__addimage__.arrayBufferToBinaryString(c)}function gB(t){var e=Array.apply([],t);return e.unshift(0),e}function ob(t,e){var r=t.length,a=[];a[0]=1;for(var n=0;n<r;n+=1){var i=t[n-e]||0;a[n+1]=t[n]-i+256&255}return a}function lb(t,e,r){var a=t.length,n=[];n[0]=2;for(var i=0;i<a;i+=1){var o=r&&r[i]||0;n[i+1]=t[i]-o+256&255}return n}function cb(t,e,r){var a=t.length,n=[];n[0]=3;for(var i=0;i<a;i+=1){var o=t[i-e]||0,c=r&&r[i]||0;n[i+1]=t[i]+256-(o+c>>>1)&255}return n}function ub(t,e,r){var a=t.length,n=[];n[0]=4;for(var i=0;i<a;i+=1){var o=vB(t[i-e]||0,r&&r[i]||0,r&&r[i-e]||0);n[i+1]=t[i]-o+256&255}return n}function vB(t,e,r){if(t===e&&e===r)return t;var a=Math.abs(e-r),n=Math.abs(t-r),i=Math.abs(t+e-r-r);return a<=n&&a<=i?t:n<=i?e:r}function xB(t){var e=t.map(function(r){return r.reduce(function(a,n){return a+Math.abs(n)},0)});return e.indexOf(Math.min.apply(null,e))}function Jg(t,e,r){var a=e*r,n=Math.floor(a/8),i=16-(a-8*n+r),o=(1<<r)-1;return NE(t,n)>>i&o}function fb(t,e,r,a){var n=r*a,i=Math.floor(n/8),o=16-(n-8*i+a),c=(1<<a)-1,u=(e&c)<<o;(function(h,d,v){if(d+1<h.byteLength)h.setUint16(d,v,!1);else{var y=v>>8&255;h.setUint8(d,y)}})(t,i,NE(t,i)&~(c<<o)&65535|u)}function NE(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function yB(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,a=t[e++]|t[e++]<<8,n=t[e++],i=n>>7,o=1<<1+(7&n);t[e++],t[e++];var c=null,u=null;i&&(c=e,u=o,e+=3*o);var h=!0,d=[],v=0,y=null,g=0,b=null;for(this.width=r,this.height=a;h&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,b=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var w=t[e++];v=t[e++]|t[e++]<<8,y=t[e++],1&w||(y=null),g=w>>2&7,e++;break;case 254:for(;;){if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var E=t[e++]|t[e++]<<8,A=t[e++]|t[e++]<<8,O=t[e++]|t[e++]<<8,T=t[e++]|t[e++]<<8,R=t[e++],H=R>>6&1,z=1<<1+(7&R),F=c,W=u,D=!1;R>>7&&(D=!0,F=e,W=z,e+=3*z);var Y=e;for(e++;;){var I;if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}d.push({x:E,y:A,width:O,height:T,has_local_palette:D,palette_offset:F,palette_size:W,data_offset:Y,data_length:e-Y,transparent_index:y,interlaced:!!H,delay:v,disposal:g});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return b},this.frameInfo=function(L){if(L<0||L>=d.length)throw new Error("Frame index out of range.");return d[L]},this.decodeAndBlitFrameBGRA=function(L,ee){var oe=this.frameInfo(L),ge=oe.width*oe.height,ie=new Uint8Array(ge);hb(t,oe.data_offset,ie,ge);var he=oe.palette_offset,de=oe.transparent_index;de===null&&(de=256);var Z=oe.width,Ne=r-Z,Q=Z,N=4*(oe.y*r+oe.x),M=4*((oe.y+oe.height)*r+oe.x),B=N,q=4*Ne;oe.interlaced===!0&&(q+=4*r*7);for(var K=8,se=0,me=ie.length;se<me;++se){var we=ie[se];if(Q===0&&(Q=Z,(B+=q)>=M&&(q=4*Ne+4*r*(K-1),B=N+(Z+Ne)*(K<<1),K>>=1)),we===de)B+=4;else{var Se=t[he+3*we],Ee=t[he+3*we+1],ae=t[he+3*we+2];ee[B++]=ae,ee[B++]=Ee,ee[B++]=Se,ee[B++]=255}--Q}},this.decodeAndBlitFrameRGBA=function(L,ee){var oe=this.frameInfo(L),ge=oe.width*oe.height,ie=new Uint8Array(ge);hb(t,oe.data_offset,ie,ge);var he=oe.palette_offset,de=oe.transparent_index;de===null&&(de=256);var Z=oe.width,Ne=r-Z,Q=Z,N=4*(oe.y*r+oe.x),M=4*((oe.y+oe.height)*r+oe.x),B=N,q=4*Ne;oe.interlaced===!0&&(q+=4*r*7);for(var K=8,se=0,me=ie.length;se<me;++se){var we=ie[se];if(Q===0&&(Q=Z,(B+=q)>=M&&(q=4*Ne+4*r*(K-1),B=N+(Z+Ne)*(K<<1),K>>=1)),we===de)B+=4;else{var Se=t[he+3*we],Ee=t[he+3*we+1],ae=t[he+3*we+2];ee[B++]=Se,ee[B++]=Ee,ee[B++]=ae,ee[B++]=255}--Q}}}function hb(t,e,r,a){for(var n=t[e++],i=1<<n,o=i+1,c=o+1,u=n+1,h=(1<<u)-1,d=0,v=0,y=0,g=t[e++],b=new Int32Array(4096),w=null;;){for(;d<16&&g!==0;)v|=t[e++]<<d,d+=8,g===1?g=t[e++]:--g;if(d<u)break;var E=v&h;if(v>>=u,d-=u,E!==i){if(E===o)break;for(var A=E<c?E:w,O=0,T=A;T>i;)T=b[T]>>8,++O;var R=T;if(y+O+(A!==E?1:0)>a)return void Sa.log("Warning, gif stream longer than expected.");r[y++]=R;var H=y+=O;for(A!==E&&(r[y++]=R),T=A;O--;)T=b[T],r[--H]=255&T,T>>=8;w!==null&&c<4096&&(b[c++]=w<<8|R,c>=h+1&&u<12&&(++u,h=h<<1|1)),w=E}else c=o+1,h=(1<<(u=n+1))-1,w=null}return y!==a&&Sa.log("Warning, gif stream shorter than expected."),r}function Zg(t){var e,r,a,n,i,o=Math.floor,c=new Array(64),u=new Array(64),h=new Array(64),d=new Array(64),v=new Array(65535),y=new Array(65535),g=new Array(64),b=new Array(64),w=[],E=0,A=7,O=new Array(64),T=new Array(64),R=new Array(64),H=new Array(256),z=new Array(2048),F=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],W=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],D=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],I=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],L=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],ee=[0,1,2,3,4,5,6,7,8,9,10,11],oe=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ge=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ie(N,M){for(var B=0,q=0,K=new Array,se=1;se<=16;se++){for(var me=1;me<=N[se];me++)K[M[q]]=[],K[M[q]][0]=B,K[M[q]][1]=se,q++,B++;B*=2}return K}function he(N){for(var M=N[0],B=N[1]-1;B>=0;)M&1<<B&&(E|=1<<A),B--,--A<0&&(E==255?(de(255),de(0)):de(E),A=7,E=0)}function de(N){w.push(N)}function Z(N){de(N>>8&255),de(255&N)}function Ne(N,M,B,q,K){for(var se,me=K[0],we=K[240],Se=(function(et,wt){var vt,Ct,Et,It,er,Vt,Oe,Ye,He,ct,mt=0;for(He=0;He<8;++He){vt=et[mt],Ct=et[mt+1],Et=et[mt+2],It=et[mt+3],er=et[mt+4],Vt=et[mt+5],Oe=et[mt+6];var Ht=vt+(Ye=et[mt+7]),Rt=vt-Ye,Wt=Ct+Oe,nr=Ct-Oe,br=Et+Vt,Yt=Et-Vt,Wr=It+er,Zt=It-er,ir=Ht+Wr,Vr=Ht-Wr,pr=Wt+br,Dt=Wt-br;et[mt]=ir+pr,et[mt+4]=ir-pr;var Tr=.707106781*(Dt+Vr);et[mt+2]=Vr+Tr,et[mt+6]=Vr-Tr;var Qn=.382683433*((ir=Zt+Yt)-(Dt=nr+Rt)),Ka=.5411961*ir+Qn,_t=1.306562965*Dt+Qn,Ja=.707106781*(pr=Yt+nr),Kt=Rt+Ja,fs=Rt-Ja;et[mt+5]=fs+Ka,et[mt+3]=fs-Ka,et[mt+1]=Kt+_t,et[mt+7]=Kt-_t,mt+=8}for(mt=0,He=0;He<8;++He){vt=et[mt],Ct=et[mt+8],Et=et[mt+16],It=et[mt+24],er=et[mt+32],Vt=et[mt+40],Oe=et[mt+48];var zi=vt+(Ye=et[mt+56]),On=vt-Ye,ei=Ct+Oe,ha=Ct-Oe,Da=Et+Vt,J=Et-Vt,ye=It+er,ce=It-er,ue=zi+ye,pe=zi-ye,be=ei+Da,Be=ei-Da;et[mt]=ue+be,et[mt+32]=ue-be;var Qe=.707106781*(Be+pe);et[mt+16]=pe+Qe,et[mt+48]=pe-Qe;var qe=.382683433*((ue=ce+J)-(Be=ha+On)),ze=.5411961*ue+qe,Ve=1.306562965*Be+qe,pt=.707106781*(be=J+ha),bt=On+pt,Tt=On-pt;et[mt+40]=Tt+ze,et[mt+24]=Tt-ze,et[mt+8]=bt+Ve,et[mt+56]=bt-Ve,mt++}for(He=0;He<64;++He)ct=et[He]*wt[He],g[He]=ct>0?ct+.5|0:ct-.5|0;return g})(N,M),Ee=0;Ee<64;++Ee)b[F[Ee]]=Se[Ee];var ae=b[0]-B;B=b[0],ae==0?he(q[0]):(he(q[y[se=32767+ae]]),he(v[se]));for(var rt=63;rt>0&&b[rt]==0;)rt--;if(rt==0)return he(me),B;for(var Je,V=1;V<=rt;){for(var Ie=V;b[V]==0&&V<=rt;)++V;var Le=V-Ie;if(Le>=16){Je=Le>>4;for(var gt=1;gt<=Je;++gt)he(we);Le&=15}se=32767+b[V],he(K[(Le<<4)+y[se]]),he(v[se]),V++}return rt!=63&&he(me),B}function Q(N){N=Math.min(Math.max(N,1),100),i!=N&&((function(M){for(var B=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],q=0;q<64;q++){var K=o((B[q]*M+50)/100);K=Math.min(Math.max(K,1),255),c[F[q]]=K}for(var se=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],me=0;me<64;me++){var we=o((se[me]*M+50)/100);we=Math.min(Math.max(we,1),255),u[F[me]]=we}for(var Se=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ee=0,ae=0;ae<8;ae++)for(var rt=0;rt<8;rt++)h[Ee]=1/(c[F[Ee]]*Se[ae]*Se[rt]*8),d[Ee]=1/(u[F[Ee]]*Se[ae]*Se[rt]*8),Ee++})(N<50?Math.floor(5e3/N):Math.floor(200-2*N)),i=N)}this.encode=function(N,M){M&&Q(M),w=new Array,E=0,A=7,Z(65496),Z(65504),Z(16),de(74),de(70),de(73),de(70),de(0),de(1),de(1),de(0),Z(1),Z(1),de(0),de(0),(function(){Z(65499),Z(132),de(0);for(var Ct=0;Ct<64;Ct++)de(c[Ct]);de(1);for(var Et=0;Et<64;Et++)de(u[Et])})(),(function(Ct,Et){Z(65472),Z(17),de(8),Z(Et),Z(Ct),de(3),de(1),de(17),de(0),de(2),de(17),de(1),de(3),de(17),de(1)})(N.width,N.height),(function(){Z(65476),Z(418),de(0);for(var Ct=0;Ct<16;Ct++)de(W[Ct+1]);for(var Et=0;Et<=11;Et++)de(D[Et]);de(16);for(var It=0;It<16;It++)de(Y[It+1]);for(var er=0;er<=161;er++)de(I[er]);de(1);for(var Vt=0;Vt<16;Vt++)de(L[Vt+1]);for(var Oe=0;Oe<=11;Oe++)de(ee[Oe]);de(17);for(var Ye=0;Ye<16;Ye++)de(oe[Ye+1]);for(var He=0;He<=161;He++)de(ge[He])})(),Z(65498),Z(12),de(3),de(1),de(0),de(2),de(17),de(3),de(17),de(0),de(63),de(0);var B=0,q=0,K=0;E=0,A=7,this.encode.displayName="_encode_";for(var se,me,we,Se,Ee,ae,rt,Je,V,Ie=N.data,Le=N.width,gt=N.height,et=4*Le,wt=0;wt<gt;){for(se=0;se<et;){for(Ee=et*wt+se,rt=-1,Je=0,V=0;V<64;V++)ae=Ee+(Je=V>>3)*et+(rt=4*(7&V)),wt+Je>=gt&&(ae-=et*(wt+1+Je-gt)),se+rt>=et&&(ae-=se+rt-et+4),me=Ie[ae++],we=Ie[ae++],Se=Ie[ae++],O[V]=(z[me]+z[we+256|0]+z[Se+512|0]>>16)-128,T[V]=(z[me+768|0]+z[we+1024|0]+z[Se+1280|0]>>16)-128,R[V]=(z[me+1280|0]+z[we+1536|0]+z[Se+1792|0]>>16)-128;B=Ne(O,h,B,e,a),q=Ne(T,d,q,r,n),K=Ne(R,d,K,r,n),se+=32}wt+=8}if(A>=0){var vt=[];vt[1]=A+1,vt[0]=(1<<A+1)-1,he(vt)}return Z(65497),new Uint8Array(w)},t=t||50,(function(){for(var N=String.fromCharCode,M=0;M<256;M++)H[M]=N(M)})(),e=ie(W,D),r=ie(L,ee),a=ie(Y,I),n=ie(oe,ge),(function(){for(var N=1,M=2,B=1;B<=15;B++){for(var q=N;q<M;q++)y[32767+q]=B,v[32767+q]=[],v[32767+q][1]=B,v[32767+q][0]=q;for(var K=-(M-1);K<=-N;K++)y[32767+K]=B,v[32767+K]=[],v[32767+K][1]=B,v[32767+K][0]=M-1+K;N<<=1,M<<=1}})(),(function(){for(var N=0;N<256;N++)z[N]=19595*N,z[N+256|0]=38470*N,z[N+512|0]=7471*N+32768,z[N+768|0]=-11059*N,z[N+1024|0]=-21709*N,z[N+1280|0]=32768*N+8421375,z[N+1536|0]=-27439*N,z[N+1792|0]=-5329*N})(),Q(t)}function Po(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function db(t){function e(D){if(!D)throw Error("assert :P")}function r(D,Y,I){for(var L=0;4>L;L++)if(D[Y+L]!=I.charCodeAt(L))return!0;return!1}function a(D,Y,I,L,ee){for(var oe=0;oe<ee;oe++)D[Y+oe]=I[L+oe]}function n(D,Y,I,L){for(var ee=0;ee<L;ee++)D[Y+ee]=I}function i(D){return new Int32Array(D)}function o(D,Y){for(var I=[],L=0;L<D;L++)I.push(new Y);return I}function c(D,Y){var I=[];return(function L(ee,oe,ge){for(var ie=ge[oe],he=0;he<ie&&(ee.push(ge.length>oe+1?[]:new Y),!(ge.length<oe+1));he++)L(ee[he],oe+1,ge)})(I,0,D),I}var u=function(){var D=this;function Y(x,S){for(var C=1<<S-1>>>0;x&C;)C>>>=1;return C?(x&C-1)+C:x}function I(x,S,C,P,X){e(!(P%C));do x[S+(P-=C)]=X;while(0<P)}function L(x,S,C,P,X){if(e(2328>=X),512>=X)var te=i(512);else if((te=i(X))==null)return 0;return(function(re,le,fe,xe,je,We){var ve,Fe,Me=le,at=1<<fe,Ue=i(16),tt=i(16);for(e(je!=0),e(xe!=null),e(re!=null),e(0<fe),Fe=0;Fe<je;++Fe){if(15<xe[Fe])return 0;++Ue[xe[Fe]]}if(Ue[0]==je)return 0;for(tt[1]=0,ve=1;15>ve;++ve){if(Ue[ve]>1<<ve)return 0;tt[ve+1]=tt[ve]+Ue[ve]}for(Fe=0;Fe<je;++Fe)ve=xe[Fe],0<xe[Fe]&&(We[tt[ve]++]=Fe);if(tt[15]==1)return(xe=new ee).g=0,xe.value=We[0],I(re,Me,1,at,xe),at;var ot,xt=-1,ft=at-1,qt=0,Ot=1,mr=1,Pt=1<<fe;for(Fe=0,ve=1,je=2;ve<=fe;++ve,je<<=1){if(Ot+=mr<<=1,0>(mr-=Ue[ve]))return 0;for(;0<Ue[ve];--Ue[ve])(xe=new ee).g=ve,xe.value=We[Fe++],I(re,Me+qt,je,Pt,xe),qt=Y(qt,ve)}for(ve=fe+1,je=2;15>=ve;++ve,je<<=1){if(Ot+=mr<<=1,0>(mr-=Ue[ve]))return 0;for(;0<Ue[ve];--Ue[ve]){if(xe=new ee,(qt&ft)!=xt){for(Me+=Pt,ot=1<<(xt=ve)-fe;15>xt&&!(0>=(ot-=Ue[xt]));)++xt,ot<<=1;at+=Pt=1<<(ot=xt-fe),re[le+(xt=qt&ft)].g=ot+fe,re[le+xt].value=Me-le-xt}xe.g=ve-fe,xe.value=We[Fe++],I(re,Me+(qt>>fe),je,Pt,xe),qt=Y(qt,ve)}}return Ot!=2*tt[15]-1?0:at})(x,S,C,P,X,te)}function ee(){this.value=this.g=0}function oe(){this.value=this.g=0}function ge(){this.G=o(5,ee),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Zo,oe)}function ie(x,S,C,P){e(x!=null),e(S!=null),e(2147483648>P),x.Ca=254,x.I=0,x.b=-8,x.Ka=0,x.oa=S,x.pa=C,x.Jd=S,x.Yc=C+P,x.Zc=4<=P?C+P-4+1:C,me(x)}function he(x,S){for(var C=0;0<S--;)C|=Se(x,128)<<S;return C}function de(x,S){var C=he(x,S);return we(x)?-C:C}function Z(x,S,C,P){var X,te=0;for(e(x!=null),e(S!=null),e(4294967288>P),x.Sb=P,x.Ra=0,x.u=0,x.h=0,4<P&&(P=4),X=0;X<P;++X)te+=S[C+X]<<8*X;x.Ra=te,x.bb=P,x.oa=S,x.pa=C}function Ne(x){for(;8<=x.u&&x.bb<x.Sb;)x.Ra>>>=8,x.Ra+=x.oa[x.pa+x.bb]<<Us-8>>>0,++x.bb,x.u-=8;q(x)&&(x.h=1,x.u=0)}function Q(x,S){if(e(0<=S),!x.h&&S<=ii){var C=B(x)&gi[S];return x.u+=S,Ne(x),C}return x.h=1,x.u=0}function N(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function M(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function B(x){return x.Ra>>>(x.u&Us-1)>>>0}function q(x){return e(x.bb<=x.Sb),x.h||x.bb==x.Sb&&x.u>Us}function K(x,S){x.u=S,x.h=q(x)}function se(x){x.u>=qs&&(e(x.u>=qs),Ne(x))}function me(x){e(x!=null&&x.oa!=null),x.pa<x.Zc?(x.I=(x.oa[x.pa++]|x.I<<8)>>>0,x.b+=8):(e(x!=null&&x.oa!=null),x.pa<x.Yc?(x.b+=8,x.I=x.oa[x.pa++]|x.I<<8):x.Ka?x.b=0:(x.I<<=8,x.b+=8,x.Ka=1))}function we(x){return he(x,1)}function Se(x,S){var C=x.Ca;0>x.b&&me(x);var P=x.b,X=C*S>>>8,te=(x.I>>>P>X)+0;for(te?(C-=X,x.I-=X+1<<P>>>0):C=X+1,P=C,X=0;256<=P;)X+=8,P>>=8;return P=7^X+bo[P],x.b-=P,x.Ca=(C<<P)-1,te}function Ee(x,S,C){x[S+0]=C>>24&255,x[S+1]=C>>16&255,x[S+2]=C>>8&255,x[S+3]=255&C}function ae(x,S){return x[S+0]|x[S+1]<<8}function rt(x,S){return ae(x,S)|x[S+2]<<16}function Je(x,S){return ae(x,S)|ae(x,S+2)<<16}function V(x,S){var C=1<<S;return e(x!=null),e(0<S),x.X=i(C),x.X==null?0:(x.Mb=32-S,x.Xa=S,1)}function Ie(x,S){e(x!=null),e(S!=null),e(x.Xa==S.Xa),a(S.X,0,x.X,0,1<<S.Xa)}function Le(){this.X=[],this.Xa=this.Mb=0}function gt(x,S,C,P){e(C!=null),e(P!=null);var X=C[0],te=P[0];return X==0&&(X=(x*te+S/2)/S),te==0&&(te=(S*X+x/2)/x),0>=X||0>=te?0:(C[0]=X,P[0]=te,1)}function et(x,S){return x+(1<<S)-1>>>S}function wt(x,S){return((4278255360&x)+(4278255360&S)>>>0&4278255360)+((16711935&x)+(16711935&S)>>>0&16711935)>>>0}function vt(x,S){D[S]=function(C,P,X,te,re,le,fe){var xe;for(xe=0;xe<re;++xe){var je=D[x](le[fe+xe-1],X,te+xe);le[fe+xe]=wt(C[P+xe],je)}}}function Ct(){this.ud=this.hd=this.jd=0}function Et(x,S){return((4278124286&(x^S))>>>1)+(x&S)>>>0}function It(x){return 0<=x&&256>x?x:0>x?0:255<x?255:void 0}function er(x,S){return It(x+(x-S+.5>>1))}function Vt(x,S,C){return Math.abs(S-C)-Math.abs(x-C)}function Oe(x,S,C,P,X,te,re){for(P=te[re-1],C=0;C<X;++C)te[re+C]=P=wt(x[S+C],P)}function Ye(x,S,C,P,X){var te;for(te=0;te<C;++te){var re=x[S+te],le=re>>8&255,fe=16711935&(fe=(fe=16711935&re)+((le<<16)+le));P[X+te]=(4278255360&re)+fe>>>0}}function He(x,S){S.jd=255&x,S.hd=x>>8&255,S.ud=x>>16&255}function ct(x,S,C,P,X,te){var re;for(re=0;re<P;++re){var le=S[C+re],fe=le>>>8,xe=le,je=255&(je=(je=le>>>16)+((x.jd<<24>>24)*(fe<<24>>24)>>>5));xe=255&(xe=(xe+=(x.hd<<24>>24)*(fe<<24>>24)>>>5)+((x.ud<<24>>24)*(je<<24>>24)>>>5)),X[te+re]=(4278255360&le)+(je<<16)+xe}}function mt(x,S,C,P,X){D[S]=function(te,re,le,fe,xe,je,We,ve,Fe){for(fe=We;fe<ve;++fe)for(We=0;We<Fe;++We)xe[je++]=X(le[P(te[re++])])},D[x]=function(te,re,le,fe,xe,je,We){var ve=8>>te.b,Fe=te.Ea,Me=te.K[0],at=te.w;if(8>ve)for(te=(1<<te.b)-1,at=(1<<ve)-1;re<le;++re){var Ue,tt=0;for(Ue=0;Ue<Fe;++Ue)Ue&te||(tt=P(fe[xe++])),je[We++]=X(Me[tt&at]),tt>>=ve}else D["VP8LMapColor"+C](fe,xe,Me,at,je,We,re,le,Fe)}}function Ht(x,S,C,P,X){for(C=S+C;S<C;){var te=x[S++];P[X++]=te>>16&255,P[X++]=te>>8&255,P[X++]=255&te}}function Rt(x,S,C,P,X){for(C=S+C;S<C;){var te=x[S++];P[X++]=te>>16&255,P[X++]=te>>8&255,P[X++]=255&te,P[X++]=te>>24&255}}function Wt(x,S,C,P,X){for(C=S+C;S<C;){var te=(re=x[S++])>>16&240|re>>12&15,re=240&re|re>>28&15;P[X++]=te,P[X++]=re}}function nr(x,S,C,P,X){for(C=S+C;S<C;){var te=(re=x[S++])>>16&248|re>>13&7,re=re>>5&224|re>>3&31;P[X++]=te,P[X++]=re}}function br(x,S,C,P,X){for(C=S+C;S<C;){var te=x[S++];P[X++]=255&te,P[X++]=te>>8&255,P[X++]=te>>16&255}}function Yt(x,S,C,P,X,te){if(te==0)for(C=S+C;S<C;)Ee(P,((te=x[S++])[0]>>24|te[1]>>8&65280|te[2]<<8&16711680|te[3]<<24)>>>0),X+=32;else a(P,X,x,S,C)}function Wr(x,S){D[S][0]=D[x+"0"],D[S][1]=D[x+"1"],D[S][2]=D[x+"2"],D[S][3]=D[x+"3"],D[S][4]=D[x+"4"],D[S][5]=D[x+"5"],D[S][6]=D[x+"6"],D[S][7]=D[x+"7"],D[S][8]=D[x+"8"],D[S][9]=D[x+"9"],D[S][10]=D[x+"10"],D[S][11]=D[x+"11"],D[S][12]=D[x+"12"],D[S][13]=D[x+"13"],D[S][14]=D[x+"0"],D[S][15]=D[x+"0"]}function Zt(x){return x==Nu||x==Ff||x==bc||x==Rf}function ir(){this.eb=[],this.size=this.A=this.fb=0}function Vr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function pr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ir,this.f.kb=new Vr,this.sd=null}function Dt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Tr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Qn(x){return alert("todo:WebPSamplerProcessPlane"),x.T}function Ka(x,S){var C=x.T,P=S.ba.f.RGBA,X=P.eb,te=P.fb+x.ka*P.A,re=Mn[S.ba.S],le=x.y,fe=x.O,xe=x.f,je=x.N,We=x.ea,ve=x.W,Fe=S.cc,Me=S.dc,at=S.Mc,Ue=S.Nc,tt=x.ka,ot=x.ka+x.T,xt=x.U,ft=xt+1>>1;for(tt==0?re(le,fe,null,null,xe,je,We,ve,xe,je,We,ve,X,te,null,null,xt):(re(S.ec,S.fc,le,fe,Fe,Me,at,Ue,xe,je,We,ve,X,te-P.A,X,te,xt),++C);tt+2<ot;tt+=2)Fe=xe,Me=je,at=We,Ue=ve,je+=x.Rc,ve+=x.Rc,te+=2*P.A,re(le,(fe+=2*x.fa)-x.fa,le,fe,Fe,Me,at,Ue,xe,je,We,ve,X,te-P.A,X,te,xt);return fe+=x.fa,x.j+ot<x.o?(a(S.ec,S.fc,le,fe,xt),a(S.cc,S.dc,xe,je,ft),a(S.Mc,S.Nc,We,ve,ft),C--):1&ot||re(le,fe,null,null,xe,je,We,ve,xe,je,We,ve,X,te+P.A,null,null,xt),C}function _t(x,S,C){var P=x.F,X=[x.J];if(P!=null){var te=x.U,re=S.ba.S,le=re==Au||re==bc;S=S.ba.f.RGBA;var fe=[0],xe=x.ka;fe[0]=x.T,x.Kb&&(xe==0?--fe[0]:(--xe,X[0]-=x.width),x.j+x.ka+x.T==x.o&&(fe[0]=x.o-x.j-xe));var je=S.eb;xe=S.fb+xe*S.A,x=bu(P,X[0],x.width,te,fe,je,xe+(le?0:3),S.A),e(C==fe),x&&Zt(re)&&Rl(je,xe,le,te,fe,S.A)}return 0}function Ja(x){var S=x.ma,C=S.ba.S,P=11>C,X=C==Vn||C==$i||C==Au||C==wc||C==12||Zt(C);if(S.memory=null,S.Ib=null,S.Jb=null,S.Nd=null,!wo(S.Oa,x,X?11:12))return 0;if(X&&Zt(C)&&xu(),x.da)alert("todo:use_scaling");else{if(P){if(S.Ib=Qn,x.Kb){if(C=x.U+1>>1,S.memory=i(x.U+2*C),S.memory==null)return 0;S.ec=S.memory,S.fc=0,S.cc=S.ec,S.dc=S.fc+x.U,S.Mc=S.cc,S.Nc=S.dc+C,S.Ib=Ka,xu()}}else alert("todo:EmitYUV");X&&(S.Jb=_t,P&&vs())}if(P&&!il){for(x=0;256>x;++x)In[x]=89858*(x-128)+kc>>Qi,$p[x]=-22014*(x-128)+kc,Fd[x]=-45773*(x-128),If[x]=113618*(x-128)+kc>>Qi;for(x=Ml;x<nl;++x)S=76283*(x-16)+kc>>Qi,Xp[x-Ml]=ka(S,255),Yp[x-Ml]=ka(S+8>>4,15);il=1}return 1}function Kt(x){var S=x.ma,C=x.U,P=x.T;return e(!(1&x.ka)),0>=C||0>=P?0:(C=S.Ib(x,S),S.Jb!=null&&S.Jb(x,S,C),S.Dc+=C,1)}function fs(x){x.ma.memory=null}function zi(x,S,C,P){return Q(x,8)!=47?0:(S[0]=Q(x,14)+1,C[0]=Q(x,14)+1,P[0]=Q(x,1),Q(x,3)!=0?0:!x.h)}function On(x,S){if(4>x)return x+1;var C=x-2>>1;return(2+(1&x)<<C)+Q(S,C)+1}function ei(x,S){return 120<S?S-120:1<=(C=((C=Yi[S-1])>>4)*x+(8-(15&C)))?C:1;var C}function ha(x,S,C){var P=B(C),X=x[S+=255&P].g-8;return 0<X&&(K(C,C.u+8),P=B(C),S+=x[S].value,S+=P&(1<<X)-1),K(C,C.u+x[S].g),x[S].value}function Da(x,S,C){return C.g+=x.g,C.value+=x.value<<S>>>0,e(8>=C.g),x.g}function J(x,S,C){var P=x.xc;return e((S=P==0?0:x.vc[x.md*(C>>P)+(S>>P)])<x.Wb),x.Ya[S]}function ye(x,S,C,P){var X=x.ab,te=x.c*S,re=x.C;S=re+S;var le=C,fe=P;for(P=x.Ta,C=x.Ua;0<X--;){var xe=x.gc[X],je=re,We=S,ve=le,Fe=fe,Me=(fe=P,le=C,xe.Ea);switch(e(je<We),e(We<=xe.nc),xe.hc){case 2:za(ve,Fe,(We-je)*Me,fe,le);break;case 0:var at=je,Ue=We,tt=fe,ot=le,xt=(Pt=xe).Ea;at==0&&(vc(ve,Fe,null,null,1,tt,ot),Oe(ve,Fe+1,0,0,xt-1,tt,ot+1),Fe+=xt,ot+=xt,++at);for(var ft=1<<Pt.b,qt=ft-1,Ot=et(xt,Pt.b),mr=Pt.K,Pt=Pt.w+(at>>Pt.b)*Ot;at<Ue;){var Or=mr,wa=Pt,xr=1;for(xc(ve,Fe,tt,ot-xt,1,tt,ot);xr<xt;){var Ft=(xr&~qt)+ft;Ft>xt&&(Ft=xt),(0,So[Or[wa++]>>8&15])(ve,Fe+ +xr,tt,ot+xr-xt,Ft-xr,tt,ot+xr),xr=Ft}Fe+=xt,ot+=xt,++at&qt||(Pt+=Ot)}We!=xe.nc&&a(fe,le-Me,fe,le+(We-je-1)*Me,Me);break;case 1:for(Me=ve,Ue=Fe,xt=(ve=xe.Ea)-(ot=ve&~(tt=(Fe=1<<xe.b)-1)),at=et(ve,xe.b),ft=xe.K,xe=xe.w+(je>>xe.b)*at;je<We;){for(qt=ft,Ot=xe,mr=new Ct,Pt=Ue+ot,Or=Ue+ve;Ue<Pt;)He(qt[Ot++],mr),yc(mr,Me,Ue,Fe,fe,le),Ue+=Fe,le+=Fe;Ue<Or&&(He(qt[Ot++],mr),yc(mr,Me,Ue,xt,fe,le),Ue+=xt,le+=xt),++je&tt||(xe+=at)}break;case 3:if(ve==fe&&Fe==le&&0<xe.b){for(Ue=fe,ve=Me=le+(We-je)*Me-(ot=(We-je)*et(xe.Ea,xe.b)),Fe=fe,tt=le,at=[],ot=(xt=ot)-1;0<=ot;--ot)at[ot]=Fe[tt+ot];for(ot=xt-1;0<=ot;--ot)Ue[ve+ot]=at[ot];Nf(xe,je,We,fe,Me,fe,le)}else Nf(xe,je,We,ve,Fe,fe,le)}le=P,fe=C}fe!=C&&a(P,C,le,fe,te)}function ce(x,S){var C=x.V,P=x.Ba+x.c*x.C,X=S-x.C;if(e(S<=x.l.o),e(16>=X),0<X){var te=x.l,re=x.Ta,le=x.Ua,fe=te.width;if(ye(x,X,C,P),X=le=[le],e((C=x.C)<(P=S)),e(te.v<te.va),P>te.o&&(P=te.o),C<te.j){var xe=te.j-C;C=te.j,X[0]+=xe*fe}if(C>=P?C=0:(X[0]+=4*te.v,te.ka=C-te.j,te.U=te.va-te.v,te.T=P-C,C=1),C){if(le=le[0],11>(C=x.ca).S){var je=C.f.RGBA,We=(P=C.S,X=te.U,te=te.T,xe=je.eb,je.A),ve=te;for(je=je.fb+x.Ma*je.A;0<ve--;){var Fe=re,Me=le,at=X,Ue=xe,tt=je;switch(P){case Cf:_c(Fe,Me,at,Ue,tt);break;case Vn:Eo(Fe,Me,at,Ue,tt);break;case Nu:Eo(Fe,Me,at,Ue,tt),Rl(Ue,tt,0,at,1,0);break;case Of:Ol(Fe,Me,at,Ue,tt);break;case $i:Yt(Fe,Me,at,Ue,tt,1);break;case Ff:Yt(Fe,Me,at,Ue,tt,1),Rl(Ue,tt,0,at,1,0);break;case Au:Yt(Fe,Me,at,Ue,tt,0);break;case bc:Yt(Fe,Me,at,Ue,tt,0),Rl(Ue,tt,1,at,1,0);break;case wc:ko(Fe,Me,at,Ue,tt);break;case Rf:ko(Fe,Me,at,Ue,tt),Gi(Ue,tt,at,1,0);break;case Qo:Ws(Fe,Me,at,Ue,tt);break;default:e(0)}le+=fe,je+=We}x.Ma+=te}else alert("todo:EmitRescaledRowsYUVA");e(x.Ma<=C.height)}}x.C=S,e(x.C<=x.i)}function ue(x){var S;if(0<x.ua)return 0;for(S=0;S<x.Wb;++S){var C=x.Ya[S].G,P=x.Ya[S].H;if(0<C[1][P[1]+0].g||0<C[2][P[2]+0].g||0<C[3][P[3]+0].g)return 0}return 1}function pe(x,S,C,P,X,te){if(x.Z!=0){var re=x.qd,le=x.rd;for(e(To[x.Z]!=null);S<C;++S)To[x.Z](re,le,P,X,P,X,te),re=P,le=X,X+=te;x.qd=re,x.rd=le}}function be(x,S){var C=x.l.ma,P=C.Z==0||C.Z==1?x.l.j:x.C;if(P=x.C<P?P:x.C,e(S<=x.l.o),S>P){var X=x.l.width,te=C.ca,re=C.tb+X*P,le=x.V,fe=x.Ba+x.c*P,xe=x.gc;e(x.ab==1),e(xe[0].hc==3),Hs(xe[0],P,S,le,fe,te,re),pe(C,P,S,te,re,X)}x.C=x.Ma=S}function Be(x,S,C,P,X,te,re){var le=x.$/P,fe=x.$%P,xe=x.m,je=x.s,We=C+x.$,ve=We;X=C+P*X;var Fe=C+P*te,Me=280+je.ua,at=x.Pb?le:16777216,Ue=0<je.ua?je.Wa:null,tt=je.wc,ot=We<Fe?J(je,fe,le):null;e(x.C<te),e(Fe<=X);var xt=!1;e:for(;;){for(;xt||We<Fe;){var ft=0;if(le>=at){var qt=We-C;e((at=x).Pb),at.wd=at.m,at.xd=qt,0<at.s.ua&&Ie(at.s.Wa,at.s.vb),at=le+el}if(fe&tt||(ot=J(je,fe,le)),e(ot!=null),ot.Qb&&(S[We]=ot.qb,xt=!0),!xt)if(se(xe),ot.jc){ft=xe,qt=S;var Ot=We,mr=ot.pd[B(ft)&Zo-1];e(ot.jc),256>mr.g?(K(ft,ft.u+mr.g),qt[Ot]=mr.value,ft=0):(K(ft,ft.u+mr.g-256),e(256<=mr.value),ft=mr.value),ft==0&&(xt=!0)}else ft=ha(ot.G[0],ot.H[0],xe);if(xe.h)break;if(xt||256>ft){if(!xt)if(ot.nd)S[We]=(ot.qb|ft<<8)>>>0;else{if(se(xe),xt=ha(ot.G[1],ot.H[1],xe),se(xe),qt=ha(ot.G[2],ot.H[2],xe),Ot=ha(ot.G[3],ot.H[3],xe),xe.h)break;S[We]=(Ot<<24|xt<<16|ft<<8|qt)>>>0}if(xt=!1,++We,++fe>=P&&(fe=0,++le,re!=null&&le<=te&&!(le%16)&&re(x,le),Ue!=null))for(;ve<We;)ft=S[ve++],Ue.X[(506832829*ft&4294967295)>>>Ue.Mb]=ft}else if(280>ft){if(ft=On(ft-256,xe),qt=ha(ot.G[4],ot.H[4],xe),se(xe),qt=ei(P,qt=On(qt,xe)),xe.h)break;if(We-C<qt||X-We<ft)break e;for(Ot=0;Ot<ft;++Ot)S[We+Ot]=S[We+Ot-qt];for(We+=ft,fe+=ft;fe>=P;)fe-=P,++le,re!=null&&le<=te&&!(le%16)&&re(x,le);if(e(We<=X),fe&tt&&(ot=J(je,fe,le)),Ue!=null)for(;ve<We;)ft=S[ve++],Ue.X[(506832829*ft&4294967295)>>>Ue.Mb]=ft}else{if(!(ft<Me))break e;for(xt=ft-280,e(Ue!=null);ve<We;)ft=S[ve++],Ue.X[(506832829*ft&4294967295)>>>Ue.Mb]=ft;ft=We,e(!(xt>>>(qt=Ue).Xa)),S[ft]=qt.X[xt],xt=!0}xt||e(xe.h==q(xe))}if(x.Pb&&xe.h&&We<X)e(x.m.h),x.a=5,x.m=x.wd,x.$=x.xd,0<x.s.ua&&Ie(x.s.vb,x.s.Wa);else{if(xe.h)break e;re?.(x,le>te?te:le),x.a=0,x.$=We-C}return 1}return x.a=3,0}function Qe(x){e(x!=null),x.vc=null,x.yc=null,x.Ya=null;var S=x.Wa;S!=null&&(S.X=null),x.vb=null,e(x!=null)}function qe(){var x=new cr;return x==null?null:(x.a=0,x.xb=Qh,Wr("Predictor","VP8LPredictors"),Wr("Predictor","VP8LPredictors_C"),Wr("PredictorAdd","VP8LPredictorsAdd"),Wr("PredictorAdd","VP8LPredictorsAdd_C"),za=Ye,yc=ct,_c=Ht,Eo=Rt,ko=Wt,Ws=nr,Ol=br,D.VP8LMapColor32b=zs,D.VP8LMapColor8b=Ln,x)}function ze(x,S,C,P,X){var te=1,re=[x],le=[S],fe=P.m,xe=P.s,je=null,We=0;e:for(;;){if(C)for(;te&&Q(fe,1);){var ve=re,Fe=le,Me=P,at=1,Ue=Me.m,tt=Me.gc[Me.ab],ot=Q(Ue,2);if(Me.Oc&1<<ot)te=0;else{switch(Me.Oc|=1<<ot,tt.hc=ot,tt.Ea=ve[0],tt.nc=Fe[0],tt.K=[null],++Me.ab,e(4>=Me.ab),ot){case 0:case 1:tt.b=Q(Ue,3)+2,at=ze(et(tt.Ea,tt.b),et(tt.nc,tt.b),0,Me,tt.K),tt.K=tt.K[0];break;case 3:var xt,ft=Q(Ue,8)+1,qt=16<ft?0:4<ft?1:2<ft?2:3;if(ve[0]=et(tt.Ea,qt),tt.b=qt,xt=at=ze(ft,1,0,Me,tt.K)){var Ot,mr=ft,Pt=tt,Or=1<<(8>>Pt.b),wa=i(Or);if(wa==null)xt=0;else{var xr=Pt.K[0],Ft=Pt.w;for(wa[0]=Pt.K[0][0],Ot=1;Ot<1*mr;++Ot)wa[Ot]=wt(xr[Ft+Ot],wa[Ot-1]);for(;Ot<4*Or;++Ot)wa[Ot]=0;Pt.K[0]=null,Pt.K[0]=wa,xt=1}}at=xt;break;case 2:break;default:e(0)}te=at}}if(re=re[0],le=le[0],te&&Q(fe,1)&&!(te=1<=(We=Q(fe,4))&&11>=We)){P.a=3;break e}var Nt;if(Nt=te)t:{var Na,or,wr,ta=P,dn=re,Bn=le,ma=We,en=C,Gn=ta.m,tn=ta.s,Nr=[null],qr=1,Ta=0,Xr=Ki[ma];r:for(;;){if(en&&Q(Gn,1)){var pn=Q(Gn,3)+2,ja=et(dn,pn),zr=et(Bn,pn),Va=ja*zr;if(!ze(ja,zr,0,ta,Nr))break r;for(Nr=Nr[0],tn.xc=pn,Na=0;Na<Va;++Na){var ra=Nr[Na]>>8&65535;Nr[Na]=ra,ra>=qr&&(qr=ra+1)}}if(Gn.h)break r;for(or=0;5>or;++or){var rn=Dl[or];!or&&0<ma&&(rn+=1<<ma),Ta<rn&&(Ta=rn)}var an=o(qr*Xr,ee),ia=qr,Ur=o(ia,ge);if(Ur==null)var $n=null;else e(65536>=ia),$n=Ur;var Ma=i(Ta);if($n==null||Ma==null||an==null){ta.a=1;break r}var Qt=an;for(Na=wr=0;Na<qr;++Na){var tr=$n[Na],Hr=tr.G,vi=tr.H,es=0,oi=1,nn=0;for(or=0;5>or;++or){rn=Dl[or],Hr[or]=Qt,vi[or]=wr,!or&&0<ma&&(rn+=1<<ma);n:{var sl,ol=rn,Uf=ta,ga=Ma,t0=Qt,r0=wr,qf=0,jo=Uf.m,Kp=Q(jo,1);if(n(ga,0,0,ol),Kp){var a0=Q(jo,1)+1,n0=Q(jo,1),zf=Q(jo,n0==0?1:8);ga[zf]=1,a0==2&&(ga[zf=Q(jo,8)]=1);var Sn=1}else{var Ia=i(19),Ou=Q(jo,4)+4;if(19<Ou){Uf.a=3;var ll=0;break n}for(sl=0;sl<Ou;++sl)Ia[Tu[sl]]=Q(jo,3);var Nc=void 0,Il=void 0,$s=Uf,Hf=Ia,Tc=ol,Wf=ga,Vf=0,Co=$s.m,i0=8,s0=o(128,ee);a:for(;L(s0,0,7,Hf,19);){if(Q(Co,1)){var Rd=2+2*Q(Co,3);if((Nc=2+Q(Co,Rd))>Tc)break a}else Nc=Tc;for(Il=0;Il<Tc&&Nc--;){se(Co);var o0=s0[0+(127&B(Co))];K(Co,Co.u+o0.g);var cl=o0.value;if(16>cl)Wf[Il++]=cl,cl!=0&&(i0=cl);else{var Ld=cl==16,Dd=cl-16,Pd=Sc[Dd],l0=Q(Co,Xi[Dd])+Pd;if(Il+l0>Tc)break a;for(var Md=Ld?i0:0;0<l0--;)Wf[Il++]=Md}}Vf=1;break a}Vf||($s.a=3),Sn=Vf}(Sn=Sn&&!jo.h)&&(qf=L(t0,r0,8,ga,ol)),Sn&&qf!=0?ll=qf:(Uf.a=3,ll=0)}if(ll==0)break r;if(oi&&Lf[or]==1&&(oi=Qt[wr].g==0),es+=Qt[wr].g,wr+=ll,3>=or){var Bl,Gf=Ma[0];for(Bl=1;Bl<rn;++Bl)Ma[Bl]>Gf&&(Gf=Ma[Bl]);nn+=Gf}}if(tr.nd=oi,tr.Qb=0,oi&&(tr.qb=(Hr[3][vi[3]+0].value<<24|Hr[1][vi[1]+0].value<<16|Hr[2][vi[2]+0].value)>>>0,es==0&&256>Hr[0][vi[0]+0].value&&(tr.Qb=1,tr.qb+=Hr[0][vi[0]+0].value<<8)),tr.jc=!tr.Qb&&6>nn,tr.jc){var Fu,Xs=tr;for(Fu=0;Fu<Zo;++Fu){var Oo=Fu,Fo=Xs.pd[Oo],$f=Xs.G[0][Xs.H[0]+Oo];256<=$f.value?(Fo.g=$f.g+256,Fo.value=$f.value):(Fo.g=0,Fo.value=0,Oo>>=Da($f,8,Fo),Oo>>=Da(Xs.G[1][Xs.H[1]+Oo],16,Fo),Oo>>=Da(Xs.G[2][Xs.H[2]+Oo],0,Fo),Da(Xs.G[3][Xs.H[3]+Oo],24,Fo))}}}tn.vc=Nr,tn.Wb=qr,tn.Ya=$n,tn.yc=an,Nt=1;break t}Nt=0}if(!(te=Nt)){P.a=3;break e}if(0<We){if(xe.ua=1<<We,!V(xe.Wa,We)){P.a=1,te=0;break e}}else xe.ua=0;var Xf=P,Ul=re,Id=le,jc=Xf.s,Cc=jc.xc;if(Xf.c=Ul,Xf.i=Id,jc.md=et(Ul,Cc),jc.wc=Cc==0?-1:(1<<Cc)-1,C){P.xb=tl;break e}if((je=i(re*le))==null){P.a=1,te=0;break e}te=(te=Be(P,je,0,re,le,le,null))&&!fe.h;break e}return te?(X!=null?X[0]=je:(e(je==null),e(C)),P.$=0,C||Qe(xe)):Qe(xe),te}function Ve(x,S){var C=x.c*x.i,P=C+S+16*S;return e(x.c<=S),x.V=i(P),x.V==null?(x.Ta=null,x.Ua=0,x.a=1,0):(x.Ta=x.V,x.Ua=x.Ba+C+S,1)}function pt(x,S){var C=x.C,P=S-C,X=x.V,te=x.Ba+x.c*C;for(e(S<=x.l.o);0<P;){var re=16<P?16:P,le=x.l.ma,fe=x.l.width,xe=fe*re,je=le.ca,We=le.tb+fe*C,ve=x.Ta,Fe=x.Ua;ye(x,re,X,te),Mi(ve,Fe,je,We,xe),pe(le,C,C+re,je,We,fe),P-=re,X+=re*x.c,C+=re}e(C==S),x.C=x.Ma=S}function bt(){this.ub=this.yd=this.td=this.Rb=0}function Tt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function yt(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function kt(){this.Yb=(function(){var x=[];return(function S(C,P,X){for(var te=X[P],re=0;re<te&&(C.push(X.length>P+1?[]:0),!(X.length<P+1));re++)S(C[re],P+1,X)})(x,0,[3,11]),x})()}function Lt(){this.jb=i(3),this.Wc=c([4,8],kt),this.Xc=c([4,17],kt)}function ea(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function jr(){this.ld=this.La=this.dd=this.tc=0}function na(){this.Na=this.la=0}function ti(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function hs(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ds(){this.uc=this.M=this.Nb=0,this.wa=Array(new jr),this.Y=0,this.ya=Array(new hs),this.aa=0,this.l=new lo}function Fi(){this.y=i(16),this.f=i(8),this.ea=i(8)}function $o(){this.cb=this.a=0,this.sc="",this.m=new N,this.Od=new bt,this.Kc=new Tt,this.ed=new ea,this.Qa=new yt,this.Ic=this.$c=this.Aa=0,this.D=new ds,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,N),this.ia=0,this.pb=o(4,ti),this.Pa=new Lt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Fi),this.Hd=0,this.rb=Array(new na),this.sb=0,this.wa=Array(new jr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new hs),this.L=this.aa=0,this.gd=c([4,2],jr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ka(x,S){return 0>x?0:x>S?S:x}function lo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ps(){var x=new $o;return x!=null&&(x.a=0,x.sc="OK",x.cb=0,x.Xb=0,Ii||(Ii=Xo)),x}function Gr(x,S,C){return x.a==0&&(x.a=S,x.sc=C,x.cb=0),0}function lu(x,S,C){return 3<=C&&x[S+0]==157&&x[S+1]==1&&x[S+2]==42}function Ds(x,S){if(x==null)return 0;if(x.a=0,x.sc="OK",S==null)return Gr(x,2,"null VP8Io passed to VP8GetHeaders()");var C=S.data,P=S.w,X=S.ha;if(4>X)return Gr(x,7,"Truncated header.");var te=C[P+0]|C[P+1]<<8|C[P+2]<<16,re=x.Od;if(re.Rb=!(1&te),re.td=te>>1&7,re.yd=te>>4&1,re.ub=te>>5,3<re.td)return Gr(x,3,"Incorrect keyframe parameters.");if(!re.yd)return Gr(x,4,"Frame not displayable.");P+=3,X-=3;var le=x.Kc;if(re.Rb){if(7>X)return Gr(x,7,"cannot parse picture header");if(!lu(C,P,X))return Gr(x,3,"Bad code word");le.c=16383&(C[P+4]<<8|C[P+3]),le.Td=C[P+4]>>6,le.i=16383&(C[P+6]<<8|C[P+5]),le.Ud=C[P+6]>>6,P+=7,X-=7,x.za=le.c+15>>4,x.Ub=le.i+15>>4,S.width=le.c,S.height=le.i,S.Da=0,S.j=0,S.v=0,S.va=S.width,S.o=S.height,S.da=0,S.ib=S.width,S.hb=S.height,S.U=S.width,S.T=S.height,n((te=x.Pa).jb,0,255,te.jb.length),e((te=x.Qa)!=null),te.Cb=0,te.Bb=0,te.Fb=1,n(te.Zb,0,0,te.Zb.length),n(te.Lb,0,0,te.Lb)}if(re.ub>X)return Gr(x,7,"bad partition length");ie(te=x.m,C,P,re.ub),P+=re.ub,X-=re.ub,re.Rb&&(le.Ld=we(te),le.Kd=we(te)),le=x.Qa;var fe,xe=x.Pa;if(e(te!=null),e(le!=null),le.Cb=we(te),le.Cb){if(le.Bb=we(te),we(te)){for(le.Fb=we(te),fe=0;4>fe;++fe)le.Zb[fe]=we(te)?de(te,7):0;for(fe=0;4>fe;++fe)le.Lb[fe]=we(te)?de(te,6):0}if(le.Bb)for(fe=0;3>fe;++fe)xe.jb[fe]=we(te)?he(te,8):255}else le.Bb=0;if(te.Ka)return Gr(x,3,"cannot parse segment header");if((le=x.ed).zd=we(te),le.Tb=he(te,6),le.wb=he(te,3),le.Pc=we(te),le.Pc&&we(te)){for(xe=0;4>xe;++xe)we(te)&&(le.vd[xe]=de(te,6));for(xe=0;4>xe;++xe)we(te)&&(le.od[xe]=de(te,6))}if(x.L=le.Tb==0?0:le.zd?1:2,te.Ka)return Gr(x,3,"cannot parse filter header");var je=X;if(X=fe=P,P=fe+je,le=je,x.Xb=(1<<he(x.m,2))-1,je<3*(xe=x.Xb))C=7;else{for(fe+=3*xe,le-=3*xe,je=0;je<xe;++je){var We=C[X+0]|C[X+1]<<8|C[X+2]<<16;We>le&&(We=le),ie(x.Jc[+je],C,fe,We),fe+=We,le-=We,X+=3}ie(x.Jc[+xe],C,fe,le),C=fe<P?0:5}if(C!=0)return Gr(x,C,"cannot parse partitions");for(C=he(fe=x.m,7),X=we(fe)?de(fe,4):0,P=we(fe)?de(fe,4):0,le=we(fe)?de(fe,4):0,xe=we(fe)?de(fe,4):0,fe=we(fe)?de(fe,4):0,je=x.Qa,We=0;4>We;++We){if(je.Cb){var ve=je.Zb[We];je.Fb||(ve+=C)}else{if(0<We){x.pb[We]=x.pb[0];continue}ve=C}var Fe=x.pb[We];Fe.Sc[0]=Ji[ka(ve+X,127)],Fe.Sc[1]=Zi[ka(ve+0,127)],Fe.Eb[0]=2*Ji[ka(ve+P,127)],Fe.Eb[1]=101581*Zi[ka(ve+le,127)]>>16,8>Fe.Eb[1]&&(Fe.Eb[1]=8),Fe.Qc[0]=Ji[ka(ve+xe,117)],Fe.Qc[1]=Zi[ka(ve+fe,127)],Fe.lc=ve+fe}if(!re.Rb)return Gr(x,4,"Not a key frame.");for(we(te),re=x.Pa,C=0;4>C;++C){for(X=0;8>X;++X)for(P=0;3>P;++P)for(le=0;11>le;++le)xe=Se(te,_a[C][X][P][le])?he(te,8):Od[C][X][P][le],re.Wc[C][X].Yb[P][le]=xe;for(X=0;17>X;++X)re.Xc[C][X]=re.Wc[C][Rr[X]]}return x.kc=we(te),x.kc&&(x.Bd=he(te,8)),x.cb=1}function Xo(x,S,C,P,X,te,re){var le=S[X].Yb[C];for(C=0;16>X;++X){if(!Se(x,le[C+0]))return X;for(;!Se(x,le[C+1]);)if(le=S[++X].Yb[0],C=0,X==16)return 16;var fe=S[X+1].Yb;if(Se(x,le[C+2])){var xe=x,je=0;if(Se(xe,(ve=le)[(We=C)+3]))if(Se(xe,ve[We+6])){for(le=0,We=2*(je=Se(xe,ve[We+8]))+(ve=Se(xe,ve[We+9+je])),je=0,ve=Cd[We];ve[le];++le)je+=je+Se(xe,ve[le]);je+=3+(8<<We)}else Se(xe,ve[We+7])?(je=7+2*Se(xe,165),je+=Se(xe,145)):je=5+Se(xe,159);else je=Se(xe,ve[We+4])?3+Se(xe,ve[We+5]):2;le=fe[2]}else je=1,le=fe[1];fe=re+Zh[X],0>(xe=x).b&&me(xe);var We,ve=xe.b,Fe=(We=xe.Ca>>1)-(xe.I>>ve)>>31;--xe.b,xe.Ca+=Fe,xe.Ca|=1,xe.I-=(We+1&Fe)<<ve,te[fe]=((je^Fe)-Fe)*P[(0<X)+0]}return 16}function cu(x){var S=x.rb[x.sb-1];S.la=0,S.Na=0,n(x.zc,0,0,x.zc.length),x.ja=0}function ri(x,S,C,P,X){X=x[S+C+32*P]+(X>>3),x[S+C+32*P]=-256&X?0>X?0:255:X}function fn(x,S,C,P,X,te){ri(x,S,0,C,P+X),ri(x,S,1,C,P+te),ri(x,S,2,C,P-te),ri(x,S,3,C,P-X)}function Za(x){return(20091*x>>16)+x}function uc(x,S,C,P){var X,te=0,re=i(16);for(X=0;4>X;++X){var le=x[S+0]+x[S+8],fe=x[S+0]-x[S+8],xe=(35468*x[S+4]>>16)-Za(x[S+12]),je=Za(x[S+4])+(35468*x[S+12]>>16);re[te+0]=le+je,re[te+1]=fe+xe,re[te+2]=fe-xe,re[te+3]=le-je,te+=4,S++}for(X=te=0;4>X;++X)le=(x=re[te+0]+4)+re[te+8],fe=x-re[te+8],xe=(35468*re[te+4]>>16)-Za(re[te+12]),ri(C,P,0,0,le+(je=Za(re[te+4])+(35468*re[te+12]>>16))),ri(C,P,1,0,fe+xe),ri(C,P,2,0,fe-xe),ri(C,P,3,0,le-je),te++,P+=32}function xf(x,S,C,P){var X=x[S+0]+4,te=35468*x[S+4]>>16,re=Za(x[S+4]),le=35468*x[S+1]>>16;fn(C,P,0,X+re,x=Za(x[S+1]),le),fn(C,P,1,X+te,x,le),fn(C,P,2,X-te,x,le),fn(C,P,3,X-re,x,le)}function uu(x,S,C,P,X){uc(x,S,C,P),X&&uc(x,S+16,C,P+4)}function ai(x,S,C,P){Ao(x,S+0,C,P,1),Ao(x,S+32,C,P+128,1)}function fu(x,S,C,P){var X;for(x=x[S+0]+4,X=0;4>X;++X)for(S=0;4>S;++S)ri(C,P,S,X,x)}function hu(x,S,C,P){x[S+0]&&$r(x,S+0,C,P),x[S+16]&&$r(x,S+16,C,P+4),x[S+32]&&$r(x,S+32,C,P+128),x[S+48]&&$r(x,S+48,C,P+128+4)}function ms(x,S,C,P){var X,te=i(16);for(X=0;4>X;++X){var re=x[S+0+X]+x[S+12+X],le=x[S+4+X]+x[S+8+X],fe=x[S+4+X]-x[S+8+X],xe=x[S+0+X]-x[S+12+X];te[0+X]=re+le,te[8+X]=re-le,te[4+X]=xe+fe,te[12+X]=xe-fe}for(X=0;4>X;++X)re=(x=te[0+4*X]+3)+te[3+4*X],le=te[1+4*X]+te[2+4*X],fe=te[1+4*X]-te[2+4*X],xe=x-te[3+4*X],C[P+0]=re+le>>3,C[P+16]=xe+fe>>3,C[P+32]=re-le>>3,C[P+48]=xe-fe>>3,P+=64}function El(x,S,C){var P,X=S-32,te=Wn,re=255-x[X-1];for(P=0;P<C;++P){var le,fe=te,xe=re+x[S-1];for(le=0;le<C;++le)x[S+le]=fe[xe+x[X+le]];S+=32}}function yf(x,S){El(x,S,4)}function _f(x,S){El(x,S,8)}function du(x,S){El(x,S,16)}function pu(x,S){var C;for(C=0;16>C;++C)a(x,S+32*C,x,S-32,16)}function wf(x,S){var C;for(C=16;0<C;--C)n(x,S,x[S-1],16),S+=32}function mi(x,S,C){var P;for(P=0;16>P;++P)n(S,C+32*P,x,16)}function gs(x,S){var C,P=16;for(C=0;16>C;++C)P+=x[S-1+32*C]+x[S+C-32];mi(P>>5,x,S)}function co(x,S){var C,P=8;for(C=0;16>C;++C)P+=x[S-1+32*C];mi(P>>4,x,S)}function kl(x,S){var C,P=8;for(C=0;16>C;++C)P+=x[S+C-32];mi(P>>4,x,S)}function Yo(x,S){mi(128,x,S)}function sr(x,S,C){return x+2*S+C+2>>2}function bf(x,S){var C,P=S-32;for(P=new Uint8Array([sr(x[P-1],x[P+0],x[P+1]),sr(x[P+0],x[P+1],x[P+2]),sr(x[P+1],x[P+2],x[P+3]),sr(x[P+2],x[P+3],x[P+4])]),C=0;4>C;++C)a(x,S+32*C,P,0,P.length)}function mu(x,S){var C=x[S-1],P=x[S-1+32],X=x[S-1+64],te=x[S-1+96];Ee(x,S+0,16843009*sr(x[S-1-32],C,P)),Ee(x,S+32,16843009*sr(C,P,X)),Ee(x,S+64,16843009*sr(P,X,te)),Ee(x,S+96,16843009*sr(X,te,te))}function Sf(x,S){var C,P=4;for(C=0;4>C;++C)P+=x[S+C-32]+x[S-1+32*C];for(P>>=3,C=0;4>C;++C)n(x,S+32*C,P,4)}function Ri(x,S){var C=x[S-1+0],P=x[S-1+32],X=x[S-1+64],te=x[S-1-32],re=x[S+0-32],le=x[S+1-32],fe=x[S+2-32],xe=x[S+3-32];x[S+0+96]=sr(P,X,x[S-1+96]),x[S+1+96]=x[S+0+64]=sr(C,P,X),x[S+2+96]=x[S+1+64]=x[S+0+32]=sr(te,C,P),x[S+3+96]=x[S+2+64]=x[S+1+32]=x[S+0+0]=sr(re,te,C),x[S+3+64]=x[S+2+32]=x[S+1+0]=sr(le,re,te),x[S+3+32]=x[S+2+0]=sr(fe,le,re),x[S+3+0]=sr(xe,fe,le)}function Fn(x,S){var C=x[S+1-32],P=x[S+2-32],X=x[S+3-32],te=x[S+4-32],re=x[S+5-32],le=x[S+6-32],fe=x[S+7-32];x[S+0+0]=sr(x[S+0-32],C,P),x[S+1+0]=x[S+0+32]=sr(C,P,X),x[S+2+0]=x[S+1+32]=x[S+0+64]=sr(P,X,te),x[S+3+0]=x[S+2+32]=x[S+1+64]=x[S+0+96]=sr(X,te,re),x[S+3+32]=x[S+2+64]=x[S+1+96]=sr(te,re,le),x[S+3+64]=x[S+2+96]=sr(re,le,fe),x[S+3+96]=sr(le,fe,fe)}function gu(x,S){var C=x[S-1+0],P=x[S-1+32],X=x[S-1+64],te=x[S-1-32],re=x[S+0-32],le=x[S+1-32],fe=x[S+2-32],xe=x[S+3-32];x[S+0+0]=x[S+1+64]=te+re+1>>1,x[S+1+0]=x[S+2+64]=re+le+1>>1,x[S+2+0]=x[S+3+64]=le+fe+1>>1,x[S+3+0]=fe+xe+1>>1,x[S+0+96]=sr(X,P,C),x[S+0+64]=sr(P,C,te),x[S+0+32]=x[S+1+96]=sr(C,te,re),x[S+1+32]=x[S+2+96]=sr(te,re,le),x[S+2+32]=x[S+3+96]=sr(re,le,fe),x[S+3+32]=sr(le,fe,xe)}function Al(x,S){var C=x[S+0-32],P=x[S+1-32],X=x[S+2-32],te=x[S+3-32],re=x[S+4-32],le=x[S+5-32],fe=x[S+6-32],xe=x[S+7-32];x[S+0+0]=C+P+1>>1,x[S+1+0]=x[S+0+64]=P+X+1>>1,x[S+2+0]=x[S+1+64]=X+te+1>>1,x[S+3+0]=x[S+2+64]=te+re+1>>1,x[S+0+32]=sr(C,P,X),x[S+1+32]=x[S+0+96]=sr(P,X,te),x[S+2+32]=x[S+1+96]=sr(X,te,re),x[S+3+32]=x[S+2+96]=sr(te,re,le),x[S+3+64]=sr(re,le,fe),x[S+3+96]=sr(le,fe,xe)}function Li(x,S){var C=x[S-1+0],P=x[S-1+32],X=x[S-1+64],te=x[S-1+96];x[S+0+0]=C+P+1>>1,x[S+2+0]=x[S+0+32]=P+X+1>>1,x[S+2+32]=x[S+0+64]=X+te+1>>1,x[S+1+0]=sr(C,P,X),x[S+3+0]=x[S+1+32]=sr(P,X,te),x[S+3+32]=x[S+1+64]=sr(X,te,te),x[S+3+64]=x[S+2+64]=x[S+0+96]=x[S+1+96]=x[S+2+96]=x[S+3+96]=te}function Nl(x,S){var C=x[S-1+0],P=x[S-1+32],X=x[S-1+64],te=x[S-1+96],re=x[S-1-32],le=x[S+0-32],fe=x[S+1-32],xe=x[S+2-32];x[S+0+0]=x[S+2+32]=C+re+1>>1,x[S+0+32]=x[S+2+64]=P+C+1>>1,x[S+0+64]=x[S+2+96]=X+P+1>>1,x[S+0+96]=te+X+1>>1,x[S+3+0]=sr(le,fe,xe),x[S+2+0]=sr(re,le,fe),x[S+1+0]=x[S+3+32]=sr(C,re,le),x[S+1+32]=x[S+3+64]=sr(P,C,re),x[S+1+64]=x[S+3+96]=sr(X,P,C),x[S+1+96]=sr(te,X,P)}function Ps(x,S){var C;for(C=0;8>C;++C)a(x,S+32*C,x,S-32,8)}function Ef(x,S){var C;for(C=0;8>C;++C)n(x,S,x[S-1],8),S+=32}function Hi(x,S,C){var P;for(P=0;8>P;++P)n(S,C+32*P,x,8)}function fc(x,S){var C,P=8;for(C=0;8>C;++C)P+=x[S+C-32]+x[S-1+32*C];Hi(P>>4,x,S)}function hc(x,S){var C,P=4;for(C=0;8>C;++C)P+=x[S+C-32];Hi(P>>3,x,S)}function wn(x,S){var C,P=4;for(C=0;8>C;++C)P+=x[S-1+32*C];Hi(P>>3,x,S)}function Ms(x,S){Hi(128,x,S)}function Wi(x,S,C){var P=x[S-C],X=x[S+0],te=3*(X-P)+No[1020+x[S-2*C]-x[S+C]],re=ku[112+(te+4>>3)];x[S-C]=Wn[255+P+ku[112+(te+3>>3)]],x[S+0]=Wn[255+X-re]}function uo(x,S,C,P){var X=x[S+0],te=x[S+C];return Dn[255+x[S-2*C]-x[S-C]]>P||Dn[255+te-X]>P}function dc(x,S,C,P){return 4*Dn[255+x[S-C]-x[S+0]]+Dn[255+x[S-2*C]-x[S+C]]<=P}function Tl(x,S,C,P,X){var te=x[S-3*C],re=x[S-2*C],le=x[S-C],fe=x[S+0],xe=x[S+C],je=x[S+2*C],We=x[S+3*C];return 4*Dn[255+le-fe]+Dn[255+re-xe]>P?0:Dn[255+x[S-4*C]-te]<=X&&Dn[255+te-re]<=X&&Dn[255+re-le]<=X&&Dn[255+We-je]<=X&&Dn[255+je-xe]<=X&&Dn[255+xe-fe]<=X}function fo(x,S,C,P){var X=2*P+1;for(P=0;16>P;++P)dc(x,S+P,C,X)&&Wi(x,S+P,C)}function ho(x,S,C,P){var X=2*P+1;for(P=0;16>P;++P)dc(x,S+P*C,1,X)&&Wi(x,S+P*C,1)}function jl(x,S,C,P){var X;for(X=3;0<X;--X)fo(x,S+=4*C,C,P)}function vu(x,S,C,P){var X;for(X=3;0<X;--X)ho(x,S+=4,C,P)}function po(x,S,C,P,X,te,re,le){for(te=2*te+1;0<X--;){if(Tl(x,S,C,te,re))if(uo(x,S,C,le))Wi(x,S,C);else{var fe=x,xe=S,je=C,We=fe[xe-2*je],ve=fe[xe-je],Fe=fe[xe+0],Me=fe[xe+je],at=fe[xe+2*je],Ue=27*(ot=No[1020+3*(Fe-ve)+No[1020+We-Me]])+63>>7,tt=18*ot+63>>7,ot=9*ot+63>>7;fe[xe-3*je]=Wn[255+fe[xe-3*je]+ot],fe[xe-2*je]=Wn[255+We+tt],fe[xe-je]=Wn[255+ve+Ue],fe[xe+0]=Wn[255+Fe-Ue],fe[xe+je]=Wn[255+Me-tt],fe[xe+2*je]=Wn[255+at-ot]}S+=P}}function mo(x,S,C,P,X,te,re,le){for(te=2*te+1;0<X--;){if(Tl(x,S,C,te,re))if(uo(x,S,C,le))Wi(x,S,C);else{var fe=x,xe=S,je=C,We=fe[xe-je],ve=fe[xe+0],Fe=fe[xe+je],Me=ku[112+(4+(at=3*(ve-We))>>3)],at=ku[112+(at+3>>3)],Ue=Me+1>>1;fe[xe-2*je]=Wn[255+fe[xe-2*je]+Ue],fe[xe-je]=Wn[255+We+at],fe[xe+0]=Wn[255+ve-Me],fe[xe+je]=Wn[255+Fe-Ue]}S+=P}}function kf(x,S,C,P,X,te){po(x,S,C,1,16,P,X,te)}function go(x,S,C,P,X,te){po(x,S,1,C,16,P,X,te)}function Af(x,S,C,P,X,te){var re;for(re=3;0<re;--re)mo(x,S+=4*C,C,1,16,P,X,te)}function j(x,S,C,P,X,te){var re;for(re=3;0<re;--re)mo(x,S+=4,1,C,16,P,X,te)}function G(x,S,C,P,X,te,re,le){po(x,S,X,1,8,te,re,le),po(C,P,X,1,8,te,re,le)}function _e(x,S,C,P,X,te,re,le){po(x,S,1,X,8,te,re,le),po(C,P,1,X,8,te,re,le)}function Te(x,S,C,P,X,te,re,le){mo(x,S+4*X,X,1,8,te,re,le),mo(C,P+4*X,X,1,8,te,re,le)}function De(x,S,C,P,X,te,re,le){mo(x,S+4,1,X,8,te,re,le),mo(C,P+4,1,X,8,te,re,le)}function st(){this.ba=new pr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Tr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ht(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Bt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Gt(){this.ua=0,this.Wa=new Le,this.vb=new Le,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ge,this.yc=new ee}function cr(){this.xb=this.a=0,this.l=new lo,this.ca=new pr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new M,this.Pb=0,this.wd=new M,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Gt,this.ab=0,this.gc=o(4,Bt),this.Oc=0}function vr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new lo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ir(x,S,C,P,X,te,re){for(x=x==null?0:x[S+0],S=0;S<re;++S)X[te+S]=x+C[P+S]&255,x=X[te+S]}function Aa(x,S,C,P,X,te,re){var le;if(x==null)Ir(null,null,C,P,X,te,re);else for(le=0;le<re;++le)X[te+le]=x[S+le]+C[P+le]&255}function qa(x,S,C,P,X,te,re){if(x==null)Ir(null,null,C,P,X,te,re);else{var le,fe=x[S+0],xe=fe,je=fe;for(le=0;le<re;++le)xe=je+(fe=x[S+le])-xe,je=C[P+le]+(-256&xe?0>xe?0:255:xe)&255,xe=fe,X[te+le]=je}}function da(x,S,C,P){var X=S.width,te=S.o;if(e(x!=null&&S!=null),0>C||0>=P||C+P>te)return null;if(!x.Cc){if(x.ga==null){var re;if(x.ga=new vr,(re=x.ga==null)||(re=S.width*S.o,e(x.Gb.length==0),x.Gb=i(re),x.Uc=0,x.Gb==null?re=0:(x.mb=x.Gb,x.nb=x.Uc,x.rc=null,re=1),re=!re),!re){re=x.ga;var le=x.Fa,fe=x.P,xe=x.qc,je=x.mb,We=x.nb,ve=fe+1,Fe=xe-1,Me=re.l;if(e(le!=null&&je!=null&&S!=null),To[0]=null,To[1]=Ir,To[2]=Aa,To[3]=qa,re.ca=je,re.tb=We,re.c=S.width,re.i=S.height,e(0<re.c&&0<re.i),1>=xe)S=0;else if(re.$a=3&le[fe+0],re.Z=le[fe+0]>>2&3,re.Lc=le[fe+0]>>4&3,fe=le[fe+0]>>6&3,0>re.$a||1<re.$a||4<=re.Z||1<re.Lc||fe)S=0;else if(Me.put=Kt,Me.ac=Ja,Me.bc=fs,Me.ma=re,Me.width=S.width,Me.height=S.height,Me.Da=S.Da,Me.v=S.v,Me.va=S.va,Me.j=S.j,Me.o=S.o,re.$a)e:{e(re.$a==1),S=qe();t:for(;;){if(S==null){S=0;break e}if(e(re!=null),re.mc=S,S.c=re.c,S.i=re.i,S.l=re.l,S.l.ma=re,S.l.width=re.c,S.l.height=re.i,S.a=0,Z(S.m,le,ve,Fe),!ze(re.c,re.i,1,S,null)||(S.ab==1&&S.gc[0].hc==3&&ue(S.s)?(re.ic=1,le=S.c*S.i,S.Ta=null,S.Ua=0,S.V=i(le),S.Ba=0,S.V==null?(S.a=1,S=0):S=1):(re.ic=0,S=Ve(S,re.c)),!S))break t;S=1;break e}re.mc=null,S=0}else S=Fe>=re.c*re.i;re=!S}if(re)return null;x.ga.Lc!=1?x.Ga=0:P=te-C}e(x.ga!=null),e(C+P<=te);e:{if(S=(le=x.ga).c,te=le.l.o,le.$a==0){if(ve=x.rc,Fe=x.Vc,Me=x.Fa,fe=x.P+1+C*S,xe=x.mb,je=x.nb+C*S,e(fe<=x.P+x.qc),le.Z!=0)for(e(To[le.Z]!=null),re=0;re<P;++re)To[le.Z](ve,Fe,Me,fe,xe,je,S),ve=xe,Fe=je,je+=S,fe+=S;else for(re=0;re<P;++re)a(xe,je,Me,fe,S),ve=xe,Fe=je,je+=S,fe+=S;x.rc=ve,x.Vc=Fe}else{if(e(le.mc!=null),S=C+P,e((re=le.mc)!=null),e(S<=re.i),re.C>=S)S=1;else if(le.ic||vs(),le.ic){le=re.V,ve=re.Ba,Fe=re.c;var at=re.i,Ue=(Me=1,fe=re.$/Fe,xe=re.$%Fe,je=re.m,We=re.s,re.$),tt=Fe*at,ot=Fe*S,xt=We.wc,ft=Ue<ot?J(We,xe,fe):null;e(Ue<=tt),e(S<=at),e(ue(We));t:for(;;){for(;!je.h&&Ue<ot;){if(xe&xt||(ft=J(We,xe,fe)),e(ft!=null),se(je),256>(at=ha(ft.G[0],ft.H[0],je)))le[ve+Ue]=at,++Ue,++xe>=Fe&&(xe=0,++fe<=S&&!(fe%16)&&be(re,fe));else{if(!(280>at)){Me=0;break t}at=On(at-256,je);var qt,Ot=ha(ft.G[4],ft.H[4],je);if(se(je),!(Ue>=(Ot=ei(Fe,Ot=On(Ot,je)))&&tt-Ue>=at)){Me=0;break t}for(qt=0;qt<at;++qt)le[ve+Ue+qt]=le[ve+Ue+qt-Ot];for(Ue+=at,xe+=at;xe>=Fe;)xe-=Fe,++fe<=S&&!(fe%16)&&be(re,fe);Ue<ot&&xe&xt&&(ft=J(We,xe,fe))}e(je.h==q(je))}be(re,fe>S?S:fe);break t}!Me||je.h&&Ue<tt?(Me=0,re.a=je.h?5:3):re.$=Ue,S=Me}else S=Be(re,re.V,re.Ba,re.c,re.i,S,pt);if(!S){P=0;break e}}C+P>=te&&(x.Cc=1),P=1}if(!P)return null;if(x.Cc&&((P=x.ga)!=null&&(P.mc=null),x.ga=null,0<x.Ga))return alert("todo:WebPDequantizeLevels"),null}return x.nb+C*X}function hn(x,S,C,P,X,te){for(;0<X--;){var re,le=x,fe=S+(C?1:0),xe=x,je=S+(C?0:3);for(re=0;re<P;++re){var We=xe[je+4*re];We!=255&&(We*=32897,le[fe+4*re+0]=le[fe+4*re+0]*We>>23,le[fe+4*re+1]=le[fe+4*re+1]*We>>23,le[fe+4*re+2]=le[fe+4*re+2]*We>>23)}S+=te}}function Qa(x,S,C,P,X){for(;0<P--;){var te;for(te=0;te<C;++te){var re=x[S+2*te+0],le=15&(xe=x[S+2*te+1]),fe=4369*le,xe=(240&xe|xe>>4)*fe>>16;x[S+2*te+0]=(240&re|re>>4)*fe>>16&240|(15&re|re<<4)*fe>>16>>4&15,x[S+2*te+1]=240&xe|le}S+=X}}function Rn(x,S,C,P,X,te,re,le){var fe,xe,je=255;for(xe=0;xe<X;++xe){for(fe=0;fe<P;++fe){var We=x[S+fe];te[re+4*fe]=We,je&=We}S+=C,re+=le}return je!=255}function vo(x,S,C,P,X){var te;for(te=0;te<X;++te)C[P+te]=x[S+te]>>8}function vs(){Rl=hn,Gi=Qa,bu=Rn,Mi=vo}function xo(x,S,C){D[x]=function(P,X,te,re,le,fe,xe,je,We,ve,Fe,Me,at,Ue,tt,ot,xt){var ft,qt=xt-1>>1,Ot=le[fe+0]|xe[je+0]<<16,mr=We[ve+0]|Fe[Me+0]<<16;e(P!=null);var Pt=3*Ot+mr+131074>>2;for(S(P[X+0],255&Pt,Pt>>16,at,Ue),te!=null&&(Pt=3*mr+Ot+131074>>2,S(te[re+0],255&Pt,Pt>>16,tt,ot)),ft=1;ft<=qt;++ft){var Or=le[fe+ft]|xe[je+ft]<<16,wa=We[ve+ft]|Fe[Me+ft]<<16,xr=Ot+Or+mr+wa+524296,Ft=xr+2*(Or+mr)>>3;Pt=Ft+Ot>>1,Ot=(xr=xr+2*(Ot+wa)>>3)+Or>>1,S(P[X+2*ft-1],255&Pt,Pt>>16,at,Ue+(2*ft-1)*C),S(P[X+2*ft-0],255&Ot,Ot>>16,at,Ue+(2*ft-0)*C),te!=null&&(Pt=xr+mr>>1,Ot=Ft+wa>>1,S(te[re+2*ft-1],255&Pt,Pt>>16,tt,ot+(2*ft-1)*C),S(te[re+2*ft+0],255&Ot,Ot>>16,tt,ot+(2*ft+0)*C)),Ot=Or,mr=wa}1&xt||(Pt=3*Ot+mr+131074>>2,S(P[X+xt-1],255&Pt,Pt>>16,at,Ue+(xt-1)*C),te!=null&&(Pt=3*mr+Ot+131074>>2,S(te[re+xt-1],255&Pt,Pt>>16,tt,ot+(xt-1)*C)))}}function xu(){Mn[Cf]=Pl,Mn[Vn]=Ec,Mn[Of]=e0,Mn[$i]=Pf,Mn[Au]=rl,Mn[wc]=Gs,Mn[Qo]=al,Mn[Nu]=Ec,Mn[Ff]=Pf,Mn[bc]=rl,Mn[Rf]=Gs}function pc(x){return x&-16384?0>x?0:255:x>>Mf}function Is(x,S){return pc((19077*x>>8)+(26149*S>>8)-14234)}function xs(x,S,C){return pc((19077*x>>8)-(6419*S>>8)-(13320*C>>8)+8708)}function Cl(x,S){return pc((19077*x>>8)+(33050*S>>8)-17685)}function yo(x,S,C,P,X){P[X+0]=Is(x,C),P[X+1]=xs(x,S,C),P[X+2]=Cl(x,S)}function bn(x,S,C,P,X){P[X+0]=Cl(x,S),P[X+1]=xs(x,S,C),P[X+2]=Is(x,C)}function Ko(x,S,C,P,X){var te=xs(x,S,C);S=te<<3&224|Cl(x,S)>>3,P[X+0]=248&Is(x,C)|te>>5,P[X+1]=S}function Jo(x,S,C,P,X){var te=240&Cl(x,S)|15;P[X+0]=240&Is(x,C)|xs(x,S,C)>>4,P[X+1]=te}function mc(x,S,C,P,X){P[X+0]=255,yo(x,S,C,P,X+1)}function Bs(x,S,C,P,X){bn(x,S,C,P,X),P[X+3]=255}function ni(x,S,C,P,X){yo(x,S,C,P,X),P[X+3]=255}function _o(x,S,C){D[x]=function(P,X,te,re,le,fe,xe,je,We){for(var ve=je+(-2&We)*C;je!=ve;)S(P[X+0],te[re+0],le[fe+0],xe,je),S(P[X+1],te[re+0],le[fe+0],xe,je+C),X+=2,++re,++fe,je+=2*C;1&We&&S(P[X+0],te[re+0],le[fe+0],xe,je)}}function gc(x,S,C){return C==0?x==0?S==0?6:5:S==0?4:0:C}function yu(x,S,C,P,X){switch(x>>>30){case 3:Ao(S,C,P,X,0);break;case 2:Hn(S,C,P,X);break;case 1:$r(S,C,P,X)}}function Di(x,S){var C,P,X=S.M,te=S.Nb,re=x.oc,le=x.pc+40,fe=x.oc,xe=x.pc+584,je=x.oc,We=x.pc+600;for(C=0;16>C;++C)re[le+32*C-1]=129;for(C=0;8>C;++C)fe[xe+32*C-1]=129,je[We+32*C-1]=129;for(0<X?re[le-1-32]=fe[xe-1-32]=je[We-1-32]=129:(n(re,le-32-1,127,21),n(fe,xe-32-1,127,9),n(je,We-32-1,127,9)),P=0;P<x.za;++P){var ve=S.ya[S.aa+P];if(0<P){for(C=-1;16>C;++C)a(re,le+32*C-4,re,le+32*C+12,4);for(C=-1;8>C;++C)a(fe,xe+32*C-4,fe,xe+32*C+4,4),a(je,We+32*C-4,je,We+32*C+4,4)}var Fe=x.Gd,Me=x.Hd+P,at=ve.ad,Ue=ve.Hc;if(0<X&&(a(re,le-32,Fe[Me].y,0,16),a(fe,xe-32,Fe[Me].f,0,8),a(je,We-32,Fe[Me].ea,0,8)),ve.Za){var tt=re,ot=le-32+16;for(0<X&&(P>=x.za-1?n(tt,ot,Fe[Me].y[15],4):a(tt,ot,Fe[Me+1].y,0,4)),C=0;4>C;C++)tt[ot+128+C]=tt[ot+256+C]=tt[ot+384+C]=tt[ot+0+C];for(C=0;16>C;++C,Ue<<=2)tt=re,ot=le+Wa[C],Pa[ve.Ob[C]](tt,ot),yu(Ue,at,16*+C,tt,ot)}else if(tt=gc(P,X,ve.Ob[0]),si[tt](re,le),Ue!=0)for(C=0;16>C;++C,Ue<<=2)yu(Ue,at,16*+C,re,le+Wa[C]);for(C=ve.Gc,tt=gc(P,X,ve.Dd),bs[tt](fe,xe),bs[tt](je,We),Ue=at,tt=fe,ot=xe,255&(ve=0|C)&&(170&ve?Vi(Ue,256,tt,ot):Br(Ue,256,tt,ot)),ve=je,Ue=We,255&(C>>=8)&&(170&C?Vi(at,320,ve,Ue):Br(at,320,ve,Ue)),X<x.Ub-1&&(a(Fe[Me].y,0,re,le+480,16),a(Fe[Me].f,0,fe,xe+224,8),a(Fe[Me].ea,0,je,We+224,8)),C=8*te*x.B,Fe=x.sa,Me=x.ta+16*P+16*te*x.R,at=x.qa,ve=x.ra+8*P+C,Ue=x.Ha,tt=x.Ia+8*P+C,C=0;16>C;++C)a(Fe,Me+C*x.R,re,le+32*C,16);for(C=0;8>C;++C)a(at,ve+C*x.B,fe,xe+32*C,8),a(Ue,tt+C*x.B,je,We+32*C,8)}}function ys(x,S,C,P,X,te,re,le,fe){var xe=[0],je=[0],We=0,ve=fe!=null?fe.kd:0,Fe=fe??new ht;if(x==null||12>C)return 7;Fe.data=x,Fe.w=S,Fe.ha=C,S=[S],C=[C],Fe.gb=[Fe.gb];e:{var Me=S,at=C,Ue=Fe.gb;if(e(x!=null),e(at!=null),e(Ue!=null),Ue[0]=0,12<=at[0]&&!r(x,Me[0],"RIFF")){if(r(x,Me[0]+8,"WEBP")){Ue=3;break e}var tt=Je(x,Me[0]+4);if(12>tt||4294967286<tt){Ue=3;break e}if(ve&&tt>at[0]-8){Ue=7;break e}Ue[0]=tt,Me[0]+=12,at[0]-=12}Ue=0}if(Ue!=0)return Ue;for(tt=0<Fe.gb[0],C=C[0];;){e:{var ot=x;at=S,Ue=C;var xt=xe,ft=je,qt=Me=[0];if((Pt=We=[We])[0]=0,8>Ue[0])Ue=7;else{if(!r(ot,at[0],"VP8X")){if(Je(ot,at[0]+4)!=10){Ue=3;break e}if(18>Ue[0]){Ue=7;break e}var Ot=Je(ot,at[0]+8),mr=1+rt(ot,at[0]+12);if(2147483648<=mr*(ot=1+rt(ot,at[0]+15))){Ue=3;break e}qt!=null&&(qt[0]=Ot),xt!=null&&(xt[0]=mr),ft!=null&&(ft[0]=ot),at[0]+=18,Ue[0]-=18,Pt[0]=1}Ue=0}}if(We=We[0],Me=Me[0],Ue!=0)return Ue;if(at=!!(2&Me),!tt&&We)return 3;if(te!=null&&(te[0]=!!(16&Me)),re!=null&&(re[0]=at),le!=null&&(le[0]=0),re=xe[0],Me=je[0],We&&at&&fe==null){Ue=0;break}if(4>C){Ue=7;break}if(tt&&We||!tt&&!We&&!r(x,S[0],"ALPH")){C=[C],Fe.na=[Fe.na],Fe.P=[Fe.P],Fe.Sa=[Fe.Sa];e:{Ot=x,Ue=S,tt=C;var Pt=Fe.gb;xt=Fe.na,ft=Fe.P,qt=Fe.Sa,mr=22,e(Ot!=null),e(tt!=null),ot=Ue[0];var Or=tt[0];for(e(xt!=null),e(qt!=null),xt[0]=null,ft[0]=null,qt[0]=0;;){if(Ue[0]=ot,tt[0]=Or,8>Or){Ue=7;break e}var wa=Je(Ot,ot+4);if(4294967286<wa){Ue=3;break e}var xr=8+wa+1&-2;if(mr+=xr,0<Pt&&mr>Pt){Ue=3;break e}if(!r(Ot,ot,"VP8 ")||!r(Ot,ot,"VP8L")){Ue=0;break e}if(Or[0]<xr){Ue=7;break e}r(Ot,ot,"ALPH")||(xt[0]=Ot,ft[0]=ot+8,qt[0]=wa),ot+=xr,Or-=xr}}if(C=C[0],Fe.na=Fe.na[0],Fe.P=Fe.P[0],Fe.Sa=Fe.Sa[0],Ue!=0)break}C=[C],Fe.Ja=[Fe.Ja],Fe.xa=[Fe.xa];e:if(Pt=x,Ue=S,tt=C,xt=Fe.gb[0],ft=Fe.Ja,qt=Fe.xa,Ot=Ue[0],ot=!r(Pt,Ot,"VP8 "),mr=!r(Pt,Ot,"VP8L"),e(Pt!=null),e(tt!=null),e(ft!=null),e(qt!=null),8>tt[0])Ue=7;else{if(ot||mr){if(Pt=Je(Pt,Ot+4),12<=xt&&Pt>xt-12){Ue=3;break e}if(ve&&Pt>tt[0]-8){Ue=7;break e}ft[0]=Pt,Ue[0]+=8,tt[0]-=8,qt[0]=mr}else qt[0]=5<=tt[0]&&Pt[Ot+0]==47&&!(Pt[Ot+4]>>5),ft[0]=tt[0];Ue=0}if(C=C[0],Fe.Ja=Fe.Ja[0],Fe.xa=Fe.xa[0],S=S[0],Ue!=0)break;if(4294967286<Fe.Ja)return 3;if(le==null||at||(le[0]=Fe.xa?2:1),re=[re],Me=[Me],Fe.xa){if(5>C){Ue=7;break}le=re,ve=Me,at=te,x==null||5>C?x=0:5<=C&&x[S+0]==47&&!(x[S+4]>>5)?(tt=[0],Pt=[0],xt=[0],Z(ft=new M,x,S,C),zi(ft,tt,Pt,xt)?(le!=null&&(le[0]=tt[0]),ve!=null&&(ve[0]=Pt[0]),at!=null&&(at[0]=xt[0]),x=1):x=0):x=0}else{if(10>C){Ue=7;break}le=Me,x==null||10>C||!lu(x,S+3,C-3)?x=0:(ve=x[S+0]|x[S+1]<<8|x[S+2]<<16,at=16383&(x[S+7]<<8|x[S+6]),x=16383&(x[S+9]<<8|x[S+8]),1&ve||3<(ve>>1&7)||!(ve>>4&1)||ve>>5>=Fe.Ja||!at||!x?x=0:(re&&(re[0]=at),le&&(le[0]=x),x=1))}if(!x||(re=re[0],Me=Me[0],We&&(xe[0]!=re||je[0]!=Me)))return 3;fe!=null&&(fe[0]=Fe,fe.offset=S-fe.w,e(4294967286>S-fe.w),e(fe.offset==fe.ha-C));break}return Ue==0||Ue==7&&We&&fe==null?(te!=null&&(te[0]|=Fe.na!=null&&0<Fe.na.length),P!=null&&(P[0]=re),X!=null&&(X[0]=Me),0):Ue}function wo(x,S,C){var P=S.width,X=S.height,te=0,re=0,le=P,fe=X;if(S.Da=x!=null&&0<x.Da,S.Da&&(le=x.cd,fe=x.bd,te=x.v,re=x.j,11>C||(te&=-2,re&=-2),0>te||0>re||0>=le||0>=fe||te+le>P||re+fe>X))return 0;if(S.v=te,S.j=re,S.va=te+le,S.o=re+fe,S.U=le,S.T=fe,S.da=x!=null&&0<x.da,S.da){if(!gt(le,fe,C=[x.ib],te=[x.hb]))return 0;S.ib=C[0],S.hb=te[0]}return S.ob=x!=null&&x.ob,S.Kb=x==null||!x.Sd,S.da&&(S.ob=S.ib<3*P/4&&S.hb<3*X/4,S.Kb=0),1}function _u(x){if(x==null)return 2;if(11>x.S){var S=x.f.RGBA;S.fb+=(x.height-1)*S.A,S.A=-S.A}else S=x.f.kb,x=x.height,S.O+=(x-1)*S.fa,S.fa=-S.fa,S.N+=(x-1>>1)*S.Ab,S.Ab=-S.Ab,S.W+=(x-1>>1)*S.Db,S.Db=-S.Db,S.F!=null&&(S.J+=(x-1)*S.lb,S.lb=-S.lb);return 0}function _s(x,S,C,P){if(P==null||0>=x||0>=S)return 2;if(C!=null){if(C.Da){var X=C.cd,te=C.bd,re=-2&C.v,le=-2&C.j;if(0>re||0>le||0>=X||0>=te||re+X>x||le+te>S)return 2;x=X,S=te}if(C.da){if(!gt(x,S,X=[C.ib],te=[C.hb]))return 2;x=X[0],S=te[0]}}P.width=x,P.height=S;e:{var fe=P.width,xe=P.height;if(x=P.S,0>=fe||0>=xe||!(x>=Cf&&13>x))x=2;else{if(0>=P.Rd&&P.sd==null){re=te=X=S=0;var je=(le=fe*Bf[x])*xe;if(11>x||(te=(xe+1)/2*(S=(fe+1)/2),x==12&&(re=(X=fe)*xe)),(xe=i(je+2*te+re))==null){x=1;break e}P.sd=xe,11>x?((fe=P.f.RGBA).eb=xe,fe.fb=0,fe.A=le,fe.size=je):((fe=P.f.kb).y=xe,fe.O=0,fe.fa=le,fe.Fd=je,fe.f=xe,fe.N=0+je,fe.Ab=S,fe.Cd=te,fe.ea=xe,fe.W=0+je+te,fe.Db=S,fe.Ed=te,x==12&&(fe.F=xe,fe.J=0+je+2*te),fe.Tc=re,fe.lb=X)}if(S=1,X=P.S,te=P.width,re=P.height,X>=Cf&&13>X)if(11>X)x=P.f.RGBA,S&=(le=Math.abs(x.A))*(re-1)+te<=x.size,S&=le>=te*Bf[X],S&=x.eb!=null;else{x=P.f.kb,le=(te+1)/2,je=(re+1)/2,fe=Math.abs(x.fa),xe=Math.abs(x.Ab);var We=Math.abs(x.Db),ve=Math.abs(x.lb),Fe=ve*(re-1)+te;S&=fe*(re-1)+te<=x.Fd,S&=xe*(je-1)+le<=x.Cd,S=(S&=We*(je-1)+le<=x.Ed)&fe>=te&xe>=le&We>=le,S&=x.y!=null,S&=x.f!=null,S&=x.ea!=null,X==12&&(S&=ve>=te,S&=Fe<=x.Tc,S&=x.F!=null)}else S=0;x=S?0:2}}return x!=0||C!=null&&C.fd&&(x=_u(P)),x}var Zo=64,gi=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ii=24,Us=32,qs=8,bo=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];vt("Predictor0","PredictorAdd0"),D.Predictor0=function(){return 4278190080},D.Predictor1=function(x){return x},D.Predictor2=function(x,S,C){return S[C+0]},D.Predictor3=function(x,S,C){return S[C+1]},D.Predictor4=function(x,S,C){return S[C-1]},D.Predictor5=function(x,S,C){return Et(Et(x,S[C+1]),S[C+0])},D.Predictor6=function(x,S,C){return Et(x,S[C-1])},D.Predictor7=function(x,S,C){return Et(x,S[C+0])},D.Predictor8=function(x,S,C){return Et(S[C-1],S[C+0])},D.Predictor9=function(x,S,C){return Et(S[C+0],S[C+1])},D.Predictor10=function(x,S,C){return Et(Et(x,S[C-1]),Et(S[C+0],S[C+1]))},D.Predictor11=function(x,S,C){var P=S[C+0];return 0>=Vt(P>>24&255,x>>24&255,(S=S[C-1])>>24&255)+Vt(P>>16&255,x>>16&255,S>>16&255)+Vt(P>>8&255,x>>8&255,S>>8&255)+Vt(255&P,255&x,255&S)?P:x},D.Predictor12=function(x,S,C){var P=S[C+0];return(It((x>>24&255)+(P>>24&255)-((S=S[C-1])>>24&255))<<24|It((x>>16&255)+(P>>16&255)-(S>>16&255))<<16|It((x>>8&255)+(P>>8&255)-(S>>8&255))<<8|It((255&x)+(255&P)-(255&S)))>>>0},D.Predictor13=function(x,S,C){var P=S[C-1];return(er((x=Et(x,S[C+0]))>>24&255,P>>24&255)<<24|er(x>>16&255,P>>16&255)<<16|er(x>>8&255,P>>8&255)<<8|er(255&x,255&P))>>>0};var vc=D.PredictorAdd0;D.PredictorAdd1=Oe,vt("Predictor2","PredictorAdd2"),vt("Predictor3","PredictorAdd3"),vt("Predictor4","PredictorAdd4"),vt("Predictor5","PredictorAdd5"),vt("Predictor6","PredictorAdd6"),vt("Predictor7","PredictorAdd7"),vt("Predictor8","PredictorAdd8"),vt("Predictor9","PredictorAdd9"),vt("Predictor10","PredictorAdd10"),vt("Predictor11","PredictorAdd11"),vt("Predictor12","PredictorAdd12"),vt("Predictor13","PredictorAdd13");var xc=D.PredictorAdd2;mt("ColorIndexInverseTransform","MapARGB","32b",function(x){return x>>8&255},function(x){return x}),mt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(x){return x},function(x){return x>>8&255});var za,Nf=D.ColorIndexInverseTransform,zs=D.MapARGB,Hs=D.VP8LColorIndexInverseTransformAlpha,Ln=D.MapAlpha,So=D.VP8LPredictorsAdd=[];So.length=16,(D.VP8LPredictors=[]).length=16,(D.VP8LPredictorsAdd_C=[]).length=16,(D.VP8LPredictors_C=[]).length=16;var yc,_c,Eo,ko,Ws,Ol,Pi,Ao,Hn,Vi,$r,Br,pa,Ha,Vs,ws,Fl,wu,Yh,Nd,Td,jd,Kh,Jh,Rl,Gi,bu,Mi,Ll=i(511),Tf=i(2041),Su=i(225),Eu=i(767),jf=0,No=Tf,ku=Su,Wn=Eu,Dn=Ll,Cf=0,Vn=1,Of=2,$i=3,Au=4,wc=5,Qo=6,Nu=7,Ff=8,bc=9,Rf=10,Xi=[2,3,7],Sc=[3,3,11],Dl=[280,256,256,256,40],Lf=[0,1,1,1,0],Tu=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Yi=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Ki=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],el=8,Ji=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Zi=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ii=null,Cd=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Zh=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Df=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Od=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Pn=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],_a=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Rr=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],si=[],Pa=[],bs=[],tl=1,Qh=2,To=[],Mn=[];xo("UpsampleRgbLinePair",yo,3),xo("UpsampleBgrLinePair",bn,3),xo("UpsampleRgbaLinePair",ni,4),xo("UpsampleBgraLinePair",Bs,4),xo("UpsampleArgbLinePair",mc,4),xo("UpsampleRgba4444LinePair",Jo,2),xo("UpsampleRgb565LinePair",Ko,2);var Pl=D.UpsampleRgbLinePair,e0=D.UpsampleBgrLinePair,Ec=D.UpsampleRgbaLinePair,Pf=D.UpsampleBgraLinePair,rl=D.UpsampleArgbLinePair,Gs=D.UpsampleRgba4444LinePair,al=D.UpsampleRgb565LinePair,Qi=16,kc=1<<Qi-1,Ml=-227,nl=482,Mf=6,il=0,In=i(256),If=i(256),Fd=i(256),$p=i(256),Xp=i(nl-Ml),Yp=i(nl-Ml);_o("YuvToRgbRow",yo,3),_o("YuvToBgrRow",bn,3),_o("YuvToRgbaRow",ni,4),_o("YuvToBgraRow",Bs,4),_o("YuvToArgbRow",mc,4),_o("YuvToRgba4444Row",Jo,2),_o("YuvToRgb565Row",Ko,2);var Wa=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ac=[0,2,8],ju=[8,7,6,4,4,2,2,2,1,1,1,1],Cu=1;this.WebPDecodeRGBA=function(x,S,C,P,X){var te=Vn,re=new st,le=new pr;re.ba=le,le.S=te,le.width=[le.width],le.height=[le.height];var fe=le.width,xe=le.height,je=new Dt;if(je==null||x==null)var We=2;else e(je!=null),We=ys(x,S,C,je.width,je.height,je.Pd,je.Qd,je.format,null);if(We!=0?fe=0:(fe!=null&&(fe[0]=je.width[0]),xe!=null&&(xe[0]=je.height[0]),fe=1),fe){le.width=le.width[0],le.height=le.height[0],P!=null&&(P[0]=le.width),X!=null&&(X[0]=le.height);e:{if(P=new lo,(X=new ht).data=x,X.w=S,X.ha=C,X.kd=1,S=[0],e(X!=null),((x=ys(X.data,X.w,X.ha,null,null,null,S,null,X))==0||x==7)&&S[0]&&(x=4),(S=x)==0){if(e(re!=null),P.data=X.data,P.w=X.w+X.offset,P.ha=X.ha-X.offset,P.put=Kt,P.ac=Ja,P.bc=fs,P.ma=re,X.xa){if((x=qe())==null){re=1;break e}if((function(ve,Fe){var Me=[0],at=[0],Ue=[0];t:for(;;){if(ve==null)return 0;if(Fe==null)return ve.a=2,0;if(ve.l=Fe,ve.a=0,Z(ve.m,Fe.data,Fe.w,Fe.ha),!zi(ve.m,Me,at,Ue)){ve.a=3;break t}if(ve.xb=Qh,Fe.width=Me[0],Fe.height=at[0],!ze(Me[0],at[0],1,ve,null))break t;return 1}return e(ve.a!=0),0})(x,P)){if(P=(S=_s(P.width,P.height,re.Oa,re.ba))==0){t:{P=x;r:for(;;){if(P==null){P=0;break t}if(e(P.s.yc!=null),e(P.s.Ya!=null),e(0<P.s.Wb),e((C=P.l)!=null),e((X=C.ma)!=null),P.xb!=0){if(P.ca=X.ba,P.tb=X.tb,e(P.ca!=null),!wo(X.Oa,C,$i)){P.a=2;break r}if(!Ve(P,C.width)||C.da)break r;if((C.da||Zt(P.ca.S))&&vs(),11>P.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),P.ca.f.kb.F!=null&&vs()),P.Pb&&0<P.s.ua&&P.s.vb.X==null&&!V(P.s.vb,P.s.Wa.Xa)){P.a=1;break r}P.xb=0}if(!Be(P,P.V,P.Ba,P.c,P.i,C.o,ce))break r;X.Dc=P.Ma,P=1;break t}e(P.a!=0),P=0}P=!P}P&&(S=x.a)}else S=x.a}else{if((x=new ps)==null){re=1;break e}if(x.Fa=X.na,x.P=X.P,x.qc=X.Sa,Ds(x,P)){if((S=_s(P.width,P.height,re.Oa,re.ba))==0){if(x.Aa=0,C=re.Oa,e((X=x)!=null),C!=null){if(0<(fe=0>(fe=C.Md)?0:100<fe?255:255*fe/100)){for(xe=je=0;4>xe;++xe)12>(We=X.pb[xe]).lc&&(We.ia=fe*ju[0>We.lc?0:We.lc]>>3),je|=We.ia;je&&(alert("todo:VP8InitRandom"),X.ia=1)}X.Ga=C.Id,100<X.Ga?X.Ga=100:0>X.Ga&&(X.Ga=0)}(function(ve,Fe){if(ve==null)return 0;if(Fe==null)return Gr(ve,2,"NULL VP8Io parameter in VP8Decode().");if(!ve.cb&&!Ds(ve,Fe))return 0;if(e(ve.cb),Fe.ac==null||Fe.ac(Fe)){Fe.ob&&(ve.L=0);var Me=Ac[ve.L];if(ve.L==2?(ve.yb=0,ve.zb=0):(ve.yb=Fe.v-Me>>4,ve.zb=Fe.j-Me>>4,0>ve.yb&&(ve.yb=0),0>ve.zb&&(ve.zb=0)),ve.Va=Fe.o+15+Me>>4,ve.Hb=Fe.va+15+Me>>4,ve.Hb>ve.za&&(ve.Hb=ve.za),ve.Va>ve.Ub&&(ve.Va=ve.Ub),0<ve.L){var at=ve.ed;for(Me=0;4>Me;++Me){var Ue;if(ve.Qa.Cb){var tt=ve.Qa.Lb[Me];ve.Qa.Fb||(tt+=at.Tb)}else tt=at.Tb;for(Ue=0;1>=Ue;++Ue){var ot=ve.gd[Me][Ue],xt=tt;if(at.Pc&&(xt+=at.vd[0],Ue&&(xt+=at.od[0])),0<(xt=0>xt?0:63<xt?63:xt)){var ft=xt;0<at.wb&&(ft=4<at.wb?ft>>2:ft>>1)>9-at.wb&&(ft=9-at.wb),1>ft&&(ft=1),ot.dd=ft,ot.tc=2*xt+ft,ot.ld=40<=xt?2:15<=xt?1:0}else ot.tc=0;ot.La=Ue}}}Me=0}else Gr(ve,6,"Frame setup failed"),Me=ve.a;if(Me=Me==0){if(Me){ve.$c=0,0<ve.Aa||(ve.Ic=Cu);t:{Me=ve.Ic,at=4*(ft=ve.za);var qt=32*ft,Ot=ft+1,mr=0<ve.L?ft*(0<ve.Aa?2:1):0,Pt=(ve.Aa==2?2:1)*ft;if((ot=at+832+(Ue=3*(16*Me+Ac[ve.L])/2*qt)+(tt=ve.Fa!=null&&0<ve.Fa.length?ve.Kc.c*ve.Kc.i:0))!=ot)Me=0;else{if(ot>ve.Vb){if(ve.Vb=0,ve.Ec=i(ot),ve.Fc=0,ve.Ec==null){Me=Gr(ve,1,"no memory during frame initialization.");break t}ve.Vb=ot}ot=ve.Ec,xt=ve.Fc,ve.Ac=ot,ve.Bc=xt,xt+=at,ve.Gd=o(qt,Fi),ve.Hd=0,ve.rb=o(Ot+1,na),ve.sb=1,ve.wa=mr?o(mr,jr):null,ve.Y=0,ve.D.Nb=0,ve.D.wa=ve.wa,ve.D.Y=ve.Y,0<ve.Aa&&(ve.D.Y+=ft),e(!0),ve.oc=ot,ve.pc=xt,xt+=832,ve.ya=o(Pt,hs),ve.aa=0,ve.D.ya=ve.ya,ve.D.aa=ve.aa,ve.Aa==2&&(ve.D.aa+=ft),ve.R=16*ft,ve.B=8*ft,ft=(qt=Ac[ve.L])*ve.R,qt=qt/2*ve.B,ve.sa=ot,ve.ta=xt+ft,ve.qa=ve.sa,ve.ra=ve.ta+16*Me*ve.R+qt,ve.Ha=ve.qa,ve.Ia=ve.ra+8*Me*ve.B+qt,ve.$c=0,xt+=Ue,ve.mb=tt?ot:null,ve.nb=tt?xt:null,e(xt+tt<=ve.Fc+ve.Vb),cu(ve),n(ve.Ac,ve.Bc,0,at),Me=1}}if(Me){if(Fe.ka=0,Fe.y=ve.sa,Fe.O=ve.ta,Fe.f=ve.qa,Fe.N=ve.ra,Fe.ea=ve.Ha,Fe.Vd=ve.Ia,Fe.fa=ve.R,Fe.Rc=ve.B,Fe.F=null,Fe.J=0,!jf){for(Me=-255;255>=Me;++Me)Ll[255+Me]=0>Me?-Me:Me;for(Me=-1020;1020>=Me;++Me)Tf[1020+Me]=-128>Me?-128:127<Me?127:Me;for(Me=-112;112>=Me;++Me)Su[112+Me]=-16>Me?-16:15<Me?15:Me;for(Me=-255;510>=Me;++Me)Eu[255+Me]=0>Me?0:255<Me?255:Me;jf=1}Pi=ms,Ao=uu,Vi=ai,$r=fu,Br=hu,Hn=xf,pa=kf,Ha=go,Vs=G,ws=_e,Fl=Af,wu=j,Yh=Te,Nd=De,Td=fo,jd=ho,Kh=jl,Jh=vu,Pa[0]=Sf,Pa[1]=yf,Pa[2]=bf,Pa[3]=mu,Pa[4]=Ri,Pa[5]=gu,Pa[6]=Fn,Pa[7]=Al,Pa[8]=Nl,Pa[9]=Li,si[0]=gs,si[1]=du,si[2]=pu,si[3]=wf,si[4]=co,si[5]=kl,si[6]=Yo,bs[0]=fc,bs[1]=_f,bs[2]=Ps,bs[3]=Ef,bs[4]=wn,bs[5]=hc,bs[6]=Ms,Me=1}else Me=0}Me&&(Me=(function(Or,wa){for(Or.M=0;Or.M<Or.Va;++Or.M){var xr,Ft=Or.Jc[Or.M&Or.Xb],Nt=Or.m,Na=Or;for(xr=0;xr<Na.za;++xr){var or=Nt,wr=Na,ta=wr.Ac,dn=wr.Bc+4*xr,Bn=wr.zc,ma=wr.ya[wr.aa+xr];if(wr.Qa.Bb?ma.$b=Se(or,wr.Pa.jb[0])?2+Se(or,wr.Pa.jb[2]):Se(or,wr.Pa.jb[1]):ma.$b=0,wr.kc&&(ma.Ad=Se(or,wr.Bd)),ma.Za=!Se(or,145)+0,ma.Za){var en=ma.Ob,Gn=0;for(wr=0;4>wr;++wr){var tn,Nr=Bn[0+wr];for(tn=0;4>tn;++tn){Nr=Pn[ta[dn+tn]][Nr];for(var qr=Df[Se(or,Nr[0])];0<qr;)qr=Df[2*qr+Se(or,Nr[qr])];Nr=-qr,ta[dn+tn]=Nr}a(en,Gn,ta,dn,4),Gn+=4,Bn[0+wr]=Nr}}else Nr=Se(or,156)?Se(or,128)?1:3:Se(or,163)?2:0,ma.Ob[0]=Nr,n(ta,dn,Nr,4),n(Bn,0,Nr,4);ma.Dd=Se(or,142)?Se(or,114)?Se(or,183)?1:3:2:0}if(Na.m.Ka)return Gr(Or,7,"Premature end-of-partition0 encountered.");for(;Or.ja<Or.za;++Or.ja){if(Na=Ft,or=(Nt=Or).rb[Nt.sb-1],ta=Nt.rb[Nt.sb+Nt.ja],xr=Nt.ya[Nt.aa+Nt.ja],dn=Nt.kc?xr.Ad:0)or.la=ta.la=0,xr.Za||(or.Na=ta.Na=0),xr.Hc=0,xr.Gc=0,xr.ia=0;else{var Ta,Xr;if(or=ta,ta=Na,dn=Nt.Pa.Xc,Bn=Nt.ya[Nt.aa+Nt.ja],ma=Nt.pb[Bn.$b],wr=Bn.ad,en=0,Gn=Nt.rb[Nt.sb-1],Nr=tn=0,n(wr,en,0,384),Bn.Za)var pn=0,ja=dn[3];else{qr=i(16);var zr=or.Na+Gn.Na;if(zr=Ii(ta,dn[1],zr,ma.Eb,0,qr,0),or.Na=Gn.Na=(0<zr)+0,1<zr)Pi(qr,0,wr,en);else{var Va=qr[0]+3>>3;for(qr=0;256>qr;qr+=16)wr[en+qr]=Va}pn=1,ja=dn[0]}var ra=15&or.la,rn=15&Gn.la;for(qr=0;4>qr;++qr){var an=1&rn;for(Va=Xr=0;4>Va;++Va)ra=ra>>1|(an=(zr=Ii(ta,ja,zr=an+(1&ra),ma.Sc,pn,wr,en))>pn)<<7,Xr=Xr<<2|(3<zr?3:1<zr?2:wr[en+0]!=0),en+=16;ra>>=4,rn=rn>>1|an<<7,tn=(tn<<8|Xr)>>>0}for(ja=ra,pn=rn>>4,Ta=0;4>Ta;Ta+=2){for(Xr=0,ra=or.la>>4+Ta,rn=Gn.la>>4+Ta,qr=0;2>qr;++qr){for(an=1&rn,Va=0;2>Va;++Va)zr=an+(1&ra),ra=ra>>1|(an=0<(zr=Ii(ta,dn[2],zr,ma.Qc,0,wr,en)))<<3,Xr=Xr<<2|(3<zr?3:1<zr?2:wr[en+0]!=0),en+=16;ra>>=2,rn=rn>>1|an<<5}Nr|=Xr<<4*Ta,ja|=ra<<4<<Ta,pn|=(240&rn)<<Ta}or.la=ja,Gn.la=pn,Bn.Hc=tn,Bn.Gc=Nr,Bn.ia=43690&Nr?0:ma.ia,dn=!(tn|Nr)}if(0<Nt.L&&(Nt.wa[Nt.Y+Nt.ja]=Nt.gd[xr.$b][xr.Za],Nt.wa[Nt.Y+Nt.ja].La|=!dn),Na.Ka)return Gr(Or,7,"Premature end-of-file encountered.")}if(cu(Or),Nt=wa,Na=1,xr=(Ft=Or).D,or=0<Ft.L&&Ft.M>=Ft.zb&&Ft.M<=Ft.Va,Ft.Aa==0)t:{if(xr.M=Ft.M,xr.uc=or,Di(Ft,xr),Na=1,xr=(Xr=Ft.D).Nb,or=(Nr=Ac[Ft.L])*Ft.R,ta=Nr/2*Ft.B,qr=16*xr*Ft.R,Va=8*xr*Ft.B,dn=Ft.sa,Bn=Ft.ta-or+qr,ma=Ft.qa,wr=Ft.ra-ta+Va,en=Ft.Ha,Gn=Ft.Ia-ta+Va,rn=(ra=Xr.M)==0,tn=ra>=Ft.Va-1,Ft.Aa==2&&Di(Ft,Xr),Xr.uc)for(an=(zr=Ft).D.M,e(zr.D.uc),Xr=zr.yb;Xr<zr.Hb;++Xr){pn=Xr,ja=an;var ia=(Ur=(nn=zr).D).Nb;Ta=nn.R;var Ur=Ur.wa[Ur.Y+pn],$n=nn.sa,Ma=nn.ta+16*ia*Ta+16*pn,Qt=Ur.dd,tr=Ur.tc;if(tr!=0)if(e(3<=tr),nn.L==1)0<pn&&jd($n,Ma,Ta,tr+4),Ur.La&&Jh($n,Ma,Ta,tr),0<ja&&Td($n,Ma,Ta,tr+4),Ur.La&&Kh($n,Ma,Ta,tr);else{var Hr=nn.B,vi=nn.qa,es=nn.ra+8*ia*Hr+8*pn,oi=nn.Ha,nn=nn.Ia+8*ia*Hr+8*pn;ia=Ur.ld,0<pn&&(Ha($n,Ma,Ta,tr+4,Qt,ia),ws(vi,es,oi,nn,Hr,tr+4,Qt,ia)),Ur.La&&(wu($n,Ma,Ta,tr,Qt,ia),Nd(vi,es,oi,nn,Hr,tr,Qt,ia)),0<ja&&(pa($n,Ma,Ta,tr+4,Qt,ia),Vs(vi,es,oi,nn,Hr,tr+4,Qt,ia)),Ur.La&&(Fl($n,Ma,Ta,tr,Qt,ia),Yh(vi,es,oi,nn,Hr,tr,Qt,ia))}}if(Ft.ia&&alert("todo:DitherRow"),Nt.put!=null){if(Xr=16*ra,ra=16*(ra+1),rn?(Nt.y=Ft.sa,Nt.O=Ft.ta+qr,Nt.f=Ft.qa,Nt.N=Ft.ra+Va,Nt.ea=Ft.Ha,Nt.W=Ft.Ia+Va):(Xr-=Nr,Nt.y=dn,Nt.O=Bn,Nt.f=ma,Nt.N=wr,Nt.ea=en,Nt.W=Gn),tn||(ra-=Nr),ra>Nt.o&&(ra=Nt.o),Nt.F=null,Nt.J=null,Ft.Fa!=null&&0<Ft.Fa.length&&Xr<ra&&(Nt.J=da(Ft,Nt,Xr,ra-Xr),Nt.F=Ft.mb,Nt.F==null&&Nt.F.length==0)){Na=Gr(Ft,3,"Could not decode alpha data.");break t}Xr<Nt.j&&(Nr=Nt.j-Xr,Xr=Nt.j,e(!(1&Nr)),Nt.O+=Ft.R*Nr,Nt.N+=Ft.B*(Nr>>1),Nt.W+=Ft.B*(Nr>>1),Nt.F!=null&&(Nt.J+=Nt.width*Nr)),Xr<ra&&(Nt.O+=Nt.v,Nt.N+=Nt.v>>1,Nt.W+=Nt.v>>1,Nt.F!=null&&(Nt.J+=Nt.v),Nt.ka=Xr-Nt.j,Nt.U=Nt.va-Nt.v,Nt.T=ra-Xr,Na=Nt.put(Nt))}xr+1!=Ft.Ic||tn||(a(Ft.sa,Ft.ta-or,dn,Bn+16*Ft.R,or),a(Ft.qa,Ft.ra-ta,ma,wr+8*Ft.B,ta),a(Ft.Ha,Ft.Ia-ta,en,Gn+8*Ft.B,ta))}if(!Na)return Gr(Or,6,"Output aborted.")}return 1})(ve,Fe)),Fe.bc!=null&&Fe.bc(Fe),Me&=1}return Me?(ve.cb=0,Me):0})(x,P)||(S=x.a)}}else S=x.a}S==0&&re.Oa!=null&&re.Oa.fd&&(S=_u(re.ba))}re=S}te=re!=0?null:11>te?le.f.RGBA.eb:le.f.kb.y}else te=null;return te};var Bf=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(D,Y){for(var I="",L=0;L<4;L++)I+=String.fromCharCode(D[Y++]);return I}function d(D,Y){return D[Y+0]|D[Y+1]<<8}function v(D,Y){return(D[Y+0]|D[Y+1]<<8|D[Y+2]<<16)>>>0}function y(D,Y){return(D[Y+0]|D[Y+1]<<8|D[Y+2]<<16|D[Y+3]<<24)>>>0}new u;var g=[0],b=[0],w=[],E=new u,A=t,O=(function(D,Y){var I={},L=0,ee=!1,oe=0,ge=0;if(I.frames=[],!(function(N,M){for(var B=0;B<4;B++)if(N[M+B]!="RIFF".charCodeAt(B))return!0;return!1})(D,Y)){for(y(D,Y+=4),Y+=8;Y<D.length;){var ie=h(D,Y),he=y(D,Y+=4);Y+=4;var de=he+(1&he);switch(ie){case"VP8 ":case"VP8L":I.frames[L]===void 0&&(I.frames[L]={}),(Q=I.frames[L]).src_off=ee?ge:Y-8,Q.src_size=oe+he+8,L++,ee&&(ee=!1,oe=0,ge=0);break;case"VP8X":(Q=I.header={}).feature_flags=D[Y];var Z=Y+4;Q.canvas_width=1+v(D,Z),Z+=3,Q.canvas_height=1+v(D,Z),Z+=3;break;case"ALPH":ee=!0,oe=de+8,ge=Y-8;break;case"ANIM":(Q=I.header).bgcolor=y(D,Y),Z=Y+4,Q.loop_count=d(D,Z),Z+=2;break;case"ANMF":var Ne,Q;(Q=I.frames[L]={}).offset_x=2*v(D,Y),Y+=3,Q.offset_y=2*v(D,Y),Y+=3,Q.width=1+v(D,Y),Y+=3,Q.height=1+v(D,Y),Y+=3,Q.duration=v(D,Y),Y+=3,Ne=D[Y++],Q.dispose=1&Ne,Q.blend=Ne>>1&1}ie!="ANMF"&&(Y+=de)}return I}})(A,0);O.response=A,O.rgbaoutput=!0,O.dataurl=!1;var T=O.header?O.header:null,R=O.frames?O.frames:null;if(T){T.loop_counter=T.loop_count,g=[T.canvas_height],b=[T.canvas_width];for(var H=0;H<R.length&&R[H].blend!=0;H++);}var z=R[0],F=E.WebPDecodeRGBA(A,z.src_off,z.src_size,b,g);z.rgba=F,z.imgwidth=b[0],z.imgheight=g[0];for(var W=0;W<b[0]*g[0]*4;W++)w[W]=F[W];return this.width=b,this.height=g,this.data=w,this}(function(t){var e,r,a,n,i,o,c,u,h,d=function(N){return N=N||{},this.isStrokeTransparent=N.isStrokeTransparent||!1,this.strokeOpacity=N.strokeOpacity||1,this.strokeStyle=N.strokeStyle||"#000000",this.fillStyle=N.fillStyle||"#000000",this.isFillTransparent=N.isFillTransparent||!1,this.fillOpacity=N.fillOpacity||1,this.font=N.font||"10px sans-serif",this.textBaseline=N.textBaseline||"alphabetic",this.textAlign=N.textAlign||"left",this.lineWidth=N.lineWidth||1,this.lineJoin=N.lineJoin||"miter",this.lineCap=N.lineCap||"butt",this.path=N.path||[],this.transform=N.transform!==void 0?N.transform.clone():new u,this.globalCompositeOperation=N.globalCompositeOperation||"normal",this.globalAlpha=N.globalAlpha||1,this.clip_path=N.clip_path||[],this.currentPoint=N.currentPoint||new o,this.miterLimit=N.miterLimit||10,this.lastPoint=N.lastPoint||new o,this.lineDashOffset=N.lineDashOffset||0,this.lineDash=N.lineDash||[],this.margin=N.margin||[0,0,0,0],this.prevPageLastElemOffset=N.prevPageLastElemOffset||0,this.ignoreClearRect=typeof N.ignoreClearRect!="boolean"||N.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new v(this),e=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,c=this.internal.Rectangle,u=this.internal.Matrix,h=new d}]);var v=function(N){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var M=N;Object.defineProperty(this,"pdf",{get:function(){return M}});var B=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return B},set:function(V){B=!!V}});var q=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return q},set:function(V){q=!!V}});var K=0;Object.defineProperty(this,"posX",{get:function(){return K},set:function(V){isNaN(V)||(K=V)}});var se=0;Object.defineProperty(this,"posY",{get:function(){return se},set:function(V){isNaN(V)||(se=V)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(V){var Ie;typeof V=="number"?Ie=[V,V,V,V]:((Ie=new Array(4))[0]=V[0],Ie[1]=V.length>=2?V[1]:Ie[0],Ie[2]=V.length>=3?V[2]:Ie[0],Ie[3]=V.length>=4?V[3]:Ie[1]),h.margin=Ie}});var me=!1;Object.defineProperty(this,"autoPaging",{get:function(){return me},set:function(V){me=V}});var we=0;Object.defineProperty(this,"lastBreak",{get:function(){return we},set:function(V){we=V}});var Se=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Se},set:function(V){Se=V}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(V){V instanceof d&&(h=V)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(V){h.path=V}});var Ee=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ee},set:function(V){Ee=V}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(V){var Ie;Ie=y(V),this.ctx.fillStyle=Ie.style,this.ctx.isFillTransparent=Ie.a===0,this.ctx.fillOpacity=Ie.a,this.pdf.setFillColor(Ie.r,Ie.g,Ie.b,{a:Ie.a}),this.pdf.setTextColor(Ie.r,Ie.g,Ie.b,{a:Ie.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(V){var Ie=y(V);this.ctx.strokeStyle=Ie.style,this.ctx.isStrokeTransparent=Ie.a===0,this.ctx.strokeOpacity=Ie.a,Ie.a===0?this.pdf.setDrawColor(255,255,255):(Ie.a,this.pdf.setDrawColor(Ie.r,Ie.g,Ie.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(V){["butt","round","square"].indexOf(V)!==-1&&(this.ctx.lineCap=V,this.pdf.setLineCap(V))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(V){isNaN(V)||(this.ctx.lineWidth=V,this.pdf.setLineWidth(V))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(V){["bevel","round","miter"].indexOf(V)!==-1&&(this.ctx.lineJoin=V,this.pdf.setLineJoin(V))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(V){isNaN(V)||(this.ctx.miterLimit=V,this.pdf.setMiterLimit(V))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(V){this.ctx.textBaseline=V}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(V){["right","end","center","left","start"].indexOf(V)!==-1&&(this.ctx.textAlign=V)}});var ae=null,rt=null,Je=null;Object.defineProperty(this,"fontFaces",{get:function(){return Je},set:function(V){ae=null,rt=null,Je=V}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(V){var Ie;if(this.ctx.font=V,(Ie=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(V))!==null){var Le=Ie[1];Ie[2];var gt=Ie[3],et=Ie[4];Ie[5];var wt=Ie[6],vt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(et)[2];et=Math.floor(vt==="px"?parseFloat(et)*this.pdf.internal.scaleFactor:vt==="em"?parseFloat(et)*this.pdf.getFontSize():parseFloat(et)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(et);var Ct=(function(mt){var Ht,Rt,Wt=[],nr=mt.trim();if(nr==="")return Kg;if(nr in Z5)return[Z5[nr]];for(;nr!=="";){switch(Rt=null,Ht=(nr=eb(nr)).charAt(0)){case'"':case"'":Rt=pB(nr.substring(1),Ht);break;default:Rt=mB(nr)}if(Rt===null||(Wt.push(Rt[0]),(nr=eb(Rt[1]))!==""&&nr.charAt(0)!==","))return Kg;nr=nr.replace(/^,/,"")}return Wt})(wt);if(this.fontFaces){var Et=(function(mt,Ht){var Rt=mt.getFontList(),Wt=JSON.stringify(Rt);if(ae===null||rt!==Wt){var nr=(function(br){var Yt=[];return Object.keys(br).forEach(function(Wr){br[Wr].forEach(function(Zt){var ir=null;switch(Zt){case"bold":ir={family:Wr,weight:"bold"};break;case"italic":ir={family:Wr,style:"italic"};break;case"bolditalic":ir={family:Wr,weight:"bold",style:"italic"};break;case"":case"normal":ir={family:Wr}}ir!==null&&(ir.ref={name:Wr,style:Zt},Yt.push(ir))})}),Yt})(Rt);ae=(function(br){for(var Yt={},Wr=0;Wr<br.length;++Wr){var Zt=Yg(br[Wr]),ir=Zt.family,Vr=Zt.stretch,pr=Zt.style,Dt=Zt.weight;Yt[ir]=Yt[ir]||{},Yt[ir][Vr]=Yt[ir][Vr]||{},Yt[ir][Vr][pr]=Yt[ir][Vr][pr]||{},Yt[ir][Vr][pr][Dt]=Zt}return Yt})(nr.concat(Ht)),rt=Wt}return ae})(this.pdf,this.fontFaces),It=Ct.map(function(mt){return{family:mt,stretch:"normal",weight:gt,style:Le}}),er=(function(mt,Ht,Rt){for(var Wt=(Rt=Rt||{}).defaultFontFamily||"times",nr=Object.assign({},dB,Rt.genericFontFamilies||{}),br=null,Yt=null,Wr=0;Wr<Ht.length;++Wr)if(nr[(br=Yg(Ht[Wr])).family]&&(br.family=nr[br.family]),mt.hasOwnProperty(br.family)){Yt=mt[br.family];break}if(!(Yt=Yt||mt[Wt]))throw new Error("Could not find a font-family for the rule '"+Q5(br)+"' and default family '"+Wt+"'.");if(Yt=(function(Zt,ir){if(ir[Zt])return ir[Zt];var Vr=Hv[Zt],pr=Vr<=Hv.normal?-1:1,Dt=J5(ir,kE,Vr,pr);if(!Dt)throw new Error("Could not find a matching font-stretch value for "+Zt);return Dt})(br.stretch,Yt),Yt=(function(Zt,ir){if(ir[Zt])return ir[Zt];for(var Vr=EE[Zt],pr=0;pr<Vr.length;++pr)if(ir[Vr[pr]])return ir[Vr[pr]];throw new Error("Could not find a matching font-style for "+Zt)})(br.style,Yt),!(Yt=(function(Zt,ir){if(ir[Zt])return ir[Zt];if(Zt===400&&ir[500])return ir[500];if(Zt===500&&ir[400])return ir[400];var Vr=hB[Zt],pr=J5(ir,AE,Vr,Zt<400?-1:1);if(!pr)throw new Error("Could not find a matching font-weight for value "+Zt);return pr})(br.weight,Yt)))throw new Error("Failed to resolve a font for the rule '"+Q5(br)+"'.");return Yt})(Et,It);this.pdf.setFont(er.ref.name,er.ref.style)}else{var Vt="";(gt==="bold"||parseInt(gt,10)>=700||Le==="bold")&&(Vt="bold"),Le==="italic"&&(Vt+="italic"),Vt.length===0&&(Vt="normal");for(var Oe="",Ye={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},He=0;He<Ct.length;He++){if(this.pdf.internal.getFont(Ct[He],Vt,{noFallback:!0,disableWarning:!0})!==void 0){Oe=Ct[He];break}if(Vt==="bolditalic"&&this.pdf.internal.getFont(Ct[He],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Oe=Ct[He],Vt="bold";else if(this.pdf.internal.getFont(Ct[He],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Oe=Ct[He],Vt="normal";break}}if(Oe===""){for(var ct=0;ct<Ct.length;ct++)if(Ye[Ct[ct]]){Oe=Ye[Ct[ct]];break}}Oe=Oe===""?"Times":Oe,this.pdf.setFont(Oe,Vt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(V){this.ctx.globalCompositeOperation=V}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(V){this.ctx.globalAlpha=V}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(V){this.ctx.lineDashOffset=V,Q.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(V){this.ctx.lineDash=V,Q.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(V){this.ctx.ignoreClearRect=!!V}})};v.prototype.setLineDash=function(N){this.lineDash=N},v.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},v.prototype.fill=function(){R.call(this,"fill",!1)},v.prototype.stroke=function(){R.call(this,"stroke",!1)},v.prototype.beginPath=function(){this.path=[{type:"begin"}]},v.prototype.moveTo=function(N,M){if(isNaN(N)||isNaN(M))throw Sa.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var B=this.ctx.transform.applyToPoint(new o(N,M));this.path.push({type:"mt",x:B.x,y:B.y}),this.ctx.lastPoint=new o(N,M)},v.prototype.closePath=function(){var N=new o(0,0),M=0;for(M=this.path.length-1;M!==-1;M--)if(this.path[M].type==="begin"&&ua(this.path[M+1])==="object"&&typeof this.path[M+1].x=="number"){N=new o(this.path[M+1].x,this.path[M+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(N.x,N.y)},v.prototype.lineTo=function(N,M){if(isNaN(N)||isNaN(M))throw Sa.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var B=this.ctx.transform.applyToPoint(new o(N,M));this.path.push({type:"lt",x:B.x,y:B.y}),this.ctx.lastPoint=new o(B.x,B.y)},v.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),R.call(this,null,!0)},v.prototype.quadraticCurveTo=function(N,M,B,q){if(isNaN(B)||isNaN(q)||isNaN(N)||isNaN(M))throw Sa.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var K=this.ctx.transform.applyToPoint(new o(B,q)),se=this.ctx.transform.applyToPoint(new o(N,M));this.path.push({type:"qct",x1:se.x,y1:se.y,x:K.x,y:K.y}),this.ctx.lastPoint=new o(K.x,K.y)},v.prototype.bezierCurveTo=function(N,M,B,q,K,se){if(isNaN(K)||isNaN(se)||isNaN(N)||isNaN(M)||isNaN(B)||isNaN(q))throw Sa.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var me=this.ctx.transform.applyToPoint(new o(K,se)),we=this.ctx.transform.applyToPoint(new o(N,M)),Se=this.ctx.transform.applyToPoint(new o(B,q));this.path.push({type:"bct",x1:we.x,y1:we.y,x2:Se.x,y2:Se.y,x:me.x,y:me.y}),this.ctx.lastPoint=new o(me.x,me.y)},v.prototype.arc=function(N,M,B,q,K,se){if(isNaN(N)||isNaN(M)||isNaN(B)||isNaN(q)||isNaN(K))throw Sa.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(se=!!se,!this.ctx.transform.isIdentity){var me=this.ctx.transform.applyToPoint(new o(N,M));N=me.x,M=me.y;var we=this.ctx.transform.applyToPoint(new o(0,B)),Se=this.ctx.transform.applyToPoint(new o(0,0));B=Math.sqrt(Math.pow(we.x-Se.x,2)+Math.pow(we.y-Se.y,2))}Math.abs(K-q)>=2*Math.PI&&(q=0,K=2*Math.PI),this.path.push({type:"arc",x:N,y:M,radius:B,startAngle:q,endAngle:K,counterclockwise:se})},v.prototype.arcTo=function(N,M,B,q,K){throw new Error("arcTo not implemented.")},v.prototype.rect=function(N,M,B,q){if(isNaN(N)||isNaN(M)||isNaN(B)||isNaN(q))throw Sa.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(N,M),this.lineTo(N+B,M),this.lineTo(N+B,M+q),this.lineTo(N,M+q),this.lineTo(N,M),this.lineTo(N+B,M),this.lineTo(N,M)},v.prototype.fillRect=function(N,M,B,q){if(isNaN(N)||isNaN(M)||isNaN(B)||isNaN(q))throw Sa.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var K={};this.lineCap!=="butt"&&(K.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(K.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(N,M,B,q),this.fill(),K.hasOwnProperty("lineCap")&&(this.lineCap=K.lineCap),K.hasOwnProperty("lineJoin")&&(this.lineJoin=K.lineJoin)}},v.prototype.strokeRect=function(N,M,B,q){if(isNaN(N)||isNaN(M)||isNaN(B)||isNaN(q))throw Sa.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(N,M,B,q),this.stroke())},v.prototype.clearRect=function(N,M,B,q){if(isNaN(N)||isNaN(M)||isNaN(B)||isNaN(q))throw Sa.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(N,M,B,q))},v.prototype.save=function(N){N=typeof N!="boolean"||N;for(var M=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("q");if(this.pdf.setPage(M),N){this.ctx.fontSize=this.pdf.internal.getFontSize();var q=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=q}},v.prototype.restore=function(N){N=typeof N!="boolean"||N;for(var M=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("Q");this.pdf.setPage(M),N&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},v.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var y=function(N){var M,B,q,K;if(N.isCanvasGradient===!0&&(N=N.getColor()),!N)return{r:0,g:0,b:0,a:0,style:N};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(N))M=0,B=0,q=0,K=0;else{var se=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(N);if(se!==null)M=parseInt(se[1]),B=parseInt(se[2]),q=parseInt(se[3]),K=1;else if((se=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(N))!==null)M=parseInt(se[1]),B=parseInt(se[2]),q=parseInt(se[3]),K=parseFloat(se[4]);else{if(K=1,typeof N=="string"&&N.charAt(0)!=="#"){var me=new vE(N);N=me.ok?me.toHex():"#000000"}N.length===4?(M=N.substring(1,2),M+=M,B=N.substring(2,3),B+=B,q=N.substring(3,4),q+=q):(M=N.substring(1,3),B=N.substring(3,5),q=N.substring(5,7)),M=parseInt(M,16),B=parseInt(B,16),q=parseInt(q,16)}}return{r:M,g:B,b:q,a:K,style:N}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};v.prototype.fillText=function(N,M,B,q){if(isNaN(M)||isNaN(B)||typeof N!="string")throw Sa.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(q=isNaN(q)?void 0:q,!g.call(this)){var K=de(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;L.call(this,{text:N,x:M,y:B,scale:se,angle:K,align:this.textAlign,maxWidth:q})}},v.prototype.strokeText=function(N,M,B,q){if(isNaN(M)||isNaN(B)||typeof N!="string")throw Sa.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){q=isNaN(q)?void 0:q;var K=de(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;L.call(this,{text:N,x:M,y:B,scale:se,renderingMode:"stroke",angle:K,align:this.textAlign,maxWidth:q})}},v.prototype.measureText=function(N){if(typeof N!="string")throw Sa.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var M=this.pdf,B=this.pdf.internal.scaleFactor,q=M.internal.getFontSize(),K=M.getStringUnitWidth(N)*q/M.internal.scaleFactor;return new function(se){var me=(se=se||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return me}}),this}({width:K*=Math.round(96*B/72*1e4)/1e4})},v.prototype.scale=function(N,M){if(isNaN(N)||isNaN(M))throw Sa.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var B=new u(N,0,0,M,0,0);this.ctx.transform=this.ctx.transform.multiply(B)},v.prototype.rotate=function(N){if(isNaN(N))throw Sa.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var M=new u(Math.cos(N),Math.sin(N),-Math.sin(N),Math.cos(N),0,0);this.ctx.transform=this.ctx.transform.multiply(M)},v.prototype.translate=function(N,M){if(isNaN(N)||isNaN(M))throw Sa.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var B=new u(1,0,0,1,N,M);this.ctx.transform=this.ctx.transform.multiply(B)},v.prototype.transform=function(N,M,B,q,K,se){if(isNaN(N)||isNaN(M)||isNaN(B)||isNaN(q)||isNaN(K)||isNaN(se))throw Sa.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var me=new u(N,M,B,q,K,se);this.ctx.transform=this.ctx.transform.multiply(me)},v.prototype.setTransform=function(N,M,B,q,K,se){N=isNaN(N)?1:N,M=isNaN(M)?0:M,B=isNaN(B)?0:B,q=isNaN(q)?1:q,K=isNaN(K)?0:K,se=isNaN(se)?0:se,this.ctx.transform=new u(N,M,B,q,K,se)};var w=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};v.prototype.drawImage=function(N,M,B,q,K,se,me,we,Se){var Ee=this.pdf.getImageProperties(N),ae=1,rt=1,Je=1,V=1;q!==void 0&&we!==void 0&&(Je=we/q,V=Se/K,ae=Ee.width/q*we/q,rt=Ee.height/K*Se/K),se===void 0&&(se=M,me=B,M=0,B=0),q!==void 0&&we===void 0&&(we=q,Se=K),q===void 0&&we===void 0&&(we=Ee.width,Se=Ee.height);var Ie=this.ctx.transform.decompose(),Le=de(Ie.rotate.shx),gt=new u,et=(gt=(gt=(gt=gt.multiply(Ie.translate)).multiply(Ie.skew)).multiply(Ie.scale)).applyToRectangle(new c(se-M*Je,me-B*V,q*ae,K*rt));if(this.autoPaging){for(var wt,vt=E.call(this,et),Ct=[],Et=0;Et<vt.length;Et+=1)Ct.indexOf(vt[Et])===-1&&Ct.push(vt[Et]);T(Ct);for(var It=Ct[0],er=Ct[Ct.length-1],Vt=It;Vt<er+1;Vt++){this.pdf.setPage(Vt);var Oe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ye=Vt===1?this.posY+this.margin[0]:this.margin[0],He=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],mt=Vt===1?0:He+(Vt-2)*ct;if(this.ctx.clip_path.length!==0){var Ht=this.path;wt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=O(wt,this.posX+this.margin[3],-mt+Ye+this.ctx.prevPageLastElemOffset),H.call(this,"fill",!0),this.path=Ht}var Rt=JSON.parse(JSON.stringify(et));Rt=O([Rt],this.posX+this.margin[3],-mt+Ye+this.ctx.prevPageLastElemOffset)[0];var Wt=(Vt>It||Vt<er)&&w.call(this);Wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Oe,ct,null).clip().discardPath()),this.pdf.addImage(N,"JPEG",Rt.x,Rt.y,Rt.w,Rt.h,null,null,Le),Wt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(N,"JPEG",et.x,et.y,et.w,et.h,null,null,Le)};var E=function(N,M,B){var q=[];M=M||this.pdf.internal.pageSize.width,B=B||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var K=this.posY+this.ctx.prevPageLastElemOffset;switch(N.type){default:case"mt":case"lt":q.push(Math.floor((N.y+K)/B)+1);break;case"arc":q.push(Math.floor((N.y+K-N.radius)/B)+1),q.push(Math.floor((N.y+K+N.radius)/B)+1);break;case"qct":var se=Z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,N.x1,N.y1,N.x,N.y);q.push(Math.floor((se.y+K)/B)+1),q.push(Math.floor((se.y+se.h+K)/B)+1);break;case"bct":var me=Ne(this.ctx.lastPoint.x,this.ctx.lastPoint.y,N.x1,N.y1,N.x2,N.y2,N.x,N.y);q.push(Math.floor((me.y+K)/B)+1),q.push(Math.floor((me.y+me.h+K)/B)+1);break;case"rect":q.push(Math.floor((N.y+K)/B)+1),q.push(Math.floor((N.y+N.h+K)/B)+1)}for(var we=0;we<q.length;we+=1)for(;this.pdf.internal.getNumberOfPages()<q[we];)A.call(this);return q},A=function(){var N=this.fillStyle,M=this.strokeStyle,B=this.font,q=this.lineCap,K=this.lineWidth,se=this.lineJoin;this.pdf.addPage(),this.fillStyle=N,this.strokeStyle=M,this.font=B,this.lineCap=q,this.lineWidth=K,this.lineJoin=se},O=function(N,M,B){for(var q=0;q<N.length;q++)switch(N[q].type){case"bct":N[q].x2+=M,N[q].y2+=B;case"qct":N[q].x1+=M,N[q].y1+=B;default:N[q].x+=M,N[q].y+=B}return N},T=function(N){return N.sort(function(M,B){return M-B})},R=function(N,M){var B=this.fillStyle,q=this.strokeStyle,K=this.lineCap,se=this.lineWidth,me=Math.abs(se*this.ctx.transform.scaleX),we=this.lineJoin;if(this.autoPaging){for(var Se,Ee,ae=JSON.parse(JSON.stringify(this.path)),rt=JSON.parse(JSON.stringify(this.path)),Je=[],V=0;V<rt.length;V++)if(rt[V].x!==void 0)for(var Ie=E.call(this,rt[V]),Le=0;Le<Ie.length;Le+=1)Je.indexOf(Ie[Le])===-1&&Je.push(Ie[Le]);for(var gt=0;gt<Je.length;gt++)for(;this.pdf.internal.getNumberOfPages()<Je[gt];)A.call(this);T(Je);for(var et=Je[0],wt=Je[Je.length-1],vt=et;vt<wt+1;vt++){this.pdf.setPage(vt),this.fillStyle=B,this.strokeStyle=q,this.lineCap=K,this.lineWidth=me,this.lineJoin=we;var Ct=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Et=vt===1?this.posY+this.margin[0]:this.margin[0],It=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],er=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Vt=vt===1?0:It+(vt-2)*er;if(this.ctx.clip_path.length!==0){var Oe=this.path;Se=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=O(Se,this.posX+this.margin[3],-Vt+Et+this.ctx.prevPageLastElemOffset),H.call(this,N,!0),this.path=Oe}if(Ee=JSON.parse(JSON.stringify(ae)),this.path=O(Ee,this.posX+this.margin[3],-Vt+Et+this.ctx.prevPageLastElemOffset),M===!1||vt===0){var Ye=(vt>et||vt<wt)&&w.call(this);Ye&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ct,er,null).clip().discardPath()),H.call(this,N,M),Ye&&this.pdf.restoreGraphicsState()}this.lineWidth=se}this.path=ae}else this.lineWidth=me,H.call(this,N,M),this.lineWidth=se},H=function(N,M){if((N!=="stroke"||M||!b.call(this))&&(N==="stroke"||M||!g.call(this))){for(var B,q,K=[],se=this.path,me=0;me<se.length;me++){var we=se[me];switch(we.type){case"begin":K.push({begin:!0});break;case"close":K.push({close:!0});break;case"mt":K.push({start:we,deltas:[],abs:[]});break;case"lt":var Se=K.length;if(se[me-1]&&!isNaN(se[me-1].x)&&(B=[we.x-se[me-1].x,we.y-se[me-1].y],Se>0)){for(;Se>=0;Se--)if(K[Se-1].close!==!0&&K[Se-1].begin!==!0){K[Se-1].deltas.push(B),K[Se-1].abs.push(we);break}}break;case"bct":B=[we.x1-se[me-1].x,we.y1-se[me-1].y,we.x2-se[me-1].x,we.y2-se[me-1].y,we.x-se[me-1].x,we.y-se[me-1].y],K[K.length-1].deltas.push(B);break;case"qct":var Ee=se[me-1].x+2/3*(we.x1-se[me-1].x),ae=se[me-1].y+2/3*(we.y1-se[me-1].y),rt=we.x+2/3*(we.x1-we.x),Je=we.y+2/3*(we.y1-we.y),V=we.x,Ie=we.y;B=[Ee-se[me-1].x,ae-se[me-1].y,rt-se[me-1].x,Je-se[me-1].y,V-se[me-1].x,Ie-se[me-1].y],K[K.length-1].deltas.push(B);break;case"arc":K.push({deltas:[],abs:[],arc:!0}),Array.isArray(K[K.length-1].abs)&&K[K.length-1].abs.push(we)}}q=M?null:N==="stroke"?"stroke":"fill";for(var Le=!1,gt=0;gt<K.length;gt++)if(K[gt].arc)for(var et=K[gt].abs,wt=0;wt<et.length;wt++){var vt=et[wt];vt.type==="arc"?W.call(this,vt.x,vt.y,vt.radius,vt.startAngle,vt.endAngle,vt.counterclockwise,void 0,M,!Le):ee.call(this,vt.x,vt.y),Le=!0}else if(K[gt].close===!0)this.pdf.internal.out("h"),Le=!1;else if(K[gt].begin!==!0){var Ct=K[gt].start.x,Et=K[gt].start.y;oe.call(this,K[gt].deltas,Ct,Et),Le=!0}q&&D.call(this,q),M&&Y.call(this)}},z=function(N){var M=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,B=M*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return N-B;case"top":return N+M-B;case"hanging":return N+M-2*B;case"middle":return N+M/2-B;default:return N}},F=function(N){return N+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};v.prototype.createLinearGradient=function(){var N=function(){};return N.colorStops=[],N.addColorStop=function(M,B){this.colorStops.push([M,B])},N.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},N.isCanvasGradient=!0,N},v.prototype.createPattern=function(){return this.createLinearGradient()},v.prototype.createRadialGradient=function(){return this.createLinearGradient()};var W=function(N,M,B,q,K,se,me,we,Se){for(var Ee=ie.call(this,B,q,K,se),ae=0;ae<Ee.length;ae++){var rt=Ee[ae];ae===0&&(Se?I.call(this,rt.x1+N,rt.y1+M):ee.call(this,rt.x1+N,rt.y1+M)),ge.call(this,N,M,rt.x2,rt.y2,rt.x3,rt.y3,rt.x4,rt.y4)}we?Y.call(this):D.call(this,me)},D=function(N){switch(N){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Y=function(){this.pdf.clip(),this.pdf.discardPath()},I=function(N,M){this.pdf.internal.out(r(N)+" "+a(M)+" m")},L=function(N){var M;switch(N.align){case"right":case"end":M="right";break;case"center":M="center";break;default:M="left"}var B,q,K,se=this.pdf.getTextDimensions(N.text),me=z.call(this,N.y),we=F.call(this,me)-se.h,Se=this.ctx.transform.applyToPoint(new o(N.x,me));if(this.autoPaging){var Ee=this.ctx.transform.decompose(),ae=new u;ae=(ae=(ae=ae.multiply(Ee.translate)).multiply(Ee.skew)).multiply(Ee.scale);for(var rt=this.ctx.transform.applyToRectangle(new c(N.x,me,se.w,se.h)),Je=ae.applyToRectangle(new c(N.x,we,se.w,se.h)),V=E.call(this,Je),Ie=[],Le=0;Le<V.length;Le+=1)Ie.indexOf(V[Le])===-1&&Ie.push(V[Le]);T(Ie);for(var gt=Ie[0],et=Ie[Ie.length-1],wt=gt;wt<et+1;wt++){this.pdf.setPage(wt);var vt=wt===1?this.posY+this.margin[0]:this.margin[0],Ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Et=this.pdf.internal.pageSize.height-this.margin[2],It=Et-this.margin[0],er=this.pdf.internal.pageSize.width-this.margin[1],Vt=er-this.margin[3],Oe=wt===1?0:Ct+(wt-2)*It;if(this.ctx.clip_path.length!==0){var Ye=this.path;B=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=O(B,this.posX+this.margin[3],-1*Oe+vt),H.call(this,"fill",!0),this.path=Ye}var He=O([JSON.parse(JSON.stringify(Je))],this.posX+this.margin[3],-Oe+vt+this.ctx.prevPageLastElemOffset)[0];N.scale>=.01&&(q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(q*N.scale),K=this.lineWidth,this.lineWidth=K*N.scale);var ct=this.autoPaging!=="text";if(ct||He.y+He.h<=Et){if(ct||He.y>=vt&&He.x<=er){var mt=ct?N.text:this.pdf.splitTextToSize(N.text,N.maxWidth||er-He.x)[0],Ht=O([JSON.parse(JSON.stringify(rt))],this.posX+this.margin[3],-Oe+vt+this.ctx.prevPageLastElemOffset)[0],Rt=ct&&(wt>gt||wt<et)&&w.call(this);Rt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Vt,It,null).clip().discardPath()),this.pdf.text(mt,Ht.x,Ht.y,{angle:N.angle,align:M,renderingMode:N.renderingMode}),Rt&&this.pdf.restoreGraphicsState()}}else He.y<Et&&(this.ctx.prevPageLastElemOffset+=Et-He.y);N.scale>=.01&&(this.pdf.setFontSize(q),this.lineWidth=K)}}else N.scale>=.01&&(q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(q*N.scale),K=this.lineWidth,this.lineWidth=K*N.scale),this.pdf.text(N.text,Se.x+this.posX,Se.y+this.posY,{angle:N.angle,align:M,renderingMode:N.renderingMode,maxWidth:N.maxWidth}),N.scale>=.01&&(this.pdf.setFontSize(q),this.lineWidth=K)},ee=function(N,M,B,q){B=B||0,q=q||0,this.pdf.internal.out(r(N+B)+" "+a(M+q)+" l")},oe=function(N,M,B){return this.pdf.lines(N,M,B,null,null)},ge=function(N,M,B,q,K,se,me,we){this.pdf.internal.out([e(n(B+N)),e(i(q+M)),e(n(K+N)),e(i(se+M)),e(n(me+N)),e(i(we+M)),"c"].join(" "))},ie=function(N,M,B,q){for(var K=2*Math.PI,se=Math.PI/2;M>B;)M-=K;var me=Math.abs(B-M);me<K&&q&&(me=K-me);for(var we=[],Se=q?-1:1,Ee=M;me>1e-5;){var ae=Ee+Se*Math.min(me,se);we.push(he.call(this,N,Ee,ae)),me-=Math.abs(ae-Ee),Ee=ae}return we},he=function(N,M,B){var q=(B-M)/2,K=N*Math.cos(q),se=N*Math.sin(q),me=K,we=-se,Se=me*me+we*we,Ee=Se+me*K+we*se,ae=4/3*(Math.sqrt(2*Se*Ee)-Ee)/(me*se-we*K),rt=me-ae*we,Je=we+ae*me,V=rt,Ie=-Je,Le=q+M,gt=Math.cos(Le),et=Math.sin(Le);return{x1:N*Math.cos(M),y1:N*Math.sin(M),x2:rt*gt-Je*et,y2:rt*et+Je*gt,x3:V*gt-Ie*et,y3:V*et+Ie*gt,x4:N*Math.cos(B),y4:N*Math.sin(B)}},de=function(N){return 180*N/Math.PI},Z=function(N,M,B,q,K,se){var me=N+.5*(B-N),we=M+.5*(q-M),Se=K+.5*(B-K),Ee=se+.5*(q-se),ae=Math.min(N,K,me,Se),rt=Math.max(N,K,me,Se),Je=Math.min(M,se,we,Ee),V=Math.max(M,se,we,Ee);return new c(ae,Je,rt-ae,V-Je)},Ne=function(N,M,B,q,K,se,me,we){var Se,Ee,ae,rt,Je,V,Ie,Le,gt,et,wt,vt,Ct,Et,It=B-N,er=q-M,Vt=K-B,Oe=se-q,Ye=me-K,He=we-se;for(Ee=0;Ee<41;Ee++)gt=(Ie=(ae=N+(Se=Ee/40)*It)+Se*((Je=B+Se*Vt)-ae))+Se*(Je+Se*(K+Se*Ye-Je)-Ie),et=(Le=(rt=M+Se*er)+Se*((V=q+Se*Oe)-rt))+Se*(V+Se*(se+Se*He-V)-Le),Ee==0?(wt=gt,vt=et,Ct=gt,Et=et):(wt=Math.min(wt,gt),vt=Math.min(vt,et),Ct=Math.max(Ct,gt),Et=Math.max(Et,et));return new c(Math.round(wt),Math.round(vt),Math.round(Ct-wt),Math.round(Et-vt))},Q=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var N,M,B=(N=this.ctx.lineDash,M=this.ctx.lineDashOffset,JSON.stringify({lineDash:N,lineDashOffset:M}));this.prevLineDash!==B&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=B)}}})(Jt.API),(function(t){var e=function(o){var c,u,h,d,v,y,g,b,w,E;for(u=[],h=0,d=(o+=c="\0\0\0\0".slice(o.length%4||4)).length;d>h;h+=4)(v=(o.charCodeAt(h)<<24)+(o.charCodeAt(h+1)<<16)+(o.charCodeAt(h+2)<<8)+o.charCodeAt(h+3))!==0?(y=(v=((v=((v=((v=(v-(E=v%85))/85)-(w=v%85))/85)-(b=v%85))/85)-(g=v%85))/85)%85,u.push(y+33,g+33,b+33,w+33,E+33)):u.push(122);return(function(A,O){for(var T=O;T>0;T--)A.pop()})(u,c.length),String.fromCharCode.apply(String,u)+"~>"},r=function(o){var c,u,h,d,v,y=String,g="length",b=255,w="charCodeAt",E="slice",A="replace";for(o[E](-2),o=o[E](0,-2)[A](/\s/g,"")[A]("z","!!!!!"),h=[],d=0,v=(o+=c="uuuuu"[E](o[g]%5||5))[g];v>d;d+=5)u=52200625*(o[w](d)-33)+614125*(o[w](d+1)-33)+7225*(o[w](d+2)-33)+85*(o[w](d+3)-33)+(o[w](d+4)-33),h.push(b&u>>24,b&u>>16,b&u>>8,b&u);return(function(O,T){for(var R=T;R>0;R--)O.pop()})(h,c[g]),y.fromCharCode.apply(y,h)},a=function(o){return o.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">"},n=function(o){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),c.test(o)===!1)return"";for(var u="",h=0;h<o.length;h+=2)u+=String.fromCharCode("0x"+(o[h]+o[h+1]));return u},i=function(o){for(var c=new Uint8Array(o.length),u=o.length;u--;)c[u]=o.charCodeAt(u);return(c=Pv(c)).reduce(function(h,d){return h+String.fromCharCode(d)},"")};t.processDataByFilters=function(o,c){var u=0,h=o||"",d=[];for(typeof(c=c||[])=="string"&&(c=[c]),u=0;u<c.length;u+=1)switch(c[u]){case"ASCII85Decode":case"/ASCII85Decode":h=r(h),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":h=e(h),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":h=n(h),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":h=a(h),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":h=i(h),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[u]+'" is not implemented')}return{data:h,reverseChain:d.reverse().join(" ")}}})(Jt.API),(function(t){t.loadFile=function(e,r,a){return(function(n,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var c=void 0;try{c=(function(u,h,d){var v=new XMLHttpRequest,y=0,g=function(b){var w=b.length,E=[],A=String.fromCharCode;for(y=0;y<w;y+=1)E.push(A(255&b.charCodeAt(y)));return E.join("")};if(v.open("GET",u,!h),v.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(v.onload=function(){v.status===200?d(g(this.responseText)):d(void 0)}),v.send(null),h&&v.status===200)return g(v.responseText)})(n,i,o)}catch{}return c})(e,r,a)},t.loadImageFile=t.loadFile})(Jt.API),(function(t){function e(){return(gr.html2canvas?Promise.resolve(gr.html2canvas):Og(()=>import("./html2canvas.esm-Ge7aVWlp.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function r(){return(gr.DOMPurify?Promise.resolve(gr.DOMPurify):Og(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var a=function(c){var u=ua(c);return u==="undefined"?"undefined":u==="string"||c instanceof String?"string":u==="number"||c instanceof Number?"number":u==="function"||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&c.nodeType===1?"element":u==="object"?"object":"unknown"},n=function(c,u){var h=document.createElement(c);for(var d in u.className&&(h.className=u.className),u.innerHTML&&u.dompurify&&(h.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)h.style[d]=u.style[d];return h},i=function c(u,h){for(var d=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),v=u.firstChild;v;v=v.nextSibling)h!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||d.appendChild(c(v,h));return u.nodeType===1&&(u.nodeName==="CANVAS"?(d.width=u.width,d.height=u.height,d.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(d.value=u.value),d.addEventListener("load",function(){d.scrollTop=u.scrollTop,d.scrollLeft=u.scrollLeft},!0)),d},o=function c(u){var h=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),d=c.convert(Promise.resolve(),h);return(d=d.setProgress(1,c,1,[c])).set(u)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(c,u){return c.__proto__=u||o.prototype,c},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(c,u){return this.then(function(){switch(u=u||(function(h){switch(a(h)){case"string":return"string";case"element":return h.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(c),u){case"string":return this.then(r).then(function(h){return this.set({src:n("div",{innerHTML:c,dompurify:h})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},o.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(u){var h=Object.assign({},this.opt.html2canvas);return delete h.onrendered,u(this.prop.container,h)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(u){var h=this.opt.jsPDF,d=this.opt.fontFaces,v=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,y=Object.assign({async:!0,allowTaint:!0,scale:v,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete y.onrendered,h.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,h.context2d.posX=this.opt.x,h.context2d.posY=this.opt.y,h.context2d.margin=this.opt.margin,h.context2d.fontFaces=d,d)for(var g=0;g<d.length;++g){var b=d[g],w=b.src.find(function(E){return E.format==="truetype"});w&&h.addFont(w.url,b.ref.name,b.ref.style)}return y.windowHeight=y.windowHeight||0,y.windowHeight=y.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):y.windowHeight,h.context2d.save(!0),u(this.prop.container,y)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(c,u,h){return(h=h||"pdf").toLowerCase()==="img"||h.toLowerCase()==="image"?this.outputImg(c,u):this.outputPdf(c,u)},o.prototype.outputPdf=function(c,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,u)})},o.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},o.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(c){if(a(c)!=="object")return this;var u=Object.keys(c||{}).map(function(h){if(h in o.template.prop)return function(){this.prop[h]=c[h]};switch(h){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[h]=c[h]}}},this);return this.then(function(){return this.thenList(u)})},o.prototype.get=function(c,u){return this.then(function(){var h=c in o.template.prop?this.prop[c]:this.opt[c];return u?u(h):h})},o.prototype.setMargin=function(c){return this.then(function(){switch(a(c)){case"number":c=[c,c,c,c];case"array":if(c.length===2&&(c=[c[0],c[1],c[0],c[1]]),c.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},o.prototype.setPageSize=function(c){function u(h,d){return Math.floor(h*d/72*96)}return this.then(function(){(c=c||Jt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:u(c.inner.width,c.k),height:u(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},o.prototype.setProgress=function(c,u,h,d){return c!=null&&(this.progress.val=c),u!=null&&(this.progress.state=u),h!=null&&(this.progress.n=h),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(c,u,h,d){return this.setProgress(c?this.progress.val+c:null,u||null,h?this.progress.n+h:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(c,u){var h=this;return this.thenCore(c,u,function(d,v){return h.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(y){return h.updateProgress(null,d),y}).then(d,v).then(function(y){return h.updateProgress(1),y})})},o.prototype.thenCore=function(c,u,h){h=h||Promise.prototype.then;var d=this;c&&(c=c.bind(d)),u&&(u=u.bind(d));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),y=h.call(v,c,u);return o.convert(y,d.__proto__)},o.prototype.thenExternal=function(c,u){return Promise.prototype.then.call(this,c,u)},o.prototype.thenList=function(c){var u=this;return c.forEach(function(h){u=u.thenCore(h)}),u},o.prototype.catch=function(c){c&&(c=c.bind(this));var u=Promise.prototype.catch.call(this,c);return o.convert(u,this)},o.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},o.prototype.error=function(c){return this.then(function(){throw new Error(c)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Jt.getPageSize=function(c,u,h){if(ua(c)==="object"){var d=c;c=d.orientation,u=d.unit||u,h=d.format||h}u=u||"mm",h=h||"a4",c=(""+(c||"P")).toLowerCase();var v,y=(""+h).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":v=1;break;case"mm":v=72/25.4;break;case"cm":v=72/2.54;break;case"in":v=72;break;case"px":v=.75;break;case"pc":case"em":v=12;break;case"ex":v=6;break;default:throw"Invalid unit: "+u}var b,w=0,E=0;if(g.hasOwnProperty(y))w=g[y][1]/v,E=g[y][0]/v;else try{w=h[1],E=h[0]}catch{throw new Error("Invalid format: "+h)}if(c==="p"||c==="portrait")c="p",E>w&&(b=E,E=w,w=b);else{if(c!=="l"&&c!=="landscape")throw"Invalid orientation: "+c;c="l",w>E&&(b=E,E=w,w=b)}return{width:E,height:w,unit:u,k:v,orientation:c}},t.html=function(c,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(Yg):null;var h=new o(u);return u.worker?h:h.from(c).doCallback()}})(Jt.API),Jt.API.addJS=function(t){return rb=t,this.internal.events.subscribe("postPutResources",function(){X1=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(X1+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),tb=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+rb+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){X1!==void 0&&tb!==void 0&&this.internal.out("/Names <</JavaScript "+X1+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),i=0;i<n.length;i++){var o=n[i],c=a.exec(o);if(c!=null){var u=c[1];r.internal.newObjectDeferredBegin(u,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,d=[];for(i=0;i<h;i++){var v=r.internal.newObject();d.push(v);var y=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+y.objId+" 0 R /XYZ null null null]>> endobj")}var g=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<d.length;i++)r.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+g+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,i){var o={title:n,options:i,children:[]};return a==null&&(a=this.root),a.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<a.children.length;i++){var o=a.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(a)),i>0&&this.line("/Prev "+this.makeRef(a.children[i-1])),i<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var c=this.count=this.count_r({count:0},o);if(c>0&&this.line("/Count "+c),o.options&&o.options.pageNumber){var u=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var h=0;h<a.children.length;h++)this.renderItems(a.children[h])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var i=0;i<n.children.length;i++)a.count++,this.count_r(a,n.children[i]);return a.count}}])})(Jt.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,a,n,i,o,c){var u,h=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,u=(function(v){for(var y,g=256*v.charCodeAt(4)+v.charCodeAt(5),b=v.length,w={width:0,height:0,numcomponents:1},E=4;E<b;E+=2){if(E+=g,e.indexOf(v.charCodeAt(E+1))!==-1){y=256*v.charCodeAt(E+5)+v.charCodeAt(E+6),w={width:256*v.charCodeAt(E+7)+v.charCodeAt(E+8),height:y,numcomponents:v.charCodeAt(E+9)};break}g=256*v.charCodeAt(E+2)+v.charCodeAt(E+3)}return w})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),u.numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}d={data:r,width:u.width,height:u.height,colorSpace:c,bitsPerComponent:8,filter:h,index:a,alias:n}}return d}})(Jt.API),Jt.API.processPNG=function(t,e,r,a){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var n,i=ZI(t,{checkCrc:!0}),o=i.width,c=i.height,u=i.channels,h=i.palette,d=i.depth;n=h&&u===1?(function(W){for(var D=W.width,Y=W.height,I=W.data,L=W.palette,ee=W.depth,oe=!1,ge=[],ie=[],he=void 0,de=!1,Z=0,Ne=0;Ne<L.length;Ne++){var Q=s5(L[Ne],4),N=Q[0],M=Q[1],B=Q[2],q=Q[3];ge.push(N,M,B),q!=null&&(q===0?(Z++,ie.length<1&&ie.push(Ne)):q<255&&(de=!0))}if(de||Z>1){oe=!0,ie=void 0;var K=D*Y;he=new Uint8Array(K);for(var se=new DataView(I.buffer),me=0;me<K;me++){var we=Jg(se,me,ee),Se=s5(L[we],4)[3];he[me]=Se}}else Z===0&&(ie=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:oe?8:void 0,colorBytes:I,alphaBytes:he,needSMask:oe,palette:ge,mask:ie}})(i):u===2||u===4?(function(W){for(var D=W.data,Y=W.width,I=W.height,L=W.channels,ee=W.depth,oe=L===2?"DeviceGray":"DeviceRGB",ge=L-1,ie=Y*I,he=ge,de=ie*he,Z=1*ie,Ne=Math.ceil(de*ee/8),Q=Math.ceil(Z*ee/8),N=new Uint8Array(Ne),M=new Uint8Array(Q),B=new DataView(D.buffer),q=new DataView(N.buffer),K=new DataView(M.buffer),se=!1,me=0;me<ie;me++){for(var we=me*L,Se=0;Se<he;Se++)fb(q,Jg(B,we+Se,ee),me*he+Se,ee);var Ee=Jg(B,we+he,ee);Ee<(1<<ee)-1&&(se=!0),fb(K,Ee,1*me,ee)}return{colorSpace:oe,colorsPerPixel:ge,sMaskBitsPerComponent:se?ee:void 0,colorBytes:N,alphaBytes:M,needSMask:se}})(i):(function(W){var D=W.data,Y=W.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:Y,colorsPerPixel:Y==="DeviceGray"?1:3,colorBytes:D instanceof Uint16Array?(function(I){for(var L=I.length,ee=new Uint8Array(2*L),oe=new DataView(ee.buffer,ee.byteOffset,ee.byteLength),ge=0;ge<L;ge++)oe.setUint16(2*ge,I[ge],!1);return ee})(D):D,needSMask:!1}})(i);var v,y,g,b=n,w=b.colorSpace,E=b.colorsPerPixel,A=b.sMaskBitsPerComponent,O=b.colorBytes,T=b.alphaBytes,R=b.needSMask,H=b.palette,z=b.mask,F=null;return a!==Jt.API.image_compression.NONE&&typeof Pv=="function"?(F=(function(W){var D;switch(W){case Jt.API.image_compression.FAST:D=11;break;case Jt.API.image_compression.MEDIUM:D=13;break;case Jt.API.image_compression.SLOW:D=14;break;default:D=12}return D})(a),v=this.decode.FLATE_DECODE,y="/Predictor ".concat(F," /Colors ").concat(E," /BitsPerComponent ").concat(d," /Columns ").concat(o),t=sb(O,Math.ceil(o*E*d/8),E,d,a),R&&(g=sb(T,Math.ceil(o*A/8),1,A,a))):(v=void 0,y=void 0,t=O,R&&(g=T)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(g&&this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),{alias:r,data:t,index:e,filter:v,decodeParameters:y,transparency:z,palette:H,sMask:g,predictor:F,width:o,height:c,bitsPerComponent:d,sMaskBitsPerComponent:A,colorSpace:w}}},(function(t){t.processGIF89A=function(e,r,a,n){var i=new yB(e),o=i.width,c=i.height,u=[];i.decodeAndBlitFrameRGBA(0,u);var h={data:u,width:o,height:c},d=new Zg(100).encode(h,100);return t.processJPEG.call(this,d,r,a,n)},t.processGIF87A=t.processGIF89A})(Jt.API),Po.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:n,green:a,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Po.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Sa.log("bit decode error:"+r)}},Po.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var a=this.bottom_up?t:this.height-1-t,n=0;n<e;n++)for(var i=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+8*n*4,c=0;c<8&&8*n+c<this.width;c++){var u=this.palette[i>>7-c&1];this.data[o+4*c]=u.blue,this.data[o+4*c+1]=u.green,this.data[o+4*c+2]=u.red,this.data[o+4*c+3]=255}r!==0&&(this.pos+=4-r)}},Po.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<t;n++){var i=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+2*n*4,c=i>>4,u=15&i,h=this.palette[c];if(this.data[o]=h.blue,this.data[o+1]=h.green,this.data[o+2]=h.red,this.data[o+3]=255,2*n+1>=this.width)break;h=this.palette[u],this.data[o+4]=h.blue,this.data[o+4+1]=h.green,this.data[o+4+2]=h.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Po.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*a;if(n<this.palette.length){var o=this.palette[n];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}t!==0&&(this.pos+=4-t)}},Po.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&e)/e*255|0,c=(i>>5&e)/e*255|0,u=(i>>10&e)/e*255|0,h=i>>15?255:0,d=a*this.width*4+4*n;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=o,this.data[d+3]=h}this.pos+=t}},Po.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(o&e)/e*255|0,u=(o>>5&r)/r*255|0,h=(o>>11)/e*255|0,d=n*this.width*4+4*i;this.data[d]=h,this.data[d+1]=u,this.data[d+2]=c,this.data[d+3]=255}this.pos+=t}},Po.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=i,this.data[o+1]=n,this.data[o+2]=a,this.data[o+3]=255}this.pos+=this.width%4}},Po.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),c=e*this.width*4+4*r;this.data[c]=i,this.data[c+1]=n,this.data[c+2]=a,this.data[c+3]=o}},Po.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,a,n){var i=new Po(e,!1),o=i.width,c=i.height,u={data:i.getData(),width:o,height:c},h=new Zg(100).encode(u,100);return t.processJPEG.call(this,h,r,a,n)}})(Jt.API),db.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,a,n){var i=new db(e),o=i.width,c=i.height,u={data:i.getData(),width:o,height:c},h=new Zg(100).encode(u,100);return t.processJPEG.call(this,h,r,a,n)}})(Jt.API),Jt.API.processRGBA=function(t,e,r){for(var a=t.data,n=a.length,i=new Uint8Array(n/4*3),o=new Uint8Array(n/4),c=0,u=0,h=0;h<n;h+=4){var d=a[h],v=a[h+1],y=a[h+2],g=a[h+3];i[c++]=d,i[c++]=v,i[c++]=y,o[u++]=g}var b=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:b,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Jt.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},gh=Jt.API,Y1=gh.getCharWidthsArray=function(t,e){var r,a,n=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),c=e.widths?e.widths:n.metadata.Unicode.widths,u=c.fof?c.fof:1,h=e.kerning?e.kerning:n.metadata.Unicode.kerning,d=h.fof?h.fof:1,v=e.doKerning!==!1,y=0,g=t.length,b=0,w=c[0]||u,E=[];for(r=0;r<g;r++)a=t.charCodeAt(r),typeof n.metadata.widthOfString=="function"?E.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+o*(1e3/i)||0)/1e3):(y=v&&ua(h[a])==="object"&&!isNaN(parseInt(h[a][b],10))?h[a][b]/d:0,E.push((c[a]||w)/u+y)),b=a;return E},ab=gh.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),a=e.font||this.internal.getFont(),n=e.charSpace||this.internal.getCharSpace();return gh.processArabic&&(t=gh.processArabic(t)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(t,r,n)/r:Y1.apply(this,arguments).reduce(function(i,o){return i+o},0)},nb=function(t,e,r,a){for(var n=[],i=0,o=t.length,c=0;i!==o&&c+e[i]<r;)c+=e[i],i++;n.push(t.slice(0,i));var u=i;for(c=0;i!==o;)c+e[i]>a&&(n.push(t.slice(u,i)),c=0,u=i),c+=e[i],i++;return u!==i&&n.push(t.slice(u,i)),n},ib=function(t,e,r){r||(r={});var a,n,i,o,c,u,h,d=[],v=[d],y=r.textIndent||0,g=0,b=0,w=t.split(" "),E=Y1.apply(this,[" ",r])[0];if(u=r.lineIndent===-1?w[0].length+2:r.lineIndent||0){var A=Array(u).join(" "),O=[];w.map(function(R){(R=R.split(/\s*\n/)).length>1?O=O.concat(R.map(function(H,z){return(z&&H.length?`
`:"")+H})):O.push(R[0])}),w=O,u=ab.apply(this,[A,r])}for(i=0,o=w.length;i<o;i++){var T=0;if(a=w[i],u&&a[0]==`
`&&(a=a.substr(1),T=1),y+g+(b=(n=Y1.apply(this,[a,r])).reduce(function(R,H){return R+H},0))>e||T){if(b>e){for(c=nb.apply(this,[a,n,e-(y+g),e]),d.push(c.shift()),d=[c.pop()];c.length;)v.push([c.shift()]);b=n.slice(a.length-(d[0]?d[0].length:0)).reduce(function(R,H){return R+H},0)}else d=[a];v.push(d),y=b+u,g=E}else d.push(a),y+=g+b,g=E}return h=u?function(R,H){return(H?A:"")+R.join(" ")}:function(R){return R.join(" ")},v.map(h)},gh.splitTextToSize=function(t,e,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var v=this.internal.getFont(d.fontName,d.fontStyle),y="Unicode";return v.metadata[y]?{widths:v.metadata[y].widths||{0:1},kerning:v.metadata[y].kerning||{}}:{font:v.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/n;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,i.lineIndent=r.lineIndent;var c,u,h=[];for(c=0,u=a.length;c<u;c++)h=h.concat(ib.apply(this,[a[c],o,i]));return h},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",a={},n={},i=0;i<16;i++)a[r[i]]=e[i],n[e[i]]=r[i];var o=function(y){return"0x"+parseInt(y,10).toString(16)},c=t.__fontmetrics__.compress=function(y){var g,b,w,E,A=["{"];for(var O in y){if(g=y[O],isNaN(parseInt(O,10))?b="'"+O+"'":(O=parseInt(O,10),b=(b=o(O).slice(2)).slice(0,-1)+n[b.slice(-1)]),typeof g=="number")g<0?(w=o(g).slice(3),E="-"):(w=o(g).slice(2),E=""),w=E+w.slice(0,-1)+n[w.slice(-1)];else{if(ua(g)!=="object")throw new Error("Don't know what to do with value type "+ua(g)+".");w=c(g)}A.push(b+w)}return A.push("}"),A.join("")},u=t.__fontmetrics__.uncompress=function(y){if(typeof y!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,b,w,E,A={},O=1,T=A,R=[],H="",z="",F=y.length-1,W=1;W<F;W+=1)(E=y[W])=="'"?g?(w=g.join(""),g=void 0):g=[]:g?g.push(E):E=="{"?(R.push([T,w]),T={},w=void 0):E=="}"?((b=R.pop())[0][b[1]]=T,w=void 0,T=b[0]):E=="-"?O=-1:w===void 0?a.hasOwnProperty(E)?(H+=a[E],w=parseInt(H,16)*O,O=1,H=""):H+=E:a.hasOwnProperty(E)?(z+=a[E],T[w]=parseInt(z,16)*O,O=1,w=void 0,z=""):z+=E;return A},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},v={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(y){var g=y.font,b=v.Unicode[g.postScriptName];b&&(g.metadata.Unicode={},g.metadata.Unicode.widths=b.widths,g.metadata.Unicode.kerning=b.kerning);var w=d.Unicode[g.postScriptName];w&&(g.metadata.Unicode.encoding=w,g.encoding=w.codePages[0])}])})(Jt.API),(function(t){var e=function(r){for(var a=r.length,n=new Uint8Array(a),i=0;i<a;i++)n[i]=r.charCodeAt(i);return n};t.API.events.push(["addFont",function(r){var a=void 0,n=r.font,i=r.instance;if(!n.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=i.existsFileInVFS(n.postScriptName)===!1?i.loadFile(n.postScriptName):i.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(o,c){c=/^\x00\x01\x00\x00/.test(c)?e(c):e(Q1(c)),o.metadata=t.API.TTFFont.open(c),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(n,a)}}])})(Jt),Jt.API.addSvgAsImage=function(t,e,r,a,n,i,o,c){if(isNaN(e)||isNaN(r))throw Sa.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(n))throw Sa.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=a,u.height=n;var h=u.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,u.width,u.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},v=this;return(gr.canvg?Promise.resolve(gr.canvg):Og(()=>import("./index.es-D_p_Qovl.js"),[])).catch(function(y){return Promise.reject(new Error("Could not load canvg: "+y))}).then(function(y){return y.default?y.default:y}).then(function(y){return y.fromString(h,t,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(d)}).then(function(){v.addImage(u.toDataURL("image/jpeg",1),e,r,a,n,o,c)})},Jt.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(e,r);return this},Jt.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var a,n,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(o),u=[],h=0,d=0,v=0;function y(b,w){var E,A=!1;for(E=0;E<b.length;E+=1)b[E]===w&&(A=!0);return A}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var g=c.length;for(v=0;v<g;v+=1)r[c[v]].value=r[c[v]].defaultValue,r[c[v]].explicitSet=!1}if(ua(t)==="object"){for(n in t)if(i=t[n],y(c,n)&&i!==void 0){if(r[n].type==="boolean"&&typeof i=="boolean")r[n].value=i;else if(r[n].type==="name"&&y(r[n].valueSet,i))r[n].value=i;else if(r[n].type==="integer"&&Number.isInteger(i))r[n].value=i;else if(r[n].type==="array"){for(h=0;h<i.length;h+=1)if(a=!0,i[h].length===1&&typeof i[h][0]=="number")u.push(String(i[h]-1));else if(i[h].length>1){for(d=0;d<i[h].length;d+=1)typeof i[h][d]!="number"&&(a=!1);a===!0&&u.push([i[h][0]-1,i[h][1]-1].join(" "))}r[n].value="["+u.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,w=[];for(b in r)r[b].explicitSet===!0&&(r[b].type==="name"?w.push("/"+b+" /"+r[b].value):w.push("/"+b+" "+r[b].value));w.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+w.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(a)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),h=i.length+o.length+c.length+n.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(n+i+o+c+u),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(Jt.API),(function(t){var e=t.API,r=e.pdfEscape16=function(i,o){for(var c,u=o.metadata.Unicode.widths,h=["","0","00","000","0000"],d=[""],v=0,y=i.length;v<y;++v){if(c=o.metadata.characterToGlyph(i.charCodeAt(v)),o.metadata.glyIdsUsed.push(c),o.metadata.toUnicode[c]=i.charCodeAt(v),u.indexOf(c)==-1&&(u.push(c),u.push([parseInt(o.metadata.widthOfGlyph(c),10)])),c=="0")return d.join("");c=c.toString(16),d.push(h[4-c.length],c)}return d.join("")},a=function(i){var o,c,u,h,d,v,y;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],v=0,y=(c=Object.keys(i).sort(function(g,b){return g-b})).length;v<y;v++)o=c[v],u.length>=100&&(d+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(h=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),u.push("<"+o+"><"+h+">"));return u.length&&(d+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(o){var c=o.font,u=o.out,h=o.newObject,d=o.putStream;if(c.metadata instanceof t.API.TTFFont&&c.encoding==="Identity-H"){for(var v=c.metadata.Unicode.widths,y=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),g="",b=0;b<y.length;b++)g+=String.fromCharCode(y[b]);var w=h();d({data:g,addLength1:!0,objectId:w}),u("endobj");var E=h();d({data:a(c.metadata.toUnicode),addLength1:!0,objectId:E}),u("endobj");var A=h();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+wh(c.fontName)),u("/FontFile2 "+w+" 0 R"),u("/FontBBox "+t.API.PDFObject.convert(c.metadata.bbox)),u("/Flags "+c.metadata.flags),u("/StemV "+c.metadata.stemV),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u(">>"),u("endobj");var O=h();u("<<"),u("/Type /Font"),u("/BaseFont /"+wh(c.fontName)),u("/FontDescriptor "+A+" 0 R"),u("/W "+t.API.PDFObject.convert(v)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+c.encoding+")"),u(">>"),u(">>"),u("endobj"),c.objectNumber=h(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+E+" 0 R"),u("/BaseFont /"+wh(c.fontName)),u("/Encoding /"+c.encoding),u("/DescendantFonts ["+O+" 0 R]"),u(">>"),u("endobj"),c.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(o){var c=o.font,u=o.out,h=o.newObject,d=o.putStream;if(c.metadata instanceof t.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var v=c.metadata.rawData,y="",g=0;g<v.length;g++)y+=String.fromCharCode(v[g]);var b=h();d({data:y,addLength1:!0,objectId:b}),u("endobj");var w=h();d({data:a(c.metadata.toUnicode),addLength1:!0,objectId:w}),u("endobj");var E=h();u("<<"),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u("/StemV "+c.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+b+" 0 R"),u("/Flags 96"),u("/FontBBox "+t.API.PDFObject.convert(c.metadata.bbox)),u("/FontName /"+wh(c.fontName)),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u(">>"),u("endobj"),c.objectNumber=h();for(var A=0;A<c.metadata.hmtx.widths.length;A++)c.metadata.hmtx.widths[A]=parseInt(c.metadata.hmtx.widths[A]*(1e3/c.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+w+" 0 R/BaseFont/"+wh(c.fontName)+"/FontDescriptor "+E+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),u("endobj"),c.isAlreadyPutted=!0}})(i)}]);var n=function(i){var o,c=i.text||"",u=i.x,h=i.y,d=i.options||{},v=i.mutex||{},y=v.pdfEscape,g=v.activeFontKey,b=v.fonts,w=g,E="",A=0,O="",T=b[w].encoding;if(b[w].encoding!=="Identity-H")return{text:c,x:u,y:h,options:d,mutex:v};for(O=c,w=g,Array.isArray(c)&&(O=c[0]),A=0;A<O.length;A+=1)b[w].metadata.hasOwnProperty("cmap")&&(o=b[w].metadata.cmap.unicode.codeMap[O[A].charCodeAt(0)]),o||O[A].charCodeAt(0)<256&&b[w].metadata.hasOwnProperty("Unicode")?E+=O[A]:E+="";var R="";return parseInt(w.slice(1))<14||T==="WinAnsiEncoding"?R=y(E,w).split("").map(function(H){return H.charCodeAt(0).toString(16)}).join(""):T==="Identity-H"&&(R=r(E,b[w])),v.isHex=!0,{text:R,x:u,y:h,options:d,mutex:v}};e.events.push(["postProcessText",function(i){var o=i.text||"",c=[],u={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var h=0;for(h=0;h<o.length;h+=1)Array.isArray(o[h])&&o[h].length===3?c.push([n(Object.assign({},u,{text:o[h][0]})).text,o[h][1],o[h][2]]):c.push(n(Object.assign({},u,{text:o[h]})).text);i.text=c}else i.text=n(Object.assign({},u,{text:o})).text}])})(Jt),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,a){return e.call(this),this.internal.vFS[r]=a,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(Jt.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(a){var n,i,o,c,u,h,d,v=e,y=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},w={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},E=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],A=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),O=!1,T=0;this.__bidiEngine__={};var R=function(I){var L=I.charCodeAt(),ee=L>>8,oe=w[ee];return oe!==void 0?v[256*oe+(255&L)]:ee===252||ee===253?"AL":A.test(ee)?"L":ee===8?"R":"N"},H=function(I){for(var L,ee=0;ee<I.length;ee++){if((L=R(I.charAt(ee)))==="L")return!1;if(L==="R")return!0}return!1},z=function(I,L,ee,oe){var ge,ie,he,de,Z=L[oe];switch(Z){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":O=!1;break;case"N":case"AN":break;case"EN":O&&(Z="AN");break;case"AL":O=!0,Z="R";break;case"WS":case"BN":Z="N";break;case"CS":oe<1||oe+1>=L.length||(ge=ee[oe-1])!=="EN"&&ge!=="AN"||(ie=L[oe+1])!=="EN"&&ie!=="AN"?Z="N":O&&(ie="AN"),Z=ie===ge?ie:"N";break;case"ES":Z=(ge=oe>0?ee[oe-1]:"B")==="EN"&&oe+1<L.length&&L[oe+1]==="EN"?"EN":"N";break;case"ET":if(oe>0&&ee[oe-1]==="EN"){Z="EN";break}if(O){Z="N";break}for(he=oe+1,de=L.length;he<de&&L[he]==="ET";)he++;Z=he<de&&L[he]==="EN"?"EN":"N";break;case"NSM":if(o&&!c){for(de=L.length,he=oe+1;he<de&&L[he]==="NSM";)he++;if(he<de){var Ne=I[oe],Q=Ne>=1425&&Ne<=2303||Ne===64286;if(ge=L[he],Q&&(ge==="R"||ge==="AL")){Z="R";break}}}Z=oe<1||(ge=L[oe-1])==="B"?"N":ee[oe-1];break;case"B":O=!1,n=!0,Z=T;break;case"S":i=!0,Z="N"}return Z},F=function(I,L,ee){var oe=I.split("");return ee&&W(oe,ee,{hiLevel:T}),oe.reverse(),L&&L.reverse(),oe.join("")},W=function(I,L,ee){var oe,ge,ie,he,de,Z=-1,Ne=I.length,Q=0,N=[],M=T?g:y,B=[];for(O=!1,n=!1,i=!1,ge=0;ge<Ne;ge++)B[ge]=R(I[ge]);for(ie=0;ie<Ne;ie++){if(de=Q,N[ie]=z(I,B,N,ie),oe=240&(Q=M[de][b[N[ie]]]),Q&=15,L[ie]=he=M[Q][5],oe>0)if(oe===16){for(ge=Z;ge<ie;ge++)L[ge]=1;Z=-1}else Z=-1;if(M[Q][6])Z===-1&&(Z=ie);else if(Z>-1){for(ge=Z;ge<ie;ge++)L[ge]=he;Z=-1}B[ie]==="B"&&(L[ie]=0),ee.hiLevel|=he}i&&(function(q,K,se){for(var me=0;me<se;me++)if(q[me]==="S"){K[me]=T;for(var we=me-1;we>=0&&q[we]==="WS";we--)K[we]=T}})(B,L,Ne)},D=function(I,L,ee,oe,ge){if(!(ge.hiLevel<I)){if(I===1&&T===1&&!n)return L.reverse(),void(ee&&ee.reverse());for(var ie,he,de,Z,Ne=L.length,Q=0;Q<Ne;){if(oe[Q]>=I){for(de=Q+1;de<Ne&&oe[de]>=I;)de++;for(Z=Q,he=de-1;Z<he;Z++,he--)ie=L[Z],L[Z]=L[he],L[he]=ie,ee&&(ie=ee[Z],ee[Z]=ee[he],ee[he]=ie);Q=de}Q++}}},Y=function(I,L,ee){var oe=I.split(""),ge={hiLevel:T};return ee||(ee=[]),W(oe,ee,ge),(function(ie,he,de){if(de.hiLevel!==0&&d)for(var Z,Ne=0;Ne<ie.length;Ne++)he[Ne]===1&&(Z=E.indexOf(ie[Ne]))>=0&&(ie[Ne]=E[Z+1])})(oe,ee,ge),D(2,oe,L,ee,ge),D(1,oe,L,ee,ge),oe.join("")};return this.__bidiEngine__.doBidiReorder=function(I,L,ee){if((function(ge,ie){if(ie)for(var he=0;he<ge.length;he++)ie[he]=he;c===void 0&&(c=H(ge)),h===void 0&&(h=H(ge))})(I,L),o||!u||h)if(o&&u&&c^h)T=c?1:0,I=F(I,L,ee);else if(!o&&u&&h)T=c?1:0,I=Y(I,L,ee),I=F(I,L);else if(!o||c||u||h){if(o&&!u&&c^h)I=F(I,L),c?(T=0,I=Y(I,L,ee)):(T=1,I=Y(I,L,ee),I=F(I,L));else if(o&&c&&!u&&h)T=1,I=Y(I,L,ee),I=F(I,L);else if(!o&&!u&&c^h){var oe=d;c?(T=1,I=Y(I,L,ee),T=0,d=!1,I=Y(I,L,ee),d=oe):(T=0,I=Y(I,L,ee),I=F(I,L),T=1,d=!1,I=Y(I,L,ee),d=oe,I=F(I,L))}}else T=0,I=Y(I,L,ee);else T=c?1:0,I=Y(I,L,ee);return I},this.__bidiEngine__.setOptions=function(I){I&&(o=I.isInputVisual,u=I.isOutputVisual,c=I.isInputRtl,h=I.isOutputRtl,d=I.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(a){var n=a.text;a.x,a.y;var i=a.options||{};a.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(n)==="[object Array]"){var c=0;for(o=[],c=0;c<n.length;c+=1)Object.prototype.toString.call(n[c])==="[object Array]"?o.push([r.doBidiReorder(n[c][0]),n[c][1],n[c][2]]):o.push([r.doBidiReorder(n[c])]);a.text=o}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])})(Jt),Jt.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new nu(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new LB(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new _B(this.contents),this.head=new bB(this),this.name=new NB(this),this.cmap=new TE(this),this.toUnicode={},this.hhea=new SB(this),this.maxp=new TB(this),this.hmtx=new jB(this),this.post=new kB(this),this.os2=new EB(this),this.loca=new RB(this),this.glyf=new CB(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,a,n,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,c,u,h;for(h=[],o=0,c=(u=this.bbox).length;o<c;o++)e=u[o],h.push(Math.round(e*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),32768&(r=n>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,a){var n,i,o,c;for(o=0,i=0,c=(e=""+e).length;0<=c?i<c:i>c;i=0<=c?++i:--i)n=e.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*e},t})();var Go,nu=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,a;for(a=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},t.prototype.writeString=function(e){var r,a,n;for(n=[],r=0,a=e.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(e.charCodeAt(r)));return n},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,a,n,i,o,c,u;return e=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),c=this.readByte(),u=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^i)+65536*(255^o)+256*(255^c)+(255^u)+1):72057594037927940*e+281474976710656*r+1099511627776*a+4294967296*n+16777216*i+65536*o+256*c+u},t.prototype.writeLongLong=function(e){var r,a;return r=Math.floor(e/4294967296),a=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,a;for(r=[],a=0;0<=e?a<e:a>e;a=0<=e?++a:--a)r.push(this.readByte());return r},t.prototype.write=function(e){var r,a,n,i;for(i=[],a=0,n=e.length;a<n;a++)r=e[a],i.push(this.writeByte(r));return i},t})(),_B=(function(){var t;function e(r){var a,n,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,i=this.tableCount;0<=i?n<i:n>i;n=0<=i?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return e.prototype.encode=function(r){var a,n,i,o,c,u,h,d,v,y,g,b,w;for(w in g=Object.keys(r).length,u=Math.log(2),v=16*Math.floor(Math.log(g)/u),o=Math.floor(v/u),d=16*g-v,(n=new nu).writeInt(this.scalarType),n.writeShort(g),n.writeShort(v),n.writeShort(o),n.writeShort(d),i=16*g,h=n.pos+i,c=null,b=[],r)for(y=r[w],n.writeString(w),n.writeInt(t(y)),n.writeInt(h),n.writeInt(y.length),b=b.concat(y),w==="head"&&(c=h),h+=y.length;h%4;)b.push(0),h++;return n.write(b),a=2981146554-t(n.data),n.pos=c+8,n.writeUInt32(a),n.data},t=function(r){var a,n,i,o;for(r=jE.call(r);r.length%4;)r.push(0);for(i=new nu(r),n=0,a=0,o=r.length;a<o;a=a+=4)n+=i.readUInt32();return 4294967295&n},e})(),wB={}.hasOwnProperty,Sl=function(t,e){for(var r in e)wB.call(e,r)&&(t[r]=e[r]);function a(){this.constructor=t}return a.prototype=e.prototype,t.prototype=new a,t.__super__=e.prototype,t};Go=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var bB=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sl(t,Go),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new nu).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t})(),pb=(function(){function t(e,r){var a,n,i,o,c,u,h,d,v,y,g,b,w,E,A,O,T;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),v=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=e.readByte();break;case 4:for(g=e.readUInt16(),y=g/2,e.pos+=6,i=(function(){var R,H;for(H=[],u=R=0;0<=y?R<y:R>y;u=0<=y?++R:--R)H.push(e.readUInt16());return H})(),e.pos+=2,w=(function(){var R,H;for(H=[],u=R=0;0<=y?R<y:R>y;u=0<=y?++R:--R)H.push(e.readUInt16());return H})(),h=(function(){var R,H;for(H=[],u=R=0;0<=y?R<y:R>y;u=0<=y?++R:--R)H.push(e.readUInt16());return H})(),d=(function(){var R,H;for(H=[],u=R=0;0<=y?R<y:R>y;u=0<=y?++R:--R)H.push(e.readUInt16());return H})(),n=(this.length-e.pos+this.offset)/2,c=(function(){var R,H;for(H=[],u=R=0;0<=n?R<n:R>n;u=0<=n?++R:--R)H.push(e.readUInt16());return H})(),u=A=0,T=i.length;A<T;u=++A)for(E=i[u],a=O=b=w[u];b<=E?O<=E:O>=E;a=b<=E?++O:--O)d[u]===0?o=a+h[u]:(o=c[d[u]/2+(a-b)-(y-u)]||0)!==0&&(o+=h[u]),this.codeMap[a]=65535&o}e.pos=v}return t.encode=function(e,r){var a,n,i,o,c,u,h,d,v,y,g,b,w,E,A,O,T,R,H,z,F,W,D,Y,I,L,ee,oe,ge,ie,he,de,Z,Ne,Q,N,M,B,q,K,se,me,we,Se,Ee,ae;switch(oe=new nu,o=Object.keys(e).sort(function(rt,Je){return rt-Je}),r){case"macroman":for(w=0,E=(function(){var rt=[];for(b=0;b<256;++b)rt.push(0);return rt})(),O={0:0},i={},ge=0,Z=o.length;ge<Z;ge++)O[we=e[n=o[ge]]]==null&&(O[we]=++w),i[n]={old:e[n],new:O[e[n]]},E[n]=O[e[n]];return oe.writeUInt16(1),oe.writeUInt16(0),oe.writeUInt32(12),oe.writeUInt16(0),oe.writeUInt16(262),oe.writeUInt16(0),oe.write(E),{charMap:i,subtable:oe.data,maxGlyphID:w+1};case"unicode":for(L=[],v=[],T=0,O={},a={},A=h=null,ie=0,Ne=o.length;ie<Ne;ie++)O[H=e[n=o[ie]]]==null&&(O[H]=++T),a[n]={old:H,new:O[H]},c=O[H]-n,A!=null&&c===h||(A&&v.push(A),L.push(n),h=c),A=n;for(A&&v.push(A),v.push(65535),L.push(65535),Y=2*(D=L.length),W=2*Math.pow(Math.log(D)/Math.LN2,2),y=Math.log(W/2)/Math.LN2,F=2*D-W,u=[],z=[],g=[],b=he=0,Q=L.length;he<Q;b=++he){if(I=L[b],d=v[b],I===65535){u.push(0),z.push(0);break}if(I-(ee=a[I].new)>=32768)for(u.push(0),z.push(2*(g.length+D-b)),n=de=I;I<=d?de<=d:de>=d;n=I<=d?++de:--de)g.push(a[n].new);else u.push(ee-I),z.push(0)}for(oe.writeUInt16(3),oe.writeUInt16(1),oe.writeUInt32(12),oe.writeUInt16(4),oe.writeUInt16(16+8*D+2*g.length),oe.writeUInt16(0),oe.writeUInt16(Y),oe.writeUInt16(W),oe.writeUInt16(y),oe.writeUInt16(F),se=0,N=v.length;se<N;se++)n=v[se],oe.writeUInt16(n);for(oe.writeUInt16(0),me=0,M=L.length;me<M;me++)n=L[me],oe.writeUInt16(n);for(Se=0,B=u.length;Se<B;Se++)c=u[Se],oe.writeUInt16(c);for(Ee=0,q=z.length;Ee<q;Ee++)R=z[Ee],oe.writeUInt16(R);for(ae=0,K=g.length;ae<K;ae++)w=g[ae],oe.writeUInt16(w);return{charMap:a,subtable:oe.data,maxGlyphID:T+1}}},t})(),TE=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sl(t,Go),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,a,n;for(e.pos=this.offset,this.version=e.readUInt16(),n=e.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)r=new pb(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var a,n;return r==null&&(r="macroman"),a=pb.encode(e,r),(n=new nu).writeUInt16(0),n.writeUInt16(1),a.table=n.data.concat(a.subtable),a},t})(),SB=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sl(t,Go),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),EB=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sl(t,Go),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var r,a;for(a=[],r=0;r<10;++r)a.push(e.readByte());return a})(),this.charRange=(function(){var r,a;for(a=[],r=0;r<4;++r)a.push(e.readInt());return a})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var r,a;for(a=[],r=0;r<2;r=++r)a.push(e.readInt());return a})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),kB=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sl(t,Go),t.prototype.tag="post",t.prototype.parse=function(e){var r,a,n;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(a=e.readUInt16(),this.glyphNameIndex=[],i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],n=[];e.pos<this.offset+this.length;)r=e.readByte(),n.push(this.names.push(e.readString(r)));return n;case 151552:return a=e.readUInt16(),this.offsets=e.read(a);case 262144:return this.map=(function(){var o,c,u;for(u=[],i=o=0,c=this.file.maxp.numGlyphs;0<=c?o<c:o>c;i=0<=c?++o:--o)u.push(e.readUInt32());return u}).call(this)}},t})(),AB=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},NB=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sl(t,Go),t.prototype.tag="name",t.prototype.parse=function(e){var r,a,n,i,o,c,u,h,d,v,y;for(e.pos=this.offset,e.readShort(),r=e.readShort(),c=e.readShort(),a=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)a.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+c+e.readShort()});for(u={},i=d=0,v=a.length;d<v;i=++d)n=a[i],e.pos=n.offset,h=e.readString(n.length),o=new AB(h,n),u[y=n.nameID]==null&&(u[y]=[]),u[n.nameID].push(o);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t})(),TB=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sl(t,Go),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),jB=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sl(t,Go),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,a,n,i,o,c,u;for(e.pos=this.offset,this.metrics=[],r=0,c=this.file.hhea.numberOfMetrics;0<=c?r<c:r>c;r=0<=c?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var h,d;for(d=[],r=h=0;0<=n?h<n:h>n;r=0<=n?++h:--h)d.push(e.readInt16());return d})(),this.widths=(function(){var h,d,v,y;for(y=[],h=0,d=(v=this.metrics).length;h<d;h++)i=v[h],y.push(i.advance);return y}).call(this),a=this.widths[this.widths.length-1],u=[],r=o=0;0<=n?o<n:o>n;r=0<=n?++o:--o)u.push(this.widths.push(a));return u},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),jE=[].slice,CB=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sl(t,Go),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,a,n,i,o,c,u,h,d,v;return e in this.cache?this.cache[e]:(i=this.file.loca,r=this.file.contents,a=i.indexOf(e),(n=i.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+a,o=(c=new nu(r.read(n))).readShort(),h=c.readShort(),v=c.readShort(),u=c.readShort(),d=c.readShort(),this.cache[e]=o===-1?new FB(c,h,v,u,d):new OB(c,o,h,v,u,d),this.cache[e]))},t.prototype.encode=function(e,r,a){var n,i,o,c,u;for(o=[],i=[],c=0,u=r.length;c<u;c++)n=e[r[c]],i.push(o.length),n&&(o=o.concat(n.encode(a)));return i.push(o.length),{table:o,offsets:i}},t})(),OB=(function(){function t(e,r,a,n,i,o){this.raw=e,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),FB=(function(){function t(e,r,a,n,i){var o,c;for(this.raw=e,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;c=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&c;)o.pos+=1&c?4:2,128&c?o.pos+=8:64&c?o.pos+=4:8&c&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,a;for(r=new nu(jE.call(this.raw.data)),e=0,a=this.glyphIDs.length;e<a;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),RB=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Sl(t,Go),t.prototype.tag="loca",t.prototype.parse=function(e){var r,a;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var n,i;for(i=[],a=0,n=this.length;a<n;a+=2)i.push(2*e.readUInt16());return i}).call(this):(function(){var n,i;for(i=[],a=0,n=this.length;a<n;a+=4)i.push(e.readUInt32());return i}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var a=new Uint32Array(this.offsets.length),n=0,i=0,o=0;o<a.length;++o)if(a[o]=n,i<r.length&&r[i]==o){++i,a[o]=n;var c=this.offsets[o],u=this.offsets[o+1]-c;u>0&&(n+=u)}for(var h=new Array(4*a.length),d=0;d<a.length;++d)h[4*d+3]=255&a[d],h[4*d+2]=(65280&a[d])>>8,h[4*d+1]=(16711680&a[d])>>16,h[4*d]=(4278190080&a[d])>>24;return h},t})(),LB=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,a,n,i;for(r in n=this.font.cmap.tables[0].codeMap,e={},i=this.subset)a=i[r],e[r]=n[a];return e},t.prototype.glyphsFor=function(e){var r,a,n,i,o,c,u;for(n={},o=0,c=e.length;o<c;o++)n[i=e[o]]=this.font.glyf.glyphFor(i);for(i in r=[],n)(a=n[i])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(i in u=this.glyphsFor(r))a=u[i],n[i]=a;return n},t.prototype.encode=function(e,r){var a,n,i,o,c,u,h,d,v,y,g,b,w,E,A;for(n in a=TE.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),g={0:0},A=a.charMap)g[(u=A[n]).old]=u.new;for(b in y=a.maxGlyphID,o)b in g||(g[b]=y++);return d=(function(O){var T,R;for(T in R={},O)R[O[T]]=T;return R})(g),v=Object.keys(d).sort(function(O,T){return O-T}),w=(function(){var O,T,R;for(R=[],O=0,T=v.length;O<T;O++)c=v[O],R.push(d[c]);return R})(),i=this.font.glyf.encode(o,w,g),h=this.font.loca.encode(i.offsets,w),E={cmap:this.font.cmap.raw(),glyf:i.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(E["OS/2"]=this.font.os2.raw()),this.font.directory.encode(E)},t})();Jt.API.PDFObject=(function(){var t;function e(){}return t=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},e.convert=function(r){var a,n,i,o;if(Array.isArray(r))return"["+(function(){var c,u,h;for(h=[],c=0,u=r.length;c<u;c++)a=r[c],h.push(e.convert(a));return h})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in i=["<<"],r)o=r[n],i.push("/"+n+" "+e.convert(o));return i.push(">>"),i.join(`
`)}return""+r},e})();function CE(t,e,r,a,n){a=a||{};var i=1.15,o=n.internal.scaleFactor,c=n.internal.getFontSize()/o,u=n.getLineHeightFactor?n.getLineHeightFactor():i,h=c*u,d=/\r\n|\r|\n/g,v="",y=1;if((a.valign==="middle"||a.valign==="bottom"||a.halign==="center"||a.halign==="right")&&(v=typeof t=="string"?t.split(d):t,y=v.length||1),r+=c*(2-i),a.valign==="middle"?r-=y/2*h:a.valign==="bottom"&&(r-=y*h),a.halign==="center"||a.halign==="right"){var g=c;if(a.halign==="center"&&(g*=.5),v&&y>=1){for(var b=0;b<v.length;b++)n.text(v[b],e-n.getStringUnitWidth(v[b])*g,r),r+=h;return n}e-=n.getStringUnitWidth(t)*g}return a.halign==="justify"?n.text(t,e,r,{maxWidth:a.maxWidth||100,align:"justify"}):n.text(t,e,r),n}var mb={},Dh=(function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:mb=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var a,n,i;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var o=this.jsPDFDocument.internal.getFont(),c=o.fontStyle,u=o.fontName;if(e.font&&(u=e.font),e.fontStyle){c=e.fontStyle;var h=this.getFontList()[u];h&&h.indexOf(c)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(h[0]),c=h[0])}if(this.jsPDFDocument.setFont(u,c),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var d=t.unifyColor(e.fillColor);d&&(a=this.jsPDFDocument).setFillColor.apply(a,d),d=t.unifyColor(e.textColor),d&&(n=this.jsPDFDocument).setTextColor.apply(n,d),d=t.unifyColor(e.lineColor),d&&(i=this.jsPDFDocument).setDrawColor.apply(i,d),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,a){return this.jsPDFDocument.splitTextToSize(e,r,a)},t.prototype.rect=function(e,r,a,n,i){return this.jsPDFDocument.rect(e,r,a,n,i)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return mb||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t})(),Wv=function(t,e){return Wv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},Wv(t,e)};function OE(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Wv(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var FE=(function(t){OE(e,t);function e(r){var a=t.call(this)||this;return a._element=r,a}return e})(Array);function DB(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function PB(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function jp(t,e,r){r.applyStyles(e,!0);var a=Array.isArray(t)?t:[t],n=a.map(function(i){return r.getTextWidth(i)}).reduce(function(i,o){return Math.max(i,o)},0);return n}function RE(t,e,r,a){var n=e.settings.tableLineWidth,i=e.settings.tableLineColor;t.applyStyles({lineWidth:n,lineColor:i});var o=LE(n,!1);o&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),a.y-r.y,o)}function LE(t,e){var r=t>0,a=e||e===0;return r&&a?"DF":r?"S":a?"F":null}function Gp(t,e){var r,a,n,i;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(a=t.top)!==null&&a!==void 0?a:e,right:(n=t.right)!==null&&n!==void 0?n:e,bottom:(i=t.bottom)!==null&&i!==void 0?i:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function DE(t,e){var r=Gp(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function MB(t,e,r,a,n){var i={},o=1.3333333333333333,c=Qg(e,function(T){return n.getComputedStyle(T).backgroundColor});c!=null&&(i.fillColor=c);var u=Qg(e,function(T){return n.getComputedStyle(T).color});u!=null&&(i.textColor=u);var h=BB(a,r);h&&(i.cellPadding=h);var d="borderTopColor",v=o*r,y=a.borderTopWidth;if(a.borderBottomWidth===y&&a.borderRightWidth===y&&a.borderLeftWidth===y){var g=(parseFloat(y)||0)/v;g&&(i.lineWidth=g)}else i.lineWidth={top:(parseFloat(a.borderTopWidth)||0)/v,right:(parseFloat(a.borderRightWidth)||0)/v,bottom:(parseFloat(a.borderBottomWidth)||0)/v,left:(parseFloat(a.borderLeftWidth)||0)/v},i.lineWidth.top||(i.lineWidth.right?d="borderRightColor":i.lineWidth.bottom?d="borderBottomColor":i.lineWidth.left&&(d="borderLeftColor"));var b=Qg(e,function(T){return n.getComputedStyle(T)[d]});b!=null&&(i.lineColor=b);var w=["left","right","center","justify"];w.indexOf(a.textAlign)!==-1&&(i.halign=a.textAlign),w=["middle","bottom","top"],w.indexOf(a.verticalAlign)!==-1&&(i.valign=a.verticalAlign);var E=parseInt(a.fontSize||"");isNaN(E)||(i.fontSize=E/o);var A=IB(a);A&&(i.fontStyle=A);var O=(a.fontFamily||"").toLowerCase();return t.indexOf(O)!==-1&&(i.font=O),i}function IB(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function Qg(t,e){var r=PE(t,e);if(!r)return null;var a=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!a||!Array.isArray(a))return null;var n=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])],i=parseInt(a[4]);return i===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function PE(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:PE(t.parentElement,e):r}function BB(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],a=96/(72/e),n=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,i=r.map(function(c){return parseInt(c||"0")/a}),o=Gp(i,0);return n>o.top&&(o.top=n),n>o.bottom&&(o.bottom=n),o}function ME(t,e,r,a,n){var i,o;a===void 0&&(a=!1),n===void 0&&(n=!1);var c;typeof e=="string"?c=r.document.querySelector(e):c=e;var u=Object.keys(t.getFontList()),h=t.scaleFactor(),d=[],v=[],y=[];if(!c)return console.error("Html table could not be found with input: ",e),{head:d,body:v,foot:y};for(var g=0;g<c.rows.length;g++){var b=c.rows[g],w=(o=(i=b?.parentElement)===null||i===void 0?void 0:i.tagName)===null||o===void 0?void 0:o.toLowerCase(),E=UB(u,h,r,b,a,n);E&&(w==="thead"?d.push(E):w==="tfoot"?y.push(E):v.push(E))}return{head:d,body:v,foot:y}}function UB(t,e,r,a,n,i){for(var o=new FE(a),c=0;c<a.cells.length;c++){var u=a.cells[c],h=r.getComputedStyle(u);if(n||h.display!=="none"){var d=void 0;i&&(d=MB(t,u,e,h,r)),o.push({rowSpan:u.rowSpan,colSpan:u.colSpan,styles:d,_element:u,content:qB(u)})}}var v=r.getComputedStyle(a);if(o.length>0&&(n||v.display!=="none"))return o}function qB(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function zB(t,e,r){for(var a=0,n=[t,e,r];a<n.length;a++){var i=n[a];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function tc(t,e,r,a,n){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),o=1;o<arguments.length;o++){var c=arguments[o];if(c!=null)for(var u in c)Object.prototype.hasOwnProperty.call(c,u)&&(i[u]=c[u])}return i}function HB(t,e){var r=new Dh(t),a=r.getDocumentOptions(),n=r.getGlobalOptions();zB(n,a,e);var i=tc({},n,a,e),o;typeof window<"u"&&(o=window);var c=WB(n,a,e),u=VB(n,a,e),h=GB(r,i),d=XB(r,i,o);return{id:e.tableId,content:d,hooks:u,styles:c,settings:h}}function WB(t,e,r){for(var a={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(u){if(u==="columnStyles"){var h=t[u],d=e[u],v=r[u];a.columnStyles=tc({},h,d,v)}else{var y=[t,e,r],g=y.map(function(b){return b[u]||{}});a[u]=tc({},g[0],g[1],g[2])}},i=0,o=Object.keys(a);i<o.length;i++){var c=o[i];n(c)}return a}function VB(t,e,r){for(var a=[t,e,r],n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,o=a;i<o.length;i++){var c=o[i];c.didParseCell&&n.didParseCell.push(c.didParseCell),c.willDrawCell&&n.willDrawCell.push(c.willDrawCell),c.didDrawCell&&n.didDrawCell.push(c.didDrawCell),c.willDrawPage&&n.willDrawPage.push(c.willDrawPage),c.didDrawPage&&n.didDrawPage.push(c.didDrawPage)}return n}function GB(t,e){var r,a,n,i,o,c,u,h,d,v,y,g,b=Gp(e.margin,40/t.scaleFactor()),w=(r=$B(t,e.startY))!==null&&r!==void 0?r:b.top,E;e.showFoot===!0?E="everyPage":e.showFoot===!1?E="never":E=(a=e.showFoot)!==null&&a!==void 0?a:"everyPage";var A;e.showHead===!0?A="everyPage":e.showHead===!1?A="never":A=(n=e.showHead)!==null&&n!==void 0?n:"everyPage";var O=(i=e.useCss)!==null&&i!==void 0?i:!1,T=e.theme||(O?"plain":"striped"),R=!!e.horizontalPageBreak,H=(o=e.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(c=e.includeHiddenHtml)!==null&&c!==void 0?c:!1,useCss:O,theme:T,startY:w,margin:b,pageBreak:(u=e.pageBreak)!==null&&u!==void 0?u:"auto",rowPageBreak:(h=e.rowPageBreak)!==null&&h!==void 0?h:"auto",tableWidth:(d=e.tableWidth)!==null&&d!==void 0?d:"auto",showHead:A,showFoot:E,tableLineWidth:(v=e.tableLineWidth)!==null&&v!==void 0?v:0,tableLineColor:(y=e.tableLineColor)!==null&&y!==void 0?y:200,horizontalPageBreak:R,horizontalPageBreakRepeat:H,horizontalPageBreakBehaviour:(g=e.horizontalPageBreakBehaviour)!==null&&g!==void 0?g:"afterAllRows"}}function $B(t,e){var r=t.getLastAutoTable(),a=t.scaleFactor(),n=t.pageNumber(),i=!1;if(r&&r.startPageNumber){var o=r.startPageNumber+r.pageNumber-1;i=o===n}return typeof e=="number"?e:(e==null||e===!1)&&i&&r?.finalY!=null?r.finalY+20/a:null}function XB(t,e,r){var a=e.head||[],n=e.body||[],i=e.foot||[];if(e.html){var o=e.includeHiddenHtml;if(r){var c=ME(t,e.html,r,o,e.useCss)||{};a=c.head||a,n=c.body||a,i=c.foot||a}else console.error("Cannot parse html in non browser environment")}var u=e.columns||YB(a,n,i);return{columns:u,head:a,body:n,foot:i}}function YB(t,e,r){var a=t[0]||e[0]||r[0]||[],n=[];return Object.keys(a).filter(function(i){return i!=="_element"}).forEach(function(i){var o=1,c;Array.isArray(a)?c=a[parseInt(i)]:c=a[i],typeof c=="object"&&!Array.isArray(c)&&(o=c?.colSpan||1);for(var u=0;u<o;u++){var h=void 0;Array.isArray(a)?h=n.length:h=i+(u>0?"_".concat(u):"");var d={dataKey:h};n.push(d)}}),n}var Vv=(function(){function t(e,r,a){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=a,this.doc=e.getDocument()}return t})(),KB=(function(t){OE(e,t);function e(r,a,n,i,o,c){var u=t.call(this,r,a,c)||this;return u.cell=n,u.row=i,u.column=o,u.section=i.section,u}return e})(Vv),JB=(function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,a,n,i,o){for(var c=0,u=r;c<u.length;c++){var h=u[c],d=new KB(e,this,a,n,i,o),v=h(d)===!1;if(a.text=Array.isArray(a.text)?a.text:[a.text],v)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var a=0,n=this.hooks.didDrawPage;a<n.length;a++){var i=n[a];i(new Vv(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var a=0,n=this.hooks.willDrawPage;a<n.length;a++){var i=n[a];i(new Vv(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(n,i){return n+i.wrappedWidth},0);return r}else{var a=this.settings.margin;return e-a.left-a.right}},t})(),IE=(function(){function t(e,r,a,n,i){i===void 0&&(i=!1),this.height=0,this.raw=e,e instanceof FE&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=a,this.cells=n,this.spansMultiplePages=i}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(a,n){var i;return Math.max(a,((i=r.cells[n.index])===null||i===void 0?void 0:i.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(a){var n=r.cells[a.index];return n?n.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var a=this;return e.reduce(function(n,i){var o=a.cells[i.index];if(!o)return 0;var c=r.getLineHeight(o.styles.fontSize),u=o.padding("vertical"),h=u+c;return h>n?h:n},0)},t})(),BE=(function(){function t(e,r,a){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=a,this.raw=e;var i=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,i=(n=e.content)!==null&&n!==void 0?n:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var o=i!=null?""+i:"",c=/\r\n|\r|\n/g;this.text=o.split(c)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var a;if(this.styles.halign==="right")a=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var n=this.width-this.padding("horizontal");a=this.x+n/2+this.padding("left")}else a=this.x+this.padding("left");return{x:a,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var a=Array.isArray(this.text)?this.text.length:1,n=this.styles.fontSize/e*r,i=a*n+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=Gp(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t})(),ZB=(function(){function t(e,r,a){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=a}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,a=0,n=e.allRows();a<n.length;a++){var i=n[a],o=i.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(r=Math.max(r,o.styles.cellWidth))}return r},t})();function QB(t,e){eU(t,e);var r=[],a=0;e.columns.forEach(function(i){var o=i.getMaxCustomCellWidth(e);o?i.width=o:(i.width=i.wrappedWidth,r.push(i)),a+=i.width});var n=e.getWidth(t.pageSize().width)-a;n&&(n=Gv(r,n,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),n&&(n=Gv(r,n,function(i){return i.minWidth})),n=Math.abs(n),!e.settings.horizontalPageBreak&&n>.1/t.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),rU(e),aU(e,t),tU(e)}function eU(t,e){var r=t.scaleFactor(),a=e.settings.horizontalPageBreak,n=DE(t,e);e.allRows().forEach(function(i){for(var o=0,c=e.columns;o<c.length;o++){var u=c[o],h=i.cells[u.index];if(h){var d=e.hooks.didParseCell;e.callCellHooks(t,d,h,i,u,null);var v=h.padding("horizontal");h.contentWidth=jp(h.text,h.styles,t)+v;var y=jp(h.text.join(" ").split(/[^\S\u00A0]+/),h.styles,t);if(h.minReadableWidth=y+h.padding("horizontal"),typeof h.styles.cellWidth=="number")h.minWidth=h.styles.cellWidth,h.wrappedWidth=h.styles.cellWidth;else if(h.styles.cellWidth==="wrap"||a===!0)h.contentWidth>n?(h.minWidth=n,h.wrappedWidth=n):(h.minWidth=h.contentWidth,h.wrappedWidth=h.contentWidth);else{var g=10/r;h.minWidth=h.styles.minCellWidth||g,h.wrappedWidth=h.contentWidth,h.minWidth>h.wrappedWidth&&(h.wrappedWidth=h.minWidth)}}}}),e.allRows().forEach(function(i){for(var o=0,c=e.columns;o<c.length;o++){var u=c[o],h=i.cells[u.index];if(h&&h.colSpan===1)u.wrappedWidth=Math.max(u.wrappedWidth,h.wrappedWidth),u.minWidth=Math.max(u.minWidth,h.minWidth),u.minReadableWidth=Math.max(u.minReadableWidth,h.minReadableWidth);else{var d=e.styles.columnStyles[u.dataKey]||e.styles.columnStyles[u.index]||{},v=d.cellWidth||d.minCellWidth;v&&typeof v=="number"&&(u.minWidth=v,u.wrappedWidth=v)}h&&(h.colSpan>1&&!u.minWidth&&(u.minWidth=h.minWidth),h.colSpan>1&&!u.wrappedWidth&&(u.wrappedWidth=h.minWidth))}})}function Gv(t,e,r){for(var a=e,n=t.reduce(function(g,b){return g+b.wrappedWidth},0),i=0;i<t.length;i++){var o=t[i],c=o.wrappedWidth/n,u=a*c,h=o.width+u,d=r(o),v=h<d?d:h;e-=v-o.width,o.width=v}if(e=Math.round(e*1e10)/1e10,e){var y=t.filter(function(g){return e<0?g.width>r(g):!0});y.length&&(e=Gv(y,e,r))}return e}function tU(t){for(var e={},r=1,a=t.allRows(),n=0;n<a.length;n++)for(var i=a[n],o=0,c=t.columns;o<c.length;o++){var u=c[o],h=e[u.index];if(r>1)r--,delete i.cells[u.index];else if(h)h.cell.height+=i.height,r=h.cell.colSpan,delete i.cells[u.index],h.left--,h.left<=1&&delete e[u.index];else{var d=i.cells[u.index];if(!d)continue;if(d.height=i.height,d.rowSpan>1){var v=a.length-n,y=d.rowSpan>v?v:d.rowSpan;e[u.index]={cell:d,left:y,row:i}}}}}function rU(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var a=e[r],n=null,i=0,o=0,c=0;c<t.columns.length;c++){var u=t.columns[c];if(o-=1,o>1&&t.columns[c+1])i+=u.width,delete a.cells[u.index];else if(n){var h=n;delete a.cells[u.index],n=null,h.width=u.width+i}else{var h=a.cells[u.index];if(!h)continue;if(o=h.colSpan,i=0,h.colSpan>1){n=h,i+=u.width;continue}h.width=u.width+i}}}function aU(t,e){for(var r={count:0,height:0},a=0,n=t.allRows();a<n.length;a++){for(var i=n[a],o=0,c=t.columns;o<c.length;o++){var u=c[o],h=i.cells[u.index];if(h){e.applyStyles(h.styles,!0);var d=h.width-h.padding("horizontal");if(h.styles.overflow==="linebreak")h.text=e.splitTextToSize(h.text,d+1/e.scaleFactor(),{fontSize:h.styles.fontSize});else if(h.styles.overflow==="ellipsize")h.text=gb(h.text,d,h.styles,e,"...");else if(h.styles.overflow==="hidden")h.text=gb(h.text,d,h.styles,e,"");else if(typeof h.styles.overflow=="function"){var v=h.styles.overflow(h.text,d);typeof v=="string"?h.text=[v]:h.text=v}h.contentHeight=h.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var y=h.contentHeight/h.rowSpan;h.rowSpan>1&&r.count*r.height<y*h.rowSpan?r={height:y,count:h.rowSpan}:r&&r.count>0&&r.height>y&&(y=r.height),y>i.height&&(i.height=y)}}r.count--}}function gb(t,e,r,a,n){return t.map(function(i){return nU(i,e,r,a,n)})}function nU(t,e,r,a,n){var i=1e4*a.scaleFactor();if(e=Math.ceil(e*i)/i,e>=jp(t,r,a))return t;for(;e<jp(t+n,r,a)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+n}function iU(t,e){var r=new Dh(t),a=sU(e,r.scaleFactor()),n=new JB(e,a);return QB(r,n),r.applyStyles(r.userStyles),n}function sU(t,e){var r=t.content,a=lU(r.columns);if(r.head.length===0){var n=vb(a,"head");n&&r.head.push(n)}if(r.foot.length===0){var n=vb(a,"foot");n&&r.foot.push(n)}var i=t.settings.theme,o=t.styles;return{columns:a,head:ev("head",r.head,a,o,i,e),body:ev("body",r.body,a,o,i,e),foot:ev("foot",r.foot,a,o,i,e)}}function ev(t,e,r,a,n,i){var o={},c=e.map(function(u,h){for(var d=0,v={},y=0,g=0,b=0,w=r;b<w.length;b++){var E=w[b];if(o[E.index]==null||o[E.index].left===0)if(g===0){var A=void 0;Array.isArray(u)?A=u[E.index-y-d]:A=u[E.dataKey];var O={};typeof A=="object"&&!Array.isArray(A)&&(O=A?.styles||{});var T=cU(t,E,h,n,a,i,O),R=new BE(A,T,t);v[E.dataKey]=R,v[E.index]=R,g=R.colSpan-1,o[E.index]={left:R.rowSpan-1,times:g}}else g--,y++;else o[E.index].left--,g=o[E.index].times,d++}return new IE(u,h,t,v)});return c}function vb(t,e){var r={};return t.forEach(function(a){if(a.raw!=null){var n=oU(e,a.raw);n!=null&&(r[a.dataKey]=n)}}),Object.keys(r).length>0?r:null}function oU(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function lU(t){return t.map(function(e,r){var a,n;return typeof e=="object"?n=(a=e.dataKey)!==null&&a!==void 0?a:r:n=r,new ZB(n,e,r)})}function cU(t,e,r,a,n,i,o){var c=PB(a),u;t==="head"?u=n.headStyles:t==="body"?u=n.bodyStyles:t==="foot"&&(u=n.footStyles);var h=tc({},c.table,c[t],n.styles,u),d=n.columnStyles[e.dataKey]||n.columnStyles[e.index]||{},v=t==="body"?d:{},y=t==="body"&&r%2===0?tc({},c.alternateRow,n.alternateRowStyles):{},g=DB(i),b=tc({},g,h,y,v);return tc(b,o)}function uU(t,e,r){var a;r===void 0&&(r={});var n=DE(t,e),i=new Map,o=[],c=[],u=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?u=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(u=[e.settings.horizontalPageBreakRepeat]),u.forEach(function(y){var g=e.columns.find(function(b){return b.dataKey===y||b.index===y});g&&!i.has(g.index)&&(i.set(g.index,!0),o.push(g.index),c.push(e.columns[g.index]),n-=g.wrappedWidth)});for(var h=!0,d=(a=r?.start)!==null&&a!==void 0?a:0;d<e.columns.length;){if(i.has(d)){d++;continue}var v=e.columns[d].wrappedWidth;if(h||n>=v)h=!1,o.push(d),c.push(e.columns[d]),n-=v;else break;d++}return{colIndexes:o,columns:c,lastIndex:d-1}}function fU(t,e){for(var r=[],a=0;a<e.columns.length;a++){var n=uU(t,e,{start:a});n.columns.length&&(r.push(n),a=n.lastIndex)}return r}function hU(t,e){var r=e.settings,a=r.startY,n=r.margin,i={x:n.left,y:a},o=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),c=a+n.bottom+o;if(r.pageBreak==="avoid"){var u=e.body,h=u.reduce(function(y,g){return y+g.height},0);c+=h}var d=new Dh(t);(r.pageBreak==="always"||r.startY!=null&&c>d.pageSize().height)&&(qE(d),i.y=n.top),e.callWillDrawPageHooks(d,i);var v=tc({},i);e.startPageNumber=d.pageNumber(),r.horizontalPageBreak?dU(d,e,v,i):(d.applyStyles(d.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(y){return sc(d,e,y,i,e.columns)}),d.applyStyles(d.userStyles),e.body.forEach(function(y,g){var b=g===e.body.length-1;Cp(d,e,y,b,v,i,e.columns)}),d.applyStyles(d.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(y){return sc(d,e,y,i,e.columns)})),RE(d,e,v,i),e.callEndPageHooks(d,i),e.finalY=i.y,t.lastAutoTable=e,d.applyStyles(d.userStyles)}function dU(t,e,r,a){var n=fU(t,e),i=e.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")n.forEach(function(h,d){t.applyStyles(t.userStyles),d>0?Z0(t,e,r,a,h.columns,!0):xb(t,e,a,h.columns),pU(t,e,r,a,h.columns),tv(t,e,a,h.columns)});else for(var o=-1,c=n[0],u=function(){var h=o;if(c){t.applyStyles(t.userStyles);var d=c.columns;o>=0?Z0(t,e,r,a,d,!0):xb(t,e,a,d),h=yb(t,e,o+1,a,d),tv(t,e,a,d)}var v=h-o;n.slice(1).forEach(function(y){t.applyStyles(t.userStyles),Z0(t,e,r,a,y.columns,!0),yb(t,e,o+1,a,y.columns,v),tv(t,e,a,y.columns)}),o=h};o<e.body.length-1;)u()}function xb(t,e,r,a){var n=e.settings;t.applyStyles(t.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&e.head.forEach(function(i){return sc(t,e,i,r,a)})}function pU(t,e,r,a,n){t.applyStyles(t.userStyles),e.body.forEach(function(i,o){var c=o===e.body.length-1;Cp(t,e,i,c,r,a,n)})}function yb(t,e,r,a,n,i){t.applyStyles(t.userStyles),i=i??e.body.length;var o=Math.min(r+i,e.body.length),c=-1;return e.body.slice(r,o).forEach(function(u,h){var d=r+h===e.body.length-1,v=UE(t,e,d,a);u.canEntireRowFit(v,n)&&(sc(t,e,u,a,n),c=r+h)}),c}function tv(t,e,r,a){var n=e.settings;t.applyStyles(t.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&e.foot.forEach(function(i){return sc(t,e,i,r,a)})}function mU(t,e,r){var a=r.getLineHeight(t.styles.fontSize),n=t.padding("vertical"),i=Math.floor((e-n)/a);return Math.max(0,i)}function gU(t,e,r,a){var n={};t.spansMultiplePages=!0,t.height=0;for(var i=0,o=0,c=r.columns;o<c.length;o++){var u=c[o],h=t.cells[u.index];if(h){Array.isArray(h.text)||(h.text=[h.text]);var d=new BE(h.raw,h.styles,h.section);d=tc(d,h),d.text=[];var v=mU(h,e,a);h.text.length>v&&(d.text=h.text.splice(v,h.text.length));var y=a.scaleFactor(),g=a.getLineHeightFactor();h.contentHeight=h.getContentHeight(y,g),h.contentHeight>=e&&(h.contentHeight=e,d.styles.minCellHeight-=e),h.contentHeight>t.height&&(t.height=h.contentHeight),d.contentHeight=d.getContentHeight(y,g),d.contentHeight>i&&(i=d.contentHeight),n[u.index]=d}}var b=new IE(t.raw,-1,t.section,n,!0);b.height=i;for(var w=0,E=r.columns;w<E.length;w++){var u=E[w],d=b.cells[u.index];d&&(d.height=b.height);var h=t.cells[u.index];h&&(h.height=t.height)}return b}function vU(t,e,r,a){var n=t.pageSize().height,i=a.settings.margin,o=i.top+i.bottom,c=n-o;e.section==="body"&&(c-=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns));var u=e.getMinimumRowHeight(a.columns,t),h=u<r;if(u>c)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!h)return!1;var d=e.hasRowSpan(a.columns),v=e.getMaxCellHeight(a.columns)>c;return v?(d&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(d||a.settings.rowPageBreak==="avoid")}function Cp(t,e,r,a,n,i,o){var c=UE(t,e,a,i);if(r.canEntireRowFit(c,o))sc(t,e,r,i,o);else if(vU(t,r,c,e)){var u=gU(r,c,e,t);sc(t,e,r,i,o),Z0(t,e,n,i,o),Cp(t,e,u,a,n,i,o)}else Z0(t,e,n,i,o),Cp(t,e,r,a,n,i,o)}function sc(t,e,r,a,n){a.x=e.settings.margin.left;for(var i=0,o=n;i<o.length;i++){var c=o[i],u=r.cells[c.index];if(!u){a.x+=c.width;continue}t.applyStyles(u.styles),u.x=a.x,u.y=a.y;var h=e.callCellHooks(t,e.hooks.willDrawCell,u,r,c,a);if(h===!1){a.x+=c.width;continue}xU(t,u,a);var d=u.getTextPos();CE(u.text,d.x,d.y,{halign:u.styles.halign,valign:u.styles.valign,maxWidth:Math.ceil(u.width-u.padding("left")-u.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,u,r,c,a),a.x+=c.width}a.y+=r.height}function xU(t,e,r){var a=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof a.lineWidth=="number"){var n=LE(a.lineWidth,a.fillColor);n&&t.rect(e.x,r.y,e.width,e.height,n)}else typeof a.lineWidth=="object"&&(a.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),yU(t,e,r,a.lineWidth))}function yU(t,e,r,a){var n,i,o,c;a.top&&(n=r.x,i=r.y,o=r.x+e.width,c=r.y,a.right&&(o+=.5*a.right),a.left&&(n-=.5*a.left),u(a.top,n,i,o,c)),a.bottom&&(n=r.x,i=r.y+e.height,o=r.x+e.width,c=r.y+e.height,a.right&&(o+=.5*a.right),a.left&&(n-=.5*a.left),u(a.bottom,n,i,o,c)),a.left&&(n=r.x,i=r.y,o=r.x,c=r.y+e.height,a.top&&(i-=.5*a.top),a.bottom&&(c+=.5*a.bottom),u(a.left,n,i,o,c)),a.right&&(n=r.x+e.width,i=r.y,o=r.x+e.width,c=r.y+e.height,a.top&&(i-=.5*a.top),a.bottom&&(c+=.5*a.bottom),u(a.right,n,i,o,c));function u(h,d,v,y,g){t.getDocument().setLineWidth(h),t.getDocument().line(d,v,y,g,"S")}}function UE(t,e,r,a){var n=e.settings.margin.bottom,i=e.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&r)&&(n+=e.getFootHeight(e.columns)),t.pageSize().height-a.y-n}function Z0(t,e,r,a,n,i){n===void 0&&(n=[]),i===void 0&&(i=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!i&&e.foot.forEach(function(c){return sc(t,e,c,a,n)}),e.callEndPageHooks(t,a);var o=e.settings.margin;RE(t,e,r,a),qE(t),e.pageNumber++,a.x=o.left,a.y=o.top,r.y=o.top,e.callWillDrawPageHooks(t,a),e.settings.showHead==="everyPage"&&(e.head.forEach(function(c){return sc(t,e,c,a,n)}),t.applyStyles(t.userStyles))}function qE(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function _U(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var a=e[0],n=HB(this,a),i=iU(this,n);return hU(this,i),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,a,n){CE(e,r,a,n,this)},t.API.autoTableSetDefaults=function(e){return Dh.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){Dh.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var a;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=new Dh(this),i=ME(n,e,window,r,!1),o=i.head,c=i.body,u=((a=o[0])===null||a===void 0?void 0:a.map(function(h){return h.content}))||[];return{columns:u,rows:c,data:c}}}var rv;try{if(typeof window<"u"&&window){var _b=window,wb=_b.jsPDF||((rv=_b.jspdf)===null||rv===void 0?void 0:rv.jsPDF);wb&&_U(wb)}}catch(t){console.error("Could not apply autoTable plugin",t)}function zE({project:t,onShowToast:e}){const[r,a]=ke.useState([]),[n,i]=ke.useState(!0),[o,c]=ke.useState("all"),[u,h]=ke.useState(null);ke.useEffect(()=>{d()},[t.id]);const d=async()=>{try{const H=await jt.getTMTickets(t.id);a(H)}catch(H){console.error("Error loading tickets:",H),e("Error loading T&M tickets","error")}finally{i(!1)}},v=async(H,z)=>{try{await jt.updateTMTicketStatus(H,z),a(r.map(F=>F.id===H?{...F,status:z}:F)),e(`Ticket ${z}`,"success")}catch(F){console.error("Error updating status:",F),e("Error updating status","error")}},y=async H=>{if(confirm("Delete this T&M ticket?"))try{await jt.deleteTMTicket(H),a(r.filter(z=>z.id!==H)),e("Ticket deleted","success")}catch(z){console.error("Error deleting ticket:",z),e("Error deleting ticket","error")}},g=H=>{let z=0;return H.t_and_m_items&&H.t_and_m_items.forEach(F=>{F.materials_equipment?.cost_per_unit&&(z+=F.quantity*F.materials_equipment.cost_per_unit)}),z},b=H=>H.t_and_m_workers?H.t_and_m_workers.reduce((z,F)=>z+parseFloat(F.hours),0):0,w=H=>new Date(H).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),E=()=>{const H=o==="all"?r:r.filter(L=>L.status===o);if(H.length===0){e("No tickets to export","error");return}const z=[],F=[],W=[];H.forEach(L=>{const ee=w(L.work_date),oe=L.status;L.t_and_m_workers&&L.t_and_m_workers.forEach(ge=>{z.push({Date:ee,Status:oe,"Worker Name":ge.name,Hours:ge.hours})}),L.t_and_m_items&&L.t_and_m_items.forEach(ge=>{const ie=ge.custom_name||ge.materials_equipment?.name||"Unknown",he=ge.custom_category||ge.materials_equipment?.category||"Unknown",de=ge.materials_equipment?.unit||"each",Z=ge.materials_equipment?.cost_per_unit||0,Ne=ge.quantity*Z;F.push({Date:ee,Status:oe,Category:he,Item:ie,Quantity:ge.quantity,Unit:de,"Cost/Unit":Z,Total:Ne})}),W.push({Date:ee,Status:oe,Workers:L.t_and_m_workers?.length||0,"Total Hours":b(L),Items:L.t_and_m_items?.length||0,"Materials Cost":g(L),Notes:L.notes||""})});const D=$c.book_new(),Y=$c.json_to_sheet(W);if($c.book_append_sheet(D,Y,"Summary"),z.length>0){const L=$c.json_to_sheet(z);$c.book_append_sheet(D,L,"Workers")}if(F.length>0){const L=$c.json_to_sheet(F);$c.book_append_sheet(D,L,"Materials & Equipment")}const I=`${t.name}_TM_${new Date().toISOString().split("T")[0]}.xlsx`;L9(D,I),e("Export downloaded!","success")},A=async()=>{const H=o==="all"?r:r.filter(L=>L.status===o);if(H.length===0){e("No tickets to export","error");return}let z="Company Name";try{const L=await jt.getCompany(t.company_id);L&&(z=L.name)}catch(L){console.error("Error fetching company:",L)}const F=new Jt,W=F.internal.pageSize.width;let D=20;F.setFontSize(20),F.setFont("helvetica","bold"),F.text(z,W/2,D,{align:"center"}),D+=10,F.setFontSize(16),F.setFont("helvetica","normal"),F.text("Time & Materials Report",W/2,D,{align:"center"}),D+=8,F.setFontSize(12),F.text(`Project: ${t.name}`,W/2,D,{align:"center"}),D+=6,t.job_number&&(F.setFontSize(10),F.text(`Job #: ${t.job_number}`,W/2,D,{align:"center"}),D+=6),F.setFontSize(9),F.setTextColor(100),F.text(`Generated: ${w(new Date().toISOString())}`,W/2,D,{align:"center"}),D+=10,F.setTextColor(0),F.setDrawColor(200),F.line(14,D,W-14,D),D+=8,F.setFontSize(11),F.setFont("helvetica","bold"),F.text(`Total Tickets: ${H.length}`,14,D),F.text(`Total Hours: ${T.toFixed(1)}`,W/2,D,{align:"center"}),F.text(`Materials Cost: $${R.toFixed(2)}`,W-14,D,{align:"right"}),D+=10,H.forEach((L,ee)=>{D>250&&(F.addPage(),D=20),F.setFillColor(240,240,245),F.rect(14,D-4,W-28,8,"F"),F.setFontSize(11),F.setFont("helvetica","bold"),F.text(`${w(L.work_date)}`,16,D),F.setFont("helvetica","normal"),F.setFontSize(9);const oe=L.status.toUpperCase(),ge=L.status==="approved"?[34,197,94]:L.status==="billed"?[59,130,246]:L.status==="rejected"?[239,68,68]:[245,158,11];if(F.setTextColor(...ge),F.text(oe,W-16,D,{align:"right"}),F.setTextColor(0),D+=10,L.t_and_m_workers&&L.t_and_m_workers.length>0){F.setFontSize(10),F.setFont("helvetica","bold"),F.text("Labor:",16,D),D+=2;const ie=L.t_and_m_workers.map(he=>[he.name,he.role||"Laborer",`${he.hours} hrs`]);F.autoTable({startY:D,head:[["Worker","Role","Hours"]],body:ie,margin:{left:18,right:18},theme:"plain",styles:{fontSize:9,cellPadding:2},headStyles:{fillColor:[248,250,252],textColor:[71,85,105],fontStyle:"bold"}}),D=F.lastAutoTable.finalY+6}if(L.t_and_m_items&&L.t_and_m_items.length>0){D>220&&(F.addPage(),D=20),F.setFontSize(10),F.setFont("helvetica","bold"),F.text("Materials & Equipment:",16,D),D+=2;const ie=L.t_and_m_items.map(he=>{const de=he.custom_name||he.materials_equipment?.name||"Unknown",Z=he.materials_equipment?.unit||"each",Ne=he.materials_equipment?.cost_per_unit||0,Q=he.quantity*Ne;return[de,`${he.quantity} ${Z}`,Ne>0?`$${Ne.toFixed(2)}`:"-",Ne>0?`$${Q.toFixed(2)}`:"-"]});F.autoTable({startY:D,head:[["Item","Quantity","Unit Cost","Total"]],body:ie,margin:{left:18,right:18},theme:"plain",styles:{fontSize:9,cellPadding:2},headStyles:{fillColor:[248,250,252],textColor:[71,85,105],fontStyle:"bold"}}),D=F.lastAutoTable.finalY+6}L.notes&&(D>250&&(F.addPage(),D=20),F.setFontSize(9),F.setFont("helvetica","italic"),F.setTextColor(100),F.text(`Notes: ${L.notes}`,18,D,{maxWidth:W-36}),F.setTextColor(0),D+=10),D+=4}),D>220&&(F.addPage(),D=20),D+=10,F.setDrawColor(200),F.line(14,D,W-14,D),D+=10,F.setFontSize(11),F.setFont("helvetica","bold"),F.text("Authorized Signatures",14,D),D+=12;const Y=(W-40)/2;F.setFont("helvetica","normal"),F.setFontSize(10),F.text("Client/General Contractor:",14,D),D+=2,F.line(14,D+8,14+Y,D+8),F.setFontSize(8),F.setTextColor(150),F.text("Signature",14,D+12),F.text("Date: ________________",14+Y-50,D+12),F.setTextColor(0),F.setFontSize(10),F.text(`${z} Representative:`,W/2+3,D),F.line(W/2+3,D+8,W-14,D+8),F.setFontSize(8),F.setTextColor(150),F.text("Signature",W/2+3,D+12),F.text("Date: ________________",W-14-50,D+12,{align:"left"}),F.setTextColor(0);const I=`${t.name}_TM_${new Date().toISOString().split("T")[0]}.pdf`;F.save(I),e("PDF exported successfully!","success")},O=o==="all"?r:r.filter(H=>H.status===o),T=O.reduce((H,z)=>H+b(z),0),R=O.reduce((H,z)=>H+g(z),0);return n?p.jsx("div",{className:"loading",children:"Loading T&M tickets..."}):p.jsxs("div",{className:"tm-list",children:[p.jsxs("div",{className:"tm-list-header",children:[p.jsxs("div",{className:"tm-list-title",children:[p.jsx("h3",{children:"T&M Tickets"}),p.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[p.jsx("button",{className:"btn btn-secondary btn-small",onClick:A,children:" Export PDF"}),p.jsx("button",{className:"btn btn-secondary btn-small",onClick:E,children:" Export Excel"})]})]}),p.jsx("div",{className:"tm-filter-tabs",children:["all","pending","approved","billed","rejected"].map(H=>p.jsxs("button",{className:`tm-filter-tab ${o===H?"active":""}`,onClick:()=>c(H),children:[H.charAt(0).toUpperCase()+H.slice(1),p.jsx("span",{className:"tm-filter-count",children:H==="all"?r.length:r.filter(z=>z.status===H).length})]},H))})]}),O.length>0&&p.jsxs("div",{className:"tm-summary-bar",children:[p.jsxs("div",{className:"tm-summary-stat",children:[p.jsx("span",{className:"tm-summary-label",children:"Tickets"}),p.jsx("span",{className:"tm-summary-value",children:O.length})]}),p.jsxs("div",{className:"tm-summary-stat",children:[p.jsx("span",{className:"tm-summary-label",children:"Total Hours"}),p.jsx("span",{className:"tm-summary-value",children:T.toFixed(1)})]}),p.jsxs("div",{className:"tm-summary-stat",children:[p.jsx("span",{className:"tm-summary-label",children:"Materials Cost"}),p.jsxs("span",{className:"tm-summary-value",children:["$",R.toFixed(2)]})]})]}),O.length===0?p.jsx("div",{className:"tm-empty-state",children:p.jsxs("p",{children:["No ",o==="all"?"":o," T&M tickets"]})}):p.jsx("div",{className:"tm-tickets",children:O.map(H=>p.jsxs("div",{className:`tm-ticket-card ${H.status}`,children:[p.jsxs("div",{className:"tm-ticket-header",onClick:()=>h(u===H.id?null:H.id),children:[p.jsxs("div",{className:"tm-ticket-info",children:[p.jsx("span",{className:"tm-ticket-date",children:w(H.work_date)}),p.jsx("span",{className:`tm-ticket-status ${H.status}`,children:H.status})]}),p.jsxs("div",{className:"tm-ticket-summary",children:[p.jsxs("span",{className:"tm-ticket-hours",children:[b(H)," hrs"]}),p.jsxs("span",{className:"tm-ticket-total",children:["$",g(H).toFixed(2)]}),p.jsx("span",{className:"tm-expand-arrow",children:u===H.id?"":""})]})]}),u===H.id&&p.jsxs("div",{className:"tm-ticket-details",children:[H.t_and_m_workers?.length>0&&p.jsxs("div",{className:"tm-detail-section",children:[p.jsx("h4",{children:" Workers"}),p.jsx("div",{className:"tm-detail-list",children:H.t_and_m_workers.map(z=>p.jsxs("div",{className:"tm-detail-row",children:[p.jsxs("span",{children:[z.role&&z.role!=="Laborer"&&p.jsx("span",{className:"tm-role-badge",children:z.role}),z.name]}),p.jsxs("span",{children:[z.hours," hrs"]})]},z.id))})]}),H.t_and_m_items?.length>0&&p.jsxs("div",{className:"tm-detail-section",children:[p.jsx("h4",{children:" Materials & Equipment"}),p.jsx("div",{className:"tm-detail-list",children:H.t_and_m_items.map(z=>p.jsxs("div",{className:"tm-detail-row",children:[p.jsx("span",{children:z.custom_name?p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"tm-custom-badge",children:"Custom"})," ",z.custom_name]}):z.materials_equipment?.name}),p.jsxs("span",{className:"tm-detail-qty",children:[z.quantity," ",z.materials_equipment?.unit||"each",z.materials_equipment?.cost_per_unit>0&&p.jsxs("span",{className:"tm-item-cost",children:["$",(z.quantity*z.materials_equipment.cost_per_unit).toFixed(2)]})]})]},z.id))})]}),H.notes&&p.jsxs("div",{className:"tm-detail-section",children:[p.jsx("h4",{children:" Description"}),p.jsx("p",{className:"tm-notes-text",children:H.notes})]}),H.photos&&H.photos.length>0&&p.jsxs("div",{className:"tm-detail-section",children:[p.jsxs("h4",{children:[" Photos (",H.photos.length,")"]}),p.jsx("div",{className:"tm-photos-grid",children:H.photos.map((z,F)=>p.jsx("a",{href:z,target:"_blank",rel:"noopener noreferrer",className:"tm-photo-thumb",children:p.jsx("img",{src:z,alt:`Photo ${F+1}`})},F))})]}),p.jsxs("div",{className:"tm-ticket-actions",children:[H.status==="pending"&&p.jsxs(p.Fragment,{children:[p.jsx("button",{className:"btn btn-success btn-small",onClick:z=>{z.stopPropagation(),v(H.id,"approved")},children:" Approve"}),p.jsx("button",{className:"btn btn-warning btn-small",onClick:z=>{z.stopPropagation(),v(H.id,"rejected")},children:" Reject"})]}),H.status==="approved"&&p.jsx("button",{className:"btn btn-primary btn-small",onClick:z=>{z.stopPropagation(),v(H.id,"billed")},children:" Mark Billed"}),H.status==="rejected"&&p.jsx("button",{className:"btn btn-secondary btn-small",onClick:z=>{z.stopPropagation(),v(H.id,"pending")},children:" Restore"}),p.jsx("button",{className:"btn btn-danger btn-small",onClick:z=>{z.stopPropagation(),y(H.id)},children:" Delete"})]})]})]},H.id))})]})}function wU({project:t,onShowToast:e}){const[r,a]=ke.useState([]),[n,i]=ke.useState(!0),[o,c]=ke.useState(!1),[u,h]=ke.useState(!1),[d,v]=ke.useState({name:"",role:"Laborer"});ke.useEffect(()=>{y()},[t.id]);const y=async()=>{try{const E=await jt.getCrewCheckin(t.id);E?.workers&&a(E.workers)}catch(E){console.error("Error loading crew:",E)}finally{i(!1)}},g=async()=>{if(!d.name.trim()){e("Enter worker name","error");return}if(r.find(E=>E.name.toLowerCase()===d.name.trim().toLowerCase())){e("Worker already added","error");return}c(!0);try{const E=[...r,{name:d.name.trim(),role:d.role}];await jt.saveCrewCheckin(t.id,E),a(E),v({name:"",role:"Laborer"}),h(!1),e("Crew member added","success")}catch(E){console.error("Error adding worker:",E),e("Error adding crew member","error")}finally{c(!1)}},b=async E=>{c(!0);try{const A=r.filter(O=>O.name.toLowerCase()!==E.toLowerCase());await jt.saveCrewCheckin(t.id,A),a(A),e("Crew member removed","success")}catch(A){console.error("Error removing worker:",A),e("Error removing crew member","error")}finally{c(!1)}},w=new Date().toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"});return n?p.jsxs("div",{className:"crew-checkin",children:[p.jsxs("div",{className:"crew-header",children:[p.jsx("h3",{children:" Today's Crew"}),p.jsx("span",{className:"crew-date",children:w})]}),p.jsx("div",{className:"crew-loading",children:"Loading..."})]}):p.jsxs("div",{className:"crew-checkin",children:[p.jsxs("div",{className:"crew-header",children:[p.jsx("h3",{children:" Today's Crew"}),p.jsx("span",{className:"crew-date",children:w})]}),r.length===0?p.jsxs("div",{className:"crew-empty",children:[p.jsx("p",{children:"No crew checked in yet"}),p.jsx("p",{className:"crew-empty-hint",children:"Add your crew for the day"})]}):p.jsx("div",{className:"crew-list",children:r.map((E,A)=>p.jsxs("div",{className:"crew-member",children:[p.jsxs("div",{className:"crew-member-info",children:[p.jsx("span",{className:"crew-member-name",children:E.name}),p.jsx("span",{className:`crew-member-role ${E.role.toLowerCase()}`,children:E.role})]}),p.jsx("button",{className:"crew-remove-btn",onClick:()=>b(E.name),disabled:o,children:""})]},A))}),u?p.jsxs("div",{className:"crew-add-form",children:[p.jsx("input",{type:"text",value:d.name,onChange:E=>v({...d,name:E.target.value}),placeholder:"Name",autoFocus:!0}),p.jsxs("select",{value:d.role,onChange:E=>v({...d,role:E.target.value}),children:[p.jsx("option",{value:"Foreman",children:"Foreman"}),p.jsx("option",{value:"Laborer",children:"Laborer"}),p.jsx("option",{value:"Supervisor",children:"Supervisor"}),p.jsx("option",{value:"Operator",children:"Operator"})]}),p.jsxs("div",{className:"crew-add-buttons",children:[p.jsx("button",{className:"crew-add-confirm",onClick:g,disabled:o,children:o?"...":"Add"}),p.jsx("button",{className:"crew-add-cancel",onClick:()=>{h(!1),v({name:"",role:"Laborer"})},children:"Cancel"})]})]}):p.jsx("button",{className:"crew-add-btn",onClick:()=>h(!0),children:"+ Add Crew Member"}),p.jsxs("div",{className:"crew-count",children:[r.length," ",r.length===1?"person":"people"," on site"]})]})}function bU({project:t,onShowToast:e,onClose:r}){const[a,n]=ke.useState(!0),[i,o]=ke.useState(!1),[c,u]=ke.useState(null),[h,d]=ke.useState(""),[v,y]=ke.useState("");ke.useEffect(()=>{g()},[t.id]);const g=async()=>{try{const A=await jt.getDailyReport(t.id);if(A)u(A),d(A.field_notes||""),y(A.issues||"");else{const O=await jt.compileDailyReport(t.id);u({...O,status:"draft"})}}catch(A){console.error("Error loading report:",A),e("Error loading report","error")}finally{n(!1)}},b=async()=>{o(!0);try{await jt.saveDailyReport(t.id,{field_notes:h,issues:v}),await jt.submitDailyReport(t.id,"Field"),e("Daily report submitted!","success"),r()}catch(A){console.error("Error submitting report:",A),e("Error submitting report","error")}finally{o(!1)}},w=new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"});if(a)return p.jsxs("div",{className:"daily-report",children:[p.jsxs("div",{className:"daily-report-header",children:[p.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),p.jsx("h2",{children:"Daily Report"})]}),p.jsx("div",{className:"daily-report-loading",children:"Compiling report..."})]});const E=c?.status==="submitted";return p.jsxs("div",{className:"daily-report",children:[p.jsxs("div",{className:"daily-report-header",children:[p.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),p.jsxs("div",{children:[p.jsx("h2",{children:"Daily Report"}),p.jsx("p",{className:"daily-report-date",children:w})]})]}),E&&p.jsxs("div",{className:"daily-report-submitted-banner",children:[" Submitted ",new Date(c.submitted_at).toLocaleTimeString()]}),p.jsxs("div",{className:"daily-report-content",children:[p.jsxs("div",{className:"daily-report-summary",children:[p.jsxs("div",{className:"daily-report-card",children:[p.jsx("div",{className:"daily-report-card-value",children:c.crew_count||0}),p.jsx("div",{className:"daily-report-card-label",children:"Crew on Site"})]}),p.jsxs("div",{className:"daily-report-card",children:[p.jsx("div",{className:"daily-report-card-value",children:c.tasks_completed||0}),p.jsx("div",{className:"daily-report-card-label",children:"Tasks Done"})]}),p.jsxs("div",{className:"daily-report-card",children:[p.jsx("div",{className:"daily-report-card-value",children:c.tm_tickets_count||0}),p.jsx("div",{className:"daily-report-card-label",children:"T&M Tickets"})]}),p.jsxs("div",{className:"daily-report-card",children:[p.jsx("div",{className:"daily-report-card-value",children:c.photos_count||0}),p.jsx("div",{className:"daily-report-card-label",children:"Photos"})]})]}),c.crew_list?.length>0&&p.jsxs("div",{className:"daily-report-section",children:[p.jsx("h3",{children:" Crew"}),p.jsx("div",{className:"daily-report-crew",children:c.crew_list.map((A,O)=>p.jsxs("div",{className:"daily-report-crew-item",children:[p.jsx("span",{children:A.name}),p.jsx("span",{className:"daily-report-crew-role",children:A.role})]},O))})]}),c.completed_tasks?.length>0&&p.jsxs("div",{className:"daily-report-section",children:[p.jsx("h3",{children:" Completed Today"}),p.jsx("ul",{className:"daily-report-tasks",children:c.completed_tasks.map((A,O)=>p.jsxs("li",{children:[A.name,A.group&&p.jsx("span",{className:"daily-report-task-group",children:A.group})]},O))})]}),p.jsxs("div",{className:"daily-report-section",children:[p.jsx("h3",{children:" Notes"}),p.jsx("textarea",{value:h,onChange:A=>d(A.target.value),placeholder:"Any notes about today's work...",rows:3,disabled:E})]}),p.jsxs("div",{className:"daily-report-section",children:[p.jsx("h3",{children:" Issues / Concerns"}),p.jsx("textarea",{value:v,onChange:A=>y(A.target.value),placeholder:"Any problems, delays, or concerns...",rows:3,disabled:E})]})]}),!E&&p.jsxs("div",{className:"daily-report-footer",children:[p.jsx("button",{className:"btn btn-primary daily-report-submit",onClick:b,disabled:i,children:i?"Submitting...":" Submit Report"}),p.jsx("p",{className:"daily-report-hint",children:"This will be sent to the office"})]})]})}function HE({project:t,viewerType:e,viewerName:r,onShowToast:a,onClose:n}){const[i,o]=ke.useState([]),[c,u]=ke.useState(!0),[h,d]=ke.useState(!1),[v,y]=ke.useState(""),g=ke.useRef(null);ke.useEffect(()=>{b(),jt.markMessagesRead(t.id,e)},[t.id]),ke.useEffect(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[i]);const b=async()=>{try{const O=await jt.getMessages(t.id);o(O.reverse())}catch(O){console.error("Error loading messages:",O)}finally{u(!1)}},w=async()=>{if(v.trim()){d(!0);try{const O=await jt.sendMessage(t.id,v.trim(),e,r);o([...i,O]),y("")}catch(O){console.error("Error sending message:",O),a("Error sending message","error")}finally{d(!1)}}},E=O=>{O.key==="Enter"&&!O.shiftKey&&(O.preventDefault(),w())},A=O=>{const T=new Date(O),R=new Date;return T.toDateString()===R.toDateString()?T.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):T.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})};return p.jsxs("div",{className:"messages-container",children:[p.jsxs("div",{className:"messages-header",children:[p.jsx("button",{className:"back-btn-simple",onClick:n,children:""}),p.jsxs("div",{children:[p.jsx("h2",{children:"Messages"}),p.jsx("p",{className:"messages-project",children:t.name})]})]}),p.jsxs("div",{className:"messages-list",children:[c?p.jsx("div",{className:"messages-loading",children:"Loading..."}):i.length===0?p.jsxs("div",{className:"messages-empty",children:[p.jsx("p",{children:"No messages yet"}),p.jsx("p",{className:"messages-empty-hint",children:e==="field"?"Messages from the office will appear here":"Send a message to the field crew"})]}):i.map(O=>p.jsx("div",{className:`message ${O.sender_type===e?"sent":"received"}`,children:p.jsxs("div",{className:"message-bubble",children:[p.jsxs("div",{className:"message-sender",children:[O.sender_type==="office"?"":""," ",O.sender_name]}),p.jsx("div",{className:"message-text",children:O.message}),O.photo_url&&p.jsx("img",{src:O.photo_url,alt:"Attached",className:"message-photo"}),p.jsx("div",{className:"message-time",children:A(O.created_at)})]})},O.id)),p.jsx("div",{ref:g})]}),p.jsxs("div",{className:"messages-input-container",children:[p.jsx("textarea",{value:v,onChange:O=>y(O.target.value),onKeyDown:E,placeholder:"Type a message...",rows:1,disabled:h}),p.jsx("button",{className:"messages-send-btn",onClick:w,disabled:h||!v.trim(),children:h?"...":""})]})]})}function SU({project:t,requestedBy:e,onShowToast:r,onClose:a}){const[n,i]=ke.useState([{name:"",quantity:"",unit:"each"}]),[o,c]=ke.useState(""),[u,h]=ke.useState("normal"),[d,v]=ke.useState(""),[y,g]=ke.useState(!1),b=()=>{i([...n,{name:"",quantity:"",unit:"each"}])},w=(O,T,R)=>{i(n.map((H,z)=>z===O?{...H,[T]:R}:H))},E=O=>{n.length>1&&i(n.filter((T,R)=>R!==O))},A=async()=>{const O=n.filter(T=>T.name.trim()&&T.quantity);if(O.length===0){r("Add at least one item","error");return}g(!0);try{await jt.createMaterialRequest(t.id,O,e,o||null,u,d||null),r("Request submitted!","success"),a()}catch(T){console.error("Error submitting request:",T),r("Error submitting request","error")}finally{g(!1)}};return p.jsxs("div",{className:"material-request",children:[p.jsxs("div",{className:"material-request-header",children:[p.jsx("button",{className:"back-btn-simple",onClick:a,children:""}),p.jsx("h2",{children:"Request Materials"})]}),p.jsxs("div",{className:"material-request-content",children:[p.jsxs("div",{className:"material-request-section",children:[p.jsx("label",{children:"What do you need?"}),n.map((O,T)=>p.jsxs("div",{className:"material-request-item",children:[p.jsx("input",{type:"text",placeholder:"Item name",value:O.name,onChange:R=>w(T,"name",R.target.value),className:"material-request-name"}),p.jsx("input",{type:"number",placeholder:"Qty",value:O.quantity,onChange:R=>w(T,"quantity",R.target.value),className:"material-request-qty"}),p.jsxs("select",{value:O.unit,onChange:R=>w(T,"unit",R.target.value),className:"material-request-unit",children:[p.jsx("option",{value:"each",children:"each"}),p.jsx("option",{value:"rolls",children:"rolls"}),p.jsx("option",{value:"boxes",children:"boxes"}),p.jsx("option",{value:"bags",children:"bags"}),p.jsx("option",{value:"sheets",children:"sheets"}),p.jsx("option",{value:"gallons",children:"gal"}),p.jsx("option",{value:"feet",children:"ft"}),p.jsx("option",{value:"lbs",children:"lbs"})]}),p.jsx("button",{className:"material-request-remove",onClick:()=>E(T),children:""})]},T)),p.jsx("button",{className:"material-request-add",onClick:b,children:"+ Add Another Item"})]}),p.jsxs("div",{className:"material-request-section",children:[p.jsx("label",{children:"Priority"}),p.jsx("div",{className:"material-request-priority",children:["low","normal","urgent"].map(O=>p.jsxs("button",{className:`priority-btn ${u===O?"active":""} ${O}`,onClick:()=>h(O),children:[O==="urgent"&&" ",O==="normal"&&" ",O==="low"&&" ",O.charAt(0).toUpperCase()+O.slice(1)]},O))})]}),p.jsxs("div",{className:"material-request-section",children:[p.jsx("label",{children:"Needed By (optional)"}),p.jsx("input",{type:"date",value:o,onChange:O=>c(O.target.value),min:new Date().toISOString().split("T")[0]})]}),p.jsxs("div",{className:"material-request-section",children:[p.jsx("label",{children:"Notes (optional)"}),p.jsx("textarea",{value:d,onChange:O=>v(O.target.value),placeholder:"Any additional details...",rows:2})]})]}),p.jsx("div",{className:"material-request-footer",children:p.jsx("button",{className:"btn btn-primary",onClick:A,disabled:y,children:y?"Submitting...":" Submit Request"})})]})}function EU({project:t,companyId:e,onShowToast:r,onExit:a}){const[n,i]=ke.useState([]),[o,c]=ke.useState(!0),[u,h]=ke.useState(null),[d,v]=ke.useState({}),[y,g]=ke.useState(!1),[b,w]=ke.useState(!1),[E,A]=ke.useState(!0),[O,T]=ke.useState(!1),[R,H]=ke.useState(!1),[z,F]=ke.useState(!1),[W,D]=ke.useState(0);ke.useEffect(()=>{Y(),I()},[t.id]);const Y=async()=>{try{const de=await jt.getAreas(t.id);i(de);const Z=[...new Set(de.map(Q=>Q.group_name||"General"))],Ne={};Z.forEach(Q=>Ne[Q]=!1),v(Ne)}catch(de){console.error("Error loading areas:",de),r("Error loading areas","error")}finally{c(!1)}},I=async()=>{const de=await jt.getUnreadCount(t.id,"field");D(de)},L=async(de,Z)=>{const Ne=n.find(N=>N.id===de);if(!Ne)return;const Q=Ne.status===Z?"not_started":Z;h(de);try{await jt.updateAreaStatus(de,Q),i(N=>N.map(M=>M.id===de?{...M,status:Q}:M)),r("Updated","success")}catch(N){console.error("Error updating status:",N),r("Error updating","error")}finally{h(null)}},ee=de=>{v(Z=>({...Z,[de]:!Z[de]}))};if(o)return p.jsx("div",{className:"foreman-container",children:p.jsxs("div",{className:"loading",children:[p.jsx("div",{className:"spinner"}),"Loading..."]})});if(y)return p.jsx("div",{className:"foreman-container",children:p.jsx(HN,{project:t,companyId:e,onSubmit:()=>g(!1),onCancel:()=>g(!1),onShowToast:r})});if(O)return p.jsx(bU,{project:t,onShowToast:r,onClose:()=>T(!1)});if(R)return p.jsx(HE,{project:t,viewerType:"field",viewerName:"Field",onShowToast:r,onClose:()=>{H(!1),I()}});if(z)return p.jsx(SU,{project:t,requestedBy:"Field",onShowToast:r,onClose:()=>F(!1)});if(b)return p.jsxs("div",{className:"foreman-container",children:[p.jsxs("div",{className:"foreman-header",children:[p.jsx("button",{className:"back-btn",onClick:()=>w(!1),children:" Back"}),p.jsx("h2",{children:"T&M Tickets"})]}),p.jsx(zE,{project:t,onShowToast:r})]});const oe=j4(n),ge=n.reduce((de,Z)=>{const Ne=Z.group_name||"General";return de[Ne]||(de[Ne]=[]),de[Ne].push(Z),de},{}),ie=Object.keys(ge).length>1||Object.keys(ge).length===1&&!ge.General,he=de=>`${de.filter(Ne=>Ne.status==="done").length}/${de.length}`;return p.jsxs("div",{className:"foreman-container",children:[p.jsxs("div",{className:"foreman-header",children:[p.jsx("button",{className:"back-btn-simple",onClick:a,children:""}),p.jsxs("div",{className:"foreman-header-info",children:[p.jsx("div",{className:"foreman-project-name",children:t.name}),p.jsxs("div",{className:"foreman-progress",children:[oe,"% Complete"]})]})]}),p.jsxs("div",{className:"field-actions",children:[p.jsxs("button",{className:"field-action-btn",onClick:()=>g(!0),children:[p.jsx("span",{className:"icon",children:""}),"T&M Ticket"]}),p.jsxs("button",{className:"field-action-btn",onClick:()=>w(!0),children:[p.jsx("span",{className:"icon",children:""}),"View T&M"]}),p.jsxs("button",{className:"field-action-btn",onClick:()=>H(!0),children:[p.jsx("span",{className:"icon",children:""}),"Messages",W>0&&p.jsx("span",{className:"badge",children:W})]}),p.jsxs("button",{className:"field-action-btn",onClick:()=>F(!0),children:[p.jsx("span",{className:"icon",children:""}),"Need Materials"]}),p.jsxs("button",{className:"field-action-btn",onClick:()=>T(!0),children:[p.jsx("span",{className:"icon",children:""}),"Daily Report"]})]}),p.jsx(wU,{project:t,onShowToast:r}),p.jsx("div",{className:"foreman-areas",children:ie?Object.entries(ge).map(([de,Z])=>p.jsxs("div",{className:"foreman-group",children:[p.jsxs("div",{className:"foreman-group-header",onClick:()=>ee(de),children:[p.jsxs("div",{className:"foreman-group-title",children:[p.jsx("span",{className:"foreman-group-arrow",children:d[de]?"":""}),p.jsx("span",{className:"foreman-group-name",children:de})]}),p.jsx("span",{className:"foreman-group-progress",children:he(Z)})]}),d[de]&&p.jsx("div",{className:"foreman-group-tasks",children:Z.map(Ne=>p.jsxs("div",{className:`foreman-area-card ${Ne.status}`,children:[p.jsx("div",{className:"foreman-area-name",children:Ne.name}),p.jsxs("div",{className:"foreman-area-buttons",children:[p.jsx("button",{className:`foreman-btn working ${Ne.status==="working"?"active":""}`,onClick:()=>L(Ne.id,"working"),disabled:u===Ne.id,children:u===Ne.id?"...":"Working"}),p.jsx("button",{className:`foreman-btn done ${Ne.status==="done"?"active":""}`,onClick:()=>L(Ne.id,"done"),disabled:u===Ne.id,children:u===Ne.id?"...":"Done"})]})]},Ne.id))})]},de)):n.map(de=>p.jsxs("div",{className:`foreman-area-card ${de.status}`,children:[p.jsx("div",{className:"foreman-area-name",children:de.name}),p.jsxs("div",{className:"foreman-area-buttons",children:[p.jsx("button",{className:`foreman-btn working ${de.status==="working"?"active":""}`,onClick:()=>L(de.id,"working"),disabled:u===de.id,children:u===de.id?"...":"Working"}),p.jsx("button",{className:`foreman-btn done ${de.status==="done"?"active":""}`,onClick:()=>L(de.id,"done"),disabled:u===de.id,children:u===de.id?"...":"Done"})]})]},de.id))}),n.length===0&&p.jsxs("div",{className:"foreman-empty",children:[p.jsx("div",{className:"foreman-empty-icon",children:""}),p.jsx("div",{className:"foreman-empty-text",children:"No areas yet"}),p.jsx("div",{className:"foreman-empty-subtext",children:"Office needs to add areas to this project"})]})]})}const kU=ke.createContext({}),WE=()=>ke.useContext(kU);function Yu({message:t,type:e="",onClose:r}){return ke.useEffect(()=>{const a=setTimeout(r,3e3);return()=>clearTimeout(a)},[r]),p.jsx("div",{className:"toast-container",children:p.jsx("div",{className:`toast ${e}`,children:t})})}function AU({project:t,onClose:e,onShareCreated:r}){const{user:a}=WE(),[n,i]=ke.useState(!1),[o,c]=ke.useState(null),[u,h]=ke.useState([]),[d,v]=ke.useState(!1),[y,g]=ke.useState({progress:!0,photos:!0,daily_reports:!0,tm_tickets:!1,crew_info:!1}),[b,w]=ke.useState("never"),[E,A]=ke.useState("");ke.useEffect(()=>{O()},[t.id]);const O=async()=>{try{const L=await jt.getProjectShares(t.id);h(L)}catch(L){console.error("Error loading shares:",L)}},T=L=>{g(ee=>({...ee,[L]:!ee[L]}))},R=()=>{if(b==="never")return null;const L=new Date;if(b==="30days")L.setDate(L.getDate()+30);else if(b==="90days")L.setDate(L.getDate()+90);else if(b==="custom"&&E)return new Date(E).toISOString();return L.toISOString()},H=async()=>{i(!0);try{const L=R(),ee=await jt.createProjectShare(t.id,a.id,y,L);c({type:"success",message:"Share link created!"}),v(!1),O(),r&&r(ee)}catch(L){console.error("Error creating share:",L),c({type:"error",message:"Failed to create share link"})}finally{i(!1)}},z=L=>{const ee=`${window.location.origin}/view/${L}`;navigator.clipboard.writeText(ee),c({type:"success",message:"Link copied to clipboard!"})},F=async L=>{if(confirm("Are you sure you want to revoke this share link?"))try{await jt.revokeProjectShare(L),c({type:"success",message:"Share link revoked"}),O()}catch(ee){console.error("Error revoking share:",ee),c({type:"error",message:"Failed to revoke share link"})}},W=async L=>{if(confirm("Are you sure you want to permanently delete this share link?"))try{await jt.deleteProjectShare(L),c({type:"success",message:"Share link deleted"}),O()}catch(ee){console.error("Error deleting share:",ee),c({type:"error",message:"Failed to delete share link"})}},D=L=>L?new Date(L).toLocaleDateString():"Never",Y=L=>L?new Date(L)<new Date:!1,I=L=>{const ee=[];return L.progress&&ee.push("Progress"),L.photos&&ee.push("Photos"),L.daily_reports&&ee.push("Reports"),L.tm_tickets&&ee.push("T&M"),L.crew_info&&ee.push("Crew"),ee.join(", ")};return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"modal-overlay",onClick:e,children:p.jsxs("div",{className:"modal-content share-modal",onClick:L=>L.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsxs("h2",{children:["Share Project: ",t.name]}),p.jsx("button",{className:"close-btn",onClick:e,children:""})]}),p.jsxs("div",{className:"modal-body",children:[u.length>0&&p.jsxs("div",{className:"existing-shares",children:[p.jsx("h3",{children:"Active Share Links"}),p.jsx("div",{className:"shares-list",children:u.map(L=>p.jsxs("div",{className:`share-item ${!L.is_active||Y(L.expires_at)?"inactive":""}`,children:[p.jsxs("div",{className:"share-info",children:[p.jsxs("div",{className:"share-token",children:[p.jsxs("code",{children:[window.location.origin,"/view/",L.share_token]}),p.jsx("button",{className:"btn-small",onClick:()=>z(L.share_token),disabled:!L.is_active||Y(L.expires_at),children:"Copy"})]}),p.jsxs("div",{className:"share-meta",children:[p.jsx("span",{className:"permissions",children:I(L.permissions)}),p.jsxs("span",{className:"expiry",children:["Expires: ",D(L.expires_at)]}),p.jsxs("span",{className:"views",children:["Views: ",L.view_count||0,L.last_viewed_at&&` (Last: ${D(L.last_viewed_at)})`]})]}),!L.is_active&&p.jsx("div",{className:"status-badge revoked",children:"Revoked"}),Y(L.expires_at)&&L.is_active&&p.jsx("div",{className:"status-badge expired",children:"Expired"})]}),p.jsxs("div",{className:"share-actions",children:[L.is_active&&!Y(L.expires_at)&&p.jsx("button",{className:"btn-secondary",onClick:()=>F(L.id),children:"Revoke"}),p.jsx("button",{className:"btn-danger",onClick:()=>W(L.id),children:"Delete"})]})]},L.id))})]}),!d&&p.jsx("button",{className:"btn-primary",onClick:()=>v(!0),children:"+ Create New Share Link"}),d&&p.jsxs("div",{className:"new-share-form",children:[p.jsx("h3",{children:"Create New Share Link"}),p.jsxs("div",{className:"form-section",children:[p.jsx("label",{children:"Permissions"}),p.jsxs("div",{className:"checkbox-group",children:[p.jsxs("label",{children:[p.jsx("input",{type:"checkbox",checked:y.progress,onChange:()=>T("progress")}),"Progress/completion status"]}),p.jsxs("label",{children:[p.jsx("input",{type:"checkbox",checked:y.photos,onChange:()=>T("photos")}),"Photos feed"]}),p.jsxs("label",{children:[p.jsx("input",{type:"checkbox",checked:y.daily_reports,onChange:()=>T("daily_reports")}),"Daily reports"]}),p.jsxs("label",{children:[p.jsx("input",{type:"checkbox",checked:y.tm_tickets,onChange:()=>T("tm_tickets")}),"T&M tickets"]}),p.jsxs("label",{children:[p.jsx("input",{type:"checkbox",checked:y.crew_info,onChange:()=>T("crew_info")}),"Crew information"]})]})]}),p.jsxs("div",{className:"form-section",children:[p.jsx("label",{children:"Link Expiration"}),p.jsxs("div",{className:"radio-group",children:[p.jsxs("label",{children:[p.jsx("input",{type:"radio",value:"never",checked:b==="never",onChange:L=>w(L.target.value)}),"Never expires"]}),p.jsxs("label",{children:[p.jsx("input",{type:"radio",value:"30days",checked:b==="30days",onChange:L=>w(L.target.value)}),"30 days"]}),p.jsxs("label",{children:[p.jsx("input",{type:"radio",value:"90days",checked:b==="90days",onChange:L=>w(L.target.value)}),"90 days"]}),p.jsxs("label",{children:[p.jsx("input",{type:"radio",value:"custom",checked:b==="custom",onChange:L=>w(L.target.value)}),"Custom date"]})]}),b==="custom"&&p.jsx("input",{type:"date",value:E,onChange:L=>A(L.target.value),min:new Date().toISOString().split("T")[0],className:"date-input"})]}),p.jsxs("div",{className:"form-actions",children:[p.jsx("button",{className:"btn-secondary",onClick:()=>v(!1),children:"Cancel"}),p.jsx("button",{className:"btn-primary",onClick:H,disabled:n,children:n?"Generating...":"Generate Share Link"})]})]})]})]})}),o&&p.jsx(Yu,{message:o.message,type:o.type,onClose:()=>c(null)}),p.jsx("style",{children:`
        .share-modal {
          max-width: 700px;
          max-height: 80vh;
          overflow-y: auto;
        }

        .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1.5rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .modal-header h2 {
          margin: 0;
          font-size: 1.25rem;
        }

        .close-btn {
          background: none;
          border: none;
          font-size: 2rem;
          cursor: pointer;
          color: #6b7280;
          padding: 0;
          width: 2rem;
          height: 2rem;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .close-btn:hover {
          color: #111827;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .existing-shares {
          margin-bottom: 2rem;
        }

        .existing-shares h3 {
          margin-top: 0;
          margin-bottom: 1rem;
          font-size: 1.1rem;
        }

        .shares-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .share-item {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1rem;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          gap: 1rem;
        }

        .share-item.inactive {
          opacity: 0.6;
          background-color: #f9fafb;
        }

        .share-info {
          flex: 1;
        }

        .share-token {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
        }

        .share-token code {
          background-color: #f3f4f6;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.875rem;
          flex: 1;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .share-meta {
          display: flex;
          flex-wrap: wrap;
          gap: 1rem;
          font-size: 0.875rem;
          color: #6b7280;
        }

        .status-badge {
          display: inline-block;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.75rem;
          font-weight: 500;
          margin-top: 0.5rem;
        }

        .status-badge.revoked {
          background-color: #fee2e2;
          color: #991b1b;
        }

        .status-badge.expired {
          background-color: #fef3c7;
          color: #92400e;
        }

        .share-actions {
          display: flex;
          gap: 0.5rem;
          flex-shrink: 0;
        }

        .new-share-form {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1.5rem;
          background-color: #f9fafb;
        }

        .new-share-form h3 {
          margin-top: 0;
          margin-bottom: 1.5rem;
          font-size: 1.1rem;
        }

        .form-section {
          margin-bottom: 1.5rem;
        }

        .form-section label {
          display: block;
          font-weight: 500;
          margin-bottom: 0.5rem;
        }

        .checkbox-group,
        .radio-group {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .checkbox-group label,
        .radio-group label {
          font-weight: normal;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .checkbox-group input[type="checkbox"],
        .radio-group input[type="radio"] {
          margin: 0;
        }

        .date-input {
          margin-top: 0.5rem;
          padding: 0.5rem;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          width: 100%;
        }

        .form-actions {
          display: flex;
          justify-content: flex-end;
          gap: 0.5rem;
          margin-top: 1.5rem;
        }

        .btn-small {
          padding: 0.25rem 0.75rem;
          font-size: 0.875rem;
          border: 1px solid #d1d5db;
          background-color: white;
          border-radius: 4px;
          cursor: pointer;
        }

        .btn-small:hover:not(:disabled) {
          background-color: #f3f4f6;
        }

        .btn-small:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-primary,
        .btn-secondary,
        .btn-danger {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          opacity: 0.9;
        }

        .btn-primary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-secondary {
          background-color: #f3f4f6;
          color: #374151;
        }

        .btn-secondary:hover {
          background-color: #e5e7eb;
        }

        .btn-danger {
          background-color: #ef4444;
          color: white;
        }

        .btn-danger:hover {
          background-color: #dc2626;
        }
      `})]})}function NU({project:t,companyId:e,onClose:r,onReportCreated:a}){const{user:n}=WE(),[i,o]=ke.useState(!1),[c,u]=ke.useState(null),[h,d]=ke.useState(1),[v,y]=ke.useState(new Date().toISOString().split("T")[0]),[g,b]=ke.useState(new Date().toTimeString().split(" ")[0].substring(0,5)),[w,E]=ke.useState(""),[A,O]=ke.useState(""),[T,R]=ke.useState("minor"),[H,z]=ke.useState(""),[F,W]=ke.useState(""),[D,Y]=ke.useState(""),[I,L]=ke.useState(""),[ee,oe]=ke.useState(""),[ge,ie]=ke.useState(""),[he,de]=ke.useState(""),[Z,Ne]=ke.useState(n?.name||""),[Q,N]=ke.useState(""),[M,B]=ke.useState(""),[q,K]=ke.useState(n?.email||""),[se,me]=ke.useState([]),[we,Se]=ke.useState(""),[Ee,ae]=ke.useState(""),[rt,Je]=ke.useState(""),[V,Ie]=ke.useState(""),[Le,gt]=ke.useState(!1),[et,wt]=ke.useState(""),[vt,Ct]=ke.useState(""),[Et,It]=ke.useState(!1),[er,Vt]=ke.useState(""),[Oe,Ye]=ke.useState(""),[He,ct]=ke.useState(""),[mt,Ht]=ke.useState(""),[Rt,Wt]=ke.useState(!1),[nr,br]=ke.useState(!1),[Yt,Wr]=ke.useState(0),[Zt,ir]=ke.useState(0),Vr=()=>{if(!we.trim()){u({type:"error",message:"Please enter witness name"});return}const _t={name:we,phone:Ee,email:rt,testimony:V};me([...se,_t]),Se(""),ae(""),Je(""),Ie(""),u({type:"success",message:"Witness added"})},pr=_t=>{me(se.filter((Ja,Kt)=>Kt!==_t))},Dt=_t=>{switch(_t){case 1:if(!w.trim()||!A.trim())return u({type:"error",message:"Please fill in all incident details"}),!1;break;case 2:if(!F.trim()||!ge.trim())return u({type:"error",message:"Please fill in employee name and job title"}),!1;break;case 3:if(!Z.trim()||!Q.trim())return u({type:"error",message:"Please fill in supervisor name and title"}),!1;break}return!0},Tr=()=>{Dt(h)&&d(h+1)},Qn=()=>{d(h-1)},Ka=async()=>{if(Dt(h)){o(!0);try{const _t={project_id:t.id,company_id:e,incident_date:v,incident_time:g,incident_location:w,incident_description:A,injury_type:T,body_part_affected:H||null,employee_name:F,employee_phone:D||null,employee_email:I||null,employee_address:ee||null,employee_job_title:ge,employee_hire_date:he||null,medical_treatment_required:Le,medical_facility_name:et||null,medical_facility_address:vt||null,hospitalized:Et,reported_by_name:Z,reported_by_title:Q,reported_by_phone:M||null,reported_by_email:q||null,witnesses:se,immediate_actions_taken:er||null,corrective_actions_planned:Oe||null,safety_equipment_used:He||null,safety_equipment_failed:mt||null,osha_recordable:Rt,workers_comp_claim:nr,days_away_from_work:parseInt(Yt)||0,restricted_work_days:parseInt(Zt)||0,status:"reported",created_by:n?.id},Ja=await jt.createInjuryReport(_t);u({type:"success",message:"Injury report submitted successfully"}),a&&a(Ja),setTimeout(()=>{r()},1500)}catch(_t){console.error("Error submitting injury report:",_t),u({type:"error",message:"Failed to submit injury report"})}finally{o(!1)}}};return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"modal-overlay",onClick:r,children:p.jsxs("div",{className:"modal-content injury-report-modal",onClick:_t=>_t.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:"Workplace Injury/Incident Report"}),p.jsx("button",{className:"close-btn",onClick:r,children:""})]}),p.jsxs("div",{className:"progress-steps",children:[p.jsx("div",{className:`step ${h>=1?"active":""}`,children:"1. Incident"}),p.jsx("div",{className:`step ${h>=2?"active":""}`,children:"2. Employee"}),p.jsx("div",{className:`step ${h>=3?"active":""}`,children:"3. Supervisor"}),p.jsx("div",{className:`step ${h>=4?"active":""}`,children:"4. Witnesses"}),p.jsx("div",{className:`step ${h>=5?"active":""}`,children:"5. Medical & Safety"})]}),p.jsxs("div",{className:"modal-body",children:[h===1&&p.jsxs("div",{className:"form-step",children:[p.jsx("h3",{children:"Incident Details"}),p.jsxs("div",{className:"form-row",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Date of Incident *"}),p.jsx("input",{type:"date",value:v,onChange:_t=>y(_t.target.value),max:new Date().toISOString().split("T")[0]})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Time of Incident *"}),p.jsx("input",{type:"time",value:g,onChange:_t=>b(_t.target.value)})]})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Location on Site *"}),p.jsx("input",{type:"text",value:w,onChange:_t=>E(_t.target.value),placeholder:"e.g., Floor 2, near elevator shaft"})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Incident Description *"}),p.jsx("textarea",{value:A,onChange:_t=>O(_t.target.value),rows:4,placeholder:"Describe what happened in detail..."})]}),p.jsxs("div",{className:"form-row",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Injury Type *"}),p.jsxs("select",{value:T,onChange:_t=>R(_t.target.value),children:[p.jsx("option",{value:"minor",children:"Minor Injury"}),p.jsx("option",{value:"serious",children:"Serious Injury"}),p.jsx("option",{value:"critical",children:"Critical Injury"}),p.jsx("option",{value:"near_miss",children:"Near Miss (No Injury)"})]})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Body Part Affected"}),p.jsx("input",{type:"text",value:H,onChange:_t=>z(_t.target.value),placeholder:"e.g., Left hand, lower back"})]})]})]}),h===2&&p.jsxs("div",{className:"form-step",children:[p.jsx("h3",{children:"Injured Employee Information"}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Full Name *"}),p.jsx("input",{type:"text",value:F,onChange:_t=>W(_t.target.value),placeholder:"First and last name"})]}),p.jsxs("div",{className:"form-row",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Phone Number"}),p.jsx("input",{type:"tel",value:D,onChange:_t=>Y(_t.target.value),placeholder:"(555) 123-4567"})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Email Address"}),p.jsx("input",{type:"email",value:I,onChange:_t=>L(_t.target.value),placeholder:"email@example.com"})]})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Home Address"}),p.jsx("input",{type:"text",value:ee,onChange:_t=>oe(_t.target.value),placeholder:"Street address, city, state, zip"})]}),p.jsxs("div",{className:"form-row",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Job Title *"}),p.jsx("input",{type:"text",value:ge,onChange:_t=>ie(_t.target.value),placeholder:"e.g., Carpenter, Electrician"})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Hire Date"}),p.jsx("input",{type:"date",value:he,onChange:_t=>de(_t.target.value)})]})]})]}),h===3&&p.jsxs("div",{className:"form-step",children:[p.jsx("h3",{children:"Foreman/Supervisor Making Report"}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Your Name *"}),p.jsx("input",{type:"text",value:Z,onChange:_t=>Ne(_t.target.value),placeholder:"Full name"})]}),p.jsxs("div",{className:"form-row",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Your Title *"}),p.jsx("input",{type:"text",value:Q,onChange:_t=>N(_t.target.value),placeholder:"e.g., Site Foreman, Project Manager"})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Your Phone Number"}),p.jsx("input",{type:"tel",value:M,onChange:_t=>B(_t.target.value),placeholder:"(555) 123-4567"})]})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Your Email Address"}),p.jsx("input",{type:"email",value:q,onChange:_t=>K(_t.target.value),placeholder:"email@example.com"})]})]}),h===4&&p.jsxs("div",{className:"form-step",children:[p.jsx("h3",{children:"Witness Testimonies (Optional)"}),se.length>0&&p.jsx("div",{className:"witnesses-list",children:se.map((_t,Ja)=>p.jsxs("div",{className:"witness-item",children:[p.jsxs("div",{className:"witness-info",children:[p.jsx("strong",{children:_t.name}),_t.phone&&p.jsxs("span",{children:["  ",_t.phone]}),_t.testimony&&p.jsxs("p",{className:"witness-testimony",children:['"',_t.testimony,'"']})]}),p.jsx("button",{className:"btn-danger btn-small",onClick:()=>pr(Ja),children:"Remove"})]},Ja))}),p.jsxs("div",{className:"add-witness-form",children:[p.jsxs("div",{className:"form-row",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Witness Name"}),p.jsx("input",{type:"text",value:we,onChange:_t=>Se(_t.target.value),placeholder:"Full name"})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Phone Number"}),p.jsx("input",{type:"tel",value:Ee,onChange:_t=>ae(_t.target.value),placeholder:"(555) 123-4567"})]})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Email Address"}),p.jsx("input",{type:"email",value:rt,onChange:_t=>Je(_t.target.value),placeholder:"email@example.com"})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Witness Testimony"}),p.jsx("textarea",{value:V,onChange:_t=>Ie(_t.target.value),rows:3,placeholder:"What did the witness see or hear?"})]}),p.jsx("button",{className:"btn-secondary",onClick:Vr,children:"+ Add Witness"})]})]}),h===5&&p.jsxs("div",{className:"form-step",children:[p.jsx("h3",{children:"Medical Treatment & Safety"}),p.jsx("div",{className:"form-group checkbox-group",children:p.jsxs("label",{children:[p.jsx("input",{type:"checkbox",checked:Le,onChange:_t=>gt(_t.target.checked)}),"Medical treatment required"]})}),Le&&p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Medical Facility Name"}),p.jsx("input",{type:"text",value:et,onChange:_t=>wt(_t.target.value),placeholder:"Hospital or clinic name"})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Medical Facility Address"}),p.jsx("input",{type:"text",value:vt,onChange:_t=>Ct(_t.target.value),placeholder:"Street address"})]}),p.jsx("div",{className:"form-group checkbox-group",children:p.jsxs("label",{children:[p.jsx("input",{type:"checkbox",checked:Et,onChange:_t=>It(_t.target.checked)}),"Employee was hospitalized"]})})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Immediate Actions Taken"}),p.jsx("textarea",{value:er,onChange:_t=>Vt(_t.target.value),rows:2,placeholder:"What was done immediately after the incident?"})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Corrective Actions Planned"}),p.jsx("textarea",{value:Oe,onChange:_t=>Ye(_t.target.value),rows:2,placeholder:"What will be done to prevent this in the future?"})]}),p.jsxs("div",{className:"form-row",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Safety Equipment Used"}),p.jsx("input",{type:"text",value:He,onChange:_t=>ct(_t.target.value),placeholder:"e.g., Hard hat, gloves, harness"})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Safety Equipment Failed"}),p.jsx("input",{type:"text",value:mt,onChange:_t=>Ht(_t.target.value),placeholder:"Equipment that failed, if any"})]})]}),p.jsxs("div",{className:"form-row",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Days Away From Work"}),p.jsx("input",{type:"number",min:"0",value:Yt,onChange:_t=>Wr(_t.target.value)})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Restricted Work Days"}),p.jsx("input",{type:"number",min:"0",value:Zt,onChange:_t=>ir(_t.target.value)})]})]}),p.jsx("div",{className:"form-group checkbox-group",children:p.jsxs("label",{children:[p.jsx("input",{type:"checkbox",checked:Rt,onChange:_t=>Wt(_t.target.checked)}),"OSHA Recordable Incident"]})}),p.jsx("div",{className:"form-group checkbox-group",children:p.jsxs("label",{children:[p.jsx("input",{type:"checkbox",checked:nr,onChange:_t=>br(_t.target.checked)}),"Workers' Compensation Claim Filed"]})})]})]}),p.jsx("div",{className:"modal-footer",children:p.jsxs("div",{className:"form-actions",children:[h>1&&p.jsx("button",{className:"btn-secondary",onClick:Qn,children:" Back"}),p.jsx("button",{className:"btn-secondary",onClick:r,children:"Cancel"}),h<5?p.jsx("button",{className:"btn-primary",onClick:Tr,children:"Next "}):p.jsx("button",{className:"btn-primary",onClick:Ka,disabled:i,children:i?"Submitting...":"Submit Report"})]})})]})}),c&&p.jsx(Yu,{message:c.message,type:c.type,onClose:()=>u(null)}),p.jsx("style",{children:`
        .injury-report-modal {
          max-width: 800px;
          max-height: 90vh;
          overflow-y: auto;
        }

        .progress-steps {
          display: flex;
          justify-content: space-between;
          padding: 1rem 1.5rem;
          border-bottom: 1px solid #e5e7eb;
          background-color: #f9fafb;
          overflow-x: auto;
        }

        .progress-steps .step {
          font-size: 0.875rem;
          color: #9ca3af;
          font-weight: 500;
          white-space: nowrap;
          padding: 0.5rem;
        }

        .progress-steps .step.active {
          color: var(--primary-color, #3b82f6);
          font-weight: 600;
        }

        .form-step h3 {
          margin-top: 0;
          margin-bottom: 1.5rem;
          color: #111827;
          font-size: 1.25rem;
        }

        .form-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 500;
          color: #374151;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
          width: 100%;
          padding: 0.5rem;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          font-size: 1rem;
        }

        .form-group textarea {
          resize: vertical;
        }

        .checkbox-group label {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-weight: normal;
          cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
          width: auto;
          margin: 0;
        }

        .witnesses-list {
          margin-bottom: 1.5rem;
        }

        .witness-item {
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          padding: 1rem;
          margin-bottom: 0.5rem;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
        }

        .witness-info {
          flex: 1;
        }

        .witness-testimony {
          margin-top: 0.5rem;
          color: #6b7280;
          font-style: italic;
          font-size: 0.875rem;
        }

        .add-witness-form {
          border: 2px dashed #d1d5db;
          border-radius: 6px;
          padding: 1rem;
          background-color: #f9fafb;
        }

        .modal-footer {
          border-top: 1px solid #e5e7eb;
          padding: 1rem 1.5rem;
        }

        .form-actions {
          display: flex;
          justify-content: space-between;
          gap: 0.5rem;
        }

        .btn-primary,
        .btn-secondary,
        .btn-danger {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          opacity: 0.9;
        }

        .btn-primary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-secondary {
          background-color: #f3f4f6;
          color: #374151;
        }

        .btn-secondary:hover {
          background-color: #e5e7eb;
        }

        .btn-danger {
          background-color: #ef4444;
          color: white;
        }

        .btn-danger:hover {
          background-color: #dc2626;
        }

        .btn-small {
          padding: 0.25rem 0.75rem;
          font-size: 0.875rem;
        }

        @media (max-width: 768px) {
          .injury-report-modal {
            max-width: 100%;
            height: 100vh;
            max-height: 100vh;
            border-radius: 0;
          }

          .form-row {
            grid-template-columns: 1fr;
          }

          .progress-steps .step {
            font-size: 0.75rem;
            padding: 0.25rem;
          }
        }
      `})]})}function TU({project:t,companyId:e,onShowToast:r}){const[a,n]=ke.useState([]),[i,o]=ke.useState(null),[c,u]=ke.useState(!1),[h,d]=ke.useState(!0),[v,y]=ke.useState(null);ke.useEffect(()=>{g()},[t?.id]);const g=async()=>{d(!0);try{const z=t?await jt.getInjuryReports(t.id):await jt.getCompanyInjuryReports(e);n(z)}catch(z){console.error("Error loading injury reports:",z),y({type:"error",message:"Failed to load injury reports"})}finally{d(!1)}},b=()=>{g(),u(!1),y({type:"success",message:"Injury report created successfully"})},w=z=>{o(z)},E=()=>{o(null)},A=z=>z?new Date(z).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",O=z=>z?new Date(`2000-01-01T${z}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"",T=z=>({minor:"Minor Injury",serious:"Serious Injury",critical:"Critical Injury",near_miss:"Near Miss"})[z]||z,R=z=>({reported:"#fbbf24",under_investigation:"#3b82f6",closed:"#10b981"})[z]||"#9ca3af",H=z=>({minor:"#10b981",serious:"#f59e0b",critical:"#ef4444",near_miss:"#6b7280"})[z]||"#9ca3af";return h?p.jsxs("div",{className:"loading-container",children:[p.jsx("div",{className:"spinner"}),p.jsx("p",{children:"Loading injury reports..."})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"injury-reports-section",children:[p.jsxs("div",{className:"section-header",children:[p.jsx("h3",{children:"Injury & Incident Reports"}),p.jsx("button",{className:"btn-primary",onClick:()=>u(!0),children:"+ File Injury Report"})]}),a.length===0?p.jsxs("div",{className:"empty-state",children:[p.jsx("div",{className:"empty-state-icon",children:""}),p.jsx("h4",{children:"No Injury Reports"}),p.jsx("p",{children:'Click "File Injury Report" to document a workplace incident'})]}):p.jsx("div",{className:"reports-list",children:a.map(z=>p.jsxs("div",{className:"report-card",onClick:()=>w(z),children:[p.jsxs("div",{className:"report-header",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"report-date",children:[A(z.incident_date)," at ",O(z.incident_time)]}),p.jsx("div",{className:"employee-name",children:z.employee_name})]}),p.jsxs("div",{className:"report-badges",children:[p.jsx("span",{className:"badge",style:{backgroundColor:H(z.injury_type)},children:T(z.injury_type)}),p.jsx("span",{className:"badge",style:{backgroundColor:R(z.status)},children:z.status.replace("_"," ")})]})]}),p.jsxs("div",{className:"report-summary",children:[p.jsxs("div",{className:"summary-item",children:[p.jsx("strong",{children:"Location:"})," ",z.incident_location]}),p.jsxs("div",{className:"summary-item",children:[p.jsx("strong",{children:"Reported by:"})," ",z.reported_by_name," (",z.reported_by_title,")"]}),z.body_part_affected&&p.jsxs("div",{className:"summary-item",children:[p.jsx("strong",{children:"Body Part:"})," ",z.body_part_affected]}),z.osha_recordable&&p.jsx("div",{className:"summary-item",children:p.jsx("span",{className:"osha-badge",children:"OSHA Recordable"})})]}),p.jsxs("div",{className:"report-description",children:[z.incident_description.substring(0,150),z.incident_description.length>150&&"..."]}),p.jsx("div",{className:"report-footer",children:p.jsx("span",{children:"Click to view full details"})})]},z.id))}),i&&p.jsx("div",{className:"modal-overlay",onClick:E,children:p.jsxs("div",{className:"modal-content report-details-modal",onClick:z=>z.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:"Injury Report Details"}),p.jsx("button",{className:"close-btn",onClick:E,children:""})]}),p.jsxs("div",{className:"modal-body",children:[p.jsxs("section",{className:"details-section",children:[p.jsx("h3",{children:"Incident Information"}),p.jsxs("div",{className:"detail-grid",children:[p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Date & Time"}),p.jsxs("div",{children:[A(i.incident_date)," at ",O(i.incident_time)]})]}),p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Location"}),p.jsx("div",{children:i.incident_location})]}),p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Injury Type"}),p.jsx("div",{children:p.jsx("span",{className:"badge",style:{backgroundColor:H(i.injury_type)},children:T(i.injury_type)})})]}),i.body_part_affected&&p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Body Part Affected"}),p.jsx("div",{children:i.body_part_affected})]})]}),p.jsxs("div",{className:"detail-item full-width",children:[p.jsx("label",{children:"Description"}),p.jsx("div",{className:"description-box",children:i.incident_description})]})]}),p.jsxs("section",{className:"details-section",children:[p.jsx("h3",{children:"Injured Employee"}),p.jsxs("div",{className:"detail-grid",children:[p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Name"}),p.jsx("div",{children:i.employee_name})]}),p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Job Title"}),p.jsx("div",{children:i.employee_job_title})]}),i.employee_phone&&p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Phone"}),p.jsx("div",{children:i.employee_phone})]}),i.employee_email&&p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Email"}),p.jsx("div",{children:i.employee_email})]}),i.employee_address&&p.jsxs("div",{className:"detail-item full-width",children:[p.jsx("label",{children:"Address"}),p.jsx("div",{children:i.employee_address})]})]})]}),p.jsxs("section",{className:"details-section",children:[p.jsx("h3",{children:"Reported By"}),p.jsxs("div",{className:"detail-grid",children:[p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Name"}),p.jsx("div",{children:i.reported_by_name})]}),p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Title"}),p.jsx("div",{children:i.reported_by_title})]}),i.reported_by_phone&&p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Phone"}),p.jsx("div",{children:i.reported_by_phone})]}),i.reported_by_email&&p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Email"}),p.jsx("div",{children:i.reported_by_email})]})]})]}),i.witnesses&&i.witnesses.length>0&&p.jsxs("section",{className:"details-section",children:[p.jsx("h3",{children:"Witnesses"}),i.witnesses.map((z,F)=>p.jsxs("div",{className:"witness-card",children:[p.jsxs("div",{className:"witness-header",children:[p.jsx("strong",{children:z.name}),z.phone&&p.jsxs("span",{children:["  ",z.phone]}),z.email&&p.jsxs("span",{children:["  ",z.email]})]}),z.testimony&&p.jsx("div",{className:"witness-testimony",children:p.jsxs("em",{children:['"',z.testimony,'"']})})]},F))]}),i.medical_treatment_required&&p.jsxs("section",{className:"details-section",children:[p.jsx("h3",{children:"Medical Treatment"}),p.jsxs("div",{className:"detail-grid",children:[i.medical_facility_name&&p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Facility"}),p.jsx("div",{children:i.medical_facility_name})]}),i.medical_facility_address&&p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Address"}),p.jsx("div",{children:i.medical_facility_address})]}),p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Hospitalized"}),p.jsx("div",{children:i.hospitalized?"Yes":"No"})]})]})]}),p.jsxs("section",{className:"details-section",children:[p.jsx("h3",{children:"Actions & Safety"}),i.immediate_actions_taken&&p.jsxs("div",{className:"detail-item full-width",children:[p.jsx("label",{children:"Immediate Actions Taken"}),p.jsx("div",{className:"description-box",children:i.immediate_actions_taken})]}),i.corrective_actions_planned&&p.jsxs("div",{className:"detail-item full-width",children:[p.jsx("label",{children:"Corrective Actions Planned"}),p.jsx("div",{className:"description-box",children:i.corrective_actions_planned})]}),p.jsxs("div",{className:"detail-grid",children:[i.safety_equipment_used&&p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Safety Equipment Used"}),p.jsx("div",{children:i.safety_equipment_used})]}),i.safety_equipment_failed&&p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Safety Equipment Failed"}),p.jsx("div",{children:i.safety_equipment_failed})]})]})]}),p.jsxs("section",{className:"details-section",children:[p.jsx("h3",{children:"Regulatory & Work Impact"}),p.jsxs("div",{className:"detail-grid",children:[p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"OSHA Recordable"}),p.jsx("div",{children:i.osha_recordable?"Yes":"No"})]}),p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Workers' Comp Claim"}),p.jsx("div",{children:i.workers_comp_claim?"Yes":"No"})]}),p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Days Away From Work"}),p.jsx("div",{children:i.days_away_from_work||0})]}),p.jsxs("div",{className:"detail-item",children:[p.jsx("label",{children:"Restricted Work Days"}),p.jsx("div",{children:i.restricted_work_days||0})]})]})]}),p.jsxs("div",{className:"report-meta",children:["Filed on ",A(i.created_at)]})]})]})}),c&&p.jsx(NU,{project:t,companyId:e,onClose:()=>u(!1),onReportCreated:b}),v&&p.jsx(Yu,{message:v.message,type:v.type,onClose:()=>y(null)})]}),p.jsx("style",{children:`
        .injury-reports-section {
          margin-top: 2rem;
        }

        .section-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
        }

        .section-header h3 {
          margin: 0;
          font-size: 1.25rem;
          color: #111827;
        }

        .reports-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .report-card {
          background: white;
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1.5rem;
          cursor: pointer;
          transition: all 0.2s;
        }

        .report-card:hover {
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          border-color: var(--primary-color, #3b82f6);
        }

        .report-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 1rem;
        }

        .report-date {
          font-size: 0.875rem;
          color: #6b7280;
          margin-bottom: 0.25rem;
        }

        .employee-name {
          font-size: 1.125rem;
          font-weight: 600;
          color: #111827;
        }

        .report-badges {
          display: flex;
          gap: 0.5rem;
          flex-wrap: wrap;
        }

        .badge {
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-size: 0.75rem;
          font-weight: 500;
          color: white;
          text-transform: capitalize;
        }

        .osha-badge {
          background-color: #dc2626;
          color: white;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.75rem;
          font-weight: 600;
        }

        .report-summary {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 0.75rem;
          margin-bottom: 1rem;
          padding: 1rem;
          background-color: #f9fafb;
          border-radius: 6px;
        }

        .summary-item {
          font-size: 0.875rem;
          color: #374151;
        }

        .summary-item strong {
          color: #111827;
        }

        .report-description {
          color: #6b7280;
          line-height: 1.6;
          margin-bottom: 1rem;
        }

        .report-footer {
          text-align: right;
          font-size: 0.875rem;
          color: var(--primary-color, #3b82f6);
        }

        .report-details-modal {
          max-width: 900px;
          max-height: 90vh;
          overflow-y: auto;
        }

        .details-section {
          margin-bottom: 2rem;
          padding-bottom: 2rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .details-section:last-child {
          border-bottom: none;
        }

        .details-section h3 {
          margin-top: 0;
          margin-bottom: 1rem;
          font-size: 1.125rem;
          color: #111827;
        }

        .detail-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 1rem;
        }

        .detail-item label {
          display: block;
          font-size: 0.875rem;
          font-weight: 600;
          color: #6b7280;
          margin-bottom: 0.25rem;
        }

        .detail-item div {
          color: #111827;
        }

        .detail-item.full-width {
          grid-column: 1 / -1;
        }

        .description-box {
          background-color: #f9fafb;
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          padding: 1rem;
          white-space: pre-wrap;
          line-height: 1.6;
        }

        .witness-card {
          background-color: #f9fafb;
          border-radius: 6px;
          padding: 1rem;
          margin-bottom: 0.5rem;
        }

        .witness-header {
          margin-bottom: 0.5rem;
          color: #111827;
        }

        .witness-testimony {
          color: #6b7280;
          font-size: 0.875rem;
          padding-left: 1rem;
          border-left: 3px solid #d1d5db;
        }

        .report-meta {
          text-align: center;
          font-size: 0.875rem;
          color: #6b7280;
          padding-top: 1rem;
          border-top: 1px solid #e5e7eb;
        }

        .empty-state {
          text-align: center;
          padding: 3rem 1rem;
        }

        .empty-state-icon {
          font-size: 3rem;
          margin-bottom: 1rem;
        }

        .empty-state h4 {
          margin: 0 0 0.5rem 0;
          color: #111827;
        }

        .empty-state p {
          margin: 0;
          color: #6b7280;
        }

        .btn-primary {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover {
          opacity: 0.9;
        }

        .loading-container {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 3rem;
        }

        .spinner {
          width: 40px;
          height: 40px;
          border: 4px solid #e5e7eb;
          border-top-color: var(--primary-color, #3b82f6);
          border-radius: 50%;
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .report-header {
            flex-direction: column;
            gap: 0.5rem;
          }

          .report-summary {
            grid-template-columns: 1fr;
          }

          .detail-grid {
            grid-template-columns: 1fr;
          }

          .report-details-modal {
            max-width: 100%;
            height: 100vh;
            max-height: 100vh;
            border-radius: 0;
          }
        }
      `})]})}function jU({company:t,onShowToast:e}){const[r,a]=ke.useState("overview"),[n,i]=ke.useState(null),[o,c]=ke.useState([]),[u,h]=ke.useState(!0),[d,v]=ke.useState(!1),[y,g]=ke.useState(null),[b,w]=ke.useState(!1),[E,A]=ke.useState(!1),[O,T]=ke.useState(!1),[R,H]=ke.useState(null),[z,F]=ke.useState([]),[W,D]=ke.useState(null),[Y,I]=ke.useState([]),[L,ee]=ke.useState(!1);ke.useEffect(()=>{oe()},[t]),ke.useEffect(()=>{n&&ie(n.id)},[n]);const oe=async()=>{if(!t?.id){h(!1);return}try{h(!0);const[Ee,ae,rt,Je]=await Promise.all([jt.getDashboardMetricsWithBreakdown(t.id),jt.getProjectSummaries(t.id),jt.getNeedsAttention(t.id),jt.getRecentActivity(t.id,15)]);H(Ee),F(ae),D(rt),I(Je)}catch(Ee){console.error("Error loading dashboard:",Ee),e("Error loading dashboard data","error")}finally{h(!1)}},ge=async()=>{ee(!0),await oe(),ee(!1),e("Dashboard refreshed","success")},ie=async Ee=>{try{const ae=await jt.getAreas(Ee);c(ae)}catch(ae){console.error("Error loading areas:",ae)}},he=Ee=>{i(Ee),a("project")},de=()=>{i(null),c([]),v(!1),g(null),a("overview"),oe()},Z=()=>{g({name:n.name,contract_value:n.contract_value,pin:n.pin||"",areas:o.map(Ee=>({id:Ee.id,name:Ee.name,weight:Ee.weight,isNew:!1}))}),v(!0)},Ne=()=>{v(!1),g(null)},Q=(Ee,ae)=>{g(rt=>({...rt,[Ee]:ae}))},N=(Ee,ae,rt)=>{g(Je=>({...Je,areas:Je.areas.map((V,Ie)=>Ie===Ee?{...V,[ae]:rt}:V)}))},M=()=>{g(Ee=>({...Ee,areas:[...Ee.areas,{id:null,name:"",weight:"",isNew:!0}]}))},B=Ee=>{y.areas.length>1&&g(ae=>({...ae,areas:ae.areas.filter((rt,Je)=>Je!==Ee)}))},q=async()=>{if(!y.name.trim()){e("Please enter a project name","error");return}const Ee=parseFloat(y.contract_value);if(!Ee||Ee<=0){e("Please enter a valid contract value","error");return}if(y.pin&&y.pin.length!==4){e("PIN must be 4 digits","error");return}if(y.pin&&y.pin!==n.pin&&!await jt.isPinAvailable(y.pin,n.id)){e("This PIN is already in use","error");return}const ae=y.areas.filter(Je=>Je.name.trim()&&parseFloat(Je.weight)>0);if(ae.length===0){e("Please add at least one area","error");return}if(ae.reduce((Je,V)=>Je+parseFloat(V.weight),0)!==100){e("Area weights must total 100%","error");return}w(!0);try{await jt.updateProject(n.id,{name:y.name.trim(),contract_value:Ee,pin:y.pin||null});const Je=o.map(Le=>Le.id),V=y.areas.filter(Le=>Le.id).map(Le=>Le.id);for(const Le of Je)V.includes(Le)||await jt.deleteArea(Le);for(let Le=0;Le<ae.length;Le++){const gt=ae[Le];gt.id?await jt.updateArea(gt.id,{name:gt.name.trim(),weight:parseFloat(gt.weight),sort_order:Le}):await jt.createArea({project_id:n.id,name:gt.name.trim(),weight:parseFloat(gt.weight),status:"not_started",sort_order:Le})}const Ie=await jt.getProject(n.id);i(Ie),await ie(n.id),v(!1),g(null),e("Project updated!","success")}catch(Je){console.error("Error saving project:",Je),e("Error saving changes","error")}finally{w(!1)}},K=async()=>{if(confirm("Are you sure you want to delete this project? This cannot be undone."))try{await jt.deleteProject(n.id),e("Project deleted","success"),de()}catch(Ee){console.error("Error deleting project:",Ee),e("Error deleting project","error")}},se=async()=>{if(confirm(`Pause "${n.name}"? The project will be marked as paused.`))try{await jt.updateProjectStatus(n.id,"paused");const Ee=await jt.getProject(n.id);i(Ee),e("Project paused","success"),oe()}catch(Ee){console.error("Error pausing project:",Ee),e("Error pausing project","error")}},me=async()=>{try{await jt.updateProjectStatus(n.id,"active");const Ee=await jt.getProject(n.id);i(Ee),e("Project resumed","success"),oe()}catch(Ee){console.error("Error resuming project:",Ee),e("Error resuming project","error")}},we=async()=>{if(confirm(`Mark "${n.name}" as done? The project will be marked as completed.`))try{await jt.updateProjectStatus(n.id,"done");const Ee=await jt.getProject(n.id);i(Ee),e("Project marked as done","success"),oe()}catch(Ee){console.error("Error updating project:",Ee),e("Error updating project","error")}},Se=Ee=>{const ae=new Date(Ee),Je=new Date-ae,V=Math.floor(Je/6e4),Ie=Math.floor(Je/36e5),Le=Math.floor(Je/864e5);return V<1?"Just now":V<60?`${V}m ago`:Ie<24?`${Ie}h ago`:Le<7?`${Le}d ago`:ae.toLocaleDateString()};if(u)return p.jsxs("div",{className:"loading",children:[p.jsx("div",{className:"spinner"}),"Loading dashboard..."]});if(r==="project"&&n){const Ee=j4(o),ae=Ee/100*n.contract_value;if(d&&y){const rt=y.areas.reduce((Je,V)=>Je+(parseFloat(V.weight)||0),0);return p.jsxs("div",{children:[p.jsx("button",{className:"btn btn-secondary btn-small",onClick:Ne,style:{marginBottom:"1.5rem"},children:" Cancel"}),p.jsx("h1",{children:"Edit Project"}),p.jsx("p",{className:"subtitle",children:"Update project details"}),p.jsxs("div",{className:"card",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Project Name"}),p.jsx("input",{type:"text",value:y.name,onChange:Je=>Q("name",Je.target.value)})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Contract Value ($)"}),p.jsx("input",{type:"number",value:y.contract_value,onChange:Je=>Q("contract_value",Je.target.value)})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Foreman PIN (4 digits)"}),p.jsx("input",{type:"text",value:y.pin,onChange:Je=>Q("pin",Je.target.value.replace(/\D/g,"").slice(0,4)),placeholder:"e.g., 2847",maxLength:4})]})]}),p.jsxs("div",{className:"card",children:[p.jsx("h3",{children:"Areas"}),p.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",marginBottom:"1rem"},children:"Weights must total 100%."}),y.areas.map((Je,V)=>p.jsxs("div",{className:"area-row",children:[p.jsx("input",{type:"text",placeholder:"Area name",value:Je.name,onChange:Ie=>N(V,"name",Ie.target.value)}),p.jsx("input",{type:"number",placeholder:"%",value:Je.weight,onChange:Ie=>N(V,"weight",Ie.target.value)}),p.jsx("button",{className:"remove-btn",onClick:()=>B(V),children:""})]},V)),p.jsxs("div",{className:"weight-total",children:[p.jsx("span",{className:"weight-total-label",children:"Total Weight:"}),p.jsxs("span",{className:`weight-total-value ${rt===100?"valid":"invalid"}`,children:[rt,"%"]})]}),p.jsx("button",{className:"btn btn-secondary",onClick:M,children:"+ Add Area"})]}),p.jsx("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem"},children:p.jsx("button",{className:"btn btn-primary",onClick:q,disabled:b,style:{flex:1},children:b?"Saving...":"Save Changes"})}),p.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"1rem"},children:[n.status==="paused"?p.jsx("button",{className:"btn btn-success btn-small",onClick:me,style:{flex:1},children:" Resume"}):p.jsx("button",{className:"btn btn-warning btn-small",onClick:se,style:{flex:1},children:" Pause"}),n.status!=="done"&&p.jsx("button",{className:"btn btn-success btn-small",onClick:we,style:{flex:1},children:" Mark Done"}),p.jsx("button",{className:"btn btn-danger btn-small",onClick:K,style:{flex:1},children:" Delete"})]})]})}return p.jsxs("div",{children:[p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[p.jsx("button",{className:"btn btn-secondary btn-small",onClick:de,children:" Back to Dashboard"}),p.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[p.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>T(!0),children:" Messages"}),p.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>A(!0),children:"Share with Client"}),p.jsx("button",{className:"btn btn-secondary btn-small",onClick:Z,children:"Edit"})]})]}),p.jsx("h1",{children:n.name}),p.jsxs("p",{className:"subtitle",children:["Contract: ",Kl(n.contract_value),n.pin&&p.jsxs("span",{style:{marginLeft:"1rem",color:"var(--text-muted)"},children:["PIN: ",n.pin]})]}),p.jsxs("div",{className:"dashboard-grid",children:[p.jsxs("div",{className:"dashboard-main",children:[p.jsxs("div",{className:"card billing-card",children:[p.jsx("h3",{children:"Billable to Date"}),p.jsx("div",{className:"billing-amount",children:Kl(ae)}),p.jsxs("div",{className:"billing-total",children:["of ",Kl(n.contract_value)," contract value"]}),p.jsxs("div",{className:"progress-container",children:[p.jsxs("div",{className:"progress-header",children:[p.jsx("span",{className:"progress-label",children:"Overall Progress"}),p.jsxs("span",{className:"progress-value",children:[Ee,"%"]})]}),p.jsx("div",{className:"progress-bar",children:p.jsx("div",{className:"progress-fill",style:{width:`${Ee}%`}})})]})]}),p.jsxs("div",{className:"card",children:[p.jsx("h3",{children:"Areas"}),p.jsx("div",{className:"area-status-list",children:o.map(rt=>p.jsxs("div",{className:"area-status-item",children:[p.jsxs("div",{children:[p.jsx("div",{className:"area-name",children:rt.name}),p.jsxs("div",{className:"area-weight",children:[rt.weight,"% of contract"]})]}),p.jsx("span",{className:`status-badge ${rt.status}`,children:zN(rt.status)})]},rt.id))})]}),p.jsx(zE,{project:n,onShowToast:e})]}),p.jsxs("div",{className:"dashboard-sidebar",children:[p.jsxs("div",{className:"card",children:[p.jsx("h3",{children:"Project Management"}),p.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginTop:"1rem"},children:[n.status==="paused"?p.jsx("button",{className:"btn btn-success btn-small",onClick:me,children:" Resume Project"}):p.jsx("button",{className:"btn btn-warning btn-small",onClick:se,children:" Pause Project"}),n.status!=="done"&&p.jsx("button",{className:"btn btn-success btn-small",onClick:we,children:" Mark as Done"}),p.jsx("button",{className:"btn btn-danger btn-small",onClick:K,children:" Delete Project"})]})]}),p.jsx(TU,{project:n,companyId:t?.id||n?.company_id,onShowToast:e})]})]}),E&&p.jsx(AU,{project:n,onClose:()=>A(!1),onShareCreated:rt=>{e("Share link created successfully!","success")}}),O&&p.jsx(HE,{project:n,viewerType:"office",viewerName:"Office",onShowToast:e,onClose:()=>T(!1)})]})}return R?p.jsxs("div",{className:"executive-dashboard",children:[p.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[p.jsxs("div",{children:[p.jsx("h1",{children:"Dashboard"}),p.jsx("p",{className:"subtitle",children:"Overview of all projects and activity"})]}),p.jsx("button",{className:"btn btn-secondary btn-small",onClick:ge,disabled:L,children:L?"Refreshing...":" Refresh"})]}),p.jsxs("div",{className:"metrics-grid",children:[p.jsxs("div",{className:"metric-card",title:R.activeProjects?.list?.map(Ee=>Ee.name).join(", ")||"",children:[p.jsx("div",{className:"metric-value",children:R.activeProjects?.count||0}),p.jsx("div",{className:"metric-label",children:"Active Projects"})]}),p.jsxs("div",{className:"metric-card",title:"Total value of all active project contracts",children:[p.jsx("div",{className:"metric-value",children:Kl(R.totalContractValue?.total||0)}),p.jsx("div",{className:"metric-label",children:"Total Contract Value"}),R.totalContractValue?.breakdown?.length>0&&p.jsxs("div",{className:"metric-subtext",children:[R.totalContractValue.breakdown.length," projects"]})]}),p.jsxs("div",{className:"metric-card metric-success",title:`${R.tmApproved?.count||0} tickets ready to bill`,children:[p.jsx("div",{className:"metric-value",children:Kl(R.tmApproved?.total||0)}),p.jsx("div",{className:"metric-label",children:"T&M Approved"}),R.tmApproved?.count>0&&p.jsxs("div",{className:"metric-subtext",children:[R.tmApproved.count," tickets"]})]}),p.jsxs("div",{className:"metric-card metric-info",title:`${R.tmBilled?.count||0} tickets billed`,children:[p.jsx("div",{className:"metric-value",children:Kl(R.tmBilled?.total||0)}),p.jsx("div",{className:"metric-label",children:"T&M Billed"}),R.tmBilled?.count>0&&p.jsxs("div",{className:"metric-subtext",children:[R.tmBilled.count," tickets"]})]}),p.jsxs("div",{className:"metric-card metric-warning",title:"Projects with low progress",children:[p.jsx("div",{className:"metric-value",children:Kl(R.revenueAtRisk?.total||0)}),p.jsx("div",{className:"metric-label",children:"Revenue at Risk"}),R.revenueAtRisk?.breakdown?.length>0&&p.jsxs("div",{className:"metric-subtext",children:[R.revenueAtRisk.breakdown.length," projects"]})]}),R.materialRequestsPending?.total>0&&p.jsxs("div",{className:"metric-card metric-urgent",children:[p.jsx("div",{className:"metric-value",children:R.materialRequestsPending.total}),p.jsx("div",{className:"metric-label",children:"Pending Material Requests"})]})]}),p.jsxs("div",{className:"card",style:{marginTop:"2rem"},children:[p.jsx("h2",{style:{marginBottom:"1rem"},children:"Active Projects"}),z.length===0?p.jsx("div",{className:"empty-state-small",children:p.jsx("p",{children:"No active projects"})}):p.jsx("div",{className:"dashboard-projects-list",children:z.map(Ee=>p.jsxs("div",{className:`dashboard-project-card status-${Ee.statusColor}`,onClick:()=>he(Ee),children:[p.jsxs("div",{className:"project-header",children:[p.jsxs("div",{children:[p.jsx("div",{className:"project-name",children:Ee.name}),p.jsx("div",{className:"project-value",children:Kl(Ee.contract_value)})]}),p.jsx("div",{className:`status-indicator status-${Ee.statusColor}`})]}),p.jsxs("div",{className:"project-stats",children:[p.jsxs("div",{className:"project-stat",children:[p.jsx("span",{className:"stat-label",children:"Progress"}),p.jsxs("span",{className:"stat-value",children:[Ee.progress,"%"]})]}),p.jsxs("div",{className:"project-stat",children:[p.jsx("span",{className:"stat-label",children:"Crew Today"}),p.jsx("span",{className:"stat-value",children:Ee.crewToday})]}),p.jsxs("div",{className:"project-stat",children:[p.jsx("span",{className:"stat-label",children:"Pending Items"}),p.jsx("span",{className:"stat-value",children:Ee.pendingItems})]})]}),p.jsx("div",{className:"progress-bar",children:p.jsx("div",{className:"progress-fill",style:{width:`${Ee.progress}%`}})})]},Ee.id))})]}),p.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginTop:"2rem"},children:[p.jsxs("div",{className:"card",children:[p.jsx("h2",{style:{marginBottom:"1rem"},children:"Needs Attention"}),W&&p.jsxs("div",{className:"attention-list",children:[W.pendingTM.length>0&&p.jsxs("div",{className:"attention-section",children:[p.jsxs("h3",{className:"attention-heading",children:["Pending T&M Approvals (",W.pendingTM.length,")"]}),W.pendingTM.slice(0,3).map(Ee=>p.jsx("div",{className:"attention-item",children:p.jsxs("div",{children:[p.jsx("div",{className:"attention-item-title",children:Ee.projects?.name}),p.jsxs("div",{className:"attention-item-subtitle",children:[new Date(Ee.work_date).toLocaleDateString(),"  ",Kl(Ee.estimatedValue)]})]})},Ee.id))]}),W.pendingMaterials.length>0&&p.jsxs("div",{className:"attention-section",children:[p.jsxs("h3",{className:"attention-heading",children:["Material Requests (",W.pendingMaterials.length,")"]}),W.pendingMaterials.slice(0,3).map(Ee=>p.jsx("div",{className:"attention-item",children:p.jsxs("div",{children:[p.jsxs("div",{className:"attention-item-title",children:[Ee.projects?.name,Ee.priority==="urgent"&&p.jsx("span",{className:"urgent-badge",children:"URGENT"})]}),p.jsxs("div",{className:"attention-item-subtitle",children:[Ee.items?.length||0," items"]})]})},Ee.id))]}),W.missingReports.length>0&&p.jsxs("div",{className:"attention-section",children:[p.jsxs("h3",{className:"attention-heading",children:["Missing Daily Reports (",W.missingReports.length,")"]}),W.missingReports.slice(0,3).map(Ee=>p.jsx("div",{className:"attention-item",children:p.jsx("div",{className:"attention-item-title",children:Ee.name})},Ee.id))]}),W.unreadMessages.length>0&&p.jsxs("div",{className:"attention-section",children:[p.jsxs("h3",{className:"attention-heading",children:["Unread Messages (",W.unreadMessages.length,")"]}),W.unreadMessages.slice(0,3).map(Ee=>p.jsx("div",{className:"attention-item",children:p.jsxs("div",{children:[p.jsx("div",{className:"attention-item-title",children:Ee.projects?.name}),p.jsxs("div",{className:"attention-item-subtitle",children:[Ee.message?.substring(0,50),"..."]})]})},Ee.id))]}),W.pendingTM.length===0&&W.pendingMaterials.length===0&&W.missingReports.length===0&&W.unreadMessages.length===0&&p.jsx("div",{className:"empty-state-small",children:p.jsx("p",{children:"All caught up! No items need attention."})})]})]}),p.jsxs("div",{className:"card",children:[p.jsx("h2",{style:{marginBottom:"1rem"},children:"Recent Activity"}),Y.length===0?p.jsx("div",{className:"empty-state-small",children:p.jsx("p",{children:"No recent activity"})}):p.jsx("div",{className:"activity-feed",children:Y.map((Ee,ae)=>p.jsxs("div",{className:"activity-item",children:[p.jsxs("div",{className:`activity-icon activity-${Ee.type}`,children:[Ee.type==="tm_submitted"&&"",Ee.type==="report_submitted"&&"",Ee.type==="material_request"&&"",Ee.type==="task_completed"&&""]}),p.jsxs("div",{className:"activity-content",children:[p.jsx("div",{className:"activity-message",children:Ee.message}),p.jsxs("div",{className:"activity-meta",children:[p.jsx("span",{className:"activity-project",children:Ee.project}),Ee.by&&p.jsxs("span",{className:"activity-by",children:["  ",Ee.by]}),p.jsxs("span",{className:"activity-time",children:["  ",Se(Ee.timestamp)]})]})]})]},ae))})]})]})]}):p.jsxs("div",{className:"empty-state",children:[p.jsx("div",{className:"empty-state-icon",children:""}),p.jsx("h3",{children:"Loading Dashboard"}),p.jsx("p",{children:"Fetching your data..."})]})}function CU({company:t,onProjectCreated:e,onShowToast:r}){const[a,n]=ke.useState(""),[i,o]=ke.useState(""),[c,u]=ke.useState(""),[h,d]=ke.useState(""),[v,y]=ke.useState(""),[g,b]=ke.useState(""),[w,E]=ke.useState([{name:"",weight:"",group:""},{name:"",weight:"",group:""},{name:"",weight:"",group:""}]),[A,O]=ke.useState(!1),[T,R]=ke.useState(!1),[H,z]=ke.useState(!1),[F,W]=ke.useState([]),D=ke.useRef(null),Y=w.reduce((q,K)=>q+(parseFloat(K.weight)||0),0),I=q=>{const K=q.replace(/\D/g,"").slice(0,4);b(K)},L=()=>{const q=Math.floor(1e3+Math.random()*9e3).toString();b(q)},ee=(q,K,se)=>{E(me=>me.map((we,Se)=>Se===q?{...we,[K]:se}:we))},oe=()=>{E(q=>[...q,{name:"",weight:"",group:""}])},ge=q=>{w.length>1&&E(K=>K.filter((se,me)=>me!==q))},ie=()=>{n(""),o(""),u(""),d(""),y(""),b(""),E([{name:"",weight:"",group:""},{name:"",weight:"",group:""},{name:"",weight:"",group:""}]),z(!1),W([])},he=()=>{D.current?.click()},de=q=>new Promise((K,se)=>{const me=new FileReader;me.onload=we=>{try{const Se=new Uint8Array(we.target.result),Ee=Fv(Se,{type:"array"}),ae=Ee.SheetNames[0],rt=Ee.Sheets[ae],Je=$c.sheet_to_json(rt,{header:1});console.log("Excel rows:",Je);const V=[];let Ie="General";for(const et of Je){if(!et||et.length===0)continue;const wt=et.map(Ye=>Ye==null?"":String(Ye).trim()).filter(Ye=>Ye.length>0);if(wt.length===0)continue;const vt=wt.join(" ");if(console.log("Row cells:",wt,"| Combined:",vt),/^Description\b/i.test(wt[0])||/^Quantity\b/i.test(wt[0]))continue;if(wt.length<=2&&!/^\d+$/.test(wt[0])&&!wt.some(Ye=>/^\d{2,}$/.test(Ye))&&/^(L\d|Level|Floor|\d+(?:st|nd|rd|th)|Plaza|Street|Basement|Roof|Penthouse|Site|Exterior|Misc|MEP|ABATEMENT|DEMOLITION|UNIVERSAL|SOFT|TRASH|DEMO)/i.test(wt[0])){Ie=vt.replace(/\s*\(\d{1,3}(?:,\d{3})*\s*SF\)\s*$/i,"").trim(),console.log("Found group:",Ie);continue}let Et="",It=!1;const er=/^(SF|LF|EA|LS|Days?|MD|Load)$/i,Vt=/^\d{1,3}(,\d{3})*$|^\d+$/,Oe=[];for(let Ye=0;Ye<wt.length;Ye++){const He=wt[Ye];if(!(Ye===0&&/^ID-\d+$/i.test(He))&&!/^KN\s*\d+$/i.test(He)){if(Vt.test(He.replace(/,/g,""))){It=!0;continue}er.test(He)||He.length>1&&Oe.push(He)}}Et=Oe.join(" ").trim(),Et=Et.replace(/\s+/g," ").trim(),!(Et.length<3)&&(/^(Plan|Page|\$|Total|Base Bid|Payment|Condition|Exclusion)/i.test(Et)||It&&Et.length>=3&&(V.push({name:Et,group:Ie,selected:!0}),console.log("Found task:",Et,"in",Ie)))}const Le=new Set,gt=V.filter(et=>{const wt=`${et.group}:${et.name}`;return Le.has(wt)?!1:(Le.add(wt),!0)});K(gt)}catch(Se){se(Se)}},me.onerror=()=>se(new Error("Failed to read file")),me.readAsArrayBuffer(q)}),Z=async q=>{const K=q.target.files?.[0];if(!K)return;const se=K.name.split(".").pop().toLowerCase();if(!["xlsx","xls","csv"].includes(se)){r("Please upload an Excel file (.xlsx, .xls, or .csv)","error");return}R(!0);try{const me=await de(K);if(me.length===0){r("No tasks found. Check Excel format.","error"),R(!1);return}W(me),z(!0),r(`Found ${me.length} tasks`,"success")}catch(me){console.error("Excel import error:",me),r("Error reading Excel file","error")}finally{R(!1),D.current&&(D.current.value="")}},Ne=q=>{W(K=>K.map((se,me)=>me===q?{...se,selected:!se.selected}:se))},Q=()=>{const q=F.filter(me=>me.selected);if(q.length===0){r("Please select at least one task","error");return}const K=Math.round(100/q.length*100)/100,se=q.map((me,we)=>({name:me.name,weight:we===q.length-1?(100-K*(q.length-1)).toFixed(2):K.toFixed(2),group:me.group}));E(se),z(!1),r("Tasks imported!","success")},N=async()=>{if(!a.trim()){r("Please enter a project name","error");return}const q=parseFloat(v);if(!q||q<=0){r("Please enter a valid contract value","error");return}if(g.length!==4){r("Please enter a 4-digit PIN","error");return}if(!await jt.isPinAvailable(g)){r("This PIN is already in use. Try another.","error");return}const se=w.filter(me=>me.name.trim()&&parseFloat(me.weight)>0);if(se.length===0){r("Please add at least one area","error");return}if(Math.abs(Y-100)>.1){r("Area weights must total 100%","error");return}O(!0);try{const me=await jt.createProject({company_id:t.id,name:a.trim(),job_number:i.trim()||null,address:c.trim()||null,general_contractor:h.trim()||null,contract_value:q,pin:g});for(let we=0;we<se.length;we++)await jt.createArea({project_id:me.id,name:se[we].name.trim(),weight:parseFloat(se[we].weight),group_name:se[we].group||null,status:"not_started",sort_order:we});r("Project created!","success"),ie(),e()}catch(me){console.error("Error creating project:",me),r("Error creating project","error")}finally{O(!1)}};if(H){const q=[...new Set(F.map(se=>se.group))],K=F.filter(se=>se.selected).length;return p.jsxs("div",{children:[p.jsx("h1",{children:"Review Imported Tasks"}),p.jsx("p",{className:"subtitle",children:"Select the tasks to include in your project"}),p.jsx("div",{className:"import-summary",children:p.jsxs("span",{children:[K," of ",F.length," tasks selected"]})}),q.map(se=>{const me=F.filter(Se=>Se.group===se),we=me.filter(Se=>Se.selected).length;return p.jsxs("div",{className:"card import-group",children:[p.jsxs("div",{className:"import-group-header",children:[p.jsx("h3",{children:se}),p.jsxs("span",{className:"import-group-count",children:[we,"/",me.length]})]}),p.jsx("div",{className:"import-task-list",children:me.map(Se=>{const Ee=F.indexOf(Se);return p.jsxs("label",{className:"import-task-item",children:[p.jsx("input",{type:"checkbox",checked:Se.selected,onChange:()=>Ne(Ee)}),p.jsx("span",{className:"import-task-name",children:Se.name})]},Ee)})})]},se)}),p.jsxs("div",{className:"import-actions",children:[p.jsx("button",{className:"btn btn-secondary",onClick:()=>z(!1),children:"Cancel"}),p.jsxs("button",{className:"btn btn-primary",onClick:Q,children:["Use Selected Tasks (",K,")"]})]})]})}const M=w.reduce((q,K,se)=>{const me=K.group||"General";return q[me]||(q[me]=[]),q[me].push({...K,originalIndex:se}),q},{}),B=Object.keys(M).length>1||Object.keys(M).length===1&&!M.General;return p.jsxs("div",{children:[p.jsx("h1",{children:"New Project"}),p.jsx("p",{className:"subtitle",children:"Set up a new project to track"}),p.jsxs("div",{className:"card",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Project Name"}),p.jsx("input",{type:"text",placeholder:"e.g., Sunrise Apartments",value:a,onChange:q=>n(q.target.value)})]}),p.jsxs("div",{className:"form-row-2",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Job Number"}),p.jsx("input",{type:"text",placeholder:"e.g., 4032",value:i,onChange:q=>o(q.target.value)})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Contract Value ($)"}),p.jsx("input",{type:"number",placeholder:"e.g., 365000",value:v,onChange:q=>y(q.target.value)})]})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Project Address"}),p.jsx("input",{type:"text",placeholder:"e.g., 123 Main St, Los Angeles, CA 90001",value:c,onChange:q=>u(q.target.value)})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"General Contractor"}),p.jsx("input",{type:"text",placeholder:"e.g., ABC Construction Inc.",value:h,onChange:q=>d(q.target.value)})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Foreman PIN (4 digits)"}),p.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Foremen will enter this PIN to access this project"}),p.jsxs("div",{className:"pin-input-row",children:[p.jsx("input",{type:"text",placeholder:"e.g., 2847",value:g,onChange:q=>I(q.target.value),maxLength:4,className:"pin-input"}),p.jsx("button",{type:"button",className:"btn btn-secondary",onClick:L,children:"Generate"})]})]})]}),p.jsxs("div",{className:"card",children:[p.jsxs("div",{className:"areas-header",children:[p.jsxs("div",{children:[p.jsx("h3",{children:"Areas / Tasks"}),p.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",marginTop:"0.25rem"},children:"Define the areas for this project. Weights must total 100%."})]}),p.jsxs("div",{className:"import-btn-container",children:[p.jsx("input",{ref:D,type:"file",accept:".xlsx,.xls,.csv",onChange:Z,style:{display:"none"}}),p.jsx("button",{className:"btn btn-secondary btn-small",onClick:he,disabled:T,children:T?"Reading...":" Import Excel"})]})]}),B?Object.entries(M).map(([q,K])=>p.jsxs("div",{className:"area-group",children:[p.jsx("div",{className:"area-group-header",children:q}),K.map(se=>p.jsxs("div",{className:"area-row",children:[p.jsx("input",{type:"text",placeholder:"Task name",value:se.name,onChange:me=>ee(se.originalIndex,"name",me.target.value)}),p.jsx("input",{type:"number",placeholder:"%",min:"0",max:"100",value:se.weight,onChange:me=>ee(se.originalIndex,"weight",me.target.value)}),p.jsx("button",{className:"remove-btn",onClick:()=>ge(se.originalIndex),children:""})]},se.originalIndex))]},q)):w.map((q,K)=>p.jsxs("div",{className:"area-row",children:[p.jsx("input",{type:"text",placeholder:"Area name (e.g., Level 1)",value:q.name,onChange:se=>ee(K,"name",se.target.value)}),p.jsx("input",{type:"number",placeholder:"%",min:"0",max:"100",value:q.weight,onChange:se=>ee(K,"weight",se.target.value)}),p.jsx("button",{className:"remove-btn",onClick:()=>ge(K),children:""})]},K)),p.jsxs("div",{className:"weight-total",children:[p.jsx("span",{className:"weight-total-label",children:"Total Weight:"}),p.jsxs("span",{className:`weight-total-value ${Math.abs(Y-100)<.1?"valid":"invalid"}`,children:[Y.toFixed(1),"%"]})]}),p.jsx("button",{className:"btn btn-secondary",onClick:oe,children:"+ Add Area"})]}),p.jsx("button",{className:"btn btn-primary btn-full",onClick:N,disabled:A,children:A?"Creating...":"Create Project"})]})}function OU({company:t,onShowToast:e}){const{branding:r,updateBranding:a,uploadBrandingImage:n,loading:i}=a2(),[o,c]=ke.useState(!1),[u,h]=ke.useState(!1),[d,v]=ke.useState(r),y=ke.useRef(null),g=ke.useRef(null),b=ke.useRef(null),w=t?.subscription_tier||"free",E=["pro","business","enterprise"].includes(w),A=["business","enterprise"].includes(w),O=w==="enterprise",T=(F,W)=>{v(D=>({...D,[F]:W}))},R=async(F,W)=>{if(F){if(F.size>5*1024*1024){e?.("Image must be smaller than 5MB","error");return}if(!F.type.startsWith("image/")){e?.("Please upload an image file","error");return}try{const D=await n(F,W);D.success?(T(`${W}_url`,D.url),e?.(`${W.charAt(0).toUpperCase()+W.slice(1)} uploaded successfully`,"success")):e?.(D.error||"Failed to upload image","error")}catch(D){console.error("Upload error:",D),e?.("Failed to upload image","error")}}},H=async()=>{try{c(!0);const F=/^#[0-9A-F]{6}$/i;if(!F.test(d.primary_color)){e?.("Primary color must be a valid hex color (e.g., #3B82F6)","error");return}if(!F.test(d.secondary_color)){e?.("Secondary color must be a valid hex color (e.g., #1E40AF)","error");return}const W=await a(d);W.success?e?.("Branding settings saved successfully!","success"):e?.(W.error||"Failed to save branding settings","error")}catch(F){console.error("Save error:",F),e?.("Failed to save branding settings","error")}finally{c(!1)}},z=()=>{u?(document.documentElement.style.setProperty("--primary-color",r.primary_color),document.documentElement.style.setProperty("--secondary-color",r.secondary_color),document.title=r.custom_app_name||"FieldSync"):(document.documentElement.style.setProperty("--primary-color",d.primary_color),document.documentElement.style.setProperty("--secondary-color",d.secondary_color),document.title=d.custom_app_name||"FieldSync"),h(!u)};return i?p.jsxs("div",{className:"settings-loading",children:[p.jsx("div",{className:"spinner"}),p.jsx("p",{children:"Loading branding settings..."})]}):p.jsxs("div",{className:"branding-settings",children:[p.jsxs("div",{className:"settings-header",children:[p.jsx("h2",{children:" Branding Settings"}),w==="free"&&p.jsx("div",{className:"tier-badge tier-free",children:"Free Plan - Upgrade for branding options"}),w==="pro"&&p.jsx("div",{className:"tier-badge tier-pro",children:"Pro Plan"}),w==="business"&&p.jsx("div",{className:"tier-badge tier-business",children:"Business Plan"}),w==="enterprise"&&p.jsx("div",{className:"tier-badge tier-enterprise",children:"Enterprise Plan"})]}),p.jsxs("div",{className:"settings-section",children:[p.jsx("h3",{children:"Visual Identity"}),p.jsxs("div",{className:"setting-item",children:[p.jsx("label",{children:"Logo"}),E?p.jsxs(p.Fragment,{children:[d.logo_url&&p.jsx("div",{className:"logo-preview",children:p.jsx("img",{src:d.logo_url,alt:"Logo preview"})}),p.jsx("input",{ref:y,type:"file",accept:"image/*",style:{display:"none"},onChange:F=>R(F.target.files[0],"logo")}),p.jsx("button",{className:"btn-secondary",onClick:()=>y.current?.click(),children:d.logo_url?"Change Logo":"Upload Logo"}),p.jsx("p",{className:"help-text",children:"Recommended: 200x60px, PNG with transparent background"})]}):p.jsx("div",{className:"upgrade-notice",children:p.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your logo"})})]}),p.jsxs("div",{className:"setting-item",children:[p.jsx("label",{htmlFor:"app-name",children:"App Name"}),E?p.jsxs(p.Fragment,{children:[p.jsx("input",{id:"app-name",type:"text",className:"input",value:d.custom_app_name||"",onChange:F=>T("custom_app_name",F.target.value),placeholder:"FieldSync",maxLength:50}),p.jsx("p",{className:"help-text",children:"This name appears in the browser tab and throughout the app"})]}):p.jsx("div",{className:"upgrade-notice",children:p.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your app name"})})]}),p.jsxs("div",{className:"setting-item",children:[p.jsx("label",{htmlFor:"primary-color",children:"Primary Color"}),E?p.jsxs("div",{className:"color-input-group",children:[p.jsx("input",{id:"primary-color",type:"color",value:d.primary_color||"#3B82F6",onChange:F=>T("primary_color",F.target.value),className:"color-picker"}),p.jsx("input",{type:"text",className:"input color-text",value:d.primary_color||"#3B82F6",onChange:F=>T("primary_color",F.target.value),placeholder:"#3B82F6",pattern:"^#[0-9A-Fa-f]{6}$"})]}):p.jsx("div",{className:"upgrade-notice",children:p.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize colors"})})]}),p.jsxs("div",{className:"setting-item",children:[p.jsx("label",{htmlFor:"secondary-color",children:"Secondary Color"}),E?p.jsxs("div",{className:"color-input-group",children:[p.jsx("input",{id:"secondary-color",type:"color",value:d.secondary_color||"#1E40AF",onChange:F=>T("secondary_color",F.target.value),className:"color-picker"}),p.jsx("input",{type:"text",className:"input color-text",value:d.secondary_color||"#1E40AF",onChange:F=>T("secondary_color",F.target.value),placeholder:"#1E40AF",pattern:"^#[0-9A-Fa-f]{6}$"})]}):p.jsx("div",{className:"upgrade-notice",children:p.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize colors"})})]}),p.jsxs("div",{className:"setting-item",children:[p.jsx("label",{children:"Favicon"}),E?p.jsxs(p.Fragment,{children:[d.favicon_url&&p.jsx("div",{className:"favicon-preview",children:p.jsx("img",{src:d.favicon_url,alt:"Favicon preview"})}),p.jsx("input",{ref:g,type:"file",accept:"image/*",style:{display:"none"},onChange:F=>R(F.target.files[0],"favicon")}),p.jsx("button",{className:"btn-secondary",onClick:()=>g.current?.click(),children:d.favicon_url?"Change Favicon":"Upload Favicon"}),p.jsx("p",{className:"help-text",children:"Recommended: 32x32px or 64x64px, PNG or ICO format"})]}):p.jsx("div",{className:"upgrade-notice",children:p.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your favicon"})})]}),p.jsxs("div",{className:"setting-item",children:[p.jsx("label",{children:"Login Background"}),A?p.jsxs(p.Fragment,{children:[d.login_background_url&&p.jsx("div",{className:"background-preview",children:p.jsx("img",{src:d.login_background_url,alt:"Background preview"})}),p.jsx("input",{ref:b,type:"file",accept:"image/*",style:{display:"none"},onChange:F=>R(F.target.files[0],"login_background")}),p.jsx("button",{className:"btn-secondary",onClick:()=>b.current?.click(),children:d.login_background_url?"Change Background":"Upload Background"}),p.jsx("p",{className:"help-text",children:"Recommended: 1920x1080px, JPG or PNG"})]}):p.jsx("div",{className:"upgrade-notice",children:p.jsx("p",{children:" Upgrade to Business or Enterprise to customize login background"})})]})]}),p.jsxs("div",{className:"settings-section",children:[p.jsx("h3",{children:"White-Label Options"}),p.jsxs("div",{className:"setting-item",children:[p.jsxs("label",{className:"checkbox-label",children:[p.jsx("input",{type:"checkbox",checked:d.hide_fieldsync_branding||!1,onChange:F=>T("hide_fieldsync_branding",F.target.checked),disabled:!A}),p.jsx("span",{children:'Hide "Powered by FieldSync"'})]}),!A&&p.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]})]}),p.jsxs("div",{className:"settings-section",children:[p.jsx("h3",{children:"Email Branding"}),p.jsxs("div",{className:"setting-item",children:[p.jsx("label",{htmlFor:"email-from-name",children:"From Name"}),p.jsx("input",{id:"email-from-name",type:"text",className:"input",value:d.email_from_name||"",onChange:F=>T("email_from_name",F.target.value),placeholder:"Your Company Name",disabled:!A}),!A&&p.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]}),p.jsxs("div",{className:"setting-item",children:[p.jsx("label",{htmlFor:"email-from-address",children:"From Email"}),p.jsx("input",{id:"email-from-address",type:"email",className:"input",value:d.email_from_address||"",onChange:F=>T("email_from_address",F.target.value),placeholder:"noreply@yourcompany.com",disabled:!A}),!A&&p.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]})]}),p.jsxs("div",{className:"settings-section",children:[p.jsx("h3",{children:"Custom Domain"}),p.jsxs("div",{className:"setting-item",children:[p.jsx("label",{htmlFor:"custom-domain",children:"Domain"}),O?p.jsxs(p.Fragment,{children:[p.jsx("input",{id:"custom-domain",type:"text",className:"input",value:d.custom_domain||"",onChange:F=>T("custom_domain",F.target.value),placeholder:"app.yourcompany.com"}),d.custom_domain&&p.jsx("div",{className:`domain-status ${d.domain_verified?"verified":"pending"}`,children:d.domain_verified?p.jsx(p.Fragment,{children:" Connected"}):p.jsx(p.Fragment,{children:" DNS setup required"})}),p.jsx("p",{className:"help-text",children:"Contact support to configure DNS and SSL certificate for your custom domain"})]}):p.jsxs("div",{className:"upgrade-notice",children:[p.jsx("p",{children:" Enterprise plan required for custom domain support"}),p.jsx("p",{className:"help-text",children:"Custom domains allow you to host the app at your own URL (e.g., app.yourcompany.com)"})]})]})]}),p.jsxs("div",{className:"settings-actions",children:[p.jsx("button",{className:"btn-secondary",onClick:z,children:u?"Exit Preview":"Preview Changes"}),p.jsx("button",{className:"btn-primary",onClick:H,disabled:o||!E,children:o?"Saving...":"Save Changes"})]}),u&&p.jsx("div",{className:"preview-banner",children:"Preview Mode Active - Your changes are not yet saved"})]})}function FU({company:t,user:e,onShowToast:r}){const[a,n]=ke.useState(!0),i=e?.role==="admin"||e?.role==="office",[o,c]=ke.useState(i?"roles":"preferences"),[u,h]=ke.useState([]),[d,v]=ke.useState(null),[y,g]=ke.useState([]),[b,w]=ke.useState([]),[E,A]=ke.useState([]),[O,T]=ke.useState(!1),[R,H]=ke.useState(!1),[z,F]=ke.useState(!1),[W,D]=ke.useState(""),[Y,I]=ke.useState(""),[L,ee]=ke.useState(""),[oe,ge]=ke.useState(""),[ie,he]=ke.useState(""),[de,Z]=ke.useState(""),[Ne,Q]=ke.useState([]),[N,M]=ke.useState([]),[B,q]=ke.useState([]);ke.useEffect(()=>{K()},[t?.id]),ke.useEffect(()=>{d&&se(d.id)},[d]);const K=async()=>{if(t?.id){n(!0);try{const V=await jt.getNotificationRoles(t.id);h(V),V.length>0&&!d&&v(V[0]);const Ie=await jt.getUsersForCompany(t.id);A(Ie);const Le=await jt.getNotificationTypes();if(Q(Le),e?.id){const gt=await jt.getNotificationPreferences(e.id,t.id);M(gt);const wt=(await jt.getUserNotificationRoles(e.id)).filter(vt=>vt.notification_roles?.company_id===t.id);q(wt.map(vt=>vt.notification_roles))}}catch(V){console.error("Error loading notification settings:",V),r?.("Error loading notification settings","error")}finally{n(!1)}}},se=async V=>{try{const Ie=await jt.getUsersByNotificationRole(V);g(Ie);const Le=await jt.getExternalRecipientsByRole(V);w(Le)}catch(Ie){console.error("Error loading role users:",Ie)}},me=async V=>{if(!d)return;if(y.some(Le=>Le.users.id===V)){r?.("This user is already assigned to this role","error");return}try{const Le=await jt.assignNotificationRole(V,d.id,e.id);Le.success?(r?.(`User assigned to ${d.role_name}`,"success"),se(d.id),T(!1)):Le.error?.includes("duplicate key")||Le.error?.includes("already exists")?r?.("This user is already assigned to this role","error"):r?.(Le.error||"Failed to assign user","error")}catch(Le){console.error("Error assigning user:",Le),Le.message?.includes("duplicate key")||Le.code==="23505"?r?.("This user is already assigned to this role","error"):r?.("Failed to assign user","error")}},we=async V=>{if(d&&confirm("Remove this user from the notification role?"))try{const Ie=await jt.removeNotificationRole(V,d.id);Ie.success?(r?.("User removed from role","success"),se(d.id)):r?.(Ie.error||"Failed to remove user","error")}catch(Ie){console.error("Error removing user:",Ie),r?.("Failed to remove user","error")}},Se=async V=>{if(V.preventDefault(),!W.trim()||!Y.trim()){r?.("Role name and key are required","error");return}try{const Ie=Y.toLowerCase().replace(/\s+/g,"_"),Le=await jt.createNotificationRole(t.id,W.trim(),Ie,L.trim());Le.success?(r?.("Notification role created!","success"),D(""),I(""),ee(""),F(!1),K()):r?.(Le.error||"Failed to create role","error")}catch(Ie){console.error("Error creating role:",Ie),r?.("Failed to create role","error")}},Ee=async V=>{if(V.preventDefault(),!d)return;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(oe)){r?.("Please enter a valid email address","error");return}try{const Le=await jt.addExternalRecipient(d.id,oe,ie,de,e.id);Le.success?(r?.(`External email added to ${d.role_name}`,"success"),ge(""),he(""),Z(""),H(!1),se(d.id)):r?.(Le.error||"Failed to add external email","error")}catch(Le){console.error("Error adding external email:",Le),r?.("Failed to add external email","error")}},ae=async V=>{if(confirm("Remove this external email from notifications?"))try{const Ie=await jt.removeExternalRecipient(V);Ie.success?(r?.("External email removed","success"),se(d.id)):r?.(Ie.error||"Failed to remove external email","error")}catch(Ie){console.error("Error removing external email:",Ie),r?.("Failed to remove external email","error")}},rt=async(V,Ie,Le)=>{try{const gt=N.find(vt=>vt.notification_type_id===V),et={email_enabled:gt?.email_enabled??!0,in_app_enabled:gt?.in_app_enabled??!0,sms_enabled:gt?.sms_enabled??!1,[Ie]:Le},wt=await jt.updateNotificationPreference(e.id,t.id,V,et);if(wt.success){const vt=await jt.getNotificationPreferences(e.id,t.id);M(vt),r?.("Preference updated","success")}else r?.(wt.error||"Failed to update preference","error")}catch(gt){console.error("Error updating preference:",gt),r?.("Failed to update preference","error")}},Je=E.filter(V=>!y.some(Ie=>Ie.users.id===V.id));return a?p.jsx("div",{className:"notification-settings",children:p.jsxs("div",{className:"settings-loading",children:[p.jsx("div",{className:"spinner"}),p.jsx("p",{children:"Loading notification settings..."})]})}):p.jsxs("div",{className:"notification-settings",children:[p.jsxs("div",{className:"settings-tabs",children:[i&&p.jsx("button",{className:`settings-tab ${o==="roles"?"active":""}`,onClick:()=>c("roles"),children:"Manage Roles"}),p.jsx("button",{className:`settings-tab ${o==="preferences"?"active":""}`,onClick:()=>c("preferences"),children:"My Preferences"})]}),o==="roles"&&i&&p.jsxs("div",{className:"roles-section",children:[p.jsxs("div",{className:"section-header",children:[p.jsxs("div",{children:[p.jsx("h2",{children:"Manage Notification Roles"}),p.jsx("p",{children:"Assign users and external emails to roles that receive specific notifications"})]}),p.jsx("button",{className:"btn-primary",onClick:()=>F(!0),children:"+ Create Role"})]}),p.jsxs("div",{className:"roles-layout",children:[p.jsxs("div",{className:"roles-list",children:[p.jsx("h3",{children:"Roles"}),u.map(V=>p.jsxs("button",{className:`role-item ${d?.id===V.id?"active":""}`,onClick:()=>v(V),children:[p.jsx("div",{className:"role-name",children:V.role_name}),p.jsx("div",{className:"role-description",children:V.description})]},V.id)),u.length===0&&p.jsxs("div",{className:"empty-state",children:[p.jsx("p",{children:"No notification roles yet"}),p.jsx("button",{onClick:()=>F(!0),children:"Create first role"})]})]}),d&&p.jsxs("div",{className:"role-users",children:[p.jsxs("div",{className:"role-users-header",children:[p.jsxs("div",{children:[p.jsx("h3",{children:d.role_name}),p.jsx("p",{children:d.description})]}),p.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[p.jsx("button",{className:"btn-secondary",onClick:()=>T(!0),disabled:Je.length===0,children:"+ Assign User"}),p.jsx("button",{className:"btn-secondary",onClick:()=>H(!0),children:"+ Add Email"})]})]}),p.jsx("div",{className:"assigned-users",children:y.length===0&&b.length===0?p.jsxs("div",{className:"empty-state",children:[p.jsx("p",{children:"No recipients assigned to this role yet"}),p.jsx("button",{onClick:()=>T(!0),children:"Assign first user"}),p.jsx("button",{onClick:()=>H(!0),style:{marginTop:"0.5rem"},children:"Add external email"})]}):p.jsxs(p.Fragment,{children:[y.length>0&&p.jsxs("h4",{style:{margin:"0 0 1rem 0",color:"var(--text-secondary)",fontSize:"0.9rem"},children:["App Users (",y.length,")"]}),y.map(V=>p.jsxs("div",{className:"assigned-user-card",children:[p.jsxs("div",{className:"user-info",children:[p.jsx("div",{className:"user-name",children:V.users.name||V.users.email}),p.jsx("div",{className:"user-email",children:V.users.email}),p.jsxs("div",{className:"user-meta",children:["Assigned ",new Date(V.assigned_at).toLocaleDateString()]})]}),p.jsx("button",{className:"btn-danger-small",onClick:()=>we(V.users.id),children:"Remove"})]},V.id)),b.length>0&&p.jsxs(p.Fragment,{children:[p.jsxs("h4",{style:{margin:"1.5rem 0 1rem 0",color:"var(--text-secondary)",fontSize:"0.9rem"},children:["External Emails (",b.length,")"]}),b.map(V=>p.jsxs("div",{className:"assigned-user-card",style:{borderLeft:"3px solid var(--accent-blue)"},children:[p.jsxs("div",{className:"user-info",children:[p.jsx("div",{className:"user-name",children:V.name||V.email}),p.jsx("div",{className:"user-email",children:V.email}),V.notes&&p.jsx("div",{className:"user-meta",children:V.notes}),p.jsxs("div",{className:"user-meta",children:["Added ",new Date(V.created_at).toLocaleDateString()]})]}),p.jsx("button",{className:"btn-danger-small",onClick:()=>ae(V.id),children:"Remove"})]},V.id))]})]})})]})]})]}),o==="preferences"&&p.jsxs("div",{className:"preferences-section",children:[p.jsx("div",{className:"section-header",children:p.jsxs("div",{children:[p.jsx("h2",{children:"My Notification Preferences"}),p.jsx("p",{children:"Choose how you want to receive notifications"})]})}),B.length>0&&p.jsxs("div",{className:"my-roles-section",style:{background:"var(--bg-card)",padding:"1.5rem",borderRadius:"12px",marginBottom:"2rem",border:"2px solid var(--accent-blue)"},children:[p.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"var(--accent-blue)"},children:"My Notification Roles"}),p.jsxs("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",color:"var(--text-secondary)"},children:["You are assigned to receive notifications for the following roles. ",i?'Switch to "Manage Roles" to change assignments.':"Contact your office admin to change role assignments."]}),p.jsx("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:B.map(V=>p.jsxs("div",{style:{background:"var(--accent-blue-light)",border:"1px solid var(--accent-blue)",borderRadius:"8px",padding:"0.75rem 1rem",display:"flex",flexDirection:"column",gap:"0.25rem"},children:[p.jsx("div",{style:{fontWeight:600,color:"var(--text-primary)"},children:V.role_name}),p.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:V.description})]},V.id))})]}),p.jsx("div",{className:"notification-types-grid",children:Object.entries(Ne.reduce((V,Ie)=>(V[Ie.category]||(V[Ie.category]=[]),V[Ie.category].push(Ie),V),{})).map(([V,Ie])=>p.jsxs("div",{className:"category-group",children:[p.jsx("h3",{className:"category-title",children:V.charAt(0).toUpperCase()+V.slice(1)}),p.jsx("div",{className:"notification-types",children:Ie.map(Le=>{const gt=N.find(vt=>vt.notification_type_id===Le.id),et=gt?.email_enabled??Le.default_enabled,wt=gt?.in_app_enabled??Le.default_enabled;return p.jsxs("div",{className:"notification-type-row",children:[p.jsxs("div",{className:"type-info",children:[p.jsx("div",{className:"type-name",children:Le.type_name}),p.jsx("div",{className:"type-description",children:Le.description})]}),p.jsxs("div",{className:"type-toggles",children:[p.jsxs("label",{className:"toggle-label",children:[p.jsx("input",{type:"checkbox",checked:et,onChange:vt=>rt(Le.id,"email_enabled",vt.target.checked)}),p.jsx("span",{children:"Email"})]}),p.jsxs("label",{className:"toggle-label",children:[p.jsx("input",{type:"checkbox",checked:wt,onChange:vt=>rt(Le.id,"in_app_enabled",vt.target.checked)}),p.jsx("span",{children:"In-App"})]})]})]},Le.id)})})]},V))})]}),O&&p.jsx("div",{className:"modal-overlay",onClick:()=>T(!1),children:p.jsxs("div",{className:"modal",onClick:V=>V.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsxs("h3",{children:["Assign User to ",d?.role_name]}),p.jsx("button",{className:"modal-close",onClick:()=>T(!1),children:""})]}),p.jsx("div",{className:"modal-body",children:Je.length===0?p.jsx("p",{children:"All users are already assigned to this role."}):p.jsx("div",{className:"user-select-list",children:Je.map(V=>p.jsxs("button",{className:"user-select-item",onClick:()=>me(V.id),children:[p.jsx("div",{className:"user-name",children:V.name||V.email}),p.jsx("div",{className:"user-email",children:V.email})]},V.id))})})]})}),z&&p.jsx("div",{className:"modal-overlay",onClick:()=>F(!1),children:p.jsxs("div",{className:"modal",onClick:V=>V.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h3",{children:"Create Notification Role"}),p.jsx("button",{className:"modal-close",onClick:()=>F(!1),children:""})]}),p.jsxs("form",{onSubmit:Se,children:[p.jsxs("div",{className:"modal-body",children:[p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Role Name *"}),p.jsx("input",{type:"text",value:W,onChange:V=>D(V.target.value),placeholder:"e.g., Equipment Manager",required:!0})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Role Key *"}),p.jsx("input",{type:"text",value:Y,onChange:V=>I(V.target.value),placeholder:"e.g., equipment_manager",required:!0}),p.jsx("small",{children:"Lowercase with underscores (used in code)"})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Description"}),p.jsx("textarea",{value:L,onChange:V=>ee(V.target.value),placeholder:"What notifications does this role receive?",rows:3})]})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>F(!1),children:"Cancel"}),p.jsx("button",{type:"submit",className:"btn-primary",children:"Create Role"})]})]})]})}),R&&p.jsx("div",{className:"modal-overlay",onClick:()=>H(!1),children:p.jsxs("div",{className:"modal",onClick:V=>V.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsxs("h3",{children:["Add External Email to ",d?.role_name]}),p.jsx("button",{className:"modal-close",onClick:()=>H(!1),children:""})]}),p.jsxs("form",{onSubmit:Ee,children:[p.jsxs("div",{className:"modal-body",children:[p.jsx("p",{style:{marginTop:0,color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Add an email address for someone who doesn't have an app account. They'll receive email notifications only."}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Email Address *"}),p.jsx("input",{type:"email",value:oe,onChange:V=>ge(V.target.value),placeholder:"vendor@example.com",required:!0,autoFocus:!0})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Name (Optional)"}),p.jsx("input",{type:"text",value:ie,onChange:V=>he(V.target.value),placeholder:"John Doe"}),p.jsx("small",{children:"Helps identify this recipient"})]}),p.jsxs("div",{className:"form-group",children:[p.jsx("label",{children:"Notes (Optional)"}),p.jsx("input",{type:"text",value:de,onChange:V=>Z(V.target.value),placeholder:"e.g., External vendor contact"}),p.jsx("small",{children:"Internal notes about this recipient"})]})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>H(!1),children:"Cancel"}),p.jsx("button",{type:"submit",className:"btn-primary",children:"Add Email"})]})]})]})})]})}function RU({company:t,onShowToast:e}){const[r,a]=ke.useState(!1),[n,i]=ke.useState(!1),[o,c]=ke.useState(""),[u,h]=ke.useState(""),[d,v]=ke.useState(""),[y,g]=ke.useState("");ke.useEffect(()=>{t&&b()},[t]);const b=async()=>{a(!0);try{const{data:T,error:R}=await Re.from("companies").select("field_code, office_pin").eq("id",t.id).single();if(R)throw R;c(T.field_code||"Not set"),h(T.office_pin||"Not set"),v(T.field_code||""),g(T.office_pin||"")}catch(T){console.error("Error loading codes:",T),e("Error loading company codes","error")}finally{a(!1)}},w=async()=>{if(!d.trim()||!y.trim()){e("Field Code and Office PIN are required","error");return}a(!0);try{const{data:T}=await Re.from("companies").select("id").eq("field_code",d.trim().toUpperCase()).neq("id",t.id).single();if(T){e("This Field Code is already in use by another company","error"),a(!1);return}const{data:R}=await Re.from("companies").select("id").eq("office_pin",y.trim()).neq("id",t.id).single();if(R){e("This Office PIN is already in use by another company","error"),a(!1);return}const{error:H}=await Re.from("companies").update({field_code:d.trim().toUpperCase(),office_pin:y.trim()}).eq("id",t.id);if(H)throw H;c(d.trim().toUpperCase()),h(y.trim()),i(!1),e("Company codes updated successfully!","success")}catch(T){console.error("Error updating codes:",T),e("Error updating company codes","error")}finally{a(!1)}},E=()=>{v(o),g(u),i(!1)},A=()=>{const T=t.name.toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,10);v(T)},O=()=>{const T=Math.floor(1e3+Math.random()*9e3).toString();g(T)};return r&&!n?p.jsx("div",{className:"settings-container",children:p.jsx("div",{className:"spinner"})}):p.jsxs("div",{className:"settings-container",children:[p.jsxs("div",{className:"settings-header",children:[p.jsx("h1",{children:"Company Settings"}),p.jsx("p",{className:"settings-subtitle",children:"Manage your company's access codes for field workers and office staff"})]}),p.jsxs("div",{className:"settings-card",children:[p.jsxs("div",{className:"settings-section",children:[p.jsxs("div",{className:"settings-section-header",children:[p.jsx("h2",{children:"Access Codes"}),!n&&p.jsx("button",{className:"btn-secondary",onClick:()=>i(!0),children:"Edit Codes"})]}),p.jsxs("div",{className:"settings-codes",children:[p.jsxs("div",{className:"code-item",children:[p.jsxs("div",{className:"code-label",children:[p.jsx("span",{className:"code-icon",children:""}),p.jsxs("div",{children:[p.jsx("h3",{children:"Field Code"}),p.jsx("p",{children:"Foremen use this to access projects"})]})]}),n?p.jsxs("div",{className:"code-edit",children:[p.jsx("input",{type:"text",value:d,onChange:T=>v(T.target.value.toUpperCase()),placeholder:"e.g., GGG2024",disabled:r,style:{textTransform:"uppercase"}}),p.jsx("button",{className:"btn-secondary",onClick:A,disabled:r,children:"Generate"})]}):p.jsx("div",{className:"code-value",children:o})]}),p.jsxs("div",{className:"code-item",children:[p.jsxs("div",{className:"code-label",children:[p.jsx("span",{className:"code-icon",children:""}),p.jsxs("div",{children:[p.jsx("h3",{children:"Office PIN"}),p.jsx("p",{children:"Office staff need this to create accounts"})]})]}),n?p.jsxs("div",{className:"code-edit",children:[p.jsx("input",{type:"text",value:y,onChange:T=>g(T.target.value),placeholder:"e.g., 8765",maxLength:6,disabled:r}),p.jsx("button",{className:"btn-secondary",onClick:O,disabled:r,children:"Generate"})]}):p.jsx("div",{className:"code-value",children:u})]})]}),n&&p.jsxs("div",{className:"settings-actions",children:[p.jsx("button",{className:"btn-secondary",onClick:E,disabled:r,children:"Cancel"}),p.jsx("button",{className:"btn-primary",onClick:w,disabled:r,children:r?"Saving...":"Save Changes"})]})]}),p.jsxs("div",{className:"settings-info",children:[p.jsx("h3",{children:" Important"}),p.jsxs("ul",{children:[p.jsxs("li",{children:[p.jsx("strong",{children:"Field Code"})," - Share this with your foremen so they can access project sites"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Office PIN"})," - Share this with office staff so they can create accounts"]}),p.jsx("li",{children:"Changing these codes will require everyone to use the new codes for access"}),p.jsx("li",{children:"Keep these codes secure and only share with trusted team members"})]})]})]})]})}function LU({company:t,currentUser:e,onShowToast:r}){const[a,n]=ke.useState([]),[i,o]=ke.useState(!0);ke.useEffect(()=>{c()},[t?.id]);const c=async()=>{if(t?.id)try{o(!0);const d=await jt.getCompanyUsers(t.id);n(d||[])}catch(d){console.error("Error loading users:",d),r?.("Failed to load users","error")}finally{o(!1)}},u=async(d,v)=>{if(d===e.id&&v!=="admin"){r?.("You cannot change your own role","error");return}try{const y=await jt.updateUserRole(d,v);y.success?(r?.(`User role updated to ${v}`,"success"),await c()):r?.(y.error||"Failed to update user role","error")}catch(y){console.error("Error updating role:",y),r?.("Failed to update user role","error")}},h=d=>{switch(d){case"admin":return"role-badge role-admin";case"office":return"role-badge role-office";case"foreman":return"role-badge role-foreman";default:return"role-badge"}};return i?p.jsxs("div",{className:"settings-loading",children:[p.jsx("div",{className:"spinner"}),p.jsx("p",{children:"Loading users..."})]}):p.jsxs("div",{className:"user-management",children:[p.jsxs("div",{className:"settings-header",children:[p.jsx("h2",{children:" User Management"}),p.jsx("p",{className:"help-text",children:"Manage user roles and permissions"})]}),p.jsxs("div",{className:"settings-section",children:[p.jsx("h3",{children:"Company Users"}),p.jsx("div",{className:"user-list",children:p.jsxs("table",{className:"user-table",children:[p.jsx("thead",{children:p.jsxs("tr",{children:[p.jsx("th",{children:"Name"}),p.jsx("th",{children:"Email"}),p.jsx("th",{children:"Role"}),p.jsx("th",{children:"Actions"})]})}),p.jsx("tbody",{children:a.map(d=>p.jsxs("tr",{children:[p.jsxs("td",{children:[d.name||"Unnamed User",d.id===e.id&&p.jsx("span",{className:"badge-you",children:" (You)"})]}),p.jsx("td",{children:d.email}),p.jsx("td",{children:p.jsx("span",{className:h(d.role),children:d.role})}),p.jsx("td",{children:p.jsxs("select",{className:"role-select",value:d.role,onChange:v=>u(d.id,v.target.value),disabled:d.id===e.id,children:[p.jsx("option",{value:"admin",children:"Admin"}),p.jsx("option",{value:"office",children:"Office"}),p.jsx("option",{value:"foreman",children:"Foreman"})]})})]},d.id))})]})}),p.jsxs("div",{className:"role-info",children:[p.jsx("h4",{children:"Role Permissions"}),p.jsxs("ul",{children:[p.jsxs("li",{children:[p.jsx("strong",{children:"Admin:"})," Full access to all features including company settings, branding, and user management"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Office:"})," Can manage projects, T&M tickets, and view reports. Cannot access company settings or branding"]}),p.jsxs("li",{children:[p.jsx("strong",{children:"Foreman:"})," Field access only - can log work, submit T&M, and communicate with office"]})]})]})]})]})}function DU({user:t,currentCompany:e,onCompanyChange:r,onShowToast:a}){const[n,i]=ke.useState([]),[o,c]=ke.useState(!0),[u,h]=ke.useState(!1);ke.useEffect(()=>{t?.id&&d()},[t?.id]);const d=async()=>{try{const y=await jt.getUserCompanies(t.id);console.log("Loaded companies:",y),i(Array.isArray(y)?y:[])}catch(y){console.error("Error loading companies:",y),a?.("Error loading companies","error"),i([])}finally{c(!1)}},v=y=>{if(y.id===e?.id){h(!1);return}r(y),h(!1),a?.(`Switched to ${y.name}`,"success")};return o||n.length<=1?null:p.jsxs("div",{className:"company-switcher",children:[p.jsxs("button",{className:"company-switcher-btn",onClick:()=>h(!u),title:"Switch company",children:[p.jsx("span",{className:"company-switcher-name",children:e?.name}),p.jsx("span",{className:"company-switcher-arrow",children:u?"":""})]}),u&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"company-switcher-overlay",onClick:()=>h(!1)}),p.jsx("div",{className:"company-switcher-dropdown",children:n.length===0?p.jsx("div",{className:"company-switcher-empty",children:"No companies found"}):n.map(y=>{if(!y?.id)return console.warn("Invalid company object:",y),null;const g=y.id===e?.id;return p.jsxs("button",{className:`company-switcher-item ${g?"active":""}`,onClick:()=>v(y),disabled:g,children:[p.jsxs("div",{className:"company-switcher-item-info",children:[p.jsx("span",{className:"company-switcher-item-name",children:y.name||"Unknown"}),y.field_code&&p.jsx("span",{className:"company-switcher-item-code",children:y.field_code})]}),g&&p.jsx("span",{className:"company-switcher-check",children:""})]},y.id)})})]})]})}function PU({user:t,onShowToast:e}){const[r,a]=ke.useState([]),[n,i]=ke.useState(0),[o,c]=ke.useState(!1),[u,h]=ke.useState(!0);ke.useEffect(()=>{if(t?.id){d();const b=setInterval(d,3e4);return()=>clearInterval(b)}},[t?.id]);const d=async()=>{if(t?.id)try{const b=await jt.getUnreadNotifications(t.id,10);a(b),i(b.length)}catch(b){console.error("Error loading notifications:",b)}finally{h(!1)}},v=async b=>{try{await jt.markNotificationRead(b),a(r.filter(w=>w.id!==b)),i(w=>Math.max(0,w-1))}catch(w){console.error("Error marking notification as read:",w),e?.("Error marking notification as read","error")}},y=async()=>{try{await jt.markAllNotificationsRead(t.id),a([]),i(0),e?.("All notifications marked as read","success")}catch(b){console.error("Error marking all as read:",b),e?.("Error marking notifications as read","error")}},g=b=>{const w=new Date(b),A=Math.floor((new Date-w)/1e3);if(A<60)return"just now";const O=Math.floor(A/60);if(O<60)return`${O}m ago`;const T=Math.floor(O/60);return T<24?`${T}h ago`:`${Math.floor(T/24)}d ago`};return p.jsxs("div",{className:"notification-bell-container",children:[p.jsxs("button",{className:"notification-bell-button",onClick:()=>c(!o),title:"Notifications",children:["",n>0&&p.jsx("span",{className:"notification-badge",children:n>9?"9+":n})]}),o&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"notification-dropdown-overlay",onClick:()=>c(!1)}),p.jsxs("div",{className:"notification-dropdown",children:[p.jsxs("div",{className:"notification-dropdown-header",children:[p.jsx("h3",{children:"Notifications"}),n>0&&p.jsx("button",{className:"notification-mark-all-read",onClick:y,children:"Mark all read"})]}),p.jsx("div",{className:"notification-list",children:u?p.jsxs("div",{className:"notification-loading",children:[p.jsx("div",{className:"spinner"}),p.jsx("p",{children:"Loading..."})]}):r.length===0?p.jsxs("div",{className:"notification-empty",children:[p.jsx("p",{children:" All caught up!"}),p.jsx("span",{children:"No new notifications"})]}):r.map(b=>p.jsxs("div",{className:"notification-item",children:[p.jsxs("div",{className:"notification-content",children:[p.jsx("div",{className:"notification-title",children:b.title}),p.jsx("div",{className:"notification-message",children:b.message}),p.jsx("div",{className:"notification-time",children:g(b.created_at)})]}),p.jsx("button",{className:"notification-dismiss",onClick:()=>v(b.id),title:"Mark as read",children:""})]},b.id))})]})]})]})}function MU({shareToken:t}){const[e,r]=ke.useState(!0),[a,n]=ke.useState(null),[i,o]=ke.useState(null),[c,u]=ke.useState(0),{branding:h}=a2();ke.useEffect(()=>{d()},[t]);const d=async()=>{r(!0),n(null);try{const R=await jt.getPublicProjectData(t);if(!R){n("This share link is invalid or has expired.");return}o(R)}catch(R){console.error("Error loading public data:",R),n("Failed to load project data.")}finally{r(!1)}},v=R=>R?new Date(R).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",y=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(R);if(e)return p.jsxs("div",{className:"public-view",children:[p.jsxs("div",{className:"loading-container",children:[p.jsx("div",{className:"spinner"}),p.jsx("p",{children:"Loading project..."})]}),p.jsx("style",{children:av})]});if(a)return p.jsxs("div",{className:"public-view",children:[p.jsxs("div",{className:"error-container",children:[p.jsx("div",{className:"error-icon",children:""}),p.jsx("h2",{children:a}),p.jsx("p",{children:"Please contact the project owner for a valid link."})]}),p.jsx("style",{children:av})]});const{share:g,project:b,progress:w,areas:E,photos:A,dailyReports:O,tmTickets:T}=i;return p.jsxs("div",{className:"public-view",children:[p.jsx("header",{className:"public-header",children:p.jsxs("div",{className:"container",children:[p.jsx(Kc,{size:"large"}),p.jsx("div",{className:"header-meta",children:p.jsxs("span",{className:"last-updated",children:["Last updated: ",v(b.updated_at||b.created_at)]})})]})}),p.jsx("main",{className:"public-main",children:p.jsxs("div",{className:"container",children:[p.jsxs("div",{className:"project-header",children:[p.jsx("h1",{children:b.name}),b.address&&p.jsx("p",{className:"project-address",children:b.address})]}),g.permissions.progress&&p.jsxs("div",{className:"public-card progress-card",children:[p.jsx("h2",{children:"Project Progress"}),p.jsxs("div",{className:"progress-visual",children:[p.jsxs("div",{className:"progress-circle",children:[p.jsxs("svg",{viewBox:"0 0 100 100",children:[p.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),p.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"var(--primary-color, #3b82f6)",strokeWidth:"8",strokeDasharray:`${w*2.827} 282.7`,strokeLinecap:"round",transform:"rotate(-90 50 50)"})]}),p.jsxs("div",{className:"progress-percentage",children:[w,"%"]})]}),p.jsxs("div",{className:"progress-details",children:[p.jsx("div",{className:"progress-label",children:"Complete"}),E&&E.length>0&&p.jsxs("div",{className:"areas-summary",children:[E.filter(R=>R.status==="done").length," of ",E.length," areas completed"]})]})]}),E&&E.length>0&&p.jsxs("div",{className:"areas-list",children:[p.jsx("h3",{children:"Work Areas"}),E.map(R=>p.jsxs("div",{className:"area-item",children:[p.jsxs("div",{className:"area-info",children:[p.jsx("span",{className:"area-name",children:R.name}),p.jsxs("span",{className:"area-weight",children:[R.weight,"%"]})]}),p.jsx("div",{className:`area-status status-${R.status}`,children:R.status==="done"?" Complete":R.status==="working"?" In Progress":" Not Started"})]},R.id))]})]}),g.permissions.photos&&A&&A.length>0&&p.jsxs("div",{className:"public-card photos-card",children:[p.jsx("h2",{children:"Recent Photos"}),p.jsxs("div",{className:"photos-carousel",children:[p.jsxs("div",{className:"carousel-main",children:[A[c]&&p.jsx("img",{src:A[c].url,alt:`Project photo from ${v(A[c].date)}`,className:"carousel-image"}),p.jsx("div",{className:"carousel-date",children:v(A[c]?.date)})]}),p.jsx("div",{className:"carousel-thumbnails",children:A.slice(0,10).map((R,H)=>p.jsx("div",{className:`thumbnail ${H===c?"active":""}`,onClick:()=>u(H),children:p.jsx("img",{src:R.url,alt:`Thumbnail ${H+1}`})},H))}),A.length>1&&p.jsxs("div",{className:"carousel-controls",children:[p.jsx("button",{onClick:()=>u(R=>R>0?R-1:A.length-1),className:"carousel-btn",children:""}),p.jsxs("span",{className:"carousel-counter",children:[c+1," / ",A.length]}),p.jsx("button",{onClick:()=>u(R=>R<A.length-1?R+1:0),className:"carousel-btn",children:""})]})]})]}),g.permissions.daily_reports&&O&&O.length>0&&p.jsxs("div",{className:"public-card reports-card",children:[p.jsx("h2",{children:"Daily Reports"}),p.jsx("div",{className:"reports-list",children:O.map((R,H)=>p.jsxs("div",{className:"report-item",children:[p.jsx("div",{className:"report-date",children:v(R.report_date)}),p.jsxs("div",{className:"report-content",children:[R.crew_count&&p.jsxs("div",{className:"report-field",children:[p.jsx("strong",{children:"Crew:"})," ",R.crew_count," workers"]}),R.tasks_completed&&p.jsxs("div",{className:"report-field",children:[p.jsx("strong",{children:"Tasks Completed:"})," ",R.tasks_completed]}),R.weather&&p.jsxs("div",{className:"report-field",children:[p.jsx("strong",{children:"Weather:"})," ",R.weather]}),R.notes&&p.jsxs("div",{className:"report-field",children:[p.jsx("strong",{children:"Notes:"})," ",R.notes]})]})]},H))})]}),g.permissions.tm_tickets&&T&&T.length>0&&p.jsxs("div",{className:"public-card tm-card",children:[p.jsx("h2",{children:"Time & Materials Tickets"}),p.jsx("div",{className:"tm-list",children:T.map((R,H)=>p.jsxs("div",{className:"tm-item",children:[p.jsxs("div",{className:"tm-header",children:[p.jsx("span",{className:"tm-date",children:v(R.work_date)}),p.jsx("span",{className:`tm-status status-${R.status}`,children:R.status})]}),R.description&&p.jsx("div",{className:"tm-description",children:R.description}),R.total_amount&&p.jsxs("div",{className:"tm-amount",children:["Total: ",y(R.total_amount)]})]},H))})]})]})}),p.jsx("footer",{className:"public-footer",children:p.jsx("div",{className:"container",children:!h?.hide_fieldsync_branding&&p.jsx("p",{children:"Powered by FieldSync"})})}),p.jsx("style",{children:av})]})}const av=`
  .public-view {
    min-height: 100vh;
    background-color: #f9fafb;
    display: flex;
    flex-direction: column;
  }

  .container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 1rem;
    width: 100%;
  }

  /* Header */
  .public-header {
    background-color: white;
    border-bottom: 1px solid #e5e7eb;
    padding: 1.5rem 0;
  }

  .public-header .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .header-meta {
    font-size: 0.875rem;
    color: #6b7280;
  }

  /* Main Content */
  .public-main {
    flex: 1;
    padding: 2rem 0;
  }

  .project-header {
    margin-bottom: 2rem;
  }

  .project-header h1 {
    font-size: 2rem;
    margin: 0 0 0.5rem 0;
    color: #111827;
  }

  .project-address {
    font-size: 1rem;
    color: #6b7280;
    margin: 0;
  }

  /* Cards */
  .public-card {
    background-color: white;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .public-card h2 {
    font-size: 1.5rem;
    margin: 0 0 1.5rem 0;
    color: #111827;
  }

  .public-card h3 {
    font-size: 1.125rem;
    margin: 1.5rem 0 1rem 0;
    color: #374151;
  }

  /* Progress Card */
  .progress-visual {
    display: flex;
    align-items: center;
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .progress-circle {
    position: relative;
    width: 150px;
    height: 150px;
    flex-shrink: 0;
  }

  .progress-circle svg {
    width: 100%;
    height: 100%;
  }

  .progress-percentage {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2rem;
    font-weight: bold;
    color: var(--primary-color, #3b82f6);
  }

  .progress-details {
    flex: 1;
  }

  .progress-label {
    font-size: 1.25rem;
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.5rem;
  }

  .areas-summary {
    font-size: 1rem;
    color: #6b7280;
  }

  /* Areas List */
  .areas-list {
    border-top: 1px solid #e5e7eb;
    padding-top: 1rem;
  }

  .area-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 0;
    border-bottom: 1px solid #f3f4f6;
  }

  .area-item:last-child {
    border-bottom: none;
  }

  .area-info {
    flex: 1;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-right: 1rem;
  }

  .area-name {
    font-weight: 500;
    color: #374151;
  }

  .area-weight {
    color: #6b7280;
    font-size: 0.875rem;
  }

  .area-status {
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    white-space: nowrap;
  }

  .area-status.status-done {
    background-color: #d1fae5;
    color: #065f46;
  }

  .area-status.status-working {
    background-color: #fef3c7;
    color: #92400e;
  }

  .area-status.status-not_started {
    background-color: #f3f4f6;
    color: #6b7280;
  }

  /* Photos Carousel */
  .photos-carousel {
    position: relative;
  }

  .carousel-main {
    position: relative;
    width: 100%;
    height: 400px;
    background-color: #111827;
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 1rem;
  }

  .carousel-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }

  .carousel-date {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
    color: white;
    padding: 1rem;
    text-align: center;
  }

  .carousel-thumbnails {
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
  }

  .thumbnail {
    flex-shrink: 0;
    width: 80px;
    height: 80px;
    border-radius: 4px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: border-color 0.2s;
  }

  .thumbnail:hover {
    border-color: #d1d5db;
  }

  .thumbnail.active {
    border-color: var(--primary-color, #3b82f6);
  }

  .thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .carousel-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
  }

  .carousel-btn {
    background-color: white;
    border: 1px solid #d1d5db;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.25rem;
    transition: background-color 0.2s;
  }

  .carousel-btn:hover {
    background-color: #f3f4f6;
  }

  .carousel-counter {
    font-size: 0.875rem;
    color: #6b7280;
  }

  /* Daily Reports */
  .reports-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .report-item {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1rem;
  }

  .report-date {
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.75rem;
    font-size: 1.125rem;
  }

  .report-content {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .report-field {
    color: #374151;
    line-height: 1.5;
  }

  .report-field strong {
    color: #111827;
  }

  /* T&M Tickets */
  .tm-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .tm-item {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1rem;
  }

  .tm-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
  }

  .tm-date {
    font-weight: 600;
    color: #111827;
  }

  .tm-status {
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    text-transform: capitalize;
  }

  .tm-status.status-approved {
    background-color: #d1fae5;
    color: #065f46;
  }

  .tm-status.status-pending {
    background-color: #fef3c7;
    color: #92400e;
  }

  .tm-status.status-rejected {
    background-color: #fee2e2;
    color: #991b1b;
  }

  .tm-description {
    color: #374151;
    margin-bottom: 0.5rem;
  }

  .tm-amount {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--primary-color, #3b82f6);
  }

  /* Footer */
  .public-footer {
    background-color: white;
    border-top: 1px solid #e5e7eb;
    padding: 2rem 0;
    margin-top: auto;
  }

  .public-footer p {
    text-align: center;
    color: #6b7280;
    margin: 0;
    font-size: 0.875rem;
  }

  /* Loading & Error States */
  .loading-container,
  .error-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 2rem;
  }

  .spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #e5e7eb;
    border-top-color: var(--primary-color, #3b82f6);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .loading-container p {
    margin-top: 1rem;
    color: #6b7280;
  }

  .error-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
  }

  .error-container h2 {
    color: #111827;
    margin: 0 0 0.5rem 0;
  }

  .error-container p {
    color: #6b7280;
    margin: 0;
  }

  /* Mobile Responsive */
  @media (max-width: 768px) {
    .project-header h1 {
      font-size: 1.5rem;
    }

    .public-card {
      padding: 1.5rem;
    }

    .progress-visual {
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .progress-circle {
      width: 120px;
      height: 120px;
    }

    .progress-percentage {
      font-size: 1.5rem;
    }

    .carousel-main {
      height: 300px;
    }

    .area-item {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }

    .area-info {
      width: 100%;
      margin-right: 0;
    }
  }
`;function IU(){const[t,e]=ke.useState("entry"),[r,a]=ke.useState(null),[n,i]=ke.useState(null),[o,c]=ke.useState(null),[u,h]=ke.useState(null),[d,v]=ke.useState(!0),[y,g]=ke.useState("dashboard"),[b,w]=ke.useState(null);ke.useEffect(()=>{const D=window.location.pathname.match(/^\/view\/([a-zA-Z0-9]+)$/);D?(h(D[1]),e("public"),v(!1)):E()},[]);const E=async()=>{try{const{data:{user:W}}=await Re.auth.getUser();if(!W){v(!1);return}const{data:D,error:Y}=await Re.from("users").select("id, email, name, role, company_id, created_at, updated_at").eq("id",W.id).single();if(Y||!D){console.error("Auth check error:",Y),v(!1);return}const{data:I,error:L}=await Re.from("companies").select("*").eq("id",D.company_id).single();!L&&I&&(a(D),i(I),e("office"))}catch(W){console.error("Auth check error:",W)}finally{v(!1)}},A=W=>{c(W),e("foreman")},O=(W,D)=>{console.log("handleOfficeLogin called with:",{userData:W,companyData:D}),a(W),i(D),e("office")},T=async W=>{i(W),g("dashboard")},R=async()=>{try{await MN.signOut(),a(null),i(null),e("entry"),g("dashboard")}catch(W){console.error("Logout error:",W),z("Error signing out","error")}},H=()=>{c(null),e("entry")},z=(W,D="")=>{w({message:W,type:D})},F=()=>{g("dashboard")};return d?p.jsx(F0,{companyId:n?.id,children:p.jsxs("div",{className:"loading-screen",children:[p.jsx(Kc,{className:"loading-logo"}),p.jsx("div",{className:"spinner"})]})}):t==="entry"?p.jsxs(F0,{children:[p.jsx(qN,{onForemanAccess:A,onOfficeLogin:O,onShowToast:z}),b&&p.jsx(Yu,{message:b.message,type:b.type,onClose:()=>w(null)})]}):t==="public"&&u?p.jsxs(F0,{children:[p.jsx(MU,{shareToken:u}),b&&p.jsx(Yu,{message:b.message,type:b.type,onClose:()=>w(null)})]}):t==="foreman"&&o?p.jsxs(F0,{companyId:o.company_id,children:[p.jsx(EU,{project:o,companyId:o.company_id,onShowToast:z,onExit:H}),b&&p.jsx(Yu,{message:b.message,type:b.type,onClose:()=>w(null)})]}):p.jsx(F0,{companyId:n?.id,children:p.jsxs("div",{children:[!Ke&&p.jsx("div",{className:"demo-banner",children:"Demo Mode - Data saved locally in your browser"}),p.jsx("nav",{className:"nav",children:p.jsxs("div",{className:"nav-content",children:[p.jsx(Kc,{}),p.jsxs("div",{className:"nav-tabs",children:[p.jsx("button",{className:`nav-tab ${y==="dashboard"?"active":""}`,onClick:()=>g("dashboard"),children:"Dashboard"}),p.jsx("button",{className:`nav-tab ${y==="setup"?"active":""}`,onClick:()=>g("setup"),children:"+ New Project"}),r?.role==="admin"&&p.jsxs(p.Fragment,{children:[p.jsx("button",{className:`nav-tab ${y==="company"?"active":""}`,onClick:()=>g("company"),children:"Company"}),p.jsx("button",{className:`nav-tab ${y==="branding"?"active":""}`,onClick:()=>g("branding"),children:"Branding"}),p.jsx("button",{className:`nav-tab ${y==="users"?"active":""}`,onClick:()=>g("users"),children:"Users"})]}),p.jsx("button",{className:`nav-tab ${y==="notifications"?"active":""}`,onClick:()=>g("notifications"),children:"Notifications"})]}),p.jsxs("div",{className:"nav-user",children:[p.jsx(DU,{user:r,currentCompany:n,onCompanyChange:T,onShowToast:z}),p.jsx(PU,{user:r,onShowToast:z}),p.jsx("span",{className:"nav-user-name",children:r?.name||r?.email}),p.jsx("button",{className:"nav-logout",onClick:R,children:"Sign Out"})]})]})}),p.jsxs("div",{className:"container",children:[y==="dashboard"&&p.jsx(jU,{company:n,onShowToast:z}),y==="setup"&&p.jsx(CU,{company:n,onProjectCreated:F,onShowToast:z}),y==="company"&&r?.role==="admin"&&p.jsx(RU,{company:n,onShowToast:z}),y==="branding"&&r?.role==="admin"&&p.jsx(OU,{company:n,onShowToast:z}),y==="users"&&r?.role==="admin"&&p.jsx(LU,{company:n,currentUser:r,onShowToast:z}),y==="notifications"&&p.jsx(FU,{company:n,user:r,onShowToast:z})]}),b&&p.jsx(Yu,{message:b.message,type:b.type,onClose:()=>w(null)})]})})}fA.createRoot(document.getElementById("root")).render(p.jsx(aA.StrictMode,{children:p.jsx(IU,{})}));export{ua as _,BU as c,$v as g};
