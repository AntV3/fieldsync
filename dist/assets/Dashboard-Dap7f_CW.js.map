{"version":3,"mappings":"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A;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA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","names":["_extends","n","e","t","r","ownKeys","o","_objectSpread","_defineProperty","_toPropertyKey","i","_toPrimitive","SIZE","defaultLegendContentDefaultProps","Icon","_ref","data","iconType","inactiveColor","halfSize","sixthSize","thirdSize","color","preferredIcon","_data$payload","React.createElement","React.isValidElement","iconProps","React.cloneElement","Symbols","Items","props","payload","iconSize","layout","formatter","viewBox","itemStyle","svgStyle","entry","finalFormatter","className","clsx","finalValue","adaptEventsOfChild","Surface","DefaultLegendContent","outsideProps","resolveDefaultProps","align","finalStyle","useLegendPayload","useAppSelector","selectLegendPayload","_excluded","_objectWithoutProperties","_objectWithoutPropertiesLoose","defaultUniqBy","LegendContent","contextPayload","otherProps","finalPayload","getUniqPayload","contentProps","getDefaultPosition","style","margin","chartWidth","chartHeight","box","verticalAlign","hPos","vPos","LegendSettingsDispatcher","dispatch","useAppDispatch","useEffect","setLegendSettings","LegendSizeDispatcher","setLegendSize","getWidthOrHeight","height","width","maxWidth","isNumber","legendDefaultProps","Legend","legendPortalFromContext","useLegendPortal","useMargin","widthFromProps","heightFromProps","wrapperStyle","portalFromProps","lastBoundingBox","updateBoundingBox","useElementOffset","useChartWidth","useChartHeight","widthOrHeight","outerStyle","legendPortal","legendElement","createPortal","renderLine","option","line","isWellBehavedNumber","getHorizontalLineEndPoints","yCoord","ifOverflow","position","yAxisOrientation","scales","x","coord","isNan","points","getVerticalLineEndPoints","xCoord","xAxisOrientation","y","getSegmentLineEndPoints","segment","p","getEndPoints","isFixedX","isNumOrStr","isFixedY","ReportReferenceLine","addLine","removeLine","ReferenceLineImpl","xAxisId","yAxisId","shape","isPanorama","useIsPanorama","clipPathId","useClipPathId","xAxis","state","selectXAxisSettings","yAxis","selectYAxisSettings","xAxisScale","selectAxisScale","yAxisScale","useViewBox","createLabeledScales","endPoints","x1","y1","x2","y2","clipPath","lineProps","svgPropertiesAndEvents","rect","rectWithCoords","ZIndexLayer","Layer","CartesianLabelContextProvider","CartesianLabelFromLabelProp","referenceLineDefaultProps","DefaultZIndexes","ReferenceLine","React.Fragment","selectXAxisWithScale","graphicalItemId","selectAxisWithScale","selectXAxisIdFromGraphicalItemId","selectXAxisTicks","selectTicksOfGraphicalItem","selectYAxisWithScale","selectYAxisIdFromGraphicalItemId","selectYAxisTicks","selectBandSize","createSelector","selectChartLayout","xAxisTicks","yAxisTicks","isCategoricalAxis","getBandSizeOfAxis","pickAreaId","_state","id","selectSynchronisedAreaSettings","selectUnfilteredCartesianItems","graphicalItems","item","selectNumericalAxisType","isXAxisCategorical","selectNumericalAxisIdFromGraphicalItemId","axisType","selectNumericalAxisStackGroups","selectStackGroups","selectGraphicalItemStackedData","areaSettings","stackGroups","_stackGroups$stackId","stackId","stackSeriesIdentifier","getStackSeriesIdentifier","groups","found","v","selectArea","selectChartDataWithIndexesIfNotInPanoramaPosition3","selectChartBaseValue","stackedData","bandSize","chartBaseValue","chartData","dataStartIndex","dataEndIndex","displayedData","computeArea","_excluded2","getLegendItemColor","stroke","fill","computeLegendPayloadFromAreaData","dataKey","name","legendType","hide","getTooltipNameProp","SetAreaTooltipEntrySettings","React.memo","strokeWidth","unit","tooltipType","tooltipEntrySettings","SetTooltipEntrySettings","AreaDotsWrapper","_ref2","needClip","dot","areaProps","svgPropertiesNoEvents","Dots","AreaLabelListProvider","_ref3","showLabels","children","labelListEntries","point","_point$x","_point$y","CartesianLabelListContextProvider","StaticArea","_ref4","baseLine","type","connectNulls","isRange","propsWithoutId","allOtherProps","propsWithEvents","Curve","VerticalRect","_ref5","_points$","_points","alpha","startY","endY","maxX","HorizontalRect","_ref6","_points$2","_points2","startX","endX","maxY","ClipRect","_ref7","AreaWithAnimation","_ref8","previousPointsRef","previousBaselineRef","isAnimationActive","animationBegin","animationDuration","animationEasing","onAnimationStart","onAnimationEnd","animationInput","useMemo","animationId","useAnimationId","useCartesianChartLayout","isAnimating","setIsAnimating","useState","handleAnimationEnd","useCallback","handleAnimationStart","prevPoints","prevBaseLine","JavascriptAnimate","prevPointsDiffFactor","stepPoints","index","prevPointIndex","prev","interpolate","stepBaseLine","isNullish","LabelListFromLabelProp","RenderArea","_ref9","useRef","AreaWithState","PureComponent","top","left","zIndex","layerClass","getRadiusAndStrokeWidthFromDot","clipDot","isClipDot","dotSize","activePointsClipPath","GraphicalItemClipPath","ActivePoints","defaultAreaProps","AreaImpl","_useAppSelector","_resolveDefaultProps","activeDot","fillOpacity","everythingElse","useChartLayout","chartName","useChartName","useNeedsClip","plotArea","usePlotArea","Global","getBaseValue","itemBaseValue","baseValue","numericAxis","domain","domainMax","domainMin","_ref0","hasStack","isHorizontalLayout","_valueAsArray$","_valueAsArray","valueAsArray","rawValue","getValueByDataKey","value1","isBreakPoint","getCateCoordinateOfLine","AreaFn","RegisterGraphicalItemId","SetLegendPayload","SetCartesianGraphicalItem","getNormalizedStackId","Area","propsAreEqual","allowedTooltipTypes","AreaChart","forwardRef","ref","CartesianChart","arrayTooltipSearcher","ErrorSeverity","ErrorCategory","categorizeError","error","message","code","getUserMessage","category","context","handleError","options","operation","severity","showToast","userMessage","companyId","projectId","userId","silent","rethrow","observe","toastType","safeAsync","fn","fallback","DEFAULT_THRESHOLDS","FACTOR_WEIGHTS","calculateFactorScore","value","thresholds","range","getFactorStatus","score","calculateBudgetFactor","totalCosts","earnedRevenue","ratio","status","label","calculateScheduleFactor","actualProgress","expectedProgress","variance","absVariance","calculateCORExposureFactor","pendingCORValue","contractValue","exposure","formatNumber","calculateActivityFactor","lastReportDate","lastDate","daysSince","calculateSafetyFactor","injuryCount","count","calculateRiskScore","project","weights","budgetFactor","scheduleFactor","corFactor","activityFactor","safetyFactor","compositeScore","overallStatus","summaryLabel","generateSmartAlerts","riskResult","alerts","factors","priorityOrder","a","b","calculateProjections","costPerPercent","estimatedCompletionCost","estimatedFinalMargin","estimatedCompletionDate","startDate","now","daysElapsed","progressPerDay","daysRemaining","num","usePortfolioMetrics","projectsData","portfolioMetrics","totalOriginalContract","sum","totalChangeOrders","totalPortfolioValue","totalEarned","totalRemaining","weightedCompletion","totalPendingCORValue","totalPendingCORCount","projectHealth","complete","onTrack","atRisk","overBudget","withChangeOrders","contractVal","scheduleMetrics","ahead","behind","overLabor","underLabor","onTrackLabor","riskAnalysis","projectRisks","riskInput","projections","alertsWithProject","allAlerts","priority","useProjectEdit","selectedProject","areas","company","onShowToast","loadAreas","setSelectedProject","editMode","setEditMode","editData","setEditData","saving","setSaving","field","area","db","validAreas","existingAreaIds","editAreaIds","areaId","updatedProject","loadProjects","loadJsPDF","__vitePreload","PAGE_WIDTH","MARGIN","CONTENT_WIDTH","formatDate","dateStr","checkPage","doc","needed","exportDailyReportsPDF","reports","jsPDF","report","idx","statusText","metrics","crewNames","w","crewLines","noteLines","issueLines","fileName","exportIncidentReportsPDF","typeLabel","lines","exportCrewCheckinsPDF","checkins","checkin","workers","exportAllFieldDocumentsPDF","dailyReports","incidentReports","crewCheckins","workerList","downloadFile","content","filename","mimeType","blob","url","escapeCSV","str","toCSV","headers","rows","headerLine","h","dataLines","row","exportProjectFinancials","financialData","d","c","totalRevenue","s","csv","exportCORDetail","cor","regHrs","otHrs","exportTMTicketsCSV","tickets","items","totalHours","otHours","materialsCost","exportToQuickBooksIIF","txnDate","safeName","totalLabor","totalDisposal","UniversalSearch","isOpen","onClose","onSelectProject","onSelectTicket","onSelectCOR","query","setQuery","results","setResults","loading","setLoading","selectedIndex","setSelectedIndex","inputRef","searchTimeoutRef","focusTimeoutRef","performSearch","searchQuery","searchResults","handleInputChange","allResults","all","hasResults","handleKeyDown","handleSelect","jsx","jsxs","Search","X","Fragment","FolderOpen","globalIdx","ChevronRight","FileText","ticket","ClipboardList","Users","worker","Command","useUniversalSearch","setIsOpen","SmartAlerts","onAction","onDismiss","maxVisible","dismissedIds","setDismissedIds","visibleAlerts","alert","handleDismiss","alertId","SmartAlertCard","title","description","action","actionTarget","projectName","XCircle","AlertTriangle","Info","handleAction","ArrowRight","OverviewProgressGauge","memo","progress","areasComplete","totalAreas","areasWorking","size","animatedProgress","setAnimatedProgress","animationRef","startValue","endValue","duration","startTime","animate","currentTime","elapsed","progressRatio","eased","current","radius","circumference","offset","getProgressColor","chartColors","animationConfig","tooltipStyle","costCategories","timeRanges","formatChartCurrency","formatChartDate","gradientDefs","OverviewFinancialCard","laborCost","disposalCost","equipmentCost","otherCost","profit","isPositive","formatCurrency","costBreakdown","hasBreakdown","widthPercent","CREW_COLORS","TIME_RANGES","OverviewCrewMetrics","crewHistory","setCrewHistory","tmTickets","setTmTickets","selectedDate","setSelectedDate","timeRange","setTimeRange","exporting","setExporting","loadData","history","tmWorkersByDate","map","date","crewByDate","selectedDayWorkers","selectedDayTmNames","todayMetrics","contract","tm","rangeDays","today","tmNames","contractCount","tmCount","changeDate","direction","isToday","handleBarClick","CustomTooltip","active","total","exportCrewPDF","pageWidth","day","footerY","Download","ChevronLeft","Calendar","HardHat","Wrench","ResponsiveContainer","BarChart","CartesianGrid","XAxis","YAxis","Tooltip","Bar","Skeleton","borderRadius","variant","variantStyles","showProgress","CardSkeleton","showHeader","showAction","_","showAvatar","TicketSkeleton","HeroMetricsSkeleton","ErrorState","onRetry","retryLabel","CustomIcon","WifiOff","RefreshCw","EmptyState","actionLabel","required","hint","AlertCircle","onChange","onBlur","placeholder","disabled","min","max","step","pattern","autoComplete","ariaLabel","ariaDescribedBy","inputId","errorId","selectId","maxLength","textareaId","CountBadge","pulse","prevCount","setPrevCount","animating","setAnimating","timer","MiniProgress","showLabel","animated","percentage","autoVariant","TrendIndicator","previousValue","format","inverted","showValue","diff","percentChange","TrendingUp","TrendingDown","Minus","formatValue","absChange","showArea","areaPoints","icons","Check","Clock","previous","delta","isNegative","val","showCloseButton","closeOnOverlayClick","closeOnEscape","footer","modalRef","previousActiveElement","titleId","originalOverflow","focusableElements","firstElement","lastElement","handleOverlayClick","sizeClasses","amount","MetricCard","formattedValue","subLabel","progressLabel","trend","variantColors","HeroMetrics","corApprovedValue","previousData","revisedContract","profitMargin","costRatio","revenueProgress","costProgress","profitVariant","costVariant","DollarSign","Receipt","PiggyBank","NAV_ITEMS","BarChart3","FinancialsNav","activeSection","onSectionChange","collapsed","onToggleCollapse","onMobileClose","stats","corCount","ticketCount","corPending","ticketPending","billableCount","invoiceCount","getBadge","itemId","PanelLeftOpen","isActive","badge","showConnector","buildFinancialTimeSeries","projectData","corStats","changeOrderValue","revisedContractValue","laborByDate","haulOffByDate","materialsEquipmentByDate","customCosts","dateSet","sortedDates","revenueByDate","totalWeight","completionDate","areaWeight","areaValue","tmByDate","ticketValue","regHours","regRate","otRate","qty","unitCost","customByDate","cost","materialsEquipmentByDateMap","hasAreaData","billable","totalCostForFallback","haulOffCost","materialsEquipmentCost","customCost","cumulativeCost","cumulativeTMValue","cumulativeRevenue","dailyTotalCost","tmDayValue","revenue","dailyRevenue","filterByTimeRange","days","cutoff","buildCostDistribution","segments","grouped","cat","catConfig","calculateTrend","key","recent","first","last","change","ChartTooltip","FinancialTrendChart","onDrillDown","hoveredLine","setHoveredLine","allData","selectedRange","costsTrend","revenueTrend","handleClick","TrendIcon","grad","CostDonut","onSegmentClick","activeIndex","setActiveIndex","totalCost","handleMouseEnter","handleMouseLeave","renderLegend","PieChart","Pie","Cell","ProfitabilityCard","currentProfit","currentMargin","projectedRevenue","projectedCosts","projectedProfit","projectedMargin","isHealthy","isWarning","isLoss","statusLabel","StatusIcon","CheckCircle","categoryInfo","Truck","Package","MoreHorizontal","CostContributorsCard","onAddCost","onDeleteCost","showChart","setShowChart","expandedCategory","setExpandedCategory","customByCategory","group","info","toggleCategory","handleSegmentClick","hasItems","isExpanded","ChevronUp","ChevronDown","Trash2","Plus","LOAD_TYPES","getLoadTypeInfo","DisposalSummary","period","loads","setLoads","expanded","setExpanded","err","loadsByType","acc","load","loadsByDate","totalLoads","l","hasLoads","formattedDate","dayLoadsByType","typeInfo","ProjectEquipmentCard","onAddEquipment","onEditEquipment","projectEquipment","setProjectEquipment","setTotalCost","loadEquipment","equipmentOps","handleMarkReturned","equipmentItem","handleDelete","activeEquipment","returnedEquipment","RotateCcw","Edit2","ProgressBillingCard","onCreateDraw","onViewDraw","drawRequests","setDrawRequests","originalContract","approvedCOs","loadDrawRequests","drawRequestOps","billingTotals","completedDraws","dr","billedToDate","retentionHeld","nextDrawNumber","getStatusBadge","FileSpreadsheet","ManDayCosts","costData","setCostData","loadCostData","subscription","getRoleLabel","role","roleEntries","BurnRateCard","dailyBurn","totalBurn","daysWorked","customCostTotal","expectedBurnAtProgress","burnStatus","projectedTotalCost","combinedByDate","dateMap","maxDailyCost","Flame","DailyReportsList","branding","useBranding","setReports","setError","expandedReport","setExpandedReport","selectedReports","setSelectedReports","selectMode","setSelectMode","viewMode","setViewMode","expandedMonths","setExpandedMonths","dateFilter","setDateFilter","loadReports","filteredReports","filtered","endDate","sevenDaysAgo","reportsByMonth","monthKey","monthLabel","currentMonthKey","toggleSelectMode","toggleReportSelection","reportId","newSelection","toggleSelectAll","toggleMonthExpand","newExpanded","getExportReports","formatTime","getStatusIcon","getStatusLabel","exportToPDF","exportReports","yPos","primaryColor","hexToRgb","secondaryColor","logoOffset","logoBase64","loadImageAsBase64","pageCount","renderReportCard","task","totalReports","recentCount","monthReports","InjuryReportCard","getInjuryTypeColor","getInjuryTypeLabel","getStatusColor","onViewDetails","InjuryReportsList","user","selectedReport","setSelectedReport","showForm","setShowForm","toast","setToast","effectiveCompanyId","handleReportCreated","handleViewDetails","handleCloseDetails","dateString","timeString","typeColor","descLines","details","monthData","witness","InjuryReportForm","Toast","PROJECT_ROLE_OPTIONS","ProjectTeam","isAdmin","teamMembers","setTeamMembers","companyMembers","setCompanyMembers","showAddModal","setShowAddModal","selectedUser","setSelectedUser","selectedRole","setSelectedRole","actionLoading","setActionLoading","loadProjectTeam","loadCompanyMembers","existingUserIds","available","m","handleAddMember","handleUpdateRole","member","newRole","handleRemoveMember","UserPlus","UserMinus","MFASetup","setStep","setFactors","qrCode","setQrCode","secret","setSecret","factorId","setFactorId","verifyCode","setVerifyCode","verifying","setVerifying","copied","setCopied","loadFactors","supabase","totpFactors","f","startEnrollment","verifyEnrollment","challenge","challengeError","verifyError","unenroll","copySecret","isEnabled","ShieldCheck","Shield","Loader2","ShieldOff","Copy","calculateEarnedValue","progressPercent","actualCosts","bac","earnedValue","plannedValue","calculatePlannedValue","actualCost","cpi","spi","costVariance","scheduleVariance","eac","etc","vac","remainingWork","remainingBudget","tcpi","projectedEndDate","calculateProjectedEndDate","healthStatus","getHealthStatus","roundTo","calculatePercentScheduled","getCPILabel","getSPILabel","start","end","totalDuration","adjustedDays","decimals","factor","generateSCurveData","totalDays","numPoints","fraction","pointDate","pv","isPast","isCurrent","timePercent","EarnedValueCard","ev","sCurveData","statusColors","statusColor","Target","LineChart","Line","ShareModal","lazy","NotificationSettings","CORForm","CORDetail","CORLog","DrawRequestModal","EquipmentModal","AddCostModal","DocumentsTab","CORLogPreview","CORList","TMList","BillingCenter","PhotoTimeline","PunchList","Dashboard","navigateToProjectId","onProjectNavigated","projects","setProjects","setProjectsData","setAreas","showShareModal","setShowShareModal","showNotificationSettings","setShowNotificationSettings","activeProjectTab","setActiveProjectTab","financialsSection","setFinancialsSection","financialsSidebarCollapsed","setFinancialsSidebarCollapsed","financialsSidebarMobileOpen","setFinancialsSidebarMobileOpen","corListExpanded","setCORListExpanded","corDisplayMode","setCORDisplayMode","tmViewMode","setTMViewMode","dumpSites","setDumpSites","showCORForm","setShowCORForm","editingCOR","setEditingCOR","showCORDetail","setShowCORDetail","viewingCOR","setViewingCOR","corRefreshKey","setCORRefreshKey","showAddCostModal","setShowAddCostModal","savingCost","setSavingCost","showEquipmentModal","setShowEquipmentModal","editingEquipment","setEditingEquipment","equipmentRefreshKey","setEquipmentRefreshKey","showDrawRequestModal","setShowDrawRequestModal","editingDrawRequest","setEditingDrawRequest","drawRequestRefreshKey","setDrawRequestRefreshKey","isSearchOpen","setSearchOpen","closeSearch","handleEditClick","handleCancelEdit","handleEditChange","handleAreaEditChange","handleAddArea","handleRemoveArea","handleSaveEdit","handleDeleteProject","refreshTimeoutRef","pendingAreasRefreshRef","pendingCORRefreshRef","projectDetailsCacheRef","CACHE_TTL_MS","debouncedRefresh","refreshAreas","refreshCOR","loadDumpSites","projectIdsRef","projectIdsKey","currentIds","sites","lastNavigatedIdRef","subscriptions","areasSub","dailyReportsSub","checkinsSub","haulOffsSub","corsSub","sub","loadProjectDetails","forceRefresh","cacheKey","cached","projectAreas","changeOrderData","injuryReports","laborCosts","haulOffCosts","materialRequests","weeklyDisposal","progressData","calculateValueProgress","pendingTickets","oneWeekAgo","recentDailyReports","ticketDate","ticketMaterialsCost","materialsEquipmentByDateArray","allCostsTotal","laborDays","materialsDays","totalBurnDays","scheduleInsights","calculateScheduleInsights","uniqueWorkers","crewDates","avgCrewSize","peakCrewSize","recentCrewDates","priorCrewDates","recentCrewAvg","priorCrewAvg","pendingMaterialRequests","orderedMaterialRequests","deliveredMaterialRequests","urgentMaterialRequests","reportsWithIssues","totalPhotosFromTickets","disposalTotalLoads","lastInjuryDate","daysSinceLastInjury","completedAreas","enhancedData","enhanced","handleSelectProject","detailedProject","handleBack","progressCalculations","handleAlertAction","target","checkAutoArchive","shouldAutoArchive","handleAddEquipment","handleEditEquipment","handleCreateDraw","handleViewDraw","drawRequest","handleViewAllTickets","handleToggleFinancialsSidebar","handleToggleMobileSidebar","handleCloseMobileSidebar","handleToggleCORList","handleExportFieldDocuments","handleBackToTMPreview","handleViewFullCORLog","handleCreateCOR","handleViewCOR","handleEditCOR","handleAddCost","handleDeleteCost","costId","financialsNavStats","projectsComplete","projectsOnTrack","projectsAtRisk","projectsOverBudget","projectsWithChangeOrders","scheduleAhead","scheduleOnTrack","scheduleBehind","laborOver","laborUnder","laborOnTrack","hasAnyScheduleData","hasAnyLaborData","isValueBased","totalSOVValue","site","areasNotStarted","pendingCount","tabs","LayoutGrid","tab","Suspense","Menu","section","CheckCircle2","req","week","maxWeek","Camera","MapPin","Building2","Phone","share","projectRisk","EnhancedProjectCard","riskScore","riskStatus","onClick","getOverallStatus","getOverallStatusLabel","isAtRisk","riskColors","riskStyle"],"ignoreList":[0,1,2,3,4,5,6],"sources":["../../node_modules/recharts/es6/component/DefaultLegendContent.js","../../node_modules/recharts/es6/context/legendPayloadContext.js","../../node_modules/recharts/es6/component/Legend.js","../../node_modules/recharts/es6/cartesian/ReferenceLine.js","../../node_modules/recharts/es6/state/selectors/areaSelectors.js","../../node_modules/recharts/es6/cartesian/Area.js","../../node_modules/recharts/es6/chart/AreaChart.js","../../src/lib/errorHandler.js","../../src/lib/riskCalculations.js","../../src/hooks/usePortfolioMetrics.js","../../src/hooks/useProjectEdit.js","../../src/lib/fieldDocumentExport.js","../../src/lib/financialExport.js","../../src/components/UniversalSearch.jsx","../../src/components/dashboard/SmartAlerts.jsx","../../src/components/overview/OverviewProgressGauge.jsx","../../src/components/charts/chartConfig.js","../../src/components/overview/OverviewFinancialCard.jsx","../../src/components/overview/OverviewCrewMetrics.jsx","../../src/components/ui/Skeleton.jsx","../../src/components/ui/ErrorState.jsx","../../src/components/ui/FormField.jsx","../../src/components/ui/MicroVis.jsx","../../src/components/ui/Modal.jsx","../../src/components/HeroMetrics.jsx","../../src/components/FinancialsNav.jsx","../../src/lib/chartDataTransforms.js","../../src/components/charts/ChartTooltip.jsx","../../src/components/charts/FinancialTrendChart.jsx","../../src/components/charts/CostDonut.jsx","../../src/components/ProfitabilityCard.jsx","../../src/components/CostContributorsCard.jsx","../../src/components/DisposalSummary.jsx","../../src/components/equipment/ProjectEquipmentCard.jsx","../../src/components/billing/ProgressBillingCard.jsx","../../src/components/ManDayCosts.jsx","../../src/components/BurnRateCard.jsx","../../src/components/DailyReportsList.jsx","../../src/components/InjuryReportCard.jsx","../../src/components/InjuryReportsList.jsx","../../src/components/ProjectTeam.jsx","../../src/components/MFASetup.jsx","../../src/lib/earnedValueCalculations.js","../../src/components/charts/EarnedValueCard.jsx","../../src/components/Dashboard.jsx"],"sourcesContent":["function _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n/**\n * @fileOverview Default Legend Content\n */\nimport * as React from 'react';\nimport { clsx } from 'clsx';\nimport { Surface } from '../container/Surface';\nimport { Symbols } from '../shape/Symbols';\nimport { adaptEventsOfChild } from '../util/types';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nvar SIZE = 32;\nvar defaultLegendContentDefaultProps = {\n  align: 'center',\n  iconSize: 14,\n  inactiveColor: '#ccc',\n  layout: 'horizontal',\n  verticalAlign: 'middle'\n};\nfunction Icon(_ref) {\n  var {\n    data,\n    iconType,\n    inactiveColor\n  } = _ref;\n  var halfSize = SIZE / 2;\n  var sixthSize = SIZE / 6;\n  var thirdSize = SIZE / 3;\n  var color = data.inactive ? inactiveColor : data.color;\n  var preferredIcon = iconType !== null && iconType !== void 0 ? iconType : data.type;\n  if (preferredIcon === 'none') {\n    return null;\n  }\n  if (preferredIcon === 'plainline') {\n    var _data$payload;\n    return /*#__PURE__*/React.createElement(\"line\", {\n      strokeWidth: 4,\n      fill: \"none\",\n      stroke: color,\n      strokeDasharray: (_data$payload = data.payload) === null || _data$payload === void 0 ? void 0 : _data$payload.strokeDasharray,\n      x1: 0,\n      y1: halfSize,\n      x2: SIZE,\n      y2: halfSize,\n      className: \"recharts-legend-icon\"\n    });\n  }\n  if (preferredIcon === 'line') {\n    return /*#__PURE__*/React.createElement(\"path\", {\n      strokeWidth: 4,\n      fill: \"none\",\n      stroke: color,\n      d: \"M0,\".concat(halfSize, \"h\").concat(thirdSize, \"\\n            A\").concat(sixthSize, \",\").concat(sixthSize, \",0,1,1,\").concat(2 * thirdSize, \",\").concat(halfSize, \"\\n            H\").concat(SIZE, \"M\").concat(2 * thirdSize, \",\").concat(halfSize, \"\\n            A\").concat(sixthSize, \",\").concat(sixthSize, \",0,1,1,\").concat(thirdSize, \",\").concat(halfSize),\n      className: \"recharts-legend-icon\"\n    });\n  }\n  if (preferredIcon === 'rect') {\n    return /*#__PURE__*/React.createElement(\"path\", {\n      stroke: \"none\",\n      fill: color,\n      d: \"M0,\".concat(SIZE / 8, \"h\").concat(SIZE, \"v\").concat(SIZE * 3 / 4, \"h\").concat(-SIZE, \"z\"),\n      className: \"recharts-legend-icon\"\n    });\n  }\n  if (/*#__PURE__*/React.isValidElement(data.legendIcon)) {\n    var iconProps = _objectSpread({}, data);\n    delete iconProps.legendIcon;\n    return /*#__PURE__*/React.cloneElement(data.legendIcon, iconProps);\n  }\n  return /*#__PURE__*/React.createElement(Symbols, {\n    fill: color,\n    cx: halfSize,\n    cy: halfSize,\n    size: SIZE,\n    sizeType: \"diameter\",\n    type: preferredIcon\n  });\n}\nfunction Items(props) {\n  var {\n    payload,\n    iconSize,\n    layout,\n    formatter,\n    inactiveColor,\n    iconType\n  } = props;\n  var viewBox = {\n    x: 0,\n    y: 0,\n    width: SIZE,\n    height: SIZE\n  };\n  var itemStyle = {\n    display: layout === 'horizontal' ? 'inline-block' : 'block',\n    marginRight: 10\n  };\n  var svgStyle = {\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    marginRight: 4\n  };\n  return payload.map((entry, i) => {\n    var finalFormatter = entry.formatter || formatter;\n    var className = clsx({\n      'recharts-legend-item': true,\n      [\"legend-item-\".concat(i)]: true,\n      inactive: entry.inactive\n    });\n    if (entry.type === 'none') {\n      return null;\n    }\n    var color = entry.inactive ? inactiveColor : entry.color;\n    var finalValue = finalFormatter ? finalFormatter(entry.value, entry, i) : entry.value;\n    return /*#__PURE__*/React.createElement(\"li\", _extends({\n      className: className,\n      style: itemStyle,\n      key: \"legend-item-\".concat(i)\n    }, adaptEventsOfChild(props, entry, i)), /*#__PURE__*/React.createElement(Surface, {\n      width: iconSize,\n      height: iconSize,\n      viewBox: viewBox,\n      style: svgStyle,\n      \"aria-label\": \"\".concat(finalValue, \" legend icon\")\n    }, /*#__PURE__*/React.createElement(Icon, {\n      data: entry,\n      iconType: iconType,\n      inactiveColor: inactiveColor\n    })), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"recharts-legend-item-text\",\n      style: {\n        color\n      }\n    }, finalValue));\n  });\n}\nexport var DefaultLegendContent = outsideProps => {\n  var props = resolveDefaultProps(outsideProps, defaultLegendContentDefaultProps);\n  var {\n    payload,\n    layout,\n    align\n  } = props;\n  if (!payload || !payload.length) {\n    return null;\n  }\n  var finalStyle = {\n    padding: 0,\n    margin: 0,\n    textAlign: layout === 'horizontal' ? align : 'left'\n  };\n  return /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"recharts-default-legend\",\n    style: finalStyle\n  }, /*#__PURE__*/React.createElement(Items, _extends({}, props, {\n    payload: payload\n  })));\n};","import { useAppSelector } from '../state/hooks';\nimport { selectLegendPayload } from '../state/selectors/legendSelectors';\n\n/**\n * Use this hook in Legend, or anywhere else where you want to read the current Legend items.\n * @return all Legend items ready to be rendered\n */\nexport function useLegendPayload() {\n  return useAppSelector(selectLegendPayload);\n}","var _excluded = [\"contextPayload\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\nimport * as React from 'react';\nimport { useEffect } from 'react';\nimport { createPortal } from 'react-dom';\nimport { useLegendPortal } from '../context/legendPortalContext';\nimport { DefaultLegendContent } from './DefaultLegendContent';\nimport { isNumber } from '../util/DataUtils';\nimport { getUniqPayload } from '../util/payload/getUniqPayload';\nimport { useLegendPayload } from '../context/legendPayloadContext';\nimport { useElementOffset } from '../util/useElementOffset';\nimport { useChartHeight, useChartWidth, useMargin } from '../context/chartLayoutContext';\nimport { setLegendSettings, setLegendSize } from '../state/legendSlice';\nimport { useAppDispatch } from '../state/hooks';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nfunction defaultUniqBy(entry) {\n  return entry.value;\n}\nfunction LegendContent(props) {\n  var {\n      contextPayload\n    } = props,\n    otherProps = _objectWithoutProperties(props, _excluded);\n  var finalPayload = getUniqPayload(contextPayload, props.payloadUniqBy, defaultUniqBy);\n  var contentProps = _objectSpread(_objectSpread({}, otherProps), {}, {\n    payload: finalPayload\n  });\n  if (/*#__PURE__*/React.isValidElement(props.content)) {\n    return /*#__PURE__*/React.cloneElement(props.content, contentProps);\n  }\n  if (typeof props.content === 'function') {\n    return /*#__PURE__*/React.createElement(props.content, contentProps);\n  }\n  return /*#__PURE__*/React.createElement(DefaultLegendContent, contentProps);\n}\nfunction getDefaultPosition(style, props, margin, chartWidth, chartHeight, box) {\n  var {\n    layout,\n    align,\n    verticalAlign\n  } = props;\n  var hPos, vPos;\n  if (!style || (style.left === undefined || style.left === null) && (style.right === undefined || style.right === null)) {\n    if (align === 'center' && layout === 'vertical') {\n      hPos = {\n        left: ((chartWidth || 0) - box.width) / 2\n      };\n    } else {\n      hPos = align === 'right' ? {\n        right: margin && margin.right || 0\n      } : {\n        left: margin && margin.left || 0\n      };\n    }\n  }\n  if (!style || (style.top === undefined || style.top === null) && (style.bottom === undefined || style.bottom === null)) {\n    if (verticalAlign === 'middle') {\n      vPos = {\n        top: ((chartHeight || 0) - box.height) / 2\n      };\n    } else {\n      vPos = verticalAlign === 'bottom' ? {\n        bottom: margin && margin.bottom || 0\n      } : {\n        top: margin && margin.top || 0\n      };\n    }\n  }\n  return _objectSpread(_objectSpread({}, hPos), vPos);\n}\nfunction LegendSettingsDispatcher(props) {\n  var dispatch = useAppDispatch();\n  useEffect(() => {\n    dispatch(setLegendSettings(props));\n  }, [dispatch, props]);\n  return null;\n}\nfunction LegendSizeDispatcher(props) {\n  var dispatch = useAppDispatch();\n  useEffect(() => {\n    dispatch(setLegendSize(props));\n    return () => {\n      dispatch(setLegendSize({\n        width: 0,\n        height: 0\n      }));\n    };\n  }, [dispatch, props]);\n  return null;\n}\nfunction getWidthOrHeight(layout, height, width, maxWidth) {\n  if (layout === 'vertical' && isNumber(height)) {\n    return {\n      height\n    };\n  }\n  if (layout === 'horizontal') {\n    return {\n      width: width || maxWidth\n    };\n  }\n  return null;\n}\nexport var legendDefaultProps = {\n  align: 'center',\n  iconSize: 14,\n  itemSorter: 'value',\n  layout: 'horizontal',\n  verticalAlign: 'bottom'\n};\nexport function Legend(outsideProps) {\n  var props = resolveDefaultProps(outsideProps, legendDefaultProps);\n  var contextPayload = useLegendPayload();\n  var legendPortalFromContext = useLegendPortal();\n  var margin = useMargin();\n  var {\n    width: widthFromProps,\n    height: heightFromProps,\n    wrapperStyle,\n    portal: portalFromProps\n  } = props;\n  // The contextPayload is not used directly inside the hook, but we need the onBBoxUpdate call\n  // when the payload changes, therefore it's here as a dependency.\n  var [lastBoundingBox, updateBoundingBox] = useElementOffset([contextPayload]);\n  var chartWidth = useChartWidth();\n  var chartHeight = useChartHeight();\n  if (chartWidth == null || chartHeight == null) {\n    return null;\n  }\n  var maxWidth = chartWidth - ((margin === null || margin === void 0 ? void 0 : margin.left) || 0) - ((margin === null || margin === void 0 ? void 0 : margin.right) || 0);\n  var widthOrHeight = getWidthOrHeight(props.layout, heightFromProps, widthFromProps, maxWidth);\n  // if the user supplies their own portal, only use their defined wrapper styles\n  var outerStyle = portalFromProps ? wrapperStyle : _objectSpread(_objectSpread({\n    position: 'absolute',\n    width: (widthOrHeight === null || widthOrHeight === void 0 ? void 0 : widthOrHeight.width) || widthFromProps || 'auto',\n    height: (widthOrHeight === null || widthOrHeight === void 0 ? void 0 : widthOrHeight.height) || heightFromProps || 'auto'\n  }, getDefaultPosition(wrapperStyle, props, margin, chartWidth, chartHeight, lastBoundingBox)), wrapperStyle);\n  var legendPortal = portalFromProps !== null && portalFromProps !== void 0 ? portalFromProps : legendPortalFromContext;\n  if (legendPortal == null || contextPayload == null) {\n    return null;\n  }\n  var legendElement = /*#__PURE__*/React.createElement(\"div\", {\n    className: \"recharts-legend-wrapper\",\n    style: outerStyle,\n    ref: updateBoundingBox\n  }, /*#__PURE__*/React.createElement(LegendSettingsDispatcher, {\n    layout: props.layout,\n    align: props.align,\n    verticalAlign: props.verticalAlign,\n    itemSorter: props.itemSorter\n  }), !portalFromProps && /*#__PURE__*/React.createElement(LegendSizeDispatcher, {\n    width: lastBoundingBox.width,\n    height: lastBoundingBox.height\n  }), /*#__PURE__*/React.createElement(LegendContent, _extends({}, props, widthOrHeight, {\n    margin: margin,\n    chartWidth: chartWidth,\n    chartHeight: chartHeight,\n    contextPayload: contextPayload\n  })));\n  return /*#__PURE__*/createPortal(legendElement, legendPortal);\n}\nLegend.displayName = 'Legend';","function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\n/**\n * @fileOverview Reference Line\n */\nimport * as React from 'react';\nimport { useEffect } from 'react';\nimport { clsx } from 'clsx';\nimport { Layer } from '../container/Layer';\nimport { CartesianLabelContextProvider, CartesianLabelFromLabelProp } from '../component/Label';\nimport { isNan, isNumOrStr } from '../util/DataUtils';\nimport { createLabeledScales, rectWithCoords } from '../util/CartesianUtils';\nimport { useViewBox } from '../context/chartLayoutContext';\nimport { addLine, removeLine } from '../state/referenceElementsSlice';\nimport { useAppDispatch, useAppSelector } from '../state/hooks';\nimport { selectAxisScale, selectXAxisSettings, selectYAxisSettings } from '../state/selectors/axisSelectors';\nimport { useIsPanorama } from '../context/PanoramaContext';\nimport { useClipPathId } from '../container/ClipPathProvider';\nimport { svgPropertiesAndEvents } from '../util/svgPropertiesAndEvents';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nimport { ZIndexLayer } from '../zIndex/ZIndexLayer';\nimport { DefaultZIndexes } from '../zIndex/DefaultZIndexes';\nimport { isWellBehavedNumber } from '../util/isWellBehavedNumber';\n\n/**\n * Single point that defines one end of a segment.\n * These coordinates are in data space, meaning that you should provide\n * values that correspond to the data domain of the axes.\n * So you would provide a value of `Page A` to indicate the data value `Page A`\n * and then recharts will convert that to pixels.\n *\n * Likewise for numbers. If your x-axis goes from 0 to 100,\n * and you want the line to end at 50, you would provide `50` here.\n */\n\n/**\n * This excludes `viewBox` prop from svg for two reasons:\n * 1. The components wants viewBox of object type, and svg wants string\n *    - so there's a conflict, and the component will throw if it gets string\n * 2. Internally the component calls `svgPropertiesNoEvents` which filters the viewBox away anyway\n */\n\nvar renderLine = (option, props) => {\n  var line;\n  if (/*#__PURE__*/React.isValidElement(option)) {\n    // @ts-expect-error element cloning is not typed\n    line = /*#__PURE__*/React.cloneElement(option, props);\n  } else if (typeof option === 'function') {\n    line = option(props);\n  } else {\n    if (!isWellBehavedNumber(props.x1) || !isWellBehavedNumber(props.y1) || !isWellBehavedNumber(props.x2) || !isWellBehavedNumber(props.y2)) {\n      return null;\n    }\n    line = /*#__PURE__*/React.createElement(\"line\", _extends({}, props, {\n      className: \"recharts-reference-line-line\"\n    }));\n  }\n  return line;\n};\nvar getHorizontalLineEndPoints = (yCoord, ifOverflow, position, yAxisOrientation, scales, viewBox) => {\n  var {\n    x,\n    width\n  } = viewBox;\n  var coord = scales.y.apply(yCoord, {\n    position\n  });\n  // don't render the line if the scale can't compute a result that makes sense\n  if (isNan(coord)) return null;\n  if (ifOverflow === 'discard' && !scales.y.isInRange(coord)) {\n    return null;\n  }\n  var points = [{\n    x: x + width,\n    y: coord\n  }, {\n    x,\n    y: coord\n  }];\n  return yAxisOrientation === 'left' ? points.reverse() : points;\n};\nvar getVerticalLineEndPoints = (xCoord, ifOverflow, position, xAxisOrientation, scales, viewBox) => {\n  var {\n    y,\n    height\n  } = viewBox;\n  var coord = scales.x.apply(xCoord, {\n    position\n  });\n  // don't render the line if the scale can't compute a result that makes sense\n  if (isNan(coord)) return null;\n  if (ifOverflow === 'discard' && !scales.x.isInRange(coord)) {\n    return null;\n  }\n  var points = [{\n    x: coord,\n    y: y + height\n  }, {\n    x: coord,\n    y\n  }];\n  return xAxisOrientation === 'top' ? points.reverse() : points;\n};\nvar getSegmentLineEndPoints = (segment, ifOverflow, position, scales) => {\n  var points = segment.map(p => scales.apply(p, {\n    position\n  }));\n  if (ifOverflow === 'discard' && points.some(p => !scales.isInRange(p))) {\n    return null;\n  }\n  return points;\n};\nexport var getEndPoints = (scales, viewBox, position, xAxisOrientation, yAxisOrientation, props) => {\n  var {\n    x: xCoord,\n    y: yCoord,\n    segment,\n    ifOverflow\n  } = props;\n  var isFixedX = isNumOrStr(xCoord);\n  var isFixedY = isNumOrStr(yCoord);\n  if (isFixedY) {\n    return getHorizontalLineEndPoints(yCoord, ifOverflow, position, yAxisOrientation, scales, viewBox);\n  }\n  if (isFixedX) {\n    return getVerticalLineEndPoints(xCoord, ifOverflow, position, xAxisOrientation, scales, viewBox);\n  }\n  if (segment != null && segment.length === 2) {\n    return getSegmentLineEndPoints(segment, ifOverflow, position, scales);\n  }\n  return null;\n};\nfunction ReportReferenceLine(props) {\n  var dispatch = useAppDispatch();\n  useEffect(() => {\n    dispatch(addLine(props));\n    return () => {\n      dispatch(removeLine(props));\n    };\n  });\n  return null;\n}\nfunction ReferenceLineImpl(props) {\n  var {\n    xAxisId,\n    yAxisId,\n    shape,\n    className,\n    ifOverflow\n  } = props;\n  var isPanorama = useIsPanorama();\n  var clipPathId = useClipPathId();\n  var xAxis = useAppSelector(state => selectXAxisSettings(state, xAxisId));\n  var yAxis = useAppSelector(state => selectYAxisSettings(state, yAxisId));\n  var xAxisScale = useAppSelector(state => selectAxisScale(state, 'xAxis', xAxisId, isPanorama));\n  var yAxisScale = useAppSelector(state => selectAxisScale(state, 'yAxis', yAxisId, isPanorama));\n  var viewBox = useViewBox();\n  if (!clipPathId || !viewBox || xAxis == null || yAxis == null || xAxisScale == null || yAxisScale == null) {\n    return null;\n  }\n  var scales = createLabeledScales({\n    x: xAxisScale,\n    y: yAxisScale\n  });\n  var endPoints = getEndPoints(scales, viewBox, props.position, xAxis.orientation, yAxis.orientation, props);\n  if (!endPoints) {\n    return null;\n  }\n  var [{\n    x: x1,\n    y: y1\n  }, {\n    x: x2,\n    y: y2\n  }] = endPoints;\n  var clipPath = ifOverflow === 'hidden' ? \"url(#\".concat(clipPathId, \")\") : undefined;\n  var lineProps = _objectSpread(_objectSpread({\n    clipPath\n  }, svgPropertiesAndEvents(props)), {}, {\n    x1,\n    y1,\n    x2,\n    y2\n  });\n  var rect = rectWithCoords({\n    x1,\n    y1,\n    x2,\n    y2\n  });\n  return /*#__PURE__*/React.createElement(ZIndexLayer, {\n    zIndex: props.zIndex\n  }, /*#__PURE__*/React.createElement(Layer, {\n    className: clsx('recharts-reference-line', className)\n  }, renderLine(shape, lineProps), /*#__PURE__*/React.createElement(CartesianLabelContextProvider, _extends({}, rect, {\n    lowerWidth: rect.width,\n    upperWidth: rect.width\n  }), /*#__PURE__*/React.createElement(CartesianLabelFromLabelProp, {\n    label: props.label\n  }), props.children)));\n}\nexport var referenceLineDefaultProps = {\n  ifOverflow: 'discard',\n  xAxisId: 0,\n  yAxisId: 0,\n  fill: 'none',\n  stroke: '#ccc',\n  fillOpacity: 1,\n  strokeWidth: 1,\n  position: 'middle',\n  zIndex: DefaultZIndexes.line\n};\n/**\n * @provides CartesianLabelContext\n */\nexport function ReferenceLine(outsideProps) {\n  var props = resolveDefaultProps(outsideProps, referenceLineDefaultProps);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ReportReferenceLine, {\n    yAxisId: props.yAxisId,\n    xAxisId: props.xAxisId,\n    ifOverflow: props.ifOverflow,\n    x: props.x,\n    y: props.y,\n    segment: props.segment\n  }), /*#__PURE__*/React.createElement(ReferenceLineImpl, props));\n}\nReferenceLine.displayName = 'ReferenceLine';","import { createSelector } from 'reselect';\nimport { computeArea } from '../../cartesian/Area';\nimport { selectAxisWithScale, selectStackGroups, selectTicksOfGraphicalItem, selectUnfilteredCartesianItems } from './axisSelectors';\nimport { selectChartLayout } from '../../context/chartLayoutContext';\nimport { selectChartDataWithIndexesIfNotInPanoramaPosition3 } from './dataSelectors';\nimport { getBandSizeOfAxis, isCategoricalAxis } from '../../util/ChartUtils';\nimport { getStackSeriesIdentifier } from '../../util/stacks/getStackSeriesIdentifier';\nimport { selectChartBaseValue } from './rootPropsSelectors';\nimport { selectXAxisIdFromGraphicalItemId, selectYAxisIdFromGraphicalItemId } from './graphicalItemSelectors';\nvar selectXAxisWithScale = (state, graphicalItemId, isPanorama) => selectAxisWithScale(state, 'xAxis', selectXAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nvar selectXAxisTicks = (state, graphicalItemId, isPanorama) => selectTicksOfGraphicalItem(state, 'xAxis', selectXAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nvar selectYAxisWithScale = (state, graphicalItemId, isPanorama) => selectAxisWithScale(state, 'yAxis', selectYAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nvar selectYAxisTicks = (state, graphicalItemId, isPanorama) => selectTicksOfGraphicalItem(state, 'yAxis', selectYAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nvar selectBandSize = createSelector([selectChartLayout, selectXAxisWithScale, selectYAxisWithScale, selectXAxisTicks, selectYAxisTicks], (layout, xAxis, yAxis, xAxisTicks, yAxisTicks) => {\n  if (isCategoricalAxis(layout, 'xAxis')) {\n    return getBandSizeOfAxis(xAxis, xAxisTicks, false);\n  }\n  return getBandSizeOfAxis(yAxis, yAxisTicks, false);\n});\nvar pickAreaId = (_state, id) => id;\n\n/*\n * There is a race condition problem because we read some data from props and some from the state.\n * The state is updated through a dispatch and is one render behind,\n * and so we have this weird one tick render where the displayedData in one selector have the old dataKey\n * but the new dataKey in another selector.\n *\n * A proper fix is to either move everything into the state, or read the dataKey always from props\n * - but this is a smaller change.\n */\nvar selectSynchronisedAreaSettings = createSelector([selectUnfilteredCartesianItems, pickAreaId], (graphicalItems, id) => graphicalItems.filter(item => item.type === 'area').find(item => item.id === id));\nvar selectNumericalAxisType = state => {\n  var layout = selectChartLayout(state);\n  var isXAxisCategorical = isCategoricalAxis(layout, 'xAxis');\n  return isXAxisCategorical ? 'yAxis' : 'xAxis';\n};\nvar selectNumericalAxisIdFromGraphicalItemId = (state, graphicalItemId) => {\n  var axisType = selectNumericalAxisType(state);\n  if (axisType === 'yAxis') {\n    return selectYAxisIdFromGraphicalItemId(state, graphicalItemId);\n  }\n  return selectXAxisIdFromGraphicalItemId(state, graphicalItemId);\n};\nvar selectNumericalAxisStackGroups = (state, graphicalItemId, isPanorama) => selectStackGroups(state, selectNumericalAxisType(state), selectNumericalAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nexport var selectGraphicalItemStackedData = createSelector([selectSynchronisedAreaSettings, selectNumericalAxisStackGroups], (areaSettings, stackGroups) => {\n  var _stackGroups$stackId;\n  if (areaSettings == null || stackGroups == null) {\n    return undefined;\n  }\n  var {\n    stackId\n  } = areaSettings;\n  var stackSeriesIdentifier = getStackSeriesIdentifier(areaSettings);\n  if (stackId == null || stackSeriesIdentifier == null) {\n    return undefined;\n  }\n  var groups = (_stackGroups$stackId = stackGroups[stackId]) === null || _stackGroups$stackId === void 0 ? void 0 : _stackGroups$stackId.stackedData;\n  var found = groups === null || groups === void 0 ? void 0 : groups.find(v => v.key === stackSeriesIdentifier);\n  if (found == null) {\n    return undefined;\n  }\n  return found.map(item => [item[0], item[1]]);\n});\nexport var selectArea = createSelector([selectChartLayout, selectXAxisWithScale, selectYAxisWithScale, selectXAxisTicks, selectYAxisTicks, selectGraphicalItemStackedData, selectChartDataWithIndexesIfNotInPanoramaPosition3, selectBandSize, selectSynchronisedAreaSettings, selectChartBaseValue], (layout, xAxis, yAxis, xAxisTicks, yAxisTicks, stackedData, _ref, bandSize, areaSettings, chartBaseValue) => {\n  var {\n    chartData,\n    dataStartIndex,\n    dataEndIndex\n  } = _ref;\n  if (areaSettings == null || layout !== 'horizontal' && layout !== 'vertical' || xAxis == null || yAxis == null || xAxisTicks == null || yAxisTicks == null || xAxisTicks.length === 0 || yAxisTicks.length === 0 || bandSize == null) {\n    return undefined;\n  }\n  var {\n    data\n  } = areaSettings;\n  var displayedData;\n  if (data && data.length > 0) {\n    displayedData = data;\n  } else {\n    displayedData = chartData === null || chartData === void 0 ? void 0 : chartData.slice(dataStartIndex, dataEndIndex + 1);\n  }\n  if (displayedData == null) {\n    return undefined;\n  }\n  return computeArea({\n    layout,\n    xAxis,\n    yAxis,\n    xAxisTicks,\n    yAxisTicks,\n    dataStartIndex,\n    areaSettings,\n    stackedData,\n    displayedData,\n    chartBaseValue,\n    bandSize\n  });\n});","var _excluded = [\"id\"],\n  _excluded2 = [\"activeDot\", \"animationBegin\", \"animationDuration\", \"animationEasing\", \"connectNulls\", \"dot\", \"fill\", \"fillOpacity\", \"hide\", \"isAnimationActive\", \"legendType\", \"stroke\", \"xAxisId\", \"yAxisId\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport * as React from 'react';\nimport { PureComponent, useCallback, useMemo, useRef, useState } from 'react';\nimport { clsx } from 'clsx';\nimport { Curve } from '../shape/Curve';\nimport { Layer } from '../container/Layer';\nimport { CartesianLabelListContextProvider, LabelListFromLabelProp } from '../component/LabelList';\nimport { Dots } from '../component/Dots';\nimport { Global } from '../util/Global';\nimport { interpolate, isNan, isNullish, isNumber } from '../util/DataUtils';\nimport { getCateCoordinateOfLine, getNormalizedStackId, getTooltipNameProp, getValueByDataKey } from '../util/ChartUtils';\nimport { isClipDot } from '../util/ReactUtils';\nimport { ActivePoints } from '../component/ActivePoints';\nimport { SetTooltipEntrySettings } from '../state/SetTooltipEntrySettings';\nimport { GraphicalItemClipPath, useNeedsClip } from './GraphicalItemClipPath';\nimport { selectArea } from '../state/selectors/areaSelectors';\nimport { useIsPanorama } from '../context/PanoramaContext';\nimport { useCartesianChartLayout, useChartLayout } from '../context/chartLayoutContext';\nimport { useChartName } from '../state/selectors/selectors';\nimport { SetLegendPayload } from '../state/SetLegendPayload';\nimport { useAppSelector } from '../state/hooks';\nimport { useAnimationId } from '../util/useAnimationId';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nimport { isWellBehavedNumber } from '../util/isWellBehavedNumber';\nimport { usePlotArea } from '../hooks';\nimport { RegisterGraphicalItemId } from '../context/RegisterGraphicalItemId';\nimport { SetCartesianGraphicalItem } from '../state/SetGraphicalItem';\nimport { svgPropertiesNoEvents } from '../util/svgPropertiesNoEvents';\nimport { JavascriptAnimate } from '../animation/JavascriptAnimate';\nimport { getRadiusAndStrokeWidthFromDot } from '../util/getRadiusAndStrokeWidthFromDot';\nimport { svgPropertiesAndEvents } from '../util/svgPropertiesAndEvents';\nimport { ZIndexLayer } from '../zIndex/ZIndexLayer';\nimport { DefaultZIndexes } from '../zIndex/DefaultZIndexes';\nimport { propsAreEqual } from '../util/propsAreEqual';\n\n/**\n * @inline\n */\n\n/**\n * Internal props, combination of external props + defaultProps + private Recharts state\n */\n\n/**\n * External props, intended for end users to fill in\n */\n\n/**\n * Because of naming conflict, we are forced to ignore certain (valid) SVG attributes.\n */\n\nfunction getLegendItemColor(stroke, fill) {\n  return stroke && stroke !== 'none' ? stroke : fill;\n}\nvar computeLegendPayloadFromAreaData = props => {\n  var {\n    dataKey,\n    name,\n    stroke,\n    fill,\n    legendType,\n    hide\n  } = props;\n  return [{\n    inactive: hide,\n    dataKey,\n    type: legendType,\n    color: getLegendItemColor(stroke, fill),\n    value: getTooltipNameProp(name, dataKey),\n    payload: props\n  }];\n};\nvar SetAreaTooltipEntrySettings = /*#__PURE__*/React.memo(_ref => {\n  var {\n    dataKey,\n    data,\n    stroke,\n    strokeWidth,\n    fill,\n    name,\n    hide,\n    unit,\n    tooltipType,\n    id\n  } = _ref;\n  var tooltipEntrySettings = {\n    dataDefinedOnItem: data,\n    positions: undefined,\n    settings: {\n      stroke,\n      strokeWidth,\n      fill,\n      dataKey,\n      nameKey: undefined,\n      name: getTooltipNameProp(name, dataKey),\n      hide,\n      type: tooltipType,\n      color: getLegendItemColor(stroke, fill),\n      unit,\n      graphicalItemId: id\n    }\n  };\n  return /*#__PURE__*/React.createElement(SetTooltipEntrySettings, {\n    tooltipEntrySettings: tooltipEntrySettings\n  });\n});\nfunction AreaDotsWrapper(_ref2) {\n  var {\n    clipPathId,\n    points,\n    props\n  } = _ref2;\n  var {\n    needClip,\n    dot,\n    dataKey\n  } = props;\n  var areaProps = svgPropertiesNoEvents(props);\n  return /*#__PURE__*/React.createElement(Dots, {\n    points: points,\n    dot: dot,\n    className: \"recharts-area-dots\",\n    dotClassName: \"recharts-area-dot\",\n    dataKey: dataKey,\n    baseProps: areaProps,\n    needClip: needClip,\n    clipPathId: clipPathId\n  });\n}\nfunction AreaLabelListProvider(_ref3) {\n  var {\n    showLabels,\n    children,\n    points\n  } = _ref3;\n  var labelListEntries = points.map(point => {\n    var _point$x, _point$y;\n    var viewBox = {\n      x: (_point$x = point.x) !== null && _point$x !== void 0 ? _point$x : 0,\n      y: (_point$y = point.y) !== null && _point$y !== void 0 ? _point$y : 0,\n      width: 0,\n      lowerWidth: 0,\n      upperWidth: 0,\n      height: 0\n    };\n    return _objectSpread(_objectSpread({}, viewBox), {}, {\n      value: point.value,\n      payload: point.payload,\n      parentViewBox: undefined,\n      viewBox,\n      fill: undefined\n    });\n  });\n  return /*#__PURE__*/React.createElement(CartesianLabelListContextProvider, {\n    value: showLabels ? labelListEntries : undefined\n  }, children);\n}\nfunction StaticArea(_ref4) {\n  var {\n    points,\n    baseLine,\n    needClip,\n    clipPathId,\n    props\n  } = _ref4;\n  var {\n    layout,\n    type,\n    stroke,\n    connectNulls,\n    isRange\n  } = props;\n  var {\n      id\n    } = props,\n    propsWithoutId = _objectWithoutProperties(props, _excluded);\n  var allOtherProps = svgPropertiesNoEvents(propsWithoutId);\n  var propsWithEvents = svgPropertiesAndEvents(propsWithoutId);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, (points === null || points === void 0 ? void 0 : points.length) > 1 && /*#__PURE__*/React.createElement(Layer, {\n    clipPath: needClip ? \"url(#clipPath-\".concat(clipPathId, \")\") : undefined\n  }, /*#__PURE__*/React.createElement(Curve, _extends({}, propsWithEvents, {\n    id: id,\n    points: points,\n    connectNulls: connectNulls,\n    type: type,\n    baseLine: baseLine,\n    layout: layout,\n    stroke: \"none\",\n    className: \"recharts-area-area\"\n  })), stroke !== 'none' && /*#__PURE__*/React.createElement(Curve, _extends({}, allOtherProps, {\n    className: \"recharts-area-curve\",\n    layout: layout,\n    type: type,\n    connectNulls: connectNulls,\n    fill: \"none\",\n    points: points\n  })), stroke !== 'none' && isRange && /*#__PURE__*/React.createElement(Curve, _extends({}, allOtherProps, {\n    className: \"recharts-area-curve\",\n    layout: layout,\n    type: type,\n    connectNulls: connectNulls,\n    fill: \"none\",\n    points: baseLine\n  }))), /*#__PURE__*/React.createElement(AreaDotsWrapper, {\n    points: points,\n    props: propsWithoutId,\n    clipPathId: clipPathId\n  }));\n}\nfunction VerticalRect(_ref5) {\n  var _points$, _points;\n  var {\n    alpha,\n    baseLine,\n    points,\n    strokeWidth\n  } = _ref5;\n  var startY = (_points$ = points[0]) === null || _points$ === void 0 ? void 0 : _points$.y;\n  var endY = (_points = points[points.length - 1]) === null || _points === void 0 ? void 0 : _points.y;\n  if (!isWellBehavedNumber(startY) || !isWellBehavedNumber(endY)) {\n    return null;\n  }\n  var height = alpha * Math.abs(startY - endY);\n  var maxX = Math.max(...points.map(entry => entry.x || 0));\n  if (isNumber(baseLine)) {\n    maxX = Math.max(baseLine, maxX);\n  } else if (baseLine && Array.isArray(baseLine) && baseLine.length) {\n    maxX = Math.max(...baseLine.map(entry => entry.x || 0), maxX);\n  }\n  if (isNumber(maxX)) {\n    return /*#__PURE__*/React.createElement(\"rect\", {\n      x: 0,\n      y: startY < endY ? startY : startY - height,\n      width: maxX + (strokeWidth ? parseInt(\"\".concat(strokeWidth), 10) : 1),\n      height: Math.floor(height)\n    });\n  }\n  return null;\n}\nfunction HorizontalRect(_ref6) {\n  var _points$2, _points2;\n  var {\n    alpha,\n    baseLine,\n    points,\n    strokeWidth\n  } = _ref6;\n  var startX = (_points$2 = points[0]) === null || _points$2 === void 0 ? void 0 : _points$2.x;\n  var endX = (_points2 = points[points.length - 1]) === null || _points2 === void 0 ? void 0 : _points2.x;\n  if (!isWellBehavedNumber(startX) || !isWellBehavedNumber(endX)) {\n    return null;\n  }\n  var width = alpha * Math.abs(startX - endX);\n  var maxY = Math.max(...points.map(entry => entry.y || 0));\n  if (isNumber(baseLine)) {\n    maxY = Math.max(baseLine, maxY);\n  } else if (baseLine && Array.isArray(baseLine) && baseLine.length) {\n    maxY = Math.max(...baseLine.map(entry => entry.y || 0), maxY);\n  }\n  if (isNumber(maxY)) {\n    return /*#__PURE__*/React.createElement(\"rect\", {\n      x: startX < endX ? startX : startX - width,\n      y: 0,\n      width: width,\n      height: Math.floor(maxY + (strokeWidth ? parseInt(\"\".concat(strokeWidth), 10) : 1))\n    });\n  }\n  return null;\n}\nfunction ClipRect(_ref7) {\n  var {\n    alpha,\n    layout,\n    points,\n    baseLine,\n    strokeWidth\n  } = _ref7;\n  if (layout === 'vertical') {\n    return /*#__PURE__*/React.createElement(VerticalRect, {\n      alpha: alpha,\n      points: points,\n      baseLine: baseLine,\n      strokeWidth: strokeWidth\n    });\n  }\n  return /*#__PURE__*/React.createElement(HorizontalRect, {\n    alpha: alpha,\n    points: points,\n    baseLine: baseLine,\n    strokeWidth: strokeWidth\n  });\n}\nfunction AreaWithAnimation(_ref8) {\n  var {\n    needClip,\n    clipPathId,\n    props,\n    previousPointsRef,\n    previousBaselineRef\n  } = _ref8;\n  var {\n    points,\n    baseLine,\n    isAnimationActive,\n    animationBegin,\n    animationDuration,\n    animationEasing,\n    onAnimationStart,\n    onAnimationEnd\n  } = props;\n  var animationInput = useMemo(() => ({\n    points,\n    baseLine\n  }), [points, baseLine]);\n  var animationId = useAnimationId(animationInput, 'recharts-area-');\n  var layout = useCartesianChartLayout();\n  var [isAnimating, setIsAnimating] = useState(false);\n  var showLabels = !isAnimating;\n  var handleAnimationEnd = useCallback(() => {\n    if (typeof onAnimationEnd === 'function') {\n      onAnimationEnd();\n    }\n    setIsAnimating(false);\n  }, [onAnimationEnd]);\n  var handleAnimationStart = useCallback(() => {\n    if (typeof onAnimationStart === 'function') {\n      onAnimationStart();\n    }\n    setIsAnimating(true);\n  }, [onAnimationStart]);\n  if (layout == null) {\n    return null;\n  }\n  var prevPoints = previousPointsRef.current;\n  var prevBaseLine = previousBaselineRef.current;\n  return /*#__PURE__*/React.createElement(AreaLabelListProvider, {\n    showLabels: showLabels,\n    points: points\n  }, props.children, /*#__PURE__*/React.createElement(JavascriptAnimate, {\n    animationId: animationId,\n    begin: animationBegin,\n    duration: animationDuration,\n    isActive: isAnimationActive,\n    easing: animationEasing,\n    onAnimationEnd: handleAnimationEnd,\n    onAnimationStart: handleAnimationStart,\n    key: animationId\n  }, t => {\n    if (prevPoints) {\n      var prevPointsDiffFactor = prevPoints.length / points.length;\n      var stepPoints =\n      /*\n       * Here it is important that at the very end of the animation, on the last frame,\n       * we render the original points without any interpolation.\n       * This is needed because the code above is checking for reference equality to decide if the animation should run\n       * and if we create a new array instance (even if the numbers were the same)\n       * then we would break animations.\n       */\n      t === 1 ? points : points.map((entry, index) => {\n        var prevPointIndex = Math.floor(index * prevPointsDiffFactor);\n        if (prevPoints[prevPointIndex]) {\n          var prev = prevPoints[prevPointIndex];\n          return _objectSpread(_objectSpread({}, entry), {}, {\n            x: interpolate(prev.x, entry.x, t),\n            y: interpolate(prev.y, entry.y, t)\n          });\n        }\n        return entry;\n      });\n      var stepBaseLine;\n      if (isNumber(baseLine)) {\n        stepBaseLine = interpolate(prevBaseLine, baseLine, t);\n      } else if (isNullish(baseLine) || isNan(baseLine)) {\n        stepBaseLine = interpolate(prevBaseLine, 0, t);\n      } else {\n        stepBaseLine = baseLine.map((entry, index) => {\n          var prevPointIndex = Math.floor(index * prevPointsDiffFactor);\n          if (Array.isArray(prevBaseLine) && prevBaseLine[prevPointIndex]) {\n            var prev = prevBaseLine[prevPointIndex];\n            return _objectSpread(_objectSpread({}, entry), {}, {\n              x: interpolate(prev.x, entry.x, t),\n              y: interpolate(prev.y, entry.y, t)\n            });\n          }\n          return entry;\n        });\n      }\n      if (t > 0) {\n        /*\n         * We need to keep the refs in the parent component because we need to remember the last shape of the animation\n         * even if AreaWithAnimation is unmounted as that happens when changing props.\n         *\n         * And we need to update the refs here because here is where the interpolation is computed.\n         * Eslint doesn't like changing function arguments, but we need it so here is an eslint-disable.\n         */\n        // eslint-disable-next-line no-param-reassign\n        previousPointsRef.current = stepPoints;\n        // eslint-disable-next-line no-param-reassign\n        previousBaselineRef.current = stepBaseLine;\n      }\n      return /*#__PURE__*/React.createElement(StaticArea, {\n        points: stepPoints,\n        baseLine: stepBaseLine,\n        needClip: needClip,\n        clipPathId: clipPathId,\n        props: props\n      });\n    }\n    if (t > 0) {\n      // eslint-disable-next-line no-param-reassign\n      previousPointsRef.current = points;\n      // eslint-disable-next-line no-param-reassign\n      previousBaselineRef.current = baseLine;\n    }\n    return /*#__PURE__*/React.createElement(Layer, null, isAnimationActive && /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n      id: \"animationClipPath-\".concat(clipPathId)\n    }, /*#__PURE__*/React.createElement(ClipRect, {\n      alpha: t,\n      points: points,\n      baseLine: baseLine,\n      layout: layout,\n      strokeWidth: props.strokeWidth\n    }))), /*#__PURE__*/React.createElement(Layer, {\n      clipPath: \"url(#animationClipPath-\".concat(clipPathId, \")\")\n    }, /*#__PURE__*/React.createElement(StaticArea, {\n      points: points,\n      baseLine: baseLine,\n      needClip: needClip,\n      clipPathId: clipPathId,\n      props: props\n    })));\n  }), /*#__PURE__*/React.createElement(LabelListFromLabelProp, {\n    label: props.label\n  }));\n}\n\n/*\n * This components decides if the area should be animated or not.\n * It also holds the state of the animation.\n */\nfunction RenderArea(_ref9) {\n  var {\n    needClip,\n    clipPathId,\n    props\n  } = _ref9;\n  /*\n   * These two must be refs, not state!\n   * Because we want to store the most recent shape of the animation in case we have to interrupt the animation;\n   * that happens when user initiates another animation before the current one finishes.\n   *\n   * If this was a useState, then every step in the animation would trigger a re-render.\n   * So, useRef it is.\n   */\n  var previousPointsRef = useRef(null);\n  var previousBaselineRef = useRef();\n  return /*#__PURE__*/React.createElement(AreaWithAnimation, {\n    needClip: needClip,\n    clipPathId: clipPathId,\n    props: props,\n    previousPointsRef: previousPointsRef,\n    previousBaselineRef: previousBaselineRef\n  });\n}\nclass AreaWithState extends PureComponent {\n  render() {\n    var {\n      hide,\n      dot,\n      points,\n      className,\n      top,\n      left,\n      needClip,\n      xAxisId,\n      yAxisId,\n      width,\n      height,\n      id,\n      baseLine,\n      zIndex\n    } = this.props;\n    if (hide) {\n      return null;\n    }\n    var layerClass = clsx('recharts-area', className);\n    var clipPathId = id;\n    var {\n      r,\n      strokeWidth\n    } = getRadiusAndStrokeWidthFromDot(dot);\n    var clipDot = isClipDot(dot);\n    var dotSize = r * 2 + strokeWidth;\n    var activePointsClipPath = needClip ? \"url(#clipPath-\".concat(clipDot ? '' : 'dots-').concat(clipPathId, \")\") : undefined;\n    return /*#__PURE__*/React.createElement(ZIndexLayer, {\n      zIndex: zIndex\n    }, /*#__PURE__*/React.createElement(Layer, {\n      className: layerClass\n    }, needClip && /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(GraphicalItemClipPath, {\n      clipPathId: clipPathId,\n      xAxisId: xAxisId,\n      yAxisId: yAxisId\n    }), !clipDot && /*#__PURE__*/React.createElement(\"clipPath\", {\n      id: \"clipPath-dots-\".concat(clipPathId)\n    }, /*#__PURE__*/React.createElement(\"rect\", {\n      x: left - dotSize / 2,\n      y: top - dotSize / 2,\n      width: width + dotSize,\n      height: height + dotSize\n    }))), /*#__PURE__*/React.createElement(RenderArea, {\n      needClip: needClip,\n      clipPathId: clipPathId,\n      props: this.props\n    })), /*#__PURE__*/React.createElement(ActivePoints, {\n      points: points,\n      mainColor: getLegendItemColor(this.props.stroke, this.props.fill),\n      itemDataKey: this.props.dataKey,\n      activeDot: this.props.activeDot,\n      clipPath: activePointsClipPath\n    }), this.props.isRange && Array.isArray(baseLine) && /*#__PURE__*/React.createElement(ActivePoints, {\n      points: baseLine,\n      mainColor: getLegendItemColor(this.props.stroke, this.props.fill),\n      itemDataKey: this.props.dataKey,\n      activeDot: this.props.activeDot,\n      clipPath: activePointsClipPath\n    }));\n  }\n}\nexport var defaultAreaProps = {\n  activeDot: true,\n  animationBegin: 0,\n  animationDuration: 1500,\n  animationEasing: 'ease',\n  connectNulls: false,\n  dot: false,\n  fill: '#3182bd',\n  fillOpacity: 0.6,\n  hide: false,\n  isAnimationActive: 'auto',\n  legendType: 'line',\n  stroke: '#3182bd',\n  strokeWidth: 1,\n  type: 'linear',\n  label: false,\n  xAxisId: 0,\n  yAxisId: 0,\n  zIndex: DefaultZIndexes.area\n};\nfunction AreaImpl(props) {\n  var _useAppSelector;\n  var _resolveDefaultProps = resolveDefaultProps(props, defaultAreaProps),\n    {\n      activeDot,\n      animationBegin,\n      animationDuration,\n      animationEasing,\n      connectNulls,\n      dot,\n      fill,\n      fillOpacity,\n      hide,\n      isAnimationActive,\n      legendType,\n      stroke,\n      xAxisId,\n      yAxisId\n    } = _resolveDefaultProps,\n    everythingElse = _objectWithoutProperties(_resolveDefaultProps, _excluded2);\n  var layout = useChartLayout();\n  var chartName = useChartName();\n  var {\n    needClip\n  } = useNeedsClip(xAxisId, yAxisId);\n  var isPanorama = useIsPanorama();\n  var {\n    points,\n    isRange,\n    baseLine\n  } = (_useAppSelector = useAppSelector(state => selectArea(state, props.id, isPanorama))) !== null && _useAppSelector !== void 0 ? _useAppSelector : {};\n  var plotArea = usePlotArea();\n  if (layout !== 'horizontal' && layout !== 'vertical' || plotArea == null) {\n    // Can't render Area in an unsupported layout\n    return null;\n  }\n  if (chartName !== 'AreaChart' && chartName !== 'ComposedChart') {\n    // There is nothing stopping us from rendering Area in other charts, except for historical reasons. Do we want to allow that?\n    return null;\n  }\n  var {\n    height,\n    width,\n    x: left,\n    y: top\n  } = plotArea;\n  if (!points || !points.length) {\n    return null;\n  }\n  return /*#__PURE__*/React.createElement(AreaWithState, _extends({}, everythingElse, {\n    activeDot: activeDot,\n    animationBegin: animationBegin,\n    animationDuration: animationDuration,\n    animationEasing: animationEasing,\n    baseLine: baseLine,\n    connectNulls: connectNulls,\n    dot: dot,\n    fill: fill,\n    fillOpacity: fillOpacity,\n    height: height,\n    hide: hide,\n    layout: layout,\n    isAnimationActive: isAnimationActive === 'auto' ? !Global.isSsr : isAnimationActive,\n    isRange: isRange,\n    legendType: legendType,\n    needClip: needClip,\n    points: points,\n    stroke: stroke,\n    width: width,\n    left: left,\n    top: top,\n    xAxisId: xAxisId,\n    yAxisId: yAxisId\n  }));\n}\nexport var getBaseValue = (layout, chartBaseValue, itemBaseValue, xAxis, yAxis) => {\n  // The baseValue can be defined both on the AreaChart, and on the Area.\n  // The value for the item takes precedence.\n  var baseValue = itemBaseValue !== null && itemBaseValue !== void 0 ? itemBaseValue : chartBaseValue;\n  if (isNumber(baseValue)) {\n    return baseValue;\n  }\n  var numericAxis = layout === 'horizontal' ? yAxis : xAxis;\n  // @ts-expect-error d3scale .domain() returns unknown, Math.max expects number\n  var domain = numericAxis.scale.domain();\n  if (numericAxis.type === 'number') {\n    var domainMax = Math.max(domain[0], domain[1]);\n    var domainMin = Math.min(domain[0], domain[1]);\n    if (baseValue === 'dataMin') {\n      return domainMin;\n    }\n    if (baseValue === 'dataMax') {\n      return domainMax;\n    }\n    return domainMax < 0 ? domainMax : Math.max(Math.min(domain[0], domain[1]), 0);\n  }\n  if (baseValue === 'dataMin') {\n    return domain[0];\n  }\n  if (baseValue === 'dataMax') {\n    return domain[1];\n  }\n  return domain[0];\n};\nexport function computeArea(_ref0) {\n  var {\n    areaSettings: {\n      connectNulls,\n      baseValue: itemBaseValue,\n      dataKey\n    },\n    stackedData,\n    layout,\n    chartBaseValue,\n    xAxis,\n    yAxis,\n    displayedData,\n    dataStartIndex,\n    xAxisTicks,\n    yAxisTicks,\n    bandSize\n  } = _ref0;\n  var hasStack = stackedData && stackedData.length;\n  var baseValue = getBaseValue(layout, chartBaseValue, itemBaseValue, xAxis, yAxis);\n  var isHorizontalLayout = layout === 'horizontal';\n  var isRange = false;\n  var points = displayedData.map((entry, index) => {\n    var _valueAsArray$, _valueAsArray;\n    var valueAsArray;\n    if (hasStack) {\n      valueAsArray = stackedData[dataStartIndex + index];\n    } else {\n      var rawValue = getValueByDataKey(entry, dataKey);\n      if (!Array.isArray(rawValue)) {\n        // @ts-expect-error getValueByDataKey is not checking its return value\n        valueAsArray = [baseValue, rawValue];\n      } else {\n        // @ts-expect-error getValueByDataKey is not checking its return value\n        valueAsArray = rawValue;\n        isRange = true;\n      }\n    }\n    var value1 = (_valueAsArray$ = (_valueAsArray = valueAsArray) === null || _valueAsArray === void 0 ? void 0 : _valueAsArray[1]) !== null && _valueAsArray$ !== void 0 ? _valueAsArray$ : null;\n    var isBreakPoint = value1 == null || hasStack && !connectNulls && getValueByDataKey(entry, dataKey) == null;\n    if (isHorizontalLayout) {\n      return {\n        x: getCateCoordinateOfLine({\n          axis: xAxis,\n          ticks: xAxisTicks,\n          bandSize,\n          entry,\n          index\n        }),\n        y: isBreakPoint ? null : yAxis.scale(value1),\n        value: valueAsArray,\n        payload: entry\n      };\n    }\n    return {\n      x: isBreakPoint ? null : xAxis.scale(value1),\n      y: getCateCoordinateOfLine({\n        axis: yAxis,\n        ticks: yAxisTicks,\n        bandSize,\n        entry,\n        index\n      }),\n      value: valueAsArray,\n      payload: entry\n    };\n  });\n  var baseLine;\n  if (hasStack || isRange) {\n    baseLine = points.map(entry => {\n      var x = Array.isArray(entry.value) ? entry.value[0] : null;\n      if (isHorizontalLayout) {\n        return {\n          x: entry.x,\n          y: x != null && entry.y != null ? yAxis.scale(x) : null,\n          payload: entry.payload\n        };\n      }\n      return {\n        x: x != null ? xAxis.scale(x) : null,\n        y: entry.y,\n        payload: entry.payload\n      };\n    });\n  } else {\n    baseLine = isHorizontalLayout ? yAxis.scale(baseValue) : xAxis.scale(baseValue);\n  }\n  return {\n    points,\n    baseLine,\n    isRange\n  };\n}\nfunction AreaFn(outsideProps) {\n  var props = resolveDefaultProps(outsideProps, defaultAreaProps);\n  var isPanorama = useIsPanorama();\n  // Report all props to Redux store first, before calling any hooks, to avoid circular dependencies.\n  return /*#__PURE__*/React.createElement(RegisterGraphicalItemId, {\n    id: props.id,\n    type: \"area\"\n  }, id => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(SetLegendPayload, {\n    legendPayload: computeLegendPayloadFromAreaData(props)\n  }), /*#__PURE__*/React.createElement(SetAreaTooltipEntrySettings, {\n    dataKey: props.dataKey,\n    data: props.data,\n    stroke: props.stroke,\n    strokeWidth: props.strokeWidth,\n    fill: props.fill,\n    name: props.name,\n    hide: props.hide,\n    unit: props.unit,\n    tooltipType: props.tooltipType,\n    id: id\n  }), /*#__PURE__*/React.createElement(SetCartesianGraphicalItem, {\n    type: \"area\",\n    id: id,\n    data: props.data,\n    dataKey: props.dataKey,\n    xAxisId: props.xAxisId,\n    yAxisId: props.yAxisId,\n    zAxisId: 0,\n    stackId: getNormalizedStackId(props.stackId),\n    hide: props.hide,\n    barSize: undefined,\n    baseValue: props.baseValue,\n    isPanorama: isPanorama,\n    connectNulls: props.connectNulls\n  }), /*#__PURE__*/React.createElement(AreaImpl, _extends({}, props, {\n    id: id\n  }))));\n}\n\n/**\n * @provides LabelListContext\n * @consumes CartesianChartContext\n */\nexport var Area = /*#__PURE__*/React.memo(AreaFn, propsAreEqual);\nArea.displayName = 'Area';","import * as React from 'react';\nimport { forwardRef } from 'react';\nimport { arrayTooltipSearcher } from '../state/optionsSlice';\nimport { CartesianChart } from './CartesianChart';\nvar allowedTooltipTypes = ['axis'];\n\n/**\n * @provides CartesianViewBoxContext\n * @provides CartesianChartContext\n */\nexport var AreaChart = /*#__PURE__*/forwardRef((props, ref) => {\n  return /*#__PURE__*/React.createElement(CartesianChart, {\n    chartName: \"AreaChart\",\n    defaultTooltipEventType: \"axis\",\n    validateTooltipEventTypes: allowedTooltipTypes,\n    tooltipPayloadSearcher: arrayTooltipSearcher,\n    categoricalChartProps: props,\n    ref: ref\n  });\n});","/**\n * FieldSync Error Handling Utility\n *\n * Centralized error handling with proper logging, user feedback, and recovery.\n * Eliminates silent failures and provides consistent error handling patterns.\n *\n * Usage:\n *   import { handleError, withErrorHandling, safeAsync } from './errorHandler'\n *\n *   // Wrap async operations\n *   const data = await safeAsync(\n *     () => db.getTMTickets(projectId),\n *     { fallback: [], context: { operation: 'getTMTickets', projectId } }\n *   )\n *\n *   // Handle errors with toast\n *   try { ... } catch (error) {\n *     handleError(error, { operation: 'saveTicket', showToast: onShowToast })\n *   }\n */\n\nimport { observe } from './observability'\n\n// Error severity levels\nexport const ErrorSeverity = {\n  INFO: 'info',\n  WARNING: 'warning',\n  ERROR: 'error',\n  CRITICAL: 'critical'\n}\n\n// Error categories\nexport const ErrorCategory = {\n  DATABASE: 'database',\n  NETWORK: 'network',\n  AUTH: 'auth',\n  VALIDATION: 'validation',\n  STORAGE: 'storage',\n  SYNC: 'sync',\n  GENERAL: 'general'\n}\n\n/**\n * Determine error category from error object\n */\nfunction categorizeError(error) {\n  const message = error?.message?.toLowerCase() || ''\n  const code = error?.code?.toLowerCase() || ''\n\n  if (message.includes('fetch') || message.includes('network') || message.includes('offline')) {\n    return ErrorCategory.NETWORK\n  }\n  if (message.includes('auth') || message.includes('unauthorized') || code.includes('auth')) {\n    return ErrorCategory.AUTH\n  }\n  if (message.includes('storage') || message.includes('bucket') || message.includes('upload')) {\n    return ErrorCategory.STORAGE\n  }\n  if (message.includes('validation') || message.includes('invalid') || message.includes('required')) {\n    return ErrorCategory.VALIDATION\n  }\n  if (message.includes('sync') || message.includes('conflict')) {\n    return ErrorCategory.SYNC\n  }\n  if (error?.code || message.includes('database') || message.includes('supabase')) {\n    return ErrorCategory.DATABASE\n  }\n\n  return ErrorCategory.GENERAL\n}\n\n/**\n * Get user-friendly error message\n */\nfunction getUserMessage(error, category, context) {\n  // Custom message provided\n  if (context?.userMessage) {\n    return context.userMessage\n  }\n\n  // Network errors\n  if (category === ErrorCategory.NETWORK) {\n    return 'Network connection issue. Your changes will sync when back online.'\n  }\n\n  // Auth errors\n  if (category === ErrorCategory.AUTH) {\n    return 'Session expired. Please sign in again.'\n  }\n\n  // Storage errors\n  if (category === ErrorCategory.STORAGE) {\n    return 'Failed to upload file. Please try again.'\n  }\n\n  // Validation errors - show actual message\n  if (category === ErrorCategory.VALIDATION) {\n    return error?.message || 'Please check your input and try again.'\n  }\n\n  // Sync errors\n  if (category === ErrorCategory.SYNC) {\n    return 'Sync conflict detected. Please refresh and try again.'\n  }\n\n  // Database/general errors with operation context\n  if (context?.operation) {\n    const operation = context.operation.replace(/([A-Z])/g, ' $1').toLowerCase().trim()\n    return `Failed to ${operation}. Please try again.`\n  }\n\n  return 'Something went wrong. Please try again.'\n}\n\n/**\n * Main error handler\n *\n * @param {Error} error - The error object\n * @param {Object} options - Error handling options\n * @param {string} options.operation - Name of the operation that failed\n * @param {string} options.category - Error category (auto-detected if not provided)\n * @param {string} options.severity - Error severity (default: 'error')\n * @param {Function} options.showToast - Toast function to show user feedback\n * @param {string} options.userMessage - Custom user-facing message\n * @param {string} options.companyId - Company ID for context\n * @param {string} options.projectId - Project ID for context\n * @param {string} options.userId - User ID for context\n * @param {boolean} options.silent - If true, don't show toast (still logs)\n * @param {boolean} options.rethrow - If true, rethrow the error after handling\n */\nexport function handleError(error, options = {}) {\n  const {\n    operation = 'unknown',\n    category = categorizeError(error),\n    severity = ErrorSeverity.ERROR,\n    showToast,\n    userMessage,\n    companyId,\n    projectId,\n    userId,\n    silent = false,\n    rethrow = false\n  } = options\n\n  // Log to observability system\n  observe.error(category, {\n    message: error?.message || 'Unknown error',\n    code: error?.code,\n    severity,\n    operation,\n    company_id: companyId,\n    project_id: projectId,\n    user_id: userId,\n    extra: {\n      stack: error?.stack,\n      name: error?.name\n    }\n  })\n\n  // Show user feedback unless silent\n  if (!silent && showToast) {\n    const message = getUserMessage(error, category, { operation, userMessage })\n    const toastType = severity === ErrorSeverity.WARNING ? 'warning' : 'error'\n    showToast(message, toastType)\n  }\n\n  // Rethrow if requested\n  if (rethrow) {\n    throw error\n  }\n\n  return null\n}\n\n/**\n * Safe async wrapper - executes async function with error handling\n * Returns fallback value on error instead of throwing\n *\n * @param {Function} fn - Async function to execute\n * @param {Object} options - Options\n * @param {any} options.fallback - Value to return on error (default: null)\n * @param {Object} options.context - Context for error logging\n * @param {Function} options.showToast - Toast function\n * @param {boolean} options.silent - Don't show toast on error\n */\nexport async function safeAsync(fn, options = {}) {\n  const { fallback = null, context = {}, showToast, silent = true } = options\n\n  try {\n    return await fn()\n  } catch (error) {\n    handleError(error, {\n      ...context,\n      showToast,\n      silent\n    })\n    return fallback\n  }\n}\n\n/**\n * Higher-order function to wrap async functions with error handling\n *\n * @param {Function} fn - Async function to wrap\n * @param {Object} defaultOptions - Default error handling options\n */\nexport function withErrorHandling(fn, defaultOptions = {}) {\n  return async function(...args) {\n    try {\n      return await fn.apply(this, args)\n    } catch (error) {\n      handleError(error, defaultOptions)\n      return defaultOptions.fallback ?? null\n    }\n  }\n}\n\n/**\n * Create a safe version of a database operation\n * Logs errors and returns fallback instead of throwing\n *\n * @param {string} operation - Operation name for logging\n * @param {any} fallback - Fallback value on error\n */\nexport function createSafeOperation(operation, fallback = null) {\n  return (fn) => async (...args) => {\n    try {\n      return await fn(...args)\n    } catch (error) {\n      observe.error(ErrorCategory.DATABASE, {\n        message: error?.message || 'Unknown error',\n        operation,\n        severity: ErrorSeverity.ERROR\n      })\n      return fallback\n    }\n  }\n}\n\n/**\n * Batch multiple async operations with individual error handling\n * Returns results array with nulls for failed operations\n *\n * @param {Array<{fn: Function, fallback: any, context: Object}>} operations\n */\nexport async function safeBatch(operations) {\n  return Promise.all(\n    operations.map(({ fn, fallback = null, context = {} }) =>\n      safeAsync(fn, { fallback, context, silent: true })\n    )\n  )\n}\n\n/**\n * Retry wrapper for flaky operations\n *\n * @param {Function} fn - Async function to retry\n * @param {Object} options - Retry options\n * @param {number} options.maxRetries - Max retry attempts (default: 3)\n * @param {number} options.baseDelay - Base delay in ms (default: 1000)\n * @param {Function} options.shouldRetry - Function to determine if error is retryable\n */\nexport async function withRetry(fn, options = {}) {\n  const {\n    maxRetries = 3,\n    baseDelay = 1000,\n    shouldRetry = (error) => {\n      const message = error?.message?.toLowerCase() || ''\n      return message.includes('network') || message.includes('fetch') || message.includes('timeout')\n    }\n  } = options\n\n  let lastError\n\n  for (let attempt = 0; attempt < maxRetries; attempt++) {\n    try {\n      return await fn()\n    } catch (error) {\n      lastError = error\n\n      if (!shouldRetry(error) || attempt === maxRetries - 1) {\n        throw error\n      }\n\n      // Exponential backoff\n      const delay = baseDelay * Math.pow(2, attempt)\n      await new Promise(resolve => setTimeout(resolve, delay))\n    }\n  }\n\n  throw lastError\n}\n\nexport default {\n  handleError,\n  safeAsync,\n  withErrorHandling,\n  createSafeOperation,\n  safeBatch,\n  withRetry,\n  ErrorSeverity,\n  ErrorCategory\n}\n","/**\n * Risk Score Calculation Engine\n *\n * Calculates a composite risk score (0-100) for projects\n * based on multiple factors. Lower score = healthier project.\n *\n * Factors and weights:\n * - Budget Health: 30% - Cost ratio vs earned revenue\n * - Schedule Health: 25% - Progress vs expected progress\n * - COR Exposure: 20% - Pending COR value as % of contract\n * - Activity Cadence: 15% - Days since last daily report\n * - Safety Status: 10% - Recent injury reports\n */\n\n// Default thresholds (can be overridden per company)\nexport const DEFAULT_THRESHOLDS = {\n  budget: {\n    healthy: 0.60,   // Green if costs < 60% of revenue\n    warning: 0.75,   // Yellow if 60-75%\n    critical: 0.85   // Red if > 85%\n  },\n  schedule: {\n    healthy: 0.05,   // Green if within 5% of plan\n    warning: 0.15,   // Yellow if 5-15% behind\n    critical: 0.25   // Red if > 25% behind\n  },\n  corExposure: {\n    healthy: 0.05,   // Green if pending CORs < 5% of contract\n    warning: 0.15,   // Yellow if 5-15%\n    critical: 0.25   // Red if > 25%\n  },\n  activity: {\n    healthy: 1,      // Green if report within 1 day\n    warning: 3,      // Yellow if 2-3 days\n    critical: 5      // Red if > 5 days\n  },\n  safety: {\n    healthy: 0,      // Green if 0 incidents in 30 days\n    warning: 1,      // Yellow if 1 incident\n    critical: 2      // Red if 2+ incidents\n  }\n}\n\n// Factor weights (must sum to 1.0)\nexport const FACTOR_WEIGHTS = {\n  budget: 0.30,\n  schedule: 0.25,\n  corExposure: 0.20,\n  activity: 0.15,\n  safety: 0.10\n}\n\n/**\n * Calculate individual factor score (0-100)\n * 0 = healthy, 100 = critical\n */\nfunction calculateFactorScore(value, thresholds) {\n  if (value <= thresholds.healthy) return 0\n  if (value >= thresholds.critical) return 100\n\n  // Linear interpolation between healthy and critical\n  const range = thresholds.critical - thresholds.healthy\n  const excess = value - thresholds.healthy\n  return (excess / range) * 100\n}\n\n/**\n * Get status label for a factor score\n */\nfunction getFactorStatus(score) {\n  if (score <= 25) return 'healthy'\n  if (score <= 60) return 'warning'\n  return 'critical'\n}\n\n/**\n * Calculate budget health factor\n *\n * @param {number} totalCosts - Total costs to date\n * @param {number} earnedRevenue - Earned revenue to date\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateBudgetFactor(totalCosts, earnedRevenue, thresholds = DEFAULT_THRESHOLDS.budget) {\n  if (!earnedRevenue || earnedRevenue <= 0) {\n    // No revenue yet - can't calculate ratio\n    return { score: 0, status: 'healthy', ratio: 0, label: 'No revenue yet' }\n  }\n\n  const ratio = totalCosts / earnedRevenue\n\n  const score = calculateFactorScore(ratio, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (ratio < thresholds.healthy) {\n    label = `Costs at ${(ratio * 100).toFixed(0)}% of revenue`\n  } else if (ratio < thresholds.warning) {\n    label = `Costs at ${(ratio * 100).toFixed(0)}% - monitor closely`\n  } else {\n    label = `Costs at ${(ratio * 100).toFixed(0)}% - review immediately`\n  }\n\n  return { score, status, ratio, label }\n}\n\n/**\n * Calculate schedule health factor\n *\n * @param {number} actualProgress - Actual completion percentage (0-100)\n * @param {number} expectedProgress - Expected completion percentage (0-100)\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateScheduleFactor(actualProgress, expectedProgress, thresholds = DEFAULT_THRESHOLDS.schedule) {\n  if (!expectedProgress || expectedProgress <= 0) {\n    // No schedule baseline - assume on track\n    return { score: 0, status: 'healthy', variance: 0, label: 'No schedule baseline' }\n  }\n\n  // Variance as a ratio (negative = behind)\n  const variance = (expectedProgress - actualProgress) / expectedProgress\n  const absVariance = Math.max(0, variance) // Only penalize being behind\n\n  const score = calculateFactorScore(absVariance, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (variance <= 0) {\n    label = actualProgress >= 100 ? 'Complete' : 'On or ahead of schedule'\n  } else if (variance < thresholds.warning) {\n    label = `${(variance * 100).toFixed(0)}% behind schedule`\n  } else {\n    label = `${(variance * 100).toFixed(0)}% behind - needs attention`\n  }\n\n  return { score, status, variance, label }\n}\n\n/**\n * Calculate COR exposure factor\n *\n * @param {number} pendingCORValue - Total value of pending CORs\n * @param {number} contractValue - Total contract value\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateCORExposureFactor(pendingCORValue, contractValue, thresholds = DEFAULT_THRESHOLDS.corExposure) {\n  if (!contractValue || contractValue <= 0) {\n    return { score: 0, status: 'healthy', exposure: 0, label: 'No contract value' }\n  }\n\n  const exposure = pendingCORValue / contractValue\n\n  const score = calculateFactorScore(exposure, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (exposure < thresholds.healthy) {\n    label = pendingCORValue > 0 ? `$${formatNumber(pendingCORValue)} pending` : 'No pending CORs'\n  } else if (exposure < thresholds.warning) {\n    label = `$${formatNumber(pendingCORValue)} pending (${(exposure * 100).toFixed(0)}% of contract)`\n  } else {\n    label = `High exposure: $${formatNumber(pendingCORValue)} (${(exposure * 100).toFixed(0)}%)`\n  }\n\n  return { score, status, exposure, label }\n}\n\n/**\n * Calculate activity cadence factor\n *\n * @param {Date|string} lastReportDate - Date of last daily report\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateActivityFactor(lastReportDate, thresholds = DEFAULT_THRESHOLDS.activity) {\n  if (!lastReportDate) {\n    return { score: 100, status: 'critical', daysSince: null, label: 'No reports filed' }\n  }\n\n  const lastDate = new Date(lastReportDate)\n  const now = new Date()\n  const daysSince = Math.floor((now - lastDate) / (1000 * 60 * 60 * 24))\n\n  const score = calculateFactorScore(daysSince, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (daysSince === 0) {\n    label = 'Report filed today'\n  } else if (daysSince === 1) {\n    label = 'Report filed yesterday'\n  } else if (daysSince <= thresholds.warning) {\n    label = `Last report ${daysSince} days ago`\n  } else {\n    label = `No report in ${daysSince} days - may be stalled`\n  }\n\n  return { score, status, daysSince, label }\n}\n\n/**\n * Calculate safety factor\n *\n * @param {number} injuryCount - Number of injury reports in last 30 days\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateSafetyFactor(injuryCount, thresholds = DEFAULT_THRESHOLDS.safety) {\n  const count = injuryCount || 0\n\n  const score = calculateFactorScore(count, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (count === 0) {\n    label = 'No incidents'\n  } else if (count === 1) {\n    label = '1 incident in last 30 days'\n  } else {\n    label = `${count} incidents - safety review needed`\n  }\n\n  return { score, status, count, label }\n}\n\n/**\n * Calculate composite risk score\n *\n * @param {object} project - Project data object\n * @param {object} options - Optional custom thresholds and weights\n * @returns {object} Risk score result with breakdown\n */\nexport function calculateRiskScore(project, options = {}) {\n  const thresholds = { ...DEFAULT_THRESHOLDS, ...options.thresholds }\n  const weights = { ...FACTOR_WEIGHTS, ...options.weights }\n\n  // Calculate individual factors\n  const budgetFactor = calculateBudgetFactor(\n    project.totalCosts,\n    project.earnedRevenue,\n    thresholds.budget\n  )\n\n  const scheduleFactor = calculateScheduleFactor(\n    project.actualProgress,\n    project.expectedProgress,\n    thresholds.schedule\n  )\n\n  const corFactor = calculateCORExposureFactor(\n    project.pendingCORValue,\n    project.contractValue,\n    thresholds.corExposure\n  )\n\n  const activityFactor = calculateActivityFactor(\n    project.lastReportDate,\n    thresholds.activity\n  )\n\n  const safetyFactor = calculateSafetyFactor(\n    project.recentInjuryCount,\n    thresholds.safety\n  )\n\n  // Calculate weighted composite score\n  const compositeScore = Math.round(\n    budgetFactor.score * weights.budget +\n    scheduleFactor.score * weights.schedule +\n    corFactor.score * weights.corExposure +\n    activityFactor.score * weights.activity +\n    safetyFactor.score * weights.safety\n  )\n\n  // Determine overall status\n  let overallStatus\n  if (compositeScore <= 25) {\n    overallStatus = 'healthy'\n  } else if (compositeScore <= 60) {\n    overallStatus = 'warning'\n  } else {\n    overallStatus = 'critical'\n  }\n\n  // Generate summary label\n  let summaryLabel\n  if (overallStatus === 'healthy') {\n    summaryLabel = 'Project is on track'\n  } else if (overallStatus === 'warning') {\n    summaryLabel = 'Some factors need attention'\n  } else {\n    summaryLabel = 'Immediate review recommended'\n  }\n\n  return {\n    score: compositeScore,\n    status: overallStatus,\n    label: summaryLabel,\n    factors: {\n      budget: { ...budgetFactor, weight: weights.budget },\n      schedule: { ...scheduleFactor, weight: weights.schedule },\n      corExposure: { ...corFactor, weight: weights.corExposure },\n      activity: { ...activityFactor, weight: weights.activity },\n      safety: { ...safetyFactor, weight: weights.safety }\n    }\n  }\n}\n\n/**\n * Generate smart alerts based on risk factors\n *\n * @param {object} riskResult - Result from calculateRiskScore\n * @param {object} project - Project data for context\n * @returns {array} Array of alert objects\n */\nexport function generateSmartAlerts(riskResult, project) {\n  const alerts = []\n\n  const { factors } = riskResult\n\n  // Critical alerts (priority 1)\n  if (factors.budget.status === 'critical') {\n    alerts.push({\n      type: 'critical',\n      title: 'Budget Alert',\n      description: factors.budget.label,\n      action: 'Review costs immediately',\n      actionTarget: 'financials',\n      projectId: project.id\n    })\n  }\n\n  if (factors.activity.status === 'critical') {\n    alerts.push({\n      type: 'critical',\n      title: 'Activity Alert',\n      description: factors.activity.label,\n      action: 'Check project status',\n      actionTarget: 'overview',\n      projectId: project.id\n    })\n  }\n\n  if (factors.safety.status === 'critical') {\n    alerts.push({\n      type: 'critical',\n      title: 'Safety Alert',\n      description: factors.safety.label,\n      action: 'Review safety reports',\n      actionTarget: 'reports',\n      projectId: project.id\n    })\n  }\n\n  // Warning alerts (priority 2)\n  if (factors.budget.status === 'warning') {\n    alerts.push({\n      type: 'warning',\n      title: 'Budget Watch',\n      description: factors.budget.label,\n      action: 'Monitor costs',\n      actionTarget: 'financials',\n      projectId: project.id\n    })\n  }\n\n  if (factors.schedule.status === 'critical' || factors.schedule.status === 'warning') {\n    alerts.push({\n      type: factors.schedule.status === 'critical' ? 'critical' : 'warning',\n      title: 'Schedule Alert',\n      description: factors.schedule.label,\n      action: 'Review progress',\n      actionTarget: 'overview',\n      projectId: project.id\n    })\n  }\n\n  if (factors.corExposure.status === 'warning' || factors.corExposure.status === 'critical') {\n    alerts.push({\n      type: factors.corExposure.status === 'critical' ? 'critical' : 'warning',\n      title: 'COR Exposure',\n      description: factors.corExposure.label,\n      action: 'Review pending CORs',\n      actionTarget: 'cors',\n      projectId: project.id\n    })\n  }\n\n  // Info alerts (priority 3)\n  if (factors.activity.status === 'warning') {\n    alerts.push({\n      type: 'info',\n      title: 'Activity Notice',\n      description: factors.activity.label,\n      action: 'File daily report',\n      actionTarget: 'reports',\n      projectId: project.id\n    })\n  }\n\n  // Sort by priority\n  const priorityOrder = { critical: 0, warning: 1, info: 2 }\n  alerts.sort((a, b) => priorityOrder[a.type] - priorityOrder[b.type])\n\n  return alerts\n}\n\n/**\n * Calculate projections based on current trends\n */\nexport function calculateProjections(project) {\n  const { actualProgress, totalCosts, earnedRevenue, contractValue } = project\n\n  // Guard against division by zero\n  if (!actualProgress || actualProgress <= 0) {\n    return {\n      estimatedCompletionCost: null,\n      estimatedFinalMargin: null,\n      estimatedCompletionDate: null\n    }\n  }\n\n  // Project final cost based on current burn rate\n  const costPerPercent = totalCosts / actualProgress\n  const estimatedCompletionCost = Math.round(costPerPercent * 100)\n\n  // Calculate projected margin\n  const estimatedFinalMargin = contractValue > 0\n    ? ((contractValue - estimatedCompletionCost) / contractValue) * 100\n    : 0\n\n  // If we have start date and progress, estimate completion\n  // (This is simplified - real implementation would use more sophisticated projection)\n  let estimatedCompletionDate = null\n  if (project.startDate && actualProgress > 0 && actualProgress < 100) {\n    const startDate = new Date(project.startDate)\n    const now = new Date()\n    const daysElapsed = Math.max(1, (now - startDate) / (1000 * 60 * 60 * 24))\n    const progressPerDay = actualProgress / daysElapsed\n    const remainingProgress = 100 - actualProgress\n    const daysRemaining = remainingProgress / progressPerDay\n\n    estimatedCompletionDate = new Date(now.getTime() + daysRemaining * 24 * 60 * 60 * 1000)\n  }\n\n  return {\n    estimatedCompletionCost,\n    estimatedFinalMargin,\n    estimatedCompletionDate,\n    costPerPercent\n  }\n}\n\n// Helper function\nfunction formatNumber(num) {\n  if (num >= 1000000) {\n    return (num / 1000000).toFixed(1) + 'M'\n  }\n  if (num >= 1000) {\n    return (num / 1000).toFixed(0) + 'K'\n  }\n  return num.toFixed(0)\n}\n\nexport default {\n  calculateRiskScore,\n  generateSmartAlerts,\n  calculateProjections,\n  calculateBudgetFactor,\n  calculateScheduleFactor,\n  calculateCORExposureFactor,\n  calculateActivityFactor,\n  calculateSafetyFactor,\n  DEFAULT_THRESHOLDS,\n  FACTOR_WEIGHTS\n}\n","import { useMemo } from 'react'\nimport { calculateRiskScore, generateSmartAlerts, calculateProjections } from '../lib/riskCalculations'\n\n/**\n * Computes portfolio-level financial metrics, project health, schedule metrics,\n * and risk analysis from enhanced project data.\n * Extracted from Dashboard.jsx for maintainability.\n */\nexport default function usePortfolioMetrics(projectsData) {\n  const portfolioMetrics = useMemo(() => {\n    const totalOriginalContract = projectsData.reduce((sum, p) => sum + (p.contract_value || 0), 0)\n    const totalChangeOrders = projectsData.reduce((sum, p) => sum + (p.changeOrderValue || 0), 0)\n    const totalPortfolioValue = totalOriginalContract + totalChangeOrders\n    const totalEarned = projectsData.reduce((sum, p) => sum + (p.billable || 0), 0)\n    const totalRemaining = totalPortfolioValue - totalEarned\n\n    const weightedCompletion = totalPortfolioValue > 0\n      ? Math.round((totalEarned / totalPortfolioValue) * 100)\n      : 0\n\n    const totalPendingCORValue = projectsData.reduce((sum, p) => sum + (p.corPendingValue || 0), 0)\n    const totalPendingCORCount = projectsData.reduce((sum, p) => sum + (p.corPendingCount || 0), 0)\n\n    return {\n      totalOriginalContract,\n      totalChangeOrders,\n      totalPortfolioValue,\n      totalEarned,\n      totalRemaining,\n      weightedCompletion,\n      totalPendingCORValue,\n      totalPendingCORCount\n    }\n  }, [projectsData])\n\n  const projectHealth = useMemo(() => {\n    let complete = 0\n    let onTrack = 0\n    let atRisk = 0\n    let overBudget = 0\n    let withChangeOrders = 0\n\n    for (const p of projectsData) {\n      const contractVal = p.revisedContractValue || p.contract_value\n      if (p.progress >= 100) complete++\n      if (p.progress < 100 && p.billable <= contractVal * (p.progress / 100) * 1.1) onTrack++\n      if (p.billable > contractVal * 0.9 && p.progress < 90) atRisk++\n      if (p.billable > contractVal) overBudget++\n      if ((p.changeOrderValue || 0) > 0) withChangeOrders++\n    }\n\n    return {\n      projectsComplete: complete,\n      projectsOnTrack: onTrack,\n      projectsAtRisk: atRisk,\n      projectsOverBudget: overBudget,\n      projectsWithChangeOrders: withChangeOrders\n    }\n  }, [projectsData])\n\n  const scheduleMetrics = useMemo(() => {\n    let ahead = 0\n    let onTrack = 0\n    let behind = 0\n    let overLabor = 0\n    let underLabor = 0\n    let onTrackLabor = 0\n\n    for (const p of projectsData) {\n      if (p.hasScheduleData) {\n        if (p.scheduleStatus === 'ahead') ahead++\n        else if (p.scheduleStatus === 'behind') behind++\n        else onTrack++\n      }\n      if (p.hasLaborData) {\n        if (p.laborStatus === 'over') overLabor++\n        else if (p.laborStatus === 'under') underLabor++\n        else onTrackLabor++\n      }\n    }\n\n    return {\n      scheduleAhead: ahead,\n      scheduleOnTrack: onTrack,\n      scheduleBehind: behind,\n      laborOver: overLabor,\n      laborUnder: underLabor,\n      laborOnTrack: onTrackLabor,\n      hasAnyScheduleData: ahead + onTrack + behind > 0,\n      hasAnyLaborData: overLabor + underLabor + onTrackLabor > 0\n    }\n  }, [projectsData])\n\n  const riskAnalysis = useMemo(() => {\n    const projectRisks = projectsData.map(p => {\n      const riskInput = {\n        id: p.id,\n        name: p.name,\n        totalCosts: p.totalCosts || 0,\n        earnedRevenue: p.billable || 0,\n        actualProgress: p.progress || 0,\n        expectedProgress: p.expectedProgress || p.progress,\n        pendingCORValue: p.corPendingValue || 0,\n        contractValue: p.revisedContractValue || p.contract_value || 0,\n        lastReportDate: p.lastDailyReport,\n        recentInjuryCount: p.recentInjuryCount || 0,\n        startDate: p.start_date\n      }\n\n      const riskResult = calculateRiskScore(riskInput)\n      const alerts = generateSmartAlerts(riskResult, { ...riskInput, name: p.name })\n      const projections = calculateProjections(riskInput)\n\n      const alertsWithProject = alerts.map(a => ({\n        ...a,\n        projectName: p.name,\n        projectId: p.id\n      }))\n\n      return {\n        projectId: p.id,\n        projectName: p.name,\n        riskScore: riskResult.score,\n        riskStatus: riskResult.status,\n        riskLabel: riskResult.label,\n        factors: riskResult.factors,\n        alerts: alertsWithProject,\n        projections\n      }\n    })\n\n    const allAlerts = projectRisks\n      .flatMap(p => p.alerts)\n      .sort((a, b) => {\n        const priority = { critical: 0, warning: 1, info: 2 }\n        return priority[a.type] - priority[b.type]\n      })\n\n    return {\n      projectRisks,\n      allAlerts,\n      criticalCount: allAlerts.filter(a => a.type === 'critical').length,\n      warningCount: allAlerts.filter(a => a.type === 'warning').length\n    }\n  }, [projectsData])\n\n  return { portfolioMetrics, projectHealth, scheduleMetrics, riskAnalysis }\n}\n","import { useState } from 'react'\nimport { db } from '../lib/supabase'\n\n/**\n * Manages project edit mode state and handlers.\n * Extracted from Dashboard.jsx for maintainability.\n */\nexport default function useProjectEdit({ selectedProject, areas, company, onShowToast, loadAreas, setSelectedProject }) {\n  const [editMode, setEditMode] = useState(false)\n  const [editData, setEditData] = useState(null)\n  const [saving, setSaving] = useState(false)\n\n  const handleEditClick = () => {\n    setEditData({\n      name: selectedProject.name,\n      job_number: selectedProject.job_number || '',\n      address: selectedProject.address || '',\n      general_contractor: selectedProject.general_contractor || '',\n      client_contact: selectedProject.client_contact || '',\n      client_phone: selectedProject.client_phone || '',\n      contract_value: selectedProject.contract_value,\n      work_type: selectedProject.work_type || 'demolition',\n      job_type: selectedProject.job_type || 'standard',\n      pin: selectedProject.pin || '',\n      default_dump_site_id: selectedProject.default_dump_site_id || '',\n      areas: areas.map(a => ({\n        id: a.id,\n        name: a.name,\n        weight: a.weight,\n        isNew: false\n      }))\n    })\n    setEditMode(true)\n  }\n\n  const handleCancelEdit = () => {\n    setEditMode(false)\n    setEditData(null)\n  }\n\n  const handleEditChange = (field, value) => {\n    setEditData(prev => ({ ...prev, [field]: value }))\n  }\n\n  const handleAreaEditChange = (index, field, value) => {\n    setEditData(prev => ({\n      ...prev,\n      areas: prev.areas.map((area, i) =>\n        i === index ? { ...area, [field]: value } : area\n      )\n    }))\n  }\n\n  const handleAddArea = () => {\n    setEditData(prev => ({\n      ...prev,\n      areas: [...prev.areas, { id: null, name: '', weight: '', isNew: true }]\n    }))\n  }\n\n  const handleRemoveArea = (index) => {\n    if (editData.areas.length > 1) {\n      setEditData(prev => ({\n        ...prev,\n        areas: prev.areas.filter((_, i) => i !== index)\n      }))\n    }\n  }\n\n  const handleSaveEdit = async () => {\n    if (!editData.name.trim()) {\n      onShowToast('Please enter a project name', 'error')\n      return\n    }\n\n    const contractVal = parseFloat(editData.contract_value)\n    if (!contractVal || contractVal <= 0) {\n      onShowToast('Please enter a valid contract value', 'error')\n      return\n    }\n\n    if (editData.pin && editData.pin.length !== 4) {\n      onShowToast('PIN must be 4 digits', 'error')\n      return\n    }\n\n    if (editData.pin && editData.pin !== selectedProject.pin) {\n      const pinAvailable = await db.isPinAvailable(editData.pin, selectedProject.id)\n      if (!pinAvailable) {\n        onShowToast('This PIN is already in use', 'error')\n        return\n      }\n    }\n\n    const validAreas = editData.areas.filter(a => a.name.trim() && parseFloat(a.weight) > 0)\n    if (validAreas.length === 0) {\n      onShowToast('Please add at least one area', 'error')\n      return\n    }\n\n    const totalWeight = validAreas.reduce((sum, a) => sum + parseFloat(a.weight), 0)\n    if (totalWeight !== 100) {\n      onShowToast('Area weights must total 100%', 'error')\n      return\n    }\n\n    setSaving(true)\n\n    try {\n      await db.updateProject(selectedProject.id, {\n        name: editData.name.trim(),\n        job_number: editData.job_number?.trim() || null,\n        address: editData.address?.trim() || null,\n        general_contractor: editData.general_contractor?.trim() || null,\n        client_contact: editData.client_contact?.trim() || null,\n        client_phone: editData.client_phone?.trim() || null,\n        contract_value: contractVal,\n        work_type: editData.work_type || 'demolition',\n        job_type: editData.job_type || 'standard',\n        pin: editData.pin || null,\n        default_dump_site_id: editData.default_dump_site_id || null\n      }, company?.id)\n\n      const existingAreaIds = areas.map(a => a.id)\n      const editAreaIds = editData.areas.filter(a => a.id).map(a => a.id)\n\n      for (const areaId of existingAreaIds) {\n        if (!editAreaIds.includes(areaId)) {\n          await db.deleteArea(areaId)\n        }\n      }\n\n      for (let i = 0; i < validAreas.length; i++) {\n        const area = validAreas[i]\n        if (area.id) {\n          await db.updateArea(area.id, {\n            name: area.name.trim(),\n            weight: parseFloat(area.weight),\n            sort_order: i\n          })\n        } else {\n          await db.createArea({\n            project_id: selectedProject.id,\n            name: area.name.trim(),\n            weight: parseFloat(area.weight),\n            status: 'not_started',\n            sort_order: i\n          })\n        }\n      }\n\n      const updatedProject = await db.getProject(selectedProject.id)\n      setSelectedProject(updatedProject)\n      await loadAreas(selectedProject.id)\n\n      setEditMode(false)\n      setEditData(null)\n      onShowToast('Project updated!', 'success')\n    } catch (error) {\n      console.error('Error saving project:', error?.message || error)\n      onShowToast(error?.message || 'Error saving changes', 'error')\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const handleDeleteProject = async (loadProjects) => {\n    if (!confirm('Are you sure you want to delete this project? This cannot be undone.')) {\n      return\n    }\n\n    try {\n      await db.deleteProject(selectedProject.id, company?.id)\n      setSelectedProject(null)\n      onShowToast('Project deleted', 'success')\n      if (typeof loadProjects === 'function') loadProjects()\n    } catch (error) {\n      console.error('Error deleting project:', error)\n      onShowToast(error?.message || 'Error deleting project', 'error')\n    }\n  }\n\n  return {\n    editMode,\n    editData,\n    saving,\n    handleEditClick,\n    handleCancelEdit,\n    handleEditChange,\n    handleAreaEditChange,\n    handleAddArea,\n    handleRemoveArea,\n    handleSaveEdit,\n    handleDeleteProject\n  }\n}\n","/**\n * Field Document PDF Export\n * Exports field-submitted documents (daily reports, incident reports, crew check-ins)\n * as a consolidated or individual PDF report.\n */\n\nconst loadJsPDF = () => import('jspdf')\n\nconst PAGE_WIDTH = 210 // A4 width in mm\nconst MARGIN = 14\nconst CONTENT_WIDTH = PAGE_WIDTH - MARGIN * 2\n\n/**\n * Format currency for display\n */\nconst formatCurrency = (value) => {\n  return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(value || 0)\n}\n\n/**\n * Format date for display\n */\nconst formatDate = (dateStr) => {\n  if (!dateStr) return ''\n  const d = new Date(dateStr + (dateStr.includes('T') ? '' : 'T12:00:00'))\n  return d.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric', year: 'numeric' })\n}\n\n/**\n * Add page footer\n */\nconst addFooter = (doc, pageNum, totalPages) => {\n  const y = doc.internal.pageSize.height - 8\n  doc.setFontSize(7)\n  doc.setTextColor(128, 128, 128)\n  doc.text(`Page ${pageNum} of ${totalPages}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  doc.text(`Generated ${new Date().toLocaleString()}  FieldSync`, PAGE_WIDTH - MARGIN, y, { align: 'right' })\n}\n\n/**\n * Check if we need a new page\n */\nconst checkPage = (doc, y, needed = 30) => {\n  if (y + needed > doc.internal.pageSize.height - 20) {\n    doc.addPage()\n    return 20\n  }\n  return y\n}\n\n/**\n * Export daily reports as PDF\n * @param {Array} reports - Daily report objects\n * @param {Object} project - Project info\n * @returns {Promise<void>}\n */\nexport async function exportDailyReportsPDF(reports, project) {\n  const jsPDFModule = await loadJsPDF()\n  const jsPDF = jsPDFModule.default\n  const doc = new jsPDF()\n\n  let y = 20\n\n  // Title\n  doc.setFontSize(18)\n  doc.setFont(undefined, 'bold')\n  doc.text('Daily Reports', PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 8\n\n  doc.setFontSize(11)\n  doc.setFont(undefined, 'normal')\n  doc.text(`Project: ${project.name}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 6\n  doc.text(`${reports.length} report${reports.length !== 1 ? 's' : ''}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 12\n\n  // Each report\n  reports.forEach((report, idx) => {\n    y = checkPage(doc, y, 60)\n\n    // Report header\n    doc.setDrawColor(200, 200, 200)\n    doc.setFillColor(245, 247, 250)\n    doc.roundedRect(MARGIN, y - 2, CONTENT_WIDTH, 10, 2, 2, 'F')\n\n    doc.setFontSize(11)\n    doc.setFont(undefined, 'bold')\n    doc.setTextColor(30, 30, 30)\n    doc.text(`${formatDate(report.report_date)}`, MARGIN + 4, y + 5)\n\n    const statusText = report.status === 'submitted' ? 'Submitted' : 'Draft'\n    doc.setFontSize(9)\n    doc.setFont(undefined, 'normal')\n    doc.text(statusText, PAGE_WIDTH - MARGIN - 4, y + 5, { align: 'right' })\n    y += 14\n\n    doc.setTextColor(0, 0, 0)\n\n    // Metrics row\n    doc.setFontSize(9)\n    const metrics = [\n      `Crew: ${report.crew_count || 0}`,\n      `Tasks: ${report.tasks_completed || 0}/${report.tasks_total || 0}`,\n      `T&M Tickets: ${report.tm_tickets_count || 0}`,\n      `Photos: ${report.photos_count || 0}`\n    ]\n    doc.text(metrics.join('    |    '), MARGIN + 4, y)\n    y += 7\n\n    // Crew list\n    if (report.crew_list?.length > 0) {\n      doc.setFont(undefined, 'bold')\n      doc.text('Crew:', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      const crewNames = report.crew_list.map(w => `${w.name} (${w.role || 'Laborer'})`).join(', ')\n      const crewLines = doc.splitTextToSize(crewNames, CONTENT_WIDTH - 8)\n      y += 4\n      doc.text(crewLines, MARGIN + 4, y)\n      y += crewLines.length * 4 + 2\n    }\n\n    // Field notes\n    if (report.field_notes) {\n      y = checkPage(doc, y, 15)\n      doc.setFont(undefined, 'bold')\n      doc.text('Field Notes:', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      y += 4\n      const noteLines = doc.splitTextToSize(report.field_notes, CONTENT_WIDTH - 8)\n      doc.text(noteLines, MARGIN + 4, y)\n      y += noteLines.length * 4 + 2\n    }\n\n    // Issues\n    if (report.issues) {\n      y = checkPage(doc, y, 15)\n      doc.setFont(undefined, 'bold')\n      doc.text('Issues:', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      y += 4\n      const issueLines = doc.splitTextToSize(report.issues, CONTENT_WIDTH - 8)\n      doc.text(issueLines, MARGIN + 4, y)\n      y += issueLines.length * 4 + 2\n    }\n\n    y += 8\n\n    // Divider\n    if (idx < reports.length - 1) {\n      doc.setDrawColor(220, 220, 220)\n      doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n      y += 6\n    }\n  })\n\n  const fileName = `${project.name}_Daily_Reports_${new Date().toISOString().split('T')[0]}.pdf`\n  doc.save(fileName)\n}\n\n/**\n * Export incident/injury reports as PDF\n * @param {Array} reports - Injury report objects\n * @param {Object} project - Project info\n * @returns {Promise<void>}\n */\nexport async function exportIncidentReportsPDF(reports, project) {\n  const jsPDFModule = await loadJsPDF()\n  const jsPDF = jsPDFModule.default\n  const doc = new jsPDF()\n\n  let y = 20\n\n  // Title\n  doc.setFontSize(18)\n  doc.setFont(undefined, 'bold')\n  doc.text('Incident / Injury Reports', PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 8\n\n  doc.setFontSize(11)\n  doc.setFont(undefined, 'normal')\n  doc.text(`Project: ${project.name}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 6\n  doc.text(`${reports.length} report${reports.length !== 1 ? 's' : ''}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 12\n\n  reports.forEach((report, idx) => {\n    y = checkPage(doc, y, 50)\n\n    // Header bar\n    const severityColors = {\n      minor: [34, 197, 94],\n      serious: [245, 158, 11],\n      critical: [239, 68, 68],\n      near_miss: [59, 130, 246]\n    }\n    const color = severityColors[report.injury_type] || [128, 128, 128]\n\n    doc.setFillColor(...color)\n    doc.roundedRect(MARGIN, y - 2, 3, 14, 1, 1, 'F')\n\n    doc.setFontSize(11)\n    doc.setFont(undefined, 'bold')\n    doc.setTextColor(30, 30, 30)\n    doc.text(`${formatDate(report.incident_date)}`, MARGIN + 8, y + 4)\n\n    doc.setFontSize(9)\n    const typeLabel = (report.injury_type || '').replace('_', ' ').toUpperCase()\n    doc.text(typeLabel, MARGIN + 8, y + 10)\n\n    doc.setFont(undefined, 'normal')\n    doc.text(report.status === 'open' ? 'OPEN' : 'CLOSED', PAGE_WIDTH - MARGIN - 4, y + 4, { align: 'right' })\n    y += 16\n\n    doc.setTextColor(0, 0, 0)\n\n    // Description\n    if (report.description) {\n      doc.setFontSize(9)\n      doc.setFont(undefined, 'bold')\n      doc.text('Description:', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      y += 4\n      const lines = doc.splitTextToSize(report.description, CONTENT_WIDTH - 8)\n      doc.text(lines, MARGIN + 4, y)\n      y += lines.length * 4 + 2\n    }\n\n    // Location\n    if (report.location) {\n      doc.setFont(undefined, 'bold')\n      doc.text('Location: ', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      doc.text(report.location, MARGIN + 30, y)\n      y += 6\n    }\n\n    y += 6\n\n    if (idx < reports.length - 1) {\n      doc.setDrawColor(220, 220, 220)\n      doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n      y += 6\n    }\n  })\n\n  const fileName = `${project.name}_Incident_Reports_${new Date().toISOString().split('T')[0]}.pdf`\n  doc.save(fileName)\n}\n\n/**\n * Export crew check-in history as PDF\n * @param {Array} checkins - Crew check-in objects\n * @param {Object} project - Project info\n * @returns {Promise<void>}\n */\nexport async function exportCrewCheckinsPDF(checkins, project) {\n  const jsPDFModule = await loadJsPDF()\n  const jsPDF = jsPDFModule.default\n  const doc = new jsPDF()\n\n  let y = 20\n\n  doc.setFontSize(18)\n  doc.setFont(undefined, 'bold')\n  doc.text('Crew Check-In History', PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 8\n\n  doc.setFontSize(11)\n  doc.setFont(undefined, 'normal')\n  doc.text(`Project: ${project.name}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 6\n  doc.text(`${checkins.length} check-in${checkins.length !== 1 ? 's' : ''}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 12\n\n  checkins.forEach((checkin, idx) => {\n    y = checkPage(doc, y, 30)\n    const workers = checkin.workers || []\n\n    // Date header\n    doc.setFillColor(245, 247, 250)\n    doc.roundedRect(MARGIN, y - 2, CONTENT_WIDTH, 9, 2, 2, 'F')\n\n    doc.setFontSize(10)\n    doc.setFont(undefined, 'bold')\n    doc.setTextColor(30, 30, 30)\n    doc.text(formatDate(checkin.check_in_date), MARGIN + 4, y + 4)\n    doc.setFont(undefined, 'normal')\n    doc.text(`${workers.length} workers`, PAGE_WIDTH - MARGIN - 4, y + 4, { align: 'right' })\n    y += 12\n\n    doc.setTextColor(0, 0, 0)\n    doc.setFontSize(9)\n\n    // Worker list as table\n    if (workers.length > 0) {\n      doc.setFont(undefined, 'bold')\n      doc.text('Name', MARGIN + 4, y)\n      doc.text('Role', 110, y)\n      y += 5\n\n      doc.setFont(undefined, 'normal')\n      workers.forEach(w => {\n        y = checkPage(doc, y, 6)\n        doc.text(w.name || '', MARGIN + 4, y)\n        doc.text(w.role || 'Laborer', 110, y)\n        y += 4.5\n      })\n    }\n\n    y += 6\n\n    if (idx < checkins.length - 1) {\n      doc.setDrawColor(220, 220, 220)\n      doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n      y += 5\n    }\n  })\n\n  const fileName = `${project.name}_Crew_Checkins_${new Date().toISOString().split('T')[0]}.pdf`\n  doc.save(fileName)\n}\n\n/**\n * Export ALL field documents as a single consolidated PDF\n * @param {Object} params\n * @param {Array} params.dailyReports\n * @param {Array} params.incidentReports\n * @param {Array} params.crewCheckins\n * @param {Object} params.project\n * @returns {Promise<void>}\n */\nexport async function exportAllFieldDocumentsPDF({ dailyReports = [], incidentReports = [], crewCheckins = [], project }) {\n  const jsPDFModule = await loadJsPDF()\n  const jsPDF = jsPDFModule.default\n  const doc = new jsPDF()\n\n  let y = 20\n\n  // Cover page\n  doc.setFontSize(22)\n  doc.setFont(undefined, 'bold')\n  doc.text('Field Documents Report', PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 10\n\n  doc.setFontSize(13)\n  doc.setFont(undefined, 'normal')\n  doc.text(`Project: ${project.name}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 8\n\n  doc.setFontSize(10)\n  doc.text(`Generated: ${new Date().toLocaleDateString()}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 16\n\n  // Summary table\n  doc.setFontSize(11)\n  doc.setFont(undefined, 'bold')\n  doc.text('Document Summary', MARGIN, y)\n  y += 8\n\n  doc.setFontSize(10)\n  doc.setFont(undefined, 'normal')\n  const summaryItems = [\n    [`Daily Reports`, `${dailyReports.length}`],\n    [`Incident Reports`, `${incidentReports.length}`],\n    [`Crew Check-Ins`, `${crewCheckins.length}`]\n  ]\n  summaryItems.forEach(([label, count]) => {\n    doc.text(label, MARGIN + 4, y)\n    doc.text(count, 100, y)\n    y += 6\n  })\n\n  // Daily Reports Section\n  if (dailyReports.length > 0) {\n    doc.addPage()\n    y = 20\n\n    doc.setFontSize(16)\n    doc.setFont(undefined, 'bold')\n    doc.text('Daily Reports', MARGIN, y)\n    y += 10\n\n    dailyReports.forEach((report, idx) => {\n      y = checkPage(doc, y, 40)\n\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'bold')\n      doc.setTextColor(30, 30, 30)\n      doc.text(formatDate(report.report_date), MARGIN + 2, y)\n      doc.setFont(undefined, 'normal')\n      doc.setFontSize(8)\n      doc.text(`Crew: ${report.crew_count || 0} | Tasks: ${report.tasks_completed || 0}/${report.tasks_total || 0} | T&M: ${report.tm_tickets_count || 0}`, MARGIN + 60, y)\n      y += 6\n\n      doc.setTextColor(0, 0, 0)\n      doc.setFontSize(9)\n\n      if (report.field_notes) {\n        const lines = doc.splitTextToSize(report.field_notes, CONTENT_WIDTH - 4)\n        doc.text(lines, MARGIN + 2, y)\n        y += lines.length * 4 + 2\n      }\n\n      if (report.issues) {\n        doc.setFont(undefined, 'bold')\n        doc.text('Issues: ', MARGIN + 2, y)\n        doc.setFont(undefined, 'normal')\n        const issueLines = doc.splitTextToSize(report.issues, CONTENT_WIDTH - 20)\n        doc.text(issueLines, MARGIN + 20, y)\n        y += issueLines.length * 4 + 2\n      }\n\n      y += 4\n      if (idx < dailyReports.length - 1) {\n        doc.setDrawColor(220, 220, 220)\n        doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n        y += 4\n      }\n    })\n  }\n\n  // Incident Reports Section\n  if (incidentReports.length > 0) {\n    doc.addPage()\n    y = 20\n\n    doc.setFontSize(16)\n    doc.setFont(undefined, 'bold')\n    doc.text('Incident / Injury Reports', MARGIN, y)\n    y += 10\n\n    incidentReports.forEach((report, idx) => {\n      y = checkPage(doc, y, 35)\n\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'bold')\n      doc.setTextColor(30, 30, 30)\n      doc.text(formatDate(report.incident_date), MARGIN + 2, y)\n      doc.setFontSize(8)\n      doc.setFont(undefined, 'normal')\n      const typeLabel = (report.injury_type || '').replace('_', ' ').toUpperCase()\n      doc.text(`${typeLabel}  ${report.status?.toUpperCase() || ''}`, MARGIN + 60, y)\n      y += 6\n\n      doc.setTextColor(0, 0, 0)\n      doc.setFontSize(9)\n\n      if (report.description) {\n        const lines = doc.splitTextToSize(report.description, CONTENT_WIDTH - 4)\n        doc.text(lines, MARGIN + 2, y)\n        y += lines.length * 4 + 2\n      }\n\n      if (report.location) {\n        doc.text(`Location: ${report.location}`, MARGIN + 2, y)\n        y += 5\n      }\n\n      y += 4\n      if (idx < incidentReports.length - 1) {\n        doc.setDrawColor(220, 220, 220)\n        doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n        y += 4\n      }\n    })\n  }\n\n  // Crew Check-Ins Section\n  if (crewCheckins.length > 0) {\n    doc.addPage()\n    y = 20\n\n    doc.setFontSize(16)\n    doc.setFont(undefined, 'bold')\n    doc.text('Crew Check-In History', MARGIN, y)\n    y += 10\n\n    crewCheckins.forEach((checkin, idx) => {\n      y = checkPage(doc, y, 20)\n      const workers = checkin.workers || []\n\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'bold')\n      doc.setTextColor(30, 30, 30)\n      doc.text(formatDate(checkin.check_in_date), MARGIN + 2, y)\n      doc.setFont(undefined, 'normal')\n      doc.setFontSize(8)\n      doc.text(`${workers.length} workers`, MARGIN + 60, y)\n      y += 6\n\n      doc.setTextColor(0, 0, 0)\n      doc.setFontSize(8)\n\n      if (workers.length > 0) {\n        const workerList = workers.map(w => `${w.name} (${w.role || 'Laborer'})`).join(', ')\n        const lines = doc.splitTextToSize(workerList, CONTENT_WIDTH - 4)\n        doc.text(lines, MARGIN + 2, y)\n        y += lines.length * 3.5 + 3\n      }\n\n      if (idx < crewCheckins.length - 1) {\n        doc.setDrawColor(230, 230, 230)\n        doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n        y += 3\n      }\n    })\n  }\n\n  const fileName = `${project.name}_Field_Documents_${new Date().toISOString().split('T')[0]}.pdf`\n  doc.save(fileName)\n}\n","/**\n * Financial Export Module\n * Generates CSV/IIF exports for accounting integration\n */\n\n// Helper to trigger file download\nfunction downloadFile(content, filename, mimeType = 'text/csv') {\n  const blob = new Blob([content], { type: mimeType })\n  const url = URL.createObjectURL(blob)\n  const a = document.createElement('a')\n  a.href = url\n  a.download = filename\n  document.body.appendChild(a)\n  a.click()\n  document.body.removeChild(a)\n  URL.revokeObjectURL(url)\n}\n\n// Escape CSV field (handle commas, quotes, newlines, and formula injection)\nexport function escapeCSV(value) {\n  if (value == null) return ''\n  let str = String(value)\n  // Prevent CSV formula injection: prefix dangerous first characters with a single quote\n  if (/^[=+\\-@\\t\\r]/.test(str)) {\n    str = \"'\" + str\n  }\n  if (str.includes(',') || str.includes('\"') || str.includes('\\n')) {\n    return `\"${str.replace(/\"/g, '\"\"')}\"`\n  }\n  return str\n}\n\n// Convert array of objects to CSV string\nexport function toCSV(headers, rows) {\n  const headerLine = headers.map(h => escapeCSV(h.label)).join(',')\n  const dataLines = rows.map(row =>\n    headers.map(h => escapeCSV(row[h.key])).join(',')\n  )\n  return [headerLine, ...dataLines].join('\\n')\n}\n\n/**\n * Export project financial summary as CSV\n */\nexport function exportProjectFinancials(project, financialData) {\n  const headers = [\n    { key: 'category', label: 'Category' },\n    { key: 'description', label: 'Description' },\n    { key: 'amount', label: 'Amount' },\n    { key: 'date', label: 'Date' },\n    { key: 'type', label: 'Type' }\n  ]\n\n  const rows = []\n\n  // Contract value\n  rows.push({ category: 'Revenue', description: 'Original Contract Value', amount: project.contract_value || 0, date: project.start_date || '', type: 'Contract' })\n\n  // Earned revenue\n  if (financialData?.earnedRevenue) {\n    rows.push({ category: 'Revenue', description: 'Earned Revenue (Progress)', amount: financialData.earnedRevenue, date: new Date().toISOString().split('T')[0], type: 'Earned' })\n  }\n\n  // Approved CORs\n  if (financialData?.approvedCORs) {\n    financialData.approvedCORs.forEach(cor => {\n      rows.push({ category: 'Revenue', description: `COR: ${cor.cor_number} - ${cor.title}`, amount: (cor.cor_total || 0) / 100, date: cor.approved_at?.split('T')[0] || '', type: 'Change Order' })\n    })\n  }\n\n  // Labor costs\n  if (financialData?.laborByDate) {\n    financialData.laborByDate.forEach(d => {\n      rows.push({ category: 'Cost', description: 'Labor', amount: d.cost, date: d.date, type: 'Labor' })\n    })\n  }\n\n  // Disposal costs\n  if (financialData?.haulOffByDate) {\n    financialData.haulOffByDate.forEach(d => {\n      rows.push({ category: 'Cost', description: 'Disposal/Haul-off', amount: d.cost, date: d.date, type: 'Disposal' })\n    })\n  }\n\n  // Custom costs\n  if (financialData?.customCosts) {\n    financialData.customCosts.forEach(c => {\n      rows.push({ category: 'Cost', description: c.description || c.category || 'Other', amount: parseFloat(c.amount) || 0, date: c.cost_date || '', type: c.category || 'Other' })\n    })\n  }\n\n  // Summary row\n  const totalRevenue = rows.filter(r => r.category === 'Revenue').reduce((s, r) => s + (parseFloat(r.amount) || 0), 0)\n  const totalCosts = rows.filter(r => r.category === 'Cost').reduce((s, r) => s + (parseFloat(r.amount) || 0), 0)\n  rows.push({ category: '', description: '', amount: '', date: '', type: '' })\n  rows.push({ category: 'Summary', description: 'Total Revenue', amount: totalRevenue, date: '', type: '' })\n  rows.push({ category: 'Summary', description: 'Total Costs', amount: totalCosts, date: '', type: '' })\n  rows.push({ category: 'Summary', description: 'Gross Profit', amount: totalRevenue - totalCosts, date: '', type: '' })\n  rows.push({ category: 'Summary', description: 'Margin %', amount: totalRevenue > 0 ? ((totalRevenue - totalCosts) / totalRevenue * 100).toFixed(1) + '%' : 'N/A', date: '', type: '' })\n\n  const csv = toCSV(headers, rows)\n  const filename = `${project.name.replace(/[^a-zA-Z0-9]/g, '_')}_Financials_${new Date().toISOString().split('T')[0]}.csv`\n  downloadFile(csv, filename)\n}\n\n/**\n * Export COR detail as CSV\n */\nexport function exportCORDetail(cor, project) {\n  const rows = []\n  const headers = [\n    { key: 'section', label: 'Section' },\n    { key: 'description', label: 'Description' },\n    { key: 'quantity', label: 'Quantity' },\n    { key: 'unit', label: 'Unit' },\n    { key: 'rate', label: 'Rate' },\n    { key: 'total', label: 'Total' }\n  ]\n\n  // COR header info\n  rows.push({ section: 'COR Info', description: `${cor.cor_number} - ${cor.title}`, quantity: '', unit: '', rate: '', total: '' })\n  rows.push({ section: 'Status', description: cor.status, quantity: '', unit: '', rate: '', total: '' })\n  rows.push({ section: 'Period', description: `${cor.period_start || ''} to ${cor.period_end || ''}`, quantity: '', unit: '', rate: '', total: '' })\n  rows.push({ section: '', description: '', quantity: '', unit: '', rate: '', total: '' })\n\n  // Labor\n  if (cor.change_order_labor?.length > 0) {\n    rows.push({ section: 'LABOR', description: '', quantity: '', unit: '', rate: '', total: '' })\n    cor.change_order_labor.forEach(item => {\n      const regHrs = parseFloat(item.regular_hours) || 0\n      const otHrs = parseFloat(item.overtime_hours) || 0\n      rows.push({ section: '', description: item.description || item.classification, quantity: regHrs + otHrs, unit: 'hours', rate: (parseInt(item.regular_rate) || 0) / 100, total: (parseInt(item.total) || 0) / 100 })\n    })\n  }\n\n  // Materials\n  if (cor.change_order_materials?.length > 0) {\n    rows.push({ section: 'MATERIALS', description: '', quantity: '', unit: '', rate: '', total: '' })\n    cor.change_order_materials.forEach(item => {\n      rows.push({ section: '', description: item.description, quantity: parseFloat(item.quantity) || 0, unit: item.unit || 'each', rate: (parseInt(item.unit_cost) || 0) / 100, total: (parseInt(item.total) || 0) / 100 })\n    })\n  }\n\n  // Equipment\n  if (cor.change_order_equipment?.length > 0) {\n    rows.push({ section: 'EQUIPMENT', description: '', quantity: '', unit: '', rate: '', total: '' })\n    cor.change_order_equipment.forEach(item => {\n      rows.push({ section: '', description: item.description, quantity: parseFloat(item.quantity) || 0, unit: item.unit || 'day', rate: (parseInt(item.unit_cost) || 0) / 100, total: (parseInt(item.total) || 0) / 100 })\n    })\n  }\n\n  // Subcontractors\n  if (cor.change_order_subcontractors?.length > 0) {\n    rows.push({ section: 'SUBCONTRACTORS', description: '', quantity: '', unit: '', rate: '', total: '' })\n    cor.change_order_subcontractors.forEach(item => {\n      rows.push({ section: '', description: item.description, quantity: parseFloat(item.quantity) || 0, unit: item.unit || 'lump sum', rate: (parseInt(item.unit_cost) || 0) / 100, total: (parseInt(item.total) || 0) / 100 })\n    })\n  }\n\n  const csv = toCSV(headers, rows)\n  const filename = `COR_${cor.cor_number || cor.id}_${new Date().toISOString().split('T')[0]}.csv`\n  downloadFile(csv, filename)\n}\n\n/**\n * Export T&M tickets as CSV\n */\nexport function exportTMTicketsCSV(tickets, project) {\n  const headers = [\n    { key: 'date', label: 'Date' },\n    { key: 'status', label: 'Status' },\n    { key: 'workers', label: 'Worker Count' },\n    { key: 'totalHours', label: 'Total Hours' },\n    { key: 'otHours', label: 'OT Hours' },\n    { key: 'materialsCost', label: 'Materials Cost' },\n    { key: 'corNumber', label: 'COR #' },\n    { key: 'notes', label: 'Notes' }\n  ]\n\n  const rows = tickets.map(t => {\n    const workers = t.t_and_m_workers || []\n    const items = t.t_and_m_items || []\n    const totalHours = workers.reduce((s, w) => s + (parseFloat(w.hours) || 0), 0)\n    const otHours = workers.reduce((s, w) => s + (parseFloat(w.overtime_hours) || 0), 0)\n    const materialsCost = items.reduce((s, i) => s + ((parseFloat(i.quantity) || 0) * (i.materials_equipment?.cost_per_unit || 0)), 0)\n\n    return {\n      date: t.work_date,\n      status: t.status,\n      workers: workers.length,\n      totalHours: (totalHours + otHours).toFixed(1),\n      otHours: otHours.toFixed(1),\n      materialsCost: materialsCost.toFixed(2),\n      corNumber: t.assigned_cor_id ? 'Linked' : '',\n      notes: t.notes || ''\n    }\n  })\n\n  const csv = toCSV(headers, rows)\n  const filename = `${project.name.replace(/[^a-zA-Z0-9]/g, '_')}_TM_Tickets_${new Date().toISOString().split('T')[0]}.csv`\n  downloadFile(csv, filename)\n}\n\n/**\n * Export to QuickBooks IIF format (General Journal Entry)\n * IIF = Intuit Interchange Format - importable by QuickBooks Desktop\n */\nexport function exportToQuickBooksIIF(project, financialData) {\n  const lines = []\n  const txnDate = new Date().toLocaleDateString('en-US', { month: '2-digit', day: '2-digit', year: 'numeric' })\n  // Sanitize project name for IIF (strip tabs/newlines that could break format)\n  const safeName = (project.name || '').replace(/[\\t\\r\\n]/g, ' ')\n\n  // IIF Header\n  lines.push('!TRNS\\tTRNSTYPE\\tDATE\\tACCNT\\tNAME\\tAMOUNT\\tMEMO')\n  lines.push('!SPL\\tTRNSTYPE\\tDATE\\tACCNT\\tNAME\\tAMOUNT\\tMEMO')\n  lines.push('!ENDTRNS')\n\n  // Revenue entry\n  const totalRevenue = (project.contract_value || 0)\n  lines.push(`TRNS\\tGENERAL JOURNAL\\t${txnDate}\\tAccounts Receivable\\t${safeName}\\t${totalRevenue.toFixed(2)}\\tFieldSync - Contract Revenue`)\n  lines.push(`SPL\\tGENERAL JOURNAL\\t${txnDate}\\tConstruction Revenue\\t${safeName}\\t${(-totalRevenue).toFixed(2)}\\tContract: ${safeName}`)\n  lines.push('ENDTRNS')\n\n  // Cost entries\n  const totalLabor = financialData?.totalLaborCost || 0\n  if (totalLabor > 0) {\n    lines.push(`TRNS\\tGENERAL JOURNAL\\t${txnDate}\\tDirect Labor\\t${safeName}\\t${totalLabor.toFixed(2)}\\tLabor costs - ${safeName}`)\n    lines.push(`SPL\\tGENERAL JOURNAL\\t${txnDate}\\tAccounts Payable\\t${safeName}\\t${(-totalLabor).toFixed(2)}\\tLabor costs`)\n    lines.push('ENDTRNS')\n  }\n\n  const totalDisposal = financialData?.totalDisposalCost || 0\n  if (totalDisposal > 0) {\n    lines.push(`TRNS\\tGENERAL JOURNAL\\t${txnDate}\\tDisposal Expense\\t${safeName}\\t${totalDisposal.toFixed(2)}\\tDisposal costs - ${safeName}`)\n    lines.push(`SPL\\tGENERAL JOURNAL\\t${txnDate}\\tAccounts Payable\\t${safeName}\\t${(-totalDisposal).toFixed(2)}\\tDisposal costs`)\n    lines.push('ENDTRNS')\n  }\n\n  const content = lines.join('\\n')\n  const filename = `${project.name.replace(/[^a-zA-Z0-9]/g, '_')}_QB_${new Date().toISOString().split('T')[0]}.iif`\n  downloadFile(content, filename, 'application/x-iif')\n}\n\n/**\n * Export multi-project summary as CSV\n */\nexport function exportPortfolioSummary(projects, projectDataMap) {\n  const headers = [\n    { key: 'name', label: 'Project Name' },\n    { key: 'jobNumber', label: 'Job #' },\n    { key: 'status', label: 'Status' },\n    { key: 'contractValue', label: 'Contract Value' },\n    { key: 'progress', label: 'Progress %' },\n    { key: 'earnedRevenue', label: 'Earned Revenue' },\n    { key: 'totalCosts', label: 'Total Costs' },\n    { key: 'profit', label: 'Profit' },\n    { key: 'margin', label: 'Margin %' }\n  ]\n\n  const rows = projects.map(p => {\n    const data = projectDataMap?.[p.id] || {}\n    const earned = data.earnedRevenue || 0\n    const costs = data.totalCosts || 0\n    const profit = earned - costs\n    return {\n      name: p.name,\n      jobNumber: p.job_number || '',\n      status: p.status || 'active',\n      contractValue: (p.contract_value || 0).toFixed(2),\n      progress: (data.progress || 0).toFixed(1),\n      earnedRevenue: earned.toFixed(2),\n      totalCosts: costs.toFixed(2),\n      profit: profit.toFixed(2),\n      margin: earned > 0 ? ((profit / earned) * 100).toFixed(1) : '0.0'\n    }\n  })\n\n  const csv = toCSV(headers, rows)\n  const filename = `Portfolio_Summary_${new Date().toISOString().split('T')[0]}.csv`\n  downloadFile(csv, filename)\n}\n","import { useState, useEffect, useRef, useCallback } from 'react'\nimport { Search, X, FolderOpen, FileText, Users, ClipboardList, ChevronRight, Command } from 'lucide-react'\nimport { db } from '../lib/supabase'\n\nexport default function UniversalSearch({\n  isOpen,\n  onClose,\n  companyId,\n  onSelectProject,\n  onSelectTicket,\n  onSelectCOR,\n  onShowToast\n}) {\n  const [query, setQuery] = useState('')\n  const [results, setResults] = useState({ projects: [], tickets: [], cors: [], workers: [] })\n  const [loading, setLoading] = useState(false)\n  const [selectedIndex, setSelectedIndex] = useState(0)\n  const inputRef = useRef(null)\n  const searchTimeoutRef = useRef(null)\n  const focusTimeoutRef = useRef(null)\n\n  // Cleanup timers on unmount\n  useEffect(() => {\n    return () => {\n      if (searchTimeoutRef.current) clearTimeout(searchTimeoutRef.current)\n      if (focusTimeoutRef.current) clearTimeout(focusTimeoutRef.current)\n    }\n  }, [])\n\n  // Focus input when modal opens\n  useEffect(() => {\n    if (isOpen) {\n      setQuery('')\n      setResults({ projects: [], tickets: [], cors: [], workers: [] })\n      setSelectedIndex(0)\n      focusTimeoutRef.current = setTimeout(() => inputRef.current?.focus(), 50)\n    }\n  }, [isOpen])\n\n  // Debounced search\n  const performSearch = useCallback(async (searchQuery) => {\n    if (!searchQuery.trim() || searchQuery.length < 2) {\n      setResults({ projects: [], tickets: [], cors: [], workers: [] })\n      return\n    }\n\n    setLoading(true)\n    try {\n      const searchResults = await db.universalSearch(companyId, searchQuery.trim())\n      setResults(searchResults)\n      setSelectedIndex(0)\n    } catch (error) {\n      console.error('Search error:', error)\n      onShowToast?.('Search failed', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }, [companyId, onShowToast])\n\n  // Handle input change with debounce\n  const handleInputChange = (e) => {\n    const value = e.target.value\n    setQuery(value)\n\n    // Clear previous timeout\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current)\n    }\n\n    // Debounce search\n    searchTimeoutRef.current = setTimeout(() => {\n      performSearch(value)\n    }, 200)\n  }\n\n  // Get all results as flat array for keyboard navigation\n  const getAllResults = () => {\n    const all = []\n    results.projects.forEach(p => all.push({ type: 'project', data: p }))\n    results.tickets.forEach(t => all.push({ type: 'ticket', data: t }))\n    results.cors.forEach(c => all.push({ type: 'cor', data: c }))\n    results.workers.forEach(w => all.push({ type: 'worker', data: w }))\n    return all\n  }\n\n  const allResults = getAllResults()\n  const hasResults = allResults.length > 0\n\n  // Handle keyboard navigation\n  const handleKeyDown = (e) => {\n    if (e.key === 'Escape') {\n      onClose()\n    } else if (e.key === 'ArrowDown') {\n      e.preventDefault()\n      setSelectedIndex(prev => Math.min(prev + 1, allResults.length - 1))\n    } else if (e.key === 'ArrowUp') {\n      e.preventDefault()\n      setSelectedIndex(prev => Math.max(prev - 1, 0))\n    } else if (e.key === 'Enter' && hasResults) {\n      e.preventDefault()\n      handleSelect(allResults[selectedIndex])\n    }\n  }\n\n  // Handle selection\n  const handleSelect = (item) => {\n    if (!item) return\n\n    switch (item.type) {\n      case 'project':\n        onSelectProject?.(item.data)\n        break\n      case 'ticket':\n        onSelectTicket?.(item.data)\n        break\n      case 'cor':\n        onSelectCOR?.(item.data)\n        break\n      case 'worker':\n        // Navigate to project where worker was last seen\n        if (item.data.lastProject) {\n          onSelectProject?.(item.data.lastProject)\n        }\n        break\n    }\n    onClose()\n  }\n\n  // Get icon for result type\n  const getIcon = (type) => {\n    switch (type) {\n      case 'project': return FolderOpen\n      case 'ticket': return FileText\n      case 'cor': return ClipboardList\n      case 'worker': return Users\n      default: return FileText\n    }\n  }\n\n  // Get label for result type\n  const getTypeLabel = (type) => {\n    switch (type) {\n      case 'project': return 'Project'\n      case 'ticket': return 'Time & Material'\n      case 'cor': return 'Change Order'\n      case 'worker': return 'Worker'\n      default: return type\n    }\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <div className=\"universal-search-overlay\" onClick={onClose}>\n      <div className=\"universal-search-modal\" onClick={e => e.stopPropagation()}>\n        {/* Search Input */}\n        <div className=\"universal-search-input-wrapper\">\n          <Search size={20} className=\"universal-search-icon\" />\n          <input\n            ref={inputRef}\n            type=\"text\"\n            value={query}\n            onChange={handleInputChange}\n            onKeyDown={handleKeyDown}\n            placeholder=\"Search projects, tickets, CORs, workers...\"\n            className=\"universal-search-input\"\n            autoComplete=\"off\"\n            autoCorrect=\"off\"\n            spellCheck=\"false\"\n          />\n          {query && (\n            <button className=\"universal-search-clear\" onClick={() => setQuery('')}>\n              <X size={16} />\n            </button>\n          )}\n          <div className=\"universal-search-shortcut\">\n            <span>esc</span>\n          </div>\n        </div>\n\n        {/* Results */}\n        <div className=\"universal-search-results\">\n          {loading ? (\n            <div className=\"universal-search-loading\">\n              <div className=\"spinner-small\"></div>\n              <span>Searching...</span>\n            </div>\n          ) : !query.trim() ? (\n            <div className=\"universal-search-empty\">\n              <div className=\"universal-search-tip\">\n                <Command size={14} />\n                <span>Type to search across all data</span>\n              </div>\n              <div className=\"universal-search-hints\">\n                <span>Projects</span>\n                <span>Time & Material</span>\n                <span>Change Orders</span>\n                <span>Workers</span>\n              </div>\n            </div>\n          ) : !hasResults ? (\n            <div className=\"universal-search-no-results\">\n              <span>No results for \"{query}\"</span>\n            </div>\n          ) : (\n            <>\n              {/* Projects */}\n              {results.projects.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <FolderOpen size={14} />\n                    <span>Projects</span>\n                  </div>\n                  {results.projects.map((project, idx) => {\n                    const globalIdx = idx\n                    return (\n                      <button\n                        key={project.id}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'project', data: project })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <FolderOpen size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">{project.name}</span>\n                          {project.job_number && (\n                            <span className=\"universal-search-item-meta\">#{project.job_number}</span>\n                          )}\n                        </div>\n                        <ChevronRight size={16} className=\"universal-search-item-arrow\" />\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n\n              {/* T&M Tickets */}\n              {results.tickets.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <FileText size={14} />\n                    <span>Time & Material</span>\n                  </div>\n                  {results.tickets.map((ticket, idx) => {\n                    const globalIdx = results.projects.length + idx\n                    return (\n                      <button\n                        key={ticket.id}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'ticket', data: ticket })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <FileText size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">\n                            {ticket.notes?.substring(0, 50) || 'Time & Material Ticket'}\n                            {ticket.notes?.length > 50 && '...'}\n                          </span>\n                          <span className=\"universal-search-item-meta\">\n                            {ticket.projectName}  {ticket.work_date}\n                          </span>\n                        </div>\n                        <span className={`universal-search-item-badge ${ticket.status}`}>\n                          {ticket.status}\n                        </span>\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n\n              {/* Change Orders */}\n              {results.cors.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <ClipboardList size={14} />\n                    <span>Change Orders</span>\n                  </div>\n                  {results.cors.map((cor, idx) => {\n                    const globalIdx = results.projects.length + results.tickets.length + idx\n                    return (\n                      <button\n                        key={cor.id}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'cor', data: cor })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <ClipboardList size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">\n                            {cor.cor_number ? `COR #${cor.cor_number}: ` : ''}{cor.title}\n                          </span>\n                          <span className=\"universal-search-item-meta\">\n                            {cor.projectName}\n                          </span>\n                        </div>\n                        <span className={`universal-search-item-badge ${cor.status}`}>\n                          {cor.status}\n                        </span>\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n\n              {/* Workers */}\n              {results.workers.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <Users size={14} />\n                    <span>Workers</span>\n                  </div>\n                  {results.workers.map((worker, idx) => {\n                    const globalIdx = results.projects.length + results.tickets.length + results.cors.length + idx\n                    return (\n                      <button\n                        key={`${worker.name}-${idx}`}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'worker', data: worker })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <Users size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">{worker.name}</span>\n                          <span className=\"universal-search-item-meta\">\n                            {worker.role}  {worker.projectName}\n                          </span>\n                        </div>\n                        <ChevronRight size={16} className=\"universal-search-item-arrow\" />\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n            </>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"universal-search-footer\">\n          <div className=\"universal-search-footer-hint\">\n            <span className=\"key\"></span> navigate\n          </div>\n          <div className=\"universal-search-footer-hint\">\n            <span className=\"key\"></span> select\n          </div>\n          <div className=\"universal-search-footer-hint\">\n            <span className=\"key\">esc</span> close\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// Hook for keyboard shortcut\nexport function useUniversalSearch() {\n  const [isOpen, setIsOpen] = useState(false)\n\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      // Cmd+K (Mac) or Ctrl+K (Windows/Linux)\n      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {\n        e.preventDefault()\n        setIsOpen(prev => !prev)\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyDown)\n    return () => document.removeEventListener('keydown', handleKeyDown)\n  }, [])\n\n  return { isOpen, setIsOpen, open: () => setIsOpen(true), close: () => setIsOpen(false) }\n}\n","import React, { useState, useCallback } from 'react'\nimport { AlertTriangle, XCircle, Info, X, ArrowRight } from 'lucide-react'\n\n/**\n * SmartAlerts\n *\n * Container for displaying prioritized actionable alerts.\n * Alerts can be dismissed and are sorted by priority.\n *\n * @param {array} alerts - Array of alert objects\n * @param {function} onAction - Callback when alert action is clicked\n * @param {function} onDismiss - Callback when alert is dismissed\n * @param {number} maxVisible - Maximum alerts to show (default: 3)\n */\nexport function SmartAlerts({\n  alerts = [],\n  onAction,\n  onDismiss,\n  maxVisible = 3,\n  className = ''\n}) {\n  const [dismissedIds, setDismissedIds] = useState(new Set())\n\n  const visibleAlerts = alerts\n    .filter(alert => !dismissedIds.has(alert.id || `${alert.projectId}-${alert.type}-${alert.title}`))\n    .slice(0, maxVisible)\n\n  const handleDismiss = useCallback((alert) => {\n    const alertId = alert.id || `${alert.projectId}-${alert.type}-${alert.title}`\n    setDismissedIds(prev => new Set([...prev, alertId]))\n    onDismiss?.(alert)\n  }, [onDismiss])\n\n  if (visibleAlerts.length === 0) {\n    return null\n  }\n\n  return (\n    <div\n      className={`smart-alerts ${className}`}\n      role=\"region\"\n      aria-label=\"Project alerts\"\n      aria-live=\"polite\"\n    >\n      {visibleAlerts.map((alert, index) => (\n        <SmartAlertCard\n          key={alert.id || `${alert.projectId}-${alert.type}-${index}`}\n          alert={alert}\n          onAction={onAction}\n          onDismiss={() => handleDismiss(alert)}\n        />\n      ))}\n\n      {alerts.length > maxVisible && (\n        <div className=\"smart-alerts__overflow\">\n          <span className=\"smart-alerts__overflow-text\">\n            +{alerts.length - maxVisible} more alerts\n          </span>\n        </div>\n      )}\n    </div>\n  )\n}\n\n/**\n * SmartAlertCard\n *\n * Individual alert card with icon, message, action, and dismiss.\n *\n * @param {object} alert - Alert object\n * @param {function} onAction - Action button click handler\n * @param {function} onDismiss - Dismiss button click handler\n */\nexport function SmartAlertCard({\n  alert,\n  onAction,\n  onDismiss\n}) {\n  const {\n    type = 'info',\n    title,\n    description,\n    action,\n    actionTarget,\n    projectId,\n    projectName\n  } = alert\n\n  const icons = {\n    critical: XCircle,\n    warning: AlertTriangle,\n    info: Info\n  }\n\n  const Icon = icons[type] || Info\n\n  const handleAction = () => {\n    onAction?.({\n      target: actionTarget,\n      projectId,\n      alert\n    })\n  }\n\n  return (\n    <div\n      className={`smart-alert smart-alert--${type}`}\n      role=\"alert\"\n      aria-live={type === 'critical' ? 'assertive' : 'polite'}\n    >\n      <Icon className=\"smart-alert__icon\" aria-hidden=\"true\" />\n\n      <div className=\"smart-alert__content\">\n        <div className=\"smart-alert__title\">\n          {projectName && <span className=\"smart-alert__project\">{projectName}: </span>}\n          {title}\n        </div>\n\n        {description && (\n          <div className=\"smart-alert__description\">{description}</div>\n        )}\n\n        {action && (\n          <div className=\"smart-alert__action\">\n            <button\n              type=\"button\"\n              className=\"smart-alert__action-btn\"\n              onClick={handleAction}\n            >\n              {action}\n              <ArrowRight size={14} aria-hidden=\"true\" />\n            </button>\n          </div>\n        )}\n      </div>\n\n      {onDismiss && (\n        <button\n          type=\"button\"\n          className=\"smart-alert__dismiss\"\n          onClick={onDismiss}\n          aria-label=\"Dismiss alert\"\n        >\n          <X size={18} aria-hidden=\"true\" />\n        </button>\n      )}\n    </div>\n  )\n}\n\n/**\n * AlertSummaryBanner\n *\n * Compact banner showing alert counts by type.\n * Useful when space is limited.\n *\n * @param {array} alerts - Array of alert objects\n * @param {function} onClick - Click handler to expand alerts\n */\nexport function AlertSummaryBanner({ alerts = [], onClick, className = '' }) {\n  const counts = {\n    critical: alerts.filter(a => a.type === 'critical').length,\n    warning: alerts.filter(a => a.type === 'warning').length,\n    info: alerts.filter(a => a.type === 'info').length\n  }\n\n  const total = alerts.length\n\n  if (total === 0) return null\n\n  return (\n    <button\n      type=\"button\"\n      className={`alert-summary-banner ${className}`}\n      onClick={onClick}\n      aria-label={`${total} alerts: ${counts.critical} critical, ${counts.warning} warnings, ${counts.info} info. Click to view.`}\n    >\n      {counts.critical > 0 && (\n        <span className=\"alert-summary-banner__item alert-summary-banner__item--critical\">\n          <XCircle size={14} aria-hidden=\"true\" />\n          {counts.critical}\n        </span>\n      )}\n      {counts.warning > 0 && (\n        <span className=\"alert-summary-banner__item alert-summary-banner__item--warning\">\n          <AlertTriangle size={14} aria-hidden=\"true\" />\n          {counts.warning}\n        </span>\n      )}\n      {counts.info > 0 && (\n        <span className=\"alert-summary-banner__item alert-summary-banner__item--info\">\n          <Info size={14} aria-hidden=\"true\" />\n          {counts.info}\n        </span>\n      )}\n      <ArrowRight size={14} className=\"alert-summary-banner__arrow\" aria-hidden=\"true\" />\n    </button>\n  )\n}\n\n/**\n * NoAlertsMessage\n *\n * Positive message when there are no alerts.\n */\nexport function NoAlertsMessage({ className = '' }) {\n  return (\n    <div className={`no-alerts-message ${className}`}>\n      <span className=\"no-alerts-message__icon\" aria-hidden=\"true\"></span>\n      <span className=\"no-alerts-message__text\">All projects on track</span>\n    </div>\n  )\n}\n\n/**\n * Helper to aggregate alerts from multiple projects\n */\nexport function aggregateAlerts(projectAlerts) {\n  // Flatten all alerts from all projects\n  const allAlerts = projectAlerts.flatMap(p => p.alerts || [])\n\n  // Sort by priority\n  const priorityOrder = { critical: 0, warning: 1, info: 2 }\n  allAlerts.sort((a, b) => {\n    const priorityDiff = priorityOrder[a.type] - priorityOrder[b.type]\n    if (priorityDiff !== 0) return priorityDiff\n    // Secondary sort by project name\n    return (a.projectName || '').localeCompare(b.projectName || '')\n  })\n\n  return allAlerts\n}\n\nexport default SmartAlerts\n","import { memo, useEffect, useState, useRef } from 'react'\n\n/**\n * OverviewProgressGauge - Large circular progress indicator for project overview\n * Shows completion percentage with animated stroke and areas status\n */\nexport const OverviewProgressGauge = memo(function OverviewProgressGauge({\n  progress = 0,\n  areasComplete = 0,\n  totalAreas = 0,\n  areasWorking = 0,\n  size = 110,\n  strokeWidth = 9\n}) {\n  const [animatedProgress, setAnimatedProgress] = useState(0)\n  const animationRef = useRef(null)\n\n  // Animate progress on mount/change\n  useEffect(() => {\n    const startValue = animatedProgress\n    const endValue = Math.min(100, Math.max(0, progress))\n    const duration = 800\n    const startTime = performance.now()\n\n    const animate = (currentTime) => {\n      const elapsed = currentTime - startTime\n      const progressRatio = Math.min(elapsed / duration, 1)\n\n      // Ease out cubic\n      const eased = 1 - Math.pow(1 - progressRatio, 3)\n      const current = startValue + (endValue - startValue) * eased\n\n      setAnimatedProgress(current)\n\n      if (progressRatio < 1) {\n        animationRef.current = requestAnimationFrame(animate)\n      }\n    }\n\n    animationRef.current = requestAnimationFrame(animate)\n\n    return () => {\n      if (animationRef.current) {\n        cancelAnimationFrame(animationRef.current)\n      }\n    }\n  }, [progress])\n\n  const radius = (size - strokeWidth) / 2\n  const circumference = radius * 2 * Math.PI\n  const offset = circumference - (animatedProgress / 100) * circumference\n\n  // Color based on progress\n  const getProgressColor = () => {\n    if (animatedProgress >= 80) return 'var(--accent-green)'\n    if (animatedProgress >= 50) return 'var(--accent-blue)'\n    if (animatedProgress >= 25) return 'var(--accent-blue)'\n    return 'var(--text-muted)'\n  }\n\n  return (\n    <div className=\"overview-progress-gauge\">\n      <div className=\"progress-gauge-circle\" style={{ width: size, height: size }}>\n        <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`}>\n          {/* Background track */}\n          <circle\n            className=\"gauge-track\"\n            cx={size / 2}\n            cy={size / 2}\n            r={radius}\n            fill=\"none\"\n            strokeWidth={strokeWidth}\n            stroke=\"var(--bg-tertiary)\"\n          />\n          {/* Progress arc */}\n          <circle\n            className=\"gauge-fill\"\n            cx={size / 2}\n            cy={size / 2}\n            r={radius}\n            fill=\"none\"\n            stroke={getProgressColor()}\n            strokeWidth={strokeWidth}\n            strokeDasharray={circumference}\n            strokeDashoffset={offset}\n            strokeLinecap=\"round\"\n            transform={`rotate(-90 ${size / 2} ${size / 2})`}\n            style={{ transition: 'stroke 0.3s ease' }}\n          />\n        </svg>\n        {/* Center content */}\n        <div className=\"gauge-center\">\n          <span className=\"gauge-value\">{Math.round(animatedProgress)}%</span>\n          <span className=\"gauge-label\">Complete</span>\n        </div>\n      </div>\n\n      {/* Areas status below */}\n      <div className=\"gauge-areas-status\">\n        <span className=\"areas-count\">\n          <strong>{areasComplete}</strong>/{totalAreas} Areas Done\n        </span>\n        {areasWorking > 0 && (\n          <span className=\"areas-active\">{areasWorking} active</span>\n        )}\n      </div>\n    </div>\n  )\n})\n\nexport default OverviewProgressGauge\n","// ============================================\n// Chart Configuration\n// ============================================\n// Centralized theme colors, animations, and styles\n// for all financial dashboard charts.\n// ============================================\n\n// Chart color palette - matches app theme\nexport const chartColors = {\n  // Financial lines\n  contract: '#3b82f6',     // Blue - contract ceiling\n  revenue: '#10b981',      // Green - earned revenue\n  costs: '#f59e0b',        // Amber - spending\n  profit: '#22c55e',       // Emerald - positive profit\n  loss: '#ef4444',         // Red - negative/loss\n\n  // Extra work\n  tmValue: '#8b5cf6',      // Purple - T&M ticket value\n  corValue: '#14b8a6',     // Teal - COR approved value\n\n  // Cost categories\n  labor: '#6366f1',        // Indigo\n  disposal: '#14b8a6',     // Teal\n  equipment: '#f97316',    // Orange\n  materials: '#a855f7',    // Purple\n  subcontractor: '#ec4899', // Pink\n  other: '#6b7280',        // Gray\n\n  // UI\n  grid: 'var(--border-color)',\n  text: 'var(--text-secondary)',\n  background: 'var(--bg-card)',\n}\n\n// Animation configuration\nexport const animationConfig = {\n  duration: 800,\n  easing: 'ease-out',\n}\n\n// Common tooltip styles\nexport const tooltipStyle = {\n  contentStyle: {\n    background: 'var(--bg-card)',\n    border: '1px solid var(--border-color)',\n    borderRadius: '8px',\n    boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\n    padding: '12px 16px',\n  },\n  labelStyle: {\n    color: 'var(--text-primary)',\n    fontWeight: 600,\n    marginBottom: '8px',\n  },\n  itemStyle: {\n    color: 'var(--text-secondary)',\n    padding: '2px 0',\n  },\n}\n\n// Cost category configuration\nexport const costCategories = {\n  labor: {\n    label: 'Labor',\n    color: chartColors.labor,\n    icon: 'HardHat',\n  },\n  disposal: {\n    label: 'Disposal',\n    color: chartColors.disposal,\n    icon: 'Trash2',\n  },\n  equipment: {\n    label: 'Equipment',\n    color: chartColors.equipment,\n    icon: 'Truck',\n  },\n  materials: {\n    label: 'Materials',\n    color: chartColors.materials,\n    icon: 'Package',\n  },\n  subcontractor: {\n    label: 'Subcontractor',\n    color: chartColors.subcontractor,\n    icon: 'Users',\n  },\n  other: {\n    label: 'Other',\n    color: chartColors.other,\n    icon: 'MoreHorizontal',\n  },\n}\n\n// Time range options for charts\nexport const timeRanges = [\n  { id: '7d', label: '7D', days: 7 },\n  { id: '30d', label: '30D', days: 30 },\n  { id: '90d', label: '90D', days: 90 },\n  { id: 'all', label: 'All', days: null },\n]\n\n// Format currency for chart labels\nexport const formatChartCurrency = (value) => {\n  if (value >= 1000000) {\n    return `$${(value / 1000000).toFixed(1)}M`\n  }\n  if (value >= 1000) {\n    return `$${(value / 1000).toFixed(0)}K`\n  }\n  return `$${value.toFixed(0)}`\n}\n\n// Format date for chart axis\nexport const formatChartDate = (dateStr) => {\n  const date = new Date(dateStr)\n  return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n}\n\n// Gradient definitions for area charts\nexport const gradientDefs = {\n  revenue: {\n    id: 'revenueGradient',\n    color: chartColors.revenue,\n    startOpacity: 0.3,\n    endOpacity: 0,\n  },\n  costs: {\n    id: 'costsGradient',\n    color: chartColors.costs,\n    startOpacity: 0.3,\n    endOpacity: 0,\n  },\n  tmValue: {\n    id: 'tmValueGradient',\n    color: chartColors.tmValue,\n    startOpacity: 0.2,\n    endOpacity: 0,\n  },\n}\n","import { memo } from 'react'\nimport { chartColors } from '../charts/chartConfig'\n\n/**\n * OverviewFinancialCard - Compact financial snapshot for project overview\n * Shows earned, costs, profit with mini cost breakdown bar\n */\nexport const OverviewFinancialCard = memo(function OverviewFinancialCard({\n  earnedRevenue = 0,\n  totalCosts = 0,\n  laborCost = 0,\n  disposalCost = 0,\n  equipmentCost = 0,\n  materialsCost = 0,\n  otherCost = 0,\n  contractValue = 0\n}) {\n  const profit = earnedRevenue - totalCosts\n  const margin = earnedRevenue > 0 ? (profit / earnedRevenue) * 100 : 0\n  const isPositive = profit >= 0\n\n  // Format currency\n  const formatCurrency = (value) => {\n    if (value >= 1000000) {\n      return `$${(value / 1000000).toFixed(1)}M`\n    }\n    if (value >= 1000) {\n      return `$${(value / 1000).toFixed(1)}K`\n    }\n    return `$${value.toFixed(0)}`\n  }\n\n  // Calculate cost breakdown percentages for the stacked bar\n  const costBreakdown = [\n    { key: 'labor', value: laborCost, color: chartColors.labor, label: 'Labor' },\n    { key: 'disposal', value: disposalCost, color: chartColors.disposal, label: 'Disposal' },\n    { key: 'equipment', value: equipmentCost, color: chartColors.equipment, label: 'Equipment' },\n    { key: 'materials', value: materialsCost, color: chartColors.materials, label: 'Materials' },\n    { key: 'other', value: otherCost, color: chartColors.other, label: 'Other' }\n  ].filter(item => item.value > 0)\n\n  const hasBreakdown = costBreakdown.length > 0 && totalCosts > 0\n\n  return (\n    <div className=\"overview-financial-card animate-fade-in-up\">\n      {/* Main metrics row */}\n      <div className=\"financial-metrics-row\">\n        {/* Earned */}\n        <div className=\"financial-metric\">\n          <span className=\"financial-metric-value green\">{formatCurrency(earnedRevenue)}</span>\n          <span className=\"financial-metric-label\">Earned</span>\n        </div>\n\n        {/* Costs */}\n        <div className=\"financial-metric\">\n          <span className=\"financial-metric-value amber\">{formatCurrency(totalCosts)}</span>\n          <span className=\"financial-metric-label\">Costs</span>\n        </div>\n\n        {/* Profit */}\n        <div className=\"financial-metric\">\n          <span className={`financial-metric-value ${isPositive ? 'green' : 'red'}`}>\n            {isPositive ? '' : '-'}{formatCurrency(Math.abs(profit))}\n          </span>\n          <span className=\"financial-metric-label\">\n            Profit\n            <span className={`margin-badge ${isPositive ? 'positive' : 'negative'}`}>\n              {margin >= 0 ? '+' : ''}{margin.toFixed(0)}%\n            </span>\n          </span>\n        </div>\n      </div>\n\n      {/* Cost breakdown bar */}\n      {hasBreakdown && (\n        <div className=\"cost-breakdown-section\">\n          <div className=\"cost-breakdown-bar\">\n            {costBreakdown.map((item, index) => {\n              const widthPercent = (item.value / totalCosts) * 100\n              return (\n                <div\n                  key={item.key}\n                  className=\"cost-segment\"\n                  style={{\n                    width: `${widthPercent}%`,\n                    backgroundColor: item.color,\n                    animationDelay: `${index * 100}ms`\n                  }}\n                  title={`${item.label}: ${formatCurrency(item.value)} (${widthPercent.toFixed(0)}%)`}\n                />\n              )\n            })}\n          </div>\n          <div className=\"cost-breakdown-legend\">\n            {costBreakdown.slice(0, 4).map(item => (\n              <span key={item.key} className=\"legend-item\">\n                <span className=\"legend-dot\" style={{ backgroundColor: item.color }} />\n                <span className=\"legend-label\">{item.label}</span>\n              </span>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  )\n})\n\nexport default OverviewFinancialCard\n","import { memo, useState, useEffect, useMemo, useCallback } from 'react'\nimport { Users, HardHat, Wrench, Calendar, Download, ChevronLeft, ChevronRight } from 'lucide-react'\nimport {\n  BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer\n} from 'recharts'\nimport { db } from '../../lib/supabase'\nimport { chartColors, tooltipStyle, formatChartDate } from '../charts/chartConfig'\n\n/**\n * OverviewCrewMetrics - Crew on-site metrics for project overview\n * Shows total crew count, contract vs T&M worker breakdown by day\n * Includes a day-by-day stacked bar chart timeline\n */\n\nconst loadJsPDF = () => import('jspdf')\n\n// Colors for contract vs T&M\nconst CREW_COLORS = {\n  contract: chartColors.contract,  // Blue\n  tm: chartColors.costs,           // Amber\n  total: chartColors.labor         // Indigo\n}\n\nconst TIME_RANGES = [\n  { id: '7d', label: '7D', days: 7 },\n  { id: '14d', label: '14D', days: 14 },\n  { id: '30d', label: '30D', days: 30 },\n]\n\nexport const OverviewCrewMetrics = memo(function OverviewCrewMetrics({\n  project,\n  onShowToast\n}) {\n  const [crewHistory, setCrewHistory] = useState([])\n  const [tmTickets, setTmTickets] = useState([])\n  const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0])\n  const [timeRange, setTimeRange] = useState('14d')\n  const [loading, setLoading] = useState(true)\n  const [exporting, setExporting] = useState(false)\n\n  // Load all crew check-in history and T&M tickets\n  useEffect(() => {\n    if (!project?.id) return\n    loadData()\n  }, [project?.id])\n\n  const loadData = async () => {\n    setLoading(true)\n    try {\n      const [history, tickets] = await Promise.all([\n        db.getCrewCheckinHistory(project.id, 365),\n        db.getTMTickets(project.id)\n      ])\n      setCrewHistory(history || [])\n      setTmTickets(tickets || [])\n    } catch (error) {\n      console.error('Error loading crew metrics:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // Build a lookup: date -> Set of T&M worker names\n  const tmWorkersByDate = useMemo(() => {\n    const map = {}\n    tmTickets.forEach(ticket => {\n      const date = ticket.work_date\n      if (!date) return\n      if (!map[date]) map[date] = new Set()\n      ;(ticket.t_and_m_workers || []).forEach(w => {\n        map[date].add(w.name.toLowerCase().trim())\n      })\n    })\n    return map\n  }, [tmTickets])\n\n  // Build crew lookup: date -> workers array\n  const crewByDate = useMemo(() => {\n    const map = {}\n    crewHistory.forEach(checkin => {\n      map[checkin.check_in_date] = checkin.workers || []\n    })\n    return map\n  }, [crewHistory])\n\n  // Selected date metrics\n  const selectedDayWorkers = crewByDate[selectedDate] || []\n  const selectedDayTmNames = tmWorkersByDate[selectedDate] || new Set()\n\n  const todayMetrics = useMemo(() => {\n    const contract = []\n    const tm = []\n    selectedDayWorkers.forEach(w => {\n      if (selectedDayTmNames.has(w.name.toLowerCase().trim())) {\n        tm.push(w)\n      } else {\n        contract.push(w)\n      }\n    })\n    return { total: selectedDayWorkers.length, contract, tm }\n  }, [selectedDayWorkers, selectedDayTmNames])\n\n  // Build chart data for time range\n  const chartData = useMemo(() => {\n    const rangeDays = TIME_RANGES.find(r => r.id === timeRange)?.days || 14\n    const data = []\n    const today = new Date()\n\n    for (let i = rangeDays - 1; i >= 0; i--) {\n      const d = new Date(today)\n      d.setDate(d.getDate() - i)\n      const dateStr = d.toISOString().split('T')[0]\n\n      const workers = crewByDate[dateStr] || []\n      const tmNames = tmWorkersByDate[dateStr] || new Set()\n\n      let contractCount = 0\n      let tmCount = 0\n      workers.forEach(w => {\n        if (tmNames.has(w.name.toLowerCase().trim())) {\n          tmCount++\n        } else {\n          contractCount++\n        }\n      })\n\n      data.push({\n        date: dateStr,\n        displayDate: formatChartDate(dateStr),\n        contract: contractCount,\n        tm: tmCount,\n        total: workers.length\n      })\n    }\n\n    return data\n  }, [crewByDate, tmWorkersByDate, timeRange])\n\n  // Navigate dates\n  const changeDate = useCallback((direction) => {\n    const d = new Date(selectedDate + 'T12:00:00')\n    d.setDate(d.getDate() + direction)\n    setSelectedDate(d.toISOString().split('T')[0])\n  }, [selectedDate])\n\n  const isToday = selectedDate === new Date().toISOString().split('T')[0]\n\n  const formatDate = (dateStr) => {\n    const d = new Date(dateStr + 'T12:00:00')\n    return d.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })\n  }\n\n  // Click a bar in the chart to select that date\n  const handleBarClick = useCallback((data) => {\n    if (data?.date) {\n      setSelectedDate(data.date)\n    }\n  }, [])\n\n  // Custom tooltip for the chart\n  const CustomTooltip = ({ active, payload, label }) => {\n    if (!active || !payload?.length) return null\n    const total = (payload[0]?.value || 0) + (payload[1]?.value || 0)\n    return (\n      <div style={{\n        ...tooltipStyle.contentStyle,\n        fontSize: '0.8rem'\n      }}>\n        <p style={{ ...tooltipStyle.labelStyle, fontSize: '0.85rem', marginBottom: 6 }}>{label}</p>\n        <p style={{ margin: '3px 0', color: CREW_COLORS.contract }}>\n          Contract: <strong>{payload[0]?.value || 0}</strong>\n        </p>\n        <p style={{ margin: '3px 0', color: CREW_COLORS.tm }}>\n          Time & Material: <strong>{payload[1]?.value || 0}</strong>\n        </p>\n        <p style={{ margin: '3px 0', color: 'var(--text-primary)', borderTop: '1px solid var(--border-color)', paddingTop: 4 }}>\n          Total: <strong>{total}</strong>\n        </p>\n      </div>\n    )\n  }\n\n  // PDF Export\n  const exportCrewPDF = useCallback(async () => {\n    setExporting(true)\n    onShowToast?.('Generating crew report PDF...', 'info')\n\n    try {\n      const jsPDFModule = await loadJsPDF()\n      const jsPDF = jsPDFModule.default\n      const doc = new jsPDF()\n\n      const pageWidth = doc.internal.pageSize.width\n      let y = 20\n\n      // Header\n      doc.setFontSize(18)\n      doc.setFont(undefined, 'bold')\n      doc.text('Crew On-Site Report', pageWidth / 2, y, { align: 'center' })\n      y += 8\n\n      doc.setFontSize(11)\n      doc.setFont(undefined, 'normal')\n      doc.text(`Project: ${project.name}`, pageWidth / 2, y, { align: 'center' })\n      y += 6\n      doc.text(`Date: ${formatDate(selectedDate)}`, pageWidth / 2, y, { align: 'center' })\n      y += 12\n\n      // Summary stats\n      doc.setFontSize(12)\n      doc.setFont(undefined, 'bold')\n      doc.text('Selected Day Summary', 14, y)\n      y += 7\n\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'normal')\n      doc.text(`Total Crew On-Site: ${todayMetrics.total}`, 14, y); y += 5\n      doc.text(`Contract Workers: ${todayMetrics.contract.length}`, 14, y); y += 5\n      doc.text(`Time & Material Workers: ${todayMetrics.tm.length}`, 14, y); y += 10\n\n      // Contract Workers\n      if (todayMetrics.contract.length > 0) {\n        doc.setFontSize(12)\n        doc.setFont(undefined, 'bold')\n        doc.text('Contract Workers', 14, y); y += 7\n\n        doc.setFontSize(9)\n        doc.setFont(undefined, 'bold')\n        doc.text('Name', 14, y)\n        doc.text('Role', 100, y); y += 5\n\n        doc.setFont(undefined, 'normal')\n        todayMetrics.contract.forEach(w => {\n          if (y > 270) { doc.addPage(); y = 20 }\n          doc.text(w.name, 14, y)\n          doc.text(w.role || '', 100, y); y += 5\n        })\n        y += 8\n      }\n\n      // T&M Workers\n      if (todayMetrics.tm.length > 0) {\n        if (y > 240) { doc.addPage(); y = 20 }\n        doc.setFontSize(12)\n        doc.setFont(undefined, 'bold')\n        doc.text('Time & Material Workers (Extra Work)', 14, y); y += 7\n\n        doc.setFontSize(9)\n        doc.setFont(undefined, 'bold')\n        doc.text('Name', 14, y)\n        doc.text('Role', 100, y); y += 5\n\n        doc.setFont(undefined, 'normal')\n        todayMetrics.tm.forEach(w => {\n          if (y > 270) { doc.addPage(); y = 20 }\n          doc.text(w.name, 14, y)\n          doc.text(w.role || '', 100, y); y += 5\n        })\n        y += 8\n      }\n\n      // Timeline table\n      if (y > 200) { doc.addPage(); y = 20 }\n      doc.setFontSize(12)\n      doc.setFont(undefined, 'bold')\n      doc.text('Daily Timeline', 14, y); y += 7\n\n      doc.setFontSize(8)\n      doc.setFont(undefined, 'bold')\n      doc.text('Date', 14, y)\n      doc.text('Total', 70, y)\n      doc.text('Contract', 95, y)\n      doc.text('T&M', 125, y); y += 5  // Keep abbreviation for column header width\n\n      doc.setFont(undefined, 'normal')\n      chartData.forEach(day => {\n        if (y > 275) { doc.addPage(); y = 20 }\n        doc.text(day.displayDate, 14, y)\n        doc.text(String(day.total), 70, y)\n        doc.text(String(day.contract), 95, y)\n        doc.text(String(day.tm), 125, y)\n        y += 4.5\n      })\n\n      // Footer\n      const footerY = doc.internal.pageSize.height - 10\n      doc.setFontSize(8)\n      doc.setTextColor(128, 128, 128)\n      doc.text(`Generated ${new Date().toLocaleString()}  FieldSync`, pageWidth / 2, footerY, { align: 'center' })\n\n      const fileName = `${project.name}_Crew_Report_${selectedDate}.pdf`\n      doc.save(fileName)\n      onShowToast?.('PDF exported!', 'success')\n    } catch (error) {\n      console.error('Error exporting crew PDF:', error)\n      onShowToast?.('Error generating PDF', 'error')\n    } finally {\n      setExporting(false)\n    }\n  }, [project, selectedDate, todayMetrics, chartData, onShowToast])\n\n  if (loading) {\n    return (\n      <div className=\"crew-metrics-card animate-fade-in-up\">\n        <div className=\"crew-metrics-header\">\n          <h3><Users size={18} /> Crew On-Site</h3>\n        </div>\n        <div className=\"crew-metrics-loading\">\n          <div className=\"skeleton-stat\"></div>\n          <div className=\"skeleton-stat\"></div>\n          <div className=\"skeleton-stat\"></div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"crew-metrics-card animate-fade-in-up\">\n      {/* Header with export */}\n      <div className=\"crew-metrics-header\">\n        <h3><Users size={18} /> Crew On-Site</h3>\n        <div className=\"crew-metrics-actions\">\n          <button\n            className=\"btn btn-secondary btn-small\"\n            onClick={exportCrewPDF}\n            disabled={exporting}\n            title=\"Export crew report as PDF\"\n          >\n            <Download size={14} /> {exporting ? 'Exporting...' : 'PDF'}\n          </button>\n        </div>\n      </div>\n\n      {/* Date navigator */}\n      <div className=\"crew-date-nav\">\n        <button className=\"crew-date-btn\" onClick={() => changeDate(-1)}>\n          <ChevronLeft size={16} />\n        </button>\n        <span className=\"crew-date-label\">\n          <Calendar size={14} />\n          {isToday ? 'Today' : formatDate(selectedDate)}\n        </span>\n        <button className=\"crew-date-btn\" onClick={() => changeDate(1)} disabled={isToday}>\n          <ChevronRight size={16} />\n        </button>\n      </div>\n\n      {/* Stats row for selected day */}\n      <div className=\"crew-stats-row\">\n        <div className=\"crew-stat total\">\n          <div className=\"crew-stat-icon\"><Users size={20} /></div>\n          <div className=\"crew-stat-content\">\n            <span className=\"crew-stat-value\">{todayMetrics.total}</span>\n            <span className=\"crew-stat-label\">Total On-Site</span>\n          </div>\n        </div>\n\n        <div className=\"crew-stat contract\">\n          <div className=\"crew-stat-icon\"><HardHat size={20} /></div>\n          <div className=\"crew-stat-content\">\n            <span className=\"crew-stat-value\">{todayMetrics.contract.length}</span>\n            <span className=\"crew-stat-label\">Contract</span>\n          </div>\n        </div>\n\n        <div className=\"crew-stat tm\">\n          <div className=\"crew-stat-icon\"><Wrench size={20} /></div>\n          <div className=\"crew-stat-content\">\n            <span className=\"crew-stat-value\">{todayMetrics.tm.length}</span>\n            <span className=\"crew-stat-label\">Time & Material</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Breakdown bar for selected day */}\n      {todayMetrics.total > 0 && (\n        <div className=\"crew-breakdown-bar\">\n          <div\n            className=\"crew-bar-segment contract\"\n            style={{ width: `${(todayMetrics.contract.length / todayMetrics.total) * 100}%` }}\n            title={`${todayMetrics.contract.length} Contract`}\n          />\n          <div\n            className=\"crew-bar-segment tm\"\n            style={{ width: `${(todayMetrics.tm.length / todayMetrics.total) * 100}%` }}\n            title={`${todayMetrics.tm.length} Time & Material`}\n          />\n        </div>\n      )}\n\n      {/* Worker name lists */}\n      {todayMetrics.total > 0 && (\n        <div className=\"crew-name-lists\">\n          {todayMetrics.contract.length > 0 && (\n            <div className=\"crew-name-group\">\n              <div className=\"crew-name-group-header contract\">\n                <HardHat size={13} />\n                <span>Contract ({todayMetrics.contract.length})</span>\n              </div>\n              <div className=\"crew-name-tags\">\n                {todayMetrics.contract.map((w, i) => (\n                  <span key={i} className=\"crew-name-tag contract\">\n                    {w.name}\n                    {w.role && w.role !== 'Laborer' && (\n                      <span className=\"crew-name-role\">{w.role}</span>\n                    )}\n                  </span>\n                ))}\n              </div>\n            </div>\n          )}\n          {todayMetrics.tm.length > 0 && (\n            <div className=\"crew-name-group\">\n              <div className=\"crew-name-group-header tm\">\n                <Wrench size={13} />\n                <span>Time & Material ({todayMetrics.tm.length})</span>\n              </div>\n              <div className=\"crew-name-tags\">\n                {todayMetrics.tm.map((w, i) => (\n                  <span key={i} className=\"crew-name-tag tm\">\n                    {w.name}\n                    {w.role && w.role !== 'Laborer' && (\n                      <span className=\"crew-name-role\">{w.role}</span>\n                    )}\n                  </span>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Day-by-day timeline chart */}\n      <div className=\"crew-timeline-section\">\n        <div className=\"crew-timeline-header\">\n          <span className=\"crew-timeline-title\">Daily Breakdown</span>\n          <div className=\"crew-time-range-pills\">\n            {TIME_RANGES.map(range => (\n              <button\n                key={range.id}\n                className={`crew-range-pill ${timeRange === range.id ? 'active' : ''}`}\n                onClick={() => setTimeRange(range.id)}\n              >\n                {range.label}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"crew-chart-container\">\n          <ResponsiveContainer width=\"100%\" height={140}>\n            <BarChart\n              data={chartData}\n              onClick={(e) => e?.activePayload?.[0] && handleBarClick(e.activePayload[0].payload)}\n              style={{ cursor: 'pointer' }}\n            >\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"var(--border-color)\" vertical={false} />\n              <XAxis\n                dataKey=\"displayDate\"\n                tick={{ fontSize: 10, fill: 'var(--text-muted)' }}\n                axisLine={{ stroke: 'var(--border-color)' }}\n                tickLine={false}\n                interval={timeRange === '30d' ? 4 : timeRange === '14d' ? 1 : 0}\n              />\n              <YAxis\n                tick={{ fontSize: 10, fill: 'var(--text-muted)' }}\n                axisLine={false}\n                tickLine={false}\n                allowDecimals={false}\n                width={30}\n              />\n              <Tooltip content={<CustomTooltip />} />\n              <Legend\n                wrapperStyle={{ fontSize: '0.75rem', paddingTop: 4 }}\n                iconType=\"circle\"\n                iconSize={8}\n              />\n              <Bar\n                dataKey=\"contract\"\n                name=\"Contract\"\n                stackId=\"crew\"\n                fill={CREW_COLORS.contract}\n                radius={[0, 0, 0, 0]}\n              />\n              <Bar\n                dataKey=\"tm\"\n                name=\"Time & Material (Extra Work)\"\n                stackId=\"crew\"\n                fill={CREW_COLORS.tm}\n                radius={[3, 3, 0, 0]}\n              />\n            </BarChart>\n          </ResponsiveContainer>\n        </div>\n      </div>\n\n      {/* Empty state */}\n      {todayMetrics.total === 0 && (\n        <div className=\"crew-empty\">\n          <p>No crew checked in for this date</p>\n        </div>\n      )}\n    </div>\n  )\n})\n\nexport default OverviewCrewMetrics\n","import { memo } from 'react'\n\n/**\n * Skeleton - Loading placeholder component\n * Follows progressive disclosure principle - shows structure before content\n */\n\n// Base skeleton with shimmer animation\nexport const Skeleton = memo(function Skeleton({\n  width,\n  height,\n  borderRadius = '8px',\n  className = '',\n  variant = 'default' // 'default' | 'text' | 'circular' | 'rectangular'\n}) {\n  const getVariantStyles = () => {\n    switch (variant) {\n      case 'text':\n        return { height: '1em', borderRadius: '4px' }\n      case 'circular':\n        return { borderRadius: '50%' }\n      case 'rectangular':\n        return { borderRadius: '0' }\n      default:\n        return { borderRadius }\n    }\n  }\n\n  const variantStyles = getVariantStyles()\n\n  return (\n    <div\n      className={`skeleton ${className}`}\n      style={{\n        width: width || '100%',\n        height: height || variantStyles.height || '1rem',\n        borderRadius: variantStyles.borderRadius,\n      }}\n      aria-hidden=\"true\"\n    />\n  )\n})\n\n// Skeleton for metric cards (value + label)\nexport const MetricSkeleton = memo(function MetricSkeleton({ showProgress = false }) {\n  return (\n    <div className=\"metric-skeleton\">\n      <Skeleton width=\"60%\" height=\"0.75rem\" className=\"skeleton-label\" />\n      <Skeleton width=\"80%\" height=\"1.75rem\" className=\"skeleton-value\" />\n      {showProgress && (\n        <Skeleton width=\"100%\" height=\"6px\" className=\"skeleton-progress\" />\n      )}\n    </div>\n  )\n})\n\n// Skeleton for cards (header + content)\nexport const CardSkeleton = memo(function CardSkeleton({\n  lines = 3,\n  showHeader = true,\n  showAction = false\n}) {\n  return (\n    <div className=\"card-skeleton\" aria-busy=\"true\" aria-label=\"Loading content\">\n      {showHeader && (\n        <div className=\"card-skeleton-header\">\n          <Skeleton width=\"40%\" height=\"1.25rem\" />\n          {showAction && <Skeleton width=\"80px\" height=\"32px\" />}\n        </div>\n      )}\n      <div className=\"card-skeleton-body\">\n        {Array.from({ length: lines }).map((_, i) => (\n          <Skeleton\n            key={i}\n            width={`${100 - (i * 15)}%`}\n            height=\"1rem\"\n            className=\"skeleton-line\"\n          />\n        ))}\n      </div>\n    </div>\n  )\n})\n\n// Skeleton for list items\nexport const ListItemSkeleton = memo(function ListItemSkeleton({\n  count = 3,\n  showAvatar = false,\n  showAction = false\n}) {\n  return (\n    <div className=\"list-skeleton\" aria-busy=\"true\" aria-label=\"Loading list\">\n      {Array.from({ length: count }).map((_, i) => (\n        <div key={i} className=\"list-item-skeleton\">\n          {showAvatar && <Skeleton width=\"40px\" height=\"40px\" variant=\"circular\" />}\n          <div className=\"list-item-skeleton-content\">\n            <Skeleton width=\"60%\" height=\"1rem\" />\n            <Skeleton width=\"40%\" height=\"0.75rem\" />\n          </div>\n          {showAction && <Skeleton width=\"60px\" height=\"28px\" />}\n        </div>\n      ))}\n    </div>\n  )\n})\n\n// Skeleton for financial analysis row (3 cards)\nexport const FinancialRowSkeleton = memo(function FinancialRowSkeleton() {\n  return (\n    <div className=\"financial-row-skeleton\" aria-busy=\"true\" aria-label=\"Loading financial data\">\n      {[1, 2, 3].map(i => (\n        <div key={i} className=\"financial-card-skeleton\">\n          <div className=\"financial-card-skeleton-header\">\n            <Skeleton width=\"24px\" height=\"24px\" variant=\"circular\" />\n            <Skeleton width=\"60%\" height=\"1rem\" />\n          </div>\n          <Skeleton width=\"50%\" height=\"2rem\" className=\"skeleton-hero-value\" />\n          <div className=\"financial-card-skeleton-details\">\n            <Skeleton width=\"100%\" height=\"0.875rem\" />\n            <Skeleton width=\"80%\" height=\"0.875rem\" />\n          </div>\n        </div>\n      ))}\n    </div>\n  )\n})\n\n// Skeleton for chart placeholder\nexport const ChartSkeleton = memo(function ChartSkeleton({ height = '200px' }) {\n  return (\n    <div className=\"chart-skeleton\" style={{ height }} aria-busy=\"true\" aria-label=\"Loading chart\">\n      <div className=\"chart-skeleton-bars\">\n        {[40, 65, 45, 80, 55, 70, 50, 75, 60, 85].map((h, i) => (\n          <div\n            key={i}\n            className=\"chart-skeleton-bar\"\n            style={{ height: `${h}%` }}\n          />\n        ))}\n      </div>\n      <Skeleton width=\"100%\" height=\"1px\" className=\"chart-skeleton-axis\" />\n    </div>\n  )\n})\n\n// Skeleton for COR/Ticket items\nexport const TicketSkeleton = memo(function TicketSkeleton({ count = 3 }) {\n  return (\n    <div className=\"ticket-skeleton-list\" aria-busy=\"true\" aria-label=\"Loading tickets\">\n      {Array.from({ length: count }).map((_, i) => (\n        <div key={i} className=\"ticket-skeleton-item\">\n          <div className=\"ticket-skeleton-header\">\n            <Skeleton width=\"100px\" height=\"0.875rem\" />\n            <Skeleton width=\"80px\" height=\"24px\" borderRadius=\"12px\" />\n          </div>\n          <Skeleton width=\"90%\" height=\"1rem\" />\n          <div className=\"ticket-skeleton-footer\">\n            <Skeleton width=\"60px\" height=\"0.75rem\" />\n            <Skeleton width=\"60px\" height=\"0.75rem\" />\n            <Skeleton width=\"60px\" height=\"0.75rem\" />\n          </div>\n        </div>\n      ))}\n    </div>\n  )\n})\n\n// Skeleton for hero metrics row\nexport const HeroMetricsSkeleton = memo(function HeroMetricsSkeleton() {\n  return (\n    <div className=\"hero-metrics-skeleton\" aria-busy=\"true\" aria-label=\"Loading metrics\">\n      {[1, 2, 3, 4].map(i => (\n        <div key={i} className=\"hero-metric-skeleton\">\n          <Skeleton width=\"80px\" height=\"0.75rem\" className=\"skeleton-label\" />\n          <Skeleton width=\"120px\" height=\"1.75rem\" className=\"skeleton-value\" />\n          <Skeleton width=\"100%\" height=\"4px\" className=\"skeleton-bar\" />\n        </div>\n      ))}\n    </div>\n  )\n})\n\nexport default Skeleton\n","import { memo } from 'react'\nimport { AlertTriangle, RefreshCw, WifiOff } from 'lucide-react'\n\n/**\n * ErrorState - Reusable error display component for list/data components\n * Provides user-friendly error messages with retry functionality\n */\nexport const ErrorState = memo(function ErrorState({\n  title = 'Unable to load data',\n  message = 'Something went wrong. Please try again.',\n  error = null,\n  onRetry = null,\n  retryLabel = 'Try Again',\n  variant = 'default', // 'default' | 'inline' | 'compact'\n  icon: CustomIcon = null\n}) {\n  // Determine icon based on error type\n  const getIcon = () => {\n    if (CustomIcon) return CustomIcon\n    if (error?.message?.includes('network') || error?.message?.includes('offline')) {\n      return WifiOff\n    }\n    return AlertTriangle\n  }\n\n  const Icon = getIcon()\n\n  if (variant === 'compact') {\n    return (\n      <div className=\"error-state error-state-compact\" role=\"alert\">\n        <Icon size={16} className=\"error-state-icon\" aria-hidden=\"true\" />\n        <span className=\"error-state-message\">{message}</span>\n        {onRetry && (\n          <button\n            className=\"btn btn-ghost btn-small\"\n            onClick={onRetry}\n            aria-label={retryLabel}\n          >\n            <RefreshCw size={14} />\n          </button>\n        )}\n      </div>\n    )\n  }\n\n  if (variant === 'inline') {\n    return (\n      <div className=\"error-state error-state-inline\" role=\"alert\">\n        <div className=\"error-state-content\">\n          <Icon size={20} className=\"error-state-icon\" aria-hidden=\"true\" />\n          <div className=\"error-state-text\">\n            <span className=\"error-state-title\">{title}</span>\n            <span className=\"error-state-message\">{message}</span>\n          </div>\n        </div>\n        {onRetry && (\n          <button className=\"btn btn-secondary btn-small\" onClick={onRetry}>\n            <RefreshCw size={14} /> {retryLabel}\n          </button>\n        )}\n      </div>\n    )\n  }\n\n  // Default variant - centered with full details\n  return (\n    <div className=\"error-state\" role=\"alert\" aria-live=\"polite\">\n      <div className=\"error-state-icon-wrapper\">\n        <Icon size={32} className=\"error-state-icon\" aria-hidden=\"true\" />\n      </div>\n      <h4 className=\"error-state-title\">{title}</h4>\n      <p className=\"error-state-message\">{message}</p>\n\n      {/* Show error details in development */}\n      {import.meta.env.DEV && error && (\n        <details className=\"error-state-details\">\n          <summary>Error Details</summary>\n          <pre>{error.message || String(error)}</pre>\n        </details>\n      )}\n\n      {onRetry && (\n        <button className=\"btn btn-primary\" onClick={onRetry}>\n          <RefreshCw size={16} /> {retryLabel}\n        </button>\n      )}\n    </div>\n  )\n})\n\n/**\n * EmptyState - Reusable empty state component\n * Shows when a list/data is empty (no error, just no data)\n */\nexport const EmptyState = memo(function EmptyState({\n  title = 'No data yet',\n  message = 'Items will appear here once added.',\n  icon: Icon = null,\n  action = null,\n  actionLabel = 'Get Started',\n  onAction = null\n}) {\n  return (\n    <div className=\"empty-state\" role=\"status\">\n      {Icon && (\n        <div className=\"empty-state-icon-wrapper\">\n          <Icon size={32} className=\"empty-state-icon\" aria-hidden=\"true\" />\n        </div>\n      )}\n      <h4 className=\"empty-state-title\">{title}</h4>\n      <p className=\"empty-state-message\">{message}</p>\n      {onAction && (\n        <button className=\"btn btn-primary btn-small\" onClick={onAction}>\n          {actionLabel}\n        </button>\n      )}\n      {action && !onAction && action}\n    </div>\n  )\n})\n\nexport default ErrorState\n","import { memo } from 'react'\nimport { AlertCircle } from 'lucide-react'\n\n/**\n * FormField - Reusable form field wrapper with validation display\n * Provides consistent styling and error handling for form inputs\n */\nexport const FormField = memo(function FormField({\n  label,\n  error,\n  required = false,\n  hint,\n  children,\n  className = ''\n}) {\n  return (\n    <div className={`form-field ${error ? 'has-error' : ''} ${className}`}>\n      {label && (\n        <label className=\"form-field-label\">\n          {label}\n          {required && <span className=\"form-field-required\">*</span>}\n        </label>\n      )}\n      <div className=\"form-field-input\">\n        {children}\n      </div>\n      {error && (\n        <div className=\"form-field-error\" role=\"alert\">\n          <AlertCircle size={14} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n      {hint && !error && (\n        <div className=\"form-field-hint\">{hint}</div>\n      )}\n    </div>\n  )\n})\n\n/**\n * ValidatedInput - Input with built-in validation styling\n */\nexport const ValidatedInput = memo(function ValidatedInput({\n  type = 'text',\n  value,\n  onChange,\n  onBlur,\n  error,\n  placeholder,\n  disabled,\n  min,\n  max,\n  step,\n  pattern,\n  required,\n  autoComplete,\n  name,\n  id,\n  className = '',\n  'aria-label': ariaLabel,\n  'aria-describedby': ariaDescribedBy\n}) {\n  const inputId = id || name\n  const errorId = error ? `${inputId}-error` : undefined\n\n  return (\n    <>\n      <input\n        type={type}\n        id={inputId}\n        name={name}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        placeholder={placeholder}\n        disabled={disabled}\n        min={min}\n        max={max}\n        step={step}\n        pattern={pattern}\n        required={required}\n        autoComplete={autoComplete}\n        className={`validated-input ${error ? 'has-error' : ''} ${className}`}\n        aria-label={ariaLabel}\n        aria-invalid={!!error}\n        aria-describedby={error ? errorId : ariaDescribedBy}\n      />\n      {error && (\n        <div id={errorId} className=\"input-error-inline\" role=\"alert\">\n          <AlertCircle size={12} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n    </>\n  )\n})\n\n/**\n * ValidatedSelect - Select with built-in validation styling\n */\nexport const ValidatedSelect = memo(function ValidatedSelect({\n  value,\n  onChange,\n  onBlur,\n  error,\n  disabled,\n  required,\n  name,\n  id,\n  className = '',\n  children,\n  'aria-label': ariaLabel\n}) {\n  const selectId = id || name\n  const errorId = error ? `${selectId}-error` : undefined\n\n  return (\n    <>\n      <select\n        id={selectId}\n        name={name}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        disabled={disabled}\n        required={required}\n        className={`validated-select ${error ? 'has-error' : ''} ${className}`}\n        aria-label={ariaLabel}\n        aria-invalid={!!error}\n        aria-describedby={error ? errorId : undefined}\n      >\n        {children}\n      </select>\n      {error && (\n        <div id={errorId} className=\"input-error-inline\" role=\"alert\">\n          <AlertCircle size={12} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n    </>\n  )\n})\n\n/**\n * ValidatedTextarea - Textarea with built-in validation styling\n */\nexport const ValidatedTextarea = memo(function ValidatedTextarea({\n  value,\n  onChange,\n  onBlur,\n  error,\n  placeholder,\n  disabled,\n  required,\n  rows = 3,\n  maxLength,\n  name,\n  id,\n  className = '',\n  'aria-label': ariaLabel\n}) {\n  const textareaId = id || name\n  const errorId = error ? `${textareaId}-error` : undefined\n\n  return (\n    <>\n      <textarea\n        id={textareaId}\n        name={name}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        placeholder={placeholder}\n        disabled={disabled}\n        required={required}\n        rows={rows}\n        maxLength={maxLength}\n        className={`validated-textarea ${error ? 'has-error' : ''} ${className}`}\n        aria-label={ariaLabel}\n        aria-invalid={!!error}\n        aria-describedby={error ? errorId : undefined}\n      />\n      {maxLength && (\n        <div className=\"textarea-counter\">\n          {value?.length || 0} / {maxLength}\n        </div>\n      )}\n      {error && (\n        <div id={errorId} className=\"input-error-inline\" role=\"alert\">\n          <AlertCircle size={12} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n    </>\n  )\n})\n\nexport default FormField\n","import { memo, useEffect, useState } from 'react'\nimport { TrendingUp, TrendingDown, Minus, Check, AlertTriangle, Clock } from 'lucide-react'\n\n/**\n * Micro-Visualizations - Small, informative visual elements\n * Designed to replace mental calculation and clarify status at a glance\n */\n\n// Animated count badge with optional pulse for new items\nexport const CountBadge = memo(function CountBadge({\n  count,\n  label,\n  variant = 'default', // 'default' | 'primary' | 'success' | 'warning' | 'danger'\n  size = 'medium', // 'small' | 'medium' | 'large'\n  pulse = false,\n  icon: Icon\n}) {\n  const [prevCount, setPrevCount] = useState(count)\n  const [animating, setAnimating] = useState(false)\n\n  useEffect(() => {\n    if (count !== prevCount) {\n      setAnimating(true)\n      const timer = setTimeout(() => {\n        setAnimating(false)\n        setPrevCount(count)\n      }, 400)\n      return () => clearTimeout(timer)\n    }\n  }, [count, prevCount])\n\n  return (\n    <span\n      className={`count-badge count-badge-${variant} count-badge-${size} ${pulse ? 'badge-new' : ''} ${animating ? 'animate-count-up' : ''}`}\n      title={label}\n    >\n      {Icon && <Icon size={size === 'small' ? 12 : size === 'large' ? 18 : 14} />}\n      <span className=\"count-badge-value\">{count}</span>\n      {label && <span className=\"count-badge-label\">{label}</span>}\n    </span>\n  )\n})\n\n// Mini progress bar for inline usage\nexport const MiniProgress = memo(function MiniProgress({\n  value,\n  max = 100,\n  showLabel = false,\n  size = 'medium', // 'small' | 'medium' | 'large'\n  variant = 'default', // 'default' | 'success' | 'warning' | 'danger'\n  animated = true\n}) {\n  const percentage = Math.min(100, Math.max(0, (value / max) * 100))\n  const height = size === 'small' ? '4px' : size === 'large' ? '8px' : '6px'\n\n  // Auto-determine variant based on percentage if not specified\n  const autoVariant = variant === 'default'\n    ? percentage >= 80 ? 'danger' : percentage >= 60 ? 'warning' : 'success'\n    : variant\n\n  return (\n    <div className={`mini-progress mini-progress-${size}`}>\n      <div className=\"mini-progress-track\" style={{ height }}>\n        <div\n          className={`mini-progress-fill mini-progress-${autoVariant} ${animated ? 'progress-animate' : ''}`}\n          style={{ width: `${percentage}%` }}\n        />\n      </div>\n      {showLabel && (\n        <span className=\"mini-progress-label\">{Math.round(percentage)}%</span>\n      )}\n    </div>\n  )\n})\n\n// Trend indicator with direction and value\nexport const TrendIndicator = memo(function TrendIndicator({\n  value,\n  previousValue,\n  format = 'percent', // 'percent' | 'number' | 'currency'\n  inverted = false, // If true, down is good (e.g., costs)\n  showValue = true\n}) {\n  const diff = value - previousValue\n  const percentChange = previousValue !== 0 ? ((diff / previousValue) * 100) : 0\n\n  let direction = diff === 0 ? 'neutral' : diff > 0 ? 'up' : 'down'\n  let status = 'neutral'\n\n  if (diff !== 0) {\n    if (inverted) {\n      status = diff > 0 ? 'negative' : 'positive'\n    } else {\n      status = diff > 0 ? 'positive' : 'negative'\n    }\n  }\n\n  const Icon = direction === 'up' ? TrendingUp : direction === 'down' ? TrendingDown : Minus\n\n  const formatValue = () => {\n    const absChange = Math.abs(diff)\n    switch (format) {\n      case 'percent':\n        return `${Math.abs(percentChange).toFixed(1)}%`\n      case 'currency':\n        return new Intl.NumberFormat('en-US', {\n          style: 'currency',\n          currency: 'USD',\n          minimumFractionDigits: 0,\n          maximumFractionDigits: 0\n        }).format(absChange)\n      default:\n        return absChange.toLocaleString()\n    }\n  }\n\n  return (\n    <span className={`trend-indicator trend-${status}`}>\n      <Icon size={14} />\n      {showValue && <span className=\"trend-value\">{formatValue()}</span>}\n    </span>\n  )\n})\n\n// Status dot with optional label\nexport const StatusDot = memo(function StatusDot({\n  status = 'default', // 'default' | 'success' | 'warning' | 'danger' | 'info'\n  label,\n  size = 'medium', // 'small' | 'medium' | 'large'\n  pulse = false\n}) {\n  return (\n    <span className={`status-dot-container status-dot-${size}`}>\n      <span className={`status-dot status-dot-${status} ${pulse ? 'status-dot-pulse' : ''}`} />\n      {label && <span className=\"status-dot-label\">{label}</span>}\n    </span>\n  )\n})\n\n// Sparkline - mini line chart\nexport const Sparkline = memo(function Sparkline({\n  data = [],\n  width = 80,\n  height = 24,\n  strokeWidth = 2,\n  color = 'var(--accent-blue)',\n  showArea = true\n}) {\n  if (!data.length) return null\n\n  const max = Math.max(...data)\n  const min = Math.min(...data)\n  const range = max - min || 1\n\n  const points = data.map((value, index) => {\n    const x = (index / (data.length - 1)) * width\n    const y = height - ((value - min) / range) * (height - strokeWidth * 2) - strokeWidth\n    return `${x},${y}`\n  }).join(' ')\n\n  const areaPoints = `0,${height} ${points} ${width},${height}`\n\n  return (\n    <svg\n      width={width}\n      height={height}\n      className=\"sparkline\"\n      viewBox={`0 0 ${width} ${height}`}\n    >\n      {showArea && (\n        <polygon\n          points={areaPoints}\n          fill={color}\n          fillOpacity=\"0.15\"\n        />\n      )}\n      <polyline\n        points={points}\n        fill=\"none\"\n        stroke={color}\n        strokeWidth={strokeWidth}\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n    </svg>\n  )\n})\n\n// Quick stats row (e.g., \"3 workers  2.5 hrs  $450\")\nexport const QuickStats = memo(function QuickStats({ items = [] }) {\n  return (\n    <div className=\"quick-stats\">\n      {items.map((item, index) => (\n        <span key={index} className=\"quick-stat-item\">\n          {item.icon && <item.icon size={12} />}\n          <span className=\"quick-stat-value\">{item.value}</span>\n          {item.label && <span className=\"quick-stat-label\">{item.label}</span>}\n        </span>\n      ))}\n    </div>\n  )\n})\n\n// Status indicator with icon\nexport const StatusIndicator = memo(function StatusIndicator({\n  status, // 'success' | 'warning' | 'danger' | 'info' | 'pending'\n  label,\n  size = 'medium'\n}) {\n  const icons = {\n    success: Check,\n    warning: AlertTriangle,\n    danger: AlertTriangle,\n    info: Clock,\n    pending: Clock\n  }\n\n  const Icon = icons[status] || icons.info\n\n  return (\n    <span className={`status-indicator status-indicator-${status} status-indicator-${size}`}>\n      <Icon size={size === 'small' ? 12 : size === 'large' ? 18 : 14} />\n      {label && <span className=\"status-indicator-label\">{label}</span>}\n    </span>\n  )\n})\n\n// Metric delta (change from previous)\nexport const MetricDelta = memo(function MetricDelta({\n  current,\n  previous,\n  format = 'number', // 'number' | 'currency' | 'percent'\n  label,\n  inverted = false\n}) {\n  const delta = current - previous\n  const isPositive = inverted ? delta < 0 : delta > 0\n  const isNegative = inverted ? delta > 0 : delta < 0\n\n  const formatValue = (val) => {\n    switch (format) {\n      case 'currency':\n        return new Intl.NumberFormat('en-US', {\n          style: 'currency',\n          currency: 'USD',\n          minimumFractionDigits: 0\n        }).format(Math.abs(val))\n      case 'percent':\n        return `${Math.abs(val).toFixed(1)}%`\n      default:\n        return Math.abs(val).toLocaleString()\n    }\n  }\n\n  return (\n    <div className={`metric-delta ${isPositive ? 'positive' : isNegative ? 'negative' : 'neutral'}`}>\n      <span className=\"metric-delta-arrow\">\n        {delta > 0 ? '' : delta < 0 ? '' : ''}\n      </span>\n      <span className=\"metric-delta-value\">{formatValue(delta)}</span>\n      {label && <span className=\"metric-delta-label\">{label}</span>}\n    </div>\n  )\n})\n\n// Circular progress (donut style)\nexport const CircularProgress = memo(function CircularProgress({\n  value,\n  max = 100,\n  size = 40,\n  strokeWidth = 4,\n  showValue = true,\n  color = 'var(--accent-blue)'\n}) {\n  const percentage = Math.min(100, Math.max(0, (value / max) * 100))\n  const radius = (size - strokeWidth) / 2\n  const circumference = radius * 2 * Math.PI\n  const offset = circumference - (percentage / 100) * circumference\n\n  return (\n    <div className=\"circular-progress\" style={{ width: size, height: size }}>\n      <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`}>\n        <circle\n          className=\"circular-progress-track\"\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          fill=\"none\"\n          strokeWidth={strokeWidth}\n        />\n        <circle\n          className=\"circular-progress-fill\"\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          fill=\"none\"\n          stroke={color}\n          strokeWidth={strokeWidth}\n          strokeDasharray={circumference}\n          strokeDashoffset={offset}\n          strokeLinecap=\"round\"\n          transform={`rotate(-90 ${size / 2} ${size / 2})`}\n          style={{ transition: 'stroke-dashoffset 0.5s ease' }}\n        />\n      </svg>\n      {showValue && (\n        <span className=\"circular-progress-value\">\n          {Math.round(percentage)}%\n        </span>\n      )}\n    </div>\n  )\n})\n\nexport default {\n  CountBadge,\n  MiniProgress,\n  TrendIndicator,\n  StatusDot,\n  Sparkline,\n  QuickStats,\n  StatusIndicator,\n  MetricDelta,\n  CircularProgress\n}\n","import { useEffect, useRef, useCallback, memo } from 'react'\nimport { X } from 'lucide-react'\n\n/**\n * Accessible Modal Component\n *\n * Features:\n * - Proper ARIA attributes (role=\"dialog\", aria-modal, aria-labelledby)\n * - Focus trap within modal\n * - Escape key to close\n * - Click outside to close\n * - Focus restoration on close\n *\n * Usage:\n *   <Modal\n *     isOpen={showModal}\n *     onClose={() => setShowModal(false)}\n *     title=\"Modal Title\"\n *     size=\"medium\"\n *   >\n *     <p>Modal content here</p>\n *   </Modal>\n */\nconst Modal = memo(function Modal({\n  isOpen,\n  onClose,\n  title,\n  children,\n  size = 'medium', // 'small' | 'medium' | 'large' | 'full'\n  className = '',\n  showCloseButton = true,\n  closeOnOverlayClick = true,\n  closeOnEscape = true,\n  footer,\n  ariaDescribedBy\n}) {\n  const modalRef = useRef(null)\n  const previousActiveElement = useRef(null)\n  const titleId = useRef(`modal-title-${Math.random().toString(36).substr(2, 9)}`)\n\n  // Store the previously focused element and focus the modal when it opens\n  useEffect(() => {\n    if (isOpen) {\n      previousActiveElement.current = document.activeElement\n      // Focus the modal container after a brief delay to ensure it's rendered\n      const timer = setTimeout(() => {\n        modalRef.current?.focus()\n      }, 10)\n      return () => clearTimeout(timer)\n    }\n  }, [isOpen])\n\n  // Restore focus when modal closes\n  useEffect(() => {\n    if (!isOpen && previousActiveElement.current) {\n      previousActiveElement.current.focus()\n    }\n  }, [isOpen])\n\n  // Handle escape key\n  useEffect(() => {\n    if (!isOpen || !closeOnEscape) return\n\n    const handleKeyDown = (e) => {\n      if (e.key === 'Escape') {\n        e.preventDefault()\n        onClose()\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyDown)\n    return () => document.removeEventListener('keydown', handleKeyDown)\n  }, [isOpen, closeOnEscape, onClose])\n\n  // Prevent body scroll when modal is open\n  useEffect(() => {\n    if (isOpen) {\n      const originalOverflow = document.body.style.overflow\n      document.body.style.overflow = 'hidden'\n      return () => {\n        document.body.style.overflow = originalOverflow\n      }\n    }\n  }, [isOpen])\n\n  // Focus trap\n  const handleKeyDown = useCallback((e) => {\n    if (e.key !== 'Tab') return\n\n    const focusableElements = modalRef.current?.querySelectorAll(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    )\n\n    if (!focusableElements || focusableElements.length === 0) return\n\n    const firstElement = focusableElements[0]\n    const lastElement = focusableElements[focusableElements.length - 1]\n\n    if (e.shiftKey) {\n      if (document.activeElement === firstElement) {\n        e.preventDefault()\n        lastElement.focus()\n      }\n    } else {\n      if (document.activeElement === lastElement) {\n        e.preventDefault()\n        firstElement.focus()\n      }\n    }\n  }, [])\n\n  const handleOverlayClick = (e) => {\n    if (closeOnOverlayClick && e.target === e.currentTarget) {\n      onClose()\n    }\n  }\n\n  if (!isOpen) return null\n\n  const sizeClasses = {\n    small: 'modal-small',\n    medium: 'modal-medium',\n    large: 'modal-large',\n    full: 'modal-full'\n  }\n\n  return (\n    <div\n      className=\"modal-overlay\"\n      onClick={handleOverlayClick}\n      role=\"presentation\"\n    >\n      <div\n        ref={modalRef}\n        className={`modal-content ${sizeClasses[size] || ''} ${className}`}\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby={title ? titleId.current : undefined}\n        aria-describedby={ariaDescribedBy}\n        tabIndex={-1}\n        onKeyDown={handleKeyDown}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {title && (\n          <div className=\"modal-header\">\n            <h2 id={titleId.current}>{title}</h2>\n            {showCloseButton && (\n              <button\n                className=\"close-btn\"\n                onClick={onClose}\n                aria-label=\"Close modal\"\n                type=\"button\"\n              >\n                <X size={20} />\n              </button>\n            )}\n          </div>\n        )}\n\n        <div className=\"modal-body\">\n          {children}\n        </div>\n\n        {footer && (\n          <div className=\"modal-footer\">\n            {footer}\n          </div>\n        )}\n      </div>\n    </div>\n  )\n})\n\nexport default Modal\n","import { memo, useMemo } from 'react'\nimport { DollarSign, TrendingUp, Receipt, PiggyBank } from 'lucide-react'\nimport { HeroMetricsSkeleton, MiniProgress, TrendIndicator } from './ui'\n\n/**\n * HeroMetrics - Top-level financial summary for project dashboard\n * Designed for instant comprehension of project financial health\n */\n\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount || 0)\n}\n\nconst MetricCard = memo(function MetricCard({\n  icon: Icon,\n  label,\n  value,\n  formattedValue,\n  subLabel,\n  progress,\n  progressLabel,\n  variant = 'default', // 'default' | 'success' | 'warning' | 'danger'\n  trend,\n  previousValue\n}) {\n  const variantColors = {\n    default: 'var(--accent-blue)',\n    success: 'var(--accent-green)',\n    warning: 'var(--accent-amber)',\n    danger: 'var(--accent-red)'\n  }\n\n  return (\n    <div className={`hero-metric-card hover-lift animate-fade-in-up`}>\n      <div className=\"hero-metric-header\">\n        <div className=\"hero-metric-icon\" style={{ color: variantColors[variant] }}>\n          <Icon size={18} />\n        </div>\n        <span className=\"hero-metric-label\">{label}</span>\n      </div>\n\n      <div className=\"hero-metric-value-row\">\n        <span className={`hero-metric-value hero-metric-${variant}`}>\n          {formattedValue}\n        </span>\n        {trend !== undefined && previousValue !== undefined && (\n          <TrendIndicator\n            value={value}\n            previousValue={previousValue}\n            format=\"currency\"\n            inverted={label.toLowerCase().includes('cost')}\n          />\n        )}\n      </div>\n\n      {subLabel && (\n        <span className=\"hero-metric-sublabel\">{subLabel}</span>\n      )}\n\n      {progress !== undefined && (\n        <div className=\"hero-metric-progress\">\n          <MiniProgress\n            value={progress}\n            max={100}\n            size=\"small\"\n            variant={variant}\n            showLabel\n          />\n          {progressLabel && (\n            <span className=\"hero-metric-progress-label\">{progressLabel}</span>\n          )}\n        </div>\n      )}\n    </div>\n  )\n})\n\nexport default memo(function HeroMetrics({\n  contractValue = 0,\n  earnedRevenue = 0,\n  totalCosts = 0,\n  profit = 0,\n  progress = 0,\n  corApprovedValue = 0,\n  loading = false,\n  previousData // Optional: for trend indicators\n}) {\n  // Calculate derived values\n  const revisedContract = contractValue + corApprovedValue\n  const profitMargin = earnedRevenue > 0 ? ((profit / earnedRevenue) * 100) : 0\n  const costRatio = earnedRevenue > 0 ? ((totalCosts / earnedRevenue) * 100) : 0\n  const revenueProgress = revisedContract > 0 ? ((earnedRevenue / revisedContract) * 100) : 0\n  const costProgress = revisedContract > 0 ? ((totalCosts / revisedContract) * 100) : 0\n\n  // Determine profit status\n  const profitVariant = useMemo(() => {\n    if (profitMargin >= 20) return 'success'\n    if (profitMargin >= 10) return 'warning'\n    if (profitMargin < 0) return 'danger'\n    return 'default'\n  }, [profitMargin])\n\n  // Determine cost status\n  const costVariant = useMemo(() => {\n    if (costRatio <= 60) return 'success'\n    if (costRatio <= 80) return 'warning'\n    return 'danger'\n  }, [costRatio])\n\n  if (loading) {\n    return <HeroMetricsSkeleton />\n  }\n\n  return (\n    <div className=\"hero-metrics stagger-children\">\n      {/* Contract Value */}\n      <MetricCard\n        icon={DollarSign}\n        label=\"Contract Value\"\n        value={revisedContract}\n        formattedValue={formatCurrency(revisedContract)}\n        subLabel={corApprovedValue > 0 ? `+${formatCurrency(corApprovedValue)} CORs` : null}\n        variant=\"default\"\n      />\n\n      {/* Earned Revenue */}\n      <MetricCard\n        icon={TrendingUp}\n        label=\"Earned Revenue\"\n        value={earnedRevenue}\n        formattedValue={formatCurrency(earnedRevenue)}\n        progress={revenueProgress}\n        progressLabel={`${Math.round(revenueProgress)}% of contract`}\n        variant=\"success\"\n        previousValue={previousData?.earnedRevenue}\n        trend={previousData ? earnedRevenue : undefined}\n      />\n\n      {/* Total Costs */}\n      <MetricCard\n        icon={Receipt}\n        label=\"Total Costs\"\n        value={totalCosts}\n        formattedValue={formatCurrency(totalCosts)}\n        progress={costProgress}\n        progressLabel={`${Math.round(costRatio)}% of revenue`}\n        variant={costVariant}\n        previousValue={previousData?.totalCosts}\n        trend={previousData ? totalCosts : undefined}\n      />\n\n      {/* Profit */}\n      <MetricCard\n        icon={PiggyBank}\n        label=\"Profit\"\n        value={profit}\n        formattedValue={formatCurrency(profit)}\n        subLabel={`${profitMargin >= 0 ? '+' : ''}${profitMargin.toFixed(1)}% margin`}\n        variant={profitVariant}\n        previousValue={previousData?.profit}\n        trend={previousData ? profit : undefined}\n      />\n    </div>\n  )\n})\n","import { memo } from 'react'\nimport { BarChart3, FileText, ClipboardList, Receipt, ChevronRight, ChevronLeft, PanelLeftOpen, X } from 'lucide-react'\nimport { CountBadge } from './ui'\n\n/**\n * FinancialsNav - Collapsible sidebar navigation for Financials tab\n *\n * Design principles:\n * - Workflow order: Overview  CORs  T&M (reflects natural process)\n * - Collapsible to maximize content real estate\n * - Clear visual hierarchy with active states\n * - Badges show pending items requiring attention\n */\n\nconst NAV_ITEMS = [\n  {\n    id: 'overview',\n    label: 'Overview',\n    shortLabel: 'Overview',\n    icon: BarChart3,\n    description: 'Metrics & trends',\n    step: null\n  },\n  {\n    id: 'cors',\n    label: 'Change Orders',\n    shortLabel: 'CORs',\n    icon: FileText,\n    description: 'CORs & approvals',\n    step: 1\n  },\n  {\n    id: 'tickets',\n    label: 'Time & Material',\n    shortLabel: 'Tickets',\n    icon: ClipboardList,\n    description: 'Field data',\n    step: 2\n  },\n  {\n    id: 'billing',\n    label: 'Billing',\n    shortLabel: 'Billing',\n    icon: Receipt,\n    description: 'Invoices & billing',\n    step: 3\n  }\n]\n\nexport default memo(function FinancialsNav({\n  activeSection = 'overview',\n  onSectionChange,\n  collapsed = false,\n  onToggleCollapse,\n  onMobileClose,\n  stats = {}\n}) {\n  const {\n    corCount = 0,\n    ticketCount = 0,\n    corPending = 0,\n    ticketPending = 0,\n    billableCount = 0,\n    invoiceCount = 0\n  } = stats\n\n  // Get badge config for each section\n  const getBadge = (itemId) => {\n    if (itemId === 'cors' && corCount > 0) {\n      return {\n        count: corCount,\n        variant: corPending > 0 ? 'warning' : 'default',\n        pending: corPending\n      }\n    }\n    if (itemId === 'tickets' && ticketCount > 0) {\n      return {\n        count: ticketCount,\n        variant: ticketPending > 0 ? 'warning' : 'default',\n        pending: ticketPending\n      }\n    }\n    if (itemId === 'billing' && billableCount > 0) {\n      return {\n        count: billableCount,\n        variant: 'success', // Green to indicate money ready to collect\n        pending: billableCount\n      }\n    }\n    return null\n  }\n\n  return (\n    <nav\n      className={`financials-nav ${collapsed ? 'collapsed' : ''}`}\n      aria-label=\"Financials sections\"\n    >\n      {/* Mobile Header with Close Button */}\n      {onMobileClose && (\n        <div className=\"financials-nav-mobile-header\">\n          <span className=\"financials-nav-mobile-title\">Financials</span>\n          <button\n            className=\"financials-nav-mobile-close\"\n            onClick={onMobileClose}\n            aria-label=\"Close menu\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n      )}\n\n      {/* Collapse Toggle - hidden on mobile */}\n      <button\n        className=\"financials-nav-toggle\"\n        onClick={onToggleCollapse}\n        aria-label={collapsed ? 'Expand sidebar' : 'Collapse sidebar'}\n        title={collapsed ? 'Expand sidebar' : 'Collapse sidebar'}\n      >\n        {collapsed ? (\n          <PanelLeftOpen size={18} />\n        ) : (\n          <ChevronLeft size={18} />\n        )}\n        {!collapsed && <span>Collapse</span>}\n      </button>\n\n      {/* Navigation Items */}\n      <div className=\"financials-nav-items\">\n        {NAV_ITEMS.map((item, index) => {\n          const isActive = activeSection === item.id\n          const Icon = item.icon\n          const badge = getBadge(item.id)\n          const showConnector = index < NAV_ITEMS.length - 1 && item.step !== null\n\n          return (\n            <div key={item.id} className=\"financials-nav-item-wrapper\">\n              <button\n                className={`financials-nav-item ${isActive ? 'active' : ''}`}\n                onClick={() => onSectionChange?.(item.id)}\n                aria-current={isActive ? 'page' : undefined}\n                title={`${item.label}${badge ? ` (${badge.count})` : ''}`}\n              >\n                {/* Step indicator for workflow items - only in expanded mode */}\n                {item.step && !collapsed && (\n                  <span className=\"financials-nav-step\">{item.step}</span>\n                )}\n\n                {/* Icon with optional badge dot */}\n                <div className=\"financials-nav-icon\">\n                  <Icon size={collapsed ? 22 : 20} />\n                  {/* Badge dot for pending items */}\n                  {badge && badge.pending > 0 && (\n                    <span className=\"financials-nav-dot\" />\n                  )}\n                </div>\n\n                {/* Collapsed mode: show short label below icon */}\n                {collapsed && (\n                  <span className=\"financials-nav-short-label\">{item.shortLabel}</span>\n                )}\n\n                {/* Expanded mode: show full content */}\n                {!collapsed && (\n                  <>\n                    <div className=\"financials-nav-content\">\n                      <span className=\"financials-nav-label\">{item.label}</span>\n                      <span className=\"financials-nav-desc\">{item.description}</span>\n                    </div>\n\n                    {/* Badge */}\n                    {badge && (\n                      <CountBadge\n                        count={badge.count}\n                        size=\"small\"\n                        variant={badge.variant}\n                      />\n                    )}\n\n                    {/* Arrow */}\n                    <ChevronRight size={16} className=\"financials-nav-arrow\" />\n                  </>\n                )}\n              </button>\n\n              {/* Workflow connector line */}\n              {showConnector && !collapsed && (\n                <div className=\"financials-nav-connector\">\n                  <div className=\"connector-line\" />\n                </div>\n              )}\n            </div>\n          )\n        })}\n      </div>\n\n      {/* Toggle label when collapsed */}\n      {collapsed && (\n        <button\n          className=\"financials-nav-expand-btn\"\n          onClick={onToggleCollapse}\n          aria-label=\"Expand sidebar\"\n        >\n          <ChevronRight size={14} />\n          <span>Expand</span>\n        </button>\n      )}\n    </nav>\n  )\n})\n","// ============================================\n// Chart Data Transformations\n// ============================================\n// Utilities to transform Dashboard.jsx data into\n// chart-friendly formats for Recharts.\n// ============================================\n\nimport { chartColors, costCategories } from '../components/charts/chartConfig'\n\n/**\n * Build cumulative time-series for the Financial Trend Chart\n * Merges labor, disposal, materials/equipment, T&M, and COR data by date\n * Uses actual area completion dates for revenue tracking\n *\n * @param {Object} projectData - Computed project data from Dashboard\n * @param {Object} project - Selected project\n * @param {Array} tmTickets - T&M tickets for the project\n * @param {Object} corStats - COR statistics\n * @param {Array} areas - Project areas with completion dates\n * @param {number} changeOrderValue - Approved change order value to include in revenue\n * @returns {Array} Chart-ready data points\n */\nexport function buildFinancialTimeSeries(projectData, project, tmTickets = [], corStats = null, areas = [], changeOrderValue = 0) {\n  const contractValue = project?.contract_value || 0\n  const revisedContractValue = contractValue + changeOrderValue\n  const laborByDate = projectData?.laborByDate || []\n  const haulOffByDate = projectData?.haulOffByDate || []\n  const materialsEquipmentByDate = projectData?.materialsEquipmentByDate || []\n  const customCosts = projectData?.customCosts || []\n\n  // Collect all unique dates from all sources\n  const dateSet = new Set()\n\n  laborByDate.forEach(d => dateSet.add(d.date))\n  haulOffByDate.forEach(d => dateSet.add(d.date))\n  materialsEquipmentByDate.forEach(d => dateSet.add(d.date))\n  customCosts.forEach(c => {\n    if (c.cost_date) dateSet.add(c.cost_date)\n  })\n\n  // Add T&M ticket dates\n  tmTickets.forEach(t => {\n    if (t.work_date) dateSet.add(t.work_date)\n    if (t.ticket_date) dateSet.add(t.ticket_date)\n    if (t.created_at) dateSet.add(t.created_at.split('T')[0])\n  })\n\n  // Add area completion dates (for revenue tracking)\n  areas.forEach(area => {\n    if (area.status === 'done' && area.updated_at) {\n      dateSet.add(area.updated_at.split('T')[0])\n    }\n  })\n\n  // Sort dates chronologically\n  const sortedDates = [...dateSet].sort((a, b) => new Date(a) - new Date(b))\n\n  if (sortedDates.length === 0) {\n    return []\n  }\n\n  // Build revenue by date based on completed areas\n  // Each completed area contributes its weight/value to revenue on its completion date\n  const revenueByDate = {}\n  const totalWeight = areas.reduce((sum, a) => sum + (parseFloat(a.weight) || 0), 0)\n\n  areas.forEach(area => {\n    if (area.status === 'done' && area.updated_at) {\n      const completionDate = area.updated_at.split('T')[0]\n      const areaWeight = parseFloat(area.weight) || 0\n      // Calculate area's contribution to revenue\n      // If scheduled_value exists (SOV), use that; otherwise calculate from weight\n      // Use revisedContractValue (includes change orders) for non-SOV projects\n      const areaValue = area.scheduled_value\n        ? parseFloat(area.scheduled_value)\n        : (totalWeight > 0 ? (areaWeight / totalWeight) * revisedContractValue : 0)\n\n      if (!revenueByDate[completionDate]) {\n        revenueByDate[completionDate] = 0\n      }\n      revenueByDate[completionDate] += areaValue\n    }\n  })\n\n  // Pre-calculate T&M values by date\n  // Use the actual property names from the database: t_and_m_workers, t_and_m_items\n  const tmByDate = {}\n  tmTickets.forEach(ticket => {\n    const date = ticket.work_date || ticket.ticket_date || ticket.created_at?.split('T')[0]\n    if (!date) return\n\n    // Calculate ticket value (labor + materials + equipment)\n    let ticketValue = 0\n\n    // Labor value - handles both property name variations\n    const workers = ticket.t_and_m_workers || ticket.workers || []\n    if (Array.isArray(workers)) {\n      workers.forEach(w => {\n        // Handle both naming conventions: hours/regular_hours, overtime_hours\n        const regHours = parseFloat(w.hours) || parseFloat(w.regular_hours) || 0\n        const otHours = parseFloat(w.overtime_hours) || 0\n        // Use rates if available, otherwise default billing rates\n        const regRate = parseFloat(w.regular_rate) || parseFloat(w.rate) || 65\n        const otRate = parseFloat(w.overtime_rate) || regRate * 1.5\n        ticketValue += (regHours * regRate) + (otHours * otRate)\n      })\n    }\n\n    // Materials and equipment - handles both property name variations\n    const items = ticket.t_and_m_items || ticket.items || []\n    if (Array.isArray(items)) {\n      items.forEach(item => {\n        const qty = parseFloat(item.quantity) || 1\n        // Handle different cost property locations\n        const unitCost = parseFloat(item.unit_cost) ||\n                         parseFloat(item.materials_equipment?.cost_per_unit) || 0\n        ticketValue += qty * unitCost\n      })\n    }\n\n    if (!tmByDate[date]) {\n      tmByDate[date] = 0\n    }\n    tmByDate[date] += ticketValue\n  })\n\n  // Pre-calculate custom costs by date\n  const customByDate = {}\n  customCosts.forEach(cost => {\n    const date = cost.cost_date\n    if (!date) return\n    if (!customByDate[date]) {\n      customByDate[date] = 0\n    }\n    customByDate[date] += parseFloat(cost.amount) || 0\n  })\n\n  // Pre-calculate materials/equipment costs by date (for quick lookup)\n  const materialsEquipmentByDateMap = {}\n  materialsEquipmentByDate.forEach(d => {\n    if (d.date) {\n      materialsEquipmentByDateMap[d.date] = d.cost || 0\n    }\n  })\n\n  // Determine if we have area-based revenue data\n  const hasAreaData = Object.keys(revenueByDate).length > 0\n  const billable = projectData?.billable || 0\n\n  // For fallback revenue (no area completion dates), we need total costs first\n  // to distribute billable proportionally based on when work was done\n  let totalCostForFallback = 0\n  if (!hasAreaData && billable > 0) {\n    sortedDates.forEach(date => {\n      const laborDay = laborByDate.find(d => d.date === date)\n      const laborCost = laborDay?.cost || 0\n      const haulOffDay = haulOffByDate.find(d => d.date === date)\n      const haulOffCost = haulOffDay?.cost || 0\n      const materialsEquipmentCost = materialsEquipmentByDateMap[date] || 0\n      const customCost = customByDate[date] || 0\n      totalCostForFallback += laborCost + materialsEquipmentCost + haulOffCost + customCost\n    })\n  }\n\n  // Build cumulative data\n  let cumulativeCost = 0\n  let cumulativeTMValue = 0\n\n  // Track cumulative revenue based on actual area completions\n  let cumulativeRevenue = 0\n\n  // Build the time series\n  const timeSeries = sortedDates.map((date) => {\n    // Find labor cost for this date\n    const laborDay = laborByDate.find(d => d.date === date)\n    const laborCost = laborDay?.cost || 0\n\n    // Find haul-off cost for this date\n    const haulOffDay = haulOffByDate.find(d => d.date === date)\n    const haulOffCost = haulOffDay?.cost || 0\n\n    // Materials/equipment cost for this date (from T&M tickets)\n    const materialsEquipmentCost = materialsEquipmentByDateMap[date] || 0\n\n    // Custom costs for this date\n    const customCost = customByDate[date] || 0\n\n    // Accumulate all costs (labor + materials/equipment + disposal + custom)\n    const dailyTotalCost = laborCost + materialsEquipmentCost + haulOffCost + customCost\n    cumulativeCost += dailyTotalCost\n\n    // Accumulate T&M billing value (what we charge client)\n    const tmDayValue = tmByDate[date] || 0\n    cumulativeTMValue += tmDayValue\n\n    // Calculate revenue\n    let revenue\n    if (hasAreaData) {\n      // Use actual area completion dates for revenue tracking\n      const dailyRevenue = revenueByDate[date] || 0\n      cumulativeRevenue += dailyRevenue\n      revenue = cumulativeRevenue\n    } else if (totalCostForFallback > 0) {\n      // Fallback: distribute billable proportionally based on cost progression\n      // Revenue is earned roughly in proportion to when costs are incurred\n      revenue = (cumulativeCost / totalCostForFallback) * billable\n    } else {\n      // No cost data either - show billable as flat (truly no data to distribute)\n      revenue = billable\n    }\n\n    const dailyRevenue = hasAreaData ? (revenueByDate[date] || 0) : 0\n\n    return {\n      date,\n      contract: revisedContractValue,\n      revenue: Math.round(revenue),\n      costs: Math.round(cumulativeCost),\n      tmValue: Math.round(cumulativeTMValue),\n      corValue: Math.round(corStats?.total_approved_value || 0),\n      profit: Math.round(revenue - cumulativeCost),\n      // Daily values for tooltips\n      dailyLabor: Math.round(laborCost),\n      dailyRevenue: Math.round(dailyRevenue),\n      dailyMaterials: Math.round(materialsEquipmentCost),\n      dailyHaulOff: Math.round(haulOffCost),\n      dailyCustom: Math.round(customCost),\n      dailyTM: Math.round(tmDayValue),\n      dailyTotal: Math.round(dailyTotalCost),\n    }\n  })\n\n  return timeSeries\n}\n\n/**\n * Filter time series by date range\n *\n * @param {Array} data - Full time series data\n * @param {number|null} days - Number of days to include (null = all)\n * @returns {Array} Filtered data\n */\nexport function filterByTimeRange(data, days) {\n  if (!days || !data.length) return data\n\n  const now = new Date()\n  const cutoff = new Date()\n  cutoff.setDate(now.getDate() - days)\n\n  return data.filter(d => new Date(d.date) >= cutoff)\n}\n\n/**\n * Build cost distribution data for donut chart\n *\n * @param {number} laborCost - Total labor cost\n * @param {number} haulOffCost - Total disposal cost\n * @param {Array} customCosts - Array of custom cost entries\n * @returns {Array} Chart-ready segments\n */\nexport function buildCostDistribution(laborCost = 0, haulOffCost = 0, customCosts = [], materialsEquipmentCost = 0) {\n  const segments = []\n\n  // Add labor if present\n  if (laborCost > 0) {\n    segments.push({\n      name: 'Labor',\n      value: laborCost,\n      color: chartColors.labor,\n      category: 'labor',\n    })\n  }\n\n  // Add disposal if present\n  if (haulOffCost > 0) {\n    segments.push({\n      name: 'Disposal',\n      value: haulOffCost,\n      color: chartColors.disposal,\n      category: 'disposal',\n    })\n  }\n\n  // Add materials & equipment from T&M tickets if present\n  if (materialsEquipmentCost > 0) {\n    segments.push({\n      name: 'Materials & Equipment',\n      value: materialsEquipmentCost,\n      color: chartColors.equipment || '#f59e0b',\n      category: 'equipment',\n    })\n  }\n\n  // Group custom costs by category\n  const grouped = {}\n  customCosts.forEach(cost => {\n    const cat = cost.category || 'other'\n    if (!grouped[cat]) {\n      grouped[cat] = {\n        items: [],\n        total: 0,\n      }\n    }\n    grouped[cat].items.push(cost)\n    grouped[cat].total += parseFloat(cost.amount) || 0\n  })\n\n  // Add grouped custom costs\n  Object.entries(grouped).forEach(([category, data]) => {\n    if (data.total > 0) {\n      const catConfig = costCategories[category] || costCategories.other\n      segments.push({\n        name: catConfig.label,\n        value: data.total,\n        color: catConfig.color,\n        category,\n        items: data.items,\n      })\n    }\n  })\n\n  // Calculate percentages\n  const total = segments.reduce((sum, s) => sum + s.value, 0)\n  segments.forEach(s => {\n    s.percentage = total > 0 ? Math.round((s.value / total) * 100) : 0\n  })\n\n  // Sort by value descending\n  segments.sort((a, b) => b.value - a.value)\n\n  return segments\n}\n\n/**\n * Build COR funnel data\n *\n * @param {Object} corStats - COR statistics from database\n * @returns {Array} Funnel stages\n */\nexport function buildCORFunnel(corStats) {\n  if (!corStats) return []\n\n  return [\n    {\n      stage: 'Draft',\n      count: corStats.draft_count || 0,\n      value: 0, // Draft CORs typically don't have values yet\n      color: chartColors.other,\n    },\n    {\n      stage: 'Pending',\n      count: corStats.pending_count || 0,\n      value: corStats.total_pending_value || 0,\n      color: chartColors.costs,\n    },\n    {\n      stage: 'Approved',\n      count: corStats.approved_count || 0,\n      value: corStats.total_approved_value || 0,\n      color: chartColors.revenue,\n    },\n    {\n      stage: 'Billed',\n      count: corStats.billed_count || 0,\n      value: corStats.total_billed_value || 0,\n      color: chartColors.profit,\n    },\n  ]\n}\n\n/**\n * Build daily burn data for sparkline\n *\n * @param {Array} laborByDate - Daily labor costs\n * @param {Array} haulOffByDate - Daily haul-off costs\n * @param {number} limit - Max number of days to include\n * @returns {Array} Sparkline data points\n */\nexport function buildBurnSparkline(laborByDate = [], haulOffByDate = [], limit = 14) {\n  // Merge and sort by date\n  const dateMap = {}\n\n  laborByDate.forEach(d => {\n    if (!dateMap[d.date]) {\n      dateMap[d.date] = { date: d.date, labor: 0, haulOff: 0 }\n    }\n    dateMap[d.date].labor = d.cost || 0\n  })\n\n  haulOffByDate.forEach(d => {\n    if (!dateMap[d.date]) {\n      dateMap[d.date] = { date: d.date, labor: 0, haulOff: 0 }\n    }\n    dateMap[d.date].haulOff = d.cost || 0\n  })\n\n  // Convert to array and sort\n  const data = Object.values(dateMap)\n    .map(d => ({\n      date: d.date,\n      total: d.labor + d.haulOff,\n      labor: d.labor,\n      haulOff: d.haulOff,\n    }))\n    .sort((a, b) => new Date(a.date) - new Date(b.date))\n\n  // Return last N days\n  return data.slice(-limit)\n}\n\n/**\n * Calculate trend direction from time series\n *\n * @param {Array} data - Time series data\n * @param {string} key - Data key to analyze\n * @returns {Object} Trend info { direction, percentage }\n */\nexport function calculateTrend(data, key) {\n  if (!data || data.length < 2) {\n    return { direction: 'flat', percentage: 0 }\n  }\n\n  const recent = data.slice(-7)\n  if (recent.length < 2) {\n    return { direction: 'flat', percentage: 0 }\n  }\n\n  const first = recent[0][key] || 0\n  const last = recent[recent.length - 1][key] || 0\n\n  if (first === 0) {\n    return { direction: last > 0 ? 'up' : 'flat', percentage: 0 }\n  }\n\n  const change = ((last - first) / first) * 100\n\n  return {\n    direction: change > 5 ? 'up' : change < -5 ? 'down' : 'flat',\n    percentage: Math.abs(Math.round(change)),\n  }\n}\n","import { formatChartDate, chartColors } from './chartConfig'\n\n/**\n * Custom tooltip for financial charts\n * Displays detailed breakdown on hover\n */\nexport default function ChartTooltip({ active, payload, label }) {\n  if (!active || !payload || !payload.length) {\n    return null\n  }\n\n  // Format currency\n  const formatCurrency = (value) => {\n    if (value >= 1000000) {\n      return `$${(value / 1000000).toFixed(2)}M`\n    }\n    if (value >= 1000) {\n      return `$${(value / 1000).toFixed(1)}K`\n    }\n    return `$${value.toFixed(0)}`\n  }\n\n  // Get the data point\n  const data = payload[0]?.payload || {}\n\n  return (\n    <div className=\"chart-tooltip\">\n      <div className=\"chart-tooltip-date\">\n        {formatChartDate(label)}\n      </div>\n\n      <div className=\"chart-tooltip-rows\">\n        {/* Contract */}\n        {data.contract !== undefined && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.contract }}\n              />\n              Contract\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.contract)}\n            </span>\n          </div>\n        )}\n\n        {/* Revenue */}\n        {data.revenue !== undefined && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.revenue }}\n              />\n              Revenue\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.revenue)}\n            </span>\n          </div>\n        )}\n\n        {/* Costs */}\n        {data.costs !== undefined && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.costs }}\n              />\n              Costs\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.costs)}\n            </span>\n          </div>\n        )}\n\n        {/* T&M Value */}\n        {data.tmValue !== undefined && data.tmValue > 0 && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.tmValue }}\n              />\n              T&M Value\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.tmValue)}\n            </span>\n          </div>\n        )}\n\n        {/* COR Value */}\n        {data.corValue !== undefined && data.corValue > 0 && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.corValue }}\n              />\n              COR Approved\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.corValue)}\n            </span>\n          </div>\n        )}\n\n        {/* Profit/Loss */}\n        {data.profit !== undefined && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{\n                  backgroundColor: data.profit >= 0\n                    ? chartColors.profit\n                    : chartColors.loss\n                }}\n              />\n              {data.profit >= 0 ? 'Profit' : 'Loss'}\n            </span>\n            <span\n              className=\"chart-tooltip-value\"\n              style={{\n                color: data.profit >= 0\n                  ? chartColors.profit\n                  : chartColors.loss\n              }}\n            >\n              {formatCurrency(Math.abs(data.profit))}\n            </span>\n          </div>\n        )}\n      </div>\n\n      {/* Daily breakdown if available */}\n      {(data.dailyRevenue > 0 || data.dailyLabor > 0 || data.dailyMaterials > 0 || data.dailyHaulOff > 0 || data.dailyTM > 0) && (\n        <div className=\"chart-tooltip-daily\">\n          <div className=\"chart-tooltip-daily-label\">Today's Activity</div>\n          {data.dailyRevenue > 0 && (\n            <div className=\"chart-tooltip-daily-row earned\">\n              <span style={{ color: chartColors.revenue }}>\n                Areas Completed: {formatCurrency(data.dailyRevenue)}\n              </span>\n            </div>\n          )}\n          {data.dailyLabor > 0 && (\n            <div className=\"chart-tooltip-daily-row\">\n              Labor: {formatCurrency(data.dailyLabor)}\n            </div>\n          )}\n          {data.dailyMaterials > 0 && (\n            <div className=\"chart-tooltip-daily-row\">\n              Materials: {formatCurrency(data.dailyMaterials)}\n            </div>\n          )}\n          {data.dailyHaulOff > 0 && (\n            <div className=\"chart-tooltip-daily-row\">\n              Disposal: {formatCurrency(data.dailyHaulOff)}\n            </div>\n          )}\n          {data.dailyTM > 0 && (\n            <div className=\"chart-tooltip-daily-row\">\n              T&M Added: {formatCurrency(data.dailyTM)}\n            </div>\n          )}\n          {data.dailyTotal > 0 && (\n            <div className=\"chart-tooltip-daily-row total\">\n              <strong>Day Costs: {formatCurrency(data.dailyTotal)}</strong>\n            </div>\n          )}\n        </div>\n      )}\n\n      <div className=\"chart-tooltip-hint\">\n        Click to see details\n      </div>\n    </div>\n  )\n}\n","import { useState, useMemo } from 'react'\nimport {\n  AreaChart,\n  Area,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  Legend,\n  ReferenceLine,\n} from 'recharts'\nimport { TrendingUp, TrendingDown, Minus } from 'lucide-react'\nimport {\n  chartColors,\n  animationConfig,\n  timeRanges,\n  formatChartCurrency,\n  formatChartDate,\n  gradientDefs,\n} from './chartConfig'\nimport { buildFinancialTimeSeries, filterByTimeRange, calculateTrend } from '../../lib/chartDataTransforms'\nimport ChartTooltip from './ChartTooltip'\n\n/**\n * Financial Trend Chart\n * Multi-line area chart showing contract, revenue, costs, T&M, and COR values over time\n * Uses actual area completion dates for revenue tracking\n */\nexport default function FinancialTrendChart({\n  projectData,\n  project,\n  tmTickets = [],\n  corStats = null,\n  areas = [],\n  changeOrderValue = 0,\n  onDrillDown,\n}) {\n  const [timeRange, setTimeRange] = useState('30d')\n  const [hoveredLine, setHoveredLine] = useState(null)\n\n  // Build the time series data using actual area completions for revenue\n  const chartData = useMemo(() => {\n    const allData = buildFinancialTimeSeries(projectData, project, tmTickets, corStats, areas, changeOrderValue)\n    const selectedRange = timeRanges.find(r => r.id === timeRange)\n    return filterByTimeRange(allData, selectedRange?.days)\n  }, [projectData, project, tmTickets, corStats, areas, changeOrderValue, timeRange])\n\n  // Calculate trend indicators\n  const costsTrend = useMemo(() => calculateTrend(chartData, 'costs'), [chartData])\n  const revenueTrend = useMemo(() => calculateTrend(chartData, 'revenue'), [chartData])\n\n  // Handle click on data point\n  const handleClick = (data) => {\n    if (data?.activePayload?.[0]) {\n      const point = data.activePayload[0].payload\n      onDrillDown?.(point.date, point)\n    }\n  }\n\n  // Trend icon component\n  const TrendIcon = ({ trend }) => {\n    if (trend.direction === 'up') {\n      return <TrendingUp size={14} className=\"trend-icon up\" />\n    }\n    if (trend.direction === 'down') {\n      return <TrendingDown size={14} className=\"trend-icon down\" />\n    }\n    return <Minus size={14} className=\"trend-icon flat\" />\n  }\n\n  if (!chartData.length) {\n    return (\n      <div className=\"financial-trend-chart empty\">\n        <div className=\"chart-empty-state\">\n          <p>No financial data available yet.</p>\n          <span>Start tracking labor and costs to see trends.</span>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"financial-trend-chart\">\n      <div className=\"chart-header\">\n        <div className=\"chart-title-section\">\n          <h3>Financial Trend</h3>\n          <div className=\"chart-trend-indicators\">\n            <span className=\"trend-badge\">\n              <span style={{ color: chartColors.revenue }}>Revenue</span>\n              <TrendIcon trend={revenueTrend} />\n              {revenueTrend.percentage > 0 && (\n                <span className=\"trend-pct\">{revenueTrend.percentage}%</span>\n              )}\n            </span>\n            <span className=\"trend-badge\">\n              <span style={{ color: chartColors.costs }}>Costs</span>\n              <TrendIcon trend={costsTrend} />\n              {costsTrend.percentage > 0 && (\n                <span className=\"trend-pct\">{costsTrend.percentage}%</span>\n              )}\n            </span>\n          </div>\n        </div>\n\n        <div className=\"time-range-selector\">\n          {timeRanges.map(range => (\n            <button\n              key={range.id}\n              className={timeRange === range.id ? 'active' : ''}\n              onClick={() => setTimeRange(range.id)}\n            >\n              {range.label}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      <div className=\"chart-container\">\n        <ResponsiveContainer width=\"100%\" height={300}>\n          <AreaChart\n            data={chartData}\n            onClick={handleClick}\n            margin={{ top: 10, right: 10, left: 0, bottom: 0 }}\n          >\n            {/* Gradient definitions */}\n            <defs>\n              {Object.values(gradientDefs).map(grad => (\n                <linearGradient\n                  key={grad.id}\n                  id={grad.id}\n                  x1=\"0\"\n                  y1=\"0\"\n                  x2=\"0\"\n                  y2=\"1\"\n                >\n                  <stop\n                    offset=\"5%\"\n                    stopColor={grad.color}\n                    stopOpacity={grad.startOpacity}\n                  />\n                  <stop\n                    offset=\"95%\"\n                    stopColor={grad.color}\n                    stopOpacity={grad.endOpacity}\n                  />\n                </linearGradient>\n              ))}\n            </defs>\n\n            <CartesianGrid\n              strokeDasharray=\"3 3\"\n              stroke=\"var(--border-color)\"\n              vertical={false}\n            />\n\n            <XAxis\n              dataKey=\"date\"\n              tickFormatter={formatChartDate}\n              stroke=\"var(--text-secondary)\"\n              tick={{ fontSize: 11 }}\n              tickLine={false}\n              axisLine={{ stroke: 'var(--border-color)' }}\n            />\n\n            <YAxis\n              tickFormatter={formatChartCurrency}\n              stroke=\"var(--text-secondary)\"\n              tick={{ fontSize: 11 }}\n              tickLine={false}\n              axisLine={false}\n              width={60}\n            />\n\n            <Tooltip content={<ChartTooltip />} />\n\n            <Legend\n              verticalAlign=\"top\"\n              height={36}\n              iconType=\"circle\"\n              iconSize={8}\n              formatter={(value) => (\n                <span style={{ color: 'var(--text-secondary)', fontSize: '12px' }}>\n                  {value}\n                </span>\n              )}\n            />\n\n            {/* Contract ceiling - dashed reference line */}\n            {chartData[0]?.contract > 0 && (\n              <ReferenceLine\n                y={chartData[0].contract}\n                stroke={chartColors.contract}\n                strokeDasharray=\"5 5\"\n                strokeWidth={2}\n                label={{\n                  value: 'Contract',\n                  position: 'right',\n                  fill: chartColors.contract,\n                  fontSize: 11,\n                }}\n              />\n            )}\n\n            {/* Revenue area */}\n            <Area\n              type=\"monotone\"\n              dataKey=\"revenue\"\n              name=\"Revenue\"\n              stroke={chartColors.revenue}\n              strokeWidth={2}\n              fill=\"url(#revenueGradient)\"\n              animationDuration={animationConfig.duration}\n              onMouseEnter={() => setHoveredLine('revenue')}\n              onMouseLeave={() => setHoveredLine(null)}\n              style={{\n                opacity: hoveredLine && hoveredLine !== 'revenue' ? 0.3 : 1,\n              }}\n            />\n\n            {/* Costs area */}\n            <Area\n              type=\"monotone\"\n              dataKey=\"costs\"\n              name=\"Costs\"\n              stroke={chartColors.costs}\n              strokeWidth={2}\n              fill=\"url(#costsGradient)\"\n              animationDuration={animationConfig.duration}\n              onMouseEnter={() => setHoveredLine('costs')}\n              onMouseLeave={() => setHoveredLine(null)}\n              style={{\n                opacity: hoveredLine && hoveredLine !== 'costs' ? 0.3 : 1,\n              }}\n            />\n\n            {/* T&M Value area */}\n            {chartData.some(d => d.tmValue > 0) && (\n              <Area\n                type=\"monotone\"\n                dataKey=\"tmValue\"\n                name=\"Time & Material Value\"\n                stroke={chartColors.tmValue}\n                strokeWidth={2}\n                fill=\"url(#tmValueGradient)\"\n                animationDuration={animationConfig.duration}\n                onMouseEnter={() => setHoveredLine('tmValue')}\n                onMouseLeave={() => setHoveredLine(null)}\n                style={{\n                  opacity: hoveredLine && hoveredLine !== 'tmValue' ? 0.3 : 1,\n                }}\n              />\n            )}\n\n            {/* COR Approved Value - shown as reference line (static total) */}\n            {(corStats?.total_approved_value || 0) > 0 && (\n              <ReferenceLine\n                y={corStats.total_approved_value}\n                stroke={chartColors.corValue}\n                strokeDasharray=\"4 2\"\n                strokeWidth={2}\n                label={{\n                  value: `COR Approved`,\n                  position: 'right',\n                  fill: chartColors.corValue,\n                  fontSize: 11,\n                }}\n              />\n            )}\n          </AreaChart>\n        </ResponsiveContainer>\n      </div>\n\n      {/* Quick stats below chart */}\n      <div className=\"chart-quick-stats\">\n        <div className=\"quick-stat\">\n          <span className=\"stat-label\">Current Revenue</span>\n          <span className=\"stat-value\" style={{ color: chartColors.revenue }}>\n            {formatChartCurrency(chartData[chartData.length - 1]?.revenue || 0)}\n          </span>\n        </div>\n        <div className=\"quick-stat\">\n          <span className=\"stat-label\">Total Costs</span>\n          <span className=\"stat-value\" style={{ color: chartColors.costs }}>\n            {formatChartCurrency(chartData[chartData.length - 1]?.costs || 0)}\n          </span>\n        </div>\n        <div className=\"quick-stat\">\n          <span className=\"stat-label\">Margin</span>\n          <span\n            className=\"stat-value\"\n            style={{\n              color: (chartData[chartData.length - 1]?.profit || 0) >= 0\n                ? chartColors.profit\n                : chartColors.loss\n            }}\n          >\n            {(() => {\n              const last = chartData[chartData.length - 1]\n              if (!last || !last.revenue) return '0%'\n              const margin = ((last.revenue - last.costs) / last.revenue) * 100\n              return `${margin.toFixed(1)}%`\n            })()}\n          </span>\n        </div>\n        {chartData[chartData.length - 1]?.tmValue > 0 && (\n          <div className=\"quick-stat\">\n            <span className=\"stat-label\">Time & Material Pending</span>\n            <span className=\"stat-value\" style={{ color: chartColors.tmValue }}>\n              {formatChartCurrency(chartData[chartData.length - 1]?.tmValue || 0)}\n            </span>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n","import { useState, useMemo } from 'react'\nimport {\n  PieChart,\n  Pie,\n  Cell,\n  ResponsiveContainer,\n  Tooltip,\n  Legend,\n} from 'recharts'\nimport { animationConfig, formatChartCurrency } from './chartConfig'\nimport { buildCostDistribution } from '../../lib/chartDataTransforms'\n\n/**\n * Cost Distribution Donut Chart\n * Shows breakdown of costs by category with interactive segments\n */\nexport default function CostDonut({\n  laborCost = 0,\n  haulOffCost = 0,\n  materialsEquipmentCost = 0,\n  customCosts = [],\n  onSegmentClick,\n}) {\n  const [activeIndex, setActiveIndex] = useState(null)\n\n  // Build the donut segments\n  const segments = useMemo(() => {\n    return buildCostDistribution(laborCost, haulOffCost, customCosts, materialsEquipmentCost)\n  }, [laborCost, haulOffCost, customCosts, materialsEquipmentCost])\n\n  // Calculate total\n  const totalCost = useMemo(() => {\n    return segments.reduce((sum, s) => sum + s.value, 0)\n  }, [segments])\n\n  // Handle segment hover\n  const handleMouseEnter = (_, index) => {\n    setActiveIndex(index)\n  }\n\n  const handleMouseLeave = () => {\n    setActiveIndex(null)\n  }\n\n  // Handle segment click\n  const handleClick = (data, index) => {\n    if (onSegmentClick) {\n      onSegmentClick(segments[index])\n    }\n  }\n\n  // Custom tooltip\n  const CustomTooltip = ({ active, payload }) => {\n    if (!active || !payload || !payload.length) {\n      return null\n    }\n\n    const data = payload[0].payload\n    return (\n      <div className=\"chart-tooltip donut-tooltip\">\n        <div className=\"chart-tooltip-row\">\n          <span className=\"chart-tooltip-label\">\n            <span\n              className=\"chart-tooltip-dot\"\n              style={{ backgroundColor: data.color }}\n            />\n            {data.name}\n          </span>\n          <span className=\"chart-tooltip-value\">\n            {formatChartCurrency(data.value)}\n          </span>\n        </div>\n        <div className=\"donut-tooltip-pct\">\n          {data.percentage}% of total costs\n        </div>\n        {data.items && data.items.length > 0 && (\n          <div className=\"donut-tooltip-items\">\n            <div className=\"donut-tooltip-items-label\">\n              {data.items.length} item{data.items.length > 1 ? 's' : ''}\n            </div>\n          </div>\n        )}\n        {onSegmentClick && (\n          <div className=\"chart-tooltip-hint\">\n            Click to view details\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  // Custom legend\n  const renderLegend = (props) => {\n    const { payload } = props\n    return (\n      <div className=\"donut-legend\">\n        {payload.map((entry, index) => (\n          <div\n            key={`legend-${index}`}\n            className={`donut-legend-item ${activeIndex === index ? 'active' : ''}`}\n            onMouseEnter={() => setActiveIndex(index)}\n            onMouseLeave={() => setActiveIndex(null)}\n            onClick={() => handleClick(null, index)}\n          >\n            <span\n              className=\"donut-legend-color\"\n              style={{ backgroundColor: entry.payload.color }}\n            />\n            <span className=\"donut-legend-name\">{entry.value}</span>\n            <span className=\"donut-legend-value\">\n              {formatChartCurrency(entry.payload.value)}\n            </span>\n          </div>\n        ))}\n      </div>\n    )\n  }\n\n  if (!segments.length || totalCost === 0) {\n    return (\n      <div className=\"cost-donut empty\">\n        <div className=\"chart-empty-state\">\n          <p>No cost data available.</p>\n          <span>Add labor, disposal, or custom costs to see breakdown.</span>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"cost-donut\">\n      <div className=\"donut-chart-container\">\n        <ResponsiveContainer width=\"100%\" height={200}>\n          <PieChart>\n            <Pie\n              data={segments}\n              cx=\"50%\"\n              cy=\"50%\"\n              innerRadius={50}\n              outerRadius={80}\n              paddingAngle={2}\n              dataKey=\"value\"\n              onMouseEnter={handleMouseEnter}\n              onMouseLeave={handleMouseLeave}\n              onClick={handleClick}\n              animationDuration={animationConfig.duration}\n              animationEasing=\"ease-out\"\n            >\n              {segments.map((entry, index) => (\n                <Cell\n                  key={`cell-${index}`}\n                  fill={entry.color}\n                  stroke=\"var(--card-bg)\"\n                  strokeWidth={2}\n                  style={{\n                    filter: activeIndex === index ? 'brightness(1.1)' : 'none',\n                    cursor: onSegmentClick ? 'pointer' : 'default',\n                    transform: activeIndex === index ? 'scale(1.05)' : 'scale(1)',\n                    transformOrigin: 'center',\n                    transition: 'all 0.2s ease',\n                  }}\n                />\n              ))}\n            </Pie>\n            <Tooltip content={<CustomTooltip />} />\n            <Legend content={renderLegend} />\n          </PieChart>\n        </ResponsiveContainer>\n\n        {/* Center label showing total */}\n        <div className=\"donut-center-label\">\n          <span className=\"donut-center-value\">\n            {formatChartCurrency(totalCost)}\n          </span>\n          <span className=\"donut-center-text\">Total</span>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import { TrendingDown, AlertCircle, CheckCircle } from 'lucide-react'\n\n// Helper to format currency\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount || 0)\n}\n\nexport default function ProfitabilityCard({\n  revenue,      // billable amount (earned based on progress)\n  totalCosts,   // all costs combined\n  contractValue, // total contract value\n  progress      // completion percentage\n}) {\n  // Current profit and margin\n  const currentProfit = revenue - totalCosts\n  const currentMargin = revenue > 0 ? (currentProfit / revenue) * 100 : 0\n\n  // Projected final values (extrapolate based on current progress)\n  const projectedRevenue = contractValue\n  const projectedCosts = progress > 0 ? (totalCosts / (progress / 100)) : totalCosts\n  const projectedProfit = projectedRevenue - projectedCosts\n  const projectedMargin = projectedRevenue > 0 ? (projectedProfit / projectedRevenue) * 100 : 0\n\n  // Determine status\n  const isHealthy = currentMargin >= 20\n  const isWarning = currentMargin >= 0 && currentMargin < 20\n  const isLoss = currentMargin < 0\n\n  const status = isHealthy ? 'healthy' : isWarning ? 'warning' : 'loss'\n  const statusLabel = isHealthy ? 'On Track' : isWarning ? 'Watch Margin' : 'Over Cost'\n  const StatusIcon = isHealthy ? CheckCircle : isWarning ? AlertCircle : TrendingDown\n\n  return (\n    <div className={`profitability-card ${status}`}>\n      <div className=\"profitability-header\">\n        <h3>Profitability</h3>\n        <div className={`profitability-status ${status}`}>\n          <StatusIcon size={14} />\n          <span>{statusLabel}</span>\n        </div>\n      </div>\n\n      <div className=\"profitability-metrics\">\n        {/* Current Margin */}\n        <div className=\"profit-metric\">\n          <div className=\"profit-metric-header\">\n            <span className=\"profit-metric-label\">Current Margin</span>\n            <span className={`profit-metric-value ${currentMargin < 0 ? 'negative' : ''}`}>\n              {Math.round(currentMargin)}%\n            </span>\n          </div>\n          <div className=\"profit-bar-container\">\n            <div\n              className={`profit-bar ${currentMargin < 0 ? 'negative' : currentMargin < 20 ? 'warning' : 'healthy'}`}\n              style={{ width: `${Math.min(Math.abs(currentMargin), 100)}%` }}\n            ></div>\n          </div>\n        </div>\n\n        {/* Projected Final Margin */}\n        {progress > 10 && (\n          <div className=\"profit-metric\">\n            <div className=\"profit-metric-header\">\n              <span className=\"profit-metric-label\">Projected Final</span>\n              <span className={`profit-metric-value ${projectedMargin < 0 ? 'negative' : ''}`}>\n                {Math.round(projectedMargin)}%\n              </span>\n            </div>\n            <div className=\"profit-bar-container\">\n              <div\n                className={`profit-bar ${projectedMargin < 0 ? 'negative' : projectedMargin < 20 ? 'warning' : 'healthy'}`}\n                style={{ width: `${Math.min(Math.abs(projectedMargin), 100)}%` }}\n              ></div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      <div className=\"profitability-summary\">\n        <div className=\"profit-row\">\n          <span className=\"profit-label\">Revenue Earned</span>\n          <span className=\"profit-value\">{formatCurrency(revenue)}</span>\n        </div>\n        <div className=\"profit-row\">\n          <span className=\"profit-label\">Total Costs</span>\n          <span className=\"profit-value negative\">- {formatCurrency(totalCosts)}</span>\n        </div>\n        <div className=\"profit-row profit-total\">\n          <span className=\"profit-label\">Current Profit</span>\n          <span className={`profit-value ${currentProfit < 0 ? 'negative' : 'positive'}`}>\n            {currentProfit >= 0 ? '' : '-'}{formatCurrency(Math.abs(currentProfit))}\n          </span>\n        </div>\n      </div>\n\n      {progress > 10 && (\n        <div className=\"profitability-insight\">\n          {isHealthy && (\n            <p>\n              At {Math.round(progress)}% complete, you're at {formatCurrency(currentProfit)} profit.\n              {projectedProfit > 0 && ` Projected final profit: ${formatCurrency(projectedProfit)}`}\n            </p>\n          )}\n          {isWarning && (\n            <p>\n              Margins are thin. Consider reviewing costs or scope.\n              {projectedProfit < 0 && ` Trending toward ${formatCurrency(projectedProfit)} loss.`}\n            </p>\n          )}\n          {isLoss && (\n            <p>\n              Currently over cost by {formatCurrency(Math.abs(currentProfit))}.\n              Immediate review recommended.\n            </p>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n","import { useState } from 'react'\nimport { ChevronDown, ChevronUp, Plus, HardHat, Truck, Wrench, Package, Users, MoreHorizontal, Trash2 } from 'lucide-react'\nimport { CostDonut } from './charts'\n\n// Helper to format currency\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount || 0)\n}\n\n// Category display info\nconst categoryInfo = {\n  labor: { label: 'Labor', Icon: HardHat, color: '#3b82f6' },\n  disposal: { label: 'Disposal', Icon: Truck, color: '#10b981' },\n  equipment: { label: 'Equipment', Icon: Wrench, color: '#f59e0b' },\n  materials: { label: 'Materials', Icon: Package, color: '#8b5cf6' },\n  subcontractor: { label: 'Subcontractor', Icon: Users, color: '#ec4899' },\n  other: { label: 'Other', Icon: MoreHorizontal, color: '#6b7280' }\n}\n\nexport default function CostContributorsCard({\n  laborCost = 0,\n  haulOffCost = 0,\n  materialsEquipmentCost = 0,\n  customCosts = [],\n  onAddCost,\n  onDeleteCost\n}) {\n  const [showChart, setShowChart] = useState(true)\n  const [expandedCategory, setExpandedCategory] = useState(null)\n\n  // Build cost breakdown combining auto-tracked and custom costs\n  const costBreakdown = []\n\n  // Labor (auto-tracked from crew check-ins)\n  if (laborCost > 0) {\n    costBreakdown.push({\n      category: 'labor',\n      label: 'Labor',\n      amount: laborCost,\n      source: 'auto',\n      description: 'From crew check-ins'\n    })\n  }\n\n  // Disposal (auto-tracked from haul-offs)\n  if (haulOffCost > 0) {\n    costBreakdown.push({\n      category: 'disposal',\n      label: 'Disposal',\n      amount: haulOffCost,\n      source: 'auto',\n      description: 'From haul-off logs'\n    })\n  }\n\n  // Materials & Equipment (auto-tracked from T&M tickets)\n  if (materialsEquipmentCost > 0) {\n    costBreakdown.push({\n      category: 'equipment',\n      label: 'Materials & Equipment',\n      amount: materialsEquipmentCost,\n      source: 'auto',\n      description: 'From T&M tickets'\n    })\n  }\n\n  // Group custom costs by category\n  const customByCategory = {}\n  customCosts.forEach(cost => {\n    if (!customByCategory[cost.category]) {\n      customByCategory[cost.category] = {\n        category: cost.category,\n        items: [],\n        total: 0\n      }\n    }\n    customByCategory[cost.category].items.push(cost)\n    customByCategory[cost.category].total += parseFloat(cost.amount) || 0\n  })\n\n  // Add custom cost categories\n  Object.values(customByCategory).forEach(group => {\n    const info = categoryInfo[group.category] || categoryInfo.other\n    costBreakdown.push({\n      category: group.category,\n      label: info.label,\n      amount: group.total,\n      source: 'manual',\n      items: group.items\n    })\n  })\n\n  // Calculate total\n  const totalCost = costBreakdown.reduce((sum, cat) => sum + cat.amount, 0)\n\n  // Calculate percentages and sort by amount\n  costBreakdown.forEach(cat => {\n    cat.percentage = totalCost > 0 ? (cat.amount / totalCost) * 100 : 0\n  })\n  costBreakdown.sort((a, b) => b.amount - a.amount)\n\n  // Toggle category expansion\n  const toggleCategory = (category) => {\n    setExpandedCategory(expandedCategory === category ? null : category)\n  }\n\n  // Handle donut segment click\n  const handleSegmentClick = (segment) => {\n    if (segment.items && segment.items.length > 0) {\n      setShowChart(false)\n      setExpandedCategory(segment.category)\n    }\n  }\n\n  return (\n    <div className=\"cost-contributors-card\">\n      <div className=\"cost-contributors-header\">\n        <div className=\"cost-contributors-title\">\n          <h3>Cost Contributors</h3>\n          <span className=\"cost-total\">{formatCurrency(totalCost)}</span>\n        </div>\n        {costBreakdown.length > 0 && (\n          <div className=\"cost-view-toggle\">\n            <button\n              className={showChart ? 'active' : ''}\n              onClick={() => setShowChart(true)}\n            >\n              Chart\n            </button>\n            <button\n              className={!showChart ? 'active' : ''}\n              onClick={() => setShowChart(false)}\n            >\n              List\n            </button>\n          </div>\n        )}\n      </div>\n\n      {costBreakdown.length === 0 ? (\n        <div className=\"cost-empty\">\n          <p>No costs recorded yet</p>\n          <small>Costs will appear as crew checks in and haul-offs are logged</small>\n        </div>\n      ) : showChart ? (\n        <CostDonut\n          laborCost={laborCost}\n          haulOffCost={haulOffCost}\n          materialsEquipmentCost={materialsEquipmentCost}\n          customCosts={customCosts}\n          onSegmentClick={handleSegmentClick}\n        />\n      ) : (\n        <div className=\"cost-breakdown\">\n          {costBreakdown.map(category => {\n            const info = categoryInfo[category.category] || categoryInfo.other\n            const Icon = info.Icon\n            const hasItems = category.items && category.items.length > 0\n            const isExpanded = expandedCategory === category.category\n\n            return (\n              <div key={category.category} className=\"cost-category\">\n                <div\n                  className={`cost-category-row ${hasItems ? 'expandable' : ''}`}\n                  onClick={() => hasItems && toggleCategory(category.category)}\n                >\n                  <div className=\"cost-category-bar-container\">\n                    <div\n                      className=\"cost-category-bar\"\n                      style={{\n                        width: `${Math.max(category.percentage, 2)}%`,\n                        backgroundColor: info.color\n                      }}\n                    ></div>\n                  </div>\n                  <div className=\"cost-category-info\">\n                    <div className=\"cost-category-label\">\n                      <Icon size={14} style={{ color: info.color }} />\n                      <span>{category.label}</span>\n                      {category.source === 'auto' && (\n                        <span className=\"cost-auto-badge\">Auto</span>\n                      )}\n                      {hasItems && (\n                        isExpanded ? <ChevronUp size={14} /> : <ChevronDown size={14} />\n                      )}\n                    </div>\n                    <div className=\"cost-category-values\">\n                      <span className=\"cost-amount\">{formatCurrency(category.amount)}</span>\n                      <span className=\"cost-percent\">{Math.round(category.percentage)}%</span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Expanded items for manual costs */}\n                {isExpanded && hasItems && (\n                  <div className=\"cost-category-items\">\n                    {category.items.map(item => (\n                      <div key={item.id} className=\"cost-item\">\n                        <div className=\"cost-item-info\">\n                          <span className=\"cost-item-desc\">{item.description}</span>\n                          <span className=\"cost-item-date\">\n                            {new Date(item.cost_date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                          </span>\n                        </div>\n                        <div className=\"cost-item-actions\">\n                          <span className=\"cost-item-amount\">{formatCurrency(item.amount)}</span>\n                          {onDeleteCost && (\n                            <button\n                              className=\"cost-item-delete\"\n                              onClick={(e) => {\n                                e.stopPropagation()\n                                if (confirm('Delete this cost entry?')) {\n                                  onDeleteCost(item.id)\n                                }\n                              }}\n                            >\n                              <Trash2 size={14} />\n                            </button>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      )}\n\n      {onAddCost && (\n        <button className=\"cost-add-btn\" onClick={onAddCost}>\n          <Plus size={16} />\n          <span>Add Cost</span>\n        </button>\n      )}\n    </div>\n  )\n}\n","import { useState, useEffect } from 'react'\nimport { Truck, ChevronDown, ChevronUp } from 'lucide-react'\nimport { db } from '../lib/supabase'\n\nconst LOAD_TYPES = [\n  { value: 'concrete', label: 'Concrete', icon: '' },\n  { value: 'trash', label: 'Trash', icon: '' },\n  { value: 'metals', label: 'Metals', icon: '' },\n  { value: 'hazardous_waste', label: 'Hazardous', icon: '' }\n]\n\nconst getLoadTypeInfo = (type) => LOAD_TYPES.find(t => t.value === type) || { label: type, icon: '' }\n\nexport default function DisposalSummary({ project, period = 'week' }) {\n  const [loads, setLoads] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [expanded, setExpanded] = useState(false)\n\n  useEffect(() => {\n    if (project?.id) {\n      loadData()\n    }\n  }, [project?.id, period])\n\n  const loadData = async () => {\n    try {\n      setLoading(true)\n      const days = period === 'week' ? 7 : period === 'month' ? 30 : 14\n      const data = await db.getDisposalLoadsHistory(project.id, days)\n      setLoads(data || [])\n    } catch (err) {\n      console.error('Error loading disposal summary:', err)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // Group loads by type for totals\n  const loadsByType = loads.reduce((acc, load) => {\n    const type = load.load_type\n    if (!acc[type]) {\n      acc[type] = 0\n    }\n    acc[type] += load.load_count\n    return acc\n  }, {})\n\n  // Group by date for breakdown\n  const loadsByDate = loads.reduce((acc, load) => {\n    const date = load.load_date || load.work_date\n    if (!acc[date]) {\n      acc[date] = { date, loads: [], total: 0 }\n    }\n    acc[date].loads.push(load)\n    acc[date].total += load.load_count\n    return acc\n  }, {})\n\n  const sortedDates = Object.values(loadsByDate)\n    .sort((a, b) => new Date(b.date) - new Date(a.date))\n    .slice(0, 7)\n\n  const totalLoads = loads.reduce((sum, l) => sum + l.load_count, 0)\n  const hasLoads = totalLoads > 0\n\n  if (loading) {\n    return (\n      <div className=\"disposal-summary-card\">\n        <div className=\"card-header\">\n          <div className=\"header-left\">\n            <Truck size={18} />\n            <span>Disposal Loads</span>\n          </div>\n        </div>\n        <div className=\"card-loading\">Loading...</div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"disposal-summary-card\">\n      <div className=\"card-header\">\n        <div className=\"header-left\">\n          <Truck size={18} />\n          <span>Disposal Loads</span>\n        </div>\n        <span className=\"period-badge\">\n          {period === 'week' ? 'Last 7 days' : period === 'month' ? 'Last 30 days' : 'Last 14 days'}\n        </span>\n      </div>\n\n      {!hasLoads ? (\n        <div className=\"disposal-empty-state\">\n          <Truck size={32} />\n          <p>No disposal loads recorded</p>\n          <span className=\"text-muted\">Loads will appear here when logged by field crews</span>\n        </div>\n      ) : (\n        <>\n          {/* Total */}\n          <div className=\"disposal-total\">\n            <span className=\"disposal-total-value\">{totalLoads}</span>\n            <span className=\"disposal-total-label\">Total Loads</span>\n          </div>\n\n          {/* By Type Breakdown */}\n          <div className=\"disposal-breakdown\">\n            {LOAD_TYPES.map(type => {\n              const count = loadsByType[type.value] || 0\n              if (count === 0) return null\n              const percentage = Math.round((count / totalLoads) * 100)\n\n              return (\n                <div key={type.value} className=\"disposal-type-row\">\n                  <div className=\"disposal-type-info\">\n                    <span className=\"disposal-type-icon\">{type.icon}</span>\n                    <span className=\"disposal-type-label\">{type.label}</span>\n                  </div>\n                  <div className=\"disposal-type-stats\">\n                    <span className=\"disposal-type-count\">{count}</span>\n                    <div className=\"disposal-type-bar\">\n                      <div\n                        className=\"disposal-type-bar-fill\"\n                        style={{ width: `${percentage}%` }}\n                      />\n                    </div>\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n\n          {/* Daily Breakdown Toggle */}\n          {sortedDates.length > 0 && (\n            <button\n              className=\"disposal-expand-btn\"\n              onClick={() => setExpanded(!expanded)}\n            >\n              {expanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n              <span>{expanded ? 'Hide' : 'View'} Daily Breakdown</span>\n            </button>\n          )}\n\n          {/* Daily Breakdown */}\n          {expanded && sortedDates.length > 0 && (\n            <div className=\"disposal-daily-breakdown\">\n              {sortedDates.map(day => {\n                const formattedDate = new Date(day.date).toLocaleDateString('en-US', {\n                  weekday: 'short',\n                  month: 'short',\n                  day: 'numeric'\n                })\n\n                // Group by type for this day\n                const dayLoadsByType = day.loads.reduce((acc, load) => {\n                  if (!acc[load.load_type]) acc[load.load_type] = 0\n                  acc[load.load_type] += load.load_count\n                  return acc\n                }, {})\n\n                return (\n                  <div key={day.date} className=\"disposal-daily-row\">\n                    <div className=\"disposal-daily-header\">\n                      <span className=\"disposal-daily-date\">{formattedDate}</span>\n                      <span className=\"disposal-daily-total\">{day.total} loads</span>\n                    </div>\n                    <div className=\"disposal-daily-types\">\n                      {Object.entries(dayLoadsByType).map(([type, count]) => {\n                        const typeInfo = getLoadTypeInfo(type)\n                        return (\n                          <span key={type} className=\"disposal-daily-type\">\n                            {typeInfo.icon} {count}\n                          </span>\n                        )\n                      })}\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  )\n}\n","import { useState, useEffect, useCallback, useMemo, memo } from 'react'\nimport { Truck, Plus, Calendar, RotateCcw, ChevronDown, ChevronUp, Edit2, Trash2 } from 'lucide-react'\nimport { equipmentOps } from '../../lib/supabase'\nimport { formatCurrency } from '../../lib/corCalculations'\n\n// Helper function - defined outside component to avoid recreation\nconst formatDate = (dateStr) => {\n  if (!dateStr) return ''\n  return new Date(dateStr).toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric'\n  })\n}\n\n/**\n * ProjectEquipmentCard - Equipment tracking card for Financials Overview\n *\n * Shows equipment currently on site with daily rates and costs.\n * Allows adding new equipment and marking equipment as returned.\n */\nexport default memo(function ProjectEquipmentCard({\n  project,\n  onAddEquipment,\n  onEditEquipment,\n  onShowToast\n}) {\n  const [projectEquipment, setProjectEquipment] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [expanded, setExpanded] = useState(true)\n  const [totalCost, setTotalCost] = useState(0)\n\n  // Memoized load function to avoid stale closures\n  const loadEquipment = useCallback(async () => {\n    if (!project?.id) return\n\n    try {\n      setLoading(true)\n      const data = await equipmentOps.getProjectEquipment(project.id)\n      setProjectEquipment(data || [])\n\n      // Calculate total cost\n      const cost = equipmentOps.calculateProjectEquipmentCost(data || [])\n      setTotalCost(cost)\n    } catch (error) {\n      console.error('Error loading equipment:', error)\n      onShowToast?.('Failed to load equipment', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }, [project?.id]) // onShowToast is stable (memoized in App.jsx)\n\n  // Load project equipment when project changes\n  useEffect(() => {\n    loadEquipment()\n  }, [loadEquipment])\n\n  const handleMarkReturned = useCallback(async (equipmentItem) => {\n    try {\n      await equipmentOps.markEquipmentReturned(equipmentItem.id)\n      onShowToast?.(`${equipmentItem.equipment_name} marked as returned`, 'success')\n      loadEquipment()\n    } catch (error) {\n      console.error('Error marking equipment returned:', error)\n      onShowToast?.('Failed to update equipment', 'error')\n    }\n  }, [loadEquipment]) // onShowToast is stable\n\n  const handleDelete = useCallback(async (equipmentItem) => {\n    if (!confirm(`Remove ${equipmentItem.equipment_name} from this project?`)) {\n      return\n    }\n\n    try {\n      await equipmentOps.removeEquipmentFromProject(equipmentItem.id)\n      onShowToast?.('Equipment removed', 'success')\n      loadEquipment()\n    } catch (error) {\n      console.error('Error removing equipment:', error)\n      onShowToast?.('Failed to remove equipment', 'error')\n    }\n  }, [loadEquipment]) // onShowToast is stable\n\n  // Memoize derived state to avoid recalculating on every render\n  const activeEquipment = useMemo(\n    () => projectEquipment.filter(e => !e.end_date),\n    [projectEquipment]\n  )\n\n  const returnedEquipment = useMemo(\n    () => projectEquipment.filter(e => e.end_date),\n    [projectEquipment]\n  )\n\n  return (\n    <div className=\"project-equipment-card\">\n      <div className=\"project-equipment-header\">\n        <div className=\"project-equipment-title\">\n          <Truck size={18} />\n          <h3>Equipment on Site</h3>\n          {projectEquipment.length > 0 && (\n            <span className=\"equipment-count\">{activeEquipment.length} active</span>\n          )}\n        </div>\n        <div className=\"project-equipment-actions\">\n          <button\n            className=\"btn btn-sm btn-primary\"\n            onClick={() => onAddEquipment?.()}\n            title=\"Add equipment\"\n          >\n            <Plus size={14} />\n            <span>Add</span>\n          </button>\n          {projectEquipment.length > 0 && (\n            <button\n              className=\"btn btn-sm btn-ghost\"\n              onClick={() => setExpanded(!expanded)}\n            >\n              {expanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n            </button>\n          )}\n        </div>\n      </div>\n\n      {loading ? (\n        <div className=\"equipment-loading\">\n          <div className=\"loading-spinner small\" />\n        </div>\n      ) : projectEquipment.length === 0 ? (\n        <div className=\"equipment-empty\">\n          <p>No equipment tracked on this project</p>\n          <button\n            className=\"btn btn-sm btn-outline\"\n            onClick={() => onAddEquipment?.()}\n          >\n            <Plus size={14} />\n            Track Equipment\n          </button>\n        </div>\n      ) : expanded ? (\n        <>\n          {/* Active Equipment */}\n          {activeEquipment.length > 0 && (\n            <div className=\"equipment-list\">\n              {activeEquipment.map(item => {\n                const days = equipmentOps.calculateDaysOnSite(item.start_date, item.end_date)\n                const cost = item.daily_rate * days\n\n                return (\n                  <div key={item.id} className=\"equipment-item active\">\n                    <div className=\"equipment-item-main\">\n                      <div className=\"equipment-item-info\">\n                        <span className=\"equipment-name\">{item.equipment_name}</span>\n                        <span className=\"equipment-meta\">\n                          <Calendar size={12} />\n                          On-site since {formatDate(item.start_date)}\n                        </span>\n                      </div>\n                      <div className=\"equipment-item-cost\">\n                        <span className=\"equipment-rate\">\n                          {formatCurrency(item.daily_rate)}/day\n                        </span>\n                        <span className=\"equipment-days\">{days} days</span>\n                        <span className=\"equipment-total\">{formatCurrency(cost)}</span>\n                      </div>\n                    </div>\n                    <div className=\"equipment-item-actions\">\n                      <button\n                        className=\"btn btn-xs btn-outline\"\n                        onClick={() => handleMarkReturned(item)}\n                        title=\"Mark as returned\"\n                      >\n                        <RotateCcw size={12} />\n                        Returned\n                      </button>\n                      <button\n                        className=\"btn btn-xs btn-ghost\"\n                        onClick={() => onEditEquipment?.(item)}\n                        title=\"Edit\"\n                      >\n                        <Edit2 size={12} />\n                      </button>\n                      <button\n                        className=\"btn btn-xs btn-ghost text-danger\"\n                        onClick={() => handleDelete(item)}\n                        title=\"Remove\"\n                      >\n                        <Trash2 size={12} />\n                      </button>\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          )}\n\n          {/* Returned Equipment (collapsed by default) */}\n          {returnedEquipment.length > 0 && (\n            <details className=\"equipment-returned-section\">\n              <summary className=\"equipment-returned-toggle\">\n                <span>Returned Equipment ({returnedEquipment.length})</span>\n              </summary>\n              <div className=\"equipment-list returned\">\n                {returnedEquipment.map(item => {\n                  const days = equipmentOps.calculateDaysOnSite(item.start_date, item.end_date)\n                  const cost = item.daily_rate * days\n\n                  return (\n                    <div key={item.id} className=\"equipment-item returned\">\n                      <div className=\"equipment-item-main\">\n                        <div className=\"equipment-item-info\">\n                          <span className=\"equipment-name\">{item.equipment_name}</span>\n                          <span className=\"equipment-meta\">\n                            {formatDate(item.start_date)} - {formatDate(item.end_date)}\n                          </span>\n                        </div>\n                        <div className=\"equipment-item-cost\">\n                          <span className=\"equipment-days\">{days} days</span>\n                          <span className=\"equipment-total\">{formatCurrency(cost)}</span>\n                        </div>\n                      </div>\n                    </div>\n                  )\n                })}\n              </div>\n            </details>\n          )}\n\n          {/* Total */}\n          <div className=\"equipment-total-row\">\n            <span>Total Equipment Cost</span>\n            <span className=\"equipment-grand-total\">{formatCurrency(totalCost)}</span>\n          </div>\n        </>\n      ) : (\n        <div className=\"equipment-summary-collapsed\">\n          <span>{activeEquipment.length} active, {returnedEquipment.length} returned</span>\n          <span className=\"equipment-grand-total\">{formatCurrency(totalCost)}</span>\n        </div>\n      )}\n    </div>\n  )\n})\n","import { useState, useEffect, useCallback, useMemo, memo } from 'react'\nimport { FileSpreadsheet, Plus, ChevronRight } from 'lucide-react'\nimport { drawRequestOps } from '../../lib/supabase'\nimport { formatCurrency } from '../../lib/corCalculations'\n\n/**\n * ProgressBillingCard - Summary card for progress billing / draw requests\n *\n * Shows:\n * - Contract summary (original + COs = revised)\n * - Billing progress (billed to date, retention held)\n * - Quick action to create new draw request\n * - Recent draw requests\n */\nexport default memo(function ProgressBillingCard({\n  project,\n  areas = [],\n  corStats = {},\n  onCreateDraw,\n  onViewDraw,\n  onShowToast\n}) {\n  const [drawRequests, setDrawRequests] = useState([])\n  const [loading, setLoading] = useState(true)\n\n  // Calculate contract values\n  const originalContract = useMemo(() => {\n    return areas.reduce((sum, area) => {\n      const value = (area.square_footage || 0) * (area.price_per_sqft || 0)\n      return sum + Math.round(value * 100) // Convert to cents\n    }, 0)\n  }, [areas])\n\n  const approvedCOs = useMemo(() => {\n    return (corStats?.approvedTotal || 0)\n  }, [corStats?.approvedTotal])\n\n  const revisedContract = originalContract + approvedCOs\n\n  // Load draw requests\n  const loadDrawRequests = useCallback(async () => {\n    if (!project?.id) return\n\n    try {\n      setLoading(true)\n      const data = await drawRequestOps.getProjectDrawRequests(project.id)\n      setDrawRequests(data || [])\n    } catch (error) {\n      console.error('Error loading draw requests:', error)\n    } finally {\n      setLoading(false)\n    }\n  }, [project?.id])\n\n  useEffect(() => {\n    loadDrawRequests()\n  }, [loadDrawRequests])\n\n  // Calculate billing totals from draw requests\n  const billingTotals = useMemo(() => {\n    const completedDraws = drawRequests.filter(dr =>\n      ['submitted', 'approved', 'paid'].includes(dr.status)\n    )\n\n    const billedToDate = completedDraws.reduce((sum, dr) =>\n      sum + (dr.previous_billings || 0) + (dr.current_billing || 0), 0\n    )\n\n    // Get the most recent retention amount\n    const latestDraw = completedDraws[0]\n    const retentionHeld = latestDraw?.retention_held || 0\n\n    return { billedToDate, retentionHeld }\n  }, [drawRequests])\n\n  const progress = revisedContract > 0\n    ? Math.round((billingTotals.billedToDate / revisedContract) * 100)\n    : 0\n\n  const nextDrawNumber = drawRequests.length > 0\n    ? Math.max(...drawRequests.map(dr => dr.draw_number)) + 1\n    : 1\n\n  const formatDate = (dateStr) => {\n    if (!dateStr) return ''\n    return new Date(dateStr).toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric'\n    })\n  }\n\n  const getStatusBadge = (status) => {\n    switch (status) {\n      case 'draft':\n        return <span className=\"badge badge-muted\">Draft</span>\n      case 'submitted':\n        return <span className=\"badge badge-warning\">Submitted</span>\n      case 'approved':\n        return <span className=\"badge badge-success\">Approved</span>\n      case 'paid':\n        return <span className=\"badge badge-info\">Paid</span>\n      case 'rejected':\n        return <span className=\"badge badge-danger\">Rejected</span>\n      default:\n        return null\n    }\n  }\n\n  return (\n    <div className=\"progress-billing-card\">\n      <div className=\"progress-billing-header\">\n        <div className=\"progress-billing-title\">\n          <FileSpreadsheet size={18} />\n          <h3>Progress Billing</h3>\n        </div>\n        <button\n          className=\"btn btn-sm btn-primary\"\n          onClick={() => onCreateDraw?.()}\n          disabled={originalContract === 0}\n          title={originalContract === 0 ? 'Add areas with contract values first' : `Create Draw #${nextDrawNumber}`}\n        >\n          <Plus size={14} />\n          <span>Draw #{nextDrawNumber}</span>\n        </button>\n      </div>\n\n      {/* Contract Summary */}\n      <div className=\"progress-billing-contract\">\n        <div className=\"contract-row\">\n          <span className=\"contract-label\">Original Contract</span>\n          <span className=\"contract-value\">{formatCurrency(originalContract)}</span>\n        </div>\n        {approvedCOs > 0 && (\n          <div className=\"contract-row co\">\n            <span className=\"contract-label\">Approved COs</span>\n            <span className=\"contract-value positive\">+{formatCurrency(approvedCOs)}</span>\n          </div>\n        )}\n        <div className=\"contract-row revised\">\n          <span className=\"contract-label\">Revised Contract</span>\n          <span className=\"contract-value\">{formatCurrency(revisedContract)}</span>\n        </div>\n      </div>\n\n      {/* Billing Progress */}\n      <div className=\"progress-billing-status\">\n        <div className=\"billing-progress-bar\">\n          <div\n            className=\"billing-progress-fill\"\n            style={{ width: `${Math.min(progress, 100)}%` }}\n          />\n        </div>\n        <div className=\"billing-stats\">\n          <div className=\"billing-stat\">\n            <span className=\"billing-stat-value\">{formatCurrency(billingTotals.billedToDate)}</span>\n            <span className=\"billing-stat-label\">Billed to Date ({progress}%)</span>\n          </div>\n          {billingTotals.retentionHeld > 0 && (\n            <div className=\"billing-stat retention\">\n              <span className=\"billing-stat-value\">-{formatCurrency(billingTotals.retentionHeld)}</span>\n              <span className=\"billing-stat-label\">Retention Held</span>\n            </div>\n          )}\n          <div className=\"billing-stat remaining\">\n            <span className=\"billing-stat-value\">{formatCurrency(revisedContract - billingTotals.billedToDate)}</span>\n            <span className=\"billing-stat-label\">Balance to Finish</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Recent Draw Requests */}\n      {loading ? (\n        <div className=\"progress-billing-loading\">\n          <div className=\"loading-spinner small\" />\n        </div>\n      ) : drawRequests.length === 0 ? (\n        <div className=\"progress-billing-empty\">\n          <p>No draw requests yet</p>\n          {originalContract > 0 && (\n            <button\n              className=\"btn btn-sm btn-outline\"\n              onClick={() => onCreateDraw?.()}\n            >\n              <Plus size={14} />\n              Create First Draw Request\n            </button>\n          )}\n        </div>\n      ) : (\n        <div className=\"progress-billing-draws\">\n          <div className=\"draws-header\">\n            <span>Recent Draws</span>\n          </div>\n          <div className=\"draws-list\">\n            {drawRequests.slice(0, 3).map(dr => (\n              <button\n                key={dr.id}\n                className=\"draw-item\"\n                onClick={() => onViewDraw?.(dr)}\n              >\n                <div className=\"draw-item-info\">\n                  <span className=\"draw-number\">Draw #{dr.draw_number}</span>\n                  <span className=\"draw-date\">{formatDate(dr.period_end || dr.created_at)}</span>\n                </div>\n                <div className=\"draw-item-amount\">\n                  {formatCurrency(dr.current_billing || 0)}\n                </div>\n                {getStatusBadge(dr.status)}\n                <ChevronRight size={16} className=\"draw-item-arrow\" />\n              </button>\n            ))}\n          </div>\n          {drawRequests.length > 3 && (\n            <button className=\"btn btn-sm btn-ghost view-all-draws\">\n              View all {drawRequests.length} draws\n            </button>\n          )}\n        </div>\n      )}\n    </div>\n  )\n})\n","import { useState, useEffect } from 'react'\nimport { HardHat } from 'lucide-react'\nimport { db } from '../lib/supabase'\n\nexport default function ManDayCosts({ project, company, onShowToast }) {\n  const [costData, setCostData] = useState(null)\n  const [loading, setLoading] = useState(true)\n  const [expanded, setExpanded] = useState(false)\n\n  useEffect(() => {\n    if (project?.id && company?.id) {\n      loadCostData()\n\n      // Subscribe to crew check-in updates for real-time cost updates\n      const subscription = db.subscribeToCrewCheckins?.(project.id, () => {\n        loadCostData()\n      })\n\n      return () => {\n        if (subscription) db.unsubscribe?.(subscription)\n      }\n    }\n  }, [project?.id, company?.id])\n\n  const loadCostData = async () => {\n    try {\n      const data = await db.calculateManDayCosts(\n        project.id,\n        company.id,\n        project.work_type || 'demolition',\n        project.job_type || 'standard'\n      )\n      setCostData(data)\n    } catch (error) {\n      console.error('Error loading man day costs:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const formatCurrency = (amount) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0\n    }).format(amount)\n  }\n\n  const formatDate = (dateStr) => {\n    return new Date(dateStr).toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric'\n    })\n  }\n\n  const getRoleLabel = (role) => {\n    const labels = {\n      foreman: 'Foreman',\n      supervisor: 'Supervisor',\n      operator: 'Operator',\n      laborer: 'Laborer'\n    }\n    return labels[role] || role.charAt(0).toUpperCase() + role.slice(1)\n  }\n\n  if (loading) {\n    return (\n      <div className=\"man-day-costs card\">\n        <div className=\"man-day-header\">\n          <h3>Man Day Costs</h3>\n        </div>\n        <div className=\"loading\">Loading...</div>\n      </div>\n    )\n  }\n\n  if (!costData || costData.totalManDays === 0) {\n    return (\n      <div className=\"man-day-costs card\">\n        <div className=\"man-day-header\">\n          <h3>Man Day Costs</h3>\n        </div>\n        <div className=\"man-day-empty\">\n          <span className=\"empty-icon\"><HardHat size={32} /></span>\n          <p>No crew check-ins yet</p>\n          <small>Costs will appear as crew checks in from the field</small>\n        </div>\n      </div>\n    )\n  }\n\n  const roleEntries = Object.entries(costData.byRole || {})\n\n  return (\n    <div className=\"man-day-costs card\">\n      <div className=\"man-day-header\" onClick={() => setExpanded(!expanded)}>\n        <div className=\"man-day-title-row\">\n          <h3>Man Day Costs</h3>\n          <span className=\"man-day-total\">{formatCurrency(costData.totalCost)}</span>\n        </div>\n        <button className=\"man-day-toggle\">\n          {expanded ? ' Collapse' : ' Details'}\n        </button>\n      </div>\n\n      {/* Summary Stats */}\n      <div className=\"man-day-summary\">\n        <div className=\"man-day-stat\">\n          <span className=\"stat-value\">{costData.daysWorked}</span>\n          <span className=\"stat-label\">Days Worked</span>\n        </div>\n        <div className=\"man-day-stat\">\n          <span className=\"stat-value\">{costData.totalManDays}</span>\n          <span className=\"stat-label\">Total Man Days</span>\n        </div>\n        <div className=\"man-day-stat\">\n          <span className=\"stat-value\">{formatCurrency(costData.totalCost)}</span>\n          <span className=\"stat-label\">Total Labor Cost</span>\n        </div>\n        <div className=\"man-day-stat\">\n          <span className=\"stat-value\">\n            {costData.daysWorked > 0\n              ? formatCurrency(costData.totalCost / costData.daysWorked)\n              : '$0'\n            }\n          </span>\n          <span className=\"stat-label\">Avg Cost/Day</span>\n        </div>\n      </div>\n\n      {/* Expanded Details */}\n      {expanded && (\n        <div className=\"man-day-details\">\n          {/* By Role Breakdown */}\n          {roleEntries.length > 0 && (\n            <div className=\"man-day-section\">\n              <h4>By Role</h4>\n              <div className=\"man-day-role-list\">\n                {roleEntries.map(([role, data]) => (\n                  <div key={role} className=\"man-day-role-row\">\n                    <div className=\"role-info\">\n                      <span className=\"role-name\">{getRoleLabel(role)}</span>\n                      <span className=\"role-rate\">{formatCurrency(data.rate)}/day</span>\n                    </div>\n                    <div className=\"role-stats\">\n                      <span className=\"role-count\">{data.count} days</span>\n                      <span className=\"role-cost\">{formatCurrency(data.cost)}</span>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Recent Days */}\n          {costData.byDate?.length > 0 && (\n            <div className=\"man-day-section\">\n              <h4>Recent Activity</h4>\n              <div className=\"man-day-date-list\">\n                {costData.byDate.slice(0, 7).map((day, idx) => (\n                  <div key={idx} className=\"man-day-date-row\">\n                    <span className=\"date-label\">{formatDate(day.date)}</span>\n                    <span className=\"date-workers\">{day.workers} crew</span>\n                    <span className=\"date-cost\">{formatCurrency(day.cost)}</span>\n                  </div>\n                ))}\n              </div>\n              {costData.byDate.length > 7 && (\n                <p className=\"man-day-more\">\n                  + {costData.byDate.length - 7} more days\n                </p>\n              )}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n","import { useState } from 'react'\nimport { TrendingUp, TrendingDown, Minus, ChevronDown, ChevronUp, Flame } from 'lucide-react'\n\n// Helper to format currency\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount || 0)\n}\n\n// Helper to format date\nconst formatDate = (dateStr) => {\n  return new Date(dateStr).toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric'\n  })\n}\n\nexport default function BurnRateCard({\n  dailyBurn,\n  totalBurn,\n  daysWorked,\n  laborCost,\n  materialsEquipmentCost = 0,\n  disposalCost = 0,\n  customCostTotal = 0,\n  progress,\n  contractValue,\n  laborByDate = [],\n  materialsEquipmentByDate = []\n}) {\n  const [expanded, setExpanded] = useState(false)\n\n  // Calculate burn status relative to progress\n  const expectedBurnAtProgress = contractValue * (progress / 100) * 0.6 // Assume 60% cost ratio as healthy\n  const burnStatus = totalBurn <= expectedBurnAtProgress ? 'on-budget' : totalBurn <= expectedBurnAtProgress * 1.2 ? 'warning' : 'over-budget'\n\n  const statusLabel = {\n    'on-budget': 'On Budget',\n    'warning': 'Watch Closely',\n    'over-budget': 'Over Budget'\n  }[burnStatus]\n\n  const StatusIcon = burnStatus === 'on-budget' ? TrendingDown : burnStatus === 'warning' ? Minus : TrendingUp\n\n  // Calculate projected total cost at completion\n  const burnPerProgress = progress > 0 ? totalBurn / (progress / 100) : 0\n  const projectedTotalCost = burnPerProgress\n\n  // Merge labor and materials/equipment by date for combined view\n  const combinedByDate = []\n  const dateMap = {}\n\n  laborByDate.forEach(day => {\n    if (!dateMap[day.date]) {\n      dateMap[day.date] = { date: day.date, labor: 0, materialsEquipment: 0, total: 0 }\n    }\n    dateMap[day.date].labor = day.cost || 0\n    dateMap[day.date].total += day.cost || 0\n  })\n\n  materialsEquipmentByDate.forEach(day => {\n    if (!dateMap[day.date]) {\n      dateMap[day.date] = { date: day.date, labor: 0, materialsEquipment: 0, total: 0 }\n    }\n    dateMap[day.date].materialsEquipment = day.cost || 0\n    dateMap[day.date].total += day.cost || 0\n  })\n\n  Object.values(dateMap)\n    .sort((a, b) => new Date(b.date) - new Date(a.date))\n    .slice(0, 10)\n    .forEach(d => combinedByDate.push(d))\n\n  // Max daily cost for bar sizing\n  const maxDailyCost = Math.max(...combinedByDate.map(d => d.total), 1)\n\n  return (\n    <div className=\"burn-rate-card\">\n      <div className=\"burn-rate-header\">\n        <div className=\"burn-rate-title\">\n          <Flame size={18} className=\"burn-icon\" />\n          <h3>Burn Rate</h3>\n        </div>\n        <div className={`burn-status ${burnStatus}`}>\n          <StatusIcon size={14} />\n          <span>{statusLabel}</span>\n        </div>\n      </div>\n\n      <div className=\"burn-rate-hero\">\n        <div className=\"burn-rate-main\">\n          <span className=\"burn-rate-value\">{formatCurrency(dailyBurn)}</span>\n          <span className=\"burn-rate-unit\">/day</span>\n        </div>\n        {daysWorked > 0 && (\n          <div className=\"burn-rate-context\">\n            Based on {daysWorked} work day{daysWorked !== 1 ? 's' : ''}\n          </div>\n        )}\n      </div>\n\n      <div className=\"burn-rate-summary\">\n        <div className=\"burn-summary-item\">\n          <span className=\"burn-summary-label\">Total Spent</span>\n          <span className=\"burn-summary-value\">{formatCurrency(totalBurn)}</span>\n        </div>\n        <div className=\"burn-summary-divider\"></div>\n        <div className=\"burn-summary-item\">\n          <span className=\"burn-summary-label\">Labor</span>\n          <span className=\"burn-summary-value\">{formatCurrency(laborCost)}</span>\n        </div>\n        {disposalCost > 0 && (\n          <>\n            <div className=\"burn-summary-divider\"></div>\n            <div className=\"burn-summary-item\">\n              <span className=\"burn-summary-label\">Disposal</span>\n              <span className=\"burn-summary-value\">{formatCurrency(disposalCost)}</span>\n            </div>\n          </>\n        )}\n        {materialsEquipmentCost > 0 && (\n          <>\n            <div className=\"burn-summary-divider\"></div>\n            <div className=\"burn-summary-item\">\n              <span className=\"burn-summary-label\">Materials & Equip</span>\n              <span className=\"burn-summary-value\">{formatCurrency(materialsEquipmentCost)}</span>\n            </div>\n          </>\n        )}\n        {customCostTotal > 0 && (\n          <>\n            <div className=\"burn-summary-divider\"></div>\n            <div className=\"burn-summary-item\">\n              <span className=\"burn-summary-label\">Other</span>\n              <span className=\"burn-summary-value\">{formatCurrency(customCostTotal)}</span>\n            </div>\n          </>\n        )}\n      </div>\n\n      {progress > 0 && (\n        <div className=\"burn-projection\">\n          <span className=\"projection-label\">Projected at completion:</span>\n          <span className={`projection-value ${projectedTotalCost > contractValue * 0.7 ? 'warning' : ''}`}>\n            {formatCurrency(projectedTotalCost)}\n          </span>\n        </div>\n      )}\n\n      {combinedByDate.length > 0 && (\n        <button\n          className=\"burn-rate-expand\"\n          onClick={() => setExpanded(!expanded)}\n        >\n          {expanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n          <span>{expanded ? 'Hide' : 'View'} Daily Breakdown</span>\n        </button>\n      )}\n\n      {expanded && combinedByDate.length > 0 && (\n        <div className=\"burn-rate-details\">\n          <div className=\"burn-details-header\">\n            <span>Date</span>\n            <span>Labor</span>\n            <span>Materials</span>\n            <span>Total</span>\n          </div>\n          {combinedByDate.map(day => (\n            <div key={day.date} className=\"burn-details-row\">\n              <span className=\"burn-date\">{formatDate(day.date)}</span>\n              <span className=\"burn-labor\">{day.labor > 0 ? formatCurrency(day.labor) : '-'}</span>\n              <span className=\"burn-materials\">{day.materialsEquipment > 0 ? formatCurrency(day.materialsEquipment) : '-'}</span>\n              <span className=\"burn-total\">\n                <span className=\"burn-bar\" style={{ width: `${(day.total / maxDailyCost) * 100}%` }}></span>\n                <span className=\"burn-amount\">{formatCurrency(day.total)}</span>\n              </span>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}\n","import { useState, useEffect, useMemo, useCallback } from 'react'\nimport { ClipboardList, ChevronDown, ChevronRight, Calendar } from 'lucide-react'\nimport { db } from '../lib/supabase'\nimport { useBranding } from '../lib/BrandingContext'\nimport { hexToRgb, loadImageAsBase64 } from '../lib/imageUtils'\nimport { ErrorState, EmptyState } from './ui'\n// Dynamic import for jsPDF (loaded on-demand to reduce initial bundle)\nconst loadJsPDF = () => import('jspdf')\n\nexport default function DailyReportsList({ project, company, onShowToast }) {\n  const { branding } = useBranding()\n  const [reports, setReports] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState(null)\n  const [expandedReport, setExpandedReport] = useState(null)\n\n  // Multi-select state\n  const [selectedReports, setSelectedReports] = useState(new Set())\n  const [selectMode, setSelectMode] = useState(false)\n\n  // View mode state\n  const [viewMode, setViewMode] = useState('recent') // 'recent' | 'all'\n  const [expandedMonths, setExpandedMonths] = useState(new Set())\n\n  // Date filter state\n  const [dateFilter, setDateFilter] = useState({ start: '', end: '' })\n\n  useEffect(() => {\n    loadReports()\n\n    // Subscribe to realtime updates\n    const subscription = db.subscribeToDailyReports?.(project.id, () => {\n      loadReports()\n    })\n\n    return () => {\n      if (subscription) db.unsubscribe?.(subscription)\n    }\n  }, [project.id])\n\n  const loadReports = useCallback(async () => {\n    try {\n      setError(null)\n      // Load more reports to support month grouping\n      const data = await db.getDailyReports(project.id, 365)\n      setReports(data || [])\n    } catch (err) {\n      console.error('Error loading daily reports:', err)\n      setError(err)\n      onShowToast?.('Error loading daily reports', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }, [project.id]) // onShowToast is stable (memoized in App.jsx)\n\n  // Filter reports based on view mode and date filter\n  const filteredReports = useMemo(() => {\n    let filtered = [...reports]\n\n    // Apply date filter if set\n    if (dateFilter.start) {\n      const startDate = new Date(dateFilter.start)\n      startDate.setHours(0, 0, 0, 0)\n      filtered = filtered.filter(r => {\n        const reportDate = new Date(r.report_date || r.created_at)\n        return reportDate >= startDate\n      })\n    }\n    if (dateFilter.end) {\n      const endDate = new Date(dateFilter.end)\n      endDate.setHours(23, 59, 59, 999)\n      filtered = filtered.filter(r => {\n        const reportDate = new Date(r.report_date || r.created_at)\n        return reportDate <= endDate\n      })\n    }\n\n    // In recent mode, show only last 7 days\n    if (viewMode === 'recent') {\n      const sevenDaysAgo = new Date()\n      sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7)\n      sevenDaysAgo.setHours(0, 0, 0, 0)\n      filtered = filtered.filter(r => {\n        const reportDate = new Date(r.report_date || r.created_at)\n        return reportDate >= sevenDaysAgo\n      })\n    }\n\n    return filtered\n  }, [reports, viewMode, dateFilter])\n\n  // Group reports by month for 'all' view\n  const reportsByMonth = useMemo(() => {\n    if (viewMode !== 'all') return null\n\n    const groups = {}\n    filteredReports.forEach(report => {\n      const date = new Date(report.report_date || report.created_at)\n      const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`\n      const monthLabel = date.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })\n\n      if (!groups[monthKey]) {\n        groups[monthKey] = { label: monthLabel, reports: [] }\n      }\n      groups[monthKey].reports.push(report)\n    })\n\n    // Sort by month (newest first)\n    return Object.entries(groups).sort((a, b) => b[0].localeCompare(a[0]))\n  }, [filteredReports, viewMode])\n\n  // Auto-expand current month\n  useEffect(() => {\n    if (reportsByMonth && reportsByMonth.length > 0) {\n      const currentMonthKey = reportsByMonth[0][0]\n      setExpandedMonths(new Set([currentMonthKey]))\n    }\n  }, [reportsByMonth])\n\n  // Selection handlers\n  const toggleSelectMode = () => {\n    setSelectMode(!selectMode)\n    if (selectMode) {\n      setSelectedReports(new Set())\n    }\n  }\n\n  const toggleReportSelection = (reportId) => {\n    const newSelection = new Set(selectedReports)\n    if (newSelection.has(reportId)) {\n      newSelection.delete(reportId)\n    } else {\n      newSelection.add(reportId)\n    }\n    setSelectedReports(newSelection)\n  }\n\n  const toggleSelectAll = () => {\n    if (selectedReports.size === filteredReports.length) {\n      setSelectedReports(new Set())\n    } else {\n      setSelectedReports(new Set(filteredReports.map(r => r.id)))\n    }\n  }\n\n  const toggleMonthExpand = (monthKey) => {\n    const newExpanded = new Set(expandedMonths)\n    if (newExpanded.has(monthKey)) {\n      newExpanded.delete(monthKey)\n    } else {\n      newExpanded.add(monthKey)\n    }\n    setExpandedMonths(newExpanded)\n  }\n\n  // Get reports for export (selected or all filtered)\n  const getExportReports = () => {\n    if (selectedReports.size > 0) {\n      return filteredReports.filter(r => selectedReports.has(r.id))\n    }\n    return filteredReports\n  }\n\n  const formatDate = (dateStr) => {\n    const date = new Date(dateStr)\n    return date.toLocaleDateString('en-US', {\n      weekday: 'short',\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric'\n    })\n  }\n\n  const formatTime = (dateStr) => {\n    return new Date(dateStr).toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit'\n    })\n  }\n\n  const getStatusIcon = (status) => {\n    switch (status) {\n      case 'submitted': return ''\n      case 'reviewed': return ''\n      case 'draft': return ''\n      default: return ''\n    }\n  }\n\n  const getStatusLabel = (status) => {\n    switch (status) {\n      case 'submitted': return 'Submitted'\n      case 'reviewed': return 'Reviewed'\n      case 'draft': return 'Draft'\n      default: return status\n    }\n  }\n\n  // Export to PDF with company branding\n  const exportToPDF = async () => {\n    const exportReports = getExportReports()\n    if (exportReports.length === 0) {\n      onShowToast?.('No reports to export', 'error')\n      return\n    }\n\n    onShowToast?.('Generating PDF...', 'info')\n\n    // Dynamic import - only loads jsPDF when user actually exports\n    const jsPDFModule = await loadJsPDF()\n    const jsPDF = jsPDFModule.default\n\n    const doc = new jsPDF()\n    const pageWidth = doc.internal.pageSize.getWidth()\n    const margin = 20\n    let yPos = margin\n\n    const primaryColor = hexToRgb(branding?.primary_color || '#3B82F6')\n    const secondaryColor = hexToRgb(branding?.secondary_color || '#1E40AF')\n\n    // Header with branding\n    doc.setFillColor(...primaryColor)\n    doc.rect(0, 0, pageWidth, 45, 'F')\n    doc.setFillColor(...secondaryColor)\n    doc.rect(0, 42, pageWidth, 3, 'F')\n\n    // Add logo if available\n    let logoOffset = margin\n    if (branding?.logo_url) {\n      try {\n        const logoBase64 = await loadImageAsBase64(branding.logo_url)\n        if (logoBase64) {\n          doc.addImage(logoBase64, 'PNG', margin, 7, 30, 30)\n          logoOffset = margin + 40\n        }\n      } catch (e) {\n        console.error('Error adding logo:', e)\n      }\n    }\n\n    doc.setTextColor(255, 255, 255)\n    doc.setFontSize(22)\n    doc.setFont('helvetica', 'bold')\n    doc.text(company?.name || 'Company Name', logoOffset, 20)\n    doc.setFontSize(10)\n    doc.setFont('helvetica', 'normal')\n    doc.text('DAILY REPORTS SUMMARY', logoOffset, 30)\n\n    doc.setFontSize(9)\n    doc.text(`Generated: ${new Date().toLocaleDateString()}`, pageWidth - margin, 20, { align: 'right' })\n    if (project.job_number) {\n      doc.text(`Job #: ${project.job_number}`, pageWidth - margin, 28, { align: 'right' })\n    }\n\n    yPos = 55\n\n    // Project info\n    doc.setFillColor(248, 250, 252)\n    doc.rect(margin, yPos - 5, pageWidth - margin * 2, 20, 'F')\n    doc.setTextColor(...primaryColor)\n    doc.setFontSize(14)\n    doc.setFont('helvetica', 'bold')\n    doc.text(`Project: ${project.name}`, margin + 5, yPos + 7)\n    doc.setFontSize(10)\n    doc.setTextColor(100, 100, 100)\n    doc.text(`${exportReports.length} Report${exportReports.length !== 1 ? 's' : ''}`, pageWidth - margin - 5, yPos + 7, { align: 'right' })\n\n    yPos += 25\n\n    // Reports\n    exportReports.forEach((report, index) => {\n      // Check if we need a new page\n      if (yPos > 250) {\n        doc.addPage()\n        yPos = margin\n      }\n\n      // Report header\n      doc.setFillColor(...primaryColor)\n      doc.setTextColor(255, 255, 255)\n      doc.rect(margin, yPos, pageWidth - margin * 2, 10, 'F')\n      doc.setFontSize(11)\n      doc.setFont('helvetica', 'bold')\n      doc.text(formatDate(report.report_date || report.created_at), margin + 5, yPos + 7)\n      doc.text(getStatusLabel(report.status), pageWidth - margin - 5, yPos + 7, { align: 'right' })\n      yPos += 15\n\n      // Stats row\n      doc.setTextColor(50, 50, 50)\n      doc.setFontSize(10)\n      doc.setFont('helvetica', 'normal')\n      const stats = `Crew: ${report.crew_count || 0}  |  Tasks: ${report.tasks_completed || 0}  |  Time & Material: ${report.tm_tickets_count || 0}  |  Photos: ${report.photos_count || 0}`\n      doc.text(stats, margin + 5, yPos)\n      yPos += 8\n\n      // Crew list\n      if (report.crew_list?.length > 0) {\n        doc.setFont('helvetica', 'bold')\n        doc.text('Crew:', margin + 5, yPos)\n        doc.setFont('helvetica', 'normal')\n        const crewNames = report.crew_list.map(w => `${w.name} (${w.role})`).join(', ')\n        const crewLines = doc.splitTextToSize(crewNames, pageWidth - margin * 2 - 30)\n        doc.text(crewLines, margin + 25, yPos)\n        yPos += crewLines.length * 5 + 3\n      }\n\n      // Field notes\n      if (report.field_notes) {\n        doc.setFont('helvetica', 'bold')\n        doc.text('Notes:', margin + 5, yPos)\n        doc.setFont('helvetica', 'normal')\n        const noteLines = doc.splitTextToSize(report.field_notes, pageWidth - margin * 2 - 30)\n        doc.text(noteLines, margin + 25, yPos)\n        yPos += noteLines.length * 5 + 3\n      }\n\n      // Issues\n      if (report.issues) {\n        doc.setTextColor(180, 50, 50)\n        doc.setFont('helvetica', 'bold')\n        doc.text('Issues:', margin + 5, yPos)\n        doc.setFont('helvetica', 'normal')\n        const issueLines = doc.splitTextToSize(report.issues, pageWidth - margin * 2 - 30)\n        doc.text(issueLines, margin + 25, yPos)\n        doc.setTextColor(50, 50, 50)\n        yPos += issueLines.length * 5 + 3\n      }\n\n      yPos += 10\n    })\n\n    // Footer\n    const pageCount = doc.internal.getNumberOfPages()\n    for (let i = 1; i <= pageCount; i++) {\n      doc.setPage(i)\n      doc.setFontSize(8)\n      doc.setTextColor(150, 150, 150)\n      doc.text(`Page ${i} of ${pageCount}`, pageWidth / 2, doc.internal.pageSize.getHeight() - 10, { align: 'center' })\n    }\n\n    const fileName = `${project.name}_Daily_Reports_${new Date().toISOString().split('T')[0]}.pdf`\n    doc.save(fileName)\n    onShowToast?.('PDF exported!', 'success')\n  }\n\n  // Render a single report card\n  const renderReportCard = (report) => (\n    <div\n      key={report.id}\n      className={`daily-report-card ${report.status} ${selectedReports.has(report.id) ? 'selected' : ''}`}\n    >\n      <div\n        className=\"daily-report-header-row\"\n        onClick={() => setExpandedReport(expandedReport === report.id ? null : report.id)}\n      >\n        {selectMode && (\n          <input\n            type=\"checkbox\"\n            className=\"report-checkbox\"\n            checked={selectedReports.has(report.id)}\n            onChange={(e) => {\n              e.stopPropagation()\n              toggleReportSelection(report.id)\n            }}\n            onClick={(e) => e.stopPropagation()}\n          />\n        )}\n        <div className=\"daily-report-info\">\n          <span className=\"report-date\">{formatDate(report.report_date || report.created_at)}</span>\n          <span className={`report-status ${report.status}`}>\n            {getStatusIcon(report.status)} {getStatusLabel(report.status)}\n          </span>\n        </div>\n        <div className=\"daily-report-summary\">\n          <span className=\"report-crew\">{report.crew_count || 0} crew</span>\n          <span className=\"report-tasks\">{report.tasks_completed || 0} tasks</span>\n          <span className=\"report-expand\">{expandedReport === report.id ? '' : ''}</span>\n        </div>\n      </div>\n\n      {expandedReport === report.id && (\n        <div className=\"daily-report-details\">\n          {/* Summary Stats */}\n          <div className=\"report-stats-grid\">\n            <div className=\"report-stat\">\n              <span className=\"stat-value\">{report.crew_count || 0}</span>\n              <span className=\"stat-label\">Crew on Site</span>\n            </div>\n            <div className=\"report-stat\">\n              <span className=\"stat-value\">{report.tasks_completed || 0}</span>\n              <span className=\"stat-label\">Tasks Done</span>\n            </div>\n            <div className=\"report-stat\">\n              <span className=\"stat-value\">{report.tm_tickets_count || 0}</span>\n              <span className=\"stat-label\">Time & Material</span>\n            </div>\n            <div className=\"report-stat\">\n              <span className=\"stat-value\">{report.photos_count || 0}</span>\n              <span className=\"stat-label\">Photos</span>\n            </div>\n          </div>\n\n          {/* Crew List */}\n          {report.crew_list?.length > 0 && (\n            <div className=\"report-section\">\n              <h4>Crew</h4>\n              <div className=\"report-crew-list\">\n                {report.crew_list.map((worker, i) => (\n                  <div key={i} className=\"crew-member\">\n                    <span className=\"crew-name\">{worker.name}</span>\n                    <span className=\"crew-role\">{worker.role}</span>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Completed Tasks */}\n          {report.completed_tasks?.length > 0 && (\n            <div className=\"report-section\">\n              <h4>Completed Today</h4>\n              <ul className=\"report-tasks-list\">\n                {report.completed_tasks.map((task, i) => (\n                  <li key={i}>\n                    {task.name}\n                    {task.group && <span className=\"task-group\">{task.group}</span>}\n                  </li>\n                ))}\n              </ul>\n            </div>\n          )}\n\n          {/* Field Notes */}\n          {report.field_notes && (\n            <div className=\"report-section\">\n              <h4>Field Notes</h4>\n              <p className=\"report-notes\">{report.field_notes}</p>\n            </div>\n          )}\n\n          {/* Issues */}\n          {report.issues && (\n            <div className=\"report-section issues\">\n              <h4>Issues / Concerns</h4>\n              <p className=\"report-issues\">{report.issues}</p>\n            </div>\n          )}\n\n          {/* Submitted Info */}\n          {report.submitted_at && (\n            <div className=\"report-meta\">\n              <span>Submitted by {report.submitted_by || 'Field'} at {formatTime(report.submitted_at)}</span>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n\n  if (loading) {\n    return <div className=\"loading\">Loading daily reports...</div>\n  }\n\n  if (error) {\n    return (\n      <div className=\"daily-reports-list card\">\n        <ErrorState\n          title=\"Unable to load reports\"\n          message=\"There was a problem loading daily reports. Please try again.\"\n          error={error}\n          onRetry={loadReports}\n        />\n      </div>\n    )\n  }\n\n  const totalReports = reports.length\n  const recentCount = filteredReports.length\n\n  return (\n    <div className=\"daily-reports-list card\">\n      {/* Header */}\n      <div className=\"daily-reports-header\">\n        <h3>Daily Reports</h3>\n        <div className=\"daily-reports-actions\">\n          {reports.length > 0 && (\n            <>\n              <button\n                className={`btn btn-small ${selectMode ? 'btn-primary' : 'btn-secondary'}`}\n                onClick={toggleSelectMode}\n              >\n                {selectMode ? 'Cancel' : 'Select'}\n              </button>\n              <button className=\"btn btn-secondary btn-small\" onClick={exportToPDF}>\n                PDF{selectedReports.size > 0 ? ` (${selectedReports.size})` : ''}\n              </button>\n            </>\n          )}\n        </div>\n      </div>\n\n      {/* View Mode Toggle */}\n      {reports.length > 0 && (\n        <div className=\"view-mode-bar\">\n          <div className=\"view-mode-tabs\">\n            <button\n              className={`view-mode-tab ${viewMode === 'recent' ? 'active' : ''}`}\n              onClick={() => setViewMode('recent')}\n            >\n              Recent (7 days)\n            </button>\n            <button\n              className={`view-mode-tab ${viewMode === 'all' ? 'active' : ''}`}\n              onClick={() => setViewMode('all')}\n            >\n              All ({totalReports})\n            </button>\n          </div>\n\n          {/* Date Filter (only in 'all' mode) */}\n          {viewMode === 'all' && (\n            <div className=\"date-filter\">\n              <Calendar size={14} className=\"date-filter-icon\" />\n              <input\n                type=\"date\"\n                value={dateFilter.start}\n                onChange={(e) => setDateFilter(prev => ({ ...prev, start: e.target.value }))}\n                className=\"date-input\"\n              />\n              <span className=\"date-separator\">to</span>\n              <input\n                type=\"date\"\n                value={dateFilter.end}\n                onChange={(e) => setDateFilter(prev => ({ ...prev, end: e.target.value }))}\n                className=\"date-input\"\n              />\n              {(dateFilter.start || dateFilter.end) && (\n                <button\n                  className=\"date-clear\"\n                  onClick={() => setDateFilter({ start: '', end: '' })}\n                >\n                  Clear\n                </button>\n              )}\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Select All (when in select mode) */}\n      {selectMode && filteredReports.length > 0 && (\n        <div className=\"select-all-bar\">\n          <label className=\"select-all-label\">\n            <input\n              type=\"checkbox\"\n              checked={selectedReports.size === filteredReports.length && filteredReports.length > 0}\n              onChange={toggleSelectAll}\n            />\n            Select All ({filteredReports.length})\n          </label>\n          {selectedReports.size > 0 && (\n            <span className=\"selected-count\">{selectedReports.size} selected</span>\n          )}\n        </div>\n      )}\n\n      {/* Reports List */}\n      {reports.length === 0 ? (\n        <EmptyState\n          icon={ClipboardList}\n          title=\"No daily reports yet\"\n          message=\"Reports from the field will appear here\"\n        />\n      ) : filteredReports.length === 0 ? (\n        <EmptyState\n          icon={ClipboardList}\n          title=\"No reports in this time period\"\n          message={viewMode === 'recent' ? 'No reports in the last 7 days' : 'Try adjusting your date filter'}\n        />\n      ) : viewMode === 'recent' ? (\n        // Recent view - flat list\n        <div className=\"daily-reports\">\n          {filteredReports.map(report => renderReportCard(report))}\n          {totalReports > recentCount && (\n            <div className=\"view-all-prompt\">\n              <button\n                className=\"btn btn-secondary\"\n                onClick={() => setViewMode('all')}\n              >\n                View All {totalReports} Reports\n              </button>\n            </div>\n          )}\n        </div>\n      ) : (\n        // All view - grouped by month\n        <div className=\"daily-reports grouped\">\n          {reportsByMonth?.map(([monthKey, { label, reports: monthReports }]) => (\n            <div key={monthKey} className=\"month-group\">\n              <div\n                className=\"month-header\"\n                onClick={() => toggleMonthExpand(monthKey)}\n              >\n                {expandedMonths.has(monthKey) ? (\n                  <ChevronDown size={18} className=\"month-chevron\" />\n                ) : (\n                  <ChevronRight size={18} className=\"month-chevron\" />\n                )}\n                <span className=\"month-label\">{label}</span>\n                <span className=\"month-count\">{monthReports.length} report{monthReports.length !== 1 ? 's' : ''}</span>\n              </div>\n              {expandedMonths.has(monthKey) && (\n                <div className=\"month-reports\">\n                  {monthReports.map(report => renderReportCard(report))}\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}\n","import { memo } from 'react'\n\n/**\n * Memoized Injury Report Card component\n * Prevents unnecessary re-renders when parent list updates\n */\nconst InjuryReportCard = memo(function InjuryReportCard({\n  report,\n  formatDate,\n  formatTime,\n  getInjuryTypeColor,\n  getInjuryTypeLabel,\n  getStatusColor,\n  onViewDetails\n}) {\n  const handleClick = () => onViewDetails(report)\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Enter' || e.key === ' ') {\n      e.preventDefault()\n      onViewDetails(report)\n    }\n  }\n\n  return (\n    <div\n      className=\"report-card\"\n      onClick={handleClick}\n      onKeyDown={handleKeyDown}\n      role=\"button\"\n      tabIndex={0}\n      aria-label={`Injury report for ${report.employee_name} on ${formatDate(report.incident_date)}`}\n    >\n      <div className=\"report-header\">\n        <div>\n          <div className=\"report-date\">\n            {formatDate(report.incident_date)} at {formatTime(report.incident_time)}\n          </div>\n          <div className=\"employee-name\">{report.employee_name}</div>\n        </div>\n        <div className=\"report-badges\">\n          <span\n            className=\"badge\"\n            style={{ backgroundColor: getInjuryTypeColor(report.injury_type) }}\n          >\n            {getInjuryTypeLabel(report.injury_type)}\n          </span>\n          <span\n            className=\"badge\"\n            style={{ backgroundColor: getStatusColor(report.status) }}\n          >\n            {report.status.replace('_', ' ')}\n          </span>\n        </div>\n      </div>\n\n      <div className=\"report-summary\">\n        <div className=\"summary-item\">\n          <strong>Location:</strong> {report.incident_location}\n        </div>\n        <div className=\"summary-item\">\n          <strong>Reported by:</strong> {report.reported_by_name} ({report.reported_by_title})\n        </div>\n        {report.body_part_affected && (\n          <div className=\"summary-item\">\n            <strong>Body Part:</strong> {report.body_part_affected}\n          </div>\n        )}\n        {report.osha_recordable && (\n          <div className=\"summary-item\">\n            <span className=\"osha-badge\">OSHA Recordable</span>\n          </div>\n        )}\n      </div>\n\n      <div className=\"report-description\">\n        {report.incident_description.substring(0, 150)}\n        {report.incident_description.length > 150 && '...'}\n      </div>\n\n      <div className=\"report-footer\">\n        <span>Click to view full details</span>\n      </div>\n    </div>\n  )\n})\n\nexport default InjuryReportCard\n","import { useState, useEffect, useMemo, useCallback } from 'react'\nimport { ChevronDown, ChevronRight, Calendar } from 'lucide-react'\nimport { db } from '../lib/supabase'\nimport { useBranding } from '../lib/BrandingContext'\nimport { hexToRgb, loadImageAsBase64 } from '../lib/imageUtils'\nimport { ErrorState } from './ui'\nimport InjuryReportForm from './InjuryReportForm'\nimport InjuryReportCard from './InjuryReportCard'\nimport Toast from './Toast'\n// Dynamic import for jsPDF (loaded on-demand to reduce initial bundle)\nconst loadJsPDF = () => import('jspdf')\n\nexport default function InjuryReportsList({ project, companyId, company, user, onShowToast }) {\n  const { branding } = useBranding()\n  const [reports, setReports] = useState([])\n  const [selectedReport, setSelectedReport] = useState(null)\n  const [showForm, setShowForm] = useState(false)\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState(null)\n  const [toast, setToast] = useState(null)\n\n  // View mode state\n  const [viewMode, setViewMode] = useState('recent') // 'recent' | 'all'\n  const [expandedMonths, setExpandedMonths] = useState(new Set())\n  const [dateFilter, setDateFilter] = useState({ start: '', end: '' })\n\n  useEffect(() => {\n    loadReports()\n\n    // Subscribe to real-time updates for injury reports\n    const effectiveCompanyId = companyId || project?.company_id\n    const subscription = effectiveCompanyId\n      ? db.subscribeToInjuryReports?.(effectiveCompanyId, () => {\n          loadReports()\n        })\n      : null\n\n    return () => {\n      if (subscription) db.unsubscribe?.(subscription)\n    }\n  }, [project?.id, companyId])\n\n  const loadReports = useCallback(async () => {\n    setLoading(true)\n    setError(null)\n    try {\n      const data = project\n        ? await db.getInjuryReports(project.id)\n        : await db.getCompanyInjuryReports(companyId)\n      setReports(data)\n    } catch (err) {\n      console.error('Error loading injury reports:', err)\n      setError(err)\n      setToast({ type: 'error', message: 'Failed to load injury reports' })\n    } finally {\n      setLoading(false)\n    }\n  }, [project?.id, companyId])\n\n  const handleReportCreated = () => {\n    loadReports()\n    setShowForm(false)\n    setToast({ type: 'success', message: 'Injury report created successfully' })\n  }\n\n  const handleViewDetails = (report) => {\n    setSelectedReport(report)\n  }\n\n  const handleCloseDetails = () => {\n    setSelectedReport(null)\n  }\n\n  const formatDate = (dateString) => {\n    if (!dateString) return ''\n    const date = new Date(dateString)\n    return date.toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    })\n  }\n\n  const formatTime = (timeString) => {\n    if (!timeString) return ''\n    return new Date(`2000-01-01T${timeString}`).toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n      hour12: true\n    })\n  }\n\n  const getInjuryTypeLabel = (type) => {\n    const labels = {\n      minor: 'Minor Injury',\n      serious: 'Serious Injury',\n      critical: 'Critical Injury',\n      near_miss: 'Near Miss'\n    }\n    return labels[type] || type\n  }\n\n  const getStatusColor = (status) => {\n    const colors = {\n      reported: '#fbbf24',\n      under_investigation: '#3b82f6',\n      closed: '#10b981'\n    }\n    return colors[status] || '#9ca3af'\n  }\n\n  const getInjuryTypeColor = (type) => {\n    const colors = {\n      minor: '#10b981',\n      serious: '#f59e0b',\n      critical: '#ef4444',\n      near_miss: '#6b7280'\n    }\n    return colors[type] || '#9ca3af'\n  }\n\n  // Filter reports by view mode and date range\n  const filteredReports = useMemo(() => {\n    let filtered = [...reports]\n\n    // Apply date filter if set\n    if (dateFilter.start) {\n      const startDate = new Date(dateFilter.start)\n      startDate.setHours(0, 0, 0, 0)\n      filtered = filtered.filter(r => {\n        const reportDate = new Date(r.incident_date)\n        return reportDate >= startDate\n      })\n    }\n    if (dateFilter.end) {\n      const endDate = new Date(dateFilter.end)\n      endDate.setHours(23, 59, 59, 999)\n      filtered = filtered.filter(r => {\n        const reportDate = new Date(r.incident_date)\n        return reportDate <= endDate\n      })\n    }\n\n    // In recent mode, show only last 7 days\n    if (viewMode === 'recent') {\n      const sevenDaysAgo = new Date()\n      sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7)\n      sevenDaysAgo.setHours(0, 0, 0, 0)\n      filtered = filtered.filter(r => {\n        const reportDate = new Date(r.incident_date)\n        return reportDate >= sevenDaysAgo\n      })\n    }\n\n    return filtered\n  }, [reports, viewMode, dateFilter])\n\n  // Group reports by month for 'all' view\n  const reportsByMonth = useMemo(() => {\n    if (viewMode !== 'all') return null\n\n    const groups = {}\n    filteredReports.forEach(report => {\n      const date = new Date(report.incident_date)\n      const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`\n      const monthLabel = date.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })\n\n      if (!groups[monthKey]) {\n        groups[monthKey] = { label: monthLabel, reports: [] }\n      }\n      groups[monthKey].reports.push(report)\n    })\n\n    return Object.entries(groups).sort((a, b) => b[0].localeCompare(a[0]))\n  }, [filteredReports, viewMode])\n\n  // Auto-expand current month\n  useEffect(() => {\n    if (reportsByMonth && reportsByMonth.length > 0) {\n      const currentMonthKey = reportsByMonth[0][0]\n      setExpandedMonths(new Set([currentMonthKey]))\n    }\n  }, [reportsByMonth])\n\n  const toggleMonthExpand = (monthKey) => {\n    const newExpanded = new Set(expandedMonths)\n    if (newExpanded.has(monthKey)) {\n      newExpanded.delete(monthKey)\n    } else {\n      newExpanded.add(monthKey)\n    }\n    setExpandedMonths(newExpanded)\n  }\n\n  // Export to PDF with company branding\n  const exportToPDF = async () => {\n    if (reports.length === 0) {\n      setToast({ type: 'error', message: 'No reports to export' })\n      return\n    }\n\n    setToast({ type: 'info', message: 'Generating PDF...' })\n\n    // Dynamic import - only loads jsPDF when user actually exports\n    const jsPDFModule = await loadJsPDF()\n    const jsPDF = jsPDFModule.default\n\n    const doc = new jsPDF()\n    const pageWidth = doc.internal.pageSize.getWidth()\n    const margin = 20\n    let yPos = margin\n\n    const primaryColor = hexToRgb(branding?.primary_color || '#3B82F6')\n    const secondaryColor = hexToRgb(branding?.secondary_color || '#1E40AF')\n\n    // Header with branding\n    doc.setFillColor(...primaryColor)\n    doc.rect(0, 0, pageWidth, 45, 'F')\n    doc.setFillColor(...secondaryColor)\n    doc.rect(0, 42, pageWidth, 3, 'F')\n\n    // Add logo if available\n    let logoOffset = margin\n    if (branding?.logo_url) {\n      try {\n        const logoBase64 = await loadImageAsBase64(branding.logo_url)\n        if (logoBase64) {\n          doc.addImage(logoBase64, 'PNG', margin, 7, 30, 30)\n          logoOffset = margin + 40\n        }\n      } catch (e) {\n        console.error('Error adding logo:', e)\n      }\n    }\n\n    doc.setTextColor(255, 255, 255)\n    doc.setFontSize(22)\n    doc.setFont('helvetica', 'bold')\n    doc.text(company?.name || 'Company', logoOffset, 20)\n    doc.setFontSize(10)\n    doc.setFont('helvetica', 'normal')\n    doc.text('INJURY & INCIDENT REPORTS', logoOffset, 30)\n\n    doc.setFontSize(9)\n    doc.text(`Generated: ${new Date().toLocaleDateString()}`, pageWidth - margin, 20, { align: 'right' })\n    doc.text(`Total Reports: ${reports.length}`, pageWidth - margin, 28, { align: 'right' })\n\n    yPos = 55\n\n    // Project info if available\n    if (project) {\n      doc.setFillColor(248, 250, 252)\n      doc.rect(margin, yPos - 5, pageWidth - margin * 2, 15, 'F')\n      doc.setTextColor(...primaryColor)\n      doc.setFontSize(12)\n      doc.setFont('helvetica', 'bold')\n      doc.text(`Project: ${project.name}`, margin + 5, yPos + 5)\n      yPos += 20\n    }\n\n    // Reports\n    reports.forEach((report) => {\n      // Check if we need a new page (injury reports need more space)\n      if (yPos > 200) {\n        doc.addPage()\n        yPos = margin\n      }\n\n      // Report header with injury type color\n      const typeColor = hexToRgb(getInjuryTypeColor(report.injury_type))\n      doc.setFillColor(...typeColor)\n      doc.rect(margin, yPos, pageWidth - margin * 2, 12, 'F')\n      doc.setTextColor(255, 255, 255)\n      doc.setFontSize(11)\n      doc.setFont('helvetica', 'bold')\n      doc.text(`${report.employee_name} - ${getInjuryTypeLabel(report.injury_type)}`, margin + 5, yPos + 8)\n      doc.text(formatDate(report.incident_date), pageWidth - margin - 5, yPos + 8, { align: 'right' })\n      yPos += 17\n\n      doc.setTextColor(50, 50, 50)\n      doc.setFontSize(9)\n      doc.setFont('helvetica', 'normal')\n\n      // Location and time\n      doc.text(`Location: ${report.incident_location}`, margin + 5, yPos)\n      if (report.incident_time) {\n        doc.text(`Time: ${formatTime(report.incident_time)}`, margin + 100, yPos)\n      }\n      yPos += 6\n\n      // Description\n      doc.setFont('helvetica', 'bold')\n      doc.text('Description:', margin + 5, yPos)\n      doc.setFont('helvetica', 'normal')\n      yPos += 5\n      const descLines = doc.splitTextToSize(report.incident_description, pageWidth - margin * 2 - 10)\n      doc.text(descLines, margin + 5, yPos)\n      yPos += descLines.length * 4 + 3\n\n      // Key details\n      const details = []\n      if (report.body_part_affected) details.push(`Body Part: ${report.body_part_affected}`)\n      if (report.osha_recordable) details.push('OSHA Recordable')\n      if (report.workers_comp_claim) details.push('Workers\\' Comp Filed')\n      if (report.medical_treatment_required) details.push('Medical Treatment Required')\n\n      if (details.length > 0) {\n        doc.setFontSize(8)\n        doc.setTextColor(100, 100, 100)\n        doc.text(details.join('  |  '), margin + 5, yPos)\n        yPos += 5\n      }\n\n      // Reported by\n      doc.setFontSize(8)\n      doc.text(`Reported by: ${report.reported_by_name} (${report.reported_by_title})`, margin + 5, yPos)\n      yPos += 12\n    })\n\n    // Footer\n    const pageCount = doc.internal.getNumberOfPages()\n    for (let i = 1; i <= pageCount; i++) {\n      doc.setPage(i)\n      doc.setFontSize(8)\n      doc.setTextColor(150, 150, 150)\n      doc.text(`Page ${i} of ${pageCount}`, pageWidth / 2, doc.internal.pageSize.getHeight() - 10, { align: 'center' })\n      doc.text('CONFIDENTIAL - Injury Report', margin, doc.internal.pageSize.getHeight() - 10)\n    }\n\n    const fileName = `Injury_Reports_${new Date().toISOString().split('T')[0]}.pdf`\n    doc.save(fileName)\n    setToast({ type: 'success', message: 'PDF exported!' })\n  }\n\n  if (loading) {\n    return (\n      <div className=\"loading-container\">\n        <div className=\"spinner\"></div>\n        <p>Loading injury reports...</p>\n      </div>\n    )\n  }\n\n  if (error) {\n    return (\n      <div className=\"injury-reports-section card\">\n        <ErrorState\n          title=\"Unable to load reports\"\n          message=\"There was a problem loading injury reports. Please try again.\"\n          error={error}\n          onRetry={loadReports}\n        />\n      </div>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"injury-reports-section\">\n        <div className=\"section-header\">\n          <h3>Injury & Incident Reports</h3>\n          <div className=\"section-header-actions\">\n            {reports.length > 0 && (\n              <button className=\"btn-secondary\" onClick={exportToPDF}>\n                PDF\n              </button>\n            )}\n            <button className=\"btn-primary\" onClick={() => setShowForm(true)}>\n              + File Injury Report\n            </button>\n          </div>\n        </div>\n\n        {/* View Mode Bar */}\n        <div className=\"view-mode-bar\">\n          <div className=\"view-mode-tabs\">\n            <button\n              className={`view-mode-tab ${viewMode === 'recent' ? 'active' : ''}`}\n              onClick={() => { setViewMode('recent'); setDateFilter({ start: '', end: '' }); }}\n            >\n              Recent (7 days)\n            </button>\n            <button\n              className={`view-mode-tab ${viewMode === 'all' ? 'active' : ''}`}\n              onClick={() => setViewMode('all')}\n            >\n              All ({reports.length})\n            </button>\n          </div>\n\n          {viewMode === 'all' && (\n            <div className=\"date-filter\">\n              <Calendar size={16} />\n              <input\n                type=\"date\"\n                value={dateFilter.start}\n                onChange={(e) => setDateFilter(prev => ({ ...prev, start: e.target.value }))}\n                placeholder=\"Start date\"\n              />\n              <span>to</span>\n              <input\n                type=\"date\"\n                value={dateFilter.end}\n                onChange={(e) => setDateFilter(prev => ({ ...prev, end: e.target.value }))}\n                placeholder=\"End date\"\n              />\n              {(dateFilter.start || dateFilter.end) && (\n                <button\n                  className=\"btn-ghost\"\n                  onClick={() => setDateFilter({ start: '', end: '' })}\n                >\n                  Clear\n                </button>\n              )}\n            </div>\n          )}\n        </div>\n\n        {filteredReports.length === 0 ? (\n          <div className=\"empty-state\">\n            <div className=\"empty-state-icon\"></div>\n            <h4>No Injury Reports{viewMode === 'recent' ? ' in the last 7 days' : ''}</h4>\n            <p>Click \"File Injury Report\" to document a workplace incident</p>\n            {viewMode === 'recent' && reports.length > 0 && (\n              <button className=\"btn-secondary\" onClick={() => setViewMode('all')}>\n                View All Reports\n              </button>\n            )}\n          </div>\n        ) : (\n          <div className=\"reports-list\">\n            {/* Render reports - with month grouping in 'all' mode */}\n            {viewMode === 'all' && reportsByMonth ? (\n              reportsByMonth.map(([monthKey, monthData]) => (\n                <div key={monthKey} className=\"month-group\">\n                  <div\n                    className=\"month-header\"\n                    onClick={() => toggleMonthExpand(monthKey)}\n                  >\n                    <div className=\"month-header-left\">\n                      {expandedMonths.has(monthKey) ? (\n                        <ChevronDown size={18} />\n                      ) : (\n                        <ChevronRight size={18} />\n                      )}\n                      <span className=\"month-label\">{monthData.label}</span>\n                      <span className=\"month-count\">{monthData.reports.length} reports</span>\n                    </div>\n                  </div>\n                  {expandedMonths.has(monthKey) && (\n                    <div className=\"month-reports\">\n                      {monthData.reports.map(report => (\n                        <InjuryReportCard\n                          key={report.id}\n                          report={report}\n                          formatDate={formatDate}\n                          formatTime={formatTime}\n                          getInjuryTypeColor={getInjuryTypeColor}\n                          getInjuryTypeLabel={getInjuryTypeLabel}\n                          getStatusColor={getStatusColor}\n                          onViewDetails={handleViewDetails}\n                        />\n                      ))}\n                    </div>\n                  )}\n                </div>\n              ))\n            ) : (\n              // Recent view - simple list\n              filteredReports.map(report => (\n                <InjuryReportCard\n                  key={report.id}\n                  report={report}\n                  formatDate={formatDate}\n                  formatTime={formatTime}\n                  getInjuryTypeColor={getInjuryTypeColor}\n                  getInjuryTypeLabel={getInjuryTypeLabel}\n                  getStatusColor={getStatusColor}\n                  onViewDetails={handleViewDetails}\n                />\n              ))\n            )}\n          </div>\n        )}\n\n        {/* Report Details Modal */}\n        {selectedReport && (\n          <div className=\"modal-overlay\" onClick={handleCloseDetails}>\n            <div className=\"modal-content report-details-modal\" onClick={e => e.stopPropagation()}>\n              <div className=\"modal-header\">\n                <h2>Injury Report Details</h2>\n                <button className=\"close-btn\" onClick={handleCloseDetails}>&times;</button>\n              </div>\n\n              <div className=\"modal-body\">\n                {/* Incident Information */}\n                <section className=\"details-section\">\n                  <h3>Incident Information</h3>\n                  <div className=\"detail-grid\">\n                    <div className=\"detail-item\">\n                      <label>Date & Time</label>\n                      <div>{formatDate(selectedReport.incident_date)} at {formatTime(selectedReport.incident_time)}</div>\n                    </div>\n                    <div className=\"detail-item\">\n                      <label>Location</label>\n                      <div>{selectedReport.incident_location}</div>\n                    </div>\n                    <div className=\"detail-item\">\n                      <label>Injury Type</label>\n                      <div>\n                        <span\n                          className=\"badge\"\n                          style={{ backgroundColor: getInjuryTypeColor(selectedReport.injury_type) }}\n                        >\n                          {getInjuryTypeLabel(selectedReport.injury_type)}\n                        </span>\n                      </div>\n                    </div>\n                    {selectedReport.body_part_affected && (\n                      <div className=\"detail-item\">\n                        <label>Body Part Affected</label>\n                        <div>{selectedReport.body_part_affected}</div>\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"detail-item full-width\">\n                    <label>Description</label>\n                    <div className=\"description-box\">{selectedReport.incident_description}</div>\n                  </div>\n                </section>\n\n                {/* Employee Information */}\n                <section className=\"details-section\">\n                  <h3>Injured Employee</h3>\n                  <div className=\"detail-grid\">\n                    <div className=\"detail-item\">\n                      <label>Name</label>\n                      <div>{selectedReport.employee_name}</div>\n                    </div>\n                    <div className=\"detail-item\">\n                      <label>Job Title</label>\n                      <div>{selectedReport.employee_job_title}</div>\n                    </div>\n                    {selectedReport.employee_phone && (\n                      <div className=\"detail-item\">\n                        <label>Phone</label>\n                        <div>{selectedReport.employee_phone}</div>\n                      </div>\n                    )}\n                    {selectedReport.employee_email && (\n                      <div className=\"detail-item\">\n                        <label>Email</label>\n                        <div>{selectedReport.employee_email}</div>\n                      </div>\n                    )}\n                    {selectedReport.employee_address && (\n                      <div className=\"detail-item full-width\">\n                        <label>Address</label>\n                        <div>{selectedReport.employee_address}</div>\n                      </div>\n                    )}\n                  </div>\n                </section>\n\n                {/* Supervisor Information */}\n                <section className=\"details-section\">\n                  <h3>Reported By</h3>\n                  <div className=\"detail-grid\">\n                    <div className=\"detail-item\">\n                      <label>Name</label>\n                      <div>{selectedReport.reported_by_name}</div>\n                    </div>\n                    <div className=\"detail-item\">\n                      <label>Title</label>\n                      <div>{selectedReport.reported_by_title}</div>\n                    </div>\n                    {selectedReport.reported_by_phone && (\n                      <div className=\"detail-item\">\n                        <label>Phone</label>\n                        <div>{selectedReport.reported_by_phone}</div>\n                      </div>\n                    )}\n                    {selectedReport.reported_by_email && (\n                      <div className=\"detail-item\">\n                        <label>Email</label>\n                        <div>{selectedReport.reported_by_email}</div>\n                      </div>\n                    )}\n                  </div>\n                </section>\n\n                {/* Witnesses */}\n                {selectedReport.witnesses && selectedReport.witnesses.length > 0 && (\n                  <section className=\"details-section\">\n                    <h3>Witnesses</h3>\n                    {selectedReport.witnesses.map((witness, index) => (\n                      <div key={index} className=\"witness-card\">\n                        <div className=\"witness-header\">\n                          <strong>{witness.name}</strong>\n                          {witness.phone && <span>  {witness.phone}</span>}\n                          {witness.email && <span>  {witness.email}</span>}\n                        </div>\n                        {witness.testimony && (\n                          <div className=\"witness-testimony\">\n                            <em>\"{witness.testimony}\"</em>\n                          </div>\n                        )}\n                      </div>\n                    ))}\n                  </section>\n                )}\n\n                {/* Medical Information */}\n                {selectedReport.medical_treatment_required && (\n                  <section className=\"details-section\">\n                    <h3>Medical Treatment</h3>\n                    <div className=\"detail-grid\">\n                      {selectedReport.medical_facility_name && (\n                        <div className=\"detail-item\">\n                          <label>Facility</label>\n                          <div>{selectedReport.medical_facility_name}</div>\n                        </div>\n                      )}\n                      {selectedReport.medical_facility_address && (\n                        <div className=\"detail-item\">\n                          <label>Address</label>\n                          <div>{selectedReport.medical_facility_address}</div>\n                        </div>\n                      )}\n                      <div className=\"detail-item\">\n                        <label>Hospitalized</label>\n                        <div>{selectedReport.hospitalized ? 'Yes' : 'No'}</div>\n                      </div>\n                    </div>\n                  </section>\n                )}\n\n                {/* Actions & Safety */}\n                <section className=\"details-section\">\n                  <h3>Actions & Safety</h3>\n                  {selectedReport.immediate_actions_taken && (\n                    <div className=\"detail-item full-width\">\n                      <label>Immediate Actions Taken</label>\n                      <div className=\"description-box\">{selectedReport.immediate_actions_taken}</div>\n                    </div>\n                  )}\n                  {selectedReport.corrective_actions_planned && (\n                    <div className=\"detail-item full-width\">\n                      <label>Corrective Actions Planned</label>\n                      <div className=\"description-box\">{selectedReport.corrective_actions_planned}</div>\n                    </div>\n                  )}\n                  <div className=\"detail-grid\">\n                    {selectedReport.safety_equipment_used && (\n                      <div className=\"detail-item\">\n                        <label>Safety Equipment Used</label>\n                        <div>{selectedReport.safety_equipment_used}</div>\n                      </div>\n                    )}\n                    {selectedReport.safety_equipment_failed && (\n                      <div className=\"detail-item\">\n                        <label>Safety Equipment Failed</label>\n                        <div>{selectedReport.safety_equipment_failed}</div>\n                      </div>\n                    )}\n                  </div>\n                </section>\n\n                {/* Regulatory Information */}\n                <section className=\"details-section\">\n                  <h3>Regulatory & Work Impact</h3>\n                  <div className=\"detail-grid\">\n                    <div className=\"detail-item\">\n                      <label>OSHA Recordable</label>\n                      <div>{selectedReport.osha_recordable ? 'Yes' : 'No'}</div>\n                    </div>\n                    <div className=\"detail-item\">\n                      <label>Workers' Comp Claim</label>\n                      <div>{selectedReport.workers_comp_claim ? 'Yes' : 'No'}</div>\n                    </div>\n                    <div className=\"detail-item\">\n                      <label>Days Away From Work</label>\n                      <div>{selectedReport.days_away_from_work || 0}</div>\n                    </div>\n                    <div className=\"detail-item\">\n                      <label>Restricted Work Days</label>\n                      <div>{selectedReport.restricted_work_days || 0}</div>\n                    </div>\n                  </div>\n                </section>\n\n                <div className=\"report-meta\">\n                  Filed on {formatDate(selectedReport.created_at)}\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* New Report Form */}\n        {showForm && (\n          <InjuryReportForm\n            project={project}\n            companyId={companyId}\n            user={user}\n            onClose={() => setShowForm(false)}\n            onReportCreated={handleReportCreated}\n          />\n        )}\n\n        {toast && <Toast message={toast.message} type={toast.type} onClose={() => setToast(null)} />}\n      </div>\n\n      <style>{`\n        .injury-reports-section {\n          margin-top: 2rem;\n        }\n\n        .section-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 1.5rem;\n        }\n\n        .section-header h3 {\n          margin: 0;\n          font-size: 1.25rem;\n          color: var(--text-primary);\n        }\n\n        .view-mode-bar {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          gap: 1rem;\n          margin-bottom: 1rem;\n          padding: 0.75rem;\n          background: var(--bg-elevated);\n          border-radius: 8px;\n          flex-wrap: wrap;\n        }\n\n        .view-mode-tabs {\n          display: flex;\n          gap: 0.5rem;\n        }\n\n        .view-mode-tab {\n          padding: 0.5rem 1rem;\n          border: none;\n          border-radius: 6px;\n          font-size: 0.875rem;\n          cursor: pointer;\n          background: transparent;\n          color: var(--text-secondary);\n          transition: all 0.2s;\n        }\n\n        .view-mode-tab:hover {\n          background: var(--bg-tertiary);\n        }\n\n        .view-mode-tab.active {\n          background: var(--primary-color, #3b82f6);\n          color: white;\n        }\n\n        .date-filter {\n          display: flex;\n          align-items: center;\n          gap: 0.5rem;\n          color: var(--text-secondary);\n        }\n\n        .date-filter input[type=\"date\"] {\n          padding: 0.4rem 0.5rem;\n          border: 1px solid var(--border-color);\n          border-radius: 4px;\n          font-size: 0.875rem;\n          background: var(--bg-card);\n          color: var(--text-primary);\n        }\n\n        .btn-ghost {\n          background: transparent;\n          border: none;\n          padding: 0.4rem 0.75rem;\n          color: var(--text-secondary);\n          cursor: pointer;\n          border-radius: 4px;\n          font-size: 0.875rem;\n        }\n\n        .btn-ghost:hover {\n          background: var(--bg-tertiary);\n        }\n\n        .month-group {\n          margin-bottom: 0.5rem;\n        }\n\n        .month-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          padding: 0.75rem 1rem;\n          background: var(--bg-elevated);\n          border-radius: 8px;\n          cursor: pointer;\n          transition: background 0.2s;\n        }\n\n        .month-header:hover {\n          background: var(--bg-tertiary);\n        }\n\n        .month-header-left {\n          display: flex;\n          align-items: center;\n          gap: 0.5rem;\n        }\n\n        .month-label {\n          font-weight: 600;\n          color: var(--text-primary);\n        }\n\n        .month-count {\n          font-size: 0.875rem;\n          color: var(--text-secondary);\n        }\n\n        .month-reports {\n          margin-top: 0.5rem;\n          padding-left: 0.5rem;\n        }\n\n        .reports-list {\n          display: flex;\n          flex-direction: column;\n          gap: 1rem;\n        }\n\n        .report-card {\n          background: var(--bg-card);\n          border: 1px solid var(--border-color);\n          border-radius: 8px;\n          padding: 1.5rem;\n          cursor: pointer;\n          transition: all 0.2s;\n        }\n\n        .report-card:hover {\n          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);\n          border-color: var(--accent-primary);\n        }\n\n        .report-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: flex-start;\n          margin-bottom: 1rem;\n        }\n\n        .report-date {\n          font-size: 0.875rem;\n          color: var(--text-secondary);\n          margin-bottom: 0.25rem;\n        }\n\n        .employee-name {\n          font-size: 1.125rem;\n          font-weight: 600;\n          color: var(--text-primary);\n        }\n\n        .report-badges {\n          display: flex;\n          gap: 0.5rem;\n          flex-wrap: wrap;\n        }\n\n        .badge {\n          padding: 0.25rem 0.75rem;\n          border-radius: 12px;\n          font-size: 0.75rem;\n          font-weight: 500;\n          color: white;\n          text-transform: capitalize;\n        }\n\n        .osha-badge {\n          background-color: #dc2626;\n          color: white;\n          padding: 0.25rem 0.5rem;\n          border-radius: 4px;\n          font-size: 0.75rem;\n          font-weight: 600;\n        }\n\n        .report-summary {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n          gap: 0.75rem;\n          margin-bottom: 1rem;\n          padding: 1rem;\n          background-color: var(--bg-elevated);\n          border-radius: 6px;\n        }\n\n        .summary-item {\n          font-size: 0.875rem;\n          color: var(--text-secondary);\n        }\n\n        .summary-item strong {\n          color: var(--text-primary);\n        }\n\n        .report-description {\n          color: var(--text-secondary);\n          line-height: 1.6;\n          margin-bottom: 1rem;\n        }\n\n        .report-footer {\n          text-align: right;\n          font-size: 0.875rem;\n          color: var(--primary-color, #3b82f6);\n        }\n\n        .report-details-modal {\n          max-width: 900px;\n          max-height: 90vh;\n          overflow-y: auto;\n        }\n\n        .details-section {\n          margin-bottom: 2rem;\n          padding-bottom: 2rem;\n          border-bottom: 1px solid var(--border-color);\n        }\n\n        .details-section:last-child {\n          border-bottom: none;\n        }\n\n        .details-section h3 {\n          margin-top: 0;\n          margin-bottom: 1rem;\n          font-size: 1.125rem;\n          color: var(--text-primary);\n        }\n\n        .detail-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n          gap: 1rem;\n        }\n\n        .detail-item label {\n          display: block;\n          font-size: 0.875rem;\n          font-weight: 600;\n          color: var(--text-secondary);\n          margin-bottom: 0.25rem;\n        }\n\n        .detail-item div {\n          color: var(--text-primary);\n        }\n\n        .detail-item.full-width {\n          grid-column: 1 / -1;\n        }\n\n        .description-box {\n          background-color: var(--bg-elevated);\n          border: 1px solid var(--border-color);\n          border-radius: 6px;\n          padding: 1rem;\n          white-space: pre-wrap;\n          line-height: 1.6;\n          color: var(--text-primary);\n        }\n\n        .witness-card {\n          background-color: var(--bg-elevated);\n          border-radius: 6px;\n          padding: 1rem;\n          margin-bottom: 0.5rem;\n        }\n\n        .witness-header {\n          margin-bottom: 0.5rem;\n          color: var(--text-primary);\n        }\n\n        .witness-testimony {\n          color: var(--text-secondary);\n          font-size: 0.875rem;\n          padding-left: 1rem;\n          border-left: 3px solid var(--border-color);\n        }\n\n        .report-meta {\n          text-align: center;\n          font-size: 0.875rem;\n          color: var(--text-secondary);\n          padding-top: 1rem;\n          border-top: 1px solid var(--border-color);\n        }\n\n        .empty-state {\n          text-align: center;\n          padding: 3rem 1rem;\n        }\n\n        .empty-state-icon {\n          font-size: 3rem;\n          margin-bottom: 1rem;\n        }\n\n        .empty-state h4 {\n          margin: 0 0 0.5rem 0;\n          color: var(--text-primary);\n        }\n\n        .empty-state p {\n          margin: 0;\n          color: var(--text-secondary);\n        }\n\n        .section-header-actions {\n          display: flex;\n          gap: 0.5rem;\n          align-items: center;\n        }\n\n        .btn-primary, .btn-secondary {\n          padding: 0.5rem 1rem;\n          border-radius: 6px;\n          font-weight: 500;\n          cursor: pointer;\n          border: none;\n        }\n\n        .btn-primary {\n          background-color: var(--primary-color, #3b82f6);\n          color: white;\n        }\n\n        .btn-secondary {\n          background-color: var(--bg-elevated);\n          color: var(--text-primary);\n          border: 1px solid var(--border-color);\n        }\n\n        .btn-primary:hover, .btn-secondary:hover {\n          opacity: 0.9;\n        }\n\n        .loading-container {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          padding: 3rem;\n        }\n\n        .spinner {\n          width: 40px;\n          height: 40px;\n          border: 4px solid var(--border-color);\n          border-top-color: var(--accent-primary);\n          border-radius: 50%;\n          animation: spin 1s linear infinite;\n        }\n\n        @keyframes spin {\n          to { transform: rotate(360deg); }\n        }\n\n        @media (max-width: 768px) {\n          .report-header {\n            flex-direction: column;\n            gap: 0.5rem;\n          }\n\n          .report-summary {\n            grid-template-columns: 1fr;\n          }\n\n          .detail-grid {\n            grid-template-columns: 1fr;\n          }\n\n          .report-details-modal {\n            max-width: 100%;\n            height: 100vh;\n            max-height: 100vh;\n            border-radius: 0;\n          }\n        }\n      `}</style>\n    </>\n  )\n}\n","import { useState, useEffect } from 'react'\nimport { db } from '../lib/supabase'\nimport { Users, UserPlus, UserMinus, ChevronDown, X } from 'lucide-react'\n\nconst PROJECT_ROLE_OPTIONS = [\n  'Project Manager',\n  'Superintendent',\n  'Foreman',\n  'Office Support',\n  'Engineer',\n  'Inspector',\n  'Team Member'\n]\n\nexport default function ProjectTeam({ project, company, user, isAdmin, onShowToast }) {\n  const [teamMembers, setTeamMembers] = useState([])\n  const [companyMembers, setCompanyMembers] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [showAddModal, setShowAddModal] = useState(false)\n  const [selectedUser, setSelectedUser] = useState('')\n  const [selectedRole, setSelectedRole] = useState('Team Member')\n  const [actionLoading, setActionLoading] = useState(null)\n\n  useEffect(() => {\n    if (project?.id) {\n      loadProjectTeam()\n    }\n  }, [project?.id])\n\n  useEffect(() => {\n    if (showAddModal && company?.id) {\n      loadCompanyMembers()\n    }\n  }, [showAddModal, company?.id])\n\n  const loadProjectTeam = async () => {\n    try {\n      setLoading(true)\n      const data = await db.getProjectTeam(project.id)\n      setTeamMembers(data)\n    } catch (error) {\n      console.error('Error loading project team:', error)\n      onShowToast('Error loading project team', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const loadCompanyMembers = async () => {\n    try {\n      const data = await db.getCompanyMembers(company.id)\n      // Filter out users already on the project\n      const existingUserIds = teamMembers.map(tm => tm.users?.id)\n      const available = data.filter(m => !existingUserIds.includes(m.users?.id))\n      setCompanyMembers(available)\n    } catch (error) {\n      console.error('Error loading company members:', error)\n      onShowToast('Error loading company members', 'error')\n    }\n  }\n\n  const handleAddMember = async () => {\n    if (!selectedUser) {\n      onShowToast('Select a team member', 'error')\n      return\n    }\n\n    try {\n      setActionLoading('add')\n      await db.addProjectMember(project.id, selectedUser, selectedRole, user.id)\n      onShowToast('Team member added', 'success')\n      setShowAddModal(false)\n      setSelectedUser('')\n      setSelectedRole('Team Member')\n      loadProjectTeam()\n    } catch (error) {\n      console.error('Error adding team member:', error)\n      onShowToast('Error adding team member', 'error')\n    } finally {\n      setActionLoading(null)\n    }\n  }\n\n  const handleUpdateRole = async (member, newRole) => {\n    try {\n      setActionLoading(member.id)\n      await db.updateProjectMemberRole(project.id, member.users?.id, newRole)\n      onShowToast('Role updated', 'success')\n      loadProjectTeam()\n    } catch (error) {\n      console.error('Error updating role:', error)\n      onShowToast('Error updating role', 'error')\n    } finally {\n      setActionLoading(null)\n    }\n  }\n\n  const handleRemoveMember = async (member) => {\n    try {\n      setActionLoading(member.id)\n      await db.removeProjectMember(project.id, member.users?.id)\n      onShowToast('Team member removed', 'success')\n      loadProjectTeam()\n    } catch (error) {\n      console.error('Error removing team member:', error)\n      onShowToast('Error removing team member', 'error')\n    } finally {\n      setActionLoading(null)\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"project-team\">\n        <div className=\"project-team-header\">\n          <h3><Users size={18} /> Project Team</h3>\n        </div>\n        <div className=\"loading-small\">Loading...</div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"project-team\">\n      <div className=\"project-team-header\">\n        <h3><Users size={18} /> Project Team</h3>\n        {isAdmin && (\n          <button\n            className=\"btn btn-small btn-primary\"\n            onClick={() => setShowAddModal(true)}\n          >\n            <UserPlus size={14} /> Add\n          </button>\n        )}\n      </div>\n\n      {teamMembers.length === 0 ? (\n        <div className=\"project-team-empty\">\n          No team members assigned yet\n          {isAdmin && <p>Click \"Add\" to assign team members to this project</p>}\n        </div>\n      ) : (\n        <div className=\"project-team-list\">\n          {teamMembers.map(member => (\n            <div key={member.id} className=\"project-team-member\">\n              <div className=\"team-member-info\">\n                <div className=\"team-member-name\">{member.users?.name || 'Unknown'}</div>\n                <div className=\"team-member-email\">{member.users?.email}</div>\n              </div>\n              <div className=\"team-member-role\">\n                {isAdmin ? (\n                  <div className=\"role-selector compact\">\n                    <select\n                      value={member.project_role}\n                      onChange={(e) => handleUpdateRole(member, e.target.value)}\n                      disabled={actionLoading === member.id}\n                      className=\"role-select\"\n                    >\n                      {PROJECT_ROLE_OPTIONS.map(role => (\n                        <option key={role} value={role}>{role}</option>\n                      ))}\n                    </select>\n                    <ChevronDown size={12} className=\"role-select-icon\" />\n                  </div>\n                ) : (\n                  <span className=\"role-badge\">{member.project_role}</span>\n                )}\n              </div>\n              {isAdmin && (\n                <button\n                  className=\"btn-icon btn-danger-subtle\"\n                  onClick={() => handleRemoveMember(member)}\n                  disabled={actionLoading === member.id}\n                  title=\"Remove from project\"\n                >\n                  <UserMinus size={14} />\n                </button>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Add Member Modal */}\n      {showAddModal && (\n        <div className=\"modal-overlay\" onClick={() => setShowAddModal(false)}>\n          <div className=\"modal-content small\" onClick={e => e.stopPropagation()}>\n            <div className=\"modal-header\">\n              <h3>Add Team Member</h3>\n              <button className=\"modal-close\" onClick={() => setShowAddModal(false)}>\n                <X size={20} />\n              </button>\n            </div>\n            <div className=\"modal-body\">\n              <div className=\"form-group\">\n                <label>Select Team Member</label>\n                <select\n                  value={selectedUser}\n                  onChange={(e) => setSelectedUser(e.target.value)}\n                  className=\"form-select\"\n                >\n                  <option value=\"\">Choose a team member...</option>\n                  {companyMembers.map(member => (\n                    <option key={member.users?.id} value={member.users?.id}>\n                      {member.users?.name || member.users?.email}\n                    </option>\n                  ))}\n                </select>\n                {companyMembers.length === 0 && (\n                  <p className=\"form-hint\">All company members are already assigned to this project</p>\n                )}\n              </div>\n              <div className=\"form-group\">\n                <label>Project Role</label>\n                <select\n                  value={selectedRole}\n                  onChange={(e) => setSelectedRole(e.target.value)}\n                  className=\"form-select\"\n                >\n                  {PROJECT_ROLE_OPTIONS.map(role => (\n                    <option key={role} value={role}>{role}</option>\n                  ))}\n                </select>\n                <p className=\"form-hint\">This is for visibility only - it doesn't affect permissions</p>\n              </div>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-secondary\"\n                onClick={() => setShowAddModal(false)}\n              >\n                Cancel\n              </button>\n              <button\n                className=\"btn btn-primary\"\n                onClick={handleAddMember}\n                disabled={!selectedUser || actionLoading === 'add'}\n              >\n                {actionLoading === 'add' ? 'Adding...' : 'Add to Project'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n","import { useState, useEffect } from 'react'\nimport { Shield, ShieldCheck, ShieldOff, Copy, Check, X, Loader2 } from 'lucide-react'\nimport { supabase } from '../lib/supabase'\n\nexport default function MFASetup({ onShowToast, onClose }) {\n  const [step, setStep] = useState('loading')\n  const [factors, setFactors] = useState([])\n  const [qrCode, setQrCode] = useState(null)\n  const [secret, setSecret] = useState(null)\n  const [factorId, setFactorId] = useState(null)\n  const [verifyCode, setVerifyCode] = useState('')\n  const [verifying, setVerifying] = useState(false)\n  const [copied, setCopied] = useState(false)\n  const [error, setError] = useState(null)\n\n  useEffect(() => {\n    loadFactors()\n  }, [])\n\n  const loadFactors = async () => {\n    try {\n      const { data, error } = await supabase.auth.mfa.listFactors()\n      if (error) throw error\n      const totpFactors = (data?.totp || []).filter(f => f.status === 'verified')\n      setFactors(totpFactors)\n      setStep('overview')\n    } catch {\n      setStep('overview')\n    }\n  }\n\n  const startEnrollment = async () => {\n    setError(null)\n    try {\n      const { data, error } = await supabase.auth.mfa.enroll({\n        factorType: 'totp',\n        friendlyName: 'FieldSync Authenticator'\n      })\n      if (error) throw error\n      if (!data?.totp) throw new Error('MFA enrollment response missing TOTP data')\n      setQrCode(data.totp.qr_code)\n      setSecret(data.totp.secret)\n      setFactorId(data.id)\n      setStep('enroll')\n    } catch (err) {\n      setError(err.message)\n      onShowToast?.('Failed to start MFA enrollment', 'error')\n    }\n  }\n\n  const verifyEnrollment = async () => {\n    if (verifyCode.length !== 6) return\n    setVerifying(true)\n    setError(null)\n    try {\n      const { data: challenge, error: challengeError } = await supabase.auth.mfa.challenge({ factorId })\n      if (challengeError) throw challengeError\n\n      const { error: verifyError } = await supabase.auth.mfa.verify({\n        factorId,\n        challengeId: challenge.id,\n        code: verifyCode\n      })\n      if (verifyError) throw verifyError\n\n      setStep('success')\n      onShowToast?.('MFA enabled successfully!', 'success')\n      await loadFactors()\n    } catch {\n      setError('Invalid code. Please try again.')\n      setVerifyCode('')\n    } finally {\n      setVerifying(false)\n    }\n  }\n\n  const unenroll = async (id) => {\n    try {\n      const { error } = await supabase.auth.mfa.unenroll({ factorId: id })\n      if (error) throw error\n      onShowToast?.('MFA disabled', 'success')\n      await loadFactors()\n    } catch {\n      onShowToast?.('Failed to disable MFA', 'error')\n    }\n  }\n\n  const copySecret = () => {\n    navigator.clipboard.writeText(secret)\n    setCopied(true)\n    setTimeout(() => setCopied(false), 2000)\n  }\n\n  const isEnabled = factors.length > 0\n\n  return (\n    <div className=\"mfa-setup\">\n      <div className=\"mfa-header\">\n        <div className=\"mfa-title\">\n          {isEnabled ? <ShieldCheck size={20} className=\"text-success\" /> : <Shield size={20} />}\n          <h3>Two-Factor Authentication</h3>\n        </div>\n        {onClose && (\n          <button className=\"close-btn\" onClick={onClose} aria-label=\"Close\">\n            <X size={20} />\n          </button>\n        )}\n      </div>\n\n      {step === 'loading' && (\n        <div className=\"mfa-loading\"><Loader2 size={24} className=\"spinner\" /> Loading...</div>\n      )}\n\n      {step === 'overview' && (\n        <div className=\"mfa-overview\">\n          <p className=\"mfa-description\">\n            Add an extra layer of security to your account. When enabled, you will need to enter\n            a code from your authenticator app each time you sign in.\n          </p>\n          {isEnabled ? (\n            <div className=\"mfa-status mfa-status-enabled\">\n              <ShieldCheck size={18} />\n              <span>MFA is enabled</span>\n              <button className=\"btn btn-ghost btn-small\" onClick={() => unenroll(factors[0].id)}>\n                <ShieldOff size={14} /> Disable\n              </button>\n            </div>\n          ) : (\n            <div className=\"mfa-status mfa-status-disabled\">\n              <ShieldOff size={18} />\n              <span>MFA is not enabled</span>\n              <button className=\"btn btn-primary btn-small\" onClick={startEnrollment}>\n                <Shield size={14} /> Enable MFA\n              </button>\n            </div>\n          )}\n        </div>\n      )}\n\n      {step === 'enroll' && (\n        <div className=\"mfa-enroll\">\n          <p>Scan this QR code with your authenticator app (Google Authenticator, Authy, 1Password):</p>\n          {qrCode && (\n            <div className=\"mfa-qr-container\">\n              <img src={qrCode} alt=\"MFA QR Code\" className=\"mfa-qr\" />\n            </div>\n          )}\n          <div className=\"mfa-secret\">\n            <span className=\"mfa-secret-label\">Or enter this key manually:</span>\n            <div className=\"mfa-secret-value\">\n              <code>{secret}</code>\n              <button className=\"btn btn-ghost btn-small\" onClick={copySecret} aria-label=\"Copy secret key\">\n                {copied ? <Check size={14} /> : <Copy size={14} />}\n              </button>\n            </div>\n          </div>\n          <div className=\"mfa-verify-section\">\n            <label htmlFor=\"mfa-verify-code\">Enter the 6-digit code from your app:</label>\n            <div className=\"mfa-code-input\">\n              <input\n                id=\"mfa-verify-code\"\n                type=\"text\"\n                value={verifyCode}\n                onChange={(e) => setVerifyCode(e.target.value.replace(/\\D/g, '').slice(0, 6))}\n                placeholder=\"000000\"\n                maxLength={6}\n                autoFocus\n                inputMode=\"numeric\"\n                pattern=\"[0-9]*\"\n              />\n              <button\n                className=\"btn btn-primary\"\n                onClick={verifyEnrollment}\n                disabled={verifyCode.length !== 6 || verifying}\n              >\n                {verifying ? <><Loader2 size={14} className=\"spinner\" /> Verifying...</> : 'Verify & Enable'}\n              </button>\n            </div>\n            {error && <p className=\"mfa-error\">{error}</p>}\n          </div>\n          <button className=\"btn btn-ghost btn-small\" onClick={() => setStep('overview')}>Cancel</button>\n        </div>\n      )}\n\n      {step === 'success' && (\n        <div className=\"mfa-success\">\n          <ShieldCheck size={48} className=\"text-success\" />\n          <h4>MFA Enabled</h4>\n          <p>Your account is now protected with two-factor authentication.</p>\n          <button className=\"btn btn-primary\" onClick={() => setStep('overview')}>Done</button>\n        </div>\n      )}\n    </div>\n  )\n}\n","/**\n * Earned Value Management (EVM) calculations\n *\n * Standard construction industry metrics:\n * - BCWP (Budgeted Cost of Work Performed) = Earned Value\n * - BCWS (Budgeted Cost of Work Scheduled) = Planned Value\n * - ACWP (Actual Cost of Work Performed) = Actual Cost\n * - CPI (Cost Performance Index) = EV / AC\n * - SPI (Schedule Performance Index) = EV / PV\n * - EAC (Estimate at Completion) = BAC / CPI\n * - ETC (Estimate to Complete) = EAC - AC\n * - VAC (Variance at Completion) = BAC - EAC\n */\n\n/**\n * Calculate earned value metrics for a project\n * @param {Object} params\n * @param {number} params.contractValue - Original contract value (BAC)\n * @param {number} params.changeOrderValue - Approved change order value\n * @param {number} params.progressPercent - Overall completion percentage (0-100)\n * @param {number} params.actualCosts - Total actual costs to date\n * @param {string} params.startDate - Project start date\n * @param {string} params.endDate - Planned end date\n * @param {Array} params.areas - Work areas with status, weight, scheduled_value\n * @returns {Object} Earned value metrics\n */\nexport function calculateEarnedValue({\n  contractValue = 0,\n  changeOrderValue = 0,\n  progressPercent = 0,\n  actualCosts = 0,\n  startDate,\n  endDate,\n  areas = []\n}) {\n  // BAC = Budget at Completion (revised with change orders)\n  const bac = contractValue + changeOrderValue\n\n  // EV = Earned Value (what we've earned based on completion)\n  const earnedValue = (progressPercent / 100) * bac\n\n  // PV = Planned Value (what we should have earned by now based on schedule)\n  const plannedValue = calculatePlannedValue(bac, startDate, endDate)\n\n  // AC = Actual Cost\n  const actualCost = actualCosts\n\n  // CPI = Cost Performance Index (> 1 = under budget, < 1 = over budget)\n  const cpi = actualCost > 0 ? earnedValue / actualCost : 1\n\n  // SPI = Schedule Performance Index (> 1 = ahead, < 1 = behind)\n  const spi = plannedValue > 0 ? earnedValue / plannedValue : 1\n\n  // CV = Cost Variance (positive = under budget)\n  const costVariance = earnedValue - actualCost\n\n  // SV = Schedule Variance (positive = ahead)\n  const scheduleVariance = earnedValue - plannedValue\n\n  // EAC = Estimate at Completion\n  const eac = cpi > 0 ? bac / cpi : bac * 2\n\n  // ETC = Estimate to Complete\n  const etc = Math.max(0, eac - actualCost)\n\n  // VAC = Variance at Completion (positive = under budget)\n  const vac = bac - eac\n\n  // TCPI = To-Complete Performance Index (CPI needed to finish on budget)\n  const remainingWork = bac - earnedValue\n  const remainingBudget = bac - actualCost\n  const tcpi = remainingBudget > 0 ? remainingWork / remainingBudget : 999\n\n  // Projected completion date\n  const projectedEndDate = calculateProjectedEndDate(startDate, endDate, spi)\n\n  // Health status based on CPI and SPI\n  const healthStatus = getHealthStatus(cpi, spi)\n\n  return {\n    // Core EV metrics\n    bac,\n    earnedValue,\n    plannedValue,\n    actualCost,\n\n    // Performance indices\n    cpi: roundTo(cpi, 2),\n    spi: roundTo(spi, 2),\n\n    // Variances\n    costVariance,\n    scheduleVariance,\n\n    // Forecasts\n    eac: Math.round(eac),\n    etc: Math.round(etc),\n    vac: Math.round(vac),\n    tcpi: roundTo(tcpi, 2),\n\n    // Projections\n    projectedEndDate,\n    percentScheduled: calculatePercentScheduled(startDate, endDate),\n    percentComplete: progressPercent,\n\n    // Status\n    healthStatus,\n    cpiLabel: getCPILabel(cpi),\n    spiLabel: getSPILabel(spi),\n\n    // For charting\n    budgetUtilization: bac > 0 ? roundTo((actualCost / bac) * 100, 1) : 0,\n    earnedPercent: bac > 0 ? roundTo((earnedValue / bac) * 100, 1) : 0\n  }\n}\n\n/**\n * Calculate planned value based on linear schedule\n */\nfunction calculatePlannedValue(bac, startDate, endDate) {\n  if (!startDate || !endDate) return 0\n\n  const start = new Date(startDate)\n  const end = new Date(endDate)\n  const now = new Date()\n\n  const totalDuration = end - start\n  if (totalDuration <= 0) return bac\n\n  const elapsed = now - start\n  const percentElapsed = Math.min(1, Math.max(0, elapsed / totalDuration))\n\n  return percentElapsed * bac\n}\n\n/**\n * Calculate what percent of the schedule has elapsed\n */\nfunction calculatePercentScheduled(startDate, endDate) {\n  if (!startDate || !endDate) return 0\n\n  const start = new Date(startDate)\n  const end = new Date(endDate)\n  const now = new Date()\n\n  const totalDuration = end - start\n  if (totalDuration <= 0) return 100\n\n  const elapsed = now - start\n  return roundTo(Math.min(100, Math.max(0, (elapsed / totalDuration) * 100)), 1)\n}\n\n/**\n * Project the end date based on SPI\n */\nfunction calculateProjectedEndDate(startDate, endDate, spi) {\n  if (!startDate || !endDate || spi <= 0) return null\n\n  const start = new Date(startDate)\n  const end = new Date(endDate)\n  const totalDays = (end - start) / (1000 * 60 * 60 * 24)\n\n  // Adjusted duration = original duration / SPI\n  const adjustedDays = totalDays / spi\n  const projected = new Date(start.getTime() + adjustedDays * 24 * 60 * 60 * 1000)\n\n  return projected.toISOString().split('T')[0]\n}\n\nfunction getHealthStatus(cpi, spi) {\n  if (cpi >= 0.95 && spi >= 0.95) return 'healthy'\n  if (cpi >= 0.85 && spi >= 0.85) return 'watch'\n  if (cpi >= 0.70 && spi >= 0.70) return 'warning'\n  return 'critical'\n}\n\nfunction getCPILabel(cpi) {\n  if (cpi >= 1.05) return 'Under Budget'\n  if (cpi >= 0.95) return 'On Budget'\n  if (cpi >= 0.85) return 'Slightly Over'\n  return 'Over Budget'\n}\n\nfunction getSPILabel(spi) {\n  if (spi >= 1.05) return 'Ahead of Schedule'\n  if (spi >= 0.95) return 'On Schedule'\n  if (spi >= 0.85) return 'Slightly Behind'\n  return 'Behind Schedule'\n}\n\nfunction roundTo(value, decimals) {\n  const factor = Math.pow(10, decimals)\n  return Math.round(value * factor) / factor\n}\n\n/**\n * Generate S-curve data points for chart\n * Shows Planned Value, Earned Value, and Actual Cost over time\n */\nexport function generateSCurveData({\n  contractValue = 0,\n  changeOrderValue = 0,\n  progressPercent = 0,\n  actualCosts = 0,\n  startDate,\n  endDate\n}) {\n  if (!startDate || !endDate) return []\n\n  const bac = contractValue + changeOrderValue\n  const start = new Date(startDate)\n  const end = new Date(endDate)\n  const now = new Date()\n  const totalDays = Math.max(1, (end - start) / (1000 * 60 * 60 * 24))\n\n  const points = []\n  const numPoints = Math.min(12, Math.ceil(totalDays / 7)) // Weekly points, max 12\n\n  for (let i = 0; i <= numPoints; i++) {\n    const fraction = i / numPoints\n    const pointDate = new Date(start.getTime() + fraction * (end - start))\n    const label = pointDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n\n    // Planned value follows linear schedule\n    const pv = Math.round(fraction * bac)\n\n    // Only show EV and AC for past dates\n    const isPast = pointDate <= now\n    const isCurrent = i === numPoints || (isPast && i === numPoints - 1)\n\n    const point = {\n      date: label,\n      plannedValue: pv,\n    }\n\n    if (isPast || isCurrent) {\n      // Interpolate EV and AC to current point\n      const timePercent = Math.min(1, (pointDate - start) / (now - start))\n      point.earnedValue = Math.round(timePercent * (progressPercent / 100) * bac)\n      point.actualCost = Math.round(timePercent * actualCosts)\n    }\n\n    points.push(point)\n  }\n\n  return points\n}\n","import { useMemo } from 'react'\nimport { LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer, Legend } from 'recharts'\nimport { TrendingUp, TrendingDown, DollarSign, Clock, Target, AlertTriangle } from 'lucide-react'\nimport { formatCurrency } from '../../lib/utils'\nimport { calculateEarnedValue, generateSCurveData } from '../../lib/earnedValueCalculations'\nimport { chartColors, tooltipStyle, formatChartCurrency } from './chartConfig'\n\n/**\n * Earned Value Management card for project dashboard.\n * Shows CPI, SPI, EAC, ETC, and S-curve chart.\n */\nexport default function EarnedValueCard({\n  contractValue = 0,\n  changeOrderValue = 0,\n  progressPercent = 0,\n  actualCosts = 0,\n  startDate,\n  endDate,\n  areas = []\n}) {\n  const ev = useMemo(() =>\n    calculateEarnedValue({\n      contractValue,\n      changeOrderValue,\n      progressPercent,\n      actualCosts,\n      startDate,\n      endDate,\n      areas\n    }),\n    [contractValue, changeOrderValue, progressPercent, actualCosts, startDate, endDate, areas]\n  )\n\n  const sCurveData = useMemo(() =>\n    generateSCurveData({\n      contractValue,\n      changeOrderValue,\n      progressPercent,\n      actualCosts,\n      startDate,\n      endDate\n    }),\n    [contractValue, changeOrderValue, progressPercent, actualCosts, startDate, endDate]\n  )\n\n  const statusColors = {\n    healthy: '#10b981',\n    watch: '#f59e0b',\n    warning: '#f97316',\n    critical: '#ef4444'\n  }\n\n  const statusColor = statusColors[ev.healthStatus] || statusColors.watch\n\n  return (\n    <div className=\"ev-card\">\n      <div className=\"ev-card-header\">\n        <div className=\"ev-card-title\">\n          <Target size={18} />\n          <h3>Earned Value Analysis</h3>\n        </div>\n        <span className=\"ev-health-badge\" style={{ background: `${statusColor}18`, color: statusColor, borderColor: `${statusColor}40` }}>\n          {ev.healthStatus === 'healthy' ? 'Healthy' :\n           ev.healthStatus === 'watch' ? 'Watch' :\n           ev.healthStatus === 'warning' ? 'Warning' : 'Critical'}\n        </span>\n      </div>\n\n      {/* Performance Indices */}\n      <div className=\"ev-indices-row\">\n        <div className=\"ev-index-card\">\n          <div className=\"ev-index-header\">\n            <DollarSign size={14} />\n            <span>CPI</span>\n          </div>\n          <div className=\"ev-index-value\" style={{ color: ev.cpi >= 0.95 ? '#10b981' : ev.cpi >= 0.85 ? '#f59e0b' : '#ef4444' }}>\n            {ev.cpi.toFixed(2)}\n          </div>\n          <div className=\"ev-index-label\">{ev.cpiLabel}</div>\n        </div>\n\n        <div className=\"ev-index-card\">\n          <div className=\"ev-index-header\">\n            <Clock size={14} />\n            <span>SPI</span>\n          </div>\n          <div className=\"ev-index-value\" style={{ color: ev.spi >= 0.95 ? '#10b981' : ev.spi >= 0.85 ? '#f59e0b' : '#ef4444' }}>\n            {ev.spi.toFixed(2)}\n          </div>\n          <div className=\"ev-index-label\">{ev.spiLabel}</div>\n        </div>\n\n        <div className=\"ev-index-card\">\n          <div className=\"ev-index-header\">\n            {ev.vac >= 0 ? <TrendingUp size={14} /> : <TrendingDown size={14} />}\n            <span>EAC</span>\n          </div>\n          <div className=\"ev-index-value\">\n            {formatCurrency(ev.eac)}\n          </div>\n          <div className=\"ev-index-label\">Est. at Completion</div>\n        </div>\n\n        <div className=\"ev-index-card\">\n          <div className=\"ev-index-header\">\n            <Target size={14} />\n            <span>ETC</span>\n          </div>\n          <div className=\"ev-index-value\">\n            {formatCurrency(ev.etc)}\n          </div>\n          <div className=\"ev-index-label\">Est. to Complete</div>\n        </div>\n      </div>\n\n      {/* Variance Summary */}\n      <div className=\"ev-variance-row\">\n        <div className={`ev-variance-item ${ev.costVariance >= 0 ? 'positive' : 'negative'}`}>\n          <span className=\"ev-variance-label\">Cost Variance</span>\n          <span className=\"ev-variance-value\">\n            {ev.costVariance >= 0 ? '+' : ''}{formatCurrency(ev.costVariance)}\n          </span>\n        </div>\n        <div className={`ev-variance-item ${ev.scheduleVariance >= 0 ? 'positive' : 'negative'}`}>\n          <span className=\"ev-variance-label\">Schedule Variance</span>\n          <span className=\"ev-variance-value\">\n            {ev.scheduleVariance >= 0 ? '+' : ''}{formatCurrency(ev.scheduleVariance)}\n          </span>\n        </div>\n        <div className={`ev-variance-item ${ev.vac >= 0 ? 'positive' : 'negative'}`}>\n          <span className=\"ev-variance-label\">Variance at Completion</span>\n          <span className=\"ev-variance-value\">\n            {ev.vac >= 0 ? '+' : ''}{formatCurrency(ev.vac)}\n          </span>\n        </div>\n      </div>\n\n      {/* S-Curve Chart */}\n      {sCurveData.length > 0 && (\n        <div className=\"ev-chart-container\">\n          <ResponsiveContainer width=\"100%\" height={220}>\n            <LineChart data={sCurveData} margin={{ top: 8, right: 8, left: 0, bottom: 0 }}>\n              <XAxis\n                dataKey=\"date\"\n                tick={{ fontSize: 11, fill: 'var(--text-secondary)' }}\n                tickLine={false}\n                axisLine={{ stroke: 'var(--border-color)' }}\n              />\n              <YAxis\n                tickFormatter={formatChartCurrency}\n                tick={{ fontSize: 11, fill: 'var(--text-secondary)' }}\n                tickLine={false}\n                axisLine={false}\n                width={55}\n              />\n              <Tooltip\n                formatter={(value) => formatCurrency(value)}\n                contentStyle={tooltipStyle.contentStyle}\n                labelStyle={tooltipStyle.labelStyle}\n              />\n              <Legend\n                iconType=\"line\"\n                wrapperStyle={{ fontSize: 11, paddingTop: 4 }}\n              />\n              <Line\n                type=\"monotone\"\n                dataKey=\"plannedValue\"\n                stroke={chartColors.contract}\n                strokeDasharray=\"5 5\"\n                strokeWidth={2}\n                dot={false}\n                name=\"Planned Value\"\n              />\n              <Line\n                type=\"monotone\"\n                dataKey=\"earnedValue\"\n                stroke={chartColors.revenue}\n                strokeWidth={2}\n                dot={false}\n                name=\"Earned Value\"\n                connectNulls={false}\n              />\n              <Line\n                type=\"monotone\"\n                dataKey=\"actualCost\"\n                stroke={chartColors.costs}\n                strokeWidth={2}\n                dot={false}\n                name=\"Actual Cost\"\n                connectNulls={false}\n              />\n            </LineChart>\n          </ResponsiveContainer>\n        </div>\n      )}\n\n      {/* Projected End Date */}\n      {ev.projectedEndDate && endDate && (\n        <div className=\"ev-projection-row\">\n          <div className=\"ev-projection-item\">\n            <span className=\"ev-projection-label\">Planned End</span>\n            <span className=\"ev-projection-value\">{new Date(endDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</span>\n          </div>\n          <div className=\"ev-projection-item\">\n            <span className=\"ev-projection-label\">Projected End</span>\n            <span className=\"ev-projection-value\" style={{ color: ev.spi >= 0.95 ? '#10b981' : '#f59e0b' }}>\n              {new Date(ev.projectedEndDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}\n            </span>\n          </div>\n          {ev.tcpi > 1.1 && (\n            <div className=\"ev-projection-alert\">\n              <AlertTriangle size={14} />\n              <span>Need CPI of {ev.tcpi.toFixed(2)} to finish on budget</span>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n","import { useState, useEffect, useRef, useCallback, useMemo, lazy, Suspense } from 'react'\nimport { db } from '../lib/supabase'\nimport { safeAsync } from '../lib/errorHandler'\nimport { formatCurrency, calculateProgress, calculateValueProgress, getOverallStatus, getOverallStatusLabel, calculateScheduleInsights, shouldAutoArchive } from '../lib/utils'\nimport usePortfolioMetrics from '../hooks/usePortfolioMetrics'\nimport useProjectEdit from '../hooks/useProjectEdit'\nimport { exportAllFieldDocumentsPDF, exportDailyReportsPDF, exportIncidentReportsPDF, exportCrewCheckinsPDF } from '../lib/fieldDocumentExport'\nimport { exportProjectFinancials, exportToQuickBooksIIF } from '../lib/financialExport'\nimport { LayoutGrid, DollarSign, ClipboardList, HardHat, Truck, Info, FolderOpen, Search, Download, FileText, Menu, AlertTriangle, Package, Users, Shield, TrendingUp, TrendingDown, CheckCircle2, Camera, MapPin, Building2, Phone, ArrowRight } from 'lucide-react'\nimport UniversalSearch, { useUniversalSearch } from './UniversalSearch'\nimport { SmartAlerts } from './dashboard/SmartAlerts'\nimport OverviewProgressGauge from './overview/OverviewProgressGauge'\nimport OverviewFinancialCard from './overview/OverviewFinancialCard'\nimport OverviewCrewMetrics from './overview/OverviewCrewMetrics'\nimport HeroMetrics from './HeroMetrics'\nimport { TicketSkeleton } from './ui'\n\n// Financials components\nimport FinancialsNav from './FinancialsNav'\nimport { FinancialTrendChart } from './charts'\nimport ProfitabilityCard from './ProfitabilityCard'\nimport CostContributorsCard from './CostContributorsCard'\nimport DisposalSummary from './DisposalSummary'\nimport ProjectEquipmentCard from './equipment/ProjectEquipmentCard'\nimport ProgressBillingCard from './billing/ProgressBillingCard'\nimport ManDayCosts from './ManDayCosts'\nimport BurnRateCard from './BurnRateCard'\n\n// Reports components\nimport DailyReportsList from './DailyReportsList'\nimport InjuryReportsList from './InjuryReportsList'\n\n// Settings components\nimport ProjectTeam from './ProjectTeam'\nimport MFASetup from './MFASetup'\n\n// Lazy load modals and conditionally rendered heavy components\nconst ShareModal = lazy(() => import('./ShareModal'))\nconst NotificationSettings = lazy(() => import('./NotificationSettings'))\nconst CORForm = lazy(() => import('./cor/CORForm'))\nconst CORDetail = lazy(() => import('./cor/CORDetail'))\nconst CORLog = lazy(() => import('./cor/CORLog'))\nconst DrawRequestModal = lazy(() => import('./billing/DrawRequestModal'))\nconst EquipmentModal = lazy(() => import('./equipment/EquipmentModal'))\nconst AddCostModal = lazy(() => import('./AddCostModal'))\nconst DocumentsTab = lazy(() => import('./documents/DocumentsTab'))\nconst CORLogPreview = lazy(() => import('./cor/CORLogPreview'))\nconst CORList = lazy(() => import('./cor/CORList'))\nconst TMList = lazy(() => import('./TMList'))\nconst BillingCenter = lazy(() => import('./billing/BillingCenter'))\nconst PhotoTimeline = lazy(() => import('./PhotoTimeline'))\nconst PunchList = lazy(() => import('./PunchList'))\nimport EarnedValueCard from './charts/EarnedValueCard'\n\nexport default function Dashboard({ company, user, isAdmin, onShowToast, navigateToProjectId, onProjectNavigated }) {\n  const [projects, setProjects] = useState([])\n  const [projectsData, setProjectsData] = useState([]) // Enhanced data with areas/tickets\n  const [selectedProject, setSelectedProject] = useState(null)\n  const [areas, setAreas] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [showShareModal, setShowShareModal] = useState(false)\n  const [showNotificationSettings, setShowNotificationSettings] = useState(false)\n  const [activeProjectTab, setActiveProjectTab] = useState('overview')\n  const [financialsSection, setFinancialsSection] = useState('overview') // 'overview' | 'cors' | 'tickets'\n  const [financialsSidebarCollapsed, setFinancialsSidebarCollapsed] = useState(true) // Start collapsed for more real estate\n  const [financialsSidebarMobileOpen, setFinancialsSidebarMobileOpen] = useState(false) // For mobile sidebar overlay\n  const [corListExpanded, setCORListExpanded] = useState(false) // Whether the full card list is shown below the log\n  const [corDisplayMode, setCORDisplayMode] = useState('list') // 'list' | 'log' - for layout expansion\n  const [tmViewMode, setTMViewMode] = useState('preview') // 'preview' | 'full'\n  const [dumpSites, setDumpSites] = useState([])\n  const [showCORForm, setShowCORForm] = useState(false)\n  const [editingCOR, setEditingCOR] = useState(null)\n  const [showCORDetail, setShowCORDetail] = useState(false)\n  const [viewingCOR, setViewingCOR] = useState(null)\n  const [corRefreshKey, setCORRefreshKey] = useState(0)\n  const [showAddCostModal, setShowAddCostModal] = useState(false)\n  const [savingCost, setSavingCost] = useState(false)\n  const [showEquipmentModal, setShowEquipmentModal] = useState(false)\n  const [editingEquipment, setEditingEquipment] = useState(null)\n  const [equipmentRefreshKey, setEquipmentRefreshKey] = useState(0)\n  const [showDrawRequestModal, setShowDrawRequestModal] = useState(false)\n  const [editingDrawRequest, setEditingDrawRequest] = useState(null)\n  const [drawRequestRefreshKey, setDrawRequestRefreshKey] = useState(0)\n\n  // Universal Search (Cmd+K)\n  const { isOpen: isSearchOpen, setIsOpen: setSearchOpen, close: closeSearch } = useUniversalSearch()\n\n  // Portfolio metrics (extracted hook)\n  const { portfolioMetrics, projectHealth, scheduleMetrics, riskAnalysis } = usePortfolioMetrics(projectsData)\n\n  // Project edit mode (extracted hook)\n  const {\n    editMode, editData, saving,\n    handleEditClick, handleCancelEdit, handleEditChange,\n    handleAreaEditChange, handleAddArea, handleRemoveArea,\n    handleSaveEdit, handleDeleteProject\n  } = useProjectEdit({ selectedProject, areas, company, onShowToast, loadAreas, setSelectedProject })\n\n  // Debounce ref to prevent cascading refreshes from multiple subscription callbacks\n  // When multiple real-time events fire rapidly, this coalesces them into a single refresh\n  const refreshTimeoutRef = useRef(null)\n  const pendingAreasRefreshRef = useRef(false)\n  const pendingCORRefreshRef = useRef(false)\n\n  // Cache for project details to avoid re-fetching when switching between projects\n  // Key: projectId, Value: { data: enhancedProjectData, timestamp: Date.now() }\n  const projectDetailsCacheRef = useRef(new Map())\n  const CACHE_TTL_MS = 5 * 60 * 1000 // 5 minute cache TTL\n\n  // Debounced refresh function that coalesces multiple rapid refresh requests\n  // This prevents 5+ loadProjects() calls when multiple subscriptions fire at once\n  const debouncedRefresh = useCallback((options = {}) => {\n    const { refreshAreas = false, refreshCOR = false, projectId = null } = options\n\n    // Track what needs refreshing\n    if (refreshAreas && projectId) pendingAreasRefreshRef.current = projectId\n    if (refreshCOR) pendingCORRefreshRef.current = true\n\n    // Clear any pending refresh\n    if (refreshTimeoutRef.current) {\n      clearTimeout(refreshTimeoutRef.current)\n    }\n\n    // Schedule a single refresh after debounce period (150ms)\n    // This is fast enough to feel \"live\" but prevents cascading calls\n    refreshTimeoutRef.current = setTimeout(async () => {\n      // Execute pending refreshes\n      if (pendingAreasRefreshRef.current) {\n        await loadAreas(pendingAreasRefreshRef.current)\n        pendingAreasRefreshRef.current = false\n      }\n      if (pendingCORRefreshRef.current) {\n        setCORRefreshKey(prev => prev + 1)\n        pendingCORRefreshRef.current = false\n      }\n      // Always refresh projects to update metrics\n      await loadProjects()\n    }, 150)\n  }, [])\n\n  // Cleanup debounce timeout on unmount\n  useEffect(() => {\n    return () => {\n      if (refreshTimeoutRef.current) {\n        clearTimeout(refreshTimeoutRef.current)\n      }\n    }\n  }, [])\n\n  // Initial load\n  useEffect(() => {\n    if (company?.id) {\n      loadProjects()\n      loadDumpSites()\n    }\n  }, [company?.id])\n\n  // Track project IDs for subscription stability (avoids re-subscribing on every projects array change)\n  const projectIdsRef = useRef([])\n  const projectIdsKey = projects.map(p => p.id).sort().join(',')\n\n  // Real-time subscription - runs after projects are loaded\n  useEffect(() => {\n    if (!company?.id || projects.length === 0) return\n\n    // Only update ref if project IDs actually changed\n    const currentIds = projects.map(p => p.id).sort()\n    projectIdsRef.current = currentIds\n\n    // Subscribe to company-wide activity to refresh metrics in real-time\n    // Uses debounced refresh to coalesce rapid updates from multiple sources\n    const subscription = db.subscribeToCompanyActivity?.(company.id, currentIds, {\n      onMessage: () => debouncedRefresh(),\n      onMaterialRequest: () => debouncedRefresh(),\n      onTMTicket: () => debouncedRefresh(),\n      onCrewCheckin: () => debouncedRefresh(), // Crew check-ins affect labor costs\n      onAreaUpdate: () => debouncedRefresh(), // Area updates affect progress\n      onCORChange: () => debouncedRefresh({ refreshCOR: true }), // COR changes\n      onInjuryReport: () => debouncedRefresh(),\n      onProjectChange: () => debouncedRefresh(), // Project details changed\n      onMaterialsEquipmentChange: () => debouncedRefresh(), // Pricing updates\n      onLaborRateChange: () => debouncedRefresh(), // Labor rate updates\n      onPunchListChange: () => debouncedRefresh() // Punch list items created/resolved by field\n    })\n\n    return () => {\n      if (subscription) {\n        db.unsubscribe?.(subscription)\n      }\n    }\n  }, [company?.id, projectIdsKey, debouncedRefresh])\n\n  // Prevent body scroll when mobile sidebar is open\n  useEffect(() => {\n    if (financialsSidebarMobileOpen) {\n      document.body.style.overflow = 'hidden'\n    } else {\n      document.body.style.overflow = ''\n    }\n\n    return () => {\n      document.body.style.overflow = ''\n    }\n  }, [financialsSidebarMobileOpen])\n\n  const loadDumpSites = async () => {\n    try {\n      const sites = await db.getDumpSites(company.id)\n      setDumpSites(sites || [])\n    } catch (error) {\n      console.error('Error loading dump sites:', error)\n    }\n  }\n\n  // Handle navigation from notifications\n  // Use a ref to prevent re-running this effect when projects data refreshes\n  const lastNavigatedIdRef = useRef(null)\n  useEffect(() => {\n    if (navigateToProjectId && navigateToProjectId !== lastNavigatedIdRef.current && projects.length > 0) {\n      const project = projects.find(p => p.id === navigateToProjectId)\n      if (project) {\n        lastNavigatedIdRef.current = navigateToProjectId\n        setSelectedProject(project)\n        onProjectNavigated?.() // Clear the navigation request\n      }\n    }\n  }, [navigateToProjectId, projects, onProjectNavigated])\n\n  useEffect(() => {\n    if (selectedProject) {\n      loadAreas(selectedProject.id)\n\n      // Subscribe to real-time updates for the selected project\n      // All callbacks use debouncedRefresh to prevent cascading refreshes\n      const subscriptions = []\n      const projectId = selectedProject.id\n\n      // Areas subscription - also refreshes areas list\n      const areasSub = db.subscribeToAreas?.(projectId, () => {\n        debouncedRefresh({ refreshAreas: true, projectId })\n      })\n      if (areasSub) subscriptions.push(areasSub)\n\n      // Daily reports subscription\n      const dailyReportsSub = db.subscribeToDailyReports?.(projectId, () => {\n        debouncedRefresh()\n      })\n      if (dailyReportsSub) subscriptions.push(dailyReportsSub)\n\n      // Crew checkins subscription (affects labor costs)\n      const checkinsSub = db.subscribeToCrewCheckins?.(projectId, () => {\n        debouncedRefresh()\n      })\n      if (checkinsSub) subscriptions.push(checkinsSub)\n\n      // Haul offs subscription\n      const haulOffsSub = db.subscribeToHaulOffs?.(projectId, () => {\n        debouncedRefresh()\n      })\n      if (haulOffsSub) subscriptions.push(haulOffsSub)\n\n      // CORs subscription - also refreshes COR list\n      const corsSub = db.subscribeToCORs?.(projectId, () => {\n        debouncedRefresh({ refreshCOR: true })\n      })\n      if (corsSub) subscriptions.push(corsSub)\n\n      return () => {\n        subscriptions.forEach(sub => db.unsubscribe?.(sub))\n      }\n    }\n  }, [selectedProject, debouncedRefresh])\n\n  // When navigating to tickets section, switch to full mode to show dashboard\n  useEffect(() => {\n    if (financialsSection === 'tickets') {\n      setTMViewMode('full')\n    }\n  }, [financialsSection])\n\n  // Load detailed data for a single project (on-demand, with caching)\n  // This replaces the previous N+1 pattern where ALL project details were loaded upfront\n  const loadProjectDetails = async (project, forceRefresh = false) => {\n    const cacheKey = project.id\n    const cached = projectDetailsCacheRef.current.get(cacheKey)\n\n    // Return cached data if valid and not forcing refresh\n    if (cached && !forceRefresh && (Date.now() - cached.timestamp) < CACHE_TTL_MS) {\n      return cached.data\n    }\n\n    try {\n      // Fetch detailed project data in parallel (12 queries for 1 project, not 12N)\n      const [\n        projectAreas,\n        tickets,\n        changeOrderData,\n        dailyReports,\n        injuryReports,\n        laborCosts,\n        haulOffCosts,\n        customCosts,\n        corStats,\n        crewHistory,\n        materialRequests,\n        weeklyDisposal\n      ] = await Promise.all([\n        safeAsync(() => db.getAreas(project.id), { fallback: [], context: { operation: 'getAreas', projectId: project.id } }),\n        safeAsync(() => db.getTMTickets(project.id), { fallback: [], context: { operation: 'getTMTickets', projectId: project.id } }),\n        safeAsync(() => db.getChangeOrderTotals(project.id), { fallback: null, context: { operation: 'getChangeOrderTotals', projectId: project.id } }),\n        safeAsync(() => db.getDailyReports(project.id, 100), { fallback: [], context: { operation: 'getDailyReports', projectId: project.id } }),\n        safeAsync(() => db.getInjuryReports(project.id), { fallback: [], context: { operation: 'getInjuryReports', projectId: project.id } }),\n        safeAsync(() => db.calculateManDayCosts(project.id, company?.id, project.work_type || 'demolition', project.job_type || 'standard'), { fallback: null, context: { operation: 'calculateManDayCosts', projectId: project.id } }),\n        safeAsync(() => db.calculateHaulOffCosts(project.id), { fallback: null, context: { operation: 'calculateHaulOffCosts', projectId: project.id } }),\n        safeAsync(() => db.getProjectCosts(project.id), { fallback: [], context: { operation: 'getProjectCosts', projectId: project.id } }),\n        safeAsync(() => db.getCORStats(project.id), { fallback: null, context: { operation: 'getCORStats', projectId: project.id } }),\n        safeAsync(() => db.getCrewCheckinHistory(project.id, 60), { fallback: [], context: { operation: 'getCrewCheckinHistory', projectId: project.id } }),\n        safeAsync(() => db.getMaterialRequests(project.id), { fallback: [], context: { operation: 'getMaterialRequests', projectId: project.id } }),\n        safeAsync(() => db.getWeeklyDisposalSummary(project.id, 4), { fallback: [], context: { operation: 'getWeeklyDisposalSummary', projectId: project.id } })\n      ])\n\n      // Calculate progress - use SOV values if available\n      const progressData = calculateValueProgress(projectAreas)\n      const progress = progressData.progress\n\n      // Calculate revised contract value\n      const changeOrderValue = changeOrderData?.totalApprovedValue || 0\n      const revisedContractValue = project.contract_value + changeOrderValue\n\n      // Billable calculation\n      const billable = progressData.isValueBased\n        ? progressData.earnedValue\n        : (progress / 100) * revisedContractValue\n      const pendingTickets = tickets.filter(t => t.status === 'pending').length\n\n      // Recent activity\n      const oneWeekAgo = new Date()\n      oneWeekAgo.setDate(oneWeekAgo.getDate() - 7)\n      const recentDailyReports = dailyReports.filter(r => new Date(r.report_date) >= oneWeekAgo).length\n\n      // Custom costs\n      const customCostTotal = customCosts.reduce((sum, c) => {\n        const amount = parseFloat(c.amount)\n        return sum + (isNaN(amount) ? 0 : amount)\n      }, 0)\n\n      // Materials/equipment costs from T&M\n      let materialsEquipmentCost = 0\n      const materialsEquipmentByDate = {}\n      tickets.forEach(ticket => {\n        const ticketDate = ticket.work_date || ticket.ticket_date || ticket.created_at?.split('T')[0]\n        const items = ticket.t_and_m_items || ticket.items || []\n        let ticketMaterialsCost = 0\n        items.forEach(item => {\n          const qty = parseFloat(item.quantity) || 1\n          const cost = parseFloat(item.unit_cost) || parseFloat(item.materials_equipment?.cost_per_unit) || 0\n          ticketMaterialsCost += qty * cost\n        })\n        if (ticketMaterialsCost > 0 && ticketDate) {\n          materialsEquipmentCost += ticketMaterialsCost\n          if (!materialsEquipmentByDate[ticketDate]) {\n            materialsEquipmentByDate[ticketDate] = { date: ticketDate, cost: 0 }\n          }\n          materialsEquipmentByDate[ticketDate].cost += ticketMaterialsCost\n        }\n      })\n      const materialsEquipmentByDateArray = Object.values(materialsEquipmentByDate)\n        .sort((a, b) => new Date(b.date) - new Date(a.date))\n\n      // Total costs\n      const laborCost = laborCosts?.totalCost || 0\n      const haulOffCost = haulOffCosts?.totalCost || 0\n      const allCostsTotal = laborCost + haulOffCost + materialsEquipmentCost + customCostTotal\n\n      // Profit calculations\n      const currentProfit = billable - allCostsTotal\n      const profitMargin = billable > 0 ? (currentProfit / billable) * 100 : 0\n\n      // Burn rate\n      const laborDays = laborCosts?.byDate?.length || 0\n      const materialsDays = materialsEquipmentByDateArray.length\n      const totalBurnDays = Math.max(laborDays, materialsDays)\n      const totalBurn = laborCost + haulOffCost + materialsEquipmentCost + customCostTotal\n      const dailyBurn = totalBurnDays > 0 ? totalBurn / totalBurnDays : 0\n\n      // Schedule insights\n      const scheduleInsights = calculateScheduleInsights(\n        { ...project, progress },\n        laborCosts?.totalManDays || 0\n      )\n\n      // Crew analytics from check-in history\n      const crewByDate = {}\n      const uniqueWorkers = new Set()\n      ;(crewHistory || []).forEach(checkin => {\n        const workers = checkin.workers || []\n        crewByDate[checkin.check_in_date] = workers.length\n        workers.forEach(w => uniqueWorkers.add(w.name?.toLowerCase()))\n      })\n      const crewDates = Object.keys(crewByDate).sort()\n      const avgCrewSize = crewDates.length > 0\n        ? Math.round(crewDates.reduce((sum, d) => sum + crewByDate[d], 0) / crewDates.length * 10) / 10\n        : 0\n      const peakCrewSize = crewDates.length > 0\n        ? Math.max(...crewDates.map(d => crewByDate[d]))\n        : 0\n      // Crew trend: compare last 7 days avg to prior 7 days avg\n      const recentCrewDates = crewDates.slice(-7)\n      const priorCrewDates = crewDates.slice(-14, -7)\n      const recentCrewAvg = recentCrewDates.length > 0\n        ? recentCrewDates.reduce((s, d) => s + crewByDate[d], 0) / recentCrewDates.length\n        : 0\n      const priorCrewAvg = priorCrewDates.length > 0\n        ? priorCrewDates.reduce((s, d) => s + crewByDate[d], 0) / priorCrewDates.length\n        : 0\n\n      // Material request analytics\n      const pendingMaterialRequests = (materialRequests || []).filter(r => r.status === 'pending').length\n      const orderedMaterialRequests = (materialRequests || []).filter(r => r.status === 'ordered').length\n      const deliveredMaterialRequests = (materialRequests || []).filter(r => r.status === 'delivered').length\n      const urgentMaterialRequests = (materialRequests || []).filter(r => r.priority === 'urgent' && r.status === 'pending').length\n\n      // Daily report field notes analysis\n      const reportsWithIssues = dailyReports.filter(r => r.issues && r.issues.trim().length > 0).length\n      const totalPhotosFromTickets = tickets.reduce((sum, t) => sum + (t.photos?.length || 0), 0)\n\n      // Disposal totals from weekly data\n      const disposalTotalLoads = (weeklyDisposal || []).reduce((sum, w) => {\n        return sum + (w.concrete || 0) + (w.trash || 0) + (w.metals || 0) + (w.hazardous_waste || 0)\n      }, 0)\n\n      // Days since last injury\n      const lastInjuryDate = injuryReports.length > 0\n        ? new Date(injuryReports[0]?.incident_date || injuryReports[0]?.created_at)\n        : null\n      const daysSinceLastInjury = lastInjuryDate\n        ? Math.floor((new Date() - lastInjuryDate) / (1000 * 60 * 60 * 24))\n        : null\n\n      // Task completion velocity: areas completed in last 14 days vs prior 14 days\n      const completedAreas = projectAreas.filter(a => a.status === 'done')\n\n      const enhancedData = {\n        ...project,\n        areas: projectAreas,\n        progress,\n        billable,\n        changeOrderValue,\n        revisedContractValue,\n        changeOrderPending: changeOrderData?.pendingCount || 0,\n        totalTickets: tickets.length,\n        pendingTickets,\n        approvedTickets: tickets.filter(t => t.status === 'approved').length,\n        tmTickets: tickets,\n        dailyReportsCount: dailyReports.length,\n        recentDailyReports,\n        injuryReportsCount: injuryReports.length,\n        lastDailyReport: dailyReports[0]?.report_date || null,\n        isValueBased: progressData.isValueBased,\n        earnedValue: progressData.earnedValue,\n        totalSOVValue: progressData.totalValue,\n        laborCost,\n        laborDaysWorked: laborDays,\n        laborManDays: laborCosts?.totalManDays || 0,\n        laborByDate: laborCosts?.byDate || [],\n        dailyBurn,\n        materialsEquipmentCost,\n        materialsEquipmentByDate: materialsEquipmentByDateArray,\n        haulOffCost,\n        haulOffLoads: haulOffCosts?.totalLoads || 0,\n        haulOffDays: haulOffCosts?.daysWithHaulOff || 0,\n        haulOffByType: haulOffCosts?.byWasteType || {},\n        haulOffByDate: haulOffCosts?.byDate || [],\n        customCosts,\n        customCostTotal,\n        totalBurn,\n        totalBurnDays,\n        allCostsTotal,\n        currentProfit,\n        profitMargin,\n        corPendingValue: corStats?.total_pending_value || 0,\n        corPendingCount: corStats?.pending_count || 0,\n        corApprovedValue: corStats?.total_approved_value || 0,\n        corBilledValue: corStats?.total_billed_value || 0,\n        corTotalCount: corStats?.total_cors || 0,\n        corStats: corStats,\n        scheduleStatus: scheduleInsights.scheduleStatus,\n        scheduleVariance: scheduleInsights.scheduleVariance,\n        scheduleLabel: scheduleInsights.scheduleLabel,\n        laborStatus: scheduleInsights.laborStatus,\n        laborVariance: scheduleInsights.laborVariance,\n        laborLabel: scheduleInsights.laborLabel,\n        hasScheduleData: scheduleInsights.hasScheduleData,\n        hasLaborData: scheduleInsights.hasLaborData,\n        actualManDays: laborCosts?.totalManDays || 0,\n        // Crew analytics\n        crewHistory: crewHistory || [],\n        crewByDate,\n        uniqueWorkerCount: uniqueWorkers.size,\n        avgCrewSize,\n        peakCrewSize,\n        crewDaysTracked: crewDates.length,\n        crewTrend: priorCrewAvg > 0 ? ((recentCrewAvg - priorCrewAvg) / priorCrewAvg * 100) : 0,\n        recentCrewAvg,\n        // Material requests\n        materialRequests: materialRequests || [],\n        pendingMaterialRequests,\n        orderedMaterialRequests,\n        deliveredMaterialRequests,\n        urgentMaterialRequests,\n        totalMaterialRequests: (materialRequests || []).length,\n        // Field activity insights\n        reportsWithIssues,\n        totalPhotosFromTickets,\n        dailyReports,\n        // Disposal trends\n        weeklyDisposal: weeklyDisposal || [],\n        disposalTotalLoads,\n        // Safety analytics\n        daysSinceLastInjury,\n        injuryReports,\n        oshaRecordable: injuryReports.filter(r => r.osha_recordable).length,\n        // Completion\n        completedAreasCount: completedAreas.length,\n        hasError: false,\n        _detailsLoaded: true\n      }\n\n      // Cache the enhanced data\n      projectDetailsCacheRef.current.set(cacheKey, {\n        data: enhancedData,\n        timestamp: Date.now()\n      })\n\n      return enhancedData\n    } catch (error) {\n      console.error(`Error loading details for project ${project.id}:`, error)\n      return { ...project, hasError: true, _detailsLoaded: false }\n    }\n  }\n\n  // OPTIMIZED: Load projects with summary data only (1 query instead of 9N)\n  // Detailed data is loaded on-demand when a project is selected\n  const loadProjects = async () => {\n    try {\n      // Single optimized query for all project summaries\n      const data = await db.getProjectDashboardSummary(company?.id)\n      setProjects(data)\n\n      // Create lightweight enhanced data using ONLY summary metrics from the RPC\n      // This uses data already returned from getProjectDashboardSummary (no additional queries!)\n      // Detailed data is loaded on-demand via loadProjectDetails when a project is selected\n      const enhanced = data.map(project => {\n        // Check if we have cached detailed data for this project\n        const cached = projectDetailsCacheRef.current.get(project.id)\n        if (cached && (Date.now() - cached.timestamp) < CACHE_TTL_MS) {\n          // Use cached detailed data if still valid\n          return cached.data\n        }\n\n        // Use summary data from RPC (no additional queries needed)\n        // Progress is estimated from area counts in the summary\n        const totalAreas = project.areaCount || 0\n        const completedAreas = project.completedAreas || 0\n        const progress = totalAreas > 0 ? Math.round((completedAreas / totalAreas) * 100) : 0\n\n        return {\n          ...project,\n          // Basic metrics from summary (already loaded)\n          progress,\n          areas: [], // Loaded on-demand when project selected\n          totalTickets: project.ticketCount || 0,\n          pendingTickets: project.pendingTicketCount || 0,\n          approvedTickets: project.approvedTicketCount || 0,\n          dailyReportsCount: project.dailyReportsThisWeek || 0,\n          recentDailyReports: project.dailyReportsThisWeek || 0,\n          corTotalCount: project.corCount || 0,\n          // Placeholder values - loaded on-demand when selected\n          billable: 0,\n          changeOrderValue: 0,\n          revisedContractValue: project.contract_value || 0,\n          changeOrderPending: 0,\n          tmTickets: [],\n          injuryReportsCount: 0,\n          lastDailyReport: null,\n          isValueBased: false,\n          earnedValue: 0,\n          totalSOVValue: 0,\n          laborCost: 0,\n          laborDaysWorked: 0,\n          laborManDays: 0,\n          laborByDate: [],\n          dailyBurn: 0,\n          materialsEquipmentCost: 0,\n          materialsEquipmentByDate: [],\n          haulOffCost: 0,\n          haulOffLoads: 0,\n          haulOffDays: 0,\n          haulOffByType: {},\n          haulOffByDate: [],\n          customCosts: [],\n          customCostTotal: 0,\n          totalBurn: 0,\n          totalBurnDays: 0,\n          allCostsTotal: 0,\n          currentProfit: 0,\n          profitMargin: 0,\n          corPendingValue: 0,\n          corPendingCount: 0,\n          corApprovedValue: 0,\n          corBilledValue: 0,\n          corStats: null,\n          scheduleStatus: 'on_track',\n          scheduleVariance: 0,\n          scheduleLabel: 'On Track',\n          laborStatus: 'on_track',\n          laborVariance: 0,\n          laborLabel: null,\n          hasScheduleData: false,\n          hasLaborData: false,\n          actualManDays: 0,\n          hasError: false,\n          _detailsLoaded: false // Flag to indicate detailed data needs loading\n        }\n      })\n      setProjectsData(enhanced)\n    } catch (error) {\n      console.error('Error loading projects:', error)\n      onShowToast('Error loading projects', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  async function loadAreas(projectId) {\n    try {\n      const data = await db.getAreas(projectId)\n      setAreas(data)\n    } catch (error) {\n      console.error('Error loading areas:', error)\n    }\n  }\n\n  const handleSelectProject = async (project) => {\n    // Set the project immediately for responsive UI\n    setSelectedProject(project)\n\n    // If detailed data hasn't been loaded yet, load it now (lazy loading)\n    if (!project._detailsLoaded) {\n      const detailedProject = await loadProjectDetails(project)\n\n      // Update projectsData with the detailed version\n      setProjectsData(prev => prev.map(p =>\n        p.id === project.id ? detailedProject : p\n      ))\n\n      // Update selectedProject with detailed data\n      setSelectedProject(detailedProject)\n    }\n  }\n\n  const handleBack = () => {\n    setSelectedProject(null)\n    setAreas([])\n    handleCancelEdit()\n    setActiveProjectTab('overview')\n    loadProjects()\n  }\n\n  // Edit handlers provided by useProjectEdit hook\n\n  // Memoize selected project data lookup to avoid repeated finds\n  // NOTE: All hooks must be before any conditional returns (React rules of hooks)\n  const projectData = useMemo(() => {\n    if (!selectedProject) return null\n    return projectsData.find(p => p.id === selectedProject.id)\n  }, [selectedProject, projectsData])\n\n  // Memoize progress calculations - these are expensive and only change when areas change\n  const progressCalculations = useMemo(() => {\n    if (!selectedProject) {\n      return { progress: 0, billable: 0, isValueBased: false, earnedValue: 0, totalSOVValue: 0, changeOrderValue: 0, revisedContractValue: 0 }\n    }\n\n    // Calculate progress - use SOV values if available\n    const progressData = calculateValueProgress(areas)\n    const progress = progressData.progress\n\n    // Get change order data from enhanced project data\n    const changeOrderValue = projectData?.changeOrderValue || 0\n    const revisedContractValue = selectedProject.contract_value + changeOrderValue\n\n    // Billable: use actual earned value from SOV if available\n    const billable = progressData.isValueBased\n      ? progressData.earnedValue\n      : (progress / 100) * revisedContractValue\n\n    return {\n      progress,\n      billable,\n      changeOrderValue,\n      revisedContractValue,\n      isValueBased: progressData.isValueBased,\n      earnedValue: progressData.earnedValue,\n      totalSOVValue: progressData.totalValue\n    }\n  }, [selectedProject, areas, projectData])\n\n  // Portfolio metrics, project health, schedule metrics, and risk analysis\n  // provided by usePortfolioMetrics hook\n\n  // Handler for alert actions\n  const handleAlertAction = useCallback(({ target, projectId, alert }) => {\n    const project = projects.find(p => p.id === projectId)\n    if (project) {\n      setSelectedProject(project)\n      // Navigate to appropriate tab based on action target\n      if (target === 'financials') {\n        setActiveProjectTab('financials')\n      } else if (target === 'reports') {\n        setActiveProjectTab('reports')\n      } else if (target === 'cors') {\n        setActiveProjectTab('financials')\n        setFinancialsSection('cors')\n      } else {\n        setActiveProjectTab('overview')\n      }\n    }\n  }, [projects])\n\n  // Auto-archive projects that have been complete for 30+ days\n  useEffect(() => {\n    const checkAutoArchive = async () => {\n      for (const project of projectsData) {\n        if (shouldAutoArchive(project, 30)) {\n          try {\n            await db.archiveProject(project.id)\n            onShowToast(`Project \"${project.name}\" has been auto-archived after 30 days of completion`, 'info')\n          } catch (error) {\n            console.error('Failed to auto-archive project:', error)\n          }\n        }\n      }\n    }\n\n    if (projectsData.length > 0) {\n      checkAutoArchive()\n    }\n  }, []) // Only run on mount\n\n  // Memoized callbacks for child components to prevent unnecessary re-renders\n  const handleAddEquipment = useCallback(() => {\n    setEditingEquipment(null)\n    setShowEquipmentModal(true)\n  }, [])\n\n  const handleEditEquipment = useCallback((item) => {\n    setEditingEquipment(item)\n    setShowEquipmentModal(true)\n  }, [])\n\n  const handleCreateDraw = useCallback(() => {\n    setEditingDrawRequest(null)\n    setShowDrawRequestModal(true)\n  }, [])\n\n  const handleViewDraw = useCallback((drawRequest) => {\n    setEditingDrawRequest(drawRequest)\n    setShowDrawRequestModal(true)\n  }, [])\n\n  const handleViewAllTickets = useCallback(() => {\n    setTMViewMode('full')\n  }, [])\n\n  const handleToggleFinancialsSidebar = useCallback(() => {\n    setFinancialsSidebarCollapsed(prev => !prev)\n  }, [])\n\n  const handleToggleMobileSidebar = useCallback(() => {\n    setFinancialsSidebarMobileOpen(prev => !prev)\n  }, [])\n\n  const handleCloseMobileSidebar = useCallback(() => {\n    setFinancialsSidebarMobileOpen(false)\n  }, [])\n\n  const handleToggleCORList = useCallback(() => {\n    setCORListExpanded(prev => !prev)\n  }, [])\n\n  // Field document export handler\n  const handleExportFieldDocuments = useCallback(async (type = 'all') => {\n    if (!selectedProject) return\n    onShowToast('Gathering field data...', 'info')\n    try {\n      const [dailyReports, injuryReports, crewCheckins] = await Promise.all([\n        db.getDailyReports(selectedProject.id, 365),\n        db.getInjuryReports(selectedProject.id),\n        db.getCrewCheckinHistory(selectedProject.id, 365)\n      ])\n\n      if (type === 'daily') {\n        await exportDailyReportsPDF(dailyReports || [], selectedProject)\n      } else if (type === 'incidents') {\n        await exportIncidentReportsPDF(injuryReports || [], selectedProject)\n      } else if (type === 'crew') {\n        await exportCrewCheckinsPDF(crewCheckins || [], selectedProject)\n      } else {\n        await exportAllFieldDocumentsPDF({\n          dailyReports: dailyReports || [],\n          incidentReports: injuryReports || [],\n          crewCheckins: crewCheckins || [],\n          project: selectedProject\n        })\n      }\n      onShowToast('PDF exported!', 'success')\n    } catch (error) {\n      console.error('Error exporting field documents:', error)\n      onShowToast('Error generating PDF', 'error')\n    }\n  }, [selectedProject, onShowToast])\n\n  const handleBackToTMPreview = useCallback(() => {\n    setTMViewMode('preview')\n  }, [])\n\n  const handleViewFullCORLog = useCallback(() => {\n    setCORDisplayMode('log')\n  }, [])\n\n  const handleCreateCOR = useCallback(() => {\n    setEditingCOR(null)\n    setShowCORForm(true)\n  }, [])\n\n  const handleViewCOR = useCallback((cor) => {\n    setViewingCOR(cor)\n    setShowCORDetail(true)\n  }, [])\n\n  const handleEditCOR = useCallback((cor) => {\n    setEditingCOR(cor)\n    setShowCORForm(true)\n  }, [])\n\n  const handleAddCost = useCallback(() => {\n    setShowAddCostModal(true)\n  }, [])\n\n  const handleDeleteCost = useCallback(async (costId) => {\n    try {\n      await db.deleteProjectCost(costId)\n      loadProjects()\n      onShowToast?.('Cost deleted', 'success')\n    } catch (err) {\n      onShowToast?.('Error deleting cost', 'error')\n    }\n  }, []) // onShowToast is stable (memoized in App.jsx)\n\n  // Memoize stats for FinancialsNav to prevent re-renders from inline object creation\n  const financialsNavStats = useMemo(() => ({\n    corCount: projectData?.corTotalCount || 0,\n    ticketCount: projectData?.totalTickets || 0,\n    corPending: projectData?.corPendingCount || 0,\n    ticketPending: projectData?.pendingTickets || 0\n  }), [projectData?.corTotalCount, projectData?.totalTickets, projectData?.corPendingCount, projectData?.pendingTickets])\n\n  // Destructure memoized values for cleaner usage below\n  const { totalOriginalContract, totalChangeOrders, totalPortfolioValue, totalEarned, totalRemaining, weightedCompletion, totalPendingCORValue, totalPendingCORCount } = portfolioMetrics\n  const { projectsComplete, projectsOnTrack, projectsAtRisk, projectsOverBudget, projectsWithChangeOrders } = projectHealth\n  const { scheduleAhead, scheduleOnTrack, scheduleBehind, laborOver, laborUnder, laborOnTrack, hasAnyScheduleData, hasAnyLaborData } = scheduleMetrics\n\n  if (loading) {\n    return (\n      <div className=\"loading\">\n        <div className=\"spinner\"></div>\n        Loading projects...\n      </div>\n    )\n  }\n\n  // Project Detail View\n  if (selectedProject) {\n    // Extract memoized values\n    const { progress, billable, changeOrderValue, revisedContractValue, isValueBased, earnedValue, totalSOVValue } = progressCalculations\n\n    // Edit Mode\n    if (editMode && editData) {\n      const totalWeight = editData.areas.reduce((sum, a) => sum + (parseFloat(a.weight) || 0), 0)\n\n      return (\n        <div>\n          <button className=\"btn btn-secondary btn-small\" onClick={handleCancelEdit} style={{ marginBottom: '1.5rem' }}>\n             Cancel\n          </button>\n\n          <h1>Edit Project</h1>\n          <p className=\"subtitle\">Update project details</p>\n\n          {/* Basic Info */}\n          <div className=\"card\">\n            <h3>Basic Info</h3>\n            <div className=\"form-row\">\n              <div className=\"form-group\" style={{ flex: 2 }}>\n                <label>Project Name *</label>\n                <input\n                  type=\"text\"\n                  value={editData.name}\n                  onChange={(e) => handleEditChange('name', e.target.value)}\n                  placeholder=\"e.g., Downtown Office Demolition\"\n                />\n              </div>\n              <div className=\"form-group\" style={{ flex: 1 }}>\n                <label>Job Number</label>\n                <input\n                  type=\"text\"\n                  value={editData.job_number}\n                  onChange={(e) => handleEditChange('job_number', e.target.value)}\n                  placeholder=\"e.g., 2024-001\"\n                />\n              </div>\n            </div>\n\n            <div className=\"form-group\">\n              <label>Project Address</label>\n              <input\n                type=\"text\"\n                value={editData.address}\n                onChange={(e) => handleEditChange('address', e.target.value)}\n                placeholder=\"123 Main St, City, State 12345\"\n              />\n            </div>\n          </div>\n\n          {/* Client & Contractor Info */}\n          <div className=\"card\">\n            <h3>Client & Contractor</h3>\n            <div className=\"form-group\">\n              <label>General Contractor</label>\n              <input\n                type=\"text\"\n                value={editData.general_contractor}\n                onChange={(e) => handleEditChange('general_contractor', e.target.value)}\n                placeholder=\"e.g., ABC Construction\"\n              />\n            </div>\n\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Client Contact</label>\n                <input\n                  type=\"text\"\n                  value={editData.client_contact}\n                  onChange={(e) => handleEditChange('client_contact', e.target.value)}\n                  placeholder=\"Contact name\"\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Client Phone</label>\n                <input\n                  type=\"tel\"\n                  value={editData.client_phone}\n                  onChange={(e) => handleEditChange('client_phone', e.target.value)}\n                  placeholder=\"(555) 123-4567\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Financial & Project Settings */}\n          <div className=\"card\">\n            <h3>Financials & Settings</h3>\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Contract Value ($) *</label>\n                <input\n                  type=\"number\"\n                  value={editData.contract_value}\n                  onChange={(e) => handleEditChange('contract_value', e.target.value)}\n                  placeholder=\"0\"\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Foreman PIN</label>\n                <input\n                  type=\"text\"\n                  value={editData.pin}\n                  onChange={(e) => handleEditChange('pin', e.target.value.replace(/\\D/g, '').slice(0, 4))}\n                  placeholder=\"4 digits\"\n                  maxLength={4}\n                />\n                <span className=\"form-hint\">Used for field crew access</span>\n              </div>\n            </div>\n\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Work Type</label>\n                <select\n                  value={editData.work_type}\n                  onChange={(e) => handleEditChange('work_type', e.target.value)}\n                >\n                  <option value=\"demolition\">Demolition</option>\n                  <option value=\"environmental\">Environmental</option>\n                </select>\n                <span className=\"form-hint\">Affects labor rate calculations</span>\n              </div>\n              <div className=\"form-group\">\n                <label>Job Type</label>\n                <select\n                  value={editData.job_type}\n                  onChange={(e) => handleEditChange('job_type', e.target.value)}\n                >\n                  <option value=\"standard\">Standard</option>\n                  <option value=\"prevailing_wage\">Prevailing Wage</option>\n                </select>\n              </div>\n            </div>\n\n            <div className=\"form-group\">\n              <label>Default Dump Site</label>\n              <select\n                value={editData.default_dump_site_id}\n                onChange={(e) => handleEditChange('default_dump_site_id', e.target.value)}\n              >\n                <option value=\"\">-- Select Dump Site --</option>\n                {dumpSites.map(site => (\n                  <option key={site.id} value={site.id}>{site.name}</option>\n                ))}\n              </select>\n              <span className=\"form-hint\">Used for haul-off tracking and cost estimates</span>\n            </div>\n          </div>\n\n          <div className=\"card\">\n            <h3>Areas</h3>\n            <p style={{ color: 'var(--text-secondary)', fontSize: '0.9rem', marginBottom: '1rem' }}>\n              Weights must total 100%.\n            </p>\n\n            {editData.areas.map((area, index) => (\n              <div key={index} className=\"area-row\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Area name\"\n                  value={area.name}\n                  onChange={(e) => handleAreaEditChange(index, 'name', e.target.value)}\n                />\n                <input\n                  type=\"number\"\n                  placeholder=\"%\"\n                  value={area.weight}\n                  onChange={(e) => handleAreaEditChange(index, 'weight', e.target.value)}\n                />\n                <button className=\"remove-btn\" onClick={() => handleRemoveArea(index)}>\n                  \n                </button>\n              </div>\n            ))}\n\n            <div className=\"weight-total\">\n              <span className=\"weight-total-label\">Total Weight:</span>\n              <span className={`weight-total-value ${totalWeight === 100 ? 'valid' : 'invalid'}`}>\n                {totalWeight}%\n              </span>\n            </div>\n\n            <button className=\"btn btn-secondary\" onClick={handleAddArea}>\n              + Add Area\n            </button>\n          </div>\n\n          <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem' }}>\n            <button \n              className=\"btn btn-primary\" \n              onClick={handleSaveEdit}\n              disabled={saving}\n              style={{ flex: 1 }}\n            >\n              {saving ? 'Saving...' : 'Save Changes'}\n            </button>\n          </div>\n\n          <button\n            className=\"btn btn-danger btn-full\"\n            onClick={() => handleDeleteProject(loadProjects)}\n          >\n            Delete Project\n          </button>\n        </div>\n      )\n    }\n\n    // View Mode - Calculate additional metrics for context\n    const areasComplete = areas.filter(a => a.status === 'done').length\n    const areasWorking = areas.filter(a => a.status === 'working').length\n    const areasNotStarted = areas.filter(a => a.status === 'not_started').length\n    const percentBilled = revisedContractValue > 0\n      ? Math.round((billable / revisedContractValue) * 100)\n      : 0\n    const hasChangeOrders = changeOrderValue > 0\n\n    // Tab definitions with pending badges\n    const pendingCount = (projectData?.pendingTickets || 0) + (projectData?.changeOrderPending || 0)\n    const tabs = [\n      { id: 'overview', label: 'Overview', Icon: LayoutGrid },\n      { id: 'financials', label: 'Financials', Icon: DollarSign, badge: pendingCount },\n      { id: 'reports', label: 'Reports', Icon: ClipboardList },\n      { id: 'documents', label: 'Documents', Icon: FolderOpen },\n      { id: 'info', label: 'Info', Icon: Info }\n    ]\n\n    return (\n      <div className=\"project-view tabbed\">\n        {/* Sticky Header */}\n        <div className=\"pv-sticky-header\">\n          {/* Top Row - Back + Actions */}\n          <div className=\"pv-header-row\">\n            <button className=\"pv-back\" onClick={handleBack}>\n              <span></span>\n              <span>Back</span>\n            </button>\n            <div className=\"pv-actions\">\n              <button className=\"pv-action\" onClick={() => setShowShareModal(true)}>Share</button>\n              <button className=\"pv-action\" onClick={() => setShowNotificationSettings(true)}>Alerts</button>\n              <button className=\"pv-action\" onClick={handleEditClick}>Edit</button>\n            </div>\n          </div>\n\n          {/* Project Title */}\n          <div className=\"pv-header-title\">\n            <h1>{selectedProject.name}</h1>\n            {(selectedProject.job_number || selectedProject.work_type) && (\n              <span className=\"pv-header-meta\">\n                {selectedProject.job_number && `Job #${selectedProject.job_number}`}\n                {selectedProject.job_number && selectedProject.work_type && '  '}\n                {selectedProject.work_type}\n              </span>\n            )}\n          </div>\n\n          {/* Key Metrics Bar */}\n          <div className=\"pv-metrics-bar\">\n            <div className=\"pv-metric\">\n              <span className=\"pv-metric-value\">{progress}%</span>\n              <span className=\"pv-metric-label\">Complete</span>\n            </div>\n            <div className=\"pv-metric-divider\"></div>\n            <div className=\"pv-metric\">\n              <span className=\"pv-metric-value\">{formatCurrency(billable)}</span>\n              <span className=\"pv-metric-label\">Billed</span>\n            </div>\n            <div className=\"pv-metric-divider\"></div>\n            <div className=\"pv-metric\">\n              <span className=\"pv-metric-value highlight\">{formatCurrency(revisedContractValue - billable)}</span>\n              <span className=\"pv-metric-label\">Remaining</span>\n            </div>\n          </div>\n\n          {/* Tab Navigation */}\n          <div className=\"pv-tabs\">\n            {tabs.map(tab => (\n              <button\n                key={tab.id}\n                className={`pv-tab ${activeProjectTab === tab.id ? 'active' : ''} ${tab.badge > 0 ? 'has-badge' : ''}`}\n                onClick={() => setActiveProjectTab(tab.id)}\n              >\n                <tab.Icon size={16} className=\"pv-tab-icon\" />\n                <span className=\"pv-tab-label\">{tab.label}</span>\n                {tab.badge > 0 && (\n                  <span className=\"pv-tab-badge\">{tab.badge}</span>\n                )}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Tab Content */}\n        <div className=\"pv-tab-content\">\n          {/* OVERVIEW TAB */}\n          {activeProjectTab === 'overview' && (\n            <div className=\"pv-tab-panel overview-tab animate-fade-in\">\n              {/* Row 1: Hero - Progress + Financials */}\n              <div className=\"overview-hero-split\">\n                <OverviewProgressGauge\n                  progress={progress}\n                  areasComplete={areasComplete}\n                  totalAreas={areas.length}\n                  areasWorking={areasWorking}\n                />\n                <OverviewFinancialCard\n                  earnedRevenue={billable}\n                  totalCosts={projectData?.allCostsTotal || 0}\n                  laborCost={projectData?.laborCost || 0}\n                  disposalCost={projectData?.haulOffCost || 0}\n                  equipmentCost={projectData?.materialsEquipmentCost || 0}\n                  materialsCost={0}\n                  otherCost={projectData?.customCostTotal || 0}\n                  contractValue={revisedContractValue}\n                />\n              </div>\n\n              {/* Row 2: Two-column grid - Crew Metrics | Work Areas */}\n              <div className=\"overview-two-col\">\n                {/* Left: Crew On-Site */}\n                <OverviewCrewMetrics\n                  project={selectedProject}\n                  onShowToast={onShowToast}\n                />\n\n                {/* Right: Work Areas */}\n                <div className=\"overview-section-card overview-work-areas-card\">\n                  <div className=\"section-card-header\">\n                    <h3>Work Areas</h3>\n                    <div className=\"section-card-badges\">\n                      {areasComplete > 0 && <span className=\"section-badge done\">{areasComplete} Done</span>}\n                      {areasWorking > 0 && <span className=\"section-badge working\">{areasWorking} Active</span>}\n                      {areasNotStarted > 0 && <span className=\"section-badge pending\">{areasNotStarted} Pending</span>}\n                    </div>\n                  </div>\n                  <div className=\"work-areas-list work-areas-scroll stagger-areas\">\n                    {areas.map(area => (\n                      <div key={area.id} className={`work-area-item ${area.status}`}>\n                        <div className=\"work-area-status\">\n                          {area.status === 'done' && <span className=\"status-icon done\"></span>}\n                          {area.status === 'working' && <span className=\"status-icon working\"></span>}\n                          {area.status === 'not_started' && <span className=\"status-icon pending\"></span>}\n                        </div>\n                        <div className=\"work-area-info\">\n                          <span className=\"work-area-name\">{area.name}</span>\n                          <span className=\"work-area-weight\">\n                            {area.scheduled_value ? formatCurrency(area.scheduled_value) : `${area.weight}%`}\n                          </span>\n                        </div>\n                        <div className=\"work-area-bar\">\n                          <div\n                            className={`work-area-fill ${area.status}`}\n                            style={{ width: area.status === 'done' ? '100%' : area.status === 'working' ? '50%' : '0%' }}\n                          ></div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              </div>\n\n              {/* Row 3: Earned Value Analysis */}\n              {selectedProject?.contract_value > 0 && (\n                <EarnedValueCard\n                  contractValue={selectedProject.contract_value}\n                  changeOrderValue={changeOrderValue}\n                  progressPercent={progress}\n                  actualCosts={projectData?.allCostsTotal || 0}\n                  startDate={selectedProject.start_date}\n                  endDate={selectedProject.end_date}\n                  areas={areas}\n                />\n              )}\n\n              {/* Row 4: Needs Attention (only shown when there are items) */}\n              {(projectData?.pendingTickets > 0 || projectData?.changeOrderPending > 0 || projectData?.pendingMaterialRequests > 0 || projectData?.urgentMaterialRequests > 0) && (\n                <div className=\"overview-needs-attention\">\n                  <div className=\"overview-needs-attention__header\">\n                    <AlertTriangle size={15} className=\"overview-needs-attention__icon\" />\n                    <span className=\"overview-needs-attention__title\">Needs Attention</span>\n                    <span className=\"overview-needs-attention__count\">\n                      {[projectData?.urgentMaterialRequests > 0, !projectData?.urgentMaterialRequests && projectData?.pendingMaterialRequests > 0, projectData?.pendingTickets > 0, projectData?.changeOrderPending > 0].filter(Boolean).length}\n                    </span>\n                  </div>\n                  <div className=\"overview-needs-attention__items\">\n                    {projectData?.urgentMaterialRequests > 0 && (\n                      <button className=\"overview-needs-attention__item overview-needs-attention__item--warning\" onClick={() => setActiveProjectTab('reports')}>\n                        <AlertTriangle size={14} className=\"overview-needs-attention__item-icon\" />\n                        <span className=\"overview-needs-attention__item-label\">{projectData.urgentMaterialRequests} urgent material request{projectData.urgentMaterialRequests !== 1 ? 's' : ''}</span>\n                        <ArrowRight size={13} className=\"overview-needs-attention__item-arrow\" />\n                      </button>\n                    )}\n                    {projectData?.pendingMaterialRequests > 0 && !projectData?.urgentMaterialRequests && (\n                      <button className=\"overview-needs-attention__item overview-needs-attention__item--info\" onClick={() => setActiveProjectTab('reports')}>\n                        <Package size={14} className=\"overview-needs-attention__item-icon\" />\n                        <span className=\"overview-needs-attention__item-label\">{projectData.pendingMaterialRequests} material request{projectData.pendingMaterialRequests !== 1 ? 's' : ''} pending</span>\n                        <ArrowRight size={13} className=\"overview-needs-attention__item-arrow\" />\n                      </button>\n                    )}\n                    {projectData?.pendingTickets > 0 && (\n                      <button className=\"overview-needs-attention__item overview-needs-attention__item--warning\" onClick={() => setActiveProjectTab('financials')}>\n                        <ClipboardList size={14} className=\"overview-needs-attention__item-icon\" />\n                        <span className=\"overview-needs-attention__item-label\">{projectData.pendingTickets} Time & Material ticket{projectData.pendingTickets !== 1 ? 's' : ''} need approval</span>\n                        <ArrowRight size={13} className=\"overview-needs-attention__item-arrow\" />\n                      </button>\n                    )}\n                    {projectData?.changeOrderPending > 0 && (\n                      <button className=\"overview-needs-attention__item overview-needs-attention__item--info\" onClick={() => setActiveProjectTab('financials')}>\n                        <FileText size={14} className=\"overview-needs-attention__item-icon\" />\n                        <span className=\"overview-needs-attention__item-label\">{projectData.changeOrderPending} change order{projectData.changeOrderPending !== 1 ? 's' : ''} pending</span>\n                        <ArrowRight size={13} className=\"overview-needs-attention__item-arrow\" />\n                      </button>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {/* Row 5: Photo Timeline + Punch List */}\n              <div className=\"overview-two-col\">\n                <Suspense fallback={<div style={{ padding: '20px', textAlign: 'center', color: 'var(--text-secondary)' }}>Loading photos...</div>}>\n                  <PhotoTimeline\n                    projectId={selectedProject?.id}\n                    areas={areas}\n                    onShowToast={onShowToast}\n                  />\n                </Suspense>\n                <Suspense fallback={<div style={{ padding: '20px', textAlign: 'center', color: 'var(--text-secondary)' }}>Loading punch list...</div>}>\n                  <PunchList\n                    projectId={selectedProject?.id}\n                    areas={areas}\n                    companyId={company?.id}\n                    onShowToast={onShowToast}\n                  />\n                </Suspense>\n              </div>\n\n              {/* Row 6: Quick Nav + Exports */}\n              <div className=\"overview-bottom-strip\">\n                <div className=\"overview-quick-actions\">\n                  <button className=\"overview-action-btn\" onClick={() => setActiveProjectTab('reports')}>\n                    <ClipboardList size={15} />\n                    <span>{projectData?.dailyReportsCount || 0} Reports</span>\n                  </button>\n                  <button className=\"overview-action-btn\" onClick={() => setActiveProjectTab('financials')}>\n                    <DollarSign size={15} />\n                    <span>{projectData?.totalTickets || 0} Time & Material Tickets</span>\n                  </button>\n                  <span className=\"overview-action-divider\" />\n                  <button className=\"overview-action-btn export\" onClick={() => handleExportFieldDocuments('all')}>\n                    <Download size={15} />\n                    <span>Export All</span>\n                  </button>\n                  <button className=\"overview-action-btn export\" onClick={() => handleExportFieldDocuments('daily')}>\n                    <Download size={14} />\n                    <span>Daily</span>\n                  </button>\n                  <button className=\"overview-action-btn export\" onClick={() => handleExportFieldDocuments('incidents')}>\n                    <Download size={14} />\n                    <span>Incidents</span>\n                  </button>\n                  <button className=\"overview-action-btn export\" onClick={() => handleExportFieldDocuments('crew')}>\n                    <Download size={14} />\n                    <span>Crew</span>\n                  </button>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* FINANCIALS TAB */}\n          {activeProjectTab === 'financials' && (\n            <div className=\"pv-tab-panel financials-tab\">\n              {/* Export Actions */}\n              <div className=\"export-actions\" style={{ display: 'flex', gap: '8px', marginLeft: 'auto', marginBottom: '12px', justifyContent: 'flex-end' }}>\n                <button\n                  className=\"btn btn-ghost btn-small\"\n                  onClick={() => exportProjectFinancials(selectedProject, {\n                    earnedRevenue: billable,\n                    approvedCORs: null,\n                    laborByDate: projectData?.laborByDate,\n                    haulOffByDate: projectData?.haulOffByDate,\n                    customCosts: projectData?.customCosts\n                  })}\n                >\n                  <Download size={14} /> Export CSV\n                </button>\n                <button\n                  className=\"btn btn-ghost btn-small\"\n                  onClick={() => exportToQuickBooksIIF(selectedProject, {\n                    totalLaborCost: projectData?.laborCost || 0,\n                    totalDisposalCost: projectData?.haulOffCost || 0\n                  })}\n                >\n                  <Download size={14} /> QuickBooks\n                </button>\n              </div>\n              {/* Key Metrics - Hero Section (Always visible) */}\n              <HeroMetrics\n                contractValue={selectedProject?.contract_value || 0}\n                earnedRevenue={billable}\n                totalCosts={projectData?.allCostsTotal || 0}\n                profit={projectData?.currentProfit || 0}\n                progress={progress}\n                corApprovedValue={changeOrderValue}\n                loading={!projectData}\n              />\n\n              {/* Split Layout with Collapsible Navigation */}\n              <div className={`financials-layout ${financialsSidebarCollapsed ? 'sidebar-collapsed' : ''}`}>\n                {/* Mobile Menu Toggle Button */}\n                <button\n                  className=\"financials-mobile-menu-toggle\"\n                  onClick={handleToggleMobileSidebar}\n                  aria-label=\"Open navigation menu\"\n                  title=\"Open navigation menu\"\n                >\n                  <Menu size={20} />\n                  <span>Menu</span>\n                </button>\n\n                {/* Mobile Overlay/Backdrop */}\n                {financialsSidebarMobileOpen && (\n                  <div\n                    className=\"financials-sidebar-overlay\"\n                    onClick={handleCloseMobileSidebar}\n                    aria-hidden=\"true\"\n                  />\n                )}\n\n                {/* Sidebar Navigation - Always visible, collapsible */}\n                <div className={`financials-sidebar ${financialsSidebarCollapsed ? 'collapsed' : ''} ${financialsSidebarMobileOpen ? 'mobile-open' : ''}`}>\n                  <FinancialsNav\n                    activeSection={financialsSection}\n                    onSectionChange={(section) => {\n                      setFinancialsSection(section)\n                      setFinancialsSidebarMobileOpen(false) // Close mobile sidebar when section changes\n                    }}\n                    collapsed={financialsSidebarCollapsed}\n                    onToggleCollapse={handleToggleFinancialsSidebar}\n                    onMobileClose={handleCloseMobileSidebar}\n                    stats={financialsNavStats}\n                  />\n                </div>\n\n                {/* Main Content Area */}\n                <div className=\"financials-main\">\n                  {/* OVERVIEW SECTION */}\n                  {financialsSection === 'overview' && (\n                    <div className=\"financials-overview animate-fade-in\">\n                      {/* Financial Trend Chart */}\n                      <FinancialTrendChart\n                        projectData={projectData}\n                        project={selectedProject}\n                        tmTickets={projectData?.tmTickets || []}\n                        corStats={projectData?.corStats}\n                        areas={areas}\n                        changeOrderValue={changeOrderValue}\n                      />\n\n                      {/* Burn Rate & Profitability Row */}\n                      <div className=\"financials-analysis-row stagger-children\">\n                        <BurnRateCard\n                          dailyBurn={projectData?.dailyBurn || 0}\n                          totalBurn={projectData?.totalBurn || 0}\n                          daysWorked={projectData?.totalBurnDays || 0}\n                          laborCost={projectData?.laborCost || 0}\n                          materialsEquipmentCost={projectData?.materialsEquipmentCost || 0}\n                          disposalCost={projectData?.haulOffCost || 0}\n                          customCostTotal={projectData?.customCostTotal || 0}\n                          progress={progress}\n                          contractValue={revisedContractValue}\n                          laborByDate={projectData?.laborByDate || []}\n                          materialsEquipmentByDate={projectData?.materialsEquipmentByDate || []}\n                        />\n\n                        <ProfitabilityCard\n                          revenue={billable}\n                          totalCosts={projectData?.allCostsTotal || 0}\n                          contractValue={revisedContractValue}\n                          progress={progress}\n                        />\n                      </div>\n\n                      {/* Cost Contributors & Disposal Summary Side-by-Side */}\n                      <div className=\"cost-disposal-row\">\n                        <CostContributorsCard\n                          laborCost={projectData?.laborCost || 0}\n                          haulOffCost={projectData?.haulOffCost || 0}\n                          materialsEquipmentCost={projectData?.materialsEquipmentCost || 0}\n                          customCosts={projectData?.customCosts || []}\n                          onAddCost={handleAddCost}\n                          onDeleteCost={handleDeleteCost}\n                        />\n\n                        <DisposalSummary\n                          project={selectedProject}\n                          period=\"week\"\n                        />\n                      </div>\n\n                      {/* Equipment Tracking */}\n                      <ProjectEquipmentCard\n                        key={equipmentRefreshKey}\n                        project={selectedProject}\n                        onAddEquipment={handleAddEquipment}\n                        onEditEquipment={handleEditEquipment}\n                        onShowToast={onShowToast}\n                      />\n\n                      {/* Progress Billing / Draw Requests */}\n                      <ProgressBillingCard\n                        key={drawRequestRefreshKey}\n                        project={selectedProject}\n                        areas={areas}\n                        corStats={projectData?.corStats}\n                        onCreateDraw={handleCreateDraw}\n                        onViewDraw={handleViewDraw}\n                        onShowToast={onShowToast}\n                      />\n\n                      {/* Labor Details - Collapsible */}\n                      <details className=\"financials-details\">\n                        <summary className=\"financials-details-summary\">\n                          <HardHat size={16} />\n                          <span>Labor Details</span>\n                          <span className=\"financials-details-value\">{formatCurrency(projectData?.laborCost || 0)}</span>\n                        </summary>\n                        <div className=\"financials-details-content\">\n                          <ManDayCosts project={selectedProject} company={company} onShowToast={onShowToast} />\n                        </div>\n                      </details>\n                    </div>\n                  )}\n\n                  {/* CHANGE ORDERS SECTION */}\n                  {financialsSection === 'cors' && (\n                    <div className=\"financials-cors animate-fade-in\">\n                      {/* COR Log - Always visible first */}\n                      <div className=\"financials-section cor-section-primary\">\n                        <Suspense fallback={<TicketSkeleton />}>\n                          <CORLogPreview\n                            project={selectedProject}\n                            onShowToast={onShowToast}\n                            onToggleList={handleToggleCORList}\n                            showingList={corListExpanded}\n                            onViewFullLog={handleViewFullCORLog}\n                            onCreateCOR={handleCreateCOR}\n                          />\n                        </Suspense>\n                      </div>\n\n                      {/* Full COR Card List - Expands below the log when toggled */}\n                      {corListExpanded && (\n                        <div className=\"financials-section cor-section-list animate-fade-in\" style={{ marginTop: '1rem' }}>\n                          <Suspense fallback={<TicketSkeleton />}>\n                            <CORList\n                              project={selectedProject}\n                              company={company}\n                              areas={areas}\n                              refreshKey={corRefreshKey}\n                              onShowToast={onShowToast}\n                              previewMode={false}\n                              onViewAll={handleToggleCORList}\n                              onDisplayModeChange={setCORDisplayMode}\n                              onCreateCOR={handleCreateCOR}\n                              onViewCOR={handleViewCOR}\n                              onEditCOR={handleEditCOR}\n                            />\n                          </Suspense>\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {/* T&M TICKETS SECTION */}\n                  {financialsSection === 'tickets' && (\n                    <div className=\"financials-tickets animate-fade-in\">\n                      <div className=\"financials-section tm-section\">\n                        {tmViewMode === 'full' && (\n                          <button\n                            className=\"section-back-btn\"\n                            onClick={handleBackToTMPreview}\n                          >\n                             Back to summary\n                          </button>\n                        )}\n                        <Suspense fallback={<TicketSkeleton />}>\n                          <TMList\n                            project={selectedProject}\n                            company={company}\n                            onShowToast={onShowToast}\n                            compact={tmViewMode === 'preview'}\n                            previewMode={tmViewMode === 'preview'}\n                            onViewAll={handleViewAllTickets}\n                          />\n                        </Suspense>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* BILLING SECTION */}\n                  {financialsSection === 'billing' && (\n                    <div className=\"financials-billing animate-fade-in\">\n                      <Suspense fallback={<TicketSkeleton />}>\n                        <BillingCenter\n                          project={selectedProject}\n                          company={company}\n                          user={user}\n                          onShowToast={onShowToast}\n                        />\n                      </Suspense>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* REPORTS TAB */}\n          {activeProjectTab === 'reports' && (\n            <div className=\"pv-tab-panel reports-tab\">\n              {/* Hero Metrics - High Level Project Pulse */}\n              <div className=\"reports-hero\">\n                <div className=\"reports-hero-grid\">\n                  {/* Total Reports */}\n                  <div className=\"reports-metric primary\">\n                    <div className=\"reports-metric-icon\">\n                      <ClipboardList size={24} />\n                    </div>\n                    <div className=\"reports-metric-content\">\n                      <div className=\"reports-metric-value\">{projectData?.dailyReportsCount || 0}</div>\n                      <div className=\"reports-metric-label\">Daily Reports</div>\n                    </div>\n                  </div>\n\n                  {/* This Week */}\n                  <div className=\"reports-metric\">\n                    <div className=\"reports-metric-value\">{projectData?.recentDailyReports || 0}</div>\n                    <div className=\"reports-metric-label\">This Week</div>\n                    <div className=\"reports-metric-bar\">\n                      <div\n                        className=\"reports-metric-fill\"\n                        style={{ width: `${Math.min((projectData?.recentDailyReports || 0) / 7 * 100, 100)}%` }}\n                      ></div>\n                    </div>\n                  </div>\n\n                  {/* T&M Tickets */}\n                  <div className=\"reports-metric\">\n                    <div className=\"reports-metric-value\">{projectData?.totalTickets || 0}</div>\n                    <div className=\"reports-metric-label\">Time & Material</div>\n                    {(projectData?.pendingTickets || 0) > 0 && (\n                      <div className=\"reports-metric-status\" style={{ background: '#fef3c7', color: '#92400e' }}>\n                        {projectData.pendingTickets} pending\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Photo Evidence */}\n                  <div className=\"reports-metric\">\n                    <div className=\"reports-metric-value\">{projectData?.totalPhotosFromTickets || 0}</div>\n                    <div className=\"reports-metric-label\">Photos Captured</div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Two-Column Layout: Crew + Safety */}\n              <div className=\"reports-two-col\">\n                {/* Crew Analytics Card */}\n                <div className=\"reports-insight-card\">\n                  <div className=\"reports-insight-header\">\n                    <div className=\"reports-insight-title\">\n                      <Users size={18} />\n                      <h3>Crew Analytics</h3>\n                    </div>\n                  </div>\n                  <div className=\"reports-insight-body\">\n                    <div className=\"reports-stat-grid\">\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.uniqueWorkerCount || 0}</span>\n                        <span className=\"reports-stat-label\">Total Workers</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.avgCrewSize || 0}</span>\n                        <span className=\"reports-stat-label\">Avg Crew / Day</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.peakCrewSize || 0}</span>\n                        <span className=\"reports-stat-label\">Peak Crew Size</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.crewDaysTracked || 0}</span>\n                        <span className=\"reports-stat-label\">Days Tracked</span>\n                      </div>\n                    </div>\n                    {(projectData?.crewTrend || 0) !== 0 && (\n                      <div className={`reports-trend-badge ${projectData.crewTrend > 0 ? 'up' : 'down'}`}>\n                        {projectData.crewTrend > 0 ? <TrendingUp size={14} /> : <TrendingDown size={14} />}\n                        <span>{Math.abs(Math.round(projectData.crewTrend))}% {projectData.crewTrend > 0 ? 'increase' : 'decrease'} vs prior week</span>\n                      </div>\n                    )}\n                    {/* Mini crew size bar chart */}\n                    {projectData?.crewByDate && Object.keys(projectData.crewByDate).length > 0 && (\n                      <div className=\"reports-mini-chart\">\n                        <div className=\"reports-mini-chart-label\">Recent Crew Size</div>\n                        <div className=\"reports-mini-bars\">\n                          {Object.keys(projectData.crewByDate).sort().slice(-14).map(date => {\n                            const count = projectData.crewByDate[date]\n                            const max = projectData.peakCrewSize || 1\n                            return (\n                              <div key={date} className=\"reports-mini-bar-wrap\" title={`${new Date(date + 'T12:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}: ${count} workers`}>\n                                <div className=\"reports-mini-bar\" style={{ height: `${(count / max) * 100}%` }}></div>\n                              </div>\n                            )\n                          })}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Safety Dashboard Card */}\n                <div className=\"reports-insight-card\">\n                  <div className=\"reports-insight-header\">\n                    <div className=\"reports-insight-title\">\n                      <Shield size={18} />\n                      <h3>Safety Dashboard</h3>\n                    </div>\n                    <span className={`reports-section-badge ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n                      {(projectData?.injuryReportsCount || 0) > 0\n                        ? `${projectData.injuryReportsCount} incident${projectData.injuryReportsCount !== 1 ? 's' : ''}`\n                        : 'No incidents'\n                      }\n                    </span>\n                  </div>\n                  <div className=\"reports-insight-body\">\n                    {/* Days Since Last Injury - prominent */}\n                    <div className=\"reports-safety-hero\">\n                      <div className={`reports-safety-days ${(projectData?.daysSinceLastInjury === null || projectData?.daysSinceLastInjury > 30) ? 'excellent' : projectData?.daysSinceLastInjury > 7 ? 'good' : 'caution'}`}>\n                        <span className=\"reports-safety-days-value\">\n                          {projectData?.daysSinceLastInjury !== null ? projectData.daysSinceLastInjury : '--'}\n                        </span>\n                        <span className=\"reports-safety-days-label\">\n                          {projectData?.daysSinceLastInjury !== null ? 'Days Since Last Incident' : 'No Incidents Recorded'}\n                        </span>\n                      </div>\n                    </div>\n                    <div className=\"reports-stat-grid\">\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.injuryReportsCount || 0}</span>\n                        <span className=\"reports-stat-label\">Total Incidents</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.oshaRecordable || 0}</span>\n                        <span className=\"reports-stat-label\">OSHA Recordable</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.reportsWithIssues || 0}</span>\n                        <span className=\"reports-stat-label\">Reports w/ Issues</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.laborManDays || 0}</span>\n                        <span className=\"reports-stat-label\">Total Man-Days</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Material Requests + Disposal Summary Row */}\n              <div className=\"reports-two-col\">\n                {/* Material Requests */}\n                <div className=\"reports-insight-card\">\n                  <div className=\"reports-insight-header\">\n                    <div className=\"reports-insight-title\">\n                      <Package size={18} />\n                      <h3>Material Requests</h3>\n                    </div>\n                    <span className=\"reports-section-count\">{projectData?.totalMaterialRequests || 0} total</span>\n                  </div>\n                  <div className=\"reports-insight-body\">\n                    {(projectData?.totalMaterialRequests || 0) === 0 ? (\n                      <div className=\"reports-empty-state\">\n                        <Package size={32} />\n                        <p>No material requests yet</p>\n                        <span>Requests from the field will appear here</span>\n                      </div>\n                    ) : (\n                      <>\n                        <div className=\"reports-material-pipeline\">\n                          {projectData?.urgentMaterialRequests > 0 && (\n                            <div className=\"reports-material-status urgent\">\n                              <AlertTriangle size={14} />\n                              <span>{projectData.urgentMaterialRequests} Urgent</span>\n                            </div>\n                          )}\n                          <div className=\"reports-material-status pending\">\n                            <span className=\"reports-material-dot\"></span>\n                            <span>{projectData?.pendingMaterialRequests || 0} Pending</span>\n                          </div>\n                          <div className=\"reports-material-status ordered\">\n                            <span className=\"reports-material-dot\"></span>\n                            <span>{projectData?.orderedMaterialRequests || 0} Ordered</span>\n                          </div>\n                          <div className=\"reports-material-status delivered\">\n                            <CheckCircle2 size={14} />\n                            <span>{projectData?.deliveredMaterialRequests || 0} Delivered</span>\n                          </div>\n                        </div>\n                        {/* Recent requests */}\n                        <div className=\"reports-recent-list\">\n                          {(projectData?.materialRequests || []).slice(0, 3).map(req => (\n                            <div key={req.id} className={`reports-recent-item ${req.status}`}>\n                              <div className=\"reports-recent-item-main\">\n                                <span className={`reports-recent-item-status ${req.status}`}>{req.status}</span>\n                                <span className=\"reports-recent-item-date\">\n                                  {new Date(req.created_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                                </span>\n                              </div>\n                              <div className=\"reports-recent-item-detail\">\n                                {(req.items || []).slice(0, 2).map((item, i) => (\n                                  <span key={i}>{item.name}{item.quantity ? ` (${item.quantity})` : ''}</span>\n                                ))}\n                                {(req.items || []).length > 2 && (\n                                  <span className=\"reports-recent-more\">+{(req.items || []).length - 2} more</span>\n                                )}\n                              </div>\n                              {req.priority === 'urgent' && (\n                                <span className=\"reports-urgent-tag\">URGENT</span>\n                              )}\n                            </div>\n                          ))}\n                        </div>\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                {/* Disposal Trends */}\n                <div className=\"reports-insight-card\">\n                  <div className=\"reports-insight-header\">\n                    <div className=\"reports-insight-title\">\n                      <Truck size={18} />\n                      <h3>Disposal Trends</h3>\n                    </div>\n                    <span className=\"reports-section-count\">{projectData?.disposalTotalLoads || 0} loads</span>\n                  </div>\n                  <div className=\"reports-insight-body\">\n                    {(projectData?.weeklyDisposal || []).length === 0 ? (\n                      <div className=\"reports-empty-state\">\n                        <Truck size={32} />\n                        <p>No disposal data yet</p>\n                        <span>Disposal loads from the field will appear here</span>\n                      </div>\n                    ) : (\n                      <>\n                        {/* Stacked weekly bar chart */}\n                        <div className=\"reports-disposal-chart\">\n                          <div className=\"reports-disposal-bars\">\n                            {(projectData?.weeklyDisposal || []).map((week, i) => {\n                              const total = (week.concrete || 0) + (week.trash || 0) + (week.metals || 0) + (week.hazardous_waste || 0)\n                              const maxWeek = Math.max(...(projectData?.weeklyDisposal || []).map(w => (w.concrete || 0) + (w.trash || 0) + (w.metals || 0) + (w.hazardous_waste || 0))) || 1\n                              return (\n                                <div key={i} className=\"reports-disposal-bar-col\">\n                                  <div className=\"reports-disposal-bar-stack\" style={{ height: `${(total / maxWeek) * 100}%` }}>\n                                    {week.concrete > 0 && <div className=\"reports-disposal-seg concrete\" style={{ flex: week.concrete }} title={`Concrete: ${week.concrete}`}></div>}\n                                    {week.trash > 0 && <div className=\"reports-disposal-seg trash\" style={{ flex: week.trash }} title={`Trash: ${week.trash}`}></div>}\n                                    {week.metals > 0 && <div className=\"reports-disposal-seg metals\" style={{ flex: week.metals }} title={`Metals: ${week.metals}`}></div>}\n                                    {week.hazardous_waste > 0 && <div className=\"reports-disposal-seg hazardous\" style={{ flex: week.hazardous_waste }} title={`Hazardous: ${week.hazardous_waste}`}></div>}\n                                  </div>\n                                  <span className=\"reports-disposal-bar-label\">\n                                    {new Date(week.week + 'T12:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                                  </span>\n                                </div>\n                              )\n                            })}\n                          </div>\n                          <div className=\"reports-disposal-legend\">\n                            <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot concrete\"></span>Concrete</span>\n                            <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot trash\"></span>Trash</span>\n                            <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot metals\"></span>Metals</span>\n                            <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot hazardous\"></span>Hazardous</span>\n                          </div>\n                        </div>\n                        {/* Haul-off cost summary */}\n                        {(projectData?.haulOffCost || 0) > 0 && (\n                          <div className=\"reports-disposal-cost\">\n                            <span>Total Disposal Cost</span>\n                            <strong>{formatCurrency(projectData.haulOffCost)}</strong>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n              </div>\n\n              {/* Field Activity Summary */}\n              <div className=\"reports-insight-card reports-activity-summary\">\n                <div className=\"reports-insight-header\">\n                  <div className=\"reports-insight-title\">\n                    <ClipboardList size={18} />\n                    <h3>Field Activity Summary</h3>\n                  </div>\n                  <div className=\"reports-activity-badges\">\n                    {projectData?.lastDailyReport && (\n                      <span className=\"reports-last-filed\">\n                        Last report: {new Date(projectData.lastDailyReport).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                        {' '}({Math.floor((new Date() - new Date(projectData.lastDailyReport)) / (1000 * 60 * 60 * 24))}d ago)\n                      </span>\n                    )}\n                  </div>\n                </div>\n                <div className=\"reports-insight-body\">\n                  <div className=\"reports-activity-grid\">\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><ClipboardList size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.dailyReportsCount || 0}</strong>\n                        <span>Daily Reports Filed</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><FileText size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.totalTickets || 0}</strong>\n                        <span>Time & Material Tickets</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><Camera size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.totalPhotosFromTickets || 0}</strong>\n                        <span>Photos Documented</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><HardHat size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.completedAreasCount || 0}/{areas.length}</strong>\n                        <span>Work Areas Complete</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><DollarSign size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{formatCurrency(projectData?.allCostsTotal || 0)}</strong>\n                        <span>Total Costs Tracked</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><Users size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.laborManDays || 0}</strong>\n                        <span>Total Man-Days</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Daily Reports Section */}\n              <div className=\"reports-section-card\">\n                <div className=\"reports-section-header\">\n                  <div className=\"reports-section-title\">\n                    <ClipboardList size={18} />\n                    <h3>Daily Reports</h3>\n                  </div>\n                  <span className=\"reports-section-count\">{projectData?.dailyReportsCount || 0} total</span>\n                </div>\n                <div className=\"reports-section-content\">\n                  <Suspense fallback={<TicketSkeleton />}>\n                    <DailyReportsList project={selectedProject} company={company} onShowToast={onShowToast} />\n                  </Suspense>\n                </div>\n              </div>\n\n              {/* Injury Reports Section */}\n              <div className={`reports-section-card ${(projectData?.injuryReportsCount || 0) > 0 ? 'has-warning' : ''}`}>\n                <div className=\"reports-section-header\">\n                  <div className=\"reports-section-title\">\n                    <span className={`reports-section-icon ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n                      {(projectData?.injuryReportsCount || 0) > 0 ? '' : ''}\n                    </span>\n                    <h3>Safety & Injury Reports</h3>\n                  </div>\n                  <span className={`reports-section-badge ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n                    {(projectData?.injuryReportsCount || 0) > 0\n                      ? `${projectData.injuryReportsCount} incident${projectData.injuryReportsCount !== 1 ? 's' : ''}`\n                      : 'No incidents'\n                    }\n                  </span>\n                </div>\n                <div className=\"reports-section-content\">\n                  <Suspense fallback={<TicketSkeleton />}>\n                    <InjuryReportsList\n                      project={selectedProject}\n                      companyId={company?.id || selectedProject?.company_id}\n                      company={company}\n                      user={user}\n                      onShowToast={onShowToast}\n                    />\n                  </Suspense>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* DOCUMENTS TAB */}\n          {activeProjectTab === 'documents' && (\n            <div className=\"pv-tab-panel documents-tab\">\n              <Suspense fallback={<TicketSkeleton />}>\n                <DocumentsTab\n                  project={selectedProject}\n                  companyId={company?.id || selectedProject?.company_id}\n                  onShowToast={onShowToast}\n                  userRole={user?.access_level || 'office'}\n                />\n              </Suspense>\n            </div>\n          )}\n\n          {/* INFO TAB */}\n          {activeProjectTab === 'info' && (\n            <div className=\"pv-tab-panel info-tab\">\n              {/* Hero Header */}\n              <div className=\"info-hero\">\n                <div className=\"info-hero-content\">\n                  <div className=\"info-hero-main\">\n                    <h2 className=\"info-hero-title\">{selectedProject.name}</h2>\n                    {selectedProject.job_number && (\n                      <span className=\"info-hero-job\">Job #{selectedProject.job_number}</span>\n                    )}\n                  </div>\n                  <button className=\"btn btn-primary btn-with-icon\" onClick={handleEditClick}>\n                    <span>Edit Project</span>\n                  </button>\n                </div>\n                {selectedProject.address && (\n                  <div className=\"info-hero-address\">\n                    <MapPin size={14} />\n                    <span>{selectedProject.address}</span>\n                  </div>\n                )}\n              </div>\n\n              {/* Quick Info Cards */}\n              <div className=\"info-quick-grid\">\n                {/* Work Type */}\n                <div className=\"info-quick-card\">\n                  <div className=\"info-quick-icon\">\n                    <HardHat size={20} />\n                  </div>\n                  <div className=\"info-quick-content\">\n                    <span className=\"info-quick-value\">\n                      {selectedProject.work_type === 'environmental' ? 'Environmental' : 'Demolition'}\n                    </span>\n                    <span className=\"info-quick-label\">Work Type</span>\n                  </div>\n                </div>\n\n                {/* Job Type */}\n                <div className=\"info-quick-card\">\n                  <div className=\"info-quick-icon\">\n                    <FileText size={20} />\n                  </div>\n                  <div className=\"info-quick-content\">\n                    <span className=\"info-quick-value\">\n                      {selectedProject.job_type === 'prevailing_wage' ? 'Prevailing Wage' : 'Standard'}\n                    </span>\n                    <span className=\"info-quick-label\">Job Type</span>\n                  </div>\n                </div>\n\n                {/* Contract Value */}\n                <div className=\"info-quick-card highlight\">\n                  <div className=\"info-quick-icon\">\n                    <DollarSign size={20} />\n                  </div>\n                  <div className=\"info-quick-content\">\n                    <span className=\"info-quick-value\">{formatCurrency(revisedContractValue)}</span>\n                    <span className=\"info-quick-label\">\n                      {changeOrderValue > 0 ? `Incl. +${formatCurrency(changeOrderValue)} COs` : 'Contract Value'}\n                    </span>\n                  </div>\n                </div>\n\n                {/* Foreman PIN */}\n                {selectedProject.pin && (\n                  <div className=\"info-quick-card\">\n                    <div className=\"info-quick-icon\">\n                      <span className=\"info-pin-icon\">#</span>\n                    </div>\n                    <div className=\"info-quick-content\">\n                      <span className=\"info-quick-value mono\">{selectedProject.pin}</span>\n                      <span className=\"info-quick-label\">Foreman PIN</span>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Client & Contractor Card */}\n              <div className=\"info-section-card\">\n                <div className=\"info-section-header\">\n                  <Building2 size={18} />\n                  <h3>Client & Contractor</h3>\n                </div>\n                <div className=\"info-section-content\">\n                  {selectedProject.general_contractor ? (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">General Contractor</span>\n                      <span className=\"info-detail-value\">{selectedProject.general_contractor}</span>\n                    </div>\n                  ) : (\n                    <div className=\"info-detail-row empty\">\n                      <span className=\"info-detail-value\">No general contractor specified</span>\n                    </div>\n                  )}\n                  {selectedProject.client_contact && (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">Client Contact</span>\n                      <span className=\"info-detail-value\">{selectedProject.client_contact}</span>\n                    </div>\n                  )}\n                  {selectedProject.client_phone && (\n                    <div className=\"info-detail-row clickable\">\n                      <span className=\"info-detail-label\">\n                        <Phone size={14} />\n                        Phone\n                      </span>\n                      <a href={`tel:${selectedProject.client_phone}`} className=\"info-detail-value link\">\n                        {selectedProject.client_phone}\n                      </a>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Work Areas Card */}\n              <div className=\"info-section-card\">\n                <div className=\"info-section-header\">\n                  <LayoutGrid size={18} />\n                  <h3>Work Areas</h3>\n                  <div className=\"info-section-badges\">\n                    {areasComplete > 0 && <span className=\"info-badge done\">{areasComplete} Done</span>}\n                    {areasWorking > 0 && <span className=\"info-badge working\">{areasWorking} Active</span>}\n                    {areasNotStarted > 0 && <span className=\"info-badge pending\">{areasNotStarted} Pending</span>}\n                  </div>\n                </div>\n                <div className=\"info-areas-list\">\n                  {areas.map(area => (\n                    <div key={area.id} className={`info-area-item ${area.status}`}>\n                      <div className=\"info-area-status\">\n                        {area.status === 'done' && <span className=\"status-dot done\"></span>}\n                        {area.status === 'working' && <span className=\"status-dot working\"></span>}\n                        {area.status === 'not_started' && <span className=\"status-dot pending\"></span>}\n                      </div>\n                      <div className=\"info-area-details\">\n                        <span className=\"info-area-name\">{area.name}</span>\n                        <span className={`info-area-status-label ${area.status}`}>\n                          {area.status === 'done' ? 'Complete' : area.status === 'working' ? 'In Progress' : 'Not Started'}\n                        </span>\n                      </div>\n                      <span className=\"info-area-weight\">{area.weight}%</span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Project Team */}\n              <ProjectTeam\n                project={selectedProject}\n                company={company}\n                user={user}\n                isAdmin={isAdmin}\n                onShowToast={onShowToast}\n              />\n\n              {/* Project Settings - Collapsible */}\n              <details className=\"info-details-section\">\n                <summary className=\"info-details-summary\">\n                  <Info size={16} />\n                  <span>Additional Settings</span>\n                </summary>\n                <div className=\"info-details-content\">\n                  <div className=\"info-detail-row\">\n                    <span className=\"info-detail-label\">Original Contract</span>\n                    <span className=\"info-detail-value\">{formatCurrency(selectedProject.contract_value)}</span>\n                  </div>\n                  {changeOrderValue > 0 && (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">Approved Change Orders</span>\n                      <span className=\"info-detail-value positive\">+{formatCurrency(changeOrderValue)}</span>\n                    </div>\n                  )}\n                  {selectedProject.default_dump_site_id && (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">Default Dump Site</span>\n                      <span className=\"info-detail-value\">\n                        {dumpSites.find(s => s.id === selectedProject.default_dump_site_id)?.name || 'Unknown'}\n                      </span>\n                    </div>\n                  )}\n                </div>\n              </details>\n\n              {/* Account Security */}\n              <div className=\"info-section-card\">\n                <MFASetup onShowToast={onShowToast} />\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Share Modal */}\n        {showShareModal && (\n          <Suspense fallback={null}>\n            <ShareModal\n              project={selectedProject}\n              user={user}\n              onClose={() => setShowShareModal(false)}\n              onShareCreated={(share) => {\n                onShowToast('Share link created successfully!', 'success')\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* Notification Settings Modal */}\n        {showNotificationSettings && (\n          <div className=\"notification-settings-modal\">\n            <Suspense fallback={null}>\n              <NotificationSettings\n                project={selectedProject}\n                company={company}\n                onShowToast={onShowToast}\n                onClose={() => setShowNotificationSettings(false)}\n              />\n            </Suspense>\n          </div>\n        )}\n\n        {/* COR Form Modal */}\n        {showCORForm && (\n          <Suspense fallback={null}>\n            <CORForm\n              project={selectedProject}\n              company={company}\n              areas={areas}\n              existingCOR={editingCOR}\n              onClose={() => {\n                setShowCORForm(false)\n                setEditingCOR(null)\n              }}\n              onSaved={() => {\n                setShowCORForm(false)\n                setEditingCOR(null)\n                setCORRefreshKey(prev => prev + 1)\n              }}\n              onShowToast={onShowToast}\n            />\n          </Suspense>\n        )}\n\n        {/* COR Detail Modal */}\n        {showCORDetail && viewingCOR && (\n          <Suspense fallback={null}>\n            <CORDetail\n              cor={viewingCOR}\n              project={selectedProject}\n              company={company}\n              areas={areas}\n              onClose={() => {\n                setShowCORDetail(false)\n                setViewingCOR(null)\n              }}\n              onEdit={(cor) => {\n                setShowCORDetail(false)\n                setViewingCOR(null)\n                setEditingCOR(cor)\n                setShowCORForm(true)\n              }}\n              onShowToast={onShowToast}\n              onStatusChange={() => {\n                // Trigger a refresh of the COR list\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* COR Log Modal */}\n        {corDisplayMode === 'log' && selectedProject && (\n          <div className=\"cor-log-modal-overlay\" onClick={() => setCORDisplayMode('list')}>\n            <div className=\"cor-log-modal\" onClick={(e) => e.stopPropagation()}>\n              <div className=\"cor-log-modal-header\">\n                <h2>Change Order Log</h2>\n                <button\n                  className=\"cor-log-modal-close\"\n                  onClick={() => setCORDisplayMode('list')}\n                  title=\"Close\"\n                >\n                  \n                </button>\n              </div>\n              <div className=\"cor-log-modal-content\">\n                <Suspense fallback={<div style={{ padding: '2rem', textAlign: 'center' }}>Loading...</div>}>\n                  <CORLog project={selectedProject} company={company} onShowToast={onShowToast} />\n                </Suspense>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Add Cost Modal */}\n        {showAddCostModal && (\n          <Suspense fallback={null}>\n            <AddCostModal\n              onClose={() => setShowAddCostModal(false)}\n              saving={savingCost}\n              onSave={async (costData) => {\n                try {\n                  setSavingCost(true)\n                  await db.addProjectCost(selectedProject.id, company.id, costData)\n                  setShowAddCostModal(false)\n                  loadProjects()\n                  onShowToast('Cost added successfully', 'success')\n                } catch (err) {\n                  console.error('Error adding cost:', err)\n                  onShowToast('Error adding cost', 'error')\n                } finally {\n                  setSavingCost(false)\n                }\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* Equipment Modal */}\n        {showEquipmentModal && (\n          <Suspense fallback={null}>\n            <EquipmentModal\n              project={selectedProject}\n              company={company}\n              user={user}\n              editItem={editingEquipment}\n              onSave={() => {\n                setShowEquipmentModal(false)\n                setEditingEquipment(null)\n                setEquipmentRefreshKey(prev => prev + 1)\n                onShowToast(editingEquipment ? 'Equipment updated' : 'Equipment added', 'success')\n              }}\n              onClose={() => {\n                setShowEquipmentModal(false)\n                setEditingEquipment(null)\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* Draw Request Modal */}\n        {showDrawRequestModal && (\n          <Suspense fallback={null}>\n            <DrawRequestModal\n              project={selectedProject}\n              company={company}\n              areas={areas}\n              corStats={projectsData.find(p => p.id === selectedProject?.id)?.corStats}\n              editDrawRequest={editingDrawRequest}\n              onSave={() => {\n                setShowDrawRequestModal(false)\n                setEditingDrawRequest(null)\n                setDrawRequestRefreshKey(prev => prev + 1)\n                onShowToast(editingDrawRequest ? 'Draw request updated' : 'Draw request created', 'success')\n              }}\n              onClose={() => {\n                setShowDrawRequestModal(false)\n                setEditingDrawRequest(null)\n              }}\n            />\n          </Suspense>\n        )}\n      </div>\n    )\n  }\n\n  // Project List View - empty state\n  if (projects.length === 0) {\n    return (\n      <div className=\"empty-state\">\n        <ClipboardList size={48} className=\"empty-state-icon\" />\n        <h3>No Projects Yet</h3>\n        <p>Create your first project to get started</p>\n      </div>\n    )\n  }\n\n  // Portfolio overview - uses memoized values from above\n  return (\n    <div>\n      {/* Business Overview - High Level Portfolio Health */}\n      <div className=\"business-overview\">\n        <div className=\"bo-header\">\n          <h2 className=\"bo-title\">Portfolio Overview</h2>\n          <button className=\"search-trigger-btn\" onClick={() => setSearchOpen(true)}>\n            <Search size={16} />\n            <span>Search</span>\n            <span className=\"shortcut\">K</span>\n          </button>\n          <div className=\"bo-project-count\">{projects.length} Active Project{projects.length !== 1 ? 's' : ''}</div>\n        </div>\n\n        {/* Main Financial Bar */}\n        <div className=\"bo-financial\">\n          <div className=\"bo-progress-bar\">\n            <div\n              className=\"bo-progress-fill\"\n              style={{ width: `${Math.min(weightedCompletion, 100)}%` }}\n            ></div>\n          </div>\n          <div className=\"bo-financial-row\">\n            <div className=\"bo-metric primary\">\n              <span className=\"bo-metric-value\">{formatCurrency(totalEarned)}</span>\n              <span className=\"bo-metric-label\">Earned Revenue</span>\n            </div>\n            <div className=\"bo-metric-separator\">of</div>\n            <div className=\"bo-metric primary\">\n              <span className=\"bo-metric-value\">{formatCurrency(totalPortfolioValue)}</span>\n              <span className=\"bo-metric-label\">Total Portfolio</span>\n            </div>\n            <div className=\"bo-metric highlight\">\n              <span className=\"bo-metric-value\">{formatCurrency(totalRemaining)}</span>\n              <span className=\"bo-metric-label\">Remaining to Bill</span>\n            </div>\n          </div>\n\n          {/* Change Orders Summary - Only show if there are change orders */}\n          {totalChangeOrders > 0 && (\n            <div className=\"bo-change-orders\">\n              <div className=\"bo-co-item\">\n                <span className=\"bo-co-label\">Original Contracts</span>\n                <span className=\"bo-co-value\">{formatCurrency(totalOriginalContract)}</span>\n              </div>\n              <div className=\"bo-co-item bo-co-added\">\n                <span className=\"bo-co-label\">+ Change Orders ({projectsWithChangeOrders} project{projectsWithChangeOrders !== 1 ? 's' : ''})</span>\n                <span className=\"bo-co-value\">+{formatCurrency(totalChangeOrders)}</span>\n              </div>\n            </div>\n          )}\n\n          {/* Pending CORs - Unapproved extra work (not yet part of contract value) */}\n          {totalPendingCORCount > 0 && (\n            <div className=\"bo-pending-cors\">\n              <div className=\"bo-pending-cor-item\">\n                <span className=\"bo-pending-cor-icon\">!</span>\n                <span className=\"bo-pending-cor-label\">Pending CORs</span>\n                <span className=\"bo-pending-cor-value\">{formatCurrency(totalPendingCORValue)}</span>\n                <span className=\"bo-pending-cor-count\">({totalPendingCORCount} pending)</span>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Project Health Summary */}\n        <div className=\"bo-health\">\n          <div className=\"bo-health-title\">Project Health</div>\n          <div className=\"bo-health-pills\">\n            {projectsComplete > 0 && (\n              <div className=\"bo-pill complete\">\n                <span className=\"bo-pill-count\">{projectsComplete}</span>\n                <span className=\"bo-pill-label\">Complete</span>\n              </div>\n            )}\n            {projectsOnTrack > 0 && (\n              <div className=\"bo-pill on-track\">\n                <span className=\"bo-pill-count\">{projectsOnTrack}</span>\n                <span className=\"bo-pill-label\">On Track</span>\n              </div>\n            )}\n            {projectsAtRisk > 0 && (\n              <div className=\"bo-pill at-risk\">\n                <span className=\"bo-pill-count\">{projectsAtRisk}</span>\n                <span className=\"bo-pill-label\">At Risk</span>\n              </div>\n            )}\n            {projectsOverBudget > 0 && (\n              <div className=\"bo-pill over-budget\">\n                <span className=\"bo-pill-count\">{projectsOverBudget}</span>\n                <span className=\"bo-pill-label\">Over Budget</span>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Schedule Performance Summary */}\n        {hasAnyScheduleData && (\n          <div className=\"bo-schedule\">\n            <div className=\"bo-schedule-title\">Schedule Performance</div>\n            <div className=\"bo-schedule-pills\">\n              {scheduleAhead > 0 && (\n                <div className=\"bo-pill ahead\">\n                  <span className=\"bo-pill-count\">{scheduleAhead}</span>\n                  <span className=\"bo-pill-label\">Ahead</span>\n                </div>\n              )}\n              {scheduleOnTrack > 0 && (\n                <div className=\"bo-pill schedule-on-track\">\n                  <span className=\"bo-pill-count\">{scheduleOnTrack}</span>\n                  <span className=\"bo-pill-label\">On Track</span>\n                </div>\n              )}\n              {scheduleBehind > 0 && (\n                <div className=\"bo-pill behind\">\n                  <span className=\"bo-pill-count\">{scheduleBehind}</span>\n                  <span className=\"bo-pill-label\">Behind</span>\n                </div>\n              )}\n            </div>\n\n            {/* Labor Performance (if any projects have planned man-days) */}\n            {hasAnyLaborData && (\n              <div className=\"bo-labor-summary\">\n                <span className=\"bo-labor-label\">Man-Days:</span>\n                {laborUnder > 0 && (\n                  <span className=\"bo-labor-badge under\">{laborUnder} under</span>\n                )}\n                {laborOnTrack > 0 && (\n                  <span className=\"bo-labor-badge on-track\">{laborOnTrack} on track</span>\n                )}\n                {laborOver > 0 && (\n                  <span className=\"bo-labor-badge over\">{laborOver} over</span>\n                )}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Smart Alerts - Actionable insights requiring attention */}\n      {riskAnalysis.allAlerts.length > 0 && (\n        <div className={`smart-alerts-section${riskAnalysis.criticalCount > 0 ? ' smart-alerts-section--has-critical' : riskAnalysis.allAlerts.some(a => a.type === 'warning') ? ' smart-alerts-section--has-warning' : ''}`}>\n          <div className=\"smart-alerts-header\">\n            <div className=\"smart-alerts-header__left\">\n              <AlertTriangle className=\"smart-alerts-header__icon\" size={18} />\n              <h3 className=\"smart-alerts-header__title\">Needs Attention</h3>\n            </div>\n            {riskAnalysis.criticalCount > 0 ? (\n              <span className=\"smart-alerts-count-badge smart-alerts-count-badge--critical\">\n                {riskAnalysis.criticalCount} critical\n              </span>\n            ) : (\n              <span className=\"smart-alerts-count-badge smart-alerts-count-badge--warning\">\n                {riskAnalysis.allAlerts.length} item{riskAnalysis.allAlerts.length !== 1 ? 's' : ''}\n              </span>\n            )}\n          </div>\n          <SmartAlerts\n            alerts={riskAnalysis.allAlerts}\n            onAction={handleAlertAction}\n            maxVisible={3}\n          />\n        </div>\n      )}\n\n      {/* Projects Header */}\n      <div className=\"dashboard-header\">\n        <h2>Projects</h2>\n        <span className=\"project-count\">{projects.length} active</span>\n      </div>\n\n      {/* Project Grid */}\n      <div className=\"project-list\">\n        {projectsData.map(project => {\n          const projectRisk = riskAnalysis.projectRisks.find(r => r.projectId === project.id)\n          return (\n            <EnhancedProjectCard\n              key={project.id}\n              project={project}\n              riskScore={projectRisk?.riskScore}\n              riskStatus={projectRisk?.riskStatus}\n              onClick={() => handleSelectProject(project)}\n            />\n          )\n        })}\n      </div>\n\n      {/* Universal Search Modal */}\n      <UniversalSearch\n        isOpen={isSearchOpen}\n        onClose={closeSearch}\n        companyId={company?.id}\n        onSelectProject={(project) => {\n          handleSelectProject(project)\n        }}\n        onSelectTicket={(ticket) => {\n          // Navigate to project and open T&M tab\n          const project = projects.find(p => p.id === ticket.project_id)\n          if (project) {\n            handleSelectProject(project)\n            setActiveProjectTab('financials')\n            setFinancialsSection('tickets')\n          }\n        }}\n        onSelectCOR={(cor) => {\n          // Navigate to project and open COR\n          const project = projects.find(p => p.id === cor.project_id)\n          if (project) {\n            handleSelectProject(project)\n            setActiveProjectTab('financials')\n            setFinancialsSection('cors')\n            setViewingCOR(cor)\n            setShowCORDetail(true)\n          }\n        }}\n        onShowToast={onShowToast}\n      />\n    </div>\n  )\n}\n\nfunction ProjectCard({ project, onClick }) {\n  const [areas, setAreas] = useState([])\n\n  useEffect(() => {\n    db.getAreas(project.id).then(setAreas)\n  }, [project.id])\n\n  const progress = calculateProgress(areas)\n  const status = getOverallStatus(areas)\n  const statusLabel = getOverallStatusLabel(areas)\n\n  return (\n    <div className=\"project-card\" onClick={onClick}>\n      <div className=\"project-card-header\">\n        <div>\n          <div className=\"project-card-name\">{project.name}</div>\n          <div className=\"project-card-value\">{formatCurrency(project.contract_value)}</div>\n        </div>\n        <span className={`status-badge ${status}`}>{statusLabel}</span>\n      </div>\n      <div className=\"project-card-progress\">\n        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.9rem' }}>\n          <span style={{ color: 'var(--text-secondary)' }}>Progress</span>\n          <span style={{ fontWeight: 600 }}>{progress}%</span>\n        </div>\n        <div className=\"mini-progress-bar\">\n          <div className=\"mini-progress-fill\" style={{ width: `${progress}%` }}></div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// Enhanced Project Card with more details\nfunction EnhancedProjectCard({ project, riskScore, riskStatus, onClick }) {\n  const status = getOverallStatus(project.areas || [])\n  const statusLabel = getOverallStatusLabel(project.areas || [])\n  const profit = project.contract_value - project.billable\n  const isAtRisk = project.billable > project.contract_value * 0.9 && project.progress < 90\n\n  // Risk badge colors\n  const riskColors = {\n    healthy: { bg: 'var(--status-success-bg, #064e3b)', color: 'var(--status-success, #059669)' },\n    warning: { bg: 'var(--status-warning-bg, #78350f)', color: 'var(--status-warning, #d97706)' },\n    critical: { bg: 'var(--status-danger-bg, #7f1d1d)', color: 'var(--status-danger, #dc2626)' }\n  }\n  const riskStyle = riskColors[riskStatus] || riskColors.healthy\n\n  return (\n    <div className={`project-card enhanced ${isAtRisk ? 'at-risk' : ''}`} onClick={onClick}>\n      <div className=\"project-card-header\">\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          {/* Risk Score Badge */}\n          {typeof riskScore === 'number' && (\n            <span\n              style={{\n                display: 'inline-flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                width: '32px',\n                height: '32px',\n                borderRadius: '50%',\n                fontSize: '0.75rem',\n                fontWeight: 700,\n                background: riskStyle.bg,\n                color: riskStyle.color\n              }}\n              title={`Risk Score: ${riskScore}`}\n              aria-label={`Risk score ${riskScore}, ${riskStatus}`}\n            >\n              {riskScore}\n            </span>\n          )}\n          <div>\n            <div className=\"project-card-name\">{project.name}</div>\n            <div className=\"project-card-value\">{formatCurrency(project.contract_value)}</div>\n          </div>\n        </div>\n        <span className={`status-badge ${status}`}>{statusLabel}</span>\n      </div>\n\n      {/* Stats Row */}\n      <div className=\"project-stats-row\">\n        <div className=\"project-stat\">\n          <span className=\"stat-value\">{project.progress}%</span>\n          <span className=\"stat-label\">Complete</span>\n        </div>\n        <div className=\"project-stat\">\n          <span className=\"stat-value\">{formatCurrency(project.billable)}</span>\n          <span className=\"stat-label\">Billable</span>\n        </div>\n        <div className=\"project-stat\">\n          <span className={`stat-value ${profit < 0 ? 'negative' : ''}`}>\n            {formatCurrency(Math.abs(profit))}\n          </span>\n          <span className=\"stat-label\">{profit >= 0 ? 'Remaining' : 'Over Budget'}</span>\n        </div>\n      </div>\n\n      {/* Progress Bar */}\n      <div className=\"mini-progress-bar\">\n        <div className=\"mini-progress-fill\" style={{ width: `${project.progress}%` }}></div>\n      </div>\n\n      {/* Badges Row */}\n      {(project.pendingTickets > 0 || project.totalTickets > 0) && (\n        <div className=\"project-badges\">\n          {project.pendingTickets > 0 && (\n            <span className=\"badge pending\">{project.pendingTickets} Pending</span>\n          )}\n          {project.approvedTickets > 0 && (\n            <span className=\"badge approved\">{project.approvedTickets} Approved</span>\n          )}\n        </div>\n      )}\n\n      {/* Schedule Badge */}\n      {project.hasScheduleData && (\n        <div className=\"project-schedule-badge\">\n          <span className={`schedule-indicator ${project.scheduleStatus}`}>\n            {project.scheduleLabel}\n          </span>\n          {project.hasLaborData && project.laborLabel && (\n            <span className={`labor-indicator ${project.laborStatus}`}>\n              {project.laborLabel}\n            </span>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n\n\n"],"file":"Dashboard-Dap7f_CW.js"}