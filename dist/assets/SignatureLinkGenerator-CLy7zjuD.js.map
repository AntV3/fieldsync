{"version":3,"file":"SignatureLinkGenerator-CLy7zjuD.js","sources":["../../src/components/SignatureLinkGenerator.jsx"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport { X, Link, Copy, Check, Clock, ExternalLink, AlertCircle, Trash2, Mail } from 'lucide-react'\nimport { db } from '../lib/supabase'\n\n// Hook to lock body scroll when modal is open\nfunction useBodyScrollLock() {\n  useEffect(() => {\n    const scrollY = window.scrollY\n    document.body.style.overflow = 'hidden'\n    document.body.style.position = 'fixed'\n    document.body.style.top = `-${scrollY}px`\n    document.body.style.width = '100%'\n\n    return () => {\n      document.body.style.overflow = ''\n      document.body.style.position = ''\n      document.body.style.top = ''\n      document.body.style.width = ''\n      window.scrollTo(0, scrollY)\n    }\n  }, [])\n}\n\n// Helper to format date\nconst formatDate = (dateString) => {\n  if (!dateString) return 'Never'\n  return new Date(dateString).toLocaleDateString('en-US', {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit'\n  })\n}\n\nconst DEADLINE_OPTIONS = [\n  { value: '7', label: '7 days' },\n  { value: '14', label: '14 days' },\n  { value: '30', label: '30 days' },\n  { value: '60', label: '60 days' },\n  { value: 'never', label: 'No expiration' },\n]\n\nexport default function SignatureLinkGenerator({\n  documentType, // 'cor' or 'tm_ticket'\n  documentId,\n  companyId,\n  projectId,\n  project,\n  documentTitle = '',\n  onClose,\n  onShowToast\n}) {\n  const [loading, setLoading] = useState(true)\n  const [generating, setGenerating] = useState(false)\n  const [existingRequests, setExistingRequests] = useState([])\n  const [newLink, setNewLink] = useState(null)\n  const [copied, setCopied] = useState(false)\n  const [expiresIn, setExpiresIn] = useState('30')\n  const [clientEmail, setClientEmail] = useState('')\n  const [clientName, setClientName] = useState(project?.general_contractor || '')\n  const [emailSent, setEmailSent] = useState(false)\n\n  // Lock body scroll when modal is open\n  useBodyScrollLock()\n\n  // Load existing signature requests for this document\n  useEffect(() => {\n    loadExistingRequests()\n  }, [documentType, documentId])\n\n  const loadExistingRequests = async () => {\n    try {\n      setLoading(true)\n      const requests = await db.getSignatureRequestsForDocument(documentType, documentId)\n      setExistingRequests(requests || [])\n    } catch (err) {\n      console.error('Error loading signature requests:', err)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // Generate a new signature link\n  const generateLink = async () => {\n    try {\n      setGenerating(true)\n      setEmailSent(false)\n\n      // Calculate expiration date\n      let expiresAt = null\n      if (expiresIn !== 'never') {\n        const days = parseInt(expiresIn)\n        expiresAt = new Date()\n        expiresAt.setDate(expiresAt.getDate() + days)\n        expiresAt = expiresAt.toISOString()\n      }\n\n      const request = await db.createSignatureRequest(\n        documentType,\n        documentId,\n        companyId,\n        projectId,\n        null, // createdBy - would need user ID\n        expiresAt\n      )\n\n      if (request) {\n        const link = `${window.location.origin}/sign/${request.signature_token}`\n        setNewLink(link)\n        await loadExistingRequests()\n\n        // Open Outlook with pre-filled email if address was provided\n        const email = clientEmail.trim()\n        if (email) {\n          const name = clientName.trim()\n          const docTypeLabel = documentType === 'cor' ? 'Change Order' : 'Time & Material Ticket'\n          const subject = `Signature required: ${docTypeLabel} — ${documentTitle}`\n          const expiryLine = expiresAt\n            ? `\\nThis link expires on ${new Date(expiresAt).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}.`\n            : ''\n          const body = [\n            name ? `Hi ${name},` : 'To Whom It May Concern,',\n            '',\n            `Please review and sign the ${docTypeLabel} \"${documentTitle}\".`,\n            '',\n            'Click the link below to view and sign the document:',\n            link,\n            expiryLine,\n            '',\n            'Thank you',\n          ].join('\\n')\n\n          window.location.href = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`\n          setEmailSent(true)\n          onShowToast?.('Outlook opened — review and send the email', 'success')\n        } else {\n          onShowToast?.('Signature link created', 'success')\n        }\n      }\n    } catch (err) {\n      console.error('Error generating signature link:', err)\n      onShowToast?.('Failed to create signature link', 'error')\n    } finally {\n      setGenerating(false)\n    }\n  }\n\n  // Copy link to clipboard\n  const copyToClipboard = async (link) => {\n    try {\n      await navigator.clipboard.writeText(link)\n      setCopied(true)\n      onShowToast?.('Link copied to clipboard', 'success')\n      setTimeout(() => setCopied(false), 2000)\n    } catch (err) {\n      console.error('Error copying to clipboard:', err)\n    }\n  }\n\n  // Revoke a signature request\n  const revokeRequest = async (requestId) => {\n    if (!confirm('Are you sure you want to revoke this signature link? It will no longer be usable.')) {\n      return\n    }\n\n    try {\n      await db.revokeSignatureRequest(requestId)\n      await loadExistingRequests()\n      onShowToast?.('Signature link revoked', 'success')\n    } catch (err) {\n      console.error('Error revoking signature request:', err)\n      onShowToast?.('Failed to revoke link', 'error')\n    }\n  }\n\n  // Get status badge info\n  const getStatusBadge = (status) => {\n    switch (status) {\n      case 'pending':\n        return { label: 'Awaiting Signatures', color: '#f59e0b', bg: '#fef3c7' }\n      case 'partially_signed':\n        return { label: '1 of 2 Signed', color: '#3b82f6', bg: '#dbeafe' }\n      case 'completed':\n        return { label: 'Fully Signed', color: '#10b981', bg: '#d1fae5' }\n      case 'revoked':\n        return { label: 'Revoked', color: '#ef4444', bg: '#fee2e2' }\n      case 'expired':\n        return { label: 'Expired', color: '#6b7280', bg: '#f3f4f6' }\n      default:\n        return { label: status, color: '#6b7280', bg: '#f3f4f6' }\n    }\n  }\n\n  const deadlineLabel = DEADLINE_OPTIONS.find(o => o.value === expiresIn)?.label ?? `${expiresIn} days`\n  const docTypeLabel = documentType === 'cor' ? 'Change Order' : 'Time & Material Ticket'\n\n  return (\n    <div className=\"modal-overlay\" onClick={onClose} role=\"dialog\" aria-modal=\"true\">\n      <div className=\"modal-content signature-link-modal\" onClick={e => e.stopPropagation()}>\n        <div className=\"modal-header\">\n          <div>\n            <h2>Get Signature Link</h2>\n            {documentTitle && <span className=\"modal-subtitle\">{documentTitle}</span>}\n          </div>\n          <button className=\"close-btn\" onClick={onClose} aria-label=\"Close\">\n            <X size={20} />\n          </button>\n        </div>\n\n        <div className=\"modal-body\">\n          {/* Create New Link Section */}\n          <div className=\"signature-link-section\">\n            <h3>\n              <Link size={16} />\n              Create New Signature Link\n            </h3>\n            <p className=\"section-description\">\n              Generate a secure link that allows GC/Client to sign this {docTypeLabel} without logging in.\n            </p>\n\n            {/* Deadline selector */}\n            <div className=\"link-options\">\n              <div className=\"link-option-row\">\n                <label htmlFor=\"sig-deadline\" className=\"link-option-label\">\n                  <Clock size={14} />\n                  Signing deadline\n                </label>\n                <select\n                  id=\"sig-deadline\"\n                  className=\"link-option-select\"\n                  value={expiresIn}\n                  onChange={e => setExpiresIn(e.target.value)}\n                >\n                  {DEADLINE_OPTIONS.map(opt => (\n                    <option key={opt.value} value={opt.value}>{opt.label}</option>\n                  ))}\n                </select>\n              </div>\n            </div>\n\n            {/* Optional email delivery */}\n            <div className=\"signature-email-section\">\n              <h4>\n                <Mail size={14} />\n                Send directly to client (optional)\n              </h4>\n              <div className=\"email-fields\">\n                <input\n                  type=\"text\"\n                  className=\"link-input\"\n                  placeholder=\"Client name\"\n                  value={clientName}\n                  onChange={e => setClientName(e.target.value)}\n                  autoComplete=\"off\"\n                />\n                <input\n                  type=\"email\"\n                  className=\"link-input\"\n                  placeholder=\"client@example.com\"\n                  value={clientEmail}\n                  onChange={e => setClientEmail(e.target.value)}\n                  autoComplete=\"off\"\n                />\n              </div>\n              <p className=\"email-hint\">\n                If provided, Outlook will open with the email pre-filled — just hit Send.\n              </p>\n            </div>\n\n            <div className=\"link-generate-row\">\n              <button\n                className=\"btn btn-primary\"\n                onClick={generateLink}\n                disabled={generating}\n              >\n                {generating\n                  ? 'Generating...'\n                  : (clientEmail.trim() ? 'Generate & Open in Outlook' : 'Generate Link')}\n              </button>\n            </div>\n\n            {/* Newly generated link */}\n            {newLink && (\n              <div className=\"new-link-box\">\n                {emailSent && (\n                  <div className=\"email-sent-banner\">\n                    <Mail size={14} />\n                    Outlook opened — review and send to {clientEmail}\n                  </div>\n                )}\n                <div className=\"link-display\">\n                  <input\n                    type=\"text\"\n                    value={newLink}\n                    readOnly\n                    className=\"link-input\"\n                  />\n                  <button\n                    className=\"btn btn-secondary copy-btn\"\n                    onClick={() => copyToClipboard(newLink)}\n                  >\n                    {copied ? <Check size={16} /> : <Copy size={16} />}\n                    {copied ? 'Copied!' : 'Copy'}\n                  </button>\n                </div>\n                <div className=\"new-link-meta\">\n                  <span className=\"link-expires-note\">\n                    <Clock size={12} />\n                    {expiresIn === 'never' ? 'No expiration' : `Expires in ${deadlineLabel}`}\n                  </span>\n                  <a\n                    href={newLink}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"preview-link\"\n                  >\n                    <ExternalLink size={14} />\n                    Preview link\n                  </a>\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Existing Links Section */}\n          <div className=\"signature-link-section\">\n            <h3>\n              <Clock size={16} />\n              Existing Signature Links\n            </h3>\n\n            {loading ? (\n              <div className=\"loading-inline\">Loading...</div>\n            ) : existingRequests.length === 0 ? (\n              <p className=\"empty-state\">No signature links have been created for this {docTypeLabel}.</p>\n            ) : (\n              <div className=\"existing-links-list\">\n                {existingRequests.map(request => {\n                  const statusBadge = getStatusBadge(request.status)\n                  const link = `${window.location.origin}/sign/${request.signature_token}`\n                  const signatureCount = request.signatures?.length || 0\n\n                  return (\n                    <div key={request.id} className=\"existing-link-card\">\n                      <div className=\"link-card-header\">\n                        <span\n                          className=\"status-badge\"\n                          style={{ color: statusBadge.color, backgroundColor: statusBadge.bg }}\n                        >\n                          {statusBadge.label}\n                        </span>\n                        <span className=\"link-created\">\n                          Created {formatDate(request.created_at)}\n                        </span>\n                      </div>\n\n                      <div className=\"link-card-body\">\n                        <div className=\"link-info\">\n                          <span className=\"link-token\">...{request.signature_token.slice(-8)}</span>\n                          {request.expires_at && (\n                            <span className=\"link-expires\">\n                              Expires {formatDate(request.expires_at)}\n                            </span>\n                          )}\n                          <span className=\"link-views\">\n                            {request.view_count} view{request.view_count !== 1 ? 's' : ''}\n                          </span>\n                        </div>\n\n                        {/* Signature status */}\n                        {signatureCount > 0 && (\n                          <div className=\"signatures-summary\">\n                            {request.signatures.map(sig => (\n                              <div key={sig.id} className=\"sig-item\">\n                                <Check size={12} />\n                                <span>\n                                  Slot {sig.signature_slot}: {sig.signer_name}\n                                  {sig.signer_company && ` (${sig.signer_company})`}\n                                </span>\n                              </div>\n                            ))}\n                          </div>\n                        )}\n                      </div>\n\n                      <div className=\"link-card-actions\">\n                        {request.status !== 'revoked' && request.status !== 'expired' && (\n                          <>\n                            <button\n                              className=\"btn btn-ghost btn-small\"\n                              onClick={() => copyToClipboard(link)}\n                            >\n                              <Copy size={14} /> Copy\n                            </button>\n                            <a\n                              href={link}\n                              target=\"_blank\"\n                              rel=\"noopener noreferrer\"\n                              className=\"btn btn-ghost btn-small\"\n                            >\n                              <ExternalLink size={14} /> Open\n                            </a>\n                          </>\n                        )}\n                        {request.status !== 'completed' && request.status !== 'revoked' && (\n                          <button\n                            className=\"btn btn-ghost btn-small btn-danger\"\n                            onClick={() => revokeRequest(request.id)}\n                          >\n                            <Trash2 size={14} /> Revoke\n                          </button>\n                        )}\n                      </div>\n                    </div>\n                  )\n                })}\n              </div>\n            )}\n          </div>\n\n          {/* Info box */}\n          <div className=\"signature-info-box\">\n            <AlertCircle size={16} />\n            <div>\n              <strong>How it works:</strong>\n              <ul>\n                <li>Share the link with your GC or Client (or enter their email above to open Outlook with the email pre-filled)</li>\n                <li>They can view the document and sign without logging in</li>\n                <li>Supports 2 signatures (GC + Client)</li>\n                <li>Signatures are recorded with name, title, company, date, and IP</li>\n              </ul>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"modal-footer\">\n          <button className=\"btn btn-secondary\" onClick={onClose}>\n            Close\n          </button>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":["useBodyScrollLock","useEffect","scrollY","formatDate","dateString","DEADLINE_OPTIONS","SignatureLinkGenerator","documentType","documentId","companyId","projectId","project","documentTitle","onClose","onShowToast","loading","setLoading","useState","generating","setGenerating","existingRequests","setExistingRequests","newLink","setNewLink","copied","setCopied","expiresIn","setExpiresIn","clientEmail","setClientEmail","clientName","setClientName","emailSent","setEmailSent","loadExistingRequests","requests","db","err","generateLink","expiresAt","days","request","link","email","name","docTypeLabel","subject","expiryLine","body","copyToClipboard","revokeRequest","requestId","getStatusBadge","status","deadlineLabel","o","jsxs","e","jsx","X","Link","Clock","opt","Mail","Check","Copy","ExternalLink","statusBadge","signatureCount","sig","Fragment","Trash2","AlertCircle"],"mappings":"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"}