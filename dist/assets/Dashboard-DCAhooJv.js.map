{"version":3,"mappings":"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","names":["_extends","n","e","t","r","ownKeys","o","_objectSpread","_defineProperty","_toPropertyKey","i","_toPrimitive","SIZE","defaultLegendContentDefaultProps","Icon","_ref","data","iconType","inactiveColor","halfSize","sixthSize","thirdSize","color","preferredIcon","_data$payload","React.createElement","React.isValidElement","iconProps","React.cloneElement","Symbols","Items","props","payload","iconSize","layout","formatter","viewBox","itemStyle","svgStyle","entry","finalFormatter","className","clsx","finalValue","adaptEventsOfChild","Surface","DefaultLegendContent","outsideProps","resolveDefaultProps","align","finalStyle","useLegendPayload","useAppSelector","selectLegendPayload","_excluded","_objectWithoutProperties","_objectWithoutPropertiesLoose","defaultUniqBy","LegendContent","contextPayload","otherProps","finalPayload","getUniqPayload","contentProps","getDefaultPosition","style","margin","chartWidth","chartHeight","box","verticalAlign","hPos","vPos","LegendSettingsDispatcher","dispatch","useAppDispatch","useEffect","setLegendSettings","LegendSizeDispatcher","setLegendSize","getWidthOrHeight","height","width","maxWidth","isNumber","legendDefaultProps","Legend","legendPortalFromContext","useLegendPortal","useMargin","widthFromProps","heightFromProps","wrapperStyle","portalFromProps","lastBoundingBox","updateBoundingBox","useElementOffset","useChartWidth","useChartHeight","widthOrHeight","outerStyle","legendPortal","legendElement","createPortal","renderLine","option","line","isWellBehavedNumber","getHorizontalLineEndPoints","yCoord","ifOverflow","position","yAxisOrientation","scales","x","coord","isNan","points","getVerticalLineEndPoints","xCoord","xAxisOrientation","y","getSegmentLineEndPoints","segment","p","getEndPoints","isFixedX","isNumOrStr","isFixedY","ReportReferenceLine","addLine","removeLine","ReferenceLineImpl","xAxisId","yAxisId","shape","isPanorama","useIsPanorama","clipPathId","useClipPathId","xAxis","state","selectXAxisSettings","yAxis","selectYAxisSettings","xAxisScale","selectAxisScale","yAxisScale","useViewBox","createLabeledScales","endPoints","x1","y1","x2","y2","clipPath","lineProps","svgPropertiesAndEvents","rect","rectWithCoords","ZIndexLayer","Layer","CartesianLabelContextProvider","CartesianLabelFromLabelProp","referenceLineDefaultProps","DefaultZIndexes","ReferenceLine","React.Fragment","selectXAxisWithScale","graphicalItemId","selectAxisWithScale","selectXAxisIdFromGraphicalItemId","selectXAxisTicks","selectTicksOfGraphicalItem","selectYAxisWithScale","selectYAxisIdFromGraphicalItemId","selectYAxisTicks","selectBandSize","createSelector","selectChartLayout","xAxisTicks","yAxisTicks","isCategoricalAxis","getBandSizeOfAxis","pickAreaId","_state","id","selectSynchronisedAreaSettings","selectUnfilteredCartesianItems","graphicalItems","item","selectNumericalAxisType","isXAxisCategorical","selectNumericalAxisIdFromGraphicalItemId","axisType","selectNumericalAxisStackGroups","selectStackGroups","selectGraphicalItemStackedData","areaSettings","stackGroups","_stackGroups$stackId","stackId","stackSeriesIdentifier","getStackSeriesIdentifier","groups","found","v","selectArea","selectChartDataWithIndexesIfNotInPanoramaPosition3","selectChartBaseValue","stackedData","bandSize","chartBaseValue","chartData","dataStartIndex","dataEndIndex","displayedData","computeArea","_excluded2","getLegendItemColor","stroke","fill","computeLegendPayloadFromAreaData","dataKey","name","legendType","hide","getTooltipNameProp","SetAreaTooltipEntrySettings","React.memo","strokeWidth","unit","tooltipType","tooltipEntrySettings","SetTooltipEntrySettings","AreaDotsWrapper","_ref2","needClip","dot","areaProps","svgPropertiesNoEvents","Dots","AreaLabelListProvider","_ref3","showLabels","children","labelListEntries","point","_point$x","_point$y","CartesianLabelListContextProvider","StaticArea","_ref4","baseLine","type","connectNulls","isRange","propsWithoutId","allOtherProps","propsWithEvents","Curve","VerticalRect","_ref5","_points$","_points","alpha","startY","endY","maxX","HorizontalRect","_ref6","_points$2","_points2","startX","endX","maxY","ClipRect","_ref7","AreaWithAnimation","_ref8","previousPointsRef","previousBaselineRef","isAnimationActive","animationBegin","animationDuration","animationEasing","onAnimationStart","onAnimationEnd","animationInput","useMemo","animationId","useAnimationId","useCartesianChartLayout","isAnimating","setIsAnimating","useState","handleAnimationEnd","useCallback","handleAnimationStart","prevPoints","prevBaseLine","JavascriptAnimate","prevPointsDiffFactor","stepPoints","index","prevPointIndex","prev","interpolate","stepBaseLine","isNullish","LabelListFromLabelProp","RenderArea","_ref9","useRef","AreaWithState","PureComponent","top","left","zIndex","layerClass","getRadiusAndStrokeWidthFromDot","clipDot","isClipDot","dotSize","activePointsClipPath","GraphicalItemClipPath","ActivePoints","defaultAreaProps","AreaImpl","_useAppSelector","_resolveDefaultProps","activeDot","fillOpacity","everythingElse","useChartLayout","chartName","useChartName","useNeedsClip","plotArea","usePlotArea","Global","getBaseValue","itemBaseValue","baseValue","numericAxis","domain","domainMax","domainMin","_ref0","hasStack","isHorizontalLayout","_valueAsArray$","_valueAsArray","valueAsArray","rawValue","getValueByDataKey","value1","isBreakPoint","getCateCoordinateOfLine","AreaFn","RegisterGraphicalItemId","SetLegendPayload","SetCartesianGraphicalItem","getNormalizedStackId","Area","propsAreEqual","allowedTooltipTypes","AreaChart","forwardRef","ref","CartesianChart","arrayTooltipSearcher","ErrorSeverity","ErrorCategory","categorizeError","error","message","code","getUserMessage","category","context","handleError","options","operation","severity","showToast","userMessage","companyId","projectId","userId","silent","rethrow","observe","toastType","safeAsync","fn","fallback","DEFAULT_THRESHOLDS","FACTOR_WEIGHTS","calculateFactorScore","value","thresholds","range","getFactorStatus","score","calculateBudgetFactor","totalCosts","earnedRevenue","ratio","status","label","calculateScheduleFactor","actualProgress","expectedProgress","variance","absVariance","calculateCORExposureFactor","pendingCORValue","contractValue","exposure","formatNumber","calculateActivityFactor","lastReportDate","lastDate","daysSince","calculateSafetyFactor","injuryCount","count","calculateRiskScore","project","weights","budgetFactor","scheduleFactor","corFactor","activityFactor","safetyFactor","compositeScore","overallStatus","summaryLabel","generateSmartAlerts","riskResult","alerts","factors","priorityOrder","a","b","calculateProjections","costPerPercent","estimatedCompletionCost","estimatedFinalMargin","estimatedCompletionDate","startDate","now","daysElapsed","progressPerDay","daysRemaining","num","loadJsPDF","__vitePreload","PAGE_WIDTH","MARGIN","CONTENT_WIDTH","formatDate","dateStr","checkPage","doc","needed","exportDailyReportsPDF","reports","jsPDF","report","idx","statusText","metrics","crewNames","w","crewLines","noteLines","issueLines","fileName","exportIncidentReportsPDF","typeLabel","lines","exportCrewCheckinsPDF","checkins","checkin","workers","exportAllFieldDocumentsPDF","dailyReports","incidentReports","crewCheckins","workerList","UniversalSearch","isOpen","onClose","onSelectProject","onSelectTicket","onSelectCOR","onShowToast","query","setQuery","results","setResults","loading","setLoading","selectedIndex","setSelectedIndex","inputRef","searchTimeoutRef","focusTimeoutRef","performSearch","searchQuery","searchResults","db","handleInputChange","allResults","all","c","hasResults","handleKeyDown","handleSelect","jsx","jsxs","Search","X","Fragment","FolderOpen","globalIdx","ChevronRight","FileText","ticket","ClipboardList","cor","Users","worker","Command","useUniversalSearch","setIsOpen","SmartAlerts","onAction","onDismiss","maxVisible","dismissedIds","setDismissedIds","visibleAlerts","alert","handleDismiss","alertId","SmartAlertCard","title","description","action","actionTarget","projectName","XCircle","AlertTriangle","Info","handleAction","ArrowRight","ManDayCosts","company","costData","setCostData","expanded","setExpanded","loadCostData","subscription","formatCurrency","amount","getRoleLabel","role","HardHat","roleEntries","day","ProgressBillingCard","memo","areas","corStats","onCreateDraw","onViewDraw","drawRequests","setDrawRequests","originalContract","sum","area","approvedCOs","revisedContract","loadDrawRequests","drawRequestOps","billingTotals","completedDraws","dr","billedToDate","retentionHeld","progress","nextDrawNumber","getStatusBadge","FileSpreadsheet","Plus","ProjectEquipmentCard","onAddEquipment","onEditEquipment","projectEquipment","setProjectEquipment","totalCost","setTotalCost","loadEquipment","equipmentOps","cost","handleMarkReturned","equipmentItem","handleDelete","activeEquipment","returnedEquipment","Truck","ChevronUp","ChevronDown","days","Calendar","RotateCcw","Edit2","Trash2","BurnRateCard","dailyBurn","totalBurn","daysWorked","laborCost","materialsEquipmentCost","laborByDate","materialsEquipmentByDate","expectedBurnAtProgress","burnStatus","statusLabel","StatusIcon","TrendingDown","Minus","TrendingUp","projectedTotalCost","combinedByDate","dateMap","d","maxDailyCost","Flame","chartColors","animationConfig","tooltipStyle","costCategories","timeRanges","formatChartCurrency","formatChartDate","gradientDefs","buildFinancialTimeSeries","projectData","tmTickets","haulOffByDate","customCosts","dateSet","sortedDates","revenueByDate","totalWeight","completionDate","areaWeight","areaValue","cumulativeCost","cumulativeTMValue","tmByDate","date","ticketValue","regHours","otHours","regRate","otRate","items","qty","unitCost","customByDate","materialsEquipmentByDateMap","cumulativeRevenue","haulOffCost","customCost","dailyTotalCost","tmDayValue","dailyRevenue","revenue","filterByTimeRange","cutoff","buildCostDistribution","segments","grouped","cat","catConfig","total","s","calculateTrend","key","recent","first","last","change","ChartTooltip","active","FinancialTrendChart","onDrillDown","timeRange","setTimeRange","hoveredLine","setHoveredLine","allData","selectedRange","costsTrend","revenueTrend","handleClick","TrendIcon","trend","ResponsiveContainer","grad","CartesianGrid","XAxis","YAxis","Tooltip","CostDonut","onSegmentClick","activeIndex","setActiveIndex","handleMouseEnter","_","handleMouseLeave","CustomTooltip","renderLegend","PieChart","Pie","Cell","categoryInfo","Wrench","Package","MoreHorizontal","CostContributorsCard","onAddCost","onDeleteCost","showChart","setShowChart","expandedCategory","setExpandedCategory","costBreakdown","customByCategory","group","info","toggleCategory","handleSegmentClick","hasItems","isExpanded","ProfitabilityCard","currentProfit","currentMargin","projectedRevenue","projectedCosts","projectedProfit","projectedMargin","isHealthy","isWarning","isLoss","CheckCircle","AlertCircle","LOAD_TYPES","getLoadTypeInfo","DisposalSummary","period","loads","setLoads","loadData","err","loadsByType","acc","load","loadsByDate","totalLoads","l","hasLoads","percentage","formattedDate","dayLoadsByType","typeInfo","PROJECT_ROLE_OPTIONS","ProjectTeam","user","isAdmin","teamMembers","setTeamMembers","companyMembers","setCompanyMembers","showAddModal","setShowAddModal","selectedUser","setSelectedUser","selectedRole","setSelectedRole","actionLoading","setActionLoading","loadProjectTeam","loadCompanyMembers","existingUserIds","tm","available","m","handleAddMember","handleUpdateRole","member","newRole","handleRemoveMember","UserPlus","UserMinus","Skeleton","borderRadius","variant","variantStyles","showProgress","CardSkeleton","showHeader","showAction","showAvatar","h","TicketSkeleton","HeroMetricsSkeleton","ErrorState","onRetry","retryLabel","CustomIcon","WifiOff","RefreshCw","EmptyState","actionLabel","required","hint","onChange","onBlur","placeholder","disabled","min","max","step","pattern","autoComplete","ariaLabel","ariaDescribedBy","inputId","errorId","selectId","rows","maxLength","textareaId","CountBadge","size","pulse","prevCount","setPrevCount","animating","setAnimating","timer","MiniProgress","showLabel","animated","autoVariant","TrendIndicator","previousValue","format","inverted","showValue","diff","percentChange","direction","formatValue","absChange","showArea","areaPoints","icons","Check","Clock","current","previous","delta","isPositive","isNegative","val","radius","circumference","offset","showCloseButton","closeOnOverlayClick","closeOnEscape","footer","modalRef","previousActiveElement","titleId","originalOverflow","focusableElements","firstElement","lastElement","handleOverlayClick","sizeClasses","MetricCard","formattedValue","subLabel","progressLabel","variantColors","HeroMetrics","profit","corApprovedValue","previousData","profitMargin","costRatio","revenueProgress","costProgress","profitVariant","costVariant","DollarSign","Receipt","PiggyBank","NAV_ITEMS","BarChart3","FinancialsNav","activeSection","onSectionChange","collapsed","onToggleCollapse","onMobileClose","stats","corCount","ticketCount","corPending","ticketPending","billableCount","invoiceCount","getBadge","itemId","PanelLeftOpen","ChevronLeft","isActive","badge","showConnector","OverviewProgressGauge","areasComplete","totalAreas","areasWorking","animatedProgress","setAnimatedProgress","animationRef","startValue","endValue","duration","startTime","animate","currentTime","elapsed","progressRatio","eased","getProgressColor","OverviewFinancialCard","disposalCost","equipmentCost","materialsCost","otherCost","hasBreakdown","widthPercent","CREW_COLORS","TIME_RANGES","OverviewCrewMetrics","crewHistory","setCrewHistory","setTmTickets","selectedDate","setSelectedDate","exporting","setExporting","history","tickets","tmWorkersByDate","map","crewByDate","selectedDayWorkers","selectedDayTmNames","todayMetrics","contract","rangeDays","today","tmNames","contractCount","tmCount","changeDate","isToday","handleBarClick","exportCrewPDF","pageWidth","footerY","Download","BarChart","Bar","TMList","lazy","ShareModal","InjuryReportsList","NotificationSettings","DailyReportsList","CORList","CORForm","CORDetail","CORLogPreview","CORLog","BillingCenter","DrawRequestModal","EquipmentModal","AddCostModal","DocumentsTab","Dashboard","navigateToProjectId","onProjectNavigated","projects","setProjects","projectsData","setProjectsData","selectedProject","setSelectedProject","setAreas","editMode","setEditMode","editData","setEditData","saving","setSaving","showShareModal","setShowShareModal","showNotificationSettings","setShowNotificationSettings","activeProjectTab","setActiveProjectTab","financialsSection","setFinancialsSection","financialsSidebarCollapsed","setFinancialsSidebarCollapsed","financialsSidebarMobileOpen","setFinancialsSidebarMobileOpen","corListExpanded","setCORListExpanded","corDisplayMode","setCORDisplayMode","tmViewMode","setTMViewMode","dumpSites","setDumpSites","showCORForm","setShowCORForm","editingCOR","setEditingCOR","showCORDetail","setShowCORDetail","viewingCOR","setViewingCOR","corRefreshKey","setCORRefreshKey","showAddCostModal","setShowAddCostModal","savingCost","setSavingCost","showEquipmentModal","setShowEquipmentModal","editingEquipment","setEditingEquipment","equipmentRefreshKey","setEquipmentRefreshKey","showDrawRequestModal","setShowDrawRequestModal","editingDrawRequest","setEditingDrawRequest","drawRequestRefreshKey","setDrawRequestRefreshKey","isSearchOpen","setSearchOpen","closeSearch","refreshTimeoutRef","pendingAreasRefreshRef","pendingCORRefreshRef","projectDetailsCacheRef","CACHE_TTL_MS","debouncedRefresh","refreshAreas","refreshCOR","loadAreas","loadProjects","loadDumpSites","projectIdsRef","projectIdsKey","currentIds","sites","lastNavigatedIdRef","subscriptions","areasSub","dailyReportsSub","checkinsSub","haulOffsSub","corsSub","sub","loadProjectDetails","forceRefresh","cacheKey","cached","projectAreas","changeOrderData","injuryReports","laborCosts","haulOffCosts","materialRequests","weeklyDisposal","progressData","calculateValueProgress","changeOrderValue","revisedContractValue","billable","pendingTickets","oneWeekAgo","recentDailyReports","customCostTotal","ticketDate","ticketMaterialsCost","materialsEquipmentByDateArray","allCostsTotal","laborDays","materialsDays","totalBurnDays","scheduleInsights","calculateScheduleInsights","uniqueWorkers","crewDates","avgCrewSize","peakCrewSize","recentCrewDates","priorCrewDates","recentCrewAvg","priorCrewAvg","pendingMaterialRequests","orderedMaterialRequests","deliveredMaterialRequests","urgentMaterialRequests","reportsWithIssues","totalPhotosFromTickets","disposalTotalLoads","lastInjuryDate","daysSinceLastInjury","completedAreas","enhancedData","enhanced","handleSelectProject","detailedProject","handleBack","handleEditClick","handleCancelEdit","handleEditChange","field","handleAreaEditChange","handleAddArea","handleRemoveArea","handleSaveEdit","contractVal","validAreas","existingAreaIds","editAreaIds","areaId","updatedProject","handleDeleteProject","progressCalculations","portfolioMetrics","totalOriginalContract","totalChangeOrders","totalPortfolioValue","totalEarned","totalRemaining","weightedCompletion","totalPendingCORValue","totalPendingCORCount","projectHealth","complete","onTrack","atRisk","overBudget","withChangeOrders","scheduleMetrics","ahead","behind","overLabor","underLabor","onTrackLabor","riskAnalysis","projectRisks","riskInput","projections","alertsWithProject","allAlerts","priority","handleAlertAction","target","checkAutoArchive","shouldAutoArchive","handleAddEquipment","handleEditEquipment","handleCreateDraw","handleViewDraw","drawRequest","handleViewAllTickets","handleToggleFinancialsSidebar","handleToggleMobileSidebar","handleCloseMobileSidebar","handleToggleCORList","handleExportFieldDocuments","handleBackToTMPreview","handleViewFullCORLog","handleCreateCOR","handleViewCOR","handleEditCOR","handleAddCost","handleDeleteCost","costId","financialsNavStats","projectsComplete","projectsOnTrack","projectsAtRisk","projectsOverBudget","projectsWithChangeOrders","scheduleAhead","scheduleOnTrack","scheduleBehind","laborOver","laborUnder","laborOnTrack","hasAnyScheduleData","hasAnyLaborData","isValueBased","earnedValue","totalSOVValue","site","areasNotStarted","pendingCount","tabs","LayoutGrid","tab","Menu","section","Suspense","Shield","CheckCircle2","req","week","maxWeek","Camera","MapPin","Building2","Phone","share","projectRisk","EnhancedProjectCard","riskScore","riskStatus","onClick","getOverallStatus","getOverallStatusLabel","isAtRisk","riskColors","riskStyle"],"ignoreList":[0,1,2,3,4,5,6],"sources":["../../node_modules/recharts/es6/component/DefaultLegendContent.js","../../node_modules/recharts/es6/context/legendPayloadContext.js","../../node_modules/recharts/es6/component/Legend.js","../../node_modules/recharts/es6/cartesian/ReferenceLine.js","../../node_modules/recharts/es6/state/selectors/areaSelectors.js","../../node_modules/recharts/es6/cartesian/Area.js","../../node_modules/recharts/es6/chart/AreaChart.js","../../src/lib/errorHandler.js","../../src/lib/riskCalculations.js","../../src/lib/fieldDocumentExport.js","../../src/components/UniversalSearch.jsx","../../src/components/dashboard/SmartAlerts.jsx","../../src/components/ManDayCosts.jsx","../../src/components/billing/ProgressBillingCard.jsx","../../src/components/equipment/ProjectEquipmentCard.jsx","../../src/components/BurnRateCard.jsx","../../src/components/charts/chartConfig.js","../../src/lib/chartDataTransforms.js","../../src/components/charts/ChartTooltip.jsx","../../src/components/charts/FinancialTrendChart.jsx","../../src/components/charts/CostDonut.jsx","../../src/components/CostContributorsCard.jsx","../../src/components/ProfitabilityCard.jsx","../../src/components/DisposalSummary.jsx","../../src/components/ProjectTeam.jsx","../../src/components/ui/Skeleton.jsx","../../src/components/ui/ErrorState.jsx","../../src/components/ui/FormField.jsx","../../src/components/ui/MicroVis.jsx","../../src/components/ui/Modal.jsx","../../src/components/HeroMetrics.jsx","../../src/components/FinancialsNav.jsx","../../src/components/overview/OverviewProgressGauge.jsx","../../src/components/overview/OverviewFinancialCard.jsx","../../src/components/overview/OverviewCrewMetrics.jsx","../../src/components/Dashboard.jsx"],"sourcesContent":["function _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n/**\n * @fileOverview Default Legend Content\n */\nimport * as React from 'react';\nimport { clsx } from 'clsx';\nimport { Surface } from '../container/Surface';\nimport { Symbols } from '../shape/Symbols';\nimport { adaptEventsOfChild } from '../util/types';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nvar SIZE = 32;\nvar defaultLegendContentDefaultProps = {\n  align: 'center',\n  iconSize: 14,\n  inactiveColor: '#ccc',\n  layout: 'horizontal',\n  verticalAlign: 'middle'\n};\nfunction Icon(_ref) {\n  var {\n    data,\n    iconType,\n    inactiveColor\n  } = _ref;\n  var halfSize = SIZE / 2;\n  var sixthSize = SIZE / 6;\n  var thirdSize = SIZE / 3;\n  var color = data.inactive ? inactiveColor : data.color;\n  var preferredIcon = iconType !== null && iconType !== void 0 ? iconType : data.type;\n  if (preferredIcon === 'none') {\n    return null;\n  }\n  if (preferredIcon === 'plainline') {\n    var _data$payload;\n    return /*#__PURE__*/React.createElement(\"line\", {\n      strokeWidth: 4,\n      fill: \"none\",\n      stroke: color,\n      strokeDasharray: (_data$payload = data.payload) === null || _data$payload === void 0 ? void 0 : _data$payload.strokeDasharray,\n      x1: 0,\n      y1: halfSize,\n      x2: SIZE,\n      y2: halfSize,\n      className: \"recharts-legend-icon\"\n    });\n  }\n  if (preferredIcon === 'line') {\n    return /*#__PURE__*/React.createElement(\"path\", {\n      strokeWidth: 4,\n      fill: \"none\",\n      stroke: color,\n      d: \"M0,\".concat(halfSize, \"h\").concat(thirdSize, \"\\n            A\").concat(sixthSize, \",\").concat(sixthSize, \",0,1,1,\").concat(2 * thirdSize, \",\").concat(halfSize, \"\\n            H\").concat(SIZE, \"M\").concat(2 * thirdSize, \",\").concat(halfSize, \"\\n            A\").concat(sixthSize, \",\").concat(sixthSize, \",0,1,1,\").concat(thirdSize, \",\").concat(halfSize),\n      className: \"recharts-legend-icon\"\n    });\n  }\n  if (preferredIcon === 'rect') {\n    return /*#__PURE__*/React.createElement(\"path\", {\n      stroke: \"none\",\n      fill: color,\n      d: \"M0,\".concat(SIZE / 8, \"h\").concat(SIZE, \"v\").concat(SIZE * 3 / 4, \"h\").concat(-SIZE, \"z\"),\n      className: \"recharts-legend-icon\"\n    });\n  }\n  if (/*#__PURE__*/React.isValidElement(data.legendIcon)) {\n    var iconProps = _objectSpread({}, data);\n    delete iconProps.legendIcon;\n    return /*#__PURE__*/React.cloneElement(data.legendIcon, iconProps);\n  }\n  return /*#__PURE__*/React.createElement(Symbols, {\n    fill: color,\n    cx: halfSize,\n    cy: halfSize,\n    size: SIZE,\n    sizeType: \"diameter\",\n    type: preferredIcon\n  });\n}\nfunction Items(props) {\n  var {\n    payload,\n    iconSize,\n    layout,\n    formatter,\n    inactiveColor,\n    iconType\n  } = props;\n  var viewBox = {\n    x: 0,\n    y: 0,\n    width: SIZE,\n    height: SIZE\n  };\n  var itemStyle = {\n    display: layout === 'horizontal' ? 'inline-block' : 'block',\n    marginRight: 10\n  };\n  var svgStyle = {\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    marginRight: 4\n  };\n  return payload.map((entry, i) => {\n    var finalFormatter = entry.formatter || formatter;\n    var className = clsx({\n      'recharts-legend-item': true,\n      [\"legend-item-\".concat(i)]: true,\n      inactive: entry.inactive\n    });\n    if (entry.type === 'none') {\n      return null;\n    }\n    var color = entry.inactive ? inactiveColor : entry.color;\n    var finalValue = finalFormatter ? finalFormatter(entry.value, entry, i) : entry.value;\n    return /*#__PURE__*/React.createElement(\"li\", _extends({\n      className: className,\n      style: itemStyle,\n      key: \"legend-item-\".concat(i)\n    }, adaptEventsOfChild(props, entry, i)), /*#__PURE__*/React.createElement(Surface, {\n      width: iconSize,\n      height: iconSize,\n      viewBox: viewBox,\n      style: svgStyle,\n      \"aria-label\": \"\".concat(finalValue, \" legend icon\")\n    }, /*#__PURE__*/React.createElement(Icon, {\n      data: entry,\n      iconType: iconType,\n      inactiveColor: inactiveColor\n    })), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"recharts-legend-item-text\",\n      style: {\n        color\n      }\n    }, finalValue));\n  });\n}\nexport var DefaultLegendContent = outsideProps => {\n  var props = resolveDefaultProps(outsideProps, defaultLegendContentDefaultProps);\n  var {\n    payload,\n    layout,\n    align\n  } = props;\n  if (!payload || !payload.length) {\n    return null;\n  }\n  var finalStyle = {\n    padding: 0,\n    margin: 0,\n    textAlign: layout === 'horizontal' ? align : 'left'\n  };\n  return /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"recharts-default-legend\",\n    style: finalStyle\n  }, /*#__PURE__*/React.createElement(Items, _extends({}, props, {\n    payload: payload\n  })));\n};","import { useAppSelector } from '../state/hooks';\nimport { selectLegendPayload } from '../state/selectors/legendSelectors';\n\n/**\n * Use this hook in Legend, or anywhere else where you want to read the current Legend items.\n * @return all Legend items ready to be rendered\n */\nexport function useLegendPayload() {\n  return useAppSelector(selectLegendPayload);\n}","var _excluded = [\"contextPayload\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\nimport * as React from 'react';\nimport { useEffect } from 'react';\nimport { createPortal } from 'react-dom';\nimport { useLegendPortal } from '../context/legendPortalContext';\nimport { DefaultLegendContent } from './DefaultLegendContent';\nimport { isNumber } from '../util/DataUtils';\nimport { getUniqPayload } from '../util/payload/getUniqPayload';\nimport { useLegendPayload } from '../context/legendPayloadContext';\nimport { useElementOffset } from '../util/useElementOffset';\nimport { useChartHeight, useChartWidth, useMargin } from '../context/chartLayoutContext';\nimport { setLegendSettings, setLegendSize } from '../state/legendSlice';\nimport { useAppDispatch } from '../state/hooks';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nfunction defaultUniqBy(entry) {\n  return entry.value;\n}\nfunction LegendContent(props) {\n  var {\n      contextPayload\n    } = props,\n    otherProps = _objectWithoutProperties(props, _excluded);\n  var finalPayload = getUniqPayload(contextPayload, props.payloadUniqBy, defaultUniqBy);\n  var contentProps = _objectSpread(_objectSpread({}, otherProps), {}, {\n    payload: finalPayload\n  });\n  if (/*#__PURE__*/React.isValidElement(props.content)) {\n    return /*#__PURE__*/React.cloneElement(props.content, contentProps);\n  }\n  if (typeof props.content === 'function') {\n    return /*#__PURE__*/React.createElement(props.content, contentProps);\n  }\n  return /*#__PURE__*/React.createElement(DefaultLegendContent, contentProps);\n}\nfunction getDefaultPosition(style, props, margin, chartWidth, chartHeight, box) {\n  var {\n    layout,\n    align,\n    verticalAlign\n  } = props;\n  var hPos, vPos;\n  if (!style || (style.left === undefined || style.left === null) && (style.right === undefined || style.right === null)) {\n    if (align === 'center' && layout === 'vertical') {\n      hPos = {\n        left: ((chartWidth || 0) - box.width) / 2\n      };\n    } else {\n      hPos = align === 'right' ? {\n        right: margin && margin.right || 0\n      } : {\n        left: margin && margin.left || 0\n      };\n    }\n  }\n  if (!style || (style.top === undefined || style.top === null) && (style.bottom === undefined || style.bottom === null)) {\n    if (verticalAlign === 'middle') {\n      vPos = {\n        top: ((chartHeight || 0) - box.height) / 2\n      };\n    } else {\n      vPos = verticalAlign === 'bottom' ? {\n        bottom: margin && margin.bottom || 0\n      } : {\n        top: margin && margin.top || 0\n      };\n    }\n  }\n  return _objectSpread(_objectSpread({}, hPos), vPos);\n}\nfunction LegendSettingsDispatcher(props) {\n  var dispatch = useAppDispatch();\n  useEffect(() => {\n    dispatch(setLegendSettings(props));\n  }, [dispatch, props]);\n  return null;\n}\nfunction LegendSizeDispatcher(props) {\n  var dispatch = useAppDispatch();\n  useEffect(() => {\n    dispatch(setLegendSize(props));\n    return () => {\n      dispatch(setLegendSize({\n        width: 0,\n        height: 0\n      }));\n    };\n  }, [dispatch, props]);\n  return null;\n}\nfunction getWidthOrHeight(layout, height, width, maxWidth) {\n  if (layout === 'vertical' && isNumber(height)) {\n    return {\n      height\n    };\n  }\n  if (layout === 'horizontal') {\n    return {\n      width: width || maxWidth\n    };\n  }\n  return null;\n}\nexport var legendDefaultProps = {\n  align: 'center',\n  iconSize: 14,\n  itemSorter: 'value',\n  layout: 'horizontal',\n  verticalAlign: 'bottom'\n};\nexport function Legend(outsideProps) {\n  var props = resolveDefaultProps(outsideProps, legendDefaultProps);\n  var contextPayload = useLegendPayload();\n  var legendPortalFromContext = useLegendPortal();\n  var margin = useMargin();\n  var {\n    width: widthFromProps,\n    height: heightFromProps,\n    wrapperStyle,\n    portal: portalFromProps\n  } = props;\n  // The contextPayload is not used directly inside the hook, but we need the onBBoxUpdate call\n  // when the payload changes, therefore it's here as a dependency.\n  var [lastBoundingBox, updateBoundingBox] = useElementOffset([contextPayload]);\n  var chartWidth = useChartWidth();\n  var chartHeight = useChartHeight();\n  if (chartWidth == null || chartHeight == null) {\n    return null;\n  }\n  var maxWidth = chartWidth - ((margin === null || margin === void 0 ? void 0 : margin.left) || 0) - ((margin === null || margin === void 0 ? void 0 : margin.right) || 0);\n  var widthOrHeight = getWidthOrHeight(props.layout, heightFromProps, widthFromProps, maxWidth);\n  // if the user supplies their own portal, only use their defined wrapper styles\n  var outerStyle = portalFromProps ? wrapperStyle : _objectSpread(_objectSpread({\n    position: 'absolute',\n    width: (widthOrHeight === null || widthOrHeight === void 0 ? void 0 : widthOrHeight.width) || widthFromProps || 'auto',\n    height: (widthOrHeight === null || widthOrHeight === void 0 ? void 0 : widthOrHeight.height) || heightFromProps || 'auto'\n  }, getDefaultPosition(wrapperStyle, props, margin, chartWidth, chartHeight, lastBoundingBox)), wrapperStyle);\n  var legendPortal = portalFromProps !== null && portalFromProps !== void 0 ? portalFromProps : legendPortalFromContext;\n  if (legendPortal == null || contextPayload == null) {\n    return null;\n  }\n  var legendElement = /*#__PURE__*/React.createElement(\"div\", {\n    className: \"recharts-legend-wrapper\",\n    style: outerStyle,\n    ref: updateBoundingBox\n  }, /*#__PURE__*/React.createElement(LegendSettingsDispatcher, {\n    layout: props.layout,\n    align: props.align,\n    verticalAlign: props.verticalAlign,\n    itemSorter: props.itemSorter\n  }), !portalFromProps && /*#__PURE__*/React.createElement(LegendSizeDispatcher, {\n    width: lastBoundingBox.width,\n    height: lastBoundingBox.height\n  }), /*#__PURE__*/React.createElement(LegendContent, _extends({}, props, widthOrHeight, {\n    margin: margin,\n    chartWidth: chartWidth,\n    chartHeight: chartHeight,\n    contextPayload: contextPayload\n  })));\n  return /*#__PURE__*/createPortal(legendElement, legendPortal);\n}\nLegend.displayName = 'Legend';","function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\n/**\n * @fileOverview Reference Line\n */\nimport * as React from 'react';\nimport { useEffect } from 'react';\nimport { clsx } from 'clsx';\nimport { Layer } from '../container/Layer';\nimport { CartesianLabelContextProvider, CartesianLabelFromLabelProp } from '../component/Label';\nimport { isNan, isNumOrStr } from '../util/DataUtils';\nimport { createLabeledScales, rectWithCoords } from '../util/CartesianUtils';\nimport { useViewBox } from '../context/chartLayoutContext';\nimport { addLine, removeLine } from '../state/referenceElementsSlice';\nimport { useAppDispatch, useAppSelector } from '../state/hooks';\nimport { selectAxisScale, selectXAxisSettings, selectYAxisSettings } from '../state/selectors/axisSelectors';\nimport { useIsPanorama } from '../context/PanoramaContext';\nimport { useClipPathId } from '../container/ClipPathProvider';\nimport { svgPropertiesAndEvents } from '../util/svgPropertiesAndEvents';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nimport { ZIndexLayer } from '../zIndex/ZIndexLayer';\nimport { DefaultZIndexes } from '../zIndex/DefaultZIndexes';\nimport { isWellBehavedNumber } from '../util/isWellBehavedNumber';\n\n/**\n * Single point that defines one end of a segment.\n * These coordinates are in data space, meaning that you should provide\n * values that correspond to the data domain of the axes.\n * So you would provide a value of `Page A` to indicate the data value `Page A`\n * and then recharts will convert that to pixels.\n *\n * Likewise for numbers. If your x-axis goes from 0 to 100,\n * and you want the line to end at 50, you would provide `50` here.\n */\n\n/**\n * This excludes `viewBox` prop from svg for two reasons:\n * 1. The components wants viewBox of object type, and svg wants string\n *    - so there's a conflict, and the component will throw if it gets string\n * 2. Internally the component calls `svgPropertiesNoEvents` which filters the viewBox away anyway\n */\n\nvar renderLine = (option, props) => {\n  var line;\n  if (/*#__PURE__*/React.isValidElement(option)) {\n    // @ts-expect-error element cloning is not typed\n    line = /*#__PURE__*/React.cloneElement(option, props);\n  } else if (typeof option === 'function') {\n    line = option(props);\n  } else {\n    if (!isWellBehavedNumber(props.x1) || !isWellBehavedNumber(props.y1) || !isWellBehavedNumber(props.x2) || !isWellBehavedNumber(props.y2)) {\n      return null;\n    }\n    line = /*#__PURE__*/React.createElement(\"line\", _extends({}, props, {\n      className: \"recharts-reference-line-line\"\n    }));\n  }\n  return line;\n};\nvar getHorizontalLineEndPoints = (yCoord, ifOverflow, position, yAxisOrientation, scales, viewBox) => {\n  var {\n    x,\n    width\n  } = viewBox;\n  var coord = scales.y.apply(yCoord, {\n    position\n  });\n  // don't render the line if the scale can't compute a result that makes sense\n  if (isNan(coord)) return null;\n  if (ifOverflow === 'discard' && !scales.y.isInRange(coord)) {\n    return null;\n  }\n  var points = [{\n    x: x + width,\n    y: coord\n  }, {\n    x,\n    y: coord\n  }];\n  return yAxisOrientation === 'left' ? points.reverse() : points;\n};\nvar getVerticalLineEndPoints = (xCoord, ifOverflow, position, xAxisOrientation, scales, viewBox) => {\n  var {\n    y,\n    height\n  } = viewBox;\n  var coord = scales.x.apply(xCoord, {\n    position\n  });\n  // don't render the line if the scale can't compute a result that makes sense\n  if (isNan(coord)) return null;\n  if (ifOverflow === 'discard' && !scales.x.isInRange(coord)) {\n    return null;\n  }\n  var points = [{\n    x: coord,\n    y: y + height\n  }, {\n    x: coord,\n    y\n  }];\n  return xAxisOrientation === 'top' ? points.reverse() : points;\n};\nvar getSegmentLineEndPoints = (segment, ifOverflow, position, scales) => {\n  var points = segment.map(p => scales.apply(p, {\n    position\n  }));\n  if (ifOverflow === 'discard' && points.some(p => !scales.isInRange(p))) {\n    return null;\n  }\n  return points;\n};\nexport var getEndPoints = (scales, viewBox, position, xAxisOrientation, yAxisOrientation, props) => {\n  var {\n    x: xCoord,\n    y: yCoord,\n    segment,\n    ifOverflow\n  } = props;\n  var isFixedX = isNumOrStr(xCoord);\n  var isFixedY = isNumOrStr(yCoord);\n  if (isFixedY) {\n    return getHorizontalLineEndPoints(yCoord, ifOverflow, position, yAxisOrientation, scales, viewBox);\n  }\n  if (isFixedX) {\n    return getVerticalLineEndPoints(xCoord, ifOverflow, position, xAxisOrientation, scales, viewBox);\n  }\n  if (segment != null && segment.length === 2) {\n    return getSegmentLineEndPoints(segment, ifOverflow, position, scales);\n  }\n  return null;\n};\nfunction ReportReferenceLine(props) {\n  var dispatch = useAppDispatch();\n  useEffect(() => {\n    dispatch(addLine(props));\n    return () => {\n      dispatch(removeLine(props));\n    };\n  });\n  return null;\n}\nfunction ReferenceLineImpl(props) {\n  var {\n    xAxisId,\n    yAxisId,\n    shape,\n    className,\n    ifOverflow\n  } = props;\n  var isPanorama = useIsPanorama();\n  var clipPathId = useClipPathId();\n  var xAxis = useAppSelector(state => selectXAxisSettings(state, xAxisId));\n  var yAxis = useAppSelector(state => selectYAxisSettings(state, yAxisId));\n  var xAxisScale = useAppSelector(state => selectAxisScale(state, 'xAxis', xAxisId, isPanorama));\n  var yAxisScale = useAppSelector(state => selectAxisScale(state, 'yAxis', yAxisId, isPanorama));\n  var viewBox = useViewBox();\n  if (!clipPathId || !viewBox || xAxis == null || yAxis == null || xAxisScale == null || yAxisScale == null) {\n    return null;\n  }\n  var scales = createLabeledScales({\n    x: xAxisScale,\n    y: yAxisScale\n  });\n  var endPoints = getEndPoints(scales, viewBox, props.position, xAxis.orientation, yAxis.orientation, props);\n  if (!endPoints) {\n    return null;\n  }\n  var [{\n    x: x1,\n    y: y1\n  }, {\n    x: x2,\n    y: y2\n  }] = endPoints;\n  var clipPath = ifOverflow === 'hidden' ? \"url(#\".concat(clipPathId, \")\") : undefined;\n  var lineProps = _objectSpread(_objectSpread({\n    clipPath\n  }, svgPropertiesAndEvents(props)), {}, {\n    x1,\n    y1,\n    x2,\n    y2\n  });\n  var rect = rectWithCoords({\n    x1,\n    y1,\n    x2,\n    y2\n  });\n  return /*#__PURE__*/React.createElement(ZIndexLayer, {\n    zIndex: props.zIndex\n  }, /*#__PURE__*/React.createElement(Layer, {\n    className: clsx('recharts-reference-line', className)\n  }, renderLine(shape, lineProps), /*#__PURE__*/React.createElement(CartesianLabelContextProvider, _extends({}, rect, {\n    lowerWidth: rect.width,\n    upperWidth: rect.width\n  }), /*#__PURE__*/React.createElement(CartesianLabelFromLabelProp, {\n    label: props.label\n  }), props.children)));\n}\nexport var referenceLineDefaultProps = {\n  ifOverflow: 'discard',\n  xAxisId: 0,\n  yAxisId: 0,\n  fill: 'none',\n  stroke: '#ccc',\n  fillOpacity: 1,\n  strokeWidth: 1,\n  position: 'middle',\n  zIndex: DefaultZIndexes.line\n};\n/**\n * @provides CartesianLabelContext\n */\nexport function ReferenceLine(outsideProps) {\n  var props = resolveDefaultProps(outsideProps, referenceLineDefaultProps);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ReportReferenceLine, {\n    yAxisId: props.yAxisId,\n    xAxisId: props.xAxisId,\n    ifOverflow: props.ifOverflow,\n    x: props.x,\n    y: props.y,\n    segment: props.segment\n  }), /*#__PURE__*/React.createElement(ReferenceLineImpl, props));\n}\nReferenceLine.displayName = 'ReferenceLine';","import { createSelector } from 'reselect';\nimport { computeArea } from '../../cartesian/Area';\nimport { selectAxisWithScale, selectStackGroups, selectTicksOfGraphicalItem, selectUnfilteredCartesianItems } from './axisSelectors';\nimport { selectChartLayout } from '../../context/chartLayoutContext';\nimport { selectChartDataWithIndexesIfNotInPanoramaPosition3 } from './dataSelectors';\nimport { getBandSizeOfAxis, isCategoricalAxis } from '../../util/ChartUtils';\nimport { getStackSeriesIdentifier } from '../../util/stacks/getStackSeriesIdentifier';\nimport { selectChartBaseValue } from './rootPropsSelectors';\nimport { selectXAxisIdFromGraphicalItemId, selectYAxisIdFromGraphicalItemId } from './graphicalItemSelectors';\nvar selectXAxisWithScale = (state, graphicalItemId, isPanorama) => selectAxisWithScale(state, 'xAxis', selectXAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nvar selectXAxisTicks = (state, graphicalItemId, isPanorama) => selectTicksOfGraphicalItem(state, 'xAxis', selectXAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nvar selectYAxisWithScale = (state, graphicalItemId, isPanorama) => selectAxisWithScale(state, 'yAxis', selectYAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nvar selectYAxisTicks = (state, graphicalItemId, isPanorama) => selectTicksOfGraphicalItem(state, 'yAxis', selectYAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nvar selectBandSize = createSelector([selectChartLayout, selectXAxisWithScale, selectYAxisWithScale, selectXAxisTicks, selectYAxisTicks], (layout, xAxis, yAxis, xAxisTicks, yAxisTicks) => {\n  if (isCategoricalAxis(layout, 'xAxis')) {\n    return getBandSizeOfAxis(xAxis, xAxisTicks, false);\n  }\n  return getBandSizeOfAxis(yAxis, yAxisTicks, false);\n});\nvar pickAreaId = (_state, id) => id;\n\n/*\n * There is a race condition problem because we read some data from props and some from the state.\n * The state is updated through a dispatch and is one render behind,\n * and so we have this weird one tick render where the displayedData in one selector have the old dataKey\n * but the new dataKey in another selector.\n *\n * A proper fix is to either move everything into the state, or read the dataKey always from props\n * - but this is a smaller change.\n */\nvar selectSynchronisedAreaSettings = createSelector([selectUnfilteredCartesianItems, pickAreaId], (graphicalItems, id) => graphicalItems.filter(item => item.type === 'area').find(item => item.id === id));\nvar selectNumericalAxisType = state => {\n  var layout = selectChartLayout(state);\n  var isXAxisCategorical = isCategoricalAxis(layout, 'xAxis');\n  return isXAxisCategorical ? 'yAxis' : 'xAxis';\n};\nvar selectNumericalAxisIdFromGraphicalItemId = (state, graphicalItemId) => {\n  var axisType = selectNumericalAxisType(state);\n  if (axisType === 'yAxis') {\n    return selectYAxisIdFromGraphicalItemId(state, graphicalItemId);\n  }\n  return selectXAxisIdFromGraphicalItemId(state, graphicalItemId);\n};\nvar selectNumericalAxisStackGroups = (state, graphicalItemId, isPanorama) => selectStackGroups(state, selectNumericalAxisType(state), selectNumericalAxisIdFromGraphicalItemId(state, graphicalItemId), isPanorama);\nexport var selectGraphicalItemStackedData = createSelector([selectSynchronisedAreaSettings, selectNumericalAxisStackGroups], (areaSettings, stackGroups) => {\n  var _stackGroups$stackId;\n  if (areaSettings == null || stackGroups == null) {\n    return undefined;\n  }\n  var {\n    stackId\n  } = areaSettings;\n  var stackSeriesIdentifier = getStackSeriesIdentifier(areaSettings);\n  if (stackId == null || stackSeriesIdentifier == null) {\n    return undefined;\n  }\n  var groups = (_stackGroups$stackId = stackGroups[stackId]) === null || _stackGroups$stackId === void 0 ? void 0 : _stackGroups$stackId.stackedData;\n  var found = groups === null || groups === void 0 ? void 0 : groups.find(v => v.key === stackSeriesIdentifier);\n  if (found == null) {\n    return undefined;\n  }\n  return found.map(item => [item[0], item[1]]);\n});\nexport var selectArea = createSelector([selectChartLayout, selectXAxisWithScale, selectYAxisWithScale, selectXAxisTicks, selectYAxisTicks, selectGraphicalItemStackedData, selectChartDataWithIndexesIfNotInPanoramaPosition3, selectBandSize, selectSynchronisedAreaSettings, selectChartBaseValue], (layout, xAxis, yAxis, xAxisTicks, yAxisTicks, stackedData, _ref, bandSize, areaSettings, chartBaseValue) => {\n  var {\n    chartData,\n    dataStartIndex,\n    dataEndIndex\n  } = _ref;\n  if (areaSettings == null || layout !== 'horizontal' && layout !== 'vertical' || xAxis == null || yAxis == null || xAxisTicks == null || yAxisTicks == null || xAxisTicks.length === 0 || yAxisTicks.length === 0 || bandSize == null) {\n    return undefined;\n  }\n  var {\n    data\n  } = areaSettings;\n  var displayedData;\n  if (data && data.length > 0) {\n    displayedData = data;\n  } else {\n    displayedData = chartData === null || chartData === void 0 ? void 0 : chartData.slice(dataStartIndex, dataEndIndex + 1);\n  }\n  if (displayedData == null) {\n    return undefined;\n  }\n  return computeArea({\n    layout,\n    xAxis,\n    yAxis,\n    xAxisTicks,\n    yAxisTicks,\n    dataStartIndex,\n    areaSettings,\n    stackedData,\n    displayedData,\n    chartBaseValue,\n    bandSize\n  });\n});","var _excluded = [\"id\"],\n  _excluded2 = [\"activeDot\", \"animationBegin\", \"animationDuration\", \"animationEasing\", \"connectNulls\", \"dot\", \"fill\", \"fillOpacity\", \"hide\", \"isAnimationActive\", \"legendType\", \"stroke\", \"xAxisId\", \"yAxisId\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport * as React from 'react';\nimport { PureComponent, useCallback, useMemo, useRef, useState } from 'react';\nimport { clsx } from 'clsx';\nimport { Curve } from '../shape/Curve';\nimport { Layer } from '../container/Layer';\nimport { CartesianLabelListContextProvider, LabelListFromLabelProp } from '../component/LabelList';\nimport { Dots } from '../component/Dots';\nimport { Global } from '../util/Global';\nimport { interpolate, isNan, isNullish, isNumber } from '../util/DataUtils';\nimport { getCateCoordinateOfLine, getNormalizedStackId, getTooltipNameProp, getValueByDataKey } from '../util/ChartUtils';\nimport { isClipDot } from '../util/ReactUtils';\nimport { ActivePoints } from '../component/ActivePoints';\nimport { SetTooltipEntrySettings } from '../state/SetTooltipEntrySettings';\nimport { GraphicalItemClipPath, useNeedsClip } from './GraphicalItemClipPath';\nimport { selectArea } from '../state/selectors/areaSelectors';\nimport { useIsPanorama } from '../context/PanoramaContext';\nimport { useCartesianChartLayout, useChartLayout } from '../context/chartLayoutContext';\nimport { useChartName } from '../state/selectors/selectors';\nimport { SetLegendPayload } from '../state/SetLegendPayload';\nimport { useAppSelector } from '../state/hooks';\nimport { useAnimationId } from '../util/useAnimationId';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nimport { isWellBehavedNumber } from '../util/isWellBehavedNumber';\nimport { usePlotArea } from '../hooks';\nimport { RegisterGraphicalItemId } from '../context/RegisterGraphicalItemId';\nimport { SetCartesianGraphicalItem } from '../state/SetGraphicalItem';\nimport { svgPropertiesNoEvents } from '../util/svgPropertiesNoEvents';\nimport { JavascriptAnimate } from '../animation/JavascriptAnimate';\nimport { getRadiusAndStrokeWidthFromDot } from '../util/getRadiusAndStrokeWidthFromDot';\nimport { svgPropertiesAndEvents } from '../util/svgPropertiesAndEvents';\nimport { ZIndexLayer } from '../zIndex/ZIndexLayer';\nimport { DefaultZIndexes } from '../zIndex/DefaultZIndexes';\nimport { propsAreEqual } from '../util/propsAreEqual';\n\n/**\n * @inline\n */\n\n/**\n * Internal props, combination of external props + defaultProps + private Recharts state\n */\n\n/**\n * External props, intended for end users to fill in\n */\n\n/**\n * Because of naming conflict, we are forced to ignore certain (valid) SVG attributes.\n */\n\nfunction getLegendItemColor(stroke, fill) {\n  return stroke && stroke !== 'none' ? stroke : fill;\n}\nvar computeLegendPayloadFromAreaData = props => {\n  var {\n    dataKey,\n    name,\n    stroke,\n    fill,\n    legendType,\n    hide\n  } = props;\n  return [{\n    inactive: hide,\n    dataKey,\n    type: legendType,\n    color: getLegendItemColor(stroke, fill),\n    value: getTooltipNameProp(name, dataKey),\n    payload: props\n  }];\n};\nvar SetAreaTooltipEntrySettings = /*#__PURE__*/React.memo(_ref => {\n  var {\n    dataKey,\n    data,\n    stroke,\n    strokeWidth,\n    fill,\n    name,\n    hide,\n    unit,\n    tooltipType,\n    id\n  } = _ref;\n  var tooltipEntrySettings = {\n    dataDefinedOnItem: data,\n    positions: undefined,\n    settings: {\n      stroke,\n      strokeWidth,\n      fill,\n      dataKey,\n      nameKey: undefined,\n      name: getTooltipNameProp(name, dataKey),\n      hide,\n      type: tooltipType,\n      color: getLegendItemColor(stroke, fill),\n      unit,\n      graphicalItemId: id\n    }\n  };\n  return /*#__PURE__*/React.createElement(SetTooltipEntrySettings, {\n    tooltipEntrySettings: tooltipEntrySettings\n  });\n});\nfunction AreaDotsWrapper(_ref2) {\n  var {\n    clipPathId,\n    points,\n    props\n  } = _ref2;\n  var {\n    needClip,\n    dot,\n    dataKey\n  } = props;\n  var areaProps = svgPropertiesNoEvents(props);\n  return /*#__PURE__*/React.createElement(Dots, {\n    points: points,\n    dot: dot,\n    className: \"recharts-area-dots\",\n    dotClassName: \"recharts-area-dot\",\n    dataKey: dataKey,\n    baseProps: areaProps,\n    needClip: needClip,\n    clipPathId: clipPathId\n  });\n}\nfunction AreaLabelListProvider(_ref3) {\n  var {\n    showLabels,\n    children,\n    points\n  } = _ref3;\n  var labelListEntries = points.map(point => {\n    var _point$x, _point$y;\n    var viewBox = {\n      x: (_point$x = point.x) !== null && _point$x !== void 0 ? _point$x : 0,\n      y: (_point$y = point.y) !== null && _point$y !== void 0 ? _point$y : 0,\n      width: 0,\n      lowerWidth: 0,\n      upperWidth: 0,\n      height: 0\n    };\n    return _objectSpread(_objectSpread({}, viewBox), {}, {\n      value: point.value,\n      payload: point.payload,\n      parentViewBox: undefined,\n      viewBox,\n      fill: undefined\n    });\n  });\n  return /*#__PURE__*/React.createElement(CartesianLabelListContextProvider, {\n    value: showLabels ? labelListEntries : undefined\n  }, children);\n}\nfunction StaticArea(_ref4) {\n  var {\n    points,\n    baseLine,\n    needClip,\n    clipPathId,\n    props\n  } = _ref4;\n  var {\n    layout,\n    type,\n    stroke,\n    connectNulls,\n    isRange\n  } = props;\n  var {\n      id\n    } = props,\n    propsWithoutId = _objectWithoutProperties(props, _excluded);\n  var allOtherProps = svgPropertiesNoEvents(propsWithoutId);\n  var propsWithEvents = svgPropertiesAndEvents(propsWithoutId);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, (points === null || points === void 0 ? void 0 : points.length) > 1 && /*#__PURE__*/React.createElement(Layer, {\n    clipPath: needClip ? \"url(#clipPath-\".concat(clipPathId, \")\") : undefined\n  }, /*#__PURE__*/React.createElement(Curve, _extends({}, propsWithEvents, {\n    id: id,\n    points: points,\n    connectNulls: connectNulls,\n    type: type,\n    baseLine: baseLine,\n    layout: layout,\n    stroke: \"none\",\n    className: \"recharts-area-area\"\n  })), stroke !== 'none' && /*#__PURE__*/React.createElement(Curve, _extends({}, allOtherProps, {\n    className: \"recharts-area-curve\",\n    layout: layout,\n    type: type,\n    connectNulls: connectNulls,\n    fill: \"none\",\n    points: points\n  })), stroke !== 'none' && isRange && /*#__PURE__*/React.createElement(Curve, _extends({}, allOtherProps, {\n    className: \"recharts-area-curve\",\n    layout: layout,\n    type: type,\n    connectNulls: connectNulls,\n    fill: \"none\",\n    points: baseLine\n  }))), /*#__PURE__*/React.createElement(AreaDotsWrapper, {\n    points: points,\n    props: propsWithoutId,\n    clipPathId: clipPathId\n  }));\n}\nfunction VerticalRect(_ref5) {\n  var _points$, _points;\n  var {\n    alpha,\n    baseLine,\n    points,\n    strokeWidth\n  } = _ref5;\n  var startY = (_points$ = points[0]) === null || _points$ === void 0 ? void 0 : _points$.y;\n  var endY = (_points = points[points.length - 1]) === null || _points === void 0 ? void 0 : _points.y;\n  if (!isWellBehavedNumber(startY) || !isWellBehavedNumber(endY)) {\n    return null;\n  }\n  var height = alpha * Math.abs(startY - endY);\n  var maxX = Math.max(...points.map(entry => entry.x || 0));\n  if (isNumber(baseLine)) {\n    maxX = Math.max(baseLine, maxX);\n  } else if (baseLine && Array.isArray(baseLine) && baseLine.length) {\n    maxX = Math.max(...baseLine.map(entry => entry.x || 0), maxX);\n  }\n  if (isNumber(maxX)) {\n    return /*#__PURE__*/React.createElement(\"rect\", {\n      x: 0,\n      y: startY < endY ? startY : startY - height,\n      width: maxX + (strokeWidth ? parseInt(\"\".concat(strokeWidth), 10) : 1),\n      height: Math.floor(height)\n    });\n  }\n  return null;\n}\nfunction HorizontalRect(_ref6) {\n  var _points$2, _points2;\n  var {\n    alpha,\n    baseLine,\n    points,\n    strokeWidth\n  } = _ref6;\n  var startX = (_points$2 = points[0]) === null || _points$2 === void 0 ? void 0 : _points$2.x;\n  var endX = (_points2 = points[points.length - 1]) === null || _points2 === void 0 ? void 0 : _points2.x;\n  if (!isWellBehavedNumber(startX) || !isWellBehavedNumber(endX)) {\n    return null;\n  }\n  var width = alpha * Math.abs(startX - endX);\n  var maxY = Math.max(...points.map(entry => entry.y || 0));\n  if (isNumber(baseLine)) {\n    maxY = Math.max(baseLine, maxY);\n  } else if (baseLine && Array.isArray(baseLine) && baseLine.length) {\n    maxY = Math.max(...baseLine.map(entry => entry.y || 0), maxY);\n  }\n  if (isNumber(maxY)) {\n    return /*#__PURE__*/React.createElement(\"rect\", {\n      x: startX < endX ? startX : startX - width,\n      y: 0,\n      width: width,\n      height: Math.floor(maxY + (strokeWidth ? parseInt(\"\".concat(strokeWidth), 10) : 1))\n    });\n  }\n  return null;\n}\nfunction ClipRect(_ref7) {\n  var {\n    alpha,\n    layout,\n    points,\n    baseLine,\n    strokeWidth\n  } = _ref7;\n  if (layout === 'vertical') {\n    return /*#__PURE__*/React.createElement(VerticalRect, {\n      alpha: alpha,\n      points: points,\n      baseLine: baseLine,\n      strokeWidth: strokeWidth\n    });\n  }\n  return /*#__PURE__*/React.createElement(HorizontalRect, {\n    alpha: alpha,\n    points: points,\n    baseLine: baseLine,\n    strokeWidth: strokeWidth\n  });\n}\nfunction AreaWithAnimation(_ref8) {\n  var {\n    needClip,\n    clipPathId,\n    props,\n    previousPointsRef,\n    previousBaselineRef\n  } = _ref8;\n  var {\n    points,\n    baseLine,\n    isAnimationActive,\n    animationBegin,\n    animationDuration,\n    animationEasing,\n    onAnimationStart,\n    onAnimationEnd\n  } = props;\n  var animationInput = useMemo(() => ({\n    points,\n    baseLine\n  }), [points, baseLine]);\n  var animationId = useAnimationId(animationInput, 'recharts-area-');\n  var layout = useCartesianChartLayout();\n  var [isAnimating, setIsAnimating] = useState(false);\n  var showLabels = !isAnimating;\n  var handleAnimationEnd = useCallback(() => {\n    if (typeof onAnimationEnd === 'function') {\n      onAnimationEnd();\n    }\n    setIsAnimating(false);\n  }, [onAnimationEnd]);\n  var handleAnimationStart = useCallback(() => {\n    if (typeof onAnimationStart === 'function') {\n      onAnimationStart();\n    }\n    setIsAnimating(true);\n  }, [onAnimationStart]);\n  if (layout == null) {\n    return null;\n  }\n  var prevPoints = previousPointsRef.current;\n  var prevBaseLine = previousBaselineRef.current;\n  return /*#__PURE__*/React.createElement(AreaLabelListProvider, {\n    showLabels: showLabels,\n    points: points\n  }, props.children, /*#__PURE__*/React.createElement(JavascriptAnimate, {\n    animationId: animationId,\n    begin: animationBegin,\n    duration: animationDuration,\n    isActive: isAnimationActive,\n    easing: animationEasing,\n    onAnimationEnd: handleAnimationEnd,\n    onAnimationStart: handleAnimationStart,\n    key: animationId\n  }, t => {\n    if (prevPoints) {\n      var prevPointsDiffFactor = prevPoints.length / points.length;\n      var stepPoints =\n      /*\n       * Here it is important that at the very end of the animation, on the last frame,\n       * we render the original points without any interpolation.\n       * This is needed because the code above is checking for reference equality to decide if the animation should run\n       * and if we create a new array instance (even if the numbers were the same)\n       * then we would break animations.\n       */\n      t === 1 ? points : points.map((entry, index) => {\n        var prevPointIndex = Math.floor(index * prevPointsDiffFactor);\n        if (prevPoints[prevPointIndex]) {\n          var prev = prevPoints[prevPointIndex];\n          return _objectSpread(_objectSpread({}, entry), {}, {\n            x: interpolate(prev.x, entry.x, t),\n            y: interpolate(prev.y, entry.y, t)\n          });\n        }\n        return entry;\n      });\n      var stepBaseLine;\n      if (isNumber(baseLine)) {\n        stepBaseLine = interpolate(prevBaseLine, baseLine, t);\n      } else if (isNullish(baseLine) || isNan(baseLine)) {\n        stepBaseLine = interpolate(prevBaseLine, 0, t);\n      } else {\n        stepBaseLine = baseLine.map((entry, index) => {\n          var prevPointIndex = Math.floor(index * prevPointsDiffFactor);\n          if (Array.isArray(prevBaseLine) && prevBaseLine[prevPointIndex]) {\n            var prev = prevBaseLine[prevPointIndex];\n            return _objectSpread(_objectSpread({}, entry), {}, {\n              x: interpolate(prev.x, entry.x, t),\n              y: interpolate(prev.y, entry.y, t)\n            });\n          }\n          return entry;\n        });\n      }\n      if (t > 0) {\n        /*\n         * We need to keep the refs in the parent component because we need to remember the last shape of the animation\n         * even if AreaWithAnimation is unmounted as that happens when changing props.\n         *\n         * And we need to update the refs here because here is where the interpolation is computed.\n         * Eslint doesn't like changing function arguments, but we need it so here is an eslint-disable.\n         */\n        // eslint-disable-next-line no-param-reassign\n        previousPointsRef.current = stepPoints;\n        // eslint-disable-next-line no-param-reassign\n        previousBaselineRef.current = stepBaseLine;\n      }\n      return /*#__PURE__*/React.createElement(StaticArea, {\n        points: stepPoints,\n        baseLine: stepBaseLine,\n        needClip: needClip,\n        clipPathId: clipPathId,\n        props: props\n      });\n    }\n    if (t > 0) {\n      // eslint-disable-next-line no-param-reassign\n      previousPointsRef.current = points;\n      // eslint-disable-next-line no-param-reassign\n      previousBaselineRef.current = baseLine;\n    }\n    return /*#__PURE__*/React.createElement(Layer, null, isAnimationActive && /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n      id: \"animationClipPath-\".concat(clipPathId)\n    }, /*#__PURE__*/React.createElement(ClipRect, {\n      alpha: t,\n      points: points,\n      baseLine: baseLine,\n      layout: layout,\n      strokeWidth: props.strokeWidth\n    }))), /*#__PURE__*/React.createElement(Layer, {\n      clipPath: \"url(#animationClipPath-\".concat(clipPathId, \")\")\n    }, /*#__PURE__*/React.createElement(StaticArea, {\n      points: points,\n      baseLine: baseLine,\n      needClip: needClip,\n      clipPathId: clipPathId,\n      props: props\n    })));\n  }), /*#__PURE__*/React.createElement(LabelListFromLabelProp, {\n    label: props.label\n  }));\n}\n\n/*\n * This components decides if the area should be animated or not.\n * It also holds the state of the animation.\n */\nfunction RenderArea(_ref9) {\n  var {\n    needClip,\n    clipPathId,\n    props\n  } = _ref9;\n  /*\n   * These two must be refs, not state!\n   * Because we want to store the most recent shape of the animation in case we have to interrupt the animation;\n   * that happens when user initiates another animation before the current one finishes.\n   *\n   * If this was a useState, then every step in the animation would trigger a re-render.\n   * So, useRef it is.\n   */\n  var previousPointsRef = useRef(null);\n  var previousBaselineRef = useRef();\n  return /*#__PURE__*/React.createElement(AreaWithAnimation, {\n    needClip: needClip,\n    clipPathId: clipPathId,\n    props: props,\n    previousPointsRef: previousPointsRef,\n    previousBaselineRef: previousBaselineRef\n  });\n}\nclass AreaWithState extends PureComponent {\n  render() {\n    var {\n      hide,\n      dot,\n      points,\n      className,\n      top,\n      left,\n      needClip,\n      xAxisId,\n      yAxisId,\n      width,\n      height,\n      id,\n      baseLine,\n      zIndex\n    } = this.props;\n    if (hide) {\n      return null;\n    }\n    var layerClass = clsx('recharts-area', className);\n    var clipPathId = id;\n    var {\n      r,\n      strokeWidth\n    } = getRadiusAndStrokeWidthFromDot(dot);\n    var clipDot = isClipDot(dot);\n    var dotSize = r * 2 + strokeWidth;\n    var activePointsClipPath = needClip ? \"url(#clipPath-\".concat(clipDot ? '' : 'dots-').concat(clipPathId, \")\") : undefined;\n    return /*#__PURE__*/React.createElement(ZIndexLayer, {\n      zIndex: zIndex\n    }, /*#__PURE__*/React.createElement(Layer, {\n      className: layerClass\n    }, needClip && /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(GraphicalItemClipPath, {\n      clipPathId: clipPathId,\n      xAxisId: xAxisId,\n      yAxisId: yAxisId\n    }), !clipDot && /*#__PURE__*/React.createElement(\"clipPath\", {\n      id: \"clipPath-dots-\".concat(clipPathId)\n    }, /*#__PURE__*/React.createElement(\"rect\", {\n      x: left - dotSize / 2,\n      y: top - dotSize / 2,\n      width: width + dotSize,\n      height: height + dotSize\n    }))), /*#__PURE__*/React.createElement(RenderArea, {\n      needClip: needClip,\n      clipPathId: clipPathId,\n      props: this.props\n    })), /*#__PURE__*/React.createElement(ActivePoints, {\n      points: points,\n      mainColor: getLegendItemColor(this.props.stroke, this.props.fill),\n      itemDataKey: this.props.dataKey,\n      activeDot: this.props.activeDot,\n      clipPath: activePointsClipPath\n    }), this.props.isRange && Array.isArray(baseLine) && /*#__PURE__*/React.createElement(ActivePoints, {\n      points: baseLine,\n      mainColor: getLegendItemColor(this.props.stroke, this.props.fill),\n      itemDataKey: this.props.dataKey,\n      activeDot: this.props.activeDot,\n      clipPath: activePointsClipPath\n    }));\n  }\n}\nexport var defaultAreaProps = {\n  activeDot: true,\n  animationBegin: 0,\n  animationDuration: 1500,\n  animationEasing: 'ease',\n  connectNulls: false,\n  dot: false,\n  fill: '#3182bd',\n  fillOpacity: 0.6,\n  hide: false,\n  isAnimationActive: 'auto',\n  legendType: 'line',\n  stroke: '#3182bd',\n  strokeWidth: 1,\n  type: 'linear',\n  label: false,\n  xAxisId: 0,\n  yAxisId: 0,\n  zIndex: DefaultZIndexes.area\n};\nfunction AreaImpl(props) {\n  var _useAppSelector;\n  var _resolveDefaultProps = resolveDefaultProps(props, defaultAreaProps),\n    {\n      activeDot,\n      animationBegin,\n      animationDuration,\n      animationEasing,\n      connectNulls,\n      dot,\n      fill,\n      fillOpacity,\n      hide,\n      isAnimationActive,\n      legendType,\n      stroke,\n      xAxisId,\n      yAxisId\n    } = _resolveDefaultProps,\n    everythingElse = _objectWithoutProperties(_resolveDefaultProps, _excluded2);\n  var layout = useChartLayout();\n  var chartName = useChartName();\n  var {\n    needClip\n  } = useNeedsClip(xAxisId, yAxisId);\n  var isPanorama = useIsPanorama();\n  var {\n    points,\n    isRange,\n    baseLine\n  } = (_useAppSelector = useAppSelector(state => selectArea(state, props.id, isPanorama))) !== null && _useAppSelector !== void 0 ? _useAppSelector : {};\n  var plotArea = usePlotArea();\n  if (layout !== 'horizontal' && layout !== 'vertical' || plotArea == null) {\n    // Can't render Area in an unsupported layout\n    return null;\n  }\n  if (chartName !== 'AreaChart' && chartName !== 'ComposedChart') {\n    // There is nothing stopping us from rendering Area in other charts, except for historical reasons. Do we want to allow that?\n    return null;\n  }\n  var {\n    height,\n    width,\n    x: left,\n    y: top\n  } = plotArea;\n  if (!points || !points.length) {\n    return null;\n  }\n  return /*#__PURE__*/React.createElement(AreaWithState, _extends({}, everythingElse, {\n    activeDot: activeDot,\n    animationBegin: animationBegin,\n    animationDuration: animationDuration,\n    animationEasing: animationEasing,\n    baseLine: baseLine,\n    connectNulls: connectNulls,\n    dot: dot,\n    fill: fill,\n    fillOpacity: fillOpacity,\n    height: height,\n    hide: hide,\n    layout: layout,\n    isAnimationActive: isAnimationActive === 'auto' ? !Global.isSsr : isAnimationActive,\n    isRange: isRange,\n    legendType: legendType,\n    needClip: needClip,\n    points: points,\n    stroke: stroke,\n    width: width,\n    left: left,\n    top: top,\n    xAxisId: xAxisId,\n    yAxisId: yAxisId\n  }));\n}\nexport var getBaseValue = (layout, chartBaseValue, itemBaseValue, xAxis, yAxis) => {\n  // The baseValue can be defined both on the AreaChart, and on the Area.\n  // The value for the item takes precedence.\n  var baseValue = itemBaseValue !== null && itemBaseValue !== void 0 ? itemBaseValue : chartBaseValue;\n  if (isNumber(baseValue)) {\n    return baseValue;\n  }\n  var numericAxis = layout === 'horizontal' ? yAxis : xAxis;\n  // @ts-expect-error d3scale .domain() returns unknown, Math.max expects number\n  var domain = numericAxis.scale.domain();\n  if (numericAxis.type === 'number') {\n    var domainMax = Math.max(domain[0], domain[1]);\n    var domainMin = Math.min(domain[0], domain[1]);\n    if (baseValue === 'dataMin') {\n      return domainMin;\n    }\n    if (baseValue === 'dataMax') {\n      return domainMax;\n    }\n    return domainMax < 0 ? domainMax : Math.max(Math.min(domain[0], domain[1]), 0);\n  }\n  if (baseValue === 'dataMin') {\n    return domain[0];\n  }\n  if (baseValue === 'dataMax') {\n    return domain[1];\n  }\n  return domain[0];\n};\nexport function computeArea(_ref0) {\n  var {\n    areaSettings: {\n      connectNulls,\n      baseValue: itemBaseValue,\n      dataKey\n    },\n    stackedData,\n    layout,\n    chartBaseValue,\n    xAxis,\n    yAxis,\n    displayedData,\n    dataStartIndex,\n    xAxisTicks,\n    yAxisTicks,\n    bandSize\n  } = _ref0;\n  var hasStack = stackedData && stackedData.length;\n  var baseValue = getBaseValue(layout, chartBaseValue, itemBaseValue, xAxis, yAxis);\n  var isHorizontalLayout = layout === 'horizontal';\n  var isRange = false;\n  var points = displayedData.map((entry, index) => {\n    var _valueAsArray$, _valueAsArray;\n    var valueAsArray;\n    if (hasStack) {\n      valueAsArray = stackedData[dataStartIndex + index];\n    } else {\n      var rawValue = getValueByDataKey(entry, dataKey);\n      if (!Array.isArray(rawValue)) {\n        // @ts-expect-error getValueByDataKey is not checking its return value\n        valueAsArray = [baseValue, rawValue];\n      } else {\n        // @ts-expect-error getValueByDataKey is not checking its return value\n        valueAsArray = rawValue;\n        isRange = true;\n      }\n    }\n    var value1 = (_valueAsArray$ = (_valueAsArray = valueAsArray) === null || _valueAsArray === void 0 ? void 0 : _valueAsArray[1]) !== null && _valueAsArray$ !== void 0 ? _valueAsArray$ : null;\n    var isBreakPoint = value1 == null || hasStack && !connectNulls && getValueByDataKey(entry, dataKey) == null;\n    if (isHorizontalLayout) {\n      return {\n        x: getCateCoordinateOfLine({\n          axis: xAxis,\n          ticks: xAxisTicks,\n          bandSize,\n          entry,\n          index\n        }),\n        y: isBreakPoint ? null : yAxis.scale(value1),\n        value: valueAsArray,\n        payload: entry\n      };\n    }\n    return {\n      x: isBreakPoint ? null : xAxis.scale(value1),\n      y: getCateCoordinateOfLine({\n        axis: yAxis,\n        ticks: yAxisTicks,\n        bandSize,\n        entry,\n        index\n      }),\n      value: valueAsArray,\n      payload: entry\n    };\n  });\n  var baseLine;\n  if (hasStack || isRange) {\n    baseLine = points.map(entry => {\n      var x = Array.isArray(entry.value) ? entry.value[0] : null;\n      if (isHorizontalLayout) {\n        return {\n          x: entry.x,\n          y: x != null && entry.y != null ? yAxis.scale(x) : null,\n          payload: entry.payload\n        };\n      }\n      return {\n        x: x != null ? xAxis.scale(x) : null,\n        y: entry.y,\n        payload: entry.payload\n      };\n    });\n  } else {\n    baseLine = isHorizontalLayout ? yAxis.scale(baseValue) : xAxis.scale(baseValue);\n  }\n  return {\n    points,\n    baseLine,\n    isRange\n  };\n}\nfunction AreaFn(outsideProps) {\n  var props = resolveDefaultProps(outsideProps, defaultAreaProps);\n  var isPanorama = useIsPanorama();\n  // Report all props to Redux store first, before calling any hooks, to avoid circular dependencies.\n  return /*#__PURE__*/React.createElement(RegisterGraphicalItemId, {\n    id: props.id,\n    type: \"area\"\n  }, id => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(SetLegendPayload, {\n    legendPayload: computeLegendPayloadFromAreaData(props)\n  }), /*#__PURE__*/React.createElement(SetAreaTooltipEntrySettings, {\n    dataKey: props.dataKey,\n    data: props.data,\n    stroke: props.stroke,\n    strokeWidth: props.strokeWidth,\n    fill: props.fill,\n    name: props.name,\n    hide: props.hide,\n    unit: props.unit,\n    tooltipType: props.tooltipType,\n    id: id\n  }), /*#__PURE__*/React.createElement(SetCartesianGraphicalItem, {\n    type: \"area\",\n    id: id,\n    data: props.data,\n    dataKey: props.dataKey,\n    xAxisId: props.xAxisId,\n    yAxisId: props.yAxisId,\n    zAxisId: 0,\n    stackId: getNormalizedStackId(props.stackId),\n    hide: props.hide,\n    barSize: undefined,\n    baseValue: props.baseValue,\n    isPanorama: isPanorama,\n    connectNulls: props.connectNulls\n  }), /*#__PURE__*/React.createElement(AreaImpl, _extends({}, props, {\n    id: id\n  }))));\n}\n\n/**\n * @provides LabelListContext\n * @consumes CartesianChartContext\n */\nexport var Area = /*#__PURE__*/React.memo(AreaFn, propsAreEqual);\nArea.displayName = 'Area';","import * as React from 'react';\nimport { forwardRef } from 'react';\nimport { arrayTooltipSearcher } from '../state/optionsSlice';\nimport { CartesianChart } from './CartesianChart';\nvar allowedTooltipTypes = ['axis'];\n\n/**\n * @provides CartesianViewBoxContext\n * @provides CartesianChartContext\n */\nexport var AreaChart = /*#__PURE__*/forwardRef((props, ref) => {\n  return /*#__PURE__*/React.createElement(CartesianChart, {\n    chartName: \"AreaChart\",\n    defaultTooltipEventType: \"axis\",\n    validateTooltipEventTypes: allowedTooltipTypes,\n    tooltipPayloadSearcher: arrayTooltipSearcher,\n    categoricalChartProps: props,\n    ref: ref\n  });\n});","/**\n * FieldSync Error Handling Utility\n *\n * Centralized error handling with proper logging, user feedback, and recovery.\n * Eliminates silent failures and provides consistent error handling patterns.\n *\n * Usage:\n *   import { handleError, withErrorHandling, safeAsync } from './errorHandler'\n *\n *   // Wrap async operations\n *   const data = await safeAsync(\n *     () => db.getTMTickets(projectId),\n *     { fallback: [], context: { operation: 'getTMTickets', projectId } }\n *   )\n *\n *   // Handle errors with toast\n *   try { ... } catch (error) {\n *     handleError(error, { operation: 'saveTicket', showToast: onShowToast })\n *   }\n */\n\nimport { observe } from './observability'\n\n// Error severity levels\nexport const ErrorSeverity = {\n  INFO: 'info',\n  WARNING: 'warning',\n  ERROR: 'error',\n  CRITICAL: 'critical'\n}\n\n// Error categories\nexport const ErrorCategory = {\n  DATABASE: 'database',\n  NETWORK: 'network',\n  AUTH: 'auth',\n  VALIDATION: 'validation',\n  STORAGE: 'storage',\n  SYNC: 'sync',\n  GENERAL: 'general'\n}\n\n/**\n * Determine error category from error object\n */\nfunction categorizeError(error) {\n  const message = error?.message?.toLowerCase() || ''\n  const code = error?.code?.toLowerCase() || ''\n\n  if (message.includes('fetch') || message.includes('network') || message.includes('offline')) {\n    return ErrorCategory.NETWORK\n  }\n  if (message.includes('auth') || message.includes('unauthorized') || code.includes('auth')) {\n    return ErrorCategory.AUTH\n  }\n  if (message.includes('storage') || message.includes('bucket') || message.includes('upload')) {\n    return ErrorCategory.STORAGE\n  }\n  if (message.includes('validation') || message.includes('invalid') || message.includes('required')) {\n    return ErrorCategory.VALIDATION\n  }\n  if (message.includes('sync') || message.includes('conflict')) {\n    return ErrorCategory.SYNC\n  }\n  if (error?.code || message.includes('database') || message.includes('supabase')) {\n    return ErrorCategory.DATABASE\n  }\n\n  return ErrorCategory.GENERAL\n}\n\n/**\n * Get user-friendly error message\n */\nfunction getUserMessage(error, category, context) {\n  // Custom message provided\n  if (context?.userMessage) {\n    return context.userMessage\n  }\n\n  // Network errors\n  if (category === ErrorCategory.NETWORK) {\n    return 'Network connection issue. Your changes will sync when back online.'\n  }\n\n  // Auth errors\n  if (category === ErrorCategory.AUTH) {\n    return 'Session expired. Please sign in again.'\n  }\n\n  // Storage errors\n  if (category === ErrorCategory.STORAGE) {\n    return 'Failed to upload file. Please try again.'\n  }\n\n  // Validation errors - show actual message\n  if (category === ErrorCategory.VALIDATION) {\n    return error?.message || 'Please check your input and try again.'\n  }\n\n  // Sync errors\n  if (category === ErrorCategory.SYNC) {\n    return 'Sync conflict detected. Please refresh and try again.'\n  }\n\n  // Database/general errors with operation context\n  if (context?.operation) {\n    const operation = context.operation.replace(/([A-Z])/g, ' $1').toLowerCase().trim()\n    return `Failed to ${operation}. Please try again.`\n  }\n\n  return 'Something went wrong. Please try again.'\n}\n\n/**\n * Main error handler\n *\n * @param {Error} error - The error object\n * @param {Object} options - Error handling options\n * @param {string} options.operation - Name of the operation that failed\n * @param {string} options.category - Error category (auto-detected if not provided)\n * @param {string} options.severity - Error severity (default: 'error')\n * @param {Function} options.showToast - Toast function to show user feedback\n * @param {string} options.userMessage - Custom user-facing message\n * @param {string} options.companyId - Company ID for context\n * @param {string} options.projectId - Project ID for context\n * @param {string} options.userId - User ID for context\n * @param {boolean} options.silent - If true, don't show toast (still logs)\n * @param {boolean} options.rethrow - If true, rethrow the error after handling\n */\nexport function handleError(error, options = {}) {\n  const {\n    operation = 'unknown',\n    category = categorizeError(error),\n    severity = ErrorSeverity.ERROR,\n    showToast,\n    userMessage,\n    companyId,\n    projectId,\n    userId,\n    silent = false,\n    rethrow = false\n  } = options\n\n  // Log to observability system\n  observe.error(category, {\n    message: error?.message || 'Unknown error',\n    code: error?.code,\n    severity,\n    operation,\n    company_id: companyId,\n    project_id: projectId,\n    user_id: userId,\n    extra: {\n      stack: error?.stack,\n      name: error?.name\n    }\n  })\n\n  // Show user feedback unless silent\n  if (!silent && showToast) {\n    const message = getUserMessage(error, category, { operation, userMessage })\n    const toastType = severity === ErrorSeverity.WARNING ? 'warning' : 'error'\n    showToast(message, toastType)\n  }\n\n  // Rethrow if requested\n  if (rethrow) {\n    throw error\n  }\n\n  return null\n}\n\n/**\n * Safe async wrapper - executes async function with error handling\n * Returns fallback value on error instead of throwing\n *\n * @param {Function} fn - Async function to execute\n * @param {Object} options - Options\n * @param {any} options.fallback - Value to return on error (default: null)\n * @param {Object} options.context - Context for error logging\n * @param {Function} options.showToast - Toast function\n * @param {boolean} options.silent - Don't show toast on error\n */\nexport async function safeAsync(fn, options = {}) {\n  const { fallback = null, context = {}, showToast, silent = true } = options\n\n  try {\n    return await fn()\n  } catch (error) {\n    handleError(error, {\n      ...context,\n      showToast,\n      silent\n    })\n    return fallback\n  }\n}\n\n/**\n * Higher-order function to wrap async functions with error handling\n *\n * @param {Function} fn - Async function to wrap\n * @param {Object} defaultOptions - Default error handling options\n */\nexport function withErrorHandling(fn, defaultOptions = {}) {\n  return async function(...args) {\n    try {\n      return await fn.apply(this, args)\n    } catch (error) {\n      handleError(error, defaultOptions)\n      return defaultOptions.fallback ?? null\n    }\n  }\n}\n\n/**\n * Create a safe version of a database operation\n * Logs errors and returns fallback instead of throwing\n *\n * @param {string} operation - Operation name for logging\n * @param {any} fallback - Fallback value on error\n */\nexport function createSafeOperation(operation, fallback = null) {\n  return (fn) => async (...args) => {\n    try {\n      return await fn(...args)\n    } catch (error) {\n      observe.error(ErrorCategory.DATABASE, {\n        message: error?.message || 'Unknown error',\n        operation,\n        severity: ErrorSeverity.ERROR\n      })\n      return fallback\n    }\n  }\n}\n\n/**\n * Batch multiple async operations with individual error handling\n * Returns results array with nulls for failed operations\n *\n * @param {Array<{fn: Function, fallback: any, context: Object}>} operations\n */\nexport async function safeBatch(operations) {\n  return Promise.all(\n    operations.map(({ fn, fallback = null, context = {} }) =>\n      safeAsync(fn, { fallback, context, silent: true })\n    )\n  )\n}\n\n/**\n * Retry wrapper for flaky operations\n *\n * @param {Function} fn - Async function to retry\n * @param {Object} options - Retry options\n * @param {number} options.maxRetries - Max retry attempts (default: 3)\n * @param {number} options.baseDelay - Base delay in ms (default: 1000)\n * @param {Function} options.shouldRetry - Function to determine if error is retryable\n */\nexport async function withRetry(fn, options = {}) {\n  const {\n    maxRetries = 3,\n    baseDelay = 1000,\n    shouldRetry = (error) => {\n      const message = error?.message?.toLowerCase() || ''\n      return message.includes('network') || message.includes('fetch') || message.includes('timeout')\n    }\n  } = options\n\n  let lastError\n\n  for (let attempt = 0; attempt < maxRetries; attempt++) {\n    try {\n      return await fn()\n    } catch (error) {\n      lastError = error\n\n      if (!shouldRetry(error) || attempt === maxRetries - 1) {\n        throw error\n      }\n\n      // Exponential backoff\n      const delay = baseDelay * Math.pow(2, attempt)\n      await new Promise(resolve => setTimeout(resolve, delay))\n    }\n  }\n\n  throw lastError\n}\n\nexport default {\n  handleError,\n  safeAsync,\n  withErrorHandling,\n  createSafeOperation,\n  safeBatch,\n  withRetry,\n  ErrorSeverity,\n  ErrorCategory\n}\n","/**\n * Risk Score Calculation Engine\n *\n * Calculates a composite risk score (0-100) for projects\n * based on multiple factors. Lower score = healthier project.\n *\n * Factors and weights:\n * - Budget Health: 30% - Cost ratio vs earned revenue\n * - Schedule Health: 25% - Progress vs expected progress\n * - COR Exposure: 20% - Pending COR value as % of contract\n * - Activity Cadence: 15% - Days since last daily report\n * - Safety Status: 10% - Recent injury reports\n */\n\n// Default thresholds (can be overridden per company)\nexport const DEFAULT_THRESHOLDS = {\n  budget: {\n    healthy: 0.60,   // Green if costs < 60% of revenue\n    warning: 0.75,   // Yellow if 60-75%\n    critical: 0.85   // Red if > 85%\n  },\n  schedule: {\n    healthy: 0.05,   // Green if within 5% of plan\n    warning: 0.15,   // Yellow if 5-15% behind\n    critical: 0.25   // Red if > 25% behind\n  },\n  corExposure: {\n    healthy: 0.05,   // Green if pending CORs < 5% of contract\n    warning: 0.15,   // Yellow if 5-15%\n    critical: 0.25   // Red if > 25%\n  },\n  activity: {\n    healthy: 1,      // Green if report within 1 day\n    warning: 3,      // Yellow if 2-3 days\n    critical: 5      // Red if > 5 days\n  },\n  safety: {\n    healthy: 0,      // Green if 0 incidents in 30 days\n    warning: 1,      // Yellow if 1 incident\n    critical: 2      // Red if 2+ incidents\n  }\n}\n\n// Factor weights (must sum to 1.0)\nexport const FACTOR_WEIGHTS = {\n  budget: 0.30,\n  schedule: 0.25,\n  corExposure: 0.20,\n  activity: 0.15,\n  safety: 0.10\n}\n\n/**\n * Calculate individual factor score (0-100)\n * 0 = healthy, 100 = critical\n */\nfunction calculateFactorScore(value, thresholds) {\n  if (value <= thresholds.healthy) return 0\n  if (value >= thresholds.critical) return 100\n\n  // Linear interpolation between healthy and critical\n  const range = thresholds.critical - thresholds.healthy\n  const excess = value - thresholds.healthy\n  return (excess / range) * 100\n}\n\n/**\n * Get status label for a factor score\n */\nfunction getFactorStatus(score) {\n  if (score <= 25) return 'healthy'\n  if (score <= 60) return 'warning'\n  return 'critical'\n}\n\n/**\n * Calculate budget health factor\n *\n * @param {number} totalCosts - Total costs to date\n * @param {number} earnedRevenue - Earned revenue to date\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateBudgetFactor(totalCosts, earnedRevenue, thresholds = DEFAULT_THRESHOLDS.budget) {\n  if (!earnedRevenue || earnedRevenue <= 0) {\n    // No revenue yet - can't calculate ratio\n    return { score: 0, status: 'healthy', ratio: 0, label: 'No revenue yet' }\n  }\n\n  const ratio = totalCosts / earnedRevenue\n\n  const score = calculateFactorScore(ratio, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (ratio < thresholds.healthy) {\n    label = `Costs at ${(ratio * 100).toFixed(0)}% of revenue`\n  } else if (ratio < thresholds.warning) {\n    label = `Costs at ${(ratio * 100).toFixed(0)}% - monitor closely`\n  } else {\n    label = `Costs at ${(ratio * 100).toFixed(0)}% - review immediately`\n  }\n\n  return { score, status, ratio, label }\n}\n\n/**\n * Calculate schedule health factor\n *\n * @param {number} actualProgress - Actual completion percentage (0-100)\n * @param {number} expectedProgress - Expected completion percentage (0-100)\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateScheduleFactor(actualProgress, expectedProgress, thresholds = DEFAULT_THRESHOLDS.schedule) {\n  if (!expectedProgress || expectedProgress <= 0) {\n    // No schedule baseline - assume on track\n    return { score: 0, status: 'healthy', variance: 0, label: 'No schedule baseline' }\n  }\n\n  // Variance as a ratio (negative = behind)\n  const variance = (expectedProgress - actualProgress) / expectedProgress\n  const absVariance = Math.max(0, variance) // Only penalize being behind\n\n  const score = calculateFactorScore(absVariance, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (variance <= 0) {\n    label = actualProgress >= 100 ? 'Complete' : 'On or ahead of schedule'\n  } else if (variance < thresholds.warning) {\n    label = `${(variance * 100).toFixed(0)}% behind schedule`\n  } else {\n    label = `${(variance * 100).toFixed(0)}% behind - needs attention`\n  }\n\n  return { score, status, variance, label }\n}\n\n/**\n * Calculate COR exposure factor\n *\n * @param {number} pendingCORValue - Total value of pending CORs\n * @param {number} contractValue - Total contract value\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateCORExposureFactor(pendingCORValue, contractValue, thresholds = DEFAULT_THRESHOLDS.corExposure) {\n  if (!contractValue || contractValue <= 0) {\n    return { score: 0, status: 'healthy', exposure: 0, label: 'No contract value' }\n  }\n\n  const exposure = pendingCORValue / contractValue\n\n  const score = calculateFactorScore(exposure, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (exposure < thresholds.healthy) {\n    label = pendingCORValue > 0 ? `$${formatNumber(pendingCORValue)} pending` : 'No pending CORs'\n  } else if (exposure < thresholds.warning) {\n    label = `$${formatNumber(pendingCORValue)} pending (${(exposure * 100).toFixed(0)}% of contract)`\n  } else {\n    label = `High exposure: $${formatNumber(pendingCORValue)} (${(exposure * 100).toFixed(0)}%)`\n  }\n\n  return { score, status, exposure, label }\n}\n\n/**\n * Calculate activity cadence factor\n *\n * @param {Date|string} lastReportDate - Date of last daily report\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateActivityFactor(lastReportDate, thresholds = DEFAULT_THRESHOLDS.activity) {\n  if (!lastReportDate) {\n    return { score: 100, status: 'critical', daysSince: null, label: 'No reports filed' }\n  }\n\n  const lastDate = new Date(lastReportDate)\n  const now = new Date()\n  const daysSince = Math.floor((now - lastDate) / (1000 * 60 * 60 * 24))\n\n  const score = calculateFactorScore(daysSince, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (daysSince === 0) {\n    label = 'Report filed today'\n  } else if (daysSince === 1) {\n    label = 'Report filed yesterday'\n  } else if (daysSince <= thresholds.warning) {\n    label = `Last report ${daysSince} days ago`\n  } else {\n    label = `No report in ${daysSince} days - may be stalled`\n  }\n\n  return { score, status, daysSince, label }\n}\n\n/**\n * Calculate safety factor\n *\n * @param {number} injuryCount - Number of injury reports in last 30 days\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateSafetyFactor(injuryCount, thresholds = DEFAULT_THRESHOLDS.safety) {\n  const count = injuryCount || 0\n\n  const score = calculateFactorScore(count, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (count === 0) {\n    label = 'No incidents'\n  } else if (count === 1) {\n    label = '1 incident in last 30 days'\n  } else {\n    label = `${count} incidents - safety review needed`\n  }\n\n  return { score, status, count, label }\n}\n\n/**\n * Calculate composite risk score\n *\n * @param {object} project - Project data object\n * @param {object} options - Optional custom thresholds and weights\n * @returns {object} Risk score result with breakdown\n */\nexport function calculateRiskScore(project, options = {}) {\n  const thresholds = { ...DEFAULT_THRESHOLDS, ...options.thresholds }\n  const weights = { ...FACTOR_WEIGHTS, ...options.weights }\n\n  // Calculate individual factors\n  const budgetFactor = calculateBudgetFactor(\n    project.totalCosts,\n    project.earnedRevenue,\n    thresholds.budget\n  )\n\n  const scheduleFactor = calculateScheduleFactor(\n    project.actualProgress,\n    project.expectedProgress,\n    thresholds.schedule\n  )\n\n  const corFactor = calculateCORExposureFactor(\n    project.pendingCORValue,\n    project.contractValue,\n    thresholds.corExposure\n  )\n\n  const activityFactor = calculateActivityFactor(\n    project.lastReportDate,\n    thresholds.activity\n  )\n\n  const safetyFactor = calculateSafetyFactor(\n    project.recentInjuryCount,\n    thresholds.safety\n  )\n\n  // Calculate weighted composite score\n  const compositeScore = Math.round(\n    budgetFactor.score * weights.budget +\n    scheduleFactor.score * weights.schedule +\n    corFactor.score * weights.corExposure +\n    activityFactor.score * weights.activity +\n    safetyFactor.score * weights.safety\n  )\n\n  // Determine overall status\n  let overallStatus\n  if (compositeScore <= 25) {\n    overallStatus = 'healthy'\n  } else if (compositeScore <= 60) {\n    overallStatus = 'warning'\n  } else {\n    overallStatus = 'critical'\n  }\n\n  // Generate summary label\n  let summaryLabel\n  if (overallStatus === 'healthy') {\n    summaryLabel = 'Project is on track'\n  } else if (overallStatus === 'warning') {\n    summaryLabel = 'Some factors need attention'\n  } else {\n    summaryLabel = 'Immediate review recommended'\n  }\n\n  return {\n    score: compositeScore,\n    status: overallStatus,\n    label: summaryLabel,\n    factors: {\n      budget: { ...budgetFactor, weight: weights.budget },\n      schedule: { ...scheduleFactor, weight: weights.schedule },\n      corExposure: { ...corFactor, weight: weights.corExposure },\n      activity: { ...activityFactor, weight: weights.activity },\n      safety: { ...safetyFactor, weight: weights.safety }\n    }\n  }\n}\n\n/**\n * Generate smart alerts based on risk factors\n *\n * @param {object} riskResult - Result from calculateRiskScore\n * @param {object} project - Project data for context\n * @returns {array} Array of alert objects\n */\nexport function generateSmartAlerts(riskResult, project) {\n  const alerts = []\n\n  const { factors } = riskResult\n\n  // Critical alerts (priority 1)\n  if (factors.budget.status === 'critical') {\n    alerts.push({\n      type: 'critical',\n      title: 'Budget Alert',\n      description: factors.budget.label,\n      action: 'Review costs immediately',\n      actionTarget: 'financials',\n      projectId: project.id\n    })\n  }\n\n  if (factors.activity.status === 'critical') {\n    alerts.push({\n      type: 'critical',\n      title: 'Activity Alert',\n      description: factors.activity.label,\n      action: 'Check project status',\n      actionTarget: 'overview',\n      projectId: project.id\n    })\n  }\n\n  if (factors.safety.status === 'critical') {\n    alerts.push({\n      type: 'critical',\n      title: 'Safety Alert',\n      description: factors.safety.label,\n      action: 'Review safety reports',\n      actionTarget: 'reports',\n      projectId: project.id\n    })\n  }\n\n  // Warning alerts (priority 2)\n  if (factors.budget.status === 'warning') {\n    alerts.push({\n      type: 'warning',\n      title: 'Budget Watch',\n      description: factors.budget.label,\n      action: 'Monitor costs',\n      actionTarget: 'financials',\n      projectId: project.id\n    })\n  }\n\n  if (factors.schedule.status === 'critical' || factors.schedule.status === 'warning') {\n    alerts.push({\n      type: factors.schedule.status === 'critical' ? 'critical' : 'warning',\n      title: 'Schedule Alert',\n      description: factors.schedule.label,\n      action: 'Review progress',\n      actionTarget: 'overview',\n      projectId: project.id\n    })\n  }\n\n  if (factors.corExposure.status === 'warning' || factors.corExposure.status === 'critical') {\n    alerts.push({\n      type: factors.corExposure.status === 'critical' ? 'critical' : 'warning',\n      title: 'COR Exposure',\n      description: factors.corExposure.label,\n      action: 'Review pending CORs',\n      actionTarget: 'cors',\n      projectId: project.id\n    })\n  }\n\n  // Info alerts (priority 3)\n  if (factors.activity.status === 'warning') {\n    alerts.push({\n      type: 'info',\n      title: 'Activity Notice',\n      description: factors.activity.label,\n      action: 'File daily report',\n      actionTarget: 'reports',\n      projectId: project.id\n    })\n  }\n\n  // Sort by priority\n  const priorityOrder = { critical: 0, warning: 1, info: 2 }\n  alerts.sort((a, b) => priorityOrder[a.type] - priorityOrder[b.type])\n\n  return alerts\n}\n\n/**\n * Calculate projections based on current trends\n */\nexport function calculateProjections(project) {\n  const { actualProgress, totalCosts, earnedRevenue, contractValue } = project\n\n  // Guard against division by zero\n  if (!actualProgress || actualProgress <= 0) {\n    return {\n      estimatedCompletionCost: null,\n      estimatedFinalMargin: null,\n      estimatedCompletionDate: null\n    }\n  }\n\n  // Project final cost based on current burn rate\n  const costPerPercent = totalCosts / actualProgress\n  const estimatedCompletionCost = Math.round(costPerPercent * 100)\n\n  // Calculate projected margin\n  const estimatedFinalMargin = contractValue > 0\n    ? ((contractValue - estimatedCompletionCost) / contractValue) * 100\n    : 0\n\n  // If we have start date and progress, estimate completion\n  // (This is simplified - real implementation would use more sophisticated projection)\n  let estimatedCompletionDate = null\n  if (project.startDate && actualProgress > 0 && actualProgress < 100) {\n    const startDate = new Date(project.startDate)\n    const now = new Date()\n    const daysElapsed = Math.max(1, (now - startDate) / (1000 * 60 * 60 * 24))\n    const progressPerDay = actualProgress / daysElapsed\n    const remainingProgress = 100 - actualProgress\n    const daysRemaining = remainingProgress / progressPerDay\n\n    estimatedCompletionDate = new Date(now.getTime() + daysRemaining * 24 * 60 * 60 * 1000)\n  }\n\n  return {\n    estimatedCompletionCost,\n    estimatedFinalMargin,\n    estimatedCompletionDate,\n    costPerPercent\n  }\n}\n\n// Helper function\nfunction formatNumber(num) {\n  if (num >= 1000000) {\n    return (num / 1000000).toFixed(1) + 'M'\n  }\n  if (num >= 1000) {\n    return (num / 1000).toFixed(0) + 'K'\n  }\n  return num.toFixed(0)\n}\n\nexport default {\n  calculateRiskScore,\n  generateSmartAlerts,\n  calculateProjections,\n  calculateBudgetFactor,\n  calculateScheduleFactor,\n  calculateCORExposureFactor,\n  calculateActivityFactor,\n  calculateSafetyFactor,\n  DEFAULT_THRESHOLDS,\n  FACTOR_WEIGHTS\n}\n","/**\n * Field Document PDF Export\n * Exports field-submitted documents (daily reports, incident reports, crew check-ins)\n * as a consolidated or individual PDF report.\n */\n\nconst loadJsPDF = () => import('jspdf')\n\nconst PAGE_WIDTH = 210 // A4 width in mm\nconst MARGIN = 14\nconst CONTENT_WIDTH = PAGE_WIDTH - MARGIN * 2\n\n/**\n * Format currency for display\n */\nconst formatCurrency = (value) => {\n  return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(value || 0)\n}\n\n/**\n * Format date for display\n */\nconst formatDate = (dateStr) => {\n  if (!dateStr) return ''\n  const d = new Date(dateStr + (dateStr.includes('T') ? '' : 'T12:00:00'))\n  return d.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric', year: 'numeric' })\n}\n\n/**\n * Add page footer\n */\nconst addFooter = (doc, pageNum, totalPages) => {\n  const y = doc.internal.pageSize.height - 8\n  doc.setFontSize(7)\n  doc.setTextColor(128, 128, 128)\n  doc.text(`Page ${pageNum} of ${totalPages}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  doc.text(`Generated ${new Date().toLocaleString()}  FieldSync`, PAGE_WIDTH - MARGIN, y, { align: 'right' })\n}\n\n/**\n * Check if we need a new page\n */\nconst checkPage = (doc, y, needed = 30) => {\n  if (y + needed > doc.internal.pageSize.height - 20) {\n    doc.addPage()\n    return 20\n  }\n  return y\n}\n\n/**\n * Export daily reports as PDF\n * @param {Array} reports - Daily report objects\n * @param {Object} project - Project info\n * @returns {Promise<void>}\n */\nexport async function exportDailyReportsPDF(reports, project) {\n  const jsPDFModule = await loadJsPDF()\n  const jsPDF = jsPDFModule.default\n  const doc = new jsPDF()\n\n  let y = 20\n\n  // Title\n  doc.setFontSize(18)\n  doc.setFont(undefined, 'bold')\n  doc.text('Daily Reports', PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 8\n\n  doc.setFontSize(11)\n  doc.setFont(undefined, 'normal')\n  doc.text(`Project: ${project.name}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 6\n  doc.text(`${reports.length} report${reports.length !== 1 ? 's' : ''}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 12\n\n  // Each report\n  reports.forEach((report, idx) => {\n    y = checkPage(doc, y, 60)\n\n    // Report header\n    doc.setDrawColor(200, 200, 200)\n    doc.setFillColor(245, 247, 250)\n    doc.roundedRect(MARGIN, y - 2, CONTENT_WIDTH, 10, 2, 2, 'F')\n\n    doc.setFontSize(11)\n    doc.setFont(undefined, 'bold')\n    doc.setTextColor(30, 30, 30)\n    doc.text(`${formatDate(report.report_date)}`, MARGIN + 4, y + 5)\n\n    const statusText = report.status === 'submitted' ? 'Submitted' : 'Draft'\n    doc.setFontSize(9)\n    doc.setFont(undefined, 'normal')\n    doc.text(statusText, PAGE_WIDTH - MARGIN - 4, y + 5, { align: 'right' })\n    y += 14\n\n    doc.setTextColor(0, 0, 0)\n\n    // Metrics row\n    doc.setFontSize(9)\n    const metrics = [\n      `Crew: ${report.crew_count || 0}`,\n      `Tasks: ${report.tasks_completed || 0}/${report.tasks_total || 0}`,\n      `T&M Tickets: ${report.tm_tickets_count || 0}`,\n      `Photos: ${report.photos_count || 0}`\n    ]\n    doc.text(metrics.join('    |    '), MARGIN + 4, y)\n    y += 7\n\n    // Crew list\n    if (report.crew_list?.length > 0) {\n      doc.setFont(undefined, 'bold')\n      doc.text('Crew:', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      const crewNames = report.crew_list.map(w => `${w.name} (${w.role || 'Laborer'})`).join(', ')\n      const crewLines = doc.splitTextToSize(crewNames, CONTENT_WIDTH - 8)\n      y += 4\n      doc.text(crewLines, MARGIN + 4, y)\n      y += crewLines.length * 4 + 2\n    }\n\n    // Field notes\n    if (report.field_notes) {\n      y = checkPage(doc, y, 15)\n      doc.setFont(undefined, 'bold')\n      doc.text('Field Notes:', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      y += 4\n      const noteLines = doc.splitTextToSize(report.field_notes, CONTENT_WIDTH - 8)\n      doc.text(noteLines, MARGIN + 4, y)\n      y += noteLines.length * 4 + 2\n    }\n\n    // Issues\n    if (report.issues) {\n      y = checkPage(doc, y, 15)\n      doc.setFont(undefined, 'bold')\n      doc.text('Issues:', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      y += 4\n      const issueLines = doc.splitTextToSize(report.issues, CONTENT_WIDTH - 8)\n      doc.text(issueLines, MARGIN + 4, y)\n      y += issueLines.length * 4 + 2\n    }\n\n    y += 8\n\n    // Divider\n    if (idx < reports.length - 1) {\n      doc.setDrawColor(220, 220, 220)\n      doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n      y += 6\n    }\n  })\n\n  const fileName = `${project.name}_Daily_Reports_${new Date().toISOString().split('T')[0]}.pdf`\n  doc.save(fileName)\n}\n\n/**\n * Export incident/injury reports as PDF\n * @param {Array} reports - Injury report objects\n * @param {Object} project - Project info\n * @returns {Promise<void>}\n */\nexport async function exportIncidentReportsPDF(reports, project) {\n  const jsPDFModule = await loadJsPDF()\n  const jsPDF = jsPDFModule.default\n  const doc = new jsPDF()\n\n  let y = 20\n\n  // Title\n  doc.setFontSize(18)\n  doc.setFont(undefined, 'bold')\n  doc.text('Incident / Injury Reports', PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 8\n\n  doc.setFontSize(11)\n  doc.setFont(undefined, 'normal')\n  doc.text(`Project: ${project.name}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 6\n  doc.text(`${reports.length} report${reports.length !== 1 ? 's' : ''}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 12\n\n  reports.forEach((report, idx) => {\n    y = checkPage(doc, y, 50)\n\n    // Header bar\n    const severityColors = {\n      minor: [34, 197, 94],\n      serious: [245, 158, 11],\n      critical: [239, 68, 68],\n      near_miss: [59, 130, 246]\n    }\n    const color = severityColors[report.injury_type] || [128, 128, 128]\n\n    doc.setFillColor(...color)\n    doc.roundedRect(MARGIN, y - 2, 3, 14, 1, 1, 'F')\n\n    doc.setFontSize(11)\n    doc.setFont(undefined, 'bold')\n    doc.setTextColor(30, 30, 30)\n    doc.text(`${formatDate(report.incident_date)}`, MARGIN + 8, y + 4)\n\n    doc.setFontSize(9)\n    const typeLabel = (report.injury_type || '').replace('_', ' ').toUpperCase()\n    doc.text(typeLabel, MARGIN + 8, y + 10)\n\n    doc.setFont(undefined, 'normal')\n    doc.text(report.status === 'open' ? 'OPEN' : 'CLOSED', PAGE_WIDTH - MARGIN - 4, y + 4, { align: 'right' })\n    y += 16\n\n    doc.setTextColor(0, 0, 0)\n\n    // Description\n    if (report.description) {\n      doc.setFontSize(9)\n      doc.setFont(undefined, 'bold')\n      doc.text('Description:', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      y += 4\n      const lines = doc.splitTextToSize(report.description, CONTENT_WIDTH - 8)\n      doc.text(lines, MARGIN + 4, y)\n      y += lines.length * 4 + 2\n    }\n\n    // Location\n    if (report.location) {\n      doc.setFont(undefined, 'bold')\n      doc.text('Location: ', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      doc.text(report.location, MARGIN + 30, y)\n      y += 6\n    }\n\n    y += 6\n\n    if (idx < reports.length - 1) {\n      doc.setDrawColor(220, 220, 220)\n      doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n      y += 6\n    }\n  })\n\n  const fileName = `${project.name}_Incident_Reports_${new Date().toISOString().split('T')[0]}.pdf`\n  doc.save(fileName)\n}\n\n/**\n * Export crew check-in history as PDF\n * @param {Array} checkins - Crew check-in objects\n * @param {Object} project - Project info\n * @returns {Promise<void>}\n */\nexport async function exportCrewCheckinsPDF(checkins, project) {\n  const jsPDFModule = await loadJsPDF()\n  const jsPDF = jsPDFModule.default\n  const doc = new jsPDF()\n\n  let y = 20\n\n  doc.setFontSize(18)\n  doc.setFont(undefined, 'bold')\n  doc.text('Crew Check-In History', PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 8\n\n  doc.setFontSize(11)\n  doc.setFont(undefined, 'normal')\n  doc.text(`Project: ${project.name}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 6\n  doc.text(`${checkins.length} check-in${checkins.length !== 1 ? 's' : ''}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 12\n\n  checkins.forEach((checkin, idx) => {\n    y = checkPage(doc, y, 30)\n    const workers = checkin.workers || []\n\n    // Date header\n    doc.setFillColor(245, 247, 250)\n    doc.roundedRect(MARGIN, y - 2, CONTENT_WIDTH, 9, 2, 2, 'F')\n\n    doc.setFontSize(10)\n    doc.setFont(undefined, 'bold')\n    doc.setTextColor(30, 30, 30)\n    doc.text(formatDate(checkin.check_in_date), MARGIN + 4, y + 4)\n    doc.setFont(undefined, 'normal')\n    doc.text(`${workers.length} workers`, PAGE_WIDTH - MARGIN - 4, y + 4, { align: 'right' })\n    y += 12\n\n    doc.setTextColor(0, 0, 0)\n    doc.setFontSize(9)\n\n    // Worker list as table\n    if (workers.length > 0) {\n      doc.setFont(undefined, 'bold')\n      doc.text('Name', MARGIN + 4, y)\n      doc.text('Role', 110, y)\n      y += 5\n\n      doc.setFont(undefined, 'normal')\n      workers.forEach(w => {\n        y = checkPage(doc, y, 6)\n        doc.text(w.name || '', MARGIN + 4, y)\n        doc.text(w.role || 'Laborer', 110, y)\n        y += 4.5\n      })\n    }\n\n    y += 6\n\n    if (idx < checkins.length - 1) {\n      doc.setDrawColor(220, 220, 220)\n      doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n      y += 5\n    }\n  })\n\n  const fileName = `${project.name}_Crew_Checkins_${new Date().toISOString().split('T')[0]}.pdf`\n  doc.save(fileName)\n}\n\n/**\n * Export ALL field documents as a single consolidated PDF\n * @param {Object} params\n * @param {Array} params.dailyReports\n * @param {Array} params.incidentReports\n * @param {Array} params.crewCheckins\n * @param {Object} params.project\n * @returns {Promise<void>}\n */\nexport async function exportAllFieldDocumentsPDF({ dailyReports = [], incidentReports = [], crewCheckins = [], project }) {\n  const jsPDFModule = await loadJsPDF()\n  const jsPDF = jsPDFModule.default\n  const doc = new jsPDF()\n\n  let y = 20\n\n  // Cover page\n  doc.setFontSize(22)\n  doc.setFont(undefined, 'bold')\n  doc.text('Field Documents Report', PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 10\n\n  doc.setFontSize(13)\n  doc.setFont(undefined, 'normal')\n  doc.text(`Project: ${project.name}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 8\n\n  doc.setFontSize(10)\n  doc.text(`Generated: ${new Date().toLocaleDateString()}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 16\n\n  // Summary table\n  doc.setFontSize(11)\n  doc.setFont(undefined, 'bold')\n  doc.text('Document Summary', MARGIN, y)\n  y += 8\n\n  doc.setFontSize(10)\n  doc.setFont(undefined, 'normal')\n  const summaryItems = [\n    [`Daily Reports`, `${dailyReports.length}`],\n    [`Incident Reports`, `${incidentReports.length}`],\n    [`Crew Check-Ins`, `${crewCheckins.length}`]\n  ]\n  summaryItems.forEach(([label, count]) => {\n    doc.text(label, MARGIN + 4, y)\n    doc.text(count, 100, y)\n    y += 6\n  })\n\n  // Daily Reports Section\n  if (dailyReports.length > 0) {\n    doc.addPage()\n    y = 20\n\n    doc.setFontSize(16)\n    doc.setFont(undefined, 'bold')\n    doc.text('Daily Reports', MARGIN, y)\n    y += 10\n\n    dailyReports.forEach((report, idx) => {\n      y = checkPage(doc, y, 40)\n\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'bold')\n      doc.setTextColor(30, 30, 30)\n      doc.text(formatDate(report.report_date), MARGIN + 2, y)\n      doc.setFont(undefined, 'normal')\n      doc.setFontSize(8)\n      doc.text(`Crew: ${report.crew_count || 0} | Tasks: ${report.tasks_completed || 0}/${report.tasks_total || 0} | T&M: ${report.tm_tickets_count || 0}`, MARGIN + 60, y)\n      y += 6\n\n      doc.setTextColor(0, 0, 0)\n      doc.setFontSize(9)\n\n      if (report.field_notes) {\n        const lines = doc.splitTextToSize(report.field_notes, CONTENT_WIDTH - 4)\n        doc.text(lines, MARGIN + 2, y)\n        y += lines.length * 4 + 2\n      }\n\n      if (report.issues) {\n        doc.setFont(undefined, 'bold')\n        doc.text('Issues: ', MARGIN + 2, y)\n        doc.setFont(undefined, 'normal')\n        const issueLines = doc.splitTextToSize(report.issues, CONTENT_WIDTH - 20)\n        doc.text(issueLines, MARGIN + 20, y)\n        y += issueLines.length * 4 + 2\n      }\n\n      y += 4\n      if (idx < dailyReports.length - 1) {\n        doc.setDrawColor(220, 220, 220)\n        doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n        y += 4\n      }\n    })\n  }\n\n  // Incident Reports Section\n  if (incidentReports.length > 0) {\n    doc.addPage()\n    y = 20\n\n    doc.setFontSize(16)\n    doc.setFont(undefined, 'bold')\n    doc.text('Incident / Injury Reports', MARGIN, y)\n    y += 10\n\n    incidentReports.forEach((report, idx) => {\n      y = checkPage(doc, y, 35)\n\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'bold')\n      doc.setTextColor(30, 30, 30)\n      doc.text(formatDate(report.incident_date), MARGIN + 2, y)\n      doc.setFontSize(8)\n      doc.setFont(undefined, 'normal')\n      const typeLabel = (report.injury_type || '').replace('_', ' ').toUpperCase()\n      doc.text(`${typeLabel}  ${report.status?.toUpperCase() || ''}`, MARGIN + 60, y)\n      y += 6\n\n      doc.setTextColor(0, 0, 0)\n      doc.setFontSize(9)\n\n      if (report.description) {\n        const lines = doc.splitTextToSize(report.description, CONTENT_WIDTH - 4)\n        doc.text(lines, MARGIN + 2, y)\n        y += lines.length * 4 + 2\n      }\n\n      if (report.location) {\n        doc.text(`Location: ${report.location}`, MARGIN + 2, y)\n        y += 5\n      }\n\n      y += 4\n      if (idx < incidentReports.length - 1) {\n        doc.setDrawColor(220, 220, 220)\n        doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n        y += 4\n      }\n    })\n  }\n\n  // Crew Check-Ins Section\n  if (crewCheckins.length > 0) {\n    doc.addPage()\n    y = 20\n\n    doc.setFontSize(16)\n    doc.setFont(undefined, 'bold')\n    doc.text('Crew Check-In History', MARGIN, y)\n    y += 10\n\n    crewCheckins.forEach((checkin, idx) => {\n      y = checkPage(doc, y, 20)\n      const workers = checkin.workers || []\n\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'bold')\n      doc.setTextColor(30, 30, 30)\n      doc.text(formatDate(checkin.check_in_date), MARGIN + 2, y)\n      doc.setFont(undefined, 'normal')\n      doc.setFontSize(8)\n      doc.text(`${workers.length} workers`, MARGIN + 60, y)\n      y += 6\n\n      doc.setTextColor(0, 0, 0)\n      doc.setFontSize(8)\n\n      if (workers.length > 0) {\n        const workerList = workers.map(w => `${w.name} (${w.role || 'Laborer'})`).join(', ')\n        const lines = doc.splitTextToSize(workerList, CONTENT_WIDTH - 4)\n        doc.text(lines, MARGIN + 2, y)\n        y += lines.length * 3.5 + 3\n      }\n\n      if (idx < crewCheckins.length - 1) {\n        doc.setDrawColor(230, 230, 230)\n        doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n        y += 3\n      }\n    })\n  }\n\n  const fileName = `${project.name}_Field_Documents_${new Date().toISOString().split('T')[0]}.pdf`\n  doc.save(fileName)\n}\n","import { useState, useEffect, useRef, useCallback } from 'react'\nimport { Search, X, FolderOpen, FileText, Users, ClipboardList, ChevronRight, Command } from 'lucide-react'\nimport { db } from '../lib/supabase'\n\nexport default function UniversalSearch({\n  isOpen,\n  onClose,\n  companyId,\n  onSelectProject,\n  onSelectTicket,\n  onSelectCOR,\n  onShowToast\n}) {\n  const [query, setQuery] = useState('')\n  const [results, setResults] = useState({ projects: [], tickets: [], cors: [], workers: [] })\n  const [loading, setLoading] = useState(false)\n  const [selectedIndex, setSelectedIndex] = useState(0)\n  const inputRef = useRef(null)\n  const searchTimeoutRef = useRef(null)\n  const focusTimeoutRef = useRef(null)\n\n  // Cleanup timers on unmount\n  useEffect(() => {\n    return () => {\n      if (searchTimeoutRef.current) clearTimeout(searchTimeoutRef.current)\n      if (focusTimeoutRef.current) clearTimeout(focusTimeoutRef.current)\n    }\n  }, [])\n\n  // Focus input when modal opens\n  useEffect(() => {\n    if (isOpen) {\n      setQuery('')\n      setResults({ projects: [], tickets: [], cors: [], workers: [] })\n      setSelectedIndex(0)\n      focusTimeoutRef.current = setTimeout(() => inputRef.current?.focus(), 50)\n    }\n  }, [isOpen])\n\n  // Debounced search\n  const performSearch = useCallback(async (searchQuery) => {\n    if (!searchQuery.trim() || searchQuery.length < 2) {\n      setResults({ projects: [], tickets: [], cors: [], workers: [] })\n      return\n    }\n\n    setLoading(true)\n    try {\n      const searchResults = await db.universalSearch(companyId, searchQuery.trim())\n      setResults(searchResults)\n      setSelectedIndex(0)\n    } catch (error) {\n      console.error('Search error:', error)\n      onShowToast?.('Search failed', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }, [companyId, onShowToast])\n\n  // Handle input change with debounce\n  const handleInputChange = (e) => {\n    const value = e.target.value\n    setQuery(value)\n\n    // Clear previous timeout\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current)\n    }\n\n    // Debounce search\n    searchTimeoutRef.current = setTimeout(() => {\n      performSearch(value)\n    }, 200)\n  }\n\n  // Get all results as flat array for keyboard navigation\n  const getAllResults = () => {\n    const all = []\n    results.projects.forEach(p => all.push({ type: 'project', data: p }))\n    results.tickets.forEach(t => all.push({ type: 'ticket', data: t }))\n    results.cors.forEach(c => all.push({ type: 'cor', data: c }))\n    results.workers.forEach(w => all.push({ type: 'worker', data: w }))\n    return all\n  }\n\n  const allResults = getAllResults()\n  const hasResults = allResults.length > 0\n\n  // Handle keyboard navigation\n  const handleKeyDown = (e) => {\n    if (e.key === 'Escape') {\n      onClose()\n    } else if (e.key === 'ArrowDown') {\n      e.preventDefault()\n      setSelectedIndex(prev => Math.min(prev + 1, allResults.length - 1))\n    } else if (e.key === 'ArrowUp') {\n      e.preventDefault()\n      setSelectedIndex(prev => Math.max(prev - 1, 0))\n    } else if (e.key === 'Enter' && hasResults) {\n      e.preventDefault()\n      handleSelect(allResults[selectedIndex])\n    }\n  }\n\n  // Handle selection\n  const handleSelect = (item) => {\n    if (!item) return\n\n    switch (item.type) {\n      case 'project':\n        onSelectProject?.(item.data)\n        break\n      case 'ticket':\n        onSelectTicket?.(item.data)\n        break\n      case 'cor':\n        onSelectCOR?.(item.data)\n        break\n      case 'worker':\n        // Navigate to project where worker was last seen\n        if (item.data.lastProject) {\n          onSelectProject?.(item.data.lastProject)\n        }\n        break\n    }\n    onClose()\n  }\n\n  // Get icon for result type\n  const getIcon = (type) => {\n    switch (type) {\n      case 'project': return FolderOpen\n      case 'ticket': return FileText\n      case 'cor': return ClipboardList\n      case 'worker': return Users\n      default: return FileText\n    }\n  }\n\n  // Get label for result type\n  const getTypeLabel = (type) => {\n    switch (type) {\n      case 'project': return 'Project'\n      case 'ticket': return 'T&M Ticket'\n      case 'cor': return 'Change Order'\n      case 'worker': return 'Worker'\n      default: return type\n    }\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <div className=\"universal-search-overlay\" onClick={onClose}>\n      <div className=\"universal-search-modal\" onClick={e => e.stopPropagation()}>\n        {/* Search Input */}\n        <div className=\"universal-search-input-wrapper\">\n          <Search size={20} className=\"universal-search-icon\" />\n          <input\n            ref={inputRef}\n            type=\"text\"\n            value={query}\n            onChange={handleInputChange}\n            onKeyDown={handleKeyDown}\n            placeholder=\"Search projects, tickets, CORs, workers...\"\n            className=\"universal-search-input\"\n            autoComplete=\"off\"\n            autoCorrect=\"off\"\n            spellCheck=\"false\"\n          />\n          {query && (\n            <button className=\"universal-search-clear\" onClick={() => setQuery('')}>\n              <X size={16} />\n            </button>\n          )}\n          <div className=\"universal-search-shortcut\">\n            <span>esc</span>\n          </div>\n        </div>\n\n        {/* Results */}\n        <div className=\"universal-search-results\">\n          {loading ? (\n            <div className=\"universal-search-loading\">\n              <div className=\"spinner-small\"></div>\n              <span>Searching...</span>\n            </div>\n          ) : !query.trim() ? (\n            <div className=\"universal-search-empty\">\n              <div className=\"universal-search-tip\">\n                <Command size={14} />\n                <span>Type to search across all data</span>\n              </div>\n              <div className=\"universal-search-hints\">\n                <span>Projects</span>\n                <span>T&M Tickets</span>\n                <span>Change Orders</span>\n                <span>Workers</span>\n              </div>\n            </div>\n          ) : !hasResults ? (\n            <div className=\"universal-search-no-results\">\n              <span>No results for \"{query}\"</span>\n            </div>\n          ) : (\n            <>\n              {/* Projects */}\n              {results.projects.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <FolderOpen size={14} />\n                    <span>Projects</span>\n                  </div>\n                  {results.projects.map((project, idx) => {\n                    const globalIdx = idx\n                    return (\n                      <button\n                        key={project.id}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'project', data: project })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <FolderOpen size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">{project.name}</span>\n                          {project.job_number && (\n                            <span className=\"universal-search-item-meta\">#{project.job_number}</span>\n                          )}\n                        </div>\n                        <ChevronRight size={16} className=\"universal-search-item-arrow\" />\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n\n              {/* T&M Tickets */}\n              {results.tickets.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <FileText size={14} />\n                    <span>T&M Tickets</span>\n                  </div>\n                  {results.tickets.map((ticket, idx) => {\n                    const globalIdx = results.projects.length + idx\n                    return (\n                      <button\n                        key={ticket.id}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'ticket', data: ticket })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <FileText size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">\n                            {ticket.description?.substring(0, 50) || 'T&M Ticket'}\n                            {ticket.description?.length > 50 && '...'}\n                          </span>\n                          <span className=\"universal-search-item-meta\">\n                            {ticket.projectName}  {ticket.work_date}\n                          </span>\n                        </div>\n                        <span className={`universal-search-item-badge ${ticket.status}`}>\n                          {ticket.status}\n                        </span>\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n\n              {/* Change Orders */}\n              {results.cors.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <ClipboardList size={14} />\n                    <span>Change Orders</span>\n                  </div>\n                  {results.cors.map((cor, idx) => {\n                    const globalIdx = results.projects.length + results.tickets.length + idx\n                    return (\n                      <button\n                        key={cor.id}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'cor', data: cor })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <ClipboardList size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">\n                            {cor.cor_number ? `COR #${cor.cor_number}: ` : ''}{cor.title}\n                          </span>\n                          <span className=\"universal-search-item-meta\">\n                            {cor.projectName}\n                          </span>\n                        </div>\n                        <span className={`universal-search-item-badge ${cor.status}`}>\n                          {cor.status}\n                        </span>\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n\n              {/* Workers */}\n              {results.workers.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <Users size={14} />\n                    <span>Workers</span>\n                  </div>\n                  {results.workers.map((worker, idx) => {\n                    const globalIdx = results.projects.length + results.tickets.length + results.cors.length + idx\n                    return (\n                      <button\n                        key={`${worker.name}-${idx}`}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'worker', data: worker })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <Users size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">{worker.name}</span>\n                          <span className=\"universal-search-item-meta\">\n                            {worker.role}  {worker.projectName}\n                          </span>\n                        </div>\n                        <ChevronRight size={16} className=\"universal-search-item-arrow\" />\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n            </>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"universal-search-footer\">\n          <div className=\"universal-search-footer-hint\">\n            <span className=\"key\"></span> navigate\n          </div>\n          <div className=\"universal-search-footer-hint\">\n            <span className=\"key\"></span> select\n          </div>\n          <div className=\"universal-search-footer-hint\">\n            <span className=\"key\">esc</span> close\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// Hook for keyboard shortcut\nexport function useUniversalSearch() {\n  const [isOpen, setIsOpen] = useState(false)\n\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      // Cmd+K (Mac) or Ctrl+K (Windows/Linux)\n      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {\n        e.preventDefault()\n        setIsOpen(prev => !prev)\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyDown)\n    return () => document.removeEventListener('keydown', handleKeyDown)\n  }, [])\n\n  return { isOpen, setIsOpen, open: () => setIsOpen(true), close: () => setIsOpen(false) }\n}\n","import React, { useState, useCallback } from 'react'\nimport { AlertTriangle, XCircle, Info, X, ArrowRight } from 'lucide-react'\n\n/**\n * SmartAlerts\n *\n * Container for displaying prioritized actionable alerts.\n * Alerts can be dismissed and are sorted by priority.\n *\n * @param {array} alerts - Array of alert objects\n * @param {function} onAction - Callback when alert action is clicked\n * @param {function} onDismiss - Callback when alert is dismissed\n * @param {number} maxVisible - Maximum alerts to show (default: 3)\n */\nexport function SmartAlerts({\n  alerts = [],\n  onAction,\n  onDismiss,\n  maxVisible = 3,\n  className = ''\n}) {\n  const [dismissedIds, setDismissedIds] = useState(new Set())\n\n  const visibleAlerts = alerts\n    .filter(alert => !dismissedIds.has(alert.id || `${alert.projectId}-${alert.type}-${alert.title}`))\n    .slice(0, maxVisible)\n\n  const handleDismiss = useCallback((alert) => {\n    const alertId = alert.id || `${alert.projectId}-${alert.type}-${alert.title}`\n    setDismissedIds(prev => new Set([...prev, alertId]))\n    onDismiss?.(alert)\n  }, [onDismiss])\n\n  if (visibleAlerts.length === 0) {\n    return null\n  }\n\n  return (\n    <div\n      className={`smart-alerts ${className}`}\n      role=\"region\"\n      aria-label=\"Project alerts\"\n      aria-live=\"polite\"\n    >\n      {visibleAlerts.map((alert, index) => (\n        <SmartAlertCard\n          key={alert.id || `${alert.projectId}-${alert.type}-${index}`}\n          alert={alert}\n          onAction={onAction}\n          onDismiss={() => handleDismiss(alert)}\n        />\n      ))}\n\n      {alerts.length > maxVisible && (\n        <div className=\"smart-alerts__overflow\">\n          <span className=\"smart-alerts__overflow-text\">\n            +{alerts.length - maxVisible} more alerts\n          </span>\n        </div>\n      )}\n    </div>\n  )\n}\n\n/**\n * SmartAlertCard\n *\n * Individual alert card with icon, message, action, and dismiss.\n *\n * @param {object} alert - Alert object\n * @param {function} onAction - Action button click handler\n * @param {function} onDismiss - Dismiss button click handler\n */\nexport function SmartAlertCard({\n  alert,\n  onAction,\n  onDismiss\n}) {\n  const {\n    type = 'info',\n    title,\n    description,\n    action,\n    actionTarget,\n    projectId,\n    projectName\n  } = alert\n\n  const icons = {\n    critical: XCircle,\n    warning: AlertTriangle,\n    info: Info\n  }\n\n  const Icon = icons[type] || Info\n\n  const handleAction = () => {\n    onAction?.({\n      target: actionTarget,\n      projectId,\n      alert\n    })\n  }\n\n  return (\n    <div\n      className={`smart-alert smart-alert--${type}`}\n      role=\"alert\"\n      aria-live={type === 'critical' ? 'assertive' : 'polite'}\n    >\n      <Icon className=\"smart-alert__icon\" aria-hidden=\"true\" />\n\n      <div className=\"smart-alert__content\">\n        <div className=\"smart-alert__title\">\n          {projectName && <span className=\"smart-alert__project\">{projectName}: </span>}\n          {title}\n        </div>\n\n        {description && (\n          <div className=\"smart-alert__description\">{description}</div>\n        )}\n\n        {action && (\n          <div className=\"smart-alert__action\">\n            <button\n              type=\"button\"\n              className=\"smart-alert__action-btn\"\n              onClick={handleAction}\n            >\n              {action}\n              <ArrowRight size={14} aria-hidden=\"true\" />\n            </button>\n          </div>\n        )}\n      </div>\n\n      {onDismiss && (\n        <button\n          type=\"button\"\n          className=\"smart-alert__dismiss\"\n          onClick={onDismiss}\n          aria-label=\"Dismiss alert\"\n        >\n          <X size={18} aria-hidden=\"true\" />\n        </button>\n      )}\n    </div>\n  )\n}\n\n/**\n * AlertSummaryBanner\n *\n * Compact banner showing alert counts by type.\n * Useful when space is limited.\n *\n * @param {array} alerts - Array of alert objects\n * @param {function} onClick - Click handler to expand alerts\n */\nexport function AlertSummaryBanner({ alerts = [], onClick, className = '' }) {\n  const counts = {\n    critical: alerts.filter(a => a.type === 'critical').length,\n    warning: alerts.filter(a => a.type === 'warning').length,\n    info: alerts.filter(a => a.type === 'info').length\n  }\n\n  const total = alerts.length\n\n  if (total === 0) return null\n\n  return (\n    <button\n      type=\"button\"\n      className={`alert-summary-banner ${className}`}\n      onClick={onClick}\n      aria-label={`${total} alerts: ${counts.critical} critical, ${counts.warning} warnings, ${counts.info} info. Click to view.`}\n    >\n      {counts.critical > 0 && (\n        <span className=\"alert-summary-banner__item alert-summary-banner__item--critical\">\n          <XCircle size={14} aria-hidden=\"true\" />\n          {counts.critical}\n        </span>\n      )}\n      {counts.warning > 0 && (\n        <span className=\"alert-summary-banner__item alert-summary-banner__item--warning\">\n          <AlertTriangle size={14} aria-hidden=\"true\" />\n          {counts.warning}\n        </span>\n      )}\n      {counts.info > 0 && (\n        <span className=\"alert-summary-banner__item alert-summary-banner__item--info\">\n          <Info size={14} aria-hidden=\"true\" />\n          {counts.info}\n        </span>\n      )}\n      <ArrowRight size={14} className=\"alert-summary-banner__arrow\" aria-hidden=\"true\" />\n    </button>\n  )\n}\n\n/**\n * NoAlertsMessage\n *\n * Positive message when there are no alerts.\n */\nexport function NoAlertsMessage({ className = '' }) {\n  return (\n    <div className={`no-alerts-message ${className}`}>\n      <span className=\"no-alerts-message__icon\" aria-hidden=\"true\"></span>\n      <span className=\"no-alerts-message__text\">All projects on track</span>\n    </div>\n  )\n}\n\n/**\n * Helper to aggregate alerts from multiple projects\n */\nexport function aggregateAlerts(projectAlerts) {\n  // Flatten all alerts from all projects\n  const allAlerts = projectAlerts.flatMap(p => p.alerts || [])\n\n  // Sort by priority\n  const priorityOrder = { critical: 0, warning: 1, info: 2 }\n  allAlerts.sort((a, b) => {\n    const priorityDiff = priorityOrder[a.type] - priorityOrder[b.type]\n    if (priorityDiff !== 0) return priorityDiff\n    // Secondary sort by project name\n    return (a.projectName || '').localeCompare(b.projectName || '')\n  })\n\n  return allAlerts\n}\n\nexport default SmartAlerts\n","import { useState, useEffect } from 'react'\nimport { HardHat } from 'lucide-react'\nimport { db } from '../lib/supabase'\n\nexport default function ManDayCosts({ project, company, onShowToast }) {\n  const [costData, setCostData] = useState(null)\n  const [loading, setLoading] = useState(true)\n  const [expanded, setExpanded] = useState(false)\n\n  useEffect(() => {\n    if (project?.id && company?.id) {\n      loadCostData()\n\n      // Subscribe to crew check-in updates for real-time cost updates\n      const subscription = db.subscribeToCrewCheckins?.(project.id, () => {\n        loadCostData()\n      })\n\n      return () => {\n        if (subscription) db.unsubscribe?.(subscription)\n      }\n    }\n  }, [project?.id, company?.id])\n\n  const loadCostData = async () => {\n    try {\n      const data = await db.calculateManDayCosts(\n        project.id,\n        company.id,\n        project.work_type || 'demolition',\n        project.job_type || 'standard'\n      )\n      setCostData(data)\n    } catch (error) {\n      console.error('Error loading man day costs:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const formatCurrency = (amount) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0\n    }).format(amount)\n  }\n\n  const formatDate = (dateStr) => {\n    return new Date(dateStr).toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric'\n    })\n  }\n\n  const getRoleLabel = (role) => {\n    const labels = {\n      foreman: 'Foreman',\n      supervisor: 'Supervisor',\n      operator: 'Operator',\n      laborer: 'Laborer'\n    }\n    return labels[role] || role.charAt(0).toUpperCase() + role.slice(1)\n  }\n\n  if (loading) {\n    return (\n      <div className=\"man-day-costs card\">\n        <div className=\"man-day-header\">\n          <h3>Man Day Costs</h3>\n        </div>\n        <div className=\"loading\">Loading...</div>\n      </div>\n    )\n  }\n\n  if (!costData || costData.totalManDays === 0) {\n    return (\n      <div className=\"man-day-costs card\">\n        <div className=\"man-day-header\">\n          <h3>Man Day Costs</h3>\n        </div>\n        <div className=\"man-day-empty\">\n          <span className=\"empty-icon\"><HardHat size={32} /></span>\n          <p>No crew check-ins yet</p>\n          <small>Costs will appear as crew checks in from the field</small>\n        </div>\n      </div>\n    )\n  }\n\n  const roleEntries = Object.entries(costData.byRole || {})\n\n  return (\n    <div className=\"man-day-costs card\">\n      <div className=\"man-day-header\" onClick={() => setExpanded(!expanded)}>\n        <div className=\"man-day-title-row\">\n          <h3>Man Day Costs</h3>\n          <span className=\"man-day-total\">{formatCurrency(costData.totalCost)}</span>\n        </div>\n        <button className=\"man-day-toggle\">\n          {expanded ? ' Collapse' : ' Details'}\n        </button>\n      </div>\n\n      {/* Summary Stats */}\n      <div className=\"man-day-summary\">\n        <div className=\"man-day-stat\">\n          <span className=\"stat-value\">{costData.daysWorked}</span>\n          <span className=\"stat-label\">Days Worked</span>\n        </div>\n        <div className=\"man-day-stat\">\n          <span className=\"stat-value\">{costData.totalManDays}</span>\n          <span className=\"stat-label\">Total Man Days</span>\n        </div>\n        <div className=\"man-day-stat\">\n          <span className=\"stat-value\">{formatCurrency(costData.totalCost)}</span>\n          <span className=\"stat-label\">Total Labor Cost</span>\n        </div>\n        <div className=\"man-day-stat\">\n          <span className=\"stat-value\">\n            {costData.daysWorked > 0\n              ? formatCurrency(costData.totalCost / costData.daysWorked)\n              : '$0'\n            }\n          </span>\n          <span className=\"stat-label\">Avg Cost/Day</span>\n        </div>\n      </div>\n\n      {/* Expanded Details */}\n      {expanded && (\n        <div className=\"man-day-details\">\n          {/* By Role Breakdown */}\n          {roleEntries.length > 0 && (\n            <div className=\"man-day-section\">\n              <h4>By Role</h4>\n              <div className=\"man-day-role-list\">\n                {roleEntries.map(([role, data]) => (\n                  <div key={role} className=\"man-day-role-row\">\n                    <div className=\"role-info\">\n                      <span className=\"role-name\">{getRoleLabel(role)}</span>\n                      <span className=\"role-rate\">{formatCurrency(data.rate)}/day</span>\n                    </div>\n                    <div className=\"role-stats\">\n                      <span className=\"role-count\">{data.count} days</span>\n                      <span className=\"role-cost\">{formatCurrency(data.cost)}</span>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Recent Days */}\n          {costData.byDate?.length > 0 && (\n            <div className=\"man-day-section\">\n              <h4>Recent Activity</h4>\n              <div className=\"man-day-date-list\">\n                {costData.byDate.slice(0, 7).map((day, idx) => (\n                  <div key={idx} className=\"man-day-date-row\">\n                    <span className=\"date-label\">{formatDate(day.date)}</span>\n                    <span className=\"date-workers\">{day.workers} crew</span>\n                    <span className=\"date-cost\">{formatCurrency(day.cost)}</span>\n                  </div>\n                ))}\n              </div>\n              {costData.byDate.length > 7 && (\n                <p className=\"man-day-more\">\n                  + {costData.byDate.length - 7} more days\n                </p>\n              )}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n","import { useState, useEffect, useCallback, useMemo, memo } from 'react'\nimport { FileSpreadsheet, Plus, ChevronRight, Clock, CheckCircle2, DollarSign, TrendingUp } from 'lucide-react'\nimport { drawRequestOps } from '../../lib/supabase'\nimport { formatCurrency } from '../../lib/corCalculations'\n\n/**\n * ProgressBillingCard - Summary card for progress billing / draw requests\n *\n * Shows:\n * - Contract summary (original + COs = revised)\n * - Billing progress (billed to date, retention held)\n * - Quick action to create new draw request\n * - Recent draw requests\n */\nexport default memo(function ProgressBillingCard({\n  project,\n  areas = [],\n  corStats = {},\n  onCreateDraw,\n  onViewDraw,\n  onShowToast\n}) {\n  const [drawRequests, setDrawRequests] = useState([])\n  const [loading, setLoading] = useState(true)\n\n  // Calculate contract values\n  const originalContract = useMemo(() => {\n    return areas.reduce((sum, area) => {\n      const value = (area.square_footage || 0) * (area.price_per_sqft || 0)\n      return sum + Math.round(value * 100) // Convert to cents\n    }, 0)\n  }, [areas])\n\n  const approvedCOs = useMemo(() => {\n    return (corStats?.approvedTotal || 0)\n  }, [corStats?.approvedTotal])\n\n  const revisedContract = originalContract + approvedCOs\n\n  // Load draw requests\n  const loadDrawRequests = useCallback(async () => {\n    if (!project?.id) return\n\n    try {\n      setLoading(true)\n      const data = await drawRequestOps.getProjectDrawRequests(project.id)\n      setDrawRequests(data || [])\n    } catch (error) {\n      console.error('Error loading draw requests:', error)\n    } finally {\n      setLoading(false)\n    }\n  }, [project?.id])\n\n  useEffect(() => {\n    loadDrawRequests()\n  }, [loadDrawRequests])\n\n  // Calculate billing totals from draw requests\n  const billingTotals = useMemo(() => {\n    const completedDraws = drawRequests.filter(dr =>\n      ['submitted', 'approved', 'paid'].includes(dr.status)\n    )\n\n    const billedToDate = completedDraws.reduce((sum, dr) =>\n      sum + (dr.previous_billings || 0) + (dr.current_billing || 0), 0\n    )\n\n    // Get the most recent retention amount\n    const latestDraw = completedDraws[0]\n    const retentionHeld = latestDraw?.retention_held || 0\n\n    return { billedToDate, retentionHeld }\n  }, [drawRequests])\n\n  const progress = revisedContract > 0\n    ? Math.round((billingTotals.billedToDate / revisedContract) * 100)\n    : 0\n\n  const nextDrawNumber = drawRequests.length > 0\n    ? Math.max(...drawRequests.map(dr => dr.draw_number)) + 1\n    : 1\n\n  const formatDate = (dateStr) => {\n    if (!dateStr) return ''\n    return new Date(dateStr).toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric'\n    })\n  }\n\n  const getStatusBadge = (status) => {\n    switch (status) {\n      case 'draft':\n        return <span className=\"badge badge-muted\">Draft</span>\n      case 'submitted':\n        return <span className=\"badge badge-warning\">Submitted</span>\n      case 'approved':\n        return <span className=\"badge badge-success\">Approved</span>\n      case 'paid':\n        return <span className=\"badge badge-info\">Paid</span>\n      case 'rejected':\n        return <span className=\"badge badge-danger\">Rejected</span>\n      default:\n        return null\n    }\n  }\n\n  return (\n    <div className=\"progress-billing-card\">\n      <div className=\"progress-billing-header\">\n        <div className=\"progress-billing-title\">\n          <FileSpreadsheet size={18} />\n          <h3>Progress Billing</h3>\n        </div>\n        <button\n          className=\"btn btn-sm btn-primary\"\n          onClick={() => onCreateDraw?.()}\n          disabled={originalContract === 0}\n          title={originalContract === 0 ? 'Add areas with contract values first' : `Create Draw #${nextDrawNumber}`}\n        >\n          <Plus size={14} />\n          <span>Draw #{nextDrawNumber}</span>\n        </button>\n      </div>\n\n      {/* Contract Summary */}\n      <div className=\"progress-billing-contract\">\n        <div className=\"contract-row\">\n          <span className=\"contract-label\">Original Contract</span>\n          <span className=\"contract-value\">{formatCurrency(originalContract)}</span>\n        </div>\n        {approvedCOs > 0 && (\n          <div className=\"contract-row co\">\n            <span className=\"contract-label\">Approved COs</span>\n            <span className=\"contract-value positive\">+{formatCurrency(approvedCOs)}</span>\n          </div>\n        )}\n        <div className=\"contract-row revised\">\n          <span className=\"contract-label\">Revised Contract</span>\n          <span className=\"contract-value\">{formatCurrency(revisedContract)}</span>\n        </div>\n      </div>\n\n      {/* Billing Progress */}\n      <div className=\"progress-billing-status\">\n        <div className=\"billing-progress-bar\">\n          <div\n            className=\"billing-progress-fill\"\n            style={{ width: `${Math.min(progress, 100)}%` }}\n          />\n        </div>\n        <div className=\"billing-stats\">\n          <div className=\"billing-stat\">\n            <span className=\"billing-stat-value\">{formatCurrency(billingTotals.billedToDate)}</span>\n            <span className=\"billing-stat-label\">Billed to Date ({progress}%)</span>\n          </div>\n          {billingTotals.retentionHeld > 0 && (\n            <div className=\"billing-stat retention\">\n              <span className=\"billing-stat-value\">-{formatCurrency(billingTotals.retentionHeld)}</span>\n              <span className=\"billing-stat-label\">Retention Held</span>\n            </div>\n          )}\n          <div className=\"billing-stat remaining\">\n            <span className=\"billing-stat-value\">{formatCurrency(revisedContract - billingTotals.billedToDate)}</span>\n            <span className=\"billing-stat-label\">Balance to Finish</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Recent Draw Requests */}\n      {loading ? (\n        <div className=\"progress-billing-loading\">\n          <div className=\"loading-spinner small\" />\n        </div>\n      ) : drawRequests.length === 0 ? (\n        <div className=\"progress-billing-empty\">\n          <p>No draw requests yet</p>\n          {originalContract > 0 && (\n            <button\n              className=\"btn btn-sm btn-outline\"\n              onClick={() => onCreateDraw?.()}\n            >\n              <Plus size={14} />\n              Create First Draw Request\n            </button>\n          )}\n        </div>\n      ) : (\n        <div className=\"progress-billing-draws\">\n          <div className=\"draws-header\">\n            <span>Recent Draws</span>\n          </div>\n          <div className=\"draws-list\">\n            {drawRequests.slice(0, 3).map(dr => (\n              <button\n                key={dr.id}\n                className=\"draw-item\"\n                onClick={() => onViewDraw?.(dr)}\n              >\n                <div className=\"draw-item-info\">\n                  <span className=\"draw-number\">Draw #{dr.draw_number}</span>\n                  <span className=\"draw-date\">{formatDate(dr.period_end || dr.created_at)}</span>\n                </div>\n                <div className=\"draw-item-amount\">\n                  {formatCurrency(dr.current_billing || 0)}\n                </div>\n                {getStatusBadge(dr.status)}\n                <ChevronRight size={16} className=\"draw-item-arrow\" />\n              </button>\n            ))}\n          </div>\n          {drawRequests.length > 3 && (\n            <button className=\"btn btn-sm btn-ghost view-all-draws\">\n              View all {drawRequests.length} draws\n            </button>\n          )}\n        </div>\n      )}\n    </div>\n  )\n})\n","import { useState, useEffect, useCallback, useMemo, memo } from 'react'\nimport { Truck, Plus, Calendar, DollarSign, RotateCcw, ChevronDown, ChevronUp, Edit2, Trash2 } from 'lucide-react'\nimport { equipmentOps } from '../../lib/supabase'\nimport { formatCurrency } from '../../lib/corCalculations'\n\n// Helper function - defined outside component to avoid recreation\nconst formatDate = (dateStr) => {\n  if (!dateStr) return ''\n  return new Date(dateStr).toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric'\n  })\n}\n\n/**\n * ProjectEquipmentCard - Equipment tracking card for Financials Overview\n *\n * Shows equipment currently on site with daily rates and costs.\n * Allows adding new equipment and marking equipment as returned.\n */\nexport default memo(function ProjectEquipmentCard({\n  project,\n  onAddEquipment,\n  onEditEquipment,\n  onShowToast\n}) {\n  const [projectEquipment, setProjectEquipment] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [expanded, setExpanded] = useState(true)\n  const [totalCost, setTotalCost] = useState(0)\n\n  // Memoized load function to avoid stale closures\n  const loadEquipment = useCallback(async () => {\n    if (!project?.id) return\n\n    try {\n      setLoading(true)\n      const data = await equipmentOps.getProjectEquipment(project.id)\n      setProjectEquipment(data || [])\n\n      // Calculate total cost\n      const cost = equipmentOps.calculateProjectEquipmentCost(data || [])\n      setTotalCost(cost)\n    } catch (error) {\n      console.error('Error loading equipment:', error)\n      onShowToast?.('Failed to load equipment', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }, [project?.id]) // onShowToast is stable (memoized in App.jsx)\n\n  // Load project equipment when project changes\n  useEffect(() => {\n    loadEquipment()\n  }, [loadEquipment])\n\n  const handleMarkReturned = useCallback(async (equipmentItem) => {\n    try {\n      await equipmentOps.markEquipmentReturned(equipmentItem.id)\n      onShowToast?.(`${equipmentItem.equipment_name} marked as returned`, 'success')\n      loadEquipment()\n    } catch (error) {\n      console.error('Error marking equipment returned:', error)\n      onShowToast?.('Failed to update equipment', 'error')\n    }\n  }, [loadEquipment]) // onShowToast is stable\n\n  const handleDelete = useCallback(async (equipmentItem) => {\n    if (!confirm(`Remove ${equipmentItem.equipment_name} from this project?`)) {\n      return\n    }\n\n    try {\n      await equipmentOps.removeEquipmentFromProject(equipmentItem.id)\n      onShowToast?.('Equipment removed', 'success')\n      loadEquipment()\n    } catch (error) {\n      console.error('Error removing equipment:', error)\n      onShowToast?.('Failed to remove equipment', 'error')\n    }\n  }, [loadEquipment]) // onShowToast is stable\n\n  // Memoize derived state to avoid recalculating on every render\n  const activeEquipment = useMemo(\n    () => projectEquipment.filter(e => !e.end_date),\n    [projectEquipment]\n  )\n\n  const returnedEquipment = useMemo(\n    () => projectEquipment.filter(e => e.end_date),\n    [projectEquipment]\n  )\n\n  return (\n    <div className=\"project-equipment-card\">\n      <div className=\"project-equipment-header\">\n        <div className=\"project-equipment-title\">\n          <Truck size={18} />\n          <h3>Equipment on Site</h3>\n          {projectEquipment.length > 0 && (\n            <span className=\"equipment-count\">{activeEquipment.length} active</span>\n          )}\n        </div>\n        <div className=\"project-equipment-actions\">\n          <button\n            className=\"btn btn-sm btn-primary\"\n            onClick={() => onAddEquipment?.()}\n            title=\"Add equipment\"\n          >\n            <Plus size={14} />\n            <span>Add</span>\n          </button>\n          {projectEquipment.length > 0 && (\n            <button\n              className=\"btn btn-sm btn-ghost\"\n              onClick={() => setExpanded(!expanded)}\n            >\n              {expanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n            </button>\n          )}\n        </div>\n      </div>\n\n      {loading ? (\n        <div className=\"equipment-loading\">\n          <div className=\"loading-spinner small\" />\n        </div>\n      ) : projectEquipment.length === 0 ? (\n        <div className=\"equipment-empty\">\n          <p>No equipment tracked on this project</p>\n          <button\n            className=\"btn btn-sm btn-outline\"\n            onClick={() => onAddEquipment?.()}\n          >\n            <Plus size={14} />\n            Track Equipment\n          </button>\n        </div>\n      ) : expanded ? (\n        <>\n          {/* Active Equipment */}\n          {activeEquipment.length > 0 && (\n            <div className=\"equipment-list\">\n              {activeEquipment.map(item => {\n                const days = equipmentOps.calculateDaysOnSite(item.start_date, item.end_date)\n                const cost = item.daily_rate * days\n\n                return (\n                  <div key={item.id} className=\"equipment-item active\">\n                    <div className=\"equipment-item-main\">\n                      <div className=\"equipment-item-info\">\n                        <span className=\"equipment-name\">{item.equipment_name}</span>\n                        <span className=\"equipment-meta\">\n                          <Calendar size={12} />\n                          On-site since {formatDate(item.start_date)}\n                        </span>\n                      </div>\n                      <div className=\"equipment-item-cost\">\n                        <span className=\"equipment-rate\">\n                          {formatCurrency(item.daily_rate)}/day\n                        </span>\n                        <span className=\"equipment-days\">{days} days</span>\n                        <span className=\"equipment-total\">{formatCurrency(cost)}</span>\n                      </div>\n                    </div>\n                    <div className=\"equipment-item-actions\">\n                      <button\n                        className=\"btn btn-xs btn-outline\"\n                        onClick={() => handleMarkReturned(item)}\n                        title=\"Mark as returned\"\n                      >\n                        <RotateCcw size={12} />\n                        Returned\n                      </button>\n                      <button\n                        className=\"btn btn-xs btn-ghost\"\n                        onClick={() => onEditEquipment?.(item)}\n                        title=\"Edit\"\n                      >\n                        <Edit2 size={12} />\n                      </button>\n                      <button\n                        className=\"btn btn-xs btn-ghost text-danger\"\n                        onClick={() => handleDelete(item)}\n                        title=\"Remove\"\n                      >\n                        <Trash2 size={12} />\n                      </button>\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          )}\n\n          {/* Returned Equipment (collapsed by default) */}\n          {returnedEquipment.length > 0 && (\n            <details className=\"equipment-returned-section\">\n              <summary className=\"equipment-returned-toggle\">\n                <span>Returned Equipment ({returnedEquipment.length})</span>\n              </summary>\n              <div className=\"equipment-list returned\">\n                {returnedEquipment.map(item => {\n                  const days = equipmentOps.calculateDaysOnSite(item.start_date, item.end_date)\n                  const cost = item.daily_rate * days\n\n                  return (\n                    <div key={item.id} className=\"equipment-item returned\">\n                      <div className=\"equipment-item-main\">\n                        <div className=\"equipment-item-info\">\n                          <span className=\"equipment-name\">{item.equipment_name}</span>\n                          <span className=\"equipment-meta\">\n                            {formatDate(item.start_date)} - {formatDate(item.end_date)}\n                          </span>\n                        </div>\n                        <div className=\"equipment-item-cost\">\n                          <span className=\"equipment-days\">{days} days</span>\n                          <span className=\"equipment-total\">{formatCurrency(cost)}</span>\n                        </div>\n                      </div>\n                    </div>\n                  )\n                })}\n              </div>\n            </details>\n          )}\n\n          {/* Total */}\n          <div className=\"equipment-total-row\">\n            <span>Total Equipment Cost</span>\n            <span className=\"equipment-grand-total\">{formatCurrency(totalCost)}</span>\n          </div>\n        </>\n      ) : (\n        <div className=\"equipment-summary-collapsed\">\n          <span>{activeEquipment.length} active, {returnedEquipment.length} returned</span>\n          <span className=\"equipment-grand-total\">{formatCurrency(totalCost)}</span>\n        </div>\n      )}\n    </div>\n  )\n})\n","import { useState } from 'react'\nimport { TrendingUp, TrendingDown, Minus, ChevronDown, ChevronUp, Flame } from 'lucide-react'\n\n// Helper to format currency\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount || 0)\n}\n\n// Helper to format date\nconst formatDate = (dateStr) => {\n  return new Date(dateStr).toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric'\n  })\n}\n\nexport default function BurnRateCard({\n  dailyBurn,\n  totalBurn,\n  daysWorked,\n  laborCost,\n  materialsEquipmentCost = 0,\n  progress,\n  contractValue,\n  laborByDate = [],\n  materialsEquipmentByDate = []\n}) {\n  const [expanded, setExpanded] = useState(false)\n\n  // Calculate burn status relative to progress\n  const expectedBurnAtProgress = contractValue * (progress / 100) * 0.6 // Assume 60% cost ratio as healthy\n  const burnStatus = totalBurn <= expectedBurnAtProgress ? 'on-budget' : totalBurn <= expectedBurnAtProgress * 1.2 ? 'warning' : 'over-budget'\n\n  const statusLabel = {\n    'on-budget': 'On Budget',\n    'warning': 'Watch Closely',\n    'over-budget': 'Over Budget'\n  }[burnStatus]\n\n  const StatusIcon = burnStatus === 'on-budget' ? TrendingDown : burnStatus === 'warning' ? Minus : TrendingUp\n\n  // Calculate projected total cost at completion\n  const burnPerProgress = progress > 0 ? totalBurn / (progress / 100) : 0\n  const projectedTotalCost = burnPerProgress\n\n  // Merge labor and materials/equipment by date for combined view\n  const combinedByDate = []\n  const dateMap = {}\n\n  laborByDate.forEach(day => {\n    if (!dateMap[day.date]) {\n      dateMap[day.date] = { date: day.date, labor: 0, materialsEquipment: 0, total: 0 }\n    }\n    dateMap[day.date].labor = day.cost || 0\n    dateMap[day.date].total += day.cost || 0\n  })\n\n  materialsEquipmentByDate.forEach(day => {\n    if (!dateMap[day.date]) {\n      dateMap[day.date] = { date: day.date, labor: 0, materialsEquipment: 0, total: 0 }\n    }\n    dateMap[day.date].materialsEquipment = day.cost || 0\n    dateMap[day.date].total += day.cost || 0\n  })\n\n  Object.values(dateMap)\n    .sort((a, b) => new Date(b.date) - new Date(a.date))\n    .slice(0, 10)\n    .forEach(d => combinedByDate.push(d))\n\n  // Max daily cost for bar sizing\n  const maxDailyCost = Math.max(...combinedByDate.map(d => d.total), 1)\n\n  return (\n    <div className=\"burn-rate-card\">\n      <div className=\"burn-rate-header\">\n        <div className=\"burn-rate-title\">\n          <Flame size={18} className=\"burn-icon\" />\n          <h3>Burn Rate</h3>\n        </div>\n        <div className={`burn-status ${burnStatus}`}>\n          <StatusIcon size={14} />\n          <span>{statusLabel}</span>\n        </div>\n      </div>\n\n      <div className=\"burn-rate-hero\">\n        <div className=\"burn-rate-main\">\n          <span className=\"burn-rate-value\">{formatCurrency(dailyBurn)}</span>\n          <span className=\"burn-rate-unit\">/day</span>\n        </div>\n        {daysWorked > 0 && (\n          <div className=\"burn-rate-context\">\n            Based on {daysWorked} work day{daysWorked !== 1 ? 's' : ''}\n          </div>\n        )}\n      </div>\n\n      <div className=\"burn-rate-summary\">\n        <div className=\"burn-summary-item\">\n          <span className=\"burn-summary-label\">Total Spent</span>\n          <span className=\"burn-summary-value\">{formatCurrency(totalBurn)}</span>\n        </div>\n        <div className=\"burn-summary-divider\"></div>\n        <div className=\"burn-summary-item\">\n          <span className=\"burn-summary-label\">Labor</span>\n          <span className=\"burn-summary-value\">{formatCurrency(laborCost)}</span>\n        </div>\n        <div className=\"burn-summary-divider\"></div>\n        <div className=\"burn-summary-item\">\n          <span className=\"burn-summary-label\">Materials</span>\n          <span className=\"burn-summary-value\">{formatCurrency(materialsEquipmentCost)}</span>\n        </div>\n      </div>\n\n      {progress > 0 && (\n        <div className=\"burn-projection\">\n          <span className=\"projection-label\">Projected at completion:</span>\n          <span className={`projection-value ${projectedTotalCost > contractValue * 0.7 ? 'warning' : ''}`}>\n            {formatCurrency(projectedTotalCost)}\n          </span>\n        </div>\n      )}\n\n      {combinedByDate.length > 0 && (\n        <button\n          className=\"burn-rate-expand\"\n          onClick={() => setExpanded(!expanded)}\n        >\n          {expanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n          <span>{expanded ? 'Hide' : 'View'} Daily Breakdown</span>\n        </button>\n      )}\n\n      {expanded && combinedByDate.length > 0 && (\n        <div className=\"burn-rate-details\">\n          <div className=\"burn-details-header\">\n            <span>Date</span>\n            <span>Labor</span>\n            <span>Materials</span>\n            <span>Total</span>\n          </div>\n          {combinedByDate.map(day => (\n            <div key={day.date} className=\"burn-details-row\">\n              <span className=\"burn-date\">{formatDate(day.date)}</span>\n              <span className=\"burn-labor\">{day.labor > 0 ? formatCurrency(day.labor) : '-'}</span>\n              <span className=\"burn-materials\">{day.materialsEquipment > 0 ? formatCurrency(day.materialsEquipment) : '-'}</span>\n              <span className=\"burn-total\">\n                <span className=\"burn-bar\" style={{ width: `${(day.total / maxDailyCost) * 100}%` }}></span>\n                <span className=\"burn-amount\">{formatCurrency(day.total)}</span>\n              </span>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}\n","// ============================================\n// Chart Configuration\n// ============================================\n// Centralized theme colors, animations, and styles\n// for all financial dashboard charts.\n// ============================================\n\n// Chart color palette - matches app theme\nexport const chartColors = {\n  // Financial lines\n  contract: '#3b82f6',     // Blue - contract ceiling\n  revenue: '#10b981',      // Green - earned revenue\n  costs: '#f59e0b',        // Amber - spending\n  profit: '#22c55e',       // Emerald - positive profit\n  loss: '#ef4444',         // Red - negative/loss\n\n  // Extra work\n  tmValue: '#8b5cf6',      // Purple - T&M ticket value\n  corValue: '#14b8a6',     // Teal - COR approved value\n\n  // Cost categories\n  labor: '#6366f1',        // Indigo\n  disposal: '#14b8a6',     // Teal\n  equipment: '#f97316',    // Orange\n  materials: '#a855f7',    // Purple\n  subcontractor: '#ec4899', // Pink\n  other: '#6b7280',        // Gray\n\n  // UI\n  grid: 'var(--border-color)',\n  text: 'var(--text-secondary)',\n  background: 'var(--bg-card)',\n}\n\n// Animation configuration\nexport const animationConfig = {\n  duration: 800,\n  easing: 'ease-out',\n}\n\n// Common tooltip styles\nexport const tooltipStyle = {\n  contentStyle: {\n    background: 'var(--bg-card)',\n    border: '1px solid var(--border-color)',\n    borderRadius: '8px',\n    boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\n    padding: '12px 16px',\n  },\n  labelStyle: {\n    color: 'var(--text-primary)',\n    fontWeight: 600,\n    marginBottom: '8px',\n  },\n  itemStyle: {\n    color: 'var(--text-secondary)',\n    padding: '2px 0',\n  },\n}\n\n// Cost category configuration\nexport const costCategories = {\n  labor: {\n    label: 'Labor',\n    color: chartColors.labor,\n    icon: 'HardHat',\n  },\n  disposal: {\n    label: 'Disposal',\n    color: chartColors.disposal,\n    icon: 'Trash2',\n  },\n  equipment: {\n    label: 'Equipment',\n    color: chartColors.equipment,\n    icon: 'Truck',\n  },\n  materials: {\n    label: 'Materials',\n    color: chartColors.materials,\n    icon: 'Package',\n  },\n  subcontractor: {\n    label: 'Subcontractor',\n    color: chartColors.subcontractor,\n    icon: 'Users',\n  },\n  other: {\n    label: 'Other',\n    color: chartColors.other,\n    icon: 'MoreHorizontal',\n  },\n}\n\n// Time range options for charts\nexport const timeRanges = [\n  { id: '7d', label: '7D', days: 7 },\n  { id: '30d', label: '30D', days: 30 },\n  { id: '90d', label: '90D', days: 90 },\n  { id: 'all', label: 'All', days: null },\n]\n\n// Format currency for chart labels\nexport const formatChartCurrency = (value) => {\n  if (value >= 1000000) {\n    return `$${(value / 1000000).toFixed(1)}M`\n  }\n  if (value >= 1000) {\n    return `$${(value / 1000).toFixed(0)}K`\n  }\n  return `$${value.toFixed(0)}`\n}\n\n// Format date for chart axis\nexport const formatChartDate = (dateStr) => {\n  const date = new Date(dateStr)\n  return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n}\n\n// Gradient definitions for area charts\nexport const gradientDefs = {\n  revenue: {\n    id: 'revenueGradient',\n    color: chartColors.revenue,\n    startOpacity: 0.3,\n    endOpacity: 0,\n  },\n  costs: {\n    id: 'costsGradient',\n    color: chartColors.costs,\n    startOpacity: 0.3,\n    endOpacity: 0,\n  },\n  tmValue: {\n    id: 'tmValueGradient',\n    color: chartColors.tmValue,\n    startOpacity: 0.2,\n    endOpacity: 0,\n  },\n}\n","// ============================================\n// Chart Data Transformations\n// ============================================\n// Utilities to transform Dashboard.jsx data into\n// chart-friendly formats for Recharts.\n// ============================================\n\nimport { chartColors, costCategories } from '../components/charts/chartConfig'\n\n/**\n * Build cumulative time-series for the Financial Trend Chart\n * Merges labor, disposal, materials/equipment, T&M, and COR data by date\n * Uses actual area completion dates for revenue tracking\n *\n * @param {Object} projectData - Computed project data from Dashboard\n * @param {Object} project - Selected project\n * @param {Array} tmTickets - T&M tickets for the project\n * @param {Object} corStats - COR statistics\n * @param {Array} areas - Project areas with completion dates\n * @returns {Array} Chart-ready data points\n */\nexport function buildFinancialTimeSeries(projectData, project, tmTickets = [], corStats = null, areas = []) {\n  const contractValue = project?.contract_value || 0\n  const laborByDate = projectData?.laborByDate || []\n  const haulOffByDate = projectData?.haulOffByDate || []\n  const materialsEquipmentByDate = projectData?.materialsEquipmentByDate || []\n  const customCosts = projectData?.customCosts || []\n\n  // Collect all unique dates from all sources\n  const dateSet = new Set()\n\n  laborByDate.forEach(d => dateSet.add(d.date))\n  haulOffByDate.forEach(d => dateSet.add(d.date))\n  materialsEquipmentByDate.forEach(d => dateSet.add(d.date))\n  customCosts.forEach(c => {\n    if (c.cost_date) dateSet.add(c.cost_date)\n  })\n\n  // Add T&M ticket dates\n  tmTickets.forEach(t => {\n    if (t.work_date) dateSet.add(t.work_date)\n    if (t.ticket_date) dateSet.add(t.ticket_date)\n    if (t.created_at) dateSet.add(t.created_at.split('T')[0])\n  })\n\n  // Add area completion dates (for revenue tracking)\n  areas.forEach(area => {\n    if (area.status === 'done' && area.updated_at) {\n      dateSet.add(area.updated_at.split('T')[0])\n    }\n  })\n\n  // Sort dates chronologically\n  const sortedDates = [...dateSet].sort((a, b) => new Date(a) - new Date(b))\n\n  if (sortedDates.length === 0) {\n    return []\n  }\n\n  // Build revenue by date based on completed areas\n  // Each completed area contributes its weight/value to revenue on its completion date\n  const revenueByDate = {}\n  const totalWeight = areas.reduce((sum, a) => sum + (parseFloat(a.weight) || 0), 0)\n\n  areas.forEach(area => {\n    if (area.status === 'done' && area.updated_at) {\n      const completionDate = area.updated_at.split('T')[0]\n      const areaWeight = parseFloat(area.weight) || 0\n      // Calculate area's contribution to revenue\n      // If scheduled_value exists (SOV), use that; otherwise calculate from weight\n      const areaValue = area.scheduled_value\n        ? parseFloat(area.scheduled_value)\n        : (totalWeight > 0 ? (areaWeight / totalWeight) * contractValue : 0)\n\n      if (!revenueByDate[completionDate]) {\n        revenueByDate[completionDate] = 0\n      }\n      revenueByDate[completionDate] += areaValue\n    }\n  })\n\n  // Build cumulative data\n  let cumulativeCost = 0\n  let cumulativeTMValue = 0\n  let cumulativeCORValue = 0\n\n  // Pre-calculate T&M values by date\n  // Use the actual property names from the database: t_and_m_workers, t_and_m_items\n  const tmByDate = {}\n  tmTickets.forEach(ticket => {\n    const date = ticket.work_date || ticket.ticket_date || ticket.created_at?.split('T')[0]\n    if (!date) return\n\n    // Calculate ticket value (labor + materials + equipment)\n    let ticketValue = 0\n\n    // Labor value - handles both property name variations\n    const workers = ticket.t_and_m_workers || ticket.workers || []\n    if (Array.isArray(workers)) {\n      workers.forEach(w => {\n        // Handle both naming conventions: hours/regular_hours, overtime_hours\n        const regHours = parseFloat(w.hours) || parseFloat(w.regular_hours) || 0\n        const otHours = parseFloat(w.overtime_hours) || 0\n        // Use rates if available, otherwise default billing rates\n        const regRate = parseFloat(w.regular_rate) || parseFloat(w.rate) || 65\n        const otRate = parseFloat(w.overtime_rate) || regRate * 1.5\n        ticketValue += (regHours * regRate) + (otHours * otRate)\n      })\n    }\n\n    // Materials and equipment - handles both property name variations\n    const items = ticket.t_and_m_items || ticket.items || []\n    if (Array.isArray(items)) {\n      items.forEach(item => {\n        const qty = parseFloat(item.quantity) || 1\n        // Handle different cost property locations\n        const unitCost = parseFloat(item.unit_cost) ||\n                         parseFloat(item.materials_equipment?.cost_per_unit) || 0\n        ticketValue += qty * unitCost\n      })\n    }\n\n    if (!tmByDate[date]) {\n      tmByDate[date] = 0\n    }\n    tmByDate[date] += ticketValue\n  })\n\n  // Pre-calculate custom costs by date\n  const customByDate = {}\n  customCosts.forEach(cost => {\n    const date = cost.cost_date\n    if (!date) return\n    if (!customByDate[date]) {\n      customByDate[date] = 0\n    }\n    customByDate[date] += parseFloat(cost.amount) || 0\n  })\n\n  // Pre-calculate materials/equipment costs by date (for quick lookup)\n  const materialsEquipmentByDateMap = {}\n  materialsEquipmentByDate.forEach(d => {\n    if (d.date) {\n      materialsEquipmentByDateMap[d.date] = d.cost || 0\n    }\n  })\n\n  // Track cumulative revenue based on actual area completions\n  let cumulativeRevenue = 0\n\n  // Build the time series\n  const timeSeries = sortedDates.map((date) => {\n    // Find labor cost for this date\n    const laborDay = laborByDate.find(d => d.date === date)\n    const laborCost = laborDay?.cost || 0\n\n    // Find haul-off cost for this date\n    const haulOffDay = haulOffByDate.find(d => d.date === date)\n    const haulOffCost = haulOffDay?.cost || 0\n\n    // Materials/equipment cost for this date (from T&M tickets)\n    const materialsEquipmentCost = materialsEquipmentByDateMap[date] || 0\n\n    // Custom costs for this date\n    const customCost = customByDate[date] || 0\n\n    // Accumulate all costs (labor + materials/equipment + disposal + custom)\n    const dailyTotalCost = laborCost + materialsEquipmentCost + haulOffCost + customCost\n    cumulativeCost += dailyTotalCost\n\n    // Accumulate T&M billing value (what we charge client)\n    const tmDayValue = tmByDate[date] || 0\n    cumulativeTMValue += tmDayValue\n\n    // Accumulate revenue based on actual area completions\n    // Revenue increases only when areas are marked complete\n    const dailyRevenue = revenueByDate[date] || 0\n    cumulativeRevenue += dailyRevenue\n\n    // If we have area completion data, use actual revenue\n    // Otherwise fall back to billable (for projects without detailed tracking)\n    const hasAreaData = Object.keys(revenueByDate).length > 0\n    const revenue = hasAreaData\n      ? cumulativeRevenue\n      : (projectData?.billable || 0) // Fall back to current billable for projects without area dates\n\n    return {\n      date,\n      contract: contractValue,\n      revenue: Math.round(revenue),\n      costs: Math.round(cumulativeCost),\n      tmValue: Math.round(cumulativeTMValue),\n      corValue: Math.round(corStats?.total_approved_value || 0),\n      profit: Math.round(revenue - cumulativeCost),\n      // Daily values for tooltips\n      dailyLabor: Math.round(laborCost),\n      dailyRevenue: Math.round(dailyRevenue),\n      dailyMaterials: Math.round(materialsEquipmentCost),\n      dailyHaulOff: Math.round(haulOffCost),\n      dailyCustom: Math.round(customCost),\n      dailyTM: Math.round(tmDayValue),\n      dailyTotal: Math.round(dailyTotalCost),\n    }\n  })\n\n  return timeSeries\n}\n\n/**\n * Filter time series by date range\n *\n * @param {Array} data - Full time series data\n * @param {number|null} days - Number of days to include (null = all)\n * @returns {Array} Filtered data\n */\nexport function filterByTimeRange(data, days) {\n  if (!days || !data.length) return data\n\n  const now = new Date()\n  const cutoff = new Date()\n  cutoff.setDate(now.getDate() - days)\n\n  return data.filter(d => new Date(d.date) >= cutoff)\n}\n\n/**\n * Build cost distribution data for donut chart\n *\n * @param {number} laborCost - Total labor cost\n * @param {number} haulOffCost - Total disposal cost\n * @param {Array} customCosts - Array of custom cost entries\n * @returns {Array} Chart-ready segments\n */\nexport function buildCostDistribution(laborCost = 0, haulOffCost = 0, customCosts = []) {\n  const segments = []\n\n  // Add labor if present\n  if (laborCost > 0) {\n    segments.push({\n      name: 'Labor',\n      value: laborCost,\n      color: chartColors.labor,\n      category: 'labor',\n    })\n  }\n\n  // Add disposal if present\n  if (haulOffCost > 0) {\n    segments.push({\n      name: 'Disposal',\n      value: haulOffCost,\n      color: chartColors.disposal,\n      category: 'disposal',\n    })\n  }\n\n  // Group custom costs by category\n  const grouped = {}\n  customCosts.forEach(cost => {\n    const cat = cost.category || 'other'\n    if (!grouped[cat]) {\n      grouped[cat] = {\n        items: [],\n        total: 0,\n      }\n    }\n    grouped[cat].items.push(cost)\n    grouped[cat].total += parseFloat(cost.amount) || 0\n  })\n\n  // Add grouped custom costs\n  Object.entries(grouped).forEach(([category, data]) => {\n    if (data.total > 0) {\n      const catConfig = costCategories[category] || costCategories.other\n      segments.push({\n        name: catConfig.label,\n        value: data.total,\n        color: catConfig.color,\n        category,\n        items: data.items,\n      })\n    }\n  })\n\n  // Calculate percentages\n  const total = segments.reduce((sum, s) => sum + s.value, 0)\n  segments.forEach(s => {\n    s.percentage = total > 0 ? Math.round((s.value / total) * 100) : 0\n  })\n\n  // Sort by value descending\n  segments.sort((a, b) => b.value - a.value)\n\n  return segments\n}\n\n/**\n * Build COR funnel data\n *\n * @param {Object} corStats - COR statistics from database\n * @returns {Array} Funnel stages\n */\nexport function buildCORFunnel(corStats) {\n  if (!corStats) return []\n\n  return [\n    {\n      stage: 'Draft',\n      count: corStats.draft_count || 0,\n      value: 0, // Draft CORs typically don't have values yet\n      color: chartColors.other,\n    },\n    {\n      stage: 'Pending',\n      count: corStats.pending_count || 0,\n      value: corStats.total_pending_value || 0,\n      color: chartColors.costs,\n    },\n    {\n      stage: 'Approved',\n      count: corStats.approved_count || 0,\n      value: corStats.total_approved_value || 0,\n      color: chartColors.revenue,\n    },\n    {\n      stage: 'Billed',\n      count: corStats.billed_count || 0,\n      value: corStats.total_billed_value || 0,\n      color: chartColors.profit,\n    },\n  ]\n}\n\n/**\n * Build daily burn data for sparkline\n *\n * @param {Array} laborByDate - Daily labor costs\n * @param {Array} haulOffByDate - Daily haul-off costs\n * @param {number} limit - Max number of days to include\n * @returns {Array} Sparkline data points\n */\nexport function buildBurnSparkline(laborByDate = [], haulOffByDate = [], limit = 14) {\n  // Merge and sort by date\n  const dateMap = {}\n\n  laborByDate.forEach(d => {\n    if (!dateMap[d.date]) {\n      dateMap[d.date] = { date: d.date, labor: 0, haulOff: 0 }\n    }\n    dateMap[d.date].labor = d.cost || 0\n  })\n\n  haulOffByDate.forEach(d => {\n    if (!dateMap[d.date]) {\n      dateMap[d.date] = { date: d.date, labor: 0, haulOff: 0 }\n    }\n    dateMap[d.date].haulOff = d.cost || 0\n  })\n\n  // Convert to array and sort\n  const data = Object.values(dateMap)\n    .map(d => ({\n      date: d.date,\n      total: d.labor + d.haulOff,\n      labor: d.labor,\n      haulOff: d.haulOff,\n    }))\n    .sort((a, b) => new Date(a.date) - new Date(b.date))\n\n  // Return last N days\n  return data.slice(-limit)\n}\n\n/**\n * Calculate trend direction from time series\n *\n * @param {Array} data - Time series data\n * @param {string} key - Data key to analyze\n * @returns {Object} Trend info { direction, percentage }\n */\nexport function calculateTrend(data, key) {\n  if (!data || data.length < 2) {\n    return { direction: 'flat', percentage: 0 }\n  }\n\n  const recent = data.slice(-7)\n  if (recent.length < 2) {\n    return { direction: 'flat', percentage: 0 }\n  }\n\n  const first = recent[0][key] || 0\n  const last = recent[recent.length - 1][key] || 0\n\n  if (first === 0) {\n    return { direction: last > 0 ? 'up' : 'flat', percentage: 0 }\n  }\n\n  const change = ((last - first) / first) * 100\n\n  return {\n    direction: change > 5 ? 'up' : change < -5 ? 'down' : 'flat',\n    percentage: Math.abs(Math.round(change)),\n  }\n}\n","import { formatChartDate, chartColors } from './chartConfig'\n\n/**\n * Custom tooltip for financial charts\n * Displays detailed breakdown on hover\n */\nexport default function ChartTooltip({ active, payload, label }) {\n  if (!active || !payload || !payload.length) {\n    return null\n  }\n\n  // Format currency\n  const formatCurrency = (value) => {\n    if (value >= 1000000) {\n      return `$${(value / 1000000).toFixed(2)}M`\n    }\n    if (value >= 1000) {\n      return `$${(value / 1000).toFixed(1)}K`\n    }\n    return `$${value.toFixed(0)}`\n  }\n\n  // Get the data point\n  const data = payload[0]?.payload || {}\n\n  return (\n    <div className=\"chart-tooltip\">\n      <div className=\"chart-tooltip-date\">\n        {formatChartDate(label)}\n      </div>\n\n      <div className=\"chart-tooltip-rows\">\n        {/* Contract */}\n        {data.contract !== undefined && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.contract }}\n              />\n              Contract\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.contract)}\n            </span>\n          </div>\n        )}\n\n        {/* Revenue */}\n        {data.revenue !== undefined && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.revenue }}\n              />\n              Revenue\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.revenue)}\n            </span>\n          </div>\n        )}\n\n        {/* Costs */}\n        {data.costs !== undefined && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.costs }}\n              />\n              Costs\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.costs)}\n            </span>\n          </div>\n        )}\n\n        {/* T&M Value */}\n        {data.tmValue !== undefined && data.tmValue > 0 && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.tmValue }}\n              />\n              T&M Value\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.tmValue)}\n            </span>\n          </div>\n        )}\n\n        {/* COR Value */}\n        {data.corValue !== undefined && data.corValue > 0 && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{ backgroundColor: chartColors.corValue }}\n              />\n              COR Approved\n            </span>\n            <span className=\"chart-tooltip-value\">\n              {formatCurrency(data.corValue)}\n            </span>\n          </div>\n        )}\n\n        {/* Profit/Loss */}\n        {data.profit !== undefined && (\n          <div className=\"chart-tooltip-row\">\n            <span className=\"chart-tooltip-label\">\n              <span\n                className=\"chart-tooltip-dot\"\n                style={{\n                  backgroundColor: data.profit >= 0\n                    ? chartColors.profit\n                    : chartColors.loss\n                }}\n              />\n              {data.profit >= 0 ? 'Profit' : 'Loss'}\n            </span>\n            <span\n              className=\"chart-tooltip-value\"\n              style={{\n                color: data.profit >= 0\n                  ? chartColors.profit\n                  : chartColors.loss\n              }}\n            >\n              {formatCurrency(Math.abs(data.profit))}\n            </span>\n          </div>\n        )}\n      </div>\n\n      {/* Daily breakdown if available */}\n      {(data.dailyRevenue > 0 || data.dailyLabor > 0 || data.dailyMaterials > 0 || data.dailyHaulOff > 0 || data.dailyTM > 0) && (\n        <div className=\"chart-tooltip-daily\">\n          <div className=\"chart-tooltip-daily-label\">Today's Activity</div>\n          {data.dailyRevenue > 0 && (\n            <div className=\"chart-tooltip-daily-row earned\">\n              <span style={{ color: chartColors.revenue }}>\n                Areas Completed: {formatCurrency(data.dailyRevenue)}\n              </span>\n            </div>\n          )}\n          {data.dailyLabor > 0 && (\n            <div className=\"chart-tooltip-daily-row\">\n              Labor: {formatCurrency(data.dailyLabor)}\n            </div>\n          )}\n          {data.dailyMaterials > 0 && (\n            <div className=\"chart-tooltip-daily-row\">\n              Materials: {formatCurrency(data.dailyMaterials)}\n            </div>\n          )}\n          {data.dailyHaulOff > 0 && (\n            <div className=\"chart-tooltip-daily-row\">\n              Disposal: {formatCurrency(data.dailyHaulOff)}\n            </div>\n          )}\n          {data.dailyTM > 0 && (\n            <div className=\"chart-tooltip-daily-row\">\n              T&M Added: {formatCurrency(data.dailyTM)}\n            </div>\n          )}\n          {data.dailyTotal > 0 && (\n            <div className=\"chart-tooltip-daily-row total\">\n              <strong>Day Costs: {formatCurrency(data.dailyTotal)}</strong>\n            </div>\n          )}\n        </div>\n      )}\n\n      <div className=\"chart-tooltip-hint\">\n        Click to see details\n      </div>\n    </div>\n  )\n}\n","import { useState, useMemo } from 'react'\nimport {\n  AreaChart,\n  Area,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  Legend,\n  ReferenceLine,\n} from 'recharts'\nimport { TrendingUp, TrendingDown, Minus } from 'lucide-react'\nimport {\n  chartColors,\n  animationConfig,\n  timeRanges,\n  formatChartCurrency,\n  formatChartDate,\n  gradientDefs,\n} from './chartConfig'\nimport { buildFinancialTimeSeries, filterByTimeRange, calculateTrend } from '../../lib/chartDataTransforms'\nimport ChartTooltip from './ChartTooltip'\n\n/**\n * Financial Trend Chart\n * Multi-line area chart showing contract, revenue, costs, T&M, and COR values over time\n * Uses actual area completion dates for revenue tracking\n */\nexport default function FinancialTrendChart({\n  projectData,\n  project,\n  tmTickets = [],\n  corStats = null,\n  areas = [],\n  onDrillDown,\n}) {\n  const [timeRange, setTimeRange] = useState('30d')\n  const [hoveredLine, setHoveredLine] = useState(null)\n\n  // Build the time series data using actual area completions for revenue\n  const chartData = useMemo(() => {\n    const allData = buildFinancialTimeSeries(projectData, project, tmTickets, corStats, areas)\n    const selectedRange = timeRanges.find(r => r.id === timeRange)\n    return filterByTimeRange(allData, selectedRange?.days)\n  }, [projectData, project, tmTickets, corStats, areas, timeRange])\n\n  // Calculate trend indicators\n  const costsTrend = useMemo(() => calculateTrend(chartData, 'costs'), [chartData])\n  const revenueTrend = useMemo(() => calculateTrend(chartData, 'revenue'), [chartData])\n\n  // Handle click on data point\n  const handleClick = (data) => {\n    if (data?.activePayload?.[0]) {\n      const point = data.activePayload[0].payload\n      onDrillDown?.(point.date, point)\n    }\n  }\n\n  // Trend icon component\n  const TrendIcon = ({ trend }) => {\n    if (trend.direction === 'up') {\n      return <TrendingUp size={14} className=\"trend-icon up\" />\n    }\n    if (trend.direction === 'down') {\n      return <TrendingDown size={14} className=\"trend-icon down\" />\n    }\n    return <Minus size={14} className=\"trend-icon flat\" />\n  }\n\n  if (!chartData.length) {\n    return (\n      <div className=\"financial-trend-chart empty\">\n        <div className=\"chart-empty-state\">\n          <p>No financial data available yet.</p>\n          <span>Start tracking labor and costs to see trends.</span>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"financial-trend-chart\">\n      <div className=\"chart-header\">\n        <div className=\"chart-title-section\">\n          <h3>Financial Trend</h3>\n          <div className=\"chart-trend-indicators\">\n            <span className=\"trend-badge\">\n              <span style={{ color: chartColors.revenue }}>Revenue</span>\n              <TrendIcon trend={revenueTrend} />\n              {revenueTrend.percentage > 0 && (\n                <span className=\"trend-pct\">{revenueTrend.percentage}%</span>\n              )}\n            </span>\n            <span className=\"trend-badge\">\n              <span style={{ color: chartColors.costs }}>Costs</span>\n              <TrendIcon trend={costsTrend} />\n              {costsTrend.percentage > 0 && (\n                <span className=\"trend-pct\">{costsTrend.percentage}%</span>\n              )}\n            </span>\n          </div>\n        </div>\n\n        <div className=\"time-range-selector\">\n          {timeRanges.map(range => (\n            <button\n              key={range.id}\n              className={timeRange === range.id ? 'active' : ''}\n              onClick={() => setTimeRange(range.id)}\n            >\n              {range.label}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      <div className=\"chart-container\">\n        <ResponsiveContainer width=\"100%\" height={300}>\n          <AreaChart\n            data={chartData}\n            onClick={handleClick}\n            margin={{ top: 10, right: 10, left: 0, bottom: 0 }}\n          >\n            {/* Gradient definitions */}\n            <defs>\n              {Object.values(gradientDefs).map(grad => (\n                <linearGradient\n                  key={grad.id}\n                  id={grad.id}\n                  x1=\"0\"\n                  y1=\"0\"\n                  x2=\"0\"\n                  y2=\"1\"\n                >\n                  <stop\n                    offset=\"5%\"\n                    stopColor={grad.color}\n                    stopOpacity={grad.startOpacity}\n                  />\n                  <stop\n                    offset=\"95%\"\n                    stopColor={grad.color}\n                    stopOpacity={grad.endOpacity}\n                  />\n                </linearGradient>\n              ))}\n            </defs>\n\n            <CartesianGrid\n              strokeDasharray=\"3 3\"\n              stroke=\"var(--border-color)\"\n              vertical={false}\n            />\n\n            <XAxis\n              dataKey=\"date\"\n              tickFormatter={formatChartDate}\n              stroke=\"var(--text-secondary)\"\n              tick={{ fontSize: 11 }}\n              tickLine={false}\n              axisLine={{ stroke: 'var(--border-color)' }}\n            />\n\n            <YAxis\n              tickFormatter={formatChartCurrency}\n              stroke=\"var(--text-secondary)\"\n              tick={{ fontSize: 11 }}\n              tickLine={false}\n              axisLine={false}\n              width={60}\n            />\n\n            <Tooltip content={<ChartTooltip />} />\n\n            <Legend\n              verticalAlign=\"top\"\n              height={36}\n              iconType=\"circle\"\n              iconSize={8}\n              formatter={(value) => (\n                <span style={{ color: 'var(--text-secondary)', fontSize: '12px' }}>\n                  {value}\n                </span>\n              )}\n            />\n\n            {/* Contract ceiling - dashed reference line */}\n            {chartData[0]?.contract > 0 && (\n              <ReferenceLine\n                y={chartData[0].contract}\n                stroke={chartColors.contract}\n                strokeDasharray=\"5 5\"\n                strokeWidth={2}\n                label={{\n                  value: 'Contract',\n                  position: 'right',\n                  fill: chartColors.contract,\n                  fontSize: 11,\n                }}\n              />\n            )}\n\n            {/* Revenue area */}\n            <Area\n              type=\"monotone\"\n              dataKey=\"revenue\"\n              name=\"Revenue\"\n              stroke={chartColors.revenue}\n              strokeWidth={2}\n              fill=\"url(#revenueGradient)\"\n              animationDuration={animationConfig.duration}\n              onMouseEnter={() => setHoveredLine('revenue')}\n              onMouseLeave={() => setHoveredLine(null)}\n              style={{\n                opacity: hoveredLine && hoveredLine !== 'revenue' ? 0.3 : 1,\n              }}\n            />\n\n            {/* Costs area */}\n            <Area\n              type=\"monotone\"\n              dataKey=\"costs\"\n              name=\"Costs\"\n              stroke={chartColors.costs}\n              strokeWidth={2}\n              fill=\"url(#costsGradient)\"\n              animationDuration={animationConfig.duration}\n              onMouseEnter={() => setHoveredLine('costs')}\n              onMouseLeave={() => setHoveredLine(null)}\n              style={{\n                opacity: hoveredLine && hoveredLine !== 'costs' ? 0.3 : 1,\n              }}\n            />\n\n            {/* T&M Value area */}\n            {chartData.some(d => d.tmValue > 0) && (\n              <Area\n                type=\"monotone\"\n                dataKey=\"tmValue\"\n                name=\"T&M Value\"\n                stroke={chartColors.tmValue}\n                strokeWidth={2}\n                fill=\"url(#tmValueGradient)\"\n                animationDuration={animationConfig.duration}\n                onMouseEnter={() => setHoveredLine('tmValue')}\n                onMouseLeave={() => setHoveredLine(null)}\n                style={{\n                  opacity: hoveredLine && hoveredLine !== 'tmValue' ? 0.3 : 1,\n                }}\n              />\n            )}\n\n            {/* COR Value line (no fill, just line) */}\n            {chartData.some(d => d.corValue > 0) && (\n              <Area\n                type=\"monotone\"\n                dataKey=\"corValue\"\n                name=\"COR Approved\"\n                stroke={chartColors.corValue}\n                strokeWidth={2}\n                strokeDasharray=\"4 2\"\n                fill=\"transparent\"\n                animationDuration={animationConfig.duration}\n                onMouseEnter={() => setHoveredLine('corValue')}\n                onMouseLeave={() => setHoveredLine(null)}\n                style={{\n                  opacity: hoveredLine && hoveredLine !== 'corValue' ? 0.3 : 1,\n                }}\n              />\n            )}\n          </AreaChart>\n        </ResponsiveContainer>\n      </div>\n\n      {/* Quick stats below chart */}\n      <div className=\"chart-quick-stats\">\n        <div className=\"quick-stat\">\n          <span className=\"stat-label\">Current Revenue</span>\n          <span className=\"stat-value\" style={{ color: chartColors.revenue }}>\n            {formatChartCurrency(chartData[chartData.length - 1]?.revenue || 0)}\n          </span>\n        </div>\n        <div className=\"quick-stat\">\n          <span className=\"stat-label\">Total Costs</span>\n          <span className=\"stat-value\" style={{ color: chartColors.costs }}>\n            {formatChartCurrency(chartData[chartData.length - 1]?.costs || 0)}\n          </span>\n        </div>\n        <div className=\"quick-stat\">\n          <span className=\"stat-label\">Margin</span>\n          <span\n            className=\"stat-value\"\n            style={{\n              color: (chartData[chartData.length - 1]?.profit || 0) >= 0\n                ? chartColors.profit\n                : chartColors.loss\n            }}\n          >\n            {(() => {\n              const last = chartData[chartData.length - 1]\n              if (!last || !last.revenue) return '0%'\n              const margin = ((last.revenue - last.costs) / last.revenue) * 100\n              return `${margin.toFixed(1)}%`\n            })()}\n          </span>\n        </div>\n        {chartData[chartData.length - 1]?.tmValue > 0 && (\n          <div className=\"quick-stat\">\n            <span className=\"stat-label\">T&M Pending</span>\n            <span className=\"stat-value\" style={{ color: chartColors.tmValue }}>\n              {formatChartCurrency(chartData[chartData.length - 1]?.tmValue || 0)}\n            </span>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n","import { useState, useMemo } from 'react'\nimport {\n  PieChart,\n  Pie,\n  Cell,\n  ResponsiveContainer,\n  Tooltip,\n  Legend,\n} from 'recharts'\nimport { animationConfig, formatChartCurrency } from './chartConfig'\nimport { buildCostDistribution } from '../../lib/chartDataTransforms'\n\n/**\n * Cost Distribution Donut Chart\n * Shows breakdown of costs by category with interactive segments\n */\nexport default function CostDonut({\n  laborCost = 0,\n  haulOffCost = 0,\n  customCosts = [],\n  onSegmentClick,\n}) {\n  const [activeIndex, setActiveIndex] = useState(null)\n\n  // Build the donut segments\n  const segments = useMemo(() => {\n    return buildCostDistribution(laborCost, haulOffCost, customCosts)\n  }, [laborCost, haulOffCost, customCosts])\n\n  // Calculate total\n  const totalCost = useMemo(() => {\n    return segments.reduce((sum, s) => sum + s.value, 0)\n  }, [segments])\n\n  // Handle segment hover\n  const handleMouseEnter = (_, index) => {\n    setActiveIndex(index)\n  }\n\n  const handleMouseLeave = () => {\n    setActiveIndex(null)\n  }\n\n  // Handle segment click\n  const handleClick = (data, index) => {\n    if (onSegmentClick) {\n      onSegmentClick(segments[index])\n    }\n  }\n\n  // Custom tooltip\n  const CustomTooltip = ({ active, payload }) => {\n    if (!active || !payload || !payload.length) {\n      return null\n    }\n\n    const data = payload[0].payload\n    return (\n      <div className=\"chart-tooltip donut-tooltip\">\n        <div className=\"chart-tooltip-row\">\n          <span className=\"chart-tooltip-label\">\n            <span\n              className=\"chart-tooltip-dot\"\n              style={{ backgroundColor: data.color }}\n            />\n            {data.name}\n          </span>\n          <span className=\"chart-tooltip-value\">\n            {formatChartCurrency(data.value)}\n          </span>\n        </div>\n        <div className=\"donut-tooltip-pct\">\n          {data.percentage}% of total costs\n        </div>\n        {data.items && data.items.length > 0 && (\n          <div className=\"donut-tooltip-items\">\n            <div className=\"donut-tooltip-items-label\">\n              {data.items.length} item{data.items.length > 1 ? 's' : ''}\n            </div>\n          </div>\n        )}\n        {onSegmentClick && (\n          <div className=\"chart-tooltip-hint\">\n            Click to view details\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  // Custom legend\n  const renderLegend = (props) => {\n    const { payload } = props\n    return (\n      <div className=\"donut-legend\">\n        {payload.map((entry, index) => (\n          <div\n            key={`legend-${index}`}\n            className={`donut-legend-item ${activeIndex === index ? 'active' : ''}`}\n            onMouseEnter={() => setActiveIndex(index)}\n            onMouseLeave={() => setActiveIndex(null)}\n            onClick={() => handleClick(null, index)}\n          >\n            <span\n              className=\"donut-legend-color\"\n              style={{ backgroundColor: entry.payload.color }}\n            />\n            <span className=\"donut-legend-name\">{entry.value}</span>\n            <span className=\"donut-legend-value\">\n              {formatChartCurrency(entry.payload.value)}\n            </span>\n          </div>\n        ))}\n      </div>\n    )\n  }\n\n  if (!segments.length || totalCost === 0) {\n    return (\n      <div className=\"cost-donut empty\">\n        <div className=\"chart-empty-state\">\n          <p>No cost data available.</p>\n          <span>Add labor, disposal, or custom costs to see breakdown.</span>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"cost-donut\">\n      <div className=\"donut-chart-container\">\n        <ResponsiveContainer width=\"100%\" height={200}>\n          <PieChart>\n            <Pie\n              data={segments}\n              cx=\"50%\"\n              cy=\"50%\"\n              innerRadius={50}\n              outerRadius={80}\n              paddingAngle={2}\n              dataKey=\"value\"\n              onMouseEnter={handleMouseEnter}\n              onMouseLeave={handleMouseLeave}\n              onClick={handleClick}\n              animationDuration={animationConfig.duration}\n              animationEasing=\"ease-out\"\n            >\n              {segments.map((entry, index) => (\n                <Cell\n                  key={`cell-${index}`}\n                  fill={entry.color}\n                  stroke=\"var(--card-bg)\"\n                  strokeWidth={2}\n                  style={{\n                    filter: activeIndex === index ? 'brightness(1.1)' : 'none',\n                    cursor: onSegmentClick ? 'pointer' : 'default',\n                    transform: activeIndex === index ? 'scale(1.05)' : 'scale(1)',\n                    transformOrigin: 'center',\n                    transition: 'all 0.2s ease',\n                  }}\n                />\n              ))}\n            </Pie>\n            <Tooltip content={<CustomTooltip />} />\n            <Legend content={renderLegend} />\n          </PieChart>\n        </ResponsiveContainer>\n\n        {/* Center label showing total */}\n        <div className=\"donut-center-label\">\n          <span className=\"donut-center-value\">\n            {formatChartCurrency(totalCost)}\n          </span>\n          <span className=\"donut-center-text\">Total</span>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import { useState } from 'react'\nimport { ChevronDown, ChevronUp, Plus, HardHat, Truck, Wrench, Package, Users, MoreHorizontal, Trash2 } from 'lucide-react'\nimport { CostDonut } from './charts'\n\n// Helper to format currency\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount || 0)\n}\n\n// Category display info\nconst categoryInfo = {\n  labor: { label: 'Labor', Icon: HardHat, color: '#3b82f6' },\n  disposal: { label: 'Disposal', Icon: Truck, color: '#10b981' },\n  equipment: { label: 'Equipment', Icon: Wrench, color: '#f59e0b' },\n  materials: { label: 'Materials', Icon: Package, color: '#8b5cf6' },\n  subcontractor: { label: 'Subcontractor', Icon: Users, color: '#ec4899' },\n  other: { label: 'Other', Icon: MoreHorizontal, color: '#6b7280' }\n}\n\nexport default function CostContributorsCard({\n  laborCost = 0,\n  haulOffCost = 0,\n  customCosts = [],\n  onAddCost,\n  onDeleteCost\n}) {\n  const [showChart, setShowChart] = useState(true)\n  const [expandedCategory, setExpandedCategory] = useState(null)\n\n  // Build cost breakdown combining auto-tracked and custom costs\n  const costBreakdown = []\n\n  // Labor (auto-tracked from crew check-ins)\n  if (laborCost > 0) {\n    costBreakdown.push({\n      category: 'labor',\n      label: 'Labor',\n      amount: laborCost,\n      source: 'auto',\n      description: 'From crew check-ins'\n    })\n  }\n\n  // Disposal (auto-tracked from haul-offs)\n  if (haulOffCost > 0) {\n    costBreakdown.push({\n      category: 'disposal',\n      label: 'Disposal',\n      amount: haulOffCost,\n      source: 'auto',\n      description: 'From haul-off logs'\n    })\n  }\n\n  // Group custom costs by category\n  const customByCategory = {}\n  customCosts.forEach(cost => {\n    if (!customByCategory[cost.category]) {\n      customByCategory[cost.category] = {\n        category: cost.category,\n        items: [],\n        total: 0\n      }\n    }\n    customByCategory[cost.category].items.push(cost)\n    customByCategory[cost.category].total += parseFloat(cost.amount) || 0\n  })\n\n  // Add custom cost categories\n  Object.values(customByCategory).forEach(group => {\n    const info = categoryInfo[group.category] || categoryInfo.other\n    costBreakdown.push({\n      category: group.category,\n      label: info.label,\n      amount: group.total,\n      source: 'manual',\n      items: group.items\n    })\n  })\n\n  // Calculate total\n  const totalCost = costBreakdown.reduce((sum, cat) => sum + cat.amount, 0)\n\n  // Calculate percentages and sort by amount\n  costBreakdown.forEach(cat => {\n    cat.percentage = totalCost > 0 ? (cat.amount / totalCost) * 100 : 0\n  })\n  costBreakdown.sort((a, b) => b.amount - a.amount)\n\n  // Toggle category expansion\n  const toggleCategory = (category) => {\n    setExpandedCategory(expandedCategory === category ? null : category)\n  }\n\n  // Handle donut segment click\n  const handleSegmentClick = (segment) => {\n    if (segment.items && segment.items.length > 0) {\n      setShowChart(false)\n      setExpandedCategory(segment.category)\n    }\n  }\n\n  return (\n    <div className=\"cost-contributors-card\">\n      <div className=\"cost-contributors-header\">\n        <div className=\"cost-contributors-title\">\n          <h3>Cost Contributors</h3>\n          <span className=\"cost-total\">{formatCurrency(totalCost)}</span>\n        </div>\n        {costBreakdown.length > 0 && (\n          <div className=\"cost-view-toggle\">\n            <button\n              className={showChart ? 'active' : ''}\n              onClick={() => setShowChart(true)}\n            >\n              Chart\n            </button>\n            <button\n              className={!showChart ? 'active' : ''}\n              onClick={() => setShowChart(false)}\n            >\n              List\n            </button>\n          </div>\n        )}\n      </div>\n\n      {costBreakdown.length === 0 ? (\n        <div className=\"cost-empty\">\n          <p>No costs recorded yet</p>\n          <small>Costs will appear as crew checks in and haul-offs are logged</small>\n        </div>\n      ) : showChart ? (\n        <CostDonut\n          laborCost={laborCost}\n          haulOffCost={haulOffCost}\n          customCosts={customCosts}\n          onSegmentClick={handleSegmentClick}\n        />\n      ) : (\n        <div className=\"cost-breakdown\">\n          {costBreakdown.map(category => {\n            const info = categoryInfo[category.category] || categoryInfo.other\n            const Icon = info.Icon\n            const hasItems = category.items && category.items.length > 0\n            const isExpanded = expandedCategory === category.category\n\n            return (\n              <div key={category.category} className=\"cost-category\">\n                <div\n                  className={`cost-category-row ${hasItems ? 'expandable' : ''}`}\n                  onClick={() => hasItems && toggleCategory(category.category)}\n                >\n                  <div className=\"cost-category-bar-container\">\n                    <div\n                      className=\"cost-category-bar\"\n                      style={{\n                        width: `${Math.max(category.percentage, 2)}%`,\n                        backgroundColor: info.color\n                      }}\n                    ></div>\n                  </div>\n                  <div className=\"cost-category-info\">\n                    <div className=\"cost-category-label\">\n                      <Icon size={14} style={{ color: info.color }} />\n                      <span>{category.label}</span>\n                      {category.source === 'auto' && (\n                        <span className=\"cost-auto-badge\">Auto</span>\n                      )}\n                      {hasItems && (\n                        isExpanded ? <ChevronUp size={14} /> : <ChevronDown size={14} />\n                      )}\n                    </div>\n                    <div className=\"cost-category-values\">\n                      <span className=\"cost-amount\">{formatCurrency(category.amount)}</span>\n                      <span className=\"cost-percent\">{Math.round(category.percentage)}%</span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Expanded items for manual costs */}\n                {isExpanded && hasItems && (\n                  <div className=\"cost-category-items\">\n                    {category.items.map(item => (\n                      <div key={item.id} className=\"cost-item\">\n                        <div className=\"cost-item-info\">\n                          <span className=\"cost-item-desc\">{item.description}</span>\n                          <span className=\"cost-item-date\">\n                            {new Date(item.cost_date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                          </span>\n                        </div>\n                        <div className=\"cost-item-actions\">\n                          <span className=\"cost-item-amount\">{formatCurrency(item.amount)}</span>\n                          {onDeleteCost && (\n                            <button\n                              className=\"cost-item-delete\"\n                              onClick={(e) => {\n                                e.stopPropagation()\n                                if (confirm('Delete this cost entry?')) {\n                                  onDeleteCost(item.id)\n                                }\n                              }}\n                            >\n                              <Trash2 size={14} />\n                            </button>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      )}\n\n      {onAddCost && (\n        <button className=\"cost-add-btn\" onClick={onAddCost}>\n          <Plus size={16} />\n          <span>Add Cost</span>\n        </button>\n      )}\n    </div>\n  )\n}\n","import { TrendingUp, TrendingDown, AlertCircle, CheckCircle } from 'lucide-react'\n\n// Helper to format currency\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount || 0)\n}\n\nexport default function ProfitabilityCard({\n  revenue,      // billable amount (earned based on progress)\n  totalCosts,   // all costs combined\n  contractValue, // total contract value\n  progress      // completion percentage\n}) {\n  // Current profit and margin\n  const currentProfit = revenue - totalCosts\n  const currentMargin = revenue > 0 ? (currentProfit / revenue) * 100 : 0\n\n  // Projected final values (extrapolate based on current progress)\n  const projectedRevenue = contractValue\n  const projectedCosts = progress > 0 ? (totalCosts / (progress / 100)) : totalCosts\n  const projectedProfit = projectedRevenue - projectedCosts\n  const projectedMargin = projectedRevenue > 0 ? (projectedProfit / projectedRevenue) * 100 : 0\n\n  // Determine status\n  const isHealthy = currentMargin >= 20\n  const isWarning = currentMargin >= 0 && currentMargin < 20\n  const isLoss = currentMargin < 0\n\n  const status = isHealthy ? 'healthy' : isWarning ? 'warning' : 'loss'\n  const statusLabel = isHealthy ? 'On Track' : isWarning ? 'Watch Margin' : 'Over Cost'\n  const StatusIcon = isHealthy ? CheckCircle : isWarning ? AlertCircle : TrendingDown\n\n  return (\n    <div className={`profitability-card ${status}`}>\n      <div className=\"profitability-header\">\n        <h3>Profitability</h3>\n        <div className={`profitability-status ${status}`}>\n          <StatusIcon size={14} />\n          <span>{statusLabel}</span>\n        </div>\n      </div>\n\n      <div className=\"profitability-metrics\">\n        {/* Current Margin */}\n        <div className=\"profit-metric\">\n          <div className=\"profit-metric-header\">\n            <span className=\"profit-metric-label\">Current Margin</span>\n            <span className={`profit-metric-value ${currentMargin < 0 ? 'negative' : ''}`}>\n              {Math.round(currentMargin)}%\n            </span>\n          </div>\n          <div className=\"profit-bar-container\">\n            <div\n              className={`profit-bar ${currentMargin < 0 ? 'negative' : currentMargin < 20 ? 'warning' : 'healthy'}`}\n              style={{ width: `${Math.min(Math.abs(currentMargin), 100)}%` }}\n            ></div>\n          </div>\n        </div>\n\n        {/* Projected Final Margin */}\n        {progress > 10 && (\n          <div className=\"profit-metric\">\n            <div className=\"profit-metric-header\">\n              <span className=\"profit-metric-label\">Projected Final</span>\n              <span className={`profit-metric-value ${projectedMargin < 0 ? 'negative' : ''}`}>\n                {Math.round(projectedMargin)}%\n              </span>\n            </div>\n            <div className=\"profit-bar-container\">\n              <div\n                className={`profit-bar ${projectedMargin < 0 ? 'negative' : projectedMargin < 20 ? 'warning' : 'healthy'}`}\n                style={{ width: `${Math.min(Math.abs(projectedMargin), 100)}%` }}\n              ></div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      <div className=\"profitability-summary\">\n        <div className=\"profit-row\">\n          <span className=\"profit-label\">Revenue Earned</span>\n          <span className=\"profit-value\">{formatCurrency(revenue)}</span>\n        </div>\n        <div className=\"profit-row\">\n          <span className=\"profit-label\">Total Costs</span>\n          <span className=\"profit-value negative\">- {formatCurrency(totalCosts)}</span>\n        </div>\n        <div className=\"profit-row profit-total\">\n          <span className=\"profit-label\">Current Profit</span>\n          <span className={`profit-value ${currentProfit < 0 ? 'negative' : 'positive'}`}>\n            {currentProfit >= 0 ? '' : '-'}{formatCurrency(Math.abs(currentProfit))}\n          </span>\n        </div>\n      </div>\n\n      {progress > 10 && (\n        <div className=\"profitability-insight\">\n          {isHealthy && (\n            <p>\n              At {Math.round(progress)}% complete, you're at {formatCurrency(currentProfit)} profit.\n              {projectedProfit > 0 && ` Projected final profit: ${formatCurrency(projectedProfit)}`}\n            </p>\n          )}\n          {isWarning && (\n            <p>\n              Margins are thin. Consider reviewing costs or scope.\n              {projectedProfit < 0 && ` Trending toward ${formatCurrency(projectedProfit)} loss.`}\n            </p>\n          )}\n          {isLoss && (\n            <p>\n              Currently over cost by {formatCurrency(Math.abs(currentProfit))}.\n              Immediate review recommended.\n            </p>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n","import { useState, useEffect } from 'react'\nimport { Truck, ChevronDown, ChevronUp } from 'lucide-react'\nimport { db } from '../lib/supabase'\n\nconst LOAD_TYPES = [\n  { value: 'concrete', label: 'Concrete', icon: '' },\n  { value: 'trash', label: 'Trash', icon: '' },\n  { value: 'metals', label: 'Metals', icon: '' },\n  { value: 'hazardous_waste', label: 'Hazardous', icon: '' }\n]\n\nconst getLoadTypeInfo = (type) => LOAD_TYPES.find(t => t.value === type) || { label: type, icon: '' }\n\nexport default function DisposalSummary({ project, period = 'week' }) {\n  const [loads, setLoads] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [expanded, setExpanded] = useState(false)\n\n  useEffect(() => {\n    if (project?.id) {\n      loadData()\n    }\n  }, [project?.id, period])\n\n  const loadData = async () => {\n    try {\n      setLoading(true)\n      const days = period === 'week' ? 7 : period === 'month' ? 30 : 14\n      const data = await db.getDisposalLoadsHistory(project.id, days)\n      setLoads(data || [])\n    } catch (err) {\n      console.error('Error loading disposal summary:', err)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // Group loads by type for totals\n  const loadsByType = loads.reduce((acc, load) => {\n    const type = load.load_type\n    if (!acc[type]) {\n      acc[type] = 0\n    }\n    acc[type] += load.load_count\n    return acc\n  }, {})\n\n  // Group by date for breakdown\n  const loadsByDate = loads.reduce((acc, load) => {\n    const date = load.load_date || load.work_date\n    if (!acc[date]) {\n      acc[date] = { date, loads: [], total: 0 }\n    }\n    acc[date].loads.push(load)\n    acc[date].total += load.load_count\n    return acc\n  }, {})\n\n  const sortedDates = Object.values(loadsByDate)\n    .sort((a, b) => new Date(b.date) - new Date(a.date))\n    .slice(0, 7)\n\n  const totalLoads = loads.reduce((sum, l) => sum + l.load_count, 0)\n  const hasLoads = totalLoads > 0\n\n  if (loading) {\n    return (\n      <div className=\"disposal-summary-card\">\n        <div className=\"card-header\">\n          <div className=\"header-left\">\n            <Truck size={18} />\n            <span>Disposal Loads</span>\n          </div>\n        </div>\n        <div className=\"card-loading\">Loading...</div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"disposal-summary-card\">\n      <div className=\"card-header\">\n        <div className=\"header-left\">\n          <Truck size={18} />\n          <span>Disposal Loads</span>\n        </div>\n        <span className=\"period-badge\">\n          {period === 'week' ? 'Last 7 days' : period === 'month' ? 'Last 30 days' : 'Last 14 days'}\n        </span>\n      </div>\n\n      {!hasLoads ? (\n        <div className=\"disposal-empty-state\">\n          <Truck size={32} />\n          <p>No disposal loads recorded</p>\n          <span className=\"text-muted\">Loads will appear here when logged by field crews</span>\n        </div>\n      ) : (\n        <>\n          {/* Total */}\n          <div className=\"disposal-total\">\n            <span className=\"disposal-total-value\">{totalLoads}</span>\n            <span className=\"disposal-total-label\">Total Loads</span>\n          </div>\n\n          {/* By Type Breakdown */}\n          <div className=\"disposal-breakdown\">\n            {LOAD_TYPES.map(type => {\n              const count = loadsByType[type.value] || 0\n              if (count === 0) return null\n              const percentage = Math.round((count / totalLoads) * 100)\n\n              return (\n                <div key={type.value} className=\"disposal-type-row\">\n                  <div className=\"disposal-type-info\">\n                    <span className=\"disposal-type-icon\">{type.icon}</span>\n                    <span className=\"disposal-type-label\">{type.label}</span>\n                  </div>\n                  <div className=\"disposal-type-stats\">\n                    <span className=\"disposal-type-count\">{count}</span>\n                    <div className=\"disposal-type-bar\">\n                      <div\n                        className=\"disposal-type-bar-fill\"\n                        style={{ width: `${percentage}%` }}\n                      />\n                    </div>\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n\n          {/* Daily Breakdown Toggle */}\n          {sortedDates.length > 0 && (\n            <button\n              className=\"disposal-expand-btn\"\n              onClick={() => setExpanded(!expanded)}\n            >\n              {expanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n              <span>{expanded ? 'Hide' : 'View'} Daily Breakdown</span>\n            </button>\n          )}\n\n          {/* Daily Breakdown */}\n          {expanded && sortedDates.length > 0 && (\n            <div className=\"disposal-daily-breakdown\">\n              {sortedDates.map(day => {\n                const formattedDate = new Date(day.date).toLocaleDateString('en-US', {\n                  weekday: 'short',\n                  month: 'short',\n                  day: 'numeric'\n                })\n\n                // Group by type for this day\n                const dayLoadsByType = day.loads.reduce((acc, load) => {\n                  if (!acc[load.load_type]) acc[load.load_type] = 0\n                  acc[load.load_type] += load.load_count\n                  return acc\n                }, {})\n\n                return (\n                  <div key={day.date} className=\"disposal-daily-row\">\n                    <div className=\"disposal-daily-header\">\n                      <span className=\"disposal-daily-date\">{formattedDate}</span>\n                      <span className=\"disposal-daily-total\">{day.total} loads</span>\n                    </div>\n                    <div className=\"disposal-daily-types\">\n                      {Object.entries(dayLoadsByType).map(([type, count]) => {\n                        const typeInfo = getLoadTypeInfo(type)\n                        return (\n                          <span key={type} className=\"disposal-daily-type\">\n                            {typeInfo.icon} {count}\n                          </span>\n                        )\n                      })}\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  )\n}\n","import { useState, useEffect } from 'react'\nimport { db } from '../lib/supabase'\nimport { Users, UserPlus, UserMinus, ChevronDown, X } from 'lucide-react'\n\nconst PROJECT_ROLE_OPTIONS = [\n  'Project Manager',\n  'Superintendent',\n  'Foreman',\n  'Office Support',\n  'Engineer',\n  'Inspector',\n  'Team Member'\n]\n\nexport default function ProjectTeam({ project, company, user, isAdmin, onShowToast }) {\n  const [teamMembers, setTeamMembers] = useState([])\n  const [companyMembers, setCompanyMembers] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [showAddModal, setShowAddModal] = useState(false)\n  const [selectedUser, setSelectedUser] = useState('')\n  const [selectedRole, setSelectedRole] = useState('Team Member')\n  const [actionLoading, setActionLoading] = useState(null)\n\n  useEffect(() => {\n    if (project?.id) {\n      loadProjectTeam()\n    }\n  }, [project?.id])\n\n  useEffect(() => {\n    if (showAddModal && company?.id) {\n      loadCompanyMembers()\n    }\n  }, [showAddModal, company?.id])\n\n  const loadProjectTeam = async () => {\n    try {\n      setLoading(true)\n      const data = await db.getProjectTeam(project.id)\n      setTeamMembers(data)\n    } catch (error) {\n      console.error('Error loading project team:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const loadCompanyMembers = async () => {\n    try {\n      const data = await db.getCompanyMembers(company.id)\n      // Filter out users already on the project\n      const existingUserIds = teamMembers.map(tm => tm.users?.id)\n      const available = data.filter(m => !existingUserIds.includes(m.users?.id))\n      setCompanyMembers(available)\n    } catch (error) {\n      console.error('Error loading company members:', error)\n    }\n  }\n\n  const handleAddMember = async () => {\n    if (!selectedUser) {\n      onShowToast('Select a team member', 'error')\n      return\n    }\n\n    try {\n      setActionLoading('add')\n      await db.addProjectMember(project.id, selectedUser, selectedRole, user.id)\n      onShowToast('Team member added', 'success')\n      setShowAddModal(false)\n      setSelectedUser('')\n      setSelectedRole('Team Member')\n      loadProjectTeam()\n    } catch (error) {\n      console.error('Error adding team member:', error)\n      onShowToast('Error adding team member', 'error')\n    } finally {\n      setActionLoading(null)\n    }\n  }\n\n  const handleUpdateRole = async (member, newRole) => {\n    try {\n      setActionLoading(member.id)\n      await db.updateProjectMemberRole(project.id, member.users?.id, newRole)\n      onShowToast('Role updated', 'success')\n      loadProjectTeam()\n    } catch (error) {\n      console.error('Error updating role:', error)\n      onShowToast('Error updating role', 'error')\n    } finally {\n      setActionLoading(null)\n    }\n  }\n\n  const handleRemoveMember = async (member) => {\n    try {\n      setActionLoading(member.id)\n      await db.removeProjectMember(project.id, member.users?.id)\n      onShowToast('Team member removed', 'success')\n      loadProjectTeam()\n    } catch (error) {\n      console.error('Error removing team member:', error)\n      onShowToast('Error removing team member', 'error')\n    } finally {\n      setActionLoading(null)\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"project-team\">\n        <div className=\"project-team-header\">\n          <h3><Users size={18} /> Project Team</h3>\n        </div>\n        <div className=\"loading-small\">Loading...</div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"project-team\">\n      <div className=\"project-team-header\">\n        <h3><Users size={18} /> Project Team</h3>\n        {isAdmin && (\n          <button\n            className=\"btn btn-small btn-primary\"\n            onClick={() => setShowAddModal(true)}\n          >\n            <UserPlus size={14} /> Add\n          </button>\n        )}\n      </div>\n\n      {teamMembers.length === 0 ? (\n        <div className=\"project-team-empty\">\n          No team members assigned yet\n          {isAdmin && <p>Click \"Add\" to assign team members to this project</p>}\n        </div>\n      ) : (\n        <div className=\"project-team-list\">\n          {teamMembers.map(member => (\n            <div key={member.id} className=\"project-team-member\">\n              <div className=\"team-member-info\">\n                <div className=\"team-member-name\">{member.users?.name || 'Unknown'}</div>\n                <div className=\"team-member-email\">{member.users?.email}</div>\n              </div>\n              <div className=\"team-member-role\">\n                {isAdmin ? (\n                  <div className=\"role-selector compact\">\n                    <select\n                      value={member.project_role}\n                      onChange={(e) => handleUpdateRole(member, e.target.value)}\n                      disabled={actionLoading === member.id}\n                      className=\"role-select\"\n                    >\n                      {PROJECT_ROLE_OPTIONS.map(role => (\n                        <option key={role} value={role}>{role}</option>\n                      ))}\n                    </select>\n                    <ChevronDown size={12} className=\"role-select-icon\" />\n                  </div>\n                ) : (\n                  <span className=\"role-badge\">{member.project_role}</span>\n                )}\n              </div>\n              {isAdmin && (\n                <button\n                  className=\"btn-icon btn-danger-subtle\"\n                  onClick={() => handleRemoveMember(member)}\n                  disabled={actionLoading === member.id}\n                  title=\"Remove from project\"\n                >\n                  <UserMinus size={14} />\n                </button>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Add Member Modal */}\n      {showAddModal && (\n        <div className=\"modal-overlay\" onClick={() => setShowAddModal(false)}>\n          <div className=\"modal-content small\" onClick={e => e.stopPropagation()}>\n            <div className=\"modal-header\">\n              <h3>Add Team Member</h3>\n              <button className=\"modal-close\" onClick={() => setShowAddModal(false)}>\n                <X size={20} />\n              </button>\n            </div>\n            <div className=\"modal-body\">\n              <div className=\"form-group\">\n                <label>Select Team Member</label>\n                <select\n                  value={selectedUser}\n                  onChange={(e) => setSelectedUser(e.target.value)}\n                  className=\"form-select\"\n                >\n                  <option value=\"\">Choose a team member...</option>\n                  {companyMembers.map(member => (\n                    <option key={member.users?.id} value={member.users?.id}>\n                      {member.users?.name || member.users?.email}\n                    </option>\n                  ))}\n                </select>\n                {companyMembers.length === 0 && (\n                  <p className=\"form-hint\">All company members are already assigned to this project</p>\n                )}\n              </div>\n              <div className=\"form-group\">\n                <label>Project Role</label>\n                <select\n                  value={selectedRole}\n                  onChange={(e) => setSelectedRole(e.target.value)}\n                  className=\"form-select\"\n                >\n                  {PROJECT_ROLE_OPTIONS.map(role => (\n                    <option key={role} value={role}>{role}</option>\n                  ))}\n                </select>\n                <p className=\"form-hint\">This is for visibility only - it doesn't affect permissions</p>\n              </div>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-secondary\"\n                onClick={() => setShowAddModal(false)}\n              >\n                Cancel\n              </button>\n              <button\n                className=\"btn btn-primary\"\n                onClick={handleAddMember}\n                disabled={!selectedUser || actionLoading === 'add'}\n              >\n                {actionLoading === 'add' ? 'Adding...' : 'Add to Project'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n","import { memo } from 'react'\n\n/**\n * Skeleton - Loading placeholder component\n * Follows progressive disclosure principle - shows structure before content\n */\n\n// Base skeleton with shimmer animation\nexport const Skeleton = memo(function Skeleton({\n  width,\n  height,\n  borderRadius = '8px',\n  className = '',\n  variant = 'default' // 'default' | 'text' | 'circular' | 'rectangular'\n}) {\n  const getVariantStyles = () => {\n    switch (variant) {\n      case 'text':\n        return { height: '1em', borderRadius: '4px' }\n      case 'circular':\n        return { borderRadius: '50%' }\n      case 'rectangular':\n        return { borderRadius: '0' }\n      default:\n        return { borderRadius }\n    }\n  }\n\n  const variantStyles = getVariantStyles()\n\n  return (\n    <div\n      className={`skeleton ${className}`}\n      style={{\n        width: width || '100%',\n        height: height || variantStyles.height || '1rem',\n        borderRadius: variantStyles.borderRadius,\n      }}\n      aria-hidden=\"true\"\n    />\n  )\n})\n\n// Skeleton for metric cards (value + label)\nexport const MetricSkeleton = memo(function MetricSkeleton({ showProgress = false }) {\n  return (\n    <div className=\"metric-skeleton\">\n      <Skeleton width=\"60%\" height=\"0.75rem\" className=\"skeleton-label\" />\n      <Skeleton width=\"80%\" height=\"1.75rem\" className=\"skeleton-value\" />\n      {showProgress && (\n        <Skeleton width=\"100%\" height=\"6px\" className=\"skeleton-progress\" />\n      )}\n    </div>\n  )\n})\n\n// Skeleton for cards (header + content)\nexport const CardSkeleton = memo(function CardSkeleton({\n  lines = 3,\n  showHeader = true,\n  showAction = false\n}) {\n  return (\n    <div className=\"card-skeleton\" aria-busy=\"true\" aria-label=\"Loading content\">\n      {showHeader && (\n        <div className=\"card-skeleton-header\">\n          <Skeleton width=\"40%\" height=\"1.25rem\" />\n          {showAction && <Skeleton width=\"80px\" height=\"32px\" />}\n        </div>\n      )}\n      <div className=\"card-skeleton-body\">\n        {Array.from({ length: lines }).map((_, i) => (\n          <Skeleton\n            key={i}\n            width={`${100 - (i * 15)}%`}\n            height=\"1rem\"\n            className=\"skeleton-line\"\n          />\n        ))}\n      </div>\n    </div>\n  )\n})\n\n// Skeleton for list items\nexport const ListItemSkeleton = memo(function ListItemSkeleton({\n  count = 3,\n  showAvatar = false,\n  showAction = false\n}) {\n  return (\n    <div className=\"list-skeleton\" aria-busy=\"true\" aria-label=\"Loading list\">\n      {Array.from({ length: count }).map((_, i) => (\n        <div key={i} className=\"list-item-skeleton\">\n          {showAvatar && <Skeleton width=\"40px\" height=\"40px\" variant=\"circular\" />}\n          <div className=\"list-item-skeleton-content\">\n            <Skeleton width=\"60%\" height=\"1rem\" />\n            <Skeleton width=\"40%\" height=\"0.75rem\" />\n          </div>\n          {showAction && <Skeleton width=\"60px\" height=\"28px\" />}\n        </div>\n      ))}\n    </div>\n  )\n})\n\n// Skeleton for financial analysis row (3 cards)\nexport const FinancialRowSkeleton = memo(function FinancialRowSkeleton() {\n  return (\n    <div className=\"financial-row-skeleton\" aria-busy=\"true\" aria-label=\"Loading financial data\">\n      {[1, 2, 3].map(i => (\n        <div key={i} className=\"financial-card-skeleton\">\n          <div className=\"financial-card-skeleton-header\">\n            <Skeleton width=\"24px\" height=\"24px\" variant=\"circular\" />\n            <Skeleton width=\"60%\" height=\"1rem\" />\n          </div>\n          <Skeleton width=\"50%\" height=\"2rem\" className=\"skeleton-hero-value\" />\n          <div className=\"financial-card-skeleton-details\">\n            <Skeleton width=\"100%\" height=\"0.875rem\" />\n            <Skeleton width=\"80%\" height=\"0.875rem\" />\n          </div>\n        </div>\n      ))}\n    </div>\n  )\n})\n\n// Skeleton for chart placeholder\nexport const ChartSkeleton = memo(function ChartSkeleton({ height = '200px' }) {\n  return (\n    <div className=\"chart-skeleton\" style={{ height }} aria-busy=\"true\" aria-label=\"Loading chart\">\n      <div className=\"chart-skeleton-bars\">\n        {[40, 65, 45, 80, 55, 70, 50, 75, 60, 85].map((h, i) => (\n          <div\n            key={i}\n            className=\"chart-skeleton-bar\"\n            style={{ height: `${h}%` }}\n          />\n        ))}\n      </div>\n      <Skeleton width=\"100%\" height=\"1px\" className=\"chart-skeleton-axis\" />\n    </div>\n  )\n})\n\n// Skeleton for COR/Ticket items\nexport const TicketSkeleton = memo(function TicketSkeleton({ count = 3 }) {\n  return (\n    <div className=\"ticket-skeleton-list\" aria-busy=\"true\" aria-label=\"Loading tickets\">\n      {Array.from({ length: count }).map((_, i) => (\n        <div key={i} className=\"ticket-skeleton-item\">\n          <div className=\"ticket-skeleton-header\">\n            <Skeleton width=\"100px\" height=\"0.875rem\" />\n            <Skeleton width=\"80px\" height=\"24px\" borderRadius=\"12px\" />\n          </div>\n          <Skeleton width=\"90%\" height=\"1rem\" />\n          <div className=\"ticket-skeleton-footer\">\n            <Skeleton width=\"60px\" height=\"0.75rem\" />\n            <Skeleton width=\"60px\" height=\"0.75rem\" />\n            <Skeleton width=\"60px\" height=\"0.75rem\" />\n          </div>\n        </div>\n      ))}\n    </div>\n  )\n})\n\n// Skeleton for hero metrics row\nexport const HeroMetricsSkeleton = memo(function HeroMetricsSkeleton() {\n  return (\n    <div className=\"hero-metrics-skeleton\" aria-busy=\"true\" aria-label=\"Loading metrics\">\n      {[1, 2, 3, 4].map(i => (\n        <div key={i} className=\"hero-metric-skeleton\">\n          <Skeleton width=\"80px\" height=\"0.75rem\" className=\"skeleton-label\" />\n          <Skeleton width=\"120px\" height=\"1.75rem\" className=\"skeleton-value\" />\n          <Skeleton width=\"100%\" height=\"4px\" className=\"skeleton-bar\" />\n        </div>\n      ))}\n    </div>\n  )\n})\n\nexport default Skeleton\n","import { memo } from 'react'\nimport { AlertTriangle, RefreshCw, WifiOff } from 'lucide-react'\n\n/**\n * ErrorState - Reusable error display component for list/data components\n * Provides user-friendly error messages with retry functionality\n */\nexport const ErrorState = memo(function ErrorState({\n  title = 'Unable to load data',\n  message = 'Something went wrong. Please try again.',\n  error = null,\n  onRetry = null,\n  retryLabel = 'Try Again',\n  variant = 'default', // 'default' | 'inline' | 'compact'\n  icon: CustomIcon = null\n}) {\n  // Determine icon based on error type\n  const getIcon = () => {\n    if (CustomIcon) return CustomIcon\n    if (error?.message?.includes('network') || error?.message?.includes('offline')) {\n      return WifiOff\n    }\n    return AlertTriangle\n  }\n\n  const Icon = getIcon()\n\n  if (variant === 'compact') {\n    return (\n      <div className=\"error-state error-state-compact\" role=\"alert\">\n        <Icon size={16} className=\"error-state-icon\" aria-hidden=\"true\" />\n        <span className=\"error-state-message\">{message}</span>\n        {onRetry && (\n          <button\n            className=\"btn btn-ghost btn-small\"\n            onClick={onRetry}\n            aria-label={retryLabel}\n          >\n            <RefreshCw size={14} />\n          </button>\n        )}\n      </div>\n    )\n  }\n\n  if (variant === 'inline') {\n    return (\n      <div className=\"error-state error-state-inline\" role=\"alert\">\n        <div className=\"error-state-content\">\n          <Icon size={20} className=\"error-state-icon\" aria-hidden=\"true\" />\n          <div className=\"error-state-text\">\n            <span className=\"error-state-title\">{title}</span>\n            <span className=\"error-state-message\">{message}</span>\n          </div>\n        </div>\n        {onRetry && (\n          <button className=\"btn btn-secondary btn-small\" onClick={onRetry}>\n            <RefreshCw size={14} /> {retryLabel}\n          </button>\n        )}\n      </div>\n    )\n  }\n\n  // Default variant - centered with full details\n  return (\n    <div className=\"error-state\" role=\"alert\" aria-live=\"polite\">\n      <div className=\"error-state-icon-wrapper\">\n        <Icon size={32} className=\"error-state-icon\" aria-hidden=\"true\" />\n      </div>\n      <h4 className=\"error-state-title\">{title}</h4>\n      <p className=\"error-state-message\">{message}</p>\n\n      {/* Show error details in development */}\n      {import.meta.env.DEV && error && (\n        <details className=\"error-state-details\">\n          <summary>Error Details</summary>\n          <pre>{error.message || String(error)}</pre>\n        </details>\n      )}\n\n      {onRetry && (\n        <button className=\"btn btn-primary\" onClick={onRetry}>\n          <RefreshCw size={16} /> {retryLabel}\n        </button>\n      )}\n    </div>\n  )\n})\n\n/**\n * EmptyState - Reusable empty state component\n * Shows when a list/data is empty (no error, just no data)\n */\nexport const EmptyState = memo(function EmptyState({\n  title = 'No data yet',\n  message = 'Items will appear here once added.',\n  icon: Icon = null,\n  action = null,\n  actionLabel = 'Get Started',\n  onAction = null\n}) {\n  return (\n    <div className=\"empty-state\" role=\"status\">\n      {Icon && (\n        <div className=\"empty-state-icon-wrapper\">\n          <Icon size={32} className=\"empty-state-icon\" aria-hidden=\"true\" />\n        </div>\n      )}\n      <h4 className=\"empty-state-title\">{title}</h4>\n      <p className=\"empty-state-message\">{message}</p>\n      {onAction && (\n        <button className=\"btn btn-primary btn-small\" onClick={onAction}>\n          {actionLabel}\n        </button>\n      )}\n      {action && !onAction && action}\n    </div>\n  )\n})\n\nexport default ErrorState\n","import { memo } from 'react'\nimport { AlertCircle } from 'lucide-react'\n\n/**\n * FormField - Reusable form field wrapper with validation display\n * Provides consistent styling and error handling for form inputs\n */\nexport const FormField = memo(function FormField({\n  label,\n  error,\n  required = false,\n  hint,\n  children,\n  className = ''\n}) {\n  return (\n    <div className={`form-field ${error ? 'has-error' : ''} ${className}`}>\n      {label && (\n        <label className=\"form-field-label\">\n          {label}\n          {required && <span className=\"form-field-required\">*</span>}\n        </label>\n      )}\n      <div className=\"form-field-input\">\n        {children}\n      </div>\n      {error && (\n        <div className=\"form-field-error\" role=\"alert\">\n          <AlertCircle size={14} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n      {hint && !error && (\n        <div className=\"form-field-hint\">{hint}</div>\n      )}\n    </div>\n  )\n})\n\n/**\n * ValidatedInput - Input with built-in validation styling\n */\nexport const ValidatedInput = memo(function ValidatedInput({\n  type = 'text',\n  value,\n  onChange,\n  onBlur,\n  error,\n  placeholder,\n  disabled,\n  min,\n  max,\n  step,\n  pattern,\n  required,\n  autoComplete,\n  name,\n  id,\n  className = '',\n  'aria-label': ariaLabel,\n  'aria-describedby': ariaDescribedBy\n}) {\n  const inputId = id || name\n  const errorId = error ? `${inputId}-error` : undefined\n\n  return (\n    <>\n      <input\n        type={type}\n        id={inputId}\n        name={name}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        placeholder={placeholder}\n        disabled={disabled}\n        min={min}\n        max={max}\n        step={step}\n        pattern={pattern}\n        required={required}\n        autoComplete={autoComplete}\n        className={`validated-input ${error ? 'has-error' : ''} ${className}`}\n        aria-label={ariaLabel}\n        aria-invalid={!!error}\n        aria-describedby={error ? errorId : ariaDescribedBy}\n      />\n      {error && (\n        <div id={errorId} className=\"input-error-inline\" role=\"alert\">\n          <AlertCircle size={12} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n    </>\n  )\n})\n\n/**\n * ValidatedSelect - Select with built-in validation styling\n */\nexport const ValidatedSelect = memo(function ValidatedSelect({\n  value,\n  onChange,\n  onBlur,\n  error,\n  disabled,\n  required,\n  name,\n  id,\n  className = '',\n  children,\n  'aria-label': ariaLabel\n}) {\n  const selectId = id || name\n  const errorId = error ? `${selectId}-error` : undefined\n\n  return (\n    <>\n      <select\n        id={selectId}\n        name={name}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        disabled={disabled}\n        required={required}\n        className={`validated-select ${error ? 'has-error' : ''} ${className}`}\n        aria-label={ariaLabel}\n        aria-invalid={!!error}\n        aria-describedby={error ? errorId : undefined}\n      >\n        {children}\n      </select>\n      {error && (\n        <div id={errorId} className=\"input-error-inline\" role=\"alert\">\n          <AlertCircle size={12} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n    </>\n  )\n})\n\n/**\n * ValidatedTextarea - Textarea with built-in validation styling\n */\nexport const ValidatedTextarea = memo(function ValidatedTextarea({\n  value,\n  onChange,\n  onBlur,\n  error,\n  placeholder,\n  disabled,\n  required,\n  rows = 3,\n  maxLength,\n  name,\n  id,\n  className = '',\n  'aria-label': ariaLabel\n}) {\n  const textareaId = id || name\n  const errorId = error ? `${textareaId}-error` : undefined\n\n  return (\n    <>\n      <textarea\n        id={textareaId}\n        name={name}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        placeholder={placeholder}\n        disabled={disabled}\n        required={required}\n        rows={rows}\n        maxLength={maxLength}\n        className={`validated-textarea ${error ? 'has-error' : ''} ${className}`}\n        aria-label={ariaLabel}\n        aria-invalid={!!error}\n        aria-describedby={error ? errorId : undefined}\n      />\n      {maxLength && (\n        <div className=\"textarea-counter\">\n          {value?.length || 0} / {maxLength}\n        </div>\n      )}\n      {error && (\n        <div id={errorId} className=\"input-error-inline\" role=\"alert\">\n          <AlertCircle size={12} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n    </>\n  )\n})\n\nexport default FormField\n","import { memo, useEffect, useState, useRef } from 'react'\nimport { TrendingUp, TrendingDown, Minus, Check, AlertTriangle, Clock } from 'lucide-react'\n\n/**\n * Micro-Visualizations - Small, informative visual elements\n * Designed to replace mental calculation and clarify status at a glance\n */\n\n// Animated count badge with optional pulse for new items\nexport const CountBadge = memo(function CountBadge({\n  count,\n  label,\n  variant = 'default', // 'default' | 'primary' | 'success' | 'warning' | 'danger'\n  size = 'medium', // 'small' | 'medium' | 'large'\n  pulse = false,\n  icon: Icon\n}) {\n  const [prevCount, setPrevCount] = useState(count)\n  const [animating, setAnimating] = useState(false)\n\n  useEffect(() => {\n    if (count !== prevCount) {\n      setAnimating(true)\n      const timer = setTimeout(() => {\n        setAnimating(false)\n        setPrevCount(count)\n      }, 400)\n      return () => clearTimeout(timer)\n    }\n  }, [count, prevCount])\n\n  return (\n    <span\n      className={`count-badge count-badge-${variant} count-badge-${size} ${pulse ? 'badge-new' : ''} ${animating ? 'animate-count-up' : ''}`}\n      title={label}\n    >\n      {Icon && <Icon size={size === 'small' ? 12 : size === 'large' ? 18 : 14} />}\n      <span className=\"count-badge-value\">{count}</span>\n      {label && <span className=\"count-badge-label\">{label}</span>}\n    </span>\n  )\n})\n\n// Mini progress bar for inline usage\nexport const MiniProgress = memo(function MiniProgress({\n  value,\n  max = 100,\n  showLabel = false,\n  size = 'medium', // 'small' | 'medium' | 'large'\n  variant = 'default', // 'default' | 'success' | 'warning' | 'danger'\n  animated = true\n}) {\n  const percentage = Math.min(100, Math.max(0, (value / max) * 100))\n  const height = size === 'small' ? '4px' : size === 'large' ? '8px' : '6px'\n\n  // Auto-determine variant based on percentage if not specified\n  const autoVariant = variant === 'default'\n    ? percentage >= 80 ? 'danger' : percentage >= 60 ? 'warning' : 'success'\n    : variant\n\n  return (\n    <div className={`mini-progress mini-progress-${size}`}>\n      <div className=\"mini-progress-track\" style={{ height }}>\n        <div\n          className={`mini-progress-fill mini-progress-${autoVariant} ${animated ? 'progress-animate' : ''}`}\n          style={{ width: `${percentage}%` }}\n        />\n      </div>\n      {showLabel && (\n        <span className=\"mini-progress-label\">{Math.round(percentage)}%</span>\n      )}\n    </div>\n  )\n})\n\n// Trend indicator with direction and value\nexport const TrendIndicator = memo(function TrendIndicator({\n  value,\n  previousValue,\n  format = 'percent', // 'percent' | 'number' | 'currency'\n  inverted = false, // If true, down is good (e.g., costs)\n  showValue = true\n}) {\n  const diff = value - previousValue\n  const percentChange = previousValue !== 0 ? ((diff / previousValue) * 100) : 0\n\n  let direction = diff === 0 ? 'neutral' : diff > 0 ? 'up' : 'down'\n  let status = 'neutral'\n\n  if (diff !== 0) {\n    if (inverted) {\n      status = diff > 0 ? 'negative' : 'positive'\n    } else {\n      status = diff > 0 ? 'positive' : 'negative'\n    }\n  }\n\n  const Icon = direction === 'up' ? TrendingUp : direction === 'down' ? TrendingDown : Minus\n\n  const formatValue = () => {\n    const absChange = Math.abs(diff)\n    switch (format) {\n      case 'percent':\n        return `${Math.abs(percentChange).toFixed(1)}%`\n      case 'currency':\n        return new Intl.NumberFormat('en-US', {\n          style: 'currency',\n          currency: 'USD',\n          minimumFractionDigits: 0,\n          maximumFractionDigits: 0\n        }).format(absChange)\n      default:\n        return absChange.toLocaleString()\n    }\n  }\n\n  return (\n    <span className={`trend-indicator trend-${status}`}>\n      <Icon size={14} />\n      {showValue && <span className=\"trend-value\">{formatValue()}</span>}\n    </span>\n  )\n})\n\n// Status dot with optional label\nexport const StatusDot = memo(function StatusDot({\n  status = 'default', // 'default' | 'success' | 'warning' | 'danger' | 'info'\n  label,\n  size = 'medium', // 'small' | 'medium' | 'large'\n  pulse = false\n}) {\n  return (\n    <span className={`status-dot-container status-dot-${size}`}>\n      <span className={`status-dot status-dot-${status} ${pulse ? 'status-dot-pulse' : ''}`} />\n      {label && <span className=\"status-dot-label\">{label}</span>}\n    </span>\n  )\n})\n\n// Sparkline - mini line chart\nexport const Sparkline = memo(function Sparkline({\n  data = [],\n  width = 80,\n  height = 24,\n  strokeWidth = 2,\n  color = 'var(--accent-blue)',\n  showArea = true\n}) {\n  if (!data.length) return null\n\n  const max = Math.max(...data)\n  const min = Math.min(...data)\n  const range = max - min || 1\n\n  const points = data.map((value, index) => {\n    const x = (index / (data.length - 1)) * width\n    const y = height - ((value - min) / range) * (height - strokeWidth * 2) - strokeWidth\n    return `${x},${y}`\n  }).join(' ')\n\n  const areaPoints = `0,${height} ${points} ${width},${height}`\n\n  return (\n    <svg\n      width={width}\n      height={height}\n      className=\"sparkline\"\n      viewBox={`0 0 ${width} ${height}`}\n    >\n      {showArea && (\n        <polygon\n          points={areaPoints}\n          fill={color}\n          fillOpacity=\"0.15\"\n        />\n      )}\n      <polyline\n        points={points}\n        fill=\"none\"\n        stroke={color}\n        strokeWidth={strokeWidth}\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n    </svg>\n  )\n})\n\n// Quick stats row (e.g., \"3 workers  2.5 hrs  $450\")\nexport const QuickStats = memo(function QuickStats({ items = [] }) {\n  return (\n    <div className=\"quick-stats\">\n      {items.map((item, index) => (\n        <span key={index} className=\"quick-stat-item\">\n          {item.icon && <item.icon size={12} />}\n          <span className=\"quick-stat-value\">{item.value}</span>\n          {item.label && <span className=\"quick-stat-label\">{item.label}</span>}\n        </span>\n      ))}\n    </div>\n  )\n})\n\n// Status indicator with icon\nexport const StatusIndicator = memo(function StatusIndicator({\n  status, // 'success' | 'warning' | 'danger' | 'info' | 'pending'\n  label,\n  size = 'medium'\n}) {\n  const icons = {\n    success: Check,\n    warning: AlertTriangle,\n    danger: AlertTriangle,\n    info: Clock,\n    pending: Clock\n  }\n\n  const Icon = icons[status] || icons.info\n\n  return (\n    <span className={`status-indicator status-indicator-${status} status-indicator-${size}`}>\n      <Icon size={size === 'small' ? 12 : size === 'large' ? 18 : 14} />\n      {label && <span className=\"status-indicator-label\">{label}</span>}\n    </span>\n  )\n})\n\n// Metric delta (change from previous)\nexport const MetricDelta = memo(function MetricDelta({\n  current,\n  previous,\n  format = 'number', // 'number' | 'currency' | 'percent'\n  label,\n  inverted = false\n}) {\n  const delta = current - previous\n  const isPositive = inverted ? delta < 0 : delta > 0\n  const isNegative = inverted ? delta > 0 : delta < 0\n\n  const formatValue = (val) => {\n    switch (format) {\n      case 'currency':\n        return new Intl.NumberFormat('en-US', {\n          style: 'currency',\n          currency: 'USD',\n          minimumFractionDigits: 0\n        }).format(Math.abs(val))\n      case 'percent':\n        return `${Math.abs(val).toFixed(1)}%`\n      default:\n        return Math.abs(val).toLocaleString()\n    }\n  }\n\n  return (\n    <div className={`metric-delta ${isPositive ? 'positive' : isNegative ? 'negative' : 'neutral'}`}>\n      <span className=\"metric-delta-arrow\">\n        {delta > 0 ? '' : delta < 0 ? '' : ''}\n      </span>\n      <span className=\"metric-delta-value\">{formatValue(delta)}</span>\n      {label && <span className=\"metric-delta-label\">{label}</span>}\n    </div>\n  )\n})\n\n// Circular progress (donut style)\nexport const CircularProgress = memo(function CircularProgress({\n  value,\n  max = 100,\n  size = 40,\n  strokeWidth = 4,\n  showValue = true,\n  color = 'var(--accent-blue)'\n}) {\n  const percentage = Math.min(100, Math.max(0, (value / max) * 100))\n  const radius = (size - strokeWidth) / 2\n  const circumference = radius * 2 * Math.PI\n  const offset = circumference - (percentage / 100) * circumference\n\n  return (\n    <div className=\"circular-progress\" style={{ width: size, height: size }}>\n      <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`}>\n        <circle\n          className=\"circular-progress-track\"\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          fill=\"none\"\n          strokeWidth={strokeWidth}\n        />\n        <circle\n          className=\"circular-progress-fill\"\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          fill=\"none\"\n          stroke={color}\n          strokeWidth={strokeWidth}\n          strokeDasharray={circumference}\n          strokeDashoffset={offset}\n          strokeLinecap=\"round\"\n          transform={`rotate(-90 ${size / 2} ${size / 2})`}\n          style={{ transition: 'stroke-dashoffset 0.5s ease' }}\n        />\n      </svg>\n      {showValue && (\n        <span className=\"circular-progress-value\">\n          {Math.round(percentage)}%\n        </span>\n      )}\n    </div>\n  )\n})\n\nexport default {\n  CountBadge,\n  MiniProgress,\n  TrendIndicator,\n  StatusDot,\n  Sparkline,\n  QuickStats,\n  StatusIndicator,\n  MetricDelta,\n  CircularProgress\n}\n","import { useEffect, useRef, useCallback, memo } from 'react'\nimport { X } from 'lucide-react'\n\n/**\n * Accessible Modal Component\n *\n * Features:\n * - Proper ARIA attributes (role=\"dialog\", aria-modal, aria-labelledby)\n * - Focus trap within modal\n * - Escape key to close\n * - Click outside to close\n * - Focus restoration on close\n *\n * Usage:\n *   <Modal\n *     isOpen={showModal}\n *     onClose={() => setShowModal(false)}\n *     title=\"Modal Title\"\n *     size=\"medium\"\n *   >\n *     <p>Modal content here</p>\n *   </Modal>\n */\nconst Modal = memo(function Modal({\n  isOpen,\n  onClose,\n  title,\n  children,\n  size = 'medium', // 'small' | 'medium' | 'large' | 'full'\n  className = '',\n  showCloseButton = true,\n  closeOnOverlayClick = true,\n  closeOnEscape = true,\n  footer,\n  ariaDescribedBy\n}) {\n  const modalRef = useRef(null)\n  const previousActiveElement = useRef(null)\n  const titleId = useRef(`modal-title-${Math.random().toString(36).substr(2, 9)}`)\n\n  // Store the previously focused element and focus the modal when it opens\n  useEffect(() => {\n    if (isOpen) {\n      previousActiveElement.current = document.activeElement\n      // Focus the modal container after a brief delay to ensure it's rendered\n      const timer = setTimeout(() => {\n        modalRef.current?.focus()\n      }, 10)\n      return () => clearTimeout(timer)\n    }\n  }, [isOpen])\n\n  // Restore focus when modal closes\n  useEffect(() => {\n    if (!isOpen && previousActiveElement.current) {\n      previousActiveElement.current.focus()\n    }\n  }, [isOpen])\n\n  // Handle escape key\n  useEffect(() => {\n    if (!isOpen || !closeOnEscape) return\n\n    const handleKeyDown = (e) => {\n      if (e.key === 'Escape') {\n        e.preventDefault()\n        onClose()\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyDown)\n    return () => document.removeEventListener('keydown', handleKeyDown)\n  }, [isOpen, closeOnEscape, onClose])\n\n  // Prevent body scroll when modal is open\n  useEffect(() => {\n    if (isOpen) {\n      const originalOverflow = document.body.style.overflow\n      document.body.style.overflow = 'hidden'\n      return () => {\n        document.body.style.overflow = originalOverflow\n      }\n    }\n  }, [isOpen])\n\n  // Focus trap\n  const handleKeyDown = useCallback((e) => {\n    if (e.key !== 'Tab') return\n\n    const focusableElements = modalRef.current?.querySelectorAll(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    )\n\n    if (!focusableElements || focusableElements.length === 0) return\n\n    const firstElement = focusableElements[0]\n    const lastElement = focusableElements[focusableElements.length - 1]\n\n    if (e.shiftKey) {\n      if (document.activeElement === firstElement) {\n        e.preventDefault()\n        lastElement.focus()\n      }\n    } else {\n      if (document.activeElement === lastElement) {\n        e.preventDefault()\n        firstElement.focus()\n      }\n    }\n  }, [])\n\n  const handleOverlayClick = (e) => {\n    if (closeOnOverlayClick && e.target === e.currentTarget) {\n      onClose()\n    }\n  }\n\n  if (!isOpen) return null\n\n  const sizeClasses = {\n    small: 'modal-small',\n    medium: 'modal-medium',\n    large: 'modal-large',\n    full: 'modal-full'\n  }\n\n  return (\n    <div\n      className=\"modal-overlay\"\n      onClick={handleOverlayClick}\n      role=\"presentation\"\n    >\n      <div\n        ref={modalRef}\n        className={`modal-content ${sizeClasses[size] || ''} ${className}`}\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby={title ? titleId.current : undefined}\n        aria-describedby={ariaDescribedBy}\n        tabIndex={-1}\n        onKeyDown={handleKeyDown}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {title && (\n          <div className=\"modal-header\">\n            <h2 id={titleId.current}>{title}</h2>\n            {showCloseButton && (\n              <button\n                className=\"close-btn\"\n                onClick={onClose}\n                aria-label=\"Close modal\"\n                type=\"button\"\n              >\n                <X size={20} />\n              </button>\n            )}\n          </div>\n        )}\n\n        <div className=\"modal-body\">\n          {children}\n        </div>\n\n        {footer && (\n          <div className=\"modal-footer\">\n            {footer}\n          </div>\n        )}\n      </div>\n    </div>\n  )\n})\n\nexport default Modal\n","import { memo, useMemo } from 'react'\nimport { DollarSign, TrendingUp, Receipt, PiggyBank } from 'lucide-react'\nimport { HeroMetricsSkeleton, MiniProgress, TrendIndicator } from './ui'\n\n/**\n * HeroMetrics - Top-level financial summary for project dashboard\n * Designed for instant comprehension of project financial health\n */\n\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount || 0)\n}\n\nconst MetricCard = memo(function MetricCard({\n  icon: Icon,\n  label,\n  value,\n  formattedValue,\n  subLabel,\n  progress,\n  progressLabel,\n  variant = 'default', // 'default' | 'success' | 'warning' | 'danger'\n  trend,\n  previousValue\n}) {\n  const variantColors = {\n    default: 'var(--accent-blue)',\n    success: 'var(--accent-green)',\n    warning: 'var(--accent-amber)',\n    danger: 'var(--accent-red)'\n  }\n\n  return (\n    <div className={`hero-metric-card hover-lift animate-fade-in-up`}>\n      <div className=\"hero-metric-header\">\n        <div className=\"hero-metric-icon\" style={{ color: variantColors[variant] }}>\n          <Icon size={18} />\n        </div>\n        <span className=\"hero-metric-label\">{label}</span>\n      </div>\n\n      <div className=\"hero-metric-value-row\">\n        <span className={`hero-metric-value hero-metric-${variant}`}>\n          {formattedValue}\n        </span>\n        {trend !== undefined && previousValue !== undefined && (\n          <TrendIndicator\n            value={value}\n            previousValue={previousValue}\n            format=\"currency\"\n            inverted={label.toLowerCase().includes('cost')}\n          />\n        )}\n      </div>\n\n      {subLabel && (\n        <span className=\"hero-metric-sublabel\">{subLabel}</span>\n      )}\n\n      {progress !== undefined && (\n        <div className=\"hero-metric-progress\">\n          <MiniProgress\n            value={progress}\n            max={100}\n            size=\"small\"\n            variant={variant}\n            showLabel\n          />\n          {progressLabel && (\n            <span className=\"hero-metric-progress-label\">{progressLabel}</span>\n          )}\n        </div>\n      )}\n    </div>\n  )\n})\n\nexport default memo(function HeroMetrics({\n  contractValue = 0,\n  earnedRevenue = 0,\n  totalCosts = 0,\n  profit = 0,\n  progress = 0,\n  corApprovedValue = 0,\n  loading = false,\n  previousData // Optional: for trend indicators\n}) {\n  // Calculate derived values\n  const revisedContract = contractValue + corApprovedValue\n  const profitMargin = earnedRevenue > 0 ? ((profit / earnedRevenue) * 100) : 0\n  const costRatio = earnedRevenue > 0 ? ((totalCosts / earnedRevenue) * 100) : 0\n  const revenueProgress = revisedContract > 0 ? ((earnedRevenue / revisedContract) * 100) : 0\n  const costProgress = revisedContract > 0 ? ((totalCosts / revisedContract) * 100) : 0\n\n  // Determine profit status\n  const profitVariant = useMemo(() => {\n    if (profitMargin >= 20) return 'success'\n    if (profitMargin >= 10) return 'warning'\n    if (profitMargin < 0) return 'danger'\n    return 'default'\n  }, [profitMargin])\n\n  // Determine cost status\n  const costVariant = useMemo(() => {\n    if (costRatio <= 60) return 'success'\n    if (costRatio <= 80) return 'warning'\n    return 'danger'\n  }, [costRatio])\n\n  if (loading) {\n    return <HeroMetricsSkeleton />\n  }\n\n  return (\n    <div className=\"hero-metrics stagger-children\">\n      {/* Contract Value */}\n      <MetricCard\n        icon={DollarSign}\n        label=\"Contract Value\"\n        value={revisedContract}\n        formattedValue={formatCurrency(revisedContract)}\n        subLabel={corApprovedValue > 0 ? `+${formatCurrency(corApprovedValue)} CORs` : null}\n        variant=\"default\"\n      />\n\n      {/* Earned Revenue */}\n      <MetricCard\n        icon={TrendingUp}\n        label=\"Earned Revenue\"\n        value={earnedRevenue}\n        formattedValue={formatCurrency(earnedRevenue)}\n        progress={revenueProgress}\n        progressLabel={`${Math.round(revenueProgress)}% of contract`}\n        variant=\"success\"\n        previousValue={previousData?.earnedRevenue}\n        trend={previousData ? earnedRevenue : undefined}\n      />\n\n      {/* Total Costs */}\n      <MetricCard\n        icon={Receipt}\n        label=\"Total Costs\"\n        value={totalCosts}\n        formattedValue={formatCurrency(totalCosts)}\n        progress={costProgress}\n        progressLabel={`${Math.round(costRatio)}% of revenue`}\n        variant={costVariant}\n        previousValue={previousData?.totalCosts}\n        trend={previousData ? totalCosts : undefined}\n      />\n\n      {/* Profit */}\n      <MetricCard\n        icon={PiggyBank}\n        label=\"Profit\"\n        value={profit}\n        formattedValue={formatCurrency(profit)}\n        subLabel={`${profitMargin >= 0 ? '+' : ''}${profitMargin.toFixed(1)}% margin`}\n        variant={profitVariant}\n        previousValue={previousData?.profit}\n        trend={previousData ? profit : undefined}\n      />\n    </div>\n  )\n})\n","import { memo } from 'react'\nimport { BarChart3, FileText, ClipboardList, Receipt, ChevronRight, ChevronLeft, PanelLeftOpen, X } from 'lucide-react'\nimport { CountBadge } from './ui'\n\n/**\n * FinancialsNav - Collapsible sidebar navigation for Financials tab\n *\n * Design principles:\n * - Workflow order: Overview  CORs  T&M (reflects natural process)\n * - Collapsible to maximize content real estate\n * - Clear visual hierarchy with active states\n * - Badges show pending items requiring attention\n */\n\nconst NAV_ITEMS = [\n  {\n    id: 'overview',\n    label: 'Overview',\n    shortLabel: 'Overview',\n    icon: BarChart3,\n    description: 'Metrics & trends',\n    step: null\n  },\n  {\n    id: 'cors',\n    label: 'Change Orders',\n    shortLabel: 'CORs',\n    icon: FileText,\n    description: 'CORs & approvals',\n    step: 1\n  },\n  {\n    id: 'tickets',\n    label: 'T&M Tickets',\n    shortLabel: 'Tickets',\n    icon: ClipboardList,\n    description: 'Field data',\n    step: 2\n  },\n  {\n    id: 'billing',\n    label: 'Billing',\n    shortLabel: 'Billing',\n    icon: Receipt,\n    description: 'Invoices & billing',\n    step: 3\n  }\n]\n\nexport default memo(function FinancialsNav({\n  activeSection = 'overview',\n  onSectionChange,\n  collapsed = false,\n  onToggleCollapse,\n  onMobileClose,\n  stats = {}\n}) {\n  const {\n    corCount = 0,\n    ticketCount = 0,\n    corPending = 0,\n    ticketPending = 0,\n    billableCount = 0,\n    invoiceCount = 0\n  } = stats\n\n  // Get badge config for each section\n  const getBadge = (itemId) => {\n    if (itemId === 'cors' && corCount > 0) {\n      return {\n        count: corCount,\n        variant: corPending > 0 ? 'warning' : 'default',\n        pending: corPending\n      }\n    }\n    if (itemId === 'tickets' && ticketCount > 0) {\n      return {\n        count: ticketCount,\n        variant: ticketPending > 0 ? 'warning' : 'default',\n        pending: ticketPending\n      }\n    }\n    if (itemId === 'billing' && billableCount > 0) {\n      return {\n        count: billableCount,\n        variant: 'success', // Green to indicate money ready to collect\n        pending: billableCount\n      }\n    }\n    return null\n  }\n\n  return (\n    <nav\n      className={`financials-nav ${collapsed ? 'collapsed' : ''}`}\n      aria-label=\"Financials sections\"\n    >\n      {/* Mobile Header with Close Button */}\n      {onMobileClose && (\n        <div className=\"financials-nav-mobile-header\">\n          <span className=\"financials-nav-mobile-title\">Financials</span>\n          <button\n            className=\"financials-nav-mobile-close\"\n            onClick={onMobileClose}\n            aria-label=\"Close menu\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n      )}\n\n      {/* Collapse Toggle - hidden on mobile */}\n      <button\n        className=\"financials-nav-toggle\"\n        onClick={onToggleCollapse}\n        aria-label={collapsed ? 'Expand sidebar' : 'Collapse sidebar'}\n        title={collapsed ? 'Expand sidebar' : 'Collapse sidebar'}\n      >\n        {collapsed ? (\n          <PanelLeftOpen size={18} />\n        ) : (\n          <ChevronLeft size={18} />\n        )}\n        {!collapsed && <span>Collapse</span>}\n      </button>\n\n      {/* Navigation Items */}\n      <div className=\"financials-nav-items\">\n        {NAV_ITEMS.map((item, index) => {\n          const isActive = activeSection === item.id\n          const Icon = item.icon\n          const badge = getBadge(item.id)\n          const showConnector = index < NAV_ITEMS.length - 1 && item.step !== null\n\n          return (\n            <div key={item.id} className=\"financials-nav-item-wrapper\">\n              <button\n                className={`financials-nav-item ${isActive ? 'active' : ''}`}\n                onClick={() => onSectionChange?.(item.id)}\n                aria-current={isActive ? 'page' : undefined}\n                title={`${item.label}${badge ? ` (${badge.count})` : ''}`}\n              >\n                {/* Step indicator for workflow items - only in expanded mode */}\n                {item.step && !collapsed && (\n                  <span className=\"financials-nav-step\">{item.step}</span>\n                )}\n\n                {/* Icon with optional badge dot */}\n                <div className=\"financials-nav-icon\">\n                  <Icon size={collapsed ? 22 : 20} />\n                  {/* Badge dot for pending items */}\n                  {badge && badge.pending > 0 && (\n                    <span className=\"financials-nav-dot\" />\n                  )}\n                </div>\n\n                {/* Collapsed mode: show short label below icon */}\n                {collapsed && (\n                  <span className=\"financials-nav-short-label\">{item.shortLabel}</span>\n                )}\n\n                {/* Expanded mode: show full content */}\n                {!collapsed && (\n                  <>\n                    <div className=\"financials-nav-content\">\n                      <span className=\"financials-nav-label\">{item.label}</span>\n                      <span className=\"financials-nav-desc\">{item.description}</span>\n                    </div>\n\n                    {/* Badge */}\n                    {badge && (\n                      <CountBadge\n                        count={badge.count}\n                        size=\"small\"\n                        variant={badge.variant}\n                      />\n                    )}\n\n                    {/* Arrow */}\n                    <ChevronRight size={16} className=\"financials-nav-arrow\" />\n                  </>\n                )}\n              </button>\n\n              {/* Workflow connector line */}\n              {showConnector && !collapsed && (\n                <div className=\"financials-nav-connector\">\n                  <div className=\"connector-line\" />\n                </div>\n              )}\n            </div>\n          )\n        })}\n      </div>\n\n      {/* Toggle label when collapsed */}\n      {collapsed && (\n        <button\n          className=\"financials-nav-expand-btn\"\n          onClick={onToggleCollapse}\n          aria-label=\"Expand sidebar\"\n        >\n          <ChevronRight size={14} />\n          <span>Expand</span>\n        </button>\n      )}\n    </nav>\n  )\n})\n","import { memo, useEffect, useState, useRef } from 'react'\n\n/**\n * OverviewProgressGauge - Large circular progress indicator for project overview\n * Shows completion percentage with animated stroke and areas status\n */\nexport const OverviewProgressGauge = memo(function OverviewProgressGauge({\n  progress = 0,\n  areasComplete = 0,\n  totalAreas = 0,\n  areasWorking = 0,\n  size = 110,\n  strokeWidth = 9\n}) {\n  const [animatedProgress, setAnimatedProgress] = useState(0)\n  const animationRef = useRef(null)\n\n  // Animate progress on mount/change\n  useEffect(() => {\n    const startValue = animatedProgress\n    const endValue = Math.min(100, Math.max(0, progress))\n    const duration = 800\n    const startTime = performance.now()\n\n    const animate = (currentTime) => {\n      const elapsed = currentTime - startTime\n      const progressRatio = Math.min(elapsed / duration, 1)\n\n      // Ease out cubic\n      const eased = 1 - Math.pow(1 - progressRatio, 3)\n      const current = startValue + (endValue - startValue) * eased\n\n      setAnimatedProgress(current)\n\n      if (progressRatio < 1) {\n        animationRef.current = requestAnimationFrame(animate)\n      }\n    }\n\n    animationRef.current = requestAnimationFrame(animate)\n\n    return () => {\n      if (animationRef.current) {\n        cancelAnimationFrame(animationRef.current)\n      }\n    }\n  }, [progress])\n\n  const radius = (size - strokeWidth) / 2\n  const circumference = radius * 2 * Math.PI\n  const offset = circumference - (animatedProgress / 100) * circumference\n\n  // Color based on progress\n  const getProgressColor = () => {\n    if (animatedProgress >= 80) return 'var(--accent-green)'\n    if (animatedProgress >= 50) return 'var(--accent-blue)'\n    if (animatedProgress >= 25) return 'var(--accent-blue)'\n    return 'var(--text-muted)'\n  }\n\n  return (\n    <div className=\"overview-progress-gauge\">\n      <div className=\"progress-gauge-circle\" style={{ width: size, height: size }}>\n        <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`}>\n          {/* Background track */}\n          <circle\n            className=\"gauge-track\"\n            cx={size / 2}\n            cy={size / 2}\n            r={radius}\n            fill=\"none\"\n            strokeWidth={strokeWidth}\n            stroke=\"var(--bg-tertiary)\"\n          />\n          {/* Progress arc */}\n          <circle\n            className=\"gauge-fill\"\n            cx={size / 2}\n            cy={size / 2}\n            r={radius}\n            fill=\"none\"\n            stroke={getProgressColor()}\n            strokeWidth={strokeWidth}\n            strokeDasharray={circumference}\n            strokeDashoffset={offset}\n            strokeLinecap=\"round\"\n            transform={`rotate(-90 ${size / 2} ${size / 2})`}\n            style={{ transition: 'stroke 0.3s ease' }}\n          />\n        </svg>\n        {/* Center content */}\n        <div className=\"gauge-center\">\n          <span className=\"gauge-value\">{Math.round(animatedProgress)}%</span>\n          <span className=\"gauge-label\">Complete</span>\n        </div>\n      </div>\n\n      {/* Areas status below */}\n      <div className=\"gauge-areas-status\">\n        <span className=\"areas-count\">\n          <strong>{areasComplete}</strong>/{totalAreas} Areas Done\n        </span>\n        {areasWorking > 0 && (\n          <span className=\"areas-active\">{areasWorking} active</span>\n        )}\n      </div>\n    </div>\n  )\n})\n\nexport default OverviewProgressGauge\n","import { memo, useEffect, useState, useRef } from 'react'\nimport { TrendingUp, TrendingDown, Minus } from 'lucide-react'\nimport { chartColors } from '../charts/chartConfig'\n\n/**\n * OverviewFinancialCard - Compact financial snapshot for project overview\n * Shows earned, costs, profit with mini cost breakdown bar\n */\nexport const OverviewFinancialCard = memo(function OverviewFinancialCard({\n  earnedRevenue = 0,\n  totalCosts = 0,\n  laborCost = 0,\n  disposalCost = 0,\n  equipmentCost = 0,\n  materialsCost = 0,\n  otherCost = 0,\n  contractValue = 0\n}) {\n  const profit = earnedRevenue - totalCosts\n  const margin = earnedRevenue > 0 ? (profit / earnedRevenue) * 100 : 0\n  const isPositive = profit >= 0\n\n  // Format currency\n  const formatCurrency = (value) => {\n    if (value >= 1000000) {\n      return `$${(value / 1000000).toFixed(1)}M`\n    }\n    if (value >= 1000) {\n      return `$${(value / 1000).toFixed(1)}K`\n    }\n    return `$${value.toFixed(0)}`\n  }\n\n  // Calculate cost breakdown percentages for the stacked bar\n  const costBreakdown = [\n    { key: 'labor', value: laborCost, color: chartColors.labor, label: 'Labor' },\n    { key: 'disposal', value: disposalCost, color: chartColors.disposal, label: 'Disposal' },\n    { key: 'equipment', value: equipmentCost, color: chartColors.equipment, label: 'Equipment' },\n    { key: 'materials', value: materialsCost, color: chartColors.materials, label: 'Materials' },\n    { key: 'other', value: otherCost, color: chartColors.other, label: 'Other' }\n  ].filter(item => item.value > 0)\n\n  const hasBreakdown = costBreakdown.length > 0 && totalCosts > 0\n\n  return (\n    <div className=\"overview-financial-card animate-fade-in-up\">\n      {/* Main metrics row */}\n      <div className=\"financial-metrics-row\">\n        {/* Earned */}\n        <div className=\"financial-metric\">\n          <span className=\"financial-metric-value green\">{formatCurrency(earnedRevenue)}</span>\n          <span className=\"financial-metric-label\">Earned</span>\n        </div>\n\n        {/* Costs */}\n        <div className=\"financial-metric\">\n          <span className=\"financial-metric-value amber\">{formatCurrency(totalCosts)}</span>\n          <span className=\"financial-metric-label\">Costs</span>\n        </div>\n\n        {/* Profit */}\n        <div className=\"financial-metric\">\n          <span className={`financial-metric-value ${isPositive ? 'green' : 'red'}`}>\n            {isPositive ? '' : '-'}{formatCurrency(Math.abs(profit))}\n          </span>\n          <span className=\"financial-metric-label\">\n            Profit\n            <span className={`margin-badge ${isPositive ? 'positive' : 'negative'}`}>\n              {margin >= 0 ? '+' : ''}{margin.toFixed(0)}%\n            </span>\n          </span>\n        </div>\n      </div>\n\n      {/* Cost breakdown bar */}\n      {hasBreakdown && (\n        <div className=\"cost-breakdown-section\">\n          <div className=\"cost-breakdown-bar\">\n            {costBreakdown.map((item, index) => {\n              const widthPercent = (item.value / totalCosts) * 100\n              return (\n                <div\n                  key={item.key}\n                  className=\"cost-segment\"\n                  style={{\n                    width: `${widthPercent}%`,\n                    backgroundColor: item.color,\n                    animationDelay: `${index * 100}ms`\n                  }}\n                  title={`${item.label}: ${formatCurrency(item.value)} (${widthPercent.toFixed(0)}%)`}\n                />\n              )\n            })}\n          </div>\n          <div className=\"cost-breakdown-legend\">\n            {costBreakdown.slice(0, 4).map(item => (\n              <span key={item.key} className=\"legend-item\">\n                <span className=\"legend-dot\" style={{ backgroundColor: item.color }} />\n                <span className=\"legend-label\">{item.label}</span>\n              </span>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  )\n})\n\nexport default OverviewFinancialCard\n","import { memo, useState, useEffect, useMemo, useCallback } from 'react'\nimport { Users, HardHat, Wrench, Calendar, Download, ChevronLeft, ChevronRight } from 'lucide-react'\nimport {\n  BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer\n} from 'recharts'\nimport { db } from '../../lib/supabase'\nimport { chartColors, tooltipStyle, formatChartDate } from '../charts/chartConfig'\n\n/**\n * OverviewCrewMetrics - Crew on-site metrics for project overview\n * Shows total crew count, contract vs T&M worker breakdown by day\n * Includes a day-by-day stacked bar chart timeline\n */\n\nconst loadJsPDF = () => import('jspdf')\n\n// Colors for contract vs T&M\nconst CREW_COLORS = {\n  contract: chartColors.contract,  // Blue\n  tm: chartColors.costs,           // Amber\n  total: chartColors.labor         // Indigo\n}\n\nconst TIME_RANGES = [\n  { id: '7d', label: '7D', days: 7 },\n  { id: '14d', label: '14D', days: 14 },\n  { id: '30d', label: '30D', days: 30 },\n]\n\nexport const OverviewCrewMetrics = memo(function OverviewCrewMetrics({\n  project,\n  onShowToast\n}) {\n  const [crewHistory, setCrewHistory] = useState([])\n  const [tmTickets, setTmTickets] = useState([])\n  const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0])\n  const [timeRange, setTimeRange] = useState('14d')\n  const [loading, setLoading] = useState(true)\n  const [exporting, setExporting] = useState(false)\n\n  // Load all crew check-in history and T&M tickets\n  useEffect(() => {\n    if (!project?.id) return\n    loadData()\n  }, [project?.id])\n\n  const loadData = async () => {\n    setLoading(true)\n    try {\n      const [history, tickets] = await Promise.all([\n        db.getCrewCheckinHistory(project.id, 365),\n        db.getTMTickets(project.id)\n      ])\n      setCrewHistory(history || [])\n      setTmTickets(tickets || [])\n    } catch (error) {\n      console.error('Error loading crew metrics:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // Build a lookup: date -> Set of T&M worker names\n  const tmWorkersByDate = useMemo(() => {\n    const map = {}\n    tmTickets.forEach(ticket => {\n      const date = ticket.work_date\n      if (!date) return\n      if (!map[date]) map[date] = new Set()\n      ;(ticket.t_and_m_workers || []).forEach(w => {\n        map[date].add(w.name.toLowerCase().trim())\n      })\n    })\n    return map\n  }, [tmTickets])\n\n  // Build crew lookup: date -> workers array\n  const crewByDate = useMemo(() => {\n    const map = {}\n    crewHistory.forEach(checkin => {\n      map[checkin.check_in_date] = checkin.workers || []\n    })\n    return map\n  }, [crewHistory])\n\n  // Selected date metrics\n  const selectedDayWorkers = crewByDate[selectedDate] || []\n  const selectedDayTmNames = tmWorkersByDate[selectedDate] || new Set()\n\n  const todayMetrics = useMemo(() => {\n    const contract = []\n    const tm = []\n    selectedDayWorkers.forEach(w => {\n      if (selectedDayTmNames.has(w.name.toLowerCase().trim())) {\n        tm.push(w)\n      } else {\n        contract.push(w)\n      }\n    })\n    return { total: selectedDayWorkers.length, contract, tm }\n  }, [selectedDayWorkers, selectedDayTmNames])\n\n  // Build chart data for time range\n  const chartData = useMemo(() => {\n    const rangeDays = TIME_RANGES.find(r => r.id === timeRange)?.days || 14\n    const data = []\n    const today = new Date()\n\n    for (let i = rangeDays - 1; i >= 0; i--) {\n      const d = new Date(today)\n      d.setDate(d.getDate() - i)\n      const dateStr = d.toISOString().split('T')[0]\n\n      const workers = crewByDate[dateStr] || []\n      const tmNames = tmWorkersByDate[dateStr] || new Set()\n\n      let contractCount = 0\n      let tmCount = 0\n      workers.forEach(w => {\n        if (tmNames.has(w.name.toLowerCase().trim())) {\n          tmCount++\n        } else {\n          contractCount++\n        }\n      })\n\n      data.push({\n        date: dateStr,\n        displayDate: formatChartDate(dateStr),\n        contract: contractCount,\n        tm: tmCount,\n        total: workers.length\n      })\n    }\n\n    return data\n  }, [crewByDate, tmWorkersByDate, timeRange])\n\n  // Navigate dates\n  const changeDate = useCallback((direction) => {\n    const d = new Date(selectedDate + 'T12:00:00')\n    d.setDate(d.getDate() + direction)\n    setSelectedDate(d.toISOString().split('T')[0])\n  }, [selectedDate])\n\n  const isToday = selectedDate === new Date().toISOString().split('T')[0]\n\n  const formatDate = (dateStr) => {\n    const d = new Date(dateStr + 'T12:00:00')\n    return d.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })\n  }\n\n  // Click a bar in the chart to select that date\n  const handleBarClick = useCallback((data) => {\n    if (data?.date) {\n      setSelectedDate(data.date)\n    }\n  }, [])\n\n  // Custom tooltip for the chart\n  const CustomTooltip = ({ active, payload, label }) => {\n    if (!active || !payload?.length) return null\n    const total = (payload[0]?.value || 0) + (payload[1]?.value || 0)\n    return (\n      <div style={{\n        ...tooltipStyle.contentStyle,\n        fontSize: '0.8rem'\n      }}>\n        <p style={{ ...tooltipStyle.labelStyle, fontSize: '0.85rem', marginBottom: 6 }}>{label}</p>\n        <p style={{ margin: '3px 0', color: CREW_COLORS.contract }}>\n          Contract: <strong>{payload[0]?.value || 0}</strong>\n        </p>\n        <p style={{ margin: '3px 0', color: CREW_COLORS.tm }}>\n          T&M: <strong>{payload[1]?.value || 0}</strong>\n        </p>\n        <p style={{ margin: '3px 0', color: 'var(--text-primary)', borderTop: '1px solid var(--border-color)', paddingTop: 4 }}>\n          Total: <strong>{total}</strong>\n        </p>\n      </div>\n    )\n  }\n\n  // PDF Export\n  const exportCrewPDF = useCallback(async () => {\n    setExporting(true)\n    onShowToast?.('Generating crew report PDF...', 'info')\n\n    try {\n      const jsPDFModule = await loadJsPDF()\n      const jsPDF = jsPDFModule.default\n      const doc = new jsPDF()\n\n      const pageWidth = doc.internal.pageSize.width\n      let y = 20\n\n      // Header\n      doc.setFontSize(18)\n      doc.setFont(undefined, 'bold')\n      doc.text('Crew On-Site Report', pageWidth / 2, y, { align: 'center' })\n      y += 8\n\n      doc.setFontSize(11)\n      doc.setFont(undefined, 'normal')\n      doc.text(`Project: ${project.name}`, pageWidth / 2, y, { align: 'center' })\n      y += 6\n      doc.text(`Date: ${formatDate(selectedDate)}`, pageWidth / 2, y, { align: 'center' })\n      y += 12\n\n      // Summary stats\n      doc.setFontSize(12)\n      doc.setFont(undefined, 'bold')\n      doc.text('Selected Day Summary', 14, y)\n      y += 7\n\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'normal')\n      doc.text(`Total Crew On-Site: ${todayMetrics.total}`, 14, y); y += 5\n      doc.text(`Contract Workers: ${todayMetrics.contract.length}`, 14, y); y += 5\n      doc.text(`T&M Workers: ${todayMetrics.tm.length}`, 14, y); y += 10\n\n      // Contract Workers\n      if (todayMetrics.contract.length > 0) {\n        doc.setFontSize(12)\n        doc.setFont(undefined, 'bold')\n        doc.text('Contract Workers', 14, y); y += 7\n\n        doc.setFontSize(9)\n        doc.setFont(undefined, 'bold')\n        doc.text('Name', 14, y)\n        doc.text('Role', 100, y); y += 5\n\n        doc.setFont(undefined, 'normal')\n        todayMetrics.contract.forEach(w => {\n          if (y > 270) { doc.addPage(); y = 20 }\n          doc.text(w.name, 14, y)\n          doc.text(w.role || '', 100, y); y += 5\n        })\n        y += 8\n      }\n\n      // T&M Workers\n      if (todayMetrics.tm.length > 0) {\n        if (y > 240) { doc.addPage(); y = 20 }\n        doc.setFontSize(12)\n        doc.setFont(undefined, 'bold')\n        doc.text('T&M Workers (Extra Work)', 14, y); y += 7\n\n        doc.setFontSize(9)\n        doc.setFont(undefined, 'bold')\n        doc.text('Name', 14, y)\n        doc.text('Role', 100, y); y += 5\n\n        doc.setFont(undefined, 'normal')\n        todayMetrics.tm.forEach(w => {\n          if (y > 270) { doc.addPage(); y = 20 }\n          doc.text(w.name, 14, y)\n          doc.text(w.role || '', 100, y); y += 5\n        })\n        y += 8\n      }\n\n      // Timeline table\n      if (y > 200) { doc.addPage(); y = 20 }\n      doc.setFontSize(12)\n      doc.setFont(undefined, 'bold')\n      doc.text('Daily Timeline', 14, y); y += 7\n\n      doc.setFontSize(8)\n      doc.setFont(undefined, 'bold')\n      doc.text('Date', 14, y)\n      doc.text('Total', 70, y)\n      doc.text('Contract', 95, y)\n      doc.text('T&M', 125, y); y += 5\n\n      doc.setFont(undefined, 'normal')\n      chartData.forEach(day => {\n        if (y > 275) { doc.addPage(); y = 20 }\n        doc.text(day.displayDate, 14, y)\n        doc.text(String(day.total), 70, y)\n        doc.text(String(day.contract), 95, y)\n        doc.text(String(day.tm), 125, y)\n        y += 4.5\n      })\n\n      // Footer\n      const footerY = doc.internal.pageSize.height - 10\n      doc.setFontSize(8)\n      doc.setTextColor(128, 128, 128)\n      doc.text(`Generated ${new Date().toLocaleString()}  FieldSync`, pageWidth / 2, footerY, { align: 'center' })\n\n      const fileName = `${project.name}_Crew_Report_${selectedDate}.pdf`\n      doc.save(fileName)\n      onShowToast?.('PDF exported!', 'success')\n    } catch (error) {\n      console.error('Error exporting crew PDF:', error)\n      onShowToast?.('Error generating PDF', 'error')\n    } finally {\n      setExporting(false)\n    }\n  }, [project, selectedDate, todayMetrics, chartData, onShowToast])\n\n  if (loading) {\n    return (\n      <div className=\"crew-metrics-card animate-fade-in-up\">\n        <div className=\"crew-metrics-header\">\n          <h3><Users size={18} /> Crew On-Site</h3>\n        </div>\n        <div className=\"crew-metrics-loading\">\n          <div className=\"skeleton-stat\"></div>\n          <div className=\"skeleton-stat\"></div>\n          <div className=\"skeleton-stat\"></div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"crew-metrics-card animate-fade-in-up\">\n      {/* Header with export */}\n      <div className=\"crew-metrics-header\">\n        <h3><Users size={18} /> Crew On-Site</h3>\n        <div className=\"crew-metrics-actions\">\n          <button\n            className=\"btn btn-secondary btn-small\"\n            onClick={exportCrewPDF}\n            disabled={exporting}\n            title=\"Export crew report as PDF\"\n          >\n            <Download size={14} /> {exporting ? 'Exporting...' : 'PDF'}\n          </button>\n        </div>\n      </div>\n\n      {/* Date navigator */}\n      <div className=\"crew-date-nav\">\n        <button className=\"crew-date-btn\" onClick={() => changeDate(-1)}>\n          <ChevronLeft size={16} />\n        </button>\n        <span className=\"crew-date-label\">\n          <Calendar size={14} />\n          {isToday ? 'Today' : formatDate(selectedDate)}\n        </span>\n        <button className=\"crew-date-btn\" onClick={() => changeDate(1)} disabled={isToday}>\n          <ChevronRight size={16} />\n        </button>\n      </div>\n\n      {/* Stats row for selected day */}\n      <div className=\"crew-stats-row\">\n        <div className=\"crew-stat total\">\n          <div className=\"crew-stat-icon\"><Users size={20} /></div>\n          <div className=\"crew-stat-content\">\n            <span className=\"crew-stat-value\">{todayMetrics.total}</span>\n            <span className=\"crew-stat-label\">Total On-Site</span>\n          </div>\n        </div>\n\n        <div className=\"crew-stat contract\">\n          <div className=\"crew-stat-icon\"><HardHat size={20} /></div>\n          <div className=\"crew-stat-content\">\n            <span className=\"crew-stat-value\">{todayMetrics.contract.length}</span>\n            <span className=\"crew-stat-label\">Contract</span>\n          </div>\n        </div>\n\n        <div className=\"crew-stat tm\">\n          <div className=\"crew-stat-icon\"><Wrench size={20} /></div>\n          <div className=\"crew-stat-content\">\n            <span className=\"crew-stat-value\">{todayMetrics.tm.length}</span>\n            <span className=\"crew-stat-label\">T&M</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Breakdown bar for selected day */}\n      {todayMetrics.total > 0 && (\n        <div className=\"crew-breakdown-bar\">\n          <div\n            className=\"crew-bar-segment contract\"\n            style={{ width: `${(todayMetrics.contract.length / todayMetrics.total) * 100}%` }}\n            title={`${todayMetrics.contract.length} Contract`}\n          />\n          <div\n            className=\"crew-bar-segment tm\"\n            style={{ width: `${(todayMetrics.tm.length / todayMetrics.total) * 100}%` }}\n            title={`${todayMetrics.tm.length} T&M`}\n          />\n        </div>\n      )}\n\n      {/* Worker name lists */}\n      {todayMetrics.total > 0 && (\n        <div className=\"crew-name-lists\">\n          {todayMetrics.contract.length > 0 && (\n            <div className=\"crew-name-group\">\n              <div className=\"crew-name-group-header contract\">\n                <HardHat size={13} />\n                <span>Contract ({todayMetrics.contract.length})</span>\n              </div>\n              <div className=\"crew-name-tags\">\n                {todayMetrics.contract.map((w, i) => (\n                  <span key={i} className=\"crew-name-tag contract\">\n                    {w.name}\n                    {w.role && w.role !== 'Laborer' && (\n                      <span className=\"crew-name-role\">{w.role}</span>\n                    )}\n                  </span>\n                ))}\n              </div>\n            </div>\n          )}\n          {todayMetrics.tm.length > 0 && (\n            <div className=\"crew-name-group\">\n              <div className=\"crew-name-group-header tm\">\n                <Wrench size={13} />\n                <span>T&M ({todayMetrics.tm.length})</span>\n              </div>\n              <div className=\"crew-name-tags\">\n                {todayMetrics.tm.map((w, i) => (\n                  <span key={i} className=\"crew-name-tag tm\">\n                    {w.name}\n                    {w.role && w.role !== 'Laborer' && (\n                      <span className=\"crew-name-role\">{w.role}</span>\n                    )}\n                  </span>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Day-by-day timeline chart */}\n      <div className=\"crew-timeline-section\">\n        <div className=\"crew-timeline-header\">\n          <span className=\"crew-timeline-title\">Daily Breakdown</span>\n          <div className=\"crew-time-range-pills\">\n            {TIME_RANGES.map(range => (\n              <button\n                key={range.id}\n                className={`crew-range-pill ${timeRange === range.id ? 'active' : ''}`}\n                onClick={() => setTimeRange(range.id)}\n              >\n                {range.label}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"crew-chart-container\">\n          <ResponsiveContainer width=\"100%\" height={140}>\n            <BarChart\n              data={chartData}\n              onClick={(e) => e?.activePayload?.[0] && handleBarClick(e.activePayload[0].payload)}\n              style={{ cursor: 'pointer' }}\n            >\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"var(--border-color)\" vertical={false} />\n              <XAxis\n                dataKey=\"displayDate\"\n                tick={{ fontSize: 10, fill: 'var(--text-muted)' }}\n                axisLine={{ stroke: 'var(--border-color)' }}\n                tickLine={false}\n                interval={timeRange === '30d' ? 4 : timeRange === '14d' ? 1 : 0}\n              />\n              <YAxis\n                tick={{ fontSize: 10, fill: 'var(--text-muted)' }}\n                axisLine={false}\n                tickLine={false}\n                allowDecimals={false}\n                width={30}\n              />\n              <Tooltip content={<CustomTooltip />} />\n              <Legend\n                wrapperStyle={{ fontSize: '0.75rem', paddingTop: 4 }}\n                iconType=\"circle\"\n                iconSize={8}\n              />\n              <Bar\n                dataKey=\"contract\"\n                name=\"Contract\"\n                stackId=\"crew\"\n                fill={CREW_COLORS.contract}\n                radius={[0, 0, 0, 0]}\n              />\n              <Bar\n                dataKey=\"tm\"\n                name=\"T&M (Extra Work)\"\n                stackId=\"crew\"\n                fill={CREW_COLORS.tm}\n                radius={[3, 3, 0, 0]}\n              />\n            </BarChart>\n          </ResponsiveContainer>\n        </div>\n      </div>\n\n      {/* Empty state */}\n      {todayMetrics.total === 0 && (\n        <div className=\"crew-empty\">\n          <p>No crew checked in for this date</p>\n        </div>\n      )}\n    </div>\n  )\n})\n\nexport default OverviewCrewMetrics\n","import { useState, useEffect, useRef, useCallback, useMemo, lazy, Suspense } from 'react'\nimport { db } from '../lib/supabase'\nimport { safeAsync } from '../lib/errorHandler'\nimport { formatCurrency, calculateProgress, calculateValueProgress, getOverallStatus, getOverallStatusLabel, formatStatus, calculateScheduleInsights, shouldAutoArchive } from '../lib/utils'\nimport { calculateRiskScore, generateSmartAlerts, calculateProjections } from '../lib/riskCalculations'\nimport { exportAllFieldDocumentsPDF, exportDailyReportsPDF, exportIncidentReportsPDF, exportCrewCheckinsPDF } from '../lib/fieldDocumentExport'\nimport { LayoutGrid, DollarSign, ClipboardList, HardHat, Truck, Info, Building2, Phone, MapPin, FileText, Menu, FolderOpen, Search, Download, Users, Shield, Package, TrendingUp, TrendingDown, Camera, AlertTriangle, CheckCircle2 } from 'lucide-react'\nimport UniversalSearch, { useUniversalSearch } from './UniversalSearch'\nimport { SmartAlerts } from './dashboard/SmartAlerts'\nimport { RiskScoreBadge } from './dashboard/RiskScoreGauge'\nimport { TrendIndicator } from './dashboard/TrendIndicator'\nimport { ProjectHealthBadge } from './dashboard/AccessibleStatusBadge'\nimport ManDayCosts from './ManDayCosts'\nimport ProgressBillingCard from './billing/ProgressBillingCard'\nimport ProjectEquipmentCard from './equipment/ProjectEquipmentCard'\nimport BurnRateCard from './BurnRateCard'\nimport CostContributorsCard from './CostContributorsCard'\nimport ProfitabilityCard from './ProfitabilityCard'\nimport DisposalSummary from './DisposalSummary'\nimport ProjectTeam from './ProjectTeam'\nimport HeroMetrics from './HeroMetrics'\nimport FinancialsNav from './FinancialsNav'\nimport { FinancialTrendChart } from './charts'\nimport { TicketSkeleton, ChartSkeleton } from './ui'\nimport { OverviewProgressGauge, OverviewFinancialCard, OverviewCrewMetrics } from './overview'\n\n// Lazy load modals and conditionally rendered heavy components\nconst TMList = lazy(() => import('./TMList'))\nconst ShareModal = lazy(() => import('./ShareModal'))\nconst InjuryReportsList = lazy(() => import('./InjuryReportsList'))\nconst NotificationSettings = lazy(() => import('./NotificationSettings'))\nconst DailyReportsList = lazy(() => import('./DailyReportsList'))\nconst CORList = lazy(() => import('./cor/CORList'))\nconst CORForm = lazy(() => import('./cor/CORForm'))\nconst CORDetail = lazy(() => import('./cor/CORDetail'))\nconst CORLogPreview = lazy(() => import('./cor/CORLogPreview'))\nconst CORLog = lazy(() => import('./cor/CORLog'))\nconst BillingCenter = lazy(() => import('./billing/BillingCenter'))\nconst DrawRequestModal = lazy(() => import('./billing/DrawRequestModal'))\nconst EquipmentModal = lazy(() => import('./equipment/EquipmentModal'))\nconst AddCostModal = lazy(() => import('./AddCostModal'))\nconst DocumentsTab = lazy(() => import('./documents/DocumentsTab'))\n\nexport default function Dashboard({ company, user, isAdmin, onShowToast, navigateToProjectId, onProjectNavigated }) {\n  const [projects, setProjects] = useState([])\n  const [projectsData, setProjectsData] = useState([]) // Enhanced data with areas/tickets\n  const [selectedProject, setSelectedProject] = useState(null)\n  const [areas, setAreas] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [editMode, setEditMode] = useState(false)\n  const [editData, setEditData] = useState(null)\n  const [saving, setSaving] = useState(false)\n  const [showShareModal, setShowShareModal] = useState(false)\n  const [showNotificationSettings, setShowNotificationSettings] = useState(false)\n  const [activeProjectTab, setActiveProjectTab] = useState('overview')\n  const [financialsSection, setFinancialsSection] = useState('overview') // 'overview' | 'cors' | 'tickets'\n  const [financialsSidebarCollapsed, setFinancialsSidebarCollapsed] = useState(true) // Start collapsed for more real estate\n  const [financialsSidebarMobileOpen, setFinancialsSidebarMobileOpen] = useState(false) // For mobile sidebar overlay\n  const [corListExpanded, setCORListExpanded] = useState(false) // Whether the full card list is shown below the log\n  const [corDisplayMode, setCORDisplayMode] = useState('list') // 'list' | 'log' - for layout expansion\n  const [tmViewMode, setTMViewMode] = useState('preview') // 'preview' | 'full'\n  const [dumpSites, setDumpSites] = useState([])\n  const [showCORForm, setShowCORForm] = useState(false)\n  const [editingCOR, setEditingCOR] = useState(null)\n  const [showCORDetail, setShowCORDetail] = useState(false)\n  const [viewingCOR, setViewingCOR] = useState(null)\n  const [corRefreshKey, setCORRefreshKey] = useState(0)\n  const [showAddCostModal, setShowAddCostModal] = useState(false)\n  const [savingCost, setSavingCost] = useState(false)\n  const [showEquipmentModal, setShowEquipmentModal] = useState(false)\n  const [editingEquipment, setEditingEquipment] = useState(null)\n  const [equipmentRefreshKey, setEquipmentRefreshKey] = useState(0)\n  const [showDrawRequestModal, setShowDrawRequestModal] = useState(false)\n  const [editingDrawRequest, setEditingDrawRequest] = useState(null)\n  const [drawRequestRefreshKey, setDrawRequestRefreshKey] = useState(0)\n\n  // Universal Search (Cmd+K)\n  const { isOpen: isSearchOpen, setIsOpen: setSearchOpen, close: closeSearch } = useUniversalSearch()\n\n  // Debounce ref to prevent cascading refreshes from multiple subscription callbacks\n  // When multiple real-time events fire rapidly, this coalesces them into a single refresh\n  const refreshTimeoutRef = useRef(null)\n  const pendingAreasRefreshRef = useRef(false)\n  const pendingCORRefreshRef = useRef(false)\n\n  // Cache for project details to avoid re-fetching when switching between projects\n  // Key: projectId, Value: { data: enhancedProjectData, timestamp: Date.now() }\n  const projectDetailsCacheRef = useRef(new Map())\n  const CACHE_TTL_MS = 5 * 60 * 1000 // 5 minute cache TTL\n\n  // Debounced refresh function that coalesces multiple rapid refresh requests\n  // This prevents 5+ loadProjects() calls when multiple subscriptions fire at once\n  const debouncedRefresh = useCallback((options = {}) => {\n    const { refreshAreas = false, refreshCOR = false, projectId = null } = options\n\n    // Track what needs refreshing\n    if (refreshAreas && projectId) pendingAreasRefreshRef.current = projectId\n    if (refreshCOR) pendingCORRefreshRef.current = true\n\n    // Clear any pending refresh\n    if (refreshTimeoutRef.current) {\n      clearTimeout(refreshTimeoutRef.current)\n    }\n\n    // Schedule a single refresh after debounce period (150ms)\n    // This is fast enough to feel \"live\" but prevents cascading calls\n    refreshTimeoutRef.current = setTimeout(async () => {\n      // Execute pending refreshes\n      if (pendingAreasRefreshRef.current) {\n        await loadAreas(pendingAreasRefreshRef.current)\n        pendingAreasRefreshRef.current = false\n      }\n      if (pendingCORRefreshRef.current) {\n        setCORRefreshKey(prev => prev + 1)\n        pendingCORRefreshRef.current = false\n      }\n      // Always refresh projects to update metrics\n      await loadProjects()\n    }, 150)\n  }, [])\n\n  // Cleanup debounce timeout on unmount\n  useEffect(() => {\n    return () => {\n      if (refreshTimeoutRef.current) {\n        clearTimeout(refreshTimeoutRef.current)\n      }\n    }\n  }, [])\n\n  // Initial load\n  useEffect(() => {\n    if (company?.id) {\n      loadProjects()\n      loadDumpSites()\n    }\n  }, [company?.id])\n\n  // Track project IDs for subscription stability (avoids re-subscribing on every projects array change)\n  const projectIdsRef = useRef([])\n  const projectIdsKey = projects.map(p => p.id).sort().join(',')\n\n  // Real-time subscription - runs after projects are loaded\n  useEffect(() => {\n    if (!company?.id || projects.length === 0) return\n\n    // Only update ref if project IDs actually changed\n    const currentIds = projects.map(p => p.id).sort()\n    projectIdsRef.current = currentIds\n\n    // Subscribe to company-wide activity to refresh metrics in real-time\n    // Uses debounced refresh to coalesce rapid updates from multiple sources\n    const subscription = db.subscribeToCompanyActivity?.(company.id, currentIds, {\n      onMessage: () => debouncedRefresh(),\n      onMaterialRequest: () => debouncedRefresh(),\n      onTMTicket: () => debouncedRefresh(),\n      onCrewCheckin: () => debouncedRefresh(), // Crew check-ins affect labor costs\n      onAreaUpdate: () => debouncedRefresh(), // Area updates affect progress\n      onCORChange: () => debouncedRefresh({ refreshCOR: true }), // COR changes\n      onInjuryReport: () => debouncedRefresh(),\n      onProjectChange: () => debouncedRefresh(), // Project details changed\n      onMaterialsEquipmentChange: () => debouncedRefresh(), // Pricing updates\n      onLaborRateChange: () => debouncedRefresh() // Labor rate updates\n    })\n\n    return () => {\n      if (subscription) {\n        db.unsubscribe?.(subscription)\n      }\n    }\n  }, [company?.id, projectIdsKey, debouncedRefresh])\n\n  // Prevent body scroll when mobile sidebar is open\n  useEffect(() => {\n    if (financialsSidebarMobileOpen) {\n      document.body.style.overflow = 'hidden'\n    } else {\n      document.body.style.overflow = ''\n    }\n\n    return () => {\n      document.body.style.overflow = ''\n    }\n  }, [financialsSidebarMobileOpen])\n\n  const loadDumpSites = async () => {\n    try {\n      const sites = await db.getDumpSites(company.id)\n      setDumpSites(sites || [])\n    } catch (error) {\n      console.error('Error loading dump sites:', error)\n    }\n  }\n\n  // Handle navigation from notifications\n  // Use a ref to prevent re-running this effect when projects data refreshes\n  const lastNavigatedIdRef = useRef(null)\n  useEffect(() => {\n    if (navigateToProjectId && navigateToProjectId !== lastNavigatedIdRef.current && projects.length > 0) {\n      const project = projects.find(p => p.id === navigateToProjectId)\n      if (project) {\n        lastNavigatedIdRef.current = navigateToProjectId\n        setSelectedProject(project)\n        onProjectNavigated?.() // Clear the navigation request\n      }\n    }\n  }, [navigateToProjectId, projects, onProjectNavigated])\n\n  useEffect(() => {\n    if (selectedProject) {\n      loadAreas(selectedProject.id)\n\n      // Subscribe to real-time updates for the selected project\n      // All callbacks use debouncedRefresh to prevent cascading refreshes\n      const subscriptions = []\n      const projectId = selectedProject.id\n\n      // Areas subscription - also refreshes areas list\n      const areasSub = db.subscribeToAreas?.(projectId, () => {\n        debouncedRefresh({ refreshAreas: true, projectId })\n      })\n      if (areasSub) subscriptions.push(areasSub)\n\n      // Daily reports subscription\n      const dailyReportsSub = db.subscribeToDailyReports?.(projectId, () => {\n        debouncedRefresh()\n      })\n      if (dailyReportsSub) subscriptions.push(dailyReportsSub)\n\n      // Crew checkins subscription (affects labor costs)\n      const checkinsSub = db.subscribeToCrewCheckins?.(projectId, () => {\n        debouncedRefresh()\n      })\n      if (checkinsSub) subscriptions.push(checkinsSub)\n\n      // Haul offs subscription\n      const haulOffsSub = db.subscribeToHaulOffs?.(projectId, () => {\n        debouncedRefresh()\n      })\n      if (haulOffsSub) subscriptions.push(haulOffsSub)\n\n      // CORs subscription - also refreshes COR list\n      const corsSub = db.subscribeToCORs?.(projectId, () => {\n        debouncedRefresh({ refreshCOR: true })\n      })\n      if (corsSub) subscriptions.push(corsSub)\n\n      return () => {\n        subscriptions.forEach(sub => db.unsubscribe?.(sub))\n      }\n    }\n  }, [selectedProject, debouncedRefresh])\n\n  // When navigating to tickets section, switch to full mode to show dashboard\n  useEffect(() => {\n    if (financialsSection === 'tickets') {\n      setTMViewMode('full')\n    }\n  }, [financialsSection])\n\n  // Load detailed data for a single project (on-demand, with caching)\n  // This replaces the previous N+1 pattern where ALL project details were loaded upfront\n  const loadProjectDetails = async (project, forceRefresh = false) => {\n    const cacheKey = project.id\n    const cached = projectDetailsCacheRef.current.get(cacheKey)\n\n    // Return cached data if valid and not forcing refresh\n    if (cached && !forceRefresh && (Date.now() - cached.timestamp) < CACHE_TTL_MS) {\n      return cached.data\n    }\n\n    try {\n      // Fetch detailed project data in parallel (12 queries for 1 project, not 12N)\n      const [\n        projectAreas,\n        tickets,\n        changeOrderData,\n        dailyReports,\n        injuryReports,\n        laborCosts,\n        haulOffCosts,\n        customCosts,\n        corStats,\n        crewHistory,\n        materialRequests,\n        weeklyDisposal\n      ] = await Promise.all([\n        safeAsync(() => db.getAreas(project.id), { fallback: [], context: { operation: 'getAreas', projectId: project.id } }),\n        safeAsync(() => db.getTMTickets(project.id), { fallback: [], context: { operation: 'getTMTickets', projectId: project.id } }),\n        safeAsync(() => db.getChangeOrderTotals(project.id), { fallback: null, context: { operation: 'getChangeOrderTotals', projectId: project.id } }),\n        safeAsync(() => db.getDailyReports(project.id, 100), { fallback: [], context: { operation: 'getDailyReports', projectId: project.id } }),\n        safeAsync(() => db.getInjuryReports(project.id), { fallback: [], context: { operation: 'getInjuryReports', projectId: project.id } }),\n        safeAsync(() => db.calculateManDayCosts(project.id, company?.id, project.work_type || 'demolition', project.job_type || 'standard'), { fallback: null, context: { operation: 'calculateManDayCosts', projectId: project.id } }),\n        safeAsync(() => db.calculateHaulOffCosts(project.id), { fallback: null, context: { operation: 'calculateHaulOffCosts', projectId: project.id } }),\n        safeAsync(() => db.getProjectCosts(project.id), { fallback: [], context: { operation: 'getProjectCosts', projectId: project.id } }),\n        safeAsync(() => db.getCORStats(project.id), { fallback: null, context: { operation: 'getCORStats', projectId: project.id } }),\n        safeAsync(() => db.getCrewCheckinHistory(project.id, 60), { fallback: [], context: { operation: 'getCrewCheckinHistory', projectId: project.id } }),\n        safeAsync(() => db.getMaterialRequests(project.id), { fallback: [], context: { operation: 'getMaterialRequests', projectId: project.id } }),\n        safeAsync(() => db.getWeeklyDisposalSummary(project.id, 4), { fallback: [], context: { operation: 'getWeeklyDisposalSummary', projectId: project.id } })\n      ])\n\n      // Calculate progress - use SOV values if available\n      const progressData = calculateValueProgress(projectAreas)\n      const progress = progressData.progress\n\n      // Calculate revised contract value\n      const changeOrderValue = changeOrderData?.totalApprovedValue || 0\n      const revisedContractValue = project.contract_value + changeOrderValue\n\n      // Billable calculation\n      const billable = progressData.isValueBased\n        ? progressData.earnedValue\n        : (progress / 100) * revisedContractValue\n      const pendingTickets = tickets.filter(t => t.status === 'pending').length\n\n      // Recent activity\n      const oneWeekAgo = new Date()\n      oneWeekAgo.setDate(oneWeekAgo.getDate() - 7)\n      const recentDailyReports = dailyReports.filter(r => new Date(r.report_date) >= oneWeekAgo).length\n\n      // Custom costs\n      const customCostTotal = customCosts.reduce((sum, c) => {\n        const amount = parseFloat(c.amount)\n        return sum + (isNaN(amount) ? 0 : amount)\n      }, 0)\n\n      // Materials/equipment costs from T&M\n      let materialsEquipmentCost = 0\n      const materialsEquipmentByDate = {}\n      tickets.forEach(ticket => {\n        const ticketDate = ticket.work_date || ticket.ticket_date || ticket.created_at?.split('T')[0]\n        const items = ticket.t_and_m_items || ticket.items || []\n        let ticketMaterialsCost = 0\n        items.forEach(item => {\n          const qty = parseFloat(item.quantity) || 1\n          const cost = parseFloat(item.unit_cost) || parseFloat(item.materials_equipment?.cost_per_unit) || 0\n          ticketMaterialsCost += qty * cost\n        })\n        if (ticketMaterialsCost > 0 && ticketDate) {\n          materialsEquipmentCost += ticketMaterialsCost\n          if (!materialsEquipmentByDate[ticketDate]) {\n            materialsEquipmentByDate[ticketDate] = { date: ticketDate, cost: 0 }\n          }\n          materialsEquipmentByDate[ticketDate].cost += ticketMaterialsCost\n        }\n      })\n      const materialsEquipmentByDateArray = Object.values(materialsEquipmentByDate)\n        .sort((a, b) => new Date(b.date) - new Date(a.date))\n\n      // Total costs\n      const laborCost = laborCosts?.totalCost || 0\n      const haulOffCost = haulOffCosts?.totalCost || 0\n      const allCostsTotal = laborCost + materialsEquipmentCost + customCostTotal\n\n      // Profit calculations\n      const currentProfit = billable - allCostsTotal\n      const profitMargin = billable > 0 ? (currentProfit / billable) * 100 : 0\n\n      // Burn rate\n      const laborDays = laborCosts?.byDate?.length || 0\n      const materialsDays = materialsEquipmentByDateArray.length\n      const totalBurnDays = Math.max(laborDays, materialsDays)\n      const totalBurn = laborCost + materialsEquipmentCost\n      const dailyBurn = totalBurnDays > 0 ? totalBurn / totalBurnDays : 0\n\n      // Schedule insights\n      const scheduleInsights = calculateScheduleInsights(\n        { ...project, progress },\n        laborCosts?.totalManDays || 0\n      )\n\n      // Crew analytics from check-in history\n      const crewByDate = {}\n      const uniqueWorkers = new Set()\n      ;(crewHistory || []).forEach(checkin => {\n        const workers = checkin.workers || []\n        crewByDate[checkin.check_in_date] = workers.length\n        workers.forEach(w => uniqueWorkers.add(w.name?.toLowerCase()))\n      })\n      const crewDates = Object.keys(crewByDate).sort()\n      const avgCrewSize = crewDates.length > 0\n        ? Math.round(crewDates.reduce((sum, d) => sum + crewByDate[d], 0) / crewDates.length * 10) / 10\n        : 0\n      const peakCrewSize = crewDates.length > 0\n        ? Math.max(...crewDates.map(d => crewByDate[d]))\n        : 0\n      // Crew trend: compare last 7 days avg to prior 7 days avg\n      const recentCrewDates = crewDates.slice(-7)\n      const priorCrewDates = crewDates.slice(-14, -7)\n      const recentCrewAvg = recentCrewDates.length > 0\n        ? recentCrewDates.reduce((s, d) => s + crewByDate[d], 0) / recentCrewDates.length\n        : 0\n      const priorCrewAvg = priorCrewDates.length > 0\n        ? priorCrewDates.reduce((s, d) => s + crewByDate[d], 0) / priorCrewDates.length\n        : 0\n\n      // Material request analytics\n      const pendingMaterialRequests = (materialRequests || []).filter(r => r.status === 'pending').length\n      const orderedMaterialRequests = (materialRequests || []).filter(r => r.status === 'ordered').length\n      const deliveredMaterialRequests = (materialRequests || []).filter(r => r.status === 'delivered').length\n      const urgentMaterialRequests = (materialRequests || []).filter(r => r.priority === 'urgent' && r.status === 'pending').length\n\n      // Daily report field notes analysis\n      const reportsWithIssues = dailyReports.filter(r => r.issues && r.issues.trim().length > 0).length\n      const totalPhotosFromTickets = tickets.reduce((sum, t) => sum + (t.photos?.length || 0), 0)\n\n      // Disposal totals from weekly data\n      const disposalTotalLoads = (weeklyDisposal || []).reduce((sum, w) => {\n        return sum + (w.concrete || 0) + (w.trash || 0) + (w.metals || 0) + (w.hazardous_waste || 0)\n      }, 0)\n\n      // Days since last injury\n      const lastInjuryDate = injuryReports.length > 0\n        ? new Date(injuryReports[0]?.incident_date || injuryReports[0]?.created_at)\n        : null\n      const daysSinceLastInjury = lastInjuryDate\n        ? Math.floor((new Date() - lastInjuryDate) / (1000 * 60 * 60 * 24))\n        : null\n\n      // Task completion velocity: areas completed in last 14 days vs prior 14 days\n      const completedAreas = projectAreas.filter(a => a.status === 'done')\n\n      const enhancedData = {\n        ...project,\n        areas: projectAreas,\n        progress,\n        billable,\n        changeOrderValue,\n        revisedContractValue,\n        changeOrderPending: changeOrderData?.pendingCount || 0,\n        totalTickets: tickets.length,\n        pendingTickets,\n        approvedTickets: tickets.filter(t => t.status === 'approved').length,\n        tmTickets: tickets,\n        dailyReportsCount: dailyReports.length,\n        recentDailyReports,\n        injuryReportsCount: injuryReports.length,\n        lastDailyReport: dailyReports[0]?.report_date || null,\n        isValueBased: progressData.isValueBased,\n        earnedValue: progressData.earnedValue,\n        totalSOVValue: progressData.totalValue,\n        laborCost,\n        laborDaysWorked: laborDays,\n        laborManDays: laborCosts?.totalManDays || 0,\n        laborByDate: laborCosts?.byDate || [],\n        dailyBurn,\n        materialsEquipmentCost,\n        materialsEquipmentByDate: materialsEquipmentByDateArray,\n        haulOffCost,\n        haulOffLoads: haulOffCosts?.totalLoads || 0,\n        haulOffDays: haulOffCosts?.daysWithHaulOff || 0,\n        haulOffByType: haulOffCosts?.byWasteType || {},\n        haulOffByDate: haulOffCosts?.byDate || [],\n        customCosts,\n        customCostTotal,\n        totalBurn,\n        totalBurnDays,\n        allCostsTotal,\n        currentProfit,\n        profitMargin,\n        corPendingValue: corStats?.total_pending_value || 0,\n        corPendingCount: corStats?.pending_count || 0,\n        corApprovedValue: corStats?.total_approved_value || 0,\n        corBilledValue: corStats?.total_billed_value || 0,\n        corTotalCount: corStats?.total_cors || 0,\n        corStats: corStats,\n        scheduleStatus: scheduleInsights.scheduleStatus,\n        scheduleVariance: scheduleInsights.scheduleVariance,\n        scheduleLabel: scheduleInsights.scheduleLabel,\n        laborStatus: scheduleInsights.laborStatus,\n        laborVariance: scheduleInsights.laborVariance,\n        laborLabel: scheduleInsights.laborLabel,\n        hasScheduleData: scheduleInsights.hasScheduleData,\n        hasLaborData: scheduleInsights.hasLaborData,\n        actualManDays: laborCosts?.totalManDays || 0,\n        // Crew analytics\n        crewHistory: crewHistory || [],\n        crewByDate,\n        uniqueWorkerCount: uniqueWorkers.size,\n        avgCrewSize,\n        peakCrewSize,\n        crewDaysTracked: crewDates.length,\n        crewTrend: priorCrewAvg > 0 ? ((recentCrewAvg - priorCrewAvg) / priorCrewAvg * 100) : 0,\n        recentCrewAvg,\n        // Material requests\n        materialRequests: materialRequests || [],\n        pendingMaterialRequests,\n        orderedMaterialRequests,\n        deliveredMaterialRequests,\n        urgentMaterialRequests,\n        totalMaterialRequests: (materialRequests || []).length,\n        // Field activity insights\n        reportsWithIssues,\n        totalPhotosFromTickets,\n        dailyReports,\n        // Disposal trends\n        weeklyDisposal: weeklyDisposal || [],\n        disposalTotalLoads,\n        // Safety analytics\n        daysSinceLastInjury,\n        injuryReports,\n        oshaRecordable: injuryReports.filter(r => r.osha_recordable).length,\n        // Completion\n        completedAreasCount: completedAreas.length,\n        hasError: false,\n        _detailsLoaded: true\n      }\n\n      // Cache the enhanced data\n      projectDetailsCacheRef.current.set(cacheKey, {\n        data: enhancedData,\n        timestamp: Date.now()\n      })\n\n      return enhancedData\n    } catch (error) {\n      console.error(`Error loading details for project ${project.id}:`, error)\n      return { ...project, hasError: true, _detailsLoaded: false }\n    }\n  }\n\n  // OPTIMIZED: Load projects with summary data only (1 query instead of 9N)\n  // Detailed data is loaded on-demand when a project is selected\n  const loadProjects = async () => {\n    try {\n      // Single optimized query for all project summaries\n      const data = await db.getProjectDashboardSummary(company?.id)\n      setProjects(data)\n\n      // Create lightweight enhanced data using ONLY summary metrics from the RPC\n      // This uses data already returned from getProjectDashboardSummary (no additional queries!)\n      // Detailed data is loaded on-demand via loadProjectDetails when a project is selected\n      const enhanced = data.map(project => {\n        // Check if we have cached detailed data for this project\n        const cached = projectDetailsCacheRef.current.get(project.id)\n        if (cached && (Date.now() - cached.timestamp) < CACHE_TTL_MS) {\n          // Use cached detailed data if still valid\n          return cached.data\n        }\n\n        // Use summary data from RPC (no additional queries needed)\n        // Progress is estimated from area counts in the summary\n        const totalAreas = project.areaCount || 0\n        const completedAreas = project.completedAreas || 0\n        const progress = totalAreas > 0 ? Math.round((completedAreas / totalAreas) * 100) : 0\n\n        return {\n          ...project,\n          // Basic metrics from summary (already loaded)\n          progress,\n          areas: [], // Loaded on-demand when project selected\n          totalTickets: project.ticketCount || 0,\n          pendingTickets: project.pendingTicketCount || 0,\n          approvedTickets: project.approvedTicketCount || 0,\n          dailyReportsCount: project.dailyReportsThisWeek || 0,\n          recentDailyReports: project.dailyReportsThisWeek || 0,\n          corTotalCount: project.corCount || 0,\n          // Placeholder values - loaded on-demand when selected\n          billable: 0,\n          changeOrderValue: 0,\n          revisedContractValue: project.contract_value || 0,\n          changeOrderPending: 0,\n          tmTickets: [],\n          injuryReportsCount: 0,\n          lastDailyReport: null,\n          isValueBased: false,\n          earnedValue: 0,\n          totalSOVValue: 0,\n          laborCost: 0,\n          laborDaysWorked: 0,\n          laborManDays: 0,\n          laborByDate: [],\n          dailyBurn: 0,\n          materialsEquipmentCost: 0,\n          materialsEquipmentByDate: [],\n          haulOffCost: 0,\n          haulOffLoads: 0,\n          haulOffDays: 0,\n          haulOffByType: {},\n          haulOffByDate: [],\n          customCosts: [],\n          customCostTotal: 0,\n          totalBurn: 0,\n          totalBurnDays: 0,\n          allCostsTotal: 0,\n          currentProfit: 0,\n          profitMargin: 0,\n          corPendingValue: 0,\n          corPendingCount: 0,\n          corApprovedValue: 0,\n          corBilledValue: 0,\n          corStats: null,\n          scheduleStatus: 'on_track',\n          scheduleVariance: 0,\n          scheduleLabel: 'On Track',\n          laborStatus: 'on_track',\n          laborVariance: 0,\n          laborLabel: null,\n          hasScheduleData: false,\n          hasLaborData: false,\n          actualManDays: 0,\n          hasError: false,\n          _detailsLoaded: false // Flag to indicate detailed data needs loading\n        }\n      })\n      setProjectsData(enhanced)\n    } catch (error) {\n      console.error('Error loading projects:', error)\n      onShowToast('Error loading projects', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const loadAreas = async (projectId) => {\n    try {\n      const data = await db.getAreas(projectId)\n      setAreas(data)\n    } catch (error) {\n      console.error('Error loading areas:', error)\n    }\n  }\n\n  const handleSelectProject = async (project) => {\n    // Set the project immediately for responsive UI\n    setSelectedProject(project)\n\n    // If detailed data hasn't been loaded yet, load it now (lazy loading)\n    if (!project._detailsLoaded) {\n      const detailedProject = await loadProjectDetails(project)\n\n      // Update projectsData with the detailed version\n      setProjectsData(prev => prev.map(p =>\n        p.id === project.id ? detailedProject : p\n      ))\n\n      // Update selectedProject with detailed data\n      setSelectedProject(detailedProject)\n    }\n  }\n\n  const handleBack = () => {\n    setSelectedProject(null)\n    setAreas([])\n    setEditMode(false)\n    setEditData(null)\n    setActiveProjectTab('overview')\n    loadProjects()\n  }\n\n  const handleEditClick = () => {\n    setEditData({\n      name: selectedProject.name,\n      job_number: selectedProject.job_number || '',\n      address: selectedProject.address || '',\n      general_contractor: selectedProject.general_contractor || '',\n      client_contact: selectedProject.client_contact || '',\n      client_phone: selectedProject.client_phone || '',\n      contract_value: selectedProject.contract_value,\n      work_type: selectedProject.work_type || 'demolition',\n      job_type: selectedProject.job_type || 'standard',\n      pin: selectedProject.pin || '',\n      default_dump_site_id: selectedProject.default_dump_site_id || '',\n      areas: areas.map(a => ({\n        id: a.id,\n        name: a.name,\n        weight: a.weight,\n        isNew: false\n      }))\n    })\n    setEditMode(true)\n  }\n\n  const handleCancelEdit = () => {\n    setEditMode(false)\n    setEditData(null)\n  }\n\n  const handleEditChange = (field, value) => {\n    setEditData(prev => ({ ...prev, [field]: value }))\n  }\n\n  const handleAreaEditChange = (index, field, value) => {\n    setEditData(prev => ({\n      ...prev,\n      areas: prev.areas.map((area, i) => \n        i === index ? { ...area, [field]: value } : area\n      )\n    }))\n  }\n\n  const handleAddArea = () => {\n    setEditData(prev => ({\n      ...prev,\n      areas: [...prev.areas, { id: null, name: '', weight: '', isNew: true }]\n    }))\n  }\n\n  const handleRemoveArea = (index) => {\n    if (editData.areas.length > 1) {\n      setEditData(prev => ({\n        ...prev,\n        areas: prev.areas.filter((_, i) => i !== index)\n      }))\n    }\n  }\n\n  const handleSaveEdit = async () => {\n    // Validation\n    if (!editData.name.trim()) {\n      onShowToast('Please enter a project name', 'error')\n      return\n    }\n\n    const contractVal = parseFloat(editData.contract_value)\n    if (!contractVal || contractVal <= 0) {\n      onShowToast('Please enter a valid contract value', 'error')\n      return\n    }\n\n    if (editData.pin && editData.pin.length !== 4) {\n      onShowToast('PIN must be 4 digits', 'error')\n      return\n    }\n\n    // Check PIN availability if changed\n    if (editData.pin && editData.pin !== selectedProject.pin) {\n      const pinAvailable = await db.isPinAvailable(editData.pin, selectedProject.id)\n      if (!pinAvailable) {\n        onShowToast('This PIN is already in use', 'error')\n        return\n      }\n    }\n\n    const validAreas = editData.areas.filter(a => a.name.trim() && parseFloat(a.weight) > 0)\n    if (validAreas.length === 0) {\n      onShowToast('Please add at least one area', 'error')\n      return\n    }\n\n    const totalWeight = validAreas.reduce((sum, a) => sum + parseFloat(a.weight), 0)\n    if (totalWeight !== 100) {\n      onShowToast('Area weights must total 100%', 'error')\n      return\n    }\n\n    setSaving(true)\n\n    try {\n      // Update project - include company.id for cross-tenant security\n      await db.updateProject(selectedProject.id, {\n        name: editData.name.trim(),\n        job_number: editData.job_number?.trim() || null,\n        address: editData.address?.trim() || null,\n        general_contractor: editData.general_contractor?.trim() || null,\n        client_contact: editData.client_contact?.trim() || null,\n        client_phone: editData.client_phone?.trim() || null,\n        contract_value: contractVal,\n        work_type: editData.work_type || 'demolition',\n        job_type: editData.job_type || 'standard',\n        pin: editData.pin || null,\n        default_dump_site_id: editData.default_dump_site_id || null\n      }, company?.id)\n\n      // Handle areas\n      const existingAreaIds = areas.map(a => a.id)\n      const editAreaIds = editData.areas.filter(a => a.id).map(a => a.id)\n\n      // Delete removed areas\n      for (const areaId of existingAreaIds) {\n        if (!editAreaIds.includes(areaId)) {\n          await db.deleteArea(areaId)\n        }\n      }\n\n      // Update or create areas\n      for (let i = 0; i < validAreas.length; i++) {\n        const area = validAreas[i]\n        if (area.id) {\n          // Update existing\n          await db.updateArea(area.id, {\n            name: area.name.trim(),\n            weight: parseFloat(area.weight),\n            sort_order: i\n          })\n        } else {\n          // Create new\n          await db.createArea({\n            project_id: selectedProject.id,\n            name: area.name.trim(),\n            weight: parseFloat(area.weight),\n            status: 'not_started',\n            sort_order: i\n          })\n        }\n      }\n\n      // Reload data\n      const updatedProject = await db.getProject(selectedProject.id)\n      setSelectedProject(updatedProject)\n      await loadAreas(selectedProject.id)\n      \n      setEditMode(false)\n      setEditData(null)\n      onShowToast('Project updated!', 'success')\n    } catch (error) {\n      console.error('Error saving project:', error?.message || error)\n      onShowToast(error?.message || 'Error saving changes', 'error')\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const handleDeleteProject = async () => {\n    if (!confirm('Are you sure you want to delete this project? This cannot be undone.')) {\n      return\n    }\n\n    try {\n      await db.deleteProject(selectedProject.id)\n      onShowToast('Project deleted', 'success')\n      handleBack()\n    } catch (error) {\n      console.error('Error deleting project:', error)\n      onShowToast('Error deleting project', 'error')\n    }\n  }\n\n  // Memoize selected project data lookup to avoid repeated finds\n  // NOTE: All hooks must be before any conditional returns (React rules of hooks)\n  const projectData = useMemo(() => {\n    if (!selectedProject) return null\n    return projectsData.find(p => p.id === selectedProject.id)\n  }, [selectedProject, projectsData])\n\n  // Memoize progress calculations - these are expensive and only change when areas change\n  const progressCalculations = useMemo(() => {\n    if (!selectedProject) {\n      return { progress: 0, billable: 0, isValueBased: false, earnedValue: 0, totalSOVValue: 0, changeOrderValue: 0, revisedContractValue: 0 }\n    }\n\n    // Calculate progress - use SOV values if available\n    const progressData = calculateValueProgress(areas)\n    const progress = progressData.progress\n\n    // Get change order data from enhanced project data\n    const changeOrderValue = projectData?.changeOrderValue || 0\n    const revisedContractValue = selectedProject.contract_value + changeOrderValue\n\n    // Billable: use actual earned value from SOV if available\n    const billable = progressData.isValueBased\n      ? progressData.earnedValue\n      : (progress / 100) * revisedContractValue\n\n    return {\n      progress,\n      billable,\n      changeOrderValue,\n      revisedContractValue,\n      isValueBased: progressData.isValueBased,\n      earnedValue: progressData.earnedValue,\n      totalSOVValue: progressData.totalValue\n    }\n  }, [selectedProject, areas, projectData])\n\n  // Memoize portfolio-level metrics to avoid recalculating on every render\n  // These only change when projectsData changes (after data loads or real-time updates)\n  const portfolioMetrics = useMemo(() => {\n    const totalOriginalContract = projectsData.reduce((sum, p) => sum + (p.contract_value || 0), 0)\n    const totalChangeOrders = projectsData.reduce((sum, p) => sum + (p.changeOrderValue || 0), 0)\n    const totalPortfolioValue = totalOriginalContract + totalChangeOrders\n    const totalEarned = projectsData.reduce((sum, p) => sum + (p.billable || 0), 0)\n    const totalRemaining = totalPortfolioValue - totalEarned\n\n    // Weighted completion (by contract value, not simple average)\n    const weightedCompletion = totalPortfolioValue > 0\n      ? Math.round((totalEarned / totalPortfolioValue) * 100)\n      : 0\n\n    // Pending COR metrics (unapproved extra work value)\n    const totalPendingCORValue = projectsData.reduce((sum, p) => sum + (p.corPendingValue || 0), 0)\n    const totalPendingCORCount = projectsData.reduce((sum, p) => sum + (p.corPendingCount || 0), 0)\n\n    return {\n      totalOriginalContract,\n      totalChangeOrders,\n      totalPortfolioValue,\n      totalEarned,\n      totalRemaining,\n      weightedCompletion,\n      totalPendingCORValue,\n      totalPendingCORCount\n    }\n  }, [projectsData])\n\n  // Memoize project health breakdown separately (still derived from projectsData)\n  // Single pass through array instead of 5 separate filter operations\n  const projectHealth = useMemo(() => {\n    let complete = 0\n    let onTrack = 0\n    let atRisk = 0\n    let overBudget = 0\n    let withChangeOrders = 0\n\n    for (const p of projectsData) {\n      const contractVal = p.revisedContractValue || p.contract_value\n      if (p.progress >= 100) complete++\n      if (p.progress < 100 && p.billable <= contractVal * (p.progress / 100) * 1.1) onTrack++\n      if (p.billable > contractVal * 0.9 && p.progress < 90) atRisk++\n      if (p.billable > contractVal) overBudget++\n      if ((p.changeOrderValue || 0) > 0) withChangeOrders++\n    }\n\n    return {\n      projectsComplete: complete,\n      projectsOnTrack: onTrack,\n      projectsAtRisk: atRisk,\n      projectsOverBudget: overBudget,\n      projectsWithChangeOrders: withChangeOrders\n    }\n  }, [projectsData])\n\n  // Memoize schedule performance metrics\n  const scheduleMetrics = useMemo(() => {\n    let ahead = 0\n    let onTrack = 0\n    let behind = 0\n    let overLabor = 0\n    let underLabor = 0\n    let onTrackLabor = 0\n\n    for (const p of projectsData) {\n      if (p.hasScheduleData) {\n        if (p.scheduleStatus === 'ahead') ahead++\n        else if (p.scheduleStatus === 'behind') behind++\n        else onTrack++\n      }\n      if (p.hasLaborData) {\n        if (p.laborStatus === 'over') overLabor++\n        else if (p.laborStatus === 'under') underLabor++\n        else onTrackLabor++\n      }\n    }\n\n    return {\n      scheduleAhead: ahead,\n      scheduleOnTrack: onTrack,\n      scheduleBehind: behind,\n      laborOver: overLabor,\n      laborUnder: underLabor,\n      laborOnTrack: onTrackLabor,\n      hasAnyScheduleData: ahead + onTrack + behind > 0,\n      hasAnyLaborData: overLabor + underLabor + onTrackLabor > 0\n    }\n  }, [projectsData])\n\n  // Calculate risk scores and smart alerts for all projects\n  const riskAnalysis = useMemo(() => {\n    const projectRisks = projectsData.map(p => {\n      // Map project data to risk calculation format\n      const riskInput = {\n        id: p.id,\n        name: p.name,\n        totalCosts: p.totalCosts || 0,\n        earnedRevenue: p.billable || 0,\n        actualProgress: p.progress || 0,\n        expectedProgress: p.expectedProgress || p.progress, // Use actual if no planned\n        pendingCORValue: p.corPendingValue || 0,\n        contractValue: p.revisedContractValue || p.contract_value || 0,\n        lastReportDate: p.lastDailyReport,\n        recentInjuryCount: p.recentInjuryCount || 0,\n        startDate: p.start_date\n      }\n\n      const riskResult = calculateRiskScore(riskInput)\n      const alerts = generateSmartAlerts(riskResult, { ...riskInput, name: p.name })\n      const projections = calculateProjections(riskInput)\n\n      // Add project name to each alert\n      const alertsWithProject = alerts.map(a => ({\n        ...a,\n        projectName: p.name,\n        projectId: p.id\n      }))\n\n      return {\n        projectId: p.id,\n        projectName: p.name,\n        riskScore: riskResult.score,\n        riskStatus: riskResult.status,\n        riskLabel: riskResult.label,\n        factors: riskResult.factors,\n        alerts: alertsWithProject,\n        projections\n      }\n    })\n\n    // Aggregate all alerts across projects, sorted by priority\n    const allAlerts = projectRisks\n      .flatMap(p => p.alerts)\n      .sort((a, b) => {\n        const priority = { critical: 0, warning: 1, info: 2 }\n        return priority[a.type] - priority[b.type]\n      })\n\n    return {\n      projectRisks,\n      allAlerts,\n      criticalCount: allAlerts.filter(a => a.type === 'critical').length,\n      warningCount: allAlerts.filter(a => a.type === 'warning').length\n    }\n  }, [projectsData])\n\n  // Handler for alert actions\n  const handleAlertAction = useCallback(({ target, projectId, alert }) => {\n    const project = projects.find(p => p.id === projectId)\n    if (project) {\n      setSelectedProject(project)\n      // Navigate to appropriate tab based on action target\n      if (target === 'financials') {\n        setActiveProjectTab('financials')\n      } else if (target === 'reports') {\n        setActiveProjectTab('reports')\n      } else if (target === 'cors') {\n        setActiveProjectTab('financials')\n        setFinancialsSection('cors')\n      } else {\n        setActiveProjectTab('overview')\n      }\n    }\n  }, [projects])\n\n  // Auto-archive projects that have been complete for 30+ days\n  useEffect(() => {\n    const checkAutoArchive = async () => {\n      for (const project of projectsData) {\n        if (shouldAutoArchive(project, 30)) {\n          try {\n            await db.archiveProject(project.id)\n            onShowToast(`Project \"${project.name}\" has been auto-archived after 30 days of completion`, 'info')\n          } catch (error) {\n            console.error('Failed to auto-archive project:', error)\n          }\n        }\n      }\n    }\n\n    if (projectsData.length > 0) {\n      checkAutoArchive()\n    }\n  }, []) // Only run on mount\n\n  // Memoized callbacks for child components to prevent unnecessary re-renders\n  const handleAddEquipment = useCallback(() => {\n    setEditingEquipment(null)\n    setShowEquipmentModal(true)\n  }, [])\n\n  const handleEditEquipment = useCallback((item) => {\n    setEditingEquipment(item)\n    setShowEquipmentModal(true)\n  }, [])\n\n  const handleCreateDraw = useCallback(() => {\n    setEditingDrawRequest(null)\n    setShowDrawRequestModal(true)\n  }, [])\n\n  const handleViewDraw = useCallback((drawRequest) => {\n    setEditingDrawRequest(drawRequest)\n    setShowDrawRequestModal(true)\n  }, [])\n\n  const handleViewAllTickets = useCallback(() => {\n    setTMViewMode('full')\n  }, [])\n\n  const handleToggleFinancialsSidebar = useCallback(() => {\n    setFinancialsSidebarCollapsed(prev => !prev)\n  }, [])\n\n  const handleToggleMobileSidebar = useCallback(() => {\n    setFinancialsSidebarMobileOpen(prev => !prev)\n  }, [])\n\n  const handleCloseMobileSidebar = useCallback(() => {\n    setFinancialsSidebarMobileOpen(false)\n  }, [])\n\n  const handleToggleCORList = useCallback(() => {\n    setCORListExpanded(prev => !prev)\n  }, [])\n\n  // Field document export handler\n  const handleExportFieldDocuments = useCallback(async (type = 'all') => {\n    if (!selectedProject) return\n    onShowToast('Gathering field data...', 'info')\n    try {\n      const [dailyReports, injuryReports, crewCheckins] = await Promise.all([\n        db.getDailyReports(selectedProject.id, 365),\n        db.getInjuryReports(selectedProject.id),\n        db.getCrewCheckinHistory(selectedProject.id, 365)\n      ])\n\n      if (type === 'daily') {\n        await exportDailyReportsPDF(dailyReports || [], selectedProject)\n      } else if (type === 'incidents') {\n        await exportIncidentReportsPDF(injuryReports || [], selectedProject)\n      } else if (type === 'crew') {\n        await exportCrewCheckinsPDF(crewCheckins || [], selectedProject)\n      } else {\n        await exportAllFieldDocumentsPDF({\n          dailyReports: dailyReports || [],\n          incidentReports: injuryReports || [],\n          crewCheckins: crewCheckins || [],\n          project: selectedProject\n        })\n      }\n      onShowToast('PDF exported!', 'success')\n    } catch (error) {\n      console.error('Error exporting field documents:', error)\n      onShowToast('Error generating PDF', 'error')\n    }\n  }, [selectedProject, onShowToast])\n\n  const handleBackToTMPreview = useCallback(() => {\n    setTMViewMode('preview')\n  }, [])\n\n  const handleViewFullCORLog = useCallback(() => {\n    setCORDisplayMode('log')\n  }, [])\n\n  const handleCreateCOR = useCallback(() => {\n    setEditingCOR(null)\n    setShowCORForm(true)\n  }, [])\n\n  const handleViewCOR = useCallback((cor) => {\n    setViewingCOR(cor)\n    setShowCORDetail(true)\n  }, [])\n\n  const handleEditCOR = useCallback((cor) => {\n    setEditingCOR(cor)\n    setShowCORForm(true)\n  }, [])\n\n  const handleAddCost = useCallback(() => {\n    setShowAddCostModal(true)\n  }, [])\n\n  const handleDeleteCost = useCallback(async (costId) => {\n    try {\n      await db.deleteProjectCost(costId)\n      loadProjects()\n      onShowToast?.('Cost deleted', 'success')\n    } catch (err) {\n      onShowToast?.('Error deleting cost', 'error')\n    }\n  }, []) // onShowToast is stable (memoized in App.jsx)\n\n  // Memoize stats for FinancialsNav to prevent re-renders from inline object creation\n  const financialsNavStats = useMemo(() => ({\n    corCount: projectData?.corStats?.total || 0,\n    ticketCount: projectData?.totalTickets || 0,\n    corPending: projectData?.corStats?.pending || 0,\n    ticketPending: projectData?.pendingTickets || 0\n  }), [projectData?.corStats?.total, projectData?.totalTickets, projectData?.corStats?.pending, projectData?.pendingTickets])\n\n  // Destructure memoized values for cleaner usage below\n  const { totalOriginalContract, totalChangeOrders, totalPortfolioValue, totalEarned, totalRemaining, weightedCompletion, totalPendingCORValue, totalPendingCORCount } = portfolioMetrics\n  const { projectsComplete, projectsOnTrack, projectsAtRisk, projectsOverBudget, projectsWithChangeOrders } = projectHealth\n  const { scheduleAhead, scheduleOnTrack, scheduleBehind, laborOver, laborUnder, laborOnTrack, hasAnyScheduleData, hasAnyLaborData } = scheduleMetrics\n\n  if (loading) {\n    return (\n      <div className=\"loading\">\n        <div className=\"spinner\"></div>\n        Loading projects...\n      </div>\n    )\n  }\n\n  // Project Detail View\n  if (selectedProject) {\n    // Extract memoized values\n    const { progress, billable, changeOrderValue, revisedContractValue, isValueBased, earnedValue, totalSOVValue } = progressCalculations\n\n    // Edit Mode\n    if (editMode && editData) {\n      const totalWeight = editData.areas.reduce((sum, a) => sum + (parseFloat(a.weight) || 0), 0)\n\n      return (\n        <div>\n          <button className=\"btn btn-secondary btn-small\" onClick={handleCancelEdit} style={{ marginBottom: '1.5rem' }}>\n             Cancel\n          </button>\n\n          <h1>Edit Project</h1>\n          <p className=\"subtitle\">Update project details</p>\n\n          {/* Basic Info */}\n          <div className=\"card\">\n            <h3>Basic Info</h3>\n            <div className=\"form-row\">\n              <div className=\"form-group\" style={{ flex: 2 }}>\n                <label>Project Name *</label>\n                <input\n                  type=\"text\"\n                  value={editData.name}\n                  onChange={(e) => handleEditChange('name', e.target.value)}\n                  placeholder=\"e.g., Downtown Office Demolition\"\n                />\n              </div>\n              <div className=\"form-group\" style={{ flex: 1 }}>\n                <label>Job Number</label>\n                <input\n                  type=\"text\"\n                  value={editData.job_number}\n                  onChange={(e) => handleEditChange('job_number', e.target.value)}\n                  placeholder=\"e.g., 2024-001\"\n                />\n              </div>\n            </div>\n\n            <div className=\"form-group\">\n              <label>Project Address</label>\n              <input\n                type=\"text\"\n                value={editData.address}\n                onChange={(e) => handleEditChange('address', e.target.value)}\n                placeholder=\"123 Main St, City, State 12345\"\n              />\n            </div>\n          </div>\n\n          {/* Client & Contractor Info */}\n          <div className=\"card\">\n            <h3>Client & Contractor</h3>\n            <div className=\"form-group\">\n              <label>General Contractor</label>\n              <input\n                type=\"text\"\n                value={editData.general_contractor}\n                onChange={(e) => handleEditChange('general_contractor', e.target.value)}\n                placeholder=\"e.g., ABC Construction\"\n              />\n            </div>\n\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Client Contact</label>\n                <input\n                  type=\"text\"\n                  value={editData.client_contact}\n                  onChange={(e) => handleEditChange('client_contact', e.target.value)}\n                  placeholder=\"Contact name\"\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Client Phone</label>\n                <input\n                  type=\"tel\"\n                  value={editData.client_phone}\n                  onChange={(e) => handleEditChange('client_phone', e.target.value)}\n                  placeholder=\"(555) 123-4567\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Financial & Project Settings */}\n          <div className=\"card\">\n            <h3>Financials & Settings</h3>\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Contract Value ($) *</label>\n                <input\n                  type=\"number\"\n                  value={editData.contract_value}\n                  onChange={(e) => handleEditChange('contract_value', e.target.value)}\n                  placeholder=\"0\"\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Foreman PIN</label>\n                <input\n                  type=\"text\"\n                  value={editData.pin}\n                  onChange={(e) => handleEditChange('pin', e.target.value.replace(/\\D/g, '').slice(0, 4))}\n                  placeholder=\"4 digits\"\n                  maxLength={4}\n                />\n                <span className=\"form-hint\">Used for field crew access</span>\n              </div>\n            </div>\n\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Work Type</label>\n                <select\n                  value={editData.work_type}\n                  onChange={(e) => handleEditChange('work_type', e.target.value)}\n                >\n                  <option value=\"demolition\">Demolition</option>\n                  <option value=\"environmental\">Environmental</option>\n                </select>\n                <span className=\"form-hint\">Affects labor rate calculations</span>\n              </div>\n              <div className=\"form-group\">\n                <label>Job Type</label>\n                <select\n                  value={editData.job_type}\n                  onChange={(e) => handleEditChange('job_type', e.target.value)}\n                >\n                  <option value=\"standard\">Standard</option>\n                  <option value=\"prevailing_wage\">Prevailing Wage</option>\n                </select>\n              </div>\n            </div>\n\n            <div className=\"form-group\">\n              <label>Default Dump Site</label>\n              <select\n                value={editData.default_dump_site_id}\n                onChange={(e) => handleEditChange('default_dump_site_id', e.target.value)}\n              >\n                <option value=\"\">-- Select Dump Site --</option>\n                {dumpSites.map(site => (\n                  <option key={site.id} value={site.id}>{site.name}</option>\n                ))}\n              </select>\n              <span className=\"form-hint\">Used for haul-off tracking and cost estimates</span>\n            </div>\n          </div>\n\n          <div className=\"card\">\n            <h3>Areas</h3>\n            <p style={{ color: 'var(--text-secondary)', fontSize: '0.9rem', marginBottom: '1rem' }}>\n              Weights must total 100%.\n            </p>\n\n            {editData.areas.map((area, index) => (\n              <div key={index} className=\"area-row\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Area name\"\n                  value={area.name}\n                  onChange={(e) => handleAreaEditChange(index, 'name', e.target.value)}\n                />\n                <input\n                  type=\"number\"\n                  placeholder=\"%\"\n                  value={area.weight}\n                  onChange={(e) => handleAreaEditChange(index, 'weight', e.target.value)}\n                />\n                <button className=\"remove-btn\" onClick={() => handleRemoveArea(index)}>\n                  \n                </button>\n              </div>\n            ))}\n\n            <div className=\"weight-total\">\n              <span className=\"weight-total-label\">Total Weight:</span>\n              <span className={`weight-total-value ${totalWeight === 100 ? 'valid' : 'invalid'}`}>\n                {totalWeight}%\n              </span>\n            </div>\n\n            <button className=\"btn btn-secondary\" onClick={handleAddArea}>\n              + Add Area\n            </button>\n          </div>\n\n          <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem' }}>\n            <button \n              className=\"btn btn-primary\" \n              onClick={handleSaveEdit}\n              disabled={saving}\n              style={{ flex: 1 }}\n            >\n              {saving ? 'Saving...' : 'Save Changes'}\n            </button>\n          </div>\n\n          <button \n            className=\"btn btn-danger btn-full\" \n            onClick={handleDeleteProject}\n          >\n            Delete Project\n          </button>\n        </div>\n      )\n    }\n\n    // View Mode - Calculate additional metrics for context\n    const areasComplete = areas.filter(a => a.status === 'done').length\n    const areasWorking = areas.filter(a => a.status === 'working').length\n    const areasNotStarted = areas.filter(a => a.status === 'not_started').length\n    const percentBilled = revisedContractValue > 0\n      ? Math.round((billable / revisedContractValue) * 100)\n      : 0\n    const hasChangeOrders = changeOrderValue > 0\n\n    // Tab definitions with pending badges\n    const pendingCount = (projectData?.pendingTickets || 0) + (projectData?.changeOrderPending || 0)\n    const tabs = [\n      { id: 'overview', label: 'Overview', Icon: LayoutGrid },\n      { id: 'financials', label: 'Financials', Icon: DollarSign, badge: pendingCount },\n      { id: 'reports', label: 'Reports', Icon: ClipboardList },\n      { id: 'documents', label: 'Documents', Icon: FolderOpen },\n      { id: 'info', label: 'Info', Icon: Info }\n    ]\n\n    return (\n      <div className=\"project-view tabbed\">\n        {/* Sticky Header */}\n        <div className=\"pv-sticky-header\">\n          {/* Top Row - Back + Actions */}\n          <div className=\"pv-header-row\">\n            <button className=\"pv-back\" onClick={handleBack}>\n              <span></span>\n              <span>Back</span>\n            </button>\n            <div className=\"pv-actions\">\n              <button className=\"pv-action\" onClick={() => setShowShareModal(true)}>Share</button>\n              <button className=\"pv-action\" onClick={() => setShowNotificationSettings(true)}>Alerts</button>\n              <button className=\"pv-action\" onClick={handleEditClick}>Edit</button>\n            </div>\n          </div>\n\n          {/* Project Title */}\n          <div className=\"pv-header-title\">\n            <h1>{selectedProject.name}</h1>\n            {(selectedProject.job_number || selectedProject.work_type) && (\n              <span className=\"pv-header-meta\">\n                {selectedProject.job_number && `Job #${selectedProject.job_number}`}\n                {selectedProject.job_number && selectedProject.work_type && '  '}\n                {selectedProject.work_type}\n              </span>\n            )}\n          </div>\n\n          {/* Key Metrics Bar */}\n          <div className=\"pv-metrics-bar\">\n            <div className=\"pv-metric\">\n              <span className=\"pv-metric-value\">{progress}%</span>\n              <span className=\"pv-metric-label\">Complete</span>\n            </div>\n            <div className=\"pv-metric-divider\"></div>\n            <div className=\"pv-metric\">\n              <span className=\"pv-metric-value\">{formatCurrency(billable)}</span>\n              <span className=\"pv-metric-label\">Billed</span>\n            </div>\n            <div className=\"pv-metric-divider\"></div>\n            <div className=\"pv-metric\">\n              <span className=\"pv-metric-value highlight\">{formatCurrency(revisedContractValue - billable)}</span>\n              <span className=\"pv-metric-label\">Remaining</span>\n            </div>\n          </div>\n\n          {/* Tab Navigation */}\n          <div className=\"pv-tabs\">\n            {tabs.map(tab => (\n              <button\n                key={tab.id}\n                className={`pv-tab ${activeProjectTab === tab.id ? 'active' : ''} ${tab.badge > 0 ? 'has-badge' : ''}`}\n                onClick={() => setActiveProjectTab(tab.id)}\n              >\n                <tab.Icon size={16} className=\"pv-tab-icon\" />\n                <span className=\"pv-tab-label\">{tab.label}</span>\n                {tab.badge > 0 && (\n                  <span className=\"pv-tab-badge\">{tab.badge}</span>\n                )}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Tab Content */}\n        <div className=\"pv-tab-content\">\n          {/* OVERVIEW TAB */}\n          {activeProjectTab === 'overview' && (\n            <div className=\"pv-tab-panel overview-tab animate-fade-in\">\n              {/* Row 1: Hero - Progress + Financials */}\n              <div className=\"overview-hero-split\">\n                <OverviewProgressGauge\n                  progress={progress}\n                  areasComplete={areasComplete}\n                  totalAreas={areas.length}\n                  areasWorking={areasWorking}\n                />\n                <OverviewFinancialCard\n                  earnedRevenue={billable}\n                  totalCosts={projectData?.allCostsTotal || 0}\n                  laborCost={projectData?.laborCost || 0}\n                  disposalCost={projectData?.haulOffCost || 0}\n                  equipmentCost={projectData?.materialsEquipmentCost || 0}\n                  materialsCost={0}\n                  otherCost={projectData?.customCostTotal || 0}\n                  contractValue={revisedContractValue}\n                />\n              </div>\n\n              {/* Row 2: Two-column grid - Crew Metrics | Work Areas */}\n              <div className=\"overview-two-col\">\n                {/* Left: Crew On-Site */}\n                <OverviewCrewMetrics\n                  project={selectedProject}\n                  onShowToast={onShowToast}\n                />\n\n                {/* Right: Work Areas */}\n                <div className=\"overview-section-card overview-work-areas-card\">\n                  <div className=\"section-card-header\">\n                    <h3>Work Areas</h3>\n                    <div className=\"section-card-badges\">\n                      {areasComplete > 0 && <span className=\"section-badge done\">{areasComplete} Done</span>}\n                      {areasWorking > 0 && <span className=\"section-badge working\">{areasWorking} Active</span>}\n                      {areasNotStarted > 0 && <span className=\"section-badge pending\">{areasNotStarted} Pending</span>}\n                    </div>\n                  </div>\n                  <div className=\"work-areas-list work-areas-scroll stagger-areas\">\n                    {areas.map(area => (\n                      <div key={area.id} className={`work-area-item ${area.status}`}>\n                        <div className=\"work-area-status\">\n                          {area.status === 'done' && <span className=\"status-icon done\"></span>}\n                          {area.status === 'working' && <span className=\"status-icon working\"></span>}\n                          {area.status === 'not_started' && <span className=\"status-icon pending\"></span>}\n                        </div>\n                        <div className=\"work-area-info\">\n                          <span className=\"work-area-name\">{area.name}</span>\n                          <span className=\"work-area-weight\">\n                            {area.scheduled_value ? formatCurrency(area.scheduled_value) : `${area.weight}%`}\n                          </span>\n                        </div>\n                        <div className=\"work-area-bar\">\n                          <div\n                            className={`work-area-fill ${area.status}`}\n                            style={{ width: area.status === 'done' ? '100%' : area.status === 'working' ? '50%' : '0%' }}\n                          ></div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              </div>\n\n              {/* Row 3: Bottom strip - Attention + Quick Nav + Exports */}\n              <div className=\"overview-bottom-strip\">\n                {/* Attention items inline */}\n                {(projectData?.pendingTickets > 0 || projectData?.changeOrderPending > 0 || projectData?.pendingMaterialRequests > 0 || projectData?.urgentMaterialRequests > 0) && (\n                  <div className=\"overview-attention-inline\">\n                    {projectData?.urgentMaterialRequests > 0 && (\n                      <div className=\"attention-chip warning\" onClick={() => setActiveProjectTab('reports')}>\n                        <AlertTriangle size={14} />\n                        <span>{projectData.urgentMaterialRequests} urgent material request{projectData.urgentMaterialRequests !== 1 ? 's' : ''}</span>\n                      </div>\n                    )}\n                    {projectData?.pendingMaterialRequests > 0 && !projectData?.urgentMaterialRequests && (\n                      <div className=\"attention-chip info\" onClick={() => setActiveProjectTab('reports')}>\n                        <Package size={14} />\n                        <span>{projectData.pendingMaterialRequests} material request{projectData.pendingMaterialRequests !== 1 ? 's' : ''} pending</span>\n                      </div>\n                    )}\n                    {projectData?.pendingTickets > 0 && (\n                      <div className=\"attention-chip warning\" onClick={() => setActiveProjectTab('financials')}>\n                        <ClipboardList size={14} />\n                        <span>{projectData.pendingTickets} T&M pending</span>\n                      </div>\n                    )}\n                    {projectData?.changeOrderPending > 0 && (\n                      <div className=\"attention-chip info\" onClick={() => setActiveProjectTab('financials')}>\n                        <FileText size={14} />\n                        <span>{projectData.changeOrderPending} CO pending</span>\n                      </div>\n                    )}\n                  </div>\n                )}\n\n                {/* Quick nav + export buttons */}\n                <div className=\"overview-quick-actions\">\n                  <button className=\"overview-action-btn\" onClick={() => setActiveProjectTab('reports')}>\n                    <ClipboardList size={15} />\n                    <span>{projectData?.dailyReportsCount || 0} Reports</span>\n                  </button>\n                  <button className=\"overview-action-btn\" onClick={() => setActiveProjectTab('financials')}>\n                    <DollarSign size={15} />\n                    <span>{projectData?.totalTickets || 0} T&M Tickets</span>\n                  </button>\n                  <span className=\"overview-action-divider\" />\n                  <button className=\"overview-action-btn export\" onClick={() => handleExportFieldDocuments('all')}>\n                    <Download size={15} />\n                    <span>Export All Docs</span>\n                  </button>\n                  <button className=\"overview-action-btn export\" onClick={() => handleExportFieldDocuments('daily')}>\n                    <Download size={14} />\n                    <span>Daily</span>\n                  </button>\n                  <button className=\"overview-action-btn export\" onClick={() => handleExportFieldDocuments('incidents')}>\n                    <Download size={14} />\n                    <span>Incidents</span>\n                  </button>\n                  <button className=\"overview-action-btn export\" onClick={() => handleExportFieldDocuments('crew')}>\n                    <Download size={14} />\n                    <span>Crew</span>\n                  </button>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* FINANCIALS TAB */}\n          {activeProjectTab === 'financials' && (\n            <div className=\"pv-tab-panel financials-tab\">\n              {/* Key Metrics - Hero Section (Always visible) */}\n              <HeroMetrics\n                contractValue={selectedProject?.contract_value || 0}\n                earnedRevenue={billable}\n                totalCosts={projectData?.allCostsTotal || 0}\n                profit={projectData?.currentProfit || 0}\n                progress={progress}\n                corApprovedValue={changeOrderValue}\n                loading={!projectData}\n              />\n\n              {/* Split Layout with Collapsible Navigation */}\n              <div className={`financials-layout ${financialsSidebarCollapsed ? 'sidebar-collapsed' : ''}`}>\n                {/* Mobile Menu Toggle Button */}\n                <button\n                  className=\"financials-mobile-menu-toggle\"\n                  onClick={handleToggleMobileSidebar}\n                  aria-label=\"Open navigation menu\"\n                  title=\"Open navigation menu\"\n                >\n                  <Menu size={20} />\n                  <span>Menu</span>\n                </button>\n\n                {/* Mobile Overlay/Backdrop */}\n                {financialsSidebarMobileOpen && (\n                  <div\n                    className=\"financials-sidebar-overlay\"\n                    onClick={handleCloseMobileSidebar}\n                    aria-hidden=\"true\"\n                  />\n                )}\n\n                {/* Sidebar Navigation - Always visible, collapsible */}\n                <div className={`financials-sidebar ${financialsSidebarCollapsed ? 'collapsed' : ''} ${financialsSidebarMobileOpen ? 'mobile-open' : ''}`}>\n                  <FinancialsNav\n                    activeSection={financialsSection}\n                    onSectionChange={(section) => {\n                      setFinancialsSection(section)\n                      setFinancialsSidebarMobileOpen(false) // Close mobile sidebar when section changes\n                    }}\n                    collapsed={financialsSidebarCollapsed}\n                    onToggleCollapse={handleToggleFinancialsSidebar}\n                    onMobileClose={handleCloseMobileSidebar}\n                    stats={financialsNavStats}\n                  />\n                </div>\n\n                {/* Main Content Area */}\n                <div className=\"financials-main\">\n                  {/* OVERVIEW SECTION */}\n                  {financialsSection === 'overview' && (\n                    <div className=\"financials-overview animate-fade-in\">\n                      {/* Financial Trend Chart */}\n                      <FinancialTrendChart\n                        projectData={projectData}\n                        project={selectedProject}\n                        tmTickets={projectData?.tmTickets || []}\n                        corStats={projectData?.corStats}\n                        areas={areas}\n                      />\n\n                      {/* Burn Rate & Profitability Row */}\n                      <div className=\"financials-analysis-row stagger-children\">\n                        <BurnRateCard\n                          dailyBurn={projectData?.dailyBurn || 0}\n                          totalBurn={projectData?.totalBurn || 0}\n                          daysWorked={projectData?.totalBurnDays || 0}\n                          laborCost={projectData?.laborCost || 0}\n                          materialsEquipmentCost={projectData?.materialsEquipmentCost || 0}\n                          progress={progress}\n                          contractValue={revisedContractValue}\n                          laborByDate={projectData?.laborByDate || []}\n                          materialsEquipmentByDate={projectData?.materialsEquipmentByDate || []}\n                        />\n\n                        <ProfitabilityCard\n                          revenue={billable}\n                          totalCosts={projectData?.allCostsTotal || 0}\n                          contractValue={revisedContractValue}\n                          progress={progress}\n                        />\n                      </div>\n\n                      {/* Cost Contributors & Disposal Summary Side-by-Side */}\n                      <div className=\"cost-disposal-row\">\n                        <CostContributorsCard\n                          laborCost={projectData?.laborCost || 0}\n                          haulOffCost={projectData?.haulOffCost || 0}\n                          customCosts={projectData?.customCosts || []}\n                          onAddCost={handleAddCost}\n                          onDeleteCost={handleDeleteCost}\n                        />\n\n                        <DisposalSummary\n                          project={selectedProject}\n                          period=\"week\"\n                        />\n                      </div>\n\n                      {/* Equipment Tracking */}\n                      <ProjectEquipmentCard\n                        key={equipmentRefreshKey}\n                        project={selectedProject}\n                        onAddEquipment={handleAddEquipment}\n                        onEditEquipment={handleEditEquipment}\n                        onShowToast={onShowToast}\n                      />\n\n                      {/* Progress Billing / Draw Requests */}\n                      <ProgressBillingCard\n                        key={drawRequestRefreshKey}\n                        project={selectedProject}\n                        areas={areas}\n                        corStats={projectData?.corStats}\n                        onCreateDraw={handleCreateDraw}\n                        onViewDraw={handleViewDraw}\n                        onShowToast={onShowToast}\n                      />\n\n                      {/* Labor Details - Collapsible */}\n                      <details className=\"financials-details\">\n                        <summary className=\"financials-details-summary\">\n                          <HardHat size={16} />\n                          <span>Labor Details</span>\n                          <span className=\"financials-details-value\">{formatCurrency(projectData?.laborCost || 0)}</span>\n                        </summary>\n                        <div className=\"financials-details-content\">\n                          <ManDayCosts project={selectedProject} company={company} onShowToast={onShowToast} />\n                        </div>\n                      </details>\n                    </div>\n                  )}\n\n                  {/* CHANGE ORDERS SECTION */}\n                  {financialsSection === 'cors' && (\n                    <div className=\"financials-cors animate-fade-in\">\n                      {/* COR Log - Always visible first */}\n                      <div className=\"financials-section cor-section-primary\">\n                        <Suspense fallback={<TicketSkeleton />}>\n                          <CORLogPreview\n                            project={selectedProject}\n                            onShowToast={onShowToast}\n                            onToggleList={handleToggleCORList}\n                            showingList={corListExpanded}\n                            onViewFullLog={handleViewFullCORLog}\n                            onCreateCOR={handleCreateCOR}\n                          />\n                        </Suspense>\n                      </div>\n\n                      {/* Full COR Card List - Expands below the log when toggled */}\n                      {corListExpanded && (\n                        <div className=\"financials-section cor-section-list animate-fade-in\" style={{ marginTop: '1rem' }}>\n                          <Suspense fallback={<TicketSkeleton />}>\n                            <CORList\n                              project={selectedProject}\n                              company={company}\n                              areas={areas}\n                              refreshKey={corRefreshKey}\n                              onShowToast={onShowToast}\n                              previewMode={false}\n                              onViewAll={handleToggleCORList}\n                              onDisplayModeChange={setCORDisplayMode}\n                              onCreateCOR={handleCreateCOR}\n                              onViewCOR={handleViewCOR}\n                              onEditCOR={handleEditCOR}\n                            />\n                          </Suspense>\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {/* T&M TICKETS SECTION */}\n                  {financialsSection === 'tickets' && (\n                    <div className=\"financials-tickets animate-fade-in\">\n                      <div className=\"financials-section tm-section\">\n                        {tmViewMode === 'full' && (\n                          <button\n                            className=\"section-back-btn\"\n                            onClick={handleBackToTMPreview}\n                          >\n                             Back to summary\n                          </button>\n                        )}\n                        <Suspense fallback={<TicketSkeleton />}>\n                          <TMList\n                            project={selectedProject}\n                            company={company}\n                            onShowToast={onShowToast}\n                            compact={tmViewMode === 'preview'}\n                            previewMode={tmViewMode === 'preview'}\n                            onViewAll={handleViewAllTickets}\n                          />\n                        </Suspense>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* BILLING SECTION */}\n                  {financialsSection === 'billing' && (\n                    <div className=\"financials-billing animate-fade-in\">\n                      <Suspense fallback={<TicketSkeleton />}>\n                        <BillingCenter\n                          project={selectedProject}\n                          company={company}\n                          user={user}\n                          onShowToast={onShowToast}\n                        />\n                      </Suspense>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* REPORTS TAB */}\n          {activeProjectTab === 'reports' && (\n            <div className=\"pv-tab-panel reports-tab\">\n              {/* Hero Metrics - High Level Project Pulse */}\n              <div className=\"reports-hero\">\n                <div className=\"reports-hero-grid\">\n                  {/* Total Reports */}\n                  <div className=\"reports-metric primary\">\n                    <div className=\"reports-metric-icon\">\n                      <ClipboardList size={24} />\n                    </div>\n                    <div className=\"reports-metric-content\">\n                      <div className=\"reports-metric-value\">{projectData?.dailyReportsCount || 0}</div>\n                      <div className=\"reports-metric-label\">Daily Reports</div>\n                    </div>\n                  </div>\n\n                  {/* This Week */}\n                  <div className=\"reports-metric\">\n                    <div className=\"reports-metric-value\">{projectData?.recentDailyReports || 0}</div>\n                    <div className=\"reports-metric-label\">This Week</div>\n                    <div className=\"reports-metric-bar\">\n                      <div\n                        className=\"reports-metric-fill\"\n                        style={{ width: `${Math.min((projectData?.recentDailyReports || 0) / 7 * 100, 100)}%` }}\n                      ></div>\n                    </div>\n                  </div>\n\n                  {/* T&M Tickets */}\n                  <div className=\"reports-metric\">\n                    <div className=\"reports-metric-value\">{projectData?.totalTickets || 0}</div>\n                    <div className=\"reports-metric-label\">T&M Tickets</div>\n                    {(projectData?.pendingTickets || 0) > 0 && (\n                      <div className=\"reports-metric-status\" style={{ background: '#fef3c7', color: '#92400e' }}>\n                        {projectData.pendingTickets} pending\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Photo Evidence */}\n                  <div className=\"reports-metric\">\n                    <div className=\"reports-metric-value\">{projectData?.totalPhotosFromTickets || 0}</div>\n                    <div className=\"reports-metric-label\">Photos Captured</div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Two-Column Layout: Crew + Safety */}\n              <div className=\"reports-two-col\">\n                {/* Crew Analytics Card */}\n                <div className=\"reports-insight-card\">\n                  <div className=\"reports-insight-header\">\n                    <div className=\"reports-insight-title\">\n                      <Users size={18} />\n                      <h3>Crew Analytics</h3>\n                    </div>\n                  </div>\n                  <div className=\"reports-insight-body\">\n                    <div className=\"reports-stat-grid\">\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.uniqueWorkerCount || 0}</span>\n                        <span className=\"reports-stat-label\">Total Workers</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.avgCrewSize || 0}</span>\n                        <span className=\"reports-stat-label\">Avg Crew / Day</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.peakCrewSize || 0}</span>\n                        <span className=\"reports-stat-label\">Peak Crew Size</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.crewDaysTracked || 0}</span>\n                        <span className=\"reports-stat-label\">Days Tracked</span>\n                      </div>\n                    </div>\n                    {(projectData?.crewTrend || 0) !== 0 && (\n                      <div className={`reports-trend-badge ${projectData.crewTrend > 0 ? 'up' : 'down'}`}>\n                        {projectData.crewTrend > 0 ? <TrendingUp size={14} /> : <TrendingDown size={14} />}\n                        <span>{Math.abs(Math.round(projectData.crewTrend))}% {projectData.crewTrend > 0 ? 'increase' : 'decrease'} vs prior week</span>\n                      </div>\n                    )}\n                    {/* Mini crew size bar chart */}\n                    {projectData?.crewByDate && Object.keys(projectData.crewByDate).length > 0 && (\n                      <div className=\"reports-mini-chart\">\n                        <div className=\"reports-mini-chart-label\">Recent Crew Size</div>\n                        <div className=\"reports-mini-bars\">\n                          {Object.keys(projectData.crewByDate).sort().slice(-14).map(date => {\n                            const count = projectData.crewByDate[date]\n                            const max = projectData.peakCrewSize || 1\n                            return (\n                              <div key={date} className=\"reports-mini-bar-wrap\" title={`${new Date(date + 'T12:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}: ${count} workers`}>\n                                <div className=\"reports-mini-bar\" style={{ height: `${(count / max) * 100}%` }}></div>\n                              </div>\n                            )\n                          })}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Safety Dashboard Card */}\n                <div className=\"reports-insight-card\">\n                  <div className=\"reports-insight-header\">\n                    <div className=\"reports-insight-title\">\n                      <Shield size={18} />\n                      <h3>Safety Dashboard</h3>\n                    </div>\n                    <span className={`reports-section-badge ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n                      {(projectData?.injuryReportsCount || 0) > 0\n                        ? `${projectData.injuryReportsCount} incident${projectData.injuryReportsCount !== 1 ? 's' : ''}`\n                        : 'No incidents'\n                      }\n                    </span>\n                  </div>\n                  <div className=\"reports-insight-body\">\n                    {/* Days Since Last Injury - prominent */}\n                    <div className=\"reports-safety-hero\">\n                      <div className={`reports-safety-days ${(projectData?.daysSinceLastInjury === null || projectData?.daysSinceLastInjury > 30) ? 'excellent' : projectData?.daysSinceLastInjury > 7 ? 'good' : 'caution'}`}>\n                        <span className=\"reports-safety-days-value\">\n                          {projectData?.daysSinceLastInjury !== null ? projectData.daysSinceLastInjury : '--'}\n                        </span>\n                        <span className=\"reports-safety-days-label\">\n                          {projectData?.daysSinceLastInjury !== null ? 'Days Since Last Incident' : 'No Incidents Recorded'}\n                        </span>\n                      </div>\n                    </div>\n                    <div className=\"reports-stat-grid\">\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.injuryReportsCount || 0}</span>\n                        <span className=\"reports-stat-label\">Total Incidents</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.oshaRecordable || 0}</span>\n                        <span className=\"reports-stat-label\">OSHA Recordable</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.reportsWithIssues || 0}</span>\n                        <span className=\"reports-stat-label\">Reports w/ Issues</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.laborManDays || 0}</span>\n                        <span className=\"reports-stat-label\">Total Man-Days</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Material Requests + Disposal Summary Row */}\n              <div className=\"reports-two-col\">\n                {/* Material Requests */}\n                <div className=\"reports-insight-card\">\n                  <div className=\"reports-insight-header\">\n                    <div className=\"reports-insight-title\">\n                      <Package size={18} />\n                      <h3>Material Requests</h3>\n                    </div>\n                    <span className=\"reports-section-count\">{projectData?.totalMaterialRequests || 0} total</span>\n                  </div>\n                  <div className=\"reports-insight-body\">\n                    {(projectData?.totalMaterialRequests || 0) === 0 ? (\n                      <div className=\"reports-empty-state\">\n                        <Package size={32} />\n                        <p>No material requests yet</p>\n                        <span>Requests from the field will appear here</span>\n                      </div>\n                    ) : (\n                      <>\n                        <div className=\"reports-material-pipeline\">\n                          {projectData?.urgentMaterialRequests > 0 && (\n                            <div className=\"reports-material-status urgent\">\n                              <AlertTriangle size={14} />\n                              <span>{projectData.urgentMaterialRequests} Urgent</span>\n                            </div>\n                          )}\n                          <div className=\"reports-material-status pending\">\n                            <span className=\"reports-material-dot\"></span>\n                            <span>{projectData?.pendingMaterialRequests || 0} Pending</span>\n                          </div>\n                          <div className=\"reports-material-status ordered\">\n                            <span className=\"reports-material-dot\"></span>\n                            <span>{projectData?.orderedMaterialRequests || 0} Ordered</span>\n                          </div>\n                          <div className=\"reports-material-status delivered\">\n                            <CheckCircle2 size={14} />\n                            <span>{projectData?.deliveredMaterialRequests || 0} Delivered</span>\n                          </div>\n                        </div>\n                        {/* Recent requests */}\n                        <div className=\"reports-recent-list\">\n                          {(projectData?.materialRequests || []).slice(0, 3).map(req => (\n                            <div key={req.id} className={`reports-recent-item ${req.status}`}>\n                              <div className=\"reports-recent-item-main\">\n                                <span className={`reports-recent-item-status ${req.status}`}>{req.status}</span>\n                                <span className=\"reports-recent-item-date\">\n                                  {new Date(req.created_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                                </span>\n                              </div>\n                              <div className=\"reports-recent-item-detail\">\n                                {(req.items || []).slice(0, 2).map((item, i) => (\n                                  <span key={i}>{item.name}{item.quantity ? ` (${item.quantity})` : ''}</span>\n                                ))}\n                                {(req.items || []).length > 2 && (\n                                  <span className=\"reports-recent-more\">+{(req.items || []).length - 2} more</span>\n                                )}\n                              </div>\n                              {req.priority === 'urgent' && (\n                                <span className=\"reports-urgent-tag\">URGENT</span>\n                              )}\n                            </div>\n                          ))}\n                        </div>\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                {/* Disposal Trends */}\n                <div className=\"reports-insight-card\">\n                  <div className=\"reports-insight-header\">\n                    <div className=\"reports-insight-title\">\n                      <Truck size={18} />\n                      <h3>Disposal Trends</h3>\n                    </div>\n                    <span className=\"reports-section-count\">{projectData?.disposalTotalLoads || 0} loads</span>\n                  </div>\n                  <div className=\"reports-insight-body\">\n                    {(projectData?.weeklyDisposal || []).length === 0 ? (\n                      <div className=\"reports-empty-state\">\n                        <Truck size={32} />\n                        <p>No disposal data yet</p>\n                        <span>Disposal loads from the field will appear here</span>\n                      </div>\n                    ) : (\n                      <>\n                        {/* Stacked weekly bar chart */}\n                        <div className=\"reports-disposal-chart\">\n                          <div className=\"reports-disposal-bars\">\n                            {(projectData?.weeklyDisposal || []).map((week, i) => {\n                              const total = (week.concrete || 0) + (week.trash || 0) + (week.metals || 0) + (week.hazardous_waste || 0)\n                              const maxWeek = Math.max(...(projectData?.weeklyDisposal || []).map(w => (w.concrete || 0) + (w.trash || 0) + (w.metals || 0) + (w.hazardous_waste || 0))) || 1\n                              return (\n                                <div key={i} className=\"reports-disposal-bar-col\">\n                                  <div className=\"reports-disposal-bar-stack\" style={{ height: `${(total / maxWeek) * 100}%` }}>\n                                    {week.concrete > 0 && <div className=\"reports-disposal-seg concrete\" style={{ flex: week.concrete }} title={`Concrete: ${week.concrete}`}></div>}\n                                    {week.trash > 0 && <div className=\"reports-disposal-seg trash\" style={{ flex: week.trash }} title={`Trash: ${week.trash}`}></div>}\n                                    {week.metals > 0 && <div className=\"reports-disposal-seg metals\" style={{ flex: week.metals }} title={`Metals: ${week.metals}`}></div>}\n                                    {week.hazardous_waste > 0 && <div className=\"reports-disposal-seg hazardous\" style={{ flex: week.hazardous_waste }} title={`Hazardous: ${week.hazardous_waste}`}></div>}\n                                  </div>\n                                  <span className=\"reports-disposal-bar-label\">\n                                    {new Date(week.week + 'T12:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                                  </span>\n                                </div>\n                              )\n                            })}\n                          </div>\n                          <div className=\"reports-disposal-legend\">\n                            <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot concrete\"></span>Concrete</span>\n                            <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot trash\"></span>Trash</span>\n                            <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot metals\"></span>Metals</span>\n                            <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot hazardous\"></span>Hazardous</span>\n                          </div>\n                        </div>\n                        {/* Haul-off cost summary */}\n                        {(projectData?.haulOffCost || 0) > 0 && (\n                          <div className=\"reports-disposal-cost\">\n                            <span>Total Disposal Cost</span>\n                            <strong>{formatCurrency(projectData.haulOffCost)}</strong>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n              </div>\n\n              {/* Field Activity Summary */}\n              <div className=\"reports-insight-card reports-activity-summary\">\n                <div className=\"reports-insight-header\">\n                  <div className=\"reports-insight-title\">\n                    <ClipboardList size={18} />\n                    <h3>Field Activity Summary</h3>\n                  </div>\n                  <div className=\"reports-activity-badges\">\n                    {projectData?.lastDailyReport && (\n                      <span className=\"reports-last-filed\">\n                        Last report: {new Date(projectData.lastDailyReport).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                        {' '}({Math.floor((new Date() - new Date(projectData.lastDailyReport)) / (1000 * 60 * 60 * 24))}d ago)\n                      </span>\n                    )}\n                  </div>\n                </div>\n                <div className=\"reports-insight-body\">\n                  <div className=\"reports-activity-grid\">\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><ClipboardList size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.dailyReportsCount || 0}</strong>\n                        <span>Daily Reports Filed</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><FileText size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.totalTickets || 0}</strong>\n                        <span>T&M Tickets Created</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><Camera size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.totalPhotosFromTickets || 0}</strong>\n                        <span>Photos Documented</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><HardHat size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.completedAreasCount || 0}/{areas.length}</strong>\n                        <span>Work Areas Complete</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><DollarSign size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{formatCurrency(projectData?.allCostsTotal || 0)}</strong>\n                        <span>Total Costs Tracked</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><Users size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.laborManDays || 0}</strong>\n                        <span>Total Man-Days</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Daily Reports Section */}\n              <div className=\"reports-section-card\">\n                <div className=\"reports-section-header\">\n                  <div className=\"reports-section-title\">\n                    <ClipboardList size={18} />\n                    <h3>Daily Reports</h3>\n                  </div>\n                  <span className=\"reports-section-count\">{projectData?.dailyReportsCount || 0} total</span>\n                </div>\n                <div className=\"reports-section-content\">\n                  <Suspense fallback={<TicketSkeleton />}>\n                    <DailyReportsList project={selectedProject} company={company} onShowToast={onShowToast} />\n                  </Suspense>\n                </div>\n              </div>\n\n              {/* Injury Reports Section */}\n              <div className={`reports-section-card ${(projectData?.injuryReportsCount || 0) > 0 ? 'has-warning' : ''}`}>\n                <div className=\"reports-section-header\">\n                  <div className=\"reports-section-title\">\n                    <span className={`reports-section-icon ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n                      {(projectData?.injuryReportsCount || 0) > 0 ? '' : ''}\n                    </span>\n                    <h3>Safety & Injury Reports</h3>\n                  </div>\n                  <span className={`reports-section-badge ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n                    {(projectData?.injuryReportsCount || 0) > 0\n                      ? `${projectData.injuryReportsCount} incident${projectData.injuryReportsCount !== 1 ? 's' : ''}`\n                      : 'No incidents'\n                    }\n                  </span>\n                </div>\n                <div className=\"reports-section-content\">\n                  <Suspense fallback={<TicketSkeleton />}>\n                    <InjuryReportsList\n                      project={selectedProject}\n                      companyId={company?.id || selectedProject?.company_id}\n                      company={company}\n                      user={user}\n                      onShowToast={onShowToast}\n                    />\n                  </Suspense>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* DOCUMENTS TAB */}\n          {activeProjectTab === 'documents' && (\n            <div className=\"pv-tab-panel documents-tab\">\n              <Suspense fallback={<TicketSkeleton />}>\n                <DocumentsTab\n                  project={selectedProject}\n                  companyId={company?.id || selectedProject?.company_id}\n                  onShowToast={onShowToast}\n                  userRole={user?.access_level || 'office'}\n                />\n              </Suspense>\n            </div>\n          )}\n\n          {/* INFO TAB */}\n          {activeProjectTab === 'info' && (\n            <div className=\"pv-tab-panel info-tab\">\n              {/* Hero Header */}\n              <div className=\"info-hero\">\n                <div className=\"info-hero-content\">\n                  <div className=\"info-hero-main\">\n                    <h2 className=\"info-hero-title\">{selectedProject.name}</h2>\n                    {selectedProject.job_number && (\n                      <span className=\"info-hero-job\">Job #{selectedProject.job_number}</span>\n                    )}\n                  </div>\n                  <button className=\"btn btn-primary btn-with-icon\" onClick={handleEditClick}>\n                    <span>Edit Project</span>\n                  </button>\n                </div>\n                {selectedProject.address && (\n                  <div className=\"info-hero-address\">\n                    <MapPin size={14} />\n                    <span>{selectedProject.address}</span>\n                  </div>\n                )}\n              </div>\n\n              {/* Quick Info Cards */}\n              <div className=\"info-quick-grid\">\n                {/* Work Type */}\n                <div className=\"info-quick-card\">\n                  <div className=\"info-quick-icon\">\n                    <HardHat size={20} />\n                  </div>\n                  <div className=\"info-quick-content\">\n                    <span className=\"info-quick-value\">\n                      {selectedProject.work_type === 'environmental' ? 'Environmental' : 'Demolition'}\n                    </span>\n                    <span className=\"info-quick-label\">Work Type</span>\n                  </div>\n                </div>\n\n                {/* Job Type */}\n                <div className=\"info-quick-card\">\n                  <div className=\"info-quick-icon\">\n                    <FileText size={20} />\n                  </div>\n                  <div className=\"info-quick-content\">\n                    <span className=\"info-quick-value\">\n                      {selectedProject.job_type === 'prevailing_wage' ? 'Prevailing Wage' : 'Standard'}\n                    </span>\n                    <span className=\"info-quick-label\">Job Type</span>\n                  </div>\n                </div>\n\n                {/* Contract Value */}\n                <div className=\"info-quick-card highlight\">\n                  <div className=\"info-quick-icon\">\n                    <DollarSign size={20} />\n                  </div>\n                  <div className=\"info-quick-content\">\n                    <span className=\"info-quick-value\">{formatCurrency(revisedContractValue)}</span>\n                    <span className=\"info-quick-label\">\n                      {changeOrderValue > 0 ? `Incl. +${formatCurrency(changeOrderValue)} COs` : 'Contract Value'}\n                    </span>\n                  </div>\n                </div>\n\n                {/* Foreman PIN */}\n                {selectedProject.pin && (\n                  <div className=\"info-quick-card\">\n                    <div className=\"info-quick-icon\">\n                      <span className=\"info-pin-icon\">#</span>\n                    </div>\n                    <div className=\"info-quick-content\">\n                      <span className=\"info-quick-value mono\">{selectedProject.pin}</span>\n                      <span className=\"info-quick-label\">Foreman PIN</span>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Client & Contractor Card */}\n              <div className=\"info-section-card\">\n                <div className=\"info-section-header\">\n                  <Building2 size={18} />\n                  <h3>Client & Contractor</h3>\n                </div>\n                <div className=\"info-section-content\">\n                  {selectedProject.general_contractor ? (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">General Contractor</span>\n                      <span className=\"info-detail-value\">{selectedProject.general_contractor}</span>\n                    </div>\n                  ) : (\n                    <div className=\"info-detail-row empty\">\n                      <span className=\"info-detail-value\">No general contractor specified</span>\n                    </div>\n                  )}\n                  {selectedProject.client_contact && (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">Client Contact</span>\n                      <span className=\"info-detail-value\">{selectedProject.client_contact}</span>\n                    </div>\n                  )}\n                  {selectedProject.client_phone && (\n                    <div className=\"info-detail-row clickable\">\n                      <span className=\"info-detail-label\">\n                        <Phone size={14} />\n                        Phone\n                      </span>\n                      <a href={`tel:${selectedProject.client_phone}`} className=\"info-detail-value link\">\n                        {selectedProject.client_phone}\n                      </a>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Work Areas Card */}\n              <div className=\"info-section-card\">\n                <div className=\"info-section-header\">\n                  <LayoutGrid size={18} />\n                  <h3>Work Areas</h3>\n                  <div className=\"info-section-badges\">\n                    {areasComplete > 0 && <span className=\"info-badge done\">{areasComplete} Done</span>}\n                    {areasWorking > 0 && <span className=\"info-badge working\">{areasWorking} Active</span>}\n                    {areasNotStarted > 0 && <span className=\"info-badge pending\">{areasNotStarted} Pending</span>}\n                  </div>\n                </div>\n                <div className=\"info-areas-list\">\n                  {areas.map(area => (\n                    <div key={area.id} className={`info-area-item ${area.status}`}>\n                      <div className=\"info-area-status\">\n                        {area.status === 'done' && <span className=\"status-dot done\"></span>}\n                        {area.status === 'working' && <span className=\"status-dot working\"></span>}\n                        {area.status === 'not_started' && <span className=\"status-dot pending\"></span>}\n                      </div>\n                      <div className=\"info-area-details\">\n                        <span className=\"info-area-name\">{area.name}</span>\n                        <span className={`info-area-status-label ${area.status}`}>\n                          {area.status === 'done' ? 'Complete' : area.status === 'working' ? 'In Progress' : 'Not Started'}\n                        </span>\n                      </div>\n                      <span className=\"info-area-weight\">{area.weight}%</span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Project Team */}\n              <ProjectTeam\n                project={selectedProject}\n                company={company}\n                user={user}\n                isAdmin={isAdmin}\n                onShowToast={onShowToast}\n              />\n\n              {/* Project Settings - Collapsible */}\n              <details className=\"info-details-section\">\n                <summary className=\"info-details-summary\">\n                  <Info size={16} />\n                  <span>Additional Settings</span>\n                </summary>\n                <div className=\"info-details-content\">\n                  <div className=\"info-detail-row\">\n                    <span className=\"info-detail-label\">Original Contract</span>\n                    <span className=\"info-detail-value\">{formatCurrency(selectedProject.contract_value)}</span>\n                  </div>\n                  {changeOrderValue > 0 && (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">Approved Change Orders</span>\n                      <span className=\"info-detail-value positive\">+{formatCurrency(changeOrderValue)}</span>\n                    </div>\n                  )}\n                  {selectedProject.default_dump_site_id && (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">Default Dump Site</span>\n                      <span className=\"info-detail-value\">\n                        {dumpSites.find(s => s.id === selectedProject.default_dump_site_id)?.name || 'Unknown'}\n                      </span>\n                    </div>\n                  )}\n                </div>\n              </details>\n            </div>\n          )}\n        </div>\n\n        {/* Share Modal */}\n        {showShareModal && (\n          <Suspense fallback={null}>\n            <ShareModal\n              project={selectedProject}\n              user={user}\n              onClose={() => setShowShareModal(false)}\n              onShareCreated={(share) => {\n                onShowToast('Share link created successfully!', 'success')\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* Notification Settings Modal */}\n        {showNotificationSettings && (\n          <div className=\"notification-settings-modal\">\n            <Suspense fallback={null}>\n              <NotificationSettings\n                project={selectedProject}\n                company={company}\n                onShowToast={onShowToast}\n                onClose={() => setShowNotificationSettings(false)}\n              />\n            </Suspense>\n          </div>\n        )}\n\n        {/* COR Form Modal */}\n        {showCORForm && (\n          <Suspense fallback={null}>\n            <CORForm\n              project={selectedProject}\n              company={company}\n              areas={areas}\n              existingCOR={editingCOR}\n              onClose={() => {\n                setShowCORForm(false)\n                setEditingCOR(null)\n              }}\n              onSaved={() => {\n                setShowCORForm(false)\n                setEditingCOR(null)\n                setCORRefreshKey(prev => prev + 1)\n              }}\n              onShowToast={onShowToast}\n            />\n          </Suspense>\n        )}\n\n        {/* COR Detail Modal */}\n        {showCORDetail && viewingCOR && (\n          <Suspense fallback={null}>\n            <CORDetail\n              cor={viewingCOR}\n              project={selectedProject}\n              company={company}\n              areas={areas}\n              onClose={() => {\n                setShowCORDetail(false)\n                setViewingCOR(null)\n              }}\n              onEdit={(cor) => {\n                setShowCORDetail(false)\n                setViewingCOR(null)\n                setEditingCOR(cor)\n                setShowCORForm(true)\n              }}\n              onShowToast={onShowToast}\n              onStatusChange={() => {\n                // Trigger a refresh of the COR list\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* COR Log Modal */}\n        {corDisplayMode === 'log' && selectedProject && (\n          <div className=\"cor-log-modal-overlay\" onClick={() => setCORDisplayMode('list')}>\n            <div className=\"cor-log-modal\" onClick={(e) => e.stopPropagation()}>\n              <div className=\"cor-log-modal-header\">\n                <h2>Change Order Log</h2>\n                <button\n                  className=\"cor-log-modal-close\"\n                  onClick={() => setCORDisplayMode('list')}\n                  title=\"Close\"\n                >\n                  \n                </button>\n              </div>\n              <div className=\"cor-log-modal-content\">\n                <Suspense fallback={<div style={{ padding: '2rem', textAlign: 'center' }}>Loading...</div>}>\n                  <CORLog project={selectedProject} company={company} onShowToast={onShowToast} />\n                </Suspense>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Add Cost Modal */}\n        {showAddCostModal && (\n          <Suspense fallback={null}>\n            <AddCostModal\n              onClose={() => setShowAddCostModal(false)}\n              saving={savingCost}\n              onSave={async (costData) => {\n                try {\n                  setSavingCost(true)\n                  await db.addProjectCost(selectedProject.id, company.id, costData)\n                  setShowAddCostModal(false)\n                  loadProjects()\n                  onShowToast('Cost added successfully', 'success')\n                } catch (err) {\n                  console.error('Error adding cost:', err)\n                  onShowToast('Error adding cost', 'error')\n                } finally {\n                  setSavingCost(false)\n                }\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* Equipment Modal */}\n        {showEquipmentModal && (\n          <Suspense fallback={null}>\n            <EquipmentModal\n              project={selectedProject}\n              company={company}\n              user={user}\n              editItem={editingEquipment}\n              onSave={() => {\n                setShowEquipmentModal(false)\n                setEditingEquipment(null)\n                setEquipmentRefreshKey(prev => prev + 1)\n                onShowToast(editingEquipment ? 'Equipment updated' : 'Equipment added', 'success')\n              }}\n              onClose={() => {\n                setShowEquipmentModal(false)\n                setEditingEquipment(null)\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* Draw Request Modal */}\n        {showDrawRequestModal && (\n          <Suspense fallback={null}>\n            <DrawRequestModal\n              project={selectedProject}\n              company={company}\n              areas={areas}\n              corStats={projectsData.find(p => p.id === selectedProject?.id)?.corStats}\n              editDrawRequest={editingDrawRequest}\n              onSave={() => {\n                setShowDrawRequestModal(false)\n                setEditingDrawRequest(null)\n                setDrawRequestRefreshKey(prev => prev + 1)\n                onShowToast(editingDrawRequest ? 'Draw request updated' : 'Draw request created', 'success')\n              }}\n              onClose={() => {\n                setShowDrawRequestModal(false)\n                setEditingDrawRequest(null)\n              }}\n            />\n          </Suspense>\n        )}\n      </div>\n    )\n  }\n\n  // Project List View - empty state\n  if (projects.length === 0) {\n    return (\n      <div className=\"empty-state\">\n        <ClipboardList size={48} className=\"empty-state-icon\" />\n        <h3>No Projects Yet</h3>\n        <p>Create your first project to get started</p>\n      </div>\n    )\n  }\n\n  // Portfolio overview - uses memoized values from above\n  return (\n    <div>\n      {/* Business Overview - High Level Portfolio Health */}\n      <div className=\"business-overview\">\n        <div className=\"bo-header\">\n          <h2 className=\"bo-title\">Portfolio Overview</h2>\n          <button className=\"search-trigger-btn\" onClick={() => setSearchOpen(true)}>\n            <Search size={16} />\n            <span>Search</span>\n            <span className=\"shortcut\">K</span>\n          </button>\n          <div className=\"bo-project-count\">{projects.length} Active Project{projects.length !== 1 ? 's' : ''}</div>\n        </div>\n\n        {/* Main Financial Bar */}\n        <div className=\"bo-financial\">\n          <div className=\"bo-progress-bar\">\n            <div\n              className=\"bo-progress-fill\"\n              style={{ width: `${Math.min(weightedCompletion, 100)}%` }}\n            ></div>\n          </div>\n          <div className=\"bo-financial-row\">\n            <div className=\"bo-metric primary\">\n              <span className=\"bo-metric-value\">{formatCurrency(totalEarned)}</span>\n              <span className=\"bo-metric-label\">Earned Revenue</span>\n            </div>\n            <div className=\"bo-metric-separator\">of</div>\n            <div className=\"bo-metric primary\">\n              <span className=\"bo-metric-value\">{formatCurrency(totalPortfolioValue)}</span>\n              <span className=\"bo-metric-label\">Total Portfolio</span>\n            </div>\n            <div className=\"bo-metric highlight\">\n              <span className=\"bo-metric-value\">{formatCurrency(totalRemaining)}</span>\n              <span className=\"bo-metric-label\">Remaining to Bill</span>\n            </div>\n          </div>\n\n          {/* Change Orders Summary - Only show if there are change orders */}\n          {totalChangeOrders > 0 && (\n            <div className=\"bo-change-orders\">\n              <div className=\"bo-co-item\">\n                <span className=\"bo-co-label\">Original Contracts</span>\n                <span className=\"bo-co-value\">{formatCurrency(totalOriginalContract)}</span>\n              </div>\n              <div className=\"bo-co-item bo-co-added\">\n                <span className=\"bo-co-label\">+ Change Orders ({projectsWithChangeOrders} project{projectsWithChangeOrders !== 1 ? 's' : ''})</span>\n                <span className=\"bo-co-value\">+{formatCurrency(totalChangeOrders)}</span>\n              </div>\n            </div>\n          )}\n\n          {/* Pending CORs - Unapproved extra work (not yet part of contract value) */}\n          {totalPendingCORCount > 0 && (\n            <div className=\"bo-pending-cors\">\n              <div className=\"bo-pending-cor-item\">\n                <span className=\"bo-pending-cor-icon\">!</span>\n                <span className=\"bo-pending-cor-label\">Pending CORs</span>\n                <span className=\"bo-pending-cor-value\">{formatCurrency(totalPendingCORValue)}</span>\n                <span className=\"bo-pending-cor-count\">({totalPendingCORCount} pending)</span>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Project Health Summary */}\n        <div className=\"bo-health\">\n          <div className=\"bo-health-title\">Project Health</div>\n          <div className=\"bo-health-pills\">\n            {projectsComplete > 0 && (\n              <div className=\"bo-pill complete\">\n                <span className=\"bo-pill-count\">{projectsComplete}</span>\n                <span className=\"bo-pill-label\">Complete</span>\n              </div>\n            )}\n            {projectsOnTrack > 0 && (\n              <div className=\"bo-pill on-track\">\n                <span className=\"bo-pill-count\">{projectsOnTrack}</span>\n                <span className=\"bo-pill-label\">On Track</span>\n              </div>\n            )}\n            {projectsAtRisk > 0 && (\n              <div className=\"bo-pill at-risk\">\n                <span className=\"bo-pill-count\">{projectsAtRisk}</span>\n                <span className=\"bo-pill-label\">At Risk</span>\n              </div>\n            )}\n            {projectsOverBudget > 0 && (\n              <div className=\"bo-pill over-budget\">\n                <span className=\"bo-pill-count\">{projectsOverBudget}</span>\n                <span className=\"bo-pill-label\">Over Budget</span>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Schedule Performance Summary */}\n        {hasAnyScheduleData && (\n          <div className=\"bo-schedule\">\n            <div className=\"bo-schedule-title\">Schedule Performance</div>\n            <div className=\"bo-schedule-pills\">\n              {scheduleAhead > 0 && (\n                <div className=\"bo-pill ahead\">\n                  <span className=\"bo-pill-count\">{scheduleAhead}</span>\n                  <span className=\"bo-pill-label\">Ahead</span>\n                </div>\n              )}\n              {scheduleOnTrack > 0 && (\n                <div className=\"bo-pill schedule-on-track\">\n                  <span className=\"bo-pill-count\">{scheduleOnTrack}</span>\n                  <span className=\"bo-pill-label\">On Track</span>\n                </div>\n              )}\n              {scheduleBehind > 0 && (\n                <div className=\"bo-pill behind\">\n                  <span className=\"bo-pill-count\">{scheduleBehind}</span>\n                  <span className=\"bo-pill-label\">Behind</span>\n                </div>\n              )}\n            </div>\n\n            {/* Labor Performance (if any projects have planned man-days) */}\n            {hasAnyLaborData && (\n              <div className=\"bo-labor-summary\">\n                <span className=\"bo-labor-label\">Man-Days:</span>\n                {laborUnder > 0 && (\n                  <span className=\"bo-labor-badge under\">{laborUnder} under</span>\n                )}\n                {laborOnTrack > 0 && (\n                  <span className=\"bo-labor-badge on-track\">{laborOnTrack} on track</span>\n                )}\n                {laborOver > 0 && (\n                  <span className=\"bo-labor-badge over\">{laborOver} over</span>\n                )}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Smart Alerts - Actionable insights requiring attention */}\n      {riskAnalysis.allAlerts.length > 0 && (\n        <div className=\"smart-alerts-section\" style={{ marginBottom: 'var(--space-lg, 1.5rem)' }}>\n          <div className=\"smart-alerts-header\" style={{\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n            marginBottom: 'var(--space-sm, 0.5rem)'\n          }}>\n            <h3 style={{\n              fontSize: 'var(--font-size-md, 1rem)',\n              fontWeight: 'var(--font-weight-semibold, 600)',\n              color: 'var(--text-primary)',\n              margin: 0\n            }}>\n              Needs Attention\n              {riskAnalysis.criticalCount > 0 && (\n                <span style={{\n                  marginLeft: '0.5rem',\n                  padding: '2px 8px',\n                  fontSize: '0.75rem',\n                  fontWeight: 600,\n                  borderRadius: '9999px',\n                  background: 'var(--status-danger-bg, #7f1d1d)',\n                  color: 'var(--status-danger, #dc2626)'\n                }}>\n                  {riskAnalysis.criticalCount} critical\n                </span>\n              )}\n            </h3>\n          </div>\n          <SmartAlerts\n            alerts={riskAnalysis.allAlerts}\n            onAction={handleAlertAction}\n            maxVisible={3}\n          />\n        </div>\n      )}\n\n      {/* Projects Header */}\n      <div className=\"dashboard-header\">\n        <h2>Projects</h2>\n        <span className=\"project-count\">{projects.length} active</span>\n      </div>\n\n      {/* Project Grid */}\n      <div className=\"project-list\">\n        {projectsData.map(project => {\n          const projectRisk = riskAnalysis.projectRisks.find(r => r.projectId === project.id)\n          return (\n            <EnhancedProjectCard\n              key={project.id}\n              project={project}\n              riskScore={projectRisk?.riskScore}\n              riskStatus={projectRisk?.riskStatus}\n              onClick={() => handleSelectProject(project)}\n            />\n          )\n        })}\n      </div>\n\n      {/* Universal Search Modal */}\n      <UniversalSearch\n        isOpen={isSearchOpen}\n        onClose={closeSearch}\n        companyId={company?.id}\n        onSelectProject={(project) => {\n          handleSelectProject(project)\n        }}\n        onSelectTicket={(ticket) => {\n          // Navigate to project and open T&M tab\n          const project = projects.find(p => p.id === ticket.project_id)\n          if (project) {\n            handleSelectProject(project)\n            setActiveProjectTab('financials')\n            setFinancialsSection('tickets')\n          }\n        }}\n        onSelectCOR={(cor) => {\n          // Navigate to project and open COR\n          const project = projects.find(p => p.id === cor.project_id)\n          if (project) {\n            handleSelectProject(project)\n            setActiveProjectTab('financials')\n            setFinancialsSection('cors')\n            setViewingCOR(cor)\n            setShowCORDetail(true)\n          }\n        }}\n        onShowToast={onShowToast}\n      />\n    </div>\n  )\n}\n\nfunction ProjectCard({ project, onClick }) {\n  const [areas, setAreas] = useState([])\n\n  useEffect(() => {\n    db.getAreas(project.id).then(setAreas)\n  }, [project.id])\n\n  const progress = calculateProgress(areas)\n  const status = getOverallStatus(areas)\n  const statusLabel = getOverallStatusLabel(areas)\n\n  return (\n    <div className=\"project-card\" onClick={onClick}>\n      <div className=\"project-card-header\">\n        <div>\n          <div className=\"project-card-name\">{project.name}</div>\n          <div className=\"project-card-value\">{formatCurrency(project.contract_value)}</div>\n        </div>\n        <span className={`status-badge ${status}`}>{statusLabel}</span>\n      </div>\n      <div className=\"project-card-progress\">\n        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.9rem' }}>\n          <span style={{ color: 'var(--text-secondary)' }}>Progress</span>\n          <span style={{ fontWeight: 600 }}>{progress}%</span>\n        </div>\n        <div className=\"mini-progress-bar\">\n          <div className=\"mini-progress-fill\" style={{ width: `${progress}%` }}></div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// Enhanced Project Card with more details\nfunction EnhancedProjectCard({ project, riskScore, riskStatus, onClick }) {\n  const status = getOverallStatus(project.areas || [])\n  const statusLabel = getOverallStatusLabel(project.areas || [])\n  const profit = project.contract_value - project.billable\n  const isAtRisk = project.billable > project.contract_value * 0.9 && project.progress < 90\n\n  // Risk badge colors\n  const riskColors = {\n    healthy: { bg: 'var(--status-success-bg, #064e3b)', color: 'var(--status-success, #059669)' },\n    warning: { bg: 'var(--status-warning-bg, #78350f)', color: 'var(--status-warning, #d97706)' },\n    critical: { bg: 'var(--status-danger-bg, #7f1d1d)', color: 'var(--status-danger, #dc2626)' }\n  }\n  const riskStyle = riskColors[riskStatus] || riskColors.healthy\n\n  return (\n    <div className={`project-card enhanced ${isAtRisk ? 'at-risk' : ''}`} onClick={onClick}>\n      <div className=\"project-card-header\">\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          {/* Risk Score Badge */}\n          {typeof riskScore === 'number' && (\n            <span\n              style={{\n                display: 'inline-flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                width: '32px',\n                height: '32px',\n                borderRadius: '50%',\n                fontSize: '0.75rem',\n                fontWeight: 700,\n                background: riskStyle.bg,\n                color: riskStyle.color\n              }}\n              title={`Risk Score: ${riskScore}`}\n              aria-label={`Risk score ${riskScore}, ${riskStatus}`}\n            >\n              {riskScore}\n            </span>\n          )}\n          <div>\n            <div className=\"project-card-name\">{project.name}</div>\n            <div className=\"project-card-value\">{formatCurrency(project.contract_value)}</div>\n          </div>\n        </div>\n        <span className={`status-badge ${status}`}>{statusLabel}</span>\n      </div>\n\n      {/* Stats Row */}\n      <div className=\"project-stats-row\">\n        <div className=\"project-stat\">\n          <span className=\"stat-value\">{project.progress}%</span>\n          <span className=\"stat-label\">Complete</span>\n        </div>\n        <div className=\"project-stat\">\n          <span className=\"stat-value\">{formatCurrency(project.billable)}</span>\n          <span className=\"stat-label\">Billable</span>\n        </div>\n        <div className=\"project-stat\">\n          <span className={`stat-value ${profit < 0 ? 'negative' : ''}`}>\n            {formatCurrency(Math.abs(profit))}\n          </span>\n          <span className=\"stat-label\">{profit >= 0 ? 'Remaining' : 'Over Budget'}</span>\n        </div>\n      </div>\n\n      {/* Progress Bar */}\n      <div className=\"mini-progress-bar\">\n        <div className=\"mini-progress-fill\" style={{ width: `${project.progress}%` }}></div>\n      </div>\n\n      {/* Badges Row */}\n      {(project.pendingTickets > 0 || project.totalTickets > 0) && (\n        <div className=\"project-badges\">\n          {project.pendingTickets > 0 && (\n            <span className=\"badge pending\">{project.pendingTickets} Pending T&M</span>\n          )}\n          {project.approvedTickets > 0 && (\n            <span className=\"badge approved\">{project.approvedTickets} Approved T&M</span>\n          )}\n        </div>\n      )}\n\n      {/* Schedule Badge */}\n      {project.hasScheduleData && (\n        <div className=\"project-schedule-badge\">\n          <span className={`schedule-indicator ${project.scheduleStatus}`}>\n            {project.scheduleLabel}\n          </span>\n          {project.hasLaborData && project.laborLabel && (\n            <span className={`labor-indicator ${project.laborStatus}`}>\n              {project.laborLabel}\n            </span>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n\n\n"],"file":"Dashboard-DCAhooJv.js"}