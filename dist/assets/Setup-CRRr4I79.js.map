{"version":3,"mappings":"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","names":["loadXLSX","formatCurrencyDisplay","value","num","parseCurrencyInput","cleaned","Setup","company","user","onProjectCreated","onShowToast","projectName","setProjectName","useState","jobNumber","setJobNumber","address","setAddress","generalContractor","setGeneralContractor","contractValue","setContractValue","pin","setPin","workType","setWorkType","jobType","setJobType","areas","setAreas","creating","setCreating","importing","setImporting","showImportReview","setShowImportReview","importedTasks","setImportedTasks","showWeightDropdown","setShowWeightDropdown","startDate","setStartDate","endDate","setEndDate","plannedManDays","setPlannedManDays","fileInputRef","useRef","totalWeight","sum","area","handlePinChange","generateRandomPin","array","randomPin","handleAreaChange","index","field","prev","i","addArea","removeArea","_","autoGenerateWeights","method","validAreas","a","newAreas","validIndices","totalValue","runningTotal","areaIndex","weight","w","resetForm","handleImportClick","parseExcel","file","XLSX","resolve","reject","reader","e","data","workbook","sheetName","sheet","rows","tasks","currentGroup","dollarPattern","itemNumberPattern","unitPattern","quantityPattern","headerPattern","row","cells","cell","rowText","hasDollarAmount","c","description","hasValue","itemNumber","scheduledValue","descParts","cleanValue","parsedValue","seen","uniqueTasks","task","key","error","handleFileSelect","ext","toggleTaskSelection","handleUseImportedTasks","selectedTasks","t","totalSOV","formatter","handleSubmit","contractVal","db","project","groups","selectedCount","selectedSOV","jsx","jsxs","group","groupTasks","groupSelectedCount","taskIndex","groupedAreas","acc","hasGroups","groupAreas"],"ignoreList":[],"sources":["../../src/components/Setup.jsx"],"sourcesContent":["import { useState, useRef } from 'react'\nimport { db } from '../lib/supabase'\n// Dynamic import for XLSX (loaded on-demand to reduce initial bundle)\nconst loadXLSX = () => import('xlsx')\n\n// Currency formatting helpers\nconst formatCurrencyDisplay = (value) => {\n  if (value === null || value === undefined || value === '') return ''\n  const num = parseFloat(value)\n  if (isNaN(num)) return ''\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(num)\n}\n\nconst parseCurrencyInput = (value) => {\n  if (!value) return null\n  // Remove currency symbols, commas, and spaces\n  const cleaned = String(value).replace(/[$,\\s]/g, '')\n  const num = parseFloat(cleaned)\n  return isNaN(num) ? null : num\n}\n\nexport default function Setup({ company, user, onProjectCreated, onShowToast }) {\n  const [projectName, setProjectName] = useState('')\n  const [jobNumber, setJobNumber] = useState('')\n  const [address, setAddress] = useState('')\n  const [generalContractor, setGeneralContractor] = useState('')\n  const [contractValue, setContractValue] = useState('')\n  const [pin, setPin] = useState('')\n  const [workType, setWorkType] = useState('demolition')\n  const [jobType, setJobType] = useState('standard')\n  const [areas, setAreas] = useState([\n    { name: '', weight: '', group: '', scheduledValue: null },\n    { name: '', weight: '', group: '', scheduledValue: null },\n    { name: '', weight: '', group: '', scheduledValue: null }\n  ])\n  const [creating, setCreating] = useState(false)\n  const [importing, setImporting] = useState(false)\n  const [showImportReview, setShowImportReview] = useState(false)\n  const [importedTasks, setImportedTasks] = useState([])\n  const [showWeightDropdown, setShowWeightDropdown] = useState(false)\n  const [startDate, setStartDate] = useState('')\n  const [endDate, setEndDate] = useState('')\n  const [plannedManDays, setPlannedManDays] = useState('')\n  const fileInputRef = useRef(null)\n\n  const totalWeight = areas.reduce((sum, area) => {\n    return sum + (parseFloat(area.weight) || 0)\n  }, 0)\n\n  const handlePinChange = (value) => {\n    const cleaned = value.replace(/\\D/g, '').slice(0, 4)\n    setPin(cleaned)\n  }\n\n  const generateRandomPin = () => {\n    // Use crypto for secure random PIN generation\n    const array = new Uint32Array(1)\n    crypto.getRandomValues(array)\n    const randomPin = (1000 + (array[0] % 9000)).toString()\n    setPin(randomPin)\n  }\n\n  const handleAreaChange = (index, field, value) => {\n    setAreas(prev => prev.map((area, i) => \n      i === index ? { ...area, [field]: value } : area\n    ))\n  }\n\n  const addArea = () => {\n    setAreas(prev => [...prev, { name: '', weight: '', group: '', scheduledValue: null }])\n  }\n\n  const removeArea = (index) => {\n    if (areas.length > 1) {\n      setAreas(prev => prev.filter((_, i) => i !== index))\n    }\n  }\n\n  // Auto-generate weights based on scheduled values or equal distribution\n  const autoGenerateWeights = (method = 'value') => {\n    const validAreas = areas.filter(a => a.name.trim())\n    if (validAreas.length === 0) {\n      onShowToast('Add tasks first', 'error')\n      return\n    }\n\n    let newAreas = [...areas]\n    const validIndices = areas.map((a, i) => a.name.trim() ? i : -1).filter(i => i >= 0)\n\n    if (method === 'value') {\n      const totalValue = validAreas.reduce((sum, a) => sum + (parseFloat(a.scheduledValue) || 0), 0)\n\n      if (totalValue === 0) {\n        // Fallback to equal if no values\n        onShowToast('No scheduled values - using equal distribution', 'info')\n        method = 'equal'\n      } else {\n        let runningTotal = 0\n        validIndices.forEach((areaIndex, i) => {\n          const value = parseFloat(areas[areaIndex].scheduledValue) || 0\n          let weight\n\n          if (i === validIndices.length - 1) {\n            // Last item gets remainder to ensure exactly 100%\n            weight = 100 - runningTotal\n          } else {\n            weight = Math.round((value / totalValue) * 10000) / 100\n            runningTotal += weight\n          }\n\n          newAreas[areaIndex] = { ...newAreas[areaIndex], weight: weight.toFixed(2) }\n        })\n\n        setAreas(newAreas)\n        setShowWeightDropdown(false)\n        onShowToast('Weights calculated by value', 'success')\n        return\n      }\n    }\n\n    // Equal distribution\n    const weight = Math.round((100 / validIndices.length) * 100) / 100\n    let runningTotal = 0\n\n    validIndices.forEach((areaIndex, i) => {\n      let w\n      if (i === validIndices.length - 1) {\n        w = 100 - runningTotal\n      } else {\n        w = weight\n        runningTotal += w\n      }\n      newAreas[areaIndex] = { ...newAreas[areaIndex], weight: w.toFixed(2) }\n    })\n\n    setAreas(newAreas)\n    setShowWeightDropdown(false)\n    onShowToast('Weights distributed equally', 'success')\n  }\n\n  const resetForm = () => {\n    setProjectName('')\n    setJobNumber('')\n    setAddress('')\n    setGeneralContractor('')\n    setContractValue('')\n    setPin('')\n    setWorkType('demolition')\n    setJobType('standard')\n    setStartDate('')\n    setEndDate('')\n    setPlannedManDays('')\n    setAreas([\n      { name: '', weight: '', group: '', scheduledValue: null },\n      { name: '', weight: '', group: '', scheduledValue: null },\n      { name: '', weight: '', group: '', scheduledValue: null }\n    ])\n    setShowImportReview(false)\n    setImportedTasks([])\n  }\n\n  // Excel Import Functions\n  const handleImportClick = () => {\n    fileInputRef.current?.click()\n  }\n\n  const parseExcel = async (file) => {\n    // Dynamic import - only loads XLSX when user actually imports\n    const XLSX = (await loadXLSX()).default || await loadXLSX()\n\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader()\n\n      reader.onload = (e) => {\n        try {\n          const data = new Uint8Array(e.target.result)\n          const workbook = XLSX.read(data, { type: 'array' })\n\n          // Get first sheet\n          const sheetName = workbook.SheetNames[0]\n          const sheet = workbook.Sheets[sheetName]\n\n          // Convert to array of arrays\n          const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 })\n\n          const tasks = []\n          let currentGroup = 'General'\n\n          // Patterns for SOV and bid sheet parsing\n          const dollarPattern = /^\\$?\\d{1,3}(,\\d{3})*(\\.\\d{2})?$/\n          const itemNumberPattern = /^(\\d+\\.?\\d*|[A-Z]\\.?\\d*)$/i\n          const unitPattern = /^(SF|LF|EA|LS|Days?|MD|Load|CY|SY|GAL|TON)$/i\n          const quantityPattern = /^\\d{1,3}(,\\d{3})*$|^\\d+$/\n\n          // Header patterns to skip\n          const headerPattern = /^(Item|#|No\\.?|Description|Scheduled|Value|Amount|Quantity|Unit|Total|Application|Balance|Completed|Stored|Retainage)/i\n\n          for (const row of rows) {\n            if (!row || row.length === 0) continue\n\n            // Flatten row: remove nulls and join non-empty cells\n            const cells = row\n              .map(cell => cell === null || cell === undefined ? '' : String(cell).trim())\n              .filter(cell => cell.length > 0)\n\n            if (cells.length === 0) continue\n\n            const rowText = cells.join(' ')\n\n            // Skip header rows\n            if (headerPattern.test(cells[0]) || (cells.length > 1 && headerPattern.test(cells[1]))) {\n              continue\n            }\n\n            // Skip total/subtotal rows\n            if (/^(Total|Subtotal|Grand Total|Base Bid|Contract Sum)/i.test(rowText)) {\n              continue\n            }\n\n            // Check if this is a group header\n            // Group headers: single text, no dollar amounts, matches area patterns\n            const hasDollarAmount = cells.some(c => dollarPattern.test(c.replace(/[$,]/g, '') + (c.includes('.') ? '' : '.00')))\n            const isGroupHeader =\n              !hasDollarAmount &&\n              cells.length <= 3 &&\n              /^(L\\d|Level|Floor|\\d+(?:st|nd|rd|th)|Plaza|Street|Basement|Roof|Penthouse|Site|Exterior|Interior|Misc|MEP|ABATEMENT|DEMOLITION|UNIVERSAL|SOFT|TRASH|DEMO|Phase|Division|Section|Area|Building|Wing)/i.test(cells[0]) ||\n              // Also check for SOV parent items (just number + description, no dollar on same line that looks like a header)\n              (cells.length === 2 && itemNumberPattern.test(cells[0]) && !hasDollarAmount && !/^\\d+\\.\\d+$/.test(cells[0]))\n\n            if (isGroupHeader && !hasDollarAmount) {\n              // Extract group name, removing any item number prefix\n              let groupName = cells.find(c => !itemNumberPattern.test(c) && c.length > 1) || cells.join(' ')\n              currentGroup = groupName\n                .replace(/\\s*\\(\\d{1,3}(?:,\\d{3})*\\s*SF\\)\\s*$/i, '')\n                .replace(/\\s*[-:]\\s*$/, '')\n                .trim()\n              continue\n            }\n\n            // Try to extract task from row\n            let description = ''\n            let hasValue = false\n            let itemNumber = ''\n            let scheduledValue = null\n\n            const descParts = []\n\n            for (let i = 0; i < cells.length; i++) {\n              const cell = cells[i]\n\n              // Check for item number in first cell\n              if (i === 0 && itemNumberPattern.test(cell)) {\n                itemNumber = cell\n                continue\n              }\n\n              // Skip ID codes (like \"ID-111\")\n              if (/^ID-\\d+$/i.test(cell)) continue\n              if (/^KN\\s*\\d+$/i.test(cell)) continue\n\n              // Check for dollar amounts (SOV scheduled values) - CAPTURE the value\n              if (dollarPattern.test(cell.replace(/[$,]/g, '') + (cell.includes('.') ? '' : '.00')) || /^\\$/.test(cell)) {\n                const cleanValue = cell.replace(/[$,]/g, '')\n                const parsedValue = parseFloat(cleanValue)\n                // Only capture if it's a reasonable dollar amount (> $100, likely a line item value)\n                if (!isNaN(parsedValue) && parsedValue > 100) {\n                  // Keep the largest dollar value found (likely the scheduled value, not quantities)\n                  if (scheduledValue === null || parsedValue > scheduledValue) {\n                    scheduledValue = parsedValue\n                  }\n                }\n                hasValue = true\n                continue\n              }\n\n              // Skip quantities and units\n              if (quantityPattern.test(cell.replace(/,/g, ''))) {\n                hasValue = true\n                continue\n              }\n              if (unitPattern.test(cell)) continue\n\n              // Skip percentage values\n              if (/^\\d+\\.?\\d*%$/.test(cell)) continue\n\n              // This is description text\n              if (cell.length > 1 && !itemNumberPattern.test(cell)) {\n                descParts.push(cell)\n              }\n            }\n\n            description = descParts.join(' ').trim()\n\n            // Clean up description\n            description = description\n              .replace(/\\s+/g, ' ')\n              .replace(/^[-â€¢]\\s*/, '') // Remove bullet points\n              .trim()\n\n            // Skip if no valid description or too short\n            if (description.length < 3) continue\n            if (/^(Plan|Page|Total|Base Bid|Payment|Condition|Exclusion|Subtotal)/i.test(description)) continue\n\n            // Add task if we found a value/quantity (indicates it's a real line item)\n            if (hasValue && description.length >= 3) {\n              tasks.push({\n                name: description,\n                group: currentGroup,\n                itemNumber: itemNumber,\n                scheduledValue: scheduledValue,\n                selected: true\n              })\n            }\n          }\n\n          // Deduplicate\n          const seen = new Set()\n          const uniqueTasks = tasks.filter(task => {\n            const key = `${task.group}:${task.name}`\n            if (seen.has(key)) return false\n            seen.add(key)\n            return true\n          })\n\n          resolve(uniqueTasks)\n        } catch (error) {\n          reject(error)\n        }\n      }\n\n      reader.onerror = () => reject(new Error('Failed to read file'))\n      reader.readAsArrayBuffer(file)\n    })\n  }\n\n  const handleFileSelect = async (e) => {\n    const file = e.target.files?.[0]\n    if (!file) return\n    \n    const validTypes = [\n      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', // .xlsx\n      'application/vnd.ms-excel', // .xls\n      'text/csv'\n    ]\n    \n    const ext = file.name.split('.').pop().toLowerCase()\n    if (!['xlsx', 'xls', 'csv'].includes(ext)) {\n      onShowToast('Please upload an Excel file (.xlsx, .xls, or .csv)', 'error')\n      return\n    }\n    \n    setImporting(true)\n    \n    try {\n      const tasks = await parseExcel(file)\n      \n      if (tasks.length === 0) {\n        onShowToast('No tasks found. Check Excel format.', 'error')\n        setImporting(false)\n        return\n      }\n      \n      setImportedTasks(tasks)\n      setShowImportReview(true)\n      onShowToast(`Found ${tasks.length} tasks`, 'success')\n    } catch (error) {\n      console.error('Excel import error:', error)\n      onShowToast('Error reading Excel file', 'error')\n    } finally {\n      setImporting(false)\n      if (fileInputRef.current) {\n        fileInputRef.current.value = ''\n      }\n    }\n  }\n\n  const toggleTaskSelection = (index) => {\n    setImportedTasks(prev => prev.map((task, i) => \n      i === index ? { ...task, selected: !task.selected } : task\n    ))\n  }\n\n  const handleUseImportedTasks = () => {\n    const selectedTasks = importedTasks.filter(t => t.selected)\n    if (selectedTasks.length === 0) {\n      onShowToast('Please select at least one task', 'error')\n      return\n    }\n\n    // Calculate total SOV\n    const totalSOV = selectedTasks.reduce((sum, t) => sum + (t.scheduledValue || 0), 0)\n    const formatter = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 })\n\n    let newAreas\n    if (totalSOV > 0) {\n      // Value-based weights (proportional to scheduled value)\n      let runningTotal = 0\n      newAreas = selectedTasks.map((task, index) => {\n        const value = task.scheduledValue || 0\n        let weight\n\n        if (index === selectedTasks.length - 1) {\n          // Last item gets remainder to ensure exactly 100%\n          weight = 100 - runningTotal\n        } else {\n          weight = Math.round((value / totalSOV) * 10000) / 100\n          runningTotal += weight\n        }\n\n        return {\n          name: task.name,\n          weight: weight.toFixed(2),\n          group: task.group,\n          scheduledValue: task.scheduledValue || null\n        }\n      })\n\n      onShowToast(`Tasks imported with value-based weights! Total SOV: ${formatter.format(totalSOV)}`, 'success')\n    } else {\n      // Equal distribution fallback (no scheduled values)\n      const weight = Math.round((100 / selectedTasks.length) * 100) / 100\n      newAreas = selectedTasks.map((task, index) => ({\n        name: task.name,\n        weight: index === selectedTasks.length - 1\n          ? (100 - (weight * (selectedTasks.length - 1))).toFixed(2)\n          : weight.toFixed(2),\n        group: task.group,\n        scheduledValue: task.scheduledValue || null\n      }))\n\n      onShowToast('Tasks imported with equal weights', 'success')\n    }\n\n    setAreas(newAreas)\n    setShowImportReview(false)\n  }\n\n  const handleSubmit = async () => {\n    if (!company?.id) {\n      onShowToast('No company selected. Please log in again.', 'error')\n      return\n    }\n\n    if (!projectName.trim()) {\n      onShowToast('Please enter a project name', 'error')\n      return\n    }\n\n    const contractVal = parseFloat(contractValue)\n    if (!contractVal || contractVal <= 0) {\n      onShowToast('Please enter a valid contract value', 'error')\n      return\n    }\n\n    if (pin.length !== 4) {\n      onShowToast('Please enter a 4-digit PIN', 'error')\n      return\n    }\n\n    const pinAvailable = await db.isPinAvailable(pin)\n    if (!pinAvailable) {\n      onShowToast('This PIN is already in use. Try another.', 'error')\n      return\n    }\n\n    const validAreas = areas.filter(a => a.name.trim() && parseFloat(a.weight) > 0)\n    if (validAreas.length === 0) {\n      onShowToast('Please add at least one area', 'error')\n      return\n    }\n\n    if (Math.abs(totalWeight - 100) > 0.1) {\n      onShowToast('Area weights must total 100%', 'error')\n      return\n    }\n\n    if (!startDate || !endDate) {\n      onShowToast('Start date and end date are required', 'error')\n      return\n    }\n\n    if (new Date(endDate) < new Date(startDate)) {\n      onShowToast('End date must be on or after start date', 'error')\n      return\n    }\n\n    setCreating(true)\n\n    try {\n      const project = await db.createProject({\n        name: projectName.trim(),\n        job_number: jobNumber.trim() || null,\n        address: address.trim() || null,\n        general_contractor: generalContractor.trim() || null,\n        contract_value: contractVal,\n        pin: pin,\n        work_type: workType,\n        job_type: jobType,\n        company_id: company?.id,\n        created_by: user?.id,\n        start_date: startDate,\n        end_date: endDate,\n        planned_man_days: plannedManDays ? parseInt(plannedManDays) : null\n      })\n\n      for (let i = 0; i < validAreas.length; i++) {\n        await db.createArea({\n          project_id: project.id,\n          name: validAreas[i].name.trim(),\n          weight: parseFloat(validAreas[i].weight),\n          scheduled_value: validAreas[i].scheduledValue || null,\n          group_name: validAreas[i].group || null,\n          status: 'not_started',\n          sort_order: i\n        })\n      }\n\n      onShowToast('Project created!', 'success')\n      resetForm()\n      onProjectCreated()\n    } catch (error) {\n      console.error('Error creating project:', error)\n      onShowToast('Error creating project', 'error')\n    } finally {\n      setCreating(false)\n    }\n  }\n\n  // Import Review Screen\n  if (showImportReview) {\n    const groups = [...new Set(importedTasks.map(t => t.group))]\n    const selectedCount = importedTasks.filter(t => t.selected).length\n    const totalSOV = importedTasks.reduce((sum, t) => sum + (t.scheduledValue || 0), 0)\n    const selectedSOV = importedTasks.filter(t => t.selected).reduce((sum, t) => sum + (t.scheduledValue || 0), 0)\n\n    return (\n      <div>\n        <h1>Review Imported Tasks</h1>\n        <p className=\"subtitle\">Select the tasks to include in your project</p>\n\n        <div className=\"import-summary\">\n          <span>{selectedCount} of {importedTasks.length} tasks selected</span>\n          {totalSOV > 0 && (\n            <span className=\"import-sov-total\">\n              Â· Total SOV: {new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(selectedSOV)}\n            </span>\n          )}\n        </div>\n        \n        {groups.map(group => {\n          const groupTasks = importedTasks.filter(t => t.group === group)\n          const groupSelectedCount = groupTasks.filter(t => t.selected).length\n          \n          return (\n            <div key={group} className=\"card import-group\">\n              <div className=\"import-group-header\">\n                <h3>{group}</h3>\n                <span className=\"import-group-count\">{groupSelectedCount}/{groupTasks.length}</span>\n              </div>\n              <div className=\"import-task-list\">\n                {groupTasks.map(task => {\n                  const taskIndex = importedTasks.indexOf(task)\n                  return (\n                    <label key={taskIndex} className=\"import-task-item\">\n                      <input\n                        type=\"checkbox\"\n                        checked={task.selected}\n                        onChange={() => toggleTaskSelection(taskIndex)}\n                      />\n                      <span className=\"import-task-name\">{task.name}</span>\n                      {task.scheduledValue > 0 && (\n                        <span className=\"import-task-value\">\n                          {new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(task.scheduledValue)}\n                        </span>\n                      )}\n                    </label>\n                  )\n                })}\n              </div>\n            </div>\n          )\n        })}\n        \n        <div className=\"import-actions\">\n          <button \n            className=\"btn btn-secondary\" \n            onClick={() => setShowImportReview(false)}\n          >\n            Cancel\n          </button>\n          <button \n            className=\"btn btn-primary\" \n            onClick={handleUseImportedTasks}\n          >\n            Use Selected Tasks ({selectedCount})\n          </button>\n        </div>\n      </div>\n    )\n  }\n\n  // Group areas by group_name for display\n  const groupedAreas = areas.reduce((acc, area, index) => {\n    const group = area.group || 'General'\n    if (!acc[group]) acc[group] = []\n    acc[group].push({ ...area, originalIndex: index })\n    return acc\n  }, {})\n\n  const hasGroups = Object.keys(groupedAreas).length > 1 || \n    (Object.keys(groupedAreas).length === 1 && !groupedAreas['General'])\n\n  return (\n    <div>\n      <h1>New Project</h1>\n      <p className=\"subtitle\">Set up a new project to track</p>\n\n      <div className=\"card\">\n        <div className=\"form-group\">\n          <label>Project Name</label>\n          <input\n            type=\"text\"\n            placeholder=\"e.g., Sunrise Apartments\"\n            value={projectName}\n            onChange={(e) => setProjectName(e.target.value)}\n          />\n        </div>\n\n        <div className=\"form-row-2\">\n          <div className=\"form-group\">\n            <label>Job Number</label>\n            <input\n              type=\"text\"\n              placeholder=\"e.g., 4032\"\n              value={jobNumber}\n              onChange={(e) => setJobNumber(e.target.value)}\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label>Contract Value ($)</label>\n            <input\n              type=\"text\"\n              inputMode=\"decimal\"\n              placeholder=\"e.g., 365000\"\n              value={contractValue}\n              onChange={(e) => {\n                const cleaned = e.target.value.replace(/[^0-9.]/g, '')\n                setContractValue(cleaned)\n              }}\n              className=\"currency-input\"\n            />\n          </div>\n        </div>\n\n        <div className=\"form-group\">\n          <label>Project Address</label>\n          <input\n            type=\"text\"\n            placeholder=\"e.g., 123 Main St, Los Angeles, CA 90001\"\n            value={address}\n            onChange={(e) => setAddress(e.target.value)}\n          />\n        </div>\n\n        <div className=\"form-group\">\n          <label>General Contractor</label>\n          <input\n            type=\"text\"\n            placeholder=\"e.g., ABC Construction Inc.\"\n            value={generalContractor}\n            onChange={(e) => setGeneralContractor(e.target.value)}\n          />\n        </div>\n\n        <div className=\"form-row-2\">\n          <div className=\"form-group\">\n            <label>Start Date <span className=\"required\">*</span></label>\n            <input\n              type=\"date\"\n              value={startDate}\n              onChange={(e) => setStartDate(e.target.value)}\n              required\n            />\n          </div>\n          <div className=\"form-group\">\n            <label>End Date <span className=\"required\">*</span></label>\n            <input\n              type=\"date\"\n              value={endDate}\n              onChange={(e) => setEndDate(e.target.value)}\n              min={startDate || undefined}\n              required\n            />\n            {startDate && endDate && new Date(endDate) < new Date(startDate) && (\n              <span className=\"error-text\">End date must be after start date</span>\n            )}\n          </div>\n        </div>\n\n        <div className=\"form-group\">\n          <label>Planned Man-Days <span className=\"optional\">(optional)</span></label>\n          <p style={{ color: 'var(--text-secondary)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>\n            Total estimated man-days to complete the project\n          </p>\n          <input\n            type=\"number\"\n            inputMode=\"numeric\"\n            placeholder=\"e.g., 120\"\n            value={plannedManDays}\n            onChange={(e) => setPlannedManDays(e.target.value.replace(/\\D/g, ''))}\n            min=\"1\"\n          />\n        </div>\n\n        <div className=\"form-row-2\">\n          <div className=\"form-group\">\n            <label>Work Type</label>\n            <div className=\"project-type-toggle\">\n              <button\n                type=\"button\"\n                className={`toggle-btn ${workType === 'demolition' ? 'active' : ''}`}\n                onClick={() => setWorkType('demolition')}\n              >\n                Demolition\n              </button>\n              <button\n                type=\"button\"\n                className={`toggle-btn ${workType === 'abatement' ? 'active' : ''}`}\n                onClick={() => setWorkType('abatement')}\n              >\n                Abatement\n              </button>\n            </div>\n          </div>\n\n          <div className=\"form-group\">\n            <label>Job Type</label>\n            <div className=\"project-type-toggle\">\n              <button\n                type=\"button\"\n                className={`toggle-btn ${jobType === 'standard' ? 'active' : ''}`}\n                onClick={() => setJobType('standard')}\n              >\n                Standard\n              </button>\n              <button\n                type=\"button\"\n                className={`toggle-btn ${jobType === 'pla' ? 'active' : ''}`}\n                onClick={() => setJobType('pla')}\n              >\n                PLA\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"form-group\">\n          <label>Foreman PIN (4 digits)</label>\n          <p style={{ color: 'var(--text-secondary)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>\n            Foremen will enter this PIN to access this project\n          </p>\n          <div className=\"pin-input-row\">\n            <input\n              type=\"text\"\n              inputMode=\"numeric\"\n              pattern=\"[0-9]*\"\n              placeholder=\"e.g., 2847\"\n              value={pin}\n              onChange={(e) => handlePinChange(e.target.value)}\n              maxLength={4}\n              className=\"pin-input\"\n            />\n            <button \n              type=\"button\" \n              className=\"btn btn-secondary\"\n              onClick={generateRandomPin}\n            >\n              Generate\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"card\">\n        <div className=\"areas-header\">\n          <div>\n            <h3>Areas / Tasks</h3>\n            <p style={{ color: 'var(--text-secondary)', fontSize: '0.9rem', marginTop: '0.25rem' }}>\n              Define the areas for this project. Weights must total 100%.\n            </p>\n          </div>\n          <div className=\"import-btn-container\">\n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              accept=\".xlsx,.xls,.csv\"\n              onChange={handleFileSelect}\n              style={{ display: 'none' }}\n            />\n            <button \n              className=\"btn btn-secondary btn-small\"\n              onClick={handleImportClick}\n              disabled={importing}\n            >\n              {importing ? 'Reading...' : 'ðŸ“Š Import Excel'}\n            </button>\n          </div>\n        </div>\n\n        {hasGroups ? (\n          // Grouped display\n          Object.entries(groupedAreas).map(([group, groupAreas]) => (\n            <div key={group} className=\"area-group\">\n              <div className=\"area-group-header\">{group}</div>\n              {groupAreas.map(area => (\n                <div key={area.originalIndex} className=\"area-row area-row-with-value\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"Task name\"\n                    value={area.name}\n                    onChange={(e) => handleAreaChange(area.originalIndex, 'name', e.target.value)}\n                    className=\"area-name-input\"\n                  />\n                  <input\n                    type=\"text\"\n                    inputMode=\"decimal\"\n                    placeholder=\"$0\"\n                    value={area.scheduledValue ? formatCurrencyDisplay(area.scheduledValue) : ''}\n                    onChange={(e) => handleAreaChange(area.originalIndex, 'scheduledValue', parseCurrencyInput(e.target.value))}\n                    className=\"currency-input\"\n                  />\n                  <input\n                    type=\"text\"\n                    inputMode=\"decimal\"\n                    placeholder=\"%\"\n                    value={area.weight}\n                    onChange={(e) => handleAreaChange(area.originalIndex, 'weight', e.target.value)}\n                    className=\"weight-input\"\n                  />\n                  <button className=\"remove-btn\" onClick={() => removeArea(area.originalIndex)}>\n                    Ã—\n                  </button>\n                </div>\n              ))}\n            </div>\n          ))\n        ) : (\n          // Flat display\n          areas.map((area, index) => (\n            <div key={index} className=\"area-row area-row-with-value\">\n              <input\n                type=\"text\"\n                placeholder=\"Area name (e.g., Level 1)\"\n                value={area.name}\n                onChange={(e) => handleAreaChange(index, 'name', e.target.value)}\n                className=\"area-name-input\"\n              />\n              <input\n                type=\"text\"\n                inputMode=\"decimal\"\n                placeholder=\"$0\"\n                value={area.scheduledValue ? formatCurrencyDisplay(area.scheduledValue) : ''}\n                onChange={(e) => handleAreaChange(index, 'scheduledValue', parseCurrencyInput(e.target.value))}\n                className=\"currency-input\"\n              />\n              <input\n                type=\"text\"\n                inputMode=\"decimal\"\n                placeholder=\"%\"\n                value={area.weight}\n                onChange={(e) => handleAreaChange(index, 'weight', e.target.value)}\n                className=\"weight-input\"\n              />\n              <button className=\"remove-btn\" onClick={() => removeArea(index)}>\n                Ã—\n              </button>\n            </div>\n          ))\n        )}\n\n        <div className=\"weight-total-row\">\n          <div className=\"weight-total\">\n            <span className=\"weight-total-label\">Total Weight:</span>\n            <span className={`weight-total-value ${Math.abs(totalWeight - 100) < 0.1 ? 'valid' : 'invalid'}`}>\n              {totalWeight.toFixed(1)}%\n            </span>\n            {areas.some(a => a.scheduledValue > 0) && (\n              <span className=\"sov-total\">\n                Â· SOV: {formatCurrencyDisplay(areas.reduce((sum, a) => sum + (parseFloat(a.scheduledValue) || 0), 0))}\n              </span>\n            )}\n          </div>\n          <div className=\"auto-weight-dropdown\">\n            <button\n              type=\"button\"\n              className=\"btn btn-secondary btn-small\"\n              onClick={() => setShowWeightDropdown(!showWeightDropdown)}\n            >\n              Auto-Calculate â–¼\n            </button>\n            {showWeightDropdown && (\n              <div className=\"weight-dropdown-menu\">\n                <button onClick={() => autoGenerateWeights('value')}>\n                  By Value <span className=\"dropdown-hint\">(Recommended)</span>\n                </button>\n                <button onClick={() => autoGenerateWeights('equal')}>\n                  Equal Distribution\n                </button>\n              </div>\n            )}\n          </div>\n        </div>\n\n        <button className=\"btn btn-secondary\" onClick={addArea}>\n          + Add Area\n        </button>\n      </div>\n\n      <button \n        className=\"btn btn-primary btn-full\" \n        onClick={handleSubmit}\n        disabled={creating}\n      >\n        {creating ? 'Creating...' : 'Create Project'}\n      </button>\n    </div>\n  )\n}\n\n"],"file":"Setup-CRRr4I79.js"}