{"version":3,"file":"SignatureCanvas-DrLwfeKW.js","sources":["../../src/lib/corPdfExport.js","../../src/components/ui/SignatureCanvas.jsx"],"sourcesContent":["// ============================================\n// DEPRECATED: Legacy COR PDF Export\n// ============================================\n//\n// This file is DEPRECATED and maintained only for backward compatibility\n// with SignaturePage.jsx (client-side downloads after signing).\n//\n// For new code, use the snapshot-based export pipeline:\n// - corExportPipeline.js - Orchestrates idempotent, async exports\n// - corPdfGenerator.js - Generates PDFs from frozen snapshots\n//\n// The new system provides:\n// - Idempotent exports (repeat requests return same result)\n// - Snapshot-based generation (deterministic, reproducible)\n// - Async pipeline with state tracking (pending/generating/completed/failed)\n// - Pre-aggregated stats and photo manifests\n//\n// Migration: Replace exportCORToPDF calls with executeExport from corExportPipeline.js\n// ============================================\n\nimport jsPDF from 'jspdf'\nimport autoTable from 'jspdf-autotable'\nimport {\n  formatCurrency,\n  formatPercent,\n  centsToDollars,\n  calculateCORTotals,\n  formatDate,\n  formatDateRange\n} from './corCalculations'\nimport { hexToRgb, loadImageAsBase64, loadImagesAsBase64 } from './imageUtils'\n\n// Helper to format time (HH:MM or HH:MM:SS to 9:00am format)\nconst formatTime = (timeStr) => {\n  if (!timeStr) return ''\n  const [hours, minutes] = timeStr.split(':')\n  const h = parseInt(hours)\n  const ampm = h >= 12 ? 'pm' : 'am'\n  const h12 = h % 12 || 12\n  return `${h12}:${minutes}${ampm}`\n}\n\n// Format time period for workers\nconst formatTimePeriod = (worker) => {\n  if (worker.time_started && worker.time_ended) {\n    return `${formatTime(worker.time_started)} - ${formatTime(worker.time_ended)}`\n  }\n  return '-'\n}\n\n/**\n * Pre-verify all photos in T&M tickets before export\n * Creates a manifest of verified photos and tracks failures\n * @param {Object[]} tmTickets - T&M tickets with photos\n * @returns {Promise<Object>} Photo manifest with verification status\n */\nexport async function verifyPhotosForExport(tmTickets) {\n  if (!tmTickets || tmTickets.length === 0) {\n    return { totalPhotos: 0, verified: 0, failed: 0, issues: [], manifest: [] }\n  }\n\n  const manifest = []\n  let verified = 0\n  let failed = 0\n  const issues = []\n\n  for (const ticket of tmTickets) {\n    if (!ticket.photos || ticket.photos.length === 0) continue\n\n    for (const photoUrl of ticket.photos) {\n      const entry = {\n        ticketId: ticket.id,\n        workDate: ticket.work_date,\n        url: photoUrl,\n        verified: false,\n        error: null\n      }\n\n      try {\n        // Try to load the image to verify accessibility\n        const imgData = await loadImageAsBase64(photoUrl)\n        if (imgData) {\n          entry.verified = true\n          verified++\n        } else {\n          entry.error = 'Failed to load image'\n          failed++\n          issues.push({\n            ticketId: ticket.id,\n            workDate: ticket.work_date,\n            url: photoUrl,\n            error: 'Failed to load image'\n          })\n        }\n      } catch (err) {\n        entry.error = err.message || 'Unknown error'\n        failed++\n        issues.push({\n          ticketId: ticket.id,\n          workDate: ticket.work_date,\n          url: photoUrl,\n          error: entry.error\n        })\n      }\n\n      manifest.push(entry)\n    }\n  }\n\n  return {\n    totalPhotos: verified + failed,\n    verified,\n    failed,\n    issues,\n    manifest,\n    allVerified: failed === 0,\n    verifiedAt: new Date().toISOString()\n  }\n}\n\n/**\n * Create a frozen snapshot of COR data at export time for dispute purposes\n * @param {Object} cor - The COR data object\n * @param {Object[]} tmTickets - Associated T&M tickets\n * @param {Object} photoManifest - Photo verification manifest\n * @param {Object} totals - Calculated totals\n * @returns {Object} Frozen snapshot ready for database storage\n */\nexport function createExportSnapshot(cor, tmTickets, photoManifest, totals) {\n  // Create a SHA256-like checksum from the data (simplified for client-side)\n  const dataString = JSON.stringify({ cor, tmTickets, photoManifest, totals })\n  let hash = 0\n  for (let i = 0; i < dataString.length; i++) {\n    const char = dataString.charCodeAt(i)\n    hash = ((hash << 5) - hash) + char\n    hash = hash & hash\n  }\n  const checksum = Math.abs(hash).toString(16).padStart(16, '0')\n\n  return {\n    cor_data: {\n      id: cor.id,\n      cor_number: cor.cor_number,\n      title: cor.title,\n      description: cor.description,\n      status: cor.status,\n      created_at: cor.created_at,\n      submitted_at: cor.submitted_at,\n      labor_items: cor.labor_items,\n      material_items: cor.material_items,\n      equipment_items: cor.equipment_items,\n      gc_markup_percent: cor.gc_markup_percent,\n      profit_markup_percent: cor.profit_markup_percent\n    },\n    tickets_data: (tmTickets || []).map(ticket => ({\n      id: ticket.id,\n      work_date: ticket.work_date,\n      ce_pco_number: ticket.ce_pco_number,\n      notes: ticket.notes,\n      status: ticket.status,\n      created_at: ticket.created_at,\n      workers: ticket.t_and_m_workers || [],\n      items: ticket.t_and_m_items || [],\n      photos: ticket.photos || [],\n      client_signature_name: ticket.client_signature_name,\n      client_signature_date: ticket.client_signature_date\n    })),\n    photos_manifest: photoManifest,\n    totals_snapshot: totals,\n    checksum: checksum\n  }\n}\n\n/**\n * Export a Change Order Request to PDF\n * @param {Object} cor - The COR data object\n * @param {Object} project - The project data\n * @param {Object} company - The company data\n * @param {Object} branding - Optional branding settings\n * @param {Object[]} tmTickets - Optional T&M tickets for backup documentation\n * @param {Object} options - Export options (verifyPhotos, createSnapshot)\n * @returns {Promise<Object>} Export result with optional snapshot and verification data\n */\nexport async function exportCORToPDF(cor, project, company, branding = {}, tmTickets = null, options = {}) {\n  const { verifyPhotos = false, createSnapshot = false } = options\n\n  // Photo verification (optional, for dispute-ready exports)\n  let photoManifest = null\n  if (verifyPhotos && tmTickets?.length > 0) {\n    photoManifest = await verifyPhotosForExport(tmTickets)\n  }\n  const doc = new jsPDF()\n  const pageWidth = doc.internal.pageSize.getWidth()\n  const pageHeight = doc.internal.pageSize.getHeight()\n  const margin = 20\n  let yPos = margin\n\n  // Calculate totals\n  const totals = calculateCORTotals(cor)\n\n  // Colors\n  const primaryColor = branding.primaryColor ? hexToRgb(branding.primaryColor) : [30, 58, 138]\n  const headerBg = [241, 245, 249]\n\n  // Load company logo if available\n  let logoBase64 = null\n  if (branding.logoUrl) {\n    try {\n      logoBase64 = await loadImageAsBase64(branding.logoUrl)\n    } catch (e) {\n      console.error('Error loading logo:', e)\n    }\n  }\n\n  // ============================================\n  // HEADER\n  // ============================================\n\n  // Company Logo or Name\n  if (logoBase64) {\n    try {\n      doc.addImage(logoBase64, 'PNG', margin, yPos, 40, 15)\n      yPos += 20\n    } catch (e) {\n      doc.setFontSize(16)\n      doc.setFont('helvetica', 'bold')\n      doc.setTextColor(...primaryColor)\n      doc.text(company?.name || 'Company Name', margin, yPos + 10)\n      yPos += 20\n    }\n  } else {\n    doc.setFontSize(16)\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(...primaryColor)\n    doc.text(company?.name || 'Company Name', margin, yPos + 10)\n    yPos += 20\n  }\n\n  // Title\n  doc.setFontSize(20)\n  doc.setFont('helvetica', 'bold')\n  doc.setTextColor(0, 0, 0)\n  doc.text('CHANGE ORDER REQUEST', margin, yPos)\n  yPos += 10\n\n  // COR Number and Status\n  doc.setFontSize(12)\n  doc.setFont('helvetica', 'normal')\n  doc.setTextColor(100, 100, 100)\n  doc.text(cor.cor_number || 'COR-XXXX', margin, yPos)\n\n  // Status badge\n  const statusText = cor.status?.replace('_', ' ').toUpperCase() || 'DRAFT'\n  doc.setTextColor(...primaryColor)\n  doc.text(statusText, pageWidth - margin - doc.getTextWidth(statusText), yPos)\n  yPos += 12\n\n  // Divider line\n  doc.setDrawColor(...primaryColor)\n  doc.setLineWidth(0.5)\n  doc.line(margin, yPos, pageWidth - margin, yPos)\n  yPos += 10\n\n  // ============================================\n  // PROJECT & COR INFO\n  // ============================================\n\n  doc.setFontSize(10)\n  doc.setTextColor(0, 0, 0)\n\n  // Two column layout for project info\n  const col1X = margin\n  const col2X = pageWidth / 2\n\n  doc.setFont('helvetica', 'bold')\n  doc.text('Project:', col1X, yPos)\n  doc.setFont('helvetica', 'normal')\n  doc.text(project?.name || 'Project Name', col1X + 25, yPos)\n\n  doc.setFont('helvetica', 'bold')\n  doc.text('Job #:', col2X, yPos)\n  doc.setFont('helvetica', 'normal')\n  doc.text(project?.job_number || 'N/A', col2X + 25, yPos)\n  yPos += 6\n\n  doc.setFont('helvetica', 'bold')\n  doc.text('Period:', col1X, yPos)\n  doc.setFont('helvetica', 'normal')\n  doc.text(formatDateRange(cor.period_start, cor.period_end), col1X + 25, yPos)\n\n  doc.setFont('helvetica', 'bold')\n  doc.text('Date:', col2X, yPos)\n  doc.setFont('helvetica', 'normal')\n  doc.text(formatDate(cor.created_at), col2X + 25, yPos)\n  yPos += 10\n\n  // COR Title\n  doc.setFont('helvetica', 'bold')\n  doc.setFontSize(12)\n  doc.text(cor.title || 'Untitled Change Order', margin, yPos)\n  yPos += 8\n\n  // Scope of Work\n  doc.setFont('helvetica', 'normal')\n  doc.setFontSize(10)\n  doc.setTextColor(80, 80, 80)\n  const scopeLines = doc.splitTextToSize(cor.scope_of_work || 'No scope of work provided.', pageWidth - (margin * 2))\n  doc.text(scopeLines, margin, yPos)\n  yPos += (scopeLines.length * 5) + 10\n\n  // ============================================\n  // LABOR SECTION\n  // ============================================\n\n  if (cor.change_order_labor?.length > 0) {\n    doc.setFont('helvetica', 'bold')\n    doc.setFontSize(11)\n    doc.setTextColor(0, 0, 0)\n    doc.text('LABOR', margin, yPos)\n    yPos += 6\n\n    autoTable(doc, {\n      startY: yPos,\n      head: [['Class', 'Type', 'Reg Hrs', 'Reg Rate', 'OT Hrs', 'OT Rate', 'Total']],\n      body: cor.change_order_labor.map(item => [\n        item.labor_class,\n        item.wage_type,\n        item.regular_hours.toString(),\n        `$${centsToDollars(item.regular_rate)}/hr`,\n        item.overtime_hours?.toString() || '-',\n        item.overtime_hours ? `$${centsToDollars(item.overtime_rate)}/hr` : '-',\n        formatCurrency(item.total)\n      ]),\n      foot: [[\n        { content: `Subtotal: ${formatCurrency(totals.labor_subtotal)}`, colSpan: 5, styles: { halign: 'right', fontStyle: 'bold' } },\n        { content: `+${formatPercent(cor.labor_markup_percent || 1500)} Markup`, colSpan: 1, styles: { halign: 'right' } },\n        { content: formatCurrency(totals.labor_subtotal + totals.labor_markup_amount), styles: { fontStyle: 'bold' } }\n      ]],\n      margin: { left: margin, right: margin },\n      headStyles: { fillColor: primaryColor, textColor: [255, 255, 255], fontStyle: 'bold', fontSize: 8 },\n      bodyStyles: { fontSize: 8 },\n      footStyles: { fillColor: headerBg, textColor: [0, 0, 0], fontSize: 8 },\n      theme: 'striped'\n    })\n\n    yPos = doc.lastAutoTable.finalY + 10\n  }\n\n  // ============================================\n  // MATERIALS SECTION\n  // ============================================\n\n  if (cor.change_order_materials?.length > 0) {\n    // Check if we need a new page\n    if (yPos > pageHeight - 80) {\n      doc.addPage()\n      yPos = margin\n    }\n\n    doc.setFont('helvetica', 'bold')\n    doc.setFontSize(11)\n    doc.setTextColor(0, 0, 0)\n    doc.text('MATERIALS', margin, yPos)\n    yPos += 6\n\n    autoTable(doc, {\n      startY: yPos,\n      head: [['Description', 'Source', 'Qty', 'Unit', 'Unit Cost', 'Total']],\n      body: cor.change_order_materials.map(item => [\n        item.description,\n        item.source_reference || item.source_type,\n        item.quantity.toString(),\n        item.unit,\n        `$${centsToDollars(item.unit_cost)}`,\n        formatCurrency(item.total)\n      ]),\n      foot: [[\n        { content: `Subtotal: ${formatCurrency(totals.materials_subtotal)}`, colSpan: 4, styles: { halign: 'right', fontStyle: 'bold' } },\n        { content: `+${formatPercent(cor.materials_markup_percent || 1500)} Markup`, colSpan: 1, styles: { halign: 'right' } },\n        { content: formatCurrency(totals.materials_subtotal + totals.materials_markup_amount), styles: { fontStyle: 'bold' } }\n      ]],\n      margin: { left: margin, right: margin },\n      headStyles: { fillColor: primaryColor, textColor: [255, 255, 255], fontStyle: 'bold', fontSize: 8 },\n      bodyStyles: { fontSize: 8 },\n      footStyles: { fillColor: headerBg, textColor: [0, 0, 0], fontSize: 8 },\n      theme: 'striped'\n    })\n\n    yPos = doc.lastAutoTable.finalY + 10\n  }\n\n  // ============================================\n  // EQUIPMENT SECTION\n  // ============================================\n\n  if (cor.change_order_equipment?.length > 0) {\n    if (yPos > pageHeight - 80) {\n      doc.addPage()\n      yPos = margin\n    }\n\n    doc.setFont('helvetica', 'bold')\n    doc.setFontSize(11)\n    doc.setTextColor(0, 0, 0)\n    doc.text('EQUIPMENT', margin, yPos)\n    yPos += 6\n\n    autoTable(doc, {\n      startY: yPos,\n      head: [['Description', 'Source', 'Qty', 'Unit', 'Unit Cost', 'Total']],\n      body: cor.change_order_equipment.map(item => [\n        item.description,\n        item.source_reference || item.source_type,\n        item.quantity.toString(),\n        item.unit,\n        `$${centsToDollars(item.unit_cost)}`,\n        formatCurrency(item.total)\n      ]),\n      foot: [[\n        { content: `Subtotal: ${formatCurrency(totals.equipment_subtotal)}`, colSpan: 4, styles: { halign: 'right', fontStyle: 'bold' } },\n        { content: `+${formatPercent(cor.equipment_markup_percent || 1500)} Markup`, colSpan: 1, styles: { halign: 'right' } },\n        { content: formatCurrency(totals.equipment_subtotal + totals.equipment_markup_amount), styles: { fontStyle: 'bold' } }\n      ]],\n      margin: { left: margin, right: margin },\n      headStyles: { fillColor: primaryColor, textColor: [255, 255, 255], fontStyle: 'bold', fontSize: 8 },\n      bodyStyles: { fontSize: 8 },\n      footStyles: { fillColor: headerBg, textColor: [0, 0, 0], fontSize: 8 },\n      theme: 'striped'\n    })\n\n    yPos = doc.lastAutoTable.finalY + 10\n  }\n\n  // ============================================\n  // SUBCONTRACTORS SECTION\n  // ============================================\n\n  if (cor.change_order_subcontractors?.length > 0) {\n    if (yPos > pageHeight - 80) {\n      doc.addPage()\n      yPos = margin\n    }\n\n    doc.setFont('helvetica', 'bold')\n    doc.setFontSize(11)\n    doc.setTextColor(0, 0, 0)\n    doc.text('SUBCONTRACTORS', margin, yPos)\n    yPos += 6\n\n    autoTable(doc, {\n      startY: yPos,\n      head: [['Company', 'Description', 'Source', 'Amount']],\n      body: cor.change_order_subcontractors.map(item => [\n        item.company_name,\n        item.description,\n        item.source_reference || item.source_type,\n        formatCurrency(item.total)\n      ]),\n      foot: [[\n        { content: `Subtotal: ${formatCurrency(totals.subcontractors_subtotal)}`, colSpan: 2, styles: { halign: 'right', fontStyle: 'bold' } },\n        { content: `+${formatPercent(cor.subcontractors_markup_percent || 500)} Markup`, colSpan: 1, styles: { halign: 'right' } },\n        { content: formatCurrency(totals.subcontractors_subtotal + totals.subcontractors_markup_amount), styles: { fontStyle: 'bold' } }\n      ]],\n      margin: { left: margin, right: margin },\n      headStyles: { fillColor: primaryColor, textColor: [255, 255, 255], fontStyle: 'bold', fontSize: 8 },\n      bodyStyles: { fontSize: 8 },\n      footStyles: { fillColor: headerBg, textColor: [0, 0, 0], fontSize: 8 },\n      theme: 'striped'\n    })\n\n    yPos = doc.lastAutoTable.finalY + 10\n  }\n\n  // ============================================\n  // TOTALS SECTION\n  // ============================================\n\n  if (yPos > pageHeight - 100) {\n    doc.addPage()\n    yPos = margin\n  }\n\n  // Totals box\n  doc.setFillColor(...headerBg)\n  doc.roundedRect(margin, yPos, pageWidth - (margin * 2), 70, 3, 3, 'F')\n\n  yPos += 10\n  doc.setFontSize(10)\n  doc.setFont('helvetica', 'normal')\n  doc.setTextColor(0, 0, 0)\n\n  const totalsCol1 = margin + 10\n  const totalsCol2 = pageWidth - margin - 60\n\n  // COR Subtotal\n  doc.text('COR Subtotal:', totalsCol1, yPos)\n  doc.setFont('helvetica', 'bold')\n  doc.text(formatCurrency(totals.cor_subtotal), totalsCol2, yPos, { align: 'right' })\n  yPos += 8\n\n  // Additional Fees\n  doc.setFont('helvetica', 'normal')\n  doc.setFontSize(9)\n  doc.text(`Liability Insurance (${formatPercent(cor.liability_insurance_percent || 144)}):`, totalsCol1, yPos)\n  doc.text(formatCurrency(totals.liability_insurance_amount), totalsCol2, yPos, { align: 'right' })\n  yPos += 6\n\n  doc.text(`Bond (${formatPercent(cor.bond_percent || 100)}):`, totalsCol1, yPos)\n  doc.text(formatCurrency(totals.bond_amount), totalsCol2, yPos, { align: 'right' })\n  yPos += 6\n\n  doc.text(`City License Fee (${formatPercent(cor.license_fee_percent || 10)}):`, totalsCol1, yPos)\n  doc.text(formatCurrency(totals.license_fee_amount), totalsCol2, yPos, { align: 'right' })\n  yPos += 10\n\n  // Grand Total\n  doc.setFillColor(...primaryColor)\n  doc.roundedRect(totalsCol1 - 5, yPos - 3, pageWidth - (margin * 2) - 10, 16, 2, 2, 'F')\n  doc.setTextColor(255, 255, 255)\n  doc.setFontSize(12)\n  doc.setFont('helvetica', 'bold')\n  doc.text('COR TOTAL:', totalsCol1, yPos + 8)\n  doc.text(formatCurrency(totals.cor_total), totalsCol2, yPos + 8, { align: 'right' })\n  yPos += 25\n\n  // ============================================\n  // SIGNATURE SECTION (Dual Signatures)\n  // ============================================\n\n  if (yPos > pageHeight - 120) {\n    doc.addPage()\n    yPos = margin\n  }\n\n  yPos += 10\n  doc.setTextColor(0, 0, 0)\n  doc.setFontSize(10)\n  doc.setFont('helvetica', 'bold')\n  doc.text('AUTHORIZATION', margin, yPos)\n  yPos += 15\n\n  doc.setFont('helvetica', 'normal')\n  doc.setFontSize(9)\n  doc.setDrawColor(0, 0, 0)\n\n  // Helper function to render a signature block\n  const renderSignatureBlock = (startY, label, signatureData, signerName, signerTitle, signerCompany, signedDate) => {\n    // Label\n    doc.setFont('helvetica', 'bold')\n    doc.setFontSize(8)\n    doc.text(label, margin, startY)\n    doc.setFont('helvetica', 'normal')\n    doc.setFontSize(9)\n\n    const sigLineY = startY + 20\n\n    // Signature line\n    doc.line(margin, sigLineY, margin + 70, sigLineY)\n    doc.text('Signature', margin, sigLineY + 8)\n\n    // Title/Company line\n    doc.line(margin + 85, sigLineY, margin + 145, sigLineY)\n    doc.text('Title / Company', margin + 85, sigLineY + 8)\n\n    // Date line\n    doc.line(pageWidth - margin - 40, sigLineY, pageWidth - margin, sigLineY)\n    doc.text('Date', pageWidth - margin - 40, sigLineY + 8)\n\n    // If signature exists, add it\n    if (signatureData) {\n      try {\n        doc.addImage(signatureData, 'PNG', margin, sigLineY - 18, 60, 18)\n        if (signerName) {\n          doc.setFontSize(8)\n          doc.text(signerName, margin, sigLineY + 15)\n        }\n        if (signerTitle || signerCompany) {\n          const titleCompany = [signerTitle, signerCompany].filter(Boolean).join(' - ')\n          doc.text(titleCompany, margin + 85, sigLineY - 5)\n        }\n        if (signedDate) {\n          doc.text(formatDate(signedDate), pageWidth - margin - 40, sigLineY - 5)\n        }\n      } catch (e) {\n        console.error('Error adding signature:', e)\n      }\n    } else {\n      // Show \"Awaiting Signature\" when not yet signed\n      doc.setFont('helvetica', 'italic')\n      doc.setFontSize(9)\n      doc.setTextColor(150, 150, 150)\n      doc.text('Awaiting Signature', margin + 5, sigLineY - 5)\n      doc.setTextColor(0, 0, 0)\n      doc.setFont('helvetica', 'normal')\n    }\n\n    return sigLineY + 25\n  }\n\n  // GC Signature (Signature 1)\n  yPos = renderSignatureBlock(\n    yPos,\n    'GC AUTHORIZATION',\n    cor.gc_signature_data || cor.gc_signature,\n    cor.gc_signature_name || cor.gc_signer_name,\n    cor.gc_signature_title,\n    cor.gc_signature_company,\n    cor.gc_signature_date || cor.signed_at\n  )\n\n  yPos += 10\n\n  // Client Signature (Signature 2)\n  yPos = renderSignatureBlock(\n    yPos,\n    'CLIENT AUTHORIZATION',\n    cor.client_signature_data,\n    cor.client_signature_name,\n    cor.client_signature_title,\n    cor.client_signature_company,\n    cor.client_signature_date\n  )\n\n  // ============================================\n  // T&M BACKUP SECTION (if tickets provided)\n  // Professional Layout with Cover Page\n  // ============================================\n\n  if (tmTickets && tmTickets.length > 0) {\n    // Calculate summary statistics\n    const totalLaborHours = tmTickets.reduce((sum, t) =>\n      sum + (t.t_and_m_workers?.reduce((wSum, w) => wSum + (parseFloat(w.hours) || 0), 0) || 0), 0\n    )\n    const totalOTHours = tmTickets.reduce((sum, t) =>\n      sum + (t.t_and_m_workers?.reduce((wSum, w) => wSum + (parseFloat(w.overtime_hours) || 0), 0) || 0), 0\n    )\n    const totalPhotos = tmTickets.reduce((sum, t) => sum + (t.photos?.length || 0), 0)\n    const verifiedCount = tmTickets.filter(t => t.client_signature_data).length\n    const dateRange = tmTickets.length > 0 ? {\n      start: tmTickets.reduce((min, t) => !min || t.work_date < min ? t.work_date : min, null),\n      end: tmTickets.reduce((max, t) => !max || t.work_date > max ? t.work_date : max, null)\n    } : null\n\n    // Generate document ID with secure random suffix\n    const docIdArray = new Uint8Array(3)\n    crypto.getRandomValues(docIdArray)\n    const docIdSuffix = Array.from(docIdArray, b => b.toString(36)).join('').toUpperCase().substring(0, 4)\n    const docId = `FS-${new Date().getFullYear()}-${String(new Date().getMonth() + 1).padStart(2, '0')}${String(new Date().getDate()).padStart(2, '0')}-${docIdSuffix}`\n\n    doc.addPage()\n    yPos = margin\n\n    // ============================================\n    // BACKUP COVER PAGE\n    // ============================================\n\n    // Company Logo/Name at top\n    if (logoBase64) {\n      try {\n        doc.addImage(logoBase64, 'PNG', margin, yPos, 50, 18)\n      } catch (e) {\n        doc.setFontSize(14)\n        doc.setFont('helvetica', 'bold')\n        doc.setTextColor(...primaryColor)\n        doc.text(company?.name || 'Company Name', margin, yPos + 10)\n      }\n    } else {\n      doc.setFontSize(14)\n      doc.setFont('helvetica', 'bold')\n      doc.setTextColor(...primaryColor)\n      doc.text(company?.name || 'Company Name', margin, yPos + 10)\n    }\n    yPos += 35\n\n    // Decorative double line\n    doc.setDrawColor(...primaryColor)\n    doc.setLineWidth(0.8)\n    doc.line(margin, yPos, pageWidth - margin, yPos)\n    doc.setLineWidth(0.3)\n    doc.line(margin, yPos + 3, pageWidth - margin, yPos + 3)\n    yPos += 15\n\n    // Title\n    doc.setFontSize(22)\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(30, 41, 59)\n    doc.text('SUPPORTING DOCUMENTATION', pageWidth / 2, yPos, { align: 'center' })\n    yPos += 8\n\n    doc.setFontSize(12)\n    doc.setFont('helvetica', 'normal')\n    doc.setTextColor(100, 116, 139)\n    doc.text('Change Order Request Backup', pageWidth / 2, yPos, { align: 'center' })\n    yPos += 8\n\n    // Decorative double line\n    doc.setDrawColor(...primaryColor)\n    doc.setLineWidth(0.3)\n    doc.line(margin, yPos, pageWidth - margin, yPos)\n    doc.setLineWidth(0.8)\n    doc.line(margin, yPos + 3, pageWidth - margin, yPos + 3)\n    yPos += 20\n\n    // Reference info\n    doc.setFontSize(10)\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(30, 41, 59)\n    doc.text('COR Reference:', margin, yPos)\n    doc.setFont('helvetica', 'normal')\n    doc.text(cor.cor_number || 'N/A', margin + 35, yPos)\n\n    doc.setFont('helvetica', 'bold')\n    doc.text('Project:', pageWidth / 2, yPos)\n    doc.setFont('helvetica', 'normal')\n    doc.text(project?.name || 'N/A', pageWidth / 2 + 20, yPos)\n    yPos += 7\n\n    doc.setFont('helvetica', 'bold')\n    doc.text('Job #:', margin, yPos)\n    doc.setFont('helvetica', 'normal')\n    doc.text(project?.job_number || 'N/A', margin + 35, yPos)\n    yPos += 20\n\n    // Summary Box\n    doc.setFillColor(248, 250, 252)\n    doc.setDrawColor(203, 213, 225)\n    doc.roundedRect(margin, yPos, pageWidth - (margin * 2), 65, 4, 4, 'FD')\n\n    yPos += 10\n    doc.setFontSize(11)\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(30, 41, 59)\n    doc.text('DOCUMENTATION SUMMARY', margin + 10, yPos)\n\n    doc.setDrawColor(203, 213, 225)\n    doc.setLineWidth(0.3)\n    doc.line(margin + 10, yPos + 3, margin + 80, yPos + 3)\n    yPos += 12\n\n    doc.setFontSize(9)\n    doc.setFont('helvetica', 'normal')\n    doc.setTextColor(71, 85, 105)\n\n    const summaryCol1 = margin + 15\n    const summaryCol2 = margin + 70\n\n    doc.text('T&M Tickets:', summaryCol1, yPos)\n    doc.setFont('helvetica', 'bold')\n    doc.text(String(tmTickets.length), summaryCol2, yPos)\n    doc.setFont('helvetica', 'normal')\n    yPos += 7\n\n    doc.text('Total Labor:', summaryCol1, yPos)\n    doc.setFont('helvetica', 'bold')\n    doc.text(`${totalLaborHours.toFixed(1)} hrs`, summaryCol2, yPos)\n    doc.setFont('helvetica', 'normal')\n    yPos += 7\n\n    if (totalOTHours > 0) {\n      doc.text('Total OT:', summaryCol1, yPos)\n      doc.setFont('helvetica', 'bold')\n      doc.text(`${totalOTHours.toFixed(1)} hrs`, summaryCol2, yPos)\n      doc.setFont('helvetica', 'normal')\n      yPos += 7\n    }\n\n    doc.text('Photo Evidence:', summaryCol1, yPos)\n    doc.setFont('helvetica', 'bold')\n    doc.text(`${totalPhotos} photos`, summaryCol2, yPos)\n    doc.setFont('helvetica', 'normal')\n    yPos += 7\n\n    doc.text('Client Verified:', summaryCol1, yPos)\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(verifiedCount > 0 ? 16 : 71, verifiedCount > 0 ? 185 : 85, verifiedCount > 0 ? 129 : 105)\n    doc.text(`${verifiedCount} of ${tmTickets.length} tickets`, summaryCol2, yPos)\n    doc.setTextColor(71, 85, 105)\n    doc.setFont('helvetica', 'normal')\n    yPos += 7\n\n    if (dateRange?.start && dateRange?.end) {\n      doc.text('Date Range:', summaryCol1, yPos)\n      doc.setFont('helvetica', 'bold')\n      doc.text(`${formatDate(dateRange.start)} - ${formatDate(dateRange.end)}`, summaryCol2, yPos)\n    }\n\n    yPos += 30\n\n    // Footer info\n    doc.setFontSize(9)\n    doc.setFont('helvetica', 'normal')\n    doc.setTextColor(100, 116, 139)\n    const genDate = new Date()\n    doc.text(`Generated: ${genDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })} at ${genDate.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' })}`, margin, yPos)\n    yPos += 6\n    doc.text(`Document ID: ${docId}`, margin, yPos)\n\n    // ============================================\n    // INDIVIDUAL TICKET PAGES\n    // ============================================\n\n    for (const ticket of tmTickets) {\n      doc.addPage()\n      yPos = margin\n\n      const hasVerification = !!ticket.client_signature_data\n\n      // Ticket Header with colored left border\n      const headerHeight = 22\n      const ticketStatusColor = hasVerification ? [16, 185, 129] : (ticket.status === 'approved' ? [16, 185, 129] : [245, 158, 11])\n\n      // Colored left border\n      doc.setFillColor(...ticketStatusColor)\n      doc.rect(margin, yPos, 4, headerHeight, 'F')\n\n      // Header background\n      doc.setFillColor(248, 250, 252)\n      doc.rect(margin + 4, yPos, pageWidth - (margin * 2) - 4, headerHeight, 'F')\n\n      // Ticket title\n      doc.setFontSize(12)\n      doc.setFont('helvetica', 'bold')\n      doc.setTextColor(30, 41, 59)\n      doc.text(`T&M TICKET — ${formatDate(ticket.work_date)}`, margin + 10, yPos + 8)\n\n      // CE/PCO badge\n      if (ticket.ce_pco_number) {\n        doc.setFontSize(9)\n        doc.setFont('helvetica', 'normal')\n        doc.setTextColor(59, 130, 246)\n        doc.text(`CE/PCO: ${ticket.ce_pco_number}`, margin + 10, yPos + 16)\n      }\n\n      // Verified badge\n      if (hasVerification) {\n        doc.setFontSize(8)\n        doc.setFont('helvetica', 'bold')\n        doc.setTextColor(16, 185, 129)\n        doc.text('✓ CLIENT VERIFIED', pageWidth - margin - 35, yPos + 12)\n      }\n\n      yPos += headerHeight + 8\n\n      // Description/Notes\n      if (ticket.notes) {\n        doc.setFontSize(10)\n        doc.setFont('helvetica', 'bold')\n        doc.setTextColor(71, 85, 105)\n        doc.text('DESCRIPTION', margin, yPos)\n        yPos += 6\n\n        doc.setFontSize(9)\n        doc.setFont('helvetica', 'normal')\n        doc.setTextColor(51, 65, 85)\n        const notesLines = doc.splitTextToSize(ticket.notes, pageWidth - (margin * 2))\n        doc.text(notesLines, margin, yPos)\n        yPos += (notesLines.length * 4) + 10\n      }\n\n      // Workers table\n      if (ticket.t_and_m_workers?.length > 0) {\n        doc.setFontSize(10)\n        doc.setFont('helvetica', 'bold')\n        doc.setTextColor(71, 85, 105)\n        doc.text('LABOR', margin, yPos)\n        yPos += 6\n\n        autoTable(doc, {\n          startY: yPos,\n          head: [['Worker', 'Time Period', 'Class', 'Reg Hrs', 'OT Hrs']],\n          body: ticket.t_and_m_workers.map(w => [\n            w.name,\n            formatTimePeriod(w),\n            w.role || w.labor_class || 'Laborer',\n            w.hours?.toString() || '0',\n            w.overtime_hours?.toString() || '-'\n          ]),\n          margin: { left: margin, right: margin },\n          headStyles: { fillColor: primaryColor, textColor: [255, 255, 255], fontSize: 8, cellPadding: 3, fontStyle: 'bold' },\n          bodyStyles: { fontSize: 8, cellPadding: 3 },\n          alternateRowStyles: { fillColor: [248, 250, 252] },\n          theme: 'grid'\n        })\n\n        yPos = doc.lastAutoTable.finalY + 10\n      }\n\n      // Items table (materials/equipment)\n      if (ticket.t_and_m_items?.length > 0) {\n        if (yPos > pageHeight - 60) {\n          doc.addPage()\n          yPos = margin\n        }\n\n        doc.setFontSize(10)\n        doc.setFont('helvetica', 'bold')\n        doc.setTextColor(71, 85, 105)\n        doc.text('MATERIALS / EQUIPMENT', margin, yPos)\n\n        // Source badge\n        doc.setFontSize(7)\n        doc.setFont('helvetica', 'normal')\n        doc.setTextColor(100, 116, 139)\n        doc.text('Source: T&M Ticket', margin + 55, yPos)\n        yPos += 6\n\n        autoTable(doc, {\n          startY: yPos,\n          head: [['Item', 'Qty', 'Unit', 'Unit Cost', 'Total']],\n          body: ticket.t_and_m_items.map(item => [\n            item.materials_equipment?.name || item.description || 'Item',\n            item.quantity?.toString() || '1',\n            item.materials_equipment?.unit || 'ea',\n            item.materials_equipment?.cost_per_unit ? `$${item.materials_equipment.cost_per_unit}` : '-',\n            item.materials_equipment?.cost_per_unit && item.quantity\n              ? `$${(item.quantity * item.materials_equipment.cost_per_unit).toFixed(2)}`\n              : '-'\n          ]),\n          margin: { left: margin, right: margin },\n          headStyles: { fillColor: primaryColor, textColor: [255, 255, 255], fontSize: 8, cellPadding: 3, fontStyle: 'bold' },\n          bodyStyles: { fontSize: 8, cellPadding: 3 },\n          alternateRowStyles: { fillColor: [248, 250, 252] },\n          theme: 'grid'\n        })\n\n        yPos = doc.lastAutoTable.finalY + 10\n      }\n\n      // Photos - Professional Evidence Section\n      if (ticket.photos?.length > 0) {\n        if (yPos > pageHeight - 80) {\n          doc.addPage()\n          yPos = margin\n        }\n\n        doc.setFontSize(10)\n        doc.setFont('helvetica', 'bold')\n        doc.setTextColor(71, 85, 105)\n        doc.text('PHOTO DOCUMENTATION', margin, yPos)\n\n        // Photo count badge\n        doc.setFontSize(8)\n        doc.setFont('helvetica', 'normal')\n        doc.setTextColor(59, 130, 246)\n        doc.text(`${ticket.photos.length} photo${ticket.photos.length !== 1 ? 's' : ''}`, margin + 50, yPos)\n        yPos += 8\n\n        let xPos = margin\n        const photoWidth = 55\n        const photoHeight = 45\n        const photoGap = 6\n        const photosPerRow = 3\n        const frameWidth = 1\n\n        // Load all photos in parallel for faster PDF generation\n        const photoImages = await loadImagesAsBase64(ticket.photos)\n\n        for (let i = 0; i < ticket.photos.length; i++) {\n          // Check if we need to wrap to next row\n          if (i > 0 && i % photosPerRow === 0) {\n            xPos = margin\n            yPos += photoHeight + photoGap + 4\n          }\n\n          // Check if we need a new page\n          if (yPos + photoHeight > pageHeight - 20) {\n            doc.addPage()\n            yPos = margin\n            xPos = margin\n          }\n\n          const imgData = photoImages[i]\n          if (imgData) {\n            // Draw frame border\n            doc.setDrawColor(200, 200, 200)\n            doc.setLineWidth(frameWidth)\n            doc.rect(xPos - frameWidth, yPos - frameWidth, photoWidth + frameWidth * 2, photoHeight + frameWidth * 2, 'S')\n\n            // Add photo with shadow effect (light gray background offset)\n            doc.setFillColor(230, 230, 230)\n            doc.rect(xPos + 2, yPos + 2, photoWidth, photoHeight, 'F')\n\n            doc.addImage(imgData, 'JPEG', xPos, yPos, photoWidth, photoHeight)\n          } else {\n            // Draw placeholder for failed images\n            doc.setFillColor(245, 245, 245)\n            doc.rect(xPos, yPos, photoWidth, photoHeight, 'F')\n            doc.setDrawColor(200, 200, 200)\n            doc.rect(xPos, yPos, photoWidth, photoHeight, 'S')\n            doc.setFontSize(7)\n            doc.setTextColor(150, 150, 150)\n            doc.text('Photo unavailable', xPos + 8, yPos + photoHeight / 2)\n          }\n\n          xPos += photoWidth + photoGap\n        }\n\n        yPos += photoHeight + 12\n      }\n\n      // Client Signature Verification Block (if ticket was signed) - Professional styling\n      if (ticket.client_signature_data) {\n        if (yPos > pageHeight - 50) {\n          doc.addPage()\n          yPos = margin\n        }\n\n        // Verification block with green background\n        const verifyBlockHeight = 32\n        const verifyBlockWidth = pageWidth - (margin * 2)\n\n        // Light green background\n        doc.setFillColor(240, 253, 244) // Very light green\n        doc.roundedRect(margin, yPos, verifyBlockWidth, verifyBlockHeight, 3, 3, 'F')\n\n        // Green left accent border\n        doc.setFillColor(16, 185, 129)\n        doc.rect(margin, yPos, 4, verifyBlockHeight, 'F')\n\n        // Top border line\n        doc.setDrawColor(187, 247, 208)\n        doc.setLineWidth(0.5)\n        doc.line(margin + 4, yPos, margin + verifyBlockWidth, yPos)\n\n        // Checkmark seal icon (circle)\n        const sealX = margin + 14\n        const sealY = yPos + verifyBlockHeight / 2\n        doc.setFillColor(16, 185, 129)\n        doc.circle(sealX, sealY, 6, 'F')\n        doc.setFontSize(9)\n        doc.setTextColor(255, 255, 255)\n        doc.text('✓', sealX - 2.5, sealY + 3)\n\n        // \"CLIENT VERIFIED\" header\n        doc.setFontSize(9)\n        doc.setFont('helvetica', 'bold')\n        doc.setTextColor(16, 185, 129)\n        doc.text('CLIENT VERIFIED', margin + 26, yPos + 10)\n\n        try {\n          // Add signature image\n          const sigWidth = 50\n          const sigHeight = 16\n          doc.addImage(ticket.client_signature_data, 'PNG', margin + 26, yPos + 13, sigWidth, sigHeight)\n\n          // Add signer info to the right of signature\n          const signerName = ticket.client_signature_name || 'Client'\n          const signerTitle = ticket.client_signature_title || ''\n          const signerCompany = ticket.client_signature_company || ''\n          const signedDate = ticket.client_signature_date\n            ? formatDate(ticket.client_signature_date)\n            : ''\n\n          const infoX = margin + 85\n\n          doc.setFont('helvetica', 'bold')\n          doc.setFontSize(9)\n          doc.setTextColor(30, 41, 59)\n          doc.text(signerName, infoX, yPos + 12)\n\n          doc.setFont('helvetica', 'normal')\n          doc.setFontSize(8)\n          doc.setTextColor(71, 85, 105)\n          if (signerTitle || signerCompany) {\n            doc.text(`${signerTitle}${signerTitle && signerCompany ? ', ' : ''}${signerCompany}`, infoX, yPos + 18)\n          }\n          if (signedDate) {\n            doc.setTextColor(100, 116, 139)\n            doc.text(`Verified: ${signedDate}`, infoX, yPos + 24)\n          }\n        } catch (e) {\n          // If signature image fails, show text info\n          const signerName = ticket.client_signature_name || 'Client'\n          doc.setFont('helvetica', 'normal')\n          doc.setFontSize(9)\n          doc.setTextColor(30, 41, 59)\n          doc.text(`Signed by: ${signerName}`, margin + 26, yPos + 20)\n        }\n\n        yPos += verifyBlockHeight + 8\n      }\n\n      // Ticket divider\n      yPos += 5\n      doc.setDrawColor(200, 200, 200)\n      doc.setLineWidth(0.2)\n      doc.line(margin, yPos, pageWidth - margin, yPos)\n      yPos += 10\n    }\n  }\n\n  // ============================================\n  // FOOTER (on all pages)\n  // ============================================\n\n  const totalPages = doc.internal.getNumberOfPages()\n  for (let i = 1; i <= totalPages; i++) {\n    doc.setPage(i)\n    const footerY = pageHeight - 10\n    doc.setFontSize(8)\n    doc.setTextColor(150, 150, 150)\n    doc.text(`Generated on ${new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}`, margin, footerY)\n    doc.text(`Page ${i} of ${totalPages}`, pageWidth - margin, footerY, { align: 'right' })\n  }\n\n  // Save the PDF\n  const fileName = `${cor.cor_number || 'COR'}_${project?.job_number || 'export'}${tmTickets?.length ? '_with_backup' : ''}.pdf`\n  doc.save(fileName)\n\n  // Build export result\n  const result = {\n    success: true,\n    fileName,\n    exportedAt: new Date().toISOString(),\n    photoManifest\n  }\n\n  // Create snapshot for dispute-ready export (if requested)\n  if (createSnapshot) {\n    result.snapshot = createExportSnapshot(cor, tmTickets, photoManifest, totals)\n  }\n\n  return result\n}\n\n/**\n * Export a single T&M ticket to PDF\n * @param {Object} ticket - T&M ticket data\n * @param {Object} project - Project data\n * @param {Object} company - Company data\n * @param {Object} branding - Company branding (logoUrl, primaryColor)\n */\nexport async function exportTMTicketToPDF(ticket, project, company, branding = {}) {\n  const doc = new jsPDF('p', 'mm', 'letter')\n  const pageWidth = doc.internal.pageSize.getWidth()\n  const pageHeight = doc.internal.pageSize.getHeight()\n  const margin = 20\n  let yPos = margin\n\n  const primaryColor = branding.primaryColor\n    ? hexToRgb(branding.primaryColor)\n    : [30, 58, 95]\n\n  // ============================================\n  // HEADER\n  // ============================================\n\n  // Company info or logo\n  if (branding.logoUrl) {\n    try {\n      const logoData = await loadImageAsBase64(branding.logoUrl)\n      if (logoData) {\n        doc.addImage(logoData, 'PNG', margin, yPos, 40, 15)\n      }\n    } catch (e) {\n      // Fall back to company name\n      if (company?.name) {\n        doc.setFontSize(14)\n        doc.setFont('helvetica', 'bold')\n        doc.setTextColor(...primaryColor)\n        doc.text(company.name, margin, yPos + 8)\n      }\n    }\n  } else if (company?.name) {\n    doc.setFontSize(14)\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(...primaryColor)\n    doc.text(company.name, margin, yPos + 8)\n  }\n\n  // T&M Ticket title\n  doc.setFontSize(16)\n  doc.setFont('helvetica', 'bold')\n  doc.setTextColor(30, 41, 59)\n  doc.text('T&M TICKET', pageWidth - margin, yPos + 8, { align: 'right' })\n\n  yPos += 25\n\n  // Divider line\n  doc.setDrawColor(...primaryColor)\n  doc.setLineWidth(0.5)\n  doc.line(margin, yPos, pageWidth - margin, yPos)\n  yPos += 10\n\n  // ============================================\n  // TICKET INFO\n  // ============================================\n\n  const hasVerification = !!ticket.client_signature_data\n\n  // Status indicator\n  if (hasVerification) {\n    doc.setFillColor(240, 253, 244)\n    doc.roundedRect(pageWidth - margin - 45, yPos - 5, 45, 12, 2, 2, 'F')\n    doc.setFontSize(9)\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(16, 185, 129)\n    doc.text('✓ CLIENT VERIFIED', pageWidth - margin - 42, yPos + 3)\n  }\n\n  // Project and date info\n  doc.setFontSize(10)\n  doc.setFont('helvetica', 'bold')\n  doc.setTextColor(71, 85, 105)\n  doc.text('Project:', margin, yPos)\n  doc.setFont('helvetica', 'normal')\n  doc.setTextColor(30, 41, 59)\n  doc.text(project?.name || 'N/A', margin + 20, yPos)\n  yPos += 6\n\n  if (project?.job_number) {\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(71, 85, 105)\n    doc.text('Job #:', margin, yPos)\n    doc.setFont('helvetica', 'normal')\n    doc.setTextColor(30, 41, 59)\n    doc.text(project.job_number, margin + 20, yPos)\n    yPos += 6\n  }\n\n  doc.setFont('helvetica', 'bold')\n  doc.setTextColor(71, 85, 105)\n  doc.text('Work Date:', margin, yPos)\n  doc.setFont('helvetica', 'normal')\n  doc.setTextColor(30, 41, 59)\n  doc.text(formatDate(ticket.work_date || ticket.ticket_date), margin + 26, yPos)\n\n  if (ticket.ce_pco_number) {\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(71, 85, 105)\n    doc.text('CE/PCO:', margin + 70, yPos)\n    doc.setFont('helvetica', 'normal')\n    doc.setTextColor(59, 130, 246)\n    doc.text(ticket.ce_pco_number, margin + 88, yPos)\n  }\n\n  yPos += 12\n\n  // Description/Notes\n  if (ticket.notes) {\n    doc.setFontSize(10)\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(71, 85, 105)\n    doc.text('DESCRIPTION', margin, yPos)\n    yPos += 6\n\n    doc.setFontSize(9)\n    doc.setFont('helvetica', 'normal')\n    doc.setTextColor(51, 65, 85)\n    const notesLines = doc.splitTextToSize(ticket.notes, pageWidth - (margin * 2))\n    doc.text(notesLines, margin, yPos)\n    yPos += (notesLines.length * 4) + 10\n  }\n\n  // ============================================\n  // LABOR TABLE\n  // ============================================\n\n  if (ticket.t_and_m_workers?.length > 0) {\n    doc.setFontSize(10)\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(71, 85, 105)\n    doc.text('LABOR', margin, yPos)\n    yPos += 6\n\n    autoTable(doc, {\n      startY: yPos,\n      head: [['Worker', 'Time Period', 'Class', 'Reg Hrs', 'OT Hrs']],\n      body: ticket.t_and_m_workers.map(w => [\n        w.name,\n        formatTimePeriod(w),\n        w.role || w.labor_class || 'Laborer',\n        w.hours?.toString() || '0',\n        w.overtime_hours?.toString() || '-'\n      ]),\n      margin: { left: margin, right: margin },\n      headStyles: { fillColor: primaryColor, textColor: [255, 255, 255], fontSize: 8, cellPadding: 3, fontStyle: 'bold' },\n      bodyStyles: { fontSize: 8, cellPadding: 3 },\n      alternateRowStyles: { fillColor: [248, 250, 252] },\n      theme: 'grid'\n    })\n\n    yPos = doc.lastAutoTable.finalY + 10\n  }\n\n  // ============================================\n  // MATERIALS/EQUIPMENT\n  // ============================================\n\n  const materials = ticket.t_and_m_items || ticket.materials_equipment?.filter(m => m.type === 'material') || []\n  if (materials.length > 0) {\n    if (yPos > pageHeight - 60) {\n      doc.addPage()\n      yPos = margin\n    }\n\n    doc.setFontSize(10)\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(71, 85, 105)\n    doc.text('MATERIALS / EQUIPMENT', margin, yPos)\n    yPos += 6\n\n    autoTable(doc, {\n      startY: yPos,\n      head: [['Item', 'Qty', 'Unit']],\n      body: materials.map(item => [\n        item.materials_equipment?.name || item.description || item.name || 'Item',\n        item.quantity?.toString() || '1',\n        item.materials_equipment?.unit || item.unit || 'ea'\n      ]),\n      margin: { left: margin, right: margin },\n      headStyles: { fillColor: primaryColor, textColor: [255, 255, 255], fontSize: 8, cellPadding: 3, fontStyle: 'bold' },\n      bodyStyles: { fontSize: 8, cellPadding: 3 },\n      alternateRowStyles: { fillColor: [248, 250, 252] },\n      theme: 'grid'\n    })\n\n    yPos = doc.lastAutoTable.finalY + 10\n  }\n\n  // ============================================\n  // PHOTOS\n  // ============================================\n\n  if (ticket.photos?.length > 0) {\n    if (yPos > pageHeight - 80) {\n      doc.addPage()\n      yPos = margin\n    }\n\n    doc.setFontSize(10)\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(71, 85, 105)\n    doc.text('PHOTO DOCUMENTATION', margin, yPos)\n\n    doc.setFontSize(8)\n    doc.setFont('helvetica', 'normal')\n    doc.setTextColor(59, 130, 246)\n    doc.text(`${ticket.photos.length} photo${ticket.photos.length !== 1 ? 's' : ''}`, margin + 50, yPos)\n    yPos += 8\n\n    let xPos = margin\n    const photoWidth = 55\n    const photoHeight = 45\n    const photoGap = 6\n    const photosPerRow = 3\n\n    // Load all photos in parallel for faster PDF generation\n    const photoImages = await loadImagesAsBase64(ticket.photos)\n\n    for (let i = 0; i < ticket.photos.length; i++) {\n      if (i > 0 && i % photosPerRow === 0) {\n        xPos = margin\n        yPos += photoHeight + photoGap + 4\n      }\n\n      if (yPos + photoHeight > pageHeight - 20) {\n        doc.addPage()\n        yPos = margin\n        xPos = margin\n      }\n\n      const imgData = photoImages[i]\n      if (imgData) {\n        doc.setDrawColor(200, 200, 200)\n        doc.setLineWidth(1)\n        doc.rect(xPos - 1, yPos - 1, photoWidth + 2, photoHeight + 2, 'S')\n        doc.setFillColor(230, 230, 230)\n        doc.rect(xPos + 2, yPos + 2, photoWidth, photoHeight, 'F')\n        doc.addImage(imgData, 'JPEG', xPos, yPos, photoWidth, photoHeight)\n      } else {\n        doc.setFillColor(245, 245, 245)\n        doc.rect(xPos, yPos, photoWidth, photoHeight, 'F')\n        doc.setDrawColor(200, 200, 200)\n        doc.rect(xPos, yPos, photoWidth, photoHeight, 'S')\n        doc.setFontSize(7)\n        doc.setTextColor(150, 150, 150)\n        doc.text('Photo unavailable', xPos + 8, yPos + photoHeight / 2)\n      }\n\n      xPos += photoWidth + photoGap\n    }\n\n    yPos += photoHeight + 12\n  }\n\n  // ============================================\n  // CLIENT VERIFICATION\n  // ============================================\n\n  if (ticket.client_signature_data) {\n    if (yPos > pageHeight - 50) {\n      doc.addPage()\n      yPos = margin\n    }\n\n    const verifyBlockHeight = 32\n    const verifyBlockWidth = pageWidth - (margin * 2)\n\n    doc.setFillColor(240, 253, 244)\n    doc.roundedRect(margin, yPos, verifyBlockWidth, verifyBlockHeight, 3, 3, 'F')\n\n    doc.setFillColor(16, 185, 129)\n    doc.rect(margin, yPos, 4, verifyBlockHeight, 'F')\n\n    doc.setDrawColor(187, 247, 208)\n    doc.setLineWidth(0.5)\n    doc.line(margin + 4, yPos, margin + verifyBlockWidth, yPos)\n\n    const sealX = margin + 14\n    const sealY = yPos + verifyBlockHeight / 2\n    doc.setFillColor(16, 185, 129)\n    doc.circle(sealX, sealY, 6, 'F')\n    doc.setFontSize(9)\n    doc.setTextColor(255, 255, 255)\n    doc.text('✓', sealX - 2.5, sealY + 3)\n\n    doc.setFontSize(9)\n    doc.setFont('helvetica', 'bold')\n    doc.setTextColor(16, 185, 129)\n    doc.text('CLIENT VERIFIED', margin + 26, yPos + 10)\n\n    try {\n      const sigWidth = 50\n      const sigHeight = 16\n      doc.addImage(ticket.client_signature_data, 'PNG', margin + 26, yPos + 13, sigWidth, sigHeight)\n\n      const signerName = ticket.client_signature_name || 'Client'\n      const signerTitle = ticket.client_signature_title || ''\n      const signerCompany = ticket.client_signature_company || ''\n      const signedDate = ticket.client_signature_date\n        ? formatDate(ticket.client_signature_date)\n        : ''\n\n      const infoX = margin + 85\n\n      doc.setFont('helvetica', 'bold')\n      doc.setFontSize(9)\n      doc.setTextColor(30, 41, 59)\n      doc.text(signerName, infoX, yPos + 12)\n\n      doc.setFont('helvetica', 'normal')\n      doc.setFontSize(8)\n      doc.setTextColor(71, 85, 105)\n      if (signerTitle || signerCompany) {\n        doc.text(`${signerTitle}${signerTitle && signerCompany ? ', ' : ''}${signerCompany}`, infoX, yPos + 18)\n      }\n      if (signedDate) {\n        doc.setTextColor(100, 116, 139)\n        doc.text(`Verified: ${signedDate}`, infoX, yPos + 24)\n      }\n    } catch (e) {\n      const signerName = ticket.client_signature_name || 'Client'\n      doc.setFont('helvetica', 'normal')\n      doc.setFontSize(9)\n      doc.setTextColor(30, 41, 59)\n      doc.text(`Signed by: ${signerName}`, margin + 26, yPos + 20)\n    }\n\n    yPos += verifyBlockHeight + 8\n  }\n\n  // ============================================\n  // FOOTER\n  // ============================================\n\n  const totalPages = doc.internal.getNumberOfPages()\n  for (let i = 1; i <= totalPages; i++) {\n    doc.setPage(i)\n    const footerY = pageHeight - 10\n    doc.setFontSize(8)\n    doc.setTextColor(150, 150, 150)\n    doc.text(`Generated on ${new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}`, margin, footerY)\n    doc.text(`Page ${i} of ${totalPages}`, pageWidth - margin, footerY, { align: 'right' })\n  }\n\n  // Save the PDF\n  const ticketDate = formatDate(ticket.work_date || ticket.ticket_date).replace(/\\//g, '-')\n  const fileName = `TM_Ticket_${ticketDate}${ticket.ce_pco_number ? '_' + ticket.ce_pco_number : ''}.pdf`\n  doc.save(fileName)\n\n  return { success: true, fileName }\n}\n","import { useState, useRef, useEffect } from 'react'\nimport { X, Check, RotateCcw, Pen, Shield } from 'lucide-react'\n\n/**\n * Unified Signature Capture Component\n *\n * Consolidates all signature implementations into one reusable component.\n * Supports simple mode (name + signature) and enhanced mode (name, title, company, acknowledgment).\n *\n * Usage:\n *   <SignatureCanvas onSave={handleSave} onClose={handleClose} />\n *   <SignatureCanvas onSave={handleSave} onClose={handleClose} enhanced title=\"GC Authorization\" />\n */\nexport default function SignatureCanvas({\n  onSave,\n  onClose,\n  // Display options\n  title = 'Signature',\n  enhanced = false,\n  slot = null,\n  documentType = null,\n  documentTitle = '',\n  // Pre-fill values\n  signerName: initialName = '',\n  signerTitle: initialTitle = '',\n  signerCompany: initialCompany = '',\n  // Customization\n  legalText = null,\n  requireAcknowledgment = false,\n  canvasWidth = 500,\n  canvasHeight = 180,\n  lockBodyScroll = false\n}) {\n  const canvasRef = useRef(null)\n  const [signerName, setSignerName] = useState(initialName)\n  const [signerTitle, setSignerTitle] = useState(initialTitle)\n  const [signerCompany, setSignerCompany] = useState(initialCompany)\n  const [hasSignature, setHasSignature] = useState(false)\n  const [isDrawing, setIsDrawing] = useState(false)\n  const [acknowledged, setAcknowledged] = useState(!requireAcknowledgment)\n\n  // Derive display strings\n  const displayTitle = slot\n    ? (slot === 1 ? 'GC Authorization' : 'Client Authorization')\n    : title\n\n  const docTypeLabel = documentType === 'cor'\n    ? 'Change Order Request'\n    : documentType === 'tm_ticket'\n      ? 'T&M Work Order'\n      : 'document'\n\n  const defaultLegalText = `I acknowledge that this electronic signature is legally binding and that I have reviewed and approve this ${docTypeLabel}. I understand that my signature, name, and IP address will be recorded for verification purposes.`\n\n  // Lock body scroll when modal is open (for mobile)\n  useEffect(() => {\n    if (!lockBodyScroll) return\n\n    const originalOverflow = document.body.style.overflow\n    const originalPosition = document.body.style.position\n    const originalTop = document.body.style.top\n    const scrollY = window.scrollY\n\n    document.body.style.overflow = 'hidden'\n    document.body.style.position = 'fixed'\n    document.body.style.top = `-${scrollY}px`\n    document.body.style.width = '100%'\n\n    return () => {\n      document.body.style.overflow = originalOverflow\n      document.body.style.position = originalPosition\n      document.body.style.top = originalTop\n      document.body.style.width = ''\n      window.scrollTo(0, scrollY)\n    }\n  }, [lockBodyScroll])\n\n  const getContext = () => {\n    const canvas = canvasRef.current\n    if (!canvas) return null\n    return canvas.getContext('2d')\n  }\n\n  const getPosition = (e) => {\n    const canvas = canvasRef.current\n    if (!canvas) return { x: 0, y: 0 }\n\n    const rect = canvas.getBoundingClientRect()\n    const scaleX = canvas.width / rect.width\n    const scaleY = canvas.height / rect.height\n\n    const clientX = e.touches?.length ? e.touches[0].clientX : e.clientX\n    const clientY = e.touches?.length ? e.touches[0].clientY : e.clientY\n\n    return {\n      x: (clientX - rect.left) * scaleX,\n      y: (clientY - rect.top) * scaleY\n    }\n  }\n\n  const startDrawing = (e) => {\n    e.preventDefault()\n    const ctx = getContext()\n    if (!ctx) return\n    const { x, y } = getPosition(e)\n    ctx.beginPath()\n    ctx.moveTo(x, y)\n    setIsDrawing(true)\n    setHasSignature(true)\n  }\n\n  const draw = (e) => {\n    if (!isDrawing) return\n    e.preventDefault()\n    const ctx = getContext()\n    if (!ctx) return\n    const { x, y } = getPosition(e)\n    ctx.lineTo(x, y)\n    ctx.stroke()\n  }\n\n  const stopDrawing = () => {\n    setIsDrawing(false)\n  }\n\n  const clearSignature = () => {\n    const canvas = canvasRef.current\n    const ctx = getContext()\n    if (!canvas || !ctx) return\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\n    setHasSignature(false)\n  }\n\n  const initCanvas = (canvas) => {\n    if (!canvas) return\n    canvasRef.current = canvas\n    const ctx = canvas.getContext('2d')\n    ctx.strokeStyle = '#1e293b'\n    ctx.lineWidth = 2\n    ctx.lineCap = 'round'\n    ctx.lineJoin = 'round'\n  }\n\n  const isValid = hasSignature && signerName.trim() && acknowledged\n\n  const handleSave = () => {\n    if (!isValid) return\n    const canvas = canvasRef.current\n    if (!canvas) return\n\n    const signatureData = canvas.toDataURL('image/png')\n\n    const result = {\n      signature: signatureData,\n      signerName: signerName.trim(),\n      signedAt: new Date().toISOString()\n    }\n\n    if (enhanced) {\n      result.signerTitle = signerTitle.trim() || null\n      result.signerCompany = signerCompany.trim() || null\n    }\n\n    onSave(result)\n  }\n\n  return (\n    <div className=\"modal-overlay\" onClick={onClose} role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"signature-title\">\n      <div className={`modal-content signature-modal${enhanced ? ' enhanced' : ''}`} onClick={e => e.stopPropagation()}>\n        <div className=\"modal-header\">\n          <div className=\"signature-header-info\">\n            <h2 id=\"signature-title\">{displayTitle}</h2>\n            {documentTitle && (\n              <span className=\"signature-doc-ref\">{documentTitle}</span>\n            )}\n          </div>\n          <button className=\"close-btn\" onClick={onClose} aria-label=\"Close signature modal\">\n            <X size={20} aria-hidden=\"true\" />\n          </button>\n        </div>\n\n        <div className=\"modal-body signature-body\">\n          {slot && (\n            <div className=\"signature-slot-badge\">\n              <Shield size={14} />\n              <span>Signature {slot} of 2</span>\n            </div>\n          )}\n\n          {/* Signer info fields */}\n          <div className=\"signature-fields\">\n            <div className=\"form-group required\">\n              <label htmlFor=\"sig-name\">{enhanced ? 'Print Name' : 'Signer Name *'}</label>\n              <input\n                id=\"sig-name\"\n                type=\"text\"\n                value={signerName}\n                onChange={(e) => setSignerName(e.target.value)}\n                placeholder={enhanced ? 'Enter your full legal name' : 'Enter full name'}\n                aria-required=\"true\"\n                className=\"input-required\"\n              />\n            </div>\n\n            {enhanced && (\n              <div className=\"signature-fields-row\">\n                <div className=\"form-group\">\n                  <label htmlFor=\"sig-title\">Title</label>\n                  <input\n                    id=\"sig-title\"\n                    type=\"text\"\n                    value={signerTitle}\n                    onChange={(e) => setSignerTitle(e.target.value)}\n                    placeholder=\"e.g., Project Manager\"\n                  />\n                </div>\n                <div className=\"form-group\">\n                  <label htmlFor=\"sig-company\">Company</label>\n                  <input\n                    id=\"sig-company\"\n                    type=\"text\"\n                    value={signerCompany}\n                    onChange={(e) => setSignerCompany(e.target.value)}\n                    placeholder=\"e.g., ABC Construction\"\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Signature canvas */}\n          <div className=\"signature-area\">\n            <div className=\"signature-label\" id=\"signature-instructions\">\n              <Pen size={16} aria-hidden=\"true\" />\n              <span>{enhanced ? 'Draw your signature below' : 'Sign below'}</span>\n            </div>\n\n            <div className=\"signature-canvas-container\">\n              <canvas\n                ref={initCanvas}\n                width={canvasWidth}\n                height={canvasHeight}\n                className=\"signature-canvas\"\n                onMouseDown={startDrawing}\n                onMouseMove={draw}\n                onMouseUp={stopDrawing}\n                onMouseLeave={stopDrawing}\n                onTouchStart={startDrawing}\n                onTouchMove={draw}\n                onTouchEnd={stopDrawing}\n                role=\"img\"\n                aria-label=\"Signature drawing area. Use mouse or touch to draw your signature.\"\n                aria-describedby=\"signature-instructions\"\n                tabIndex={0}\n              />\n              {!hasSignature && (\n                <div className=\"signature-placeholder\">Sign here</div>\n              )}\n            </div>\n\n            <button\n              className=\"btn btn-ghost btn-small\"\n              onClick={clearSignature}\n              disabled={!hasSignature}\n              aria-label=\"Clear signature\"\n            >\n              <RotateCcw size={14} aria-hidden=\"true\" /> Clear\n            </button>\n          </div>\n\n          {/* Legal acknowledgment */}\n          {requireAcknowledgment ? (\n            <div className=\"signature-acknowledgment\">\n              <label className=\"checkbox-label\">\n                <input\n                  type=\"checkbox\"\n                  checked={acknowledged}\n                  onChange={(e) => setAcknowledged(e.target.checked)}\n                />\n                <span>{legalText || defaultLegalText}</span>\n              </label>\n            </div>\n          ) : (\n            <p className=\"signature-legal\" role=\"note\">\n              {legalText || `By signing above, I acknowledge that I have reviewed and approve this ${docTypeLabel}.`}\n            </p>\n          )}\n        </div>\n\n        <div className=\"modal-footer\">\n          <button className=\"btn btn-secondary\" onClick={onClose} aria-label=\"Cancel and close\">\n            Cancel\n          </button>\n          <button\n            className=\"btn btn-primary\"\n            onClick={handleSave}\n            disabled={!isValid}\n            aria-label={enhanced ? 'Submit signature' : 'Save signature'}\n          >\n            <Check size={16} aria-hidden=\"true\" /> {enhanced ? 'Submit Signature' : 'Save Signature'}\n          </button>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":["formatTime","timeStr","hours","minutes","h","ampm","formatTimePeriod","worker","verifyPhotosForExport","tmTickets","manifest","verified","failed","issues","ticket","photoUrl","entry","loadImageAsBase64","err","createExportSnapshot","cor","photoManifest","totals","dataString","hash","i","char","checksum","exportCORToPDF","project","company","branding","options","verifyPhotos","createSnapshot","doc","jsPDF","pageWidth","pageHeight","margin","yPos","calculateCORTotals","primaryColor","hexToRgb","headerBg","logoBase64","e","statusText","col1X","col2X","formatDateRange","formatDate","scopeLines","autoTable","item","centsToDollars","formatCurrency","formatPercent","totalsCol1","totalsCol2","renderSignatureBlock","startY","label","signatureData","signerName","signerTitle","signerCompany","signedDate","sigLineY","titleCompany","totalLaborHours","sum","t","wSum","w","totalOTHours","totalPhotos","verifiedCount","dateRange","min","max","docIdArray","docIdSuffix","b","docId","summaryCol1","summaryCol2","genDate","hasVerification","headerHeight","ticketStatusColor","notesLines","xPos","photoWidth","photoHeight","photoGap","photosPerRow","frameWidth","photoImages","loadImagesAsBase64","imgData","verifyBlockHeight","verifyBlockWidth","sealX","sealY","infoX","totalPages","footerY","fileName","result","exportTMTicketToPDF","logoData","materials","m","SignatureCanvas","onSave","onClose","title","enhanced","slot","documentType","documentTitle","initialName","initialTitle","initialCompany","legalText","requireAcknowledgment","canvasWidth","canvasHeight","lockBodyScroll","canvasRef","useRef","setSignerName","useState","setSignerTitle","setSignerCompany","hasSignature","setHasSignature","isDrawing","setIsDrawing","acknowledged","setAcknowledged","displayTitle","docTypeLabel","defaultLegalText","useEffect","originalOverflow","originalPosition","originalTop","scrollY","getContext","canvas","getPosition","rect","scaleX","scaleY","clientX","clientY","startDrawing","ctx","x","y","draw","stopDrawing","clearSignature","initCanvas","isValid","handleSave","jsx","jsxs","X","Shield","Pen","RotateCcw","Check"],"mappings":"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"}