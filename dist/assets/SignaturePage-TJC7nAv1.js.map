{"version":3,"file":"SignaturePage-TJC7nAv1.js","sources":["../../src/components/SignaturePage.jsx"],"sourcesContent":["import { useState, useEffect, useMemo } from 'react'\nimport { FileText, CheckCircle, Clock, AlertCircle, Building2, Users, Package, Truck, Briefcase, Download, Camera, HardHat, ChevronDown, ChevronRight, Calendar } from 'lucide-react'\nimport { db, supabase, isSupabaseConfigured } from '../lib/supabase'\nimport { calculateCORTotals, formatCurrency, formatPercent, centsToDollars, formatDateRange } from '../lib/corCalculations'\nimport { exportCORToPDF, exportTMTicketToPDF } from '../lib/corPdfExport'\nimport SignatureCanvas from './ui/SignatureCanvas'\n\n// Helper to format date\nconst formatDate = (dateString) => {\n  if (!dateString) return ''\n  return new Date(dateString).toLocaleDateString('en-US', {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric'\n  })\n}\n\n// Helper to format time (HH:MM or HH:MM:SS to 9:00am format)\nconst formatTime = (timeStr) => {\n  if (!timeStr) return ''\n  const [hours, minutes] = timeStr.split(':')\n  const h = parseInt(hours)\n  const ampm = h >= 12 ? 'pm' : 'am'\n  const h12 = h % 12 || 12\n  return `${h12}:${minutes}${ampm}`\n}\n\n// Status badge component\nconst StatusBadge = ({ status }) => {\n  const statusMap = {\n    draft: { label: 'Draft', color: '#6b7280', bg: '#f3f4f6' },\n    pending_approval: { label: 'Pending Approval', color: '#d97706', bg: '#fef3c7' },\n    approved: { label: 'Approved', color: '#059669', bg: '#d1fae5' },\n    rejected: { label: 'Rejected', color: '#dc2626', bg: '#fee2e2' },\n    billed: { label: 'Billed', color: '#2563eb', bg: '#dbeafe' },\n    closed: { label: 'Closed', color: '#4b5563', bg: '#e5e7eb' }\n  }\n  const info = statusMap[status] || statusMap.draft\n  return (\n    <span\n      className=\"cor-status-badge\"\n      style={{ color: info.color, backgroundColor: info.bg }}\n    >\n      {info.label}\n    </span>\n  )\n}\n\nexport default function SignaturePage({ signatureToken }) {\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState(null)\n  const [signatureRequest, setSignatureRequest] = useState(null)\n  const [document, setDocument] = useState(null)\n  const [showSignatureModal, setShowSignatureModal] = useState(false)\n  const [activeSlot, setActiveSlot] = useState(null)\n  const [submitting, setSubmitting] = useState(false)\n  const [successMessage, setSuccessMessage] = useState(null)\n  const [downloading, setDownloading] = useState(false)\n\n  // T&M backup documentation state\n  const [backupTickets, setBackupTickets] = useState([])\n  const [backupExpanded, setBackupExpanded] = useState(false)\n  const [expandedTickets, setExpandedTickets] = useState(new Set())\n\n  // Company branding state\n  const [companyBranding, setCompanyBranding] = useState(null)\n\n  // Load signature request and document\n  useEffect(() => {\n    loadData()\n  }, [signatureToken])\n\n  const loadData = async () => {\n    try {\n      setLoading(true)\n      setError(null)\n\n      // Get signature request by token\n      const request = await db.getSignatureRequestByToken(signatureToken)\n      if (!request) {\n        setError('This signature link is invalid or has expired.')\n        return\n      }\n\n      if (request.status === 'completed') {\n        setError('This document has already been fully signed.')\n        return\n      }\n\n      if (request.status === 'revoked') {\n        setError('This signature link has been revoked.')\n        return\n      }\n\n      if (request.status === 'expired') {\n        setError('This signature link has expired.')\n        return\n      }\n\n      setSignatureRequest(request)\n\n      // Get the document data\n      const docData = await db.getDocumentForSigning(request.document_type, request.document_id)\n      if (!docData) {\n        setError('The document associated with this link could not be found.')\n        return\n      }\n\n      setDocument(docData)\n\n      // Load T&M backup tickets if this is a COR\n      if (request.document_type === 'cor' && docData?.id) {\n        try {\n          const tickets = await db.getCORTickets(docData.id)\n          setBackupTickets(tickets || [])\n        } catch (err) {\n          console.warn('Failed to load backup tickets:', err)\n        }\n      }\n\n      // Load company branding for PDF exports\n      const companyId = docData?.projects?.companies?.id\n      if (companyId && isSupabaseConfigured) {\n        try {\n          const { data: brandingData } = await supabase\n            .from('company_branding')\n            .select('primary_color, logo_url')\n            .eq('company_id', companyId)\n            .single()\n          if (brandingData) {\n            setCompanyBranding(brandingData)\n          }\n        } catch (err) {\n          console.warn('Failed to load company branding:', err)\n        }\n      }\n    } catch (err) {\n      console.error('Error loading signature data:', err)\n      setError('Unable to load signature request. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // Calculate COR totals\n  const totals = useMemo(() => {\n    if (!document || signatureRequest?.document_type !== 'cor') return null\n    return calculateCORTotals(document)\n  }, [document, signatureRequest])\n\n  // Get available signature slots\n  const getSignatureStatus = () => {\n    if (!signatureRequest) return { slot1: null, slot2: null, availableSlots: [] }\n\n    const signatures = signatureRequest.signatures || []\n    const slot1 = signatures.find(s => s.signature_slot === 1)\n    const slot2 = signatures.find(s => s.signature_slot === 2)\n    const availableSlots = []\n    if (!slot1) availableSlots.push(1)\n    if (!slot2) availableSlots.push(2)\n\n    return { slot1, slot2, availableSlots }\n  }\n\n  // Get client IP address\n  const getClientIP = async () => {\n    try {\n      const response = await fetch('https://api.ipify.org?format=json')\n      const data = await response.json()\n      return data.ip\n    } catch {\n      return null\n    }\n  }\n\n  // Handle signature submission\n  const handleSignatureSubmit = async (signatureData) => {\n    if (!signatureRequest || !activeSlot) return\n\n    try {\n      setSubmitting(true)\n\n      // Get IP address\n      const ipAddress = await getClientIP()\n\n      // Add signature\n      const signature = await db.addSignature(signatureRequest.id, activeSlot, {\n        ...signatureData,\n        ipAddress,\n        userAgent: navigator.userAgent\n      })\n\n      // Sync signature to main document table\n      await db.syncSignatureToDocument(signature, signatureRequest)\n\n      // Reload data to get updated status\n      await loadData()\n\n      setShowSignatureModal(false)\n      setActiveSlot(null)\n      // Show persistent signed confirmation (don't auto-clear)\n      setSuccessMessage('signed')\n    } catch (err) {\n      console.error('Error submitting signature:', err)\n      setError('Failed to submit signature. Please try again.')\n    } finally {\n      setSubmitting(false)\n    }\n  }\n\n  // Open signature modal for a specific slot\n  const openSignatureModal = (slot) => {\n    setActiveSlot(slot)\n    setShowSignatureModal(true)\n  }\n\n  // Handle PDF download with T&M backup\n  const handleDownload = async () => {\n    if (!document || !signatureRequest) return\n\n    const docCompany = document?.projects?.companies\n    const docProject = document?.projects\n\n    try {\n      setDownloading(true)\n\n      // Fetch associated T&M tickets if this is a COR\n      let tmTickets = null\n      if (signatureRequest?.document_type === 'cor') {\n        try {\n          tmTickets = await db.getCORTickets(document.id)\n        } catch (err) {\n          console.warn('Failed to fetch T&M tickets for backup:', err)\n          // Continue without T&M backup\n        }\n      }\n\n      // Get branding from company branding data or company logo\n      const branding = {\n        logoUrl: companyBranding?.logo_url || docCompany?.logo_url,\n        primaryColor: companyBranding?.primary_color\n      }\n\n      // Export PDF with T&M backup\n      await exportCORToPDF(document, docProject, docCompany, branding, tmTickets)\n\n      setSuccessMessage('PDF downloaded successfully!')\n      setTimeout(() => setSuccessMessage(null), 3000)\n    } catch (err) {\n      console.error('Download failed:', err)\n      setError('Failed to generate PDF. Please try again.')\n    } finally {\n      setDownloading(false)\n    }\n  }\n\n  // Handle T&M Ticket PDF download\n  const handleDownloadTMTicket = async () => {\n    if (!document || !signatureRequest) return\n\n    const docCompany = document?.projects?.companies\n    const docProject = document?.projects\n\n    try {\n      setDownloading(true)\n\n      // Get branding from company branding data or company logo\n      const branding = {\n        logoUrl: companyBranding?.logo_url || docCompany?.logo_url,\n        primaryColor: companyBranding?.primary_color\n      }\n\n      // Export T&M Ticket PDF\n      await exportTMTicketToPDF(document, docProject, docCompany, branding)\n\n      setSuccessMessage('PDF downloaded successfully!')\n      setTimeout(() => setSuccessMessage(null), 3000)\n    } catch (err) {\n      console.error('Download failed:', err)\n      setError('Failed to generate PDF. Please try again.')\n    } finally {\n      setDownloading(false)\n    }\n  }\n\n  // Render loading state\n  if (loading) {\n    return (\n      <div className=\"signature-page\">\n        <div className=\"signature-page-loading\">\n          <div className=\"loading-spinner\"></div>\n          <p>Loading document...</p>\n        </div>\n      </div>\n    )\n  }\n\n  // Render error state\n  if (error) {\n    return (\n      <div className=\"signature-page\">\n        <div className=\"signature-page-error\">\n          <AlertCircle size={48} />\n          <h2>Unable to Load Document</h2>\n          <p>{error}</p>\n        </div>\n      </div>\n    )\n  }\n\n  const { slot1, slot2, availableSlots } = getSignatureStatus()\n  // Only one signature is required - either slot1 OR slot2\n  const isFullySigned = slot1 || slot2\n  const isCOR = signatureRequest?.document_type === 'cor'\n  const company = document?.projects?.companies\n  const project = document?.projects\n\n  // Render T&M ticket (simpler view)\n  if (!isCOR) {\n    const workerCount = document.t_and_m_workers?.length || 0\n    const totalHours = document.t_and_m_workers?.reduce((sum, w) => sum + (w.hours || 0), 0) || 0\n\n    return (\n      <div className=\"signature-page\">\n        <header className=\"signature-page-header\">\n          {company?.logo_url ? (\n            <img src={company.logo_url} alt={company.name} className=\"company-logo\" />\n          ) : (\n            <div className=\"company-logo-placeholder\">\n              <Building2 size={24} />\n            </div>\n          )}\n          <div className=\"company-info\">\n            <h1>{company?.name || 'FieldSync'}</h1>\n            <span className=\"doc-type-label\">T&M Ticket Signature</span>\n          </div>\n        </header>\n\n        {successMessage === 'signed' && (\n          <div className=\"signature-signed-overlay\">\n            <div className=\"signature-signed-content\">\n              <CheckCircle size={48} />\n              <h2>Document Signed Successfully</h2>\n              <p>This document has been signed and submitted.</p>\n              <button\n                className=\"btn btn-primary download-copy-btn\"\n                onClick={handleDownloadTMTicket}\n                disabled={downloading}\n              >\n                {downloading ? (\n                  <>\n                    <span className=\"btn-spinner\"></span>\n                    Generating PDF...\n                  </>\n                ) : (\n                  <>\n                    <Download size={18} />\n                    Save a Copy for Your Records\n                  </>\n                )}\n              </button>\n              <p className=\"close-prompt\">You may close this page when done.</p>\n            </div>\n          </div>\n        )}\n\n        <main className=\"signature-page-content\">\n          <div className=\"signature-document-card\">\n            <div className=\"document-card-header\">\n              <FileText size={20} />\n              <div className=\"document-card-title\">\n                <h2>T&M Ticket</h2>\n                <span className=\"document-subtitle\">\n                  {document.ce_pco_number ? `CE/PCO: ${document.ce_pco_number}` : 'Time & Materials'}\n                </span>\n              </div>\n            </div>\n\n            <div className=\"document-card-details\">\n              <div className=\"detail-row\">\n                <span className=\"detail-label\">Project</span>\n                <span className=\"detail-value\">{project?.name}</span>\n              </div>\n              <div className=\"detail-row\">\n                <span className=\"detail-label\">Work Date</span>\n                <span className=\"detail-value\">{formatDate(document.work_date)}</span>\n              </div>\n              <div className=\"detail-row\">\n                <span className=\"detail-label\">Workers</span>\n                <span className=\"detail-value\">{workerCount} ({totalHours} hrs)</span>\n              </div>\n              {document.notes && (\n                <div className=\"detail-row full-width\">\n                  <span className=\"detail-label\">Description</span>\n                  <span className=\"detail-value\">{document.notes}</span>\n                </div>\n              )}\n            </div>\n\n            {/* Full Ticket Details - Workers */}\n            {document.t_and_m_workers?.length > 0 && (\n              <div className=\"signature-detail-section\">\n                <h4><HardHat size={16} /> Workers</h4>\n                <table className=\"signature-detail-table\">\n                  <thead>\n                    <tr>\n                      <th>Name</th>\n                      <th>Role</th>\n                      <th>Time</th>\n                      <th>Reg Hrs</th>\n                      <th>OT</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {document.t_and_m_workers.map((w, idx) => (\n                      <tr key={idx}>\n                        <td>{w.name}</td>\n                        <td>{w.role || 'Laborer'}</td>\n                        <td>\n                          {w.time_started && w.time_ended\n                            ? `${formatTime(w.time_started)} - ${formatTime(w.time_ended)}`\n                            : '-'}\n                        </td>\n                        <td>{w.hours || 0}</td>\n                        <td>{w.overtime_hours || '-'}</td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n\n            {/* Full Ticket Details - Materials/Equipment */}\n            {document.t_and_m_items?.length > 0 && (\n              <div className=\"signature-detail-section\">\n                <h4><Package size={16} /> Materials & Equipment</h4>\n                <table className=\"signature-detail-table\">\n                  <thead>\n                    <tr>\n                      <th>Item</th>\n                      <th>Qty</th>\n                      <th>Unit</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {document.t_and_m_items.map((item, idx) => (\n                      <tr key={idx}>\n                        <td>{item.custom_name || item.materials_equipment?.name || 'Item'}</td>\n                        <td>{item.quantity}</td>\n                        <td>{item.materials_equipment?.unit || 'each'}</td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n\n            {/* Full Ticket Details - Photos */}\n            {document.photos?.length > 0 && (\n              <div className=\"signature-detail-section\">\n                <h4><Camera size={16} /> Photos ({document.photos.length})</h4>\n                <div className=\"signature-photo-grid\">\n                  {document.photos.map((photo, idx) => (\n                    <div key={idx} className=\"signature-photo-thumb\">\n                      <img\n                        src={typeof photo === 'string' ? photo : photo.url}\n                        alt={`Photo ${idx + 1}`}\n                        onError={(e) => { e.target.style.display = 'none' }}\n                      />\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Signature section */}\n          <div className=\"signature-status-section\">\n            <h3>Signature</h3>\n            {!isFullySigned ? (\n              <>\n                {renderSignatureSlot(1, slot1, 'GC Authorization', openSignatureModal, submitting)}\n                {!slot1 && <p className=\"or-divider\">— or —</p>}\n                {renderSignatureSlot(2, slot2, 'Client Authorization', openSignatureModal, submitting)}\n              </>\n            ) : (\n              <>\n                {slot1 && renderSignatureSlot(1, slot1, 'GC Authorization', openSignatureModal, submitting)}\n                {slot2 && renderSignatureSlot(2, slot2, 'Client Authorization', openSignatureModal, submitting)}\n              </>\n            )}\n            {isFullySigned && (\n              <div className=\"fully-signed-message\">\n                <CheckCircle size={24} />\n                <p>This document has been signed.</p>\n              </div>\n            )}\n          </div>\n        </main>\n\n        <footer className=\"signature-page-footer\">\n          <p>Powered by FieldSync</p>\n        </footer>\n\n        {showSignatureModal && activeSlot && (\n          <SignatureCanvas\n            enhanced\n            requireAcknowledgment\n            lockBodyScroll\n            slot={activeSlot}\n            documentType=\"tm_ticket\"\n            documentTitle=\"T&M Ticket\"\n            onSave={handleSignatureSubmit}\n            onClose={() => {\n              setShowSignatureModal(false)\n              setActiveSlot(null)\n            }}\n          />\n        )}\n      </div>\n    )\n  }\n\n  // Render full COR document\n  return (\n    <div className=\"signature-page\">\n      {/* Header with company branding */}\n      <header className=\"signature-page-header\">\n        {company?.logo_url ? (\n          <img src={company.logo_url} alt={company.name} className=\"company-logo\" />\n        ) : (\n          <div className=\"company-logo-placeholder\">\n            <Building2 size={24} />\n          </div>\n        )}\n        <div className=\"company-info\">\n          <h1>{company?.name || 'FieldSync'}</h1>\n          <span className=\"doc-type-label\">Change Order Request</span>\n        </div>\n      </header>\n\n      {/* Success message - persistent signed confirmation */}\n      {successMessage === 'signed' && (\n        <div className=\"signature-signed-overlay\">\n          <div className=\"signature-signed-content\">\n            <CheckCircle size={48} />\n            <h2>Document Signed Successfully</h2>\n            <p>This document has been signed and submitted.</p>\n            <button\n              className=\"btn btn-primary download-copy-btn\"\n              onClick={handleDownload}\n              disabled={downloading}\n            >\n              {downloading ? (\n                <>\n                  <span className=\"btn-spinner\"></span>\n                  Generating PDF...\n                </>\n              ) : (\n                <>\n                  <Download size={18} />\n                  Save a Copy for Your Records\n                </>\n              )}\n            </button>\n            <p className=\"close-prompt\">You may close this page when done.</p>\n          </div>\n        </div>\n      )}\n\n      {/* Main COR Document */}\n      <main className=\"signature-page-content cor-full-document\">\n        {/* COR Header Card */}\n        <div className=\"cor-header-card\">\n          <div className=\"cor-header-top\">\n            <div className=\"cor-title-section\">\n              <h2 className=\"cor-number\">{document.cor_number}</h2>\n              <StatusBadge status={document.status} />\n            </div>\n            <div className=\"cor-date\">\n              Created {formatDate(document.created_at)}\n            </div>\n          </div>\n\n          <h3 className=\"cor-title\">{document.title || 'Untitled Change Order'}</h3>\n\n          <div className=\"cor-info-grid\">\n            <div className=\"cor-info-item\">\n              <span className=\"cor-info-label\">Project</span>\n              <span className=\"cor-info-value\">{project?.name}</span>\n            </div>\n            {project?.job_number && (\n              <div className=\"cor-info-item\">\n                <span className=\"cor-info-label\">Job #</span>\n                <span className=\"cor-info-value\">{project.job_number}</span>\n              </div>\n            )}\n            <div className=\"cor-info-item\">\n              <span className=\"cor-info-label\">Period</span>\n              <span className=\"cor-info-value\">{formatDateRange(document.period_start, document.period_end)}</span>\n            </div>\n          </div>\n\n          {document.scope_of_work && (\n            <div className=\"cor-scope\">\n              <h4>Scope of Work</h4>\n              <p>{document.scope_of_work}</p>\n            </div>\n          )}\n        </div>\n\n        {/* Labor Section */}\n        {document.change_order_labor?.length > 0 && (\n          <div className=\"cor-section\">\n            <div className=\"cor-section-header\">\n              <Users size={18} />\n              <h4>Labor</h4>\n            </div>\n            <div className=\"cor-table-wrapper\">\n              <table className=\"cor-line-items-table\">\n                <thead>\n                  <tr>\n                    <th>Class</th>\n                    <th>Type</th>\n                    <th className=\"text-right\">Reg Hrs</th>\n                    <th className=\"text-right\">Reg Rate</th>\n                    <th className=\"text-right\">OT Hrs</th>\n                    <th className=\"text-right\">OT Rate</th>\n                    <th className=\"text-right\">Total</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {document.change_order_labor.map((item, idx) => (\n                    <tr key={idx}>\n                      <td>{item.labor_class}</td>\n                      <td>{item.wage_type}</td>\n                      <td className=\"text-right\">{item.regular_hours}</td>\n                      <td className=\"text-right\">${centsToDollars(item.regular_rate)}/hr</td>\n                      <td className=\"text-right\">{item.overtime_hours || '-'}</td>\n                      <td className=\"text-right\">{item.overtime_hours ? `$${centsToDollars(item.overtime_rate)}/hr` : '-'}</td>\n                      <td className=\"text-right\">{formatCurrency(item.total)}</td>\n                    </tr>\n                  ))}\n                </tbody>\n                <tfoot>\n                  <tr>\n                    <td colSpan=\"5\" className=\"text-right\">Subtotal:</td>\n                    <td className=\"text-right\" colSpan=\"2\">{formatCurrency(totals.labor_subtotal)}</td>\n                  </tr>\n                  <tr className=\"markup-row\">\n                    <td colSpan=\"5\" className=\"text-right\">+ {formatPercent(document.labor_markup_percent || 1500)} Markup:</td>\n                    <td className=\"text-right\" colSpan=\"2\">{formatCurrency(totals.labor_markup_amount)}</td>\n                  </tr>\n                  <tr className=\"section-total-row\">\n                    <td colSpan=\"5\" className=\"text-right\"><strong>Labor Total:</strong></td>\n                    <td className=\"text-right\" colSpan=\"2\"><strong>{formatCurrency(totals.labor_subtotal + totals.labor_markup_amount)}</strong></td>\n                  </tr>\n                </tfoot>\n              </table>\n            </div>\n          </div>\n        )}\n\n        {/* Materials Section */}\n        {document.change_order_materials?.length > 0 && (\n          <div className=\"cor-section\">\n            <div className=\"cor-section-header\">\n              <Package size={18} />\n              <h4>Materials</h4>\n            </div>\n            <div className=\"cor-table-wrapper\">\n              <table className=\"cor-line-items-table\">\n                <thead>\n                  <tr>\n                    <th>Description</th>\n                    <th>Source</th>\n                    <th className=\"text-right\">Qty</th>\n                    <th>Unit</th>\n                    <th className=\"text-right\">Unit Cost</th>\n                    <th className=\"text-right\">Total</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {document.change_order_materials.map((item, idx) => (\n                    <tr key={idx}>\n                      <td>{item.description}</td>\n                      <td>{item.source_reference || item.source_type}</td>\n                      <td className=\"text-right\">{item.quantity}</td>\n                      <td>{item.unit}</td>\n                      <td className=\"text-right\">${centsToDollars(item.unit_cost)}</td>\n                      <td className=\"text-right\">{formatCurrency(item.total)}</td>\n                    </tr>\n                  ))}\n                </tbody>\n                <tfoot>\n                  <tr>\n                    <td colSpan=\"4\" className=\"text-right\">Subtotal:</td>\n                    <td className=\"text-right\" colSpan=\"2\">{formatCurrency(totals.materials_subtotal)}</td>\n                  </tr>\n                  <tr className=\"markup-row\">\n                    <td colSpan=\"4\" className=\"text-right\">+ {formatPercent(document.materials_markup_percent || 1500)} Markup:</td>\n                    <td className=\"text-right\" colSpan=\"2\">{formatCurrency(totals.materials_markup_amount)}</td>\n                  </tr>\n                  <tr className=\"section-total-row\">\n                    <td colSpan=\"4\" className=\"text-right\"><strong>Materials Total:</strong></td>\n                    <td className=\"text-right\" colSpan=\"2\"><strong>{formatCurrency(totals.materials_subtotal + totals.materials_markup_amount)}</strong></td>\n                  </tr>\n                </tfoot>\n              </table>\n            </div>\n          </div>\n        )}\n\n        {/* Equipment Section */}\n        {document.change_order_equipment?.length > 0 && (\n          <div className=\"cor-section\">\n            <div className=\"cor-section-header\">\n              <Truck size={18} />\n              <h4>Equipment</h4>\n            </div>\n            <div className=\"cor-table-wrapper\">\n              <table className=\"cor-line-items-table\">\n                <thead>\n                  <tr>\n                    <th>Description</th>\n                    <th>Source</th>\n                    <th className=\"text-right\">Qty</th>\n                    <th>Unit</th>\n                    <th className=\"text-right\">Unit Cost</th>\n                    <th className=\"text-right\">Total</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {document.change_order_equipment.map((item, idx) => (\n                    <tr key={idx}>\n                      <td>{item.description}</td>\n                      <td>{item.source_reference || item.source_type}</td>\n                      <td className=\"text-right\">{item.quantity}</td>\n                      <td>{item.unit}</td>\n                      <td className=\"text-right\">${centsToDollars(item.unit_cost)}</td>\n                      <td className=\"text-right\">{formatCurrency(item.total)}</td>\n                    </tr>\n                  ))}\n                </tbody>\n                <tfoot>\n                  <tr>\n                    <td colSpan=\"4\" className=\"text-right\">Subtotal:</td>\n                    <td className=\"text-right\" colSpan=\"2\">{formatCurrency(totals.equipment_subtotal)}</td>\n                  </tr>\n                  <tr className=\"markup-row\">\n                    <td colSpan=\"4\" className=\"text-right\">+ {formatPercent(document.equipment_markup_percent || 1500)} Markup:</td>\n                    <td className=\"text-right\" colSpan=\"2\">{formatCurrency(totals.equipment_markup_amount)}</td>\n                  </tr>\n                  <tr className=\"section-total-row\">\n                    <td colSpan=\"4\" className=\"text-right\"><strong>Equipment Total:</strong></td>\n                    <td className=\"text-right\" colSpan=\"2\"><strong>{formatCurrency(totals.equipment_subtotal + totals.equipment_markup_amount)}</strong></td>\n                  </tr>\n                </tfoot>\n              </table>\n            </div>\n          </div>\n        )}\n\n        {/* Subcontractors Section */}\n        {document.change_order_subcontractors?.length > 0 && (\n          <div className=\"cor-section\">\n            <div className=\"cor-section-header\">\n              <Briefcase size={18} />\n              <h4>Subcontractors</h4>\n            </div>\n            <div className=\"cor-table-wrapper\">\n              <table className=\"cor-line-items-table\">\n                <thead>\n                  <tr>\n                    <th>Company</th>\n                    <th>Description</th>\n                    <th>Source</th>\n                    <th className=\"text-right\">Amount</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {document.change_order_subcontractors.map((item, idx) => (\n                    <tr key={idx}>\n                      <td>{item.company_name}</td>\n                      <td>{item.description}</td>\n                      <td>{item.source_reference || item.source_type}</td>\n                      <td className=\"text-right\">{formatCurrency(item.total)}</td>\n                    </tr>\n                  ))}\n                </tbody>\n                <tfoot>\n                  <tr>\n                    <td colSpan=\"2\" className=\"text-right\">Subtotal:</td>\n                    <td className=\"text-right\" colSpan=\"2\">{formatCurrency(totals.subcontractors_subtotal)}</td>\n                  </tr>\n                  <tr className=\"markup-row\">\n                    <td colSpan=\"2\" className=\"text-right\">+ {formatPercent(document.subcontractors_markup_percent || 500)} Markup:</td>\n                    <td className=\"text-right\" colSpan=\"2\">{formatCurrency(totals.subcontractors_markup_amount)}</td>\n                  </tr>\n                  <tr className=\"section-total-row\">\n                    <td colSpan=\"2\" className=\"text-right\"><strong>Subcontractors Total:</strong></td>\n                    <td className=\"text-right\" colSpan=\"2\"><strong>{formatCurrency(totals.subcontractors_subtotal + totals.subcontractors_markup_amount)}</strong></td>\n                  </tr>\n                </tfoot>\n              </table>\n            </div>\n          </div>\n        )}\n\n        {/* T&M Backup Documentation Section - Professional Layout */}\n        {backupTickets.length > 0 && (() => {\n          // Calculate summary statistics\n          const totalLaborHours = backupTickets.reduce((sum, t) =>\n            sum + (t.t_and_m_workers?.reduce((wSum, w) => wSum + (parseFloat(w.hours) || 0), 0) || 0), 0\n          )\n          const totalOTHours = backupTickets.reduce((sum, t) =>\n            sum + (t.t_and_m_workers?.reduce((wSum, w) => wSum + (parseFloat(w.overtime_hours) || 0), 0) || 0), 0\n          )\n          const totalPhotos = backupTickets.reduce((sum, t) => sum + (t.photos?.length || 0), 0)\n          const verifiedCount = backupTickets.filter(t => t.client_signature_data).length\n\n          return (\n            <div className=\"cor-section cor-backup-section\">\n              {/* Professional Official Header */}\n              <div className=\"backup-official-header\">\n                <div className=\"backup-official-badge\">\n                  <FileText size={16} />\n                  <span>Supporting Documentation</span>\n                </div>\n                <div className=\"backup-summary-bar\">\n                  <div className=\"backup-stat\">\n                    <span className=\"backup-stat-value\">{backupTickets.length}</span>\n                    <span className=\"backup-stat-label\">Tickets</span>\n                  </div>\n                  <div className=\"backup-stat\">\n                    <span className=\"backup-stat-value\">{totalLaborHours.toFixed(1)}</span>\n                    <span className=\"backup-stat-label\">Labor Hrs</span>\n                  </div>\n                  {totalOTHours > 0 && (\n                    <div className=\"backup-stat\">\n                      <span className=\"backup-stat-value\">{totalOTHours.toFixed(1)}</span>\n                      <span className=\"backup-stat-label\">OT Hrs</span>\n                    </div>\n                  )}\n                  <div className=\"backup-stat\">\n                    <span className=\"backup-stat-value\">{totalPhotos}</span>\n                    <span className=\"backup-stat-label\">Photos</span>\n                  </div>\n                  {verifiedCount > 0 && (\n                    <div className=\"backup-stat verified\">\n                      <span className=\"backup-stat-value\">{verifiedCount}</span>\n                      <span className=\"backup-stat-label\">Verified</span>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Collapsible Toggle */}\n              <div\n                className=\"cor-section-header cor-backup-header\"\n                onClick={() => setBackupExpanded(!backupExpanded)}\n                style={{ cursor: 'pointer', marginBottom: backupExpanded ? '1rem' : 0 }}\n              >\n                <div className=\"backup-header-left\">\n                  <span>View All T&M Tickets</span>\n                </div>\n                <div className=\"backup-header-toggle\">\n                  {backupExpanded ? <ChevronDown size={20} /> : <ChevronRight size={20} />}\n                </div>\n              </div>\n\n              {backupExpanded && (\n                <div className=\"backup-tickets-list\" style={{ padding: '0 0.5rem' }}>\n                  {backupTickets.map((ticket) => {\n                    const isExpanded = expandedTickets.has(ticket.id)\n                    const ticketTotalHours = ticket.t_and_m_workers?.reduce((sum, w) =>\n                      sum + (parseFloat(w.hours) || 0), 0\n                    ) || 0\n                    const ticketOTHours = ticket.t_and_m_workers?.reduce((sum, w) =>\n                      sum + (parseFloat(w.overtime_hours) || 0), 0\n                    ) || 0\n                    const hasVerification = !!ticket.client_signature_data\n\n                    return (\n                      <div\n                        key={ticket.id}\n                        className=\"backup-ticket-pro\"\n                        data-verified={hasVerification}\n                        data-status={ticket.status || 'pending'}\n                      >\n                        {/* Professional Ticket Header */}\n                        <div\n                          className=\"ticket-pro-header\"\n                          onClick={() => {\n                            const next = new Set(expandedTickets)\n                            if (isExpanded) {\n                              next.delete(ticket.id)\n                            } else {\n                              next.add(ticket.id)\n                            }\n                            setExpandedTickets(next)\n                          }}\n                          style={{ cursor: 'pointer' }}\n                        >\n                          <div className=\"ticket-date-badge\">\n                            <Calendar size={14} />\n                            <span>{formatDate(ticket.work_date)}</span>\n                          </div>\n                          {ticket.ce_pco_number && (\n                            <span className=\"ticket-pco-badge\">{ticket.ce_pco_number}</span>\n                          )}\n                          {hasVerification && (\n                            <span className=\"ticket-verified-seal\">\n                              <CheckCircle size={12} /> Verified\n                            </span>\n                          )}\n                          <div style={{ marginLeft: 'auto', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n                            <span style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>\n                              {ticket.t_and_m_workers?.length || 0} workers • {ticketTotalHours + ticketOTHours} hrs\n                            </span>\n                            {isExpanded ? <ChevronDown size={16} /> : <ChevronRight size={16} />}\n                          </div>\n                        </div>\n\n                        {/* Ticket Body - Expanded Content */}\n                        {isExpanded && (\n                          <div className=\"ticket-pro-body\">\n                            {/* Description */}\n                            {ticket.notes && (\n                              <div className=\"ticket-description-box\">\n                                <p>{ticket.notes}</p>\n                              </div>\n                            )}\n\n                            {/* Workers Section */}\n                            {ticket.t_and_m_workers?.length > 0 && (\n                              <div className=\"ticket-section-pro\">\n                                <div className=\"ticket-section-header\">\n                                  <HardHat size={14} />\n                                  <span>Labor</span>\n                                  <span className=\"section-count\">{ticketTotalHours + ticketOTHours} hrs total</span>\n                                </div>\n                                <div className=\"worker-pro-grid\">\n                                  {ticket.t_and_m_workers.map((worker, wIdx) => (\n                                    <div key={wIdx} className=\"worker-pro-row\">\n                                      <div>\n                                        <span className=\"worker-name\">{worker.name}</span>\n                                        {worker.role && <span className=\"worker-role\"> • {worker.role}</span>}\n                                      </div>\n                                      <span className=\"worker-time\">\n                                        {worker.time_started && worker.time_ended\n                                          ? `${formatTime(worker.time_started)} - ${formatTime(worker.time_ended)}`\n                                          : '-'}\n                                      </span>\n                                      <span className=\"worker-hours\">{worker.hours || 0} hrs</span>\n                                      <span className=\"worker-ot\">\n                                        {parseFloat(worker.overtime_hours) > 0 ? `+${worker.overtime_hours} OT` : '-'}\n                                      </span>\n                                    </div>\n                                  ))}\n                                </div>\n                              </div>\n                            )}\n\n                            {/* Materials Section */}\n                            {ticket.t_and_m_items?.length > 0 && (\n                              <div className=\"ticket-section-pro\">\n                                <div className=\"ticket-section-header\">\n                                  <Package size={14} />\n                                  <span>Materials / Equipment</span>\n                                  <span className=\"section-count\">{ticket.t_and_m_items.length} items</span>\n                                </div>\n                                <div className=\"materials-pro-list\">\n                                  {ticket.t_and_m_items.map((item, iIdx) => (\n                                    <div key={iIdx} className=\"material-pro-row\">\n                                      <span className=\"material-name\">\n                                        {item.materials_equipment?.name || item.description || 'Item'}\n                                      </span>\n                                      <span className=\"material-qty\">\n                                        {item.quantity || 1} {item.materials_equipment?.unit || 'ea'}\n                                      </span>\n                                      <span className=\"material-source\">T&M Ticket</span>\n                                    </div>\n                                  ))}\n                                </div>\n                              </div>\n                            )}\n\n                            {/* Photos Section */}\n                            {ticket.photos?.length > 0 && (\n                              <div className=\"ticket-section-pro\">\n                                <div className=\"ticket-section-header\">\n                                  <Camera size={14} />\n                                  <span>Photo Evidence</span>\n                                  <span className=\"section-count\">{ticket.photos.length}</span>\n                                </div>\n                                <div className=\"photo-evidence-grid\">\n                                  {ticket.photos.map((photo, pIdx) => (\n                                    <a\n                                      key={pIdx}\n                                      href={photo}\n                                      target=\"_blank\"\n                                      rel=\"noopener noreferrer\"\n                                      className=\"photo-evidence-item\"\n                                    >\n                                      <img\n                                        src={photo}\n                                        alt={`Evidence ${pIdx + 1}`}\n                                        onError={(e) => {\n                                          e.target.onerror = null\n                                          e.target.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5NGEzYjgiIHN0cm9rZS13aWR0aD0iMiI+PHJlY3QgeD0iMyIgeT0iMyIgd2lkdGg9IjE4IiBoZWlnaHQ9IjE4IiByeD0iMiIvPjxjaXJjbGUgY3g9IjguNSIgY3k9IjguNSIgcj0iMS41Ii8+PHBvbHlsaW5lIHBvaW50cz0iMjEgMTUgMTYgMTAgNSAyMSIvPjwvc3ZnPg=='\n                                        }}\n                                      />\n                                    </a>\n                                  ))}\n                                </div>\n                              </div>\n                            )}\n\n                            {/* Client Verification Footer */}\n                            {hasVerification && (\n                              <div className=\"ticket-verification-footer\">\n                                <div className=\"verification-seal-icon\">\n                                  <CheckCircle size={22} />\n                                </div>\n                                {ticket.client_signature_data && (\n                                  <img\n                                    src={ticket.client_signature_data}\n                                    alt=\"Client Signature\"\n                                    className=\"verification-signature-img\"\n                                  />\n                                )}\n                                <div className=\"verification-info\">\n                                  <span className=\"signer-name\">{ticket.client_signature_name || 'Client'}</span>\n                                  {(ticket.client_signature_title || ticket.client_signature_company) && (\n                                    <span className=\"signer-title\">\n                                      {[ticket.client_signature_title, ticket.client_signature_company].filter(Boolean).join(', ')}\n                                    </span>\n                                  )}\n                                  {ticket.client_signature_date && (\n                                    <span className=\"verify-date\">Verified {formatDate(ticket.client_signature_date)}</span>\n                                  )}\n                                </div>\n                              </div>\n                            )}\n                          </div>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              )}\n\n              <div className=\"backup-note\">\n                <AlertCircle size={14} />\n                <span>This documentation supports the work described in this Change Order Request.</span>\n              </div>\n            </div>\n          )\n        })()}\n\n        {/* Totals Section */}\n        <div className=\"cor-totals-card\">\n          <h4>COR Summary</h4>\n\n          <div className=\"cor-totals-grid\">\n            <div className=\"cor-total-row\">\n              <span>COR Subtotal</span>\n              <span>{formatCurrency(totals.cor_subtotal)}</span>\n            </div>\n\n            <div className=\"cor-fees-section\">\n              <div className=\"cor-fee-row\">\n                <span>Liability Insurance ({formatPercent(document.liability_insurance_percent || 144)})</span>\n                <span>{formatCurrency(totals.liability_insurance_amount)}</span>\n              </div>\n              <div className=\"cor-fee-row\">\n                <span>Bond ({formatPercent(document.bond_percent || 100)})</span>\n                <span>{formatCurrency(totals.bond_amount)}</span>\n              </div>\n              <div className=\"cor-fee-row\">\n                <span>City License Fee ({formatPercent(document.license_fee_percent || 10)})</span>\n                <span>{formatCurrency(totals.license_fee_amount)}</span>\n              </div>\n            </div>\n\n            <div className=\"cor-grand-total\">\n              <span>COR TOTAL</span>\n              <span>{formatCurrency(totals.cor_total)}</span>\n            </div>\n          </div>\n        </div>\n\n        {/* Signature Section */}\n        <div className=\"cor-signature-section\">\n          <h4>Authorization</h4>\n          <p className=\"signature-instruction\">\n            By signing below, you authorize the above change order request and agree to the terms and costs outlined.\n          </p>\n\n          <div className=\"signature-slots-grid\">\n            {/* Show signature options if not signed yet */}\n            {!isFullySigned ? (\n              <>\n                {/* GC Signature */}\n                <div className={`signature-slot-card ${slot1 ? 'signed' : 'unsigned'}`}>\n                  <div className=\"slot-header\">\n                    {slot1 ? (\n                      <CheckCircle size={20} className=\"status-icon signed\" />\n                    ) : (\n                      <Clock size={20} className=\"status-icon pending\" />\n                    )}\n                    <span className=\"slot-label\">GC Authorization</span>\n                  </div>\n                  <button\n                    className=\"btn btn-primary sign-btn\"\n                    onClick={() => openSignatureModal(1)}\n                    disabled={submitting}\n                  >\n                    Sign as GC\n                  </button>\n                </div>\n\n                <p className=\"or-divider\">— or —</p>\n\n                {/* Client Signature */}\n                <div className={`signature-slot-card ${slot2 ? 'signed' : 'unsigned'}`}>\n                  <div className=\"slot-header\">\n                    {slot2 ? (\n                      <CheckCircle size={20} className=\"status-icon signed\" />\n                    ) : (\n                      <Clock size={20} className=\"status-icon pending\" />\n                    )}\n                    <span className=\"slot-label\">Client Authorization</span>\n                  </div>\n                  <button\n                    className=\"btn btn-primary sign-btn\"\n                    onClick={() => openSignatureModal(2)}\n                    disabled={submitting}\n                  >\n                    Sign as Client\n                  </button>\n                </div>\n              </>\n            ) : (\n              <>\n                {/* Show the collected signature */}\n                {slot1 && (\n                  <div className=\"signature-slot-card signed\">\n                    <div className=\"slot-header\">\n                      <CheckCircle size={20} className=\"status-icon signed\" />\n                      <span className=\"slot-label\">GC Authorization</span>\n                    </div>\n                    <div className=\"slot-signed-info\">\n                      {slot1.signature_data && (\n                        <img src={slot1.signature_data} alt=\"Signature\" className=\"signature-image\" />\n                      )}\n                      <div className=\"signer-details\">\n                        <span className=\"signer-name\">{slot1.signer_name}</span>\n                        {(slot1.signer_title || slot1.signer_company) && (\n                          <span className=\"signer-org\">\n                            {slot1.signer_title}{slot1.signer_title && slot1.signer_company && ' — '}{slot1.signer_company}\n                          </span>\n                        )}\n                      </div>\n                      <span className=\"signed-date\">Signed {formatDate(slot1.signed_at)}</span>\n                    </div>\n                  </div>\n                )}\n                {slot2 && (\n                  <div className=\"signature-slot-card signed\">\n                    <div className=\"slot-header\">\n                      <CheckCircle size={20} className=\"status-icon signed\" />\n                      <span className=\"slot-label\">Client Authorization</span>\n                    </div>\n                    <div className=\"slot-signed-info\">\n                      {slot2.signature_data && (\n                        <img src={slot2.signature_data} alt=\"Signature\" className=\"signature-image\" />\n                      )}\n                      <div className=\"signer-details\">\n                        <span className=\"signer-name\">{slot2.signer_name}</span>\n                        {(slot2.signer_title || slot2.signer_company) && (\n                          <span className=\"signer-org\">\n                            {slot2.signer_title}{slot2.signer_title && slot2.signer_company && ' — '}{slot2.signer_company}\n                          </span>\n                        )}\n                      </div>\n                      <span className=\"signed-date\">Signed {formatDate(slot2.signed_at)}</span>\n                    </div>\n                  </div>\n                )}\n              </>\n            )}\n          </div>\n\n          {/* Fully signed message */}\n          {isFullySigned && (\n            <div className=\"fully-signed-message\">\n              <CheckCircle size={24} />\n              <p>This change order request has been signed.</p>\n            </div>\n          )}\n\n          {/* Download section - always available so clients can save a copy */}\n          <div className=\"cor-download-section\">\n            <h4>Download Your Copy</h4>\n            <p className=\"download-description\">\n              {isFullySigned\n                ? 'Download a PDF copy of this fully signed COR including all T&M backup documentation.'\n                : 'Download a PDF copy of this COR for your records. Signature status will be included.'}\n            </p>\n            <button\n              className=\"btn btn-primary download-btn\"\n              onClick={handleDownload}\n              disabled={downloading}\n            >\n              {downloading ? (\n                <>\n                  <span className=\"download-spinner\"></span>\n                  Generating PDF...\n                </>\n              ) : (\n                <>\n                  <Download size={18} />\n                  Download COR + Backup\n                </>\n              )}\n            </button>\n          </div>\n        </div>\n      </main>\n\n      {/* Footer */}\n      <footer className=\"signature-page-footer\">\n        <p>Powered by FieldSync</p>\n      </footer>\n\n      {/* Signature modal */}\n      {showSignatureModal && activeSlot && (\n        <SignatureCanvas\n          enhanced\n          requireAcknowledgment\n          lockBodyScroll\n          slot={activeSlot}\n          documentType={signatureRequest.document_type}\n          documentTitle={`${document.cor_number} - ${document.title}`}\n          onSave={handleSignatureSubmit}\n          onClose={() => {\n            setShowSignatureModal(false)\n            setActiveSlot(null)\n          }}\n        />\n      )}\n    </div>\n  )\n}\n\n// Helper function to render a signature slot (for T&M tickets)\nfunction renderSignatureSlot(slot, signatureData, label, openModal, submitting) {\n  return (\n    <div className={`signature-slot-card ${signatureData ? 'signed' : 'unsigned'}`}>\n      <div className=\"slot-header\">\n        {signatureData ? (\n          <CheckCircle size={20} className=\"status-icon signed\" />\n        ) : (\n          <Clock size={20} className=\"status-icon pending\" />\n        )}\n        <span className=\"slot-label\">Signature {slot} — {label}</span>\n      </div>\n\n      {signatureData ? (\n        <div className=\"slot-signed-info\">\n          <div className=\"signer-details\">\n            <span className=\"signer-name\">{signatureData.signer_name}</span>\n            {(signatureData.signer_title || signatureData.signer_company) && (\n              <span className=\"signer-org\">\n                {signatureData.signer_title}{signatureData.signer_title && signatureData.signer_company && ' — '}{signatureData.signer_company}\n              </span>\n            )}\n          </div>\n          <span className=\"signed-date\">Signed {formatDate(signatureData.signed_at)}</span>\n        </div>\n      ) : (\n        <button\n          className=\"btn btn-primary sign-btn\"\n          onClick={() => openModal(slot)}\n          disabled={submitting}\n        >\n          Sign as {slot === 1 ? 'GC' : 'Client'}\n        </button>\n      )}\n    </div>\n  )\n}\n"],"names":["formatDate","dateString","formatTime","timeStr","hours","minutes","h","ampm","StatusBadge","status","statusMap","info","jsx","SignaturePage","signatureToken","loading","setLoading","useState","error","setError","signatureRequest","setSignatureRequest","document","setDocument","showSignatureModal","setShowSignatureModal","activeSlot","setActiveSlot","submitting","setSubmitting","successMessage","setSuccessMessage","downloading","setDownloading","backupTickets","setBackupTickets","backupExpanded","setBackupExpanded","expandedTickets","setExpandedTickets","companyBranding","setCompanyBranding","useEffect","loadData","request","db","docData","tickets","err","companyId","isSupabaseConfigured","brandingData","supabase","totals","useMemo","calculateCORTotals","getSignatureStatus","signatures","slot1","s","slot2","availableSlots","getClientIP","handleSignatureSubmit","signatureData","ipAddress","signature","openSignatureModal","slot","handleDownload","docCompany","docProject","tmTickets","branding","exportCORToPDF","handleDownloadTMTicket","exportTMTicketToPDF","jsxs","AlertCircle","isFullySigned","isCOR","company","project","workerCount","totalHours","sum","w","Building2","CheckCircle","Fragment","Download","FileText","HardHat","idx","Package","item","Camera","photo","e","renderSignatureSlot","SignatureCanvas","Users","centsToDollars","formatCurrency","formatPercent","Truck","Briefcase","totalLaborHours","t","wSum","totalOTHours","totalPhotos","verifiedCount","ChevronDown","ChevronRight","ticket","isExpanded","ticketTotalHours","ticketOTHours","hasVerification","next","Calendar","worker","wIdx","iIdx","pIdx","Clock","label","openModal"],"mappings":"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"}