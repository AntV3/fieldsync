{"version":3,"mappings":"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","names":["_extends","n","e","t","r","ownKeys","o","_objectSpread","_defineProperty","_toPropertyKey","i","_toPrimitive","SIZE","defaultLegendContentDefaultProps","Icon","_ref","data","iconType","inactiveColor","halfSize","sixthSize","thirdSize","color","preferredIcon","_data$payload","React.createElement","React.isValidElement","iconProps","React.cloneElement","Symbols","Items","props","payload","iconSize","layout","formatter","viewBox","itemStyle","svgStyle","entry","finalFormatter","className","clsx","finalValue","adaptEventsOfChild","Surface","DefaultLegendContent","outsideProps","resolveDefaultProps","align","finalStyle","useLegendPayload","useAppSelector","selectLegendPayload","_excluded","_objectWithoutProperties","_objectWithoutPropertiesLoose","defaultUniqBy","LegendContent","contextPayload","otherProps","finalPayload","getUniqPayload","contentProps","getDefaultPosition","style","margin","chartWidth","chartHeight","box","verticalAlign","hPos","vPos","LegendSettingsDispatcher","dispatch","useAppDispatch","useEffect","setLegendSettings","LegendSizeDispatcher","setLegendSize","getWidthOrHeight","height","width","maxWidth","isNumber","legendDefaultProps","Legend","legendPortalFromContext","useLegendPortal","useMargin","widthFromProps","heightFromProps","wrapperStyle","portalFromProps","lastBoundingBox","updateBoundingBox","useElementOffset","useChartWidth","useChartHeight","widthOrHeight","outerStyle","legendPortal","legendElement","createPortal","ErrorSeverity","ErrorCategory","categorizeError","error","message","code","getUserMessage","category","context","handleError","options","operation","severity","showToast","userMessage","companyId","projectId","userId","silent","rethrow","observe","toastType","safeAsync","fn","fallback","DEFAULT_THRESHOLDS","FACTOR_WEIGHTS","calculateFactorScore","value","thresholds","range","getFactorStatus","score","calculateBudgetFactor","totalCosts","earnedRevenue","ratio","status","label","calculateScheduleFactor","actualProgress","expectedProgress","variance","absVariance","calculateCORExposureFactor","pendingCORValue","contractValue","exposure","formatNumber","calculateActivityFactor","lastReportDate","lastDate","daysSince","calculateSafetyFactor","injuryCount","count","calculateRiskScore","project","weights","budgetFactor","scheduleFactor","corFactor","activityFactor","safetyFactor","compositeScore","overallStatus","summaryLabel","generateSmartAlerts","riskResult","alerts","factors","priorityOrder","a","b","calculateProjections","costPerPercent","estimatedCompletionCost","estimatedFinalMargin","estimatedCompletionDate","startDate","now","daysElapsed","progressPerDay","daysRemaining","num","loadJsPDF","__vitePreload","PAGE_WIDTH","MARGIN","CONTENT_WIDTH","formatDate","dateStr","checkPage","doc","y","needed","exportDailyReportsPDF","reports","jsPDF","report","idx","statusText","metrics","crewNames","w","crewLines","noteLines","issueLines","fileName","exportIncidentReportsPDF","typeLabel","lines","exportCrewCheckinsPDF","checkins","checkin","workers","exportAllFieldDocumentsPDF","dailyReports","incidentReports","crewCheckins","workerList","downloadFile","content","filename","mimeType","blob","url","escapeCSV","str","toCSV","headers","rows","headerLine","h","dataLines","row","exportProjectFinancials","financialData","cor","d","c","totalRevenue","s","csv","exportCORDetail","item","regHrs","otHrs","exportTMTicketsCSV","tickets","items","totalHours","otHours","materialsCost","exportToQuickBooksIIF","txnDate","totalLabor","totalDisposal","UniversalSearch","isOpen","onClose","onSelectProject","onSelectTicket","onSelectCOR","onShowToast","query","setQuery","useState","results","setResults","loading","setLoading","selectedIndex","setSelectedIndex","inputRef","useRef","searchTimeoutRef","focusTimeoutRef","performSearch","useCallback","searchQuery","searchResults","db","handleInputChange","allResults","all","p","hasResults","handleKeyDown","prev","handleSelect","jsx","jsxs","Search","X","Fragment","FolderOpen","globalIdx","ChevronRight","FileText","ticket","ClipboardList","Users","worker","Command","useUniversalSearch","setIsOpen","SmartAlerts","onAction","onDismiss","maxVisible","dismissedIds","setDismissedIds","visibleAlerts","alert","handleDismiss","alertId","index","SmartAlertCard","type","title","description","action","actionTarget","projectName","XCircle","AlertTriangle","Info","handleAction","ArrowRight","OverviewProgressGauge","memo","progress","areasComplete","totalAreas","areasWorking","size","strokeWidth","animatedProgress","setAnimatedProgress","animationRef","startValue","endValue","duration","startTime","animate","currentTime","elapsed","progressRatio","eased","current","radius","circumference","offset","getProgressColor","chartColors","tooltipStyle","formatChartDate","OverviewFinancialCard","laborCost","disposalCost","equipmentCost","otherCost","profit","isPositive","formatCurrency","costBreakdown","hasBreakdown","widthPercent","Skeleton","borderRadius","variant","variantStyles","showProgress","CardSkeleton","showHeader","showAction","_","showAvatar","TicketSkeleton","HeroMetricsSkeleton","ErrorState","onRetry","retryLabel","CustomIcon","WifiOff","RefreshCw","EmptyState","actionLabel","required","hint","children","AlertCircle","onChange","onBlur","placeholder","disabled","min","max","step","pattern","autoComplete","name","id","ariaLabel","ariaDescribedBy","inputId","errorId","selectId","maxLength","textareaId","CountBadge","pulse","prevCount","setPrevCount","animating","setAnimating","timer","MiniProgress","showLabel","animated","percentage","autoVariant","TrendIndicator","previousValue","format","inverted","showValue","diff","percentChange","direction","TrendingUp","TrendingDown","Minus","formatValue","absChange","showArea","points","x","areaPoints","icons","Check","Clock","previous","delta","isNegative","val","showCloseButton","closeOnOverlayClick","closeOnEscape","footer","modalRef","previousActiveElement","titleId","originalOverflow","focusableElements","firstElement","lastElement","handleOverlayClick","sizeClasses","CREW_COLORS","TIME_RANGES","crewHistory","setCrewHistory","tmTickets","setTmTickets","selectedDate","setSelectedDate","timeRange","setTimeRange","exporting","setExporting","loadData","history","tmWorkersByDate","useMemo","map","date","crewByDate","selectedDayWorkers","selectedDayTmNames","todayMetrics","contract","tm","chartData","rangeDays","today","tmNames","contractCount","tmCount","changeDate","isToday","handleBarClick","CustomTooltip","active","total","exportCrewPDF","pageWidth","day","footerY","Download","ChevronLeft","Calendar","HardHat","Wrench","ResponsiveContainer","BarChart","CartesianGrid","XAxis","YAxis","Tooltip","Bar","amount","MetricCard","formattedValue","subLabel","progressLabel","trend","variantColors","corApprovedValue","previousData","revisedContract","profitMargin","costRatio","revenueProgress","costProgress","profitVariant","costVariant","DollarSign","Receipt","PiggyBank","NAV_ITEMS","BarChart3","activeSection","onSectionChange","collapsed","onToggleCollapse","onMobileClose","stats","corCount","ticketCount","corPending","ticketPending","billableCount","invoiceCount","getBadge","itemId","PanelLeftOpen","isActive","badge","showConnector","onAddEquipment","onEditEquipment","projectEquipment","setProjectEquipment","expanded","setExpanded","totalCost","setTotalCost","loadEquipment","equipmentOps","cost","handleMarkReturned","equipmentItem","handleDelete","activeEquipment","returnedEquipment","Truck","Plus","ChevronUp","ChevronDown","days","RotateCcw","Edit2","Trash2","areas","corStats","onCreateDraw","onViewDraw","drawRequests","setDrawRequests","originalContract","sum","area","approvedCOs","loadDrawRequests","drawRequestOps","billingTotals","completedDraws","dr","billedToDate","retentionHeld","nextDrawNumber","getStatusBadge","FileSpreadsheet","lazy","ShareModal","NotificationSettings","CORForm","CORDetail","CORLog","DrawRequestModal","EquipmentModal","AddCostModal","DocumentsTab","Dashboard","company","user","isAdmin","navigateToProjectId","onProjectNavigated","projects","setProjects","projectsData","setProjectsData","selectedProject","setSelectedProject","setAreas","editMode","setEditMode","editData","setEditData","saving","setSaving","showShareModal","setShowShareModal","showNotificationSettings","setShowNotificationSettings","activeProjectTab","setActiveProjectTab","financialsSection","setFinancialsSection","financialsSidebarCollapsed","setFinancialsSidebarCollapsed","financialsSidebarMobileOpen","setFinancialsSidebarMobileOpen","corListExpanded","setCORListExpanded","corDisplayMode","setCORDisplayMode","tmViewMode","setTMViewMode","dumpSites","setDumpSites","showCORForm","setShowCORForm","editingCOR","setEditingCOR","showCORDetail","setShowCORDetail","viewingCOR","setViewingCOR","corRefreshKey","setCORRefreshKey","showAddCostModal","setShowAddCostModal","savingCost","setSavingCost","showEquipmentModal","setShowEquipmentModal","editingEquipment","setEditingEquipment","equipmentRefreshKey","setEquipmentRefreshKey","showDrawRequestModal","setShowDrawRequestModal","editingDrawRequest","setEditingDrawRequest","drawRequestRefreshKey","setDrawRequestRefreshKey","isSearchOpen","setSearchOpen","closeSearch","refreshTimeoutRef","pendingAreasRefreshRef","pendingCORRefreshRef","projectDetailsCacheRef","CACHE_TTL_MS","debouncedRefresh","refreshAreas","refreshCOR","loadAreas","loadProjects","loadDumpSites","projectIdsRef","projectIdsKey","currentIds","subscription","sites","lastNavigatedIdRef","subscriptions","areasSub","dailyReportsSub","checkinsSub","haulOffsSub","corsSub","sub","loadProjectDetails","forceRefresh","cacheKey","cached","projectAreas","changeOrderData","injuryReports","laborCosts","haulOffCosts","customCosts","materialRequests","weeklyDisposal","progressData","calculateValueProgress","changeOrderValue","revisedContractValue","billable","pendingTickets","oneWeekAgo","recentDailyReports","customCostTotal","materialsEquipmentCost","materialsEquipmentByDate","ticketDate","ticketMaterialsCost","qty","materialsEquipmentByDateArray","haulOffCost","allCostsTotal","currentProfit","laborDays","materialsDays","totalBurnDays","totalBurn","dailyBurn","scheduleInsights","calculateScheduleInsights","uniqueWorkers","crewDates","avgCrewSize","peakCrewSize","recentCrewDates","priorCrewDates","recentCrewAvg","priorCrewAvg","pendingMaterialRequests","orderedMaterialRequests","deliveredMaterialRequests","urgentMaterialRequests","reportsWithIssues","totalPhotosFromTickets","disposalTotalLoads","lastInjuryDate","daysSinceLastInjury","completedAreas","enhancedData","enhanced","handleSelectProject","detailedProject","handleBack","handleEditClick","handleCancelEdit","handleEditChange","field","handleAreaEditChange","handleAddArea","handleRemoveArea","handleSaveEdit","contractVal","validAreas","existingAreaIds","editAreaIds","areaId","updatedProject","handleDeleteProject","projectData","progressCalculations","portfolioMetrics","totalOriginalContract","totalChangeOrders","totalPortfolioValue","totalEarned","totalRemaining","weightedCompletion","totalPendingCORValue","totalPendingCORCount","projectHealth","complete","onTrack","atRisk","overBudget","withChangeOrders","scheduleMetrics","ahead","behind","overLabor","underLabor","onTrackLabor","riskAnalysis","projectRisks","riskInput","projections","alertsWithProject","allAlerts","priority","handleAlertAction","target","checkAutoArchive","shouldAutoArchive","handleAddEquipment","handleEditEquipment","handleCreateDraw","handleViewDraw","drawRequest","handleViewAllTickets","handleToggleFinancialsSidebar","handleToggleMobileSidebar","handleCloseMobileSidebar","handleToggleCORList","handleExportFieldDocuments","handleBackToTMPreview","handleViewFullCORLog","handleCreateCOR","handleViewCOR","handleEditCOR","handleAddCost","handleDeleteCost","costId","financialsNavStats","projectsComplete","projectsOnTrack","projectsAtRisk","projectsOverBudget","projectsWithChangeOrders","scheduleAhead","scheduleOnTrack","scheduleBehind","laborOver","laborUnder","laborOnTrack","hasAnyScheduleData","hasAnyLaborData","isValueBased","earnedValue","totalSOVValue","totalWeight","site","areasNotStarted","pendingCount","tabs","LayoutGrid","tab","section","Suspense","req","week","maxWeek","share","costData","err","projectRisk","EnhancedProjectCard","riskScore","riskStatus","onClick","getOverallStatus","statusLabel","getOverallStatusLabel","isAtRisk","riskColors","riskStyle"],"ignoreList":[0,1,2],"sources":["../../node_modules/recharts/es6/component/DefaultLegendContent.js","../../node_modules/recharts/es6/context/legendPayloadContext.js","../../node_modules/recharts/es6/component/Legend.js","../../src/lib/errorHandler.js","../../src/lib/riskCalculations.js","../../src/lib/fieldDocumentExport.js","../../src/lib/financialExport.js","../../src/components/UniversalSearch.jsx","../../src/components/dashboard/SmartAlerts.jsx","../../src/components/overview/OverviewProgressGauge.jsx","../../src/components/charts/chartConfig.js","../../src/components/overview/OverviewFinancialCard.jsx","../../src/components/ui/Skeleton.jsx","../../src/components/ui/ErrorState.jsx","../../src/components/ui/FormField.jsx","../../src/components/ui/MicroVis.jsx","../../src/components/ui/Modal.jsx","../../src/components/overview/OverviewCrewMetrics.jsx","../../src/components/HeroMetrics.jsx","../../src/components/FinancialsNav.jsx","../../src/components/equipment/ProjectEquipmentCard.jsx","../../src/components/billing/ProgressBillingCard.jsx","../../src/components/dashboard/tabs/FinancialsTab.jsx","../../src/components/dashboard/tabs/ReportsTab.jsx","../../src/components/Dashboard.jsx"],"sourcesContent":["function _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n/**\n * @fileOverview Default Legend Content\n */\nimport * as React from 'react';\nimport { clsx } from 'clsx';\nimport { Surface } from '../container/Surface';\nimport { Symbols } from '../shape/Symbols';\nimport { adaptEventsOfChild } from '../util/types';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nvar SIZE = 32;\nvar defaultLegendContentDefaultProps = {\n  align: 'center',\n  iconSize: 14,\n  inactiveColor: '#ccc',\n  layout: 'horizontal',\n  verticalAlign: 'middle'\n};\nfunction Icon(_ref) {\n  var {\n    data,\n    iconType,\n    inactiveColor\n  } = _ref;\n  var halfSize = SIZE / 2;\n  var sixthSize = SIZE / 6;\n  var thirdSize = SIZE / 3;\n  var color = data.inactive ? inactiveColor : data.color;\n  var preferredIcon = iconType !== null && iconType !== void 0 ? iconType : data.type;\n  if (preferredIcon === 'none') {\n    return null;\n  }\n  if (preferredIcon === 'plainline') {\n    var _data$payload;\n    return /*#__PURE__*/React.createElement(\"line\", {\n      strokeWidth: 4,\n      fill: \"none\",\n      stroke: color,\n      strokeDasharray: (_data$payload = data.payload) === null || _data$payload === void 0 ? void 0 : _data$payload.strokeDasharray,\n      x1: 0,\n      y1: halfSize,\n      x2: SIZE,\n      y2: halfSize,\n      className: \"recharts-legend-icon\"\n    });\n  }\n  if (preferredIcon === 'line') {\n    return /*#__PURE__*/React.createElement(\"path\", {\n      strokeWidth: 4,\n      fill: \"none\",\n      stroke: color,\n      d: \"M0,\".concat(halfSize, \"h\").concat(thirdSize, \"\\n            A\").concat(sixthSize, \",\").concat(sixthSize, \",0,1,1,\").concat(2 * thirdSize, \",\").concat(halfSize, \"\\n            H\").concat(SIZE, \"M\").concat(2 * thirdSize, \",\").concat(halfSize, \"\\n            A\").concat(sixthSize, \",\").concat(sixthSize, \",0,1,1,\").concat(thirdSize, \",\").concat(halfSize),\n      className: \"recharts-legend-icon\"\n    });\n  }\n  if (preferredIcon === 'rect') {\n    return /*#__PURE__*/React.createElement(\"path\", {\n      stroke: \"none\",\n      fill: color,\n      d: \"M0,\".concat(SIZE / 8, \"h\").concat(SIZE, \"v\").concat(SIZE * 3 / 4, \"h\").concat(-SIZE, \"z\"),\n      className: \"recharts-legend-icon\"\n    });\n  }\n  if (/*#__PURE__*/React.isValidElement(data.legendIcon)) {\n    var iconProps = _objectSpread({}, data);\n    delete iconProps.legendIcon;\n    return /*#__PURE__*/React.cloneElement(data.legendIcon, iconProps);\n  }\n  return /*#__PURE__*/React.createElement(Symbols, {\n    fill: color,\n    cx: halfSize,\n    cy: halfSize,\n    size: SIZE,\n    sizeType: \"diameter\",\n    type: preferredIcon\n  });\n}\nfunction Items(props) {\n  var {\n    payload,\n    iconSize,\n    layout,\n    formatter,\n    inactiveColor,\n    iconType\n  } = props;\n  var viewBox = {\n    x: 0,\n    y: 0,\n    width: SIZE,\n    height: SIZE\n  };\n  var itemStyle = {\n    display: layout === 'horizontal' ? 'inline-block' : 'block',\n    marginRight: 10\n  };\n  var svgStyle = {\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    marginRight: 4\n  };\n  return payload.map((entry, i) => {\n    var finalFormatter = entry.formatter || formatter;\n    var className = clsx({\n      'recharts-legend-item': true,\n      [\"legend-item-\".concat(i)]: true,\n      inactive: entry.inactive\n    });\n    if (entry.type === 'none') {\n      return null;\n    }\n    var color = entry.inactive ? inactiveColor : entry.color;\n    var finalValue = finalFormatter ? finalFormatter(entry.value, entry, i) : entry.value;\n    return /*#__PURE__*/React.createElement(\"li\", _extends({\n      className: className,\n      style: itemStyle,\n      key: \"legend-item-\".concat(i)\n    }, adaptEventsOfChild(props, entry, i)), /*#__PURE__*/React.createElement(Surface, {\n      width: iconSize,\n      height: iconSize,\n      viewBox: viewBox,\n      style: svgStyle,\n      \"aria-label\": \"\".concat(finalValue, \" legend icon\")\n    }, /*#__PURE__*/React.createElement(Icon, {\n      data: entry,\n      iconType: iconType,\n      inactiveColor: inactiveColor\n    })), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"recharts-legend-item-text\",\n      style: {\n        color\n      }\n    }, finalValue));\n  });\n}\nexport var DefaultLegendContent = outsideProps => {\n  var props = resolveDefaultProps(outsideProps, defaultLegendContentDefaultProps);\n  var {\n    payload,\n    layout,\n    align\n  } = props;\n  if (!payload || !payload.length) {\n    return null;\n  }\n  var finalStyle = {\n    padding: 0,\n    margin: 0,\n    textAlign: layout === 'horizontal' ? align : 'left'\n  };\n  return /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"recharts-default-legend\",\n    style: finalStyle\n  }, /*#__PURE__*/React.createElement(Items, _extends({}, props, {\n    payload: payload\n  })));\n};","import { useAppSelector } from '../state/hooks';\nimport { selectLegendPayload } from '../state/selectors/legendSelectors';\n\n/**\n * Use this hook in Legend, or anywhere else where you want to read the current Legend items.\n * @return all Legend items ready to be rendered\n */\nexport function useLegendPayload() {\n  return useAppSelector(selectLegendPayload);\n}","var _excluded = [\"contextPayload\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\nimport * as React from 'react';\nimport { useEffect } from 'react';\nimport { createPortal } from 'react-dom';\nimport { useLegendPortal } from '../context/legendPortalContext';\nimport { DefaultLegendContent } from './DefaultLegendContent';\nimport { isNumber } from '../util/DataUtils';\nimport { getUniqPayload } from '../util/payload/getUniqPayload';\nimport { useLegendPayload } from '../context/legendPayloadContext';\nimport { useElementOffset } from '../util/useElementOffset';\nimport { useChartHeight, useChartWidth, useMargin } from '../context/chartLayoutContext';\nimport { setLegendSettings, setLegendSize } from '../state/legendSlice';\nimport { useAppDispatch } from '../state/hooks';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nfunction defaultUniqBy(entry) {\n  return entry.value;\n}\nfunction LegendContent(props) {\n  var {\n      contextPayload\n    } = props,\n    otherProps = _objectWithoutProperties(props, _excluded);\n  var finalPayload = getUniqPayload(contextPayload, props.payloadUniqBy, defaultUniqBy);\n  var contentProps = _objectSpread(_objectSpread({}, otherProps), {}, {\n    payload: finalPayload\n  });\n  if (/*#__PURE__*/React.isValidElement(props.content)) {\n    return /*#__PURE__*/React.cloneElement(props.content, contentProps);\n  }\n  if (typeof props.content === 'function') {\n    return /*#__PURE__*/React.createElement(props.content, contentProps);\n  }\n  return /*#__PURE__*/React.createElement(DefaultLegendContent, contentProps);\n}\nfunction getDefaultPosition(style, props, margin, chartWidth, chartHeight, box) {\n  var {\n    layout,\n    align,\n    verticalAlign\n  } = props;\n  var hPos, vPos;\n  if (!style || (style.left === undefined || style.left === null) && (style.right === undefined || style.right === null)) {\n    if (align === 'center' && layout === 'vertical') {\n      hPos = {\n        left: ((chartWidth || 0) - box.width) / 2\n      };\n    } else {\n      hPos = align === 'right' ? {\n        right: margin && margin.right || 0\n      } : {\n        left: margin && margin.left || 0\n      };\n    }\n  }\n  if (!style || (style.top === undefined || style.top === null) && (style.bottom === undefined || style.bottom === null)) {\n    if (verticalAlign === 'middle') {\n      vPos = {\n        top: ((chartHeight || 0) - box.height) / 2\n      };\n    } else {\n      vPos = verticalAlign === 'bottom' ? {\n        bottom: margin && margin.bottom || 0\n      } : {\n        top: margin && margin.top || 0\n      };\n    }\n  }\n  return _objectSpread(_objectSpread({}, hPos), vPos);\n}\nfunction LegendSettingsDispatcher(props) {\n  var dispatch = useAppDispatch();\n  useEffect(() => {\n    dispatch(setLegendSettings(props));\n  }, [dispatch, props]);\n  return null;\n}\nfunction LegendSizeDispatcher(props) {\n  var dispatch = useAppDispatch();\n  useEffect(() => {\n    dispatch(setLegendSize(props));\n    return () => {\n      dispatch(setLegendSize({\n        width: 0,\n        height: 0\n      }));\n    };\n  }, [dispatch, props]);\n  return null;\n}\nfunction getWidthOrHeight(layout, height, width, maxWidth) {\n  if (layout === 'vertical' && isNumber(height)) {\n    return {\n      height\n    };\n  }\n  if (layout === 'horizontal') {\n    return {\n      width: width || maxWidth\n    };\n  }\n  return null;\n}\nexport var legendDefaultProps = {\n  align: 'center',\n  iconSize: 14,\n  itemSorter: 'value',\n  layout: 'horizontal',\n  verticalAlign: 'bottom'\n};\nexport function Legend(outsideProps) {\n  var props = resolveDefaultProps(outsideProps, legendDefaultProps);\n  var contextPayload = useLegendPayload();\n  var legendPortalFromContext = useLegendPortal();\n  var margin = useMargin();\n  var {\n    width: widthFromProps,\n    height: heightFromProps,\n    wrapperStyle,\n    portal: portalFromProps\n  } = props;\n  // The contextPayload is not used directly inside the hook, but we need the onBBoxUpdate call\n  // when the payload changes, therefore it's here as a dependency.\n  var [lastBoundingBox, updateBoundingBox] = useElementOffset([contextPayload]);\n  var chartWidth = useChartWidth();\n  var chartHeight = useChartHeight();\n  if (chartWidth == null || chartHeight == null) {\n    return null;\n  }\n  var maxWidth = chartWidth - ((margin === null || margin === void 0 ? void 0 : margin.left) || 0) - ((margin === null || margin === void 0 ? void 0 : margin.right) || 0);\n  var widthOrHeight = getWidthOrHeight(props.layout, heightFromProps, widthFromProps, maxWidth);\n  // if the user supplies their own portal, only use their defined wrapper styles\n  var outerStyle = portalFromProps ? wrapperStyle : _objectSpread(_objectSpread({\n    position: 'absolute',\n    width: (widthOrHeight === null || widthOrHeight === void 0 ? void 0 : widthOrHeight.width) || widthFromProps || 'auto',\n    height: (widthOrHeight === null || widthOrHeight === void 0 ? void 0 : widthOrHeight.height) || heightFromProps || 'auto'\n  }, getDefaultPosition(wrapperStyle, props, margin, chartWidth, chartHeight, lastBoundingBox)), wrapperStyle);\n  var legendPortal = portalFromProps !== null && portalFromProps !== void 0 ? portalFromProps : legendPortalFromContext;\n  if (legendPortal == null || contextPayload == null) {\n    return null;\n  }\n  var legendElement = /*#__PURE__*/React.createElement(\"div\", {\n    className: \"recharts-legend-wrapper\",\n    style: outerStyle,\n    ref: updateBoundingBox\n  }, /*#__PURE__*/React.createElement(LegendSettingsDispatcher, {\n    layout: props.layout,\n    align: props.align,\n    verticalAlign: props.verticalAlign,\n    itemSorter: props.itemSorter\n  }), !portalFromProps && /*#__PURE__*/React.createElement(LegendSizeDispatcher, {\n    width: lastBoundingBox.width,\n    height: lastBoundingBox.height\n  }), /*#__PURE__*/React.createElement(LegendContent, _extends({}, props, widthOrHeight, {\n    margin: margin,\n    chartWidth: chartWidth,\n    chartHeight: chartHeight,\n    contextPayload: contextPayload\n  })));\n  return /*#__PURE__*/createPortal(legendElement, legendPortal);\n}\nLegend.displayName = 'Legend';","/**\n * FieldSync Error Handling Utility\n *\n * Centralized error handling with proper logging, user feedback, and recovery.\n * Eliminates silent failures and provides consistent error handling patterns.\n *\n * Usage:\n *   import { handleError, withErrorHandling, safeAsync } from './errorHandler'\n *\n *   // Wrap async operations\n *   const data = await safeAsync(\n *     () => db.getTMTickets(projectId),\n *     { fallback: [], context: { operation: 'getTMTickets', projectId } }\n *   )\n *\n *   // Handle errors with toast\n *   try { ... } catch (error) {\n *     handleError(error, { operation: 'saveTicket', showToast: onShowToast })\n *   }\n */\n\nimport { observe } from './observability'\n\n// Error severity levels\nexport const ErrorSeverity = {\n  INFO: 'info',\n  WARNING: 'warning',\n  ERROR: 'error',\n  CRITICAL: 'critical'\n}\n\n// Error categories\nexport const ErrorCategory = {\n  DATABASE: 'database',\n  NETWORK: 'network',\n  AUTH: 'auth',\n  VALIDATION: 'validation',\n  STORAGE: 'storage',\n  SYNC: 'sync',\n  GENERAL: 'general'\n}\n\n/**\n * Determine error category from error object\n */\nfunction categorizeError(error) {\n  const message = error?.message?.toLowerCase() || ''\n  const code = error?.code?.toLowerCase() || ''\n\n  if (message.includes('fetch') || message.includes('network') || message.includes('offline')) {\n    return ErrorCategory.NETWORK\n  }\n  if (message.includes('auth') || message.includes('unauthorized') || code.includes('auth')) {\n    return ErrorCategory.AUTH\n  }\n  if (message.includes('storage') || message.includes('bucket') || message.includes('upload')) {\n    return ErrorCategory.STORAGE\n  }\n  if (message.includes('validation') || message.includes('invalid') || message.includes('required')) {\n    return ErrorCategory.VALIDATION\n  }\n  if (message.includes('sync') || message.includes('conflict')) {\n    return ErrorCategory.SYNC\n  }\n  if (error?.code || message.includes('database') || message.includes('supabase')) {\n    return ErrorCategory.DATABASE\n  }\n\n  return ErrorCategory.GENERAL\n}\n\n/**\n * Get user-friendly error message\n */\nfunction getUserMessage(error, category, context) {\n  // Custom message provided\n  if (context?.userMessage) {\n    return context.userMessage\n  }\n\n  // Network errors\n  if (category === ErrorCategory.NETWORK) {\n    return 'Network connection issue. Your changes will sync when back online.'\n  }\n\n  // Auth errors\n  if (category === ErrorCategory.AUTH) {\n    return 'Session expired. Please sign in again.'\n  }\n\n  // Storage errors\n  if (category === ErrorCategory.STORAGE) {\n    return 'Failed to upload file. Please try again.'\n  }\n\n  // Validation errors - show actual message\n  if (category === ErrorCategory.VALIDATION) {\n    return error?.message || 'Please check your input and try again.'\n  }\n\n  // Sync errors\n  if (category === ErrorCategory.SYNC) {\n    return 'Sync conflict detected. Please refresh and try again.'\n  }\n\n  // Database/general errors with operation context\n  if (context?.operation) {\n    const operation = context.operation.replace(/([A-Z])/g, ' $1').toLowerCase().trim()\n    return `Failed to ${operation}. Please try again.`\n  }\n\n  return 'Something went wrong. Please try again.'\n}\n\n/**\n * Main error handler\n *\n * @param {Error} error - The error object\n * @param {Object} options - Error handling options\n * @param {string} options.operation - Name of the operation that failed\n * @param {string} options.category - Error category (auto-detected if not provided)\n * @param {string} options.severity - Error severity (default: 'error')\n * @param {Function} options.showToast - Toast function to show user feedback\n * @param {string} options.userMessage - Custom user-facing message\n * @param {string} options.companyId - Company ID for context\n * @param {string} options.projectId - Project ID for context\n * @param {string} options.userId - User ID for context\n * @param {boolean} options.silent - If true, don't show toast (still logs)\n * @param {boolean} options.rethrow - If true, rethrow the error after handling\n */\nexport function handleError(error, options = {}) {\n  const {\n    operation = 'unknown',\n    category = categorizeError(error),\n    severity = ErrorSeverity.ERROR,\n    showToast,\n    userMessage,\n    companyId,\n    projectId,\n    userId,\n    silent = false,\n    rethrow = false\n  } = options\n\n  // Log to observability system\n  observe.error(category, {\n    message: error?.message || 'Unknown error',\n    code: error?.code,\n    severity,\n    operation,\n    company_id: companyId,\n    project_id: projectId,\n    user_id: userId,\n    extra: {\n      stack: error?.stack,\n      name: error?.name\n    }\n  })\n\n  // Show user feedback unless silent\n  if (!silent && showToast) {\n    const message = getUserMessage(error, category, { operation, userMessage })\n    const toastType = severity === ErrorSeverity.WARNING ? 'warning' : 'error'\n    showToast(message, toastType)\n  }\n\n  // Rethrow if requested\n  if (rethrow) {\n    throw error\n  }\n\n  return null\n}\n\n/**\n * Safe async wrapper - executes async function with error handling\n * Returns fallback value on error instead of throwing\n *\n * @param {Function} fn - Async function to execute\n * @param {Object} options - Options\n * @param {any} options.fallback - Value to return on error (default: null)\n * @param {Object} options.context - Context for error logging\n * @param {Function} options.showToast - Toast function\n * @param {boolean} options.silent - Don't show toast on error\n */\nexport async function safeAsync(fn, options = {}) {\n  const { fallback = null, context = {}, showToast, silent = true } = options\n\n  try {\n    return await fn()\n  } catch (error) {\n    handleError(error, {\n      ...context,\n      showToast,\n      silent\n    })\n    return fallback\n  }\n}\n\n/**\n * Higher-order function to wrap async functions with error handling\n *\n * @param {Function} fn - Async function to wrap\n * @param {Object} defaultOptions - Default error handling options\n */\nexport function withErrorHandling(fn, defaultOptions = {}) {\n  return async function(...args) {\n    try {\n      return await fn.apply(this, args)\n    } catch (error) {\n      handleError(error, defaultOptions)\n      return defaultOptions.fallback ?? null\n    }\n  }\n}\n\n/**\n * Create a safe version of a database operation\n * Logs errors and returns fallback instead of throwing\n *\n * @param {string} operation - Operation name for logging\n * @param {any} fallback - Fallback value on error\n */\nexport function createSafeOperation(operation, fallback = null) {\n  return (fn) => async (...args) => {\n    try {\n      return await fn(...args)\n    } catch (error) {\n      observe.error(ErrorCategory.DATABASE, {\n        message: error?.message || 'Unknown error',\n        operation,\n        severity: ErrorSeverity.ERROR\n      })\n      return fallback\n    }\n  }\n}\n\n/**\n * Batch multiple async operations with individual error handling\n * Returns results array with nulls for failed operations\n *\n * @param {Array<{fn: Function, fallback: any, context: Object}>} operations\n */\nexport async function safeBatch(operations) {\n  return Promise.all(\n    operations.map(({ fn, fallback = null, context = {} }) =>\n      safeAsync(fn, { fallback, context, silent: true })\n    )\n  )\n}\n\n/**\n * Retry wrapper for flaky operations\n *\n * @param {Function} fn - Async function to retry\n * @param {Object} options - Retry options\n * @param {number} options.maxRetries - Max retry attempts (default: 3)\n * @param {number} options.baseDelay - Base delay in ms (default: 1000)\n * @param {Function} options.shouldRetry - Function to determine if error is retryable\n */\nexport async function withRetry(fn, options = {}) {\n  const {\n    maxRetries = 3,\n    baseDelay = 1000,\n    shouldRetry = (error) => {\n      const message = error?.message?.toLowerCase() || ''\n      return message.includes('network') || message.includes('fetch') || message.includes('timeout')\n    }\n  } = options\n\n  let lastError\n\n  for (let attempt = 0; attempt < maxRetries; attempt++) {\n    try {\n      return await fn()\n    } catch (error) {\n      lastError = error\n\n      if (!shouldRetry(error) || attempt === maxRetries - 1) {\n        throw error\n      }\n\n      // Exponential backoff\n      const delay = baseDelay * Math.pow(2, attempt)\n      await new Promise(resolve => setTimeout(resolve, delay))\n    }\n  }\n\n  throw lastError\n}\n\nexport default {\n  handleError,\n  safeAsync,\n  withErrorHandling,\n  createSafeOperation,\n  safeBatch,\n  withRetry,\n  ErrorSeverity,\n  ErrorCategory\n}\n","/**\n * Risk Score Calculation Engine\n *\n * Calculates a composite risk score (0-100) for projects\n * based on multiple factors. Lower score = healthier project.\n *\n * Factors and weights:\n * - Budget Health: 30% - Cost ratio vs earned revenue\n * - Schedule Health: 25% - Progress vs expected progress\n * - COR Exposure: 20% - Pending COR value as % of contract\n * - Activity Cadence: 15% - Days since last daily report\n * - Safety Status: 10% - Recent injury reports\n */\n\n// Default thresholds (can be overridden per company)\nexport const DEFAULT_THRESHOLDS = {\n  budget: {\n    healthy: 0.60,   // Green if costs < 60% of revenue\n    warning: 0.75,   // Yellow if 60-75%\n    critical: 0.85   // Red if > 85%\n  },\n  schedule: {\n    healthy: 0.05,   // Green if within 5% of plan\n    warning: 0.15,   // Yellow if 5-15% behind\n    critical: 0.25   // Red if > 25% behind\n  },\n  corExposure: {\n    healthy: 0.05,   // Green if pending CORs < 5% of contract\n    warning: 0.15,   // Yellow if 5-15%\n    critical: 0.25   // Red if > 25%\n  },\n  activity: {\n    healthy: 1,      // Green if report within 1 day\n    warning: 3,      // Yellow if 2-3 days\n    critical: 5      // Red if > 5 days\n  },\n  safety: {\n    healthy: 0,      // Green if 0 incidents in 30 days\n    warning: 1,      // Yellow if 1 incident\n    critical: 2      // Red if 2+ incidents\n  }\n}\n\n// Factor weights (must sum to 1.0)\nexport const FACTOR_WEIGHTS = {\n  budget: 0.30,\n  schedule: 0.25,\n  corExposure: 0.20,\n  activity: 0.15,\n  safety: 0.10\n}\n\n/**\n * Calculate individual factor score (0-100)\n * 0 = healthy, 100 = critical\n */\nfunction calculateFactorScore(value, thresholds) {\n  if (value <= thresholds.healthy) return 0\n  if (value >= thresholds.critical) return 100\n\n  // Linear interpolation between healthy and critical\n  const range = thresholds.critical - thresholds.healthy\n  const excess = value - thresholds.healthy\n  return (excess / range) * 100\n}\n\n/**\n * Get status label for a factor score\n */\nfunction getFactorStatus(score) {\n  if (score <= 25) return 'healthy'\n  if (score <= 60) return 'warning'\n  return 'critical'\n}\n\n/**\n * Calculate budget health factor\n *\n * @param {number} totalCosts - Total costs to date\n * @param {number} earnedRevenue - Earned revenue to date\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateBudgetFactor(totalCosts, earnedRevenue, thresholds = DEFAULT_THRESHOLDS.budget) {\n  if (!earnedRevenue || earnedRevenue <= 0) {\n    // No revenue yet - can't calculate ratio\n    return { score: 0, status: 'healthy', ratio: 0, label: 'No revenue yet' }\n  }\n\n  const ratio = totalCosts / earnedRevenue\n\n  const score = calculateFactorScore(ratio, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (ratio < thresholds.healthy) {\n    label = `Costs at ${(ratio * 100).toFixed(0)}% of revenue`\n  } else if (ratio < thresholds.warning) {\n    label = `Costs at ${(ratio * 100).toFixed(0)}% - monitor closely`\n  } else {\n    label = `Costs at ${(ratio * 100).toFixed(0)}% - review immediately`\n  }\n\n  return { score, status, ratio, label }\n}\n\n/**\n * Calculate schedule health factor\n *\n * @param {number} actualProgress - Actual completion percentage (0-100)\n * @param {number} expectedProgress - Expected completion percentage (0-100)\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateScheduleFactor(actualProgress, expectedProgress, thresholds = DEFAULT_THRESHOLDS.schedule) {\n  if (!expectedProgress || expectedProgress <= 0) {\n    // No schedule baseline - assume on track\n    return { score: 0, status: 'healthy', variance: 0, label: 'No schedule baseline' }\n  }\n\n  // Variance as a ratio (negative = behind)\n  const variance = (expectedProgress - actualProgress) / expectedProgress\n  const absVariance = Math.max(0, variance) // Only penalize being behind\n\n  const score = calculateFactorScore(absVariance, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (variance <= 0) {\n    label = actualProgress >= 100 ? 'Complete' : 'On or ahead of schedule'\n  } else if (variance < thresholds.warning) {\n    label = `${(variance * 100).toFixed(0)}% behind schedule`\n  } else {\n    label = `${(variance * 100).toFixed(0)}% behind - needs attention`\n  }\n\n  return { score, status, variance, label }\n}\n\n/**\n * Calculate COR exposure factor\n *\n * @param {number} pendingCORValue - Total value of pending CORs\n * @param {number} contractValue - Total contract value\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateCORExposureFactor(pendingCORValue, contractValue, thresholds = DEFAULT_THRESHOLDS.corExposure) {\n  if (!contractValue || contractValue <= 0) {\n    return { score: 0, status: 'healthy', exposure: 0, label: 'No contract value' }\n  }\n\n  const exposure = pendingCORValue / contractValue\n\n  const score = calculateFactorScore(exposure, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (exposure < thresholds.healthy) {\n    label = pendingCORValue > 0 ? `$${formatNumber(pendingCORValue)} pending` : 'No pending CORs'\n  } else if (exposure < thresholds.warning) {\n    label = `$${formatNumber(pendingCORValue)} pending (${(exposure * 100).toFixed(0)}% of contract)`\n  } else {\n    label = `High exposure: $${formatNumber(pendingCORValue)} (${(exposure * 100).toFixed(0)}%)`\n  }\n\n  return { score, status, exposure, label }\n}\n\n/**\n * Calculate activity cadence factor\n *\n * @param {Date|string} lastReportDate - Date of last daily report\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateActivityFactor(lastReportDate, thresholds = DEFAULT_THRESHOLDS.activity) {\n  if (!lastReportDate) {\n    return { score: 100, status: 'critical', daysSince: null, label: 'No reports filed' }\n  }\n\n  const lastDate = new Date(lastReportDate)\n  const now = new Date()\n  const daysSince = Math.floor((now - lastDate) / (1000 * 60 * 60 * 24))\n\n  const score = calculateFactorScore(daysSince, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (daysSince === 0) {\n    label = 'Report filed today'\n  } else if (daysSince === 1) {\n    label = 'Report filed yesterday'\n  } else if (daysSince <= thresholds.warning) {\n    label = `Last report ${daysSince} days ago`\n  } else {\n    label = `No report in ${daysSince} days - may be stalled`\n  }\n\n  return { score, status, daysSince, label }\n}\n\n/**\n * Calculate safety factor\n *\n * @param {number} injuryCount - Number of injury reports in last 30 days\n * @param {object} thresholds - Custom thresholds (optional)\n */\nexport function calculateSafetyFactor(injuryCount, thresholds = DEFAULT_THRESHOLDS.safety) {\n  const count = injuryCount || 0\n\n  const score = calculateFactorScore(count, thresholds)\n  const status = getFactorStatus(score)\n\n  let label\n  if (count === 0) {\n    label = 'No incidents'\n  } else if (count === 1) {\n    label = '1 incident in last 30 days'\n  } else {\n    label = `${count} incidents - safety review needed`\n  }\n\n  return { score, status, count, label }\n}\n\n/**\n * Calculate composite risk score\n *\n * @param {object} project - Project data object\n * @param {object} options - Optional custom thresholds and weights\n * @returns {object} Risk score result with breakdown\n */\nexport function calculateRiskScore(project, options = {}) {\n  const thresholds = { ...DEFAULT_THRESHOLDS, ...options.thresholds }\n  const weights = { ...FACTOR_WEIGHTS, ...options.weights }\n\n  // Calculate individual factors\n  const budgetFactor = calculateBudgetFactor(\n    project.totalCosts,\n    project.earnedRevenue,\n    thresholds.budget\n  )\n\n  const scheduleFactor = calculateScheduleFactor(\n    project.actualProgress,\n    project.expectedProgress,\n    thresholds.schedule\n  )\n\n  const corFactor = calculateCORExposureFactor(\n    project.pendingCORValue,\n    project.contractValue,\n    thresholds.corExposure\n  )\n\n  const activityFactor = calculateActivityFactor(\n    project.lastReportDate,\n    thresholds.activity\n  )\n\n  const safetyFactor = calculateSafetyFactor(\n    project.recentInjuryCount,\n    thresholds.safety\n  )\n\n  // Calculate weighted composite score\n  const compositeScore = Math.round(\n    budgetFactor.score * weights.budget +\n    scheduleFactor.score * weights.schedule +\n    corFactor.score * weights.corExposure +\n    activityFactor.score * weights.activity +\n    safetyFactor.score * weights.safety\n  )\n\n  // Determine overall status\n  let overallStatus\n  if (compositeScore <= 25) {\n    overallStatus = 'healthy'\n  } else if (compositeScore <= 60) {\n    overallStatus = 'warning'\n  } else {\n    overallStatus = 'critical'\n  }\n\n  // Generate summary label\n  let summaryLabel\n  if (overallStatus === 'healthy') {\n    summaryLabel = 'Project is on track'\n  } else if (overallStatus === 'warning') {\n    summaryLabel = 'Some factors need attention'\n  } else {\n    summaryLabel = 'Immediate review recommended'\n  }\n\n  return {\n    score: compositeScore,\n    status: overallStatus,\n    label: summaryLabel,\n    factors: {\n      budget: { ...budgetFactor, weight: weights.budget },\n      schedule: { ...scheduleFactor, weight: weights.schedule },\n      corExposure: { ...corFactor, weight: weights.corExposure },\n      activity: { ...activityFactor, weight: weights.activity },\n      safety: { ...safetyFactor, weight: weights.safety }\n    }\n  }\n}\n\n/**\n * Generate smart alerts based on risk factors\n *\n * @param {object} riskResult - Result from calculateRiskScore\n * @param {object} project - Project data for context\n * @returns {array} Array of alert objects\n */\nexport function generateSmartAlerts(riskResult, project) {\n  const alerts = []\n\n  const { factors } = riskResult\n\n  // Critical alerts (priority 1)\n  if (factors.budget.status === 'critical') {\n    alerts.push({\n      type: 'critical',\n      title: 'Budget Alert',\n      description: factors.budget.label,\n      action: 'Review costs immediately',\n      actionTarget: 'financials',\n      projectId: project.id\n    })\n  }\n\n  if (factors.activity.status === 'critical') {\n    alerts.push({\n      type: 'critical',\n      title: 'Activity Alert',\n      description: factors.activity.label,\n      action: 'Check project status',\n      actionTarget: 'overview',\n      projectId: project.id\n    })\n  }\n\n  if (factors.safety.status === 'critical') {\n    alerts.push({\n      type: 'critical',\n      title: 'Safety Alert',\n      description: factors.safety.label,\n      action: 'Review safety reports',\n      actionTarget: 'reports',\n      projectId: project.id\n    })\n  }\n\n  // Warning alerts (priority 2)\n  if (factors.budget.status === 'warning') {\n    alerts.push({\n      type: 'warning',\n      title: 'Budget Watch',\n      description: factors.budget.label,\n      action: 'Monitor costs',\n      actionTarget: 'financials',\n      projectId: project.id\n    })\n  }\n\n  if (factors.schedule.status === 'critical' || factors.schedule.status === 'warning') {\n    alerts.push({\n      type: factors.schedule.status === 'critical' ? 'critical' : 'warning',\n      title: 'Schedule Alert',\n      description: factors.schedule.label,\n      action: 'Review progress',\n      actionTarget: 'overview',\n      projectId: project.id\n    })\n  }\n\n  if (factors.corExposure.status === 'warning' || factors.corExposure.status === 'critical') {\n    alerts.push({\n      type: factors.corExposure.status === 'critical' ? 'critical' : 'warning',\n      title: 'COR Exposure',\n      description: factors.corExposure.label,\n      action: 'Review pending CORs',\n      actionTarget: 'cors',\n      projectId: project.id\n    })\n  }\n\n  // Info alerts (priority 3)\n  if (factors.activity.status === 'warning') {\n    alerts.push({\n      type: 'info',\n      title: 'Activity Notice',\n      description: factors.activity.label,\n      action: 'File daily report',\n      actionTarget: 'reports',\n      projectId: project.id\n    })\n  }\n\n  // Sort by priority\n  const priorityOrder = { critical: 0, warning: 1, info: 2 }\n  alerts.sort((a, b) => priorityOrder[a.type] - priorityOrder[b.type])\n\n  return alerts\n}\n\n/**\n * Calculate projections based on current trends\n */\nexport function calculateProjections(project) {\n  const { actualProgress, totalCosts, earnedRevenue, contractValue } = project\n\n  // Guard against division by zero\n  if (!actualProgress || actualProgress <= 0) {\n    return {\n      estimatedCompletionCost: null,\n      estimatedFinalMargin: null,\n      estimatedCompletionDate: null\n    }\n  }\n\n  // Project final cost based on current burn rate\n  const costPerPercent = totalCosts / actualProgress\n  const estimatedCompletionCost = Math.round(costPerPercent * 100)\n\n  // Calculate projected margin\n  const estimatedFinalMargin = contractValue > 0\n    ? ((contractValue - estimatedCompletionCost) / contractValue) * 100\n    : 0\n\n  // If we have start date and progress, estimate completion\n  // (This is simplified - real implementation would use more sophisticated projection)\n  let estimatedCompletionDate = null\n  if (project.startDate && actualProgress > 0 && actualProgress < 100) {\n    const startDate = new Date(project.startDate)\n    const now = new Date()\n    const daysElapsed = Math.max(1, (now - startDate) / (1000 * 60 * 60 * 24))\n    const progressPerDay = actualProgress / daysElapsed\n    const remainingProgress = 100 - actualProgress\n    const daysRemaining = remainingProgress / progressPerDay\n\n    estimatedCompletionDate = new Date(now.getTime() + daysRemaining * 24 * 60 * 60 * 1000)\n  }\n\n  return {\n    estimatedCompletionCost,\n    estimatedFinalMargin,\n    estimatedCompletionDate,\n    costPerPercent\n  }\n}\n\n// Helper function\nfunction formatNumber(num) {\n  if (num >= 1000000) {\n    return (num / 1000000).toFixed(1) + 'M'\n  }\n  if (num >= 1000) {\n    return (num / 1000).toFixed(0) + 'K'\n  }\n  return num.toFixed(0)\n}\n\nexport default {\n  calculateRiskScore,\n  generateSmartAlerts,\n  calculateProjections,\n  calculateBudgetFactor,\n  calculateScheduleFactor,\n  calculateCORExposureFactor,\n  calculateActivityFactor,\n  calculateSafetyFactor,\n  DEFAULT_THRESHOLDS,\n  FACTOR_WEIGHTS\n}\n","/**\n * Field Document PDF Export\n * Exports field-submitted documents (daily reports, incident reports, crew check-ins)\n * as a consolidated or individual PDF report.\n */\n\nconst loadJsPDF = () => import('jspdf')\n\nconst PAGE_WIDTH = 210 // A4 width in mm\nconst MARGIN = 14\nconst CONTENT_WIDTH = PAGE_WIDTH - MARGIN * 2\n\n/**\n * Format currency for display\n */\nconst formatCurrency = (value) => {\n  return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(value || 0)\n}\n\n/**\n * Format date for display\n */\nconst formatDate = (dateStr) => {\n  if (!dateStr) return ''\n  const d = new Date(dateStr + (dateStr.includes('T') ? '' : 'T12:00:00'))\n  return d.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric', year: 'numeric' })\n}\n\n/**\n * Add page footer\n */\nconst addFooter = (doc, pageNum, totalPages) => {\n  const y = doc.internal.pageSize.height - 8\n  doc.setFontSize(7)\n  doc.setTextColor(128, 128, 128)\n  doc.text(`Page ${pageNum} of ${totalPages}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  doc.text(`Generated ${new Date().toLocaleString()}  FieldSync`, PAGE_WIDTH - MARGIN, y, { align: 'right' })\n}\n\n/**\n * Check if we need a new page\n */\nconst checkPage = (doc, y, needed = 30) => {\n  if (y + needed > doc.internal.pageSize.height - 20) {\n    doc.addPage()\n    return 20\n  }\n  return y\n}\n\n/**\n * Export daily reports as PDF\n * @param {Array} reports - Daily report objects\n * @param {Object} project - Project info\n * @returns {Promise<void>}\n */\nexport async function exportDailyReportsPDF(reports, project) {\n  const jsPDFModule = await loadJsPDF()\n  const jsPDF = jsPDFModule.default\n  const doc = new jsPDF()\n\n  let y = 20\n\n  // Title\n  doc.setFontSize(18)\n  doc.setFont(undefined, 'bold')\n  doc.text('Daily Reports', PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 8\n\n  doc.setFontSize(11)\n  doc.setFont(undefined, 'normal')\n  doc.text(`Project: ${project.name}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 6\n  doc.text(`${reports.length} report${reports.length !== 1 ? 's' : ''}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 12\n\n  // Each report\n  reports.forEach((report, idx) => {\n    y = checkPage(doc, y, 60)\n\n    // Report header\n    doc.setDrawColor(200, 200, 200)\n    doc.setFillColor(245, 247, 250)\n    doc.roundedRect(MARGIN, y - 2, CONTENT_WIDTH, 10, 2, 2, 'F')\n\n    doc.setFontSize(11)\n    doc.setFont(undefined, 'bold')\n    doc.setTextColor(30, 30, 30)\n    doc.text(`${formatDate(report.report_date)}`, MARGIN + 4, y + 5)\n\n    const statusText = report.status === 'submitted' ? 'Submitted' : 'Draft'\n    doc.setFontSize(9)\n    doc.setFont(undefined, 'normal')\n    doc.text(statusText, PAGE_WIDTH - MARGIN - 4, y + 5, { align: 'right' })\n    y += 14\n\n    doc.setTextColor(0, 0, 0)\n\n    // Metrics row\n    doc.setFontSize(9)\n    const metrics = [\n      `Crew: ${report.crew_count || 0}`,\n      `Tasks: ${report.tasks_completed || 0}/${report.tasks_total || 0}`,\n      `T&M Tickets: ${report.tm_tickets_count || 0}`,\n      `Photos: ${report.photos_count || 0}`\n    ]\n    doc.text(metrics.join('    |    '), MARGIN + 4, y)\n    y += 7\n\n    // Crew list\n    if (report.crew_list?.length > 0) {\n      doc.setFont(undefined, 'bold')\n      doc.text('Crew:', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      const crewNames = report.crew_list.map(w => `${w.name} (${w.role || 'Laborer'})`).join(', ')\n      const crewLines = doc.splitTextToSize(crewNames, CONTENT_WIDTH - 8)\n      y += 4\n      doc.text(crewLines, MARGIN + 4, y)\n      y += crewLines.length * 4 + 2\n    }\n\n    // Field notes\n    if (report.field_notes) {\n      y = checkPage(doc, y, 15)\n      doc.setFont(undefined, 'bold')\n      doc.text('Field Notes:', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      y += 4\n      const noteLines = doc.splitTextToSize(report.field_notes, CONTENT_WIDTH - 8)\n      doc.text(noteLines, MARGIN + 4, y)\n      y += noteLines.length * 4 + 2\n    }\n\n    // Issues\n    if (report.issues) {\n      y = checkPage(doc, y, 15)\n      doc.setFont(undefined, 'bold')\n      doc.text('Issues:', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      y += 4\n      const issueLines = doc.splitTextToSize(report.issues, CONTENT_WIDTH - 8)\n      doc.text(issueLines, MARGIN + 4, y)\n      y += issueLines.length * 4 + 2\n    }\n\n    y += 8\n\n    // Divider\n    if (idx < reports.length - 1) {\n      doc.setDrawColor(220, 220, 220)\n      doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n      y += 6\n    }\n  })\n\n  const fileName = `${project.name}_Daily_Reports_${new Date().toISOString().split('T')[0]}.pdf`\n  doc.save(fileName)\n}\n\n/**\n * Export incident/injury reports as PDF\n * @param {Array} reports - Injury report objects\n * @param {Object} project - Project info\n * @returns {Promise<void>}\n */\nexport async function exportIncidentReportsPDF(reports, project) {\n  const jsPDFModule = await loadJsPDF()\n  const jsPDF = jsPDFModule.default\n  const doc = new jsPDF()\n\n  let y = 20\n\n  // Title\n  doc.setFontSize(18)\n  doc.setFont(undefined, 'bold')\n  doc.text('Incident / Injury Reports', PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 8\n\n  doc.setFontSize(11)\n  doc.setFont(undefined, 'normal')\n  doc.text(`Project: ${project.name}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 6\n  doc.text(`${reports.length} report${reports.length !== 1 ? 's' : ''}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 12\n\n  reports.forEach((report, idx) => {\n    y = checkPage(doc, y, 50)\n\n    // Header bar\n    const severityColors = {\n      minor: [34, 197, 94],\n      serious: [245, 158, 11],\n      critical: [239, 68, 68],\n      near_miss: [59, 130, 246]\n    }\n    const color = severityColors[report.injury_type] || [128, 128, 128]\n\n    doc.setFillColor(...color)\n    doc.roundedRect(MARGIN, y - 2, 3, 14, 1, 1, 'F')\n\n    doc.setFontSize(11)\n    doc.setFont(undefined, 'bold')\n    doc.setTextColor(30, 30, 30)\n    doc.text(`${formatDate(report.incident_date)}`, MARGIN + 8, y + 4)\n\n    doc.setFontSize(9)\n    const typeLabel = (report.injury_type || '').replace('_', ' ').toUpperCase()\n    doc.text(typeLabel, MARGIN + 8, y + 10)\n\n    doc.setFont(undefined, 'normal')\n    doc.text(report.status === 'open' ? 'OPEN' : 'CLOSED', PAGE_WIDTH - MARGIN - 4, y + 4, { align: 'right' })\n    y += 16\n\n    doc.setTextColor(0, 0, 0)\n\n    // Description\n    if (report.description) {\n      doc.setFontSize(9)\n      doc.setFont(undefined, 'bold')\n      doc.text('Description:', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      y += 4\n      const lines = doc.splitTextToSize(report.description, CONTENT_WIDTH - 8)\n      doc.text(lines, MARGIN + 4, y)\n      y += lines.length * 4 + 2\n    }\n\n    // Location\n    if (report.location) {\n      doc.setFont(undefined, 'bold')\n      doc.text('Location: ', MARGIN + 4, y)\n      doc.setFont(undefined, 'normal')\n      doc.text(report.location, MARGIN + 30, y)\n      y += 6\n    }\n\n    y += 6\n\n    if (idx < reports.length - 1) {\n      doc.setDrawColor(220, 220, 220)\n      doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n      y += 6\n    }\n  })\n\n  const fileName = `${project.name}_Incident_Reports_${new Date().toISOString().split('T')[0]}.pdf`\n  doc.save(fileName)\n}\n\n/**\n * Export crew check-in history as PDF\n * @param {Array} checkins - Crew check-in objects\n * @param {Object} project - Project info\n * @returns {Promise<void>}\n */\nexport async function exportCrewCheckinsPDF(checkins, project) {\n  const jsPDFModule = await loadJsPDF()\n  const jsPDF = jsPDFModule.default\n  const doc = new jsPDF()\n\n  let y = 20\n\n  doc.setFontSize(18)\n  doc.setFont(undefined, 'bold')\n  doc.text('Crew Check-In History', PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 8\n\n  doc.setFontSize(11)\n  doc.setFont(undefined, 'normal')\n  doc.text(`Project: ${project.name}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 6\n  doc.text(`${checkins.length} check-in${checkins.length !== 1 ? 's' : ''}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 12\n\n  checkins.forEach((checkin, idx) => {\n    y = checkPage(doc, y, 30)\n    const workers = checkin.workers || []\n\n    // Date header\n    doc.setFillColor(245, 247, 250)\n    doc.roundedRect(MARGIN, y - 2, CONTENT_WIDTH, 9, 2, 2, 'F')\n\n    doc.setFontSize(10)\n    doc.setFont(undefined, 'bold')\n    doc.setTextColor(30, 30, 30)\n    doc.text(formatDate(checkin.check_in_date), MARGIN + 4, y + 4)\n    doc.setFont(undefined, 'normal')\n    doc.text(`${workers.length} workers`, PAGE_WIDTH - MARGIN - 4, y + 4, { align: 'right' })\n    y += 12\n\n    doc.setTextColor(0, 0, 0)\n    doc.setFontSize(9)\n\n    // Worker list as table\n    if (workers.length > 0) {\n      doc.setFont(undefined, 'bold')\n      doc.text('Name', MARGIN + 4, y)\n      doc.text('Role', 110, y)\n      y += 5\n\n      doc.setFont(undefined, 'normal')\n      workers.forEach(w => {\n        y = checkPage(doc, y, 6)\n        doc.text(w.name || '', MARGIN + 4, y)\n        doc.text(w.role || 'Laborer', 110, y)\n        y += 4.5\n      })\n    }\n\n    y += 6\n\n    if (idx < checkins.length - 1) {\n      doc.setDrawColor(220, 220, 220)\n      doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n      y += 5\n    }\n  })\n\n  const fileName = `${project.name}_Crew_Checkins_${new Date().toISOString().split('T')[0]}.pdf`\n  doc.save(fileName)\n}\n\n/**\n * Export ALL field documents as a single consolidated PDF\n * @param {Object} params\n * @param {Array} params.dailyReports\n * @param {Array} params.incidentReports\n * @param {Array} params.crewCheckins\n * @param {Object} params.project\n * @returns {Promise<void>}\n */\nexport async function exportAllFieldDocumentsPDF({ dailyReports = [], incidentReports = [], crewCheckins = [], project }) {\n  const jsPDFModule = await loadJsPDF()\n  const jsPDF = jsPDFModule.default\n  const doc = new jsPDF()\n\n  let y = 20\n\n  // Cover page\n  doc.setFontSize(22)\n  doc.setFont(undefined, 'bold')\n  doc.text('Field Documents Report', PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 10\n\n  doc.setFontSize(13)\n  doc.setFont(undefined, 'normal')\n  doc.text(`Project: ${project.name}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 8\n\n  doc.setFontSize(10)\n  doc.text(`Generated: ${new Date().toLocaleDateString()}`, PAGE_WIDTH / 2, y, { align: 'center' })\n  y += 16\n\n  // Summary table\n  doc.setFontSize(11)\n  doc.setFont(undefined, 'bold')\n  doc.text('Document Summary', MARGIN, y)\n  y += 8\n\n  doc.setFontSize(10)\n  doc.setFont(undefined, 'normal')\n  const summaryItems = [\n    [`Daily Reports`, `${dailyReports.length}`],\n    [`Incident Reports`, `${incidentReports.length}`],\n    [`Crew Check-Ins`, `${crewCheckins.length}`]\n  ]\n  summaryItems.forEach(([label, count]) => {\n    doc.text(label, MARGIN + 4, y)\n    doc.text(count, 100, y)\n    y += 6\n  })\n\n  // Daily Reports Section\n  if (dailyReports.length > 0) {\n    doc.addPage()\n    y = 20\n\n    doc.setFontSize(16)\n    doc.setFont(undefined, 'bold')\n    doc.text('Daily Reports', MARGIN, y)\n    y += 10\n\n    dailyReports.forEach((report, idx) => {\n      y = checkPage(doc, y, 40)\n\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'bold')\n      doc.setTextColor(30, 30, 30)\n      doc.text(formatDate(report.report_date), MARGIN + 2, y)\n      doc.setFont(undefined, 'normal')\n      doc.setFontSize(8)\n      doc.text(`Crew: ${report.crew_count || 0} | Tasks: ${report.tasks_completed || 0}/${report.tasks_total || 0} | T&M: ${report.tm_tickets_count || 0}`, MARGIN + 60, y)\n      y += 6\n\n      doc.setTextColor(0, 0, 0)\n      doc.setFontSize(9)\n\n      if (report.field_notes) {\n        const lines = doc.splitTextToSize(report.field_notes, CONTENT_WIDTH - 4)\n        doc.text(lines, MARGIN + 2, y)\n        y += lines.length * 4 + 2\n      }\n\n      if (report.issues) {\n        doc.setFont(undefined, 'bold')\n        doc.text('Issues: ', MARGIN + 2, y)\n        doc.setFont(undefined, 'normal')\n        const issueLines = doc.splitTextToSize(report.issues, CONTENT_WIDTH - 20)\n        doc.text(issueLines, MARGIN + 20, y)\n        y += issueLines.length * 4 + 2\n      }\n\n      y += 4\n      if (idx < dailyReports.length - 1) {\n        doc.setDrawColor(220, 220, 220)\n        doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n        y += 4\n      }\n    })\n  }\n\n  // Incident Reports Section\n  if (incidentReports.length > 0) {\n    doc.addPage()\n    y = 20\n\n    doc.setFontSize(16)\n    doc.setFont(undefined, 'bold')\n    doc.text('Incident / Injury Reports', MARGIN, y)\n    y += 10\n\n    incidentReports.forEach((report, idx) => {\n      y = checkPage(doc, y, 35)\n\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'bold')\n      doc.setTextColor(30, 30, 30)\n      doc.text(formatDate(report.incident_date), MARGIN + 2, y)\n      doc.setFontSize(8)\n      doc.setFont(undefined, 'normal')\n      const typeLabel = (report.injury_type || '').replace('_', ' ').toUpperCase()\n      doc.text(`${typeLabel}  ${report.status?.toUpperCase() || ''}`, MARGIN + 60, y)\n      y += 6\n\n      doc.setTextColor(0, 0, 0)\n      doc.setFontSize(9)\n\n      if (report.description) {\n        const lines = doc.splitTextToSize(report.description, CONTENT_WIDTH - 4)\n        doc.text(lines, MARGIN + 2, y)\n        y += lines.length * 4 + 2\n      }\n\n      if (report.location) {\n        doc.text(`Location: ${report.location}`, MARGIN + 2, y)\n        y += 5\n      }\n\n      y += 4\n      if (idx < incidentReports.length - 1) {\n        doc.setDrawColor(220, 220, 220)\n        doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n        y += 4\n      }\n    })\n  }\n\n  // Crew Check-Ins Section\n  if (crewCheckins.length > 0) {\n    doc.addPage()\n    y = 20\n\n    doc.setFontSize(16)\n    doc.setFont(undefined, 'bold')\n    doc.text('Crew Check-In History', MARGIN, y)\n    y += 10\n\n    crewCheckins.forEach((checkin, idx) => {\n      y = checkPage(doc, y, 20)\n      const workers = checkin.workers || []\n\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'bold')\n      doc.setTextColor(30, 30, 30)\n      doc.text(formatDate(checkin.check_in_date), MARGIN + 2, y)\n      doc.setFont(undefined, 'normal')\n      doc.setFontSize(8)\n      doc.text(`${workers.length} workers`, MARGIN + 60, y)\n      y += 6\n\n      doc.setTextColor(0, 0, 0)\n      doc.setFontSize(8)\n\n      if (workers.length > 0) {\n        const workerList = workers.map(w => `${w.name} (${w.role || 'Laborer'})`).join(', ')\n        const lines = doc.splitTextToSize(workerList, CONTENT_WIDTH - 4)\n        doc.text(lines, MARGIN + 2, y)\n        y += lines.length * 3.5 + 3\n      }\n\n      if (idx < crewCheckins.length - 1) {\n        doc.setDrawColor(230, 230, 230)\n        doc.line(MARGIN, y, PAGE_WIDTH - MARGIN, y)\n        y += 3\n      }\n    })\n  }\n\n  const fileName = `${project.name}_Field_Documents_${new Date().toISOString().split('T')[0]}.pdf`\n  doc.save(fileName)\n}\n","/**\n * Financial Export Module\n * Generates CSV/IIF exports for accounting integration\n */\n\n// Helper to trigger file download\nfunction downloadFile(content, filename, mimeType = 'text/csv') {\n  const blob = new Blob([content], { type: mimeType })\n  const url = URL.createObjectURL(blob)\n  const a = document.createElement('a')\n  a.href = url\n  a.download = filename\n  document.body.appendChild(a)\n  a.click()\n  document.body.removeChild(a)\n  URL.revokeObjectURL(url)\n}\n\n// Escape CSV field (handle commas, quotes, newlines)\nexport function escapeCSV(value) {\n  if (value == null) return ''\n  const str = String(value)\n  if (str.includes(',') || str.includes('\"') || str.includes('\\n')) {\n    return `\"${str.replace(/\"/g, '\"\"')}\"`\n  }\n  return str\n}\n\n// Convert array of objects to CSV string\nexport function toCSV(headers, rows) {\n  const headerLine = headers.map(h => escapeCSV(h.label)).join(',')\n  const dataLines = rows.map(row =>\n    headers.map(h => escapeCSV(row[h.key])).join(',')\n  )\n  return [headerLine, ...dataLines].join('\\n')\n}\n\n/**\n * Export project financial summary as CSV\n */\nexport function exportProjectFinancials(project, financialData) {\n  const headers = [\n    { key: 'category', label: 'Category' },\n    { key: 'description', label: 'Description' },\n    { key: 'amount', label: 'Amount' },\n    { key: 'date', label: 'Date' },\n    { key: 'type', label: 'Type' }\n  ]\n\n  const rows = []\n\n  // Contract value\n  rows.push({ category: 'Revenue', description: 'Original Contract Value', amount: project.contract_value || 0, date: project.start_date || '', type: 'Contract' })\n\n  // Earned revenue\n  if (financialData?.earnedRevenue) {\n    rows.push({ category: 'Revenue', description: 'Earned Revenue (Progress)', amount: financialData.earnedRevenue, date: new Date().toISOString().split('T')[0], type: 'Earned' })\n  }\n\n  // Approved CORs\n  if (financialData?.approvedCORs) {\n    financialData.approvedCORs.forEach(cor => {\n      rows.push({ category: 'Revenue', description: `COR: ${cor.cor_number} - ${cor.title}`, amount: (cor.cor_total || 0) / 100, date: cor.approved_at?.split('T')[0] || '', type: 'Change Order' })\n    })\n  }\n\n  // Labor costs\n  if (financialData?.laborByDate) {\n    financialData.laborByDate.forEach(d => {\n      rows.push({ category: 'Cost', description: 'Labor', amount: d.cost, date: d.date, type: 'Labor' })\n    })\n  }\n\n  // Disposal costs\n  if (financialData?.haulOffByDate) {\n    financialData.haulOffByDate.forEach(d => {\n      rows.push({ category: 'Cost', description: 'Disposal/Haul-off', amount: d.cost, date: d.date, type: 'Disposal' })\n    })\n  }\n\n  // Custom costs\n  if (financialData?.customCosts) {\n    financialData.customCosts.forEach(c => {\n      rows.push({ category: 'Cost', description: c.description || c.category || 'Other', amount: parseFloat(c.amount) || 0, date: c.cost_date || '', type: c.category || 'Other' })\n    })\n  }\n\n  // Summary row\n  const totalRevenue = rows.filter(r => r.category === 'Revenue').reduce((s, r) => s + (parseFloat(r.amount) || 0), 0)\n  const totalCosts = rows.filter(r => r.category === 'Cost').reduce((s, r) => s + (parseFloat(r.amount) || 0), 0)\n  rows.push({ category: '', description: '', amount: '', date: '', type: '' })\n  rows.push({ category: 'Summary', description: 'Total Revenue', amount: totalRevenue, date: '', type: '' })\n  rows.push({ category: 'Summary', description: 'Total Costs', amount: totalCosts, date: '', type: '' })\n  rows.push({ category: 'Summary', description: 'Gross Profit', amount: totalRevenue - totalCosts, date: '', type: '' })\n  rows.push({ category: 'Summary', description: 'Margin %', amount: totalRevenue > 0 ? ((totalRevenue - totalCosts) / totalRevenue * 100).toFixed(1) + '%' : 'N/A', date: '', type: '' })\n\n  const csv = toCSV(headers, rows)\n  const filename = `${project.name.replace(/[^a-zA-Z0-9]/g, '_')}_Financials_${new Date().toISOString().split('T')[0]}.csv`\n  downloadFile(csv, filename)\n}\n\n/**\n * Export COR detail as CSV\n */\nexport function exportCORDetail(cor, project) {\n  const rows = []\n  const headers = [\n    { key: 'section', label: 'Section' },\n    { key: 'description', label: 'Description' },\n    { key: 'quantity', label: 'Quantity' },\n    { key: 'unit', label: 'Unit' },\n    { key: 'rate', label: 'Rate' },\n    { key: 'total', label: 'Total' }\n  ]\n\n  // COR header info\n  rows.push({ section: 'COR Info', description: `${cor.cor_number} - ${cor.title}`, quantity: '', unit: '', rate: '', total: '' })\n  rows.push({ section: 'Status', description: cor.status, quantity: '', unit: '', rate: '', total: '' })\n  rows.push({ section: 'Period', description: `${cor.period_start || ''} to ${cor.period_end || ''}`, quantity: '', unit: '', rate: '', total: '' })\n  rows.push({ section: '', description: '', quantity: '', unit: '', rate: '', total: '' })\n\n  // Labor\n  if (cor.change_order_labor?.length > 0) {\n    rows.push({ section: 'LABOR', description: '', quantity: '', unit: '', rate: '', total: '' })\n    cor.change_order_labor.forEach(item => {\n      const regHrs = parseFloat(item.regular_hours) || 0\n      const otHrs = parseFloat(item.overtime_hours) || 0\n      rows.push({ section: '', description: item.description || item.classification, quantity: regHrs + otHrs, unit: 'hours', rate: (parseInt(item.regular_rate) || 0) / 100, total: (parseInt(item.total) || 0) / 100 })\n    })\n  }\n\n  // Materials\n  if (cor.change_order_materials?.length > 0) {\n    rows.push({ section: 'MATERIALS', description: '', quantity: '', unit: '', rate: '', total: '' })\n    cor.change_order_materials.forEach(item => {\n      rows.push({ section: '', description: item.description, quantity: parseFloat(item.quantity) || 0, unit: item.unit || 'each', rate: (parseInt(item.unit_cost) || 0) / 100, total: (parseInt(item.total) || 0) / 100 })\n    })\n  }\n\n  // Equipment\n  if (cor.change_order_equipment?.length > 0) {\n    rows.push({ section: 'EQUIPMENT', description: '', quantity: '', unit: '', rate: '', total: '' })\n    cor.change_order_equipment.forEach(item => {\n      rows.push({ section: '', description: item.description, quantity: parseFloat(item.quantity) || 0, unit: item.unit || 'day', rate: (parseInt(item.unit_cost) || 0) / 100, total: (parseInt(item.total) || 0) / 100 })\n    })\n  }\n\n  // Subcontractors\n  if (cor.change_order_subcontractors?.length > 0) {\n    rows.push({ section: 'SUBCONTRACTORS', description: '', quantity: '', unit: '', rate: '', total: '' })\n    cor.change_order_subcontractors.forEach(item => {\n      rows.push({ section: '', description: item.description, quantity: parseFloat(item.quantity) || 0, unit: item.unit || 'lump sum', rate: (parseInt(item.unit_cost) || 0) / 100, total: (parseInt(item.total) || 0) / 100 })\n    })\n  }\n\n  const csv = toCSV(headers, rows)\n  const filename = `COR_${cor.cor_number || cor.id}_${new Date().toISOString().split('T')[0]}.csv`\n  downloadFile(csv, filename)\n}\n\n/**\n * Export T&M tickets as CSV\n */\nexport function exportTMTicketsCSV(tickets, project) {\n  const headers = [\n    { key: 'date', label: 'Date' },\n    { key: 'status', label: 'Status' },\n    { key: 'workers', label: 'Worker Count' },\n    { key: 'totalHours', label: 'Total Hours' },\n    { key: 'otHours', label: 'OT Hours' },\n    { key: 'materialsCost', label: 'Materials Cost' },\n    { key: 'corNumber', label: 'COR #' },\n    { key: 'notes', label: 'Notes' }\n  ]\n\n  const rows = tickets.map(t => {\n    const workers = t.t_and_m_workers || []\n    const items = t.t_and_m_items || []\n    const totalHours = workers.reduce((s, w) => s + (parseFloat(w.hours) || 0), 0)\n    const otHours = workers.reduce((s, w) => s + (parseFloat(w.overtime_hours) || 0), 0)\n    const materialsCost = items.reduce((s, i) => s + ((parseFloat(i.quantity) || 0) * (i.materials_equipment?.cost_per_unit || 0)), 0)\n\n    return {\n      date: t.work_date,\n      status: t.status,\n      workers: workers.length,\n      totalHours: (totalHours + otHours).toFixed(1),\n      otHours: otHours.toFixed(1),\n      materialsCost: materialsCost.toFixed(2),\n      corNumber: t.assigned_cor_id ? 'Linked' : '',\n      notes: t.notes || ''\n    }\n  })\n\n  const csv = toCSV(headers, rows)\n  const filename = `${project.name.replace(/[^a-zA-Z0-9]/g, '_')}_TM_Tickets_${new Date().toISOString().split('T')[0]}.csv`\n  downloadFile(csv, filename)\n}\n\n/**\n * Export to QuickBooks IIF format (General Journal Entry)\n * IIF = Intuit Interchange Format - importable by QuickBooks Desktop\n */\nexport function exportToQuickBooksIIF(project, financialData) {\n  const lines = []\n  const txnDate = new Date().toLocaleDateString('en-US', { month: '2-digit', day: '2-digit', year: 'numeric' })\n\n  // IIF Header\n  lines.push('!TRNS\\tTRNSTYPE\\tDATE\\tACCNT\\tNAME\\tAMOUNT\\tMEMO')\n  lines.push('!SPL\\tTRNSTYPE\\tDATE\\tACCNT\\tNAME\\tAMOUNT\\tMEMO')\n  lines.push('!ENDTRNS')\n\n  // Revenue entry\n  const totalRevenue = (project.contract_value || 0)\n  lines.push(`TRNS\\tGENERAL JOURNAL\\t${txnDate}\\tAccounts Receivable\\t${project.name}\\t${totalRevenue.toFixed(2)}\\tFieldSync - Contract Revenue`)\n  lines.push(`SPL\\tGENERAL JOURNAL\\t${txnDate}\\tConstruction Revenue\\t${project.name}\\t${(-totalRevenue).toFixed(2)}\\tContract: ${project.name}`)\n  lines.push('ENDTRNS')\n\n  // Cost entries\n  const totalLabor = financialData?.totalLaborCost || 0\n  if (totalLabor > 0) {\n    lines.push(`TRNS\\tGENERAL JOURNAL\\t${txnDate}\\tDirect Labor\\t${project.name}\\t${totalLabor.toFixed(2)}\\tLabor costs - ${project.name}`)\n    lines.push(`SPL\\tGENERAL JOURNAL\\t${txnDate}\\tAccounts Payable\\t${project.name}\\t${(-totalLabor).toFixed(2)}\\tLabor costs`)\n    lines.push('ENDTRNS')\n  }\n\n  const totalDisposal = financialData?.totalDisposalCost || 0\n  if (totalDisposal > 0) {\n    lines.push(`TRNS\\tGENERAL JOURNAL\\t${txnDate}\\tDisposal Expense\\t${project.name}\\t${totalDisposal.toFixed(2)}\\tDisposal costs - ${project.name}`)\n    lines.push(`SPL\\tGENERAL JOURNAL\\t${txnDate}\\tAccounts Payable\\t${project.name}\\t${(-totalDisposal).toFixed(2)}\\tDisposal costs`)\n    lines.push('ENDTRNS')\n  }\n\n  const content = lines.join('\\n')\n  const filename = `${project.name.replace(/[^a-zA-Z0-9]/g, '_')}_QB_${new Date().toISOString().split('T')[0]}.iif`\n  downloadFile(content, filename, 'application/x-iif')\n}\n\n/**\n * Export multi-project summary as CSV\n */\nexport function exportPortfolioSummary(projects, projectDataMap) {\n  const headers = [\n    { key: 'name', label: 'Project Name' },\n    { key: 'jobNumber', label: 'Job #' },\n    { key: 'status', label: 'Status' },\n    { key: 'contractValue', label: 'Contract Value' },\n    { key: 'progress', label: 'Progress %' },\n    { key: 'earnedRevenue', label: 'Earned Revenue' },\n    { key: 'totalCosts', label: 'Total Costs' },\n    { key: 'profit', label: 'Profit' },\n    { key: 'margin', label: 'Margin %' }\n  ]\n\n  const rows = projects.map(p => {\n    const data = projectDataMap?.[p.id] || {}\n    const earned = data.earnedRevenue || 0\n    const costs = data.totalCosts || 0\n    const profit = earned - costs\n    return {\n      name: p.name,\n      jobNumber: p.job_number || '',\n      status: p.status || 'active',\n      contractValue: (p.contract_value || 0).toFixed(2),\n      progress: (data.progress || 0).toFixed(1),\n      earnedRevenue: earned.toFixed(2),\n      totalCosts: costs.toFixed(2),\n      profit: profit.toFixed(2),\n      margin: earned > 0 ? ((profit / earned) * 100).toFixed(1) : '0.0'\n    }\n  })\n\n  const csv = toCSV(headers, rows)\n  const filename = `Portfolio_Summary_${new Date().toISOString().split('T')[0]}.csv`\n  downloadFile(csv, filename)\n}\n","import { useState, useEffect, useRef, useCallback } from 'react'\nimport { Search, X, FolderOpen, FileText, Users, ClipboardList, ChevronRight, Command } from 'lucide-react'\nimport { db } from '../lib/supabase'\n\nexport default function UniversalSearch({\n  isOpen,\n  onClose,\n  companyId,\n  onSelectProject,\n  onSelectTicket,\n  onSelectCOR,\n  onShowToast\n}) {\n  const [query, setQuery] = useState('')\n  const [results, setResults] = useState({ projects: [], tickets: [], cors: [], workers: [] })\n  const [loading, setLoading] = useState(false)\n  const [selectedIndex, setSelectedIndex] = useState(0)\n  const inputRef = useRef(null)\n  const searchTimeoutRef = useRef(null)\n  const focusTimeoutRef = useRef(null)\n\n  // Cleanup timers on unmount\n  useEffect(() => {\n    return () => {\n      if (searchTimeoutRef.current) clearTimeout(searchTimeoutRef.current)\n      if (focusTimeoutRef.current) clearTimeout(focusTimeoutRef.current)\n    }\n  }, [])\n\n  // Focus input when modal opens\n  useEffect(() => {\n    if (isOpen) {\n      setQuery('')\n      setResults({ projects: [], tickets: [], cors: [], workers: [] })\n      setSelectedIndex(0)\n      focusTimeoutRef.current = setTimeout(() => inputRef.current?.focus(), 50)\n    }\n  }, [isOpen])\n\n  // Debounced search\n  const performSearch = useCallback(async (searchQuery) => {\n    if (!searchQuery.trim() || searchQuery.length < 2) {\n      setResults({ projects: [], tickets: [], cors: [], workers: [] })\n      return\n    }\n\n    setLoading(true)\n    try {\n      const searchResults = await db.universalSearch(companyId, searchQuery.trim())\n      setResults(searchResults)\n      setSelectedIndex(0)\n    } catch (error) {\n      console.error('Search error:', error)\n      onShowToast?.('Search failed', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }, [companyId, onShowToast])\n\n  // Handle input change with debounce\n  const handleInputChange = (e) => {\n    const value = e.target.value\n    setQuery(value)\n\n    // Clear previous timeout\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current)\n    }\n\n    // Debounce search\n    searchTimeoutRef.current = setTimeout(() => {\n      performSearch(value)\n    }, 200)\n  }\n\n  // Get all results as flat array for keyboard navigation\n  const getAllResults = () => {\n    const all = []\n    results.projects.forEach(p => all.push({ type: 'project', data: p }))\n    results.tickets.forEach(t => all.push({ type: 'ticket', data: t }))\n    results.cors.forEach(c => all.push({ type: 'cor', data: c }))\n    results.workers.forEach(w => all.push({ type: 'worker', data: w }))\n    return all\n  }\n\n  const allResults = getAllResults()\n  const hasResults = allResults.length > 0\n\n  // Handle keyboard navigation\n  const handleKeyDown = (e) => {\n    if (e.key === 'Escape') {\n      onClose()\n    } else if (e.key === 'ArrowDown') {\n      e.preventDefault()\n      setSelectedIndex(prev => Math.min(prev + 1, allResults.length - 1))\n    } else if (e.key === 'ArrowUp') {\n      e.preventDefault()\n      setSelectedIndex(prev => Math.max(prev - 1, 0))\n    } else if (e.key === 'Enter' && hasResults) {\n      e.preventDefault()\n      handleSelect(allResults[selectedIndex])\n    }\n  }\n\n  // Handle selection\n  const handleSelect = (item) => {\n    if (!item) return\n\n    switch (item.type) {\n      case 'project':\n        onSelectProject?.(item.data)\n        break\n      case 'ticket':\n        onSelectTicket?.(item.data)\n        break\n      case 'cor':\n        onSelectCOR?.(item.data)\n        break\n      case 'worker':\n        // Navigate to project where worker was last seen\n        if (item.data.lastProject) {\n          onSelectProject?.(item.data.lastProject)\n        }\n        break\n    }\n    onClose()\n  }\n\n  // Get icon for result type\n  const getIcon = (type) => {\n    switch (type) {\n      case 'project': return FolderOpen\n      case 'ticket': return FileText\n      case 'cor': return ClipboardList\n      case 'worker': return Users\n      default: return FileText\n    }\n  }\n\n  // Get label for result type\n  const getTypeLabel = (type) => {\n    switch (type) {\n      case 'project': return 'Project'\n      case 'ticket': return 'T&M Ticket'\n      case 'cor': return 'Change Order'\n      case 'worker': return 'Worker'\n      default: return type\n    }\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <div className=\"universal-search-overlay\" onClick={onClose}>\n      <div className=\"universal-search-modal\" onClick={e => e.stopPropagation()}>\n        {/* Search Input */}\n        <div className=\"universal-search-input-wrapper\">\n          <Search size={20} className=\"universal-search-icon\" />\n          <input\n            ref={inputRef}\n            type=\"text\"\n            value={query}\n            onChange={handleInputChange}\n            onKeyDown={handleKeyDown}\n            placeholder=\"Search projects, tickets, CORs, workers...\"\n            className=\"universal-search-input\"\n            autoComplete=\"off\"\n            autoCorrect=\"off\"\n            spellCheck=\"false\"\n          />\n          {query && (\n            <button className=\"universal-search-clear\" onClick={() => setQuery('')}>\n              <X size={16} />\n            </button>\n          )}\n          <div className=\"universal-search-shortcut\">\n            <span>esc</span>\n          </div>\n        </div>\n\n        {/* Results */}\n        <div className=\"universal-search-results\">\n          {loading ? (\n            <div className=\"universal-search-loading\">\n              <div className=\"spinner-small\"></div>\n              <span>Searching...</span>\n            </div>\n          ) : !query.trim() ? (\n            <div className=\"universal-search-empty\">\n              <div className=\"universal-search-tip\">\n                <Command size={14} />\n                <span>Type to search across all data</span>\n              </div>\n              <div className=\"universal-search-hints\">\n                <span>Projects</span>\n                <span>T&M Tickets</span>\n                <span>Change Orders</span>\n                <span>Workers</span>\n              </div>\n            </div>\n          ) : !hasResults ? (\n            <div className=\"universal-search-no-results\">\n              <span>No results for \"{query}\"</span>\n            </div>\n          ) : (\n            <>\n              {/* Projects */}\n              {results.projects.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <FolderOpen size={14} />\n                    <span>Projects</span>\n                  </div>\n                  {results.projects.map((project, idx) => {\n                    const globalIdx = idx\n                    return (\n                      <button\n                        key={project.id}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'project', data: project })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <FolderOpen size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">{project.name}</span>\n                          {project.job_number && (\n                            <span className=\"universal-search-item-meta\">#{project.job_number}</span>\n                          )}\n                        </div>\n                        <ChevronRight size={16} className=\"universal-search-item-arrow\" />\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n\n              {/* T&M Tickets */}\n              {results.tickets.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <FileText size={14} />\n                    <span>T&M Tickets</span>\n                  </div>\n                  {results.tickets.map((ticket, idx) => {\n                    const globalIdx = results.projects.length + idx\n                    return (\n                      <button\n                        key={ticket.id}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'ticket', data: ticket })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <FileText size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">\n                            {ticket.description?.substring(0, 50) || 'T&M Ticket'}\n                            {ticket.description?.length > 50 && '...'}\n                          </span>\n                          <span className=\"universal-search-item-meta\">\n                            {ticket.projectName}  {ticket.work_date}\n                          </span>\n                        </div>\n                        <span className={`universal-search-item-badge ${ticket.status}`}>\n                          {ticket.status}\n                        </span>\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n\n              {/* Change Orders */}\n              {results.cors.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <ClipboardList size={14} />\n                    <span>Change Orders</span>\n                  </div>\n                  {results.cors.map((cor, idx) => {\n                    const globalIdx = results.projects.length + results.tickets.length + idx\n                    return (\n                      <button\n                        key={cor.id}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'cor', data: cor })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <ClipboardList size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">\n                            {cor.cor_number ? `COR #${cor.cor_number}: ` : ''}{cor.title}\n                          </span>\n                          <span className=\"universal-search-item-meta\">\n                            {cor.projectName}\n                          </span>\n                        </div>\n                        <span className={`universal-search-item-badge ${cor.status}`}>\n                          {cor.status}\n                        </span>\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n\n              {/* Workers */}\n              {results.workers.length > 0 && (\n                <div className=\"universal-search-section\">\n                  <div className=\"universal-search-section-header\">\n                    <Users size={14} />\n                    <span>Workers</span>\n                  </div>\n                  {results.workers.map((worker, idx) => {\n                    const globalIdx = results.projects.length + results.tickets.length + results.cors.length + idx\n                    return (\n                      <button\n                        key={`${worker.name}-${idx}`}\n                        className={`universal-search-item ${selectedIndex === globalIdx ? 'selected' : ''}`}\n                        onClick={() => handleSelect({ type: 'worker', data: worker })}\n                        onMouseEnter={() => setSelectedIndex(globalIdx)}\n                      >\n                        <Users size={18} />\n                        <div className=\"universal-search-item-content\">\n                          <span className=\"universal-search-item-title\">{worker.name}</span>\n                          <span className=\"universal-search-item-meta\">\n                            {worker.role}  {worker.projectName}\n                          </span>\n                        </div>\n                        <ChevronRight size={16} className=\"universal-search-item-arrow\" />\n                      </button>\n                    )\n                  })}\n                </div>\n              )}\n            </>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"universal-search-footer\">\n          <div className=\"universal-search-footer-hint\">\n            <span className=\"key\"></span> navigate\n          </div>\n          <div className=\"universal-search-footer-hint\">\n            <span className=\"key\"></span> select\n          </div>\n          <div className=\"universal-search-footer-hint\">\n            <span className=\"key\">esc</span> close\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// Hook for keyboard shortcut\nexport function useUniversalSearch() {\n  const [isOpen, setIsOpen] = useState(false)\n\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      // Cmd+K (Mac) or Ctrl+K (Windows/Linux)\n      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {\n        e.preventDefault()\n        setIsOpen(prev => !prev)\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyDown)\n    return () => document.removeEventListener('keydown', handleKeyDown)\n  }, [])\n\n  return { isOpen, setIsOpen, open: () => setIsOpen(true), close: () => setIsOpen(false) }\n}\n","import React, { useState, useCallback } from 'react'\nimport { AlertTriangle, XCircle, Info, X, ArrowRight } from 'lucide-react'\n\n/**\n * SmartAlerts\n *\n * Container for displaying prioritized actionable alerts.\n * Alerts can be dismissed and are sorted by priority.\n *\n * @param {array} alerts - Array of alert objects\n * @param {function} onAction - Callback when alert action is clicked\n * @param {function} onDismiss - Callback when alert is dismissed\n * @param {number} maxVisible - Maximum alerts to show (default: 3)\n */\nexport function SmartAlerts({\n  alerts = [],\n  onAction,\n  onDismiss,\n  maxVisible = 3,\n  className = ''\n}) {\n  const [dismissedIds, setDismissedIds] = useState(new Set())\n\n  const visibleAlerts = alerts\n    .filter(alert => !dismissedIds.has(alert.id || `${alert.projectId}-${alert.type}-${alert.title}`))\n    .slice(0, maxVisible)\n\n  const handleDismiss = useCallback((alert) => {\n    const alertId = alert.id || `${alert.projectId}-${alert.type}-${alert.title}`\n    setDismissedIds(prev => new Set([...prev, alertId]))\n    onDismiss?.(alert)\n  }, [onDismiss])\n\n  if (visibleAlerts.length === 0) {\n    return null\n  }\n\n  return (\n    <div\n      className={`smart-alerts ${className}`}\n      role=\"region\"\n      aria-label=\"Project alerts\"\n      aria-live=\"polite\"\n    >\n      {visibleAlerts.map((alert, index) => (\n        <SmartAlertCard\n          key={alert.id || `${alert.projectId}-${alert.type}-${index}`}\n          alert={alert}\n          onAction={onAction}\n          onDismiss={() => handleDismiss(alert)}\n        />\n      ))}\n\n      {alerts.length > maxVisible && (\n        <div className=\"smart-alerts__overflow\">\n          <span className=\"smart-alerts__overflow-text\">\n            +{alerts.length - maxVisible} more alerts\n          </span>\n        </div>\n      )}\n    </div>\n  )\n}\n\n/**\n * SmartAlertCard\n *\n * Individual alert card with icon, message, action, and dismiss.\n *\n * @param {object} alert - Alert object\n * @param {function} onAction - Action button click handler\n * @param {function} onDismiss - Dismiss button click handler\n */\nexport function SmartAlertCard({\n  alert,\n  onAction,\n  onDismiss\n}) {\n  const {\n    type = 'info',\n    title,\n    description,\n    action,\n    actionTarget,\n    projectId,\n    projectName\n  } = alert\n\n  const icons = {\n    critical: XCircle,\n    warning: AlertTriangle,\n    info: Info\n  }\n\n  const Icon = icons[type] || Info\n\n  const handleAction = () => {\n    onAction?.({\n      target: actionTarget,\n      projectId,\n      alert\n    })\n  }\n\n  return (\n    <div\n      className={`smart-alert smart-alert--${type}`}\n      role=\"alert\"\n      aria-live={type === 'critical' ? 'assertive' : 'polite'}\n    >\n      <Icon className=\"smart-alert__icon\" aria-hidden=\"true\" />\n\n      <div className=\"smart-alert__content\">\n        <div className=\"smart-alert__title\">\n          {projectName && <span className=\"smart-alert__project\">{projectName}: </span>}\n          {title}\n        </div>\n\n        {description && (\n          <div className=\"smart-alert__description\">{description}</div>\n        )}\n\n        {action && (\n          <div className=\"smart-alert__action\">\n            <button\n              type=\"button\"\n              className=\"smart-alert__action-btn\"\n              onClick={handleAction}\n            >\n              {action}\n              <ArrowRight size={14} aria-hidden=\"true\" />\n            </button>\n          </div>\n        )}\n      </div>\n\n      {onDismiss && (\n        <button\n          type=\"button\"\n          className=\"smart-alert__dismiss\"\n          onClick={onDismiss}\n          aria-label=\"Dismiss alert\"\n        >\n          <X size={18} aria-hidden=\"true\" />\n        </button>\n      )}\n    </div>\n  )\n}\n\n/**\n * AlertSummaryBanner\n *\n * Compact banner showing alert counts by type.\n * Useful when space is limited.\n *\n * @param {array} alerts - Array of alert objects\n * @param {function} onClick - Click handler to expand alerts\n */\nexport function AlertSummaryBanner({ alerts = [], onClick, className = '' }) {\n  const counts = {\n    critical: alerts.filter(a => a.type === 'critical').length,\n    warning: alerts.filter(a => a.type === 'warning').length,\n    info: alerts.filter(a => a.type === 'info').length\n  }\n\n  const total = alerts.length\n\n  if (total === 0) return null\n\n  return (\n    <button\n      type=\"button\"\n      className={`alert-summary-banner ${className}`}\n      onClick={onClick}\n      aria-label={`${total} alerts: ${counts.critical} critical, ${counts.warning} warnings, ${counts.info} info. Click to view.`}\n    >\n      {counts.critical > 0 && (\n        <span className=\"alert-summary-banner__item alert-summary-banner__item--critical\">\n          <XCircle size={14} aria-hidden=\"true\" />\n          {counts.critical}\n        </span>\n      )}\n      {counts.warning > 0 && (\n        <span className=\"alert-summary-banner__item alert-summary-banner__item--warning\">\n          <AlertTriangle size={14} aria-hidden=\"true\" />\n          {counts.warning}\n        </span>\n      )}\n      {counts.info > 0 && (\n        <span className=\"alert-summary-banner__item alert-summary-banner__item--info\">\n          <Info size={14} aria-hidden=\"true\" />\n          {counts.info}\n        </span>\n      )}\n      <ArrowRight size={14} className=\"alert-summary-banner__arrow\" aria-hidden=\"true\" />\n    </button>\n  )\n}\n\n/**\n * NoAlertsMessage\n *\n * Positive message when there are no alerts.\n */\nexport function NoAlertsMessage({ className = '' }) {\n  return (\n    <div className={`no-alerts-message ${className}`}>\n      <span className=\"no-alerts-message__icon\" aria-hidden=\"true\"></span>\n      <span className=\"no-alerts-message__text\">All projects on track</span>\n    </div>\n  )\n}\n\n/**\n * Helper to aggregate alerts from multiple projects\n */\nexport function aggregateAlerts(projectAlerts) {\n  // Flatten all alerts from all projects\n  const allAlerts = projectAlerts.flatMap(p => p.alerts || [])\n\n  // Sort by priority\n  const priorityOrder = { critical: 0, warning: 1, info: 2 }\n  allAlerts.sort((a, b) => {\n    const priorityDiff = priorityOrder[a.type] - priorityOrder[b.type]\n    if (priorityDiff !== 0) return priorityDiff\n    // Secondary sort by project name\n    return (a.projectName || '').localeCompare(b.projectName || '')\n  })\n\n  return allAlerts\n}\n\nexport default SmartAlerts\n","import { memo, useEffect, useState, useRef } from 'react'\n\n/**\n * OverviewProgressGauge - Large circular progress indicator for project overview\n * Shows completion percentage with animated stroke and areas status\n */\nexport const OverviewProgressGauge = memo(function OverviewProgressGauge({\n  progress = 0,\n  areasComplete = 0,\n  totalAreas = 0,\n  areasWorking = 0,\n  size = 110,\n  strokeWidth = 9\n}) {\n  const [animatedProgress, setAnimatedProgress] = useState(0)\n  const animationRef = useRef(null)\n\n  // Animate progress on mount/change\n  useEffect(() => {\n    const startValue = animatedProgress\n    const endValue = Math.min(100, Math.max(0, progress))\n    const duration = 800\n    const startTime = performance.now()\n\n    const animate = (currentTime) => {\n      const elapsed = currentTime - startTime\n      const progressRatio = Math.min(elapsed / duration, 1)\n\n      // Ease out cubic\n      const eased = 1 - Math.pow(1 - progressRatio, 3)\n      const current = startValue + (endValue - startValue) * eased\n\n      setAnimatedProgress(current)\n\n      if (progressRatio < 1) {\n        animationRef.current = requestAnimationFrame(animate)\n      }\n    }\n\n    animationRef.current = requestAnimationFrame(animate)\n\n    return () => {\n      if (animationRef.current) {\n        cancelAnimationFrame(animationRef.current)\n      }\n    }\n  }, [progress])\n\n  const radius = (size - strokeWidth) / 2\n  const circumference = radius * 2 * Math.PI\n  const offset = circumference - (animatedProgress / 100) * circumference\n\n  // Color based on progress\n  const getProgressColor = () => {\n    if (animatedProgress >= 80) return 'var(--accent-green)'\n    if (animatedProgress >= 50) return 'var(--accent-blue)'\n    if (animatedProgress >= 25) return 'var(--accent-blue)'\n    return 'var(--text-muted)'\n  }\n\n  return (\n    <div className=\"overview-progress-gauge\">\n      <div className=\"progress-gauge-circle\" style={{ width: size, height: size }}>\n        <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`}>\n          {/* Background track */}\n          <circle\n            className=\"gauge-track\"\n            cx={size / 2}\n            cy={size / 2}\n            r={radius}\n            fill=\"none\"\n            strokeWidth={strokeWidth}\n            stroke=\"var(--bg-tertiary)\"\n          />\n          {/* Progress arc */}\n          <circle\n            className=\"gauge-fill\"\n            cx={size / 2}\n            cy={size / 2}\n            r={radius}\n            fill=\"none\"\n            stroke={getProgressColor()}\n            strokeWidth={strokeWidth}\n            strokeDasharray={circumference}\n            strokeDashoffset={offset}\n            strokeLinecap=\"round\"\n            transform={`rotate(-90 ${size / 2} ${size / 2})`}\n            style={{ transition: 'stroke 0.3s ease' }}\n          />\n        </svg>\n        {/* Center content */}\n        <div className=\"gauge-center\">\n          <span className=\"gauge-value\">{Math.round(animatedProgress)}%</span>\n          <span className=\"gauge-label\">Complete</span>\n        </div>\n      </div>\n\n      {/* Areas status below */}\n      <div className=\"gauge-areas-status\">\n        <span className=\"areas-count\">\n          <strong>{areasComplete}</strong>/{totalAreas} Areas Done\n        </span>\n        {areasWorking > 0 && (\n          <span className=\"areas-active\">{areasWorking} active</span>\n        )}\n      </div>\n    </div>\n  )\n})\n\nexport default OverviewProgressGauge\n","// ============================================\n// Chart Configuration\n// ============================================\n// Centralized theme colors, animations, and styles\n// for all financial dashboard charts.\n// ============================================\n\n// Chart color palette - matches app theme\nexport const chartColors = {\n  // Financial lines\n  contract: '#3b82f6',     // Blue - contract ceiling\n  revenue: '#10b981',      // Green - earned revenue\n  costs: '#f59e0b',        // Amber - spending\n  profit: '#22c55e',       // Emerald - positive profit\n  loss: '#ef4444',         // Red - negative/loss\n\n  // Extra work\n  tmValue: '#8b5cf6',      // Purple - T&M ticket value\n  corValue: '#14b8a6',     // Teal - COR approved value\n\n  // Cost categories\n  labor: '#6366f1',        // Indigo\n  disposal: '#14b8a6',     // Teal\n  equipment: '#f97316',    // Orange\n  materials: '#a855f7',    // Purple\n  subcontractor: '#ec4899', // Pink\n  other: '#6b7280',        // Gray\n\n  // UI\n  grid: 'var(--border-color)',\n  text: 'var(--text-secondary)',\n  background: 'var(--bg-card)',\n}\n\n// Animation configuration\nexport const animationConfig = {\n  duration: 800,\n  easing: 'ease-out',\n}\n\n// Common tooltip styles\nexport const tooltipStyle = {\n  contentStyle: {\n    background: 'var(--bg-card)',\n    border: '1px solid var(--border-color)',\n    borderRadius: '8px',\n    boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\n    padding: '12px 16px',\n  },\n  labelStyle: {\n    color: 'var(--text-primary)',\n    fontWeight: 600,\n    marginBottom: '8px',\n  },\n  itemStyle: {\n    color: 'var(--text-secondary)',\n    padding: '2px 0',\n  },\n}\n\n// Cost category configuration\nexport const costCategories = {\n  labor: {\n    label: 'Labor',\n    color: chartColors.labor,\n    icon: 'HardHat',\n  },\n  disposal: {\n    label: 'Disposal',\n    color: chartColors.disposal,\n    icon: 'Trash2',\n  },\n  equipment: {\n    label: 'Equipment',\n    color: chartColors.equipment,\n    icon: 'Truck',\n  },\n  materials: {\n    label: 'Materials',\n    color: chartColors.materials,\n    icon: 'Package',\n  },\n  subcontractor: {\n    label: 'Subcontractor',\n    color: chartColors.subcontractor,\n    icon: 'Users',\n  },\n  other: {\n    label: 'Other',\n    color: chartColors.other,\n    icon: 'MoreHorizontal',\n  },\n}\n\n// Time range options for charts\nexport const timeRanges = [\n  { id: '7d', label: '7D', days: 7 },\n  { id: '30d', label: '30D', days: 30 },\n  { id: '90d', label: '90D', days: 90 },\n  { id: 'all', label: 'All', days: null },\n]\n\n// Format currency for chart labels\nexport const formatChartCurrency = (value) => {\n  if (value >= 1000000) {\n    return `$${(value / 1000000).toFixed(1)}M`\n  }\n  if (value >= 1000) {\n    return `$${(value / 1000).toFixed(0)}K`\n  }\n  return `$${value.toFixed(0)}`\n}\n\n// Format date for chart axis\nexport const formatChartDate = (dateStr) => {\n  const date = new Date(dateStr)\n  return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n}\n\n// Gradient definitions for area charts\nexport const gradientDefs = {\n  revenue: {\n    id: 'revenueGradient',\n    color: chartColors.revenue,\n    startOpacity: 0.3,\n    endOpacity: 0,\n  },\n  costs: {\n    id: 'costsGradient',\n    color: chartColors.costs,\n    startOpacity: 0.3,\n    endOpacity: 0,\n  },\n  tmValue: {\n    id: 'tmValueGradient',\n    color: chartColors.tmValue,\n    startOpacity: 0.2,\n    endOpacity: 0,\n  },\n}\n","import { memo, useEffect, useState, useRef } from 'react'\nimport { TrendingUp, TrendingDown, Minus } from 'lucide-react'\nimport { chartColors } from '../charts/chartConfig'\n\n/**\n * OverviewFinancialCard - Compact financial snapshot for project overview\n * Shows earned, costs, profit with mini cost breakdown bar\n */\nexport const OverviewFinancialCard = memo(function OverviewFinancialCard({\n  earnedRevenue = 0,\n  totalCosts = 0,\n  laborCost = 0,\n  disposalCost = 0,\n  equipmentCost = 0,\n  materialsCost = 0,\n  otherCost = 0,\n  contractValue = 0\n}) {\n  const profit = earnedRevenue - totalCosts\n  const margin = earnedRevenue > 0 ? (profit / earnedRevenue) * 100 : 0\n  const isPositive = profit >= 0\n\n  // Format currency\n  const formatCurrency = (value) => {\n    if (value >= 1000000) {\n      return `$${(value / 1000000).toFixed(1)}M`\n    }\n    if (value >= 1000) {\n      return `$${(value / 1000).toFixed(1)}K`\n    }\n    return `$${value.toFixed(0)}`\n  }\n\n  // Calculate cost breakdown percentages for the stacked bar\n  const costBreakdown = [\n    { key: 'labor', value: laborCost, color: chartColors.labor, label: 'Labor' },\n    { key: 'disposal', value: disposalCost, color: chartColors.disposal, label: 'Disposal' },\n    { key: 'equipment', value: equipmentCost, color: chartColors.equipment, label: 'Equipment' },\n    { key: 'materials', value: materialsCost, color: chartColors.materials, label: 'Materials' },\n    { key: 'other', value: otherCost, color: chartColors.other, label: 'Other' }\n  ].filter(item => item.value > 0)\n\n  const hasBreakdown = costBreakdown.length > 0 && totalCosts > 0\n\n  return (\n    <div className=\"overview-financial-card animate-fade-in-up\">\n      {/* Main metrics row */}\n      <div className=\"financial-metrics-row\">\n        {/* Earned */}\n        <div className=\"financial-metric\">\n          <span className=\"financial-metric-value green\">{formatCurrency(earnedRevenue)}</span>\n          <span className=\"financial-metric-label\">Earned</span>\n        </div>\n\n        {/* Costs */}\n        <div className=\"financial-metric\">\n          <span className=\"financial-metric-value amber\">{formatCurrency(totalCosts)}</span>\n          <span className=\"financial-metric-label\">Costs</span>\n        </div>\n\n        {/* Profit */}\n        <div className=\"financial-metric\">\n          <span className={`financial-metric-value ${isPositive ? 'green' : 'red'}`}>\n            {isPositive ? '' : '-'}{formatCurrency(Math.abs(profit))}\n          </span>\n          <span className=\"financial-metric-label\">\n            Profit\n            <span className={`margin-badge ${isPositive ? 'positive' : 'negative'}`}>\n              {margin >= 0 ? '+' : ''}{margin.toFixed(0)}%\n            </span>\n          </span>\n        </div>\n      </div>\n\n      {/* Cost breakdown bar */}\n      {hasBreakdown && (\n        <div className=\"cost-breakdown-section\">\n          <div className=\"cost-breakdown-bar\">\n            {costBreakdown.map((item, index) => {\n              const widthPercent = (item.value / totalCosts) * 100\n              return (\n                <div\n                  key={item.key}\n                  className=\"cost-segment\"\n                  style={{\n                    width: `${widthPercent}%`,\n                    backgroundColor: item.color,\n                    animationDelay: `${index * 100}ms`\n                  }}\n                  title={`${item.label}: ${formatCurrency(item.value)} (${widthPercent.toFixed(0)}%)`}\n                />\n              )\n            })}\n          </div>\n          <div className=\"cost-breakdown-legend\">\n            {costBreakdown.slice(0, 4).map(item => (\n              <span key={item.key} className=\"legend-item\">\n                <span className=\"legend-dot\" style={{ backgroundColor: item.color }} />\n                <span className=\"legend-label\">{item.label}</span>\n              </span>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  )\n})\n\nexport default OverviewFinancialCard\n","import { memo } from 'react'\n\n/**\n * Skeleton - Loading placeholder component\n * Follows progressive disclosure principle - shows structure before content\n */\n\n// Base skeleton with shimmer animation\nexport const Skeleton = memo(function Skeleton({\n  width,\n  height,\n  borderRadius = '8px',\n  className = '',\n  variant = 'default' // 'default' | 'text' | 'circular' | 'rectangular'\n}) {\n  const getVariantStyles = () => {\n    switch (variant) {\n      case 'text':\n        return { height: '1em', borderRadius: '4px' }\n      case 'circular':\n        return { borderRadius: '50%' }\n      case 'rectangular':\n        return { borderRadius: '0' }\n      default:\n        return { borderRadius }\n    }\n  }\n\n  const variantStyles = getVariantStyles()\n\n  return (\n    <div\n      className={`skeleton ${className}`}\n      style={{\n        width: width || '100%',\n        height: height || variantStyles.height || '1rem',\n        borderRadius: variantStyles.borderRadius,\n      }}\n      aria-hidden=\"true\"\n    />\n  )\n})\n\n// Skeleton for metric cards (value + label)\nexport const MetricSkeleton = memo(function MetricSkeleton({ showProgress = false }) {\n  return (\n    <div className=\"metric-skeleton\">\n      <Skeleton width=\"60%\" height=\"0.75rem\" className=\"skeleton-label\" />\n      <Skeleton width=\"80%\" height=\"1.75rem\" className=\"skeleton-value\" />\n      {showProgress && (\n        <Skeleton width=\"100%\" height=\"6px\" className=\"skeleton-progress\" />\n      )}\n    </div>\n  )\n})\n\n// Skeleton for cards (header + content)\nexport const CardSkeleton = memo(function CardSkeleton({\n  lines = 3,\n  showHeader = true,\n  showAction = false\n}) {\n  return (\n    <div className=\"card-skeleton\" aria-busy=\"true\" aria-label=\"Loading content\">\n      {showHeader && (\n        <div className=\"card-skeleton-header\">\n          <Skeleton width=\"40%\" height=\"1.25rem\" />\n          {showAction && <Skeleton width=\"80px\" height=\"32px\" />}\n        </div>\n      )}\n      <div className=\"card-skeleton-body\">\n        {Array.from({ length: lines }).map((_, i) => (\n          <Skeleton\n            key={i}\n            width={`${100 - (i * 15)}%`}\n            height=\"1rem\"\n            className=\"skeleton-line\"\n          />\n        ))}\n      </div>\n    </div>\n  )\n})\n\n// Skeleton for list items\nexport const ListItemSkeleton = memo(function ListItemSkeleton({\n  count = 3,\n  showAvatar = false,\n  showAction = false\n}) {\n  return (\n    <div className=\"list-skeleton\" aria-busy=\"true\" aria-label=\"Loading list\">\n      {Array.from({ length: count }).map((_, i) => (\n        <div key={i} className=\"list-item-skeleton\">\n          {showAvatar && <Skeleton width=\"40px\" height=\"40px\" variant=\"circular\" />}\n          <div className=\"list-item-skeleton-content\">\n            <Skeleton width=\"60%\" height=\"1rem\" />\n            <Skeleton width=\"40%\" height=\"0.75rem\" />\n          </div>\n          {showAction && <Skeleton width=\"60px\" height=\"28px\" />}\n        </div>\n      ))}\n    </div>\n  )\n})\n\n// Skeleton for financial analysis row (3 cards)\nexport const FinancialRowSkeleton = memo(function FinancialRowSkeleton() {\n  return (\n    <div className=\"financial-row-skeleton\" aria-busy=\"true\" aria-label=\"Loading financial data\">\n      {[1, 2, 3].map(i => (\n        <div key={i} className=\"financial-card-skeleton\">\n          <div className=\"financial-card-skeleton-header\">\n            <Skeleton width=\"24px\" height=\"24px\" variant=\"circular\" />\n            <Skeleton width=\"60%\" height=\"1rem\" />\n          </div>\n          <Skeleton width=\"50%\" height=\"2rem\" className=\"skeleton-hero-value\" />\n          <div className=\"financial-card-skeleton-details\">\n            <Skeleton width=\"100%\" height=\"0.875rem\" />\n            <Skeleton width=\"80%\" height=\"0.875rem\" />\n          </div>\n        </div>\n      ))}\n    </div>\n  )\n})\n\n// Skeleton for chart placeholder\nexport const ChartSkeleton = memo(function ChartSkeleton({ height = '200px' }) {\n  return (\n    <div className=\"chart-skeleton\" style={{ height }} aria-busy=\"true\" aria-label=\"Loading chart\">\n      <div className=\"chart-skeleton-bars\">\n        {[40, 65, 45, 80, 55, 70, 50, 75, 60, 85].map((h, i) => (\n          <div\n            key={i}\n            className=\"chart-skeleton-bar\"\n            style={{ height: `${h}%` }}\n          />\n        ))}\n      </div>\n      <Skeleton width=\"100%\" height=\"1px\" className=\"chart-skeleton-axis\" />\n    </div>\n  )\n})\n\n// Skeleton for COR/Ticket items\nexport const TicketSkeleton = memo(function TicketSkeleton({ count = 3 }) {\n  return (\n    <div className=\"ticket-skeleton-list\" aria-busy=\"true\" aria-label=\"Loading tickets\">\n      {Array.from({ length: count }).map((_, i) => (\n        <div key={i} className=\"ticket-skeleton-item\">\n          <div className=\"ticket-skeleton-header\">\n            <Skeleton width=\"100px\" height=\"0.875rem\" />\n            <Skeleton width=\"80px\" height=\"24px\" borderRadius=\"12px\" />\n          </div>\n          <Skeleton width=\"90%\" height=\"1rem\" />\n          <div className=\"ticket-skeleton-footer\">\n            <Skeleton width=\"60px\" height=\"0.75rem\" />\n            <Skeleton width=\"60px\" height=\"0.75rem\" />\n            <Skeleton width=\"60px\" height=\"0.75rem\" />\n          </div>\n        </div>\n      ))}\n    </div>\n  )\n})\n\n// Skeleton for hero metrics row\nexport const HeroMetricsSkeleton = memo(function HeroMetricsSkeleton() {\n  return (\n    <div className=\"hero-metrics-skeleton\" aria-busy=\"true\" aria-label=\"Loading metrics\">\n      {[1, 2, 3, 4].map(i => (\n        <div key={i} className=\"hero-metric-skeleton\">\n          <Skeleton width=\"80px\" height=\"0.75rem\" className=\"skeleton-label\" />\n          <Skeleton width=\"120px\" height=\"1.75rem\" className=\"skeleton-value\" />\n          <Skeleton width=\"100%\" height=\"4px\" className=\"skeleton-bar\" />\n        </div>\n      ))}\n    </div>\n  )\n})\n\nexport default Skeleton\n","import { memo } from 'react'\nimport { AlertTriangle, RefreshCw, WifiOff } from 'lucide-react'\n\n/**\n * ErrorState - Reusable error display component for list/data components\n * Provides user-friendly error messages with retry functionality\n */\nexport const ErrorState = memo(function ErrorState({\n  title = 'Unable to load data',\n  message = 'Something went wrong. Please try again.',\n  error = null,\n  onRetry = null,\n  retryLabel = 'Try Again',\n  variant = 'default', // 'default' | 'inline' | 'compact'\n  icon: CustomIcon = null\n}) {\n  // Determine icon based on error type\n  const getIcon = () => {\n    if (CustomIcon) return CustomIcon\n    if (error?.message?.includes('network') || error?.message?.includes('offline')) {\n      return WifiOff\n    }\n    return AlertTriangle\n  }\n\n  const Icon = getIcon()\n\n  if (variant === 'compact') {\n    return (\n      <div className=\"error-state error-state-compact\" role=\"alert\">\n        <Icon size={16} className=\"error-state-icon\" aria-hidden=\"true\" />\n        <span className=\"error-state-message\">{message}</span>\n        {onRetry && (\n          <button\n            className=\"btn btn-ghost btn-small\"\n            onClick={onRetry}\n            aria-label={retryLabel}\n          >\n            <RefreshCw size={14} />\n          </button>\n        )}\n      </div>\n    )\n  }\n\n  if (variant === 'inline') {\n    return (\n      <div className=\"error-state error-state-inline\" role=\"alert\">\n        <div className=\"error-state-content\">\n          <Icon size={20} className=\"error-state-icon\" aria-hidden=\"true\" />\n          <div className=\"error-state-text\">\n            <span className=\"error-state-title\">{title}</span>\n            <span className=\"error-state-message\">{message}</span>\n          </div>\n        </div>\n        {onRetry && (\n          <button className=\"btn btn-secondary btn-small\" onClick={onRetry}>\n            <RefreshCw size={14} /> {retryLabel}\n          </button>\n        )}\n      </div>\n    )\n  }\n\n  // Default variant - centered with full details\n  return (\n    <div className=\"error-state\" role=\"alert\" aria-live=\"polite\">\n      <div className=\"error-state-icon-wrapper\">\n        <Icon size={32} className=\"error-state-icon\" aria-hidden=\"true\" />\n      </div>\n      <h4 className=\"error-state-title\">{title}</h4>\n      <p className=\"error-state-message\">{message}</p>\n\n      {/* Show error details in development */}\n      {import.meta.env.DEV && error && (\n        <details className=\"error-state-details\">\n          <summary>Error Details</summary>\n          <pre>{error.message || String(error)}</pre>\n        </details>\n      )}\n\n      {onRetry && (\n        <button className=\"btn btn-primary\" onClick={onRetry}>\n          <RefreshCw size={16} /> {retryLabel}\n        </button>\n      )}\n    </div>\n  )\n})\n\n/**\n * EmptyState - Reusable empty state component\n * Shows when a list/data is empty (no error, just no data)\n */\nexport const EmptyState = memo(function EmptyState({\n  title = 'No data yet',\n  message = 'Items will appear here once added.',\n  icon: Icon = null,\n  action = null,\n  actionLabel = 'Get Started',\n  onAction = null\n}) {\n  return (\n    <div className=\"empty-state\" role=\"status\">\n      {Icon && (\n        <div className=\"empty-state-icon-wrapper\">\n          <Icon size={32} className=\"empty-state-icon\" aria-hidden=\"true\" />\n        </div>\n      )}\n      <h4 className=\"empty-state-title\">{title}</h4>\n      <p className=\"empty-state-message\">{message}</p>\n      {onAction && (\n        <button className=\"btn btn-primary btn-small\" onClick={onAction}>\n          {actionLabel}\n        </button>\n      )}\n      {action && !onAction && action}\n    </div>\n  )\n})\n\nexport default ErrorState\n","import { memo } from 'react'\nimport { AlertCircle } from 'lucide-react'\n\n/**\n * FormField - Reusable form field wrapper with validation display\n * Provides consistent styling and error handling for form inputs\n */\nexport const FormField = memo(function FormField({\n  label,\n  error,\n  required = false,\n  hint,\n  children,\n  className = ''\n}) {\n  return (\n    <div className={`form-field ${error ? 'has-error' : ''} ${className}`}>\n      {label && (\n        <label className=\"form-field-label\">\n          {label}\n          {required && <span className=\"form-field-required\">*</span>}\n        </label>\n      )}\n      <div className=\"form-field-input\">\n        {children}\n      </div>\n      {error && (\n        <div className=\"form-field-error\" role=\"alert\">\n          <AlertCircle size={14} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n      {hint && !error && (\n        <div className=\"form-field-hint\">{hint}</div>\n      )}\n    </div>\n  )\n})\n\n/**\n * ValidatedInput - Input with built-in validation styling\n */\nexport const ValidatedInput = memo(function ValidatedInput({\n  type = 'text',\n  value,\n  onChange,\n  onBlur,\n  error,\n  placeholder,\n  disabled,\n  min,\n  max,\n  step,\n  pattern,\n  required,\n  autoComplete,\n  name,\n  id,\n  className = '',\n  'aria-label': ariaLabel,\n  'aria-describedby': ariaDescribedBy\n}) {\n  const inputId = id || name\n  const errorId = error ? `${inputId}-error` : undefined\n\n  return (\n    <>\n      <input\n        type={type}\n        id={inputId}\n        name={name}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        placeholder={placeholder}\n        disabled={disabled}\n        min={min}\n        max={max}\n        step={step}\n        pattern={pattern}\n        required={required}\n        autoComplete={autoComplete}\n        className={`validated-input ${error ? 'has-error' : ''} ${className}`}\n        aria-label={ariaLabel}\n        aria-invalid={!!error}\n        aria-describedby={error ? errorId : ariaDescribedBy}\n      />\n      {error && (\n        <div id={errorId} className=\"input-error-inline\" role=\"alert\">\n          <AlertCircle size={12} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n    </>\n  )\n})\n\n/**\n * ValidatedSelect - Select with built-in validation styling\n */\nexport const ValidatedSelect = memo(function ValidatedSelect({\n  value,\n  onChange,\n  onBlur,\n  error,\n  disabled,\n  required,\n  name,\n  id,\n  className = '',\n  children,\n  'aria-label': ariaLabel\n}) {\n  const selectId = id || name\n  const errorId = error ? `${selectId}-error` : undefined\n\n  return (\n    <>\n      <select\n        id={selectId}\n        name={name}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        disabled={disabled}\n        required={required}\n        className={`validated-select ${error ? 'has-error' : ''} ${className}`}\n        aria-label={ariaLabel}\n        aria-invalid={!!error}\n        aria-describedby={error ? errorId : undefined}\n      >\n        {children}\n      </select>\n      {error && (\n        <div id={errorId} className=\"input-error-inline\" role=\"alert\">\n          <AlertCircle size={12} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n    </>\n  )\n})\n\n/**\n * ValidatedTextarea - Textarea with built-in validation styling\n */\nexport const ValidatedTextarea = memo(function ValidatedTextarea({\n  value,\n  onChange,\n  onBlur,\n  error,\n  placeholder,\n  disabled,\n  required,\n  rows = 3,\n  maxLength,\n  name,\n  id,\n  className = '',\n  'aria-label': ariaLabel\n}) {\n  const textareaId = id || name\n  const errorId = error ? `${textareaId}-error` : undefined\n\n  return (\n    <>\n      <textarea\n        id={textareaId}\n        name={name}\n        value={value}\n        onChange={onChange}\n        onBlur={onBlur}\n        placeholder={placeholder}\n        disabled={disabled}\n        required={required}\n        rows={rows}\n        maxLength={maxLength}\n        className={`validated-textarea ${error ? 'has-error' : ''} ${className}`}\n        aria-label={ariaLabel}\n        aria-invalid={!!error}\n        aria-describedby={error ? errorId : undefined}\n      />\n      {maxLength && (\n        <div className=\"textarea-counter\">\n          {value?.length || 0} / {maxLength}\n        </div>\n      )}\n      {error && (\n        <div id={errorId} className=\"input-error-inline\" role=\"alert\">\n          <AlertCircle size={12} aria-hidden=\"true\" />\n          <span>{error}</span>\n        </div>\n      )}\n    </>\n  )\n})\n\nexport default FormField\n","import { memo, useEffect, useState, useRef } from 'react'\nimport { TrendingUp, TrendingDown, Minus, Check, AlertTriangle, Clock } from 'lucide-react'\n\n/**\n * Micro-Visualizations - Small, informative visual elements\n * Designed to replace mental calculation and clarify status at a glance\n */\n\n// Animated count badge with optional pulse for new items\nexport const CountBadge = memo(function CountBadge({\n  count,\n  label,\n  variant = 'default', // 'default' | 'primary' | 'success' | 'warning' | 'danger'\n  size = 'medium', // 'small' | 'medium' | 'large'\n  pulse = false,\n  icon: Icon\n}) {\n  const [prevCount, setPrevCount] = useState(count)\n  const [animating, setAnimating] = useState(false)\n\n  useEffect(() => {\n    if (count !== prevCount) {\n      setAnimating(true)\n      const timer = setTimeout(() => {\n        setAnimating(false)\n        setPrevCount(count)\n      }, 400)\n      return () => clearTimeout(timer)\n    }\n  }, [count, prevCount])\n\n  return (\n    <span\n      className={`count-badge count-badge-${variant} count-badge-${size} ${pulse ? 'badge-new' : ''} ${animating ? 'animate-count-up' : ''}`}\n      title={label}\n    >\n      {Icon && <Icon size={size === 'small' ? 12 : size === 'large' ? 18 : 14} />}\n      <span className=\"count-badge-value\">{count}</span>\n      {label && <span className=\"count-badge-label\">{label}</span>}\n    </span>\n  )\n})\n\n// Mini progress bar for inline usage\nexport const MiniProgress = memo(function MiniProgress({\n  value,\n  max = 100,\n  showLabel = false,\n  size = 'medium', // 'small' | 'medium' | 'large'\n  variant = 'default', // 'default' | 'success' | 'warning' | 'danger'\n  animated = true\n}) {\n  const percentage = Math.min(100, Math.max(0, (value / max) * 100))\n  const height = size === 'small' ? '4px' : size === 'large' ? '8px' : '6px'\n\n  // Auto-determine variant based on percentage if not specified\n  const autoVariant = variant === 'default'\n    ? percentage >= 80 ? 'danger' : percentage >= 60 ? 'warning' : 'success'\n    : variant\n\n  return (\n    <div className={`mini-progress mini-progress-${size}`}>\n      <div className=\"mini-progress-track\" style={{ height }}>\n        <div\n          className={`mini-progress-fill mini-progress-${autoVariant} ${animated ? 'progress-animate' : ''}`}\n          style={{ width: `${percentage}%` }}\n        />\n      </div>\n      {showLabel && (\n        <span className=\"mini-progress-label\">{Math.round(percentage)}%</span>\n      )}\n    </div>\n  )\n})\n\n// Trend indicator with direction and value\nexport const TrendIndicator = memo(function TrendIndicator({\n  value,\n  previousValue,\n  format = 'percent', // 'percent' | 'number' | 'currency'\n  inverted = false, // If true, down is good (e.g., costs)\n  showValue = true\n}) {\n  const diff = value - previousValue\n  const percentChange = previousValue !== 0 ? ((diff / previousValue) * 100) : 0\n\n  let direction = diff === 0 ? 'neutral' : diff > 0 ? 'up' : 'down'\n  let status = 'neutral'\n\n  if (diff !== 0) {\n    if (inverted) {\n      status = diff > 0 ? 'negative' : 'positive'\n    } else {\n      status = diff > 0 ? 'positive' : 'negative'\n    }\n  }\n\n  const Icon = direction === 'up' ? TrendingUp : direction === 'down' ? TrendingDown : Minus\n\n  const formatValue = () => {\n    const absChange = Math.abs(diff)\n    switch (format) {\n      case 'percent':\n        return `${Math.abs(percentChange).toFixed(1)}%`\n      case 'currency':\n        return new Intl.NumberFormat('en-US', {\n          style: 'currency',\n          currency: 'USD',\n          minimumFractionDigits: 0,\n          maximumFractionDigits: 0\n        }).format(absChange)\n      default:\n        return absChange.toLocaleString()\n    }\n  }\n\n  return (\n    <span className={`trend-indicator trend-${status}`}>\n      <Icon size={14} />\n      {showValue && <span className=\"trend-value\">{formatValue()}</span>}\n    </span>\n  )\n})\n\n// Status dot with optional label\nexport const StatusDot = memo(function StatusDot({\n  status = 'default', // 'default' | 'success' | 'warning' | 'danger' | 'info'\n  label,\n  size = 'medium', // 'small' | 'medium' | 'large'\n  pulse = false\n}) {\n  return (\n    <span className={`status-dot-container status-dot-${size}`}>\n      <span className={`status-dot status-dot-${status} ${pulse ? 'status-dot-pulse' : ''}`} />\n      {label && <span className=\"status-dot-label\">{label}</span>}\n    </span>\n  )\n})\n\n// Sparkline - mini line chart\nexport const Sparkline = memo(function Sparkline({\n  data = [],\n  width = 80,\n  height = 24,\n  strokeWidth = 2,\n  color = 'var(--accent-blue)',\n  showArea = true\n}) {\n  if (!data.length) return null\n\n  const max = Math.max(...data)\n  const min = Math.min(...data)\n  const range = max - min || 1\n\n  const points = data.map((value, index) => {\n    const x = (index / (data.length - 1)) * width\n    const y = height - ((value - min) / range) * (height - strokeWidth * 2) - strokeWidth\n    return `${x},${y}`\n  }).join(' ')\n\n  const areaPoints = `0,${height} ${points} ${width},${height}`\n\n  return (\n    <svg\n      width={width}\n      height={height}\n      className=\"sparkline\"\n      viewBox={`0 0 ${width} ${height}`}\n    >\n      {showArea && (\n        <polygon\n          points={areaPoints}\n          fill={color}\n          fillOpacity=\"0.15\"\n        />\n      )}\n      <polyline\n        points={points}\n        fill=\"none\"\n        stroke={color}\n        strokeWidth={strokeWidth}\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n    </svg>\n  )\n})\n\n// Quick stats row (e.g., \"3 workers  2.5 hrs  $450\")\nexport const QuickStats = memo(function QuickStats({ items = [] }) {\n  return (\n    <div className=\"quick-stats\">\n      {items.map((item, index) => (\n        <span key={index} className=\"quick-stat-item\">\n          {item.icon && <item.icon size={12} />}\n          <span className=\"quick-stat-value\">{item.value}</span>\n          {item.label && <span className=\"quick-stat-label\">{item.label}</span>}\n        </span>\n      ))}\n    </div>\n  )\n})\n\n// Status indicator with icon\nexport const StatusIndicator = memo(function StatusIndicator({\n  status, // 'success' | 'warning' | 'danger' | 'info' | 'pending'\n  label,\n  size = 'medium'\n}) {\n  const icons = {\n    success: Check,\n    warning: AlertTriangle,\n    danger: AlertTriangle,\n    info: Clock,\n    pending: Clock\n  }\n\n  const Icon = icons[status] || icons.info\n\n  return (\n    <span className={`status-indicator status-indicator-${status} status-indicator-${size}`}>\n      <Icon size={size === 'small' ? 12 : size === 'large' ? 18 : 14} />\n      {label && <span className=\"status-indicator-label\">{label}</span>}\n    </span>\n  )\n})\n\n// Metric delta (change from previous)\nexport const MetricDelta = memo(function MetricDelta({\n  current,\n  previous,\n  format = 'number', // 'number' | 'currency' | 'percent'\n  label,\n  inverted = false\n}) {\n  const delta = current - previous\n  const isPositive = inverted ? delta < 0 : delta > 0\n  const isNegative = inverted ? delta > 0 : delta < 0\n\n  const formatValue = (val) => {\n    switch (format) {\n      case 'currency':\n        return new Intl.NumberFormat('en-US', {\n          style: 'currency',\n          currency: 'USD',\n          minimumFractionDigits: 0\n        }).format(Math.abs(val))\n      case 'percent':\n        return `${Math.abs(val).toFixed(1)}%`\n      default:\n        return Math.abs(val).toLocaleString()\n    }\n  }\n\n  return (\n    <div className={`metric-delta ${isPositive ? 'positive' : isNegative ? 'negative' : 'neutral'}`}>\n      <span className=\"metric-delta-arrow\">\n        {delta > 0 ? '' : delta < 0 ? '' : ''}\n      </span>\n      <span className=\"metric-delta-value\">{formatValue(delta)}</span>\n      {label && <span className=\"metric-delta-label\">{label}</span>}\n    </div>\n  )\n})\n\n// Circular progress (donut style)\nexport const CircularProgress = memo(function CircularProgress({\n  value,\n  max = 100,\n  size = 40,\n  strokeWidth = 4,\n  showValue = true,\n  color = 'var(--accent-blue)'\n}) {\n  const percentage = Math.min(100, Math.max(0, (value / max) * 100))\n  const radius = (size - strokeWidth) / 2\n  const circumference = radius * 2 * Math.PI\n  const offset = circumference - (percentage / 100) * circumference\n\n  return (\n    <div className=\"circular-progress\" style={{ width: size, height: size }}>\n      <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`}>\n        <circle\n          className=\"circular-progress-track\"\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          fill=\"none\"\n          strokeWidth={strokeWidth}\n        />\n        <circle\n          className=\"circular-progress-fill\"\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          fill=\"none\"\n          stroke={color}\n          strokeWidth={strokeWidth}\n          strokeDasharray={circumference}\n          strokeDashoffset={offset}\n          strokeLinecap=\"round\"\n          transform={`rotate(-90 ${size / 2} ${size / 2})`}\n          style={{ transition: 'stroke-dashoffset 0.5s ease' }}\n        />\n      </svg>\n      {showValue && (\n        <span className=\"circular-progress-value\">\n          {Math.round(percentage)}%\n        </span>\n      )}\n    </div>\n  )\n})\n\nexport default {\n  CountBadge,\n  MiniProgress,\n  TrendIndicator,\n  StatusDot,\n  Sparkline,\n  QuickStats,\n  StatusIndicator,\n  MetricDelta,\n  CircularProgress\n}\n","import { useEffect, useRef, useCallback, memo } from 'react'\nimport { X } from 'lucide-react'\n\n/**\n * Accessible Modal Component\n *\n * Features:\n * - Proper ARIA attributes (role=\"dialog\", aria-modal, aria-labelledby)\n * - Focus trap within modal\n * - Escape key to close\n * - Click outside to close\n * - Focus restoration on close\n *\n * Usage:\n *   <Modal\n *     isOpen={showModal}\n *     onClose={() => setShowModal(false)}\n *     title=\"Modal Title\"\n *     size=\"medium\"\n *   >\n *     <p>Modal content here</p>\n *   </Modal>\n */\nconst Modal = memo(function Modal({\n  isOpen,\n  onClose,\n  title,\n  children,\n  size = 'medium', // 'small' | 'medium' | 'large' | 'full'\n  className = '',\n  showCloseButton = true,\n  closeOnOverlayClick = true,\n  closeOnEscape = true,\n  footer,\n  ariaDescribedBy\n}) {\n  const modalRef = useRef(null)\n  const previousActiveElement = useRef(null)\n  const titleId = useRef(`modal-title-${Math.random().toString(36).substr(2, 9)}`)\n\n  // Store the previously focused element and focus the modal when it opens\n  useEffect(() => {\n    if (isOpen) {\n      previousActiveElement.current = document.activeElement\n      // Focus the modal container after a brief delay to ensure it's rendered\n      const timer = setTimeout(() => {\n        modalRef.current?.focus()\n      }, 10)\n      return () => clearTimeout(timer)\n    }\n  }, [isOpen])\n\n  // Restore focus when modal closes\n  useEffect(() => {\n    if (!isOpen && previousActiveElement.current) {\n      previousActiveElement.current.focus()\n    }\n  }, [isOpen])\n\n  // Handle escape key\n  useEffect(() => {\n    if (!isOpen || !closeOnEscape) return\n\n    const handleKeyDown = (e) => {\n      if (e.key === 'Escape') {\n        e.preventDefault()\n        onClose()\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyDown)\n    return () => document.removeEventListener('keydown', handleKeyDown)\n  }, [isOpen, closeOnEscape, onClose])\n\n  // Prevent body scroll when modal is open\n  useEffect(() => {\n    if (isOpen) {\n      const originalOverflow = document.body.style.overflow\n      document.body.style.overflow = 'hidden'\n      return () => {\n        document.body.style.overflow = originalOverflow\n      }\n    }\n  }, [isOpen])\n\n  // Focus trap\n  const handleKeyDown = useCallback((e) => {\n    if (e.key !== 'Tab') return\n\n    const focusableElements = modalRef.current?.querySelectorAll(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    )\n\n    if (!focusableElements || focusableElements.length === 0) return\n\n    const firstElement = focusableElements[0]\n    const lastElement = focusableElements[focusableElements.length - 1]\n\n    if (e.shiftKey) {\n      if (document.activeElement === firstElement) {\n        e.preventDefault()\n        lastElement.focus()\n      }\n    } else {\n      if (document.activeElement === lastElement) {\n        e.preventDefault()\n        firstElement.focus()\n      }\n    }\n  }, [])\n\n  const handleOverlayClick = (e) => {\n    if (closeOnOverlayClick && e.target === e.currentTarget) {\n      onClose()\n    }\n  }\n\n  if (!isOpen) return null\n\n  const sizeClasses = {\n    small: 'modal-small',\n    medium: 'modal-medium',\n    large: 'modal-large',\n    full: 'modal-full'\n  }\n\n  return (\n    <div\n      className=\"modal-overlay\"\n      onClick={handleOverlayClick}\n      role=\"presentation\"\n    >\n      <div\n        ref={modalRef}\n        className={`modal-content ${sizeClasses[size] || ''} ${className}`}\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby={title ? titleId.current : undefined}\n        aria-describedby={ariaDescribedBy}\n        tabIndex={-1}\n        onKeyDown={handleKeyDown}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {title && (\n          <div className=\"modal-header\">\n            <h2 id={titleId.current}>{title}</h2>\n            {showCloseButton && (\n              <button\n                className=\"close-btn\"\n                onClick={onClose}\n                aria-label=\"Close modal\"\n                type=\"button\"\n              >\n                <X size={20} />\n              </button>\n            )}\n          </div>\n        )}\n\n        <div className=\"modal-body\">\n          {children}\n        </div>\n\n        {footer && (\n          <div className=\"modal-footer\">\n            {footer}\n          </div>\n        )}\n      </div>\n    </div>\n  )\n})\n\nexport default Modal\n","import { memo, useState, useEffect, useMemo, useCallback } from 'react'\nimport { Users, HardHat, Wrench, Calendar, Download, ChevronLeft, ChevronRight } from 'lucide-react'\nimport {\n  BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer\n} from 'recharts'\nimport { db } from '../../lib/supabase'\nimport { chartColors, tooltipStyle, formatChartDate } from '../charts/chartConfig'\n\n/**\n * OverviewCrewMetrics - Crew on-site metrics for project overview\n * Shows total crew count, contract vs T&M worker breakdown by day\n * Includes a day-by-day stacked bar chart timeline\n */\n\nconst loadJsPDF = () => import('jspdf')\n\n// Colors for contract vs T&M\nconst CREW_COLORS = {\n  contract: chartColors.contract,  // Blue\n  tm: chartColors.costs,           // Amber\n  total: chartColors.labor         // Indigo\n}\n\nconst TIME_RANGES = [\n  { id: '7d', label: '7D', days: 7 },\n  { id: '14d', label: '14D', days: 14 },\n  { id: '30d', label: '30D', days: 30 },\n]\n\nexport const OverviewCrewMetrics = memo(function OverviewCrewMetrics({\n  project,\n  onShowToast\n}) {\n  const [crewHistory, setCrewHistory] = useState([])\n  const [tmTickets, setTmTickets] = useState([])\n  const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0])\n  const [timeRange, setTimeRange] = useState('14d')\n  const [loading, setLoading] = useState(true)\n  const [exporting, setExporting] = useState(false)\n\n  // Load all crew check-in history and T&M tickets\n  useEffect(() => {\n    if (!project?.id) return\n    loadData()\n  }, [project?.id])\n\n  const loadData = async () => {\n    setLoading(true)\n    try {\n      const [history, tickets] = await Promise.all([\n        db.getCrewCheckinHistory(project.id, 365),\n        db.getTMTickets(project.id)\n      ])\n      setCrewHistory(history || [])\n      setTmTickets(tickets || [])\n    } catch (error) {\n      console.error('Error loading crew metrics:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // Build a lookup: date -> Set of T&M worker names\n  const tmWorkersByDate = useMemo(() => {\n    const map = {}\n    tmTickets.forEach(ticket => {\n      const date = ticket.work_date\n      if (!date) return\n      if (!map[date]) map[date] = new Set()\n      ;(ticket.t_and_m_workers || []).forEach(w => {\n        map[date].add(w.name.toLowerCase().trim())\n      })\n    })\n    return map\n  }, [tmTickets])\n\n  // Build crew lookup: date -> workers array\n  const crewByDate = useMemo(() => {\n    const map = {}\n    crewHistory.forEach(checkin => {\n      map[checkin.check_in_date] = checkin.workers || []\n    })\n    return map\n  }, [crewHistory])\n\n  // Selected date metrics\n  const selectedDayWorkers = crewByDate[selectedDate] || []\n  const selectedDayTmNames = tmWorkersByDate[selectedDate] || new Set()\n\n  const todayMetrics = useMemo(() => {\n    const contract = []\n    const tm = []\n    selectedDayWorkers.forEach(w => {\n      if (selectedDayTmNames.has(w.name.toLowerCase().trim())) {\n        tm.push(w)\n      } else {\n        contract.push(w)\n      }\n    })\n    return { total: selectedDayWorkers.length, contract, tm }\n  }, [selectedDayWorkers, selectedDayTmNames])\n\n  // Build chart data for time range\n  const chartData = useMemo(() => {\n    const rangeDays = TIME_RANGES.find(r => r.id === timeRange)?.days || 14\n    const data = []\n    const today = new Date()\n\n    for (let i = rangeDays - 1; i >= 0; i--) {\n      const d = new Date(today)\n      d.setDate(d.getDate() - i)\n      const dateStr = d.toISOString().split('T')[0]\n\n      const workers = crewByDate[dateStr] || []\n      const tmNames = tmWorkersByDate[dateStr] || new Set()\n\n      let contractCount = 0\n      let tmCount = 0\n      workers.forEach(w => {\n        if (tmNames.has(w.name.toLowerCase().trim())) {\n          tmCount++\n        } else {\n          contractCount++\n        }\n      })\n\n      data.push({\n        date: dateStr,\n        displayDate: formatChartDate(dateStr),\n        contract: contractCount,\n        tm: tmCount,\n        total: workers.length\n      })\n    }\n\n    return data\n  }, [crewByDate, tmWorkersByDate, timeRange])\n\n  // Navigate dates\n  const changeDate = useCallback((direction) => {\n    const d = new Date(selectedDate + 'T12:00:00')\n    d.setDate(d.getDate() + direction)\n    setSelectedDate(d.toISOString().split('T')[0])\n  }, [selectedDate])\n\n  const isToday = selectedDate === new Date().toISOString().split('T')[0]\n\n  const formatDate = (dateStr) => {\n    const d = new Date(dateStr + 'T12:00:00')\n    return d.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })\n  }\n\n  // Click a bar in the chart to select that date\n  const handleBarClick = useCallback((data) => {\n    if (data?.date) {\n      setSelectedDate(data.date)\n    }\n  }, [])\n\n  // Custom tooltip for the chart\n  const CustomTooltip = ({ active, payload, label }) => {\n    if (!active || !payload?.length) return null\n    const total = (payload[0]?.value || 0) + (payload[1]?.value || 0)\n    return (\n      <div style={{\n        ...tooltipStyle.contentStyle,\n        fontSize: '0.8rem'\n      }}>\n        <p style={{ ...tooltipStyle.labelStyle, fontSize: '0.85rem', marginBottom: 6 }}>{label}</p>\n        <p style={{ margin: '3px 0', color: CREW_COLORS.contract }}>\n          Contract: <strong>{payload[0]?.value || 0}</strong>\n        </p>\n        <p style={{ margin: '3px 0', color: CREW_COLORS.tm }}>\n          T&M: <strong>{payload[1]?.value || 0}</strong>\n        </p>\n        <p style={{ margin: '3px 0', color: 'var(--text-primary)', borderTop: '1px solid var(--border-color)', paddingTop: 4 }}>\n          Total: <strong>{total}</strong>\n        </p>\n      </div>\n    )\n  }\n\n  // PDF Export\n  const exportCrewPDF = useCallback(async () => {\n    setExporting(true)\n    onShowToast?.('Generating crew report PDF...', 'info')\n\n    try {\n      const jsPDFModule = await loadJsPDF()\n      const jsPDF = jsPDFModule.default\n      const doc = new jsPDF()\n\n      const pageWidth = doc.internal.pageSize.width\n      let y = 20\n\n      // Header\n      doc.setFontSize(18)\n      doc.setFont(undefined, 'bold')\n      doc.text('Crew On-Site Report', pageWidth / 2, y, { align: 'center' })\n      y += 8\n\n      doc.setFontSize(11)\n      doc.setFont(undefined, 'normal')\n      doc.text(`Project: ${project.name}`, pageWidth / 2, y, { align: 'center' })\n      y += 6\n      doc.text(`Date: ${formatDate(selectedDate)}`, pageWidth / 2, y, { align: 'center' })\n      y += 12\n\n      // Summary stats\n      doc.setFontSize(12)\n      doc.setFont(undefined, 'bold')\n      doc.text('Selected Day Summary', 14, y)\n      y += 7\n\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'normal')\n      doc.text(`Total Crew On-Site: ${todayMetrics.total}`, 14, y); y += 5\n      doc.text(`Contract Workers: ${todayMetrics.contract.length}`, 14, y); y += 5\n      doc.text(`T&M Workers: ${todayMetrics.tm.length}`, 14, y); y += 10\n\n      // Contract Workers\n      if (todayMetrics.contract.length > 0) {\n        doc.setFontSize(12)\n        doc.setFont(undefined, 'bold')\n        doc.text('Contract Workers', 14, y); y += 7\n\n        doc.setFontSize(9)\n        doc.setFont(undefined, 'bold')\n        doc.text('Name', 14, y)\n        doc.text('Role', 100, y); y += 5\n\n        doc.setFont(undefined, 'normal')\n        todayMetrics.contract.forEach(w => {\n          if (y > 270) { doc.addPage(); y = 20 }\n          doc.text(w.name, 14, y)\n          doc.text(w.role || '', 100, y); y += 5\n        })\n        y += 8\n      }\n\n      // T&M Workers\n      if (todayMetrics.tm.length > 0) {\n        if (y > 240) { doc.addPage(); y = 20 }\n        doc.setFontSize(12)\n        doc.setFont(undefined, 'bold')\n        doc.text('T&M Workers (Extra Work)', 14, y); y += 7\n\n        doc.setFontSize(9)\n        doc.setFont(undefined, 'bold')\n        doc.text('Name', 14, y)\n        doc.text('Role', 100, y); y += 5\n\n        doc.setFont(undefined, 'normal')\n        todayMetrics.tm.forEach(w => {\n          if (y > 270) { doc.addPage(); y = 20 }\n          doc.text(w.name, 14, y)\n          doc.text(w.role || '', 100, y); y += 5\n        })\n        y += 8\n      }\n\n      // Timeline table\n      if (y > 200) { doc.addPage(); y = 20 }\n      doc.setFontSize(12)\n      doc.setFont(undefined, 'bold')\n      doc.text('Daily Timeline', 14, y); y += 7\n\n      doc.setFontSize(8)\n      doc.setFont(undefined, 'bold')\n      doc.text('Date', 14, y)\n      doc.text('Total', 70, y)\n      doc.text('Contract', 95, y)\n      doc.text('T&M', 125, y); y += 5\n\n      doc.setFont(undefined, 'normal')\n      chartData.forEach(day => {\n        if (y > 275) { doc.addPage(); y = 20 }\n        doc.text(day.displayDate, 14, y)\n        doc.text(String(day.total), 70, y)\n        doc.text(String(day.contract), 95, y)\n        doc.text(String(day.tm), 125, y)\n        y += 4.5\n      })\n\n      // Footer\n      const footerY = doc.internal.pageSize.height - 10\n      doc.setFontSize(8)\n      doc.setTextColor(128, 128, 128)\n      doc.text(`Generated ${new Date().toLocaleString()}  FieldSync`, pageWidth / 2, footerY, { align: 'center' })\n\n      const fileName = `${project.name}_Crew_Report_${selectedDate}.pdf`\n      doc.save(fileName)\n      onShowToast?.('PDF exported!', 'success')\n    } catch (error) {\n      console.error('Error exporting crew PDF:', error)\n      onShowToast?.('Error generating PDF', 'error')\n    } finally {\n      setExporting(false)\n    }\n  }, [project, selectedDate, todayMetrics, chartData, onShowToast])\n\n  if (loading) {\n    return (\n      <div className=\"crew-metrics-card animate-fade-in-up\">\n        <div className=\"crew-metrics-header\">\n          <h3><Users size={18} /> Crew On-Site</h3>\n        </div>\n        <div className=\"crew-metrics-loading\">\n          <div className=\"skeleton-stat\"></div>\n          <div className=\"skeleton-stat\"></div>\n          <div className=\"skeleton-stat\"></div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"crew-metrics-card animate-fade-in-up\">\n      {/* Header with export */}\n      <div className=\"crew-metrics-header\">\n        <h3><Users size={18} /> Crew On-Site</h3>\n        <div className=\"crew-metrics-actions\">\n          <button\n            className=\"btn btn-secondary btn-small\"\n            onClick={exportCrewPDF}\n            disabled={exporting}\n            title=\"Export crew report as PDF\"\n          >\n            <Download size={14} /> {exporting ? 'Exporting...' : 'PDF'}\n          </button>\n        </div>\n      </div>\n\n      {/* Date navigator */}\n      <div className=\"crew-date-nav\">\n        <button className=\"crew-date-btn\" onClick={() => changeDate(-1)}>\n          <ChevronLeft size={16} />\n        </button>\n        <span className=\"crew-date-label\">\n          <Calendar size={14} />\n          {isToday ? 'Today' : formatDate(selectedDate)}\n        </span>\n        <button className=\"crew-date-btn\" onClick={() => changeDate(1)} disabled={isToday}>\n          <ChevronRight size={16} />\n        </button>\n      </div>\n\n      {/* Stats row for selected day */}\n      <div className=\"crew-stats-row\">\n        <div className=\"crew-stat total\">\n          <div className=\"crew-stat-icon\"><Users size={20} /></div>\n          <div className=\"crew-stat-content\">\n            <span className=\"crew-stat-value\">{todayMetrics.total}</span>\n            <span className=\"crew-stat-label\">Total On-Site</span>\n          </div>\n        </div>\n\n        <div className=\"crew-stat contract\">\n          <div className=\"crew-stat-icon\"><HardHat size={20} /></div>\n          <div className=\"crew-stat-content\">\n            <span className=\"crew-stat-value\">{todayMetrics.contract.length}</span>\n            <span className=\"crew-stat-label\">Contract</span>\n          </div>\n        </div>\n\n        <div className=\"crew-stat tm\">\n          <div className=\"crew-stat-icon\"><Wrench size={20} /></div>\n          <div className=\"crew-stat-content\">\n            <span className=\"crew-stat-value\">{todayMetrics.tm.length}</span>\n            <span className=\"crew-stat-label\">T&M</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Breakdown bar for selected day */}\n      {todayMetrics.total > 0 && (\n        <div className=\"crew-breakdown-bar\">\n          <div\n            className=\"crew-bar-segment contract\"\n            style={{ width: `${(todayMetrics.contract.length / todayMetrics.total) * 100}%` }}\n            title={`${todayMetrics.contract.length} Contract`}\n          />\n          <div\n            className=\"crew-bar-segment tm\"\n            style={{ width: `${(todayMetrics.tm.length / todayMetrics.total) * 100}%` }}\n            title={`${todayMetrics.tm.length} T&M`}\n          />\n        </div>\n      )}\n\n      {/* Worker name lists */}\n      {todayMetrics.total > 0 && (\n        <div className=\"crew-name-lists\">\n          {todayMetrics.contract.length > 0 && (\n            <div className=\"crew-name-group\">\n              <div className=\"crew-name-group-header contract\">\n                <HardHat size={13} />\n                <span>Contract ({todayMetrics.contract.length})</span>\n              </div>\n              <div className=\"crew-name-tags\">\n                {todayMetrics.contract.map((w, i) => (\n                  <span key={i} className=\"crew-name-tag contract\">\n                    {w.name}\n                    {w.role && w.role !== 'Laborer' && (\n                      <span className=\"crew-name-role\">{w.role}</span>\n                    )}\n                  </span>\n                ))}\n              </div>\n            </div>\n          )}\n          {todayMetrics.tm.length > 0 && (\n            <div className=\"crew-name-group\">\n              <div className=\"crew-name-group-header tm\">\n                <Wrench size={13} />\n                <span>T&M ({todayMetrics.tm.length})</span>\n              </div>\n              <div className=\"crew-name-tags\">\n                {todayMetrics.tm.map((w, i) => (\n                  <span key={i} className=\"crew-name-tag tm\">\n                    {w.name}\n                    {w.role && w.role !== 'Laborer' && (\n                      <span className=\"crew-name-role\">{w.role}</span>\n                    )}\n                  </span>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Day-by-day timeline chart */}\n      <div className=\"crew-timeline-section\">\n        <div className=\"crew-timeline-header\">\n          <span className=\"crew-timeline-title\">Daily Breakdown</span>\n          <div className=\"crew-time-range-pills\">\n            {TIME_RANGES.map(range => (\n              <button\n                key={range.id}\n                className={`crew-range-pill ${timeRange === range.id ? 'active' : ''}`}\n                onClick={() => setTimeRange(range.id)}\n              >\n                {range.label}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"crew-chart-container\">\n          <ResponsiveContainer width=\"100%\" height={140}>\n            <BarChart\n              data={chartData}\n              onClick={(e) => e?.activePayload?.[0] && handleBarClick(e.activePayload[0].payload)}\n              style={{ cursor: 'pointer' }}\n            >\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"var(--border-color)\" vertical={false} />\n              <XAxis\n                dataKey=\"displayDate\"\n                tick={{ fontSize: 10, fill: 'var(--text-muted)' }}\n                axisLine={{ stroke: 'var(--border-color)' }}\n                tickLine={false}\n                interval={timeRange === '30d' ? 4 : timeRange === '14d' ? 1 : 0}\n              />\n              <YAxis\n                tick={{ fontSize: 10, fill: 'var(--text-muted)' }}\n                axisLine={false}\n                tickLine={false}\n                allowDecimals={false}\n                width={30}\n              />\n              <Tooltip content={<CustomTooltip />} />\n              <Legend\n                wrapperStyle={{ fontSize: '0.75rem', paddingTop: 4 }}\n                iconType=\"circle\"\n                iconSize={8}\n              />\n              <Bar\n                dataKey=\"contract\"\n                name=\"Contract\"\n                stackId=\"crew\"\n                fill={CREW_COLORS.contract}\n                radius={[0, 0, 0, 0]}\n              />\n              <Bar\n                dataKey=\"tm\"\n                name=\"T&M (Extra Work)\"\n                stackId=\"crew\"\n                fill={CREW_COLORS.tm}\n                radius={[3, 3, 0, 0]}\n              />\n            </BarChart>\n          </ResponsiveContainer>\n        </div>\n      </div>\n\n      {/* Empty state */}\n      {todayMetrics.total === 0 && (\n        <div className=\"crew-empty\">\n          <p>No crew checked in for this date</p>\n        </div>\n      )}\n    </div>\n  )\n})\n\nexport default OverviewCrewMetrics\n","import { memo, useMemo } from 'react'\nimport { DollarSign, TrendingUp, Receipt, PiggyBank } from 'lucide-react'\nimport { HeroMetricsSkeleton, MiniProgress, TrendIndicator } from './ui'\n\n/**\n * HeroMetrics - Top-level financial summary for project dashboard\n * Designed for instant comprehension of project financial health\n */\n\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0\n  }).format(amount || 0)\n}\n\nconst MetricCard = memo(function MetricCard({\n  icon: Icon,\n  label,\n  value,\n  formattedValue,\n  subLabel,\n  progress,\n  progressLabel,\n  variant = 'default', // 'default' | 'success' | 'warning' | 'danger'\n  trend,\n  previousValue\n}) {\n  const variantColors = {\n    default: 'var(--accent-blue)',\n    success: 'var(--accent-green)',\n    warning: 'var(--accent-amber)',\n    danger: 'var(--accent-red)'\n  }\n\n  return (\n    <div className={`hero-metric-card hover-lift animate-fade-in-up`}>\n      <div className=\"hero-metric-header\">\n        <div className=\"hero-metric-icon\" style={{ color: variantColors[variant] }}>\n          <Icon size={18} />\n        </div>\n        <span className=\"hero-metric-label\">{label}</span>\n      </div>\n\n      <div className=\"hero-metric-value-row\">\n        <span className={`hero-metric-value hero-metric-${variant}`}>\n          {formattedValue}\n        </span>\n        {trend !== undefined && previousValue !== undefined && (\n          <TrendIndicator\n            value={value}\n            previousValue={previousValue}\n            format=\"currency\"\n            inverted={label.toLowerCase().includes('cost')}\n          />\n        )}\n      </div>\n\n      {subLabel && (\n        <span className=\"hero-metric-sublabel\">{subLabel}</span>\n      )}\n\n      {progress !== undefined && (\n        <div className=\"hero-metric-progress\">\n          <MiniProgress\n            value={progress}\n            max={100}\n            size=\"small\"\n            variant={variant}\n            showLabel\n          />\n          {progressLabel && (\n            <span className=\"hero-metric-progress-label\">{progressLabel}</span>\n          )}\n        </div>\n      )}\n    </div>\n  )\n})\n\nexport default memo(function HeroMetrics({\n  contractValue = 0,\n  earnedRevenue = 0,\n  totalCosts = 0,\n  profit = 0,\n  progress = 0,\n  corApprovedValue = 0,\n  loading = false,\n  previousData // Optional: for trend indicators\n}) {\n  // Calculate derived values\n  const revisedContract = contractValue + corApprovedValue\n  const profitMargin = earnedRevenue > 0 ? ((profit / earnedRevenue) * 100) : 0\n  const costRatio = earnedRevenue > 0 ? ((totalCosts / earnedRevenue) * 100) : 0\n  const revenueProgress = revisedContract > 0 ? ((earnedRevenue / revisedContract) * 100) : 0\n  const costProgress = revisedContract > 0 ? ((totalCosts / revisedContract) * 100) : 0\n\n  // Determine profit status\n  const profitVariant = useMemo(() => {\n    if (profitMargin >= 20) return 'success'\n    if (profitMargin >= 10) return 'warning'\n    if (profitMargin < 0) return 'danger'\n    return 'default'\n  }, [profitMargin])\n\n  // Determine cost status\n  const costVariant = useMemo(() => {\n    if (costRatio <= 60) return 'success'\n    if (costRatio <= 80) return 'warning'\n    return 'danger'\n  }, [costRatio])\n\n  if (loading) {\n    return <HeroMetricsSkeleton />\n  }\n\n  return (\n    <div className=\"hero-metrics stagger-children\">\n      {/* Contract Value */}\n      <MetricCard\n        icon={DollarSign}\n        label=\"Contract Value\"\n        value={revisedContract}\n        formattedValue={formatCurrency(revisedContract)}\n        subLabel={corApprovedValue > 0 ? `+${formatCurrency(corApprovedValue)} CORs` : null}\n        variant=\"default\"\n      />\n\n      {/* Earned Revenue */}\n      <MetricCard\n        icon={TrendingUp}\n        label=\"Earned Revenue\"\n        value={earnedRevenue}\n        formattedValue={formatCurrency(earnedRevenue)}\n        progress={revenueProgress}\n        progressLabel={`${Math.round(revenueProgress)}% of contract`}\n        variant=\"success\"\n        previousValue={previousData?.earnedRevenue}\n        trend={previousData ? earnedRevenue : undefined}\n      />\n\n      {/* Total Costs */}\n      <MetricCard\n        icon={Receipt}\n        label=\"Total Costs\"\n        value={totalCosts}\n        formattedValue={formatCurrency(totalCosts)}\n        progress={costProgress}\n        progressLabel={`${Math.round(costRatio)}% of revenue`}\n        variant={costVariant}\n        previousValue={previousData?.totalCosts}\n        trend={previousData ? totalCosts : undefined}\n      />\n\n      {/* Profit */}\n      <MetricCard\n        icon={PiggyBank}\n        label=\"Profit\"\n        value={profit}\n        formattedValue={formatCurrency(profit)}\n        subLabel={`${profitMargin >= 0 ? '+' : ''}${profitMargin.toFixed(1)}% margin`}\n        variant={profitVariant}\n        previousValue={previousData?.profit}\n        trend={previousData ? profit : undefined}\n      />\n    </div>\n  )\n})\n","import { memo } from 'react'\nimport { BarChart3, FileText, ClipboardList, Receipt, ChevronRight, ChevronLeft, PanelLeftOpen, X } from 'lucide-react'\nimport { CountBadge } from './ui'\n\n/**\n * FinancialsNav - Collapsible sidebar navigation for Financials tab\n *\n * Design principles:\n * - Workflow order: Overview  CORs  T&M (reflects natural process)\n * - Collapsible to maximize content real estate\n * - Clear visual hierarchy with active states\n * - Badges show pending items requiring attention\n */\n\nconst NAV_ITEMS = [\n  {\n    id: 'overview',\n    label: 'Overview',\n    shortLabel: 'Overview',\n    icon: BarChart3,\n    description: 'Metrics & trends',\n    step: null\n  },\n  {\n    id: 'cors',\n    label: 'Change Orders',\n    shortLabel: 'CORs',\n    icon: FileText,\n    description: 'CORs & approvals',\n    step: 1\n  },\n  {\n    id: 'tickets',\n    label: 'T&M Tickets',\n    shortLabel: 'Tickets',\n    icon: ClipboardList,\n    description: 'Field data',\n    step: 2\n  },\n  {\n    id: 'billing',\n    label: 'Billing',\n    shortLabel: 'Billing',\n    icon: Receipt,\n    description: 'Invoices & billing',\n    step: 3\n  }\n]\n\nexport default memo(function FinancialsNav({\n  activeSection = 'overview',\n  onSectionChange,\n  collapsed = false,\n  onToggleCollapse,\n  onMobileClose,\n  stats = {}\n}) {\n  const {\n    corCount = 0,\n    ticketCount = 0,\n    corPending = 0,\n    ticketPending = 0,\n    billableCount = 0,\n    invoiceCount = 0\n  } = stats\n\n  // Get badge config for each section\n  const getBadge = (itemId) => {\n    if (itemId === 'cors' && corCount > 0) {\n      return {\n        count: corCount,\n        variant: corPending > 0 ? 'warning' : 'default',\n        pending: corPending\n      }\n    }\n    if (itemId === 'tickets' && ticketCount > 0) {\n      return {\n        count: ticketCount,\n        variant: ticketPending > 0 ? 'warning' : 'default',\n        pending: ticketPending\n      }\n    }\n    if (itemId === 'billing' && billableCount > 0) {\n      return {\n        count: billableCount,\n        variant: 'success', // Green to indicate money ready to collect\n        pending: billableCount\n      }\n    }\n    return null\n  }\n\n  return (\n    <nav\n      className={`financials-nav ${collapsed ? 'collapsed' : ''}`}\n      aria-label=\"Financials sections\"\n    >\n      {/* Mobile Header with Close Button */}\n      {onMobileClose && (\n        <div className=\"financials-nav-mobile-header\">\n          <span className=\"financials-nav-mobile-title\">Financials</span>\n          <button\n            className=\"financials-nav-mobile-close\"\n            onClick={onMobileClose}\n            aria-label=\"Close menu\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n      )}\n\n      {/* Collapse Toggle - hidden on mobile */}\n      <button\n        className=\"financials-nav-toggle\"\n        onClick={onToggleCollapse}\n        aria-label={collapsed ? 'Expand sidebar' : 'Collapse sidebar'}\n        title={collapsed ? 'Expand sidebar' : 'Collapse sidebar'}\n      >\n        {collapsed ? (\n          <PanelLeftOpen size={18} />\n        ) : (\n          <ChevronLeft size={18} />\n        )}\n        {!collapsed && <span>Collapse</span>}\n      </button>\n\n      {/* Navigation Items */}\n      <div className=\"financials-nav-items\">\n        {NAV_ITEMS.map((item, index) => {\n          const isActive = activeSection === item.id\n          const Icon = item.icon\n          const badge = getBadge(item.id)\n          const showConnector = index < NAV_ITEMS.length - 1 && item.step !== null\n\n          return (\n            <div key={item.id} className=\"financials-nav-item-wrapper\">\n              <button\n                className={`financials-nav-item ${isActive ? 'active' : ''}`}\n                onClick={() => onSectionChange?.(item.id)}\n                aria-current={isActive ? 'page' : undefined}\n                title={`${item.label}${badge ? ` (${badge.count})` : ''}`}\n              >\n                {/* Step indicator for workflow items - only in expanded mode */}\n                {item.step && !collapsed && (\n                  <span className=\"financials-nav-step\">{item.step}</span>\n                )}\n\n                {/* Icon with optional badge dot */}\n                <div className=\"financials-nav-icon\">\n                  <Icon size={collapsed ? 22 : 20} />\n                  {/* Badge dot for pending items */}\n                  {badge && badge.pending > 0 && (\n                    <span className=\"financials-nav-dot\" />\n                  )}\n                </div>\n\n                {/* Collapsed mode: show short label below icon */}\n                {collapsed && (\n                  <span className=\"financials-nav-short-label\">{item.shortLabel}</span>\n                )}\n\n                {/* Expanded mode: show full content */}\n                {!collapsed && (\n                  <>\n                    <div className=\"financials-nav-content\">\n                      <span className=\"financials-nav-label\">{item.label}</span>\n                      <span className=\"financials-nav-desc\">{item.description}</span>\n                    </div>\n\n                    {/* Badge */}\n                    {badge && (\n                      <CountBadge\n                        count={badge.count}\n                        size=\"small\"\n                        variant={badge.variant}\n                      />\n                    )}\n\n                    {/* Arrow */}\n                    <ChevronRight size={16} className=\"financials-nav-arrow\" />\n                  </>\n                )}\n              </button>\n\n              {/* Workflow connector line */}\n              {showConnector && !collapsed && (\n                <div className=\"financials-nav-connector\">\n                  <div className=\"connector-line\" />\n                </div>\n              )}\n            </div>\n          )\n        })}\n      </div>\n\n      {/* Toggle label when collapsed */}\n      {collapsed && (\n        <button\n          className=\"financials-nav-expand-btn\"\n          onClick={onToggleCollapse}\n          aria-label=\"Expand sidebar\"\n        >\n          <ChevronRight size={14} />\n          <span>Expand</span>\n        </button>\n      )}\n    </nav>\n  )\n})\n","import { useState, useEffect, useCallback, useMemo, memo } from 'react'\nimport { Truck, Plus, Calendar, DollarSign, RotateCcw, ChevronDown, ChevronUp, Edit2, Trash2 } from 'lucide-react'\nimport { equipmentOps } from '../../lib/supabase'\nimport { formatCurrency } from '../../lib/corCalculations'\n\n// Helper function - defined outside component to avoid recreation\nconst formatDate = (dateStr) => {\n  if (!dateStr) return ''\n  return new Date(dateStr).toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric'\n  })\n}\n\n/**\n * ProjectEquipmentCard - Equipment tracking card for Financials Overview\n *\n * Shows equipment currently on site with daily rates and costs.\n * Allows adding new equipment and marking equipment as returned.\n */\nexport default memo(function ProjectEquipmentCard({\n  project,\n  onAddEquipment,\n  onEditEquipment,\n  onShowToast\n}) {\n  const [projectEquipment, setProjectEquipment] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [expanded, setExpanded] = useState(true)\n  const [totalCost, setTotalCost] = useState(0)\n\n  // Memoized load function to avoid stale closures\n  const loadEquipment = useCallback(async () => {\n    if (!project?.id) return\n\n    try {\n      setLoading(true)\n      const data = await equipmentOps.getProjectEquipment(project.id)\n      setProjectEquipment(data || [])\n\n      // Calculate total cost\n      const cost = equipmentOps.calculateProjectEquipmentCost(data || [])\n      setTotalCost(cost)\n    } catch (error) {\n      console.error('Error loading equipment:', error)\n      onShowToast?.('Failed to load equipment', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }, [project?.id]) // onShowToast is stable (memoized in App.jsx)\n\n  // Load project equipment when project changes\n  useEffect(() => {\n    loadEquipment()\n  }, [loadEquipment])\n\n  const handleMarkReturned = useCallback(async (equipmentItem) => {\n    try {\n      await equipmentOps.markEquipmentReturned(equipmentItem.id)\n      onShowToast?.(`${equipmentItem.equipment_name} marked as returned`, 'success')\n      loadEquipment()\n    } catch (error) {\n      console.error('Error marking equipment returned:', error)\n      onShowToast?.('Failed to update equipment', 'error')\n    }\n  }, [loadEquipment]) // onShowToast is stable\n\n  const handleDelete = useCallback(async (equipmentItem) => {\n    if (!confirm(`Remove ${equipmentItem.equipment_name} from this project?`)) {\n      return\n    }\n\n    try {\n      await equipmentOps.removeEquipmentFromProject(equipmentItem.id)\n      onShowToast?.('Equipment removed', 'success')\n      loadEquipment()\n    } catch (error) {\n      console.error('Error removing equipment:', error)\n      onShowToast?.('Failed to remove equipment', 'error')\n    }\n  }, [loadEquipment]) // onShowToast is stable\n\n  // Memoize derived state to avoid recalculating on every render\n  const activeEquipment = useMemo(\n    () => projectEquipment.filter(e => !e.end_date),\n    [projectEquipment]\n  )\n\n  const returnedEquipment = useMemo(\n    () => projectEquipment.filter(e => e.end_date),\n    [projectEquipment]\n  )\n\n  return (\n    <div className=\"project-equipment-card\">\n      <div className=\"project-equipment-header\">\n        <div className=\"project-equipment-title\">\n          <Truck size={18} />\n          <h3>Equipment on Site</h3>\n          {projectEquipment.length > 0 && (\n            <span className=\"equipment-count\">{activeEquipment.length} active</span>\n          )}\n        </div>\n        <div className=\"project-equipment-actions\">\n          <button\n            className=\"btn btn-sm btn-primary\"\n            onClick={() => onAddEquipment?.()}\n            title=\"Add equipment\"\n          >\n            <Plus size={14} />\n            <span>Add</span>\n          </button>\n          {projectEquipment.length > 0 && (\n            <button\n              className=\"btn btn-sm btn-ghost\"\n              onClick={() => setExpanded(!expanded)}\n            >\n              {expanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n            </button>\n          )}\n        </div>\n      </div>\n\n      {loading ? (\n        <div className=\"equipment-loading\">\n          <div className=\"loading-spinner small\" />\n        </div>\n      ) : projectEquipment.length === 0 ? (\n        <div className=\"equipment-empty\">\n          <p>No equipment tracked on this project</p>\n          <button\n            className=\"btn btn-sm btn-outline\"\n            onClick={() => onAddEquipment?.()}\n          >\n            <Plus size={14} />\n            Track Equipment\n          </button>\n        </div>\n      ) : expanded ? (\n        <>\n          {/* Active Equipment */}\n          {activeEquipment.length > 0 && (\n            <div className=\"equipment-list\">\n              {activeEquipment.map(item => {\n                const days = equipmentOps.calculateDaysOnSite(item.start_date, item.end_date)\n                const cost = item.daily_rate * days\n\n                return (\n                  <div key={item.id} className=\"equipment-item active\">\n                    <div className=\"equipment-item-main\">\n                      <div className=\"equipment-item-info\">\n                        <span className=\"equipment-name\">{item.equipment_name}</span>\n                        <span className=\"equipment-meta\">\n                          <Calendar size={12} />\n                          On-site since {formatDate(item.start_date)}\n                        </span>\n                      </div>\n                      <div className=\"equipment-item-cost\">\n                        <span className=\"equipment-rate\">\n                          {formatCurrency(item.daily_rate)}/day\n                        </span>\n                        <span className=\"equipment-days\">{days} days</span>\n                        <span className=\"equipment-total\">{formatCurrency(cost)}</span>\n                      </div>\n                    </div>\n                    <div className=\"equipment-item-actions\">\n                      <button\n                        className=\"btn btn-xs btn-outline\"\n                        onClick={() => handleMarkReturned(item)}\n                        title=\"Mark as returned\"\n                      >\n                        <RotateCcw size={12} />\n                        Returned\n                      </button>\n                      <button\n                        className=\"btn btn-xs btn-ghost\"\n                        onClick={() => onEditEquipment?.(item)}\n                        title=\"Edit\"\n                      >\n                        <Edit2 size={12} />\n                      </button>\n                      <button\n                        className=\"btn btn-xs btn-ghost text-danger\"\n                        onClick={() => handleDelete(item)}\n                        title=\"Remove\"\n                      >\n                        <Trash2 size={12} />\n                      </button>\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          )}\n\n          {/* Returned Equipment (collapsed by default) */}\n          {returnedEquipment.length > 0 && (\n            <details className=\"equipment-returned-section\">\n              <summary className=\"equipment-returned-toggle\">\n                <span>Returned Equipment ({returnedEquipment.length})</span>\n              </summary>\n              <div className=\"equipment-list returned\">\n                {returnedEquipment.map(item => {\n                  const days = equipmentOps.calculateDaysOnSite(item.start_date, item.end_date)\n                  const cost = item.daily_rate * days\n\n                  return (\n                    <div key={item.id} className=\"equipment-item returned\">\n                      <div className=\"equipment-item-main\">\n                        <div className=\"equipment-item-info\">\n                          <span className=\"equipment-name\">{item.equipment_name}</span>\n                          <span className=\"equipment-meta\">\n                            {formatDate(item.start_date)} - {formatDate(item.end_date)}\n                          </span>\n                        </div>\n                        <div className=\"equipment-item-cost\">\n                          <span className=\"equipment-days\">{days} days</span>\n                          <span className=\"equipment-total\">{formatCurrency(cost)}</span>\n                        </div>\n                      </div>\n                    </div>\n                  )\n                })}\n              </div>\n            </details>\n          )}\n\n          {/* Total */}\n          <div className=\"equipment-total-row\">\n            <span>Total Equipment Cost</span>\n            <span className=\"equipment-grand-total\">{formatCurrency(totalCost)}</span>\n          </div>\n        </>\n      ) : (\n        <div className=\"equipment-summary-collapsed\">\n          <span>{activeEquipment.length} active, {returnedEquipment.length} returned</span>\n          <span className=\"equipment-grand-total\">{formatCurrency(totalCost)}</span>\n        </div>\n      )}\n    </div>\n  )\n})\n","import { useState, useEffect, useCallback, useMemo, memo } from 'react'\nimport { FileSpreadsheet, Plus, ChevronRight, Clock, CheckCircle2, DollarSign, TrendingUp } from 'lucide-react'\nimport { drawRequestOps } from '../../lib/supabase'\nimport { formatCurrency } from '../../lib/corCalculations'\n\n/**\n * ProgressBillingCard - Summary card for progress billing / draw requests\n *\n * Shows:\n * - Contract summary (original + COs = revised)\n * - Billing progress (billed to date, retention held)\n * - Quick action to create new draw request\n * - Recent draw requests\n */\nexport default memo(function ProgressBillingCard({\n  project,\n  areas = [],\n  corStats = {},\n  onCreateDraw,\n  onViewDraw,\n  onShowToast\n}) {\n  const [drawRequests, setDrawRequests] = useState([])\n  const [loading, setLoading] = useState(true)\n\n  // Calculate contract values\n  const originalContract = useMemo(() => {\n    return areas.reduce((sum, area) => {\n      const value = (area.square_footage || 0) * (area.price_per_sqft || 0)\n      return sum + Math.round(value * 100) // Convert to cents\n    }, 0)\n  }, [areas])\n\n  const approvedCOs = useMemo(() => {\n    return (corStats?.approvedTotal || 0)\n  }, [corStats?.approvedTotal])\n\n  const revisedContract = originalContract + approvedCOs\n\n  // Load draw requests\n  const loadDrawRequests = useCallback(async () => {\n    if (!project?.id) return\n\n    try {\n      setLoading(true)\n      const data = await drawRequestOps.getProjectDrawRequests(project.id)\n      setDrawRequests(data || [])\n    } catch (error) {\n      console.error('Error loading draw requests:', error)\n    } finally {\n      setLoading(false)\n    }\n  }, [project?.id])\n\n  useEffect(() => {\n    loadDrawRequests()\n  }, [loadDrawRequests])\n\n  // Calculate billing totals from draw requests\n  const billingTotals = useMemo(() => {\n    const completedDraws = drawRequests.filter(dr =>\n      ['submitted', 'approved', 'paid'].includes(dr.status)\n    )\n\n    const billedToDate = completedDraws.reduce((sum, dr) =>\n      sum + (dr.previous_billings || 0) + (dr.current_billing || 0), 0\n    )\n\n    // Get the most recent retention amount\n    const latestDraw = completedDraws[0]\n    const retentionHeld = latestDraw?.retention_held || 0\n\n    return { billedToDate, retentionHeld }\n  }, [drawRequests])\n\n  const progress = revisedContract > 0\n    ? Math.round((billingTotals.billedToDate / revisedContract) * 100)\n    : 0\n\n  const nextDrawNumber = drawRequests.length > 0\n    ? Math.max(...drawRequests.map(dr => dr.draw_number)) + 1\n    : 1\n\n  const formatDate = (dateStr) => {\n    if (!dateStr) return ''\n    return new Date(dateStr).toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric'\n    })\n  }\n\n  const getStatusBadge = (status) => {\n    switch (status) {\n      case 'draft':\n        return <span className=\"badge badge-muted\">Draft</span>\n      case 'submitted':\n        return <span className=\"badge badge-warning\">Submitted</span>\n      case 'approved':\n        return <span className=\"badge badge-success\">Approved</span>\n      case 'paid':\n        return <span className=\"badge badge-info\">Paid</span>\n      case 'rejected':\n        return <span className=\"badge badge-danger\">Rejected</span>\n      default:\n        return null\n    }\n  }\n\n  return (\n    <div className=\"progress-billing-card\">\n      <div className=\"progress-billing-header\">\n        <div className=\"progress-billing-title\">\n          <FileSpreadsheet size={18} />\n          <h3>Progress Billing</h3>\n        </div>\n        <button\n          className=\"btn btn-sm btn-primary\"\n          onClick={() => onCreateDraw?.()}\n          disabled={originalContract === 0}\n          title={originalContract === 0 ? 'Add areas with contract values first' : `Create Draw #${nextDrawNumber}`}\n        >\n          <Plus size={14} />\n          <span>Draw #{nextDrawNumber}</span>\n        </button>\n      </div>\n\n      {/* Contract Summary */}\n      <div className=\"progress-billing-contract\">\n        <div className=\"contract-row\">\n          <span className=\"contract-label\">Original Contract</span>\n          <span className=\"contract-value\">{formatCurrency(originalContract)}</span>\n        </div>\n        {approvedCOs > 0 && (\n          <div className=\"contract-row co\">\n            <span className=\"contract-label\">Approved COs</span>\n            <span className=\"contract-value positive\">+{formatCurrency(approvedCOs)}</span>\n          </div>\n        )}\n        <div className=\"contract-row revised\">\n          <span className=\"contract-label\">Revised Contract</span>\n          <span className=\"contract-value\">{formatCurrency(revisedContract)}</span>\n        </div>\n      </div>\n\n      {/* Billing Progress */}\n      <div className=\"progress-billing-status\">\n        <div className=\"billing-progress-bar\">\n          <div\n            className=\"billing-progress-fill\"\n            style={{ width: `${Math.min(progress, 100)}%` }}\n          />\n        </div>\n        <div className=\"billing-stats\">\n          <div className=\"billing-stat\">\n            <span className=\"billing-stat-value\">{formatCurrency(billingTotals.billedToDate)}</span>\n            <span className=\"billing-stat-label\">Billed to Date ({progress}%)</span>\n          </div>\n          {billingTotals.retentionHeld > 0 && (\n            <div className=\"billing-stat retention\">\n              <span className=\"billing-stat-value\">-{formatCurrency(billingTotals.retentionHeld)}</span>\n              <span className=\"billing-stat-label\">Retention Held</span>\n            </div>\n          )}\n          <div className=\"billing-stat remaining\">\n            <span className=\"billing-stat-value\">{formatCurrency(revisedContract - billingTotals.billedToDate)}</span>\n            <span className=\"billing-stat-label\">Balance to Finish</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Recent Draw Requests */}\n      {loading ? (\n        <div className=\"progress-billing-loading\">\n          <div className=\"loading-spinner small\" />\n        </div>\n      ) : drawRequests.length === 0 ? (\n        <div className=\"progress-billing-empty\">\n          <p>No draw requests yet</p>\n          {originalContract > 0 && (\n            <button\n              className=\"btn btn-sm btn-outline\"\n              onClick={() => onCreateDraw?.()}\n            >\n              <Plus size={14} />\n              Create First Draw Request\n            </button>\n          )}\n        </div>\n      ) : (\n        <div className=\"progress-billing-draws\">\n          <div className=\"draws-header\">\n            <span>Recent Draws</span>\n          </div>\n          <div className=\"draws-list\">\n            {drawRequests.slice(0, 3).map(dr => (\n              <button\n                key={dr.id}\n                className=\"draw-item\"\n                onClick={() => onViewDraw?.(dr)}\n              >\n                <div className=\"draw-item-info\">\n                  <span className=\"draw-number\">Draw #{dr.draw_number}</span>\n                  <span className=\"draw-date\">{formatDate(dr.period_end || dr.created_at)}</span>\n                </div>\n                <div className=\"draw-item-amount\">\n                  {formatCurrency(dr.current_billing || 0)}\n                </div>\n                {getStatusBadge(dr.status)}\n                <ChevronRight size={16} className=\"draw-item-arrow\" />\n              </button>\n            ))}\n          </div>\n          {drawRequests.length > 3 && (\n            <button className=\"btn btn-sm btn-ghost view-all-draws\">\n              View all {drawRequests.length} draws\n            </button>\n          )}\n        </div>\n      )}\n    </div>\n  )\n})\n","import { Suspense, lazy } from 'react'\nimport { HardHat, Menu, Download } from 'lucide-react'\nimport { formatCurrency } from '../../../lib/utils'\nimport { exportProjectFinancials, exportToQuickBooksIIF } from '../../../lib/financialExport'\nimport HeroMetrics from '../../HeroMetrics'\nimport FinancialsNav from '../../FinancialsNav'\nimport { FinancialTrendChart } from '../../charts'\nimport BurnRateCard from '../../BurnRateCard'\nimport ProfitabilityCard from '../../ProfitabilityCard'\nimport CostContributorsCard from '../../CostContributorsCard'\nimport DisposalSummary from '../../DisposalSummary'\nimport ProjectEquipmentCard from '../../equipment/ProjectEquipmentCard'\nimport ProgressBillingCard from '../../billing/ProgressBillingCard'\nimport ManDayCosts from '../../ManDayCosts'\nimport { TicketSkeleton } from '../../ui'\n\nconst TMList = lazy(() => import('../../TMList'))\nconst CORLogPreview = lazy(() => import('../../cor/CORLogPreview'))\nconst CORList = lazy(() => import('../../cor/CORList'))\nconst BillingCenter = lazy(() => import('../../billing/BillingCenter'))\n\nexport default function FinancialsTab({\n  selectedProject,\n  company,\n  user,\n  projectData,\n  progress,\n  billable,\n  changeOrderValue,\n  revisedContractValue,\n  areas,\n  financialsSection,\n  setFinancialsSection,\n  financialsSidebarCollapsed,\n  financialsSidebarMobileOpen,\n  onToggleFinancialsSidebar,\n  onToggleMobileSidebar,\n  onCloseMobileSidebar,\n  financialsNavStats,\n  // COR state\n  corListExpanded,\n  corRefreshKey,\n  corDisplayMode,\n  setCORDisplayMode,\n  onToggleCORList,\n  onCreateCOR,\n  onViewCOR,\n  onEditCOR,\n  // T&M state\n  tmViewMode,\n  onViewAllTickets,\n  onBackToTMPreview,\n  // Equipment\n  equipmentRefreshKey,\n  onAddEquipment,\n  onEditEquipment,\n  // Billing\n  drawRequestRefreshKey,\n  onCreateDraw,\n  onViewDraw,\n  // Costs\n  onAddCost,\n  onDeleteCost,\n  onShowToast\n}) {\n  return (\n    <div className=\"pv-tab-panel financials-tab\">\n      {/* Export Actions */}\n      <div className=\"export-actions\" style={{ display: 'flex', gap: '8px', marginLeft: 'auto', marginBottom: '12px', justifyContent: 'flex-end' }}>\n        <button\n          className=\"btn btn-ghost btn-small\"\n          onClick={() => exportProjectFinancials(selectedProject, {\n            earnedRevenue: billable,\n            approvedCORs: projectData?.cors?.filter(c => c.status === 'approved'),\n            laborByDate: projectData?.laborByDate,\n            haulOffByDate: projectData?.haulOffByDate,\n            customCosts: projectData?.customCosts\n          })}\n        >\n          <Download size={14} /> Export CSV\n        </button>\n        <button\n          className=\"btn btn-ghost btn-small\"\n          onClick={() => exportToQuickBooksIIF(selectedProject, {\n            totalLaborCost: projectData?.totalLaborCost || 0,\n            totalDisposalCost: projectData?.totalDisposalCost || 0\n          })}\n        >\n          <Download size={14} /> QuickBooks\n        </button>\n      </div>\n      {/* Key Metrics - Hero Section (Always visible) */}\n      <HeroMetrics\n        contractValue={selectedProject?.contract_value || 0}\n        earnedRevenue={billable}\n        totalCosts={projectData?.allCostsTotal || 0}\n        profit={projectData?.currentProfit || 0}\n        progress={progress}\n        corApprovedValue={changeOrderValue}\n        loading={!projectData}\n      />\n\n      {/* Split Layout with Collapsible Navigation */}\n      <div className={`financials-layout ${financialsSidebarCollapsed ? 'sidebar-collapsed' : ''}`}>\n        {/* Mobile Menu Toggle Button */}\n        <button\n          className=\"financials-mobile-menu-toggle\"\n          onClick={onToggleMobileSidebar}\n          aria-label=\"Open navigation menu\"\n          title=\"Open navigation menu\"\n        >\n          <Menu size={20} />\n          <span>Menu</span>\n        </button>\n\n        {/* Mobile Overlay/Backdrop */}\n        {financialsSidebarMobileOpen && (\n          <div\n            className=\"financials-sidebar-overlay\"\n            onClick={onCloseMobileSidebar}\n            aria-hidden=\"true\"\n          />\n        )}\n\n        {/* Sidebar Navigation - Always visible, collapsible */}\n        <div className={`financials-sidebar ${financialsSidebarCollapsed ? 'collapsed' : ''} ${financialsSidebarMobileOpen ? 'mobile-open' : ''}`}>\n          <FinancialsNav\n            activeSection={financialsSection}\n            onSectionChange={(section) => {\n              setFinancialsSection(section)\n              onCloseMobileSidebar()\n            }}\n            collapsed={financialsSidebarCollapsed}\n            onToggleCollapse={onToggleFinancialsSidebar}\n            onMobileClose={onCloseMobileSidebar}\n            stats={financialsNavStats}\n          />\n        </div>\n\n        {/* Main Content Area */}\n        <div className=\"financials-main\">\n          {/* OVERVIEW SECTION */}\n          {financialsSection === 'overview' && (\n            <div className=\"financials-overview animate-fade-in\">\n              <FinancialTrendChart\n                projectData={projectData}\n                project={selectedProject}\n                tmTickets={projectData?.tmTickets || []}\n                corStats={projectData?.corStats}\n                areas={areas}\n              />\n\n              <div className=\"financials-analysis-row stagger-children\">\n                <BurnRateCard\n                  dailyBurn={projectData?.dailyBurn || 0}\n                  totalBurn={projectData?.totalBurn || 0}\n                  daysWorked={projectData?.totalBurnDays || 0}\n                  laborCost={projectData?.laborCost || 0}\n                  materialsEquipmentCost={projectData?.materialsEquipmentCost || 0}\n                  progress={progress}\n                  contractValue={revisedContractValue}\n                  laborByDate={projectData?.laborByDate || []}\n                  materialsEquipmentByDate={projectData?.materialsEquipmentByDate || []}\n                />\n                <ProfitabilityCard\n                  revenue={billable}\n                  totalCosts={projectData?.allCostsTotal || 0}\n                  contractValue={revisedContractValue}\n                  progress={progress}\n                />\n              </div>\n\n              <div className=\"cost-disposal-row\">\n                <CostContributorsCard\n                  laborCost={projectData?.laborCost || 0}\n                  haulOffCost={projectData?.haulOffCost || 0}\n                  customCosts={projectData?.customCosts || []}\n                  onAddCost={onAddCost}\n                  onDeleteCost={onDeleteCost}\n                />\n                <DisposalSummary project={selectedProject} period=\"week\" />\n              </div>\n\n              <ProjectEquipmentCard\n                key={equipmentRefreshKey}\n                project={selectedProject}\n                onAddEquipment={onAddEquipment}\n                onEditEquipment={onEditEquipment}\n                onShowToast={onShowToast}\n              />\n\n              <ProgressBillingCard\n                key={drawRequestRefreshKey}\n                project={selectedProject}\n                areas={areas}\n                corStats={projectData?.corStats}\n                onCreateDraw={onCreateDraw}\n                onViewDraw={onViewDraw}\n                onShowToast={onShowToast}\n              />\n\n              <details className=\"financials-details\">\n                <summary className=\"financials-details-summary\">\n                  <HardHat size={16} />\n                  <span>Labor Details</span>\n                  <span className=\"financials-details-value\">{formatCurrency(projectData?.laborCost || 0)}</span>\n                </summary>\n                <div className=\"financials-details-content\">\n                  <ManDayCosts project={selectedProject} company={company} onShowToast={onShowToast} />\n                </div>\n              </details>\n            </div>\n          )}\n\n          {/* CHANGE ORDERS SECTION */}\n          {financialsSection === 'cors' && (\n            <div className=\"financials-cors animate-fade-in\">\n              <div className=\"financials-section cor-section-primary\">\n                <Suspense fallback={<TicketSkeleton />}>\n                  <CORLogPreview\n                    project={selectedProject}\n                    onShowToast={onShowToast}\n                    onToggleList={onToggleCORList}\n                    showingList={corListExpanded}\n                    onViewFullLog={() => setCORDisplayMode('log')}\n                    onCreateCOR={onCreateCOR}\n                  />\n                </Suspense>\n              </div>\n\n              {corListExpanded && (\n                <div className=\"financials-section cor-section-list animate-fade-in\" style={{ marginTop: '1rem' }}>\n                  <Suspense fallback={<TicketSkeleton />}>\n                    <CORList\n                      project={selectedProject}\n                      company={company}\n                      areas={areas}\n                      refreshKey={corRefreshKey}\n                      onShowToast={onShowToast}\n                      previewMode={false}\n                      onViewAll={onToggleCORList}\n                      onDisplayModeChange={setCORDisplayMode}\n                      onCreateCOR={onCreateCOR}\n                      onViewCOR={onViewCOR}\n                      onEditCOR={onEditCOR}\n                    />\n                  </Suspense>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* T&M TICKETS SECTION */}\n          {financialsSection === 'tickets' && (\n            <div className=\"financials-tickets animate-fade-in\">\n              <div className=\"financials-section tm-section\">\n                {tmViewMode === 'full' && (\n                  <button className=\"section-back-btn\" onClick={onBackToTMPreview}>\n                    &larr; Back to summary\n                  </button>\n                )}\n                <Suspense fallback={<TicketSkeleton />}>\n                  <TMList\n                    project={selectedProject}\n                    company={company}\n                    onShowToast={onShowToast}\n                    compact={tmViewMode === 'preview'}\n                    previewMode={tmViewMode === 'preview'}\n                    onViewAll={onViewAllTickets}\n                  />\n                </Suspense>\n              </div>\n            </div>\n          )}\n\n          {/* BILLING SECTION */}\n          {financialsSection === 'billing' && (\n            <div className=\"financials-billing animate-fade-in\">\n              <Suspense fallback={<TicketSkeleton />}>\n                <BillingCenter\n                  project={selectedProject}\n                  company={company}\n                  user={user}\n                  onShowToast={onShowToast}\n                />\n              </Suspense>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n","import { Suspense, lazy } from 'react'\nimport { ClipboardList, Users, Shield, Package, Truck, FileText, Camera, HardHat, DollarSign, AlertTriangle, CheckCircle2, TrendingUp, TrendingDown } from 'lucide-react'\nimport { formatCurrency } from '../../../lib/utils'\nimport { TicketSkeleton } from '../../ui'\n\nconst DailyReportsList = lazy(() => import('../../DailyReportsList'))\nconst InjuryReportsList = lazy(() => import('../../InjuryReportsList'))\n\nexport default function ReportsTab({\n  selectedProject,\n  company,\n  user,\n  projectData,\n  areas,\n  onShowToast\n}) {\n  return (\n    <div className=\"pv-tab-panel reports-tab\">\n      {/* Hero Metrics - High Level Project Pulse */}\n      <div className=\"reports-hero\">\n        <div className=\"reports-hero-grid\">\n          <div className=\"reports-metric primary\">\n            <div className=\"reports-metric-icon\">\n              <ClipboardList size={24} />\n            </div>\n            <div className=\"reports-metric-content\">\n              <div className=\"reports-metric-value\">{projectData?.dailyReportsCount || 0}</div>\n              <div className=\"reports-metric-label\">Daily Reports</div>\n            </div>\n          </div>\n          <div className=\"reports-metric\">\n            <div className=\"reports-metric-value\">{projectData?.recentDailyReports || 0}</div>\n            <div className=\"reports-metric-label\">This Week</div>\n            <div className=\"reports-metric-bar\">\n              <div\n                className=\"reports-metric-fill\"\n                style={{ width: `${Math.min((projectData?.recentDailyReports || 0) / 7 * 100, 100)}%` }}\n              ></div>\n            </div>\n          </div>\n          <div className=\"reports-metric\">\n            <div className=\"reports-metric-value\">{projectData?.totalTickets || 0}</div>\n            <div className=\"reports-metric-label\">T&M Tickets</div>\n            {(projectData?.pendingTickets || 0) > 0 && (\n              <div className=\"reports-metric-status\" style={{ background: '#fef3c7', color: '#92400e' }}>\n                {projectData.pendingTickets} pending\n              </div>\n            )}\n          </div>\n          <div className=\"reports-metric\">\n            <div className=\"reports-metric-value\">{projectData?.totalPhotosFromTickets || 0}</div>\n            <div className=\"reports-metric-label\">Photos Captured</div>\n          </div>\n        </div>\n      </div>\n\n      {/* Two-Column Layout: Crew + Safety */}\n      <div className=\"reports-two-col\">\n        {/* Crew Analytics Card */}\n        <div className=\"reports-insight-card\">\n          <div className=\"reports-insight-header\">\n            <div className=\"reports-insight-title\">\n              <Users size={18} />\n              <h3>Crew Analytics</h3>\n            </div>\n          </div>\n          <div className=\"reports-insight-body\">\n            <div className=\"reports-stat-grid\">\n              <div className=\"reports-stat\">\n                <span className=\"reports-stat-value\">{projectData?.uniqueWorkerCount || 0}</span>\n                <span className=\"reports-stat-label\">Total Workers</span>\n              </div>\n              <div className=\"reports-stat\">\n                <span className=\"reports-stat-value\">{projectData?.avgCrewSize || 0}</span>\n                <span className=\"reports-stat-label\">Avg Crew / Day</span>\n              </div>\n              <div className=\"reports-stat\">\n                <span className=\"reports-stat-value\">{projectData?.peakCrewSize || 0}</span>\n                <span className=\"reports-stat-label\">Peak Crew Size</span>\n              </div>\n              <div className=\"reports-stat\">\n                <span className=\"reports-stat-value\">{projectData?.crewDaysTracked || 0}</span>\n                <span className=\"reports-stat-label\">Days Tracked</span>\n              </div>\n            </div>\n            {(projectData?.crewTrend || 0) !== 0 && (\n              <div className={`reports-trend-badge ${projectData.crewTrend > 0 ? 'up' : 'down'}`}>\n                {projectData.crewTrend > 0 ? <TrendingUp size={14} /> : <TrendingDown size={14} />}\n                <span>{Math.abs(Math.round(projectData.crewTrend))}% {projectData.crewTrend > 0 ? 'increase' : 'decrease'} vs prior week</span>\n              </div>\n            )}\n            {projectData?.crewByDate && Object.keys(projectData.crewByDate).length > 0 && (\n              <div className=\"reports-mini-chart\">\n                <div className=\"reports-mini-chart-label\">Recent Crew Size</div>\n                <div className=\"reports-mini-bars\">\n                  {Object.keys(projectData.crewByDate).sort().slice(-14).map(date => {\n                    const count = projectData.crewByDate[date]\n                    const max = projectData.peakCrewSize || 1\n                    return (\n                      <div key={date} className=\"reports-mini-bar-wrap\" title={`${new Date(date + 'T12:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}: ${count} workers`}>\n                        <div className=\"reports-mini-bar\" style={{ height: `${(count / max) * 100}%` }}></div>\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Safety Dashboard Card */}\n        <div className=\"reports-insight-card\">\n          <div className=\"reports-insight-header\">\n            <div className=\"reports-insight-title\">\n              <Shield size={18} />\n              <h3>Safety Dashboard</h3>\n            </div>\n            <span className={`reports-section-badge ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n              {(projectData?.injuryReportsCount || 0) > 0\n                ? `${projectData.injuryReportsCount} incident${projectData.injuryReportsCount !== 1 ? 's' : ''}`\n                : 'No incidents'\n              }\n            </span>\n          </div>\n          <div className=\"reports-insight-body\">\n            <div className=\"reports-safety-hero\">\n              <div className={`reports-safety-days ${(projectData?.daysSinceLastInjury === null || projectData?.daysSinceLastInjury > 30) ? 'excellent' : projectData?.daysSinceLastInjury > 7 ? 'good' : 'caution'}`}>\n                <span className=\"reports-safety-days-value\">\n                  {projectData?.daysSinceLastInjury !== null ? projectData.daysSinceLastInjury : '--'}\n                </span>\n                <span className=\"reports-safety-days-label\">\n                  {projectData?.daysSinceLastInjury !== null ? 'Days Since Last Incident' : 'No Incidents Recorded'}\n                </span>\n              </div>\n            </div>\n            <div className=\"reports-stat-grid\">\n              <div className=\"reports-stat\">\n                <span className=\"reports-stat-value\">{projectData?.injuryReportsCount || 0}</span>\n                <span className=\"reports-stat-label\">Total Incidents</span>\n              </div>\n              <div className=\"reports-stat\">\n                <span className=\"reports-stat-value\">{projectData?.oshaRecordable || 0}</span>\n                <span className=\"reports-stat-label\">OSHA Recordable</span>\n              </div>\n              <div className=\"reports-stat\">\n                <span className=\"reports-stat-value\">{projectData?.reportsWithIssues || 0}</span>\n                <span className=\"reports-stat-label\">Reports w/ Issues</span>\n              </div>\n              <div className=\"reports-stat\">\n                <span className=\"reports-stat-value\">{projectData?.laborManDays || 0}</span>\n                <span className=\"reports-stat-label\">Total Man-Days</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Material Requests + Disposal Summary Row */}\n      <div className=\"reports-two-col\">\n        {/* Material Requests */}\n        <div className=\"reports-insight-card\">\n          <div className=\"reports-insight-header\">\n            <div className=\"reports-insight-title\">\n              <Package size={18} />\n              <h3>Material Requests</h3>\n            </div>\n            <span className=\"reports-section-count\">{projectData?.totalMaterialRequests || 0} total</span>\n          </div>\n          <div className=\"reports-insight-body\">\n            {(projectData?.totalMaterialRequests || 0) === 0 ? (\n              <div className=\"reports-empty-state\">\n                <Package size={32} />\n                <p>No material requests yet</p>\n                <span>Requests from the field will appear here</span>\n              </div>\n            ) : (\n              <>\n                <div className=\"reports-material-pipeline\">\n                  {projectData?.urgentMaterialRequests > 0 && (\n                    <div className=\"reports-material-status urgent\">\n                      <AlertTriangle size={14} />\n                      <span>{projectData.urgentMaterialRequests} Urgent</span>\n                    </div>\n                  )}\n                  <div className=\"reports-material-status pending\">\n                    <span className=\"reports-material-dot\"></span>\n                    <span>{projectData?.pendingMaterialRequests || 0} Pending</span>\n                  </div>\n                  <div className=\"reports-material-status ordered\">\n                    <span className=\"reports-material-dot\"></span>\n                    <span>{projectData?.orderedMaterialRequests || 0} Ordered</span>\n                  </div>\n                  <div className=\"reports-material-status delivered\">\n                    <CheckCircle2 size={14} />\n                    <span>{projectData?.deliveredMaterialRequests || 0} Delivered</span>\n                  </div>\n                </div>\n                <div className=\"reports-recent-list\">\n                  {(projectData?.materialRequests || []).slice(0, 3).map(req => (\n                    <div key={req.id} className={`reports-recent-item ${req.status}`}>\n                      <div className=\"reports-recent-item-main\">\n                        <span className={`reports-recent-item-status ${req.status}`}>{req.status}</span>\n                        <span className=\"reports-recent-item-date\">\n                          {new Date(req.created_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                        </span>\n                      </div>\n                      <div className=\"reports-recent-item-detail\">\n                        {(req.items || []).slice(0, 2).map((item, i) => (\n                          <span key={i}>{item.name}{item.quantity ? ` (${item.quantity})` : ''}</span>\n                        ))}\n                        {(req.items || []).length > 2 && (\n                          <span className=\"reports-recent-more\">+{(req.items || []).length - 2} more</span>\n                        )}\n                      </div>\n                      {req.priority === 'urgent' && (\n                        <span className=\"reports-urgent-tag\">URGENT</span>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              </>\n            )}\n          </div>\n        </div>\n\n        {/* Disposal Trends */}\n        <div className=\"reports-insight-card\">\n          <div className=\"reports-insight-header\">\n            <div className=\"reports-insight-title\">\n              <Truck size={18} />\n              <h3>Disposal Trends</h3>\n            </div>\n            <span className=\"reports-section-count\">{projectData?.disposalTotalLoads || 0} loads</span>\n          </div>\n          <div className=\"reports-insight-body\">\n            {(projectData?.weeklyDisposal || []).length === 0 ? (\n              <div className=\"reports-empty-state\">\n                <Truck size={32} />\n                <p>No disposal data yet</p>\n                <span>Disposal loads from the field will appear here</span>\n              </div>\n            ) : (\n              <>\n                <div className=\"reports-disposal-chart\">\n                  <div className=\"reports-disposal-bars\">\n                    {(projectData?.weeklyDisposal || []).map((week, i) => {\n                      const total = (week.concrete || 0) + (week.trash || 0) + (week.metals || 0) + (week.hazardous_waste || 0)\n                      const maxWeek = Math.max(...(projectData?.weeklyDisposal || []).map(w => (w.concrete || 0) + (w.trash || 0) + (w.metals || 0) + (w.hazardous_waste || 0))) || 1\n                      return (\n                        <div key={i} className=\"reports-disposal-bar-col\">\n                          <div className=\"reports-disposal-bar-stack\" style={{ height: `${(total / maxWeek) * 100}%` }}>\n                            {week.concrete > 0 && <div className=\"reports-disposal-seg concrete\" style={{ flex: week.concrete }} title={`Concrete: ${week.concrete}`}></div>}\n                            {week.trash > 0 && <div className=\"reports-disposal-seg trash\" style={{ flex: week.trash }} title={`Trash: ${week.trash}`}></div>}\n                            {week.metals > 0 && <div className=\"reports-disposal-seg metals\" style={{ flex: week.metals }} title={`Metals: ${week.metals}`}></div>}\n                            {week.hazardous_waste > 0 && <div className=\"reports-disposal-seg hazardous\" style={{ flex: week.hazardous_waste }} title={`Hazardous: ${week.hazardous_waste}`}></div>}\n                          </div>\n                          <span className=\"reports-disposal-bar-label\">\n                            {new Date(week.week + 'T12:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                          </span>\n                        </div>\n                      )\n                    })}\n                  </div>\n                  <div className=\"reports-disposal-legend\">\n                    <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot concrete\"></span>Concrete</span>\n                    <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot trash\"></span>Trash</span>\n                    <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot metals\"></span>Metals</span>\n                    <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot hazardous\"></span>Hazardous</span>\n                  </div>\n                </div>\n                {(projectData?.haulOffCost || 0) > 0 && (\n                  <div className=\"reports-disposal-cost\">\n                    <span>Total Disposal Cost</span>\n                    <strong>{formatCurrency(projectData.haulOffCost)}</strong>\n                  </div>\n                )}\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Field Activity Summary */}\n      <div className=\"reports-insight-card reports-activity-summary\">\n        <div className=\"reports-insight-header\">\n          <div className=\"reports-insight-title\">\n            <ClipboardList size={18} />\n            <h3>Field Activity Summary</h3>\n          </div>\n          <div className=\"reports-activity-badges\">\n            {projectData?.lastDailyReport && (\n              <span className=\"reports-last-filed\">\n                Last report: {new Date(projectData.lastDailyReport).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                {' '}({Math.floor((new Date() - new Date(projectData.lastDailyReport)) / (1000 * 60 * 60 * 24))}d ago)\n              </span>\n            )}\n          </div>\n        </div>\n        <div className=\"reports-insight-body\">\n          <div className=\"reports-activity-grid\">\n            <div className=\"reports-activity-stat\">\n              <div className=\"reports-activity-stat-icon\"><ClipboardList size={16} /></div>\n              <div className=\"reports-activity-stat-info\">\n                <strong>{projectData?.dailyReportsCount || 0}</strong>\n                <span>Daily Reports Filed</span>\n              </div>\n            </div>\n            <div className=\"reports-activity-stat\">\n              <div className=\"reports-activity-stat-icon\"><FileText size={16} /></div>\n              <div className=\"reports-activity-stat-info\">\n                <strong>{projectData?.totalTickets || 0}</strong>\n                <span>T&M Tickets Created</span>\n              </div>\n            </div>\n            <div className=\"reports-activity-stat\">\n              <div className=\"reports-activity-stat-icon\"><Camera size={16} /></div>\n              <div className=\"reports-activity-stat-info\">\n                <strong>{projectData?.totalPhotosFromTickets || 0}</strong>\n                <span>Photos Documented</span>\n              </div>\n            </div>\n            <div className=\"reports-activity-stat\">\n              <div className=\"reports-activity-stat-icon\"><HardHat size={16} /></div>\n              <div className=\"reports-activity-stat-info\">\n                <strong>{projectData?.completedAreasCount || 0}/{areas.length}</strong>\n                <span>Work Areas Complete</span>\n              </div>\n            </div>\n            <div className=\"reports-activity-stat\">\n              <div className=\"reports-activity-stat-icon\"><DollarSign size={16} /></div>\n              <div className=\"reports-activity-stat-info\">\n                <strong>{formatCurrency(projectData?.allCostsTotal || 0)}</strong>\n                <span>Total Costs Tracked</span>\n              </div>\n            </div>\n            <div className=\"reports-activity-stat\">\n              <div className=\"reports-activity-stat-icon\"><Users size={16} /></div>\n              <div className=\"reports-activity-stat-info\">\n                <strong>{projectData?.laborManDays || 0}</strong>\n                <span>Total Man-Days</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Daily Reports Section */}\n      <div className=\"reports-section-card\">\n        <div className=\"reports-section-header\">\n          <div className=\"reports-section-title\">\n            <ClipboardList size={18} />\n            <h3>Daily Reports</h3>\n          </div>\n          <span className=\"reports-section-count\">{projectData?.dailyReportsCount || 0} total</span>\n        </div>\n        <div className=\"reports-section-content\">\n          <Suspense fallback={<TicketSkeleton />}>\n            <DailyReportsList project={selectedProject} company={company} onShowToast={onShowToast} />\n          </Suspense>\n        </div>\n      </div>\n\n      {/* Injury Reports Section */}\n      <div className={`reports-section-card ${(projectData?.injuryReportsCount || 0) > 0 ? 'has-warning' : ''}`}>\n        <div className=\"reports-section-header\">\n          <div className=\"reports-section-title\">\n            <span className={`reports-section-icon ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n              {(projectData?.injuryReportsCount || 0) > 0 ? '\\u26A0' : '\\u2713'}\n            </span>\n            <h3>Safety & Injury Reports</h3>\n          </div>\n          <span className={`reports-section-badge ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n            {(projectData?.injuryReportsCount || 0) > 0\n              ? `${projectData.injuryReportsCount} incident${projectData.injuryReportsCount !== 1 ? 's' : ''}`\n              : 'No incidents'\n            }\n          </span>\n        </div>\n        <div className=\"reports-section-content\">\n          <Suspense fallback={<TicketSkeleton />}>\n            <InjuryReportsList\n              project={selectedProject}\n              companyId={company?.id || selectedProject?.company_id}\n              company={company}\n              user={user}\n              onShowToast={onShowToast}\n            />\n          </Suspense>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import { useState, useEffect, useRef, useCallback, useMemo, lazy, Suspense } from 'react'\nimport { db } from '../lib/supabase'\nimport { safeAsync } from '../lib/errorHandler'\nimport { formatCurrency, calculateProgress, calculateValueProgress, getOverallStatus, getOverallStatusLabel, formatStatus, calculateScheduleInsights, shouldAutoArchive } from '../lib/utils'\nimport { calculateRiskScore, generateSmartAlerts, calculateProjections } from '../lib/riskCalculations'\nimport { exportAllFieldDocumentsPDF, exportDailyReportsPDF, exportIncidentReportsPDF, exportCrewCheckinsPDF } from '../lib/fieldDocumentExport'\nimport { exportProjectFinancials, exportToQuickBooksIIF } from '../lib/financialExport'\nimport { LayoutGrid, DollarSign, ClipboardList, HardHat, Truck, Info, FolderOpen, Search, Download } from 'lucide-react'\nimport UniversalSearch, { useUniversalSearch } from './UniversalSearch'\nimport { SmartAlerts } from './dashboard/SmartAlerts'\nimport { RiskScoreBadge } from './dashboard/RiskScoreGauge'\nimport { TrendIndicator } from './dashboard/TrendIndicator'\nimport { ProjectHealthBadge } from './dashboard/AccessibleStatusBadge'\nimport OverviewProgressGauge from './overview/OverviewProgressGauge'\nimport OverviewFinancialCard from './overview/OverviewFinancialCard'\nimport { TicketSkeleton } from './ui'\n\n// Tab components\nimport OverviewTab from './dashboard/tabs/OverviewTab'\nimport FinancialsTab from './dashboard/tabs/FinancialsTab'\nimport ReportsTab from './dashboard/tabs/ReportsTab'\nimport SettingsTab from './dashboard/tabs/SettingsTab'\n\n// Lazy load modals and conditionally rendered heavy components\nconst ShareModal = lazy(() => import('./ShareModal'))\nconst NotificationSettings = lazy(() => import('./NotificationSettings'))\nconst CORForm = lazy(() => import('./cor/CORForm'))\nconst CORDetail = lazy(() => import('./cor/CORDetail'))\nconst CORLog = lazy(() => import('./cor/CORLog'))\nconst DrawRequestModal = lazy(() => import('./billing/DrawRequestModal'))\nconst EquipmentModal = lazy(() => import('./equipment/EquipmentModal'))\nconst AddCostModal = lazy(() => import('./AddCostModal'))\nconst DocumentsTab = lazy(() => import('./documents/DocumentsTab'))\n\nexport default function Dashboard({ company, user, isAdmin, onShowToast, navigateToProjectId, onProjectNavigated }) {\n  const [projects, setProjects] = useState([])\n  const [projectsData, setProjectsData] = useState([]) // Enhanced data with areas/tickets\n  const [selectedProject, setSelectedProject] = useState(null)\n  const [areas, setAreas] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [editMode, setEditMode] = useState(false)\n  const [editData, setEditData] = useState(null)\n  const [saving, setSaving] = useState(false)\n  const [showShareModal, setShowShareModal] = useState(false)\n  const [showNotificationSettings, setShowNotificationSettings] = useState(false)\n  const [activeProjectTab, setActiveProjectTab] = useState('overview')\n  const [financialsSection, setFinancialsSection] = useState('overview') // 'overview' | 'cors' | 'tickets'\n  const [financialsSidebarCollapsed, setFinancialsSidebarCollapsed] = useState(true) // Start collapsed for more real estate\n  const [financialsSidebarMobileOpen, setFinancialsSidebarMobileOpen] = useState(false) // For mobile sidebar overlay\n  const [corListExpanded, setCORListExpanded] = useState(false) // Whether the full card list is shown below the log\n  const [corDisplayMode, setCORDisplayMode] = useState('list') // 'list' | 'log' - for layout expansion\n  const [tmViewMode, setTMViewMode] = useState('preview') // 'preview' | 'full'\n  const [dumpSites, setDumpSites] = useState([])\n  const [showCORForm, setShowCORForm] = useState(false)\n  const [editingCOR, setEditingCOR] = useState(null)\n  const [showCORDetail, setShowCORDetail] = useState(false)\n  const [viewingCOR, setViewingCOR] = useState(null)\n  const [corRefreshKey, setCORRefreshKey] = useState(0)\n  const [showAddCostModal, setShowAddCostModal] = useState(false)\n  const [savingCost, setSavingCost] = useState(false)\n  const [showEquipmentModal, setShowEquipmentModal] = useState(false)\n  const [editingEquipment, setEditingEquipment] = useState(null)\n  const [equipmentRefreshKey, setEquipmentRefreshKey] = useState(0)\n  const [showDrawRequestModal, setShowDrawRequestModal] = useState(false)\n  const [editingDrawRequest, setEditingDrawRequest] = useState(null)\n  const [drawRequestRefreshKey, setDrawRequestRefreshKey] = useState(0)\n\n  // Universal Search (Cmd+K)\n  const { isOpen: isSearchOpen, setIsOpen: setSearchOpen, close: closeSearch } = useUniversalSearch()\n\n  // Debounce ref to prevent cascading refreshes from multiple subscription callbacks\n  // When multiple real-time events fire rapidly, this coalesces them into a single refresh\n  const refreshTimeoutRef = useRef(null)\n  const pendingAreasRefreshRef = useRef(false)\n  const pendingCORRefreshRef = useRef(false)\n\n  // Cache for project details to avoid re-fetching when switching between projects\n  // Key: projectId, Value: { data: enhancedProjectData, timestamp: Date.now() }\n  const projectDetailsCacheRef = useRef(new Map())\n  const CACHE_TTL_MS = 5 * 60 * 1000 // 5 minute cache TTL\n\n  // Debounced refresh function that coalesces multiple rapid refresh requests\n  // This prevents 5+ loadProjects() calls when multiple subscriptions fire at once\n  const debouncedRefresh = useCallback((options = {}) => {\n    const { refreshAreas = false, refreshCOR = false, projectId = null } = options\n\n    // Track what needs refreshing\n    if (refreshAreas && projectId) pendingAreasRefreshRef.current = projectId\n    if (refreshCOR) pendingCORRefreshRef.current = true\n\n    // Clear any pending refresh\n    if (refreshTimeoutRef.current) {\n      clearTimeout(refreshTimeoutRef.current)\n    }\n\n    // Schedule a single refresh after debounce period (150ms)\n    // This is fast enough to feel \"live\" but prevents cascading calls\n    refreshTimeoutRef.current = setTimeout(async () => {\n      // Execute pending refreshes\n      if (pendingAreasRefreshRef.current) {\n        await loadAreas(pendingAreasRefreshRef.current)\n        pendingAreasRefreshRef.current = false\n      }\n      if (pendingCORRefreshRef.current) {\n        setCORRefreshKey(prev => prev + 1)\n        pendingCORRefreshRef.current = false\n      }\n      // Always refresh projects to update metrics\n      await loadProjects()\n    }, 150)\n  }, [])\n\n  // Cleanup debounce timeout on unmount\n  useEffect(() => {\n    return () => {\n      if (refreshTimeoutRef.current) {\n        clearTimeout(refreshTimeoutRef.current)\n      }\n    }\n  }, [])\n\n  // Initial load\n  useEffect(() => {\n    if (company?.id) {\n      loadProjects()\n      loadDumpSites()\n    }\n  }, [company?.id])\n\n  // Track project IDs for subscription stability (avoids re-subscribing on every projects array change)\n  const projectIdsRef = useRef([])\n  const projectIdsKey = projects.map(p => p.id).sort().join(',')\n\n  // Real-time subscription - runs after projects are loaded\n  useEffect(() => {\n    if (!company?.id || projects.length === 0) return\n\n    // Only update ref if project IDs actually changed\n    const currentIds = projects.map(p => p.id).sort()\n    projectIdsRef.current = currentIds\n\n    // Subscribe to company-wide activity to refresh metrics in real-time\n    // Uses debounced refresh to coalesce rapid updates from multiple sources\n    const subscription = db.subscribeToCompanyActivity?.(company.id, currentIds, {\n      onMessage: () => debouncedRefresh(),\n      onMaterialRequest: () => debouncedRefresh(),\n      onTMTicket: () => debouncedRefresh(),\n      onCrewCheckin: () => debouncedRefresh(), // Crew check-ins affect labor costs\n      onAreaUpdate: () => debouncedRefresh(), // Area updates affect progress\n      onCORChange: () => debouncedRefresh({ refreshCOR: true }), // COR changes\n      onInjuryReport: () => debouncedRefresh(),\n      onProjectChange: () => debouncedRefresh(), // Project details changed\n      onMaterialsEquipmentChange: () => debouncedRefresh(), // Pricing updates\n      onLaborRateChange: () => debouncedRefresh() // Labor rate updates\n    })\n\n    return () => {\n      if (subscription) {\n        db.unsubscribe?.(subscription)\n      }\n    }\n  }, [company?.id, projectIdsKey, debouncedRefresh])\n\n  // Prevent body scroll when mobile sidebar is open\n  useEffect(() => {\n    if (financialsSidebarMobileOpen) {\n      document.body.style.overflow = 'hidden'\n    } else {\n      document.body.style.overflow = ''\n    }\n\n    return () => {\n      document.body.style.overflow = ''\n    }\n  }, [financialsSidebarMobileOpen])\n\n  const loadDumpSites = async () => {\n    try {\n      const sites = await db.getDumpSites(company.id)\n      setDumpSites(sites || [])\n    } catch (error) {\n      console.error('Error loading dump sites:', error)\n    }\n  }\n\n  // Handle navigation from notifications\n  // Use a ref to prevent re-running this effect when projects data refreshes\n  const lastNavigatedIdRef = useRef(null)\n  useEffect(() => {\n    if (navigateToProjectId && navigateToProjectId !== lastNavigatedIdRef.current && projects.length > 0) {\n      const project = projects.find(p => p.id === navigateToProjectId)\n      if (project) {\n        lastNavigatedIdRef.current = navigateToProjectId\n        setSelectedProject(project)\n        onProjectNavigated?.() // Clear the navigation request\n      }\n    }\n  }, [navigateToProjectId, projects, onProjectNavigated])\n\n  useEffect(() => {\n    if (selectedProject) {\n      loadAreas(selectedProject.id)\n\n      // Subscribe to real-time updates for the selected project\n      // All callbacks use debouncedRefresh to prevent cascading refreshes\n      const subscriptions = []\n      const projectId = selectedProject.id\n\n      // Areas subscription - also refreshes areas list\n      const areasSub = db.subscribeToAreas?.(projectId, () => {\n        debouncedRefresh({ refreshAreas: true, projectId })\n      })\n      if (areasSub) subscriptions.push(areasSub)\n\n      // Daily reports subscription\n      const dailyReportsSub = db.subscribeToDailyReports?.(projectId, () => {\n        debouncedRefresh()\n      })\n      if (dailyReportsSub) subscriptions.push(dailyReportsSub)\n\n      // Crew checkins subscription (affects labor costs)\n      const checkinsSub = db.subscribeToCrewCheckins?.(projectId, () => {\n        debouncedRefresh()\n      })\n      if (checkinsSub) subscriptions.push(checkinsSub)\n\n      // Haul offs subscription\n      const haulOffsSub = db.subscribeToHaulOffs?.(projectId, () => {\n        debouncedRefresh()\n      })\n      if (haulOffsSub) subscriptions.push(haulOffsSub)\n\n      // CORs subscription - also refreshes COR list\n      const corsSub = db.subscribeToCORs?.(projectId, () => {\n        debouncedRefresh({ refreshCOR: true })\n      })\n      if (corsSub) subscriptions.push(corsSub)\n\n      return () => {\n        subscriptions.forEach(sub => db.unsubscribe?.(sub))\n      }\n    }\n  }, [selectedProject, debouncedRefresh])\n\n  // When navigating to tickets section, switch to full mode to show dashboard\n  useEffect(() => {\n    if (financialsSection === 'tickets') {\n      setTMViewMode('full')\n    }\n  }, [financialsSection])\n\n  // Load detailed data for a single project (on-demand, with caching)\n  // This replaces the previous N+1 pattern where ALL project details were loaded upfront\n  const loadProjectDetails = async (project, forceRefresh = false) => {\n    const cacheKey = project.id\n    const cached = projectDetailsCacheRef.current.get(cacheKey)\n\n    // Return cached data if valid and not forcing refresh\n    if (cached && !forceRefresh && (Date.now() - cached.timestamp) < CACHE_TTL_MS) {\n      return cached.data\n    }\n\n    try {\n      // Fetch detailed project data in parallel (12 queries for 1 project, not 12N)\n      const [\n        projectAreas,\n        tickets,\n        changeOrderData,\n        dailyReports,\n        injuryReports,\n        laborCosts,\n        haulOffCosts,\n        customCosts,\n        corStats,\n        crewHistory,\n        materialRequests,\n        weeklyDisposal\n      ] = await Promise.all([\n        safeAsync(() => db.getAreas(project.id), { fallback: [], context: { operation: 'getAreas', projectId: project.id } }),\n        safeAsync(() => db.getTMTickets(project.id), { fallback: [], context: { operation: 'getTMTickets', projectId: project.id } }),\n        safeAsync(() => db.getChangeOrderTotals(project.id), { fallback: null, context: { operation: 'getChangeOrderTotals', projectId: project.id } }),\n        safeAsync(() => db.getDailyReports(project.id, 100), { fallback: [], context: { operation: 'getDailyReports', projectId: project.id } }),\n        safeAsync(() => db.getInjuryReports(project.id), { fallback: [], context: { operation: 'getInjuryReports', projectId: project.id } }),\n        safeAsync(() => db.calculateManDayCosts(project.id, company?.id, project.work_type || 'demolition', project.job_type || 'standard'), { fallback: null, context: { operation: 'calculateManDayCosts', projectId: project.id } }),\n        safeAsync(() => db.calculateHaulOffCosts(project.id), { fallback: null, context: { operation: 'calculateHaulOffCosts', projectId: project.id } }),\n        safeAsync(() => db.getProjectCosts(project.id), { fallback: [], context: { operation: 'getProjectCosts', projectId: project.id } }),\n        safeAsync(() => db.getCORStats(project.id), { fallback: null, context: { operation: 'getCORStats', projectId: project.id } }),\n        safeAsync(() => db.getCrewCheckinHistory(project.id, 60), { fallback: [], context: { operation: 'getCrewCheckinHistory', projectId: project.id } }),\n        safeAsync(() => db.getMaterialRequests(project.id), { fallback: [], context: { operation: 'getMaterialRequests', projectId: project.id } }),\n        safeAsync(() => db.getWeeklyDisposalSummary(project.id, 4), { fallback: [], context: { operation: 'getWeeklyDisposalSummary', projectId: project.id } })\n      ])\n\n      // Calculate progress - use SOV values if available\n      const progressData = calculateValueProgress(projectAreas)\n      const progress = progressData.progress\n\n      // Calculate revised contract value\n      const changeOrderValue = changeOrderData?.totalApprovedValue || 0\n      const revisedContractValue = project.contract_value + changeOrderValue\n\n      // Billable calculation\n      const billable = progressData.isValueBased\n        ? progressData.earnedValue\n        : (progress / 100) * revisedContractValue\n      const pendingTickets = tickets.filter(t => t.status === 'pending').length\n\n      // Recent activity\n      const oneWeekAgo = new Date()\n      oneWeekAgo.setDate(oneWeekAgo.getDate() - 7)\n      const recentDailyReports = dailyReports.filter(r => new Date(r.report_date) >= oneWeekAgo).length\n\n      // Custom costs\n      const customCostTotal = customCosts.reduce((sum, c) => {\n        const amount = parseFloat(c.amount)\n        return sum + (isNaN(amount) ? 0 : amount)\n      }, 0)\n\n      // Materials/equipment costs from T&M\n      let materialsEquipmentCost = 0\n      const materialsEquipmentByDate = {}\n      tickets.forEach(ticket => {\n        const ticketDate = ticket.work_date || ticket.ticket_date || ticket.created_at?.split('T')[0]\n        const items = ticket.t_and_m_items || ticket.items || []\n        let ticketMaterialsCost = 0\n        items.forEach(item => {\n          const qty = parseFloat(item.quantity) || 1\n          const cost = parseFloat(item.unit_cost) || parseFloat(item.materials_equipment?.cost_per_unit) || 0\n          ticketMaterialsCost += qty * cost\n        })\n        if (ticketMaterialsCost > 0 && ticketDate) {\n          materialsEquipmentCost += ticketMaterialsCost\n          if (!materialsEquipmentByDate[ticketDate]) {\n            materialsEquipmentByDate[ticketDate] = { date: ticketDate, cost: 0 }\n          }\n          materialsEquipmentByDate[ticketDate].cost += ticketMaterialsCost\n        }\n      })\n      const materialsEquipmentByDateArray = Object.values(materialsEquipmentByDate)\n        .sort((a, b) => new Date(b.date) - new Date(a.date))\n\n      // Total costs\n      const laborCost = laborCosts?.totalCost || 0\n      const haulOffCost = haulOffCosts?.totalCost || 0\n      const allCostsTotal = laborCost + materialsEquipmentCost + customCostTotal\n\n      // Profit calculations\n      const currentProfit = billable - allCostsTotal\n      const profitMargin = billable > 0 ? (currentProfit / billable) * 100 : 0\n\n      // Burn rate\n      const laborDays = laborCosts?.byDate?.length || 0\n      const materialsDays = materialsEquipmentByDateArray.length\n      const totalBurnDays = Math.max(laborDays, materialsDays)\n      const totalBurn = laborCost + materialsEquipmentCost\n      const dailyBurn = totalBurnDays > 0 ? totalBurn / totalBurnDays : 0\n\n      // Schedule insights\n      const scheduleInsights = calculateScheduleInsights(\n        { ...project, progress },\n        laborCosts?.totalManDays || 0\n      )\n\n      // Crew analytics from check-in history\n      const crewByDate = {}\n      const uniqueWorkers = new Set()\n      ;(crewHistory || []).forEach(checkin => {\n        const workers = checkin.workers || []\n        crewByDate[checkin.check_in_date] = workers.length\n        workers.forEach(w => uniqueWorkers.add(w.name?.toLowerCase()))\n      })\n      const crewDates = Object.keys(crewByDate).sort()\n      const avgCrewSize = crewDates.length > 0\n        ? Math.round(crewDates.reduce((sum, d) => sum + crewByDate[d], 0) / crewDates.length * 10) / 10\n        : 0\n      const peakCrewSize = crewDates.length > 0\n        ? Math.max(...crewDates.map(d => crewByDate[d]))\n        : 0\n      // Crew trend: compare last 7 days avg to prior 7 days avg\n      const recentCrewDates = crewDates.slice(-7)\n      const priorCrewDates = crewDates.slice(-14, -7)\n      const recentCrewAvg = recentCrewDates.length > 0\n        ? recentCrewDates.reduce((s, d) => s + crewByDate[d], 0) / recentCrewDates.length\n        : 0\n      const priorCrewAvg = priorCrewDates.length > 0\n        ? priorCrewDates.reduce((s, d) => s + crewByDate[d], 0) / priorCrewDates.length\n        : 0\n\n      // Material request analytics\n      const pendingMaterialRequests = (materialRequests || []).filter(r => r.status === 'pending').length\n      const orderedMaterialRequests = (materialRequests || []).filter(r => r.status === 'ordered').length\n      const deliveredMaterialRequests = (materialRequests || []).filter(r => r.status === 'delivered').length\n      const urgentMaterialRequests = (materialRequests || []).filter(r => r.priority === 'urgent' && r.status === 'pending').length\n\n      // Daily report field notes analysis\n      const reportsWithIssues = dailyReports.filter(r => r.issues && r.issues.trim().length > 0).length\n      const totalPhotosFromTickets = tickets.reduce((sum, t) => sum + (t.photos?.length || 0), 0)\n\n      // Disposal totals from weekly data\n      const disposalTotalLoads = (weeklyDisposal || []).reduce((sum, w) => {\n        return sum + (w.concrete || 0) + (w.trash || 0) + (w.metals || 0) + (w.hazardous_waste || 0)\n      }, 0)\n\n      // Days since last injury\n      const lastInjuryDate = injuryReports.length > 0\n        ? new Date(injuryReports[0]?.incident_date || injuryReports[0]?.created_at)\n        : null\n      const daysSinceLastInjury = lastInjuryDate\n        ? Math.floor((new Date() - lastInjuryDate) / (1000 * 60 * 60 * 24))\n        : null\n\n      // Task completion velocity: areas completed in last 14 days vs prior 14 days\n      const completedAreas = projectAreas.filter(a => a.status === 'done')\n\n      const enhancedData = {\n        ...project,\n        areas: projectAreas,\n        progress,\n        billable,\n        changeOrderValue,\n        revisedContractValue,\n        changeOrderPending: changeOrderData?.pendingCount || 0,\n        totalTickets: tickets.length,\n        pendingTickets,\n        approvedTickets: tickets.filter(t => t.status === 'approved').length,\n        tmTickets: tickets,\n        dailyReportsCount: dailyReports.length,\n        recentDailyReports,\n        injuryReportsCount: injuryReports.length,\n        lastDailyReport: dailyReports[0]?.report_date || null,\n        isValueBased: progressData.isValueBased,\n        earnedValue: progressData.earnedValue,\n        totalSOVValue: progressData.totalValue,\n        laborCost,\n        laborDaysWorked: laborDays,\n        laborManDays: laborCosts?.totalManDays || 0,\n        laborByDate: laborCosts?.byDate || [],\n        dailyBurn,\n        materialsEquipmentCost,\n        materialsEquipmentByDate: materialsEquipmentByDateArray,\n        haulOffCost,\n        haulOffLoads: haulOffCosts?.totalLoads || 0,\n        haulOffDays: haulOffCosts?.daysWithHaulOff || 0,\n        haulOffByType: haulOffCosts?.byWasteType || {},\n        haulOffByDate: haulOffCosts?.byDate || [],\n        customCosts,\n        customCostTotal,\n        totalBurn,\n        totalBurnDays,\n        allCostsTotal,\n        currentProfit,\n        profitMargin,\n        corPendingValue: corStats?.total_pending_value || 0,\n        corPendingCount: corStats?.pending_count || 0,\n        corApprovedValue: corStats?.total_approved_value || 0,\n        corBilledValue: corStats?.total_billed_value || 0,\n        corTotalCount: corStats?.total_cors || 0,\n        corStats: corStats,\n        scheduleStatus: scheduleInsights.scheduleStatus,\n        scheduleVariance: scheduleInsights.scheduleVariance,\n        scheduleLabel: scheduleInsights.scheduleLabel,\n        laborStatus: scheduleInsights.laborStatus,\n        laborVariance: scheduleInsights.laborVariance,\n        laborLabel: scheduleInsights.laborLabel,\n        hasScheduleData: scheduleInsights.hasScheduleData,\n        hasLaborData: scheduleInsights.hasLaborData,\n        actualManDays: laborCosts?.totalManDays || 0,\n        // Crew analytics\n        crewHistory: crewHistory || [],\n        crewByDate,\n        uniqueWorkerCount: uniqueWorkers.size,\n        avgCrewSize,\n        peakCrewSize,\n        crewDaysTracked: crewDates.length,\n        crewTrend: priorCrewAvg > 0 ? ((recentCrewAvg - priorCrewAvg) / priorCrewAvg * 100) : 0,\n        recentCrewAvg,\n        // Material requests\n        materialRequests: materialRequests || [],\n        pendingMaterialRequests,\n        orderedMaterialRequests,\n        deliveredMaterialRequests,\n        urgentMaterialRequests,\n        totalMaterialRequests: (materialRequests || []).length,\n        // Field activity insights\n        reportsWithIssues,\n        totalPhotosFromTickets,\n        dailyReports,\n        // Disposal trends\n        weeklyDisposal: weeklyDisposal || [],\n        disposalTotalLoads,\n        // Safety analytics\n        daysSinceLastInjury,\n        injuryReports,\n        oshaRecordable: injuryReports.filter(r => r.osha_recordable).length,\n        // Completion\n        completedAreasCount: completedAreas.length,\n        hasError: false,\n        _detailsLoaded: true\n      }\n\n      // Cache the enhanced data\n      projectDetailsCacheRef.current.set(cacheKey, {\n        data: enhancedData,\n        timestamp: Date.now()\n      })\n\n      return enhancedData\n    } catch (error) {\n      console.error(`Error loading details for project ${project.id}:`, error)\n      return { ...project, hasError: true, _detailsLoaded: false }\n    }\n  }\n\n  // OPTIMIZED: Load projects with summary data only (1 query instead of 9N)\n  // Detailed data is loaded on-demand when a project is selected\n  const loadProjects = async () => {\n    try {\n      // Single optimized query for all project summaries\n      const data = await db.getProjectDashboardSummary(company?.id)\n      setProjects(data)\n\n      // Create lightweight enhanced data using ONLY summary metrics from the RPC\n      // This uses data already returned from getProjectDashboardSummary (no additional queries!)\n      // Detailed data is loaded on-demand via loadProjectDetails when a project is selected\n      const enhanced = data.map(project => {\n        // Check if we have cached detailed data for this project\n        const cached = projectDetailsCacheRef.current.get(project.id)\n        if (cached && (Date.now() - cached.timestamp) < CACHE_TTL_MS) {\n          // Use cached detailed data if still valid\n          return cached.data\n        }\n\n        // Use summary data from RPC (no additional queries needed)\n        // Progress is estimated from area counts in the summary\n        const totalAreas = project.areaCount || 0\n        const completedAreas = project.completedAreas || 0\n        const progress = totalAreas > 0 ? Math.round((completedAreas / totalAreas) * 100) : 0\n\n        return {\n          ...project,\n          // Basic metrics from summary (already loaded)\n          progress,\n          areas: [], // Loaded on-demand when project selected\n          totalTickets: project.ticketCount || 0,\n          pendingTickets: project.pendingTicketCount || 0,\n          approvedTickets: project.approvedTicketCount || 0,\n          dailyReportsCount: project.dailyReportsThisWeek || 0,\n          recentDailyReports: project.dailyReportsThisWeek || 0,\n          corTotalCount: project.corCount || 0,\n          // Placeholder values - loaded on-demand when selected\n          billable: 0,\n          changeOrderValue: 0,\n          revisedContractValue: project.contract_value || 0,\n          changeOrderPending: 0,\n          tmTickets: [],\n          injuryReportsCount: 0,\n          lastDailyReport: null,\n          isValueBased: false,\n          earnedValue: 0,\n          totalSOVValue: 0,\n          laborCost: 0,\n          laborDaysWorked: 0,\n          laborManDays: 0,\n          laborByDate: [],\n          dailyBurn: 0,\n          materialsEquipmentCost: 0,\n          materialsEquipmentByDate: [],\n          haulOffCost: 0,\n          haulOffLoads: 0,\n          haulOffDays: 0,\n          haulOffByType: {},\n          haulOffByDate: [],\n          customCosts: [],\n          customCostTotal: 0,\n          totalBurn: 0,\n          totalBurnDays: 0,\n          allCostsTotal: 0,\n          currentProfit: 0,\n          profitMargin: 0,\n          corPendingValue: 0,\n          corPendingCount: 0,\n          corApprovedValue: 0,\n          corBilledValue: 0,\n          corStats: null,\n          scheduleStatus: 'on_track',\n          scheduleVariance: 0,\n          scheduleLabel: 'On Track',\n          laborStatus: 'on_track',\n          laborVariance: 0,\n          laborLabel: null,\n          hasScheduleData: false,\n          hasLaborData: false,\n          actualManDays: 0,\n          hasError: false,\n          _detailsLoaded: false // Flag to indicate detailed data needs loading\n        }\n      })\n      setProjectsData(enhanced)\n    } catch (error) {\n      console.error('Error loading projects:', error)\n      onShowToast('Error loading projects', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const loadAreas = async (projectId) => {\n    try {\n      const data = await db.getAreas(projectId)\n      setAreas(data)\n    } catch (error) {\n      console.error('Error loading areas:', error)\n    }\n  }\n\n  const handleSelectProject = async (project) => {\n    // Set the project immediately for responsive UI\n    setSelectedProject(project)\n\n    // If detailed data hasn't been loaded yet, load it now (lazy loading)\n    if (!project._detailsLoaded) {\n      const detailedProject = await loadProjectDetails(project)\n\n      // Update projectsData with the detailed version\n      setProjectsData(prev => prev.map(p =>\n        p.id === project.id ? detailedProject : p\n      ))\n\n      // Update selectedProject with detailed data\n      setSelectedProject(detailedProject)\n    }\n  }\n\n  const handleBack = () => {\n    setSelectedProject(null)\n    setAreas([])\n    setEditMode(false)\n    setEditData(null)\n    setActiveProjectTab('overview')\n    loadProjects()\n  }\n\n  const handleEditClick = () => {\n    setEditData({\n      name: selectedProject.name,\n      job_number: selectedProject.job_number || '',\n      address: selectedProject.address || '',\n      general_contractor: selectedProject.general_contractor || '',\n      client_contact: selectedProject.client_contact || '',\n      client_phone: selectedProject.client_phone || '',\n      contract_value: selectedProject.contract_value,\n      work_type: selectedProject.work_type || 'demolition',\n      job_type: selectedProject.job_type || 'standard',\n      pin: selectedProject.pin || '',\n      default_dump_site_id: selectedProject.default_dump_site_id || '',\n      areas: areas.map(a => ({\n        id: a.id,\n        name: a.name,\n        weight: a.weight,\n        isNew: false\n      }))\n    })\n    setEditMode(true)\n  }\n\n  const handleCancelEdit = () => {\n    setEditMode(false)\n    setEditData(null)\n  }\n\n  const handleEditChange = (field, value) => {\n    setEditData(prev => ({ ...prev, [field]: value }))\n  }\n\n  const handleAreaEditChange = (index, field, value) => {\n    setEditData(prev => ({\n      ...prev,\n      areas: prev.areas.map((area, i) => \n        i === index ? { ...area, [field]: value } : area\n      )\n    }))\n  }\n\n  const handleAddArea = () => {\n    setEditData(prev => ({\n      ...prev,\n      areas: [...prev.areas, { id: null, name: '', weight: '', isNew: true }]\n    }))\n  }\n\n  const handleRemoveArea = (index) => {\n    if (editData.areas.length > 1) {\n      setEditData(prev => ({\n        ...prev,\n        areas: prev.areas.filter((_, i) => i !== index)\n      }))\n    }\n  }\n\n  const handleSaveEdit = async () => {\n    // Validation\n    if (!editData.name.trim()) {\n      onShowToast('Please enter a project name', 'error')\n      return\n    }\n\n    const contractVal = parseFloat(editData.contract_value)\n    if (!contractVal || contractVal <= 0) {\n      onShowToast('Please enter a valid contract value', 'error')\n      return\n    }\n\n    if (editData.pin && editData.pin.length !== 4) {\n      onShowToast('PIN must be 4 digits', 'error')\n      return\n    }\n\n    // Check PIN availability if changed\n    if (editData.pin && editData.pin !== selectedProject.pin) {\n      const pinAvailable = await db.isPinAvailable(editData.pin, selectedProject.id)\n      if (!pinAvailable) {\n        onShowToast('This PIN is already in use', 'error')\n        return\n      }\n    }\n\n    const validAreas = editData.areas.filter(a => a.name.trim() && parseFloat(a.weight) > 0)\n    if (validAreas.length === 0) {\n      onShowToast('Please add at least one area', 'error')\n      return\n    }\n\n    const totalWeight = validAreas.reduce((sum, a) => sum + parseFloat(a.weight), 0)\n    if (totalWeight !== 100) {\n      onShowToast('Area weights must total 100%', 'error')\n      return\n    }\n\n    setSaving(true)\n\n    try {\n      // Update project - include company.id for cross-tenant security\n      await db.updateProject(selectedProject.id, {\n        name: editData.name.trim(),\n        job_number: editData.job_number?.trim() || null,\n        address: editData.address?.trim() || null,\n        general_contractor: editData.general_contractor?.trim() || null,\n        client_contact: editData.client_contact?.trim() || null,\n        client_phone: editData.client_phone?.trim() || null,\n        contract_value: contractVal,\n        work_type: editData.work_type || 'demolition',\n        job_type: editData.job_type || 'standard',\n        pin: editData.pin || null,\n        default_dump_site_id: editData.default_dump_site_id || null\n      }, company?.id)\n\n      // Handle areas\n      const existingAreaIds = areas.map(a => a.id)\n      const editAreaIds = editData.areas.filter(a => a.id).map(a => a.id)\n\n      // Delete removed areas\n      for (const areaId of existingAreaIds) {\n        if (!editAreaIds.includes(areaId)) {\n          await db.deleteArea(areaId)\n        }\n      }\n\n      // Update or create areas\n      for (let i = 0; i < validAreas.length; i++) {\n        const area = validAreas[i]\n        if (area.id) {\n          // Update existing\n          await db.updateArea(area.id, {\n            name: area.name.trim(),\n            weight: parseFloat(area.weight),\n            sort_order: i\n          })\n        } else {\n          // Create new\n          await db.createArea({\n            project_id: selectedProject.id,\n            name: area.name.trim(),\n            weight: parseFloat(area.weight),\n            status: 'not_started',\n            sort_order: i\n          })\n        }\n      }\n\n      // Reload data\n      const updatedProject = await db.getProject(selectedProject.id)\n      setSelectedProject(updatedProject)\n      await loadAreas(selectedProject.id)\n      \n      setEditMode(false)\n      setEditData(null)\n      onShowToast('Project updated!', 'success')\n    } catch (error) {\n      console.error('Error saving project:', error?.message || error)\n      onShowToast(error?.message || 'Error saving changes', 'error')\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const handleDeleteProject = async () => {\n    if (!confirm('Are you sure you want to delete this project? This cannot be undone.')) {\n      return\n    }\n\n    try {\n      await db.deleteProject(selectedProject.id)\n      onShowToast('Project deleted', 'success')\n      handleBack()\n    } catch (error) {\n      console.error('Error deleting project:', error)\n      onShowToast('Error deleting project', 'error')\n    }\n  }\n\n  // Memoize selected project data lookup to avoid repeated finds\n  // NOTE: All hooks must be before any conditional returns (React rules of hooks)\n  const projectData = useMemo(() => {\n    if (!selectedProject) return null\n    return projectsData.find(p => p.id === selectedProject.id)\n  }, [selectedProject, projectsData])\n\n  // Memoize progress calculations - these are expensive and only change when areas change\n  const progressCalculations = useMemo(() => {\n    if (!selectedProject) {\n      return { progress: 0, billable: 0, isValueBased: false, earnedValue: 0, totalSOVValue: 0, changeOrderValue: 0, revisedContractValue: 0 }\n    }\n\n    // Calculate progress - use SOV values if available\n    const progressData = calculateValueProgress(areas)\n    const progress = progressData.progress\n\n    // Get change order data from enhanced project data\n    const changeOrderValue = projectData?.changeOrderValue || 0\n    const revisedContractValue = selectedProject.contract_value + changeOrderValue\n\n    // Billable: use actual earned value from SOV if available\n    const billable = progressData.isValueBased\n      ? progressData.earnedValue\n      : (progress / 100) * revisedContractValue\n\n    return {\n      progress,\n      billable,\n      changeOrderValue,\n      revisedContractValue,\n      isValueBased: progressData.isValueBased,\n      earnedValue: progressData.earnedValue,\n      totalSOVValue: progressData.totalValue\n    }\n  }, [selectedProject, areas, projectData])\n\n  // Memoize portfolio-level metrics to avoid recalculating on every render\n  // These only change when projectsData changes (after data loads or real-time updates)\n  const portfolioMetrics = useMemo(() => {\n    const totalOriginalContract = projectsData.reduce((sum, p) => sum + (p.contract_value || 0), 0)\n    const totalChangeOrders = projectsData.reduce((sum, p) => sum + (p.changeOrderValue || 0), 0)\n    const totalPortfolioValue = totalOriginalContract + totalChangeOrders\n    const totalEarned = projectsData.reduce((sum, p) => sum + (p.billable || 0), 0)\n    const totalRemaining = totalPortfolioValue - totalEarned\n\n    // Weighted completion (by contract value, not simple average)\n    const weightedCompletion = totalPortfolioValue > 0\n      ? Math.round((totalEarned / totalPortfolioValue) * 100)\n      : 0\n\n    // Pending COR metrics (unapproved extra work value)\n    const totalPendingCORValue = projectsData.reduce((sum, p) => sum + (p.corPendingValue || 0), 0)\n    const totalPendingCORCount = projectsData.reduce((sum, p) => sum + (p.corPendingCount || 0), 0)\n\n    return {\n      totalOriginalContract,\n      totalChangeOrders,\n      totalPortfolioValue,\n      totalEarned,\n      totalRemaining,\n      weightedCompletion,\n      totalPendingCORValue,\n      totalPendingCORCount\n    }\n  }, [projectsData])\n\n  // Memoize project health breakdown separately (still derived from projectsData)\n  // Single pass through array instead of 5 separate filter operations\n  const projectHealth = useMemo(() => {\n    let complete = 0\n    let onTrack = 0\n    let atRisk = 0\n    let overBudget = 0\n    let withChangeOrders = 0\n\n    for (const p of projectsData) {\n      const contractVal = p.revisedContractValue || p.contract_value\n      if (p.progress >= 100) complete++\n      if (p.progress < 100 && p.billable <= contractVal * (p.progress / 100) * 1.1) onTrack++\n      if (p.billable > contractVal * 0.9 && p.progress < 90) atRisk++\n      if (p.billable > contractVal) overBudget++\n      if ((p.changeOrderValue || 0) > 0) withChangeOrders++\n    }\n\n    return {\n      projectsComplete: complete,\n      projectsOnTrack: onTrack,\n      projectsAtRisk: atRisk,\n      projectsOverBudget: overBudget,\n      projectsWithChangeOrders: withChangeOrders\n    }\n  }, [projectsData])\n\n  // Memoize schedule performance metrics\n  const scheduleMetrics = useMemo(() => {\n    let ahead = 0\n    let onTrack = 0\n    let behind = 0\n    let overLabor = 0\n    let underLabor = 0\n    let onTrackLabor = 0\n\n    for (const p of projectsData) {\n      if (p.hasScheduleData) {\n        if (p.scheduleStatus === 'ahead') ahead++\n        else if (p.scheduleStatus === 'behind') behind++\n        else onTrack++\n      }\n      if (p.hasLaborData) {\n        if (p.laborStatus === 'over') overLabor++\n        else if (p.laborStatus === 'under') underLabor++\n        else onTrackLabor++\n      }\n    }\n\n    return {\n      scheduleAhead: ahead,\n      scheduleOnTrack: onTrack,\n      scheduleBehind: behind,\n      laborOver: overLabor,\n      laborUnder: underLabor,\n      laborOnTrack: onTrackLabor,\n      hasAnyScheduleData: ahead + onTrack + behind > 0,\n      hasAnyLaborData: overLabor + underLabor + onTrackLabor > 0\n    }\n  }, [projectsData])\n\n  // Calculate risk scores and smart alerts for all projects\n  const riskAnalysis = useMemo(() => {\n    const projectRisks = projectsData.map(p => {\n      // Map project data to risk calculation format\n      const riskInput = {\n        id: p.id,\n        name: p.name,\n        totalCosts: p.totalCosts || 0,\n        earnedRevenue: p.billable || 0,\n        actualProgress: p.progress || 0,\n        expectedProgress: p.expectedProgress || p.progress, // Use actual if no planned\n        pendingCORValue: p.corPendingValue || 0,\n        contractValue: p.revisedContractValue || p.contract_value || 0,\n        lastReportDate: p.lastDailyReport,\n        recentInjuryCount: p.recentInjuryCount || 0,\n        startDate: p.start_date\n      }\n\n      const riskResult = calculateRiskScore(riskInput)\n      const alerts = generateSmartAlerts(riskResult, { ...riskInput, name: p.name })\n      const projections = calculateProjections(riskInput)\n\n      // Add project name to each alert\n      const alertsWithProject = alerts.map(a => ({\n        ...a,\n        projectName: p.name,\n        projectId: p.id\n      }))\n\n      return {\n        projectId: p.id,\n        projectName: p.name,\n        riskScore: riskResult.score,\n        riskStatus: riskResult.status,\n        riskLabel: riskResult.label,\n        factors: riskResult.factors,\n        alerts: alertsWithProject,\n        projections\n      }\n    })\n\n    // Aggregate all alerts across projects, sorted by priority\n    const allAlerts = projectRisks\n      .flatMap(p => p.alerts)\n      .sort((a, b) => {\n        const priority = { critical: 0, warning: 1, info: 2 }\n        return priority[a.type] - priority[b.type]\n      })\n\n    return {\n      projectRisks,\n      allAlerts,\n      criticalCount: allAlerts.filter(a => a.type === 'critical').length,\n      warningCount: allAlerts.filter(a => a.type === 'warning').length\n    }\n  }, [projectsData])\n\n  // Handler for alert actions\n  const handleAlertAction = useCallback(({ target, projectId, alert }) => {\n    const project = projects.find(p => p.id === projectId)\n    if (project) {\n      setSelectedProject(project)\n      // Navigate to appropriate tab based on action target\n      if (target === 'financials') {\n        setActiveProjectTab('financials')\n      } else if (target === 'reports') {\n        setActiveProjectTab('reports')\n      } else if (target === 'cors') {\n        setActiveProjectTab('financials')\n        setFinancialsSection('cors')\n      } else {\n        setActiveProjectTab('overview')\n      }\n    }\n  }, [projects])\n\n  // Auto-archive projects that have been complete for 30+ days\n  useEffect(() => {\n    const checkAutoArchive = async () => {\n      for (const project of projectsData) {\n        if (shouldAutoArchive(project, 30)) {\n          try {\n            await db.archiveProject(project.id)\n            onShowToast(`Project \"${project.name}\" has been auto-archived after 30 days of completion`, 'info')\n          } catch (error) {\n            console.error('Failed to auto-archive project:', error)\n          }\n        }\n      }\n    }\n\n    if (projectsData.length > 0) {\n      checkAutoArchive()\n    }\n  }, []) // Only run on mount\n\n  // Memoized callbacks for child components to prevent unnecessary re-renders\n  const handleAddEquipment = useCallback(() => {\n    setEditingEquipment(null)\n    setShowEquipmentModal(true)\n  }, [])\n\n  const handleEditEquipment = useCallback((item) => {\n    setEditingEquipment(item)\n    setShowEquipmentModal(true)\n  }, [])\n\n  const handleCreateDraw = useCallback(() => {\n    setEditingDrawRequest(null)\n    setShowDrawRequestModal(true)\n  }, [])\n\n  const handleViewDraw = useCallback((drawRequest) => {\n    setEditingDrawRequest(drawRequest)\n    setShowDrawRequestModal(true)\n  }, [])\n\n  const handleViewAllTickets = useCallback(() => {\n    setTMViewMode('full')\n  }, [])\n\n  const handleToggleFinancialsSidebar = useCallback(() => {\n    setFinancialsSidebarCollapsed(prev => !prev)\n  }, [])\n\n  const handleToggleMobileSidebar = useCallback(() => {\n    setFinancialsSidebarMobileOpen(prev => !prev)\n  }, [])\n\n  const handleCloseMobileSidebar = useCallback(() => {\n    setFinancialsSidebarMobileOpen(false)\n  }, [])\n\n  const handleToggleCORList = useCallback(() => {\n    setCORListExpanded(prev => !prev)\n  }, [])\n\n  // Field document export handler\n  const handleExportFieldDocuments = useCallback(async (type = 'all') => {\n    if (!selectedProject) return\n    onShowToast('Gathering field data...', 'info')\n    try {\n      const [dailyReports, injuryReports, crewCheckins] = await Promise.all([\n        db.getDailyReports(selectedProject.id, 365),\n        db.getInjuryReports(selectedProject.id),\n        db.getCrewCheckinHistory(selectedProject.id, 365)\n      ])\n\n      if (type === 'daily') {\n        await exportDailyReportsPDF(dailyReports || [], selectedProject)\n      } else if (type === 'incidents') {\n        await exportIncidentReportsPDF(injuryReports || [], selectedProject)\n      } else if (type === 'crew') {\n        await exportCrewCheckinsPDF(crewCheckins || [], selectedProject)\n      } else {\n        await exportAllFieldDocumentsPDF({\n          dailyReports: dailyReports || [],\n          incidentReports: injuryReports || [],\n          crewCheckins: crewCheckins || [],\n          project: selectedProject\n        })\n      }\n      onShowToast('PDF exported!', 'success')\n    } catch (error) {\n      console.error('Error exporting field documents:', error)\n      onShowToast('Error generating PDF', 'error')\n    }\n  }, [selectedProject, onShowToast])\n\n  const handleBackToTMPreview = useCallback(() => {\n    setTMViewMode('preview')\n  }, [])\n\n  const handleViewFullCORLog = useCallback(() => {\n    setCORDisplayMode('log')\n  }, [])\n\n  const handleCreateCOR = useCallback(() => {\n    setEditingCOR(null)\n    setShowCORForm(true)\n  }, [])\n\n  const handleViewCOR = useCallback((cor) => {\n    setViewingCOR(cor)\n    setShowCORDetail(true)\n  }, [])\n\n  const handleEditCOR = useCallback((cor) => {\n    setEditingCOR(cor)\n    setShowCORForm(true)\n  }, [])\n\n  const handleAddCost = useCallback(() => {\n    setShowAddCostModal(true)\n  }, [])\n\n  const handleDeleteCost = useCallback(async (costId) => {\n    try {\n      await db.deleteProjectCost(costId)\n      loadProjects()\n      onShowToast?.('Cost deleted', 'success')\n    } catch (err) {\n      onShowToast?.('Error deleting cost', 'error')\n    }\n  }, []) // onShowToast is stable (memoized in App.jsx)\n\n  // Memoize stats for FinancialsNav to prevent re-renders from inline object creation\n  const financialsNavStats = useMemo(() => ({\n    corCount: projectData?.corStats?.total || 0,\n    ticketCount: projectData?.totalTickets || 0,\n    corPending: projectData?.corStats?.pending || 0,\n    ticketPending: projectData?.pendingTickets || 0\n  }), [projectData?.corStats?.total, projectData?.totalTickets, projectData?.corStats?.pending, projectData?.pendingTickets])\n\n  // Destructure memoized values for cleaner usage below\n  const { totalOriginalContract, totalChangeOrders, totalPortfolioValue, totalEarned, totalRemaining, weightedCompletion, totalPendingCORValue, totalPendingCORCount } = portfolioMetrics\n  const { projectsComplete, projectsOnTrack, projectsAtRisk, projectsOverBudget, projectsWithChangeOrders } = projectHealth\n  const { scheduleAhead, scheduleOnTrack, scheduleBehind, laborOver, laborUnder, laborOnTrack, hasAnyScheduleData, hasAnyLaborData } = scheduleMetrics\n\n  if (loading) {\n    return (\n      <div className=\"loading\">\n        <div className=\"spinner\"></div>\n        Loading projects...\n      </div>\n    )\n  }\n\n  // Project Detail View\n  if (selectedProject) {\n    // Extract memoized values\n    const { progress, billable, changeOrderValue, revisedContractValue, isValueBased, earnedValue, totalSOVValue } = progressCalculations\n\n    // Edit Mode\n    if (editMode && editData) {\n      const totalWeight = editData.areas.reduce((sum, a) => sum + (parseFloat(a.weight) || 0), 0)\n\n      return (\n        <div>\n          <button className=\"btn btn-secondary btn-small\" onClick={handleCancelEdit} style={{ marginBottom: '1.5rem' }}>\n             Cancel\n          </button>\n\n          <h1>Edit Project</h1>\n          <p className=\"subtitle\">Update project details</p>\n\n          {/* Basic Info */}\n          <div className=\"card\">\n            <h3>Basic Info</h3>\n            <div className=\"form-row\">\n              <div className=\"form-group\" style={{ flex: 2 }}>\n                <label>Project Name *</label>\n                <input\n                  type=\"text\"\n                  value={editData.name}\n                  onChange={(e) => handleEditChange('name', e.target.value)}\n                  placeholder=\"e.g., Downtown Office Demolition\"\n                />\n              </div>\n              <div className=\"form-group\" style={{ flex: 1 }}>\n                <label>Job Number</label>\n                <input\n                  type=\"text\"\n                  value={editData.job_number}\n                  onChange={(e) => handleEditChange('job_number', e.target.value)}\n                  placeholder=\"e.g., 2024-001\"\n                />\n              </div>\n            </div>\n\n            <div className=\"form-group\">\n              <label>Project Address</label>\n              <input\n                type=\"text\"\n                value={editData.address}\n                onChange={(e) => handleEditChange('address', e.target.value)}\n                placeholder=\"123 Main St, City, State 12345\"\n              />\n            </div>\n          </div>\n\n          {/* Client & Contractor Info */}\n          <div className=\"card\">\n            <h3>Client & Contractor</h3>\n            <div className=\"form-group\">\n              <label>General Contractor</label>\n              <input\n                type=\"text\"\n                value={editData.general_contractor}\n                onChange={(e) => handleEditChange('general_contractor', e.target.value)}\n                placeholder=\"e.g., ABC Construction\"\n              />\n            </div>\n\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Client Contact</label>\n                <input\n                  type=\"text\"\n                  value={editData.client_contact}\n                  onChange={(e) => handleEditChange('client_contact', e.target.value)}\n                  placeholder=\"Contact name\"\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Client Phone</label>\n                <input\n                  type=\"tel\"\n                  value={editData.client_phone}\n                  onChange={(e) => handleEditChange('client_phone', e.target.value)}\n                  placeholder=\"(555) 123-4567\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Financial & Project Settings */}\n          <div className=\"card\">\n            <h3>Financials & Settings</h3>\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Contract Value ($) *</label>\n                <input\n                  type=\"number\"\n                  value={editData.contract_value}\n                  onChange={(e) => handleEditChange('contract_value', e.target.value)}\n                  placeholder=\"0\"\n                />\n              </div>\n              <div className=\"form-group\">\n                <label>Foreman PIN</label>\n                <input\n                  type=\"text\"\n                  value={editData.pin}\n                  onChange={(e) => handleEditChange('pin', e.target.value.replace(/\\D/g, '').slice(0, 4))}\n                  placeholder=\"4 digits\"\n                  maxLength={4}\n                />\n                <span className=\"form-hint\">Used for field crew access</span>\n              </div>\n            </div>\n\n            <div className=\"form-row\">\n              <div className=\"form-group\">\n                <label>Work Type</label>\n                <select\n                  value={editData.work_type}\n                  onChange={(e) => handleEditChange('work_type', e.target.value)}\n                >\n                  <option value=\"demolition\">Demolition</option>\n                  <option value=\"environmental\">Environmental</option>\n                </select>\n                <span className=\"form-hint\">Affects labor rate calculations</span>\n              </div>\n              <div className=\"form-group\">\n                <label>Job Type</label>\n                <select\n                  value={editData.job_type}\n                  onChange={(e) => handleEditChange('job_type', e.target.value)}\n                >\n                  <option value=\"standard\">Standard</option>\n                  <option value=\"prevailing_wage\">Prevailing Wage</option>\n                </select>\n              </div>\n            </div>\n\n            <div className=\"form-group\">\n              <label>Default Dump Site</label>\n              <select\n                value={editData.default_dump_site_id}\n                onChange={(e) => handleEditChange('default_dump_site_id', e.target.value)}\n              >\n                <option value=\"\">-- Select Dump Site --</option>\n                {dumpSites.map(site => (\n                  <option key={site.id} value={site.id}>{site.name}</option>\n                ))}\n              </select>\n              <span className=\"form-hint\">Used for haul-off tracking and cost estimates</span>\n            </div>\n          </div>\n\n          <div className=\"card\">\n            <h3>Areas</h3>\n            <p style={{ color: 'var(--text-secondary)', fontSize: '0.9rem', marginBottom: '1rem' }}>\n              Weights must total 100%.\n            </p>\n\n            {editData.areas.map((area, index) => (\n              <div key={index} className=\"area-row\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Area name\"\n                  value={area.name}\n                  onChange={(e) => handleAreaEditChange(index, 'name', e.target.value)}\n                />\n                <input\n                  type=\"number\"\n                  placeholder=\"%\"\n                  value={area.weight}\n                  onChange={(e) => handleAreaEditChange(index, 'weight', e.target.value)}\n                />\n                <button className=\"remove-btn\" onClick={() => handleRemoveArea(index)}>\n                  \n                </button>\n              </div>\n            ))}\n\n            <div className=\"weight-total\">\n              <span className=\"weight-total-label\">Total Weight:</span>\n              <span className={`weight-total-value ${totalWeight === 100 ? 'valid' : 'invalid'}`}>\n                {totalWeight}%\n              </span>\n            </div>\n\n            <button className=\"btn btn-secondary\" onClick={handleAddArea}>\n              + Add Area\n            </button>\n          </div>\n\n          <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem' }}>\n            <button \n              className=\"btn btn-primary\" \n              onClick={handleSaveEdit}\n              disabled={saving}\n              style={{ flex: 1 }}\n            >\n              {saving ? 'Saving...' : 'Save Changes'}\n            </button>\n          </div>\n\n          <button \n            className=\"btn btn-danger btn-full\" \n            onClick={handleDeleteProject}\n          >\n            Delete Project\n          </button>\n        </div>\n      )\n    }\n\n    // View Mode - Calculate additional metrics for context\n    const areasComplete = areas.filter(a => a.status === 'done').length\n    const areasWorking = areas.filter(a => a.status === 'working').length\n    const areasNotStarted = areas.filter(a => a.status === 'not_started').length\n    const percentBilled = revisedContractValue > 0\n      ? Math.round((billable / revisedContractValue) * 100)\n      : 0\n    const hasChangeOrders = changeOrderValue > 0\n\n    // Tab definitions with pending badges\n    const pendingCount = (projectData?.pendingTickets || 0) + (projectData?.changeOrderPending || 0)\n    const tabs = [\n      { id: 'overview', label: 'Overview', Icon: LayoutGrid },\n      { id: 'financials', label: 'Financials', Icon: DollarSign, badge: pendingCount },\n      { id: 'reports', label: 'Reports', Icon: ClipboardList },\n      { id: 'documents', label: 'Documents', Icon: FolderOpen },\n      { id: 'info', label: 'Info', Icon: Info }\n    ]\n\n    return (\n      <div className=\"project-view tabbed\">\n        {/* Sticky Header */}\n        <div className=\"pv-sticky-header\">\n          {/* Top Row - Back + Actions */}\n          <div className=\"pv-header-row\">\n            <button className=\"pv-back\" onClick={handleBack}>\n              <span></span>\n              <span>Back</span>\n            </button>\n            <div className=\"pv-actions\">\n              <button className=\"pv-action\" onClick={() => setShowShareModal(true)}>Share</button>\n              <button className=\"pv-action\" onClick={() => setShowNotificationSettings(true)}>Alerts</button>\n              <button className=\"pv-action\" onClick={handleEditClick}>Edit</button>\n            </div>\n          </div>\n\n          {/* Project Title */}\n          <div className=\"pv-header-title\">\n            <h1>{selectedProject.name}</h1>\n            {(selectedProject.job_number || selectedProject.work_type) && (\n              <span className=\"pv-header-meta\">\n                {selectedProject.job_number && `Job #${selectedProject.job_number}`}\n                {selectedProject.job_number && selectedProject.work_type && '  '}\n                {selectedProject.work_type}\n              </span>\n            )}\n          </div>\n\n          {/* Key Metrics Bar */}\n          <div className=\"pv-metrics-bar\">\n            <div className=\"pv-metric\">\n              <span className=\"pv-metric-value\">{progress}%</span>\n              <span className=\"pv-metric-label\">Complete</span>\n            </div>\n            <div className=\"pv-metric-divider\"></div>\n            <div className=\"pv-metric\">\n              <span className=\"pv-metric-value\">{formatCurrency(billable)}</span>\n              <span className=\"pv-metric-label\">Billed</span>\n            </div>\n            <div className=\"pv-metric-divider\"></div>\n            <div className=\"pv-metric\">\n              <span className=\"pv-metric-value highlight\">{formatCurrency(revisedContractValue - billable)}</span>\n              <span className=\"pv-metric-label\">Remaining</span>\n            </div>\n          </div>\n\n          {/* Tab Navigation */}\n          <div className=\"pv-tabs\">\n            {tabs.map(tab => (\n              <button\n                key={tab.id}\n                className={`pv-tab ${activeProjectTab === tab.id ? 'active' : ''} ${tab.badge > 0 ? 'has-badge' : ''}`}\n                onClick={() => setActiveProjectTab(tab.id)}\n              >\n                <tab.Icon size={16} className=\"pv-tab-icon\" />\n                <span className=\"pv-tab-label\">{tab.label}</span>\n                {tab.badge > 0 && (\n                  <span className=\"pv-tab-badge\">{tab.badge}</span>\n                )}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Tab Content */}\n        <div className=\"pv-tab-content\">\n          {/* OVERVIEW TAB */}\n          {activeProjectTab === 'overview' && (\n            <div className=\"pv-tab-panel overview-tab animate-fade-in\">\n              {/* Row 1: Hero - Progress + Financials */}\n              <div className=\"overview-hero-split\">\n                <OverviewProgressGauge\n                  progress={progress}\n                  areasComplete={areasComplete}\n                  totalAreas={areas.length}\n                  areasWorking={areasWorking}\n                />\n                <OverviewFinancialCard\n                  earnedRevenue={billable}\n                  totalCosts={projectData?.allCostsTotal || 0}\n                  laborCost={projectData?.laborCost || 0}\n                  disposalCost={projectData?.haulOffCost || 0}\n                  equipmentCost={projectData?.materialsEquipmentCost || 0}\n                  materialsCost={0}\n                  otherCost={projectData?.customCostTotal || 0}\n                  contractValue={revisedContractValue}\n                />\n              </div>\n\n              {/* Row 2: Two-column grid - Crew Metrics | Work Areas */}\n              <div className=\"overview-two-col\">\n                {/* Left: Crew On-Site */}\n                <OverviewCrewMetrics\n                  project={selectedProject}\n                  onShowToast={onShowToast}\n                />\n\n                {/* Right: Work Areas */}\n                <div className=\"overview-section-card overview-work-areas-card\">\n                  <div className=\"section-card-header\">\n                    <h3>Work Areas</h3>\n                    <div className=\"section-card-badges\">\n                      {areasComplete > 0 && <span className=\"section-badge done\">{areasComplete} Done</span>}\n                      {areasWorking > 0 && <span className=\"section-badge working\">{areasWorking} Active</span>}\n                      {areasNotStarted > 0 && <span className=\"section-badge pending\">{areasNotStarted} Pending</span>}\n                    </div>\n                  </div>\n                  <div className=\"work-areas-list work-areas-scroll stagger-areas\">\n                    {areas.map(area => (\n                      <div key={area.id} className={`work-area-item ${area.status}`}>\n                        <div className=\"work-area-status\">\n                          {area.status === 'done' && <span className=\"status-icon done\"></span>}\n                          {area.status === 'working' && <span className=\"status-icon working\"></span>}\n                          {area.status === 'not_started' && <span className=\"status-icon pending\"></span>}\n                        </div>\n                        <div className=\"work-area-info\">\n                          <span className=\"work-area-name\">{area.name}</span>\n                          <span className=\"work-area-weight\">\n                            {area.scheduled_value ? formatCurrency(area.scheduled_value) : `${area.weight}%`}\n                          </span>\n                        </div>\n                        <div className=\"work-area-bar\">\n                          <div\n                            className={`work-area-fill ${area.status}`}\n                            style={{ width: area.status === 'done' ? '100%' : area.status === 'working' ? '50%' : '0%' }}\n                          ></div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              </div>\n\n              {/* Row 3: Bottom strip - Attention + Quick Nav + Exports */}\n              <div className=\"overview-bottom-strip\">\n                {/* Attention items inline */}\n                {(projectData?.pendingTickets > 0 || projectData?.changeOrderPending > 0 || projectData?.pendingMaterialRequests > 0 || projectData?.urgentMaterialRequests > 0) && (\n                  <div className=\"overview-attention-inline\">\n                    {projectData?.urgentMaterialRequests > 0 && (\n                      <div className=\"attention-chip warning\" onClick={() => setActiveProjectTab('reports')}>\n                        <AlertTriangle size={14} />\n                        <span>{projectData.urgentMaterialRequests} urgent material request{projectData.urgentMaterialRequests !== 1 ? 's' : ''}</span>\n                      </div>\n                    )}\n                    {projectData?.pendingMaterialRequests > 0 && !projectData?.urgentMaterialRequests && (\n                      <div className=\"attention-chip info\" onClick={() => setActiveProjectTab('reports')}>\n                        <Package size={14} />\n                        <span>{projectData.pendingMaterialRequests} material request{projectData.pendingMaterialRequests !== 1 ? 's' : ''} pending</span>\n                      </div>\n                    )}\n                    {projectData?.pendingTickets > 0 && (\n                      <div className=\"attention-chip warning\" onClick={() => setActiveProjectTab('financials')}>\n                        <ClipboardList size={14} />\n                        <span>{projectData.pendingTickets} T&M pending</span>\n                      </div>\n                    )}\n                    {projectData?.changeOrderPending > 0 && (\n                      <div className=\"attention-chip info\" onClick={() => setActiveProjectTab('financials')}>\n                        <FileText size={14} />\n                        <span>{projectData.changeOrderPending} CO pending</span>\n                      </div>\n                    )}\n                  </div>\n                )}\n\n                {/* Quick nav + export buttons */}\n                <div className=\"overview-quick-actions\">\n                  <button className=\"overview-action-btn\" onClick={() => setActiveProjectTab('reports')}>\n                    <ClipboardList size={15} />\n                    <span>{projectData?.dailyReportsCount || 0} Reports</span>\n                  </button>\n                  <button className=\"overview-action-btn\" onClick={() => setActiveProjectTab('financials')}>\n                    <DollarSign size={15} />\n                    <span>{projectData?.totalTickets || 0} T&M Tickets</span>\n                  </button>\n                  <span className=\"overview-action-divider\" />\n                  <button className=\"overview-action-btn export\" onClick={() => handleExportFieldDocuments('all')}>\n                    <Download size={15} />\n                    <span>Export All Docs</span>\n                  </button>\n                  <button className=\"overview-action-btn export\" onClick={() => handleExportFieldDocuments('daily')}>\n                    <Download size={14} />\n                    <span>Daily</span>\n                  </button>\n                  <button className=\"overview-action-btn export\" onClick={() => handleExportFieldDocuments('incidents')}>\n                    <Download size={14} />\n                    <span>Incidents</span>\n                  </button>\n                  <button className=\"overview-action-btn export\" onClick={() => handleExportFieldDocuments('crew')}>\n                    <Download size={14} />\n                    <span>Crew</span>\n                  </button>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* FINANCIALS TAB */}\n          {activeProjectTab === 'financials' && (\n            <div className=\"pv-tab-panel financials-tab\">\n              {/* Export Actions */}\n              <div className=\"export-actions\" style={{ display: 'flex', gap: '8px', marginLeft: 'auto', marginBottom: '12px', justifyContent: 'flex-end' }}>\n                <button\n                  className=\"btn btn-ghost btn-small\"\n                  onClick={() => exportProjectFinancials(selectedProject, {\n                    earnedRevenue: billable,\n                    approvedCORs: projectData?.cors?.filter(c => c.status === 'approved'),\n                    laborByDate: projectData?.laborByDate,\n                    haulOffByDate: projectData?.haulOffByDate,\n                    customCosts: projectData?.customCosts\n                  })}\n                >\n                  <Download size={14} /> Export CSV\n                </button>\n                <button\n                  className=\"btn btn-ghost btn-small\"\n                  onClick={() => exportToQuickBooksIIF(selectedProject, {\n                    totalLaborCost: projectData?.totalLaborCost || 0,\n                    totalDisposalCost: projectData?.totalDisposalCost || 0\n                  })}\n                >\n                  <Download size={14} /> QuickBooks\n                </button>\n              </div>\n              {/* Key Metrics - Hero Section (Always visible) */}\n              <HeroMetrics\n                contractValue={selectedProject?.contract_value || 0}\n                earnedRevenue={billable}\n                totalCosts={projectData?.allCostsTotal || 0}\n                profit={projectData?.currentProfit || 0}\n                progress={progress}\n                corApprovedValue={changeOrderValue}\n                loading={!projectData}\n              />\n\n              {/* Split Layout with Collapsible Navigation */}\n              <div className={`financials-layout ${financialsSidebarCollapsed ? 'sidebar-collapsed' : ''}`}>\n                {/* Mobile Menu Toggle Button */}\n                <button\n                  className=\"financials-mobile-menu-toggle\"\n                  onClick={handleToggleMobileSidebar}\n                  aria-label=\"Open navigation menu\"\n                  title=\"Open navigation menu\"\n                >\n                  <Menu size={20} />\n                  <span>Menu</span>\n                </button>\n\n                {/* Mobile Overlay/Backdrop */}\n                {financialsSidebarMobileOpen && (\n                  <div\n                    className=\"financials-sidebar-overlay\"\n                    onClick={handleCloseMobileSidebar}\n                    aria-hidden=\"true\"\n                  />\n                )}\n\n                {/* Sidebar Navigation - Always visible, collapsible */}\n                <div className={`financials-sidebar ${financialsSidebarCollapsed ? 'collapsed' : ''} ${financialsSidebarMobileOpen ? 'mobile-open' : ''}`}>\n                  <FinancialsNav\n                    activeSection={financialsSection}\n                    onSectionChange={(section) => {\n                      setFinancialsSection(section)\n                      setFinancialsSidebarMobileOpen(false) // Close mobile sidebar when section changes\n                    }}\n                    collapsed={financialsSidebarCollapsed}\n                    onToggleCollapse={handleToggleFinancialsSidebar}\n                    onMobileClose={handleCloseMobileSidebar}\n                    stats={financialsNavStats}\n                  />\n                </div>\n\n                {/* Main Content Area */}\n                <div className=\"financials-main\">\n                  {/* OVERVIEW SECTION */}\n                  {financialsSection === 'overview' && (\n                    <div className=\"financials-overview animate-fade-in\">\n                      {/* Financial Trend Chart */}\n                      <FinancialTrendChart\n                        projectData={projectData}\n                        project={selectedProject}\n                        tmTickets={projectData?.tmTickets || []}\n                        corStats={projectData?.corStats}\n                        areas={areas}\n                      />\n\n                      {/* Burn Rate & Profitability Row */}\n                      <div className=\"financials-analysis-row stagger-children\">\n                        <BurnRateCard\n                          dailyBurn={projectData?.dailyBurn || 0}\n                          totalBurn={projectData?.totalBurn || 0}\n                          daysWorked={projectData?.totalBurnDays || 0}\n                          laborCost={projectData?.laborCost || 0}\n                          materialsEquipmentCost={projectData?.materialsEquipmentCost || 0}\n                          progress={progress}\n                          contractValue={revisedContractValue}\n                          laborByDate={projectData?.laborByDate || []}\n                          materialsEquipmentByDate={projectData?.materialsEquipmentByDate || []}\n                        />\n\n                        <ProfitabilityCard\n                          revenue={billable}\n                          totalCosts={projectData?.allCostsTotal || 0}\n                          contractValue={revisedContractValue}\n                          progress={progress}\n                        />\n                      </div>\n\n                      {/* Cost Contributors & Disposal Summary Side-by-Side */}\n                      <div className=\"cost-disposal-row\">\n                        <CostContributorsCard\n                          laborCost={projectData?.laborCost || 0}\n                          haulOffCost={projectData?.haulOffCost || 0}\n                          customCosts={projectData?.customCosts || []}\n                          onAddCost={handleAddCost}\n                          onDeleteCost={handleDeleteCost}\n                        />\n\n                        <DisposalSummary\n                          project={selectedProject}\n                          period=\"week\"\n                        />\n                      </div>\n\n                      {/* Equipment Tracking */}\n                      <ProjectEquipmentCard\n                        key={equipmentRefreshKey}\n                        project={selectedProject}\n                        onAddEquipment={handleAddEquipment}\n                        onEditEquipment={handleEditEquipment}\n                        onShowToast={onShowToast}\n                      />\n\n                      {/* Progress Billing / Draw Requests */}\n                      <ProgressBillingCard\n                        key={drawRequestRefreshKey}\n                        project={selectedProject}\n                        areas={areas}\n                        corStats={projectData?.corStats}\n                        onCreateDraw={handleCreateDraw}\n                        onViewDraw={handleViewDraw}\n                        onShowToast={onShowToast}\n                      />\n\n                      {/* Labor Details - Collapsible */}\n                      <details className=\"financials-details\">\n                        <summary className=\"financials-details-summary\">\n                          <HardHat size={16} />\n                          <span>Labor Details</span>\n                          <span className=\"financials-details-value\">{formatCurrency(projectData?.laborCost || 0)}</span>\n                        </summary>\n                        <div className=\"financials-details-content\">\n                          <ManDayCosts project={selectedProject} company={company} onShowToast={onShowToast} />\n                        </div>\n                      </details>\n                    </div>\n                  )}\n\n                  {/* CHANGE ORDERS SECTION */}\n                  {financialsSection === 'cors' && (\n                    <div className=\"financials-cors animate-fade-in\">\n                      {/* COR Log - Always visible first */}\n                      <div className=\"financials-section cor-section-primary\">\n                        <Suspense fallback={<TicketSkeleton />}>\n                          <CORLogPreview\n                            project={selectedProject}\n                            onShowToast={onShowToast}\n                            onToggleList={handleToggleCORList}\n                            showingList={corListExpanded}\n                            onViewFullLog={handleViewFullCORLog}\n                            onCreateCOR={handleCreateCOR}\n                          />\n                        </Suspense>\n                      </div>\n\n                      {/* Full COR Card List - Expands below the log when toggled */}\n                      {corListExpanded && (\n                        <div className=\"financials-section cor-section-list animate-fade-in\" style={{ marginTop: '1rem' }}>\n                          <Suspense fallback={<TicketSkeleton />}>\n                            <CORList\n                              project={selectedProject}\n                              company={company}\n                              areas={areas}\n                              refreshKey={corRefreshKey}\n                              onShowToast={onShowToast}\n                              previewMode={false}\n                              onViewAll={handleToggleCORList}\n                              onDisplayModeChange={setCORDisplayMode}\n                              onCreateCOR={handleCreateCOR}\n                              onViewCOR={handleViewCOR}\n                              onEditCOR={handleEditCOR}\n                            />\n                          </Suspense>\n                        </div>\n                      )}\n                    </div>\n                  )}\n\n                  {/* T&M TICKETS SECTION */}\n                  {financialsSection === 'tickets' && (\n                    <div className=\"financials-tickets animate-fade-in\">\n                      <div className=\"financials-section tm-section\">\n                        {tmViewMode === 'full' && (\n                          <button\n                            className=\"section-back-btn\"\n                            onClick={handleBackToTMPreview}\n                          >\n                             Back to summary\n                          </button>\n                        )}\n                        <Suspense fallback={<TicketSkeleton />}>\n                          <TMList\n                            project={selectedProject}\n                            company={company}\n                            onShowToast={onShowToast}\n                            compact={tmViewMode === 'preview'}\n                            previewMode={tmViewMode === 'preview'}\n                            onViewAll={handleViewAllTickets}\n                          />\n                        </Suspense>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* BILLING SECTION */}\n                  {financialsSection === 'billing' && (\n                    <div className=\"financials-billing animate-fade-in\">\n                      <Suspense fallback={<TicketSkeleton />}>\n                        <BillingCenter\n                          project={selectedProject}\n                          company={company}\n                          user={user}\n                          onShowToast={onShowToast}\n                        />\n                      </Suspense>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* REPORTS TAB */}\n          {activeProjectTab === 'reports' && (\n            <div className=\"pv-tab-panel reports-tab\">\n              {/* Hero Metrics - High Level Project Pulse */}\n              <div className=\"reports-hero\">\n                <div className=\"reports-hero-grid\">\n                  {/* Total Reports */}\n                  <div className=\"reports-metric primary\">\n                    <div className=\"reports-metric-icon\">\n                      <ClipboardList size={24} />\n                    </div>\n                    <div className=\"reports-metric-content\">\n                      <div className=\"reports-metric-value\">{projectData?.dailyReportsCount || 0}</div>\n                      <div className=\"reports-metric-label\">Daily Reports</div>\n                    </div>\n                  </div>\n\n                  {/* This Week */}\n                  <div className=\"reports-metric\">\n                    <div className=\"reports-metric-value\">{projectData?.recentDailyReports || 0}</div>\n                    <div className=\"reports-metric-label\">This Week</div>\n                    <div className=\"reports-metric-bar\">\n                      <div\n                        className=\"reports-metric-fill\"\n                        style={{ width: `${Math.min((projectData?.recentDailyReports || 0) / 7 * 100, 100)}%` }}\n                      ></div>\n                    </div>\n                  </div>\n\n                  {/* T&M Tickets */}\n                  <div className=\"reports-metric\">\n                    <div className=\"reports-metric-value\">{projectData?.totalTickets || 0}</div>\n                    <div className=\"reports-metric-label\">T&M Tickets</div>\n                    {(projectData?.pendingTickets || 0) > 0 && (\n                      <div className=\"reports-metric-status\" style={{ background: '#fef3c7', color: '#92400e' }}>\n                        {projectData.pendingTickets} pending\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Photo Evidence */}\n                  <div className=\"reports-metric\">\n                    <div className=\"reports-metric-value\">{projectData?.totalPhotosFromTickets || 0}</div>\n                    <div className=\"reports-metric-label\">Photos Captured</div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Two-Column Layout: Crew + Safety */}\n              <div className=\"reports-two-col\">\n                {/* Crew Analytics Card */}\n                <div className=\"reports-insight-card\">\n                  <div className=\"reports-insight-header\">\n                    <div className=\"reports-insight-title\">\n                      <Users size={18} />\n                      <h3>Crew Analytics</h3>\n                    </div>\n                  </div>\n                  <div className=\"reports-insight-body\">\n                    <div className=\"reports-stat-grid\">\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.uniqueWorkerCount || 0}</span>\n                        <span className=\"reports-stat-label\">Total Workers</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.avgCrewSize || 0}</span>\n                        <span className=\"reports-stat-label\">Avg Crew / Day</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.peakCrewSize || 0}</span>\n                        <span className=\"reports-stat-label\">Peak Crew Size</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.crewDaysTracked || 0}</span>\n                        <span className=\"reports-stat-label\">Days Tracked</span>\n                      </div>\n                    </div>\n                    {(projectData?.crewTrend || 0) !== 0 && (\n                      <div className={`reports-trend-badge ${projectData.crewTrend > 0 ? 'up' : 'down'}`}>\n                        {projectData.crewTrend > 0 ? <TrendingUp size={14} /> : <TrendingDown size={14} />}\n                        <span>{Math.abs(Math.round(projectData.crewTrend))}% {projectData.crewTrend > 0 ? 'increase' : 'decrease'} vs prior week</span>\n                      </div>\n                    )}\n                    {/* Mini crew size bar chart */}\n                    {projectData?.crewByDate && Object.keys(projectData.crewByDate).length > 0 && (\n                      <div className=\"reports-mini-chart\">\n                        <div className=\"reports-mini-chart-label\">Recent Crew Size</div>\n                        <div className=\"reports-mini-bars\">\n                          {Object.keys(projectData.crewByDate).sort().slice(-14).map(date => {\n                            const count = projectData.crewByDate[date]\n                            const max = projectData.peakCrewSize || 1\n                            return (\n                              <div key={date} className=\"reports-mini-bar-wrap\" title={`${new Date(date + 'T12:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}: ${count} workers`}>\n                                <div className=\"reports-mini-bar\" style={{ height: `${(count / max) * 100}%` }}></div>\n                              </div>\n                            )\n                          })}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Safety Dashboard Card */}\n                <div className=\"reports-insight-card\">\n                  <div className=\"reports-insight-header\">\n                    <div className=\"reports-insight-title\">\n                      <Shield size={18} />\n                      <h3>Safety Dashboard</h3>\n                    </div>\n                    <span className={`reports-section-badge ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n                      {(projectData?.injuryReportsCount || 0) > 0\n                        ? `${projectData.injuryReportsCount} incident${projectData.injuryReportsCount !== 1 ? 's' : ''}`\n                        : 'No incidents'\n                      }\n                    </span>\n                  </div>\n                  <div className=\"reports-insight-body\">\n                    {/* Days Since Last Injury - prominent */}\n                    <div className=\"reports-safety-hero\">\n                      <div className={`reports-safety-days ${(projectData?.daysSinceLastInjury === null || projectData?.daysSinceLastInjury > 30) ? 'excellent' : projectData?.daysSinceLastInjury > 7 ? 'good' : 'caution'}`}>\n                        <span className=\"reports-safety-days-value\">\n                          {projectData?.daysSinceLastInjury !== null ? projectData.daysSinceLastInjury : '--'}\n                        </span>\n                        <span className=\"reports-safety-days-label\">\n                          {projectData?.daysSinceLastInjury !== null ? 'Days Since Last Incident' : 'No Incidents Recorded'}\n                        </span>\n                      </div>\n                    </div>\n                    <div className=\"reports-stat-grid\">\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.injuryReportsCount || 0}</span>\n                        <span className=\"reports-stat-label\">Total Incidents</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.oshaRecordable || 0}</span>\n                        <span className=\"reports-stat-label\">OSHA Recordable</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.reportsWithIssues || 0}</span>\n                        <span className=\"reports-stat-label\">Reports w/ Issues</span>\n                      </div>\n                      <div className=\"reports-stat\">\n                        <span className=\"reports-stat-value\">{projectData?.laborManDays || 0}</span>\n                        <span className=\"reports-stat-label\">Total Man-Days</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Material Requests + Disposal Summary Row */}\n              <div className=\"reports-two-col\">\n                {/* Material Requests */}\n                <div className=\"reports-insight-card\">\n                  <div className=\"reports-insight-header\">\n                    <div className=\"reports-insight-title\">\n                      <Package size={18} />\n                      <h3>Material Requests</h3>\n                    </div>\n                    <span className=\"reports-section-count\">{projectData?.totalMaterialRequests || 0} total</span>\n                  </div>\n                  <div className=\"reports-insight-body\">\n                    {(projectData?.totalMaterialRequests || 0) === 0 ? (\n                      <div className=\"reports-empty-state\">\n                        <Package size={32} />\n                        <p>No material requests yet</p>\n                        <span>Requests from the field will appear here</span>\n                      </div>\n                    ) : (\n                      <>\n                        <div className=\"reports-material-pipeline\">\n                          {projectData?.urgentMaterialRequests > 0 && (\n                            <div className=\"reports-material-status urgent\">\n                              <AlertTriangle size={14} />\n                              <span>{projectData.urgentMaterialRequests} Urgent</span>\n                            </div>\n                          )}\n                          <div className=\"reports-material-status pending\">\n                            <span className=\"reports-material-dot\"></span>\n                            <span>{projectData?.pendingMaterialRequests || 0} Pending</span>\n                          </div>\n                          <div className=\"reports-material-status ordered\">\n                            <span className=\"reports-material-dot\"></span>\n                            <span>{projectData?.orderedMaterialRequests || 0} Ordered</span>\n                          </div>\n                          <div className=\"reports-material-status delivered\">\n                            <CheckCircle2 size={14} />\n                            <span>{projectData?.deliveredMaterialRequests || 0} Delivered</span>\n                          </div>\n                        </div>\n                        {/* Recent requests */}\n                        <div className=\"reports-recent-list\">\n                          {(projectData?.materialRequests || []).slice(0, 3).map(req => (\n                            <div key={req.id} className={`reports-recent-item ${req.status}`}>\n                              <div className=\"reports-recent-item-main\">\n                                <span className={`reports-recent-item-status ${req.status}`}>{req.status}</span>\n                                <span className=\"reports-recent-item-date\">\n                                  {new Date(req.created_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                                </span>\n                              </div>\n                              <div className=\"reports-recent-item-detail\">\n                                {(req.items || []).slice(0, 2).map((item, i) => (\n                                  <span key={i}>{item.name}{item.quantity ? ` (${item.quantity})` : ''}</span>\n                                ))}\n                                {(req.items || []).length > 2 && (\n                                  <span className=\"reports-recent-more\">+{(req.items || []).length - 2} more</span>\n                                )}\n                              </div>\n                              {req.priority === 'urgent' && (\n                                <span className=\"reports-urgent-tag\">URGENT</span>\n                              )}\n                            </div>\n                          ))}\n                        </div>\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                {/* Disposal Trends */}\n                <div className=\"reports-insight-card\">\n                  <div className=\"reports-insight-header\">\n                    <div className=\"reports-insight-title\">\n                      <Truck size={18} />\n                      <h3>Disposal Trends</h3>\n                    </div>\n                    <span className=\"reports-section-count\">{projectData?.disposalTotalLoads || 0} loads</span>\n                  </div>\n                  <div className=\"reports-insight-body\">\n                    {(projectData?.weeklyDisposal || []).length === 0 ? (\n                      <div className=\"reports-empty-state\">\n                        <Truck size={32} />\n                        <p>No disposal data yet</p>\n                        <span>Disposal loads from the field will appear here</span>\n                      </div>\n                    ) : (\n                      <>\n                        {/* Stacked weekly bar chart */}\n                        <div className=\"reports-disposal-chart\">\n                          <div className=\"reports-disposal-bars\">\n                            {(projectData?.weeklyDisposal || []).map((week, i) => {\n                              const total = (week.concrete || 0) + (week.trash || 0) + (week.metals || 0) + (week.hazardous_waste || 0)\n                              const maxWeek = Math.max(...(projectData?.weeklyDisposal || []).map(w => (w.concrete || 0) + (w.trash || 0) + (w.metals || 0) + (w.hazardous_waste || 0))) || 1\n                              return (\n                                <div key={i} className=\"reports-disposal-bar-col\">\n                                  <div className=\"reports-disposal-bar-stack\" style={{ height: `${(total / maxWeek) * 100}%` }}>\n                                    {week.concrete > 0 && <div className=\"reports-disposal-seg concrete\" style={{ flex: week.concrete }} title={`Concrete: ${week.concrete}`}></div>}\n                                    {week.trash > 0 && <div className=\"reports-disposal-seg trash\" style={{ flex: week.trash }} title={`Trash: ${week.trash}`}></div>}\n                                    {week.metals > 0 && <div className=\"reports-disposal-seg metals\" style={{ flex: week.metals }} title={`Metals: ${week.metals}`}></div>}\n                                    {week.hazardous_waste > 0 && <div className=\"reports-disposal-seg hazardous\" style={{ flex: week.hazardous_waste }} title={`Hazardous: ${week.hazardous_waste}`}></div>}\n                                  </div>\n                                  <span className=\"reports-disposal-bar-label\">\n                                    {new Date(week.week + 'T12:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                                  </span>\n                                </div>\n                              )\n                            })}\n                          </div>\n                          <div className=\"reports-disposal-legend\">\n                            <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot concrete\"></span>Concrete</span>\n                            <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot trash\"></span>Trash</span>\n                            <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot metals\"></span>Metals</span>\n                            <span className=\"reports-disposal-legend-item\"><span className=\"reports-disposal-dot hazardous\"></span>Hazardous</span>\n                          </div>\n                        </div>\n                        {/* Haul-off cost summary */}\n                        {(projectData?.haulOffCost || 0) > 0 && (\n                          <div className=\"reports-disposal-cost\">\n                            <span>Total Disposal Cost</span>\n                            <strong>{formatCurrency(projectData.haulOffCost)}</strong>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n              </div>\n\n              {/* Field Activity Summary */}\n              <div className=\"reports-insight-card reports-activity-summary\">\n                <div className=\"reports-insight-header\">\n                  <div className=\"reports-insight-title\">\n                    <ClipboardList size={18} />\n                    <h3>Field Activity Summary</h3>\n                  </div>\n                  <div className=\"reports-activity-badges\">\n                    {projectData?.lastDailyReport && (\n                      <span className=\"reports-last-filed\">\n                        Last report: {new Date(projectData.lastDailyReport).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                        {' '}({Math.floor((new Date() - new Date(projectData.lastDailyReport)) / (1000 * 60 * 60 * 24))}d ago)\n                      </span>\n                    )}\n                  </div>\n                </div>\n                <div className=\"reports-insight-body\">\n                  <div className=\"reports-activity-grid\">\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><ClipboardList size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.dailyReportsCount || 0}</strong>\n                        <span>Daily Reports Filed</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><FileText size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.totalTickets || 0}</strong>\n                        <span>T&M Tickets Created</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><Camera size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.totalPhotosFromTickets || 0}</strong>\n                        <span>Photos Documented</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><HardHat size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.completedAreasCount || 0}/{areas.length}</strong>\n                        <span>Work Areas Complete</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><DollarSign size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{formatCurrency(projectData?.allCostsTotal || 0)}</strong>\n                        <span>Total Costs Tracked</span>\n                      </div>\n                    </div>\n                    <div className=\"reports-activity-stat\">\n                      <div className=\"reports-activity-stat-icon\"><Users size={16} /></div>\n                      <div className=\"reports-activity-stat-info\">\n                        <strong>{projectData?.laborManDays || 0}</strong>\n                        <span>Total Man-Days</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Daily Reports Section */}\n              <div className=\"reports-section-card\">\n                <div className=\"reports-section-header\">\n                  <div className=\"reports-section-title\">\n                    <ClipboardList size={18} />\n                    <h3>Daily Reports</h3>\n                  </div>\n                  <span className=\"reports-section-count\">{projectData?.dailyReportsCount || 0} total</span>\n                </div>\n                <div className=\"reports-section-content\">\n                  <Suspense fallback={<TicketSkeleton />}>\n                    <DailyReportsList project={selectedProject} company={company} onShowToast={onShowToast} />\n                  </Suspense>\n                </div>\n              </div>\n\n              {/* Injury Reports Section */}\n              <div className={`reports-section-card ${(projectData?.injuryReportsCount || 0) > 0 ? 'has-warning' : ''}`}>\n                <div className=\"reports-section-header\">\n                  <div className=\"reports-section-title\">\n                    <span className={`reports-section-icon ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n                      {(projectData?.injuryReportsCount || 0) > 0 ? '' : ''}\n                    </span>\n                    <h3>Safety & Injury Reports</h3>\n                  </div>\n                  <span className={`reports-section-badge ${(projectData?.injuryReportsCount || 0) > 0 ? 'warning' : 'success'}`}>\n                    {(projectData?.injuryReportsCount || 0) > 0\n                      ? `${projectData.injuryReportsCount} incident${projectData.injuryReportsCount !== 1 ? 's' : ''}`\n                      : 'No incidents'\n                    }\n                  </span>\n                </div>\n                <div className=\"reports-section-content\">\n                  <Suspense fallback={<TicketSkeleton />}>\n                    <InjuryReportsList\n                      project={selectedProject}\n                      companyId={company?.id || selectedProject?.company_id}\n                      company={company}\n                      user={user}\n                      onShowToast={onShowToast}\n                    />\n                  </Suspense>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* DOCUMENTS TAB */}\n          {activeProjectTab === 'documents' && (\n            <div className=\"pv-tab-panel documents-tab\">\n              <Suspense fallback={<TicketSkeleton />}>\n                <DocumentsTab\n                  project={selectedProject}\n                  companyId={company?.id || selectedProject?.company_id}\n                  onShowToast={onShowToast}\n                  userRole={user?.access_level || 'office'}\n                />\n              </Suspense>\n            </div>\n          )}\n\n          {/* INFO TAB */}\n          {activeProjectTab === 'info' && (\n            <div className=\"pv-tab-panel info-tab\">\n              {/* Hero Header */}\n              <div className=\"info-hero\">\n                <div className=\"info-hero-content\">\n                  <div className=\"info-hero-main\">\n                    <h2 className=\"info-hero-title\">{selectedProject.name}</h2>\n                    {selectedProject.job_number && (\n                      <span className=\"info-hero-job\">Job #{selectedProject.job_number}</span>\n                    )}\n                  </div>\n                  <button className=\"btn btn-primary btn-with-icon\" onClick={handleEditClick}>\n                    <span>Edit Project</span>\n                  </button>\n                </div>\n                {selectedProject.address && (\n                  <div className=\"info-hero-address\">\n                    <MapPin size={14} />\n                    <span>{selectedProject.address}</span>\n                  </div>\n                )}\n              </div>\n\n              {/* Quick Info Cards */}\n              <div className=\"info-quick-grid\">\n                {/* Work Type */}\n                <div className=\"info-quick-card\">\n                  <div className=\"info-quick-icon\">\n                    <HardHat size={20} />\n                  </div>\n                  <div className=\"info-quick-content\">\n                    <span className=\"info-quick-value\">\n                      {selectedProject.work_type === 'environmental' ? 'Environmental' : 'Demolition'}\n                    </span>\n                    <span className=\"info-quick-label\">Work Type</span>\n                  </div>\n                </div>\n\n                {/* Job Type */}\n                <div className=\"info-quick-card\">\n                  <div className=\"info-quick-icon\">\n                    <FileText size={20} />\n                  </div>\n                  <div className=\"info-quick-content\">\n                    <span className=\"info-quick-value\">\n                      {selectedProject.job_type === 'prevailing_wage' ? 'Prevailing Wage' : 'Standard'}\n                    </span>\n                    <span className=\"info-quick-label\">Job Type</span>\n                  </div>\n                </div>\n\n                {/* Contract Value */}\n                <div className=\"info-quick-card highlight\">\n                  <div className=\"info-quick-icon\">\n                    <DollarSign size={20} />\n                  </div>\n                  <div className=\"info-quick-content\">\n                    <span className=\"info-quick-value\">{formatCurrency(revisedContractValue)}</span>\n                    <span className=\"info-quick-label\">\n                      {changeOrderValue > 0 ? `Incl. +${formatCurrency(changeOrderValue)} COs` : 'Contract Value'}\n                    </span>\n                  </div>\n                </div>\n\n                {/* Foreman PIN */}\n                {selectedProject.pin && (\n                  <div className=\"info-quick-card\">\n                    <div className=\"info-quick-icon\">\n                      <span className=\"info-pin-icon\">#</span>\n                    </div>\n                    <div className=\"info-quick-content\">\n                      <span className=\"info-quick-value mono\">{selectedProject.pin}</span>\n                      <span className=\"info-quick-label\">Foreman PIN</span>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Client & Contractor Card */}\n              <div className=\"info-section-card\">\n                <div className=\"info-section-header\">\n                  <Building2 size={18} />\n                  <h3>Client & Contractor</h3>\n                </div>\n                <div className=\"info-section-content\">\n                  {selectedProject.general_contractor ? (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">General Contractor</span>\n                      <span className=\"info-detail-value\">{selectedProject.general_contractor}</span>\n                    </div>\n                  ) : (\n                    <div className=\"info-detail-row empty\">\n                      <span className=\"info-detail-value\">No general contractor specified</span>\n                    </div>\n                  )}\n                  {selectedProject.client_contact && (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">Client Contact</span>\n                      <span className=\"info-detail-value\">{selectedProject.client_contact}</span>\n                    </div>\n                  )}\n                  {selectedProject.client_phone && (\n                    <div className=\"info-detail-row clickable\">\n                      <span className=\"info-detail-label\">\n                        <Phone size={14} />\n                        Phone\n                      </span>\n                      <a href={`tel:${selectedProject.client_phone}`} className=\"info-detail-value link\">\n                        {selectedProject.client_phone}\n                      </a>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Work Areas Card */}\n              <div className=\"info-section-card\">\n                <div className=\"info-section-header\">\n                  <LayoutGrid size={18} />\n                  <h3>Work Areas</h3>\n                  <div className=\"info-section-badges\">\n                    {areasComplete > 0 && <span className=\"info-badge done\">{areasComplete} Done</span>}\n                    {areasWorking > 0 && <span className=\"info-badge working\">{areasWorking} Active</span>}\n                    {areasNotStarted > 0 && <span className=\"info-badge pending\">{areasNotStarted} Pending</span>}\n                  </div>\n                </div>\n                <div className=\"info-areas-list\">\n                  {areas.map(area => (\n                    <div key={area.id} className={`info-area-item ${area.status}`}>\n                      <div className=\"info-area-status\">\n                        {area.status === 'done' && <span className=\"status-dot done\"></span>}\n                        {area.status === 'working' && <span className=\"status-dot working\"></span>}\n                        {area.status === 'not_started' && <span className=\"status-dot pending\"></span>}\n                      </div>\n                      <div className=\"info-area-details\">\n                        <span className=\"info-area-name\">{area.name}</span>\n                        <span className={`info-area-status-label ${area.status}`}>\n                          {area.status === 'done' ? 'Complete' : area.status === 'working' ? 'In Progress' : 'Not Started'}\n                        </span>\n                      </div>\n                      <span className=\"info-area-weight\">{area.weight}%</span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Project Team */}\n              <ProjectTeam\n                project={selectedProject}\n                company={company}\n                user={user}\n                isAdmin={isAdmin}\n                onShowToast={onShowToast}\n              />\n\n              {/* Project Settings - Collapsible */}\n              <details className=\"info-details-section\">\n                <summary className=\"info-details-summary\">\n                  <Info size={16} />\n                  <span>Additional Settings</span>\n                </summary>\n                <div className=\"info-details-content\">\n                  <div className=\"info-detail-row\">\n                    <span className=\"info-detail-label\">Original Contract</span>\n                    <span className=\"info-detail-value\">{formatCurrency(selectedProject.contract_value)}</span>\n                  </div>\n                  {changeOrderValue > 0 && (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">Approved Change Orders</span>\n                      <span className=\"info-detail-value positive\">+{formatCurrency(changeOrderValue)}</span>\n                    </div>\n                  )}\n                  {selectedProject.default_dump_site_id && (\n                    <div className=\"info-detail-row\">\n                      <span className=\"info-detail-label\">Default Dump Site</span>\n                      <span className=\"info-detail-value\">\n                        {dumpSites.find(s => s.id === selectedProject.default_dump_site_id)?.name || 'Unknown'}\n                      </span>\n                    </div>\n                  )}\n                </div>\n              </details>\n\n              {/* Account Security */}\n              <div className=\"info-section-card\">\n                <MFASetup onShowToast={onShowToast} />\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Share Modal */}\n        {showShareModal && (\n          <Suspense fallback={null}>\n            <ShareModal\n              project={selectedProject}\n              user={user}\n              onClose={() => setShowShareModal(false)}\n              onShareCreated={(share) => {\n                onShowToast('Share link created successfully!', 'success')\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* Notification Settings Modal */}\n        {showNotificationSettings && (\n          <div className=\"notification-settings-modal\">\n            <Suspense fallback={null}>\n              <NotificationSettings\n                project={selectedProject}\n                company={company}\n                onShowToast={onShowToast}\n                onClose={() => setShowNotificationSettings(false)}\n              />\n            </Suspense>\n          </div>\n        )}\n\n        {/* COR Form Modal */}\n        {showCORForm && (\n          <Suspense fallback={null}>\n            <CORForm\n              project={selectedProject}\n              company={company}\n              areas={areas}\n              existingCOR={editingCOR}\n              onClose={() => {\n                setShowCORForm(false)\n                setEditingCOR(null)\n              }}\n              onSaved={() => {\n                setShowCORForm(false)\n                setEditingCOR(null)\n                setCORRefreshKey(prev => prev + 1)\n              }}\n              onShowToast={onShowToast}\n            />\n          </Suspense>\n        )}\n\n        {/* COR Detail Modal */}\n        {showCORDetail && viewingCOR && (\n          <Suspense fallback={null}>\n            <CORDetail\n              cor={viewingCOR}\n              project={selectedProject}\n              company={company}\n              areas={areas}\n              onClose={() => {\n                setShowCORDetail(false)\n                setViewingCOR(null)\n              }}\n              onEdit={(cor) => {\n                setShowCORDetail(false)\n                setViewingCOR(null)\n                setEditingCOR(cor)\n                setShowCORForm(true)\n              }}\n              onShowToast={onShowToast}\n              onStatusChange={() => {\n                // Trigger a refresh of the COR list\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* COR Log Modal */}\n        {corDisplayMode === 'log' && selectedProject && (\n          <div className=\"cor-log-modal-overlay\" onClick={() => setCORDisplayMode('list')}>\n            <div className=\"cor-log-modal\" onClick={(e) => e.stopPropagation()}>\n              <div className=\"cor-log-modal-header\">\n                <h2>Change Order Log</h2>\n                <button\n                  className=\"cor-log-modal-close\"\n                  onClick={() => setCORDisplayMode('list')}\n                  title=\"Close\"\n                >\n                  \n                </button>\n              </div>\n              <div className=\"cor-log-modal-content\">\n                <Suspense fallback={<div style={{ padding: '2rem', textAlign: 'center' }}>Loading...</div>}>\n                  <CORLog project={selectedProject} company={company} onShowToast={onShowToast} />\n                </Suspense>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Add Cost Modal */}\n        {showAddCostModal && (\n          <Suspense fallback={null}>\n            <AddCostModal\n              onClose={() => setShowAddCostModal(false)}\n              saving={savingCost}\n              onSave={async (costData) => {\n                try {\n                  setSavingCost(true)\n                  await db.addProjectCost(selectedProject.id, company.id, costData)\n                  setShowAddCostModal(false)\n                  loadProjects()\n                  onShowToast('Cost added successfully', 'success')\n                } catch (err) {\n                  console.error('Error adding cost:', err)\n                  onShowToast('Error adding cost', 'error')\n                } finally {\n                  setSavingCost(false)\n                }\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* Equipment Modal */}\n        {showEquipmentModal && (\n          <Suspense fallback={null}>\n            <EquipmentModal\n              project={selectedProject}\n              company={company}\n              user={user}\n              editItem={editingEquipment}\n              onSave={() => {\n                setShowEquipmentModal(false)\n                setEditingEquipment(null)\n                setEquipmentRefreshKey(prev => prev + 1)\n                onShowToast(editingEquipment ? 'Equipment updated' : 'Equipment added', 'success')\n              }}\n              onClose={() => {\n                setShowEquipmentModal(false)\n                setEditingEquipment(null)\n              }}\n            />\n          </Suspense>\n        )}\n\n        {/* Draw Request Modal */}\n        {showDrawRequestModal && (\n          <Suspense fallback={null}>\n            <DrawRequestModal\n              project={selectedProject}\n              company={company}\n              areas={areas}\n              corStats={projectsData.find(p => p.id === selectedProject?.id)?.corStats}\n              editDrawRequest={editingDrawRequest}\n              onSave={() => {\n                setShowDrawRequestModal(false)\n                setEditingDrawRequest(null)\n                setDrawRequestRefreshKey(prev => prev + 1)\n                onShowToast(editingDrawRequest ? 'Draw request updated' : 'Draw request created', 'success')\n              }}\n              onClose={() => {\n                setShowDrawRequestModal(false)\n                setEditingDrawRequest(null)\n              }}\n            />\n          </Suspense>\n        )}\n      </div>\n    )\n  }\n\n  // Project List View - empty state\n  if (projects.length === 0) {\n    return (\n      <div className=\"empty-state\">\n        <ClipboardList size={48} className=\"empty-state-icon\" />\n        <h3>No Projects Yet</h3>\n        <p>Create your first project to get started</p>\n      </div>\n    )\n  }\n\n  // Portfolio overview - uses memoized values from above\n  return (\n    <div>\n      {/* Business Overview - High Level Portfolio Health */}\n      <div className=\"business-overview\">\n        <div className=\"bo-header\">\n          <h2 className=\"bo-title\">Portfolio Overview</h2>\n          <button className=\"search-trigger-btn\" onClick={() => setSearchOpen(true)}>\n            <Search size={16} />\n            <span>Search</span>\n            <span className=\"shortcut\">K</span>\n          </button>\n          <div className=\"bo-project-count\">{projects.length} Active Project{projects.length !== 1 ? 's' : ''}</div>\n        </div>\n\n        {/* Main Financial Bar */}\n        <div className=\"bo-financial\">\n          <div className=\"bo-progress-bar\">\n            <div\n              className=\"bo-progress-fill\"\n              style={{ width: `${Math.min(weightedCompletion, 100)}%` }}\n            ></div>\n          </div>\n          <div className=\"bo-financial-row\">\n            <div className=\"bo-metric primary\">\n              <span className=\"bo-metric-value\">{formatCurrency(totalEarned)}</span>\n              <span className=\"bo-metric-label\">Earned Revenue</span>\n            </div>\n            <div className=\"bo-metric-separator\">of</div>\n            <div className=\"bo-metric primary\">\n              <span className=\"bo-metric-value\">{formatCurrency(totalPortfolioValue)}</span>\n              <span className=\"bo-metric-label\">Total Portfolio</span>\n            </div>\n            <div className=\"bo-metric highlight\">\n              <span className=\"bo-metric-value\">{formatCurrency(totalRemaining)}</span>\n              <span className=\"bo-metric-label\">Remaining to Bill</span>\n            </div>\n          </div>\n\n          {/* Change Orders Summary - Only show if there are change orders */}\n          {totalChangeOrders > 0 && (\n            <div className=\"bo-change-orders\">\n              <div className=\"bo-co-item\">\n                <span className=\"bo-co-label\">Original Contracts</span>\n                <span className=\"bo-co-value\">{formatCurrency(totalOriginalContract)}</span>\n              </div>\n              <div className=\"bo-co-item bo-co-added\">\n                <span className=\"bo-co-label\">+ Change Orders ({projectsWithChangeOrders} project{projectsWithChangeOrders !== 1 ? 's' : ''})</span>\n                <span className=\"bo-co-value\">+{formatCurrency(totalChangeOrders)}</span>\n              </div>\n            </div>\n          )}\n\n          {/* Pending CORs - Unapproved extra work (not yet part of contract value) */}\n          {totalPendingCORCount > 0 && (\n            <div className=\"bo-pending-cors\">\n              <div className=\"bo-pending-cor-item\">\n                <span className=\"bo-pending-cor-icon\">!</span>\n                <span className=\"bo-pending-cor-label\">Pending CORs</span>\n                <span className=\"bo-pending-cor-value\">{formatCurrency(totalPendingCORValue)}</span>\n                <span className=\"bo-pending-cor-count\">({totalPendingCORCount} pending)</span>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Project Health Summary */}\n        <div className=\"bo-health\">\n          <div className=\"bo-health-title\">Project Health</div>\n          <div className=\"bo-health-pills\">\n            {projectsComplete > 0 && (\n              <div className=\"bo-pill complete\">\n                <span className=\"bo-pill-count\">{projectsComplete}</span>\n                <span className=\"bo-pill-label\">Complete</span>\n              </div>\n            )}\n            {projectsOnTrack > 0 && (\n              <div className=\"bo-pill on-track\">\n                <span className=\"bo-pill-count\">{projectsOnTrack}</span>\n                <span className=\"bo-pill-label\">On Track</span>\n              </div>\n            )}\n            {projectsAtRisk > 0 && (\n              <div className=\"bo-pill at-risk\">\n                <span className=\"bo-pill-count\">{projectsAtRisk}</span>\n                <span className=\"bo-pill-label\">At Risk</span>\n              </div>\n            )}\n            {projectsOverBudget > 0 && (\n              <div className=\"bo-pill over-budget\">\n                <span className=\"bo-pill-count\">{projectsOverBudget}</span>\n                <span className=\"bo-pill-label\">Over Budget</span>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Schedule Performance Summary */}\n        {hasAnyScheduleData && (\n          <div className=\"bo-schedule\">\n            <div className=\"bo-schedule-title\">Schedule Performance</div>\n            <div className=\"bo-schedule-pills\">\n              {scheduleAhead > 0 && (\n                <div className=\"bo-pill ahead\">\n                  <span className=\"bo-pill-count\">{scheduleAhead}</span>\n                  <span className=\"bo-pill-label\">Ahead</span>\n                </div>\n              )}\n              {scheduleOnTrack > 0 && (\n                <div className=\"bo-pill schedule-on-track\">\n                  <span className=\"bo-pill-count\">{scheduleOnTrack}</span>\n                  <span className=\"bo-pill-label\">On Track</span>\n                </div>\n              )}\n              {scheduleBehind > 0 && (\n                <div className=\"bo-pill behind\">\n                  <span className=\"bo-pill-count\">{scheduleBehind}</span>\n                  <span className=\"bo-pill-label\">Behind</span>\n                </div>\n              )}\n            </div>\n\n            {/* Labor Performance (if any projects have planned man-days) */}\n            {hasAnyLaborData && (\n              <div className=\"bo-labor-summary\">\n                <span className=\"bo-labor-label\">Man-Days:</span>\n                {laborUnder > 0 && (\n                  <span className=\"bo-labor-badge under\">{laborUnder} under</span>\n                )}\n                {laborOnTrack > 0 && (\n                  <span className=\"bo-labor-badge on-track\">{laborOnTrack} on track</span>\n                )}\n                {laborOver > 0 && (\n                  <span className=\"bo-labor-badge over\">{laborOver} over</span>\n                )}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Smart Alerts - Actionable insights requiring attention */}\n      {riskAnalysis.allAlerts.length > 0 && (\n        <div className=\"smart-alerts-section\" style={{ marginBottom: 'var(--space-lg, 1.5rem)' }}>\n          <div className=\"smart-alerts-header\" style={{\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n            marginBottom: 'var(--space-sm, 0.5rem)'\n          }}>\n            <h3 style={{\n              fontSize: 'var(--font-size-md, 1rem)',\n              fontWeight: 'var(--font-weight-semibold, 600)',\n              color: 'var(--text-primary)',\n              margin: 0\n            }}>\n              Needs Attention\n              {riskAnalysis.criticalCount > 0 && (\n                <span style={{\n                  marginLeft: '0.5rem',\n                  padding: '2px 8px',\n                  fontSize: '0.75rem',\n                  fontWeight: 600,\n                  borderRadius: '9999px',\n                  background: 'var(--status-danger-bg, #7f1d1d)',\n                  color: 'var(--status-danger, #dc2626)'\n                }}>\n                  {riskAnalysis.criticalCount} critical\n                </span>\n              )}\n            </h3>\n          </div>\n          <SmartAlerts\n            alerts={riskAnalysis.allAlerts}\n            onAction={handleAlertAction}\n            maxVisible={3}\n          />\n        </div>\n      )}\n\n      {/* Projects Header */}\n      <div className=\"dashboard-header\">\n        <h2>Projects</h2>\n        <span className=\"project-count\">{projects.length} active</span>\n      </div>\n\n      {/* Project Grid */}\n      <div className=\"project-list\">\n        {projectsData.map(project => {\n          const projectRisk = riskAnalysis.projectRisks.find(r => r.projectId === project.id)\n          return (\n            <EnhancedProjectCard\n              key={project.id}\n              project={project}\n              riskScore={projectRisk?.riskScore}\n              riskStatus={projectRisk?.riskStatus}\n              onClick={() => handleSelectProject(project)}\n            />\n          )\n        })}\n      </div>\n\n      {/* Universal Search Modal */}\n      <UniversalSearch\n        isOpen={isSearchOpen}\n        onClose={closeSearch}\n        companyId={company?.id}\n        onSelectProject={(project) => {\n          handleSelectProject(project)\n        }}\n        onSelectTicket={(ticket) => {\n          // Navigate to project and open T&M tab\n          const project = projects.find(p => p.id === ticket.project_id)\n          if (project) {\n            handleSelectProject(project)\n            setActiveProjectTab('financials')\n            setFinancialsSection('tickets')\n          }\n        }}\n        onSelectCOR={(cor) => {\n          // Navigate to project and open COR\n          const project = projects.find(p => p.id === cor.project_id)\n          if (project) {\n            handleSelectProject(project)\n            setActiveProjectTab('financials')\n            setFinancialsSection('cors')\n            setViewingCOR(cor)\n            setShowCORDetail(true)\n          }\n        }}\n        onShowToast={onShowToast}\n      />\n    </div>\n  )\n}\n\nfunction ProjectCard({ project, onClick }) {\n  const [areas, setAreas] = useState([])\n\n  useEffect(() => {\n    db.getAreas(project.id).then(setAreas)\n  }, [project.id])\n\n  const progress = calculateProgress(areas)\n  const status = getOverallStatus(areas)\n  const statusLabel = getOverallStatusLabel(areas)\n\n  return (\n    <div className=\"project-card\" onClick={onClick}>\n      <div className=\"project-card-header\">\n        <div>\n          <div className=\"project-card-name\">{project.name}</div>\n          <div className=\"project-card-value\">{formatCurrency(project.contract_value)}</div>\n        </div>\n        <span className={`status-badge ${status}`}>{statusLabel}</span>\n      </div>\n      <div className=\"project-card-progress\">\n        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.9rem' }}>\n          <span style={{ color: 'var(--text-secondary)' }}>Progress</span>\n          <span style={{ fontWeight: 600 }}>{progress}%</span>\n        </div>\n        <div className=\"mini-progress-bar\">\n          <div className=\"mini-progress-fill\" style={{ width: `${progress}%` }}></div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// Enhanced Project Card with more details\nfunction EnhancedProjectCard({ project, riskScore, riskStatus, onClick }) {\n  const status = getOverallStatus(project.areas || [])\n  const statusLabel = getOverallStatusLabel(project.areas || [])\n  const profit = project.contract_value - project.billable\n  const isAtRisk = project.billable > project.contract_value * 0.9 && project.progress < 90\n\n  // Risk badge colors\n  const riskColors = {\n    healthy: { bg: 'var(--status-success-bg, #064e3b)', color: 'var(--status-success, #059669)' },\n    warning: { bg: 'var(--status-warning-bg, #78350f)', color: 'var(--status-warning, #d97706)' },\n    critical: { bg: 'var(--status-danger-bg, #7f1d1d)', color: 'var(--status-danger, #dc2626)' }\n  }\n  const riskStyle = riskColors[riskStatus] || riskColors.healthy\n\n  return (\n    <div className={`project-card enhanced ${isAtRisk ? 'at-risk' : ''}`} onClick={onClick}>\n      <div className=\"project-card-header\">\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          {/* Risk Score Badge */}\n          {typeof riskScore === 'number' && (\n            <span\n              style={{\n                display: 'inline-flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                width: '32px',\n                height: '32px',\n                borderRadius: '50%',\n                fontSize: '0.75rem',\n                fontWeight: 700,\n                background: riskStyle.bg,\n                color: riskStyle.color\n              }}\n              title={`Risk Score: ${riskScore}`}\n              aria-label={`Risk score ${riskScore}, ${riskStatus}`}\n            >\n              {riskScore}\n            </span>\n          )}\n          <div>\n            <div className=\"project-card-name\">{project.name}</div>\n            <div className=\"project-card-value\">{formatCurrency(project.contract_value)}</div>\n          </div>\n        </div>\n        <span className={`status-badge ${status}`}>{statusLabel}</span>\n      </div>\n\n      {/* Stats Row */}\n      <div className=\"project-stats-row\">\n        <div className=\"project-stat\">\n          <span className=\"stat-value\">{project.progress}%</span>\n          <span className=\"stat-label\">Complete</span>\n        </div>\n        <div className=\"project-stat\">\n          <span className=\"stat-value\">{formatCurrency(project.billable)}</span>\n          <span className=\"stat-label\">Billable</span>\n        </div>\n        <div className=\"project-stat\">\n          <span className={`stat-value ${profit < 0 ? 'negative' : ''}`}>\n            {formatCurrency(Math.abs(profit))}\n          </span>\n          <span className=\"stat-label\">{profit >= 0 ? 'Remaining' : 'Over Budget'}</span>\n        </div>\n      </div>\n\n      {/* Progress Bar */}\n      <div className=\"mini-progress-bar\">\n        <div className=\"mini-progress-fill\" style={{ width: `${project.progress}%` }}></div>\n      </div>\n\n      {/* Badges Row */}\n      {(project.pendingTickets > 0 || project.totalTickets > 0) && (\n        <div className=\"project-badges\">\n          {project.pendingTickets > 0 && (\n            <span className=\"badge pending\">{project.pendingTickets} Pending T&M</span>\n          )}\n          {project.approvedTickets > 0 && (\n            <span className=\"badge approved\">{project.approvedTickets} Approved T&M</span>\n          )}\n        </div>\n      )}\n\n      {/* Schedule Badge */}\n      {project.hasScheduleData && (\n        <div className=\"project-schedule-badge\">\n          <span className={`schedule-indicator ${project.scheduleStatus}`}>\n            {project.scheduleLabel}\n          </span>\n          {project.hasLaborData && project.laborLabel && (\n            <span className={`labor-indicator ${project.laborStatus}`}>\n              {project.laborLabel}\n            </span>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n\n\n"],"file":"Dashboard-g1xZEGg-.js"}