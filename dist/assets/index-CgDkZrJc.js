function tS(e,t){for(var r=0;r<t.length;r++){const a=t[r];if(typeof a!="string"&&!Array.isArray(a)){for(const s in a)if(s!=="default"&&!(s in e)){const l=Object.getOwnPropertyDescriptor(a,s);l&&Object.defineProperty(e,s,l.get?l:{enumerable:!0,get:()=>a[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();function rm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function rS(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function a(){var s=!1;try{s=this instanceof a}catch{}return s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var s=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(r,a,s.get?s:{enumerable:!0,get:function(){return e[a]}})}),r}var Zd={exports:{}},Lc={};var Iv;function aS(){if(Iv)return Lc;Iv=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,s,l){var c=null;if(l!==void 0&&(c=""+l),s.key!==void 0&&(c=""+s.key),"key"in s){l={};for(var u in s)u!=="key"&&(l[u]=s[u])}else l=s;return s=l.ref,{$$typeof:e,type:a,key:c,ref:s!==void 0?s:null,props:l}}return Lc.Fragment=t,Lc.jsx=r,Lc.jsxs=r,Lc}var Pv;function nS(){return Pv||(Pv=1,Zd.exports=aS()),Zd.exports}var f=nS(),eh={exports:{}},ct={};var zv;function sS(){if(zv)return ct;zv=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),_=Symbol.iterator;function y(q){return q===null||typeof q!="object"?null:(q=_&&q[_]||q["@@iterator"],typeof q=="function"?q:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,E={};function k(q,C,H){this.props=q,this.context=C,this.refs=E,this.updater=H||b}k.prototype.isReactComponent={},k.prototype.setState=function(q,C){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,C,"setState")},k.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function A(){}A.prototype=k.prototype;function S(q,C,H){this.props=q,this.context=C,this.refs=E,this.updater=H||b}var j=S.prototype=new A;j.constructor=S,w(j,k.prototype),j.isPureReactComponent=!0;var F=Array.isArray;function R(){}var N={H:null,A:null,T:null,S:null},X=Object.prototype.hasOwnProperty;function G(q,C,H){var I=H.ref;return{$$typeof:e,type:q,key:C,ref:I!==void 0?I:null,props:H}}function se(q,C){return G(q.type,C,q.props)}function te(q){return typeof q=="object"&&q!==null&&q.$$typeof===e}function z(q){var C={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(H){return C[H]})}var ge=/\/+/g;function Oe(q,C){return typeof q=="object"&&q!==null&&q.key!=null?z(""+q.key):C.toString(36)}function Ce(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(R,R):(q.status="pending",q.then(function(C){q.status==="pending"&&(q.status="fulfilled",q.value=C)},function(C){q.status==="pending"&&(q.status="rejected",q.reason=C)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function Q(q,C,H,I,L){var Z=typeof q;(Z==="undefined"||Z==="boolean")&&(q=null);var re=!1;if(q===null)re=!0;else switch(Z){case"bigint":case"string":case"number":re=!0;break;case"object":switch(q.$$typeof){case e:case t:re=!0;break;case p:return re=q._init,Q(re(q._payload),C,H,I,L)}}if(re)return L=L(q),re=I===""?"."+Oe(q,0):I,F(L)?(H="",re!=null&&(H=re.replace(ge,"$&/")+"/"),Q(L,C,H,"",function(Se){return Se})):L!=null&&(te(L)&&(L=se(L,H+(L.key==null||q&&q.key===L.key?"":(""+L.key).replace(ge,"$&/")+"/")+re)),C.push(L)),1;re=0;var de=I===""?".":I+":";if(F(q))for(var ve=0;ve<q.length;ve++)I=q[ve],Z=de+Oe(I,ve),re+=Q(I,C,H,Z,L);else if(ve=y(q),typeof ve=="function")for(q=ve.call(q),ve=0;!(I=q.next()).done;)I=I.value,Z=de+Oe(I,ve++),re+=Q(I,C,H,Z,L);else if(Z==="object"){if(typeof q.then=="function")return Q(Ce(q),C,H,I,L);throw C=String(q),Error("Objects are not valid as a React child (found: "+(C==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":C)+"). If you meant to render a collection of children, use an array instead.")}return re}function le(q,C,H){if(q==null)return q;var I=[],L=0;return Q(q,I,"","",function(Z){return C.call(H,Z,L++)}),I}function Ee(q){if(q._status===-1){var C=q._result;C=C(),C.then(function(H){(q._status===0||q._status===-1)&&(q._status=1,q._result=H)},function(H){(q._status===0||q._status===-1)&&(q._status=2,q._result=H)}),q._status===-1&&(q._status=0,q._result=C)}if(q._status===1)return q._result.default;throw q._result}var K=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var C=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(C))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},Te={map:le,forEach:function(q,C,H){le(q,function(){C.apply(this,arguments)},H)},count:function(q){var C=0;return le(q,function(){C++}),C},toArray:function(q){return le(q,function(C){return C})||[]},only:function(q){if(!te(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return ct.Activity=v,ct.Children=Te,ct.Component=k,ct.Fragment=r,ct.Profiler=s,ct.PureComponent=S,ct.StrictMode=a,ct.Suspense=h,ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,ct.__COMPILER_RUNTIME={__proto__:null,c:function(q){return N.H.useMemoCache(q)}},ct.cache=function(q){return function(){return q.apply(null,arguments)}},ct.cacheSignal=function(){return null},ct.cloneElement=function(q,C,H){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var I=w({},q.props),L=q.key;if(C!=null)for(Z in C.key!==void 0&&(L=""+C.key),C)!X.call(C,Z)||Z==="key"||Z==="__self"||Z==="__source"||Z==="ref"&&C.ref===void 0||(I[Z]=C[Z]);var Z=arguments.length-2;if(Z===1)I.children=H;else if(1<Z){for(var re=Array(Z),de=0;de<Z;de++)re[de]=arguments[de+2];I.children=re}return G(q.type,L,I)},ct.createContext=function(q){return q={$$typeof:c,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:l,_context:q},q},ct.createElement=function(q,C,H){var I,L={},Z=null;if(C!=null)for(I in C.key!==void 0&&(Z=""+C.key),C)X.call(C,I)&&I!=="key"&&I!=="__self"&&I!=="__source"&&(L[I]=C[I]);var re=arguments.length-2;if(re===1)L.children=H;else if(1<re){for(var de=Array(re),ve=0;ve<re;ve++)de[ve]=arguments[ve+2];L.children=de}if(q&&q.defaultProps)for(I in re=q.defaultProps,re)L[I]===void 0&&(L[I]=re[I]);return G(q,Z,L)},ct.createRef=function(){return{current:null}},ct.forwardRef=function(q){return{$$typeof:u,render:q}},ct.isValidElement=te,ct.lazy=function(q){return{$$typeof:p,_payload:{_status:-1,_result:q},_init:Ee}},ct.memo=function(q,C){return{$$typeof:m,type:q,compare:C===void 0?null:C}},ct.startTransition=function(q){var C=N.T,H={};N.T=H;try{var I=q(),L=N.S;L!==null&&L(H,I),typeof I=="object"&&I!==null&&typeof I.then=="function"&&I.then(R,K)}catch(Z){K(Z)}finally{C!==null&&H.types!==null&&(C.types=H.types),N.T=C}},ct.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},ct.use=function(q){return N.H.use(q)},ct.useActionState=function(q,C,H){return N.H.useActionState(q,C,H)},ct.useCallback=function(q,C){return N.H.useCallback(q,C)},ct.useContext=function(q){return N.H.useContext(q)},ct.useDebugValue=function(){},ct.useDeferredValue=function(q,C){return N.H.useDeferredValue(q,C)},ct.useEffect=function(q,C){return N.H.useEffect(q,C)},ct.useEffectEvent=function(q){return N.H.useEffectEvent(q)},ct.useId=function(){return N.H.useId()},ct.useImperativeHandle=function(q,C,H){return N.H.useImperativeHandle(q,C,H)},ct.useInsertionEffect=function(q,C){return N.H.useInsertionEffect(q,C)},ct.useLayoutEffect=function(q,C){return N.H.useLayoutEffect(q,C)},ct.useMemo=function(q,C){return N.H.useMemo(q,C)},ct.useOptimistic=function(q,C){return N.H.useOptimistic(q,C)},ct.useReducer=function(q,C,H){return N.H.useReducer(q,C,H)},ct.useRef=function(q){return N.H.useRef(q)},ct.useState=function(q){return N.H.useState(q)},ct.useSyncExternalStore=function(q,C,H){return N.H.useSyncExternalStore(q,C,H)},ct.useTransition=function(){return N.H.useTransition()},ct.version="19.2.3",ct}var Hv;function am(){return Hv||(Hv=1,eh.exports=sS()),eh.exports}var J=am();const iS=rm(J);var th={exports:{}},Uc={},rh={exports:{}},ah={};var qv;function lS(){return qv||(qv=1,(function(e){function t(Q,le){var Ee=Q.length;Q.push(le);e:for(;0<Ee;){var K=Ee-1>>>1,Te=Q[K];if(0<s(Te,le))Q[K]=le,Q[Ee]=Te,Ee=K;else break e}}function r(Q){return Q.length===0?null:Q[0]}function a(Q){if(Q.length===0)return null;var le=Q[0],Ee=Q.pop();if(Ee!==le){Q[0]=Ee;e:for(var K=0,Te=Q.length,q=Te>>>1;K<q;){var C=2*(K+1)-1,H=Q[C],I=C+1,L=Q[I];if(0>s(H,Ee))I<Te&&0>s(L,H)?(Q[K]=L,Q[I]=Ee,K=I):(Q[K]=H,Q[C]=Ee,K=C);else if(I<Te&&0>s(L,Ee))Q[K]=L,Q[I]=Ee,K=I;else break e}}return le}function s(Q,le){var Ee=Q.sortIndex-le.sortIndex;return Ee!==0?Ee:Q.id-le.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var h=[],m=[],p=1,v=null,_=3,y=!1,b=!1,w=!1,E=!1,k=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function j(Q){for(var le=r(m);le!==null;){if(le.callback===null)a(m);else if(le.startTime<=Q)a(m),le.sortIndex=le.expirationTime,t(h,le);else break;le=r(m)}}function F(Q){if(w=!1,j(Q),!b)if(r(h)!==null)b=!0,R||(R=!0,z());else{var le=r(m);le!==null&&Ce(F,le.startTime-Q)}}var R=!1,N=-1,X=5,G=-1;function se(){return E?!0:!(e.unstable_now()-G<X)}function te(){if(E=!1,R){var Q=e.unstable_now();G=Q;var le=!0;try{e:{b=!1,w&&(w=!1,A(N),N=-1),y=!0;var Ee=_;try{t:{for(j(Q),v=r(h);v!==null&&!(v.expirationTime>Q&&se());){var K=v.callback;if(typeof K=="function"){v.callback=null,_=v.priorityLevel;var Te=K(v.expirationTime<=Q);if(Q=e.unstable_now(),typeof Te=="function"){v.callback=Te,j(Q),le=!0;break t}v===r(h)&&a(h),j(Q)}else a(h);v=r(h)}if(v!==null)le=!0;else{var q=r(m);q!==null&&Ce(F,q.startTime-Q),le=!1}}break e}finally{v=null,_=Ee,y=!1}le=void 0}}finally{le?z():R=!1}}}var z;if(typeof S=="function")z=function(){S(te)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,Oe=ge.port2;ge.port1.onmessage=te,z=function(){Oe.postMessage(null)}}else z=function(){k(te,0)};function Ce(Q,le){N=k(function(){Q(e.unstable_now())},le)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Q){Q.callback=null},e.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<Q?Math.floor(1e3/Q):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_next=function(Q){switch(_){case 1:case 2:case 3:var le=3;break;default:le=_}var Ee=_;_=le;try{return Q()}finally{_=Ee}},e.unstable_requestPaint=function(){E=!0},e.unstable_runWithPriority=function(Q,le){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var Ee=_;_=Q;try{return le()}finally{_=Ee}},e.unstable_scheduleCallback=function(Q,le,Ee){var K=e.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?K+Ee:K):Ee=K,Q){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=Ee+Te,Q={id:p++,callback:le,priorityLevel:Q,startTime:Ee,expirationTime:Te,sortIndex:-1},Ee>K?(Q.sortIndex=Ee,t(m,Q),r(h)===null&&Q===r(m)&&(w?(A(N),N=-1):w=!0,Ce(F,Ee-K))):(Q.sortIndex=Te,t(h,Q),b||y||(b=!0,R||(R=!0,z()))),Q},e.unstable_shouldYield=se,e.unstable_wrapCallback=function(Q){var le=_;return function(){var Ee=_;_=le;try{return Q.apply(this,arguments)}finally{_=Ee}}}})(ah)),ah}var Vv;function cS(){return Vv||(Vv=1,rh.exports=lS()),rh.exports}var nh={exports:{}},Gr={};var Gv;function oS(){if(Gv)return Gr;Gv=1;var e=am();function t(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)m+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(h,m,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:h,containerInfo:m,implementation:p}}var c=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Gr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Gr.createPortal=function(h,m){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return l(h,m,null,p)},Gr.flushSync=function(h){var m=c.T,p=a.p;try{if(c.T=null,a.p=2,h)return h()}finally{c.T=m,a.p=p,a.d.f()}},Gr.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,a.d.C(h,m))},Gr.prefetchDNS=function(h){typeof h=="string"&&a.d.D(h)},Gr.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var p=m.as,v=u(p,m.crossOrigin),_=typeof m.integrity=="string"?m.integrity:void 0,y=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;p==="style"?a.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:y}):p==="script"&&a.d.X(h,{crossOrigin:v,integrity:_,fetchPriority:y,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Gr.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var p=u(m.as,m.crossOrigin);a.d.M(h,{crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&a.d.M(h)},Gr.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var p=m.as,v=u(p,m.crossOrigin);a.d.L(h,p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Gr.preloadModule=function(h,m){if(typeof h=="string")if(m){var p=u(m.as,m.crossOrigin);a.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else a.d.m(h)},Gr.requestFormReset=function(h){a.d.r(h)},Gr.unstable_batchedUpdates=function(h,m){return h(m)},Gr.useFormState=function(h,m,p){return c.H.useFormState(h,m,p)},Gr.useFormStatus=function(){return c.H.useHostTransitionStatus()},Gr.version="19.2.3",Gr}var $v;function uS(){if($v)return nh.exports;$v=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),nh.exports=oS(),nh.exports}var Wv;function fS(){if(Wv)return Uc;Wv=1;var e=cS(),t=am(),r=uS();function a(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var i=n,o=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(o=i.return),n=i.return;while(n)}return i.tag===3?o:null}function c(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function u(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function h(n){if(l(n)!==n)throw Error(a(188))}function m(n){var i=n.alternate;if(!i){if(i=l(n),i===null)throw Error(a(188));return i!==n?null:n}for(var o=n,d=i;;){var g=o.return;if(g===null)break;var x=g.alternate;if(x===null){if(d=g.return,d!==null){o=d;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===o)return h(g),n;if(x===d)return h(g),i;x=x.sibling}throw Error(a(188))}if(o.return!==d.return)o=g,d=x;else{for(var T=!1,D=g.child;D;){if(D===o){T=!0,o=g,d=x;break}if(D===d){T=!0,d=g,o=x;break}D=D.sibling}if(!T){for(D=x.child;D;){if(D===o){T=!0,o=x,d=g;break}if(D===d){T=!0,d=x,o=g;break}D=D.sibling}if(!T)throw Error(a(189))}}if(o.alternate!==d)throw Error(a(190))}if(o.tag!==3)throw Error(a(188));return o.stateNode.current===o?n:i}function p(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=p(n),i!==null)return i;n=n.sibling}return null}var v=Object.assign,_=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),A=Symbol.for("react.consumer"),S=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),se=Symbol.for("react.memo_cache_sentinel"),te=Symbol.iterator;function z(n){return n===null||typeof n!="object"?null:(n=te&&n[te]||n["@@iterator"],typeof n=="function"?n:null)}var ge=Symbol.for("react.client.reference");function Oe(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===ge?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case w:return"Fragment";case k:return"Profiler";case E:return"StrictMode";case F:return"Suspense";case R:return"SuspenseList";case G:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case b:return"Portal";case S:return n.displayName||"Context";case A:return(n._context.displayName||"Context")+".Consumer";case j:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case N:return i=n.displayName||null,i!==null?i:Oe(n.type)||"Memo";case X:i=n._payload,n=n._init;try{return Oe(n(i))}catch{}}return null}var Ce=Array.isArray,Q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ee={pending:!1,data:null,method:null,action:null},K=[],Te=-1;function q(n){return{current:n}}function C(n){0>Te||(n.current=K[Te],K[Te]=null,Te--)}function H(n,i){Te++,K[Te]=n.current,n.current=i}var I=q(null),L=q(null),Z=q(null),re=q(null);function de(n,i){switch(H(Z,i),H(L,n),H(I,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?cv(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=cv(i),n=ov(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}C(I),H(I,n)}function ve(){C(I),C(L),C(Z)}function Se(n){n.memoizedState!==null&&H(re,n);var i=I.current,o=ov(i,n.type);i!==o&&(H(L,n),H(I,o))}function xe(n){L.current===n&&(C(I),C(L)),re.current===n&&(C(re),Dc._currentValue=Ee)}var U,Ze;function Ie(n){if(U===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);U=i&&i[1]||"",Ze=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+U+n+Ze}var _e=!1;function Le(n,i){if(!n||_e)return"";_e=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(i){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(we){var me=we}Reflect.construct(n,[],Re)}else{try{Re.call()}catch(we){me=we}n.call(Re.prototype)}}else{try{throw Error()}catch(we){me=we}(Re=n())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(we){if(we&&me&&typeof we.stack=="string")return[we.stack,me.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=d.DetermineComponentFrameRoot(),T=x[0],D=x[1];if(T&&D){var Y=T.split(`
`),oe=D.split(`
`);for(g=d=0;d<Y.length&&!Y[d].includes("DetermineComponentFrameRoot");)d++;for(;g<oe.length&&!oe[g].includes("DetermineComponentFrameRoot");)g++;if(d===Y.length||g===oe.length)for(d=Y.length-1,g=oe.length-1;1<=d&&0<=g&&Y[d]!==oe[g];)g--;for(;1<=d&&0<=g;d--,g--)if(Y[d]!==oe[g]){if(d!==1||g!==1)do if(d--,g--,0>g||Y[d]!==oe[g]){var Ae=`
`+Y[d].replace(" at new "," at ");return n.displayName&&Ae.includes("<anonymous>")&&(Ae=Ae.replace("<anonymous>",n.displayName)),Ae}while(1<=d&&0<=g);break}}}finally{_e=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?Ie(o):""}function be(n,i){switch(n.tag){case 26:case 27:case 5:return Ie(n.type);case 16:return Ie("Lazy");case 13:return n.child!==i&&i!==null?Ie("Suspense Fallback"):Ie("Suspense");case 19:return Ie("SuspenseList");case 0:case 15:return Le(n.type,!1);case 11:return Le(n.type.render,!1);case 1:return Le(n.type,!0);case 31:return Ie("Activity");default:return""}}function it(n){try{var i="",o=null;do i+=be(n,o),o=n,n=n.return;while(n);return i}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var kt=Object.prototype.hasOwnProperty,ht=e.unstable_scheduleCallback,Et=e.unstable_cancelCallback,Dr=e.unstable_shouldYield,Ft=e.unstable_requestPaint,At=e.unstable_now,jr=e.unstable_getCurrentPriorityLevel,Fr=e.unstable_ImmediatePriority,ie=e.unstable_UserBlockingPriority,De=e.unstable_NormalPriority,Me=e.unstable_LowPriority,We=e.unstable_IdlePriority,ot=e.log,mt=e.unstable_setDisableYieldValue,St=null,tr=null;function ia(n){if(typeof ot=="function"&&mt(n),tr&&typeof tr.setStrictMode=="function")try{tr.setStrictMode(St,n)}catch{}}var Mr=Math.clz32?Math.clz32:zs,Di=Math.log,Fi=Math.LN2;function zs(n){return n>>>=0,n===0?32:31-(Di(n)/Fi|0)|0}var Tn=256,es=262144,ts=4194304;function ta(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function rs(n,i,o){var d=n.pendingLanes;if(d===0)return 0;var g=0,x=n.suspendedLanes,T=n.pingedLanes;n=n.warmLanes;var D=d&134217727;return D!==0?(d=D&~x,d!==0?g=ta(d):(T&=D,T!==0?g=ta(T):o||(o=D&~n,o!==0&&(g=ta(o))))):(D=d&~x,D!==0?g=ta(D):T!==0?g=ta(T):o||(o=d&~n,o!==0&&(g=ta(o)))),g===0?0:i!==0&&i!==g&&(i&x)===0&&(x=g&-g,o=i&-i,x>=o||x===32&&(o&4194048)!==0)?i:g}function kn(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function $l(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pe(){var n=ts;return ts<<=1,(ts&62914560)===0&&(ts=4194304),n}function Za(n){for(var i=[],o=0;31>o;o++)i.push(n);return i}function An(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Gf(n,i,o,d,g,x){var T=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var D=n.entanglements,Y=n.expirationTimes,oe=n.hiddenUpdates;for(o=T&~o;0<o;){var Ae=31-Mr(o),Re=1<<Ae;D[Ae]=0,Y[Ae]=-1;var me=oe[Ae];if(me!==null)for(oe[Ae]=null,Ae=0;Ae<me.length;Ae++){var we=me[Ae];we!==null&&(we.lane&=-536870913)}o&=~Re}d!==0&&Ao(n,d,0),x!==0&&g===0&&n.tag!==0&&(n.suspendedLanes|=x&~(T&~i))}function Ao(n,i,o){n.pendingLanes|=i,n.suspendedLanes&=~i;var d=31-Mr(i);n.entangledLanes|=i,n.entanglements[d]=n.entanglements[d]|1073741824|o&261930}function Mi(n,i){var o=n.entangledLanes|=i;for(n=n.entanglements;o;){var d=31-Mr(o),g=1<<d;g&i|n[d]&i&&(n[d]|=i),o&=~g}}function jo(n,i){var o=i&-i;return o=(o&42)!==0?1:Wl(o),(o&(n.suspendedLanes|i))!==0?0:o}function Wl(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Xl(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function O(){var n=le.p;return n!==0?n:(n=window.event,n===void 0?32:Rv(n.type))}function V(n,i){var o=le.p;try{return le.p=n,i()}finally{le.p=o}}var M=Math.random().toString(36).slice(2),B="__reactFiber$"+M,P="__reactProps$"+M,W="__reactContainer$"+M,ue="__reactEvents$"+M,je="__reactListeners$"+M,fe="__reactHandles$"+M,he="__reactResources$"+M,pe="__reactMarker$"+M;function Be(n){delete n[B],delete n[P],delete n[ue],delete n[je],delete n[fe]}function ze(n){var i=n[B];if(i)return i;for(var o=n.parentNode;o;){if(i=o[W]||o[B]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(n=gv(n);n!==null;){if(o=n[B])return o;n=gv(n)}return i}n=o,o=n.parentNode}return null}function $e(n){if(n=n[B]||n[W]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function Ue(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(a(33))}function Ve(n){var i=n[he];return i||(i=n[he]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Ye(n){n[pe]=!0}var Gt=new Set,$t={};function Zt(n,i){Ra(n,i),Ra(n+"Capture",i)}function Ra(n,i){for($t[n]=i,n=0;n<i.length;n++)Gt.add(i[n])}var Hs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),as={},dn={};function Kl(n){return kt.call(dn,n)?!0:kt.call(as,n)?!1:Hs.test(n)?dn[n]=!0:(as[n]=!0,!1)}function la(n,i,o){if(Kl(i))if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var d=i.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+o)}}function No(n,i,o){if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+o)}}function jn(n,i,o,d){if(d===null)n.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(i,o,""+d)}}function Da(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function ep(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function X2(n,i,o){var d=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var g=d.get,x=d.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return g.call(this)},set:function(T){o=""+T,x.call(this,T)}}),Object.defineProperty(n,i,{enumerable:d.enumerable}),{getValue:function(){return o},setValue:function(T){o=""+T},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function $f(n){if(!n._valueTracker){var i=ep(n)?"checked":"value";n._valueTracker=X2(n,i,""+n[i])}}function tp(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var o=i.getValue(),d="";return n&&(d=ep(n)?n.checked?"true":"false":n.value),n=d,n!==o?(i.setValue(n),!0):!1}function Co(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var K2=/[\n"\\]/g;function Fa(n){return n.replace(K2,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Wf(n,i,o,d,g,x,T,D){n.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.type=T:n.removeAttribute("type"),i!=null?T==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+Da(i)):n.value!==""+Da(i)&&(n.value=""+Da(i)):T!=="submit"&&T!=="reset"||n.removeAttribute("value"),i!=null?Xf(n,T,Da(i)):o!=null?Xf(n,T,Da(o)):d!=null&&n.removeAttribute("value"),g==null&&x!=null&&(n.defaultChecked=!!x),g!=null&&(n.checked=g&&typeof g!="function"&&typeof g!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?n.name=""+Da(D):n.removeAttribute("name")}function rp(n,i,o,d,g,x,T,D){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(n.type=x),i!=null||o!=null){if(!(x!=="submit"&&x!=="reset"||i!=null)){$f(n);return}o=o!=null?""+Da(o):"",i=i!=null?""+Da(i):o,D||i===n.value||(n.value=i),n.defaultValue=i}d=d??g,d=typeof d!="function"&&typeof d!="symbol"&&!!d,n.checked=D?n.checked:!!d,n.defaultChecked=!!d,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(n.name=T),$f(n)}function Xf(n,i,o){i==="number"&&Co(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Bi(n,i,o,d){if(n=n.options,i){i={};for(var g=0;g<o.length;g++)i["$"+o[g]]=!0;for(o=0;o<n.length;o++)g=i.hasOwnProperty("$"+n[o].value),n[o].selected!==g&&(n[o].selected=g),g&&d&&(n[o].defaultSelected=!0)}else{for(o=""+Da(o),i=null,g=0;g<n.length;g++){if(n[g].value===o){n[g].selected=!0,d&&(n[g].defaultSelected=!0);return}i!==null||n[g].disabled||(i=n[g])}i!==null&&(i.selected=!0)}}function ap(n,i,o){if(i!=null&&(i=""+Da(i),i!==n.value&&(n.value=i),o==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=o!=null?""+Da(o):""}function np(n,i,o,d){if(i==null){if(d!=null){if(o!=null)throw Error(a(92));if(Ce(d)){if(1<d.length)throw Error(a(93));d=d[0]}o=d}o==null&&(o=""),i=o}o=Da(i),n.defaultValue=o,d=n.textContent,d===o&&d!==""&&d!==null&&(n.value=d),$f(n)}function Li(n,i){if(i){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=i;return}}n.textContent=i}var Y2=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function sp(n,i,o){var d=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?d?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":d?n.setProperty(i,o):typeof o!="number"||o===0||Y2.has(i)?i==="float"?n.cssFloat=o:n[i]=(""+o).trim():n[i]=o+"px"}function ip(n,i,o){if(i!=null&&typeof i!="object")throw Error(a(62));if(n=n.style,o!=null){for(var d in o)!o.hasOwnProperty(d)||i!=null&&i.hasOwnProperty(d)||(d.indexOf("--")===0?n.setProperty(d,""):d==="float"?n.cssFloat="":n[d]="");for(var g in i)d=i[g],i.hasOwnProperty(g)&&o[g]!==d&&sp(n,g,d)}else for(var x in i)i.hasOwnProperty(x)&&sp(n,x,i[x])}function Kf(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var J2=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Q2=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Oo(n){return Q2.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Nn(){}var Yf=null;function Jf(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ui=null,Ii=null;function lp(n){var i=$e(n);if(i&&(n=i.stateNode)){var o=n[P]||null;e:switch(n=i.stateNode,i.type){case"input":if(Wf(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Fa(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var d=o[i];if(d!==n&&d.form===n.form){var g=d[P]||null;if(!g)throw Error(a(90));Wf(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(i=0;i<o.length;i++)d=o[i],d.form===n.form&&tp(d)}break e;case"textarea":ap(n,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&Bi(n,!!o.multiple,i,!1)}}}var Qf=!1;function cp(n,i,o){if(Qf)return n(i,o);Qf=!0;try{var d=n(i);return d}finally{if(Qf=!1,(Ui!==null||Ii!==null)&&(vu(),Ui&&(i=Ui,n=Ii,Ii=Ui=null,lp(i),n)))for(i=0;i<n.length;i++)lp(n[i])}}function Yl(n,i){var o=n.stateNode;if(o===null)return null;var d=o[P]||null;if(d===null)return null;o=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(n=n.type,d=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!d;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(a(231,i,typeof o));return o}var Cn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zf=!1;if(Cn)try{var Jl={};Object.defineProperty(Jl,"passive",{get:function(){Zf=!0}}),window.addEventListener("test",Jl,Jl),window.removeEventListener("test",Jl,Jl)}catch{Zf=!1}var ns=null,e0=null,Ro=null;function op(){if(Ro)return Ro;var n,i=e0,o=i.length,d,g="value"in ns?ns.value:ns.textContent,x=g.length;for(n=0;n<o&&i[n]===g[n];n++);var T=o-n;for(d=1;d<=T&&i[o-d]===g[x-d];d++);return Ro=g.slice(n,1<d?1-d:void 0)}function Do(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Fo(){return!0}function up(){return!1}function ca(n){function i(o,d,g,x,T){this._reactName=o,this._targetInst=g,this.type=d,this.nativeEvent=x,this.target=T,this.currentTarget=null;for(var D in n)n.hasOwnProperty(D)&&(o=n[D],this[D]=o?o(x):x[D]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Fo:up,this.isPropagationStopped=up,this}return v(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Fo)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Fo)},persist:function(){},isPersistent:Fo}),i}var qs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mo=ca(qs),Ql=v({},qs,{view:0,detail:0}),Z2=ca(Ql),t0,r0,Zl,Bo=v({},Ql,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:n0,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Zl&&(Zl&&n.type==="mousemove"?(t0=n.screenX-Zl.screenX,r0=n.screenY-Zl.screenY):r0=t0=0,Zl=n),t0)},movementY:function(n){return"movementY"in n?n.movementY:r0}}),fp=ca(Bo),eb=v({},Bo,{dataTransfer:0}),tb=ca(eb),rb=v({},Ql,{relatedTarget:0}),a0=ca(rb),ab=v({},qs,{animationName:0,elapsedTime:0,pseudoElement:0}),nb=ca(ab),sb=v({},qs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),ib=ca(sb),lb=v({},qs,{data:0}),dp=ca(lb),cb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ob={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ub={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fb(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=ub[n])?!!i[n]:!1}function n0(){return fb}var db=v({},Ql,{key:function(n){if(n.key){var i=cb[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Do(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?ob[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:n0,charCode:function(n){return n.type==="keypress"?Do(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Do(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),hb=ca(db),mb=v({},Bo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hp=ca(mb),pb=v({},Ql,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:n0}),gb=ca(pb),xb=v({},qs,{propertyName:0,elapsedTime:0,pseudoElement:0}),vb=ca(xb),_b=v({},Bo,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),yb=ca(_b),wb=v({},qs,{newState:0,oldState:0}),bb=ca(wb),Eb=[9,13,27,32],s0=Cn&&"CompositionEvent"in window,ec=null;Cn&&"documentMode"in document&&(ec=document.documentMode);var Sb=Cn&&"TextEvent"in window&&!ec,mp=Cn&&(!s0||ec&&8<ec&&11>=ec),pp=" ",gp=!1;function xp(n,i){switch(n){case"keyup":return Eb.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vp(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Pi=!1;function Tb(n,i){switch(n){case"compositionend":return vp(i);case"keypress":return i.which!==32?null:(gp=!0,pp);case"textInput":return n=i.data,n===pp&&gp?null:n;default:return null}}function kb(n,i){if(Pi)return n==="compositionend"||!s0&&xp(n,i)?(n=op(),Ro=e0=ns=null,Pi=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return mp&&i.locale!=="ko"?null:i.data;default:return null}}var Ab={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _p(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!Ab[n.type]:i==="textarea"}function yp(n,i,o,d){Ui?Ii?Ii.push(d):Ii=[d]:Ui=d,i=Tu(i,"onChange"),0<i.length&&(o=new Mo("onChange","change",null,o,d),n.push({event:o,listeners:i}))}var tc=null,rc=null;function jb(n){rv(n,0)}function Lo(n){var i=Ue(n);if(tp(i))return n}function wp(n,i){if(n==="change")return i}var bp=!1;if(Cn){var i0;if(Cn){var l0="oninput"in document;if(!l0){var Ep=document.createElement("div");Ep.setAttribute("oninput","return;"),l0=typeof Ep.oninput=="function"}i0=l0}else i0=!1;bp=i0&&(!document.documentMode||9<document.documentMode)}function Sp(){tc&&(tc.detachEvent("onpropertychange",Tp),rc=tc=null)}function Tp(n){if(n.propertyName==="value"&&Lo(rc)){var i=[];yp(i,rc,n,Jf(n)),cp(jb,i)}}function Nb(n,i,o){n==="focusin"?(Sp(),tc=i,rc=o,tc.attachEvent("onpropertychange",Tp)):n==="focusout"&&Sp()}function Cb(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Lo(rc)}function Ob(n,i){if(n==="click")return Lo(i)}function Rb(n,i){if(n==="input"||n==="change")return Lo(i)}function Db(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var va=typeof Object.is=="function"?Object.is:Db;function ac(n,i){if(va(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var o=Object.keys(n),d=Object.keys(i);if(o.length!==d.length)return!1;for(d=0;d<o.length;d++){var g=o[d];if(!kt.call(i,g)||!va(n[g],i[g]))return!1}return!0}function kp(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Ap(n,i){var o=kp(n);n=0;for(var d;o;){if(o.nodeType===3){if(d=n+o.textContent.length,n<=i&&d>=i)return{node:o,offset:i-n};n=d}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=kp(o)}}function jp(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?jp(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function Np(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=Co(n.document);i instanceof n.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)n=i.contentWindow;else break;i=Co(n.document)}return i}function c0(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var Fb=Cn&&"documentMode"in document&&11>=document.documentMode,zi=null,o0=null,nc=null,u0=!1;function Cp(n,i,o){var d=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;u0||zi==null||zi!==Co(d)||(d=zi,"selectionStart"in d&&c0(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),nc&&ac(nc,d)||(nc=d,d=Tu(o0,"onSelect"),0<d.length&&(i=new Mo("onSelect","select",null,i,o),n.push({event:i,listeners:d}),i.target=zi)))}function Vs(n,i){var o={};return o[n.toLowerCase()]=i.toLowerCase(),o["Webkit"+n]="webkit"+i,o["Moz"+n]="moz"+i,o}var Hi={animationend:Vs("Animation","AnimationEnd"),animationiteration:Vs("Animation","AnimationIteration"),animationstart:Vs("Animation","AnimationStart"),transitionrun:Vs("Transition","TransitionRun"),transitionstart:Vs("Transition","TransitionStart"),transitioncancel:Vs("Transition","TransitionCancel"),transitionend:Vs("Transition","TransitionEnd")},f0={},Op={};Cn&&(Op=document.createElement("div").style,"AnimationEvent"in window||(delete Hi.animationend.animation,delete Hi.animationiteration.animation,delete Hi.animationstart.animation),"TransitionEvent"in window||delete Hi.transitionend.transition);function Gs(n){if(f0[n])return f0[n];if(!Hi[n])return n;var i=Hi[n],o;for(o in i)if(i.hasOwnProperty(o)&&o in Op)return f0[n]=i[o];return n}var Rp=Gs("animationend"),Dp=Gs("animationiteration"),Fp=Gs("animationstart"),Mb=Gs("transitionrun"),Bb=Gs("transitionstart"),Lb=Gs("transitioncancel"),Mp=Gs("transitionend"),Bp=new Map,d0="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");d0.push("scrollEnd");function en(n,i){Bp.set(n,i),Zt(i,[n])}var Uo=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Ma=[],qi=0,h0=0;function Io(){for(var n=qi,i=h0=qi=0;i<n;){var o=Ma[i];Ma[i++]=null;var d=Ma[i];Ma[i++]=null;var g=Ma[i];Ma[i++]=null;var x=Ma[i];if(Ma[i++]=null,d!==null&&g!==null){var T=d.pending;T===null?g.next=g:(g.next=T.next,T.next=g),d.pending=g}x!==0&&Lp(o,g,x)}}function Po(n,i,o,d){Ma[qi++]=n,Ma[qi++]=i,Ma[qi++]=o,Ma[qi++]=d,h0|=d,n.lanes|=d,n=n.alternate,n!==null&&(n.lanes|=d)}function m0(n,i,o,d){return Po(n,i,o,d),zo(n)}function $s(n,i){return Po(n,null,null,i),zo(n)}function Lp(n,i,o){n.lanes|=o;var d=n.alternate;d!==null&&(d.lanes|=o);for(var g=!1,x=n.return;x!==null;)x.childLanes|=o,d=x.alternate,d!==null&&(d.childLanes|=o),x.tag===22&&(n=x.stateNode,n===null||n._visibility&1||(g=!0)),n=x,x=x.return;return n.tag===3?(x=n.stateNode,g&&i!==null&&(g=31-Mr(o),n=x.hiddenUpdates,d=n[g],d===null?n[g]=[i]:d.push(i),i.lane=o|536870912),x):null}function zo(n){if(50<kc)throw kc=0,Ed=null,Error(a(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var Vi={};function Ub(n,i,o,d){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _a(n,i,o,d){return new Ub(n,i,o,d)}function p0(n){return n=n.prototype,!(!n||!n.isReactComponent)}function On(n,i){var o=n.alternate;return o===null?(o=_a(n.tag,i,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=i,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,i=n.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function Up(n,i){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,i=o.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function Ho(n,i,o,d,g,x){var T=0;if(d=n,typeof n=="function")p0(n)&&(T=1);else if(typeof n=="string")T=qE(n,o,I.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case G:return n=_a(31,o,i,g),n.elementType=G,n.lanes=x,n;case w:return Ws(o.children,g,x,i);case E:T=8,g|=24;break;case k:return n=_a(12,o,i,g|2),n.elementType=k,n.lanes=x,n;case F:return n=_a(13,o,i,g),n.elementType=F,n.lanes=x,n;case R:return n=_a(19,o,i,g),n.elementType=R,n.lanes=x,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case S:T=10;break e;case A:T=9;break e;case j:T=11;break e;case N:T=14;break e;case X:T=16,d=null;break e}T=29,o=Error(a(130,n===null?"null":typeof n,"")),d=null}return i=_a(T,o,i,g),i.elementType=n,i.type=d,i.lanes=x,i}function Ws(n,i,o,d){return n=_a(7,n,d,i),n.lanes=o,n}function g0(n,i,o){return n=_a(6,n,null,i),n.lanes=o,n}function Ip(n){var i=_a(18,null,null,0);return i.stateNode=n,i}function x0(n,i,o){return i=_a(4,n.children!==null?n.children:[],n.key,i),i.lanes=o,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var Pp=new WeakMap;function Ba(n,i){if(typeof n=="object"&&n!==null){var o=Pp.get(n);return o!==void 0?o:(i={value:n,source:i,stack:it(i)},Pp.set(n,i),i)}return{value:n,source:i,stack:it(i)}}var Gi=[],$i=0,qo=null,sc=0,La=[],Ua=0,ss=null,hn=1,mn="";function Rn(n,i){Gi[$i++]=sc,Gi[$i++]=qo,qo=n,sc=i}function zp(n,i,o){La[Ua++]=hn,La[Ua++]=mn,La[Ua++]=ss,ss=n;var d=hn;n=mn;var g=32-Mr(d)-1;d&=~(1<<g),o+=1;var x=32-Mr(i)+g;if(30<x){var T=g-g%5;x=(d&(1<<T)-1).toString(32),d>>=T,g-=T,hn=1<<32-Mr(i)+g|o<<g|d,mn=x+n}else hn=1<<x|o<<g|d,mn=n}function v0(n){n.return!==null&&(Rn(n,1),zp(n,1,0))}function _0(n){for(;n===qo;)qo=Gi[--$i],Gi[$i]=null,sc=Gi[--$i],Gi[$i]=null;for(;n===ss;)ss=La[--Ua],La[Ua]=null,mn=La[--Ua],La[Ua]=null,hn=La[--Ua],La[Ua]=null}function Hp(n,i){La[Ua++]=hn,La[Ua++]=mn,La[Ua++]=ss,hn=i.id,mn=i.overflow,ss=n}var Br=null,Xt=null,Tt=!1,is=null,Ia=!1,y0=Error(a(519));function ls(n){var i=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ic(Ba(i,n)),y0}function qp(n){var i=n.stateNode,o=n.type,d=n.memoizedProps;switch(i[B]=n,i[P]=d,o){case"dialog":yt("cancel",i),yt("close",i);break;case"iframe":case"object":case"embed":yt("load",i);break;case"video":case"audio":for(o=0;o<jc.length;o++)yt(jc[o],i);break;case"source":yt("error",i);break;case"img":case"image":case"link":yt("error",i),yt("load",i);break;case"details":yt("toggle",i);break;case"input":yt("invalid",i),rp(i,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":yt("invalid",i);break;case"textarea":yt("invalid",i),np(i,d.value,d.defaultValue,d.children)}o=d.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||d.suppressHydrationWarning===!0||iv(i.textContent,o)?(d.popover!=null&&(yt("beforetoggle",i),yt("toggle",i)),d.onScroll!=null&&yt("scroll",i),d.onScrollEnd!=null&&yt("scrollend",i),d.onClick!=null&&(i.onclick=Nn),i=!0):i=!1,i||ls(n,!0)}function Vp(n){for(Br=n.return;Br;)switch(Br.tag){case 5:case 31:case 13:Ia=!1;return;case 27:case 3:Ia=!0;return;default:Br=Br.return}}function Wi(n){if(n!==Br)return!1;if(!Tt)return Vp(n),Tt=!0,!1;var i=n.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||Ud(n.type,n.memoizedProps)),o=!o),o&&Xt&&ls(n),Vp(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Xt=pv(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Xt=pv(n)}else i===27?(i=Xt,ws(n.type)?(n=qd,qd=null,Xt=n):Xt=i):Xt=Br?za(n.stateNode.nextSibling):null;return!0}function Xs(){Xt=Br=null,Tt=!1}function w0(){var n=is;return n!==null&&(da===null?da=n:da.push.apply(da,n),is=null),n}function ic(n){is===null?is=[n]:is.push(n)}var b0=q(null),Ks=null,Dn=null;function cs(n,i,o){H(b0,i._currentValue),i._currentValue=o}function Fn(n){n._currentValue=b0.current,C(b0)}function E0(n,i,o){for(;n!==null;){var d=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),n===o)break;n=n.return}}function S0(n,i,o,d){var g=n.child;for(g!==null&&(g.return=n);g!==null;){var x=g.dependencies;if(x!==null){var T=g.child;x=x.firstContext;e:for(;x!==null;){var D=x;x=g;for(var Y=0;Y<i.length;Y++)if(D.context===i[Y]){x.lanes|=o,D=x.alternate,D!==null&&(D.lanes|=o),E0(x.return,o,n),d||(T=null);break e}x=D.next}}else if(g.tag===18){if(T=g.return,T===null)throw Error(a(341));T.lanes|=o,x=T.alternate,x!==null&&(x.lanes|=o),E0(T,o,n),T=null}else T=g.child;if(T!==null)T.return=g;else for(T=g;T!==null;){if(T===n){T=null;break}if(g=T.sibling,g!==null){g.return=T.return,T=g;break}T=T.return}g=T}}function Xi(n,i,o,d){n=null;for(var g=i,x=!1;g!==null;){if(!x){if((g.flags&524288)!==0)x=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var T=g.alternate;if(T===null)throw Error(a(387));if(T=T.memoizedProps,T!==null){var D=g.type;va(g.pendingProps.value,T.value)||(n!==null?n.push(D):n=[D])}}else if(g===re.current){if(T=g.alternate,T===null)throw Error(a(387));T.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(n!==null?n.push(Dc):n=[Dc])}g=g.return}n!==null&&S0(i,n,o,d),i.flags|=262144}function Vo(n){for(n=n.firstContext;n!==null;){if(!va(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Ys(n){Ks=n,Dn=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Lr(n){return Gp(Ks,n)}function Go(n,i){return Ks===null&&Ys(n),Gp(n,i)}function Gp(n,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Dn===null){if(n===null)throw Error(a(308));Dn=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else Dn=Dn.next=i;return o}var Ib=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(o,d){n.push(d)}};this.abort=function(){i.aborted=!0,n.forEach(function(o){return o()})}},Pb=e.unstable_scheduleCallback,zb=e.unstable_NormalPriority,gr={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function T0(){return{controller:new Ib,data:new Map,refCount:0}}function lc(n){n.refCount--,n.refCount===0&&Pb(zb,function(){n.controller.abort()})}var cc=null,k0=0,Ki=0,Yi=null;function Hb(n,i){if(cc===null){var o=cc=[];k0=0,Ki=Nd(),Yi={status:"pending",value:void 0,then:function(d){o.push(d)}}}return k0++,i.then($p,$p),i}function $p(){if(--k0===0&&cc!==null){Yi!==null&&(Yi.status="fulfilled");var n=cc;cc=null,Ki=0,Yi=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function qb(n,i){var o=[],d={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return n.then(function(){d.status="fulfilled",d.value=i;for(var g=0;g<o.length;g++)(0,o[g])(i)},function(g){for(d.status="rejected",d.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),d}var Wp=Q.S;Q.S=function(n,i){Cx=At(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&Hb(n,i),Wp!==null&&Wp(n,i)};var Js=q(null);function A0(){var n=Js.current;return n!==null?n:Vt.pooledCache}function $o(n,i){i===null?H(Js,Js.current):H(Js,i.pool)}function Xp(){var n=A0();return n===null?null:{parent:gr._currentValue,pool:n}}var Ji=Error(a(460)),j0=Error(a(474)),Wo=Error(a(542)),Xo={then:function(){}};function Kp(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Yp(n,i,o){switch(o=n[o],o===void 0?n.push(i):o!==i&&(i.then(Nn,Nn),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Qp(n),n;default:if(typeof i.status=="string")i.then(Nn,Nn);else{if(n=Vt,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=i,n.status="pending",n.then(function(d){if(i.status==="pending"){var g=i;g.status="fulfilled",g.value=d}},function(d){if(i.status==="pending"){var g=i;g.status="rejected",g.reason=d}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Qp(n),n}throw Zs=i,Ji}}function Qs(n){try{var i=n._init;return i(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Zs=o,Ji):o}}var Zs=null;function Jp(){if(Zs===null)throw Error(a(459));var n=Zs;return Zs=null,n}function Qp(n){if(n===Ji||n===Wo)throw Error(a(483))}var Qi=null,oc=0;function Ko(n){var i=oc;return oc+=1,Qi===null&&(Qi=[]),Yp(Qi,n,i)}function uc(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function Yo(n,i){throw i.$$typeof===_?Error(a(525)):(n=Object.prototype.toString.call(i),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function Zp(n){function i(ae,ee){if(n){var ce=ae.deletions;ce===null?(ae.deletions=[ee],ae.flags|=16):ce.push(ee)}}function o(ae,ee){if(!n)return null;for(;ee!==null;)i(ae,ee),ee=ee.sibling;return null}function d(ae){for(var ee=new Map;ae!==null;)ae.key!==null?ee.set(ae.key,ae):ee.set(ae.index,ae),ae=ae.sibling;return ee}function g(ae,ee){return ae=On(ae,ee),ae.index=0,ae.sibling=null,ae}function x(ae,ee,ce){return ae.index=ce,n?(ce=ae.alternate,ce!==null?(ce=ce.index,ce<ee?(ae.flags|=67108866,ee):ce):(ae.flags|=67108866,ee)):(ae.flags|=1048576,ee)}function T(ae){return n&&ae.alternate===null&&(ae.flags|=67108866),ae}function D(ae,ee,ce,Ne){return ee===null||ee.tag!==6?(ee=g0(ce,ae.mode,Ne),ee.return=ae,ee):(ee=g(ee,ce),ee.return=ae,ee)}function Y(ae,ee,ce,Ne){var et=ce.type;return et===w?Ae(ae,ee,ce.props.children,Ne,ce.key):ee!==null&&(ee.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===X&&Qs(et)===ee.type)?(ee=g(ee,ce.props),uc(ee,ce),ee.return=ae,ee):(ee=Ho(ce.type,ce.key,ce.props,null,ae.mode,Ne),uc(ee,ce),ee.return=ae,ee)}function oe(ae,ee,ce,Ne){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ce.containerInfo||ee.stateNode.implementation!==ce.implementation?(ee=x0(ce,ae.mode,Ne),ee.return=ae,ee):(ee=g(ee,ce.children||[]),ee.return=ae,ee)}function Ae(ae,ee,ce,Ne,et){return ee===null||ee.tag!==7?(ee=Ws(ce,ae.mode,Ne,et),ee.return=ae,ee):(ee=g(ee,ce),ee.return=ae,ee)}function Re(ae,ee,ce){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=g0(""+ee,ae.mode,ce),ee.return=ae,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case y:return ce=Ho(ee.type,ee.key,ee.props,null,ae.mode,ce),uc(ce,ee),ce.return=ae,ce;case b:return ee=x0(ee,ae.mode,ce),ee.return=ae,ee;case X:return ee=Qs(ee),Re(ae,ee,ce)}if(Ce(ee)||z(ee))return ee=Ws(ee,ae.mode,ce,null),ee.return=ae,ee;if(typeof ee.then=="function")return Re(ae,Ko(ee),ce);if(ee.$$typeof===S)return Re(ae,Go(ae,ee),ce);Yo(ae,ee)}return null}function me(ae,ee,ce,Ne){var et=ee!==null?ee.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return et!==null?null:D(ae,ee,""+ce,Ne);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case y:return ce.key===et?Y(ae,ee,ce,Ne):null;case b:return ce.key===et?oe(ae,ee,ce,Ne):null;case X:return ce=Qs(ce),me(ae,ee,ce,Ne)}if(Ce(ce)||z(ce))return et!==null?null:Ae(ae,ee,ce,Ne,null);if(typeof ce.then=="function")return me(ae,ee,Ko(ce),Ne);if(ce.$$typeof===S)return me(ae,ee,Go(ae,ce),Ne);Yo(ae,ce)}return null}function we(ae,ee,ce,Ne,et){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return ae=ae.get(ce)||null,D(ee,ae,""+Ne,et);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case y:return ae=ae.get(Ne.key===null?ce:Ne.key)||null,Y(ee,ae,Ne,et);case b:return ae=ae.get(Ne.key===null?ce:Ne.key)||null,oe(ee,ae,Ne,et);case X:return Ne=Qs(Ne),we(ae,ee,ce,Ne,et)}if(Ce(Ne)||z(Ne))return ae=ae.get(ce)||null,Ae(ee,ae,Ne,et,null);if(typeof Ne.then=="function")return we(ae,ee,ce,Ko(Ne),et);if(Ne.$$typeof===S)return we(ae,ee,ce,Go(ee,Ne),et);Yo(ee,Ne)}return null}function Ke(ae,ee,ce,Ne){for(var et=null,Ct=null,Je=ee,pt=ee=0,bt=null;Je!==null&&pt<ce.length;pt++){Je.index>pt?(bt=Je,Je=null):bt=Je.sibling;var Ot=me(ae,Je,ce[pt],Ne);if(Ot===null){Je===null&&(Je=bt);break}n&&Je&&Ot.alternate===null&&i(ae,Je),ee=x(Ot,ee,pt),Ct===null?et=Ot:Ct.sibling=Ot,Ct=Ot,Je=bt}if(pt===ce.length)return o(ae,Je),Tt&&Rn(ae,pt),et;if(Je===null){for(;pt<ce.length;pt++)Je=Re(ae,ce[pt],Ne),Je!==null&&(ee=x(Je,ee,pt),Ct===null?et=Je:Ct.sibling=Je,Ct=Je);return Tt&&Rn(ae,pt),et}for(Je=d(Je);pt<ce.length;pt++)bt=we(Je,ae,pt,ce[pt],Ne),bt!==null&&(n&&bt.alternate!==null&&Je.delete(bt.key===null?pt:bt.key),ee=x(bt,ee,pt),Ct===null?et=bt:Ct.sibling=bt,Ct=bt);return n&&Je.forEach(function(ks){return i(ae,ks)}),Tt&&Rn(ae,pt),et}function rt(ae,ee,ce,Ne){if(ce==null)throw Error(a(151));for(var et=null,Ct=null,Je=ee,pt=ee=0,bt=null,Ot=ce.next();Je!==null&&!Ot.done;pt++,Ot=ce.next()){Je.index>pt?(bt=Je,Je=null):bt=Je.sibling;var ks=me(ae,Je,Ot.value,Ne);if(ks===null){Je===null&&(Je=bt);break}n&&Je&&ks.alternate===null&&i(ae,Je),ee=x(ks,ee,pt),Ct===null?et=ks:Ct.sibling=ks,Ct=ks,Je=bt}if(Ot.done)return o(ae,Je),Tt&&Rn(ae,pt),et;if(Je===null){for(;!Ot.done;pt++,Ot=ce.next())Ot=Re(ae,Ot.value,Ne),Ot!==null&&(ee=x(Ot,ee,pt),Ct===null?et=Ot:Ct.sibling=Ot,Ct=Ot);return Tt&&Rn(ae,pt),et}for(Je=d(Je);!Ot.done;pt++,Ot=ce.next())Ot=we(Je,ae,pt,Ot.value,Ne),Ot!==null&&(n&&Ot.alternate!==null&&Je.delete(Ot.key===null?pt:Ot.key),ee=x(Ot,ee,pt),Ct===null?et=Ot:Ct.sibling=Ot,Ct=Ot);return n&&Je.forEach(function(eS){return i(ae,eS)}),Tt&&Rn(ae,pt),et}function Ht(ae,ee,ce,Ne){if(typeof ce=="object"&&ce!==null&&ce.type===w&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case y:e:{for(var et=ce.key;ee!==null;){if(ee.key===et){if(et=ce.type,et===w){if(ee.tag===7){o(ae,ee.sibling),Ne=g(ee,ce.props.children),Ne.return=ae,ae=Ne;break e}}else if(ee.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===X&&Qs(et)===ee.type){o(ae,ee.sibling),Ne=g(ee,ce.props),uc(Ne,ce),Ne.return=ae,ae=Ne;break e}o(ae,ee);break}else i(ae,ee);ee=ee.sibling}ce.type===w?(Ne=Ws(ce.props.children,ae.mode,Ne,ce.key),Ne.return=ae,ae=Ne):(Ne=Ho(ce.type,ce.key,ce.props,null,ae.mode,Ne),uc(Ne,ce),Ne.return=ae,ae=Ne)}return T(ae);case b:e:{for(et=ce.key;ee!==null;){if(ee.key===et)if(ee.tag===4&&ee.stateNode.containerInfo===ce.containerInfo&&ee.stateNode.implementation===ce.implementation){o(ae,ee.sibling),Ne=g(ee,ce.children||[]),Ne.return=ae,ae=Ne;break e}else{o(ae,ee);break}else i(ae,ee);ee=ee.sibling}Ne=x0(ce,ae.mode,Ne),Ne.return=ae,ae=Ne}return T(ae);case X:return ce=Qs(ce),Ht(ae,ee,ce,Ne)}if(Ce(ce))return Ke(ae,ee,ce,Ne);if(z(ce)){if(et=z(ce),typeof et!="function")throw Error(a(150));return ce=et.call(ce),rt(ae,ee,ce,Ne)}if(typeof ce.then=="function")return Ht(ae,ee,Ko(ce),Ne);if(ce.$$typeof===S)return Ht(ae,ee,Go(ae,ce),Ne);Yo(ae,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,ee!==null&&ee.tag===6?(o(ae,ee.sibling),Ne=g(ee,ce),Ne.return=ae,ae=Ne):(o(ae,ee),Ne=g0(ce,ae.mode,Ne),Ne.return=ae,ae=Ne),T(ae)):o(ae,ee)}return function(ae,ee,ce,Ne){try{oc=0;var et=Ht(ae,ee,ce,Ne);return Qi=null,et}catch(Je){if(Je===Ji||Je===Wo)throw Je;var Ct=_a(29,Je,null,ae.mode);return Ct.lanes=Ne,Ct.return=ae,Ct}}}var ei=Zp(!0),eg=Zp(!1),os=!1;function N0(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function C0(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function us(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function fs(n,i,o){var d=n.updateQueue;if(d===null)return null;if(d=d.shared,(Dt&2)!==0){var g=d.pending;return g===null?i.next=i:(i.next=g.next,g.next=i),d.pending=i,i=zo(n),Lp(n,null,o),i}return Po(n,d,i,o),zo(n)}function fc(n,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var d=i.lanes;d&=n.pendingLanes,o|=d,i.lanes=o,Mi(n,o)}}function O0(n,i){var o=n.updateQueue,d=n.alternate;if(d!==null&&(d=d.updateQueue,o===d)){var g=null,x=null;if(o=o.firstBaseUpdate,o!==null){do{var T={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};x===null?g=x=T:x=x.next=T,o=o.next}while(o!==null);x===null?g=x=i:x=x.next=i}else g=x=i;o={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:d.shared,callbacks:d.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=i:n.next=i,o.lastBaseUpdate=i}var R0=!1;function dc(){if(R0){var n=Yi;if(n!==null)throw n}}function hc(n,i,o,d){R0=!1;var g=n.updateQueue;os=!1;var x=g.firstBaseUpdate,T=g.lastBaseUpdate,D=g.shared.pending;if(D!==null){g.shared.pending=null;var Y=D,oe=Y.next;Y.next=null,T===null?x=oe:T.next=oe,T=Y;var Ae=n.alternate;Ae!==null&&(Ae=Ae.updateQueue,D=Ae.lastBaseUpdate,D!==T&&(D===null?Ae.firstBaseUpdate=oe:D.next=oe,Ae.lastBaseUpdate=Y))}if(x!==null){var Re=g.baseState;T=0,Ae=oe=Y=null,D=x;do{var me=D.lane&-536870913,we=me!==D.lane;if(we?(wt&me)===me:(d&me)===me){me!==0&&me===Ki&&(R0=!0),Ae!==null&&(Ae=Ae.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Ke=n,rt=D;me=i;var Ht=o;switch(rt.tag){case 1:if(Ke=rt.payload,typeof Ke=="function"){Re=Ke.call(Ht,Re,me);break e}Re=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=rt.payload,me=typeof Ke=="function"?Ke.call(Ht,Re,me):Ke,me==null)break e;Re=v({},Re,me);break e;case 2:os=!0}}me=D.callback,me!==null&&(n.flags|=64,we&&(n.flags|=8192),we=g.callbacks,we===null?g.callbacks=[me]:we.push(me))}else we={lane:me,tag:D.tag,payload:D.payload,callback:D.callback,next:null},Ae===null?(oe=Ae=we,Y=Re):Ae=Ae.next=we,T|=me;if(D=D.next,D===null){if(D=g.shared.pending,D===null)break;we=D,D=we.next,we.next=null,g.lastBaseUpdate=we,g.shared.pending=null}}while(!0);Ae===null&&(Y=Re),g.baseState=Y,g.firstBaseUpdate=oe,g.lastBaseUpdate=Ae,x===null&&(g.shared.lanes=0),gs|=T,n.lanes=T,n.memoizedState=Re}}function tg(n,i){if(typeof n!="function")throw Error(a(191,n));n.call(i)}function rg(n,i){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)tg(o[n],i)}var Zi=q(null),Jo=q(0);function ag(n,i){n=qn,H(Jo,n),H(Zi,i),qn=n|i.baseLanes}function D0(){H(Jo,qn),H(Zi,Zi.current)}function F0(){qn=Jo.current,C(Zi),C(Jo)}var ya=q(null),Pa=null;function ds(n){var i=n.alternate;H(fr,fr.current&1),H(ya,n),Pa===null&&(i===null||Zi.current!==null||i.memoizedState!==null)&&(Pa=n)}function M0(n){H(fr,fr.current),H(ya,n),Pa===null&&(Pa=n)}function ng(n){n.tag===22?(H(fr,fr.current),H(ya,n),Pa===null&&(Pa=n)):hs()}function hs(){H(fr,fr.current),H(ya,ya.current)}function wa(n){C(ya),Pa===n&&(Pa=null),C(fr)}var fr=q(0);function Qo(n){for(var i=n;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||zd(o)||Hd(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Mn=0,ut=null,Pt=null,xr=null,Zo=!1,el=!1,ti=!1,eu=0,mc=0,tl=null,Vb=0;function ir(){throw Error(a(321))}function B0(n,i){if(i===null)return!1;for(var o=0;o<i.length&&o<n.length;o++)if(!va(n[o],i[o]))return!1;return!0}function L0(n,i,o,d,g,x){return Mn=x,ut=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Q.H=n===null||n.memoizedState===null?zg:Q0,ti=!1,x=o(d,g),ti=!1,el&&(x=ig(i,o,d,g)),sg(n),x}function sg(n){Q.H=xc;var i=Pt!==null&&Pt.next!==null;if(Mn=0,xr=Pt=ut=null,Zo=!1,mc=0,tl=null,i)throw Error(a(300));n===null||vr||(n=n.dependencies,n!==null&&Vo(n)&&(vr=!0))}function ig(n,i,o,d){ut=n;var g=0;do{if(el&&(tl=null),mc=0,el=!1,25<=g)throw Error(a(301));if(g+=1,xr=Pt=null,n.updateQueue!=null){var x=n.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}Q.H=Hg,x=i(o,d)}while(el);return x}function Gb(){var n=Q.H,i=n.useState()[0];return i=typeof i.then=="function"?pc(i):i,n=n.useState()[0],(Pt!==null?Pt.memoizedState:null)!==n&&(ut.flags|=1024),i}function U0(){var n=eu!==0;return eu=0,n}function I0(n,i,o){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~o}function P0(n){if(Zo){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Zo=!1}Mn=0,xr=Pt=ut=null,el=!1,mc=eu=0,tl=null}function ra(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xr===null?ut.memoizedState=xr=n:xr=xr.next=n,xr}function dr(){if(Pt===null){var n=ut.alternate;n=n!==null?n.memoizedState:null}else n=Pt.next;var i=xr===null?ut.memoizedState:xr.next;if(i!==null)xr=i,Pt=n;else{if(n===null)throw ut.alternate===null?Error(a(467)):Error(a(310));Pt=n,n={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},xr===null?ut.memoizedState=xr=n:xr=xr.next=n}return xr}function tu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function pc(n){var i=mc;return mc+=1,tl===null&&(tl=[]),n=Yp(tl,n,i),i=ut,(xr===null?i.memoizedState:xr.next)===null&&(i=i.alternate,Q.H=i===null||i.memoizedState===null?zg:Q0),n}function ru(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return pc(n);if(n.$$typeof===S)return Lr(n)}throw Error(a(438,String(n)))}function z0(n){var i=null,o=ut.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var d=ut.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(i={data:d.data.map(function(g){return g.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=tu(),ut.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(n),d=0;d<n;d++)o[d]=se;return i.index++,o}function Bn(n,i){return typeof i=="function"?i(n):i}function au(n){var i=dr();return H0(i,Pt,n)}function H0(n,i,o){var d=n.queue;if(d===null)throw Error(a(311));d.lastRenderedReducer=o;var g=n.baseQueue,x=d.pending;if(x!==null){if(g!==null){var T=g.next;g.next=x.next,x.next=T}i.baseQueue=g=x,d.pending=null}if(x=n.baseState,g===null)n.memoizedState=x;else{i=g.next;var D=T=null,Y=null,oe=i,Ae=!1;do{var Re=oe.lane&-536870913;if(Re!==oe.lane?(wt&Re)===Re:(Mn&Re)===Re){var me=oe.revertLane;if(me===0)Y!==null&&(Y=Y.next={lane:0,revertLane:0,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),Re===Ki&&(Ae=!0);else if((Mn&me)===me){oe=oe.next,me===Ki&&(Ae=!0);continue}else Re={lane:0,revertLane:oe.revertLane,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},Y===null?(D=Y=Re,T=x):Y=Y.next=Re,ut.lanes|=me,gs|=me;Re=oe.action,ti&&o(x,Re),x=oe.hasEagerState?oe.eagerState:o(x,Re)}else me={lane:Re,revertLane:oe.revertLane,gesture:oe.gesture,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},Y===null?(D=Y=me,T=x):Y=Y.next=me,ut.lanes|=Re,gs|=Re;oe=oe.next}while(oe!==null&&oe!==i);if(Y===null?T=x:Y.next=D,!va(x,n.memoizedState)&&(vr=!0,Ae&&(o=Yi,o!==null)))throw o;n.memoizedState=x,n.baseState=T,n.baseQueue=Y,d.lastRenderedState=x}return g===null&&(d.lanes=0),[n.memoizedState,d.dispatch]}function q0(n){var i=dr(),o=i.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=n;var d=o.dispatch,g=o.pending,x=i.memoizedState;if(g!==null){o.pending=null;var T=g=g.next;do x=n(x,T.action),T=T.next;while(T!==g);va(x,i.memoizedState)||(vr=!0),i.memoizedState=x,i.baseQueue===null&&(i.baseState=x),o.lastRenderedState=x}return[x,d]}function lg(n,i,o){var d=ut,g=dr(),x=Tt;if(x){if(o===void 0)throw Error(a(407));o=o()}else o=i();var T=!va((Pt||g).memoizedState,o);if(T&&(g.memoizedState=o,vr=!0),g=g.queue,$0(ug.bind(null,d,g,n),[n]),g.getSnapshot!==i||T||xr!==null&&xr.memoizedState.tag&1){if(d.flags|=2048,rl(9,{destroy:void 0},og.bind(null,d,g,o,i),null),Vt===null)throw Error(a(349));x||(Mn&127)!==0||cg(d,i,o)}return o}function cg(n,i,o){n.flags|=16384,n={getSnapshot:i,value:o},i=ut.updateQueue,i===null?(i=tu(),ut.updateQueue=i,i.stores=[n]):(o=i.stores,o===null?i.stores=[n]:o.push(n))}function og(n,i,o,d){i.value=o,i.getSnapshot=d,fg(i)&&dg(n)}function ug(n,i,o){return o(function(){fg(i)&&dg(n)})}function fg(n){var i=n.getSnapshot;n=n.value;try{var o=i();return!va(n,o)}catch{return!0}}function dg(n){var i=$s(n,2);i!==null&&ha(i,n,2)}function V0(n){var i=ra();if(typeof n=="function"){var o=n;if(n=o(),ti){ia(!0);try{o()}finally{ia(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bn,lastRenderedState:n},i}function hg(n,i,o,d){return n.baseState=o,H0(n,Pt,typeof d=="function"?d:Bn)}function $b(n,i,o,d,g){if(iu(n))throw Error(a(485));if(n=i.action,n!==null){var x={payload:g,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){x.listeners.push(T)}};Q.T!==null?o(!0):x.isTransition=!1,d(x),o=i.pending,o===null?(x.next=i.pending=x,mg(i,x)):(x.next=o.next,i.pending=o.next=x)}}function mg(n,i){var o=i.action,d=i.payload,g=n.state;if(i.isTransition){var x=Q.T,T={};Q.T=T;try{var D=o(g,d),Y=Q.S;Y!==null&&Y(T,D),pg(n,i,D)}catch(oe){G0(n,i,oe)}finally{x!==null&&T.types!==null&&(x.types=T.types),Q.T=x}}else try{x=o(g,d),pg(n,i,x)}catch(oe){G0(n,i,oe)}}function pg(n,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(d){gg(n,i,d)},function(d){return G0(n,i,d)}):gg(n,i,o)}function gg(n,i,o){i.status="fulfilled",i.value=o,xg(i),n.state=o,i=n.pending,i!==null&&(o=i.next,o===i?n.pending=null:(o=o.next,i.next=o,mg(n,o)))}function G0(n,i,o){var d=n.pending;if(n.pending=null,d!==null){d=d.next;do i.status="rejected",i.reason=o,xg(i),i=i.next;while(i!==d)}n.action=null}function xg(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function vg(n,i){return i}function _g(n,i){if(Tt){var o=Vt.formState;if(o!==null){e:{var d=ut;if(Tt){if(Xt){t:{for(var g=Xt,x=Ia;g.nodeType!==8;){if(!x){g=null;break t}if(g=za(g.nextSibling),g===null){g=null;break t}}x=g.data,g=x==="F!"||x==="F"?g:null}if(g){Xt=za(g.nextSibling),d=g.data==="F!";break e}}ls(d)}d=!1}d&&(i=o[0])}}return o=ra(),o.memoizedState=o.baseState=i,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vg,lastRenderedState:i},o.queue=d,o=Ug.bind(null,ut,d),d.dispatch=o,d=V0(!1),x=J0.bind(null,ut,!1,d.queue),d=ra(),g={state:i,dispatch:null,action:n,pending:null},d.queue=g,o=$b.bind(null,ut,g,x,o),g.dispatch=o,d.memoizedState=n,[i,o,!1]}function yg(n){var i=dr();return wg(i,Pt,n)}function wg(n,i,o){if(i=H0(n,i,vg)[0],n=au(Bn)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var d=pc(i)}catch(T){throw T===Ji?Wo:T}else d=i;i=dr();var g=i.queue,x=g.dispatch;return o!==i.memoizedState&&(ut.flags|=2048,rl(9,{destroy:void 0},Wb.bind(null,g,o),null)),[d,x,n]}function Wb(n,i){n.action=i}function bg(n){var i=dr(),o=Pt;if(o!==null)return wg(i,o,n);dr(),i=i.memoizedState,o=dr();var d=o.queue.dispatch;return o.memoizedState=n,[i,d,!1]}function rl(n,i,o,d){return n={tag:n,create:o,deps:d,inst:i,next:null},i=ut.updateQueue,i===null&&(i=tu(),ut.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=n.next=n:(d=o.next,o.next=n,n.next=d,i.lastEffect=n),n}function Eg(){return dr().memoizedState}function nu(n,i,o,d){var g=ra();ut.flags|=n,g.memoizedState=rl(1|i,{destroy:void 0},o,d===void 0?null:d)}function su(n,i,o,d){var g=dr();d=d===void 0?null:d;var x=g.memoizedState.inst;Pt!==null&&d!==null&&B0(d,Pt.memoizedState.deps)?g.memoizedState=rl(i,x,o,d):(ut.flags|=n,g.memoizedState=rl(1|i,x,o,d))}function Sg(n,i){nu(8390656,8,n,i)}function $0(n,i){su(2048,8,n,i)}function Xb(n){ut.flags|=4;var i=ut.updateQueue;if(i===null)i=tu(),ut.updateQueue=i,i.events=[n];else{var o=i.events;o===null?i.events=[n]:o.push(n)}}function Tg(n){var i=dr().memoizedState;return Xb({ref:i,nextImpl:n}),function(){if((Dt&2)!==0)throw Error(a(440));return i.impl.apply(void 0,arguments)}}function kg(n,i){return su(4,2,n,i)}function Ag(n,i){return su(4,4,n,i)}function jg(n,i){if(typeof i=="function"){n=n();var o=i(n);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function Ng(n,i,o){o=o!=null?o.concat([n]):null,su(4,4,jg.bind(null,i,n),o)}function W0(){}function Cg(n,i){var o=dr();i=i===void 0?null:i;var d=o.memoizedState;return i!==null&&B0(i,d[1])?d[0]:(o.memoizedState=[n,i],n)}function Og(n,i){var o=dr();i=i===void 0?null:i;var d=o.memoizedState;if(i!==null&&B0(i,d[1]))return d[0];if(d=n(),ti){ia(!0);try{n()}finally{ia(!1)}}return o.memoizedState=[d,i],d}function X0(n,i,o){return o===void 0||(Mn&1073741824)!==0&&(wt&261930)===0?n.memoizedState=i:(n.memoizedState=o,n=Rx(),ut.lanes|=n,gs|=n,o)}function Rg(n,i,o,d){return va(o,i)?o:Zi.current!==null?(n=X0(n,o,d),va(n,i)||(vr=!0),n):(Mn&42)===0||(Mn&1073741824)!==0&&(wt&261930)===0?(vr=!0,n.memoizedState=o):(n=Rx(),ut.lanes|=n,gs|=n,i)}function Dg(n,i,o,d,g){var x=le.p;le.p=x!==0&&8>x?x:8;var T=Q.T,D={};Q.T=D,J0(n,!1,i,o);try{var Y=g(),oe=Q.S;if(oe!==null&&oe(D,Y),Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var Ae=qb(Y,d);gc(n,i,Ae,Sa(n))}else gc(n,i,d,Sa(n))}catch(Re){gc(n,i,{then:function(){},status:"rejected",reason:Re},Sa())}finally{le.p=x,T!==null&&D.types!==null&&(T.types=D.types),Q.T=T}}function Kb(){}function K0(n,i,o,d){if(n.tag!==5)throw Error(a(476));var g=Fg(n).queue;Dg(n,g,i,Ee,o===null?Kb:function(){return Mg(n),o(d)})}function Fg(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:Ee,baseState:Ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bn,lastRenderedState:Ee},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bn,lastRenderedState:o},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function Mg(n){var i=Fg(n);i.next===null&&(i=n.alternate.memoizedState),gc(n,i.next.queue,{},Sa())}function Y0(){return Lr(Dc)}function Bg(){return dr().memoizedState}function Lg(){return dr().memoizedState}function Yb(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var o=Sa();n=us(o);var d=fs(i,n,o);d!==null&&(ha(d,i,o),fc(d,i,o)),i={cache:T0()},n.payload=i;return}i=i.return}}function Jb(n,i,o){var d=Sa();o={lane:d,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},iu(n)?Ig(i,o):(o=m0(n,i,o,d),o!==null&&(ha(o,n,d),Pg(o,i,d)))}function Ug(n,i,o){var d=Sa();gc(n,i,o,d)}function gc(n,i,o,d){var g={lane:d,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(iu(n))Ig(i,g);else{var x=n.alternate;if(n.lanes===0&&(x===null||x.lanes===0)&&(x=i.lastRenderedReducer,x!==null))try{var T=i.lastRenderedState,D=x(T,o);if(g.hasEagerState=!0,g.eagerState=D,va(D,T))return Po(n,i,g,0),Vt===null&&Io(),!1}catch{}if(o=m0(n,i,g,d),o!==null)return ha(o,n,d),Pg(o,i,d),!0}return!1}function J0(n,i,o,d){if(d={lane:2,revertLane:Nd(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},iu(n)){if(i)throw Error(a(479))}else i=m0(n,o,d,2),i!==null&&ha(i,n,2)}function iu(n){var i=n.alternate;return n===ut||i!==null&&i===ut}function Ig(n,i){el=Zo=!0;var o=n.pending;o===null?i.next=i:(i.next=o.next,o.next=i),n.pending=i}function Pg(n,i,o){if((o&4194048)!==0){var d=i.lanes;d&=n.pendingLanes,o|=d,i.lanes=o,Mi(n,o)}}var xc={readContext:Lr,use:ru,useCallback:ir,useContext:ir,useEffect:ir,useImperativeHandle:ir,useLayoutEffect:ir,useInsertionEffect:ir,useMemo:ir,useReducer:ir,useRef:ir,useState:ir,useDebugValue:ir,useDeferredValue:ir,useTransition:ir,useSyncExternalStore:ir,useId:ir,useHostTransitionStatus:ir,useFormState:ir,useActionState:ir,useOptimistic:ir,useMemoCache:ir,useCacheRefresh:ir};xc.useEffectEvent=ir;var zg={readContext:Lr,use:ru,useCallback:function(n,i){return ra().memoizedState=[n,i===void 0?null:i],n},useContext:Lr,useEffect:Sg,useImperativeHandle:function(n,i,o){o=o!=null?o.concat([n]):null,nu(4194308,4,jg.bind(null,i,n),o)},useLayoutEffect:function(n,i){return nu(4194308,4,n,i)},useInsertionEffect:function(n,i){nu(4,2,n,i)},useMemo:function(n,i){var o=ra();i=i===void 0?null:i;var d=n();if(ti){ia(!0);try{n()}finally{ia(!1)}}return o.memoizedState=[d,i],d},useReducer:function(n,i,o){var d=ra();if(o!==void 0){var g=o(i);if(ti){ia(!0);try{o(i)}finally{ia(!1)}}}else g=i;return d.memoizedState=d.baseState=g,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:g},d.queue=n,n=n.dispatch=Jb.bind(null,ut,n),[d.memoizedState,n]},useRef:function(n){var i=ra();return n={current:n},i.memoizedState=n},useState:function(n){n=V0(n);var i=n.queue,o=Ug.bind(null,ut,i);return i.dispatch=o,[n.memoizedState,o]},useDebugValue:W0,useDeferredValue:function(n,i){var o=ra();return X0(o,n,i)},useTransition:function(){var n=V0(!1);return n=Dg.bind(null,ut,n.queue,!0,!1),ra().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,o){var d=ut,g=ra();if(Tt){if(o===void 0)throw Error(a(407));o=o()}else{if(o=i(),Vt===null)throw Error(a(349));(wt&127)!==0||cg(d,i,o)}g.memoizedState=o;var x={value:o,getSnapshot:i};return g.queue=x,Sg(ug.bind(null,d,x,n),[n]),d.flags|=2048,rl(9,{destroy:void 0},og.bind(null,d,x,o,i),null),o},useId:function(){var n=ra(),i=Vt.identifierPrefix;if(Tt){var o=mn,d=hn;o=(d&~(1<<32-Mr(d)-1)).toString(32)+o,i="_"+i+"R_"+o,o=eu++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=Vb++,i="_"+i+"r_"+o.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:Y0,useFormState:_g,useActionState:_g,useOptimistic:function(n){var i=ra();i.memoizedState=i.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=J0.bind(null,ut,!0,o),o.dispatch=i,[n,i]},useMemoCache:z0,useCacheRefresh:function(){return ra().memoizedState=Yb.bind(null,ut)},useEffectEvent:function(n){var i=ra(),o={impl:n};return i.memoizedState=o,function(){if((Dt&2)!==0)throw Error(a(440));return o.impl.apply(void 0,arguments)}}},Q0={readContext:Lr,use:ru,useCallback:Cg,useContext:Lr,useEffect:$0,useImperativeHandle:Ng,useInsertionEffect:kg,useLayoutEffect:Ag,useMemo:Og,useReducer:au,useRef:Eg,useState:function(){return au(Bn)},useDebugValue:W0,useDeferredValue:function(n,i){var o=dr();return Rg(o,Pt.memoizedState,n,i)},useTransition:function(){var n=au(Bn)[0],i=dr().memoizedState;return[typeof n=="boolean"?n:pc(n),i]},useSyncExternalStore:lg,useId:Bg,useHostTransitionStatus:Y0,useFormState:yg,useActionState:yg,useOptimistic:function(n,i){var o=dr();return hg(o,Pt,n,i)},useMemoCache:z0,useCacheRefresh:Lg};Q0.useEffectEvent=Tg;var Hg={readContext:Lr,use:ru,useCallback:Cg,useContext:Lr,useEffect:$0,useImperativeHandle:Ng,useInsertionEffect:kg,useLayoutEffect:Ag,useMemo:Og,useReducer:q0,useRef:Eg,useState:function(){return q0(Bn)},useDebugValue:W0,useDeferredValue:function(n,i){var o=dr();return Pt===null?X0(o,n,i):Rg(o,Pt.memoizedState,n,i)},useTransition:function(){var n=q0(Bn)[0],i=dr().memoizedState;return[typeof n=="boolean"?n:pc(n),i]},useSyncExternalStore:lg,useId:Bg,useHostTransitionStatus:Y0,useFormState:bg,useActionState:bg,useOptimistic:function(n,i){var o=dr();return Pt!==null?hg(o,Pt,n,i):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:z0,useCacheRefresh:Lg};Hg.useEffectEvent=Tg;function Z0(n,i,o,d){i=n.memoizedState,o=o(d,i),o=o==null?i:v({},i,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var ed={enqueueSetState:function(n,i,o){n=n._reactInternals;var d=Sa(),g=us(d);g.payload=i,o!=null&&(g.callback=o),i=fs(n,g,d),i!==null&&(ha(i,n,d),fc(i,n,d))},enqueueReplaceState:function(n,i,o){n=n._reactInternals;var d=Sa(),g=us(d);g.tag=1,g.payload=i,o!=null&&(g.callback=o),i=fs(n,g,d),i!==null&&(ha(i,n,d),fc(i,n,d))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var o=Sa(),d=us(o);d.tag=2,i!=null&&(d.callback=i),i=fs(n,d,o),i!==null&&(ha(i,n,o),fc(i,n,o))}};function qg(n,i,o,d,g,x,T){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(d,x,T):i.prototype&&i.prototype.isPureReactComponent?!ac(o,d)||!ac(g,x):!0}function Vg(n,i,o,d){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,d),i.state!==n&&ed.enqueueReplaceState(i,i.state,null)}function ri(n,i){var o=i;if("ref"in i){o={};for(var d in i)d!=="ref"&&(o[d]=i[d])}if(n=n.defaultProps){o===i&&(o=v({},o));for(var g in n)o[g]===void 0&&(o[g]=n[g])}return o}function Gg(n){Uo(n)}function $g(n){console.error(n)}function Wg(n){Uo(n)}function lu(n,i){try{var o=n.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(d){setTimeout(function(){throw d})}}function Xg(n,i,o){try{var d=n.onCaughtError;d(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function td(n,i,o){return o=us(o),o.tag=3,o.payload={element:null},o.callback=function(){lu(n,i)},o}function Kg(n){return n=us(n),n.tag=3,n}function Yg(n,i,o,d){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var x=d.value;n.payload=function(){return g(x)},n.callback=function(){Xg(i,o,d)}}var T=o.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(n.callback=function(){Xg(i,o,d),typeof g!="function"&&(xs===null?xs=new Set([this]):xs.add(this));var D=d.stack;this.componentDidCatch(d.value,{componentStack:D!==null?D:""})})}function Qb(n,i,o,d,g){if(o.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(i=o.alternate,i!==null&&Xi(i,o,g,!0),o=ya.current,o!==null){switch(o.tag){case 31:case 13:return Pa===null?_u():o.alternate===null&&lr===0&&(lr=3),o.flags&=-257,o.flags|=65536,o.lanes=g,d===Xo?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([d]):i.add(d),kd(n,d,g)),!1;case 22:return o.flags|=65536,d===Xo?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([d])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([d]):o.add(d)),kd(n,d,g)),!1}throw Error(a(435,o.tag))}return kd(n,d,g),_u(),!1}if(Tt)return i=ya.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=g,d!==y0&&(n=Error(a(422),{cause:d}),ic(Ba(n,o)))):(d!==y0&&(i=Error(a(423),{cause:d}),ic(Ba(i,o))),n=n.current.alternate,n.flags|=65536,g&=-g,n.lanes|=g,d=Ba(d,o),g=td(n.stateNode,d,g),O0(n,g),lr!==4&&(lr=2)),!1;var x=Error(a(520),{cause:d});if(x=Ba(x,o),Tc===null?Tc=[x]:Tc.push(x),lr!==4&&(lr=2),i===null)return!0;d=Ba(d,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,n=g&-g,o.lanes|=n,n=td(o.stateNode,d,n),O0(o,n),!1;case 1:if(i=o.type,x=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(xs===null||!xs.has(x))))return o.flags|=65536,g&=-g,o.lanes|=g,g=Kg(g),Yg(g,n,o,d),O0(o,g),!1}o=o.return}while(o!==null);return!1}var rd=Error(a(461)),vr=!1;function Ur(n,i,o,d){i.child=n===null?eg(i,null,o,d):ei(i,n.child,o,d)}function Jg(n,i,o,d,g){o=o.render;var x=i.ref;if("ref"in d){var T={};for(var D in d)D!=="ref"&&(T[D]=d[D])}else T=d;return Ys(i),d=L0(n,i,o,T,x,g),D=U0(),n!==null&&!vr?(I0(n,i,g),Ln(n,i,g)):(Tt&&D&&v0(i),i.flags|=1,Ur(n,i,d,g),i.child)}function Qg(n,i,o,d,g){if(n===null){var x=o.type;return typeof x=="function"&&!p0(x)&&x.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=x,Zg(n,i,x,d,g)):(n=Ho(o.type,null,d,i,i.mode,g),n.ref=i.ref,n.return=i,i.child=n)}if(x=n.child,!ud(n,g)){var T=x.memoizedProps;if(o=o.compare,o=o!==null?o:ac,o(T,d)&&n.ref===i.ref)return Ln(n,i,g)}return i.flags|=1,n=On(x,d),n.ref=i.ref,n.return=i,i.child=n}function Zg(n,i,o,d,g){if(n!==null){var x=n.memoizedProps;if(ac(x,d)&&n.ref===i.ref)if(vr=!1,i.pendingProps=d=x,ud(n,g))(n.flags&131072)!==0&&(vr=!0);else return i.lanes=n.lanes,Ln(n,i,g)}return ad(n,i,o,d,g)}function ex(n,i,o,d){var g=d.children,x=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((i.flags&128)!==0){if(x=x!==null?x.baseLanes|o:o,n!==null){for(d=i.child=n.child,g=0;d!==null;)g=g|d.lanes|d.childLanes,d=d.sibling;d=g&~x}else d=0,i.child=null;return tx(n,i,x,o,d)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&$o(i,x!==null?x.cachePool:null),x!==null?ag(i,x):D0(),ng(i);else return d=i.lanes=536870912,tx(n,i,x!==null?x.baseLanes|o:o,o,d)}else x!==null?($o(i,x.cachePool),ag(i,x),hs(),i.memoizedState=null):(n!==null&&$o(i,null),D0(),hs());return Ur(n,i,g,o),i.child}function vc(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function tx(n,i,o,d,g){var x=A0();return x=x===null?null:{parent:gr._currentValue,pool:x},i.memoizedState={baseLanes:o,cachePool:x},n!==null&&$o(i,null),D0(),ng(i),n!==null&&Xi(n,i,d,!0),i.childLanes=g,null}function cu(n,i){return i=uu({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function rx(n,i,o){return ei(i,n.child,null,o),n=cu(i,i.pendingProps),n.flags|=2,wa(i),i.memoizedState=null,n}function Zb(n,i,o){var d=i.pendingProps,g=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(Tt){if(d.mode==="hidden")return n=cu(i,d),i.lanes=536870912,vc(null,n);if(M0(i),(n=Xt)?(n=mv(n,Ia),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:ss!==null?{id:hn,overflow:mn}:null,retryLane:536870912,hydrationErrors:null},o=Ip(n),o.return=i,i.child=o,Br=i,Xt=null)):n=null,n===null)throw ls(i);return i.lanes=536870912,null}return cu(i,d)}var x=n.memoizedState;if(x!==null){var T=x.dehydrated;if(M0(i),g)if(i.flags&256)i.flags&=-257,i=rx(n,i,o);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(a(558));else if(vr||Xi(n,i,o,!1),g=(o&n.childLanes)!==0,vr||g){if(d=Vt,d!==null&&(T=jo(d,o),T!==0&&T!==x.retryLane))throw x.retryLane=T,$s(n,T),ha(d,n,T),rd;_u(),i=rx(n,i,o)}else n=x.treeContext,Xt=za(T.nextSibling),Br=i,Tt=!0,is=null,Ia=!1,n!==null&&Hp(i,n),i=cu(i,d),i.flags|=4096;return i}return n=On(n.child,{mode:d.mode,children:d.children}),n.ref=i.ref,i.child=n,n.return=i,n}function ou(n,i){var o=i.ref;if(o===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(a(284));(n===null||n.ref!==o)&&(i.flags|=4194816)}}function ad(n,i,o,d,g){return Ys(i),o=L0(n,i,o,d,void 0,g),d=U0(),n!==null&&!vr?(I0(n,i,g),Ln(n,i,g)):(Tt&&d&&v0(i),i.flags|=1,Ur(n,i,o,g),i.child)}function ax(n,i,o,d,g,x){return Ys(i),i.updateQueue=null,o=ig(i,d,o,g),sg(n),d=U0(),n!==null&&!vr?(I0(n,i,x),Ln(n,i,x)):(Tt&&d&&v0(i),i.flags|=1,Ur(n,i,o,x),i.child)}function nx(n,i,o,d,g){if(Ys(i),i.stateNode===null){var x=Vi,T=o.contextType;typeof T=="object"&&T!==null&&(x=Lr(T)),x=new o(d,x),i.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=ed,i.stateNode=x,x._reactInternals=i,x=i.stateNode,x.props=d,x.state=i.memoizedState,x.refs={},N0(i),T=o.contextType,x.context=typeof T=="object"&&T!==null?Lr(T):Vi,x.state=i.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(Z0(i,o,T,d),x.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(T=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),T!==x.state&&ed.enqueueReplaceState(x,x.state,null),hc(i,d,x,g),dc(),x.state=i.memoizedState),typeof x.componentDidMount=="function"&&(i.flags|=4194308),d=!0}else if(n===null){x=i.stateNode;var D=i.memoizedProps,Y=ri(o,D);x.props=Y;var oe=x.context,Ae=o.contextType;T=Vi,typeof Ae=="object"&&Ae!==null&&(T=Lr(Ae));var Re=o.getDerivedStateFromProps;Ae=typeof Re=="function"||typeof x.getSnapshotBeforeUpdate=="function",D=i.pendingProps!==D,Ae||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(D||oe!==T)&&Vg(i,x,d,T),os=!1;var me=i.memoizedState;x.state=me,hc(i,d,x,g),dc(),oe=i.memoizedState,D||me!==oe||os?(typeof Re=="function"&&(Z0(i,o,Re,d),oe=i.memoizedState),(Y=os||qg(i,o,Y,d,me,oe,T))?(Ae||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(i.flags|=4194308)):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=oe),x.props=d,x.state=oe,x.context=T,d=Y):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{x=i.stateNode,C0(n,i),T=i.memoizedProps,Ae=ri(o,T),x.props=Ae,Re=i.pendingProps,me=x.context,oe=o.contextType,Y=Vi,typeof oe=="object"&&oe!==null&&(Y=Lr(oe)),D=o.getDerivedStateFromProps,(oe=typeof D=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(T!==Re||me!==Y)&&Vg(i,x,d,Y),os=!1,me=i.memoizedState,x.state=me,hc(i,d,x,g),dc();var we=i.memoizedState;T!==Re||me!==we||os||n!==null&&n.dependencies!==null&&Vo(n.dependencies)?(typeof D=="function"&&(Z0(i,o,D,d),we=i.memoizedState),(Ae=os||qg(i,o,Ae,d,me,we,Y)||n!==null&&n.dependencies!==null&&Vo(n.dependencies))?(oe||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(d,we,Y),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(d,we,Y)),typeof x.componentDidUpdate=="function"&&(i.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof x.componentDidUpdate!="function"||T===n.memoizedProps&&me===n.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&me===n.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=we),x.props=d,x.state=we,x.context=Y,d=Ae):(typeof x.componentDidUpdate!="function"||T===n.memoizedProps&&me===n.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&me===n.memoizedState||(i.flags|=1024),d=!1)}return x=d,ou(n,i),d=(i.flags&128)!==0,x||d?(x=i.stateNode,o=d&&typeof o.getDerivedStateFromError!="function"?null:x.render(),i.flags|=1,n!==null&&d?(i.child=ei(i,n.child,null,g),i.child=ei(i,null,o,g)):Ur(n,i,o,g),i.memoizedState=x.state,n=i.child):n=Ln(n,i,g),n}function sx(n,i,o,d){return Xs(),i.flags|=256,Ur(n,i,o,d),i.child}var nd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function sd(n){return{baseLanes:n,cachePool:Xp()}}function id(n,i,o){return n=n!==null?n.childLanes&~o:0,i&&(n|=Ea),n}function ix(n,i,o){var d=i.pendingProps,g=!1,x=(i.flags&128)!==0,T;if((T=x)||(T=n!==null&&n.memoizedState===null?!1:(fr.current&2)!==0),T&&(g=!0,i.flags&=-129),T=(i.flags&32)!==0,i.flags&=-33,n===null){if(Tt){if(g?ds(i):hs(),(n=Xt)?(n=mv(n,Ia),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:ss!==null?{id:hn,overflow:mn}:null,retryLane:536870912,hydrationErrors:null},o=Ip(n),o.return=i,i.child=o,Br=i,Xt=null)):n=null,n===null)throw ls(i);return Hd(n)?i.lanes=32:i.lanes=536870912,null}var D=d.children;return d=d.fallback,g?(hs(),g=i.mode,D=uu({mode:"hidden",children:D},g),d=Ws(d,g,o,null),D.return=i,d.return=i,D.sibling=d,i.child=D,d=i.child,d.memoizedState=sd(o),d.childLanes=id(n,T,o),i.memoizedState=nd,vc(null,d)):(ds(i),ld(i,D))}var Y=n.memoizedState;if(Y!==null&&(D=Y.dehydrated,D!==null)){if(x)i.flags&256?(ds(i),i.flags&=-257,i=cd(n,i,o)):i.memoizedState!==null?(hs(),i.child=n.child,i.flags|=128,i=null):(hs(),D=d.fallback,g=i.mode,d=uu({mode:"visible",children:d.children},g),D=Ws(D,g,o,null),D.flags|=2,d.return=i,D.return=i,d.sibling=D,i.child=d,ei(i,n.child,null,o),d=i.child,d.memoizedState=sd(o),d.childLanes=id(n,T,o),i.memoizedState=nd,i=vc(null,d));else if(ds(i),Hd(D)){if(T=D.nextSibling&&D.nextSibling.dataset,T)var oe=T.dgst;T=oe,d=Error(a(419)),d.stack="",d.digest=T,ic({value:d,source:null,stack:null}),i=cd(n,i,o)}else if(vr||Xi(n,i,o,!1),T=(o&n.childLanes)!==0,vr||T){if(T=Vt,T!==null&&(d=jo(T,o),d!==0&&d!==Y.retryLane))throw Y.retryLane=d,$s(n,d),ha(T,n,d),rd;zd(D)||_u(),i=cd(n,i,o)}else zd(D)?(i.flags|=192,i.child=n.child,i=null):(n=Y.treeContext,Xt=za(D.nextSibling),Br=i,Tt=!0,is=null,Ia=!1,n!==null&&Hp(i,n),i=ld(i,d.children),i.flags|=4096);return i}return g?(hs(),D=d.fallback,g=i.mode,Y=n.child,oe=Y.sibling,d=On(Y,{mode:"hidden",children:d.children}),d.subtreeFlags=Y.subtreeFlags&65011712,oe!==null?D=On(oe,D):(D=Ws(D,g,o,null),D.flags|=2),D.return=i,d.return=i,d.sibling=D,i.child=d,vc(null,d),d=i.child,D=n.child.memoizedState,D===null?D=sd(o):(g=D.cachePool,g!==null?(Y=gr._currentValue,g=g.parent!==Y?{parent:Y,pool:Y}:g):g=Xp(),D={baseLanes:D.baseLanes|o,cachePool:g}),d.memoizedState=D,d.childLanes=id(n,T,o),i.memoizedState=nd,vc(n.child,d)):(ds(i),o=n.child,n=o.sibling,o=On(o,{mode:"visible",children:d.children}),o.return=i,o.sibling=null,n!==null&&(T=i.deletions,T===null?(i.deletions=[n],i.flags|=16):T.push(n)),i.child=o,i.memoizedState=null,o)}function ld(n,i){return i=uu({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function uu(n,i){return n=_a(22,n,null,i),n.lanes=0,n}function cd(n,i,o){return ei(i,n.child,null,o),n=ld(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function lx(n,i,o){n.lanes|=i;var d=n.alternate;d!==null&&(d.lanes|=i),E0(n.return,i,o)}function od(n,i,o,d,g,x){var T=n.memoizedState;T===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:o,tailMode:g,treeForkCount:x}:(T.isBackwards=i,T.rendering=null,T.renderingStartTime=0,T.last=d,T.tail=o,T.tailMode=g,T.treeForkCount=x)}function cx(n,i,o){var d=i.pendingProps,g=d.revealOrder,x=d.tail;d=d.children;var T=fr.current,D=(T&2)!==0;if(D?(T=T&1|2,i.flags|=128):T&=1,H(fr,T),Ur(n,i,d,o),d=Tt?sc:0,!D&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&lx(n,o,i);else if(n.tag===19)lx(n,o,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(g){case"forwards":for(o=i.child,g=null;o!==null;)n=o.alternate,n!==null&&Qo(n)===null&&(g=o),o=o.sibling;o=g,o===null?(g=i.child,i.child=null):(g=o.sibling,o.sibling=null),od(i,!1,g,o,x,d);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=i.child,i.child=null;g!==null;){if(n=g.alternate,n!==null&&Qo(n)===null){i.child=g;break}n=g.sibling,g.sibling=o,o=g,g=n}od(i,!0,o,null,x,d);break;case"together":od(i,!1,null,null,void 0,d);break;default:i.memoizedState=null}return i.child}function Ln(n,i,o){if(n!==null&&(i.dependencies=n.dependencies),gs|=i.lanes,(o&i.childLanes)===0)if(n!==null){if(Xi(n,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(a(153));if(i.child!==null){for(n=i.child,o=On(n,n.pendingProps),i.child=o,o.return=i;n.sibling!==null;)n=n.sibling,o=o.sibling=On(n,n.pendingProps),o.return=i;o.sibling=null}return i.child}function ud(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&Vo(n)))}function eE(n,i,o){switch(i.tag){case 3:de(i,i.stateNode.containerInfo),cs(i,gr,n.memoizedState.cache),Xs();break;case 27:case 5:Se(i);break;case 4:de(i,i.stateNode.containerInfo);break;case 10:cs(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,M0(i),null;break;case 13:var d=i.memoizedState;if(d!==null)return d.dehydrated!==null?(ds(i),i.flags|=128,null):(o&i.child.childLanes)!==0?ix(n,i,o):(ds(i),n=Ln(n,i,o),n!==null?n.sibling:null);ds(i);break;case 19:var g=(n.flags&128)!==0;if(d=(o&i.childLanes)!==0,d||(Xi(n,i,o,!1),d=(o&i.childLanes)!==0),g){if(d)return cx(n,i,o);i.flags|=128}if(g=i.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),H(fr,fr.current),d)break;return null;case 22:return i.lanes=0,ex(n,i,o,i.pendingProps);case 24:cs(i,gr,n.memoizedState.cache)}return Ln(n,i,o)}function ox(n,i,o){if(n!==null)if(n.memoizedProps!==i.pendingProps)vr=!0;else{if(!ud(n,o)&&(i.flags&128)===0)return vr=!1,eE(n,i,o);vr=(n.flags&131072)!==0}else vr=!1,Tt&&(i.flags&1048576)!==0&&zp(i,sc,i.index);switch(i.lanes=0,i.tag){case 16:e:{var d=i.pendingProps;if(n=Qs(i.elementType),i.type=n,typeof n=="function")p0(n)?(d=ri(n,d),i.tag=1,i=nx(null,i,n,d,o)):(i.tag=0,i=ad(null,i,n,d,o));else{if(n!=null){var g=n.$$typeof;if(g===j){i.tag=11,i=Jg(null,i,n,d,o);break e}else if(g===N){i.tag=14,i=Qg(null,i,n,d,o);break e}}throw i=Oe(n)||n,Error(a(306,i,""))}}return i;case 0:return ad(n,i,i.type,i.pendingProps,o);case 1:return d=i.type,g=ri(d,i.pendingProps),nx(n,i,d,g,o);case 3:e:{if(de(i,i.stateNode.containerInfo),n===null)throw Error(a(387));d=i.pendingProps;var x=i.memoizedState;g=x.element,C0(n,i),hc(i,d,null,o);var T=i.memoizedState;if(d=T.cache,cs(i,gr,d),d!==x.cache&&S0(i,[gr],o,!0),dc(),d=T.element,x.isDehydrated)if(x={element:d,isDehydrated:!1,cache:T.cache},i.updateQueue.baseState=x,i.memoizedState=x,i.flags&256){i=sx(n,i,d,o);break e}else if(d!==g){g=Ba(Error(a(424)),i),ic(g),i=sx(n,i,d,o);break e}else{switch(n=i.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(Xt=za(n.firstChild),Br=i,Tt=!0,is=null,Ia=!0,o=eg(i,null,d,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Xs(),d===g){i=Ln(n,i,o);break e}Ur(n,i,d,o)}i=i.child}return i;case 26:return ou(n,i),n===null?(o=yv(i.type,null,i.pendingProps,null))?i.memoizedState=o:Tt||(o=i.type,n=i.pendingProps,d=ku(Z.current).createElement(o),d[B]=i,d[P]=n,Ir(d,o,n),Ye(d),i.stateNode=d):i.memoizedState=yv(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return Se(i),n===null&&Tt&&(d=i.stateNode=xv(i.type,i.pendingProps,Z.current),Br=i,Ia=!0,g=Xt,ws(i.type)?(qd=g,Xt=za(d.firstChild)):Xt=g),Ur(n,i,i.pendingProps.children,o),ou(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&Tt&&((g=d=Xt)&&(d=CE(d,i.type,i.pendingProps,Ia),d!==null?(i.stateNode=d,Br=i,Xt=za(d.firstChild),Ia=!1,g=!0):g=!1),g||ls(i)),Se(i),g=i.type,x=i.pendingProps,T=n!==null?n.memoizedProps:null,d=x.children,Ud(g,x)?d=null:T!==null&&Ud(g,T)&&(i.flags|=32),i.memoizedState!==null&&(g=L0(n,i,Gb,null,null,o),Dc._currentValue=g),ou(n,i),Ur(n,i,d,o),i.child;case 6:return n===null&&Tt&&((n=o=Xt)&&(o=OE(o,i.pendingProps,Ia),o!==null?(i.stateNode=o,Br=i,Xt=null,n=!0):n=!1),n||ls(i)),null;case 13:return ix(n,i,o);case 4:return de(i,i.stateNode.containerInfo),d=i.pendingProps,n===null?i.child=ei(i,null,d,o):Ur(n,i,d,o),i.child;case 11:return Jg(n,i,i.type,i.pendingProps,o);case 7:return Ur(n,i,i.pendingProps,o),i.child;case 8:return Ur(n,i,i.pendingProps.children,o),i.child;case 12:return Ur(n,i,i.pendingProps.children,o),i.child;case 10:return d=i.pendingProps,cs(i,i.type,d.value),Ur(n,i,d.children,o),i.child;case 9:return g=i.type._context,d=i.pendingProps.children,Ys(i),g=Lr(g),d=d(g),i.flags|=1,Ur(n,i,d,o),i.child;case 14:return Qg(n,i,i.type,i.pendingProps,o);case 15:return Zg(n,i,i.type,i.pendingProps,o);case 19:return cx(n,i,o);case 31:return Zb(n,i,o);case 22:return ex(n,i,o,i.pendingProps);case 24:return Ys(i),d=Lr(gr),n===null?(g=A0(),g===null&&(g=Vt,x=T0(),g.pooledCache=x,x.refCount++,x!==null&&(g.pooledCacheLanes|=o),g=x),i.memoizedState={parent:d,cache:g},N0(i),cs(i,gr,g)):((n.lanes&o)!==0&&(C0(n,i),hc(i,null,null,o),dc()),g=n.memoizedState,x=i.memoizedState,g.parent!==d?(g={parent:d,cache:d},i.memoizedState=g,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=g),cs(i,gr,d)):(d=x.cache,cs(i,gr,d),d!==g.cache&&S0(i,[gr],o,!0))),Ur(n,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function Un(n){n.flags|=4}function fd(n,i,o,d,g){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(g&335544128)===g)if(n.stateNode.complete)n.flags|=8192;else if(Bx())n.flags|=8192;else throw Zs=Xo,j0}else n.flags&=-16777217}function ux(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Tv(i))if(Bx())n.flags|=8192;else throw Zs=Xo,j0}function fu(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?Pe():536870912,n.lanes|=i,il|=i)}function _c(n,i){if(!Tt)switch(n.tailMode){case"hidden":i=n.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:d.sibling=null}}function Kt(n){var i=n.alternate!==null&&n.alternate.child===n.child,o=0,d=0;if(i)for(var g=n.child;g!==null;)o|=g.lanes|g.childLanes,d|=g.subtreeFlags&65011712,d|=g.flags&65011712,g.return=n,g=g.sibling;else for(g=n.child;g!==null;)o|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=n,g=g.sibling;return n.subtreeFlags|=d,n.childLanes=o,i}function tE(n,i,o){var d=i.pendingProps;switch(_0(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(i),null;case 1:return Kt(i),null;case 3:return o=i.stateNode,d=null,n!==null&&(d=n.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),Fn(gr),ve(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(Wi(i)?Un(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,w0())),Kt(i),null;case 26:var g=i.type,x=i.memoizedState;return n===null?(Un(i),x!==null?(Kt(i),ux(i,x)):(Kt(i),fd(i,g,null,d,o))):x?x!==n.memoizedState?(Un(i),Kt(i),ux(i,x)):(Kt(i),i.flags&=-16777217):(n=n.memoizedProps,n!==d&&Un(i),Kt(i),fd(i,g,n,d,o)),null;case 27:if(xe(i),o=Z.current,g=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==d&&Un(i);else{if(!d){if(i.stateNode===null)throw Error(a(166));return Kt(i),null}n=I.current,Wi(i)?qp(i):(n=xv(g,d,o),i.stateNode=n,Un(i))}return Kt(i),null;case 5:if(xe(i),g=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==d&&Un(i);else{if(!d){if(i.stateNode===null)throw Error(a(166));return Kt(i),null}if(x=I.current,Wi(i))qp(i);else{var T=ku(Z.current);switch(x){case 1:x=T.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:x=T.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":x=T.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":x=T.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":x=T.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof d.is=="string"?T.createElement("select",{is:d.is}):T.createElement("select"),d.multiple?x.multiple=!0:d.size&&(x.size=d.size);break;default:x=typeof d.is=="string"?T.createElement(g,{is:d.is}):T.createElement(g)}}x[B]=i,x[P]=d;e:for(T=i.child;T!==null;){if(T.tag===5||T.tag===6)x.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===i)break e;for(;T.sibling===null;){if(T.return===null||T.return===i)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}i.stateNode=x;e:switch(Ir(x,g,d),g){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&Un(i)}}return Kt(i),fd(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,o),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==d&&Un(i);else{if(typeof d!="string"&&i.stateNode===null)throw Error(a(166));if(n=Z.current,Wi(i)){if(n=i.stateNode,o=i.memoizedProps,d=null,g=Br,g!==null)switch(g.tag){case 27:case 5:d=g.memoizedProps}n[B]=i,n=!!(n.nodeValue===o||d!==null&&d.suppressHydrationWarning===!0||iv(n.nodeValue,o)),n||ls(i,!0)}else n=ku(n).createTextNode(d),n[B]=i,i.stateNode=n}return Kt(i),null;case 31:if(o=i.memoizedState,n===null||n.memoizedState!==null){if(d=Wi(i),o!==null){if(n===null){if(!d)throw Error(a(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(557));n[B]=i}else Xs(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Kt(i),n=!1}else o=w0(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return i.flags&256?(wa(i),i):(wa(i),null);if((i.flags&128)!==0)throw Error(a(558))}return Kt(i),null;case 13:if(d=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(g=Wi(i),d!==null&&d.dehydrated!==null){if(n===null){if(!g)throw Error(a(318));if(g=i.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(a(317));g[B]=i}else Xs(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Kt(i),g=!1}else g=w0(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=g),g=!0;if(!g)return i.flags&256?(wa(i),i):(wa(i),null)}return wa(i),(i.flags&128)!==0?(i.lanes=o,i):(o=d!==null,n=n!==null&&n.memoizedState!==null,o&&(d=i.child,g=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(g=d.alternate.memoizedState.cachePool.pool),x=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(x=d.memoizedState.cachePool.pool),x!==g&&(d.flags|=2048)),o!==n&&o&&(i.child.flags|=8192),fu(i,i.updateQueue),Kt(i),null);case 4:return ve(),n===null&&Dd(i.stateNode.containerInfo),Kt(i),null;case 10:return Fn(i.type),Kt(i),null;case 19:if(C(fr),d=i.memoizedState,d===null)return Kt(i),null;if(g=(i.flags&128)!==0,x=d.rendering,x===null)if(g)_c(d,!1);else{if(lr!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(x=Qo(n),x!==null){for(i.flags|=128,_c(d,!1),n=x.updateQueue,i.updateQueue=n,fu(i,n),i.subtreeFlags=0,n=o,o=i.child;o!==null;)Up(o,n),o=o.sibling;return H(fr,fr.current&1|2),Tt&&Rn(i,d.treeForkCount),i.child}n=n.sibling}d.tail!==null&&At()>gu&&(i.flags|=128,g=!0,_c(d,!1),i.lanes=4194304)}else{if(!g)if(n=Qo(x),n!==null){if(i.flags|=128,g=!0,n=n.updateQueue,i.updateQueue=n,fu(i,n),_c(d,!0),d.tail===null&&d.tailMode==="hidden"&&!x.alternate&&!Tt)return Kt(i),null}else 2*At()-d.renderingStartTime>gu&&o!==536870912&&(i.flags|=128,g=!0,_c(d,!1),i.lanes=4194304);d.isBackwards?(x.sibling=i.child,i.child=x):(n=d.last,n!==null?n.sibling=x:i.child=x,d.last=x)}return d.tail!==null?(n=d.tail,d.rendering=n,d.tail=n.sibling,d.renderingStartTime=At(),n.sibling=null,o=fr.current,H(fr,g?o&1|2:o&1),Tt&&Rn(i,d.treeForkCount),n):(Kt(i),null);case 22:case 23:return wa(i),F0(),d=i.memoizedState!==null,n!==null?n.memoizedState!==null!==d&&(i.flags|=8192):d&&(i.flags|=8192),d?(o&536870912)!==0&&(i.flags&128)===0&&(Kt(i),i.subtreeFlags&6&&(i.flags|=8192)):Kt(i),o=i.updateQueue,o!==null&&fu(i,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),d=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),d!==o&&(i.flags|=2048),n!==null&&C(Js),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Fn(gr),Kt(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function rE(n,i){switch(_0(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Fn(gr),ve(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return xe(i),null;case 31:if(i.memoizedState!==null){if(wa(i),i.alternate===null)throw Error(a(340));Xs()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(wa(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(a(340));Xs()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return C(fr),null;case 4:return ve(),null;case 10:return Fn(i.type),null;case 22:case 23:return wa(i),F0(),n!==null&&C(Js),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return Fn(gr),null;case 25:return null;default:return null}}function fx(n,i){switch(_0(i),i.tag){case 3:Fn(gr),ve();break;case 26:case 27:case 5:xe(i);break;case 4:ve();break;case 31:i.memoizedState!==null&&wa(i);break;case 13:wa(i);break;case 19:C(fr);break;case 10:Fn(i.type);break;case 22:case 23:wa(i),F0(),n!==null&&C(Js);break;case 24:Fn(gr)}}function yc(n,i){try{var o=i.updateQueue,d=o!==null?o.lastEffect:null;if(d!==null){var g=d.next;o=g;do{if((o.tag&n)===n){d=void 0;var x=o.create,T=o.inst;d=x(),T.destroy=d}o=o.next}while(o!==g)}}catch(D){Bt(i,i.return,D)}}function ms(n,i,o){try{var d=i.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var x=g.next;d=x;do{if((d.tag&n)===n){var T=d.inst,D=T.destroy;if(D!==void 0){T.destroy=void 0,g=i;var Y=o,oe=D;try{oe()}catch(Ae){Bt(g,Y,Ae)}}}d=d.next}while(d!==x)}}catch(Ae){Bt(i,i.return,Ae)}}function dx(n){var i=n.updateQueue;if(i!==null){var o=n.stateNode;try{rg(i,o)}catch(d){Bt(n,n.return,d)}}}function hx(n,i,o){o.props=ri(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(d){Bt(n,i,d)}}function wc(n,i){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var d=n.stateNode;break;case 30:d=n.stateNode;break;default:d=n.stateNode}typeof o=="function"?n.refCleanup=o(d):o.current=d}}catch(g){Bt(n,i,g)}}function pn(n,i){var o=n.ref,d=n.refCleanup;if(o!==null)if(typeof d=="function")try{d()}catch(g){Bt(n,i,g)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){Bt(n,i,g)}else o.current=null}function mx(n){var i=n.type,o=n.memoizedProps,d=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&d.focus();break e;case"img":o.src?d.src=o.src:o.srcSet&&(d.srcset=o.srcSet)}}catch(g){Bt(n,n.return,g)}}function dd(n,i,o){try{var d=n.stateNode;SE(d,n.type,o,i),d[P]=i}catch(g){Bt(n,n.return,g)}}function px(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&ws(n.type)||n.tag===4}function hd(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||px(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&ws(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function md(n,i,o){var d=n.tag;if(d===5||d===6)n=n.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(n),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=Nn));else if(d!==4&&(d===27&&ws(n.type)&&(o=n.stateNode,i=null),n=n.child,n!==null))for(md(n,i,o),n=n.sibling;n!==null;)md(n,i,o),n=n.sibling}function du(n,i,o){var d=n.tag;if(d===5||d===6)n=n.stateNode,i?o.insertBefore(n,i):o.appendChild(n);else if(d!==4&&(d===27&&ws(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(du(n,i,o),n=n.sibling;n!==null;)du(n,i,o),n=n.sibling}function gx(n){var i=n.stateNode,o=n.memoizedProps;try{for(var d=n.type,g=i.attributes;g.length;)i.removeAttributeNode(g[0]);Ir(i,d,o),i[B]=n,i[P]=o}catch(x){Bt(n,n.return,x)}}var In=!1,_r=!1,pd=!1,xx=typeof WeakSet=="function"?WeakSet:Set,Nr=null;function aE(n,i){if(n=n.containerInfo,Bd=Du,n=Np(n),c0(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var d=o.getSelection&&o.getSelection();if(d&&d.rangeCount!==0){o=d.anchorNode;var g=d.anchorOffset,x=d.focusNode;d=d.focusOffset;try{o.nodeType,x.nodeType}catch{o=null;break e}var T=0,D=-1,Y=-1,oe=0,Ae=0,Re=n,me=null;t:for(;;){for(var we;Re!==o||g!==0&&Re.nodeType!==3||(D=T+g),Re!==x||d!==0&&Re.nodeType!==3||(Y=T+d),Re.nodeType===3&&(T+=Re.nodeValue.length),(we=Re.firstChild)!==null;)me=Re,Re=we;for(;;){if(Re===n)break t;if(me===o&&++oe===g&&(D=T),me===x&&++Ae===d&&(Y=T),(we=Re.nextSibling)!==null)break;Re=me,me=Re.parentNode}Re=we}o=D===-1||Y===-1?null:{start:D,end:Y}}else o=null}o=o||{start:0,end:0}}else o=null;for(Ld={focusedElem:n,selectionRange:o},Du=!1,Nr=i;Nr!==null;)if(i=Nr,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,Nr=n;else for(;Nr!==null;){switch(i=Nr,x=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)g=n[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&x!==null){n=void 0,o=i,g=x.memoizedProps,x=x.memoizedState,d=o.stateNode;try{var Ke=ri(o.type,g);n=d.getSnapshotBeforeUpdate(Ke,x),d.__reactInternalSnapshotBeforeUpdate=n}catch(rt){Bt(o,o.return,rt)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,o=n.nodeType,o===9)Pd(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Pd(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=i.sibling,n!==null){n.return=i.return,Nr=n;break}Nr=i.return}}function vx(n,i,o){var d=o.flags;switch(o.tag){case 0:case 11:case 15:zn(n,o),d&4&&yc(5,o);break;case 1:if(zn(n,o),d&4)if(n=o.stateNode,i===null)try{n.componentDidMount()}catch(T){Bt(o,o.return,T)}else{var g=ri(o.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(g,i,n.__reactInternalSnapshotBeforeUpdate)}catch(T){Bt(o,o.return,T)}}d&64&&dx(o),d&512&&wc(o,o.return);break;case 3:if(zn(n,o),d&64&&(n=o.updateQueue,n!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{rg(n,i)}catch(T){Bt(o,o.return,T)}}break;case 27:i===null&&d&4&&gx(o);case 26:case 5:zn(n,o),i===null&&d&4&&mx(o),d&512&&wc(o,o.return);break;case 12:zn(n,o);break;case 31:zn(n,o),d&4&&wx(n,o);break;case 13:zn(n,o),d&4&&bx(n,o),d&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=dE.bind(null,o),RE(n,o))));break;case 22:if(d=o.memoizedState!==null||In,!d){i=i!==null&&i.memoizedState!==null||_r,g=In;var x=_r;In=d,(_r=i)&&!x?Hn(n,o,(o.subtreeFlags&8772)!==0):zn(n,o),In=g,_r=x}break;case 30:break;default:zn(n,o)}}function _x(n){var i=n.alternate;i!==null&&(n.alternate=null,_x(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&Be(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var er=null,oa=!1;function Pn(n,i,o){for(o=o.child;o!==null;)yx(n,i,o),o=o.sibling}function yx(n,i,o){if(tr&&typeof tr.onCommitFiberUnmount=="function")try{tr.onCommitFiberUnmount(St,o)}catch{}switch(o.tag){case 26:_r||pn(o,i),Pn(n,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:_r||pn(o,i);var d=er,g=oa;ws(o.type)&&(er=o.stateNode,oa=!1),Pn(n,i,o),Cc(o.stateNode),er=d,oa=g;break;case 5:_r||pn(o,i);case 6:if(d=er,g=oa,er=null,Pn(n,i,o),er=d,oa=g,er!==null)if(oa)try{(er.nodeType===9?er.body:er.nodeName==="HTML"?er.ownerDocument.body:er).removeChild(o.stateNode)}catch(x){Bt(o,i,x)}else try{er.removeChild(o.stateNode)}catch(x){Bt(o,i,x)}break;case 18:er!==null&&(oa?(n=er,dv(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),ml(n)):dv(er,o.stateNode));break;case 4:d=er,g=oa,er=o.stateNode.containerInfo,oa=!0,Pn(n,i,o),er=d,oa=g;break;case 0:case 11:case 14:case 15:ms(2,o,i),_r||ms(4,o,i),Pn(n,i,o);break;case 1:_r||(pn(o,i),d=o.stateNode,typeof d.componentWillUnmount=="function"&&hx(o,i,d)),Pn(n,i,o);break;case 21:Pn(n,i,o);break;case 22:_r=(d=_r)||o.memoizedState!==null,Pn(n,i,o),_r=d;break;default:Pn(n,i,o)}}function wx(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{ml(n)}catch(o){Bt(i,i.return,o)}}}function bx(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{ml(n)}catch(o){Bt(i,i.return,o)}}function nE(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new xx),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new xx),i;default:throw Error(a(435,n.tag))}}function hu(n,i){var o=nE(n);i.forEach(function(d){if(!o.has(d)){o.add(d);var g=hE.bind(null,n,d);d.then(g,g)}})}function ua(n,i){var o=i.deletions;if(o!==null)for(var d=0;d<o.length;d++){var g=o[d],x=n,T=i,D=T;e:for(;D!==null;){switch(D.tag){case 27:if(ws(D.type)){er=D.stateNode,oa=!1;break e}break;case 5:er=D.stateNode,oa=!1;break e;case 3:case 4:er=D.stateNode.containerInfo,oa=!0;break e}D=D.return}if(er===null)throw Error(a(160));yx(x,T,g),er=null,oa=!1,x=g.alternate,x!==null&&(x.return=null),g.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Ex(i,n),i=i.sibling}var tn=null;function Ex(n,i){var o=n.alternate,d=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:ua(i,n),fa(n),d&4&&(ms(3,n,n.return),yc(3,n),ms(5,n,n.return));break;case 1:ua(i,n),fa(n),d&512&&(_r||o===null||pn(o,o.return)),d&64&&In&&(n=n.updateQueue,n!==null&&(d=n.callbacks,d!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?d:o.concat(d))));break;case 26:var g=tn;if(ua(i,n),fa(n),d&512&&(_r||o===null||pn(o,o.return)),d&4){var x=o!==null?o.memoizedState:null;if(d=n.memoizedState,o===null)if(d===null)if(n.stateNode===null){e:{d=n.type,o=n.memoizedProps,g=g.ownerDocument||g;t:switch(d){case"title":x=g.getElementsByTagName("title")[0],(!x||x[pe]||x[B]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=g.createElement(d),g.head.insertBefore(x,g.querySelector("head > title"))),Ir(x,d,o),x[B]=n,Ye(x),d=x;break e;case"link":var T=Ev("link","href",g).get(d+(o.href||""));if(T){for(var D=0;D<T.length;D++)if(x=T[D],x.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&x.getAttribute("rel")===(o.rel==null?null:o.rel)&&x.getAttribute("title")===(o.title==null?null:o.title)&&x.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){T.splice(D,1);break t}}x=g.createElement(d),Ir(x,d,o),g.head.appendChild(x);break;case"meta":if(T=Ev("meta","content",g).get(d+(o.content||""))){for(D=0;D<T.length;D++)if(x=T[D],x.getAttribute("content")===(o.content==null?null:""+o.content)&&x.getAttribute("name")===(o.name==null?null:o.name)&&x.getAttribute("property")===(o.property==null?null:o.property)&&x.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&x.getAttribute("charset")===(o.charSet==null?null:o.charSet)){T.splice(D,1);break t}}x=g.createElement(d),Ir(x,d,o),g.head.appendChild(x);break;default:throw Error(a(468,d))}x[B]=n,Ye(x),d=x}n.stateNode=d}else Sv(g,n.type,n.stateNode);else n.stateNode=bv(g,d,n.memoizedProps);else x!==d?(x===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):x.count--,d===null?Sv(g,n.type,n.stateNode):bv(g,d,n.memoizedProps)):d===null&&n.stateNode!==null&&dd(n,n.memoizedProps,o.memoizedProps)}break;case 27:ua(i,n),fa(n),d&512&&(_r||o===null||pn(o,o.return)),o!==null&&d&4&&dd(n,n.memoizedProps,o.memoizedProps);break;case 5:if(ua(i,n),fa(n),d&512&&(_r||o===null||pn(o,o.return)),n.flags&32){g=n.stateNode;try{Li(g,"")}catch(Ke){Bt(n,n.return,Ke)}}d&4&&n.stateNode!=null&&(g=n.memoizedProps,dd(n,g,o!==null?o.memoizedProps:g)),d&1024&&(pd=!0);break;case 6:if(ua(i,n),fa(n),d&4){if(n.stateNode===null)throw Error(a(162));d=n.memoizedProps,o=n.stateNode;try{o.nodeValue=d}catch(Ke){Bt(n,n.return,Ke)}}break;case 3:if(Nu=null,g=tn,tn=Au(i.containerInfo),ua(i,n),tn=g,fa(n),d&4&&o!==null&&o.memoizedState.isDehydrated)try{ml(i.containerInfo)}catch(Ke){Bt(n,n.return,Ke)}pd&&(pd=!1,Sx(n));break;case 4:d=tn,tn=Au(n.stateNode.containerInfo),ua(i,n),fa(n),tn=d;break;case 12:ua(i,n),fa(n);break;case 31:ua(i,n),fa(n),d&4&&(d=n.updateQueue,d!==null&&(n.updateQueue=null,hu(n,d)));break;case 13:ua(i,n),fa(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(pu=At()),d&4&&(d=n.updateQueue,d!==null&&(n.updateQueue=null,hu(n,d)));break;case 22:g=n.memoizedState!==null;var Y=o!==null&&o.memoizedState!==null,oe=In,Ae=_r;if(In=oe||g,_r=Ae||Y,ua(i,n),_r=Ae,In=oe,fa(n),d&8192)e:for(i=n.stateNode,i._visibility=g?i._visibility&-2:i._visibility|1,g&&(o===null||Y||In||_r||ai(n)),o=null,i=n;;){if(i.tag===5||i.tag===26){if(o===null){Y=o=i;try{if(x=Y.stateNode,g)T=x.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{D=Y.stateNode;var Re=Y.memoizedProps.style,me=Re!=null&&Re.hasOwnProperty("display")?Re.display:null;D.style.display=me==null||typeof me=="boolean"?"":(""+me).trim()}}catch(Ke){Bt(Y,Y.return,Ke)}}}else if(i.tag===6){if(o===null){Y=i;try{Y.stateNode.nodeValue=g?"":Y.memoizedProps}catch(Ke){Bt(Y,Y.return,Ke)}}}else if(i.tag===18){if(o===null){Y=i;try{var we=Y.stateNode;g?hv(we,!0):hv(Y.stateNode,!1)}catch(Ke){Bt(Y,Y.return,Ke)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}d&4&&(d=n.updateQueue,d!==null&&(o=d.retryQueue,o!==null&&(d.retryQueue=null,hu(n,o))));break;case 19:ua(i,n),fa(n),d&4&&(d=n.updateQueue,d!==null&&(n.updateQueue=null,hu(n,d)));break;case 30:break;case 21:break;default:ua(i,n),fa(n)}}function fa(n){var i=n.flags;if(i&2){try{for(var o,d=n.return;d!==null;){if(px(d)){o=d;break}d=d.return}if(o==null)throw Error(a(160));switch(o.tag){case 27:var g=o.stateNode,x=hd(n);du(n,x,g);break;case 5:var T=o.stateNode;o.flags&32&&(Li(T,""),o.flags&=-33);var D=hd(n);du(n,D,T);break;case 3:case 4:var Y=o.stateNode.containerInfo,oe=hd(n);md(n,oe,Y);break;default:throw Error(a(161))}}catch(Ae){Bt(n,n.return,Ae)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function Sx(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;Sx(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function zn(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)vx(n,i.alternate,i),i=i.sibling}function ai(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:ms(4,i,i.return),ai(i);break;case 1:pn(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&hx(i,i.return,o),ai(i);break;case 27:Cc(i.stateNode);case 26:case 5:pn(i,i.return),ai(i);break;case 22:i.memoizedState===null&&ai(i);break;case 30:ai(i);break;default:ai(i)}n=n.sibling}}function Hn(n,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var d=i.alternate,g=n,x=i,T=x.flags;switch(x.tag){case 0:case 11:case 15:Hn(g,x,o),yc(4,x);break;case 1:if(Hn(g,x,o),d=x,g=d.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(oe){Bt(d,d.return,oe)}if(d=x,g=d.updateQueue,g!==null){var D=d.stateNode;try{var Y=g.shared.hiddenCallbacks;if(Y!==null)for(g.shared.hiddenCallbacks=null,g=0;g<Y.length;g++)tg(Y[g],D)}catch(oe){Bt(d,d.return,oe)}}o&&T&64&&dx(x),wc(x,x.return);break;case 27:gx(x);case 26:case 5:Hn(g,x,o),o&&d===null&&T&4&&mx(x),wc(x,x.return);break;case 12:Hn(g,x,o);break;case 31:Hn(g,x,o),o&&T&4&&wx(g,x);break;case 13:Hn(g,x,o),o&&T&4&&bx(g,x);break;case 22:x.memoizedState===null&&Hn(g,x,o),wc(x,x.return);break;case 30:break;default:Hn(g,x,o)}i=i.sibling}}function gd(n,i){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&lc(o))}function xd(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&lc(n))}function rn(n,i,o,d){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Tx(n,i,o,d),i=i.sibling}function Tx(n,i,o,d){var g=i.flags;switch(i.tag){case 0:case 11:case 15:rn(n,i,o,d),g&2048&&yc(9,i);break;case 1:rn(n,i,o,d);break;case 3:rn(n,i,o,d),g&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&lc(n)));break;case 12:if(g&2048){rn(n,i,o,d),n=i.stateNode;try{var x=i.memoizedProps,T=x.id,D=x.onPostCommit;typeof D=="function"&&D(T,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(Y){Bt(i,i.return,Y)}}else rn(n,i,o,d);break;case 31:rn(n,i,o,d);break;case 13:rn(n,i,o,d);break;case 23:break;case 22:x=i.stateNode,T=i.alternate,i.memoizedState!==null?x._visibility&2?rn(n,i,o,d):bc(n,i):x._visibility&2?rn(n,i,o,d):(x._visibility|=2,al(n,i,o,d,(i.subtreeFlags&10256)!==0||!1)),g&2048&&gd(T,i);break;case 24:rn(n,i,o,d),g&2048&&xd(i.alternate,i);break;default:rn(n,i,o,d)}}function al(n,i,o,d,g){for(g=g&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var x=n,T=i,D=o,Y=d,oe=T.flags;switch(T.tag){case 0:case 11:case 15:al(x,T,D,Y,g),yc(8,T);break;case 23:break;case 22:var Ae=T.stateNode;T.memoizedState!==null?Ae._visibility&2?al(x,T,D,Y,g):bc(x,T):(Ae._visibility|=2,al(x,T,D,Y,g)),g&&oe&2048&&gd(T.alternate,T);break;case 24:al(x,T,D,Y,g),g&&oe&2048&&xd(T.alternate,T);break;default:al(x,T,D,Y,g)}i=i.sibling}}function bc(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=n,d=i,g=d.flags;switch(d.tag){case 22:bc(o,d),g&2048&&gd(d.alternate,d);break;case 24:bc(o,d),g&2048&&xd(d.alternate,d);break;default:bc(o,d)}i=i.sibling}}var Ec=8192;function nl(n,i,o){if(n.subtreeFlags&Ec)for(n=n.child;n!==null;)kx(n,i,o),n=n.sibling}function kx(n,i,o){switch(n.tag){case 26:nl(n,i,o),n.flags&Ec&&n.memoizedState!==null&&VE(o,tn,n.memoizedState,n.memoizedProps);break;case 5:nl(n,i,o);break;case 3:case 4:var d=tn;tn=Au(n.stateNode.containerInfo),nl(n,i,o),tn=d;break;case 22:n.memoizedState===null&&(d=n.alternate,d!==null&&d.memoizedState!==null?(d=Ec,Ec=16777216,nl(n,i,o),Ec=d):nl(n,i,o));break;default:nl(n,i,o)}}function Ax(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function Sc(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var d=i[o];Nr=d,Nx(d,n)}Ax(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)jx(n),n=n.sibling}function jx(n){switch(n.tag){case 0:case 11:case 15:Sc(n),n.flags&2048&&ms(9,n,n.return);break;case 3:Sc(n);break;case 12:Sc(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,mu(n)):Sc(n);break;default:Sc(n)}}function mu(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var d=i[o];Nr=d,Nx(d,n)}Ax(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:ms(8,i,i.return),mu(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,mu(i));break;default:mu(i)}n=n.sibling}}function Nx(n,i){for(;Nr!==null;){var o=Nr;switch(o.tag){case 0:case 11:case 15:ms(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var d=o.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:lc(o.memoizedState.cache)}if(d=o.child,d!==null)d.return=o,Nr=d;else e:for(o=n;Nr!==null;){d=Nr;var g=d.sibling,x=d.return;if(_x(d),d===o){Nr=null;break e}if(g!==null){g.return=x,Nr=g;break e}Nr=x}}}var sE={getCacheForType:function(n){var i=Lr(gr),o=i.data.get(n);return o===void 0&&(o=n(),i.data.set(n,o)),o},cacheSignal:function(){return Lr(gr).controller.signal}},iE=typeof WeakMap=="function"?WeakMap:Map,Dt=0,Vt=null,_t=null,wt=0,Mt=0,ba=null,ps=!1,sl=!1,vd=!1,qn=0,lr=0,gs=0,ni=0,_d=0,Ea=0,il=0,Tc=null,da=null,yd=!1,pu=0,Cx=0,gu=1/0,xu=null,xs=null,Tr=0,vs=null,ll=null,Vn=0,wd=0,bd=null,Ox=null,kc=0,Ed=null;function Sa(){return(Dt&2)!==0&&wt!==0?wt&-wt:Q.T!==null?Nd():O()}function Rx(){if(Ea===0)if((wt&536870912)===0||Tt){var n=es;es<<=1,(es&3932160)===0&&(es=262144),Ea=n}else Ea=536870912;return n=ya.current,n!==null&&(n.flags|=32),Ea}function ha(n,i,o){(n===Vt&&(Mt===2||Mt===9)||n.cancelPendingCommit!==null)&&(cl(n,0),_s(n,wt,Ea,!1)),An(n,o),((Dt&2)===0||n!==Vt)&&(n===Vt&&((Dt&2)===0&&(ni|=o),lr===4&&_s(n,wt,Ea,!1)),gn(n))}function Dx(n,i,o){if((Dt&6)!==0)throw Error(a(327));var d=!o&&(i&127)===0&&(i&n.expiredLanes)===0||kn(n,i),g=d?oE(n,i):Td(n,i,!0),x=d;do{if(g===0){sl&&!d&&_s(n,i,0,!1);break}else{if(o=n.current.alternate,x&&!lE(o)){g=Td(n,i,!1),x=!1;continue}if(g===2){if(x=i,n.errorRecoveryDisabledLanes&x)var T=0;else T=n.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){i=T;e:{var D=n;g=Tc;var Y=D.current.memoizedState.isDehydrated;if(Y&&(cl(D,T).flags|=256),T=Td(D,T,!1),T!==2){if(vd&&!Y){D.errorRecoveryDisabledLanes|=x,ni|=x,g=4;break e}x=da,da=g,x!==null&&(da===null?da=x:da.push.apply(da,x))}g=T}if(x=!1,g!==2)continue}}if(g===1){cl(n,0),_s(n,i,0,!0);break}e:{switch(d=n,x=g,x){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:_s(d,i,Ea,!ps);break e;case 2:da=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(g=pu+300-At(),10<g)){if(_s(d,i,Ea,!ps),rs(d,0,!0)!==0)break e;Vn=i,d.timeoutHandle=uv(Fx.bind(null,d,o,da,xu,yd,i,Ea,ni,il,ps,x,"Throttled",-0,0),g);break e}Fx(d,o,da,xu,yd,i,Ea,ni,il,ps,x,null,-0,0)}}break}while(!0);gn(n)}function Fx(n,i,o,d,g,x,T,D,Y,oe,Ae,Re,me,we){if(n.timeoutHandle=-1,Re=i.subtreeFlags,Re&8192||(Re&16785408)===16785408){Re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Nn},kx(i,x,Re);var Ke=(x&62914560)===x?pu-At():(x&4194048)===x?Cx-At():0;if(Ke=GE(Re,Ke),Ke!==null){Vn=x,n.cancelPendingCommit=Ke(Hx.bind(null,n,i,x,o,d,g,T,D,Y,Ae,Re,null,me,we)),_s(n,x,T,!oe);return}}Hx(n,i,x,o,d,g,T,D,Y)}function lE(n){for(var i=n;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var d=0;d<o.length;d++){var g=o[d],x=g.getSnapshot;g=g.value;try{if(!va(x(),g))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function _s(n,i,o,d){i&=~_d,i&=~ni,n.suspendedLanes|=i,n.pingedLanes&=~i,d&&(n.warmLanes|=i),d=n.expirationTimes;for(var g=i;0<g;){var x=31-Mr(g),T=1<<x;d[x]=-1,g&=~T}o!==0&&Ao(n,o,i)}function vu(){return(Dt&6)===0?(Ac(0),!1):!0}function Sd(){if(_t!==null){if(Mt===0)var n=_t.return;else n=_t,Dn=Ks=null,P0(n),Qi=null,oc=0,n=_t;for(;n!==null;)fx(n.alternate,n),n=n.return;_t=null}}function cl(n,i){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,AE(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),Vn=0,Sd(),Vt=n,_t=o=On(n.current,null),wt=i,Mt=0,ba=null,ps=!1,sl=kn(n,i),vd=!1,il=Ea=_d=ni=gs=lr=0,da=Tc=null,yd=!1,(i&8)!==0&&(i|=i&32);var d=n.entangledLanes;if(d!==0)for(n=n.entanglements,d&=i;0<d;){var g=31-Mr(d),x=1<<g;i|=n[g],d&=~x}return qn=i,Io(),o}function Mx(n,i){ut=null,Q.H=xc,i===Ji||i===Wo?(i=Jp(),Mt=3):i===j0?(i=Jp(),Mt=4):Mt=i===rd?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,ba=i,_t===null&&(lr=1,lu(n,Ba(i,n.current)))}function Bx(){var n=ya.current;return n===null?!0:(wt&4194048)===wt?Pa===null:(wt&62914560)===wt||(wt&536870912)!==0?n===Pa:!1}function Lx(){var n=Q.H;return Q.H=xc,n===null?xc:n}function Ux(){var n=Q.A;return Q.A=sE,n}function _u(){lr=4,ps||(wt&4194048)!==wt&&ya.current!==null||(sl=!0),(gs&134217727)===0&&(ni&134217727)===0||Vt===null||_s(Vt,wt,Ea,!1)}function Td(n,i,o){var d=Dt;Dt|=2;var g=Lx(),x=Ux();(Vt!==n||wt!==i)&&(xu=null,cl(n,i)),i=!1;var T=lr;e:do try{if(Mt!==0&&_t!==null){var D=_t,Y=ba;switch(Mt){case 8:Sd(),T=6;break e;case 3:case 2:case 9:case 6:ya.current===null&&(i=!0);var oe=Mt;if(Mt=0,ba=null,ol(n,D,Y,oe),o&&sl){T=0;break e}break;default:oe=Mt,Mt=0,ba=null,ol(n,D,Y,oe)}}cE(),T=lr;break}catch(Ae){Mx(n,Ae)}while(!0);return i&&n.shellSuspendCounter++,Dn=Ks=null,Dt=d,Q.H=g,Q.A=x,_t===null&&(Vt=null,wt=0,Io()),T}function cE(){for(;_t!==null;)Ix(_t)}function oE(n,i){var o=Dt;Dt|=2;var d=Lx(),g=Ux();Vt!==n||wt!==i?(xu=null,gu=At()+500,cl(n,i)):sl=kn(n,i);e:do try{if(Mt!==0&&_t!==null){i=_t;var x=ba;t:switch(Mt){case 1:Mt=0,ba=null,ol(n,i,x,1);break;case 2:case 9:if(Kp(x)){Mt=0,ba=null,Px(i);break}i=function(){Mt!==2&&Mt!==9||Vt!==n||(Mt=7),gn(n)},x.then(i,i);break e;case 3:Mt=7;break e;case 4:Mt=5;break e;case 7:Kp(x)?(Mt=0,ba=null,Px(i)):(Mt=0,ba=null,ol(n,i,x,7));break;case 5:var T=null;switch(_t.tag){case 26:T=_t.memoizedState;case 5:case 27:var D=_t;if(T?Tv(T):D.stateNode.complete){Mt=0,ba=null;var Y=D.sibling;if(Y!==null)_t=Y;else{var oe=D.return;oe!==null?(_t=oe,yu(oe)):_t=null}break t}}Mt=0,ba=null,ol(n,i,x,5);break;case 6:Mt=0,ba=null,ol(n,i,x,6);break;case 8:Sd(),lr=6;break e;default:throw Error(a(462))}}uE();break}catch(Ae){Mx(n,Ae)}while(!0);return Dn=Ks=null,Q.H=d,Q.A=g,Dt=o,_t!==null?0:(Vt=null,wt=0,Io(),lr)}function uE(){for(;_t!==null&&!Dr();)Ix(_t)}function Ix(n){var i=ox(n.alternate,n,qn);n.memoizedProps=n.pendingProps,i===null?yu(n):_t=i}function Px(n){var i=n,o=i.alternate;switch(i.tag){case 15:case 0:i=ax(o,i,i.pendingProps,i.type,void 0,wt);break;case 11:i=ax(o,i,i.pendingProps,i.type.render,i.ref,wt);break;case 5:P0(i);default:fx(o,i),i=_t=Up(i,qn),i=ox(o,i,qn)}n.memoizedProps=n.pendingProps,i===null?yu(n):_t=i}function ol(n,i,o,d){Dn=Ks=null,P0(i),Qi=null,oc=0;var g=i.return;try{if(Qb(n,g,i,o,wt)){lr=1,lu(n,Ba(o,n.current)),_t=null;return}}catch(x){if(g!==null)throw _t=g,x;lr=1,lu(n,Ba(o,n.current)),_t=null;return}i.flags&32768?(Tt||d===1?n=!0:sl||(wt&536870912)!==0?n=!1:(ps=n=!0,(d===2||d===9||d===3||d===6)&&(d=ya.current,d!==null&&d.tag===13&&(d.flags|=16384))),zx(i,n)):yu(i)}function yu(n){var i=n;do{if((i.flags&32768)!==0){zx(i,ps);return}n=i.return;var o=tE(i.alternate,i,qn);if(o!==null){_t=o;return}if(i=i.sibling,i!==null){_t=i;return}_t=i=n}while(i!==null);lr===0&&(lr=5)}function zx(n,i){do{var o=rE(n.alternate,n);if(o!==null){o.flags&=32767,_t=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(n=n.sibling,n!==null)){_t=n;return}_t=n=o}while(n!==null);lr=6,_t=null}function Hx(n,i,o,d,g,x,T,D,Y){n.cancelPendingCommit=null;do wu();while(Tr!==0);if((Dt&6)!==0)throw Error(a(327));if(i!==null){if(i===n.current)throw Error(a(177));if(x=i.lanes|i.childLanes,x|=h0,Gf(n,o,x,T,D,Y),n===Vt&&(_t=Vt=null,wt=0),ll=i,vs=n,Vn=o,wd=x,bd=g,Ox=d,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,mE(De,function(){return Wx(),null})):(n.callbackNode=null,n.callbackPriority=0),d=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||d){d=Q.T,Q.T=null,g=le.p,le.p=2,T=Dt,Dt|=4;try{aE(n,i,o)}finally{Dt=T,le.p=g,Q.T=d}}Tr=1,qx(),Vx(),Gx()}}function qx(){if(Tr===1){Tr=0;var n=vs,i=ll,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=Q.T,Q.T=null;var d=le.p;le.p=2;var g=Dt;Dt|=4;try{Ex(i,n);var x=Ld,T=Np(n.containerInfo),D=x.focusedElem,Y=x.selectionRange;if(T!==D&&D&&D.ownerDocument&&jp(D.ownerDocument.documentElement,D)){if(Y!==null&&c0(D)){var oe=Y.start,Ae=Y.end;if(Ae===void 0&&(Ae=oe),"selectionStart"in D)D.selectionStart=oe,D.selectionEnd=Math.min(Ae,D.value.length);else{var Re=D.ownerDocument||document,me=Re&&Re.defaultView||window;if(me.getSelection){var we=me.getSelection(),Ke=D.textContent.length,rt=Math.min(Y.start,Ke),Ht=Y.end===void 0?rt:Math.min(Y.end,Ke);!we.extend&&rt>Ht&&(T=Ht,Ht=rt,rt=T);var ae=Ap(D,rt),ee=Ap(D,Ht);if(ae&&ee&&(we.rangeCount!==1||we.anchorNode!==ae.node||we.anchorOffset!==ae.offset||we.focusNode!==ee.node||we.focusOffset!==ee.offset)){var ce=Re.createRange();ce.setStart(ae.node,ae.offset),we.removeAllRanges(),rt>Ht?(we.addRange(ce),we.extend(ee.node,ee.offset)):(ce.setEnd(ee.node,ee.offset),we.addRange(ce))}}}}for(Re=[],we=D;we=we.parentNode;)we.nodeType===1&&Re.push({element:we,left:we.scrollLeft,top:we.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<Re.length;D++){var Ne=Re[D];Ne.element.scrollLeft=Ne.left,Ne.element.scrollTop=Ne.top}}Du=!!Bd,Ld=Bd=null}finally{Dt=g,le.p=d,Q.T=o}}n.current=i,Tr=2}}function Vx(){if(Tr===2){Tr=0;var n=vs,i=ll,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=Q.T,Q.T=null;var d=le.p;le.p=2;var g=Dt;Dt|=4;try{vx(n,i.alternate,i)}finally{Dt=g,le.p=d,Q.T=o}}Tr=3}}function Gx(){if(Tr===4||Tr===3){Tr=0,Ft();var n=vs,i=ll,o=Vn,d=Ox;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Tr=5:(Tr=0,ll=vs=null,$x(n,n.pendingLanes));var g=n.pendingLanes;if(g===0&&(xs=null),Xl(o),i=i.stateNode,tr&&typeof tr.onCommitFiberRoot=="function")try{tr.onCommitFiberRoot(St,i,void 0,(i.current.flags&128)===128)}catch{}if(d!==null){i=Q.T,g=le.p,le.p=2,Q.T=null;try{for(var x=n.onRecoverableError,T=0;T<d.length;T++){var D=d[T];x(D.value,{componentStack:D.stack})}}finally{Q.T=i,le.p=g}}(Vn&3)!==0&&wu(),gn(n),g=n.pendingLanes,(o&261930)!==0&&(g&42)!==0?n===Ed?kc++:(kc=0,Ed=n):kc=0,Ac(0)}}function $x(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,lc(i)))}function wu(){return qx(),Vx(),Gx(),Wx()}function Wx(){if(Tr!==5)return!1;var n=vs,i=wd;wd=0;var o=Xl(Vn),d=Q.T,g=le.p;try{le.p=32>o?32:o,Q.T=null,o=bd,bd=null;var x=vs,T=Vn;if(Tr=0,ll=vs=null,Vn=0,(Dt&6)!==0)throw Error(a(331));var D=Dt;if(Dt|=4,jx(x.current),Tx(x,x.current,T,o),Dt=D,Ac(0,!1),tr&&typeof tr.onPostCommitFiberRoot=="function")try{tr.onPostCommitFiberRoot(St,x)}catch{}return!0}finally{le.p=g,Q.T=d,$x(n,i)}}function Xx(n,i,o){i=Ba(o,i),i=td(n.stateNode,i,2),n=fs(n,i,2),n!==null&&(An(n,2),gn(n))}function Bt(n,i,o){if(n.tag===3)Xx(n,n,o);else for(;i!==null;){if(i.tag===3){Xx(i,n,o);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(xs===null||!xs.has(d))){n=Ba(o,n),o=Kg(2),d=fs(i,o,2),d!==null&&(Yg(o,d,i,n),An(d,2),gn(d));break}}i=i.return}}function kd(n,i,o){var d=n.pingCache;if(d===null){d=n.pingCache=new iE;var g=new Set;d.set(i,g)}else g=d.get(i),g===void 0&&(g=new Set,d.set(i,g));g.has(o)||(vd=!0,g.add(o),n=fE.bind(null,n,i,o),i.then(n,n))}function fE(n,i,o){var d=n.pingCache;d!==null&&d.delete(i),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Vt===n&&(wt&o)===o&&(lr===4||lr===3&&(wt&62914560)===wt&&300>At()-pu?(Dt&2)===0&&cl(n,0):_d|=o,il===wt&&(il=0)),gn(n)}function Kx(n,i){i===0&&(i=Pe()),n=$s(n,i),n!==null&&(An(n,i),gn(n))}function dE(n){var i=n.memoizedState,o=0;i!==null&&(o=i.retryLane),Kx(n,o)}function hE(n,i){var o=0;switch(n.tag){case 31:case 13:var d=n.stateNode,g=n.memoizedState;g!==null&&(o=g.retryLane);break;case 19:d=n.stateNode;break;case 22:d=n.stateNode._retryCache;break;default:throw Error(a(314))}d!==null&&d.delete(i),Kx(n,o)}function mE(n,i){return ht(n,i)}var bu=null,ul=null,Ad=!1,Eu=!1,jd=!1,ys=0;function gn(n){n!==ul&&n.next===null&&(ul===null?bu=ul=n:ul=ul.next=n),Eu=!0,Ad||(Ad=!0,gE())}function Ac(n,i){if(!jd&&Eu){jd=!0;do for(var o=!1,d=bu;d!==null;){if(n!==0){var g=d.pendingLanes;if(g===0)var x=0;else{var T=d.suspendedLanes,D=d.pingedLanes;x=(1<<31-Mr(42|n)+1)-1,x&=g&~(T&~D),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(o=!0,Zx(d,x))}else x=wt,x=rs(d,d===Vt?x:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(x&3)===0||kn(d,x)||(o=!0,Zx(d,x));d=d.next}while(o);jd=!1}}function pE(){Yx()}function Yx(){Eu=Ad=!1;var n=0;ys!==0&&kE()&&(n=ys);for(var i=At(),o=null,d=bu;d!==null;){var g=d.next,x=Jx(d,i);x===0?(d.next=null,o===null?bu=g:o.next=g,g===null&&(ul=o)):(o=d,(n!==0||(x&3)!==0)&&(Eu=!0)),d=g}Tr!==0&&Tr!==5||Ac(n),ys!==0&&(ys=0)}function Jx(n,i){for(var o=n.suspendedLanes,d=n.pingedLanes,g=n.expirationTimes,x=n.pendingLanes&-62914561;0<x;){var T=31-Mr(x),D=1<<T,Y=g[T];Y===-1?((D&o)===0||(D&d)!==0)&&(g[T]=$l(D,i)):Y<=i&&(n.expiredLanes|=D),x&=~D}if(i=Vt,o=wt,o=rs(n,n===i?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),d=n.callbackNode,o===0||n===i&&(Mt===2||Mt===9)||n.cancelPendingCommit!==null)return d!==null&&d!==null&&Et(d),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||kn(n,o)){if(i=o&-o,i===n.callbackPriority)return i;switch(d!==null&&Et(d),Xl(o)){case 2:case 8:o=ie;break;case 32:o=De;break;case 268435456:o=We;break;default:o=De}return d=Qx.bind(null,n),o=ht(o,d),n.callbackPriority=i,n.callbackNode=o,i}return d!==null&&d!==null&&Et(d),n.callbackPriority=2,n.callbackNode=null,2}function Qx(n,i){if(Tr!==0&&Tr!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(wu()&&n.callbackNode!==o)return null;var d=wt;return d=rs(n,n===Vt?d:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),d===0?null:(Dx(n,d,i),Jx(n,At()),n.callbackNode!=null&&n.callbackNode===o?Qx.bind(null,n):null)}function Zx(n,i){if(wu())return null;Dx(n,i,!0)}function gE(){jE(function(){(Dt&6)!==0?ht(Fr,pE):Yx()})}function Nd(){if(ys===0){var n=Ki;n===0&&(n=Tn,Tn<<=1,(Tn&261888)===0&&(Tn=256)),ys=n}return ys}function ev(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Oo(""+n)}function tv(n,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,n.id&&o.setAttribute("form",n.id),i.parentNode.insertBefore(o,i),n=new FormData(n),o.parentNode.removeChild(o),n}function xE(n,i,o,d,g){if(i==="submit"&&o&&o.stateNode===g){var x=ev((g[P]||null).action),T=d.submitter;T&&(i=(i=T[P]||null)?ev(i.formAction):T.getAttribute("formAction"),i!==null&&(x=i,T=null));var D=new Mo("action","action",null,d,g);n.push({event:D,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(ys!==0){var Y=T?tv(g,T):new FormData(g);K0(o,{pending:!0,data:Y,method:g.method,action:x},null,Y)}}else typeof x=="function"&&(D.preventDefault(),Y=T?tv(g,T):new FormData(g),K0(o,{pending:!0,data:Y,method:g.method,action:x},x,Y))},currentTarget:g}]})}}for(var Cd=0;Cd<d0.length;Cd++){var Od=d0[Cd],vE=Od.toLowerCase(),_E=Od[0].toUpperCase()+Od.slice(1);en(vE,"on"+_E)}en(Rp,"onAnimationEnd"),en(Dp,"onAnimationIteration"),en(Fp,"onAnimationStart"),en("dblclick","onDoubleClick"),en("focusin","onFocus"),en("focusout","onBlur"),en(Mb,"onTransitionRun"),en(Bb,"onTransitionStart"),en(Lb,"onTransitionCancel"),en(Mp,"onTransitionEnd"),Ra("onMouseEnter",["mouseout","mouseover"]),Ra("onMouseLeave",["mouseout","mouseover"]),Ra("onPointerEnter",["pointerout","pointerover"]),Ra("onPointerLeave",["pointerout","pointerover"]),Zt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Zt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Zt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Zt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Zt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Zt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(jc));function rv(n,i){i=(i&4)!==0;for(var o=0;o<n.length;o++){var d=n[o],g=d.event;d=d.listeners;e:{var x=void 0;if(i)for(var T=d.length-1;0<=T;T--){var D=d[T],Y=D.instance,oe=D.currentTarget;if(D=D.listener,Y!==x&&g.isPropagationStopped())break e;x=D,g.currentTarget=oe;try{x(g)}catch(Ae){Uo(Ae)}g.currentTarget=null,x=Y}else for(T=0;T<d.length;T++){if(D=d[T],Y=D.instance,oe=D.currentTarget,D=D.listener,Y!==x&&g.isPropagationStopped())break e;x=D,g.currentTarget=oe;try{x(g)}catch(Ae){Uo(Ae)}g.currentTarget=null,x=Y}}}}function yt(n,i){var o=i[ue];o===void 0&&(o=i[ue]=new Set);var d=n+"__bubble";o.has(d)||(av(i,n,2,!1),o.add(d))}function Rd(n,i,o){var d=0;i&&(d|=4),av(o,n,d,i)}var Su="_reactListening"+Math.random().toString(36).slice(2);function Dd(n){if(!n[Su]){n[Su]=!0,Gt.forEach(function(o){o!=="selectionchange"&&(yE.has(o)||Rd(o,!1,n),Rd(o,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[Su]||(i[Su]=!0,Rd("selectionchange",!1,i))}}function av(n,i,o,d){switch(Rv(i)){case 2:var g=XE;break;case 8:g=KE;break;default:g=Xd}o=g.bind(null,i,o,n),g=void 0,!Zf||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(g=!0),d?g!==void 0?n.addEventListener(i,o,{capture:!0,passive:g}):n.addEventListener(i,o,!0):g!==void 0?n.addEventListener(i,o,{passive:g}):n.addEventListener(i,o,!1)}function Fd(n,i,o,d,g){var x=d;if((i&1)===0&&(i&2)===0&&d!==null)e:for(;;){if(d===null)return;var T=d.tag;if(T===3||T===4){var D=d.stateNode.containerInfo;if(D===g)break;if(T===4)for(T=d.return;T!==null;){var Y=T.tag;if((Y===3||Y===4)&&T.stateNode.containerInfo===g)return;T=T.return}for(;D!==null;){if(T=ze(D),T===null)return;if(Y=T.tag,Y===5||Y===6||Y===26||Y===27){d=x=T;continue e}D=D.parentNode}}d=d.return}cp(function(){var oe=x,Ae=Jf(o),Re=[];e:{var me=Bp.get(n);if(me!==void 0){var we=Mo,Ke=n;switch(n){case"keypress":if(Do(o)===0)break e;case"keydown":case"keyup":we=hb;break;case"focusin":Ke="focus",we=a0;break;case"focusout":Ke="blur",we=a0;break;case"beforeblur":case"afterblur":we=a0;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=fp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=tb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=gb;break;case Rp:case Dp:case Fp:we=nb;break;case Mp:we=vb;break;case"scroll":case"scrollend":we=Z2;break;case"wheel":we=yb;break;case"copy":case"cut":case"paste":we=ib;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=hp;break;case"toggle":case"beforetoggle":we=bb}var rt=(i&4)!==0,Ht=!rt&&(n==="scroll"||n==="scrollend"),ae=rt?me!==null?me+"Capture":null:me;rt=[];for(var ee=oe,ce;ee!==null;){var Ne=ee;if(ce=Ne.stateNode,Ne=Ne.tag,Ne!==5&&Ne!==26&&Ne!==27||ce===null||ae===null||(Ne=Yl(ee,ae),Ne!=null&&rt.push(Nc(ee,Ne,ce))),Ht)break;ee=ee.return}0<rt.length&&(me=new we(me,Ke,null,o,Ae),Re.push({event:me,listeners:rt}))}}if((i&7)===0){e:{if(me=n==="mouseover"||n==="pointerover",we=n==="mouseout"||n==="pointerout",me&&o!==Yf&&(Ke=o.relatedTarget||o.fromElement)&&(ze(Ke)||Ke[W]))break e;if((we||me)&&(me=Ae.window===Ae?Ae:(me=Ae.ownerDocument)?me.defaultView||me.parentWindow:window,we?(Ke=o.relatedTarget||o.toElement,we=oe,Ke=Ke?ze(Ke):null,Ke!==null&&(Ht=l(Ke),rt=Ke.tag,Ke!==Ht||rt!==5&&rt!==27&&rt!==6)&&(Ke=null)):(we=null,Ke=oe),we!==Ke)){if(rt=fp,Ne="onMouseLeave",ae="onMouseEnter",ee="mouse",(n==="pointerout"||n==="pointerover")&&(rt=hp,Ne="onPointerLeave",ae="onPointerEnter",ee="pointer"),Ht=we==null?me:Ue(we),ce=Ke==null?me:Ue(Ke),me=new rt(Ne,ee+"leave",we,o,Ae),me.target=Ht,me.relatedTarget=ce,Ne=null,ze(Ae)===oe&&(rt=new rt(ae,ee+"enter",Ke,o,Ae),rt.target=ce,rt.relatedTarget=Ht,Ne=rt),Ht=Ne,we&&Ke)t:{for(rt=wE,ae=we,ee=Ke,ce=0,Ne=ae;Ne;Ne=rt(Ne))ce++;Ne=0;for(var et=ee;et;et=rt(et))Ne++;for(;0<ce-Ne;)ae=rt(ae),ce--;for(;0<Ne-ce;)ee=rt(ee),Ne--;for(;ce--;){if(ae===ee||ee!==null&&ae===ee.alternate){rt=ae;break t}ae=rt(ae),ee=rt(ee)}rt=null}else rt=null;we!==null&&nv(Re,me,we,rt,!1),Ke!==null&&Ht!==null&&nv(Re,Ht,Ke,rt,!0)}}e:{if(me=oe?Ue(oe):window,we=me.nodeName&&me.nodeName.toLowerCase(),we==="select"||we==="input"&&me.type==="file")var Ct=wp;else if(_p(me))if(bp)Ct=Rb;else{Ct=Cb;var Je=Nb}else we=me.nodeName,!we||we.toLowerCase()!=="input"||me.type!=="checkbox"&&me.type!=="radio"?oe&&Kf(oe.elementType)&&(Ct=wp):Ct=Ob;if(Ct&&(Ct=Ct(n,oe))){yp(Re,Ct,o,Ae);break e}Je&&Je(n,me,oe),n==="focusout"&&oe&&me.type==="number"&&oe.memoizedProps.value!=null&&Xf(me,"number",me.value)}switch(Je=oe?Ue(oe):window,n){case"focusin":(_p(Je)||Je.contentEditable==="true")&&(zi=Je,o0=oe,nc=null);break;case"focusout":nc=o0=zi=null;break;case"mousedown":u0=!0;break;case"contextmenu":case"mouseup":case"dragend":u0=!1,Cp(Re,o,Ae);break;case"selectionchange":if(Fb)break;case"keydown":case"keyup":Cp(Re,o,Ae)}var pt;if(s0)e:{switch(n){case"compositionstart":var bt="onCompositionStart";break e;case"compositionend":bt="onCompositionEnd";break e;case"compositionupdate":bt="onCompositionUpdate";break e}bt=void 0}else Pi?xp(n,o)&&(bt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(bt="onCompositionStart");bt&&(mp&&o.locale!=="ko"&&(Pi||bt!=="onCompositionStart"?bt==="onCompositionEnd"&&Pi&&(pt=op()):(ns=Ae,e0="value"in ns?ns.value:ns.textContent,Pi=!0)),Je=Tu(oe,bt),0<Je.length&&(bt=new dp(bt,n,null,o,Ae),Re.push({event:bt,listeners:Je}),pt?bt.data=pt:(pt=vp(o),pt!==null&&(bt.data=pt)))),(pt=Sb?Tb(n,o):kb(n,o))&&(bt=Tu(oe,"onBeforeInput"),0<bt.length&&(Je=new dp("onBeforeInput","beforeinput",null,o,Ae),Re.push({event:Je,listeners:bt}),Je.data=pt)),xE(Re,n,oe,o,Ae)}rv(Re,i)})}function Nc(n,i,o){return{instance:n,listener:i,currentTarget:o}}function Tu(n,i){for(var o=i+"Capture",d=[];n!==null;){var g=n,x=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||x===null||(g=Yl(n,o),g!=null&&d.unshift(Nc(n,g,x)),g=Yl(n,i),g!=null&&d.push(Nc(n,g,x))),n.tag===3)return d;n=n.return}return[]}function wE(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function nv(n,i,o,d,g){for(var x=i._reactName,T=[];o!==null&&o!==d;){var D=o,Y=D.alternate,oe=D.stateNode;if(D=D.tag,Y!==null&&Y===d)break;D!==5&&D!==26&&D!==27||oe===null||(Y=oe,g?(oe=Yl(o,x),oe!=null&&T.unshift(Nc(o,oe,Y))):g||(oe=Yl(o,x),oe!=null&&T.push(Nc(o,oe,Y)))),o=o.return}T.length!==0&&n.push({event:i,listeners:T})}var bE=/\r\n?/g,EE=/\u0000|\uFFFD/g;function sv(n){return(typeof n=="string"?n:""+n).replace(bE,`
`).replace(EE,"")}function iv(n,i){return i=sv(i),sv(n)===i}function zt(n,i,o,d,g,x){switch(o){case"children":typeof d=="string"?i==="body"||i==="textarea"&&d===""||Li(n,d):(typeof d=="number"||typeof d=="bigint")&&i!=="body"&&Li(n,""+d);break;case"className":No(n,"class",d);break;case"tabIndex":No(n,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":No(n,o,d);break;case"style":ip(n,d,x);break;case"data":if(i!=="object"){No(n,"data",d);break}case"src":case"href":if(d===""&&(i!=="a"||o!=="href")){n.removeAttribute(o);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){n.removeAttribute(o);break}d=Oo(""+d),n.setAttribute(o,d);break;case"action":case"formAction":if(typeof d=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(o==="formAction"?(i!=="input"&&zt(n,i,"name",g.name,g,null),zt(n,i,"formEncType",g.formEncType,g,null),zt(n,i,"formMethod",g.formMethod,g,null),zt(n,i,"formTarget",g.formTarget,g,null)):(zt(n,i,"encType",g.encType,g,null),zt(n,i,"method",g.method,g,null),zt(n,i,"target",g.target,g,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){n.removeAttribute(o);break}d=Oo(""+d),n.setAttribute(o,d);break;case"onClick":d!=null&&(n.onclick=Nn);break;case"onScroll":d!=null&&yt("scroll",n);break;case"onScrollEnd":d!=null&&yt("scrollend",n);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(a(61));if(o=d.__html,o!=null){if(g.children!=null)throw Error(a(60));n.innerHTML=o}}break;case"multiple":n.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":n.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){n.removeAttribute("xlink:href");break}o=Oo(""+d),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?n.setAttribute(o,""+d):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":d===!0?n.setAttribute(o,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?n.setAttribute(o,d):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?n.setAttribute(o,d):n.removeAttribute(o);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?n.removeAttribute(o):n.setAttribute(o,d);break;case"popover":yt("beforetoggle",n),yt("toggle",n),la(n,"popover",d);break;case"xlinkActuate":jn(n,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":jn(n,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":jn(n,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":jn(n,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":jn(n,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":jn(n,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":jn(n,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":jn(n,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":jn(n,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":la(n,"is",d);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=J2.get(o)||o,la(n,o,d))}}function Md(n,i,o,d,g,x){switch(o){case"style":ip(n,d,x);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(a(61));if(o=d.__html,o!=null){if(g.children!=null)throw Error(a(60));n.innerHTML=o}}break;case"children":typeof d=="string"?Li(n,d):(typeof d=="number"||typeof d=="bigint")&&Li(n,""+d);break;case"onScroll":d!=null&&yt("scroll",n);break;case"onScrollEnd":d!=null&&yt("scrollend",n);break;case"onClick":d!=null&&(n.onclick=Nn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$t.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),i=o.slice(2,g?o.length-7:void 0),x=n[P]||null,x=x!=null?x[o]:null,typeof x=="function"&&n.removeEventListener(i,x,g),typeof d=="function")){typeof x!="function"&&x!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(i,d,g);break e}o in n?n[o]=d:d===!0?n.setAttribute(o,""):la(n,o,d)}}}function Ir(n,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yt("error",n),yt("load",n);var d=!1,g=!1,x;for(x in o)if(o.hasOwnProperty(x)){var T=o[x];if(T!=null)switch(x){case"src":d=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:zt(n,i,x,T,o,null)}}g&&zt(n,i,"srcSet",o.srcSet,o,null),d&&zt(n,i,"src",o.src,o,null);return;case"input":yt("invalid",n);var D=x=T=g=null,Y=null,oe=null;for(d in o)if(o.hasOwnProperty(d)){var Ae=o[d];if(Ae!=null)switch(d){case"name":g=Ae;break;case"type":T=Ae;break;case"checked":Y=Ae;break;case"defaultChecked":oe=Ae;break;case"value":x=Ae;break;case"defaultValue":D=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(a(137,i));break;default:zt(n,i,d,Ae,o,null)}}rp(n,x,D,Y,oe,T,g,!1);return;case"select":yt("invalid",n),d=T=x=null;for(g in o)if(o.hasOwnProperty(g)&&(D=o[g],D!=null))switch(g){case"value":x=D;break;case"defaultValue":T=D;break;case"multiple":d=D;default:zt(n,i,g,D,o,null)}i=x,o=T,n.multiple=!!d,i!=null?Bi(n,!!d,i,!1):o!=null&&Bi(n,!!d,o,!0);return;case"textarea":yt("invalid",n),x=g=d=null;for(T in o)if(o.hasOwnProperty(T)&&(D=o[T],D!=null))switch(T){case"value":d=D;break;case"defaultValue":g=D;break;case"children":x=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(a(91));break;default:zt(n,i,T,D,o,null)}np(n,d,g,x);return;case"option":for(Y in o)if(o.hasOwnProperty(Y)&&(d=o[Y],d!=null))switch(Y){case"selected":n.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:zt(n,i,Y,d,o,null)}return;case"dialog":yt("beforetoggle",n),yt("toggle",n),yt("cancel",n),yt("close",n);break;case"iframe":case"object":yt("load",n);break;case"video":case"audio":for(d=0;d<jc.length;d++)yt(jc[d],n);break;case"image":yt("error",n),yt("load",n);break;case"details":yt("toggle",n);break;case"embed":case"source":case"link":yt("error",n),yt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in o)if(o.hasOwnProperty(oe)&&(d=o[oe],d!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:zt(n,i,oe,d,o,null)}return;default:if(Kf(i)){for(Ae in o)o.hasOwnProperty(Ae)&&(d=o[Ae],d!==void 0&&Md(n,i,Ae,d,o,void 0));return}}for(D in o)o.hasOwnProperty(D)&&(d=o[D],d!=null&&zt(n,i,D,d,o,null))}function SE(n,i,o,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,x=null,T=null,D=null,Y=null,oe=null,Ae=null;for(we in o){var Re=o[we];if(o.hasOwnProperty(we)&&Re!=null)switch(we){case"checked":break;case"value":break;case"defaultValue":Y=Re;default:d.hasOwnProperty(we)||zt(n,i,we,null,d,Re)}}for(var me in d){var we=d[me];if(Re=o[me],d.hasOwnProperty(me)&&(we!=null||Re!=null))switch(me){case"type":x=we;break;case"name":g=we;break;case"checked":oe=we;break;case"defaultChecked":Ae=we;break;case"value":T=we;break;case"defaultValue":D=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(a(137,i));break;default:we!==Re&&zt(n,i,me,we,d,Re)}}Wf(n,T,D,Y,oe,Ae,x,g);return;case"select":we=T=D=me=null;for(x in o)if(Y=o[x],o.hasOwnProperty(x)&&Y!=null)switch(x){case"value":break;case"multiple":we=Y;default:d.hasOwnProperty(x)||zt(n,i,x,null,d,Y)}for(g in d)if(x=d[g],Y=o[g],d.hasOwnProperty(g)&&(x!=null||Y!=null))switch(g){case"value":me=x;break;case"defaultValue":D=x;break;case"multiple":T=x;default:x!==Y&&zt(n,i,g,x,d,Y)}i=D,o=T,d=we,me!=null?Bi(n,!!o,me,!1):!!d!=!!o&&(i!=null?Bi(n,!!o,i,!0):Bi(n,!!o,o?[]:"",!1));return;case"textarea":we=me=null;for(D in o)if(g=o[D],o.hasOwnProperty(D)&&g!=null&&!d.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:zt(n,i,D,null,d,g)}for(T in d)if(g=d[T],x=o[T],d.hasOwnProperty(T)&&(g!=null||x!=null))switch(T){case"value":me=g;break;case"defaultValue":we=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(a(91));break;default:g!==x&&zt(n,i,T,g,d,x)}ap(n,me,we);return;case"option":for(var Ke in o)if(me=o[Ke],o.hasOwnProperty(Ke)&&me!=null&&!d.hasOwnProperty(Ke))switch(Ke){case"selected":n.selected=!1;break;default:zt(n,i,Ke,null,d,me)}for(Y in d)if(me=d[Y],we=o[Y],d.hasOwnProperty(Y)&&me!==we&&(me!=null||we!=null))switch(Y){case"selected":n.selected=me&&typeof me!="function"&&typeof me!="symbol";break;default:zt(n,i,Y,me,d,we)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var rt in o)me=o[rt],o.hasOwnProperty(rt)&&me!=null&&!d.hasOwnProperty(rt)&&zt(n,i,rt,null,d,me);for(oe in d)if(me=d[oe],we=o[oe],d.hasOwnProperty(oe)&&me!==we&&(me!=null||we!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(a(137,i));break;default:zt(n,i,oe,me,d,we)}return;default:if(Kf(i)){for(var Ht in o)me=o[Ht],o.hasOwnProperty(Ht)&&me!==void 0&&!d.hasOwnProperty(Ht)&&Md(n,i,Ht,void 0,d,me);for(Ae in d)me=d[Ae],we=o[Ae],!d.hasOwnProperty(Ae)||me===we||me===void 0&&we===void 0||Md(n,i,Ae,me,d,we);return}}for(var ae in o)me=o[ae],o.hasOwnProperty(ae)&&me!=null&&!d.hasOwnProperty(ae)&&zt(n,i,ae,null,d,me);for(Re in d)me=d[Re],we=o[Re],!d.hasOwnProperty(Re)||me===we||me==null&&we==null||zt(n,i,Re,me,d,we)}function lv(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function TE(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,o=performance.getEntriesByType("resource"),d=0;d<o.length;d++){var g=o[d],x=g.transferSize,T=g.initiatorType,D=g.duration;if(x&&D&&lv(T)){for(T=0,D=g.responseEnd,d+=1;d<o.length;d++){var Y=o[d],oe=Y.startTime;if(oe>D)break;var Ae=Y.transferSize,Re=Y.initiatorType;Ae&&lv(Re)&&(Y=Y.responseEnd,T+=Ae*(Y<D?1:(D-oe)/(Y-oe)))}if(--d,i+=8*(x+T)/(g.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Bd=null,Ld=null;function ku(n){return n.nodeType===9?n:n.ownerDocument}function cv(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ov(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function Ud(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Id=null;function kE(){var n=window.event;return n&&n.type==="popstate"?n===Id?!1:(Id=n,!0):(Id=null,!1)}var uv=typeof setTimeout=="function"?setTimeout:void 0,AE=typeof clearTimeout=="function"?clearTimeout:void 0,fv=typeof Promise=="function"?Promise:void 0,jE=typeof queueMicrotask=="function"?queueMicrotask:typeof fv<"u"?function(n){return fv.resolve(null).then(n).catch(NE)}:uv;function NE(n){setTimeout(function(){throw n})}function ws(n){return n==="head"}function dv(n,i){var o=i,d=0;do{var g=o.nextSibling;if(n.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(d===0){n.removeChild(g),ml(i);return}d--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")d++;else if(o==="html")Cc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Cc(o);for(var x=o.firstChild;x;){var T=x.nextSibling,D=x.nodeName;x[pe]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&x.rel.toLowerCase()==="stylesheet"||o.removeChild(x),x=T}}else o==="body"&&Cc(n.ownerDocument.body);o=g}while(o);ml(i)}function hv(n,i){var o=n;n=0;do{var d=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),d&&d.nodeType===8)if(o=d.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=d}while(o)}function Pd(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Pd(o),Be(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function CE(n,i,o,d){for(;n.nodeType===1;){var g=o;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!d&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(d){if(!n[pe])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(x=n.getAttribute("rel"),x==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(x!==g.rel||n.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||n.getAttribute("title")!==(g.title==null?null:g.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(x=n.getAttribute("src"),(x!==(g.src==null?null:g.src)||n.getAttribute("type")!==(g.type==null?null:g.type)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&x&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var x=g.name==null?null:""+g.name;if(g.type==="hidden"&&n.getAttribute("name")===x)return n}else return n;if(n=za(n.nextSibling),n===null)break}return null}function OE(n,i,o){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=za(n.nextSibling),n===null))return null;return n}function mv(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=za(n.nextSibling),n===null))return null;return n}function zd(n){return n.data==="$?"||n.data==="$~"}function Hd(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function RE(n,i){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||o.readyState!=="loading")i();else{var d=function(){i(),o.removeEventListener("DOMContentLoaded",d)};o.addEventListener("DOMContentLoaded",d),n._reactRetry=d}}function za(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var qd=null;function pv(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(i===0)return za(n.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}n=n.nextSibling}return null}function gv(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return n;i--}else o!=="/$"&&o!=="/&"||i++}n=n.previousSibling}return null}function xv(n,i,o){switch(i=ku(o),n){case"html":if(n=i.documentElement,!n)throw Error(a(452));return n;case"head":if(n=i.head,!n)throw Error(a(453));return n;case"body":if(n=i.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function Cc(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);Be(n)}var Ha=new Map,vv=new Set;function Au(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Gn=le.d;le.d={f:DE,r:FE,D:ME,C:BE,L:LE,m:UE,X:PE,S:IE,M:zE};function DE(){var n=Gn.f(),i=vu();return n||i}function FE(n){var i=$e(n);i!==null&&i.tag===5&&i.type==="form"?Mg(i):Gn.r(n)}var fl=typeof document>"u"?null:document;function _v(n,i,o){var d=fl;if(d&&typeof i=="string"&&i){var g=Fa(i);g='link[rel="'+n+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),vv.has(g)||(vv.add(g),n={rel:n,crossOrigin:o,href:i},d.querySelector(g)===null&&(i=d.createElement("link"),Ir(i,"link",n),Ye(i),d.head.appendChild(i)))}}function ME(n){Gn.D(n),_v("dns-prefetch",n,null)}function BE(n,i){Gn.C(n,i),_v("preconnect",n,i)}function LE(n,i,o){Gn.L(n,i,o);var d=fl;if(d&&n&&i){var g='link[rel="preload"][as="'+Fa(i)+'"]';i==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+Fa(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+Fa(o.imageSizes)+'"]')):g+='[href="'+Fa(n)+'"]';var x=g;switch(i){case"style":x=dl(n);break;case"script":x=hl(n)}Ha.has(x)||(n=v({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:n,as:i},o),Ha.set(x,n),d.querySelector(g)!==null||i==="style"&&d.querySelector(Oc(x))||i==="script"&&d.querySelector(Rc(x))||(i=d.createElement("link"),Ir(i,"link",n),Ye(i),d.head.appendChild(i)))}}function UE(n,i){Gn.m(n,i);var o=fl;if(o&&n){var d=i&&typeof i.as=="string"?i.as:"script",g='link[rel="modulepreload"][as="'+Fa(d)+'"][href="'+Fa(n)+'"]',x=g;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=hl(n)}if(!Ha.has(x)&&(n=v({rel:"modulepreload",href:n},i),Ha.set(x,n),o.querySelector(g)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Rc(x)))return}d=o.createElement("link"),Ir(d,"link",n),Ye(d),o.head.appendChild(d)}}}function IE(n,i,o){Gn.S(n,i,o);var d=fl;if(d&&n){var g=Ve(d).hoistableStyles,x=dl(n);i=i||"default";var T=g.get(x);if(!T){var D={loading:0,preload:null};if(T=d.querySelector(Oc(x)))D.loading=5;else{n=v({rel:"stylesheet",href:n,"data-precedence":i},o),(o=Ha.get(x))&&Vd(n,o);var Y=T=d.createElement("link");Ye(Y),Ir(Y,"link",n),Y._p=new Promise(function(oe,Ae){Y.onload=oe,Y.onerror=Ae}),Y.addEventListener("load",function(){D.loading|=1}),Y.addEventListener("error",function(){D.loading|=2}),D.loading|=4,ju(T,i,d)}T={type:"stylesheet",instance:T,count:1,state:D},g.set(x,T)}}}function PE(n,i){Gn.X(n,i);var o=fl;if(o&&n){var d=Ve(o).hoistableScripts,g=hl(n),x=d.get(g);x||(x=o.querySelector(Rc(g)),x||(n=v({src:n,async:!0},i),(i=Ha.get(g))&&Gd(n,i),x=o.createElement("script"),Ye(x),Ir(x,"link",n),o.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},d.set(g,x))}}function zE(n,i){Gn.M(n,i);var o=fl;if(o&&n){var d=Ve(o).hoistableScripts,g=hl(n),x=d.get(g);x||(x=o.querySelector(Rc(g)),x||(n=v({src:n,async:!0,type:"module"},i),(i=Ha.get(g))&&Gd(n,i),x=o.createElement("script"),Ye(x),Ir(x,"link",n),o.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},d.set(g,x))}}function yv(n,i,o,d){var g=(g=Z.current)?Au(g):null;if(!g)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=dl(o.href),o=Ve(g).hoistableStyles,d=o.get(i),d||(d={type:"style",instance:null,count:0,state:null},o.set(i,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=dl(o.href);var x=Ve(g).hoistableStyles,T=x.get(n);if(T||(g=g.ownerDocument||g,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(n,T),(x=g.querySelector(Oc(n)))&&!x._p&&(T.instance=x,T.state.loading=5),Ha.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Ha.set(n,o),x||HE(g,n,o,T.state))),i&&d===null)throw Error(a(528,""));return T}if(i&&d!==null)throw Error(a(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=hl(o),o=Ve(g).hoistableScripts,d=o.get(i),d||(d={type:"script",instance:null,count:0,state:null},o.set(i,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function dl(n){return'href="'+Fa(n)+'"'}function Oc(n){return'link[rel="stylesheet"]['+n+"]"}function wv(n){return v({},n,{"data-precedence":n.precedence,precedence:null})}function HE(n,i,o,d){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?d.loading=1:(i=n.createElement("link"),d.preload=i,i.addEventListener("load",function(){return d.loading|=1}),i.addEventListener("error",function(){return d.loading|=2}),Ir(i,"link",o),Ye(i),n.head.appendChild(i))}function hl(n){return'[src="'+Fa(n)+'"]'}function Rc(n){return"script[async]"+n}function bv(n,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var d=n.querySelector('style[data-href~="'+Fa(o.href)+'"]');if(d)return i.instance=d,Ye(d),d;var g=v({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return d=(n.ownerDocument||n).createElement("style"),Ye(d),Ir(d,"style",g),ju(d,o.precedence,n),i.instance=d;case"stylesheet":g=dl(o.href);var x=n.querySelector(Oc(g));if(x)return i.state.loading|=4,i.instance=x,Ye(x),x;d=wv(o),(g=Ha.get(g))&&Vd(d,g),x=(n.ownerDocument||n).createElement("link"),Ye(x);var T=x;return T._p=new Promise(function(D,Y){T.onload=D,T.onerror=Y}),Ir(x,"link",d),i.state.loading|=4,ju(x,o.precedence,n),i.instance=x;case"script":return x=hl(o.src),(g=n.querySelector(Rc(x)))?(i.instance=g,Ye(g),g):(d=o,(g=Ha.get(x))&&(d=v({},o),Gd(d,g)),n=n.ownerDocument||n,g=n.createElement("script"),Ye(g),Ir(g,"link",d),n.head.appendChild(g),i.instance=g);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(d=i.instance,i.state.loading|=4,ju(d,o.precedence,n));return i.instance}function ju(n,i,o){for(var d=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=d.length?d[d.length-1]:null,x=g,T=0;T<d.length;T++){var D=d[T];if(D.dataset.precedence===i)x=D;else if(x!==g)break}x?x.parentNode.insertBefore(n,x.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(n,i.firstChild))}function Vd(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function Gd(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var Nu=null;function Ev(n,i,o){if(Nu===null){var d=new Map,g=Nu=new Map;g.set(o,d)}else g=Nu,d=g.get(o),d||(d=new Map,g.set(o,d));if(d.has(n))return d;for(d.set(n,null),o=o.getElementsByTagName(n),g=0;g<o.length;g++){var x=o[g];if(!(x[pe]||x[B]||n==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var T=x.getAttribute(i)||"";T=n+T;var D=d.get(T);D?D.push(x):d.set(T,[x])}}return d}function Sv(n,i,o){n=n.ownerDocument||n,n.head.insertBefore(o,i==="title"?n.querySelector("head > title"):null)}function qE(n,i,o){if(o===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return n=i.disabled,typeof i.precedence=="string"&&n==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Tv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function VE(n,i,o,d){if(o.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=dl(d.href),x=i.querySelector(Oc(g));if(x){i=x._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=Cu.bind(n),i.then(n,n)),o.state.loading|=4,o.instance=x,Ye(x);return}x=i.ownerDocument||i,d=wv(d),(g=Ha.get(g))&&Vd(d,g),x=x.createElement("link"),Ye(x);var T=x;T._p=new Promise(function(D,Y){T.onload=D,T.onerror=Y}),Ir(x,"link",d),o.instance=x}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Cu.bind(n),i.addEventListener("load",o),i.addEventListener("error",o))}}var $d=0;function GE(n,i){return n.stylesheets&&n.count===0&&Ru(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var d=setTimeout(function(){if(n.stylesheets&&Ru(n,n.stylesheets),n.unsuspend){var x=n.unsuspend;n.unsuspend=null,x()}},6e4+i);0<n.imgBytes&&$d===0&&($d=62500*TE());var g=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Ru(n,n.stylesheets),n.unsuspend)){var x=n.unsuspend;n.unsuspend=null,x()}},(n.imgBytes>$d?50:800)+i);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(d),clearTimeout(g)}}:null}function Cu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ru(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Ou=null;function Ru(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Ou=new Map,i.forEach($E,n),Ou=null,Cu.call(n))}function $E(n,i){if(!(i.state.loading&4)){var o=Ou.get(n);if(o)var d=o.get(null);else{o=new Map,Ou.set(n,o);for(var g=n.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<g.length;x++){var T=g[x];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(o.set(T.dataset.precedence,T),d=T)}d&&o.set(null,d)}g=i.instance,T=g.getAttribute("data-precedence"),x=o.get(T)||d,x===d&&o.set(null,g),o.set(T,g),this.count++,d=Cu.bind(this),g.addEventListener("load",d),g.addEventListener("error",d),x?x.parentNode.insertBefore(g,x.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(g,n.firstChild)),i.state.loading|=4}}var Dc={$$typeof:S,Provider:null,Consumer:null,_currentValue:Ee,_currentValue2:Ee,_threadCount:0};function WE(n,i,o,d,g,x,T,D,Y){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Za(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Za(0),this.hiddenUpdates=Za(null),this.identifierPrefix=d,this.onUncaughtError=g,this.onCaughtError=x,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Y,this.incompleteTransitions=new Map}function kv(n,i,o,d,g,x,T,D,Y,oe,Ae,Re){return n=new WE(n,i,o,T,Y,oe,Ae,Re,D),i=1,x===!0&&(i|=24),x=_a(3,null,null,i),n.current=x,x.stateNode=n,i=T0(),i.refCount++,n.pooledCache=i,i.refCount++,x.memoizedState={element:d,isDehydrated:o,cache:i},N0(x),n}function Av(n){return n?(n=Vi,n):Vi}function jv(n,i,o,d,g,x){g=Av(g),d.context===null?d.context=g:d.pendingContext=g,d=us(i),d.payload={element:o},x=x===void 0?null:x,x!==null&&(d.callback=x),o=fs(n,d,i),o!==null&&(ha(o,n,i),fc(o,n,i))}function Nv(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<i?o:i}}function Wd(n,i){Nv(n,i),(n=n.alternate)&&Nv(n,i)}function Cv(n){if(n.tag===13||n.tag===31){var i=$s(n,67108864);i!==null&&ha(i,n,67108864),Wd(n,67108864)}}function Ov(n){if(n.tag===13||n.tag===31){var i=Sa();i=Wl(i);var o=$s(n,i);o!==null&&ha(o,n,i),Wd(n,i)}}var Du=!0;function XE(n,i,o,d){var g=Q.T;Q.T=null;var x=le.p;try{le.p=2,Xd(n,i,o,d)}finally{le.p=x,Q.T=g}}function KE(n,i,o,d){var g=Q.T;Q.T=null;var x=le.p;try{le.p=8,Xd(n,i,o,d)}finally{le.p=x,Q.T=g}}function Xd(n,i,o,d){if(Du){var g=Kd(d);if(g===null)Fd(n,i,d,Fu,o),Dv(n,d);else if(JE(g,n,i,o,d))d.stopPropagation();else if(Dv(n,d),i&4&&-1<YE.indexOf(n)){for(;g!==null;){var x=$e(g);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var T=ta(x.pendingLanes);if(T!==0){var D=x;for(D.pendingLanes|=2,D.entangledLanes|=2;T;){var Y=1<<31-Mr(T);D.entanglements[1]|=Y,T&=~Y}gn(x),(Dt&6)===0&&(gu=At()+500,Ac(0))}}break;case 31:case 13:D=$s(x,2),D!==null&&ha(D,x,2),vu(),Wd(x,2)}if(x=Kd(d),x===null&&Fd(n,i,d,Fu,o),x===g)break;g=x}g!==null&&d.stopPropagation()}else Fd(n,i,d,null,o)}}function Kd(n){return n=Jf(n),Yd(n)}var Fu=null;function Yd(n){if(Fu=null,n=ze(n),n!==null){var i=l(n);if(i===null)n=null;else{var o=i.tag;if(o===13){if(n=c(i),n!==null)return n;n=null}else if(o===31){if(n=u(i),n!==null)return n;n=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return Fu=n,null}function Rv(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(jr()){case Fr:return 2;case ie:return 8;case De:case Me:return 32;case We:return 268435456;default:return 32}default:return 32}}var Jd=!1,bs=null,Es=null,Ss=null,Fc=new Map,Mc=new Map,Ts=[],YE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dv(n,i){switch(n){case"focusin":case"focusout":bs=null;break;case"dragenter":case"dragleave":Es=null;break;case"mouseover":case"mouseout":Ss=null;break;case"pointerover":case"pointerout":Fc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mc.delete(i.pointerId)}}function Bc(n,i,o,d,g,x){return n===null||n.nativeEvent!==x?(n={blockedOn:i,domEventName:o,eventSystemFlags:d,nativeEvent:x,targetContainers:[g]},i!==null&&(i=$e(i),i!==null&&Cv(i)),n):(n.eventSystemFlags|=d,i=n.targetContainers,g!==null&&i.indexOf(g)===-1&&i.push(g),n)}function JE(n,i,o,d,g){switch(i){case"focusin":return bs=Bc(bs,n,i,o,d,g),!0;case"dragenter":return Es=Bc(Es,n,i,o,d,g),!0;case"mouseover":return Ss=Bc(Ss,n,i,o,d,g),!0;case"pointerover":var x=g.pointerId;return Fc.set(x,Bc(Fc.get(x)||null,n,i,o,d,g)),!0;case"gotpointercapture":return x=g.pointerId,Mc.set(x,Bc(Mc.get(x)||null,n,i,o,d,g)),!0}return!1}function Fv(n){var i=ze(n.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=c(o),i!==null){n.blockedOn=i,V(n.priority,function(){Ov(o)});return}}else if(i===31){if(i=u(o),i!==null){n.blockedOn=i,V(n.priority,function(){Ov(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Mu(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var o=Kd(n.nativeEvent);if(o===null){o=n.nativeEvent;var d=new o.constructor(o.type,o);Yf=d,o.target.dispatchEvent(d),Yf=null}else return i=$e(o),i!==null&&Cv(i),n.blockedOn=o,!1;i.shift()}return!0}function Mv(n,i,o){Mu(n)&&o.delete(i)}function QE(){Jd=!1,bs!==null&&Mu(bs)&&(bs=null),Es!==null&&Mu(Es)&&(Es=null),Ss!==null&&Mu(Ss)&&(Ss=null),Fc.forEach(Mv),Mc.forEach(Mv)}function Bu(n,i){n.blockedOn===i&&(n.blockedOn=null,Jd||(Jd=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,QE)))}var Lu=null;function Bv(n){Lu!==n&&(Lu=n,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Lu===n&&(Lu=null);for(var i=0;i<n.length;i+=3){var o=n[i],d=n[i+1],g=n[i+2];if(typeof d!="function"){if(Yd(d||o)===null)continue;break}var x=$e(o);x!==null&&(n.splice(i,3),i-=3,K0(x,{pending:!0,data:g,method:o.method,action:d},d,g))}}))}function ml(n){function i(Y){return Bu(Y,n)}bs!==null&&Bu(bs,n),Es!==null&&Bu(Es,n),Ss!==null&&Bu(Ss,n),Fc.forEach(i),Mc.forEach(i);for(var o=0;o<Ts.length;o++){var d=Ts[o];d.blockedOn===n&&(d.blockedOn=null)}for(;0<Ts.length&&(o=Ts[0],o.blockedOn===null);)Fv(o),o.blockedOn===null&&Ts.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(d=0;d<o.length;d+=3){var g=o[d],x=o[d+1],T=g[P]||null;if(typeof x=="function")T||Bv(o);else if(T){var D=null;if(x&&x.hasAttribute("formAction")){if(g=x,T=x[P]||null)D=T.formAction;else if(Yd(g)!==null)continue}else D=T.action;typeof D=="function"?o[d+1]=D:(o.splice(d,3),d-=3),Bv(o)}}}function Lv(){function n(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(T){return g=T})},focusReset:"manual",scroll:"manual"})}function i(){g!==null&&(g(),g=null),d||setTimeout(o,20)}function o(){if(!d&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,g=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){d=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),g!==null&&(g(),g=null)}}}function Qd(n){this._internalRoot=n}Uu.prototype.render=Qd.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(a(409));var o=i.current,d=Sa();jv(o,d,n,i,null,null)},Uu.prototype.unmount=Qd.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;jv(n.current,2,null,n,null,null),vu(),i[W]=null}};function Uu(n){this._internalRoot=n}Uu.prototype.unstable_scheduleHydration=function(n){if(n){var i=O();n={blockedOn:null,target:n,priority:i};for(var o=0;o<Ts.length&&i!==0&&i<Ts[o].priority;o++);Ts.splice(o,0,n),o===0&&Fv(n)}};var Uv=t.version;if(Uv!=="19.2.3")throw Error(a(527,Uv,"19.2.3"));le.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=m(i),n=n!==null?p(n):null,n=n===null?null:n.stateNode,n};var ZE={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Iu.isDisabled&&Iu.supportsFiber)try{St=Iu.inject(ZE),tr=Iu}catch{}}return Uc.createRoot=function(n,i){if(!s(n))throw Error(a(299));var o=!1,d="",g=Gg,x=$g,T=Wg;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(x=i.onCaughtError),i.onRecoverableError!==void 0&&(T=i.onRecoverableError)),i=kv(n,1,!1,null,null,o,d,null,g,x,T,Lv),n[W]=i.current,Dd(n),new Qd(i)},Uc.hydrateRoot=function(n,i,o){if(!s(n))throw Error(a(299));var d=!1,g="",x=Gg,T=$g,D=Wg,Y=null;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(x=o.onUncaughtError),o.onCaughtError!==void 0&&(T=o.onCaughtError),o.onRecoverableError!==void 0&&(D=o.onRecoverableError),o.formState!==void 0&&(Y=o.formState)),i=kv(n,1,!0,i,o??null,d,g,Y,x,T,D,Lv),i.context=Av(null),o=i.current,d=Sa(),d=Wl(d),g=us(d),g.callback=null,fs(o,g,d),o=d,i.current.lanes=o,An(i,o),gn(i),n[W]=i.current,Dd(n),new Uu(i)},Uc.version="19.2.3",Uc}var Xv;function dS(){if(Xv)return th.exports;Xv=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),th.exports=fS(),th.exports}var hS=dS();const mS=rm(hS);var Ah=function(e,t){return Ah=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(r[s]=a[s])},Ah(e,t)};function j_(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ah(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ff=function(){return ff=Object.assign||function(t){for(var r,a=1,s=arguments.length;a<s;a++){r=arguments[a];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},ff.apply(this,arguments)};function Pl(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r}function N_(e,t,r,a){var s=arguments.length,l=s<3?t:a===null?a=Object.getOwnPropertyDescriptor(t,r):a,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(e,t,r,a);else for(var u=e.length-1;u>=0;u--)(c=e[u])&&(l=(s<3?c(l):s>3?c(t,r,l):c(t,r))||l);return s>3&&l&&Object.defineProperty(t,r,l),l}function C_(e,t){return function(r,a){t(r,a,e)}}function O_(e,t,r,a,s,l){function c(k){if(k!==void 0&&typeof k!="function")throw new TypeError("Function expected");return k}for(var u=a.kind,h=u==="getter"?"get":u==="setter"?"set":"value",m=!t&&e?a.static?e:e.prototype:null,p=t||(m?Object.getOwnPropertyDescriptor(m,a.name):{}),v,_=!1,y=r.length-1;y>=0;y--){var b={};for(var w in a)b[w]=w==="access"?{}:a[w];for(var w in a.access)b.access[w]=a.access[w];b.addInitializer=function(k){if(_)throw new TypeError("Cannot add initializers after decoration has completed");l.push(c(k||null))};var E=(0,r[y])(u==="accessor"?{get:p.get,set:p.set}:p[h],b);if(u==="accessor"){if(E===void 0)continue;if(E===null||typeof E!="object")throw new TypeError("Object expected");(v=c(E.get))&&(p.get=v),(v=c(E.set))&&(p.set=v),(v=c(E.init))&&s.unshift(v)}else(v=c(E))&&(u==="field"?s.unshift(v):p[h]=v)}m&&Object.defineProperty(m,a.name,p),_=!0}function R_(e,t,r){for(var a=arguments.length>2,s=0;s<t.length;s++)r=a?t[s].call(e,r):t[s].call(e);return a?r:void 0}function D_(e){return typeof e=="symbol"?e:"".concat(e)}function F_(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function M_(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Xe(e,t,r,a){function s(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function u(p){try{m(a.next(p))}catch(v){c(v)}}function h(p){try{m(a.throw(p))}catch(v){c(v)}}function m(p){p.done?l(p.value):s(p.value).then(u,h)}m((a=a.apply(e,t||[])).next())})}function B_(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,s,l,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=u(0),c.throw=u(1),c.return=u(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(m){return function(p){return h([m,p])}}function h(m){if(a)throw new TypeError("Generator is already executing.");for(;c&&(c=0,m[0]&&(r=0)),r;)try{if(a=1,s&&(l=m[0]&2?s.return:m[0]?s.throw||((l=s.return)&&l.call(s),0):s.next)&&!(l=l.call(s,m[1])).done)return l;switch(s=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,s=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){r.label=m[1];break}if(m[0]===6&&r.label<l[1]){r.label=l[1],l=m;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(m);break}l[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(p){m=[6,p],s=0}finally{a=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Rf=Object.create?(function(e,t,r,a){a===void 0&&(a=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,s)}):(function(e,t,r,a){a===void 0&&(a=r),e[a]=t[r]});function L_(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Rf(t,e,r)}function df(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function nm(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var a=r.call(e),s,l=[],c;try{for(;(t===void 0||t-- >0)&&!(s=a.next()).done;)l.push(s.value)}catch(u){c={error:u}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(c)throw c.error}}return l}function U_(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(nm(arguments[t]));return e}function I_(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var a=Array(e),s=0,t=0;t<r;t++)for(var l=arguments[t],c=0,u=l.length;c<u;c++,s++)a[s]=l[c];return a}function P_(e,t,r){if(r||arguments.length===2)for(var a=0,s=t.length,l;a<s;a++)(l||!(a in t))&&(l||(l=Array.prototype.slice.call(t,0,a)),l[a]=t[a]);return e.concat(l||Array.prototype.slice.call(t))}function Fl(e){return this instanceof Fl?(this.v=e,this):new Fl(e)}function z_(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r.apply(e,t||[]),s,l=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",c),s[Symbol.asyncIterator]=function(){return this},s;function c(y){return function(b){return Promise.resolve(b).then(y,v)}}function u(y,b){a[y]&&(s[y]=function(w){return new Promise(function(E,k){l.push([y,w,E,k])>1||h(y,w)})},b&&(s[y]=b(s[y])))}function h(y,b){try{m(a[y](b))}catch(w){_(l[0][3],w)}}function m(y){y.value instanceof Fl?Promise.resolve(y.value.v).then(p,v):_(l[0][2],y)}function p(y){h("next",y)}function v(y){h("throw",y)}function _(y,b){y(b),l.shift(),l.length&&h(l[0][0],l[0][1])}}function H_(e){var t,r;return t={},a("next"),a("throw",function(s){throw s}),a("return"),t[Symbol.iterator]=function(){return this},t;function a(s,l){t[s]=e[s]?function(c){return(r=!r)?{value:Fl(e[s](c)),done:!1}:l?l(c):c}:l}}function q_(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof df=="function"?df(e):e[Symbol.iterator](),r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r);function a(l){r[l]=e[l]&&function(c){return new Promise(function(u,h){c=e[l](c),s(u,h,c.done,c.value)})}}function s(l,c,u,h){Promise.resolve(h).then(function(m){l({value:m,done:u})},c)}}function V_(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var pS=Object.create?(function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}):function(e,t){e.default=t},jh=function(e){return jh=Object.getOwnPropertyNames||function(t){var r=[];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[r.length]=a);return r},jh(e)};function G_(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=jh(e),a=0;a<r.length;a++)r[a]!=="default"&&Rf(t,e,r[a]);return pS(t,e),t}function $_(e){return e&&e.__esModule?e:{default:e}}function W_(e,t,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(e):a?a.value:t.get(e)}function X_(e,t,r,a,s){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?s.call(e,r):s?s.value=r:t.set(e,r),r}function K_(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function Y_(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var a,s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");a=t[Symbol.asyncDispose]}if(a===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");a=t[Symbol.dispose],r&&(s=a)}if(typeof a!="function")throw new TypeError("Object not disposable.");s&&(a=function(){try{s.call(this)}catch(l){return Promise.reject(l)}}),e.stack.push({value:t,dispose:a,async:r})}else r&&e.stack.push({async:!0});return t}var gS=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var a=new Error(r);return a.name="SuppressedError",a.error=e,a.suppressed=t,a};function J_(e){function t(l){e.error=e.hasError?new gS(l,e.error,"An error was suppressed during disposal."):l,e.hasError=!0}var r,a=0;function s(){for(;r=e.stack.pop();)try{if(!r.async&&a===1)return a=0,e.stack.push(r),Promise.resolve().then(s);if(r.dispose){var l=r.dispose.call(r.value);if(r.async)return a|=2,Promise.resolve(l).then(s,function(c){return t(c),s()})}else a|=1}catch(c){t(c)}if(a===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return s()}function Q_(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,a,s,l,c){return a?t?".jsx":".js":s&&(!l||!c)?r:s+l+"."+c.toLowerCase()+"js"}):e}const xS={__extends:j_,__assign:ff,__rest:Pl,__decorate:N_,__param:C_,__esDecorate:O_,__runInitializers:R_,__propKey:D_,__setFunctionName:F_,__metadata:M_,__awaiter:Xe,__generator:B_,__createBinding:Rf,__exportStar:L_,__values:df,__read:nm,__spread:U_,__spreadArrays:I_,__spreadArray:P_,__await:Fl,__asyncGenerator:z_,__asyncDelegator:H_,__asyncValues:q_,__makeTemplateObject:V_,__importStar:G_,__importDefault:$_,__classPrivateFieldGet:W_,__classPrivateFieldSet:X_,__classPrivateFieldIn:K_,__addDisposableResource:Y_,__disposeResources:J_,__rewriteRelativeImportExtension:Q_},vS=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Y_,get __assign(){return ff},__asyncDelegator:H_,__asyncGenerator:z_,__asyncValues:q_,__await:Fl,__awaiter:Xe,__classPrivateFieldGet:W_,__classPrivateFieldIn:K_,__classPrivateFieldSet:X_,__createBinding:Rf,__decorate:N_,__disposeResources:J_,__esDecorate:O_,__exportStar:L_,__extends:j_,__generator:B_,__importDefault:$_,__importStar:G_,__makeTemplateObject:V_,__metadata:M_,__param:C_,__propKey:D_,__read:nm,__rest:Pl,__rewriteRelativeImportExtension:Q_,__runInitializers:R_,__setFunctionName:F_,__spread:U_,__spreadArray:P_,__spreadArrays:I_,__values:df,default:xS},Symbol.toStringTag,{value:"Module"})),_S=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Df extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class Z_ extends Df{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Nh extends Df{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Ch extends Df{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var hf;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(hf||(hf={}));class yS{constructor(t,{headers:r={},customFetch:a,region:s=hf.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=_S(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Xe(this,arguments,void 0,function*(r,a={}){var s;let l,c;try{const{headers:u,method:h,body:m,signal:p,timeout:v}=a;let _={},{region:y}=a;y||(y=this.region);const b=new URL(`${this.url}/${r}`);y&&y!=="any"&&(_["x-region"]=y,b.searchParams.set("forceFunctionRegion",y));let w;m&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(_["Content-Type"]="application/octet-stream",w=m):typeof m=="string"?(_["Content-Type"]="text/plain",w=m):typeof FormData<"u"&&m instanceof FormData?w=m:(_["Content-Type"]="application/json",w=JSON.stringify(m)):w=m;let E=p;v&&(c=new AbortController,l=setTimeout(()=>c.abort(),v),p?(E=c.signal,p.addEventListener("abort",()=>c.abort())):E=c.signal);const k=yield this.fetch(b.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},_),this.headers),u),body:w,signal:E}).catch(F=>{throw new Z_(F)}),A=k.headers.get("x-relay-error");if(A&&A==="true")throw new Nh(k);if(!k.ok)throw new Ch(k);let S=((s=k.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),j;return S==="application/json"?j=yield k.json():S==="application/octet-stream"||S==="application/pdf"?j=yield k.blob():S==="text/event-stream"?j=k:S==="multipart/form-data"?j=yield k.formData():j=yield k.text(),{data:j,error:null,response:k}}catch(u){return{data:null,error:u,response:u instanceof Ch||u instanceof Nh?u.context:void 0}}finally{l&&clearTimeout(l)}})}}var $r={};const zl=rS(vS);var Pu={},zu={},Hu={},qu={},Vu={},Gu={},Kv;function ey(){if(Kv)return Gu;Kv=1,Object.defineProperty(Gu,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Gu.default=e,Gu}var Yv;function ty(){if(Yv)return Vu;Yv=1,Object.defineProperty(Vu,"__esModule",{value:!0});const t=zl.__importDefault(ey());class r{constructor(s){var l,c;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(l=s.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=s.signal,this.isMaybeSingle=(c=s.isMaybeSingle)!==null&&c!==void 0?c:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,l){return this.headers=new Headers(this.headers),this.headers.set(s,l),this}then(s,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let u=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var m,p,v,_;let y=null,b=null,w=null,E=h.status,k=h.statusText;if(h.ok){if(this.method!=="HEAD"){const F=await h.text();F===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?b=F:b=JSON.parse(F))}const S=(p=this.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),j=(v=h.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");S&&j&&j.length>1&&(w=parseInt(j[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(y={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,w=null,E=406,k="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const S=await h.text();try{y=JSON.parse(S),Array.isArray(y)&&h.status===404&&(b=[],y=null,E=200,k="OK")}catch{h.status===404&&S===""?(E=204,k="No Content"):y={message:S}}if(y&&this.isMaybeSingle&&(!((_=y?.details)===null||_===void 0)&&_.includes("0 rows"))&&(y=null,E=200,k="OK"),y&&this.shouldThrowOnError)throw new t.default(y)}return{error:y,data:b,count:w,status:E,statusText:k}});return this.shouldThrowOnError||(u=u.catch(h=>{var m,p,v,_,y,b;let w="";const E=h?.cause;if(E){const k=(m=E?.message)!==null&&m!==void 0?m:"",A=(p=E?.code)!==null&&p!==void 0?p:"";w=`${(v=h?.name)!==null&&v!==void 0?v:"FetchError"}: ${h?.message}`,w+=`

Caused by: ${(_=E?.name)!==null&&_!==void 0?_:"Error"}: ${k}`,A&&(w+=` (${A})`),E?.stack&&(w+=`
${E.stack}`)}else w=(y=h?.stack)!==null&&y!==void 0?y:"";return{error:{message:`${(b=h?.name)!==null&&b!==void 0?b:"FetchError"}: ${h?.message}`,details:w,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),u.then(s,l)}returns(){return this}overrideTypes(){return this}}return Vu.default=r,Vu}var Jv;function ry(){if(Jv)return qu;Jv=1,Object.defineProperty(qu,"__esModule",{value:!0});const t=zl.__importDefault(ty());class r extends t.default{select(s){let l=!1;const c=(s??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:l=!0,nullsFirst:c,foreignTable:u,referencedTable:h=u}={}){const m=h?`${h}.order`:"order",p=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${p?`${p},`:""}${s}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:l,referencedTable:c=l}={}){const u=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(u,`${s}`),this}range(s,l,{foreignTable:c,referencedTable:u=c}={}){const h=typeof u>"u"?"offset":`${u}.offset`,m=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(h,`${s}`),this.url.searchParams.set(m,`${l-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:l=!1,settings:c=!1,buffers:u=!1,wal:h=!1,format:m="text"}={}){var p;const v=[s?"analyze":null,l?"verbose":null,c?"settings":null,u?"buffers":null,h?"wal":null].filter(Boolean).join("|"),_=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${_}"; options=${v};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return qu.default=r,qu}var Qv;function sm(){if(Qv)return Hu;Qv=1,Object.defineProperty(Hu,"__esModule",{value:!0});const t=zl.__importDefault(ry()),r=new RegExp("[,()]");class a extends t.default{eq(l,c){return this.url.searchParams.append(l,`eq.${c}`),this}neq(l,c){return this.url.searchParams.append(l,`neq.${c}`),this}gt(l,c){return this.url.searchParams.append(l,`gt.${c}`),this}gte(l,c){return this.url.searchParams.append(l,`gte.${c}`),this}lt(l,c){return this.url.searchParams.append(l,`lt.${c}`),this}lte(l,c){return this.url.searchParams.append(l,`lte.${c}`),this}like(l,c){return this.url.searchParams.append(l,`like.${c}`),this}likeAllOf(l,c){return this.url.searchParams.append(l,`like(all).{${c.join(",")}}`),this}likeAnyOf(l,c){return this.url.searchParams.append(l,`like(any).{${c.join(",")}}`),this}ilike(l,c){return this.url.searchParams.append(l,`ilike.${c}`),this}ilikeAllOf(l,c){return this.url.searchParams.append(l,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(l,c){return this.url.searchParams.append(l,`ilike(any).{${c.join(",")}}`),this}regexMatch(l,c){return this.url.searchParams.append(l,`match.${c}`),this}regexIMatch(l,c){return this.url.searchParams.append(l,`imatch.${c}`),this}is(l,c){return this.url.searchParams.append(l,`is.${c}`),this}isDistinct(l,c){return this.url.searchParams.append(l,`isdistinct.${c}`),this}in(l,c){const u=Array.from(new Set(c)).map(h=>typeof h=="string"&&r.test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(l,`in.(${u})`),this}contains(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cs.{${c.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(c)}`),this}containedBy(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cd.{${c.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(c)}`),this}rangeGt(l,c){return this.url.searchParams.append(l,`sr.${c}`),this}rangeGte(l,c){return this.url.searchParams.append(l,`nxl.${c}`),this}rangeLt(l,c){return this.url.searchParams.append(l,`sl.${c}`),this}rangeLte(l,c){return this.url.searchParams.append(l,`nxr.${c}`),this}rangeAdjacent(l,c){return this.url.searchParams.append(l,`adj.${c}`),this}overlaps(l,c){return typeof c=="string"?this.url.searchParams.append(l,`ov.${c}`):this.url.searchParams.append(l,`ov.{${c.join(",")}}`),this}textSearch(l,c,{config:u,type:h}={}){let m="";h==="plain"?m="pl":h==="phrase"?m="ph":h==="websearch"&&(m="w");const p=u===void 0?"":`(${u})`;return this.url.searchParams.append(l,`${m}fts${p}.${c}`),this}match(l){return Object.entries(l).forEach(([c,u])=>{this.url.searchParams.append(c,`eq.${u}`)}),this}not(l,c,u){return this.url.searchParams.append(l,`not.${c}.${u}`),this}or(l,{foreignTable:c,referencedTable:u=c}={}){const h=u?`${u}.or`:"or";return this.url.searchParams.append(h,`(${l})`),this}filter(l,c,u){return this.url.searchParams.append(l,`${c}.${u}`),this}}return Hu.default=a,Hu}var Zv;function ay(){if(Zv)return zu;Zv=1,Object.defineProperty(zu,"__esModule",{value:!0});const t=zl.__importDefault(sm());class r{constructor(s,{headers:l={},schema:c,fetch:u}){this.url=s,this.headers=new Headers(l),this.schema=c,this.fetch=u}select(s,l){const{head:c=!1,count:u}=l??{},h=c?"HEAD":"GET";let m=!1;const p=(s??"*").split("").map(v=>/\s/.test(v)&&!m?"":(v==='"'&&(m=!m),v)).join("");return this.url.searchParams.set("select",p),u&&this.headers.append("Prefer",`count=${u}`),new t.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:l,defaultToNull:c=!0}={}){var u;const h="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const m=s.reduce((p,v)=>p.concat(Object.keys(v)),[]);if(m.length>0){const p=[...new Set(m)].map(v=>`"${v}"`);this.url.searchParams.set("columns",p.join(","))}}return new t.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}upsert(s,{onConflict:l,ignoreDuplicates:c=!1,count:u,defaultToNull:h=!0}={}){var m;const p="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),u&&this.headers.append("Prefer",`count=${u}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const v=s.reduce((_,y)=>_.concat(Object.keys(y)),[]);if(v.length>0){const _=[...new Set(v)].map(y=>`"${y}"`);this.url.searchParams.set("columns",_.join(","))}}return new t.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(s,{count:l}={}){var c;const u="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:s}={}){var l;const c="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return zu.default=r,zu}var e1;function wS(){if(e1)return Pu;e1=1,Object.defineProperty(Pu,"__esModule",{value:!0});const e=zl,t=e.__importDefault(ay()),r=e.__importDefault(sm());class a{constructor(l,{headers:c={},schema:u,fetch:h}={}){this.url=l,this.headers=new Headers(c),this.schemaName=u,this.fetch=h}from(l){if(!l||typeof l!="string"||l.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const c=new URL(`${this.url}/${l}`);return new t.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new a(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:u=!1,get:h=!1,count:m}={}){var p;let v;const _=new URL(`${this.url}/rpc/${l}`);let y;u||h?(v=u?"HEAD":"GET",Object.entries(c).filter(([w,E])=>E!==void 0).map(([w,E])=>[w,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([w,E])=>{_.searchParams.append(w,E)})):(v="POST",y=c);const b=new Headers(this.headers);return m&&b.set("Prefer",`count=${m}`),new r.default({method:v,url:_,headers:b,schema:this.schemaName,body:y,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return Pu.default=a,Pu}var t1;function bS(){if(t1)return $r;t1=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.PostgrestError=$r.PostgrestBuilder=$r.PostgrestTransformBuilder=$r.PostgrestFilterBuilder=$r.PostgrestQueryBuilder=$r.PostgrestClient=void 0;const e=zl,t=e.__importDefault(wS());$r.PostgrestClient=t.default;const r=e.__importDefault(ay());$r.PostgrestQueryBuilder=r.default;const a=e.__importDefault(sm());$r.PostgrestFilterBuilder=a.default;const s=e.__importDefault(ry());$r.PostgrestTransformBuilder=s.default;const l=e.__importDefault(ty());$r.PostgrestBuilder=l.default;const c=e.__importDefault(ey());return $r.PostgrestError=c.default,$r.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:l.default,PostgrestError:c.default},$r}var ny=bS();const sy=rm(ny),ES=tS({__proto__:null,default:sy},[ny]),{PostgrestClient:SS,PostgrestQueryBuilder:f5,PostgrestFilterBuilder:d5,PostgrestTransformBuilder:h5,PostgrestBuilder:m5,PostgrestError:TS}=sy||ES;class iy{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,s=parseInt(a.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const kS="2.87.3",AS=`realtime-js/${kS}`,ly="1.0.0",jS="2.0.0",r1=ly,Oh=1e4,NS=1e3,CS=100;var ui;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ui||(ui={}));var wr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(wr||(wr={}));var ln;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(ln||(ln={}));var Rh;(function(e){e.websocket="websocket"})(Rh||(Rh={}));var fi;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(fi||(fi={}));class OS{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let a=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,a;const s=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(t){var r,a;const s=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},c=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(t,r,a){var s,l;const c=t.topic,u=(s=t.ref)!==null&&s!==void 0?s:"",h=(l=t.join_ref)!==null&&l!==void 0?l:"",m=t.payload.event,p=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},v=Object.keys(p).length===0?"":JSON.stringify(p);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`userEvent length ${m.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`metadata length ${v.length} exceeds maximum of 255`);const _=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+u.length+c.length+m.length+v.length,y=new ArrayBuffer(this.HEADER_LENGTH+_);let b=new DataView(y),w=0;b.setUint8(w++,this.KINDS.userBroadcastPush),b.setUint8(w++,h.length),b.setUint8(w++,u.length),b.setUint8(w++,c.length),b.setUint8(w++,m.length),b.setUint8(w++,v.length),b.setUint8(w++,r),Array.from(h,k=>b.setUint8(w++,k.charCodeAt(0))),Array.from(u,k=>b.setUint8(w++,k.charCodeAt(0))),Array.from(c,k=>b.setUint8(w++,k.charCodeAt(0))),Array.from(m,k=>b.setUint8(w++,k.charCodeAt(0))),Array.from(v,k=>b.setUint8(w++,k.charCodeAt(0)));var E=new Uint8Array(y.byteLength+a.byteLength);return E.set(new Uint8Array(y),0),E.set(new Uint8Array(a),y.byteLength),E.buffer}decode(t,r){if(this._isArrayBuffer(t)){let a=this._binaryDecode(t);return r(a)}if(typeof t=="string"){const a=JSON.parse(t),[s,l,c,u,h]=a;return r({join_ref:s,ref:l,topic:c,event:u,payload:h})}return r({})}_binaryDecode(t){const r=new DataView(t),a=r.getUint8(0),s=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,s)}}_decodeUserBroadcast(t,r,a){const s=r.getUint8(1),l=r.getUint8(2),c=r.getUint8(3),u=r.getUint8(4);let h=this.HEADER_LENGTH+4;const m=a.decode(t.slice(h,h+s));h=h+s;const p=a.decode(t.slice(h,h+l));h=h+l;const v=a.decode(t.slice(h,h+c));h=h+c;const _=t.slice(h,t.byteLength),y=u===this.JSON_ENCODING?JSON.parse(a.decode(_)):_,b={type:this.BROADCAST_EVENT,event:p,payload:y};return c>0&&(b.meta=JSON.parse(v)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([a])=>r.includes(a)))}}class cy{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Wt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Wt||(Wt={}));const a1=(e,t,r={})=>{var a;const s=(a=r.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((l,c)=>(l[c]=RS(c,e,t,s),l),{}):{}},RS=(e,t,r,a)=>{const s=t.find(u=>u.name===e),l=s?.type,c=r[e];return l&&!a.includes(l)?oy(l,c):Dh(c)},oy=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return BS(t,r)}switch(e){case Wt.bool:return DS(t);case Wt.float4:case Wt.float8:case Wt.int2:case Wt.int4:case Wt.int8:case Wt.numeric:case Wt.oid:return FS(t);case Wt.json:case Wt.jsonb:return MS(t);case Wt.timestamp:return LS(t);case Wt.abstime:case Wt.date:case Wt.daterange:case Wt.int4range:case Wt.int8range:case Wt.money:case Wt.reltime:case Wt.text:case Wt.time:case Wt.timestamptz:case Wt.timetz:case Wt.tsrange:case Wt.tstzrange:return Dh(t);default:return Dh(t)}},Dh=e=>e,DS=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},FS=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},MS=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},BS=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,a=e[r];if(e[0]==="{"&&a==="}"){let l;const c=e.slice(1,r);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(u=>oy(t,u))}return e},LS=e=>typeof e=="string"?e.replace(" ","T"):e,uy=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class sh{constructor(t,r,a={},s=Oh){this.channel=t,this.event=r,this.payload=a,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Fh;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Fh||(Fh={}));class Al{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},s=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Al.syncState(this.state,s,l,c),this.pendingDiffs.forEach(h=>{this.state=Al.syncDiff(this.state,h,l,c)}),this.pendingDiffs=[],u()}),this.channel._on(a.diff,{},s=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Al.syncDiff(this.state,s,l,c),u())}),this.onJoin((s,l,c)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:l,newPresences:c})}),this.onLeave((s,l,c)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,s){const l=this.cloneDeep(t),c=this.transformState(r),u={},h={};return this.map(l,(m,p)=>{c[m]||(h[m]=p)}),this.map(c,(m,p)=>{const v=l[m];if(v){const _=p.map(E=>E.presence_ref),y=v.map(E=>E.presence_ref),b=p.filter(E=>y.indexOf(E.presence_ref)<0),w=v.filter(E=>_.indexOf(E.presence_ref)<0);b.length>0&&(u[m]=b),w.length>0&&(h[m]=w)}else u[m]=p}),this.syncDiff(l,{joins:u,leaves:h},a,s)}static syncDiff(t,r,a,s){const{joins:l,leaves:c}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),s||(s=()=>{}),this.map(l,(u,h)=>{var m;const p=(m=t[u])!==null&&m!==void 0?m:[];if(t[u]=this.cloneDeep(h),p.length>0){const v=t[u].map(y=>y.presence_ref),_=p.filter(y=>v.indexOf(y.presence_ref)<0);t[u].unshift(..._)}a(u,p,h)}),this.map(c,(u,h)=>{let m=t[u];if(!m)return;const p=h.map(v=>v.presence_ref);m=m.filter(v=>p.indexOf(v.presence_ref)<0),t[u]=m,s(u,m,h),m.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const s=t[a];return"metas"in s?r[a]=s.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[a]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Mh;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Mh||(Mh={}));var jl;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(jl||(jl={}));var yn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(yn||(yn={}));const US=wr;class hi{constructor(t,r={config:{}},a){var s,l;if(this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=wr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new sh(this,ln.join,this.params,this.timeout),this.rejoinTimer=new cy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=wr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=wr.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=wr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=wr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=wr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ln.reply,{},(c,u)=>{this._trigger(this._replyEventName(u),c)}),this.presence=new Al(this),this.broadcastEndpointURL=uy(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var a,s,l;if(this.socket.isConnected()||this.socket.connect(),this.state==wr.closed){const{config:{broadcast:c,presence:u,private:h}}=this.params,m=(s=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(y=>y.filter))!==null&&s!==void 0?s:[],p=!!this.bindings[jl.PRESENCE]&&this.bindings[jl.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,v={},_={broadcast:c,presence:Object.assign(Object.assign({},u),{enabled:p}),postgres_changes:m,private:h};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(y=>t?.(yn.CHANNEL_ERROR,y)),this._onClose(()=>t?.(yn.CLOSED)),this.updateJoinPayload(Object.assign({config:_},v)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:y})=>{var b;if(this.socket._isManualToken()||this.socket.setAuth(),y===void 0){t?.(yn.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,E=(b=w?.length)!==null&&b!==void 0?b:0,k=[];for(let A=0;A<E;A++){const S=w[A],{filter:{event:j,schema:F,table:R,filter:N}}=S,X=y&&y[A];if(X&&X.event===j&&hi.isFilterValueEqual(X.schema,F)&&hi.isFilterValueEqual(X.table,R)&&hi.isFilterValueEqual(X.filter,N))k.push(Object.assign(Object.assign({},S),{id:X.id}));else{this.unsubscribe(),this.state=wr.errored,t?.(yn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,t&&t(yn.SUBSCRIBED);return}}).receive("error",y=>{this.state=wr.errored,t?.(yn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{t?.(yn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===wr.joined&&t===jl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,a)}async httpSend(t,r,a={}){var s;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const c={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=a.timeout)!==null&&s!==void 0?s:this.timeout);if(u.status===202)return{success:!0};let h=u.statusText;try{const m=await u.json();h=m.error||m.message||h}catch{}return Promise.reject(new Error(h))}async send(t,r={}){var a,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=t,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((s=m.body)===null||s===void 0?void 0:s.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,u,h;const m=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((h=(u=(c=this.params)===null||c===void 0?void 0:c.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("error",()=>l("error")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=wr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ln.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(s=>{a=new sh(this,ln.leave,{},t),a.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=wr.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const s=new AbortController,l=setTimeout(()=>s.abort(),a),c=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(l),c}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new sh(this,t,r,a);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>CS){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var s,l;const c=t.toLocaleLowerCase(),{close:u,error:h,leave:m,join:p}=ln;if(a&&[u,h,m,p].indexOf(c)>=0&&a!==this._joinRef())return;let _=this._onMessage(c,r,a);if(r&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(y=>{var b,w,E;return((b=y.filter)===null||b===void 0?void 0:b.event)==="*"||((E=(w=y.filter)===null||w===void 0?void 0:w.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===c}).map(y=>y.callback(_,a)):(l=this.bindings[c])===null||l===void 0||l.filter(y=>{var b,w,E,k,A,S;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in y){const j=y.id,F=(b=y.filter)===null||b===void 0?void 0:b.event;return j&&((w=r.ids)===null||w===void 0?void 0:w.includes(j))&&(F==="*"||F?.toLocaleLowerCase()===((E=r.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const j=(A=(k=y?.filter)===null||k===void 0?void 0:k.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return j==="*"||j===((S=r?.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===c}).map(y=>{if(typeof _=="object"&&"ids"in _){const b=_.data,{schema:w,table:E,commit_timestamp:k,type:A,errors:S}=b;_=Object.assign(Object.assign({},{schema:w,table:E,commit_timestamp:k,eventType:A,new:{},old:{},errors:S}),this._getPayloadRecords(b))}y.callback(_,a)})}_isClosed(){return this.state===wr.closed}_isJoined(){return this.state===wr.joined}_isJoining(){return this.state===wr.joining}_isLeaving(){return this.state===wr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const s=t.toLocaleLowerCase(),l={type:s,filter:r,callback:a};return this.bindings[s]?this.bindings[s].push(l):this.bindings[s]=[l],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(s=>{var l;return!(((l=s.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===a&&hi.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ln.close,{},t)}_onError(t){this._on(ln.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=wr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=a1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=a1(t.columns,t.old_record)),r}}const ih=()=>{},$u={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},IS=[1e3,2e3,5e3,1e4],PS=1e4,zS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class fy{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Oh,this.transport=null,this.heartbeatIntervalMs=$u.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ih,this.ref=0,this.reconnectTimer=null,this.vsn=r1,this.logger=ih,this.conn=null,this.sendBuffer=[],this.serializer=new OS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...l)=>s(...l):(...l)=>fetch(...l),!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Rh.websocket}`,this.httpEndpoint=uy(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=iy.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case ui.connecting:return fi.Connecting;case ui.open:return fi.Open;case ui.closing:return fi.Closing;default:return fi.Closed}}isConnected(){return this.connectionState()===fi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,s=this.getChannels().find(l=>l.topic===a);if(s)return s;{const l=new hi(`realtime:${t}`,r,this);return this.channels.push(l),l}}push(t){const{topic:r,event:a,payload:s,ref:l}=t,c=()=>{this.encode(t,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${r} ${a} (${l})`,s),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(NS,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},$u.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:s,payload:l,ref:c}=r,u=c?`(${c})`:"",h=l.status||"";this.log("receive",`${h} ${a} ${s} ${u}`.trim(),l),this.channels.filter(m=>m._isMember(a)).forEach(m=>m._trigger(s,l,c)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===ui.open||this.conn.readyState===ui.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(ln.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${a}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([zS],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,a=!1;if(t)r=t,a=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),r=this.accessTokenValue}else r=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const l={access_token:r,version:AS};r&&s.updateJoinPayload(l),s.joinedOnce&&s._isJoined()&&s._push(ln.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new cy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},$u.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,s,l,c,u,h,m,p,v,_,y;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t?.timeout)!==null&&a!==void 0?a:Oh,this.heartbeatIntervalMs=(s=t?.heartbeatIntervalMs)!==null&&s!==void 0?s:$u.HEARTBEAT_INTERVAL,this.worker=(l=t?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=t?.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:ih,this.vsn=(h=t?.vsn)!==null&&h!==void 0?h:r1,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=t?.reconnectAfterMs)!==null&&m!==void 0?m:(b=>IS[b-1]||PS),this.vsn){case ly:this.encode=(p=t?.encode)!==null&&p!==void 0?p:((b,w)=>w(JSON.stringify(b))),this.decode=(v=t?.decode)!==null&&v!==void 0?v:((b,w)=>w(JSON.parse(b)));break;case jS:this.encode=(_=t?.encode)!==null&&_!==void 0?_:this.serializer.encode.bind(this.serializer),this.decode=(y=t?.decode)!==null&&y!==void 0?y:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class Ff extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ar(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class HS extends Ff{constructor(t,r,a){super(t),this.name="StorageApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Bh extends Ff{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const im=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),qS=()=>Response,Lh=e=>{if(Array.isArray(e))return e.map(r=>Lh(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const s=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[s]=Lh(a)}),t},VS=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},GS=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e),lh=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},$S=(e,t,r)=>Xe(void 0,void 0,void 0,function*(){const a=yield qS();e instanceof a&&!r?.noResolveJson?e.json().then(s=>{const l=e.status||500,c=s?.statusCode||l+"";t(new HS(lh(s),l,c))}).catch(s=>{t(new Bh(lh(s),s))}):t(new Bh(lh(e),e))}),WS=(e,t,r,a)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"||!a?s:(VS(a)?(s.headers=Object.assign({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(a)):s.body=a,t?.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function vo(e,t,r,a,s,l){return Xe(this,void 0,void 0,function*(){return new Promise((c,u)=>{e(r,WS(t,a,s,l)).then(h=>{if(!h.ok)throw h;return a?.noResolveJson?h:h.json()}).then(h=>c(h)).catch(h=>$S(h,u,a))})})}function to(e,t,r,a){return Xe(this,void 0,void 0,function*(){return vo(e,"GET",t,r,a)})}function sn(e,t,r,a,s){return Xe(this,void 0,void 0,function*(){return vo(e,"POST",t,a,s,r)})}function Uh(e,t,r,a,s){return Xe(this,void 0,void 0,function*(){return vo(e,"PUT",t,a,s,r)})}function XS(e,t,r,a){return Xe(this,void 0,void 0,function*(){return vo(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}function lm(e,t,r,a,s){return Xe(this,void 0,void 0,function*(){return vo(e,"DELETE",t,a,s,r)})}class KS{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Xe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ar(t))return{data:null,error:t};throw t}})}}var dy;class YS{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[dy]="BlobDownloadBuilder",this.promise=null}asStream(){return new KS(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Xe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ar(t))return{data:null,error:t};throw t}})}}dy=Symbol.toStringTag;const JS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},n1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class QS{constructor(t,r={},a,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=a,this.fetch=im(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,a,s){return Xe(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},n1),s);let u=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(c.upsert)});const h=c.metadata;typeof Blob<"u"&&a instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",this.encodeMetadata(h)),l.append("",a)):typeof FormData<"u"&&a instanceof FormData?(l=a,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),h&&!l.has("metadata")&&l.append("metadata",this.encodeMetadata(h))):(l=a,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType,h&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),s?.headers&&(u=Object.assign(Object.assign({},u),s.headers));const m=this._removeEmptyFolders(r),p=this._getFinalPath(m),v=yield(t=="PUT"?Uh:sn)(this.fetch,`${this.url}/object/${p}`,l,Object.assign({headers:u},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:m,id:v.Id,fullPath:v.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ar(l))return{data:null,error:l};throw l}})}upload(t,r,a){return Xe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,a)})}uploadToSignedUrl(t,r,a,s){return Xe(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=new URL(this.url+`/object/upload/sign/${c}`);u.searchParams.set("token",r);try{let h;const m=Object.assign({upsert:n1.upsert},s),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&a instanceof Blob?(h=new FormData,h.append("cacheControl",m.cacheControl),h.append("",a)):typeof FormData<"u"&&a instanceof FormData?(h=a,h.append("cacheControl",m.cacheControl)):(h=a,p["cache-control"]=`max-age=${m.cacheControl}`,p["content-type"]=m.contentType);const v=yield Uh(this.fetch,u.toString(),h,{headers:p});return{data:{path:l,fullPath:v.Key},error:null}}catch(h){if(this.shouldThrowOnError)throw h;if(ar(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(t,r){return Xe(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t);const s=Object.assign({},this.headers);r?.upsert&&(s["x-upsert"]="true");const l=yield sn(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:s}),c=new URL(this.url+l.url),u=c.searchParams.get("token");if(!u)throw new Ff("No token returned by API");return{data:{signedUrl:c.toString(),path:t,token:u},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ar(a))return{data:null,error:a};throw a}})}update(t,r,a){return Xe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,a)})}move(t,r,a){return Xe(this,void 0,void 0,function*(){try{return{data:yield sn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ar(s))return{data:null,error:s};throw s}})}copy(t,r,a){return Xe(this,void 0,void 0,function*(){try{return{data:{path:(yield sn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ar(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,a){return Xe(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),l=yield sn(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},a?.transform?{transform:a.transform}:{}),{headers:this.headers});const c=a?.download?`&download=${a.download===!0?"":a.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ar(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,a){return Xe(this,void 0,void 0,function*(){try{const s=yield sn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),l=a?.download?`&download=${a.download===!0?"":a.download}`:"";return{data:s.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ar(s))return{data:null,error:s};throw s}})}download(t,r){const s=typeof r?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(r?.transform||{}),c=l?`?${l}`:"",u=this._getFinalPath(t),h=()=>to(this.fetch,`${this.url}/${s}/${u}${c}`,{headers:this.headers,noResolveJson:!0});return new YS(h,this.shouldThrowOnError)}info(t){return Xe(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const a=yield to(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Lh(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ar(a))return{data:null,error:a};throw a}})}exists(t){return Xe(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield XS(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ar(a)&&a instanceof Bh){const s=a.originalError;if([400,404].includes(s?.status))return{data:!1,error:a}}throw a}})}getPublicUrl(t,r){const a=this._getFinalPath(t),s=[],l=r?.download?`download=${r.download===!0?"":r.download}`:"";l!==""&&s.push(l);const u=typeof r?.transform<"u"?"render/image":"object",h=this.transformOptsToQueryString(r?.transform||{});h!==""&&s.push(h);let m=s.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${a}${m}`)}}}remove(t){return Xe(this,void 0,void 0,function*(){try{return{data:yield lm(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ar(r))return{data:null,error:r};throw r}})}list(t,r,a){return Xe(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},JS),r),{prefix:t||""});return{data:yield sn(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},a),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ar(s))return{data:null,error:s};throw s}})}listV2(t,r){return Xe(this,void 0,void 0,function*(){try{const a=Object.assign({},t);return{data:yield sn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ar(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const hy="2.87.3",my={"X-Client-Info":`storage-js/${hy}`};class ZS{constructor(t,r={},a,s){this.shouldThrowOnError=!1;const l=new URL(t);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},my),r),this.fetch=im(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return Xe(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield to(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ar(r))return{data:null,error:r};throw r}})}getBucket(t){return Xe(this,void 0,void 0,function*(){try{return{data:yield to(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ar(r))return{data:null,error:r};throw r}})}createBucket(t){return Xe(this,arguments,void 0,function*(r,a={public:!1}){try{return{data:yield sn(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ar(s))return{data:null,error:s};throw s}})}updateBucket(t,r){return Xe(this,void 0,void 0,function*(){try{return{data:yield Uh(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ar(a))return{data:null,error:a};throw a}})}emptyBucket(t){return Xe(this,void 0,void 0,function*(){try{return{data:yield sn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ar(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Xe(this,void 0,void 0,function*(){try{return{data:yield lm(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ar(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}var ro=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function eT(e,t,r){const a=new URL(t,e);if(r)for(const[s,l]of Object.entries(r))l!==void 0&&a.searchParams.set(s,l);return a.toString()}async function tT(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function rT(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:s,body:l,headers:c}){const u=eT(e.baseUrl,a,s),h=await tT(e.auth),m=await t(u,{method:r,headers:{...l?{"Content-Type":"application/json"}:{},...h,...c},body:l?JSON.stringify(l):void 0}),p=await m.text(),v=(m.headers.get("content-type")||"").includes("application/json"),_=v&&p?JSON.parse(p):p;if(!m.ok){const y=v?_:void 0,b=y?.error;throw new ro(b?.message??`Request failed with status ${m.status}`,{status:m.status,icebergType:b?.type,icebergCode:b?.code,details:y})}return{status:m.status,headers:m.headers,data:_}}}}function Wu(e){return e.join("")}var aT=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Wu(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Wu(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Wu(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Wu(e.namespace)}`}),!0}catch(t){if(t instanceof ro&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof ro&&r.status===409)return;throw r}}};function pl(e){return e.join("")}var nT=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${pl(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${pl(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${pl(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${pl(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${pl(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${pl(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof ro&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof ro&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},sT=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=rT({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new aT(this.client,t),this.tableOps=new nT(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}};class iT{constructor(t,r={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},my),r),this.fetch=im(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Xe(this,void 0,void 0,function*(){try{return{data:yield sn(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ar(r))return{data:null,error:r};throw r}})}listBuckets(t){return Xe(this,void 0,void 0,function*(){try{const r=new URLSearchParams;t?.limit!==void 0&&r.set("limit",t.limit.toString()),t?.offset!==void 0&&r.set("offset",t.offset.toString()),t?.sortColumn&&r.set("sortColumn",t.sortColumn),t?.sortOrder&&r.set("sortOrder",t.sortOrder),t?.search&&r.set("search",t.search);const a=r.toString(),s=a?`${this.url}/bucket?${a}`:`${this.url}/bucket`;return{data:yield to(this.fetch,s,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ar(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Xe(this,void 0,void 0,function*(){try{return{data:yield lm(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ar(r))return{data:null,error:r};throw r}})}from(t){if(!GS(t))throw new Ff("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new sT({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:()=>Xe(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(l,c){const u=l[c];return typeof u!="function"?u:(...h)=>Xe(this,void 0,void 0,function*(){try{return{data:yield u.apply(l,h),error:null}}catch(m){if(a)throw m;return{data:null,error:m}}})}})}}const cm={"X-Client-Info":`storage-js/${hy}`,"Content-Type":"application/json"};class py extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Aa(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class ch extends py{constructor(t,r,a){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class lT extends py{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var s1;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(s1||(s1={}));const om=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),cT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},i1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),oT=(e,t,r)=>Xe(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const s=e.status||500,l=e;if(typeof l.json=="function")l.json().then(c=>{const u=c?.statusCode||c?.code||s+"";t(new ch(i1(c),s,u))}).catch(()=>{const c=s+"",u=l.statusText||`HTTP ${s} error`;t(new ch(u,s,c))});else{const c=s+"",u=l.statusText||`HTTP ${s} error`;t(new ch(u,s,c))}}else t(new lT(i1(e),e))}),uT=(e,t,r,a)=>{const s={method:e,headers:t?.headers||{}};return a?(cT(a)?(s.headers=Object.assign({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(a)):s.body=a,Object.assign(Object.assign({},s),r)):s};function fT(e,t,r,a,s,l){return Xe(this,void 0,void 0,function*(){return new Promise((c,u)=>{e(r,uT(t,a,s,l)).then(h=>{if(!h.ok)throw h;if(a?.noResolveJson)return h;const m=h.headers.get("content-type");return!m||!m.includes("application/json")?{}:h.json()}).then(h=>c(h)).catch(h=>oT(h,u,a))})})}function ja(e,t,r,a,s){return Xe(this,void 0,void 0,function*(){return fT(e,"POST",t,a,s,r)})}class dT{constructor(t,r={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},cm),r),this.fetch=om(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return Xe(this,void 0,void 0,function*(){try{return{data:(yield ja(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Aa(r))return{data:null,error:r};throw r}})}getIndex(t,r){return Xe(this,void 0,void 0,function*(){try{return{data:yield ja(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Aa(a))return{data:null,error:a};throw a}})}listIndexes(t){return Xe(this,void 0,void 0,function*(){try{return{data:yield ja(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Aa(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return Xe(this,void 0,void 0,function*(){try{return{data:(yield ja(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Aa(a))return{data:null,error:a};throw a}})}}class hT{constructor(t,r={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},cm),r),this.fetch=om(a)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return Xe(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield ja(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Aa(r))return{data:null,error:r};throw r}})}getVectors(t){return Xe(this,void 0,void 0,function*(){try{return{data:yield ja(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Aa(r))return{data:null,error:r};throw r}})}listVectors(t){return Xe(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield ja(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Aa(r))return{data:null,error:r};throw r}})}queryVectors(t){return Xe(this,void 0,void 0,function*(){try{return{data:yield ja(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Aa(r))return{data:null,error:r};throw r}})}deleteVectors(t){return Xe(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield ja(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Aa(r))return{data:null,error:r};throw r}})}}class mT{constructor(t,r={},a){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},cm),r),this.fetch=om(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Xe(this,void 0,void 0,function*(){try{return{data:(yield ja(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Aa(r))return{data:null,error:r};throw r}})}getBucket(t){return Xe(this,void 0,void 0,function*(){try{return{data:yield ja(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Aa(r))return{data:null,error:r};throw r}})}listBuckets(){return Xe(this,arguments,void 0,function*(t={}){try{return{data:yield ja(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Aa(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Xe(this,void 0,void 0,function*(){try{return{data:(yield ja(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Aa(r))return{data:null,error:r};throw r}})}}class pT extends mT{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new gT(this.url,this.headers,t,this.fetch)}createBucket(t){const r=Object.create(null,{createBucket:{get:()=>super.createBucket}});return Xe(this,void 0,void 0,function*(){return r.createBucket.call(this,t)})}getBucket(t){const r=Object.create(null,{getBucket:{get:()=>super.getBucket}});return Xe(this,void 0,void 0,function*(){return r.getBucket.call(this,t)})}listBuckets(){const t=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return Xe(this,arguments,void 0,function*(r={}){return t.listBuckets.call(this,r)})}deleteBucket(t){const r=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return Xe(this,void 0,void 0,function*(){return r.deleteBucket.call(this,t)})}}class gT extends dT{constructor(t,r,a,s){super(t,r,s),this.vectorBucketName=a}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Xe(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Xe(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Xe(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Xe(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new xT(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class xT extends hT{constructor(t,r,a,s,l){super(t,r,l),this.vectorBucketName=a,this.indexName=s}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Xe(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Xe(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Xe(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Xe(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Xe(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class vT extends ZS{constructor(t,r={},a,s){super(t,r,a,s)}from(t){return new QS(this.url,this.headers,t,this.fetch)}get vectors(){return new pT(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new iT(this.url+"/iceberg",this.headers,this.fetch)}}const _T="2.87.3";let zc="";typeof Deno<"u"?zc="deno":typeof document<"u"?zc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?zc="react-native":zc="node";const yT={"X-Client-Info":`supabase-js-${zc}/${_T}`},wT={headers:yT},bT={schema:"public"},ET={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ST={},TT=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),kT=()=>Headers,AT=(e,t,r)=>{const a=TT(r),s=kT();return async(l,c)=>{var u;const h=(u=await t())!==null&&u!==void 0?u:e;let m=new s(c?.headers);return m.has("apikey")||m.set("apikey",e),m.has("Authorization")||m.set("Authorization",`Bearer ${h}`),a(l,Object.assign(Object.assign({},c),{headers:m}))}};function jT(e){return e.endsWith("/")?e:e+"/"}function NT(e,t){var r,a;const{db:s,auth:l,realtime:c,global:u}=e,{db:h,auth:m,realtime:p,global:v}=t,_={db:Object.assign(Object.assign({},h),s),auth:Object.assign(Object.assign({},m),l),realtime:Object.assign(Object.assign({},p),c),storage:{},global:Object.assign(Object.assign(Object.assign({},v),u),{headers:Object.assign(Object.assign({},(r=v?.headers)!==null&&r!==void 0?r:{}),(a=u?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return e.accessToken?_.accessToken=e.accessToken:delete _.accessToken,_}function CT(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(jT(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const gy="2.87.3",El=30*1e3,Ih=3,oh=Ih*El,OT="http://localhost:9999",RT="supabase.auth.token",DT={"X-Client-Info":`gotrue-js/${gy}`},Ph="X-Supabase-Api-Version",xy={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},FT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,MT=600*1e3;class Ml extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function Qe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class vy extends Ml{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function _y(e){return Qe(e)&&e.name==="AuthApiError"}class Ns extends Ml{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class bn extends Ml{constructor(t,r,a,s){super(t,a,s),this.name=r,this.status=a}}class ma extends bn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function yy(e){return Qe(e)&&e.name==="AuthSessionMissingError"}class li extends bn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Hc extends bn{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class qc extends bn{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function wy(e){return Qe(e)&&e.name==="AuthImplicitGrantRedirectError"}class zh extends bn{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class by extends bn{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}function BT(e){return Qe(e)&&e.name==="AuthPKCECodeVerifierMissingError"}class mf extends bn{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function of(e){return Qe(e)&&e.name==="AuthRetryableFetchError"}class Hh extends bn{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}function LT(e){return Qe(e)&&e.name==="AuthWeakPasswordError"}class pf extends bn{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const gf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),l1=` 	
\r=`.split(""),UT=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<l1.length;t+=1)e[l1[t].charCodeAt(0)]=-2;for(let t=0;t<gf.length;t+=1)e[gf[t].charCodeAt(0)]=t;return e})();function c1(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(gf[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(gf[a]),t.queuedBits-=6}}function Ey(e,t,r){const a=UT[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function o1(e){const t=[],r=c=>{t.push(String.fromCodePoint(c))},a={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},l=c=>{zT(c,a,r)};for(let c=0;c<e.length;c+=1)Ey(e.charCodeAt(c),s,l);return t.join("")}function IT(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function PT(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const s=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}IT(a,t)}}function zT(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let a=1;a<6;a+=1)if((e>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Nl(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)Ey(e.charCodeAt(s),r,a);return new Uint8Array(t)}function HT(e){const t=[];return PT(e,r=>t.push(r)),new Uint8Array(t)}function mi(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};return e.forEach(s=>c1(s,r,a)),c1(null,r,a),t.join("")}function qT(e){return Math.round(Date.now()/1e3)+e}function VT(){return Symbol("auth-callback")}const zr=()=>typeof window<"u"&&typeof document<"u",si={tested:!1,writable:!1},Sy=()=>{if(!zr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(si.tested)return si.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),si.tested=!0,si.writable=!0}catch{si.tested=!0,si.writable=!1}return si.writable};function GT(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,l)=>{t[l]=s})}catch{}return r.searchParams.forEach((a,s)=>{t[s]=a}),t}const Ty=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),$T=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Sl=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ii=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Pr=async(e,t)=>{await e.removeItem(t)};class Mf{constructor(){this.promise=new Mf.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Mf.promiseConstructor=Promise;function uh(e){const t=e.split(".");if(t.length!==3)throw new pf("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!FT.test(t[a]))throw new pf("JWT not in base64url format");return{header:JSON.parse(o1(t[0])),payload:JSON.parse(o1(t[1])),signature:Nl(t[2]),raw:{header:t[0],payload:t[1]}}}async function WT(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function XT(e,t){return new Promise((a,s)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await e(l);if(!t(l,null,c)){a(c);return}}catch(c){if(!t(l,c)){s(c);return}}})()})}function KT(e){return("0"+e.toString(16)).substr(-2)}function YT(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let s="";for(let l=0;l<56;l++)s+=r.charAt(Math.floor(Math.random()*a));return s}return crypto.getRandomValues(t),Array.from(t,KT).join("")}async function JT(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(a);return Array.from(s).map(l=>String.fromCharCode(l)).join("")}async function QT(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await JT(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function gl(e,t,r=!1){const a=YT();let s=a;r&&(s+="/PASSWORD_RECOVERY"),await Sl(e,`${t}-code-verifier`,s);const l=await QT(a);return[l,a===l?"plain":"s256"]}const ZT=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ek(e){const t=e.headers.get(Ph);if(!t||!t.match(ZT))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function tk(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function rk(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ak=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xl(e){if(!ak.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function fh(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function nk(e,t){return new Proxy(e,{get:(r,a,s)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const l=a.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,s)}return!t.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,a,s)}})}function u1(e){return JSON.parse(JSON.stringify(e))}const ci=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),sk=[502,503,504];async function f1(e){var t;if(!$T(e))throw new mf(ci(e),0);if(sk.includes(e.status))throw new mf(ci(e),e.status);let r;try{r=await e.json()}catch(l){throw new Ns(ci(l),l)}let a;const s=ek(e);if(s&&s.getTime()>=xy["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new Hh(ci(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new ma}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Hh(ci(r),e.status,r.weak_password.reasons);throw new vy(ci(r),e.status||500,a)}const ik=(e,t,r,a)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),s.body=JSON.stringify(a),Object.assign(Object.assign({},s),r))};async function at(e,t,r,a){var s;const l=Object.assign({},a?.headers);l[Ph]||(l[Ph]=xy["2024-01-01"].name),a?.jwt&&(l.Authorization=`Bearer ${a.jwt}`);const c=(s=a?.query)!==null&&s!==void 0?s:{};a?.redirectTo&&(c.redirect_to=a.redirectTo);const u=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",h=await lk(e,t,r+u,{headers:l,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(h):{data:Object.assign({},h),error:null}}async function lk(e,t,r,a,s,l){const c=ik(t,a,s,l);let u;try{u=await e(r,Object.assign({},c))}catch(h){throw console.error(h),new mf(ci(h),0)}if(u.ok||await f1(u),a?.noResolveJson)return u;try{return await u.json()}catch(h){await f1(h)}}function nn(e){var t;let r=null;uk(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=qT(e.expires_in)));const a=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:a},error:null}}function d1(e){const t=nn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Cs(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function ck(e){return{data:e,error:null}}function ok(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:l}=e,c=Pl(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:l},h=Object.assign({},c);return{data:{properties:u,user:h},error:null}}function h1(e){return e}function uk(e){return e.access_token&&e.refresh_token&&e.expires_in}const uf=["global","local","others"];class um{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=Ty(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=uf[0]){if(uf.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${uf.join(", ")}`);try{return await at(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(Qe(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await at(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Cs})}catch(a){if(Qe(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=Pl(t,["options"]),s=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(s.new_email=a?.newEmail,delete s.newEmail),await at(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:ok,redirectTo:r?.redirectTo})}catch(r){if(Qe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await at(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Cs})}catch(r){if(Qe(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,s,l,c,u,h;try{const m={nextPage:null,lastPage:0,total:0},p=await at(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(l=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:h1});if(p.error)throw p.error;const v=await p.json(),_=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,y=(h=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return y.length>0&&(y.forEach(b=>{const w=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(b.split(";")[1].split("=")[1]);m[`${E}Page`]=w}),m.total=parseInt(_)),{data:Object.assign(Object.assign({},v),m),error:null}}catch(m){if(Qe(m))return{data:{users:[]},error:m};throw m}}async getUserById(t){xl(t);try{return await at(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Cs})}catch(r){if(Qe(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){xl(t);try{return await at(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Cs})}catch(a){if(Qe(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){xl(t);try{return await at(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Cs})}catch(a){if(Qe(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){xl(t.userId);try{const{data:r,error:a}=await at(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:a}}catch(r){if(Qe(r))return{data:null,error:r};throw r}}async _deleteFactor(t){xl(t.userId),xl(t.id);try{return{data:await at(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Qe(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,a,s,l,c,u,h;try{const m={nextPage:null,lastPage:0,total:0},p=await at(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(l=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:h1});if(p.error)throw p.error;const v=await p.json(),_=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,y=(h=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return y.length>0&&(y.forEach(b=>{const w=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(b.split(";")[1].split("=")[1]);m[`${E}Page`]=w}),m.total=parseInt(_)),{data:Object.assign(Object.assign({},v),m),error:null}}catch(m){if(Qe(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(t){try{return await at(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Qe(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await at(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Qe(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await at(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Qe(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(t){try{return await at(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Qe(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await at(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Qe(r))return{data:null,error:r};throw r}}}function m1(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const oi={debug:!!(globalThis&&Sy()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class fm extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class ky extends fm{}class fk extends fm{}async function Ay(e,t,r){oi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),oi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async s=>{if(s){oi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{oi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw oi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new ky(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(oi.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}const p1={};async function dk(e,t,r){var a;const s=(a=p1[e])!==null&&a!==void 0?a:Promise.resolve(),l=Promise.race([s.catch(()=>null),t>=0?new Promise((c,u)=>{setTimeout(()=>{u(new fk(`Acquiring process lock with name "${e}" timed out`))},t)}):null].filter(c=>c)).catch(c=>{if(c&&c.isAcquireTimeout)throw c;return null}).then(async()=>await r());return p1[e]=l.catch(async c=>{if(c&&c.isAcquireTimeout)return await s,null;throw c}),await l}function hk(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function jy(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function mk(e){return parseInt(e,16)}function pk(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function gk(e){var t;const{chainId:r,domain:a,expirationTime:s,issuedAt:l=new Date,nonce:c,notBefore:u,requestId:h,resources:m,scheme:p,uri:v,version:_}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!v)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(_!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${_}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const y=jy(e.address),b=p?`${p}://${a}`:a,w=e.statement?`${e.statement}
`:"",E=`${b} wants you to sign in with your Ethereum account:
${y}

${w}`;let k=`URI: ${v}
Version: ${_}
Chain ID: ${r}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(s&&(k+=`
Expiration Time: ${s.toISOString()}`),u&&(k+=`
Not Before: ${u.toISOString()}`),h&&(k+=`
Request ID: ${h}`),m){let A=`
Resources:`;for(const S of m){if(!S||typeof S!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${S}`);A+=`
- ${S}`}k+=A}return`${E}
${k}`}class Sr extends Error{constructor({message:t,code:r,cause:a,name:s}){var l;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(l=s??(a instanceof Error?a.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=r}}class xf extends Sr{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function xk({error:e,options:t}){var r,a,s;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Sr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Sr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Sr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Sr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Sr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Sr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return l.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new Sr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Sr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const c=window.location.hostname;if(Ny(c)){if(l.rp.id!==c)return new Sr({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Sr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Sr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Sr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Sr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function vk({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Sr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Sr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(Ny(a)){if(r.rpId!==a)return new Sr({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Sr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Sr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Sr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class _k{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const yk=new _k;function wk(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:a}=e,s=Pl(e,["challenge","user","excludeCredentials"]),l=Nl(t).buffer,c=Object.assign(Object.assign({},r),{id:Nl(r.id).buffer}),u=Object.assign(Object.assign({},s),{challenge:l,user:c});if(a&&a.length>0){u.excludeCredentials=new Array(a.length);for(let h=0;h<a.length;h++){const m=a[h];u.excludeCredentials[h]=Object.assign(Object.assign({},m),{id:Nl(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return u}function bk(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,a=Pl(e,["challenge","allowCredentials"]),s=Nl(t).buffer,l=Object.assign(Object.assign({},a),{challenge:s});if(r&&r.length>0){l.allowCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const u=r[c];l.allowCredentials[c]=Object.assign(Object.assign({},u),{id:Nl(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function Ek(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:mi(new Uint8Array(e.response.attestationObject)),clientDataJSON:mi(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Sk(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,a=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:mi(new Uint8Array(s.authenticatorData)),clientDataJSON:mi(new Uint8Array(s.clientDataJSON)),signature:mi(new Uint8Array(s.signature)),userHandle:s.userHandle?mi(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Ny(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function g1(){var e,t;return!!(zr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function Tk(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new xf("Browser returned unexpected credential type",t)}:{data:null,error:new xf("Empty credential response",t)}}catch(t){return{data:null,error:xk({error:t,options:e})}}}async function kk(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new xf("Browser returned unexpected credential type",t)}:{data:null,error:new xf("Empty credential response",t)}}catch(t){return{data:null,error:vk({error:t,options:e})}}}const Ak={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},jk={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function vf(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),a={};for(const s of e)if(s)for(const l in s){const c=s[l];if(c!==void 0)if(Array.isArray(c))a[l]=c;else if(r(c))a[l]=c;else if(t(c)){const u=a[l];t(u)?a[l]=vf(u,c):a[l]=vf(c)}else a[l]=c}return a}function Nk(e,t){return vf(Ak,e,t||{})}function Ck(e,t){return vf(jk,e,t||{})}class Ok{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:a,signal:s},l){try{const{data:c,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!c)return{data:null,error:u};const h=s??yk.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:m}=c.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${a}`),m.displayName||(m.displayName=m.name)}switch(c.webauthn.type){case"create":{const m=Nk(c.webauthn.credential_options.publicKey,l?.create),{data:p,error:v}=await Tk({publicKey:m,signal:h});return p?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:p}},error:null}:{data:null,error:v}}case"request":{const m=Ck(c.webauthn.credential_options.publicKey,l?.request),{data:p,error:v}=await kk(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:m,signal:h}));return p?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:p}},error:null}:{data:null,error:v}}}}catch(c){return Qe(c)?{data:null,error:c}:{data:null,error:new Ns("Unexpected error in challenge",c)}}}async _verify({challengeId:t,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!r)return{data:null,error:new Ml("rpId is required for WebAuthn authentication")};try{if(!g1())return{data:null,error:new Ns("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:a},signal:s},{request:l});if(!c)return{data:null,error:u};const{webauthn:h}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:h.type,rpId:r,rpOrigins:a,credential_response:h.credential_response}})}catch(c){return Qe(c)?{data:null,error:c}:{data:null,error:new Ns("Unexpected error in authenticate",c)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!r)return{data:null,error:new Ml("rpId is required for WebAuthn registration")};try{if(!g1())return{data:null,error:new Ns("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this._enroll({friendlyName:t});if(!c)return await this.client.mfa.listFactors().then(p=>{var v;return(v=p.data)===null||v===void 0?void 0:v.all.find(_=>_.factor_type==="webauthn"&&_.friendly_name===t&&_.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p?.id}):void 0),{data:null,error:u};const{data:h,error:m}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:s},{create:l});return h?this._verify({factorId:c.id,challengeId:h.challengeId,webauthn:{rpId:r,rpOrigins:a,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:m}}catch(c){return Qe(c)?{data:null,error:c}:{data:null,error:new Ns("Unexpected error in register",c)}}}}hk();const Rk={url:OT,storageKey:RT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:DT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function x1(e,t,r){return await r()}const vl={};class Bl{get jwks(){var t,r;return(r=(t=vl[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){vl[this.storageKey]=Object.assign(Object.assign({},vl[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=vl[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){vl[this.storageKey]=Object.assign(Object.assign({},vl[this.storageKey]),{cachedAt:t})}constructor(t){var r,a,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},Rk),t);if(this.storageKey=l.storageKey,this.instanceID=(r=Bl.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Bl.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&zr()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new um({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=Ty(l.fetch),this.lock=l.lock||x1,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,l.lock?this.lock=l.lock:this.persistSession&&zr()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=Ay:this.lock=x1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Ok(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:Sy()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=m1(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=m1(this.memoryStorage)),zr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${gy}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},a="none";if(zr()&&(r=GT(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),zr()&&this.detectSessionInUrl&&a!=="none"){const{data:s,error:l}=await this._getSessionFromURL(r,a);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),wy(l)){const h=(t=l.details)===null||t===void 0?void 0:t.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",c,"redirect type",u),await this._saveSession(c),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Qe(r)?this._returnResult({error:r}):this._returnResult({error:new Ns("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,s;try{const l=await at(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(s=t?.options)===null||s===void 0?void 0:s.captchaToken}},xform:nn}),{data:c,error:u}=l;if(u||!c)return this._returnResult({data:{user:null,session:null},error:u});const h=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:m,session:h},error:null})}catch(l){if(Qe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(t){var r,a,s;try{let l;if("email"in t){const{email:p,password:v,options:_}=t;let y=null,b=null;this.flowType==="pkce"&&([y,b]=await gl(this.storage,this.storageKey)),l=await at(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_?.emailRedirectTo,body:{email:p,password:v,data:(r=_?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:_?.captchaToken},code_challenge:y,code_challenge_method:b},xform:nn})}else if("phone"in t){const{phone:p,password:v,options:_}=t;l=await at(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:v,data:(a=_?.data)!==null&&a!==void 0?a:{},channel:(s=_?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:_?.captchaToken}},xform:nn})}else throw new Hc("You must provide either an email or phone number and a password");const{data:c,error:u}=l;if(u||!c)return await Pr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const h=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:m,session:h},error:null})}catch(l){if(await Pr(this.storage,`${this.storageKey}-code-verifier`),Qe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:c,options:u}=t;r=await at(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:d1})}else if("phone"in t){const{phone:l,password:c,options:u}=t;r=await at(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:d1})}else throw new Hc("You must provide either an email or phone number and a password");const{data:a,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!a||!a.session||!a.user){const l=new li;return this._returnResult({data:{user:null,session:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:s})}catch(r){if(Qe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,a,s,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,a,s,l,c,u,h,m,p,v,_;let y,b;if("message"in t)y=t.message,b=t.signature;else{const{chain:w,wallet:E,statement:k,options:A}=t;let S;if(zr())if(typeof E=="object")S=E;else{const G=window;if("ethereum"in G&&typeof G.ethereum=="object"&&"request"in G.ethereum&&typeof G.ethereum.request=="function")S=G.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!A?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=E}const j=new URL((r=A?.url)!==null&&r!==void 0?r:window.location.href),F=await S.request({method:"eth_requestAccounts"}).then(G=>G).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!F||F.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const R=jy(F[0]);let N=(a=A?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!N){const G=await S.request({method:"eth_chainId"});N=mk(G)}const X={domain:j.host,address:R,statement:k,uri:j.href,version:"1",chainId:N,nonce:(s=A?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(c=(l=A?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(u=A?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(h=A?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(m=A?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(p=A?.signInWithEthereum)===null||p===void 0?void 0:p.resources};y=gk(X),b=await S.request({method:"personal_sign",params:[pk(y),R]})}try{const{data:w,error:E}=await at(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:y,signature:b},!((v=t.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(_=t.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:nn});if(E)throw E;if(!w||!w.session||!w.user){const k=new li;return this._returnResult({data:{user:null,session:null},error:k})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:E})}catch(w){if(Qe(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(t){var r,a,s,l,c,u,h,m,p,v,_,y;let b,w;if("message"in t)b=t.message,w=t.signature;else{const{chain:E,wallet:k,statement:A,options:S}=t;let j;if(zr())if(typeof k=="object")j=k;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))j=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!S?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=k}const F=new URL((r=S?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const R=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S?.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),A?{statement:A}:null));let N;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")N=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)N=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)b=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),w=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${F.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...A?["",A,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(s=(a=S?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((l=S?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((c=S?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((u=S?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((h=S?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((m=S?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((v=(p=S?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||v===void 0)&&v.length?["Resources",...S.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const R=await j.signMessage(new TextEncoder().encode(b),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=R}}try{const{data:E,error:k}=await at(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:mi(w)},!((_=t.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(y=t.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:nn});if(k)throw k;if(!E||!E.session||!E.user){const A=new li;return this._returnResult({data:{user:null,session:null},error:A})}return E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),this._returnResult({data:Object.assign({},E),error:k})}catch(E){if(Qe(E))return this._returnResult({data:{user:null,session:null},error:E});throw E}}async _exchangeCodeForSession(t){const r=await ii(this.storage,`${this.storageKey}-code-verifier`),[a,s]=(r??"").split("/");try{if(!a&&this.flowType==="pkce")throw new by;const{data:l,error:c}=await at(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:nn});if(await Pr(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const u=new li;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:s??null}),error:c})}catch(l){if(await Pr(this.storage,`${this.storageKey}-code-verifier`),Qe(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(t){try{const{options:r,provider:a,token:s,access_token:l,nonce:c}=t,u=await at(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:s,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:nn}),{data:h,error:m}=u;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!h||!h.session||!h.user){const p=new li;return this._returnResult({data:{user:null,session:null},error:p})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:m})}catch(r){if(Qe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,a,s,l,c;try{if("email"in t){const{email:u,options:h}=t;let m=null,p=null;this.flowType==="pkce"&&([m,p]=await gl(this.storage,this.storageKey));const{error:v}=await at(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=h?.data)!==null&&r!==void 0?r:{},create_user:(a=h?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:m,code_challenge_method:p},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:v})}if("phone"in t){const{phone:u,options:h}=t,{data:m,error:p}=await at(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=h?.data)!==null&&s!==void 0?s:{},create_user:(l=h?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(c=h?.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:p})}throw new Hc("You must provide either an email or phone number.")}catch(u){if(await Pr(this.storage,`${this.storageKey}-code-verifier`),Qe(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var r,a;try{let s,l;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:c,error:u}=await at(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:s,xform:nn});if(u)throw u;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,m=c.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:m,session:h},error:null})}catch(s){if(Qe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var r,a,s,l,c;try{let u=null,h=null;this.flowType==="pkce"&&([u,h]=await gl(this.storage,this.storageKey));const m=await at(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((s=t?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:h}),headers:this.headers,xform:ck});return!((l=m.data)===null||l===void 0)&&l.url&&zr()&&!(!((c=t.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(u){if(await Pr(this.storage,`${this.storageKey}-code-verifier`),Qe(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new ma;const{error:s}=await at(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(Qe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:s,options:l}=t,{error:c}=await at(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in t){const{phone:a,type:s,options:l}=t,{data:c,error:u}=await at(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:u})}throw new Hc("You must provide either an email or phone number and a type")}catch(r){if(Qe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ii(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<oh:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const c=await ii(this.userStorage,this.storageKey+"-user");c?.user?t.user=c.user:t.user=fh()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};t.user=nk(t.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await at(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Cs}):await this._useSession(async r=>{var a,s,l;const{data:c,error:u}=r;if(u)throw u;return!(!((a=c.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ma}:await at(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(s=c.session)===null||s===void 0?void 0:s.access_token)!==null&&l!==void 0?l:void 0,xform:Cs})})}catch(r){if(Qe(r))return yy(r)&&(await this._removeSession(),await Pr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:s,error:l}=a;if(l)throw l;if(!s.session)throw new ma;const c=s.session;let u=null,h=null;this.flowType==="pkce"&&t.email!=null&&([u,h]=await gl(this.storage,this.storageKey));const{data:m,error:p}=await at(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:h}),jwt:c.access_token,xform:Cs});if(p)throw p;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(a){if(await Pr(this.storage,`${this.storageKey}-code-verifier`),Qe(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ma;const r=Date.now()/1e3;let a=r,s=!0,l=null;const{payload:c}=uh(t.access_token);if(c.exp&&(a=c.exp,s=a<=r),s){const{data:u,error:h}=await this._callRefreshToken(t.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:h}=await this._getUser(t.access_token);if(h)throw h;l={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(r){if(Qe(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:c,error:u}=r;if(u)throw u;t=(a=c.session)!==null&&a!==void 0?a:void 0}if(!t?.refresh_token)throw new ma;const{data:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Qe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!zr())throw new qc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new qc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new zh("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new qc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new zh("No code detected.");const{data:A,error:S}=await this._exchangeCodeForSession(t.code);if(S)throw S;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:s,access_token:l,refresh_token:c,expires_in:u,expires_at:h,token_type:m}=t;if(!l||!u||!c||!m)throw new qc("No session defined in URL");const p=Math.round(Date.now()/1e3),v=parseInt(u);let _=p+v;h&&(_=parseInt(h));const y=_-p;y*1e3<=El&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${v}s`);const b=_-v;p-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,_,p):p-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,_,p);const{data:w,error:E}=await this._getUser(l);if(E)throw E;const k={provider_token:a,provider_refresh_token:s,access_token:l,expires_in:v,expires_at:_,refresh_token:c,token_type:m,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:k,redirectType:t.type},error:null})}catch(a){if(Qe(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ii(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({error:l});const c=(a=s.session)===null||a===void 0?void 0:a.access_token;if(c){const{error:u}=await this.admin.signOut(c,t);if(u&&!(_y(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await Pr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=VT(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,s;try{const{data:{session:l},error:c}=r;if(c)throw c;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let a=null,s=null;this.flowType==="pkce"&&([a,s]=await gl(this.storage,this.storageKey,!0));try{return await at(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(await Pr(this.storage,`${this.storageKey}-code-verifier`),Qe(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Qe(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:a,error:s}=await this._useSession(async l=>{var c,u,h,m,p;const{data:v,error:_}=l;if(_)throw _;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(c=t.options)===null||c===void 0?void 0:c.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=t.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await at(this.fetch,"GET",y,{headers:this.headers,jwt:(p=(m=v.session)===null||m===void 0?void 0:m.access_token)!==null&&p!==void 0?p:void 0})});if(s)throw s;return zr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:t.provider,url:a?.url},error:null})}catch(a){if(Qe(a))return this._returnResult({data:{provider:t.provider,url:null},error:a});throw a}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var a;try{const{error:s,data:{session:l}}=r;if(s)throw s;const{options:c,provider:u,token:h,access_token:m,nonce:p}=t,v=await at(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=l?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:u,id_token:h,access_token:m,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:nn}),{data:_,error:y}=v;return y?this._returnResult({data:{user:null,session:null},error:y}):!_||!_.session||!_.user?this._returnResult({data:{user:null,session:null},error:new li}):(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("USER_UPDATED",_.session)),this._returnResult({data:_,error:y}))}catch(s){if(await Pr(this.storage,`${this.storageKey}-code-verifier`),Qe(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,s;const{data:l,error:c}=r;if(c)throw c;return await at(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Qe(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await XT(async s=>(s>0&&await WT(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await at(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:nn})),(s,l)=>{const c=200*Math.pow(2,s);return l&&of(l)&&Date.now()+c-a<El})}catch(a){if(this._debug(r,"error",a),Qe(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),zr()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const s=await ii(this.storage,this.storageKey);if(s&&this.userStorage){let c=await ii(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:s.user},await Sl(this.userStorage,this.storageKey+"-user",c)),s.user=(t=c?.user)!==null&&t!==void 0?t:fh()}else if(s&&!s.user&&!s.user){const c=await ii(this.storage,this.storageKey+"-user");c&&c?.user?(s.user=c.user,await Pr(this.storage,this.storageKey+"-user"),await Sl(this.storage,this.storageKey,s)):s.user=fh()}if(this._debug(a,"session from storage",s),!this._isValidSession(s)){this._debug(a,"session is not valid"),s!==null&&await this._removeSession();return}const l=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<oh;if(this._debug(a,`session has${l?"":" not"} expired with margin of ${oh}s`),l){if(this.autoRefreshToken&&s.refresh_token){const{error:c}=await this._callRefreshToken(s.refresh_token);c&&(console.error(c),of(c)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:u}=await this._getUser(s.access_token);!u&&c?.user?(s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(a,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(a,"error",s),console.error(s);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new ma;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Mf;const{data:l,error:c}=await this._refreshAccessToken(t);if(c)throw c;if(!l.session)throw new ma;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={data:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(s,"error",l),Qe(l)){const c={data:null,error:l};return of(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(c),c}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(l),l}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,a=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(h){l.push(h)}});if(await Promise.all(c),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Pr(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await Sl(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const l=u1(s);await Sl(this.storage,this.storageKey,l)}else{const s=u1(r);await Sl(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Pr(this.storage,this.storageKey),await Pr(this.storage,this.storageKey+"-code-verifier"),await Pr(this.storage,this.storageKey+"-user"),this.userStorage&&await Pr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&zr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),El);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((a.expires_at*1e3-t)/El);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${El}ms, refresh threshold is ${Ih} ticks`),s<=Ih&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof fm)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!zr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const s=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&s.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[l,c]=await gl(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});s.push(u.toString())}if(a?.queryParams){const l=new URLSearchParams(a.queryParams);s.push(l.toString())}return a?.skipBrowserRedirect&&s.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;return l?this._returnResult({data:null,error:l}):await at(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(Qe(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,s;const{data:l,error:c}=r;if(c)return this._returnResult({data:null,error:c});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:h,error:m}=await at(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(a=l?.session)===null||a===void 0?void 0:a.access_token});return m?this._returnResult({data:null,error:m}):(t.factorType==="totp"&&h.type==="totp"&&(!((s=h?.totp)===null||s===void 0)&&s.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(r){if(Qe(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Ek(t.webauthn.credential_response):Sk(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:h}=await at(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:c,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:h}))})}catch(r){if(Qe(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=await at(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});if(c.error)return c;const{data:u}=c;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:wk(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:bk(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Qe(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const s={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=r?.factors)!==null&&t!==void 0?t:[])s.all.push(l),l.status==="verified"&&s[l.factor_type].push(l);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:a},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=uh(a.access_token);let c=null;l.aal&&(c=l.aal);let u=c;((r=(t=a.user.factors)===null||t===void 0?void 0:t.filter(p=>p.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const m=l.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:a},error:s}=r;return s?this._returnResult({data:null,error:s}):a?await at(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:a.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new ma})})}catch(r){if(Qe(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new ma});const c=await at(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&zr()&&!r?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(a){if(Qe(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new ma});const c=await at(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&zr()&&!r?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(a){if(Qe(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await at(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new ma})})}catch(t){if(Qe(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:a},error:s}=r;return s?this._returnResult({data:null,error:s}):a?(await at(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ma})})}catch(r){if(Qe(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(u=>u.kid===t);if(a)return a;const s=Date.now();if(a=this.jwks.keys.find(u=>u.kid===t),a&&this.jwks_cached_at+MT>s)return a;const{data:l,error:c}=await at(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=s,a=l.keys.find(u=>u.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:y,error:b}=await this.getSession();if(b||!y.session)return this._returnResult({data:null,error:b});a=y.session.access_token}const{header:s,payload:l,signature:c,raw:{header:u,payload:h}}=uh(a);r?.allowExpired||tk(l.exp);const m=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!m){const{error:y}=await this.getUser(a);if(y)throw y;return{data:{claims:l,header:s,signature:c},error:null}}const p=rk(s.alg),v=await crypto.subtle.importKey("jwk",m,p,!0,["verify"]);if(!await crypto.subtle.verify(p,v,c,HT(`${u}.${h}`)))throw new pf("Invalid JWT signature");return{data:{claims:l,header:s,signature:c},error:null}}catch(a){if(Qe(a))return this._returnResult({data:null,error:a});throw a}}}Bl.nextInstanceID={};const Dk=um,Cy=Bl;class Fk extends Cy{constructor(t){super(t)}}class Oy{constructor(t,r,a){var s,l,c;this.supabaseUrl=t,this.supabaseKey=r;const u=CT(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const h=`sb-${u.hostname.split(".")[0]}-auth-token`,m={db:bT,realtime:ST,auth:Object.assign(Object.assign({},ET),{storageKey:h}),global:wT},p=NT(a??{},m);this.storageKey=(s=p.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(l=p.global.headers)!==null&&l!==void 0?l:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(v,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=p.auth)!==null&&c!==void 0?c:{},this.headers,p.global.fetch),this.fetch=AT(r,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.accessToken&&this.accessToken().then(v=>this.realtime.setAuth(v)).catch(v=>console.warn("Failed to set initial Realtime auth token:",v)),this.rest=new SS(new URL("rest/v1",u).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new vT(this.storageUrl.href,this.headers,this.fetch,a?.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new yS(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},a={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,a)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:a}=await this.auth.getSession();return(r=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:a,storage:s,userStorage:l,storageKey:c,flowType:u,lock:h,debug:m,throwOnError:p},v,_){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Fk({url:this.authUrl.href,headers:Object.assign(Object.assign({},y),v),storageKey:c,autoRefreshToken:t,persistSession:r,detectSessionInUrl:a,storage:s,userStorage:l,flowType:u,lock:h,debug:m,throwOnError:p,fetch:_,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new fy(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a?.access_token)})}_handleTokenChanged(t,r,a){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Mk=(e,t,r)=>new Oy(e,t,r);function Bk(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Bk()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Lk=Object.freeze(Object.defineProperty({__proto__:null,AuthAdminApi:Dk,AuthApiError:vy,AuthClient:Cy,AuthError:Ml,AuthImplicitGrantRedirectError:qc,AuthInvalidCredentialsError:Hc,AuthInvalidJwtError:pf,AuthInvalidTokenResponseError:li,AuthPKCECodeVerifierMissingError:by,AuthPKCEGrantCodeExchangeError:zh,AuthRetryableFetchError:mf,AuthSessionMissingError:ma,AuthUnknownError:Ns,AuthWeakPasswordError:Hh,CustomAuthError:bn,get FunctionRegion(){return hf},FunctionsError:Df,FunctionsFetchError:Z_,FunctionsHttpError:Ch,FunctionsRelayError:Nh,GoTrueAdminApi:um,GoTrueClient:Bl,NavigatorLockAcquireTimeoutError:ky,PostgrestError:TS,REALTIME_CHANNEL_STATES:US,get REALTIME_LISTEN_TYPES(){return jl},get REALTIME_POSTGRES_CHANGES_LISTEN_EVENT(){return Mh},get REALTIME_PRESENCE_LISTEN_EVENTS(){return Fh},get REALTIME_SUBSCRIBE_STATES(){return yn},RealtimeChannel:hi,RealtimeClient:fy,RealtimePresence:Al,SIGN_OUT_SCOPES:uf,SupabaseClient:Oy,WebSocketFactory:iy,createClient:Mk,isAuthApiError:_y,isAuthError:Qe,isAuthImplicitGrantRedirectError:wy,isAuthPKCECodeVerifierMissingError:BT,isAuthRetryableFetchError:of,isAuthSessionMissingError:yy,isAuthWeakPasswordError:LT,lockInternals:oi,navigatorLock:Ay,processLock:dk},Symbol.toStringTag,{value:"Module"})),{createClient:Uk}=Lk,Ry="",Ik="",Xu=[{id:"da92028d-3056-4b0c-a467-e3fbe4ce8466",name:"GGG"},{id:"bf01ee1a-e29e-4ef8-8742-53cda36d9452",name:"Miller"}],ye=!!Ry,ne=ye?Uk(Ry,Ik):null,Dy="fieldsync_data",qh="fieldsync_user",ft=()=>{const e=localStorage.getItem(Dy);return e?JSON.parse(e):{projects:[],areas:[],users:[],assignments:[]}},rr=e=>{localStorage.setItem(Dy,JSON.stringify(e))},Ku=()=>{const e=localStorage.getItem(qh);return e?JSON.parse(e):null},Yu=e=>{e?localStorage.setItem(qh,JSON.stringify(e)):localStorage.removeItem(qh)},Pk={async signUp(e,t,r,a){if(ye){const{data:s,error:l}=await ne.auth.signUp({email:e,password:t,options:{data:{name:r,role:a}}});if(l)throw l;return s}else{const s=ft(),l={id:crypto.randomUUID(),email:e,name:r,role:a,created_at:new Date().toISOString()};return s.users.push(l),rr(s),Yu(l),{user:l}}},async signIn(e,t){if(ye){const{data:r,error:a}=await ne.auth.signInWithPassword({email:e,password:t});if(a)throw a;return r}else{const a=ft().users.find(s=>s.email===e);if(!a)throw new Error("User not found");return Yu(a),{user:a}}},async signOut(){if(ye){const{error:e}=await ne.auth.signOut();if(e)throw e}else Yu(null)},async getUser(){if(ye){const{data:{user:e}}=await ne.auth.getUser();return e}else return Ku()},async getProfile(){if(ye){const{data:{user:e}}=await ne.auth.getUser();if(!e)return null;const{data:t,error:r}=await ne.from("users").select("*").eq("id",e.id).single();return r?{id:e.id,email:e.email,name:e.user_metadata?.name||"",role:e.user_metadata?.role||"foreman"}:t}else return Ku()},async updateRole(e,t){if(ye){const{data:r,error:a}=await ne.from("users").update({role:t}).eq("id",e).select().single();if(a)throw a;return r}else{const r=ft(),a=r.users.find(s=>s.id===e);return a&&(a.role=t,rr(r),Ku()?.id===e&&Yu(a)),a}},onAuthStateChange(e){if(ye)return ne.auth.onAuthStateChange(e);{const t=Ku();return e(t?"SIGNED_IN":"SIGNED_OUT",{user:t}),{data:{subscription:{unsubscribe:()=>{}}}}}}},Ge={async getProjects(e=null,t=!1){if(ye){let r=ne.from("projects").select("*").order("created_at",{ascending:!1});e&&(r=r.eq("company_id",e)),t||(r=r.eq("status","active"));const{data:a,error:s}=await r;if(s)throw s;return a}else{const r=ft().projects;return t?r:r.filter(a=>a.status!=="archived")}},async getArchivedProjects(e){if(ye){const{data:t,error:r}=await ne.from("projects").select("*").eq("company_id",e).eq("status","archived").order("archived_at",{ascending:!1});if(r)throw r;return t}else return ft().projects.filter(t=>t.status==="archived")},async getProjectCount(e){if(ye){const{count:t,error:r}=await ne.from("projects").select("*",{count:"exact",head:!0}).eq("company_id",e).in("status",["active","archived"]);if(r)throw r;return t||0}else return ft().projects.filter(r=>r.company_id===e&&r.status!=="deleted").length},async archiveProject(e){if(ye){const{data:t,error:r}=await ne.from("projects").update({status:"archived",archived_at:new Date().toISOString()}).eq("id",e).select().single();if(r)throw r;return t}else{const t=ft(),r=t.projects.find(a=>a.id===e);return r&&(r.status="archived",r.archived_at=new Date().toISOString(),rr(t)),r}},async restoreProject(e){if(ye){const{data:t,error:r}=await ne.from("projects").update({status:"active",archived_at:null}).eq("id",e).select().single();if(r)throw r;return t}else{const t=ft(),r=t.projects.find(a=>a.id===e);return r&&(r.status="active",r.archived_at=null,rr(t)),r}},async getProject(e){if(ye){const{data:t,error:r}=await ne.from("projects").select("*").eq("id",e).single();if(r)throw r;return t}else return ft().projects.find(t=>t.id===e)},async createProject(e){if(ye){const{data:t,error:r}=await ne.from("projects").insert({...e,status:"active"}).select().single();if(r)throw r;return t}else{const t=ft(),r={...e,id:crypto.randomUUID(),status:"active",created_at:new Date().toISOString()};return t.projects.push(r),rr(t),r}},async getProjectByPin(e){if(ye){const{data:t,error:r}=await ne.from("projects").select("*").eq("pin",e).eq("status","active").single();return r?null:t}else return ft().projects.find(r=>r.pin===e&&r.status==="active")||null},async getProjectByPinAndCompany(e,t){if(ye){const{data:r,error:a}=await ne.from("projects").select("*").eq("pin",e).eq("company_id",t).eq("status","active").single();return a?null:r}else return ft().projects.find(a=>a.pin===e&&a.company_id===t&&a.status==="active")||null},async isPinAvailable(e,t=null){if(ye){let r=ne.from("projects").select("id").eq("pin",e);t&&(r=r.neq("id",t));const{data:a,error:s}=await r;if(s)throw s;return a.length===0}else return!ft().projects.some(a=>a.pin===e&&a.id!==t)},async updateProjectPin(e,t){if(ye){const{data:r,error:a}=await ne.from("projects").update({pin:t}).eq("id",e).select().single();if(a)throw a;return r}else{const r=ft(),a=r.projects.find(s=>s.id===e);return a&&(a.pin=t,rr(r)),a}},async updateProject(e,t){if(ye){const{data:r,error:a}=await ne.from("projects").update(t).eq("id",e).select().single();if(a)throw a;return r}else{const r=ft(),a=r.projects.find(s=>s.id===e);return a&&(Object.assign(a,t),rr(r)),a}},async updateProjectStatus(e,t){return this.updateProject(e,{status:t})},async deleteProject(e){if(ye){const{error:t}=await ne.from("projects").delete().eq("id",e);if(t)throw t}else{const t=ft();t.projects=t.projects.filter(r=>r.id!==e),t.areas=t.areas.filter(r=>r.project_id!==e),rr(t)}},async getAreas(e){if(ye){const{data:t,error:r}=await ne.from("areas").select("*").eq("project_id",e).order("sort_order",{ascending:!0});if(r)throw r;return t}else return ft().areas.filter(t=>t.project_id===e)},async createArea(e){if(ye){const{data:t,error:r}=await ne.from("areas").insert(e).select().single();if(r)throw r;return t}else{const t=ft(),r={...e,id:crypto.randomUUID(),created_at:new Date().toISOString()};return t.areas.push(r),rr(t),r}},async updateAreaStatus(e,t){if(ye){const{data:r,error:a}=await ne.from("areas").update({status:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(a)throw a;return r}else{const r=ft(),a=r.areas.find(s=>s.id===e);return a&&(a.status=t,a.updated_at=new Date().toISOString()),rr(r),a}},async updateArea(e,t){if(ye){const{data:r,error:a}=await ne.from("areas").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(a)throw a;return r}else{const r=ft(),a=r.areas.find(s=>s.id===e);return a&&(Object.assign(a,t),a.updated_at=new Date().toISOString()),rr(r),a}},async deleteArea(e){if(ye){const{error:t}=await ne.from("areas").delete().eq("id",e);if(t)throw t}else{const t=ft();t.areas=t.areas.filter(r=>r.id!==e),rr(t)}},subscribeToAreas(e,t){return ye?ne.channel(`areas:${e}`).on("postgres_changes",{event:"*",schema:"public",table:"areas",filter:`project_id=eq.${e}`},t).subscribe():null},unsubscribe(e){e&&ye&&ne.removeChannel(e)},async getAssignedProjects(e){if(ye){const{data:t,error:r}=await ne.from("project_assignments").select(`
          project_id,
          projects (*)
        `).eq("user_id",e);if(r)throw r;return t.map(a=>a.projects)}else{const t=ft();return(t.assignments?.filter(a=>a.user_id===e)||[]).map(a=>t.projects.find(s=>s.id===a.project_id)).filter(Boolean)}},async assignUserToProject(e,t,r){if(ye){const{data:a,error:s}=await ne.from("project_assignments").insert({project_id:e,user_id:t,assigned_by:r}).select().single();if(s)throw s;return a}else{const a=ft();a.assignments||(a.assignments=[]);const s={id:crypto.randomUUID(),project_id:e,user_id:t,assigned_by:r,assigned_at:new Date().toISOString()};return a.assignments.push(s),rr(a),s}},async removeUserFromProject(e,t){if(ye){const{error:r}=await ne.from("project_assignments").delete().eq("project_id",e).eq("user_id",t);if(r)throw r}else{const r=ft();r.assignments=r.assignments?.filter(a=>!(a.project_id===e&&a.user_id===t))||[],rr(r)}},async getProjectAssignments(e){if(ye){const{data:t,error:r}=await ne.from("project_assignments").select(`
          user_id,
          users (id, email, name, role)
        `).eq("project_id",e);if(r)throw r;return t.map(a=>a.users)}else{const t=ft();return(t.assignments?.filter(a=>a.project_id===e)||[]).map(a=>t.users.find(s=>s.id===a.user_id)).filter(Boolean)}},async getAllUsers(){if(ye){const{data:e,error:t}=await ne.from("users").select("*").order("name");if(t)throw t;return e}else return ft().users||[]},async getForemen(){if(ye){const{data:e,error:t}=await ne.from("users").select("*").eq("role","foreman").order("name");if(t)throw t;return e}else return(ft().users||[]).filter(e=>e.role==="foreman")},async logActivity(e,t,r,a,s,l){if(ye){const{error:c}=await ne.from("activity_log").insert({user_id:e,project_id:t,area_id:r,action:a,old_value:s,new_value:l});c&&console.error("Error logging activity:",c)}},async getProjectActivity(e,t=50){if(ye){const{data:r,error:a}=await ne.from("activity_log").select(`
          *,
          users (name, email),
          areas (name)
        `).eq("project_id",e).order("created_at",{ascending:!1}).limit(t);if(a)throw a;return r}return[]},async getMaterialsEquipment(e){if(ye){const{data:t,error:r}=await ne.from("materials_equipment").select("*").eq("company_id",e).eq("active",!0).order("category").order("name");if(r)throw r;return t}return[]},async getMaterialsEquipmentByCategory(e,t){if(ye){const{data:r,error:a}=await ne.from("materials_equipment").select("*").eq("company_id",e).eq("category",t).eq("active",!0).order("name");if(a)throw a;return r}return[]},async getAllMaterialsEquipment(e){if(ye){const{data:t,error:r}=await ne.from("materials_equipment").select("*").eq("company_id",e).order("category").order("name");if(r)throw r;return t}return[]},async createMaterialEquipment(e){if(ye){const{data:t,error:r}=await ne.from("materials_equipment").insert(e).select().single();if(r)throw r;return t}return null},async updateMaterialEquipment(e,t){if(ye){const{data:r,error:a}=await ne.from("materials_equipment").update(t).eq("id",e).select().single();if(a)throw a;return r}return null},async deleteMaterialEquipment(e){if(ye){const{error:t}=await ne.from("materials_equipment").update({active:!1}).eq("id",e);if(t)throw t}},async getTMTickets(e){if(ye){const{data:t,error:r}=await ne.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",e).order("created_at",{ascending:!1});if(r)throw r;return t}return[]},async getTMTicketsByStatus(e,t){if(ye){const{data:r,error:a}=await ne.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",e).eq("status",t).order("created_at",{ascending:!1});if(a)throw a;return r}return[]},async createTMTicket(e){if(ye){const{data:t,error:r}=await ne.from("t_and_m_tickets").insert({project_id:e.project_id,work_date:e.work_date,ce_pco_number:e.ce_pco_number||null,notes:e.notes,photos:e.photos||[],status:"pending",created_by_name:e.created_by_name||"Field User"}).select().single();if(r)throw r;return t}return null},async addTMWorkers(e,t){if(ye){const r=t.map(s=>({ticket_id:e,name:s.name,hours:s.hours,overtime_hours:s.overtime_hours||0,time_started:s.time_started||null,time_ended:s.time_ended||null,role:s.role||"Laborer"})),{error:a}=await ne.from("t_and_m_workers").insert(r);if(a)throw a}},async addTMItems(e,t){if(ye){const r=t.map(s=>({ticket_id:e,material_equipment_id:s.material_equipment_id||null,custom_name:s.custom_name||null,custom_category:s.custom_category||null,quantity:s.quantity})),{error:a}=await ne.from("t_and_m_items").insert(r);if(a)throw a}},async updateTMTicketStatus(e,t){if(ye){const{data:r,error:a}=await ne.from("t_and_m_tickets").update({status:t}).eq("id",e).select().single();if(a)throw a;return r}return null},async approveTMTicket(e,t,r){if(ye){const{data:a,error:s}=await ne.from("t_and_m_tickets").update({status:"approved",approved_by_user_id:t,approved_by_name:r,approved_at:new Date().toISOString(),rejected_by_user_id:null,rejected_by_name:null,rejected_at:null,rejection_reason:null}).eq("id",e).select().single();if(s)throw s;return a}return null},async rejectTMTicket(e,t,r,a=""){if(ye){const{data:s,error:l}=await ne.from("t_and_m_tickets").update({status:"rejected",rejected_by_user_id:t,rejected_by_name:r,rejected_at:new Date().toISOString(),rejection_reason:a,approved_by_user_id:null,approved_by_name:null,approved_at:null}).eq("id",e).select().single();if(l)throw l;return s}return null},canApproveTickets(e){return["owner","admin","manager"].includes(e)},async updateTMTicketPhotos(e,t){if(ye){const{data:r,error:a}=await ne.from("t_and_m_tickets").update({photos:t}).eq("id",e).select().single();if(a)throw a;return r}return null},async deleteTMTicket(e){if(ye){const{error:t}=await ne.from("t_and_m_tickets").delete().eq("id",e);if(t)throw t}},async getCompanyByCode(e){if(ye){const{data:t,error:r}=await ne.from("companies").select("*").eq("code",e.toUpperCase().trim()).single();return r?(console.error("Error fetching company by code:",{code:e,error:r.message,hint:r.hint,details:r.details}),null):t}return null},async getCompany(e){if(ye){const{data:t,error:r}=await ne.from("companies").select("*").eq("id",e).single();if(r)throw r;return t}return null},async getUserCompanies(e){if(!ye)return[];try{const{data:t,error:r}=await ne.from("user_companies").select(`
          *,
          companies (*)
        `).eq("user_id",e).order("created_at",{ascending:!0});return r?(console.error("Error fetching user companies:",r),[]):t?.map(a=>({...a.companies,userRole:a.role}))||[]}catch(t){return console.error("Error fetching user companies:",t),[]}},async getUsersForCompany(e){if(!ye)return[];try{const{data:t,error:r}=await ne.from("user_companies").select(`
          user_id,
          users (id, email, name, role)
        `).eq("company_id",e);return r?(console.error("Error fetching users for company:",r),[]):t?.map(a=>a.users).filter(Boolean)||[]}catch(t){return console.error("Error fetching users for company:",t),[]}},async uploadPhoto(e,t,r,a){if(!ye)return null;const s=Date.now(),l=Math.random().toString(36).substring(7),c=a.name?.split(".").pop()||"jpg",u=`${s}-${l}.${c}`,h=`${e}/${t}/${r}/${u}`,{data:m,error:p}=await ne.storage.from("tm-photos").upload(h,a,{cacheControl:"3600",upsert:!1});if(p)throw p;const{data:v}=ne.storage.from("tm-photos").getPublicUrl(h);return v.publicUrl},async uploadPhotoBase64(e,t,r,a,s="photo.jpg"){if(!ye)return null;const c=await(await fetch(a)).blob(),u=Date.now(),h=Math.random().toString(36).substring(7),m=s.split(".").pop()||"jpg",p=`${u}-${h}.${m}`,v=`${e}/${t}/${r}/${p}`,{data:_,error:y}=await ne.storage.from("tm-photos").upload(v,c,{cacheControl:"3600",upsert:!1,contentType:c.type});if(y)throw y;const{data:b}=ne.storage.from("tm-photos").getPublicUrl(v);return b.publicUrl},async deletePhoto(e){if(!ye)return;const r=new URL(e).pathname.match(/\/tm-photos\/(.+)$/);if(!r)return;const a=r[1],{error:s}=await ne.storage.from("tm-photos").remove([a]);if(s)throw s},async getCrewCheckin(e,t=null){if(!ye)return null;const r=t||new Date().toISOString().split("T")[0],{data:a,error:s}=await ne.from("crew_checkins").select("*").eq("project_id",e).eq("check_in_date",r).single();return s&&s.code!=="PGRST116"&&console.error("Error fetching crew checkin:",s),a},async saveCrewCheckin(e,t,r=null,a=null){if(!ye)return null;const s=a||new Date().toISOString().split("T")[0],{data:l,error:c}=await ne.from("crew_checkins").upsert({project_id:e,check_in_date:s,workers:t,created_by:r,updated_at:new Date().toISOString()},{onConflict:"project_id,check_in_date"}).select().single();if(c)throw console.error("Error saving crew checkin:",c),c;return l},async addCrewMember(e,t,r=null){if(!ye)return null;const a=await this.getCrewCheckin(e),s=a?.workers||[];return s.find(l=>l.name.toLowerCase()===t.name.toLowerCase())?a:(s.push(t),await this.saveCrewCheckin(e,s,r))},async removeCrewMember(e,t){if(!ye)return null;const r=await this.getCrewCheckin(e);if(!r)return null;const a=r.workers.filter(s=>s.name.toLowerCase()!==t.toLowerCase());return await this.saveCrewCheckin(e,a,r.created_by)},async getCrewCheckinHistory(e,t=30){if(!ye)return[];const{data:r,error:a}=await ne.from("crew_checkins").select("*").eq("project_id",e).order("check_in_date",{ascending:!1}).limit(t);return a?(console.error("Error fetching crew history:",a),[]):r||[]},async getDailyReport(e,t=null){if(!ye)return null;const r=t||new Date().toISOString().split("T")[0],{data:a,error:s}=await ne.from("daily_reports").select("*").eq("project_id",e).eq("report_date",r).single();return s&&s.code!=="PGRST116"&&console.error("Error fetching daily report:",s),a},async compileDailyReport(e,t=null){if(!ye)return null;const r=t||new Date().toISOString().split("T")[0],a=await this.getCrewCheckin(e,r),{data:s}=await ne.from("areas").select("*").eq("project_id",e),l=s?.filter(h=>h.status==="done"&&h.completed_at?.startsWith(r))||[],{data:c}=await ne.from("t_and_m_tickets").select("*").eq("project_id",e).eq("work_date",r),u=c?.reduce((h,m)=>h+(m.photos?.length||0),0)||0;return{crew_count:a?.workers?.length||0,crew_list:a?.workers||[],tasks_completed:l.length,tasks_total:s?.length||0,completed_tasks:l.map(h=>({name:h.name,group:h.group_name})),tm_tickets_count:c?.length||0,photos_count:u}},async saveDailyReport(e,t,r=null){if(!ye)return null;const a=r||new Date().toISOString().split("T")[0],{data:s,error:l}=await ne.from("daily_reports").upsert({project_id:e,report_date:a,...t,updated_at:new Date().toISOString()},{onConflict:"project_id,report_date"}).select().single();if(l)throw console.error("Error saving daily report:",l),l;return s},async submitDailyReport(e,t,r=null){if(!ye)return null;const a=r||new Date().toISOString().split("T")[0],s=await this.compileDailyReport(e,a),{data:l,error:c}=await ne.from("daily_reports").upsert({project_id:e,report_date:a,...s,status:"submitted",submitted_at:new Date().toISOString(),submitted_by:t,updated_at:new Date().toISOString()},{onConflict:"project_id,report_date"}).select().single();if(c)throw console.error("Error submitting daily report:",c),c;return l},async getDailyReports(e,t=30){if(!ye)return[];const{data:r,error:a}=await ne.from("daily_reports").select("*").eq("project_id",e).order("report_date",{ascending:!1}).limit(t);return a?(console.error("Error fetching daily reports:",a),[]):r||[]},async sendMessage(e,t,r,a,s=null,l=null,c="general",u=null){if(!ye)return null;const{data:h,error:m}=await ne.from("messages").insert({project_id:e,sender_type:r,sender_name:a,sender_user_id:s,message:t,photo_url:l,message_type:c,parent_message_id:u}).select().single();if(m)throw console.error("Error sending message:",m),m;return h},async getMessages(e,t=50){if(!ye)return[];const{data:r,error:a}=await ne.from("messages").select("*").eq("project_id",e).order("created_at",{ascending:!1}).limit(t);return a?(console.error("Error fetching messages:",a),[]):r||[]},async getUnreadCount(e,t){if(!ye)return 0;const r=t==="field"?"office":"field",{count:a,error:s}=await ne.from("messages").select("*",{count:"exact",head:!0}).eq("project_id",e).eq("sender_type",r).eq("is_read",!1);return s?(console.error("Error getting unread count:",s),0):a||0},async markMessagesRead(e,t){if(!ye)return;const r=t==="field"?"office":"field",{error:a}=await ne.from("messages").update({is_read:!0,read_at:new Date().toISOString()}).eq("project_id",e).eq("sender_type",r).eq("is_read",!1);a&&console.error("Error marking messages read:",a)},async createMaterialRequest(e,t,r,a=null,s="normal",l=null){if(!ye)return null;const{data:c,error:u}=await ne.from("material_requests").insert({project_id:e,items:t,requested_by:r,needed_by:a,priority:s,notes:l}).select().single();if(u)throw console.error("Error creating material request:",u),u;if(c)try{const{data:h}=await ne.from("projects").select("name, company_id").eq("id",e).single();if(h){const m=s==="urgent"?"material_request_urgent":"material_request_submitted",{data:p}=await ne.from("user_notification_roles").select(`
              user_id,
              notification_roles!inner(company_id, role_key)
            `).eq("notification_roles.company_id",h.company_id).eq("notification_roles.role_key","materials_manager");if(p&&p.length>0){const v=t.map(b=>`${b.quantity} ${b.unit} ${b.name}`).join(", "),_=s==="urgent"?" Urgent Material Request":" New Material Request",y=`${r} requested: ${v} for ${h.name}`;for(const b of p)await this.createNotification(h.company_id,m,b.user_id,_,y,`/projects/${e}`,{request_id:c.id,project_id:e,priority:s,items_count:t.length})}}}catch(h){console.error("Error sending material request notification:",h)}return c},async getMaterialRequests(e,t=null){if(!ye)return[];let r=ne.from("material_requests").select("*").eq("project_id",e).order("created_at",{ascending:!1});t&&(r=r.eq("status",t));const{data:a,error:s}=await r;return s?(console.error("Error fetching material requests:",s),[]):a||[]},async getPendingRequestsCount(e){if(!ye)return 0;const{count:t,error:r}=await ne.from("material_requests").select("*",{count:"exact",head:!0}).eq("project_id",e).eq("status","pending");return r?0:t||0},async updateMaterialRequest(e,t,r,a=null,s=null){if(!ye)return null;const l={status:t,responded_by:r,responded_at:new Date().toISOString(),response_notes:a,updated_at:new Date().toISOString()};s&&(l.expected_delivery=s),t==="delivered"&&(l.delivered_at=new Date().toISOString());const{data:c,error:u}=await ne.from("material_requests").update(l).eq("id",e).select().single();if(u)throw console.error("Error updating material request:",u),u;return c},generateShareToken(){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let t="";for(let r=0;r<12;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t},async createProjectShare(e,t,r,a=null){if(!ye){const h=ft();h.projectShares||(h.projectShares=[]);const m={id:crypto.randomUUID(),project_id:e,share_token:this.generateShareToken(),created_by:t,expires_at:a,is_active:!0,permissions:r,view_count:0,last_viewed_at:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return h.projectShares.push(m),rr(h),m}const{data:s,error:l}=await ne.rpc("generate_share_token");if(l)throw console.error("Error generating share token:",l),l;const{data:c,error:u}=await ne.from("project_shares").insert({project_id:e,share_token:s,created_by:t,expires_at:a,permissions:r}).select().single();if(u)throw console.error("Error creating project share:",u),u;return c},async getShareByToken(e){if(!ye){const a=ft();if(!a.projectShares)return null;const s=a.projectShares.find(l=>l.share_token===e&&l.is_active&&(!l.expires_at||new Date(l.expires_at)>new Date));return s&&(s.view_count++,s.last_viewed_at=new Date().toISOString(),rr(a)),s}const{data:t,error:r}=await ne.from("project_shares").select("*, projects(*)").eq("share_token",e).eq("is_active",!0).single();return r?(console.error("Error fetching share by token:",r),null):t.expires_at&&new Date(t.expires_at)<new Date?null:(await ne.rpc("increment_share_view_count",{token:e}),t)},async getProjectShares(e){if(!ye){const a=ft();return a.projectShares?a.projectShares.filter(s=>s.project_id===e):[]}const{data:t,error:r}=await ne.from("project_shares").select("*, users(name, email)").eq("project_id",e).order("created_at",{ascending:!1});return r?(console.error("Error fetching project shares:",r),[]):t||[]},async updateProjectShare(e,t){if(!ye){const s=ft();if(!s.projectShares)return null;const l=s.projectShares.findIndex(c=>c.id===e);return l===-1?null:(s.projectShares[l]={...s.projectShares[l],...t,updated_at:new Date().toISOString()},rr(s),s.projectShares[l])}const{data:r,error:a}=await ne.from("project_shares").update(t).eq("id",e).select().single();if(a)throw console.error("Error updating project share:",a),a;return r},async revokeProjectShare(e){return this.updateProjectShare(e,{is_active:!1})},async deleteProjectShare(e){if(!ye){const r=ft();if(!r.projectShares)return;r.projectShares=r.projectShares.filter(a=>a.id!==e),rr(r);return}const{error:t}=await ne.from("project_shares").delete().eq("id",e);if(t)throw console.error("Error deleting project share:",t),t},async getPublicProjectData(e){const t=await this.getShareByToken(e);if(!t)return null;const r=t.project_id||t.projects?.id;if(!ye){const l=ft(),c=l.projects.find(v=>v.id===r);if(!c)return null;const u=l.areas.filter(v=>v.project_id===r),h=u.reduce((v,_)=>v+parseFloat(_.weight||0),0),m=u.filter(v=>v.status==="done").reduce((v,_)=>v+parseFloat(_.weight||0),0),p=h>0?Math.round(m/h*100):0;return{share:t,project:c,progress:p,areas:t.permissions.progress?u:[],photos:[],dailyReports:[],tmTickets:[]}}const a=t.projects||await this.getProject(r);if(!a)return null;const s={share:t,project:a,areas:[],photos:[],dailyReports:[],tmTickets:[]};if(t.permissions.progress){s.areas=await this.getAreas(r);const l=s.areas.reduce((u,h)=>u+parseFloat(h.weight||0),0),c=s.areas.filter(u=>u.status==="done").reduce((u,h)=>u+parseFloat(h.weight||0),0);s.progress=l>0?Math.round(c/l*100):0}if(t.permissions.photos){const{data:l}=await ne.from("t_and_m_tickets").select("photos, work_date").eq("project_id",r).not("photos","is",null).order("work_date",{ascending:!1}).limit(20);s.photos=l?.flatMap(c=>(c.photos||[]).map(u=>({url:u,date:c.work_date})))||[]}if(t.permissions.daily_reports){const{data:l}=await ne.from("daily_reports").select("*").eq("project_id",r).order("report_date",{ascending:!1}).limit(10);s.dailyReports=l||[]}return t.permissions.tm_tickets&&(s.tmTickets=await this.getTMTickets(r)),s},async createInjuryReport(e){if(!ye){const a=ft();a.injuryReports||(a.injuryReports=[]);const s={id:crypto.randomUUID(),...e,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return a.injuryReports.push(s),rr(a),s}const{data:t,error:r}=await ne.from("injury_reports").insert(e).select().single();if(r)throw console.error("Error creating injury report:",r),r;return t},async getInjuryReports(e){if(!ye){const a=ft();return a.injuryReports?a.injuryReports.filter(s=>s.project_id===e).sort((s,l)=>new Date(l.incident_date)-new Date(s.incident_date)):[]}const{data:t,error:r}=await ne.from("injury_reports").select("*").eq("project_id",e).order("incident_date",{ascending:!1});return r?(console.error("Error fetching injury reports:",r),[]):t||[]},async getCompanyInjuryReports(e,t=null){if(!ye){const l=ft();if(!l.injuryReports)return[];let c=l.injuryReports.filter(u=>u.company_id===e);return t&&(c=c.filter(u=>u.status===t)),c.sort((u,h)=>new Date(h.incident_date)-new Date(u.incident_date))}let r=ne.from("injury_reports").select("*, projects(name)").eq("company_id",e).order("incident_date",{ascending:!1});t&&(r=r.eq("status",t));const{data:a,error:s}=await r;return s?(console.error("Error fetching company injury reports:",s),[]):a||[]},async getInjuryReport(e){if(!ye){const a=ft();return a.injuryReports?a.injuryReports.find(s=>s.id===e):null}const{data:t,error:r}=await ne.from("injury_reports").select("*, projects(name, pin), users(name, email)").eq("id",e).single();return r?(console.error("Error fetching injury report:",r),null):t},async updateInjuryReport(e,t){if(!ye){const s=ft();if(!s.injuryReports)return null;const l=s.injuryReports.findIndex(c=>c.id===e);return l===-1?null:(s.injuryReports[l]={...s.injuryReports[l],...t,updated_at:new Date().toISOString()},rr(s),s.injuryReports[l])}const{data:r,error:a}=await ne.from("injury_reports").update(t).eq("id",e).select().single();if(a)throw console.error("Error updating injury report:",a),a;return r},async closeInjuryReport(e,t){return this.updateInjuryReport(e,{status:"closed",closed_at:new Date().toISOString(),closed_by:t})},async deleteInjuryReport(e){if(!ye){const r=ft();if(!r.injuryReports)return;r.injuryReports=r.injuryReports.filter(a=>a.id!==e),rr(r);return}const{error:t}=await ne.from("injury_reports").delete().eq("id",e);if(t)throw console.error("Error deleting injury report:",t),t},async getInjuryStatistics(e,t=null,r=null){if(!ye){const l=ft();if(!l.injuryReports)return{total_incidents:0,minor_injuries:0,serious_injuries:0,critical_injuries:0,near_misses:0,osha_recordable:0,total_days_away:0,total_restricted_days:0};let c=l.injuryReports.filter(u=>u.company_id===e);return t&&(c=c.filter(u=>new Date(u.incident_date)>=new Date(t))),r&&(c=c.filter(u=>new Date(u.incident_date)<=new Date(r))),{total_incidents:c.length,minor_injuries:c.filter(u=>u.injury_type==="minor").length,serious_injuries:c.filter(u=>u.injury_type==="serious").length,critical_injuries:c.filter(u=>u.injury_type==="critical").length,near_misses:c.filter(u=>u.injury_type==="near_miss").length,osha_recordable:c.filter(u=>u.osha_recordable).length,total_days_away:c.reduce((u,h)=>u+(h.days_away_from_work||0),0),total_restricted_days:c.reduce((u,h)=>u+(h.restricted_work_days||0),0)}}const{data:a,error:s}=await ne.rpc("get_injury_statistics",{comp_id:e,start_date:t,end_date:r});return s?(console.error("Error fetching injury statistics:",s),null):a[0]||null},async addWitness(e,t){if(!ye){const s=ft();if(!s.injuryReports)return null;const l=s.injuryReports.findIndex(h=>h.id===e);if(l===-1)return null;const c=s.injuryReports[l],u=c.witnesses||[];return u.push(t),s.injuryReports[l]={...c,witnesses:u,updated_at:new Date().toISOString()},rr(s),s.injuryReports[l]}const r=await this.getInjuryReport(e);if(!r)return null;const a=r.witnesses||[];return a.push(t),this.updateInjuryReport(e,{witnesses:a})},async removeWitness(e,t){if(!ye){const s=ft();if(!s.injuryReports)return null;const l=s.injuryReports.findIndex(h=>h.id===e);if(l===-1)return null;const c=s.injuryReports[l],u=c.witnesses||[];return u.splice(t,1),s.injuryReports[l]={...c,witnesses:u,updated_at:new Date().toISOString()},rr(s),s.injuryReports[l]}const r=await this.getInjuryReport(e);if(!r)return null;const a=r.witnesses||[];return a.splice(t,1),this.updateInjuryReport(e,{witnesses:a})},async getDashboardMetrics(e){if(!ye)return{activeProjects:0,crewToday:0,pendingTMCount:0,pendingTMValue:0,urgentRequests:0,unreadMessages:0};try{const{count:t}=await ne.from("projects").select("*",{count:"exact",head:!0}).eq("company_id",e);return{activeProjects:t||0,crewToday:0,pendingTMCount:0,pendingTMValue:0,urgentRequests:0,unreadMessages:0}}catch(t){return console.error("Error fetching dashboard metrics:",t),{activeProjects:0,crewToday:0,pendingTMCount:0,pendingTMValue:0,urgentRequests:0,unreadMessages:0}}},async getProjectSummaries(e){if(!ye)return[];try{const{data:t,error:r}=await ne.from("projects").select("*").eq("company_id",e).order("created_at",{ascending:!1});if(r)throw r;return t?await Promise.all(t.map(async s=>{const{data:l}=await ne.from("areas").select("*").eq("project_id",s.id),c=l?.reduce((p,v)=>p+parseFloat(v.weight||0),0)||0,u=l?.filter(p=>p.status==="done").reduce((p,v)=>p+parseFloat(v.weight||0),0)||0,h=c>0?Math.round(u/c*100):0;let m="green";return h<30?m="red":h<70&&(m="yellow"),{...s,progress:h,crewToday:0,pendingItems:0,statusColor:m}})):[]}catch(t){return console.error("Error fetching project summaries:",t),[]}},async getNeedsAttention(e){return{pendingTM:[],pendingMaterials:[],missingReports:[],overBudget:[],unreadMessages:[]}},async getRecentActivity(e,t=20){return[]},async getNotificationRoles(e){if(!ye)return[];try{const{data:t,error:r}=await ne.from("notification_roles").select("*").eq("company_id",e).order("role_name");if(r)throw r;return t||[]}catch(t){return console.error("Error fetching notification roles:",t),[]}},async getUsersByNotificationRole(e){if(!ye)return[];try{const{data:t,error:r}=await ne.from("user_notification_roles").select(`
          *,
          users (id, email, name)
        `).eq("role_id",e);if(r)throw r;return t||[]}catch(t){return console.error("Error fetching users by role:",t),[]}},async getUserNotificationRoles(e){if(!ye)return[];try{const{data:t,error:r}=await ne.from("user_notification_roles").select(`
          *,
          notification_roles (*)
        `).eq("user_id",e);if(r)throw r;return t||[]}catch(t){return console.error("Error fetching user roles:",t),[]}},async assignNotificationRole(e,t,r){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{error:a}=await ne.from("user_notification_roles").insert({user_id:e,role_id:t,assigned_by:r});if(a)throw a;return{success:!0}}catch(a){return console.error("Error assigning notification role:",a),{success:!1,error:a.message}}},async removeNotificationRole(e,t){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{error:r}=await ne.from("user_notification_roles").delete().eq("user_id",e).eq("role_id",t);if(r)throw r;return{success:!0}}catch(r){return console.error("Error removing notification role:",r),{success:!1,error:r.message}}},async createNotificationRole(e,t,r,a){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{data:s,error:l}=await ne.from("notification_roles").insert({company_id:e,role_name:t,role_key:r,description:a}).select().single();if(l)throw l;return{success:!0,data:s}}catch(s){return console.error("Error creating notification role:",s),{success:!1,error:s.message}}},async getNotificationTypes(){if(!ye)return[];try{const{data:e,error:t}=await ne.from("notification_types").select("*").order("category",{ascending:!0}).order("type_name",{ascending:!0});if(t)throw t;return e||[]}catch(e){return console.error("Error fetching notification types:",e),[]}},async getNotificationPreferences(e,t){if(!ye)return[];try{const{data:r,error:a}=await ne.from("notification_preferences").select(`
          *,
          notification_types (*)
        `).eq("user_id",e).eq("company_id",t);if(a)throw a;return r||[]}catch(r){return console.error("Error fetching notification preferences:",r),[]}},async updateNotificationPreference(e,t,r,a){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{error:s}=await ne.from("notification_preferences").upsert({user_id:e,company_id:t,notification_type_id:r,email_enabled:a.email_enabled,in_app_enabled:a.in_app_enabled,sms_enabled:a.sms_enabled||!1,updated_at:new Date().toISOString()});if(s)throw s;return{success:!0}}catch(s){return console.error("Error updating notification preference:",s),{success:!1,error:s.message}}},async createNotification(e,t,r,a,s,l,c){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{data:u}=await ne.from("notification_types").select("id").eq("type_key",t).single();if(!u)throw new Error(`Notification type ${t} not found`);const{data:h,error:m}=await ne.from("notifications").insert({company_id:e,notification_type_id:u.id,user_id:r,title:a,message:s,link_url:l,metadata:c||{}}).select().single();if(m)throw m;return{success:!0,data:h}}catch(u){return console.error("Error creating notification:",u),{success:!1,error:u.message}}},async getUnreadNotifications(e,t=50){if(!ye)return[];try{const{data:r,error:a}=await ne.from("notifications").select(`
          *,
          notification_types (type_name, category)
        `).eq("user_id",e).eq("in_app_read",!1).order("created_at",{ascending:!1}).limit(t);if(a)throw a;return r||[]}catch(r){return console.error("Error fetching unread notifications:",r),[]}},async markNotificationRead(e){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{error:t}=await ne.from("notifications").update({in_app_read:!0,in_app_read_at:new Date().toISOString()}).eq("id",e);if(t)throw t;return{success:!0}}catch(t){return console.error("Error marking notification as read:",t),{success:!1,error:t.message}}},async markAllNotificationsRead(e){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{error:t}=await ne.from("notifications").update({in_app_read:!0,in_app_read_at:new Date().toISOString()}).eq("user_id",e).eq("in_app_read",!1);if(t)throw t;return{success:!0}}catch(t){return console.error("Error marking all notifications as read:",t),{success:!1,error:t.message}}},async getUsersForNotification(e,t,r){if(!ye)return[];try{const{data:a}=await ne.from("notification_roles").select("id").eq("company_id",e).eq("role_key",r).single();if(!a)return[];const{data:s}=await ne.from("user_notification_roles").select(`
          user_id,
          users (id, email, name)
        `).eq("role_id",a.id);if(!s)return[];const{data:l}=await ne.from("notification_types").select("id").eq("type_key",t).single();return l?(await Promise.all(s.map(async u=>{const{data:h}=await ne.from("notification_preferences").select("email_enabled, in_app_enabled").eq("user_id",u.user_id).eq("company_id",e).eq("notification_type_id",l.id).single();return!h||h.email_enabled||h.in_app_enabled?u.users:null}))).filter(u=>u!==null):s.map(u=>u.users)}catch(a){return console.error("Error getting users for notification:",a),[]}},async getExternalRecipientsByRole(e){if(!ye)return[];try{const{data:t,error:r}=await ne.from("external_notification_recipients").select("*").eq("role_id",e).order("email");if(r)throw r;return t||[]}catch(t){return console.error("Error fetching external recipients:",t),[]}},async addExternalRecipient(e,t,r,a,s){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{data:l,error:c}=await ne.from("external_notification_recipients").insert({role_id:e,email:t.toLowerCase().trim(),name:r?.trim()||null,notes:a?.trim()||null,created_by:s}).select().single();if(c)throw c;return{success:!0,data:l}}catch(l){return console.error("Error adding external recipient:",l),{success:!1,error:l.message}}},async removeExternalRecipient(e){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{error:t}=await ne.from("external_notification_recipients").delete().eq("id",e);if(t)throw t;return{success:!0}}catch(t){return console.error("Error removing external recipient:",t),{success:!1,error:t.message}}},async getAllRecipientsForNotification(e,t,r){if(!ye)return{users:[],externalEmails:[]};try{const{data:a}=await ne.from("notification_roles").select("id").eq("company_id",e).eq("role_key",r).single();if(!a)return{users:[],externalEmails:[]};const s=await this.getUsersForNotification(e,t,r),{data:l}=await ne.from("external_notification_recipients").select("email, name").eq("role_id",a.id),c=l?.map(u=>({email:u.email,name:u.name||u.email}))||[];return{users:s,externalEmails:c}}catch(a){return console.error("Error getting all recipients:",a),{users:[],externalEmails:[]}}},async getProjectTeam(e){if(!ye)return[];try{const{data:t,error:r}=await ne.from("project_users").select(`
          id,
          project_id,
          user_id,
          project_role,
          joined_at,
          invited_by,
          users:user_id (
            id,
            name,
            email,
            role
          )
        `).eq("project_id",e).order("joined_at");if(r)throw r;return t||[]}catch(t){return console.error("Error fetching project team:",t),[]}},async getUserProjectRole(e,t){if(!ye)return null;try{const{data:r,error:a}=await ne.from("project_users").select("project_role").eq("user_id",e).eq("project_id",t).single();if(a)throw a;return r?.project_role||null}catch(r){return console.error("Error fetching user project role:",r),null}},async getUserProjects(e){if(!ye)return[];try{const{data:t,error:r}=await ne.from("project_users").select(`
          id,
          project_role,
          joined_at,
          projects:project_id (
            id,
            name,
            location,
            status,
            created_at,
            companies:company_id (
              id,
              name
            )
          )
        `).eq("user_id",e).order("joined_at",{ascending:!1});if(r)throw r;return t||[]}catch(t){return console.error("Error fetching user projects:",t),[]}},async inviteUserToProject(e,t,r,a){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{data:s,error:l}=await ne.from("project_users").insert({project_id:e,user_id:t,project_role:r,invited_by:a}).select().single();if(l)throw l;return{success:!0,data:s}}catch(s){return console.error("Error inviting user to project:",s),{success:!1,error:s.message}}},async removeUserFromProject(e){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{error:t}=await ne.from("project_users").delete().eq("id",e);if(t)throw t;return{success:!0}}catch(t){return console.error("Error removing user from project:",t),{success:!1,error:t.message}}},async updateUserProjectRole(e,t){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{data:r,error:a}=await ne.from("project_users").update({project_role:t}).eq("id",e).select().single();if(a)throw a;return{success:!0,data:r}}catch(r){return console.error("Error updating user project role:",r),{success:!1,error:r.message}}},async getUserProjectPermissions(e,t){if(!ye)return[];try{const{data:r,error:a}=await ne.from("project_users").select(`
          id,
          project_role,
          project_user_permissions (
            permission_key
          )
        `).eq("user_id",e).eq("project_id",t).single();if(a)throw a;return r?.project_role==="owner"||r?.project_role==="manager"?["*"]:r?.project_user_permissions?.map(s=>s.permission_key)||[]}catch(r){return console.error("Error fetching user project permissions:",r),[]}},async userHasProjectPermission(e,t,r){if(!ye)return!1;try{const a=await this.getUserProjectPermissions(e,t);return a.includes("*")?!0:a.includes(r)}catch(a){return console.error("Error checking permission:",a),!1}},async grantProjectPermissions(e,t,r){if(!ye)return{success:!1,error:"Supabase not configured"};try{const a=t.map(c=>({project_user_id:e,permission_key:c,granted_by:r})),{data:s,error:l}=await ne.from("project_user_permissions").insert(a).select();if(l)throw l;return{success:!0,data:s}}catch(a){return console.error("Error granting permissions:",a),{success:!1,error:a.message}}},async revokeProjectPermissions(e,t){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{error:r}=await ne.from("project_user_permissions").delete().eq("project_user_id",e).in("permission_key",t);if(r)throw r;return{success:!0}}catch(r){return console.error("Error revoking permissions:",r),{success:!1,error:r.message}}},async setProjectPermissions(e,t,r){if(!ye)return{success:!1,error:"Supabase not configured"};try{if(await ne.from("project_user_permissions").delete().eq("project_user_id",e),t.length>0){const a=t.map(c=>({project_user_id:e,permission_key:c,granted_by:r})),{data:s,error:l}=await ne.from("project_user_permissions").insert(a).select();if(l)throw l;return{success:!0,data:s}}return{success:!0}}catch(a){return console.error("Error setting permissions:",a),{success:!1,error:a.message}}},async getAllPermissions(){if(!ye)return[];try{const{data:e,error:t}=await ne.from("project_permissions").select("*").order("category, permission_name");if(t)throw t;return e||[]}catch(e){return console.error("Error fetching permissions:",e),[]}},async getRoleTemplates(){if(!ye)return[];try{const{data:e,error:t}=await ne.from("role_templates").select("*").order("role_name");if(t)throw t;return e||[]}catch(e){return console.error("Error fetching role templates:",e),[]}},async getRoleTemplate(e){if(!ye)return null;try{const{data:t,error:r}=await ne.from("role_templates").select("*").eq("role_key",e).single();if(r)throw r;return t}catch(t){return console.error("Error fetching role template:",t),null}},async getProjectNotificationRoles(e){if(!ye)return[];try{const{data:t,error:r}=await ne.from("notification_roles").select("*").eq("project_id",e).order("role_name");if(r)throw r;return t||[]}catch(t){return console.error("Error fetching project notification roles:",t),[]}},async createProjectNotificationRole(e,t,r,a){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{data:s,error:l}=await ne.from("notification_roles").insert({project_id:e,role_name:t,role_key:r,description:a}).select().single();if(l)throw l;return{success:!0,data:s}}catch(s){return console.error("Error creating project notification role:",s),{success:!1,error:s.message}}},async verifyCompanyOfficePin(e,t){if(!ye)return null;try{const{data:r,error:a}=await ne.from("companies").select("id, name, field_code").ilike("name",e).eq("office_pin",t).single();if(a)throw a;return r}catch(r){return console.error("Error verifying company office PIN:",r),null}},async verifyFieldAccess(e,t){if(!ye)return null;try{const{data:r,error:a}=await ne.from("projects").select(`
          id,
          name,
          company_id,
          companies (
            id,
            name
          )
        `).eq("companies.field_code",e).eq("pin",t).single();if(a)throw a;return{project_id:r.id,project_name:r.name,company_id:r.companies.id,company_name:r.companies.name}}catch(r){return console.error("Error verifying field access:",r),null}},async createOfficeUser({company_id:e,name:t,email:r,password:a,role:s}){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{data:l,error:c}=await ne.auth.signUp({email:r,password:a,options:{data:{name:t,role:s}}});if(c)throw c;const{data:u,error:h}=await ne.from("users").insert({id:l.user.id,company_id:e,name:t,email:r,role:s}).select().single();if(h)throw h;if(Xu.length>0){const m=Xu.map(v=>({user_id:l.user.id,company_id:v.id,role:s||"user"})),{error:p}=await ne.from("user_companies").insert(m);p&&console.warn("Could not add user to user_companies:",p)}return{success:!0,data:u}}catch(l){return console.error("Error creating office user:",l),{success:!1,error:l.message}}},async logFieldAccess({company_id:e,project_id:t,foreman_name:r,company_code_used:a,project_pin_used:s}){if(!ye)return{success:!1};try{const{error:l}=await ne.from("field_access_log").insert({company_id:e,project_id:t,foreman_name:r,company_code_used:a,project_pin_used:s});if(l)throw l;return{success:!0}}catch(l){return console.error("Error logging field access:",l),{success:!1,error:l.message}}},async logFieldActivity({project_id:e,foreman_name:t,activity_type:r,activity_id:a,description:s}){if(!ye)return{success:!1};try{const{error:l}=await ne.from("field_activity_log").insert({project_id:e,foreman_name:t,activity_type:r,activity_id:a,description:s});if(l)throw l;return{success:!0}}catch(l){return console.error("Error logging field activity:",l),{success:!1,error:l.message}}},async getFieldAccessHistory(e,t=50){if(!ye)return[];try{const{data:r,error:a}=await ne.from("field_access_log").select("*").eq("project_id",e).order("accessed_at",{ascending:!1}).limit(t);if(a)throw a;return r||[]}catch(r){return console.error("Error fetching field access history:",r),[]}},async getFieldActivityHistory(e,t=100){if(!ye)return[];try{const{data:r,error:a}=await ne.from("field_activity_log").select("*").eq("project_id",e).order("created_at",{ascending:!1}).limit(t);if(a)throw a;return r||[]}catch(r){return console.error("Error fetching field activity history:",r),[]}},async createCompanyWithAdmin({company_name:e,field_code:t,office_pin:r,admin_name:a,admin_email:s,admin_password:l}){if(!ye)return{success:!1,error:"Supabase not configured"};try{const{data:c}=await ne.from("companies").select("id").eq("field_code",t).single();if(c)return{success:!1,error:"Field code already in use. Please choose another."};const{data:u}=await ne.from("companies").select("id").eq("office_pin",r).single();if(u)return{success:!1,error:"Office PIN already in use. Please generate a new one."};const{data:h,error:m}=await ne.from("companies").insert({name:e,field_code:t,office_pin:r}).select().single();if(m)throw m;const{data:p,error:v}=await ne.auth.signUp({email:s,password:l,options:{data:{name:a,role:"admin"}}});if(v)throw await ne.from("companies").delete().eq("id",h.id),v;const{error:_}=await ne.from("users").insert({id:p.user.id,company_id:h.id,name:a,email:s,role:"admin"});if(_)throw await ne.from("companies").delete().eq("id",h.id),_;if(Xu.length>0){const y=Xu.map(w=>({user_id:p.user.id,company_id:w.id,role:"admin"})),{error:b}=await ne.from("user_companies").insert(y);b&&console.warn("Could not add admin to user_companies:",b)}return{success:!0,company:h,admin:p.user}}catch(c){return console.error("Error creating company with admin:",c),{success:!1,error:c.message}}}},Fy=J.createContext(),qa={logo_url:null,favicon_url:null,login_background_url:null,primary_color:"#3B82F6",secondary_color:"#1E40AF",custom_app_name:"FieldSync",hide_fieldsync_branding:!1,email_from_name:"FieldSync",email_from_address:null,custom_domain:null,domain_verified:!1};function Ic({children:e,companyId:t}){const[r,a]=J.useState(qa),[s,l]=J.useState(!0);J.useEffect(()=>{t?c(t):u()},[t]),J.useEffect(()=>{p(r)},[r]);const c=async y=>{try{if(l(!0),!ye){a(qa),l(!1);return}const{data:b,error:w}=await ne.from("company_branding").select("*").eq("company_id",y).single();w?(w.code==="PGRST116"?await h(y):console.error("Error loading branding:",w),a(qa)):a({...qa,...b})}catch(b){console.error("Error in loadBranding:",b),a(qa)}finally{l(!1)}},u=async()=>{try{l(!0);const y=window.location.hostname;if(y==="localhost"||y==="127.0.0.1"){a(qa),l(!1);return}if(!ye){a(qa),l(!1);return}const{data:b,error:w}=await ne.rpc("get_branding_by_domain",{domain_name:y});w||!b||b.length===0?a(qa):a({...qa,...b[0]})}catch(y){console.error("Error loading branding by domain:",y),a(qa)}finally{l(!1)}},h=async y=>{try{const{data:b,error:w}=await ne.from("company_branding").insert({company_id:y,...qa}).select().single();w&&console.error("Error creating default branding:",w)}catch(b){console.error("Error in createDefaultBranding:",b)}},m=async y=>{try{if(!ye)return a(E=>({...E,...y})),{success:!0};if(!t)return{success:!1,error:"No company ID"};const{data:b,error:w}=await ne.from("company_branding").update(y).eq("company_id",t).select().single();return w?(console.error("Error updating branding:",w),{success:!1,error:w.message}):(a({...qa,...b}),{success:!0,data:b})}catch(b){return console.error("Error in updateBranding:",b),{success:!1,error:b.message}}},p=y=>{const b=document.documentElement;if(b.style.setProperty("--primary-color",y.primary_color),b.style.setProperty("--secondary-color",y.secondary_color),y.favicon_url){let w=document.querySelector("link[rel*='icon']");w||(w=document.createElement("link"),w.rel="icon",document.head.appendChild(w)),w.href=y.favicon_url}document.title=y.custom_app_name||"FieldSync"},_={branding:r,loading:s,updateBranding:m,uploadBrandingImage:async(y,b)=>{try{if(!ye)return{success:!0,url:URL.createObjectURL(y)};const w=y.name.split(".").pop(),k=`branding/${`${t}/${b}-${Date.now()}.${w}`}`,{data:A,error:S}=await ne.storage.from("public").upload(k,y,{cacheControl:"3600",upsert:!0});if(S)return console.error("Error uploading image:",S),{success:!1,error:S.message};const{data:{publicUrl:j}}=ne.storage.from("public").getPublicUrl(k);return{success:!0,url:j}}catch(w){return console.error("Error in uploadBrandingImage:",w),{success:!1,error:w.message}}},refreshBranding:()=>t?c(t):u()};return f.jsx(Fy.Provider,{value:_,children:e})}function dm(){const e=J.useContext(Fy);if(!e)throw new Error("useBranding must be used within a BrandingProvider");return e}function Os({className:e="",showPoweredBy:t=!1}){const{branding:r}=dm();return f.jsxs("div",{className:`app-logo ${e}`,children:[r.logo_url?f.jsx("img",{src:r.logo_url,alt:r.custom_app_name||"Logo",className:"custom-logo"}):f.jsx("div",{className:"logo",children:r.custom_app_name?r.custom_app_name:f.jsxs(f.Fragment,{children:["Field",f.jsx("span",{children:"Sync"})]})}),t&&!r.hide_fieldsync_branding&&f.jsx("div",{className:"powered-by",children:"Powered by FieldSync"})]})}function zk({onComplete:e,onShowToast:t}){const[r,a]=J.useState(!1),[s,l]=J.useState(""),[c,u]=J.useState(""),[h,m]=J.useState(""),[p,v]=J.useState(""),[_,y]=J.useState(""),[b,w]=J.useState(""),E=()=>{const S=s.toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,10);u(S)},k=()=>{const S=Math.floor(1e3+Math.random()*9e3).toString();m(S)},A=async S=>{S.preventDefault(),a(!0);try{if(!c||!h){t?.("Please generate access codes","error"),a(!1);return}const j=await Ge.createCompanyWithAdmin({company_name:s.trim(),field_code:c.trim().toUpperCase(),office_pin:h.trim(),admin_name:p.trim(),admin_email:_.trim().toLowerCase(),admin_password:b});j.success?(t?.("Company registered successfully! Check your email for details.","success"),e?.({company:j.company,codes:{field_code:c,office_pin:h}})):t?.(j.error||"Failed to register company","error")}catch(j){console.error("Error registering company:",j),t?.("Failed to register company","error")}finally{a(!1)}};return f.jsx("div",{className:"login-container",children:f.jsxs("div",{className:"login-card registration-card",children:[f.jsxs("div",{className:"login-header",children:[f.jsx("h1",{children:"FieldSync"}),f.jsx("h2",{children:"Register Your Company"}),f.jsx("p",{children:"Set up your company and create your admin account"})]}),f.jsxs("form",{onSubmit:A,className:"login-form",children:[f.jsxs("div",{className:"form-section",children:[f.jsx("h3",{children:"Company Information"}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Company Name *"}),f.jsx("input",{type:"text",value:s,onChange:S=>l(S.target.value),placeholder:"e.g., GGG Construction",required:!0,disabled:r,autoFocus:!0})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Field Code *"}),f.jsxs("div",{className:"input-with-button",children:[f.jsx("input",{type:"text",value:c,onChange:S=>u(S.target.value.toUpperCase()),placeholder:"e.g., GGG2024",required:!0,disabled:r,style:{textTransform:"uppercase"}}),f.jsx("button",{type:"button",onClick:E,className:"btn-secondary",disabled:r||!s,children:"Auto-Generate"})]}),f.jsx("small",{children:"Your foremen will use this code to access projects"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Office PIN *"}),f.jsxs("div",{className:"input-with-button",children:[f.jsx("input",{type:"text",value:h,onChange:S=>m(S.target.value),placeholder:"e.g., 8765",maxLength:6,required:!0,disabled:r}),f.jsx("button",{type:"button",onClick:k,className:"btn-secondary",disabled:r,children:"Generate"})]}),f.jsx("small",{children:"Office staff will need this PIN to create accounts"})]})]}),f.jsxs("div",{className:"form-section",children:[f.jsx("h3",{children:"Your Admin Account"}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Your Name *"}),f.jsx("input",{type:"text",value:p,onChange:S=>v(S.target.value),placeholder:"John Smith",required:!0,disabled:r})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Email *"}),f.jsx("input",{type:"email",value:_,onChange:S=>y(S.target.value),placeholder:"john@company.com",required:!0,disabled:r})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Password *"}),f.jsx("input",{type:"password",value:b,onChange:S=>w(S.target.value),placeholder:"",minLength:6,required:!0,disabled:r}),f.jsx("small",{children:"At least 6 characters"})]})]}),f.jsx("button",{type:"submit",className:"btn-primary btn-block",disabled:r,children:r?"Creating Company...":"Create Company"})]}),f.jsx("div",{className:"login-footer",children:f.jsxs("p",{children:["Already have an account? ",f.jsx("a",{href:"/",children:"Sign in"})]})})]})})}function Hk({company:e,codes:t,onContinue:r}){const[a,s]=J.useState(!1),l=()=>{const c=`
FieldSync Access Codes for ${e.name}

Field Code (for foremen): ${t.field_code}
Office PIN (for office staff): ${t.office_pin}

Keep these codes secure!
    `.trim();navigator.clipboard.writeText(c),s(!0),setTimeout(()=>s(!1),2e3)};return f.jsx("div",{className:"login-container",children:f.jsxs("div",{className:"login-card success-card",children:[f.jsx("div",{className:"success-icon",children:""}),f.jsx("h1",{children:"Company Registered!"}),f.jsx("h2",{children:e.name}),f.jsxs("div",{className:"codes-display",children:[f.jsxs("div",{className:"code-box",children:[f.jsx("h3",{children:" Field Code"}),f.jsx("div",{className:"code",children:t.field_code}),f.jsx("small",{children:"Give this to your foremen"})]}),f.jsxs("div",{className:"code-box",children:[f.jsx("h3",{children:" Office PIN"}),f.jsx("div",{className:"code",children:t.office_pin}),f.jsx("small",{children:"Share this with office staff"})]})]}),f.jsxs("div",{className:"success-actions",children:[f.jsx("button",{onClick:l,className:"btn-secondary",children:a?" Copied!":"Copy Codes"}),f.jsx("button",{onClick:r,className:"btn-primary",children:"Continue to Dashboard"})]}),f.jsxs("div",{className:"success-message",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Important:"})," Save these codes! You'll need them to:"]}),f.jsxs("ul",{children:[f.jsx("li",{children:"Give Field Code to foremen for project access"}),f.jsx("li",{children:"Share Office PIN with office staff to create accounts"})]}),f.jsx("p",{children:"You can change these codes anytime in Company Settings."})]})]})})}function qk({onLogin:e,onShowToast:t}){const[r,a]=J.useState(""),[s,l]=J.useState(""),[c,u]=J.useState(!1),h=async m=>{m.preventDefault(),u(!0);try{console.log("Attempting login for:",r);const{data:p,error:v}=await ne.auth.signInWithPassword({email:r.trim(),password:s});if(v){console.error("Auth error:",v),t?.(v.message||"Login failed","error"),u(!1);return}console.log("Auth successful, user ID:",p.user.id);const{data:_,error:y}=await ne.from("users").select("*").eq("id",p.user.id).single();if(y||!_){console.error("User error:",y),t?.("User profile not found","error"),u(!1);return}console.log("User found:",_);const{data:b,error:w}=await ne.from("companies").select("*").eq("id",_.company_id).single();if(w||!b){console.error("Company error:",w),t?.("Company not found","error"),u(!1);return}console.log("Company found:",b.name),e?.(_,b),t?.(`Welcome to ${b.name}!`,"success")}catch(p){console.error("Login exception:",p),t?.("Login failed - check console","error")}finally{u(!1)}};return f.jsx("div",{className:"login-container",children:f.jsxs("div",{className:"login-card",children:[f.jsxs("div",{className:"login-header",children:[f.jsx("h1",{children:"FieldSync"}),f.jsx("h2",{children:"Office Login"})]}),f.jsxs("form",{onSubmit:h,className:"login-form",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Email"}),f.jsx("input",{type:"email",value:r,onChange:m=>a(m.target.value),placeholder:"your@email.com",required:!0,autoFocus:!0,disabled:c})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Password"}),f.jsx("input",{type:"password",value:s,onChange:m=>l(m.target.value),placeholder:"",required:!0,disabled:c})]}),f.jsx("button",{type:"submit",className:"btn-primary btn-block",disabled:c,children:c?"Signing in...":"Sign In"})]}),f.jsx("div",{className:"login-footer",children:f.jsx("p",{children:f.jsxs("small",{children:["Field worker? ",f.jsx("a",{href:"/field",children:"Enter here"})]})})})]})})}function Vk({onForemanAccess:e,onOfficeLogin:t,onShowToast:r}){const[a,s]=J.useState(null),[l,c]=J.useState(null),[u,h]=J.useState(""),[m,p]=J.useState(null),[v,_]=J.useState(""),[y,b]=J.useState(!1),[w,E]=J.useState(1),[k,A]=J.useState(null),[S,j]=J.useState(""),[F,R]=J.useState(""),[N,X]=J.useState(""),G=K=>{const Te=K.toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,20);h(Te)},se=async()=>{if(u.length<2){r("Enter company code","error");return}b(!0);try{const K=await Ge.getCompanyByCode(u);K?p(K):(r("Invalid company code","error"),h(""))}catch{r("Error checking code","error")}finally{b(!1)}},te=async K=>{if(K.length===4){b(!0);try{const Te=await Ge.getProjectByPinAndCompany(K,m.id);Te?e(Te):(r("Invalid PIN","error"),_(""))}catch{r("Error checking PIN","error")}finally{b(!1)}}},z=K=>{if(v.length<4){const Te=v+K;_(Te),Te.length===4&&setTimeout(()=>te(Te),200)}},ge=()=>{_(K=>K.slice(0,-1))},Oe=()=>{p(null),_("")},Ce=async()=>{if(u.length<2){r("Enter company code","error");return}b(!0);try{const K=await Ge.getCompanyByCode(u);K?(A(K),E(2)):(r("Invalid company code","error"),h(""))}catch{r("Error checking code","error")}finally{b(!1)}},Q=async()=>{if(!S.trim()){r("Enter your name","error");return}if(!F.trim()||!F.includes("@")){r("Enter valid email","error");return}if(N.length<6){r("Password must be 6+ characters","error");return}b(!0);try{const{data:K}=await ne.from("users").select("*").eq("email",F).single();if(K){const{data:L}=await ne.from("user_companies").select("*").eq("user_id",K.id).eq("company_id",k.id).single();if(L){r("You already belong to this company! Just sign in.","error"),s("office");return}const{error:Z}=await ne.from("user_companies").insert({user_id:K.id,company_id:k.id,role:"member"});if(Z)throw Z;r(`Added to ${k.name}! Sign in to continue.`,"success"),s("office");return}const{data:Te,error:q}=await ne.auth.signUp({email:F,password:N});if(q)throw q;const C=Te.user?.id;if(!C)throw new Error("Failed to create user");const{error:H}=await ne.from("users").insert({id:C,email:F,password_hash:"managed_by_supabase_auth",name:S.trim(),company_id:k.id,role:"member",is_active:!0});if(H)throw H;const{error:I}=await ne.from("user_companies").insert({user_id:C,company_id:k.id,role:"member"});if(I)throw I;r("Account created! Logging you in...","success"),setTimeout(()=>{window.location.reload()},1e3)}catch(K){console.error("Join error:",K),r(K.message||"Error creating account","error")}finally{b(!1)}},le=K=>{c(K),s("registration-success")},Ee=()=>{s("office"),r("Please sign in with your new account","info")};if(a===null)return f.jsx("div",{className:"entry-container",children:f.jsxs("div",{className:"entry-card",children:[f.jsx(Os,{className:"entry-logo",showPoweredBy:!1}),f.jsxs("div",{className:"entry-buttons",children:[f.jsxs("button",{className:"entry-mode-btn foreman",onClick:()=>s("foreman"),children:[f.jsx("span",{className:"entry-mode-icon",children:""}),f.jsx("span",{className:"entry-mode-title",children:"Foreman"}),f.jsx("span",{className:"entry-mode-desc",children:"Enter project PIN"})]}),f.jsxs("button",{className:"entry-mode-btn office",onClick:()=>s("office"),children:[f.jsx("span",{className:"entry-mode-icon",children:""}),f.jsx("span",{className:"entry-mode-title",children:"Office"}),f.jsx("span",{className:"entry-mode-desc",children:"Sign in to dashboard"})]})]}),f.jsxs("div",{className:"entry-footer",children:[f.jsx("p",{className:"entry-footer-text",children:"New company?"}),f.jsx("button",{className:"entry-register-link",onClick:()=>s("register"),children:"Register here"})]})]})});if(a==="foreman")return m?f.jsx("div",{className:"entry-container",children:f.jsxs("div",{className:"entry-card",children:[f.jsx("button",{className:"entry-back",onClick:Oe,children:""}),f.jsx(Os,{className:"entry-logo",showPoweredBy:!1}),f.jsx("div",{className:"entry-company-badge",children:m.name}),f.jsx("p",{className:"entry-subtitle",children:"Enter project PIN"}),f.jsx("div",{className:"pin-display",children:[0,1,2,3].map(K=>f.jsx("div",{className:`pin-dot ${v.length>K?"filled":""}`,children:v.length>K?"":""},K))}),f.jsxs("div",{className:"number-pad",children:[[1,2,3,4,5,6,7,8,9].map(K=>f.jsx("button",{className:"num-btn",onClick:()=>z(K.toString()),disabled:y,children:K},K)),f.jsx("button",{className:"num-btn empty",disabled:!0}),f.jsx("button",{className:"num-btn",onClick:()=>z("0"),disabled:y,children:"0"}),f.jsx("button",{className:"num-btn backspace",onClick:ge,disabled:y||v.length===0,children:""})]}),y&&f.jsx("div",{className:"entry-loading",children:f.jsx("div",{className:"spinner"})})]})}):f.jsx("div",{className:"entry-container",children:f.jsxs("div",{className:"entry-card",children:[f.jsx("button",{className:"entry-back",onClick:()=>s(null),children:""}),f.jsx(Os,{className:"entry-logo",showPoweredBy:!1}),f.jsx("p",{className:"entry-subtitle",children:"Enter company code"}),f.jsxs("div",{className:"entry-input-group",children:[f.jsx("input",{type:"text",value:u,onChange:K=>G(K.target.value),placeholder:"Company Code",disabled:y,autoFocus:!0,onKeyDown:K=>{K.key==="Enter"&&se()}}),f.jsx("button",{className:"entry-submit-btn",onClick:se,disabled:y||u.length<2,children:y?"...":""})]})]})});if(a==="office")return f.jsxs(f.Fragment,{children:[f.jsx("button",{className:"entry-back-fixed",onClick:()=>s(null),style:{position:"fixed",top:"2rem",left:"2rem",background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"8px",padding:"0.5rem 1rem",cursor:"pointer",fontSize:"1rem",zIndex:1e3},children:" Back"}),f.jsx(qk,{onLogin:t,onShowToast:r})]});if(a==="register")return f.jsxs(f.Fragment,{children:[f.jsx("button",{className:"entry-back-fixed",onClick:()=>s(null),style:{position:"fixed",top:"2rem",left:"2rem",background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"8px",padding:"0.5rem 1rem",cursor:"pointer",fontSize:"1rem",zIndex:1e3},children:" Back"}),f.jsx(zk,{onComplete:le,onShowToast:r})]});if(a==="registration-success"&&l)return f.jsx(Hk,{company:l.company,codes:l.codes,onContinue:Ee});if(a==="join")return w===1?f.jsx("div",{className:"entry-container",children:f.jsxs("div",{className:"entry-card",children:[f.jsx("button",{className:"entry-back",onClick:()=>s("office"),children:""}),f.jsx(Os,{className:"entry-logo",showPoweredBy:!1}),f.jsx("p",{className:"entry-subtitle",children:"Enter your company code"}),f.jsx("p",{className:"entry-hint",children:"Ask your manager or admin for the code"}),f.jsxs("div",{className:"entry-input-group",children:[f.jsx("input",{type:"text",value:u,onChange:K=>G(K.target.value),placeholder:"Company Code",disabled:y,autoFocus:!0,onKeyDown:K=>{K.key==="Enter"&&Ce()}}),f.jsx("button",{className:"entry-submit-btn",onClick:Ce,disabled:y||u.length<2,children:y?"...":""})]})]})}):f.jsx("div",{className:"entry-container",children:f.jsxs("div",{className:"entry-card",children:[f.jsx("button",{className:"entry-back",onClick:()=>{E(1),A(null)},children:""}),f.jsx(Os,{className:"entry-logo",showPoweredBy:!1}),f.jsx("div",{className:"entry-company-badge",children:k?.name}),f.jsx("p",{className:"entry-subtitle",children:"Create your account"}),f.jsxs("div",{className:"entry-form",children:[f.jsx("input",{type:"text",value:S,onChange:K=>j(K.target.value),placeholder:"Your Name",autoFocus:!0}),f.jsx("input",{type:"email",value:F,onChange:K=>R(K.target.value),placeholder:"Email"}),f.jsx("input",{type:"password",value:N,onChange:K=>X(K.target.value),placeholder:"Password (6+ characters)",onKeyDown:K=>{K.key==="Enter"&&Q()}}),f.jsx("button",{className:"entry-login-btn",onClick:Q,disabled:y,children:y?"Creating...":"Join Company"})]}),f.jsx("p",{className:"entry-join-note",children:"You'll join as a team member. Your admin can update your role."})]})})}function _l(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function My(e){if(!e||e.length===0)return 0;let t=0;return e.forEach(r=>{r.status==="done"&&(t+=r.weight)}),Math.round(t)}function Gk(e){return e==="not_started"?"Not Started":e==="working"?"Working":e==="done"?"Done":e}const v1=["Containment","PPE","Disposal","Equipment"];function $k({project:e,companyId:t,maxPhotos:r=3,onSubmit:a,onCancel:s,onShowToast:l}){const[c,u]=J.useState(1),[h,m]=J.useState(new Date().toISOString().split("T")[0]),[p,v]=J.useState(""),[_,y]=J.useState(""),[b,w]=J.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}]),[E,k]=J.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}]),[A,S]=J.useState([]),[j,F]=J.useState(""),[R,N]=J.useState([]),[X,G]=J.useState(!1),[se,te]=J.useState([]),[z,ge]=J.useState(!1),[Oe,Ce]=J.useState(null),[Q,le]=J.useState([]),[Ee,K]=J.useState(!1),[Te,q]=J.useState(!1),[C,H]=J.useState({name:"",category:"",quantity:""});J.useEffect(()=>{I()},[e.id]);const I=async()=>{try{const ie=await Ge.getCrewCheckin(e.id);ie?.workers&&te(ie.workers)}catch(ie){console.error("Error loading crew:",ie)}};J.useEffect(()=>{Oe&&t&&L(Oe)},[Oe,t]);const L=async ie=>{K(!0);try{const De=await Ge.getMaterialsEquipmentByCategory(t,ie);le(De)}catch(De){console.error("Error loading items:",De),l("Error loading items","error")}finally{K(!1)}},Z=()=>{w([...b,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}])},re=(ie,De,Me)=>{w(b.map((We,ot)=>ot===ie?{...We,[De]:Me}:We))},de=ie=>{b.length>1?w(b.filter((De,Me)=>Me!==ie)):w([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}])},ve=()=>{k([...E,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},Se=(ie,De,Me)=>{k(E.map((We,ot)=>ot===ie?{...We,[De]:Me}:We))},xe=ie=>{E.length>1?k(E.filter((De,Me)=>Me!==ie)):k([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},U=ie=>{const De=A.findIndex(Me=>Me.material_equipment_id===ie.id);De>=0?S(A.map((Me,We)=>We===De?{...Me,quantity:Me.quantity+1}:Me)):S([...A,{material_equipment_id:ie.id,name:ie.name,unit:ie.unit,category:ie.category,quantity:1,isCustom:!1}]),l(`Added ${ie.name}`,"success")},Ze=()=>{if(!C.name||!C.category||!C.quantity){l("Fill in all fields","error");return}S([...A,{material_equipment_id:null,custom_name:C.name,custom_category:C.category,name:C.name,category:C.category,quantity:parseFloat(C.quantity),unit:"each",isCustom:!0}]),H({name:"",category:"",quantity:""}),q(!1),Ce(null),l("Custom item added","success")},Ie=(ie,De)=>{const Me=parseFloat(De)||0;Me<=0?_e(ie):S(A.map((We,ot)=>ot===ie?{...We,quantity:Me}:We))},_e=ie=>{S(A.filter((De,Me)=>Me!==ie))},Le=ie=>{const De=Array.from(ie.target.files);if(De.length===0)return;const Me=r===-1?1/0:r-R.length;if(Me<=0){l(`Photo limit reached (${r} max)`,"error"),ie.target.value="";return}const We=De.slice(0,Me);We.length<De.length&&l(`Only ${We.length} photo(s) added (${r} max)`,"error"),We.forEach(ot=>{if(!ot.type.startsWith("image/")){l("Please select an image file","error");return}const mt=URL.createObjectURL(ot);N(St=>[...St,{id:Date.now()+Math.random(),file:ot,previewUrl:mt,name:ot.name}])}),ie.target.value=""},be=ie=>{const De=R.find(Me=>Me.id===ie);De?.previewUrl&&URL.revokeObjectURL(De.previewUrl),N(R.filter(Me=>Me.id!==ie))},it=()=>{if(c===1){const ie=b.some(Me=>Me.name.trim()&&(parseFloat(Me.hours)>0||parseFloat(Me.overtimeHours)>0)),De=E.some(Me=>Me.name.trim()&&(parseFloat(Me.hours)>0||parseFloat(Me.overtimeHours)>0));return ie||De}return!0},kt=()=>{c<3&&u(c+1)},ht=()=>{Oe?(Ce(null),q(!1)):Te?q(!1):c>1?u(c-1):s()},Et=async()=>{if(!_.trim()){l("Enter your name to submit","error");return}const ie=b.filter(Me=>Me.name.trim()&&(parseFloat(Me.hours)>0||parseFloat(Me.overtimeHours)>0)),De=E.filter(Me=>Me.name.trim()&&(parseFloat(Me.hours)>0||parseFloat(Me.overtimeHours)>0));if(ie.length===0&&De.length===0){l("Add at least one worker","error");return}G(!0);try{const Me=await Ge.createTMTicket({project_id:e.id,work_date:h,ce_pco_number:p.trim()||null,notes:j.trim()||null,photos:[],created_by_name:_.trim()}),We=[];for(const mt of R)try{const St=await Ge.uploadPhoto(t,e.id,Me.id,mt.file);St&&We.push(St)}catch(St){console.error("Error uploading photo:",St)}We.length>0&&await Ge.updateTMTicketPhotos(Me.id,We);const ot=[...ie.map(mt=>({name:mt.name.trim(),hours:parseFloat(mt.hours)||0,overtime_hours:parseFloat(mt.overtimeHours)||0,time_started:mt.timeStarted||null,time_ended:mt.timeEnded||null,role:mt.role})),...De.map(mt=>({name:mt.name.trim(),hours:parseFloat(mt.hours)||0,overtime_hours:parseFloat(mt.overtimeHours)||0,time_started:mt.timeStarted||null,time_ended:mt.timeEnded||null,role:"Laborer"}))];await Ge.addTMWorkers(Me.id,ot),A.length>0&&await Ge.addTMItems(Me.id,A.map(mt=>({material_equipment_id:mt.material_equipment_id,custom_name:mt.custom_name||null,custom_category:mt.custom_category||null,quantity:mt.quantity}))),R.forEach(mt=>{mt.previewUrl&&URL.revokeObjectURL(mt.previewUrl)}),l("T&M submitted!","success"),a()}catch(Me){console.error("Error submitting T&M:",Me),l("Error submitting T&M","error")}finally{G(!1)}},Dr=b.filter(ie=>ie.name.trim()&&(parseFloat(ie.hours)>0||parseFloat(ie.overtimeHours)>0)),Ft=E.filter(ie=>ie.name.trim()&&(parseFloat(ie.hours)>0||parseFloat(ie.overtimeHours)>0)),At=Dr.length+Ft.length,jr=[...Dr,...Ft].reduce((ie,De)=>ie+parseFloat(De.hours||0),0),Fr=[...Dr,...Ft].reduce((ie,De)=>ie+parseFloat(De.overtimeHours||0),0);return A.reduce((ie,De)=>ie+De.quantity,0),c===2&&(Oe||Te)?f.jsxs("div",{className:"tm-wizard",children:[f.jsxs("div",{className:"tm-wizard-header",children:[f.jsx("button",{className:"tm-back-btn",onClick:ht,children:""}),f.jsx("h2",{children:Te?"Add Custom Item":Oe}),f.jsxs("div",{className:"tm-item-count",children:[A.length," items"]})]}),Te?f.jsxs("div",{className:"tm-custom-form",children:[f.jsxs("div",{className:"tm-field",children:[f.jsx("label",{children:"Item Name"}),f.jsx("input",{type:"text",placeholder:"What did you use?",value:C.name,onChange:ie=>H({...C,name:ie.target.value}),autoFocus:!0})]}),f.jsxs("div",{className:"tm-field",children:[f.jsx("label",{children:"Category"}),f.jsx("div",{className:"tm-category-select",children:v1.map(ie=>f.jsx("button",{className:`tm-cat-chip ${C.category===ie?"active":""}`,onClick:()=>H({...C,category:ie}),children:ie},ie))})]}),f.jsxs("div",{className:"tm-field",children:[f.jsx("label",{children:"Quantity"}),f.jsx("input",{type:"number",placeholder:"How many?",value:C.quantity,onChange:ie=>H({...C,quantity:ie.target.value})})]}),f.jsx("button",{className:"tm-big-btn primary",onClick:Ze,children:"Add Custom Item"})]}):f.jsx("div",{className:"tm-item-grid",children:Ee?f.jsx("div",{className:"tm-loading",children:"Loading..."}):f.jsxs(f.Fragment,{children:[Q.map(ie=>{const De=A.find(Me=>Me.material_equipment_id===ie.id);return f.jsxs("button",{className:`tm-item-card ${De?"added":""}`,onClick:()=>U(ie),children:[f.jsx("span",{className:"tm-item-name",children:ie.name}),f.jsx("span",{className:"tm-item-unit",children:ie.unit}),De&&f.jsx("span",{className:"tm-item-badge",children:De.quantity})]},ie.id)}),f.jsxs("button",{className:"tm-item-card custom",onClick:()=>q(!0),children:[f.jsx("span",{className:"tm-item-name",children:"+ Add Other"}),f.jsx("span",{className:"tm-item-unit",children:"Not on list"})]})]})}),!Te&&A.length>0&&f.jsx("div",{className:"tm-wizard-footer",children:f.jsxs("button",{className:"tm-big-btn primary",onClick:()=>Ce(null),children:["Done Adding (",A.length," items)"]})})]}):f.jsxs("div",{className:"tm-wizard",children:[f.jsxs("div",{className:"tm-wizard-header",children:[f.jsx("button",{className:"tm-back-btn",onClick:ht,children:""}),f.jsxs("h2",{children:[c===1&&"Workers",c===2&&"Materials & Equipment",c===3&&"Review"]}),f.jsxs("div",{className:"tm-step-dots",children:[f.jsx("span",{className:`tm-dot ${c>=1?"active":""}`}),f.jsx("span",{className:`tm-dot ${c>=2?"active":""}`}),f.jsx("span",{className:`tm-dot ${c>=3?"active":""}`})]})]}),c===1&&f.jsxs("div",{className:"tm-step-content",children:[f.jsxs("div",{className:"tm-project-info",children:[e.job_number&&f.jsxs("div",{className:"tm-project-detail",children:[f.jsx("span",{className:"tm-project-label",children:"Job #"}),f.jsx("span",{className:"tm-project-value",children:e.job_number})]}),f.jsxs("div",{className:"tm-project-detail",children:[f.jsx("span",{className:"tm-project-label",children:"Project"}),f.jsx("span",{className:"tm-project-value",children:e.name})]}),e.address&&f.jsxs("div",{className:"tm-project-detail",children:[f.jsx("span",{className:"tm-project-label",children:"Address"}),f.jsx("span",{className:"tm-project-value",children:e.address})]}),e.general_contractor&&f.jsxs("div",{className:"tm-project-detail",children:[f.jsx("span",{className:"tm-project-label",children:"GC"}),f.jsx("span",{className:"tm-project-value",children:e.general_contractor})]})]}),f.jsxs("div",{className:"tm-field-row",children:[f.jsxs("div",{className:"tm-field tm-field-half",children:[f.jsx("label",{children:"Date"}),f.jsx("input",{type:"date",value:h,onChange:ie=>m(ie.target.value),className:"tm-date"})]}),f.jsxs("div",{className:"tm-field tm-field-half",children:[f.jsx("label",{children:"CE / PCO #"}),f.jsx("input",{type:"text",placeholder:"Change Event / PCO",value:p,onChange:ie=>v(ie.target.value),className:"tm-input"})]})]}),se.length>0&&f.jsxs("div",{className:"tm-crew-picker",children:[f.jsxs("button",{className:"tm-crew-picker-btn",onClick:()=>ge(!z),children:[" ",z?"Hide":"Select from"," Today's Crew (",se.length,")"]}),z&&f.jsx("div",{className:"tm-crew-list",children:se.map((ie,De)=>{const Me=b.some(We=>We.name.toLowerCase()===ie.name.toLowerCase())||E.some(We=>We.name.toLowerCase()===ie.name.toLowerCase());return f.jsxs("button",{className:`tm-crew-item ${Me?"added":""}`,onClick:()=>{if(!Me){if(ie.role==="Foreman"||ie.role==="Supervisor"){const We=b.findIndex(ot=>!ot.name.trim());We>=0?re(We,"name",ie.name):w([...b,{name:ie.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:ie.role==="Supervisor"?"Superintendent":"Foreman"}])}else{const We=E.findIndex(ot=>!ot.name.trim());We>=0?Se(We,"name",ie.name):k([...E,{name:ie.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])}l(`Added ${ie.name}`,"success")}},disabled:Me,children:[f.jsx("span",{className:"tm-crew-item-name",children:ie.name}),f.jsx("span",{className:`tm-crew-item-role ${ie.role.toLowerCase()}`,children:ie.role}),Me&&f.jsx("span",{className:"tm-crew-item-check",children:""})]},De)})})]}),f.jsxs("div",{className:"tm-field",children:[f.jsx("label",{children:"Supervision"}),f.jsx("div",{className:"tm-workers-list",children:b.map((ie,De)=>f.jsxs("div",{className:"tm-worker-card-expanded",children:[f.jsxs("div",{className:"tm-worker-row-top",children:[f.jsx("div",{className:"tm-role-select",children:f.jsxs("select",{value:ie.role,onChange:Me=>re(De,"role",Me.target.value),children:[f.jsx("option",{value:"Foreman",children:"Foreman"}),f.jsx("option",{value:"Superintendent",children:"Superintendent"})]})}),f.jsx("input",{type:"text",placeholder:"First & Last Name",value:ie.name,onChange:Me=>re(De,"name",Me.target.value),className:"tm-worker-input"}),f.jsx("button",{className:"tm-remove",onClick:()=>de(De),children:""})]}),f.jsxs("div",{className:"tm-worker-row-bottom",children:[f.jsxs("div",{className:"tm-time-group",children:[f.jsx("label",{children:"Start"}),f.jsx("input",{type:"time",value:ie.timeStarted,onChange:Me=>re(De,"timeStarted",Me.target.value)})]}),f.jsxs("div",{className:"tm-time-group",children:[f.jsx("label",{children:"End"}),f.jsx("input",{type:"time",value:ie.timeEnded,onChange:Me=>re(De,"timeEnded",Me.target.value)})]}),f.jsxs("div",{className:"tm-time-group",children:[f.jsx("label",{children:"Reg Hrs"}),f.jsx("input",{type:"number",placeholder:"0",value:ie.hours,onChange:Me=>re(De,"hours",Me.target.value)})]}),f.jsxs("div",{className:"tm-time-group",children:[f.jsx("label",{children:"OT Hrs"}),f.jsx("input",{type:"number",placeholder:"0",value:ie.overtimeHours,onChange:Me=>re(De,"overtimeHours",Me.target.value)})]})]})]},De))}),f.jsx("button",{className:"tm-add-btn",onClick:Z,children:"+ Add Supervision"})]}),f.jsxs("div",{className:"tm-field",children:[f.jsx("label",{children:"Laborers"}),f.jsx("div",{className:"tm-workers-list",children:E.map((ie,De)=>f.jsxs("div",{className:"tm-worker-card-expanded",children:[f.jsxs("div",{className:"tm-worker-row-top",children:[f.jsx("input",{type:"text",placeholder:"First & Last Name",value:ie.name,onChange:Me=>Se(De,"name",Me.target.value),className:"tm-worker-input"}),f.jsx("button",{className:"tm-remove",onClick:()=>xe(De),children:""})]}),f.jsxs("div",{className:"tm-worker-row-bottom",children:[f.jsxs("div",{className:"tm-time-group",children:[f.jsx("label",{children:"Start"}),f.jsx("input",{type:"time",value:ie.timeStarted,onChange:Me=>Se(De,"timeStarted",Me.target.value)})]}),f.jsxs("div",{className:"tm-time-group",children:[f.jsx("label",{children:"End"}),f.jsx("input",{type:"time",value:ie.timeEnded,onChange:Me=>Se(De,"timeEnded",Me.target.value)})]}),f.jsxs("div",{className:"tm-time-group",children:[f.jsx("label",{children:"Reg Hrs"}),f.jsx("input",{type:"number",placeholder:"0",value:ie.hours,onChange:Me=>Se(De,"hours",Me.target.value)})]}),f.jsxs("div",{className:"tm-time-group",children:[f.jsx("label",{children:"OT Hrs"}),f.jsx("input",{type:"number",placeholder:"0",value:ie.overtimeHours,onChange:Me=>Se(De,"overtimeHours",Me.target.value)})]})]})]},De))}),f.jsx("button",{className:"tm-add-btn",onClick:ve,children:"+ Add Laborer"})]}),f.jsxs("div",{className:"tm-field",children:[f.jsx("label",{children:"Description of Work"}),f.jsx("textarea",{placeholder:"What work was performed today?",value:j,onChange:ie=>F(ie.target.value),rows:3,className:"tm-description"})]}),f.jsxs("div",{className:"tm-field",children:[f.jsxs("label",{children:[" Photos",r!==-1&&f.jsxs("span",{className:"tm-photo-count",children:["(",R.length,"/",r,")"]})]}),R.length>0&&f.jsx("div",{className:"tm-photo-grid",children:R.map(ie=>f.jsxs("div",{className:"tm-photo-item",children:[f.jsx("img",{src:ie.previewUrl,alt:ie.name}),f.jsx("button",{className:"tm-photo-remove",onClick:()=>be(ie.id),children:""})]},ie.id))}),(r===-1||R.length<r)&&f.jsxs("label",{className:"tm-photo-btn",children:[f.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:Le,style:{display:"none"}})," ",R.length>0?"Add More Photos":"Add Photos"]}),r!==-1&&R.length>=r&&f.jsxs("div",{className:"tm-photo-limit-reached",children:["Photo limit reached (",r," max)"]})]})]}),c===2&&!Oe&&f.jsxs("div",{className:"tm-step-content",children:[f.jsxs("div",{className:"tm-field",children:[f.jsx("label",{children:"What was used?"}),f.jsx("div",{className:"tm-category-grid",children:v1.map(ie=>{const De=A.filter(Me=>Me.category===ie);return f.jsxs("button",{className:"tm-category-card",onClick:()=>Ce(ie),children:[f.jsx("span",{className:"tm-cat-name",children:ie}),De.length>0&&f.jsx("span",{className:"tm-cat-count",children:De.length})]},ie)})})]}),A.length>0&&f.jsxs("div",{className:"tm-field",children:[f.jsxs("label",{children:["Added Items (",A.length,")"]}),f.jsx("div",{className:"tm-added-list",children:A.map((ie,De)=>f.jsxs("div",{className:"tm-added-item",children:[f.jsxs("div",{className:"tm-added-info",children:[ie.isCustom&&f.jsx("span",{className:"tm-custom-badge",children:"Custom"}),f.jsx("span",{className:"tm-added-name",children:ie.name})]}),f.jsxs("div",{className:"tm-added-qty",children:[f.jsx("button",{onClick:()=>Ie(De,ie.quantity-1),children:""}),f.jsx("span",{children:ie.quantity}),f.jsx("button",{onClick:()=>Ie(De,ie.quantity+1),children:"+"})]})]},De))})]})]}),c===3&&f.jsxs("div",{className:"tm-step-content",children:[f.jsx("div",{className:"tm-review-section",children:f.jsxs("div",{className:"tm-review-header",children:[f.jsx("span",{children:" Date"}),f.jsx("span",{children:new Date(h).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})]})}),j&&f.jsxs("div",{className:"tm-review-section",children:[f.jsx("div",{className:"tm-review-header",children:f.jsx("span",{children:" Description"})}),f.jsx("div",{className:"tm-review-notes",children:j})]}),R.length>0&&f.jsxs("div",{className:"tm-review-section",children:[f.jsxs("div",{className:"tm-review-header",children:[f.jsx("span",{children:" Photos"}),f.jsx("span",{children:R.length})]}),f.jsx("div",{className:"tm-review-photos",children:R.map(ie=>f.jsx("img",{src:ie.previewUrl,alt:ie.name},ie.id))})]}),Dr.length>0&&f.jsxs("div",{className:"tm-review-section",children:[f.jsxs("div",{className:"tm-review-header",children:[f.jsx("span",{children:" Supervision"}),f.jsxs("span",{children:[Dr.reduce((ie,De)=>ie+parseFloat(De.hours||0)+parseFloat(De.overtimeHours||0),0)," hrs"]})]}),f.jsx("div",{className:"tm-review-list",children:Dr.map((ie,De)=>f.jsxs("div",{className:"tm-review-row-detailed",children:[f.jsxs("div",{className:"tm-review-worker-name",children:[f.jsx("span",{className:"tm-role-badge",children:ie.role})," ",ie.name]}),f.jsxs("div",{className:"tm-review-worker-details",children:[ie.timeStarted&&ie.timeEnded&&f.jsxs("span",{className:"tm-review-time",children:[ie.timeStarted," - ",ie.timeEnded]}),f.jsxs("span",{className:"tm-review-hours",children:[ie.hours||0," reg",parseFloat(ie.overtimeHours)>0?` + ${ie.overtimeHours} OT`:""]})]})]},De))})]}),Ft.length>0&&f.jsxs("div",{className:"tm-review-section",children:[f.jsxs("div",{className:"tm-review-header",children:[f.jsx("span",{children:" Laborers"}),f.jsxs("span",{children:[Ft.reduce((ie,De)=>ie+parseFloat(De.hours||0)+parseFloat(De.overtimeHours||0),0)," hrs"]})]}),f.jsx("div",{className:"tm-review-list",children:Ft.map((ie,De)=>f.jsxs("div",{className:"tm-review-row-detailed",children:[f.jsx("div",{className:"tm-review-worker-name",children:ie.name}),f.jsxs("div",{className:"tm-review-worker-details",children:[ie.timeStarted&&ie.timeEnded&&f.jsxs("span",{className:"tm-review-time",children:[ie.timeStarted," - ",ie.timeEnded]}),f.jsxs("span",{className:"tm-review-hours",children:[ie.hours||0," reg",parseFloat(ie.overtimeHours)>0?` + ${ie.overtimeHours} OT`:""]})]})]},De))})]}),A.length>0&&f.jsxs("div",{className:"tm-review-section",children:[f.jsxs("div",{className:"tm-review-header",children:[f.jsx("span",{children:" Materials & Equipment"}),f.jsxs("span",{children:[A.length," items"]})]}),f.jsx("div",{className:"tm-review-list",children:A.map((ie,De)=>f.jsxs("div",{className:"tm-review-row",children:[f.jsxs("span",{children:[ie.isCustom&&" ",ie.name]}),f.jsxs("span",{children:[ie.quantity," ",ie.unit]})]},De))})]}),f.jsxs("div",{className:"tm-review-section tm-certification",children:[f.jsx("div",{className:"tm-review-header",children:f.jsx("span",{children:" Submitted By"})}),f.jsx("input",{type:"text",className:"tm-certification-input",placeholder:"Enter your name",value:_,onChange:ie=>y(ie.target.value)}),f.jsx("p",{className:"tm-certification-note",children:"By submitting, you certify this T&M is accurate."})]})]}),f.jsxs("div",{className:"tm-wizard-footer",children:[c<3?f.jsx("button",{className:"tm-big-btn primary",onClick:kt,disabled:c===1&&!it(),children:c===1?`Next: Materials (${At} workers, ${jr+Fr} hrs)`:c===2?`Review (${A.length} items)`:"Next"}):f.jsx("button",{className:"tm-big-btn submit",onClick:Et,disabled:X,children:X?"Submitting...":" Submit T&M"}),c===2&&f.jsx("button",{className:"tm-skip-btn",onClick:kt,children:"Skip (no materials)"})]})]})}var _f={};_f.version="0.18.5";var By=1252,Wk=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],hm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},mm=function(e){Wk.indexOf(e)!=-1&&(By=hm[0]=e)};function Xk(){mm(1252)}var cn=function(e){mm(e)};function pm(){cn(1200),Xk()}function _1(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function Kk(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Ly(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Vc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Kk(e.slice(2)):t==254&&r==255?Ly(e.slice(2)):t==65279?e.slice(1):e},Ju=function(t){return String.fromCharCode(t)},y1=function(t){return String.fromCharCode(t)},ao,Rs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function no(e){for(var t="",r=0,a=0,s=0,l=0,c=0,u=0,h=0,m=0;m<e.length;)r=e.charCodeAt(m++),l=r>>2,a=e.charCodeAt(m++),c=(r&3)<<4|a>>4,s=e.charCodeAt(m++),u=(a&15)<<2|s>>6,h=s&63,isNaN(a)?u=h=64:isNaN(s)&&(h=64),t+=Rs.charAt(l)+Rs.charAt(c)+Rs.charAt(u)+Rs.charAt(h);return t}function Oa(e){var t="",r=0,a=0,s=0,l=0,c=0,u=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<e.length;)l=Rs.indexOf(e.charAt(m++)),c=Rs.indexOf(e.charAt(m++)),r=l<<2|c>>4,t+=String.fromCharCode(r),u=Rs.indexOf(e.charAt(m++)),a=(c&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(a)),h=Rs.indexOf(e.charAt(m++)),s=(u&3)<<6|h,h!==64&&(t+=String.fromCharCode(s));return t}var xt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Jn=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Fs(e){return xt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function w1(e){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Na=function(t){return xt?Jn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Bf(e){if(typeof ArrayBuffer>"u")return Na(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Us(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Yk(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function gm(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return gm(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Or=xt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Jn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function Jk(e){for(var t=[],r=0,a=e.length+250,s=Fs(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)s[r++]=c;else if(c<2048)s[r++]=192|c>>6&31,s[r++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=e.charCodeAt(++l)&1023;s[r++]=240|c>>8&7,s[r++]=128|c>>2&63,s[r++]=128|u>>6&15|(c&3)<<4,s[r++]=128|u&63}else s[r++]=224|c>>12&15,s[r++]=128|c>>6&63,s[r++]=128|c&63;r>a&&(t.push(s.slice(0,r)),r=0,s=Fs(65535),a=65530)}return t.push(s.slice(0,r)),Or(t)}var sa=/\u0000/g,Gc=/[\u0001-\u0006]/g;function Cl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function on(e,t){var r=""+e;return r.length>=t?r:cr("0",t-r.length)+r}function xm(e,t){var r=""+e;return r.length>=t?r:cr(" ",t-r.length)+r}function yf(e,t){var r=""+e;return r.length>=t?r:r+cr(" ",t-r.length)}function Qk(e,t){var r=""+Math.round(e);return r.length>=t?r:cr("0",t-r.length)+r}function Zk(e,t){var r=""+e;return r.length>=t?r:cr("0",t-r.length)+r}var b1=Math.pow(2,32);function yl(e,t){if(e>b1||e<-b1)return Qk(e,t);var r=Math.round(e);return Zk(r,t)}function wf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var E1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],dh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function eA(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},S1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},tA={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function bf(e,t,r){for(var a=e<0?-1:1,s=e*a,l=0,c=1,u=0,h=1,m=0,p=0,v=Math.floor(s);m<t&&(v=Math.floor(s),u=v*c+l,p=v*m+h,!(s-v<5e-8));)s=1/(s-v),l=c,c=u,h=m,m=p;if(p>t&&(m>t?(p=h,u=l):(p=m,u=c)),!r)return[0,a*u,p];var _=Math.floor(a*u/p);return[_,a*u-_*p,p]}function pi(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),l=0,c=[],u={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(a+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++a,++u.D)),a===60)c=r?[1317,10,29]:[1900,2,29],l=3;else if(a===0)c=r?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var h=new Date(1900,0,1);h.setDate(h.getDate()+a-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),a<60&&(l=(l+6)%7),r&&(l=lA(h,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=l,u}var Uy=new Date(1899,11,31,0,0,0),rA=Uy.getTime(),aA=new Date(1900,2,1,0,0,0);function Iy(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=aA&&(r+=1440*60*1e3),(r-(rA+(e.getTimezoneOffset()-Uy.getTimezoneOffset())*6e4))/(1440*60*1e3)}function vm(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function nA(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function sA(e){var t=e<0?12:11,r=vm(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function iA(e){var t=vm(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function so(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=sA(e):t===10?r=e.toFixed(10).substr(0,12):r=iA(e),vm(nA(r.toUpperCase()))}function wi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):so(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ja(14,Iy(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function lA(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function cA(e,t,r,a){var s="",l=0,c=0,u=r.y,h,m=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:h=u%100,m=2;break;default:h=u%1e4,m=4;break}break;case 109:switch(t.length){case 1:case 2:h=r.m,m=t.length;break;case 3:return dh[r.m-1][1];case 5:return dh[r.m-1][0];default:return dh[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=r.d,m=t.length;break;case 3:return E1[r.q][0];default:return E1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(r.H+11)%12,m=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=r.H,m=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=r.M,m=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?on(r.S,t.length):(a>=2?c=a===3?1e3:100:c=a===1?10:1,l=Math.round(c*(r.S+r.u)),l>=60*c&&(l=0),t==="s"?l===0?"0":""+l/c:(s=on(l,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}m=t.length===3?1:2;break;case 101:h=u,m=1;break}var p=m>0?on(h,m):"";return p}function Ds(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var Py=/%/g;function oA(e,t,r){var a=t.replace(Py,""),s=t.length-a.length;return Wn(e,a,r*Math.pow(10,2*s))+cr("%",s)}function uA(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Wn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function zy(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+zy(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),r.indexOf("e")===-1){var c=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,m,p){return h+m+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Hy=/# (\?+)( ?)\/( ?)(\d+)/;function fA(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),l=Math.floor(s/a),c=s-l*a,u=a;return r+(l===0?"":""+l)+" "+(c===0?cr(" ",e[1].length+1+e[4].length):xm(c,e[1].length)+e[2]+"/"+e[3]+on(u,e[4].length))}function dA(e,t,r){return r+(t===0?"":""+t)+cr(" ",e[1].length+2+e[4].length)}var qy=/^#*0*\.([0#]+)/,Vy=/\).*[0#]/,Gy=/\(###\) ###\\?-####/;function aa(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function T1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function k1(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function hA(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function mA(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ga(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Vy)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ga("n",a,r):"("+Ga("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return uA(e,t,r);if(t.indexOf("%")!==-1)return oA(e,t,r);if(t.indexOf("E")!==-1)return zy(t,r);if(t.charCodeAt(0)===36)return"$"+Ga(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,c,u,h=Math.abs(r),m=r<0?"-":"";if(t.match(/^00+$/))return m+yl(h,t.length);if(t.match(/^[#?]+$/))return s=yl(r,0),s==="0"&&(s=""),s.length>t.length?s:aa(t.substr(0,t.length-s.length))+s;if(l=t.match(Hy))return fA(l,h,m);if(t.match(/^#+0+$/))return m+yl(h,t.length-t.indexOf("0"));if(l=t.match(qy))return s=T1(r,l[1].length).replace(/^([^\.]+)$/,"$1."+aa(l[1])).replace(/\.$/,"."+aa(l[1])).replace(/\.(\d*)$/,function(b,w){return"."+w+cr("0",aa(l[1]).length-w.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return m+T1(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return m+Ds(yl(h,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ga(e,t,-r):Ds(""+(Math.floor(r)+hA(r,l[1].length)))+"."+on(k1(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return Ga(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Cl(Ga(e,t.replace(/[\\-]/g,""),r)),c=0,Cl(Cl(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<s.length?s.charAt(c++):b==="0"?"0":""}));if(t.match(Gy))return s=Ga(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=bf(h,Math.pow(10,c)-1,!1),s=""+m,p=Wn("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=yf(u[2],c),p.length<l[4].length&&(p=aa(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=bf(h,Math.pow(10,c)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?xm(u[1],c)+l[2]+"/"+l[3]+yf(u[2],c):cr(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=yl(r,0),t.length<=s.length?s:aa(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var v=t.indexOf(".")-c,_=t.length-s.length-v;return aa(t.substr(0,v)+s+t.substr(t.length-_))}if(l=t.match(/^00,000\.([#0]*0)$/))return c=k1(r,l[1].length),r<0?"-"+Ga(e,t,-r):Ds(mA(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?on(0,3-b.length):"")+b})+"."+on(c,l[1].length);switch(t){case"###,##0.00":return Ga(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=Ds(yl(h,0));return y!=="0"?m+y:"";case"###,###.00":return Ga(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ga(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function pA(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Wn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function gA(e,t,r){var a=t.replace(Py,""),s=t.length-a.length;return Wn(e,a,r*Math.pow(10,2*s))+cr("%",s)}function $y(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+$y(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),!r.match(/[Ee]/)){var c=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,m,p){return h+m+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function vn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Vy)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?vn("n",a,r):"("+vn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return pA(e,t,r);if(t.indexOf("%")!==-1)return gA(e,t,r);if(t.indexOf("E")!==-1)return $y(t,r);if(t.charCodeAt(0)===36)return"$"+vn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,c,u,h=Math.abs(r),m=r<0?"-":"";if(t.match(/^00+$/))return m+on(h,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:aa(t.substr(0,t.length-s.length))+s;if(l=t.match(Hy))return dA(l,h,m);if(t.match(/^#+0+$/))return m+on(h,t.length-t.indexOf("0"));if(l=t.match(qy))return s=(""+r).replace(/^([^\.]+)$/,"$1."+aa(l[1])).replace(/\.$/,"."+aa(l[1])),s=s.replace(/\.(\d*)$/,function(b,w){return"."+w+cr("0",aa(l[1]).length-w.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return m+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return m+Ds(""+h);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+vn(e,t,-r):Ds(""+r)+"."+cr("0",l[1].length);if(l=t.match(/^#,#*,#0/))return vn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Cl(vn(e,t.replace(/[\\-]/g,""),r)),c=0,Cl(Cl(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<s.length?s.charAt(c++):b==="0"?"0":""}));if(t.match(Gy))return s=vn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=bf(h,Math.pow(10,c)-1,!1),s=""+m,p=Wn("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=yf(u[2],c),p.length<l[4].length&&(p=aa(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=bf(h,Math.pow(10,c)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?xm(u[1],c)+l[2]+"/"+l[3]+yf(u[2],c):cr(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:aa(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var v=t.indexOf(".")-c,_=t.length-s.length-v;return aa(t.substr(0,v)+s+t.substr(t.length-_))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+vn(e,t,-r):Ds(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?on(0,3-b.length):"")+b})+"."+on(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=Ds(""+h);return y!=="0"?m+y:"";default:if(t.match(/\.[0#?]*$/))return vn(e,t.slice(0,t.lastIndexOf(".")),r)+aa(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Wn(e,t,r){return(r|0)===r?vn(e,t,r):Ga(e,t,r)}function xA(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Wy=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Hl(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":wf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(Wy))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function vA(e,t,r,a){for(var s=[],l="",c=0,u="",h="t",m,p,v,_="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!wf(e,c))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(v=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(v);s[s.length]={t:"t",v:l},++c;break;case"\\":var y=e.charAt(++c),b=y==="("||y===")"?y:"t";s[s.length]={t:b,v:y},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:t},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(m==null&&(m=pi(t,r,e.charAt(c+1)==="2"),m==null))return"";s[s.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||m==null&&(m=pi(t,r),m==null))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),s[s.length]={t:u,v:l},h=u;break;case"A":case"a":case"":var w={t:u,v:u};if(m==null&&(m=pi(t,r)),e.substr(c,3).toUpperCase()==="A/P"?(m!=null&&(w.v=m.H>=12?"P":"A"),w.t="T",_="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(m!=null&&(w.v=m.H>=12?"PM":"AM"),w.t="T",c+=5,_="h"):e.substr(c,5).toUpperCase()==="/"?(m!=null&&(w.v=m.H>=12?"":""),w.t="T",c+=5,_="h"):(w.t="t",++c),m==null&&w.t==="T")return"";s[s.length]=w,h=u;break;case"[":for(l=u;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Wy)){if(m==null&&(m=pi(t,r),m==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Hl(e)||(s[s.length]={t:"t",v:l}));break;case".":if(m!=null){for(l=u;++c<e.length&&(u=e.charAt(c))==="0";)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;s[s.length]={t:u,v:l},h=u;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":s[s.length]={t:a===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++c;break}var E=0,k=0,A;for(c=s.length-1,h="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=_,h="h",E<1&&(E=1);break;case"s":(A=s[c].v.match(/\.0+$/))&&(k=Math.max(k,A[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":h=s[c].t;break;case"m":h==="s"&&(s[c].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&s[c].v.match(/[Hh]/)&&(E=1),E<2&&s[c].v.match(/[Mm]/)&&(E=2),E<3&&s[c].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var S="",j;for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=cA(s[c].t.charCodeAt(0),s[c].v,m,k),s[c].t="t";break;case"n":case"?":for(j=c+1;s[j]!=null&&((u=s[j].t)==="?"||u==="D"||(u===" "||u==="t")&&s[j+1]!=null&&(s[j+1].t==="?"||s[j+1].t==="t"&&s[j+1].v==="/")||s[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[j].v==="/"||s[j].v===" "&&s[j+1]!=null&&s[j+1].t=="?"));)s[c].v+=s[j].v,s[j]={v:"",t:";"},++j;S+=s[c].v,c=j-1;break;case"G":s[c].t="t",s[c].v=wi(t,r);break}var F="",R,N;if(S.length>0){S.charCodeAt(0)==40?(R=t<0&&S.charCodeAt(0)===45?-t:t,N=Wn("n",S,R)):(R=t<0&&a>1?-t:t,N=Wn("n",S,R),R<0&&s[0]&&s[0].t=="t"&&(N=N.substr(1),s[0].v="-"+s[0].v)),j=N.length-1;var X=s.length;for(c=0;c<s.length;++c)if(s[c]!=null&&s[c].t!="t"&&s[c].v.indexOf(".")>-1){X=c;break}var G=s.length;if(X===s.length&&N.indexOf("E")===-1){for(c=s.length-1;c>=0;--c)s[c]==null||"n?".indexOf(s[c].t)===-1||(j>=s[c].v.length-1?(j-=s[c].v.length,s[c].v=N.substr(j+1,s[c].v.length)):j<0?s[c].v="":(s[c].v=N.substr(0,j+1),j=-1),s[c].t="t",G=c);j>=0&&G<s.length&&(s[G].v=N.substr(0,j+1)+s[G].v)}else if(X!==s.length&&N.indexOf("E")===-1){for(j=N.indexOf(".")-1,c=X;c>=0;--c)if(!(s[c]==null||"n?".indexOf(s[c].t)===-1)){for(p=s[c].v.indexOf(".")>-1&&c===X?s[c].v.indexOf(".")-1:s[c].v.length-1,F=s[c].v.substr(p+1);p>=0;--p)j>=0&&(s[c].v.charAt(p)==="0"||s[c].v.charAt(p)==="#")&&(F=N.charAt(j--)+F);s[c].v=F,s[c].t="t",G=c}for(j>=0&&G<s.length&&(s[G].v=N.substr(0,j+1)+s[G].v),j=N.indexOf(".")+1,c=X;c<s.length;++c)if(!(s[c]==null||"n?(".indexOf(s[c].t)===-1&&c!==X)){for(p=s[c].v.indexOf(".")>-1&&c===X?s[c].v.indexOf(".")+1:0,F=s[c].v.substr(0,p);p<s[c].v.length;++p)j<N.length&&(F+=N.charAt(j++));s[c].v=F,s[c].t="t",G=c}}}for(c=0;c<s.length;++c)s[c]!=null&&"n?".indexOf(s[c].t)>-1&&(R=a>1&&t<0&&c>0&&s[c-1].v==="-"?-t:t,s[c].v=Wn(s[c].t,s[c].v,R),s[c].t="t");var se="";for(c=0;c!==s.length;++c)s[c]!=null&&(se+=s[c].v);return se}var A1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function j1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function _A(e,t){var r=xA(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var c=r[0].match(A1),u=r[1].match(A1);return j1(t,c)?[a,r[0]]:j1(t,u)?[a,r[1]]:[a,r[c!=null&&u!=null?2:1]]}return[a,l]}function Ja(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:nt)[e],a==null&&(a=r.table&&r.table[S1[e]]||nt[S1[e]]),a==null&&(a=tA[e]||"General");break}if(wf(a,0))return wi(t,r);t instanceof Date&&(t=Iy(t,r.date1904));var s=_A(a,t);if(wf(s[1]))return wi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return vA(s[1],t,r,s[0])}function Xn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(nt[r]==null){t<0&&(t=r);continue}if(nt[r]==e){t=r;break}}t<0&&(t=391)}return nt[t]=e,t}function Lf(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Xn(e[t],t)}function ql(){nt=eA()}var yA={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Xy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function wA(e){var t=typeof e=="number"?nt[e]:e;return t=t.replace(Xy,"(\\d+)"),new RegExp("^"+t+"$")}function bA(e,t,r){var a=-1,s=-1,l=-1,c=-1,u=-1,h=-1;(t.match(Xy)||[]).forEach(function(v,_){var y=parseInt(r[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":a=y;break;case"d":l=y;break;case"h":c=y;break;case"s":h=y;break;case"m":c>=0?u=y:s=y;break}}),h>=0&&u==-1&&s>=0&&(u=s,s=-1);var m=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var p=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return c==-1&&u==-1&&h==-1?m:a==-1&&s==-1&&l==-1?p:m+"T"+p}var EA=(function(){var e={};e.version="1.2.0";function t(){for(var N=0,X=new Array(256),G=0;G!=256;++G)N=G,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,X[G]=N;return typeof Int32Array<"u"?new Int32Array(X):X}var r=t();function a(N){var X=0,G=0,se=0,te=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(se=0;se!=256;++se)te[se]=N[se];for(se=0;se!=256;++se)for(G=N[se],X=256+se;X<4096;X+=256)G=te[X]=G>>>8^N[G&255];var z=[];for(se=1;se!=16;++se)z[se-1]=typeof Int32Array<"u"?te.subarray(se*256,se*256+256):te.slice(se*256,se*256+256);return z}var s=a(r),l=s[0],c=s[1],u=s[2],h=s[3],m=s[4],p=s[5],v=s[6],_=s[7],y=s[8],b=s[9],w=s[10],E=s[11],k=s[12],A=s[13],S=s[14];function j(N,X){for(var G=X^-1,se=0,te=N.length;se<te;)G=G>>>8^r[(G^N.charCodeAt(se++))&255];return~G}function F(N,X){for(var G=X^-1,se=N.length-15,te=0;te<se;)G=S[N[te++]^G&255]^A[N[te++]^G>>8&255]^k[N[te++]^G>>16&255]^E[N[te++]^G>>>24]^w[N[te++]]^b[N[te++]]^y[N[te++]]^_[N[te++]]^v[N[te++]]^p[N[te++]]^m[N[te++]]^h[N[te++]]^u[N[te++]]^c[N[te++]]^l[N[te++]]^r[N[te++]];for(se+=15;te<se;)G=G>>>8^r[(G^N[te++])&255];return~G}function R(N,X){for(var G=X^-1,se=0,te=N.length,z=0,ge=0;se<te;)z=N.charCodeAt(se++),z<128?G=G>>>8^r[(G^z)&255]:z<2048?(G=G>>>8^r[(G^(192|z>>6&31))&255],G=G>>>8^r[(G^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,ge=N.charCodeAt(se++)&1023,G=G>>>8^r[(G^(240|z>>8&7))&255],G=G>>>8^r[(G^(128|z>>2&63))&255],G=G>>>8^r[(G^(128|ge>>6&15|(z&3)<<4))&255],G=G>>>8^r[(G^(128|ge&63))&255]):(G=G>>>8^r[(G^(224|z>>12&15))&255],G=G>>>8^r[(G^(128|z>>6&63))&255],G=G>>>8^r[(G^(128|z&63))&255]);return~G}return e.table=r,e.bstr=j,e.buf=F,e.str=R,e})(),tt=(function(){var t={};t.version="1.2.1";function r(O,V){for(var M=O.split("/"),B=V.split("/"),P=0,W=0,ue=Math.min(M.length,B.length);P<ue;++P){if(W=M[P].length-B[P].length)return W;if(M[P]!=B[P])return M[P]<B[P]?-1:1}return M.length-B.length}function a(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:a(O.slice(0,-1));var V=O.lastIndexOf("/");return V===-1?O:O.slice(0,V+1)}function s(O){if(O.charAt(O.length-1)=="/")return s(O.slice(0,-1));var V=O.lastIndexOf("/");return V===-1?O:O.slice(V+1)}function l(O,V){typeof V=="string"&&(V=new Date(V));var M=V.getHours();M=M<<6|V.getMinutes(),M=M<<5|V.getSeconds()>>>1,O.write_shift(2,M);var B=V.getFullYear()-1980;B=B<<4|V.getMonth()+1,B=B<<5|V.getDate(),O.write_shift(2,B)}function c(O){var V=O.read_shift(2)&65535,M=O.read_shift(2)&65535,B=new Date,P=M&31;M>>>=5;var W=M&15;M>>>=4,B.setMilliseconds(0),B.setFullYear(M+1980),B.setMonth(W-1),B.setDate(P);var ue=V&31;V>>>=5;var je=V&63;return V>>>=6,B.setHours(V),B.setMinutes(je),B.setSeconds(ue<<1),B}function u(O){qr(O,0);for(var V={},M=0;O.l<=O.length-4;){var B=O.read_shift(2),P=O.read_shift(2),W=O.l+P,ue={};switch(B){case 21589:M=O.read_shift(1),M&1&&(ue.mtime=O.read_shift(4)),P>5&&(M&2&&(ue.atime=O.read_shift(4)),M&4&&(ue.ctime=O.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3));break}O.l=W,V[B]=ue}return V}var h;function m(){return h||(h={})}function p(O,V){if(O[0]==80&&O[1]==75)return Tn(O,V);if((O[0]|32)==109&&(O[1]|32)==105)return An(O,V);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var M=3,B=512,P=0,W=0,ue=0,je=0,fe=0,he=[],pe=O.slice(0,512);qr(pe,0);var Be=v(pe);switch(M=Be[0],M){case 3:B=512;break;case 4:B=4096;break;case 0:if(Be[1]==0)return Tn(O,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}B!==512&&(pe=O.slice(0,B),qr(pe,28));var ze=O.slice(0,B);_(pe,M);var $e=pe.read_shift(4,"i");if(M===3&&$e!==0)throw new Error("# Directory Sectors: Expected 0 saw "+$e);pe.l+=4,ue=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),je=pe.read_shift(4,"i"),P=pe.read_shift(4,"i"),fe=pe.read_shift(4,"i"),W=pe.read_shift(4,"i");for(var Ue=-1,Ve=0;Ve<109&&(Ue=pe.read_shift(4,"i"),!(Ue<0));++Ve)he[Ve]=Ue;var Ye=y(O,B);E(fe,W,Ye,B,he);var Gt=A(Ye,ue,he,B);Gt[ue].name="!Directory",P>0&&je!==ge&&(Gt[je].name="!MiniFAT"),Gt[he[0]].name="!FAT",Gt.fat_addrs=he,Gt.ssz=B;var $t={},Zt=[],Ra=[],Hs=[];S(ue,Gt,Ye,Zt,P,$t,Ra,je),b(Ra,Hs,Zt),Zt.shift();var as={FileIndex:Ra,FullPaths:Hs};return V&&V.raw&&(as.raw={header:ze,sectors:Ye}),as}function v(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(Oe,"Header Signature: "),O.l+=16;var V=O.read_shift(2,"u");return[O.read_shift(2,"u"),V]}function _(O,V){var M=9;switch(O.l+=2,M=O.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function y(O,V){for(var M=Math.ceil(O.length/V)-1,B=[],P=1;P<M;++P)B[P-1]=O.slice(P*V,(P+1)*V);return B[M-1]=O.slice(M*V),B}function b(O,V,M){for(var B=0,P=0,W=0,ue=0,je=0,fe=M.length,he=[],pe=[];B<fe;++B)he[B]=pe[B]=B,V[B]=M[B];for(;je<pe.length;++je)B=pe[je],P=O[B].L,W=O[B].R,ue=O[B].C,he[B]===B&&(P!==-1&&he[P]!==P&&(he[B]=he[P]),W!==-1&&he[W]!==W&&(he[B]=he[W])),ue!==-1&&(he[ue]=B),P!==-1&&B!=he[B]&&(he[P]=he[B],pe.lastIndexOf(P)<je&&pe.push(P)),W!==-1&&B!=he[B]&&(he[W]=he[B],pe.lastIndexOf(W)<je&&pe.push(W));for(B=1;B<fe;++B)he[B]===B&&(W!==-1&&he[W]!==W?he[B]=he[W]:P!==-1&&he[P]!==P&&(he[B]=he[P]));for(B=1;B<fe;++B)if(O[B].type!==0){if(je=B,je!=he[je])do je=he[je],V[B]=V[je]+"/"+V[B];while(je!==0&&he[je]!==-1&&je!=he[je]);he[B]=-1}for(V[0]+="/",B=1;B<fe;++B)O[B].type!==2&&(V[B]+="/")}function w(O,V,M){for(var B=O.start,P=O.size,W=[],ue=B;M&&P>0&&ue>=0;)W.push(V.slice(ue*z,ue*z+z)),P-=z,ue=di(M,ue*4);return W.length===0?ke(0):Or(W).slice(0,O.size)}function E(O,V,M,B,P){var W=ge;if(O===ge){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var ue=M[O],je=(B>>>2)-1;if(!ue)return;for(var fe=0;fe<je&&(W=di(ue,fe*4))!==ge;++fe)P.push(W);E(di(ue,B-4),V-1,M,B,P)}}function k(O,V,M,B,P){var W=[],ue=[];P||(P=[]);var je=B-1,fe=0,he=0;for(fe=V;fe>=0;){P[fe]=!0,W[W.length]=fe,ue.push(O[fe]);var pe=M[Math.floor(fe*4/B)];if(he=fe*4&je,B<4+he)throw new Error("FAT boundary crossed: "+fe+" 4 "+B);if(!O[pe])break;fe=di(O[pe],he)}return{nodes:W,data:P1([ue])}}function A(O,V,M,B){var P=O.length,W=[],ue=[],je=[],fe=[],he=B-1,pe=0,Be=0,ze=0,$e=0;for(pe=0;pe<P;++pe)if(je=[],ze=pe+V,ze>=P&&(ze-=P),!ue[ze]){fe=[];var Ue=[];for(Be=ze;Be>=0;){Ue[Be]=!0,ue[Be]=!0,je[je.length]=Be,fe.push(O[Be]);var Ve=M[Math.floor(Be*4/B)];if($e=Be*4&he,B<4+$e)throw new Error("FAT boundary crossed: "+Be+" 4 "+B);if(!O[Ve]||(Be=di(O[Ve],$e),Ue[Be]))break}W[ze]={nodes:je,data:P1([fe])}}return W}function S(O,V,M,B,P,W,ue,je){for(var fe=0,he=B.length?2:0,pe=V[O].data,Be=0,ze=0,$e;Be<pe.length;Be+=128){var Ue=pe.slice(Be,Be+128);qr(Ue,64),ze=Ue.read_shift(2),$e=Tm(Ue,0,ze-he),B.push($e);var Ve={name:$e,type:Ue.read_shift(1),color:Ue.read_shift(1),L:Ue.read_shift(4,"i"),R:Ue.read_shift(4,"i"),C:Ue.read_shift(4,"i"),clsid:Ue.read_shift(16),state:Ue.read_shift(4,"i"),start:0,size:0},Ye=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);Ye!==0&&(Ve.ct=j(Ue,Ue.l-8));var Gt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);Gt!==0&&(Ve.mt=j(Ue,Ue.l-8)),Ve.start=Ue.read_shift(4,"i"),Ve.size=Ue.read_shift(4,"i"),Ve.size<0&&Ve.start<0&&(Ve.size=Ve.type=0,Ve.start=ge,Ve.name=""),Ve.type===5?(fe=Ve.start,P>0&&fe!==ge&&(V[fe].name="!StreamData")):Ve.size>=4096?(Ve.storage="fat",V[Ve.start]===void 0&&(V[Ve.start]=k(M,Ve.start,V.fat_addrs,V.ssz)),V[Ve.start].name=Ve.name,Ve.content=V[Ve.start].data.slice(0,Ve.size)):(Ve.storage="minifat",Ve.size<0?Ve.size=0:fe!==ge&&Ve.start!==ge&&V[fe]&&(Ve.content=w(Ve,V[fe].data,(V[je]||{}).data))),Ve.content&&qr(Ve.content,0),W[$e]=Ve,ue.push(Ve)}}function j(O,V){return new Date((ka(O,V+4)/1e7*Math.pow(2,32)+ka(O,V)/1e7-11644473600)*1e3)}function F(O,V){return m(),p(h.readFileSync(O),V)}function R(O,V){var M=V&&V.type;switch(M||xt&&Buffer.isBuffer(O)&&(M="buffer"),M||"base64"){case"file":return F(O,V);case"base64":return p(Na(Oa(O)),V);case"binary":return p(Na(O),V)}return p(O,V)}function N(O,V){var M=V||{},B=M.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=B+"/",O.FileIndex[0]={name:B,type:5}),M.CLSID&&(O.FileIndex[0].clsid=M.CLSID),X(O)}function X(O){var V="Sh33tJ5";if(!tt.find(O,"/"+V)){var M=ke(4);M[0]=55,M[1]=M[3]=50,M[2]=54,O.FileIndex.push({name:V,type:2,content:M,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+V),G(O)}}function G(O,V){N(O);for(var M=!1,B=!1,P=O.FullPaths.length-1;P>=0;--P){var W=O.FileIndex[P];switch(W.type){case 0:B?M=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(W.R*W.L*W.C)&&(M=!0),W.R>-1&&W.L>-1&&W.R==W.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!V)){var ue=new Date(1987,1,19),je=0,fe=Object.create?Object.create(null):{},he=[];for(P=0;P<O.FullPaths.length;++P)fe[O.FullPaths[P]]=!0,O.FileIndex[P].type!==0&&he.push([O.FullPaths[P],O.FileIndex[P]]);for(P=0;P<he.length;++P){var pe=a(he[P][0]);B=fe[pe],B||(he.push([pe,{name:s(pe).replace("/",""),type:1,clsid:Q,ct:ue,mt:ue,content:null}]),fe[pe]=!0)}for(he.sort(function($e,Ue){return r($e[0],Ue[0])}),O.FullPaths=[],O.FileIndex=[],P=0;P<he.length;++P)O.FullPaths[P]=he[P][0],O.FileIndex[P]=he[P][1];for(P=0;P<he.length;++P){var Be=O.FileIndex[P],ze=O.FullPaths[P];if(Be.name=s(ze).replace("/",""),Be.L=Be.R=Be.C=-(Be.color=1),Be.size=Be.content?Be.content.length:0,Be.start=0,Be.clsid=Be.clsid||Q,P===0)Be.C=he.length>1?1:-1,Be.size=0,Be.type=5;else if(ze.slice(-1)=="/"){for(je=P+1;je<he.length&&a(O.FullPaths[je])!=ze;++je);for(Be.C=je>=he.length?-1:je,je=P+1;je<he.length&&a(O.FullPaths[je])!=a(ze);++je);Be.R=je>=he.length?-1:je,Be.type=1}else a(O.FullPaths[P+1]||"")==a(ze)&&(Be.R=P+1),Be.type=2}}}function se(O,V){var M=V||{};if(M.fileType=="mad")return Gf(O,M);switch(G(O),M.fileType){case"zip":return ts(O,M)}var B=(function($e){for(var Ue=0,Ve=0,Ye=0;Ye<$e.FileIndex.length;++Ye){var Gt=$e.FileIndex[Ye];if(Gt.content){var $t=Gt.content.length;$t>0&&($t<4096?Ue+=$t+63>>6:Ve+=$t+511>>9)}}for(var Zt=$e.FullPaths.length+3>>2,Ra=Ue+7>>3,Hs=Ue+127>>7,as=Ra+Ve+Zt+Hs,dn=as+127>>7,Kl=dn<=109?0:Math.ceil((dn-109)/127);as+dn+Kl+127>>7>dn;)Kl=++dn<=109?0:Math.ceil((dn-109)/127);var la=[1,Kl,dn,Hs,Zt,Ve,Ue,0];return $e.FileIndex[0].size=Ue<<6,la[7]=($e.FileIndex[0].start=la[0]+la[1]+la[2]+la[3]+la[4]+la[5])+(la[6]+7>>3),la})(O),P=ke(B[7]<<9),W=0,ue=0;{for(W=0;W<8;++W)P.write_shift(1,Ce[W]);for(W=0;W<8;++W)P.write_shift(2,0);for(P.write_shift(2,62),P.write_shift(2,3),P.write_shift(2,65534),P.write_shift(2,9),P.write_shift(2,6),W=0;W<3;++W)P.write_shift(2,0);for(P.write_shift(4,0),P.write_shift(4,B[2]),P.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),P.write_shift(4,0),P.write_shift(4,4096),P.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:ge),P.write_shift(4,B[3]),P.write_shift(-4,B[1]?B[0]-1:ge),P.write_shift(4,B[1]),W=0;W<109;++W)P.write_shift(-4,W<B[2]?B[1]+W:-1)}if(B[1])for(ue=0;ue<B[1];++ue){for(;W<236+ue*127;++W)P.write_shift(-4,W<B[2]?B[1]+W:-1);P.write_shift(-4,ue===B[1]-1?ge:ue+1)}var je=function($e){for(ue+=$e;W<ue-1;++W)P.write_shift(-4,W+1);$e&&(++W,P.write_shift(-4,ge))};for(ue=W=0,ue+=B[1];W<ue;++W)P.write_shift(-4,le.DIFSECT);for(ue+=B[2];W<ue;++W)P.write_shift(-4,le.FATSECT);je(B[3]),je(B[4]);for(var fe=0,he=0,pe=O.FileIndex[0];fe<O.FileIndex.length;++fe)pe=O.FileIndex[fe],pe.content&&(he=pe.content.length,!(he<4096)&&(pe.start=ue,je(he+511>>9)));for(je(B[6]+7>>3);P.l&511;)P.write_shift(-4,le.ENDOFCHAIN);for(ue=W=0,fe=0;fe<O.FileIndex.length;++fe)pe=O.FileIndex[fe],pe.content&&(he=pe.content.length,!(!he||he>=4096)&&(pe.start=ue,je(he+63>>6)));for(;P.l&511;)P.write_shift(-4,le.ENDOFCHAIN);for(W=0;W<B[4]<<2;++W){var Be=O.FullPaths[W];if(!Be||Be.length===0){for(fe=0;fe<17;++fe)P.write_shift(4,0);for(fe=0;fe<3;++fe)P.write_shift(4,-1);for(fe=0;fe<12;++fe)P.write_shift(4,0);continue}pe=O.FileIndex[W],W===0&&(pe.start=pe.size?pe.start-1:ge);var ze=W===0&&M.root||pe.name;if(he=2*(ze.length+1),P.write_shift(64,ze,"utf16le"),P.write_shift(2,he),P.write_shift(1,pe.type),P.write_shift(1,pe.color),P.write_shift(-4,pe.L),P.write_shift(-4,pe.R),P.write_shift(-4,pe.C),pe.clsid)P.write_shift(16,pe.clsid,"hex");else for(fe=0;fe<4;++fe)P.write_shift(4,0);P.write_shift(4,pe.state||0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,pe.start),P.write_shift(4,pe.size),P.write_shift(4,0)}for(W=1;W<O.FileIndex.length;++W)if(pe=O.FileIndex[W],pe.size>=4096)if(P.l=pe.start+1<<9,xt&&Buffer.isBuffer(pe.content))pe.content.copy(P,P.l,0,pe.size),P.l+=pe.size+511&-512;else{for(fe=0;fe<pe.size;++fe)P.write_shift(1,pe.content[fe]);for(;fe&511;++fe)P.write_shift(1,0)}for(W=1;W<O.FileIndex.length;++W)if(pe=O.FileIndex[W],pe.size>0&&pe.size<4096)if(xt&&Buffer.isBuffer(pe.content))pe.content.copy(P,P.l,0,pe.size),P.l+=pe.size+63&-64;else{for(fe=0;fe<pe.size;++fe)P.write_shift(1,pe.content[fe]);for(;fe&63;++fe)P.write_shift(1,0)}if(xt)P.l=P.length;else for(;P.l<P.length;)P.write_shift(1,0);return P}function te(O,V){var M=O.FullPaths.map(function(fe){return fe.toUpperCase()}),B=M.map(function(fe){var he=fe.split("/");return he[he.length-(fe.slice(-1)=="/"?2:1)]}),P=!1;V.charCodeAt(0)===47?(P=!0,V=M[0].slice(0,-1)+V):P=V.indexOf("/")!==-1;var W=V.toUpperCase(),ue=P===!0?M.indexOf(W):B.indexOf(W);if(ue!==-1)return O.FileIndex[ue];var je=!W.match(Gc);for(W=W.replace(sa,""),je&&(W=W.replace(Gc,"!")),ue=0;ue<M.length;++ue)if((je?M[ue].replace(Gc,"!"):M[ue]).replace(sa,"")==W||(je?B[ue].replace(Gc,"!"):B[ue]).replace(sa,"")==W)return O.FileIndex[ue];return null}var z=64,ge=-2,Oe="d0cf11e0a1b11ae1",Ce=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ge,FREESECT:-1,HEADER_SIGNATURE:Oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ee(O,V,M){m();var B=se(O,M);h.writeFileSync(V,B)}function K(O){for(var V=new Array(O.length),M=0;M<O.length;++M)V[M]=String.fromCharCode(O[M]);return V.join("")}function Te(O,V){var M=se(O,V);switch(V&&V.type||"buffer"){case"file":return m(),h.writeFileSync(V.filename,M),M;case"binary":return typeof M=="string"?M:K(M);case"base64":return no(typeof M=="string"?M:K(M));case"buffer":if(xt)return Buffer.isBuffer(M)?M:Jn(M);case"array":return typeof M=="string"?Na(M):M}return M}var q;function C(O){try{var V=O.InflateRaw,M=new V;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)q=O;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function H(O,V){if(!q)return Fi(O,V);var M=q.InflateRaw,B=new M,P=B._processChunk(O.slice(O.l),B._finishFlushFlag);return O.l+=B.bytesRead,P}function I(O){return q?q.deflateRawSync(O):We(O)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(O){var V=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(V>>16|V>>8|V)&255}for(var ve=typeof Uint8Array<"u",Se=ve?new Uint8Array(256):[],xe=0;xe<256;++xe)Se[xe]=de(xe);function U(O,V){var M=Se[O&255];return V<=8?M>>>8-V:(M=M<<8|Se[O>>8&255],V<=16?M>>>16-V:(M=M<<8|Se[O>>16&255],M>>>24-V))}function Ze(O,V){var M=V&7,B=V>>>3;return(O[B]|(M<=6?0:O[B+1]<<8))>>>M&3}function Ie(O,V){var M=V&7,B=V>>>3;return(O[B]|(M<=5?0:O[B+1]<<8))>>>M&7}function _e(O,V){var M=V&7,B=V>>>3;return(O[B]|(M<=4?0:O[B+1]<<8))>>>M&15}function Le(O,V){var M=V&7,B=V>>>3;return(O[B]|(M<=3?0:O[B+1]<<8))>>>M&31}function be(O,V){var M=V&7,B=V>>>3;return(O[B]|(M<=1?0:O[B+1]<<8))>>>M&127}function it(O,V,M){var B=V&7,P=V>>>3,W=(1<<M)-1,ue=O[P]>>>B;return M<8-B||(ue|=O[P+1]<<8-B,M<16-B)||(ue|=O[P+2]<<16-B,M<24-B)||(ue|=O[P+3]<<24-B),ue&W}function kt(O,V,M){var B=V&7,P=V>>>3;return B<=5?O[P]|=(M&7)<<B:(O[P]|=M<<B&255,O[P+1]=(M&7)>>8-B),V+3}function ht(O,V,M){var B=V&7,P=V>>>3;return M=(M&1)<<B,O[P]|=M,V+1}function Et(O,V,M){var B=V&7,P=V>>>3;return M<<=B,O[P]|=M&255,M>>>=8,O[P+1]=M,V+8}function Dr(O,V,M){var B=V&7,P=V>>>3;return M<<=B,O[P]|=M&255,M>>>=8,O[P+1]=M&255,O[P+2]=M>>>8,V+16}function Ft(O,V){var M=O.length,B=2*M>V?2*M:V+5,P=0;if(M>=V)return O;if(xt){var W=w1(B);if(O.copy)O.copy(W);else for(;P<O.length;++P)W[P]=O[P];return W}else if(ve){var ue=new Uint8Array(B);if(ue.set)ue.set(O);else for(;P<M;++P)ue[P]=O[P];return ue}return O.length=B,O}function At(O){for(var V=new Array(O),M=0;M<O;++M)V[M]=0;return V}function jr(O,V,M){var B=1,P=0,W=0,ue=0,je=0,fe=O.length,he=ve?new Uint16Array(32):At(32);for(W=0;W<32;++W)he[W]=0;for(W=fe;W<M;++W)O[W]=0;fe=O.length;var pe=ve?new Uint16Array(fe):At(fe);for(W=0;W<fe;++W)he[P=O[W]]++,B<P&&(B=P),pe[W]=0;for(he[0]=0,W=1;W<=B;++W)he[W+16]=je=je+he[W-1]<<1;for(W=0;W<fe;++W)je=O[W],je!=0&&(pe[W]=he[je+16]++);var Be=0;for(W=0;W<fe;++W)if(Be=O[W],Be!=0)for(je=U(pe[W],B)>>B-Be,ue=(1<<B+4-Be)-1;ue>=0;--ue)V[je|ue<<Be]=Be&15|W<<4;return B}var Fr=ve?new Uint16Array(512):At(512),ie=ve?new Uint16Array(32):At(32);if(!ve){for(var De=0;De<512;++De)Fr[De]=0;for(De=0;De<32;++De)ie[De]=0}(function(){for(var O=[],V=0;V<32;V++)O.push(5);jr(O,ie,32);var M=[];for(V=0;V<=143;V++)M.push(8);for(;V<=255;V++)M.push(9);for(;V<=279;V++)M.push(7);for(;V<=287;V++)M.push(8);jr(M,Fr,288)})();var Me=(function(){for(var V=ve?new Uint8Array(32768):[],M=0,B=0;M<re.length-1;++M)for(;B<re[M+1];++B)V[B]=M;for(;B<32768;++B)V[B]=29;var P=ve?new Uint8Array(259):[];for(M=0,B=0;M<Z.length-1;++M)for(;B<Z[M+1];++B)P[B]=M;function W(je,fe){for(var he=0;he<je.length;){var pe=Math.min(65535,je.length-he),Be=he+pe==je.length;for(fe.write_shift(1,+Be),fe.write_shift(2,pe),fe.write_shift(2,~pe&65535);pe-- >0;)fe[fe.l++]=je[he++]}return fe.l}function ue(je,fe){for(var he=0,pe=0,Be=ve?new Uint16Array(32768):[];pe<je.length;){var ze=Math.min(65535,je.length-pe);if(ze<10){for(he=kt(fe,he,+(pe+ze==je.length)),he&7&&(he+=8-(he&7)),fe.l=he/8|0,fe.write_shift(2,ze),fe.write_shift(2,~ze&65535);ze-- >0;)fe[fe.l++]=je[pe++];he=fe.l*8;continue}he=kt(fe,he,+(pe+ze==je.length)+2);for(var $e=0;ze-- >0;){var Ue=je[pe];$e=($e<<5^Ue)&32767;var Ve=-1,Ye=0;if((Ve=Be[$e])&&(Ve|=pe&-32768,Ve>pe&&(Ve-=32768),Ve<pe))for(;je[Ve+Ye]==je[pe+Ye]&&Ye<250;)++Ye;if(Ye>2){Ue=P[Ye],Ue<=22?he=Et(fe,he,Se[Ue+1]>>1)-1:(Et(fe,he,3),he+=5,Et(fe,he,Se[Ue-23]>>5),he+=3);var Gt=Ue<8?0:Ue-4>>2;Gt>0&&(Dr(fe,he,Ye-Z[Ue]),he+=Gt),Ue=V[pe-Ve],he=Et(fe,he,Se[Ue]>>3),he-=3;var $t=Ue<4?0:Ue-2>>1;$t>0&&(Dr(fe,he,pe-Ve-re[Ue]),he+=$t);for(var Zt=0;Zt<Ye;++Zt)Be[$e]=pe&32767,$e=($e<<5^je[pe])&32767,++pe;ze-=Ye-1}else Ue<=143?Ue=Ue+48:he=ht(fe,he,1),he=Et(fe,he,Se[Ue]),Be[$e]=pe&32767,++pe}he=Et(fe,he,0)-1}return fe.l=(he+7)/8|0,fe.l}return function(fe,he){return fe.length<8?W(fe,he):ue(fe,he)}})();function We(O){var V=ke(50+Math.floor(O.length*1.1)),M=Me(O,V);return V.slice(0,M)}var ot=ve?new Uint16Array(32768):At(32768),mt=ve?new Uint16Array(32768):At(32768),St=ve?new Uint16Array(128):At(128),tr=1,ia=1;function Mr(O,V){var M=Le(O,V)+257;V+=5;var B=Le(O,V)+1;V+=5;var P=_e(O,V)+4;V+=4;for(var W=0,ue=ve?new Uint8Array(19):At(19),je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,he=ve?new Uint8Array(8):At(8),pe=ve?new Uint8Array(8):At(8),Be=ue.length,ze=0;ze<P;++ze)ue[L[ze]]=W=Ie(O,V),fe<W&&(fe=W),he[W]++,V+=3;var $e=0;for(he[0]=0,ze=1;ze<=fe;++ze)pe[ze]=$e=$e+he[ze-1]<<1;for(ze=0;ze<Be;++ze)($e=ue[ze])!=0&&(je[ze]=pe[$e]++);var Ue=0;for(ze=0;ze<Be;++ze)if(Ue=ue[ze],Ue!=0){$e=Se[je[ze]]>>8-Ue;for(var Ve=(1<<7-Ue)-1;Ve>=0;--Ve)St[$e|Ve<<Ue]=Ue&7|ze<<3}var Ye=[];for(fe=1;Ye.length<M+B;)switch($e=St[be(O,V)],V+=$e&7,$e>>>=3){case 16:for(W=3+Ze(O,V),V+=2,$e=Ye[Ye.length-1];W-- >0;)Ye.push($e);break;case 17:for(W=3+Ie(O,V),V+=3;W-- >0;)Ye.push(0);break;case 18:for(W=11+be(O,V),V+=7;W-- >0;)Ye.push(0);break;default:Ye.push($e),fe<$e&&(fe=$e);break}var Gt=Ye.slice(0,M),$t=Ye.slice(M);for(ze=M;ze<286;++ze)Gt[ze]=0;for(ze=B;ze<30;++ze)$t[ze]=0;return tr=jr(Gt,ot,286),ia=jr($t,mt,30),V}function Di(O,V){if(O[0]==3&&!(O[1]&3))return[Fs(V),2];for(var M=0,B=0,P=w1(V||1<<18),W=0,ue=P.length>>>0,je=0,fe=0;(B&1)==0;){if(B=Ie(O,M),M+=3,B>>>1)B>>1==1?(je=9,fe=5):(M=Mr(O,M),je=tr,fe=ia);else{M&7&&(M+=8-(M&7));var he=O[M>>>3]|O[(M>>>3)+1]<<8;if(M+=32,he>0)for(!V&&ue<W+he&&(P=Ft(P,W+he),ue=P.length);he-- >0;)P[W++]=O[M>>>3],M+=8;continue}for(;;){!V&&ue<W+32767&&(P=Ft(P,W+32767),ue=P.length);var pe=it(O,M,je),Be=B>>>1==1?Fr[pe]:ot[pe];if(M+=Be&15,Be>>>=4,(Be>>>8&255)===0)P[W++]=Be;else{if(Be==256)break;Be-=257;var ze=Be<8?0:Be-4>>2;ze>5&&(ze=0);var $e=W+Z[Be];ze>0&&($e+=it(O,M,ze),M+=ze),pe=it(O,M,fe),Be=B>>>1==1?ie[pe]:mt[pe],M+=Be&15,Be>>>=4;var Ue=Be<4?0:Be-2>>1,Ve=re[Be];for(Ue>0&&(Ve+=it(O,M,Ue),M+=Ue),!V&&ue<$e&&(P=Ft(P,$e+100),ue=P.length);W<$e;)P[W]=P[W-Ve],++W}}}return V?[P,M+7>>>3]:[P.slice(0,W),M+7>>>3]}function Fi(O,V){var M=O.slice(O.l||0),B=Di(M,V);return O.l+=B[1],B[0]}function zs(O,V){if(O)typeof console<"u"&&console.error(V);else throw new Error(V)}function Tn(O,V){var M=O;qr(M,0);var B=[],P=[],W={FileIndex:B,FullPaths:P};N(W,{root:V.root});for(var ue=M.length-4;(M[ue]!=80||M[ue+1]!=75||M[ue+2]!=5||M[ue+3]!=6)&&ue>=0;)--ue;M.l=ue+4,M.l+=4;var je=M.read_shift(2);M.l+=6;var fe=M.read_shift(4);for(M.l=fe,ue=0;ue<je;++ue){M.l+=20;var he=M.read_shift(4),pe=M.read_shift(4),Be=M.read_shift(2),ze=M.read_shift(2),$e=M.read_shift(2);M.l+=8;var Ue=M.read_shift(4),Ve=u(M.slice(M.l+Be,M.l+Be+ze));M.l+=Be+ze+$e;var Ye=M.l;M.l=Ue+4,es(M,he,pe,W,Ve),M.l=Ye}return W}function es(O,V,M,B,P){O.l+=2;var W=O.read_shift(2),ue=O.read_shift(2),je=c(O);if(W&8257)throw new Error("Unsupported ZIP encryption");for(var fe=O.read_shift(4),he=O.read_shift(4),pe=O.read_shift(4),Be=O.read_shift(2),ze=O.read_shift(2),$e="",Ue=0;Ue<Be;++Ue)$e+=String.fromCharCode(O[O.l++]);if(ze){var Ve=u(O.slice(O.l,O.l+ze));(Ve[21589]||{}).mt&&(je=Ve[21589].mt),((P||{})[21589]||{}).mt&&(je=P[21589].mt)}O.l+=ze;var Ye=O.slice(O.l,O.l+he);switch(ue){case 8:Ye=H(O,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var Gt=!1;W&8&&(fe=O.read_shift(4),fe==134695760&&(fe=O.read_shift(4),Gt=!0),he=O.read_shift(4),pe=O.read_shift(4)),he!=V&&zs(Gt,"Bad compressed size: "+V+" != "+he),pe!=M&&zs(Gt,"Bad uncompressed size: "+M+" != "+pe),Mi(B,$e,Ye,{unsafe:!0,mt:je})}function ts(O,V){var M=V||{},B=[],P=[],W=ke(1),ue=M.compression?8:0,je=0,fe=0,he=0,pe=0,Be=0,ze=O.FullPaths[0],$e=ze,Ue=O.FileIndex[0],Ve=[],Ye=0;for(fe=1;fe<O.FullPaths.length;++fe)if($e=O.FullPaths[fe].slice(ze.length),Ue=O.FileIndex[fe],!(!Ue.size||!Ue.content||$e=="Sh33tJ5")){var Gt=pe,$t=ke($e.length);for(he=0;he<$e.length;++he)$t.write_shift(1,$e.charCodeAt(he)&127);$t=$t.slice(0,$t.l),Ve[Be]=EA.buf(Ue.content,0);var Zt=Ue.content;ue==8&&(Zt=I(Zt)),W=ke(30),W.write_shift(4,67324752),W.write_shift(2,20),W.write_shift(2,je),W.write_shift(2,ue),Ue.mt?l(W,Ue.mt):W.write_shift(4,0),W.write_shift(-4,Ve[Be]),W.write_shift(4,Zt.length),W.write_shift(4,Ue.content.length),W.write_shift(2,$t.length),W.write_shift(2,0),pe+=W.length,B.push(W),pe+=$t.length,B.push($t),pe+=Zt.length,B.push(Zt),W=ke(46),W.write_shift(4,33639248),W.write_shift(2,0),W.write_shift(2,20),W.write_shift(2,je),W.write_shift(2,ue),W.write_shift(4,0),W.write_shift(-4,Ve[Be]),W.write_shift(4,Zt.length),W.write_shift(4,Ue.content.length),W.write_shift(2,$t.length),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(4,0),W.write_shift(4,Gt),Ye+=W.l,P.push(W),Ye+=$t.length,P.push($t),++Be}return W=ke(22),W.write_shift(4,101010256),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,Be),W.write_shift(2,Be),W.write_shift(4,Ye),W.write_shift(4,pe),W.write_shift(2,0),Or([Or(B),Or(P),W])}var ta={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function rs(O,V){if(O.ctype)return O.ctype;var M=O.name||"",B=M.match(/\.([^\.]+)$/);return B&&ta[B[1]]||V&&(B=(M=V).match(/[\.\\]([^\.\\])+$/),B&&ta[B[1]])?ta[B[1]]:"application/octet-stream"}function kn(O){for(var V=no(O),M=[],B=0;B<V.length;B+=76)M.push(V.slice(B,B+76));return M.join(`\r
`)+`\r
`}function $l(O){var V=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var pe=he.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],B=V.split(`\r
`),P=0;P<B.length;++P){var W=B[P];if(W.length==0){M.push("");continue}for(var ue=0;ue<W.length;){var je=76,fe=W.slice(ue,ue+je);fe.charAt(je-1)=="="?je--:fe.charAt(je-2)=="="?je-=2:fe.charAt(je-3)=="="&&(je-=3),fe=W.slice(ue,ue+je),ue+=je,ue<W.length&&(fe+="="),M.push(fe)}}return M.join(`\r
`)}function Pe(O){for(var V=[],M=0;M<O.length;++M){for(var B=O[M];M<=O.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+O[++M];V.push(B)}for(var P=0;P<V.length;++P)V[P]=V[P].replace(/[=][0-9A-Fa-f]{2}/g,function(W){return String.fromCharCode(parseInt(W.slice(1),16))});return Na(V.join(`\r
`))}function Za(O,V,M){for(var B="",P="",W="",ue,je=0;je<10;++je){var fe=V[je];if(!fe||fe.match(/^\s*$/))break;var he=fe.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":B=he[2].trim();break;case"content-type":W=he[2].trim();break;case"content-transfer-encoding":P=he[2].trim();break}}switch(++je,P.toLowerCase()){case"base64":ue=Na(Oa(V.slice(je).join("")));break;case"quoted-printable":ue=Pe(V.slice(je));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+P)}var pe=Mi(O,B.slice(M.length),ue,{unsafe:!0});W&&(pe.ctype=W)}function An(O,V){if(K(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=V&&V.root||"",B=(xt&&Buffer.isBuffer(O)?O.toString("binary"):K(O)).split(`\r
`),P=0,W="";for(P=0;P<B.length;++P)if(W=B[P],!!/^Content-Location:/i.test(W)&&(W=W.slice(W.indexOf("file")),M||(M=W.slice(0,W.lastIndexOf("/")+1)),W.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),W.slice(0,M.length)!=M););var ue=(B[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var je="--"+(ue[1]||""),fe=[],he=[],pe={FileIndex:fe,FullPaths:he};N(pe);var Be,ze=0;for(P=0;P<B.length;++P){var $e=B[P];$e!==je&&$e!==je+"--"||(ze++&&Za(pe,B.slice(Be,P),M),Be=P)}return pe}function Gf(O,V){var M=V||{},B=M.boundary||"SheetJS";B="------="+B;for(var P=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],W=O.FullPaths[0],ue=W,je=O.FileIndex[0],fe=1;fe<O.FullPaths.length;++fe)if(ue=O.FullPaths[fe].slice(W.length),je=O.FileIndex[fe],!(!je.size||!je.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ye){return"_x"+Ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ye){return"_u"+Ye.charCodeAt(0).toString(16)+"_"});for(var he=je.content,pe=xt&&Buffer.isBuffer(he)?he.toString("binary"):K(he),Be=0,ze=Math.min(1024,pe.length),$e=0,Ue=0;Ue<=ze;++Ue)($e=pe.charCodeAt(Ue))>=32&&$e<128&&++Be;var Ve=Be>=ze*4/5;P.push(B),P.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+ue),P.push("Content-Transfer-Encoding: "+(Ve?"quoted-printable":"base64")),P.push("Content-Type: "+rs(je,ue)),P.push(""),P.push(Ve?$l(pe):kn(pe))}return P.push(B+`--\r
`),P.join(`\r
`)}function Ao(O){var V={};return N(V,O),V}function Mi(O,V,M,B){var P=B&&B.unsafe;P||N(O);var W=!P&&tt.find(O,V);if(!W){var ue=O.FullPaths[0];V.slice(0,ue.length)==ue?ue=V:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+V).replace("//","/")),W={name:s(V),type:2},O.FileIndex.push(W),O.FullPaths.push(ue),P||tt.utils.cfb_gc(O)}return W.content=M,W.size=M?M.length:0,B&&(B.CLSID&&(W.clsid=B.CLSID),B.mt&&(W.mt=B.mt),B.ct&&(W.ct=B.ct)),W}function jo(O,V){N(O);var M=tt.find(O,V);if(M){for(var B=0;B<O.FileIndex.length;++B)if(O.FileIndex[B]==M)return O.FileIndex.splice(B,1),O.FullPaths.splice(B,1),!0}return!1}function Wl(O,V,M){N(O);var B=tt.find(O,V);if(B){for(var P=0;P<O.FileIndex.length;++P)if(O.FileIndex[P]==B)return O.FileIndex[P].name=s(M),O.FullPaths[P]=M,!0}return!1}function Xl(O){G(O,!0)}return t.find=te,t.read=R,t.parse=p,t.write=Te,t.writeFile=Ee,t.utils={cfb_new:Ao,cfb_add:Mi,cfb_del:jo,cfb_mov:Wl,cfb_gc:Xl,ReadShift:Wc,CheckField:gw,prep_blob:qr,bconcat:Or,use_zlib:C,_deflateRaw:We,_inflateRaw:Fi,consts:le},t})();function SA(e){return typeof e=="string"?Bf(e):Array.isArray(e)?Yk(e):e}function _o(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Bf(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?wn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([SA(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=e,c.href=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=Us(t)),u.write(t),u.close(),t}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+e)}function TA(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function ur(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function N1(e,t){for(var r=[],a=ur(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function Uf(e){for(var t=[],r=ur(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function If(e){for(var t=[],r=ur(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function kA(e){for(var t=[],r=ur(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var Ef=new Date(1899,11,30,0,0,0);function Ar(e,t){var r=e.getTime(),a=Ef.getTime()+(e.getTimezoneOffset()-Ef.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var Ky=new Date,AA=Ef.getTime()+(Ky.getTimezoneOffset()-Ef.getTimezoneOffset())*6e4,C1=Ky.getTimezoneOffset();function Pf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+AA),t.getTimezoneOffset()!==C1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-C1)*6e4),t}function jA(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(r=1,l>3&&(a=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[l],10)}return t}var O1=new Date("2017-02-19T19:06:09.000Z"),Yy=isNaN(O1.getFullYear())?new Date("2/19/17"):O1,NA=Yy.getFullYear()==2017;function Jt(e,t){var r=new Date(e);if(NA)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Yy.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function bi(e,t){if(xt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return wn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return wn(Ly(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return wn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return wn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function Qt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Qt(e[r]));return t}function cr(e,t){for(var r="";r.length<t;)r+=e;return r}function un(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,l){return r=-r,l}),!isNaN(t=Number(a)))?t/r:t}var CA=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ll(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&CA.indexOf(c)==-1)return r}else if(c.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||l>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var OA=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var l=r.split(a),c=[l[0]],u=1;u<l.length;++u)c.push(s),c.push(l[u]);return c}})();function Jy(e){return e?e.content&&e.type?bi(e.content,!0):e.data?Vc(e.data):e.asNodeBuffer&&xt?Vc(e.asNodeBuffer().toString("binary")):e.asBinary?Vc(e.asBinary()):e._data&&e._data.getContent?Vc(bi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Qy(e){if(!e)return null;if(e.data)return _1(e.data);if(e.asNodeBuffer&&xt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?_1(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function RA(e){return e&&e.name.slice(-4)===".bin"?Qy(e):Jy(e)}function Xa(e,t){for(var r=e.FullPaths||ur(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),l=0;l<r.length;++l){var c=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==c||s==c)return e.files?e.files[r[l]]:e.FileIndex[l]}return null}function _m(e,t){var r=Xa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function br(e,t,r){if(!r)return RA(_m(e,t));if(!t)return null;try{return br(e,t)}catch{return null}}function Ca(e,t,r){if(!r)return Jy(_m(e,t));if(!t)return null;try{return Ca(e,t)}catch{return null}}function DA(e,t,r){return Qy(_m(e,t))}function R1(e){for(var t=e.FullPaths||ur(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function gt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return xt?a=Jn(r):a=Jk(r),tt.utils.cfb_add(e,t,a)}tt.utils.cfb_add(e,t,r)}else e.file(t,r)}function ym(){return tt.utils.cfb_new()}function Zy(e,t){switch(t.type){case"base64":return tt.read(e,{type:"base64"});case"binary":return tt.read(e,{type:"binary"});case"buffer":case"array":return tt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function $c(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var pr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,FA=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,D1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,MA=/<[^>]*>/g,ea=pr.match(D1)?D1:MA,BA=/<\w*:/,LA=/<(\/?)\w+:/;function lt(e,t,r){for(var a={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var c=e.match(FA),u=0,h="",m=0,p="",v="",_=1;if(c)for(m=0;m!=c.length;++m){for(v=c[m],l=0;l!=v.length&&v.charCodeAt(l)!==61;++l);for(p=v.slice(0,l).trim();v.charCodeAt(l+1)==32;)++l;for(_=(s=v.charCodeAt(l+1))==34||s==39?1:0,h=v.slice(l+1+_,v.length-_),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),a[p]=h,a[p.toLowerCase()]=h;else{var y=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(a[y]&&p.slice(u-3,u)=="ext")continue;a[y]=h,a[y.toLowerCase()]=h}}return a}function En(e){return e.replace(LA,"<$1")}var ew={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},wm=Uf(ew),jt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(u,h){return ew[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,h){return String.fromCharCode(parseInt(h,16))});var c=s.indexOf("]]>");return r(s.slice(0,l))+s.slice(l+9,c)+r(s.slice(c+3))}})(),bm=/[&<>'"]/g,UA=/[\u0000-\u0008\u000b-\u001f]/g;function It(e){var t=e+"";return t.replace(bm,function(r){return wm[r]}).replace(UA,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function F1(e){return It(e).replace(/ /g,"_x0020_")}var tw=/[\u0000-\u001f]/g;function Em(e){var t=e+"";return t.replace(bm,function(r){return wm[r]}).replace(/\n/g,"<br/>").replace(tw,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function IA(e){var t=e+"";return t.replace(bm,function(r){return wm[r]}).replace(tw,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var M1=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function PA(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Yt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function hh(e){for(var t="",r=0,a=0,s=0,l=0,c=0,u=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){c=(a&31)<<6,c|=s&63,t+=String.fromCharCode(c);continue}if(l=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|l&63);continue}c=e.charCodeAt(r++),u=((a&7)<<18|(s&63)<<12|(l&63)<<6|c&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function B1(e){var t=Fs(2*e.length),r,a,s=1,l=0,c=0,u;for(a=0;a<e.length;a+=s)s=1,(u=e.charCodeAt(a))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(a+1)&63),s=2):u<240?(r=(u&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(u&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,c=55296+(r>>>10&1023),r=56320+(r&1023)),c!==0&&(t[l++]=c&255,t[l++]=c>>>8,c=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function L1(e){return Jn(e,"binary").toString("utf8")}var Qu="foo bar baz",qt=xt&&(L1(Qu)==hh(Qu)&&L1||B1(Qu)==hh(Qu)&&B1)||hh,wn=xt?function(e){return Jn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},io=(function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),rw=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}})(),zA=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),HA=/<\/?(?:vt:)?variant>/g,qA=/<(?:vt:)([^>]*)>([\s\S]*)</;function U1(e,t){var r=lt(e),a=e.match(zA(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(l){var c=l.replace(HA,"").match(qA);c&&s.push({v:qt(c[2]),t:c[1]})}),s}var aw=/(^\s|\s$|\n)/;function Vr(e,t){return"<"+e+(t.match(aw)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function lo(e){return ur(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function He(e,t,r){return"<"+e+(r!=null?lo(r):"")+(t!=null?(t.match(aw)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Vh(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function VA(e,t){switch(typeof e){case"string":var r=He("vt:lpwstr",It(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return He((e|0)==e?"vt:i4":"vt:r8",It(String(e)));case"boolean":return He("vt:bool",e?"true":"false")}if(e instanceof Date)return He("vt:filetime",Vh(e));throw new Error("Unable to serialize "+e)}function Sm(e){if(xt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return qt(Us(gm(e)));throw new Error("Bad input format: expected Buffer or string")}var co=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,kr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ai=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ta={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function GA(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,l=5;l>=0;--l)s=s*256+e[t+l];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function $A(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,l=0,c=a?-t:t;isFinite(c)?c==0?s=l=0:(s=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)e[r+u]=l&255;e[r+6]=(s&15)<<4|l&15,e[r+7]=s>>4|a}var I1=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,l=e[0][a].length;s<l;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},P1=xt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Jn(t)})):I1(e)}:I1,z1=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode($n(e,s)));return a.join("").replace(sa,"")},Tm=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(sa,""):z1(e,t,r)}:z1,H1=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},nw=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):H1(e,t,r)}:H1,q1=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(Tl(e,s)));return a.join("")},yo=xt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):q1(t,r,a)}:q1,sw=function(e,t){var r=ka(e,t);return r>0?yo(e,t+4,t+4+r-1):""},iw=sw,lw=function(e,t){var r=ka(e,t);return r>0?yo(e,t+4,t+4+r-1):""},cw=lw,ow=function(e,t){var r=2*ka(e,t);return r>0?yo(e,t+4,t+4+r-1):""},uw=ow,fw=function(t,r){var a=ka(t,r);return a>0?Tm(t,r+4,r+4+a):""},dw=fw,hw=function(e,t){var r=ka(e,t);return r>0?yo(e,t+4,t+4+r):""},mw=hw,pw=function(e,t){return GA(e,t)},Sf=pw,km=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};xt&&(iw=function(t,r){if(!Buffer.isBuffer(t))return sw(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},cw=function(t,r){if(!Buffer.isBuffer(t))return lw(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},uw=function(t,r){if(!Buffer.isBuffer(t))return ow(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},dw=function(t,r){if(!Buffer.isBuffer(t))return fw(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},mw=function(t,r){if(!Buffer.isBuffer(t))return hw(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Sf=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):pw(t,r)},km=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Tl=function(e,t){return e[t]},$n=function(e,t){return e[t+1]*256+e[t]},WA=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ka=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},di=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},XA=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Wc(e,t){var r="",a,s,l=[],c,u,h,m;switch(t){case"dbcs":if(m=this.l,xt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)r+=String.fromCharCode($n(this,m)),m+=2;e*=2;break;case"utf8":r=yo(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Tm(this,this.l,this.l+e);break;case"wstr":return Wc.call(this,e,"dbcs");case"lpstr-ansi":r=iw(this,this.l),e=4+ka(this,this.l);break;case"lpstr-cp":r=cw(this,this.l),e=4+ka(this,this.l);break;case"lpwstr":r=uw(this,this.l),e=4+2*ka(this,this.l);break;case"lpp4":e=4+ka(this,this.l),r=dw(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ka(this,this.l),r=mw(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(c=Tl(this,this.l+e++))!==0;)l.push(Ju(c));r=l.join("");break;case"_wstr":for(e=0,r="";(c=$n(this,this.l+e))!==0;)l.push(Ju(c)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",m=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return c=Tl(this,m),this.l=m+1,u=Wc.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(Ju($n(this,m))),m+=2}r=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",m=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return c=Tl(this,m),this.l=m+1,u=Wc.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(Ju(Tl(this,m))),m+=1}r=l.join("");break;default:switch(e){case 1:return a=Tl(this,this.l),this.l++,a;case 2:return a=(t==="i"?WA:$n)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?di:XA)(this,this.l),this.l+=4,a):(s=ka(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Sf(this,this.l):s=Sf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=nw(this,this.l,e);break}}return this.l+=e,r}var KA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},YA=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},JA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function QA(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)JA(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var c=t.charCodeAt(s);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,KA(this,t,this.l);break;case 8:if(a=8,r==="f"){$A(this,t,this.l);break}case 16:break;case-4:a=4,YA(this,t,this.l);break}return this.l+=a,this}function gw(e,t){var r=nw(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function qr(e,t){e.l=t,e.read_shift=Wc,e.chk=gw,e.write_shift=QA}function Zr(e,t){e.l+=t}function ke(e){var t=Fs(e);return qr(t,0),t}function Qn(e,t,r){if(e){var a,s,l;qr(e,e.l||0);for(var c=e.length,u=0,h=0;e.l<c;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var m=po[u]||po[65535];for(a=e.read_shift(1),l=a&127,s=1;s<4&&a&128;++s)l+=((a=e.read_shift(1))&127)<<7*s;h=e.l+l;var p=m.f&&m.f(e,l,r);if(e.l=h,t(p,m,u))return}}}function ga(){var e=[],t=xt?256:2048,r=function(m){var p=ke(m);return qr(p,0),p},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},l=function(m){return a&&m<a.length-a.l?a:(s(),a=r(Math.max(m+1,t)))},c=function(){return s(),Or(e)},u=function(m){s(),a=m,a.l==null&&(a.l=a.length),l(t)};return{next:l,push:u,end:c,_bufs:e}}function Fe(e,t,r,a){var s=+t,l;if(!isNaN(s)){a||(a=po[s].p||(r||[]).length||0),l=1+(s>=128?1:0)+1,a>=128&&++l,a>=16384&&++l,a>=2097152&&++l;var c=e.next(l);s<=127?c.write_shift(1,s):(c.write_shift(1,(s&127)+128),c.write_shift(1,s>>7));for(var u=0;u!=4;++u)if(a>=128)c.write_shift(1,(a&127)+128),a>>=7;else{c.write_shift(1,a);break}a>0&&km(r)&&e.push(r)}}function Xc(e,t,r){var a=Qt(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function V1(e,t,r){var a=Qt(e);return a.s=Xc(a.s,t.s,r),a.e=Xc(a.e,t.s,r),a}function Kc(e,t){if(e.cRel&&e.c<0)for(e=Qt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Qt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=st(e);return!e.cRel&&e.cRel!=null&&(r=tj(r)),!e.rRel&&e.rRel!=null&&(r=ZA(r)),r}function mh(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+nr(e.s.c)+":"+(e.e.cRel?"":"$")+nr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+mr(e.s.r)+":"+(e.e.rRel?"":"$")+mr(e.e.r):Kc(e.s,t.biff)+":"+Kc(e.e,t.biff)}function Am(e){return parseInt(ej(e),10)-1}function mr(e){return""+(e+1)}function ZA(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function ej(e){return e.replace(/\$(\d+)$/,"$1")}function jm(e){for(var t=rj(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function nr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function tj(e){return e.replace(/^([A-Z])/,"$$$1")}function rj(e){return e.replace(/^\$([A-Z])/,"$1")}function aj(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function sr(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function st(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function xa(e){var t=e.indexOf(":");return t==-1?{s:sr(e),e:sr(e)}:{s:sr(e.slice(0,t)),e:sr(e.slice(t+1))}}function dt(e,t){return typeof t>"u"||typeof t=="number"?dt(e.s,e.e):(typeof e!="string"&&(e=st(e)),typeof t!="string"&&(t=st(t)),e==t?e:e+":"+t)}function Nt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,l=e.length;for(r=0;a<l&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<l&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===l||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=l&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=l&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function G1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ja(e.z,r?Ar(t):t)}catch{}try{return e.w=Ja((e.XF||{}).numFmtId||(r?14:0),r?Ar(t):t)}catch{return""+t}}function Yn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Zn[e.v]||e.v:t==null?G1(e,e.v):G1(e,t))}function Is(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function xw(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,l=e||(s?[]:{}),c=0,u=0;if(l&&a.origin!=null){if(typeof a.origin=="number")c=a.origin;else{var h=typeof a.origin=="string"?sr(a.origin):a.origin;c=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=Nt(l["!ref"]);m.s.c=p.s.c,m.s.r=p.s.r,m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),c==-1&&(m.e.r=c=p.e.r+1)}for(var v=0;v!=t.length;++v)if(t[v]){if(!Array.isArray(t[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=t[v].length;++_)if(!(typeof t[v][_]>"u")){var y={v:t[v][_]},b=c+v,w=u+_;if(m.s.r>b&&(m.s.r=b),m.s.c>w&&(m.s.c=w),m.e.r<b&&(m.e.r=b),m.e.c<w&&(m.e.c=w),t[v][_]&&typeof t[v][_]=="object"&&!Array.isArray(t[v][_])&&!(t[v][_]instanceof Date))y=t[v][_];else if(Array.isArray(y.v)&&(y.f=t[v][_][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(a.nullError)y.t="e",y.v=0;else if(a.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=a.dateNF||nt[14],a.cellDates?(y.t="d",y.w=Ja(y.z,Ar(y.v))):(y.t="n",y.v=Ar(y.v),y.w=Ja(y.z,y.v))):y.t="s";if(s)l[b]||(l[b]=[]),l[b][w]&&l[b][w].z&&(y.z=l[b][w].z),l[b][w]=y;else{var E=st({c:w,r:b});l[E]&&l[E].z&&(y.z=l[E].z),l[E]=y}}}return m.s.c<1e7&&(l["!ref"]=dt(m)),l}function Vl(e,t){return xw(null,e,t)}function nj(e){return e.read_shift(4,"i")}function fn(e,t){return t||(t=ke(4)),t.write_shift(4,e),t}function Qr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Rr(e,t){var r=!1;return t==null&&(r=!0,t=ke(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function sj(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ij(e,t){return t||(t=ke(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Nm(e,t){var r=e.l,a=e.read_shift(1),s=Qr(e),l=[],c={t:s,h:s};if((a&1)!==0){for(var u=e.read_shift(4),h=0;h!=u;++h)l.push(sj(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=r+t,c}function lj(e,t){var r=!1;return t==null&&(r=!0,t=ke(15+4*e.t.length)),t.write_shift(1,0),Rr(e.t,t),r?t.slice(0,t.l):t}var cj=Nm;function oj(e,t){var r=!1;return t==null&&(r=!0,t=ke(23+4*e.t.length)),t.write_shift(1,1),Rr(e.t,t),t.write_shift(4,1),ij({},t),r?t.slice(0,t.l):t}function Qa(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ji(e,t){return t==null&&(t=ke(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ni(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ci(e,t){return t==null&&(t=ke(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var uj=Qr,vw=Rr;function Cm(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Tf(e,t){var r=!1;return t==null&&(r=!0,t=ke(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var fj=Qr,Gh=Cm,Om=Tf;function Rm(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?Sf([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):di(t,0)>>2;return r?s/100:s}function _w(e,t){t==null&&(t=ke(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function yw(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function dj(e,t){return t||(t=ke(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Oi=yw,Gl=dj;function Jr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ei(e,t){return(t||ke(8)).write_shift(8,e,"f")}function hj(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),u=e.read_shift(1),h=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var m=xi[s];m&&(t.rgb=uo(m));break;case 2:t.rgb=uo([c,u,h]);break;case 3:t.theme=s;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function kf(e,t){if(t||(t=ke(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function mj(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function pj(e,t){t||(t=ke(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function ww(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function gj(e){return ww(e,1)}function xj(e){return ww(e,2)}var Dm=2,pa=3,Zu=11,$1=12,Af=19,ef=64,vj=65,_j=71,yj=4108,wj=4126,Cr=80,bw=81,bj=[Cr,bw],$h={1:{n:"CodePage",t:Dm},2:{n:"Category",t:Cr},3:{n:"PresentationFormat",t:Cr},4:{n:"ByteCount",t:pa},5:{n:"LineCount",t:pa},6:{n:"ParagraphCount",t:pa},7:{n:"SlideCount",t:pa},8:{n:"NoteCount",t:pa},9:{n:"HiddenCount",t:pa},10:{n:"MultimediaClipCount",t:pa},11:{n:"ScaleCrop",t:Zu},12:{n:"HeadingPairs",t:yj},13:{n:"TitlesOfParts",t:wj},14:{n:"Manager",t:Cr},15:{n:"Company",t:Cr},16:{n:"LinksUpToDate",t:Zu},17:{n:"CharacterCount",t:pa},19:{n:"SharedDoc",t:Zu},22:{n:"HyperlinksChanged",t:Zu},23:{n:"AppVersion",t:pa,p:"version"},24:{n:"DigSig",t:vj},26:{n:"ContentType",t:Cr},27:{n:"ContentStatus",t:Cr},28:{n:"Language",t:Cr},29:{n:"Version",t:Cr},255:{},2147483648:{n:"Locale",t:Af},2147483651:{n:"Behavior",t:Af},1919054434:{}},Wh={1:{n:"CodePage",t:Dm},2:{n:"Title",t:Cr},3:{n:"Subject",t:Cr},4:{n:"Author",t:Cr},5:{n:"Keywords",t:Cr},6:{n:"Comments",t:Cr},7:{n:"Template",t:Cr},8:{n:"LastAuthor",t:Cr},9:{n:"RevNumber",t:Cr},10:{n:"EditTime",t:ef},11:{n:"LastPrinted",t:ef},12:{n:"CreatedDate",t:ef},13:{n:"ModifiedDate",t:ef},14:{n:"PageCount",t:pa},15:{n:"WordCount",t:pa},16:{n:"CharCount",t:pa},17:{n:"Thumbnail",t:_j},18:{n:"Application",t:Cr},19:{n:"DocSecurity",t:pa},255:{},2147483648:{n:"Locale",t:Af},2147483651:{n:"Behavior",t:Af},1919054434:{}},W1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Ej=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Sj(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Tj=Sj([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),xi=Qt(Tj),Zn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ew={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Xh={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},tf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Fm(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function kj(e){var t=Fm();if(!e||!e.match)return t;var r={};if((e.match(ea)||[]).forEach(function(a){var s=lt(a);switch(s[0].replace(BA,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Xh[s.ContentType]]!==void 0&&t[Xh[s.ContentType]].push(s.PartName);break}}),t.xmlns!==kr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Sw(e,t){var r=kA(Xh),a=[],s;a[a.length]=pr,a[a.length]=He("Types",null,{xmlns:kr.CT,"xmlns:xsd":kr.xsd,"xmlns:xsi":kr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return He("Default",null,{Extension:h[0],ContentType:h[1]})}));var l=function(h){e[h]&&e[h].length>0&&(s=e[h][0],a[a.length]=He("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:tf[h][t.bookType]||tf[h].xlsx}))},c=function(h){(e[h]||[]).forEach(function(m){a[a.length]=He("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:tf[h][t.bookType]||tf[h].xlsx})})},u=function(h){(e[h]||[]).forEach(function(m){a[a.length]=He("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:r[h][0]})})};return l("workbooks"),c("sheets"),c("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),c("metadata"),u("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var vt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function oo(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Yc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(ea)||[]).forEach(function(s){var l=lt(s);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:$c(l.Target,t);r[u]=c,a[l.Id]=c}}),r["!id"]=a,r}function Ol(e){var t=[pr,He("Relationships",null,{xmlns:kr.RELS})];return ur(e["!id"]).forEach(function(r){t[t.length]=He("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ut(e,t,r,a,s,l){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[vt.HLINK,vt.XPATH,vt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var Aj="application/vnd.oasis.opendocument.spreadsheet";function jj(e,t){for(var r=Sm(e),a,s;a=co.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=lt(a[0],!1),s.path=="/"&&s.type!==Aj)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function Nj(e){var t=[pr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function X1(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Cj(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Oj(e){var t=[pr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(X1(e[r][0],e[r][1])),t.push(Cj("",e[r][0]));return t.push(X1("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Tw(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+_f.version+"</meta:generator></office:meta></office:document-meta>"}var Ya=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Rj=(function(){for(var e=new Array(Ya.length),t=0;t<Ya.length;++t){var r=Ya[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function kw(e){var t={};e=qt(e);for(var r=0;r<Ya.length;++r){var a=Ya[r],s=e.match(Rj[r]);s!=null&&s.length>0&&(t[a[1]]=jt(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Jt(t[a[1]]))}return t}function ph(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=It(t),a[a.length]=r?He(e,t,r):Vr(e,t))}function Aw(e,t){var r=t||{},a=[pr,He("cp:coreProperties",null,{"xmlns:cp":kr.CORE_PROPS,"xmlns:dc":kr.dc,"xmlns:dcterms":kr.dcterms,"xmlns:dcmitype":kr.dcmitype,"xmlns:xsi":kr.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&ph("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Vh(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&ph("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Vh(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var l=0;l!=Ya.length;++l){var c=Ya[l],u=r.Props&&r.Props[c[1]]!=null?r.Props[c[1]]:e?e[c[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&ph(c[0],u,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var vi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],jw=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Nw(e,t,r,a){var s=[];if(typeof e=="string")s=U1(e,a);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(p){return{v:p}}));var c=typeof t=="string"?U1(t,a).map(function(p){return p.v}):t,u=0,h=0;if(c.length>0)for(var m=0;m!==s.length;m+=2){switch(h=+s[m+1].v,s[m].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=c.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=c.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=c.slice(u,u+h);break}u+=h}}function Dj(e,t,r){var a={};return t||(t={}),e=qt(e),vi.forEach(function(s){var l=(e.match(io(s[0]))||[])[1];switch(s[2]){case"string":l&&(t[s[1]]=jt(l));break;case"bool":t[s[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));c&&c.length>0&&(a[s[1]]=c[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&Nw(a.HeadingPairs,a.TitlesOfParts,t,r),t}function Cw(e){var t=[],r=He;return e||(e={}),e.Application="SheetJS",t[t.length]=pr,t[t.length]=He("Properties",null,{xmlns:kr.EXT_PROPS,"xmlns:vt":kr.vt}),vi.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=It(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+It(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Fj=/<[^>]+>[^<]*/g;function Mj(e,t){var r={},a="",s=e.match(Fj);if(s)for(var l=0;l!=s.length;++l){var c=s[l],u=lt(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":a=jt(u.name);break;case"</property>":a=null;break;default:if(c.indexOf("<vt:")===0){var h=c.split(">"),m=h[0].slice(4),p=h[1];switch(m){case"lpstr":case"bstr":case"lpwstr":r[a]=jt(p);break;case"bool":r[a]=Yt(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(p);break;case"filetime":case"date":r[a]=Jt(p);break;case"cy":case"error":r[a]=jt(p);break;default:if(m.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",c,m,h)}}else if(c.slice(0,2)!=="</"){if(t.WTF)throw new Error(c)}}}return r}function Ow(e){var t=[pr,He("Properties",null,{xmlns:kr.CUST_PROPS,"xmlns:vt":kr.vt})];if(!e)return t.join("");var r=1;return ur(e).forEach(function(s){++r,t[t.length]=He("property",VA(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:It(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Kh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},gh;function Bj(e,t,r){gh||(gh=Uf(Kh)),t=gh[t]||t,e[t]=r}function Lj(e,t){var r=[];return ur(Kh).map(function(a){for(var s=0;s<Ya.length;++s)if(Ya[s][1]==a)return Ya[s];for(s=0;s<vi.length;++s)if(vi[s][1]==a)return vi[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Vr(Kh[a[1]]||a[1],s))}}),He("DocumentProperties",r.join(""),{xmlns:Ta.o})}function Uj(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&ur(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var c=0;c<Ya.length;++c)if(l==Ya[c][1])return;for(c=0;c<vi.length;++c)if(l==vi[c][1])return;for(c=0;c<r.length;++c)if(l==r[c])return;var u=e[l],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),s.push(He(F1(l),u,{"dt:dt":h}))}}),t&&ur(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var c=t[l],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c instanceof Date?(u="dateTime.tz",c=c.toISOString()):c=String(c),s.push(He(F1(l),c,{"dt:dt":u}))}}),"<"+a+' xmlns="'+Ta.o+'">'+s.join("")+"</"+a+">"}function Mm(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Ij(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var l=a/Math.pow(2,32)|0;l>0&&(a=a%Math.pow(2,32),s+=l);var c=ke(8);return c.write_shift(4,a),c.write_shift(4,s),c}function Rw(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function Dw(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function Fw(e,t,r){return t===31?Dw(e):Rw(e,t,r)}function Yh(e,t,r){return Fw(e,t,r===!1?0:4)}function Pj(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Fw(e,t,0)}function zj(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(sa,""),e.l-s&2&&(e.l+=2)}return r}function Hj(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(sa,"");return r}function qj(e){var t=e.l,r=jf(e,bw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=jf(e,pa);return[r,a]}function Vj(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(qj(e));return r}function K1(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var l=e.read_shift(4),c=e.read_shift(4);a[l]=e.read_shift(c,t===1200?"utf16le":"utf8").replace(sa,"").replace(Gc,"!"),t===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function Mw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Gj(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function jf(e,t,r){var a=e.read_shift(2),s,l=r||{};if(e.l+=2,t!==$1&&a!==t&&bj.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===$1?a:t){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Rw(e,a,4).replace(sa,"");case 31:return Dw(e);case 64:return Mm(e);case 65:return Mw(e);case 71:return Gj(e);case 80:return Yh(e,a,!l.raw).replace(sa,"");case 81:return Pj(e,a).replace(sa,"");case 4108:return Vj(e);case 4126:case 4127:return a==4127?zj(e):Hj(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Y1(e,t){var r=ke(4),a=ke(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=ke(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=Ij(t);break;case 31:case 80:for(a=ke(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Or([r,a])}function J1(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),l=[],c=0,u=0,h=-1,m={};for(c=0;c!=s;++c){var p=e.read_shift(4),v=e.read_shift(4);l[c]=[p,v+r]}l.sort(function(A,S){return A[1]-S[1]});var _={};for(c=0;c!=s;++c){if(e.l!==l[c][1]){var y=!0;if(c>0&&t)switch(t[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,y=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],y=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],y=!1);break}if((!t||c==0)&&e.l<=l[c][1]&&(y=!1,e.l=l[c][1]),y)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(t){var b=t[l[c][0]];if(_[b.n]=jf(e,b.t,{raw:!0}),b.p==="version"&&(_[b.n]=String(_[b.n]>>16)+"."+("0000"+String(_[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(_[b.n]){case 0:_[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:cn(u=_[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[b.n])}}else if(l[c][0]===1){if(u=_.CodePage=jf(e,Dm),cn(u),h!==-1){var w=e.l;e.l=l[h][1],m=K1(e,u),e.l=w}}else if(l[c][0]===0){if(u===0){h=c,e.l=l[c+1][1];continue}m=K1(e,u)}else{var E=m[l[c][0]],k;switch(e[e.l]){case 65:e.l+=4,k=Mw(e);break;case 30:e.l+=4,k=Yh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=Yh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=hr(e,4);break;case 64:e.l+=4,k=Jt(Mm(e));break;default:throw new Error("unparsed value: "+e[e.l])}_[E]=k}}return e.l=r+a,_}var Bw=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function $j(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Q1(e,t,r){var a=ke(8),s=[],l=[],c=8,u=0,h=ke(8),m=ke(8);if(h.write_shift(4,2),h.write_shift(4,1200),m.write_shift(4,1),l.push(h),s.push(m),c+=8+h.length,!t){m=ke(8),m.write_shift(4,0),s.unshift(m);var p=[ke(4)];for(p[0].write_shift(4,e.length),u=0;u<e.length;++u){var v=e[u][0];for(h=ke(8+2*(v.length+1)+(v.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,v.length+1),h.write_shift(0,v,"dbcs");h.l!=h.length;)h.write_shift(1,0);p.push(h)}h=Or(p),l.unshift(h),c+=8+h.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(Bw.indexOf(e[u][0])>-1||jw.indexOf(e[u][0])>-1)&&e[u][1]!=null){var _=e[u][1],y=0;if(t){y=+t[e[u][0]];var b=r[y];if(b.p=="version"&&typeof _=="string"){var w=_.split(".");_=(+w[0]<<16)+(+w[1]||0)}h=Y1(b.t,_)}else{var E=$j(_);E==-1&&(E=31,_=String(_)),h=Y1(E,_)}l.push(h),m=ke(8),m.write_shift(4,t?y:2+u),s.push(m),c+=8+h.length}var k=8*(l.length+1);for(u=0;u<l.length;++u)s[u].write_shift(4,k),k+=l[u].length;return a.write_shift(4,c),a.write_shift(4,l.length),Or([a].concat(s).concat(l))}function Z1(e,t,r){var a=e.content;if(!a)return{};qr(a,0);var s,l,c,u,h=0;a.chk("feff","Byte Order: "),a.read_shift(2);var m=a.read_shift(4),p=a.read_shift(16);if(p!==tt.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=a.read_shift(16),u=a.read_shift(4),s===1&&u!==a.l)throw new Error("Length mismatch: "+u+" !== "+a.l);s===2&&(c=a.read_shift(16),h=a.read_shift(4));var v=J1(a,t),_={SystemIdentifier:m};for(var y in v)_[y]=v[y];if(_.FMTID=l,s===1)return _;if(h-a.l==2&&(a.l+=2),a.l!==h)throw new Error("Length mismatch 2: "+a.l+" !== "+h);var b;try{b=J1(a,null)}catch{}for(y in b)_[y]=b[y];return _.FMTID=[l,c],_}function e_(e,t,r,a,s,l){var c=ke(s?68:48),u=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,tt.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,s?2:1),c.write_shift(16,t,"hex"),c.write_shift(4,s?68:48);var h=Q1(e,r,a);if(u.push(h),s){var m=Q1(s,null,null);c.write_shift(16,l,"hex"),c.write_shift(4,68+h.length),u.push(m)}return Or(u)}function As(e,t){return e.read_shift(t),null}function Wj(e,t){t||(t=ke(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Xj(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function hr(e,t){return e.read_shift(t)===1}function na(e,t){return t||(t=ke(2)),t.write_shift(2,+!!e),t}function Er(e){return e.read_shift(2,"u")}function Ka(e,t){return t||(t=ke(2)),t.write_shift(2,e),t}function Lw(e,t){return Xj(e,t,Er)}function Kj(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Uw(e,t,r){return r||(r=ke(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function wo(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var c=a?e.read_shift(a,s):"";return c}function Yj(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,l=1+(r&1),c=0,u,h={};s&&(c=e.read_shift(2)),a&&(u=e.read_shift(4));var m=l==2?"dbcs-cont":"sbcs-cont",p=t===0?"":e.read_shift(t,m);return s&&(e.l+=4*c),a&&(e.l+=u),h.t=p,s||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function Jj(e){var t=e.t||"",r=ke(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=ke(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return Or(s)}function Si(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function bo(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Si(e,a,r)}function Ri(e,t,r){if(r.biff>5)return bo(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Iw(e,t,r){return r||(r=ke(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Qj(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Zj(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(sa,"");return a&&(e.l+=24),s}function e4(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace(sa,"");return r+c}function t4(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Zj(e);case"0303000000000000c000000000000046":return e4(e);default:throw new Error("Unsupported Moniker "+r)}}function rf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(sa,""):"";return r}function t_(e,t){t||(t=ke(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function r4(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var l,c,u,h,m="",p,v;s&16&&(l=rf(e,r-e.l)),s&128&&(c=rf(e,r-e.l)),(s&257)===257&&(u=rf(e,r-e.l)),(s&257)===1&&(h=t4(e,r-e.l)),s&8&&(m=rf(e,r-e.l)),s&32&&(p=e.read_shift(16)),s&64&&(v=Mm(e)),e.l=r;var _=c||u||h||"";_&&m&&(_+="#"+m),_||(_="#"+m),s&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var y={Target:_};return p&&(y.guid=p),v&&(y.time=v),l&&(y.Tooltip=l),y}function a4(e){var t=ke(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),l=s>-1?31:23;switch(a.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var c=[8,6815827,6619237,4849780,83];for(r=0;r<c.length;++r)t.write_shift(4,c[r]);if(l==28)a=a.slice(1),t_(a,t);else if(l&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<c.length;++r)t.write_shift(1,parseInt(c[r],16));var u=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),l&8&&t_(s>-1?a.slice(s+1):"",t)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<c.length;++r)t.write_shift(1,parseInt(c[r],16));for(var h=0;a.slice(h*3,h*3+3)=="../"||a.slice(h*3,h*3+3)=="..\\";)++h;for(t.write_shift(2,h),t.write_shift(4,a.length-3*h+1),r=0;r<a.length-3*h;++r)t.write_shift(1,a.charCodeAt(r+3*h)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Pw(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function zw(e,t){var r=Pw(e);return r[3]=0,r}function Sn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Ti(e,t,r,a){return a||(a=ke(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function n4(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function s4(e,t,r){return t===0?"":Ri(e,t,r)}function i4(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),l=e.read_shift(a,"i"),c=e.read_shift(a,"i");return[s,l,c]}function Hw(e){var t=e.read_shift(2),r=Rm(e);return[t,r]}function l4(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=wo(e,t,r),l=e.read_shift(2);if(a-=e.l,l!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+l);return e.l+=l,s}function zf(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function qw(e,t){return t||(t=ke(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Vw(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var c4=Vw;function Gw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function o4(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function u4(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Wr(e){e.l+=2,e.l+=e.read_shift(2)}var f4={0:Wr,4:Wr,5:Wr,6:Wr,7:u4,8:Wr,9:Wr,10:Wr,11:Wr,12:Wr,13:o4,14:Wr,15:Wr,16:Wr,17:Wr,18:Wr,19:Wr,20:Wr,21:Gw};function d4(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(f4[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function af(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Bm(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=ke(s);return l.write_shift(2,a),l.write_shift(2,t),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function h4(e,t){return t===0||e.read_shift(2),1200}function m4(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=Ri(e,0,r);return e.read_shift(t+a-e.l),s}function p4(e,t){var r=!t||t.biff==8,a=ke(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function g4(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function x4(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=wo(e,0,r);return c.length===0&&(c="Sheet1"),{pos:a,hs:s,dt:l,name:c}}function v4(e,t){var r=!t||t.biff>=8?2:1,a=ke(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function _4(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),l=[],c=0;c!=s&&e.l<r;++c)l.push(Yj(e));return l.Count=a,l.Unique=s,l}function y4(e,t){var r=ke(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=Jj(e[s]);var l=Or([r].concat(a));return l.parts=[r.length].concat(a.map(function(c){return c.length})),l}function w4(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function b4(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function E4(e){var t=n4(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function S4(e){return e.read_shift(2),e.read_shift(4)}function r_(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var l={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[l,s]}function T4(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2),m=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:l,CurTab:c,FirstTab:u,Selected:h,TabRatio:m}}function k4(){var e=ke(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function A4(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function j4(e){var t=ke(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function N4(){}function C4(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=wo(e,0,r),a}function O4(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,l=ke(s);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),a||l.write_shift(1,1),l.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),l}function R4(e){var t=Sn(e);return t.isst=e.read_shift(4),t}function D4(e,t,r,a){var s=ke(10);return Ti(e,t,a,s),s.write_shift(4,r),s}function F4(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=Sn(e);r.biff==2&&e.l++;var l=bo(e,a-e.l,r);return s.val=l,s}function M4(e,t,r,a,s){var l=!s||s.biff==8,c=ke(8+ +l+(1+l)*r.length);return Ti(e,t,a,c),c.write_shift(2,r.length),l&&c.write_shift(1,1),c.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),c}function B4(e,t,r){var a=e.read_shift(2),s=Ri(e,0,r);return[a,s]}function L4(e,t,r,a){var s=r&&r.biff==5;a||(a=ke(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var l=a.length>a.l?a.slice(0,a.l):a;return l.l==null&&(l.l=l.length),l}var U4=Ri;function a_(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,l=e.read_shift(s),c=e.read_shift(s),u=e.read_shift(2),h=e.read_shift(2);return e.l=a,{s:{r:l,c:u},e:{r:c,c:h}}}function I4(e,t){var r=t.biff==8||!t.biff?4:2,a=ke(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function P4(e){var t=e.read_shift(2),r=e.read_shift(2),a=Hw(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function z4(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(Hw(e));if(e.l!==r)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:c,rkrec:l}}function H4(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:c,ixfe:l}}function q4(e,t,r,a){var s={},l=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2);return s.patternType=Ej[u>>26],a.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=c&15,s.dgRight=c>>4&15,s.dgTop=c>>8&15,s.dgBottom=c>>12&15,s.icvLeft=c>>16&127,s.icvRight=c>>23&127,s.grbitDiag=c>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=h&127,s.icvBack=h>>7&127,s.fsxButton=h>>14&1),s}function V4(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=q4(e,t,a.fStyle,r),a}function n_(e,t,r,a){var s=r&&r.biff==5;a||(a=ke(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&s&&(l|=1024),a.write_shift(4,l),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function G4(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function $4(e){var t=ke(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function s_(e,t,r){var a=Sn(e);(r.biff==2||t==9)&&++e.l;var s=Kj(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function W4(e,t,r,a,s,l){var c=ke(8);return Ti(e,t,a,c),Uw(r,l,c),c}function X4(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Sn(e),s=Jr(e);return a.val=s,a}function K4(e,t,r,a){var s=ke(14);return Ti(e,t,a,s),Ei(r,s),s}var i_=s4;function Y4(e,t,r){var a=e.l+t,s=e.read_shift(2),l=e.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=Si(e,l),u=[];a>e.l;)u.push(bo(e));return[l,s,c,u]}function l_(e,t,r){var a=e.read_shift(2),s,l={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=l4(e,t-2,r)),l.body=s||e.read_shift(t-2),typeof s=="string"&&(l.Name=s),l}var J4=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function c_(e,t,r){var a=e.l+t,s=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),h=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var m=Si(e,c,r);s&32&&(m=J4[m.charCodeAt(0)]);var p=a-e.l;r&&r.biff==2&&--p;var v=a==e.l||u===0||!(p>0)?[]:d8(e,p,r,u);return{chKey:l,Name:m,itab:h,rgce:v}}function $w(e,t,r){if(r.biff<8)return Q4(e,t,r);for(var a=[],s=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)a.push(i4(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function Q4(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=wo(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function Z4(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),l=Si(e,a,r),c=Si(e,s,r);return[l,c]}function eN(e,t,r){var a=Vw(e);e.l++;var s=e.read_shift(1);return t-=8,[h8(e,t,r),s,a]}function o_(e,t,r){var a=c4(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,u8(e,t,r)]}function tN(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function rN(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=Ri(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},u,c,l]}}function aN(e,t,r){return rN(e,t,r)}function nN(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(zf(e));return r}function sN(e){var t=ke(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)qw(e[r],t);return t}function iN(e,t,r){if(r&&r.biff<8)return cN(e,t,r);var a=Gw(e),s=d4(e,t-22,a[1]);return{cmo:a,ft:s}}var lN={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function cN(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var c=[];return c.push((lN[a]||Zr)(e,t,r)),{cmo:[s,a,l],ft:c}}function oN(e,t,r){var a=e.l,s="";try{e.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=Qj(e,6,r);var u=e.read_shift(2);e.read_shift(2),Er(e,2);var h=e.read_shift(2);e.l+=h;for(var m=1;m<e.lens.length-1;++m){if(e.l-a!=e.lens[m])throw new Error("TxO: bad continue record");var p=e[e.l],v=Si(e,e.lens[m+1]-e.lens[m]-1);if(s+=v,s.length>=(p?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function uN(e,t){var r=zf(e);e.l+=16;var a=r4(e,t-24);return[r,a]}function fN(e){var t=ke(24),r=sr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return Or([t,a4(e[1])])}function dN(e,t){e.read_shift(2);var r=zf(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(sa,""),[r,a]}function hN(e){var t=e[1].Tooltip,r=ke(10+2*(t.length+1));r.write_shift(2,2048);var a=sr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function mN(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=W1[r]||r,r=e.read_shift(2),t[1]=W1[r]||r,t}function pN(e){return e||(e=ke(4)),e.write_shift(2,1),e.write_shift(2,1),e}function gN(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(zw(e));return r}function xN(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(zw(e));return r}function vN(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Ww(e,t,r){if(!r.cellStyles)return Zr(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(a),u=e.read_shift(a),h=e.read_shift(2);a==2&&(e.l+=2);var m={s,e:l,w:c,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(m.level=h>>8&7),m}function _N(e,t){var r=ke(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function yN(e,t){var r={};return t<32||(e.l+=16,r.header=Jr(e),r.footer=Jr(e),e.l+=2),r}function wN(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function bN(e){for(var t=ke(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var EN=Sn,SN=Lw,TN=bo;function kN(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function AN(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Sn(e);++e.l;var s=Ri(e,t-7,r);return a.t="str",a.val=s,a}function jN(e){var t=Sn(e);++e.l;var r=Jr(e);return t.t="n",t.val=r,t}function NN(e,t,r){var a=ke(15);return ko(a,e,t),a.write_shift(8,r,"f"),a}function CN(e){var t=Sn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function ON(e,t,r){var a=ke(9);return ko(a,e,t),a.write_shift(2,r),a}function RN(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function DN(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function FN(e,t,r){var a=e.l+t,s=Sn(e),l=e.read_shift(2),c=Si(e,l,r);return e.l=a,s.t="str",s.val=c,s}var MN=[2,3,48,49,131,139,140,245],Jh=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Uf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var m=[],p=Fs(1);switch(h.type){case"base64":p=Na(Oa(u));break;case"binary":p=Na(u);break;case"buffer":case"array":p=u;break}qr(p,0);var v=p.read_shift(1),_=!!(v&136),y=!1,b=!1;switch(v){case 2:break;case 3:break;case 48:y=!0,_=!0;break;case 49:y=!0,_=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var w=0,E=521;v==2&&(w=p.read_shift(2)),p.l+=3,v!=2&&(w=p.read_shift(4)),w>1048576&&(w=1e6),v!=2&&(E=p.read_shift(2));var k=p.read_shift(2),A=h.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(A=e[p[p.l]]),p.l+=1,p.l+=2),b&&(p.l+=36);for(var S=[],j={},F=Math.min(p.length,v==2?521:E-10-(y?264:0)),R=b?32:11;p.l<F&&p[p.l]!=13;)switch(j={},j.name=ao.utils.decode(A,p.slice(p.l,p.l+R)).replace(/[\u0000\r\n].*$/g,""),p.l+=R,j.type=String.fromCharCode(p.read_shift(1)),v!=2&&!b&&(j.offset=p.read_shift(4)),j.len=p.read_shift(1),v==2&&(j.offset=p.read_shift(2)),j.dec=p.read_shift(1),j.name.length&&S.push(j),v!=2&&(p.l+=b?13:14),j.type){case"B":(!y||j.len!=8)&&h.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(p[p.l]!==13&&(p.l=E-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=E;var N=0,X=0;for(m[0]=[],X=0;X!=S.length;++X)m[0][X]=S[X].name;for(;w-- >0;){if(p[p.l]===42){p.l+=k;continue}for(++p.l,m[++N]=[],X=0,X=0;X!=S.length;++X){var G=p.slice(p.l,p.l+S[X].len);p.l+=S[X].len,qr(G,0);var se=ao.utils.decode(A,G);switch(S[X].type){case"C":se.trim().length&&(m[N][X]=se.replace(/\s+$/,""));break;case"D":se.length===8?m[N][X]=new Date(+se.slice(0,4),+se.slice(4,6)-1,+se.slice(6,8)):m[N][X]=se;break;case"F":m[N][X]=parseFloat(se.trim());break;case"+":case"I":m[N][X]=b?G.read_shift(-4,"i")^2147483648:G.read_shift(4,"i");break;case"L":switch(se.trim().toUpperCase()){case"Y":case"T":m[N][X]=!0;break;case"N":case"F":m[N][X]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+se+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));m[N][X]="##MEMO##"+(b?parseInt(se.trim(),10):G.read_shift(4));break;case"N":se=se.replace(/\u0000/g,"").trim(),se&&se!="."&&(m[N][X]=+se||0);break;case"@":m[N][X]=new Date(G.read_shift(-8,"f")-621356832e5);break;case"T":m[N][X]=new Date((G.read_shift(4)-2440588)*864e5+G.read_shift(4));break;case"Y":m[N][X]=G.read_shift(4,"i")/1e4+G.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[N][X]=-G.read_shift(-8,"f");break;case"B":if(y&&S[X].len==8){m[N][X]=G.read_shift(8,"f");break}case"G":case"P":G.l+=S[X].len;break;case"0":if(S[X].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[X].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),h.DBF=S,m}function a(u,h){var m=h||{};m.dateNF||(m.dateNF="yyyymmdd");var p=Vl(r(u,m),m);return p["!cols"]=m.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete m.DBF,p}function s(u,h){try{return Is(a(u,h),h)}catch(m){if(h&&h.WTF)throw m}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,h){var m=h||{};if(+m.codepage>=0&&cn(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var p=ga(),v=Of(u,{header:1,raw:!0,cellDates:!0}),_=v[0],y=v.slice(1),b=u["!cols"]||[],w=0,E=0,k=0,A=1;for(w=0;w<_.length;++w){if(((b[w]||{}).DBF||{}).name){_[w]=b[w].DBF.name,++k;continue}if(_[w]!=null){if(++k,typeof _[w]=="number"&&(_[w]=_[w].toString(10)),typeof _[w]!="string")throw new Error("DBF Invalid column name "+_[w]+" |"+typeof _[w]+"|");if(_.indexOf(_[w])!==w){for(E=0;E<1024;++E)if(_.indexOf(_[w]+"_"+E)==-1){_[w]+="_"+E;break}}}}var S=Nt(u["!ref"]),j=[],F=[],R=[];for(w=0;w<=S.e.c-S.s.c;++w){var N="",X="",G=0,se=[];for(E=0;E<y.length;++E)y[E][w]!=null&&se.push(y[E][w]);if(se.length==0||_[w]==null){j[w]="?";continue}for(E=0;E<se.length;++E){switch(typeof se[E]){case"number":X="B";break;case"string":X="C";break;case"boolean":X="L";break;case"object":X=se[E]instanceof Date?"D":"C";break;default:X="C"}G=Math.max(G,String(se[E]).length),N=N&&N!=X?"C":X}G>250&&(G=250),X=((b[w]||{}).DBF||{}).type,X=="C"&&b[w].DBF.len>G&&(G=b[w].DBF.len),N=="B"&&X=="N"&&(N="N",R[w]=b[w].DBF.dec,G=b[w].DBF.len),F[w]=N=="C"||X=="N"?G:l[N]||0,A+=F[w],j[w]=N}var te=p.next(32);for(te.write_shift(4,318902576),te.write_shift(4,y.length),te.write_shift(2,296+32*k),te.write_shift(2,A),w=0;w<4;++w)te.write_shift(4,0);for(te.write_shift(4,0|(+t[By]||3)<<8),w=0,E=0;w<_.length;++w)if(_[w]!=null){var z=p.next(32),ge=(_[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,ge,"sbcs"),z.write_shift(1,j[w]=="?"?"C":j[w],"sbcs"),z.write_shift(4,E),z.write_shift(1,F[w]||l[j[w]]||0),z.write_shift(1,R[w]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),E+=F[w]||l[j[w]]||0}var Oe=p.next(264);for(Oe.write_shift(4,13),w=0;w<65;++w)Oe.write_shift(4,0);for(w=0;w<y.length;++w){var Ce=p.next(A);for(Ce.write_shift(1,0),E=0;E<_.length;++E)if(_[E]!=null)switch(j[E]){case"L":Ce.write_shift(1,y[w][E]==null?63:y[w][E]?84:70);break;case"B":Ce.write_shift(8,y[w][E]||0,"f");break;case"N":var Q="0";for(typeof y[w][E]=="number"&&(Q=y[w][E].toFixed(R[E]||0)),k=0;k<F[E]-Q.length;++k)Ce.write_shift(1,32);Ce.write_shift(1,Q,"sbcs");break;case"D":y[w][E]?(Ce.write_shift(4,("0000"+y[w][E].getFullYear()).slice(-4),"sbcs"),Ce.write_shift(2,("00"+(y[w][E].getMonth()+1)).slice(-2),"sbcs"),Ce.write_shift(2,("00"+y[w][E].getDate()).slice(-2),"sbcs")):Ce.write_shift(8,"00000000","sbcs");break;case"C":var le=String(y[w][E]!=null?y[w][E]:"").slice(0,F[E]);for(Ce.write_shift(1,le,"sbcs"),k=0;k<F[E]-le.length;++k)Ce.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:s,to_sheet:a,from_sheet:c}})(),Xw=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ur(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,y){var b=e[y];return typeof b=="number"?y1(b):b},a=function(_,y,b){var w=y.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return w==59?_:y1(w)};e["|"]=254;function s(_,y){switch(y.type){case"base64":return l(Oa(_),y);case"binary":return l(_,y);case"buffer":return l(xt&&Buffer.isBuffer(_)?_.toString("binary"):Us(_),y);case"array":return l(bi(_),y)}throw new Error("Unrecognized type "+y.type)}function l(_,y){var b=_.split(/[\n\r]+/),w=-1,E=-1,k=0,A=0,S=[],j=[],F=null,R={},N=[],X=[],G=[],se=0,te;for(+y.codepage>=0&&cn(+y.codepage);k!==b.length;++k){se=0;var z=b[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),ge=z.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),Oe=ge[0],Ce;if(z.length>0)switch(Oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ge[1].charAt(0)=="P"&&j.push(z.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,le=!1,Ee=!1,K=!1,Te=-1,q=-1;for(A=1;A<ge.length;++A)switch(ge[A].charAt(0)){case"A":break;case"X":E=parseInt(ge[A].slice(1))-1,le=!0;break;case"Y":for(w=parseInt(ge[A].slice(1))-1,le||(E=0),te=S.length;te<=w;++te)S[te]=[];break;case"K":Ce=ge[A].slice(1),Ce.charAt(0)==='"'?Ce=Ce.slice(1,Ce.length-1):Ce==="TRUE"?Ce=!0:Ce==="FALSE"?Ce=!1:isNaN(un(Ce))?isNaN(Ll(Ce).getDate())||(Ce=Jt(Ce)):(Ce=un(Ce),F!==null&&Hl(F)&&(Ce=Pf(Ce))),Q=!0;break;case"E":K=!0;var C=Rl(ge[A].slice(1),{r:w,c:E});S[w][E]=[S[w][E],C];break;case"S":Ee=!0,S[w][E]=[S[w][E],"S5S"];break;case"G":break;case"R":Te=parseInt(ge[A].slice(1))-1;break;case"C":q=parseInt(ge[A].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}if(Q&&(S[w][E]&&S[w][E].length==2?S[w][E][0]=Ce:S[w][E]=Ce,F=null),Ee){if(K)throw new Error("SYLK shared formula cannot have own formula");var H=Te>-1&&S[Te][q];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");S[w][E][1]=d2(H[1],{r:w-Te,c:E-q})}break;case"F":var I=0;for(A=1;A<ge.length;++A)switch(ge[A].charAt(0)){case"X":E=parseInt(ge[A].slice(1))-1,++I;break;case"Y":for(w=parseInt(ge[A].slice(1))-1,te=S.length;te<=w;++te)S[te]=[];break;case"M":se=parseInt(ge[A].slice(1))/20;break;case"F":break;case"G":break;case"P":F=j[parseInt(ge[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(G=ge[A].slice(1).split(" "),te=parseInt(G[0],10);te<=parseInt(G[1],10);++te)se=parseInt(G[2],10),X[te-1]=se===0?{hidden:!0}:{wch:se},Ms(X[te-1]);break;case"C":E=parseInt(ge[A].slice(1))-1,X[E]||(X[E]={});break;case"R":w=parseInt(ge[A].slice(1))-1,N[w]||(N[w]={}),se>0?(N[w].hpt=se,N[w].hpx=Il(se)):se===0&&(N[w].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}I<1&&(F=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+z)}}return N.length>0&&(R["!rows"]=N),X.length>0&&(R["!cols"]=X),y&&y.sheetRows&&(S=S.slice(0,y.sheetRows)),[S,R]}function c(_,y){var b=s(_,y),w=b[0],E=b[1],k=Vl(w,y);return ur(E).forEach(function(A){k[A]=E[A]}),k}function u(_,y){return Is(c(_,y),y)}function h(_,y,b,w){var E="C;Y"+(b+1)+";X"+(w+1)+";K";switch(_.t){case"n":E+=_.v||0,_.f&&!_.F&&(E+=";E"+Hm(_.f,{r:b,c:w}));break;case"b":E+=_.v?"TRUE":"FALSE";break;case"e":E+=_.w||_.v;break;case"d":E+='"'+(_.w||_.v)+'"';break;case"s":E+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function m(_,y){y.forEach(function(b,w){var E="F;W"+(w+1)+" "+(w+1)+" ";b.hidden?E+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=fo(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=ho(b.wpx)),typeof b.wch=="number"&&(E+=Math.round(b.wch))),E.charAt(E.length-1)!=" "&&_.push(E)})}function p(_,y){y.forEach(function(b,w){var E="F;";b.hidden?E+="M0;":b.hpt?E+="M"+20*b.hpt+";":b.hpx&&(E+="M"+20*mo(b.hpx)+";"),E.length>2&&_.push(E+"R"+(w+1))})}function v(_,y){var b=["ID;PWXL;N;E"],w=[],E=Nt(_["!ref"]),k,A=Array.isArray(_),S=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),_["!cols"]&&m(b,_["!cols"]),_["!rows"]&&p(b,_["!rows"]),b.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var j=E.s.r;j<=E.e.r;++j)for(var F=E.s.c;F<=E.e.c;++F){var R=st({r:j,c:F});k=A?(_[j]||[])[F]:_[R],!(!k||k.v==null&&(!k.f||k.F))&&w.push(h(k,_,j,F))}return b.join(S)+S+w.join(S)+S+"E"+S}return{to_workbook:u,to_sheet:c,from_sheet:v}})(),Kw=(function(){function e(l,c){switch(c.type){case"base64":return t(Oa(l),c);case"binary":return t(l,c);case"buffer":return t(xt&&Buffer.isBuffer(l)?l.toString("binary"):Us(l),c);case"array":return t(bi(l),c)}throw new Error("Unrecognized type "+c.type)}function t(l,c){for(var u=l.split(`
`),h=-1,m=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++h]=[],m=0;continue}if(!(h<0)){var _=u[p].trim().split(","),y=_[0],b=_[1];++p;for(var w=u[p]||"";(w.match(/["]/g)||[]).length&1&&p<u.length-1;)w+=`
`+u[++p];switch(w=w.trim(),+y){case-1:if(w==="BOT"){v[++h]=[],m=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?v[h][m]=!0:w==="FALSE"?v[h][m]=!1:isNaN(un(b))?isNaN(Ll(b).getDate())?v[h][m]=b:v[h][m]=Jt(b):v[h][m]=un(b),++m;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),v[h][m++]=w!==""?w:null;break}if(w==="EOD")break}}return c&&c.sheetRows&&(v=v.slice(0,c.sheetRows)),v}function r(l,c){return Vl(e(l,c),c)}function a(l,c){return Is(r(l,c),c)}var s=(function(){var l=function(h,m,p,v,_){h.push(m),h.push(p+","+v),h.push('"'+_.replace(/"/g,'""')+'"')},c=function(h,m,p,v){h.push(m+","+p),h.push(m==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(h){var m=[],p=Nt(h["!ref"]),v,_=Array.isArray(h);l(m,"TABLE",0,1,"sheetjs"),l(m,"VECTORS",0,p.e.r-p.s.r+1,""),l(m,"TUPLES",0,p.e.c-p.s.c+1,""),l(m,"DATA",0,0,"");for(var y=p.s.r;y<=p.e.r;++y){c(m,-1,0,"BOT");for(var b=p.s.c;b<=p.e.c;++b){var w=st({r:y,c:b});if(v=_?(h[y]||[])[b]:h[w],!v){c(m,1,0,"");continue}switch(v.t){case"n":var E=v.w;!E&&v.v!=null&&(E=v.v),E==null?v.f&&!v.F?c(m,1,0,"="+v.f):c(m,1,0,""):c(m,0,E,"V");break;case"b":c(m,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":c(m,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Ja(v.z||nt[14],Ar(Jt(v.v)))),c(m,0,v.w,"V");break;default:c(m,1,0,"")}}}c(m,-1,0,"EOD");var k=`\r
`,A=m.join(k);return A}})();return{to_workbook:a,to_sheet:r,from_sheet:s}})(),Yw=(function(){function e(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,_){for(var y=v.split(`
`),b=-1,w=-1,E=0,k=[];E!==y.length;++E){var A=y[E].trim().split(":");if(A[0]==="cell"){var S=sr(A[1]);if(k.length<=S.r)for(b=k.length;b<=S.r;++b)k[b]||(k[b]=[]);switch(b=S.r,w=S.c,A[2]){case"t":k[b][w]=e(A[3]);break;case"v":k[b][w]=+A[3];break;case"vtf":var j=A[A.length-1];case"vtc":switch(A[3]){case"nl":k[b][w]=!!+A[4];break;default:k[b][w]=+A[4];break}A[2]=="vtf"&&(k[b][w]=[k[b][w],j])}}}return _&&_.sheetRows&&(k=k.slice(0,_.sheetRows)),k}function a(v,_){return Vl(r(v,_),_)}function s(v,_){return Is(a(v,_),_)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function m(v){if(!v||!v["!ref"])return"";for(var _=[],y=[],b,w="",E=xa(v["!ref"]),k=Array.isArray(v),A=E.s.r;A<=E.e.r;++A)for(var S=E.s.c;S<=E.e.c;++S)if(w=st({r:A,c:S}),b=k?(v[A]||[])[S]:v[w],!(!b||b.v==null||b.t==="z")){switch(y=["cell",w,"t"],b.t){case"s":case"str":y.push(t(b.v));break;case"n":b.f?(y[2]="vtf",y[3]="n",y[4]=b.v,y[5]=t(b.f)):(y[2]="v",y[3]=b.v);break;case"b":y[2]="vt"+(b.f?"f":"c"),y[3]="nl",y[4]=b.v?"1":"0",y[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var j=Ar(Jt(b.v));y[2]="vtc",y[3]="nd",y[4]=""+j,y[5]=b.w||Ja(b.z||nt[14],j);break;case"e":continue}_.push(y.join(":"))}return _.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function p(v){return[l,c,u,c,m(v),h].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:p}})(),Ul=(function(){function e(p,v,_,y,b){b.raw?v[_][y]=p:p===""||(p==="TRUE"?v[_][y]=!0:p==="FALSE"?v[_][y]=!1:isNaN(un(p))?isNaN(Ll(p).getDate())?v[_][y]=p:v[_][y]=Jt(p):v[_][y]=un(p))}function t(p,v){var _=v||{},y=[];if(!p||p.length===0)return y;for(var b=p.split(/[\r\n]/),w=b.length-1;w>=0&&b[w].length===0;)--w;for(var E=10,k=0,A=0;A<=w;++A)k=b[A].indexOf(" "),k==-1?k=b[A].length:k++,E=Math.max(E,k);for(A=0;A<=w;++A){y[A]=[];var S=0;for(e(b[A].slice(0,E).trim(),y,A,S,_),S=1;S<=(b[A].length-E)/10+1;++S)e(b[A].slice(E+(S-1)*10,E+S*10).trim(),y,A,S,_)}return _.sheetRows&&(y=y.slice(0,_.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(p){for(var v={},_=!1,y=0,b=0;y<p.length;++y)(b=p.charCodeAt(y))==34?_=!_:!_&&b in r&&(v[b]=(v[b]||0)+1);b=[];for(y in v)Object.prototype.hasOwnProperty.call(v,y)&&b.push([v[y],y]);if(!b.length){v=a;for(y in v)Object.prototype.hasOwnProperty.call(v,y)&&b.push([v[y],y])}return b.sort(function(w,E){return w[0]-E[0]||a[w[1]]-a[E[1]]}),r[b.pop()[1]]||44}function l(p,v){var _=v||{},y="",b=_.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(y=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(y=p.charAt(4),p=p.slice(6)):y=s(p.slice(0,1024)):_&&_.FS?y=_.FS:y=s(p.slice(0,1024));var E=0,k=0,A=0,S=0,j=0,F=y.charCodeAt(0),R=!1,N=0,X=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var G=_.dateNF!=null?wA(_.dateNF):null;function se(){var te=p.slice(S,j),z={};if(te.charAt(0)=='"'&&te.charAt(te.length-1)=='"'&&(te=te.slice(1,-1).replace(/""/g,'"')),te.length===0)z.t="z";else if(_.raw)z.t="s",z.v=te;else if(te.trim().length===0)z.t="s",z.v=te;else if(te.charCodeAt(0)==61)te.charCodeAt(1)==34&&te.charCodeAt(te.length-1)==34?(z.t="s",z.v=te.slice(2,-1).replace(/""/g,'"')):Y3(te)?(z.t="n",z.f=te.slice(1)):(z.t="s",z.v=te);else if(te=="TRUE")z.t="b",z.v=!0;else if(te=="FALSE")z.t="b",z.v=!1;else if(!isNaN(A=un(te)))z.t="n",_.cellText!==!1&&(z.w=te),z.v=A;else if(!isNaN(Ll(te).getDate())||G&&te.match(G)){z.z=_.dateNF||nt[14];var ge=0;G&&te.match(G)&&(te=bA(te,_.dateNF,te.match(G)||[]),ge=1),_.cellDates?(z.t="d",z.v=Jt(te,ge)):(z.t="n",z.v=Ar(Jt(te,ge))),_.cellText!==!1&&(z.w=Ja(z.z,z.v instanceof Date?Ar(z.v):z.v)),_.cellNF||delete z.z}else z.t="s",z.v=te;if(z.t=="z"||(_.dense?(b[E]||(b[E]=[]),b[E][k]=z):b[st({c:k,r:E})]=z),S=j+1,X=p.charCodeAt(S),w.e.c<k&&(w.e.c=k),w.e.r<E&&(w.e.r=E),N==F)++k;else if(k=0,++E,_.sheetRows&&_.sheetRows<=E)return!0}e:for(;j<p.length;++j)switch(N=p.charCodeAt(j)){case 34:X===34&&(R=!R);break;case F:case 10:case 13:if(!R&&se())break e;break}return j-S>0&&se(),b["!ref"]=dt(w),b}function c(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,v):Vl(t(p,v),v)}function u(p,v){var _="",y=v.type=="string"?[0,0,0,0]:Ym(p,v);switch(v.type){case"base64":_=Oa(p);break;case"binary":_=p;break;case"buffer":v.codepage==65001?_=p.toString("utf8"):v.codepage&&typeof ao<"u"||(_=xt&&Buffer.isBuffer(p)?p.toString("binary"):Us(p));break;case"array":_=bi(p);break;case"string":_=p;break;default:throw new Error("Unrecognized type "+v.type)}return y[0]==239&&y[1]==187&&y[2]==191?_=qt(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=qt(_):v.type=="binary"&&typeof ao<"u",_.slice(0,19)=="socialcalc:version:"?Yw.to_sheet(v.type=="string"?_:qt(_),v):c(_,v)}function h(p,v){return Is(u(p,v),v)}function m(p){for(var v=[],_=Nt(p["!ref"]),y,b=Array.isArray(p),w=_.s.r;w<=_.e.r;++w){for(var E=[],k=_.s.c;k<=_.e.c;++k){var A=st({r:w,c:k});if(y=b?(p[w]||[])[k]:p[A],!y||y.v==null){E.push("          ");continue}for(var S=(y.w||(Yn(y),y.w)||"").slice(0,10);S.length<10;)S+=" ";E.push(S+(k===0?" ":""))}v.push(E.join(""))}return v.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:m}})();function BN(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=Xw.to_workbook(e,r);return r.WTF=a,s}catch(l){if(r.WTF=a,!l.message.match(/SYLK bad record ID/)&&a)throw l;return Ul.to_workbook(e,t)}}var _i=(function(){function e(C,H,I){if(C){qr(C,C.l||0);for(var L=I.Enum||Te;C.l<C.length;){var Z=C.read_shift(2),re=L[Z]||L[65535],de=C.read_shift(2),ve=C.l+de,Se=re.f&&re.f(C,de,I);if(C.l=ve,H(Se,re,Z))return}}}function t(C,H){switch(H.type){case"base64":return r(Na(Oa(C)),H);case"binary":return r(Na(C),H);case"buffer":case"array":return r(C,H)}throw"Unsupported type "+H.type}function r(C,H){if(!C)return C;var I=H||{},L=I.dense?[]:{},Z="Sheet1",re="",de=0,ve={},Se=[],xe=[],U={s:{r:0,c:0},e:{r:0,c:0}},Ze=I.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)I.Enum=Te,e(C,function(be,it,kt){switch(kt){case 0:I.vers=be,be>=4096&&(I.qpro=!0);break;case 6:U=be;break;case 204:be&&(re=be);break;case 222:re=be;break;case 15:case 51:I.qpro||(be[1].v=be[1].v.slice(1));case 13:case 14:case 16:kt==14&&(be[2]&112)==112&&(be[2]&15)>1&&(be[2]&15)<15&&(be[1].z=I.dateNF||nt[14],I.cellDates&&(be[1].t="d",be[1].v=Pf(be[1].v))),I.qpro&&be[3]>de&&(L["!ref"]=dt(U),ve[Z]=L,Se.push(Z),L=I.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},de=be[3],Z=re||"Sheet"+(de+1),re="");var ht=I.dense?(L[be[0].r]||[])[be[0].c]:L[st(be[0])];if(ht){ht.t=be[1].t,ht.v=be[1].v,be[1].z!=null&&(ht.z=be[1].z),be[1].f!=null&&(ht.f=be[1].f);break}I.dense?(L[be[0].r]||(L[be[0].r]=[]),L[be[0].r][be[0].c]=be[1]):L[st(be[0])]=be[1];break}},I);else if(C[2]==26||C[2]==14)I.Enum=q,C[2]==14&&(I.qpro=!0,C.l=0),e(C,function(be,it,kt){switch(kt){case 204:Z=be;break;case 22:be[1].v=be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(be[3]>de&&(L["!ref"]=dt(U),ve[Z]=L,Se.push(Z),L=I.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},de=be[3],Z="Sheet"+(de+1)),Ze>0&&be[0].r>=Ze)break;I.dense?(L[be[0].r]||(L[be[0].r]=[]),L[be[0].r][be[0].c]=be[1]):L[st(be[0])]=be[1],U.e.c<be[0].c&&(U.e.c=be[0].c),U.e.r<be[0].r&&(U.e.r=be[0].r);break;case 27:be[14e3]&&(xe[be[14e3][0]]=be[14e3][1]);break;case 1537:xe[be[0]]=be[1],be[0]==de&&(Z=be[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(L["!ref"]=dt(U),ve[re||Z]=L,Se.push(re||Z),!xe.length)return{SheetNames:Se,Sheets:ve};for(var Ie={},_e=[],Le=0;Le<xe.length;++Le)ve[Se[Le]]?(_e.push(xe[Le]||Se[Le]),Ie[xe[Le]]=ve[xe[Le]]||ve[Se[Le]]):(_e.push(xe[Le]),Ie[xe[Le]]={"!ref":"A1"});return{SheetNames:_e,Sheets:Ie}}function a(C,H){var I=H||{};if(+I.codepage>=0&&cn(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var L=ga(),Z=Nt(C["!ref"]),re=Array.isArray(C),de=[];qe(L,0,l(1030)),qe(L,6,h(Z));for(var ve=Math.min(Z.e.r,8191),Se=Z.s.r;Se<=ve;++Se)for(var xe=mr(Se),U=Z.s.c;U<=Z.e.c;++U){Se===Z.s.r&&(de[U]=nr(U));var Ze=de[U]+xe,Ie=re?(C[Se]||[])[U]:C[Ze];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")(Ie.v|0)==Ie.v&&Ie.v>=-32768&&Ie.v<=32767?qe(L,13,y(Se,U,Ie.v)):qe(L,14,w(Se,U,Ie.v));else{var _e=Yn(Ie);qe(L,15,v(Se,U,_e.slice(0,239)))}}return qe(L,1),L.end()}function s(C,H){var I=H||{};if(+I.codepage>=0&&cn(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var L=ga();qe(L,0,c(C));for(var Z=0,re=0;Z<C.SheetNames.length;++Z)(C.Sheets[C.SheetNames[Z]]||{})["!ref"]&&qe(L,27,K(C.SheetNames[Z],re++));var de=0;for(Z=0;Z<C.SheetNames.length;++Z){var ve=C.Sheets[C.SheetNames[Z]];if(!(!ve||!ve["!ref"])){for(var Se=Nt(ve["!ref"]),xe=Array.isArray(ve),U=[],Ze=Math.min(Se.e.r,8191),Ie=Se.s.r;Ie<=Ze;++Ie)for(var _e=mr(Ie),Le=Se.s.c;Le<=Se.e.c;++Le){Ie===Se.s.r&&(U[Le]=nr(Le));var be=U[Le]+_e,it=xe?(ve[Ie]||[])[Le]:ve[be];if(!(!it||it.t=="z"))if(it.t=="n")qe(L,23,se(Ie,Le,de,it.v));else{var kt=Yn(it);qe(L,22,N(Ie,Le,de,kt.slice(0,239)))}}++de}}return qe(L,1),L.end()}function l(C){var H=ke(2);return H.write_shift(2,C),H}function c(C){var H=ke(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var I=0,L=0,Z=0,re=0;re<C.SheetNames.length;++re){var de=C.SheetNames[re],ve=C.Sheets[de];if(!(!ve||!ve["!ref"])){++Z;var Se=xa(ve["!ref"]);I<Se.e.r&&(I=Se.e.r),L<Se.e.c&&(L=Se.e.c)}}return I>8191&&(I=8191),H.write_shift(2,I),H.write_shift(1,Z),H.write_shift(1,L),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function u(C,H,I){var L={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&I.qpro?(L.s.c=C.read_shift(1),C.l++,L.s.r=C.read_shift(2),L.e.c=C.read_shift(1),C.l++,L.e.r=C.read_shift(2),L):(L.s.c=C.read_shift(2),L.s.r=C.read_shift(2),H==12&&I.qpro&&(C.l+=2),L.e.c=C.read_shift(2),L.e.r=C.read_shift(2),H==12&&I.qpro&&(C.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function h(C){var H=ke(8);return H.write_shift(2,C.s.c),H.write_shift(2,C.s.r),H.write_shift(2,C.e.c),H.write_shift(2,C.e.r),H}function m(C,H,I){var L=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(L[0].c=C.read_shift(1),L[3]=C.read_shift(1),L[0].r=C.read_shift(2),C.l+=2):(L[2]=C.read_shift(1),L[0].c=C.read_shift(2),L[0].r=C.read_shift(2)),L}function p(C,H,I){var L=C.l+H,Z=m(C,H,I);if(Z[1].t="s",I.vers==20768){C.l++;var re=C.read_shift(1);return Z[1].v=C.read_shift(re,"utf8"),Z}return I.qpro&&C.l++,Z[1].v=C.read_shift(L-C.l,"cstr"),Z}function v(C,H,I){var L=ke(7+I.length);L.write_shift(1,255),L.write_shift(2,H),L.write_shift(2,C),L.write_shift(1,39);for(var Z=0;Z<L.length;++Z){var re=I.charCodeAt(Z);L.write_shift(1,re>=128?95:re)}return L.write_shift(1,0),L}function _(C,H,I){var L=m(C,H,I);return L[1].v=C.read_shift(2,"i"),L}function y(C,H,I){var L=ke(7);return L.write_shift(1,255),L.write_shift(2,H),L.write_shift(2,C),L.write_shift(2,I,"i"),L}function b(C,H,I){var L=m(C,H,I);return L[1].v=C.read_shift(8,"f"),L}function w(C,H,I){var L=ke(13);return L.write_shift(1,255),L.write_shift(2,H),L.write_shift(2,C),L.write_shift(8,I,"f"),L}function E(C,H,I){var L=C.l+H,Z=m(C,H,I);if(Z[1].v=C.read_shift(8,"f"),I.qpro)C.l=L;else{var re=C.read_shift(2);j(C.slice(C.l,C.l+re),Z),C.l+=re}return Z}function k(C,H,I){var L=H&32768;return H&=-32769,H=(L?C:0)+(H>=8192?H-16384:H),(L?"":"$")+(I?nr(H):mr(H))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(C,H){qr(C,0);for(var I=[],L=0,Z="",re="",de="",ve="";C.l<C.length;){var Se=C[C.l++];switch(Se){case 0:I.push(C.read_shift(8,"f"));break;case 1:re=k(H[0].c,C.read_shift(2),!0),Z=k(H[0].r,C.read_shift(2),!1),I.push(re+Z);break;case 2:{var xe=k(H[0].c,C.read_shift(2),!0),U=k(H[0].r,C.read_shift(2),!1);re=k(H[0].c,C.read_shift(2),!0),Z=k(H[0].r,C.read_shift(2),!1),I.push(xe+U+":"+re+Z)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(C.read_shift(2));break;case 6:{for(var Ze="";Se=C[C.l++];)Ze+=String.fromCharCode(Se);I.push('"'+Ze.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:ve=I.pop(),de=I.pop(),I.push(["AND","OR"][Se-20]+"("+de+","+ve+")");break;default:if(Se<32&&S[Se])ve=I.pop(),de=I.pop(),I.push(de+S[Se]+ve);else if(A[Se]){if(L=A[Se][1],L==69&&(L=C[C.l++]),L>I.length){console.error("WK1 bad formula parse 0x"+Se.toString(16)+":|"+I.join("|")+"|");return}var Ie=I.slice(-L);I.length-=L,I.push(A[Se][0]+"("+Ie.join(",")+")")}else return Se<=7?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=24?console.error("WK1 unsupported op "+Se.toString(16)):Se<=30?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=115?console.error("WK1 unsupported function opcode "+Se.toString(16)):console.error("WK1 unrecognized opcode "+Se.toString(16))}}I.length==1?H[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function F(C){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=C.read_shift(2),H[3]=C[C.l++],H[0].c=C[C.l++],H}function R(C,H){var I=F(C);return I[1].t="s",I[1].v=C.read_shift(H-4,"cstr"),I}function N(C,H,I,L){var Z=ke(6+L.length);Z.write_shift(2,C),Z.write_shift(1,I),Z.write_shift(1,H),Z.write_shift(1,39);for(var re=0;re<L.length;++re){var de=L.charCodeAt(re);Z.write_shift(1,de>=128?95:de)}return Z.write_shift(1,0),Z}function X(C,H){var I=F(C);I[1].v=C.read_shift(2);var L=I[1].v>>1;if(I[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return I[1].v=L,I}function G(C,H){var I=F(C),L=C.read_shift(4),Z=C.read_shift(4),re=C.read_shift(2);if(re==65535)return L===0&&Z===3221225472?(I[1].t="e",I[1].v=15):L===0&&Z===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var de=re&32768;return re=(re&32767)-16446,I[1].v=(1-de*2)*(Z*Math.pow(2,re+32)+L*Math.pow(2,re)),I}function se(C,H,I,L){var Z=ke(14);if(Z.write_shift(2,C),Z.write_shift(1,I),Z.write_shift(1,H),L==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var re=0,de=0,ve=0,Se=0;return L<0&&(re=1,L=-L),de=Math.log2(L)|0,L/=Math.pow(2,de-31),Se=L>>>0,(Se&2147483648)==0&&(L/=2,++de,Se=L>>>0),L-=Se,Se|=2147483648,Se>>>=0,L*=Math.pow(2,32),ve=L>>>0,Z.write_shift(4,ve),Z.write_shift(4,Se),de+=16383+(re?32768:0),Z.write_shift(2,de),Z}function te(C,H){var I=G(C);return C.l+=H-14,I}function z(C,H){var I=F(C),L=C.read_shift(4);return I[1].v=L>>6,I}function ge(C,H){var I=F(C),L=C.read_shift(8,"f");return I[1].v=L,I}function Oe(C,H){var I=ge(C);return C.l+=H-10,I}function Ce(C,H){return C[C.l+H-1]==0?C.read_shift(H,"cstr"):""}function Q(C,H){var I=C[C.l++];I>H-1&&(I=H-1);for(var L="";L.length<I;)L+=String.fromCharCode(C[C.l++]);return L}function le(C,H,I){if(!(!I.qpro||H<21)){var L=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var Z=C.read_shift(H-21,"cstr");return[L,Z]}}function Ee(C,H){for(var I={},L=C.l+H;C.l<L;){var Z=C.read_shift(2);if(Z==14e3){for(I[Z]=[0,""],I[Z][0]=C.read_shift(2);C[C.l];)I[Z][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return I}function K(C,H){var I=ke(5+C.length);I.write_shift(2,14e3),I.write_shift(2,H);for(var L=0;L<C.length;++L){var Z=C.charCodeAt(L);I[I.l++]=Z>127?95:Z}return I[I.l++]=0,I}var Te={0:{n:"BOF",f:Er},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ce},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:G},24:{n:"NUMBER18",f:X},25:{n:"FORMULA19",f:te},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:ge},40:{n:"FORMULA28",f:Oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}})();function LN(e){var t={},r=e.match(ea),a=0,s=!1;if(r)for(;a!=r.length;++a){var l=lt(r[a]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=hm[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return t}var UN=(function(){var e=io("t"),t=io("rPr");function r(l){var c=l.match(e);if(!c)return{t:"s",v:""};var u={t:"s",v:jt(c[1])},h=l.match(t);return h&&(u.s=LN(h[1])),u}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(c){return c.replace(a,"").split(s).map(r).filter(function(u){return u.v})}})(),IN=(function(){var t=/(\r\n|\n)/g;function r(s,l,c){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),s.b&&(l.push("<b>"),c.push("</b>")),s.i&&(l.push("<i>"),c.push("</i>")),s.strike&&(l.push("<s>"),c.push("</s>"));var h=s.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),c.push("</"+h+">")),c.push("</span>"),s}function a(s){var l=[[],s.v,[]];return s.v?(s.s&&r(s.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(a).join("")}})(),PN=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,zN=/<(?:\w+:)?r>/,HN=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Lm(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=jt(qt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=qt(e),r&&(a.h=Em(a.t))):e.match(zN)&&(a.r=qt(e),a.t=jt(qt((e.replace(HN,"").match(PN)||[]).join("").replace(ea,""))),r&&(a.h=IN(UN(a.r)))),a):{t:""}}var qN=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,VN=/<(?:\w+:)?(?:si|sstItem)>/g,GN=/<\/(?:\w+:)?(?:si|sstItem)>/;function $N(e,t){var r=[],a="";if(!e)return r;var s=e.match(qN);if(s){a=s[2].replace(VN,"").split(GN);for(var l=0;l!=a.length;++l){var c=Lm(a[l].trim(),t);c!=null&&(r[r.length]=c)}s=lt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var WN=/^\s|\s$|[\t\n\r]/;function Jw(e,t){if(!t.bookSST)return"";var r=[pr];r[r.length]=He("sst",null,{xmlns:Ai[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(WN)&&(l+=' xml:space="preserve"'),l+=">"+It(s.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function XN(e){return[e.read_shift(4),e.read_shift(4)]}function KN(e,t){var r=[],a=!1;return Qn(e,function(l,c,u){switch(u){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(c.T,!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function YN(e,t){return t||(t=ke(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var JN=lj;function QN(e){var t=ga();Fe(t,159,YN(e));for(var r=0;r<e.length;++r)Fe(t,19,JN(e[r]));return Fe(t,160),t.end()}function Qw(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Kn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function ZN(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Kn(e,4),t.U=Kn(e,4),t.W=Kn(e,4),t}function eC(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=l,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function tC(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(eC(e));return t}function rC(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function aC(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Kn(e,4),t.U=Kn(e,4),t.W=Kn(e,4),t}function nC(e){var t=aC(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Zw(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function e2(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function sC(e){var t=Kn(e);switch(t.Minor){case 2:return[t.Minor,iC(e)];case 3:return[t.Minor,lC()];case 4:return[t.Minor,cC(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function iC(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=Zw(e,r),s=e2(e,e.length-e.l);return{t:"Std",h:a,v:s}}function lC(){throw new Error("File is password-protected: ECMA-376 Extensible")}function cC(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(ea,function(l){var c=lt(l);switch(En(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){a[u]=c[u]});break;case"<dataIntegrity":a.encryptedHmacKey=c.encryptedHmacKey,a.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(c);break;default:throw c[0]}}),a}function oC(e,t){var r={},a=r.EncryptionVersionInfo=Kn(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=Zw(e,s),t-=s,r.EncryptionVerifier=e2(e,t),r}function uC(e){var t={},r=t.EncryptionVersionInfo=Kn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Um(e){var t=0,r,a=Qw(e),s=a.length+1,l,c,u,h,m;for(r=Fs(s),r[0]=a.length,l=1;l!=s;++l)r[l]=a[l-1];for(l=s-1;l>=0;--l)c=r[l],u=(t&16384)===0?0:1,h=t<<1&32767,m=u|h,t=m^c;return t^52811}var t2=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(c){return(c/2|c*128)&255},s=function(c,u){return a(c^u)},l=function(c){for(var u=t[c.length-1],h=104,m=c.length-1;m>=0;--m)for(var p=c[m],v=0;v!=7;++v)p&64&&(u^=r[h]),p*=2,--h;return u};return function(c){for(var u=Qw(c),h=l(u),m=u.length,p=Fs(16),v=0;v!=16;++v)p[v]=0;var _,y,b;for((m&1)===1&&(_=h>>8,p[m]=s(e[0],_),--m,_=h&255,y=u[u.length-1],p[m]=s(y,_));m>0;)--m,_=h>>8,p[m]=s(u[m],_),--m,_=h&255,p[m]=s(u[m],_);for(m=15,b=15-u.length;b>0;)_=h>>8,p[m]=s(e[b],_),--m,--b,_=h&255,p[m]=s(u[m],_),--m,--b;return p}})(),fC=function(e,t,r,a,s){s||(s=t),a||(a=t2(e));var l,c;for(l=0;l!=t.length;++l)c=t[l],c^=a[r],c=(c>>5|c<<3)&255,s[l]=c,++r;return[s,r,a]},dC=function(e){var t=0,r=t2(e);return function(a){var s=fC("",a,t,r);return t=s[1],s[0]}};function hC(e,t,r,a){var s={key:Er(e),verificationBytes:Er(e)};return r.password&&(s.verifier=Um(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=dC(r.password)),s}function mC(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=uC(e):a.Data=oC(e,t),a}function pC(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?mC(e,t-2,a):hC(e,r.biff>=8?t:t-2,r,a),a}var r2=(function(){function e(s,l){switch(l.type){case"base64":return t(Oa(s),l);case"binary":return t(s,l);case"buffer":return t(xt&&Buffer.isBuffer(s)?s.toString("binary"):Us(s),l);case"array":return t(bi(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){var c=l||{},u=c.dense?[]:{},h=s.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,v){Array.isArray(u)&&(u[v]=[]);for(var _=/\\\w+\b/g,y=0,b,w=-1;b=_.exec(p);){switch(b[0]){case"\\cell":var E=p.slice(y,_.lastIndex-b[0].length);if(E[0]==" "&&(E=E.slice(1)),++w,E.length){var k={v:E,t:"s"};Array.isArray(u)?u[v][w]=k:u[st({r:v,c:w})]=k}break}y=_.lastIndex}w>m.e.c&&(m.e.c=w)}),u["!ref"]=dt(m),u}function r(s,l){return Is(e(s,l),l)}function a(s){for(var l=["{\\rtf1\\ansi"],c=Nt(s["!ref"]),u,h=Array.isArray(s),m=c.s.r;m<=c.e.r;++m){l.push("\\trowd\\trautofit1");for(var p=c.s.c;p<=c.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=c.s.c;p<=c.e.c;++p){var v=st({r:m,c:p});u=h?(s[m]||[])[p]:s[v],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(Yn(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function gC(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function uo(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function xC(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),l=Math.min(t,r,a),c=s-l;if(c===0)return[0,0,t];var u=0,h=0,m=s+l;switch(h=c/(m>1?2-m:m),s){case t:u=((r-a)/c+6)%6;break;case r:u=(a-t)/c+2;break;case a:u=(t-r)/c+4;break}return[u/6,h,m/2]}function vC(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),l=a-s/2,c=[l,l,l],u=6*t,h;if(r!==0)switch(u|0){case 0:case 6:h=s*u,c[0]+=s,c[1]+=h;break;case 1:h=s*(2-u),c[0]+=h,c[1]+=s;break;case 2:h=s*(u-2),c[1]+=s,c[2]+=h;break;case 3:h=s*(4-u),c[1]+=h,c[2]+=s;break;case 4:h=s*(u-4),c[2]+=s,c[0]+=h;break;case 5:h=s*(6-u),c[2]+=h,c[0]+=s;break}for(var m=0;m!=3;++m)c[m]=Math.round(c[m]*255);return c}function Nf(e,t){if(t===0)return e;var r=xC(gC(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),uo(vC(r))}var a2=6,_C=15,yC=1,Yr=a2;function fo(e){return Math.floor((e+Math.round(128/Yr)/256)*Yr)}function ho(e){return Math.floor((e-5)/Yr*100+.5)/100}function Cf(e){return Math.round((e*Yr+5)/Yr*256)/256}function xh(e){return Cf(ho(fo(e)))}function Im(e){var t=Math.abs(e-xh(e)),r=Yr;if(t>.005)for(Yr=yC;Yr<_C;++Yr)Math.abs(e-xh(e))<=t&&(t=Math.abs(e-xh(e)),r=Yr);Yr=r}function Ms(e){e.width?(e.wpx=fo(e.width),e.wch=ho(e.wpx),e.MDW=Yr):e.wpx?(e.wch=ho(e.wpx),e.width=Cf(e.wch),e.MDW=Yr):typeof e.wch=="number"&&(e.width=Cf(e.wch),e.wpx=fo(e.width),e.MDW=Yr),e.customWidth&&delete e.customWidth}var wC=96,n2=wC;function mo(e){return e*96/n2}function Il(e){return e*n2/96}var bC={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function EC(e,t,r,a){t.Borders=[];var s={},l=!1;(e[0].match(ea)||[]).forEach(function(c){var u=lt(c);switch(En(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=Yt(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=Yt(u.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function SC(e,t,r,a){t.Fills=[];var s={},l=!1;(e[0].match(ea)||[]).forEach(function(c){var u=lt(c);switch(En(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function TC(e,t,r,a){t.Fonts=[];var s={},l=!1;(e[0].match(ea)||[]).forEach(function(c){var u=lt(c);switch(En(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=qt(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?Yt(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?Yt(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?Yt(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?Yt(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?Yt(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?Yt(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?Yt(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=hm[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=Yt(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var h=xi[s.color.index];s.color.index==81&&(h=xi[1]),h||(h=xi[1]),s.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Nf(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function kC(e,t,r){t.NumberFmt=[];for(var a=ur(nt),s=0;s<a.length;++s)t.NumberFmt[a[s]]=nt[a[s]];var l=e[0].match(ea);if(l)for(s=0;s<l.length;++s){var c=lt(l[s]);switch(En(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=jt(qt(c.formatCode)),h=parseInt(c.numFmtId,10);if(t.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=u}Xn(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}function AC(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=He("numFmt",null,{numFmtId:a,formatCode:It(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=He("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var nf=["numFmtId","fillId","fontId","borderId","xfId"],sf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function jC(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(ea)||[]).forEach(function(l){var c=lt(l),u=0;switch(En(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=c,delete a[0],u=0;u<nf.length;++u)a[nf[u]]&&(a[nf[u]]=parseInt(a[nf[u]],10));for(u=0;u<sf.length;++u)a[sf[u]]&&(a[sf[u]]=Yt(a[sf[u]]));if(t.NumberFmt&&a.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[u]){a.numFmtId=u;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};c.vertical&&(h.vertical=c.vertical),c.horizontal&&(h.horizontal=c.horizontal),c.textRotation!=null&&(h.textRotation=c.textRotation),c.indent&&(h.indent=c.indent),c.wrapText&&(h.wrapText=Yt(c.wrapText)),a.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}function NC(e){var t=[];return t[t.length]=He("cellXfs",null),e.forEach(function(r){t[t.length]=He("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=He("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var CC=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,m){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(t))&&kC(v,p,m),(v=u.match(s))&&TC(v,p,h,m),(v=u.match(a))&&SC(v,p,h,m),(v=u.match(l))&&EC(v,p,h,m),(v=u.match(r))&&jC(v,p,m),p}})();function s2(e,t){var r=[pr,He("styleSheet",null,{xmlns:Ai[0],"xmlns:vt":kr.vt})],a;return e.SSF&&(a=AC(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=NC(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function OC(e,t){var r=e.read_shift(2),a=Qr(e);return[r,a]}function RC(e,t,r){r||(r=ke(6+4*t.length)),r.write_shift(2,e),Rr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function DC(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=mj(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var l=e.read_shift(2);switch(l===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(a.underline=c);var u=e.read_shift(1);u>0&&(a.family=u);var h=e.read_shift(1);switch(h>0&&(a.charset=h),e.l++,a.color=hj(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Qr(e),a}function FC(e,t){t||(t=ke(153)),t.write_shift(2,e.sz*20),pj(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),kf(e.color,t);var a=0;return a=2,t.write_shift(1,a),Rr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var MC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],vh,BC=Zr;function u_(e,t){t||(t=ke(84)),vh||(vh=Uf(MC));var r=vh[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(kf({auto:1},t),kf({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function LC(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function i2(e,t,r){r||(r=ke(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Pc(e,t){return t||(t=ke(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var UC=Zr;function IC(e,t){return t||(t=ke(51)),t.write_shift(1,0),Pc(null,t),Pc(null,t),Pc(null,t),Pc(null,t),Pc(null,t),t.length>t.l?t.slice(0,t.l):t}function PC(e,t){return t||(t=ke(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Tf(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function zC(e,t,r){var a=ke(2052);return a.write_shift(4,e),Tf(t,a),Tf(r,a),a.length>a.l?a.slice(0,a.l):a}function HC(e,t,r){var a={};a.NumberFmt=[];for(var s in nt)a.NumberFmt[s]=nt[s];a.CellXf=[],a.Fonts=[];var l=[],c=!1;return Qn(e,function(h,m,p){switch(p){case 44:a.NumberFmt[h[0]]=h[1],Xn(h[1],h[0]);break;case 43:a.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=Nf(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&a.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(p),c=!0;break;case 38:l.pop(),c=!1;break;default:if(m.T>0)l.push(p);else if(m.T<0)l.pop();else if(!c||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),a}function qC(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(Fe(e,615,fn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Fe(e,44,RC(s,t[s]))}),Fe(e,616))}}function VC(e){var t=1;Fe(e,611,fn(t)),Fe(e,43,FC({sz:12,color:{theme:1},name:"Calibri",family:2})),Fe(e,612)}function GC(e){var t=2;Fe(e,603,fn(t)),Fe(e,45,u_({patternType:"none"})),Fe(e,45,u_({patternType:"gray125"})),Fe(e,604)}function $C(e){var t=1;Fe(e,613,fn(t)),Fe(e,46,IC()),Fe(e,614)}function WC(e){var t=1;Fe(e,626,fn(t)),Fe(e,47,i2({numFmtId:0},65535)),Fe(e,627)}function XC(e,t){Fe(e,617,fn(t.length)),t.forEach(function(r){Fe(e,47,i2(r,0))}),Fe(e,618)}function KC(e){var t=1;Fe(e,619,fn(t)),Fe(e,48,PC({xfId:0,name:"Normal"})),Fe(e,620)}function YC(e){var t=0;Fe(e,505,fn(t)),Fe(e,506)}function JC(e){var t=0;Fe(e,508,zC(t,"TableStyleMedium9","PivotStyleMedium4")),Fe(e,509)}function QC(e,t){var r=ga();return Fe(r,278),qC(r,e.SSF),VC(r),GC(r),$C(r),WC(r),XC(r,t.cellXfs),KC(r),YC(r),JC(r),Fe(r,279),r.end()}var ZC=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function e3(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(ea)||[]).forEach(function(s){var l=lt(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=l.val;break;case"<a:sysClr":a.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[ZC.indexOf(l[0])]=a,a={}):a.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function t3(){}function r3(){}var a3=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,n3=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,s3=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function i3(e,t,r){t.themeElements={};var a;[["clrScheme",a3,e3],["fontScheme",n3,t3],["fmtScheme",s3,r3]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var l3=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function l2(e,t){(!e||e.length===0)&&(e=Pm());var r,a={};if(!(r=e.match(l3)))throw new Error("themeElements not found in theme");return i3(r[0],a,t),a.raw=e,a}function Pm(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[pr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function c3(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var l=e.slice(e.l);e.l=a;var c;try{c=Zy(l,{type:"array"})}catch{return}var u=Ca(c,"theme/theme/theme1.xml",!0);if(u)return l2(u,r)}}function o3(e){return e.read_shift(4)}function u3(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=f3(e,4);break;case 2:t.xclrValue=Pw(e);break;case 3:t.xclrValue=o3(e);break;case 4:e.l+=4;break}return e.l+=8,t}function f3(e,t){return Zr(e,t)}function d3(e,t){return Zr(e,t)}function h3(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=u3(e);break;case 6:a[1]=d3(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function m3(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(h3(e,r-e.l));return{ixfe:a,ext:l}}function p3(e,t){t.forEach(function(r){r[0]})}function g3(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Qr(e)}}function x3(e){var t=ke(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Rr(e.name,t),t.slice(0,t.l)}function v3(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function _3(e){var t=ke(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function y3(e,t){var r=ke(8+2*t.length);return r.write_shift(4,e),Rr(t,r),r.slice(0,r.l)}function w3(e){return e.l+=4,e.read_shift(4)!=0}function b3(e,t){var r=ke(8);return r.write_shift(4,e),r.write_shift(4,1),r}function E3(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},l=[],c=!1,u=2;return Qn(e,function(h,m,p){switch(p){case 335:a.Types.push({name:h.name});break;case 51:h.forEach(function(v){u==1?a.Cell.push({type:a.Types[v[0]-1].name,index:v[1]}):u==0&&a.Value.push({type:a.Types[v[0]-1].name,index:v[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(p),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!m.T){if(!c||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),a}function S3(){var e=ga();return Fe(e,332),Fe(e,334,fn(1)),Fe(e,335,x3({name:"XLDAPR",version:12e4,flags:3496657072})),Fe(e,336),Fe(e,339,y3(1,"XLDAPR")),Fe(e,52),Fe(e,35,fn(514)),Fe(e,4096,fn(0)),Fe(e,4097,Ka(1)),Fe(e,36),Fe(e,53),Fe(e,340),Fe(e,337,b3(1)),Fe(e,51,_3([[1,0]])),Fe(e,338),Fe(e,333),e.end()}function T3(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,l=2,c;return e.replace(ea,function(u){var h=lt(u);switch(En(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<a.Types.length;++m)a.Types[m].name==h.name&&(c=a.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?a.Cell.push({type:a.Types[h.t-1].name,index:+h.v}):l==0&&a.Value.push({type:a.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+h.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),a}function c2(){var e=[pr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function k3(e){var t=[];if(!e)return t;var r=1;return(e.match(ea)||[]).forEach(function(a){var s=lt(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function A3(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=st(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function j3(e,t,r){var a=[];return Qn(e,function(l,c,u){switch(u){case 63:a.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function N3(e,t,r,a){if(!e)return e;var s=a||{},l=!1;Qn(e,function(u,h,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},s)}function C3(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var kl=1024;function o2(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[He("xml",null,{"xmlns:v":Ta.v,"xmlns:o":Ta.o,"xmlns:x":Ta.x,"xmlns:mv":Ta.mv}).replace(/\/>/,">"),He("o:shapelayout",He("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),He("v:shapetype",[He("v:stroke",null,{joinstyle:"miter"}),He("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];kl<e*1e3;)kl+=1e3;return t.forEach(function(l){var c=sr(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?He("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,m=He("v:fill",h,u),p={on:"t",obscured:"t"};++kl,s=s.concat(["<v:shape"+lo({id:"_x0000_s"+kl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",m,He("v:shadow",null,p),He("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Vr("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),Vr("x:AutoFill","False"),Vr("x:Row",String(c.r)),Vr("x:Column",String(c.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function f_(e,t,r,a){var s=Array.isArray(e),l;t.forEach(function(c){var u=sr(c.ref);if(s?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[c.ref],!l){l={t:"z"},s?e[u.r][u.c]=l:e[c.ref]=l;var h=Nt(e["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var m=dt(h);m!==e["!ref"]&&(e["!ref"]=m)}l.c||(l.c=[]);var p={a:c.author,t:c.t,r:c.r,T:r};c.h&&(p.h=c.h);for(var v=l.c.length-1;v>=0;--v){if(!r&&l.c[v].T)return;r&&!l.c[v].T&&l.c.splice(v,1)}if(r&&a){for(v=0;v<a.length;++v)if(p.a==a[v].id){p.a=a[v].name||p.a;break}}l.c.push(p)})}function O3(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=lt(u[0]),m={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=sr(h.ref);if(!(t.sheetRows&&t.sheetRows<=p.r)){var v=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!v&&!!v[1]&&Lm(v[1])||{r:"",t:"",h:""};m.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),m.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(m.h=_.h),a.push(m)}}}}),a}function u2(e){var t=[pr,He("comments",null,{xmlns:Ai[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var l=It(s.a);r.indexOf(l)==-1&&(r.push(l),t.push("<author>"+l+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,l=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(h){h.a&&(s=r.indexOf(It(h.a))),l.push(h.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),l.length<=1)t.push(Vr("t",It(l[0]||"")));else{for(var c=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)c+=`Reply:
    `+l[u]+`
`;t.push(Vr("t",It(c)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function R3(e,t){var r=[],a=!1,s={},l=0;return e.replace(ea,function(u,h){var m=lt(u);switch(En(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":s.t=e.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return u}),r}function D3(e,t,r){var a=[pr,He("ThreadedComments",null,{xmlns:kr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var l="";(s[1]||[]).forEach(function(c,u){if(!c.T){delete c.ID;return}c.a&&t.indexOf(c.a)==-1&&t.push(c.a);var h={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?l=h.id:h.parentId=l,c.ID=h.id,c.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(c.a)).slice(-12)+"}"),a.push(He("threadedComment",Vr("text",c.t||""),h))})}),a.push("</ThreadedComments>"),a.join("")}function F3(e,t){var r=[],a=!1;return e.replace(ea,function(l){var c=lt(l);switch(En(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),r}function M3(e){var t=[pr,He("personList",null,{xmlns:kr.TCMNT,"xmlns:x":Ai[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(He("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function B3(e){var t={};t.iauthor=e.read_shift(4);var r=Oi(e);return t.rfx=r.s,t.ref=st(r.s),e.l+=16,t}function L3(e,t){return t==null&&(t=ke(36)),t.write_shift(4,e[1].iauthor),Gl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var U3=Qr;function I3(e){return Rr(e.slice(0,54))}function P3(e,t){var r=[],a=[],s={},l=!1;return Qn(e,function(u,h,m){switch(m){case 632:a.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),r}function z3(e){var t=ga(),r=[];return Fe(t,628),Fe(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Fe(t,632,I3(s.a)))})}),Fe(t,631),Fe(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var l={s:sr(a[0]),e:sr(a[0])};Fe(t,635,L3([l,s])),s.t&&s.t.length>0&&Fe(t,637,oj(s)),Fe(t,636),delete s.iauthor})}),Fe(t,634),Fe(t,629),t.end()}var H3="application/vnd.ms-office.vbaProject";function q3(e){var t=tt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(t,s,e.FileIndex[a].content)}}),tt.write(t)}function V3(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&tt.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var f2=["xlsb","xlsm","xlam","biff8","xla"];function G3(){return{"!type":"dialog"}}function $3(){return{"!type":"dialog"}}function W3(){return{"!type":"macro"}}function X3(){return{"!type":"macro"}}var Rl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,l,c){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var m=l.length>0?parseInt(l,10)|0:0,p=c.length>0?parseInt(c,10)|0:0;return u?p+=t.c:--p,h?m+=t.r:--m,s+(u?"":"$")+nr(p)+(h?"":"$")+mr(m)}return function(s,l){return t=l,s.replace(e,r)}})(),zm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Hm=(function(){return function(t,r){return t.replace(zm,function(a,s,l,c,u,h){var m=jm(c)-(l?0:r.c),p=Am(h)-(u?0:r.r),v=p==0?"":u?p+1:"["+p+"]",_=m==0?"":l?m+1:"["+m+"]";return s+"R"+v+"C"+_})}})();function d2(e,t){return e.replace(zm,function(r,a,s,l,c,u){return a+(s=="$"?s+l:nr(jm(l)+t.c))+(c=="$"?c+u:mr(Am(u)+t.r))})}function K3(e,t,r){var a=xa(t),s=a.s,l=sr(r),c={r:l.r-s.r,c:l.c-s.c};return d2(e,c)}function Y3(e){return e.length!=1}function d_(e){return e.replace(/_xlfn\./g,"")}function yr(e){e.l+=1}function Bs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function h2(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return m2(e);r.biff==12&&(a=4)}var s=e.read_shift(a),l=e.read_shift(a),c=Bs(e),u=Bs(e);return{s:{r:s,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function m2(e){var t=Bs(e),r=Bs(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function J3(e,t,r){if(r.biff<8)return m2(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),l=Bs(e),c=Bs(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function p2(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Q3(e);var a=e.read_shift(r&&r.biff==12?4:2),s=Bs(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function Q3(e){var t=Bs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Z3(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function eO(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return tO(e);var s=e.read_shift(a>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;s>524287;)s-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:c,rRel:u}}function tO(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function rO(e,t,r){var a=(e[e.l++]&96)>>5,s=h2(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function aO(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=h2(e,l,r);return[a,s,c]}function nO(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function sO(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[a,s]}function iO(e,t,r){var a=(e[e.l++]&96)>>5,s=J3(e,t-1,r);return[a,s]}function lO(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function h_(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function cO(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],l=0;l<=a;++l)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function oO(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function uO(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function fO(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function dO(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function g2(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function hO(e){return e.read_shift(2),g2(e)}function mO(e){return e.read_shift(2),g2(e)}function pO(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=p2(e,0,r);return[a,s]}function gO(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=eO(e,0,r);return[a,s]}function xO(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=p2(e,0,r);return[a,s,l]}function vO(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[w8[s],_2[s],a]}function _O(e,t,r){var a=e[e.l++],s=e.read_shift(1),l=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:yO(e);return[s,(l[0]===0?_2:y8)[l[1]]]}function yO(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function wO(e,t,r){e.l+=r&&r.biff==2?3:4}function bO(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function EO(e){return e.l++,Zn[e.read_shift(1)]}function SO(e){return e.l++,e.read_shift(2)}function TO(e){return e.l++,e.read_shift(1)!==0}function kO(e){return e.l++,Jr(e)}function AO(e,t,r){return e.l++,wo(e,t-1,r)}function jO(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=hr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Zn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Jr(e);break;case 2:r[1]=Ri(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function NO(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],l=0;l!=a;++l)s.push((r.biff==12?Oi:zf)(e));return s}function CO(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var l=0,c=[];l!=a&&(c[l]=[]);++l)for(var u=0;u!=s;++u)c[l][u]=jO(e,r.biff);return c}function OO(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,l=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,l]}function RO(e,t,r){if(r.biff==5)return DO(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[a,s,l]}function DO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function FO(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function MO(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function BO(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function LO(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[a,s]}var UO=Zr,IO=Zr,PO=Zr;function Eo(e,t,r){return e.l+=2,[Z3(e)]}function qm(e){return e.l+=6,[]}var zO=Eo,HO=qm,qO=qm,VO=Eo;function x2(e){return e.l+=2,[Er(e),e.read_shift(2)&1]}var GO=Eo,$O=x2,WO=qm,XO=Eo,KO=Eo,YO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function JO(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),c=YO[r>>2&31];return{ixti:t,coltype:r&3,rt:c,idx:a,c:s,C:l}}function QO(e){return e.l+=2,[e.read_shift(4)]}function ZO(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function e8(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function t8(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function r8(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function a8(e){return e.l+=4,[0,0]}var m_={1:{n:"PtgExp",f:bO},2:{n:"PtgTbl",f:PO},3:{n:"PtgAdd",f:yr},4:{n:"PtgSub",f:yr},5:{n:"PtgMul",f:yr},6:{n:"PtgDiv",f:yr},7:{n:"PtgPower",f:yr},8:{n:"PtgConcat",f:yr},9:{n:"PtgLt",f:yr},10:{n:"PtgLe",f:yr},11:{n:"PtgEq",f:yr},12:{n:"PtgGe",f:yr},13:{n:"PtgGt",f:yr},14:{n:"PtgNe",f:yr},15:{n:"PtgIsect",f:yr},16:{n:"PtgUnion",f:yr},17:{n:"PtgRange",f:yr},18:{n:"PtgUplus",f:yr},19:{n:"PtgUminus",f:yr},20:{n:"PtgPercent",f:yr},21:{n:"PtgParen",f:yr},22:{n:"PtgMissArg",f:yr},23:{n:"PtgStr",f:AO},26:{n:"PtgSheet",f:ZO},27:{n:"PtgEndSheet",f:e8},28:{n:"PtgErr",f:EO},29:{n:"PtgBool",f:TO},30:{n:"PtgInt",f:SO},31:{n:"PtgNum",f:kO},32:{n:"PtgArray",f:lO},33:{n:"PtgFunc",f:vO},34:{n:"PtgFuncVar",f:_O},35:{n:"PtgName",f:OO},36:{n:"PtgRef",f:pO},37:{n:"PtgArea",f:rO},38:{n:"PtgMemArea",f:FO},39:{n:"PtgMemErr",f:UO},40:{n:"PtgMemNoMem",f:IO},41:{n:"PtgMemFunc",f:MO},42:{n:"PtgRefErr",f:BO},43:{n:"PtgAreaErr",f:nO},44:{n:"PtgRefN",f:gO},45:{n:"PtgAreaN",f:iO},46:{n:"PtgMemAreaN",f:t8},47:{n:"PtgMemNoMemN",f:r8},57:{n:"PtgNameX",f:RO},58:{n:"PtgRef3d",f:xO},59:{n:"PtgArea3d",f:aO},60:{n:"PtgRefErr3d",f:LO},61:{n:"PtgAreaErr3d",f:sO},255:{}},n8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},s8={1:{n:"PtgElfLel",f:x2},2:{n:"PtgElfRw",f:XO},3:{n:"PtgElfCol",f:zO},6:{n:"PtgElfRwV",f:KO},7:{n:"PtgElfColV",f:VO},10:{n:"PtgElfRadical",f:GO},11:{n:"PtgElfRadicalS",f:WO},13:{n:"PtgElfColS",f:HO},15:{n:"PtgElfColSV",f:qO},16:{n:"PtgElfRadicalLel",f:$O},25:{n:"PtgList",f:JO},29:{n:"PtgSxName",f:QO},255:{}},i8={0:{n:"PtgAttrNoop",f:a8},1:{n:"PtgAttrSemi",f:dO},2:{n:"PtgAttrIf",f:uO},4:{n:"PtgAttrChoose",f:cO},8:{n:"PtgAttrGoto",f:oO},16:{n:"PtgAttrSum",f:wO},32:{n:"PtgAttrBaxcel",f:h_},33:{n:"PtgAttrBaxcel",f:h_},64:{n:"PtgAttrSpace",f:hO},65:{n:"PtgAttrSpaceSemi",f:mO},128:{n:"PtgAttrIfError",f:fO},255:{}};function So(e,t,r,a){if(a.biff<8)return Zr(e,t);for(var s=e.l+t,l=[],c=0;c!==r.length;++c)switch(r[c][0]){case"PtgArray":r[c][1]=CO(e,0,a),l.push(r[c][1]);break;case"PtgMemArea":r[c][2]=NO(e,r[c][1],a),l.push(r[c][2]);break;case"PtgExp":a&&a.biff==12&&(r[c][1][1]=e.read_shift(4),l.push(r[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[c][0]}return t=s-e.l,t!==0&&l.push(Zr(e,t)),l}function To(e,t,r){for(var a=e.l+t,s,l,c=[];a!=e.l;)t=a-e.l,l=e[e.l],s=m_[l]||m_[n8[l]],(l===24||l===25)&&(s=(l===24?s8:i8)[e[e.l+1]]),!s||!s.f?Zr(e,t):c.push([s.n,s.f(e,t,r)]);return c}function l8(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],l=0;l<a.length;++l){var c=a[l];if(c)switch(c[0]){case 2:s.push('"'+c[1].replace(/"/g,'""')+'"');break;default:s.push(c[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var c8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function o8(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function v2(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function p_(e,t,r){var a=v2(e,t,r);return a=="#REF"?a:o8(a,r)}function Kr(e,t,r,a,s){var l=s&&s.biff||8,c={s:{c:0,r:0}},u=[],h,m,p,v=0,_=0,y,b="";if(!e[0]||!e[0][0])return"";for(var w=-1,E="",k=0,A=e[0].length;k<A;++k){var S=e[0][k];switch(S[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),m=u.pop(),w>=0){switch(e[0][w][1][0]){case 0:E=cr(" ",e[0][w][1][1]);break;case 1:E=cr("\r",e[0][w][1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}m=m+E,w=-1}u.push(m+c8[S[0]]+h);break;case"PtgIsect":h=u.pop(),m=u.pop(),u.push(m+" "+h);break;case"PtgUnion":h=u.pop(),m=u.pop(),u.push(m+","+h);break;case"PtgRange":h=u.pop(),m=u.pop(),u.push(m+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Xc(S[1][1],c,s),u.push(Kc(p,l));break;case"PtgRefN":p=r?Xc(S[1][1],r,s):S[1][1],u.push(Kc(p,l));break;case"PtgRef3d":v=S[1][1],p=Xc(S[1][2],c,s),b=p_(a,v,s),u.push(b+"!"+Kc(p,l));break;case"PtgFunc":case"PtgFuncVar":var j=S[1][0],F=S[1][1];j||(j=0),j&=127;var R=j==0?[]:u.slice(-j);u.length-=j,F==="User"&&(F=R.shift()),u.push(F+"("+R.join(",")+")");break;case"PtgBool":u.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(S[1]);break;case"PtgNum":u.push(String(S[1]));break;case"PtgStr":u.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(S[1]);break;case"PtgAreaN":y=V1(S[1][1],r?{s:r}:c,s),u.push(mh(y,s));break;case"PtgArea":y=V1(S[1][1],c,s),u.push(mh(y,s));break;case"PtgArea3d":v=S[1][1],y=S[1][2],b=p_(a,v,s),u.push(b+"!"+mh(y,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=S[1][2];var N=(a.names||[])[_-1]||(a[0]||[])[_],X=N?N.Name:"SH33TJSNAME"+String(_);X&&X.slice(0,6)=="_xlfn."&&!s.xlfn&&(X=X.slice(6)),u.push(X);break;case"PtgNameX":var G=S[1][1];_=S[1][2];var se;if(s.biff<=5)G<0&&(G=-G),a[G]&&(se=a[G][_]);else{var te="";if(((a[G]||[])[0]||[])[0]==14849||(((a[G]||[])[0]||[])[0]==1025?a[G][_]&&a[G][_].itab>0&&(te=a.SheetNames[a[G][_].itab-1]+"!"):te=a.SheetNames[_-1]+"!"),a[G]&&a[G][_])te+=a[G][_].Name;else if(a[0]&&a[0][_])te+=a[0][_].Name;else{var z=(v2(a,G,s)||"").split(";;");z[_-1]?te=z[_-1]:te+="SH33TJSERRX"}u.push(te);break}se||(se={Name:"SH33TJSERRY"}),u.push(se.Name);break;case"PtgParen":var ge="(",Oe=")";if(w>=0){switch(E="",e[0][w][1][0]){case 2:ge=cr(" ",e[0][w][1][1])+ge;break;case 3:ge=cr("\r",e[0][w][1][1])+ge;break;case 4:Oe=cr(" ",e[0][w][1][1])+Oe;break;case 5:Oe=cr("\r",e[0][w][1][1])+Oe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}u.push(ge+u.pop()+Oe);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:S[1][1],r:S[1][0]};var Ce={c:r.c,r:r.r};if(a.sharedf[st(p)]){var Q=a.sharedf[st(p)];u.push(Kr(Q,c,Ce,a,s))}else{var le=!1;for(h=0;h!=a.arrayf.length;++h)if(m=a.arrayf[h],!(p.c<m[0].s.c||p.c>m[0].e.c)&&!(p.r<m[0].s.r||p.r>m[0].e.r)){u.push(Kr(m[1],c,Ce,a,s)),le=!0;break}le||u.push(S[1])}break;case"PtgArray":u.push("{"+l8(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var Ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&w>=0&&Ee.indexOf(e[0][k][0])==-1){S=e[0][w];var K=!0;switch(S[1][0]){case 4:K=!1;case 0:E=cr(" ",S[1][1]);break;case 5:K=!1;case 1:E=cr("\r",S[1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}u.push((K?E:"")+u.pop()+(K?"":E)),w=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function u8(e,t,r){var a=e.l+t,s=r.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],Zr(e,t-2)];var u=To(e,c,r);return t!==c+s&&(l=So(e,t-c-s,u,r)),e.l=a,[u,l]}function f8(e,t,r){var a=e.l+t,s=r.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],Zr(e,t-2)];var u=To(e,c,r);return t!==c+s&&(l=So(e,t-c-s,u,r)),e.l=a,[u,l]}function d8(e,t,r,a){var s=e.l+t,l=To(e,a,r),c;return s!==e.l&&(c=So(e,s-e.l,l,r)),[l,c]}function h8(e,t,r){var a=e.l+t,s,l=e.read_shift(2),c=To(e,l,r);return l==65535?[[],Zr(e,t-2)]:(t!==l+2&&(s=So(e,a-l-2,c,r)),[c,s])}function m8(e){var t;if($n(e,e.l+6)!==65535)return[Jr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function p8(e){if(e==null){var t=ke(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ei(e);return Ei(0)}function _h(e,t,r){var a=e.l+t,s=Sn(e);r.biff==2&&++e.l;var l=m8(e),c=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=f8(e,a-e.l,r);return{cell:s,val:l[0],formula:u,shared:c>>3&1,tt:l[1]}}function g8(e,t,r,a,s){var l=Ti(t,r,s),c=p8(e.v),u=ke(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var m=ke(e.bf.length),p=0;p<e.bf.length;++p)m[p]=e.bf[p];var v=Or([l,c,u,m]);return v}function Hf(e,t,r){var a=e.read_shift(4),s=To(e,a,r),l=e.read_shift(4),c=l>0?So(e,l,s,r):null;return[s,c]}var x8=Hf,qf=Hf,v8=Hf,_8=Hf,y8={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},_2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},w8={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function g_(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function b8(e){var t="of:="+e.replace(zm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function yh(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function E8(e){return e.replace(/\./,"!")}var Jc={},Dl={},Qc=typeof Map<"u";function Vm(e,t,r){var a=0,s=e.length;if(r){if(Qc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var l=Qc?r.get(t):r[t];a<l.length;++a)if(e[l[a]].t===t)return e.Count++,l[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(Qc?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function Vf(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Yr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=ho(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Cf(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function yi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ps(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,l=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Xn(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=l;++s)if(e[s].numFmtId===a)return s;return e[l]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function y2(e,t,r,a,s,l){try{a.cellNF&&(e.z=nt[t])}catch(u){if(a.WTF)throw u}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Jt(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(nt[t]==null&&Xn(yA[t]||"General",t),e.t==="e")e.w=e.w||Zn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=so(e.v);else if(e.t==="d"){var c=Ar(e.v);(c|0)===c?e.w=c.toString(10):e.w=so(c)}else{if(e.v===void 0)return"";e.w=wi(e.v,Dl)}else e.t==="d"?e.w=Ja(t,Ar(e.v),Dl):e.w=Ja(t,e.v,Dl)}catch(u){if(a.WTF)throw u}if(a.cellStyles&&r!=null)try{e.s=l.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Nf(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Nf(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(a.WTF&&l.Fills)throw u}}}function S8(e,t,r){if(e&&e["!ref"]){var a=Nt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function T8(e,t){var r=Nt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=dt(r))}var k8=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,A8=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,j8=/<(?:\w:)?hyperlink [^>]*>/mg,N8=/"(\w*:\w*)"/,C8=/<(?:\w:)?col\b[^>]*[\/]?>/g,O8=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,R8=/<(?:\w:)?pageMargins[^>]*\/>/g,w2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,D8=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,F8=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function M8(e,t,r,a,s,l,c){if(!e)return e;a||(a={"!id":{}});var u=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",p="",v=e.match(A8);v?(m=e.slice(0,v.index),p=e.slice(v.index+v[0].length)):m=p=e;var _=m.match(w2);_?Gm(_[0],u,s,r):(_=m.match(D8))&&L8(_[0],_[1]||"",u,s,r);var y=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var b=m.slice(y,y+50).match(N8);b&&T8(u,b[1])}var w=m.match(F8);w&&w[1]&&Y8(w[1],s);var E=[];if(t.cellStyles){var k=m.match(C8);k&&G8(E,k)}v&&Z8(v[1],u,t,h,l,c);var A=p.match(O8);A&&(u["!autofilter"]=W8(A[0]));var S=[],j=p.match(k8);if(j)for(y=0;y!=j.length;++y)S[y]=Nt(j[y].slice(j[y].indexOf('"')+1));var F=p.match(j8);F&&H8(u,F,a);var R=p.match(R8);if(R&&(u["!margins"]=q8(lt(R[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=dt(h)),t.sheetRows>0&&u["!ref"]){var N=Nt(u["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>h.e.r&&(N.e.r=h.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>h.e.c&&(N.e.c=h.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),u["!fullref"]=u["!ref"],u["!ref"]=dt(N))}return E.length>0&&(u["!cols"]=E),S.length>0&&(u["!merges"]=S),u}function B8(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+dt(e[r])+'"/>';return t+"</mergeCells>"}function Gm(e,t,r,a){var s=lt(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=jt(qt(s.codeName)))}function L8(e,t,r,a,s){Gm(e.slice(0,e.indexOf(">")),r,a,s)}function U8(e,t,r,a,s){var l=!1,c={},u=null;if(a.bookType!=="xlsx"&&t.vbaraw){var h=t.SheetNames[r];try{t.Workbook&&(h=t.Workbook.Sheets[r].CodeName||h)}catch{}l=!0,c.codeName=wn(It(h))}if(e&&e["!outline"]){var m={summaryBelow:1,summaryRight:1};e["!outline"].above&&(m.summaryBelow=0),e["!outline"].left&&(m.summaryRight=0),u=(u||"")+He("outlinePr",null,m)}!l&&!u||(s[s.length]=He("sheetPr",u,c))}var I8=["objects","scenarios","selectLockedCells","selectUnlockedCells"],P8=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function z8(e){var t={sheet:1};return I8.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),P8.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Um(e.password).toString(16).toUpperCase()),He("sheetProtection",null,t)}function H8(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var l=lt(qt(t[s]),!0);if(!l.ref)return;var c=((r||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+jt(l.location))):(l.Target="#"+jt(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=Nt(l.ref),h=u.s.r;h<=u.e.r;++h)for(var m=u.s.c;m<=u.e.c;++m){var p=st({c:m,r:h});a?(e[h]||(e[h]=[]),e[h][m]||(e[h][m]={t:"z",v:void 0}),e[h][m].l=l):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=l)}}}function q8(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function V8(e){return yi(e),He("pageMargins",null,e)}function G8(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=lt(t[a],!0);s.hidden&&(s.hidden=Yt(s.hidden));var l=parseInt(s.min,10)-1,c=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Im(s.width)),Ms(s);l<=c;)e[l++]=Qt(s)}}function $8(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=He("col",null,Vf(s,a)));return r[r.length]="</cols>",r.join("")}function W8(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function X8(e,t,r,a){var s=typeof e.ref=="string"?e.ref:dt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,c=xa(s);c.s.r==c.e.r&&(c.e.r=xa(t["!ref"]).e.r,s=dt(c));for(var u=0;u<l.length;++u){var h=l[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==a){h.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),He("autoFilter",null,{ref:s})}var K8=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Y8(e,t){t.Views||(t.Views=[{}]),(e.match(K8)||[]).forEach(function(r,a){var s=lt(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),Yt(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function J8(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),He("sheetViews",He("sheetView",null,s),{})}function Q8(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",l=e.t,c=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Zn[e.v];break;case"d":a&&a.cellDates?s=Jt(e.v,-1).toISOString():(e=Qt(e),e.t="n",s=""+(e.v=Ar(Jt(e.v)))),typeof e.z>"u"&&(e.z=nt[14]);break;default:s=e.v;break}var u=Vr("v",It(s)),h={r:t},m=Ps(a.cellXfs,e,a);switch(m!==0&&(h.s=m),e.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){u=Vr("v",""+Vm(a.Strings,e.v,a.revStrings)),h.t="s";break}h.t="str";break}if(e.t!=l&&(e.t=l,e.v=c),typeof e.f=="string"&&e.f){var p=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=He("f",It(e.f),p)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(h.cm=1),He("c",u,h)}var Z8=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=io("v"),c=io("f");return function(h,m,p,v,_,y){for(var b=0,w="",E=[],k=[],A=0,S=0,j=0,F="",R,N,X=0,G=0,se,te,z=0,ge=0,Oe=Array.isArray(y.CellXf),Ce,Q=[],le=[],Ee=Array.isArray(m),K=[],Te={},q=!1,C=!!p.sheetStubs,H=h.split(t),I=0,L=H.length;I!=L;++I){w=H[I].trim();var Z=w.length;if(Z!==0){var re=0;e:for(b=0;b<Z;++b)switch(w[b]){case">":if(w[b-1]!="/"){++b;break e}if(p&&p.cellStyles){if(N=lt(w.slice(re,b),!0),X=N.r!=null?parseInt(N.r,10):X+1,G=-1,p.sheetRows&&p.sheetRows<X)continue;Te={},q=!1,N.ht&&(q=!0,Te.hpt=parseFloat(N.ht),Te.hpx=Il(Te.hpt)),N.hidden=="1"&&(q=!0,Te.hidden=!0),N.outlineLevel!=null&&(q=!0,Te.level=+N.outlineLevel),q&&(K[X-1]=Te)}break;case"<":re=b;break}if(re>=b)break;if(N=lt(w.slice(re,b),!0),X=N.r!=null?parseInt(N.r,10):X+1,G=-1,!(p.sheetRows&&p.sheetRows<X)){v.s.r>X-1&&(v.s.r=X-1),v.e.r<X-1&&(v.e.r=X-1),p&&p.cellStyles&&(Te={},q=!1,N.ht&&(q=!0,Te.hpt=parseFloat(N.ht),Te.hpx=Il(Te.hpt)),N.hidden=="1"&&(q=!0,Te.hidden=!0),N.outlineLevel!=null&&(q=!0,Te.level=+N.outlineLevel),q&&(K[X-1]=Te)),E=w.slice(b).split(e);for(var de=0;de!=E.length&&E[de].trim().charAt(0)=="<";++de);for(E=E.slice(de),b=0;b!=E.length;++b)if(w=E[b].trim(),w.length!==0){if(k=w.match(r),A=b,S=0,j=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,k!=null&&k.length===2){for(A=0,F=k[1],S=0;S!=F.length&&!((j=F.charCodeAt(S)-64)<1||j>26);++S)A=26*A+j;--A,G=A}else++G;for(S=0;S!=w.length&&w.charCodeAt(S)!==62;++S);if(++S,N=lt(w.slice(0,S),!0),N.r||(N.r=st({r:X-1,c:G})),F=w.slice(S),R={t:""},(k=F.match(l))!=null&&k[1]!==""&&(R.v=jt(k[1])),p.cellFormula){if((k=F.match(c))!=null&&k[1]!==""){if(R.f=jt(qt(k[1])).replace(/\r\n/g,`
`),p.xlfn||(R.f=d_(R.f)),k[0].indexOf('t="array"')>-1)R.F=(F.match(s)||[])[1],R.F.indexOf(":")>-1&&Q.push([Nt(R.F),R.F]);else if(k[0].indexOf('t="shared"')>-1){te=lt(k[0]);var ve=jt(qt(k[1]));p.xlfn||(ve=d_(ve)),le[parseInt(te.si,10)]=[te,ve,N.r]}}else(k=F.match(/<f[^>]*\/>/))&&(te=lt(k[0]),le[te.si]&&(R.f=K3(le[te.si][1],le[te.si][2],N.r)));var Se=sr(N.r);for(S=0;S<Q.length;++S)Se.r>=Q[S][0].s.r&&Se.r<=Q[S][0].e.r&&Se.c>=Q[S][0].s.c&&Se.c<=Q[S][0].e.c&&(R.F=Q[S][1])}if(N.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(C)R.t="z";else continue;else R.t=N.t||"n";switch(v.s.c>G&&(v.s.c=G),v.e.c<G&&(v.e.c=G),R.t){case"n":if(R.v==""||R.v==null){if(!C)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!C)continue;R.t="z"}else se=Jc[parseInt(R.v,10)],R.v=se.t,R.r=se.r,p.cellHTML&&(R.h=se.h);break;case"str":R.t="s",R.v=R.v!=null?qt(R.v):"",p.cellHTML&&(R.h=Em(R.v));break;case"inlineStr":k=F.match(a),R.t="s",k!=null&&(se=Lm(k[1]))?(R.v=se.t,p.cellHTML&&(R.h=se.h)):R.v="";break;case"b":R.v=Yt(R.v);break;case"d":p.cellDates?R.v=Jt(R.v,1):(R.v=Ar(Jt(R.v,1)),R.t="n");break;case"e":(!p||p.cellText!==!1)&&(R.w=R.v),R.v=Ew[R.v];break}if(z=ge=0,Ce=null,Oe&&N.s!==void 0&&(Ce=y.CellXf[N.s],Ce!=null&&(Ce.numFmtId!=null&&(z=Ce.numFmtId),p.cellStyles&&Ce.fillId!=null&&(ge=Ce.fillId))),y2(R,z,ge,p,_,y),p.cellDates&&Oe&&R.t=="n"&&Hl(nt[z])&&(R.t="d",R.v=Pf(R.v)),N.cm&&p.xlmeta){var xe=(p.xlmeta.Cell||[])[+N.cm-1];xe&&xe.type=="XLDAPR"&&(R.D=!0)}if(Ee){var U=sr(N.r);m[U.r]||(m[U.r]=[]),m[U.r][U.c]=R}else m[N.r]=R}}}}K.length>0&&(m["!rows"]=K)}})();function eR(e,t,r,a){var s=[],l=[],c=Nt(e["!ref"]),u="",h,m="",p=[],v=0,_=0,y=e["!rows"],b=Array.isArray(e),w={r:m},E,k=-1;for(_=c.s.c;_<=c.e.c;++_)p[_]=nr(_);for(v=c.s.r;v<=c.e.r;++v){for(l=[],m=mr(v),_=c.s.c;_<=c.e.c;++_){h=p[_]+m;var A=b?(e[v]||[])[_]:e[h];A!==void 0&&(u=Q8(A,h,e,t))!=null&&l.push(u)}(l.length>0||y&&y[v])&&(w={r:m},y&&y[v]&&(E=y[v],E.hidden&&(w.hidden=1),k=-1,E.hpx?k=mo(E.hpx):E.hpt&&(k=E.hpt),k>-1&&(w.ht=k,w.customHeight=1),E.level&&(w.outlineLevel=E.level)),s[s.length]=He("row",l.join(""),w))}if(y)for(;v<y.length;++v)y&&y[v]&&(w={r:v+1},E=y[v],E.hidden&&(w.hidden=1),k=-1,E.hpx?k=mo(E.hpx):E.hpt&&(k=E.hpt),k>-1&&(w.ht=k,w.customHeight=1),E.level&&(w.outlineLevel=E.level),s[s.length]=He("row","",w));return s.join("")}function b2(e,t,r,a){var s=[pr,He("worksheet",null,{xmlns:Ai[0],"xmlns:r":kr.r})],l=r.SheetNames[e],c=0,u="",h=r.Sheets[l];h==null&&(h={});var m=h["!ref"]||"A1",p=Nt(m);if(p.e.c>16383||p.e.r>1048575){if(t.WTF)throw new Error("Range "+m+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),m=dt(p)}a||(a={}),h["!comments"]=[];var v=[];U8(h,r,e,t,s),s[s.length]=He("dimension",null,{ref:m}),s[s.length]=J8(h,t,e,r),t.sheetFormat&&(s[s.length]=He("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(s[s.length]=$8(h,h["!cols"])),s[c=s.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=eR(h,t),u.length>0&&(s[s.length]=u)),s.length>c+1&&(s[s.length]="</sheetData>",s[c]=s[c].replace("/>",">")),h["!protect"]&&(s[s.length]=z8(h["!protect"])),h["!autofilter"]!=null&&(s[s.length]=X8(h["!autofilter"],h,r,e)),h["!merges"]!=null&&h["!merges"].length>0&&(s[s.length]=B8(h["!merges"]));var _=-1,y,b=-1;return h["!links"].length>0&&(s[s.length]="<hyperlinks>",h["!links"].forEach(function(w){w[1].Target&&(y={ref:w[0]},w[1].Target.charAt(0)!="#"&&(b=Ut(a,-1,It(w[1].Target).replace(/#.*$/,""),vt.HLINK),y["r:id"]="rId"+b),(_=w[1].Target.indexOf("#"))>-1&&(y.location=It(w[1].Target.slice(_+1))),w[1].Tooltip&&(y.tooltip=It(w[1].Tooltip)),s[s.length]=He("hyperlink",null,y))}),s[s.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(s[s.length]=V8(h["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Vr("ignoredErrors",He("ignoredError",null,{numberStoredAsText:1,sqref:m}))),v.length>0&&(b=Ut(a,-1,"../drawings/drawing"+(e+1)+".xml",vt.DRAW),s[s.length]=He("drawing",null,{"r:id":"rId"+b}),h["!drawing"]=v),h["!comments"].length>0&&(b=Ut(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",vt.VML),s[s.length]=He("legacyDrawing",null,{"r:id":"rId"+b}),h["!legacy"]=b),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function tR(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=a,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=s/20),r}function rR(e,t,r){var a=ke(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var l=320;s.hpx?l=mo(s.hpx)*20:s.hpt&&(l=s.hpt*20),a.write_shift(2,l),a.write_shift(1,0);var c=0;s.level&&(c|=s.level),s.hidden&&(c|=16),(s.hpx||s.hpt)&&(c|=32),a.write_shift(1,c),a.write_shift(1,0);var u=0,h=a.l;a.l+=4;for(var m={r:e,c:0},p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var v=-1,_=-1,y=p<<10;y<p+1<<10;++y){m.c=y;var b=Array.isArray(r)?(r[m.r]||[])[m.c]:r[st(m)];b&&(v<0&&(v=y),_=y)}v<0||(++u,a.write_shift(4,v),a.write_shift(4,_))}var w=a.l;return a.l=h,a.write_shift(4,u),a.l=w,a.length>a.l?a.slice(0,a.l):a}function aR(e,t,r,a){var s=rR(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&Fe(e,0,s)}var nR=Oi,sR=Gl;function iR(){}function lR(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=uj(e),r}function cR(e,t,r){r==null&&(r=ke(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return kf({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),vw(e,r),r.slice(0,r.l)}function oR(e){var t=Qa(e);return[t]}function uR(e,t,r){return r==null&&(r=ke(8)),ji(t,r)}function fR(e){var t=Ni(e);return[t]}function dR(e,t,r){return r==null&&(r=ke(4)),Ci(t,r)}function hR(e){var t=Qa(e),r=e.read_shift(1);return[t,r,"b"]}function mR(e,t,r){return r==null&&(r=ke(9)),ji(t,r),r.write_shift(1,e.v?1:0),r}function pR(e){var t=Ni(e),r=e.read_shift(1);return[t,r,"b"]}function gR(e,t,r){return r==null&&(r=ke(5)),Ci(t,r),r.write_shift(1,e.v?1:0),r}function xR(e){var t=Qa(e),r=e.read_shift(1);return[t,r,"e"]}function vR(e,t,r){return r==null&&(r=ke(9)),ji(t,r),r.write_shift(1,e.v),r}function _R(e){var t=Ni(e),r=e.read_shift(1);return[t,r,"e"]}function yR(e,t,r){return r==null&&(r=ke(8)),Ci(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function wR(e){var t=Qa(e),r=e.read_shift(4);return[t,r,"s"]}function bR(e,t,r){return r==null&&(r=ke(12)),ji(t,r),r.write_shift(4,t.v),r}function ER(e){var t=Ni(e),r=e.read_shift(4);return[t,r,"s"]}function SR(e,t,r){return r==null&&(r=ke(8)),Ci(t,r),r.write_shift(4,t.v),r}function TR(e){var t=Qa(e),r=Jr(e);return[t,r,"n"]}function kR(e,t,r){return r==null&&(r=ke(16)),ji(t,r),Ei(e.v,r),r}function E2(e){var t=Ni(e),r=Jr(e);return[t,r,"n"]}function AR(e,t,r){return r==null&&(r=ke(12)),Ci(t,r),Ei(e.v,r),r}function jR(e){var t=Qa(e),r=Rm(e);return[t,r,"n"]}function NR(e,t,r){return r==null&&(r=ke(12)),ji(t,r),_w(e.v,r),r}function CR(e){var t=Ni(e),r=Rm(e);return[t,r,"n"]}function OR(e,t,r){return r==null&&(r=ke(8)),Ci(t,r),_w(e.v,r),r}function RR(e){var t=Qa(e),r=Nm(e);return[t,r,"is"]}function DR(e){var t=Qa(e),r=Qr(e);return[t,r,"str"]}function FR(e,t,r){return r==null&&(r=ke(12+4*e.v.length)),ji(t,r),Rr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function MR(e){var t=Ni(e),r=Qr(e);return[t,r,"str"]}function BR(e,t,r){return r==null&&(r=ke(8+4*e.v.length)),Ci(t,r),Rr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function LR(e,t,r){var a=e.l+t,s=Qa(e);s.r=r["!row"];var l=e.read_shift(1),c=[s,l,"b"];if(r.cellFormula){e.l+=2;var u=qf(e,a-e.l,r);c[3]=Kr(u,null,s,r.supbooks,r)}else e.l=a;return c}function UR(e,t,r){var a=e.l+t,s=Qa(e);s.r=r["!row"];var l=e.read_shift(1),c=[s,l,"e"];if(r.cellFormula){e.l+=2;var u=qf(e,a-e.l,r);c[3]=Kr(u,null,s,r.supbooks,r)}else e.l=a;return c}function IR(e,t,r){var a=e.l+t,s=Qa(e);s.r=r["!row"];var l=Jr(e),c=[s,l,"n"];if(r.cellFormula){e.l+=2;var u=qf(e,a-e.l,r);c[3]=Kr(u,null,s,r.supbooks,r)}else e.l=a;return c}function PR(e,t,r){var a=e.l+t,s=Qa(e);s.r=r["!row"];var l=Qr(e),c=[s,l,"str"];if(r.cellFormula){e.l+=2;var u=qf(e,a-e.l,r);c[3]=Kr(u,null,s,r.supbooks,r)}else e.l=a;return c}var zR=Oi,HR=Gl;function qR(e,t){return t==null&&(t=ke(4)),t.write_shift(4,e),t}function VR(e,t){var r=e.l+t,a=Oi(e),s=Cm(e),l=Qr(e),c=Qr(e),u=Qr(e);e.l=r;var h={rfx:a,relId:s,loc:l,display:u};return c&&(h.Tooltip=c),h}function GR(e,t){var r=ke(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Gl({s:sr(e[0]),e:sr(e[0])},r),Om("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return Rr(s||"",r),Rr(e[1].Tooltip||"",r),Rr("",r),r.slice(0,r.l)}function $R(){}function WR(e,t,r){var a=e.l+t,s=yw(e),l=e.read_shift(1),c=[s];if(c[2]=l,r.cellFormula){var u=x8(e,a-e.l,r);c[1]=u}else e.l=a;return c}function XR(e,t,r){var a=e.l+t,s=Oi(e),l=[s];if(r.cellFormula){var c=_8(e,a-e.l,r);l[1]=c,e.l=a}else e.l=a;return l}function KR(e,t,r){r==null&&(r=ke(18));var a=Vf(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var S2=["left","right","top","bottom","header","footer"];function YR(e){var t={};return S2.forEach(function(r){t[r]=Jr(e)}),t}function JR(e,t){return t==null&&(t=ke(48)),yi(e),S2.forEach(function(r){Ei(e[r],t)}),t}function QR(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function ZR(e,t,r){r==null&&(r=ke(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function e6(e){var t=ke(24);return t.write_shift(4,4),t.write_shift(4,1),Gl(e,t),t}function t6(e,t){return t==null&&(t=ke(66)),t.write_shift(2,e.password?Um(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function r6(){}function a6(){}function n6(e,t,r,a,s,l,c){if(!e)return e;var u=t||{};a||(a={"!id":{}});var h=u.dense?[]:{},m,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,_=!1,y,b,w,E,k,A,S,j,F,R=[];u.biff=12,u["!row"]=0;var N=0,X=!1,G=[],se={},te=u.supbooks||s.supbooks||[[]];if(te.sharedf=se,te.arrayf=G,te.SheetNames=s.SheetNames||s.Sheets.map(function(Ee){return Ee.name}),!u.supbooks&&(u.supbooks=te,s.Names))for(var z=0;z<s.Names.length;++z)te[0][z+1]=s.Names[z];var ge=[],Oe=[],Ce=!1;po[16]={n:"BrtShortReal",f:E2};var Q;if(Qn(e,function(K,Te,q){if(!_)switch(q){case 148:m=K;break;case 0:y=K,u.sheetRows&&u.sheetRows<=y.r&&(_=!0),j=mr(E=y.r),u["!row"]=y.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=Il(K.hpt)),Oe[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:K[2]},K[2]){case"n":b.v=K[1];break;case"s":S=Jc[K[1]],b.v=S.t,b.r=S.r;break;case"b":b.v=!!K[1];break;case"e":b.v=K[1],u.cellText!==!1&&(b.w=Zn[b.v]);break;case"str":b.t="s",b.v=K[1];break;case"is":b.t="s",b.v=K[1].t;break}if((w=c.CellXf[K[0].iStyleRef])&&y2(b,w.numFmtId,null,u,l,c),k=K[0].c==-1?k+1:K[0].c,u.dense?(h[E]||(h[E]=[]),h[E][k]=b):h[nr(k)+j]=b,u.cellFormula){for(X=!1,N=0;N<G.length;++N){var C=G[N];y.r>=C[0].s.r&&y.r<=C[0].e.r&&k>=C[0].s.c&&k<=C[0].e.c&&(b.F=dt(C[0]),X=!0)}!X&&K.length>3&&(b.f=K[3])}if(p.s.r>y.r&&(p.s.r=y.r),p.s.c>k&&(p.s.c=k),p.e.r<y.r&&(p.e.r=y.r),p.e.c<k&&(p.e.c=k),u.cellDates&&w&&b.t=="n"&&Hl(nt[w.numFmtId])){var H=pi(b.v);H&&(b.t="d",b.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}Q&&(Q.type=="XLDAPR"&&(b.D=!0),Q=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;b={t:"z",v:void 0},k=K[0].c==-1?k+1:K[0].c,u.dense?(h[E]||(h[E]=[]),h[E][k]=b):h[nr(k)+j]=b,p.s.r>y.r&&(p.s.r=y.r),p.s.c>k&&(p.s.c=k),p.e.r<y.r&&(p.e.r=y.r),p.e.c<k&&(p.e.c=k),Q&&(Q.type=="XLDAPR"&&(b.D=!0),Q=void 0);break;case 176:R.push(K);break;case 49:Q=((u.xlmeta||{}).Cell||[])[K-1];break;case 494:var I=a["!id"][K.relId];for(I?(K.Target=I.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=I):K.relId==""&&(K.Target="#"+K.loc),E=K.rfx.s.r;E<=K.rfx.e.r;++E)for(k=K.rfx.s.c;k<=K.rfx.e.c;++k)u.dense?(h[E]||(h[E]=[]),h[E][k]||(h[E][k]={t:"z",v:void 0}),h[E][k].l=K):(A=st({c:k,r:E}),h[A]||(h[A]={t:"z",v:void 0}),h[A].l=K);break;case 426:if(!u.cellFormula)break;G.push(K),F=u.dense?h[E][k]:h[nr(k)+j],F.f=Kr(K[1],p,{r:y.r,c:k},te,u),F.F=dt(K[0]);break;case 427:if(!u.cellFormula)break;se[st(K[0].s)]=K[1],F=u.dense?h[E][k]:h[nr(k)+j],F.f=Kr(K[1],p,{r:y.r,c:k},te,u);break;case 60:if(!u.cellStyles)break;for(;K.e>=K.s;)ge[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},Ce||(Ce=!0,Im(K.w/256)),Ms(ge[K.e+1]);break;case 161:h["!autofilter"]={ref:dt(K)};break;case 476:h["!margins"]=K;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),K.name&&(s.Sheets[r].CodeName=K.name),(K.above||K.left)&&(h["!outline"]={above:K.above,left:K.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),K.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!Te.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+q.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(p.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(h["!ref"]=dt(m||p)),u.sheetRows&&h["!ref"]){var le=Nt(h["!ref"]);u.sheetRows<=+le.e.r&&(le.e.r=u.sheetRows-1,le.e.r>p.e.r&&(le.e.r=p.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>p.e.c&&(le.e.c=p.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),h["!fullref"]=h["!ref"],h["!ref"]=dt(le))}return R.length>0&&(h["!merges"]=R),ge.length>0&&(h["!cols"]=ge),Oe.length>0&&(h["!rows"]=Oe),h}function s6(e,t,r,a,s,l,c){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=Qt(t),t.z=t.z||nt[14],t.v=Ar(Jt(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var h={r,c:a};switch(h.s=Ps(s.cellXfs,t,s),t.l&&l["!links"].push([st(h),t.l]),t.c&&l["!comments"].push([st(h),t.c]),t.t){case"s":case"str":return s.bookSST?(u=Vm(s.Strings,t.v,s.revStrings),h.t="s",h.v=u,c?Fe(e,18,SR(t,h)):Fe(e,7,bR(t,h))):(h.t="str",c?Fe(e,17,BR(t,h)):Fe(e,6,FR(t,h))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?c?Fe(e,13,OR(t,h)):Fe(e,2,NR(t,h)):c?Fe(e,16,AR(t,h)):Fe(e,5,kR(t,h)),!0;case"b":return h.t="b",c?Fe(e,15,gR(t,h)):Fe(e,4,mR(t,h)),!0;case"e":return h.t="e",c?Fe(e,14,yR(t,h)):Fe(e,3,vR(t,h)),!0}return c?Fe(e,12,dR(t,h)):Fe(e,1,uR(t,h)),!0}function i6(e,t,r,a){var s=Nt(t["!ref"]||"A1"),l,c="",u=[];Fe(e,145);var h=Array.isArray(t),m=s.e.r;t["!rows"]&&(m=Math.max(s.e.r,t["!rows"].length-1));for(var p=s.s.r;p<=m;++p){c=mr(p),aR(e,t,s,p);var v=!1;if(p<=s.e.r)for(var _=s.s.c;_<=s.e.c;++_){p===s.s.r&&(u[_]=nr(_)),l=u[_]+c;var y=h?(t[p]||[])[_]:t[l];if(!y){v=!1;continue}v=s6(e,y,p,_,a,t,v)}}Fe(e,146)}function l6(e,t){!t||!t["!merges"]||(Fe(e,177,qR(t["!merges"].length)),t["!merges"].forEach(function(r){Fe(e,176,HR(r))}),Fe(e,178))}function c6(e,t){!t||!t["!cols"]||(Fe(e,390),t["!cols"].forEach(function(r,a){r&&Fe(e,60,KR(a,r))}),Fe(e,391))}function o6(e,t){!t||!t["!ref"]||(Fe(e,648),Fe(e,649,e6(Nt(t["!ref"]))),Fe(e,650))}function u6(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=Ut(r,-1,a[1].Target.replace(/#.*$/,""),vt.HLINK);Fe(e,494,GR(a,s))}}),delete t["!links"]}function f6(e,t,r,a){if(t["!comments"].length>0){var s=Ut(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",vt.VML);Fe(e,551,Om("rId"+s)),t["!legacy"]=s}}function d6(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],l=typeof s.ref=="string"?s.ref:dt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var c=r.Workbook.Names,u=xa(l);u.s.r==u.e.r&&(u.e.r=xa(t["!ref"]).e.r,l=dt(u));for(var h=0;h<c.length;++h){var m=c[h];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==a){m.Ref="'"+r.SheetNames[a]+"'!"+l;break}}h==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+l}),Fe(e,161,Gl(Nt(l))),Fe(e,162)}}function h6(e,t,r){Fe(e,133),Fe(e,137,ZR(t,r)),Fe(e,138),Fe(e,134)}function m6(e,t){t["!protect"]&&Fe(e,535,t6(t["!protect"]))}function p6(e,t,r,a){var s=ga(),l=r.SheetNames[e],c=r.Sheets[l]||{},u=l;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var h=Nt(c["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],Fe(s,129),(r.vbaraw||c["!outline"])&&Fe(s,147,cR(u,c["!outline"])),Fe(s,148,sR(h)),h6(s,c,r.Workbook),c6(s,c),i6(s,c,e,t),m6(s,c),d6(s,c,r,e),l6(s,c),u6(s,c,a),c["!margins"]&&Fe(s,476,JR(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&o6(s,c),f6(s,c,e,a),Fe(s,130),s.end()}function g6(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(t[+c[1]]=r?+c[2]:c[2])});var s=jt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){a=l.replace(/<.*?>/g,"")}),[t,s,a]}function x6(e,t,r,a,s,l){var c=l||{"!type":"chart"};if(!e)return l;var u=0,h=0,m="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var _=g6(v);p.s.r=p.s.c=0,p.e.c=u,m=nr(u),_[0].forEach(function(y,b){c[m+mr(b)]={t:"n",v:y,z:_[1]},h=b}),p.e.r<h&&(p.e.r=h),++u}),u>0&&(c["!ref"]=dt(p)),c}function v6(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,u=e.match(w2);return u&&Gm(u[0],l,s,r),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}function _6(e,t){e.l+=10;var r=Qr(e);return{name:r}}function y6(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return Qn(e,function(h,m,p){switch(p){case 550:l["!rel"]=h;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),h.name&&(s.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!c||t.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},t),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}var $m=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],w6=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],b6=[],E6=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function x_(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var l=t[s];if(a[l[0]]==null)a[l[0]]=l[1];else switch(l[2]){case"bool":typeof a[l[0]]=="string"&&(a[l[0]]=Yt(a[l[0]]));break;case"int":typeof a[l[0]]=="string"&&(a[l[0]]=parseInt(a[l[0]],10));break}}}function v_(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Yt(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function T2(e){v_(e.WBProps,$m),v_(e.CalcPr,E6),x_(e.WBView,w6),x_(e.Sheets,b6),Dl.date1904=Yt(e.WBProps.date1904)}function S6(e){return!e.Workbook||!e.Workbook.WBProps?"false":Yt(e.Workbook.WBProps.date1904)?"true":"false"}var T6="][*?/\\".split("");function k2(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return T6.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function k6(e,t,r){e.forEach(function(a,s){k2(a);for(var l=0;l<s;++l)if(a==e[l])throw new Error("Duplicate Sheet Name: "+a);if(r){var c=t&&t[s]&&t[s].CodeName||a;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function A6(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];k6(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)S8(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var j6=/<\w+:workbook/;function N6(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",l={},c=0;if(e.replace(ea,function(h,m){var p=lt(h);switch(En(p[0])){case"<?xml":break;case"<workbook":h.match(j6)&&(s="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=p[s];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":$m.forEach(function(v){if(p[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=Yt(p[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(p[v[0]],10);break;default:r.WBProps[v[0]]=p[v[0]]}}),p.codeName&&(r.WBProps.CodeName=qt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=jt(qt(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":l={},l.Name=qt(p.name),p.comment&&(l.Comment=p.comment),p.localSheetId&&(l.Sheet=+p.localSheetId),Yt(p.hidden||"0")&&(l.Hidden=!0),c=m+h.length;break;case"</definedName>":l.Ref=jt(qt(e.slice(c,m))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),Ai.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return T2(r),r}function A2(e){var t=[pr];t[t.length]=He("workbook",null,{xmlns:Ai[0],"xmlns:r":kr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&($m.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(a[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=He("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var c={name:It(e.SheetNames[l].slice(0,31))};if(c.sheetId=""+(l+1),c["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}t[t.length]=He("sheet",null,c)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(t[t.length]=He("definedName",It(u.Ref),h))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function C6(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Gh(e),r.name=Qr(e),r}function O6(e,t){return t||(t=ke(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Om(e.strRelID,t),Rr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function R6(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Qr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function D6(e,t){t||(t=ke(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),vw(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function F6(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function M6(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),l=fj(e),c=v8(e,0,r),u=Cm(e);e.l=a;var h={Name:l,Ptg:c};return s<268435455&&(h.Sheet=s),u&&(h.Comment=u),h}function B6(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],po[16]={n:"BrtFRTArchID$",f:F6},Qn(e,function(h,m,p){switch(p){case 156:c.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=Kr(h.Ptg,null,null,c,t),delete t.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([p,h]):c[0]=[p,h],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(h),c.XTI=c.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(p),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(p),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!m.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},t),T2(r),r.Names=l,r.supbooks=c,r}function L6(e,t){Fe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Fe(e,156,O6(s))}Fe(e,144)}function U6(e,t){t||(t=ke(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Rr("SheetJS",t),Rr(_f.version,t),Rr(_f.version,t),Rr("7262",t),t.length>t.l?t.slice(0,t.l):t}function I6(e,t){t||(t=ke(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function P6(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,l=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&l==-1&&(l=a);l>s||(Fe(e,135),Fe(e,158,I6(s)),Fe(e,136))}}function z6(e,t){var r=ga();return Fe(r,131),Fe(r,128,U6()),Fe(r,153,D6(e.Workbook&&e.Workbook.WBProps||null)),P6(r,e),L6(r,e),Fe(r,132),r.end()}function H6(e,t,r){return t.slice(-4)===".bin"?B6(e,r):N6(e,r)}function q6(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?n6(e,a,r,s,l,c,u):M8(e,a,r,s,l,c,u)}function V6(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?y6(e,a,r,s,l):v6(e,a,r,s,l)}function G6(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?W3():X3()}function $6(e,t,r,a,s,l,c,u){return t.slice(-4)===".bin"?G3():$3()}function W6(e,t,r,a){return t.slice(-4)===".bin"?HC(e,r,a):CC(e,r,a)}function X6(e,t,r){return l2(e,r)}function K6(e,t,r){return t.slice(-4)===".bin"?KN(e,r):$N(e,r)}function Y6(e,t,r){return t.slice(-4)===".bin"?P3(e,r):O3(e,r)}function J6(e,t,r){return t.slice(-4)===".bin"?j3(e):k3(e)}function Q6(e,t,r,a){return r.slice(-4)===".bin"?N3(e,t,r,a):void 0}function Z6(e,t,r){return t.slice(-4)===".bin"?E3(e,t,r):T3(e,t,r)}function eD(e,t,r){return(t.slice(-4)===".bin"?z6:A2)(e)}function tD(e,t,r,a,s){return(t.slice(-4)===".bin"?p6:b2)(e,r,a,s)}function rD(e,t,r){return(t.slice(-4)===".bin"?QC:s2)(e,r)}function aD(e,t,r){return(t.slice(-4)===".bin"?QN:Jw)(e,r)}function nD(e,t,r){return(t.slice(-4)===".bin"?z3:u2)(e)}function sD(e){return(e.slice(-4)===".bin"?S3:c2)()}var j2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,N2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function an(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(j2),l,c,u,h;if(s)for(h=0;h!=s.length;++h)l=s[h].match(N2),(c=l[1].indexOf(":"))===-1?a[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(c+1),a[u]=l[2].slice(1,l[2].length-1));return a}function iD(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(j2),s,l,c,u;if(a)for(u=0;u!=a.length;++u)s=a[u].match(N2),(l=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),r[c]=s[2].slice(1,s[2].length-1));return r}var Zc;function lD(e,t){var r=Zc[e]||jt(e);return r==="General"?wi(t):Ja(r,t)}function cD(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Yt(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=Jt(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[jt(t)]=s}function oD(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Zn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=so(e.v):e.w=wi(e.v):e.w=lD(t||"General",e.v)}catch(l){if(r.WTF)throw l}try{var a=Zc[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&Hl(a)){var s=pi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(r.WTF)throw l}}}function uD(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=bC[a.Pattern]||a.Pattern)}e[t.ID]=t}function fD(e,t,r,a,s,l,c,u,h,m){var p="General",v=a.StyleID,_={};m=m||{};var y=[],b=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&c&&(v=c.StyleID);l[v]!==void 0&&(l[v].nf&&(p=l[v].nf),l[v].Interior&&y.push(l[v].Interior),!!l[v].Parent);)v=l[v].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=Yt(e);break;case"String":a.t="s",a.r=M1(jt(e)),a.v=e.indexOf("<")>-1?jt(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Jt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=jt(e):a.v<60&&(a.v=a.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Ew[e],m.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=M1(t||e));break}if(oD(a,p,m),m.cellFormula!==!1)if(a.Formula){var w=jt(a.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),a.f=Rl(w,s),delete a.Formula,a.ArrayRange=="RC"?a.F=Rl("RC:RC",s):a.ArrayRange&&(a.F=Rl(a.ArrayRange,s),h.push([Nt(a.F),a.F]))}else for(b=0;b<h.length;++b)s.r>=h[b][0].s.r&&s.r<=h[b][0].e.r&&s.c>=h[b][0].s.c&&s.c<=h[b][0].e.c&&(a.F=h[b][1]);m.cellStyles&&(y.forEach(function(E){!_.patternType&&E.patternType&&(_.patternType=E.patternType)}),a.s=_),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function dD(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function wh(e,t){var r=t||{};ql();var a=Vc(Sm(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=qt(a));var s=a.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var c=Qt(r);return c.type="string",Ul.to_workbook(a,c)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(it){s.indexOf("<"+it)>=0&&(l=!0)}),l)return JD(a,r);Zc={"General Number":"General","General Date":nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nt[15],"Short Date":nt[14],"Long Time":nt[19],"Medium Time":nt[18],"Short Time":nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nt[2],Standard:nt[4],Percent:nt[10],Scientific:nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],m,p={},v=[],_=r.dense?[]:{},y="",b={},w={},E=an('<Data ss:Type="String">'),k=0,A=0,S=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},F={},R={},N="",X=0,G=[],se={},te={},z=0,ge=[],Oe=[],Ce={},Q=[],le,Ee=!1,K=[],Te=[],q={},C=0,H=0,I={Sheets:[],WBProps:{date1904:!1}},L={};co.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var Z="";u=co.exec(a);)switch(u[3]=(Z=u[3]).toLowerCase()){case"data":if(Z=="data"){if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?fD(a.slice(k,u.index),N,E,h[h.length-1][0]=="comment"?Ce:b,{c:A,r:S},F,Q[A],w,K,r):(N="",E=an(u[0]),k=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Oe.length>0&&(b.c=Oe),(!r.sheetRows||r.sheetRows>S)&&b.v!==void 0&&(r.dense?(_[S]||(_[S]=[]),_[S][A]=b):_[nr(A)+mr(S)]=b),b.HRef&&(b.l={Target:jt(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(C=A+(parseInt(b.MergeAcross,10)|0),H=S+(parseInt(b.MergeDown,10)|0),G.push({s:{c:A,r:S},e:{c:C,r:H}})),!r.sheetStubs)b.MergeAcross?A=C+1:++A;else if(b.MergeAcross||b.MergeDown){for(var re=A;re<=C;++re)for(var de=S;de<=H;++de)(re>A||de>S)&&(r.dense?(_[de]||(_[de]=[]),_[de][re]={t:"z"}):_[nr(re)+mr(de)]={t:"z"});A=C+1}else++A;else b=iD(u[0]),b.Index&&(A=+b.Index-1),A<j.s.c&&(j.s.c=A),A>j.e.c&&(j.e.c=A),u[0].slice(-2)==="/>"&&++A,Oe=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(S<j.s.r&&(j.s.r=S),S>j.e.r&&(j.e.r=S),u[0].slice(-2)==="/>"&&(w=an(u[0]),w.Index&&(S=+w.Index-1)),A=0,++S):(w=an(u[0]),w.Index&&(S=+w.Index-1),q={},(w.AutoFitHeight=="0"||w.Height)&&(q.hpx=parseInt(w.Height,10),q.hpt=mo(q.hpx),Te[S]=q),w.Hidden=="1"&&(q.hidden=!0,Te[S]=q));break;case"worksheet":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));v.push(y),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(_["!ref"]=dt(j),r.sheetRows&&r.sheetRows<=j.e.r&&(_["!fullref"]=_["!ref"],j.e.r=r.sheetRows-1,_["!ref"]=dt(j))),G.length&&(_["!merges"]=G),Q.length>0&&(_["!cols"]=Q),Te.length>0&&(_["!rows"]=Te),p[y]=_}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=A=0,h.push([u[3],!1]),m=an(u[0]),y=jt(m.Name),_=r.dense?[]:{},G=[],K=[],Te=[],L={name:y,Hidden:0},I.Sheets.push(L);break;case"table":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),Q=[],Ee=!1}break;case"style":u[1]==="/"?uD(F,R,r):R=an(u[0]);break;case"numberformat":R.nf=jt(an(u[0]).Format||"General"),Zc[R.nf]&&(R.nf=Zc[R.nf]);for(var ve=0;ve!=392&&nt[ve]!=R.nf;++ve);if(ve==392){for(ve=57;ve!=392;++ve)if(nt[ve]==null){Xn(R.nf,ve);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(le=an(u[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!Ee&&le.wpx>10){Ee=!0,Yr=a2;for(var Se=0;Se<Q.length;++Se)Q[Se]&&Ms(Q[Se])}Ee&&Ms(le),Q[le.Index-1||Q.length]=le;for(var xe=0;xe<+le.Span;++xe)Q[Q.length]=Qt(le);break;case"namedrange":if(u[1]==="/")break;I.Names||(I.Names=[]);var U=lt(u[0]),Ze={Name:U.Name,Ref:Rl(U.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(Ze.Sheet=I.Sheets.length-1),I.Names.push(Ze);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?N+=a.slice(X,u.index):X=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=an(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?Bj(se,Z,a.slice(z,u.index)):z=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));dD(Ce),Oe.push(Ce)}else h.push([u[3],!1]),m=an(u[0]),Ce={a:m.Author};break;case"autofilter":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Ie=an(u[0]);_["!autofilter"]={ref:Rl(Ie.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return E_(a,r);var _e=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:_e=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:_e=!1}break;case"excelworkbook":switch(u[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:_e=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:_e=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(a.slice(z,u.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else z=u.index+u[0].length;break;case"header":_["!margins"]||yi(_["!margins"]={},"xlml"),isNaN(+lt(u[0]).Margin)||(_["!margins"].header=+lt(u[0]).Margin);break;case"footer":_["!margins"]||yi(_["!margins"]={},"xlml"),isNaN(+lt(u[0]).Margin)||(_["!margins"].footer=+lt(u[0]).Margin);break;case"pagemargins":var Le=lt(u[0]);_["!margins"]||yi(_["!margins"]={},"xlml"),isNaN(+Le.Top)||(_["!margins"].top=+Le.Top),isNaN(+Le.Left)||(_["!margins"].left=+Le.Left),isNaN(+Le.Right)||(_["!margins"].right=+Le.Right),isNaN(+Le.Bottom)||(_["!margins"].bottom=+Le.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:_e=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:_e=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:_e=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:_e=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:_e=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:_e=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:_e=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:_e=!1}break;case"smarttags":break;default:_e=!1;break}if(_e||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?cD(te,Z,ge,a.slice(z,u.index)):(ge=u,z=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var be={};return!r.bookSheets&&!r.bookProps&&(be.Sheets=p),be.SheetNames=v,be.Workbook=I,be.SSF=Qt(nt),be.Props=se,be.Custprops=te,be}function Qh(e,t){switch(Xm(t=t||{}),t.type||"base64"){case"base64":return wh(Oa(e),t);case"binary":case"buffer":case"file":return wh(e,t);case"array":return wh(Us(e),t)}}function hD(e,t){var r=[];return e.Props&&r.push(Lj(e.Props,t)),e.Custprops&&r.push(Uj(e.Props,e.Custprops)),r.join("")}function mD(){return""}function pD(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var l=[];l.push(He("NumberFormat",null,{"ss:Format":It(nt[a.numFmtId])}));var c={"ss:ID":"s"+(21+s)};r.push(He("Style",l.join(""),c))}),He("Styles",r.join(""))}function C2(e){return He("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Hm(e.Ref,{r:0,c:0})})}function gD(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(C2(s)))}return He("Names",r.join(""))}function xD(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,l=[],c=0;c<s.length;++c){var u=s[c];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||l.push(C2(u)))}return l.join("")}function vD(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(He("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(He("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(He("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(He("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(a.Workbook.Sheets[l]&&!a.Workbook.Sheets[l].Hidden);++l);l==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Vr("ProtectContents","True")),e["!protect"].objects&&s.push(Vr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Vr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Vr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Vr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){e["!protect"][c[0]]&&s.push("<"+c[1]+"/>")})),s.length==0?"":He("WorksheetOptions",s.join(""),{xmlns:Ta.x})}function _D(e){return e.map(function(t){var r=PA(t.t||""),a=He("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return He("Comment",a,{"ss:Author":t.a})}).join("")}function yD(e,t,r,a,s,l,c){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+It(Hm(e.f,c))),e.F&&e.F.slice(0,t.length)==t){var h=sr(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==c.r?"":"["+(h.r-c.r)+"]")+"C"+(h.c==c.c?"":"["+(h.c-c.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=It(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=It(e.l.Tooltip))),r["!merges"])for(var m=r["!merges"],p=0;p!=m.length;++p)m[p].s.c!=c.c||m[p].s.r!=c.r||(m[p].e.c>m[p].s.c&&(u["ss:MergeAcross"]=m[p].e.c-m[p].s.c),m[p].e.r>m[p].s.r&&(u["ss:MergeDown"]=m[p].e.r-m[p].s.r));var v="",_="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":v="Number",_=String(e.v);break;case"b":v="Boolean",_=e.v?"1":"0";break;case"e":v="Error",_=Zn[e.v];break;case"d":v="DateTime",_=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||nt[14]);break;case"s":v="String",_=IA(e.v||"");break}var y=Ps(a.cellXfs,e,a);u["ss:StyleID"]="s"+(21+y),u["ss:Index"]=c.c+1;var b=e.v!=null?_:"",w=e.t=="z"?"":'<Data ss:Type="'+v+'">'+b+"</Data>";return(e.c||[]).length>0&&(w+=_D(e.c)),He("Cell",w,u)}function wD(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Il(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function bD(e,t,r,a){if(!e["!ref"])return"";var s=Nt(e["!ref"]),l=e["!merges"]||[],c=0,u=[];e["!cols"]&&e["!cols"].forEach(function(E,k){Ms(E);var A=!!E.width,S=Vf(k,E),j={"ss:Index":k+1};A&&(j["ss:Width"]=fo(S.width)),E.hidden&&(j["ss:Hidden"]="1"),u.push(He("Column",null,j))});for(var h=Array.isArray(e),m=s.s.r;m<=s.e.r;++m){for(var p=[wD(m,(e["!rows"]||[])[m])],v=s.s.c;v<=s.e.c;++v){var _=!1;for(c=0;c!=l.length;++c)if(!(l[c].s.c>v)&&!(l[c].s.r>m)&&!(l[c].e.c<v)&&!(l[c].e.r<m)){(l[c].s.c!=v||l[c].s.r!=m)&&(_=!0);break}if(!_){var y={r:m,c:v},b=st(y),w=h?(e[m]||[])[v]:e[b];p.push(yD(w,b,e,t,r,a,y))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function ED(e,t,r){var a=[],s=r.SheetNames[e],l=r.Sheets[s],c=l?xD(l,t,e,r):"";return c.length>0&&a.push("<Names>"+c+"</Names>"),c=l?bD(l,t,e,r):"",c.length>0&&a.push("<Table>"+c+"</Table>"),a.push(vD(l,t,e,r)),a.join("")}function SD(e,t){t||(t={}),e.SSF||(e.SSF=Qt(nt)),e.SSF&&(ql(),Lf(e.SSF),t.revssf=If(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ps(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(hD(e,t)),r.push(mD()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(He("Worksheet",ED(a,t,e),{"ss:Name":It(e.SheetNames[a])}));return r[2]=pD(e,t),r[3]=gD(e),pr+He("Workbook",r.join(""),{xmlns:Ta.ss,"xmlns:o":Ta.o,"xmlns:x":Ta.x,"xmlns:ss":Ta.ss,"xmlns:dt":Ta.dt,"xmlns:html":Ta.html})}function TD(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=gj(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=xj(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var kD=[60,1084,2066,2165,2175];function AD(e,t,r,a,s){var l=a,c=[],u=r.slice(r.l,r.l+l);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}c.push(u),r.l+=l;for(var h=$n(r,r.l),m=Zh[h],p=0;m!=null&&kD.indexOf(h)>-1;)l=$n(r,r.l+2),p=r.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),u=r.slice(p,r.l+4+l),c.push(u),r.l+=4+l,m=Zh[h=$n(r,r.l)];var v=Or(c);qr(v,0);var _=0;v.lens=[];for(var y=0;y<c.length;++y)v.lens.push(_),_+=c[y].length;if(v.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+v.length+" < "+a;return t.f(v,v.length,s)}function xn(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=nt[a])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Zn[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=so(e.v):e.w=wi(e.v):e.w=Ja(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&a&&e.t=="n"&&Hl(nt[a]||String(a))){var s=pi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function lf(e,t,r){return{v:e,ixfe:t,t:r}}function jD(e,t){var r={opts:{}},a={},s=t.dense?[]:{},l={},c={},u=null,h=[],m="",p={},v,_="",y,b,w,E,k={},A=[],S,j,F=[],R=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},X={},G=function(We){return We<8?xi[We]:We<64&&R[We-8]||xi[We]},se=function(We,ot,mt){var St=ot.XF.data;if(!(!St||!St.patternType||!mt||!mt.cellStyles)){ot.s={},ot.s.patternType=St.patternType;var tr;(tr=uo(G(St.icvFore)))&&(ot.s.fgColor={rgb:tr}),(tr=uo(G(St.icvBack)))&&(ot.s.bgColor={rgb:tr})}},te=function(We,ot,mt){if(!(q>1)&&!(mt.sheetRows&&We.r>=mt.sheetRows)){if(mt.cellStyles&&ot.XF&&ot.XF.data&&se(We,ot,mt),delete ot.ixfe,delete ot.XF,v=We,_=st(We),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),We.r<c.s.r&&(c.s.r=We.r),We.c<c.s.c&&(c.s.c=We.c),We.r+1>c.e.r&&(c.e.r=We.r+1),We.c+1>c.e.c&&(c.e.c=We.c+1),mt.cellFormula&&ot.f){for(var St=0;St<A.length;++St)if(!(A[St][0].s.c>We.c||A[St][0].s.r>We.r)&&!(A[St][0].e.c<We.c||A[St][0].e.r<We.r)){ot.F=dt(A[St][0]),(A[St][0].s.c!=We.c||A[St][0].s.r!=We.r)&&delete ot.f,ot.f&&(ot.f=""+Kr(A[St][1],c,We,K,z));break}}mt.dense?(s[We.r]||(s[We.r]=[]),s[We.r][We.c]=ot):s[_]=ot}},z={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(z.password=t.password);var ge,Oe=[],Ce=[],Q=[],le=[],Ee=!1,K=[];K.SheetNames=z.snames,K.sharedf=z.sharedf,K.arrayf=z.arrayf,K.names=[],K.XTI=[];var Te=0,q=0,C=0,H=[],I=[],L;z.codepage=1200,cn(1200);for(var Z=!1;e.l<e.length-1;){var re=e.l,de=e.read_shift(2);if(de===0&&Te===10)break;var ve=e.l===e.length?0:e.read_shift(2),Se=Zh[de];if(Se&&Se.f){if(t.bookSheets&&Te===133&&de!==133)break;if(Te=de,Se.r===2||Se.r==12){var xe=e.read_shift(2);if(ve-=2,!z.enc&&xe!==de&&((xe&255)<<8|xe>>8)!==de)throw new Error("rt mismatch: "+xe+"!="+de);Se.r==12&&(e.l+=10,ve-=10)}var U={};if(de===10?U=Se.f(e,ve,z):U=AD(de,Se,e,ve,z),q==0&&[9,521,1033,2057].indexOf(Te)===-1)continue;switch(de){case 34:r.opts.Date1904=N.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(z.enc||(e.l=0),z.enc=U,!t.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:z.lastuser=U;break;case 66:var Ze=Number(U);switch(Ze){case 21010:Ze=1200;break;case 32768:Ze=1e4;break;case 32769:Ze=1252;break}cn(z.codepage=Ze),Z=!0;break;case 317:z.rrtabid=U;break;case 25:z.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:z.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(s["!type"]="dialog"),U.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),U.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:F.push(U);break;case 430:K.push([U]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(U);break;case 24:case 536:L={Name:U.Name,Ref:Kr(U.rgce,c,null,K,z)},U.itab>0&&(L.Sheet=U.itab-1),K.names.push(L),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(I[U.itab-1]={ref:dt(U.rgce[0][0][1][2])});break;case 22:z.ExternCount=U;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(U),K.XTI=K.XTI.concat(U);break;case 2196:if(z.biff<8)break;L!=null&&(L.Comment=U[1]);break;case 18:s["!protect"]=U;break;case 19:U!==0&&z.WTF&&console.error("Password verifier: "+U);break;case 133:l[U.pos]=U,z.snames.push(U.name);break;case 10:{if(--q)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,s["!ref"]=dt(c),t.sheetRows&&t.sheetRows<=c.e.r){var Ie=c.e.r;c.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=dt(c),c.e.r=Ie}c.e.r++,c.e.c++}Oe.length>0&&(s["!merges"]=Oe),Ce.length>0&&(s["!objects"]=Ce),Q.length>0&&(s["!cols"]=Q),le.length>0&&(s["!rows"]=le),N.Sheets.push(X)}m===""?p=s:a[m]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(z.biff===8&&(z.biff={9:2,521:3,1033:4}[de]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),z.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(z.biff=5,Z=!0,cn(z.codepage=28591)),z.biff==8&&U.BIFFVer==0&&U.dt==16&&(z.biff=2),q++)break;if(s=t.dense?[]:{},z.biff<8&&!Z&&(Z=!0,cn(z.codepage=t.codepage||1252)),z.biff<5||U.BIFFVer==0&&U.dt==4096){m===""&&(m="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var _e={pos:e.l-ve,name:m};l[_e.pos]=_e,z.snames.push(m)}else m=(l[re]||{name:""}).name;U.dt==32&&(s["!type"]="chart"),U.dt==64&&(s["!type"]="macro"),Oe=[],Ce=[],z.arrayf=A=[],Q=[],le=[],Ee=!1,X={Hidden:(l[re]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[U.r]||[])[U.c]:s[st({c:U.c,r:U.r})])&&++U.c,S={ixfe:U.ixfe,XF:F[U.ixfe]||{},v:U.val,t:"n"},C>0&&(S.z=H[S.ixfe>>8&63]),xn(S,t,r.opts.Date1904),te({c:U.c,r:U.r},S,t);break;case 5:case 517:S={ixfe:U.ixfe,XF:F[U.ixfe],v:U.val,t:U.t},C>0&&(S.z=H[S.ixfe>>8&63]),xn(S,t,r.opts.Date1904),te({c:U.c,r:U.r},S,t);break;case 638:S={ixfe:U.ixfe,XF:F[U.ixfe],v:U.rknum,t:"n"},C>0&&(S.z=H[S.ixfe>>8&63]),xn(S,t,r.opts.Date1904),te({c:U.c,r:U.r},S,t);break;case 189:for(var Le=U.c;Le<=U.C;++Le){var be=U.rkrec[Le-U.c][0];S={ixfe:be,XF:F[be],v:U.rkrec[Le-U.c][1],t:"n"},C>0&&(S.z=H[S.ixfe>>8&63]),xn(S,t,r.opts.Date1904),te({c:Le,r:U.r},S,t)}break;case 6:case 518:case 1030:{if(U.val=="String"){u=U;break}if(S=lf(U.val,U.cell.ixfe,U.tt),S.XF=F[S.ixfe],t.cellFormula){var it=U.formula;if(it&&it[0]&&it[0][0]&&it[0][0][0]=="PtgExp"){var kt=it[0][0][1][0],ht=it[0][0][1][1],Et=st({r:kt,c:ht});k[Et]?S.f=""+Kr(U.formula,c,U.cell,K,z):S.F=((t.dense?(s[kt]||[])[ht]:s[Et])||{}).F}else S.f=""+Kr(U.formula,c,U.cell,K,z)}C>0&&(S.z=H[S.ixfe>>8&63]),xn(S,t,r.opts.Date1904),te(U.cell,S,t),u=U}break;case 7:case 519:if(u)u.val=U,S=lf(U,u.cell.ixfe,"s"),S.XF=F[S.ixfe],t.cellFormula&&(S.f=""+Kr(u.formula,c,u.cell,K,z)),C>0&&(S.z=H[S.ixfe>>8&63]),xn(S,t,r.opts.Date1904),te(u.cell,S,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(U);var Dr=st(U[0].s);if(y=t.dense?(s[U[0].s.r]||[])[U[0].s.c]:s[Dr],t.cellFormula&&y){if(!u||!Dr||!y)break;y.f=""+Kr(U[1],c,U[0],K,z),y.F=dt(U[0])}}break;case 1212:{if(!t.cellFormula)break;if(_){if(!u)break;k[st(u.cell)]=U[0],y=t.dense?(s[u.cell.r]||[])[u.cell.c]:s[st(u.cell)],(y||{}).f=""+Kr(U[0],c,v,K,z)}}break;case 253:S=lf(h[U.isst].t,U.ixfe,"s"),h[U.isst].h&&(S.h=h[U.isst].h),S.XF=F[S.ixfe],C>0&&(S.z=H[S.ixfe>>8&63]),xn(S,t,r.opts.Date1904),te({c:U.c,r:U.r},S,t);break;case 513:t.sheetStubs&&(S={ixfe:U.ixfe,XF:F[U.ixfe],t:"z"},C>0&&(S.z=H[S.ixfe>>8&63]),xn(S,t,r.opts.Date1904),te({c:U.c,r:U.r},S,t));break;case 190:if(t.sheetStubs)for(var Ft=U.c;Ft<=U.C;++Ft){var At=U.ixfe[Ft-U.c];S={ixfe:At,XF:F[At],t:"z"},C>0&&(S.z=H[S.ixfe>>8&63]),xn(S,t,r.opts.Date1904),te({c:Ft,r:U.r},S,t)}break;case 214:case 516:case 4:S=lf(U.val,U.ixfe,"s"),S.XF=F[S.ixfe],C>0&&(S.z=H[S.ixfe>>8&63]),xn(S,t,r.opts.Date1904),te({c:U.c,r:U.r},S,t);break;case 0:case 512:q===1&&(c=U);break;case 252:h=U;break;case 1054:if(z.biff==4){H[C++]=U[1];for(var jr=0;jr<C+163&&nt[jr]!=U[1];++jr);jr>=163&&Xn(U[1],C+163)}else Xn(U[1],U[0]);break;case 30:{H[C++]=U;for(var Fr=0;Fr<C+163&&nt[Fr]!=U;++Fr);Fr>=163&&Xn(U,C+163)}break;case 229:Oe=Oe.concat(U);break;case 93:Ce[U.cmo[0]]=z.lastobj=U;break;case 438:z.lastobj.TxO=U;break;case 127:z.lastobj.ImData=U;break;case 440:for(E=U[0].s.r;E<=U[0].e.r;++E)for(w=U[0].s.c;w<=U[0].e.c;++w)y=t.dense?(s[E]||[])[w]:s[st({c:w,r:E})],y&&(y.l=U[1]);break;case 2048:for(E=U[0].s.r;E<=U[0].e.r;++E)for(w=U[0].s.c;w<=U[0].e.c;++w)y=t.dense?(s[E]||[])[w]:s[st({c:w,r:E})],y&&y.l&&(y.l.Tooltip=U[1]);break;case 28:{if(z.biff<=5&&z.biff>=2)break;y=t.dense?(s[U[0].r]||[])[U[0].c]:s[st(U[0])];var ie=Ce[U[2]];y||(t.dense?(s[U[0].r]||(s[U[0].r]=[]),y=s[U[0].r][U[0].c]={t:"z"}):y=s[st(U[0])]={t:"z"},c.e.r=Math.max(c.e.r,U[0].r),c.s.r=Math.min(c.s.r,U[0].r),c.e.c=Math.max(c.e.c,U[0].c),c.s.c=Math.min(c.s.c,U[0].c)),y.c||(y.c=[]),b={a:U[1],t:ie.TxO.t},y.c.push(b)}break;case 2173:p3(F[U.ixfe],U.ext);break;case 125:{if(!z.cellStyles)break;for(;U.e>=U.s;)Q[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},Ee||(Ee=!0,Im(U.w/256)),Ms(Q[U.e+1])}break;case 520:{var De={};U.level!=null&&(le[U.r]=De,De.level=U.level),U.hidden&&(le[U.r]=De,De.hidden=!0),U.hpt&&(le[U.r]=De,De.hpt=U.hpt,De.hpx=Il(U.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||yi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[de]]=U;break;case 161:s["!margins"]||yi(s["!margins"]={}),s["!margins"].header=U.header,s["!margins"].footer=U.footer;break;case 574:U.RTL&&(N.Views[0].RTL=!0);break;case 146:R=U;break;case 2198:ge=U;break;case 140:j=U;break;case 442:m?X.CodeName=U||X.name:N.WBProps.CodeName=U||"ThisWorkbook";break}}else Se||console.error("Missing Info for XLS Record 0x"+de.toString(16)),e.l+=ve}return r.SheetNames=ur(l).sort(function(Me,We){return Number(Me)-Number(We)}).map(function(Me){return l[Me].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&I.forEach(function(Me,We){r.Sheets[r.SheetNames[We]]["!autofilter"]=Me}),r.Strings=h,r.SSF=Qt(nt),z.enc&&(r.Encryption=z.enc),ge&&(r.Themes=ge),r.Metadata={},j!==void 0&&(r.Metadata.Country=j),K.names.length>0&&(N.Names=K.names),r.Workbook=N,r}var eo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ND(e,t,r){var a=tt.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=Z1(a,$h,eo.DSI);for(var l in s)t[l]=s[l]}catch(m){if(r.WTF)throw m}var c=tt.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var u=Z1(c,Wh,eo.SI);for(var h in u)t[h]==null&&(t[h]=u[h])}catch(m){if(r.WTF)throw m}t.HeadingPairs&&t.TitlesOfParts&&(Nw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function CD(e,t){var r=[],a=[],s=[],l=0,c,u=N1($h,"n"),h=N1(Wh,"n");if(e.Props)for(c=ur(e.Props),l=0;l<c.length;++l)(Object.prototype.hasOwnProperty.call(u,c[l])?r:Object.prototype.hasOwnProperty.call(h,c[l])?a:s).push([c[l],e.Props[c[l]]]);if(e.Custprops)for(c=ur(e.Custprops),l=0;l<c.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},c[l])||(Object.prototype.hasOwnProperty.call(u,c[l])?r:Object.prototype.hasOwnProperty.call(h,c[l])?a:s).push([c[l],e.Custprops[c[l]]]);var m=[];for(l=0;l<s.length;++l)Bw.indexOf(s[l][0])>-1||jw.indexOf(s[l][0])>-1||s[l][1]!=null&&m.push(s[l]);a.length&&tt.utils.cfb_add(t,"/SummaryInformation",e_(a,eo.SI,h,Wh)),(r.length||m.length)&&tt.utils.cfb_add(t,"/DocumentSummaryInformation",e_(r,eo.DSI,u,$h,m.length?m:null,eo.UDI))}function O2(e,t){t||(t={}),Xm(t),pm(),t.codepage&&mm(t.codepage);var r,a;if(e.FullPaths){if(tt.find(e,"/encryption"))throw new Error("File is password-protected");r=tt.find(e,"!CompObj"),a=tt.find(e,"/Workbook")||tt.find(e,"/Book")}else{switch(t.type){case"base64":e=Na(Oa(e));break;case"binary":e=Na(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}qr(e,0),a={content:e}}var s,l;if(r&&TD(r),t.bookProps&&!t.bookSheets)s={};else{var c=xt?"buffer":"array";if(a&&a.content)s=jD(a.content,t);else if((l=tt.find(e,"PerfectOffice_MAIN"))&&l.content)s=_i.to_workbook(l.content,(t.type=c,t));else if((l=tt.find(e,"NativeContent_MAIN"))&&l.content)s=_i.to_workbook(l.content,(t.type=c,t));else throw(l=tt.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&tt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=q3(e))}var u={};return e.FullPaths&&ND(e,u,t),s.Props=s.Custprops=u,t.bookFiles&&(s.cfb=e),s}function OD(e,t){var r=t||{},a=tt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return tt.utils.cfb_add(a,s,R2(e,r)),r.biff==8&&(e.Props||e.Custprops)&&CD(e,a),r.biff==8&&e.vbaraw&&V3(a,tt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var po={0:{f:tR},1:{f:oR},2:{f:jR},3:{f:xR},4:{f:hR},5:{f:TR},6:{f:DR},7:{f:wR},8:{f:PR},9:{f:IR},10:{f:LR},11:{f:UR},12:{f:fR},13:{f:CR},14:{f:_R},15:{f:pR},16:{f:E2},17:{f:MR},18:{f:ER},19:{f:Nm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:M6},40:{},42:{},43:{f:DC},44:{f:OC},45:{f:BC},46:{f:UC},47:{f:LC},48:{},49:{f:nj},50:{},51:{f:v3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ww},62:{f:RR},63:{f:A3},64:{f:r6},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:QR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:lR},148:{f:nR,p:16},151:{f:$R},152:{},153:{f:R6},154:{},155:{},156:{f:C6},157:{},158:{},159:{T:1,f:XN},160:{T:-1},161:{T:1,f:Oi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:zR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:g3},336:{T:-1},337:{f:w3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Gh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$w},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:WR},427:{f:XR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:YR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:iR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:VR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Gh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:U3},633:{T:1},634:{T:-1},635:{T:1,f:B3},636:{T:-1},637:{f:cj},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:_6},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:a6},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Zh={6:{f:_h},10:{f:As},12:{f:Er},13:{f:Er},14:{f:hr},15:{f:hr},16:{f:Jr},17:{f:hr},18:{f:hr},19:{f:Er},20:{f:i_},21:{f:i_},23:{f:$w},24:{f:c_},25:{f:hr},26:{},27:{},28:{f:aN},29:{},34:{f:hr},35:{f:l_},38:{f:Jr},39:{f:Jr},40:{f:Jr},41:{f:Jr},42:{f:hr},43:{f:hr},47:{f:pC},49:{f:C4},51:{f:Er},60:{},61:{f:T4},64:{f:hr},65:{f:N4},66:{f:Er},77:{},80:{},81:{},82:{},85:{f:Er},89:{},90:{},91:{},92:{f:m4},93:{f:iN},94:{},95:{f:hr},96:{},97:{},99:{f:hr},125:{f:Ww},128:{f:G4},129:{f:g4},130:{f:Er},131:{f:hr},132:{f:hr},133:{f:x4},134:{},140:{f:mN},141:{f:Er},144:{},146:{f:xN},151:{},152:{},153:{},154:{},155:{},156:{f:Er},157:{},158:{},160:{f:SN},161:{f:yN},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:z4},190:{f:H4},193:{f:As},197:{},198:{},199:{},200:{},201:{},202:{f:hr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Er},220:{},221:{f:hr},222:{},224:{f:V4},225:{f:h4},226:{f:As},227:{},229:{f:nN},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:_4},253:{f:R4},255:{f:w4},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Lw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:hr},353:{f:As},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Y4},431:{f:hr},432:{},433:{},434:{},437:{},438:{f:oN},439:{f:hr},440:{f:uN},441:{},442:{f:bo},443:{},444:{f:Er},445:{},446:{},448:{f:As},449:{f:S4,r:2},450:{f:As},512:{f:a_},513:{f:EN},515:{f:X4},516:{f:F4},517:{f:s_},519:{f:TN},520:{f:b4},523:{},545:{f:o_},549:{f:r_},566:{},574:{f:A4},638:{f:P4},659:{},1048:{},1054:{f:B4},1084:{},1212:{f:eN},2048:{f:dN},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:af},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:As},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:vN,r:12},2173:{f:m3,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:hr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Z4,r:12},2197:{},2198:{f:c3,r:12},2199:{},2200:{},2201:{},2202:{f:tN,r:12},2203:{f:As},2204:{},2205:{},2206:{},2207:{},2211:{f:E4},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Er},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:wN},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:gN},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:a_},1:{},2:{f:CN},3:{f:jN},4:{f:AN},5:{f:s_},7:{f:RN},8:{},9:{f:af},11:{},22:{f:Er},30:{f:U4},31:{},32:{},33:{f:o_},36:{},37:{f:r_},50:{f:DN},62:{},52:{},67:{},68:{f:Er},69:{},86:{},126:{},127:{f:kN},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:FN},223:{},234:{},354:{},421:{},518:{f:_h},521:{f:af},536:{f:c_},547:{f:l_},561:{},579:{},1030:{f:_h},1033:{f:af},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function qe(e,t,r,a){var s=t;if(!isNaN(s)){var l=a||(r||[]).length||0,c=e.next(4);c.write_shift(2,s),c.write_shift(2,l),l>0&&km(r)&&e.push(r)}}function RD(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return qe(e,t,r,s);var l=t;if(!isNaN(l)){for(var c=r.parts||[],u=0,h=0,m=0;m+(c[u]||8224)<=8224;)m+=c[u]||8224,u++;var p=e.next(4);for(p.write_shift(2,l),p.write_shift(2,m),e.push(r.slice(h,h+m)),h+=m;h<s;){for(p=e.next(4),p.write_shift(2,60),m=0;m+(c[u]||8224)<=8224;)m+=c[u]||8224,u++;p.write_shift(2,m),e.push(r.slice(h,h+m)),h+=m}}}function ko(e,t,r){return e||(e=ke(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function DD(e,t,r,a){var s=ke(9);return ko(s,e,t),Uw(r,a||"b",s),s}function FD(e,t,r){var a=ke(8+2*r.length);return ko(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function MD(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Ar(Jt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?qe(e,2,ON(r,a,s)):qe(e,3,NN(r,a,s));return;case"b":case"e":qe(e,5,DD(r,a,t.v,t.t));return;case"s":case"str":qe(e,4,FD(r,a,(t.v||"").slice(0,255)));return}qe(e,1,ko(null,r,a))}function BD(e,t,r,a){var s=Array.isArray(t),l=Nt(t["!ref"]||"A1"),c,u="",h=[];if(l.e.c>255||l.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),c=dt(l)}for(var m=l.s.r;m<=l.e.r;++m){u=mr(m);for(var p=l.s.c;p<=l.e.c;++p){m===l.s.r&&(h[p]=nr(p)),c=h[p]+u;var v=s?(t[m]||[])[p]:t[c];v&&MD(e,v,m,p)}}}function LD(e,t){for(var r=t||{},a=ga(),s=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==r.sheet&&(s=l);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return qe(a,r.biff==4?1033:r.biff==3?521:9,Bm(e,16,r)),BD(a,e.Sheets[e.SheetNames[s]],s,r),qe(a,10),a.end()}function UD(e,t,r){qe(e,49,O4({sz:12,name:"Arial"},r))}function ID(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&qe(e,1054,L4(s,t[s],r))})}function PD(e,t){var r=ke(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),qe(e,2151,r),r=ke(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),qw(Nt(t["!ref"]||"A1"),r),r.write_shift(4,4),qe(e,2152,r)}function zD(e,t){for(var r=0;r<16;++r)qe(e,224,n_({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){qe(e,224,n_(a,0,t))})}function HD(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];qe(e,440,fN(a)),a[1].Tooltip&&qe(e,2048,hN(a))}delete t["!links"]}function qD(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&qe(e,125,_N(Vf(s,a),s))})}}function VD(e,t,r,a,s){var l=16+Ps(s.cellXfs,t,s);if(t.v==null&&!t.bf){qe(e,513,Ti(r,a,l));return}if(t.bf)qe(e,6,g8(t,r,a,s,l));else switch(t.t){case"d":case"n":var c=t.t=="d"?Ar(Jt(t.v)):t.v;qe(e,515,K4(r,a,c,l));break;case"b":case"e":qe(e,517,W4(r,a,t.v,l,s,t.t));break;case"s":case"str":if(s.bookSST){var u=Vm(s.Strings,t.v,s.revStrings);qe(e,253,D4(r,a,u,l))}else qe(e,516,M4(r,a,(t.v||"").slice(0,255),l,s));break;default:qe(e,513,Ti(r,a,l))}}function GD(e,t,r){var a=ga(),s=r.SheetNames[e],l=r.Sheets[s]||{},c=(r||{}).Workbook||{},u=(c.Sheets||[])[e]||{},h=Array.isArray(l),m=t.biff==8,p,v="",_=[],y=Nt(l["!ref"]||"A1"),b=m?65536:16384;if(y.e.c>255||y.e.r>=b){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,b-1)}qe(a,2057,Bm(r,16,t)),qe(a,13,Ka(1)),qe(a,12,Ka(100)),qe(a,15,na(!0)),qe(a,17,na(!1)),qe(a,16,Ei(.001)),qe(a,95,na(!0)),qe(a,42,na(!1)),qe(a,43,na(!1)),qe(a,130,Ka(1)),qe(a,128,$4()),qe(a,131,na(!1)),qe(a,132,na(!1)),m&&qD(a,l["!cols"]),qe(a,512,I4(y,t)),m&&(l["!links"]=[]);for(var w=y.s.r;w<=y.e.r;++w){v=mr(w);for(var E=y.s.c;E<=y.e.c;++E){w===y.s.r&&(_[E]=nr(E)),p=_[E]+v;var k=h?(l[w]||[])[E]:l[p];k&&(VD(a,k,w,E,t),m&&k.l&&l["!links"].push([p,k.l]))}}var A=u.CodeName||u.name||s;return m&&qe(a,574,j4((c.Views||[])[0])),m&&(l["!merges"]||[]).length&&qe(a,229,sN(l["!merges"])),m&&HD(a,l),qe(a,442,Iw(A)),m&&PD(a,l),qe(a,10),a.end()}function $D(e,t,r){var a=ga(),s=(e||{}).Workbook||{},l=s.Sheets||[],c=s.WBProps||{},u=r.biff==8,h=r.biff==5;if(qe(a,2057,Bm(e,5,r)),r.bookType=="xla"&&qe(a,135),qe(a,225,u?Ka(1200):null),qe(a,193,Wj(2)),h&&qe(a,191),h&&qe(a,192),qe(a,226),qe(a,92,p4("SheetJS",r)),qe(a,66,Ka(u?1200:1252)),u&&qe(a,353,Ka(0)),u&&qe(a,448),qe(a,317,bN(e.SheetNames.length)),u&&e.vbaraw&&qe(a,211),u&&e.vbaraw){var m=c.CodeName||"ThisWorkbook";qe(a,442,Iw(m))}qe(a,156,Ka(17)),qe(a,25,na(!1)),qe(a,18,na(!1)),qe(a,19,Ka(0)),u&&qe(a,431,na(!1)),u&&qe(a,444,Ka(0)),qe(a,61,k4()),qe(a,64,na(!1)),qe(a,141,Ka(0)),qe(a,34,na(S6(e)=="true")),qe(a,14,na(!0)),u&&qe(a,439,na(!1)),qe(a,218,Ka(0)),UD(a,e,r),ID(a,e.SSF,r),zD(a,r),u&&qe(a,352,na(!1));var p=a.end(),v=ga();u&&qe(v,140,pN()),u&&r.Strings&&RD(v,252,y4(r.Strings)),qe(v,10);var _=v.end(),y=ga(),b=0,w=0;for(w=0;w<e.SheetNames.length;++w)b+=(u?12:11)+(u?2:1)*e.SheetNames[w].length;var E=p.length+b+_.length;for(w=0;w<e.SheetNames.length;++w){var k=l[w]||{};qe(y,133,v4({pos:E,hs:k.Hidden||0,dt:0,name:e.SheetNames[w]},r)),E+=t[w].length}var A=y.end();if(b!=A.length)throw new Error("BS8 "+b+" != "+A.length);var S=[];return p.length&&S.push(p),A.length&&S.push(A),_.length&&S.push(_),Or(S)}function WD(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Qt(nt)),e&&e.SSF&&(ql(),Lf(e.SSF),r.revssf=If(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Km(r),r.cellXfs=[],Ps(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=GD(s,r,e);return a.unshift($D(e,a,r)),Or(a)}function R2(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=xa(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return WD(e,t);case 4:case 3:case 2:return LD(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function __(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=s.index,u=l&&l.index||e.length,h=OA(e.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,p=0,v=0,_=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(c=0;c<h.length;++c){var w=h[c].trim(),E=w.slice(0,3).toLowerCase();if(E=="<tr"){if(++m,r.sheetRows&&r.sheetRows<=m){--m;break}p=0;continue}if(!(E!="<td"&&E!="<th")){var k=w.split(/<\/t[dh]>/i);for(u=0;u<k.length;++u){var A=k[u].trim();if(A.match(/<t[dh]/i)){for(var S=A,j=0;S.charAt(0)=="<"&&(j=S.indexOf(">"))>-1;)S=S.slice(j+1);for(var F=0;F<b.length;++F){var R=b[F];R.s.c==p&&R.s.r<m&&m<=R.e.r&&(p=R.e.c+1,F=-1)}var N=lt(A.slice(0,A.indexOf(">")));_=N.colspan?+N.colspan:1,((v=+N.rowspan)>1||_>1)&&b.push({s:{r:m,c:p},e:{r:m+(v||1)-1,c:p+_-1}});var X=N.t||N["data-t"]||"";if(!S.length){p+=_;continue}if(S=rw(S),y.s.r>m&&(y.s.r=m),y.e.r<m&&(y.e.r=m),y.s.c>p&&(y.s.c=p),y.e.c<p&&(y.e.c=p),!S.length){p+=_;continue}var G={t:"s",v:S};r.raw||!S.trim().length||X=="s"||(S==="TRUE"?G={t:"b",v:!0}:S==="FALSE"?G={t:"b",v:!1}:isNaN(un(S))?isNaN(Ll(S).getDate())||(G={t:"d",v:Jt(S)},r.cellDates||(G={t:"n",v:Ar(G.v)}),G.z=r.dateNF||nt[14]):G={t:"n",v:un(S)}),r.dense?(a[m]||(a[m]=[]),a[m][p]=G):a[st({r:m,c:p})]=G,p+=_}}}}return a["!ref"]=dt(y),b.length&&(a["!merges"]=b),a}function XD(e,t,r,a){for(var s=e["!merges"]||[],l=[],c=t.s.c;c<=t.e.c;++c){for(var u=0,h=0,m=0;m<s.length;++m)if(!(s[m].s.r>r||s[m].s.c>c)&&!(s[m].e.r<r||s[m].e.c<c)){if(s[m].s.r<r||s[m].s.c<c){u=-1;break}u=s[m].e.r-s[m].s.r+1,h=s[m].e.c-s[m].s.c+1;break}if(!(u<0)){var p=st({r,c}),v=a.dense?(e[r]||[])[c]:e[p],_=v&&v.v!=null&&(v.h||Em(v.w||(Yn(v),v.w)||""))||"",y={};u>1&&(y.rowspan=u),h>1&&(y.colspan=h),a.editable?_='<span contenteditable="true">'+_+"</span>":v&&(y["data-t"]=v&&v.t||"z",v.v!=null&&(y["data-v"]=v.v),v.z!=null&&(y["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),y.id=(a.id||"sjs")+"-"+p,l.push(He("td",_,y))}}var b="<tr>";return b+l.join("")+"</tr>"}var KD='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',YD="</body></html>";function JD(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Is(__(r[0],t),t);var a=Qm();return r.forEach(function(s,l){Zm(a,__(s,t),"Sheet"+(l+1))}),a}function QD(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function D2(e,t){var r=t||{},a=r.header!=null?r.header:KD,s=r.footer!=null?r.footer:YD,l=[a],c=xa(e["!ref"]);r.dense=Array.isArray(e),l.push(QD(e,c,r));for(var u=c.s.r;u<=c.e.r;++u)l.push(XD(e,c,u,r));return l.push("</table>"+s),l.join("")}function F2(e,t,r){var a=r||{},s=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?sr(a.origin):a.origin;s=c.r,l=c.c}var u=t.getElementsByTagName("tr"),h=Math.min(a.sheetRows||1e7,u.length),m={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var p=xa(e["!ref"]);m.s.r=Math.min(m.s.r,p.s.r),m.s.c=Math.min(m.s.c,p.s.c),m.e.r=Math.max(m.e.r,p.e.r),m.e.c=Math.max(m.e.c,p.e.c),s==-1&&(m.e.r=s=p.e.r+1)}var v=[],_=0,y=e["!rows"]||(e["!rows"]=[]),b=0,w=0,E=0,k=0,A=0,S=0;for(e["!cols"]||(e["!cols"]=[]);b<u.length&&w<h;++b){var j=u[b];if(y_(j)){if(a.display)continue;y[w]={hidden:!0}}var F=j.children;for(E=k=0;E<F.length;++E){var R=F[E];if(!(a.display&&y_(R))){var N=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):rw(R.innerHTML),X=R.getAttribute("data-z")||R.getAttribute("z");for(_=0;_<v.length;++_){var G=v[_];G.s.c==k+l&&G.s.r<w+s&&w+s<=G.e.r&&(k=G.e.c+1-l,_=-1)}S=+R.getAttribute("colspan")||1,((A=+R.getAttribute("rowspan")||1)>1||S>1)&&v.push({s:{r:w+s,c:k+l},e:{r:w+s+(A||1)-1,c:k+l+(S||1)-1}});var se={t:"s",v:N},te=R.getAttribute("data-t")||R.getAttribute("t")||"";N!=null&&(N.length==0?se.t=te||"z":a.raw||N.trim().length==0||te=="s"||(N==="TRUE"?se={t:"b",v:!0}:N==="FALSE"?se={t:"b",v:!1}:isNaN(un(N))?isNaN(Ll(N).getDate())||(se={t:"d",v:Jt(N)},a.cellDates||(se={t:"n",v:Ar(se.v)}),se.z=a.dateNF||nt[14]):se={t:"n",v:un(N)})),se.z===void 0&&X!=null&&(se.z=X);var z="",ge=R.getElementsByTagName("A");if(ge&&ge.length)for(var Oe=0;Oe<ge.length&&!(ge[Oe].hasAttribute("href")&&(z=ge[Oe].getAttribute("href"),z.charAt(0)!="#"));++Oe);z&&z.charAt(0)!="#"&&(se.l={Target:z}),a.dense?(e[w+s]||(e[w+s]=[]),e[w+s][k+l]=se):e[st({c:k+l,r:w+s})]=se,m.e.c<k+l&&(m.e.c=k+l),k+=S}}++w}return v.length&&(e["!merges"]=(e["!merges"]||[]).concat(v)),m.e.r=Math.max(m.e.r,w-1+s),e["!ref"]=dt(m),w>=h&&(e["!fullref"]=dt((m.e.r=u.length-b+w-1+s,m))),e}function M2(e,t){var r=t||{},a=r.dense?[]:{};return F2(a,e,t)}function ZD(e,t){return Is(M2(e,t),t)}function y_(e){var t="",r=eF(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function eF(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function tF(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=jt(t.replace(/<[^>]*>/g,""));return[r]}var w_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function B2(e,t){var r=t||{},a=Sm(e),s=[],l,c,u={name:""},h="",m=0,p,v,_={},y=[],b=r.dense?[]:{},w,E,k={value:""},A="",S=0,j=[],F=-1,R=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},X=0,G={},se=[],te={},z=0,ge=0,Oe=[],Ce=1,Q=1,le=[],Ee={Names:[]},K={},Te=["",""],q=[],C={},H="",I=0,L=!1,Z=!1,re=0;for(co.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=co.exec(a);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?b["!ref"]=dt(N):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(b["!fullref"]=b["!ref"],N.e.r=r.sheetRows-1,b["!ref"]=dt(N)),se.length&&(b["!merges"]=se),Oe.length&&(b["!rows"]=Oe),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),y.push(p.name),_[p.name]=b,Z=!1):w[0].charAt(w[0].length-2)!=="/"&&(p=lt(w[0],!1),F=R=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,b=r.dense?[]:{},se=[],Oe=[],Z=!0);break;case"table-row-group":w[1]==="/"?--X:++X;break;case"table-row":case"":if(w[1]==="/"){F+=Ce,Ce=1;break}if(v=lt(w[0],!1),v.?F=v.-1:F==-1&&(F=0),Ce=+v["number-rows-repeated"]||1,Ce<10)for(re=0;re<Ce;++re)X>0&&(Oe[F+re]={level:X});R=-1;break;case"covered-table-cell":w[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(b[F]||(b[F]=[]),b[F][R]={t:"z"}):b[st({r:F,c:R})]={t:"z"}),A="",j=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++R,k=lt(w[0],!1),Q=parseInt(k["number-columns-repeated"]||"1",10),E={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(E.f=g_(jt(k.formula))),(k.||k["value-type"])=="string"&&(E.t="s",E.v=jt(k["string-value"]||""),r.dense?(b[F]||(b[F]=[]),b[F][R]=E):b[st({r:F,c:R})]=E),R+=Q-1;else if(w[1]!=="/"){++R,A="",S=0,j=[],Q=1;var de=Ce?F+Ce-1:F;if(R>N.e.c&&(N.e.c=R),R<N.s.c&&(N.s.c=R),F<N.s.r&&(N.s.r=F),de>N.e.r&&(N.e.r=de),k=lt(w[0],!1),q=[],C={},E={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=jt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(z=parseInt(k["number-matrix-rows-spanned"],10)||0,ge=parseInt(k["number-matrix-columns-spanned"],10)||0,te={s:{r:F,c:R},e:{r:F+z-1,c:R+ge-1}},E.F=dt(te),le.push([te,E.F])),k.formula)E.f=g_(k.formula);else for(re=0;re<le.length;++re)F>=le[re][0].s.r&&F<=le[re][0].e.r&&R>=le[re][0].s.c&&R<=le[re][0].e.c&&(E.F=le[re][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(z=parseInt(k["number-rows-spanned"],10)||0,ge=parseInt(k["number-columns-spanned"],10)||0,te={s:{r:F,c:R},e:{r:F+z-1,c:R+ge-1}},se.push(te)),k["number-columns-repeated"]&&(Q=parseInt(k["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=Yt(k["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(k.value);break;case"percentage":E.t="n",E.v=parseFloat(k.value);break;case"currency":E.t="n",E.v=parseFloat(k.value);break;case"date":E.t="d",E.v=Jt(k["date-value"]),r.cellDates||(E.t="n",E.v=Ar(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=jA(k["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Pf(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(k.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",k["string-value"]!=null&&(A=jt(k["string-value"]),j=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(L=!1,E.t==="s"&&(E.v=A||"",j.length&&(E.R=j),L=S==0),K.Target&&(E.l=K),q.length>0&&(E.c=q,q=[]),A&&r.cellText!==!1&&(E.w=A),L&&(E.t="z",delete E.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=F))for(var ve=0;ve<Ce;++ve){if(Q=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(b[F+ve]||(b[F+ve]=[]),b[F+ve][R]=ve==0?E:Qt(E);--Q>0;)b[F+ve][R+Q]=Qt(E);else for(b[st({r:F+ve,c:R})]=E;--Q>0;)b[st({r:F+ve,c:R+Q})]=Qt(E);N.e.c<=R&&(N.e.c=R)}Q=parseInt(k["number-columns-repeated"]||"1",10),R+=Q-1,Q=0,E={},A="",j=[]}K={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((l=s.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((l=s.pop())[0]!==w[3])throw"Bad state: "+l;C.t=A,j.length&&(C.R=j),C.a=H,q.push(C)}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);H="",I=0,A="",S=0,j=[];break;case"creator":w[1]==="/"?H=a.slice(I,w.index):I=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((l=s.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);A="",S=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(G[u.name]=h,(l=s.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&(h="",u=lt(w[0],!1),s.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":c=lt(w[0],!1),h+=w_[w[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":c=lt(w[0],!1),h+=w_[w[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":h+=a.slice(m,w.index);break}else m=w.index+w[0].length;break;case"named-range":c=lt(w[0],!1),Te=yh(c["cell-range-address"]);var Se={Name:c.name,Ref:Te[0]+"!"+Te[1]};Z&&(Se.Sheet=y.length),Ee.Names.push(Se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(w[1]==="/"&&(!k||!k["string-value"])){var xe=tF(a.slice(S,w.index));A=(A.length>0?A+`
`:"")+xe[0]}else lt(w[0],!1),S=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{Te=yh(lt(w[0])["target-range-address"]),_[Te[0]]["!autofilter"]={ref:Te[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(K=lt(w[0],!1),!K.href)break;K.Target=jt(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(Te=yh(K.Target.slice(1)),K.Target="#"+Te[0]+"!"+Te[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var U={Sheets:_,SheetNames:y,Workbook:Ee};return r.bookSheets&&delete U.Sheets,U}function b_(e,t){t=t||{},Xa(e,"META-INF/manifest.xml")&&jj(br(e,"META-INF/manifest.xml"),t);var r=Ca(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=B2(qt(r),t);return Xa(e,"meta.xml")&&(a.Props=kw(br(e,"meta.xml"))),a}function E_(e,t){return B2(e,t)}var rF=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+lo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return pr+t}})(),S_=(function(){var e=function(l){return It(l).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(l,c,u){var h=[];h.push('      <table:table table:name="'+It(c.SheetNames[u])+`" table:style-name="ta1">
`);var m=0,p=0,v=xa(l["!ref"]||"A1"),_=l["!merges"]||[],y=0,b=Array.isArray(l);if(l["!cols"])for(p=0;p<=v.e.c;++p)h.push("        <table:table-column"+(l["!cols"][p]?' table:style-name="co'+l["!cols"][p].ods+'"':"")+`></table:table-column>
`);var w="",E=l["!rows"]||[];for(m=0;m<v.s.r;++m)w=E[m]?' table:style-name="ro'+E[m].ods+'"':"",h.push("        <table:table-row"+w+`></table:table-row>
`);for(;m<=v.e.r;++m){for(w=E[m]?' table:style-name="ro'+E[m].ods+'"':"",h.push("        <table:table-row"+w+`>
`),p=0;p<v.s.c;++p)h.push(t);for(;p<=v.e.c;++p){var k=!1,A={},S="";for(y=0;y!=_.length;++y)if(!(_[y].s.c>p)&&!(_[y].s.r>m)&&!(_[y].e.c<p)&&!(_[y].e.r<m)){(_[y].s.c!=p||_[y].s.r!=m)&&(k=!0),A["table:number-columns-spanned"]=_[y].e.c-_[y].s.c+1,A["table:number-rows-spanned"]=_[y].e.r-_[y].s.r+1;break}if(k){h.push(r);continue}var j=st({r:m,c:p}),F=b?(l[m]||[])[p]:l[j];if(F&&F.f&&(A["table:formula"]=It(b8(F.f)),F.F&&F.F.slice(0,j.length)==j)){var R=xa(F.F);A["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,A["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!F){h.push(t);continue}switch(F.t){case"b":S=F.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=F.v?"true":"false";break;case"n":S=F.w||String(F.v||0),A["office:value-type"]="float",A["office:value"]=F.v||0;break;case"s":case"str":S=F.v==null?"":F.v,A["office:value-type"]="string";break;case"d":S=F.w||Jt(F.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=Jt(F.v).toISOString(),A["table:style-name"]="ce1";break;default:h.push(t);continue}var N=e(S);if(F.l&&F.l.Target){var X=F.l.Target;X=X.charAt(0)=="#"?"#"+E8(X.slice(1)):X,X.charAt(0)!="#"&&!X.match(/^\w+:/)&&(X="../"+X),N=He("text:a",N,{"xlink:href":X.replace(/&/g,"&amp;")})}h.push("          "+He("table:table-cell",He("text:p",N,{}),A)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},s=function(l,c){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;c.SheetNames.map(function(m){return c.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var p=0;p<m["!cols"].length;++p)if(m["!cols"][p]){var v=m["!cols"][p];if(v.width==null&&v.wpx==null&&v.wch==null)continue;Ms(v),v.ods=u;var _=m["!cols"][p].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),l.push(`  </style:style>
`),++u}}});var h=0;c.SheetNames.map(function(m){return c.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var p=0;p<m["!rows"].length;++p)if(m["!rows"][p]){m["!rows"][p].ods=h;var v=m["!rows"][p].hpx+"px";l.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),l.push(`  </style:style>
`),++h}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(c,u){var h=[pr],m=lo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=lo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+m+p+`>
`),h.push(Tw().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+m+`>
`),s(h,c),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var v=0;v!=c.SheetNames.length;++v)h.push(a(c.Sheets[c.SheetNames[v]],c,v));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function L2(e,t){if(t.bookType=="fods")return S_(e,t);var r=ym(),a="",s=[],l=[];return a="mimetype",gt(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",gt(r,a,S_(e,t)),s.push([a,"text/xml"]),l.push([a,"ContentFile"]),a="styles.xml",gt(r,a,rF(e,t)),s.push([a,"text/xml"]),l.push([a,"StylesFile"]),a="meta.xml",gt(r,a,pr+Tw()),s.push([a,"text/xml"]),l.push([a,"MetadataFile"]),a="manifest.rdf",gt(r,a,Oj(l)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",gt(r,a,Nj(s)),r}function ki(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function em(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):qt(Us(e))}function aF(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Na(wn(e))}function nF(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Ls(e){var t=e.reduce(function(s,l){return s+l.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function T_(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function sF(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function iF(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var l=0;s>=1;++l,s/=256)e[t+l]=s&255;e[t+15]|=r>=0?0:128}function go(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Lt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function or(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Rt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=go(e,r),l=s&7;s=Math.floor(s/8);var c=0,u;if(s==0)break;switch(l){case 0:{for(var h=r[0];e[r[0]++]>=128;);u=e.slice(h,r[0])}break;case 5:c=4,u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 1:c=8,u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 2:c=go(e,r),u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(a))}var m={data:u,type:l};t[s]==null?t[s]=[m]:t[s].push(m)}return t}function Hr(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(Lt(a*8+s.type)),s.type==2&&t.push(Lt(s.data.length)),t.push(s.data))})}),Ls(t)}function Wm(e,t){return e?.map(function(r){return t(r.data)})||[]}function $a(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=go(e,a),l=Rt(e.slice(a[0],a[0]+s));a[0]+=s;var c={id:or(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=Rt(u.data),m=or(h[3][0].data);c.messages.push({meta:h,data:e.slice(a[0],a[0]+m)}),a[0]+=m}),(t=l[3])!=null&&t[0]&&(c.merge=or(l[3][0].data)>>>0>0),r.push(c)}return r}function wl(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Lt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Lt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(c){s.push(c.data),c.meta[3]=[{type:0,data:Lt(c.data.length)}],a[2].push({data:Hr(c.meta),type:2})});var l=Hr(a);t.push(Lt(l.length)),t.push(l),s.forEach(function(c){return t.push(c)})}),Ls(t)}function lF(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=go(t,r),s=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var c=t[r[0]++]>>2;if(c<60)++c;else{var u=c-59;c=t[r[0]],u>1&&(c|=t[r[0]+1]<<8),u>2&&(c|=t[r[0]+2]<<16),u>3&&(c|=t[r[0]+3]<<24),c>>>=0,c++,r[0]+=u}s.push(t.slice(r[0],r[0]+c)),r[0]+=c;continue}else{var h=0,m=0;if(l==1?(m=(t[r[0]]>>2&7)+4,h=(t[r[0]++]&224)<<3,h|=t[r[0]++]):(m=(t[r[0]++]>>2)+1,l==2?(h=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(h=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Ls(s)],h==0)throw new Error("Invalid offset 0");if(h>s[0].length)throw new Error("Invalid offset beyond length");if(m>=h)for(s.push(s[0].slice(-h)),m-=h;m>=s[s.length-1].length;)s.push(s[s.length-1]),m-=s[s.length-1].length;s.push(s[0].slice(-h,-h+m))}}var p=Ls(s);if(p.length!=a)throw new Error("Unexpected length: ".concat(p.length," != ").concat(a));return p}function Wa(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(lF(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ls(t)}function bl(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var l=Lt(a),c=l.length;t.push(l),a<=60?(c++,t.push(new Uint8Array([a-1<<2]))):a<=256?(c+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(c+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(c+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(c+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),c+=a,s[0]=0,s[1]=c&255,s[2]=c>>8&255,s[3]=c>>16&255,r+=a}return Ls(t)}function cF(e,t,r,a){var s=ki(e),l=s.getUint32(4,!0),c=(a>1?12:8)+T_(l&(a>1?3470:398))*4,u=-1,h=-1,m=NaN,p=new Date(2001,0,1);l&512&&(u=s.getUint32(c,!0),c+=4),c+=T_(l&(a>1?12288:4096))*4,l&16&&(h=s.getUint32(c,!0),c+=4),l&32&&(m=s.getFloat64(c,!0),c+=8),l&64&&(p.setTime(p.getTime()+s.getFloat64(c,!0)*1e3),c+=8);var v;switch(e[2]){case 0:break;case 2:v={t:"n",v:m};break;case 3:v={t:"s",v:t[h]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:r[u]};else if(h>-1)v={t:"s",v:t[h]};else if(!isNaN(m))v={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return v}function oF(e,t,r){var a=ki(e),s=a.getUint32(8,!0),l=12,c=-1,u=-1,h=NaN,m=NaN,p=new Date(2001,0,1);s&1&&(h=sF(e,l),l+=16),s&2&&(m=a.getFloat64(l,!0),l+=8),s&4&&(p.setTime(p.getTime()+a.getFloat64(l,!0)*1e3),l+=8),s&8&&(u=a.getUint32(l,!0),l+=4),s&16&&(c=a.getUint32(l,!0),l+=4);var v;switch(e[1]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:t[u]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(c>-1)v={t:"s",v:r[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:v={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return v}function bh(e,t){var r=new Uint8Array(32),a=ki(r),s=12,l=0;switch(r[0]=5,e.t){case"n":r[1]=2,iF(r,s,e.v),l|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),l|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,l,!0),r.slice(0,s)}function Eh(e,t){var r=new Uint8Array(32),a=ki(r),s=12,l=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),l|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),l|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,l,!0),r.slice(0,s)}function uF(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return cF(e,t,r,e[0]);case 5:return oF(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Xr(e){var t=Rt(e);return go(t[1][0].data)}function k_(e,t){var r=Rt(t.data),a=or(r[1][0].data),s=r[3],l=[];return(s||[]).forEach(function(c){var u=Rt(c.data),h=or(u[1][0].data)>>>0;switch(a){case 1:l[h]=em(u[3][0].data);break;case 8:{var m=e[Xr(u[9][0].data)][0],p=Rt(m.data),v=e[Xr(p[1][0].data)][0],_=or(v.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var y=Rt(v.data);l[h]=y[3].map(function(b){return em(b.data)}).join("")}break}}),l}function fF(e,t){var r,a,s,l,c,u,h,m,p,v,_,y,b,w,E=Rt(e),k=or(E[1][0].data)>>>0,A=or(E[2][0].data)>>>0,S=((a=(r=E[8])==null?void 0:r[0])==null?void 0:a.data)&&or(E[8][0].data)>0||!1,j,F;if((l=(s=E[7])==null?void 0:s[0])!=null&&l.data&&t!=0)j=(u=(c=E[7])==null?void 0:c[0])==null?void 0:u.data,F=(m=(h=E[6])==null?void 0:h[0])==null?void 0:m.data;else if((v=(p=E[4])==null?void 0:p[0])!=null&&v.data&&t!=1)j=(y=(_=E[4])==null?void 0:_[0])==null?void 0:y.data,F=(w=(b=E[3])==null?void 0:b[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var R=S?4:1,N=ki(j),X=[],G=0;G<j.length/2;++G){var se=N.getUint16(G*2,!0);se<65535&&X.push([G,se])}if(X.length!=A)throw"Expected ".concat(A," cells, found ").concat(X.length);var te=[];for(G=0;G<X.length-1;++G)te[X[G][0]]=F.subarray(X[G][1]*R,X[G+1][1]*R);return X.length>=1&&(te[X[X.length-1][0]]=F.subarray(X[X.length-1][1]*R)),{R:k,cells:te}}function dF(e,t){var r,a=Rt(t.data),s=(r=a?.[7])!=null&&r[0]?or(a[7][0].data)>>>0>0?1:0:-1,l=Wm(a[5],function(c){return fF(c,s)});return{nrows:or(a[4][0].data)>>>0,data:l.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(h,m){if(c[u.R][m])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(m));c[u.R][m]=h}),c},[])}}function hF(e,t,r){var a,s=Rt(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(or(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(or(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=dt(l);var c=Rt(s[4][0].data),u=k_(e,e[Xr(c[4][0].data)][0]),h=(a=c[17])!=null&&a[0]?k_(e,e[Xr(c[17][0].data)][0]):[],m=Rt(c[3][0].data),p=0;m[1].forEach(function(v){var _=Rt(v.data),y=e[Xr(_[2][0].data)][0],b=or(y.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var w=dF(e,y);w.data.forEach(function(E,k){E.forEach(function(A,S){var j=st({r:p+k,c:S}),F=uF(A,u,h);F&&(r[j]=F)})}),p+=w.nrows})}function mF(e,t){var r=Rt(t.data),a={"!ref":"A1"},s=e[Xr(r[2][0].data)],l=or(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return hF(e,s[0],a),a}function pF(e,t){var r,a=Rt(t.data),s={name:(r=a[1])!=null&&r[0]?em(a[1][0].data):"",sheets:[]},l=Wm(a[2],Xr);return l.forEach(function(c){e[c].forEach(function(u){var h=or(u.meta[1][0].data);h==6e3&&s.sheets.push(mF(e,u))})}),s}function gF(e,t){var r=Qm(),a=Rt(t.data),s=Wm(a[1],Xr);if(s.forEach(function(l){e[l].forEach(function(c){var u=or(c.meta[1][0].data);if(u==2){var h=pF(e,c);h.sheets.forEach(function(m,p){Zm(r,m,p==0?h.name:h.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Sh(e){var t,r,a,s,l={},c=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var m;try{m=Wa(h.content)}catch(v){return console.log("?? "+h.content.length+" "+(v.message||v))}var p;try{p=$a(m)}catch(v){return console.log("## "+(v.message||v))}p.forEach(function(v){l[v.id]=v.messages,c.push(v.id)})}}),!c.length)throw new Error("File has no messages");var u=((s=(a=(r=(t=l?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&or(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||c.forEach(function(h){l[h].forEach(function(m){var p=or(m.meta[1][0].data)>>>0;if(p==1)if(!u)u=m;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return gF(l,u)}function xF(e,t,r){var a,s,l,c;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var u=((c=(l=e[8])==null?void 0:l[0])==null?void 0:c.data)&&or(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,m=ki(e[7][0].data),p=0,v=[],_=ki(e[4][0].data),y=0,b=[],w=0;w<t.length;++w){if(t[w]==null){m.setUint16(w*2,65535,!0),_.setUint16(w*2,65535);continue}m.setUint16(w*2,p,!0),_.setUint16(w*2,y,!0);var E,k;switch(typeof t[w]){case"string":E=bh({t:"s",v:t[w]},r),k=Eh({t:"s",v:t[w]},r);break;case"number":E=bh({t:"n",v:t[w]},r),k=Eh({t:"n",v:t[w]},r);break;case"boolean":E=bh({t:"b",v:t[w]},r),k=Eh({t:"b",v:t[w]},r);break;default:throw new Error("Unsupported value "+t[w])}v.push(E),p+=E.length,b.push(k),y+=k.length,++h}for(e[2][0].data=Lt(h);w<e[7][0].data.length/2;++w)m.setUint16(w*2,65535,!0),_.setUint16(w*2,65535,!0);return e[6][0].data=Ls(v),e[3][0].data=Ls(b),h}function vF(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=xa(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(dt(a)));var l=Of(r,{range:a,header:1}),c=["~Sh33tJ5~"];l.forEach(function(H){return H.forEach(function(I){typeof I=="string"&&c.push(I)})});var u={},h=[],m=tt.read(t.numbers,{type:"base64"});m.FileIndex.map(function(H,I){return[H,m.FullPaths[I]]}).forEach(function(H){var I=H[0],L=H[1];if(I.type==2&&I.name.match(/\.iwa/)){var Z=I.content,re=Wa(Z),de=$a(re);de.forEach(function(ve){h.push(ve.id),u[ve.id]={deps:[],location:L,type:or(ve.messages[0].meta[1][0].data)}})}}),h.sort(function(H,I){return H-I});var p=h.filter(function(H){return H>1}).map(function(H){return[H,Lt(H)]});m.FileIndex.map(function(H,I){return[H,m.FullPaths[I]]}).forEach(function(H){var I=H[0];if(H[1],!!I.name.match(/\.iwa/)){var L=$a(Wa(I.content));L.forEach(function(Z){Z.messages.forEach(function(re){p.forEach(function(de){Z.messages.some(function(ve){return or(ve.meta[1][0].data)!=11006&&nF(ve.data,de[1])})&&u[de[0]].deps.push(Z.id)})})})}});for(var v=tt.find(m,u[1].location),_=$a(Wa(v.content)),y,b=0;b<_.length;++b){var w=_[b];w.id==1&&(y=w)}var E=Xr(Rt(y.messages[0].data)[1][0].data);for(v=tt.find(m,u[E].location),_=$a(Wa(v.content)),b=0;b<_.length;++b)w=_[b],w.id==E&&(y=w);for(E=Xr(Rt(y.messages[0].data)[2][0].data),v=tt.find(m,u[E].location),_=$a(Wa(v.content)),b=0;b<_.length;++b)w=_[b],w.id==E&&(y=w);for(E=Xr(Rt(y.messages[0].data)[2][0].data),v=tt.find(m,u[E].location),_=$a(Wa(v.content)),b=0;b<_.length;++b)w=_[b],w.id==E&&(y=w);var k=Rt(y.messages[0].data);{k[6][0].data=Lt(a.e.r+1),k[7][0].data=Lt(a.e.c+1);var A=Xr(k[46][0].data),S=tt.find(m,u[A].location),j=$a(Wa(S.content));{for(var F=0;F<j.length&&j[F].id!=A;++F);if(j[F].id!=A)throw"Bad ColumnRowUIDMapArchive";var R=Rt(j[F].messages[0].data);R[1]=[],R[2]=[],R[3]=[];for(var N=0;N<=a.e.c;++N){var X=[];X[1]=X[2]=[{type:0,data:Lt(N+420690)}],R[1].push({type:2,data:Hr(X)}),R[2].push({type:0,data:Lt(N)}),R[3].push({type:0,data:Lt(N)})}R[4]=[],R[5]=[],R[6]=[];for(var G=0;G<=a.e.r;++G)X=[],X[1]=X[2]=[{type:0,data:Lt(G+726270)}],R[4].push({type:2,data:Hr(X)}),R[5].push({type:0,data:Lt(G)}),R[6].push({type:0,data:Lt(G)});j[F].messages[0].data=Hr(R)}S.content=bl(wl(j)),S.size=S.content.length,delete k[46];var se=Rt(k[4][0].data);{se[7][0].data=Lt(a.e.r+1);var te=Rt(se[1][0].data),z=Xr(te[2][0].data);S=tt.find(m,u[z].location),j=$a(Wa(S.content));{if(j[0].id!=z)throw"Bad HeaderStorageBucket";var ge=Rt(j[0].messages[0].data);for(G=0;G<l.length;++G){var Oe=Rt(ge[2][0].data);Oe[1][0].data=Lt(G),Oe[4][0].data=Lt(l[G].length),ge[2][G]={type:ge[2][0].type,data:Hr(Oe)}}j[0].messages[0].data=Hr(ge)}S.content=bl(wl(j)),S.size=S.content.length;var Ce=Xr(se[2][0].data);S=tt.find(m,u[Ce].location),j=$a(Wa(S.content));{if(j[0].id!=Ce)throw"Bad HeaderStorageBucket";for(ge=Rt(j[0].messages[0].data),N=0;N<=a.e.c;++N)Oe=Rt(ge[2][0].data),Oe[1][0].data=Lt(N),Oe[4][0].data=Lt(a.e.r+1),ge[2][N]={type:ge[2][0].type,data:Hr(Oe)};j[0].messages[0].data=Hr(ge)}S.content=bl(wl(j)),S.size=S.content.length;var Q=Xr(se[4][0].data);(function(){for(var H=tt.find(m,u[Q].location),I=$a(Wa(H.content)),L,Z=0;Z<I.length;++Z){var re=I[Z];re.id==Q&&(L=re)}var de=Rt(L.messages[0].data);{de[3]=[];var ve=[];c.forEach(function(U,Ze){ve[1]=[{type:0,data:Lt(Ze)}],ve[2]=[{type:0,data:Lt(1)}],ve[3]=[{type:2,data:aF(U)}],de[3].push({type:2,data:Hr(ve)})})}L.messages[0].data=Hr(de);var Se=wl(I),xe=bl(Se);H.content=xe,H.size=H.content.length})();var le=Rt(se[3][0].data);{var Ee=le[1][0];delete le[2];var K=Rt(Ee.data);{var Te=Xr(K[2][0].data);(function(){for(var H=tt.find(m,u[Te].location),I=$a(Wa(H.content)),L,Z=0;Z<I.length;++Z){var re=I[Z];re.id==Te&&(L=re)}var de=Rt(L.messages[0].data);{delete de[6],delete le[7];var ve=new Uint8Array(de[5][0].data);de[5]=[];for(var Se=0,xe=0;xe<=a.e.r;++xe){var U=Rt(ve);Se+=xF(U,l[xe],c),U[1][0].data=Lt(xe),de[5].push({data:Hr(U),type:2})}de[1]=[{type:0,data:Lt(a.e.c+1)}],de[2]=[{type:0,data:Lt(a.e.r+1)}],de[3]=[{type:0,data:Lt(Se)}],de[4]=[{type:0,data:Lt(a.e.r+1)}]}L.messages[0].data=Hr(de);var Ze=wl(I),Ie=bl(Ze);H.content=Ie,H.size=H.content.length})()}Ee.data=Hr(K)}se[3][0].data=Hr(le)}k[4][0].data=Hr(se)}y.messages[0].data=Hr(k);var q=wl(_),C=bl(q);return v.content=C,v.size=v.content.length,m}function U2(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Xm(e){U2([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Km(e){U2([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function _F(e){return vt.WS.indexOf(e)>-1?"sheet":e==vt.CS?"chart":e==vt.DS?"dialog":e==vt.MS?"macro":e&&e.length?e:"sheet"}function yF(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,_F(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function wF(e,t,r,a,s,l,c,u,h,m,p,v){try{l[a]=Yc(Ca(e,r,!0),t);var _=br(e,t),y;switch(u){case"sheet":y=q6(_,t,s,h,l[a],m,p,v);break;case"chart":if(y=V6(_,t,s,h,l[a],m,p,v),!y||!y["!drawel"])break;var b=$c(y["!drawel"].Target,t),w=oo(b),E=C3(Ca(e,b,!0),Yc(Ca(e,w,!0),b)),k=$c(E,b),A=oo(k);y=x6(Ca(e,k,!0),k,h,Yc(Ca(e,A,!0),k),m,y);break;case"macro":y=G6(_,t,s,h,l[a],m,p,v);break;case"dialog":y=$6(_,t,s,h,l[a],m,p,v);break;default:throw new Error("Unrecognized sheet type "+u)}c[a]=y;var S=[];l&&l[a]&&ur(l[a]).forEach(function(j){var F="";if(l[a][j].Type==vt.CMNT){F=$c(l[a][j].Target,t);var R=Y6(br(e,F,!0),F,h);if(!R||!R.length)return;f_(y,R,!1)}l[a][j].Type==vt.TCMNT&&(F=$c(l[a][j].Target,t),S=S.concat(R3(br(e,F,!0),h)))}),S&&S.length&&f_(y,S,!0,h.people||[])}catch(j){if(h.WTF)throw j}}function Va(e){return e.charAt(0)=="/"?e.slice(1):e}function bF(e,t){if(ql(),t=t||{},Xm(t),Xa(e,"META-INF/manifest.xml")||Xa(e,"objectdata.xml"))return b_(e,t);if(Xa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Sh<"u"){if(e.FileIndex)return Sh(e);var r=tt.utils.cfb_new();return R1(e).forEach(function(Oe){gt(r,Oe,DA(e,Oe))}),Sh(r)}throw new Error("Unsupported NUMBERS file")}if(!Xa(e,"[Content_Types].xml"))throw Xa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Xa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=R1(e),s=kj(Ca(e,"[Content_Types].xml")),l=!1,c,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",br(e,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!br(e,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},m={};if(!t.bookSheets&&!t.bookProps){if(Jc=[],s.sst)try{Jc=K6(br(e,Va(s.sst)),s.sst,t)}catch(Oe){if(t.WTF)throw Oe}t.cellStyles&&s.themes.length&&(h=X6(Ca(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(m=W6(br(e,Va(s.style)),s.style,h,t))}s.links.map(function(Oe){try{var Ce=Yc(Ca(e,oo(Va(Oe))),Oe);return Q6(br(e,Va(Oe)),Ce,Oe,t)}catch{}});var p=H6(br(e,Va(s.workbooks[0])),s.workbooks[0],t),v={},_="";s.coreprops.length&&(_=br(e,Va(s.coreprops[0]),!0),_&&(v=kw(_)),s.extprops.length!==0&&(_=br(e,Va(s.extprops[0]),!0),_&&Dj(_,v,t)));var y={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(_=Ca(e,Va(s.custprops[0]),!0),_&&(y=Mj(_,t)));var b={};if((t.bookSheets||t.bookProps)&&(p.Sheets?c=p.Sheets.map(function(Ce){return Ce.name}):v.Worksheets&&v.SheetNames.length>0&&(c=v.SheetNames),t.bookProps&&(b.Props=v,b.Custprops=y),t.bookSheets&&typeof c<"u"&&(b.SheetNames=c),t.bookSheets?b.SheetNames:t.bookProps))return b;c={};var w={};t.bookDeps&&s.calcchain&&(w=J6(br(e,Va(s.calcchain)),s.calcchain));var E=0,k={},A,S;{var j=p.Sheets;v.Worksheets=j.length,v.SheetNames=[];for(var F=0;F!=j.length;++F)v.SheetNames[F]=j[F].name}var R=l?"bin":"xml",N=s.workbooks[0].lastIndexOf("/"),X=(s.workbooks[0].slice(0,N+1)+"_rels/"+s.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");Xa(e,X)||(X="xl/_rels/workbook."+R+".rels");var G=Yc(Ca(e,X,!0),X.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=Z6(br(e,Va(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=F3(br(e,Va(s.people[0])),t)),G&&(G=yF(G,p.Sheets));var se=br(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=v.Worksheets;++E){var te="sheet";if(G&&G[E]?(A="xl/"+G[E][1].replace(/[\/]?xl\//,""),Xa(e,A)||(A=G[E][1]),Xa(e,A)||(A=X.replace(/_rels\/.*$/,"")+G[E][1]),te=G[E][2]):(A="xl/worksheets/sheet"+(E+1-se)+"."+R,A=A.replace(/sheet0\./,"sheet.")),S=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(v.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var z=!1,ge=0;ge!=t.sheets.length;++ge)typeof t.sheets[ge]=="number"&&t.sheets[ge]==E&&(z=1),typeof t.sheets[ge]=="string"&&t.sheets[ge].toLowerCase()==v.SheetNames[E].toLowerCase()&&(z=1);if(!z)continue e}}wF(e,A,S,v.SheetNames[E],E,k,c,te,t,p,h,m)}return b={Directory:s,Workbook:p,Props:v,Custprops:y,Deps:w,Sheets:c,SheetNames:v.SheetNames,Strings:Jc,Styles:m,Themes:h,SSF:Qt(nt)},t&&t.bookFiles&&(e.files?(b.keys=a,b.files=e.files):(b.keys=[],b.files={},e.FullPaths.forEach(function(Oe,Ce){Oe=Oe.replace(/^Root Entry[\/]/,""),b.keys.push(Oe),b.files[Oe]=e.FileIndex[Ce]}))),t&&t.bookVBA&&(s.vba.length>0?b.vbaraw=br(e,Va(s.vba[0]),!0):s.defaults&&s.defaults.bin===H3&&(b.vbaraw=br(e,"xl/vbaProject.bin",!0))),b}function EF(e,t){var r=t||{},a="Workbook",s=tt.find(e,a);try{if(a="/!DataSpaces/Version",s=tt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(ZN(s.content),a="/!DataSpaces/DataSpaceMap",s=tt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=tC(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=tt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=rC(s.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=tt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);nC(s.content)}catch{}if(a="/EncryptionInfo",s=tt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var u=sC(s.content);if(a="/EncryptedPackage",s=tt.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function SF(e,t){return t.bookType=="ods"?L2(e,t):t.bookType=="numbers"?vF(e,t):t.bookType=="xlsb"?TF(e,t):kF(e,t)}function TF(e,t){kl=1024,e&&!e.SSF&&(e.SSF=Qt(nt)),e&&e.SSF&&(ql(),Lf(e.SSF),t.revssf=If(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Qc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=f2.indexOf(t.bookType)>-1,s=Fm();Km(t=t||{});var l=ym(),c="",u=0;if(t.cellXfs=[],Ps(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",gt(l,c,Aw(e.Props,t)),s.coreprops.push(c),Ut(t.rels,2,c,vt.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],m=0;m<e.SheetNames.length;++m)(e.Workbook.Sheets[m]||{}).Hidden!=2&&h.push(e.SheetNames[m]);e.Props.SheetNames=h}for(e.Props.Worksheets=e.Props.SheetNames.length,gt(l,c,Cw(e.Props)),s.extprops.push(c),Ut(t.rels,3,c,vt.EXT_PROPS),e.Custprops!==e.Props&&ur(e.Custprops||{}).length>0&&(c="docProps/custom.xml",gt(l,c,Ow(e.Custprops)),s.custprops.push(c),Ut(t.rels,4,c,vt.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var p={"!id":{}},v=e.Sheets[e.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";switch(_){case"chart":default:c="xl/worksheets/sheet"+u+"."+r,gt(l,c,tD(u-1,c,t,e,p)),s.sheets.push(c),Ut(t.wbrels,-1,"worksheets/sheet"+u+"."+r,vt.WS[0])}if(v){var y=v["!comments"],b=!1,w="";y&&y.length>0&&(w="xl/comments"+u+"."+r,gt(l,w,nD(y,w)),s.comments.push(w),Ut(p,-1,"../comments"+u+"."+r,vt.CMNT),b=!0),v["!legacy"]&&b&&gt(l,"xl/drawings/vmlDrawing"+u+".vml",o2(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&gt(l,oo(c),Ol(p))}return t.Strings!=null&&t.Strings.length>0&&(c="xl/sharedStrings."+r,gt(l,c,aD(t.Strings,c,t)),s.strs.push(c),Ut(t.wbrels,-1,"sharedStrings."+r,vt.SST)),c="xl/workbook."+r,gt(l,c,eD(e,c)),s.workbooks.push(c),Ut(t.rels,1,c,vt.WB),c="xl/theme/theme1.xml",gt(l,c,Pm(e.Themes,t)),s.themes.push(c),Ut(t.wbrels,-1,"theme/theme1.xml",vt.THEME),c="xl/styles."+r,gt(l,c,rD(e,c,t)),s.styles.push(c),Ut(t.wbrels,-1,"styles."+r,vt.STY),e.vbaraw&&a&&(c="xl/vbaProject.bin",gt(l,c,e.vbaraw),s.vba.push(c),Ut(t.wbrels,-1,"vbaProject.bin",vt.VBA)),c="xl/metadata."+r,gt(l,c,sD(c)),s.metadata.push(c),Ut(t.wbrels,-1,"metadata."+r,vt.XLMETA),gt(l,"[Content_Types].xml",Sw(s,t)),gt(l,"_rels/.rels",Ol(t.rels)),gt(l,"xl/_rels/workbook."+r+".rels",Ol(t.wbrels)),delete t.revssf,delete t.ssf,l}function kF(e,t){kl=1024,e&&!e.SSF&&(e.SSF=Qt(nt)),e&&e.SSF&&(ql(),Lf(e.SSF),t.revssf=If(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Qc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=f2.indexOf(t.bookType)>-1,s=Fm();Km(t=t||{});var l=ym(),c="",u=0;if(t.cellXfs=[],Ps(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",gt(l,c,Aw(e.Props,t)),s.coreprops.push(c),Ut(t.rels,2,c,vt.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],m=0;m<e.SheetNames.length;++m)(e.Workbook.Sheets[m]||{}).Hidden!=2&&h.push(e.SheetNames[m]);e.Props.SheetNames=h}e.Props.Worksheets=e.Props.SheetNames.length,gt(l,c,Cw(e.Props)),s.extprops.push(c),Ut(t.rels,3,c,vt.EXT_PROPS),e.Custprops!==e.Props&&ur(e.Custprops||{}).length>0&&(c="docProps/custom.xml",gt(l,c,Ow(e.Custprops)),s.custprops.push(c),Ut(t.rels,4,c,vt.CUST_PROPS));var p=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var v={"!id":{}},_=e.Sheets[e.SheetNames[u-1]],y=(_||{})["!type"]||"sheet";switch(y){case"chart":default:c="xl/worksheets/sheet"+u+"."+r,gt(l,c,b2(u-1,t,e,v)),s.sheets.push(c),Ut(t.wbrels,-1,"worksheets/sheet"+u+"."+r,vt.WS[0])}if(_){var b=_["!comments"],w=!1,E="";if(b&&b.length>0){var k=!1;b.forEach(function(A){A[1].forEach(function(S){S.T==!0&&(k=!0)})}),k&&(E="xl/threadedComments/threadedComment"+u+"."+r,gt(l,E,D3(b,p,t)),s.threadedcomments.push(E),Ut(v,-1,"../threadedComments/threadedComment"+u+"."+r,vt.TCMNT)),E="xl/comments"+u+"."+r,gt(l,E,u2(b)),s.comments.push(E),Ut(v,-1,"../comments"+u+"."+r,vt.CMNT),w=!0}_["!legacy"]&&w&&gt(l,"xl/drawings/vmlDrawing"+u+".vml",o2(u,_["!comments"])),delete _["!comments"],delete _["!legacy"]}v["!id"].rId1&&gt(l,oo(c),Ol(v))}return t.Strings!=null&&t.Strings.length>0&&(c="xl/sharedStrings."+r,gt(l,c,Jw(t.Strings,t)),s.strs.push(c),Ut(t.wbrels,-1,"sharedStrings."+r,vt.SST)),c="xl/workbook."+r,gt(l,c,A2(e)),s.workbooks.push(c),Ut(t.rels,1,c,vt.WB),c="xl/theme/theme1.xml",gt(l,c,Pm(e.Themes,t)),s.themes.push(c),Ut(t.wbrels,-1,"theme/theme1.xml",vt.THEME),c="xl/styles."+r,gt(l,c,s2(e,t)),s.styles.push(c),Ut(t.wbrels,-1,"styles."+r,vt.STY),e.vbaraw&&a&&(c="xl/vbaProject.bin",gt(l,c,e.vbaraw),s.vba.push(c),Ut(t.wbrels,-1,"vbaProject.bin",vt.VBA)),c="xl/metadata."+r,gt(l,c,c2()),s.metadata.push(c),Ut(t.wbrels,-1,"metadata."+r,vt.XLMETA),p.length>1&&(c="xl/persons/person.xml",gt(l,c,M3(p)),s.people.push(c),Ut(t.wbrels,-1,"persons/person.xml",vt.PEOPLE)),gt(l,"[Content_Types].xml",Sw(s,t)),gt(l,"_rels/.rels",Ol(t.rels)),gt(l,"xl/_rels/workbook."+r+".rels",Ol(t.wbrels)),delete t.revssf,delete t.ssf,l}function Ym(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Oa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function AF(e,t){return tt.find(e,"EncryptedPackage")?EF(e,t):O2(e,t)}function jF(e,t){var r,a=e,s=t||{};return s.type||(s.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r=Zy(a,s),bF(r,s)}function I2(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Qh(e.slice(r),t);default:break e}return Ul.to_workbook(e,t)}function NF(e,t){var r="",a=Ym(e,t);switch(t.type){case"base64":r=Oa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=bi(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=qt(r)),t.type="binary",I2(r,t)}function CF(e,t){var r=e;return t.type=="base64"&&(r=Oa(r)),r=ao.utils.decode(1200,r.slice(2),"str"),t.type="binary",I2(r,t)}function OF(e){return e.match(/[^\x00-\x7F]/)?wn(e):e}function Th(e,t,r,a){return a?(r.type="string",Ul.to_workbook(e,r)):Ul.to_workbook(t,r)}function tm(e,t){pm();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return tm(new Uint8Array(e),(r=Qt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Dl={},r.dateNF&&(Dl.dateNF=r.dateNF),r.type||(r.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=xt?"buffer":"binary",a=TA(e),typeof Uint8Array<"u"&&!xt&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,a=OF(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return r=Qt(r),r.type="array",tm(gm(a),r)}switch((s=Ym(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return AF(tt.read(a,r),r);break;case 9:if(s[1]<=8)return O2(a,r);break;case 60:return Qh(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return BN(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Kw.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?jF(a,r):Th(e,a,r,l);case 239:return s[3]===60?Qh(a,r):Th(e,a,r,l);case 255:if(s[1]===254)return CF(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return _i.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return _i.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Jh.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return r2.to_workbook(a,r);break;case 10:case 13:case 32:return NF(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return MN.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Jh.to_workbook(a,r):Th(e,a,r,l)}function P2(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return _o(t.file,tt.write(e,{type:xt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return tt.write(e,t)}function RF(e,t){var r=Qt(t||{}),a=SF(e,r);return DF(a,r)}function DF(e,t){var r={},a=xt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?tt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Bf(s))}return t.password&&typeof encrypt_agile<"u"?P2(encrypt_agile(s,t.password),t):t.type==="file"?_o(t.file,s):t.type=="string"?qt(s):s}function FF(e,t){var r=t||{},a=OD(e,r);return P2(a,r)}function _n(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return no(wn(a));case"binary":return wn(a);case"string":return e;case"file":return _o(t.file,a,"utf8");case"buffer":return xt?Jn(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):_n(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function MF(e,t){switch(t.type){case"base64":return no(e);case"binary":return e;case"string":return e;case"file":return _o(t.file,e,"binary");case"buffer":return xt?Jn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function cf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?no(r):t.type=="string"?qt(r):r;case"file":return _o(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function z2(e,t){pm(),A6(e);var r=Qt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=z2(e,r);return r.type="array",Bf(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return _n(SD(e,r),r);case"slk":case"sylk":return _n(Xw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return _n(D2(e.Sheets[e.SheetNames[s]],r),r);case"txt":return MF(H2(e.Sheets[e.SheetNames[s]],r),r);case"csv":return _n(Jm(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return _n(Kw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return cf(Jh.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return _n(Ul.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return _n(r2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return _n(Yw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return _n(L2(e,r),r);case"wk1":return cf(_i.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return cf(_i.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),cf(R2(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),FF(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return RF(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function BF(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function LF(e,t,r){var a={};return a.type="file",a.file=t,BF(a),z2(e,a)}function UF(e,t,r,a,s,l,c,u){var h=mr(r),m=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,_=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!c||e[r])for(var y=t.s.c;y<=t.e.c;++y){var b=c?e[r][y]:e[a[y]+h];if(b===void 0||b.t===void 0){if(m===void 0)continue;l[y]!=null&&(_[l[y]]=m);continue}var w=b.v;switch(b.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(l[y]!=null){if(w==null)if(b.t=="e"&&w===null)_[l[y]]=null;else if(m!==void 0)_[l[y]]=m;else if(p&&w===null)_[l[y]]=null;else continue;else _[l[y]]=p&&(b.t!=="n"||b.t==="n"&&u.rawNumbers!==!1)?w:Yn(b,w,u);w!=null&&(v=!1)}}return{row:_,isempty:v}}function Of(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,l=[],c=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},m=t||{},p=m.range!=null?m.range:e["!ref"];switch(m.header===1?a=1:m.header==="A"?a=2:Array.isArray(m.header)?a=3:m.header==null&&(a=0),typeof p){case"string":h=Nt(p);break;case"number":h=Nt(e["!ref"]),h.s.r=p;break;default:h=p}a>0&&(s=0);var v=mr(h.s.r),_=[],y=[],b=0,w=0,E=Array.isArray(e),k=h.s.r,A=0,S={};E&&!e[k]&&(e[k]=[]);var j=m.skipHidden&&e["!cols"]||[],F=m.skipHidden&&e["!rows"]||[];for(A=h.s.c;A<=h.e.c;++A)if(!(j[A]||{}).hidden)switch(_[A]=nr(A),r=E?e[k][A]:e[_[A]+v],a){case 1:l[A]=A-h.s.c;break;case 2:l[A]=_[A];break;case 3:l[A]=m.header[A-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=c=Yn(r,null,m),w=S[c]||0,!w)S[c]=1;else{do u=c+"_"+w++;while(S[u]);S[c]=w,S[u]=1}l[A]=u}for(k=h.s.r+s;k<=h.e.r;++k)if(!(F[k]||{}).hidden){var R=UF(e,h,k,_,a,l,E,m);(R.isempty===!1||(a===1?m.blankrows!==!1:m.blankrows))&&(y[b++]=R.row)}return y.length=b,y}var A_=/"/g;function IF(e,t,r,a,s,l,c,u){for(var h=!0,m=[],p="",v=mr(r),_=t.s.c;_<=t.e.c;++_)if(a[_]){var y=u.dense?(e[r]||[])[_]:e[a[_]+v];if(y==null)p="";else if(y.v!=null){h=!1,p=""+(u.rawNumbers&&y.t=="n"?y.v:Yn(y,null,u));for(var b=0,w=0;b!==p.length;++b)if((w=p.charCodeAt(b))===s||w===l||w===34||u.forceQuotes){p='"'+p.replace(A_,'""')+'"';break}p=="ID"&&(p='"ID"')}else y.f!=null&&!y.F?(h=!1,p="="+y.f,p.indexOf(",")>=0&&(p='"'+p.replace(A_,'""')+'"')):p="";m.push(p)}return u.blankrows===!1&&h?null:m.join(c)}function Jm(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=Nt(e["!ref"]),l=a.FS!==void 0?a.FS:",",c=l.charCodeAt(0),u=a.RS!==void 0?a.RS:`
`,h=u.charCodeAt(0),m=new RegExp((l=="|"?"\\|":l)+"+$"),p="",v=[];a.dense=Array.isArray(e);for(var _=a.skipHidden&&e["!cols"]||[],y=a.skipHidden&&e["!rows"]||[],b=s.s.c;b<=s.e.c;++b)(_[b]||{}).hidden||(v[b]=nr(b));for(var w=0,E=s.s.r;E<=s.e.r;++E)(y[E]||{}).hidden||(p=IF(e,s,E,v,c,h,l,a),p!=null&&(a.strip&&(p=p.replace(m,"")),(p||a.blankrows!==!1)&&r.push((w++?u:"")+p)));return delete a.dense,r.join("")}function H2(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Jm(e,t);return r}function PF(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=Nt(e["!ref"]),l="",c=[],u,h=[],m=Array.isArray(e);for(u=s.s.c;u<=s.e.c;++u)c[u]=nr(u);for(var p=s.s.r;p<=s.e.r;++p)for(l=mr(p),u=s.s.c;u<=s.e.c;++u)if(t=c[u]+l,r=m?(e[p]||[])[u]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}h[h.length]=t+"="+a}return h}function q2(e,t,r){var a=r||{},s=+!a.skipHeader,l=e||{},c=0,u=0;if(l&&a.origin!=null)if(typeof a.origin=="number")c=a.origin;else{var h=typeof a.origin=="string"?sr(a.origin):a.origin;c=h.r,u=h.c}var m,p={s:{c:0,r:0},e:{c:u,r:c+t.length-1+s}};if(l["!ref"]){var v=Nt(l["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),c==-1&&(c=v.e.r+1,p.e.r=c+t.length-1+s)}else c==-1&&(c=0,p.e.r=t.length-1+s);var _=a.header||[],y=0;t.forEach(function(w,E){ur(w).forEach(function(k){(y=_.indexOf(k))==-1&&(_[y=_.length]=k);var A=w[k],S="z",j="",F=st({c:u+y,r:c+E+s});m=xo(l,F),A&&typeof A=="object"&&!(A instanceof Date)?l[F]=A:(typeof A=="number"?S="n":typeof A=="boolean"?S="b":typeof A=="string"?S="s":A instanceof Date?(S="d",a.cellDates||(S="n",A=Ar(A)),j=a.dateNF||nt[14]):A===null&&a.nullError&&(S="e",A=0),m?(m.t=S,m.v=A,delete m.w,delete m.R,j&&(m.z=j)):l[F]=m={t:S,v:A},j&&(m.z=j))})}),p.e.c=Math.max(p.e.c,u+_.length-1);var b=mr(c);if(s)for(y=0;y<_.length;++y)l[nr(y+u)+b]={t:"s",v:_[y]};return l["!ref"]=dt(p),l}function zF(e,t){return q2(null,e,t)}function xo(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=sr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?xo(e,st(t)):xo(e,st({r:t,c:r||0}))}function HF(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Qm(){return{SheetNames:[],Sheets:{}}}function Zm(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var c=l&&l[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=c+s)!=-1;++s);}if(k2(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function qF(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=HF(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function VF(e,t){return e.z=t,e}function V2(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function GF(e,t,r){return V2(e,"#"+t,r)}function $F(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function WF(e,t,r,a){for(var s=typeof t!="string"?t:Nt(t),l=typeof t=="string"?t:dt(t),c=s.s.r;c<=s.e.r;++c)for(var u=s.s.c;u<=s.e.c;++u){var h=xo(e,c,u);h.t="n",h.F=l,delete h.v,c==s.s.r&&u==s.s.c&&(h.f=r,a&&(h.D=!0))}return e}var js={encode_col:nr,encode_row:mr,encode_cell:st,encode_range:dt,decode_col:jm,decode_row:Am,split_cell:aj,decode_cell:sr,decode_range:xa,format_cell:Yn,sheet_add_aoa:xw,sheet_add_json:q2,sheet_add_dom:F2,aoa_to_sheet:Vl,json_to_sheet:zF,table_to_sheet:M2,table_to_book:ZD,sheet_to_csv:Jm,sheet_to_txt:H2,sheet_to_json:Of,sheet_to_html:D2,sheet_to_formulae:PF,sheet_to_row_object_array:Of,sheet_get_cell:xo,book_new:Qm,book_append_sheet:Zm,book_set_sheet_visibility:qF,cell_set_number_format:VF,cell_set_hyperlink:V2,cell_set_internal_link:GF,cell_add_comment:$F,sheet_set_array_formula:WF,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function G2({project:e,onShowToast:t}){const[r,a]=J.useState([]),[s,l]=J.useState(!0),[c,u]=J.useState("all"),[h,m]=J.useState(null);J.useEffect(()=>{p()},[e.id]);const p=async()=>{try{const j=await Ge.getTMTickets(e.id);a(j)}catch(j){console.error("Error loading tickets:",j),t("Error loading T&M tickets","error")}finally{l(!1)}},v=async(j,F)=>{try{await Ge.updateTMTicketStatus(j,F),a(r.map(R=>R.id===j?{...R,status:F}:R)),t(`Ticket ${F}`,"success")}catch(R){console.error("Error updating status:",R),t("Error updating status","error")}},_=async j=>{if(confirm("Delete this T&M ticket?"))try{await Ge.deleteTMTicket(j),a(r.filter(F=>F.id!==j)),t("Ticket deleted","success")}catch(F){console.error("Error deleting ticket:",F),t("Error deleting ticket","error")}},y=j=>{let F=0;return j.t_and_m_items&&j.t_and_m_items.forEach(R=>{R.materials_equipment?.cost_per_unit&&(F+=R.quantity*R.materials_equipment.cost_per_unit)}),F},b=j=>j.t_and_m_workers?j.t_and_m_workers.reduce((F,R)=>F+parseFloat(R.hours),0):0,w=j=>new Date(j).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),E=()=>{const j=c==="all"?r:r.filter(te=>te.status===c);if(j.length===0){t("No tickets to export","error");return}const F=[],R=[],N=[];j.forEach(te=>{const z=w(te.work_date),ge=te.status;te.t_and_m_workers&&te.t_and_m_workers.forEach(Oe=>{F.push({Date:z,Status:ge,"Worker Name":Oe.name,Hours:Oe.hours})}),te.t_and_m_items&&te.t_and_m_items.forEach(Oe=>{const Ce=Oe.custom_name||Oe.materials_equipment?.name||"Unknown",Q=Oe.custom_category||Oe.materials_equipment?.category||"Unknown",le=Oe.materials_equipment?.unit||"each",Ee=Oe.materials_equipment?.cost_per_unit||0,K=Oe.quantity*Ee;R.push({Date:z,Status:ge,Category:Q,Item:Ce,Quantity:Oe.quantity,Unit:le,"Cost/Unit":Ee,Total:K})}),N.push({Date:z,Status:ge,Workers:te.t_and_m_workers?.length||0,"Total Hours":b(te),Items:te.t_and_m_items?.length||0,"Materials Cost":y(te),Notes:te.notes||""})});const X=js.book_new(),G=js.json_to_sheet(N);if(js.book_append_sheet(X,G,"Summary"),F.length>0){const te=js.json_to_sheet(F);js.book_append_sheet(X,te,"Workers")}if(R.length>0){const te=js.json_to_sheet(R);js.book_append_sheet(X,te,"Materials & Equipment")}const se=`${e.name}_TM_${new Date().toISOString().split("T")[0]}.xlsx`;LF(X,se),t("Export downloaded!","success")},k=c==="all"?r:r.filter(j=>j.status===c),A=k.reduce((j,F)=>j+b(F),0),S=k.reduce((j,F)=>j+y(F),0);return s?f.jsx("div",{className:"loading",children:"Loading T&M tickets..."}):f.jsxs("div",{className:"tm-list",children:[f.jsxs("div",{className:"tm-list-header",children:[f.jsxs("div",{className:"tm-list-title",children:[f.jsx("h3",{children:"T&M Tickets"}),f.jsx("button",{className:"btn btn-secondary btn-small",onClick:E,children:" Export Excel"})]}),f.jsx("div",{className:"tm-filter-tabs",children:["all","pending","approved","billed","rejected"].map(j=>f.jsxs("button",{className:`tm-filter-tab ${c===j?"active":""}`,onClick:()=>u(j),children:[j.charAt(0).toUpperCase()+j.slice(1),f.jsx("span",{className:"tm-filter-count",children:j==="all"?r.length:r.filter(F=>F.status===j).length})]},j))})]}),k.length>0&&f.jsxs("div",{className:"tm-summary-bar",children:[f.jsxs("div",{className:"tm-summary-stat",children:[f.jsx("span",{className:"tm-summary-label",children:"Tickets"}),f.jsx("span",{className:"tm-summary-value",children:k.length})]}),f.jsxs("div",{className:"tm-summary-stat",children:[f.jsx("span",{className:"tm-summary-label",children:"Total Hours"}),f.jsx("span",{className:"tm-summary-value",children:A.toFixed(1)})]}),f.jsxs("div",{className:"tm-summary-stat",children:[f.jsx("span",{className:"tm-summary-label",children:"Materials Cost"}),f.jsxs("span",{className:"tm-summary-value",children:["$",S.toFixed(2)]})]})]}),k.length===0?f.jsx("div",{className:"tm-empty-state",children:f.jsxs("p",{children:["No ",c==="all"?"":c," T&M tickets"]})}):f.jsx("div",{className:"tm-tickets",children:k.map(j=>f.jsxs("div",{className:`tm-ticket-card ${j.status}`,children:[f.jsxs("div",{className:"tm-ticket-header",onClick:()=>m(h===j.id?null:j.id),children:[f.jsxs("div",{className:"tm-ticket-info",children:[f.jsx("span",{className:"tm-ticket-date",children:w(j.work_date)}),f.jsx("span",{className:`tm-ticket-status ${j.status}`,children:j.status})]}),f.jsxs("div",{className:"tm-ticket-summary",children:[f.jsxs("span",{className:"tm-ticket-hours",children:[b(j)," hrs"]}),f.jsxs("span",{className:"tm-ticket-total",children:["$",y(j).toFixed(2)]}),f.jsx("span",{className:"tm-expand-arrow",children:h===j.id?"":""})]})]}),h===j.id&&f.jsxs("div",{className:"tm-ticket-details",children:[j.t_and_m_workers?.length>0&&f.jsxs("div",{className:"tm-detail-section",children:[f.jsx("h4",{children:" Workers"}),f.jsx("div",{className:"tm-detail-list",children:j.t_and_m_workers.map(F=>f.jsxs("div",{className:"tm-detail-row",children:[f.jsxs("span",{children:[F.role&&F.role!=="Laborer"&&f.jsx("span",{className:"tm-role-badge",children:F.role}),F.name]}),f.jsxs("span",{children:[F.hours," hrs"]})]},F.id))})]}),j.t_and_m_items?.length>0&&f.jsxs("div",{className:"tm-detail-section",children:[f.jsx("h4",{children:" Materials & Equipment"}),f.jsx("div",{className:"tm-detail-list",children:j.t_and_m_items.map(F=>f.jsxs("div",{className:"tm-detail-row",children:[f.jsx("span",{children:F.custom_name?f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"tm-custom-badge",children:"Custom"})," ",F.custom_name]}):F.materials_equipment?.name}),f.jsxs("span",{className:"tm-detail-qty",children:[F.quantity," ",F.materials_equipment?.unit||"each",F.materials_equipment?.cost_per_unit>0&&f.jsxs("span",{className:"tm-item-cost",children:["$",(F.quantity*F.materials_equipment.cost_per_unit).toFixed(2)]})]})]},F.id))})]}),j.notes&&f.jsxs("div",{className:"tm-detail-section",children:[f.jsx("h4",{children:" Description"}),f.jsx("p",{className:"tm-notes-text",children:j.notes})]}),j.photos&&j.photos.length>0&&f.jsxs("div",{className:"tm-detail-section",children:[f.jsxs("h4",{children:[" Photos (",j.photos.length,")"]}),f.jsx("div",{className:"tm-photos-grid",children:j.photos.map((F,R)=>f.jsx("a",{href:F,target:"_blank",rel:"noopener noreferrer",className:"tm-photo-thumb",children:f.jsx("img",{src:F,alt:`Photo ${R+1}`})},R))})]}),f.jsxs("div",{className:"tm-ticket-actions",children:[j.status==="pending"&&f.jsxs(f.Fragment,{children:[f.jsx("button",{className:"btn btn-success btn-small",onClick:F=>{F.stopPropagation(),v(j.id,"approved")},children:" Approve"}),f.jsx("button",{className:"btn btn-warning btn-small",onClick:F=>{F.stopPropagation(),v(j.id,"rejected")},children:" Reject"})]}),j.status==="approved"&&f.jsx("button",{className:"btn btn-primary btn-small",onClick:F=>{F.stopPropagation(),v(j.id,"billed")},children:" Mark Billed"}),j.status==="rejected"&&f.jsx("button",{className:"btn btn-secondary btn-small",onClick:F=>{F.stopPropagation(),v(j.id,"pending")},children:" Restore"}),f.jsx("button",{className:"btn btn-danger btn-small",onClick:F=>{F.stopPropagation(),_(j.id)},children:" Delete"})]})]})]},j.id))})]})}function XF({project:e,onShowToast:t}){const[r,a]=J.useState([]),[s,l]=J.useState(!0),[c,u]=J.useState(!1),[h,m]=J.useState(!1),[p,v]=J.useState({name:"",role:"Laborer"});J.useEffect(()=>{_()},[e.id]);const _=async()=>{try{const E=await Ge.getCrewCheckin(e.id);E?.workers&&a(E.workers)}catch(E){console.error("Error loading crew:",E)}finally{l(!1)}},y=async()=>{if(!p.name.trim()){t("Enter worker name","error");return}if(r.find(E=>E.name.toLowerCase()===p.name.trim().toLowerCase())){t("Worker already added","error");return}u(!0);try{const E=[...r,{name:p.name.trim(),role:p.role}];await Ge.saveCrewCheckin(e.id,E),a(E),v({name:"",role:"Laborer"}),m(!1),t("Crew member added","success")}catch(E){console.error("Error adding worker:",E),t("Error adding crew member","error")}finally{u(!1)}},b=async E=>{u(!0);try{const k=r.filter(A=>A.name.toLowerCase()!==E.toLowerCase());await Ge.saveCrewCheckin(e.id,k),a(k),t("Crew member removed","success")}catch(k){console.error("Error removing worker:",k),t("Error removing crew member","error")}finally{u(!1)}},w=new Date().toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"});return s?f.jsxs("div",{className:"crew-checkin",children:[f.jsxs("div",{className:"crew-header",children:[f.jsx("h3",{children:" Today's Crew"}),f.jsx("span",{className:"crew-date",children:w})]}),f.jsx("div",{className:"crew-loading",children:"Loading..."})]}):f.jsxs("div",{className:"crew-checkin",children:[f.jsxs("div",{className:"crew-header",children:[f.jsx("h3",{children:" Today's Crew"}),f.jsx("span",{className:"crew-date",children:w})]}),r.length===0?f.jsxs("div",{className:"crew-empty",children:[f.jsx("p",{children:"No crew checked in yet"}),f.jsx("p",{className:"crew-empty-hint",children:"Add your crew for the day"})]}):f.jsx("div",{className:"crew-list",children:r.map((E,k)=>f.jsxs("div",{className:"crew-member",children:[f.jsxs("div",{className:"crew-member-info",children:[f.jsx("span",{className:"crew-member-name",children:E.name}),f.jsx("span",{className:`crew-member-role ${E.role.toLowerCase()}`,children:E.role})]}),f.jsx("button",{className:"crew-remove-btn",onClick:()=>b(E.name),disabled:c,children:""})]},k))}),h?f.jsxs("div",{className:"crew-add-form",children:[f.jsx("input",{type:"text",value:p.name,onChange:E=>v({...p,name:E.target.value}),placeholder:"Name",autoFocus:!0}),f.jsxs("select",{value:p.role,onChange:E=>v({...p,role:E.target.value}),children:[f.jsx("option",{value:"Foreman",children:"Foreman"}),f.jsx("option",{value:"Laborer",children:"Laborer"}),f.jsx("option",{value:"Supervisor",children:"Supervisor"}),f.jsx("option",{value:"Operator",children:"Operator"})]}),f.jsxs("div",{className:"crew-add-buttons",children:[f.jsx("button",{className:"crew-add-confirm",onClick:y,disabled:c,children:c?"...":"Add"}),f.jsx("button",{className:"crew-add-cancel",onClick:()=>{m(!1),v({name:"",role:"Laborer"})},children:"Cancel"})]})]}):f.jsx("button",{className:"crew-add-btn",onClick:()=>m(!0),children:"+ Add Crew Member"}),f.jsxs("div",{className:"crew-count",children:[r.length," ",r.length===1?"person":"people"," on site"]})]})}function KF({project:e,onShowToast:t,onClose:r}){const[a,s]=J.useState(!0),[l,c]=J.useState(!1),[u,h]=J.useState(null),[m,p]=J.useState(""),[v,_]=J.useState("");J.useEffect(()=>{y()},[e.id]);const y=async()=>{try{const k=await Ge.getDailyReport(e.id);if(k)h(k),p(k.field_notes||""),_(k.issues||"");else{const A=await Ge.compileDailyReport(e.id);h({...A,status:"draft"})}}catch(k){console.error("Error loading report:",k),t("Error loading report","error")}finally{s(!1)}},b=async()=>{c(!0);try{await Ge.saveDailyReport(e.id,{field_notes:m,issues:v}),await Ge.submitDailyReport(e.id,"Field"),t("Daily report submitted!","success"),r()}catch(k){console.error("Error submitting report:",k),t("Error submitting report","error")}finally{c(!1)}},w=new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"});if(a)return f.jsxs("div",{className:"daily-report",children:[f.jsxs("div",{className:"daily-report-header",children:[f.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),f.jsx("h2",{children:"Daily Report"})]}),f.jsx("div",{className:"daily-report-loading",children:"Compiling report..."})]});const E=u?.status==="submitted";return f.jsxs("div",{className:"daily-report",children:[f.jsxs("div",{className:"daily-report-header",children:[f.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),f.jsxs("div",{children:[f.jsx("h2",{children:"Daily Report"}),f.jsx("p",{className:"daily-report-date",children:w})]})]}),E&&f.jsxs("div",{className:"daily-report-submitted-banner",children:[" Submitted ",new Date(u.submitted_at).toLocaleTimeString()]}),f.jsxs("div",{className:"daily-report-content",children:[f.jsxs("div",{className:"daily-report-summary",children:[f.jsxs("div",{className:"daily-report-card",children:[f.jsx("div",{className:"daily-report-card-value",children:u.crew_count||0}),f.jsx("div",{className:"daily-report-card-label",children:"Crew on Site"})]}),f.jsxs("div",{className:"daily-report-card",children:[f.jsx("div",{className:"daily-report-card-value",children:u.tasks_completed||0}),f.jsx("div",{className:"daily-report-card-label",children:"Tasks Done"})]}),f.jsxs("div",{className:"daily-report-card",children:[f.jsx("div",{className:"daily-report-card-value",children:u.tm_tickets_count||0}),f.jsx("div",{className:"daily-report-card-label",children:"T&M Tickets"})]}),f.jsxs("div",{className:"daily-report-card",children:[f.jsx("div",{className:"daily-report-card-value",children:u.photos_count||0}),f.jsx("div",{className:"daily-report-card-label",children:"Photos"})]})]}),u.crew_list?.length>0&&f.jsxs("div",{className:"daily-report-section",children:[f.jsx("h3",{children:" Crew"}),f.jsx("div",{className:"daily-report-crew",children:u.crew_list.map((k,A)=>f.jsxs("div",{className:"daily-report-crew-item",children:[f.jsx("span",{children:k.name}),f.jsx("span",{className:"daily-report-crew-role",children:k.role})]},A))})]}),u.completed_tasks?.length>0&&f.jsxs("div",{className:"daily-report-section",children:[f.jsx("h3",{children:" Completed Today"}),f.jsx("ul",{className:"daily-report-tasks",children:u.completed_tasks.map((k,A)=>f.jsxs("li",{children:[k.name,k.group&&f.jsx("span",{className:"daily-report-task-group",children:k.group})]},A))})]}),f.jsxs("div",{className:"daily-report-section",children:[f.jsx("h3",{children:" Notes"}),f.jsx("textarea",{value:m,onChange:k=>p(k.target.value),placeholder:"Any notes about today's work...",rows:3,disabled:E})]}),f.jsxs("div",{className:"daily-report-section",children:[f.jsx("h3",{children:" Issues / Concerns"}),f.jsx("textarea",{value:v,onChange:k=>_(k.target.value),placeholder:"Any problems, delays, or concerns...",rows:3,disabled:E})]})]}),!E&&f.jsxs("div",{className:"daily-report-footer",children:[f.jsx("button",{className:"btn btn-primary daily-report-submit",onClick:b,disabled:l,children:l?"Submitting...":" Submit Report"}),f.jsx("p",{className:"daily-report-hint",children:"This will be sent to the office"})]})]})}function $2({project:e,viewerType:t,viewerName:r,onShowToast:a,onClose:s}){const[l,c]=J.useState([]),[u,h]=J.useState(!0),[m,p]=J.useState(!1),[v,_]=J.useState(""),y=J.useRef(null);J.useEffect(()=>{b(),Ge.markMessagesRead(e.id,t)},[e.id]),J.useEffect(()=>{y.current?.scrollIntoView({behavior:"smooth"})},[l]);const b=async()=>{try{const A=await Ge.getMessages(e.id);c(A.reverse())}catch(A){console.error("Error loading messages:",A)}finally{h(!1)}},w=async()=>{if(v.trim()){p(!0);try{const A=await Ge.sendMessage(e.id,v.trim(),t,r);c([...l,A]),_("")}catch(A){console.error("Error sending message:",A),a("Error sending message","error")}finally{p(!1)}}},E=A=>{A.key==="Enter"&&!A.shiftKey&&(A.preventDefault(),w())},k=A=>{const S=new Date(A),j=new Date;return S.toDateString()===j.toDateString()?S.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):S.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})};return f.jsxs("div",{className:"messages-container",children:[f.jsxs("div",{className:"messages-header",children:[f.jsx("button",{className:"back-btn-simple",onClick:s,children:""}),f.jsxs("div",{children:[f.jsx("h2",{children:"Messages"}),f.jsx("p",{className:"messages-project",children:e.name})]})]}),f.jsxs("div",{className:"messages-list",children:[u?f.jsx("div",{className:"messages-loading",children:"Loading..."}):l.length===0?f.jsxs("div",{className:"messages-empty",children:[f.jsx("p",{children:"No messages yet"}),f.jsx("p",{className:"messages-empty-hint",children:t==="field"?"Messages from the office will appear here":"Send a message to the field crew"})]}):l.map(A=>f.jsx("div",{className:`message ${A.sender_type===t?"sent":"received"}`,children:f.jsxs("div",{className:"message-bubble",children:[f.jsxs("div",{className:"message-sender",children:[A.sender_type==="office"?"":""," ",A.sender_name]}),f.jsx("div",{className:"message-text",children:A.message}),A.photo_url&&f.jsx("img",{src:A.photo_url,alt:"Attached",className:"message-photo"}),f.jsx("div",{className:"message-time",children:k(A.created_at)})]})},A.id)),f.jsx("div",{ref:y})]}),f.jsxs("div",{className:"messages-input-container",children:[f.jsx("textarea",{value:v,onChange:A=>_(A.target.value),onKeyDown:E,placeholder:"Type a message...",rows:1,disabled:m}),f.jsx("button",{className:"messages-send-btn",onClick:w,disabled:m||!v.trim(),children:m?"...":""})]})]})}function YF({project:e,requestedBy:t,onShowToast:r,onClose:a}){const[s,l]=J.useState([{name:"",quantity:"",unit:"each"}]),[c,u]=J.useState(""),[h,m]=J.useState("normal"),[p,v]=J.useState(""),[_,y]=J.useState(!1),b=()=>{l([...s,{name:"",quantity:"",unit:"each"}])},w=(A,S,j)=>{l(s.map((F,R)=>R===A?{...F,[S]:j}:F))},E=A=>{s.length>1&&l(s.filter((S,j)=>j!==A))},k=async()=>{const A=s.filter(S=>S.name.trim()&&S.quantity);if(A.length===0){r("Add at least one item","error");return}y(!0);try{await Ge.createMaterialRequest(e.id,A,t,c||null,h,p||null),r("Request submitted!","success"),a()}catch(S){console.error("Error submitting request:",S),r("Error submitting request","error")}finally{y(!1)}};return f.jsxs("div",{className:"material-request",children:[f.jsxs("div",{className:"material-request-header",children:[f.jsx("button",{className:"back-btn-simple",onClick:a,children:""}),f.jsx("h2",{children:"Request Materials"})]}),f.jsxs("div",{className:"material-request-content",children:[f.jsxs("div",{className:"material-request-section",children:[f.jsx("label",{children:"What do you need?"}),s.map((A,S)=>f.jsxs("div",{className:"material-request-item",children:[f.jsx("input",{type:"text",placeholder:"Item name",value:A.name,onChange:j=>w(S,"name",j.target.value),className:"material-request-name"}),f.jsx("input",{type:"number",placeholder:"Qty",value:A.quantity,onChange:j=>w(S,"quantity",j.target.value),className:"material-request-qty"}),f.jsxs("select",{value:A.unit,onChange:j=>w(S,"unit",j.target.value),className:"material-request-unit",children:[f.jsx("option",{value:"each",children:"each"}),f.jsx("option",{value:"rolls",children:"rolls"}),f.jsx("option",{value:"boxes",children:"boxes"}),f.jsx("option",{value:"bags",children:"bags"}),f.jsx("option",{value:"sheets",children:"sheets"}),f.jsx("option",{value:"gallons",children:"gal"}),f.jsx("option",{value:"feet",children:"ft"}),f.jsx("option",{value:"lbs",children:"lbs"})]}),f.jsx("button",{className:"material-request-remove",onClick:()=>E(S),children:""})]},S)),f.jsx("button",{className:"material-request-add",onClick:b,children:"+ Add Another Item"})]}),f.jsxs("div",{className:"material-request-section",children:[f.jsx("label",{children:"Priority"}),f.jsx("div",{className:"material-request-priority",children:["low","normal","urgent"].map(A=>f.jsxs("button",{className:`priority-btn ${h===A?"active":""} ${A}`,onClick:()=>m(A),children:[A==="urgent"&&" ",A==="normal"&&" ",A==="low"&&" ",A.charAt(0).toUpperCase()+A.slice(1)]},A))})]}),f.jsxs("div",{className:"material-request-section",children:[f.jsx("label",{children:"Needed By (optional)"}),f.jsx("input",{type:"date",value:c,onChange:A=>u(A.target.value),min:new Date().toISOString().split("T")[0]})]}),f.jsxs("div",{className:"material-request-section",children:[f.jsx("label",{children:"Notes (optional)"}),f.jsx("textarea",{value:p,onChange:A=>v(A.target.value),placeholder:"Any additional details...",rows:2})]})]}),f.jsx("div",{className:"material-request-footer",children:f.jsx("button",{className:"btn btn-primary",onClick:k,disabled:_,children:_?"Submitting...":" Submit Request"})})]})}function JF({project:e,companyId:t,onShowToast:r,onExit:a}){const[s,l]=J.useState([]),[c,u]=J.useState(!0),[h,m]=J.useState(null),[p,v]=J.useState({}),[_,y]=J.useState(!1),[b,w]=J.useState(!1),[E,k]=J.useState(!0),[A,S]=J.useState(!1),[j,F]=J.useState(!1),[R,N]=J.useState(!1),[X,G]=J.useState(0);J.useEffect(()=>{se(),te()},[e.id]);const se=async()=>{try{const Ee=await Ge.getAreas(e.id);l(Ee);const K=[...new Set(Ee.map(q=>q.group_name||"General"))],Te={};K.forEach(q=>Te[q]=!1),v(Te)}catch(Ee){console.error("Error loading areas:",Ee),r("Error loading areas","error")}finally{u(!1)}},te=async()=>{const Ee=await Ge.getUnreadCount(e.id,"field");G(Ee)},z=async(Ee,K)=>{const Te=s.find(C=>C.id===Ee);if(!Te)return;const q=Te.status===K?"not_started":K;m(Ee);try{await Ge.updateAreaStatus(Ee,q),l(C=>C.map(H=>H.id===Ee?{...H,status:q}:H)),r("Updated","success")}catch(C){console.error("Error updating status:",C),r("Error updating","error")}finally{m(null)}},ge=Ee=>{v(K=>({...K,[Ee]:!K[Ee]}))};if(c)return f.jsx("div",{className:"foreman-container",children:f.jsxs("div",{className:"loading",children:[f.jsx("div",{className:"spinner"}),"Loading..."]})});if(_)return f.jsx("div",{className:"foreman-container",children:f.jsx($k,{project:e,companyId:t,onSubmit:()=>y(!1),onCancel:()=>y(!1),onShowToast:r})});if(A)return f.jsx(KF,{project:e,onShowToast:r,onClose:()=>S(!1)});if(j)return f.jsx($2,{project:e,viewerType:"field",viewerName:"Field",onShowToast:r,onClose:()=>{F(!1),te()}});if(R)return f.jsx(YF,{project:e,requestedBy:"Field",onShowToast:r,onClose:()=>N(!1)});if(b)return f.jsxs("div",{className:"foreman-container",children:[f.jsxs("div",{className:"foreman-header",children:[f.jsx("button",{className:"back-btn",onClick:()=>w(!1),children:" Back"}),f.jsx("h2",{children:"T&M Tickets"})]}),f.jsx(G2,{project:e,onShowToast:r})]});const Oe=My(s),Ce=s.reduce((Ee,K)=>{const Te=K.group_name||"General";return Ee[Te]||(Ee[Te]=[]),Ee[Te].push(K),Ee},{}),Q=Object.keys(Ce).length>1||Object.keys(Ce).length===1&&!Ce.General,le=Ee=>`${Ee.filter(Te=>Te.status==="done").length}/${Ee.length}`;return f.jsxs("div",{className:"foreman-container",children:[f.jsxs("div",{className:"foreman-header",children:[f.jsx("button",{className:"back-btn-simple",onClick:a,children:""}),f.jsxs("div",{className:"foreman-header-info",children:[f.jsx("div",{className:"foreman-project-name",children:e.name}),f.jsxs("div",{className:"foreman-progress",children:[Oe,"% Complete"]})]})]}),f.jsxs("div",{className:"field-actions",children:[f.jsxs("button",{className:"field-action-btn",onClick:()=>y(!0),children:[f.jsx("span",{className:"icon",children:""}),"T&M Ticket"]}),f.jsxs("button",{className:"field-action-btn",onClick:()=>w(!0),children:[f.jsx("span",{className:"icon",children:""}),"View T&M"]}),f.jsxs("button",{className:"field-action-btn",onClick:()=>F(!0),children:[f.jsx("span",{className:"icon",children:""}),"Messages",X>0&&f.jsx("span",{className:"badge",children:X})]}),f.jsxs("button",{className:"field-action-btn",onClick:()=>N(!0),children:[f.jsx("span",{className:"icon",children:""}),"Need Materials"]}),f.jsxs("button",{className:"field-action-btn",onClick:()=>S(!0),children:[f.jsx("span",{className:"icon",children:""}),"Daily Report"]})]}),f.jsx(XF,{project:e,onShowToast:r}),f.jsx("div",{className:"foreman-areas",children:Q?Object.entries(Ce).map(([Ee,K])=>f.jsxs("div",{className:"foreman-group",children:[f.jsxs("div",{className:"foreman-group-header",onClick:()=>ge(Ee),children:[f.jsxs("div",{className:"foreman-group-title",children:[f.jsx("span",{className:"foreman-group-arrow",children:p[Ee]?"":""}),f.jsx("span",{className:"foreman-group-name",children:Ee})]}),f.jsx("span",{className:"foreman-group-progress",children:le(K)})]}),p[Ee]&&f.jsx("div",{className:"foreman-group-tasks",children:K.map(Te=>f.jsxs("div",{className:`foreman-area-card ${Te.status}`,children:[f.jsx("div",{className:"foreman-area-name",children:Te.name}),f.jsxs("div",{className:"foreman-area-buttons",children:[f.jsx("button",{className:`foreman-btn working ${Te.status==="working"?"active":""}`,onClick:()=>z(Te.id,"working"),disabled:h===Te.id,children:h===Te.id?"...":"Working"}),f.jsx("button",{className:`foreman-btn done ${Te.status==="done"?"active":""}`,onClick:()=>z(Te.id,"done"),disabled:h===Te.id,children:h===Te.id?"...":"Done"})]})]},Te.id))})]},Ee)):s.map(Ee=>f.jsxs("div",{className:`foreman-area-card ${Ee.status}`,children:[f.jsx("div",{className:"foreman-area-name",children:Ee.name}),f.jsxs("div",{className:"foreman-area-buttons",children:[f.jsx("button",{className:`foreman-btn working ${Ee.status==="working"?"active":""}`,onClick:()=>z(Ee.id,"working"),disabled:h===Ee.id,children:h===Ee.id?"...":"Working"}),f.jsx("button",{className:`foreman-btn done ${Ee.status==="done"?"active":""}`,onClick:()=>z(Ee.id,"done"),disabled:h===Ee.id,children:h===Ee.id?"...":"Done"})]})]},Ee.id))}),s.length===0&&f.jsxs("div",{className:"foreman-empty",children:[f.jsx("div",{className:"foreman-empty-icon",children:""}),f.jsx("div",{className:"foreman-empty-text",children:"No areas yet"}),f.jsx("div",{className:"foreman-empty-subtext",children:"Office needs to add areas to this project"})]})]})}const QF=J.createContext({}),W2=()=>J.useContext(QF);function gi({message:e,type:t="",onClose:r}){return J.useEffect(()=>{const a=setTimeout(r,3e3);return()=>clearTimeout(a)},[r]),f.jsx("div",{className:"toast-container",children:f.jsx("div",{className:`toast ${t}`,children:e})})}function ZF({project:e,onClose:t,onShareCreated:r}){const{user:a}=W2(),[s,l]=J.useState(!1),[c,u]=J.useState(null),[h,m]=J.useState([]),[p,v]=J.useState(!1),[_,y]=J.useState({progress:!0,photos:!0,daily_reports:!0,tm_tickets:!1,crew_info:!1}),[b,w]=J.useState("never"),[E,k]=J.useState("");J.useEffect(()=>{A()},[e.id]);const A=async()=>{try{const z=await Ge.getProjectShares(e.id);m(z)}catch(z){console.error("Error loading shares:",z)}},S=z=>{y(ge=>({...ge,[z]:!ge[z]}))},j=()=>{if(b==="never")return null;const z=new Date;if(b==="30days")z.setDate(z.getDate()+30);else if(b==="90days")z.setDate(z.getDate()+90);else if(b==="custom"&&E)return new Date(E).toISOString();return z.toISOString()},F=async()=>{l(!0);try{const z=j(),ge=await Ge.createProjectShare(e.id,a.id,_,z);u({type:"success",message:"Share link created!"}),v(!1),A(),r&&r(ge)}catch(z){console.error("Error creating share:",z),u({type:"error",message:"Failed to create share link"})}finally{l(!1)}},R=z=>{const ge=`${window.location.origin}/view/${z}`;navigator.clipboard.writeText(ge),u({type:"success",message:"Link copied to clipboard!"})},N=async z=>{if(confirm("Are you sure you want to revoke this share link?"))try{await Ge.revokeProjectShare(z),u({type:"success",message:"Share link revoked"}),A()}catch(ge){console.error("Error revoking share:",ge),u({type:"error",message:"Failed to revoke share link"})}},X=async z=>{if(confirm("Are you sure you want to permanently delete this share link?"))try{await Ge.deleteProjectShare(z),u({type:"success",message:"Share link deleted"}),A()}catch(ge){console.error("Error deleting share:",ge),u({type:"error",message:"Failed to delete share link"})}},G=z=>z?new Date(z).toLocaleDateString():"Never",se=z=>z?new Date(z)<new Date:!1,te=z=>{const ge=[];return z.progress&&ge.push("Progress"),z.photos&&ge.push("Photos"),z.daily_reports&&ge.push("Reports"),z.tm_tickets&&ge.push("T&M"),z.crew_info&&ge.push("Crew"),ge.join(", ")};return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"modal-overlay",onClick:t,children:f.jsxs("div",{className:"modal-content share-modal",onClick:z=>z.stopPropagation(),children:[f.jsxs("div",{className:"modal-header",children:[f.jsxs("h2",{children:["Share Project: ",e.name]}),f.jsx("button",{className:"close-btn",onClick:t,children:""})]}),f.jsxs("div",{className:"modal-body",children:[h.length>0&&f.jsxs("div",{className:"existing-shares",children:[f.jsx("h3",{children:"Active Share Links"}),f.jsx("div",{className:"shares-list",children:h.map(z=>f.jsxs("div",{className:`share-item ${!z.is_active||se(z.expires_at)?"inactive":""}`,children:[f.jsxs("div",{className:"share-info",children:[f.jsxs("div",{className:"share-token",children:[f.jsxs("code",{children:[window.location.origin,"/view/",z.share_token]}),f.jsx("button",{className:"btn-small",onClick:()=>R(z.share_token),disabled:!z.is_active||se(z.expires_at),children:"Copy"})]}),f.jsxs("div",{className:"share-meta",children:[f.jsx("span",{className:"permissions",children:te(z.permissions)}),f.jsxs("span",{className:"expiry",children:["Expires: ",G(z.expires_at)]}),f.jsxs("span",{className:"views",children:["Views: ",z.view_count||0,z.last_viewed_at&&` (Last: ${G(z.last_viewed_at)})`]})]}),!z.is_active&&f.jsx("div",{className:"status-badge revoked",children:"Revoked"}),se(z.expires_at)&&z.is_active&&f.jsx("div",{className:"status-badge expired",children:"Expired"})]}),f.jsxs("div",{className:"share-actions",children:[z.is_active&&!se(z.expires_at)&&f.jsx("button",{className:"btn-secondary",onClick:()=>N(z.id),children:"Revoke"}),f.jsx("button",{className:"btn-danger",onClick:()=>X(z.id),children:"Delete"})]})]},z.id))})]}),!p&&f.jsx("button",{className:"btn-primary",onClick:()=>v(!0),children:"+ Create New Share Link"}),p&&f.jsxs("div",{className:"new-share-form",children:[f.jsx("h3",{children:"Create New Share Link"}),f.jsxs("div",{className:"form-section",children:[f.jsx("label",{children:"Permissions"}),f.jsxs("div",{className:"checkbox-group",children:[f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:_.progress,onChange:()=>S("progress")}),"Progress/completion status"]}),f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:_.photos,onChange:()=>S("photos")}),"Photos feed"]}),f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:_.daily_reports,onChange:()=>S("daily_reports")}),"Daily reports"]}),f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:_.tm_tickets,onChange:()=>S("tm_tickets")}),"T&M tickets"]}),f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:_.crew_info,onChange:()=>S("crew_info")}),"Crew information"]})]})]}),f.jsxs("div",{className:"form-section",children:[f.jsx("label",{children:"Link Expiration"}),f.jsxs("div",{className:"radio-group",children:[f.jsxs("label",{children:[f.jsx("input",{type:"radio",value:"never",checked:b==="never",onChange:z=>w(z.target.value)}),"Never expires"]}),f.jsxs("label",{children:[f.jsx("input",{type:"radio",value:"30days",checked:b==="30days",onChange:z=>w(z.target.value)}),"30 days"]}),f.jsxs("label",{children:[f.jsx("input",{type:"radio",value:"90days",checked:b==="90days",onChange:z=>w(z.target.value)}),"90 days"]}),f.jsxs("label",{children:[f.jsx("input",{type:"radio",value:"custom",checked:b==="custom",onChange:z=>w(z.target.value)}),"Custom date"]})]}),b==="custom"&&f.jsx("input",{type:"date",value:E,onChange:z=>k(z.target.value),min:new Date().toISOString().split("T")[0],className:"date-input"})]}),f.jsxs("div",{className:"form-actions",children:[f.jsx("button",{className:"btn-secondary",onClick:()=>v(!1),children:"Cancel"}),f.jsx("button",{className:"btn-primary",onClick:F,disabled:s,children:s?"Generating...":"Generate Share Link"})]})]})]})]})}),c&&f.jsx(gi,{message:c.message,type:c.type,onClose:()=>u(null)}),f.jsx("style",{children:`
        .share-modal {
          max-width: 700px;
          max-height: 80vh;
          overflow-y: auto;
        }

        .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1.5rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .modal-header h2 {
          margin: 0;
          font-size: 1.25rem;
        }

        .close-btn {
          background: none;
          border: none;
          font-size: 2rem;
          cursor: pointer;
          color: #6b7280;
          padding: 0;
          width: 2rem;
          height: 2rem;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .close-btn:hover {
          color: #111827;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .existing-shares {
          margin-bottom: 2rem;
        }

        .existing-shares h3 {
          margin-top: 0;
          margin-bottom: 1rem;
          font-size: 1.1rem;
        }

        .shares-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .share-item {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1rem;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          gap: 1rem;
        }

        .share-item.inactive {
          opacity: 0.6;
          background-color: #f9fafb;
        }

        .share-info {
          flex: 1;
        }

        .share-token {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
        }

        .share-token code {
          background-color: #f3f4f6;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.875rem;
          flex: 1;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .share-meta {
          display: flex;
          flex-wrap: wrap;
          gap: 1rem;
          font-size: 0.875rem;
          color: #6b7280;
        }

        .status-badge {
          display: inline-block;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.75rem;
          font-weight: 500;
          margin-top: 0.5rem;
        }

        .status-badge.revoked {
          background-color: #fee2e2;
          color: #991b1b;
        }

        .status-badge.expired {
          background-color: #fef3c7;
          color: #92400e;
        }

        .share-actions {
          display: flex;
          gap: 0.5rem;
          flex-shrink: 0;
        }

        .new-share-form {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1.5rem;
          background-color: #f9fafb;
        }

        .new-share-form h3 {
          margin-top: 0;
          margin-bottom: 1.5rem;
          font-size: 1.1rem;
        }

        .form-section {
          margin-bottom: 1.5rem;
        }

        .form-section label {
          display: block;
          font-weight: 500;
          margin-bottom: 0.5rem;
        }

        .checkbox-group,
        .radio-group {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .checkbox-group label,
        .radio-group label {
          font-weight: normal;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .checkbox-group input[type="checkbox"],
        .radio-group input[type="radio"] {
          margin: 0;
        }

        .date-input {
          margin-top: 0.5rem;
          padding: 0.5rem;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          width: 100%;
        }

        .form-actions {
          display: flex;
          justify-content: flex-end;
          gap: 0.5rem;
          margin-top: 1.5rem;
        }

        .btn-small {
          padding: 0.25rem 0.75rem;
          font-size: 0.875rem;
          border: 1px solid #d1d5db;
          background-color: white;
          border-radius: 4px;
          cursor: pointer;
        }

        .btn-small:hover:not(:disabled) {
          background-color: #f3f4f6;
        }

        .btn-small:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-primary,
        .btn-secondary,
        .btn-danger {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          opacity: 0.9;
        }

        .btn-primary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-secondary {
          background-color: #f3f4f6;
          color: #374151;
        }

        .btn-secondary:hover {
          background-color: #e5e7eb;
        }

        .btn-danger {
          background-color: #ef4444;
          color: white;
        }

        .btn-danger:hover {
          background-color: #dc2626;
        }
      `})]})}function e5({project:e,companyId:t,onClose:r,onReportCreated:a}){const{user:s}=W2(),[l,c]=J.useState(!1),[u,h]=J.useState(null),[m,p]=J.useState(1),[v,_]=J.useState(new Date().toISOString().split("T")[0]),[y,b]=J.useState(new Date().toTimeString().split(" ")[0].substring(0,5)),[w,E]=J.useState(""),[k,A]=J.useState(""),[S,j]=J.useState("minor"),[F,R]=J.useState(""),[N,X]=J.useState(""),[G,se]=J.useState(""),[te,z]=J.useState(""),[ge,Oe]=J.useState(""),[Ce,Q]=J.useState(""),[le,Ee]=J.useState(""),[K,Te]=J.useState(s?.name||""),[q,C]=J.useState(""),[H,I]=J.useState(""),[L,Z]=J.useState(s?.email||""),[re,de]=J.useState([]),[ve,Se]=J.useState(""),[xe,U]=J.useState(""),[Ze,Ie]=J.useState(""),[_e,Le]=J.useState(""),[be,it]=J.useState(!1),[kt,ht]=J.useState(""),[Et,Dr]=J.useState(""),[Ft,At]=J.useState(!1),[jr,Fr]=J.useState(""),[ie,De]=J.useState(""),[Me,We]=J.useState(""),[ot,mt]=J.useState(""),[St,tr]=J.useState(!1),[ia,Mr]=J.useState(!1),[Di,Fi]=J.useState(0),[zs,Tn]=J.useState(0),es=()=>{if(!ve.trim()){h({type:"error",message:"Please enter witness name"});return}const Pe={name:ve,phone:xe,email:Ze,testimony:_e};de([...re,Pe]),Se(""),U(""),Ie(""),Le(""),h({type:"success",message:"Witness added"})},ts=Pe=>{de(re.filter((Za,An)=>An!==Pe))},ta=Pe=>{switch(Pe){case 1:if(!w.trim()||!k.trim())return h({type:"error",message:"Please fill in all incident details"}),!1;break;case 2:if(!N.trim()||!Ce.trim())return h({type:"error",message:"Please fill in employee name and job title"}),!1;break;case 3:if(!K.trim()||!q.trim())return h({type:"error",message:"Please fill in supervisor name and title"}),!1;break}return!0},rs=()=>{ta(m)&&p(m+1)},kn=()=>{p(m-1)},$l=async()=>{if(ta(m)){c(!0);try{const Pe={project_id:e.id,company_id:t,incident_date:v,incident_time:y,incident_location:w,incident_description:k,injury_type:S,body_part_affected:F||null,employee_name:N,employee_phone:G||null,employee_email:te||null,employee_address:ge||null,employee_job_title:Ce,employee_hire_date:le||null,medical_treatment_required:be,medical_facility_name:kt||null,medical_facility_address:Et||null,hospitalized:Ft,reported_by_name:K,reported_by_title:q,reported_by_phone:H||null,reported_by_email:L||null,witnesses:re,immediate_actions_taken:jr||null,corrective_actions_planned:ie||null,safety_equipment_used:Me||null,safety_equipment_failed:ot||null,osha_recordable:St,workers_comp_claim:ia,days_away_from_work:parseInt(Di)||0,restricted_work_days:parseInt(zs)||0,status:"reported",created_by:s?.id},Za=await Ge.createInjuryReport(Pe);h({type:"success",message:"Injury report submitted successfully"}),a&&a(Za),setTimeout(()=>{r()},1500)}catch(Pe){console.error("Error submitting injury report:",Pe),h({type:"error",message:"Failed to submit injury report"})}finally{c(!1)}}};return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"modal-overlay",onClick:r,children:f.jsxs("div",{className:"modal-content injury-report-modal",onClick:Pe=>Pe.stopPropagation(),children:[f.jsxs("div",{className:"modal-header",children:[f.jsx("h2",{children:"Workplace Injury/Incident Report"}),f.jsx("button",{className:"close-btn",onClick:r,children:""})]}),f.jsxs("div",{className:"progress-steps",children:[f.jsx("div",{className:`step ${m>=1?"active":""}`,children:"1. Incident"}),f.jsx("div",{className:`step ${m>=2?"active":""}`,children:"2. Employee"}),f.jsx("div",{className:`step ${m>=3?"active":""}`,children:"3. Supervisor"}),f.jsx("div",{className:`step ${m>=4?"active":""}`,children:"4. Witnesses"}),f.jsx("div",{className:`step ${m>=5?"active":""}`,children:"5. Medical & Safety"})]}),f.jsxs("div",{className:"modal-body",children:[m===1&&f.jsxs("div",{className:"form-step",children:[f.jsx("h3",{children:"Incident Details"}),f.jsxs("div",{className:"form-row",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Date of Incident *"}),f.jsx("input",{type:"date",value:v,onChange:Pe=>_(Pe.target.value),max:new Date().toISOString().split("T")[0]})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Time of Incident *"}),f.jsx("input",{type:"time",value:y,onChange:Pe=>b(Pe.target.value)})]})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Location on Site *"}),f.jsx("input",{type:"text",value:w,onChange:Pe=>E(Pe.target.value),placeholder:"e.g., Floor 2, near elevator shaft"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Incident Description *"}),f.jsx("textarea",{value:k,onChange:Pe=>A(Pe.target.value),rows:4,placeholder:"Describe what happened in detail..."})]}),f.jsxs("div",{className:"form-row",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Injury Type *"}),f.jsxs("select",{value:S,onChange:Pe=>j(Pe.target.value),children:[f.jsx("option",{value:"minor",children:"Minor Injury"}),f.jsx("option",{value:"serious",children:"Serious Injury"}),f.jsx("option",{value:"critical",children:"Critical Injury"}),f.jsx("option",{value:"near_miss",children:"Near Miss (No Injury)"})]})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Body Part Affected"}),f.jsx("input",{type:"text",value:F,onChange:Pe=>R(Pe.target.value),placeholder:"e.g., Left hand, lower back"})]})]})]}),m===2&&f.jsxs("div",{className:"form-step",children:[f.jsx("h3",{children:"Injured Employee Information"}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Full Name *"}),f.jsx("input",{type:"text",value:N,onChange:Pe=>X(Pe.target.value),placeholder:"First and last name"})]}),f.jsxs("div",{className:"form-row",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Phone Number"}),f.jsx("input",{type:"tel",value:G,onChange:Pe=>se(Pe.target.value),placeholder:"(555) 123-4567"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Email Address"}),f.jsx("input",{type:"email",value:te,onChange:Pe=>z(Pe.target.value),placeholder:"email@example.com"})]})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Home Address"}),f.jsx("input",{type:"text",value:ge,onChange:Pe=>Oe(Pe.target.value),placeholder:"Street address, city, state, zip"})]}),f.jsxs("div",{className:"form-row",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Job Title *"}),f.jsx("input",{type:"text",value:Ce,onChange:Pe=>Q(Pe.target.value),placeholder:"e.g., Carpenter, Electrician"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Hire Date"}),f.jsx("input",{type:"date",value:le,onChange:Pe=>Ee(Pe.target.value)})]})]})]}),m===3&&f.jsxs("div",{className:"form-step",children:[f.jsx("h3",{children:"Foreman/Supervisor Making Report"}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Your Name *"}),f.jsx("input",{type:"text",value:K,onChange:Pe=>Te(Pe.target.value),placeholder:"Full name"})]}),f.jsxs("div",{className:"form-row",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Your Title *"}),f.jsx("input",{type:"text",value:q,onChange:Pe=>C(Pe.target.value),placeholder:"e.g., Site Foreman, Project Manager"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Your Phone Number"}),f.jsx("input",{type:"tel",value:H,onChange:Pe=>I(Pe.target.value),placeholder:"(555) 123-4567"})]})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Your Email Address"}),f.jsx("input",{type:"email",value:L,onChange:Pe=>Z(Pe.target.value),placeholder:"email@example.com"})]})]}),m===4&&f.jsxs("div",{className:"form-step",children:[f.jsx("h3",{children:"Witness Testimonies (Optional)"}),re.length>0&&f.jsx("div",{className:"witnesses-list",children:re.map((Pe,Za)=>f.jsxs("div",{className:"witness-item",children:[f.jsxs("div",{className:"witness-info",children:[f.jsx("strong",{children:Pe.name}),Pe.phone&&f.jsxs("span",{children:["  ",Pe.phone]}),Pe.testimony&&f.jsxs("p",{className:"witness-testimony",children:['"',Pe.testimony,'"']})]}),f.jsx("button",{className:"btn-danger btn-small",onClick:()=>ts(Za),children:"Remove"})]},Za))}),f.jsxs("div",{className:"add-witness-form",children:[f.jsxs("div",{className:"form-row",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Witness Name"}),f.jsx("input",{type:"text",value:ve,onChange:Pe=>Se(Pe.target.value),placeholder:"Full name"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Phone Number"}),f.jsx("input",{type:"tel",value:xe,onChange:Pe=>U(Pe.target.value),placeholder:"(555) 123-4567"})]})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Email Address"}),f.jsx("input",{type:"email",value:Ze,onChange:Pe=>Ie(Pe.target.value),placeholder:"email@example.com"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Witness Testimony"}),f.jsx("textarea",{value:_e,onChange:Pe=>Le(Pe.target.value),rows:3,placeholder:"What did the witness see or hear?"})]}),f.jsx("button",{className:"btn-secondary",onClick:es,children:"+ Add Witness"})]})]}),m===5&&f.jsxs("div",{className:"form-step",children:[f.jsx("h3",{children:"Medical Treatment & Safety"}),f.jsx("div",{className:"form-group checkbox-group",children:f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:be,onChange:Pe=>it(Pe.target.checked)}),"Medical treatment required"]})}),be&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Medical Facility Name"}),f.jsx("input",{type:"text",value:kt,onChange:Pe=>ht(Pe.target.value),placeholder:"Hospital or clinic name"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Medical Facility Address"}),f.jsx("input",{type:"text",value:Et,onChange:Pe=>Dr(Pe.target.value),placeholder:"Street address"})]}),f.jsx("div",{className:"form-group checkbox-group",children:f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:Ft,onChange:Pe=>At(Pe.target.checked)}),"Employee was hospitalized"]})})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Immediate Actions Taken"}),f.jsx("textarea",{value:jr,onChange:Pe=>Fr(Pe.target.value),rows:2,placeholder:"What was done immediately after the incident?"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Corrective Actions Planned"}),f.jsx("textarea",{value:ie,onChange:Pe=>De(Pe.target.value),rows:2,placeholder:"What will be done to prevent this in the future?"})]}),f.jsxs("div",{className:"form-row",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Safety Equipment Used"}),f.jsx("input",{type:"text",value:Me,onChange:Pe=>We(Pe.target.value),placeholder:"e.g., Hard hat, gloves, harness"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Safety Equipment Failed"}),f.jsx("input",{type:"text",value:ot,onChange:Pe=>mt(Pe.target.value),placeholder:"Equipment that failed, if any"})]})]}),f.jsxs("div",{className:"form-row",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Days Away From Work"}),f.jsx("input",{type:"number",min:"0",value:Di,onChange:Pe=>Fi(Pe.target.value)})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Restricted Work Days"}),f.jsx("input",{type:"number",min:"0",value:zs,onChange:Pe=>Tn(Pe.target.value)})]})]}),f.jsx("div",{className:"form-group checkbox-group",children:f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:St,onChange:Pe=>tr(Pe.target.checked)}),"OSHA Recordable Incident"]})}),f.jsx("div",{className:"form-group checkbox-group",children:f.jsxs("label",{children:[f.jsx("input",{type:"checkbox",checked:ia,onChange:Pe=>Mr(Pe.target.checked)}),"Workers' Compensation Claim Filed"]})})]})]}),f.jsx("div",{className:"modal-footer",children:f.jsxs("div",{className:"form-actions",children:[m>1&&f.jsx("button",{className:"btn-secondary",onClick:kn,children:" Back"}),f.jsx("button",{className:"btn-secondary",onClick:r,children:"Cancel"}),m<5?f.jsx("button",{className:"btn-primary",onClick:rs,children:"Next "}):f.jsx("button",{className:"btn-primary",onClick:$l,disabled:l,children:l?"Submitting...":"Submit Report"})]})})]})}),u&&f.jsx(gi,{message:u.message,type:u.type,onClose:()=>h(null)}),f.jsx("style",{children:`
        .injury-report-modal {
          max-width: 800px;
          max-height: 90vh;
          overflow-y: auto;
        }

        .progress-steps {
          display: flex;
          justify-content: space-between;
          padding: 1rem 1.5rem;
          border-bottom: 1px solid #e5e7eb;
          background-color: #f9fafb;
          overflow-x: auto;
        }

        .progress-steps .step {
          font-size: 0.875rem;
          color: #9ca3af;
          font-weight: 500;
          white-space: nowrap;
          padding: 0.5rem;
        }

        .progress-steps .step.active {
          color: var(--primary-color, #3b82f6);
          font-weight: 600;
        }

        .form-step h3 {
          margin-top: 0;
          margin-bottom: 1.5rem;
          color: #111827;
          font-size: 1.25rem;
        }

        .form-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 500;
          color: #374151;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
          width: 100%;
          padding: 0.5rem;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          font-size: 1rem;
        }

        .form-group textarea {
          resize: vertical;
        }

        .checkbox-group label {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-weight: normal;
          cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
          width: auto;
          margin: 0;
        }

        .witnesses-list {
          margin-bottom: 1.5rem;
        }

        .witness-item {
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          padding: 1rem;
          margin-bottom: 0.5rem;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
        }

        .witness-info {
          flex: 1;
        }

        .witness-testimony {
          margin-top: 0.5rem;
          color: #6b7280;
          font-style: italic;
          font-size: 0.875rem;
        }

        .add-witness-form {
          border: 2px dashed #d1d5db;
          border-radius: 6px;
          padding: 1rem;
          background-color: #f9fafb;
        }

        .modal-footer {
          border-top: 1px solid #e5e7eb;
          padding: 1rem 1.5rem;
        }

        .form-actions {
          display: flex;
          justify-content: space-between;
          gap: 0.5rem;
        }

        .btn-primary,
        .btn-secondary,
        .btn-danger {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          opacity: 0.9;
        }

        .btn-primary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-secondary {
          background-color: #f3f4f6;
          color: #374151;
        }

        .btn-secondary:hover {
          background-color: #e5e7eb;
        }

        .btn-danger {
          background-color: #ef4444;
          color: white;
        }

        .btn-danger:hover {
          background-color: #dc2626;
        }

        .btn-small {
          padding: 0.25rem 0.75rem;
          font-size: 0.875rem;
        }

        @media (max-width: 768px) {
          .injury-report-modal {
            max-width: 100%;
            height: 100vh;
            max-height: 100vh;
            border-radius: 0;
          }

          .form-row {
            grid-template-columns: 1fr;
          }

          .progress-steps .step {
            font-size: 0.75rem;
            padding: 0.25rem;
          }
        }
      `})]})}function t5({project:e,companyId:t,onShowToast:r}){const[a,s]=J.useState([]),[l,c]=J.useState(null),[u,h]=J.useState(!1),[m,p]=J.useState(!0),[v,_]=J.useState(null);J.useEffect(()=>{y()},[e?.id]);const y=async()=>{p(!0);try{const R=e?await Ge.getInjuryReports(e.id):await Ge.getCompanyInjuryReports(t);s(R)}catch(R){console.error("Error loading injury reports:",R),_({type:"error",message:"Failed to load injury reports"})}finally{p(!1)}},b=()=>{y(),h(!1),_({type:"success",message:"Injury report created successfully"})},w=R=>{c(R)},E=()=>{c(null)},k=R=>R?new Date(R).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",A=R=>R?new Date(`2000-01-01T${R}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"",S=R=>({minor:"Minor Injury",serious:"Serious Injury",critical:"Critical Injury",near_miss:"Near Miss"})[R]||R,j=R=>({reported:"#fbbf24",under_investigation:"#3b82f6",closed:"#10b981"})[R]||"#9ca3af",F=R=>({minor:"#10b981",serious:"#f59e0b",critical:"#ef4444",near_miss:"#6b7280"})[R]||"#9ca3af";return m?f.jsxs("div",{className:"loading-container",children:[f.jsx("div",{className:"spinner"}),f.jsx("p",{children:"Loading injury reports..."})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"injury-reports-section",children:[f.jsxs("div",{className:"section-header",children:[f.jsx("h3",{children:"Injury & Incident Reports"}),f.jsx("button",{className:"btn-primary",onClick:()=>h(!0),children:"+ File Injury Report"})]}),a.length===0?f.jsxs("div",{className:"empty-state",children:[f.jsx("div",{className:"empty-state-icon",children:""}),f.jsx("h4",{children:"No Injury Reports"}),f.jsx("p",{children:'Click "File Injury Report" to document a workplace incident'})]}):f.jsx("div",{className:"reports-list",children:a.map(R=>f.jsxs("div",{className:"report-card",onClick:()=>w(R),children:[f.jsxs("div",{className:"report-header",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"report-date",children:[k(R.incident_date)," at ",A(R.incident_time)]}),f.jsx("div",{className:"employee-name",children:R.employee_name})]}),f.jsxs("div",{className:"report-badges",children:[f.jsx("span",{className:"badge",style:{backgroundColor:F(R.injury_type)},children:S(R.injury_type)}),f.jsx("span",{className:"badge",style:{backgroundColor:j(R.status)},children:R.status.replace("_"," ")})]})]}),f.jsxs("div",{className:"report-summary",children:[f.jsxs("div",{className:"summary-item",children:[f.jsx("strong",{children:"Location:"})," ",R.incident_location]}),f.jsxs("div",{className:"summary-item",children:[f.jsx("strong",{children:"Reported by:"})," ",R.reported_by_name," (",R.reported_by_title,")"]}),R.body_part_affected&&f.jsxs("div",{className:"summary-item",children:[f.jsx("strong",{children:"Body Part:"})," ",R.body_part_affected]}),R.osha_recordable&&f.jsx("div",{className:"summary-item",children:f.jsx("span",{className:"osha-badge",children:"OSHA Recordable"})})]}),f.jsxs("div",{className:"report-description",children:[R.incident_description.substring(0,150),R.incident_description.length>150&&"..."]}),f.jsx("div",{className:"report-footer",children:f.jsx("span",{children:"Click to view full details"})})]},R.id))}),l&&f.jsx("div",{className:"modal-overlay",onClick:E,children:f.jsxs("div",{className:"modal-content report-details-modal",onClick:R=>R.stopPropagation(),children:[f.jsxs("div",{className:"modal-header",children:[f.jsx("h2",{children:"Injury Report Details"}),f.jsx("button",{className:"close-btn",onClick:E,children:""})]}),f.jsxs("div",{className:"modal-body",children:[f.jsxs("section",{className:"details-section",children:[f.jsx("h3",{children:"Incident Information"}),f.jsxs("div",{className:"detail-grid",children:[f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Date & Time"}),f.jsxs("div",{children:[k(l.incident_date)," at ",A(l.incident_time)]})]}),f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Location"}),f.jsx("div",{children:l.incident_location})]}),f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Injury Type"}),f.jsx("div",{children:f.jsx("span",{className:"badge",style:{backgroundColor:F(l.injury_type)},children:S(l.injury_type)})})]}),l.body_part_affected&&f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Body Part Affected"}),f.jsx("div",{children:l.body_part_affected})]})]}),f.jsxs("div",{className:"detail-item full-width",children:[f.jsx("label",{children:"Description"}),f.jsx("div",{className:"description-box",children:l.incident_description})]})]}),f.jsxs("section",{className:"details-section",children:[f.jsx("h3",{children:"Injured Employee"}),f.jsxs("div",{className:"detail-grid",children:[f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Name"}),f.jsx("div",{children:l.employee_name})]}),f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Job Title"}),f.jsx("div",{children:l.employee_job_title})]}),l.employee_phone&&f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Phone"}),f.jsx("div",{children:l.employee_phone})]}),l.employee_email&&f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Email"}),f.jsx("div",{children:l.employee_email})]}),l.employee_address&&f.jsxs("div",{className:"detail-item full-width",children:[f.jsx("label",{children:"Address"}),f.jsx("div",{children:l.employee_address})]})]})]}),f.jsxs("section",{className:"details-section",children:[f.jsx("h3",{children:"Reported By"}),f.jsxs("div",{className:"detail-grid",children:[f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Name"}),f.jsx("div",{children:l.reported_by_name})]}),f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Title"}),f.jsx("div",{children:l.reported_by_title})]}),l.reported_by_phone&&f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Phone"}),f.jsx("div",{children:l.reported_by_phone})]}),l.reported_by_email&&f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Email"}),f.jsx("div",{children:l.reported_by_email})]})]})]}),l.witnesses&&l.witnesses.length>0&&f.jsxs("section",{className:"details-section",children:[f.jsx("h3",{children:"Witnesses"}),l.witnesses.map((R,N)=>f.jsxs("div",{className:"witness-card",children:[f.jsxs("div",{className:"witness-header",children:[f.jsx("strong",{children:R.name}),R.phone&&f.jsxs("span",{children:["  ",R.phone]}),R.email&&f.jsxs("span",{children:["  ",R.email]})]}),R.testimony&&f.jsx("div",{className:"witness-testimony",children:f.jsxs("em",{children:['"',R.testimony,'"']})})]},N))]}),l.medical_treatment_required&&f.jsxs("section",{className:"details-section",children:[f.jsx("h3",{children:"Medical Treatment"}),f.jsxs("div",{className:"detail-grid",children:[l.medical_facility_name&&f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Facility"}),f.jsx("div",{children:l.medical_facility_name})]}),l.medical_facility_address&&f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Address"}),f.jsx("div",{children:l.medical_facility_address})]}),f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Hospitalized"}),f.jsx("div",{children:l.hospitalized?"Yes":"No"})]})]})]}),f.jsxs("section",{className:"details-section",children:[f.jsx("h3",{children:"Actions & Safety"}),l.immediate_actions_taken&&f.jsxs("div",{className:"detail-item full-width",children:[f.jsx("label",{children:"Immediate Actions Taken"}),f.jsx("div",{className:"description-box",children:l.immediate_actions_taken})]}),l.corrective_actions_planned&&f.jsxs("div",{className:"detail-item full-width",children:[f.jsx("label",{children:"Corrective Actions Planned"}),f.jsx("div",{className:"description-box",children:l.corrective_actions_planned})]}),f.jsxs("div",{className:"detail-grid",children:[l.safety_equipment_used&&f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Safety Equipment Used"}),f.jsx("div",{children:l.safety_equipment_used})]}),l.safety_equipment_failed&&f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Safety Equipment Failed"}),f.jsx("div",{children:l.safety_equipment_failed})]})]})]}),f.jsxs("section",{className:"details-section",children:[f.jsx("h3",{children:"Regulatory & Work Impact"}),f.jsxs("div",{className:"detail-grid",children:[f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"OSHA Recordable"}),f.jsx("div",{children:l.osha_recordable?"Yes":"No"})]}),f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Workers' Comp Claim"}),f.jsx("div",{children:l.workers_comp_claim?"Yes":"No"})]}),f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Days Away From Work"}),f.jsx("div",{children:l.days_away_from_work||0})]}),f.jsxs("div",{className:"detail-item",children:[f.jsx("label",{children:"Restricted Work Days"}),f.jsx("div",{children:l.restricted_work_days||0})]})]})]}),f.jsxs("div",{className:"report-meta",children:["Filed on ",k(l.created_at)]})]})]})}),u&&f.jsx(e5,{project:e,companyId:t,onClose:()=>h(!1),onReportCreated:b}),v&&f.jsx(gi,{message:v.message,type:v.type,onClose:()=>_(null)})]}),f.jsx("style",{children:`
        .injury-reports-section {
          margin-top: 2rem;
        }

        .section-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
        }

        .section-header h3 {
          margin: 0;
          font-size: 1.25rem;
          color: #111827;
        }

        .reports-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .report-card {
          background: white;
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1.5rem;
          cursor: pointer;
          transition: all 0.2s;
        }

        .report-card:hover {
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          border-color: var(--primary-color, #3b82f6);
        }

        .report-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 1rem;
        }

        .report-date {
          font-size: 0.875rem;
          color: #6b7280;
          margin-bottom: 0.25rem;
        }

        .employee-name {
          font-size: 1.125rem;
          font-weight: 600;
          color: #111827;
        }

        .report-badges {
          display: flex;
          gap: 0.5rem;
          flex-wrap: wrap;
        }

        .badge {
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-size: 0.75rem;
          font-weight: 500;
          color: white;
          text-transform: capitalize;
        }

        .osha-badge {
          background-color: #dc2626;
          color: white;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.75rem;
          font-weight: 600;
        }

        .report-summary {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 0.75rem;
          margin-bottom: 1rem;
          padding: 1rem;
          background-color: #f9fafb;
          border-radius: 6px;
        }

        .summary-item {
          font-size: 0.875rem;
          color: #374151;
        }

        .summary-item strong {
          color: #111827;
        }

        .report-description {
          color: #6b7280;
          line-height: 1.6;
          margin-bottom: 1rem;
        }

        .report-footer {
          text-align: right;
          font-size: 0.875rem;
          color: var(--primary-color, #3b82f6);
        }

        .report-details-modal {
          max-width: 900px;
          max-height: 90vh;
          overflow-y: auto;
        }

        .details-section {
          margin-bottom: 2rem;
          padding-bottom: 2rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .details-section:last-child {
          border-bottom: none;
        }

        .details-section h3 {
          margin-top: 0;
          margin-bottom: 1rem;
          font-size: 1.125rem;
          color: #111827;
        }

        .detail-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 1rem;
        }

        .detail-item label {
          display: block;
          font-size: 0.875rem;
          font-weight: 600;
          color: #6b7280;
          margin-bottom: 0.25rem;
        }

        .detail-item div {
          color: #111827;
        }

        .detail-item.full-width {
          grid-column: 1 / -1;
        }

        .description-box {
          background-color: #f9fafb;
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          padding: 1rem;
          white-space: pre-wrap;
          line-height: 1.6;
        }

        .witness-card {
          background-color: #f9fafb;
          border-radius: 6px;
          padding: 1rem;
          margin-bottom: 0.5rem;
        }

        .witness-header {
          margin-bottom: 0.5rem;
          color: #111827;
        }

        .witness-testimony {
          color: #6b7280;
          font-size: 0.875rem;
          padding-left: 1rem;
          border-left: 3px solid #d1d5db;
        }

        .report-meta {
          text-align: center;
          font-size: 0.875rem;
          color: #6b7280;
          padding-top: 1rem;
          border-top: 1px solid #e5e7eb;
        }

        .empty-state {
          text-align: center;
          padding: 3rem 1rem;
        }

        .empty-state-icon {
          font-size: 3rem;
          margin-bottom: 1rem;
        }

        .empty-state h4 {
          margin: 0 0 0.5rem 0;
          color: #111827;
        }

        .empty-state p {
          margin: 0;
          color: #6b7280;
        }

        .btn-primary {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover {
          opacity: 0.9;
        }

        .loading-container {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 3rem;
        }

        .spinner {
          width: 40px;
          height: 40px;
          border: 4px solid #e5e7eb;
          border-top-color: var(--primary-color, #3b82f6);
          border-radius: 50%;
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .report-header {
            flex-direction: column;
            gap: 0.5rem;
          }

          .report-summary {
            grid-template-columns: 1fr;
          }

          .detail-grid {
            grid-template-columns: 1fr;
          }

          .report-details-modal {
            max-width: 100%;
            height: 100vh;
            max-height: 100vh;
            border-radius: 0;
          }
        }
      `})]})}function r5({company:e,onShowToast:t}){const[r,a]=J.useState("overview"),[s,l]=J.useState(null),[c,u]=J.useState([]),[h,m]=J.useState(!0),[p,v]=J.useState(!1),[_,y]=J.useState(null),[b,w]=J.useState(!1),[E,k]=J.useState(!1),[A,S]=J.useState(!1),[j,F]=J.useState(null),[R,N]=J.useState([]),[X,G]=J.useState(null),[se,te]=J.useState([]),[z,ge]=J.useState(!1);J.useEffect(()=>{Oe()},[e]),J.useEffect(()=>{s&&Q(s.id)},[s]);const Oe=async()=>{if(!e?.id){m(!1);return}try{m(!0);const[xe,U,Ze,Ie]=await Promise.all([Ge.getDashboardMetrics(e.id),Ge.getProjectSummaries(e.id),Ge.getNeedsAttention(e.id),Ge.getRecentActivity(e.id,15)]);F(xe),N(U),G(Ze),te(Ie)}catch(xe){console.error("Error loading dashboard:",xe),t("Error loading dashboard data","error")}finally{m(!1)}},Ce=async()=>{ge(!0),await Oe(),ge(!1),t("Dashboard refreshed","success")},Q=async xe=>{try{const U=await Ge.getAreas(xe);u(U)}catch(U){console.error("Error loading areas:",U)}},le=xe=>{l(xe),a("project")},Ee=()=>{l(null),u([]),v(!1),y(null),a("overview"),Oe()},K=()=>{y({name:s.name,contract_value:s.contract_value,pin:s.pin||"",areas:c.map(xe=>({id:xe.id,name:xe.name,weight:xe.weight,isNew:!1}))}),v(!0)},Te=()=>{v(!1),y(null)},q=(xe,U)=>{y(Ze=>({...Ze,[xe]:U}))},C=(xe,U,Ze)=>{y(Ie=>({...Ie,areas:Ie.areas.map((_e,Le)=>Le===xe?{..._e,[U]:Ze}:_e)}))},H=()=>{y(xe=>({...xe,areas:[...xe.areas,{id:null,name:"",weight:"",isNew:!0}]}))},I=xe=>{_.areas.length>1&&y(U=>({...U,areas:U.areas.filter((Ze,Ie)=>Ie!==xe)}))},L=async()=>{if(!_.name.trim()){t("Please enter a project name","error");return}const xe=parseFloat(_.contract_value);if(!xe||xe<=0){t("Please enter a valid contract value","error");return}if(_.pin&&_.pin.length!==4){t("PIN must be 4 digits","error");return}if(_.pin&&_.pin!==s.pin&&!await Ge.isPinAvailable(_.pin,s.id)){t("This PIN is already in use","error");return}const U=_.areas.filter(Ie=>Ie.name.trim()&&parseFloat(Ie.weight)>0);if(U.length===0){t("Please add at least one area","error");return}if(U.reduce((Ie,_e)=>Ie+parseFloat(_e.weight),0)!==100){t("Area weights must total 100%","error");return}w(!0);try{await Ge.updateProject(s.id,{name:_.name.trim(),contract_value:xe,pin:_.pin||null});const Ie=c.map(be=>be.id),_e=_.areas.filter(be=>be.id).map(be=>be.id);for(const be of Ie)_e.includes(be)||await Ge.deleteArea(be);for(let be=0;be<U.length;be++){const it=U[be];it.id?await Ge.updateArea(it.id,{name:it.name.trim(),weight:parseFloat(it.weight),sort_order:be}):await Ge.createArea({project_id:s.id,name:it.name.trim(),weight:parseFloat(it.weight),status:"not_started",sort_order:be})}const Le=await Ge.getProject(s.id);l(Le),await Q(s.id),v(!1),y(null),t("Project updated!","success")}catch(Ie){console.error("Error saving project:",Ie),t("Error saving changes","error")}finally{w(!1)}},Z=async()=>{if(confirm("Are you sure you want to delete this project? This cannot be undone."))try{await Ge.deleteProject(s.id),t("Project deleted","success"),Ee()}catch(xe){console.error("Error deleting project:",xe),t("Error deleting project","error")}},re=async()=>{if(confirm(`Pause "${s.name}"? The project will be marked as paused.`))try{await Ge.updateProjectStatus(s.id,"paused");const xe=await Ge.getProject(s.id);l(xe),t("Project paused","success"),Oe()}catch(xe){console.error("Error pausing project:",xe),t("Error pausing project","error")}},de=async()=>{try{await Ge.updateProjectStatus(s.id,"active");const xe=await Ge.getProject(s.id);l(xe),t("Project resumed","success"),Oe()}catch(xe){console.error("Error resuming project:",xe),t("Error resuming project","error")}},ve=async()=>{if(confirm(`Mark "${s.name}" as done? The project will be marked as completed.`))try{await Ge.updateProjectStatus(s.id,"done");const xe=await Ge.getProject(s.id);l(xe),t("Project marked as done","success"),Oe()}catch(xe){console.error("Error updating project:",xe),t("Error updating project","error")}},Se=xe=>{const U=new Date(xe),Ie=new Date-U,_e=Math.floor(Ie/6e4),Le=Math.floor(Ie/36e5),be=Math.floor(Ie/864e5);return _e<1?"Just now":_e<60?`${_e}m ago`:Le<24?`${Le}h ago`:be<7?`${be}d ago`:U.toLocaleDateString()};if(h)return f.jsxs("div",{className:"loading",children:[f.jsx("div",{className:"spinner"}),"Loading dashboard..."]});if(r==="project"&&s){const xe=My(c),U=xe/100*s.contract_value;if(p&&_){const Ze=_.areas.reduce((Ie,_e)=>Ie+(parseFloat(_e.weight)||0),0);return f.jsxs("div",{children:[f.jsx("button",{className:"btn btn-secondary btn-small",onClick:Te,style:{marginBottom:"1.5rem"},children:" Cancel"}),f.jsx("h1",{children:"Edit Project"}),f.jsx("p",{className:"subtitle",children:"Update project details"}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Project Name"}),f.jsx("input",{type:"text",value:_.name,onChange:Ie=>q("name",Ie.target.value)})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Contract Value ($)"}),f.jsx("input",{type:"number",value:_.contract_value,onChange:Ie=>q("contract_value",Ie.target.value)})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Foreman PIN (4 digits)"}),f.jsx("input",{type:"text",value:_.pin,onChange:Ie=>q("pin",Ie.target.value.replace(/\D/g,"").slice(0,4)),placeholder:"e.g., 2847",maxLength:4})]})]}),f.jsxs("div",{className:"card",children:[f.jsx("h3",{children:"Areas"}),f.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",marginBottom:"1rem"},children:"Weights must total 100%."}),_.areas.map((Ie,_e)=>f.jsxs("div",{className:"area-row",children:[f.jsx("input",{type:"text",placeholder:"Area name",value:Ie.name,onChange:Le=>C(_e,"name",Le.target.value)}),f.jsx("input",{type:"number",placeholder:"%",value:Ie.weight,onChange:Le=>C(_e,"weight",Le.target.value)}),f.jsx("button",{className:"remove-btn",onClick:()=>I(_e),children:""})]},_e)),f.jsxs("div",{className:"weight-total",children:[f.jsx("span",{className:"weight-total-label",children:"Total Weight:"}),f.jsxs("span",{className:`weight-total-value ${Ze===100?"valid":"invalid"}`,children:[Ze,"%"]})]}),f.jsx("button",{className:"btn btn-secondary",onClick:H,children:"+ Add Area"})]}),f.jsx("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem"},children:f.jsx("button",{className:"btn btn-primary",onClick:L,disabled:b,style:{flex:1},children:b?"Saving...":"Save Changes"})}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"1rem"},children:[s.status==="paused"?f.jsx("button",{className:"btn btn-success btn-small",onClick:de,style:{flex:1},children:" Resume"}):f.jsx("button",{className:"btn btn-warning btn-small",onClick:re,style:{flex:1},children:" Pause"}),s.status!=="done"&&f.jsx("button",{className:"btn btn-success btn-small",onClick:ve,style:{flex:1},children:" Mark Done"}),f.jsx("button",{className:"btn btn-danger btn-small",onClick:Z,style:{flex:1},children:" Delete"})]})]})}return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[f.jsx("button",{className:"btn btn-secondary btn-small",onClick:Ee,children:" Back to Dashboard"}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[f.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>S(!0),children:" Messages"}),f.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>k(!0),children:"Share with Client"}),f.jsx("button",{className:"btn btn-secondary btn-small",onClick:K,children:"Edit"})]})]}),f.jsx("h1",{children:s.name}),f.jsxs("p",{className:"subtitle",children:["Contract: ",_l(s.contract_value),s.pin&&f.jsxs("span",{style:{marginLeft:"1rem",color:"var(--text-muted)"},children:["PIN: ",s.pin]})]}),f.jsxs("div",{className:"dashboard-grid",children:[f.jsxs("div",{className:"dashboard-main",children:[f.jsxs("div",{className:"card billing-card",children:[f.jsx("h3",{children:"Billable to Date"}),f.jsx("div",{className:"billing-amount",children:_l(U)}),f.jsxs("div",{className:"billing-total",children:["of ",_l(s.contract_value)," contract value"]}),f.jsxs("div",{className:"progress-container",children:[f.jsxs("div",{className:"progress-header",children:[f.jsx("span",{className:"progress-label",children:"Overall Progress"}),f.jsxs("span",{className:"progress-value",children:[xe,"%"]})]}),f.jsx("div",{className:"progress-bar",children:f.jsx("div",{className:"progress-fill",style:{width:`${xe}%`}})})]})]}),f.jsxs("div",{className:"card",children:[f.jsx("h3",{children:"Areas"}),f.jsx("div",{className:"area-status-list",children:c.map(Ze=>f.jsxs("div",{className:"area-status-item",children:[f.jsxs("div",{children:[f.jsx("div",{className:"area-name",children:Ze.name}),f.jsxs("div",{className:"area-weight",children:[Ze.weight,"% of contract"]})]}),f.jsx("span",{className:`status-badge ${Ze.status}`,children:Gk(Ze.status)})]},Ze.id))})]}),f.jsx(G2,{project:s,onShowToast:t})]}),f.jsxs("div",{className:"dashboard-sidebar",children:[f.jsxs("div",{className:"card",children:[f.jsx("h3",{children:"Project Management"}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginTop:"1rem"},children:[s.status==="paused"?f.jsx("button",{className:"btn btn-success btn-small",onClick:de,children:" Resume Project"}):f.jsx("button",{className:"btn btn-warning btn-small",onClick:re,children:" Pause Project"}),s.status!=="done"&&f.jsx("button",{className:"btn btn-success btn-small",onClick:ve,children:" Mark as Done"}),f.jsx("button",{className:"btn btn-danger btn-small",onClick:Z,children:" Delete Project"})]})]}),f.jsx(t5,{project:s,companyId:e?.id||s?.company_id,onShowToast:t})]})]}),E&&f.jsx(ZF,{project:s,onClose:()=>k(!1),onShareCreated:Ze=>{t("Share link created successfully!","success")}}),A&&f.jsx($2,{project:s,viewerType:"office",viewerName:"Office",onShowToast:t,onClose:()=>S(!1)})]})}return j?f.jsxs("div",{className:"executive-dashboard",children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[f.jsxs("div",{children:[f.jsx("h1",{children:"Dashboard"}),f.jsx("p",{className:"subtitle",children:"Overview of all projects and activity"})]}),f.jsx("button",{className:"btn btn-secondary btn-small",onClick:Ce,disabled:z,children:z?"Refreshing...":" Refresh"})]}),f.jsxs("div",{className:"metrics-grid",children:[f.jsxs("div",{className:"metric-card",children:[f.jsx("div",{className:"metric-value",children:j.activeProjects}),f.jsx("div",{className:"metric-label",children:"Active Projects"})]}),f.jsxs("div",{className:"metric-card",children:[f.jsx("div",{className:"metric-value",children:j.crewToday}),f.jsx("div",{className:"metric-label",children:"Crew Today"})]}),f.jsxs("div",{className:"metric-card",children:[f.jsx("div",{className:"metric-value",children:j.pendingTMCount}),f.jsx("div",{className:"metric-label",children:"Pending T&M Tickets"})]}),f.jsxs("div",{className:"metric-card",children:[f.jsx("div",{className:"metric-value",children:_l(j.pendingTMValue)}),f.jsx("div",{className:"metric-label",children:"Pending T&M Value"})]}),f.jsxs("div",{className:"metric-card metric-urgent",children:[f.jsx("div",{className:"metric-value",children:j.urgentRequests}),f.jsx("div",{className:"metric-label",children:"Urgent Requests"})]})]}),f.jsxs("div",{className:"card",style:{marginTop:"2rem"},children:[f.jsx("h2",{style:{marginBottom:"1rem"},children:"Active Projects"}),R.length===0?f.jsx("div",{className:"empty-state-small",children:f.jsx("p",{children:"No active projects"})}):f.jsx("div",{className:"dashboard-projects-list",children:R.map(xe=>f.jsxs("div",{className:`dashboard-project-card status-${xe.statusColor}`,onClick:()=>le(xe),children:[f.jsxs("div",{className:"project-header",children:[f.jsxs("div",{children:[f.jsx("div",{className:"project-name",children:xe.name}),f.jsx("div",{className:"project-value",children:_l(xe.contract_value)})]}),f.jsx("div",{className:`status-indicator status-${xe.statusColor}`})]}),f.jsxs("div",{className:"project-stats",children:[f.jsxs("div",{className:"project-stat",children:[f.jsx("span",{className:"stat-label",children:"Progress"}),f.jsxs("span",{className:"stat-value",children:[xe.progress,"%"]})]}),f.jsxs("div",{className:"project-stat",children:[f.jsx("span",{className:"stat-label",children:"Crew Today"}),f.jsx("span",{className:"stat-value",children:xe.crewToday})]}),f.jsxs("div",{className:"project-stat",children:[f.jsx("span",{className:"stat-label",children:"Pending Items"}),f.jsx("span",{className:"stat-value",children:xe.pendingItems})]})]}),f.jsx("div",{className:"progress-bar",children:f.jsx("div",{className:"progress-fill",style:{width:`${xe.progress}%`}})})]},xe.id))})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginTop:"2rem"},children:[f.jsxs("div",{className:"card",children:[f.jsx("h2",{style:{marginBottom:"1rem"},children:"Needs Attention"}),X&&f.jsxs("div",{className:"attention-list",children:[X.pendingTM.length>0&&f.jsxs("div",{className:"attention-section",children:[f.jsxs("h3",{className:"attention-heading",children:["Pending T&M Approvals (",X.pendingTM.length,")"]}),X.pendingTM.slice(0,3).map(xe=>f.jsx("div",{className:"attention-item",children:f.jsxs("div",{children:[f.jsx("div",{className:"attention-item-title",children:xe.projects?.name}),f.jsxs("div",{className:"attention-item-subtitle",children:[new Date(xe.work_date).toLocaleDateString(),"  ",_l(xe.estimatedValue)]})]})},xe.id))]}),X.pendingMaterials.length>0&&f.jsxs("div",{className:"attention-section",children:[f.jsxs("h3",{className:"attention-heading",children:["Material Requests (",X.pendingMaterials.length,")"]}),X.pendingMaterials.slice(0,3).map(xe=>f.jsx("div",{className:"attention-item",children:f.jsxs("div",{children:[f.jsxs("div",{className:"attention-item-title",children:[xe.projects?.name,xe.priority==="urgent"&&f.jsx("span",{className:"urgent-badge",children:"URGENT"})]}),f.jsxs("div",{className:"attention-item-subtitle",children:[xe.items?.length||0," items"]})]})},xe.id))]}),X.missingReports.length>0&&f.jsxs("div",{className:"attention-section",children:[f.jsxs("h3",{className:"attention-heading",children:["Missing Daily Reports (",X.missingReports.length,")"]}),X.missingReports.slice(0,3).map(xe=>f.jsx("div",{className:"attention-item",children:f.jsx("div",{className:"attention-item-title",children:xe.name})},xe.id))]}),X.unreadMessages.length>0&&f.jsxs("div",{className:"attention-section",children:[f.jsxs("h3",{className:"attention-heading",children:["Unread Messages (",X.unreadMessages.length,")"]}),X.unreadMessages.slice(0,3).map(xe=>f.jsx("div",{className:"attention-item",children:f.jsxs("div",{children:[f.jsx("div",{className:"attention-item-title",children:xe.projects?.name}),f.jsxs("div",{className:"attention-item-subtitle",children:[xe.message?.substring(0,50),"..."]})]})},xe.id))]}),X.pendingTM.length===0&&X.pendingMaterials.length===0&&X.missingReports.length===0&&X.unreadMessages.length===0&&f.jsx("div",{className:"empty-state-small",children:f.jsx("p",{children:"All caught up! No items need attention."})})]})]}),f.jsxs("div",{className:"card",children:[f.jsx("h2",{style:{marginBottom:"1rem"},children:"Recent Activity"}),se.length===0?f.jsx("div",{className:"empty-state-small",children:f.jsx("p",{children:"No recent activity"})}):f.jsx("div",{className:"activity-feed",children:se.map((xe,U)=>f.jsxs("div",{className:"activity-item",children:[f.jsxs("div",{className:`activity-icon activity-${xe.type}`,children:[xe.type==="tm_submitted"&&"",xe.type==="report_submitted"&&"",xe.type==="material_request"&&"",xe.type==="task_completed"&&""]}),f.jsxs("div",{className:"activity-content",children:[f.jsx("div",{className:"activity-message",children:xe.message}),f.jsxs("div",{className:"activity-meta",children:[f.jsx("span",{className:"activity-project",children:xe.project}),xe.by&&f.jsxs("span",{className:"activity-by",children:["  ",xe.by]}),f.jsxs("span",{className:"activity-time",children:["  ",Se(xe.timestamp)]})]})]})]},U))})]})]})]}):f.jsxs("div",{className:"empty-state",children:[f.jsx("div",{className:"empty-state-icon",children:""}),f.jsx("h3",{children:"Loading Dashboard"}),f.jsx("p",{children:"Fetching your data..."})]})}function a5({company:e,onProjectCreated:t,onShowToast:r}){const[a,s]=J.useState(""),[l,c]=J.useState(""),[u,h]=J.useState(""),[m,p]=J.useState(""),[v,_]=J.useState(""),[y,b]=J.useState(""),[w,E]=J.useState([{name:"",weight:"",group:""},{name:"",weight:"",group:""},{name:"",weight:"",group:""}]),[k,A]=J.useState(!1),[S,j]=J.useState(!1),[F,R]=J.useState(!1),[N,X]=J.useState([]),G=J.useRef(null),se=w.reduce((L,Z)=>L+(parseFloat(Z.weight)||0),0),te=L=>{const Z=L.replace(/\D/g,"").slice(0,4);b(Z)},z=()=>{const L=Math.floor(1e3+Math.random()*9e3).toString();b(L)},ge=(L,Z,re)=>{E(de=>de.map((ve,Se)=>Se===L?{...ve,[Z]:re}:ve))},Oe=()=>{E(L=>[...L,{name:"",weight:"",group:""}])},Ce=L=>{w.length>1&&E(Z=>Z.filter((re,de)=>de!==L))},Q=()=>{s(""),c(""),h(""),p(""),_(""),b(""),E([{name:"",weight:"",group:""},{name:"",weight:"",group:""},{name:"",weight:"",group:""}]),R(!1),X([])},le=()=>{G.current?.click()},Ee=L=>new Promise((Z,re)=>{const de=new FileReader;de.onload=ve=>{try{const Se=new Uint8Array(ve.target.result),xe=tm(Se,{type:"array"}),U=xe.SheetNames[0],Ze=xe.Sheets[U],Ie=js.sheet_to_json(Ze,{header:1});console.log("Excel rows:",Ie);const _e=[];let Le="General";for(const kt of Ie){if(!kt||kt.length===0)continue;const ht=kt.map(De=>De==null?"":String(De).trim()).filter(De=>De.length>0);if(ht.length===0)continue;const Et=ht.join(" ");if(console.log("Row cells:",ht,"| Combined:",Et),/^Description\b/i.test(ht[0])||/^Quantity\b/i.test(ht[0]))continue;if(ht.length<=2&&!/^\d+$/.test(ht[0])&&!ht.some(De=>/^\d{2,}$/.test(De))&&/^(L\d|Level|Floor|\d+(?:st|nd|rd|th)|Plaza|Street|Basement|Roof|Penthouse|Site|Exterior|Misc|MEP|ABATEMENT|DEMOLITION|UNIVERSAL|SOFT|TRASH|DEMO)/i.test(ht[0])){Le=Et.replace(/\s*\(\d{1,3}(?:,\d{3})*\s*SF\)\s*$/i,"").trim(),console.log("Found group:",Le);continue}let Ft="",At=!1;const jr=/^(SF|LF|EA|LS|Days?|MD|Load)$/i,Fr=/^\d{1,3}(,\d{3})*$|^\d+$/,ie=[];for(let De=0;De<ht.length;De++){const Me=ht[De];if(!(De===0&&/^ID-\d+$/i.test(Me))&&!/^KN\s*\d+$/i.test(Me)){if(Fr.test(Me.replace(/,/g,""))){At=!0;continue}jr.test(Me)||Me.length>1&&ie.push(Me)}}Ft=ie.join(" ").trim(),Ft=Ft.replace(/\s+/g," ").trim(),!(Ft.length<3)&&(/^(Plan|Page|\$|Total|Base Bid|Payment|Condition|Exclusion)/i.test(Ft)||At&&Ft.length>=3&&(_e.push({name:Ft,group:Le,selected:!0}),console.log("Found task:",Ft,"in",Le)))}const be=new Set,it=_e.filter(kt=>{const ht=`${kt.group}:${kt.name}`;return be.has(ht)?!1:(be.add(ht),!0)});Z(it)}catch(Se){re(Se)}},de.onerror=()=>re(new Error("Failed to read file")),de.readAsArrayBuffer(L)}),K=async L=>{const Z=L.target.files?.[0];if(!Z)return;const re=Z.name.split(".").pop().toLowerCase();if(!["xlsx","xls","csv"].includes(re)){r("Please upload an Excel file (.xlsx, .xls, or .csv)","error");return}j(!0);try{const de=await Ee(Z);if(de.length===0){r("No tasks found. Check Excel format.","error"),j(!1);return}X(de),R(!0),r(`Found ${de.length} tasks`,"success")}catch(de){console.error("Excel import error:",de),r("Error reading Excel file","error")}finally{j(!1),G.current&&(G.current.value="")}},Te=L=>{X(Z=>Z.map((re,de)=>de===L?{...re,selected:!re.selected}:re))},q=()=>{const L=N.filter(de=>de.selected);if(L.length===0){r("Please select at least one task","error");return}const Z=Math.round(100/L.length*100)/100,re=L.map((de,ve)=>({name:de.name,weight:ve===L.length-1?(100-Z*(L.length-1)).toFixed(2):Z.toFixed(2),group:de.group}));E(re),R(!1),r("Tasks imported!","success")},C=async()=>{if(!a.trim()){r("Please enter a project name","error");return}const L=parseFloat(v);if(!L||L<=0){r("Please enter a valid contract value","error");return}if(y.length!==4){r("Please enter a 4-digit PIN","error");return}if(!await Ge.isPinAvailable(y)){r("This PIN is already in use. Try another.","error");return}const re=w.filter(de=>de.name.trim()&&parseFloat(de.weight)>0);if(re.length===0){r("Please add at least one area","error");return}if(Math.abs(se-100)>.1){r("Area weights must total 100%","error");return}A(!0);try{const de=await Ge.createProject({company_id:e.id,name:a.trim(),job_number:l.trim()||null,address:u.trim()||null,general_contractor:m.trim()||null,contract_value:L,pin:y});for(let ve=0;ve<re.length;ve++)await Ge.createArea({project_id:de.id,name:re[ve].name.trim(),weight:parseFloat(re[ve].weight),group_name:re[ve].group||null,status:"not_started",sort_order:ve});r("Project created!","success"),Q(),t()}catch(de){console.error("Error creating project:",de),r("Error creating project","error")}finally{A(!1)}};if(F){const L=[...new Set(N.map(re=>re.group))],Z=N.filter(re=>re.selected).length;return f.jsxs("div",{children:[f.jsx("h1",{children:"Review Imported Tasks"}),f.jsx("p",{className:"subtitle",children:"Select the tasks to include in your project"}),f.jsx("div",{className:"import-summary",children:f.jsxs("span",{children:[Z," of ",N.length," tasks selected"]})}),L.map(re=>{const de=N.filter(Se=>Se.group===re),ve=de.filter(Se=>Se.selected).length;return f.jsxs("div",{className:"card import-group",children:[f.jsxs("div",{className:"import-group-header",children:[f.jsx("h3",{children:re}),f.jsxs("span",{className:"import-group-count",children:[ve,"/",de.length]})]}),f.jsx("div",{className:"import-task-list",children:de.map(Se=>{const xe=N.indexOf(Se);return f.jsxs("label",{className:"import-task-item",children:[f.jsx("input",{type:"checkbox",checked:Se.selected,onChange:()=>Te(xe)}),f.jsx("span",{className:"import-task-name",children:Se.name})]},xe)})})]},re)}),f.jsxs("div",{className:"import-actions",children:[f.jsx("button",{className:"btn btn-secondary",onClick:()=>R(!1),children:"Cancel"}),f.jsxs("button",{className:"btn btn-primary",onClick:q,children:["Use Selected Tasks (",Z,")"]})]})]})}const H=w.reduce((L,Z,re)=>{const de=Z.group||"General";return L[de]||(L[de]=[]),L[de].push({...Z,originalIndex:re}),L},{}),I=Object.keys(H).length>1||Object.keys(H).length===1&&!H.General;return f.jsxs("div",{children:[f.jsx("h1",{children:"New Project"}),f.jsx("p",{className:"subtitle",children:"Set up a new project to track"}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Project Name"}),f.jsx("input",{type:"text",placeholder:"e.g., Sunrise Apartments",value:a,onChange:L=>s(L.target.value)})]}),f.jsxs("div",{className:"form-row-2",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Job Number"}),f.jsx("input",{type:"text",placeholder:"e.g., 4032",value:l,onChange:L=>c(L.target.value)})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Contract Value ($)"}),f.jsx("input",{type:"number",placeholder:"e.g., 365000",value:v,onChange:L=>_(L.target.value)})]})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Project Address"}),f.jsx("input",{type:"text",placeholder:"e.g., 123 Main St, Los Angeles, CA 90001",value:u,onChange:L=>h(L.target.value)})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"General Contractor"}),f.jsx("input",{type:"text",placeholder:"e.g., ABC Construction Inc.",value:m,onChange:L=>p(L.target.value)})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Foreman PIN (4 digits)"}),f.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Foremen will enter this PIN to access this project"}),f.jsxs("div",{className:"pin-input-row",children:[f.jsx("input",{type:"text",placeholder:"e.g., 2847",value:y,onChange:L=>te(L.target.value),maxLength:4,className:"pin-input"}),f.jsx("button",{type:"button",className:"btn btn-secondary",onClick:z,children:"Generate"})]})]})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"areas-header",children:[f.jsxs("div",{children:[f.jsx("h3",{children:"Areas / Tasks"}),f.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",marginTop:"0.25rem"},children:"Define the areas for this project. Weights must total 100%."})]}),f.jsxs("div",{className:"import-btn-container",children:[f.jsx("input",{ref:G,type:"file",accept:".xlsx,.xls,.csv",onChange:K,style:{display:"none"}}),f.jsx("button",{className:"btn btn-secondary btn-small",onClick:le,disabled:S,children:S?"Reading...":" Import Excel"})]})]}),I?Object.entries(H).map(([L,Z])=>f.jsxs("div",{className:"area-group",children:[f.jsx("div",{className:"area-group-header",children:L}),Z.map(re=>f.jsxs("div",{className:"area-row",children:[f.jsx("input",{type:"text",placeholder:"Task name",value:re.name,onChange:de=>ge(re.originalIndex,"name",de.target.value)}),f.jsx("input",{type:"number",placeholder:"%",min:"0",max:"100",value:re.weight,onChange:de=>ge(re.originalIndex,"weight",de.target.value)}),f.jsx("button",{className:"remove-btn",onClick:()=>Ce(re.originalIndex),children:""})]},re.originalIndex))]},L)):w.map((L,Z)=>f.jsxs("div",{className:"area-row",children:[f.jsx("input",{type:"text",placeholder:"Area name (e.g., Level 1)",value:L.name,onChange:re=>ge(Z,"name",re.target.value)}),f.jsx("input",{type:"number",placeholder:"%",min:"0",max:"100",value:L.weight,onChange:re=>ge(Z,"weight",re.target.value)}),f.jsx("button",{className:"remove-btn",onClick:()=>Ce(Z),children:""})]},Z)),f.jsxs("div",{className:"weight-total",children:[f.jsx("span",{className:"weight-total-label",children:"Total Weight:"}),f.jsxs("span",{className:`weight-total-value ${Math.abs(se-100)<.1?"valid":"invalid"}`,children:[se.toFixed(1),"%"]})]}),f.jsx("button",{className:"btn btn-secondary",onClick:Oe,children:"+ Add Area"})]}),f.jsx("button",{className:"btn btn-primary btn-full",onClick:C,disabled:k,children:k?"Creating...":"Create Project"})]})}function n5({company:e,onShowToast:t}){const{branding:r,updateBranding:a,uploadBrandingImage:s,loading:l}=dm(),[c,u]=J.useState(!1),[h,m]=J.useState(!1),[p,v]=J.useState(r),_=J.useRef(null),y=J.useRef(null),b=J.useRef(null),w=e?.subscription_tier||"free",E=["pro","business","enterprise"].includes(w),k=["business","enterprise"].includes(w),A=w==="enterprise",S=(N,X)=>{v(G=>({...G,[N]:X}))},j=async(N,X)=>{if(N){if(N.size>5*1024*1024){t?.("Image must be smaller than 5MB","error");return}if(!N.type.startsWith("image/")){t?.("Please upload an image file","error");return}try{const G=await s(N,X);G.success?(S(`${X}_url`,G.url),t?.(`${X.charAt(0).toUpperCase()+X.slice(1)} uploaded successfully`,"success")):t?.(G.error||"Failed to upload image","error")}catch(G){console.error("Upload error:",G),t?.("Failed to upload image","error")}}},F=async()=>{try{u(!0);const N=/^#[0-9A-F]{6}$/i;if(!N.test(p.primary_color)){t?.("Primary color must be a valid hex color (e.g., #3B82F6)","error");return}if(!N.test(p.secondary_color)){t?.("Secondary color must be a valid hex color (e.g., #1E40AF)","error");return}const X=await a(p);X.success?t?.("Branding settings saved successfully!","success"):t?.(X.error||"Failed to save branding settings","error")}catch(N){console.error("Save error:",N),t?.("Failed to save branding settings","error")}finally{u(!1)}},R=()=>{h?(document.documentElement.style.setProperty("--primary-color",r.primary_color),document.documentElement.style.setProperty("--secondary-color",r.secondary_color),document.title=r.custom_app_name||"FieldSync"):(document.documentElement.style.setProperty("--primary-color",p.primary_color),document.documentElement.style.setProperty("--secondary-color",p.secondary_color),document.title=p.custom_app_name||"FieldSync"),m(!h)};return l?f.jsxs("div",{className:"settings-loading",children:[f.jsx("div",{className:"spinner"}),f.jsx("p",{children:"Loading branding settings..."})]}):f.jsxs("div",{className:"branding-settings",children:[f.jsxs("div",{className:"settings-header",children:[f.jsx("h2",{children:" Branding Settings"}),w==="free"&&f.jsx("div",{className:"tier-badge tier-free",children:"Free Plan - Upgrade for branding options"}),w==="pro"&&f.jsx("div",{className:"tier-badge tier-pro",children:"Pro Plan"}),w==="business"&&f.jsx("div",{className:"tier-badge tier-business",children:"Business Plan"}),w==="enterprise"&&f.jsx("div",{className:"tier-badge tier-enterprise",children:"Enterprise Plan"})]}),f.jsxs("div",{className:"settings-section",children:[f.jsx("h3",{children:"Visual Identity"}),f.jsxs("div",{className:"setting-item",children:[f.jsx("label",{children:"Logo"}),E?f.jsxs(f.Fragment,{children:[p.logo_url&&f.jsx("div",{className:"logo-preview",children:f.jsx("img",{src:p.logo_url,alt:"Logo preview"})}),f.jsx("input",{ref:_,type:"file",accept:"image/*",style:{display:"none"},onChange:N=>j(N.target.files[0],"logo")}),f.jsx("button",{className:"btn-secondary",onClick:()=>_.current?.click(),children:p.logo_url?"Change Logo":"Upload Logo"}),f.jsx("p",{className:"help-text",children:"Recommended: 200x60px, PNG with transparent background"})]}):f.jsx("div",{className:"upgrade-notice",children:f.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your logo"})})]}),f.jsxs("div",{className:"setting-item",children:[f.jsx("label",{htmlFor:"app-name",children:"App Name"}),E?f.jsxs(f.Fragment,{children:[f.jsx("input",{id:"app-name",type:"text",className:"input",value:p.custom_app_name||"",onChange:N=>S("custom_app_name",N.target.value),placeholder:"FieldSync",maxLength:50}),f.jsx("p",{className:"help-text",children:"This name appears in the browser tab and throughout the app"})]}):f.jsx("div",{className:"upgrade-notice",children:f.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your app name"})})]}),f.jsxs("div",{className:"setting-item",children:[f.jsx("label",{htmlFor:"primary-color",children:"Primary Color"}),E?f.jsxs("div",{className:"color-input-group",children:[f.jsx("input",{id:"primary-color",type:"color",value:p.primary_color||"#3B82F6",onChange:N=>S("primary_color",N.target.value),className:"color-picker"}),f.jsx("input",{type:"text",className:"input color-text",value:p.primary_color||"#3B82F6",onChange:N=>S("primary_color",N.target.value),placeholder:"#3B82F6",pattern:"^#[0-9A-Fa-f]{6}$"})]}):f.jsx("div",{className:"upgrade-notice",children:f.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize colors"})})]}),f.jsxs("div",{className:"setting-item",children:[f.jsx("label",{htmlFor:"secondary-color",children:"Secondary Color"}),E?f.jsxs("div",{className:"color-input-group",children:[f.jsx("input",{id:"secondary-color",type:"color",value:p.secondary_color||"#1E40AF",onChange:N=>S("secondary_color",N.target.value),className:"color-picker"}),f.jsx("input",{type:"text",className:"input color-text",value:p.secondary_color||"#1E40AF",onChange:N=>S("secondary_color",N.target.value),placeholder:"#1E40AF",pattern:"^#[0-9A-Fa-f]{6}$"})]}):f.jsx("div",{className:"upgrade-notice",children:f.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize colors"})})]}),f.jsxs("div",{className:"setting-item",children:[f.jsx("label",{children:"Favicon"}),E?f.jsxs(f.Fragment,{children:[p.favicon_url&&f.jsx("div",{className:"favicon-preview",children:f.jsx("img",{src:p.favicon_url,alt:"Favicon preview"})}),f.jsx("input",{ref:y,type:"file",accept:"image/*",style:{display:"none"},onChange:N=>j(N.target.files[0],"favicon")}),f.jsx("button",{className:"btn-secondary",onClick:()=>y.current?.click(),children:p.favicon_url?"Change Favicon":"Upload Favicon"}),f.jsx("p",{className:"help-text",children:"Recommended: 32x32px or 64x64px, PNG or ICO format"})]}):f.jsx("div",{className:"upgrade-notice",children:f.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your favicon"})})]}),f.jsxs("div",{className:"setting-item",children:[f.jsx("label",{children:"Login Background"}),k?f.jsxs(f.Fragment,{children:[p.login_background_url&&f.jsx("div",{className:"background-preview",children:f.jsx("img",{src:p.login_background_url,alt:"Background preview"})}),f.jsx("input",{ref:b,type:"file",accept:"image/*",style:{display:"none"},onChange:N=>j(N.target.files[0],"login_background")}),f.jsx("button",{className:"btn-secondary",onClick:()=>b.current?.click(),children:p.login_background_url?"Change Background":"Upload Background"}),f.jsx("p",{className:"help-text",children:"Recommended: 1920x1080px, JPG or PNG"})]}):f.jsx("div",{className:"upgrade-notice",children:f.jsx("p",{children:" Upgrade to Business or Enterprise to customize login background"})})]})]}),f.jsxs("div",{className:"settings-section",children:[f.jsx("h3",{children:"White-Label Options"}),f.jsxs("div",{className:"setting-item",children:[f.jsxs("label",{className:"checkbox-label",children:[f.jsx("input",{type:"checkbox",checked:p.hide_fieldsync_branding||!1,onChange:N=>S("hide_fieldsync_branding",N.target.checked),disabled:!k}),f.jsx("span",{children:'Hide "Powered by FieldSync"'})]}),!k&&f.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]})]}),f.jsxs("div",{className:"settings-section",children:[f.jsx("h3",{children:"Email Branding"}),f.jsxs("div",{className:"setting-item",children:[f.jsx("label",{htmlFor:"email-from-name",children:"From Name"}),f.jsx("input",{id:"email-from-name",type:"text",className:"input",value:p.email_from_name||"",onChange:N=>S("email_from_name",N.target.value),placeholder:"Your Company Name",disabled:!k}),!k&&f.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]}),f.jsxs("div",{className:"setting-item",children:[f.jsx("label",{htmlFor:"email-from-address",children:"From Email"}),f.jsx("input",{id:"email-from-address",type:"email",className:"input",value:p.email_from_address||"",onChange:N=>S("email_from_address",N.target.value),placeholder:"noreply@yourcompany.com",disabled:!k}),!k&&f.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]})]}),f.jsxs("div",{className:"settings-section",children:[f.jsx("h3",{children:"Custom Domain"}),f.jsxs("div",{className:"setting-item",children:[f.jsx("label",{htmlFor:"custom-domain",children:"Domain"}),A?f.jsxs(f.Fragment,{children:[f.jsx("input",{id:"custom-domain",type:"text",className:"input",value:p.custom_domain||"",onChange:N=>S("custom_domain",N.target.value),placeholder:"app.yourcompany.com"}),p.custom_domain&&f.jsx("div",{className:`domain-status ${p.domain_verified?"verified":"pending"}`,children:p.domain_verified?f.jsx(f.Fragment,{children:" Connected"}):f.jsx(f.Fragment,{children:" DNS setup required"})}),f.jsx("p",{className:"help-text",children:"Contact support to configure DNS and SSL certificate for your custom domain"})]}):f.jsxs("div",{className:"upgrade-notice",children:[f.jsx("p",{children:" Enterprise plan required for custom domain support"}),f.jsx("p",{className:"help-text",children:"Custom domains allow you to host the app at your own URL (e.g., app.yourcompany.com)"})]})]})]}),f.jsxs("div",{className:"settings-actions",children:[f.jsx("button",{className:"btn-secondary",onClick:R,children:h?"Exit Preview":"Preview Changes"}),f.jsx("button",{className:"btn-primary",onClick:F,disabled:c||!E,children:c?"Saving...":"Save Changes"})]}),h&&f.jsx("div",{className:"preview-banner",children:"Preview Mode Active - Your changes are not yet saved"})]})}function s5({company:e,user:t,onShowToast:r}){const[a,s]=J.useState(!0),l=t?.role==="admin"||t?.role==="office",[c,u]=J.useState(l?"roles":"preferences"),[h,m]=J.useState([]),[p,v]=J.useState(null),[_,y]=J.useState([]),[b,w]=J.useState([]),[E,k]=J.useState([]),[A,S]=J.useState(!1),[j,F]=J.useState(!1),[R,N]=J.useState(!1),[X,G]=J.useState(""),[se,te]=J.useState(""),[z,ge]=J.useState(""),[Oe,Ce]=J.useState(""),[Q,le]=J.useState(""),[Ee,K]=J.useState(""),[Te,q]=J.useState([]),[C,H]=J.useState([]),[I,L]=J.useState([]);J.useEffect(()=>{Z()},[e?.id]),J.useEffect(()=>{p&&re(p.id)},[p]);const Z=async()=>{if(e?.id){s(!0);try{const _e=await Ge.getNotificationRoles(e.id);m(_e),_e.length>0&&!p&&v(_e[0]);const Le=await Ge.getUsersForCompany(e.id);k(Le);const be=await Ge.getNotificationTypes();if(q(be),t?.id){const it=await Ge.getNotificationPreferences(t.id,e.id);H(it);const ht=(await Ge.getUserNotificationRoles(t.id)).filter(Et=>Et.notification_roles?.company_id===e.id);L(ht.map(Et=>Et.notification_roles))}}catch(_e){console.error("Error loading notification settings:",_e),r?.("Error loading notification settings","error")}finally{s(!1)}}},re=async _e=>{try{const Le=await Ge.getUsersByNotificationRole(_e);y(Le);const be=await Ge.getExternalRecipientsByRole(_e);w(be)}catch(Le){console.error("Error loading role users:",Le)}},de=async _e=>{if(!p)return;if(_.some(be=>be.users.id===_e)){r?.("This user is already assigned to this role","error");return}try{const be=await Ge.assignNotificationRole(_e,p.id,t.id);be.success?(r?.(`User assigned to ${p.role_name}`,"success"),re(p.id),S(!1)):be.error?.includes("duplicate key")||be.error?.includes("already exists")?r?.("This user is already assigned to this role","error"):r?.(be.error||"Failed to assign user","error")}catch(be){console.error("Error assigning user:",be),be.message?.includes("duplicate key")||be.code==="23505"?r?.("This user is already assigned to this role","error"):r?.("Failed to assign user","error")}},ve=async _e=>{if(p&&confirm("Remove this user from the notification role?"))try{const Le=await Ge.removeNotificationRole(_e,p.id);Le.success?(r?.("User removed from role","success"),re(p.id)):r?.(Le.error||"Failed to remove user","error")}catch(Le){console.error("Error removing user:",Le),r?.("Failed to remove user","error")}},Se=async _e=>{if(_e.preventDefault(),!X.trim()||!se.trim()){r?.("Role name and key are required","error");return}try{const Le=se.toLowerCase().replace(/\s+/g,"_"),be=await Ge.createNotificationRole(e.id,X.trim(),Le,z.trim());be.success?(r?.("Notification role created!","success"),G(""),te(""),ge(""),N(!1),Z()):r?.(be.error||"Failed to create role","error")}catch(Le){console.error("Error creating role:",Le),r?.("Failed to create role","error")}},xe=async _e=>{if(_e.preventDefault(),!p)return;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Oe)){r?.("Please enter a valid email address","error");return}try{const be=await Ge.addExternalRecipient(p.id,Oe,Q,Ee,t.id);be.success?(r?.(`External email added to ${p.role_name}`,"success"),Ce(""),le(""),K(""),F(!1),re(p.id)):r?.(be.error||"Failed to add external email","error")}catch(be){console.error("Error adding external email:",be),r?.("Failed to add external email","error")}},U=async _e=>{if(confirm("Remove this external email from notifications?"))try{const Le=await Ge.removeExternalRecipient(_e);Le.success?(r?.("External email removed","success"),re(p.id)):r?.(Le.error||"Failed to remove external email","error")}catch(Le){console.error("Error removing external email:",Le),r?.("Failed to remove external email","error")}},Ze=async(_e,Le,be)=>{try{const it=C.find(Et=>Et.notification_type_id===_e),kt={email_enabled:it?.email_enabled??!0,in_app_enabled:it?.in_app_enabled??!0,sms_enabled:it?.sms_enabled??!1,[Le]:be},ht=await Ge.updateNotificationPreference(t.id,e.id,_e,kt);if(ht.success){const Et=await Ge.getNotificationPreferences(t.id,e.id);H(Et),r?.("Preference updated","success")}else r?.(ht.error||"Failed to update preference","error")}catch(it){console.error("Error updating preference:",it),r?.("Failed to update preference","error")}},Ie=E.filter(_e=>!_.some(Le=>Le.users.id===_e.id));return a?f.jsx("div",{className:"notification-settings",children:f.jsxs("div",{className:"settings-loading",children:[f.jsx("div",{className:"spinner"}),f.jsx("p",{children:"Loading notification settings..."})]})}):f.jsxs("div",{className:"notification-settings",children:[f.jsxs("div",{className:"settings-tabs",children:[l&&f.jsx("button",{className:`settings-tab ${c==="roles"?"active":""}`,onClick:()=>u("roles"),children:"Manage Roles"}),f.jsx("button",{className:`settings-tab ${c==="preferences"?"active":""}`,onClick:()=>u("preferences"),children:"My Preferences"})]}),c==="roles"&&l&&f.jsxs("div",{className:"roles-section",children:[f.jsxs("div",{className:"section-header",children:[f.jsxs("div",{children:[f.jsx("h2",{children:"Manage Notification Roles"}),f.jsx("p",{children:"Assign users and external emails to roles that receive specific notifications"})]}),f.jsx("button",{className:"btn-primary",onClick:()=>N(!0),children:"+ Create Role"})]}),f.jsxs("div",{className:"roles-layout",children:[f.jsxs("div",{className:"roles-list",children:[f.jsx("h3",{children:"Roles"}),h.map(_e=>f.jsxs("button",{className:`role-item ${p?.id===_e.id?"active":""}`,onClick:()=>v(_e),children:[f.jsx("div",{className:"role-name",children:_e.role_name}),f.jsx("div",{className:"role-description",children:_e.description})]},_e.id)),h.length===0&&f.jsxs("div",{className:"empty-state",children:[f.jsx("p",{children:"No notification roles yet"}),f.jsx("button",{onClick:()=>N(!0),children:"Create first role"})]})]}),p&&f.jsxs("div",{className:"role-users",children:[f.jsxs("div",{className:"role-users-header",children:[f.jsxs("div",{children:[f.jsx("h3",{children:p.role_name}),f.jsx("p",{children:p.description})]}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[f.jsx("button",{className:"btn-secondary",onClick:()=>S(!0),disabled:Ie.length===0,children:"+ Assign User"}),f.jsx("button",{className:"btn-secondary",onClick:()=>F(!0),children:"+ Add Email"})]})]}),f.jsx("div",{className:"assigned-users",children:_.length===0&&b.length===0?f.jsxs("div",{className:"empty-state",children:[f.jsx("p",{children:"No recipients assigned to this role yet"}),f.jsx("button",{onClick:()=>S(!0),children:"Assign first user"}),f.jsx("button",{onClick:()=>F(!0),style:{marginTop:"0.5rem"},children:"Add external email"})]}):f.jsxs(f.Fragment,{children:[_.length>0&&f.jsxs("h4",{style:{margin:"0 0 1rem 0",color:"var(--text-secondary)",fontSize:"0.9rem"},children:["App Users (",_.length,")"]}),_.map(_e=>f.jsxs("div",{className:"assigned-user-card",children:[f.jsxs("div",{className:"user-info",children:[f.jsx("div",{className:"user-name",children:_e.users.name||_e.users.email}),f.jsx("div",{className:"user-email",children:_e.users.email}),f.jsxs("div",{className:"user-meta",children:["Assigned ",new Date(_e.assigned_at).toLocaleDateString()]})]}),f.jsx("button",{className:"btn-danger-small",onClick:()=>ve(_e.users.id),children:"Remove"})]},_e.id)),b.length>0&&f.jsxs(f.Fragment,{children:[f.jsxs("h4",{style:{margin:"1.5rem 0 1rem 0",color:"var(--text-secondary)",fontSize:"0.9rem"},children:["External Emails (",b.length,")"]}),b.map(_e=>f.jsxs("div",{className:"assigned-user-card",style:{borderLeft:"3px solid var(--accent-blue)"},children:[f.jsxs("div",{className:"user-info",children:[f.jsx("div",{className:"user-name",children:_e.name||_e.email}),f.jsx("div",{className:"user-email",children:_e.email}),_e.notes&&f.jsx("div",{className:"user-meta",children:_e.notes}),f.jsxs("div",{className:"user-meta",children:["Added ",new Date(_e.created_at).toLocaleDateString()]})]}),f.jsx("button",{className:"btn-danger-small",onClick:()=>U(_e.id),children:"Remove"})]},_e.id))]})]})})]})]})]}),c==="preferences"&&f.jsxs("div",{className:"preferences-section",children:[f.jsx("div",{className:"section-header",children:f.jsxs("div",{children:[f.jsx("h2",{children:"My Notification Preferences"}),f.jsx("p",{children:"Choose how you want to receive notifications"})]})}),I.length>0&&f.jsxs("div",{className:"my-roles-section",style:{background:"var(--bg-card)",padding:"1.5rem",borderRadius:"12px",marginBottom:"2rem",border:"2px solid var(--accent-blue)"},children:[f.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"var(--accent-blue)"},children:"My Notification Roles"}),f.jsxs("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",color:"var(--text-secondary)"},children:["You are assigned to receive notifications for the following roles. ",l?'Switch to "Manage Roles" to change assignments.':"Contact your office admin to change role assignments."]}),f.jsx("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:I.map(_e=>f.jsxs("div",{style:{background:"var(--accent-blue-light)",border:"1px solid var(--accent-blue)",borderRadius:"8px",padding:"0.75rem 1rem",display:"flex",flexDirection:"column",gap:"0.25rem"},children:[f.jsx("div",{style:{fontWeight:600,color:"var(--text-primary)"},children:_e.role_name}),f.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:_e.description})]},_e.id))})]}),f.jsx("div",{className:"notification-types-grid",children:Object.entries(Te.reduce((_e,Le)=>(_e[Le.category]||(_e[Le.category]=[]),_e[Le.category].push(Le),_e),{})).map(([_e,Le])=>f.jsxs("div",{className:"category-group",children:[f.jsx("h3",{className:"category-title",children:_e.charAt(0).toUpperCase()+_e.slice(1)}),f.jsx("div",{className:"notification-types",children:Le.map(be=>{const it=C.find(Et=>Et.notification_type_id===be.id),kt=it?.email_enabled??be.default_enabled,ht=it?.in_app_enabled??be.default_enabled;return f.jsxs("div",{className:"notification-type-row",children:[f.jsxs("div",{className:"type-info",children:[f.jsx("div",{className:"type-name",children:be.type_name}),f.jsx("div",{className:"type-description",children:be.description})]}),f.jsxs("div",{className:"type-toggles",children:[f.jsxs("label",{className:"toggle-label",children:[f.jsx("input",{type:"checkbox",checked:kt,onChange:Et=>Ze(be.id,"email_enabled",Et.target.checked)}),f.jsx("span",{children:"Email"})]}),f.jsxs("label",{className:"toggle-label",children:[f.jsx("input",{type:"checkbox",checked:ht,onChange:Et=>Ze(be.id,"in_app_enabled",Et.target.checked)}),f.jsx("span",{children:"In-App"})]})]})]},be.id)})})]},_e))})]}),A&&f.jsx("div",{className:"modal-overlay",onClick:()=>S(!1),children:f.jsxs("div",{className:"modal",onClick:_e=>_e.stopPropagation(),children:[f.jsxs("div",{className:"modal-header",children:[f.jsxs("h3",{children:["Assign User to ",p?.role_name]}),f.jsx("button",{className:"modal-close",onClick:()=>S(!1),children:""})]}),f.jsx("div",{className:"modal-body",children:Ie.length===0?f.jsx("p",{children:"All users are already assigned to this role."}):f.jsx("div",{className:"user-select-list",children:Ie.map(_e=>f.jsxs("button",{className:"user-select-item",onClick:()=>de(_e.id),children:[f.jsx("div",{className:"user-name",children:_e.name||_e.email}),f.jsx("div",{className:"user-email",children:_e.email})]},_e.id))})})]})}),R&&f.jsx("div",{className:"modal-overlay",onClick:()=>N(!1),children:f.jsxs("div",{className:"modal",onClick:_e=>_e.stopPropagation(),children:[f.jsxs("div",{className:"modal-header",children:[f.jsx("h3",{children:"Create Notification Role"}),f.jsx("button",{className:"modal-close",onClick:()=>N(!1),children:""})]}),f.jsxs("form",{onSubmit:Se,children:[f.jsxs("div",{className:"modal-body",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Role Name *"}),f.jsx("input",{type:"text",value:X,onChange:_e=>G(_e.target.value),placeholder:"e.g., Equipment Manager",required:!0})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Role Key *"}),f.jsx("input",{type:"text",value:se,onChange:_e=>te(_e.target.value),placeholder:"e.g., equipment_manager",required:!0}),f.jsx("small",{children:"Lowercase with underscores (used in code)"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Description"}),f.jsx("textarea",{value:z,onChange:_e=>ge(_e.target.value),placeholder:"What notifications does this role receive?",rows:3})]})]}),f.jsxs("div",{className:"modal-footer",children:[f.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>N(!1),children:"Cancel"}),f.jsx("button",{type:"submit",className:"btn-primary",children:"Create Role"})]})]})]})}),j&&f.jsx("div",{className:"modal-overlay",onClick:()=>F(!1),children:f.jsxs("div",{className:"modal",onClick:_e=>_e.stopPropagation(),children:[f.jsxs("div",{className:"modal-header",children:[f.jsxs("h3",{children:["Add External Email to ",p?.role_name]}),f.jsx("button",{className:"modal-close",onClick:()=>F(!1),children:""})]}),f.jsxs("form",{onSubmit:xe,children:[f.jsxs("div",{className:"modal-body",children:[f.jsx("p",{style:{marginTop:0,color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Add an email address for someone who doesn't have an app account. They'll receive email notifications only."}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Email Address *"}),f.jsx("input",{type:"email",value:Oe,onChange:_e=>Ce(_e.target.value),placeholder:"vendor@example.com",required:!0,autoFocus:!0})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Name (Optional)"}),f.jsx("input",{type:"text",value:Q,onChange:_e=>le(_e.target.value),placeholder:"John Doe"}),f.jsx("small",{children:"Helps identify this recipient"})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{children:"Notes (Optional)"}),f.jsx("input",{type:"text",value:Ee,onChange:_e=>K(_e.target.value),placeholder:"e.g., External vendor contact"}),f.jsx("small",{children:"Internal notes about this recipient"})]})]}),f.jsxs("div",{className:"modal-footer",children:[f.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>F(!1),children:"Cancel"}),f.jsx("button",{type:"submit",className:"btn-primary",children:"Add Email"})]})]})]})})]})}function i5({company:e,onShowToast:t}){const[r,a]=J.useState(!1),[s,l]=J.useState(!1),[c,u]=J.useState(""),[h,m]=J.useState(""),[p,v]=J.useState(""),[_,y]=J.useState("");J.useEffect(()=>{e&&b()},[e]);const b=async()=>{a(!0);try{const{data:S,error:j}=await ne.from("companies").select("field_code, office_pin").eq("id",e.id).single();if(j)throw j;u(S.field_code||"Not set"),m(S.office_pin||"Not set"),v(S.field_code||""),y(S.office_pin||"")}catch(S){console.error("Error loading codes:",S),t("Error loading company codes","error")}finally{a(!1)}},w=async()=>{if(!p.trim()||!_.trim()){t("Field Code and Office PIN are required","error");return}a(!0);try{const{data:S}=await ne.from("companies").select("id").eq("field_code",p.trim().toUpperCase()).neq("id",e.id).single();if(S){t("This Field Code is already in use by another company","error"),a(!1);return}const{data:j}=await ne.from("companies").select("id").eq("office_pin",_.trim()).neq("id",e.id).single();if(j){t("This Office PIN is already in use by another company","error"),a(!1);return}const{error:F}=await ne.from("companies").update({field_code:p.trim().toUpperCase(),office_pin:_.trim()}).eq("id",e.id);if(F)throw F;u(p.trim().toUpperCase()),m(_.trim()),l(!1),t("Company codes updated successfully!","success")}catch(S){console.error("Error updating codes:",S),t("Error updating company codes","error")}finally{a(!1)}},E=()=>{v(c),y(h),l(!1)},k=()=>{const S=e.name.toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,10);v(S)},A=()=>{const S=Math.floor(1e3+Math.random()*9e3).toString();y(S)};return r&&!s?f.jsx("div",{className:"settings-container",children:f.jsx("div",{className:"spinner"})}):f.jsxs("div",{className:"settings-container",children:[f.jsxs("div",{className:"settings-header",children:[f.jsx("h1",{children:"Company Settings"}),f.jsx("p",{className:"settings-subtitle",children:"Manage your company's access codes for field workers and office staff"})]}),f.jsxs("div",{className:"settings-card",children:[f.jsxs("div",{className:"settings-section",children:[f.jsxs("div",{className:"settings-section-header",children:[f.jsx("h2",{children:"Access Codes"}),!s&&f.jsx("button",{className:"btn-secondary",onClick:()=>l(!0),children:"Edit Codes"})]}),f.jsxs("div",{className:"settings-codes",children:[f.jsxs("div",{className:"code-item",children:[f.jsxs("div",{className:"code-label",children:[f.jsx("span",{className:"code-icon",children:""}),f.jsxs("div",{children:[f.jsx("h3",{children:"Field Code"}),f.jsx("p",{children:"Foremen use this to access projects"})]})]}),s?f.jsxs("div",{className:"code-edit",children:[f.jsx("input",{type:"text",value:p,onChange:S=>v(S.target.value.toUpperCase()),placeholder:"e.g., GGG2024",disabled:r,style:{textTransform:"uppercase"}}),f.jsx("button",{className:"btn-secondary",onClick:k,disabled:r,children:"Generate"})]}):f.jsx("div",{className:"code-value",children:c})]}),f.jsxs("div",{className:"code-item",children:[f.jsxs("div",{className:"code-label",children:[f.jsx("span",{className:"code-icon",children:""}),f.jsxs("div",{children:[f.jsx("h3",{children:"Office PIN"}),f.jsx("p",{children:"Office staff need this to create accounts"})]})]}),s?f.jsxs("div",{className:"code-edit",children:[f.jsx("input",{type:"text",value:_,onChange:S=>y(S.target.value),placeholder:"e.g., 8765",maxLength:6,disabled:r}),f.jsx("button",{className:"btn-secondary",onClick:A,disabled:r,children:"Generate"})]}):f.jsx("div",{className:"code-value",children:h})]})]}),s&&f.jsxs("div",{className:"settings-actions",children:[f.jsx("button",{className:"btn-secondary",onClick:E,disabled:r,children:"Cancel"}),f.jsx("button",{className:"btn-primary",onClick:w,disabled:r,children:r?"Saving...":"Save Changes"})]})]}),f.jsxs("div",{className:"settings-info",children:[f.jsx("h3",{children:" Important"}),f.jsxs("ul",{children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Field Code"})," - Share this with your foremen so they can access project sites"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Office PIN"})," - Share this with office staff so they can create accounts"]}),f.jsx("li",{children:"Changing these codes will require everyone to use the new codes for access"}),f.jsx("li",{children:"Keep these codes secure and only share with trusted team members"})]})]})]})]})}function l5({user:e,currentCompany:t,onCompanyChange:r,onShowToast:a}){const[s,l]=J.useState([]),[c,u]=J.useState(!0),[h,m]=J.useState(!1);J.useEffect(()=>{e?.id&&p()},[e?.id]);const p=async()=>{try{const _=await Ge.getUserCompanies(e.id);console.log("Loaded companies:",_),l(Array.isArray(_)?_:[])}catch(_){console.error("Error loading companies:",_),a?.("Error loading companies","error"),l([])}finally{u(!1)}},v=_=>{if(_.id===t?.id){m(!1);return}r(_),m(!1),a?.(`Switched to ${_.name}`,"success")};return c||s.length<=1?null:f.jsxs("div",{className:"company-switcher",children:[f.jsxs("button",{className:"company-switcher-btn",onClick:()=>m(!h),title:"Switch company",children:[f.jsx("span",{className:"company-switcher-name",children:t?.name}),f.jsx("span",{className:"company-switcher-arrow",children:h?"":""})]}),h&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"company-switcher-overlay",onClick:()=>m(!1)}),f.jsx("div",{className:"company-switcher-dropdown",children:s.length===0?f.jsx("div",{className:"company-switcher-empty",children:"No companies found"}):s.map(_=>{if(!_?.id)return console.warn("Invalid company object:",_),null;const y=_.id===t?.id;return f.jsxs("button",{className:`company-switcher-item ${y?"active":""}`,onClick:()=>v(_),disabled:y,children:[f.jsxs("div",{className:"company-switcher-item-info",children:[f.jsx("span",{className:"company-switcher-item-name",children:_.name||"Unknown"}),_.field_code&&f.jsx("span",{className:"company-switcher-item-code",children:_.field_code})]}),y&&f.jsx("span",{className:"company-switcher-check",children:""})]},_.id)})})]})]})}function c5({user:e,onShowToast:t}){const[r,a]=J.useState([]),[s,l]=J.useState(0),[c,u]=J.useState(!1),[h,m]=J.useState(!0);J.useEffect(()=>{if(e?.id){p();const b=setInterval(p,3e4);return()=>clearInterval(b)}},[e?.id]);const p=async()=>{if(e?.id)try{const b=await Ge.getUnreadNotifications(e.id,10);a(b),l(b.length)}catch(b){console.error("Error loading notifications:",b)}finally{m(!1)}},v=async b=>{try{await Ge.markNotificationRead(b),a(r.filter(w=>w.id!==b)),l(w=>Math.max(0,w-1))}catch(w){console.error("Error marking notification as read:",w),t?.("Error marking notification as read","error")}},_=async()=>{try{await Ge.markAllNotificationsRead(e.id),a([]),l(0),t?.("All notifications marked as read","success")}catch(b){console.error("Error marking all as read:",b),t?.("Error marking notifications as read","error")}},y=b=>{const w=new Date(b),k=Math.floor((new Date-w)/1e3);if(k<60)return"just now";const A=Math.floor(k/60);if(A<60)return`${A}m ago`;const S=Math.floor(A/60);return S<24?`${S}h ago`:`${Math.floor(S/24)}d ago`};return f.jsxs("div",{className:"notification-bell-container",children:[f.jsxs("button",{className:"notification-bell-button",onClick:()=>u(!c),title:"Notifications",children:["",s>0&&f.jsx("span",{className:"notification-badge",children:s>9?"9+":s})]}),c&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"notification-dropdown-overlay",onClick:()=>u(!1)}),f.jsxs("div",{className:"notification-dropdown",children:[f.jsxs("div",{className:"notification-dropdown-header",children:[f.jsx("h3",{children:"Notifications"}),s>0&&f.jsx("button",{className:"notification-mark-all-read",onClick:_,children:"Mark all read"})]}),f.jsx("div",{className:"notification-list",children:h?f.jsxs("div",{className:"notification-loading",children:[f.jsx("div",{className:"spinner"}),f.jsx("p",{children:"Loading..."})]}):r.length===0?f.jsxs("div",{className:"notification-empty",children:[f.jsx("p",{children:" All caught up!"}),f.jsx("span",{children:"No new notifications"})]}):r.map(b=>f.jsxs("div",{className:"notification-item",children:[f.jsxs("div",{className:"notification-content",children:[f.jsx("div",{className:"notification-title",children:b.title}),f.jsx("div",{className:"notification-message",children:b.message}),f.jsx("div",{className:"notification-time",children:y(b.created_at)})]}),f.jsx("button",{className:"notification-dismiss",onClick:()=>v(b.id),title:"Mark as read",children:""})]},b.id))})]})]})]})}function o5({shareToken:e}){const[t,r]=J.useState(!0),[a,s]=J.useState(null),[l,c]=J.useState(null),[u,h]=J.useState(0),{branding:m}=dm();J.useEffect(()=>{p()},[e]);const p=async()=>{r(!0),s(null);try{const j=await Ge.getPublicProjectData(e);if(!j){s("This share link is invalid or has expired.");return}c(j)}catch(j){console.error("Error loading public data:",j),s("Failed to load project data.")}finally{r(!1)}},v=j=>j?new Date(j).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",_=j=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(j);if(t)return f.jsxs("div",{className:"public-view",children:[f.jsxs("div",{className:"loading-container",children:[f.jsx("div",{className:"spinner"}),f.jsx("p",{children:"Loading project..."})]}),f.jsx("style",{children:kh})]});if(a)return f.jsxs("div",{className:"public-view",children:[f.jsxs("div",{className:"error-container",children:[f.jsx("div",{className:"error-icon",children:""}),f.jsx("h2",{children:a}),f.jsx("p",{children:"Please contact the project owner for a valid link."})]}),f.jsx("style",{children:kh})]});const{share:y,project:b,progress:w,areas:E,photos:k,dailyReports:A,tmTickets:S}=l;return f.jsxs("div",{className:"public-view",children:[f.jsx("header",{className:"public-header",children:f.jsxs("div",{className:"container",children:[f.jsx(Os,{size:"large"}),f.jsx("div",{className:"header-meta",children:f.jsxs("span",{className:"last-updated",children:["Last updated: ",v(b.updated_at||b.created_at)]})})]})}),f.jsx("main",{className:"public-main",children:f.jsxs("div",{className:"container",children:[f.jsxs("div",{className:"project-header",children:[f.jsx("h1",{children:b.name}),b.address&&f.jsx("p",{className:"project-address",children:b.address})]}),y.permissions.progress&&f.jsxs("div",{className:"public-card progress-card",children:[f.jsx("h2",{children:"Project Progress"}),f.jsxs("div",{className:"progress-visual",children:[f.jsxs("div",{className:"progress-circle",children:[f.jsxs("svg",{viewBox:"0 0 100 100",children:[f.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),f.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"var(--primary-color, #3b82f6)",strokeWidth:"8",strokeDasharray:`${w*2.827} 282.7`,strokeLinecap:"round",transform:"rotate(-90 50 50)"})]}),f.jsxs("div",{className:"progress-percentage",children:[w,"%"]})]}),f.jsxs("div",{className:"progress-details",children:[f.jsx("div",{className:"progress-label",children:"Complete"}),E&&E.length>0&&f.jsxs("div",{className:"areas-summary",children:[E.filter(j=>j.status==="done").length," of ",E.length," areas completed"]})]})]}),E&&E.length>0&&f.jsxs("div",{className:"areas-list",children:[f.jsx("h3",{children:"Work Areas"}),E.map(j=>f.jsxs("div",{className:"area-item",children:[f.jsxs("div",{className:"area-info",children:[f.jsx("span",{className:"area-name",children:j.name}),f.jsxs("span",{className:"area-weight",children:[j.weight,"%"]})]}),f.jsx("div",{className:`area-status status-${j.status}`,children:j.status==="done"?" Complete":j.status==="working"?" In Progress":" Not Started"})]},j.id))]})]}),y.permissions.photos&&k&&k.length>0&&f.jsxs("div",{className:"public-card photos-card",children:[f.jsx("h2",{children:"Recent Photos"}),f.jsxs("div",{className:"photos-carousel",children:[f.jsxs("div",{className:"carousel-main",children:[k[u]&&f.jsx("img",{src:k[u].url,alt:`Project photo from ${v(k[u].date)}`,className:"carousel-image"}),f.jsx("div",{className:"carousel-date",children:v(k[u]?.date)})]}),f.jsx("div",{className:"carousel-thumbnails",children:k.slice(0,10).map((j,F)=>f.jsx("div",{className:`thumbnail ${F===u?"active":""}`,onClick:()=>h(F),children:f.jsx("img",{src:j.url,alt:`Thumbnail ${F+1}`})},F))}),k.length>1&&f.jsxs("div",{className:"carousel-controls",children:[f.jsx("button",{onClick:()=>h(j=>j>0?j-1:k.length-1),className:"carousel-btn",children:""}),f.jsxs("span",{className:"carousel-counter",children:[u+1," / ",k.length]}),f.jsx("button",{onClick:()=>h(j=>j<k.length-1?j+1:0),className:"carousel-btn",children:""})]})]})]}),y.permissions.daily_reports&&A&&A.length>0&&f.jsxs("div",{className:"public-card reports-card",children:[f.jsx("h2",{children:"Daily Reports"}),f.jsx("div",{className:"reports-list",children:A.map((j,F)=>f.jsxs("div",{className:"report-item",children:[f.jsx("div",{className:"report-date",children:v(j.report_date)}),f.jsxs("div",{className:"report-content",children:[j.crew_count&&f.jsxs("div",{className:"report-field",children:[f.jsx("strong",{children:"Crew:"})," ",j.crew_count," workers"]}),j.tasks_completed&&f.jsxs("div",{className:"report-field",children:[f.jsx("strong",{children:"Tasks Completed:"})," ",j.tasks_completed]}),j.weather&&f.jsxs("div",{className:"report-field",children:[f.jsx("strong",{children:"Weather:"})," ",j.weather]}),j.notes&&f.jsxs("div",{className:"report-field",children:[f.jsx("strong",{children:"Notes:"})," ",j.notes]})]})]},F))})]}),y.permissions.tm_tickets&&S&&S.length>0&&f.jsxs("div",{className:"public-card tm-card",children:[f.jsx("h2",{children:"Time & Materials Tickets"}),f.jsx("div",{className:"tm-list",children:S.map((j,F)=>f.jsxs("div",{className:"tm-item",children:[f.jsxs("div",{className:"tm-header",children:[f.jsx("span",{className:"tm-date",children:v(j.work_date)}),f.jsx("span",{className:`tm-status status-${j.status}`,children:j.status})]}),j.description&&f.jsx("div",{className:"tm-description",children:j.description}),j.total_amount&&f.jsxs("div",{className:"tm-amount",children:["Total: ",_(j.total_amount)]})]},F))})]})]})}),f.jsx("footer",{className:"public-footer",children:f.jsx("div",{className:"container",children:!m?.hide_fieldsync_branding&&f.jsx("p",{children:"Powered by FieldSync"})})}),f.jsx("style",{children:kh})]})}const kh=`
  .public-view {
    min-height: 100vh;
    background-color: #f9fafb;
    display: flex;
    flex-direction: column;
  }

  .container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 1rem;
    width: 100%;
  }

  /* Header */
  .public-header {
    background-color: white;
    border-bottom: 1px solid #e5e7eb;
    padding: 1.5rem 0;
  }

  .public-header .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .header-meta {
    font-size: 0.875rem;
    color: #6b7280;
  }

  /* Main Content */
  .public-main {
    flex: 1;
    padding: 2rem 0;
  }

  .project-header {
    margin-bottom: 2rem;
  }

  .project-header h1 {
    font-size: 2rem;
    margin: 0 0 0.5rem 0;
    color: #111827;
  }

  .project-address {
    font-size: 1rem;
    color: #6b7280;
    margin: 0;
  }

  /* Cards */
  .public-card {
    background-color: white;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .public-card h2 {
    font-size: 1.5rem;
    margin: 0 0 1.5rem 0;
    color: #111827;
  }

  .public-card h3 {
    font-size: 1.125rem;
    margin: 1.5rem 0 1rem 0;
    color: #374151;
  }

  /* Progress Card */
  .progress-visual {
    display: flex;
    align-items: center;
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .progress-circle {
    position: relative;
    width: 150px;
    height: 150px;
    flex-shrink: 0;
  }

  .progress-circle svg {
    width: 100%;
    height: 100%;
  }

  .progress-percentage {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2rem;
    font-weight: bold;
    color: var(--primary-color, #3b82f6);
  }

  .progress-details {
    flex: 1;
  }

  .progress-label {
    font-size: 1.25rem;
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.5rem;
  }

  .areas-summary {
    font-size: 1rem;
    color: #6b7280;
  }

  /* Areas List */
  .areas-list {
    border-top: 1px solid #e5e7eb;
    padding-top: 1rem;
  }

  .area-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 0;
    border-bottom: 1px solid #f3f4f6;
  }

  .area-item:last-child {
    border-bottom: none;
  }

  .area-info {
    flex: 1;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-right: 1rem;
  }

  .area-name {
    font-weight: 500;
    color: #374151;
  }

  .area-weight {
    color: #6b7280;
    font-size: 0.875rem;
  }

  .area-status {
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    white-space: nowrap;
  }

  .area-status.status-done {
    background-color: #d1fae5;
    color: #065f46;
  }

  .area-status.status-working {
    background-color: #fef3c7;
    color: #92400e;
  }

  .area-status.status-not_started {
    background-color: #f3f4f6;
    color: #6b7280;
  }

  /* Photos Carousel */
  .photos-carousel {
    position: relative;
  }

  .carousel-main {
    position: relative;
    width: 100%;
    height: 400px;
    background-color: #111827;
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 1rem;
  }

  .carousel-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }

  .carousel-date {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
    color: white;
    padding: 1rem;
    text-align: center;
  }

  .carousel-thumbnails {
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
  }

  .thumbnail {
    flex-shrink: 0;
    width: 80px;
    height: 80px;
    border-radius: 4px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: border-color 0.2s;
  }

  .thumbnail:hover {
    border-color: #d1d5db;
  }

  .thumbnail.active {
    border-color: var(--primary-color, #3b82f6);
  }

  .thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .carousel-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
  }

  .carousel-btn {
    background-color: white;
    border: 1px solid #d1d5db;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.25rem;
    transition: background-color 0.2s;
  }

  .carousel-btn:hover {
    background-color: #f3f4f6;
  }

  .carousel-counter {
    font-size: 0.875rem;
    color: #6b7280;
  }

  /* Daily Reports */
  .reports-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .report-item {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1rem;
  }

  .report-date {
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.75rem;
    font-size: 1.125rem;
  }

  .report-content {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .report-field {
    color: #374151;
    line-height: 1.5;
  }

  .report-field strong {
    color: #111827;
  }

  /* T&M Tickets */
  .tm-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .tm-item {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1rem;
  }

  .tm-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
  }

  .tm-date {
    font-weight: 600;
    color: #111827;
  }

  .tm-status {
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    text-transform: capitalize;
  }

  .tm-status.status-approved {
    background-color: #d1fae5;
    color: #065f46;
  }

  .tm-status.status-pending {
    background-color: #fef3c7;
    color: #92400e;
  }

  .tm-status.status-rejected {
    background-color: #fee2e2;
    color: #991b1b;
  }

  .tm-description {
    color: #374151;
    margin-bottom: 0.5rem;
  }

  .tm-amount {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--primary-color, #3b82f6);
  }

  /* Footer */
  .public-footer {
    background-color: white;
    border-top: 1px solid #e5e7eb;
    padding: 2rem 0;
    margin-top: auto;
  }

  .public-footer p {
    text-align: center;
    color: #6b7280;
    margin: 0;
    font-size: 0.875rem;
  }

  /* Loading & Error States */
  .loading-container,
  .error-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 2rem;
  }

  .spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #e5e7eb;
    border-top-color: var(--primary-color, #3b82f6);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .loading-container p {
    margin-top: 1rem;
    color: #6b7280;
  }

  .error-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
  }

  .error-container h2 {
    color: #111827;
    margin: 0 0 0.5rem 0;
  }

  .error-container p {
    color: #6b7280;
    margin: 0;
  }

  /* Mobile Responsive */
  @media (max-width: 768px) {
    .project-header h1 {
      font-size: 1.5rem;
    }

    .public-card {
      padding: 1.5rem;
    }

    .progress-visual {
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .progress-circle {
      width: 120px;
      height: 120px;
    }

    .progress-percentage {
      font-size: 1.5rem;
    }

    .carousel-main {
      height: 300px;
    }

    .area-item {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }

    .area-info {
      width: 100%;
      margin-right: 0;
    }
  }
`;function u5(){const[e,t]=J.useState("entry"),[r,a]=J.useState(null),[s,l]=J.useState(null),[c,u]=J.useState(null),[h,m]=J.useState(null),[p,v]=J.useState(!0),[_,y]=J.useState("dashboard"),[b,w]=J.useState(null);J.useEffect(()=>{const G=window.location.pathname.match(/^\/view\/([a-zA-Z0-9]+)$/);G?(m(G[1]),t("public"),v(!1)):E()},[]);const E=async()=>{try{const{data:{user:X}}=await ne.auth.getUser();if(!X){v(!1);return}const{data:G,error:se}=await ne.from("users").select("id, email, name, role, company_id, created_at, updated_at").eq("id",X.id).single();if(se||!G){console.error("Auth check error:",se),v(!1);return}const{data:te,error:z}=await ne.from("companies").select("*").eq("id",G.company_id).single();!z&&te&&(a(G),l(te),t("office"))}catch(X){console.error("Auth check error:",X)}finally{v(!1)}},k=X=>{u(X),t("foreman")},A=(X,G)=>{console.log("handleOfficeLogin called with:",{userData:X,companyData:G}),a(X),l(G),t("office")},S=async X=>{l(X),y("dashboard")},j=async()=>{try{await Pk.signOut(),a(null),l(null),t("entry"),y("dashboard")}catch(X){console.error("Logout error:",X),R("Error signing out","error")}},F=()=>{u(null),t("entry")},R=(X,G="")=>{w({message:X,type:G})},N=()=>{y("dashboard")};return p?f.jsx(Ic,{companyId:s?.id,children:f.jsxs("div",{className:"loading-screen",children:[f.jsx(Os,{className:"loading-logo"}),f.jsx("div",{className:"spinner"})]})}):e==="entry"?f.jsxs(Ic,{children:[f.jsx(Vk,{onForemanAccess:k,onOfficeLogin:A,onShowToast:R}),b&&f.jsx(gi,{message:b.message,type:b.type,onClose:()=>w(null)})]}):e==="public"&&h?f.jsxs(Ic,{children:[f.jsx(o5,{shareToken:h}),b&&f.jsx(gi,{message:b.message,type:b.type,onClose:()=>w(null)})]}):e==="foreman"&&c?f.jsxs(Ic,{companyId:c.company_id,children:[f.jsx(JF,{project:c,companyId:c.company_id,onShowToast:R,onExit:F}),b&&f.jsx(gi,{message:b.message,type:b.type,onClose:()=>w(null)})]}):f.jsx(Ic,{companyId:s?.id,children:f.jsxs("div",{children:[!ye&&f.jsx("div",{className:"demo-banner",children:"Demo Mode - Data saved locally in your browser"}),f.jsx("nav",{className:"nav",children:f.jsxs("div",{className:"nav-content",children:[f.jsx(Os,{}),f.jsxs("div",{className:"nav-tabs",children:[f.jsx("button",{className:`nav-tab ${_==="dashboard"?"active":""}`,onClick:()=>y("dashboard"),children:"Dashboard"}),f.jsx("button",{className:`nav-tab ${_==="setup"?"active":""}`,onClick:()=>y("setup"),children:"+ New Project"}),f.jsx("button",{className:`nav-tab ${_==="company"?"active":""}`,onClick:()=>y("company"),children:"Company"}),f.jsx("button",{className:`nav-tab ${_==="branding"?"active":""}`,onClick:()=>y("branding"),children:"Branding"}),f.jsx("button",{className:`nav-tab ${_==="notifications"?"active":""}`,onClick:()=>y("notifications"),children:"Notifications"})]}),f.jsxs("div",{className:"nav-user",children:[f.jsx(l5,{user:r,currentCompany:s,onCompanyChange:S,onShowToast:R}),f.jsx(c5,{user:r,onShowToast:R}),f.jsx("span",{className:"nav-user-name",children:r?.name||r?.email}),f.jsx("button",{className:"nav-logout",onClick:j,children:"Sign Out"})]})]})}),f.jsxs("div",{className:"container",children:[_==="dashboard"&&f.jsx(r5,{company:s,onShowToast:R}),_==="setup"&&f.jsx(a5,{company:s,onProjectCreated:N,onShowToast:R}),_==="company"&&f.jsx(i5,{company:s,onShowToast:R}),_==="branding"&&f.jsx(n5,{company:s,onShowToast:R}),_==="notifications"&&f.jsx(s5,{company:s,user:r,onShowToast:R})]}),b&&f.jsx(gi,{message:b.message,type:b.type,onClose:()=>w(null)})]})})}mS.createRoot(document.getElementById("root")).render(f.jsx(iS.StrictMode,{children:f.jsx(u5,{})}));
