function pE(t,e){for(var r=0;r<e.length;r++){const a=e[r];if(typeof a!="string"&&!Array.isArray(a)){for(const n in a)if(n!=="default"&&!(n in t)){const s=Object.getOwnPropertyDescriptor(a,n);s&&Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:()=>a[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();var YH=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function L2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function gE(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function a(){var n=!1;try{n=this instanceof a}catch{}return n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(a){var n=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(r,a,n.get?n:{enumerable:!0,get:function(){return t[a]}})}),r}var Fg={exports:{}},Xd={};var ab;function vE(){if(ab)return Xd;ab=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(a,n,s){var o=null;if(s!==void 0&&(o=""+s),n.key!==void 0&&(o=""+n.key),"key"in n){s={};for(var u in n)u!=="key"&&(s[u]=n[u])}else s=n;return n=s.ref,{$$typeof:t,type:a,key:o,ref:n!==void 0?n:null,props:s}}return Xd.Fragment=e,Xd.jsx=r,Xd.jsxs=r,Xd}var nb;function xE(){return nb||(nb=1,Fg.exports=vE()),Fg.exports}var l=xE(),Lg={exports:{}},Er={};var sb;function yE(){if(sb)return Er;sb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),y=Symbol.iterator;function g(M){return M===null||typeof M!="object"?null:(M=y&&M[y]||M["@@iterator"],typeof M=="function"?M:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,S={};function E(M,A,D){this.props=M,this.context=A,this.refs=S,this.updater=D||b}E.prototype.isReactComponent={},E.prototype.setState=function(M,A){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,A,"setState")},E.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function C(){}C.prototype=E.prototype;function j(M,A,D){this.props=M,this.context=A,this.refs=S,this.updater=D||b}var R=j.prototype=new C;R.constructor=j,_(R,E.prototype),R.isPureReactComponent=!0;var H=Array.isArray;function Y(){}var U={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function F(M,A,D){var B=D.ref;return{$$typeof:t,type:M,key:A,ref:B!==void 0?B:null,props:D}}function X(M,A){return F(M.type,A,M.props)}function P(M){return typeof M=="object"&&M!==null&&M.$$typeof===t}function O(M){var A={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(D){return A[D]})}var I=/\/+/g;function W(M,A){return typeof M=="object"&&M!==null&&M.key!=null?O(""+M.key):A.toString(36)}function ne(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(Y,Y):(M.status="pending",M.then(function(A){M.status==="pending"&&(M.status="fulfilled",M.value=A)},function(A){M.status==="pending"&&(M.status="rejected",M.reason=A)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function Q(M,A,D,B,q){var Z=typeof M;(Z==="undefined"||Z==="boolean")&&(M=null);var oe=!1;if(M===null)oe=!0;else switch(Z){case"bigint":case"string":case"number":oe=!0;break;case"object":switch(M.$$typeof){case t:case e:oe=!0;break;case m:return oe=M._init,Q(oe(M._payload),A,D,B,q)}}if(oe)return q=q(M),oe=B===""?"."+W(M,0):B,H(q)?(D="",oe!=null&&(D=oe.replace(I,"$&/")+"/"),Q(q,A,D,"",function(be){return be})):q!=null&&(P(q)&&(q=X(q,D+(q.key==null||M&&M.key===q.key?"":(""+q.key).replace(I,"$&/")+"/")+oe)),A.push(q)),1;oe=0;var pe=B===""?".":B+":";if(H(M))for(var _e=0;_e<M.length;_e++)B=M[_e],Z=pe+W(B,_e),oe+=Q(B,A,D,Z,q);else if(_e=g(M),typeof _e=="function")for(M=_e.call(M),_e=0;!(B=M.next()).done;)B=B.value,Z=pe+W(B,_e++),oe+=Q(B,A,D,Z,q);else if(Z==="object"){if(typeof M.then=="function")return Q(ne(M),A,D,B,q);throw A=String(M),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.")}return oe}function le(M,A,D){if(M==null)return M;var B=[],q=0;return Q(M,B,"","",function(Z){return A.call(D,Z,q++)}),B}function ee(M){if(M._status===-1){var A=M._result;A=A(),A.then(function(D){(M._status===0||M._status===-1)&&(M._status=1,M._result=D)},function(D){(M._status===0||M._status===-1)&&(M._status=2,M._result=D)}),M._status===-1&&(M._status=0,M._result=A)}if(M._status===1)return M._result.default;throw M._result}var K=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var A=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(A))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)},ue={map:le,forEach:function(M,A,D){le(M,function(){A.apply(this,arguments)},D)},count:function(M){var A=0;return le(M,function(){A++}),A},toArray:function(M){return le(M,function(A){return A})||[]},only:function(M){if(!P(M))throw Error("React.Children.only expected to receive a single React element child.");return M}};return Er.Activity=v,Er.Children=ue,Er.Component=E,Er.Fragment=r,Er.Profiler=n,Er.PureComponent=j,Er.StrictMode=a,Er.Suspense=f,Er.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,Er.__COMPILER_RUNTIME={__proto__:null,c:function(M){return U.H.useMemoCache(M)}},Er.cache=function(M){return function(){return M.apply(null,arguments)}},Er.cacheSignal=function(){return null},Er.cloneElement=function(M,A,D){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var B=_({},M.props),q=M.key;if(A!=null)for(Z in A.key!==void 0&&(q=""+A.key),A)!V.call(A,Z)||Z==="key"||Z==="__self"||Z==="__source"||Z==="ref"&&A.ref===void 0||(B[Z]=A[Z]);var Z=arguments.length-2;if(Z===1)B.children=D;else if(1<Z){for(var oe=Array(Z),pe=0;pe<Z;pe++)oe[pe]=arguments[pe+2];B.children=oe}return F(M.type,q,B)},Er.createContext=function(M){return M={$$typeof:o,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:s,_context:M},M},Er.createElement=function(M,A,D){var B,q={},Z=null;if(A!=null)for(B in A.key!==void 0&&(Z=""+A.key),A)V.call(A,B)&&B!=="key"&&B!=="__self"&&B!=="__source"&&(q[B]=A[B]);var oe=arguments.length-2;if(oe===1)q.children=D;else if(1<oe){for(var pe=Array(oe),_e=0;_e<oe;_e++)pe[_e]=arguments[_e+2];q.children=pe}if(M&&M.defaultProps)for(B in oe=M.defaultProps,oe)q[B]===void 0&&(q[B]=oe[B]);return F(M,Z,q)},Er.createRef=function(){return{current:null}},Er.forwardRef=function(M){return{$$typeof:u,render:M}},Er.isValidElement=P,Er.lazy=function(M){return{$$typeof:m,_payload:{_status:-1,_result:M},_init:ee}},Er.memo=function(M,A){return{$$typeof:h,type:M,compare:A===void 0?null:A}},Er.startTransition=function(M){var A=U.T,D={};U.T=D;try{var B=M(),q=U.S;q!==null&&q(D,B),typeof B=="object"&&B!==null&&typeof B.then=="function"&&B.then(Y,K)}catch(Z){K(Z)}finally{A!==null&&D.types!==null&&(A.types=D.types),U.T=A}},Er.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},Er.use=function(M){return U.H.use(M)},Er.useActionState=function(M,A,D){return U.H.useActionState(M,A,D)},Er.useCallback=function(M,A){return U.H.useCallback(M,A)},Er.useContext=function(M){return U.H.useContext(M)},Er.useDebugValue=function(){},Er.useDeferredValue=function(M,A){return U.H.useDeferredValue(M,A)},Er.useEffect=function(M,A){return U.H.useEffect(M,A)},Er.useEffectEvent=function(M){return U.H.useEffectEvent(M)},Er.useId=function(){return U.H.useId()},Er.useImperativeHandle=function(M,A,D){return U.H.useImperativeHandle(M,A,D)},Er.useInsertionEffect=function(M,A){return U.H.useInsertionEffect(M,A)},Er.useLayoutEffect=function(M,A){return U.H.useLayoutEffect(M,A)},Er.useMemo=function(M,A){return U.H.useMemo(M,A)},Er.useOptimistic=function(M,A){return U.H.useOptimistic(M,A)},Er.useReducer=function(M,A,D){return U.H.useReducer(M,A,D)},Er.useRef=function(M){return U.H.useRef(M)},Er.useState=function(M){return U.H.useState(M)},Er.useSyncExternalStore=function(M,A,D){return U.H.useSyncExternalStore(M,A,D)},Er.useTransition=function(){return U.H.useTransition()},Er.version="19.2.0",Er}var ib;function P2(){return ib||(ib=1,Lg.exports=yE()),Lg.exports}var se=P2();const _E=L2(se);var Pg={exports:{}},Kd={},Mg={exports:{}},Ig={};var ob;function bE(){return ob||(ob=1,(function(t){function e(Q,le){var ee=Q.length;Q.push(le);e:for(;0<ee;){var K=ee-1>>>1,ue=Q[K];if(0<n(ue,le))Q[K]=le,Q[ee]=ue,ee=K;else break e}}function r(Q){return Q.length===0?null:Q[0]}function a(Q){if(Q.length===0)return null;var le=Q[0],ee=Q.pop();if(ee!==le){Q[0]=ee;e:for(var K=0,ue=Q.length,M=ue>>>1;K<M;){var A=2*(K+1)-1,D=Q[A],B=A+1,q=Q[B];if(0>n(D,ee))B<ue&&0>n(q,D)?(Q[K]=q,Q[B]=ee,K=B):(Q[K]=D,Q[A]=ee,K=A);else if(B<ue&&0>n(q,ee))Q[K]=q,Q[B]=ee,K=B;else break e}}return le}function n(Q,le){var ee=Q.sortIndex-le.sortIndex;return ee!==0?ee:Q.id-le.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var f=[],h=[],m=1,v=null,y=3,g=!1,b=!1,_=!1,S=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;function R(Q){for(var le=r(h);le!==null;){if(le.callback===null)a(h);else if(le.startTime<=Q)a(h),le.sortIndex=le.expirationTime,e(f,le);else break;le=r(h)}}function H(Q){if(_=!1,R(Q),!b)if(r(f)!==null)b=!0,Y||(Y=!0,O());else{var le=r(h);le!==null&&ne(H,le.startTime-Q)}}var Y=!1,U=-1,V=5,F=-1;function X(){return S?!0:!(t.unstable_now()-F<V)}function P(){if(S=!1,Y){var Q=t.unstable_now();F=Q;var le=!0;try{e:{b=!1,_&&(_=!1,C(U),U=-1),g=!0;var ee=y;try{t:{for(R(Q),v=r(f);v!==null&&!(v.expirationTime>Q&&X());){var K=v.callback;if(typeof K=="function"){v.callback=null,y=v.priorityLevel;var ue=K(v.expirationTime<=Q);if(Q=t.unstable_now(),typeof ue=="function"){v.callback=ue,R(Q),le=!0;break t}v===r(f)&&a(f),R(Q)}else a(f);v=r(f)}if(v!==null)le=!0;else{var M=r(h);M!==null&&ne(H,M.startTime-Q),le=!1}}break e}finally{v=null,y=ee,g=!1}le=void 0}}finally{le?O():Y=!1}}}var O;if(typeof j=="function")O=function(){j(P)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,W=I.port2;I.port1.onmessage=P,O=function(){W.postMessage(null)}}else O=function(){E(P,0)};function ne(Q,le){U=E(function(){Q(t.unstable_now())},le)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(Q){switch(y){case 1:case 2:case 3:var le=3;break;default:le=y}var ee=y;y=le;try{return Q()}finally{y=ee}},t.unstable_requestPaint=function(){S=!0},t.unstable_runWithPriority=function(Q,le){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ee=y;y=Q;try{return le()}finally{y=ee}},t.unstable_scheduleCallback=function(Q,le,ee){var K=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?K+ee:K):ee=K,Q){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=ee+ue,Q={id:m++,callback:le,priorityLevel:Q,startTime:ee,expirationTime:ue,sortIndex:-1},ee>K?(Q.sortIndex=ee,e(h,Q),r(f)===null&&Q===r(h)&&(_?(C(U),U=-1):_=!0,ne(H,ee-K))):(Q.sortIndex=ue,e(f,Q),b||g||(b=!0,Y||(Y=!0,O()))),Q},t.unstable_shouldYield=X,t.unstable_wrapCallback=function(Q){var le=y;return function(){var ee=y;y=le;try{return Q.apply(this,arguments)}finally{y=ee}}}})(Ig)),Ig}var lb;function wE(){return lb||(lb=1,Mg.exports=bE()),Mg.exports}var Bg={exports:{}},Ns={};var cb;function SE(){if(cb)return Ns;cb=1;var t=P2();function e(f){var h="https://react.dev/errors/"+f;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function s(f,h,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:v==null?null:""+v,children:f,containerInfo:h,implementation:m}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,h){if(f==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Ns.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Ns.createPortal=function(f,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return s(f,h,null,m)},Ns.flushSync=function(f){var h=o.T,m=a.p;try{if(o.T=null,a.p=2,f)return f()}finally{o.T=h,a.p=m,a.d.f()}},Ns.preconnect=function(f,h){typeof f=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,a.d.C(f,h))},Ns.prefetchDNS=function(f){typeof f=="string"&&a.d.D(f)},Ns.preinit=function(f,h){if(typeof f=="string"&&h&&typeof h.as=="string"){var m=h.as,v=u(m,h.crossOrigin),y=typeof h.integrity=="string"?h.integrity:void 0,g=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?a.d.S(f,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:v,integrity:y,fetchPriority:g}):m==="script"&&a.d.X(f,{crossOrigin:v,integrity:y,fetchPriority:g,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Ns.preinitModule=function(f,h){if(typeof f=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=u(h.as,h.crossOrigin);a.d.M(f,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&a.d.M(f)},Ns.preload=function(f,h){if(typeof f=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,v=u(m,h.crossOrigin);a.d.L(f,m,{crossOrigin:v,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Ns.preloadModule=function(f,h){if(typeof f=="string")if(h){var m=u(h.as,h.crossOrigin);a.d.m(f,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else a.d.m(f)},Ns.requestFormReset=function(f){a.d.r(f)},Ns.unstable_batchedUpdates=function(f,h){return f(h)},Ns.useFormState=function(f,h,m){return o.H.useFormState(f,h,m)},Ns.useFormStatus=function(){return o.H.useHostTransitionStatus()},Ns.version="19.2.0",Ns}var ub;function NE(){if(ub)return Bg.exports;ub=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Bg.exports=SE(),Bg.exports}var fb;function kE(){if(fb)return Kd;fb=1;var t=wE(),e=P2(),r=NE();function a(i){var c="https://react.dev/errors/"+i;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function s(i){var c=i,d=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(d=c.return),i=c.return;while(i)}return c.tag===3?d:null}function o(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function u(i){if(i.tag===31){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function f(i){if(s(i)!==i)throw Error(a(188))}function h(i){var c=i.alternate;if(!c){if(c=s(i),c===null)throw Error(a(188));return c!==i?null:i}for(var d=i,p=c;;){var w=d.return;if(w===null)break;var k=w.alternate;if(k===null){if(p=w.return,p!==null){d=p;continue}break}if(w.child===k.child){for(k=w.child;k;){if(k===d)return f(w),i;if(k===p)return f(w),c;k=k.sibling}throw Error(a(188))}if(d.return!==p.return)d=w,p=k;else{for(var G=!1,fe=w.child;fe;){if(fe===d){G=!0,d=w,p=k;break}if(fe===p){G=!0,p=w,d=k;break}fe=fe.sibling}if(!G){for(fe=k.child;fe;){if(fe===d){G=!0,d=k,p=w;break}if(fe===p){G=!0,p=k,d=w;break}fe=fe.sibling}if(!G)throw Error(a(189))}}if(d.alternate!==p)throw Error(a(190))}if(d.tag!==3)throw Error(a(188));return d.stateNode.current===d?i:c}function m(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i;for(i=i.child;i!==null;){if(c=m(i),c!==null)return c;i=i.sibling}return null}var v=Object.assign,y=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),j=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),X=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function O(i){return i===null||typeof i!="object"?null:(i=P&&i[P]||i["@@iterator"],typeof i=="function"?i:null)}var I=Symbol.for("react.client.reference");function W(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===I?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case _:return"Fragment";case E:return"Profiler";case S:return"StrictMode";case H:return"Suspense";case Y:return"SuspenseList";case F:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case b:return"Portal";case j:return i.displayName||"Context";case C:return(i._context.displayName||"Context")+".Consumer";case R:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case U:return c=i.displayName||null,c!==null?c:W(i.type)||"Memo";case V:c=i._payload,i=i._init;try{return W(i(c))}catch{}}return null}var ne=Array.isArray,Q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},K=[],ue=-1;function M(i){return{current:i}}function A(i){0>ue||(i.current=K[ue],K[ue]=null,ue--)}function D(i,c){ue++,K[ue]=i.current,i.current=c}var B=M(null),q=M(null),Z=M(null),oe=M(null);function pe(i,c){switch(D(Z,c),D(q,i),D(B,null),c.nodeType){case 9:case 11:i=(i=c.documentElement)&&(i=i.namespaceURI)?j_(i):0;break;default:if(i=c.tagName,c=c.namespaceURI)c=j_(c),i=E_(c,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}A(B),D(B,i)}function _e(){A(B),A(q),A(Z)}function be(i){i.memoizedState!==null&&D(oe,i);var c=B.current,d=E_(c,i.type);c!==d&&(D(q,i),D(B,d))}function Le(i){q.current===i&&(A(B),A(q)),oe.current===i&&(A(oe),Wd._currentValue=ee)}var he,Ae;function de(i){if(he===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);he=c&&c[1]||"",Ae=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+he+i+Ae}var re=!1;function Ke(i,c){if(!i||re)return"";re=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(c){var gt=function(){throw Error()};if(Object.defineProperty(gt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(gt,[])}catch(nt){var et=nt}Reflect.construct(i,[],gt)}else{try{gt.call()}catch(nt){et=nt}i.call(gt.prototype)}}else{try{throw Error()}catch(nt){et=nt}(gt=i())&&typeof gt.catch=="function"&&gt.catch(function(){})}}catch(nt){if(nt&&et&&typeof nt.stack=="string")return[nt.stack,et.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=p.DetermineComponentFrameRoot(),G=k[0],fe=k[1];if(G&&fe){var Te=G.split(`
`),Qe=fe.split(`
`);for(w=p=0;p<Te.length&&!Te[p].includes("DetermineComponentFrameRoot");)p++;for(;w<Qe.length&&!Qe[w].includes("DetermineComponentFrameRoot");)w++;if(p===Te.length||w===Qe.length)for(p=Te.length-1,w=Qe.length-1;1<=p&&0<=w&&Te[p]!==Qe[w];)w--;for(;1<=p&&0<=w;p--,w--)if(Te[p]!==Qe[w]){if(p!==1||w!==1)do if(p--,w--,0>w||Te[p]!==Qe[w]){var ct=`
`+Te[p].replace(" at new "," at ");return i.displayName&&ct.includes("<anonymous>")&&(ct=ct.replace("<anonymous>",i.displayName)),ct}while(1<=p&&0<=w);break}}}finally{re=!1,Error.prepareStackTrace=d}return(d=i?i.displayName||i.name:"")?de(d):""}function Oe(i,c){switch(i.tag){case 26:case 27:case 5:return de(i.type);case 16:return de("Lazy");case 13:return i.child!==c&&c!==null?de("Suspense Fallback"):de("Suspense");case 19:return de("SuspenseList");case 0:case 15:return Ke(i.type,!1);case 11:return Ke(i.type.render,!1);case 1:return Ke(i.type,!0);case 31:return de("Activity");default:return""}}function rt(i){try{var c="",d=null;do c+=Oe(i,d),d=i,i=i.return;while(i);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var tt=Object.prototype.hasOwnProperty,Et=t.unstable_scheduleCallback,kt=t.unstable_cancelCallback,zt=t.unstable_shouldYield,Tt=t.unstable_requestPaint,at=t.unstable_now,pt=t.unstable_getCurrentPriorityLevel,At=t.unstable_ImmediatePriority,Dt=t.unstable_UserBlockingPriority,xt=t.unstable_NormalPriority,St=t.unstable_LowPriority,ft=t.unstable_IdlePriority,yt=t.log,er=t.unstable_setDisableYieldValue,Lt=null,Bt=null;function we(i){if(typeof yt=="function"&&er(i),Bt&&typeof Bt.setStrictMode=="function")try{Bt.setStrictMode(Lt,i)}catch{}}var Ie=Math.clz32?Math.clz32:Be,ve=Math.log,Ue=Math.LN2;function Be(i){return i>>>=0,i===0?32:31-(ve(i)/Ue|0)|0}var Rt=256,Ht=262144,Kt=4194304;function $t(i){var c=i&42;if(c!==0)return c;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Nr(i,c,d){var p=i.pendingLanes;if(p===0)return 0;var w=0,k=i.suspendedLanes,G=i.pingedLanes;i=i.warmLanes;var fe=p&134217727;return fe!==0?(p=fe&~k,p!==0?w=$t(p):(G&=fe,G!==0?w=$t(G):d||(d=fe&~i,d!==0&&(w=$t(d))))):(fe=p&~k,fe!==0?w=$t(fe):G!==0?w=$t(G):d||(d=p&~i,d!==0&&(w=$t(d)))),w===0?0:c!==0&&c!==w&&(c&k)===0&&(k=w&-w,d=c&-c,k>=d||k===32&&(d&4194048)!==0)?c:w}function Jn(i,c){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&c)===0}function ja(i,c){switch(i){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ct(){var i=Kt;return Kt<<=1,(Kt&62914560)===0&&(Kt=4194304),i}function Ha(i){for(var c=[],d=0;31>d;d++)c.push(i);return c}function _t(i,c){i.pendingLanes|=c,c!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function mr(i,c,d,p,w,k){var G=i.pendingLanes;i.pendingLanes=d,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=d,i.entangledLanes&=d,i.errorRecoveryDisabledLanes&=d,i.shellSuspendCounter=0;var fe=i.entanglements,Te=i.expirationTimes,Qe=i.hiddenUpdates;for(d=G&~d;0<d;){var ct=31-Ie(d),gt=1<<ct;fe[ct]=0,Te[ct]=-1;var et=Qe[ct];if(et!==null)for(Qe[ct]=null,ct=0;ct<et.length;ct++){var nt=et[ct];nt!==null&&(nt.lane&=-536870913)}d&=~gt}p!==0&&Jr(i,p,0),k!==0&&w===0&&i.tag!==0&&(i.suspendedLanes|=k&~(G&~c))}function Jr(i,c,d){i.pendingLanes|=c,i.suspendedLanes&=~c;var p=31-Ie(c);i.entangledLanes|=c,i.entanglements[p]=i.entanglements[p]|1073741824|d&261930}function qr(i,c){var d=i.entangledLanes|=c;for(i=i.entanglements;d;){var p=31-Ie(d),w=1<<p;w&c|i[p]&c&&(i[p]|=c),d&=~w}}function Xa(i,c){var d=c&-c;return d=(d&42)!==0?1:$r(d),(d&(i.suspendedLanes|c))!==0?0:d}function $r(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Ea(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function ae(){var i=le.p;return i!==0?i:(i=window.event,i===void 0?32:K_(i.type))}function je(i,c){var d=le.p;try{return le.p=i,c()}finally{le.p=d}}var ge=Math.random().toString(36).slice(2),xe="__reactFiber$"+ge,Se="__reactProps$"+ge,Ce="__reactContainer$"+ge,We="__reactEvents$"+ge,st="__reactListeners$"+ge,Ge="__reactHandles$"+ge,Ye="__reactResources$"+ge,Je="__reactMarker$"+ge;function Nt(i){delete i[xe],delete i[Se],delete i[We],delete i[st],delete i[Ge]}function Ft(i){var c=i[xe];if(c)return c;for(var d=i.parentNode;d;){if(c=d[Ce]||d[xe]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(i=F_(i);i!==null;){if(d=i[xe])return d;i=F_(i)}return c}i=d,d=i.parentNode}return null}function qt(i){if(i=i[xe]||i[Ce]){var c=i.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return i}return null}function Ot(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i.stateNode;throw Error(a(33))}function Mt(i){var c=i[Ye];return c||(c=i[Ye]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Yt(i){i[Je]=!0}var oa=new Set,Fr={};function fa(i,c){ls(i,c),ls(i+"Capture",c)}function ls(i,c){for(Fr[i]=c,i=0;i<c.length;i++)oa.add(c[i])}var pi=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gi={},Is={};function Qo(i){return tt.call(Is,i)?!0:tt.call(gi,i)?!1:pi.test(i)?Is[i]=!0:(gi[i]=!0,!1)}function Da(i,c,d){if(Qo(c))if(d===null)i.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":i.removeAttribute(c);return;case"boolean":var p=c.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(c);return}}i.setAttribute(c,""+d)}}function po(i,c,d){if(d===null)i.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttribute(c,""+d)}}function vi(i,c,d,p){if(p===null)i.removeAttribute(d);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(d);return}i.setAttributeNS(c,d,""+p)}}function Zr(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function bu(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function zi(i,c,d){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,c);if(!i.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var w=p.get,k=p.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return w.call(this)},set:function(G){d=""+G,k.call(this,G)}}),Object.defineProperty(i,c,{enumerable:p.enumerable}),{getValue:function(){return d},setValue:function(G){d=""+G},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function el(i){if(!i._valueTracker){var c=bu(i)?"checked":"value";i._valueTracker=zi(i,c,""+i[c])}}function wu(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var d=c.getValue(),p="";return i&&(p=bu(i)?i.checked?"true":"false":i.value),i=p,i!==d?(c.setValue(i),!0):!1}function cs(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var vn=/[\n"\\]/g;function nn(i){return i.replace(vn,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function yc(i,c,d,p,w,k,G,fe){i.name="",G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?i.type=G:i.removeAttribute("type"),c!=null?G==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+Zr(c)):i.value!==""+Zr(c)&&(i.value=""+Zr(c)):G!=="submit"&&G!=="reset"||i.removeAttribute("value"),c!=null?Su(i,G,Zr(c)):d!=null?Su(i,G,Zr(d)):p!=null&&i.removeAttribute("value"),w==null&&k!=null&&(i.defaultChecked=!!k),w!=null&&(i.checked=w&&typeof w!="function"&&typeof w!="symbol"),fe!=null&&typeof fe!="function"&&typeof fe!="symbol"&&typeof fe!="boolean"?i.name=""+Zr(fe):i.removeAttribute("name")}function Pf(i,c,d,p,w,k,G,fe){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(i.type=k),c!=null||d!=null){if(!(k!=="submit"&&k!=="reset"||c!=null)){el(i);return}d=d!=null?""+Zr(d):"",c=c!=null?""+Zr(c):d,fe||c===i.value||(i.value=c),i.defaultValue=c}p=p??w,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=fe?i.checked:!!p,i.defaultChecked=!!p,G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"&&(i.name=G),el(i)}function Su(i,c,d){c==="number"&&cs(i.ownerDocument)===i||i.defaultValue===""+d||(i.defaultValue=""+d)}function us(i,c,d,p){if(i=i.options,c){c={};for(var w=0;w<d.length;w++)c["$"+d[w]]=!0;for(d=0;d<i.length;d++)w=c.hasOwnProperty("$"+i[d].value),i[d].selected!==w&&(i[d].selected=w),w&&p&&(i[d].defaultSelected=!0)}else{for(d=""+Zr(d),c=null,w=0;w<i.length;w++){if(i[w].value===d){i[w].selected=!0,p&&(i[w].defaultSelected=!0);return}c!==null||i[w].disabled||(c=i[w])}c!==null&&(c.selected=!0)}}function Nu(i,c,d){if(c!=null&&(c=""+Zr(c),c!==i.value&&(i.value=c),d==null)){i.defaultValue!==c&&(i.defaultValue=c);return}i.defaultValue=d!=null?""+Zr(d):""}function ku(i,c,d,p){if(c==null){if(p!=null){if(d!=null)throw Error(a(92));if(ne(p)){if(1<p.length)throw Error(a(93));p=p[0]}d=p}d==null&&(d=""),c=d}d=Zr(c),i.defaultValue=d,p=i.textContent,p===d&&p!==""&&p!==null&&(i.value=p),el(i)}function xi(i,c){if(c){var d=i.firstChild;if(d&&d===i.lastChild&&d.nodeType===3){d.nodeValue=c;return}}i.textContent=c}var Tl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Mf(i,c,d){var p=c.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?p?i.setProperty(c,""):c==="float"?i.cssFloat="":i[c]="":p?i.setProperty(c,d):typeof d!="number"||d===0||Tl.has(c)?c==="float"?i.cssFloat=d:i[c]=(""+d).trim():i[c]=d+"px"}function If(i,c,d){if(c!=null&&typeof c!="object")throw Error(a(62));if(i=i.style,d!=null){for(var p in d)!d.hasOwnProperty(p)||c!=null&&c.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var w in c)p=c[w],c.hasOwnProperty(w)&&d[w]!==p&&Mf(i,w,p)}else for(var k in c)c.hasOwnProperty(k)&&Mf(i,k,c[k])}function ju(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Eu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Bf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function bs(i){return Bf.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function yi(){}var go=null;function Ol(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var tl=null,hr=null;function Uf(i){var c=qt(i);if(c&&(i=c.stateNode)){var d=i[Se]||null;e:switch(i=c.stateNode,c.type){case"input":if(yc(i,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),c=d.name,d.type==="radio"&&c!=null){for(d=i;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+nn(""+c)+'"][type="radio"]'),c=0;c<d.length;c++){var p=d[c];if(p!==i&&p.form===i.form){var w=p[Se]||null;if(!w)throw Error(a(90));yc(p,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(c=0;c<d.length;c++)p=d[c],p.form===i.form&&wu(p)}break e;case"textarea":Nu(i,d.value,d.defaultValue);break e;case"select":c=d.value,c!=null&&us(i,!!d.multiple,c,!1)}}}var Au=!1;function qf(i,c,d){if(Au)return i(c,d);Au=!0;try{var p=i(c);return p}finally{if(Au=!1,(tl!==null||hr!==null)&&(wm(),tl&&(c=tl,i=hr,hr=tl=null,Uf(c),i)))for(c=0;c<i.length;c++)Uf(i[c])}}function Bs(i,c){var d=i.stateNode;if(d===null)return null;var p=d[Se]||null;if(p===null)return null;d=p[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(d&&typeof d!="function")throw Error(a(231,c,typeof d));return d}var In=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cu=!1;if(In)try{var Rl={};Object.defineProperty(Rl,"passive",{get:function(){Cu=!0}}),window.addEventListener("test",Rl,Rl),window.removeEventListener("test",Rl,Rl)}catch{Cu=!1}var Us=null,Dl=null,Hi=null;function zf(){if(Hi)return Hi;var i,c=Dl,d=c.length,p,w="value"in Us?Us.value:Us.textContent,k=w.length;for(i=0;i<d&&c[i]===w[i];i++);var G=d-i;for(p=1;p<=G&&c[d-p]===w[k-p];p++);return Hi=w.slice(i,1<p?1-p:void 0)}function Ys(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function _c(){return!0}function bc(){return!1}function Cn(i){function c(d,p,w,k,G){this._reactName=d,this._targetInst=w,this.type=p,this.nativeEvent=k,this.target=G,this.currentTarget=null;for(var fe in i)i.hasOwnProperty(fe)&&(d=i[fe],this[fe]=d?d(k):k[fe]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?_c:bc,this.isPropagationStopped=bc,this}return v(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=_c)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=_c)},persist:function(){},isPersistent:_c}),c}var $i={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xs=Cn($i),vo=v({},$i,{view:0,detail:0}),wc=Cn(vo),Fl,xo,yo,Ll=v({},vo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gr,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==yo&&(yo&&i.type==="mousemove"?(Fl=i.screenX-yo.screenX,xo=i.screenY-yo.screenY):xo=Fl=0,yo=i),Fl)},movementY:function(i){return"movementY"in i?i.movementY:xo}}),Tu=Cn(Ll),_o=v({},Ll,{dataTransfer:0}),bo=Cn(_o),Hf=v({},vo,{relatedTarget:0}),wo=Cn(Hf),$f=v({},$i,{animationName:0,elapsedTime:0,pseudoElement:0}),T=Cn($f),J=v({},$i,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Ee=Cn(J),Re=v({},$i,{data:0}),qe=Cn(Re),ht={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ar(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=Jt[i])?!!c[i]:!1}function gr(){return ar}var kr=v({},vo,{key:function(i){if(i.key){var c=ht[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=Ys(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?bt[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gr,charCode:function(i){return i.type==="keypress"?Ys(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ys(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Wr=Cn(kr),Fa=v({},Ll,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ka=Cn(Fa),ya=v({},vo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gr}),xn=Cn(ya),sn=v({},$i,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bn=Cn(sn),So=v({},Ll,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),_i=Cn(So),No=v({},$i,{newState:0,oldState:0}),Ou=Cn(No),Sc=[9,13,27,32],Wi=In&&"CompositionEvent"in window,bi=null;In&&"documentMode"in document&&(bi=document.documentMode);var Pl=In&&"TextEvent"in window&&!bi,ko=In&&(!Wi||bi&&8<bi&&11>=bi),Tn=" ",rl=!1;function al(i,c){switch(i){case"keyup":return Sc.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nc(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Vi=!1;function fs(i,c){switch(i){case"compositionend":return Nc(c);case"keypress":return c.which!==32?null:(rl=!0,Tn);case"textInput":return i=c.data,i===Tn&&rl?null:i;default:return null}}function jo(i,c){if(Vi)return i==="compositionend"||!Wi&&al(i,c)?(i=zf(),Hi=Dl=Us=null,Vi=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return ko&&c.locale!=="ko"?null:c.data;default:return null}}var kc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ru(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!kc[i.type]:c==="textarea"}function qs(i,c,d,p){tl?hr?hr.push(p):hr=[p]:tl=p,c=Cm(c,"onChange"),0<c.length&&(d=new Xs("onChange","change",null,d,p),i.push({event:d,listeners:c}))}var wi=null,Eo=null;function Du(i){__(i,0)}function Si(i){var c=Ot(i);if(wu(c))return i}function nl(i,c){if(i==="change")return c}var ws=!1;if(In){var hs;if(In){var Gi="oninput"in document;if(!Gi){var Yi=document.createElement("div");Yi.setAttribute("oninput","return;"),Gi=typeof Yi.oninput=="function"}hs=Gi}else hs=!1;ws=hs&&(!document.documentMode||9<document.documentMode)}function Ao(){wi&&(wi.detachEvent("onpropertychange",jc),Eo=wi=null)}function jc(i){if(i.propertyName==="value"&&Si(Eo)){var c=[];qs(c,Eo,i,Ol(i)),qf(Du,c)}}function Ec(i,c,d){i==="focusin"?(Ao(),wi=c,Eo=d,wi.attachEvent("onpropertychange",jc)):i==="focusout"&&Ao()}function Ja(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Si(Eo)}function Wf(i,c){if(i==="click")return Si(c)}function Xi(i,c){if(i==="input"||i==="change")return Si(c)}function Ki(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var Un=typeof Object.is=="function"?Object.is:Ki;function Co(i,c){if(Un(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var d=Object.keys(i),p=Object.keys(c);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var w=d[p];if(!tt.call(c,w)||!Un(i[w],c[w]))return!1}return!0}function Ac(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Cc(i,c){var d=Ac(i);i=0;for(var p;d;){if(d.nodeType===3){if(p=i+d.textContent.length,i<=c&&p>=c)return{node:d,offset:c-i};i=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Ac(d)}}function To(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?To(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function Oo(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var c=cs(i.document);c instanceof i.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)i=c.contentWindow;else break;c=cs(i.document)}return c}function Ji(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}var Ml=In&&"documentMode"in document&&11>=document.documentMode,zs=null,Ro=null,Zn=null,Ks=!1;function Qr(i,c,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Ks||zs==null||zs!==cs(p)||(p=zs,"selectionStart"in p&&Ji(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Zn&&Co(Zn,p)||(Zn=p,p=Cm(Ro,"onSelect"),0<p.length&&(c=new Xs("onSelect","select",null,c,d),i.push({event:c,listeners:p}),c.target=zs)))}function Vr(i,c){var d={};return d[i.toLowerCase()]=c.toLowerCase(),d["Webkit"+i]="webkit"+c,d["Moz"+i]="moz"+c,d}var _a={animationend:Vr("Animation","AnimationEnd"),animationiteration:Vr("Animation","AnimationIteration"),animationstart:Vr("Animation","AnimationStart"),transitionrun:Vr("Transition","TransitionRun"),transitionstart:Vr("Transition","TransitionStart"),transitioncancel:Vr("Transition","TransitionCancel"),transitionend:Vr("Transition","TransitionEnd")},Za={},Zi={};In&&(Zi=document.createElement("div").style,"AnimationEvent"in window||(delete _a.animationend.animation,delete _a.animationiteration.animation,delete _a.animationstart.animation),"TransitionEvent"in window||delete _a.transitionend.transition);function Ni(i){if(Za[i])return Za[i];if(!_a[i])return i;var c=_a[i],d;for(d in c)if(c.hasOwnProperty(d)&&d in Zi)return Za[i]=c[d];return i}var Il=Ni("animationend"),Fu=Ni("animationiteration"),md=Ni("animationstart"),Z0=Ni("transitionrun"),Q0=Ni("transitionstart"),em=Ni("transitioncancel"),pd=Ni("transitionend"),gd=new Map,Bl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Bl.push("scrollEnd");function Js(i,c){gd.set(i,c),fa(c,[i])}var Lu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Hs=[],Ul=0,Vf=0;function Pu(){for(var i=Ul,c=Vf=Ul=0;c<i;){var d=Hs[c];Hs[c++]=null;var p=Hs[c];Hs[c++]=null;var w=Hs[c];Hs[c++]=null;var k=Hs[c];if(Hs[c++]=null,p!==null&&w!==null){var G=p.pending;G===null?w.next=w:(w.next=G.next,G.next=w),p.pending=w}k!==0&&Iu(d,w,k)}}function Mu(i,c,d,p){Hs[Ul++]=i,Hs[Ul++]=c,Hs[Ul++]=d,Hs[Ul++]=p,Vf|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function Gf(i,c,d,p){return Mu(i,c,d,p),Qn(i)}function Do(i,c){return Mu(i,null,null,c),Qn(i)}function Iu(i,c,d){i.lanes|=d;var p=i.alternate;p!==null&&(p.lanes|=d);for(var w=!1,k=i.return;k!==null;)k.childLanes|=d,p=k.alternate,p!==null&&(p.childLanes|=d),k.tag===22&&(i=k.stateNode,i===null||i._visibility&1||(w=!0)),i=k,k=k.return;return i.tag===3?(k=i.stateNode,w&&c!==null&&(w=31-Ie(d),i=k.hiddenUpdates,p=i[w],p===null?i[w]=[c]:p.push(c),c.lane=d|536870912),k):null}function Qn(i){if(50<Id)throw Id=0,ng=null,Error(a(185));for(var c=i.return;c!==null;)i=c,c=i.return;return i.tag===3?i.stateNode:null}var qn={};function Yf(i,c,d,p){this.tag=i,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function es(i,c,d,p){return new Yf(i,c,d,p)}function Xf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Zs(i,c){var d=i.alternate;return d===null?(d=es(i.tag,c,i.key,i.mode),d.elementType=i.elementType,d.type=i.type,d.stateNode=i.stateNode,d.alternate=i,i.alternate=d):(d.pendingProps=c,d.type=i.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=i.flags&65011712,d.childLanes=i.childLanes,d.lanes=i.lanes,d.child=i.child,d.memoizedProps=i.memoizedProps,d.memoizedState=i.memoizedState,d.updateQueue=i.updateQueue,c=i.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=i.sibling,d.index=i.index,d.ref=i.ref,d.refCleanup=i.refCleanup,d}function Bu(i,c){i.flags&=65011714;var d=i.alternate;return d===null?(i.childLanes=0,i.lanes=c,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=d.childLanes,i.lanes=d.lanes,i.child=d.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=d.memoizedProps,i.memoizedState=d.memoizedState,i.updateQueue=d.updateQueue,i.type=d.type,c=d.dependencies,i.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),i}function Tc(i,c,d,p,w,k){var G=0;if(p=i,typeof i=="function")Xf(i)&&(G=1);else if(typeof i=="string")G=aE(i,d,B.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case F:return i=es(31,d,c,w),i.elementType=F,i.lanes=k,i;case _:return sl(d.children,w,k,c);case S:G=8,w|=24;break;case E:return i=es(12,d,c,w|2),i.elementType=E,i.lanes=k,i;case H:return i=es(13,d,c,w),i.elementType=H,i.lanes=k,i;case Y:return i=es(19,d,c,w),i.elementType=Y,i.lanes=k,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case j:G=10;break e;case C:G=9;break e;case R:G=11;break e;case U:G=14;break e;case V:G=16,p=null;break e}G=29,d=Error(a(130,i===null?"null":typeof i,"")),p=null}return c=es(G,d,c,w),c.elementType=i,c.type=p,c.lanes=k,c}function sl(i,c,d,p){return i=es(7,i,p,c),i.lanes=d,i}function Uu(i,c,d){return i=es(6,i,null,c),i.lanes=d,i}function Kf(i){var c=es(18,null,null,0);return c.stateNode=i,c}function Oc(i,c,d){return c=es(4,i.children!==null?i.children:[],i.key,c),c.lanes=d,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}var Jf=new WeakMap;function Qs(i,c){if(typeof i=="object"&&i!==null){var d=Jf.get(i);return d!==void 0?d:(c={value:i,source:c,stack:rt(c)},Jf.set(i,c),c)}return{value:i,source:c,stack:rt(c)}}var Rc=[],ql=0,Zf=null,qu=0,ei=[],ti=0,il=null,ri=1,ai="";function $s(i,c){Rc[ql++]=qu,Rc[ql++]=Zf,Zf=i,qu=c}function tm(i,c,d){ei[ti++]=ri,ei[ti++]=ai,ei[ti++]=il,il=i;var p=ri;i=ai;var w=32-Ie(p)-1;p&=~(1<<w),d+=1;var k=32-Ie(c)+w;if(30<k){var G=w-w%5;k=(p&(1<<G)-1).toString(32),p>>=G,w-=G,ri=1<<32-Ie(c)+w|d<<w|p,ai=k+i}else ri=1<<k|d<<w|p,ai=i}function vd(i){i.return!==null&&($s(i,1),tm(i,1,0))}function Qf(i){for(;i===Zf;)Zf=Rc[--ql],Rc[ql]=null,qu=Rc[--ql],Rc[ql]=null;for(;i===il;)il=ei[--ti],ei[ti]=null,ai=ei[--ti],ei[ti]=null,ri=ei[--ti],ei[ti]=null}function rm(i,c){ei[ti++]=ri,ei[ti++]=ai,ei[ti++]=il,ri=c.id,ai=c.overflow,il=i}var zn=null,Aa=null,Ir=!1,ds=null,$a=!1,ki=Error(a(519));function ol(i){var c=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Dc(Qs(c,i)),ki}function xd(i){var c=i.stateNode,d=i.type,p=i.memoizedProps;switch(c[xe]=i,c[Se]=p,d){case"dialog":Ur("cancel",c),Ur("close",c);break;case"iframe":case"object":case"embed":Ur("load",c);break;case"video":case"audio":for(d=0;d<Ud.length;d++)Ur(Ud[d],c);break;case"source":Ur("error",c);break;case"img":case"image":case"link":Ur("error",c),Ur("load",c);break;case"details":Ur("toggle",c);break;case"input":Ur("invalid",c),Pf(c,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":Ur("invalid",c);break;case"textarea":Ur("invalid",c),ku(c,p.value,p.defaultValue,p.children)}d=p.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||c.textContent===""+d||p.suppressHydrationWarning===!0||N_(c.textContent,d)?(p.popover!=null&&(Ur("beforetoggle",c),Ur("toggle",c)),p.onScroll!=null&&Ur("scroll",c),p.onScrollEnd!=null&&Ur("scrollend",c),p.onClick!=null&&(c.onclick=yi),c=!0):c=!1,c||ol(i,!0)}function Fo(i){for(zn=i.return;zn;)switch(zn.tag){case 5:case 31:case 13:$a=!1;return;case 27:case 3:$a=!0;return;default:zn=zn.return}}function Hn(i){if(i!==zn)return!1;if(!Ir)return Fo(i),Ir=!0,!1;var c=i.tag,d;if((d=c!==3&&c!==27)&&((d=c===5)&&(d=i.type,d=!(d!=="form"&&d!=="button")||yg(i.type,i.memoizedProps)),d=!d),d&&Aa&&ol(i),Fo(i),c===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));Aa=D_(i)}else if(c===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));Aa=D_(i)}else c===27?(c=Aa,Gc(i.type)?(i=Ng,Ng=null,Aa=i):Aa=c):Aa=zn?ro(i.stateNode.nextSibling):null;return!0}function zl(){Aa=zn=null,Ir=!1}function yd(){var i=ds;return i!==null&&(ci===null?ci=i:ci.push.apply(ci,i),ds=null),i}function Dc(i){ds===null?ds=[i]:ds.push(i)}var eh=M(null),ll=null,Qi=null;function cl(i,c,d){D(eh,c._currentValue),c._currentValue=d}function ni(i){i._currentValue=eh.current,A(eh)}function Fc(i,c,d){for(;i!==null;){var p=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,p!==null&&(p.childLanes|=c)):p!==null&&(p.childLanes&c)!==c&&(p.childLanes|=c),i===d)break;i=i.return}}function Hl(i,c,d,p){var w=i.child;for(w!==null&&(w.return=i);w!==null;){var k=w.dependencies;if(k!==null){var G=w.child;k=k.firstContext;e:for(;k!==null;){var fe=k;k=w;for(var Te=0;Te<c.length;Te++)if(fe.context===c[Te]){k.lanes|=d,fe=k.alternate,fe!==null&&(fe.lanes|=d),Fc(k.return,d,i),p||(G=null);break e}k=fe.next}}else if(w.tag===18){if(G=w.return,G===null)throw Error(a(341));G.lanes|=d,k=G.alternate,k!==null&&(k.lanes|=d),Fc(G,d,i),G=null}else G=w.child;if(G!==null)G.return=w;else for(G=w;G!==null;){if(G===i){G=null;break}if(w=G.sibling,w!==null){w.return=G.return,G=w;break}G=G.return}w=G}}function ul(i,c,d,p){i=null;for(var w=c,k=!1;w!==null;){if(!k){if((w.flags&524288)!==0)k=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var G=w.alternate;if(G===null)throw Error(a(387));if(G=G.memoizedProps,G!==null){var fe=w.type;Un(w.pendingProps.value,G.value)||(i!==null?i.push(fe):i=[fe])}}else if(w===oe.current){if(G=w.alternate,G===null)throw Error(a(387));G.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(i!==null?i.push(Wd):i=[Wd])}w=w.return}i!==null&&Hl(c,i,d,p),c.flags|=262144}function th(i){for(i=i.firstContext;i!==null;){if(!Un(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function fl(i){ll=i,Qi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function $n(i){return am(ll,i)}function rh(i,c){return ll===null&&fl(i),am(i,c)}function am(i,c){var d=c._currentValue;if(c={context:c,memoizedValue:d,next:null},Qi===null){if(i===null)throw Error(a(308));Qi=c,i.dependencies={lanes:0,firstContext:c},i.flags|=524288}else Qi=Qi.next=c;return d}var S1=typeof AbortController<"u"?AbortController:function(){var i=[],c=this.signal={aborted:!1,addEventListener:function(d,p){i.push(p)}};this.abort=function(){c.aborted=!0,i.forEach(function(d){return d()})}},N1=t.unstable_scheduleCallback,k1=t.unstable_NormalPriority,Qa={$$typeof:j,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Lc(){return{controller:new S1,data:new Map,refCount:0}}function zu(i){i.refCount--,i.refCount===0&&N1(k1,function(){i.controller.abort()})}var Hu=null,ah=0,x=0,N=null;function L(i,c){if(Hu===null){var d=Hu=[];ah=0,x=ug(),N={status:"pending",value:void 0,then:function(p){d.push(p)}}}return ah++,c.then(z,z),c}function z(){if(--ah===0&&Hu!==null){N!==null&&(N.status="fulfilled");var i=Hu;Hu=null,x=0,N=null;for(var c=0;c<i.length;c++)(0,i[c])()}}function te(i,c){var d=[],p={status:"pending",value:null,reason:null,then:function(w){d.push(w)}};return i.then(function(){p.status="fulfilled",p.value=c;for(var w=0;w<d.length;w++)(0,d[w])(c)},function(w){for(p.status="rejected",p.reason=w,w=0;w<d.length;w++)(0,d[w])(void 0)}),p}var ie=Q.S;Q.S=function(i,c){Yy=at(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&L(i,c),ie!==null&&ie(i,c)};var ce=M(null);function me(){var i=ce.current;return i!==null?i:Ta.pooledCache}function ye(i,c){c===null?D(ce,ce.current):D(ce,c.pool)}function ke(){var i=me();return i===null?null:{parent:Qa._currentValue,pool:i}}var De=Error(a(460)),Xe=Error(a(474)),Ne=Error(a(542)),Me={then:function(){}};function He(i){return i=i.status,i==="fulfilled"||i==="rejected"}function ot(i,c,d){switch(d=i[d],d===void 0?i.push(c):d!==c&&(c.then(yi,yi),c=d),c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,jt(i),i;default:if(typeof c.status=="string")c.then(yi,yi);else{if(i=Ta,i!==null&&100<i.shellSuspendCounter)throw Error(a(482));i=c,i.status="pending",i.then(function(p){if(c.status==="pending"){var w=c;w.status="fulfilled",w.value=p}},function(p){if(c.status==="pending"){var w=c;w.status="rejected",w.reason=p}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,jt(i),i}throw it=c,De}}function Ve(i){try{var c=i._init;return c(i._payload)}catch(d){throw d!==null&&typeof d=="object"&&typeof d.then=="function"?(it=d,De):d}}var it=null;function dt(){if(it===null)throw Error(a(459));var i=it;return it=null,i}function jt(i){if(i===De||i===Ne)throw Error(a(483))}var vt=null,tr=0;function Wt(i){var c=tr;return tr+=1,vt===null&&(vt=[]),ot(vt,i,c)}function br(i,c){c=c.props.ref,i.ref=c!==void 0?c:null}function Xt(i,c){throw c.$$typeof===y?Error(a(525)):(i=Object.prototype.toString.call(c),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i)))}function Pr(i){function c(ze,Fe){if(i){var Ze=ze.deletions;Ze===null?(ze.deletions=[Fe],ze.flags|=16):Ze.push(Fe)}}function d(ze,Fe){if(!i)return null;for(;Fe!==null;)c(ze,Fe),Fe=Fe.sibling;return null}function p(ze){for(var Fe=new Map;ze!==null;)ze.key!==null?Fe.set(ze.key,ze):Fe.set(ze.index,ze),ze=ze.sibling;return Fe}function w(ze,Fe){return ze=Zs(ze,Fe),ze.index=0,ze.sibling=null,ze}function k(ze,Fe,Ze){return ze.index=Ze,i?(Ze=ze.alternate,Ze!==null?(Ze=Ze.index,Ze<Fe?(ze.flags|=67108866,Fe):Ze):(ze.flags|=67108866,Fe)):(ze.flags|=1048576,Fe)}function G(ze){return i&&ze.alternate===null&&(ze.flags|=67108866),ze}function fe(ze,Fe,Ze,mt){return Fe===null||Fe.tag!==6?(Fe=Uu(Ze,ze.mode,mt),Fe.return=ze,Fe):(Fe=w(Fe,Ze),Fe.return=ze,Fe)}function Te(ze,Fe,Ze,mt){var ur=Ze.type;return ur===_?ct(ze,Fe,Ze.props.children,mt,Ze.key):Fe!==null&&(Fe.elementType===ur||typeof ur=="object"&&ur!==null&&ur.$$typeof===V&&Ve(ur)===Fe.type)?(Fe=w(Fe,Ze.props),br(Fe,Ze),Fe.return=ze,Fe):(Fe=Tc(Ze.type,Ze.key,Ze.props,null,ze.mode,mt),br(Fe,Ze),Fe.return=ze,Fe)}function Qe(ze,Fe,Ze,mt){return Fe===null||Fe.tag!==4||Fe.stateNode.containerInfo!==Ze.containerInfo||Fe.stateNode.implementation!==Ze.implementation?(Fe=Oc(Ze,ze.mode,mt),Fe.return=ze,Fe):(Fe=w(Fe,Ze.children||[]),Fe.return=ze,Fe)}function ct(ze,Fe,Ze,mt,ur){return Fe===null||Fe.tag!==7?(Fe=sl(Ze,ze.mode,mt,ur),Fe.return=ze,Fe):(Fe=w(Fe,Ze),Fe.return=ze,Fe)}function gt(ze,Fe,Ze){if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint")return Fe=Uu(""+Fe,ze.mode,Ze),Fe.return=ze,Fe;if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case g:return Ze=Tc(Fe.type,Fe.key,Fe.props,null,ze.mode,Ze),br(Ze,Fe),Ze.return=ze,Ze;case b:return Fe=Oc(Fe,ze.mode,Ze),Fe.return=ze,Fe;case V:return Fe=Ve(Fe),gt(ze,Fe,Ze)}if(ne(Fe)||O(Fe))return Fe=sl(Fe,ze.mode,Ze,null),Fe.return=ze,Fe;if(typeof Fe.then=="function")return gt(ze,Wt(Fe),Ze);if(Fe.$$typeof===j)return gt(ze,rh(ze,Fe),Ze);Xt(ze,Fe)}return null}function et(ze,Fe,Ze,mt){var ur=Fe!==null?Fe.key:null;if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint")return ur!==null?null:fe(ze,Fe,""+Ze,mt);if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case g:return Ze.key===ur?Te(ze,Fe,Ze,mt):null;case b:return Ze.key===ur?Qe(ze,Fe,Ze,mt):null;case V:return Ze=Ve(Ze),et(ze,Fe,Ze,mt)}if(ne(Ze)||O(Ze))return ur!==null?null:ct(ze,Fe,Ze,mt,null);if(typeof Ze.then=="function")return et(ze,Fe,Wt(Ze),mt);if(Ze.$$typeof===j)return et(ze,Fe,rh(ze,Ze),mt);Xt(ze,Ze)}return null}function nt(ze,Fe,Ze,mt,ur){if(typeof mt=="string"&&mt!==""||typeof mt=="number"||typeof mt=="bigint")return ze=ze.get(Ze)||null,fe(Fe,ze,""+mt,ur);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case g:return ze=ze.get(mt.key===null?Ze:mt.key)||null,Te(Fe,ze,mt,ur);case b:return ze=ze.get(mt.key===null?Ze:mt.key)||null,Qe(Fe,ze,mt,ur);case V:return mt=Ve(mt),nt(ze,Fe,Ze,mt,ur)}if(ne(mt)||O(mt))return ze=ze.get(Ze)||null,ct(Fe,ze,mt,ur,null);if(typeof mt.then=="function")return nt(ze,Fe,Ze,Wt(mt),ur);if(mt.$$typeof===j)return nt(ze,Fe,Ze,rh(Fe,mt),ur);Xt(Fe,mt)}return null}function Zt(ze,Fe,Ze,mt){for(var ur=null,aa=null,nr=Fe,Or=Fe=0,Hr=null;nr!==null&&Or<Ze.length;Or++){nr.index>Or?(Hr=nr,nr=null):Hr=nr.sibling;var na=et(ze,nr,Ze[Or],mt);if(na===null){nr===null&&(nr=Hr);break}i&&nr&&na.alternate===null&&c(ze,nr),Fe=k(na,Fe,Or),aa===null?ur=na:aa.sibling=na,aa=na,nr=Hr}if(Or===Ze.length)return d(ze,nr),Ir&&$s(ze,Or),ur;if(nr===null){for(;Or<Ze.length;Or++)nr=gt(ze,Ze[Or],mt),nr!==null&&(Fe=k(nr,Fe,Or),aa===null?ur=nr:aa.sibling=nr,aa=nr);return Ir&&$s(ze,Or),ur}for(nr=p(nr);Or<Ze.length;Or++)Hr=nt(nr,ze,Or,Ze[Or],mt),Hr!==null&&(i&&Hr.alternate!==null&&nr.delete(Hr.key===null?Or:Hr.key),Fe=k(Hr,Fe,Or),aa===null?ur=Hr:aa.sibling=Hr,aa=Hr);return i&&nr.forEach(function(Zc){return c(ze,Zc)}),Ir&&$s(ze,Or),ur}function pr(ze,Fe,Ze,mt){if(Ze==null)throw Error(a(151));for(var ur=null,aa=null,nr=Fe,Or=Fe=0,Hr=null,na=Ze.next();nr!==null&&!na.done;Or++,na=Ze.next()){nr.index>Or?(Hr=nr,nr=null):Hr=nr.sibling;var Zc=et(ze,nr,na.value,mt);if(Zc===null){nr===null&&(nr=Hr);break}i&&nr&&Zc.alternate===null&&c(ze,nr),Fe=k(Zc,Fe,Or),aa===null?ur=Zc:aa.sibling=Zc,aa=Zc,nr=Hr}if(na.done)return d(ze,nr),Ir&&$s(ze,Or),ur;if(nr===null){for(;!na.done;Or++,na=Ze.next())na=gt(ze,na.value,mt),na!==null&&(Fe=k(na,Fe,Or),aa===null?ur=na:aa.sibling=na,aa=na);return Ir&&$s(ze,Or),ur}for(nr=p(nr);!na.done;Or++,na=Ze.next())na=nt(nr,ze,Or,na.value,mt),na!==null&&(i&&na.alternate!==null&&nr.delete(na.key===null?Or:na.key),Fe=k(na,Fe,Or),aa===null?ur=na:aa.sibling=na,aa=na);return i&&nr.forEach(function(mE){return c(ze,mE)}),Ir&&$s(ze,Or),ur}function Na(ze,Fe,Ze,mt){if(typeof Ze=="object"&&Ze!==null&&Ze.type===_&&Ze.key===null&&(Ze=Ze.props.children),typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case g:e:{for(var ur=Ze.key;Fe!==null;){if(Fe.key===ur){if(ur=Ze.type,ur===_){if(Fe.tag===7){d(ze,Fe.sibling),mt=w(Fe,Ze.props.children),mt.return=ze,ze=mt;break e}}else if(Fe.elementType===ur||typeof ur=="object"&&ur!==null&&ur.$$typeof===V&&Ve(ur)===Fe.type){d(ze,Fe.sibling),mt=w(Fe,Ze.props),br(mt,Ze),mt.return=ze,ze=mt;break e}d(ze,Fe);break}else c(ze,Fe);Fe=Fe.sibling}Ze.type===_?(mt=sl(Ze.props.children,ze.mode,mt,Ze.key),mt.return=ze,ze=mt):(mt=Tc(Ze.type,Ze.key,Ze.props,null,ze.mode,mt),br(mt,Ze),mt.return=ze,ze=mt)}return G(ze);case b:e:{for(ur=Ze.key;Fe!==null;){if(Fe.key===ur)if(Fe.tag===4&&Fe.stateNode.containerInfo===Ze.containerInfo&&Fe.stateNode.implementation===Ze.implementation){d(ze,Fe.sibling),mt=w(Fe,Ze.children||[]),mt.return=ze,ze=mt;break e}else{d(ze,Fe);break}else c(ze,Fe);Fe=Fe.sibling}mt=Oc(Ze,ze.mode,mt),mt.return=ze,ze=mt}return G(ze);case V:return Ze=Ve(Ze),Na(ze,Fe,Ze,mt)}if(ne(Ze))return Zt(ze,Fe,Ze,mt);if(O(Ze)){if(ur=O(Ze),typeof ur!="function")throw Error(a(150));return Ze=ur.call(Ze),pr(ze,Fe,Ze,mt)}if(typeof Ze.then=="function")return Na(ze,Fe,Wt(Ze),mt);if(Ze.$$typeof===j)return Na(ze,Fe,rh(ze,Ze),mt);Xt(ze,Ze)}return typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint"?(Ze=""+Ze,Fe!==null&&Fe.tag===6?(d(ze,Fe.sibling),mt=w(Fe,Ze),mt.return=ze,ze=mt):(d(ze,Fe),mt=Uu(Ze,ze.mode,mt),mt.return=ze,ze=mt),G(ze)):d(ze,Fe)}return function(ze,Fe,Ze,mt){try{tr=0;var ur=Na(ze,Fe,Ze,mt);return vt=null,ur}catch(nr){if(nr===De||nr===Ne)throw nr;var aa=es(29,nr,null,ze.mode);return aa.lanes=mt,aa.return=ze,aa}finally{}}}var Ca=Pr(!0),jr=Pr(!1),Vt=!1;function Ut(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function La(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function dr(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Cr(i,c,d){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(ua&2)!==0){var w=p.pending;return w===null?c.next=c:(c.next=w.next,w.next=c),p.pending=c,c=Qn(i),Iu(i,null,d),c}return Mu(i,p,c,d),Qn(i)}function la(i,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194048)!==0)){var p=c.lanes;p&=i.pendingLanes,d|=p,c.lanes=d,qr(i,d)}}function yn(i,c){var d=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var w=null,k=null;if(d=d.firstBaseUpdate,d!==null){do{var G={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};k===null?w=k=G:k=k.next=G,d=d.next}while(d!==null);k===null?w=k=c:k=k.next=c}else w=k=c;d={baseState:p.baseState,firstBaseUpdate:w,lastBaseUpdate:k,shared:p.shared,callbacks:p.callbacks},i.updateQueue=d;return}i=d.lastBaseUpdate,i===null?d.firstBaseUpdate=c:i.next=c,d.lastBaseUpdate=c}var Wn=!1;function ba(){if(Wn){var i=N;if(i!==null)throw i}}function on(i,c,d,p){Wn=!1;var w=i.updateQueue;Vt=!1;var k=w.firstBaseUpdate,G=w.lastBaseUpdate,fe=w.shared.pending;if(fe!==null){w.shared.pending=null;var Te=fe,Qe=Te.next;Te.next=null,G===null?k=Qe:G.next=Qe,G=Te;var ct=i.alternate;ct!==null&&(ct=ct.updateQueue,fe=ct.lastBaseUpdate,fe!==G&&(fe===null?ct.firstBaseUpdate=Qe:fe.next=Qe,ct.lastBaseUpdate=Te))}if(k!==null){var gt=w.baseState;G=0,ct=Qe=Te=null,fe=k;do{var et=fe.lane&-536870913,nt=et!==fe.lane;if(nt?(zr&et)===et:(p&et)===et){et!==0&&et===x&&(Wn=!0),ct!==null&&(ct=ct.next={lane:0,tag:fe.tag,payload:fe.payload,callback:null,next:null});e:{var Zt=i,pr=fe;et=c;var Na=d;switch(pr.tag){case 1:if(Zt=pr.payload,typeof Zt=="function"){gt=Zt.call(Na,gt,et);break e}gt=Zt;break e;case 3:Zt.flags=Zt.flags&-65537|128;case 0:if(Zt=pr.payload,et=typeof Zt=="function"?Zt.call(Na,gt,et):Zt,et==null)break e;gt=v({},gt,et);break e;case 2:Vt=!0}}et=fe.callback,et!==null&&(i.flags|=64,nt&&(i.flags|=8192),nt=w.callbacks,nt===null?w.callbacks=[et]:nt.push(et))}else nt={lane:et,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null},ct===null?(Qe=ct=nt,Te=gt):ct=ct.next=nt,G|=et;if(fe=fe.next,fe===null){if(fe=w.shared.pending,fe===null)break;nt=fe,fe=nt.next,nt.next=null,w.lastBaseUpdate=nt,w.shared.pending=null}}while(!0);ct===null&&(Te=gt),w.baseState=Te,w.firstBaseUpdate=Qe,w.lastBaseUpdate=ct,k===null&&(w.shared.lanes=0),zc|=G,i.lanes=G,i.memoizedState=gt}}function ts(i,c){if(typeof i!="function")throw Error(a(191,i));i.call(c)}function ln(i,c){var d=i.callbacks;if(d!==null)for(i.callbacks=null,i=0;i<d.length;i++)ts(d[i],c)}var Dr=M(null),Yr=M(0);function Pa(i,c){i=Ql,D(Yr,i),D(Dr,c),Ql=i|c.baseLanes}function ea(){D(Yr,Ql),D(Dr,Dr.current)}function _n(){Ql=Yr.current,A(Dr),A(Yr)}var Ma=M(null),Xr=null;function en(i){var c=i.alternate;D(Gr,Gr.current&1),D(Ma,i),Xr===null&&(c===null||Dr.current!==null||c.memoizedState!==null)&&(Xr=i)}function ca(i){D(Gr,Gr.current),D(Ma,i),Xr===null&&(Xr=i)}function cn(i){i.tag===22?(D(Gr,Gr.current),D(Ma,i),Xr===null&&(Xr=i)):un()}function un(){D(Gr,Gr.current),D(Ma,Ma.current)}function ha(i){A(Ma),Xr===i&&(Xr=null),A(Gr)}var Gr=M(0);function rs(i){for(var c=i;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||wg(d)||Sg(d)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Wa=0,lr=null,cr=null,Kr=null,Ss=!1,si=!1,ms=!1,fn=0,hl=0,dl=null,nh=0;function wa(){throw Error(a(321))}function _d(i,c){if(c===null)return!1;for(var d=0;d<c.length&&d<i.length;d++)if(!Un(i[d],c[d]))return!1;return!0}function bd(i,c,d,p,w,k){return Wa=k,lr=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Q.H=i===null||i.memoizedState===null?sy:D1,ms=!1,k=d(p,w),ms=!1,si&&(k=Lo(c,d,p,w)),sh(i),k}function sh(i){Q.H=Cd;var c=cr!==null&&cr.next!==null;if(Wa=0,Kr=cr=lr=null,Ss=!1,hl=0,dl=null,c)throw Error(a(300));i===null||Rn||(i=i.dependencies,i!==null&&th(i)&&(Rn=!0))}function Lo(i,c,d,p){lr=i;var w=0;do{if(si&&(dl=null),hl=0,si=!1,25<=w)throw Error(a(301));if(w+=1,Kr=cr=null,i.updateQueue!=null){var k=i.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}Q.H=iy,k=c(d,p)}while(si);return k}function j1(){var i=Q.H,c=i.useState()[0];return c=typeof c.then=="function"?ml(c):c,i=i.useState()[0],(cr!==null?cr.memoizedState:null)!==i&&(lr.flags|=1024),c}function wd(){var i=fn!==0;return fn=0,i}function Sd(i,c,d){c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~d}function ih(i){if(Ss){for(i=i.memoizedState;i!==null;){var c=i.queue;c!==null&&(c.pending=null),i=i.next}Ss=!1}Wa=0,Kr=cr=lr=null,si=!1,hl=fn=0,dl=null}function On(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?lr.memoizedState=Kr=i:Kr=Kr.next=i,Kr}function Va(){if(cr===null){var i=lr.alternate;i=i!==null?i.memoizedState:null}else i=cr.next;var c=Kr===null?lr.memoizedState:Kr.next;if(c!==null)Kr=c,cr=i;else{if(i===null)throw lr.alternate===null?Error(a(467)):Error(a(310));cr=i,i={memoizedState:cr.memoizedState,baseState:cr.baseState,baseQueue:cr.baseQueue,queue:cr.queue,next:null},Kr===null?lr.memoizedState=Kr=i:Kr=Kr.next=i}return Kr}function $u(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ml(i){var c=hl;return hl+=1,dl===null&&(dl=[]),i=ot(dl,i,c),c=lr,(Kr===null?c.memoizedState:Kr.next)===null&&(c=c.alternate,Q.H=c===null||c.memoizedState===null?sy:D1),i}function Pc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return ml(i);if(i.$$typeof===j)return $n(i)}throw Error(a(438,String(i)))}function $l(i){var c=null,d=lr.updateQueue;if(d!==null&&(c=d.memoCache),c==null){var p=lr.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(c={data:p.data.map(function(w){return w.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),d===null&&(d=$u(),lr.updateQueue=d),d.memoCache=c,d=c.data[c.index],d===void 0)for(d=c.data[c.index]=Array(i),p=0;p<i;p++)d[p]=X;return c.index++,d}function eo(i,c){return typeof c=="function"?c(i):c}function oh(i){var c=Va();return Mc(c,cr,i)}function Mc(i,c,d){var p=i.queue;if(p===null)throw Error(a(311));p.lastRenderedReducer=d;var w=i.baseQueue,k=p.pending;if(k!==null){if(w!==null){var G=w.next;w.next=k.next,k.next=G}c.baseQueue=w=k,p.pending=null}if(k=i.baseState,w===null)i.memoizedState=k;else{c=w.next;var fe=G=null,Te=null,Qe=c,ct=!1;do{var gt=Qe.lane&-536870913;if(gt!==Qe.lane?(zr&gt)===gt:(Wa&gt)===gt){var et=Qe.revertLane;if(et===0)Te!==null&&(Te=Te.next={lane:0,revertLane:0,gesture:null,action:Qe.action,hasEagerState:Qe.hasEagerState,eagerState:Qe.eagerState,next:null}),gt===x&&(ct=!0);else if((Wa&et)===et){Qe=Qe.next,et===x&&(ct=!0);continue}else gt={lane:0,revertLane:Qe.revertLane,gesture:null,action:Qe.action,hasEagerState:Qe.hasEagerState,eagerState:Qe.eagerState,next:null},Te===null?(fe=Te=gt,G=k):Te=Te.next=gt,lr.lanes|=et,zc|=et;gt=Qe.action,ms&&d(k,gt),k=Qe.hasEagerState?Qe.eagerState:d(k,gt)}else et={lane:gt,revertLane:Qe.revertLane,gesture:Qe.gesture,action:Qe.action,hasEagerState:Qe.hasEagerState,eagerState:Qe.eagerState,next:null},Te===null?(fe=Te=et,G=k):Te=Te.next=et,lr.lanes|=gt,zc|=gt;Qe=Qe.next}while(Qe!==null&&Qe!==c);if(Te===null?G=k:Te.next=fe,!Un(k,i.memoizedState)&&(Rn=!0,ct&&(d=N,d!==null)))throw d;i.memoizedState=k,i.baseState=G,i.baseQueue=Te,p.lastRenderedState=k}return w===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function lh(i){var c=Va(),d=c.queue;if(d===null)throw Error(a(311));d.lastRenderedReducer=i;var p=d.dispatch,w=d.pending,k=c.memoizedState;if(w!==null){d.pending=null;var G=w=w.next;do k=i(k,G.action),G=G.next;while(G!==w);Un(k,c.memoizedState)||(Rn=!0),c.memoizedState=k,c.baseQueue===null&&(c.baseState=k),d.lastRenderedState=k}return[k,p]}function ch(i,c,d){var p=lr,w=Va(),k=Ir;if(k){if(d===void 0)throw Error(a(407));d=d()}else d=c();var G=!Un((cr||w).memoizedState,d);if(G&&(w.memoizedState=d,Rn=!0),w=w.queue,E1(kd.bind(null,p,w,i),[i]),w.getSnapshot!==c||G||Kr!==null&&Kr.memoizedState.tag&1){if(p.flags|=2048,Vl(9,{destroy:void 0},Nd.bind(null,p,w,d,c),null),Ta===null)throw Error(a(349));k||(Wa&127)!==0||Po(p,c,d)}return d}function Po(i,c,d){i.flags|=16384,i={getSnapshot:c,value:d},c=lr.updateQueue,c===null?(c=$u(),lr.updateQueue=c,c.stores=[i]):(d=c.stores,d===null?c.stores=[i]:d.push(i))}function Nd(i,c,d,p){c.value=d,c.getSnapshot=p,nm(c)&&jd(i)}function kd(i,c,d){return d(function(){nm(c)&&jd(i)})}function nm(i){var c=i.getSnapshot;i=i.value;try{var d=c();return!Un(i,d)}catch{return!0}}function jd(i){var c=Do(i,2);c!==null&&ui(c,i,2)}function pl(i){var c=On();if(typeof i=="function"){var d=i;if(i=d(),ms){we(!0);try{d()}finally{we(!1)}}}return c.memoizedState=c.baseState=i,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:i},c}function sm(i,c,d,p){return i.baseState=d,Mc(i,cr,typeof p=="function"?p:eo)}function im(i,c,d,p,w){if(um(i))throw Error(a(485));if(i=c.action,i!==null){var k={payload:w,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(G){k.listeners.push(G)}};Q.T!==null?d(!0):k.isTransition=!1,p(k),d=c.pending,d===null?(k.next=c.pending=k,om(c,k)):(k.next=d.next,c.pending=d.next=k)}}function om(i,c){var d=c.action,p=c.payload,w=i.state;if(c.isTransition){var k=Q.T,G={};Q.T=G;try{var fe=d(w,p),Te=Q.S;Te!==null&&Te(G,fe),Ed(i,c,fe)}catch(Qe){Wl(i,c,Qe)}finally{k!==null&&G.types!==null&&(k.types=G.types),Q.T=k}}else try{k=d(w,p),Ed(i,c,k)}catch(Qe){Wl(i,c,Qe)}}function Ed(i,c,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(p){lm(i,c,p)},function(p){return Wl(i,c,p)}):lm(i,c,d)}function lm(i,c,d){c.status="fulfilled",c.value=d,uh(c),i.state=d,c=i.pending,c!==null&&(d=c.next,d===c?i.pending=null:(d=d.next,c.next=d,om(i,d)))}function Wl(i,c,d){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do c.status="rejected",c.reason=d,uh(c),c=c.next;while(c!==p)}i.action=null}function uh(i){i=i.listeners;for(var c=0;c<i.length;c++)(0,i[c])()}function Wu(i,c){return c}function to(i,c){if(Ir){var d=Ta.formState;if(d!==null){e:{var p=lr;if(Ir){if(Aa){t:{for(var w=Aa,k=$a;w.nodeType!==8;){if(!k){w=null;break t}if(w=ro(w.nextSibling),w===null){w=null;break t}}k=w.data,w=k==="F!"||k==="F"?w:null}if(w){Aa=ro(w.nextSibling),p=w.data==="F!";break e}}ol(p)}p=!1}p&&(c=d[0])}}return d=On(),d.memoizedState=d.baseState=c,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wu,lastRenderedState:c},d.queue=p,d=ry.bind(null,lr,p),p.dispatch=d,p=pl(!1),k=R1.bind(null,lr,!1,p.queue),p=On(),w={state:c,dispatch:null,action:i,pending:null},p.queue=w,d=im.bind(null,lr,w,k,d),w.dispatch=d,p.memoizedState=i,[c,d,!1]}function Mo(i){var c=Va();return Io(c,cr,i)}function Io(i,c,d){if(c=Mc(i,c,Wu)[0],i=oh(eo)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var p=ml(c)}catch(G){throw G===De?Ne:G}else p=c;c=Va();var w=c.queue,k=w.dispatch;return d!==c.memoizedState&&(lr.flags|=2048,Vl(9,{destroy:void 0},fh.bind(null,w,d),null)),[p,k,i]}function fh(i,c){i.action=c}function hh(i){var c=Va(),d=cr;if(d!==null)return Io(c,d,i);Va(),c=c.memoizedState,d=Va();var p=d.queue.dispatch;return d.memoizedState=i,[c,p,!1]}function Vl(i,c,d,p){return i={tag:i,create:d,deps:p,inst:c,next:null},c=lr.updateQueue,c===null&&(c=$u(),lr.updateQueue=c),d=c.lastEffect,d===null?c.lastEffect=i.next=i:(p=d.next,d.next=i,i.next=p,c.lastEffect=i),i}function cm(){return Va().memoizedState}function Ic(i,c,d,p){var w=On();lr.flags|=i,w.memoizedState=Vl(1|c,{destroy:void 0},d,p===void 0?null:p)}function Bc(i,c,d,p){var w=Va();p=p===void 0?null:p;var k=w.memoizedState.inst;cr!==null&&p!==null&&_d(p,cr.memoizedState.deps)?w.memoizedState=Vl(c,k,d,p):(lr.flags|=i,w.memoizedState=Vl(1|c,k,d,p))}function zx(i,c){Ic(8390656,8,i,c)}function E1(i,c){Bc(2048,8,i,c)}function lj(i){lr.flags|=4;var c=lr.updateQueue;if(c===null)c=$u(),lr.updateQueue=c,c.events=[i];else{var d=c.events;d===null?c.events=[i]:d.push(i)}}function Hx(i){var c=Va().memoizedState;return lj({ref:c,nextImpl:i}),function(){if((ua&2)!==0)throw Error(a(440));return c.impl.apply(void 0,arguments)}}function $x(i,c){return Bc(4,2,i,c)}function Wx(i,c){return Bc(4,4,i,c)}function Vx(i,c){if(typeof c=="function"){i=i();var d=c(i);return function(){typeof d=="function"?d():c(null)}}if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function Gx(i,c,d){d=d!=null?d.concat([i]):null,Bc(4,4,Vx.bind(null,c,i),d)}function A1(){}function Yx(i,c){var d=Va();c=c===void 0?null:c;var p=d.memoizedState;return c!==null&&_d(c,p[1])?p[0]:(d.memoizedState=[i,c],i)}function Xx(i,c){var d=Va();c=c===void 0?null:c;var p=d.memoizedState;if(c!==null&&_d(c,p[1]))return p[0];if(p=i(),ms){we(!0);try{i()}finally{we(!1)}}return d.memoizedState=[p,c],p}function C1(i,c,d){return d===void 0||(Wa&1073741824)!==0&&(zr&261930)===0?i.memoizedState=c:(i.memoizedState=d,i=Ky(),lr.lanes|=i,zc|=i,d)}function Kx(i,c,d,p){return Un(d,c)?d:Dr.current!==null?(i=C1(i,d,p),Un(i,c)||(Rn=!0),i):(Wa&42)===0||(Wa&1073741824)!==0&&(zr&261930)===0?(Rn=!0,i.memoizedState=d):(i=Ky(),lr.lanes|=i,zc|=i,c)}function Jx(i,c,d,p,w){var k=le.p;le.p=k!==0&&8>k?k:8;var G=Q.T,fe={};Q.T=fe,R1(i,!1,c,d);try{var Te=w(),Qe=Q.S;if(Qe!==null&&Qe(fe,Te),Te!==null&&typeof Te=="object"&&typeof Te.then=="function"){var ct=te(Te,p);Ad(i,c,ct,Ai(i))}else Ad(i,c,p,Ai(i))}catch(gt){Ad(i,c,{then:function(){},status:"rejected",reason:gt},Ai())}finally{le.p=k,G!==null&&fe.types!==null&&(G.types=fe.types),Q.T=G}}function cj(){}function T1(i,c,d,p){if(i.tag!==5)throw Error(a(476));var w=Zx(i).queue;Jx(i,w,c,ee,d===null?cj:function(){return Qx(i),d(p)})}function Zx(i){var c=i.memoizedState;if(c!==null)return c;c={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:ee},next:null};var d={};return c.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:d},next:null},i.memoizedState=c,i=i.alternate,i!==null&&(i.memoizedState=c),c}function Qx(i){var c=Zx(i);c.next===null&&(c=i.alternate.memoizedState),Ad(i,c.next.queue,{},Ai())}function O1(){return $n(Wd)}function ey(){return Va().memoizedState}function ty(){return Va().memoizedState}function uj(i){for(var c=i.return;c!==null;){switch(c.tag){case 24:case 3:var d=Ai();i=dr(d);var p=Cr(c,i,d);p!==null&&(ui(p,c,d),la(p,c,d)),c={cache:Lc()},i.payload=c;return}c=c.return}}function fj(i,c,d){var p=Ai();d={lane:p,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},um(i)?ay(c,d):(d=Gf(i,c,d,p),d!==null&&(ui(d,i,p),ny(d,c,p)))}function ry(i,c,d){var p=Ai();Ad(i,c,d,p)}function Ad(i,c,d,p){var w={lane:p,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null};if(um(i))ay(c,w);else{var k=i.alternate;if(i.lanes===0&&(k===null||k.lanes===0)&&(k=c.lastRenderedReducer,k!==null))try{var G=c.lastRenderedState,fe=k(G,d);if(w.hasEagerState=!0,w.eagerState=fe,Un(fe,G))return Mu(i,c,w,0),Ta===null&&Pu(),!1}catch{}finally{}if(d=Gf(i,c,w,p),d!==null)return ui(d,i,p),ny(d,c,p),!0}return!1}function R1(i,c,d,p){if(p={lane:2,revertLane:ug(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},um(i)){if(c)throw Error(a(479))}else c=Gf(i,d,p,2),c!==null&&ui(c,i,2)}function um(i){var c=i.alternate;return i===lr||c!==null&&c===lr}function ay(i,c){si=Ss=!0;var d=i.pending;d===null?c.next=c:(c.next=d.next,d.next=c),i.pending=c}function ny(i,c,d){if((d&4194048)!==0){var p=c.lanes;p&=i.pendingLanes,d|=p,c.lanes=d,qr(i,d)}}var Cd={readContext:$n,use:Pc,useCallback:wa,useContext:wa,useEffect:wa,useImperativeHandle:wa,useLayoutEffect:wa,useInsertionEffect:wa,useMemo:wa,useReducer:wa,useRef:wa,useState:wa,useDebugValue:wa,useDeferredValue:wa,useTransition:wa,useSyncExternalStore:wa,useId:wa,useHostTransitionStatus:wa,useFormState:wa,useActionState:wa,useOptimistic:wa,useMemoCache:wa,useCacheRefresh:wa};Cd.useEffectEvent=wa;var sy={readContext:$n,use:Pc,useCallback:function(i,c){return On().memoizedState=[i,c===void 0?null:c],i},useContext:$n,useEffect:zx,useImperativeHandle:function(i,c,d){d=d!=null?d.concat([i]):null,Ic(4194308,4,Vx.bind(null,c,i),d)},useLayoutEffect:function(i,c){return Ic(4194308,4,i,c)},useInsertionEffect:function(i,c){Ic(4,2,i,c)},useMemo:function(i,c){var d=On();c=c===void 0?null:c;var p=i();if(ms){we(!0);try{i()}finally{we(!1)}}return d.memoizedState=[p,c],p},useReducer:function(i,c,d){var p=On();if(d!==void 0){var w=d(c);if(ms){we(!0);try{d(c)}finally{we(!1)}}}else w=c;return p.memoizedState=p.baseState=w,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:w},p.queue=i,i=i.dispatch=fj.bind(null,lr,i),[p.memoizedState,i]},useRef:function(i){var c=On();return i={current:i},c.memoizedState=i},useState:function(i){i=pl(i);var c=i.queue,d=ry.bind(null,lr,c);return c.dispatch=d,[i.memoizedState,d]},useDebugValue:A1,useDeferredValue:function(i,c){var d=On();return C1(d,i,c)},useTransition:function(){var i=pl(!1);return i=Jx.bind(null,lr,i.queue,!0,!1),On().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,c,d){var p=lr,w=On();if(Ir){if(d===void 0)throw Error(a(407));d=d()}else{if(d=c(),Ta===null)throw Error(a(349));(zr&127)!==0||Po(p,c,d)}w.memoizedState=d;var k={value:d,getSnapshot:c};return w.queue=k,zx(kd.bind(null,p,k,i),[i]),p.flags|=2048,Vl(9,{destroy:void 0},Nd.bind(null,p,k,d,c),null),d},useId:function(){var i=On(),c=Ta.identifierPrefix;if(Ir){var d=ai,p=ri;d=(p&~(1<<32-Ie(p)-1)).toString(32)+d,c="_"+c+"R_"+d,d=fn++,0<d&&(c+="H"+d.toString(32)),c+="_"}else d=nh++,c="_"+c+"r_"+d.toString(32)+"_";return i.memoizedState=c},useHostTransitionStatus:O1,useFormState:to,useActionState:to,useOptimistic:function(i){var c=On();c.memoizedState=c.baseState=i;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=d,c=R1.bind(null,lr,!0,d),d.dispatch=c,[i,c]},useMemoCache:$l,useCacheRefresh:function(){return On().memoizedState=uj.bind(null,lr)},useEffectEvent:function(i){var c=On(),d={impl:i};return c.memoizedState=d,function(){if((ua&2)!==0)throw Error(a(440));return d.impl.apply(void 0,arguments)}}},D1={readContext:$n,use:Pc,useCallback:Yx,useContext:$n,useEffect:E1,useImperativeHandle:Gx,useInsertionEffect:$x,useLayoutEffect:Wx,useMemo:Xx,useReducer:oh,useRef:cm,useState:function(){return oh(eo)},useDebugValue:A1,useDeferredValue:function(i,c){var d=Va();return Kx(d,cr.memoizedState,i,c)},useTransition:function(){var i=oh(eo)[0],c=Va().memoizedState;return[typeof i=="boolean"?i:ml(i),c]},useSyncExternalStore:ch,useId:ey,useHostTransitionStatus:O1,useFormState:Mo,useActionState:Mo,useOptimistic:function(i,c){var d=Va();return sm(d,cr,i,c)},useMemoCache:$l,useCacheRefresh:ty};D1.useEffectEvent=Hx;var iy={readContext:$n,use:Pc,useCallback:Yx,useContext:$n,useEffect:E1,useImperativeHandle:Gx,useInsertionEffect:$x,useLayoutEffect:Wx,useMemo:Xx,useReducer:lh,useRef:cm,useState:function(){return lh(eo)},useDebugValue:A1,useDeferredValue:function(i,c){var d=Va();return cr===null?C1(d,i,c):Kx(d,cr.memoizedState,i,c)},useTransition:function(){var i=lh(eo)[0],c=Va().memoizedState;return[typeof i=="boolean"?i:ml(i),c]},useSyncExternalStore:ch,useId:ey,useHostTransitionStatus:O1,useFormState:hh,useActionState:hh,useOptimistic:function(i,c){var d=Va();return cr!==null?sm(d,cr,i,c):(d.baseState=i,[i,d.queue.dispatch])},useMemoCache:$l,useCacheRefresh:ty};iy.useEffectEvent=Hx;function F1(i,c,d,p){c=i.memoizedState,d=d(p,c),d=d==null?c:v({},c,d),i.memoizedState=d,i.lanes===0&&(i.updateQueue.baseState=d)}var L1={enqueueSetState:function(i,c,d){i=i._reactInternals;var p=Ai(),w=dr(p);w.payload=c,d!=null&&(w.callback=d),c=Cr(i,w,p),c!==null&&(ui(c,i,p),la(c,i,p))},enqueueReplaceState:function(i,c,d){i=i._reactInternals;var p=Ai(),w=dr(p);w.tag=1,w.payload=c,d!=null&&(w.callback=d),c=Cr(i,w,p),c!==null&&(ui(c,i,p),la(c,i,p))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var d=Ai(),p=dr(d);p.tag=2,c!=null&&(p.callback=c),c=Cr(i,p,d),c!==null&&(ui(c,i,d),la(c,i,d))}};function oy(i,c,d,p,w,k,G){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,k,G):c.prototype&&c.prototype.isPureReactComponent?!Co(d,p)||!Co(w,k):!0}function ly(i,c,d,p){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,p),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,p),c.state!==i&&L1.enqueueReplaceState(c,c.state,null)}function Vu(i,c){var d=c;if("ref"in c){d={};for(var p in c)p!=="ref"&&(d[p]=c[p])}if(i=i.defaultProps){d===c&&(d=v({},d));for(var w in i)d[w]===void 0&&(d[w]=i[w])}return d}function cy(i){Lu(i)}function uy(i){console.error(i)}function fy(i){Lu(i)}function fm(i,c){try{var d=i.onUncaughtError;d(c.value,{componentStack:c.stack})}catch(p){setTimeout(function(){throw p})}}function hy(i,c,d){try{var p=i.onCaughtError;p(d.value,{componentStack:d.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function P1(i,c,d){return d=dr(d),d.tag=3,d.payload={element:null},d.callback=function(){fm(i,c)},d}function dy(i){return i=dr(i),i.tag=3,i}function my(i,c,d,p){var w=d.type.getDerivedStateFromError;if(typeof w=="function"){var k=p.value;i.payload=function(){return w(k)},i.callback=function(){hy(c,d,p)}}var G=d.stateNode;G!==null&&typeof G.componentDidCatch=="function"&&(i.callback=function(){hy(c,d,p),typeof w!="function"&&(Hc===null?Hc=new Set([this]):Hc.add(this));var fe=p.stack;this.componentDidCatch(p.value,{componentStack:fe!==null?fe:""})})}function hj(i,c,d,p,w){if(d.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(c=d.alternate,c!==null&&ul(c,d,w,!0),d=Ma.current,d!==null){switch(d.tag){case 31:case 13:return Xr===null?Sm():d.alternate===null&&hn===0&&(hn=3),d.flags&=-257,d.flags|=65536,d.lanes=w,p===Me?d.flags|=16384:(c=d.updateQueue,c===null?d.updateQueue=new Set([p]):c.add(p),og(i,p,w)),!1;case 22:return d.flags|=65536,p===Me?d.flags|=16384:(c=d.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([p])},d.updateQueue=c):(d=c.retryQueue,d===null?c.retryQueue=new Set([p]):d.add(p)),og(i,p,w)),!1}throw Error(a(435,d.tag))}return og(i,p,w),Sm(),!1}if(Ir)return c=Ma.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=w,p!==ki&&(i=Error(a(422),{cause:p}),Dc(Qs(i,d)))):(p!==ki&&(c=Error(a(423),{cause:p}),Dc(Qs(c,d))),i=i.current.alternate,i.flags|=65536,w&=-w,i.lanes|=w,p=Qs(p,d),w=P1(i.stateNode,p,w),yn(i,w),hn!==4&&(hn=2)),!1;var k=Error(a(520),{cause:p});if(k=Qs(k,d),Md===null?Md=[k]:Md.push(k),hn!==4&&(hn=2),c===null)return!0;p=Qs(p,d),d=c;do{switch(d.tag){case 3:return d.flags|=65536,i=w&-w,d.lanes|=i,i=P1(d.stateNode,p,i),yn(d,i),!1;case 1:if(c=d.type,k=d.stateNode,(d.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Hc===null||!Hc.has(k))))return d.flags|=65536,w&=-w,d.lanes|=w,w=dy(w),my(w,i,d,p),yn(d,w),!1}d=d.return}while(d!==null);return!1}var M1=Error(a(461)),Rn=!1;function ps(i,c,d,p){c.child=i===null?jr(c,null,d,p):Ca(c,i.child,d,p)}function py(i,c,d,p,w){d=d.render;var k=c.ref;if("ref"in p){var G={};for(var fe in p)fe!=="ref"&&(G[fe]=p[fe])}else G=p;return fl(c),p=bd(i,c,d,G,k,w),fe=wd(),i!==null&&!Rn?(Sd(i,c,w),Gl(i,c,w)):(Ir&&fe&&vd(c),c.flags|=1,ps(i,c,p,w),c.child)}function gy(i,c,d,p,w){if(i===null){var k=d.type;return typeof k=="function"&&!Xf(k)&&k.defaultProps===void 0&&d.compare===null?(c.tag=15,c.type=k,vy(i,c,k,p,w)):(i=Tc(d.type,null,p,c,c.mode,w),i.ref=c.ref,i.return=c,c.child=i)}if(k=i.child,!W1(i,w)){var G=k.memoizedProps;if(d=d.compare,d=d!==null?d:Co,d(G,p)&&i.ref===c.ref)return Gl(i,c,w)}return c.flags|=1,i=Zs(k,p),i.ref=c.ref,i.return=c,c.child=i}function vy(i,c,d,p,w){if(i!==null){var k=i.memoizedProps;if(Co(k,p)&&i.ref===c.ref)if(Rn=!1,c.pendingProps=p=k,W1(i,w))(i.flags&131072)!==0&&(Rn=!0);else return c.lanes=i.lanes,Gl(i,c,w)}return I1(i,c,d,p,w)}function xy(i,c,d,p){var w=p.children,k=i!==null?i.memoizedState:null;if(i===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((c.flags&128)!==0){if(k=k!==null?k.baseLanes|d:d,i!==null){for(p=c.child=i.child,w=0;p!==null;)w=w|p.lanes|p.childLanes,p=p.sibling;p=w&~k}else p=0,c.child=null;return yy(i,c,k,d,p)}if((d&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},i!==null&&ye(c,k!==null?k.cachePool:null),k!==null?Pa(c,k):ea(),cn(c);else return p=c.lanes=536870912,yy(i,c,k!==null?k.baseLanes|d:d,d,p)}else k!==null?(ye(c,k.cachePool),Pa(c,k),un(),c.memoizedState=null):(i!==null&&ye(c,null),ea(),un());return ps(i,c,w,d),c.child}function Td(i,c){return i!==null&&i.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function yy(i,c,d,p,w){var k=me();return k=k===null?null:{parent:Qa._currentValue,pool:k},c.memoizedState={baseLanes:d,cachePool:k},i!==null&&ye(c,null),ea(),cn(c),i!==null&&ul(i,c,p,!0),c.childLanes=w,null}function hm(i,c){return c=mm({mode:c.mode,children:c.children},i.mode),c.ref=i.ref,i.child=c,c.return=i,c}function _y(i,c,d){return Ca(c,i.child,null,d),i=hm(c,c.pendingProps),i.flags|=2,ha(c),c.memoizedState=null,i}function dj(i,c,d){var p=c.pendingProps,w=(c.flags&128)!==0;if(c.flags&=-129,i===null){if(Ir){if(p.mode==="hidden")return i=hm(c,p),c.lanes=536870912,Td(null,i);if(ca(c),(i=Aa)?(i=R_(i,$a),i=i!==null&&i.data==="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:il!==null?{id:ri,overflow:ai}:null,retryLane:536870912,hydrationErrors:null},d=Kf(i),d.return=c,c.child=d,zn=c,Aa=null)):i=null,i===null)throw ol(c);return c.lanes=536870912,null}return hm(c,p)}var k=i.memoizedState;if(k!==null){var G=k.dehydrated;if(ca(c),w)if(c.flags&256)c.flags&=-257,c=_y(i,c,d);else if(c.memoizedState!==null)c.child=i.child,c.flags|=128,c=null;else throw Error(a(558));else if(Rn||ul(i,c,d,!1),w=(d&i.childLanes)!==0,Rn||w){if(p=Ta,p!==null&&(G=Xa(p,d),G!==0&&G!==k.retryLane))throw k.retryLane=G,Do(i,G),ui(p,i,G),M1;Sm(),c=_y(i,c,d)}else i=k.treeContext,Aa=ro(G.nextSibling),zn=c,Ir=!0,ds=null,$a=!1,i!==null&&rm(c,i),c=hm(c,p),c.flags|=4096;return c}return i=Zs(i.child,{mode:p.mode,children:p.children}),i.ref=c.ref,c.child=i,i.return=c,i}function dm(i,c){var d=c.ref;if(d===null)i!==null&&i.ref!==null&&(c.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(a(284));(i===null||i.ref!==d)&&(c.flags|=4194816)}}function I1(i,c,d,p,w){return fl(c),d=bd(i,c,d,p,void 0,w),p=wd(),i!==null&&!Rn?(Sd(i,c,w),Gl(i,c,w)):(Ir&&p&&vd(c),c.flags|=1,ps(i,c,d,w),c.child)}function by(i,c,d,p,w,k){return fl(c),c.updateQueue=null,d=Lo(c,p,d,w),sh(i),p=wd(),i!==null&&!Rn?(Sd(i,c,k),Gl(i,c,k)):(Ir&&p&&vd(c),c.flags|=1,ps(i,c,d,k),c.child)}function wy(i,c,d,p,w){if(fl(c),c.stateNode===null){var k=qn,G=d.contextType;typeof G=="object"&&G!==null&&(k=$n(G)),k=new d(p,k),c.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=L1,c.stateNode=k,k._reactInternals=c,k=c.stateNode,k.props=p,k.state=c.memoizedState,k.refs={},Ut(c),G=d.contextType,k.context=typeof G=="object"&&G!==null?$n(G):qn,k.state=c.memoizedState,G=d.getDerivedStateFromProps,typeof G=="function"&&(F1(c,d,G,p),k.state=c.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(G=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),G!==k.state&&L1.enqueueReplaceState(k,k.state,null),on(c,p,k,w),ba(),k.state=c.memoizedState),typeof k.componentDidMount=="function"&&(c.flags|=4194308),p=!0}else if(i===null){k=c.stateNode;var fe=c.memoizedProps,Te=Vu(d,fe);k.props=Te;var Qe=k.context,ct=d.contextType;G=qn,typeof ct=="object"&&ct!==null&&(G=$n(ct));var gt=d.getDerivedStateFromProps;ct=typeof gt=="function"||typeof k.getSnapshotBeforeUpdate=="function",fe=c.pendingProps!==fe,ct||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(fe||Qe!==G)&&ly(c,k,p,G),Vt=!1;var et=c.memoizedState;k.state=et,on(c,p,k,w),ba(),Qe=c.memoizedState,fe||et!==Qe||Vt?(typeof gt=="function"&&(F1(c,d,gt,p),Qe=c.memoizedState),(Te=Vt||oy(c,d,Te,p,et,Qe,G))?(ct||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(c.flags|=4194308)):(typeof k.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=p,c.memoizedState=Qe),k.props=p,k.state=Qe,k.context=G,p=Te):(typeof k.componentDidMount=="function"&&(c.flags|=4194308),p=!1)}else{k=c.stateNode,La(i,c),G=c.memoizedProps,ct=Vu(d,G),k.props=ct,gt=c.pendingProps,et=k.context,Qe=d.contextType,Te=qn,typeof Qe=="object"&&Qe!==null&&(Te=$n(Qe)),fe=d.getDerivedStateFromProps,(Qe=typeof fe=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(G!==gt||et!==Te)&&ly(c,k,p,Te),Vt=!1,et=c.memoizedState,k.state=et,on(c,p,k,w),ba();var nt=c.memoizedState;G!==gt||et!==nt||Vt||i!==null&&i.dependencies!==null&&th(i.dependencies)?(typeof fe=="function"&&(F1(c,d,fe,p),nt=c.memoizedState),(ct=Vt||oy(c,d,ct,p,et,nt,Te)||i!==null&&i.dependencies!==null&&th(i.dependencies))?(Qe||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(p,nt,Te),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(p,nt,Te)),typeof k.componentDidUpdate=="function"&&(c.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof k.componentDidUpdate!="function"||G===i.memoizedProps&&et===i.memoizedState||(c.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||G===i.memoizedProps&&et===i.memoizedState||(c.flags|=1024),c.memoizedProps=p,c.memoizedState=nt),k.props=p,k.state=nt,k.context=Te,p=ct):(typeof k.componentDidUpdate!="function"||G===i.memoizedProps&&et===i.memoizedState||(c.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||G===i.memoizedProps&&et===i.memoizedState||(c.flags|=1024),p=!1)}return k=p,dm(i,c),p=(c.flags&128)!==0,k||p?(k=c.stateNode,d=p&&typeof d.getDerivedStateFromError!="function"?null:k.render(),c.flags|=1,i!==null&&p?(c.child=Ca(c,i.child,null,w),c.child=Ca(c,null,d,w)):ps(i,c,d,w),c.memoizedState=k.state,i=c.child):i=Gl(i,c,w),i}function Sy(i,c,d,p){return zl(),c.flags|=256,ps(i,c,d,p),c.child}var B1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function U1(i){return{baseLanes:i,cachePool:ke()}}function q1(i,c,d){return i=i!==null?i.childLanes&~d:0,c&&(i|=Ei),i}function Ny(i,c,d){var p=c.pendingProps,w=!1,k=(c.flags&128)!==0,G;if((G=k)||(G=i!==null&&i.memoizedState===null?!1:(Gr.current&2)!==0),G&&(w=!0,c.flags&=-129),G=(c.flags&32)!==0,c.flags&=-33,i===null){if(Ir){if(w?en(c):un(),(i=Aa)?(i=R_(i,$a),i=i!==null&&i.data!=="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:il!==null?{id:ri,overflow:ai}:null,retryLane:536870912,hydrationErrors:null},d=Kf(i),d.return=c,c.child=d,zn=c,Aa=null)):i=null,i===null)throw ol(c);return Sg(i)?c.lanes=32:c.lanes=536870912,null}var fe=p.children;return p=p.fallback,w?(un(),w=c.mode,fe=mm({mode:"hidden",children:fe},w),p=sl(p,w,d,null),fe.return=c,p.return=c,fe.sibling=p,c.child=fe,p=c.child,p.memoizedState=U1(d),p.childLanes=q1(i,G,d),c.memoizedState=B1,Td(null,p)):(en(c),z1(c,fe))}var Te=i.memoizedState;if(Te!==null&&(fe=Te.dehydrated,fe!==null)){if(k)c.flags&256?(en(c),c.flags&=-257,c=H1(i,c,d)):c.memoizedState!==null?(un(),c.child=i.child,c.flags|=128,c=null):(un(),fe=p.fallback,w=c.mode,p=mm({mode:"visible",children:p.children},w),fe=sl(fe,w,d,null),fe.flags|=2,p.return=c,fe.return=c,p.sibling=fe,c.child=p,Ca(c,i.child,null,d),p=c.child,p.memoizedState=U1(d),p.childLanes=q1(i,G,d),c.memoizedState=B1,c=Td(null,p));else if(en(c),Sg(fe)){if(G=fe.nextSibling&&fe.nextSibling.dataset,G)var Qe=G.dgst;G=Qe,p=Error(a(419)),p.stack="",p.digest=G,Dc({value:p,source:null,stack:null}),c=H1(i,c,d)}else if(Rn||ul(i,c,d,!1),G=(d&i.childLanes)!==0,Rn||G){if(G=Ta,G!==null&&(p=Xa(G,d),p!==0&&p!==Te.retryLane))throw Te.retryLane=p,Do(i,p),ui(G,i,p),M1;wg(fe)||Sm(),c=H1(i,c,d)}else wg(fe)?(c.flags|=192,c.child=i.child,c=null):(i=Te.treeContext,Aa=ro(fe.nextSibling),zn=c,Ir=!0,ds=null,$a=!1,i!==null&&rm(c,i),c=z1(c,p.children),c.flags|=4096);return c}return w?(un(),fe=p.fallback,w=c.mode,Te=i.child,Qe=Te.sibling,p=Zs(Te,{mode:"hidden",children:p.children}),p.subtreeFlags=Te.subtreeFlags&65011712,Qe!==null?fe=Zs(Qe,fe):(fe=sl(fe,w,d,null),fe.flags|=2),fe.return=c,p.return=c,p.sibling=fe,c.child=p,Td(null,p),p=c.child,fe=i.child.memoizedState,fe===null?fe=U1(d):(w=fe.cachePool,w!==null?(Te=Qa._currentValue,w=w.parent!==Te?{parent:Te,pool:Te}:w):w=ke(),fe={baseLanes:fe.baseLanes|d,cachePool:w}),p.memoizedState=fe,p.childLanes=q1(i,G,d),c.memoizedState=B1,Td(i.child,p)):(en(c),d=i.child,i=d.sibling,d=Zs(d,{mode:"visible",children:p.children}),d.return=c,d.sibling=null,i!==null&&(G=c.deletions,G===null?(c.deletions=[i],c.flags|=16):G.push(i)),c.child=d,c.memoizedState=null,d)}function z1(i,c){return c=mm({mode:"visible",children:c},i.mode),c.return=i,i.child=c}function mm(i,c){return i=es(22,i,null,c),i.lanes=0,i}function H1(i,c,d){return Ca(c,i.child,null,d),i=z1(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function ky(i,c,d){i.lanes|=c;var p=i.alternate;p!==null&&(p.lanes|=c),Fc(i.return,c,d)}function $1(i,c,d,p,w,k){var G=i.memoizedState;G===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:w,treeForkCount:k}:(G.isBackwards=c,G.rendering=null,G.renderingStartTime=0,G.last=p,G.tail=d,G.tailMode=w,G.treeForkCount=k)}function jy(i,c,d){var p=c.pendingProps,w=p.revealOrder,k=p.tail;p=p.children;var G=Gr.current,fe=(G&2)!==0;if(fe?(G=G&1|2,c.flags|=128):G&=1,D(Gr,G),ps(i,c,p,d),p=Ir?qu:0,!fe&&i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&ky(i,d,c);else if(i.tag===19)ky(i,d,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(w){case"forwards":for(d=c.child,w=null;d!==null;)i=d.alternate,i!==null&&rs(i)===null&&(w=d),d=d.sibling;d=w,d===null?(w=c.child,c.child=null):(w=d.sibling,d.sibling=null),$1(c,!1,w,d,k,p);break;case"backwards":case"unstable_legacy-backwards":for(d=null,w=c.child,c.child=null;w!==null;){if(i=w.alternate,i!==null&&rs(i)===null){c.child=w;break}i=w.sibling,w.sibling=d,d=w,w=i}$1(c,!0,d,null,k,p);break;case"together":$1(c,!1,null,null,void 0,p);break;default:c.memoizedState=null}return c.child}function Gl(i,c,d){if(i!==null&&(c.dependencies=i.dependencies),zc|=c.lanes,(d&c.childLanes)===0)if(i!==null){if(ul(i,c,d,!1),(d&c.childLanes)===0)return null}else return null;if(i!==null&&c.child!==i.child)throw Error(a(153));if(c.child!==null){for(i=c.child,d=Zs(i,i.pendingProps),c.child=d,d.return=c;i.sibling!==null;)i=i.sibling,d=d.sibling=Zs(i,i.pendingProps),d.return=c;d.sibling=null}return c.child}function W1(i,c){return(i.lanes&c)!==0?!0:(i=i.dependencies,!!(i!==null&&th(i)))}function mj(i,c,d){switch(c.tag){case 3:pe(c,c.stateNode.containerInfo),cl(c,Qa,i.memoizedState.cache),zl();break;case 27:case 5:be(c);break;case 4:pe(c,c.stateNode.containerInfo);break;case 10:cl(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,ca(c),null;break;case 13:var p=c.memoizedState;if(p!==null)return p.dehydrated!==null?(en(c),c.flags|=128,null):(d&c.child.childLanes)!==0?Ny(i,c,d):(en(c),i=Gl(i,c,d),i!==null?i.sibling:null);en(c);break;case 19:var w=(i.flags&128)!==0;if(p=(d&c.childLanes)!==0,p||(ul(i,c,d,!1),p=(d&c.childLanes)!==0),w){if(p)return jy(i,c,d);c.flags|=128}if(w=c.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),D(Gr,Gr.current),p)break;return null;case 22:return c.lanes=0,xy(i,c,d,c.pendingProps);case 24:cl(c,Qa,i.memoizedState.cache)}return Gl(i,c,d)}function Ey(i,c,d){if(i!==null)if(i.memoizedProps!==c.pendingProps)Rn=!0;else{if(!W1(i,d)&&(c.flags&128)===0)return Rn=!1,mj(i,c,d);Rn=(i.flags&131072)!==0}else Rn=!1,Ir&&(c.flags&1048576)!==0&&tm(c,qu,c.index);switch(c.lanes=0,c.tag){case 16:e:{var p=c.pendingProps;if(i=Ve(c.elementType),c.type=i,typeof i=="function")Xf(i)?(p=Vu(i,p),c.tag=1,c=wy(null,c,i,p,d)):(c.tag=0,c=I1(null,c,i,p,d));else{if(i!=null){var w=i.$$typeof;if(w===R){c.tag=11,c=py(null,c,i,p,d);break e}else if(w===U){c.tag=14,c=gy(null,c,i,p,d);break e}}throw c=W(i)||i,Error(a(306,c,""))}}return c;case 0:return I1(i,c,c.type,c.pendingProps,d);case 1:return p=c.type,w=Vu(p,c.pendingProps),wy(i,c,p,w,d);case 3:e:{if(pe(c,c.stateNode.containerInfo),i===null)throw Error(a(387));p=c.pendingProps;var k=c.memoizedState;w=k.element,La(i,c),on(c,p,null,d);var G=c.memoizedState;if(p=G.cache,cl(c,Qa,p),p!==k.cache&&Hl(c,[Qa],d,!0),ba(),p=G.element,k.isDehydrated)if(k={element:p,isDehydrated:!1,cache:G.cache},c.updateQueue.baseState=k,c.memoizedState=k,c.flags&256){c=Sy(i,c,p,d);break e}else if(p!==w){w=Qs(Error(a(424)),c),Dc(w),c=Sy(i,c,p,d);break e}else{switch(i=c.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Aa=ro(i.firstChild),zn=c,Ir=!0,ds=null,$a=!0,d=jr(c,null,p,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(zl(),p===w){c=Gl(i,c,d);break e}ps(i,c,p,d)}c=c.child}return c;case 26:return dm(i,c),i===null?(d=I_(c.type,null,c.pendingProps,null))?c.memoizedState=d:Ir||(d=c.type,i=c.pendingProps,p=Tm(Z.current).createElement(d),p[xe]=c,p[Se]=i,gs(p,d,i),Yt(p),c.stateNode=p):c.memoizedState=I_(c.type,i.memoizedProps,c.pendingProps,i.memoizedState),null;case 27:return be(c),i===null&&Ir&&(p=c.stateNode=L_(c.type,c.pendingProps,Z.current),zn=c,$a=!0,w=Aa,Gc(c.type)?(Ng=w,Aa=ro(p.firstChild)):Aa=w),ps(i,c,c.pendingProps.children,d),dm(i,c),i===null&&(c.flags|=4194304),c.child;case 5:return i===null&&Ir&&((w=p=Aa)&&(p=$j(p,c.type,c.pendingProps,$a),p!==null?(c.stateNode=p,zn=c,Aa=ro(p.firstChild),$a=!1,w=!0):w=!1),w||ol(c)),be(c),w=c.type,k=c.pendingProps,G=i!==null?i.memoizedProps:null,p=k.children,yg(w,k)?p=null:G!==null&&yg(w,G)&&(c.flags|=32),c.memoizedState!==null&&(w=bd(i,c,j1,null,null,d),Wd._currentValue=w),dm(i,c),ps(i,c,p,d),c.child;case 6:return i===null&&Ir&&((i=d=Aa)&&(d=Wj(d,c.pendingProps,$a),d!==null?(c.stateNode=d,zn=c,Aa=null,i=!0):i=!1),i||ol(c)),null;case 13:return Ny(i,c,d);case 4:return pe(c,c.stateNode.containerInfo),p=c.pendingProps,i===null?c.child=Ca(c,null,p,d):ps(i,c,p,d),c.child;case 11:return py(i,c,c.type,c.pendingProps,d);case 7:return ps(i,c,c.pendingProps,d),c.child;case 8:return ps(i,c,c.pendingProps.children,d),c.child;case 12:return ps(i,c,c.pendingProps.children,d),c.child;case 10:return p=c.pendingProps,cl(c,c.type,p.value),ps(i,c,p.children,d),c.child;case 9:return w=c.type._context,p=c.pendingProps.children,fl(c),w=$n(w),p=p(w),c.flags|=1,ps(i,c,p,d),c.child;case 14:return gy(i,c,c.type,c.pendingProps,d);case 15:return vy(i,c,c.type,c.pendingProps,d);case 19:return jy(i,c,d);case 31:return dj(i,c,d);case 22:return xy(i,c,d,c.pendingProps);case 24:return fl(c),p=$n(Qa),i===null?(w=me(),w===null&&(w=Ta,k=Lc(),w.pooledCache=k,k.refCount++,k!==null&&(w.pooledCacheLanes|=d),w=k),c.memoizedState={parent:p,cache:w},Ut(c),cl(c,Qa,w)):((i.lanes&d)!==0&&(La(i,c),on(c,null,null,d),ba()),w=i.memoizedState,k=c.memoizedState,w.parent!==p?(w={parent:p,cache:p},c.memoizedState=w,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=w),cl(c,Qa,p)):(p=k.cache,cl(c,Qa,p),p!==w.cache&&Hl(c,[Qa],d,!0))),ps(i,c,c.pendingProps.children,d),c.child;case 29:throw c.pendingProps}throw Error(a(156,c.tag))}function Yl(i){i.flags|=4}function V1(i,c,d,p,w){if((c=(i.mode&32)!==0)&&(c=!1),c){if(i.flags|=16777216,(w&335544128)===w)if(i.stateNode.complete)i.flags|=8192;else if(e_())i.flags|=8192;else throw it=Me,Xe}else i.flags&=-16777217}function Ay(i,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!H_(c))if(e_())i.flags|=8192;else throw it=Me,Xe}function pm(i,c){c!==null&&(i.flags|=4),i.flags&16384&&(c=i.tag!==22?Ct():536870912,i.lanes|=c,gh|=c)}function Od(i,c){if(!Ir)switch(i.tailMode){case"hidden":c=i.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?i.tail=null:d.sibling=null;break;case"collapsed":d=i.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Ia(i){var c=i.alternate!==null&&i.alternate.child===i.child,d=0,p=0;if(c)for(var w=i.child;w!==null;)d|=w.lanes|w.childLanes,p|=w.subtreeFlags&65011712,p|=w.flags&65011712,w.return=i,w=w.sibling;else for(w=i.child;w!==null;)d|=w.lanes|w.childLanes,p|=w.subtreeFlags,p|=w.flags,w.return=i,w=w.sibling;return i.subtreeFlags|=p,i.childLanes=d,c}function pj(i,c,d){var p=c.pendingProps;switch(Qf(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ia(c),null;case 1:return Ia(c),null;case 3:return d=c.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),ni(Qa),_e(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(i===null||i.child===null)&&(Hn(c)?Yl(c):i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,yd())),Ia(c),null;case 26:var w=c.type,k=c.memoizedState;return i===null?(Yl(c),k!==null?(Ia(c),Ay(c,k)):(Ia(c),V1(c,w,null,p,d))):k?k!==i.memoizedState?(Yl(c),Ia(c),Ay(c,k)):(Ia(c),c.flags&=-16777217):(i=i.memoizedProps,i!==p&&Yl(c),Ia(c),V1(c,w,i,p,d)),null;case 27:if(Le(c),d=Z.current,w=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==p&&Yl(c);else{if(!p){if(c.stateNode===null)throw Error(a(166));return Ia(c),null}i=B.current,Hn(c)?xd(c):(i=L_(w,p,d),c.stateNode=i,Yl(c))}return Ia(c),null;case 5:if(Le(c),w=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==p&&Yl(c);else{if(!p){if(c.stateNode===null)throw Error(a(166));return Ia(c),null}if(k=B.current,Hn(c))xd(c);else{var G=Tm(Z.current);switch(k){case 1:k=G.createElementNS("http://www.w3.org/2000/svg",w);break;case 2:k=G.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;default:switch(w){case"svg":k=G.createElementNS("http://www.w3.org/2000/svg",w);break;case"math":k=G.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;case"script":k=G.createElement("div"),k.innerHTML="<script><\/script>",k=k.removeChild(k.firstChild);break;case"select":k=typeof p.is=="string"?G.createElement("select",{is:p.is}):G.createElement("select"),p.multiple?k.multiple=!0:p.size&&(k.size=p.size);break;default:k=typeof p.is=="string"?G.createElement(w,{is:p.is}):G.createElement(w)}}k[xe]=c,k[Se]=p;e:for(G=c.child;G!==null;){if(G.tag===5||G.tag===6)k.appendChild(G.stateNode);else if(G.tag!==4&&G.tag!==27&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===c)break e;for(;G.sibling===null;){if(G.return===null||G.return===c)break e;G=G.return}G.sibling.return=G.return,G=G.sibling}c.stateNode=k;e:switch(gs(k,w,p),w){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Yl(c)}}return Ia(c),V1(c,c.type,i===null?null:i.memoizedProps,c.pendingProps,d),null;case 6:if(i&&c.stateNode!=null)i.memoizedProps!==p&&Yl(c);else{if(typeof p!="string"&&c.stateNode===null)throw Error(a(166));if(i=Z.current,Hn(c)){if(i=c.stateNode,d=c.memoizedProps,p=null,w=zn,w!==null)switch(w.tag){case 27:case 5:p=w.memoizedProps}i[xe]=c,i=!!(i.nodeValue===d||p!==null&&p.suppressHydrationWarning===!0||N_(i.nodeValue,d)),i||ol(c,!0)}else i=Tm(i).createTextNode(p),i[xe]=c,c.stateNode=i}return Ia(c),null;case 31:if(d=c.memoizedState,i===null||i.memoizedState!==null){if(p=Hn(c),d!==null){if(i===null){if(!p)throw Error(a(318));if(i=c.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(557));i[xe]=c}else zl(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Ia(c),i=!1}else d=yd(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=d),i=!0;if(!i)return c.flags&256?(ha(c),c):(ha(c),null);if((c.flags&128)!==0)throw Error(a(558))}return Ia(c),null;case 13:if(p=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(w=Hn(c),p!==null&&p.dehydrated!==null){if(i===null){if(!w)throw Error(a(318));if(w=c.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(a(317));w[xe]=c}else zl(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Ia(c),w=!1}else w=yd(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=w),w=!0;if(!w)return c.flags&256?(ha(c),c):(ha(c),null)}return ha(c),(c.flags&128)!==0?(c.lanes=d,c):(d=p!==null,i=i!==null&&i.memoizedState!==null,d&&(p=c.child,w=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(w=p.alternate.memoizedState.cachePool.pool),k=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(k=p.memoizedState.cachePool.pool),k!==w&&(p.flags|=2048)),d!==i&&d&&(c.child.flags|=8192),pm(c,c.updateQueue),Ia(c),null);case 4:return _e(),i===null&&mg(c.stateNode.containerInfo),Ia(c),null;case 10:return ni(c.type),Ia(c),null;case 19:if(A(Gr),p=c.memoizedState,p===null)return Ia(c),null;if(w=(c.flags&128)!==0,k=p.rendering,k===null)if(w)Od(p,!1);else{if(hn!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(k=rs(i),k!==null){for(c.flags|=128,Od(p,!1),i=k.updateQueue,c.updateQueue=i,pm(c,i),c.subtreeFlags=0,i=d,d=c.child;d!==null;)Bu(d,i),d=d.sibling;return D(Gr,Gr.current&1|2),Ir&&$s(c,p.treeForkCount),c.child}i=i.sibling}p.tail!==null&&at()>_m&&(c.flags|=128,w=!0,Od(p,!1),c.lanes=4194304)}else{if(!w)if(i=rs(k),i!==null){if(c.flags|=128,w=!0,i=i.updateQueue,c.updateQueue=i,pm(c,i),Od(p,!0),p.tail===null&&p.tailMode==="hidden"&&!k.alternate&&!Ir)return Ia(c),null}else 2*at()-p.renderingStartTime>_m&&d!==536870912&&(c.flags|=128,w=!0,Od(p,!1),c.lanes=4194304);p.isBackwards?(k.sibling=c.child,c.child=k):(i=p.last,i!==null?i.sibling=k:c.child=k,p.last=k)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=at(),i.sibling=null,d=Gr.current,D(Gr,w?d&1|2:d&1),Ir&&$s(c,p.treeForkCount),i):(Ia(c),null);case 22:case 23:return ha(c),_n(),p=c.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(c.flags|=8192):p&&(c.flags|=8192),p?(d&536870912)!==0&&(c.flags&128)===0&&(Ia(c),c.subtreeFlags&6&&(c.flags|=8192)):Ia(c),d=c.updateQueue,d!==null&&pm(c,d.retryQueue),d=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==d&&(c.flags|=2048),i!==null&&A(ce),null;case 24:return d=null,i!==null&&(d=i.memoizedState.cache),c.memoizedState.cache!==d&&(c.flags|=2048),ni(Qa),Ia(c),null;case 25:return null;case 30:return null}throw Error(a(156,c.tag))}function gj(i,c){switch(Qf(c),c.tag){case 1:return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return ni(Qa),_e(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 26:case 27:case 5:return Le(c),null;case 31:if(c.memoizedState!==null){if(ha(c),c.alternate===null)throw Error(a(340));zl()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 13:if(ha(c),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(a(340));zl()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return A(Gr),null;case 4:return _e(),null;case 10:return ni(c.type),null;case 22:case 23:return ha(c),_n(),i!==null&&A(ce),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 24:return ni(Qa),null;case 25:return null;default:return null}}function Cy(i,c){switch(Qf(c),c.tag){case 3:ni(Qa),_e();break;case 26:case 27:case 5:Le(c);break;case 4:_e();break;case 31:c.memoizedState!==null&&ha(c);break;case 13:ha(c);break;case 19:A(Gr);break;case 10:ni(c.type);break;case 22:case 23:ha(c),_n(),i!==null&&A(ce);break;case 24:ni(Qa)}}function Rd(i,c){try{var d=c.updateQueue,p=d!==null?d.lastEffect:null;if(p!==null){var w=p.next;d=w;do{if((d.tag&i)===i){p=void 0;var k=d.create,G=d.inst;p=k(),G.destroy=p}d=d.next}while(d!==w)}}catch(fe){ma(c,c.return,fe)}}function Uc(i,c,d){try{var p=c.updateQueue,w=p!==null?p.lastEffect:null;if(w!==null){var k=w.next;p=k;do{if((p.tag&i)===i){var G=p.inst,fe=G.destroy;if(fe!==void 0){G.destroy=void 0,w=c;var Te=d,Qe=fe;try{Qe()}catch(ct){ma(w,Te,ct)}}}p=p.next}while(p!==k)}}catch(ct){ma(c,c.return,ct)}}function Ty(i){var c=i.updateQueue;if(c!==null){var d=i.stateNode;try{ln(c,d)}catch(p){ma(i,i.return,p)}}}function Oy(i,c,d){d.props=Vu(i.type,i.memoizedProps),d.state=i.memoizedState;try{d.componentWillUnmount()}catch(p){ma(i,c,p)}}function Dd(i,c){try{var d=i.ref;if(d!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof d=="function"?i.refCleanup=d(p):d.current=p}}catch(w){ma(i,c,w)}}function gl(i,c){var d=i.ref,p=i.refCleanup;if(d!==null)if(typeof p=="function")try{p()}catch(w){ma(i,c,w)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(w){ma(i,c,w)}else d.current=null}function Ry(i){var c=i.type,d=i.memoizedProps,p=i.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":d.autoFocus&&p.focus();break e;case"img":d.src?p.src=d.src:d.srcSet&&(p.srcset=d.srcSet)}}catch(w){ma(i,i.return,w)}}function G1(i,c,d){try{var p=i.stateNode;Ij(p,i.type,d,c),p[Se]=c}catch(w){ma(i,i.return,w)}}function Dy(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Gc(i.type)||i.tag===4}function Y1(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Dy(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Gc(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function X1(i,c,d){var p=i.tag;if(p===5||p===6)i=i.stateNode,c?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(i,c):(c=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,c.appendChild(i),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=yi));else if(p!==4&&(p===27&&Gc(i.type)&&(d=i.stateNode,c=null),i=i.child,i!==null))for(X1(i,c,d),i=i.sibling;i!==null;)X1(i,c,d),i=i.sibling}function gm(i,c,d){var p=i.tag;if(p===5||p===6)i=i.stateNode,c?d.insertBefore(i,c):d.appendChild(i);else if(p!==4&&(p===27&&Gc(i.type)&&(d=i.stateNode),i=i.child,i!==null))for(gm(i,c,d),i=i.sibling;i!==null;)gm(i,c,d),i=i.sibling}function Fy(i){var c=i.stateNode,d=i.memoizedProps;try{for(var p=i.type,w=c.attributes;w.length;)c.removeAttributeNode(w[0]);gs(c,p,d),c[xe]=i,c[Se]=d}catch(k){ma(i,i.return,k)}}var Xl=!1,Dn=!1,K1=!1,Ly=typeof WeakSet=="function"?WeakSet:Set,as=null;function vj(i,c){if(i=i.containerInfo,vg=Mm,i=Oo(i),Ji(i)){if("selectionStart"in i)var d={start:i.selectionStart,end:i.selectionEnd};else e:{d=(d=i.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var w=p.anchorOffset,k=p.focusNode;p=p.focusOffset;try{d.nodeType,k.nodeType}catch{d=null;break e}var G=0,fe=-1,Te=-1,Qe=0,ct=0,gt=i,et=null;t:for(;;){for(var nt;gt!==d||w!==0&&gt.nodeType!==3||(fe=G+w),gt!==k||p!==0&&gt.nodeType!==3||(Te=G+p),gt.nodeType===3&&(G+=gt.nodeValue.length),(nt=gt.firstChild)!==null;)et=gt,gt=nt;for(;;){if(gt===i)break t;if(et===d&&++Qe===w&&(fe=G),et===k&&++ct===p&&(Te=G),(nt=gt.nextSibling)!==null)break;gt=et,et=gt.parentNode}gt=nt}d=fe===-1||Te===-1?null:{start:fe,end:Te}}else d=null}d=d||{start:0,end:0}}else d=null;for(xg={focusedElem:i,selectionRange:d},Mm=!1,as=c;as!==null;)if(c=as,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,as=i;else for(;as!==null;){switch(c=as,k=c.alternate,i=c.flags,c.tag){case 0:if((i&4)!==0&&(i=c.updateQueue,i=i!==null?i.events:null,i!==null))for(d=0;d<i.length;d++)w=i[d],w.ref.impl=w.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&k!==null){i=void 0,d=c,w=k.memoizedProps,k=k.memoizedState,p=d.stateNode;try{var Zt=Vu(d.type,w);i=p.getSnapshotBeforeUpdate(Zt,k),p.__reactInternalSnapshotBeforeUpdate=i}catch(pr){ma(d,d.return,pr)}}break;case 3:if((i&1024)!==0){if(i=c.stateNode.containerInfo,d=i.nodeType,d===9)bg(i);else if(d===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":bg(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(a(163))}if(i=c.sibling,i!==null){i.return=c.return,as=i;break}as=c.return}}function Py(i,c,d){var p=d.flags;switch(d.tag){case 0:case 11:case 15:Jl(i,d),p&4&&Rd(5,d);break;case 1:if(Jl(i,d),p&4)if(i=d.stateNode,c===null)try{i.componentDidMount()}catch(G){ma(d,d.return,G)}else{var w=Vu(d.type,c.memoizedProps);c=c.memoizedState;try{i.componentDidUpdate(w,c,i.__reactInternalSnapshotBeforeUpdate)}catch(G){ma(d,d.return,G)}}p&64&&Ty(d),p&512&&Dd(d,d.return);break;case 3:if(Jl(i,d),p&64&&(i=d.updateQueue,i!==null)){if(c=null,d.child!==null)switch(d.child.tag){case 27:case 5:c=d.child.stateNode;break;case 1:c=d.child.stateNode}try{ln(i,c)}catch(G){ma(d,d.return,G)}}break;case 27:c===null&&p&4&&Fy(d);case 26:case 5:Jl(i,d),c===null&&p&4&&Ry(d),p&512&&Dd(d,d.return);break;case 12:Jl(i,d);break;case 31:Jl(i,d),p&4&&By(i,d);break;case 13:Jl(i,d),p&4&&Uy(i,d),p&64&&(i=d.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(d=jj.bind(null,d),Vj(i,d))));break;case 22:if(p=d.memoizedState!==null||Xl,!p){c=c!==null&&c.memoizedState!==null||Dn,w=Xl;var k=Dn;Xl=p,(Dn=c)&&!k?Zl(i,d,(d.subtreeFlags&8772)!==0):Jl(i,d),Xl=w,Dn=k}break;case 30:break;default:Jl(i,d)}}function My(i){var c=i.alternate;c!==null&&(i.alternate=null,My(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&Nt(c)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Ga=null,ii=!1;function Kl(i,c,d){for(d=d.child;d!==null;)Iy(i,c,d),d=d.sibling}function Iy(i,c,d){if(Bt&&typeof Bt.onCommitFiberUnmount=="function")try{Bt.onCommitFiberUnmount(Lt,d)}catch{}switch(d.tag){case 26:Dn||gl(d,c),Kl(i,c,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Dn||gl(d,c);var p=Ga,w=ii;Gc(d.type)&&(Ga=d.stateNode,ii=!1),Kl(i,c,d),zd(d.stateNode),Ga=p,ii=w;break;case 5:Dn||gl(d,c);case 6:if(p=Ga,w=ii,Ga=null,Kl(i,c,d),Ga=p,ii=w,Ga!==null)if(ii)try{(Ga.nodeType===9?Ga.body:Ga.nodeName==="HTML"?Ga.ownerDocument.body:Ga).removeChild(d.stateNode)}catch(k){ma(d,c,k)}else try{Ga.removeChild(d.stateNode)}catch(k){ma(d,c,k)}break;case 18:Ga!==null&&(ii?(i=Ga,T_(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,d.stateNode),Nh(i)):T_(Ga,d.stateNode));break;case 4:p=Ga,w=ii,Ga=d.stateNode.containerInfo,ii=!0,Kl(i,c,d),Ga=p,ii=w;break;case 0:case 11:case 14:case 15:Uc(2,d,c),Dn||Uc(4,d,c),Kl(i,c,d);break;case 1:Dn||(gl(d,c),p=d.stateNode,typeof p.componentWillUnmount=="function"&&Oy(d,c,p)),Kl(i,c,d);break;case 21:Kl(i,c,d);break;case 22:Dn=(p=Dn)||d.memoizedState!==null,Kl(i,c,d),Dn=p;break;default:Kl(i,c,d)}}function By(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Nh(i)}catch(d){ma(c,c.return,d)}}}function Uy(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Nh(i)}catch(d){ma(c,c.return,d)}}function xj(i){switch(i.tag){case 31:case 13:case 19:var c=i.stateNode;return c===null&&(c=i.stateNode=new Ly),c;case 22:return i=i.stateNode,c=i._retryCache,c===null&&(c=i._retryCache=new Ly),c;default:throw Error(a(435,i.tag))}}function vm(i,c){var d=xj(i);c.forEach(function(p){if(!d.has(p)){d.add(p);var w=Ej.bind(null,i,p);p.then(w,w)}})}function oi(i,c){var d=c.deletions;if(d!==null)for(var p=0;p<d.length;p++){var w=d[p],k=i,G=c,fe=G;e:for(;fe!==null;){switch(fe.tag){case 27:if(Gc(fe.type)){Ga=fe.stateNode,ii=!1;break e}break;case 5:Ga=fe.stateNode,ii=!1;break e;case 3:case 4:Ga=fe.stateNode.containerInfo,ii=!0;break e}fe=fe.return}if(Ga===null)throw Error(a(160));Iy(k,G,w),Ga=null,ii=!1,k=w.alternate,k!==null&&(k.return=null),w.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)qy(c,i),c=c.sibling}var Bo=null;function qy(i,c){var d=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:oi(c,i),li(i),p&4&&(Uc(3,i,i.return),Rd(3,i),Uc(5,i,i.return));break;case 1:oi(c,i),li(i),p&512&&(Dn||d===null||gl(d,d.return)),p&64&&Xl&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(d=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=d===null?p:d.concat(p))));break;case 26:var w=Bo;if(oi(c,i),li(i),p&512&&(Dn||d===null||gl(d,d.return)),p&4){var k=d!==null?d.memoizedState:null;if(p=i.memoizedState,d===null)if(p===null)if(i.stateNode===null){e:{p=i.type,d=i.memoizedProps,w=w.ownerDocument||w;t:switch(p){case"title":k=w.getElementsByTagName("title")[0],(!k||k[Je]||k[xe]||k.namespaceURI==="http://www.w3.org/2000/svg"||k.hasAttribute("itemprop"))&&(k=w.createElement(p),w.head.insertBefore(k,w.querySelector("head > title"))),gs(k,p,d),k[xe]=i,Yt(k),p=k;break e;case"link":var G=q_("link","href",w).get(p+(d.href||""));if(G){for(var fe=0;fe<G.length;fe++)if(k=G[fe],k.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&k.getAttribute("rel")===(d.rel==null?null:d.rel)&&k.getAttribute("title")===(d.title==null?null:d.title)&&k.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){G.splice(fe,1);break t}}k=w.createElement(p),gs(k,p,d),w.head.appendChild(k);break;case"meta":if(G=q_("meta","content",w).get(p+(d.content||""))){for(fe=0;fe<G.length;fe++)if(k=G[fe],k.getAttribute("content")===(d.content==null?null:""+d.content)&&k.getAttribute("name")===(d.name==null?null:d.name)&&k.getAttribute("property")===(d.property==null?null:d.property)&&k.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&k.getAttribute("charset")===(d.charSet==null?null:d.charSet)){G.splice(fe,1);break t}}k=w.createElement(p),gs(k,p,d),w.head.appendChild(k);break;default:throw Error(a(468,p))}k[xe]=i,Yt(k),p=k}i.stateNode=p}else z_(w,i.type,i.stateNode);else i.stateNode=U_(w,p,i.memoizedProps);else k!==p?(k===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):k.count--,p===null?z_(w,i.type,i.stateNode):U_(w,p,i.memoizedProps)):p===null&&i.stateNode!==null&&G1(i,i.memoizedProps,d.memoizedProps)}break;case 27:oi(c,i),li(i),p&512&&(Dn||d===null||gl(d,d.return)),d!==null&&p&4&&G1(i,i.memoizedProps,d.memoizedProps);break;case 5:if(oi(c,i),li(i),p&512&&(Dn||d===null||gl(d,d.return)),i.flags&32){w=i.stateNode;try{xi(w,"")}catch(Zt){ma(i,i.return,Zt)}}p&4&&i.stateNode!=null&&(w=i.memoizedProps,G1(i,w,d!==null?d.memoizedProps:w)),p&1024&&(K1=!0);break;case 6:if(oi(c,i),li(i),p&4){if(i.stateNode===null)throw Error(a(162));p=i.memoizedProps,d=i.stateNode;try{d.nodeValue=p}catch(Zt){ma(i,i.return,Zt)}}break;case 3:if(Dm=null,w=Bo,Bo=Om(c.containerInfo),oi(c,i),Bo=w,li(i),p&4&&d!==null&&d.memoizedState.isDehydrated)try{Nh(c.containerInfo)}catch(Zt){ma(i,i.return,Zt)}K1&&(K1=!1,zy(i));break;case 4:p=Bo,Bo=Om(i.stateNode.containerInfo),oi(c,i),li(i),Bo=p;break;case 12:oi(c,i),li(i);break;case 31:oi(c,i),li(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,vm(i,p)));break;case 13:oi(c,i),li(i),i.child.flags&8192&&i.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(ym=at()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,vm(i,p)));break;case 22:w=i.memoizedState!==null;var Te=d!==null&&d.memoizedState!==null,Qe=Xl,ct=Dn;if(Xl=Qe||w,Dn=ct||Te,oi(c,i),Dn=ct,Xl=Qe,li(i),p&8192)e:for(c=i.stateNode,c._visibility=w?c._visibility&-2:c._visibility|1,w&&(d===null||Te||Xl||Dn||Gu(i)),d=null,c=i;;){if(c.tag===5||c.tag===26){if(d===null){Te=d=c;try{if(k=Te.stateNode,w)G=k.style,typeof G.setProperty=="function"?G.setProperty("display","none","important"):G.display="none";else{fe=Te.stateNode;var gt=Te.memoizedProps.style,et=gt!=null&&gt.hasOwnProperty("display")?gt.display:null;fe.style.display=et==null||typeof et=="boolean"?"":(""+et).trim()}}catch(Zt){ma(Te,Te.return,Zt)}}}else if(c.tag===6){if(d===null){Te=c;try{Te.stateNode.nodeValue=w?"":Te.memoizedProps}catch(Zt){ma(Te,Te.return,Zt)}}}else if(c.tag===18){if(d===null){Te=c;try{var nt=Te.stateNode;w?O_(nt,!0):O_(Te.stateNode,!1)}catch(Zt){ma(Te,Te.return,Zt)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===i)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break e;for(;c.sibling===null;){if(c.return===null||c.return===i)break e;d===c&&(d=null),c=c.return}d===c&&(d=null),c.sibling.return=c.return,c=c.sibling}p&4&&(p=i.updateQueue,p!==null&&(d=p.retryQueue,d!==null&&(p.retryQueue=null,vm(i,d))));break;case 19:oi(c,i),li(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,vm(i,p)));break;case 30:break;case 21:break;default:oi(c,i),li(i)}}function li(i){var c=i.flags;if(c&2){try{for(var d,p=i.return;p!==null;){if(Dy(p)){d=p;break}p=p.return}if(d==null)throw Error(a(160));switch(d.tag){case 27:var w=d.stateNode,k=Y1(i);gm(i,k,w);break;case 5:var G=d.stateNode;d.flags&32&&(xi(G,""),d.flags&=-33);var fe=Y1(i);gm(i,fe,G);break;case 3:case 4:var Te=d.stateNode.containerInfo,Qe=Y1(i);X1(i,Qe,Te);break;default:throw Error(a(161))}}catch(ct){ma(i,i.return,ct)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function zy(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var c=i;zy(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),i=i.sibling}}function Jl(i,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)Py(i,c.alternate,c),c=c.sibling}function Gu(i){for(i=i.child;i!==null;){var c=i;switch(c.tag){case 0:case 11:case 14:case 15:Uc(4,c,c.return),Gu(c);break;case 1:gl(c,c.return);var d=c.stateNode;typeof d.componentWillUnmount=="function"&&Oy(c,c.return,d),Gu(c);break;case 27:zd(c.stateNode);case 26:case 5:gl(c,c.return),Gu(c);break;case 22:c.memoizedState===null&&Gu(c);break;case 30:Gu(c);break;default:Gu(c)}i=i.sibling}}function Zl(i,c,d){for(d=d&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var p=c.alternate,w=i,k=c,G=k.flags;switch(k.tag){case 0:case 11:case 15:Zl(w,k,d),Rd(4,k);break;case 1:if(Zl(w,k,d),p=k,w=p.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(Qe){ma(p,p.return,Qe)}if(p=k,w=p.updateQueue,w!==null){var fe=p.stateNode;try{var Te=w.shared.hiddenCallbacks;if(Te!==null)for(w.shared.hiddenCallbacks=null,w=0;w<Te.length;w++)ts(Te[w],fe)}catch(Qe){ma(p,p.return,Qe)}}d&&G&64&&Ty(k),Dd(k,k.return);break;case 27:Fy(k);case 26:case 5:Zl(w,k,d),d&&p===null&&G&4&&Ry(k),Dd(k,k.return);break;case 12:Zl(w,k,d);break;case 31:Zl(w,k,d),d&&G&4&&By(w,k);break;case 13:Zl(w,k,d),d&&G&4&&Uy(w,k);break;case 22:k.memoizedState===null&&Zl(w,k,d),Dd(k,k.return);break;case 30:break;default:Zl(w,k,d)}c=c.sibling}}function J1(i,c){var d=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),i=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(i=c.memoizedState.cachePool.pool),i!==d&&(i!=null&&i.refCount++,d!=null&&zu(d))}function Z1(i,c){i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&zu(i))}function Uo(i,c,d,p){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)Hy(i,c,d,p),c=c.sibling}function Hy(i,c,d,p){var w=c.flags;switch(c.tag){case 0:case 11:case 15:Uo(i,c,d,p),w&2048&&Rd(9,c);break;case 1:Uo(i,c,d,p);break;case 3:Uo(i,c,d,p),w&2048&&(i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&zu(i)));break;case 12:if(w&2048){Uo(i,c,d,p),i=c.stateNode;try{var k=c.memoizedProps,G=k.id,fe=k.onPostCommit;typeof fe=="function"&&fe(G,c.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Te){ma(c,c.return,Te)}}else Uo(i,c,d,p);break;case 31:Uo(i,c,d,p);break;case 13:Uo(i,c,d,p);break;case 23:break;case 22:k=c.stateNode,G=c.alternate,c.memoizedState!==null?k._visibility&2?Uo(i,c,d,p):Fd(i,c):k._visibility&2?Uo(i,c,d,p):(k._visibility|=2,dh(i,c,d,p,(c.subtreeFlags&10256)!==0||!1)),w&2048&&J1(G,c);break;case 24:Uo(i,c,d,p),w&2048&&Z1(c.alternate,c);break;default:Uo(i,c,d,p)}}function dh(i,c,d,p,w){for(w=w&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var k=i,G=c,fe=d,Te=p,Qe=G.flags;switch(G.tag){case 0:case 11:case 15:dh(k,G,fe,Te,w),Rd(8,G);break;case 23:break;case 22:var ct=G.stateNode;G.memoizedState!==null?ct._visibility&2?dh(k,G,fe,Te,w):Fd(k,G):(ct._visibility|=2,dh(k,G,fe,Te,w)),w&&Qe&2048&&J1(G.alternate,G);break;case 24:dh(k,G,fe,Te,w),w&&Qe&2048&&Z1(G.alternate,G);break;default:dh(k,G,fe,Te,w)}c=c.sibling}}function Fd(i,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var d=i,p=c,w=p.flags;switch(p.tag){case 22:Fd(d,p),w&2048&&J1(p.alternate,p);break;case 24:Fd(d,p),w&2048&&Z1(p.alternate,p);break;default:Fd(d,p)}c=c.sibling}}var Ld=8192;function mh(i,c,d){if(i.subtreeFlags&Ld)for(i=i.child;i!==null;)$y(i,c,d),i=i.sibling}function $y(i,c,d){switch(i.tag){case 26:mh(i,c,d),i.flags&Ld&&i.memoizedState!==null&&nE(d,Bo,i.memoizedState,i.memoizedProps);break;case 5:mh(i,c,d);break;case 3:case 4:var p=Bo;Bo=Om(i.stateNode.containerInfo),mh(i,c,d),Bo=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=Ld,Ld=16777216,mh(i,c,d),Ld=p):mh(i,c,d));break;default:mh(i,c,d)}}function Wy(i){var c=i.alternate;if(c!==null&&(i=c.child,i!==null)){c.child=null;do c=i.sibling,i.sibling=null,i=c;while(i!==null)}}function Pd(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var d=0;d<c.length;d++){var p=c[d];as=p,Gy(p,i)}Wy(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Vy(i),i=i.sibling}function Vy(i){switch(i.tag){case 0:case 11:case 15:Pd(i),i.flags&2048&&Uc(9,i,i.return);break;case 3:Pd(i);break;case 12:Pd(i);break;case 22:var c=i.stateNode;i.memoizedState!==null&&c._visibility&2&&(i.return===null||i.return.tag!==13)?(c._visibility&=-3,xm(i)):Pd(i);break;default:Pd(i)}}function xm(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var d=0;d<c.length;d++){var p=c[d];as=p,Gy(p,i)}Wy(i)}for(i=i.child;i!==null;){switch(c=i,c.tag){case 0:case 11:case 15:Uc(8,c,c.return),xm(c);break;case 22:d=c.stateNode,d._visibility&2&&(d._visibility&=-3,xm(c));break;default:xm(c)}i=i.sibling}}function Gy(i,c){for(;as!==null;){var d=as;switch(d.tag){case 0:case 11:case 15:Uc(8,d,c);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var p=d.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:zu(d.memoizedState.cache)}if(p=d.child,p!==null)p.return=d,as=p;else e:for(d=i;as!==null;){p=as;var w=p.sibling,k=p.return;if(My(p),p===d){as=null;break e}if(w!==null){w.return=k,as=w;break e}as=k}}}var yj={getCacheForType:function(i){var c=$n(Qa),d=c.data.get(i);return d===void 0&&(d=i(),c.data.set(i,d)),d},cacheSignal:function(){return $n(Qa).controller.signal}},_j=typeof WeakMap=="function"?WeakMap:Map,ua=0,Ta=null,Br=null,zr=0,da=0,ji=null,qc=!1,ph=!1,Q1=!1,Ql=0,hn=0,zc=0,Yu=0,eg=0,Ei=0,gh=0,Md=null,ci=null,tg=!1,ym=0,Yy=0,_m=1/0,bm=null,Hc=null,Vn=0,$c=null,vh=null,ec=0,rg=0,ag=null,Xy=null,Id=0,ng=null;function Ai(){return(ua&2)!==0&&zr!==0?zr&-zr:Q.T!==null?ug():ae()}function Ky(){if(Ei===0)if((zr&536870912)===0||Ir){var i=Ht;Ht<<=1,(Ht&3932160)===0&&(Ht=262144),Ei=i}else Ei=536870912;return i=Ma.current,i!==null&&(i.flags|=32),Ei}function ui(i,c,d){(i===Ta&&(da===2||da===9)||i.cancelPendingCommit!==null)&&(xh(i,0),Wc(i,zr,Ei,!1)),_t(i,d),((ua&2)===0||i!==Ta)&&(i===Ta&&((ua&2)===0&&(Yu|=d),hn===4&&Wc(i,zr,Ei,!1)),vl(i))}function Jy(i,c,d){if((ua&6)!==0)throw Error(a(327));var p=!d&&(c&127)===0&&(c&i.expiredLanes)===0||Jn(i,c),w=p?Sj(i,c):ig(i,c,!0),k=p;do{if(w===0){ph&&!p&&Wc(i,c,0,!1);break}else{if(d=i.current.alternate,k&&!bj(d)){w=ig(i,c,!1),k=!1;continue}if(w===2){if(k=c,i.errorRecoveryDisabledLanes&k)var G=0;else G=i.pendingLanes&-536870913,G=G!==0?G:G&536870912?536870912:0;if(G!==0){c=G;e:{var fe=i;w=Md;var Te=fe.current.memoizedState.isDehydrated;if(Te&&(xh(fe,G).flags|=256),G=ig(fe,G,!1),G!==2){if(Q1&&!Te){fe.errorRecoveryDisabledLanes|=k,Yu|=k,w=4;break e}k=ci,ci=w,k!==null&&(ci===null?ci=k:ci.push.apply(ci,k))}w=G}if(k=!1,w!==2)continue}}if(w===1){xh(i,0),Wc(i,c,0,!0);break}e:{switch(p=i,k=w,k){case 0:case 1:throw Error(a(345));case 4:if((c&4194048)!==c)break;case 6:Wc(p,c,Ei,!qc);break e;case 2:ci=null;break;case 3:case 5:break;default:throw Error(a(329))}if((c&62914560)===c&&(w=ym+300-at(),10<w)){if(Wc(p,c,Ei,!qc),Nr(p,0,!0)!==0)break e;ec=c,p.timeoutHandle=A_(Zy.bind(null,p,d,ci,bm,tg,c,Ei,Yu,gh,qc,k,"Throttled",-0,0),w);break e}Zy(p,d,ci,bm,tg,c,Ei,Yu,gh,qc,k,null,-0,0)}}break}while(!0);vl(i)}function Zy(i,c,d,p,w,k,G,fe,Te,Qe,ct,gt,et,nt){if(i.timeoutHandle=-1,gt=c.subtreeFlags,gt&8192||(gt&16785408)===16785408){gt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:yi},$y(c,k,gt);var Zt=(k&62914560)===k?ym-at():(k&4194048)===k?Yy-at():0;if(Zt=sE(gt,Zt),Zt!==null){ec=k,i.cancelPendingCommit=Zt(i_.bind(null,i,c,k,d,p,w,G,fe,Te,ct,gt,null,et,nt)),Wc(i,k,G,!Qe);return}}i_(i,c,k,d,p,w,G,fe,Te)}function bj(i){for(var c=i;;){var d=c.tag;if((d===0||d===11||d===15)&&c.flags&16384&&(d=c.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var p=0;p<d.length;p++){var w=d[p],k=w.getSnapshot;w=w.value;try{if(!Un(k(),w))return!1}catch{return!1}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Wc(i,c,d,p){c&=~eg,c&=~Yu,i.suspendedLanes|=c,i.pingedLanes&=~c,p&&(i.warmLanes|=c),p=i.expirationTimes;for(var w=c;0<w;){var k=31-Ie(w),G=1<<k;p[k]=-1,w&=~G}d!==0&&Jr(i,d,c)}function wm(){return(ua&6)===0?(Bd(0),!1):!0}function sg(){if(Br!==null){if(da===0)var i=Br.return;else i=Br,Qi=ll=null,ih(i),vt=null,tr=0,i=Br;for(;i!==null;)Cy(i.alternate,i),i=i.return;Br=null}}function xh(i,c){var d=i.timeoutHandle;d!==-1&&(i.timeoutHandle=-1,qj(d)),d=i.cancelPendingCommit,d!==null&&(i.cancelPendingCommit=null,d()),ec=0,sg(),Ta=i,Br=d=Zs(i.current,null),zr=c,da=0,ji=null,qc=!1,ph=Jn(i,c),Q1=!1,gh=Ei=eg=Yu=zc=hn=0,ci=Md=null,tg=!1,(c&8)!==0&&(c|=c&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=c;0<p;){var w=31-Ie(p),k=1<<w;c|=i[w],p&=~k}return Ql=c,Pu(),d}function Qy(i,c){lr=null,Q.H=Cd,c===De||c===Ne?(c=dt(),da=3):c===Xe?(c=dt(),da=4):da=c===M1?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,ji=c,Br===null&&(hn=1,fm(i,Qs(c,i.current)))}function e_(){var i=Ma.current;return i===null?!0:(zr&4194048)===zr?Xr===null:(zr&62914560)===zr||(zr&536870912)!==0?i===Xr:!1}function t_(){var i=Q.H;return Q.H=Cd,i===null?Cd:i}function r_(){var i=Q.A;return Q.A=yj,i}function Sm(){hn=4,qc||(zr&4194048)!==zr&&Ma.current!==null||(ph=!0),(zc&134217727)===0&&(Yu&134217727)===0||Ta===null||Wc(Ta,zr,Ei,!1)}function ig(i,c,d){var p=ua;ua|=2;var w=t_(),k=r_();(Ta!==i||zr!==c)&&(bm=null,xh(i,c)),c=!1;var G=hn;e:do try{if(da!==0&&Br!==null){var fe=Br,Te=ji;switch(da){case 8:sg(),G=6;break e;case 3:case 2:case 9:case 6:Ma.current===null&&(c=!0);var Qe=da;if(da=0,ji=null,yh(i,fe,Te,Qe),d&&ph){G=0;break e}break;default:Qe=da,da=0,ji=null,yh(i,fe,Te,Qe)}}wj(),G=hn;break}catch(ct){Qy(i,ct)}while(!0);return c&&i.shellSuspendCounter++,Qi=ll=null,ua=p,Q.H=w,Q.A=k,Br===null&&(Ta=null,zr=0,Pu()),G}function wj(){for(;Br!==null;)a_(Br)}function Sj(i,c){var d=ua;ua|=2;var p=t_(),w=r_();Ta!==i||zr!==c?(bm=null,_m=at()+500,xh(i,c)):ph=Jn(i,c);e:do try{if(da!==0&&Br!==null){c=Br;var k=ji;t:switch(da){case 1:da=0,ji=null,yh(i,c,k,1);break;case 2:case 9:if(He(k)){da=0,ji=null,n_(c);break}c=function(){da!==2&&da!==9||Ta!==i||(da=7),vl(i)},k.then(c,c);break e;case 3:da=7;break e;case 4:da=5;break e;case 7:He(k)?(da=0,ji=null,n_(c)):(da=0,ji=null,yh(i,c,k,7));break;case 5:var G=null;switch(Br.tag){case 26:G=Br.memoizedState;case 5:case 27:var fe=Br;if(G?H_(G):fe.stateNode.complete){da=0,ji=null;var Te=fe.sibling;if(Te!==null)Br=Te;else{var Qe=fe.return;Qe!==null?(Br=Qe,Nm(Qe)):Br=null}break t}}da=0,ji=null,yh(i,c,k,5);break;case 6:da=0,ji=null,yh(i,c,k,6);break;case 8:sg(),hn=6;break e;default:throw Error(a(462))}}Nj();break}catch(ct){Qy(i,ct)}while(!0);return Qi=ll=null,Q.H=p,Q.A=w,ua=d,Br!==null?0:(Ta=null,zr=0,Pu(),hn)}function Nj(){for(;Br!==null&&!zt();)a_(Br)}function a_(i){var c=Ey(i.alternate,i,Ql);i.memoizedProps=i.pendingProps,c===null?Nm(i):Br=c}function n_(i){var c=i,d=c.alternate;switch(c.tag){case 15:case 0:c=by(d,c,c.pendingProps,c.type,void 0,zr);break;case 11:c=by(d,c,c.pendingProps,c.type.render,c.ref,zr);break;case 5:ih(c);default:Cy(d,c),c=Br=Bu(c,Ql),c=Ey(d,c,Ql)}i.memoizedProps=i.pendingProps,c===null?Nm(i):Br=c}function yh(i,c,d,p){Qi=ll=null,ih(c),vt=null,tr=0;var w=c.return;try{if(hj(i,w,c,d,zr)){hn=1,fm(i,Qs(d,i.current)),Br=null;return}}catch(k){if(w!==null)throw Br=w,k;hn=1,fm(i,Qs(d,i.current)),Br=null;return}c.flags&32768?(Ir||p===1?i=!0:ph||(zr&536870912)!==0?i=!1:(qc=i=!0,(p===2||p===9||p===3||p===6)&&(p=Ma.current,p!==null&&p.tag===13&&(p.flags|=16384))),s_(c,i)):Nm(c)}function Nm(i){var c=i;do{if((c.flags&32768)!==0){s_(c,qc);return}i=c.return;var d=pj(c.alternate,c,Ql);if(d!==null){Br=d;return}if(c=c.sibling,c!==null){Br=c;return}Br=c=i}while(c!==null);hn===0&&(hn=5)}function s_(i,c){do{var d=gj(i.alternate,i);if(d!==null){d.flags&=32767,Br=d;return}if(d=i.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!c&&(i=i.sibling,i!==null)){Br=i;return}Br=i=d}while(i!==null);hn=6,Br=null}function i_(i,c,d,p,w,k,G,fe,Te){i.cancelPendingCommit=null;do km();while(Vn!==0);if((ua&6)!==0)throw Error(a(327));if(c!==null){if(c===i.current)throw Error(a(177));if(k=c.lanes|c.childLanes,k|=Vf,mr(i,d,k,G,fe,Te),i===Ta&&(Br=Ta=null,zr=0),vh=c,$c=i,ec=d,rg=k,ag=w,Xy=p,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Aj(xt,function(){return f_(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||p){p=Q.T,Q.T=null,w=le.p,le.p=2,G=ua,ua|=4;try{vj(i,c,d)}finally{ua=G,le.p=w,Q.T=p}}Vn=1,o_(),l_(),c_()}}function o_(){if(Vn===1){Vn=0;var i=$c,c=vh,d=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||d){d=Q.T,Q.T=null;var p=le.p;le.p=2;var w=ua;ua|=4;try{qy(c,i);var k=xg,G=Oo(i.containerInfo),fe=k.focusedElem,Te=k.selectionRange;if(G!==fe&&fe&&fe.ownerDocument&&To(fe.ownerDocument.documentElement,fe)){if(Te!==null&&Ji(fe)){var Qe=Te.start,ct=Te.end;if(ct===void 0&&(ct=Qe),"selectionStart"in fe)fe.selectionStart=Qe,fe.selectionEnd=Math.min(ct,fe.value.length);else{var gt=fe.ownerDocument||document,et=gt&&gt.defaultView||window;if(et.getSelection){var nt=et.getSelection(),Zt=fe.textContent.length,pr=Math.min(Te.start,Zt),Na=Te.end===void 0?pr:Math.min(Te.end,Zt);!nt.extend&&pr>Na&&(G=Na,Na=pr,pr=G);var ze=Cc(fe,pr),Fe=Cc(fe,Na);if(ze&&Fe&&(nt.rangeCount!==1||nt.anchorNode!==ze.node||nt.anchorOffset!==ze.offset||nt.focusNode!==Fe.node||nt.focusOffset!==Fe.offset)){var Ze=gt.createRange();Ze.setStart(ze.node,ze.offset),nt.removeAllRanges(),pr>Na?(nt.addRange(Ze),nt.extend(Fe.node,Fe.offset)):(Ze.setEnd(Fe.node,Fe.offset),nt.addRange(Ze))}}}}for(gt=[],nt=fe;nt=nt.parentNode;)nt.nodeType===1&&gt.push({element:nt,left:nt.scrollLeft,top:nt.scrollTop});for(typeof fe.focus=="function"&&fe.focus(),fe=0;fe<gt.length;fe++){var mt=gt[fe];mt.element.scrollLeft=mt.left,mt.element.scrollTop=mt.top}}Mm=!!vg,xg=vg=null}finally{ua=w,le.p=p,Q.T=d}}i.current=c,Vn=2}}function l_(){if(Vn===2){Vn=0;var i=$c,c=vh,d=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||d){d=Q.T,Q.T=null;var p=le.p;le.p=2;var w=ua;ua|=4;try{Py(i,c.alternate,c)}finally{ua=w,le.p=p,Q.T=d}}Vn=3}}function c_(){if(Vn===4||Vn===3){Vn=0,Tt();var i=$c,c=vh,d=ec,p=Xy;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Vn=5:(Vn=0,vh=$c=null,u_(i,i.pendingLanes));var w=i.pendingLanes;if(w===0&&(Hc=null),Ea(d),c=c.stateNode,Bt&&typeof Bt.onCommitFiberRoot=="function")try{Bt.onCommitFiberRoot(Lt,c,void 0,(c.current.flags&128)===128)}catch{}if(p!==null){c=Q.T,w=le.p,le.p=2,Q.T=null;try{for(var k=i.onRecoverableError,G=0;G<p.length;G++){var fe=p[G];k(fe.value,{componentStack:fe.stack})}}finally{Q.T=c,le.p=w}}(ec&3)!==0&&km(),vl(i),w=i.pendingLanes,(d&261930)!==0&&(w&42)!==0?i===ng?Id++:(Id=0,ng=i):Id=0,Bd(0)}}function u_(i,c){(i.pooledCacheLanes&=c)===0&&(c=i.pooledCache,c!=null&&(i.pooledCache=null,zu(c)))}function km(){return o_(),l_(),c_(),f_()}function f_(){if(Vn!==5)return!1;var i=$c,c=rg;rg=0;var d=Ea(ec),p=Q.T,w=le.p;try{le.p=32>d?32:d,Q.T=null,d=ag,ag=null;var k=$c,G=ec;if(Vn=0,vh=$c=null,ec=0,(ua&6)!==0)throw Error(a(331));var fe=ua;if(ua|=4,Vy(k.current),Hy(k,k.current,G,d),ua=fe,Bd(0,!1),Bt&&typeof Bt.onPostCommitFiberRoot=="function")try{Bt.onPostCommitFiberRoot(Lt,k)}catch{}return!0}finally{le.p=w,Q.T=p,u_(i,c)}}function h_(i,c,d){c=Qs(d,c),c=P1(i.stateNode,c,2),i=Cr(i,c,2),i!==null&&(_t(i,2),vl(i))}function ma(i,c,d){if(i.tag===3)h_(i,i,d);else for(;c!==null;){if(c.tag===3){h_(c,i,d);break}else if(c.tag===1){var p=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Hc===null||!Hc.has(p))){i=Qs(d,i),d=dy(2),p=Cr(c,d,2),p!==null&&(my(d,p,c,i),_t(p,2),vl(p));break}}c=c.return}}function og(i,c,d){var p=i.pingCache;if(p===null){p=i.pingCache=new _j;var w=new Set;p.set(c,w)}else w=p.get(c),w===void 0&&(w=new Set,p.set(c,w));w.has(d)||(Q1=!0,w.add(d),i=kj.bind(null,i,c,d),c.then(i,i))}function kj(i,c,d){var p=i.pingCache;p!==null&&p.delete(c),i.pingedLanes|=i.suspendedLanes&d,i.warmLanes&=~d,Ta===i&&(zr&d)===d&&(hn===4||hn===3&&(zr&62914560)===zr&&300>at()-ym?(ua&2)===0&&xh(i,0):eg|=d,gh===zr&&(gh=0)),vl(i)}function d_(i,c){c===0&&(c=Ct()),i=Do(i,c),i!==null&&(_t(i,c),vl(i))}function jj(i){var c=i.memoizedState,d=0;c!==null&&(d=c.retryLane),d_(i,d)}function Ej(i,c){var d=0;switch(i.tag){case 31:case 13:var p=i.stateNode,w=i.memoizedState;w!==null&&(d=w.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(a(314))}p!==null&&p.delete(c),d_(i,d)}function Aj(i,c){return Et(i,c)}var jm=null,_h=null,lg=!1,Em=!1,cg=!1,Vc=0;function vl(i){i!==_h&&i.next===null&&(_h===null?jm=_h=i:_h=_h.next=i),Em=!0,lg||(lg=!0,Tj())}function Bd(i,c){if(!cg&&Em){cg=!0;do for(var d=!1,p=jm;p!==null;){if(i!==0){var w=p.pendingLanes;if(w===0)var k=0;else{var G=p.suspendedLanes,fe=p.pingedLanes;k=(1<<31-Ie(42|i)+1)-1,k&=w&~(G&~fe),k=k&201326741?k&201326741|1:k?k|2:0}k!==0&&(d=!0,v_(p,k))}else k=zr,k=Nr(p,p===Ta?k:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(k&3)===0||Jn(p,k)||(d=!0,v_(p,k));p=p.next}while(d);cg=!1}}function Cj(){m_()}function m_(){Em=lg=!1;var i=0;Vc!==0&&Uj()&&(i=Vc);for(var c=at(),d=null,p=jm;p!==null;){var w=p.next,k=p_(p,c);k===0?(p.next=null,d===null?jm=w:d.next=w,w===null&&(_h=d)):(d=p,(i!==0||(k&3)!==0)&&(Em=!0)),p=w}Vn!==0&&Vn!==5||Bd(i),Vc!==0&&(Vc=0)}function p_(i,c){for(var d=i.suspendedLanes,p=i.pingedLanes,w=i.expirationTimes,k=i.pendingLanes&-62914561;0<k;){var G=31-Ie(k),fe=1<<G,Te=w[G];Te===-1?((fe&d)===0||(fe&p)!==0)&&(w[G]=ja(fe,c)):Te<=c&&(i.expiredLanes|=fe),k&=~fe}if(c=Ta,d=zr,d=Nr(i,i===c?d:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,d===0||i===c&&(da===2||da===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&kt(p),i.callbackNode=null,i.callbackPriority=0;if((d&3)===0||Jn(i,d)){if(c=d&-d,c===i.callbackPriority)return c;switch(p!==null&&kt(p),Ea(d)){case 2:case 8:d=Dt;break;case 32:d=xt;break;case 268435456:d=ft;break;default:d=xt}return p=g_.bind(null,i),d=Et(d,p),i.callbackPriority=c,i.callbackNode=d,c}return p!==null&&p!==null&&kt(p),i.callbackPriority=2,i.callbackNode=null,2}function g_(i,c){if(Vn!==0&&Vn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var d=i.callbackNode;if(km()&&i.callbackNode!==d)return null;var p=zr;return p=Nr(i,i===Ta?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(Jy(i,p,c),p_(i,at()),i.callbackNode!=null&&i.callbackNode===d?g_.bind(null,i):null)}function v_(i,c){if(km())return null;Jy(i,c,!0)}function Tj(){zj(function(){(ua&6)!==0?Et(At,Cj):m_()})}function ug(){if(Vc===0){var i=x;i===0&&(i=Rt,Rt<<=1,(Rt&261888)===0&&(Rt=256)),Vc=i}return Vc}function x_(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:bs(""+i)}function y_(i,c){var d=c.ownerDocument.createElement("input");return d.name=c.name,d.value=c.value,i.id&&d.setAttribute("form",i.id),c.parentNode.insertBefore(d,c),i=new FormData(i),d.parentNode.removeChild(d),i}function Oj(i,c,d,p,w){if(c==="submit"&&d&&d.stateNode===w){var k=x_((w[Se]||null).action),G=p.submitter;G&&(c=(c=G[Se]||null)?x_(c.formAction):G.getAttribute("formAction"),c!==null&&(k=c,G=null));var fe=new Xs("action","action",null,p,w);i.push({event:fe,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Vc!==0){var Te=G?y_(w,G):new FormData(w);T1(d,{pending:!0,data:Te,method:w.method,action:k},null,Te)}}else typeof k=="function"&&(fe.preventDefault(),Te=G?y_(w,G):new FormData(w),T1(d,{pending:!0,data:Te,method:w.method,action:k},k,Te))},currentTarget:w}]})}}for(var fg=0;fg<Bl.length;fg++){var hg=Bl[fg],Rj=hg.toLowerCase(),Dj=hg[0].toUpperCase()+hg.slice(1);Js(Rj,"on"+Dj)}Js(Il,"onAnimationEnd"),Js(Fu,"onAnimationIteration"),Js(md,"onAnimationStart"),Js("dblclick","onDoubleClick"),Js("focusin","onFocus"),Js("focusout","onBlur"),Js(Z0,"onTransitionRun"),Js(Q0,"onTransitionStart"),Js(em,"onTransitionCancel"),Js(pd,"onTransitionEnd"),ls("onMouseEnter",["mouseout","mouseover"]),ls("onMouseLeave",["mouseout","mouseover"]),ls("onPointerEnter",["pointerout","pointerover"]),ls("onPointerLeave",["pointerout","pointerover"]),fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fa("onBeforeInput",["compositionend","keypress","textInput","paste"]),fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ud="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ud));function __(i,c){c=(c&4)!==0;for(var d=0;d<i.length;d++){var p=i[d],w=p.event;p=p.listeners;e:{var k=void 0;if(c)for(var G=p.length-1;0<=G;G--){var fe=p[G],Te=fe.instance,Qe=fe.currentTarget;if(fe=fe.listener,Te!==k&&w.isPropagationStopped())break e;k=fe,w.currentTarget=Qe;try{k(w)}catch(ct){Lu(ct)}w.currentTarget=null,k=Te}else for(G=0;G<p.length;G++){if(fe=p[G],Te=fe.instance,Qe=fe.currentTarget,fe=fe.listener,Te!==k&&w.isPropagationStopped())break e;k=fe,w.currentTarget=Qe;try{k(w)}catch(ct){Lu(ct)}w.currentTarget=null,k=Te}}}}function Ur(i,c){var d=c[We];d===void 0&&(d=c[We]=new Set);var p=i+"__bubble";d.has(p)||(b_(c,i,2,!1),d.add(p))}function dg(i,c,d){var p=0;c&&(p|=4),b_(d,i,p,c)}var Am="_reactListening"+Math.random().toString(36).slice(2);function mg(i){if(!i[Am]){i[Am]=!0,oa.forEach(function(d){d!=="selectionchange"&&(Fj.has(d)||dg(d,!1,i),dg(d,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[Am]||(c[Am]=!0,dg("selectionchange",!1,c))}}function b_(i,c,d,p){switch(K_(c)){case 2:var w=lE;break;case 8:w=cE;break;default:w=Cg}d=w.bind(null,c,d,i),w=void 0,!Cu||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(w=!0),p?w!==void 0?i.addEventListener(c,d,{capture:!0,passive:w}):i.addEventListener(c,d,!0):w!==void 0?i.addEventListener(c,d,{passive:w}):i.addEventListener(c,d,!1)}function pg(i,c,d,p,w){var k=p;if((c&1)===0&&(c&2)===0&&p!==null)e:for(;;){if(p===null)return;var G=p.tag;if(G===3||G===4){var fe=p.stateNode.containerInfo;if(fe===w)break;if(G===4)for(G=p.return;G!==null;){var Te=G.tag;if((Te===3||Te===4)&&G.stateNode.containerInfo===w)return;G=G.return}for(;fe!==null;){if(G=Ft(fe),G===null)return;if(Te=G.tag,Te===5||Te===6||Te===26||Te===27){p=k=G;continue e}fe=fe.parentNode}}p=p.return}qf(function(){var Qe=k,ct=Ol(d),gt=[];e:{var et=gd.get(i);if(et!==void 0){var nt=Xs,Zt=i;switch(i){case"keypress":if(Ys(d)===0)break e;case"keydown":case"keyup":nt=Wr;break;case"focusin":Zt="focus",nt=wo;break;case"focusout":Zt="blur",nt=wo;break;case"beforeblur":case"afterblur":nt=wo;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=Tu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=bo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=xn;break;case Il:case Fu:case md:nt=T;break;case pd:nt=Bn;break;case"scroll":case"scrollend":nt=wc;break;case"wheel":nt=_i;break;case"copy":case"cut":case"paste":nt=Ee;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=Ka;break;case"toggle":case"beforetoggle":nt=Ou}var pr=(c&4)!==0,Na=!pr&&(i==="scroll"||i==="scrollend"),ze=pr?et!==null?et+"Capture":null:et;pr=[];for(var Fe=Qe,Ze;Fe!==null;){var mt=Fe;if(Ze=mt.stateNode,mt=mt.tag,mt!==5&&mt!==26&&mt!==27||Ze===null||ze===null||(mt=Bs(Fe,ze),mt!=null&&pr.push(qd(Fe,mt,Ze))),Na)break;Fe=Fe.return}0<pr.length&&(et=new nt(et,Zt,null,d,ct),gt.push({event:et,listeners:pr}))}}if((c&7)===0){e:{if(et=i==="mouseover"||i==="pointerover",nt=i==="mouseout"||i==="pointerout",et&&d!==go&&(Zt=d.relatedTarget||d.fromElement)&&(Ft(Zt)||Zt[Ce]))break e;if((nt||et)&&(et=ct.window===ct?ct:(et=ct.ownerDocument)?et.defaultView||et.parentWindow:window,nt?(Zt=d.relatedTarget||d.toElement,nt=Qe,Zt=Zt?Ft(Zt):null,Zt!==null&&(Na=s(Zt),pr=Zt.tag,Zt!==Na||pr!==5&&pr!==27&&pr!==6)&&(Zt=null)):(nt=null,Zt=Qe),nt!==Zt)){if(pr=Tu,mt="onMouseLeave",ze="onMouseEnter",Fe="mouse",(i==="pointerout"||i==="pointerover")&&(pr=Ka,mt="onPointerLeave",ze="onPointerEnter",Fe="pointer"),Na=nt==null?et:Ot(nt),Ze=Zt==null?et:Ot(Zt),et=new pr(mt,Fe+"leave",nt,d,ct),et.target=Na,et.relatedTarget=Ze,mt=null,Ft(ct)===Qe&&(pr=new pr(ze,Fe+"enter",Zt,d,ct),pr.target=Ze,pr.relatedTarget=Na,mt=pr),Na=mt,nt&&Zt)t:{for(pr=Lj,ze=nt,Fe=Zt,Ze=0,mt=ze;mt;mt=pr(mt))Ze++;mt=0;for(var ur=Fe;ur;ur=pr(ur))mt++;for(;0<Ze-mt;)ze=pr(ze),Ze--;for(;0<mt-Ze;)Fe=pr(Fe),mt--;for(;Ze--;){if(ze===Fe||Fe!==null&&ze===Fe.alternate){pr=ze;break t}ze=pr(ze),Fe=pr(Fe)}pr=null}else pr=null;nt!==null&&w_(gt,et,nt,pr,!1),Zt!==null&&Na!==null&&w_(gt,Na,Zt,pr,!0)}}e:{if(et=Qe?Ot(Qe):window,nt=et.nodeName&&et.nodeName.toLowerCase(),nt==="select"||nt==="input"&&et.type==="file")var aa=nl;else if(Ru(et))if(ws)aa=Xi;else{aa=Ja;var nr=Ec}else nt=et.nodeName,!nt||nt.toLowerCase()!=="input"||et.type!=="checkbox"&&et.type!=="radio"?Qe&&ju(Qe.elementType)&&(aa=nl):aa=Wf;if(aa&&(aa=aa(i,Qe))){qs(gt,aa,d,ct);break e}nr&&nr(i,et,Qe),i==="focusout"&&Qe&&et.type==="number"&&Qe.memoizedProps.value!=null&&Su(et,"number",et.value)}switch(nr=Qe?Ot(Qe):window,i){case"focusin":(Ru(nr)||nr.contentEditable==="true")&&(zs=nr,Ro=Qe,Zn=null);break;case"focusout":Zn=Ro=zs=null;break;case"mousedown":Ks=!0;break;case"contextmenu":case"mouseup":case"dragend":Ks=!1,Qr(gt,d,ct);break;case"selectionchange":if(Ml)break;case"keydown":case"keyup":Qr(gt,d,ct)}var Or;if(Wi)e:{switch(i){case"compositionstart":var Hr="onCompositionStart";break e;case"compositionend":Hr="onCompositionEnd";break e;case"compositionupdate":Hr="onCompositionUpdate";break e}Hr=void 0}else Vi?al(i,d)&&(Hr="onCompositionEnd"):i==="keydown"&&d.keyCode===229&&(Hr="onCompositionStart");Hr&&(ko&&d.locale!=="ko"&&(Vi||Hr!=="onCompositionStart"?Hr==="onCompositionEnd"&&Vi&&(Or=zf()):(Us=ct,Dl="value"in Us?Us.value:Us.textContent,Vi=!0)),nr=Cm(Qe,Hr),0<nr.length&&(Hr=new qe(Hr,i,null,d,ct),gt.push({event:Hr,listeners:nr}),Or?Hr.data=Or:(Or=Nc(d),Or!==null&&(Hr.data=Or)))),(Or=Pl?fs(i,d):jo(i,d))&&(Hr=Cm(Qe,"onBeforeInput"),0<Hr.length&&(nr=new qe("onBeforeInput","beforeinput",null,d,ct),gt.push({event:nr,listeners:Hr}),nr.data=Or)),Oj(gt,i,Qe,d,ct)}__(gt,c)})}function qd(i,c,d){return{instance:i,listener:c,currentTarget:d}}function Cm(i,c){for(var d=c+"Capture",p=[];i!==null;){var w=i,k=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||k===null||(w=Bs(i,d),w!=null&&p.unshift(qd(i,w,k)),w=Bs(i,c),w!=null&&p.push(qd(i,w,k))),i.tag===3)return p;i=i.return}return[]}function Lj(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function w_(i,c,d,p,w){for(var k=c._reactName,G=[];d!==null&&d!==p;){var fe=d,Te=fe.alternate,Qe=fe.stateNode;if(fe=fe.tag,Te!==null&&Te===p)break;fe!==5&&fe!==26&&fe!==27||Qe===null||(Te=Qe,w?(Qe=Bs(d,k),Qe!=null&&G.unshift(qd(d,Qe,Te))):w||(Qe=Bs(d,k),Qe!=null&&G.push(qd(d,Qe,Te)))),d=d.return}G.length!==0&&i.push({event:c,listeners:G})}var Pj=/\r\n?/g,Mj=/\u0000|\uFFFD/g;function S_(i){return(typeof i=="string"?i:""+i).replace(Pj,`
`).replace(Mj,"")}function N_(i,c){return c=S_(c),S_(i)===c}function Sa(i,c,d,p,w,k){switch(d){case"children":typeof p=="string"?c==="body"||c==="textarea"&&p===""||xi(i,p):(typeof p=="number"||typeof p=="bigint")&&c!=="body"&&xi(i,""+p);break;case"className":po(i,"class",p);break;case"tabIndex":po(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":po(i,d,p);break;case"style":If(i,p,k);break;case"data":if(c!=="object"){po(i,"data",p);break}case"src":case"href":if(p===""&&(c!=="a"||d!=="href")){i.removeAttribute(d);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(d);break}p=bs(""+p),i.setAttribute(d,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(d==="formAction"?(c!=="input"&&Sa(i,c,"name",w.name,w,null),Sa(i,c,"formEncType",w.formEncType,w,null),Sa(i,c,"formMethod",w.formMethod,w,null),Sa(i,c,"formTarget",w.formTarget,w,null)):(Sa(i,c,"encType",w.encType,w,null),Sa(i,c,"method",w.method,w,null),Sa(i,c,"target",w.target,w,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(d);break}p=bs(""+p),i.setAttribute(d,p);break;case"onClick":p!=null&&(i.onclick=yi);break;case"onScroll":p!=null&&Ur("scroll",i);break;case"onScrollEnd":p!=null&&Ur("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(d=p.__html,d!=null){if(w.children!=null)throw Error(a(60));i.innerHTML=d}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}d=bs(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(d,""+p):i.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(d,""):i.removeAttribute(d);break;case"capture":case"download":p===!0?i.setAttribute(d,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(d,p):i.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(d,p):i.removeAttribute(d);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(d):i.setAttribute(d,p);break;case"popover":Ur("beforetoggle",i),Ur("toggle",i),Da(i,"popover",p);break;case"xlinkActuate":vi(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":vi(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":vi(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":vi(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":vi(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":vi(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":vi(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":vi(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":vi(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Da(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=Eu.get(d)||d,Da(i,d,p))}}function gg(i,c,d,p,w,k){switch(d){case"style":If(i,p,k);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(d=p.__html,d!=null){if(w.children!=null)throw Error(a(60));i.innerHTML=d}}break;case"children":typeof p=="string"?xi(i,p):(typeof p=="number"||typeof p=="bigint")&&xi(i,""+p);break;case"onScroll":p!=null&&Ur("scroll",i);break;case"onScrollEnd":p!=null&&Ur("scrollend",i);break;case"onClick":p!=null&&(i.onclick=yi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Fr.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(w=d.endsWith("Capture"),c=d.slice(2,w?d.length-7:void 0),k=i[Se]||null,k=k!=null?k[d]:null,typeof k=="function"&&i.removeEventListener(c,k,w),typeof p=="function")){typeof k!="function"&&k!==null&&(d in i?i[d]=null:i.hasAttribute(d)&&i.removeAttribute(d)),i.addEventListener(c,p,w);break e}d in i?i[d]=p:p===!0?i.setAttribute(d,""):Da(i,d,p)}}}function gs(i,c,d){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ur("error",i),Ur("load",i);var p=!1,w=!1,k;for(k in d)if(d.hasOwnProperty(k)){var G=d[k];if(G!=null)switch(k){case"src":p=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,c));default:Sa(i,c,k,G,d,null)}}w&&Sa(i,c,"srcSet",d.srcSet,d,null),p&&Sa(i,c,"src",d.src,d,null);return;case"input":Ur("invalid",i);var fe=k=G=w=null,Te=null,Qe=null;for(p in d)if(d.hasOwnProperty(p)){var ct=d[p];if(ct!=null)switch(p){case"name":w=ct;break;case"type":G=ct;break;case"checked":Te=ct;break;case"defaultChecked":Qe=ct;break;case"value":k=ct;break;case"defaultValue":fe=ct;break;case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(a(137,c));break;default:Sa(i,c,p,ct,d,null)}}Pf(i,k,fe,Te,Qe,G,w,!1);return;case"select":Ur("invalid",i),p=G=k=null;for(w in d)if(d.hasOwnProperty(w)&&(fe=d[w],fe!=null))switch(w){case"value":k=fe;break;case"defaultValue":G=fe;break;case"multiple":p=fe;default:Sa(i,c,w,fe,d,null)}c=k,d=G,i.multiple=!!p,c!=null?us(i,!!p,c,!1):d!=null&&us(i,!!p,d,!0);return;case"textarea":Ur("invalid",i),k=w=p=null;for(G in d)if(d.hasOwnProperty(G)&&(fe=d[G],fe!=null))switch(G){case"value":p=fe;break;case"defaultValue":w=fe;break;case"children":k=fe;break;case"dangerouslySetInnerHTML":if(fe!=null)throw Error(a(91));break;default:Sa(i,c,G,fe,d,null)}ku(i,p,w,k);return;case"option":for(Te in d)if(d.hasOwnProperty(Te)&&(p=d[Te],p!=null))switch(Te){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Sa(i,c,Te,p,d,null)}return;case"dialog":Ur("beforetoggle",i),Ur("toggle",i),Ur("cancel",i),Ur("close",i);break;case"iframe":case"object":Ur("load",i);break;case"video":case"audio":for(p=0;p<Ud.length;p++)Ur(Ud[p],i);break;case"image":Ur("error",i),Ur("load",i);break;case"details":Ur("toggle",i);break;case"embed":case"source":case"link":Ur("error",i),Ur("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Qe in d)if(d.hasOwnProperty(Qe)&&(p=d[Qe],p!=null))switch(Qe){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,c));default:Sa(i,c,Qe,p,d,null)}return;default:if(ju(c)){for(ct in d)d.hasOwnProperty(ct)&&(p=d[ct],p!==void 0&&gg(i,c,ct,p,d,void 0));return}}for(fe in d)d.hasOwnProperty(fe)&&(p=d[fe],p!=null&&Sa(i,c,fe,p,d,null))}function Ij(i,c,d,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,k=null,G=null,fe=null,Te=null,Qe=null,ct=null;for(nt in d){var gt=d[nt];if(d.hasOwnProperty(nt)&&gt!=null)switch(nt){case"checked":break;case"value":break;case"defaultValue":Te=gt;default:p.hasOwnProperty(nt)||Sa(i,c,nt,null,p,gt)}}for(var et in p){var nt=p[et];if(gt=d[et],p.hasOwnProperty(et)&&(nt!=null||gt!=null))switch(et){case"type":k=nt;break;case"name":w=nt;break;case"checked":Qe=nt;break;case"defaultChecked":ct=nt;break;case"value":G=nt;break;case"defaultValue":fe=nt;break;case"children":case"dangerouslySetInnerHTML":if(nt!=null)throw Error(a(137,c));break;default:nt!==gt&&Sa(i,c,et,nt,p,gt)}}yc(i,G,fe,Te,Qe,ct,k,w);return;case"select":nt=G=fe=et=null;for(k in d)if(Te=d[k],d.hasOwnProperty(k)&&Te!=null)switch(k){case"value":break;case"multiple":nt=Te;default:p.hasOwnProperty(k)||Sa(i,c,k,null,p,Te)}for(w in p)if(k=p[w],Te=d[w],p.hasOwnProperty(w)&&(k!=null||Te!=null))switch(w){case"value":et=k;break;case"defaultValue":fe=k;break;case"multiple":G=k;default:k!==Te&&Sa(i,c,w,k,p,Te)}c=fe,d=G,p=nt,et!=null?us(i,!!d,et,!1):!!p!=!!d&&(c!=null?us(i,!!d,c,!0):us(i,!!d,d?[]:"",!1));return;case"textarea":nt=et=null;for(fe in d)if(w=d[fe],d.hasOwnProperty(fe)&&w!=null&&!p.hasOwnProperty(fe))switch(fe){case"value":break;case"children":break;default:Sa(i,c,fe,null,p,w)}for(G in p)if(w=p[G],k=d[G],p.hasOwnProperty(G)&&(w!=null||k!=null))switch(G){case"value":et=w;break;case"defaultValue":nt=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(a(91));break;default:w!==k&&Sa(i,c,G,w,p,k)}Nu(i,et,nt);return;case"option":for(var Zt in d)if(et=d[Zt],d.hasOwnProperty(Zt)&&et!=null&&!p.hasOwnProperty(Zt))switch(Zt){case"selected":i.selected=!1;break;default:Sa(i,c,Zt,null,p,et)}for(Te in p)if(et=p[Te],nt=d[Te],p.hasOwnProperty(Te)&&et!==nt&&(et!=null||nt!=null))switch(Te){case"selected":i.selected=et&&typeof et!="function"&&typeof et!="symbol";break;default:Sa(i,c,Te,et,p,nt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pr in d)et=d[pr],d.hasOwnProperty(pr)&&et!=null&&!p.hasOwnProperty(pr)&&Sa(i,c,pr,null,p,et);for(Qe in p)if(et=p[Qe],nt=d[Qe],p.hasOwnProperty(Qe)&&et!==nt&&(et!=null||nt!=null))switch(Qe){case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(a(137,c));break;default:Sa(i,c,Qe,et,p,nt)}return;default:if(ju(c)){for(var Na in d)et=d[Na],d.hasOwnProperty(Na)&&et!==void 0&&!p.hasOwnProperty(Na)&&gg(i,c,Na,void 0,p,et);for(ct in p)et=p[ct],nt=d[ct],!p.hasOwnProperty(ct)||et===nt||et===void 0&&nt===void 0||gg(i,c,ct,et,p,nt);return}}for(var ze in d)et=d[ze],d.hasOwnProperty(ze)&&et!=null&&!p.hasOwnProperty(ze)&&Sa(i,c,ze,null,p,et);for(gt in p)et=p[gt],nt=d[gt],!p.hasOwnProperty(gt)||et===nt||et==null&&nt==null||Sa(i,c,gt,et,p,nt)}function k_(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Bj(){if(typeof performance.getEntriesByType=="function"){for(var i=0,c=0,d=performance.getEntriesByType("resource"),p=0;p<d.length;p++){var w=d[p],k=w.transferSize,G=w.initiatorType,fe=w.duration;if(k&&fe&&k_(G)){for(G=0,fe=w.responseEnd,p+=1;p<d.length;p++){var Te=d[p],Qe=Te.startTime;if(Qe>fe)break;var ct=Te.transferSize,gt=Te.initiatorType;ct&&k_(gt)&&(Te=Te.responseEnd,G+=ct*(Te<fe?1:(fe-Qe)/(Te-Qe)))}if(--p,c+=8*(k+G)/(w.duration/1e3),i++,10<i)break}}if(0<i)return c/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var vg=null,xg=null;function Tm(i){return i.nodeType===9?i:i.ownerDocument}function j_(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function E_(i,c){if(i===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&c==="foreignObject"?0:i}function yg(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var _g=null;function Uj(){var i=window.event;return i&&i.type==="popstate"?i===_g?!1:(_g=i,!0):(_g=null,!1)}var A_=typeof setTimeout=="function"?setTimeout:void 0,qj=typeof clearTimeout=="function"?clearTimeout:void 0,C_=typeof Promise=="function"?Promise:void 0,zj=typeof queueMicrotask=="function"?queueMicrotask:typeof C_<"u"?function(i){return C_.resolve(null).then(i).catch(Hj)}:A_;function Hj(i){setTimeout(function(){throw i})}function Gc(i){return i==="head"}function T_(i,c){var d=c,p=0;do{var w=d.nextSibling;if(i.removeChild(d),w&&w.nodeType===8)if(d=w.data,d==="/$"||d==="/&"){if(p===0){i.removeChild(w),Nh(c);return}p--}else if(d==="$"||d==="$?"||d==="$~"||d==="$!"||d==="&")p++;else if(d==="html")zd(i.ownerDocument.documentElement);else if(d==="head"){d=i.ownerDocument.head,zd(d);for(var k=d.firstChild;k;){var G=k.nextSibling,fe=k.nodeName;k[Je]||fe==="SCRIPT"||fe==="STYLE"||fe==="LINK"&&k.rel.toLowerCase()==="stylesheet"||d.removeChild(k),k=G}}else d==="body"&&zd(i.ownerDocument.body);d=w}while(d);Nh(c)}function O_(i,c){var d=i;i=0;do{var p=d.nextSibling;if(d.nodeType===1?c?(d._stashedDisplay=d.style.display,d.style.display="none"):(d.style.display=d._stashedDisplay||"",d.getAttribute("style")===""&&d.removeAttribute("style")):d.nodeType===3&&(c?(d._stashedText=d.nodeValue,d.nodeValue=""):d.nodeValue=d._stashedText||""),p&&p.nodeType===8)if(d=p.data,d==="/$"){if(i===0)break;i--}else d!=="$"&&d!=="$?"&&d!=="$~"&&d!=="$!"||i++;d=p}while(d)}function bg(i){var c=i.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var d=c;switch(c=c.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":bg(d),Nt(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}i.removeChild(d)}}function $j(i,c,d,p){for(;i.nodeType===1;){var w=d;if(i.nodeName.toLowerCase()!==c.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Je])switch(c){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(k=i.getAttribute("rel"),k==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(k!==w.rel||i.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||i.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||i.getAttribute("title")!==(w.title==null?null:w.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(k=i.getAttribute("src"),(k!==(w.src==null?null:w.src)||i.getAttribute("type")!==(w.type==null?null:w.type)||i.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&k&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(c==="input"&&i.type==="hidden"){var k=w.name==null?null:""+w.name;if(w.type==="hidden"&&i.getAttribute("name")===k)return i}else return i;if(i=ro(i.nextSibling),i===null)break}return null}function Wj(i,c,d){if(c==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!d||(i=ro(i.nextSibling),i===null))return null;return i}function R_(i,c){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=ro(i.nextSibling),i===null))return null;return i}function wg(i){return i.data==="$?"||i.data==="$~"}function Sg(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function Vj(i,c){var d=i.ownerDocument;if(i.data==="$~")i._reactRetry=c;else if(i.data!=="$?"||d.readyState!=="loading")c();else{var p=function(){c(),d.removeEventListener("DOMContentLoaded",p)};d.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function ro(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return i}var Ng=null;function D_(i){i=i.nextSibling;for(var c=0;i;){if(i.nodeType===8){var d=i.data;if(d==="/$"||d==="/&"){if(c===0)return ro(i.nextSibling);c--}else d!=="$"&&d!=="$!"&&d!=="$?"&&d!=="$~"&&d!=="&"||c++}i=i.nextSibling}return null}function F_(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var d=i.data;if(d==="$"||d==="$!"||d==="$?"||d==="$~"||d==="&"){if(c===0)return i;c--}else d!=="/$"&&d!=="/&"||c++}i=i.previousSibling}return null}function L_(i,c,d){switch(c=Tm(d),i){case"html":if(i=c.documentElement,!i)throw Error(a(452));return i;case"head":if(i=c.head,!i)throw Error(a(453));return i;case"body":if(i=c.body,!i)throw Error(a(454));return i;default:throw Error(a(451))}}function zd(i){for(var c=i.attributes;c.length;)i.removeAttributeNode(c[0]);Nt(i)}var ao=new Map,P_=new Set;function Om(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var tc=le.d;le.d={f:Gj,r:Yj,D:Xj,C:Kj,L:Jj,m:Zj,X:eE,S:Qj,M:tE};function Gj(){var i=tc.f(),c=wm();return i||c}function Yj(i){var c=qt(i);c!==null&&c.tag===5&&c.type==="form"?Qx(c):tc.r(i)}var bh=typeof document>"u"?null:document;function M_(i,c,d){var p=bh;if(p&&typeof c=="string"&&c){var w=nn(c);w='link[rel="'+i+'"][href="'+w+'"]',typeof d=="string"&&(w+='[crossorigin="'+d+'"]'),P_.has(w)||(P_.add(w),i={rel:i,crossOrigin:d,href:c},p.querySelector(w)===null&&(c=p.createElement("link"),gs(c,"link",i),Yt(c),p.head.appendChild(c)))}}function Xj(i){tc.D(i),M_("dns-prefetch",i,null)}function Kj(i,c){tc.C(i,c),M_("preconnect",i,c)}function Jj(i,c,d){tc.L(i,c,d);var p=bh;if(p&&i&&c){var w='link[rel="preload"][as="'+nn(c)+'"]';c==="image"&&d&&d.imageSrcSet?(w+='[imagesrcset="'+nn(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(w+='[imagesizes="'+nn(d.imageSizes)+'"]')):w+='[href="'+nn(i)+'"]';var k=w;switch(c){case"style":k=wh(i);break;case"script":k=Sh(i)}ao.has(k)||(i=v({rel:"preload",href:c==="image"&&d&&d.imageSrcSet?void 0:i,as:c},d),ao.set(k,i),p.querySelector(w)!==null||c==="style"&&p.querySelector(Hd(k))||c==="script"&&p.querySelector($d(k))||(c=p.createElement("link"),gs(c,"link",i),Yt(c),p.head.appendChild(c)))}}function Zj(i,c){tc.m(i,c);var d=bh;if(d&&i){var p=c&&typeof c.as=="string"?c.as:"script",w='link[rel="modulepreload"][as="'+nn(p)+'"][href="'+nn(i)+'"]',k=w;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=Sh(i)}if(!ao.has(k)&&(i=v({rel:"modulepreload",href:i},c),ao.set(k,i),d.querySelector(w)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector($d(k)))return}p=d.createElement("link"),gs(p,"link",i),Yt(p),d.head.appendChild(p)}}}function Qj(i,c,d){tc.S(i,c,d);var p=bh;if(p&&i){var w=Mt(p).hoistableStyles,k=wh(i);c=c||"default";var G=w.get(k);if(!G){var fe={loading:0,preload:null};if(G=p.querySelector(Hd(k)))fe.loading=5;else{i=v({rel:"stylesheet",href:i,"data-precedence":c},d),(d=ao.get(k))&&kg(i,d);var Te=G=p.createElement("link");Yt(Te),gs(Te,"link",i),Te._p=new Promise(function(Qe,ct){Te.onload=Qe,Te.onerror=ct}),Te.addEventListener("load",function(){fe.loading|=1}),Te.addEventListener("error",function(){fe.loading|=2}),fe.loading|=4,Rm(G,c,p)}G={type:"stylesheet",instance:G,count:1,state:fe},w.set(k,G)}}}function eE(i,c){tc.X(i,c);var d=bh;if(d&&i){var p=Mt(d).hoistableScripts,w=Sh(i),k=p.get(w);k||(k=d.querySelector($d(w)),k||(i=v({src:i,async:!0},c),(c=ao.get(w))&&jg(i,c),k=d.createElement("script"),Yt(k),gs(k,"link",i),d.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},p.set(w,k))}}function tE(i,c){tc.M(i,c);var d=bh;if(d&&i){var p=Mt(d).hoistableScripts,w=Sh(i),k=p.get(w);k||(k=d.querySelector($d(w)),k||(i=v({src:i,async:!0,type:"module"},c),(c=ao.get(w))&&jg(i,c),k=d.createElement("script"),Yt(k),gs(k,"link",i),d.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},p.set(w,k))}}function I_(i,c,d,p){var w=(w=Z.current)?Om(w):null;if(!w)throw Error(a(446));switch(i){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(c=wh(d.href),d=Mt(w).hoistableStyles,p=d.get(c),p||(p={type:"style",instance:null,count:0,state:null},d.set(c,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){i=wh(d.href);var k=Mt(w).hoistableStyles,G=k.get(i);if(G||(w=w.ownerDocument||w,G={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},k.set(i,G),(k=w.querySelector(Hd(i)))&&!k._p&&(G.instance=k,G.state.loading=5),ao.has(i)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},ao.set(i,d),k||rE(w,i,d,G.state))),c&&p===null)throw Error(a(528,""));return G}if(c&&p!==null)throw Error(a(529,""));return null;case"script":return c=d.async,d=d.src,typeof d=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Sh(d),d=Mt(w).hoistableScripts,p=d.get(c),p||(p={type:"script",instance:null,count:0,state:null},d.set(c,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,i))}}function wh(i){return'href="'+nn(i)+'"'}function Hd(i){return'link[rel="stylesheet"]['+i+"]"}function B_(i){return v({},i,{"data-precedence":i.precedence,precedence:null})}function rE(i,c,d,p){i.querySelector('link[rel="preload"][as="style"]['+c+"]")?p.loading=1:(c=i.createElement("link"),p.preload=c,c.addEventListener("load",function(){return p.loading|=1}),c.addEventListener("error",function(){return p.loading|=2}),gs(c,"link",d),Yt(c),i.head.appendChild(c))}function Sh(i){return'[src="'+nn(i)+'"]'}function $d(i){return"script[async]"+i}function U_(i,c,d){if(c.count++,c.instance===null)switch(c.type){case"style":var p=i.querySelector('style[data-href~="'+nn(d.href)+'"]');if(p)return c.instance=p,Yt(p),p;var w=v({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Yt(p),gs(p,"style",w),Rm(p,d.precedence,i),c.instance=p;case"stylesheet":w=wh(d.href);var k=i.querySelector(Hd(w));if(k)return c.state.loading|=4,c.instance=k,Yt(k),k;p=B_(d),(w=ao.get(w))&&kg(p,w),k=(i.ownerDocument||i).createElement("link"),Yt(k);var G=k;return G._p=new Promise(function(fe,Te){G.onload=fe,G.onerror=Te}),gs(k,"link",p),c.state.loading|=4,Rm(k,d.precedence,i),c.instance=k;case"script":return k=Sh(d.src),(w=i.querySelector($d(k)))?(c.instance=w,Yt(w),w):(p=d,(w=ao.get(k))&&(p=v({},d),jg(p,w)),i=i.ownerDocument||i,w=i.createElement("script"),Yt(w),gs(w,"link",p),i.head.appendChild(w),c.instance=w);case"void":return null;default:throw Error(a(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(p=c.instance,c.state.loading|=4,Rm(p,d.precedence,i));return c.instance}function Rm(i,c,d){for(var p=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=p.length?p[p.length-1]:null,k=w,G=0;G<p.length;G++){var fe=p[G];if(fe.dataset.precedence===c)k=fe;else if(k!==w)break}k?k.parentNode.insertBefore(i,k.nextSibling):(c=d.nodeType===9?d.head:d,c.insertBefore(i,c.firstChild))}function kg(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.title==null&&(i.title=c.title)}function jg(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.integrity==null&&(i.integrity=c.integrity)}var Dm=null;function q_(i,c,d){if(Dm===null){var p=new Map,w=Dm=new Map;w.set(d,p)}else w=Dm,p=w.get(d),p||(p=new Map,w.set(d,p));if(p.has(i))return p;for(p.set(i,null),d=d.getElementsByTagName(i),w=0;w<d.length;w++){var k=d[w];if(!(k[Je]||k[xe]||i==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!=="http://www.w3.org/2000/svg"){var G=k.getAttribute(c)||"";G=i+G;var fe=p.get(G);fe?fe.push(k):p.set(G,[k])}}return p}function z_(i,c,d){i=i.ownerDocument||i,i.head.insertBefore(d,c==="title"?i.querySelector("head > title"):null)}function aE(i,c,d){if(d===1||c.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return i=c.disabled,typeof c.precedence=="string"&&i==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function H_(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function nE(i,c,d,p){if(d.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var w=wh(p.href),k=c.querySelector(Hd(w));if(k){c=k._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(i.count++,i=Fm.bind(i),c.then(i,i)),d.state.loading|=4,d.instance=k,Yt(k);return}k=c.ownerDocument||c,p=B_(p),(w=ao.get(w))&&kg(p,w),k=k.createElement("link"),Yt(k);var G=k;G._p=new Promise(function(fe,Te){G.onload=fe,G.onerror=Te}),gs(k,"link",p),d.instance=k}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(d,c),(c=d.state.preload)&&(d.state.loading&3)===0&&(i.count++,d=Fm.bind(i),c.addEventListener("load",d),c.addEventListener("error",d))}}var Eg=0;function sE(i,c){return i.stylesheets&&i.count===0&&Pm(i,i.stylesheets),0<i.count||0<i.imgCount?function(d){var p=setTimeout(function(){if(i.stylesheets&&Pm(i,i.stylesheets),i.unsuspend){var k=i.unsuspend;i.unsuspend=null,k()}},6e4+c);0<i.imgBytes&&Eg===0&&(Eg=62500*Bj());var w=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Pm(i,i.stylesheets),i.unsuspend)){var k=i.unsuspend;i.unsuspend=null,k()}},(i.imgBytes>Eg?50:800)+c);return i.unsuspend=d,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(w)}}:null}function Fm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Pm(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Lm=null;function Pm(i,c){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Lm=new Map,c.forEach(iE,i),Lm=null,Fm.call(i))}function iE(i,c){if(!(c.state.loading&4)){var d=Lm.get(i);if(d)var p=d.get(null);else{d=new Map,Lm.set(i,d);for(var w=i.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<w.length;k++){var G=w[k];(G.nodeName==="LINK"||G.getAttribute("media")!=="not all")&&(d.set(G.dataset.precedence,G),p=G)}p&&d.set(null,p)}w=c.instance,G=w.getAttribute("data-precedence"),k=d.get(G)||p,k===p&&d.set(null,w),d.set(G,w),this.count++,p=Fm.bind(this),w.addEventListener("load",p),w.addEventListener("error",p),k?k.parentNode.insertBefore(w,k.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(w,i.firstChild)),c.state.loading|=4}}var Wd={$$typeof:j,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function oE(i,c,d,p,w,k,G,fe,Te){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ha(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ha(0),this.hiddenUpdates=Ha(null),this.identifierPrefix=p,this.onUncaughtError=w,this.onCaughtError=k,this.onRecoverableError=G,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Te,this.incompleteTransitions=new Map}function $_(i,c,d,p,w,k,G,fe,Te,Qe,ct,gt){return i=new oE(i,c,d,G,Te,Qe,ct,gt,fe),c=1,k===!0&&(c|=24),k=es(3,null,null,c),i.current=k,k.stateNode=i,c=Lc(),c.refCount++,i.pooledCache=c,c.refCount++,k.memoizedState={element:p,isDehydrated:d,cache:c},Ut(k),i}function W_(i){return i?(i=qn,i):qn}function V_(i,c,d,p,w,k){w=W_(w),p.context===null?p.context=w:p.pendingContext=w,p=dr(c),p.payload={element:d},k=k===void 0?null:k,k!==null&&(p.callback=k),d=Cr(i,p,c),d!==null&&(ui(d,i,c),la(d,i,c))}function G_(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var d=i.retryLane;i.retryLane=d!==0&&d<c?d:c}}function Ag(i,c){G_(i,c),(i=i.alternate)&&G_(i,c)}function Y_(i){if(i.tag===13||i.tag===31){var c=Do(i,67108864);c!==null&&ui(c,i,67108864),Ag(i,67108864)}}function X_(i){if(i.tag===13||i.tag===31){var c=Ai();c=$r(c);var d=Do(i,c);d!==null&&ui(d,i,c),Ag(i,c)}}var Mm=!0;function lE(i,c,d,p){var w=Q.T;Q.T=null;var k=le.p;try{le.p=2,Cg(i,c,d,p)}finally{le.p=k,Q.T=w}}function cE(i,c,d,p){var w=Q.T;Q.T=null;var k=le.p;try{le.p=8,Cg(i,c,d,p)}finally{le.p=k,Q.T=w}}function Cg(i,c,d,p){if(Mm){var w=Tg(p);if(w===null)pg(i,c,p,Im,d),J_(i,p);else if(fE(w,i,c,d,p))p.stopPropagation();else if(J_(i,p),c&4&&-1<uE.indexOf(i)){for(;w!==null;){var k=qt(w);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var G=$t(k.pendingLanes);if(G!==0){var fe=k;for(fe.pendingLanes|=2,fe.entangledLanes|=2;G;){var Te=1<<31-Ie(G);fe.entanglements[1]|=Te,G&=~Te}vl(k),(ua&6)===0&&(_m=at()+500,Bd(0))}}break;case 31:case 13:fe=Do(k,2),fe!==null&&ui(fe,k,2),wm(),Ag(k,2)}if(k=Tg(p),k===null&&pg(i,c,p,Im,d),k===w)break;w=k}w!==null&&p.stopPropagation()}else pg(i,c,p,null,d)}}function Tg(i){return i=Ol(i),Og(i)}var Im=null;function Og(i){if(Im=null,i=Ft(i),i!==null){var c=s(i);if(c===null)i=null;else{var d=c.tag;if(d===13){if(i=o(c),i!==null)return i;i=null}else if(d===31){if(i=u(c),i!==null)return i;i=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null)}}return Im=i,null}function K_(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(pt()){case At:return 2;case Dt:return 8;case xt:case St:return 32;case ft:return 268435456;default:return 32}default:return 32}}var Rg=!1,Yc=null,Xc=null,Kc=null,Vd=new Map,Gd=new Map,Jc=[],uE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function J_(i,c){switch(i){case"focusin":case"focusout":Yc=null;break;case"dragenter":case"dragleave":Xc=null;break;case"mouseover":case"mouseout":Kc=null;break;case"pointerover":case"pointerout":Vd.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gd.delete(c.pointerId)}}function Yd(i,c,d,p,w,k){return i===null||i.nativeEvent!==k?(i={blockedOn:c,domEventName:d,eventSystemFlags:p,nativeEvent:k,targetContainers:[w]},c!==null&&(c=qt(c),c!==null&&Y_(c)),i):(i.eventSystemFlags|=p,c=i.targetContainers,w!==null&&c.indexOf(w)===-1&&c.push(w),i)}function fE(i,c,d,p,w){switch(c){case"focusin":return Yc=Yd(Yc,i,c,d,p,w),!0;case"dragenter":return Xc=Yd(Xc,i,c,d,p,w),!0;case"mouseover":return Kc=Yd(Kc,i,c,d,p,w),!0;case"pointerover":var k=w.pointerId;return Vd.set(k,Yd(Vd.get(k)||null,i,c,d,p,w)),!0;case"gotpointercapture":return k=w.pointerId,Gd.set(k,Yd(Gd.get(k)||null,i,c,d,p,w)),!0}return!1}function Z_(i){var c=Ft(i.target);if(c!==null){var d=s(c);if(d!==null){if(c=d.tag,c===13){if(c=o(d),c!==null){i.blockedOn=c,je(i.priority,function(){X_(d)});return}}else if(c===31){if(c=u(d),c!==null){i.blockedOn=c,je(i.priority,function(){X_(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){i.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Bm(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var d=Tg(i.nativeEvent);if(d===null){d=i.nativeEvent;var p=new d.constructor(d.type,d);go=p,d.target.dispatchEvent(p),go=null}else return c=qt(d),c!==null&&Y_(c),i.blockedOn=d,!1;c.shift()}return!0}function Q_(i,c,d){Bm(i)&&d.delete(c)}function hE(){Rg=!1,Yc!==null&&Bm(Yc)&&(Yc=null),Xc!==null&&Bm(Xc)&&(Xc=null),Kc!==null&&Bm(Kc)&&(Kc=null),Vd.forEach(Q_),Gd.forEach(Q_)}function Um(i,c){i.blockedOn===c&&(i.blockedOn=null,Rg||(Rg=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,hE)))}var qm=null;function eb(i){qm!==i&&(qm=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){qm===i&&(qm=null);for(var c=0;c<i.length;c+=3){var d=i[c],p=i[c+1],w=i[c+2];if(typeof p!="function"){if(Og(p||d)===null)continue;break}var k=qt(d);k!==null&&(i.splice(c,3),c-=3,T1(k,{pending:!0,data:w,method:d.method,action:p},p,w))}}))}function Nh(i){function c(Te){return Um(Te,i)}Yc!==null&&Um(Yc,i),Xc!==null&&Um(Xc,i),Kc!==null&&Um(Kc,i),Vd.forEach(c),Gd.forEach(c);for(var d=0;d<Jc.length;d++){var p=Jc[d];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Jc.length&&(d=Jc[0],d.blockedOn===null);)Z_(d),d.blockedOn===null&&Jc.shift();if(d=(i.ownerDocument||i).$$reactFormReplay,d!=null)for(p=0;p<d.length;p+=3){var w=d[p],k=d[p+1],G=w[Se]||null;if(typeof k=="function")G||eb(d);else if(G){var fe=null;if(k&&k.hasAttribute("formAction")){if(w=k,G=k[Se]||null)fe=G.formAction;else if(Og(w)!==null)continue}else fe=G.action;typeof fe=="function"?d[p+1]=fe:(d.splice(p,3),p-=3),eb(d)}}}function tb(){function i(k){k.canIntercept&&k.info==="react-transition"&&k.intercept({handler:function(){return new Promise(function(G){return w=G})},focusReset:"manual",scroll:"manual"})}function c(){w!==null&&(w(),w=null),p||setTimeout(d,20)}function d(){if(!p&&!navigation.transition){var k=navigation.currentEntry;k&&k.url!=null&&navigation.navigate(k.url,{state:k.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,w=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(d,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),w!==null&&(w(),w=null)}}}function Dg(i){this._internalRoot=i}zm.prototype.render=Dg.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(a(409));var d=c.current,p=Ai();V_(d,p,i,c,null,null)},zm.prototype.unmount=Dg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;V_(i.current,2,null,i,null,null),wm(),c[Ce]=null}};function zm(i){this._internalRoot=i}zm.prototype.unstable_scheduleHydration=function(i){if(i){var c=ae();i={blockedOn:null,target:i,priority:c};for(var d=0;d<Jc.length&&c!==0&&c<Jc[d].priority;d++);Jc.splice(d,0,i),d===0&&Z_(i)}};var rb=e.version;if(rb!=="19.2.0")throw Error(a(527,rb,"19.2.0"));le.findDOMNode=function(i){var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=h(c),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var dE={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hm.isDisabled&&Hm.supportsFiber)try{Lt=Hm.inject(dE),Bt=Hm}catch{}}return Kd.createRoot=function(i,c){if(!n(i))throw Error(a(299));var d=!1,p="",w=cy,k=uy,G=fy;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(w=c.onUncaughtError),c.onCaughtError!==void 0&&(k=c.onCaughtError),c.onRecoverableError!==void 0&&(G=c.onRecoverableError)),c=$_(i,1,!1,null,null,d,p,null,w,k,G,tb),i[Ce]=c.current,mg(i),new Dg(c)},Kd.hydrateRoot=function(i,c,d){if(!n(i))throw Error(a(299));var p=!1,w="",k=cy,G=uy,fe=fy,Te=null;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onUncaughtError!==void 0&&(k=d.onUncaughtError),d.onCaughtError!==void 0&&(G=d.onCaughtError),d.onRecoverableError!==void 0&&(fe=d.onRecoverableError),d.formState!==void 0&&(Te=d.formState)),c=$_(i,1,!0,c,d??null,p,w,Te,k,G,fe,tb),c.context=W_(null),d=c.current,p=Ai(),p=$r(p),w=dr(p),w.callback=null,Cr(d,w,p),d=p,c.current.lanes=d,_t(c,d),vl(c),i[Ce]=c.current,mg(i),new zm(c)},Kd.version="19.2.0",Kd}var hb;function jE(){if(hb)return Pg.exports;hb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Pg.exports=kE(),Pg.exports}var EE=jE();const AE=L2(EE);var Gv=function(t,e){return Gv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},Gv(t,e)};function FS(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Gv(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Dp=function(){return Dp=Object.assign||function(e){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Dp.apply(this,arguments)};function sd(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(t);n<a.length;n++)e.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(r[a[n]]=t[a[n]]);return r}function LS(t,e,r,a){var n=arguments.length,s=n<3?e:a===null?a=Object.getOwnPropertyDescriptor(e,r):a,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,a);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function PS(t,e){return function(r,a){e(r,a,t)}}function MS(t,e,r,a,n,s){function o(E){if(E!==void 0&&typeof E!="function")throw new TypeError("Function expected");return E}for(var u=a.kind,f=u==="getter"?"get":u==="setter"?"set":"value",h=!e&&t?a.static?t:t.prototype:null,m=e||(h?Object.getOwnPropertyDescriptor(h,a.name):{}),v,y=!1,g=r.length-1;g>=0;g--){var b={};for(var _ in a)b[_]=_==="access"?{}:a[_];for(var _ in a.access)b.access[_]=a.access[_];b.addInitializer=function(E){if(y)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(E||null))};var S=(0,r[g])(u==="accessor"?{get:m.get,set:m.set}:m[f],b);if(u==="accessor"){if(S===void 0)continue;if(S===null||typeof S!="object")throw new TypeError("Object expected");(v=o(S.get))&&(m.get=v),(v=o(S.set))&&(m.set=v),(v=o(S.init))&&n.unshift(v)}else(v=o(S))&&(u==="field"?n.unshift(v):m[f]=v)}h&&Object.defineProperty(h,a.name,m),y=!0}function IS(t,e,r){for(var a=arguments.length>2,n=0;n<e.length;n++)r=a?e[n].call(t,r):e[n].call(t);return a?r:void 0}function BS(t){return typeof t=="symbol"?t:"".concat(t)}function US(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function qS(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Qt(t,e,r,a){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function u(m){try{h(a.next(m))}catch(v){o(v)}}function f(m){try{h(a.throw(m))}catch(v){o(v)}}function h(m){m.done?s(m.value):n(m.value).then(u,f)}h((a=a.apply(t,e||[])).next())})}function zS(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},a,n,s,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=u(0),o.throw=u(1),o.return=u(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(h){return function(m){return f([h,m])}}function f(h){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,h[0]&&(r=0)),r;)try{if(a=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(m){h=[6,m],n=0}finally{a=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}var n1=Object.create?(function(t,e,r,a){a===void 0&&(a=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,a,n)}):(function(t,e,r,a){a===void 0&&(a=r),t[a]=e[r]});function HS(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&n1(e,t,r)}function Fp(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],a=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&a>=t.length&&(t=void 0),{value:t&&t[a++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function M2(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var a=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(u){o={error:u}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return s}function $S(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(M2(arguments[e]));return t}function WS(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var a=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,u=s.length;o<u;o++,n++)a[n]=s[o];return a}function VS(t,e,r){if(r||arguments.length===2)for(var a=0,n=e.length,s;a<n;a++)(s||!(a in e))&&(s||(s=Array.prototype.slice.call(e,0,a)),s[a]=e[a]);return t.concat(s||Array.prototype.slice.call(e))}function td(t){return this instanceof td?(this.v=t,this):new td(t)}function GS(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r.apply(t,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",o),n[Symbol.asyncIterator]=function(){return this},n;function o(g){return function(b){return Promise.resolve(b).then(g,v)}}function u(g,b){a[g]&&(n[g]=function(_){return new Promise(function(S,E){s.push([g,_,S,E])>1||f(g,_)})},b&&(n[g]=b(n[g])))}function f(g,b){try{h(a[g](b))}catch(_){y(s[0][3],_)}}function h(g){g.value instanceof td?Promise.resolve(g.value.v).then(m,v):y(s[0][2],g)}function m(g){f("next",g)}function v(g){f("throw",g)}function y(g,b){g(b),s.shift(),s.length&&f(s[0][0],s[0][1])}}function YS(t){var e,r;return e={},a("next"),a("throw",function(n){throw n}),a("return"),e[Symbol.iterator]=function(){return this},e;function a(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:td(t[n](o)),done:!1}:s?s(o):o}:s}}function XS(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Fp=="function"?Fp(t):t[Symbol.iterator](),r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r);function a(s){r[s]=t[s]&&function(o){return new Promise(function(u,f){o=t[s](o),n(u,f,o.done,o.value)})}}function n(s,o,u,f){Promise.resolve(f).then(function(h){s({value:h,done:u})},o)}}function KS(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var CE=Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e},Yv=function(t){return Yv=Object.getOwnPropertyNames||function(e){var r=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[r.length]=a);return r},Yv(t)};function JS(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=Yv(t),a=0;a<r.length;a++)r[a]!=="default"&&n1(e,t,r[a]);return CE(e,t),e}function ZS(t){return t&&t.__esModule?t:{default:t}}function QS(t,e,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(t):a?a.value:e.get(t)}function e4(t,e,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}function t4(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function r4(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var a,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");a=e[Symbol.asyncDispose]}if(a===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");a=e[Symbol.dispose],r&&(n=a)}if(typeof a!="function")throw new TypeError("Object not disposable.");n&&(a=function(){try{n.call(this)}catch(s){return Promise.reject(s)}}),t.stack.push({value:e,dispose:a,async:r})}else r&&t.stack.push({async:!0});return e}var TE=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var a=new Error(r);return a.name="SuppressedError",a.error=t,a.suppressed=e,a};function a4(t){function e(s){t.error=t.hasError?new TE(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var r,a=0;function n(){for(;r=t.stack.pop();)try{if(!r.async&&a===1)return a=0,t.stack.push(r),Promise.resolve().then(n);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return a|=2,Promise.resolve(s).then(n,function(o){return e(o),n()})}else a|=1}catch(o){e(o)}if(a===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return n()}function n4(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,a,n,s,o){return a?e?".jsx":".js":n&&(!s||!o)?r:n+s+"."+o.toLowerCase()+"js"}):t}const OE={__extends:FS,__assign:Dp,__rest:sd,__decorate:LS,__param:PS,__esDecorate:MS,__runInitializers:IS,__propKey:BS,__setFunctionName:US,__metadata:qS,__awaiter:Qt,__generator:zS,__createBinding:n1,__exportStar:HS,__values:Fp,__read:M2,__spread:$S,__spreadArrays:WS,__spreadArray:VS,__await:td,__asyncGenerator:GS,__asyncDelegator:YS,__asyncValues:XS,__makeTemplateObject:KS,__importStar:JS,__importDefault:ZS,__classPrivateFieldGet:QS,__classPrivateFieldSet:e4,__classPrivateFieldIn:t4,__addDisposableResource:r4,__disposeResources:a4,__rewriteRelativeImportExtension:n4},RE=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:r4,get __assign(){return Dp},__asyncDelegator:YS,__asyncGenerator:GS,__asyncValues:XS,__await:td,__awaiter:Qt,__classPrivateFieldGet:QS,__classPrivateFieldIn:t4,__classPrivateFieldSet:e4,__createBinding:n1,__decorate:LS,__disposeResources:a4,__esDecorate:MS,__exportStar:HS,__extends:FS,__generator:zS,__importDefault:ZS,__importStar:JS,__makeTemplateObject:KS,__metadata:qS,__param:PS,__propKey:BS,__read:M2,__rest:sd,__rewriteRelativeImportExtension:n4,__runInitializers:IS,__setFunctionName:US,__spread:$S,__spreadArray:VS,__spreadArrays:WS,__values:Fp,default:OE},Symbol.toStringTag,{value:"Module"})),DE=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class I2 extends Error{constructor(e,r="FunctionsError",a){super(e),this.name=r,this.context=a}}class FE extends I2{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class db extends I2{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class mb extends I2{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Xv;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Xv||(Xv={}));class LE{constructor(e,{headers:r={},customFetch:a,region:n=Xv.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=DE(a)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Qt(this,arguments,void 0,function*(r,a={}){var n;let s,o;try{const{headers:u,method:f,body:h,signal:m,timeout:v}=a;let y={},{region:g}=a;g||(g=this.region);const b=new URL(`${this.url}/${r}`);g&&g!=="any"&&(y["x-region"]=g,b.searchParams.set("forceFunctionRegion",g));let _;h&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",_=h):typeof h=="string"?(y["Content-Type"]="text/plain",_=h):typeof FormData<"u"&&h instanceof FormData?_=h:(y["Content-Type"]="application/json",_=JSON.stringify(h)):_=h;let S=m;v&&(o=new AbortController,s=setTimeout(()=>o.abort(),v),m?(S=o.signal,m.addEventListener("abort",()=>o.abort())):S=o.signal);const E=yield this.fetch(b.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),u),body:_,signal:S}).catch(H=>{throw new FE(H)}),C=E.headers.get("x-relay-error");if(C&&C==="true")throw new db(E);if(!E.ok)throw new mb(E);let j=((n=E.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),R;return j==="application/json"?R=yield E.json():j==="application/octet-stream"||j==="application/pdf"?R=yield E.blob():j==="text/event-stream"?R=E:j==="multipart/form-data"?R=yield E.formData():R=yield E.text(),{data:R,error:null,response:E}}catch(u){return{data:null,error:u,response:u instanceof mb||u instanceof db?u.context:void 0}}finally{s&&clearTimeout(s)}})}}var ks={};const id=gE(RE);var $m={},Wm={},Vm={},Gm={},Ym={},Xm={},pb;function s4(){if(pb)return Xm;pb=1,Object.defineProperty(Xm,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Xm.default=t,Xm}var gb;function i4(){if(gb)return Ym;gb=1,Object.defineProperty(Ym,"__esModule",{value:!0});const e=id.__importDefault(s4());class r{constructor(n){var s,o;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(s=n.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=n.signal,this.isMaybeSingle=(o=n.isMaybeSingle)!==null&&o!==void 0?o:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,s){return this.headers=new Headers(this.headers),this.headers.set(n,s),this}then(n,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let u=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var h,m,v,y;let g=null,b=null,_=null,S=f.status,E=f.statusText;if(f.ok){if(this.method!=="HEAD"){const H=await f.text();H===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((h=this.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?b=H:b=JSON.parse(H))}const j=(m=this.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),R=(v=f.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");j&&R&&R.length>1&&(_=parseInt(R[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(g={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,_=null,S=406,E="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const j=await f.text();try{g=JSON.parse(j),Array.isArray(g)&&f.status===404&&(b=[],g=null,S=200,E="OK")}catch{f.status===404&&j===""?(S=204,E="No Content"):g={message:j}}if(g&&this.isMaybeSingle&&(!((y=g?.details)===null||y===void 0)&&y.includes("0 rows"))&&(g=null,S=200,E="OK"),g&&this.shouldThrowOnError)throw new e.default(g)}return{error:g,data:b,count:_,status:S,statusText:E}});return this.shouldThrowOnError||(u=u.catch(f=>{var h,m,v,y,g,b;let _="";const S=f?.cause;if(S){const E=(h=S?.message)!==null&&h!==void 0?h:"",C=(m=S?.code)!==null&&m!==void 0?m:"";_=`${(v=f?.name)!==null&&v!==void 0?v:"FetchError"}: ${f?.message}`,_+=`

Caused by: ${(y=S?.name)!==null&&y!==void 0?y:"Error"}: ${E}`,C&&(_+=` (${C})`),S?.stack&&(_+=`
${S.stack}`)}else _=(g=f?.stack)!==null&&g!==void 0?g:"";return{error:{message:`${(b=f?.name)!==null&&b!==void 0?b:"FetchError"}: ${f?.message}`,details:_,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),u.then(n,s)}returns(){return this}overrideTypes(){return this}}return Ym.default=r,Ym}var vb;function o4(){if(vb)return Gm;vb=1,Object.defineProperty(Gm,"__esModule",{value:!0});const e=id.__importDefault(i4());class r extends e.default{select(n){let s=!1;const o=(n??"*").split("").map(u=>/\s/.test(u)&&!s?"":(u==='"'&&(s=!s),u)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:s=!0,nullsFirst:o,foreignTable:u,referencedTable:f=u}={}){const h=f?`${f}.order`:"order",m=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${m?`${m},`:""}${n}.${s?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:s,referencedTable:o=s}={}){const u=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(u,`${n}`),this}range(n,s,{foreignTable:o,referencedTable:u=o}={}){const f=typeof u>"u"?"offset":`${u}.offset`,h=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(f,`${n}`),this.url.searchParams.set(h,`${s-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:s=!1,settings:o=!1,buffers:u=!1,wal:f=!1,format:h="text"}={}){var m;const v=[n?"analyze":null,s?"verbose":null,o?"settings":null,u?"buffers":null,f?"wal":null].filter(Boolean).join("|"),y=(m=this.headers.get("Accept"))!==null&&m!==void 0?m:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${h}; for="${y}"; options=${v};`),h==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return Gm.default=r,Gm}var xb;function B2(){if(xb)return Vm;xb=1,Object.defineProperty(Vm,"__esModule",{value:!0});const e=id.__importDefault(o4()),r=new RegExp("[,()]");class a extends e.default{eq(s,o){return this.url.searchParams.append(s,`eq.${o}`),this}neq(s,o){return this.url.searchParams.append(s,`neq.${o}`),this}gt(s,o){return this.url.searchParams.append(s,`gt.${o}`),this}gte(s,o){return this.url.searchParams.append(s,`gte.${o}`),this}lt(s,o){return this.url.searchParams.append(s,`lt.${o}`),this}lte(s,o){return this.url.searchParams.append(s,`lte.${o}`),this}like(s,o){return this.url.searchParams.append(s,`like.${o}`),this}likeAllOf(s,o){return this.url.searchParams.append(s,`like(all).{${o.join(",")}}`),this}likeAnyOf(s,o){return this.url.searchParams.append(s,`like(any).{${o.join(",")}}`),this}ilike(s,o){return this.url.searchParams.append(s,`ilike.${o}`),this}ilikeAllOf(s,o){return this.url.searchParams.append(s,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(s,o){return this.url.searchParams.append(s,`ilike(any).{${o.join(",")}}`),this}regexMatch(s,o){return this.url.searchParams.append(s,`match.${o}`),this}regexIMatch(s,o){return this.url.searchParams.append(s,`imatch.${o}`),this}is(s,o){return this.url.searchParams.append(s,`is.${o}`),this}isDistinct(s,o){return this.url.searchParams.append(s,`isdistinct.${o}`),this}in(s,o){const u=Array.from(new Set(o)).map(f=>typeof f=="string"&&r.test(f)?`"${f}"`:`${f}`).join(",");return this.url.searchParams.append(s,`in.(${u})`),this}contains(s,o){return typeof o=="string"?this.url.searchParams.append(s,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(s,`cs.{${o.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(o)}`),this}containedBy(s,o){return typeof o=="string"?this.url.searchParams.append(s,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(s,`cd.{${o.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(o)}`),this}rangeGt(s,o){return this.url.searchParams.append(s,`sr.${o}`),this}rangeGte(s,o){return this.url.searchParams.append(s,`nxl.${o}`),this}rangeLt(s,o){return this.url.searchParams.append(s,`sl.${o}`),this}rangeLte(s,o){return this.url.searchParams.append(s,`nxr.${o}`),this}rangeAdjacent(s,o){return this.url.searchParams.append(s,`adj.${o}`),this}overlaps(s,o){return typeof o=="string"?this.url.searchParams.append(s,`ov.${o}`):this.url.searchParams.append(s,`ov.{${o.join(",")}}`),this}textSearch(s,o,{config:u,type:f}={}){let h="";f==="plain"?h="pl":f==="phrase"?h="ph":f==="websearch"&&(h="w");const m=u===void 0?"":`(${u})`;return this.url.searchParams.append(s,`${h}fts${m}.${o}`),this}match(s){return Object.entries(s).forEach(([o,u])=>{this.url.searchParams.append(o,`eq.${u}`)}),this}not(s,o,u){return this.url.searchParams.append(s,`not.${o}.${u}`),this}or(s,{foreignTable:o,referencedTable:u=o}={}){const f=u?`${u}.or`:"or";return this.url.searchParams.append(f,`(${s})`),this}filter(s,o,u){return this.url.searchParams.append(s,`${o}.${u}`),this}}return Vm.default=a,Vm}var yb;function l4(){if(yb)return Wm;yb=1,Object.defineProperty(Wm,"__esModule",{value:!0});const e=id.__importDefault(B2());class r{constructor(n,{headers:s={},schema:o,fetch:u}){this.url=n,this.headers=new Headers(s),this.schema=o,this.fetch=u}select(n,s){const{head:o=!1,count:u}=s??{},f=o?"HEAD":"GET";let h=!1;const m=(n??"*").split("").map(v=>/\s/.test(v)&&!h?"":(v==='"'&&(h=!h),v)).join("");return this.url.searchParams.set("select",m),u&&this.headers.append("Prefer",`count=${u}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:s,defaultToNull:o=!0}={}){var u;const f="POST";if(s&&this.headers.append("Prefer",`count=${s}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const h=n.reduce((m,v)=>m.concat(Object.keys(v)),[]);if(h.length>0){const m=[...new Set(h)].map(v=>`"${v}"`);this.url.searchParams.set("columns",m.join(","))}}return new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}upsert(n,{onConflict:s,ignoreDuplicates:o=!1,count:u,defaultToNull:f=!0}={}){var h;const m="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),u&&this.headers.append("Prefer",`count=${u}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const v=n.reduce((y,g)=>y.concat(Object.keys(g)),[]);if(v.length>0){const y=[...new Set(v)].map(g=>`"${g}"`);this.url.searchParams.set("columns",y.join(","))}}return new e.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}update(n,{count:s}={}){var o;const u="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:n}={}){var s;const o="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return Wm.default=r,Wm}var _b;function PE(){if(_b)return $m;_b=1,Object.defineProperty($m,"__esModule",{value:!0});const t=id,e=t.__importDefault(l4()),r=t.__importDefault(B2());class a{constructor(s,{headers:o={},schema:u,fetch:f}={}){this.url=s,this.headers=new Headers(o),this.schemaName=u,this.fetch=f}from(s){if(!s||typeof s!="string"||s.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const o=new URL(`${this.url}/${s}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new a(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,o={},{head:u=!1,get:f=!1,count:h}={}){var m;let v;const y=new URL(`${this.url}/rpc/${s}`);let g;u||f?(v=u?"HEAD":"GET",Object.entries(o).filter(([_,S])=>S!==void 0).map(([_,S])=>[_,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([_,S])=>{y.searchParams.append(_,S)})):(v="POST",g=o);const b=new Headers(this.headers);return h&&b.set("Prefer",`count=${h}`),new r.default({method:v,url:y,headers:b,schema:this.schemaName,body:g,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}}return $m.default=a,$m}var bb;function ME(){if(bb)return ks;bb=1,Object.defineProperty(ks,"__esModule",{value:!0}),ks.PostgrestError=ks.PostgrestBuilder=ks.PostgrestTransformBuilder=ks.PostgrestFilterBuilder=ks.PostgrestQueryBuilder=ks.PostgrestClient=void 0;const t=id,e=t.__importDefault(PE());ks.PostgrestClient=e.default;const r=t.__importDefault(l4());ks.PostgrestQueryBuilder=r.default;const a=t.__importDefault(B2());ks.PostgrestFilterBuilder=a.default;const n=t.__importDefault(o4());ks.PostgrestTransformBuilder=n.default;const s=t.__importDefault(i4());ks.PostgrestBuilder=s.default;const o=t.__importDefault(s4());return ks.PostgrestError=o.default,ks.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:s.default,PostgrestError:o.default},ks}var c4=ME();const u4=L2(c4),IE=pE({__proto__:null,default:u4},[c4]),{PostgrestClient:BE,PostgrestQueryBuilder:XH,PostgrestFilterBuilder:KH,PostgrestTransformBuilder:JH,PostgrestBuilder:ZH,PostgrestError:QH}=u4||IE;class UE{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,n=parseInt(a.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const a=this.getWebSocketConstructor();return new a(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const qE="2.86.0",zE=`realtime-js/${qE}`,f4="1.0.0",HE="2.0.0",wb=f4,Kv=1e4,$E=1e3,WE=100;var tf;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(tf||(tf={}));var Gn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Gn||(Gn={}));var Wo;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Wo||(Wo={}));var Jv;(function(t){t.websocket="websocket"})(Jv||(Jv={}));var rf;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(rf||(rf={}));class VE{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let a=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,a;const n=(a=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var r,a;const n=(a=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},o=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,r,a){var n,s;const o=e.topic,u=(n=e.ref)!==null&&n!==void 0?n:"",f=(s=e.join_ref)!==null&&s!==void 0?s:"",h=e.payload.event,m=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},v=Object.keys(m).length===0?"":JSON.stringify(m);if(f.length>255)throw new Error(`joinRef length ${f.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`userEvent length ${h.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`metadata length ${v.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+f.length+u.length+o.length+h.length+v.length,g=new ArrayBuffer(this.HEADER_LENGTH+y);let b=new DataView(g),_=0;b.setUint8(_++,this.KINDS.userBroadcastPush),b.setUint8(_++,f.length),b.setUint8(_++,u.length),b.setUint8(_++,o.length),b.setUint8(_++,h.length),b.setUint8(_++,v.length),b.setUint8(_++,r),Array.from(f,E=>b.setUint8(_++,E.charCodeAt(0))),Array.from(u,E=>b.setUint8(_++,E.charCodeAt(0))),Array.from(o,E=>b.setUint8(_++,E.charCodeAt(0))),Array.from(h,E=>b.setUint8(_++,E.charCodeAt(0))),Array.from(v,E=>b.setUint8(_++,E.charCodeAt(0)));var S=new Uint8Array(g.byteLength+a.byteLength);return S.set(new Uint8Array(g),0),S.set(new Uint8Array(a),g.byteLength),S.buffer}decode(e,r){if(this._isArrayBuffer(e)){let a=this._binaryDecode(e);return r(a)}if(typeof e=="string"){const a=JSON.parse(e),[n,s,o,u,f]=a;return r({join_ref:n,ref:s,topic:o,event:u,payload:f})}return r({})}_binaryDecode(e){const r=new DataView(e),a=r.getUint8(0),n=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,n)}}_decodeUserBroadcast(e,r,a){const n=r.getUint8(1),s=r.getUint8(2),o=r.getUint8(3),u=r.getUint8(4);let f=this.HEADER_LENGTH+4;const h=a.decode(e.slice(f,f+n));f=f+n;const m=a.decode(e.slice(f,f+s));f=f+s;const v=a.decode(e.slice(f,f+o));f=f+o;const y=e.slice(f,e.byteLength),g=u===this.JSON_ENCODING?JSON.parse(a.decode(y)):y,b={type:this.BROADCAST_EVENT,event:m,payload:g};return o>0&&(b.meta=JSON.parse(v)),{join_ref:null,ref:null,topic:h,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([a])=>r.includes(a)))}}class h4{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ra;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ra||(Ra={}));const Sb=(t,e,r={})=>{var a;const n=(a=r.skipTypes)!==null&&a!==void 0?a:[];return e?Object.keys(e).reduce((s,o)=>(s[o]=GE(o,t,e,n),s),{}):{}},GE=(t,e,r,a)=>{const n=e.find(u=>u.name===t),s=n?.type,o=r[t];return s&&!a.includes(s)?d4(s,o):Zv(o)},d4=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return JE(e,r)}switch(t){case Ra.bool:return YE(e);case Ra.float4:case Ra.float8:case Ra.int2:case Ra.int4:case Ra.int8:case Ra.numeric:case Ra.oid:return XE(e);case Ra.json:case Ra.jsonb:return KE(e);case Ra.timestamp:return ZE(e);case Ra.abstime:case Ra.date:case Ra.daterange:case Ra.int4range:case Ra.int8range:case Ra.money:case Ra.reltime:case Ra.text:case Ra.time:case Ra.timestamptz:case Ra.timetz:case Ra.tsrange:case Ra.tstzrange:return Zv(e);default:return Zv(e)}},Zv=t=>t,YE=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},XE=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},KE=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},JE=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,a=t[r];if(t[0]==="{"&&a==="}"){let s;const o=t.slice(1,r);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(u=>d4(e,u))}return t},ZE=t=>typeof t=="string"?t.replace(" ","T"):t,m4=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Ug{constructor(e,r,a={},n=Kv){this.channel=e,this.event=r,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var a;return this._hasReceived(e)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(a=>a.status===e).forEach(a=>a.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Nb;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Nb||(Nb={}));class s0{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:s,onLeave:o,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=s0.syncState(this.state,n,s,o),this.pendingDiffs.forEach(f=>{this.state=s0.syncDiff(this.state,f,s,o)}),this.pendingDiffs=[],u()}),this.channel._on(a.diff,{},n=>{const{onJoin:s,onLeave:o,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=s0.syncDiff(this.state,n,s,o),u())}),this.onJoin((n,s,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:s,newPresences:o})}),this.onLeave((n,s,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,a,n){const s=this.cloneDeep(e),o=this.transformState(r),u={},f={};return this.map(s,(h,m)=>{o[h]||(f[h]=m)}),this.map(o,(h,m)=>{const v=s[h];if(v){const y=m.map(S=>S.presence_ref),g=v.map(S=>S.presence_ref),b=m.filter(S=>g.indexOf(S.presence_ref)<0),_=v.filter(S=>y.indexOf(S.presence_ref)<0);b.length>0&&(u[h]=b),_.length>0&&(f[h]=_)}else u[h]=m}),this.syncDiff(s,{joins:u,leaves:f},a,n)}static syncDiff(e,r,a,n){const{joins:s,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(s,(u,f)=>{var h;const m=(h=e[u])!==null&&h!==void 0?h:[];if(e[u]=this.cloneDeep(f),m.length>0){const v=e[u].map(g=>g.presence_ref),y=m.filter(g=>v.indexOf(g.presence_ref)<0);e[u].unshift(...y)}a(u,m,f)}),this.map(o,(u,f)=>{let h=e[u];if(!h)return;const m=f.map(v=>v.presence_ref);h=h.filter(v=>m.indexOf(v.presence_ref)<0),e[u]=h,n(u,h,f),h.length===0&&delete e[u]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(a=>r(a,e[a]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,a)=>{const n=e[a];return"metas"in n?r[a]=n.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[a]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var kb;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(kb||(kb={}));var i0;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(i0||(i0={}));var nc;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(nc||(nc={}));class U2{constructor(e,r={config:{}},a){var n,s;if(this.topic=e,this.params=r,this.socket=a,this.bindings={},this.state=Gn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Ug(this,Wo.join,this.params,this.timeout),this.rejoinTimer=new h4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Gn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Gn.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Gn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Wo.reply,{},(o,u)=>{this._trigger(this._replyEventName(u),o)}),this.presence=new s0(this),this.broadcastEndpointURL=m4(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var a,n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Gn.closed){const{config:{broadcast:o,presence:u,private:f}}=this.params,h=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(g=>g.filter))!==null&&n!==void 0?n:[],m=!!this.bindings[i0.PRESENCE]&&this.bindings[i0.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,v={},y={broadcast:o,presence:Object.assign(Object.assign({},u),{enabled:m}),postgres_changes:h,private:f};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(g=>e?.(nc.CHANNEL_ERROR,g)),this._onClose(()=>e?.(nc.CLOSED)),this.updateJoinPayload(Object.assign({config:y},v)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:g})=>{var b;if(this.socket.setAuth(),g===void 0){e?.(nc.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,S=(b=_?.length)!==null&&b!==void 0?b:0,E=[];for(let C=0;C<S;C++){const j=_[C],{filter:{event:R,schema:H,table:Y,filter:U}}=j,V=g&&g[C];if(V&&V.event===R&&V.schema===H&&V.table===Y&&V.filter===U)E.push(Object.assign(Object.assign({},j),{id:V.id}));else{this.unsubscribe(),this.state=Gn.errored,e?.(nc.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,e&&e(nc.SUBSCRIBED);return}}).receive("error",g=>{this.state=Gn.errored,e?.(nc.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e?.(nc.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,a){return this.state===Gn.joined&&e===i0.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,a)}async httpSend(e,r,a={}){var n;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(n=a.timeout)!==null&&n!==void 0?n:this.timeout);if(u.status===202)return{success:!0};let f=u.statusText;try{const h=await u.json();f=h.error||h.message||f}catch{}return Promise.reject(new Error(f))}async send(e,r={}){var a,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:o}=e,f={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=h.body)===null||n===void 0?void 0:n.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,u,f;const h=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((f=(u=(o=this.params)===null||o===void 0?void 0:o.config)===null||u===void 0?void 0:u.broadcast)===null||f===void 0)&&f.ack)&&s("ok"),h.receive("ok",()=>s("ok")),h.receive("error",()=>s("error")),h.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Gn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Wo.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new Ug(this,Wo.leave,{},e),a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Gn.closed,this.bindings={}}async _fetchWithTimeout(e,r,a){const n=new AbortController,s=setTimeout(()=>n.abort(),a),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(s),o}_push(e,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Ug(this,e,r,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>WE){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,a){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,a){var n,s;const o=e.toLocaleLowerCase(),{close:u,error:f,leave:h,join:m}=Wo;if(a&&[u,f,h,m].indexOf(o)>=0&&a!==this._joinRef())return;let y=this._onMessage(o,r,a);if(r&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(g=>{var b,_,S;return((b=g.filter)===null||b===void 0?void 0:b.event)==="*"||((S=(_=g.filter)===null||_===void 0?void 0:_.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(g=>g.callback(y,a)):(s=this.bindings[o])===null||s===void 0||s.filter(g=>{var b,_,S,E,C,j;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in g){const R=g.id,H=(b=g.filter)===null||b===void 0?void 0:b.event;return R&&((_=r.ids)===null||_===void 0?void 0:_.includes(R))&&(H==="*"||H?.toLocaleLowerCase()===((S=r.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const R=(C=(E=g?.filter)===null||E===void 0?void 0:E.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return R==="*"||R===((j=r?.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===o}).map(g=>{if(typeof y=="object"&&"ids"in y){const b=y.data,{schema:_,table:S,commit_timestamp:E,type:C,errors:j}=b;y=Object.assign(Object.assign({},{schema:_,table:S,commit_timestamp:E,eventType:C,new:{},old:{},errors:j}),this._getPayloadRecords(b))}g.callback(y,a)})}_isClosed(){return this.state===Gn.closed}_isJoined(){return this.state===Gn.joined}_isJoining(){return this.state===Gn.joining}_isLeaving(){return this.state===Gn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,a){const n=e.toLocaleLowerCase(),s={type:n,filter:r,callback:a};return this.bindings[n]?this.bindings[n].push(s):this.bindings[n]=[s],this}_off(e,r){const a=e.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var s;return!(((s=n.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===a&&U2.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const a in e)if(e[a]!==r[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Wo.close,{},e)}_onError(e){this._on(Wo.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Gn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Sb(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Sb(e.columns,e.old_record)),r}}const qg=()=>{},Km={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},QE=[1e3,2e3,5e3,1e4],eA=1e4,tA=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class rA{constructor(e,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Kv,this.transport=null,this.heartbeatIntervalMs=Km.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=qg,this.ref=0,this.reconnectTimer=null,this.vsn=wb,this.logger=qg,this.conn=null,this.sendBuffer=[],this.serializer=new VE,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...s)=>n(...s):(...s)=>fetch(...s),!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Jv.websocket}`,this.httpEndpoint=m4(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=UE.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,a){this.logger(e,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case tf.connecting:return rf.Connecting;case tf.open:return rf.Open;case tf.closing:return rf.Closing;default:return rf.Closed}}isConnected(){return this.connectionState()===rf.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const a=`realtime:${e}`,n=this.getChannels().find(s=>s.topic===a);if(n)return n;{const s=new U2(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:a,payload:n,ref:s}=e,o=()=>{this.encode(e,u=>{var f;(f=this.conn)===null||f===void 0||f.send(u)})};this.log("push",`${r} ${a} (${s})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close($E,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Km.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(a=>a.topic===e&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(h){this.log("error","error in heartbeat callback",h)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:n,payload:s,ref:o}=r,u=o?`(${o})`:"",f=s.status||"";this.log("receive",`${f} ${a} ${n} ${u}`.trim(),s),this.channels.filter(h=>h._isMember(a)).forEach(h=>h._trigger(n,s,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===tf.open||this.conn.readyState===tf.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Wo.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const a=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${a}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const a=new Blob([tA],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const n={access_token:r,version:zE};r&&a.updateJoinPayload(n),a.joinedOnce&&a._isJoined()&&a._push(Wo.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(a=>{try{a(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(a){this.log("error",`error triggering ${e} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new h4(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Km.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,a,n,s,o,u,f,h,m,v,y,g;switch(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=e?.timeout)!==null&&a!==void 0?a:Kv,this.heartbeatIntervalMs=(n=e?.heartbeatIntervalMs)!==null&&n!==void 0?n:Km.HEARTBEAT_INTERVAL,this.worker=(s=e?.worker)!==null&&s!==void 0?s:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(u=e?.heartbeatCallback)!==null&&u!==void 0?u:qg,this.vsn=(f=e?.vsn)!==null&&f!==void 0?f:wb,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e?.reconnectAfterMs)!==null&&h!==void 0?h:(b=>QE[b-1]||eA),this.vsn){case f4:this.encode=(m=e?.encode)!==null&&m!==void 0?m:((b,_)=>_(JSON.stringify(b))),this.decode=(v=e?.decode)!==null&&v!==void 0?v:((b,_)=>_(JSON.parse(b)));break;case HE:this.encode=(y=e?.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(g=e?.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class s1 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function tn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class aA extends s1{constructor(e,r,a){super(e),this.name="StorageApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Qv extends s1{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const q2=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),nA=()=>Response,e2=t=>{if(Array.isArray(t))return t.map(r=>e2(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,a])=>{const n=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[n]=e2(a)}),e},sA=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},iA=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t),zg=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},oA=(t,e,r)=>Qt(void 0,void 0,void 0,function*(){const a=yield nA();t instanceof a&&!r?.noResolveJson?t.json().then(n=>{const s=t.status||500,o=n?.statusCode||s+"";e(new aA(zg(n),s,o))}).catch(n=>{e(new Qv(zg(n),n))}):e(new Qv(zg(t),t))}),lA=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"||!a?n:(sA(a)?(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(a)):n.body=a,e?.duplex&&(n.duplex=e.duplex),Object.assign(Object.assign({},n),r))};function U0(t,e,r,a,n,s){return Qt(this,void 0,void 0,function*(){return new Promise((o,u)=>{t(r,lA(e,a,n,s)).then(f=>{if(!f.ok)throw f;return a?.noResolveJson?f:f.json()}).then(f=>o(f)).catch(f=>oA(f,u,a))})})}function y0(t,e,r,a){return Qt(this,void 0,void 0,function*(){return U0(t,"GET",e,r,a)})}function $o(t,e,r,a,n){return Qt(this,void 0,void 0,function*(){return U0(t,"POST",e,a,n,r)})}function t2(t,e,r,a,n){return Qt(this,void 0,void 0,function*(){return U0(t,"PUT",e,a,n,r)})}function cA(t,e,r,a){return Qt(this,void 0,void 0,function*(){return U0(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}function z2(t,e,r,a,n){return Qt(this,void 0,void 0,function*(){return U0(t,"DELETE",e,a,n,r)})}class uA{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return Qt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(tn(e))return{data:null,error:e};throw e}})}}var p4;class fA{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[p4]="BlobDownloadBuilder",this.promise=null}asStream(){return new uA(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Qt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(tn(e))return{data:null,error:e};throw e}})}}p4=Symbol.toStringTag;const hA={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},jb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class dA{constructor(e,r={},a,n){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=a,this.fetch=q2(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,a,n){return Qt(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},jb),n);let u=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const f=o.metadata;typeof Blob<"u"&&a instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),f&&s.append("metadata",this.encodeMetadata(f)),s.append("",a)):typeof FormData<"u"&&a instanceof FormData?(s=a,s.has("cacheControl")||s.append("cacheControl",o.cacheControl),f&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(f))):(s=a,u["cache-control"]=`max-age=${o.cacheControl}`,u["content-type"]=o.contentType,f&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(f))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!o.duplex&&(o.duplex="half")),n?.headers&&(u=Object.assign(Object.assign({},u),n.headers));const h=this._removeEmptyFolders(r),m=this._getFinalPath(h),v=yield(e=="PUT"?t2:$o)(this.fetch,`${this.url}/object/${m}`,s,Object.assign({headers:u},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:h,id:v.Id,fullPath:v.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(tn(s))return{data:null,error:s};throw s}})}upload(e,r,a){return Qt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,a)})}uploadToSignedUrl(e,r,a,n){return Qt(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),u=new URL(this.url+`/object/upload/sign/${o}`);u.searchParams.set("token",r);try{let f;const h=Object.assign({upsert:jb.upsert},n),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&a instanceof Blob?(f=new FormData,f.append("cacheControl",h.cacheControl),f.append("",a)):typeof FormData<"u"&&a instanceof FormData?(f=a,f.append("cacheControl",h.cacheControl)):(f=a,m["cache-control"]=`max-age=${h.cacheControl}`,m["content-type"]=h.contentType);const v=yield t2(this.fetch,u.toString(),f,{headers:m});return{data:{path:s,fullPath:v.Key},error:null}}catch(f){if(this.shouldThrowOnError)throw f;if(tn(f))return{data:null,error:f};throw f}})}createSignedUploadUrl(e,r){return Qt(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e);const n=Object.assign({},this.headers);r?.upsert&&(n["x-upsert"]="true");const s=yield $o(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:n}),o=new URL(this.url+s.url),u=o.searchParams.get("token");if(!u)throw new s1("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:u},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(tn(a))return{data:null,error:a};throw a}})}update(e,r,a){return Qt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,a)})}move(e,r,a){return Qt(this,void 0,void 0,function*(){try{return{data:yield $o(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(tn(n))return{data:null,error:n};throw n}})}copy(e,r,a){return Qt(this,void 0,void 0,function*(){try{return{data:{path:(yield $o(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(tn(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,a){return Qt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),s=yield $o(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},a?.transform?{transform:a.transform}:{}),{headers:this.headers});const o=a?.download?`&download=${a.download===!0?"":a.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(tn(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,a){return Qt(this,void 0,void 0,function*(){try{const n=yield $o(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),s=a?.download?`&download=${a.download===!0?"":a.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(tn(n))return{data:null,error:n};throw n}})}download(e,r){const n=typeof r?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(r?.transform||{}),o=s?`?${s}`:"",u=this._getFinalPath(e),f=()=>y0(this.fetch,`${this.url}/${n}/${u}${o}`,{headers:this.headers,noResolveJson:!0});return new fA(f,this.shouldThrowOnError)}info(e){return Qt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const a=yield y0(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:e2(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(tn(a))return{data:null,error:a};throw a}})}exists(e){return Qt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield cA(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(tn(a)&&a instanceof Qv){const n=a.originalError;if([400,404].includes(n?.status))return{data:!1,error:a}}throw a}})}getPublicUrl(e,r){const a=this._getFinalPath(e),n=[],s=r?.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&n.push(s);const u=typeof r?.transform<"u"?"render/image":"object",f=this.transformOptsToQueryString(r?.transform||{});f!==""&&n.push(f);let h=n.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${a}${h}`)}}}remove(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield z2(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}list(e,r,a){return Qt(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},hA),r),{prefix:e||""});return{data:yield $o(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},a),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(tn(n))return{data:null,error:n};throw n}})}listV2(e,r){return Qt(this,void 0,void 0,function*(){try{const a=Object.assign({},e);return{data:yield $o(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(tn(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const g4="2.86.0",v4={"X-Client-Info":`storage-js/${g4}`};class mA{constructor(e,r={},a,n){this.shouldThrowOnError=!1;const s=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},v4),r),this.fetch=q2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return Qt(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield y0(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}getBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield y0(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}createBucket(e){return Qt(this,arguments,void 0,function*(r,a={public:!1}){try{return{data:yield $o(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(tn(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return Qt(this,void 0,void 0,function*(){try{return{data:yield t2(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(tn(a))return{data:null,error:a};throw a}})}emptyBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield $o(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield z2(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}var _0=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function pA(t,e,r){const a=new URL(e,t);if(r)for(const[n,s]of Object.entries(r))s!==void 0&&a.searchParams.set(n,s);return a.toString()}async function gA(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function vA(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:n,body:s,headers:o}){const u=pA(t.baseUrl,a,n),f=await gA(t.auth),h=await e(u,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...f,...o},body:s?JSON.stringify(s):void 0}),m=await h.text(),v=(h.headers.get("content-type")||"").includes("application/json"),y=v&&m?JSON.parse(m):m;if(!h.ok){const g=v?y:void 0,b=g?.error;throw new _0(b?.message??`Request failed with status ${h.status}`,{status:h.status,icebergType:b?.type,icebergCode:b?.code,details:g})}return{status:h.status,headers:h.headers,data:y}}}}function Jm(t){return t.join("")}var xA=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:Jm(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Jm(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Jm(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Jm(t.namespace)}`}),!0}catch(e){if(e instanceof _0&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof _0&&r.status===409)return;throw r}}};function kh(t){return t.join("")}var yA=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${kh(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${kh(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${kh(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${kh(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${kh(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${kh(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof _0&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof _0&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},_A=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=vA({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new xA(this.client,e),this.tableOps=new yA(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}};class bA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},v4),r),this.fetch=q2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield $o(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}listBuckets(e){return Qt(this,void 0,void 0,function*(){try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const a=r.toString(),n=a?`${this.url}/bucket?${a}`:`${this.url}/bucket`;return{data:yield y0(this.fetch,n,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield z2(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}from(e){if(!iA(e))throw new s1("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");return new _A({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>Qt(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch})}}const H2={"X-Client-Info":`storage-js/${g4}`,"Content-Type":"application/json"};class x4 extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Fi(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class Hg extends x4{constructor(e,r,a){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class wA extends x4{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var Eb;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Eb||(Eb={}));const $2=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),SA=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Ab=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),NA=(t,e,r)=>Qt(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!r?.noResolveJson){const n=t.status||500,s=t;if(typeof s.json=="function")s.json().then(o=>{const u=o?.statusCode||o?.code||n+"";e(new Hg(Ab(o),n,u))}).catch(()=>{const o=n+"",u=s.statusText||`HTTP ${n} error`;e(new Hg(u,n,o))});else{const o=n+"",u=s.statusText||`HTTP ${n} error`;e(new Hg(u,n,o))}}else e(new wA(Ab(t),t))}),kA=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return a?(SA(a)?(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(a)):n.body=a,Object.assign(Object.assign({},n),r)):n};function jA(t,e,r,a,n,s){return Qt(this,void 0,void 0,function*(){return new Promise((o,u)=>{t(r,kA(e,a,n,s)).then(f=>{if(!f.ok)throw f;if(a?.noResolveJson)return f;const h=f.headers.get("content-type");return!h||!h.includes("application/json")?{}:f.json()}).then(f=>o(f)).catch(f=>NA(f,u,a))})})}function Li(t,e,r,a,n){return Qt(this,void 0,void 0,function*(){return jA(t,"POST",e,a,n,r)})}class EA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},H2),r),this.fetch=$2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return Qt(this,void 0,void 0,function*(){try{return{data:(yield Li(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}getIndex(e,r){return Qt(this,void 0,void 0,function*(){try{return{data:yield Li(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Fi(a))return{data:null,error:a};throw a}})}listIndexes(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield Li(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return Qt(this,void 0,void 0,function*(){try{return{data:(yield Li(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Fi(a))return{data:null,error:a};throw a}})}}class AA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},H2),r),this.fetch=$2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return Qt(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Li(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}getVectors(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield Li(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}listVectors(e){return Qt(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Li(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}queryVectors(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield Li(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}deleteVectors(e){return Qt(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Li(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}}class CA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},H2),r),this.fetch=$2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:(yield Li(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}getBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield Li(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}listBuckets(){return Qt(this,arguments,void 0,function*(e={}){try{return{data:yield Li(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:(yield Li(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}}class TA extends CA{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new OA(this.url,this.headers,e,this.fetch)}createBucket(e){const r=Object.create(null,{createBucket:{get:()=>super.createBucket}});return Qt(this,void 0,void 0,function*(){return r.createBucket.call(this,e)})}getBucket(e){const r=Object.create(null,{getBucket:{get:()=>super.getBucket}});return Qt(this,void 0,void 0,function*(){return r.getBucket.call(this,e)})}listBuckets(){const e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return Qt(this,arguments,void 0,function*(r={}){return e.listBuckets.call(this,r)})}deleteBucket(e){const r=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return Qt(this,void 0,void 0,function*(){return r.deleteBucket.call(this,e)})}}class OA extends EA{constructor(e,r,a,n){super(e,r,n),this.vectorBucketName=a}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Qt(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Qt(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Qt(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Qt(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new RA(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class RA extends AA{constructor(e,r,a,n,s){super(e,r,s),this.vectorBucketName=a,this.indexName=n}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Qt(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Qt(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Qt(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Qt(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Qt(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class DA extends mA{constructor(e,r={},a,n){super(e,r,a,n)}from(e){return new dA(this.url,this.headers,e,this.fetch)}get vectors(){return new TA(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new bA(this.url+"/iceberg",this.headers,this.fetch)}}const FA="2.86.0";let t0="";typeof Deno<"u"?t0="deno":typeof document<"u"?t0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?t0="react-native":t0="node";const LA={"X-Client-Info":`supabase-js-${t0}/${FA}`},PA={headers:LA},MA={schema:"public"},IA={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},BA={},UA=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),qA=()=>Headers,zA=(t,e,r)=>{const a=UA(r),n=qA();return async(s,o)=>{var u;const f=(u=await e())!==null&&u!==void 0?u:t;let h=new n(o?.headers);return h.has("apikey")||h.set("apikey",t),h.has("Authorization")||h.set("Authorization",`Bearer ${f}`),a(s,Object.assign(Object.assign({},o),{headers:h}))}};function HA(t){return t.endsWith("/")?t:t+"/"}function $A(t,e){var r,a;const{db:n,auth:s,realtime:o,global:u}=t,{db:f,auth:h,realtime:m,global:v}=e,y={db:Object.assign(Object.assign({},f),n),auth:Object.assign(Object.assign({},h),s),realtime:Object.assign(Object.assign({},m),o),storage:{},global:Object.assign(Object.assign(Object.assign({},v),u),{headers:Object.assign(Object.assign({},(r=v?.headers)!==null&&r!==void 0?r:{}),(a=u?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return t.accessToken?y.accessToken=t.accessToken:delete y.accessToken,y}function WA(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(HA(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const y4="2.86.0",Mh=30*1e3,r2=3,$g=r2*Mh,VA="http://localhost:9999",GA="supabase.auth.token",YA={"X-Client-Info":`gotrue-js/${y4}`},a2="X-Supabase-Api-Version",_4={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},XA=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,KA=600*1e3;class b0 extends Error{constructor(e,r,a){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function ir(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class JA extends b0{constructor(e,r,a){super(e,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function ZA(t){return ir(t)&&t.name==="AuthApiError"}class af extends b0{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class vu extends b0{constructor(e,r,a,n){super(e,a,n),this.name=r,this.status=a}}class Oi extends vu{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function QA(t){return ir(t)&&t.name==="AuthSessionMissingError"}class jh extends vu{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Zm extends vu{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Qm extends vu{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function e6(t){return ir(t)&&t.name==="AuthImplicitGrantRedirectError"}class Cb extends vu{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class n2 extends vu{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Wg(t){return ir(t)&&t.name==="AuthRetryableFetchError"}class Tb extends vu{constructor(e,r,a){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class s2 extends vu{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Lp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ob=` 	
\r=`.split(""),t6=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Ob.length;e+=1)t[Ob[e].charCodeAt(0)]=-2;for(let e=0;e<Lp.length;e+=1)t[Lp[e].charCodeAt(0)]=e;return t})();function Rb(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;r(Lp[a]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;r(Lp[a]),e.queuedBits-=6}}function b4(t,e,r){const a=t6[t];if(a>-1)for(e.queue=e.queue<<6|a,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Db(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},s=o=>{n6(o,a,r)};for(let o=0;o<t.length;o+=1)b4(t.charCodeAt(o),n,s);return e.join("")}function r6(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function a6(t,e){for(let r=0;r<t.length;r+=1){let a=t.charCodeAt(r);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}r6(a,e)}}function n6(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let a=1;a<6;a+=1)if((t>>7-a&1)===0){e.utf8seq=a;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Wh(t){const e=[],r={queue:0,queuedBits:0},a=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)b4(t.charCodeAt(n),r,a);return new Uint8Array(e)}function s6(t){const e=[];return a6(t,r=>e.push(r)),new Uint8Array(e)}function of(t){const e=[],r={queue:0,queuedBits:0},a=n=>{e.push(n)};return t.forEach(n=>Rb(n,r,a)),Rb(null,r,a),e.join("")}function i6(t){return Math.round(Date.now()/1e3)+t}function o6(){return Symbol("auth-callback")}const vs=()=>typeof window<"u"&&typeof document<"u",Xu={tested:!1,writable:!1},w4=()=>{if(!vs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Xu.tested)return Xu.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Xu.tested=!0,Xu.writable=!0}catch{Xu.tested=!0,Xu.writable=!1}return Xu.writable};function l6(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,s)=>{e[s]=n})}catch{}return r.searchParams.forEach((a,n)=>{e[n]=a}),e}const S4=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),c6=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ih=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Ku=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Qc=async(t,e)=>{await t.removeItem(e)};class i1{constructor(){this.promise=new i1.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}i1.promiseConstructor=Promise;function Vg(t){const e=t.split(".");if(e.length!==3)throw new s2("Invalid JWT structure");for(let a=0;a<e.length;a++)if(!XA.test(e[a]))throw new s2("JWT not in base64url format");return{header:JSON.parse(Db(e[0])),payload:JSON.parse(Db(e[1])),signature:Wh(e[2]),raw:{header:e[0],payload:e[1]}}}async function u6(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function f6(t,e){return new Promise((a,n)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await t(s);if(!e(s,null,o)){a(o);return}}catch(o){if(!e(s,o)){n(o);return}}})()})}function h6(t){return("0"+t.toString(16)).substr(-2)}function d6(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let n="";for(let s=0;s<56;s++)n+=r.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(e),Array.from(e,h6).join("")}async function m6(t){const r=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(a);return Array.from(n).map(s=>String.fromCharCode(s)).join("")}async function p6(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await m6(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Eh(t,e,r=!1){const a=d6();let n=a;r&&(n+="/PASSWORD_RECOVERY"),await Ih(t,`${e}-code-verifier`,n);const s=await p6(a);return[s,a===s?"plain":"s256"]}const g6=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function v6(t){const e=t.headers.get(a2);if(!e||!e.match(g6))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function x6(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function y6(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const _6=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ah(t){if(!_6.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Gg(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function b6(t,e){return new Proxy(t,{get:(r,a,n)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const s=a.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,n)}return!e.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,a,n)}})}function Fb(t){return JSON.parse(JSON.stringify(t))}const Qu=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),w6=[502,503,504];async function Lb(t){var e;if(!c6(t))throw new n2(Qu(t),0);if(w6.includes(t.status))throw new n2(Qu(t),t.status);let r;try{r=await t.json()}catch(s){throw new af(Qu(s),s)}let a;const n=v6(t);if(n&&n.getTime()>=_4["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new Tb(Qu(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(a==="session_not_found")throw new Oi}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new Tb(Qu(r),t.status,r.weak_password.reasons);throw new JA(Qu(r),t.status||500,a)}const S6=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),r))};async function vr(t,e,r,a){var n;const s=Object.assign({},a?.headers);s[a2]||(s[a2]=_4["2024-01-01"].name),a?.jwt&&(s.Authorization=`Bearer ${a.jwt}`);const o=(n=a?.query)!==null&&n!==void 0?n:{};a?.redirectTo&&(o.redirect_to=a.redirectTo);const u=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",f=await N6(t,e,r+u,{headers:s,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(f):{data:Object.assign({},f),error:null}}async function N6(t,e,r,a,n,s){const o=S6(e,a,n,s);let u;try{u=await t(r,Object.assign({},o))}catch(f){throw console.error(f),new n2(Qu(f),0)}if(u.ok||await Lb(u),a?.noResolveJson)return u;try{return await u.json()}catch(f){await Lb(f)}}function Ho(t){var e;let r=null;E6(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=i6(t.expires_in)));const a=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:a},error:null}}function Pb(t){const e=Ho(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(e.data.weak_password=t.weak_password),e}function iu(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function k6(t){return{data:t,error:null}}function j6(t){const{action_link:e,email_otp:r,hashed_token:a,redirect_to:n,verification_type:s}=t,o=sd(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:e,email_otp:r,hashed_token:a,redirect_to:n,verification_type:s},f=Object.assign({},o);return{data:{properties:u,user:f},error:null}}function Mb(t){return t}function E6(t){return t.access_token&&t.refresh_token&&t.expires_in}const Yg=["global","local","others"];class A6{constructor({url:e="",headers:r={},fetch:a}){this.url=e,this.headers=r,this.fetch=S4(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=Yg[0]){if(Yg.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Yg.join(", ")}`);try{return await vr(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(a){if(ir(a))return{data:null,error:a};throw a}}async inviteUserByEmail(e,r={}){try{return await vr(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:iu})}catch(a){if(ir(a))return{data:{user:null},error:a};throw a}}async generateLink(e){try{const{options:r}=e,a=sd(e,["options"]),n=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(n.new_email=a?.newEmail,delete n.newEmail),await vr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:j6,redirectTo:r?.redirectTo})}catch(r){if(ir(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await vr(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:iu})}catch(r){if(ir(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,a,n,s,o,u,f;try{const h={nextPage:null,lastPage:0,total:0},m=await vr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(s=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""},xform:Mb});if(m.error)throw m.error;const v=await m.json(),y=(o=m.headers.get("x-total-count"))!==null&&o!==void 0?o:0,g=(f=(u=m.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&f!==void 0?f:[];return g.length>0&&(g.forEach(b=>{const _=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);h[`${S}Page`]=_}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},v),h),error:null}}catch(h){if(ir(h))return{data:{users:[]},error:h};throw h}}async getUserById(e){Ah(e);try{return await vr(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:iu})}catch(r){if(ir(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Ah(e);try{return await vr(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:iu})}catch(a){if(ir(a))return{data:{user:null},error:a};throw a}}async deleteUser(e,r=!1){Ah(e);try{return await vr(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:iu})}catch(a){if(ir(a))return{data:{user:null},error:a};throw a}}async _listFactors(e){Ah(e.userId);try{const{data:r,error:a}=await vr(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:a}}catch(r){if(ir(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Ah(e.userId),Ah(e.id);try{return{data:await vr(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(ir(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,a,n,s,o,u,f;try{const h={nextPage:null,lastPage:0,total:0},m=await vr(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(s=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""},xform:Mb});if(m.error)throw m.error;const v=await m.json(),y=(o=m.headers.get("x-total-count"))!==null&&o!==void 0?o:0,g=(f=(u=m.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&f!==void 0?f:[];return g.length>0&&(g.forEach(b=>{const _=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);h[`${S}Page`]=_}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},v),h),error:null}}catch(h){if(ir(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(e){try{return await vr(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ir(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await vr(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ir(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await vr(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(ir(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(e){try{return await vr(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ir(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await vr(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ir(r))return{data:null,error:r};throw r}}}function Ib(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const Ch={debug:!!(globalThis&&w4()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class N4 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class C6 extends N4{}async function T6(t,e,r){Ch.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const a=new globalThis.AbortController;return e>0&&setTimeout(()=>{a.abort(),Ch.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){Ch.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{Ch.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Ch.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new C6(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Ch.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function O6(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function k4(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function R6(t){return parseInt(t,16)}function D6(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,a=>a.toString(16).padStart(2,"0")).join("")}function F6(t){var e;const{chainId:r,domain:a,expirationTime:n,issuedAt:s=new Date,nonce:o,notBefore:u,requestId:f,resources:h,scheme:m,uri:v,version:y}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!v)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const g=k4(t.address),b=m?`${m}://${a}`:a,_=t.statement?`${t.statement}
`:"",S=`${b} wants you to sign in with your Ethereum account:
${g}

${_}`;let E=`URI: ${v}
Version: ${y}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${s.toISOString()}`;if(n&&(E+=`
Expiration Time: ${n.toISOString()}`),u&&(E+=`
Not Before: ${u.toISOString()}`),f&&(E+=`
Request ID: ${f}`),h){let C=`
Resources:`;for(const j of h){if(!j||typeof j!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${j}`);C+=`
- ${j}`}E+=C}return`${S}
${E}`}class Mn extends Error{constructor({message:e,code:r,cause:a,name:n}){var s;super(e,{cause:a}),this.__isWebAuthnError=!0,this.name=(s=n??(a instanceof Error?a.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class Pp extends Mn{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function L6({error:t,options:e}){var r,a,n;const{publicKey:s}=e;if(!s)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Mn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Mn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((a=s.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Mn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Mn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Mn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Mn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return s.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new Mn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Mn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(j4(o)){if(s.rp.id!==o)return new Mn({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Mn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Mn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Mn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Mn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function P6({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Mn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Mn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if(j4(a)){if(r.rpId!==a)return new Mn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Mn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Mn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Mn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class M6{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const I6=new M6;function B6(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:a}=t,n=sd(t,["challenge","user","excludeCredentials"]),s=Wh(e).buffer,o=Object.assign(Object.assign({},r),{id:Wh(r.id).buffer}),u=Object.assign(Object.assign({},n),{challenge:s,user:o});if(a&&a.length>0){u.excludeCredentials=new Array(a.length);for(let f=0;f<a.length;f++){const h=a[f];u.excludeCredentials[f]=Object.assign(Object.assign({},h),{id:Wh(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return u}function U6(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,a=sd(t,["challenge","allowCredentials"]),n=Wh(e).buffer,s=Object.assign(Object.assign({},a),{challenge:n});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const u=r[o];s.allowCredentials[o]=Object.assign(Object.assign({},u),{id:Wh(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return s}function q6(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:of(new Uint8Array(t.response.attestationObject)),clientDataJSON:of(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function z6(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,a=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:of(new Uint8Array(n.authenticatorData)),clientDataJSON:of(new Uint8Array(n.clientDataJSON)),signature:of(new Uint8Array(n.signature)),userHandle:n.userHandle?of(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function j4(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Bb(){var t,e;return!!(vs()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function H6(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Pp("Browser returned unexpected credential type",e)}:{data:null,error:new Pp("Empty credential response",e)}}catch(e){return{data:null,error:L6({error:e,options:t})}}}async function $6(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Pp("Browser returned unexpected credential type",e)}:{data:null,error:new Pp("Empty credential response",e)}}catch(e){return{data:null,error:P6({error:e,options:t})}}}const W6={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},V6={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Mp(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),a={};for(const n of t)if(n)for(const s in n){const o=n[s];if(o!==void 0)if(Array.isArray(o))a[s]=o;else if(r(o))a[s]=o;else if(e(o)){const u=a[s];e(u)?a[s]=Mp(u,o):a[s]=Mp(o)}else a[s]=o}return a}function G6(t,e){return Mp(W6,t,e||{})}function Y6(t,e){return Mp(V6,t,e||{})}class X6{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:a,signal:n},s){try{const{data:o,error:u}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!o)return{data:null,error:u};const f=n??I6.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:h}=o.webauthn.credential_options.publicKey;h.name||(h.name=`${h.id}:${a}`),h.displayName||(h.displayName=h.name)}switch(o.webauthn.type){case"create":{const h=G6(o.webauthn.credential_options.publicKey,s?.create),{data:m,error:v}=await H6({publicKey:h,signal:f});return m?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:m}},error:null}:{data:null,error:v}}case"request":{const h=Y6(o.webauthn.credential_options.publicKey,s?.request),{data:m,error:v}=await $6(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:h,signal:f}));return m?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:m}},error:null}:{data:null,error:v}}}}catch(o){return ir(o)?{data:null,error:o}:{data:null,error:new af("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:a})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},s){if(!r)return{data:null,error:new b0("rpId is required for WebAuthn authentication")};try{if(!Bb())return{data:null,error:new af("Browser does not support WebAuthn",null)};const{data:o,error:u}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:a},signal:n},{request:s});if(!o)return{data:null,error:u};const{webauthn:f}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:f.type,rpId:r,rpOrigins:a,credential_response:f.credential_response}})}catch(o){return ir(o)?{data:null,error:o}:{data:null,error:new af("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},s){if(!r)return{data:null,error:new b0("rpId is required for WebAuthn registration")};try{if(!Bb())return{data:null,error:new af("Browser does not support WebAuthn",null)};const{data:o,error:u}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(m=>{var v;return(v=m.data)===null||v===void 0?void 0:v.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===e&&y.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m?.id}):void 0),{data:null,error:u};const{data:f,error:h}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:n},{create:s});return f?this._verify({factorId:o.id,challengeId:f.challengeId,webauthn:{rpId:r,rpOrigins:a,type:f.webauthn.type,credential_response:f.webauthn.credential_response}}):{data:null,error:h}}catch(o){return ir(o)?{data:null,error:o}:{data:null,error:new af("Unexpected error in register",o)}}}}O6();const K6={url:VA,storageKey:GA,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:YA,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Ub(t,e,r){return await r()}const Th={};class w0{get jwks(){var e,r;return(r=(e=Th[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Th[this.storageKey]=Object.assign(Object.assign({},Th[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Th[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Th[this.storageKey]=Object.assign(Object.assign({},Th[this.storageKey]),{cachedAt:e})}constructor(e){var r,a,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},K6),e);if(this.storageKey=s.storageKey,this.instanceID=(r=w0.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,w0.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&vs()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new A6({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=S4(s.fetch),this.lock=s.lock||Ub,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,s.lock?this.lock=s.lock:vs()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=T6:this.lock=Ub,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new X6(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:w4()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ib(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Ib(this.memoryStorage)),vs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${y4}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},a="none";if(vs()&&(r=l6(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),vs()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:s}=await this._getSessionFromURL(r,a);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),e6(s)){const f=(e=s.details)===null||e===void 0?void 0:e.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:u}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",u),await this._saveSession(o),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ir(r)?this._returnResult({error:r}):this._returnResult({error:new af("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,a,n;try{const s=await vr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Ho}),{data:o,error:u}=s;if(u||!o)return this._returnResult({data:{user:null,session:null},error:u});const f=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:h,session:f},error:null})}catch(s){if(ir(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(e){var r,a,n;try{let s;if("email"in e){const{email:m,password:v,options:y}=e;let g=null,b=null;this.flowType==="pkce"&&([g,b]=await Eh(this.storage,this.storageKey)),s=await vr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:m,password:v,data:(r=y?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:g,code_challenge_method:b},xform:Ho})}else if("phone"in e){const{phone:m,password:v,options:y}=e;s=await vr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:v,data:(a=y?.data)!==null&&a!==void 0?a:{},channel:(n=y?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:Ho})}else throw new Zm("You must provide either an email or phone number and a password");const{data:o,error:u}=s;if(u||!o)return this._returnResult({data:{user:null,session:null},error:u});const f=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:h,session:f},error:null})}catch(s){if(ir(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:o,options:u}=e;r=await vr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Pb})}else if("phone"in e){const{phone:s,password:o,options:u}=e;r=await vr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Pb})}else throw new Zm("You must provide either an email or phone number and a password");const{data:a,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!a||!a.session||!a.user){const s=new jh;return this._returnResult({data:{user:null,session:null},error:s})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(r){if(ir(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,a,n,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,a,n,s,o,u,f,h,m,v,y;let g,b;if("message"in e)g=e.message,b=e.signature;else{const{chain:_,wallet:S,statement:E,options:C}=e;let j;if(vs())if(typeof S=="object")j=S;else{const F=window;if("ethereum"in F&&typeof F.ethereum=="object"&&"request"in F.ethereum&&typeof F.ethereum.request=="function")j=F.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=S}const R=new URL((r=C?.url)!==null&&r!==void 0?r:window.location.href),H=await j.request({method:"eth_requestAccounts"}).then(F=>F).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!H||H.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const Y=k4(H[0]);let U=(a=C?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!U){const F=await j.request({method:"eth_chainId"});U=R6(F)}const V={domain:R.host,address:Y,statement:E,uri:R.href,version:"1",chainId:U,nonce:(n=C?.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(o=(s=C?.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(u=C?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(f=C?.signInWithEthereum)===null||f===void 0?void 0:f.notBefore,requestId:(h=C?.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(m=C?.signInWithEthereum)===null||m===void 0?void 0:m.resources};g=F6(V),b=await j.request({method:"personal_sign",params:[D6(g),Y]})}try{const{data:_,error:S}=await vr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:b},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Ho});if(S)throw S;if(!_||!_.session||!_.user){const E=new jh;return this._returnResult({data:{user:null,session:null},error:E})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:S})}catch(_){if(ir(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var r,a,n,s,o,u,f,h,m,v,y,g;let b,_;if("message"in e)b=e.message,_=e.signature;else{const{chain:S,wallet:E,statement:C,options:j}=e;let R;if(vs())if(typeof E=="object")R=E;else{const Y=window;if("solana"in Y&&typeof Y.solana=="object"&&("signIn"in Y.solana&&typeof Y.solana.signIn=="function"||"signMessage"in Y.solana&&typeof Y.solana.signMessage=="function"))R=Y.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!j?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");R=E}const H=new URL((r=j?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in R&&R.signIn){const Y=await R.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},j?.signInWithSolana),{version:"1",domain:H.host,uri:H.href}),C?{statement:C}:null));let U;if(Array.isArray(Y)&&Y[0]&&typeof Y[0]=="object")U=Y[0];else if(Y&&typeof Y=="object"&&"signedMessage"in Y&&"signature"in Y)U=Y;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in U&&"signature"in U&&(typeof U.signedMessage=="string"||U.signedMessage instanceof Uint8Array)&&U.signature instanceof Uint8Array)b=typeof U.signedMessage=="string"?U.signedMessage:new TextDecoder().decode(U.signedMessage),_=U.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in R)||typeof R.signMessage!="function"||!("publicKey"in R)||typeof R!="object"||!R.publicKey||!("toBase58"in R.publicKey)||typeof R.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${H.host} wants you to sign in with your Solana account:`,R.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${H.href}`,`Issued At: ${(n=(a=j?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((s=j?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${j.signInWithSolana.notBefore}`]:[],...!((o=j?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${j.signInWithSolana.expirationTime}`]:[],...!((u=j?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${j.signInWithSolana.chainId}`]:[],...!((f=j?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${j.signInWithSolana.nonce}`]:[],...!((h=j?.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${j.signInWithSolana.requestId}`]:[],...!((v=(m=j?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||v===void 0)&&v.length?["Resources",...j.signInWithSolana.resources.map(U=>`- ${U}`)]:[]].join(`
`);const Y=await R.signMessage(new TextEncoder().encode(b),"utf8");if(!Y||!(Y instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=Y}}try{const{data:S,error:E}=await vr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:of(_)},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Ho});if(E)throw E;if(!S||!S.session||!S.user){const C=new jh;return this._returnResult({data:{user:null,session:null},error:C})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:E})}catch(S){if(ir(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(e){const r=await Ku(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(r??"").split("/");try{const{data:s,error:o}=await vr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:a},xform:Ho});if(await Qc(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!s||!s.session||!s.user){const u=new jh;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:n??null}),error:o})}catch(s){if(ir(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(e){try{const{options:r,provider:a,token:n,access_token:s,nonce:o}=e,u=await vr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Ho}),{data:f,error:h}=u;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!f||!f.session||!f.user){const m=new jh;return this._returnResult({data:{user:null,session:null},error:m})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:f,error:h})}catch(r){if(ir(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,a,n,s,o;try{if("email"in e){const{email:u,options:f}=e;let h=null,m=null;this.flowType==="pkce"&&([h,m]=await Eh(this.storage,this.storageKey));const{error:v}=await vr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=f?.data)!==null&&r!==void 0?r:{},create_user:(a=f?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:h,code_challenge_method:m},redirectTo:f?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:v})}if("phone"in e){const{phone:u,options:f}=e,{data:h,error:m}=await vr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(n=f?.data)!==null&&n!==void 0?n:{},create_user:(s=f?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(o=f?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:m})}throw new Zm("You must provide either an email or phone number.")}catch(u){if(ir(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(e){var r,a;try{let n,s;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(a=e.options)===null||a===void 0?void 0:a.captchaToken);const{data:o,error:u}=await vr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:n,xform:Ho});if(u)throw u;if(!o)throw new Error("An error occurred on token verification.");const f=o.session,h=o.user;return f?.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),this._returnResult({data:{user:h,session:f},error:null})}catch(n){if(ir(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,a,n,s,o;try{let u=null,f=null;this.flowType==="pkce"&&([u,f]=await Eh(this.storage,this.storageKey));const h=await vr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(a=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:f}),headers:this.headers,xform:k6});return!((s=h.data)===null||s===void 0)&&s.url&&vs()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(h.data.url),this._returnResult(h)}catch(u){if(ir(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:a}=e;if(a)throw a;if(!r)throw new Oi;const{error:n}=await vr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(ir(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:a,type:n,options:s}=e,{error:o}=await vr(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:a,type:n,options:s}=e,{data:o,error:u}=await vr(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:u})}throw new Zm("You must provide either an email or phone number and a type")}catch(r){if(ir(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Ku(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const a=e.expires_at?e.expires_at*1e3-Date.now()<$g:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",e.expires_at),!a){if(this.userStorage){const o=await Ku(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=Gg()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=b6(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await vr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:iu}):await this._useSession(async r=>{var a,n,s;const{data:o,error:u}=r;if(u)throw u;return!(!((a=o.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Oi}:await vr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0,xform:iu})})}catch(r){if(ir(r))return QA(r)&&(await this._removeSession(),await Qc(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async a=>{const{data:n,error:s}=a;if(s)throw s;if(!n.session)throw new Oi;const o=n.session;let u=null,f=null;this.flowType==="pkce"&&e.email!=null&&([u,f]=await Eh(this.storage,this.storageKey));const{data:h,error:m}=await vr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:u,code_challenge_method:f}),jwt:o.access_token,xform:iu});if(m)throw m;return o.user=h.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(a){if(ir(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Oi;const r=Date.now()/1e3;let a=r,n=!0,s=null;const{payload:o}=Vg(e.access_token);if(o.exp&&(a=o.exp,n=a<=r),n){const{data:u,error:f}=await this._callRefreshToken(e.refresh_token);if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!u)return{data:{user:null,session:null},error:null};s=u}else{const{data:u,error:f}=await this._getUser(e.access_token);if(f)throw f;s={access_token:e.access_token,refresh_token:e.refresh_token,user:u.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(ir(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var a;if(!e){const{data:o,error:u}=r;if(u)throw u;e=(a=o.session)!==null&&a!==void 0?a:void 0}if(!e?.refresh_token)throw new Oi;const{data:n,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(ir(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!vs())throw new Qm("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Qm(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Cb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Qm("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Cb("No code detected.");const{data:C,error:j}=await this._exchangeCodeForSession(e.code);if(j)throw j;const R=new URL(window.location.href);return R.searchParams.delete("code"),window.history.replaceState(window.history.state,"",R.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:s,refresh_token:o,expires_in:u,expires_at:f,token_type:h}=e;if(!s||!u||!o||!h)throw new Qm("No session defined in URL");const m=Math.round(Date.now()/1e3),v=parseInt(u);let y=m+v;f&&(y=parseInt(f));const g=y-m;g*1e3<=Mh&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${v}s`);const b=y-v;m-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,y,m):m-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,y,m);const{data:_,error:S}=await this._getUser(s);if(S)throw S;const E={provider_token:a,provider_refresh_token:n,access_token:s,expires_in:v,expires_at:y,refresh_token:o,token_type:h,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:E,redirectType:e.type},error:null})}catch(a){if(ir(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Ku(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return this._returnResult({error:s});const o=(a=n.session)===null||a===void 0?void 0:a.access_token;if(o){const{error:u}=await this.admin.signOut(o,e);if(u&&!(ZA(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return e!=="others"&&(await this._removeSession(),await Qc(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=o6(),a={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(e){return await this._useSession(async r=>{var a,n;try{const{data:{session:s},error:o}=r;if(o)throw o;await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await Eh(this.storage,this.storageKey,!0));try{return await vr(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(ir(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var e;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(ir(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:a,error:n}=await this._useSession(async s=>{var o,u,f,h,m;const{data:v,error:y}=s;if(y)throw y;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(u=e.options)===null||u===void 0?void 0:u.scopes,queryParams:(f=e.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await vr(this.fetch,"GET",g,{headers:this.headers,jwt:(m=(h=v.session)===null||h===void 0?void 0:h.access_token)!==null&&m!==void 0?m:void 0})});if(n)throw n;return vs()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:e.provider,url:a?.url},error:null})}catch(a){if(ir(a))return this._returnResult({data:{provider:e.provider,url:null},error:a});throw a}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var a;try{const{error:n,data:{session:s}}=r;if(n)throw n;const{options:o,provider:u,token:f,access_token:h,nonce:m}=e,v=await vr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=s?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:u,id_token:f,access_token:h,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Ho}),{data:y,error:g}=v;return g?this._returnResult({data:{user:null,session:null},error:g}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new jh}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:g}))}catch(n){if(ir(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var a,n;const{data:s,error:o}=r;if(o)throw o;return await vr(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(ir(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await f6(async n=>(n>0&&await u6(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await vr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ho})),(n,s)=>{const o=200*Math.pow(2,n);return s&&Wg(s)&&Date.now()+o-a<Mh})}catch(a){if(this._debug(r,"error",a),ir(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",a),vs()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:e,url:a},error:null}}async _recoverAndRefresh(){var e,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await Ku(this.storage,this.storageKey);if(n&&this.userStorage){let o=await Ku(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await Ih(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o?.user)!==null&&e!==void 0?e:Gg()}else if(n&&!n.user&&!n.user){const o=await Ku(this.storage,this.storageKey+"-user");o&&o?.user?(n.user=o.user,await Qc(this.storage,this.storageKey+"-user"),await Ih(this.storage,this.storageKey,n)):n.user=Gg()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const s=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<$g;if(this._debug(a,`session has${s?"":" not"} expired with margin of ${$g}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),Wg(o)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:u}=await this._getUser(n.access_token);!u&&o?.user?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(a,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n),console.error(n);return}finally{this._debug(a,"end")}}async _callRefreshToken(e){var r,a;if(!e)throw new Oi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new i1;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new Oi;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const u={data:s.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(s){if(this._debug(n,"error",s),ir(s)){const o={data:null,error:s};return Wg(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(s),s}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,a=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(e,r)}catch(f){s.push(f)}});if(await Promise.all(o),s.length>0){for(let u=0;u<s.length;u+=1)console.error(s[u]);throw s[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await Ih(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const s=Fb(n);await Ih(this.storage,this.storageKey,s)}else{const n=Fb(r);await Ih(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Qc(this.storage,this.storageKey),await Qc(this.storage,this.storageKey+"-code-verifier"),await Qc(this.storage,this.storageKey+"-user"),this.userStorage&&await Qc(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&vs()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Mh);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-e)/Mh);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Mh}ms, refresh threshold is ${r2} ticks`),n<=r2&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof N4)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!vs()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,a){const n=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[s,o]=await Eh(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(u.toString())}if(a?.queryParams){const s=new URLSearchParams(a.queryParams);n.push(s.toString())}return a?.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;return s?this._returnResult({data:null,error:s}):await vr(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(ir(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var a,n;const{data:s,error:o}=r;if(o)return this._returnResult({data:null,error:o});const u=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:f,error:h}=await vr(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});return h?this._returnResult({data:null,error:h}):(e.factorType==="totp"&&f.type==="totp"&&(!((n=f?.totp)===null||n===void 0)&&n.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),this._returnResult({data:f,error:null}))})}catch(r){if(ir(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return this._returnResult({data:null,error:s});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?q6(e.webauthn.credential_response):z6(e.webauthn.credential_response)})}:{code:e.code}),{data:u,error:f}=await vr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token});return f?this._returnResult({data:null,error:f}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:f}))})}catch(r){if(ir(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return this._returnResult({data:null,error:s});const o=await vr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token});if(o.error)return o;const{data:u}=o;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:B6(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:U6(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(ir(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:a}=await this._challenge({factorId:e.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const n={all:[],phone:[],totp:[],webauthn:[]};for(const s of(e=r?.factors)!==null&&e!==void 0?e:[])n.all.push(s),s.status==="verified"&&n[s.factor_type].push(s);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:a},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=Vg(a.access_token);let o=null;s.aal&&(o=s.aal);let u=o;((r=(e=a.user.factors)===null||e===void 0?void 0:e.filter(m=>m.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const h=s.amr||[];return{data:{currentLevel:o,nextLevel:u,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?await vr(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:a.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Oi})})}catch(r){if(ir(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async a=>{const{data:{session:n},error:s}=a;if(s)return this._returnResult({data:null,error:s});if(!n)return this._returnResult({data:null,error:new Oi});const o=await vr(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return o.data&&o.data.redirect_url&&vs()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(a){if(ir(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(e,r){try{return await this._useSession(async a=>{const{data:{session:n},error:s}=a;if(s)return this._returnResult({data:null,error:s});if(!n)return this._returnResult({data:null,error:new Oi});const o=await vr(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return o.data&&o.data.redirect_url&&vs()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(a){if(ir(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:a}=e;return a?this._returnResult({data:null,error:a}):r?await vr(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new Oi})})}catch(e){if(ir(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?(await vr(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Oi})})}catch(r){if(ir(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let a=r.keys.find(u=>u.kid===e);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(u=>u.kid===e),a&&this.jwks_cached_at+KA>n)return a;const{data:s,error:o}=await vr(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=n,a=s.keys.find(u=>u.kid===e),!a)?null:a}async getClaims(e,r={}){try{let a=e;if(!a){const{data:g,error:b}=await this.getSession();if(b||!g.session)return this._returnResult({data:null,error:b});a=g.session.access_token}const{header:n,payload:s,signature:o,raw:{header:u,payload:f}}=Vg(a);r?.allowExpired||x6(s.exp);const h=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!h){const{error:g}=await this.getUser(a);if(g)throw g;return{data:{claims:s,header:n,signature:o},error:null}}const m=y6(n.alg),v=await crypto.subtle.importKey("jwk",h,m,!0,["verify"]);if(!await crypto.subtle.verify(m,v,o,s6(`${u}.${f}`)))throw new s2("Invalid JWT signature");return{data:{claims:s,header:n,signature:o},error:null}}catch(a){if(ir(a))return this._returnResult({data:null,error:a});throw a}}}w0.nextInstanceID={};const J6=w0;class Z6 extends J6{constructor(e){super(e)}}class Q6{constructor(e,r,a){var n,s,o;this.supabaseUrl=e,this.supabaseKey=r;const u=WA(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const f=`sb-${u.hostname.split(".")[0]}-auth-token`,h={db:MA,realtime:BA,auth:Object.assign(Object.assign({},IA),{storageKey:f}),global:PA},m=$A(a??{},h);this.storageKey=(n=m.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=m.global.headers)!==null&&s!==void 0?s:{},m.accessToken?(this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(v,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=m.auth)!==null&&o!==void 0?o:{},this.headers,m.global.fetch),this.fetch=zA(r,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.accessToken&&this.accessToken().then(v=>this.realtime.setAuth(v)).catch(v=>console.warn("Failed to set initial Realtime auth token:",v)),this.rest=new BE(new URL("rest/v1",u).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),this.storage=new DA(this.storageUrl.href,this.headers,this.fetch,a?.storage),m.accessToken||this._listenForAuthEvents()}get functions(){return new LE(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},a={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,a)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:a}=await this.auth.getSession();return(r=(e=a.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:s,storageKey:o,flowType:u,lock:f,debug:h,throwOnError:m},v,y){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Z6({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),v),storageKey:o,autoRefreshToken:e,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:s,flowType:u,lock:f,debug:h,throwOnError:m,fetch:y,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new rA(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a?.access_token)})}_handleTokenChanged(e,r,a){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const eC=(t,e,r)=>new Q6(t,e,r);function tC(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}tC()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const rC="fieldsync-offline",aC=1,wn={PROJECTS:"projects",AREAS:"areas",CREW_CHECKINS:"crew_checkins",PENDING_ACTIONS:"pending_actions",CACHED_DATA:"cached_data"};let lf=null;const pc=()=>new Promise((t,e)=>{if(lf){t(lf);return}const r=indexedDB.open(rC,aC);r.onerror=()=>{console.error("Failed to open offline database"),e(r.error)},r.onsuccess=()=>{lf=r.result,console.log("Offline database initialized"),t(lf)},r.onupgradeneeded=a=>{const n=a.target.result;if(n.objectStoreNames.contains(wn.PROJECTS)||n.createObjectStore(wn.PROJECTS,{keyPath:"id"}).createIndex("company_id","company_id",{unique:!1}),n.objectStoreNames.contains(wn.AREAS)||n.createObjectStore(wn.AREAS,{keyPath:"id"}).createIndex("project_id","project_id",{unique:!1}),n.objectStoreNames.contains(wn.CREW_CHECKINS)||n.createObjectStore(wn.CREW_CHECKINS,{keyPath:"id"}).createIndex("project_id","project_id",{unique:!1}),!n.objectStoreNames.contains(wn.PENDING_ACTIONS)){const s=n.createObjectStore(wn.PENDING_ACTIONS,{keyPath:"id",autoIncrement:!0});s.createIndex("type","type",{unique:!1}),s.createIndex("created_at","created_at",{unique:!1})}n.objectStoreNames.contains(wn.CACHED_DATA)||n.createObjectStore(wn.CACHED_DATA,{keyPath:"key"})}}),kf=(t,e="readonly")=>{if(!lf)throw new Error("Database not initialized");return lf.transaction(t,e).objectStore(t)},nC=async(t,e)=>(await pc(),new Promise((r,a)=>{const s=kf(t,"readwrite").put(e);s.onsuccess=()=>r(s.result),s.onerror=()=>a(s.error)})),E4=async(t,e)=>(await pc(),new Promise((r,a)=>{const n=lf.transaction(t,"readwrite"),s=n.objectStore(t);e.forEach(o=>s.put(o)),n.oncomplete=()=>r(),n.onerror=()=>a(n.error)})),sC=async(t,e)=>(await pc(),new Promise((r,a)=>{const s=kf(t).get(e);s.onsuccess=()=>r(s.result),s.onerror=()=>a(s.error)})),A4=async t=>(await pc(),new Promise((e,r)=>{const n=kf(t).getAll();n.onsuccess=()=>e(n.result||[]),n.onerror=()=>r(n.error)})),C4=async(t,e,r)=>(await pc(),new Promise((a,n)=>{const u=kf(t).index(e).getAll(r);u.onsuccess=()=>a(u.result||[]),u.onerror=()=>n(u.error)})),iC=async(t,e)=>(await pc(),new Promise((r,a)=>{const s=kf(t,"readwrite").delete(e);s.onsuccess=()=>r(),s.onerror=()=>a(s.error)})),su={UPDATE_AREA_STATUS:"UPDATE_AREA_STATUS",CREATE_TM_TICKET:"CREATE_TM_TICKET",SAVE_CREW_CHECKIN:"SAVE_CREW_CHECKIN",SUBMIT_DAILY_REPORT:"SUBMIT_DAILY_REPORT",SEND_MESSAGE:"SEND_MESSAGE",CREATE_MATERIAL_REQUEST:"CREATE_MATERIAL_REQUEST"},qb=async(t,e,r={})=>{await pc();const a={type:t,payload:e,metadata:r,created_at:new Date().toISOString(),attempts:0,last_error:null};return new Promise((n,s)=>{const u=kf(wn.PENDING_ACTIONS,"readwrite").add(a);u.onsuccess=()=>{console.log(`Queued offline action: ${t}`),n(u.result)},u.onerror=()=>s(u.error)})},T4=async()=>A4(wn.PENDING_ACTIONS),Xg=async()=>(await T4()).length,oC=async t=>iC(wn.PENDING_ACTIONS,t),lC=async(t,e)=>(await pc(),new Promise((r,a)=>{const n=kf(wn.PENDING_ACTIONS,"readwrite"),s=n.get(t);s.onsuccess=()=>{const o=s.result;if(o){const u={...o,...e},f=n.put(u);f.onsuccess=()=>r(u),f.onerror=()=>a(f.error)}else a(new Error("Action not found"))},s.onerror=()=>a(s.error)})),cC=async t=>E4(wn.PROJECTS,t),zb=async t=>t?C4(wn.PROJECTS,"company_id",t):A4(wn.PROJECTS),uC=async t=>E4(wn.AREAS,t),Hb=async t=>C4(wn.AREAS,"project_id",t),Kg=async(t,e)=>{const r=await sC(wn.AREAS,t);return r&&(r.status=e,r.updated_at=new Date().toISOString(),await nC(wn.AREAS,r)),r};let W2=navigator.onLine;const i2=new Set,O4=t=>(i2.add(t),()=>i2.delete(t)),o0=()=>W2,$b=t=>{W2=t,i2.forEach(e=>e(t))};typeof window<"u"&&(window.addEventListener("online",()=>{console.log("Connection restored"),$b(!0)}),window.addEventListener("offline",()=>{console.log("Connection lost"),$b(!1)}));let Jg=!1;const fC=async t=>{if(Jg||!W2)return{synced:0,failed:0};Jg=!0;const e={synced:0,failed:0};try{const r=await T4();console.log(`Syncing ${r.length} pending actions...`);for(const a of r)try{await hC(a,t),await oC(a.id),e.synced++,console.log(`Synced action: ${a.type}`)}catch(n){console.error(`Failed to sync action ${a.type}:`,n),e.failed++,await lC(a.id,{attempts:(a.attempts||0)+1,last_error:n.message,last_attempt:new Date().toISOString()})}}finally{Jg=!1}return e},hC=async(t,e)=>{const{type:r,payload:a}=t;switch(r){case su.UPDATE_AREA_STATUS:return e.updateAreaStatus(a.areaId,a.status);case su.CREATE_TM_TICKET:const n=await e.createTMTicket(a.ticket);return a.workers?.length>0&&await e.addTMWorkers(n.id,a.workers),a.items?.length>0&&await e.addTMItems(n.id,a.items),n;case su.SAVE_CREW_CHECKIN:return e.saveCrewCheckin(a.projectId,a.workers,a.checkInDate);case su.SUBMIT_DAILY_REPORT:return await e.saveDailyReport(a.projectId,a.reportData),e.submitDailyReport(a.projectId,a.submittedBy);case su.SEND_MESSAGE:return e.sendMessage(a.projectId,a.senderType,a.senderName,a.content);case su.CREATE_MATERIAL_REQUEST:return e.createMaterialRequest(a.projectId,a.items,a.requestedBy,a.neededBy,a.priority,a.notes);default:throw new Error(`Unknown action type: ${r}`)}},R4="",dC="",$e=!!R4;pc().catch(t=>console.error("Failed to init offline DB:",t));const Pe=$e?eC(R4,dC):null,D4="fieldsync_data",o2="fieldsync_user",or=()=>{const t=localStorage.getItem(D4);return t?JSON.parse(t):{projects:[],areas:[],users:[],assignments:[]}},sa=t=>{localStorage.setItem(D4,JSON.stringify(t))},ep=()=>{const t=localStorage.getItem(o2);return t?JSON.parse(t):null},tp=t=>{t?localStorage.setItem(o2,JSON.stringify(t)):localStorage.removeItem(o2)},mC={async signUp(t,e,r,a){if($e){const{data:n,error:s}=await Pe.auth.signUp({email:t,password:e,options:{data:{name:r,role:a}}});if(s)throw s;return n}else{const n=or(),s={id:crypto.randomUUID(),email:t,name:r,role:a,created_at:new Date().toISOString()};return n.users.push(s),sa(n),tp(s),{user:s}}},async signIn(t,e){if($e){const{data:r,error:a}=await Pe.auth.signInWithPassword({email:t,password:e});if(a)throw a;return r}else{const a=or().users.find(n=>n.email===t);if(!a)throw new Error("User not found");return tp(a),{user:a}}},async signOut(){if($e){const{error:t}=await Pe.auth.signOut();if(t)throw t}else tp(null)},async getUser(){if($e){const{data:{user:t}}=await Pe.auth.getUser();return t}else return ep()},async getProfile(){if($e){const{data:{user:t}}=await Pe.auth.getUser();if(!t)return null;const{data:e,error:r}=await Pe.from("users").select("*").eq("id",t.id).single();return r?{id:t.id,email:t.email,name:t.user_metadata?.name||"",role:t.user_metadata?.role||"foreman"}:e}else return ep()},async updateRole(t,e){if($e){const{data:r,error:a}=await Pe.from("users").update({role:e}).eq("id",t).select().single();if(a)throw a;return r}else{const r=or(),a=r.users.find(n=>n.id===t);return a&&(a.role=e,sa(r),ep()?.id===t&&tp(a)),a}},onAuthStateChange(t){if($e)return Pe.auth.onAuthStateChange(t);{const e=ep();return t(e?"SIGNED_IN":"SIGNED_OUT",{user:e}),{data:{subscription:{unsubscribe:()=>{}}}}}}},ut={async getProjects(t=null,e=!1){if($e){if(!o0()){console.log("Offline: returning cached projects");const s=await zb(t);return e?s:s.filter(o=>o.status!=="archived")}let r=Pe.from("projects").select("*").order("created_at",{ascending:!1});t&&(r=r.eq("company_id",t)),e||(r=r.eq("status","active"));const{data:a,error:n}=await r;if(n){console.log("Error fetching projects, trying cache:",n.message);const s=await zb(t);if(s.length>0)return s;throw n}return a?.length>0&&cC(a).catch(s=>console.error("Failed to cache projects:",s)),a}else{const r=or().projects;return e?r:r.filter(a=>a.status!=="archived")}},async getArchivedProjects(t){if($e){const{data:e,error:r}=await Pe.from("projects").select("*").eq("company_id",t).eq("status","archived").order("archived_at",{ascending:!1});if(r)throw r;return e}else return or().projects.filter(e=>e.status==="archived")},async getProjectCount(t){if($e){const{count:e,error:r}=await Pe.from("projects").select("*",{count:"exact",head:!0}).eq("company_id",t).in("status",["active","archived"]);if(r)throw r;return e||0}else return or().projects.filter(r=>r.company_id===t&&r.status!=="deleted").length},async archiveProject(t){if($e){const{data:e,error:r}=await Pe.from("projects").update({status:"archived",archived_at:new Date().toISOString()}).eq("id",t).select().single();if(r)throw r;return e}else{const e=or(),r=e.projects.find(a=>a.id===t);return r&&(r.status="archived",r.archived_at=new Date().toISOString(),sa(e)),r}},async restoreProject(t){if($e){const{data:e,error:r}=await Pe.from("projects").update({status:"active",archived_at:null}).eq("id",t).select().single();if(r)throw r;return e}else{const e=or(),r=e.projects.find(a=>a.id===t);return r&&(r.status="active",r.archived_at=null,sa(e)),r}},async getProject(t){if($e){const{data:e,error:r}=await Pe.from("projects").select("*").eq("id",t).single();if(r)throw r;return e}else return or().projects.find(e=>e.id===t)},async createProject(t){if($e){const{data:e,error:r}=await Pe.from("projects").insert({...t,status:"active"}).select().single();if(r)throw r;return e}else{const e=or(),r={...t,id:crypto.randomUUID(),status:"active",created_at:new Date().toISOString()};return e.projects.push(r),sa(e),r}},async getProjectByPin(t){if($e){const{data:e,error:r}=await Pe.from("projects").select("*").eq("pin",t).eq("status","active").single();return r?null:e}else return or().projects.find(r=>r.pin===t&&r.status==="active")||null},async getProjectByPinAndCompany(t,e){if($e){const{data:r,error:a}=await Pe.from("projects").select("*").eq("pin",t).eq("company_id",e).eq("status","active").single();return a?null:r}else return or().projects.find(a=>a.pin===t&&a.company_id===e&&a.status==="active")||null},async isPinAvailable(t,e=null){if($e){let r=Pe.from("projects").select("id").eq("pin",t);e&&(r=r.neq("id",e));const{data:a,error:n}=await r;if(n)throw n;return a.length===0}else return!or().projects.some(a=>a.pin===t&&a.id!==e)},async updateProjectPin(t,e){if($e){const{data:r,error:a}=await Pe.from("projects").update({pin:e}).eq("id",t).select().single();if(a)throw a;return r}else{const r=or(),a=r.projects.find(n=>n.id===t);return a&&(a.pin=e,sa(r)),a}},async updateProject(t,e){if($e){const{data:r,error:a}=await Pe.from("projects").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating project:",a),a;return r}else{const r=or(),a=r.projects.find(n=>n.id===t);return a&&(Object.assign(a,e),sa(r)),a}},async deleteProject(t){if($e){const{error:e}=await Pe.from("projects").delete().eq("id",t);if(e)throw e}else{const e=or();e.projects=e.projects.filter(r=>r.id!==t),e.areas=e.areas.filter(r=>r.project_id!==t),sa(e)}},async getAreas(t){if($e){if(!o0())return console.log("Offline: returning cached areas"),Hb(t);const{data:e,error:r}=await Pe.from("areas").select("*").eq("project_id",t).order("sort_order",{ascending:!0});if(r){console.log("Error fetching areas, trying cache:",r.message);const a=await Hb(t);if(a.length>0)return a;throw r}return e?.length>0&&uC(e).catch(a=>console.error("Failed to cache areas:",a)),e}else return or().areas.filter(e=>e.project_id===t)},async createArea(t){if($e){const{data:e,error:r}=await Pe.from("areas").insert(t).select().single();if(r)throw r;return e}else{const e=or(),r={...t,id:crypto.randomUUID(),created_at:new Date().toISOString()};return e.areas.push(r),sa(e),r}},async updateAreaStatus(t,e){if($e){if(!o0()){console.log("Offline: queuing area status update");const n=await Kg(t,e);return await qb(su.UPDATE_AREA_STATUS,{areaId:t,status:e}),n}const{data:r,error:a}=await Pe.from("areas").update({status:e}).eq("id",t).select().single();if(a){if(a.message?.includes("fetch")||a.message?.includes("network")){console.log("Network error: queuing area status update");const n=await Kg(t,e);return await qb(su.UPDATE_AREA_STATUS,{areaId:t,status:e}),n}throw a}return r&&Kg(t,e).catch(n=>console.error("Failed to update cached area:",n)),r}else{const r=or(),a=r.areas.find(n=>n.id===t);return a&&(a.status=e,a.updated_at=new Date().toISOString()),sa(r),a}},async updateArea(t,e){if($e){const{data:r,error:a}=await Pe.from("areas").update(e).eq("id",t).select().single();if(a)throw a;return r}else{const r=or(),a=r.areas.find(n=>n.id===t);return a&&(Object.assign(a,e),a.updated_at=new Date().toISOString()),sa(r),a}},async deleteArea(t){if($e){const{error:e}=await Pe.from("areas").delete().eq("id",t);if(e)throw e}else{const e=or();e.areas=e.areas.filter(r=>r.id!==t),sa(e)}},subscribeToAreas(t,e){return $e?Pe.channel(`areas:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"areas",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToMessages(t,e){return $e?Pe.channel(`messages:${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToMaterialRequests(t,e){return $e?Pe.channel(`material_requests:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"material_requests",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToDailyReports(t,e){return $e?Pe.channel(`daily_reports:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"daily_reports",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToCrewCheckins(t,e){return $e?Pe.channel(`crew_checkins:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"crew_checkins",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToInjuryReports(t,e){return $e?Pe.channel(`injury_reports:${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"injury_reports",filter:`company_id=eq.${t}`},e).subscribe():null},subscribeToTMTickets(t,e){return $e?Pe.channel(`tm_tickets:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"t_and_m_tickets",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToCompanyActivity(t,e,r){if(!$e||!e||e.length===0)return null;const a=Pe.channel(`company_activity:${t}`);return e.forEach(n=>{a.on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`project_id=eq.${n}`},s=>r.onMessage?.(s)),a.on("postgres_changes",{event:"INSERT",schema:"public",table:"material_requests",filter:`project_id=eq.${n}`},s=>r.onMaterialRequest?.(s)),a.on("postgres_changes",{event:"INSERT",schema:"public",table:"t_and_m_tickets",filter:`project_id=eq.${n}`},s=>r.onTMTicket?.(s))}),a.on("postgres_changes",{event:"INSERT",schema:"public",table:"injury_reports",filter:`company_id=eq.${t}`},n=>r.onInjuryReport?.(n)),a.subscribe()},unsubscribe(t){t&&$e&&Pe.removeChannel(t)},async getAssignedProjects(t){if($e){const{data:e,error:r}=await Pe.from("project_assignments").select(`
          project_id,
          projects (*)
        `).eq("user_id",t);if(r)throw r;return e.map(a=>a.projects)}else{const e=or();return(e.assignments?.filter(a=>a.user_id===t)||[]).map(a=>e.projects.find(n=>n.id===a.project_id)).filter(Boolean)}},async assignUserToProject(t,e,r){if($e){const{data:a,error:n}=await Pe.from("project_assignments").insert({project_id:t,user_id:e,assigned_by:r}).select().single();if(n)throw n;return a}else{const a=or();a.assignments||(a.assignments=[]);const n={id:crypto.randomUUID(),project_id:t,user_id:e,assigned_by:r,assigned_at:new Date().toISOString()};return a.assignments.push(n),sa(a),n}},async removeUserFromProject(t,e){if($e){const{error:r}=await Pe.from("project_assignments").delete().eq("project_id",t).eq("user_id",e);if(r)throw r}else{const r=or();r.assignments=r.assignments?.filter(a=>!(a.project_id===t&&a.user_id===e))||[],sa(r)}},async getProjectAssignments(t){if($e){const{data:e,error:r}=await Pe.from("project_assignments").select(`
          user_id,
          users (id, email, name, role)
        `).eq("project_id",t);if(r)throw r;return e.map(a=>a.users)}else{const e=or();return(e.assignments?.filter(a=>a.project_id===t)||[]).map(a=>e.users.find(n=>n.id===a.user_id)).filter(Boolean)}},async getAllUsers(){if($e){const{data:t,error:e}=await Pe.from("users").select("*").order("name");if(e)throw e;return t}else return or().users||[]},async getForemen(){if($e){const{data:t,error:e}=await Pe.from("users").select("*").eq("role","foreman").order("name");if(e)throw e;return t}else return(or().users||[]).filter(t=>t.role==="foreman")},async logActivity(t,e,r,a,n,s){if($e){const{error:o}=await Pe.from("activity_log").insert({user_id:t,project_id:e,area_id:r,action:a,old_value:n,new_value:s});o&&console.error("Error logging activity:",o)}},async getProjectActivity(t,e=50){if($e){const{data:r,error:a}=await Pe.from("activity_log").select(`
          *,
          users (name, email),
          areas (name)
        `).eq("project_id",t).order("created_at",{ascending:!1}).limit(e);if(a)throw a;return r}return[]},async getMaterialsEquipment(t){if($e){const{data:e,error:r}=await Pe.from("materials_equipment").select("*").eq("company_id",t).eq("active",!0).order("category").order("name");if(r)throw r;return e}return[]},async getMaterialsEquipmentByCategory(t,e){if($e){const{data:r,error:a}=await Pe.from("materials_equipment").select("*").eq("company_id",t).eq("category",e).eq("active",!0).order("name");if(a)throw a;return r}return[]},async getAllMaterialsEquipment(t){if($e){const{data:e,error:r}=await Pe.from("materials_equipment").select("*").eq("company_id",t).order("category").order("name");if(r)throw r;return e}return[]},async createMaterialEquipment(t){if($e){const{data:e,error:r}=await Pe.from("materials_equipment").insert(t).select().single();if(r)throw r;return e}return null},async updateMaterialEquipment(t,e){if($e){const{data:r,error:a}=await Pe.from("materials_equipment").update(e).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteMaterialEquipment(t){if($e){const{error:e}=await Pe.from("materials_equipment").update({active:!1}).eq("id",t);if(e)throw e}},async getTMTickets(t){if($e){const{data:e,error:r}=await Pe.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).order("created_at",{ascending:!1});if(r)throw r;return e}return[]},async getChangeOrderTotals(t){if($e){const{data:e,error:r}=await Pe.from("t_and_m_tickets").select("ce_pco_number, change_order_value, status").eq("project_id",t).not("ce_pco_number","is",null).neq("ce_pco_number","");if(r)throw r;const a={};let n=0,s=0;return e?.forEach(o=>{const u=o.ce_pco_number;if(a[u]||(a[u]={approved:0,pending:0,count:0}),a[u].count++,o.status==="approved"||o.status==="billed"){const f=parseFloat(o.change_order_value)||0;a[u].approved+=f,n+=f}else o.status==="pending"&&s++}),{changeOrders:a,totalApprovedValue:n,pendingCount:s}}return{changeOrders:{},totalApprovedValue:0,pendingCount:0}},async getTMTicketsByStatus(t,e){if($e){const{data:r,error:a}=await Pe.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).eq("status",e).order("created_at",{ascending:!1});if(a)throw a;return r}return[]},async createTMTicket(t){if($e){const{data:e,error:r}=await Pe.from("t_and_m_tickets").insert({project_id:t.project_id,work_date:t.work_date,ce_pco_number:t.ce_pco_number||null,notes:t.notes,photos:t.photos||[],status:"pending",created_by_name:t.created_by_name||"Field User"}).select().single();if(r)throw r;return e}return null},async addTMWorkers(t,e){if($e){const r=e.map(n=>({ticket_id:t,name:n.name,hours:n.hours,overtime_hours:n.overtime_hours||0,time_started:n.time_started||null,time_ended:n.time_ended||null,role:n.role||"Laborer"})),{error:a}=await Pe.from("t_and_m_workers").insert(r);if(a)throw a}},async addTMItems(t,e){if($e){const r=e.map(n=>({ticket_id:t,material_equipment_id:n.material_equipment_id||null,custom_name:n.custom_name||null,custom_category:n.custom_category||null,quantity:n.quantity})),{error:a}=await Pe.from("t_and_m_items").insert(r);if(a)throw a}},async updateTMTicketStatus(t,e){if($e){const{data:r,error:a}=await Pe.from("t_and_m_tickets").update({status:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async approveTMTicket(t,e,r,a=null){if($e){const n={status:"approved",approved_by_user_id:e,approved_by_name:r,approved_at:new Date().toISOString(),rejected_by_user_id:null,rejected_by_name:null,rejected_at:null,rejection_reason:null};a!==null&&(n.change_order_value=parseFloat(a)||0);const{data:s,error:o}=await Pe.from("t_and_m_tickets").update(n).eq("id",t).select().single();if(o)throw o;return s}return null},async rejectTMTicket(t,e,r,a=""){if($e){const{data:n,error:s}=await Pe.from("t_and_m_tickets").update({status:"rejected",rejected_by_user_id:e,rejected_by_name:r,rejected_at:new Date().toISOString(),rejection_reason:a,approved_by_user_id:null,approved_by_name:null,approved_at:null}).eq("id",t).select().single();if(s)throw s;return n}return null},canApproveTickets(t){return["owner","admin","manager"].includes(t)},async updateTMTicketPhotos(t,e){if($e){const{data:r,error:a}=await Pe.from("t_and_m_tickets").update({photos:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteTMTicket(t){if($e){const{error:e}=await Pe.from("t_and_m_tickets").delete().eq("id",t);if(e)throw e}},async getCompanyByCode(t){if($e){const{data:e,error:r}=await Pe.from("companies").select("*").eq("code",t).single();return r?null:e}return null},async getCompany(t){if($e){const{data:e,error:r}=await Pe.from("companies").select("*").eq("id",t).single();if(r)throw r;return e}return null},async getUserCompanies(t){if($e){const{data:e,error:r}=await Pe.from("user_companies").select(`
          id,
          role,
          company_id,
          companies (
            id,
            name,
            code
          )
        `).eq("user_id",t).order("created_at",{ascending:!0});return r?(console.error("Error fetching user companies:",r),[]):e.map(a=>({id:a.companies.id,name:a.companies.name,code:a.companies.code,role:a.role}))}return[]},async uploadPhoto(t,e,r,a){if(!$e)return null;const n=Date.now(),s=Math.random().toString(36).substring(7),o=a.name?.split(".").pop()||"jpg",u=`${n}-${s}.${o}`,f=`${t}/${e}/${r}/${u}`,{data:h,error:m}=await Pe.storage.from("tm-photos").upload(f,a,{cacheControl:"3600",upsert:!1});if(m)throw m;const{data:v}=Pe.storage.from("tm-photos").getPublicUrl(f);return v.publicUrl},async uploadPhotoBase64(t,e,r,a,n="photo.jpg"){if(!$e)return null;const o=await(await fetch(a)).blob(),u=Date.now(),f=Math.random().toString(36).substring(7),h=n.split(".").pop()||"jpg",m=`${u}-${f}.${h}`,v=`${t}/${e}/${r}/${m}`,{data:y,error:g}=await Pe.storage.from("tm-photos").upload(v,o,{cacheControl:"3600",upsert:!1,contentType:o.type});if(g)throw g;const{data:b}=Pe.storage.from("tm-photos").getPublicUrl(v);return b.publicUrl},async deletePhoto(t){if(!$e)return;const r=new URL(t).pathname.match(/\/tm-photos\/(.+)$/);if(!r)return;const a=r[1],{error:n}=await Pe.storage.from("tm-photos").remove([a]);if(n)throw n},async getCrewCheckin(t,e=null){if(!$e)return null;const r=e||new Date().toISOString().split("T")[0],{data:a,error:n}=await Pe.from("crew_checkins").select("*").eq("project_id",t).eq("check_in_date",r).single();return n&&n.code!=="PGRST116"&&console.error("Error fetching crew checkin:",n),a},async saveCrewCheckin(t,e,r=null,a=null){if(!$e)return null;const n=a||new Date().toISOString().split("T")[0],{data:s,error:o}=await Pe.from("crew_checkins").upsert({project_id:t,check_in_date:n,workers:e,created_by:r,updated_at:new Date().toISOString()},{onConflict:"project_id,check_in_date"}).select().single();if(o)throw console.error("Error saving crew checkin:",o),o;return s},async addCrewMember(t,e,r=null){if(!$e)return null;const a=await this.getCrewCheckin(t),n=a?.workers||[];return n.find(s=>s.name.toLowerCase()===e.name.toLowerCase())?a:(n.push(e),await this.saveCrewCheckin(t,n,r))},async removeCrewMember(t,e){if(!$e)return null;const r=await this.getCrewCheckin(t);if(!r)return null;const a=r.workers.filter(n=>n.name.toLowerCase()!==e.toLowerCase());return await this.saveCrewCheckin(t,a,r.created_by)},async getCrewCheckinHistory(t,e=30){if(!$e)return[];const{data:r,error:a}=await Pe.from("crew_checkins").select("*").eq("project_id",t).order("check_in_date",{ascending:!1}).limit(e);return a?(console.error("Error fetching crew history:",a),[]):r||[]},async getLaborRates(t,e=null,r=null){if(!$e)return[];let a=Pe.from("labor_rates").select("*").eq("company_id",t);e&&(a=a.eq("work_type",e)),r&&(a=a.eq("job_type",r));const{data:n,error:s}=await a;return s?(console.error("Error fetching labor rates:",s),[]):n||[]},async calculateManDayCosts(t,e,r,a){if(!$e)return{totalCost:0,totalManDays:0,breakdown:[]};const n=await this.getCrewCheckinHistory(t,365),s=await this.getLaborRates(e,r,a),o={};s.forEach(v=>{o[v.role.toLowerCase()]=parseFloat(v.regular_rate)||0});let u=0,f=0;const h={},m=[];return n.forEach(v=>{const y=v.workers||[];let g=0;const b={};y.forEach(_=>{const S=(_.role||"laborer").toLowerCase(),E=o[S]||0;b[S]||(b[S]={count:0,cost:0}),b[S].count++,b[S].cost+=E,g+=E,h[S]||(h[S]={count:0,cost:0,rate:E}),h[S].count++,h[S].cost+=E}),u+=g,f+=y.length,m.push({date:v.check_in_date,workers:y.length,cost:g,breakdown:b})}),{totalCost:u,totalManDays:f,byRole:h,byDate:m,daysWorked:n.length}},async getDailyReport(t,e=null){if(!$e)return null;const r=e||new Date().toISOString().split("T")[0],{data:a,error:n}=await Pe.from("daily_reports").select("*").eq("project_id",t).eq("report_date",r).single();return n&&n.code!=="PGRST116"&&console.error("Error fetching daily report:",n),a},async compileDailyReport(t,e=null){if(!$e)return null;const r=e||new Date().toISOString().split("T")[0],a=await this.getCrewCheckin(t,r),{data:n}=await Pe.from("areas").select("*").eq("project_id",t),s=n?.filter(f=>f.status==="done"&&f.completed_at?.startsWith(r))||[],{data:o}=await Pe.from("t_and_m_tickets").select("*").eq("project_id",t).eq("work_date",r),u=o?.reduce((f,h)=>f+(h.photos?.length||0),0)||0;return{crew_count:a?.workers?.length||0,crew_list:a?.workers||[],tasks_completed:s.length,tasks_total:n?.length||0,completed_tasks:s.map(f=>({name:f.name,group:f.group_name})),tm_tickets_count:o?.length||0,photos_count:u}},async saveDailyReport(t,e,r=null){if(!$e)return null;const a=r||new Date().toISOString().split("T")[0],{data:n,error:s}=await Pe.from("daily_reports").upsert({project_id:t,report_date:a,...e,updated_at:new Date().toISOString()},{onConflict:"project_id,report_date"}).select().single();if(s)throw console.error("Error saving daily report:",s),s;return n},async submitDailyReport(t,e,r=null){if(!$e)return null;const a=r||new Date().toISOString().split("T")[0],n=await this.compileDailyReport(t,a),{data:s,error:o}=await Pe.from("daily_reports").upsert({project_id:t,report_date:a,...n,status:"submitted",submitted_at:new Date().toISOString(),submitted_by:e,updated_at:new Date().toISOString()},{onConflict:"project_id,report_date"}).select().single();if(o)throw console.error("Error submitting daily report:",o),o;return s},async getDailyReports(t,e=30){if(!$e)return[];const{data:r,error:a}=await Pe.from("daily_reports").select("*").eq("project_id",t).order("report_date",{ascending:!1}).limit(e);return a?(console.error("Error fetching daily reports:",a),[]):r||[]},async sendMessage(t,e,r,a,n=null,s=null,o="general",u=null){if(!$e)return null;const{data:f,error:h}=await Pe.from("messages").insert({project_id:t,sender_type:r,sender_name:a,sender_user_id:n,message:e,photo_url:s,message_type:o,parent_message_id:u}).select().single();if(h)throw console.error("Error sending message:",h),h;return f},async getMessages(t,e=50){if(!$e)return[];const{data:r,error:a}=await Pe.from("messages").select("*").eq("project_id",t).order("created_at",{ascending:!1}).limit(e);return a?(console.error("Error fetching messages:",a),[]):r||[]},async getUnreadCount(t,e){if(!$e)return 0;const r=e==="field"?"office":"field",{count:a,error:n}=await Pe.from("messages").select("*",{count:"exact",head:!0}).eq("project_id",t).eq("sender_type",r).eq("is_read",!1);return n?(console.error("Error getting unread count:",n),0):a||0},async markMessagesRead(t,e){if(!$e)return;const r=e==="field"?"office":"field",{error:a}=await Pe.from("messages").update({is_read:!0,read_at:new Date().toISOString()}).eq("project_id",t).eq("sender_type",r).eq("is_read",!1);a&&console.error("Error marking messages read:",a)},async createMaterialRequest(t,e,r,a=null,n="normal",s=null){if(!$e)return null;const{data:o,error:u}=await Pe.from("material_requests").insert({project_id:t,items:e,requested_by:r,needed_by:a,priority:n,notes:s}).select().single();if(u)throw console.error("Error creating material request:",u),u;return o},async getMaterialRequests(t,e=null){if(!$e)return[];let r=Pe.from("material_requests").select("*").eq("project_id",t).order("created_at",{ascending:!1});e&&(r=r.eq("status",e));const{data:a,error:n}=await r;return n?(console.error("Error fetching material requests:",n),[]):a||[]},async getPendingRequestsCount(t){if(!$e)return 0;const{count:e,error:r}=await Pe.from("material_requests").select("*",{count:"exact",head:!0}).eq("project_id",t).eq("status","pending");return r?0:e||0},async updateMaterialRequest(t,e,r,a=null,n=null){if(!$e)return null;const s={status:e,responded_by:r,responded_at:new Date().toISOString(),response_notes:a,updated_at:new Date().toISOString()};n&&(s.expected_delivery=n),e==="delivered"&&(s.delivered_at=new Date().toISOString());const{data:o,error:u}=await Pe.from("material_requests").update(s).eq("id",t).select().single();if(u)throw console.error("Error updating material request:",u),u;return o},generateShareToken(){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let e="";for(let r=0;r<12;r++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},async createProjectShare(t,e,r,a=null){if(!$e){const f=or();f.projectShares||(f.projectShares=[]);const h={id:crypto.randomUUID(),project_id:t,share_token:this.generateShareToken(),created_by:e,expires_at:a,is_active:!0,permissions:r,view_count:0,last_viewed_at:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return f.projectShares.push(h),sa(f),h}const{data:n,error:s}=await Pe.rpc("generate_share_token");if(s)throw console.error("Error generating share token:",s),s;const{data:o,error:u}=await Pe.from("project_shares").insert({project_id:t,share_token:n,created_by:e,expires_at:a,permissions:r}).select().single();if(u)throw console.error("Error creating project share:",u),u;return o},async getShareByToken(t){if(!$e){const a=or();if(!a.projectShares)return null;const n=a.projectShares.find(s=>s.share_token===t&&s.is_active&&(!s.expires_at||new Date(s.expires_at)>new Date));return n&&(n.view_count++,n.last_viewed_at=new Date().toISOString(),sa(a)),n}const{data:e,error:r}=await Pe.from("project_shares").select("*, projects(*)").eq("share_token",t).eq("is_active",!0).single();return r?(console.error("Error fetching share by token:",r),null):e.expires_at&&new Date(e.expires_at)<new Date?null:(await Pe.rpc("increment_share_view_count",{token:t}),e)},async getProjectShares(t){if(!$e){const a=or();return a.projectShares?a.projectShares.filter(n=>n.project_id===t):[]}const{data:e,error:r}=await Pe.from("project_shares").select("*, users(name, email)").eq("project_id",t).order("created_at",{ascending:!1});return r?(console.error("Error fetching project shares:",r),[]):e||[]},async updateProjectShare(t,e){if(!$e){const n=or();if(!n.projectShares)return null;const s=n.projectShares.findIndex(o=>o.id===t);return s===-1?null:(n.projectShares[s]={...n.projectShares[s],...e,updated_at:new Date().toISOString()},sa(n),n.projectShares[s])}const{data:r,error:a}=await Pe.from("project_shares").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating project share:",a),a;return r},async revokeProjectShare(t){return this.updateProjectShare(t,{is_active:!1})},async deleteProjectShare(t){if(!$e){const r=or();if(!r.projectShares)return;r.projectShares=r.projectShares.filter(a=>a.id!==t),sa(r);return}const{error:e}=await Pe.from("project_shares").delete().eq("id",t);if(e)throw console.error("Error deleting project share:",e),e},async getPublicProjectData(t){const e=await this.getShareByToken(t);if(!e)return null;const r=e.project_id||e.projects?.id;if(!$e){const s=or(),o=s.projects.find(v=>v.id===r);if(!o)return null;const u=s.areas.filter(v=>v.project_id===r),f=u.reduce((v,y)=>v+parseFloat(y.weight||0),0),h=u.filter(v=>v.status==="done").reduce((v,y)=>v+parseFloat(y.weight||0),0),m=f>0?Math.round(h/f*100):0;return{share:e,project:o,progress:m,areas:e.permissions.progress?u:[],photos:[],dailyReports:[],tmTickets:[]}}const a=e.projects||await this.getProject(r);if(!a)return null;const n={share:e,project:a,areas:[],photos:[],dailyReports:[],tmTickets:[]};if(e.permissions.progress){n.areas=await this.getAreas(r);const s=n.areas.reduce((u,f)=>u+parseFloat(f.weight||0),0),o=n.areas.filter(u=>u.status==="done").reduce((u,f)=>u+parseFloat(f.weight||0),0);n.progress=s>0?Math.round(o/s*100):0}if(e.permissions.photos){const{data:s}=await Pe.from("t_and_m_tickets").select("photos, work_date").eq("project_id",r).not("photos","is",null).order("work_date",{ascending:!1}).limit(20);n.photos=s?.flatMap(o=>(o.photos||[]).map(u=>({url:u,date:o.work_date})))||[]}if(e.permissions.daily_reports){const{data:s}=await Pe.from("daily_reports").select("*").eq("project_id",r).order("report_date",{ascending:!1}).limit(10);n.dailyReports=s||[]}return e.permissions.tm_tickets&&(n.tmTickets=await this.getTMTickets(r)),n},async createInjuryReport(t){if(!$e){const a=or();a.injuryReports||(a.injuryReports=[]);const n={id:crypto.randomUUID(),...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return a.injuryReports.push(n),sa(a),n}const{data:e,error:r}=await Pe.from("injury_reports").insert(t).select().single();if(r)throw console.error("Error creating injury report:",r),r;return e},async getInjuryReports(t){if(!$e){const a=or();return a.injuryReports?a.injuryReports.filter(n=>n.project_id===t).sort((n,s)=>new Date(s.incident_date)-new Date(n.incident_date)):[]}const{data:e,error:r}=await Pe.from("injury_reports").select("*").eq("project_id",t).order("incident_date",{ascending:!1});return r?(console.error("Error fetching injury reports:",r),[]):e||[]},async getCompanyInjuryReports(t,e=null){if(!$e){const s=or();if(!s.injuryReports)return[];let o=s.injuryReports.filter(u=>u.company_id===t);return e&&(o=o.filter(u=>u.status===e)),o.sort((u,f)=>new Date(f.incident_date)-new Date(u.incident_date))}let r=Pe.from("injury_reports").select("*, projects(name)").eq("company_id",t).order("incident_date",{ascending:!1});e&&(r=r.eq("status",e));const{data:a,error:n}=await r;return n?(console.error("Error fetching company injury reports:",n),[]):a||[]},async getInjuryReport(t){if(!$e){const a=or();return a.injuryReports?a.injuryReports.find(n=>n.id===t):null}const{data:e,error:r}=await Pe.from("injury_reports").select("*, projects(name, pin), users(name, email)").eq("id",t).single();return r?(console.error("Error fetching injury report:",r),null):e},async updateInjuryReport(t,e){if(!$e){const n=or();if(!n.injuryReports)return null;const s=n.injuryReports.findIndex(o=>o.id===t);return s===-1?null:(n.injuryReports[s]={...n.injuryReports[s],...e,updated_at:new Date().toISOString()},sa(n),n.injuryReports[s])}const{data:r,error:a}=await Pe.from("injury_reports").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating injury report:",a),a;return r},async closeInjuryReport(t,e){return this.updateInjuryReport(t,{status:"closed",closed_at:new Date().toISOString(),closed_by:e})},async deleteInjuryReport(t){if(!$e){const r=or();if(!r.injuryReports)return;r.injuryReports=r.injuryReports.filter(a=>a.id!==t),sa(r);return}const{error:e}=await Pe.from("injury_reports").delete().eq("id",t);if(e)throw console.error("Error deleting injury report:",e),e},async getInjuryStatistics(t,e=null,r=null){if(!$e){const s=or();if(!s.injuryReports)return{total_incidents:0,minor_injuries:0,serious_injuries:0,critical_injuries:0,near_misses:0,osha_recordable:0,total_days_away:0,total_restricted_days:0};let o=s.injuryReports.filter(u=>u.company_id===t);return e&&(o=o.filter(u=>new Date(u.incident_date)>=new Date(e))),r&&(o=o.filter(u=>new Date(u.incident_date)<=new Date(r))),{total_incidents:o.length,minor_injuries:o.filter(u=>u.injury_type==="minor").length,serious_injuries:o.filter(u=>u.injury_type==="serious").length,critical_injuries:o.filter(u=>u.injury_type==="critical").length,near_misses:o.filter(u=>u.injury_type==="near_miss").length,osha_recordable:o.filter(u=>u.osha_recordable).length,total_days_away:o.reduce((u,f)=>u+(f.days_away_from_work||0),0),total_restricted_days:o.reduce((u,f)=>u+(f.restricted_work_days||0),0)}}const{data:a,error:n}=await Pe.rpc("get_injury_statistics",{comp_id:t,start_date:e,end_date:r});return n?(console.error("Error fetching injury statistics:",n),null):a[0]||null},async addWitness(t,e){if(!$e){const n=or();if(!n.injuryReports)return null;const s=n.injuryReports.findIndex(f=>f.id===t);if(s===-1)return null;const o=n.injuryReports[s],u=o.witnesses||[];return u.push(e),n.injuryReports[s]={...o,witnesses:u,updated_at:new Date().toISOString()},sa(n),n.injuryReports[s]}const r=await this.getInjuryReport(t);if(!r)return null;const a=r.witnesses||[];return a.push(e),this.updateInjuryReport(t,{witnesses:a})},async removeWitness(t,e){if(!$e){const n=or();if(!n.injuryReports)return null;const s=n.injuryReports.findIndex(f=>f.id===t);if(s===-1)return null;const o=n.injuryReports[s],u=o.witnesses||[];return u.splice(e,1),n.injuryReports[s]={...o,witnesses:u,updated_at:new Date().toISOString()},sa(n),n.injuryReports[s]}const r=await this.getInjuryReport(t);if(!r)return null;const a=r.witnesses||[];return a.splice(e,1),this.updateInjuryReport(t,{witnesses:a})},async getCompanyUsers(t){if($e){const{data:e,error:r}=await Pe.from("user_companies").select(`
          user_id,
          role,
          users (
            id,
            name,
            email
          )
        `).eq("company_id",t);return r?(console.error("Error fetching company users:",r),[]):e?.map(a=>({id:a.user_id,name:a.users?.name||a.users?.email,email:a.users?.email,role:a.role}))||[]}return[]},async getProjectNotificationPreferences(t){if($e){const{data:r,error:a}=await Pe.from("notification_preferences").select(`
          *,
          users (
            id,
            name,
            email
          )
        `).eq("project_id",t);return a?(console.error("Error fetching notification preferences:",a),[]):r||[]}const e=or();return e.notificationPreferences?e.notificationPreferences.filter(r=>r.project_id===t):[]},async getUserNotificationPreferences(t){if($e){const{data:r,error:a}=await Pe.from("notification_preferences").select(`
          *,
          projects (
            id,
            name
          )
        `).eq("user_id",t);return a?(console.error("Error fetching user notification preferences:",a),[]):r||[]}const e=or();return e.notificationPreferences?e.notificationPreferences.filter(r=>r.user_id===t):[]},async setNotificationPreference(t,e,r){if($e){const{data:o,error:u}=await Pe.from("notification_preferences").upsert({project_id:t,user_id:e,notification_types:r,updated_at:new Date().toISOString()},{onConflict:"project_id,user_id"}).select().single();if(u)throw console.error("Error setting notification preference:",u),u;return o}const a=or();a.notificationPreferences||(a.notificationPreferences=[]);const n=a.notificationPreferences.findIndex(o=>o.project_id===t&&o.user_id===e),s={id:n>=0?a.notificationPreferences[n].id:crypto.randomUUID(),project_id:t,user_id:e,notification_types:r,created_at:n>=0?a.notificationPreferences[n].created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return n>=0?a.notificationPreferences[n]=s:a.notificationPreferences.push(s),sa(a),s},async removeNotificationPreference(t,e){if($e){const{error:a}=await Pe.from("notification_preferences").delete().eq("project_id",t).eq("user_id",e);if(a)throw console.error("Error removing notification preference:",a),a;return!0}const r=or();return r.notificationPreferences&&(r.notificationPreferences=r.notificationPreferences.filter(a=>!(a.project_id===t&&a.user_id===e)),sa(r)),!0},async setProjectNotificationPreferences(t,e){const r=[];for(const a of e)if(a.notificationTypes&&a.notificationTypes.length>0){const n=await this.setNotificationPreference(t,a.userId,a.notificationTypes);r.push(n)}else await this.removeNotificationPreference(t,a.userId);return r},async getNotificationPresets(t){if($e){const{data:r,error:a}=await Pe.from("notification_presets").select("*").eq("company_id",t).order("name");return a?(console.error("Error fetching notification presets:",a),[]):r||[]}const e=or();return e.notificationPresets?e.notificationPresets.filter(r=>r.company_id===t):[{id:"preset-1",name:"Project Manager",notification_types:["message","material_request","injury_report","tm_ticket"],company_id:t},{id:"preset-2",name:"Safety Officer",notification_types:["injury_report"],company_id:t},{id:"preset-3",name:"Purchasing",notification_types:["material_request"],company_id:t},{id:"preset-4",name:"Accounting",notification_types:["tm_ticket"],company_id:t}]},async createNotificationPreset(t,e,r){if($e){const{data:s,error:o}=await Pe.from("notification_presets").insert({company_id:t,name:e,notification_types:r}).select().single();if(o)throw console.error("Error creating notification preset:",o),o;return s}const a=or();a.notificationPresets||(a.notificationPresets=[]);const n={id:crypto.randomUUID(),company_id:t,name:e,notification_types:r,created_at:new Date().toISOString()};return a.notificationPresets.push(n),sa(a),n},async updateNotificationPreset(t,e,r){if($e){const{data:s,error:o}=await Pe.from("notification_presets").update({name:e,notification_types:r,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(o)throw console.error("Error updating notification preset:",o),o;return s}const a=or();if(!a.notificationPresets)return null;const n=a.notificationPresets.findIndex(s=>s.id===t);return n===-1?null:(a.notificationPresets[n]={...a.notificationPresets[n],name:e,notification_types:r,updated_at:new Date().toISOString()},sa(a),a.notificationPresets[n])},async deleteNotificationPreset(t){if($e){const{error:r}=await Pe.from("notification_presets").delete().eq("id",t);if(r)throw console.error("Error deleting notification preset:",r),r;return!0}const e=or();return e.notificationPresets&&(e.notificationPresets=e.notificationPresets.filter(r=>r.id!==t),sa(e)),!0},async getDumpSites(t){if($e){const{data:r,error:a}=await Pe.from("dump_sites").select(`
          *,
          dump_site_rates (*)
        `).eq("company_id",t).eq("active",!0).order("name");return a?(console.error("Error fetching dump sites:",a),[]):r||[]}return(or().dumpSites||[]).filter(r=>r.company_id===t&&r.active)},async createDumpSite(t,e,r="",a=""){if($e){const{data:o,error:u}=await Pe.from("dump_sites").insert({company_id:t,name:e,address:r,notes:a,active:!0}).select().single();if(u)throw console.error("Error creating dump site:",u),u;return o}const n=or();n.dumpSites||(n.dumpSites=[]);const s={id:crypto.randomUUID(),company_id:t,name:e,address:r,notes:a,active:!0,created_at:new Date().toISOString(),dump_site_rates:[]};return n.dumpSites.push(s),sa(n),s},async updateDumpSite(t,e){if($e){const{data:n,error:s}=await Pe.from("dump_sites").update({...e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(s)throw console.error("Error updating dump site:",s),s;return n}const r=or();if(!r.dumpSites)return null;const a=r.dumpSites.findIndex(n=>n.id===t);return a===-1?null:(r.dumpSites[a]={...r.dumpSites[a],...e},sa(r),r.dumpSites[a])},async deleteDumpSite(t){return this.updateDumpSite(t,{active:!1})},async setDumpSiteRate(t,e,r,a="load"){if($e){const{data:u}=await Pe.from("dump_site_rates").select("id").eq("dump_site_id",t).eq("waste_type",e).maybeSingle();if(u){const{data:f,error:h}=await Pe.from("dump_site_rates").update({estimated_cost_per_load:r,unit:a}).eq("id",u.id).select().single();if(h)throw console.error("Error updating dump site rate:",h),h;return f}else{const{data:f,error:h}=await Pe.from("dump_site_rates").insert({dump_site_id:t,waste_type:e,estimated_cost_per_load:r,unit:a}).select().single();if(h)throw console.error("Error inserting dump site rate:",h),h;return f}}const n=or();n.dumpSiteRates||(n.dumpSiteRates=[]);const s=n.dumpSiteRates.findIndex(u=>u.dump_site_id===t&&u.waste_type===e),o={id:s>=0?n.dumpSiteRates[s].id:crypto.randomUUID(),dump_site_id:t,waste_type:e,estimated_cost_per_load:r,unit:a,created_at:new Date().toISOString()};return s>=0?n.dumpSiteRates[s]=o:n.dumpSiteRates.push(o),sa(n),o},async getDumpSiteRates(t){if($e){const{data:r,error:a}=await Pe.from("dump_site_rates").select("*").eq("dump_site_id",t);return a?(console.error("Error fetching dump site rates:",a),[]):r||[]}return(or().dumpSiteRates||[]).filter(r=>r.dump_site_id===t)},async getHaulOffs(t){if($e){const{data:r,error:a}=await Pe.from("haul_offs").select(`
          *,
          dump_sites (name)
        `).eq("project_id",t).order("work_date",{ascending:!1});return a?(console.error("Error fetching haul-offs:",a),[]):r||[]}return(or().haulOffs||[]).filter(r=>r.project_id===t).sort((r,a)=>new Date(a.work_date)-new Date(r.work_date))},async createHaulOff(t,e){const r={project_id:t,dump_site_id:e.dumpSiteId,waste_type:e.wasteType,loads:e.loads,hauling_company:e.haulingCompany||"",work_date:e.workDate,notes:e.notes||"",estimated_cost:e.estimatedCost||0,created_by:e.createdBy||""};if($e){const{data:s,error:o}=await Pe.from("haul_offs").insert(r).select().single();if(o)throw console.error("Error creating haul-off:",o),o;return s}const a=or();a.haulOffs||(a.haulOffs=[]);const n={...r,id:crypto.randomUUID(),created_at:new Date().toISOString()};return a.haulOffs.push(n),sa(a),n},async calculateHaulOffCosts(t){const e=await this.getHaulOffs(t);let r=0,a=0;const n={},s=[],o={};e.forEach(f=>{const h=parseFloat(f.estimated_cost)||0,m=parseInt(f.loads)||0;r+=h,a+=m,n[f.waste_type]||(n[f.waste_type]={loads:0,cost:0}),n[f.waste_type].loads+=m,n[f.waste_type].cost+=h,o[f.work_date]||(o[f.work_date]={date:f.work_date,loads:0,cost:0}),o[f.work_date].loads+=m,o[f.work_date].cost+=h}),Object.values(o).sort((f,h)=>new Date(h.date)-new Date(f.date)).forEach(f=>s.push(f));const u=s.length;return{totalCost:r,totalLoads:a,byWasteType:n,byDate:s,daysWithHaulOff:u,avgDailyHaulOffCost:u>0?r/u:0}},subscribeToHaulOffs(t,e){return $e?Pe.channel(`haul_offs:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"haul_offs",filter:`project_id=eq.${t}`},e).subscribe():null},async createCOR(t){if($e){const{data:e,error:r}=await Pe.from("change_orders").insert({company_id:t.company_id,project_id:t.project_id,area_id:t.area_id||null,cor_number:t.cor_number,title:t.title,description:t.description||"",scope_of_work:t.scope_of_work,period_start:t.period_start,period_end:t.period_end,status:"draft",labor_markup_percent:t.labor_markup_percent??1500,materials_markup_percent:t.materials_markup_percent??1500,equipment_markup_percent:t.equipment_markup_percent??1500,subcontractors_markup_percent:t.subcontractors_markup_percent??500,liability_insurance_percent:t.liability_insurance_percent??144,bond_percent:t.bond_percent??100,license_fee_percent:t.license_fee_percent??10,created_by:t.created_by||null}).select().single();if(r)throw r;return e}return null},async updateCOR(t,e){if($e){const{data:r,error:a}=await Pe.from("change_orders").update({...e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteCOR(t){if($e){const{error:e}=await Pe.from("change_orders").delete().eq("id",t);if(e)throw e}},async getCORs(t,e={}){if($e){let r=Pe.from("change_orders").select(`
          *,
          areas (id, name),
          labor_count:change_order_labor(count),
          materials_count:change_order_materials(count),
          equipment_count:change_order_equipment(count),
          subcontractors_count:change_order_subcontractors(count),
          tickets_count:change_order_ticket_associations(count)
        `).eq("project_id",t);e.status&&(r=r.eq("status",e.status)),e.area_id&&(r=r.eq("area_id",e.area_id)),e.date_start&&(r=r.gte("period_start",e.date_start)),e.date_end&&(r=r.lte("period_end",e.date_end)),r=r.order("created_at",{ascending:!1});const{data:a,error:n}=await r;if(n)throw n;return a}return[]},async getCORById(t){if($e){const{data:e,error:r}=await Pe.from("change_orders").select(`
          *,
          areas (id, name),
          change_order_labor (*),
          change_order_materials (*),
          change_order_equipment (*),
          change_order_subcontractors (*),
          change_order_ticket_associations (
            *,
            t_and_m_tickets (
              id, work_date, ce_pco_number, status, notes
            )
          )
        `).eq("id",t).single();if(r)throw r;return e}return null},async getCORsByArea(t,e){if($e){const{data:r,error:a}=await Pe.from("change_orders").select("*").eq("project_id",t).eq("area_id",e).order("created_at",{ascending:!1});if(a)throw a;return r}return[]},async getNextCORNumber(t){if($e){const{data:e,error:r}=await Pe.from("change_orders").select("cor_number").eq("project_id",t).order("created_at",{ascending:!1}).limit(1);if(r)throw r;if(e&&e.length>0){const a=e[0].cor_number.match(/COR #(\d+)/);if(a)return`COR #${parseInt(a[1])+1}`}return"COR #1"}return"COR #1"},async addCORLaborItem(t,e){if($e){const r=Math.round(e.regular_hours*e.regular_rate),a=Math.round(e.overtime_hours*e.overtime_rate),n=r+a,{data:s,error:o}=await Pe.from("change_order_labor").insert({change_order_id:t,labor_class:e.labor_class,wage_type:e.wage_type||"standard",regular_hours:e.regular_hours||0,overtime_hours:e.overtime_hours||0,regular_rate:e.regular_rate||0,overtime_rate:e.overtime_rate||0,regular_total:r,overtime_total:a,total:n,sort_order:e.sort_order||0,source_ticket_id:e.source_ticket_id||null}).select().single();if(o)throw o;return s}return null},async updateCORLaborItem(t,e){if($e){let r={...e};if(e.regular_hours!==void 0||e.regular_rate!==void 0||e.overtime_hours!==void 0||e.overtime_rate!==void 0){const{data:s}=await Pe.from("change_order_labor").select("regular_hours, overtime_hours, regular_rate, overtime_rate").eq("id",t).single(),o=e.regular_hours??s?.regular_hours??0,u=e.overtime_hours??s?.overtime_hours??0,f=e.regular_rate??s?.regular_rate??0,h=e.overtime_rate??s?.overtime_rate??0;r.regular_total=Math.round(o*f),r.overtime_total=Math.round(u*h),r.total=r.regular_total+r.overtime_total}const{data:a,error:n}=await Pe.from("change_order_labor").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCORLaborItem(t){if($e){const{error:e}=await Pe.from("change_order_labor").delete().eq("id",t);if(e)throw e}},async addCORMaterialItem(t,e){if($e){const r=Math.round(e.quantity*e.unit_cost),{data:a,error:n}=await Pe.from("change_order_materials").insert({change_order_id:t,description:e.description,quantity:e.quantity||1,unit:e.unit||"each",unit_cost:e.unit_cost||0,total:r,source_type:e.source_type||"custom",source_reference:e.source_reference||null,source_ticket_id:e.source_ticket_id||null,sort_order:e.sort_order||0}).select().single();if(n)throw n;return a}return null},async updateCORMaterialItem(t,e){if($e){let r={...e};if(e.quantity!==void 0||e.unit_cost!==void 0){const{data:s}=await Pe.from("change_order_materials").select("quantity, unit_cost").eq("id",t).single(),o=e.quantity??s?.quantity??1,u=e.unit_cost??s?.unit_cost??0;r.total=Math.round(o*u)}const{data:a,error:n}=await Pe.from("change_order_materials").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCORMaterialItem(t){if($e){const{error:e}=await Pe.from("change_order_materials").delete().eq("id",t);if(e)throw e}},async addCOREquipmentItem(t,e){if($e){const r=Math.round(e.quantity*e.unit_cost),{data:a,error:n}=await Pe.from("change_order_equipment").insert({change_order_id:t,description:e.description,quantity:e.quantity||1,unit:e.unit||"day",unit_cost:e.unit_cost||0,total:r,source_type:e.source_type||"custom",source_reference:e.source_reference||null,source_ticket_id:e.source_ticket_id||null,sort_order:e.sort_order||0}).select().single();if(n)throw n;return a}return null},async updateCOREquipmentItem(t,e){if($e){let r={...e};if(e.quantity!==void 0||e.unit_cost!==void 0){const{data:s}=await Pe.from("change_order_equipment").select("quantity, unit_cost").eq("id",t).single(),o=e.quantity??s?.quantity??1,u=e.unit_cost??s?.unit_cost??0;r.total=Math.round(o*u)}const{data:a,error:n}=await Pe.from("change_order_equipment").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCOREquipmentItem(t){if($e){const{error:e}=await Pe.from("change_order_equipment").delete().eq("id",t);if(e)throw e}},async addCORSubcontractorItem(t,e){if($e){const r=Math.round(e.quantity*e.unit_cost),{data:a,error:n}=await Pe.from("change_order_subcontractors").insert({change_order_id:t,description:e.description,quantity:e.quantity||1,unit:e.unit||"lump sum",unit_cost:e.unit_cost||0,total:r,source_type:e.source_type||"custom",source_reference:e.source_reference||null,sort_order:e.sort_order||0}).select().single();if(n)throw n;return a}return null},async updateCORSubcontractorItem(t,e){if($e){let r={...e};if(e.quantity!==void 0||e.unit_cost!==void 0){const{data:s}=await Pe.from("change_order_subcontractors").select("quantity, unit_cost").eq("id",t).single(),o=e.quantity??s?.quantity??1,u=e.unit_cost??s?.unit_cost??0;r.total=Math.round(o*u)}const{data:a,error:n}=await Pe.from("change_order_subcontractors").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCORSubcontractorItem(t){if($e){const{error:e}=await Pe.from("change_order_subcontractors").delete().eq("id",t);if(e)throw e}},async addBulkLaborItems(t,e){if($e&&e.length>0){const r=e.map((s,o)=>{const u=Math.round(s.regular_hours*s.regular_rate),f=Math.round(s.overtime_hours*s.overtime_rate);return{change_order_id:t,labor_class:s.labor_class,wage_type:s.wage_type||"standard",regular_hours:s.regular_hours||0,overtime_hours:s.overtime_hours||0,regular_rate:s.regular_rate||0,overtime_rate:s.overtime_rate||0,regular_total:u,overtime_total:f,total:u+f,sort_order:s.sort_order??o,source_ticket_id:s.source_ticket_id||null}}),{data:a,error:n}=await Pe.from("change_order_labor").insert(r).select();if(n)throw n;return a}return[]},async addBulkMaterialItems(t,e){if($e&&e.length>0){const r=e.map((s,o)=>({change_order_id:t,description:s.description,quantity:s.quantity||1,unit:s.unit||"each",unit_cost:s.unit_cost||0,total:Math.round((s.quantity||1)*(s.unit_cost||0)),source_type:s.source_type||"custom",source_reference:s.source_reference||null,source_ticket_id:s.source_ticket_id||null,sort_order:s.sort_order??o})),{data:a,error:n}=await Pe.from("change_order_materials").insert(r).select();if(n)throw n;return a}return[]},async addBulkEquipmentItems(t,e){if($e&&e.length>0){const r=e.map((s,o)=>({change_order_id:t,description:s.description,quantity:s.quantity||1,unit:s.unit||"day",unit_cost:s.unit_cost||0,total:Math.round((s.quantity||1)*(s.unit_cost||0)),source_type:s.source_type||"custom",source_reference:s.source_reference||null,source_ticket_id:s.source_ticket_id||null,sort_order:s.sort_order??o})),{data:a,error:n}=await Pe.from("change_order_equipment").insert(r).select();if(n)throw n;return a}return[]},async addBulkSubcontractorItems(t,e){if($e&&e.length>0){const r=e.map((s,o)=>({change_order_id:t,description:s.description,quantity:s.quantity||1,unit:s.unit||"lump sum",unit_cost:s.unit_cost||0,total:Math.round((s.quantity||1)*(s.unit_cost||0)),source_type:s.source_type||"custom",source_reference:s.source_reference||null,sort_order:s.sort_order??o})),{data:a,error:n}=await Pe.from("change_order_subcontractors").insert(r).select();if(n)throw n;return a}return[]},async clearCORLineItems(t){$e&&(await Pe.from("change_order_labor").delete().eq("change_order_id",t),await Pe.from("change_order_materials").delete().eq("change_order_id",t),await Pe.from("change_order_equipment").delete().eq("change_order_id",t),await Pe.from("change_order_subcontractors").delete().eq("change_order_id",t))},async saveCORLineItems(t,{laborItems:e,materialItems:r,equipmentItems:a,subcontractorItems:n}){if($e){await this.clearCORLineItems(t);const s=await Promise.all([e?.length>0?this.addBulkLaborItems(t,e):[],r?.length>0?this.addBulkMaterialItems(t,r):[],a?.length>0?this.addBulkEquipmentItems(t,a):[],n?.length>0?this.addBulkSubcontractorItems(t,n):[]]);return{labor:s[0],materials:s[1],equipment:s[2],subcontractors:s[3]}}return null},async assignTicketToCOR(t,e){if($e){const{data:r,error:a}=await Pe.from("change_order_ticket_associations").insert({change_order_id:e,ticket_id:t,data_imported:!1}).select().single();if(a)throw a;const{error:n}=await Pe.from("t_and_m_tickets").update({assigned_cor_id:e}).eq("id",t);if(n)throw n;return r}return null},async unassignTicketFromCOR(t,e){if($e){const{error:r}=await Pe.from("change_order_ticket_associations").delete().eq("ticket_id",t).eq("change_order_id",e);if(r)throw r;const{error:a}=await Pe.from("t_and_m_tickets").update({assigned_cor_id:null}).eq("id",t);if(a)throw a}},async getTicketsForCOR(t){if($e){const{data:e,error:r}=await Pe.from("change_order_ticket_associations").select(`
          *,
          t_and_m_tickets (
            *,
            t_and_m_workers (*),
            t_and_m_items (
              *,
              materials_equipment (name, unit, cost_per_unit, category)
            )
          )
        `).eq("change_order_id",t);if(r)throw r;return e}return[]},async getUnassignedTickets(t){if($e){const{data:e,error:r}=await Pe.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).is("assigned_cor_id",null).order("work_date",{ascending:!1});if(r)throw r;return e}return[]},async importTicketDataToCOR(t,e,r,a,n){if($e){const{data:s,error:o}=await Pe.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("id",t).single();if(o)throw o;const{data:u,error:f}=await Pe.from("labor_rates").select("*").eq("company_id",r).eq("work_type",a||"demolition").eq("job_type",n||"standard");if(f)throw f;const h={};u?.forEach(_=>{h[_.role.toLowerCase()]=_});const m={};s.t_and_m_workers?.forEach(_=>{const S=(_.role||"laborer").toLowerCase();m[S]||(m[S]={regular_hours:0,overtime_hours:0}),m[S].regular_hours+=parseFloat(_.hours)||0,m[S].overtime_hours+=parseFloat(_.overtime_hours)||0});const v=Object.entries(m).map(([_,S])=>{const E=h[_]||{regular_rate:0,overtime_rate:0},C=Math.round((parseFloat(E.regular_rate)||0)*100),j=Math.round((parseFloat(E.overtime_rate)||0)*100);return{labor_class:_.charAt(0).toUpperCase()+_.slice(1),wage_type:n||"standard",regular_hours:S.regular_hours,overtime_hours:S.overtime_hours,regular_rate:C,overtime_rate:j,source_ticket_id:t}});v.length>0&&await this.addBulkLaborItems(e,v);const y=[],g=[];s.t_and_m_items?.forEach(_=>{const S=_.custom_name||_.materials_equipment?.name||"Unknown Item",E=_.custom_category||_.materials_equipment?.category||"Other",C=_.materials_equipment?.unit||"each",j=Math.round((parseFloat(_.materials_equipment?.cost_per_unit)||0)*100),R={description:S,quantity:_.quantity||1,unit:C,unit_cost:j,source_type:"backup_sheet",source_ticket_id:t};E==="Equipment"?g.push(R):y.push(R)}),y.length>0&&await this.addBulkMaterialItems(e,y),g.length>0&&await this.addBulkEquipmentItems(e,g);const{error:b}=await Pe.from("change_order_ticket_associations").update({data_imported:!0,imported_at:new Date().toISOString()}).eq("change_order_id",e).eq("ticket_id",t);if(b)throw b;return{laborItems:v,materialItems:y,equipmentItems:g}}return null},async reimportTicketDataToCOR(t,e,r,a,n){return $e?(await Pe.from("change_order_labor").delete().eq("change_order_id",e).eq("source_ticket_id",t),await Pe.from("change_order_materials").delete().eq("change_order_id",e).eq("source_ticket_id",t),await Pe.from("change_order_equipment").delete().eq("change_order_id",e).eq("source_ticket_id",t),this.importTicketDataToCOR(t,e,r,a,n)):null},async recalculateCOR(t){if($e){const{error:e}=await Pe.rpc("recalculate_cor_totals",{cor_id:t});if(e)throw e;return this.getCORById(t)}return null},async updateCORMarkupPercentages(t,e){if($e){const r={};e.labor!==void 0&&(r.labor_markup_percent=e.labor),e.materials!==void 0&&(r.materials_markup_percent=e.materials),e.equipment!==void 0&&(r.equipment_markup_percent=e.equipment),e.subcontractors!==void 0&&(r.subcontractors_markup_percent=e.subcontractors);const{data:a,error:n}=await Pe.from("change_orders").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async updateCORFeePercentages(t,e){if($e){const r={};e.liabilityInsurance!==void 0&&(r.liability_insurance_percent=e.liabilityInsurance),e.bond!==void 0&&(r.bond_percent=e.bond),e.licenseFee!==void 0&&(r.license_fee_percent=e.licenseFee);const{data:a,error:n}=await Pe.from("change_orders").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async submitCORForApproval(t){if($e){const{data:e,error:r}=await Pe.from("change_orders").update({status:"pending_approval",submitted_at:new Date().toISOString()}).eq("id",t).select().single();if(r)throw r;return e}return null},async approveCOR(t,e){if($e){const{data:r,error:a}=await Pe.from("change_orders").update({status:"approved",approved_by:e,approved_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return r}return null},async rejectCOR(t,e=null){if($e){const{data:r,error:a}=await Pe.from("change_orders").update({status:"rejected",rejection_reason:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async markCORAsBilled(t){if($e){const{data:e,error:r}=await Pe.from("change_orders").update({status:"billed"}).eq("id",t).select().single();if(r)throw r;return e}return null},async closeCOR(t){if($e){const{data:e,error:r}=await Pe.from("change_orders").update({status:"closed"}).eq("id",t).select().single();if(r)throw r;return e}return null},async saveCORSignature(t,e,r){if($e){const{data:a,error:n}=await Pe.from("change_orders").update({gc_signature_data:e,gc_signature_name:r,gc_signature_date:new Date().toISOString(),status:"approved"}).eq("id",t).select().single();if(n)throw n;return a}return null},async getCORStats(t){if($e){const{data:e,error:r}=await Pe.from("change_orders").select("status, cor_total").eq("project_id",t);if(r)throw r;const a={total_cors:e.length,draft_count:0,pending_count:0,approved_count:0,rejected_count:0,billed_count:0,total_approved_value:0,total_pending_value:0,total_billed_value:0};return e.forEach(n=>{switch(n.status){case"draft":a.draft_count++;break;case"pending_approval":a.pending_count++,a.total_pending_value+=n.cor_total||0;break;case"approved":a.approved_count++,a.total_approved_value+=n.cor_total||0;break;case"rejected":a.rejected_count++;break;case"billed":case"closed":a.billed_count++,a.total_billed_value+=n.cor_total||0;break}}),a}return{total_cors:0,draft_count:0,pending_count:0,approved_count:0,rejected_count:0,billed_count:0,total_approved_value:0,total_pending_value:0,total_billed_value:0}},subscribeToCORs(t,e){return $e?Pe.channel(`change_orders:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"change_orders",filter:`project_id=eq.${t}`},e).subscribe():null}};O4(async t=>{if(t&&$e){console.log("Back online - syncing pending actions...");try{const e=await fC(ut);e.synced>0&&console.log(`Synced ${e.synced} pending actions`),e.failed>0&&console.warn(`Failed to sync ${e.failed} actions`)}catch(e){console.error("Error syncing pending actions:",e)}}});const F4=se.createContext(),Ci={logo_url:null,favicon_url:null,login_background_url:null,primary_color:"#3B82F6",secondary_color:"#1E40AF",custom_app_name:"FieldSync",hide_fieldsync_branding:!1,email_from_name:"FieldSync",email_from_address:null,custom_domain:null,domain_verified:!1};function Jd({children:t,companyId:e}){const[r,a]=se.useState(Ci),[n,s]=se.useState(!0);se.useEffect(()=>{e?o(e):u()},[e]),se.useEffect(()=>{m(r)},[r]);const o=async g=>{try{if(s(!0),!$e){a(Ci),s(!1);return}const{data:b,error:_}=await Pe.from("company_branding").select("*").eq("company_id",g).single();_?(_.code==="PGRST116"?await f(g):console.error("Error loading branding:",_),a(Ci)):a({...Ci,...b})}catch(b){console.error("Error in loadBranding:",b),a(Ci)}finally{s(!1)}},u=async()=>{try{s(!0);const g=window.location.hostname;if(g==="localhost"||g==="127.0.0.1"){a(Ci),s(!1);return}if(!$e){a(Ci),s(!1);return}const{data:b,error:_}=await Pe.rpc("get_branding_by_domain",{domain_name:g});_||!b||b.length===0?a(Ci):a({...Ci,...b[0]})}catch(g){console.error("Error loading branding by domain:",g),a(Ci)}finally{s(!1)}},f=async g=>{try{const{data:b,error:_}=await Pe.from("company_branding").insert({company_id:g,...Ci}).select().single();_&&console.error("Error creating default branding:",_)}catch(b){console.error("Error in createDefaultBranding:",b)}},h=async g=>{try{if(!$e)return a(R=>({...R,...g})),{success:!0};if(!e)return{success:!1,error:"No company ID"};const b={},_=["logo_url","favicon_url","login_background_url","primary_color","secondary_color","custom_app_name","hide_fieldsync_branding","email_from_name","email_from_address","custom_domain","domain_verified"];for(const R of _)g[R]!==void 0&&(b[R]=g[R]);const{data:S,error:E}=await Pe.from("company_branding").select("id").eq("company_id",e).single();if(E&&E.code==="PGRST116"){const{data:R,error:H}=await Pe.from("company_branding").insert({company_id:e,...b}).select().single();return H?(console.error("Error creating branding:",H),{success:!1,error:H.message}):(a({...Ci,...R}),{success:!0,data:R})}const{data:C,error:j}=await Pe.from("company_branding").update(b).eq("company_id",e).select().single();return j?(console.error("Error updating branding:",j),{success:!1,error:j.message}):(a({...Ci,...C}),{success:!0,data:C})}catch(b){return console.error("Error in updateBranding:",b),{success:!1,error:b.message}}},m=g=>{const b=document.documentElement;if(b.style.setProperty("--primary-color",g.primary_color),b.style.setProperty("--secondary-color",g.secondary_color),g.favicon_url){let _=document.querySelector("link[rel*='icon']");_||(_=document.createElement("link"),_.rel="icon",document.head.appendChild(_)),_.href=g.favicon_url}document.title=g.custom_app_name||"FieldSync"},y={branding:r,loading:n,updateBranding:h,uploadBrandingImage:async(g,b)=>{try{if(!$e)return{success:!0,url:URL.createObjectURL(g)};const _=g.name.split(".").pop(),E=`branding/${`${e}/${b}-${Date.now()}.${_}`}`,{data:C,error:j}=await Pe.storage.from("public").upload(E,g,{cacheControl:"3600",upsert:!0});if(j)return console.error("Error uploading image:",j),{success:!1,error:j.message};const{data:{publicUrl:R}}=Pe.storage.from("public").getPublicUrl(E);return{success:!0,url:R}}catch(_){return console.error("Error in uploadBrandingImage:",_),{success:!1,error:_.message}}},refreshBranding:()=>e?o(e):u()};return l.jsx(F4.Provider,{value:y,children:t})}function od(){const t=se.useContext(F4);if(!t)throw new Error("useBranding must be used within a BrandingProvider");return t}const pC=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gC=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,a)=>a?a.toUpperCase():r.toLowerCase()),Wb=t=>{const e=gC(t);return e.charAt(0).toUpperCase()+e.slice(1)},L4=(...t)=>t.filter((e,r,a)=>!!e&&e.trim()!==""&&a.indexOf(e)===r).join(" ").trim(),vC=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var xC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const yC=se.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:s,iconNode:o,...u},f)=>se.createElement("svg",{ref:f,...xC,width:e,height:e,stroke:t,strokeWidth:a?Number(r)*24/Number(e):r,className:L4("lucide",n),...!s&&!vC(u)&&{"aria-hidden":"true"},...u},[...o.map(([h,m])=>se.createElement(h,m)),...Array.isArray(s)?s:[s]]));const Sr=(t,e)=>{const r=se.forwardRef(({className:a,...n},s)=>se.createElement(yC,{ref:s,iconNode:e,className:L4(`lucide-${pC(Wb(t))}`,`lucide-${t}`,a),...n}));return r.displayName=Wb(t),r};const _C=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],bC=Sr("bell",_C);const wC=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],S0=Sr("briefcase",wC);const SC=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],P4=Sr("building-2",SC);const NC=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],q0=Sr("calendar",NC);const kC=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],jp=Sr("camera",kC);const jC=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],M4=Sr("check",jC);const EC=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ld=Sr("chevron-down",EC);const AC=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],CC=Sr("chevron-left",AC);const TC=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],jf=Sr("chevron-right",TC);const OC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],V2=Sr("circle-alert",OC);const RC=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],I4=Sr("circle-check-big",RC);const DC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Vb=Sr("circle-x",DC);const FC=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],fu=Sr("clipboard-list",FC);const LC=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],PC=Sr("clock",LC);const MC=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ip=Sr("dollar-sign",MC);const IC=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],BC=Sr("download",IC);const UC=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],qC=Sr("eye",UC);const zC=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],hc=Sr("file-text",zC);const HC=[["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["rect",{x:"2",y:"15",width:"20",height:"4",rx:"1",key:"g3x8cw"}]],Ui=Sr("hard-hat",HC);const $C=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],B4=Sr("info",$C);const WC=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],VC=Sr("layout-grid",WC);const GC=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],YC=Sr("map-pin",GC);const XC=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],z0=Sr("message-square",XC);const KC=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Ef=Sr("package",KC);const JC=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],G2=Sr("pen-line",JC);const ZC=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],QC=Sr("pen-tool",ZC);const eT=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],tT=Sr("pen",eT);const rT=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],U4=Sr("pencil",rT);const aT=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],nT=Sr("percent",aT);const sT=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],iT=Sr("phone",sT);const oT=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Sl=Sr("plus",oT);const lT=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],cT=Sr("rotate-ccw",lT);const uT=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Gb=Sr("save",uT);const fT=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],hT=Sr("search",fT);const dT=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],q4=Sr("send",dT);const mT=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],pT=Sr("shield",mT);const gT=[["path",{d:"M14 13V8.5C14 7 15 7 15 5a3 3 0 0 0-6 0c0 2 1 2 1 3.5V13",key:"i9gjdv"}],["path",{d:"M20 15.5a2.5 2.5 0 0 0-2.5-2.5h-11A2.5 2.5 0 0 0 4 15.5V17a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1z",key:"1vzg3v"}],["path",{d:"M5 22h14",key:"ehvnwv"}]],vT=Sr("stamp",gT);const xT=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],cf=Sr("trash-2",xT);const yT=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],o1=Sr("triangle-alert",yT);const _T=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],l1=Sr("truck",_T);const bT=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],wT=Sr("upload",bT);const ST=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],NT=Sr("user-check",ST);const kT=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],z4=Sr("users",kT);const jT=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],Y2=Sr("wrench",jT);const ET=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],c1=Sr("x",ET);const AT=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],CT=Sr("zap",AT);function Nl({className:t="",showPoweredBy:e=!1}){const{branding:r}=od();return l.jsxs("div",{className:`app-logo ${t}`,children:[r.logo_url?l.jsx("img",{src:r.logo_url,alt:r.custom_app_name||"Logo",className:"custom-logo"}):l.jsxs("div",{className:"logo",children:[r.custom_app_name||"Field",l.jsx("span",{children:"Sync"})]}),e&&!r.hide_fieldsync_branding&&l.jsx("div",{className:"powered-by",children:"Powered by FieldSync"})]})}function TT({onForemanAccess:t,onOfficeLogin:e,onShowToast:r}){const[a,n]=se.useState(null),[s,o]=se.useState(""),[u,f]=se.useState(null),[h,m]=se.useState(""),[v,y]=se.useState(!1),[g,b]=se.useState(""),[_,S]=se.useState(""),[E,C]=se.useState(1),[j,R]=se.useState(null),[H,Y]=se.useState(""),[U,V]=se.useState(""),[F,X]=se.useState(""),[P,O]=se.useState(""),I=D=>{const B=D.toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,20);o(B)},W=async()=>{if(s.length<2){r("Enter company code","error");return}y(!0);try{const D=await ut.getCompanyByCode(s);D?f(D):(r("Invalid company code","error"),o(""))}catch{r("Error checking code","error")}finally{y(!1)}},ne=async D=>{if(D.length===4){y(!0);try{const B=await ut.getProjectByPinAndCompany(D,u.id);B?t(B):(r("Invalid PIN","error"),m(""))}catch{r("Error checking PIN","error")}finally{y(!1)}}},Q=D=>{if(h.length<4){const B=h+D;m(B),B.length===4&&setTimeout(()=>ne(B),200)}},le=()=>{m(D=>D.slice(0,-1))},ee=()=>{f(null),m("")},K=()=>{if(!g.trim()||!_.trim()){r("Enter email and password","error");return}e(g,_)},ue=async()=>{if(s.length<2){r("Enter company code","error");return}y(!0);try{const D=await ut.getCompanyByCode(s);D?(R(D),C(2)):(r("Invalid company code","error"),o(""))}catch{r("Error checking code","error")}finally{y(!1)}},M=async()=>{if(!H.trim()){r("Enter office code","error");return}y(!0);try{const{data:D,error:B}=await Pe.rpc("verify_office_code",{company_id:j.id,code:H.trim()});if(B)throw B;D===!0?C(3):(r("Invalid office code","error"),Y(""))}catch{r("Error verifying code","error")}finally{y(!1)}},A=async()=>{if(!U.trim()){r("Enter your name","error");return}if(!F.trim()||!F.includes("@")){r("Enter valid email","error");return}if(P.length<6){r("Password must be 6+ characters","error");return}y(!0);try{const{data:D,error:B}=await Pe.auth.signUp({email:F,password:P});if(B)throw B;const q=D.user?.id;if(!q)throw new Error("Failed to create user");const{error:Z}=await Pe.from("users").insert({id:q,email:F,password_hash:"managed_by_supabase_auth",name:U.trim(),company_id:j.id,role:"member",is_active:!0});if(Z)throw Z;const{error:oe}=await Pe.from("user_companies").insert({user_id:q,company_id:j.id,role:"member"});oe&&console.error("Error adding to user_companies:",oe),r("Account created! Logging you in...","success"),setTimeout(()=>{window.location.reload()},1e3)}catch(D){console.error("Join error:",D),r(D.message||"Error creating account","error")}finally{y(!1)}};if(a===null)return l.jsx("div",{className:"entry-container",children:l.jsxs("div",{className:"entry-card",children:[l.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),l.jsxs("div",{className:"entry-buttons",children:[l.jsxs("button",{className:"entry-mode-btn foreman",onClick:()=>n("foreman"),children:[l.jsx("span",{className:"entry-mode-icon",children:l.jsx(Ui,{size:32})}),l.jsx("span",{className:"entry-mode-title",children:"Foreman"}),l.jsx("span",{className:"entry-mode-desc",children:"Enter project PIN"})]}),l.jsxs("button",{className:"entry-mode-btn office",onClick:()=>n("office"),children:[l.jsx("span",{className:"entry-mode-icon",children:l.jsx(S0,{size:32})}),l.jsx("span",{className:"entry-mode-title",children:"Office"}),l.jsx("span",{className:"entry-mode-desc",children:"Sign in to dashboard"})]})]})]})});if(a==="foreman")return u?l.jsx("div",{className:"entry-container",children:l.jsxs("div",{className:"entry-card",children:[l.jsx("button",{className:"entry-back",onClick:ee,children:""}),l.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),l.jsx("div",{className:"entry-company-badge",children:u.name}),l.jsx("p",{className:"entry-subtitle",children:"Enter project PIN"}),l.jsx("div",{className:"pin-display",children:[0,1,2,3].map(D=>l.jsx("div",{className:`pin-dot ${h.length>D?"filled":""}`,children:h.length>D?"":""},D))}),l.jsxs("div",{className:"number-pad",children:[[1,2,3,4,5,6,7,8,9].map(D=>l.jsx("button",{className:"num-btn",onClick:()=>Q(D.toString()),disabled:v,children:D},D)),l.jsx("button",{className:"num-btn empty",disabled:!0}),l.jsx("button",{className:"num-btn",onClick:()=>Q("0"),disabled:v,children:"0"}),l.jsx("button",{className:"num-btn backspace",onClick:le,disabled:v||h.length===0,children:""})]}),v&&l.jsx("div",{className:"entry-loading",children:l.jsx("div",{className:"spinner"})})]})}):l.jsx("div",{className:"entry-container",children:l.jsxs("div",{className:"entry-card",children:[l.jsx("button",{className:"entry-back",onClick:()=>n(null),children:""}),l.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),l.jsx("p",{className:"entry-subtitle",children:"Enter company code"}),l.jsxs("div",{className:"entry-input-group",children:[l.jsx("input",{type:"text",value:s,onChange:D=>I(D.target.value),placeholder:"Company Code",disabled:v,autoFocus:!0,onKeyDown:D=>{D.key==="Enter"&&W()}}),l.jsx("button",{className:"entry-submit-btn",onClick:W,disabled:v||s.length<2,children:v?"...":""})]})]})});if(a==="office")return l.jsx("div",{className:"entry-container",children:l.jsxs("div",{className:"entry-card",children:[l.jsx("button",{className:"entry-back",onClick:()=>n(null),children:""}),l.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),l.jsx("p",{className:"entry-subtitle",children:"Sign in to your account"}),l.jsxs("div",{className:"entry-form",children:[l.jsx("input",{type:"email",value:g,onChange:D=>b(D.target.value),placeholder:"Email",autoFocus:!0,onKeyDown:D=>{D.key==="Enter"&&K()}}),l.jsx("input",{type:"password",value:_,onChange:D=>S(D.target.value),placeholder:"Password",onKeyDown:D=>{D.key==="Enter"&&K()}}),l.jsx("button",{className:"entry-login-btn",onClick:K,children:"Sign In"})]}),l.jsxs("div",{className:"entry-signup-hint",children:[l.jsx("p",{children:"New employee?"}),l.jsx("button",{className:"entry-join-link",onClick:()=>n("join"),children:"Join your company"})]})]})});if(a==="join")return E===1?l.jsx("div",{className:"entry-container",children:l.jsxs("div",{className:"entry-card",children:[l.jsx("button",{className:"entry-back",onClick:()=>n("office"),children:""}),l.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),l.jsx("p",{className:"entry-subtitle",children:"Enter your company code"}),l.jsx("p",{className:"entry-hint",children:"Ask your manager or admin for the code"}),l.jsxs("div",{className:"entry-input-group",children:[l.jsx("input",{type:"text",value:s,onChange:D=>I(D.target.value),placeholder:"Company Code",disabled:v,autoFocus:!0,onKeyDown:D=>{D.key==="Enter"&&ue()}}),l.jsx("button",{className:"entry-submit-btn",onClick:ue,disabled:v||s.length<2,children:v?"...":""})]})]})}):E===2?l.jsx("div",{className:"entry-container",children:l.jsxs("div",{className:"entry-card",children:[l.jsx("button",{className:"entry-back",onClick:()=>{C(1),R(null),Y("")},children:""}),l.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),l.jsx("div",{className:"entry-company-badge",children:j?.name}),l.jsx("p",{className:"entry-subtitle",children:"Enter office code"}),l.jsx("p",{className:"entry-hint",children:"This code is only for office staff"}),l.jsxs("div",{className:"entry-input-group",children:[l.jsx("input",{type:"password",value:H,onChange:D=>Y(D.target.value),placeholder:"Office Code",disabled:v,autoFocus:!0,onKeyDown:D=>{D.key==="Enter"&&M()}}),l.jsx("button",{className:"entry-submit-btn",onClick:M,disabled:v||!H.trim(),children:v?"...":""})]})]})}):l.jsx("div",{className:"entry-container",children:l.jsxs("div",{className:"entry-card",children:[l.jsx("button",{className:"entry-back",onClick:()=>{C(2),Y("")},children:""}),l.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),l.jsx("div",{className:"entry-company-badge",children:j?.name}),l.jsx("p",{className:"entry-subtitle",children:"Create your account"}),l.jsxs("div",{className:"entry-form",children:[l.jsx("input",{type:"text",value:U,onChange:D=>V(D.target.value),placeholder:"Your Name",autoFocus:!0}),l.jsx("input",{type:"email",value:F,onChange:D=>X(D.target.value),placeholder:"Email"}),l.jsx("input",{type:"password",value:P,onChange:D=>O(D.target.value),placeholder:"Password (6+ characters)",onKeyDown:D=>{D.key==="Enter"&&A()}}),l.jsx("button",{className:"entry-login-btn",onClick:A,disabled:v,children:v?"Creating...":"Join Company"})]}),l.jsx("p",{className:"entry-join-note",children:"You'll join as a team member. Your admin can update your role."})]})})}function Yn(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}function l2(t){if(!t||t.length===0)return 0;let e=0;return t.forEach(r=>{r.status==="done"&&(e+=r.weight)}),Math.round(e)}function H4(t){if(!t||t.length===0)return"not_started";const e=t.some(n=>n.status==="working"),r=t.some(n=>n.status==="done");return t.every(n=>n.status==="done")?"done":e||r?"working":"not_started"}function OT(t){const e=H4(t);return e==="done"?"Complete":e==="working"?"In Progress":"Not Started"}const Yb=["Containment","PPE","Disposal","Equipment"];function RT({project:t,companyId:e,maxPhotos:r=10,onSubmit:a,onCancel:n,onShowToast:s}){const[o,u]=se.useState(1),[f,h]=se.useState(new Date().toISOString().split("T")[0]),[m,v]=se.useState(""),[y,g]=se.useState(""),[b,_]=se.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}]),[S,E]=se.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}]),[C,j]=se.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}]),[R,H]=se.useState([]),[Y,U]=se.useState(""),[V,F]=se.useState([]),[X,P]=se.useState(!1),[O,I]=se.useState(""),[W,ne]=se.useState([]),[Q,le]=se.useState(!1),[ee,K]=se.useState(null),[ue,M]=se.useState([]),[A,D]=se.useState(!1),[B,q]=se.useState(!1),[Z,oe]=se.useState({name:"",category:"",quantity:""});se.useEffect(()=>{pe()},[t.id]);const pe=async()=>{try{const we=await ut.getCrewCheckin(t.id);we?.workers&&ne(we.workers)}catch(we){console.error("Error loading crew:",we)}};se.useEffect(()=>{ee&&e&&_e(ee)},[ee,e]);const _e=async we=>{D(!0);try{const Ie=await ut.getMaterialsEquipmentByCategory(e,we);M(Ie)}catch(Ie){console.error("Error loading items:",Ie),s("Error loading items","error")}finally{D(!1)}},be=()=>{_([...b,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}])},Le=(we,Ie,ve)=>{_(b.map((Ue,Be)=>Be===we?{...Ue,[Ie]:ve}:Ue))},he=we=>{b.length>1?_(b.filter((Ie,ve)=>ve!==we)):_([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}])},Ae=()=>{j([...C,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},de=(we,Ie,ve)=>{j(C.map((Ue,Be)=>Be===we?{...Ue,[Ie]:ve}:Ue))},re=we=>{C.length>1?j(C.filter((Ie,ve)=>ve!==we)):j([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},Ke=()=>{E([...S,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},Oe=(we,Ie,ve)=>{E(S.map((Ue,Be)=>Be===we?{...Ue,[Ie]:ve}:Ue))},rt=we=>{S.length>1?E(S.filter((Ie,ve)=>ve!==we)):E([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},tt=we=>{const Ie=R.findIndex(ve=>ve.material_equipment_id===we.id);Ie>=0?H(R.map((ve,Ue)=>Ue===Ie?{...ve,quantity:ve.quantity+1}:ve)):H([...R,{material_equipment_id:we.id,name:we.name,unit:we.unit,category:we.category,quantity:1,isCustom:!1}]),s(`Added ${we.name}`,"success")},Et=()=>{if(!Z.name||!Z.category||!Z.quantity){s("Fill in all fields","error");return}H([...R,{material_equipment_id:null,custom_name:Z.name,custom_category:Z.category,name:Z.name,category:Z.category,quantity:parseFloat(Z.quantity),unit:"each",isCustom:!0}]),oe({name:"",category:"",quantity:""}),q(!1),K(null),s("Custom item added","success")},kt=(we,Ie)=>{const ve=parseFloat(Ie)||0;ve<=0?zt(we):H(R.map((Ue,Be)=>Be===we?{...Ue,quantity:ve}:Ue))},zt=we=>{H(R.filter((Ie,ve)=>ve!==we))},Tt=we=>{const Ie=Array.from(we.target.files);if(Ie.length===0)return;const ve=r===-1?1/0:r-V.length;if(ve<=0){s(`Photo limit reached (${r} max)`,"error"),we.target.value="";return}const Ue=Ie.slice(0,ve);Ue.length<Ie.length&&s(`Only ${Ue.length} photo(s) added (${r} max)`,"error"),Ue.forEach(Be=>{if(!Be.type.startsWith("image/")){s("Please select an image file","error");return}const Rt=URL.createObjectURL(Be);F(Ht=>[...Ht,{id:Date.now()+Math.random(),file:Be,previewUrl:Rt,name:Be.name}])}),we.target.value=""},at=we=>{const Ie=V.find(ve=>ve.id===we);Ie?.previewUrl&&URL.revokeObjectURL(Ie.previewUrl),F(V.filter(ve=>ve.id!==we))},pt=()=>{if(o===1){const we=b.some(Ue=>Ue.name.trim()&&(parseFloat(Ue.hours)>0||parseFloat(Ue.overtimeHours)>0)),Ie=S.some(Ue=>Ue.name.trim()&&(parseFloat(Ue.hours)>0||parseFloat(Ue.overtimeHours)>0)),ve=C.some(Ue=>Ue.name.trim()&&(parseFloat(Ue.hours)>0||parseFloat(Ue.overtimeHours)>0));return we||Ie||ve}return!0},At=()=>{o<3&&u(o+1)},Dt=()=>{ee?(K(null),q(!1)):B?q(!1):o>1?u(o-1):n()},xt=async()=>{if(!y.trim()){s("Enter your name to submit","error");return}const we=b.filter(Ue=>Ue.name.trim()&&(parseFloat(Ue.hours)>0||parseFloat(Ue.overtimeHours)>0)),Ie=S.filter(Ue=>Ue.name.trim()&&(parseFloat(Ue.hours)>0||parseFloat(Ue.overtimeHours)>0)),ve=C.filter(Ue=>Ue.name.trim()&&(parseFloat(Ue.hours)>0||parseFloat(Ue.overtimeHours)>0));if(we.length===0&&Ie.length===0&&ve.length===0){s("Add at least one worker","error");return}P(!0),I("Creating ticket...");try{const Ue=await ut.createTMTicket({project_id:t.id,work_date:f,ce_pco_number:m.trim()||null,notes:Y.trim()||null,photos:[],created_by_name:y.trim()});let Be=[];if(V.length>0){I(`Uploading ${V.length} photo${V.length>1?"s":""}...`);const Ht=V.map($t=>ut.uploadPhoto(e,t.id,Ue.id,$t.file).catch(Nr=>(console.error("Error uploading photo:",Nr),null)));Be=(await Promise.all(Ht)).filter($t=>$t!==null)}Be.length>0&&(I("Saving photos..."),await ut.updateTMTicketPhotos(Ue.id,Be));const Rt=[...we.map(Ht=>({name:Ht.name.trim(),hours:parseFloat(Ht.hours)||0,overtime_hours:parseFloat(Ht.overtimeHours)||0,time_started:Ht.timeStarted||null,time_ended:Ht.timeEnded||null,role:Ht.role})),...Ie.map(Ht=>({name:Ht.name.trim(),hours:parseFloat(Ht.hours)||0,overtime_hours:parseFloat(Ht.overtimeHours)||0,time_started:Ht.timeStarted||null,time_ended:Ht.timeEnded||null,role:"Operator"})),...ve.map(Ht=>({name:Ht.name.trim(),hours:parseFloat(Ht.hours)||0,overtime_hours:parseFloat(Ht.overtimeHours)||0,time_started:Ht.timeStarted||null,time_ended:Ht.timeEnded||null,role:"Laborer"}))];I("Saving workers..."),await ut.addTMWorkers(Ue.id,Rt),R.length>0&&(I("Saving materials..."),await ut.addTMItems(Ue.id,R.map(Ht=>({material_equipment_id:Ht.material_equipment_id,custom_name:Ht.custom_name||null,custom_category:Ht.custom_category||null,quantity:Ht.quantity})))),V.forEach(Ht=>{Ht.previewUrl&&URL.revokeObjectURL(Ht.previewUrl)}),s("T&M submitted!","success"),a()}catch(Ue){console.error("Error submitting T&M:",Ue),s("Error submitting T&M","error")}finally{P(!1),I("")}},St=b.filter(we=>we.name.trim()&&(parseFloat(we.hours)>0||parseFloat(we.overtimeHours)>0)),ft=S.filter(we=>we.name.trim()&&(parseFloat(we.hours)>0||parseFloat(we.overtimeHours)>0)),yt=C.filter(we=>we.name.trim()&&(parseFloat(we.hours)>0||parseFloat(we.overtimeHours)>0)),er=St.length+ft.length+yt.length,Lt=[...St,...ft,...yt].reduce((we,Ie)=>we+parseFloat(Ie.hours||0),0),Bt=[...St,...ft,...yt].reduce((we,Ie)=>we+parseFloat(Ie.overtimeHours||0),0);return R.reduce((we,Ie)=>we+Ie.quantity,0),o===2&&(ee||B)?l.jsxs("div",{className:"tm-wizard",children:[l.jsxs("div",{className:"tm-wizard-header",children:[l.jsx("button",{className:"tm-back-btn",onClick:Dt,children:""}),l.jsx("h2",{children:B?"Add Custom Item":ee}),l.jsxs("div",{className:"tm-item-count",children:[R.length," items"]})]}),B?l.jsxs("div",{className:"tm-custom-form",children:[l.jsxs("div",{className:"tm-field",children:[l.jsx("label",{children:"Item Name"}),l.jsx("input",{type:"text",placeholder:"What did you use?",value:Z.name,onChange:we=>oe({...Z,name:we.target.value}),autoFocus:!0})]}),l.jsxs("div",{className:"tm-field",children:[l.jsx("label",{children:"Category"}),l.jsx("div",{className:"tm-category-select",children:Yb.map(we=>l.jsx("button",{className:`tm-cat-chip ${Z.category===we?"active":""}`,onClick:()=>oe({...Z,category:we}),children:we},we))})]}),l.jsxs("div",{className:"tm-field",children:[l.jsx("label",{children:"Quantity"}),l.jsx("input",{type:"number",placeholder:"How many?",value:Z.quantity,onChange:we=>oe({...Z,quantity:we.target.value})})]}),l.jsx("button",{className:"tm-big-btn primary",onClick:Et,children:"Add Custom Item"})]}):l.jsx("div",{className:"tm-item-grid",children:A?l.jsx("div",{className:"tm-loading",children:"Loading..."}):l.jsxs(l.Fragment,{children:[ue.map(we=>{const Ie=R.find(ve=>ve.material_equipment_id===we.id);return l.jsxs("button",{className:`tm-item-card ${Ie?"added":""}`,onClick:()=>tt(we),children:[l.jsx("span",{className:"tm-item-name",children:we.name}),l.jsx("span",{className:"tm-item-unit",children:we.unit}),Ie&&l.jsx("span",{className:"tm-item-badge",children:Ie.quantity})]},we.id)}),l.jsxs("button",{className:"tm-item-card custom",onClick:()=>q(!0),children:[l.jsx("span",{className:"tm-item-name",children:"+ Add Other"}),l.jsx("span",{className:"tm-item-unit",children:"Not on list"})]})]})}),!B&&R.length>0&&l.jsx("div",{className:"tm-wizard-footer",children:l.jsxs("button",{className:"tm-big-btn primary",onClick:()=>K(null),children:["Done Adding (",R.length," items)"]})})]}):l.jsxs("div",{className:"tm-wizard",children:[l.jsxs("div",{className:"tm-wizard-header",children:[l.jsx("button",{className:"tm-back-btn",onClick:Dt,children:""}),l.jsxs("h2",{children:[o===1&&"Workers",o===2&&"Materials & Equipment",o===3&&"Review"]}),l.jsxs("div",{className:"tm-step-dots",children:[l.jsx("span",{className:`tm-dot ${o>=1?"active":""}`}),l.jsx("span",{className:`tm-dot ${o>=2?"active":""}`}),l.jsx("span",{className:`tm-dot ${o>=3?"active":""}`})]})]}),o===1&&l.jsxs("div",{className:"tm-step-content",children:[l.jsxs("div",{className:"tm-project-info",children:[t.job_number&&l.jsxs("div",{className:"tm-project-detail",children:[l.jsx("span",{className:"tm-project-label",children:"Job #"}),l.jsx("span",{className:"tm-project-value",children:t.job_number})]}),l.jsxs("div",{className:"tm-project-detail",children:[l.jsx("span",{className:"tm-project-label",children:"Project"}),l.jsx("span",{className:"tm-project-value",children:t.name})]}),t.address&&l.jsxs("div",{className:"tm-project-detail",children:[l.jsx("span",{className:"tm-project-label",children:"Address"}),l.jsx("span",{className:"tm-project-value",children:t.address})]}),t.general_contractor&&l.jsxs("div",{className:"tm-project-detail",children:[l.jsx("span",{className:"tm-project-label",children:"GC"}),l.jsx("span",{className:"tm-project-value",children:t.general_contractor})]})]}),l.jsxs("div",{className:"tm-field-row",children:[l.jsxs("div",{className:"tm-field tm-field-half",children:[l.jsx("label",{children:"Date"}),l.jsx("input",{type:"date",value:f,onChange:we=>h(we.target.value),className:"tm-date"})]}),l.jsxs("div",{className:"tm-field tm-field-half",children:[l.jsx("label",{children:"CE / PCO #"}),l.jsx("input",{type:"text",placeholder:"Change Event / PCO",value:m,onChange:we=>v(we.target.value),className:"tm-input"})]})]}),W.length>0&&l.jsxs("div",{className:"tm-crew-picker",children:[l.jsxs("button",{className:"tm-crew-picker-btn",onClick:()=>le(!Q),children:[l.jsx(Ui,{size:16})," ",Q?"Hide":"Select from"," Today's Crew (",W.length,")"]}),Q&&l.jsx("div",{className:"tm-crew-list",children:W.map((we,Ie)=>{const ve=b.some(Ue=>Ue.name.toLowerCase()===we.name.toLowerCase())||S.some(Ue=>Ue.name.toLowerCase()===we.name.toLowerCase())||C.some(Ue=>Ue.name.toLowerCase()===we.name.toLowerCase());return l.jsxs("button",{className:`tm-crew-item ${ve?"added":""}`,onClick:()=>{if(!ve){if(we.role==="Foreman"||we.role==="Supervisor"){const Ue=b.findIndex(Be=>!Be.name.trim());Ue>=0?Le(Ue,"name",we.name):_([...b,{name:we.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:we.role==="Supervisor"?"Superintendent":"Foreman"}])}else if(we.role==="Operator"){const Ue=S.findIndex(Be=>!Be.name.trim());Ue>=0?Oe(Ue,"name",we.name):E([...S,{name:we.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])}else{const Ue=C.findIndex(Be=>!Be.name.trim());Ue>=0?de(Ue,"name",we.name):j([...C,{name:we.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])}s(`Added ${we.name}`,"success")}},disabled:ve,children:[l.jsx("span",{className:"tm-crew-item-name",children:we.name}),l.jsx("span",{className:`tm-crew-item-role ${(we.role||"laborer").toLowerCase()}`,children:we.role||"Laborer"}),ve&&l.jsx("span",{className:"tm-crew-item-check",children:""})]},Ie)})})]}),l.jsxs("div",{className:"tm-field",children:[l.jsx("label",{children:"Supervision"}),l.jsx("div",{className:"tm-workers-list",children:b.map((we,Ie)=>l.jsxs("div",{className:"tm-worker-card-expanded",children:[l.jsxs("div",{className:"tm-worker-row-top",children:[l.jsx("div",{className:"tm-role-select",children:l.jsxs("select",{value:we.role,onChange:ve=>Le(Ie,"role",ve.target.value),children:[l.jsx("option",{value:"Foreman",children:"Foreman"}),l.jsx("option",{value:"Superintendent",children:"Superintendent"})]})}),l.jsx("input",{type:"text",placeholder:"First & Last Name",value:we.name,onChange:ve=>Le(Ie,"name",ve.target.value),className:"tm-worker-input"}),l.jsx("button",{className:"tm-remove",onClick:()=>he(Ie),children:""})]}),l.jsxs("div",{className:"tm-worker-row-bottom",children:[l.jsxs("div",{className:"tm-time-group",children:[l.jsx("label",{children:"Start"}),l.jsx("input",{type:"time",value:we.timeStarted,onChange:ve=>Le(Ie,"timeStarted",ve.target.value)})]}),l.jsxs("div",{className:"tm-time-group",children:[l.jsx("label",{children:"End"}),l.jsx("input",{type:"time",value:we.timeEnded,onChange:ve=>Le(Ie,"timeEnded",ve.target.value)})]}),l.jsxs("div",{className:"tm-time-group",children:[l.jsx("label",{children:"Reg Hrs"}),l.jsx("input",{type:"number",placeholder:"0",value:we.hours,onChange:ve=>Le(Ie,"hours",ve.target.value)})]}),l.jsxs("div",{className:"tm-time-group",children:[l.jsx("label",{children:"OT Hrs"}),l.jsx("input",{type:"number",placeholder:"0",value:we.overtimeHours,onChange:ve=>Le(Ie,"overtimeHours",ve.target.value)})]})]})]},Ie))}),l.jsx("button",{className:"tm-add-btn",onClick:be,children:"+ Add Supervision"})]}),l.jsxs("div",{className:"tm-field",children:[l.jsx("label",{children:"Operators"}),l.jsx("div",{className:"tm-workers-list",children:S.map((we,Ie)=>l.jsxs("div",{className:"tm-worker-card-expanded",children:[l.jsxs("div",{className:"tm-worker-row-top",children:[l.jsx("input",{type:"text",placeholder:"First & Last Name",value:we.name,onChange:ve=>Oe(Ie,"name",ve.target.value),className:"tm-worker-input"}),l.jsx("button",{className:"tm-remove",onClick:()=>rt(Ie),children:""})]}),l.jsxs("div",{className:"tm-worker-row-bottom",children:[l.jsxs("div",{className:"tm-time-group",children:[l.jsx("label",{children:"Start"}),l.jsx("input",{type:"time",value:we.timeStarted,onChange:ve=>Oe(Ie,"timeStarted",ve.target.value)})]}),l.jsxs("div",{className:"tm-time-group",children:[l.jsx("label",{children:"End"}),l.jsx("input",{type:"time",value:we.timeEnded,onChange:ve=>Oe(Ie,"timeEnded",ve.target.value)})]}),l.jsxs("div",{className:"tm-time-group",children:[l.jsx("label",{children:"Reg Hrs"}),l.jsx("input",{type:"number",placeholder:"0",value:we.hours,onChange:ve=>Oe(Ie,"hours",ve.target.value)})]}),l.jsxs("div",{className:"tm-time-group",children:[l.jsx("label",{children:"OT Hrs"}),l.jsx("input",{type:"number",placeholder:"0",value:we.overtimeHours,onChange:ve=>Oe(Ie,"overtimeHours",ve.target.value)})]})]})]},Ie))}),l.jsx("button",{className:"tm-add-btn",onClick:Ke,children:"+ Add Operator"})]}),l.jsxs("div",{className:"tm-field",children:[l.jsx("label",{children:"Laborers"}),l.jsx("div",{className:"tm-workers-list",children:C.map((we,Ie)=>l.jsxs("div",{className:"tm-worker-card-expanded",children:[l.jsxs("div",{className:"tm-worker-row-top",children:[l.jsx("input",{type:"text",placeholder:"First & Last Name",value:we.name,onChange:ve=>de(Ie,"name",ve.target.value),className:"tm-worker-input"}),l.jsx("button",{className:"tm-remove",onClick:()=>re(Ie),children:""})]}),l.jsxs("div",{className:"tm-worker-row-bottom",children:[l.jsxs("div",{className:"tm-time-group",children:[l.jsx("label",{children:"Start"}),l.jsx("input",{type:"time",value:we.timeStarted,onChange:ve=>de(Ie,"timeStarted",ve.target.value)})]}),l.jsxs("div",{className:"tm-time-group",children:[l.jsx("label",{children:"End"}),l.jsx("input",{type:"time",value:we.timeEnded,onChange:ve=>de(Ie,"timeEnded",ve.target.value)})]}),l.jsxs("div",{className:"tm-time-group",children:[l.jsx("label",{children:"Reg Hrs"}),l.jsx("input",{type:"number",placeholder:"0",value:we.hours,onChange:ve=>de(Ie,"hours",ve.target.value)})]}),l.jsxs("div",{className:"tm-time-group",children:[l.jsx("label",{children:"OT Hrs"}),l.jsx("input",{type:"number",placeholder:"0",value:we.overtimeHours,onChange:ve=>de(Ie,"overtimeHours",ve.target.value)})]})]})]},Ie))}),l.jsx("button",{className:"tm-add-btn",onClick:Ae,children:"+ Add Laborer"})]}),l.jsxs("div",{className:"tm-field",children:[l.jsx("label",{children:"Description of Work"}),l.jsx("textarea",{placeholder:"What work was performed today?",value:Y,onChange:we=>U(we.target.value),rows:3,className:"tm-description"})]}),l.jsxs("div",{className:"tm-field",children:[l.jsxs("label",{children:[l.jsx(jp,{size:16,className:"inline-icon"})," Photos",r!==-1&&l.jsxs("span",{className:"tm-photo-count",children:["(",V.length,"/",r,")"]})]}),V.length>0&&l.jsx("div",{className:"tm-photo-grid",children:V.map(we=>l.jsxs("div",{className:"tm-photo-item",children:[l.jsx("img",{src:we.previewUrl,alt:we.name}),l.jsx("button",{className:"tm-photo-remove",onClick:()=>at(we.id),children:""})]},we.id))}),(r===-1||V.length<r)&&l.jsxs("label",{className:"tm-photo-btn",children:[l.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:Tt,style:{display:"none"}}),l.jsx(jp,{size:16,className:"inline-icon"})," ",V.length>0?"Add More Photos":"Add Photos"]}),r!==-1&&V.length>=r&&l.jsxs("div",{className:"tm-photo-limit-reached",children:["Photo limit reached (",r," max)"]})]})]}),o===2&&!ee&&l.jsxs("div",{className:"tm-step-content",children:[l.jsxs("div",{className:"tm-field",children:[l.jsx("label",{children:"What was used?"}),l.jsx("div",{className:"tm-category-grid",children:Yb.map(we=>{const Ie=R.filter(ve=>ve.category===we);return l.jsxs("button",{className:"tm-category-card",onClick:()=>K(we),children:[l.jsx("span",{className:"tm-cat-name",children:we}),Ie.length>0&&l.jsx("span",{className:"tm-cat-count",children:Ie.length})]},we)})})]}),R.length>0&&l.jsxs("div",{className:"tm-field",children:[l.jsxs("label",{children:["Added Items (",R.length,")"]}),l.jsx("div",{className:"tm-added-list",children:R.map((we,Ie)=>l.jsxs("div",{className:"tm-added-item",children:[l.jsxs("div",{className:"tm-added-info",children:[we.isCustom&&l.jsx("span",{className:"tm-custom-badge",children:"Custom"}),l.jsx("span",{className:"tm-added-name",children:we.name})]}),l.jsxs("div",{className:"tm-added-qty",children:[l.jsx("button",{onClick:()=>kt(Ie,we.quantity-1),children:""}),l.jsx("span",{children:we.quantity}),l.jsx("button",{onClick:()=>kt(Ie,we.quantity+1),children:"+"})]})]},Ie))})]})]}),o===3&&l.jsxs("div",{className:"tm-step-content",children:[l.jsx("div",{className:"tm-review-section",children:l.jsxs("div",{className:"tm-review-header",children:[l.jsx("span",{children:" Date"}),l.jsx("span",{children:new Date(f).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})]})}),Y&&l.jsxs("div",{className:"tm-review-section",children:[l.jsx("div",{className:"tm-review-header",children:l.jsxs("span",{children:[l.jsx(hc,{size:16,className:"inline-icon"})," Description"]})}),l.jsx("div",{className:"tm-review-notes",children:Y})]}),V.length>0&&l.jsxs("div",{className:"tm-review-section",children:[l.jsxs("div",{className:"tm-review-header",children:[l.jsxs("span",{children:[l.jsx(jp,{size:16,className:"inline-icon"})," Photos"]}),l.jsx("span",{children:V.length})]}),l.jsx("div",{className:"tm-review-photos",children:V.map(we=>l.jsx("img",{src:we.previewUrl,alt:we.name},we.id))})]}),St.length>0&&l.jsxs("div",{className:"tm-review-section",children:[l.jsxs("div",{className:"tm-review-header",children:[l.jsxs("span",{children:[l.jsx(NT,{size:16,className:"inline-icon"})," Supervision"]}),l.jsxs("span",{children:[St.reduce((we,Ie)=>we+parseFloat(Ie.hours||0)+parseFloat(Ie.overtimeHours||0),0)," hrs"]})]}),l.jsx("div",{className:"tm-review-list",children:St.map((we,Ie)=>l.jsxs("div",{className:"tm-review-row-detailed",children:[l.jsxs("div",{className:"tm-review-worker-name",children:[l.jsx("span",{className:"tm-role-badge",children:we.role})," ",we.name]}),l.jsxs("div",{className:"tm-review-worker-details",children:[we.timeStarted&&we.timeEnded&&l.jsxs("span",{className:"tm-review-time",children:[we.timeStarted," - ",we.timeEnded]}),l.jsxs("span",{className:"tm-review-hours",children:[we.hours||0," reg",parseFloat(we.overtimeHours)>0?` + ${we.overtimeHours} OT`:""]})]})]},Ie))})]}),ft.length>0&&l.jsxs("div",{className:"tm-review-section",children:[l.jsxs("div",{className:"tm-review-header",children:[l.jsx("span",{children:" Operators"}),l.jsxs("span",{children:[ft.reduce((we,Ie)=>we+parseFloat(Ie.hours||0)+parseFloat(Ie.overtimeHours||0),0)," hrs"]})]}),l.jsx("div",{className:"tm-review-list",children:ft.map((we,Ie)=>l.jsxs("div",{className:"tm-review-row-detailed",children:[l.jsx("div",{className:"tm-review-worker-name",children:we.name}),l.jsxs("div",{className:"tm-review-worker-details",children:[we.timeStarted&&we.timeEnded&&l.jsxs("span",{className:"tm-review-time",children:[we.timeStarted," - ",we.timeEnded]}),l.jsxs("span",{className:"tm-review-hours",children:[we.hours||0," reg",parseFloat(we.overtimeHours)>0?` + ${we.overtimeHours} OT`:""]})]})]},Ie))})]}),yt.length>0&&l.jsxs("div",{className:"tm-review-section",children:[l.jsxs("div",{className:"tm-review-header",children:[l.jsxs("span",{children:[l.jsx(Ui,{size:16,className:"inline-icon"})," Laborers"]}),l.jsxs("span",{children:[yt.reduce((we,Ie)=>we+parseFloat(Ie.hours||0)+parseFloat(Ie.overtimeHours||0),0)," hrs"]})]}),l.jsx("div",{className:"tm-review-list",children:yt.map((we,Ie)=>l.jsxs("div",{className:"tm-review-row-detailed",children:[l.jsx("div",{className:"tm-review-worker-name",children:we.name}),l.jsxs("div",{className:"tm-review-worker-details",children:[we.timeStarted&&we.timeEnded&&l.jsxs("span",{className:"tm-review-time",children:[we.timeStarted," - ",we.timeEnded]}),l.jsxs("span",{className:"tm-review-hours",children:[we.hours||0," reg",parseFloat(we.overtimeHours)>0?` + ${we.overtimeHours} OT`:""]})]})]},Ie))})]}),R.length>0&&l.jsxs("div",{className:"tm-review-section",children:[l.jsxs("div",{className:"tm-review-header",children:[l.jsxs("span",{children:[l.jsx(Y2,{size:16,className:"inline-icon"})," Materials & Equipment"]}),l.jsxs("span",{children:[R.length," items"]})]}),l.jsx("div",{className:"tm-review-list",children:R.map((we,Ie)=>l.jsxs("div",{className:"tm-review-row",children:[l.jsxs("span",{children:[we.isCustom&&l.jsxs(l.Fragment,{children:[l.jsx(CT,{size:14,className:"inline-icon"})," "]}),we.name]}),l.jsxs("span",{children:[we.quantity," ",we.unit]})]},Ie))})]}),l.jsxs("div",{className:"tm-review-section tm-certification",children:[l.jsx("div",{className:"tm-review-header",children:l.jsxs("span",{children:[l.jsx(G2,{size:16,className:"inline-icon"})," Submitted By"]})}),l.jsx("input",{type:"text",className:"tm-certification-input",placeholder:"Enter your name",value:y,onChange:we=>g(we.target.value)}),l.jsx("p",{className:"tm-certification-note",children:"By submitting, you certify this T&M is accurate."})]})]}),l.jsxs("div",{className:"tm-wizard-footer",children:[o<3?l.jsx("button",{className:"tm-big-btn primary",onClick:At,disabled:o===1&&!pt(),children:o===1?`Next: Materials (${er} workers, ${Lt+Bt} hrs)`:o===2?`Review (${R.length} items)`:"Next"}):l.jsx("button",{className:"tm-big-btn submit",onClick:xt,disabled:X,children:X?O||"Submitting...":" Submit T&M"}),o===2&&l.jsx("button",{className:"tm-skip-btn",onClick:At,children:"Skip (no materials)"})]})]})}function DT({project:t,onShowToast:e}){const[r,a]=se.useState([]),[n,s]=se.useState(!0),[o,u]=se.useState(!1),[f,h]=se.useState(!1),[m,v]=se.useState({name:"",role:"Laborer"});se.useEffect(()=>{y()},[t.id]);const y=async()=>{try{const S=await ut.getCrewCheckin(t.id);S?.workers&&a(S.workers)}catch(S){console.error("Error loading crew:",S)}finally{s(!1)}},g=async()=>{if(!m.name.trim()){e("Enter worker name","error");return}if(r.find(S=>S.name.toLowerCase()===m.name.trim().toLowerCase())){e("Worker already added","error");return}u(!0);try{const S=[...r,{name:m.name.trim(),role:m.role}];await ut.saveCrewCheckin(t.id,S),a(S),v({name:"",role:"Laborer"}),h(!1),e("Crew member added","success")}catch(S){console.error("Error adding worker:",S),e("Error adding crew member","error")}finally{u(!1)}},b=async S=>{u(!0);try{const E=r.filter(C=>C.name.toLowerCase()!==S.toLowerCase());await ut.saveCrewCheckin(t.id,E),a(E),e("Crew member removed","success")}catch(E){console.error("Error removing worker:",E),e("Error removing crew member","error")}finally{u(!1)}},_=new Date().toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"});return n?l.jsxs("div",{className:"crew-checkin",children:[l.jsxs("div",{className:"crew-header",children:[l.jsxs("h3",{children:[l.jsx(Ui,{size:18,className:"inline-icon"})," Today's Crew"]}),l.jsx("span",{className:"crew-date",children:_})]}),l.jsx("div",{className:"crew-loading",children:"Loading..."})]}):l.jsxs("div",{className:"crew-checkin",children:[l.jsxs("div",{className:"crew-header",children:[l.jsxs("h3",{children:[l.jsx(Ui,{size:18,className:"inline-icon"})," Today's Crew"]}),l.jsx("span",{className:"crew-date",children:_})]}),r.length===0?l.jsxs("div",{className:"crew-empty",children:[l.jsx("p",{children:"No crew checked in yet"}),l.jsx("p",{className:"crew-empty-hint",children:"Add your crew for the day"})]}):l.jsx("div",{className:"crew-list",children:r.map(S=>l.jsxs("div",{className:"crew-member",children:[l.jsxs("div",{className:"crew-member-info",children:[l.jsx("span",{className:"crew-member-name",children:S.name}),l.jsx("span",{className:`crew-member-role ${S.role.toLowerCase()}`,children:S.role})]}),l.jsx("button",{className:"crew-remove-btn",onClick:()=>b(S.name),disabled:o,children:""})]},S.name))}),f?l.jsxs("div",{className:"crew-add-form",children:[l.jsx("input",{type:"text",value:m.name,onChange:S=>v({...m,name:S.target.value}),placeholder:"Name",autoFocus:!0}),l.jsxs("select",{value:m.role,onChange:S=>v({...m,role:S.target.value}),children:[l.jsx("option",{value:"Foreman",children:"Foreman"}),l.jsx("option",{value:"Laborer",children:"Laborer"}),l.jsx("option",{value:"Supervisor",children:"Supervisor"}),l.jsx("option",{value:"Operator",children:"Operator"})]}),l.jsxs("div",{className:"crew-add-buttons",children:[l.jsx("button",{className:"crew-add-confirm",onClick:g,disabled:o,children:o?"...":"Add"}),l.jsx("button",{className:"crew-add-cancel",onClick:()=>{h(!1),v({name:"",role:"Laborer"})},children:"Cancel"})]})]}):l.jsx("button",{className:"crew-add-btn",onClick:()=>h(!0),children:"+ Add Crew Member"}),l.jsxs("div",{className:"crew-count",children:[r.length," ",r.length===1?"person":"people"," on site"]})]})}function FT({project:t,onShowToast:e,onClose:r}){const[a,n]=se.useState(!0),[s,o]=se.useState(!1),[u,f]=se.useState(null),[h,m]=se.useState(""),[v,y]=se.useState("");se.useEffect(()=>{g()},[t.id]);const g=async()=>{try{const E=await ut.getDailyReport(t.id);if(E)f(E),m(E.field_notes||""),y(E.issues||"");else{const C=await ut.compileDailyReport(t.id);f({...C,status:"draft"})}}catch(E){console.error("Error loading report:",E),e("Error loading report","error")}finally{n(!1)}},b=async()=>{if(!$e){e("Demo Mode: Report saved locally only - won't reach office","info"),r();return}o(!0);try{await ut.saveDailyReport(t.id,{field_notes:h,issues:v}),await ut.submitDailyReport(t.id,"Field")?(e("Daily report submitted!","success"),r()):e("Report not sent - check connection","error")}catch(E){console.error("Error submitting report:",E),e("Error submitting report","error")}finally{o(!1)}},_=new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"});if(a)return l.jsxs("div",{className:"daily-report",children:[l.jsxs("div",{className:"daily-report-header",children:[l.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),l.jsx("h2",{children:"Daily Report"})]}),l.jsx("div",{className:"daily-report-loading",children:"Compiling report..."})]});const S=u?.status==="submitted";return l.jsxs("div",{className:"daily-report",children:[l.jsxs("div",{className:"daily-report-header",children:[l.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),l.jsxs("div",{children:[l.jsx("h2",{children:"Daily Report"}),l.jsx("p",{className:"daily-report-date",children:_})]})]}),S&&l.jsxs("div",{className:"daily-report-submitted-banner",children:[" Submitted ",new Date(u.submitted_at).toLocaleTimeString()]}),l.jsxs("div",{className:"daily-report-content",children:[l.jsxs("div",{className:"daily-report-summary",children:[l.jsxs("div",{className:"daily-report-card",children:[l.jsx("div",{className:"daily-report-card-value",children:u.crew_count||0}),l.jsx("div",{className:"daily-report-card-label",children:"Crew on Site"})]}),l.jsxs("div",{className:"daily-report-card",children:[l.jsx("div",{className:"daily-report-card-value",children:u.tasks_completed||0}),l.jsx("div",{className:"daily-report-card-label",children:"Tasks Done"})]}),l.jsxs("div",{className:"daily-report-card",children:[l.jsx("div",{className:"daily-report-card-value",children:u.tm_tickets_count||0}),l.jsx("div",{className:"daily-report-card-label",children:"T&M Tickets"})]}),l.jsxs("div",{className:"daily-report-card",children:[l.jsx("div",{className:"daily-report-card-value",children:u.photos_count||0}),l.jsx("div",{className:"daily-report-card-label",children:"Photos"})]})]}),u.crew_list?.length>0&&l.jsxs("div",{className:"daily-report-section",children:[l.jsxs("h3",{children:[l.jsx(Ui,{size:18,className:"inline-icon"})," Crew"]}),l.jsx("div",{className:"daily-report-crew",children:u.crew_list.map((E,C)=>l.jsxs("div",{className:"daily-report-crew-item",children:[l.jsx("span",{children:E.name}),l.jsx("span",{className:"daily-report-crew-role",children:E.role})]},C))})]}),u.completed_tasks?.length>0&&l.jsxs("div",{className:"daily-report-section",children:[l.jsxs("h3",{children:[l.jsx(I4,{size:18,className:"inline-icon"})," Completed Today"]}),l.jsx("ul",{className:"daily-report-tasks",children:u.completed_tasks.map((E,C)=>l.jsxs("li",{children:[E.name,E.group&&l.jsx("span",{className:"daily-report-task-group",children:E.group})]},C))})]}),l.jsxs("div",{className:"daily-report-section",children:[l.jsxs("h3",{children:[l.jsx(hc,{size:18,className:"inline-icon"})," Notes"]}),l.jsx("textarea",{value:h,onChange:E=>m(E.target.value),placeholder:"Any notes about today's work...",rows:3,disabled:S})]}),l.jsxs("div",{className:"daily-report-section",children:[l.jsxs("h3",{children:[l.jsx(o1,{size:18,className:"inline-icon"})," Issues / Concerns"]}),l.jsx("textarea",{value:v,onChange:E=>y(E.target.value),placeholder:"Any problems, delays, or concerns...",rows:3,disabled:S})]})]}),!S&&l.jsxs("div",{className:"daily-report-footer",children:[l.jsx("button",{className:"btn btn-primary daily-report-submit",onClick:b,disabled:s,children:s?"Submitting...":l.jsxs(l.Fragment,{children:[l.jsx(wT,{size:16,className:"inline-icon"})," Submit Report"]})}),l.jsx("p",{className:"daily-report-hint",children:"This will be sent to the office"})]})]})}function LT({project:t,viewerType:e,viewerName:r,onShowToast:a,onClose:n}){const[s,o]=se.useState([]),[u,f]=se.useState(!0),[h,m]=se.useState(!1),[v,y]=se.useState(""),g=se.useRef(null);se.useEffect(()=>{b(),ut.markMessagesRead(t.id,e)},[t.id]),se.useEffect(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[s]);const b=async()=>{try{const C=await ut.getMessages(t.id);o(C.reverse())}catch(C){console.error("Error loading messages:",C)}finally{f(!1)}},_=async()=>{if(v.trim()){if(!$e){a("Demo Mode: Messages won't sync to other users","info");const C={id:Date.now(),project_id:t.id,message:v.trim(),sender_type:e,sender_name:r,created_at:new Date().toISOString()};o([...s,C]),y("");return}m(!0);try{const C=await ut.sendMessage(t.id,v.trim(),e,r);C?(o([...s,C]),y("")):a("Message not sent - check connection","error")}catch(C){console.error("Error sending message:",C),a("Error sending message","error")}finally{m(!1)}}},S=C=>{C.key==="Enter"&&!C.shiftKey&&(C.preventDefault(),_())},E=C=>{const j=new Date(C),R=new Date;return j.toDateString()===R.toDateString()?j.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):j.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})};return l.jsxs("div",{className:"messages-container",children:[l.jsxs("div",{className:"messages-header",children:[l.jsx("button",{className:"back-btn-simple",onClick:n,children:""}),l.jsxs("div",{children:[l.jsx("h2",{children:"Messages"}),l.jsx("p",{className:"messages-project",children:t.name})]})]}),l.jsxs("div",{className:"messages-list",children:[u?l.jsx("div",{className:"messages-loading",children:"Loading..."}):s.length===0?l.jsxs("div",{className:"messages-empty",children:[l.jsx("p",{children:"No messages yet"}),l.jsx("p",{className:"messages-empty-hint",children:e==="field"?"Messages from the office will appear here":"Send a message to the field crew"})]}):s.map(C=>l.jsx("div",{className:`message ${C.sender_type===e?"sent":"received"}`,children:l.jsxs("div",{className:"message-bubble",children:[l.jsxs("div",{className:"message-sender",children:[C.sender_type==="office"?l.jsx(S0,{size:14,className:"inline-icon"}):l.jsx(Ui,{size:14,className:"inline-icon"})," ",C.sender_name]}),l.jsx("div",{className:"message-text",children:C.message}),C.photo_url&&l.jsx("img",{src:C.photo_url,alt:"Attached",className:"message-photo"}),l.jsx("div",{className:"message-time",children:E(C.created_at)})]})},C.id)),l.jsx("div",{ref:g})]}),l.jsxs("div",{className:"messages-input-container",children:[l.jsx("textarea",{value:v,onChange:C=>y(C.target.value),onKeyDown:S,placeholder:"Type a message...",rows:1,disabled:h}),l.jsx("button",{className:"messages-send-btn",onClick:_,disabled:h||!v.trim(),children:h?"...":""})]})]})}function PT({project:t,requestedBy:e,onShowToast:r,onClose:a}){const[n,s]=se.useState([{name:"",quantity:"",unit:"each"}]),[o,u]=se.useState(""),[f,h]=se.useState("normal"),[m,v]=se.useState(""),[y,g]=se.useState(!1),b=()=>{s([...n,{name:"",quantity:"",unit:"each"}])},_=(C,j,R)=>{s(n.map((H,Y)=>Y===C?{...H,[j]:R}:H))},S=C=>{n.length>1&&s(n.filter((j,R)=>R!==C))},E=async()=>{const C=n.filter(j=>j.name.trim()&&parseFloat(j.quantity)>0);if(C.length===0){r("Add at least one item with quantity","error");return}if(!$e){r("Demo Mode: Request saved locally only - won't reach office","info"),a();return}g(!0);try{await ut.createMaterialRequest(t.id,C,e,o||null,f,m||null)?(r("Request submitted!","success"),a()):r("Request not sent - check connection","error")}catch(j){console.error("Error submitting request:",j),r("Error submitting request","error")}finally{g(!1)}};return l.jsxs("div",{className:"material-request",children:[l.jsxs("div",{className:"material-request-header",children:[l.jsx("button",{className:"back-btn-simple",onClick:a,children:""}),l.jsx("h2",{children:"Request Materials"})]}),l.jsxs("div",{className:"material-request-content",children:[l.jsxs("div",{className:"material-request-section",children:[l.jsx("label",{children:"What do you need?"}),n.map((C,j)=>l.jsxs("div",{className:"material-request-item",children:[l.jsx("input",{type:"text",placeholder:"Item name",value:C.name,onChange:R=>_(j,"name",R.target.value),className:"material-request-name"}),l.jsx("input",{type:"number",placeholder:"Qty",value:C.quantity,onChange:R=>_(j,"quantity",R.target.value),className:"material-request-qty"}),l.jsxs("select",{value:C.unit,onChange:R=>_(j,"unit",R.target.value),className:"material-request-unit",children:[l.jsx("option",{value:"each",children:"each"}),l.jsx("option",{value:"rolls",children:"rolls"}),l.jsx("option",{value:"boxes",children:"boxes"}),l.jsx("option",{value:"bags",children:"bags"}),l.jsx("option",{value:"sheets",children:"sheets"}),l.jsx("option",{value:"gallons",children:"gal"}),l.jsx("option",{value:"feet",children:"ft"}),l.jsx("option",{value:"lbs",children:"lbs"})]}),l.jsx("button",{className:"material-request-remove",onClick:()=>S(j),children:""})]},j)),l.jsx("button",{className:"material-request-add",onClick:b,children:"+ Add Another Item"})]}),l.jsxs("div",{className:"material-request-section",children:[l.jsx("label",{children:"Priority"}),l.jsx("div",{className:"material-request-priority",children:["low","normal","urgent"].map(C=>l.jsxs("button",{className:`priority-btn ${f===C?"active":""} ${C}`,onClick:()=>h(C),children:[C==="urgent"&&" ",C==="normal"&&" ",C==="low"&&" ",C.charAt(0).toUpperCase()+C.slice(1)]},C))})]}),l.jsxs("div",{className:"material-request-section",children:[l.jsx("label",{children:"Needed By (optional)"}),l.jsx("input",{type:"date",value:o,onChange:C=>u(C.target.value),min:new Date().toISOString().split("T")[0]})]}),l.jsxs("div",{className:"material-request-section",children:[l.jsx("label",{children:"Notes (optional)"}),l.jsx("textarea",{value:m,onChange:C=>v(C.target.value),placeholder:"Any additional details...",rows:2})]})]}),l.jsx("div",{className:"material-request-footer",children:l.jsx("button",{className:"btn btn-primary",onClick:E,disabled:y,children:y?"Submitting...":l.jsxs(l.Fragment,{children:[l.jsx(Ef,{size:16,className:"inline-icon"})," Submit Request"]})})})]})}const MT=se.createContext({}),$4=()=>se.useContext(MT);function uf({message:t,type:e="",onClose:r}){return se.useEffect(()=>{const a=setTimeout(r,3e3);return()=>clearTimeout(a)},[r]),l.jsx("div",{className:"toast-container",children:l.jsx("div",{className:`toast ${e}`,children:t})})}function W4({project:t,companyId:e,onClose:r,onReportCreated:a}){const{user:n}=$4(),[s,o]=se.useState(!1),[u,f]=se.useState(null),[h,m]=se.useState(1),[v,y]=se.useState(new Date().toISOString().split("T")[0]),[g,b]=se.useState(new Date().toTimeString().split(" ")[0].substring(0,5)),[_,S]=se.useState(""),[E,C]=se.useState(""),[j,R]=se.useState("minor"),[H,Y]=se.useState(""),[U,V]=se.useState(""),[F,X]=se.useState(""),[P,O]=se.useState(""),[I,W]=se.useState(""),[ne,Q]=se.useState(""),[le,ee]=se.useState(""),[K,ue]=se.useState(n?.name||""),[M,A]=se.useState(""),[D,B]=se.useState(""),[q,Z]=se.useState(n?.email||""),[oe,pe]=se.useState([]),[_e,be]=se.useState(""),[Le,he]=se.useState(""),[Ae,de]=se.useState(""),[re,Ke]=se.useState(""),[Oe,rt]=se.useState(!1),[tt,Et]=se.useState(""),[kt,zt]=se.useState(""),[Tt,at]=se.useState(!1),[pt,At]=se.useState(""),[Dt,xt]=se.useState(""),[St,ft]=se.useState(""),[yt,er]=se.useState(""),[Lt,Bt]=se.useState(!1),[we,Ie]=se.useState(!1),[ve,Ue]=se.useState(0),[Be,Rt]=se.useState(0),Ht=()=>{if(!_e.trim()){f({type:"error",message:"Please enter witness name"});return}const Ct={name:_e,phone:Le,email:Ae,testimony:re};pe([...oe,Ct]),be(""),he(""),de(""),Ke(""),f({type:"success",message:"Witness added"})},Kt=Ct=>{pe(oe.filter((Ha,_t)=>_t!==Ct))},$t=Ct=>{switch(Ct){case 1:if(!_.trim()||!E.trim())return f({type:"error",message:"Please fill in all incident details"}),!1;break;case 2:if(!U.trim()||!ne.trim())return f({type:"error",message:"Please fill in employee name and job title"}),!1;break;case 3:if(!K.trim()||!M.trim())return f({type:"error",message:"Please fill in supervisor name and title"}),!1;break}return!0},Nr=()=>{$t(h)&&m(h+1)},Jn=()=>{m(h-1)},ja=async()=>{if($t(h)){if(!$e){f({type:"info",message:"Demo Mode: Report saved locally only - won't reach office"}),setTimeout(()=>{r()},1500);return}o(!0);try{const Ct={project_id:t.id,company_id:e,incident_date:v,incident_time:g,incident_location:_,incident_description:E,injury_type:j,body_part_affected:H||null,employee_name:U,employee_phone:F||null,employee_email:P||null,employee_address:I||null,employee_job_title:ne,employee_hire_date:le||null,medical_treatment_required:Oe,medical_facility_name:tt||null,medical_facility_address:kt||null,hospitalized:Tt,reported_by_name:K,reported_by_title:M,reported_by_phone:D||null,reported_by_email:q||null,witnesses:oe,immediate_actions_taken:pt||null,corrective_actions_planned:Dt||null,safety_equipment_used:St||null,safety_equipment_failed:yt||null,osha_recordable:Lt,workers_comp_claim:we,days_away_from_work:parseInt(ve)||0,restricted_work_days:parseInt(Be)||0,status:"reported",created_by:n?.id},Ha=await ut.createInjuryReport(Ct);f({type:"success",message:"Injury report submitted successfully"}),a&&a(Ha),setTimeout(()=>{r()},1500)}catch(Ct){console.error("Error submitting injury report:",Ct),f({type:"error",message:"Failed to submit injury report"})}finally{o(!1)}}};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"modal-overlay",onClick:r,children:l.jsxs("div",{className:"modal-content injury-report-modal",onClick:Ct=>Ct.stopPropagation(),children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("h2",{children:"Workplace Injury/Incident Report"}),l.jsx("button",{className:"close-btn",onClick:r,children:""})]}),l.jsxs("div",{className:"progress-steps",children:[l.jsx("div",{className:`step ${h>=1?"active":""}`,children:"1. Incident"}),l.jsx("div",{className:`step ${h>=2?"active":""}`,children:"2. Employee"}),l.jsx("div",{className:`step ${h>=3?"active":""}`,children:"3. Supervisor"}),l.jsx("div",{className:`step ${h>=4?"active":""}`,children:"4. Witnesses"}),l.jsx("div",{className:`step ${h>=5?"active":""}`,children:"5. Medical & Safety"})]}),l.jsxs("div",{className:"modal-body",children:[h===1&&l.jsxs("div",{className:"form-step",children:[l.jsx("h3",{children:"Incident Details"}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Date of Incident *"}),l.jsx("input",{type:"date",value:v,onChange:Ct=>y(Ct.target.value),max:new Date().toISOString().split("T")[0]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Time of Incident *"}),l.jsx("input",{type:"time",value:g,onChange:Ct=>b(Ct.target.value)})]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Location on Site *"}),l.jsx("input",{type:"text",value:_,onChange:Ct=>S(Ct.target.value),placeholder:"e.g., Floor 2, near elevator shaft"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Incident Description *"}),l.jsx("textarea",{value:E,onChange:Ct=>C(Ct.target.value),rows:4,placeholder:"Describe what happened in detail..."})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Injury Type *"}),l.jsxs("select",{value:j,onChange:Ct=>R(Ct.target.value),children:[l.jsx("option",{value:"minor",children:"Minor Injury"}),l.jsx("option",{value:"serious",children:"Serious Injury"}),l.jsx("option",{value:"critical",children:"Critical Injury"}),l.jsx("option",{value:"near_miss",children:"Near Miss (No Injury)"})]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Body Part Affected"}),l.jsx("input",{type:"text",value:H,onChange:Ct=>Y(Ct.target.value),placeholder:"e.g., Left hand, lower back"})]})]})]}),h===2&&l.jsxs("div",{className:"form-step",children:[l.jsx("h3",{children:"Injured Employee Information"}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Full Name *"}),l.jsx("input",{type:"text",value:U,onChange:Ct=>V(Ct.target.value),placeholder:"First and last name"})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Phone Number"}),l.jsx("input",{type:"tel",value:F,onChange:Ct=>X(Ct.target.value),placeholder:"(555) 123-4567"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Email Address"}),l.jsx("input",{type:"email",value:P,onChange:Ct=>O(Ct.target.value),placeholder:"email@example.com"})]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Home Address"}),l.jsx("input",{type:"text",value:I,onChange:Ct=>W(Ct.target.value),placeholder:"Street address, city, state, zip"})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Job Title *"}),l.jsx("input",{type:"text",value:ne,onChange:Ct=>Q(Ct.target.value),placeholder:"e.g., Carpenter, Electrician"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Hire Date"}),l.jsx("input",{type:"date",value:le,onChange:Ct=>ee(Ct.target.value)})]})]})]}),h===3&&l.jsxs("div",{className:"form-step",children:[l.jsx("h3",{children:"Foreman/Supervisor Making Report"}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Your Name *"}),l.jsx("input",{type:"text",value:K,onChange:Ct=>ue(Ct.target.value),placeholder:"Full name"})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Your Title *"}),l.jsx("input",{type:"text",value:M,onChange:Ct=>A(Ct.target.value),placeholder:"e.g., Site Foreman, Project Manager"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Your Phone Number"}),l.jsx("input",{type:"tel",value:D,onChange:Ct=>B(Ct.target.value),placeholder:"(555) 123-4567"})]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Your Email Address"}),l.jsx("input",{type:"email",value:q,onChange:Ct=>Z(Ct.target.value),placeholder:"email@example.com"})]})]}),h===4&&l.jsxs("div",{className:"form-step",children:[l.jsx("h3",{children:"Witness Testimonies (Optional)"}),oe.length>0&&l.jsx("div",{className:"witnesses-list",children:oe.map((Ct,Ha)=>l.jsxs("div",{className:"witness-item",children:[l.jsxs("div",{className:"witness-info",children:[l.jsx("strong",{children:Ct.name}),Ct.phone&&l.jsxs("span",{children:["  ",Ct.phone]}),Ct.testimony&&l.jsxs("p",{className:"witness-testimony",children:['"',Ct.testimony,'"']})]}),l.jsx("button",{className:"btn-danger btn-small",onClick:()=>Kt(Ha),children:"Remove"})]},Ha))}),l.jsxs("div",{className:"add-witness-form",children:[l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Witness Name"}),l.jsx("input",{type:"text",value:_e,onChange:Ct=>be(Ct.target.value),placeholder:"Full name"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Phone Number"}),l.jsx("input",{type:"tel",value:Le,onChange:Ct=>he(Ct.target.value),placeholder:"(555) 123-4567"})]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Email Address"}),l.jsx("input",{type:"email",value:Ae,onChange:Ct=>de(Ct.target.value),placeholder:"email@example.com"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Witness Testimony"}),l.jsx("textarea",{value:re,onChange:Ct=>Ke(Ct.target.value),rows:3,placeholder:"What did the witness see or hear?"})]}),l.jsx("button",{className:"btn-secondary",onClick:Ht,children:"+ Add Witness"})]})]}),h===5&&l.jsxs("div",{className:"form-step",children:[l.jsx("h3",{children:"Medical Treatment & Safety"}),l.jsx("div",{className:"form-group checkbox-group",children:l.jsxs("label",{children:[l.jsx("input",{type:"checkbox",checked:Oe,onChange:Ct=>rt(Ct.target.checked)}),"Medical treatment required"]})}),Oe&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Medical Facility Name"}),l.jsx("input",{type:"text",value:tt,onChange:Ct=>Et(Ct.target.value),placeholder:"Hospital or clinic name"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Medical Facility Address"}),l.jsx("input",{type:"text",value:kt,onChange:Ct=>zt(Ct.target.value),placeholder:"Street address"})]}),l.jsx("div",{className:"form-group checkbox-group",children:l.jsxs("label",{children:[l.jsx("input",{type:"checkbox",checked:Tt,onChange:Ct=>at(Ct.target.checked)}),"Employee was hospitalized"]})})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Immediate Actions Taken"}),l.jsx("textarea",{value:pt,onChange:Ct=>At(Ct.target.value),rows:2,placeholder:"What was done immediately after the incident?"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Corrective Actions Planned"}),l.jsx("textarea",{value:Dt,onChange:Ct=>xt(Ct.target.value),rows:2,placeholder:"What will be done to prevent this in the future?"})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Safety Equipment Used"}),l.jsx("input",{type:"text",value:St,onChange:Ct=>ft(Ct.target.value),placeholder:"e.g., Hard hat, gloves, harness"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Safety Equipment Failed"}),l.jsx("input",{type:"text",value:yt,onChange:Ct=>er(Ct.target.value),placeholder:"Equipment that failed, if any"})]})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Days Away From Work"}),l.jsx("input",{type:"number",min:"0",value:ve,onChange:Ct=>Ue(Ct.target.value)})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Restricted Work Days"}),l.jsx("input",{type:"number",min:"0",value:Be,onChange:Ct=>Rt(Ct.target.value)})]})]}),l.jsx("div",{className:"form-group checkbox-group",children:l.jsxs("label",{children:[l.jsx("input",{type:"checkbox",checked:Lt,onChange:Ct=>Bt(Ct.target.checked)}),"OSHA Recordable Incident"]})}),l.jsx("div",{className:"form-group checkbox-group",children:l.jsxs("label",{children:[l.jsx("input",{type:"checkbox",checked:we,onChange:Ct=>Ie(Ct.target.checked)}),"Workers' Compensation Claim Filed"]})})]})]}),l.jsx("div",{className:"modal-footer",children:l.jsxs("div",{className:"form-actions",children:[h>1&&l.jsx("button",{className:"btn-secondary",onClick:Jn,children:" Back"}),l.jsx("button",{className:"btn-secondary",onClick:r,children:"Cancel"}),h<5?l.jsx("button",{className:"btn-primary",onClick:Nr,children:"Next "}):l.jsx("button",{className:"btn-primary",onClick:ja,disabled:s,children:s?"Submitting...":"Submit Report"})]})})]})}),u&&l.jsx(uf,{message:u.message,type:u.type,onClose:()=>f(null)}),l.jsx("style",{children:`
        .injury-report-modal {
          max-width: 800px;
          max-height: 90vh;
          overflow-y: auto;
        }

        .progress-steps {
          display: flex;
          justify-content: space-between;
          padding: 1rem 1.5rem;
          border-bottom: 1px solid #e5e7eb;
          background-color: #f9fafb;
          overflow-x: auto;
        }

        .progress-steps .step {
          font-size: 0.875rem;
          color: #9ca3af;
          font-weight: 500;
          white-space: nowrap;
          padding: 0.5rem;
        }

        .progress-steps .step.active {
          color: var(--primary-color, #3b82f6);
          font-weight: 600;
        }

        .form-step h3 {
          margin-top: 0;
          margin-bottom: 1.5rem;
          color: #111827;
          font-size: 1.25rem;
        }

        .form-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 500;
          color: #374151;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
          width: 100%;
          padding: 0.5rem;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          font-size: 1rem;
        }

        .form-group textarea {
          resize: vertical;
        }

        .checkbox-group label {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-weight: normal;
          cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
          width: auto;
          margin: 0;
        }

        .witnesses-list {
          margin-bottom: 1.5rem;
        }

        .witness-item {
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          padding: 1rem;
          margin-bottom: 0.5rem;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
        }

        .witness-info {
          flex: 1;
        }

        .witness-testimony {
          margin-top: 0.5rem;
          color: #6b7280;
          font-style: italic;
          font-size: 0.875rem;
        }

        .add-witness-form {
          border: 2px dashed #d1d5db;
          border-radius: 6px;
          padding: 1rem;
          background-color: #f9fafb;
        }

        .modal-footer {
          border-top: 1px solid #e5e7eb;
          padding: 1rem 1.5rem;
        }

        .form-actions {
          display: flex;
          justify-content: space-between;
          gap: 0.5rem;
        }

        .btn-primary,
        .btn-secondary,
        .btn-danger {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          opacity: 0.9;
        }

        .btn-primary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-secondary {
          background-color: #f3f4f6;
          color: #374151;
        }

        .btn-secondary:hover {
          background-color: #e5e7eb;
        }

        .btn-danger {
          background-color: #ef4444;
          color: white;
        }

        .btn-danger:hover {
          background-color: #dc2626;
        }

        .btn-small {
          padding: 0.25rem 0.75rem;
          font-size: 0.875rem;
        }

        @media (max-width: 768px) {
          .injury-report-modal {
            max-width: 100%;
            height: 100vh;
            max-height: 100vh;
            border-radius: 0;
          }

          .form-row {
            grid-template-columns: 1fr;
          }

          .progress-steps .step {
            font-size: 0.75rem;
            padding: 0.25rem;
          }
        }
      `})]})}const Xb=[{id:"trash",label:"Trash",description:"General debris"},{id:"metal",label:"Metal",description:"Scrap metal (recyclable)"},{id:"copper",label:"Copper",description:"Copper scrap (recyclable)"},{id:"concrete",label:"Concrete",description:"Concrete/masonry"},{id:"hazardous",label:"Hazardous",description:"Hazardous materials"}];function IT({project:t,companyId:e,onClose:r,onSubmit:a,onShowToast:n}){const[s,o]=se.useState(!1),[u,f]=se.useState([]),[h,m]=se.useState(!0),[v,y]=se.useState(new Date().toISOString().split("T")[0]),[g,b]=se.useState("trash"),[_,S]=se.useState(1),[E,C]=se.useState(""),[j,R]=se.useState(t.default_dump_site_id||""),[H,Y]=se.useState(""),[U,V]=se.useState(null),[F,X]=se.useState(null);se.useEffect(()=>{P()},[e]),se.useEffect(()=>{O()},[j,g,_,u]);const P=async()=>{try{const le=await ut.getDumpSites(e);f(le||[]),t.default_dump_site_id?R(t.default_dump_site_id):le&&le.length>0&&R(le[0].id)}catch(le){console.error("Error loading dump sites:",le)}finally{m(!1)}},O=()=>{if(!j||!g||!_){V(null),X(null);return}const le=u.find(K=>K.id===j);if(!le||!le.dump_site_rates){V(null),X(null);return}const ee=le.dump_site_rates.find(K=>K.waste_type===g);if(ee&&ee.estimated_cost_per_load!==null){const K=parseFloat(ee.estimated_cost_per_load);X(K),V(K*parseInt(_))}else V(null),X(null)},I=le=>le==null?"--":le<0?`-$${Math.abs(le).toFixed(0)}`:`$${le.toFixed(0)}`,W=async le=>{if(le.preventDefault(),!j){n("Please select a dump site","error");return}if(!_||_<1){n("Please enter number of loads","error");return}o(!0);try{await ut.createHaulOff(t.id,{dump_site_id:j,waste_type:g,loads:parseInt(_),hauling_company:E.trim()||null,work_date:v,notes:H.trim()||null,estimated_cost:U,created_by:"Field"}),n("Haul-off logged successfully","success"),a&&a(),r()}catch(ee){console.error("Error logging haul-off:",ee),n("Error logging haul-off","error")}finally{o(!1)}},ne=u.find(le=>le.id===j),Q=Xb.find(le=>le.id===g);return l.jsxs("div",{className:"hauloff-form-container",children:[l.jsxs("div",{className:"hauloff-header",children:[l.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),l.jsx("h2",{children:"Log Haul-Off"})]}),l.jsxs("form",{onSubmit:W,className:"hauloff-form",children:[l.jsxs("div",{className:"hauloff-field",children:[l.jsx("label",{children:"Date"}),l.jsx("input",{type:"date",value:v,onChange:le=>y(le.target.value),max:new Date().toISOString().split("T")[0]})]}),l.jsxs("div",{className:"hauloff-field",children:[l.jsx("label",{children:"Waste Type"}),l.jsx("div",{className:"waste-type-grid",children:Xb.map(le=>l.jsxs("button",{type:"button",className:`waste-type-btn ${g===le.id?"active":""} ${le.id==="metal"||le.id==="copper"?"recyclable":""}`,onClick:()=>b(le.id),children:[l.jsx("span",{className:"waste-label",children:le.label}),(le.id==="metal"||le.id==="copper")&&l.jsx("span",{className:"waste-badge",children:"$"})]},le.id))})]}),l.jsxs("div",{className:"hauloff-field",children:[l.jsx("label",{children:"Number of Loads"}),l.jsxs("div",{className:"loads-input-row",children:[l.jsx("button",{type:"button",className:"loads-btn",onClick:()=>S(Math.max(1,_-1)),children:""}),l.jsx("input",{type:"number",value:_,onChange:le=>S(Math.max(1,parseInt(le.target.value)||1)),min:"1",className:"loads-input"}),l.jsx("button",{type:"button",className:"loads-btn",onClick:()=>S(_+1),children:"+"})]})]}),l.jsxs("div",{className:"hauloff-field",children:[l.jsx("label",{children:"Dump Site"}),h?l.jsx("div",{className:"loading-inline",children:"Loading sites..."}):u.length===0?l.jsx("div",{className:"no-sites-warning",children:"No dump sites configured. Ask office to add dump sites."}):l.jsxs("select",{value:j,onChange:le=>R(le.target.value),children:[l.jsx("option",{value:"",children:"-- Select Dump Site --"}),u.map(le=>l.jsx("option",{value:le.id,children:le.name},le.id))]}),ne?.address&&l.jsx("span",{className:"field-hint",children:ne.address})]}),l.jsxs("div",{className:"hauloff-field",children:[l.jsx("label",{children:"Hauling Company (Optional)"}),l.jsx("input",{type:"text",value:E,onChange:le=>C(le.target.value),placeholder:"e.g., ABC Trucking"})]}),l.jsxs("div",{className:"hauloff-field",children:[l.jsx("label",{children:"Notes (Optional)"}),l.jsx("textarea",{value:H,onChange:le=>Y(le.target.value),placeholder:"Any additional notes...",rows:2})]}),l.jsxs("div",{className:"hauloff-estimate",children:[l.jsx("div",{className:"estimate-header",children:"Estimated Cost"}),U!==null?l.jsxs("div",{className:`estimate-value ${U<0?"revenue":""}`,children:[l.jsx("span",{className:"estimate-amount",children:I(U)}),l.jsxs("span",{className:"estimate-breakdown",children:[I(F),"/load  ",_," load",_>1?"s":""]}),U<0&&l.jsx("span",{className:"estimate-note revenue-note",children:"Revenue from recyclables"})]}):l.jsxs("div",{className:"estimate-value",children:[l.jsx("span",{className:"estimate-amount",children:"--"}),l.jsx("span",{className:"estimate-breakdown",children:j?ne?.dump_site_rates?.find(le=>le.waste_type===g)?"Unable to calculate":`No rate set for ${Q?.label||g}`:"Select a dump site"})]}),l.jsx("div",{className:"estimate-disclaimer",children:"This is an estimate for burn rate tracking, not an invoice amount."})]}),l.jsxs("div",{className:"hauloff-actions",children:[l.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,disabled:s,children:"Cancel"}),l.jsx("button",{type:"submit",className:"btn btn-primary",disabled:s||!j,children:s?"Saving...":"Log Haul-Off"})]})]})]})}function BT({project:t,companyId:e,onShowToast:r,onExit:a}){const[n,s]=se.useState([]),[o,u]=se.useState(!0),[f,h]=se.useState(null),[m,v]=se.useState({}),[y,g]=se.useState(!1),[b,_]=se.useState(!0),[S,E]=se.useState(!1),[C,j]=se.useState(!1),[R,H]=se.useState(!1),[Y,U]=se.useState(!1),[V,F]=se.useState(!1),[X,P]=se.useState(!1),[O,I]=se.useState(0);se.useEffect(()=>{W(),ne()},[t.id]);const W=async()=>{try{const q=await ut.getAreas(t.id);s(q);const Z=[...new Set(q.map(pe=>pe.group_name||"General"))],oe={};Z.forEach(pe=>oe[pe]=!1),v(oe)}catch(q){console.error("Error loading areas:",q),r("Error loading areas","error")}finally{u(!1)}},ne=async()=>{const q=await ut.getUnreadCount(t.id,"field");I(q)},Q=async(q,Z)=>{const oe=n.find(_e=>_e.id===q);if(!oe)return;const pe=oe.status===Z?"not_started":Z;h(q);try{await ut.updateAreaStatus(q,pe),s(_e=>_e.map(be=>be.id===q?{...be,status:pe}:be)),r("Updated","success")}catch(_e){console.error("Error updating status:",_e),r("Error updating","error")}finally{h(null)}},le=q=>{v(Z=>({...Z,[q]:!Z[q]}))};if(o)return l.jsx("div",{className:"foreman-container",children:l.jsxs("div",{className:"loading",children:[l.jsx("div",{className:"spinner"}),"Loading..."]})});if(y)return l.jsx("div",{className:"foreman-container",children:l.jsx(RT,{project:t,companyId:e,onSubmit:()=>g(!1),onCancel:()=>g(!1),onShowToast:r})});if(S)return l.jsx(FT,{project:t,onShowToast:r,onClose:()=>E(!1)});if(C)return l.jsx(LT,{project:t,viewerType:"field",viewerName:"Field",onShowToast:r,onClose:()=>{j(!1),ne()}});if(R)return l.jsx(PT,{project:t,requestedBy:"Field",onShowToast:r,onClose:()=>H(!1)});if(Y)return l.jsx("div",{className:"foreman-container",children:l.jsx(W4,{project:t,companyId:e,onClose:()=>U(!1),onReportCreated:()=>{U(!1),r("Injury report submitted","success")}})});if(V)return l.jsx("div",{className:"foreman-container",children:l.jsx(IT,{project:t,companyId:e,onClose:()=>F(!1),onSubmit:()=>F(!1),onShowToast:r})});const ee=l2(n),K=n.reduce((q,Z)=>{const oe=Z.group_name||"General";return q[oe]||(q[oe]=[]),q[oe].push(Z),q},{}),ue=Object.keys(K).length>1||Object.keys(K).length===1&&!K.General,M=q=>`${q.filter(oe=>oe.status==="done").length}/${q.length}`,A=n.filter(q=>q.status==="done").length,D=n.filter(q=>q.status==="working").length,B=n.length-A;return l.jsxs("div",{className:"foreman-container",children:[l.jsxs("div",{className:"foreman-header",children:[l.jsx("button",{className:"back-btn-simple",onClick:a,children:""}),l.jsxs("div",{className:"foreman-header-info",children:[l.jsx("div",{className:"foreman-project-name",children:t.name}),l.jsxs("div",{className:"foreman-progress",children:[ee,"% Complete"]})]}),l.jsx("button",{className:"foreman-info-btn",onClick:()=>P(!X),children:l.jsx(B4,{size:20})})]}),X&&l.jsxs("div",{className:"foreman-project-info",children:[t.job_number&&l.jsxs("div",{className:"foreman-info-row",children:[l.jsx("span",{className:"foreman-info-label",children:"Job #"}),l.jsx("span",{className:"foreman-info-value",children:t.job_number})]}),t.address&&l.jsxs("div",{className:"foreman-info-row",children:[l.jsx("span",{className:"foreman-info-label",children:"Address"}),l.jsx("span",{className:"foreman-info-value",children:t.address})]}),t.general_contractor&&l.jsxs("div",{className:"foreman-info-row",children:[l.jsx("span",{className:"foreman-info-label",children:"GC / Client"}),l.jsx("span",{className:"foreman-info-value",children:t.general_contractor})]}),t.client_contact&&l.jsxs("div",{className:"foreman-info-row",children:[l.jsx("span",{className:"foreman-info-label",children:"Contact"}),l.jsx("span",{className:"foreman-info-value",children:t.client_contact})]}),t.client_phone&&l.jsxs("div",{className:"foreman-info-row",children:[l.jsx("span",{className:"foreman-info-label",children:"Phone"}),l.jsx("a",{href:`tel:${t.client_phone}`,className:"foreman-info-value foreman-info-link",children:t.client_phone})]})]}),l.jsxs("div",{className:"foreman-stats",children:[l.jsxs("div",{className:"foreman-stat",children:[l.jsx("div",{className:"foreman-stat-value working",children:D}),l.jsx("div",{className:"foreman-stat-label",children:"Working"})]}),l.jsxs("div",{className:"foreman-stat",children:[l.jsx("div",{className:"foreman-stat-value done",children:A}),l.jsx("div",{className:"foreman-stat-label",children:"Done"})]}),l.jsxs("div",{className:"foreman-stat",children:[l.jsx("div",{className:"foreman-stat-value remaining",children:B}),l.jsx("div",{className:"foreman-stat-label",children:"Remaining"})]})]}),l.jsxs("div",{className:"field-actions",children:[l.jsxs("button",{className:"field-action-btn",onClick:()=>g(!0),children:[l.jsx(hc,{size:20,className:"icon"}),"T&M Ticket"]}),l.jsxs("button",{className:"field-action-btn",onClick:()=>j(!0),children:[l.jsx(z0,{size:20,className:"icon"}),"Messages",O>0&&l.jsx("span",{className:"badge",children:O})]}),l.jsxs("button",{className:"field-action-btn",onClick:()=>H(!0),children:[l.jsx(Ef,{size:20,className:"icon"}),"Materials"]}),l.jsxs("button",{className:"field-action-btn",onClick:()=>E(!0),children:[l.jsx(fu,{size:20,className:"icon"}),"Daily Report"]}),l.jsxs("button",{className:"field-action-btn",onClick:()=>F(!0),children:[l.jsx(l1,{size:20,className:"icon"}),"Haul-Off"]}),l.jsxs("button",{className:"field-action-btn danger",onClick:()=>U(!0),children:[l.jsx(o1,{size:20,className:"icon"}),"Report Injury"]})]}),l.jsx(DT,{project:t,onShowToast:r}),l.jsx("div",{className:"foreman-areas",children:ue?Object.entries(K).map(([q,Z])=>l.jsxs("div",{className:"foreman-group",children:[l.jsxs("div",{className:"foreman-group-header",onClick:()=>le(q),children:[l.jsxs("div",{className:"foreman-group-title",children:[l.jsx("span",{className:"foreman-group-arrow",children:m[q]?"":""}),l.jsx("span",{className:"foreman-group-name",children:q})]}),l.jsx("span",{className:"foreman-group-progress",children:M(Z)})]}),m[q]&&l.jsx("div",{className:"foreman-group-tasks",children:Z.map(oe=>l.jsxs("div",{className:`foreman-area-card ${oe.status}`,children:[l.jsx("div",{className:"foreman-area-name",children:oe.name}),l.jsxs("div",{className:"foreman-area-buttons",children:[l.jsx("button",{className:`foreman-btn working ${oe.status==="working"?"active":""}`,onClick:()=>Q(oe.id,"working"),disabled:f===oe.id,children:f===oe.id?"...":"Working"}),l.jsx("button",{className:`foreman-btn done ${oe.status==="done"?"active":""}`,onClick:()=>Q(oe.id,"done"),disabled:f===oe.id,children:f===oe.id?"...":"Done"})]})]},oe.id))})]},q)):n.map(q=>l.jsxs("div",{className:`foreman-area-card ${q.status}`,children:[l.jsx("div",{className:"foreman-area-name",children:q.name}),l.jsxs("div",{className:"foreman-area-buttons",children:[l.jsx("button",{className:`foreman-btn working ${q.status==="working"?"active":""}`,onClick:()=>Q(q.id,"working"),disabled:f===q.id,children:f===q.id?"...":"Working"}),l.jsx("button",{className:`foreman-btn done ${q.status==="done"?"active":""}`,onClick:()=>Q(q.id,"done"),disabled:f===q.id,children:f===q.id?"...":"Done"})]})]},q.id))}),n.length===0&&l.jsxs("div",{className:"foreman-empty",children:[l.jsx(fu,{size:48,className:"foreman-empty-icon"}),l.jsx("div",{className:"foreman-empty-text",children:"No areas yet"}),l.jsx("div",{className:"foreman-empty-subtext",children:"Office needs to add areas to this project"})]})]})}var Bp={};Bp.version="0.18.5";var V4=1252,UT=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],X2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},K2=function(t){UT.indexOf(t)!=-1&&(V4=X2[0]=t)};function qT(){K2(1252)}var Vo=function(t){K2(t)};function J2(){Vo(1200),qT()}function Kb(t){for(var e=[],r=0,a=t.length;r<a;++r)e[r]=t.charCodeAt(r);return e}function zT(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function G4(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var r0=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?zT(t.slice(2)):e==254&&r==255?G4(t.slice(2)):e==65279?t.slice(1):t},rp=function(e){return String.fromCharCode(e)},Jb=function(e){return String.fromCharCode(e)},N0,ou="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function k0(t){for(var e="",r=0,a=0,n=0,s=0,o=0,u=0,f=0,h=0;h<t.length;)r=t.charCodeAt(h++),s=r>>2,a=t.charCodeAt(h++),o=(r&3)<<4|a>>4,n=t.charCodeAt(h++),u=(a&15)<<2|n>>6,f=n&63,isNaN(a)?u=f=64:isNaN(n)&&(f=64),e+=ou.charAt(s)+ou.charAt(o)+ou.charAt(u)+ou.charAt(f);return e}function qi(t){var e="",r=0,a=0,n=0,s=0,o=0,u=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)s=ou.indexOf(t.charAt(h++)),o=ou.indexOf(t.charAt(h++)),r=s<<2|o>>4,e+=String.fromCharCode(r),u=ou.indexOf(t.charAt(h++)),a=(o&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(a)),f=ou.indexOf(t.charAt(h++)),n=(u&3)<<6|f,f!==64&&(e+=String.fromCharCode(n));return e}var Lr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),gc=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function hu(t){return Lr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Zb(t){return Lr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Pi=function(e){return Lr?gc(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function u1(t){if(typeof ArrayBuffer>"u")return Pi(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),a=0;a!=t.length;++a)r[a]=t.charCodeAt(a)&255;return e}function xu(t){if(Array.isArray(t))return t.map(function(a){return String.fromCharCode(a)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function HT(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Z2(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Z2(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var is=Lr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:gc(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var a=new Uint8Array(r),n=0;for(e=0,r=0;e<t.length;r+=n,++e)if(n=t[e].length,t[e]instanceof Uint8Array)a.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";a.set(new Uint8Array(t[e]),r)}return a}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function $T(t){for(var e=[],r=0,a=t.length+250,n=hu(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=t.charCodeAt(++s)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|u>>6&15|(o&3)<<4,n[r++]=128|u&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>a&&(e.push(n.slice(0,r)),r=0,n=hu(65535),a=65530)}return e.push(n.slice(0,r)),is(e)}var Gs=/\u0000/g,a0=/[\u0001-\u0006]/g;function Vh(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Go(t,e){var r=""+t;return r.length>=e?r:mn("0",e-r.length)+r}function Q2(t,e){var r=""+t;return r.length>=e?r:mn(" ",e-r.length)+r}function Up(t,e){var r=""+t;return r.length>=e?r:r+mn(" ",e-r.length)}function WT(t,e){var r=""+Math.round(t);return r.length>=e?r:mn("0",e-r.length)+r}function VT(t,e){var r=""+t;return r.length>=e?r:mn("0",e-r.length)+r}var Qb=Math.pow(2,32);function Oh(t,e){if(t>Qb||t<-Qb)return WT(t,e);var r=Math.round(t);return VT(r,e)}function qp(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var ew=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Zg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function GT(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var xr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},tw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},YT={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function zp(t,e,r){for(var a=t<0?-1:1,n=t*a,s=0,o=1,u=0,f=1,h=0,m=0,v=Math.floor(n);h<e&&(v=Math.floor(n),u=v*o+s,m=v*h+f,!(n-v<5e-8));)n=1/(n-v),s=o,o=u,f=h,h=m;if(m>e&&(h>e?(m=f,u=s):(m=h,u=o)),!r)return[0,a*u,m];var y=Math.floor(a*u/m);return[y,a*u-y*m,m]}function ff(t,e,r){if(t>2958465||t<0)return null;var a=t|0,n=Math.floor(86400*(t-a)),s=0,o=[],u={D:a,T:n,u:86400*(t-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(a+=1462),u.u>.9999&&(u.u=0,++n==86400&&(u.T=n=0,++a,++u.D)),a===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var f=new Date(1900,0,1);f.setDate(f.getDate()+a-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],s=f.getDay(),a<60&&(s=(s+6)%7),r&&(s=e8(f,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=n%60,n=Math.floor(n/60),u.M=n%60,n=Math.floor(n/60),u.H=n,u.q=s,u}var Y4=new Date(1899,11,31,0,0,0),XT=Y4.getTime(),KT=new Date(1900,2,1,0,0,0);function X4(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=KT&&(r+=1440*60*1e3),(r-(XT+(t.getTimezoneOffset()-Y4.getTimezoneOffset())*6e4))/(1440*60*1e3)}function ex(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function JT(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ZT(t){var e=t<0?12:11,r=ex(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function QT(t){var e=ex(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function j0(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=ZT(t):e===10?r=t.toFixed(10).substr(0,12):r=QT(t),ex(JT(r.toUpperCase()))}function vf(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):j0(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return fo(14,X4(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function e8(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function t8(t,e,r,a){var n="",s=0,o=0,u=r.y,f,h=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,h=2;break;default:f=u%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:f=r.m,h=e.length;break;case 3:return Zg[r.m-1][1];case 5:return Zg[r.m-1][0];default:return Zg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=r.d,h=e.length;break;case 3:return ew[r.q][0];default:return ew[r.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(r.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=r.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=r.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Go(r.S,e.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(n=Go(s,2+a),e==="ss"?n.substr(0,2):"."+n.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:f=u,h=1;break}var m=h>0?Go(f,h):"";return m}function lu(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,a=t.substr(0,r);r!=t.length;r+=e)a+=(a.length>0?",":"")+t.substr(r,e);return a}var K4=/%/g;function r8(t,e,r){var a=e.replace(K4,""),n=e.length-a.length;return cc(t,a,r*Math.pow(10,2*n))+mn("%",n)}function a8(t,e,r){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return cc(t,e.substr(0,a),r/Math.pow(10,3*(e.length-a)))}function J4(t,e){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+J4(t,-e);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(e/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,h,m){return f+h+m.substr(0,(n+s)%n)+"."+m.substr(s)+"E"})}else r=e.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Z4=/# (\?+)( ?)\/( ?)(\d+)/;function n8(t,e,r){var a=parseInt(t[4],10),n=Math.round(e*a),s=Math.floor(n/a),o=n-s*a,u=a;return r+(s===0?"":""+s)+" "+(o===0?mn(" ",t[1].length+1+t[4].length):Q2(o,t[1].length)+t[2]+"/"+t[3]+Go(u,t[4].length))}function s8(t,e,r){return r+(e===0?"":""+e)+mn(" ",t[1].length+2+t[4].length)}var Q4=/^#*0*\.([0#]+)/,e3=/\).*[0#]/,t3=/\(###\) ###\\?-####/;function Ws(t){for(var e="",r,a=0;a!=t.length;++a)switch(r=t.charCodeAt(a)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function rw(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function aw(t,e){var r=t-Math.floor(t),a=Math.pow(10,e);return e<(""+Math.round(r*a)).length?0:Math.round(r*a)}function i8(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function o8(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function so(t,e,r){if(t.charCodeAt(0)===40&&!e.match(e3)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?so("n",a,r):"("+so("n",a,-r)+")"}if(e.charCodeAt(e.length-1)===44)return a8(t,e,r);if(e.indexOf("%")!==-1)return r8(t,e,r);if(e.indexOf("E")!==-1)return J4(e,r);if(e.charCodeAt(0)===36)return"$"+so(t,e.substr(e.charAt(1)==" "?2:1),r);var n,s,o,u,f=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+Oh(f,e.length);if(e.match(/^[#?]+$/))return n=Oh(r,0),n==="0"&&(n=""),n.length>e.length?n:Ws(e.substr(0,e.length-n.length))+n;if(s=e.match(Z4))return n8(s,f,h);if(e.match(/^#+0+$/))return h+Oh(f,e.length-e.indexOf("0"));if(s=e.match(Q4))return n=rw(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ws(s[1])).replace(/\.$/,"."+Ws(s[1])).replace(/\.(\d*)$/,function(b,_){return"."+_+mn("0",Ws(s[1]).length-_.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return h+rw(f,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return h+lu(Oh(f,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+so(t,e,-r):lu(""+(Math.floor(r)+i8(r,s[1].length)))+"."+Go(aw(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return so(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Vh(so(t,e.replace(/[\\-]/g,""),r)),o=0,Vh(Vh(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<n.length?n.charAt(o++):b==="0"?"0":""}));if(e.match(t3))return n=so(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),u=zp(f,Math.pow(10,o)-1,!1),n=""+h,m=cc("n",s[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+s[2]+"/"+s[3],m=Up(u[2],o),m.length<s[4].length&&(m=Ws(s[4].substr(s[4].length-m.length))+m),n+=m,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),u=zp(f,Math.pow(10,o)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Q2(u[1],o)+s[2]+"/"+s[3]+Up(u[2],o):mn(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=Oh(r,0),e.length<=n.length?n:Ws(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var v=e.indexOf(".")-o,y=e.length-n.length-v;return Ws(e.substr(0,v)+n+e.substr(e.length-y))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=aw(r,s[1].length),r<0?"-"+so(t,e,-r):lu(o8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Go(0,3-b.length):"")+b})+"."+Go(o,s[1].length);switch(e){case"###,##0.00":return so(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=lu(Oh(f,0));return g!=="0"?h+g:"";case"###,###.00":return so(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return so(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function l8(t,e,r){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return cc(t,e.substr(0,a),r/Math.pow(10,3*(e.length-a)))}function c8(t,e,r){var a=e.replace(K4,""),n=e.length-a.length;return cc(t,a,r*Math.pow(10,2*n))+mn("%",n)}function r3(t,e){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+r3(t,-e);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(e/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,h,m){return f+h+m.substr(0,(n+s)%n)+"."+m.substr(s)+"E"})}else r=e.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function _l(t,e,r){if(t.charCodeAt(0)===40&&!e.match(e3)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_l("n",a,r):"("+_l("n",a,-r)+")"}if(e.charCodeAt(e.length-1)===44)return l8(t,e,r);if(e.indexOf("%")!==-1)return c8(t,e,r);if(e.indexOf("E")!==-1)return r3(e,r);if(e.charCodeAt(0)===36)return"$"+_l(t,e.substr(e.charAt(1)==" "?2:1),r);var n,s,o,u,f=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+Go(f,e.length);if(e.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>e.length?n:Ws(e.substr(0,e.length-n.length))+n;if(s=e.match(Z4))return s8(s,f,h);if(e.match(/^#+0+$/))return h+Go(f,e.length-e.indexOf("0"));if(s=e.match(Q4))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Ws(s[1])).replace(/\.$/,"."+Ws(s[1])),n=n.replace(/\.(\d*)$/,function(b,_){return"."+_+mn("0",Ws(s[1]).length-_.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return h+lu(""+f);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_l(t,e,-r):lu(""+r)+"."+mn("0",s[1].length);if(s=e.match(/^#,#*,#0/))return _l(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Vh(_l(t,e.replace(/[\\-]/g,""),r)),o=0,Vh(Vh(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<n.length?n.charAt(o++):b==="0"?"0":""}));if(e.match(t3))return n=_l(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),u=zp(f,Math.pow(10,o)-1,!1),n=""+h,m=cc("n",s[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+s[2]+"/"+s[3],m=Up(u[2],o),m.length<s[4].length&&(m=Ws(s[4].substr(s[4].length-m.length))+m),n+=m,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),u=zp(f,Math.pow(10,o)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Q2(u[1],o)+s[2]+"/"+s[3]+Up(u[2],o):mn(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=""+r,e.length<=n.length?n:Ws(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var v=e.indexOf(".")-o,y=e.length-n.length-v;return Ws(e.substr(0,v)+n+e.substr(e.length-y))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+_l(t,e,-r):lu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Go(0,3-b.length):"")+b})+"."+Go(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=lu(""+f);return g!=="0"?h+g:"";default:if(e.match(/\.[0#?]*$/))return _l(t,e.slice(0,e.lastIndexOf(".")),r)+Ws(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function cc(t,e,r){return(r|0)===r?_l(t,e,r):so(t,e,r)}function u8(t){for(var e=[],r=!1,a=0,n=0;a<t.length;++a)switch(t.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:e[e.length]=t.substr(n,a-n),n=a+1}if(e[e.length]=t.substr(n),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var a3=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function cd(t){for(var e=0,r="",a="";e<t.length;)switch(r=t.charAt(e)){case"G":qp(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(a=r;t.charAt(e++)!=="]"&&e<t.length;)a+=t.charAt(e);if(a.match(a3))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function f8(t,e,r,a){for(var n=[],s="",o=0,u="",f="t",h,m,v,y="H";o<t.length;)switch(u=t.charAt(o)){case"G":if(!qp(t,o))throw new Error("unrecognized character "+u+" in "+t);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(v=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(v);n[n.length]={t:"t",v:s},++o;break;case"\\":var g=t.charAt(++o),b=g==="("||g===")"?g:"t";n[n.length]={t:b,v:g},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(h==null&&(h=ff(e,r,t.charAt(o+1)==="2"),h==null))return"";n[n.length]={t:"X",v:t.substr(o,2)},f=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=ff(e,r),h==null))return"";for(s=u;++o<t.length&&t.charAt(o).toLowerCase()===u;)s+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),n[n.length]={t:u,v:s},f=u;break;case"A":case"a":case"":var _={t:u,v:u};if(h==null&&(h=ff(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(_.v=h.H>=12?"P":"A"),_.t="T",y="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(_.v=h.H>=12?"PM":"AM"),_.t="T",o+=5,y="h"):t.substr(o,5).toUpperCase()==="/"?(h!=null&&(_.v=h.H>=12?"":""),_.t="T",o+=5,y="h"):(_.t="t",++o),h==null&&_.t==="T")return"";n[n.length]=_,f=u;break;case"[":for(s=u;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(a3)){if(h==null&&(h=ff(e,r),h==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},f=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",cd(t)||(n[n.length]={t:"t",v:s}));break;case".":if(h!=null){for(s=u;++o<t.length&&(u=t.charAt(o))==="0";)s+=u;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=u;++o<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(o))>-1;)s+=u;n[n.length]={t:"n",v:s};break;case"?":for(s=u;t.charAt(++o)===u;)s+=u;n[n.length]={t:u,v:s},f=u;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:a===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=u;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:u,v:u},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);n[n.length]={t:"t",v:u},++o;break}var S=0,E=0,C;for(o=n.length-1,f="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=y,f="h",S<1&&(S=1);break;case"s":(C=n[o].v.match(/\.0+$/))&&(E=Math.max(E,C[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":f=n[o].t;break;case"m":f==="s"&&(n[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&n[o].v.match(/[Hh]/)&&(S=1),S<2&&n[o].v.match(/[Mm]/)&&(S=2),S<3&&n[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var j="",R;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=t8(n[o].t.charCodeAt(0),n[o].v,h,E),n[o].t="t";break;case"n":case"?":for(R=o+1;n[R]!=null&&((u=n[R].t)==="?"||u==="D"||(u===" "||u==="t")&&n[R+1]!=null&&(n[R+1].t==="?"||n[R+1].t==="t"&&n[R+1].v==="/")||n[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(n[R].v==="/"||n[R].v===" "&&n[R+1]!=null&&n[R+1].t=="?"));)n[o].v+=n[R].v,n[R]={v:"",t:";"},++R;j+=n[o].v,o=R-1;break;case"G":n[o].t="t",n[o].v=vf(e,r);break}var H="",Y,U;if(j.length>0){j.charCodeAt(0)==40?(Y=e<0&&j.charCodeAt(0)===45?-e:e,U=cc("n",j,Y)):(Y=e<0&&a>1?-e:e,U=cc("n",j,Y),Y<0&&n[0]&&n[0].t=="t"&&(U=U.substr(1),n[0].v="-"+n[0].v)),R=U.length-1;var V=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){V=o;break}var F=n.length;if(V===n.length&&U.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(R>=n[o].v.length-1?(R-=n[o].v.length,n[o].v=U.substr(R+1,n[o].v.length)):R<0?n[o].v="":(n[o].v=U.substr(0,R+1),R=-1),n[o].t="t",F=o);R>=0&&F<n.length&&(n[F].v=U.substr(0,R+1)+n[F].v)}else if(V!==n.length&&U.indexOf("E")===-1){for(R=U.indexOf(".")-1,o=V;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(m=n[o].v.indexOf(".")>-1&&o===V?n[o].v.indexOf(".")-1:n[o].v.length-1,H=n[o].v.substr(m+1);m>=0;--m)R>=0&&(n[o].v.charAt(m)==="0"||n[o].v.charAt(m)==="#")&&(H=U.charAt(R--)+H);n[o].v=H,n[o].t="t",F=o}for(R>=0&&F<n.length&&(n[F].v=U.substr(0,R+1)+n[F].v),R=U.indexOf(".")+1,o=V;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==V)){for(m=n[o].v.indexOf(".")>-1&&o===V?n[o].v.indexOf(".")+1:0,H=n[o].v.substr(0,m);m<n[o].v.length;++m)R<U.length&&(H+=U.charAt(R++));n[o].v=H,n[o].t="t",F=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(Y=a>1&&e<0&&o>0&&n[o-1].v==="-"?-e:e,n[o].v=cc(n[o].t,n[o].v,Y),n[o].t="t");var X="";for(o=0;o!==n.length;++o)n[o]!=null&&(X+=n[o].v);return X}var nw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function sw(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function h8(t,e){var r=u8(t),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(nw),u=r[1].match(nw);return sw(e,o)?[a,r[0]]:sw(e,u)?[a,r[1]]:[a,r[o!=null&&u!=null?2:1]]}return[a,s]}function fo(t,e,r){r==null&&(r={});var a="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?a=r.dateNF:a=t;break;case"number":t==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:xr)[t],a==null&&(a=r.table&&r.table[tw[t]]||xr[tw[t]]),a==null&&(a=YT[t]||"General");break}if(qp(a,0))return vf(e,r);e instanceof Date&&(e=X4(e,r.date1904));var n=h8(a,e);if(qp(n[1]))return vf(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return f8(n[1],e,r,n[0])}function uc(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(xr[r]==null){e<0&&(e=r);continue}if(xr[r]==t){e=r;break}}e<0&&(e=391)}return xr[e]=t,e}function f1(t){for(var e=0;e!=392;++e)t[e]!==void 0&&uc(t[e],e)}function ud(){xr=GT()}var d8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},n3=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function m8(t){var e=typeof t=="number"?xr[t]:t;return e=e.replace(n3,"(\\d+)"),new RegExp("^"+e+"$")}function p8(t,e,r){var a=-1,n=-1,s=-1,o=-1,u=-1,f=-1;(e.match(n3)||[]).forEach(function(v,y){var g=parseInt(r[y+1],10);switch(v.toLowerCase().charAt(0)){case"y":a=g;break;case"d":s=g;break;case"h":o=g;break;case"s":f=g;break;case"m":o>=0?u=g:n=g;break}}),f>=0&&u==-1&&n>=0&&(u=n,n=-1);var h=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var m=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&u==-1&&f==-1?h:a==-1&&n==-1&&s==-1?m:h+"T"+m}var g8=(function(){var t={};t.version="1.2.0";function e(){for(var U=0,V=new Array(256),F=0;F!=256;++F)U=F,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,V[F]=U;return typeof Int32Array<"u"?new Int32Array(V):V}var r=e();function a(U){var V=0,F=0,X=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(X=0;X!=256;++X)P[X]=U[X];for(X=0;X!=256;++X)for(F=U[X],V=256+X;V<4096;V+=256)F=P[V]=F>>>8^U[F&255];var O=[];for(X=1;X!=16;++X)O[X-1]=typeof Int32Array<"u"?P.subarray(X*256,X*256+256):P.slice(X*256,X*256+256);return O}var n=a(r),s=n[0],o=n[1],u=n[2],f=n[3],h=n[4],m=n[5],v=n[6],y=n[7],g=n[8],b=n[9],_=n[10],S=n[11],E=n[12],C=n[13],j=n[14];function R(U,V){for(var F=V^-1,X=0,P=U.length;X<P;)F=F>>>8^r[(F^U.charCodeAt(X++))&255];return~F}function H(U,V){for(var F=V^-1,X=U.length-15,P=0;P<X;)F=j[U[P++]^F&255]^C[U[P++]^F>>8&255]^E[U[P++]^F>>16&255]^S[U[P++]^F>>>24]^_[U[P++]]^b[U[P++]]^g[U[P++]]^y[U[P++]]^v[U[P++]]^m[U[P++]]^h[U[P++]]^f[U[P++]]^u[U[P++]]^o[U[P++]]^s[U[P++]]^r[U[P++]];for(X+=15;P<X;)F=F>>>8^r[(F^U[P++])&255];return~F}function Y(U,V){for(var F=V^-1,X=0,P=U.length,O=0,I=0;X<P;)O=U.charCodeAt(X++),O<128?F=F>>>8^r[(F^O)&255]:O<2048?(F=F>>>8^r[(F^(192|O>>6&31))&255],F=F>>>8^r[(F^(128|O&63))&255]):O>=55296&&O<57344?(O=(O&1023)+64,I=U.charCodeAt(X++)&1023,F=F>>>8^r[(F^(240|O>>8&7))&255],F=F>>>8^r[(F^(128|O>>2&63))&255],F=F>>>8^r[(F^(128|I>>6&15|(O&3)<<4))&255],F=F>>>8^r[(F^(128|I&63))&255]):(F=F>>>8^r[(F^(224|O>>12&15))&255],F=F>>>8^r[(F^(128|O>>6&63))&255],F=F>>>8^r[(F^(128|O&63))&255]);return~F}return t.table=r,t.bstr=R,t.buf=H,t.str=Y,t})(),fr=(function(){var e={};e.version="1.2.1";function r(ae,je){for(var ge=ae.split("/"),xe=je.split("/"),Se=0,Ce=0,We=Math.min(ge.length,xe.length);Se<We;++Se){if(Ce=ge[Se].length-xe[Se].length)return Ce;if(ge[Se]!=xe[Se])return ge[Se]<xe[Se]?-1:1}return ge.length-xe.length}function a(ae){if(ae.charAt(ae.length-1)=="/")return ae.slice(0,-1).indexOf("/")===-1?ae:a(ae.slice(0,-1));var je=ae.lastIndexOf("/");return je===-1?ae:ae.slice(0,je+1)}function n(ae){if(ae.charAt(ae.length-1)=="/")return n(ae.slice(0,-1));var je=ae.lastIndexOf("/");return je===-1?ae:ae.slice(je+1)}function s(ae,je){typeof je=="string"&&(je=new Date(je));var ge=je.getHours();ge=ge<<6|je.getMinutes(),ge=ge<<5|je.getSeconds()>>>1,ae.write_shift(2,ge);var xe=je.getFullYear()-1980;xe=xe<<4|je.getMonth()+1,xe=xe<<5|je.getDate(),ae.write_shift(2,xe)}function o(ae){var je=ae.read_shift(2)&65535,ge=ae.read_shift(2)&65535,xe=new Date,Se=ge&31;ge>>>=5;var Ce=ge&15;ge>>>=4,xe.setMilliseconds(0),xe.setFullYear(ge+1980),xe.setMonth(Ce-1),xe.setDate(Se);var We=je&31;je>>>=5;var st=je&63;return je>>>=6,xe.setHours(je),xe.setMinutes(st),xe.setSeconds(We<<1),xe}function u(ae){ys(ae,0);for(var je={},ge=0;ae.l<=ae.length-4;){var xe=ae.read_shift(2),Se=ae.read_shift(2),Ce=ae.l+Se,We={};switch(xe){case 21589:ge=ae.read_shift(1),ge&1&&(We.mtime=ae.read_shift(4)),Se>5&&(ge&2&&(We.atime=ae.read_shift(4)),ge&4&&(We.ctime=ae.read_shift(4))),We.mtime&&(We.mt=new Date(We.mtime*1e3));break}ae.l=Ce,je[xe]=We}return je}var f;function h(){return f||(f={})}function m(ae,je){if(ae[0]==80&&ae[1]==75)return Rt(ae,je);if((ae[0]|32)==109&&(ae[1]|32)==105)return _t(ae,je);if(ae.length<512)throw new Error("CFB file size "+ae.length+" < 512");var ge=3,xe=512,Se=0,Ce=0,We=0,st=0,Ge=0,Ye=[],Je=ae.slice(0,512);ys(Je,0);var Nt=v(Je);switch(ge=Nt[0],ge){case 3:xe=512;break;case 4:xe=4096;break;case 0:if(Nt[1]==0)return Rt(ae,je);default:throw new Error("Major Version: Expected 3 or 4 saw "+ge)}xe!==512&&(Je=ae.slice(0,xe),ys(Je,28));var Ft=ae.slice(0,xe);y(Je,ge);var qt=Je.read_shift(4,"i");if(ge===3&&qt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qt);Je.l+=4,We=Je.read_shift(4,"i"),Je.l+=4,Je.chk("00100000","Mini Stream Cutoff Size: "),st=Je.read_shift(4,"i"),Se=Je.read_shift(4,"i"),Ge=Je.read_shift(4,"i"),Ce=Je.read_shift(4,"i");for(var Ot=-1,Mt=0;Mt<109&&(Ot=Je.read_shift(4,"i"),!(Ot<0));++Mt)Ye[Mt]=Ot;var Yt=g(ae,xe);S(Ge,Ce,Yt,xe,Ye);var oa=C(Yt,We,Ye,xe);oa[We].name="!Directory",Se>0&&st!==I&&(oa[st].name="!MiniFAT"),oa[Ye[0]].name="!FAT",oa.fat_addrs=Ye,oa.ssz=xe;var Fr={},fa=[],ls=[],pi=[];j(We,oa,Yt,fa,Se,Fr,ls,st),b(ls,pi,fa),fa.shift();var gi={FileIndex:ls,FullPaths:pi};return je&&je.raw&&(gi.raw={header:Ft,sectors:Yt}),gi}function v(ae){if(ae[ae.l]==80&&ae[ae.l+1]==75)return[0,0];ae.chk(W,"Header Signature: "),ae.l+=16;var je=ae.read_shift(2,"u");return[ae.read_shift(2,"u"),je]}function y(ae,je){var ge=9;switch(ae.l+=2,ge=ae.read_shift(2)){case 9:if(je!=3)throw new Error("Sector Shift: Expected 9 saw "+ge);break;case 12:if(je!=4)throw new Error("Sector Shift: Expected 12 saw "+ge);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ge)}ae.chk("0600","Mini Sector Shift: "),ae.chk("000000000000","Reserved: ")}function g(ae,je){for(var ge=Math.ceil(ae.length/je)-1,xe=[],Se=1;Se<ge;++Se)xe[Se-1]=ae.slice(Se*je,(Se+1)*je);return xe[ge-1]=ae.slice(ge*je),xe}function b(ae,je,ge){for(var xe=0,Se=0,Ce=0,We=0,st=0,Ge=ge.length,Ye=[],Je=[];xe<Ge;++xe)Ye[xe]=Je[xe]=xe,je[xe]=ge[xe];for(;st<Je.length;++st)xe=Je[st],Se=ae[xe].L,Ce=ae[xe].R,We=ae[xe].C,Ye[xe]===xe&&(Se!==-1&&Ye[Se]!==Se&&(Ye[xe]=Ye[Se]),Ce!==-1&&Ye[Ce]!==Ce&&(Ye[xe]=Ye[Ce])),We!==-1&&(Ye[We]=xe),Se!==-1&&xe!=Ye[xe]&&(Ye[Se]=Ye[xe],Je.lastIndexOf(Se)<st&&Je.push(Se)),Ce!==-1&&xe!=Ye[xe]&&(Ye[Ce]=Ye[xe],Je.lastIndexOf(Ce)<st&&Je.push(Ce));for(xe=1;xe<Ge;++xe)Ye[xe]===xe&&(Ce!==-1&&Ye[Ce]!==Ce?Ye[xe]=Ye[Ce]:Se!==-1&&Ye[Se]!==Se&&(Ye[xe]=Ye[Se]));for(xe=1;xe<Ge;++xe)if(ae[xe].type!==0){if(st=xe,st!=Ye[st])do st=Ye[st],je[xe]=je[st]+"/"+je[xe];while(st!==0&&Ye[st]!==-1&&st!=Ye[st]);Ye[xe]=-1}for(je[0]+="/",xe=1;xe<Ge;++xe)ae[xe].type!==2&&(je[xe]+="/")}function _(ae,je,ge){for(var xe=ae.start,Se=ae.size,Ce=[],We=xe;ge&&Se>0&&We>=0;)Ce.push(je.slice(We*O,We*O+O)),Se-=O,We=nf(ge,We*4);return Ce.length===0?lt(0):is(Ce).slice(0,ae.size)}function S(ae,je,ge,xe,Se){var Ce=I;if(ae===I){if(je!==0)throw new Error("DIFAT chain shorter than expected")}else if(ae!==-1){var We=ge[ae],st=(xe>>>2)-1;if(!We)return;for(var Ge=0;Ge<st&&(Ce=nf(We,Ge*4))!==I;++Ge)Se.push(Ce);S(nf(We,xe-4),je-1,ge,xe,Se)}}function E(ae,je,ge,xe,Se){var Ce=[],We=[];Se||(Se=[]);var st=xe-1,Ge=0,Ye=0;for(Ge=je;Ge>=0;){Se[Ge]=!0,Ce[Ce.length]=Ge,We.push(ae[Ge]);var Je=ge[Math.floor(Ge*4/xe)];if(Ye=Ge*4&st,xe<4+Ye)throw new Error("FAT boundary crossed: "+Ge+" 4 "+xe);if(!ae[Je])break;Ge=nf(ae[Je],Ye)}return{nodes:Ce,data:vw([We])}}function C(ae,je,ge,xe){var Se=ae.length,Ce=[],We=[],st=[],Ge=[],Ye=xe-1,Je=0,Nt=0,Ft=0,qt=0;for(Je=0;Je<Se;++Je)if(st=[],Ft=Je+je,Ft>=Se&&(Ft-=Se),!We[Ft]){Ge=[];var Ot=[];for(Nt=Ft;Nt>=0;){Ot[Nt]=!0,We[Nt]=!0,st[st.length]=Nt,Ge.push(ae[Nt]);var Mt=ge[Math.floor(Nt*4/xe)];if(qt=Nt*4&Ye,xe<4+qt)throw new Error("FAT boundary crossed: "+Nt+" 4 "+xe);if(!ae[Mt]||(Nt=nf(ae[Mt],qt),Ot[Nt]))break}Ce[Ft]={nodes:st,data:vw([Ge])}}return Ce}function j(ae,je,ge,xe,Se,Ce,We,st){for(var Ge=0,Ye=xe.length?2:0,Je=je[ae].data,Nt=0,Ft=0,qt;Nt<Je.length;Nt+=128){var Ot=Je.slice(Nt,Nt+128);ys(Ot,64),Ft=Ot.read_shift(2),qt=ox(Ot,0,Ft-Ye),xe.push(qt);var Mt={name:qt,type:Ot.read_shift(1),color:Ot.read_shift(1),L:Ot.read_shift(4,"i"),R:Ot.read_shift(4,"i"),C:Ot.read_shift(4,"i"),clsid:Ot.read_shift(16),state:Ot.read_shift(4,"i"),start:0,size:0},Yt=Ot.read_shift(2)+Ot.read_shift(2)+Ot.read_shift(2)+Ot.read_shift(2);Yt!==0&&(Mt.ct=R(Ot,Ot.l-8));var oa=Ot.read_shift(2)+Ot.read_shift(2)+Ot.read_shift(2)+Ot.read_shift(2);oa!==0&&(Mt.mt=R(Ot,Ot.l-8)),Mt.start=Ot.read_shift(4,"i"),Mt.size=Ot.read_shift(4,"i"),Mt.size<0&&Mt.start<0&&(Mt.size=Mt.type=0,Mt.start=I,Mt.name=""),Mt.type===5?(Ge=Mt.start,Se>0&&Ge!==I&&(je[Ge].name="!StreamData")):Mt.size>=4096?(Mt.storage="fat",je[Mt.start]===void 0&&(je[Mt.start]=E(ge,Mt.start,je.fat_addrs,je.ssz)),je[Mt.start].name=Mt.name,Mt.content=je[Mt.start].data.slice(0,Mt.size)):(Mt.storage="minifat",Mt.size<0?Mt.size=0:Ge!==I&&Mt.start!==I&&je[Ge]&&(Mt.content=_(Mt,je[Ge].data,(je[st]||{}).data))),Mt.content&&ys(Mt.content,0),Ce[qt]=Mt,We.push(Mt)}}function R(ae,je){return new Date((Di(ae,je+4)/1e7*Math.pow(2,32)+Di(ae,je)/1e7-11644473600)*1e3)}function H(ae,je){return h(),m(f.readFileSync(ae),je)}function Y(ae,je){var ge=je&&je.type;switch(ge||Lr&&Buffer.isBuffer(ae)&&(ge="buffer"),ge||"base64"){case"file":return H(ae,je);case"base64":return m(Pi(qi(ae)),je);case"binary":return m(Pi(ae),je)}return m(ae,je)}function U(ae,je){var ge=je||{},xe=ge.root||"Root Entry";if(ae.FullPaths||(ae.FullPaths=[]),ae.FileIndex||(ae.FileIndex=[]),ae.FullPaths.length!==ae.FileIndex.length)throw new Error("inconsistent CFB structure");ae.FullPaths.length===0&&(ae.FullPaths[0]=xe+"/",ae.FileIndex[0]={name:xe,type:5}),ge.CLSID&&(ae.FileIndex[0].clsid=ge.CLSID),V(ae)}function V(ae){var je="Sh33tJ5";if(!fr.find(ae,"/"+je)){var ge=lt(4);ge[0]=55,ge[1]=ge[3]=50,ge[2]=54,ae.FileIndex.push({name:je,type:2,content:ge,size:4,L:69,R:69,C:69}),ae.FullPaths.push(ae.FullPaths[0]+je),F(ae)}}function F(ae,je){U(ae);for(var ge=!1,xe=!1,Se=ae.FullPaths.length-1;Se>=0;--Se){var Ce=ae.FileIndex[Se];switch(Ce.type){case 0:xe?ge=!0:(ae.FileIndex.pop(),ae.FullPaths.pop());break;case 1:case 2:case 5:xe=!0,isNaN(Ce.R*Ce.L*Ce.C)&&(ge=!0),Ce.R>-1&&Ce.L>-1&&Ce.R==Ce.L&&(ge=!0);break;default:ge=!0;break}}if(!(!ge&&!je)){var We=new Date(1987,1,19),st=0,Ge=Object.create?Object.create(null):{},Ye=[];for(Se=0;Se<ae.FullPaths.length;++Se)Ge[ae.FullPaths[Se]]=!0,ae.FileIndex[Se].type!==0&&Ye.push([ae.FullPaths[Se],ae.FileIndex[Se]]);for(Se=0;Se<Ye.length;++Se){var Je=a(Ye[Se][0]);xe=Ge[Je],xe||(Ye.push([Je,{name:n(Je).replace("/",""),type:1,clsid:Q,ct:We,mt:We,content:null}]),Ge[Je]=!0)}for(Ye.sort(function(qt,Ot){return r(qt[0],Ot[0])}),ae.FullPaths=[],ae.FileIndex=[],Se=0;Se<Ye.length;++Se)ae.FullPaths[Se]=Ye[Se][0],ae.FileIndex[Se]=Ye[Se][1];for(Se=0;Se<Ye.length;++Se){var Nt=ae.FileIndex[Se],Ft=ae.FullPaths[Se];if(Nt.name=n(Ft).replace("/",""),Nt.L=Nt.R=Nt.C=-(Nt.color=1),Nt.size=Nt.content?Nt.content.length:0,Nt.start=0,Nt.clsid=Nt.clsid||Q,Se===0)Nt.C=Ye.length>1?1:-1,Nt.size=0,Nt.type=5;else if(Ft.slice(-1)=="/"){for(st=Se+1;st<Ye.length&&a(ae.FullPaths[st])!=Ft;++st);for(Nt.C=st>=Ye.length?-1:st,st=Se+1;st<Ye.length&&a(ae.FullPaths[st])!=a(Ft);++st);Nt.R=st>=Ye.length?-1:st,Nt.type=1}else a(ae.FullPaths[Se+1]||"")==a(Ft)&&(Nt.R=Se+1),Nt.type=2}}}function X(ae,je){var ge=je||{};if(ge.fileType=="mad")return mr(ae,ge);switch(F(ae),ge.fileType){case"zip":return Kt(ae,ge)}var xe=(function(qt){for(var Ot=0,Mt=0,Yt=0;Yt<qt.FileIndex.length;++Yt){var oa=qt.FileIndex[Yt];if(oa.content){var Fr=oa.content.length;Fr>0&&(Fr<4096?Ot+=Fr+63>>6:Mt+=Fr+511>>9)}}for(var fa=qt.FullPaths.length+3>>2,ls=Ot+7>>3,pi=Ot+127>>7,gi=ls+Mt+fa+pi,Is=gi+127>>7,Qo=Is<=109?0:Math.ceil((Is-109)/127);gi+Is+Qo+127>>7>Is;)Qo=++Is<=109?0:Math.ceil((Is-109)/127);var Da=[1,Qo,Is,pi,fa,Mt,Ot,0];return qt.FileIndex[0].size=Ot<<6,Da[7]=(qt.FileIndex[0].start=Da[0]+Da[1]+Da[2]+Da[3]+Da[4]+Da[5])+(Da[6]+7>>3),Da})(ae),Se=lt(xe[7]<<9),Ce=0,We=0;{for(Ce=0;Ce<8;++Ce)Se.write_shift(1,ne[Ce]);for(Ce=0;Ce<8;++Ce)Se.write_shift(2,0);for(Se.write_shift(2,62),Se.write_shift(2,3),Se.write_shift(2,65534),Se.write_shift(2,9),Se.write_shift(2,6),Ce=0;Ce<3;++Ce)Se.write_shift(2,0);for(Se.write_shift(4,0),Se.write_shift(4,xe[2]),Se.write_shift(4,xe[0]+xe[1]+xe[2]+xe[3]-1),Se.write_shift(4,0),Se.write_shift(4,4096),Se.write_shift(4,xe[3]?xe[0]+xe[1]+xe[2]-1:I),Se.write_shift(4,xe[3]),Se.write_shift(-4,xe[1]?xe[0]-1:I),Se.write_shift(4,xe[1]),Ce=0;Ce<109;++Ce)Se.write_shift(-4,Ce<xe[2]?xe[1]+Ce:-1)}if(xe[1])for(We=0;We<xe[1];++We){for(;Ce<236+We*127;++Ce)Se.write_shift(-4,Ce<xe[2]?xe[1]+Ce:-1);Se.write_shift(-4,We===xe[1]-1?I:We+1)}var st=function(qt){for(We+=qt;Ce<We-1;++Ce)Se.write_shift(-4,Ce+1);qt&&(++Ce,Se.write_shift(-4,I))};for(We=Ce=0,We+=xe[1];Ce<We;++Ce)Se.write_shift(-4,le.DIFSECT);for(We+=xe[2];Ce<We;++Ce)Se.write_shift(-4,le.FATSECT);st(xe[3]),st(xe[4]);for(var Ge=0,Ye=0,Je=ae.FileIndex[0];Ge<ae.FileIndex.length;++Ge)Je=ae.FileIndex[Ge],Je.content&&(Ye=Je.content.length,!(Ye<4096)&&(Je.start=We,st(Ye+511>>9)));for(st(xe[6]+7>>3);Se.l&511;)Se.write_shift(-4,le.ENDOFCHAIN);for(We=Ce=0,Ge=0;Ge<ae.FileIndex.length;++Ge)Je=ae.FileIndex[Ge],Je.content&&(Ye=Je.content.length,!(!Ye||Ye>=4096)&&(Je.start=We,st(Ye+63>>6)));for(;Se.l&511;)Se.write_shift(-4,le.ENDOFCHAIN);for(Ce=0;Ce<xe[4]<<2;++Ce){var Nt=ae.FullPaths[Ce];if(!Nt||Nt.length===0){for(Ge=0;Ge<17;++Ge)Se.write_shift(4,0);for(Ge=0;Ge<3;++Ge)Se.write_shift(4,-1);for(Ge=0;Ge<12;++Ge)Se.write_shift(4,0);continue}Je=ae.FileIndex[Ce],Ce===0&&(Je.start=Je.size?Je.start-1:I);var Ft=Ce===0&&ge.root||Je.name;if(Ye=2*(Ft.length+1),Se.write_shift(64,Ft,"utf16le"),Se.write_shift(2,Ye),Se.write_shift(1,Je.type),Se.write_shift(1,Je.color),Se.write_shift(-4,Je.L),Se.write_shift(-4,Je.R),Se.write_shift(-4,Je.C),Je.clsid)Se.write_shift(16,Je.clsid,"hex");else for(Ge=0;Ge<4;++Ge)Se.write_shift(4,0);Se.write_shift(4,Je.state||0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,Je.start),Se.write_shift(4,Je.size),Se.write_shift(4,0)}for(Ce=1;Ce<ae.FileIndex.length;++Ce)if(Je=ae.FileIndex[Ce],Je.size>=4096)if(Se.l=Je.start+1<<9,Lr&&Buffer.isBuffer(Je.content))Je.content.copy(Se,Se.l,0,Je.size),Se.l+=Je.size+511&-512;else{for(Ge=0;Ge<Je.size;++Ge)Se.write_shift(1,Je.content[Ge]);for(;Ge&511;++Ge)Se.write_shift(1,0)}for(Ce=1;Ce<ae.FileIndex.length;++Ce)if(Je=ae.FileIndex[Ce],Je.size>0&&Je.size<4096)if(Lr&&Buffer.isBuffer(Je.content))Je.content.copy(Se,Se.l,0,Je.size),Se.l+=Je.size+63&-64;else{for(Ge=0;Ge<Je.size;++Ge)Se.write_shift(1,Je.content[Ge]);for(;Ge&63;++Ge)Se.write_shift(1,0)}if(Lr)Se.l=Se.length;else for(;Se.l<Se.length;)Se.write_shift(1,0);return Se}function P(ae,je){var ge=ae.FullPaths.map(function(Ge){return Ge.toUpperCase()}),xe=ge.map(function(Ge){var Ye=Ge.split("/");return Ye[Ye.length-(Ge.slice(-1)=="/"?2:1)]}),Se=!1;je.charCodeAt(0)===47?(Se=!0,je=ge[0].slice(0,-1)+je):Se=je.indexOf("/")!==-1;var Ce=je.toUpperCase(),We=Se===!0?ge.indexOf(Ce):xe.indexOf(Ce);if(We!==-1)return ae.FileIndex[We];var st=!Ce.match(a0);for(Ce=Ce.replace(Gs,""),st&&(Ce=Ce.replace(a0,"!")),We=0;We<ge.length;++We)if((st?ge[We].replace(a0,"!"):ge[We]).replace(Gs,"")==Ce||(st?xe[We].replace(a0,"!"):xe[We]).replace(Gs,"")==Ce)return ae.FileIndex[We];return null}var O=64,I=-2,W="d0cf11e0a1b11ae1",ne=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:I,FREESECT:-1,HEADER_SIGNATURE:W,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(ae,je,ge){h();var xe=X(ae,ge);f.writeFileSync(je,xe)}function K(ae){for(var je=new Array(ae.length),ge=0;ge<ae.length;++ge)je[ge]=String.fromCharCode(ae[ge]);return je.join("")}function ue(ae,je){var ge=X(ae,je);switch(je&&je.type||"buffer"){case"file":return h(),f.writeFileSync(je.filename,ge),ge;case"binary":return typeof ge=="string"?ge:K(ge);case"base64":return k0(typeof ge=="string"?ge:K(ge));case"buffer":if(Lr)return Buffer.isBuffer(ge)?ge:gc(ge);case"array":return typeof ge=="string"?Pi(ge):ge}return ge}var M;function A(ae){try{var je=ae.InflateRaw,ge=new je;if(ge._processChunk(new Uint8Array([3,0]),ge._finishFlushFlag),ge.bytesRead)M=ae;else throw new Error("zlib does not expose bytesRead")}catch(xe){console.error("cannot use native zlib: "+(xe.message||xe))}}function D(ae,je){if(!M)return Ue(ae,je);var ge=M.InflateRaw,xe=new ge,Se=xe._processChunk(ae.slice(ae.l),xe._finishFlushFlag);return ae.l+=xe.bytesRead,Se}function B(ae){return M?M.deflateRawSync(ae):ft(ae)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(ae){var je=(ae<<1|ae<<11)&139536|(ae<<5|ae<<15)&558144;return(je>>16|je>>8|je)&255}for(var _e=typeof Uint8Array<"u",be=_e?new Uint8Array(256):[],Le=0;Le<256;++Le)be[Le]=pe(Le);function he(ae,je){var ge=be[ae&255];return je<=8?ge>>>8-je:(ge=ge<<8|be[ae>>8&255],je<=16?ge>>>16-je:(ge=ge<<8|be[ae>>16&255],ge>>>24-je))}function Ae(ae,je){var ge=je&7,xe=je>>>3;return(ae[xe]|(ge<=6?0:ae[xe+1]<<8))>>>ge&3}function de(ae,je){var ge=je&7,xe=je>>>3;return(ae[xe]|(ge<=5?0:ae[xe+1]<<8))>>>ge&7}function re(ae,je){var ge=je&7,xe=je>>>3;return(ae[xe]|(ge<=4?0:ae[xe+1]<<8))>>>ge&15}function Ke(ae,je){var ge=je&7,xe=je>>>3;return(ae[xe]|(ge<=3?0:ae[xe+1]<<8))>>>ge&31}function Oe(ae,je){var ge=je&7,xe=je>>>3;return(ae[xe]|(ge<=1?0:ae[xe+1]<<8))>>>ge&127}function rt(ae,je,ge){var xe=je&7,Se=je>>>3,Ce=(1<<ge)-1,We=ae[Se]>>>xe;return ge<8-xe||(We|=ae[Se+1]<<8-xe,ge<16-xe)||(We|=ae[Se+2]<<16-xe,ge<24-xe)||(We|=ae[Se+3]<<24-xe),We&Ce}function tt(ae,je,ge){var xe=je&7,Se=je>>>3;return xe<=5?ae[Se]|=(ge&7)<<xe:(ae[Se]|=ge<<xe&255,ae[Se+1]=(ge&7)>>8-xe),je+3}function Et(ae,je,ge){var xe=je&7,Se=je>>>3;return ge=(ge&1)<<xe,ae[Se]|=ge,je+1}function kt(ae,je,ge){var xe=je&7,Se=je>>>3;return ge<<=xe,ae[Se]|=ge&255,ge>>>=8,ae[Se+1]=ge,je+8}function zt(ae,je,ge){var xe=je&7,Se=je>>>3;return ge<<=xe,ae[Se]|=ge&255,ge>>>=8,ae[Se+1]=ge&255,ae[Se+2]=ge>>>8,je+16}function Tt(ae,je){var ge=ae.length,xe=2*ge>je?2*ge:je+5,Se=0;if(ge>=je)return ae;if(Lr){var Ce=Zb(xe);if(ae.copy)ae.copy(Ce);else for(;Se<ae.length;++Se)Ce[Se]=ae[Se];return Ce}else if(_e){var We=new Uint8Array(xe);if(We.set)We.set(ae);else for(;Se<ge;++Se)We[Se]=ae[Se];return We}return ae.length=xe,ae}function at(ae){for(var je=new Array(ae),ge=0;ge<ae;++ge)je[ge]=0;return je}function pt(ae,je,ge){var xe=1,Se=0,Ce=0,We=0,st=0,Ge=ae.length,Ye=_e?new Uint16Array(32):at(32);for(Ce=0;Ce<32;++Ce)Ye[Ce]=0;for(Ce=Ge;Ce<ge;++Ce)ae[Ce]=0;Ge=ae.length;var Je=_e?new Uint16Array(Ge):at(Ge);for(Ce=0;Ce<Ge;++Ce)Ye[Se=ae[Ce]]++,xe<Se&&(xe=Se),Je[Ce]=0;for(Ye[0]=0,Ce=1;Ce<=xe;++Ce)Ye[Ce+16]=st=st+Ye[Ce-1]<<1;for(Ce=0;Ce<Ge;++Ce)st=ae[Ce],st!=0&&(Je[Ce]=Ye[st+16]++);var Nt=0;for(Ce=0;Ce<Ge;++Ce)if(Nt=ae[Ce],Nt!=0)for(st=he(Je[Ce],xe)>>xe-Nt,We=(1<<xe+4-Nt)-1;We>=0;--We)je[st|We<<Nt]=Nt&15|Ce<<4;return xe}var At=_e?new Uint16Array(512):at(512),Dt=_e?new Uint16Array(32):at(32);if(!_e){for(var xt=0;xt<512;++xt)At[xt]=0;for(xt=0;xt<32;++xt)Dt[xt]=0}(function(){for(var ae=[],je=0;je<32;je++)ae.push(5);pt(ae,Dt,32);var ge=[];for(je=0;je<=143;je++)ge.push(8);for(;je<=255;je++)ge.push(9);for(;je<=279;je++)ge.push(7);for(;je<=287;je++)ge.push(8);pt(ge,At,288)})();var St=(function(){for(var je=_e?new Uint8Array(32768):[],ge=0,xe=0;ge<oe.length-1;++ge)for(;xe<oe[ge+1];++xe)je[xe]=ge;for(;xe<32768;++xe)je[xe]=29;var Se=_e?new Uint8Array(259):[];for(ge=0,xe=0;ge<Z.length-1;++ge)for(;xe<Z[ge+1];++xe)Se[xe]=ge;function Ce(st,Ge){for(var Ye=0;Ye<st.length;){var Je=Math.min(65535,st.length-Ye),Nt=Ye+Je==st.length;for(Ge.write_shift(1,+Nt),Ge.write_shift(2,Je),Ge.write_shift(2,~Je&65535);Je-- >0;)Ge[Ge.l++]=st[Ye++]}return Ge.l}function We(st,Ge){for(var Ye=0,Je=0,Nt=_e?new Uint16Array(32768):[];Je<st.length;){var Ft=Math.min(65535,st.length-Je);if(Ft<10){for(Ye=tt(Ge,Ye,+(Je+Ft==st.length)),Ye&7&&(Ye+=8-(Ye&7)),Ge.l=Ye/8|0,Ge.write_shift(2,Ft),Ge.write_shift(2,~Ft&65535);Ft-- >0;)Ge[Ge.l++]=st[Je++];Ye=Ge.l*8;continue}Ye=tt(Ge,Ye,+(Je+Ft==st.length)+2);for(var qt=0;Ft-- >0;){var Ot=st[Je];qt=(qt<<5^Ot)&32767;var Mt=-1,Yt=0;if((Mt=Nt[qt])&&(Mt|=Je&-32768,Mt>Je&&(Mt-=32768),Mt<Je))for(;st[Mt+Yt]==st[Je+Yt]&&Yt<250;)++Yt;if(Yt>2){Ot=Se[Yt],Ot<=22?Ye=kt(Ge,Ye,be[Ot+1]>>1)-1:(kt(Ge,Ye,3),Ye+=5,kt(Ge,Ye,be[Ot-23]>>5),Ye+=3);var oa=Ot<8?0:Ot-4>>2;oa>0&&(zt(Ge,Ye,Yt-Z[Ot]),Ye+=oa),Ot=je[Je-Mt],Ye=kt(Ge,Ye,be[Ot]>>3),Ye-=3;var Fr=Ot<4?0:Ot-2>>1;Fr>0&&(zt(Ge,Ye,Je-Mt-oe[Ot]),Ye+=Fr);for(var fa=0;fa<Yt;++fa)Nt[qt]=Je&32767,qt=(qt<<5^st[Je])&32767,++Je;Ft-=Yt-1}else Ot<=143?Ot=Ot+48:Ye=Et(Ge,Ye,1),Ye=kt(Ge,Ye,be[Ot]),Nt[qt]=Je&32767,++Je}Ye=kt(Ge,Ye,0)-1}return Ge.l=(Ye+7)/8|0,Ge.l}return function(Ge,Ye){return Ge.length<8?Ce(Ge,Ye):We(Ge,Ye)}})();function ft(ae){var je=lt(50+Math.floor(ae.length*1.1)),ge=St(ae,je);return je.slice(0,ge)}var yt=_e?new Uint16Array(32768):at(32768),er=_e?new Uint16Array(32768):at(32768),Lt=_e?new Uint16Array(128):at(128),Bt=1,we=1;function Ie(ae,je){var ge=Ke(ae,je)+257;je+=5;var xe=Ke(ae,je)+1;je+=5;var Se=re(ae,je)+4;je+=4;for(var Ce=0,We=_e?new Uint8Array(19):at(19),st=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ge=1,Ye=_e?new Uint8Array(8):at(8),Je=_e?new Uint8Array(8):at(8),Nt=We.length,Ft=0;Ft<Se;++Ft)We[q[Ft]]=Ce=de(ae,je),Ge<Ce&&(Ge=Ce),Ye[Ce]++,je+=3;var qt=0;for(Ye[0]=0,Ft=1;Ft<=Ge;++Ft)Je[Ft]=qt=qt+Ye[Ft-1]<<1;for(Ft=0;Ft<Nt;++Ft)(qt=We[Ft])!=0&&(st[Ft]=Je[qt]++);var Ot=0;for(Ft=0;Ft<Nt;++Ft)if(Ot=We[Ft],Ot!=0){qt=be[st[Ft]]>>8-Ot;for(var Mt=(1<<7-Ot)-1;Mt>=0;--Mt)Lt[qt|Mt<<Ot]=Ot&7|Ft<<3}var Yt=[];for(Ge=1;Yt.length<ge+xe;)switch(qt=Lt[Oe(ae,je)],je+=qt&7,qt>>>=3){case 16:for(Ce=3+Ae(ae,je),je+=2,qt=Yt[Yt.length-1];Ce-- >0;)Yt.push(qt);break;case 17:for(Ce=3+de(ae,je),je+=3;Ce-- >0;)Yt.push(0);break;case 18:for(Ce=11+Oe(ae,je),je+=7;Ce-- >0;)Yt.push(0);break;default:Yt.push(qt),Ge<qt&&(Ge=qt);break}var oa=Yt.slice(0,ge),Fr=Yt.slice(ge);for(Ft=ge;Ft<286;++Ft)oa[Ft]=0;for(Ft=xe;Ft<30;++Ft)Fr[Ft]=0;return Bt=pt(oa,yt,286),we=pt(Fr,er,30),je}function ve(ae,je){if(ae[0]==3&&!(ae[1]&3))return[hu(je),2];for(var ge=0,xe=0,Se=Zb(je||1<<18),Ce=0,We=Se.length>>>0,st=0,Ge=0;(xe&1)==0;){if(xe=de(ae,ge),ge+=3,xe>>>1)xe>>1==1?(st=9,Ge=5):(ge=Ie(ae,ge),st=Bt,Ge=we);else{ge&7&&(ge+=8-(ge&7));var Ye=ae[ge>>>3]|ae[(ge>>>3)+1]<<8;if(ge+=32,Ye>0)for(!je&&We<Ce+Ye&&(Se=Tt(Se,Ce+Ye),We=Se.length);Ye-- >0;)Se[Ce++]=ae[ge>>>3],ge+=8;continue}for(;;){!je&&We<Ce+32767&&(Se=Tt(Se,Ce+32767),We=Se.length);var Je=rt(ae,ge,st),Nt=xe>>>1==1?At[Je]:yt[Je];if(ge+=Nt&15,Nt>>>=4,(Nt>>>8&255)===0)Se[Ce++]=Nt;else{if(Nt==256)break;Nt-=257;var Ft=Nt<8?0:Nt-4>>2;Ft>5&&(Ft=0);var qt=Ce+Z[Nt];Ft>0&&(qt+=rt(ae,ge,Ft),ge+=Ft),Je=rt(ae,ge,Ge),Nt=xe>>>1==1?Dt[Je]:er[Je],ge+=Nt&15,Nt>>>=4;var Ot=Nt<4?0:Nt-2>>1,Mt=oe[Nt];for(Ot>0&&(Mt+=rt(ae,ge,Ot),ge+=Ot),!je&&We<qt&&(Se=Tt(Se,qt+100),We=Se.length);Ce<qt;)Se[Ce]=Se[Ce-Mt],++Ce}}}return je?[Se,ge+7>>>3]:[Se.slice(0,Ce),ge+7>>>3]}function Ue(ae,je){var ge=ae.slice(ae.l||0),xe=ve(ge,je);return ae.l+=xe[1],xe[0]}function Be(ae,je){if(ae)typeof console<"u"&&console.error(je);else throw new Error(je)}function Rt(ae,je){var ge=ae;ys(ge,0);var xe=[],Se=[],Ce={FileIndex:xe,FullPaths:Se};U(Ce,{root:je.root});for(var We=ge.length-4;(ge[We]!=80||ge[We+1]!=75||ge[We+2]!=5||ge[We+3]!=6)&&We>=0;)--We;ge.l=We+4,ge.l+=4;var st=ge.read_shift(2);ge.l+=6;var Ge=ge.read_shift(4);for(ge.l=Ge,We=0;We<st;++We){ge.l+=20;var Ye=ge.read_shift(4),Je=ge.read_shift(4),Nt=ge.read_shift(2),Ft=ge.read_shift(2),qt=ge.read_shift(2);ge.l+=8;var Ot=ge.read_shift(4),Mt=u(ge.slice(ge.l+Nt,ge.l+Nt+Ft));ge.l+=Nt+Ft+qt;var Yt=ge.l;ge.l=Ot+4,Ht(ge,Ye,Je,Ce,Mt),ge.l=Yt}return Ce}function Ht(ae,je,ge,xe,Se){ae.l+=2;var Ce=ae.read_shift(2),We=ae.read_shift(2),st=o(ae);if(Ce&8257)throw new Error("Unsupported ZIP encryption");for(var Ge=ae.read_shift(4),Ye=ae.read_shift(4),Je=ae.read_shift(4),Nt=ae.read_shift(2),Ft=ae.read_shift(2),qt="",Ot=0;Ot<Nt;++Ot)qt+=String.fromCharCode(ae[ae.l++]);if(Ft){var Mt=u(ae.slice(ae.l,ae.l+Ft));(Mt[21589]||{}).mt&&(st=Mt[21589].mt),((Se||{})[21589]||{}).mt&&(st=Se[21589].mt)}ae.l+=Ft;var Yt=ae.slice(ae.l,ae.l+Ye);switch(We){case 8:Yt=D(ae,Je);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+We)}var oa=!1;Ce&8&&(Ge=ae.read_shift(4),Ge==134695760&&(Ge=ae.read_shift(4),oa=!0),Ye=ae.read_shift(4),Je=ae.read_shift(4)),Ye!=je&&Be(oa,"Bad compressed size: "+je+" != "+Ye),Je!=ge&&Be(oa,"Bad uncompressed size: "+ge+" != "+Je),qr(xe,qt,Yt,{unsafe:!0,mt:st})}function Kt(ae,je){var ge=je||{},xe=[],Se=[],Ce=lt(1),We=ge.compression?8:0,st=0,Ge=0,Ye=0,Je=0,Nt=0,Ft=ae.FullPaths[0],qt=Ft,Ot=ae.FileIndex[0],Mt=[],Yt=0;for(Ge=1;Ge<ae.FullPaths.length;++Ge)if(qt=ae.FullPaths[Ge].slice(Ft.length),Ot=ae.FileIndex[Ge],!(!Ot.size||!Ot.content||qt=="Sh33tJ5")){var oa=Je,Fr=lt(qt.length);for(Ye=0;Ye<qt.length;++Ye)Fr.write_shift(1,qt.charCodeAt(Ye)&127);Fr=Fr.slice(0,Fr.l),Mt[Nt]=g8.buf(Ot.content,0);var fa=Ot.content;We==8&&(fa=B(fa)),Ce=lt(30),Ce.write_shift(4,67324752),Ce.write_shift(2,20),Ce.write_shift(2,st),Ce.write_shift(2,We),Ot.mt?s(Ce,Ot.mt):Ce.write_shift(4,0),Ce.write_shift(-4,Mt[Nt]),Ce.write_shift(4,fa.length),Ce.write_shift(4,Ot.content.length),Ce.write_shift(2,Fr.length),Ce.write_shift(2,0),Je+=Ce.length,xe.push(Ce),Je+=Fr.length,xe.push(Fr),Je+=fa.length,xe.push(fa),Ce=lt(46),Ce.write_shift(4,33639248),Ce.write_shift(2,0),Ce.write_shift(2,20),Ce.write_shift(2,st),Ce.write_shift(2,We),Ce.write_shift(4,0),Ce.write_shift(-4,Mt[Nt]),Ce.write_shift(4,fa.length),Ce.write_shift(4,Ot.content.length),Ce.write_shift(2,Fr.length),Ce.write_shift(2,0),Ce.write_shift(2,0),Ce.write_shift(2,0),Ce.write_shift(2,0),Ce.write_shift(4,0),Ce.write_shift(4,oa),Yt+=Ce.l,Se.push(Ce),Yt+=Fr.length,Se.push(Fr),++Nt}return Ce=lt(22),Ce.write_shift(4,101010256),Ce.write_shift(2,0),Ce.write_shift(2,0),Ce.write_shift(2,Nt),Ce.write_shift(2,Nt),Ce.write_shift(4,Yt),Ce.write_shift(4,Je),Ce.write_shift(2,0),is([is(xe),is(Se),Ce])}var $t={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Nr(ae,je){if(ae.ctype)return ae.ctype;var ge=ae.name||"",xe=ge.match(/\.([^\.]+)$/);return xe&&$t[xe[1]]||je&&(xe=(ge=je).match(/[\.\\]([^\.\\])+$/),xe&&$t[xe[1]])?$t[xe[1]]:"application/octet-stream"}function Jn(ae){for(var je=k0(ae),ge=[],xe=0;xe<je.length;xe+=76)ge.push(je.slice(xe,xe+76));return ge.join(`\r
`)+`\r
`}function ja(ae){var je=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ye){var Je=Ye.charCodeAt(0).toString(16).toUpperCase();return"="+(Je.length==1?"0"+Je:Je)});je=je.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),je.charAt(0)==`
`&&(je="=0D"+je.slice(1)),je=je.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ge=[],xe=je.split(`\r
`),Se=0;Se<xe.length;++Se){var Ce=xe[Se];if(Ce.length==0){ge.push("");continue}for(var We=0;We<Ce.length;){var st=76,Ge=Ce.slice(We,We+st);Ge.charAt(st-1)=="="?st--:Ge.charAt(st-2)=="="?st-=2:Ge.charAt(st-3)=="="&&(st-=3),Ge=Ce.slice(We,We+st),We+=st,We<Ce.length&&(Ge+="="),ge.push(Ge)}}return ge.join(`\r
`)}function Ct(ae){for(var je=[],ge=0;ge<ae.length;++ge){for(var xe=ae[ge];ge<=ae.length&&xe.charAt(xe.length-1)=="=";)xe=xe.slice(0,xe.length-1)+ae[++ge];je.push(xe)}for(var Se=0;Se<je.length;++Se)je[Se]=je[Se].replace(/[=][0-9A-Fa-f]{2}/g,function(Ce){return String.fromCharCode(parseInt(Ce.slice(1),16))});return Pi(je.join(`\r
`))}function Ha(ae,je,ge){for(var xe="",Se="",Ce="",We,st=0;st<10;++st){var Ge=je[st];if(!Ge||Ge.match(/^\s*$/))break;var Ye=Ge.match(/^(.*?):\s*([^\s].*)$/);if(Ye)switch(Ye[1].toLowerCase()){case"content-location":xe=Ye[2].trim();break;case"content-type":Ce=Ye[2].trim();break;case"content-transfer-encoding":Se=Ye[2].trim();break}}switch(++st,Se.toLowerCase()){case"base64":We=Pi(qi(je.slice(st).join("")));break;case"quoted-printable":We=Ct(je.slice(st));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Se)}var Je=qr(ae,xe.slice(ge.length),We,{unsafe:!0});Ce&&(Je.ctype=Ce)}function _t(ae,je){if(K(ae.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ge=je&&je.root||"",xe=(Lr&&Buffer.isBuffer(ae)?ae.toString("binary"):K(ae)).split(`\r
`),Se=0,Ce="";for(Se=0;Se<xe.length;++Se)if(Ce=xe[Se],!!/^Content-Location:/i.test(Ce)&&(Ce=Ce.slice(Ce.indexOf("file")),ge||(ge=Ce.slice(0,Ce.lastIndexOf("/")+1)),Ce.slice(0,ge.length)!=ge))for(;ge.length>0&&(ge=ge.slice(0,ge.length-1),ge=ge.slice(0,ge.lastIndexOf("/")+1),Ce.slice(0,ge.length)!=ge););var We=(xe[1]||"").match(/boundary="(.*?)"/);if(!We)throw new Error("MAD cannot find boundary");var st="--"+(We[1]||""),Ge=[],Ye=[],Je={FileIndex:Ge,FullPaths:Ye};U(Je);var Nt,Ft=0;for(Se=0;Se<xe.length;++Se){var qt=xe[Se];qt!==st&&qt!==st+"--"||(Ft++&&Ha(Je,xe.slice(Nt,Se),ge),Nt=Se)}return Je}function mr(ae,je){var ge=je||{},xe=ge.boundary||"SheetJS";xe="------="+xe;for(var Se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+xe.slice(2)+'"',"","",""],Ce=ae.FullPaths[0],We=Ce,st=ae.FileIndex[0],Ge=1;Ge<ae.FullPaths.length;++Ge)if(We=ae.FullPaths[Ge].slice(Ce.length),st=ae.FileIndex[Ge],!(!st.size||!st.content||We=="Sh33tJ5")){We=We.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Yt){return"_x"+Yt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Yt){return"_u"+Yt.charCodeAt(0).toString(16)+"_"});for(var Ye=st.content,Je=Lr&&Buffer.isBuffer(Ye)?Ye.toString("binary"):K(Ye),Nt=0,Ft=Math.min(1024,Je.length),qt=0,Ot=0;Ot<=Ft;++Ot)(qt=Je.charCodeAt(Ot))>=32&&qt<128&&++Nt;var Mt=Nt>=Ft*4/5;Se.push(xe),Se.push("Content-Location: "+(ge.root||"file:///C:/SheetJS/")+We),Se.push("Content-Transfer-Encoding: "+(Mt?"quoted-printable":"base64")),Se.push("Content-Type: "+Nr(st,We)),Se.push(""),Se.push(Mt?ja(Je):Jn(Je))}return Se.push(xe+`--\r
`),Se.join(`\r
`)}function Jr(ae){var je={};return U(je,ae),je}function qr(ae,je,ge,xe){var Se=xe&&xe.unsafe;Se||U(ae);var Ce=!Se&&fr.find(ae,je);if(!Ce){var We=ae.FullPaths[0];je.slice(0,We.length)==We?We=je:(We.slice(-1)!="/"&&(We+="/"),We=(We+je).replace("//","/")),Ce={name:n(je),type:2},ae.FileIndex.push(Ce),ae.FullPaths.push(We),Se||fr.utils.cfb_gc(ae)}return Ce.content=ge,Ce.size=ge?ge.length:0,xe&&(xe.CLSID&&(Ce.clsid=xe.CLSID),xe.mt&&(Ce.mt=xe.mt),xe.ct&&(Ce.ct=xe.ct)),Ce}function Xa(ae,je){U(ae);var ge=fr.find(ae,je);if(ge){for(var xe=0;xe<ae.FileIndex.length;++xe)if(ae.FileIndex[xe]==ge)return ae.FileIndex.splice(xe,1),ae.FullPaths.splice(xe,1),!0}return!1}function $r(ae,je,ge){U(ae);var xe=fr.find(ae,je);if(xe){for(var Se=0;Se<ae.FileIndex.length;++Se)if(ae.FileIndex[Se]==xe)return ae.FileIndex[Se].name=n(ge),ae.FullPaths[Se]=ge,!0}return!1}function Ea(ae){F(ae,!0)}return e.find=P,e.read=Y,e.parse=m,e.write=ue,e.writeFile=ee,e.utils={cfb_new:Jr,cfb_add:qr,cfb_del:Xa,cfb_mov:$r,cfb_gc:Ea,ReadShift:l0,CheckField:j3,prep_blob:ys,bconcat:is,use_zlib:A,_deflateRaw:ft,_inflateRaw:Ue,consts:le},e})();function v8(t){return typeof t=="string"?u1(t):Array.isArray(t)?HT(t):t}function H0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=u1(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var a=r=="utf8"?kl(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,t);if(typeof Blob<"u"){var n=new Blob([v8(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,t);if(typeof saveAs<"u")return saveAs(n,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=xu(e)),u.write(e),u.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function x8(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+t)}function gn(t){for(var e=Object.keys(t),r=[],a=0;a<e.length;++a)Object.prototype.hasOwnProperty.call(t,e[a])&&r.push(e[a]);return r}function iw(t,e){for(var r=[],a=gn(t),n=0;n!==a.length;++n)r[t[a[n]][e]]==null&&(r[t[a[n]][e]]=a[n]);return r}function h1(t){for(var e=[],r=gn(t),a=0;a!==r.length;++a)e[t[r[a]]]=r[a];return e}function d1(t){for(var e=[],r=gn(t),a=0;a!==r.length;++a)e[t[r[a]]]=parseInt(r[a],10);return e}function y8(t){for(var e=[],r=gn(t),a=0;a!==r.length;++a)e[t[r[a]]]==null&&(e[t[r[a]]]=[]),e[t[r[a]]].push(r[a]);return e}var Hp=new Date(1899,11,30,0,0,0);function Kn(t,e){var r=t.getTime(),a=Hp.getTime()+(t.getTimezoneOffset()-Hp.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var s3=new Date,_8=Hp.getTime()+(s3.getTimezoneOffset()-Hp.getTimezoneOffset())*6e4,ow=s3.getTimezoneOffset();function m1(t){var e=new Date;return e.setTime(t*24*60*60*1e3+_8),e.getTimezoneOffset()!==ow&&e.setTime(e.getTime()+(e.getTimezoneOffset()-ow)*6e4),e}function b8(t){var e=0,r=0,a=!1,n=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(n[s],10)}return e}var lw=new Date("2017-02-19T19:06:09.000Z"),i3=isNaN(lw.getFullYear())?new Date("2/19/17"):lw,w8=i3.getFullYear()==2017;function qa(t,e){var r=new Date(t);if(w8)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(i3.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return t.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function xf(t,e){if(Lr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return kl(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return kl(G4(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return kl(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return kl(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var a=[],n=0;n!=t.length;++n)a.push(String.fromCharCode(t[n]));return a.join("")}function za(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=za(t[r]));return e}function mn(t,e){for(var r="";r.length<e;)r+=t;return r}function Yo(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,a=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return r=-r,s}),!isNaN(e=Number(a)))?e/r:e}var S8=["january","february","march","april","may","june","july","august","september","october","november","december"];function rd(t){var e=new Date(t),r=new Date(NaN),a=e.getYear(),n=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&S8.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&a!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var N8=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(t||typeof a=="string")return r.split(a);for(var s=r.split(a),o=[s[0]],u=1;u<s.length;++u)o.push(n),o.push(s[u]);return o}})();function o3(t){return t?t.content&&t.type?xf(t.content,!0):t.data?r0(t.data):t.asNodeBuffer&&Lr?r0(t.asNodeBuffer().toString("binary")):t.asBinary?r0(t.asBinary()):t._data&&t._data.getContent?r0(xf(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function l3(t){if(!t)return null;if(t.data)return Kb(t.data);if(t.asNodeBuffer&&Lr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Kb(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function k8(t){return t&&t.name.slice(-4)===".bin"?l3(t):o3(t)}function lo(t,e){for(var r=t.FullPaths||gn(t.files),a=e.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||n==o)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function tx(t,e){var r=lo(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Ln(t,e,r){if(!r)return k8(tx(t,e));if(!e)return null;try{return Ln(t,e)}catch{return null}}function Mi(t,e,r){if(!r)return o3(tx(t,e));if(!e)return null;try{return Mi(t,e)}catch{return null}}function j8(t,e,r){return l3(tx(t,e))}function cw(t){for(var e=t.FullPaths||gn(t.files),r=[],a=0;a<e.length;++a)e[a].slice(-1)!="/"&&r.push(e[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Rr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var a;return Lr?a=gc(r):a=$T(r),fr.utils.cfb_add(t,e,a)}fr.utils.cfb_add(t,e,r)}else t.file(e,r)}function rx(){return fr.utils.cfb_new()}function c3(t,e){switch(e.type){case"base64":return fr.read(t,{type:"base64"});case"binary":return fr.read(t,{type:"binary"});case"buffer":case"array":return fr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function n0(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var a=t.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var An=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,E8=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,uw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,A8=/<[^>]*>/g,Ms=An.match(uw)?uw:A8,C8=/<\w*:/,T8=/<(\/?)\w+:/;function _r(t,e,r){for(var a={},n=0,s=0;n!==t.length&&!((s=t.charCodeAt(n))===32||s===10||s===13);++n);if(e||(a[0]=t.slice(0,n)),n===t.length)return a;var o=t.match(E8),u=0,f="",h=0,m="",v="",y=1;if(o)for(h=0;h!=o.length;++h){for(v=o[h],s=0;s!=v.length&&v.charCodeAt(s)!==61;++s);for(m=v.slice(0,s).trim();v.charCodeAt(s+1)==32;)++s;for(y=(n=v.charCodeAt(s+1))==34||n==39?1:0,f=v.slice(s+1+y,v.length-y),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),a[m]=f,a[m.toLowerCase()]=f;else{var g=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(a[g]&&m.slice(u-3,u)=="ext")continue;a[g]=f,a[g.toLowerCase()]=f}}return a}function El(t){return t.replace(T8,"<$1")}var u3={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ax=h1(u3),ta=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(t,function(u,f){return u3[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,f){return String.fromCharCode(parseInt(f,16))});var o=n.indexOf("]]>");return r(n.slice(0,s))+n.slice(s+9,o)+r(n.slice(o+3))}})(),nx=/[&<>'"]/g,O8=/[\u0000-\u0008\u000b-\u001f]/g;function xa(t){var e=t+"";return e.replace(nx,function(r){return ax[r]}).replace(O8,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function fw(t){return xa(t).replace(/ /g,"_x0020_")}var f3=/[\u0000-\u001f]/g;function sx(t){var e=t+"";return e.replace(nx,function(r){return ax[r]}).replace(/\n/g,"<br/>").replace(f3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function R8(t){var e=t+"";return e.replace(nx,function(r){return ax[r]}).replace(f3,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var hw=(function(){var t=/&#(\d+);/g;function e(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(t,e)}})();function D8(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ba(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Qg(t){for(var e="",r=0,a=0,n=0,s=0,o=0,u=0;r<t.length;){if(a=t.charCodeAt(r++),a<128){e+=String.fromCharCode(a);continue}if(n=t.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=n&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),a<240){e+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}o=t.charCodeAt(r++),u=((a&7)<<18|(n&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function dw(t){var e=hu(2*t.length),r,a,n=1,s=0,o=0,u;for(a=0;a<t.length;a+=n)n=1,(u=t.charCodeAt(a))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(a+1)&63),n=2):u<240?(r=(u&15)*4096+(t.charCodeAt(a+1)&63)*64+(t.charCodeAt(a+2)&63),n=3):(n=4,r=(u&7)*262144+(t.charCodeAt(a+1)&63)*4096+(t.charCodeAt(a+2)&63)*64+(t.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function mw(t){return gc(t,"binary").toString("utf8")}var ap="foo bar baz",ka=Lr&&(mw(ap)==Qg(ap)&&mw||dw(ap)==Qg(ap)&&dw)||Qg,kl=Lr?function(t){return gc(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,a=0,n=0;r<t.length;)switch(a=t.charCodeAt(r++),!0){case a<128:e.push(String.fromCharCode(a));break;case a<2048:e.push(String.fromCharCode(192+(a>>6))),e.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=t.charCodeAt(r++)-56320+(a<<10),e.push(String.fromCharCode(240+(n>>18&7))),e.push(String.fromCharCode(144+(n>>12&63))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)));break;default:e.push(String.fromCharCode(224+(a>>12))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)))}return e.join("")},E0=(function(){var t={};return function(r,a){var n=r+"|"+(a||"");return t[n]?t[n]:t[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),h3=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<t.length;++n)a=a.replace(t[n][0],t[n][1]);return a}})(),F8=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),L8=/<\/?(?:vt:)?variant>/g,P8=/<(?:vt:)([^>]*)>([\s\S]*)</;function pw(t,e){var r=_r(t),a=t.match(F8(r.baseType))||[],n=[];if(a.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(s){var o=s.replace(L8,"").match(P8);o&&n.push({v:ka(o[2]),t:o[1]})}),n}var d3=/(^\s|\s$|\n)/;function _s(t,e){return"<"+t+(e.match(d3)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function A0(t){return gn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Pt(t,e,r){return"<"+t+(r!=null?A0(r):"")+(e!=null?(e.match(d3)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function c2(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function M8(t,e){switch(typeof t){case"string":var r=Pt("vt:lpwstr",xa(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Pt((t|0)==t?"vt:i4":"vt:r8",xa(String(t)));case"boolean":return Pt("vt:bool",t?"true":"false")}if(t instanceof Date)return Pt("vt:filetime",c2(t));throw new Error("Unable to serialize "+t)}function ix(t){if(Lr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return ka(xu(Z2(t)));throw new Error("Bad input format: expected Buffer or string")}var C0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Xn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Af=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ri={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function I8(t,e){for(var r=1-2*(t[e+7]>>>7),a=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),n=t[e+6]&15,s=5;s>=0;--s)n=n*256+t[e+s];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function B8(t,e,r){var a=(e<0||1/e==-1/0?1:0)<<7,n=0,s=0,o=a?-e:e;isFinite(o)?o==0?n=s=0:(n=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(e)?26985:0);for(var u=0;u<=5;++u,s/=256)t[r+u]=s&255;t[r+6]=(n&15)<<4|s&15,t[r+7]=n>>4|a}var gw=function(t){for(var e=[],r=10240,a=0;a<t[0].length;++a)if(t[0][a])for(var n=0,s=t[0][a].length;n<s;n+=r)e.push.apply(e,t[0][a].slice(n,n+r));return e},vw=Lr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:gc(e)})):gw(t)}:gw,xw=function(t,e,r){for(var a=[],n=e;n<r;n+=2)a.push(String.fromCharCode(oc(t,n)));return a.join("").replace(Gs,"")},ox=Lr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Gs,""):xw(t,e,r)}:xw,yw=function(t,e,r){for(var a=[],n=e;n<e+r;++n)a.push(("0"+t[n].toString(16)).slice(-2));return a.join("")},m3=Lr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):yw(t,e,r)}:yw,_w=function(t,e,r){for(var a=[],n=e;n<r;n++)a.push(String.fromCharCode(Bh(t,n)));return a.join("")},$0=Lr?function(e,r,a){return Buffer.isBuffer(e)?e.toString("utf8",r,a):_w(e,r,a)}:_w,p3=function(t,e){var r=Di(t,e);return r>0?$0(t,e+4,e+4+r-1):""},g3=p3,v3=function(t,e){var r=Di(t,e);return r>0?$0(t,e+4,e+4+r-1):""},x3=v3,y3=function(t,e){var r=2*Di(t,e);return r>0?$0(t,e+4,e+4+r-1):""},_3=y3,b3=function(e,r){var a=Di(e,r);return a>0?ox(e,r+4,r+4+a):""},w3=b3,S3=function(t,e){var r=Di(t,e);return r>0?$0(t,e+4,e+4+r):""},N3=S3,k3=function(t,e){return I8(t,e)},$p=k3,lx=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Lr&&(g3=function(e,r){if(!Buffer.isBuffer(e))return p3(e,r);var a=e.readUInt32LE(r);return a>0?e.toString("utf8",r+4,r+4+a-1):""},x3=function(e,r){if(!Buffer.isBuffer(e))return v3(e,r);var a=e.readUInt32LE(r);return a>0?e.toString("utf8",r+4,r+4+a-1):""},_3=function(e,r){if(!Buffer.isBuffer(e))return y3(e,r);var a=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+a-1)},w3=function(e,r){if(!Buffer.isBuffer(e))return b3(e,r);var a=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+a)},N3=function(e,r){if(!Buffer.isBuffer(e))return S3(e,r);var a=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+a)},$p=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):k3(e,r)},lx=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Bh=function(t,e){return t[e]},oc=function(t,e){return t[e+1]*256+t[e]},U8=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Di=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},nf=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},q8=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function l0(t,e){var r="",a,n,s=[],o,u,f,h;switch(e){case"dbcs":if(h=this.l,Lr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)r+=String.fromCharCode(oc(this,h)),h+=2;t*=2;break;case"utf8":r=$0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=ox(this,this.l,this.l+t);break;case"wstr":return l0.call(this,t,"dbcs");case"lpstr-ansi":r=g3(this,this.l),t=4+Di(this,this.l);break;case"lpstr-cp":r=x3(this,this.l),t=4+Di(this,this.l);break;case"lpwstr":r=_3(this,this.l),t=4+2*Di(this,this.l);break;case"lpp4":t=4+Di(this,this.l),r=w3(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Di(this,this.l),r=N3(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Bh(this,this.l+t++))!==0;)s.push(rp(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=oc(this,this.l+t))!==0;)s.push(rp(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",h=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Bh(this,h),this.l=h+1,u=l0.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(rp(oc(this,h))),h+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Bh(this,h),this.l=h+1,u=l0.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(rp(Bh(this,h))),h+=1}r=s.join("");break;default:switch(t){case 1:return a=Bh(this,this.l),this.l++,a;case 2:return a=(e==="i"?U8:oc)(this,this.l),this.l+=2,a;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(a=(t>0?nf:q8)(this,this.l),this.l+=4,a):(n=Di(this,this.l),this.l+=4,n);case 8:case-8:if(e==="f")return t==8?n=$p(this,this.l):n=$p([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;t=8;case 16:r=m3(this,this.l,t);break}}return this.l+=t,r}var z8=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},H8=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},$8=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function W8(t,e,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=e.length;++n)$8(this,e.charCodeAt(n),this.l+2*n);a=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=e.length;++n)this[this.l+n]=e.charCodeAt(n)&255;a=e.length}else if(r==="hex"){for(;n<t;++n)this[this.l++]=parseInt(e.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(n=0;n<Math.min(e.length,t);++n){var o=e.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:a=1,this[this.l]=e&255;break;case 2:a=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:a=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:a=4,z8(this,e,this.l);break;case 8:if(a=8,r==="f"){B8(this,e,this.l);break}case 16:break;case-4:a=4,H8(this,e,this.l);break}return this.l+=a,this}function j3(t,e){var r=m3(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ys(t,e){t.l=e,t.read_shift=l0,t.chk=j3,t.write_shift=W8}function Ps(t,e){t.l+=e}function lt(t){var e=hu(t);return ys(e,0),e}function vc(t,e,r){if(t){var a,n,s;ys(t,t.l||0);for(var o=t.length,u=0,f=0;t.l<o;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var h=L0[u]||L0[65535];for(a=t.read_shift(1),s=a&127,n=1;n<4&&a&128;++n)s+=((a=t.read_shift(1))&127)<<7*n;f=t.l+s;var m=h.f&&h.f(t,s,r);if(t.l=f,e(m,h,u))return}}}function hi(){var t=[],e=Lr?256:2048,r=function(h){var m=lt(h);return ys(m,0),m},a=r(e),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&t.push(a),a=null)},s=function(h){return a&&h<a.length-a.l?a:(n(),a=r(Math.max(h+1,e)))},o=function(){return n(),is(t)},u=function(h){n(),a=h,a.l==null&&(a.l=a.length),s(e)};return{next:s,push:u,end:o,_bufs:t}}function wt(t,e,r,a){var n=+e,s;if(!isNaN(n)){a||(a=L0[n].p||(r||[]).length||0),s=1+(n>=128?1:0)+1,a>=128&&++s,a>=16384&&++s,a>=2097152&&++s;var o=t.next(s);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var u=0;u!=4;++u)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&lx(r)&&t.push(r)}}function c0(t,e,r){var a=za(t);if(e.s?(a.cRel&&(a.c+=e.s.c),a.rRel&&(a.r+=e.s.r)):(a.cRel&&(a.c+=e.c),a.rRel&&(a.r+=e.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function bw(t,e,r){var a=za(t);return a.s=c0(a.s,e.s,r),a.e=c0(a.e,e.s,r),a}function u0(t,e){if(t.cRel&&t.c<0)for(t=za(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=za(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=yr(t);return!t.cRel&&t.cRel!=null&&(r=Y8(r)),!t.rRel&&t.rRel!=null&&(r=V8(r)),r}function ev(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+rn(t.s.c)+":"+(t.e.cRel?"":"$")+rn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+En(t.s.r)+":"+(t.e.rRel?"":"$")+En(t.e.r):u0(t.s,e.biff)+":"+u0(t.e,e.biff)}function cx(t){return parseInt(G8(t),10)-1}function En(t){return""+(t+1)}function V8(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function G8(t){return t.replace(/\$(\d+)$/,"$1")}function ux(t){for(var e=X8(t),r=0,a=0;a!==e.length;++a)r=26*r+e.charCodeAt(a)-64;return r-1}function rn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Y8(t){return t.replace(/^([A-Z])/,"$$$1")}function X8(t){return t.replace(/^\$([A-Z])/,"$1")}function K8(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function an(t){for(var e=0,r=0,a=0;a<t.length;++a){var n=t.charCodeAt(a);n>=48&&n<=57?e=10*e+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:e-1}}function yr(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function di(t){var e=t.indexOf(":");return e==-1?{s:an(t),e:an(t)}:{s:an(t.slice(0,e)),e:an(t.slice(e+1))}}function Tr(t,e){return typeof e>"u"||typeof e=="number"?Tr(t.s,t.e):(typeof t!="string"&&(t=yr(t)),typeof e!="string"&&(e=yr(e)),t==e?t:t+":"+e)}function ra(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=t.length;for(r=0;a<s&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(e.s.c=--r,r=0;a<s&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(e.s.r=--r,a===s||n!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++a,r=0;a!=s&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(e.e.c=--r,r=0;a!=s&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return e.e.r=--r,e}function ww(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=fo(t.z,r?Kn(e):e)}catch{}try{return t.w=fo((t.XF||{}).numFmtId||(r?14:0),r?Kn(e):e)}catch{return""+e}}function dc(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?xc[t.v]||t.v:e==null?ww(t,t.v):ww(t,e))}function yu(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",a={};return a[r]=t,{SheetNames:[r],Sheets:a}}function E3(t,e,r){var a=r||{},n=t?Array.isArray(t):a.dense,s=t||(n?[]:{}),o=0,u=0;if(s&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var f=typeof a.origin=="string"?an(a.origin):a.origin;o=f.r,u=f.c}s["!ref"]||(s["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var m=ra(s["!ref"]);h.s.c=m.s.c,h.s.r=m.s.r,h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),o==-1&&(h.e.r=o=m.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=e[v].length;++y)if(!(typeof e[v][y]>"u")){var g={v:e[v][y]},b=o+v,_=u+y;if(h.s.r>b&&(h.s.r=b),h.s.c>_&&(h.s.c=_),h.e.r<b&&(h.e.r=b),h.e.c<_&&(h.e.c=_),e[v][y]&&typeof e[v][y]=="object"&&!Array.isArray(e[v][y])&&!(e[v][y]instanceof Date))g=e[v][y];else if(Array.isArray(g.v)&&(g.f=e[v][y][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(a.nullError)g.t="e",g.v=0;else if(a.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=a.dateNF||xr[14],a.cellDates?(g.t="d",g.w=fo(g.z,Kn(g.v))):(g.t="n",g.v=Kn(g.v),g.w=fo(g.z,g.v))):g.t="s";if(n)s[b]||(s[b]=[]),s[b][_]&&s[b][_].z&&(g.z=s[b][_].z),s[b][_]=g;else{var S=yr({c:_,r:b});s[S]&&s[S].z&&(g.z=s[S].z),s[S]=g}}}return h.s.c<1e7&&(s["!ref"]=Tr(h)),s}function fd(t,e){return E3(null,t,e)}function J8(t){return t.read_shift(4,"i")}function Xo(t,e){return e||(e=lt(4)),e.write_shift(4,t),e}function Ls(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function os(t,e){var r=!1;return e==null&&(r=!0,e=lt(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function Z8(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Q8(t,e){return e||(e=lt(4)),e.write_shift(2,0),e.write_shift(2,0),e}function fx(t,e){var r=t.l,a=t.read_shift(1),n=Ls(t),s=[],o={t:n,h:n};if((a&1)!==0){for(var u=t.read_shift(4),f=0;f!=u;++f)s.push(Z8(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function eO(t,e){var r=!1;return e==null&&(r=!0,e=lt(15+4*t.t.length)),e.write_shift(1,0),os(t.t,e),r?e.slice(0,e.l):e}var tO=fx;function rO(t,e){var r=!1;return e==null&&(r=!0,e=lt(23+4*t.t.length)),e.write_shift(1,1),os(t.t,e),e.write_shift(4,1),Q8({},e),r?e.slice(0,e.l):e}function mo(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Cf(t,e){return e==null&&(e=lt(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Tf(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Of(t,e){return e==null&&(e=lt(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var aO=Ls,A3=os;function hx(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Wp(t,e){var r=!1;return e==null&&(r=!0,e=lt(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var nO=Ls,u2=hx,dx=Wp;function mx(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,a=e[0]&2;t.l+=4;var n=a===0?$p([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):nf(e,0)>>2;return r?n/100:n}function C3(t,e){e==null&&(e=lt(4));var r=0,a=0,n=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)e.write_shift(-4,((r?n:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function T3(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function sO(t,e){return e||(e=lt(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Rf=T3,hd=sO;function Fs(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function yf(t,e){return(e||lt(8)).write_shift(8,t,"f")}function iO(t){var e={},r=t.read_shift(1),a=r>>>1,n=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),u=t.read_shift(1),f=t.read_shift(1);switch(t.l++,a){case 0:e.auto=1;break;case 1:e.index=n;var h=hf[n];h&&(e.rgb=O0(h));break;case 2:e.rgb=O0([o,u,f]);break;case 3:e.theme=n;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Vp(t,e){if(e||(e=lt(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var a=t.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),e.write_shift(1,parseInt(a.slice(0,2),16)),e.write_shift(1,parseInt(a.slice(2,4),16)),e.write_shift(1,parseInt(a.slice(4,6),16)),e.write_shift(1,255)}return e}function oO(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function lO(t,e){e||(e=lt(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function O3(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=t.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function cO(t){return O3(t,1)}function uO(t){return O3(t,2)}var px=2,fi=3,np=11,Sw=12,Gp=19,sp=64,fO=65,hO=71,dO=4108,mO=4126,ns=80,R3=81,pO=[ns,R3],f2={1:{n:"CodePage",t:px},2:{n:"Category",t:ns},3:{n:"PresentationFormat",t:ns},4:{n:"ByteCount",t:fi},5:{n:"LineCount",t:fi},6:{n:"ParagraphCount",t:fi},7:{n:"SlideCount",t:fi},8:{n:"NoteCount",t:fi},9:{n:"HiddenCount",t:fi},10:{n:"MultimediaClipCount",t:fi},11:{n:"ScaleCrop",t:np},12:{n:"HeadingPairs",t:dO},13:{n:"TitlesOfParts",t:mO},14:{n:"Manager",t:ns},15:{n:"Company",t:ns},16:{n:"LinksUpToDate",t:np},17:{n:"CharacterCount",t:fi},19:{n:"SharedDoc",t:np},22:{n:"HyperlinksChanged",t:np},23:{n:"AppVersion",t:fi,p:"version"},24:{n:"DigSig",t:fO},26:{n:"ContentType",t:ns},27:{n:"ContentStatus",t:ns},28:{n:"Language",t:ns},29:{n:"Version",t:ns},255:{},2147483648:{n:"Locale",t:Gp},2147483651:{n:"Behavior",t:Gp},1919054434:{}},h2={1:{n:"CodePage",t:px},2:{n:"Title",t:ns},3:{n:"Subject",t:ns},4:{n:"Author",t:ns},5:{n:"Keywords",t:ns},6:{n:"Comments",t:ns},7:{n:"Template",t:ns},8:{n:"LastAuthor",t:ns},9:{n:"RevNumber",t:ns},10:{n:"EditTime",t:sp},11:{n:"LastPrinted",t:sp},12:{n:"CreatedDate",t:sp},13:{n:"ModifiedDate",t:sp},14:{n:"PageCount",t:fi},15:{n:"WordCount",t:fi},16:{n:"CharCount",t:fi},17:{n:"Thumbnail",t:hO},18:{n:"Application",t:ns},19:{n:"DocSecurity",t:fi},255:{},2147483648:{n:"Locale",t:Gp},2147483651:{n:"Behavior",t:Gp},1919054434:{}},Nw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},gO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function vO(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var xO=vO([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),hf=za(xO),xc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},D3={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},d2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ip={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function gx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function yO(t){var e=gx();if(!t||!t.match)return e;var r={};if((t.match(Ms)||[]).forEach(function(a){var n=_r(a);switch(n[0].replace(C8,"<")){case"<?xml":break;case"<Types":e.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":e[d2[n.ContentType]]!==void 0&&e[d2[n.ContentType]].push(n.PartName);break}}),e.xmlns!==Xn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function F3(t,e){var r=y8(d2),a=[],n;a[a.length]=An,a[a.length]=Pt("Types",null,{xmlns:Xn.CT,"xmlns:xsd":Xn.xsd,"xmlns:xsi":Xn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Pt("Default",null,{Extension:f[0],ContentType:f[1]})}));var s=function(f){t[f]&&t[f].length>0&&(n=t[f][0],a[a.length]=Pt("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:ip[f][e.bookType]||ip[f].xlsx}))},o=function(f){(t[f]||[]).forEach(function(h){a[a.length]=Pt("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:ip[f][e.bookType]||ip[f].xlsx})})},u=function(f){(t[f]||[]).forEach(function(h){a[a.length]=Pt("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[f][0]})})};return s("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Mr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function T0(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function f0(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var a={};return(t.match(Ms)||[]).forEach(function(n){var s=_r(n);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var u=s.TargetMode==="External"?s.Target:n0(s.Target,e);r[u]=o,a[s.Id]=o}}),r["!id"]=a,r}function Gh(t){var e=[An,Pt("Relationships",null,{xmlns:Xn.RELS})];return gn(t["!id"]).forEach(function(r){e[e.length]=Pt("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ga(t,e,r,a,n,s){if(n||(n={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,n.Id="rId"+e,n.Type=a,n.Target=r,[Mr.HLINK,Mr.XPATH,Mr.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),t["!id"][n.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][n.Id]=n,t[("/"+n.Target).replace("//","/")]=n,e}var _O="application/vnd.oasis.opendocument.spreadsheet";function bO(t,e){for(var r=ix(t),a,n;a=C0.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=_r(a[0],!1),n.path=="/"&&n.type!==_O)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw a}}function wO(t){var e=[An];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function kw(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function SO(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function NO(t){var e=[An];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(kw(t[r][0],t[r][1])),e.push(SO("",t[r][0]));return e.push(kw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function L3(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Bp.version+"</meta:generator></office:meta></office:document-meta>"}var uo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],kO=(function(){for(var t=new Array(uo.length),e=0;e<uo.length;++e){var r=uo[e],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return t})();function P3(t){var e={};t=ka(t);for(var r=0;r<uo.length;++r){var a=uo[r],n=t.match(kO[r]);n!=null&&n.length>0&&(e[a[1]]=ta(n[1])),a[2]==="date"&&e[a[1]]&&(e[a[1]]=qa(e[a[1]]))}return e}function tv(t,e,r,a,n){n[t]!=null||e==null||e===""||(n[t]=e,e=xa(e),a[a.length]=r?Pt(t,e,r):_s(t,e))}function M3(t,e){var r=e||{},a=[An,Pt("cp:coreProperties",null,{"xmlns:cp":Xn.CORE_PROPS,"xmlns:dc":Xn.dc,"xmlns:dcterms":Xn.dcterms,"xmlns:dcmitype":Xn.dcmitype,"xmlns:xsi":Xn.xsi})],n={};if(!t&&!r.Props)return a.join("");t&&(t.CreatedDate!=null&&tv("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:c2(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),t.ModifiedDate!=null&&tv("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:c2(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var s=0;s!=uo.length;++s){var o=uo[s],u=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&tv(o[0],u,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var df=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],I3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function B3(t,e,r,a){var n=[];if(typeof t=="string")n=pw(t,a);else for(var s=0;s<t.length;++s)n=n.concat(t[s].map(function(m){return{v:m}}));var o=typeof e=="string"?pw(e,a).map(function(m){return m.v}):e,u=0,f=0;if(o.length>0)for(var h=0;h!==n.length;h+=2){switch(f=+n[h+1].v,n[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=o.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=o.slice(u,u+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=o.slice(u,u+f);break}u+=f}}function jO(t,e,r){var a={};return e||(e={}),t=ka(t),df.forEach(function(n){var s=(t.match(E0(n[0]))||[])[1];switch(n[2]){case"string":s&&(e[n[1]]=ta(s));break;case"bool":e[n[1]]=s==="true";break;case"raw":var o=t.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(a[n[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&B3(a.HeadingPairs,a.TitlesOfParts,e,r),e}function U3(t){var e=[],r=Pt;return t||(t={}),t.Application="SheetJS",e[e.length]=An,e[e.length]=Pt("Properties",null,{xmlns:Xn.EXT_PROPS,"xmlns:vt":Xn.vt}),df.forEach(function(a){if(t[a[1]]!==void 0){var n;switch(a[2]){case"string":n=xa(String(t[a[1]]));break;case"bool":n=t[a[1]]?"true":"false";break}n!==void 0&&(e[e.length]=r(a[0],n))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(a){return"<vt:lpstr>"+xa(a)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var EO=/<[^>]+>[^<]*/g;function AO(t,e){var r={},a="",n=t.match(EO);if(n)for(var s=0;s!=n.length;++s){var o=n[s],u=_r(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":a=ta(u.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var f=o.split(">"),h=f[0].slice(4),m=f[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[a]=ta(m);break;case"bool":r[a]=Ba(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(m);break;case"filetime":case"date":r[a]=qa(m);break;case"cy":case"error":r[a]=ta(m);break;default:if(h.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,f)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function q3(t){var e=[An,Pt("Properties",null,{xmlns:Xn.CUST_PROPS,"xmlns:vt":Xn.vt})];if(!t)return e.join("");var r=1;return gn(t).forEach(function(n){++r,e[e.length]=Pt("property",M8(t[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:xa(n)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var m2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},rv;function CO(t,e,r){rv||(rv=h1(m2)),e=rv[e]||e,t[e]=r}function TO(t,e){var r=[];return gn(m2).map(function(a){for(var n=0;n<uo.length;++n)if(uo[n][1]==a)return uo[n];for(n=0;n<df.length;++n)if(df[n][1]==a)return df[n];throw a}).forEach(function(a){if(t[a[1]]!=null){var n=e&&e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:t[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(_s(m2[a[1]]||a[1],n))}}),Pt("DocumentProperties",r.join(""),{xmlns:Ri.o})}function OO(t,e){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return t&&gn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<uo.length;++o)if(s==uo[o][1])return;for(o=0;o<df.length;++o)if(s==df[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var u=t[s],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),n.push(Pt(fw(s),u,{"dt:dt":f}))}}),e&&gn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),n.push(Pt(fw(s),o,{"dt:dt":u}))}}),"<"+a+' xmlns="'+Ri.o+'">'+n.join("")+"</"+a+">"}function vx(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function RO(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var s=a/Math.pow(2,32)|0;s>0&&(a=a%Math.pow(2,32),n+=s);var o=lt(8);return o.write_shift(4,a),o.write_shift(4,n),o}function z3(t,e,r){var a=t.l,n=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-a&3;)++t.l;return n}function H3(t,e,r){var a=t.read_shift(0,"lpwstr");return a}function $3(t,e,r){return e===31?H3(t):z3(t,e,r)}function p2(t,e,r){return $3(t,e,r===!1?0:4)}function DO(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return $3(t,e,0)}function FO(t){for(var e=t.read_shift(4),r=[],a=0;a!=e;++a){var n=t.l;r[a]=t.read_shift(0,"lpwstr").replace(Gs,""),t.l-n&2&&(t.l+=2)}return r}function LO(t){for(var e=t.read_shift(4),r=[],a=0;a!=e;++a)r[a]=t.read_shift(0,"lpstr-cp").replace(Gs,"");return r}function PO(t){var e=t.l,r=Yp(t,R3);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var a=Yp(t,fi);return[r,a]}function MO(t){for(var e=t.read_shift(4),r=[],a=0;a<e/2;++a)r.push(PO(t));return r}function jw(t,e){for(var r=t.read_shift(4),a={},n=0;n!=r;++n){var s=t.read_shift(4),o=t.read_shift(4);a[s]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Gs,"").replace(a0,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),a}function W3(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function IO(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Yp(t,e,r){var a=t.read_shift(2),n,s=r||{};if(t.l+=2,e!==Sw&&a!==e&&pO.indexOf(e)===-1&&!((e&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+e+" saw "+a);switch(e===Sw?a:e){case 2:return n=t.read_shift(2,"i"),s.raw||(t.l+=2),n;case 3:return n=t.read_shift(4,"i"),n;case 11:return t.read_shift(4)!==0;case 19:return n=t.read_shift(4),n;case 30:return z3(t,a,4).replace(Gs,"");case 31:return H3(t);case 64:return vx(t);case 65:return W3(t);case 71:return IO(t);case 80:return p2(t,a,!s.raw).replace(Gs,"");case 81:return DO(t,a).replace(Gs,"");case 4108:return MO(t);case 4126:case 4127:return a==4127?FO(t):LO(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+a)}}function Ew(t,e){var r=lt(4),a=lt(4);switch(r.write_shift(4,t==80?31:t),t){case 3:a.write_shift(-4,e);break;case 5:a=lt(8),a.write_shift(8,e,"f");break;case 11:a.write_shift(4,e?1:0);break;case 64:a=RO(e);break;case 31:case 80:for(a=lt(4+2*(e.length+1)+(e.length%2?0:2)),a.write_shift(4,e.length+1),a.write_shift(0,e,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return is([r,a])}function Aw(t,e){var r=t.l,a=t.read_shift(4),n=t.read_shift(4),s=[],o=0,u=0,f=-1,h={};for(o=0;o!=n;++o){var m=t.read_shift(4),v=t.read_shift(4);s[o]=[m,v+r]}s.sort(function(C,j){return C[1]-j[1]});var y={};for(o=0;o!=n;++o){if(t.l!==s[o][1]){var g=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:t.l+2===s[o][1]&&(t.l+=2,g=!1);break;case 80:t.l<=s[o][1]&&(t.l=s[o][1],g=!1);break;case 4108:t.l<=s[o][1]&&(t.l=s[o][1],g=!1);break}if((!e||o==0)&&t.l<=s[o][1]&&(g=!1,t.l=s[o][1]),g)throw new Error("Read Error: Expected address "+s[o][1]+" at "+t.l+" :"+o)}if(e){var b=e[s[o][0]];if(y[b.n]=Yp(t,b.t,{raw:!0}),b.p==="version"&&(y[b.n]=String(y[b.n]>>16)+"."+("0000"+String(y[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(y[b.n]){case 0:y[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Vo(u=y[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[b.n])}}else if(s[o][0]===1){if(u=y.CodePage=Yp(t,px),Vo(u),f!==-1){var _=t.l;t.l=s[f][1],h=jw(t,u),t.l=_}}else if(s[o][0]===0){if(u===0){f=o,t.l=s[o+1][1];continue}h=jw(t,u)}else{var S=h[s[o][0]],E;switch(t[t.l]){case 65:t.l+=4,E=W3(t);break;case 30:t.l+=4,E=p2(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,E=p2(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,E=t.read_shift(4,"i");break;case 19:t.l+=4,E=t.read_shift(4);break;case 5:t.l+=4,E=t.read_shift(8,"f");break;case 11:t.l+=4,E=bn(t,4);break;case 64:t.l+=4,E=qa(vx(t));break;default:throw new Error("unparsed value: "+t[t.l])}y[S]=E}}return t.l=r+a,y}var V3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function BO(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Cw(t,e,r){var a=lt(8),n=[],s=[],o=8,u=0,f=lt(8),h=lt(8);if(f.write_shift(4,2),f.write_shift(4,1200),h.write_shift(4,1),s.push(f),n.push(h),o+=8+f.length,!e){h=lt(8),h.write_shift(4,0),n.unshift(h);var m=[lt(4)];for(m[0].write_shift(4,t.length),u=0;u<t.length;++u){var v=t[u][0];for(f=lt(8+2*(v.length+1)+(v.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,v.length+1),f.write_shift(0,v,"dbcs");f.l!=f.length;)f.write_shift(1,0);m.push(f)}f=is(m),s.unshift(f),o+=8+f.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(V3.indexOf(t[u][0])>-1||I3.indexOf(t[u][0])>-1)&&t[u][1]!=null){var y=t[u][1],g=0;if(e){g=+e[t[u][0]];var b=r[g];if(b.p=="version"&&typeof y=="string"){var _=y.split(".");y=(+_[0]<<16)+(+_[1]||0)}f=Ew(b.t,y)}else{var S=BO(y);S==-1&&(S=31,y=String(y)),f=Ew(S,y)}s.push(f),h=lt(8),h.write_shift(4,e?g:2+u),n.push(h),o+=8+f.length}var E=8*(s.length+1);for(u=0;u<s.length;++u)n[u].write_shift(4,E),E+=s[u].length;return a.write_shift(4,o),a.write_shift(4,s.length),is([a].concat(n).concat(s))}function Tw(t,e,r){var a=t.content;if(!a)return{};ys(a,0);var n,s,o,u,f=0;a.chk("feff","Byte Order: "),a.read_shift(2);var h=a.read_shift(4),m=a.read_shift(16);if(m!==fr.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),u=a.read_shift(4),n===1&&u!==a.l)throw new Error("Length mismatch: "+u+" !== "+a.l);n===2&&(o=a.read_shift(16),f=a.read_shift(4));var v=Aw(a,e),y={SystemIdentifier:h};for(var g in v)y[g]=v[g];if(y.FMTID=s,n===1)return y;if(f-a.l==2&&(a.l+=2),a.l!==f)throw new Error("Length mismatch 2: "+a.l+" !== "+f);var b;try{b=Aw(a,null)}catch{}for(g in b)y[g]=b[g];return y.FMTID=[s,o],y}function Ow(t,e,r,a,n,s){var o=lt(n?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,fr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,n?68:48);var f=Cw(t,r,a);if(u.push(f),n){var h=Cw(n,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+f.length),u.push(h)}return is(u)}function eu(t,e){return t.read_shift(e),null}function UO(t,e){e||(e=lt(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function qO(t,e,r){for(var a=[],n=t.l+e;t.l<n;)a.push(r(t,n-t.l));if(n!==t.l)throw new Error("Slurp error");return a}function bn(t,e){return t.read_shift(e)===1}function Vs(t,e){return e||(e=lt(2)),e.write_shift(2,+!!t),e}function Pn(t){return t.read_shift(2,"u")}function co(t,e){return e||(e=lt(2)),e.write_shift(2,t),e}function G3(t,e){return qO(t,e,Pn)}function zO(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Y3(t,e,r){return r||(r=lt(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function W0(t,e,r){var a=t.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=a?t.read_shift(a,n):"";return o}function HO(t){var e=t.read_shift(2),r=t.read_shift(1),a=r&4,n=r&8,s=1+(r&1),o=0,u,f={};n&&(o=t.read_shift(2)),a&&(u=t.read_shift(4));var h=s==2?"dbcs-cont":"sbcs-cont",m=e===0?"":t.read_shift(e,h);return n&&(t.l+=4*o),a&&(t.l+=u),f.t=m,n||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function $O(t){var e=t.t||"",r=lt(3);r.write_shift(2,e.length),r.write_shift(1,1);var a=lt(2*e.length);a.write_shift(2*e.length,e,"utf16le");var n=[r,a];return is(n)}function _f(t,e,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var n=t.read_shift(1);return n===0?a=t.read_shift(e,"sbcs-cont"):a=t.read_shift(e,"dbcs-cont"),a}function V0(t,e,r){var a=t.read_shift(r&&r.biff==2?1:2);return a===0?(t.l++,""):_f(t,a,r)}function Df(t,e,r){if(r.biff>5)return V0(t,e,r);var a=t.read_shift(1);return a===0?(t.l++,""):t.read_shift(a,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function X3(t,e,r){return r||(r=lt(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function WO(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function VO(t){var e=t.read_shift(4),r=t.l,a=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),t.l=r);var n=t.read_shift((a?e-24:e)>>1,"utf16le").replace(Gs,"");return a&&(t.l+=24),n}function GO(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var a=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=t.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(s>>1,"utf16le").replace(Gs,"");return r+o}function YO(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return VO(t);case"0303000000000000c000000000000046":return GO(t);default:throw new Error("Unsupported Moniker "+r)}}function op(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Gs,""):"";return r}function Rw(t,e){e||(e=lt(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function XO(t,e){var r=t.l+e,a=t.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=t.read_shift(2);t.l+=2;var s,o,u,f,h="",m,v;n&16&&(s=op(t,r-t.l)),n&128&&(o=op(t,r-t.l)),(n&257)===257&&(u=op(t,r-t.l)),(n&257)===1&&(f=YO(t,r-t.l)),n&8&&(h=op(t,r-t.l)),n&32&&(m=t.read_shift(16)),n&64&&(v=vx(t)),t.l=r;var y=o||u||f||"";y&&h&&(y+="#"+h),y||(y="#"+h),n&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var g={Target:y};return m&&(g.guid=m),v&&(g.time=v),s&&(g.Tooltip=s),g}function KO(t){var e=lt(512),r=0,a=t.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),s=n>-1?31:23;switch(a.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(s==28)a=a.slice(1),Rw(a,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var u=n>-1?a.slice(0,n):a;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),s&8&&Rw(n>-1?a.slice(n+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var f=0;a.slice(f*3,f*3+3)=="../"||a.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,a.length-3*f+1),r=0;r<a.length-3*f;++r)e.write_shift(1,a.charCodeAt(r+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function K3(t){var e=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1),n=t.read_shift(1);return[e,r,a,n]}function J3(t,e){var r=K3(t);return r[3]=0,r}function Al(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{r:e,c:r,ixfe:a}}function bf(t,e,r,a){return a||(a=lt(6)),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(2,r||0),a}function JO(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function ZO(t,e,r){return e===0?"":Df(t,e,r)}function QO(t,e,r){var a=r.biff>8?4:2,n=t.read_shift(a),s=t.read_shift(a,"i"),o=t.read_shift(a,"i");return[n,s,o]}function Z3(t){var e=t.read_shift(2),r=mx(t);return[e,r]}function e7(t,e,r){t.l+=4,e-=4;var a=t.l+e,n=W0(t,e,r),s=t.read_shift(2);if(a-=t.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return t.l+=s,n}function p1(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2);return{s:{c:a,r:e},e:{c:n,r}}}function Q3(t,e){return e||(e=lt(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function eN(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(1),n=t.read_shift(1);return{s:{c:a,r:e},e:{c:n,r}}}var t7=eN;function tN(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return t.l+=12,[r,e,a]}function r7(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function a7(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function js(t){t.l+=2,t.l+=t.read_shift(2)}var n7={0:js,4:js,5:js,6:js,7:a7,8:js,9:js,10:js,11:js,12:js,13:r7,14:js,15:js,16:js,17:js,18:js,19:js,20:js,21:tN};function s7(t,e){for(var r=t.l+e,a=[];t.l<r;){var n=t.read_shift(2);t.l-=2;try{a.push(n7[n](t,r-t.l))}catch{return t.l=r,a}}return t.l!=r&&(t.l=r),a}function lp(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function xx(t,e,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=lt(n);return s.write_shift(2,a),s.write_shift(2,e),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function i7(t,e){return e===0||t.read_shift(2),1200}function o7(t,e,r){if(r.enc)return t.l+=e,"";var a=t.l,n=Df(t,0,r);return t.read_shift(e+a-t.l),n}function l7(t,e){var r=!e||e.biff==8,a=lt(r?112:54);for(a.write_shift(e.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function c7(t,e,r){var a=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function u7(t,e,r){var a=t.read_shift(4),n=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=W0(t,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:n,dt:s,name:o}}function f7(t,e){var r=!e||e.biff>=8?2:1,a=lt(8+r*t.name.length);a.write_shift(4,t.pos),a.write_shift(1,t.hs||0),a.write_shift(1,t.dt),a.write_shift(1,t.name.length),e.biff>=8&&a.write_shift(1,1),a.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function h7(t,e){for(var r=t.l+e,a=t.read_shift(4),n=t.read_shift(4),s=[],o=0;o!=n&&t.l<r;++o)s.push(HO(t));return s.Count=a,s.Unique=n,s}function d7(t,e){var r=lt(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var a=[],n=0;n<t.length;++n)a[n]=$O(t[n]);var s=is([r].concat(a));return s.parts=[r.length].concat(a.map(function(o){return o.length})),s}function m7(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function p7(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var a=t.read_shift(1);return t.l+=3,a&7&&(e.level=a&7),a&32&&(e.hidden=!0),a&64&&(e.hpt=r/20),e}function g7(t){var e=JO(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function v7(t){return t.read_shift(2),t.read_shift(4)}function Dw(t,e,r){var a=0;r&&r.biff==2||(a=t.read_shift(2));var n=t.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,n]}function x7(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),u=t.read_shift(2),f=t.read_shift(2),h=t.read_shift(2);return{Pos:[e,r],Dim:[a,n],Flags:s,CurTab:o,FirstTab:u,Selected:f,TabRatio:h}}function y7(){var t=lt(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function _7(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=t.read_shift(2);return{RTL:a&64}}function b7(t){var e=lt(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function w7(){}function S7(t,e,r){var a={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return a.name=W0(t,0,r),a}function N7(t,e){var r=t.name||"Arial",a=e&&e.biff==5,n=a?15+r.length:16+2*r.length,s=lt(n);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),s}function k7(t){var e=Al(t);return e.isst=t.read_shift(4),e}function j7(t,e,r,a){var n=lt(10);return bf(t,e,a,n),n.write_shift(4,r),n}function E7(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=t.l+e,n=Al(t);r.biff==2&&t.l++;var s=V0(t,a-t.l,r);return n.val=s,n}function A7(t,e,r,a,n){var s=!n||n.biff==8,o=lt(8+ +s+(1+s)*r.length);return bf(t,e,a,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function C7(t,e,r){var a=t.read_shift(2),n=Df(t,0,r);return[a,n]}function T7(t,e,r,a){var n=r&&r.biff==5;a||(a=lt(n?3+e.length:5+2*e.length)),a.write_shift(2,t),a.write_shift(n?1:2,e.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le");var s=a.length>a.l?a.slice(0,a.l):a;return s.l==null&&(s.l=s.length),s}var O7=Df;function Fw(t,e,r){var a=t.l+e,n=r.biff==8||!r.biff?4:2,s=t.read_shift(n),o=t.read_shift(n),u=t.read_shift(2),f=t.read_shift(2);return t.l=a,{s:{r:s,c:u},e:{r:o,c:f}}}function R7(t,e){var r=e.biff==8||!e.biff?4:2,a=lt(2*r+6);return a.write_shift(r,t.s.r),a.write_shift(r,t.e.r+1),a.write_shift(2,t.s.c),a.write_shift(2,t.e.c+1),a.write_shift(2,0),a}function D7(t){var e=t.read_shift(2),r=t.read_shift(2),a=Z3(t);return{r:e,c:r,ixfe:a[0],rknum:a[1]}}function F7(t,e){for(var r=t.l+e-2,a=t.read_shift(2),n=t.read_shift(2),s=[];t.l<r;)s.push(Z3(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(s.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:o,rkrec:s}}function L7(t,e){for(var r=t.l+e-2,a=t.read_shift(2),n=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(s.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:o,ixfe:s}}function P7(t,e,r,a){var n={},s=t.read_shift(4),o=t.read_shift(4),u=t.read_shift(4),f=t.read_shift(2);return n.patternType=gO[u>>26],a.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=u&127,n.icvBottom=u>>7&127,n.icvDiag=u>>14&127,n.dgDiag=u>>21&15,n.icvFore=f&127,n.icvBack=f>>7&127,n.fsxButton=f>>14&1),n}function M7(t,e,r){var a={};return a.ifnt=t.read_shift(2),a.numFmtId=t.read_shift(2),a.flags=t.read_shift(2),a.fStyle=a.flags>>2&1,e-=6,a.data=P7(t,e,a.fStyle,r),a}function Lw(t,e,r,a){var n=r&&r.biff==5;a||(a=lt(n?16:20)),a.write_shift(2,0),t.style?(a.write_shift(2,t.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,t.numFmtId||0),a.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&n&&(s|=1024),a.write_shift(4,s),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function I7(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function B7(t){var e=lt(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Pw(t,e,r){var a=Al(t);(r.biff==2||e==9)&&++t.l;var n=zO(t);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function U7(t,e,r,a,n,s){var o=lt(8);return bf(t,e,a,o),Y3(r,s,o),o}function q7(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Al(t),n=Fs(t);return a.val=n,a}function z7(t,e,r,a){var n=lt(14);return bf(t,e,a,n),yf(r,n),n}var Mw=ZO;function H7(t,e,r){var a=t.l+e,n=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=_f(t,s),u=[];a>t.l;)u.push(V0(t));return[s,n,o,u]}function Iw(t,e,r){var a=t.read_shift(2),n,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=e7(t,e-2,r)),s.body=n||t.read_shift(e-2),typeof n=="string"&&(s.Name=n),s}var $7=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Bw(t,e,r){var a=t.l+e,n=t.read_shift(2),s=t.read_shift(1),o=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),f=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var h=_f(t,o,r);n&32&&(h=$7[h.charCodeAt(0)]);var m=a-t.l;r&&r.biff==2&&--m;var v=a==t.l||u===0||!(m>0)?[]:sP(t,m,r,u);return{chKey:s,Name:h,itab:f,rgce:v}}function rN(t,e,r){if(r.biff<8)return W7(t,e,r);for(var a=[],n=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)a.push(QO(t,r.biff>8?12:6,r));if(t.l!=n)throw new Error("Bad ExternSheet: "+t.l+" != "+n);return a}function W7(t,e,r){t[t.l+1]==3&&t[t.l]++;var a=W0(t,e,r);return a.charCodeAt(0)==3?a.slice(1):a}function V7(t,e,r){if(r.biff<8){t.l+=e;return}var a=t.read_shift(2),n=t.read_shift(2),s=_f(t,a,r),o=_f(t,n,r);return[s,o]}function G7(t,e,r){var a=eN(t);t.l++;var n=t.read_shift(1);return e-=8,[iP(t,e,r),n,a]}function Uw(t,e,r){var a=t7(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[a,aP(t,e,r)]}function Y7(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,a=t.read_shift(4);return[e,r,a]}function X7(t,e,r){if(!(r.biff<8)){var a=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),u=Df(t,0,r);return r.biff<8&&t.read_shift(1),[{r:a,c:n},u,o,s]}}function K7(t,e,r){return X7(t,e,r)}function J7(t,e){for(var r=[],a=t.read_shift(2);a--;)r.push(p1(t));return r}function Z7(t){var e=lt(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)Q3(t[r],e);return e}function Q7(t,e,r){if(r&&r.biff<8)return tR(t,e,r);var a=tN(t),n=s7(t,e-22,a[1]);return{cmo:a,ft:n}}var eR={8:function(t,e){var r=t.l+e;t.l+=10;var a=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var n=t.read_shift(1);return t.l+=n,t.l=r,{fmt:a}}};function tR(t,e,r){t.l+=4;var a=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((eR[a]||Ps)(t,e,r)),{cmo:[n,a,s],ft:o}}function rR(t,e,r){var a=t.l,n="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:o=WO(t,6,r);var u=t.read_shift(2);t.read_shift(2),Pn(t,2);var f=t.read_shift(2);t.l+=f;for(var h=1;h<t.lens.length-1;++h){if(t.l-a!=t.lens[h])throw new Error("TxO: bad continue record");var m=t[t.l],v=_f(t,t.lens[h+1]-t.lens[h]-1);if(n+=v,n.length>=(m?u:2*u))break}if(n.length!==u&&n.length!==u*2)throw new Error("cchText: "+u+" != "+n.length);return t.l=a+e,{t:n}}catch{return t.l=a+e,{t:n}}}function aR(t,e){var r=p1(t);t.l+=16;var a=XO(t,e-24);return[r,a]}function nR(t){var e=lt(24),r=an(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)e.write_shift(1,parseInt(a[n],16));return is([e,KO(t[1])])}function sR(t,e){t.read_shift(2);var r=p1(t),a=t.read_shift((e-10)/2,"dbcs-cont");return a=a.replace(Gs,""),[r,a]}function iR(t){var e=t[1].Tooltip,r=lt(10+2*(e.length+1));r.write_shift(2,2048);var a=an(t[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<e.length;++n)r.write_shift(2,e.charCodeAt(n));return r.write_shift(2,0),r}function oR(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Nw[r]||r,r=t.read_shift(2),e[1]=Nw[r]||r,e}function lR(t){return t||(t=lt(4)),t.write_shift(2,1),t.write_shift(2,1),t}function cR(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(J3(t));return r}function uR(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(J3(t));return r}function fR(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function aN(t,e,r){if(!r.cellStyles)return Ps(t,e);var a=r&&r.biff>=12?4:2,n=t.read_shift(a),s=t.read_shift(a),o=t.read_shift(a),u=t.read_shift(a),f=t.read_shift(2);a==2&&(t.l+=2);var h={s:n,e:s,w:o,ixfe:u,flags:f};return(r.biff>=5||!r.biff)&&(h.level=f>>8&7),h}function hR(t,e){var r=lt(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var a=0;return t.hidden&&(a|=1),r.write_shift(1,a),a=t.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function dR(t,e){var r={};return e<32||(t.l+=16,r.header=Fs(t),r.footer=Fs(t),t.l+=2),r}function mR(t,e,r){var a={area:!1};if(r.biff!=5)return t.l+=e,a;var n=t.read_shift(1);return t.l+=3,n&16&&(a.area=!0),a}function pR(t){for(var e=lt(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var gR=Al,vR=G3,xR=V0;function yR(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n={fmt:e,env:r,len:a,data:t.slice(t.l,t.l+a)};return t.l+=a,n}function _R(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Al(t);++t.l;var n=Df(t,e-7,r);return a.t="str",a.val=n,a}function bR(t){var e=Al(t);++t.l;var r=Fs(t);return e.t="n",e.val=r,e}function wR(t,e,r){var a=lt(15);return K0(a,t,e),a.write_shift(8,r,"f"),a}function SR(t){var e=Al(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function NR(t,e,r){var a=lt(9);return K0(a,t,e),a.write_shift(2,r),a}function kR(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function jR(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function ER(t,e,r){var a=t.l+e,n=Al(t),s=t.read_shift(2),o=_f(t,s,r);return t.l=a,n.t="str",n.val=o,n}var AR=[2,3,48,49,131,139,140,245],g2=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=h1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,f){var h=[],m=hu(1);switch(f.type){case"base64":m=Pi(qi(u));break;case"binary":m=Pi(u);break;case"buffer":case"array":m=u;break}ys(m,0);var v=m.read_shift(1),y=!!(v&136),g=!1,b=!1;switch(v){case 2:break;case 3:break;case 48:g=!0,y=!0;break;case 49:g=!0,y=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var _=0,S=521;v==2&&(_=m.read_shift(2)),m.l+=3,v!=2&&(_=m.read_shift(4)),_>1048576&&(_=1e6),v!=2&&(S=m.read_shift(2));var E=m.read_shift(2),C=f.codepage||1252;v!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(C=t[m[m.l]]),m.l+=1,m.l+=2),b&&(m.l+=36);for(var j=[],R={},H=Math.min(m.length,v==2?521:S-10-(g?264:0)),Y=b?32:11;m.l<H&&m[m.l]!=13;)switch(R={},R.name=N0.utils.decode(C,m.slice(m.l,m.l+Y)).replace(/[\u0000\r\n].*$/g,""),m.l+=Y,R.type=String.fromCharCode(m.read_shift(1)),v!=2&&!b&&(R.offset=m.read_shift(4)),R.len=m.read_shift(1),v==2&&(R.offset=m.read_shift(2)),R.dec=m.read_shift(1),R.name.length&&j.push(R),v!=2&&(m.l+=b?13:14),R.type){case"B":(!g||R.len!=8)&&f.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(m[m.l]!==13&&(m.l=S-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=S;var U=0,V=0;for(h[0]=[],V=0;V!=j.length;++V)h[0][V]=j[V].name;for(;_-- >0;){if(m[m.l]===42){m.l+=E;continue}for(++m.l,h[++U]=[],V=0,V=0;V!=j.length;++V){var F=m.slice(m.l,m.l+j[V].len);m.l+=j[V].len,ys(F,0);var X=N0.utils.decode(C,F);switch(j[V].type){case"C":X.trim().length&&(h[U][V]=X.replace(/\s+$/,""));break;case"D":X.length===8?h[U][V]=new Date(+X.slice(0,4),+X.slice(4,6)-1,+X.slice(6,8)):h[U][V]=X;break;case"F":h[U][V]=parseFloat(X.trim());break;case"+":case"I":h[U][V]=b?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(X.trim().toUpperCase()){case"Y":case"T":h[U][V]=!0;break;case"N":case"F":h[U][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+X+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));h[U][V]="##MEMO##"+(b?parseInt(X.trim(),10):F.read_shift(4));break;case"N":X=X.replace(/\u0000/g,"").trim(),X&&X!="."&&(h[U][V]=+X||0);break;case"@":h[U][V]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":h[U][V]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":h[U][V]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[U][V]=-F.read_shift(-8,"f");break;case"B":if(g&&j[V].len==8){h[U][V]=F.read_shift(8,"f");break}case"G":case"P":F.l+=j[V].len;break;case"0":if(j[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+j[V].type)}}}if(v!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=j,h}function a(u,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var m=fd(r(u,h),h);return m["!cols"]=h.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete h.DBF,m}function n(u,f){try{return yu(a(u,f),f)}catch(h){if(f&&f.WTF)throw h}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,f){var h=f||{};if(+h.codepage>=0&&Vo(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var m=hi(),v=Jp(u,{header:1,raw:!0,cellDates:!0}),y=v[0],g=v.slice(1),b=u["!cols"]||[],_=0,S=0,E=0,C=1;for(_=0;_<y.length;++_){if(((b[_]||{}).DBF||{}).name){y[_]=b[_].DBF.name,++E;continue}if(y[_]!=null){if(++E,typeof y[_]=="number"&&(y[_]=y[_].toString(10)),typeof y[_]!="string")throw new Error("DBF Invalid column name "+y[_]+" |"+typeof y[_]+"|");if(y.indexOf(y[_])!==_){for(S=0;S<1024;++S)if(y.indexOf(y[_]+"_"+S)==-1){y[_]+="_"+S;break}}}}var j=ra(u["!ref"]),R=[],H=[],Y=[];for(_=0;_<=j.e.c-j.s.c;++_){var U="",V="",F=0,X=[];for(S=0;S<g.length;++S)g[S][_]!=null&&X.push(g[S][_]);if(X.length==0||y[_]==null){R[_]="?";continue}for(S=0;S<X.length;++S){switch(typeof X[S]){case"number":V="B";break;case"string":V="C";break;case"boolean":V="L";break;case"object":V=X[S]instanceof Date?"D":"C";break;default:V="C"}F=Math.max(F,String(X[S]).length),U=U&&U!=V?"C":V}F>250&&(F=250),V=((b[_]||{}).DBF||{}).type,V=="C"&&b[_].DBF.len>F&&(F=b[_].DBF.len),U=="B"&&V=="N"&&(U="N",Y[_]=b[_].DBF.dec,F=b[_].DBF.len),H[_]=U=="C"||V=="N"?F:s[U]||0,C+=H[_],R[_]=U}var P=m.next(32);for(P.write_shift(4,318902576),P.write_shift(4,g.length),P.write_shift(2,296+32*E),P.write_shift(2,C),_=0;_<4;++_)P.write_shift(4,0);for(P.write_shift(4,0|(+e[V4]||3)<<8),_=0,S=0;_<y.length;++_)if(y[_]!=null){var O=m.next(32),I=(y[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);O.write_shift(1,I,"sbcs"),O.write_shift(1,R[_]=="?"?"C":R[_],"sbcs"),O.write_shift(4,S),O.write_shift(1,H[_]||s[R[_]]||0),O.write_shift(1,Y[_]||0),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(1,0),O.write_shift(4,0),O.write_shift(4,0),S+=H[_]||s[R[_]]||0}var W=m.next(264);for(W.write_shift(4,13),_=0;_<65;++_)W.write_shift(4,0);for(_=0;_<g.length;++_){var ne=m.next(C);for(ne.write_shift(1,0),S=0;S<y.length;++S)if(y[S]!=null)switch(R[S]){case"L":ne.write_shift(1,g[_][S]==null?63:g[_][S]?84:70);break;case"B":ne.write_shift(8,g[_][S]||0,"f");break;case"N":var Q="0";for(typeof g[_][S]=="number"&&(Q=g[_][S].toFixed(Y[S]||0)),E=0;E<H[S]-Q.length;++E)ne.write_shift(1,32);ne.write_shift(1,Q,"sbcs");break;case"D":g[_][S]?(ne.write_shift(4,("0000"+g[_][S].getFullYear()).slice(-4),"sbcs"),ne.write_shift(2,("00"+(g[_][S].getMonth()+1)).slice(-2),"sbcs"),ne.write_shift(2,("00"+g[_][S].getDate()).slice(-2),"sbcs")):ne.write_shift(8,"00000000","sbcs");break;case"C":var le=String(g[_][S]!=null?g[_][S]:"").slice(0,H[S]);for(ne.write_shift(1,le,"sbcs"),E=0;E<H[S]-le.length;++E)ne.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:n,to_sheet:a,from_sheet:o}})(),nN=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+gn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(y,g){var b=t[g];return typeof b=="number"?Jb(b):b},a=function(y,g,b){var _=g.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return _==59?y:Jb(_)};t["|"]=254;function n(y,g){switch(g.type){case"base64":return s(qi(y),g);case"binary":return s(y,g);case"buffer":return s(Lr&&Buffer.isBuffer(y)?y.toString("binary"):xu(y),g);case"array":return s(xf(y),g)}throw new Error("Unrecognized type "+g.type)}function s(y,g){var b=y.split(/[\n\r]+/),_=-1,S=-1,E=0,C=0,j=[],R=[],H=null,Y={},U=[],V=[],F=[],X=0,P;for(+g.codepage>=0&&Vo(+g.codepage);E!==b.length;++E){X=0;var O=b[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(e,r),I=O.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),W=I[0],ne;if(O.length>0)switch(W){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":I[1].charAt(0)=="P"&&R.push(O.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,le=!1,ee=!1,K=!1,ue=-1,M=-1;for(C=1;C<I.length;++C)switch(I[C].charAt(0)){case"A":break;case"X":S=parseInt(I[C].slice(1))-1,le=!0;break;case"Y":for(_=parseInt(I[C].slice(1))-1,le||(S=0),P=j.length;P<=_;++P)j[P]=[];break;case"K":ne=I[C].slice(1),ne.charAt(0)==='"'?ne=ne.slice(1,ne.length-1):ne==="TRUE"?ne=!0:ne==="FALSE"?ne=!1:isNaN(Yo(ne))?isNaN(rd(ne).getDate())||(ne=qa(ne)):(ne=Yo(ne),H!==null&&cd(H)&&(ne=m1(ne))),Q=!0;break;case"E":K=!0;var A=Yh(I[C].slice(1),{r:_,c:S});j[_][S]=[j[_][S],A];break;case"S":ee=!0,j[_][S]=[j[_][S],"S5S"];break;case"G":break;case"R":ue=parseInt(I[C].slice(1))-1;break;case"C":M=parseInt(I[C].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+O)}if(Q&&(j[_][S]&&j[_][S].length==2?j[_][S][0]=ne:j[_][S]=ne,H=null),ee){if(K)throw new Error("SYLK shared formula cannot have own formula");var D=ue>-1&&j[ue][M];if(!D||!D[1])throw new Error("SYLK shared formula cannot find base");j[_][S][1]=wN(D[1],{r:_-ue,c:S-M})}break;case"F":var B=0;for(C=1;C<I.length;++C)switch(I[C].charAt(0)){case"X":S=parseInt(I[C].slice(1))-1,++B;break;case"Y":for(_=parseInt(I[C].slice(1))-1,P=j.length;P<=_;++P)j[P]=[];break;case"M":X=parseInt(I[C].slice(1))/20;break;case"F":break;case"G":break;case"P":H=R[parseInt(I[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=I[C].slice(1).split(" "),P=parseInt(F[0],10);P<=parseInt(F[1],10);++P)X=parseInt(F[2],10),V[P-1]=X===0?{hidden:!0}:{wch:X},du(V[P-1]);break;case"C":S=parseInt(I[C].slice(1))-1,V[S]||(V[S]={});break;case"R":_=parseInt(I[C].slice(1))-1,U[_]||(U[_]={}),X>0?(U[_].hpt=X,U[_].hpx=nd(X)):X===0&&(U[_].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+O)}B<1&&(H=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+O)}}return U.length>0&&(Y["!rows"]=U),V.length>0&&(Y["!cols"]=V),g&&g.sheetRows&&(j=j.slice(0,g.sheetRows)),[j,Y]}function o(y,g){var b=n(y,g),_=b[0],S=b[1],E=fd(_,g);return gn(S).forEach(function(C){E[C]=S[C]}),E}function u(y,g){return yu(o(y,g),g)}function f(y,g,b,_){var S="C;Y"+(b+1)+";X"+(_+1)+";K";switch(y.t){case"n":S+=y.v||0,y.f&&!y.F&&(S+=";E"+Nx(y.f,{r:b,c:_}));break;case"b":S+=y.v?"TRUE":"FALSE";break;case"e":S+=y.w||y.v;break;case"d":S+='"'+(y.w||y.v)+'"';break;case"s":S+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function h(y,g){g.forEach(function(b,_){var S="F;W"+(_+1)+" "+(_+1)+" ";b.hidden?S+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=R0(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=D0(b.wpx)),typeof b.wch=="number"&&(S+=Math.round(b.wch))),S.charAt(S.length-1)!=" "&&y.push(S)})}function m(y,g){g.forEach(function(b,_){var S="F;";b.hidden?S+="M0;":b.hpt?S+="M"+20*b.hpt+";":b.hpx&&(S+="M"+20*F0(b.hpx)+";"),S.length>2&&y.push(S+"R"+(_+1))})}function v(y,g){var b=["ID;PWXL;N;E"],_=[],S=ra(y["!ref"]),E,C=Array.isArray(y),j=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),y["!cols"]&&h(b,y["!cols"]),y["!rows"]&&m(b,y["!rows"]),b.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var R=S.s.r;R<=S.e.r;++R)for(var H=S.s.c;H<=S.e.c;++H){var Y=yr({r:R,c:H});E=C?(y[R]||[])[H]:y[Y],!(!E||E.v==null&&(!E.f||E.F))&&_.push(f(E,y,R,H))}return b.join(j)+j+_.join(j)+j+"E"+j}return{to_workbook:u,to_sheet:o,from_sheet:v}})(),sN=(function(){function t(s,o){switch(o.type){case"base64":return e(qi(s),o);case"binary":return e(s,o);case"buffer":return e(Lr&&Buffer.isBuffer(s)?s.toString("binary"):xu(s),o);case"array":return e(xf(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var u=s.split(`
`),f=-1,h=-1,m=0,v=[];m!==u.length;++m){if(u[m].trim()==="BOT"){v[++f]=[],h=0;continue}if(!(f<0)){var y=u[m].trim().split(","),g=y[0],b=y[1];++m;for(var _=u[m]||"";(_.match(/["]/g)||[]).length&1&&m<u.length-1;)_+=`
`+u[++m];switch(_=_.trim(),+g){case-1:if(_==="BOT"){v[++f]=[],h=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?v[f][h]=!0:_==="FALSE"?v[f][h]=!1:isNaN(Yo(b))?isNaN(rd(b).getDate())?v[f][h]=b:v[f][h]=qa(b):v[f][h]=Yo(b),++h;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),v[f][h++]=_!==""?_:null;break}if(_==="EOD")break}}return o&&o.sheetRows&&(v=v.slice(0,o.sheetRows)),v}function r(s,o){return fd(t(s,o),o)}function a(s,o){return yu(r(s,o),o)}var n=(function(){var s=function(f,h,m,v,y){f.push(h),f.push(m+","+v),f.push('"'+y.replace(/"/g,'""')+'"')},o=function(f,h,m,v){f.push(h+","+m),f.push(h==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(f){var h=[],m=ra(f["!ref"]),v,y=Array.isArray(f);s(h,"TABLE",0,1,"sheetjs"),s(h,"VECTORS",0,m.e.r-m.s.r+1,""),s(h,"TUPLES",0,m.e.c-m.s.c+1,""),s(h,"DATA",0,0,"");for(var g=m.s.r;g<=m.e.r;++g){o(h,-1,0,"BOT");for(var b=m.s.c;b<=m.e.c;++b){var _=yr({r:g,c:b});if(v=y?(f[g]||[])[b]:f[_],!v){o(h,1,0,"");continue}switch(v.t){case"n":var S=v.w;!S&&v.v!=null&&(S=v.v),S==null?v.f&&!v.F?o(h,1,0,"="+v.f):o(h,1,0,""):o(h,0,S,"V");break;case"b":o(h,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=fo(v.z||xr[14],Kn(qa(v.v)))),o(h,0,v.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var E=`\r
`,C=h.join(E);return C}})();return{to_workbook:a,to_sheet:r,from_sheet:n}})(),iN=(function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,y){for(var g=v.split(`
`),b=-1,_=-1,S=0,E=[];S!==g.length;++S){var C=g[S].trim().split(":");if(C[0]==="cell"){var j=an(C[1]);if(E.length<=j.r)for(b=E.length;b<=j.r;++b)E[b]||(E[b]=[]);switch(b=j.r,_=j.c,C[2]){case"t":E[b][_]=t(C[3]);break;case"v":E[b][_]=+C[3];break;case"vtf":var R=C[C.length-1];case"vtc":switch(C[3]){case"nl":E[b][_]=!!+C[4];break;default:E[b][_]=+C[4];break}C[2]=="vtf"&&(E[b][_]=[E[b][_],R])}}}return y&&y.sheetRows&&(E=E.slice(0,y.sheetRows)),E}function a(v,y){return fd(r(v,y),y)}function n(v,y){return yu(a(v,y),y)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(v){if(!v||!v["!ref"])return"";for(var y=[],g=[],b,_="",S=di(v["!ref"]),E=Array.isArray(v),C=S.s.r;C<=S.e.r;++C)for(var j=S.s.c;j<=S.e.c;++j)if(_=yr({r:C,c:j}),b=E?(v[C]||[])[j]:v[_],!(!b||b.v==null||b.t==="z")){switch(g=["cell",_,"t"],b.t){case"s":case"str":g.push(e(b.v));break;case"n":b.f?(g[2]="vtf",g[3]="n",g[4]=b.v,g[5]=e(b.f)):(g[2]="v",g[3]=b.v);break;case"b":g[2]="vt"+(b.f?"f":"c"),g[3]="nl",g[4]=b.v?"1":"0",g[5]=e(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var R=Kn(qa(b.v));g[2]="vtc",g[3]="nd",g[4]=""+R,g[5]=b.w||fo(b.z||xr[14],R);break;case"e":continue}y.push(g.join(":"))}return y.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function m(v){return[s,o,u,o,h(v),f].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:m}})(),ad=(function(){function t(m,v,y,g,b){b.raw?v[y][g]=m:m===""||(m==="TRUE"?v[y][g]=!0:m==="FALSE"?v[y][g]=!1:isNaN(Yo(m))?isNaN(rd(m).getDate())?v[y][g]=m:v[y][g]=qa(m):v[y][g]=Yo(m))}function e(m,v){var y=v||{},g=[];if(!m||m.length===0)return g;for(var b=m.split(/[\r\n]/),_=b.length-1;_>=0&&b[_].length===0;)--_;for(var S=10,E=0,C=0;C<=_;++C)E=b[C].indexOf(" "),E==-1?E=b[C].length:E++,S=Math.max(S,E);for(C=0;C<=_;++C){g[C]=[];var j=0;for(t(b[C].slice(0,S).trim(),g,C,j,y),j=1;j<=(b[C].length-S)/10+1;++j)t(b[C].slice(S+(j-1)*10,S+j*10).trim(),g,C,j,y)}return y.sheetRows&&(g=g.slice(0,y.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(m){for(var v={},y=!1,g=0,b=0;g<m.length;++g)(b=m.charCodeAt(g))==34?y=!y:!y&&b in r&&(v[b]=(v[b]||0)+1);b=[];for(g in v)Object.prototype.hasOwnProperty.call(v,g)&&b.push([v[g],g]);if(!b.length){v=a;for(g in v)Object.prototype.hasOwnProperty.call(v,g)&&b.push([v[g],g])}return b.sort(function(_,S){return _[0]-S[0]||a[_[1]]-a[S[1]]}),r[b.pop()[1]]||44}function s(m,v){var y=v||{},g="",b=y.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(g=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(g=m.charAt(4),m=m.slice(6)):g=n(m.slice(0,1024)):y&&y.FS?g=y.FS:g=n(m.slice(0,1024));var S=0,E=0,C=0,j=0,R=0,H=g.charCodeAt(0),Y=!1,U=0,V=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var F=y.dateNF!=null?m8(y.dateNF):null;function X(){var P=m.slice(j,R),O={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)O.t="z";else if(y.raw)O.t="s",O.v=P;else if(P.trim().length===0)O.t="s",O.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(O.t="s",O.v=P.slice(2,-1).replace(/""/g,'"')):HF(P)?(O.t="n",O.f=P.slice(1)):(O.t="s",O.v=P);else if(P=="TRUE")O.t="b",O.v=!0;else if(P=="FALSE")O.t="b",O.v=!1;else if(!isNaN(C=Yo(P)))O.t="n",y.cellText!==!1&&(O.w=P),O.v=C;else if(!isNaN(rd(P).getDate())||F&&P.match(F)){O.z=y.dateNF||xr[14];var I=0;F&&P.match(F)&&(P=p8(P,y.dateNF,P.match(F)||[]),I=1),y.cellDates?(O.t="d",O.v=qa(P,I)):(O.t="n",O.v=Kn(qa(P,I))),y.cellText!==!1&&(O.w=fo(O.z,O.v instanceof Date?Kn(O.v):O.v)),y.cellNF||delete O.z}else O.t="s",O.v=P;if(O.t=="z"||(y.dense?(b[S]||(b[S]=[]),b[S][E]=O):b[yr({c:E,r:S})]=O),j=R+1,V=m.charCodeAt(j),_.e.c<E&&(_.e.c=E),_.e.r<S&&(_.e.r=S),U==H)++E;else if(E=0,++S,y.sheetRows&&y.sheetRows<=S)return!0}e:for(;R<m.length;++R)switch(U=m.charCodeAt(R)){case 34:V===34&&(Y=!Y);break;case H:case 10:case 13:if(!Y&&X())break e;break}return R-j>0&&X(),b["!ref"]=Tr(_),b}function o(m,v){return!(v&&v.PRN)||v.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?s(m,v):fd(e(m,v),v)}function u(m,v){var y="",g=v.type=="string"?[0,0,0,0]:Rx(m,v);switch(v.type){case"base64":y=qi(m);break;case"binary":y=m;break;case"buffer":v.codepage==65001?y=m.toString("utf8"):v.codepage&&typeof N0<"u"||(y=Lr&&Buffer.isBuffer(m)?m.toString("binary"):xu(m));break;case"array":y=xf(m);break;case"string":y=m;break;default:throw new Error("Unrecognized type "+v.type)}return g[0]==239&&g[1]==187&&g[2]==191?y=ka(y.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?y=ka(y):v.type=="binary"&&typeof N0<"u",y.slice(0,19)=="socialcalc:version:"?iN.to_sheet(v.type=="string"?y:ka(y),v):o(y,v)}function f(m,v){return yu(u(m,v),v)}function h(m){for(var v=[],y=ra(m["!ref"]),g,b=Array.isArray(m),_=y.s.r;_<=y.e.r;++_){for(var S=[],E=y.s.c;E<=y.e.c;++E){var C=yr({r:_,c:E});if(g=b?(m[_]||[])[E]:m[C],!g||g.v==null){S.push("          ");continue}for(var j=(g.w||(dc(g),g.w)||"").slice(0,10);j.length<10;)j+=" ";S.push(j+(E===0?" ":""))}v.push(S.join(""))}return v.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:h}})();function CR(t,e){var r=e||{},a=!!r.WTF;r.WTF=!0;try{var n=nN.to_workbook(t,r);return r.WTF=a,n}catch(s){if(r.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return ad.to_workbook(t,e)}}var mf=(function(){function t(A,D,B){if(A){ys(A,A.l||0);for(var q=B.Enum||ue;A.l<A.length;){var Z=A.read_shift(2),oe=q[Z]||q[65535],pe=A.read_shift(2),_e=A.l+pe,be=oe.f&&oe.f(A,pe,B);if(A.l=_e,D(be,oe,Z))return}}}function e(A,D){switch(D.type){case"base64":return r(Pi(qi(A)),D);case"binary":return r(Pi(A),D);case"buffer":case"array":return r(A,D)}throw"Unsupported type "+D.type}function r(A,D){if(!A)return A;var B=D||{},q=B.dense?[]:{},Z="Sheet1",oe="",pe=0,_e={},be=[],Le=[],he={s:{r:0,c:0},e:{r:0,c:0}},Ae=B.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)B.Enum=ue,t(A,function(Oe,rt,tt){switch(tt){case 0:B.vers=Oe,Oe>=4096&&(B.qpro=!0);break;case 6:he=Oe;break;case 204:Oe&&(oe=Oe);break;case 222:oe=Oe;break;case 15:case 51:B.qpro||(Oe[1].v=Oe[1].v.slice(1));case 13:case 14:case 16:tt==14&&(Oe[2]&112)==112&&(Oe[2]&15)>1&&(Oe[2]&15)<15&&(Oe[1].z=B.dateNF||xr[14],B.cellDates&&(Oe[1].t="d",Oe[1].v=m1(Oe[1].v))),B.qpro&&Oe[3]>pe&&(q["!ref"]=Tr(he),_e[Z]=q,be.push(Z),q=B.dense?[]:{},he={s:{r:0,c:0},e:{r:0,c:0}},pe=Oe[3],Z=oe||"Sheet"+(pe+1),oe="");var Et=B.dense?(q[Oe[0].r]||[])[Oe[0].c]:q[yr(Oe[0])];if(Et){Et.t=Oe[1].t,Et.v=Oe[1].v,Oe[1].z!=null&&(Et.z=Oe[1].z),Oe[1].f!=null&&(Et.f=Oe[1].f);break}B.dense?(q[Oe[0].r]||(q[Oe[0].r]=[]),q[Oe[0].r][Oe[0].c]=Oe[1]):q[yr(Oe[0])]=Oe[1];break}},B);else if(A[2]==26||A[2]==14)B.Enum=M,A[2]==14&&(B.qpro=!0,A.l=0),t(A,function(Oe,rt,tt){switch(tt){case 204:Z=Oe;break;case 22:Oe[1].v=Oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Oe[3]>pe&&(q["!ref"]=Tr(he),_e[Z]=q,be.push(Z),q=B.dense?[]:{},he={s:{r:0,c:0},e:{r:0,c:0}},pe=Oe[3],Z="Sheet"+(pe+1)),Ae>0&&Oe[0].r>=Ae)break;B.dense?(q[Oe[0].r]||(q[Oe[0].r]=[]),q[Oe[0].r][Oe[0].c]=Oe[1]):q[yr(Oe[0])]=Oe[1],he.e.c<Oe[0].c&&(he.e.c=Oe[0].c),he.e.r<Oe[0].r&&(he.e.r=Oe[0].r);break;case 27:Oe[14e3]&&(Le[Oe[14e3][0]]=Oe[14e3][1]);break;case 1537:Le[Oe[0]]=Oe[1],Oe[0]==pe&&(Z=Oe[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(q["!ref"]=Tr(he),_e[oe||Z]=q,be.push(oe||Z),!Le.length)return{SheetNames:be,Sheets:_e};for(var de={},re=[],Ke=0;Ke<Le.length;++Ke)_e[be[Ke]]?(re.push(Le[Ke]||be[Ke]),de[Le[Ke]]=_e[Le[Ke]]||_e[be[Ke]]):(re.push(Le[Ke]),de[Le[Ke]]={"!ref":"A1"});return{SheetNames:re,Sheets:de}}function a(A,D){var B=D||{};if(+B.codepage>=0&&Vo(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var q=hi(),Z=ra(A["!ref"]),oe=Array.isArray(A),pe=[];It(q,0,s(1030)),It(q,6,f(Z));for(var _e=Math.min(Z.e.r,8191),be=Z.s.r;be<=_e;++be)for(var Le=En(be),he=Z.s.c;he<=Z.e.c;++he){be===Z.s.r&&(pe[he]=rn(he));var Ae=pe[he]+Le,de=oe?(A[be]||[])[he]:A[Ae];if(!(!de||de.t=="z"))if(de.t=="n")(de.v|0)==de.v&&de.v>=-32768&&de.v<=32767?It(q,13,g(be,he,de.v)):It(q,14,_(be,he,de.v));else{var re=dc(de);It(q,15,v(be,he,re.slice(0,239)))}}return It(q,1),q.end()}function n(A,D){var B=D||{};if(+B.codepage>=0&&Vo(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var q=hi();It(q,0,o(A));for(var Z=0,oe=0;Z<A.SheetNames.length;++Z)(A.Sheets[A.SheetNames[Z]]||{})["!ref"]&&It(q,27,K(A.SheetNames[Z],oe++));var pe=0;for(Z=0;Z<A.SheetNames.length;++Z){var _e=A.Sheets[A.SheetNames[Z]];if(!(!_e||!_e["!ref"])){for(var be=ra(_e["!ref"]),Le=Array.isArray(_e),he=[],Ae=Math.min(be.e.r,8191),de=be.s.r;de<=Ae;++de)for(var re=En(de),Ke=be.s.c;Ke<=be.e.c;++Ke){de===be.s.r&&(he[Ke]=rn(Ke));var Oe=he[Ke]+re,rt=Le?(_e[de]||[])[Ke]:_e[Oe];if(!(!rt||rt.t=="z"))if(rt.t=="n")It(q,23,X(de,Ke,pe,rt.v));else{var tt=dc(rt);It(q,22,U(de,Ke,pe,tt.slice(0,239)))}}++pe}}return It(q,1),q.end()}function s(A){var D=lt(2);return D.write_shift(2,A),D}function o(A){var D=lt(26);D.write_shift(2,4096),D.write_shift(2,4),D.write_shift(4,0);for(var B=0,q=0,Z=0,oe=0;oe<A.SheetNames.length;++oe){var pe=A.SheetNames[oe],_e=A.Sheets[pe];if(!(!_e||!_e["!ref"])){++Z;var be=di(_e["!ref"]);B<be.e.r&&(B=be.e.r),q<be.e.c&&(q=be.e.c)}}return B>8191&&(B=8191),D.write_shift(2,B),D.write_shift(1,Z),D.write_shift(1,q),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(1,1),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(4,0),D}function u(A,D,B){var q={s:{c:0,r:0},e:{c:0,r:0}};return D==8&&B.qpro?(q.s.c=A.read_shift(1),A.l++,q.s.r=A.read_shift(2),q.e.c=A.read_shift(1),A.l++,q.e.r=A.read_shift(2),q):(q.s.c=A.read_shift(2),q.s.r=A.read_shift(2),D==12&&B.qpro&&(A.l+=2),q.e.c=A.read_shift(2),q.e.r=A.read_shift(2),D==12&&B.qpro&&(A.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function f(A){var D=lt(8);return D.write_shift(2,A.s.c),D.write_shift(2,A.s.r),D.write_shift(2,A.e.c),D.write_shift(2,A.e.r),D}function h(A,D,B){var q=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(q[0].c=A.read_shift(1),q[3]=A.read_shift(1),q[0].r=A.read_shift(2),A.l+=2):(q[2]=A.read_shift(1),q[0].c=A.read_shift(2),q[0].r=A.read_shift(2)),q}function m(A,D,B){var q=A.l+D,Z=h(A,D,B);if(Z[1].t="s",B.vers==20768){A.l++;var oe=A.read_shift(1);return Z[1].v=A.read_shift(oe,"utf8"),Z}return B.qpro&&A.l++,Z[1].v=A.read_shift(q-A.l,"cstr"),Z}function v(A,D,B){var q=lt(7+B.length);q.write_shift(1,255),q.write_shift(2,D),q.write_shift(2,A),q.write_shift(1,39);for(var Z=0;Z<q.length;++Z){var oe=B.charCodeAt(Z);q.write_shift(1,oe>=128?95:oe)}return q.write_shift(1,0),q}function y(A,D,B){var q=h(A,D,B);return q[1].v=A.read_shift(2,"i"),q}function g(A,D,B){var q=lt(7);return q.write_shift(1,255),q.write_shift(2,D),q.write_shift(2,A),q.write_shift(2,B,"i"),q}function b(A,D,B){var q=h(A,D,B);return q[1].v=A.read_shift(8,"f"),q}function _(A,D,B){var q=lt(13);return q.write_shift(1,255),q.write_shift(2,D),q.write_shift(2,A),q.write_shift(8,B,"f"),q}function S(A,D,B){var q=A.l+D,Z=h(A,D,B);if(Z[1].v=A.read_shift(8,"f"),B.qpro)A.l=q;else{var oe=A.read_shift(2);R(A.slice(A.l,A.l+oe),Z),A.l+=oe}return Z}function E(A,D,B){var q=D&32768;return D&=-32769,D=(q?A:0)+(D>=8192?D-16384:D),(q?"":"$")+(B?rn(D):En(D))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},j=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(A,D){ys(A,0);for(var B=[],q=0,Z="",oe="",pe="",_e="";A.l<A.length;){var be=A[A.l++];switch(be){case 0:B.push(A.read_shift(8,"f"));break;case 1:oe=E(D[0].c,A.read_shift(2),!0),Z=E(D[0].r,A.read_shift(2),!1),B.push(oe+Z);break;case 2:{var Le=E(D[0].c,A.read_shift(2),!0),he=E(D[0].r,A.read_shift(2),!1);oe=E(D[0].c,A.read_shift(2),!0),Z=E(D[0].r,A.read_shift(2),!1),B.push(Le+he+":"+oe+Z)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(A.read_shift(2));break;case 6:{for(var Ae="";be=A[A.l++];)Ae+=String.fromCharCode(be);B.push('"'+Ae.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:_e=B.pop(),pe=B.pop(),B.push(["AND","OR"][be-20]+"("+pe+","+_e+")");break;default:if(be<32&&j[be])_e=B.pop(),pe=B.pop(),B.push(pe+j[be]+_e);else if(C[be]){if(q=C[be][1],q==69&&(q=A[A.l++]),q>B.length){console.error("WK1 bad formula parse 0x"+be.toString(16)+":|"+B.join("|")+"|");return}var de=B.slice(-q);B.length-=q,B.push(C[be][0]+"("+de.join(",")+")")}else return be<=7?console.error("WK1 invalid opcode "+be.toString(16)):be<=24?console.error("WK1 unsupported op "+be.toString(16)):be<=30?console.error("WK1 invalid opcode "+be.toString(16)):be<=115?console.error("WK1 unsupported function opcode "+be.toString(16)):console.error("WK1 unrecognized opcode "+be.toString(16))}}B.length==1?D[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function H(A){var D=[{c:0,r:0},{t:"n",v:0},0];return D[0].r=A.read_shift(2),D[3]=A[A.l++],D[0].c=A[A.l++],D}function Y(A,D){var B=H(A);return B[1].t="s",B[1].v=A.read_shift(D-4,"cstr"),B}function U(A,D,B,q){var Z=lt(6+q.length);Z.write_shift(2,A),Z.write_shift(1,B),Z.write_shift(1,D),Z.write_shift(1,39);for(var oe=0;oe<q.length;++oe){var pe=q.charCodeAt(oe);Z.write_shift(1,pe>=128?95:pe)}return Z.write_shift(1,0),Z}function V(A,D){var B=H(A);B[1].v=A.read_shift(2);var q=B[1].v>>1;if(B[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return B[1].v=q,B}function F(A,D){var B=H(A),q=A.read_shift(4),Z=A.read_shift(4),oe=A.read_shift(2);if(oe==65535)return q===0&&Z===3221225472?(B[1].t="e",B[1].v=15):q===0&&Z===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var pe=oe&32768;return oe=(oe&32767)-16446,B[1].v=(1-pe*2)*(Z*Math.pow(2,oe+32)+q*Math.pow(2,oe)),B}function X(A,D,B,q){var Z=lt(14);if(Z.write_shift(2,A),Z.write_shift(1,B),Z.write_shift(1,D),q==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var oe=0,pe=0,_e=0,be=0;return q<0&&(oe=1,q=-q),pe=Math.log2(q)|0,q/=Math.pow(2,pe-31),be=q>>>0,(be&2147483648)==0&&(q/=2,++pe,be=q>>>0),q-=be,be|=2147483648,be>>>=0,q*=Math.pow(2,32),_e=q>>>0,Z.write_shift(4,_e),Z.write_shift(4,be),pe+=16383+(oe?32768:0),Z.write_shift(2,pe),Z}function P(A,D){var B=F(A);return A.l+=D-14,B}function O(A,D){var B=H(A),q=A.read_shift(4);return B[1].v=q>>6,B}function I(A,D){var B=H(A),q=A.read_shift(8,"f");return B[1].v=q,B}function W(A,D){var B=I(A);return A.l+=D-10,B}function ne(A,D){return A[A.l+D-1]==0?A.read_shift(D,"cstr"):""}function Q(A,D){var B=A[A.l++];B>D-1&&(B=D-1);for(var q="";q.length<B;)q+=String.fromCharCode(A[A.l++]);return q}function le(A,D,B){if(!(!B.qpro||D<21)){var q=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var Z=A.read_shift(D-21,"cstr");return[q,Z]}}function ee(A,D){for(var B={},q=A.l+D;A.l<q;){var Z=A.read_shift(2);if(Z==14e3){for(B[Z]=[0,""],B[Z][0]=A.read_shift(2);A[A.l];)B[Z][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return B}function K(A,D){var B=lt(5+A.length);B.write_shift(2,14e3),B.write_shift(2,D);for(var q=0;q<A.length;++q){var Z=A.charCodeAt(q);B[B.l++]=Z>127?95:Z}return B[B.l++]=0,B}var ue={0:{n:"BOF",f:Pn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ne},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},M={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Y},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:O},38:{n:"??"},39:{n:"NUMBER27",f:I},40:{n:"FORMULA28",f:W},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:e}})();function TR(t){var e={},r=t.match(Ms),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=_r(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=X2[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return e}var OR=(function(){var t=E0("t"),e=E0("rPr");function r(s){var o=s.match(t);if(!o)return{t:"s",v:""};var u={t:"s",v:ta(o[1])},f=s.match(e);return f&&(u.s=TR(f[1])),u}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(n).map(r).filter(function(u){return u.v})}})(),RR=(function(){var e=/(\r\n|\n)/g;function r(n,s,o){var u=[];n.u&&u.push("text-decoration: underline;"),n.uval&&u.push("text-underline-style:"+n.uval+";"),n.sz&&u.push("font-size:"+n.sz+"pt;"),n.outline&&u.push("text-effect: outline;"),n.shadow&&u.push("text-shadow: auto;"),s.push('<span style="'+u.join("")+'">'),n.b&&(s.push("<b>"),o.push("</b>")),n.i&&(s.push("<i>"),o.push("</i>")),n.strike&&(s.push("<s>"),o.push("</s>"));var f=n.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(s.push("<"+f+">"),o.push("</"+f+">")),o.push("</span>"),n}function a(n){var s=[[],n.v,[]];return n.v?(n.s&&r(n.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}})(),DR=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,FR=/<(?:\w+:)?r>/,LR=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function yx(t,e){var r=e?e.cellHTML:!0,a={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=ta(ka(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=ka(t),r&&(a.h=sx(a.t))):t.match(FR)&&(a.r=ka(t),a.t=ta(ka((t.replace(LR,"").match(DR)||[]).join("").replace(Ms,""))),r&&(a.h=RR(OR(a.r)))),a):{t:""}}var PR=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,MR=/<(?:\w+:)?(?:si|sstItem)>/g,IR=/<\/(?:\w+:)?(?:si|sstItem)>/;function BR(t,e){var r=[],a="";if(!t)return r;var n=t.match(PR);if(n){a=n[2].replace(MR,"").split(IR);for(var s=0;s!=a.length;++s){var o=yx(a[s].trim(),e);o!=null&&(r[r.length]=o)}n=_r(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var UR=/^\s|\s$|[\t\n\r]/;function oN(t,e){if(!e.bookSST)return"";var r=[An];r[r.length]=Pt("sst",null,{xmlns:Af[0],count:t.Count,uniqueCount:t.Unique});for(var a=0;a!=t.length;++a)if(t[a]!=null){var n=t[a],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(UR)&&(s+=' xml:space="preserve"'),s+=">"+xa(n.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function qR(t){return[t.read_shift(4),t.read_shift(4)]}function zR(t,e){var r=[],a=!1;return vc(t,function(s,o,u){switch(u){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function HR(t,e){return e||(e=lt(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var $R=eO;function WR(t){var e=hi();wt(e,159,HR(t));for(var r=0;r<t.length;++r)wt(e,19,$R(t[r]));return wt(e,160),e.end()}function lN(t){for(var e=[],r=t.split(""),a=0;a<r.length;++a)e[a]=r[a].charCodeAt(0);return e}function fc(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function VR(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=fc(t,4),e.U=fc(t,4),e.W=fc(t,4),e}function GR(t){for(var e=t.read_shift(4),r=t.l+e-4,a={},n=t.read_shift(4),s=[];n-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(a.name=t.read_shift(0,"lpp4"),a.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return a}function YR(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(GR(t));return e}function XR(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function KR(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=fc(t,4),e.U=fc(t,4),e.W=fc(t,4),e}function JR(t){var e=KR(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function cN(t,e){var r=t.l+e,a={};a.Flags=t.read_shift(4)&63,t.l+=4,a.AlgID=t.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=t.read_shift(4),a.KeySize=t.read_shift(4),a.ProviderType=t.read_shift(4),t.l+=8,a.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,a}function uN(t,e){var r={},a=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,a),t.l=a,r}function ZR(t){var e=fc(t);switch(e.Minor){case 2:return[e.Minor,QR(t)];case 3:return[e.Minor,eD()];case 4:return[e.Minor,tD(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function QR(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),a=cN(t,r),n=uN(t,t.length-t.l);return{t:"Std",h:a,v:n}}function eD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function tD(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),a={};return r.replace(Ms,function(s){var o=_r(s);switch(El(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){a[u]=o[u]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function rD(t,e){var r={},a=r.EncryptionVersionInfo=fc(t,4);if(e-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=t.read_shift(4),e-=4;var n=t.read_shift(4);return e-=4,r.EncryptionHeader=cN(t,n),e-=n,r.EncryptionVerifier=uN(t,e),r}function aD(t){var e={},r=e.EncryptionVersionInfo=fc(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function _x(t){var e=0,r,a=lN(t),n=a.length+1,s,o,u,f,h;for(r=hu(n),r[0]=a.length,s=1;s!=n;++s)r[s]=a[s-1];for(s=n-1;s>=0;--s)o=r[s],u=(e&16384)===0?0:1,f=e<<1&32767,h=u|f,e=h^o;return e^52811}var fN=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},n=function(o,u){return a(o^u)},s=function(o){for(var u=e[o.length-1],f=104,h=o.length-1;h>=0;--h)for(var m=o[h],v=0;v!=7;++v)m&64&&(u^=r[f]),m*=2,--f;return u};return function(o){for(var u=lN(o),f=s(u),h=u.length,m=hu(16),v=0;v!=16;++v)m[v]=0;var y,g,b;for((h&1)===1&&(y=f>>8,m[h]=n(t[0],y),--h,y=f&255,g=u[u.length-1],m[h]=n(g,y));h>0;)--h,y=f>>8,m[h]=n(u[h],y),--h,y=f&255,m[h]=n(u[h],y);for(h=15,b=15-u.length;b>0;)y=f>>8,m[h]=n(t[b],y),--h,--b,y=f&255,m[h]=n(u[h],y),--h,--b;return m}})(),nD=function(t,e,r,a,n){n||(n=e),a||(a=fN(t));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=a[r],o=(o>>5|o<<3)&255,n[s]=o,++r;return[n,r,a]},sD=function(t){var e=0,r=fN(t);return function(a){var n=nD("",a,e,r);return e=n[1],n[0]}};function iD(t,e,r,a){var n={key:Pn(t),verificationBytes:Pn(t)};return r.password&&(n.verifier=_x(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=sD(r.password)),n}function oD(t,e,r){var a=r||{};return a.Info=t.read_shift(2),t.l-=2,a.Info===1?a.Data=aD(t):a.Data=rD(t,e),a}function lD(t,e,r){var a={Type:r.biff>=8?t.read_shift(2):0};return a.Type?oD(t,e-2,a):iD(t,r.biff>=8?e:e-2,r,a),a}var hN=(function(){function t(n,s){switch(s.type){case"base64":return e(qi(n),s);case"binary":return e(n,s);case"buffer":return e(Lr&&Buffer.isBuffer(n)?n.toString("binary"):xu(n),s);case"array":return e(xf(n),s)}throw new Error("Unrecognized type "+s.type)}function e(n,s){var o=s||{},u=o.dense?[]:{},f=n.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(m,v){Array.isArray(u)&&(u[v]=[]);for(var y=/\\\w+\b/g,g=0,b,_=-1;b=y.exec(m);){switch(b[0]){case"\\cell":var S=m.slice(g,y.lastIndex-b[0].length);if(S[0]==" "&&(S=S.slice(1)),++_,S.length){var E={v:S,t:"s"};Array.isArray(u)?u[v][_]=E:u[yr({r:v,c:_})]=E}break}g=y.lastIndex}_>h.e.c&&(h.e.c=_)}),u["!ref"]=Tr(h),u}function r(n,s){return yu(t(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],o=ra(n["!ref"]),u,f=Array.isArray(n),h=o.s.r;h<=o.e.r;++h){s.push("\\trowd\\trautofit1");for(var m=o.s.c;m<=o.e.c;++m)s.push("\\cellx"+(m+1));for(s.push("\\pard\\intbl"),m=o.s.c;m<=o.e.c;++m){var v=yr({r:h,c:m});u=f?(n[h]||[])[m]:n[v],!(!u||u.v==null&&(!u.f||u.F))&&(s.push(" "+(u.w||(dc(u),u.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:a}})();function cD(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function O0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function uD(t){var e=t[0]/255,r=t[1]/255,a=t[2]/255,n=Math.max(e,r,a),s=Math.min(e,r,a),o=n-s;if(o===0)return[0,0,e];var u=0,f=0,h=n+s;switch(f=o/(h>1?2-h:h),n){case e:u=((r-a)/o+6)%6;break;case r:u=(a-e)/o+2;break;case a:u=(e-r)/o+4;break}return[u/6,f,h/2]}function fD(t){var e=t[0],r=t[1],a=t[2],n=r*2*(a<.5?a:1-a),s=a-n/2,o=[s,s,s],u=6*e,f;if(r!==0)switch(u|0){case 0:case 6:f=n*u,o[0]+=n,o[1]+=f;break;case 1:f=n*(2-u),o[0]+=f,o[1]+=n;break;case 2:f=n*(u-2),o[1]+=n,o[2]+=f;break;case 3:f=n*(4-u),o[1]+=f,o[2]+=n;break;case 4:f=n*(u-4),o[2]+=n,o[0]+=f;break;case 5:f=n*(6-u),o[2]+=f,o[0]+=n;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function Xp(t,e){if(e===0)return t;var r=uD(cD(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),O0(fD(r))}var dN=6,hD=15,dD=1,Ds=dN;function R0(t){return Math.floor((t+Math.round(128/Ds)/256)*Ds)}function D0(t){return Math.floor((t-5)/Ds*100+.5)/100}function Kp(t){return Math.round((t*Ds+5)/Ds*256)/256}function av(t){return Kp(D0(R0(t)))}function bx(t){var e=Math.abs(t-av(t)),r=Ds;if(e>.005)for(Ds=dD;Ds<hD;++Ds)Math.abs(t-av(t))<=e&&(e=Math.abs(t-av(t)),r=Ds);Ds=r}function du(t){t.width?(t.wpx=R0(t.width),t.wch=D0(t.wpx),t.MDW=Ds):t.wpx?(t.wch=D0(t.wpx),t.width=Kp(t.wch),t.MDW=Ds):typeof t.wch=="number"&&(t.width=Kp(t.wch),t.wpx=R0(t.width),t.MDW=Ds),t.customWidth&&delete t.customWidth}var mD=96,mN=mD;function F0(t){return t*96/mN}function nd(t){return t*mN/96}var pD={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function gD(t,e,r,a){e.Borders=[];var n={},s=!1;(t[0].match(Ms)||[]).forEach(function(o){var u=_r(o);switch(El(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},u.diagonalUp&&(n.diagonalUp=Ba(u.diagonalUp)),u.diagonalDown&&(n.diagonalDown=Ba(u.diagonalDown)),e.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+u[0]+" in borders")}})}function vD(t,e,r,a){e.Fills=[];var n={},s=!1;(t[0].match(Ms)||[]).forEach(function(o){var u=_r(o);switch(El(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},e.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":u.patternType&&(n.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),u.indexed&&(n.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(n.bgColor.theme=parseInt(u.theme,10)),u.tint&&(n.bgColor.tint=parseFloat(u.tint)),u.rgb&&(n.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),u.theme&&(n.fgColor.theme=parseInt(u.theme,10)),u.tint&&(n.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(n.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fills")}})}function xD(t,e,r,a){e.Fonts=[];var n={},s=!1;(t[0].match(Ms)||[]).forEach(function(o){var u=_r(o);switch(El(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(n),n={};break;case"<name":u.val&&(n.name=ka(u.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=u.val?Ba(u.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=u.val?Ba(u.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(u.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=u.val?Ba(u.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=u.val?Ba(u.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=u.val?Ba(u.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=u.val?Ba(u.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=u.val?Ba(u.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":u.val&&(n.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(n.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(n.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(n.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=X2[parseInt(u.val,10)];break;case"<color":if(n.color||(n.color={}),u.auto&&(n.color.auto=Ba(u.auto)),u.rgb)n.color.rgb=u.rgb.slice(-6);else if(u.indexed){n.color.index=parseInt(u.indexed,10);var f=hf[n.color.index];n.color.index==81&&(f=hf[1]),f||(f=hf[1]),n.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(n.color.theme=parseInt(u.theme,10),u.tint&&(n.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=Xp(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fonts")}})}function yD(t,e,r){e.NumberFmt=[];for(var a=gn(xr),n=0;n<a.length;++n)e.NumberFmt[a[n]]=xr[a[n]];var s=t[0].match(Ms);if(s)for(n=0;n<s.length;++n){var o=_r(s[n]);switch(El(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=ta(ka(o.formatCode)),f=parseInt(o.numFmtId,10);if(e.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=u}uc(u,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function _D(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)t[a]!=null&&(e[e.length]=Pt("numFmt",null,{numFmtId:a,formatCode:xa(t[a])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Pt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var cp=["numFmtId","fillId","fontId","borderId","xfId"],up=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function bD(t,e,r){e.CellXf=[];var a,n=!1;(t[0].match(Ms)||[]).forEach(function(s){var o=_r(s),u=0;switch(El(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],u=0;u<cp.length;++u)a[cp[u]]&&(a[cp[u]]=parseInt(a[cp[u]],10));for(u=0;u<up.length;++u)a[up[u]]&&(a[up[u]]=Ba(a[up[u]]));if(e.NumberFmt&&a.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[a.numFmtId]==e.NumberFmt[u]){a.numFmtId=u;break}}e.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};o.vertical&&(f.vertical=o.vertical),o.horizontal&&(f.horizontal=o.horizontal),o.textRotation!=null&&(f.textRotation=o.textRotation),o.indent&&(f.indent=o.indent),o.wrapText&&(f.wrapText=Ba(o.wrapText)),a.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function wD(t){var e=[];return e[e.length]=Pt("cellXfs",null),t.forEach(function(r){e[e.length]=Pt("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Pt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var SD=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,h){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(e))&&yD(v,m,h),(v=u.match(n))&&xD(v,m,f,h),(v=u.match(a))&&vD(v,m,f,h),(v=u.match(s))&&gD(v,m,f,h),(v=u.match(r))&&bD(v,m,h),m}})();function pN(t,e){var r=[An,Pt("styleSheet",null,{xmlns:Af[0],"xmlns:vt":Xn.vt})],a;return t.SSF&&(a=_D(t.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=wD(e.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ND(t,e){var r=t.read_shift(2),a=Ls(t);return[r,a]}function kD(t,e,r){r||(r=lt(6+4*e.length)),r.write_shift(2,t),os(e,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function jD(t,e,r){var a={};a.sz=t.read_shift(2)/20;var n=oO(t);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=t.read_shift(2);switch(s===700&&(a.bold=1),t.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(a.underline=o);var u=t.read_shift(1);u>0&&(a.family=u);var f=t.read_shift(1);switch(f>0&&(a.charset=f),t.l++,a.color=iO(t),t.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Ls(t),a}function ED(t,e){e||(e=lt(153)),e.write_shift(2,t.sz*20),lO(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Vp(t.color,e);var a=0;return a=2,e.write_shift(1,a),os(t.name,e),e.length>e.l?e.slice(0,e.l):e}var AD=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],nv,CD=Ps;function qw(t,e){e||(e=lt(84)),nv||(nv=h1(AD));var r=nv[t.patternType];r==null&&(r=40),e.write_shift(4,r);var a=0;if(r!=40)for(Vp({auto:1},e),Vp({auto:1},e);a<12;++a)e.write_shift(4,0);else{for(;a<4;++a)e.write_shift(4,0);for(;a<12;++a)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function TD(t,e){var r=t.l+e,a=t.read_shift(2),n=t.read_shift(2);return t.l=r,{ixfe:a,numFmtId:n}}function gN(t,e,r){r||(r=lt(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Zd(t,e){return e||(e=lt(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var OD=Ps;function RD(t,e){return e||(e=lt(51)),e.write_shift(1,0),Zd(null,e),Zd(null,e),Zd(null,e),Zd(null,e),Zd(null,e),e.length>e.l?e.slice(0,e.l):e}function DD(t,e){return e||(e=lt(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Wp(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function FD(t,e,r){var a=lt(2052);return a.write_shift(4,t),Wp(e,a),Wp(r,a),a.length>a.l?a.slice(0,a.l):a}function LD(t,e,r){var a={};a.NumberFmt=[];for(var n in xr)a.NumberFmt[n]=xr[n];a.CellXf=[],a.Fonts=[];var s=[],o=!1;return vc(t,function(f,h,m){switch(m){case 44:a.NumberFmt[f[0]]=f[1],uc(f[1],f[0]);break;case 43:a.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=Xp(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(m),o=!0;break;case 38:s.pop(),o=!1;break;default:if(h.T>0)s.push(m);else if(h.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),a}function PD(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&++r}),r!=0&&(wt(t,615,Xo(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&wt(t,44,kD(n,e[n]))}),wt(t,616))}}function MD(t){var e=1;wt(t,611,Xo(e)),wt(t,43,ED({sz:12,color:{theme:1},name:"Calibri",family:2})),wt(t,612)}function ID(t){var e=2;wt(t,603,Xo(e)),wt(t,45,qw({patternType:"none"})),wt(t,45,qw({patternType:"gray125"})),wt(t,604)}function BD(t){var e=1;wt(t,613,Xo(e)),wt(t,46,RD()),wt(t,614)}function UD(t){var e=1;wt(t,626,Xo(e)),wt(t,47,gN({numFmtId:0},65535)),wt(t,627)}function qD(t,e){wt(t,617,Xo(e.length)),e.forEach(function(r){wt(t,47,gN(r,0))}),wt(t,618)}function zD(t){var e=1;wt(t,619,Xo(e)),wt(t,48,DD({xfId:0,name:"Normal"})),wt(t,620)}function HD(t){var e=0;wt(t,505,Xo(e)),wt(t,506)}function $D(t){var e=0;wt(t,508,FD(e,"TableStyleMedium9","PivotStyleMedium4")),wt(t,509)}function WD(t,e){var r=hi();return wt(r,278),PD(r,t.SSF),MD(r),ID(r),BD(r),UD(r),qD(r,e.cellXfs),zD(r),HD(r),$D(r),wt(r,279),r.end()}var VD=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function GD(t,e,r){e.themeElements.clrScheme=[];var a={};(t[0].match(Ms)||[]).forEach(function(n){var s=_r(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[VD.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function YD(){}function XD(){}var KD=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,JD=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ZD=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function QD(t,e,r){e.themeElements={};var a;[["clrScheme",KD,GD],["fontScheme",JD,YD],["fmtScheme",ZD,XD]].forEach(function(n){if(!(a=t.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,e,r)})}var eF=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function vN(t,e){(!t||t.length===0)&&(t=wx());var r,a={};if(!(r=t.match(eF)))throw new Error("themeElements not found in theme");return QD(r[0],a,e),a.raw=t,a}function wx(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[An];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function tF(t,e,r){var a=t.l+e,n=t.read_shift(4);if(n!==124226){if(!r.cellStyles){t.l=a;return}var s=t.slice(t.l);t.l=a;var o;try{o=c3(s,{type:"array"})}catch{return}var u=Mi(o,"theme/theme/theme1.xml",!0);if(u)return vN(u,r)}}function rF(t){return t.read_shift(4)}function aF(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=nF(t,4);break;case 2:e.xclrValue=K3(t);break;case 3:e.xclrValue=rF(t);break;case 4:t.l+=4;break}return t.l+=8,e}function nF(t,e){return Ps(t,e)}function sF(t,e){return Ps(t,e)}function iF(t){var e=t.read_shift(2),r=t.read_shift(2)-4,a=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=aF(t);break;case 6:a[1]=sF(t,r);break;case 14:case 15:a[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return a}function oF(t,e){var r=t.l+e;t.l+=2;var a=t.read_shift(2);t.l+=2;for(var n=t.read_shift(2),s=[];n-- >0;)s.push(iF(t,r-t.l));return{ixfe:a,ext:s}}function lF(t,e){e.forEach(function(r){r[0]})}function cF(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ls(t)}}function uF(t){var e=lt(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),os(t.name,e),e.slice(0,e.l)}function fF(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function hF(t){var e=lt(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function dF(t,e){var r=lt(8+2*e.length);return r.write_shift(4,t),os(e,r),r.slice(0,r.l)}function mF(t){return t.l+=4,t.read_shift(4)!=0}function pF(t,e){var r=lt(8);return r.write_shift(4,t),r.write_shift(4,1),r}function gF(t,e,r){var a={Types:[],Cell:[],Value:[]},n=r||{},s=[],o=!1,u=2;return vc(t,function(f,h,m){switch(m){case 335:a.Types.push({name:f.name});break;case 51:f.forEach(function(v){u==1?a.Cell.push({type:a.Types[v[0]-1].name,index:v[1]}):u==0&&a.Value.push({type:a.Types[v[0]-1].name,index:v[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:s.push(m),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!h.T){if(!o||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),a}function vF(){var t=hi();return wt(t,332),wt(t,334,Xo(1)),wt(t,335,uF({name:"XLDAPR",version:12e4,flags:3496657072})),wt(t,336),wt(t,339,dF(1,"XLDAPR")),wt(t,52),wt(t,35,Xo(514)),wt(t,4096,Xo(0)),wt(t,4097,co(1)),wt(t,36),wt(t,53),wt(t,340),wt(t,337,pF(1)),wt(t,51,hF([[1,0]])),wt(t,338),wt(t,333),t.end()}function xF(t,e,r){var a={Types:[],Cell:[],Value:[]};if(!t)return a;var n=!1,s=2,o;return t.replace(Ms,function(u){var f=_r(u);switch(El(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<a.Types.length;++h)a.Types[h].name==f.name&&(o=a.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[f.t-1].name,index:+f.v}):s==0&&a.Value.push({type:a.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+f.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),a}function xN(){var t=[An];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function yF(t){var e=[];if(!t)return e;var r=1;return(t.match(Ms)||[]).forEach(function(a){var n=_r(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,e.push(n);break}}),e}function _F(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=yr(r);var a=t.read_shift(1);return a&2&&(e.l="1"),a&8&&(e.a="1"),e}function bF(t,e,r){var a=[];return vc(t,function(s,o,u){switch(u){case 63:a.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function wF(t,e,r,a){if(!t)return t;var n=a||{},s=!1;vc(t,function(u,f,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!f.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},n)}function SF(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var zh=1024;function yN(t,e){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Pt("xml",null,{"xmlns:v":Ri.v,"xmlns:o":Ri.o,"xmlns:x":Ri.x,"xmlns:mv":Ri.mv}).replace(/\/>/,">"),Pt("o:shapelayout",Pt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Pt("v:shapetype",[Pt("v:stroke",null,{joinstyle:"miter"}),Pt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];zh<t*1e3;)zh+=1e3;return e.forEach(function(s){var o=an(s[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?Pt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Pt("v:fill",f,u),m={on:"t",obscured:"t"};++zh,n=n.concat(["<v:shape"+A0({id:"_x0000_s"+zh,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Pt("v:shadow",null,m),Pt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",_s("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),_s("x:AutoFill","False"),_s("x:Row",String(o.r)),_s("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function zw(t,e,r,a){var n=Array.isArray(t),s;e.forEach(function(o){var u=an(o.ref);if(n?(t[u.r]||(t[u.r]=[]),s=t[u.r][u.c]):s=t[o.ref],!s){s={t:"z"},n?t[u.r][u.c]=s:t[o.ref]=s;var f=ra(t["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var h=Tr(f);h!==t["!ref"]&&(t["!ref"]=h)}s.c||(s.c=[]);var m={a:o.author,t:o.t,r:o.r,T:r};o.h&&(m.h=o.h);for(var v=s.c.length-1;v>=0;--v){if(!r&&s.c[v].T)return;r&&!s.c[v].T&&s.c.splice(v,1)}if(r&&a){for(v=0;v<a.length;++v)if(m.a==a[v].id){m.a=a[v].name||m.a;break}}s.c.push(m)})}function NF(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=_r(u[0]),h={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},m=an(f.ref);if(!(e.sheetRows&&e.sheetRows<=m.r)){var v=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!v&&!!v[1]&&yx(v[1])||{r:"",t:"",h:""};h.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),h.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(h.h=y.h),a.push(h)}}}}),a}function _N(t){var e=[An,Pt("comments",null,{xmlns:Af[0]})],r=[];return e.push("<authors>"),t.forEach(function(a){a[1].forEach(function(n){var s=xa(n.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),e.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(a){var n=0,s=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(f){f.a&&(n=r.indexOf(xa(f.a))),s.push(f.t||"")}),e.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),s.length<=1)e.push(_s("t",xa(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,u=1;u<s.length;++u)o+=`Reply:
    `+s[u]+`
`;e.push(_s("t",xa(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function kF(t,e){var r=[],a=!1,n={},s=0;return t.replace(Ms,function(u,f){var h=_r(u);switch(El(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":s=f+u.length;break;case"</text>":n.t=t.slice(s,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&e.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return u}),r}function jF(t,e,r){var a=[An,Pt("ThreadedComments",null,{xmlns:Xn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(n){var s="";(n[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var f={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?s=f.id:f.parentId=s,o.ID=f.id,o.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),a.push(Pt("threadedComment",_s("text",o.t||""),f))})}),a.push("</ThreadedComments>"),a.join("")}function EF(t,e){var r=[],a=!1;return t.replace(Ms,function(s){var o=_r(s);switch(El(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function AF(t){var e=[An,Pt("personList",null,{xmlns:Xn.TCMNT,"xmlns:x":Af[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,a){e.push(Pt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function CF(t){var e={};e.iauthor=t.read_shift(4);var r=Rf(t);return e.rfx=r.s,e.ref=yr(r.s),t.l+=16,e}function TF(t,e){return e==null&&(e=lt(36)),e.write_shift(4,t[1].iauthor),hd(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var OF=Ls;function RF(t){return os(t.slice(0,54))}function DF(t,e){var r=[],a=[],n={},s=!1;return vc(t,function(u,f,h){switch(h){case 632:a.push(u);break;case 635:n=u;break;case 637:n.t=u.t,n.h=u.h,n.r=u.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,e.sheetRows&&n.rfx&&e.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function FF(t){var e=hi(),r=[];return wt(e,628),wt(e,630),t.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),wt(e,632,RF(n.a)))})}),wt(e,631),wt(e,633),t.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var s={s:an(a[0]),e:an(a[0])};wt(e,635,TF([s,n])),n.t&&n.t.length>0&&wt(e,637,rO(n)),wt(e,636),delete n.iauthor})}),wt(e,634),wt(e,629),e.end()}var LF="application/vnd.ms-office.vbaProject";function PF(t){var e=fr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");fr.utils.cfb_add(e,n,t.FileIndex[a].content)}}),fr.write(e)}function MF(t,e){e.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&fr.utils.cfb_add(t,n,e.FileIndex[a].content)}})}var bN=["xlsb","xlsm","xlam","biff8","xla"];function IF(){return{"!type":"dialog"}}function BF(){return{"!type":"dialog"}}function UF(){return{"!type":"macro"}}function qF(){return{"!type":"macro"}}var Yh=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(a,n,s,o){var u=!1,f=!1;s.length==0?f=!0:s.charAt(0)=="["&&(f=!0,s=s.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var h=s.length>0?parseInt(s,10)|0:0,m=o.length>0?parseInt(o,10)|0:0;return u?m+=e.c:--m,f?h+=e.r:--h,n+(u?"":"$")+rn(m)+(f?"":"$")+En(h)}return function(n,s){return e=s,n.replace(t,r)}})(),Sx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Nx=(function(){return function(e,r){return e.replace(Sx,function(a,n,s,o,u,f){var h=ux(o)-(s?0:r.c),m=cx(f)-(u?0:r.r),v=m==0?"":u?m+1:"["+m+"]",y=h==0?"":s?h+1:"["+h+"]";return n+"R"+v+"C"+y})}})();function wN(t,e){return t.replace(Sx,function(r,a,n,s,o,u){return a+(n=="$"?n+s:rn(ux(s)+e.c))+(o=="$"?o+u:En(cx(u)+e.r))})}function zF(t,e,r){var a=di(e),n=a.s,s=an(r),o={r:s.r-n.r,c:s.c-n.c};return wN(t,o)}function HF(t){return t.length!=1}function Hw(t){return t.replace(/_xlfn\./g,"")}function Fn(t){t.l+=1}function mu(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function SN(t,e,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return NN(t);r.biff==12&&(a=4)}var n=t.read_shift(a),s=t.read_shift(a),o=mu(t),u=mu(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:u[0],cRel:u[1],rRel:u[2]}}}function NN(t){var e=mu(t),r=mu(t),a=t.read_shift(1),n=t.read_shift(1);return{s:{r:e[0],c:a,cRel:e[1],rRel:e[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function $F(t,e,r){if(r.biff<8)return NN(t);var a=t.read_shift(r.biff==12?4:2),n=t.read_shift(r.biff==12?4:2),s=mu(t),o=mu(t);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function kN(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return WF(t);var a=t.read_shift(r&&r.biff==12?4:2),n=mu(t);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function WF(t){var e=mu(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function VF(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function GF(t,e,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return YF(t);var n=t.read_shift(a>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,u=(s&32768)>>15;if(s&=16383,u==1)for(;n>524287;)n-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:o,rRel:u}}function YF(t){var e=t.read_shift(2),r=t.read_shift(1),a=(e&32768)>>15,n=(e&16384)>>14;return e&=16383,a==1&&e>=8192&&(e=e-16384),n==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:n,rRel:a}}function XF(t,e,r){var a=(t[t.l++]&96)>>5,n=SN(t,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function KF(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=SN(t,s,r);return[a,n,o]}function JF(t,e,r){var a=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function ZF(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[a,n]}function QF(t,e,r){var a=(t[t.l++]&96)>>5,n=$F(t,e-1,r);return[a,n]}function eL(t,e,r){var a=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[a]}function $w(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function tL(t,e,r){t.l+=2;for(var a=t.read_shift(r&&r.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(t.read_shift(r&&r.biff==2?1:2));return n}function rL(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function aL(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function nL(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function sL(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[a]}function jN(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function iL(t){return t.read_shift(2),jN(t)}function oL(t){return t.read_shift(2),jN(t)}function lL(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=kN(t,0,r);return[a,n]}function cL(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=GF(t,0,r);return[a,n]}function uL(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=kN(t,0,r);return[a,n,s]}function fL(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(r&&r.biff<=3?1:2);return[mP[n],CN[n],a]}function hL(t,e,r){var a=t[t.l++],n=t.read_shift(1),s=r&&r.biff<=3?[a==88?-1:0,t.read_shift(1)]:dL(t);return[n,(s[0]===0?CN:dP)[s[1]]]}function dL(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function mL(t,e,r){t.l+=r&&r.biff==2?3:4}function pL(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var a=t.read_shift(2),n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function gL(t){return t.l++,xc[t.read_shift(1)]}function vL(t){return t.l++,t.read_shift(2)}function xL(t){return t.l++,t.read_shift(1)!==0}function yL(t){return t.l++,Fs(t)}function _L(t,e,r){return t.l++,W0(t,e-1,r)}function bL(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=bn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=xc[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Fs(t);break;case 2:r[1]=Df(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function wL(t,e,r){for(var a=t.read_shift(r.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((r.biff==12?Rf:p1)(t));return n}function SL(t,e,r){var a=0,n=0;r.biff==12?(a=t.read_shift(4),n=t.read_shift(4)):(n=1+t.read_shift(1),a=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var s=0,o=[];s!=a&&(o[s]=[]);++s)for(var u=0;u!=n;++u)o[s][u]=bL(t,r.biff);return o}function NL(t,e,r){var a=t.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=t.read_shift(n);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[a,0,s]}function kL(t,e,r){if(r.biff==5)return jL(t);var a=t.read_shift(1)>>>5&3,n=t.read_shift(2),s=t.read_shift(4);return[a,n,s]}function jL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var a=t.read_shift(2);return t.l+=12,[e,r,a]}function EL(t,e,r){var a=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function AL(t,e,r){var a=t.read_shift(1)>>>5&3,n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function CL(t,e,r){var a=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[a]}function TL(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[a,n]}var OL=Ps,RL=Ps,DL=Ps;function G0(t,e,r){return t.l+=2,[VF(t)]}function kx(t){return t.l+=6,[]}var FL=G0,LL=kx,PL=kx,ML=G0;function EN(t){return t.l+=2,[Pn(t),t.read_shift(2)&1]}var IL=G0,BL=EN,UL=kx,qL=G0,zL=G0,HL=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function $L(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n=t.read_shift(2),s=t.read_shift(2),o=HL[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:a,c:n,C:s}}function WL(t){return t.l+=2,[t.read_shift(4)]}function VL(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function GL(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function YL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function XL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function KL(t){return t.l+=4,[0,0]}var Ww={1:{n:"PtgExp",f:pL},2:{n:"PtgTbl",f:DL},3:{n:"PtgAdd",f:Fn},4:{n:"PtgSub",f:Fn},5:{n:"PtgMul",f:Fn},6:{n:"PtgDiv",f:Fn},7:{n:"PtgPower",f:Fn},8:{n:"PtgConcat",f:Fn},9:{n:"PtgLt",f:Fn},10:{n:"PtgLe",f:Fn},11:{n:"PtgEq",f:Fn},12:{n:"PtgGe",f:Fn},13:{n:"PtgGt",f:Fn},14:{n:"PtgNe",f:Fn},15:{n:"PtgIsect",f:Fn},16:{n:"PtgUnion",f:Fn},17:{n:"PtgRange",f:Fn},18:{n:"PtgUplus",f:Fn},19:{n:"PtgUminus",f:Fn},20:{n:"PtgPercent",f:Fn},21:{n:"PtgParen",f:Fn},22:{n:"PtgMissArg",f:Fn},23:{n:"PtgStr",f:_L},26:{n:"PtgSheet",f:VL},27:{n:"PtgEndSheet",f:GL},28:{n:"PtgErr",f:gL},29:{n:"PtgBool",f:xL},30:{n:"PtgInt",f:vL},31:{n:"PtgNum",f:yL},32:{n:"PtgArray",f:eL},33:{n:"PtgFunc",f:fL},34:{n:"PtgFuncVar",f:hL},35:{n:"PtgName",f:NL},36:{n:"PtgRef",f:lL},37:{n:"PtgArea",f:XF},38:{n:"PtgMemArea",f:EL},39:{n:"PtgMemErr",f:OL},40:{n:"PtgMemNoMem",f:RL},41:{n:"PtgMemFunc",f:AL},42:{n:"PtgRefErr",f:CL},43:{n:"PtgAreaErr",f:JF},44:{n:"PtgRefN",f:cL},45:{n:"PtgAreaN",f:QF},46:{n:"PtgMemAreaN",f:YL},47:{n:"PtgMemNoMemN",f:XL},57:{n:"PtgNameX",f:kL},58:{n:"PtgRef3d",f:uL},59:{n:"PtgArea3d",f:KF},60:{n:"PtgRefErr3d",f:TL},61:{n:"PtgAreaErr3d",f:ZF},255:{}},JL={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ZL={1:{n:"PtgElfLel",f:EN},2:{n:"PtgElfRw",f:qL},3:{n:"PtgElfCol",f:FL},6:{n:"PtgElfRwV",f:zL},7:{n:"PtgElfColV",f:ML},10:{n:"PtgElfRadical",f:IL},11:{n:"PtgElfRadicalS",f:UL},13:{n:"PtgElfColS",f:LL},15:{n:"PtgElfColSV",f:PL},16:{n:"PtgElfRadicalLel",f:BL},25:{n:"PtgList",f:$L},29:{n:"PtgSxName",f:WL},255:{}},QL={0:{n:"PtgAttrNoop",f:KL},1:{n:"PtgAttrSemi",f:sL},2:{n:"PtgAttrIf",f:aL},4:{n:"PtgAttrChoose",f:tL},8:{n:"PtgAttrGoto",f:rL},16:{n:"PtgAttrSum",f:mL},32:{n:"PtgAttrBaxcel",f:$w},33:{n:"PtgAttrBaxcel",f:$w},64:{n:"PtgAttrSpace",f:iL},65:{n:"PtgAttrSpaceSemi",f:oL},128:{n:"PtgAttrIfError",f:nL},255:{}};function Y0(t,e,r,a){if(a.biff<8)return Ps(t,e);for(var n=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=SL(t,0,a),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=wL(t,r[o][1],a),s.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=n-t.l,e!==0&&s.push(Ps(t,e)),s}function X0(t,e,r){for(var a=t.l+e,n,s,o=[];a!=t.l;)e=a-t.l,s=t[t.l],n=Ww[s]||Ww[JL[s]],(s===24||s===25)&&(n=(s===24?ZL:QL)[t[t.l+1]]),!n||!n.f?Ps(t,e):o.push([n.n,n.f(t,e,r)]);return o}function eP(t){for(var e=[],r=0;r<t.length;++r){for(var a=t[r],n=[],s=0;s<a.length;++s){var o=a[s];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}e.push(n.join(","))}return e.join(";")}var tP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function rP(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function AN(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var a=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(t[a[0]][0]){case 357:return n=a[1]==-1?"#REF":t.SheetNames[a[1]],a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[a[0]][0];case 355:default:return"SH33TJSSRC"+t[a[0]][0]}switch(t[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":t.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 14849:return t[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[a[0]][0][3]?(n=a[1]==-1?"#REF":t[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+t[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Vw(t,e,r){var a=AN(t,e,r);return a=="#REF"?a:rP(a,r)}function Rs(t,e,r,a,n){var s=n&&n.biff||8,o={s:{c:0,r:0}},u=[],f,h,m,v=0,y=0,g,b="";if(!t[0]||!t[0][0])return"";for(var _=-1,S="",E=0,C=t[0].length;E<C;++E){var j=t[0][E];switch(j[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),h=u.pop(),_>=0){switch(t[0][_][1][0]){case 0:S=mn(" ",t[0][_][1][1]);break;case 1:S=mn("\r",t[0][_][1][1]);break;default:if(S="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}h=h+S,_=-1}u.push(h+tP[j[0]]+f);break;case"PtgIsect":f=u.pop(),h=u.pop(),u.push(h+" "+f);break;case"PtgUnion":f=u.pop(),h=u.pop(),u.push(h+","+f);break;case"PtgRange":f=u.pop(),h=u.pop(),u.push(h+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=c0(j[1][1],o,n),u.push(u0(m,s));break;case"PtgRefN":m=r?c0(j[1][1],r,n):j[1][1],u.push(u0(m,s));break;case"PtgRef3d":v=j[1][1],m=c0(j[1][2],o,n),b=Vw(a,v,n),u.push(b+"!"+u0(m,s));break;case"PtgFunc":case"PtgFuncVar":var R=j[1][0],H=j[1][1];R||(R=0),R&=127;var Y=R==0?[]:u.slice(-R);u.length-=R,H==="User"&&(H=Y.shift()),u.push(H+"("+Y.join(",")+")");break;case"PtgBool":u.push(j[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(j[1]);break;case"PtgNum":u.push(String(j[1]));break;case"PtgStr":u.push('"'+j[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(j[1]);break;case"PtgAreaN":g=bw(j[1][1],r?{s:r}:o,n),u.push(ev(g,n));break;case"PtgArea":g=bw(j[1][1],o,n),u.push(ev(g,n));break;case"PtgArea3d":v=j[1][1],g=j[1][2],b=Vw(a,v,n),u.push(b+"!"+ev(g,n));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=j[1][2];var U=(a.names||[])[y-1]||(a[0]||[])[y],V=U?U.Name:"SH33TJSNAME"+String(y);V&&V.slice(0,6)=="_xlfn."&&!n.xlfn&&(V=V.slice(6)),u.push(V);break;case"PtgNameX":var F=j[1][1];y=j[1][2];var X;if(n.biff<=5)F<0&&(F=-F),a[F]&&(X=a[F][y]);else{var P="";if(((a[F]||[])[0]||[])[0]==14849||(((a[F]||[])[0]||[])[0]==1025?a[F][y]&&a[F][y].itab>0&&(P=a.SheetNames[a[F][y].itab-1]+"!"):P=a.SheetNames[y-1]+"!"),a[F]&&a[F][y])P+=a[F][y].Name;else if(a[0]&&a[0][y])P+=a[0][y].Name;else{var O=(AN(a,F,n)||"").split(";;");O[y-1]?P=O[y-1]:P+="SH33TJSERRX"}u.push(P);break}X||(X={Name:"SH33TJSERRY"}),u.push(X.Name);break;case"PtgParen":var I="(",W=")";if(_>=0){switch(S="",t[0][_][1][0]){case 2:I=mn(" ",t[0][_][1][1])+I;break;case 3:I=mn("\r",t[0][_][1][1])+I;break;case 4:W=mn(" ",t[0][_][1][1])+W;break;case 5:W=mn("\r",t[0][_][1][1])+W;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}_=-1}u.push(I+u.pop()+W);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:j[1][1],r:j[1][0]};var ne={c:r.c,r:r.r};if(a.sharedf[yr(m)]){var Q=a.sharedf[yr(m)];u.push(Rs(Q,o,ne,a,n))}else{var le=!1;for(f=0;f!=a.arrayf.length;++f)if(h=a.arrayf[f],!(m.c<h[0].s.c||m.c>h[0].e.c)&&!(m.r<h[0].s.r||m.r>h[0].e.r)){u.push(Rs(h[1],o,ne,a,n)),le=!0;break}le||u.push(j[1])}break;case"PtgArray":u.push("{"+eP(j[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+j[1].idx+"[#"+j[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(j));default:throw new Error("Unrecognized Formula Token: "+String(j))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&_>=0&&ee.indexOf(t[0][E][0])==-1){j=t[0][_];var K=!0;switch(j[1][0]){case 4:K=!1;case 0:S=mn(" ",j[1][1]);break;case 5:K=!1;case 1:S=mn("\r",j[1][1]);break;default:if(S="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+j[1][0])}u.push((K?S:"")+u.pop()+(K?"":S)),_=-1}}if(u.length>1&&n.WTF)throw new Error("bad formula stack");return u[0]}function aP(t,e,r){var a=t.l+e,n=r.biff==2?1:2,s,o=t.read_shift(n);if(o==65535)return[[],Ps(t,e-2)];var u=X0(t,o,r);return e!==o+n&&(s=Y0(t,e-o-n,u,r)),t.l=a,[u,s]}function nP(t,e,r){var a=t.l+e,n=r.biff==2?1:2,s,o=t.read_shift(n);if(o==65535)return[[],Ps(t,e-2)];var u=X0(t,o,r);return e!==o+n&&(s=Y0(t,e-o-n,u,r)),t.l=a,[u,s]}function sP(t,e,r,a){var n=t.l+e,s=X0(t,a,r),o;return n!==t.l&&(o=Y0(t,n-t.l,s,r)),[s,o]}function iP(t,e,r){var a=t.l+e,n,s=t.read_shift(2),o=X0(t,s,r);return s==65535?[[],Ps(t,e-2)]:(e!==s+2&&(n=Y0(t,a-s-2,o,r)),[o,n])}function oP(t){var e;if(oc(t,t.l+6)!==65535)return[Fs(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function lP(t){if(t==null){var e=lt(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return yf(t);return yf(0)}function sv(t,e,r){var a=t.l+e,n=Al(t);r.biff==2&&++t.l;var s=oP(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=nP(t,a-t.l,r);return{cell:n,val:s[0],formula:u,shared:o>>3&1,tt:s[1]}}function cP(t,e,r,a,n){var s=bf(e,r,n),o=lP(t.v),u=lt(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var h=lt(t.bf.length),m=0;m<t.bf.length;++m)h[m]=t.bf[m];var v=is([s,o,u,h]);return v}function g1(t,e,r){var a=t.read_shift(4),n=X0(t,a,r),s=t.read_shift(4),o=s>0?Y0(t,s,n,r):null;return[n,o]}var uP=g1,v1=g1,fP=g1,hP=g1,dP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},CN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Gw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function pP(t){var e="of:="+t.replace(Sx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function iv(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function gP(t){return t.replace(/\./,"!")}var h0={},Xh={},d0=typeof Map<"u";function jx(t,e,r){var a=0,n=t.length;if(r){if(d0?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=d0?r.get(e):r[e];a<s.length;++a)if(t[s[a]].t===e)return t.Count++,s[a]}}else for(;a<n;++a)if(t[a].t===e)return t.Count++,a;return t[n]={t:e},t.Count++,t.Unique++,r&&(d0?(r.has(e)||r.set(e,[]),r.get(e).push(n)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(n))),n}function x1(t,e){var r={min:t+1,max:t+1},a=-1;return e.MDW&&(Ds=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?a=D0(e.wpx):e.wch!=null&&(a=e.wch),a>-1?(r.width=Kp(a),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function pf(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function _u(t,e,r){var a=r.revssf[e.z!=null?e.z:"General"],n=60,s=t.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){uc(e.z,n),r.ssf[n]=e.z,r.revssf[e.z]=a=n;break}}for(n=0;n!=s;++n)if(t[n].numFmtId===a)return n;return t[s]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function TN(t,e,r,a,n,s){try{a.cellNF&&(t.z=xr[e])}catch(u){if(a.WTF)throw u}if(!(t.t==="z"&&!a.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=qa(t.v)),(!a||a.cellText!==!1)&&t.t!=="z")try{if(xr[e]==null&&uc(d8[e]||"General",e),t.t==="e")t.w=t.w||xc[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=j0(t.v);else if(t.t==="d"){var o=Kn(t.v);(o|0)===o?t.w=o.toString(10):t.w=j0(o)}else{if(t.v===void 0)return"";t.w=vf(t.v,Xh)}else t.t==="d"?t.w=fo(e,Kn(t.v),Xh):t.w=fo(e,t.v,Xh)}catch(u){if(a.WTF)throw u}if(a.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Xp(n.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),a.WTF&&(t.s.fgColor.raw_rgb=n.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Xp(n.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),a.WTF&&(t.s.bgColor.raw_rgb=n.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(a.WTF&&s.Fills)throw u}}}function vP(t,e,r){if(t&&t["!ref"]){var a=ra(t["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function xP(t,e){var r=ra(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Tr(r))}var yP=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,_P=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,bP=/<(?:\w:)?hyperlink [^>]*>/mg,wP=/"(\w*:\w*)"/,SP=/<(?:\w:)?col\b[^>]*[\/]?>/g,NP=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,kP=/<(?:\w:)?pageMargins[^>]*\/>/g,ON=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,jP=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,EP=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function AP(t,e,r,a,n,s,o){if(!t)return t;a||(a={"!id":{}});var u=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",m="",v=t.match(_P);v?(h=t.slice(0,v.index),m=t.slice(v.index+v[0].length)):h=m=t;var y=h.match(ON);y?Ex(y[0],u,n,r):(y=h.match(jP))&&TP(y[0],y[1]||"",u,n,r);var g=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var b=h.slice(g,g+50).match(wP);b&&xP(u,b[1])}var _=h.match(EP);_&&_[1]&&HP(_[1],n);var S=[];if(e.cellStyles){var E=h.match(SP);E&&IP(S,E)}v&&VP(v[1],u,e,f,s,o);var C=m.match(NP);C&&(u["!autofilter"]=UP(C[0]));var j=[],R=m.match(yP);if(R)for(g=0;g!=R.length;++g)j[g]=ra(R[g].slice(R[g].indexOf('"')+1));var H=m.match(bP);H&&LP(u,H,a);var Y=m.match(kP);if(Y&&(u["!margins"]=PP(_r(Y[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=Tr(f)),e.sheetRows>0&&u["!ref"]){var U=ra(u["!ref"]);e.sheetRows<=+U.e.r&&(U.e.r=e.sheetRows-1,U.e.r>f.e.r&&(U.e.r=f.e.r),U.e.r<U.s.r&&(U.s.r=U.e.r),U.e.c>f.e.c&&(U.e.c=f.e.c),U.e.c<U.s.c&&(U.s.c=U.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Tr(U))}return S.length>0&&(u["!cols"]=S),j.length>0&&(u["!merges"]=j),u}function CP(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Tr(t[r])+'"/>';return e+"</mergeCells>"}function Ex(t,e,r,a){var n=_r(t);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=ta(ka(n.codeName)))}function TP(t,e,r,a,n){Ex(t.slice(0,t.indexOf(">")),r,a,n)}function OP(t,e,r,a,n){var s=!1,o={},u=null;if(a.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[r];try{e.Workbook&&(f=e.Workbook.Sheets[r].CodeName||f)}catch{}s=!0,o.codeName=kl(xa(f))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),u=(u||"")+Pt("outlinePr",null,h)}!s&&!u||(n[n.length]=Pt("sheetPr",u,o))}var RP=["objects","scenarios","selectLockedCells","selectUnlockedCells"],DP=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function FP(t){var e={sheet:1};return RP.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),DP.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=_x(t.password).toString(16).toUpperCase()),Pt("sheetProtection",null,e)}function LP(t,e,r){for(var a=Array.isArray(t),n=0;n!=e.length;++n){var s=_r(ka(e[n]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+ta(s.location))):(s.Target="#"+ta(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var u=ra(s.ref),f=u.s.r;f<=u.e.r;++f)for(var h=u.s.c;h<=u.e.c;++h){var m=yr({c:h,r:f});a?(t[f]||(t[f]=[]),t[f][h]||(t[f][h]={t:"z",v:void 0}),t[f][h].l=s):(t[m]||(t[m]={t:"z",v:void 0}),t[m].l=s)}}}function PP(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function MP(t){return pf(t),Pt("pageMargins",null,t)}function IP(t,e){for(var r=!1,a=0;a!=e.length;++a){var n=_r(e[a],!0);n.hidden&&(n.hidden=Ba(n.hidden));var s=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,bx(n.width)),du(n);s<=o;)t[s++]=za(n)}}function BP(t,e){for(var r=["<cols>"],a,n=0;n!=e.length;++n)(a=e[n])&&(r[r.length]=Pt("col",null,x1(n,a)));return r[r.length]="</cols>",r.join("")}function UP(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function qP(t,e,r,a){var n=typeof t.ref=="string"?t.ref:Tr(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=di(n);o.s.r==o.e.r&&(o.e.r=di(e["!ref"]).e.r,n=Tr(o));for(var u=0;u<s.length;++u){var f=s[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==a){f.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return u==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Pt("autoFilter",null,{ref:n})}var zP=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function HP(t,e){e.Views||(e.Views=[{}]),(t.match(zP)||[]).forEach(function(r,a){var n=_r(r);e.Views[a]||(e.Views[a]={}),+n.zoomScale&&(e.Views[a].zoom=+n.zoomScale),Ba(n.rightToLeft)&&(e.Views[a].RTL=!0)})}function $P(t,e,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Pt("sheetViews",Pt("sheetView",null,n),{})}function WP(t,e,r,a){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var n="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":n=t.v?"1":"0";break;case"n":n=""+t.v;break;case"e":n=xc[t.v];break;case"d":a&&a.cellDates?n=qa(t.v,-1).toISOString():(t=za(t),t.t="n",n=""+(t.v=Kn(qa(t.v)))),typeof t.z>"u"&&(t.z=xr[14]);break;default:n=t.v;break}var u=_s("v",xa(n)),f={r:e},h=_u(a.cellXfs,t,a);switch(h!==0&&(f.s=h),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){u=_s("v",""+jx(a.Strings,t.v,a.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var m=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=Pt("f",xa(t.f),m)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(f.cm=1),Pt("c",u,f)}var VP=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=E0("v"),o=E0("f");return function(f,h,m,v,y,g){for(var b=0,_="",S=[],E=[],C=0,j=0,R=0,H="",Y,U,V=0,F=0,X,P,O=0,I=0,W=Array.isArray(g.CellXf),ne,Q=[],le=[],ee=Array.isArray(h),K=[],ue={},M=!1,A=!!m.sheetStubs,D=f.split(e),B=0,q=D.length;B!=q;++B){_=D[B].trim();var Z=_.length;if(Z!==0){var oe=0;e:for(b=0;b<Z;++b)switch(_[b]){case">":if(_[b-1]!="/"){++b;break e}if(m&&m.cellStyles){if(U=_r(_.slice(oe,b),!0),V=U.r!=null?parseInt(U.r,10):V+1,F=-1,m.sheetRows&&m.sheetRows<V)continue;ue={},M=!1,U.ht&&(M=!0,ue.hpt=parseFloat(U.ht),ue.hpx=nd(ue.hpt)),U.hidden=="1"&&(M=!0,ue.hidden=!0),U.outlineLevel!=null&&(M=!0,ue.level=+U.outlineLevel),M&&(K[V-1]=ue)}break;case"<":oe=b;break}if(oe>=b)break;if(U=_r(_.slice(oe,b),!0),V=U.r!=null?parseInt(U.r,10):V+1,F=-1,!(m.sheetRows&&m.sheetRows<V)){v.s.r>V-1&&(v.s.r=V-1),v.e.r<V-1&&(v.e.r=V-1),m&&m.cellStyles&&(ue={},M=!1,U.ht&&(M=!0,ue.hpt=parseFloat(U.ht),ue.hpx=nd(ue.hpt)),U.hidden=="1"&&(M=!0,ue.hidden=!0),U.outlineLevel!=null&&(M=!0,ue.level=+U.outlineLevel),M&&(K[V-1]=ue)),S=_.slice(b).split(t);for(var pe=0;pe!=S.length&&S[pe].trim().charAt(0)=="<";++pe);for(S=S.slice(pe),b=0;b!=S.length;++b)if(_=S[b].trim(),_.length!==0){if(E=_.match(r),C=b,j=0,R=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,E!=null&&E.length===2){for(C=0,H=E[1],j=0;j!=H.length&&!((R=H.charCodeAt(j)-64)<1||R>26);++j)C=26*C+R;--C,F=C}else++F;for(j=0;j!=_.length&&_.charCodeAt(j)!==62;++j);if(++j,U=_r(_.slice(0,j),!0),U.r||(U.r=yr({r:V-1,c:F})),H=_.slice(j),Y={t:""},(E=H.match(s))!=null&&E[1]!==""&&(Y.v=ta(E[1])),m.cellFormula){if((E=H.match(o))!=null&&E[1]!==""){if(Y.f=ta(ka(E[1])).replace(/\r\n/g,`
`),m.xlfn||(Y.f=Hw(Y.f)),E[0].indexOf('t="array"')>-1)Y.F=(H.match(n)||[])[1],Y.F.indexOf(":")>-1&&Q.push([ra(Y.F),Y.F]);else if(E[0].indexOf('t="shared"')>-1){P=_r(E[0]);var _e=ta(ka(E[1]));m.xlfn||(_e=Hw(_e)),le[parseInt(P.si,10)]=[P,_e,U.r]}}else(E=H.match(/<f[^>]*\/>/))&&(P=_r(E[0]),le[P.si]&&(Y.f=zF(le[P.si][1],le[P.si][2],U.r)));var be=an(U.r);for(j=0;j<Q.length;++j)be.r>=Q[j][0].s.r&&be.r<=Q[j][0].e.r&&be.c>=Q[j][0].s.c&&be.c<=Q[j][0].e.c&&(Y.F=Q[j][1])}if(U.t==null&&Y.v===void 0)if(Y.f||Y.F)Y.v=0,Y.t="n";else if(A)Y.t="z";else continue;else Y.t=U.t||"n";switch(v.s.c>F&&(v.s.c=F),v.e.c<F&&(v.e.c=F),Y.t){case"n":if(Y.v==""||Y.v==null){if(!A)continue;Y.t="z"}else Y.v=parseFloat(Y.v);break;case"s":if(typeof Y.v>"u"){if(!A)continue;Y.t="z"}else X=h0[parseInt(Y.v,10)],Y.v=X.t,Y.r=X.r,m.cellHTML&&(Y.h=X.h);break;case"str":Y.t="s",Y.v=Y.v!=null?ka(Y.v):"",m.cellHTML&&(Y.h=sx(Y.v));break;case"inlineStr":E=H.match(a),Y.t="s",E!=null&&(X=yx(E[1]))?(Y.v=X.t,m.cellHTML&&(Y.h=X.h)):Y.v="";break;case"b":Y.v=Ba(Y.v);break;case"d":m.cellDates?Y.v=qa(Y.v,1):(Y.v=Kn(qa(Y.v,1)),Y.t="n");break;case"e":(!m||m.cellText!==!1)&&(Y.w=Y.v),Y.v=D3[Y.v];break}if(O=I=0,ne=null,W&&U.s!==void 0&&(ne=g.CellXf[U.s],ne!=null&&(ne.numFmtId!=null&&(O=ne.numFmtId),m.cellStyles&&ne.fillId!=null&&(I=ne.fillId))),TN(Y,O,I,m,y,g),m.cellDates&&W&&Y.t=="n"&&cd(xr[O])&&(Y.t="d",Y.v=m1(Y.v)),U.cm&&m.xlmeta){var Le=(m.xlmeta.Cell||[])[+U.cm-1];Le&&Le.type=="XLDAPR"&&(Y.D=!0)}if(ee){var he=an(U.r);h[he.r]||(h[he.r]=[]),h[he.r][he.c]=Y}else h[U.r]=Y}}}}K.length>0&&(h["!rows"]=K)}})();function GP(t,e,r,a){var n=[],s=[],o=ra(t["!ref"]),u="",f,h="",m=[],v=0,y=0,g=t["!rows"],b=Array.isArray(t),_={r:h},S,E=-1;for(y=o.s.c;y<=o.e.c;++y)m[y]=rn(y);for(v=o.s.r;v<=o.e.r;++v){for(s=[],h=En(v),y=o.s.c;y<=o.e.c;++y){f=m[y]+h;var C=b?(t[v]||[])[y]:t[f];C!==void 0&&(u=WP(C,f,t,e))!=null&&s.push(u)}(s.length>0||g&&g[v])&&(_={r:h},g&&g[v]&&(S=g[v],S.hidden&&(_.hidden=1),E=-1,S.hpx?E=F0(S.hpx):S.hpt&&(E=S.hpt),E>-1&&(_.ht=E,_.customHeight=1),S.level&&(_.outlineLevel=S.level)),n[n.length]=Pt("row",s.join(""),_))}if(g)for(;v<g.length;++v)g&&g[v]&&(_={r:v+1},S=g[v],S.hidden&&(_.hidden=1),E=-1,S.hpx?E=F0(S.hpx):S.hpt&&(E=S.hpt),E>-1&&(_.ht=E,_.customHeight=1),S.level&&(_.outlineLevel=S.level),n[n.length]=Pt("row","",_));return n.join("")}function RN(t,e,r,a){var n=[An,Pt("worksheet",null,{xmlns:Af[0],"xmlns:r":Xn.r})],s=r.SheetNames[t],o=0,u="",f=r.Sheets[s];f==null&&(f={});var h=f["!ref"]||"A1",m=ra(h);if(m.e.c>16383||m.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),h=Tr(m)}a||(a={}),f["!comments"]=[];var v=[];OP(f,r,t,e,n),n[n.length]=Pt("dimension",null,{ref:h}),n[n.length]=$P(f,e,t,r),e.sheetFormat&&(n[n.length]=Pt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(n[n.length]=BP(f,f["!cols"])),n[o=n.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=GP(f,e),u.length>0&&(n[n.length]=u)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),f["!protect"]&&(n[n.length]=FP(f["!protect"])),f["!autofilter"]!=null&&(n[n.length]=qP(f["!autofilter"],f,r,t)),f["!merges"]!=null&&f["!merges"].length>0&&(n[n.length]=CP(f["!merges"]));var y=-1,g,b=-1;return f["!links"].length>0&&(n[n.length]="<hyperlinks>",f["!links"].forEach(function(_){_[1].Target&&(g={ref:_[0]},_[1].Target.charAt(0)!="#"&&(b=ga(a,-1,xa(_[1].Target).replace(/#.*$/,""),Mr.HLINK),g["r:id"]="rId"+b),(y=_[1].Target.indexOf("#"))>-1&&(g.location=xa(_[1].Target.slice(y+1))),_[1].Tooltip&&(g.tooltip=xa(_[1].Tooltip)),n[n.length]=Pt("hyperlink",null,g))}),n[n.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(n[n.length]=MP(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(n[n.length]=_s("ignoredErrors",Pt("ignoredError",null,{numberStoredAsText:1,sqref:h}))),v.length>0&&(b=ga(a,-1,"../drawings/drawing"+(t+1)+".xml",Mr.DRAW),n[n.length]=Pt("drawing",null,{"r:id":"rId"+b}),f["!drawing"]=v),f["!comments"].length>0&&(b=ga(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Mr.VML),n[n.length]=Pt("legacyDrawing",null,{"r:id":"rId"+b}),f["!legacy"]=b),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function YP(t,e){var r={},a=t.l+e;r.r=t.read_shift(4),t.l+=4;var n=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=a,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=n/20),r}function XP(t,e,r){var a=lt(145),n=(r["!rows"]||[])[t]||{};a.write_shift(4,t),a.write_shift(4,0);var s=320;n.hpx?s=F0(n.hpx)*20:n.hpt&&(s=n.hpt*20),a.write_shift(2,s),a.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var u=0,f=a.l;a.l+=4;for(var h={r:t,c:0},m=0;m<16;++m)if(!(e.s.c>m+1<<10||e.e.c<m<<10)){for(var v=-1,y=-1,g=m<<10;g<m+1<<10;++g){h.c=g;var b=Array.isArray(r)?(r[h.r]||[])[h.c]:r[yr(h)];b&&(v<0&&(v=g),y=g)}v<0||(++u,a.write_shift(4,v),a.write_shift(4,y))}var _=a.l;return a.l=f,a.write_shift(4,u),a.l=_,a.length>a.l?a.slice(0,a.l):a}function KP(t,e,r,a){var n=XP(a,r,e);(n.length>17||(e["!rows"]||[])[a])&&wt(t,0,n)}var JP=Rf,ZP=hd;function QP(){}function e9(t,e){var r={},a=t[t.l];return++t.l,r.above=!(a&64),r.left=!(a&128),t.l+=18,r.name=aO(t),r}function t9(t,e,r){r==null&&(r=lt(84+4*t.length));var a=192;e&&(e.above&&(a&=-65),e.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return Vp({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),A3(t,r),r.slice(0,r.l)}function r9(t){var e=mo(t);return[e]}function a9(t,e,r){return r==null&&(r=lt(8)),Cf(e,r)}function n9(t){var e=Tf(t);return[e]}function s9(t,e,r){return r==null&&(r=lt(4)),Of(e,r)}function i9(t){var e=mo(t),r=t.read_shift(1);return[e,r,"b"]}function o9(t,e,r){return r==null&&(r=lt(9)),Cf(e,r),r.write_shift(1,t.v?1:0),r}function l9(t){var e=Tf(t),r=t.read_shift(1);return[e,r,"b"]}function c9(t,e,r){return r==null&&(r=lt(5)),Of(e,r),r.write_shift(1,t.v?1:0),r}function u9(t){var e=mo(t),r=t.read_shift(1);return[e,r,"e"]}function f9(t,e,r){return r==null&&(r=lt(9)),Cf(e,r),r.write_shift(1,t.v),r}function h9(t){var e=Tf(t),r=t.read_shift(1);return[e,r,"e"]}function d9(t,e,r){return r==null&&(r=lt(8)),Of(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function m9(t){var e=mo(t),r=t.read_shift(4);return[e,r,"s"]}function p9(t,e,r){return r==null&&(r=lt(12)),Cf(e,r),r.write_shift(4,e.v),r}function g9(t){var e=Tf(t),r=t.read_shift(4);return[e,r,"s"]}function v9(t,e,r){return r==null&&(r=lt(8)),Of(e,r),r.write_shift(4,e.v),r}function x9(t){var e=mo(t),r=Fs(t);return[e,r,"n"]}function y9(t,e,r){return r==null&&(r=lt(16)),Cf(e,r),yf(t.v,r),r}function DN(t){var e=Tf(t),r=Fs(t);return[e,r,"n"]}function _9(t,e,r){return r==null&&(r=lt(12)),Of(e,r),yf(t.v,r),r}function b9(t){var e=mo(t),r=mx(t);return[e,r,"n"]}function w9(t,e,r){return r==null&&(r=lt(12)),Cf(e,r),C3(t.v,r),r}function S9(t){var e=Tf(t),r=mx(t);return[e,r,"n"]}function N9(t,e,r){return r==null&&(r=lt(8)),Of(e,r),C3(t.v,r),r}function k9(t){var e=mo(t),r=fx(t);return[e,r,"is"]}function j9(t){var e=mo(t),r=Ls(t);return[e,r,"str"]}function E9(t,e,r){return r==null&&(r=lt(12+4*t.v.length)),Cf(e,r),os(t.v,r),r.length>r.l?r.slice(0,r.l):r}function A9(t){var e=Tf(t),r=Ls(t);return[e,r,"str"]}function C9(t,e,r){return r==null&&(r=lt(8+4*t.v.length)),Of(e,r),os(t.v,r),r.length>r.l?r.slice(0,r.l):r}function T9(t,e,r){var a=t.l+e,n=mo(t);n.r=r["!row"];var s=t.read_shift(1),o=[n,s,"b"];if(r.cellFormula){t.l+=2;var u=v1(t,a-t.l,r);o[3]=Rs(u,null,n,r.supbooks,r)}else t.l=a;return o}function O9(t,e,r){var a=t.l+e,n=mo(t);n.r=r["!row"];var s=t.read_shift(1),o=[n,s,"e"];if(r.cellFormula){t.l+=2;var u=v1(t,a-t.l,r);o[3]=Rs(u,null,n,r.supbooks,r)}else t.l=a;return o}function R9(t,e,r){var a=t.l+e,n=mo(t);n.r=r["!row"];var s=Fs(t),o=[n,s,"n"];if(r.cellFormula){t.l+=2;var u=v1(t,a-t.l,r);o[3]=Rs(u,null,n,r.supbooks,r)}else t.l=a;return o}function D9(t,e,r){var a=t.l+e,n=mo(t);n.r=r["!row"];var s=Ls(t),o=[n,s,"str"];if(r.cellFormula){t.l+=2;var u=v1(t,a-t.l,r);o[3]=Rs(u,null,n,r.supbooks,r)}else t.l=a;return o}var F9=Rf,L9=hd;function P9(t,e){return e==null&&(e=lt(4)),e.write_shift(4,t),e}function M9(t,e){var r=t.l+e,a=Rf(t),n=hx(t),s=Ls(t),o=Ls(t),u=Ls(t);t.l=r;var f={rfx:a,relId:n,loc:s,display:u};return o&&(f.Tooltip=o),f}function I9(t,e){var r=lt(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));hd({s:an(t[0]),e:an(t[0])},r),dx("rId"+e,r);var a=t[1].Target.indexOf("#"),n=a==-1?"":t[1].Target.slice(a+1);return os(n||"",r),os(t[1].Tooltip||"",r),os("",r),r.slice(0,r.l)}function B9(){}function U9(t,e,r){var a=t.l+e,n=T3(t),s=t.read_shift(1),o=[n];if(o[2]=s,r.cellFormula){var u=uP(t,a-t.l,r);o[1]=u}else t.l=a;return o}function q9(t,e,r){var a=t.l+e,n=Rf(t),s=[n];if(r.cellFormula){var o=hP(t,a-t.l,r);s[1]=o,t.l=a}else t.l=a;return s}function z9(t,e,r){r==null&&(r=lt(18));var a=x1(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return e.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),e.level&&(n|=e.level<<8),r.write_shift(2,n),r}var FN=["left","right","top","bottom","header","footer"];function H9(t){var e={};return FN.forEach(function(r){e[r]=Fs(t)}),e}function $9(t,e){return e==null&&(e=lt(48)),pf(t),FN.forEach(function(r){yf(t[r],e)}),e}function W9(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function V9(t,e,r){r==null&&(r=lt(30));var a=924;return(((e||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function G9(t){var e=lt(24);return e.write_shift(4,4),e.write_shift(4,1),hd(t,e),e}function Y9(t,e){return e==null&&(e=lt(66)),e.write_shift(2,t.password?_x(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function X9(){}function K9(){}function J9(t,e,r,a,n,s,o){if(!t)return t;var u=e||{};a||(a={"!id":{}});var f=u.dense?[]:{},h,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,y=!1,g,b,_,S,E,C,j,R,H,Y=[];u.biff=12,u["!row"]=0;var U=0,V=!1,F=[],X={},P=u.supbooks||n.supbooks||[[]];if(P.sharedf=X,P.arrayf=F,P.SheetNames=n.SheetNames||n.Sheets.map(function(ee){return ee.name}),!u.supbooks&&(u.supbooks=P,n.Names))for(var O=0;O<n.Names.length;++O)P[0][O+1]=n.Names[O];var I=[],W=[],ne=!1;L0[16]={n:"BrtShortReal",f:DN};var Q;if(vc(t,function(K,ue,M){if(!y)switch(M){case 148:h=K;break;case 0:g=K,u.sheetRows&&u.sheetRows<=g.r&&(y=!0),R=En(S=g.r),u["!row"]=g.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=nd(K.hpt)),W[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:K[2]},K[2]){case"n":b.v=K[1];break;case"s":j=h0[K[1]],b.v=j.t,b.r=j.r;break;case"b":b.v=!!K[1];break;case"e":b.v=K[1],u.cellText!==!1&&(b.w=xc[b.v]);break;case"str":b.t="s",b.v=K[1];break;case"is":b.t="s",b.v=K[1].t;break}if((_=o.CellXf[K[0].iStyleRef])&&TN(b,_.numFmtId,null,u,s,o),E=K[0].c==-1?E+1:K[0].c,u.dense?(f[S]||(f[S]=[]),f[S][E]=b):f[rn(E)+R]=b,u.cellFormula){for(V=!1,U=0;U<F.length;++U){var A=F[U];g.r>=A[0].s.r&&g.r<=A[0].e.r&&E>=A[0].s.c&&E<=A[0].e.c&&(b.F=Tr(A[0]),V=!0)}!V&&K.length>3&&(b.f=K[3])}if(m.s.r>g.r&&(m.s.r=g.r),m.s.c>E&&(m.s.c=E),m.e.r<g.r&&(m.e.r=g.r),m.e.c<E&&(m.e.c=E),u.cellDates&&_&&b.t=="n"&&cd(xr[_.numFmtId])){var D=ff(b.v);D&&(b.t="d",b.v=new Date(D.y,D.m-1,D.d,D.H,D.M,D.S,D.u))}Q&&(Q.type=="XLDAPR"&&(b.D=!0),Q=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;b={t:"z",v:void 0},E=K[0].c==-1?E+1:K[0].c,u.dense?(f[S]||(f[S]=[]),f[S][E]=b):f[rn(E)+R]=b,m.s.r>g.r&&(m.s.r=g.r),m.s.c>E&&(m.s.c=E),m.e.r<g.r&&(m.e.r=g.r),m.e.c<E&&(m.e.c=E),Q&&(Q.type=="XLDAPR"&&(b.D=!0),Q=void 0);break;case 176:Y.push(K);break;case 49:Q=((u.xlmeta||{}).Cell||[])[K-1];break;case 494:var B=a["!id"][K.relId];for(B?(K.Target=B.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=B):K.relId==""&&(K.Target="#"+K.loc),S=K.rfx.s.r;S<=K.rfx.e.r;++S)for(E=K.rfx.s.c;E<=K.rfx.e.c;++E)u.dense?(f[S]||(f[S]=[]),f[S][E]||(f[S][E]={t:"z",v:void 0}),f[S][E].l=K):(C=yr({c:E,r:S}),f[C]||(f[C]={t:"z",v:void 0}),f[C].l=K);break;case 426:if(!u.cellFormula)break;F.push(K),H=u.dense?f[S][E]:f[rn(E)+R],H.f=Rs(K[1],m,{r:g.r,c:E},P,u),H.F=Tr(K[0]);break;case 427:if(!u.cellFormula)break;X[yr(K[0].s)]=K[1],H=u.dense?f[S][E]:f[rn(E)+R],H.f=Rs(K[1],m,{r:g.r,c:E},P,u);break;case 60:if(!u.cellStyles)break;for(;K.e>=K.s;)I[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},ne||(ne=!0,bx(K.w/256)),du(I[K.e+1]);break;case 161:f["!autofilter"]={ref:Tr(K)};break;case 476:f["!margins"]=K;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),K.name&&(n.Sheets[r].CodeName=K.name),(K.above||K.left)&&(f["!outline"]={above:K.above,left:K.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),K.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!ue.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+M.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(m.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(f["!ref"]=Tr(h||m)),u.sheetRows&&f["!ref"]){var le=ra(f["!ref"]);u.sheetRows<=+le.e.r&&(le.e.r=u.sheetRows-1,le.e.r>m.e.r&&(le.e.r=m.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>m.e.c&&(le.e.c=m.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),f["!fullref"]=f["!ref"],f["!ref"]=Tr(le))}return Y.length>0&&(f["!merges"]=Y),I.length>0&&(f["!cols"]=I),W.length>0&&(f["!rows"]=W),f}function Z9(t,e,r,a,n,s,o){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=za(e),e.z=e.z||xr[14],e.v=Kn(qa(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var f={r,c:a};switch(f.s=_u(n.cellXfs,e,n),e.l&&s["!links"].push([yr(f),e.l]),e.c&&s["!comments"].push([yr(f),e.c]),e.t){case"s":case"str":return n.bookSST?(u=jx(n.Strings,e.v,n.revStrings),f.t="s",f.v=u,o?wt(t,18,v9(e,f)):wt(t,7,p9(e,f))):(f.t="str",o?wt(t,17,C9(e,f)):wt(t,6,E9(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?wt(t,13,N9(e,f)):wt(t,2,w9(e,f)):o?wt(t,16,_9(e,f)):wt(t,5,y9(e,f)),!0;case"b":return f.t="b",o?wt(t,15,c9(e,f)):wt(t,4,o9(e,f)),!0;case"e":return f.t="e",o?wt(t,14,d9(e,f)):wt(t,3,f9(e,f)),!0}return o?wt(t,12,s9(e,f)):wt(t,1,a9(e,f)),!0}function Q9(t,e,r,a){var n=ra(e["!ref"]||"A1"),s,o="",u=[];wt(t,145);var f=Array.isArray(e),h=n.e.r;e["!rows"]&&(h=Math.max(n.e.r,e["!rows"].length-1));for(var m=n.s.r;m<=h;++m){o=En(m),KP(t,e,n,m);var v=!1;if(m<=n.e.r)for(var y=n.s.c;y<=n.e.c;++y){m===n.s.r&&(u[y]=rn(y)),s=u[y]+o;var g=f?(e[m]||[])[y]:e[s];if(!g){v=!1;continue}v=Z9(t,g,m,y,a,e,v)}}wt(t,146)}function eM(t,e){!e||!e["!merges"]||(wt(t,177,P9(e["!merges"].length)),e["!merges"].forEach(function(r){wt(t,176,L9(r))}),wt(t,178))}function tM(t,e){!e||!e["!cols"]||(wt(t,390),e["!cols"].forEach(function(r,a){r&&wt(t,60,z9(a,r))}),wt(t,391))}function rM(t,e){!e||!e["!ref"]||(wt(t,648),wt(t,649,G9(ra(e["!ref"]))),wt(t,650))}function aM(t,e,r){e["!links"].forEach(function(a){if(a[1].Target){var n=ga(r,-1,a[1].Target.replace(/#.*$/,""),Mr.HLINK);wt(t,494,I9(a,n))}}),delete e["!links"]}function nM(t,e,r,a){if(e["!comments"].length>0){var n=ga(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Mr.VML);wt(t,551,dx("rId"+n)),e["!legacy"]=n}}function sM(t,e,r,a){if(e["!autofilter"]){var n=e["!autofilter"],s=typeof n.ref=="string"?n.ref:Tr(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,u=di(s);u.s.r==u.e.r&&(u.e.r=di(e["!ref"]).e.r,s=Tr(u));for(var f=0;f<o.length;++f){var h=o[f];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==a){h.Ref="'"+r.SheetNames[a]+"'!"+s;break}}f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),wt(t,161,hd(ra(s))),wt(t,162)}}function iM(t,e,r){wt(t,133),wt(t,137,V9(e,r)),wt(t,138),wt(t,134)}function oM(t,e){e["!protect"]&&wt(t,535,Y9(e["!protect"]))}function lM(t,e,r,a){var n=hi(),s=r.SheetNames[t],o=r.Sheets[s]||{},u=s;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var f=ra(o["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],wt(n,129),(r.vbaraw||o["!outline"])&&wt(n,147,t9(u,o["!outline"])),wt(n,148,ZP(f)),iM(n,o,r.Workbook),tM(n,o),Q9(n,o,t,e),oM(n,o),sM(n,o,r,t),eM(n,o),aM(n,o,a),o["!margins"]&&wt(n,476,$9(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&rM(n,o),nM(n,o,t,a),wt(n,130),n.end()}function cM(t){var e=[],r=t.match(/^<c:numCache>/),a;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var n=ta((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[e,n,a]}function uM(t,e,r,a,n,s){var o=s||{"!type":"chart"};if(!t)return s;var u=0,f=0,h="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var y=cM(v);m.s.r=m.s.c=0,m.e.c=u,h=rn(u),y[0].forEach(function(g,b){o[h+En(b)]={t:"n",v:g,z:y[1]},f=b}),m.e.r<f&&(m.e.r=f),++u}),u>0&&(o["!ref"]=Tr(m)),o}function fM(t,e,r,a,n){if(!t)return t;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,u=t.match(ON);return u&&Ex(u[0],s,n,r),(o=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function hM(t,e){t.l+=10;var r=Ls(t);return{name:r}}function dM(t,e,r,a,n){if(!t)return t;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return vc(t,function(f,h,m){switch(m){case 550:s["!rel"]=f;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),f.name&&(n.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},e),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var Ax=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],mM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],pM=[],gM=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Yw(t,e){for(var r=0;r!=t.length;++r)for(var a=t[r],n=0;n!=e.length;++n){var s=e[n];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=Ba(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function Xw(t,e){for(var r=0;r!=e.length;++r){var a=e[r];if(t[a[0]]==null)t[a[0]]=a[1];else switch(a[2]){case"bool":typeof t[a[0]]=="string"&&(t[a[0]]=Ba(t[a[0]]));break;case"int":typeof t[a[0]]=="string"&&(t[a[0]]=parseInt(t[a[0]],10));break}}}function LN(t){Xw(t.WBProps,Ax),Xw(t.CalcPr,gM),Yw(t.WBView,mM),Yw(t.Sheets,pM),Xh.date1904=Ba(t.WBProps.date1904)}function vM(t){return!t.Workbook||!t.Workbook.WBProps?"false":Ba(t.Workbook.WBProps.date1904)?"true":"false"}var xM="][*?/\\".split("");function PN(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return xM.forEach(function(a){if(t.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function yM(t,e,r){t.forEach(function(a,n){PN(a);for(var s=0;s<n;++s)if(a==t[s])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=e&&e[n]&&e[n].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function _M(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];yM(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)vP(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var bM=/<\w+:workbook/;function wM(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},o=0;if(t.replace(Ms,function(f,h){var m=_r(f);switch(El(m[0])){case"<?xml":break;case"<workbook":f.match(bM)&&(n="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=m[n];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ax.forEach(function(v){if(m[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=Ba(m[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(m[v[0]],10);break;default:r.WBProps[v[0]]=m[v[0]]}}),m.codeName&&(r.WBProps.CodeName=ka(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=ta(ka(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=ka(m.name),m.comment&&(s.Comment=m.comment),m.localSheetId&&(s.Sheet=+m.localSheetId),Ba(m.hidden||"0")&&(s.Hidden=!0),o=h+f.length;break;case"</definedName>":s.Ref=ta(ka(t.slice(o,h))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&e.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return f}),Af.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return LN(r),r}function MN(t){var e=[An];e[e.length]=Pt("workbook",null,{xmlns:Af[0],"xmlns:r":Xn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Ax.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(a[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(a.codeName=t.Workbook.WBProps.CodeName,delete a.CodeName)),e[e.length]=Pt("workbookPr",null,a);var n=t.Workbook&&t.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:xa(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Pt("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(e[e.length]=Pt("definedName",xa(u.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function SM(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=u2(t),r.name=Ls(t),r}function NM(t,e){return e||(e=lt(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),dx(t.strRelID,e),os(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function kM(t,e){var r={},a=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var n=e>8?Ls(t):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function jM(t,e){e||(e=lt(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),A3(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function EM(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function AM(t,e,r){var a=t.l+e;t.l+=4,t.l+=1;var n=t.read_shift(4),s=nO(t),o=fP(t,0,r),u=hx(t);t.l=a;var f={Name:s,Ptg:o};return n<268435455&&(f.Sheet=n),u&&(f.Comment=u),f}function CM(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],L0[16]={n:"BrtFRTArchID$",f:EM},vc(t,function(f,h,m){switch(m){case 156:o.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=Rs(f.Ptg,null,null,o,e),delete e.SID,delete f.Ptg,s.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([m,f]):o[0]=[m,f],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(f),o.XTI=o.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(m),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(m),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!h.T){if(!n||e.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},e),LN(r),r.Names=s,r.supbooks=o,r}function TM(t,e){wt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var a=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};wt(t,156,NM(n))}wt(t,144)}function OM(t,e){e||(e=lt(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return os("SheetJS",e),os(Bp.version,e),os(Bp.version,e),os("7262",e),e.length>e.l?e.slice(0,e.l):e}function RM(t,e){e||(e=lt(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function DM(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,a=0,n=-1,s=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&s==-1&&(s=a);s>n||(wt(t,135),wt(t,158,RM(n)),wt(t,136))}}function FM(t,e){var r=hi();return wt(r,131),wt(r,128,OM()),wt(r,153,jM(t.Workbook&&t.Workbook.WBProps||null)),DM(r,t),TM(r,t),wt(r,132),r.end()}function LM(t,e,r){return e.slice(-4)===".bin"?CM(t,r):wM(t,r)}function PM(t,e,r,a,n,s,o,u){return e.slice(-4)===".bin"?J9(t,a,r,n,s,o,u):AP(t,a,r,n,s,o,u)}function MM(t,e,r,a,n,s,o,u){return e.slice(-4)===".bin"?dM(t,a,r,n,s):fM(t,a,r,n,s)}function IM(t,e,r,a,n,s,o,u){return e.slice(-4)===".bin"?UF():qF()}function BM(t,e,r,a,n,s,o,u){return e.slice(-4)===".bin"?IF():BF()}function UM(t,e,r,a){return e.slice(-4)===".bin"?LD(t,r,a):SD(t,r,a)}function qM(t,e,r){return vN(t,r)}function zM(t,e,r){return e.slice(-4)===".bin"?zR(t,r):BR(t,r)}function HM(t,e,r){return e.slice(-4)===".bin"?DF(t,r):NF(t,r)}function $M(t,e,r){return e.slice(-4)===".bin"?bF(t):yF(t)}function WM(t,e,r,a){return r.slice(-4)===".bin"?wF(t,e,r,a):void 0}function VM(t,e,r){return e.slice(-4)===".bin"?gF(t,e,r):xF(t,e,r)}function GM(t,e,r){return(e.slice(-4)===".bin"?FM:MN)(t)}function YM(t,e,r,a,n){return(e.slice(-4)===".bin"?lM:RN)(t,r,a,n)}function XM(t,e,r){return(e.slice(-4)===".bin"?WD:pN)(t,r)}function KM(t,e,r){return(e.slice(-4)===".bin"?WR:oN)(t,r)}function JM(t,e,r){return(e.slice(-4)===".bin"?FF:_N)(t)}function ZM(t){return(t.slice(-4)===".bin"?vF:xN)()}var IN=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,BN=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qo(t,e){var r=t.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=t.match(IN),s,o,u,f;if(n)for(f=0;f!=n.length;++f)s=n[f].match(BN),(o=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?u="xmlns"+s[1].slice(6):u=s[1].slice(o+1),a[u]=s[2].slice(1,s[2].length-1));return a}function QM(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var a=t.match(IN),n,s,o,u;if(a)for(u=0;u!=a.length;++u)n=a[u].match(BN),(s=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(s+1),r[o]=n[2].slice(1,n[2].length-1));return r}var m0;function eI(t,e){var r=m0[t]||ta(t);return r==="General"?vf(e):fo(r,e)}function tI(t,e,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Ba(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=qa(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[ta(e)]=n}function rI(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||xc[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=j0(t.v):t.w=vf(t.v):t.w=eI(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var a=m0[e]||e||"General";if(r.cellNF&&(t.z=a),r.cellDates&&t.t=="n"&&cd(a)){var n=ff(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(r.WTF)throw s}}}function aI(t,e,r){if(r.cellStyles&&e.Interior){var a=e.Interior;a.Pattern&&(a.patternType=pD[a.Pattern]||a.Pattern)}t[e.ID]=e}function nI(t,e,r,a,n,s,o,u,f,h){var m="General",v=a.StyleID,y={};h=h||{};var g=[],b=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&o&&(v=o.StyleID);s[v]!==void 0&&(s[v].nf&&(m=s[v].nf),s[v].Interior&&g.push(s[v].Interior),!!s[v].Parent);)v=s[v].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=Ba(t);break;case"String":a.t="s",a.r=hw(ta(t)),a.v=t.indexOf("<")>-1?ta(e||t).replace(/<.*?>/g,""):a.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),a.v=(qa(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=ta(t):a.v<60&&(a.v=a.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+t),a.t||(a.t="n");break;case"Error":a.t="e",a.v=D3[t],h.cellText!==!1&&(a.w=t);break;default:t==""&&e==""?a.t="z":(a.t="s",a.v=hw(e||t));break}if(rI(a,m,h),h.cellFormula!==!1)if(a.Formula){var _=ta(a.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),a.f=Yh(_,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Yh("RC:RC",n):a.ArrayRange&&(a.F=Yh(a.ArrayRange,n),f.push([ra(a.F),a.F]))}else for(b=0;b<f.length;++b)n.r>=f[b][0].s.r&&n.r<=f[b][0].e.r&&n.c>=f[b][0].s.c&&n.c<=f[b][0].e.c&&(a.F=f[b][1]);h.cellStyles&&(g.forEach(function(S){!y.patternType&&S.patternType&&(y.patternType=S.patternType)}),a.s=y),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function sI(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function ov(t,e){var r=e||{};ud();var a=r0(ix(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=ka(a));var n=a.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=za(r);return o.type="string",ad.to_workbook(a,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(rt){n.indexOf("<"+rt)>=0&&(s=!0)}),s)return $I(a,r);m0={"General Number":"General","General Date":xr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":xr[15],"Short Date":xr[14],"Long Time":xr[19],"Medium Time":xr[18],"Short Time":xr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:xr[2],Standard:xr[4],Percent:xr[10],Scientific:xr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],h,m={},v=[],y=r.dense?[]:{},g="",b={},_={},S=qo('<Data ss:Type="String">'),E=0,C=0,j=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},H={},Y={},U="",V=0,F=[],X={},P={},O=0,I=[],W=[],ne={},Q=[],le,ee=!1,K=[],ue=[],M={},A=0,D=0,B={Sheets:[],WBProps:{date1904:!1}},q={};C0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var Z="";u=C0.exec(a);)switch(u[3]=(Z=u[3]).toLowerCase()){case"data":if(Z=="data"){if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?nI(a.slice(E,u.index),U,S,f[f.length-1][0]=="comment"?ne:b,{c:C,r:j},H,Q[C],_,K,r):(U="",S=qo(u[0]),E=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(W.length>0&&(b.c=W),(!r.sheetRows||r.sheetRows>j)&&b.v!==void 0&&(r.dense?(y[j]||(y[j]=[]),y[j][C]=b):y[rn(C)+En(j)]=b),b.HRef&&(b.l={Target:ta(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(A=C+(parseInt(b.MergeAcross,10)|0),D=j+(parseInt(b.MergeDown,10)|0),F.push({s:{c:C,r:j},e:{c:A,r:D}})),!r.sheetStubs)b.MergeAcross?C=A+1:++C;else if(b.MergeAcross||b.MergeDown){for(var oe=C;oe<=A;++oe)for(var pe=j;pe<=D;++pe)(oe>C||pe>j)&&(r.dense?(y[pe]||(y[pe]=[]),y[pe][oe]={t:"z"}):y[rn(oe)+En(pe)]={t:"z"});C=A+1}else++C;else b=QM(u[0]),b.Index&&(C=+b.Index-1),C<R.s.c&&(R.s.c=C),C>R.e.c&&(R.e.c=C),u[0].slice(-2)==="/>"&&++C,W=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(j<R.s.r&&(R.s.r=j),j>R.e.r&&(R.e.r=j),u[0].slice(-2)==="/>"&&(_=qo(u[0]),_.Index&&(j=+_.Index-1)),C=0,++j):(_=qo(u[0]),_.Index&&(j=+_.Index-1),M={},(_.AutoFitHeight=="0"||_.Height)&&(M.hpx=parseInt(_.Height,10),M.hpt=F0(M.hpx),ue[j]=M),_.Hidden=="1"&&(M.hidden=!0,ue[j]=M));break;case"worksheet":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));v.push(g),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(y["!ref"]=Tr(R),r.sheetRows&&r.sheetRows<=R.e.r&&(y["!fullref"]=y["!ref"],R.e.r=r.sheetRows-1,y["!ref"]=Tr(R))),F.length&&(y["!merges"]=F),Q.length>0&&(y["!cols"]=Q),ue.length>0&&(y["!rows"]=ue),m[g]=y}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},j=C=0,f.push([u[3],!1]),h=qo(u[0]),g=ta(h.Name),y=r.dense?[]:{},F=[],K=[],ue=[],q={name:g,Hidden:0},B.Sheets.push(q);break;case"table":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),Q=[],ee=!1}break;case"style":u[1]==="/"?aI(H,Y,r):Y=qo(u[0]);break;case"numberformat":Y.nf=ta(qo(u[0]).Format||"General"),m0[Y.nf]&&(Y.nf=m0[Y.nf]);for(var _e=0;_e!=392&&xr[_e]!=Y.nf;++_e);if(_e==392){for(_e=57;_e!=392;++_e)if(xr[_e]==null){uc(Y.nf,_e);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(le=qo(u[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!ee&&le.wpx>10){ee=!0,Ds=dN;for(var be=0;be<Q.length;++be)Q[be]&&du(Q[be])}ee&&du(le),Q[le.Index-1||Q.length]=le;for(var Le=0;Le<+le.Span;++Le)Q[Q.length]=za(le);break;case"namedrange":if(u[1]==="/")break;B.Names||(B.Names=[]);var he=_r(u[0]),Ae={Name:he.Name,Ref:Yh(he.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(Ae.Sheet=B.Sheets.length-1),B.Names.push(Ae);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?U+=a.slice(V,u.index):V=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;Y.Interior=qo(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?CO(X,Z,a.slice(O,u.index)):O=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));sI(ne),W.push(ne)}else f.push([u[3],!1]),h=qo(u[0]),ne={a:h.Author};break;case"autofilter":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var de=qo(u[0]);y["!autofilter"]={ref:Yh(de.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return e5(a,r);var re=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:re=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:re=!1}break;case"excelworkbook":switch(u[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:re=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:re=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(a.slice(O,u.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else O=u.index+u[0].length;break;case"header":y["!margins"]||pf(y["!margins"]={},"xlml"),isNaN(+_r(u[0]).Margin)||(y["!margins"].header=+_r(u[0]).Margin);break;case"footer":y["!margins"]||pf(y["!margins"]={},"xlml"),isNaN(+_r(u[0]).Margin)||(y["!margins"].footer=+_r(u[0]).Margin);break;case"pagemargins":var Ke=_r(u[0]);y["!margins"]||pf(y["!margins"]={},"xlml"),isNaN(+Ke.Top)||(y["!margins"].top=+Ke.Top),isNaN(+Ke.Left)||(y["!margins"].left=+Ke.Left),isNaN(+Ke.Right)||(y["!margins"].right=+Ke.Right),isNaN(+Ke.Bottom)||(y["!margins"].bottom=+Ke.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:re=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:re=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:re=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:re=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:re=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:re=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:re=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:re=!1}break;case"smarttags":break;default:re=!1;break}if(re||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?tI(P,Z,I,a.slice(O,u.index)):(I=u,O=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var Oe={};return!r.bookSheets&&!r.bookProps&&(Oe.Sheets=m),Oe.SheetNames=v,Oe.Workbook=B,Oe.SSF=za(xr),Oe.Props=X,Oe.Custprops=P,Oe}function v2(t,e){switch(Tx(e=e||{}),e.type||"base64"){case"base64":return ov(qi(t),e);case"binary":case"buffer":case"file":return ov(t,e);case"array":return ov(xu(t),e)}}function iI(t,e){var r=[];return t.Props&&r.push(TO(t.Props,e)),t.Custprops&&r.push(OO(t.Props,t.Custprops)),r.join("")}function oI(){return""}function lI(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(a,n){var s=[];s.push(Pt("NumberFormat",null,{"ss:Format":xa(xr[a.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(Pt("Style",s.join(""),o))}),Pt("Styles",r.join(""))}function UN(t){return Pt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Nx(t.Ref,{r:0,c:0})})}function cI(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],a=0;a<e.length;++a){var n=e[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(UN(n)))}return Pt("Names",r.join(""))}function uI(t,e,r,a){if(!t||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,s=[],o=0;o<n.length;++o){var u=n[o];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||s.push(UN(u)))}return s.join("")}function fI(t,e,r,a){if(!t)return"";var n=[];if(t["!margins"]&&(n.push("<PageSetup>"),t["!margins"].header&&n.push(Pt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&n.push(Pt("Footer",null,{"x:Margin":t["!margins"].footer})),n.push(Pt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Pt("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(a.Workbook.Sheets[s]&&!a.Workbook.Sheets[s].Hidden);++s);s==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),t["!protect"]&&(n.push(_s("ProtectContents","True")),t["!protect"].objects&&n.push(_s("ProtectObjects","True")),t["!protect"].scenarios&&n.push(_s("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?n.push(_s("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&n.push(_s("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":Pt("WorksheetOptions",n.join(""),{xmlns:Ri.x})}function hI(t){return t.map(function(e){var r=D8(e.t||""),a=Pt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Pt("Comment",a,{"ss:Author":e.a})}).join("")}function dI(t,e,r,a,n,s,o){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+xa(Nx(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var f=an(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==o.r?"":"["+(f.r-o.r)+"]")+"C"+(f.c==o.c?"":"["+(f.c-o.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=xa(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=xa(t.l.Tooltip))),r["!merges"])for(var h=r["!merges"],m=0;m!=h.length;++m)h[m].s.c!=o.c||h[m].s.r!=o.r||(h[m].e.c>h[m].s.c&&(u["ss:MergeAcross"]=h[m].e.c-h[m].s.c),h[m].e.r>h[m].s.r&&(u["ss:MergeDown"]=h[m].e.r-h[m].s.r));var v="",y="";switch(t.t){case"z":if(!a.sheetStubs)return"";break;case"n":v="Number",y=String(t.v);break;case"b":v="Boolean",y=t.v?"1":"0";break;case"e":v="Error",y=xc[t.v];break;case"d":v="DateTime",y=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||xr[14]);break;case"s":v="String",y=R8(t.v||"");break}var g=_u(a.cellXfs,t,a);u["ss:StyleID"]="s"+(21+g),u["ss:Index"]=o.c+1;var b=t.v!=null?y:"",_=t.t=="z"?"":'<Data ss:Type="'+v+'">'+b+"</Data>";return(t.c||[]).length>0&&(_+=hI(t.c)),Pt("Cell",_,u)}function mI(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=nd(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function pI(t,e,r,a){if(!t["!ref"])return"";var n=ra(t["!ref"]),s=t["!merges"]||[],o=0,u=[];t["!cols"]&&t["!cols"].forEach(function(S,E){du(S);var C=!!S.width,j=x1(E,S),R={"ss:Index":E+1};C&&(R["ss:Width"]=R0(j.width)),S.hidden&&(R["ss:Hidden"]="1"),u.push(Pt("Column",null,R))});for(var f=Array.isArray(t),h=n.s.r;h<=n.e.r;++h){for(var m=[mI(h,(t["!rows"]||[])[h])],v=n.s.c;v<=n.e.c;++v){var y=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>v)&&!(s[o].s.r>h)&&!(s[o].e.c<v)&&!(s[o].e.r<h)){(s[o].s.c!=v||s[o].s.r!=h)&&(y=!0);break}if(!y){var g={r:h,c:v},b=yr(g),_=f?(t[h]||[])[v]:t[b];m.push(dI(_,b,t,e,r,a,g))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function gI(t,e,r){var a=[],n=r.SheetNames[t],s=r.Sheets[n],o=s?uI(s,e,t,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=s?pI(s,e,t,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(fI(s,e,t,r)),a.join("")}function vI(t,e){e||(e={}),t.SSF||(t.SSF=za(xr)),t.SSF&&(ud(),f1(t.SSF),e.revssf=d1(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],_u(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(iI(t,e)),r.push(oI()),r.push(""),r.push("");for(var a=0;a<t.SheetNames.length;++a)r.push(Pt("Worksheet",gI(a,e,t),{"ss:Name":xa(t.SheetNames[a])}));return r[2]=lI(t,e),r[3]=cI(t),An+Pt("Workbook",r.join(""),{xmlns:Ri.ss,"xmlns:o":Ri.o,"xmlns:x":Ri.x,"xmlns:ss":Ri.ss,"xmlns:dt":Ri.dt,"xmlns:html":Ri.html})}function xI(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=cO(r),r.length-r.l<=4)return e;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(e.UnicodeClipboardFormat=uO(r),a=r.read_shift(4),a==0||a>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var yI=[60,1084,2066,2165,2175];function _I(t,e,r,a,n){var s=a,o=[],u=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(u)}o.push(u),r.l+=s;for(var f=oc(r,r.l),h=x2[f],m=0;h!=null&&yI.indexOf(f)>-1;)s=oc(r,r.l+2),m=r.l+4,f==2066?m+=4:(f==2165||f==2175)&&(m+=12),u=r.slice(m,r.l+4+s),o.push(u),r.l+=4+s,h=x2[f=oc(r,r.l)];var v=is(o);ys(v,0);var y=0;v.lens=[];for(var g=0;g<o.length;++g)v.lens.push(y),y+=o[g].length;if(v.length<a)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+a;return e.f(v,v.length,n)}function xl(t,e,r){if(t.t!=="z"&&t.XF){var a=0;try{a=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=xr[a])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||xc[t.v]:a===0||a=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=j0(t.v):t.w=vf(t.v):t.w=fo(a,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&a&&t.t=="n"&&cd(xr[a]||String(a))){var n=ff(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function fp(t,e,r){return{v:t,ixfe:e,t:r}}function bI(t,e){var r={opts:{}},a={},n=e.dense?[]:{},s={},o={},u=null,f=[],h="",m={},v,y="",g,b,_,S,E={},C=[],j,R,H=[],Y=[],U={Sheets:[],WBProps:{date1904:!1},Views:[{}]},V={},F=function(ft){return ft<8?hf[ft]:ft<64&&Y[ft-8]||hf[ft]},X=function(ft,yt,er){var Lt=yt.XF.data;if(!(!Lt||!Lt.patternType||!er||!er.cellStyles)){yt.s={},yt.s.patternType=Lt.patternType;var Bt;(Bt=O0(F(Lt.icvFore)))&&(yt.s.fgColor={rgb:Bt}),(Bt=O0(F(Lt.icvBack)))&&(yt.s.bgColor={rgb:Bt})}},P=function(ft,yt,er){if(!(M>1)&&!(er.sheetRows&&ft.r>=er.sheetRows)){if(er.cellStyles&&yt.XF&&yt.XF.data&&X(ft,yt,er),delete yt.ixfe,delete yt.XF,v=ft,y=yr(ft),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ft.r<o.s.r&&(o.s.r=ft.r),ft.c<o.s.c&&(o.s.c=ft.c),ft.r+1>o.e.r&&(o.e.r=ft.r+1),ft.c+1>o.e.c&&(o.e.c=ft.c+1),er.cellFormula&&yt.f){for(var Lt=0;Lt<C.length;++Lt)if(!(C[Lt][0].s.c>ft.c||C[Lt][0].s.r>ft.r)&&!(C[Lt][0].e.c<ft.c||C[Lt][0].e.r<ft.r)){yt.F=Tr(C[Lt][0]),(C[Lt][0].s.c!=ft.c||C[Lt][0].s.r!=ft.r)&&delete yt.f,yt.f&&(yt.f=""+Rs(C[Lt][1],o,ft,K,O));break}}er.dense?(n[ft.r]||(n[ft.r]=[]),n[ft.r][ft.c]=yt):n[y]=yt}},O={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(O.password=e.password);var I,W=[],ne=[],Q=[],le=[],ee=!1,K=[];K.SheetNames=O.snames,K.sharedf=O.sharedf,K.arrayf=O.arrayf,K.names=[],K.XTI=[];var ue=0,M=0,A=0,D=[],B=[],q;O.codepage=1200,Vo(1200);for(var Z=!1;t.l<t.length-1;){var oe=t.l,pe=t.read_shift(2);if(pe===0&&ue===10)break;var _e=t.l===t.length?0:t.read_shift(2),be=x2[pe];if(be&&be.f){if(e.bookSheets&&ue===133&&pe!==133)break;if(ue=pe,be.r===2||be.r==12){var Le=t.read_shift(2);if(_e-=2,!O.enc&&Le!==pe&&((Le&255)<<8|Le>>8)!==pe)throw new Error("rt mismatch: "+Le+"!="+pe);be.r==12&&(t.l+=10,_e-=10)}var he={};if(pe===10?he=be.f(t,_e,O):he=_I(pe,be,t,_e,O),M==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(pe){case 34:r.opts.Date1904=U.WBProps.date1904=he;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(O.enc||(t.l=0),O.enc=he,!e.password)throw new Error("File is password-protected");if(he.valid==null)throw new Error("Encryption scheme unsupported");if(!he.valid)throw new Error("Password is incorrect");break;case 92:O.lastuser=he;break;case 66:var Ae=Number(he);switch(Ae){case 21010:Ae=1200;break;case 32768:Ae=1e4;break;case 32769:Ae=1252;break}Vo(O.codepage=Ae),Z=!0;break;case 317:O.rrtabid=he;break;case 25:O.winlocked=he;break;case 439:r.opts.RefreshAll=he;break;case 12:r.opts.CalcCount=he;break;case 16:r.opts.CalcDelta=he;break;case 17:r.opts.CalcIter=he;break;case 13:r.opts.CalcMode=he;break;case 14:r.opts.CalcPrecision=he;break;case 95:r.opts.CalcSaveRecalc=he;break;case 15:O.CalcRefMode=he;break;case 2211:r.opts.FullCalc=he;break;case 129:he.fDialog&&(n["!type"]="dialog"),he.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),he.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:H.push(he);break;case 430:K.push([he]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(he);break;case 24:case 536:q={Name:he.Name,Ref:Rs(he.rgce,o,null,K,O)},he.itab>0&&(q.Sheet=he.itab-1),K.names.push(q),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(he),he.Name=="_xlnm._FilterDatabase"&&he.itab>0&&he.rgce&&he.rgce[0]&&he.rgce[0][0]&&he.rgce[0][0][0]=="PtgArea3d"&&(B[he.itab-1]={ref:Tr(he.rgce[0][0][1][2])});break;case 22:O.ExternCount=he;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(he),K.XTI=K.XTI.concat(he);break;case 2196:if(O.biff<8)break;q!=null&&(q.Comment=he[1]);break;case 18:n["!protect"]=he;break;case 19:he!==0&&O.WTF&&console.error("Password verifier: "+he);break;case 133:s[he.pos]=he,O.snames.push(he.name);break;case 10:{if(--M)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=Tr(o),e.sheetRows&&e.sheetRows<=o.e.r){var de=o.e.r;o.e.r=e.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Tr(o),o.e.r=de}o.e.r++,o.e.c++}W.length>0&&(n["!merges"]=W),ne.length>0&&(n["!objects"]=ne),Q.length>0&&(n["!cols"]=Q),le.length>0&&(n["!rows"]=le),U.Sheets.push(V)}h===""?m=n:a[h]=n,n=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(O.biff===8&&(O.biff={9:2,521:3,1033:4}[pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[he.BIFFVer]||8),O.biffguess=he.BIFFVer==0,he.BIFFVer==0&&he.dt==4096&&(O.biff=5,Z=!0,Vo(O.codepage=28591)),O.biff==8&&he.BIFFVer==0&&he.dt==16&&(O.biff=2),M++)break;if(n=e.dense?[]:{},O.biff<8&&!Z&&(Z=!0,Vo(O.codepage=e.codepage||1252)),O.biff<5||he.BIFFVer==0&&he.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var re={pos:t.l-_e,name:h};s[re.pos]=re,O.snames.push(h)}else h=(s[oe]||{name:""}).name;he.dt==32&&(n["!type"]="chart"),he.dt==64&&(n["!type"]="macro"),W=[],ne=[],O.arrayf=C=[],Q=[],le=[],ee=!1,V={Hidden:(s[oe]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(e.dense?(n[he.r]||[])[he.c]:n[yr({c:he.c,r:he.r})])&&++he.c,j={ixfe:he.ixfe,XF:H[he.ixfe]||{},v:he.val,t:"n"},A>0&&(j.z=D[j.ixfe>>8&63]),xl(j,e,r.opts.Date1904),P({c:he.c,r:he.r},j,e);break;case 5:case 517:j={ixfe:he.ixfe,XF:H[he.ixfe],v:he.val,t:he.t},A>0&&(j.z=D[j.ixfe>>8&63]),xl(j,e,r.opts.Date1904),P({c:he.c,r:he.r},j,e);break;case 638:j={ixfe:he.ixfe,XF:H[he.ixfe],v:he.rknum,t:"n"},A>0&&(j.z=D[j.ixfe>>8&63]),xl(j,e,r.opts.Date1904),P({c:he.c,r:he.r},j,e);break;case 189:for(var Ke=he.c;Ke<=he.C;++Ke){var Oe=he.rkrec[Ke-he.c][0];j={ixfe:Oe,XF:H[Oe],v:he.rkrec[Ke-he.c][1],t:"n"},A>0&&(j.z=D[j.ixfe>>8&63]),xl(j,e,r.opts.Date1904),P({c:Ke,r:he.r},j,e)}break;case 6:case 518:case 1030:{if(he.val=="String"){u=he;break}if(j=fp(he.val,he.cell.ixfe,he.tt),j.XF=H[j.ixfe],e.cellFormula){var rt=he.formula;if(rt&&rt[0]&&rt[0][0]&&rt[0][0][0]=="PtgExp"){var tt=rt[0][0][1][0],Et=rt[0][0][1][1],kt=yr({r:tt,c:Et});E[kt]?j.f=""+Rs(he.formula,o,he.cell,K,O):j.F=((e.dense?(n[tt]||[])[Et]:n[kt])||{}).F}else j.f=""+Rs(he.formula,o,he.cell,K,O)}A>0&&(j.z=D[j.ixfe>>8&63]),xl(j,e,r.opts.Date1904),P(he.cell,j,e),u=he}break;case 7:case 519:if(u)u.val=he,j=fp(he,u.cell.ixfe,"s"),j.XF=H[j.ixfe],e.cellFormula&&(j.f=""+Rs(u.formula,o,u.cell,K,O)),A>0&&(j.z=D[j.ixfe>>8&63]),xl(j,e,r.opts.Date1904),P(u.cell,j,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(he);var zt=yr(he[0].s);if(g=e.dense?(n[he[0].s.r]||[])[he[0].s.c]:n[zt],e.cellFormula&&g){if(!u||!zt||!g)break;g.f=""+Rs(he[1],o,he[0],K,O),g.F=Tr(he[0])}}break;case 1212:{if(!e.cellFormula)break;if(y){if(!u)break;E[yr(u.cell)]=he[0],g=e.dense?(n[u.cell.r]||[])[u.cell.c]:n[yr(u.cell)],(g||{}).f=""+Rs(he[0],o,v,K,O)}}break;case 253:j=fp(f[he.isst].t,he.ixfe,"s"),f[he.isst].h&&(j.h=f[he.isst].h),j.XF=H[j.ixfe],A>0&&(j.z=D[j.ixfe>>8&63]),xl(j,e,r.opts.Date1904),P({c:he.c,r:he.r},j,e);break;case 513:e.sheetStubs&&(j={ixfe:he.ixfe,XF:H[he.ixfe],t:"z"},A>0&&(j.z=D[j.ixfe>>8&63]),xl(j,e,r.opts.Date1904),P({c:he.c,r:he.r},j,e));break;case 190:if(e.sheetStubs)for(var Tt=he.c;Tt<=he.C;++Tt){var at=he.ixfe[Tt-he.c];j={ixfe:at,XF:H[at],t:"z"},A>0&&(j.z=D[j.ixfe>>8&63]),xl(j,e,r.opts.Date1904),P({c:Tt,r:he.r},j,e)}break;case 214:case 516:case 4:j=fp(he.val,he.ixfe,"s"),j.XF=H[j.ixfe],A>0&&(j.z=D[j.ixfe>>8&63]),xl(j,e,r.opts.Date1904),P({c:he.c,r:he.r},j,e);break;case 0:case 512:M===1&&(o=he);break;case 252:f=he;break;case 1054:if(O.biff==4){D[A++]=he[1];for(var pt=0;pt<A+163&&xr[pt]!=he[1];++pt);pt>=163&&uc(he[1],A+163)}else uc(he[1],he[0]);break;case 30:{D[A++]=he;for(var At=0;At<A+163&&xr[At]!=he;++At);At>=163&&uc(he,A+163)}break;case 229:W=W.concat(he);break;case 93:ne[he.cmo[0]]=O.lastobj=he;break;case 438:O.lastobj.TxO=he;break;case 127:O.lastobj.ImData=he;break;case 440:for(S=he[0].s.r;S<=he[0].e.r;++S)for(_=he[0].s.c;_<=he[0].e.c;++_)g=e.dense?(n[S]||[])[_]:n[yr({c:_,r:S})],g&&(g.l=he[1]);break;case 2048:for(S=he[0].s.r;S<=he[0].e.r;++S)for(_=he[0].s.c;_<=he[0].e.c;++_)g=e.dense?(n[S]||[])[_]:n[yr({c:_,r:S})],g&&g.l&&(g.l.Tooltip=he[1]);break;case 28:{if(O.biff<=5&&O.biff>=2)break;g=e.dense?(n[he[0].r]||[])[he[0].c]:n[yr(he[0])];var Dt=ne[he[2]];g||(e.dense?(n[he[0].r]||(n[he[0].r]=[]),g=n[he[0].r][he[0].c]={t:"z"}):g=n[yr(he[0])]={t:"z"},o.e.r=Math.max(o.e.r,he[0].r),o.s.r=Math.min(o.s.r,he[0].r),o.e.c=Math.max(o.e.c,he[0].c),o.s.c=Math.min(o.s.c,he[0].c)),g.c||(g.c=[]),b={a:he[1],t:Dt.TxO.t},g.c.push(b)}break;case 2173:lF(H[he.ixfe],he.ext);break;case 125:{if(!O.cellStyles)break;for(;he.e>=he.s;)Q[he.e--]={width:he.w/256,level:he.level||0,hidden:!!(he.flags&1)},ee||(ee=!0,bx(he.w/256)),du(Q[he.e+1])}break;case 520:{var xt={};he.level!=null&&(le[he.r]=xt,xt.level=he.level),he.hidden&&(le[he.r]=xt,xt.hidden=!0),he.hpt&&(le[he.r]=xt,xt.hpt=he.hpt,xt.hpx=nd(he.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||pf(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[pe]]=he;break;case 161:n["!margins"]||pf(n["!margins"]={}),n["!margins"].header=he.header,n["!margins"].footer=he.footer;break;case 574:he.RTL&&(U.Views[0].RTL=!0);break;case 146:Y=he;break;case 2198:I=he;break;case 140:R=he;break;case 442:h?V.CodeName=he||V.name:U.WBProps.CodeName=he||"ThisWorkbook";break}}else be||console.error("Missing Info for XLS Record 0x"+pe.toString(16)),t.l+=_e}return r.SheetNames=gn(s).sort(function(St,ft){return Number(St)-Number(ft)}).map(function(St){return s[St].name}),e.bookSheets||(r.Sheets=a),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&B.forEach(function(St,ft){r.Sheets[r.SheetNames[ft]]["!autofilter"]=St}),r.Strings=f,r.SSF=za(xr),O.enc&&(r.Encryption=O.enc),I&&(r.Themes=I),r.Metadata={},R!==void 0&&(r.Metadata.Country=R),K.names.length>0&&(U.Names=K.names),r.Workbook=U,r}var p0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function wI(t,e,r){var a=fr.find(t,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Tw(a,f2,p0.DSI);for(var s in n)e[s]=n[s]}catch(h){if(r.WTF)throw h}var o=fr.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var u=Tw(o,h2,p0.SI);for(var f in u)e[f]==null&&(e[f]=u[f])}catch(h){if(r.WTF)throw h}e.HeadingPairs&&e.TitlesOfParts&&(B3(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function SI(t,e){var r=[],a=[],n=[],s=0,o,u=iw(f2,"n"),f=iw(h2,"n");if(t.Props)for(o=gn(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(u,o[s])?r:Object.prototype.hasOwnProperty.call(f,o[s])?a:n).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=gn(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(u,o[s])?r:Object.prototype.hasOwnProperty.call(f,o[s])?a:n).push([o[s],t.Custprops[o[s]]]);var h=[];for(s=0;s<n.length;++s)V3.indexOf(n[s][0])>-1||I3.indexOf(n[s][0])>-1||n[s][1]!=null&&h.push(n[s]);a.length&&fr.utils.cfb_add(e,"/SummaryInformation",Ow(a,p0.SI,f,h2)),(r.length||h.length)&&fr.utils.cfb_add(e,"/DocumentSummaryInformation",Ow(r,p0.DSI,u,f2,h.length?h:null,p0.UDI))}function qN(t,e){e||(e={}),Tx(e),J2(),e.codepage&&K2(e.codepage);var r,a;if(t.FullPaths){if(fr.find(t,"/encryption"))throw new Error("File is password-protected");r=fr.find(t,"!CompObj"),a=fr.find(t,"/Workbook")||fr.find(t,"/Book")}else{switch(e.type){case"base64":t=Pi(qi(t));break;case"binary":t=Pi(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ys(t,0),a={content:t}}var n,s;if(r&&xI(r),e.bookProps&&!e.bookSheets)n={};else{var o=Lr?"buffer":"array";if(a&&a.content)n=bI(a.content,e);else if((s=fr.find(t,"PerfectOffice_MAIN"))&&s.content)n=mf.to_workbook(s.content,(e.type=o,e));else if((s=fr.find(t,"NativeContent_MAIN"))&&s.content)n=mf.to_workbook(s.content,(e.type=o,e));else throw(s=fr.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&fr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=PF(t))}var u={};return t.FullPaths&&wI(t,u,e),n.Props=n.Custprops=u,e.bookFiles&&(n.cfb=t),n}function NI(t,e){var r=e||{},a=fr.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return fr.utils.cfb_add(a,n,zN(t,r)),r.biff==8&&(t.Props||t.Custprops)&&SI(t,a),r.biff==8&&t.vbaraw&&MF(a,fr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),a}var L0={0:{f:YP},1:{f:r9},2:{f:b9},3:{f:u9},4:{f:i9},5:{f:x9},6:{f:j9},7:{f:m9},8:{f:D9},9:{f:R9},10:{f:T9},11:{f:O9},12:{f:n9},13:{f:S9},14:{f:h9},15:{f:l9},16:{f:DN},17:{f:A9},18:{f:g9},19:{f:fx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:AM},40:{},42:{},43:{f:jD},44:{f:ND},45:{f:CD},46:{f:OD},47:{f:TD},48:{},49:{f:J8},50:{},51:{f:fF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:aN},62:{f:k9},63:{f:_F},64:{f:X9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ps,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:W9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:e9},148:{f:JP,p:16},151:{f:B9},152:{},153:{f:kM},154:{},155:{},156:{f:SM},157:{},158:{},159:{T:1,f:qR},160:{T:-1},161:{T:1,f:Rf},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:F9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:cF},336:{T:-1},337:{f:mF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:u2},357:{},358:{},359:{},360:{T:1},361:{},362:{f:rN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:U9},427:{f:q9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:H9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:QP},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:M9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:u2},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:OF},633:{T:1},634:{T:-1},635:{T:1,f:CF},636:{T:-1},637:{f:tO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:hM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:K9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},x2={6:{f:sv},10:{f:eu},12:{f:Pn},13:{f:Pn},14:{f:bn},15:{f:bn},16:{f:Fs},17:{f:bn},18:{f:bn},19:{f:Pn},20:{f:Mw},21:{f:Mw},23:{f:rN},24:{f:Bw},25:{f:bn},26:{},27:{},28:{f:K7},29:{},34:{f:bn},35:{f:Iw},38:{f:Fs},39:{f:Fs},40:{f:Fs},41:{f:Fs},42:{f:bn},43:{f:bn},47:{f:lD},49:{f:S7},51:{f:Pn},60:{},61:{f:x7},64:{f:bn},65:{f:w7},66:{f:Pn},77:{},80:{},81:{},82:{},85:{f:Pn},89:{},90:{},91:{},92:{f:o7},93:{f:Q7},94:{},95:{f:bn},96:{},97:{},99:{f:bn},125:{f:aN},128:{f:I7},129:{f:c7},130:{f:Pn},131:{f:bn},132:{f:bn},133:{f:u7},134:{},140:{f:oR},141:{f:Pn},144:{},146:{f:uR},151:{},152:{},153:{},154:{},155:{},156:{f:Pn},157:{},158:{},160:{f:vR},161:{f:dR},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:F7},190:{f:L7},193:{f:eu},197:{},198:{},199:{},200:{},201:{},202:{f:bn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Pn},220:{},221:{f:bn},222:{},224:{f:M7},225:{f:i7},226:{f:eu},227:{},229:{f:J7},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:h7},253:{f:k7},255:{f:m7},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:G3},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:bn},353:{f:eu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:H7},431:{f:bn},432:{},433:{},434:{},437:{},438:{f:rR},439:{f:bn},440:{f:aR},441:{},442:{f:V0},443:{},444:{f:Pn},445:{},446:{},448:{f:eu},449:{f:v7,r:2},450:{f:eu},512:{f:Fw},513:{f:gR},515:{f:q7},516:{f:E7},517:{f:Pw},519:{f:xR},520:{f:p7},523:{},545:{f:Uw},549:{f:Dw},566:{},574:{f:_7},638:{f:D7},659:{},1048:{},1054:{f:C7},1084:{},1212:{f:G7},2048:{f:sR},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:lp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:eu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:fR,r:12},2173:{f:oF,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:bn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:V7,r:12},2197:{},2198:{f:tF,r:12},2199:{},2200:{},2201:{},2202:{f:Y7,r:12},2203:{f:eu},2204:{},2205:{},2206:{},2207:{},2211:{f:g7},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Pn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:mR},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:cR},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Fw},1:{},2:{f:SR},3:{f:bR},4:{f:_R},5:{f:Pw},7:{f:kR},8:{},9:{f:lp},11:{},22:{f:Pn},30:{f:O7},31:{},32:{},33:{f:Uw},36:{},37:{f:Dw},50:{f:jR},62:{},52:{},67:{},68:{f:Pn},69:{},86:{},126:{},127:{f:yR},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:ER},223:{},234:{},354:{},421:{},518:{f:sv},521:{f:lp},536:{f:Bw},547:{f:Iw},561:{},579:{},1030:{f:sv},1033:{f:lp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function It(t,e,r,a){var n=e;if(!isNaN(n)){var s=a||(r||[]).length||0,o=t.next(4);o.write_shift(2,n),o.write_shift(2,s),s>0&&lx(r)&&t.push(r)}}function kI(t,e,r,a){var n=(r||[]).length||0;if(n<=8224)return It(t,e,r,n);var s=e;if(!isNaN(s)){for(var o=r.parts||[],u=0,f=0,h=0;h+(o[u]||8224)<=8224;)h+=o[u]||8224,u++;var m=t.next(4);for(m.write_shift(2,s),m.write_shift(2,h),t.push(r.slice(f,f+h)),f+=h;f<n;){for(m=t.next(4),m.write_shift(2,60),h=0;h+(o[u]||8224)<=8224;)h+=o[u]||8224,u++;m.write_shift(2,h),t.push(r.slice(f,f+h)),f+=h}}}function K0(t,e,r){return t||(t=lt(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function jI(t,e,r,a){var n=lt(9);return K0(n,t,e),Y3(r,a||"b",n),n}function EI(t,e,r){var a=lt(8+2*r.length);return K0(a,t,e),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function AI(t,e,r,a){if(e.v!=null)switch(e.t){case"d":case"n":var n=e.t=="d"?Kn(qa(e.v)):e.v;n==(n|0)&&n>=0&&n<65536?It(t,2,NR(r,a,n)):It(t,3,wR(r,a,n));return;case"b":case"e":It(t,5,jI(r,a,e.v,e.t));return;case"s":case"str":It(t,4,EI(r,a,(e.v||"").slice(0,255)));return}It(t,1,K0(null,r,a))}function CI(t,e,r,a){var n=Array.isArray(e),s=ra(e["!ref"]||"A1"),o,u="",f=[];if(s.e.c>255||s.e.r>16383){if(a.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=Tr(s)}for(var h=s.s.r;h<=s.e.r;++h){u=En(h);for(var m=s.s.c;m<=s.e.c;++m){h===s.s.r&&(f[m]=rn(m)),o=f[m]+u;var v=n?(e[h]||[])[m]:e[o];v&&AI(t,v,h,m)}}}function TI(t,e){for(var r=e||{},a=hi(),n=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(n=s);if(n==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return It(a,r.biff==4?1033:r.biff==3?521:9,xx(t,16,r)),CI(a,t.Sheets[t.SheetNames[n]],n,r),It(a,10),a.end()}function OI(t,e,r){It(t,49,N7({sz:12,name:"Arial"},r))}function RI(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&It(t,1054,T7(n,e[n],r))})}function DI(t,e){var r=lt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),It(t,2151,r),r=lt(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Q3(ra(e["!ref"]||"A1"),r),r.write_shift(4,4),It(t,2152,r)}function FI(t,e){for(var r=0;r<16;++r)It(t,224,Lw({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(a){It(t,224,Lw(a,0,e))})}function LI(t,e){for(var r=0;r<e["!links"].length;++r){var a=e["!links"][r];It(t,440,nR(a)),a[1].Tooltip&&It(t,2048,iR(a))}delete e["!links"]}function PI(t,e){if(e){var r=0;e.forEach(function(a,n){++r<=256&&a&&It(t,125,hR(x1(n,a),n))})}}function MI(t,e,r,a,n){var s=16+_u(n.cellXfs,e,n);if(e.v==null&&!e.bf){It(t,513,bf(r,a,s));return}if(e.bf)It(t,6,cP(e,r,a,n,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?Kn(qa(e.v)):e.v;It(t,515,z7(r,a,o,s));break;case"b":case"e":It(t,517,U7(r,a,e.v,s,n,e.t));break;case"s":case"str":if(n.bookSST){var u=jx(n.Strings,e.v,n.revStrings);It(t,253,j7(r,a,u,s))}else It(t,516,A7(r,a,(e.v||"").slice(0,255),s,n));break;default:It(t,513,bf(r,a,s))}}function II(t,e,r){var a=hi(),n=r.SheetNames[t],s=r.Sheets[n]||{},o=(r||{}).Workbook||{},u=(o.Sheets||[])[t]||{},f=Array.isArray(s),h=e.biff==8,m,v="",y=[],g=ra(s["!ref"]||"A1"),b=h?65536:16384;if(g.e.c>255||g.e.r>=b){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,b-1)}It(a,2057,xx(r,16,e)),It(a,13,co(1)),It(a,12,co(100)),It(a,15,Vs(!0)),It(a,17,Vs(!1)),It(a,16,yf(.001)),It(a,95,Vs(!0)),It(a,42,Vs(!1)),It(a,43,Vs(!1)),It(a,130,co(1)),It(a,128,B7()),It(a,131,Vs(!1)),It(a,132,Vs(!1)),h&&PI(a,s["!cols"]),It(a,512,R7(g,e)),h&&(s["!links"]=[]);for(var _=g.s.r;_<=g.e.r;++_){v=En(_);for(var S=g.s.c;S<=g.e.c;++S){_===g.s.r&&(y[S]=rn(S)),m=y[S]+v;var E=f?(s[_]||[])[S]:s[m];E&&(MI(a,E,_,S,e),h&&E.l&&s["!links"].push([m,E.l]))}}var C=u.CodeName||u.name||n;return h&&It(a,574,b7((o.Views||[])[0])),h&&(s["!merges"]||[]).length&&It(a,229,Z7(s["!merges"])),h&&LI(a,s),It(a,442,X3(C)),h&&DI(a,s),It(a,10),a.end()}function BI(t,e,r){var a=hi(),n=(t||{}).Workbook||{},s=n.Sheets||[],o=n.WBProps||{},u=r.biff==8,f=r.biff==5;if(It(a,2057,xx(t,5,r)),r.bookType=="xla"&&It(a,135),It(a,225,u?co(1200):null),It(a,193,UO(2)),f&&It(a,191),f&&It(a,192),It(a,226),It(a,92,l7("SheetJS",r)),It(a,66,co(u?1200:1252)),u&&It(a,353,co(0)),u&&It(a,448),It(a,317,pR(t.SheetNames.length)),u&&t.vbaraw&&It(a,211),u&&t.vbaraw){var h=o.CodeName||"ThisWorkbook";It(a,442,X3(h))}It(a,156,co(17)),It(a,25,Vs(!1)),It(a,18,Vs(!1)),It(a,19,co(0)),u&&It(a,431,Vs(!1)),u&&It(a,444,co(0)),It(a,61,y7()),It(a,64,Vs(!1)),It(a,141,co(0)),It(a,34,Vs(vM(t)=="true")),It(a,14,Vs(!0)),u&&It(a,439,Vs(!1)),It(a,218,co(0)),OI(a,t,r),RI(a,t.SSF,r),FI(a,r),u&&It(a,352,Vs(!1));var m=a.end(),v=hi();u&&It(v,140,lR()),u&&r.Strings&&kI(v,252,d7(r.Strings)),It(v,10);var y=v.end(),g=hi(),b=0,_=0;for(_=0;_<t.SheetNames.length;++_)b+=(u?12:11)+(u?2:1)*t.SheetNames[_].length;var S=m.length+b+y.length;for(_=0;_<t.SheetNames.length;++_){var E=s[_]||{};It(g,133,f7({pos:S,hs:E.Hidden||0,dt:0,name:t.SheetNames[_]},r)),S+=e[_].length}var C=g.end();if(b!=C.length)throw new Error("BS8 "+b+" != "+C.length);var j=[];return m.length&&j.push(m),C.length&&j.push(C),y.length&&j.push(y),is(j)}function UI(t,e){var r=e||{},a=[];t&&!t.SSF&&(t.SSF=za(xr)),t&&t.SSF&&(ud(),f1(t.SSF),r.revssf=d1(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Ox(r),r.cellXfs=[],_u(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var n=0;n<t.SheetNames.length;++n)a[a.length]=II(n,r,t);return a.unshift(BI(t,a,r)),is(a)}function zN(t,e){for(var r=0;r<=t.SheetNames.length;++r){var a=t.Sheets[t.SheetNames[r]];if(!(!a||!a["!ref"])){var n=di(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return UI(t,e);case 4:case 3:case 2:return TI(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Kw(t,e){var r=e||{},a=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var n=t.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),o=n.index,u=s&&s.index||t.length,f=N8(t.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,m=0,v=0,y=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(o=0;o<f.length;++o){var _=f[o].trim(),S=_.slice(0,3).toLowerCase();if(S=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}m=0;continue}if(!(S!="<td"&&S!="<th")){var E=_.split(/<\/t[dh]>/i);for(u=0;u<E.length;++u){var C=E[u].trim();if(C.match(/<t[dh]/i)){for(var j=C,R=0;j.charAt(0)=="<"&&(R=j.indexOf(">"))>-1;)j=j.slice(R+1);for(var H=0;H<b.length;++H){var Y=b[H];Y.s.c==m&&Y.s.r<h&&h<=Y.e.r&&(m=Y.e.c+1,H=-1)}var U=_r(C.slice(0,C.indexOf(">")));y=U.colspan?+U.colspan:1,((v=+U.rowspan)>1||y>1)&&b.push({s:{r:h,c:m},e:{r:h+(v||1)-1,c:m+y-1}});var V=U.t||U["data-t"]||"";if(!j.length){m+=y;continue}if(j=h3(j),g.s.r>h&&(g.s.r=h),g.e.r<h&&(g.e.r=h),g.s.c>m&&(g.s.c=m),g.e.c<m&&(g.e.c=m),!j.length){m+=y;continue}var F={t:"s",v:j};r.raw||!j.trim().length||V=="s"||(j==="TRUE"?F={t:"b",v:!0}:j==="FALSE"?F={t:"b",v:!1}:isNaN(Yo(j))?isNaN(rd(j).getDate())||(F={t:"d",v:qa(j)},r.cellDates||(F={t:"n",v:Kn(F.v)}),F.z=r.dateNF||xr[14]):F={t:"n",v:Yo(j)}),r.dense?(a[h]||(a[h]=[]),a[h][m]=F):a[yr({r:h,c:m})]=F,m+=y}}}}return a["!ref"]=Tr(g),b.length&&(a["!merges"]=b),a}function qI(t,e,r,a){for(var n=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var u=0,f=0,h=0;h<n.length;++h)if(!(n[h].s.r>r||n[h].s.c>o)&&!(n[h].e.r<r||n[h].e.c<o)){if(n[h].s.r<r||n[h].s.c<o){u=-1;break}u=n[h].e.r-n[h].s.r+1,f=n[h].e.c-n[h].s.c+1;break}if(!(u<0)){var m=yr({r,c:o}),v=a.dense?(t[r]||[])[o]:t[m],y=v&&v.v!=null&&(v.h||sx(v.w||(dc(v),v.w)||""))||"",g={};u>1&&(g.rowspan=u),f>1&&(g.colspan=f),a.editable?y='<span contenteditable="true">'+y+"</span>":v&&(g["data-t"]=v&&v.t||"z",v.v!=null&&(g["data-v"]=v.v),v.z!=null&&(g["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+v.l.Target+'">'+y+"</a>")),g.id=(a.id||"sjs")+"-"+m,s.push(Pt("td",y,g))}}var b="<tr>";return b+s.join("")+"</tr>"}var zI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HI="</body></html>";function $I(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return yu(Kw(r[0],e),e);var a=Fx();return r.forEach(function(n,s){Lx(a,Kw(n,e),"Sheet"+(s+1))}),a}function WI(t,e,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function HN(t,e){var r=e||{},a=r.header!=null?r.header:zI,n=r.footer!=null?r.footer:HI,s=[a],o=di(t["!ref"]);r.dense=Array.isArray(t),s.push(WI(t,o,r));for(var u=o.s.r;u<=o.e.r;++u)s.push(qI(t,o,u,r));return s.push("</table>"+n),s.join("")}function $N(t,e,r){var a=r||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var o=typeof a.origin=="string"?an(a.origin):a.origin;n=o.r,s=o.c}var u=e.getElementsByTagName("tr"),f=Math.min(a.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:n,c:s}};if(t["!ref"]){var m=di(t["!ref"]);h.s.r=Math.min(h.s.r,m.s.r),h.s.c=Math.min(h.s.c,m.s.c),h.e.r=Math.max(h.e.r,m.e.r),h.e.c=Math.max(h.e.c,m.e.c),n==-1&&(h.e.r=n=m.e.r+1)}var v=[],y=0,g=t["!rows"]||(t["!rows"]=[]),b=0,_=0,S=0,E=0,C=0,j=0;for(t["!cols"]||(t["!cols"]=[]);b<u.length&&_<f;++b){var R=u[b];if(Jw(R)){if(a.display)continue;g[_]={hidden:!0}}var H=R.children;for(S=E=0;S<H.length;++S){var Y=H[S];if(!(a.display&&Jw(Y))){var U=Y.hasAttribute("data-v")?Y.getAttribute("data-v"):Y.hasAttribute("v")?Y.getAttribute("v"):h3(Y.innerHTML),V=Y.getAttribute("data-z")||Y.getAttribute("z");for(y=0;y<v.length;++y){var F=v[y];F.s.c==E+s&&F.s.r<_+n&&_+n<=F.e.r&&(E=F.e.c+1-s,y=-1)}j=+Y.getAttribute("colspan")||1,((C=+Y.getAttribute("rowspan")||1)>1||j>1)&&v.push({s:{r:_+n,c:E+s},e:{r:_+n+(C||1)-1,c:E+s+(j||1)-1}});var X={t:"s",v:U},P=Y.getAttribute("data-t")||Y.getAttribute("t")||"";U!=null&&(U.length==0?X.t=P||"z":a.raw||U.trim().length==0||P=="s"||(U==="TRUE"?X={t:"b",v:!0}:U==="FALSE"?X={t:"b",v:!1}:isNaN(Yo(U))?isNaN(rd(U).getDate())||(X={t:"d",v:qa(U)},a.cellDates||(X={t:"n",v:Kn(X.v)}),X.z=a.dateNF||xr[14]):X={t:"n",v:Yo(U)})),X.z===void 0&&V!=null&&(X.z=V);var O="",I=Y.getElementsByTagName("A");if(I&&I.length)for(var W=0;W<I.length&&!(I[W].hasAttribute("href")&&(O=I[W].getAttribute("href"),O.charAt(0)!="#"));++W);O&&O.charAt(0)!="#"&&(X.l={Target:O}),a.dense?(t[_+n]||(t[_+n]=[]),t[_+n][E+s]=X):t[yr({c:E+s,r:_+n})]=X,h.e.c<E+s&&(h.e.c=E+s),E+=j}}++_}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),h.e.r=Math.max(h.e.r,_-1+n),t["!ref"]=Tr(h),_>=f&&(t["!fullref"]=Tr((h.e.r=u.length-b+_-1+n,h))),t}function WN(t,e){var r=e||{},a=r.dense?[]:{};return $N(a,t,e)}function VI(t,e){return yu(WN(t,e),e)}function Jw(t){var e="",r=GI(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function GI(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function YI(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ta(e.replace(/<[^>]*>/g,""));return[r]}var Zw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function VN(t,e){var r=e||{},a=ix(t),n=[],s,o,u={name:""},f="",h=0,m,v,y={},g=[],b=r.dense?[]:{},_,S,E={value:""},C="",j=0,R=[],H=-1,Y=-1,U={s:{r:1e6,c:1e7},e:{r:0,c:0}},V=0,F={},X=[],P={},O=0,I=0,W=[],ne=1,Q=1,le=[],ee={Names:[]},K={},ue=["",""],M=[],A={},D="",B=0,q=!1,Z=!1,oe=0;for(C0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=C0.exec(a);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"":_[1]==="/"?(U.e.c>=U.s.c&&U.e.r>=U.s.r?b["!ref"]=Tr(U):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=U.e.r&&(b["!fullref"]=b["!ref"],U.e.r=r.sheetRows-1,b["!ref"]=Tr(U)),X.length&&(b["!merges"]=X),W.length&&(b["!rows"]=W),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),g.push(m.name),y[m.name]=b,Z=!1):_[0].charAt(_[0].length-2)!=="/"&&(m=_r(_[0],!1),H=Y=-1,U.s.r=U.s.c=1e7,U.e.r=U.e.c=0,b=r.dense?[]:{},X=[],W=[],Z=!0);break;case"table-row-group":_[1]==="/"?--V:++V;break;case"table-row":case"":if(_[1]==="/"){H+=ne,ne=1;break}if(v=_r(_[0],!1),v.?H=v.-1:H==-1&&(H=0),ne=+v["number-rows-repeated"]||1,ne<10)for(oe=0;oe<ne;++oe)V>0&&(W[H+oe]={level:V});Y=-1;break;case"covered-table-cell":_[1]!=="/"&&++Y,r.sheetStubs&&(r.dense?(b[H]||(b[H]=[]),b[H][Y]={t:"z"}):b[yr({r:H,c:Y})]={t:"z"}),C="",R=[];break;case"table-cell":case"":if(_[0].charAt(_[0].length-2)==="/")++Y,E=_r(_[0],!1),Q=parseInt(E["number-columns-repeated"]||"1",10),S={t:"z",v:null},E.formula&&r.cellFormula!=!1&&(S.f=Gw(ta(E.formula))),(E.||E["value-type"])=="string"&&(S.t="s",S.v=ta(E["string-value"]||""),r.dense?(b[H]||(b[H]=[]),b[H][Y]=S):b[yr({r:H,c:Y})]=S),Y+=Q-1;else if(_[1]!=="/"){++Y,C="",j=0,R=[],Q=1;var pe=ne?H+ne-1:H;if(Y>U.e.c&&(U.e.c=Y),Y<U.s.c&&(U.s.c=Y),H<U.s.r&&(U.s.r=H),pe>U.e.r&&(U.e.r=pe),E=_r(_[0],!1),M=[],A={},S={t:E.||E["value-type"],v:null},r.cellFormula)if(E.formula&&(E.formula=ta(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(O=parseInt(E["number-matrix-rows-spanned"],10)||0,I=parseInt(E["number-matrix-columns-spanned"],10)||0,P={s:{r:H,c:Y},e:{r:H+O-1,c:Y+I-1}},S.F=Tr(P),le.push([P,S.F])),E.formula)S.f=Gw(E.formula);else for(oe=0;oe<le.length;++oe)H>=le[oe][0].s.r&&H<=le[oe][0].e.r&&Y>=le[oe][0].s.c&&Y<=le[oe][0].e.c&&(S.F=le[oe][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(O=parseInt(E["number-rows-spanned"],10)||0,I=parseInt(E["number-columns-spanned"],10)||0,P={s:{r:H,c:Y},e:{r:H+O-1,c:Y+I-1}},X.push(P)),E["number-columns-repeated"]&&(Q=parseInt(E["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=Ba(E["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(E.value);break;case"percentage":S.t="n",S.v=parseFloat(E.value);break;case"currency":S.t="n",S.v=parseFloat(E.value);break;case"date":S.t="d",S.v=qa(E["date-value"]),r.cellDates||(S.t="n",S.v=Kn(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=b8(E["time-value"])/86400,r.cellDates&&(S.t="d",S.v=m1(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(E.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",E["string-value"]!=null&&(C=ta(E["string-value"]),R=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(q=!1,S.t==="s"&&(S.v=C||"",R.length&&(S.R=R),q=j==0),K.Target&&(S.l=K),M.length>0&&(S.c=M,M=[]),C&&r.cellText!==!1&&(S.w=C),q&&(S.t="z",delete S.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=H))for(var _e=0;_e<ne;++_e){if(Q=parseInt(E["number-columns-repeated"]||"1",10),r.dense)for(b[H+_e]||(b[H+_e]=[]),b[H+_e][Y]=_e==0?S:za(S);--Q>0;)b[H+_e][Y+Q]=za(S);else for(b[yr({r:H+_e,c:Y})]=S;--Q>0;)b[yr({r:H+_e,c:Y+Q})]=za(S);U.e.c<=Y&&(U.e.c=Y)}Q=parseInt(E["number-columns-repeated"]||"1",10),Y+=Q-1,Q=0,S={},C="",R=[]}K={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((s=n.pop())[0]!==_[3])throw"Bad state: "+s}else _[0].charAt(_[0].length-2)!=="/"&&n.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((s=n.pop())[0]!==_[3])throw"Bad state: "+s;A.t=C,R.length&&(A.R=R),A.a=D,M.push(A)}else _[0].charAt(_[0].length-2)!=="/"&&n.push([_[3],!1]);D="",B=0,C="",j=0,R=[];break;case"creator":_[1]==="/"?D=a.slice(B,_.index):B=_.index+_[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((s=n.pop())[0]!==_[3])throw"Bad state: "+s}else _[0].charAt(_[0].length-2)!=="/"&&n.push([_[3],!1]);C="",j=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(F[u.name]=f,(s=n.pop())[0]!==_[3])throw"Bad state: "+s}else _[0].charAt(_[0].length-2)!=="/"&&(f="",u=_r(_[0],!1),n.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=_r(_[0],!1),f+=Zw[_[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=_r(_[0],!1),f+=Zw[_[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":f+=a.slice(h,_.index);break}else h=_.index+_[0].length;break;case"named-range":o=_r(_[0],!1),ue=iv(o["cell-range-address"]);var be={Name:o.name,Ref:ue[0]+"!"+ue[1]};Z&&(be.Sheet=g.length),ee.Names.push(be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(_[1]==="/"&&(!E||!E["string-value"])){var Le=YI(a.slice(j,_.index));C=(C.length>0?C+`
`:"")+Le[0]}else _r(_[0],!1),j=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{ue=iv(_r(_[0])["target-range-address"]),y[ue[0]]["!autofilter"]={ref:ue[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(K=_r(_[0],!1),!K.href)break;K.Target=ta(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(ue=iv(K.Target.slice(1)),K.Target="#"+ue[0]+"!"+ue[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(_)}}var he={Sheets:y,SheetNames:g,Workbook:ee};return r.bookSheets&&delete he.Sheets,he}function Qw(t,e){e=e||{},lo(t,"META-INF/manifest.xml")&&bO(Ln(t,"META-INF/manifest.xml"),e);var r=Mi(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=VN(ka(r),e);return lo(t,"meta.xml")&&(a.Props=P3(Ln(t,"meta.xml"))),a}function e5(t,e){return VN(t,e)}var XI=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+A0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return An+e}})(),t5=(function(){var t=function(s){return xa(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(s,o,u){var f=[];f.push('      <table:table table:name="'+xa(o.SheetNames[u])+`" table:style-name="ta1">
`);var h=0,m=0,v=di(s["!ref"]||"A1"),y=s["!merges"]||[],g=0,b=Array.isArray(s);if(s["!cols"])for(m=0;m<=v.e.c;++m)f.push("        <table:table-column"+(s["!cols"][m]?' table:style-name="co'+s["!cols"][m].ods+'"':"")+`></table:table-column>
`);var _="",S=s["!rows"]||[];for(h=0;h<v.s.r;++h)_=S[h]?' table:style-name="ro'+S[h].ods+'"':"",f.push("        <table:table-row"+_+`></table:table-row>
`);for(;h<=v.e.r;++h){for(_=S[h]?' table:style-name="ro'+S[h].ods+'"':"",f.push("        <table:table-row"+_+`>
`),m=0;m<v.s.c;++m)f.push(e);for(;m<=v.e.c;++m){var E=!1,C={},j="";for(g=0;g!=y.length;++g)if(!(y[g].s.c>m)&&!(y[g].s.r>h)&&!(y[g].e.c<m)&&!(y[g].e.r<h)){(y[g].s.c!=m||y[g].s.r!=h)&&(E=!0),C["table:number-columns-spanned"]=y[g].e.c-y[g].s.c+1,C["table:number-rows-spanned"]=y[g].e.r-y[g].s.r+1;break}if(E){f.push(r);continue}var R=yr({r:h,c:m}),H=b?(s[h]||[])[m]:s[R];if(H&&H.f&&(C["table:formula"]=xa(pP(H.f)),H.F&&H.F.slice(0,R.length)==R)){var Y=di(H.F);C["table:number-matrix-columns-spanned"]=Y.e.c-Y.s.c+1,C["table:number-matrix-rows-spanned"]=Y.e.r-Y.s.r+1}if(!H){f.push(e);continue}switch(H.t){case"b":j=H.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=H.v?"true":"false";break;case"n":j=H.w||String(H.v||0),C["office:value-type"]="float",C["office:value"]=H.v||0;break;case"s":case"str":j=H.v==null?"":H.v,C["office:value-type"]="string";break;case"d":j=H.w||qa(H.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=qa(H.v).toISOString(),C["table:style-name"]="ce1";break;default:f.push(e);continue}var U=t(j);if(H.l&&H.l.Target){var V=H.l.Target;V=V.charAt(0)=="#"?"#"+gP(V.slice(1)):V,V.charAt(0)!="#"&&!V.match(/^\w+:/)&&(V="../"+V),U=Pt("text:a",U,{"xlink:href":V.replace(/&/g,"&amp;")})}f.push("          "+Pt("table:table-cell",Pt("text:p",U,{}),C)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},n=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var m=0;m<h["!cols"].length;++m)if(h["!cols"][m]){var v=h["!cols"][m];if(v.width==null&&v.wpx==null&&v.wch==null)continue;du(v),v.ods=u;var y=h["!cols"][m].wpx+"px";s.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),s.push(`  </style:style>
`),++u}}});var f=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var m=0;m<h["!rows"].length;++m)if(h["!rows"][m]){h["!rows"][m].ods=f;var v=h["!rows"][m].hpx+"px";s.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),s.push(`  </style:style>
`),++f}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,u){var f=[An],h=A0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=A0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+h+m+`>
`),f.push(L3().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+h+`>
`),n(f,o),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var v=0;v!=o.SheetNames.length;++v)f.push(a(o.Sheets[o.SheetNames[v]],o,v));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function GN(t,e){if(e.bookType=="fods")return t5(t,e);var r=rx(),a="",n=[],s=[];return a="mimetype",Rr(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Rr(r,a,t5(t,e)),n.push([a,"text/xml"]),s.push([a,"ContentFile"]),a="styles.xml",Rr(r,a,XI(t,e)),n.push([a,"text/xml"]),s.push([a,"StylesFile"]),a="meta.xml",Rr(r,a,An+L3()),n.push([a,"text/xml"]),s.push([a,"MetadataFile"]),a="manifest.rdf",Rr(r,a,NO(s)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Rr(r,a,wO(n)),r}function wf(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function y2(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):ka(xu(t))}function KI(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Pi(kl(t))}function JI(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var a=0;a<e.length;++a)if(t[r+a]!=e[a])continue e;return!0}return!1}function pu(t){var e=t.reduce(function(n,s){return n+s.length},0),r=new Uint8Array(e),a=0;return t.forEach(function(n){r.set(n,a),a+=n.length}),r}function r5(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function ZI(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,a=t[e+14]&1,n=e+13;n>=e;--n)a=a*256+t[n];return(t[e+15]&128?-a:a)*Math.pow(10,r-6176)}function QI(t,e,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);t[e+15]|=a>>7,t[e+14]|=(a&127)<<1;for(var s=0;n>=1;++s,n/=256)t[e+s]=n&255;t[e+15]|=r>=0?0:128}function P0(t,e){var r=e?e[0]:0,a=t[r]&127;e:if(t[r++]>=128&&(a|=(t[r]&127)<<7,t[r++]<128||(a|=(t[r]&127)<<14,t[r++]<128)||(a|=(t[r]&127)<<21,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),a}function pa(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function pn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function ia(t){for(var e=[],r=[0];r[0]<t.length;){var a=r[0],n=P0(t,r),s=n&7;n=Math.floor(n/8);var o=0,u;if(n==0)break;switch(s){case 0:{for(var f=r[0];t[r[0]++]>=128;);u=t.slice(f,r[0])}break;case 5:o=4,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=P0(t,r),u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var h={data:u,type:s};e[n]==null?e[n]=[h]:e[n].push(h)}return e}function xs(t){var e=[];return t.forEach(function(r,a){r.forEach(function(n){n.data&&(e.push(pa(a*8+n.type)),n.type==2&&e.push(pa(n.data.length)),e.push(n.data))})}),pu(e)}function Cx(t,e){return t?.map(function(r){return e(r.data)})||[]}function io(t){for(var e,r=[],a=[0];a[0]<t.length;){var n=P0(t,a),s=ia(t.slice(a[0],a[0]+n));a[0]+=n;var o={id:pn(s[1][0].data),messages:[]};s[2].forEach(function(u){var f=ia(u.data),h=pn(f[3][0].data);o.messages.push({meta:f,data:t.slice(a[0],a[0]+h)}),a[0]+=h}),(e=s[3])!=null&&e[0]&&(o.merge=pn(s[3][0].data)>>>0>0),r.push(o)}return r}function Rh(t){var e=[];return t.forEach(function(r){var a=[];a[1]=[{data:pa(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:pa(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:pa(o.data.length)}],a[2].push({data:xs(o.meta),type:2})});var s=xs(a);e.push(pa(s.length)),e.push(s),n.forEach(function(o){return e.push(o)})}),pu(e)}function eB(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],a=P0(e,r),n=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=e[r[0]],u>1&&(o|=e[r[0]+1]<<8),u>2&&(o|=e[r[0]+2]<<16),u>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}n.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var f=0,h=0;if(s==1?(h=(e[r[0]]>>2&7)+4,f=(e[r[0]++]&224)<<3,f|=e[r[0]++]):(h=(e[r[0]++]>>2)+1,s==2?(f=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(f=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),n=[pu(n)],f==0)throw new Error("Invalid offset 0");if(f>n[0].length)throw new Error("Invalid offset beyond length");if(h>=f)for(n.push(n[0].slice(-f)),h-=f;h>=n[n.length-1].length;)n.push(n[n.length-1]),h-=n[n.length-1].length;n.push(n[0].slice(-f,-f+h))}}var m=pu(n);if(m.length!=a)throw new Error("Unexpected length: ".concat(m.length," != ").concat(a));return m}function oo(t){for(var e=[],r=0;r<t.length;){var a=t[r++],n=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(eB(a,t.slice(r,r+n))),r+=n}if(r!==t.length)throw new Error("data is not a valid framed stream!");return pu(e)}function Dh(t){for(var e=[],r=0;r<t.length;){var a=Math.min(t.length-r,268435455),n=new Uint8Array(4);e.push(n);var s=pa(a),o=s.length;e.push(s),a<=60?(o++,e.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,e.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,e.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,e.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,e.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),e.push(t.slice(r,r+a)),o+=a,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=a}return pu(e)}function tB(t,e,r,a){var n=wf(t),s=n.getUint32(4,!0),o=(a>1?12:8)+r5(s&(a>1?3470:398))*4,u=-1,f=-1,h=NaN,m=new Date(2001,0,1);s&512&&(u=n.getUint32(o,!0),o+=4),o+=r5(s&(a>1?12288:4096))*4,s&16&&(f=n.getUint32(o,!0),o+=4),s&32&&(h=n.getFloat64(o,!0),o+=8),s&64&&(m.setTime(m.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:e[f]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:h>0};break;case 7:v={t:"n",v:h/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:r[u]};else if(f>-1)v={t:"s",v:e[f]};else if(!isNaN(h))v={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function rB(t,e,r){var a=wf(t),n=a.getUint32(8,!0),s=12,o=-1,u=-1,f=NaN,h=NaN,m=new Date(2001,0,1);n&1&&(f=ZI(t,s),s+=16),n&2&&(h=a.getFloat64(s,!0),s+=8),n&4&&(m.setTime(m.getTime()+a.getFloat64(s,!0)*1e3),s+=8),n&8&&(u=a.getUint32(s,!0),s+=4),n&16&&(o=a.getUint32(s,!0),s+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:f};break;case 3:v={t:"s",v:e[u]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:h>0};break;case 7:v={t:"n",v:h/86400};break;case 8:v={t:"e",v:0};break;case 9:if(o>-1)v={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)))}return v}function lv(t,e){var r=new Uint8Array(32),a=wf(r),n=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,QI(r,n,t.v),s|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,t.v?1:0,!0),s|=2,n+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,a.setUint32(n,e.indexOf(t.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(8,s,!0),r.slice(0,n)}function cv(t,e){var r=new Uint8Array(32),a=wf(r),n=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,a.setFloat64(n,t.v,!0),s|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,t.v?1:0,!0),s|=32,n+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,a.setUint32(n,e.indexOf(t.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(4,s,!0),r.slice(0,n)}function aB(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return tB(t,e,r,t[0]);case 5:return rB(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Os(t){var e=ia(t);return P0(e[1][0].data)}function a5(t,e){var r=ia(e.data),a=pn(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(o){var u=ia(o.data),f=pn(u[1][0].data)>>>0;switch(a){case 1:s[f]=y2(u[3][0].data);break;case 8:{var h=t[Os(u[9][0].data)][0],m=ia(h.data),v=t[Os(m[1][0].data)][0],y=pn(v.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var g=ia(v.data);s[f]=g[3].map(function(b){return y2(b.data)}).join("")}break}}),s}function nB(t,e){var r,a,n,s,o,u,f,h,m,v,y,g,b,_,S=ia(t),E=pn(S[1][0].data)>>>0,C=pn(S[2][0].data)>>>0,j=((a=(r=S[8])==null?void 0:r[0])==null?void 0:a.data)&&pn(S[8][0].data)>0||!1,R,H;if((s=(n=S[7])==null?void 0:n[0])!=null&&s.data&&e!=0)R=(u=(o=S[7])==null?void 0:o[0])==null?void 0:u.data,H=(h=(f=S[6])==null?void 0:f[0])==null?void 0:h.data;else if((v=(m=S[4])==null?void 0:m[0])!=null&&v.data&&e!=1)R=(g=(y=S[4])==null?void 0:y[0])==null?void 0:g.data,H=(_=(b=S[3])==null?void 0:b[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var Y=j?4:1,U=wf(R),V=[],F=0;F<R.length/2;++F){var X=U.getUint16(F*2,!0);X<65535&&V.push([F,X])}if(V.length!=C)throw"Expected ".concat(C," cells, found ").concat(V.length);var P=[];for(F=0;F<V.length-1;++F)P[V[F][0]]=H.subarray(V[F][1]*Y,V[F+1][1]*Y);return V.length>=1&&(P[V[V.length-1][0]]=H.subarray(V[V.length-1][1]*Y)),{R:E,cells:P}}function sB(t,e){var r,a=ia(e.data),n=(r=a?.[7])!=null&&r[0]?pn(a[7][0].data)>>>0>0?1:0:-1,s=Cx(a[5],function(o){return nB(o,n)});return{nrows:pn(a[4][0].data)>>>0,data:s.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(f,h){if(o[u.R][h])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(h));o[u.R][h]=f}),o},[])}}function iB(t,e,r){var a,n=ia(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(pn(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(pn(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Tr(s);var o=ia(n[4][0].data),u=a5(t,t[Os(o[4][0].data)][0]),f=(a=o[17])!=null&&a[0]?a5(t,t[Os(o[17][0].data)][0]):[],h=ia(o[3][0].data),m=0;h[1].forEach(function(v){var y=ia(v.data),g=t[Os(y[2][0].data)][0],b=pn(g.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var _=sB(t,g);_.data.forEach(function(S,E){S.forEach(function(C,j){var R=yr({r:m+E,c:j}),H=aB(C,u,f);H&&(r[R]=H)})}),m+=_.nrows})}function oB(t,e){var r=ia(e.data),a={"!ref":"A1"},n=t[Os(r[2][0].data)],s=pn(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return iB(t,n[0],a),a}function lB(t,e){var r,a=ia(e.data),n={name:(r=a[1])!=null&&r[0]?y2(a[1][0].data):"",sheets:[]},s=Cx(a[2],Os);return s.forEach(function(o){t[o].forEach(function(u){var f=pn(u.meta[1][0].data);f==6e3&&n.sheets.push(oB(t,u))})}),n}function cB(t,e){var r=Fx(),a=ia(e.data),n=Cx(a[1],Os);if(n.forEach(function(s){t[s].forEach(function(o){var u=pn(o.meta[1][0].data);if(u==2){var f=lB(t,o);f.sheets.forEach(function(h,m){Lx(r,h,m==0?f.name:f.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function uv(t){var e,r,a,n,s={},o=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var h;try{h=oo(f.content)}catch(v){return console.log("?? "+f.content.length+" "+(v.message||v))}var m;try{m=io(h)}catch(v){return console.log("## "+(v.message||v))}m.forEach(function(v){s[v.id]=v.messages,o.push(v.id)})}}),!o.length)throw new Error("File has no messages");var u=((n=(a=(r=(e=s?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&pn(s[1][0].meta[1][0].data)==1&&s[1][0];if(u||o.forEach(function(f){s[f].forEach(function(h){var m=pn(h.meta[1][0].data)>>>0;if(m==1)if(!u)u=h;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return cB(s,u)}function uB(t,e,r){var a,n,s,o;if(!((a=t[6])!=null&&a[0])||!((n=t[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&pn(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,h=wf(t[7][0].data),m=0,v=[],y=wf(t[4][0].data),g=0,b=[],_=0;_<e.length;++_){if(e[_]==null){h.setUint16(_*2,65535,!0),y.setUint16(_*2,65535);continue}h.setUint16(_*2,m,!0),y.setUint16(_*2,g,!0);var S,E;switch(typeof e[_]){case"string":S=lv({t:"s",v:e[_]},r),E=cv({t:"s",v:e[_]},r);break;case"number":S=lv({t:"n",v:e[_]},r),E=cv({t:"n",v:e[_]},r);break;case"boolean":S=lv({t:"b",v:e[_]},r),E=cv({t:"b",v:e[_]},r);break;default:throw new Error("Unsupported value "+e[_])}v.push(S),m+=S.length,b.push(E),g+=E.length,++f}for(t[2][0].data=pa(f);_<t[7][0].data.length/2;++_)h.setUint16(_*2,65535,!0),y.setUint16(_*2,65535,!0);return t[6][0].data=pu(v),t[3][0].data=pu(b),f}function fB(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=di(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Tr(a)));var s=Jp(r,{range:a,header:1}),o=["~Sh33tJ5~"];s.forEach(function(D){return D.forEach(function(B){typeof B=="string"&&o.push(B)})});var u={},f=[],h=fr.read(e.numbers,{type:"base64"});h.FileIndex.map(function(D,B){return[D,h.FullPaths[B]]}).forEach(function(D){var B=D[0],q=D[1];if(B.type==2&&B.name.match(/\.iwa/)){var Z=B.content,oe=oo(Z),pe=io(oe);pe.forEach(function(_e){f.push(_e.id),u[_e.id]={deps:[],location:q,type:pn(_e.messages[0].meta[1][0].data)}})}}),f.sort(function(D,B){return D-B});var m=f.filter(function(D){return D>1}).map(function(D){return[D,pa(D)]});h.FileIndex.map(function(D,B){return[D,h.FullPaths[B]]}).forEach(function(D){var B=D[0];if(D[1],!!B.name.match(/\.iwa/)){var q=io(oo(B.content));q.forEach(function(Z){Z.messages.forEach(function(oe){m.forEach(function(pe){Z.messages.some(function(_e){return pn(_e.meta[1][0].data)!=11006&&JI(_e.data,pe[1])})&&u[pe[0]].deps.push(Z.id)})})})}});for(var v=fr.find(h,u[1].location),y=io(oo(v.content)),g,b=0;b<y.length;++b){var _=y[b];_.id==1&&(g=_)}var S=Os(ia(g.messages[0].data)[1][0].data);for(v=fr.find(h,u[S].location),y=io(oo(v.content)),b=0;b<y.length;++b)_=y[b],_.id==S&&(g=_);for(S=Os(ia(g.messages[0].data)[2][0].data),v=fr.find(h,u[S].location),y=io(oo(v.content)),b=0;b<y.length;++b)_=y[b],_.id==S&&(g=_);for(S=Os(ia(g.messages[0].data)[2][0].data),v=fr.find(h,u[S].location),y=io(oo(v.content)),b=0;b<y.length;++b)_=y[b],_.id==S&&(g=_);var E=ia(g.messages[0].data);{E[6][0].data=pa(a.e.r+1),E[7][0].data=pa(a.e.c+1);var C=Os(E[46][0].data),j=fr.find(h,u[C].location),R=io(oo(j.content));{for(var H=0;H<R.length&&R[H].id!=C;++H);if(R[H].id!=C)throw"Bad ColumnRowUIDMapArchive";var Y=ia(R[H].messages[0].data);Y[1]=[],Y[2]=[],Y[3]=[];for(var U=0;U<=a.e.c;++U){var V=[];V[1]=V[2]=[{type:0,data:pa(U+420690)}],Y[1].push({type:2,data:xs(V)}),Y[2].push({type:0,data:pa(U)}),Y[3].push({type:0,data:pa(U)})}Y[4]=[],Y[5]=[],Y[6]=[];for(var F=0;F<=a.e.r;++F)V=[],V[1]=V[2]=[{type:0,data:pa(F+726270)}],Y[4].push({type:2,data:xs(V)}),Y[5].push({type:0,data:pa(F)}),Y[6].push({type:0,data:pa(F)});R[H].messages[0].data=xs(Y)}j.content=Dh(Rh(R)),j.size=j.content.length,delete E[46];var X=ia(E[4][0].data);{X[7][0].data=pa(a.e.r+1);var P=ia(X[1][0].data),O=Os(P[2][0].data);j=fr.find(h,u[O].location),R=io(oo(j.content));{if(R[0].id!=O)throw"Bad HeaderStorageBucket";var I=ia(R[0].messages[0].data);for(F=0;F<s.length;++F){var W=ia(I[2][0].data);W[1][0].data=pa(F),W[4][0].data=pa(s[F].length),I[2][F]={type:I[2][0].type,data:xs(W)}}R[0].messages[0].data=xs(I)}j.content=Dh(Rh(R)),j.size=j.content.length;var ne=Os(X[2][0].data);j=fr.find(h,u[ne].location),R=io(oo(j.content));{if(R[0].id!=ne)throw"Bad HeaderStorageBucket";for(I=ia(R[0].messages[0].data),U=0;U<=a.e.c;++U)W=ia(I[2][0].data),W[1][0].data=pa(U),W[4][0].data=pa(a.e.r+1),I[2][U]={type:I[2][0].type,data:xs(W)};R[0].messages[0].data=xs(I)}j.content=Dh(Rh(R)),j.size=j.content.length;var Q=Os(X[4][0].data);(function(){for(var D=fr.find(h,u[Q].location),B=io(oo(D.content)),q,Z=0;Z<B.length;++Z){var oe=B[Z];oe.id==Q&&(q=oe)}var pe=ia(q.messages[0].data);{pe[3]=[];var _e=[];o.forEach(function(he,Ae){_e[1]=[{type:0,data:pa(Ae)}],_e[2]=[{type:0,data:pa(1)}],_e[3]=[{type:2,data:KI(he)}],pe[3].push({type:2,data:xs(_e)})})}q.messages[0].data=xs(pe);var be=Rh(B),Le=Dh(be);D.content=Le,D.size=D.content.length})();var le=ia(X[3][0].data);{var ee=le[1][0];delete le[2];var K=ia(ee.data);{var ue=Os(K[2][0].data);(function(){for(var D=fr.find(h,u[ue].location),B=io(oo(D.content)),q,Z=0;Z<B.length;++Z){var oe=B[Z];oe.id==ue&&(q=oe)}var pe=ia(q.messages[0].data);{delete pe[6],delete le[7];var _e=new Uint8Array(pe[5][0].data);pe[5]=[];for(var be=0,Le=0;Le<=a.e.r;++Le){var he=ia(_e);be+=uB(he,s[Le],o),he[1][0].data=pa(Le),pe[5].push({data:xs(he),type:2})}pe[1]=[{type:0,data:pa(a.e.c+1)}],pe[2]=[{type:0,data:pa(a.e.r+1)}],pe[3]=[{type:0,data:pa(be)}],pe[4]=[{type:0,data:pa(a.e.r+1)}]}q.messages[0].data=xs(pe);var Ae=Rh(B),de=Dh(Ae);D.content=de,D.size=D.content.length})()}ee.data=xs(K)}X[3][0].data=xs(le)}E[4][0].data=xs(X)}g.messages[0].data=xs(E);var M=Rh(y),A=Dh(M);return v.content=A,v.size=v.content.length,h}function YN(t){return function(r){for(var a=0;a!=t.length;++a){var n=t[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Tx(t){YN([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Ox(t){YN([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function hB(t){return Mr.WS.indexOf(t)>-1?"sheet":t==Mr.CS?"chart":t==Mr.DS?"dialog":t==Mr.MS?"macro":t&&t.length?t:"sheet"}function dB(t,e){if(!t)return 0;try{t=e.map(function(a){return a.id||(a.id=a.strRelID),[a.name,t["!id"][a.id].Target,hB(t["!id"][a.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function mB(t,e,r,a,n,s,o,u,f,h,m,v){try{s[a]=f0(Mi(t,r,!0),e);var y=Ln(t,e),g;switch(u){case"sheet":g=PM(y,e,n,f,s[a],h,m,v);break;case"chart":if(g=MM(y,e,n,f,s[a],h,m,v),!g||!g["!drawel"])break;var b=n0(g["!drawel"].Target,e),_=T0(b),S=SF(Mi(t,b,!0),f0(Mi(t,_,!0),b)),E=n0(S,b),C=T0(E);g=uM(Mi(t,E,!0),E,f,f0(Mi(t,C,!0),E),h,g);break;case"macro":g=IM(y,e,n,f,s[a],h,m,v);break;case"dialog":g=BM(y,e,n,f,s[a],h,m,v);break;default:throw new Error("Unrecognized sheet type "+u)}o[a]=g;var j=[];s&&s[a]&&gn(s[a]).forEach(function(R){var H="";if(s[a][R].Type==Mr.CMNT){H=n0(s[a][R].Target,e);var Y=HM(Ln(t,H,!0),H,f);if(!Y||!Y.length)return;zw(g,Y,!1)}s[a][R].Type==Mr.TCMNT&&(H=n0(s[a][R].Target,e),j=j.concat(kF(Ln(t,H,!0),f)))}),j&&j.length&&zw(g,j,!0,f.people||[])}catch(R){if(f.WTF)throw R}}function no(t){return t.charAt(0)=="/"?t.slice(1):t}function pB(t,e){if(ud(),e=e||{},Tx(e),lo(t,"META-INF/manifest.xml")||lo(t,"objectdata.xml"))return Qw(t,e);if(lo(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof uv<"u"){if(t.FileIndex)return uv(t);var r=fr.utils.cfb_new();return cw(t).forEach(function(W){Rr(r,W,j8(t,W))}),uv(r)}throw new Error("Unsupported NUMBERS file")}if(!lo(t,"[Content_Types].xml"))throw lo(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):lo(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=cw(t),n=yO(Mi(t,"[Content_Types].xml")),s=!1,o,u;if(n.workbooks.length===0&&(u="xl/workbook.xml",Ln(t,u,!0)&&n.workbooks.push(u)),n.workbooks.length===0){if(u="xl/workbook.bin",!Ln(t,u,!0))throw new Error("Could not find workbook");n.workbooks.push(u),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var f={},h={};if(!e.bookSheets&&!e.bookProps){if(h0=[],n.sst)try{h0=zM(Ln(t,no(n.sst)),n.sst,e)}catch(W){if(e.WTF)throw W}e.cellStyles&&n.themes.length&&(f=qM(Mi(t,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],e)),n.style&&(h=UM(Ln(t,no(n.style)),n.style,f,e))}n.links.map(function(W){try{var ne=f0(Mi(t,T0(no(W))),W);return WM(Ln(t,no(W)),ne,W,e)}catch{}});var m=LM(Ln(t,no(n.workbooks[0])),n.workbooks[0],e),v={},y="";n.coreprops.length&&(y=Ln(t,no(n.coreprops[0]),!0),y&&(v=P3(y)),n.extprops.length!==0&&(y=Ln(t,no(n.extprops[0]),!0),y&&jO(y,v,e)));var g={};(!e.bookSheets||e.bookProps)&&n.custprops.length!==0&&(y=Mi(t,no(n.custprops[0]),!0),y&&(g=AO(y,e)));var b={};if((e.bookSheets||e.bookProps)&&(m.Sheets?o=m.Sheets.map(function(ne){return ne.name}):v.Worksheets&&v.SheetNames.length>0&&(o=v.SheetNames),e.bookProps&&(b.Props=v,b.Custprops=g),e.bookSheets&&typeof o<"u"&&(b.SheetNames=o),e.bookSheets?b.SheetNames:e.bookProps))return b;o={};var _={};e.bookDeps&&n.calcchain&&(_=$M(Ln(t,no(n.calcchain)),n.calcchain));var S=0,E={},C,j;{var R=m.Sheets;v.Worksheets=R.length,v.SheetNames=[];for(var H=0;H!=R.length;++H)v.SheetNames[H]=R[H].name}var Y=s?"bin":"xml",U=n.workbooks[0].lastIndexOf("/"),V=(n.workbooks[0].slice(0,U+1)+"_rels/"+n.workbooks[0].slice(U+1)+".rels").replace(/^\//,"");lo(t,V)||(V="xl/_rels/workbook."+Y+".rels");var F=f0(Mi(t,V,!0),V.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(e.xlmeta=VM(Ln(t,no(n.metadata[0])),n.metadata[0],e)),(n.people||[]).length>=1&&(e.people=EF(Ln(t,no(n.people[0])),e)),F&&(F=dB(F,m.Sheets));var X=Ln(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=v.Worksheets;++S){var P="sheet";if(F&&F[S]?(C="xl/"+F[S][1].replace(/[\/]?xl\//,""),lo(t,C)||(C=F[S][1]),lo(t,C)||(C=V.replace(/_rels\/.*$/,"")+F[S][1]),P=F[S][2]):(C="xl/worksheets/sheet"+(S+1-X)+"."+Y,C=C.replace(/sheet0\./,"sheet.")),j=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(v.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var O=!1,I=0;I!=e.sheets.length;++I)typeof e.sheets[I]=="number"&&e.sheets[I]==S&&(O=1),typeof e.sheets[I]=="string"&&e.sheets[I].toLowerCase()==v.SheetNames[S].toLowerCase()&&(O=1);if(!O)continue e}}mB(t,C,j,v.SheetNames[S],S,E,o,P,e,m,f,h)}return b={Directory:n,Workbook:m,Props:v,Custprops:g,Deps:_,Sheets:o,SheetNames:v.SheetNames,Strings:h0,Styles:h,Themes:f,SSF:za(xr)},e&&e.bookFiles&&(t.files?(b.keys=a,b.files=t.files):(b.keys=[],b.files={},t.FullPaths.forEach(function(W,ne){W=W.replace(/^Root Entry[\/]/,""),b.keys.push(W),b.files[W]=t.FileIndex[ne]}))),e&&e.bookVBA&&(n.vba.length>0?b.vbaraw=Ln(t,no(n.vba[0]),!0):n.defaults&&n.defaults.bin===LF&&(b.vbaraw=Ln(t,"xl/vbaProject.bin",!0))),b}function gB(t,e){var r=e||{},a="Workbook",n=fr.find(t,a);try{if(a="/!DataSpaces/Version",n=fr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(VR(n.content),a="/!DataSpaces/DataSpaceMap",n=fr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=YR(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=fr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=XR(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=fr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);JR(n.content)}catch{}if(a="/EncryptionInfo",n=fr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var u=ZR(n.content);if(a="/EncryptedPackage",n=fr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],n.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function vB(t,e){return e.bookType=="ods"?GN(t,e):e.bookType=="numbers"?fB(t,e):e.bookType=="xlsb"?xB(t,e):yB(t,e)}function xB(t,e){zh=1024,t&&!t.SSF&&(t.SSF=za(xr)),t&&t.SSF&&(ud(),f1(t.SSF),e.revssf=d1(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,d0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",a=bN.indexOf(e.bookType)>-1,n=gx();Ox(e=e||{});var s=rx(),o="",u=0;if(e.cellXfs=[],_u(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Rr(s,o,M3(t.Props,e)),n.coreprops.push(o),ga(e.rels,2,o,Mr.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(t.SheetNames[h]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,Rr(s,o,U3(t.Props)),n.extprops.push(o),ga(e.rels,3,o,Mr.EXT_PROPS),t.Custprops!==t.Props&&gn(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Rr(s,o,q3(t.Custprops)),n.custprops.push(o),ga(e.rels,4,o,Mr.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var m={"!id":{}},v=t.Sheets[t.SheetNames[u-1]],y=(v||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,Rr(s,o,YM(u-1,o,e,t,m)),n.sheets.push(o),ga(e.wbrels,-1,"worksheets/sheet"+u+"."+r,Mr.WS[0])}if(v){var g=v["!comments"],b=!1,_="";g&&g.length>0&&(_="xl/comments"+u+"."+r,Rr(s,_,JM(g,_)),n.comments.push(_),ga(m,-1,"../comments"+u+"."+r,Mr.CMNT),b=!0),v["!legacy"]&&b&&Rr(s,"xl/drawings/vmlDrawing"+u+".vml",yN(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}m["!id"].rId1&&Rr(s,T0(o),Gh(m))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Rr(s,o,KM(e.Strings,o,e)),n.strs.push(o),ga(e.wbrels,-1,"sharedStrings."+r,Mr.SST)),o="xl/workbook."+r,Rr(s,o,GM(t,o)),n.workbooks.push(o),ga(e.rels,1,o,Mr.WB),o="xl/theme/theme1.xml",Rr(s,o,wx(t.Themes,e)),n.themes.push(o),ga(e.wbrels,-1,"theme/theme1.xml",Mr.THEME),o="xl/styles."+r,Rr(s,o,XM(t,o,e)),n.styles.push(o),ga(e.wbrels,-1,"styles."+r,Mr.STY),t.vbaraw&&a&&(o="xl/vbaProject.bin",Rr(s,o,t.vbaraw),n.vba.push(o),ga(e.wbrels,-1,"vbaProject.bin",Mr.VBA)),o="xl/metadata."+r,Rr(s,o,ZM(o)),n.metadata.push(o),ga(e.wbrels,-1,"metadata."+r,Mr.XLMETA),Rr(s,"[Content_Types].xml",F3(n,e)),Rr(s,"_rels/.rels",Gh(e.rels)),Rr(s,"xl/_rels/workbook."+r+".rels",Gh(e.wbrels)),delete e.revssf,delete e.ssf,s}function yB(t,e){zh=1024,t&&!t.SSF&&(t.SSF=za(xr)),t&&t.SSF&&(ud(),f1(t.SSF),e.revssf=d1(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,d0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",a=bN.indexOf(e.bookType)>-1,n=gx();Ox(e=e||{});var s=rx(),o="",u=0;if(e.cellXfs=[],_u(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Rr(s,o,M3(t.Props,e)),n.coreprops.push(o),ga(e.rels,2,o,Mr.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(t.SheetNames[h]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,Rr(s,o,U3(t.Props)),n.extprops.push(o),ga(e.rels,3,o,Mr.EXT_PROPS),t.Custprops!==t.Props&&gn(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Rr(s,o,q3(t.Custprops)),n.custprops.push(o),ga(e.rels,4,o,Mr.CUST_PROPS));var m=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var v={"!id":{}},y=t.Sheets[t.SheetNames[u-1]],g=(y||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,Rr(s,o,RN(u-1,e,t,v)),n.sheets.push(o),ga(e.wbrels,-1,"worksheets/sheet"+u+"."+r,Mr.WS[0])}if(y){var b=y["!comments"],_=!1,S="";if(b&&b.length>0){var E=!1;b.forEach(function(C){C[1].forEach(function(j){j.T==!0&&(E=!0)})}),E&&(S="xl/threadedComments/threadedComment"+u+"."+r,Rr(s,S,jF(b,m,e)),n.threadedcomments.push(S),ga(v,-1,"../threadedComments/threadedComment"+u+"."+r,Mr.TCMNT)),S="xl/comments"+u+"."+r,Rr(s,S,_N(b)),n.comments.push(S),ga(v,-1,"../comments"+u+"."+r,Mr.CMNT),_=!0}y["!legacy"]&&_&&Rr(s,"xl/drawings/vmlDrawing"+u+".vml",yN(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}v["!id"].rId1&&Rr(s,T0(o),Gh(v))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Rr(s,o,oN(e.Strings,e)),n.strs.push(o),ga(e.wbrels,-1,"sharedStrings."+r,Mr.SST)),o="xl/workbook."+r,Rr(s,o,MN(t)),n.workbooks.push(o),ga(e.rels,1,o,Mr.WB),o="xl/theme/theme1.xml",Rr(s,o,wx(t.Themes,e)),n.themes.push(o),ga(e.wbrels,-1,"theme/theme1.xml",Mr.THEME),o="xl/styles."+r,Rr(s,o,pN(t,e)),n.styles.push(o),ga(e.wbrels,-1,"styles."+r,Mr.STY),t.vbaraw&&a&&(o="xl/vbaProject.bin",Rr(s,o,t.vbaraw),n.vba.push(o),ga(e.wbrels,-1,"vbaProject.bin",Mr.VBA)),o="xl/metadata."+r,Rr(s,o,xN()),n.metadata.push(o),ga(e.wbrels,-1,"metadata."+r,Mr.XLMETA),m.length>1&&(o="xl/persons/person.xml",Rr(s,o,AF(m)),n.people.push(o),ga(e.wbrels,-1,"persons/person.xml",Mr.PEOPLE)),Rr(s,"[Content_Types].xml",F3(n,e)),Rr(s,"_rels/.rels",Gh(e.rels)),Rr(s,"xl/_rels/workbook."+r+".rels",Gh(e.wbrels)),delete e.revssf,delete e.ssf,s}function Rx(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=qi(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function _B(t,e){return fr.find(t,"EncryptedPackage")?gB(t,e):qN(t,e)}function bB(t,e){var r,a=t,n=e||{};return n.type||(n.type=Lr&&Buffer.isBuffer(t)?"buffer":"base64"),r=c3(a,n),pB(r,n)}function XN(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return v2(t.slice(r),e);default:break e}return ad.to_workbook(t,e)}function wB(t,e){var r="",a=Rx(t,e);switch(e.type){case"base64":r=qi(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=xf(t);break;default:throw new Error("Unrecognized type "+e.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=ka(r)),e.type="binary",XN(r,e)}function SB(t,e){var r=t;return e.type=="base64"&&(r=qi(r)),r=N0.utils.decode(1200,r.slice(2),"str"),e.type="binary",XN(r,e)}function NB(t){return t.match(/[^\x00-\x7F]/)?kl(t):t}function fv(t,e,r,a){return a?(r.type="string",ad.to_workbook(t,r)):ad.to_workbook(e,r)}function _2(t,e){J2();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return _2(new Uint8Array(t),(r=za(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=t,n=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Xh={},r.dateNF&&(Xh.dateNF=r.dateNF),r.type||(r.type=Lr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Lr?"buffer":"binary",a=x8(t),typeof Uint8Array<"u"&&!Lr&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,a=NB(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=za(r),r.type="array",_2(Z2(a),r)}switch((n=Rx(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return _B(fr.read(a,r),r);break;case 9:if(n[1]<=8)return qN(a,r);break;case 60:return v2(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return CR(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return sN.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?bB(a,r):fv(t,a,r,s);case 239:return n[3]===60?v2(a,r):fv(t,a,r,s);case 255:if(n[1]===254)return SB(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return mf.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return mf.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return g2.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return hN.to_workbook(a,r);break;case 10:case 13:case 32:return wB(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return AR.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?g2.to_workbook(a,r):fv(t,a,r,s)}function KN(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return H0(e.file,fr.write(t,{type:Lr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return fr.write(t,e)}function kB(t,e){var r=za(e||{}),a=vB(t,r);return jB(a,r)}function jB(t,e){var r={},a=Lr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=a;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+e.type)}var n=t.FullPaths?fr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(e.type=="binary"||e.type=="base64")return n;n=new Uint8Array(u1(n))}return e.password&&typeof encrypt_agile<"u"?KN(encrypt_agile(n,e.password),e):e.type==="file"?H0(e.file,n):e.type=="string"?ka(n):n}function EB(t,e){var r=e||{},a=NI(t,r);return KN(a,r)}function bl(t,e,r){r||(r="");var a=r+t;switch(e.type){case"base64":return k0(kl(a));case"binary":return kl(a);case"string":return t;case"file":return H0(e.file,a,"utf8");case"buffer":return Lr?gc(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):bl(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function AB(t,e){switch(e.type){case"base64":return k0(t);case"binary":return t;case"string":return t;case"file":return H0(e.file,t,"binary");case"buffer":return Lr?gc(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function hp(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",a=0;a<t.length;++a)r+=String.fromCharCode(t[a]);return e.type=="base64"?k0(r):e.type=="string"?ka(r):r;case"file":return H0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function JN(t,e){J2(),_M(t);var r=za(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=JN(t,r);return r.type="array",u1(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=t.SheetNames.indexOf(r.sheet),!t.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return bl(vI(t,r),r);case"slk":case"sylk":return bl(nN.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"htm":case"html":return bl(HN(t.Sheets[t.SheetNames[n]],r),r);case"txt":return AB(ZN(t.Sheets[t.SheetNames[n]],r),r);case"csv":return bl(Dx(t.Sheets[t.SheetNames[n]],r),r,"\uFEFF");case"dif":return bl(sN.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"dbf":return hp(g2.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"prn":return bl(ad.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"rtf":return bl(hN.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"eth":return bl(iN.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"fods":return bl(GN(t,r),r);case"wk1":return hp(mf.sheet_to_wk1(t.Sheets[t.SheetNames[n]],r),r);case"wk3":return hp(mf.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),hp(zN(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),EB(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return kB(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function CB(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function TB(t,e,r){var a={};return a.type="file",a.file=e,CB(a),JN(t,a)}function OB(t,e,r,a,n,s,o,u){var f=En(r),h=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,y=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:r,enumerable:!1})}catch{y.__rowNum__=r}else y.__rowNum__=r;if(!o||t[r])for(var g=e.s.c;g<=e.e.c;++g){var b=o?t[r][g]:t[a[g]+f];if(b===void 0||b.t===void 0){if(h===void 0)continue;s[g]!=null&&(y[s[g]]=h);continue}var _=b.v;switch(b.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(s[g]!=null){if(_==null)if(b.t=="e"&&_===null)y[s[g]]=null;else if(h!==void 0)y[s[g]]=h;else if(m&&_===null)y[s[g]]=null;else continue;else y[s[g]]=m&&(b.t!=="n"||b.t==="n"&&u.rawNumbers!==!1)?_:dc(b,_,u);_!=null&&(v=!1)}}return{row:y,isempty:v}}function Jp(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,s=[],o=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},m=h.range!=null?h.range:t["!ref"];switch(h.header===1?a=1:h.header==="A"?a=2:Array.isArray(h.header)?a=3:h.header==null&&(a=0),typeof m){case"string":f=ra(m);break;case"number":f=ra(t["!ref"]),f.s.r=m;break;default:f=m}a>0&&(n=0);var v=En(f.s.r),y=[],g=[],b=0,_=0,S=Array.isArray(t),E=f.s.r,C=0,j={};S&&!t[E]&&(t[E]=[]);var R=h.skipHidden&&t["!cols"]||[],H=h.skipHidden&&t["!rows"]||[];for(C=f.s.c;C<=f.e.c;++C)if(!(R[C]||{}).hidden)switch(y[C]=rn(C),r=S?t[E][C]:t[y[C]+v],a){case 1:s[C]=C-f.s.c;break;case 2:s[C]=y[C];break;case 3:s[C]=h.header[C-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=dc(r,null,h),_=j[o]||0,!_)j[o]=1;else{do u=o+"_"+_++;while(j[u]);j[o]=_,j[u]=1}s[C]=u}for(E=f.s.r+n;E<=f.e.r;++E)if(!(H[E]||{}).hidden){var Y=OB(t,f,E,y,a,s,S,h);(Y.isempty===!1||(a===1?h.blankrows!==!1:h.blankrows))&&(g[b++]=Y.row)}return g.length=b,g}var n5=/"/g;function RB(t,e,r,a,n,s,o,u){for(var f=!0,h=[],m="",v=En(r),y=e.s.c;y<=e.e.c;++y)if(a[y]){var g=u.dense?(t[r]||[])[y]:t[a[y]+v];if(g==null)m="";else if(g.v!=null){f=!1,m=""+(u.rawNumbers&&g.t=="n"?g.v:dc(g,null,u));for(var b=0,_=0;b!==m.length;++b)if((_=m.charCodeAt(b))===n||_===s||_===34||u.forceQuotes){m='"'+m.replace(n5,'""')+'"';break}m=="ID"&&(m='"ID"')}else g.f!=null&&!g.F?(f=!1,m="="+g.f,m.indexOf(",")>=0&&(m='"'+m.replace(n5,'""')+'"')):m="";h.push(m)}return u.blankrows===!1&&f?null:h.join(o)}function Dx(t,e){var r=[],a=e??{};if(t==null||t["!ref"]==null)return"";var n=ra(t["!ref"]),s=a.FS!==void 0?a.FS:",",o=s.charCodeAt(0),u=a.RS!==void 0?a.RS:`
`,f=u.charCodeAt(0),h=new RegExp((s=="|"?"\\|":s)+"+$"),m="",v=[];a.dense=Array.isArray(t);for(var y=a.skipHidden&&t["!cols"]||[],g=a.skipHidden&&t["!rows"]||[],b=n.s.c;b<=n.e.c;++b)(y[b]||{}).hidden||(v[b]=rn(b));for(var _=0,S=n.s.r;S<=n.e.r;++S)(g[S]||{}).hidden||(m=RB(t,n,S,v,o,f,s,a),m!=null&&(a.strip&&(m=m.replace(h,"")),(m||a.blankrows!==!1)&&r.push((_++?u:"")+m)));return delete a.dense,r.join("")}function ZN(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Dx(t,e);return r}function DB(t){var e="",r,a="";if(t==null||t["!ref"]==null)return[];var n=ra(t["!ref"]),s="",o=[],u,f=[],h=Array.isArray(t);for(u=n.s.c;u<=n.e.c;++u)o[u]=rn(u);for(var m=n.s.r;m<=n.e.r;++m)for(s=En(m),u=n.s.c;u<=n.e.c;++u)if(e=o[u]+s,r=h?(t[m]||[])[u]:t[e],a="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;a=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}f[f.length]=e+"="+a}return f}function QN(t,e,r){var a=r||{},n=+!a.skipHeader,s=t||{},o=0,u=0;if(s&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var f=typeof a.origin=="string"?an(a.origin):a.origin;o=f.r,u=f.c}var h,m={s:{c:0,r:0},e:{c:u,r:o+e.length-1+n}};if(s["!ref"]){var v=ra(s["!ref"]);m.e.c=Math.max(m.e.c,v.e.c),m.e.r=Math.max(m.e.r,v.e.r),o==-1&&(o=v.e.r+1,m.e.r=o+e.length-1+n)}else o==-1&&(o=0,m.e.r=e.length-1+n);var y=a.header||[],g=0;e.forEach(function(_,S){gn(_).forEach(function(E){(g=y.indexOf(E))==-1&&(y[g=y.length]=E);var C=_[E],j="z",R="",H=yr({c:u+g,r:o+S+n});h=M0(s,H),C&&typeof C=="object"&&!(C instanceof Date)?s[H]=C:(typeof C=="number"?j="n":typeof C=="boolean"?j="b":typeof C=="string"?j="s":C instanceof Date?(j="d",a.cellDates||(j="n",C=Kn(C)),R=a.dateNF||xr[14]):C===null&&a.nullError&&(j="e",C=0),h?(h.t=j,h.v=C,delete h.w,delete h.R,R&&(h.z=R)):s[H]=h={t:j,v:C},R&&(h.z=R))})}),m.e.c=Math.max(m.e.c,u+y.length-1);var b=En(o);if(n)for(g=0;g<y.length;++g)s[rn(g+u)+b]={t:"s",v:y[g]};return s["!ref"]=Tr(m),s}function FB(t,e){return QN(null,t,e)}function M0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var a=an(e);return t[a.r]||(t[a.r]=[]),t[a.r][a.c]||(t[a.r][a.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?M0(t,yr(e)):M0(t,yr({r:e,c:r||0}))}function LB(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Fx(){return{SheetNames:[],Sheets:{}}}function Lx(t,e,r,a){var n=1;if(!r)for(;n<=65535&&t.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var o=s&&s[1]||r;for(++n;n<=65535&&t.SheetNames.indexOf(r=o+n)!=-1;++n);}if(PN(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function PB(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var a=LB(t,e);switch(t.Workbook.Sheets[a]||(t.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[a].Hidden=r}function MB(t,e){return t.z=e,t}function ek(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function IB(t,e,r){return ek(t,"#"+e,r)}function BB(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function UB(t,e,r,a){for(var n=typeof e!="string"?e:ra(e),s=typeof e=="string"?e:Tr(e),o=n.s.r;o<=n.e.r;++o)for(var u=n.s.c;u<=n.e.c;++u){var f=M0(t,o,u);f.t="n",f.F=s,delete f.v,o==n.s.r&&u==n.s.c&&(f.f=r,a&&(f.D=!0))}return t}var au={encode_col:rn,encode_row:En,encode_cell:yr,encode_range:Tr,decode_col:ux,decode_row:cx,split_cell:K8,decode_cell:an,decode_range:di,format_cell:dc,sheet_add_aoa:E3,sheet_add_json:QN,sheet_add_dom:$N,aoa_to_sheet:fd,json_to_sheet:FB,table_to_sheet:WN,table_to_book:VI,sheet_to_csv:Dx,sheet_to_txt:ZN,sheet_to_json:Jp,sheet_to_html:HN,sheet_to_formulae:DB,sheet_to_row_object_array:Jp,sheet_get_cell:M0,book_new:Fx,book_append_sheet:Lx,book_set_sheet_visibility:PB,cell_set_number_format:MB,cell_set_hyperlink:ek,cell_set_internal_link:IB,cell_add_comment:BB,sheet_set_array_formula:UB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const qB="modulepreload",zB=function(t){return"/"+t},s5={},hv=function(e,r,a){let n=Promise.resolve();if(r&&r.length>0){let f=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=o?.nonce||o?.getAttribute("nonce");n=f(r.map(h=>{if(h=zB(h),h in s5)return;s5[h]=!0;const m=h.endsWith(".css"),v=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${v}`))return;const y=document.createElement("link");if(y.rel=m?"stylesheet":qB,m||(y.as="script"),y.crossOrigin="",y.href=h,u&&y.setAttribute("nonce",u),document.head.appendChild(y),m)return new Promise((g,b)=>{y.addEventListener("load",g),y.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return n.then(o=>{for(const u of o||[])u.status==="rejected"&&s(u.reason);return e().catch(s)})};function va(t){"@babel/helpers - typeof";return va=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},va(t)}var Ko=Uint8Array,Bi=Uint16Array,Px=Int32Array,Mx=new Ko([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ix=new Ko([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),i5=new Ko([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),tk=function(t,e){for(var r=new Bi(31),a=0;a<31;++a)r[a]=e+=1<<t[a-1];for(var n=new Px(r[30]),a=1;a<30;++a)for(var s=r[a];s<r[a+1];++s)n[s]=s-r[a]<<5|a;return{b:r,r:n}},rk=tk(Mx,2),HB=rk.b,b2=rk.r;HB[28]=258,b2[258]=28;var $B=tk(Ix,0),o5=$B.r,w2=new Bi(32768);for(var Ua=0;Ua<32768;++Ua){var tu=(Ua&43690)>>1|(Ua&21845)<<1;tu=(tu&52428)>>2|(tu&13107)<<2,tu=(tu&61680)>>4|(tu&3855)<<4,w2[Ua]=((tu&65280)>>8|(tu&255)<<8)>>1}var g0=(function(t,e,r){for(var a=t.length,n=0,s=new Bi(e);n<a;++n)t[n]&&++s[t[n]-1];var o=new Bi(e);for(n=1;n<e;++n)o[n]=o[n-1]+s[n-1]<<1;var u;if(r){u=new Bi(1<<e);var f=15-e;for(n=0;n<a;++n)if(t[n])for(var h=n<<4|t[n],m=e-t[n],v=o[t[n]-1]++<<m,y=v|(1<<m)-1;v<=y;++v)u[w2[v]>>f]=h}else for(u=new Bi(a),n=0;n<a;++n)t[n]&&(u[n]=w2[o[t[n]-1]++]>>15-t[n]);return u}),Sf=new Ko(288);for(var Ua=0;Ua<144;++Ua)Sf[Ua]=8;for(var Ua=144;Ua<256;++Ua)Sf[Ua]=9;for(var Ua=256;Ua<280;++Ua)Sf[Ua]=7;for(var Ua=280;Ua<288;++Ua)Sf[Ua]=8;var Zp=new Ko(32);for(var Ua=0;Ua<32;++Ua)Zp[Ua]=5;var WB=g0(Sf,9,0),VB=g0(Zp,5,0),ak=function(t){return(t+7)/8|0},GB=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Ko(t.subarray(e,r))},rc=function(t,e,r){r<<=e&7;var a=e/8|0;t[a]|=r,t[a+1]|=r>>8},Qd=function(t,e,r){r<<=e&7;var a=e/8|0;t[a]|=r,t[a+1]|=r>>8,t[a+2]|=r>>16},dv=function(t,e){for(var r=[],a=0;a<t.length;++a)t[a]&&r.push({s:a,f:t[a]});var n=r.length,s=r.slice();if(!n)return{t:sk,l:0};if(n==1){var o=new Ko(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(H,Y){return H.f-Y.f}),r.push({s:-1,f:25001});var u=r[0],f=r[1],h=0,m=1,v=2;for(r[0]={s:-1,f:u.f+f.f,l:u,r:f};m!=n-1;)u=r[r[h].f<r[v].f?h++:v++],f=r[h!=m&&r[h].f<r[v].f?h++:v++],r[m++]={s:-1,f:u.f+f.f,l:u,r:f};for(var y=s[0].s,a=1;a<n;++a)s[a].s>y&&(y=s[a].s);var g=new Bi(y+1),b=S2(r[m-1],g,0);if(b>e){var a=0,_=0,S=b-e,E=1<<S;for(s.sort(function(Y,U){return g[U.s]-g[Y.s]||Y.f-U.f});a<n;++a){var C=s[a].s;if(g[C]>e)_+=E-(1<<b-g[C]),g[C]=e;else break}for(_>>=S;_>0;){var j=s[a].s;g[j]<e?_-=1<<e-g[j]++-1:++a}for(;a>=0&&_;--a){var R=s[a].s;g[R]==e&&(--g[R],++_)}b=e}return{t:new Ko(g),l:b}},S2=function(t,e,r){return t.s==-1?Math.max(S2(t.l,e,r+1),S2(t.r,e,r+1)):e[t.s]=r},l5=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Bi(++e),a=0,n=t[0],s=1,o=function(f){r[a++]=f},u=1;u<=e;++u)if(t[u]==n&&u!=e)++s;else{if(!n&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(n),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(n);s=1,n=t[u]}return{c:r.subarray(0,a),n:e}},e0=function(t,e){for(var r=0,a=0;a<e.length;++a)r+=t[a]*e[a];return r},nk=function(t,e,r){var a=r.length,n=ak(e+2);t[n]=a&255,t[n+1]=a>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var s=0;s<a;++s)t[n+s+4]=r[s];return(n+4+a)*8},c5=function(t,e,r,a,n,s,o,u,f,h,m){rc(e,m++,r),++n[256];for(var v=dv(n,15),y=v.t,g=v.l,b=dv(s,15),_=b.t,S=b.l,E=l5(y),C=E.c,j=E.n,R=l5(_),H=R.c,Y=R.n,U=new Bi(19),V=0;V<C.length;++V)++U[C[V]&31];for(var V=0;V<H.length;++V)++U[H[V]&31];for(var F=dv(U,7),X=F.t,P=F.l,O=19;O>4&&!X[i5[O-1]];--O);var I=h+5<<3,W=e0(n,Sf)+e0(s,Zp)+o,ne=e0(n,y)+e0(s,_)+o+14+3*O+e0(U,X)+2*U[16]+3*U[17]+7*U[18];if(f>=0&&I<=W&&I<=ne)return nk(e,m,t.subarray(f,f+h));var Q,le,ee,K;if(rc(e,m,1+(ne<W)),m+=2,ne<W){Q=g0(y,g,0),le=y,ee=g0(_,S,0),K=_;var ue=g0(X,P,0);rc(e,m,j-257),rc(e,m+5,Y-1),rc(e,m+10,O-4),m+=14;for(var V=0;V<O;++V)rc(e,m+3*V,X[i5[V]]);m+=3*O;for(var M=[C,H],A=0;A<2;++A)for(var D=M[A],V=0;V<D.length;++V){var B=D[V]&31;rc(e,m,ue[B]),m+=X[B],B>15&&(rc(e,m,D[V]>>5&127),m+=D[V]>>12)}}else Q=WB,le=Sf,ee=VB,K=Zp;for(var V=0;V<u;++V){var q=a[V];if(q>255){var B=q>>18&31;Qd(e,m,Q[B+257]),m+=le[B+257],B>7&&(rc(e,m,q>>23&31),m+=Mx[B]);var Z=q&31;Qd(e,m,ee[Z]),m+=K[Z],Z>3&&(Qd(e,m,q>>5&8191),m+=Ix[Z])}else Qd(e,m,Q[q]),m+=le[q]}return Qd(e,m,Q[256]),m+le[256]},YB=new Px([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),sk=new Ko(0),XB=function(t,e,r,a,n,s){var o=s.z||t.length,u=new Ko(a+o+5*(1+Math.ceil(o/7e3))+n),f=u.subarray(a,u.length-n),h=s.l,m=(s.r||0)&7;if(e){m&&(f[0]=s.r>>3);for(var v=YB[e-1],y=v>>13,g=v&8191,b=(1<<r)-1,_=s.p||new Bi(32768),S=s.h||new Bi(b+1),E=Math.ceil(r/3),C=2*E,j=function(de){return(t[de]^t[de+1]<<E^t[de+2]<<C)&b},R=new Px(25e3),H=new Bi(288),Y=new Bi(32),U=0,V=0,F=s.i||0,X=0,P=s.w||0,O=0;F+2<o;++F){var I=j(F),W=F&32767,ne=S[I];if(_[W]=ne,S[I]=W,P<=F){var Q=o-F;if((U>7e3||X>24576)&&(Q>423||!h)){m=c5(t,f,0,R,H,Y,V,X,O,F-O,m),X=U=V=0,O=F;for(var le=0;le<286;++le)H[le]=0;for(var le=0;le<30;++le)Y[le]=0}var ee=2,K=0,ue=g,M=W-ne&32767;if(Q>2&&I==j(F-M))for(var A=Math.min(y,Q)-1,D=Math.min(32767,F),B=Math.min(258,Q);M<=D&&--ue&&W!=ne;){if(t[F+ee]==t[F+ee-M]){for(var q=0;q<B&&t[F+q]==t[F+q-M];++q);if(q>ee){if(ee=q,K=M,q>A)break;for(var Z=Math.min(M,q-2),oe=0,le=0;le<Z;++le){var pe=F-M+le&32767,_e=_[pe],be=pe-_e&32767;be>oe&&(oe=be,ne=pe)}}}W=ne,ne=_[W],M+=W-ne&32767}if(K){R[X++]=268435456|b2[ee]<<18|o5[K];var Le=b2[ee]&31,he=o5[K]&31;V+=Mx[Le]+Ix[he],++H[257+Le],++Y[he],P=F+ee,++U}else R[X++]=t[F],++H[t[F]]}}for(F=Math.max(F,P);F<o;++F)R[X++]=t[F],++H[t[F]];m=c5(t,f,h,R,H,Y,V,X,O,F-O,m),h||(s.r=m&7|f[m/8|0]<<3,m-=7,s.h=S,s.p=_,s.i=F,s.w=P)}else{for(var F=s.w||0;F<o+h;F+=65535){var Ae=F+65535;Ae>=o&&(f[m/8|0]=h,Ae=o),m=nk(f,m+1,t.subarray(F,Ae))}s.i=o}return GB(u,0,a+ak(m)+n)},ik=function(){var t=1,e=0;return{p:function(r){for(var a=t,n=e,s=r.length|0,o=0;o!=s;){for(var u=Math.min(o+2655,s);o<u;++o)n+=a+=r[o];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}t=a,e=n},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},KB=function(t,e,r,a,n){if(!n&&(n={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new Ko(s.length+t.length);o.set(s),o.set(t,s.length),t=o,n.w=s.length}return XB(t,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,a,n)},ok=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},JB=function(t,e){var r=e.level,a=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=a<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var n=ik();n.p(e.dictionary),ok(t,2,n.d())}};function N2(t,e){e||(e={});var r=ik();r.p(t);var a=KB(t,e,e.dictionary?6:2,4);return JB(a,e),ok(a,a.length-4,r.d()),a}var ZB=typeof TextDecoder<"u"&&new TextDecoder,QB=0;try{ZB.decode(sk,{stream:!0}),QB=1}catch{}function eU(t){if(Array.isArray(t))return t}function tU(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var a,n,s,o,u=[],f=!0,h=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(f=(a=s.call(r)).done)&&(u.push(a.value),u.length!==e);f=!0);}catch(m){h=!0,n=m}finally{try{if(!f&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(h)throw n}}return u}}function u5(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}function rU(t,e){if(t){if(typeof t=="string")return u5(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u5(t,e):void 0}}function aU(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f5(t,e){return eU(t)||tU(t,e)||rU(t,e)||aU()}function h5(t,e="utf8"){return new TextDecoder(e).decode(t)}const nU=new TextEncoder;function sU(t){return nU.encode(t)}const iU=1024*8,oU=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),mv={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Bx{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=iU,r={}){let a=!1;typeof e=="number"?e=new ArrayBuffer(e):(a=!0,this.lastWrittenByte=e.byteLength);const n=r.offset?r.offset>>>0:0,s=e.byteLength-n;let o=n;(ArrayBuffer.isView(e)||e instanceof Bx)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+n),e=e.buffer),a?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const a=(this.offset+e)*2,n=new Uint8Array(a);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const a=mv[r].BYTES_PER_ELEMENT*e,n=this.byteOffset+this.offset,s=this.buffer.slice(n,n+a);if(this.littleEndian===oU&&r!=="uint8"&&r!=="int8"){const u=new Uint8Array(this.buffer.slice(n,n+a));u.reverse();const f=new mv[r](u.buffer);return this.offset+=a,f.reverse(),f}const o=new mv[r](s);return this.offset+=a,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let a=0;a<e;a++)r+=this.readChar();return r}readUtf8(e=1){return h5(this.readBytes(e))}decodeText(e=1,r="utf8"){return h5(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(sU(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function dd(t){let e=t.length;for(;--e>=0;)t[e]=0}const lU=3,cU=258,lk=29,uU=256,fU=uU+1+lk,ck=30,hU=512,dU=new Array((fU+2)*2);dd(dU);const mU=new Array(ck*2);dd(mU);const pU=new Array(hU);dd(pU);const gU=new Array(cU-lU+1);dd(gU);const vU=new Array(lk);dd(vU);const xU=new Array(ck);dd(xU);const yU=(t,e,r,a)=>{let n=t&65535|0,s=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do n=n+e[a++]|0,s=s+n|0;while(--o);n%=65521,s%=65521}return n|s<<16|0};var k2=yU;const _U=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var a=0;a<8;a++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},bU=new Uint32Array(_U()),wU=(t,e,r,a)=>{const n=bU,s=a+r;t^=-1;for(let o=a;o<s;o++)t=t>>>8^n[(t^e[o])&255];return t^-1};var yl=wU,j2={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},uk={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const SU=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var NU=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const a in r)SU(r,a)&&(t[a]=r[a])}}return t},kU=t=>{let e=0;for(let a=0,n=t.length;a<n;a++)e+=t[a].length;const r=new Uint8Array(e);for(let a=0,n=0,s=t.length;a<s;a++){let o=t[a];r.set(o,n),n+=o.length}return r},fk={assign:NU,flattenChunks:kU};let hk=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{hk=!1}const I0=new Uint8Array(256);for(let t=0;t<256;t++)I0[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;I0[254]=I0[254]=1;var jU=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,a,n,s,o=t.length,u=0;for(n=0;n<o;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<o&&(a=t.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),u+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(u),s=0,n=0;s<u;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<o&&(a=t.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};const EU=(t,e)=>{if(e<65534&&t.subarray&&hk)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let a=0;a<e;a++)r+=String.fromCharCode(t[a]);return r};var AU=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let a,n;const s=new Array(r*2);for(n=0,a=0;a<r;){let o=t[a++];if(o<128){s[n++]=o;continue}let u=I0[o];if(u>4){s[n++]=65533,a+=u-1;continue}for(o&=u===2?31:u===3?15:7;u>1&&a<r;)o=o<<6|t[a++]&63,u--;if(u>1){s[n++]=65533;continue}o<65536?s[n++]=o:(o-=65536,s[n++]=55296|o>>10&1023,s[n++]=56320|o&1023)}return EU(s,n)},CU=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+I0[t[r]]>e?r:e},E2={string2buf:jU,buf2string:AU,utf8border:CU};function TU(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var OU=TU;const dp=16209,RU=16191;var DU=function(e,r){let a,n,s,o,u,f,h,m,v,y,g,b,_,S,E,C,j,R,H,Y,U,V,F,X;const P=e.state;a=e.next_in,F=e.input,n=a+(e.avail_in-5),s=e.next_out,X=e.output,o=s-(r-e.avail_out),u=s+(e.avail_out-257),f=P.dmax,h=P.wsize,m=P.whave,v=P.wnext,y=P.window,g=P.hold,b=P.bits,_=P.lencode,S=P.distcode,E=(1<<P.lenbits)-1,C=(1<<P.distbits)-1;e:do{b<15&&(g+=F[a++]<<b,b+=8,g+=F[a++]<<b,b+=8),j=_[g&E];t:for(;;){if(R=j>>>24,g>>>=R,b-=R,R=j>>>16&255,R===0)X[s++]=j&65535;else if(R&16){H=j&65535,R&=15,R&&(b<R&&(g+=F[a++]<<b,b+=8),H+=g&(1<<R)-1,g>>>=R,b-=R),b<15&&(g+=F[a++]<<b,b+=8,g+=F[a++]<<b,b+=8),j=S[g&C];r:for(;;){if(R=j>>>24,g>>>=R,b-=R,R=j>>>16&255,R&16){if(Y=j&65535,R&=15,b<R&&(g+=F[a++]<<b,b+=8,b<R&&(g+=F[a++]<<b,b+=8)),Y+=g&(1<<R)-1,Y>f){e.msg="invalid distance too far back",P.mode=dp;break e}if(g>>>=R,b-=R,R=s-o,Y>R){if(R=Y-R,R>m&&P.sane){e.msg="invalid distance too far back",P.mode=dp;break e}if(U=0,V=y,v===0){if(U+=h-R,R<H){H-=R;do X[s++]=y[U++];while(--R);U=s-Y,V=X}}else if(v<R){if(U+=h+v-R,R-=v,R<H){H-=R;do X[s++]=y[U++];while(--R);if(U=0,v<H){R=v,H-=R;do X[s++]=y[U++];while(--R);U=s-Y,V=X}}}else if(U+=v-R,R<H){H-=R;do X[s++]=y[U++];while(--R);U=s-Y,V=X}for(;H>2;)X[s++]=V[U++],X[s++]=V[U++],X[s++]=V[U++],H-=3;H&&(X[s++]=V[U++],H>1&&(X[s++]=V[U++]))}else{U=s-Y;do X[s++]=X[U++],X[s++]=X[U++],X[s++]=X[U++],H-=3;while(H>2);H&&(X[s++]=X[U++],H>1&&(X[s++]=X[U++]))}}else if((R&64)===0){j=S[(j&65535)+(g&(1<<R)-1)];continue r}else{e.msg="invalid distance code",P.mode=dp;break e}break}}else if((R&64)===0){j=_[(j&65535)+(g&(1<<R)-1)];continue t}else if(R&32){P.mode=RU;break e}else{e.msg="invalid literal/length code",P.mode=dp;break e}break}}while(a<n&&s<u);H=b>>3,a-=H,b-=H<<3,g&=(1<<b)-1,e.next_in=a,e.next_out=s,e.avail_in=a<n?5+(n-a):5-(a-n),e.avail_out=s<u?257+(u-s):257-(s-u),P.hold=g,P.bits=b};const Fh=15,d5=852,m5=592,p5=0,pv=1,g5=2,FU=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),LU=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),PU=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),MU=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),IU=(t,e,r,a,n,s,o,u)=>{const f=u.bits;let h=0,m=0,v=0,y=0,g=0,b=0,_=0,S=0,E=0,C=0,j,R,H,Y,U,V=null,F;const X=new Uint16Array(Fh+1),P=new Uint16Array(Fh+1);let O=null,I,W,ne;for(h=0;h<=Fh;h++)X[h]=0;for(m=0;m<a;m++)X[e[r+m]]++;for(g=f,y=Fh;y>=1&&X[y]===0;y--);if(g>y&&(g=y),y===0)return n[s++]=1<<24|64<<16|0,n[s++]=1<<24|64<<16|0,u.bits=1,0;for(v=1;v<y&&X[v]===0;v++);for(g<v&&(g=v),S=1,h=1;h<=Fh;h++)if(S<<=1,S-=X[h],S<0)return-1;if(S>0&&(t===p5||y!==1))return-1;for(P[1]=0,h=1;h<Fh;h++)P[h+1]=P[h]+X[h];for(m=0;m<a;m++)e[r+m]!==0&&(o[P[e[r+m]]++]=m);if(t===p5?(V=O=o,F=20):t===pv?(V=FU,O=LU,F=257):(V=PU,O=MU,F=0),C=0,m=0,h=v,U=s,b=g,_=0,H=-1,E=1<<g,Y=E-1,t===pv&&E>d5||t===g5&&E>m5)return 1;for(;;){I=h-_,o[m]+1<F?(W=0,ne=o[m]):o[m]>=F?(W=O[o[m]-F],ne=V[o[m]-F]):(W=96,ne=0),j=1<<h-_,R=1<<b,v=R;do R-=j,n[U+(C>>_)+R]=I<<24|W<<16|ne|0;while(R!==0);for(j=1<<h-1;C&j;)j>>=1;if(j!==0?(C&=j-1,C+=j):C=0,m++,--X[h]===0){if(h===y)break;h=e[r+o[m]]}if(h>g&&(C&Y)!==H){for(_===0&&(_=g),U+=v,b=h-_,S=1<<b;b+_<y&&(S-=X[b+_],!(S<=0));)b++,S<<=1;if(E+=1<<b,t===pv&&E>d5||t===g5&&E>m5)return 1;H=C&Y,n[H]=g<<24|b<<16|U-s|0}}return C!==0&&(n[U+C]=h-_<<24|64<<16|0),u.bits=g,0};var v0=IU;const BU=0,dk=1,mk=2,{Z_FINISH:v5,Z_BLOCK:UU,Z_TREES:mp,Z_OK:Nf,Z_STREAM_END:qU,Z_NEED_DICT:zU,Z_STREAM_ERROR:ho,Z_DATA_ERROR:pk,Z_MEM_ERROR:gk,Z_BUF_ERROR:HU,Z_DEFLATED:x5}=uk,y1=16180,y5=16181,_5=16182,b5=16183,w5=16184,S5=16185,N5=16186,k5=16187,j5=16188,E5=16189,Qp=16190,ac=16191,gv=16192,A5=16193,vv=16194,C5=16195,T5=16196,O5=16197,R5=16198,pp=16199,gp=16200,D5=16201,F5=16202,L5=16203,P5=16204,M5=16205,xv=16206,I5=16207,B5=16208,Ya=16209,vk=16210,xk=16211,$U=852,WU=592,VU=15,GU=VU,U5=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function YU(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ff=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<y1||e.mode>xk?1:0},yk=t=>{if(Ff(t))return ho;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=y1,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array($U),e.distcode=e.distdyn=new Int32Array(WU),e.sane=1,e.back=-1,Nf},_k=t=>{if(Ff(t))return ho;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,yk(t)},bk=(t,e)=>{let r;if(Ff(t))return ho;const a=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?ho:(a.window!==null&&a.wbits!==e&&(a.window=null),a.wrap=r,a.wbits=e,_k(t))},wk=(t,e)=>{if(!t)return ho;const r=new YU;t.state=r,r.strm=t,r.window=null,r.mode=y1;const a=bk(t,e);return a!==Nf&&(t.state=null),a},XU=t=>wk(t,GU);let q5=!0,yv,_v;const KU=t=>{if(q5){yv=new Int32Array(512),_v=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(v0(dk,t.lens,0,288,yv,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;v0(mk,t.lens,0,32,_v,0,t.work,{bits:5}),q5=!1}t.lencode=yv,t.lenbits=9,t.distcode=_v,t.distbits=5},Sk=(t,e,r,a)=>{let n;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),a>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>a&&(n=a),s.window.set(e.subarray(r-a,r-a+n),s.wnext),a-=n,a?(s.window.set(e.subarray(r-a,r),0),s.wnext=a,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0},JU=(t,e)=>{let r,a,n,s,o,u,f,h,m,v,y,g,b,_,S=0,E,C,j,R,H,Y,U,V;const F=new Uint8Array(4);let X,P;const O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ff(t)||!t.output||!t.input&&t.avail_in!==0)return ho;r=t.state,r.mode===ac&&(r.mode=gv),o=t.next_out,n=t.output,f=t.avail_out,s=t.next_in,a=t.input,u=t.avail_in,h=r.hold,m=r.bits,v=u,y=f,V=Nf;e:for(;;)switch(r.mode){case y1:if(r.wrap===0){r.mode=gv;break}for(;m<16;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}if(r.wrap&2&&h===35615){r.wbits===0&&(r.wbits=15),r.check=0,F[0]=h&255,F[1]=h>>>8&255,r.check=yl(r.check,F,2,0),h=0,m=0,r.mode=y5;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((h&255)<<8)+(h>>8))%31){t.msg="incorrect header check",r.mode=Ya;break}if((h&15)!==x5){t.msg="unknown compression method",r.mode=Ya;break}if(h>>>=4,m-=4,U=(h&15)+8,r.wbits===0&&(r.wbits=U),U>15||U>r.wbits){t.msg="invalid window size",r.mode=Ya;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=h&512?E5:ac,h=0,m=0;break;case y5:for(;m<16;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}if(r.flags=h,(r.flags&255)!==x5){t.msg="unknown compression method",r.mode=Ya;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Ya;break}r.head&&(r.head.text=h>>8&1),r.flags&512&&r.wrap&4&&(F[0]=h&255,F[1]=h>>>8&255,r.check=yl(r.check,F,2,0)),h=0,m=0,r.mode=_5;case _5:for(;m<32;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}r.head&&(r.head.time=h),r.flags&512&&r.wrap&4&&(F[0]=h&255,F[1]=h>>>8&255,F[2]=h>>>16&255,F[3]=h>>>24&255,r.check=yl(r.check,F,4,0)),h=0,m=0,r.mode=b5;case b5:for(;m<16;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}r.head&&(r.head.xflags=h&255,r.head.os=h>>8),r.flags&512&&r.wrap&4&&(F[0]=h&255,F[1]=h>>>8&255,r.check=yl(r.check,F,2,0)),h=0,m=0,r.mode=w5;case w5:if(r.flags&1024){for(;m<16;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}r.length=h,r.head&&(r.head.extra_len=h),r.flags&512&&r.wrap&4&&(F[0]=h&255,F[1]=h>>>8&255,r.check=yl(r.check,F,2,0)),h=0,m=0}else r.head&&(r.head.extra=null);r.mode=S5;case S5:if(r.flags&1024&&(g=r.length,g>u&&(g=u),g&&(r.head&&(U=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(s,s+g),U)),r.flags&512&&r.wrap&4&&(r.check=yl(r.check,a,g,s)),u-=g,s+=g,r.length-=g),r.length))break e;r.length=0,r.mode=N5;case N5:if(r.flags&2048){if(u===0)break e;g=0;do U=a[s+g++],r.head&&U&&r.length<65536&&(r.head.name+=String.fromCharCode(U));while(U&&g<u);if(r.flags&512&&r.wrap&4&&(r.check=yl(r.check,a,g,s)),u-=g,s+=g,U)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=k5;case k5:if(r.flags&4096){if(u===0)break e;g=0;do U=a[s+g++],r.head&&U&&r.length<65536&&(r.head.comment+=String.fromCharCode(U));while(U&&g<u);if(r.flags&512&&r.wrap&4&&(r.check=yl(r.check,a,g,s)),u-=g,s+=g,U)break e}else r.head&&(r.head.comment=null);r.mode=j5;case j5:if(r.flags&512){for(;m<16;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}if(r.wrap&4&&h!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Ya;break}h=0,m=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=ac;break;case E5:for(;m<32;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}t.adler=r.check=U5(h),h=0,m=0,r.mode=Qp;case Qp:if(r.havedict===0)return t.next_out=o,t.avail_out=f,t.next_in=s,t.avail_in=u,r.hold=h,r.bits=m,zU;t.adler=r.check=1,r.mode=ac;case ac:if(e===UU||e===mp)break e;case gv:if(r.last){h>>>=m&7,m-=m&7,r.mode=xv;break}for(;m<3;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}switch(r.last=h&1,h>>>=1,m-=1,h&3){case 0:r.mode=A5;break;case 1:if(KU(r),r.mode=pp,e===mp){h>>>=2,m-=2;break e}break;case 2:r.mode=T5;break;case 3:t.msg="invalid block type",r.mode=Ya}h>>>=2,m-=2;break;case A5:for(h>>>=m&7,m-=m&7;m<32;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}if((h&65535)!==(h>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Ya;break}if(r.length=h&65535,h=0,m=0,r.mode=vv,e===mp)break e;case vv:r.mode=C5;case C5:if(g=r.length,g){if(g>u&&(g=u),g>f&&(g=f),g===0)break e;n.set(a.subarray(s,s+g),o),u-=g,s+=g,f-=g,o+=g,r.length-=g;break}r.mode=ac;break;case T5:for(;m<14;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}if(r.nlen=(h&31)+257,h>>>=5,m-=5,r.ndist=(h&31)+1,h>>>=5,m-=5,r.ncode=(h&15)+4,h>>>=4,m-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Ya;break}r.have=0,r.mode=O5;case O5:for(;r.have<r.ncode;){for(;m<3;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}r.lens[O[r.have++]]=h&7,h>>>=3,m-=3}for(;r.have<19;)r.lens[O[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,X={bits:r.lenbits},V=v0(BU,r.lens,0,19,r.lencode,0,r.work,X),r.lenbits=X.bits,V){t.msg="invalid code lengths set",r.mode=Ya;break}r.have=0,r.mode=R5;case R5:for(;r.have<r.nlen+r.ndist;){for(;S=r.lencode[h&(1<<r.lenbits)-1],E=S>>>24,C=S>>>16&255,j=S&65535,!(E<=m);){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}if(j<16)h>>>=E,m-=E,r.lens[r.have++]=j;else{if(j===16){for(P=E+2;m<P;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}if(h>>>=E,m-=E,r.have===0){t.msg="invalid bit length repeat",r.mode=Ya;break}U=r.lens[r.have-1],g=3+(h&3),h>>>=2,m-=2}else if(j===17){for(P=E+3;m<P;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}h>>>=E,m-=E,U=0,g=3+(h&7),h>>>=3,m-=3}else{for(P=E+7;m<P;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}h>>>=E,m-=E,U=0,g=11+(h&127),h>>>=7,m-=7}if(r.have+g>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Ya;break}for(;g--;)r.lens[r.have++]=U}}if(r.mode===Ya)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Ya;break}if(r.lenbits=9,X={bits:r.lenbits},V=v0(dk,r.lens,0,r.nlen,r.lencode,0,r.work,X),r.lenbits=X.bits,V){t.msg="invalid literal/lengths set",r.mode=Ya;break}if(r.distbits=6,r.distcode=r.distdyn,X={bits:r.distbits},V=v0(mk,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,X),r.distbits=X.bits,V){t.msg="invalid distances set",r.mode=Ya;break}if(r.mode=pp,e===mp)break e;case pp:r.mode=gp;case gp:if(u>=6&&f>=258){t.next_out=o,t.avail_out=f,t.next_in=s,t.avail_in=u,r.hold=h,r.bits=m,DU(t,y),o=t.next_out,n=t.output,f=t.avail_out,s=t.next_in,a=t.input,u=t.avail_in,h=r.hold,m=r.bits,r.mode===ac&&(r.back=-1);break}for(r.back=0;S=r.lencode[h&(1<<r.lenbits)-1],E=S>>>24,C=S>>>16&255,j=S&65535,!(E<=m);){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}if(C&&(C&240)===0){for(R=E,H=C,Y=j;S=r.lencode[Y+((h&(1<<R+H)-1)>>R)],E=S>>>24,C=S>>>16&255,j=S&65535,!(R+E<=m);){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}h>>>=R,m-=R,r.back+=R}if(h>>>=E,m-=E,r.back+=E,r.length=j,C===0){r.mode=M5;break}if(C&32){r.back=-1,r.mode=ac;break}if(C&64){t.msg="invalid literal/length code",r.mode=Ya;break}r.extra=C&15,r.mode=D5;case D5:if(r.extra){for(P=r.extra;m<P;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}r.length+=h&(1<<r.extra)-1,h>>>=r.extra,m-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=F5;case F5:for(;S=r.distcode[h&(1<<r.distbits)-1],E=S>>>24,C=S>>>16&255,j=S&65535,!(E<=m);){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}if((C&240)===0){for(R=E,H=C,Y=j;S=r.distcode[Y+((h&(1<<R+H)-1)>>R)],E=S>>>24,C=S>>>16&255,j=S&65535,!(R+E<=m);){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}h>>>=R,m-=R,r.back+=R}if(h>>>=E,m-=E,r.back+=E,C&64){t.msg="invalid distance code",r.mode=Ya;break}r.offset=j,r.extra=C&15,r.mode=L5;case L5:if(r.extra){for(P=r.extra;m<P;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}r.offset+=h&(1<<r.extra)-1,h>>>=r.extra,m-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Ya;break}r.mode=P5;case P5:if(f===0)break e;if(g=y-f,r.offset>g){if(g=r.offset-g,g>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Ya;break}g>r.wnext?(g-=r.wnext,b=r.wsize-g):b=r.wnext-g,g>r.length&&(g=r.length),_=r.window}else _=n,b=o-r.offset,g=r.length;g>f&&(g=f),f-=g,r.length-=g;do n[o++]=_[b++];while(--g);r.length===0&&(r.mode=gp);break;case M5:if(f===0)break e;n[o++]=r.length,f--,r.mode=gp;break;case xv:if(r.wrap){for(;m<32;){if(u===0)break e;u--,h|=a[s++]<<m,m+=8}if(y-=f,t.total_out+=y,r.total+=y,r.wrap&4&&y&&(t.adler=r.check=r.flags?yl(r.check,n,y,o-y):k2(r.check,n,y,o-y)),y=f,r.wrap&4&&(r.flags?h:U5(h))!==r.check){t.msg="incorrect data check",r.mode=Ya;break}h=0,m=0}r.mode=I5;case I5:if(r.wrap&&r.flags){for(;m<32;){if(u===0)break e;u--,h+=a[s++]<<m,m+=8}if(r.wrap&4&&h!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Ya;break}h=0,m=0}r.mode=B5;case B5:V=qU;break e;case Ya:V=pk;break e;case vk:return gk;case xk:default:return ho}return t.next_out=o,t.avail_out=f,t.next_in=s,t.avail_in=u,r.hold=h,r.bits=m,(r.wsize||y!==t.avail_out&&r.mode<Ya&&(r.mode<xv||e!==v5))&&Sk(t,t.output,t.next_out,y-t.avail_out),v-=t.avail_in,y-=t.avail_out,t.total_in+=v,t.total_out+=y,r.total+=y,r.wrap&4&&y&&(t.adler=r.check=r.flags?yl(r.check,n,y,t.next_out-y):k2(r.check,n,y,t.next_out-y)),t.data_type=r.bits+(r.last?64:0)+(r.mode===ac?128:0)+(r.mode===pp||r.mode===vv?256:0),(v===0&&y===0||e===v5)&&V===Nf&&(V=HU),V},ZU=t=>{if(Ff(t))return ho;let e=t.state;return e.window&&(e.window=null),t.state=null,Nf},QU=(t,e)=>{if(Ff(t))return ho;const r=t.state;return(r.wrap&2)===0?ho:(r.head=e,e.done=!1,Nf)},eq=(t,e)=>{const r=e.length;let a,n,s;return Ff(t)||(a=t.state,a.wrap!==0&&a.mode!==Qp)?ho:a.mode===Qp&&(n=1,n=k2(n,e,r,0),n!==a.check)?pk:(s=Sk(t,e,r,r),s?(a.mode=vk,gk):(a.havedict=1,Nf))};var tq=_k,rq=bk,aq=yk,nq=XU,sq=wk,iq=JU,oq=ZU,lq=QU,cq=eq,uq="pako inflate (from Nodeca project)",sc={inflateReset:tq,inflateReset2:rq,inflateResetKeep:aq,inflateInit:nq,inflateInit2:sq,inflate:iq,inflateEnd:oq,inflateGetHeader:lq,inflateSetDictionary:cq,inflateInfo:uq};function fq(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var hq=fq;const Nk=Object.prototype.toString,{Z_NO_FLUSH:dq,Z_FINISH:mq,Z_OK:B0,Z_STREAM_END:bv,Z_NEED_DICT:wv,Z_STREAM_ERROR:pq,Z_DATA_ERROR:z5,Z_MEM_ERROR:gq}=uk;function J0(t){this.options=fk.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new OU,this.strm.avail_out=0;let r=sc.inflateInit2(this.strm,e.windowBits);if(r!==B0)throw new Error(j2[r]);if(this.header=new hq,sc.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=E2.string2buf(e.dictionary):Nk.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=sc.inflateSetDictionary(this.strm,e.dictionary),r!==B0)))throw new Error(j2[r])}J0.prototype.push=function(t,e){const r=this.strm,a=this.options.chunkSize,n=this.options.dictionary;let s,o,u;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?mq:dq,Nk.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),s=sc.inflate(r,o),s===wv&&n&&(s=sc.inflateSetDictionary(r,n),s===B0?s=sc.inflate(r,o):s===z5&&(s=wv));r.avail_in>0&&s===bv&&r.state.wrap>0&&t[r.next_in]!==0;)sc.inflateReset(r),s=sc.inflate(r,o);switch(s){case pq:case z5:case wv:case gq:return this.onEnd(s),this.ended=!0,!1}if(u=r.avail_out,r.next_out&&(r.avail_out===0||s===bv))if(this.options.to==="string"){let f=E2.utf8border(r.output,r.next_out),h=r.next_out-f,m=E2.buf2string(r.output,f);r.next_out=h,r.avail_out=a-h,h&&r.output.set(r.output.subarray(f,f+h),0),this.onData(m)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===B0&&u===0)){if(s===bv)return s=sc.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};J0.prototype.onData=function(t){this.chunks.push(t)};J0.prototype.onEnd=function(t){t===B0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=fk.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function vq(t,e){const r=new J0(e);if(r.push(t),r.err)throw r.msg||j2[r.err];return r.result}var xq=J0,yq=vq,_q={Inflate:xq,inflate:yq};const{Inflate:bq,inflate:wq}=_q;var H5=bq,Sq=wq;const kk=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;kk[t]=e}const $5=4294967295;function Nq(t,e,r){let a=t;for(let n=0;n<r;n++)a=kk[(a^e[n])&255]^a>>>8;return a}function kq(t,e){return(Nq($5,t,e)^$5)>>>0}function W5(t,e,r){const a=t.readUint32(),n=kq(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(n!==a)throw new Error(`CRC mismatch for chunk ${r}. Expected ${a}, found ${n}`)}function jk(t,e,r){for(let a=0;a<r;a++)e[a]=t[a]}function Ek(t,e,r,a){let n=0;for(;n<a;n++)e[n]=t[n];for(;n<r;n++)e[n]=t[n]+e[n-a]&255}function Ak(t,e,r,a){let n=0;if(r.length===0)for(;n<a;n++)e[n]=t[n];else for(;n<a;n++)e[n]=t[n]+r[n]&255}function Ck(t,e,r,a,n){let s=0;if(r.length===0){for(;s<n;s++)e[s]=t[s];for(;s<a;s++)e[s]=t[s]+(e[s-n]>>1)&255}else{for(;s<n;s++)e[s]=t[s]+(r[s]>>1)&255;for(;s<a;s++)e[s]=t[s]+(e[s-n]+r[s]>>1)&255}}function Tk(t,e,r,a,n){let s=0;if(r.length===0){for(;s<n;s++)e[s]=t[s];for(;s<a;s++)e[s]=t[s]+e[s-n]&255}else{for(;s<n;s++)e[s]=t[s]+r[s]&255;for(;s<a;s++)e[s]=t[s]+jq(e[s-n],r[s],r[s-n])&255}}function jq(t,e,r){const a=t+e-r,n=Math.abs(a-t),s=Math.abs(a-e),o=Math.abs(a-r);return n<=s&&n<=o?t:s<=o?e:r}function Eq(t,e,r,a,n,s){switch(t){case 0:jk(e,r,n);break;case 1:Ek(e,r,n,s);break;case 2:Ak(e,r,a,n);break;case 3:Ck(e,r,a,n,s);break;case 4:Tk(e,r,a,n,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const Aq=new Uint16Array([255]),Cq=new Uint8Array(Aq.buffer),Tq=Cq[0]===255;function Oq(t){const{data:e,width:r,height:a,channels:n,depth:s}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],u=Math.ceil(s/8)*n,f=new Uint8Array(a*r*u);let h=0;for(let m=0;m<7;m++){const v=o[m],y=Math.ceil((r-v.x)/v.xStep),g=Math.ceil((a-v.y)/v.yStep);if(y<=0||g<=0)continue;const b=y*u,_=new Uint8Array(b);for(let S=0;S<g;S++){const E=e[h++],C=e.subarray(h,h+b);h+=b;const j=new Uint8Array(b);Eq(E,C,j,_,b,u),_.set(j);for(let R=0;R<y;R++){const H=v.x+R*v.xStep,Y=v.y+S*v.yStep;if(!(H>=r||Y>=a))for(let U=0;U<u;U++)f[(Y*r+H)*u+U]=j[R*u+U]}}}if(s===16){const m=new Uint16Array(f.buffer);if(Tq)for(let v=0;v<m.length;v++)m[v]=Rq(m[v]);return m}else return f}function Rq(t){return(t&255)<<8|t>>8&255}const Dq=new Uint16Array([255]),Fq=new Uint8Array(Dq.buffer),Lq=Fq[0]===255,Pq=new Uint8Array(0);function V5(t){const{data:e,width:r,height:a,channels:n,depth:s}=t,o=Math.ceil(s/8)*n,u=Math.ceil(s/8*n*r),f=new Uint8Array(a*u);let h=Pq,m=0,v,y;for(let g=0;g<a;g++){switch(v=e.subarray(m+1,m+1+u),y=f.subarray(g*u,(g+1)*u),e[m]){case 0:jk(v,y,u);break;case 1:Ek(v,y,u,o);break;case 2:Ak(v,y,h,u);break;case 3:Ck(v,y,h,u,o);break;case 4:Tk(v,y,h,u,o);break;default:throw new Error(`Unsupported filter: ${e[m]}`)}h=y,m+=u+1}if(s===16){const g=new Uint16Array(f.buffer);if(Lq)for(let b=0;b<g.length;b++)g[b]=Mq(g[b]);return g}else return f}function Mq(t){return(t&255)<<8|t>>8&255}const Ep=Uint8Array.of(137,80,78,71,13,10,26,10);function G5(t){if(!Iq(t.readBytes(Ep.length)))throw new Error("wrong PNG signature")}function Iq(t){if(t.length<Ep.length)return!1;for(let e=0;e<Ep.length;e++)if(t[e]!==Ep[e])return!1;return!0}const Bq="tEXt",Uq=0,Ok=new TextDecoder("latin1");function qq(t){if(Hq(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const zq=/^[\u0000-\u00FF]*$/;function Hq(t){if(!zq.test(t))throw new Error("invalid latin1 text")}function $q(t,e,r){const a=Rk(e);t[a]=Wq(e,r-a.length-1)}function Rk(t){for(t.mark();t.readByte()!==Uq;);const e=t.offset;t.reset();const r=Ok.decode(t.readBytes(e-t.offset-1));return t.skip(1),qq(r),r}function Wq(t,e){return Ok.decode(t.readBytes(e))}const Ti={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Sv={UNKNOWN:-1,DEFLATE:0},Y5={UNKNOWN:-1,ADAPTIVE:0},Nv={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},vp={NONE:0,BACKGROUND:1,PREVIOUS:2},kv={SOURCE:0,OVER:1};class Vq extends Bx{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,r={}){super(e);const{checkCrc:a=!1}=r;this._checkCrc=a,this._inflator=new H5,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Sv.UNKNOWN,this._filterMethod=Y5.UNKNOWN,this._interlaceMethod=Nv.UNKNOWN,this._colorType=Ti.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(G5(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeChunk(e,r)}return this.decodeImage(),this._png}decodeApng(){for(G5(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(e,r)}return this.decodeApngImage(),this._apng}decodeChunk(e,r){const a=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case Bq:$q(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-a!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?W5(this,e+4,r):this.skip(4)}decodeApngChunk(e,r){const a=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,r),this.offset=a+e;break}if(this.offset-a!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?W5(this,e+4,r):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=Gq(this.readUint8());const r=this.readUint8();this._colorType=r;let a;switch(r){case Ti.GREYSCALE:a=1;break;case Ti.TRUECOLOUR:a=3;break;case Ti.INDEXED_COLOUR:a=1;break;case Ti.GREYSCALE_ALPHA:a=2;break;case Ti.TRUECOLOUR_ALPHA:a=4;break;case Ti.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==Sv.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const r=e/3;this._hasPalette=!0;const a=[];this._palette=a;for(let n=0;n<r;n++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const r=e,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let r=e,a=this.offset+this.byteOffset;if(a+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Ti.GREYSCALE:case Ti.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let r=0;r<e/2;r++)this._transparency[r]=this.readUint16();break}case Ti.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let r=0;for(;r<e;r++){const a=this.readByte();this._palette[r].push(a)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case Ti.UNKNOWN:case Ti.GREYSCALE_ALPHA:case Ti.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const r=Rk(this),a=this.readUint8();if(a!==Sv.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const n=this.readBytes(e-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:Sq(n)}}decodepHYs(){const e=this.readUint32(),r=this.readUint32(),a=this.readByte();this._png.resolution={x:e,y:r,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const r={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(e);if(a){if(a.data=V5({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)r.data=a.data;else{const n=this._apng.frames.at(e-1);this.disposeFrame(a,n,r),this.addFrameDataToCanvas(r,a)}this._apng.frames.push(r)}}return this._apng}disposeFrame(e,r,a){switch(e.disposeOp){case vp.NONE:break;case vp.BACKGROUND:for(let n=0;n<this._png.height;n++)for(let s=0;s<this._png.width;s++){const o=(n*e.width+s)*this._png.channels;for(let u=0;u<this._png.channels;u++)a.data[o+u]=0}break;case vp.PREVIOUS:a.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,r){const a=1<<this._png.depth,n=(s,o)=>{const u=((s+r.yOffset)*this._png.width+r.xOffset+o)*this._png.channels,f=(s*r.width+o)*this._png.channels;return{index:u,frameIndex:f}};switch(r.blendOp){case kv.SOURCE:for(let s=0;s<r.height;s++)for(let o=0;o<r.width;o++){const{index:u,frameIndex:f}=n(s,o);for(let h=0;h<this._png.channels;h++)e.data[u+h]=r.data[f+h]}break;case kv.OVER:for(let s=0;s<r.height;s++)for(let o=0;o<r.width;o++){const{index:u,frameIndex:f}=n(s,o);for(let h=0;h<this._png.channels;h++){const m=r.data[f+this._png.channels-1]/a,v=h%(this._png.channels-1)===0?1:r.data[f+h],y=Math.floor(m*v+(1-m)*e.data[u+h]);e.data[u+h]+=y}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Y5.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Nv.NO_INTERLACE)this._png.data=V5({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Nv.ADAM7)this._png.data=Oq({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,r=this._frames.at(-1);r?r.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:vp.NONE,blendOp:kv.SOURCE,data:e}),this._inflator=new H5,this._writingDataChunks=!1}}function Gq(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var X5;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(X5||(X5={}));function Yq(t,e){return new Vq(t,e).decode()}var wr=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function jv(){wr.console&&typeof wr.console.log=="function"&&wr.console.log.apply(wr.console,arguments)}var Oa={log:jv,warn:function(t){wr.console&&(typeof wr.console.warn=="function"?wr.console.warn.apply(wr.console,arguments):jv.call(null,arguments))},error:function(t){wr.console&&(typeof wr.console.error=="function"?wr.console.error.apply(wr.console,arguments):jv(t))}};function Ev(t,e,r){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="blob",a.onload=function(){ef(a.response,e,r)},a.onerror=function(){Oa.error("could not download file")},a.send()}function K5(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function xp(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var ef=wr.saveAs||((typeof window>"u"?"undefined":va(window))!=="object"||window!==wr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var a=wr.URL||wr.webkitURL,n=document.createElement("a");e=e||t.name||"download",n.download=e,n.rel="noopener",typeof t=="string"?(n.href=t,n.origin!==location.origin?K5(n.href)?Ev(t,e,r):xp(n,n.target="_blank"):xp(n)):(n.href=a.createObjectURL(t),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){xp(n)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(K5(t))Ev(t,e,r);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout(function(){xp(a)})}else navigator.msSaveOrOpenBlob((function(n,s){return s===void 0?s={autoBom:!1}:va(s)!=="object"&&(Oa.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(t,r),e)}:function(t,e,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof t=="string")return Ev(t,e,r);var n=t.type==="application/octet-stream",s=/constructor/i.test(wr.HTMLElement)||wr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||n&&s)&&(typeof FileReader>"u"?"undefined":va(FileReader))==="object"){var u=new FileReader;u.onloadend=function(){var m=u.result;m=o?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=m:location=m,a=null},u.readAsDataURL(t)}else{var f=wr.URL||wr.webkitURL,h=f.createObjectURL(t);a?a.location=h:location.href=h,a=null,setTimeout(function(){f.revokeObjectURL(h)},4e4)}});function Dk(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(u){return[parseInt(u[1]),parseInt(u[2]),parseInt(u[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(u){return[parseInt(u[1],16),parseInt(u[2],16),parseInt(u[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(u){return[parseInt(u[1]+u[1],16),parseInt(u[2]+u[2],16),parseInt(u[3]+u[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,s=r[a].process,o=n.exec(t);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var u=this.r.toString(16),f=this.g.toString(16),h=this.b.toString(16);return u.length==1&&(u="0"+u),f.length==1&&(f="0"+f),h.length==1&&(h="0"+h),"#"+u+f+h}}var Ap=wr.atob.bind(wr),J5=wr.btoa.bind(wr);function Av(t,e){var r=t[0],a=t[1],n=t[2],s=t[3];r=Es(r,a,n,s,e[0],7,-680876936),s=Es(s,r,a,n,e[1],12,-389564586),n=Es(n,s,r,a,e[2],17,606105819),a=Es(a,n,s,r,e[3],22,-1044525330),r=Es(r,a,n,s,e[4],7,-176418897),s=Es(s,r,a,n,e[5],12,1200080426),n=Es(n,s,r,a,e[6],17,-1473231341),a=Es(a,n,s,r,e[7],22,-45705983),r=Es(r,a,n,s,e[8],7,1770035416),s=Es(s,r,a,n,e[9],12,-1958414417),n=Es(n,s,r,a,e[10],17,-42063),a=Es(a,n,s,r,e[11],22,-1990404162),r=Es(r,a,n,s,e[12],7,1804603682),s=Es(s,r,a,n,e[13],12,-40341101),n=Es(n,s,r,a,e[14],17,-1502002290),r=As(r,a=Es(a,n,s,r,e[15],22,1236535329),n,s,e[1],5,-165796510),s=As(s,r,a,n,e[6],9,-1069501632),n=As(n,s,r,a,e[11],14,643717713),a=As(a,n,s,r,e[0],20,-373897302),r=As(r,a,n,s,e[5],5,-701558691),s=As(s,r,a,n,e[10],9,38016083),n=As(n,s,r,a,e[15],14,-660478335),a=As(a,n,s,r,e[4],20,-405537848),r=As(r,a,n,s,e[9],5,568446438),s=As(s,r,a,n,e[14],9,-1019803690),n=As(n,s,r,a,e[3],14,-187363961),a=As(a,n,s,r,e[8],20,1163531501),r=As(r,a,n,s,e[13],5,-1444681467),s=As(s,r,a,n,e[2],9,-51403784),n=As(n,s,r,a,e[7],14,1735328473),r=Cs(r,a=As(a,n,s,r,e[12],20,-1926607734),n,s,e[5],4,-378558),s=Cs(s,r,a,n,e[8],11,-2022574463),n=Cs(n,s,r,a,e[11],16,1839030562),a=Cs(a,n,s,r,e[14],23,-35309556),r=Cs(r,a,n,s,e[1],4,-1530992060),s=Cs(s,r,a,n,e[4],11,1272893353),n=Cs(n,s,r,a,e[7],16,-155497632),a=Cs(a,n,s,r,e[10],23,-1094730640),r=Cs(r,a,n,s,e[13],4,681279174),s=Cs(s,r,a,n,e[0],11,-358537222),n=Cs(n,s,r,a,e[3],16,-722521979),a=Cs(a,n,s,r,e[6],23,76029189),r=Cs(r,a,n,s,e[9],4,-640364487),s=Cs(s,r,a,n,e[12],11,-421815835),n=Cs(n,s,r,a,e[15],16,530742520),r=Ts(r,a=Cs(a,n,s,r,e[2],23,-995338651),n,s,e[0],6,-198630844),s=Ts(s,r,a,n,e[7],10,1126891415),n=Ts(n,s,r,a,e[14],15,-1416354905),a=Ts(a,n,s,r,e[5],21,-57434055),r=Ts(r,a,n,s,e[12],6,1700485571),s=Ts(s,r,a,n,e[3],10,-1894986606),n=Ts(n,s,r,a,e[10],15,-1051523),a=Ts(a,n,s,r,e[1],21,-2054922799),r=Ts(r,a,n,s,e[8],6,1873313359),s=Ts(s,r,a,n,e[15],10,-30611744),n=Ts(n,s,r,a,e[6],15,-1560198380),a=Ts(a,n,s,r,e[13],21,1309151649),r=Ts(r,a,n,s,e[4],6,-145523070),s=Ts(s,r,a,n,e[11],10,-1120210379),n=Ts(n,s,r,a,e[2],15,718787259),a=Ts(a,n,s,r,e[9],21,-343485551),t[0]=cu(r,t[0]),t[1]=cu(a,t[1]),t[2]=cu(n,t[2]),t[3]=cu(s,t[3])}function _1(t,e,r,a,n,s){return e=cu(cu(e,t),cu(a,s)),cu(e<<n|e>>>32-n,r)}function Es(t,e,r,a,n,s,o){return _1(e&r|~e&a,t,e,n,s,o)}function As(t,e,r,a,n,s,o){return _1(e&a|r&~a,t,e,n,s,o)}function Cs(t,e,r,a,n,s,o){return _1(e^r^a,t,e,n,s,o)}function Ts(t,e,r,a,n,s,o){return _1(r^(e|~a),t,e,n,s,o)}function Fk(t){var e,r=t.length,a=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Av(a,Xq(t.substring(e-64,e)));t=t.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)n[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(Av(a,n),e=0;e<16;e++)n[e]=0;return n[14]=8*r,Av(a,n),a}function Xq(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var Z5="0123456789abcdef".split("");function Kq(t){for(var e="",r=0;r<4;r++)e+=Z5[t>>8*r+4&15]+Z5[t>>8*r&15];return e}function Jq(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function A2(t){return Fk(t).map(Jq).join("")}var Zq=(function(t){for(var e=0;e<t.length;e++)t[e]=Kq(t[e]);return t.join("")})(Fk("hello"))!="5d41402abc4b2a76b9719d911017c592";function cu(t,e){if(Zq){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}function C2(t,e){var r,a,n,s;if(t!==r){for(var o=(n=t,s=1+(256/t.length|0),new Array(s+1).join(n)),u=[],f=0;f<256;f++)u[f]=f;var h=0;for(f=0;f<256;f++){var m=u[f];h=(h+m+o.charCodeAt(f))%256,u[f]=u[h],u[h]=m}r=t,a=u}else u=a;var v=e.length,y=0,g=0,b="";for(f=0;f<v;f++)g=(g+(m=u[y=(y+1)%256]))%256,u[y]=u[g],u[g]=m,o=u[(u[y]+u[g])%256],b+=String.fromCharCode(e.charCodeAt(f)^o);return b}var Q5={print:4,modify:8,copy:16,"annot-forms":32};function Uh(t,e,r,a){this.v=1,this.r=2;var n=192;t.forEach(function(u){if(Q5.perm!==void 0)throw new Error("Invalid permission: "+u);n+=Q5[u]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^n)),this.encryptionKey=A2(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=C2(this.encryptionKey,this.padding)}function qh(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,a=0;a<r;a++){var n=t.charCodeAt(a);e+=n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?"#"+("0"+n.toString(16)).slice(-2):t[a]}return e}function eS(t){if(va(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var s=Math.random().toString(35);return e[r][s]=[a,!!n],s},this.unsubscribe=function(r){for(var a in e)if(e[a][r])return delete e[a][r],Object.keys(e[a]).length===0&&delete e[a],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var s in e[r]){var o=e[r][s];try{o[0].apply(t,a)}catch(u){wr.console&&Oa.error("jsPDF PubSub Error",u.message,u)}o[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function e1(t){if(!(this instanceof e1))return new e1(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function Lk(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function sf(t,e,r,a,n){if(!(this instanceof sf))return new sf(t,e,r,a,n);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,Lk.call(this,a,n)}function Hh(t,e,r,a,n){if(!(this instanceof Hh))return new Hh(t,e,r,a,n);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,Lk.call(this,a,n)}function sr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],s=arguments[3],o=[],u=1,f=16,h="S",m=null;va(t=t||{})==="object"&&(r=t.orientation,a=t.unit||a,n=t.format||n,s=t.compress||t.compressPdf||s,(m=t.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),u=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(f=t.floatPrecision),h=t.defaultPathOperation||"S"),o=t.filters||(s===!0?["FlateEncode"]:o),a=a||"mm",r=(""+(r||"P")).toLowerCase();var v=t.putOnlyUsedFonts||!1,y={},g={internal:{},__private__:{}};g.__private__.PubSub=eS;var b="1.3",_=g.__private__.getPdfVersion=function(){return b};g.__private__.setPdfVersion=function(T){b=T};var S={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return S};var E=g.__private__.getPageFormat=function(T){return S[T]};n=n||"a4";var C="compat",j="advanced",R=C;function H(){this.saveGraphicsState(),re(new _t(ft,0,0,-ft,0,wo()*ft).toString()+" cm"),this.setFontSize(this.getFontSize()/ft),h="n",R=j}function Y(){this.restoreGraphicsState(),h="S",R=C}var U=g.__private__.combineFontStyleAndFontWeight=function(T,J){if(T=="bold"&&J=="normal"||T=="bold"&&J==400||T=="normal"&&J=="italic"||T=="bold"&&J=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return J&&(T=J==400||J==="normal"?T==="italic"?"italic":"normal":J!=700&&J!=="bold"||T!=="normal"?(J==700?"bold":J)+""+T:"bold"),T};g.advancedAPI=function(T){var J=R===C;return J&&H.call(this),typeof T!="function"||(T(this),J&&Y.call(this)),this},g.compatAPI=function(T){var J=R===j;return J&&Y.call(this),typeof T!="function"||(T(this),J&&H.call(this)),this},g.isAdvancedAPI=function(){return R===j};var V,F=function(T){if(R!==j)throw new Error(T+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},X=g.roundToPrecision=g.__private__.roundToPrecision=function(T,J){var Ee=e||J;if(isNaN(T)||isNaN(Ee))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return T.toFixed(Ee).replace(/0+$/,"")};V=g.hpf=g.__private__.hpf=typeof f=="number"?function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.hpf");return X(T,f)}:f==="smart"?function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.hpf");return X(T,T>-1&&T<1?16:5)}:function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.hpf");return X(T,16)};var P=g.f2=g.__private__.f2=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.f2");return X(T,2)},O=g.__private__.f3=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.f3");return X(T,3)},I=g.scale=g.__private__.scale=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.scale");return R===C?T*ft:R===j?T:void 0},W=function(T){return I((function(J){return R===C?wo()-J:R===j?J:void 0})(T))};g.__private__.setPrecision=g.setPrecision=function(T){typeof parseInt(T,10)=="number"&&(e=parseInt(T,10))};var ne,Q="00000000000000000000000000000000",le=g.__private__.getFileId=function(){return Q},ee=g.__private__.setFileId=function(T){return Q=T!==void 0&&/^[a-fA-F0-9]{32}$/.test(T)?T.toUpperCase():Q.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(vn=new Uh(m.userPermissions,m.userPassword,m.ownerPassword,Q)),Q};g.setFileId=function(T){return ee(T),this},g.getFileId=function(){return le()};var K=g.__private__.convertDateToPDFDate=function(T){var J=T.getTimezoneOffset(),Ee=J<0?"+":"-",Re=Math.floor(Math.abs(J/60)),qe=Math.abs(J%60),ht=[Ee,B(Re),"'",B(qe),"'"].join("");return["D:",T.getFullYear(),B(T.getMonth()+1),B(T.getDate()),B(T.getHours()),B(T.getMinutes()),B(T.getSeconds()),ht].join("")},ue=g.__private__.convertPDFDateToDate=function(T){var J=parseInt(T.substr(2,4),10),Ee=parseInt(T.substr(6,2),10)-1,Re=parseInt(T.substr(8,2),10),qe=parseInt(T.substr(10,2),10),ht=parseInt(T.substr(12,2),10),bt=parseInt(T.substr(14,2),10);return new Date(J,Ee,Re,qe,ht,bt,0)},M=g.__private__.setCreationDate=function(T){var J;if(T===void 0&&(T=new Date),T instanceof Date)J=K(T);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(T))throw new Error("Invalid argument passed to jsPDF.setCreationDate");J=T}return ne=J},A=g.__private__.getCreationDate=function(T){var J=ne;return T==="jsDate"&&(J=ue(ne)),J};g.setCreationDate=function(T){return M(T),this},g.getCreationDate=function(T){return A(T)};var D,B=g.__private__.padd2=function(T){return("0"+parseInt(T)).slice(-2)},q=g.__private__.padd2Hex=function(T){return("00"+(T=T.toString())).substr(T.length)},Z=0,oe=[],pe=[],_e=0,be=[],Le=[],he=!1,Ae=pe;g.__private__.setCustomOutputDestination=function(T){he=!0,Ae=T};var de=function(T){he||(Ae=T)};g.__private__.resetCustomOutputDestination=function(){he=!1,Ae=pe};var re=g.__private__.out=function(T){return T=T.toString(),_e+=T.length+1,Ae.push(T),Ae},Ke=g.__private__.write=function(T){return re(arguments.length===1?T.toString():Array.prototype.join.call(arguments," "))},Oe=g.__private__.getArrayBuffer=function(T){for(var J=T.length,Ee=new ArrayBuffer(J),Re=new Uint8Array(Ee);J--;)Re[J]=T.charCodeAt(J);return Ee},rt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return rt};var tt=t.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(T){return tt=R===j?T/ft:T,this};var Et,kt=g.__private__.getFontSize=g.getFontSize=function(){return R===C?tt:tt*ft},zt=t.R2L||!1;g.__private__.setR2L=g.setR2L=function(T){return zt=T,this},g.__private__.getR2L=g.getR2L=function(){return zt};var Tt,at=g.__private__.setZoomMode=function(T){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(T))Et=T;else if(isNaN(T)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(T)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+T+'" is not recognized.');Et=T}else Et=parseInt(T,10)};g.__private__.getZoomMode=function(){return Et};var pt,At=g.__private__.setPageMode=function(T){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(T)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+T+'" is not recognized.');Tt=T};g.__private__.getPageMode=function(){return Tt};var Dt=g.__private__.setLayoutMode=function(T){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(T)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+T+'" is not recognized.');pt=T};g.__private__.getLayoutMode=function(){return pt},g.__private__.setDisplayMode=g.setDisplayMode=function(T,J,Ee){return at(T),Dt(J),At(Ee),this};var xt={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(T){if(Object.keys(xt).indexOf(T)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return xt[T]},g.__private__.getDocumentProperties=function(){return xt},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(T){for(var J in xt)xt.hasOwnProperty(J)&&T[J]&&(xt[J]=T[J]);return this},g.__private__.setDocumentProperty=function(T,J){if(Object.keys(xt).indexOf(T)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return xt[T]=J};var St,ft,yt,er,Lt,Bt={},we={},Ie=[],ve={},Ue={},Be={},Rt={},Ht=null,Kt=0,$t=[],Nr=new eS(g),Jn=t.hotfixes||[],ja={},Ct={},Ha=[],_t=function T(J,Ee,Re,qe,ht,bt){if(!(this instanceof T))return new T(J,Ee,Re,qe,ht,bt);isNaN(J)&&(J=1),isNaN(Ee)&&(Ee=0),isNaN(Re)&&(Re=0),isNaN(qe)&&(qe=1),isNaN(ht)&&(ht=0),isNaN(bt)&&(bt=0),this._matrix=[J,Ee,Re,qe,ht,bt]};Object.defineProperty(_t.prototype,"sx",{get:function(){return this._matrix[0]},set:function(T){this._matrix[0]=T}}),Object.defineProperty(_t.prototype,"shy",{get:function(){return this._matrix[1]},set:function(T){this._matrix[1]=T}}),Object.defineProperty(_t.prototype,"shx",{get:function(){return this._matrix[2]},set:function(T){this._matrix[2]=T}}),Object.defineProperty(_t.prototype,"sy",{get:function(){return this._matrix[3]},set:function(T){this._matrix[3]=T}}),Object.defineProperty(_t.prototype,"tx",{get:function(){return this._matrix[4]},set:function(T){this._matrix[4]=T}}),Object.defineProperty(_t.prototype,"ty",{get:function(){return this._matrix[5]},set:function(T){this._matrix[5]=T}}),Object.defineProperty(_t.prototype,"a",{get:function(){return this._matrix[0]},set:function(T){this._matrix[0]=T}}),Object.defineProperty(_t.prototype,"b",{get:function(){return this._matrix[1]},set:function(T){this._matrix[1]=T}}),Object.defineProperty(_t.prototype,"c",{get:function(){return this._matrix[2]},set:function(T){this._matrix[2]=T}}),Object.defineProperty(_t.prototype,"d",{get:function(){return this._matrix[3]},set:function(T){this._matrix[3]=T}}),Object.defineProperty(_t.prototype,"e",{get:function(){return this._matrix[4]},set:function(T){this._matrix[4]=T}}),Object.defineProperty(_t.prototype,"f",{get:function(){return this._matrix[5]},set:function(T){this._matrix[5]=T}}),Object.defineProperty(_t.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(_t.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(_t.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(_t.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),_t.prototype.join=function(T){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(V).join(T)},_t.prototype.multiply=function(T){var J=T.sx*this.sx+T.shy*this.shx,Ee=T.sx*this.shy+T.shy*this.sy,Re=T.shx*this.sx+T.sy*this.shx,qe=T.shx*this.shy+T.sy*this.sy,ht=T.tx*this.sx+T.ty*this.shx+this.tx,bt=T.tx*this.shy+T.ty*this.sy+this.ty;return new _t(J,Ee,Re,qe,ht,bt)},_t.prototype.decompose=function(){var T=this.sx,J=this.shy,Ee=this.shx,Re=this.sy,qe=this.tx,ht=this.ty,bt=Math.sqrt(T*T+J*J),Jt=(T/=bt)*Ee+(J/=bt)*Re;Ee-=T*Jt,Re-=J*Jt;var ar=Math.sqrt(Ee*Ee+Re*Re);return Jt/=ar,T*(Re/=ar)<J*(Ee/=ar)&&(T=-T,J=-J,Jt=-Jt,bt=-bt),{scale:new _t(bt,0,0,ar,0,0),translate:new _t(1,0,0,1,qe,ht),rotate:new _t(T,J,-J,T,0,0),skew:new _t(1,0,Jt,1,0,0)}},_t.prototype.toString=function(T){return this.join(" ")},_t.prototype.inversed=function(){var T=this.sx,J=this.shy,Ee=this.shx,Re=this.sy,qe=this.tx,ht=this.ty,bt=1/(T*Re-J*Ee),Jt=Re*bt,ar=-J*bt,gr=-Ee*bt,kr=T*bt;return new _t(Jt,ar,gr,kr,-Jt*qe-gr*ht,-ar*qe-kr*ht)},_t.prototype.applyToPoint=function(T){var J=T.x*this.sx+T.y*this.shx+this.tx,Ee=T.x*this.shy+T.y*this.sy+this.ty;return new Xs(J,Ee)},_t.prototype.applyToRectangle=function(T){var J=this.applyToPoint(T),Ee=this.applyToPoint(new Xs(T.x+T.w,T.y+T.h));return new vo(J.x,J.y,Ee.x-J.x,Ee.y-J.y)},_t.prototype.clone=function(){var T=this.sx,J=this.shy,Ee=this.shx,Re=this.sy,qe=this.tx,ht=this.ty;return new _t(T,J,Ee,Re,qe,ht)},g.Matrix=_t;var mr=g.matrixMult=function(T,J){return J.multiply(T)},Jr=new _t(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=Jr;var qr=function(T,J){if(!Ue[T]){var Ee=(J instanceof sf?"Sh":"P")+(Object.keys(ve).length+1).toString(10);J.id=Ee,Ue[T]=Ee,ve[Ee]=J,Nr.publish("addPattern",J)}};g.ShadingPattern=sf,g.TilingPattern=Hh,g.addShadingPattern=function(T,J){return F("addShadingPattern()"),qr(T,J),this},g.beginTilingPattern=function(T){F("beginTilingPattern()"),Fl(T.boundingBox[0],T.boundingBox[1],T.boundingBox[2]-T.boundingBox[0],T.boundingBox[3]-T.boundingBox[1],T.matrix)},g.endTilingPattern=function(T,J){F("endTilingPattern()"),J.stream=Le[D].join(`
`),qr(T,J),Nr.publish("endTilingPattern",J),Ha.pop().restore()};var Xa,$r=g.__private__.newObject=function(){var T=Ea();return ae(T,!0),T},Ea=g.__private__.newObjectDeferred=function(){return Z++,oe[Z]=function(){return _e},Z},ae=function(T,J){return J=typeof J=="boolean"&&J,oe[T]=_e,J&&re(T+" 0 obj"),T},je=g.__private__.newAdditionalObject=function(){var T={objId:Ea(),content:""};return be.push(T),T},ge=Ea(),xe=Ea(),Se=g.__private__.decodeColorString=function(T){var J=T.split(" ");if(J.length!==2||J[1]!=="g"&&J[1]!=="G")J.length!==5||J[4]!=="k"&&J[4]!=="K"||(J=[(1-J[0])*(1-J[3]),(1-J[1])*(1-J[3]),(1-J[2])*(1-J[3]),"r"]);else{var Ee=parseFloat(J[0]);J=[Ee,Ee,Ee,"r"]}for(var Re="#",qe=0;qe<3;qe++)Re+=("0"+Math.floor(255*parseFloat(J[qe])).toString(16)).slice(-2);return Re},Ce=g.__private__.encodeColorString=function(T){var J;typeof T=="string"&&(T={ch1:T});var Ee=T.ch1,Re=T.ch2,qe=T.ch3,ht=T.ch4,bt=T.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ee=="string"&&Ee.charAt(0)!=="#"){var Jt=new Dk(Ee);if(Jt.ok)Ee=Jt.toHex();else if(!/^\d*\.?\d*$/.test(Ee))throw new Error('Invalid color "'+Ee+'" passed to jsPDF.encodeColorString.')}if(typeof Ee=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ee)&&(Ee="#"+Ee[1]+Ee[1]+Ee[2]+Ee[2]+Ee[3]+Ee[3]),typeof Ee=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ee)){var ar=parseInt(Ee.substr(1),16);Ee=ar>>16&255,Re=ar>>8&255,qe=255&ar}if(Re===void 0||ht===void 0&&Ee===Re&&Re===qe)J=typeof Ee=="string"?Ee+" "+bt[0]:T.precision===2?P(Ee/255)+" "+bt[0]:O(Ee/255)+" "+bt[0];else if(ht===void 0||va(ht)==="object"){if(ht&&!isNaN(ht.a)&&ht.a===0)return["1.","1.","1.",bt[1]].join(" ");J=typeof Ee=="string"?[Ee,Re,qe,bt[1]].join(" "):T.precision===2?[P(Ee/255),P(Re/255),P(qe/255),bt[1]].join(" "):[O(Ee/255),O(Re/255),O(qe/255),bt[1]].join(" ")}else J=typeof Ee=="string"?[Ee,Re,qe,ht,bt[2]].join(" "):T.precision===2?[P(Ee),P(Re),P(qe),P(ht),bt[2]].join(" "):[O(Ee),O(Re),O(qe),O(ht),bt[2]].join(" ");return J},We=g.__private__.getFilters=function(){return o},st=g.__private__.putStream=function(T){var J=(T=T||{}).data||"",Ee=T.filters||We(),Re=T.alreadyAppliedFilters||[],qe=T.addLength1||!1,ht=J.length,bt=T.objectId,Jt=function(xn){return xn};if(m!==null&&bt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(Jt=vn.encryptor(bt,0));var ar={};Ee===!0&&(Ee=["FlateEncode"]);var gr=T.additionalKeyValues||[],kr=(ar=sr.API.processDataByFilters!==void 0?sr.API.processDataByFilters(J,Ee):{data:J,reverseChain:[]}).reverseChain+(Array.isArray(Re)?Re.join(" "):Re.toString());if(ar.data.length!==0&&(gr.push({key:"Length",value:ar.data.length}),qe===!0&&gr.push({key:"Length1",value:ht})),kr.length!=0)if(kr.split("/").length-1==1)gr.push({key:"Filter",value:kr});else{gr.push({key:"Filter",value:"["+kr+"]"});for(var Wr=0;Wr<gr.length;Wr+=1)if(gr[Wr].key==="DecodeParms"){for(var Fa=[],Ka=0;Ka<ar.reverseChain.split("/").length-1;Ka+=1)Fa.push("null");Fa.push(gr[Wr].value),gr[Wr].value="["+Fa.join(" ")+"]"}}re("<<");for(var ya=0;ya<gr.length;ya++)re("/"+gr[ya].key+" "+gr[ya].value);re(">>"),ar.data.length!==0&&(re("stream"),re(Jt(ar.data)),re("endstream"))},Ge=g.__private__.putPage=function(T){var J=T.number,Ee=T.data,Re=T.objId,qe=T.contentsObjId;ae(Re,!0),re("<</Type /Page"),re("/Parent "+T.rootDictionaryObjId+" 0 R"),re("/Resources "+T.resourceDictionaryObjId+" 0 R"),re("/MediaBox ["+parseFloat(V(T.mediaBox.bottomLeftX))+" "+parseFloat(V(T.mediaBox.bottomLeftY))+" "+V(T.mediaBox.topRightX)+" "+V(T.mediaBox.topRightY)+"]"),T.cropBox!==null&&re("/CropBox ["+V(T.cropBox.bottomLeftX)+" "+V(T.cropBox.bottomLeftY)+" "+V(T.cropBox.topRightX)+" "+V(T.cropBox.topRightY)+"]"),T.bleedBox!==null&&re("/BleedBox ["+V(T.bleedBox.bottomLeftX)+" "+V(T.bleedBox.bottomLeftY)+" "+V(T.bleedBox.topRightX)+" "+V(T.bleedBox.topRightY)+"]"),T.trimBox!==null&&re("/TrimBox ["+V(T.trimBox.bottomLeftX)+" "+V(T.trimBox.bottomLeftY)+" "+V(T.trimBox.topRightX)+" "+V(T.trimBox.topRightY)+"]"),T.artBox!==null&&re("/ArtBox ["+V(T.artBox.bottomLeftX)+" "+V(T.artBox.bottomLeftY)+" "+V(T.artBox.topRightX)+" "+V(T.artBox.topRightY)+"]"),typeof T.userUnit=="number"&&T.userUnit!==1&&re("/UserUnit "+T.userUnit),Nr.publish("putPage",{objId:Re,pageContext:$t[J],pageNumber:J,page:Ee}),re("/Contents "+qe+" 0 R"),re(">>"),re("endobj");var ht=Ee.join(`
`);return R===j&&(ht+=`
Q`),ae(qe,!0),st({data:ht,filters:We(),objectId:qe}),re("endobj"),Re},Ye=g.__private__.putPages=function(){var T,J,Ee=[];for(T=1;T<=Kt;T++)$t[T].objId=Ea(),$t[T].contentsObjId=Ea();for(T=1;T<=Kt;T++)Ee.push(Ge({number:T,data:Le[T],objId:$t[T].objId,contentsObjId:$t[T].contentsObjId,mediaBox:$t[T].mediaBox,cropBox:$t[T].cropBox,bleedBox:$t[T].bleedBox,trimBox:$t[T].trimBox,artBox:$t[T].artBox,userUnit:$t[T].userUnit,rootDictionaryObjId:ge,resourceDictionaryObjId:xe}));ae(ge,!0),re("<</Type /Pages");var Re="/Kids [";for(J=0;J<Kt;J++)Re+=Ee[J]+" 0 R ";re(Re+"]"),re("/Count "+Kt),re(">>"),re("endobj"),Nr.publish("postPutPages")},Je=function(T){Nr.publish("putFont",{font:T,out:re,newObject:$r,putStream:st}),T.isAlreadyPutted!==!0&&(T.objectNumber=$r(),re("<<"),re("/Type /Font"),re("/BaseFont /"+qh(T.postScriptName)),re("/Subtype /Type1"),typeof T.encoding=="string"&&re("/Encoding /"+T.encoding),re("/FirstChar 32"),re("/LastChar 255"),re(">>"),re("endobj"))},Nt=function(T){T.objectNumber=$r();var J=[];J.push({key:"Type",value:"/XObject"}),J.push({key:"Subtype",value:"/Form"}),J.push({key:"BBox",value:"["+[V(T.x),V(T.y),V(T.x+T.width),V(T.y+T.height)].join(" ")+"]"}),J.push({key:"Matrix",value:"["+T.matrix.toString()+"]"});var Ee=T.pages[1].join(`
`);st({data:Ee,additionalKeyValues:J,objectId:T.objectNumber}),re("endobj")},Ft=function(T,J){J||(J=21);var Ee=$r(),Re=(function(bt,Jt){var ar,gr=[],kr=1/(Jt-1);for(ar=0;ar<1;ar+=kr)gr.push(ar);if(gr.push(1),bt[0].offset!=0){var Wr={offset:0,color:bt[0].color};bt.unshift(Wr)}if(bt[bt.length-1].offset!=1){var Fa={offset:1,color:bt[bt.length-1].color};bt.push(Fa)}for(var Ka="",ya=0,xn=0;xn<gr.length;xn++){for(ar=gr[xn];ar>bt[ya+1].offset;)ya++;var sn=bt[ya].offset,Bn=(ar-sn)/(bt[ya+1].offset-sn),So=bt[ya].color,_i=bt[ya+1].color;Ka+=q(Math.round((1-Bn)*So[0]+Bn*_i[0]).toString(16))+q(Math.round((1-Bn)*So[1]+Bn*_i[1]).toString(16))+q(Math.round((1-Bn)*So[2]+Bn*_i[2]).toString(16))}return Ka.trim()})(T.colors,J),qe=[];qe.push({key:"FunctionType",value:"0"}),qe.push({key:"Domain",value:"[0.0 1.0]"}),qe.push({key:"Size",value:"["+J+"]"}),qe.push({key:"BitsPerSample",value:"8"}),qe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),st({data:Re,additionalKeyValues:qe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ee}),re("endobj"),T.objectNumber=$r(),re("<< /ShadingType "+T.type),re("/ColorSpace /DeviceRGB");var ht="/Coords ["+V(parseFloat(T.coords[0]))+" "+V(parseFloat(T.coords[1]))+" ";T.type===2?ht+=V(parseFloat(T.coords[2]))+" "+V(parseFloat(T.coords[3])):ht+=V(parseFloat(T.coords[2]))+" "+V(parseFloat(T.coords[3]))+" "+V(parseFloat(T.coords[4]))+" "+V(parseFloat(T.coords[5])),re(ht+="]"),T.matrix&&re("/Matrix ["+T.matrix.toString()+"]"),re("/Function "+Ee+" 0 R"),re("/Extend [true true]"),re(">>"),re("endobj")},qt=function(T,J){var Ee=Ea(),Re=$r();J.push({resourcesOid:Ee,objectOid:Re}),T.objectNumber=Re;var qe=[];qe.push({key:"Type",value:"/Pattern"}),qe.push({key:"PatternType",value:"1"}),qe.push({key:"PaintType",value:"1"}),qe.push({key:"TilingType",value:"1"}),qe.push({key:"BBox",value:"["+T.boundingBox.map(V).join(" ")+"]"}),qe.push({key:"XStep",value:V(T.xStep)}),qe.push({key:"YStep",value:V(T.yStep)}),qe.push({key:"Resources",value:Ee+" 0 R"}),T.matrix&&qe.push({key:"Matrix",value:"["+T.matrix.toString()+"]"}),st({data:T.stream,additionalKeyValues:qe,objectId:T.objectNumber}),re("endobj")},Ot=function(T){for(var J in T.objectNumber=$r(),re("<<"),T)switch(J){case"opacity":re("/ca "+P(T[J]));break;case"stroke-opacity":re("/CA "+P(T[J]))}re(">>"),re("endobj")},Mt=function(T){ae(T.resourcesOid,!0),re("<<"),re("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var J in re("/Font <<"),Bt)Bt.hasOwnProperty(J)&&(v===!1||v===!0&&y.hasOwnProperty(J))&&re("/"+J+" "+Bt[J].objectNumber+" 0 R");re(">>")})(),(function(){if(Object.keys(ve).length>0){for(var J in re("/Shading <<"),ve)ve.hasOwnProperty(J)&&ve[J]instanceof sf&&ve[J].objectNumber>=0&&re("/"+J+" "+ve[J].objectNumber+" 0 R");Nr.publish("putShadingPatternDict"),re(">>")}})(),(function(J){if(Object.keys(ve).length>0){for(var Ee in re("/Pattern <<"),ve)ve.hasOwnProperty(Ee)&&ve[Ee]instanceof g.TilingPattern&&ve[Ee].objectNumber>=0&&ve[Ee].objectNumber<J&&re("/"+Ee+" "+ve[Ee].objectNumber+" 0 R");Nr.publish("putTilingPatternDict"),re(">>")}})(T.objectOid),(function(){if(Object.keys(Be).length>0){var J;for(J in re("/ExtGState <<"),Be)Be.hasOwnProperty(J)&&Be[J].objectNumber>=0&&re("/"+J+" "+Be[J].objectNumber+" 0 R");Nr.publish("putGStateDict"),re(">>")}})(),(function(){for(var J in re("/XObject <<"),ja)ja.hasOwnProperty(J)&&ja[J].objectNumber>=0&&re("/"+J+" "+ja[J].objectNumber+" 0 R");Nr.publish("putXobjectDict"),re(">>")})(),re(">>"),re("endobj")},Yt=function(T){we[T.fontName]=we[T.fontName]||{},we[T.fontName][T.fontStyle]=T.id},oa=function(T,J,Ee,Re,qe){var ht={id:"F"+(Object.keys(Bt).length+1).toString(10),postScriptName:T,fontName:J,fontStyle:Ee,encoding:Re,isStandardFont:qe||!1,metadata:{}};return Nr.publish("addFont",{font:ht,instance:this}),Bt[ht.id]=ht,Yt(ht),ht.id},Fr=g.__private__.pdfEscape=g.pdfEscape=function(T,J){return(function(Ee,Re){var qe,ht,bt,Jt,ar,gr,kr,Wr,Fa;if(bt=(Re=Re||{}).sourceEncoding||"Unicode",ar=Re.outputEncoding,(Re.autoencode||ar)&&Bt[St].metadata&&Bt[St].metadata[bt]&&Bt[St].metadata[bt].encoding&&(Jt=Bt[St].metadata[bt].encoding,!ar&&Bt[St].encoding&&(ar=Bt[St].encoding),!ar&&Jt.codePages&&(ar=Jt.codePages[0]),typeof ar=="string"&&(ar=Jt[ar]),ar)){for(kr=!1,gr=[],qe=0,ht=Ee.length;qe<ht;qe++)(Wr=ar[Ee.charCodeAt(qe)])?gr.push(String.fromCharCode(Wr)):gr.push(Ee[qe]),gr[qe].charCodeAt(0)>>8&&(kr=!0);Ee=gr.join("")}for(qe=Ee.length;kr===void 0&&qe!==0;)Ee.charCodeAt(qe-1)>>8&&(kr=!0),qe--;if(!kr)return Ee;for(gr=Re.noBOM?[]:[254,255],qe=0,ht=Ee.length;qe<ht;qe++){if((Fa=(Wr=Ee.charCodeAt(qe))>>8)>>8)throw new Error("Character at position "+qe+" of string '"+Ee+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");gr.push(Fa),gr.push(Wr-(Fa<<8))}return String.fromCharCode.apply(void 0,gr)})(T,J).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},fa=g.__private__.beginPage=function(T){Le[++Kt]=[],$t[Kt]={objId:0,contentsObjId:0,userUnit:Number(u),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(T[0]),topRightY:Number(T[1])}},gi(Kt),de(Le[D])},ls=function(T,J){var Ee,Re,qe;switch(r=J||r,typeof T=="string"&&(Ee=E(T.toLowerCase()),Array.isArray(Ee)&&(Re=Ee[0],qe=Ee[1])),Array.isArray(T)&&(Re=T[0]*ft,qe=T[1]*ft),isNaN(Re)&&(Re=n[0],qe=n[1]),(Re>14400||qe>14400)&&(Oa.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Re=Math.min(14400,Re),qe=Math.min(14400,qe)),n=[Re,qe],r.substr(0,1)){case"l":qe>Re&&(n=[qe,Re]);break;case"p":Re>qe&&(n=[qe,Re])}fa(n),hr(Ol),re(Us),bc!==0&&re(bc+" J"),Cn!==0&&re(Cn+" j"),Nr.publish("addPage",{pageNumber:Kt})},pi=function(T){T>0&&T<=Kt&&(Le.splice(T,1),$t.splice(T,1),Kt--,D>Kt&&(D=Kt),this.setPage(D))},gi=function(T){T>0&&T<=Kt&&(D=T)},Is=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return Le.length-1},Qo=function(T,J,Ee){var Re,qe=void 0;return Ee=Ee||{},T=T!==void 0?T:Bt[St].fontName,J=J!==void 0?J:Bt[St].fontStyle,Re=T.toLowerCase(),we[Re]!==void 0&&we[Re][J]!==void 0?qe=we[Re][J]:we[T]!==void 0&&we[T][J]!==void 0?qe=we[T][J]:Ee.disableWarning===!1&&Oa.warn("Unable to look up font label for font '"+T+"', '"+J+"'. Refer to getFontList() for available fonts."),qe||Ee.noFallback||(qe=we.times[J])==null&&(qe=we.times.normal),qe},Da=g.__private__.putInfo=function(){var T=$r(),J=function(Re){return Re};for(var Ee in m!==null&&(J=vn.encryptor(T,0)),re("<<"),re("/Producer ("+Fr(J("jsPDF "+sr.version))+")"),xt)xt.hasOwnProperty(Ee)&&xt[Ee]&&re("/"+Ee.substr(0,1).toUpperCase()+Ee.substr(1)+" ("+Fr(J(xt[Ee]))+")");re("/CreationDate ("+Fr(J(ne))+")"),re(">>"),re("endobj")},po=g.__private__.putCatalog=function(T){var J=(T=T||{}).rootDictionaryObjId||ge;switch($r(),re("<<"),re("/Type /Catalog"),re("/Pages "+J+" 0 R"),Et||(Et="fullwidth"),Et){case"fullwidth":re("/OpenAction [3 0 R /FitH null]");break;case"fullheight":re("/OpenAction [3 0 R /FitV null]");break;case"fullpage":re("/OpenAction [3 0 R /Fit]");break;case"original":re("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ee=""+Et;Ee.substr(Ee.length-1)==="%"&&(Et=parseInt(Et)/100),typeof Et=="number"&&re("/OpenAction [3 0 R /XYZ null null "+P(Et)+"]")}switch(pt||(pt="continuous"),pt){case"continuous":re("/PageLayout /OneColumn");break;case"single":re("/PageLayout /SinglePage");break;case"two":case"twoleft":re("/PageLayout /TwoColumnLeft");break;case"tworight":re("/PageLayout /TwoColumnRight")}Tt&&re("/PageMode /"+Tt),Nr.publish("putCatalog"),re(">>"),re("endobj")},vi=g.__private__.putTrailer=function(){re("trailer"),re("<<"),re("/Size "+(Z+1)),re("/Root "+Z+" 0 R"),re("/Info "+(Z-1)+" 0 R"),m!==null&&re("/Encrypt "+vn.oid+" 0 R"),re("/ID [ <"+Q+"> <"+Q+"> ]"),re(">>")},Zr=g.__private__.putHeader=function(){re("%PDF-"+b),re("%")},bu=g.__private__.putXRef=function(){var T="0000000000";re("xref"),re("0 "+(Z+1)),re("0000000000 65535 f ");for(var J=1;J<=Z;J++)typeof oe[J]=="function"?re((T+oe[J]()).slice(-10)+" 00000 n "):oe[J]!==void 0?re((T+oe[J]).slice(-10)+" 00000 n "):re("0000000000 00000 n ")},zi=g.__private__.buildDocument=function(){var T;Z=0,_e=0,pe=[],oe=[],be=[],ge=Ea(),xe=Ea(),de(pe),Nr.publish("buildDocument"),Zr(),Ye(),(function(){Nr.publish("putAdditionalObjects");for(var Ee=0;Ee<be.length;Ee++){var Re=be[Ee];ae(Re.objId,!0),re(Re.content),re("endobj")}Nr.publish("postPutAdditionalObjects")})(),T=[],(function(){for(var Ee in Bt)Bt.hasOwnProperty(Ee)&&(v===!1||v===!0&&y.hasOwnProperty(Ee))&&Je(Bt[Ee])})(),(function(){var Ee;for(Ee in Be)Be.hasOwnProperty(Ee)&&Ot(Be[Ee])})(),(function(){for(var Ee in ja)ja.hasOwnProperty(Ee)&&Nt(ja[Ee])})(),(function(Ee){var Re;for(Re in ve)ve.hasOwnProperty(Re)&&(ve[Re]instanceof sf?Ft(ve[Re]):ve[Re]instanceof Hh&&qt(ve[Re],Ee))})(T),Nr.publish("putResources"),T.forEach(Mt),Mt({resourcesOid:xe,objectOid:Number.MAX_SAFE_INTEGER}),Nr.publish("postPutResources"),m!==null&&(vn.oid=$r(),re("<<"),re("/Filter /Standard"),re("/V "+vn.v),re("/R "+vn.r),re("/U <"+vn.toHexString(vn.U)+">"),re("/O <"+vn.toHexString(vn.O)+">"),re("/P "+vn.P),re(">>"),re("endobj")),Da(),po();var J=_e;return bu(),vi(),re("startxref"),re(""+J),re("%%EOF"),de(Le[D]),pe.join(`
`)},el=g.__private__.getBlob=function(T){return new Blob([Oe(T)],{type:"application/pdf"})},wu=g.output=g.__private__.output=(Xa=function(T,J){switch(typeof(J=J||{})=="string"?J={filename:J}:J.filename=J.filename||"generated.pdf",T){case void 0:return zi();case"save":g.save(J.filename);break;case"arraybuffer":return Oe(zi());case"blob":return el(zi());case"bloburi":case"bloburl":if(wr.URL!==void 0&&typeof wr.URL.createObjectURL=="function")return wr.URL&&wr.URL.createObjectURL(el(zi()))||void 0;Oa.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ee="",Re=zi();try{Ee=J5(Re)}catch{Ee=J5(unescape(encodeURIComponent(Re)))}return"data:application/pdf;filename="+J.filename+";base64,"+Ee;case"pdfobjectnewwindow":if(Object.prototype.toString.call(wr)==="[object Window]"){var qe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ht=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';J.pdfObjectUrl&&(qe=J.pdfObjectUrl,ht="");var bt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+qe+'"'+ht+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(J)+");<\/script></body></html>",Jt=wr.open();return Jt!==null&&Jt.document.write(bt),Jt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(wr)==="[object Window]"){var ar='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(J.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+J.filename+'" width="500px" height="400px" /></body></html>',gr=wr.open();if(gr!==null){gr.document.write(ar);var kr=this;gr.document.documentElement.querySelector("#pdfViewer").onload=function(){gr.document.title=J.filename,gr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(kr.output("bloburl"))}}return gr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(wr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Wr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",J)+'"></iframe></body></html>',Fa=wr.open();if(Fa!==null&&(Fa.document.write(Wr),Fa.document.title=J.filename),Fa||typeof safari>"u")return Fa;break;case"datauri":case"dataurl":return wr.document.location.href=this.output("datauristring",J);default:return null}},Xa.foo=function(){try{return Xa.apply(this,arguments)}catch(Ee){var T=Ee.stack||"";~T.indexOf(" at ")&&(T=T.split(" at ")[1]);var J="Error in function "+T.split(`
`)[0].split("<")[0]+": "+Ee.message;if(!wr.console)throw new Error(J);wr.console.error(J,Ee),wr.alert&&alert(J)}},Xa.foo.bar=Xa,Xa.foo),cs=function(T){return Array.isArray(Jn)===!0&&Jn.indexOf(T)>-1};switch(a){case"pt":ft=1;break;case"mm":ft=72/25.4;break;case"cm":ft=72/2.54;break;case"in":ft=72;break;case"px":ft=cs("px_scaling")==1?.75:96/72;break;case"pc":case"em":ft=12;break;case"ex":ft=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);ft=a}var vn=null;M(),ee();var nn=g.__private__.getPageInfo=g.getPageInfo=function(T){if(isNaN(T)||T%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:$t[T].objId,pageNumber:T,pageContext:$t[T]}},yc=g.__private__.getPageInfoByObjId=function(T){if(isNaN(T)||T%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var J in $t)if($t[J].objId===T)break;return nn(J)},Pf=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:$t[D].objId,pageNumber:D,pageContext:$t[D]}};g.addPage=function(){return ls.apply(this,arguments),this},g.setPage=function(){return gi.apply(this,arguments),de.call(this,Le[D]),this},g.insertPage=function(T){return this.addPage(),this.movePage(D,T),this},g.movePage=function(T,J){var Ee,Re;if(T>J){Ee=Le[T],Re=$t[T];for(var qe=T;qe>J;qe--)Le[qe]=Le[qe-1],$t[qe]=$t[qe-1];Le[J]=Ee,$t[J]=Re,this.setPage(J)}else if(T<J){Ee=Le[T],Re=$t[T];for(var ht=T;ht<J;ht++)Le[ht]=Le[ht+1],$t[ht]=$t[ht+1];Le[J]=Ee,$t[J]=Re,this.setPage(J)}return this},g.deletePage=function(){return pi.apply(this,arguments),this},g.__private__.text=g.text=function(T,J,Ee,Re,qe){var ht,bt,Jt,ar,gr,kr,Wr,Fa,Ka,ya=(Re=Re||{}).scope||this;if(typeof T=="number"&&typeof J=="number"&&(typeof Ee=="string"||Array.isArray(Ee))){var xn=Ee;Ee=J,J=T,T=xn}if(arguments[3]instanceof _t==0?(Jt=arguments[4],ar=arguments[5],va(Wr=arguments[3])==="object"&&Wr!==null||(typeof Jt=="string"&&(ar=Jt,Jt=null),typeof Wr=="string"&&(ar=Wr,Wr=null),typeof Wr=="number"&&(Jt=Wr,Wr=null),Re={flags:Wr,angle:Jt,align:ar})):(F("The transform parameter of text() with a Matrix value"),Ka=qe),isNaN(J)||isNaN(Ee)||T==null)throw new Error("Invalid arguments passed to jsPDF.text");if(T.length===0)return ya;var sn,Bn="",So=typeof Re.lineHeightFactor=="number"?Re.lineHeightFactor:go,_i=ya.internal.scaleFactor;function No(Qr){return Qr=Qr.split("	").join(Array(Re.TabLen||9).join(" ")),Fr(Qr,Wr)}function Ou(Qr){for(var Vr,_a=Qr.concat(),Za=[],Zi=_a.length;Zi--;)typeof(Vr=_a.shift())=="string"?Za.push(Vr):Array.isArray(Qr)&&(Vr.length===1||Vr[1]===void 0&&Vr[2]===void 0)?Za.push(Vr[0]):Za.push([Vr[0],Vr[1],Vr[2]]);return Za}function Sc(Qr,Vr){var _a;if(typeof Qr=="string")_a=Vr(Qr)[0];else if(Array.isArray(Qr)){for(var Za,Zi,Ni=Qr.concat(),Il=[],Fu=Ni.length;Fu--;)typeof(Za=Ni.shift())=="string"?Il.push(Vr(Za)[0]):Array.isArray(Za)&&typeof Za[0]=="string"&&(Zi=Vr(Za[0],Za[1],Za[2]),Il.push([Zi[0],Zi[1],Zi[2]]));_a=Il}return _a}var Wi=!1,bi=!0;if(typeof T=="string")Wi=!0;else if(Array.isArray(T)){var Pl=T.concat();bt=[];for(var ko,Tn=Pl.length;Tn--;)(typeof(ko=Pl.shift())!="string"||Array.isArray(ko)&&typeof ko[0]!="string")&&(bi=!1);Wi=bi}if(Wi===!1)throw new Error('Type of text must be string or Array. "'+T+'" is not recognized.');typeof T=="string"&&(T=T.match(/[\r?\n]/)?T.split(/\r\n|\r|\n/g):[T]);var rl=tt/ya.internal.scaleFactor,al=rl*(So-1);switch(Re.baseline){case"bottom":Ee-=al;break;case"top":Ee+=rl-al;break;case"hanging":Ee+=rl-2*al;break;case"middle":Ee+=rl/2-al}if((kr=Re.maxWidth||0)>0&&(typeof T=="string"?T=ya.splitTextToSize(T,kr):Object.prototype.toString.call(T)==="[object Array]"&&(T=T.reduce(function(Qr,Vr){return Qr.concat(ya.splitTextToSize(Vr,kr))},[]))),ht={text:T,x:J,y:Ee,options:Re,mutex:{pdfEscape:Fr,activeFontKey:St,fonts:Bt,activeFontSize:tt}},Nr.publish("preProcessText",ht),T=ht.text,Jt=(Re=ht.options).angle,Ka instanceof _t==0&&Jt&&typeof Jt=="number"){Jt*=Math.PI/180,Re.rotationDirection===0&&(Jt=-Jt),R===j&&(Jt=-Jt);var Nc=Math.cos(Jt),Vi=Math.sin(Jt);Ka=new _t(Nc,Vi,-Vi,Nc,0,0)}else Jt&&Jt instanceof _t&&(Ka=Jt);R!==j||Ka||(Ka=Jr),(gr=Re.charSpace||Ys)!==void 0&&(Bn+=V(I(gr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Fa=Re.horizontalScale)!==void 0&&(Bn+=V(100*Fa)+` Tz
`),Re.lang;var fs=-1,jo=Re.renderingMode!==void 0?Re.renderingMode:Re.stroke,kc=ya.internal.getCurrentPageInfo().pageContext;switch(jo){case 0:case!1:case"fill":fs=0;break;case 1:case!0:case"stroke":fs=1;break;case 2:case"fillThenStroke":fs=2;break;case 3:case"invisible":fs=3;break;case 4:case"fillAndAddForClipping":fs=4;break;case 5:case"strokeAndAddPathForClipping":fs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":fs=6;break;case 7:case"addToPathForClipping":fs=7}var Ru=kc.usedRenderingMode!==void 0?kc.usedRenderingMode:-1;fs!==-1?Bn+=fs+` Tr
`:Ru!==-1&&(Bn+=`0 Tr
`),fs!==-1&&(kc.usedRenderingMode=fs),ar=Re.align||"left";var qs,wi=tt*So,Eo=ya.internal.pageSize.getWidth(),Du=Bt[St];gr=Re.charSpace||Ys,kr=Re.maxWidth||0,Wr=Object.assign({autoencode:!0,noBOM:!0},Re.flags);var Si=[],nl=function(Qr){return ya.getStringUnitWidth(Qr,{font:Du,charSpace:gr,fontSize:tt,doKerning:!1})*tt/_i};if(Object.prototype.toString.call(T)==="[object Array]"){var ws;bt=Ou(T),ar!=="left"&&(qs=bt.map(nl));var hs,Gi=0;if(ar==="right"){J-=qs[0],T=[],Tn=bt.length;for(var Yi=0;Yi<Tn;Yi++)Yi===0?(hs=Bs(J),ws=In(Ee)):(hs=I(Gi-qs[Yi]),ws=-wi),T.push([bt[Yi],hs,ws]),Gi=qs[Yi]}else if(ar==="center"){J-=qs[0]/2,T=[],Tn=bt.length;for(var Ao=0;Ao<Tn;Ao++)Ao===0?(hs=Bs(J),ws=In(Ee)):(hs=I((Gi-qs[Ao])/2),ws=-wi),T.push([bt[Ao],hs,ws]),Gi=qs[Ao]}else if(ar==="left"){T=[],Tn=bt.length;for(var jc=0;jc<Tn;jc++)T.push(bt[jc])}else if(ar==="justify"&&Du.encoding==="Identity-H"){T=[],Tn=bt.length,kr=kr!==0?kr:Eo;for(var Ec=0,Ja=0;Ja<Tn;Ja++)if(ws=Ja===0?In(Ee):-wi,hs=Ja===0?Bs(J):Ec,Ja<Tn-1){var Wf=I((kr-qs[Ja])/(bt[Ja].split(" ").length-1)),Xi=bt[Ja].split(" ");T.push([Xi[0]+" ",hs,ws]),Ec=0;for(var Ki=1;Ki<Xi.length;Ki++){var Un=(nl(Xi[Ki-1]+" "+Xi[Ki])-nl(Xi[Ki]))*_i+Wf;Ki==Xi.length-1?T.push([Xi[Ki],Un,0]):T.push([Xi[Ki]+" ",Un,0]),Ec-=Un}}else T.push([bt[Ja],hs,ws]);T.push(["",Ec,0])}else{if(ar!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(T=[],Tn=bt.length,kr=kr!==0?kr:Eo,Ja=0;Ja<Tn;Ja++){ws=Ja===0?In(Ee):-wi,hs=Ja===0?Bs(J):0;var Co=bt[Ja].split(" ").length-1,Ac=Co>0?(kr-qs[Ja])/Co:0;Ja<Tn-1?Si.push(V(I(Ac))):Si.push(0),T.push([bt[Ja],hs,ws])}}}(typeof Re.R2L=="boolean"?Re.R2L:zt)===!0&&(T=Sc(T,function(Qr,Vr,_a){return[Qr.split("").reverse().join(""),Vr,_a]})),ht={text:T,x:J,y:Ee,options:Re,mutex:{pdfEscape:Fr,activeFontKey:St,fonts:Bt,activeFontSize:tt}},Nr.publish("postProcessText",ht),T=ht.text,sn=ht.mutex.isHex||!1;var Cc=Bt[St].encoding;Cc!=="WinAnsiEncoding"&&Cc!=="StandardEncoding"||(T=Sc(T,function(Qr,Vr,_a){return[No(Qr),Vr,_a]})),bt=Ou(T),T=[];for(var To,Oo,Ji,Ml=Array.isArray(bt[0])?1:0,zs="",Ro=function(Qr,Vr,_a){var Za="";return _a instanceof _t?(_a=typeof Re.angle=="number"?mr(_a,new _t(1,0,0,1,Qr,Vr)):mr(new _t(1,0,0,1,Qr,Vr),_a),R===j&&(_a=mr(new _t(1,0,0,-1,0,0),_a)),Za=_a.join(" ")+` Tm
`):Za=V(Qr)+" "+V(Vr)+` Td
`,Za},Zn=0;Zn<bt.length;Zn++){switch(zs="",Ml){case 1:Ji=(sn?"<":"(")+bt[Zn][0]+(sn?">":")"),To=parseFloat(bt[Zn][1]),Oo=parseFloat(bt[Zn][2]);break;case 0:Ji=(sn?"<":"(")+bt[Zn]+(sn?">":")"),To=Bs(J),Oo=In(Ee)}Si!==void 0&&Si[Zn]!==void 0&&(zs=Si[Zn]+` Tw
`),Zn===0?T.push(zs+Ro(To,Oo,Ka)+Ji):Ml===0?T.push(zs+Ji):Ml===1&&T.push(zs+Ro(To,Oo,Ka)+Ji)}T=Ml===0?T.join(` Tj
T* `):T.join(` Tj
`),T+=` Tj
`;var Ks=`BT
/`;return Ks+=St+" "+tt+` Tf
`,Ks+=V(tt*So)+` TL
`,Ks+=Hi+`
`,Ks+=Bn,Ks+=T,re(Ks+="ET"),y[St]=!0,ya};var Su=g.__private__.clip=g.clip=function(T){return re(T==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return Su("evenodd")},g.__private__.discardPath=g.discardPath=function(){return re("n"),this};var us=g.__private__.isValidStyle=function(T){var J=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(T)!==-1&&(J=!0),J};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(T){return us(T)&&(h=T),this};var Nu=g.__private__.getStyle=g.getStyle=function(T){var J=h;switch(T){case"D":case"S":J="S";break;case"F":J="f";break;case"FD":case"DF":J="B";break;case"f":case"f*":case"B":case"B*":J=T}return J},ku=g.close=function(){return re("h"),this};g.stroke=function(){return re("S"),this},g.fill=function(T){return xi("f",T),this},g.fillEvenOdd=function(T){return xi("f*",T),this},g.fillStroke=function(T){return xi("B",T),this},g.fillStrokeEvenOdd=function(T){return xi("B*",T),this};var xi=function(T,J){va(J)==="object"?If(J,T):re(T)},Tl=function(T){T===null||R===j&&T===void 0||(T=Nu(T),re(T))};function Mf(T,J,Ee,Re,qe){var ht=new Hh(J||this.boundingBox,Ee||this.xStep,Re||this.yStep,this.gState,qe||this.matrix);ht.stream=this.stream;var bt=T+"$$"+this.cloneIndex+++"$$";return qr(bt,ht),ht}var If=function(T,J){var Ee=Ue[T.key],Re=ve[Ee];if(Re instanceof sf)re("q"),re(ju(J)),Re.gState&&g.setGState(Re.gState),re(T.matrix.toString()+" cm"),re("/"+Ee+" sh"),re("Q");else if(Re instanceof Hh){var qe=new _t(1,0,0,-1,0,wo());T.matrix&&(qe=qe.multiply(T.matrix||Jr),Ee=Mf.call(Re,T.key,T.boundingBox,T.xStep,T.yStep,qe).id),re("q"),re("/Pattern cs"),re("/"+Ee+" scn"),Re.gState&&g.setGState(Re.gState),re(J),re("Q")}},ju=function(T){switch(T){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Eu=g.moveTo=function(T,J){return re(V(I(T))+" "+V(W(J))+" m"),this},Bf=g.lineTo=function(T,J){return re(V(I(T))+" "+V(W(J))+" l"),this},bs=g.curveTo=function(T,J,Ee,Re,qe,ht){return re([V(I(T)),V(W(J)),V(I(Ee)),V(W(Re)),V(I(qe)),V(W(ht)),"c"].join(" ")),this};g.__private__.line=g.line=function(T,J,Ee,Re,qe){if(isNaN(T)||isNaN(J)||isNaN(Ee)||isNaN(Re)||!us(qe))throw new Error("Invalid arguments passed to jsPDF.line");return R===C?this.lines([[Ee-T,Re-J]],T,J,[1,1],qe||"S"):this.lines([[Ee-T,Re-J]],T,J,[1,1]).stroke()},g.__private__.lines=g.lines=function(T,J,Ee,Re,qe,ht){var bt,Jt,ar,gr,kr,Wr,Fa,Ka,ya,xn,sn,Bn;if(typeof T=="number"&&(Bn=Ee,Ee=J,J=T,T=Bn),Re=Re||[1,1],ht=ht||!1,isNaN(J)||isNaN(Ee)||!Array.isArray(T)||!Array.isArray(Re)||!us(qe)||typeof ht!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Eu(J,Ee),bt=Re[0],Jt=Re[1],gr=T.length,xn=J,sn=Ee,ar=0;ar<gr;ar++)(kr=T[ar]).length===2?(xn=kr[0]*bt+xn,sn=kr[1]*Jt+sn,Bf(xn,sn)):(Wr=kr[0]*bt+xn,Fa=kr[1]*Jt+sn,Ka=kr[2]*bt+xn,ya=kr[3]*Jt+sn,xn=kr[4]*bt+xn,sn=kr[5]*Jt+sn,bs(Wr,Fa,Ka,ya,xn,sn));return ht&&ku(),Tl(qe),this},g.path=function(T){for(var J=0;J<T.length;J++){var Ee=T[J],Re=Ee.c;switch(Ee.op){case"m":Eu(Re[0],Re[1]);break;case"l":Bf(Re[0],Re[1]);break;case"c":bs.apply(this,Re);break;case"h":ku()}}return this},g.__private__.rect=g.rect=function(T,J,Ee,Re,qe){if(isNaN(T)||isNaN(J)||isNaN(Ee)||isNaN(Re)||!us(qe))throw new Error("Invalid arguments passed to jsPDF.rect");return R===C&&(Re=-Re),re([V(I(T)),V(W(J)),V(I(Ee)),V(I(Re)),"re"].join(" ")),Tl(qe),this},g.__private__.triangle=g.triangle=function(T,J,Ee,Re,qe,ht,bt){if(isNaN(T)||isNaN(J)||isNaN(Ee)||isNaN(Re)||isNaN(qe)||isNaN(ht)||!us(bt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ee-T,Re-J],[qe-Ee,ht-Re],[T-qe,J-ht]],T,J,[1,1],bt,!0),this},g.__private__.roundedRect=g.roundedRect=function(T,J,Ee,Re,qe,ht,bt){if(isNaN(T)||isNaN(J)||isNaN(Ee)||isNaN(Re)||isNaN(qe)||isNaN(ht)||!us(bt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Jt=4/3*(Math.SQRT2-1);return qe=Math.min(qe,.5*Ee),ht=Math.min(ht,.5*Re),this.lines([[Ee-2*qe,0],[qe*Jt,0,qe,ht-ht*Jt,qe,ht],[0,Re-2*ht],[0,ht*Jt,-qe*Jt,ht,-qe,ht],[2*qe-Ee,0],[-qe*Jt,0,-qe,-ht*Jt,-qe,-ht],[0,2*ht-Re],[0,-ht*Jt,qe*Jt,-ht,qe,-ht]],T+qe,J,[1,1],bt,!0),this},g.__private__.ellipse=g.ellipse=function(T,J,Ee,Re,qe){if(isNaN(T)||isNaN(J)||isNaN(Ee)||isNaN(Re)||!us(qe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ht=4/3*(Math.SQRT2-1)*Ee,bt=4/3*(Math.SQRT2-1)*Re;return Eu(T+Ee,J),bs(T+Ee,J-bt,T+ht,J-Re,T,J-Re),bs(T-ht,J-Re,T-Ee,J-bt,T-Ee,J),bs(T-Ee,J+bt,T-ht,J+Re,T,J+Re),bs(T+ht,J+Re,T+Ee,J+bt,T+Ee,J),Tl(qe),this},g.__private__.circle=g.circle=function(T,J,Ee,Re){if(isNaN(T)||isNaN(J)||isNaN(Ee)||!us(Re))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(T,J,Ee,Ee,Re)},g.setFont=function(T,J,Ee){return Ee&&(J=U(J,Ee)),St=Qo(T,J,{disableWarning:!1}),this};var yi=g.__private__.getFont=g.getFont=function(){return Bt[Qo.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var T,J,Ee={};for(T in we)if(we.hasOwnProperty(T))for(J in Ee[T]=[],we[T])we[T].hasOwnProperty(J)&&Ee[T].push(J);return Ee},g.addFont=function(T,J,Ee,Re,qe){var ht=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ht.indexOf(arguments[3])!==-1?qe=arguments[3]:arguments[3]&&ht.indexOf(arguments[3])==-1&&(Ee=U(Ee,Re)),oa.call(this,T,J,Ee,qe=qe||"Identity-H")};var go,Ol=t.lineWidth||.200025,tl=g.__private__.getLineWidth=g.getLineWidth=function(){return Ol},hr=g.__private__.setLineWidth=g.setLineWidth=function(T){return Ol=T,re(V(I(T))+" w"),this};g.__private__.setLineDash=sr.API.setLineDash=sr.API.setLineDashPattern=function(T,J){if(T=T||[],J=J||0,isNaN(J)||!Array.isArray(T))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return T=T.map(function(Ee){return V(I(Ee))}).join(" "),J=V(I(J)),re("["+T+"] "+J+" d"),this};var Uf=g.__private__.getLineHeight=g.getLineHeight=function(){return tt*go};g.__private__.getLineHeight=g.getLineHeight=function(){return tt*go};var Au=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(T){return typeof(T=T||1.15)=="number"&&(go=T),this},qf=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return go};Au(t.lineHeight);var Bs=g.__private__.getHorizontalCoordinate=function(T){return I(T)},In=g.__private__.getVerticalCoordinate=function(T){return R===j?T:$t[D].mediaBox.topRightY-$t[D].mediaBox.bottomLeftY-I(T)},Cu=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(T){return V(Bs(T))},Rl=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(T){return V(In(T))},Us=t.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return Se(Us)},g.__private__.setStrokeColor=g.setDrawColor=function(T,J,Ee,Re){return Us=Ce({ch1:T,ch2:J,ch3:Ee,ch4:Re,pdfColorType:"draw",precision:2}),re(Us),this};var Dl=t.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return Se(Dl)},g.__private__.setFillColor=g.setFillColor=function(T,J,Ee,Re){return Dl=Ce({ch1:T,ch2:J,ch3:Ee,ch4:Re,pdfColorType:"fill",precision:2}),re(Dl),this};var Hi=t.textColor||"0 g",zf=g.__private__.getTextColor=g.getTextColor=function(){return Se(Hi)};g.__private__.setTextColor=g.setTextColor=function(T,J,Ee,Re){return Hi=Ce({ch1:T,ch2:J,ch3:Ee,ch4:Re,pdfColorType:"text",precision:3}),this};var Ys=t.charSpace,_c=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(Ys||0)};g.__private__.setCharSpace=g.setCharSpace=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ys=T,this};var bc=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(T){var J=g.CapJoinStyles[T];if(J===void 0)throw new Error("Line cap style of '"+T+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return bc=J,re(J+" J"),this};var Cn=0;g.__private__.setLineJoin=g.setLineJoin=function(T){var J=g.CapJoinStyles[T];if(J===void 0)throw new Error("Line join style of '"+T+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Cn=J,re(J+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(T){if(T=T||0,isNaN(T))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return re(V(I(T))+" M"),this},g.GState=e1,g.setGState=function(T){(T=typeof T=="string"?Be[Rt[T]]:$i(null,T)).equals(Ht)||(re("/"+T.id+" gs"),Ht=T)};var $i=function(T,J){if(!T||!Rt[T]){var Ee=!1;for(var Re in Be)if(Be.hasOwnProperty(Re)&&Be[Re].equals(J)){Ee=!0;break}if(Ee)J=Be[Re];else{var qe="GS"+(Object.keys(Be).length+1).toString(10);Be[qe]=J,J.id=qe}return T&&(Rt[T]=J.id),Nr.publish("addGState",J),J}};g.addGState=function(T,J){return $i(T,J),this},g.saveGraphicsState=function(){return re("q"),Ie.push({key:St,size:tt,color:Hi}),this},g.restoreGraphicsState=function(){re("Q");var T=Ie.pop();return St=T.key,tt=T.size,Hi=T.color,Ht=null,this},g.setCurrentTransformationMatrix=function(T){return re(T.toString()+" cm"),this},g.comment=function(T){return re("#"+T),this};var Xs=function(T,J){var Ee=T||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ee},set:function(ht){isNaN(ht)||(Ee=parseFloat(ht))}});var Re=J||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Re},set:function(ht){isNaN(ht)||(Re=parseFloat(ht))}});var qe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return qe},set:function(ht){qe=ht.toString()}}),this},vo=function(T,J,Ee,Re){Xs.call(this,T,J),this.type="rect";var qe=Ee||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return qe},set:function(bt){isNaN(bt)||(qe=parseFloat(bt))}});var ht=Re||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ht},set:function(bt){isNaN(bt)||(ht=parseFloat(bt))}}),this},wc=function(){this.page=Kt,this.currentPage=D,this.pages=Le.slice(0),this.pagesContext=$t.slice(0),this.x=yt,this.y=er,this.matrix=Lt,this.width=yo(D),this.height=Tu(D),this.outputDestination=Ae,this.id="",this.objectNumber=-1};wc.prototype.restore=function(){Kt=this.page,D=this.currentPage,$t=this.pagesContext,Le=this.pages,yt=this.x,er=this.y,Lt=this.matrix,Ll(D,this.width),_o(D,this.height),Ae=this.outputDestination};var Fl=function(T,J,Ee,Re,qe){Ha.push(new wc),Kt=D=0,Le=[],yt=T,er=J,Lt=qe,fa([Ee,Re])};for(var xo in g.beginFormObject=function(T,J,Ee,Re,qe){return Fl(T,J,Ee,Re,qe),this},g.endFormObject=function(T){return(function(J){if(Ct[J])Ha.pop().restore();else{var Ee=new wc,Re="Xo"+(Object.keys(ja).length+1).toString(10);Ee.id=Re,Ct[J]=Re,ja[Re]=Ee,Nr.publish("addFormObject",Ee),Ha.pop().restore()}})(T),this},g.doFormObject=function(T,J){var Ee=ja[Ct[T]];return re("q"),re(J.toString()+" cm"),re("/"+Ee.id+" Do"),re("Q"),this},g.getFormObject=function(T){var J=ja[Ct[T]];return{x:J.x,y:J.y,width:J.width,height:J.height,matrix:J.matrix}},g.save=function(T,J){return T=T||"generated.pdf",(J=J||{}).returnPromise=J.returnPromise||!1,J.returnPromise===!1?(ef(el(zi()),T),typeof ef.unload=="function"&&wr.setTimeout&&setTimeout(ef.unload,911),this):new Promise(function(Ee,Re){try{var qe=ef(el(zi()),T);typeof ef.unload=="function"&&wr.setTimeout&&setTimeout(ef.unload,911),Ee(qe)}catch(ht){Re(ht.message)}})},sr.API)sr.API.hasOwnProperty(xo)&&(xo==="events"&&sr.API.events.length?(function(T,J){var Ee,Re,qe;for(qe=J.length-1;qe!==-1;qe--)Ee=J[qe][0],Re=J[qe][1],T.subscribe.apply(T,[Ee].concat(typeof Re=="function"?[Re]:Re))})(Nr,sr.API.events):g[xo]=sr.API[xo]);function yo(T){return $t[T].mediaBox.topRightX-$t[T].mediaBox.bottomLeftX}function Ll(T,J){$t[T].mediaBox.topRightX=J+$t[T].mediaBox.bottomLeftX}function Tu(T){return $t[T].mediaBox.topRightY-$t[T].mediaBox.bottomLeftY}function _o(T,J){$t[T].mediaBox.topRightY=J+$t[T].mediaBox.bottomLeftY}var bo=g.getPageWidth=function(T){return yo(T=T||D)/ft},Hf=g.setPageWidth=function(T,J){Ll(T,J*ft)},wo=g.getPageHeight=function(T){return Tu(T=T||D)/ft},$f=g.setPageHeight=function(T,J){_o(T,J*ft)};return g.internal={pdfEscape:Fr,getStyle:Nu,getFont:yi,getFontSize:kt,getCharSpace:_c,getTextColor:zf,getLineHeight:Uf,getLineHeightFactor:qf,getLineWidth:tl,write:Ke,getHorizontalCoordinate:Bs,getVerticalCoordinate:In,getCoordinateString:Cu,getVerticalCoordinateString:Rl,collections:{},newObject:$r,newAdditionalObject:je,newObjectDeferred:Ea,newObjectDeferredBegin:ae,getFilters:We,putStream:st,events:Nr,scaleFactor:ft,pageSize:{getWidth:function(){return bo(D)},setWidth:function(T){Hf(D,T)},getHeight:function(){return wo(D)},setHeight:function(T){$f(D,T)}},encryptionOptions:m,encryption:vn,getEncryptor:function(T){return m!==null?vn.encryptor(T,0):function(J){return J}},output:wu,getNumberOfPages:Is,get pages(){return Le},out:re,f2:P,f3:O,getPageInfo:nn,getPageInfoByObjId:yc,getCurrentPageInfo:Pf,getPDFVersion:_,Point:Xs,Rectangle:vo,Matrix:_t,hasHotfix:cs},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return bo(D)},set:function(T){Hf(D,T)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return wo(D)},set:function(T){$f(D,T)},enumerable:!0,configurable:!0}),(function(T){for(var J=0,Ee=rt.length;J<Ee;J++){var Re=oa.call(this,T[J][0],T[J][1],T[J][2],rt[J][3],!0);v===!1&&(y[Re]=!0);var qe=T[J][0].split("-");Yt({id:Re,fontName:qe[0],fontStyle:qe[1]||""})}Nr.publish("addFonts",{fonts:Bt,dictionary:we})}).call(g,rt),St="F1",ls(n,r),Nr.publish("initialized"),g}Uh.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Uh.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Uh.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Uh.prototype.processOwnerPassword=function(t,e){return C2(A2(e).substr(0,5),t)},Uh.prototype.encryptor=function(t,e){var r=A2(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(a){return C2(r,a)}},e1.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||va(t)!==va(this))return!1;var a=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;a++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&a--;return a===0},sr.API={events:[]},sr.version="3.0.4";var dn=sr.API,Ux=1,Lf=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Lh=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ar=function(t){return t.toFixed(2)},ru=function(t){return t.toFixed(5)};dn.__acroform__={};var mi=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},tS=function(t){return t*Ux},wl=function(t){var e=new Mk,r=rr.internal.getHeight(t)||0,a=rr.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Ar(a)),Number(Ar(r))],e},Qq=dn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},ez=dn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},tz=dn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Nn=dn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return tz(t,e-1)},kn=dn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Qq(t,e-1)},jn=dn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return ez(t,e-1)},rz=dn.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,a=e.internal.getVerticalCoordinate,n=t[0],s=t[1],o=t[2],u=t[3],f={};return f.lowerLeft_X=r(n)||0,f.lowerLeft_Y=a(s+u)||0,f.upperRight_X=r(n+o)||0,f.upperRight_Y=a(s)||0,[Number(Ar(f.lowerLeft_X)),Number(Ar(f.lowerLeft_Y)),Number(Ar(f.upperRight_X)),Number(Ar(f.upperRight_Y))]},az=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,a=T2(t,r),n=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+n+" "+Ar(a.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(a.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=wl(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},T2=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,a={text:"",fontSize:""},n=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");n=t.multiline?n.map(function(P){return P.split(`
`)}):n.map(function(P){return[P]});var s=r,o=rr.internal.getHeight(t)||0;o=o<0?-o:o;var u=rr.internal.getWidth(t)||0;u=u<0?-u:u;var f=function(P,O,I){if(P+1<n.length){var W=O+" "+n[P+1][0];return yp(W,t,I).width<=u-4}return!1};s++;e:for(;s>0;){e="",s--;var h,m,v=yp("3",t,s).height,y=t.multiline?o-s:(o-v)/2,g=y+=2,b=0,_=0,S=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+yp(e,t,s=12).width+", FieldWidth:"+u+`
`;break}for(var E="",C=0,j=0;j<n.length;j++)if(n.hasOwnProperty(j)){var R=!1;if(n[j].length!==1&&S!==n[j].length-1){if((v+2)*(C+2)+2>o)continue e;E+=n[j][S],R=!0,_=j,j--}else{E=(E+=n[j][S]+" ").substr(E.length-1)==" "?E.substr(0,E.length-1):E;var H=parseInt(j),Y=f(H,E,s),U=j>=n.length-1;if(Y&&!U){E+=" ",S=0;continue}if(Y||U){if(U)_=H;else if(t.multiline&&(v+2)*(C+2)+2>o)continue e}else{if(!t.multiline||(v+2)*(C+2)+2>o)continue e;_=H}}for(var V="",F=b;F<=_;F++){var X=n[F];if(t.multiline){if(F===_){V+=X[S]+" ",S=(S+1)%X.length;continue}if(F===b){V+=X[X.length-1]+" ";continue}}V+=X[0]+" "}switch(V=V.substr(V.length-1)==" "?V.substr(0,V.length-1):V,m=yp(V,t,s).width,t.textAlign){case"right":h=u-m-2;break;case"center":h=(u-m)/2;break;default:h=2}e+=Ar(h)+" "+Ar(g)+` Td
`,e+="("+Lf(V)+`) Tj
`,e+=-Ar(h)+` 0 Td
`,g=-(s+2),m=0,b=R?_:_+1,C++,E=""}break}return a.text=e,a.fontSize=s,a},yp=function(t,e,r){var a=e.scope.internal.getFont(e.fontName,e.fontStyle),n=e.scope.getStringUnitWidth(t,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},nz={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},sz=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},iz=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Jo.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(nz)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Ux=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Ik,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var s=a[n];s.objId=void 0,s.hasAnnotation&&sz(s,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(a,n){var s=!a;for(var o in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(o)){var u=a[o],f=[],h=u.Rect;if(u.Rect&&(u.Rect=rz(u.Rect,n)),n.internal.newObjectDeferredBegin(u.objId,!0),u.DA=rr.createDefaultAppearanceStream(u),va(u)==="object"&&typeof u.getKeyValueListForStream=="function"&&(f=u.getKeyValueListForStream()),u.Rect=h,u.hasAppearanceStream&&!u.appearanceStreamContent){var m=az(u);f.push({key:"AP",value:"<</N "+m+">>"}),n.internal.acroformPlugin.xForms.push(m)}if(u.appearanceStreamContent){var v="";for(var y in u.appearanceStreamContent)if(u.appearanceStreamContent.hasOwnProperty(y)){var g=u.appearanceStreamContent[y];if(v+="/"+y+" ",v+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var o in g)if(g.hasOwnProperty(o)){var b=g[o];typeof b=="function"&&(b=b.call(n,u)),v+="/"+o+" "+b+" ",n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b)}}else typeof(b=g)=="function"&&(b=b.call(n,u)),v+="/"+o+" "+b,n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b);v+=">>"}f.push({key:"AP",value:`<<
`+v+">>"})}n.internal.putStream({additionalKeyValues:f,objectId:u.objId}),n.internal.out("endobj")}s&&(function(_,S){for(var E in _)if(_.hasOwnProperty(E)){var C=E,j=_[E];S.internal.newObjectDeferredBegin(j.objId,!0),va(j)==="object"&&typeof j.putStream=="function"&&j.putStream(),delete _[C]}})(n.internal.acroformPlugin.xForms,n)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},Pk=dn.__acroform__.arrayToPdfArray=function(t,e,r){var a=function(o){return o};if(Array.isArray(t)){for(var n="[",s=0;s<t.length;s++)switch(s!==0&&(n+=" "),va(t[s])){case"boolean":case"number":case"object":n+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&r&&(a=r.internal.getEncryptor(e)),n+="("+Lf(a(t[s].toString()))+")"):n+=t[s].toString()}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Cv=function(t,e,r){var a=function(n){return n};return e!==void 0&&r&&(a=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Lf(a(t))+")"},jl=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};jl.prototype.toString=function(){return this.objId+" 0 R"},jl.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},jl.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var a=e[r],n=this[a];n&&(Array.isArray(n)?t.push({key:a,value:Pk(n,this.objId,this.scope)}):n instanceof jl?(n.scope=this.scope,t.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&t.push({key:a,value:n}))}return t};var Mk=function(){jl.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};mi(Mk,jl);var Ik=function(){jl.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Lf(r(t))+")"}},set:function(r){t=r}})};mi(Ik,jl);var Jo=function t(){jl.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute F supplied.');e=E}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Nn(e,3)},set:function(E){E?this.F=kn(e,3):this.F=jn(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute Ff supplied.');r=E}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(E){a=E!==void 0?E:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(E){a[0]=E}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(E){a[1]=E}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(E){a[2]=E}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(E){a[3]=E}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(E){switch(E){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=E;break;default:throw new Error('Invalid value "'+E+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof t1)return;s="FieldObject"+t.FieldNum++}var E=function(C){return C};return this.scope&&(E=this.scope.internal.getEncryptor(this.objId)),"("+Lf(E(s))+")"},set:function(E){s=E.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(E){s=E}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(E){o=E}});var u="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return u},set:function(E){u=E}});var f=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return f},set:function(E){f=E}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/Ux:h},set:function(E){h=E}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(E){m=E}});var v="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!v||this instanceof t1||this instanceof gf))return Cv(v,this.objId,this.scope)},set:function(E){E=E.toString(),v=E}});var y=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(y)return this instanceof ss==0?Cv(y,this.objId,this.scope):y},set:function(E){E=E.toString(),y=this instanceof ss==0?E.substr(0,1)==="("?Lh(E.substr(1,E.length-2)):Lh(E):E}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ss==1?Lh(y.substr(1,y.length-1)):y},set:function(E){E=E.toString(),y=this instanceof ss==1?"/"+E:E}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(E){this.V=E}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof ss==0?Cv(g,this.objId,this.scope):g},set:function(E){E=E.toString(),g=this instanceof ss==0?E.substr(0,1)==="("?Lh(E.substr(1,E.length-2)):Lh(E):E}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ss==1?Lh(g.substr(1,g.length-1)):g},set:function(E){E=E.toString(),g=this instanceof ss==1?"/"+E:E}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,_=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return _},set:function(E){E=!!E,_=E}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(E){b=E}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,1)},set:function(E){E?this.Ff=kn(this.Ff,1):this.Ff=jn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,2)},set:function(E){E?this.Ff=kn(this.Ff,2):this.Ff=jn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,3)},set:function(E){E?this.Ff=kn(this.Ff,3):this.Ff=jn(this.Ff,3)}});var S=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(S!==null)return S},set:function(E){if([0,1,2].indexOf(E)===-1)throw new Error('Invalid value "'+E+'" for attribute Q supplied.');S=E}}),Object.defineProperty(this,"textAlign",{get:function(){var E;switch(S){case 0:default:E="left";break;case 1:E="center";break;case 2:E="right"}return E},configurable:!0,enumerable:!0,set:function(E){switch(E){case"right":case 2:S=2;break;case"center":case 1:S=1;break;default:S=0}}})};mi(Jo,jl);var Kh=function(){Jo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Pk(e,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=(function(s,o,u){u||(u=1);for(var f,h=[];f=o.exec(s);)h.push(f[u]);return h})(a,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,18)},set:function(r){r?this.Ff=kn(this.Ff,18):this.Ff=jn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=kn(this.Ff,19):this.Ff=jn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,20)},set:function(r){r?(this.Ff=kn(this.Ff,20),e.sort()):this.Ff=jn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,22)},set:function(r){r?this.Ff=kn(this.Ff,22):this.Ff=jn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,23)},set:function(r){r?this.Ff=kn(this.Ff,23):this.Ff=jn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,27)},set:function(r){r?this.Ff=kn(this.Ff,27):this.Ff=jn(this.Ff,27)}}),this.hasAppearanceStream=!1};mi(Kh,Jo);var Jh=function(){Kh.call(this),this.fontName="helvetica",this.combo=!1};mi(Jh,Kh);var Zh=function(){Jh.call(this),this.combo=!0};mi(Zh,Jh);var Cp=function(){Zh.call(this),this.edit=!0};mi(Cp,Zh);var ss=function(){Jo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,15)},set:function(r){r?this.Ff=kn(this.Ff,15):this.Ff=jn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,16)},set:function(r){r?this.Ff=kn(this.Ff,16):this.Ff=jn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,17)},set:function(r){r?this.Ff=kn(this.Ff,17):this.Ff=jn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,26)},set:function(r){r?this.Ff=kn(this.Ff,26):this.Ff=jn(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var a,n=[];for(a in n.push("<<"),e)n.push("/"+a+" ("+Lf(r(e[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){va(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};mi(ss,Jo);var Tp=function(){ss.call(this),this.pushButton=!0};mi(Tp,ss);var Qh=function(){ss.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};mi(Qh,ss);var t1=function(){var t,e;Jo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(n){e=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(u){return u};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),a)o.push("/"+s+" ("+Lf(n(a[s]))+")");return o.push(">>"),o.join(`
`)},set:function(n){va(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=rr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};mi(t1,Jo),Qh.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Qh.prototype.createOption=function(t){var e=new t1;return e.Parent=this,e.optionName=t,this.Kids.push(e),oz.call(this.scope,e),e};var Op=function(){ss.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=rr.CheckBox.createAppearanceStream()};mi(Op,ss);var gf=function(){Jo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,13)},set:function(e){e?this.Ff=kn(this.Ff,13):this.Ff=jn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,21)},set:function(e){e?this.Ff=kn(this.Ff,21):this.Ff=jn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,23)},set:function(e){e?this.Ff=kn(this.Ff,23):this.Ff=jn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,24)},set:function(e){e?this.Ff=kn(this.Ff,24):this.Ff=jn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,25)},set:function(e){e?this.Ff=kn(this.Ff,25):this.Ff=jn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,26)},set:function(e){e?this.Ff=kn(this.Ff,26):this.Ff=jn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};mi(gf,Jo);var Rp=function(){gf.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,14)},set:function(t){t?this.Ff=kn(this.Ff,14):this.Ff=jn(this.Ff,14)}}),this.password=!0};mi(Rp,gf);var rr={CheckBox:{createAppearanceStream:function(){return{N:{On:rr.CheckBox.YesNormal},D:{On:rr.CheckBox.YesPushDown,Off:rr.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=wl(t);e.scope=t.scope;var r=[],a=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=T2(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Ar(rr.internal.getWidth(t))+" "+Ar(rr.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+Ar(s.fontSize)+" Tf "+n),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=wl(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),n=[],s=rr.internal.getHeight(t),o=rr.internal.getWidth(t),u=T2(t,t.caption);return n.push("1 g"),n.push("0 0 "+Ar(o)+" "+Ar(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+Ar(o-1)+" "+Ar(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+Ar(u.fontSize)+" Tf "+a),n.push(u.text),n.push("ET"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=wl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ar(rr.internal.getWidth(t))+" "+Ar(rr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:rr.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=rr.RadioButton.Circle.YesNormal,e.D[t]=rr.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=wl(t);e.scope=t.scope;var r=[],a=rr.internal.getWidth(t)<=rr.internal.getHeight(t)?rr.internal.getWidth(t)/4:rr.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=rr.internal.Bezier_C,s=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+ru(rr.internal.getWidth(t)/2)+" "+ru(rr.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=wl(t);e.scope=t.scope;var r=[],a=rr.internal.getWidth(t)<=rr.internal.getHeight(t)?rr.internal.getWidth(t)/4:rr.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*rr.internal.Bezier_C).toFixed(5)),o=Number((a*rr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ru(rr.internal.getWidth(t)/2)+" "+ru(rr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+ru(rr.internal.getWidth(t)/2)+" "+ru(rr.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+o+" "+o+" "+a+" 0 "+a+" c"),r.push("-"+o+" "+a+" -"+a+" "+o+" -"+a+" 0 c"),r.push("-"+a+" -"+o+" -"+o+" -"+a+" 0 -"+a+" c"),r.push(o+" -"+a+" "+a+" -"+o+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=wl(t);e.scope=t.scope;var r=[],a=rr.internal.getWidth(t)<=rr.internal.getHeight(t)?rr.internal.getWidth(t)/4:rr.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*rr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ru(rr.internal.getWidth(t)/2)+" "+ru(rr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:rr.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=rr.RadioButton.Cross.YesNormal,e.D[t]=rr.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=wl(t);e.scope=t.scope;var r=[],a=rr.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Ar(rr.internal.getWidth(t)-2)+" "+Ar(rr.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Ar(a.x1.x)+" "+Ar(a.x1.y)+" m"),r.push(Ar(a.x2.x)+" "+Ar(a.x2.y)+" l"),r.push(Ar(a.x4.x)+" "+Ar(a.x4.y)+" m"),r.push(Ar(a.x3.x)+" "+Ar(a.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=wl(t);e.scope=t.scope;var r=rr.internal.calculateCross(t),a=[];return a.push("0.749023 g"),a.push("0 0 "+Ar(rr.internal.getWidth(t))+" "+Ar(rr.internal.getHeight(t))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Ar(rr.internal.getWidth(t)-2)+" "+Ar(rr.internal.getHeight(t)-2)+" re"),a.push("W"),a.push("n"),a.push(Ar(r.x1.x)+" "+Ar(r.x1.y)+" m"),a.push(Ar(r.x2.x)+" "+Ar(r.x2.y)+" l"),a.push(Ar(r.x4.x)+" "+Ar(r.x4.y)+" m"),a.push(Ar(r.x3.x)+" "+Ar(r.x3.y)+" l"),a.push("s"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(t){var e=wl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ar(rr.internal.getWidth(t))+" "+Ar(rr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};rr.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=rr.internal.getWidth(t),r=rr.internal.getHeight(t),a=Math.min(e,r);return{x1:{x:(e-a)/2,y:(r-a)/2+a},x2:{x:(e-a)/2+a,y:(r-a)/2},x3:{x:(e-a)/2,y:(r-a)/2},x4:{x:(e-a)/2+a,y:(r-a)/2+a}}}},rr.internal.getWidth=function(t){var e=0;return va(t)==="object"&&(e=tS(t.Rect[2])),e},rr.internal.getHeight=function(t){var e=0;return va(t)==="object"&&(e=tS(t.Rect[3])),e};var oz=dn.addField=function(t){if(iz(this,t),!(t instanceof Jo))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};dn.AcroFormChoiceField=Kh,dn.AcroFormListBox=Jh,dn.AcroFormComboBox=Zh,dn.AcroFormEditBox=Cp,dn.AcroFormButton=ss,dn.AcroFormPushButton=Tp,dn.AcroFormRadioButton=Qh,dn.AcroFormCheckBox=Op,dn.AcroFormTextField=gf,dn.AcroFormPasswordField=Rp,dn.AcroFormAppearance=rr,dn.AcroForm={ChoiceField:Kh,ListBox:Jh,ComboBox:Zh,EditBox:Cp,Button:ss,PushButton:Tp,RadioButton:Qh,CheckBox:Op,TextField:gf,PasswordField:Rp,Appearance:rr},sr.AcroForm={ChoiceField:Kh,ListBox:Jh,ComboBox:Zh,EditBox:Cp,Button:ss,PushButton:Tp,RadioButton:Qh,CheckBox:Op,TextField:gf,PasswordField:Rp,Appearance:rr};sr.AcroForm;function Bk(t){return t.reduce(function(e,r,a){return e[r]=a,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(P,O){var I,W,ne,Q,le,ee=r;if((O=O||r)==="RGBA"||P.data!==void 0&&P.data instanceof Uint8ClampedArray&&"height"in P&&"width"in P)return"RGBA";if(Y(P))for(le in a)for(ne=a[le],I=0;I<ne.length;I+=1){for(Q=!0,W=0;W<ne[I].length;W+=1)if(ne[I][W]!==void 0&&ne[I][W]!==P[W]){Q=!1;break}if(Q===!0){ee=le;break}}else for(le in a)for(ne=a[le],I=0;I<ne.length;I+=1){for(Q=!0,W=0;W<ne[I].length;W+=1)if(ne[I][W]!==void 0&&ne[I][W]!==P.charCodeAt(W)){Q=!1;break}if(Q===!0){ee=le;break}}return ee===r&&O!==r&&(ee=O),ee},s=function P(O){for(var I=this.internal.write,W=this.internal.putStream,ne=(0,this.internal.getFilters)();ne.indexOf("FlateEncode")!==-1;)ne.splice(ne.indexOf("FlateEncode"),1);O.objectId=this.internal.newObject();var Q=[];if(Q.push({key:"Type",value:"/XObject"}),Q.push({key:"Subtype",value:"/Image"}),Q.push({key:"Width",value:O.width}),Q.push({key:"Height",value:O.height}),O.colorSpace===E.INDEXED?Q.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(O.palette.length/3-1)+" "+("sMask"in O&&O.sMask!==void 0?O.objectId+2:O.objectId+1)+" 0 R]"}):(Q.push({key:"ColorSpace",value:"/"+O.colorSpace}),O.colorSpace===E.DEVICE_CMYK&&Q.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Q.push({key:"BitsPerComponent",value:O.bitsPerComponent}),"decodeParameters"in O&&O.decodeParameters!==void 0&&Q.push({key:"DecodeParms",value:"<<"+O.decodeParameters+">>"}),"transparency"in O&&Array.isArray(O.transparency)&&O.transparency.length>0){for(var le="",ee=0,K=O.transparency.length;ee<K;ee++)le+=O.transparency[ee]+" "+O.transparency[ee]+" ";Q.push({key:"Mask",value:"["+le+"]"})}O.sMask!==void 0&&Q.push({key:"SMask",value:O.objectId+1+" 0 R"});var ue=O.filter!==void 0?["/"+O.filter]:void 0;if(W({data:O.data,additionalKeyValues:Q,alreadyAppliedFilters:ue,objectId:O.objectId}),I("endobj"),"sMask"in O&&O.sMask!==void 0){var M,A=(M=O.sMaskBitsPerComponent)!==null&&M!==void 0?M:O.bitsPerComponent,D={width:O.width,height:O.height,colorSpace:"DeviceGray",bitsPerComponent:A,data:O.sMask};"filter"in O&&(D.decodeParameters="/Predictor ".concat(O.predictor," /Colors 1 /BitsPerComponent ").concat(A," /Columns ").concat(O.width),D.filter=O.filter),P.call(this,D)}if(O.colorSpace===E.INDEXED){var B=this.internal.newObject();W({data:V(new Uint8Array(O.palette)),objectId:B}),I("endobj")}},o=function(){var P=this.internal.collections[e+"images"];for(var O in P)s.call(this,P[O])},u=function(){var P,O=this.internal.collections[e+"images"],I=this.internal.write;for(var W in O)I("/I"+(P=O[W]).index,P.objectId,"0","R")},f=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",u))},h=function(){var P=this.internal.collections[e+"images"];return f.call(this),P},m=function(){return Object.keys(this.internal.collections[e+"images"]).length},v=function(P){return typeof t["process"+P.toUpperCase()]=="function"},y=function(P){return va(P)==="object"&&P.nodeType===1},g=function(P,O){if(P.nodeName==="IMG"&&P.hasAttribute("src")){var I=""+P.getAttribute("src");if(I.indexOf("data:image/")===0)return Ap(unescape(I).split("base64,").pop());var W=t.loadFile(I,!0);if(W!==void 0)return W}if(P.nodeName==="CANVAS"){if(P.width===0||P.height===0)throw new Error("Given canvas must have data. Canvas width: "+P.width+", height: "+P.height);var ne;switch(O){case"PNG":ne="image/png";break;case"WEBP":ne="image/webp";break;default:ne="image/jpeg"}return Ap(P.toDataURL(ne,1).split("base64,").pop())}},b=function(P){var O=this.internal.collections[e+"images"];if(O){for(var I in O)if(P===O[I].alias)return O[I]}},_=function(P,O,I){return P||O||(P=-96,O=-96),P<0&&(P=-1*I.width*72/P/this.internal.scaleFactor),O<0&&(O=-1*I.height*72/O/this.internal.scaleFactor),P===0&&(P=O*I.width/I.height),O===0&&(O=P*I.height/I.width),[P,O]},S=function(P,O,I,W,ne,Q){var le=_.call(this,I,W,ne),ee=this.internal.getCoordinateString,K=this.internal.getVerticalCoordinateString,ue=h.call(this);if(I=le[0],W=le[1],ue[ne.index]=ne,Q){Q*=Math.PI/180;var M=Math.cos(Q),A=Math.sin(Q),D=function(q){return q.toFixed(4)},B=[D(M),D(A),D(-1*A),D(M),0,0,"cm"]}this.internal.write("q"),Q?(this.internal.write([1,"0","0",1,ee(P),K(O+W),"cm"].join(" ")),this.internal.write(B.join(" ")),this.internal.write([ee(I),"0","0",ee(W),"0","0","cm"].join(" "))):this.internal.write([ee(I),"0","0",ee(W),ee(P),K(O+W),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ne.index+" Do"),this.internal.write("Q")},E=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var C=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},j=t.__addimage__.sHashCode=function(P){var O,I,W=0;if(typeof P=="string")for(I=P.length,O=0;O<I;O++)W=(W<<5)-W+P.charCodeAt(O),W|=0;else if(Y(P))for(I=P.byteLength/2,O=0;O<I;O++)W=(W<<5)-W+P[O],W|=0;return W},R=t.__addimage__.validateStringAsBase64=function(P){(P=P||"").toString().trim();var O=!0;return P.length===0&&(O=!1),P.length%4!=0&&(O=!1),/^[A-Za-z0-9+/]+$/.test(P.substr(0,P.length-2))===!1&&(O=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(P.substr(-2))===!1&&(O=!1),O},H=t.__addimage__.extractImageFromDataUrl=function(P){if(P==null||!(P=P.trim()).startsWith("data:"))return null;var O=P.indexOf(",");return O<0?null:P.substring(0,O).trim().endsWith("base64")?P.substring(O+1):null};t.__addimage__.isArrayBuffer=function(P){return P instanceof ArrayBuffer};var Y=t.__addimage__.isArrayBufferView=function(P){return P instanceof Int8Array||P instanceof Uint8Array||P instanceof Uint8ClampedArray||P instanceof Int16Array||P instanceof Uint16Array||P instanceof Int32Array||P instanceof Uint32Array||P instanceof Float32Array||P instanceof Float64Array},U=t.__addimage__.binaryStringToUint8Array=function(P){for(var O=P.length,I=new Uint8Array(O),W=0;W<O;W++)I[W]=P.charCodeAt(W);return I},V=t.__addimage__.arrayBufferToBinaryString=function(P){for(var O="",I=Y(P)?P:new Uint8Array(P),W=0;W<I.length;W+=8192)O+=String.fromCharCode.apply(null,I.subarray(W,W+8192));return O};t.addImage=function(){var P,O,I,W,ne,Q,le,ee,K;if(typeof arguments[1]=="number"?(O=r,I=arguments[1],W=arguments[2],ne=arguments[3],Q=arguments[4],le=arguments[5],ee=arguments[6],K=arguments[7]):(O=arguments[1],I=arguments[2],W=arguments[3],ne=arguments[4],Q=arguments[5],le=arguments[6],ee=arguments[7],K=arguments[8]),va(P=arguments[0])==="object"&&!y(P)&&"imageData"in P){var ue=P;P=ue.imageData,O=ue.format||O||r,I=ue.x||I||0,W=ue.y||W||0,ne=ue.w||ue.width||ne,Q=ue.h||ue.height||Q,le=ue.alias||le,ee=ue.compression||ee,K=ue.rotation||ue.angle||K}var M=this.internal.getFilters();if(ee===void 0&&M.indexOf("FlateEncode")!==-1&&(ee="SLOW"),isNaN(I)||isNaN(W))throw new Error("Invalid coordinates passed to jsPDF.addImage");f.call(this);var A=F.call(this,P,O,le,ee);return S.call(this,I,W,ne,Q,A,K),this};var F=function(P,O,I,W){var ne,Q,le;if(typeof P=="string"&&n(P)===r){P=unescape(P);var ee=X(P,!1);(ee!==""||(ee=t.loadFile(P,!0))!==void 0)&&(P=ee)}if(y(P)&&(P=g(P,O)),O=n(P,O),!v(O))throw new Error("addImage does not support files of type '"+O+"', please ensure that a plugin for '"+O+"' support is added.");if(((le=I)==null||le.length===0)&&(I=(function(K){return typeof K=="string"||Y(K)?j(K):Y(K.data)?j(K.data):null})(P)),(ne=b.call(this,I))||(P instanceof Uint8Array||O==="RGBA"||(Q=P,P=U(P)),ne=this["process"+O.toUpperCase()](P,m.call(this),I,(function(K){return K&&typeof K=="string"&&(K=K.toUpperCase()),K in t.image_compression?K:C.NONE})(W),Q)),!ne)throw new Error("An unknown error occurred whilst processing the image.");return ne},X=t.__addimage__.convertBase64ToBinaryString=function(P,O){O=typeof O!="boolean"||O;var I,W="";if(typeof P=="string"){var ne;I=(ne=H(P))!==null&&ne!==void 0?ne:P;try{W=Ap(I)}catch(Q){if(O)throw R(I)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Q.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return W};t.getImageProperties=function(P){var O,I,W="";if(y(P)&&(P=g(P)),typeof P=="string"&&n(P)===r&&((W=X(P,!1))===""&&(W=t.loadFile(P)||""),P=W),I=n(P),!v(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(P instanceof Uint8Array||(P=U(P)),!(O=this["process"+I.toUpperCase()](P)))throw new Error("An unknown error occurred whilst processing the image");return O.fileType=I,O}})(sr.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};sr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var a,n,s,o=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString,f=this.internal.getPageInfoByObjId(r.objId),h=r.pageContext.annotations,m=!1,v=0;v<h.length&&!m;v++)switch((a=h[v]).type){case"link":(e(a.options.url)||e(a.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var y=0;y<h.length;y++){a=h[y];var g=this.internal.pdfEscape,b=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var _=this.internal.newAdditionalObject(),S=this.internal.newAdditionalObject(),E=this.internal.getEncryptor(_.objId),C=a.title||"Note";s="<</Type /Annot /Subtype /Text "+(n="/Rect ["+o(a.bounds.x)+" "+u(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w)+" "+u(a.bounds.y)+"] ")+"/Contents ("+g(E(a.contents))+")",s+=" /Popup "+S.objId+" 0 R",s+=" /P "+f.objId+" 0 R",s+=" /T ("+g(E(C))+") >>",_.content=s;var j=_.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+o(a.bounds.x+30)+" "+u(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w+30)+" "+u(a.bounds.y)+"] ")+" /Parent "+j,a.open&&(s+=" /Open true"),s+=" >>",S.content=s,this.internal.write(_.objId,"0 R",S.objId,"0 R");break;case"freetext":n="/Rect ["+o(a.bounds.x)+" "+u(a.bounds.y)+" "+o(a.bounds.x+a.bounds.w)+" "+u(a.bounds.y+a.bounds.h)+"] ";var R=a.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+g(b(a.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+R+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(a.options.name){var H=this.annotations._nameMap[a.options.name];a.options.pageNumber=H.page,a.options.top=H.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",s="",a.options.url)s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+g(b(a.options.url))+") >>";else if(a.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,s+=" /FitV "+a.options.left+"]";break;default:var Y=u(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),s+=" /XYZ "+a.options.left+" "+Y+" "+a.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},t.link=function(r,a,n,s,o){var u=this.internal.getCurrentPageInfo(),f=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;u.pageContext.annotations.push({finalBounds:{x:f(r),y:h(a),w:f(r+n),h:h(a+s)},options:o,type:"link"})},t.textWithLink=function(r,a,n,s){var o,u,f=this.getTextWidth(r),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){u=s.maxWidth;var m=this.splitTextToSize(r,u).length;o=Math.ceil(h*m)}else u=f,o=h;return this.text(r,a,n,s),n+=.2*h,s.align==="center"&&(a-=f/2),s.align==="right"&&(a-=f),this.link(a,n-h,u,o,s),f},t.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}})(sr.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(_){return e[_.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(_){return typeof _=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(_)},u=t.__arabicParser__.isArabicEndLetter=function(_){return o(_)&&s(_)&&e[_.charCodeAt(0)].length<=2},f=t.__arabicParser__.isArabicAlfLetter=function(_){return o(_)&&n.indexOf(_.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(_){return o(_)&&s(_)&&e[_.charCodeAt(0)].length>=1};var h=t.__arabicParser__.arabicLetterHasFinalForm=function(_){return o(_)&&s(_)&&e[_.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(_){return o(_)&&s(_)&&e[_.charCodeAt(0)].length>=3};var m=t.__arabicParser__.arabicLetterHasMedialForm=function(_){return o(_)&&s(_)&&e[_.charCodeAt(0)].length==4},v=t.__arabicParser__.resolveLigatures=function(_){var S=0,E=r,C="",j=0;for(S=0;S<_.length;S+=1)E[_.charCodeAt(S)]!==void 0?(j++,typeof(E=E[_.charCodeAt(S)])=="number"&&(C+=String.fromCharCode(E),E=r,j=0),S===_.length-1&&(E=r,C+=_.charAt(S-(j-1)),S-=j-1,j=0)):(E=r,C+=_.charAt(S-j),S-=j,j=0);return C};t.__arabicParser__.isArabicDiacritic=function(_){return _!==void 0&&a[_.charCodeAt(0)]!==void 0};var y=t.__arabicParser__.getCorrectForm=function(_,S,E){return o(_)?s(_)===!1?-1:!h(_)||!o(S)&&!o(E)||!o(E)&&u(S)||u(_)&&!o(S)||u(_)&&f(S)||u(_)&&u(S)?0:m(_)&&o(S)&&!u(S)&&o(E)&&h(E)?3:u(_)||!o(E)?1:2:-1},g=function(_){var S=0,E=0,C=0,j="",R="",H="",Y=(_=_||"").split("\\s+"),U=[];for(S=0;S<Y.length;S+=1){for(U.push(""),E=0;E<Y[S].length;E+=1)j=Y[S][E],R=Y[S][E-1],H=Y[S][E+1],o(j)?(C=y(j,R,H),U[S]+=C!==-1?String.fromCharCode(e[j.charCodeAt(0)][C]):j):U[S]+=j;U[S]=v(U[S])}return U.join(" ")},b=t.__arabicParser__.processArabic=t.processArabic=function(){var _,S=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,E=[];if(Array.isArray(S)){var C=0;for(E=[],C=0;C<S.length;C+=1)Array.isArray(S[C])?E.push([g(S[C][0]),S[C][1],S[C][2]]):E.push([g(S[C])]);_=E}else _=g(S);return typeof arguments[0]=="string"?_:(arguments[0].text=_,arguments[0])};t.events.push(["preProcessText",b])})(sr.API),sr.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(u){r=u}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(u){a=isNaN(u)||Number.isInteger(u)===!1||u<0?150:u,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(u){n=isNaN(u)||Number.isInteger(u)===!1||u<0?300:u,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(u){s=u}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(u){o=u}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(sr.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var f=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return f},set:function(_){f=_}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(_){h=_}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(_){m=_}});var v=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return v},set:function(_){v=_}});var y=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return y},set:function(_){y=_}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(_){g=_}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(_){b=_}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(f){return a.call(this),this.internal.__cell__.headerFunction=typeof f=="function"?f:void 0,this},t.getTextDimensions=function(f,h){a.call(this);var m=(h=h||{}).fontSize||this.getFontSize(),v=h.font||this.getFont(),y=h.scaleFactor||this.internal.scaleFactor,g=0,b=0,_=0,S=this;if(!Array.isArray(f)&&typeof f!="string"){if(typeof f!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");f=String(f)}var E=h.maxWidth;E>0?typeof f=="string"?f=this.splitTextToSize(f,E):Object.prototype.toString.call(f)==="[object Array]"&&(f=f.reduce(function(j,R){return j.concat(S.splitTextToSize(R,E))},[])):f=Array.isArray(f)?f:[f];for(var C=0;C<f.length;C++)g<(_=this.getStringUnitWidth(f[C],{font:v})*m)&&(g=_);return g!==0&&(b=f.length),{w:g/=y,h:Math.max((b*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/y,0)}},t.cellAddPage=function(){a.call(this),this.addPage();var f=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(f.left,f.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var f;f=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),a.call(this);var h=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,v=this.internal.__cell__.margins||e,y=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===f.lineNumber?(f.x=(h.x||0)+(h.width||0),f.y=h.y||0):h.y+h.height+f.height+v.bottom>this.getPageHeight()?(this.cellAddPage(),f.y=v.top,g&&y&&(this.printHeaderRow(f.lineNumber,!0),f.y+=y[0].height)):f.y=h.y+h.height||f.y),f.text[0]!==void 0&&(this.rect(f.x,f.y,f.width,f.height,r===!0?"FD":void 0),f.align==="right"?this.text(f.text,f.x+f.width-m,f.y+m,{align:"right",baseline:"top"}):f.align==="center"?this.text(f.text,f.x+f.width/2,f.y+m,{align:"center",baseline:"top",maxWidth:f.width-m-m}):this.text(f.text,f.x+m,f.y+m,{align:"left",baseline:"top",maxWidth:f.width-m-m})),this.internal.__cell__.lastCell=f,this};t.table=function(f,h,m,v,y){if(a.call(this),!m)throw new Error("No data for PDF table.");var g,b,_,S,E=[],C=[],j=[],R={},H={},Y=[],U=[],V=(y=y||{}).autoSize||!1,F=y.printHeaders!==!1,X=y.css&&y.css["font-size"]!==void 0?16*y.css["font-size"]:y.fontSize||12,P=y.margins||Object.assign({width:this.getPageWidth()},e),O=typeof y.padding=="number"?y.padding:3,I=y.headerBackgroundColor||"#c8c8c8",W=y.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=F,this.internal.__cell__.margins=P,this.internal.__cell__.table_font_size=X,this.internal.__cell__.padding=O,this.internal.__cell__.headerBackgroundColor=I,this.internal.__cell__.headerTextColor=W,this.setFontSize(X),v==null)C=E=Object.keys(m[0]),j=E.map(function(){return"left"});else if(Array.isArray(v)&&va(v[0])==="object")for(E=v.map(function(ue){return ue.name}),C=v.map(function(ue){return ue.prompt||ue.name||""}),j=v.map(function(ue){return ue.align||"left"}),g=0;g<v.length;g+=1)H[v[g].name]=.7499990551181103*v[g].width;else Array.isArray(v)&&typeof v[0]=="string"&&(C=E=v,j=E.map(function(){return"left"}));if(V||Array.isArray(v)&&typeof v[0]=="string")for(g=0;g<E.length;g+=1){for(R[S=E[g]]=m.map(function(ue){return ue[S]}),this.setFont(void 0,"bold"),Y.push(this.getTextDimensions(C[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=R[S],this.setFont(void 0,"normal"),_=0;_<b.length;_+=1)Y.push(this.getTextDimensions(b[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);H[S]=Math.max.apply(null,Y)+O+O,Y=[]}if(F){var ne={};for(g=0;g<E.length;g+=1)ne[E[g]]={},ne[E[g]].text=C[g],ne[E[g]].align=j[g];var Q=u.call(this,ne,H);U=E.map(function(ue){return new s(f,h,H[ue],Q,ne[ue].text,void 0,ne[ue].align)}),this.setTableHeaderRow(U),this.printHeaderRow(1,!1)}var le=v.reduce(function(ue,M){return ue[M.name]=M.align,ue},{});for(g=0;g<m.length;g+=1){"rowStart"in y&&y.rowStart instanceof Function&&y.rowStart({row:g,data:m[g]},this);var ee=u.call(this,m[g],H);for(_=0;_<E.length;_+=1){var K=m[g][E[_]];"cellStart"in y&&y.cellStart instanceof Function&&y.cellStart({row:g,col:_,data:K},this),o.call(this,new s(f,h,H[E[_]],ee,K,g+2,le[E[_]]))}}return this.internal.__cell__.table_x=f,this.internal.__cell__.table_y=h,this};var u=function(f,h){var m=this.internal.__cell__.padding,v=this.internal.__cell__.table_font_size,y=this.internal.scaleFactor;return Object.keys(f).map(function(g){var b=f[g];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,h[g]-m-m)},this).map(function(g){return this.getLineHeightFactor()*g.length*v/y+m+m},this).reduce(function(g,b){return Math.max(g,b)},0)};t.setTableHeaderRow=function(f){a.call(this),this.internal.__cell__.tableHeaderRow=f},t.printHeaderRow=function(f,h){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var v=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(v[0],v[1],v[2],v[3],void 0,-1)}this.setFont(void 0,"bold");for(var y=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){m=this.internal.__cell__.tableHeaderRow[g].clone(),h&&(m.y=this.internal.__cell__.margins.top||0,y.push(m)),m.lineNumber=f;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,m),this.setTextColor(b)}y.length>0&&this.setTableHeaderRow(y),this.setFont(void 0,"normal"),r=!1}})(sr.API);var Uk={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},qk=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],O2=Bk(qk),zk=[100,200,300,400,500,600,700,800,900],lz=Bk(zk);function Tv(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(s){return Uk[s=s||"normal"]?s:"normal"})(t.style),a=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(t.weight),n=(function(s){return typeof O2[s=s||"normal"]=="number"?s:"normal"})(t.stretch);return{family:e,style:r,weight:a,stretch:n,src:t.src||[],ref:t.ref||{name:e,style:[n,r,a].join(" ")}}}function rS(t,e,r,a){var n;for(n=r;n>=0&&n<e.length;n+=a)if(t[e[n]])return t[e[n]];for(n=r;n>=0&&n<e.length;n-=a)if(t[e[n]])return t[e[n]]}var cz={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},aS={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function nS(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function sS(t){return t.trimLeft()}function uz(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function fz(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var _p,iS,oS,Ph,bp,lS,cS,uS,Ov=["times"];function fS(t,e,r,a,n){var s=4,o=dS;switch(n){case sr.API.image_compression.FAST:s=1,o=hS;break;case sr.API.image_compression.MEDIUM:s=6,o=mS;break;case sr.API.image_compression.SLOW:s=9,o=pS}t=(function(f,h,m,v){for(var y,g=f.length/h,b=new Uint8Array(f.length+g),_=[hz,hS,dS,mS,pS],S=0;S<g;S+=1){var E=S*h,C=f.subarray(E,E+h);if(v)b.set(v(C,m,y),E+S);else{for(var j=_.length,R=[],H=0;H<j;H+=1)R[H]=_[H](C,m,y);var Y=mz(R.concat());b.set(R[Y],E+S)}y=C}return b})(t,e,Math.ceil(r*a/8),o);var u=N2(t,{level:s});return sr.API.__addimage__.arrayBufferToBinaryString(u)}function hz(t){var e=Array.apply([],t);return e.unshift(0),e}function hS(t,e){var r=t.length,a=[];a[0]=1;for(var n=0;n<r;n+=1){var s=t[n-e]||0;a[n+1]=t[n]-s+256&255}return a}function dS(t,e,r){var a=t.length,n=[];n[0]=2;for(var s=0;s<a;s+=1){var o=r&&r[s]||0;n[s+1]=t[s]-o+256&255}return n}function mS(t,e,r){var a=t.length,n=[];n[0]=3;for(var s=0;s<a;s+=1){var o=t[s-e]||0,u=r&&r[s]||0;n[s+1]=t[s]+256-(o+u>>>1)&255}return n}function pS(t,e,r){var a=t.length,n=[];n[0]=4;for(var s=0;s<a;s+=1){var o=dz(t[s-e]||0,r&&r[s]||0,r&&r[s-e]||0);n[s+1]=t[s]-o+256&255}return n}function dz(t,e,r){if(t===e&&e===r)return t;var a=Math.abs(e-r),n=Math.abs(t-r),s=Math.abs(t+e-r-r);return a<=n&&a<=s?t:n<=s?e:r}function mz(t){var e=t.map(function(r){return r.reduce(function(a,n){return a+Math.abs(n)},0)});return e.indexOf(Math.min.apply(null,e))}function Rv(t,e,r){var a=e*r,n=Math.floor(a/8),s=16-(a-8*n+r),o=(1<<r)-1;return Hk(t,n)>>s&o}function gS(t,e,r,a){var n=r*a,s=Math.floor(n/8),o=16-(n-8*s+a),u=(1<<a)-1,f=(e&u)<<o;(function(h,m,v){if(m+1<h.byteLength)h.setUint16(m,v,!1);else{var y=v>>8&255;h.setUint8(m,y)}})(t,s,Hk(t,s)&~(u<<o)&65535|f)}function Hk(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function pz(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,a=t[e++]|t[e++]<<8,n=t[e++],s=n>>7,o=1<<1+(7&n);t[e++],t[e++];var u=null,f=null;s&&(u=e,f=o,e+=3*o);var h=!0,m=[],v=0,y=null,g=0,b=null;for(this.width=r,this.height=a;h&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,b=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((P=t[e++])>=0))throw Error("Invalid block size");if(P===0)break;e+=P}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var _=t[e++];v=t[e++]|t[e++]<<8,y=t[e++],1&_||(y=null),g=_>>2&7,e++;break;case 254:for(;;){if(!((P=t[e++])>=0))throw Error("Invalid block size");if(P===0)break;e+=P}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var S=t[e++]|t[e++]<<8,E=t[e++]|t[e++]<<8,C=t[e++]|t[e++]<<8,j=t[e++]|t[e++]<<8,R=t[e++],H=R>>6&1,Y=1<<1+(7&R),U=u,V=f,F=!1;R>>7&&(F=!0,U=e,V=Y,e+=3*Y);var X=e;for(e++;;){var P;if(!((P=t[e++])>=0))throw Error("Invalid block size");if(P===0)break;e+=P}m.push({x:S,y:E,width:C,height:j,has_local_palette:F,palette_offset:U,palette_size:V,data_offset:X,data_length:e-X,transparent_index:y,interlaced:!!H,delay:v,disposal:g});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return b},this.frameInfo=function(O){if(O<0||O>=m.length)throw new Error("Frame index out of range.");return m[O]},this.decodeAndBlitFrameBGRA=function(O,I){var W=this.frameInfo(O),ne=W.width*W.height,Q=new Uint8Array(ne);vS(t,W.data_offset,Q,ne);var le=W.palette_offset,ee=W.transparent_index;ee===null&&(ee=256);var K=W.width,ue=r-K,M=K,A=4*(W.y*r+W.x),D=4*((W.y+W.height)*r+W.x),B=A,q=4*ue;W.interlaced===!0&&(q+=4*r*7);for(var Z=8,oe=0,pe=Q.length;oe<pe;++oe){var _e=Q[oe];if(M===0&&(M=K,(B+=q)>=D&&(q=4*ue+4*r*(Z-1),B=A+(K+ue)*(Z<<1),Z>>=1)),_e===ee)B+=4;else{var be=t[le+3*_e],Le=t[le+3*_e+1],he=t[le+3*_e+2];I[B++]=he,I[B++]=Le,I[B++]=be,I[B++]=255}--M}},this.decodeAndBlitFrameRGBA=function(O,I){var W=this.frameInfo(O),ne=W.width*W.height,Q=new Uint8Array(ne);vS(t,W.data_offset,Q,ne);var le=W.palette_offset,ee=W.transparent_index;ee===null&&(ee=256);var K=W.width,ue=r-K,M=K,A=4*(W.y*r+W.x),D=4*((W.y+W.height)*r+W.x),B=A,q=4*ue;W.interlaced===!0&&(q+=4*r*7);for(var Z=8,oe=0,pe=Q.length;oe<pe;++oe){var _e=Q[oe];if(M===0&&(M=K,(B+=q)>=D&&(q=4*ue+4*r*(Z-1),B=A+(K+ue)*(Z<<1),Z>>=1)),_e===ee)B+=4;else{var be=t[le+3*_e],Le=t[le+3*_e+1],he=t[le+3*_e+2];I[B++]=be,I[B++]=Le,I[B++]=he,I[B++]=255}--M}}}function vS(t,e,r,a){for(var n=t[e++],s=1<<n,o=s+1,u=o+1,f=n+1,h=(1<<f)-1,m=0,v=0,y=0,g=t[e++],b=new Int32Array(4096),_=null;;){for(;m<16&&g!==0;)v|=t[e++]<<m,m+=8,g===1?g=t[e++]:--g;if(m<f)break;var S=v&h;if(v>>=f,m-=f,S!==s){if(S===o)break;for(var E=S<u?S:_,C=0,j=E;j>s;)j=b[j]>>8,++C;var R=j;if(y+C+(E!==S?1:0)>a)return void Oa.log("Warning, gif stream longer than expected.");r[y++]=R;var H=y+=C;for(E!==S&&(r[y++]=R),j=E;C--;)j=b[j],r[--H]=255&j,j>>=8;_!==null&&u<4096&&(b[u++]=_<<8|R,u>=h+1&&f<12&&(++f,h=h<<1|1)),_=S}else u=o+1,h=(1<<(f=n+1))-1,_=null}return y!==a&&Oa.log("Warning, gif stream shorter than expected."),r}function Dv(t){var e,r,a,n,s,o=Math.floor,u=new Array(64),f=new Array(64),h=new Array(64),m=new Array(64),v=new Array(65535),y=new Array(65535),g=new Array(64),b=new Array(64),_=[],S=0,E=7,C=new Array(64),j=new Array(64),R=new Array(64),H=new Array(256),Y=new Array(2048),U=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],V=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],F=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],P=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],O=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],I=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ne=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Q(A,D){for(var B=0,q=0,Z=new Array,oe=1;oe<=16;oe++){for(var pe=1;pe<=A[oe];pe++)Z[D[q]]=[],Z[D[q]][0]=B,Z[D[q]][1]=oe,q++,B++;B*=2}return Z}function le(A){for(var D=A[0],B=A[1]-1;B>=0;)D&1<<B&&(S|=1<<E),B--,--E<0&&(S==255?(ee(255),ee(0)):ee(S),E=7,S=0)}function ee(A){_.push(A)}function K(A){ee(A>>8&255),ee(255&A)}function ue(A,D,B,q,Z){for(var oe,pe=Z[0],_e=Z[240],be=(function(tt,Et){var kt,zt,Tt,at,pt,At,Dt,xt,St,ft,yt=0;for(St=0;St<8;++St){kt=tt[yt],zt=tt[yt+1],Tt=tt[yt+2],at=tt[yt+3],pt=tt[yt+4],At=tt[yt+5],Dt=tt[yt+6];var er=kt+(xt=tt[yt+7]),Lt=kt-xt,Bt=zt+Dt,we=zt-Dt,Ie=Tt+At,ve=Tt-At,Ue=at+pt,Be=at-pt,Rt=er+Ue,Ht=er-Ue,Kt=Bt+Ie,$t=Bt-Ie;tt[yt]=Rt+Kt,tt[yt+4]=Rt-Kt;var Nr=.707106781*($t+Ht);tt[yt+2]=Ht+Nr,tt[yt+6]=Ht-Nr;var Jn=.382683433*((Rt=Be+ve)-($t=we+Lt)),ja=.5411961*Rt+Jn,Ct=1.306562965*$t+Jn,Ha=.707106781*(Kt=ve+we),_t=Lt+Ha,mr=Lt-Ha;tt[yt+5]=mr+ja,tt[yt+3]=mr-ja,tt[yt+1]=_t+Ct,tt[yt+7]=_t-Ct,yt+=8}for(yt=0,St=0;St<8;++St){kt=tt[yt],zt=tt[yt+8],Tt=tt[yt+16],at=tt[yt+24],pt=tt[yt+32],At=tt[yt+40],Dt=tt[yt+48];var Jr=kt+(xt=tt[yt+56]),qr=kt-xt,Xa=zt+Dt,$r=zt-Dt,Ea=Tt+At,ae=Tt-At,je=at+pt,ge=at-pt,xe=Jr+je,Se=Jr-je,Ce=Xa+Ea,We=Xa-Ea;tt[yt]=xe+Ce,tt[yt+32]=xe-Ce;var st=.707106781*(We+Se);tt[yt+16]=Se+st,tt[yt+48]=Se-st;var Ge=.382683433*((xe=ge+ae)-(We=$r+qr)),Ye=.5411961*xe+Ge,Je=1.306562965*We+Ge,Nt=.707106781*(Ce=ae+$r),Ft=qr+Nt,qt=qr-Nt;tt[yt+40]=qt+Ye,tt[yt+24]=qt-Ye,tt[yt+8]=Ft+Je,tt[yt+56]=Ft-Je,yt++}for(St=0;St<64;++St)ft=tt[St]*Et[St],g[St]=ft>0?ft+.5|0:ft-.5|0;return g})(A,D),Le=0;Le<64;++Le)b[U[Le]]=be[Le];var he=b[0]-B;B=b[0],he==0?le(q[0]):(le(q[y[oe=32767+he]]),le(v[oe]));for(var Ae=63;Ae>0&&b[Ae]==0;)Ae--;if(Ae==0)return le(pe),B;for(var de,re=1;re<=Ae;){for(var Ke=re;b[re]==0&&re<=Ae;)++re;var Oe=re-Ke;if(Oe>=16){de=Oe>>4;for(var rt=1;rt<=de;++rt)le(_e);Oe&=15}oe=32767+b[re],le(Z[(Oe<<4)+y[oe]]),le(v[oe]),re++}return Ae!=63&&le(pe),B}function M(A){A=Math.min(Math.max(A,1),100),s!=A&&((function(D){for(var B=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],q=0;q<64;q++){var Z=o((B[q]*D+50)/100);Z=Math.min(Math.max(Z,1),255),u[U[q]]=Z}for(var oe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],pe=0;pe<64;pe++){var _e=o((oe[pe]*D+50)/100);_e=Math.min(Math.max(_e,1),255),f[U[pe]]=_e}for(var be=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Le=0,he=0;he<8;he++)for(var Ae=0;Ae<8;Ae++)h[Le]=1/(u[U[Le]]*be[he]*be[Ae]*8),m[Le]=1/(f[U[Le]]*be[he]*be[Ae]*8),Le++})(A<50?Math.floor(5e3/A):Math.floor(200-2*A)),s=A)}this.encode=function(A,D){D&&M(D),_=new Array,S=0,E=7,K(65496),K(65504),K(16),ee(74),ee(70),ee(73),ee(70),ee(0),ee(1),ee(1),ee(0),K(1),K(1),ee(0),ee(0),(function(){K(65499),K(132),ee(0);for(var zt=0;zt<64;zt++)ee(u[zt]);ee(1);for(var Tt=0;Tt<64;Tt++)ee(f[Tt])})(),(function(zt,Tt){K(65472),K(17),ee(8),K(Tt),K(zt),ee(3),ee(1),ee(17),ee(0),ee(2),ee(17),ee(1),ee(3),ee(17),ee(1)})(A.width,A.height),(function(){K(65476),K(418),ee(0);for(var zt=0;zt<16;zt++)ee(V[zt+1]);for(var Tt=0;Tt<=11;Tt++)ee(F[Tt]);ee(16);for(var at=0;at<16;at++)ee(X[at+1]);for(var pt=0;pt<=161;pt++)ee(P[pt]);ee(1);for(var At=0;At<16;At++)ee(O[At+1]);for(var Dt=0;Dt<=11;Dt++)ee(I[Dt]);ee(17);for(var xt=0;xt<16;xt++)ee(W[xt+1]);for(var St=0;St<=161;St++)ee(ne[St])})(),K(65498),K(12),ee(3),ee(1),ee(0),ee(2),ee(17),ee(3),ee(17),ee(0),ee(63),ee(0);var B=0,q=0,Z=0;S=0,E=7,this.encode.displayName="_encode_";for(var oe,pe,_e,be,Le,he,Ae,de,re,Ke=A.data,Oe=A.width,rt=A.height,tt=4*Oe,Et=0;Et<rt;){for(oe=0;oe<tt;){for(Le=tt*Et+oe,Ae=-1,de=0,re=0;re<64;re++)he=Le+(de=re>>3)*tt+(Ae=4*(7&re)),Et+de>=rt&&(he-=tt*(Et+1+de-rt)),oe+Ae>=tt&&(he-=oe+Ae-tt+4),pe=Ke[he++],_e=Ke[he++],be=Ke[he++],C[re]=(Y[pe]+Y[_e+256|0]+Y[be+512|0]>>16)-128,j[re]=(Y[pe+768|0]+Y[_e+1024|0]+Y[be+1280|0]>>16)-128,R[re]=(Y[pe+1280|0]+Y[_e+1536|0]+Y[be+1792|0]>>16)-128;B=ue(C,h,B,e,a),q=ue(j,m,q,r,n),Z=ue(R,m,Z,r,n),oe+=32}Et+=8}if(E>=0){var kt=[];kt[1]=E+1,kt[0]=(1<<E+1)-1,le(kt)}return K(65497),new Uint8Array(_)},t=t||50,(function(){for(var A=String.fromCharCode,D=0;D<256;D++)H[D]=A(D)})(),e=Q(V,F),r=Q(O,I),a=Q(X,P),n=Q(W,ne),(function(){for(var A=1,D=2,B=1;B<=15;B++){for(var q=A;q<D;q++)y[32767+q]=B,v[32767+q]=[],v[32767+q][1]=B,v[32767+q][0]=q;for(var Z=-(D-1);Z<=-A;Z++)y[32767+Z]=B,v[32767+Z]=[],v[32767+Z][1]=B,v[32767+Z][0]=D-1+Z;A<<=1,D<<=1}})(),(function(){for(var A=0;A<256;A++)Y[A]=19595*A,Y[A+256|0]=38470*A,Y[A+512|0]=7471*A+32768,Y[A+768|0]=-11059*A,Y[A+1024|0]=-21709*A,Y[A+1280|0]=32768*A+8421375,Y[A+1536|0]=-27439*A,Y[A+1792|0]=-5329*A})(),M(t)}function zo(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function xS(t){function e(F){if(!F)throw Error("assert :P")}function r(F,X,P){for(var O=0;4>O;O++)if(F[X+O]!=P.charCodeAt(O))return!0;return!1}function a(F,X,P,O,I){for(var W=0;W<I;W++)F[X+W]=P[O+W]}function n(F,X,P,O){for(var I=0;I<O;I++)F[X+I]=P}function s(F){return new Int32Array(F)}function o(F,X){for(var P=[],O=0;O<F;O++)P.push(new X);return P}function u(F,X){var P=[];return(function O(I,W,ne){for(var Q=ne[W],le=0;le<Q&&(I.push(ne.length>W+1?[]:new X),!(ne.length<W+1));le++)O(I[le],W+1,ne)})(P,0,F),P}var f=function(){var F=this;function X(x,N){for(var L=1<<N-1>>>0;x&L;)L>>>=1;return L?(x&L-1)+L:x}function P(x,N,L,z,te){e(!(z%L));do x[N+(z-=L)]=te;while(0<z)}function O(x,N,L,z,te){if(e(2328>=te),512>=te)var ie=s(512);else if((ie=s(te))==null)return 0;return(function(ce,me,ye,ke,De,Xe){var Ne,Me,He=me,ot=1<<ye,Ve=s(16),it=s(16);for(e(De!=0),e(ke!=null),e(ce!=null),e(0<ye),Me=0;Me<De;++Me){if(15<ke[Me])return 0;++Ve[ke[Me]]}if(Ve[0]==De)return 0;for(it[1]=0,Ne=1;15>Ne;++Ne){if(Ve[Ne]>1<<Ne)return 0;it[Ne+1]=it[Ne]+Ve[Ne]}for(Me=0;Me<De;++Me)Ne=ke[Me],0<ke[Me]&&(Xe[it[Ne]++]=Me);if(it[15]==1)return(ke=new I).g=0,ke.value=Xe[0],P(ce,He,1,ot,ke),ot;var dt,jt=-1,vt=ot-1,tr=0,Wt=1,br=1,Xt=1<<ye;for(Me=0,Ne=1,De=2;Ne<=ye;++Ne,De<<=1){if(Wt+=br<<=1,0>(br-=Ve[Ne]))return 0;for(;0<Ve[Ne];--Ve[Ne])(ke=new I).g=Ne,ke.value=Xe[Me++],P(ce,He+tr,De,Xt,ke),tr=X(tr,Ne)}for(Ne=ye+1,De=2;15>=Ne;++Ne,De<<=1){if(Wt+=br<<=1,0>(br-=Ve[Ne]))return 0;for(;0<Ve[Ne];--Ve[Ne]){if(ke=new I,(tr&vt)!=jt){for(He+=Xt,dt=1<<(jt=Ne)-ye;15>jt&&!(0>=(dt-=Ve[jt]));)++jt,dt<<=1;ot+=Xt=1<<(dt=jt-ye),ce[me+(jt=tr&vt)].g=dt+ye,ce[me+jt].value=He-me-jt}ke.g=Ne-ye,ke.value=Xe[Me++],P(ce,He+(tr>>ye),De,Xt,ke),tr=X(tr,Ne)}}return Wt!=2*it[15]-1?0:ot})(x,N,L,z,te,ie)}function I(){this.value=this.g=0}function W(){this.value=this.g=0}function ne(){this.G=o(5,I),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(nl,W)}function Q(x,N,L,z){e(x!=null),e(N!=null),e(2147483648>z),x.Ca=254,x.I=0,x.b=-8,x.Ka=0,x.oa=N,x.pa=L,x.Jd=N,x.Yc=L+z,x.Zc=4<=z?L+z-4+1:L,pe(x)}function le(x,N){for(var L=0;0<N--;)L|=be(x,128)<<N;return L}function ee(x,N){var L=le(x,N);return _e(x)?-L:L}function K(x,N,L,z){var te,ie=0;for(e(x!=null),e(N!=null),e(4294967288>z),x.Sb=z,x.Ra=0,x.u=0,x.h=0,4<z&&(z=4),te=0;te<z;++te)ie+=N[L+te]<<8*te;x.Ra=ie,x.bb=z,x.oa=N,x.pa=L}function ue(x){for(;8<=x.u&&x.bb<x.Sb;)x.Ra>>>=8,x.Ra+=x.oa[x.pa+x.bb]<<Gi-8>>>0,++x.bb,x.u-=8;q(x)&&(x.h=1,x.u=0)}function M(x,N){if(e(0<=N),!x.h&&N<=hs){var L=B(x)&ws[N];return x.u+=N,ue(x),L}return x.h=1,x.u=0}function A(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function D(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function B(x){return x.Ra>>>(x.u&Gi-1)>>>0}function q(x){return e(x.bb<=x.Sb),x.h||x.bb==x.Sb&&x.u>Gi}function Z(x,N){x.u=N,x.h=q(x)}function oe(x){x.u>=Yi&&(e(x.u>=Yi),ue(x))}function pe(x){e(x!=null&&x.oa!=null),x.pa<x.Zc?(x.I=(x.oa[x.pa++]|x.I<<8)>>>0,x.b+=8):(e(x!=null&&x.oa!=null),x.pa<x.Yc?(x.b+=8,x.I=x.oa[x.pa++]|x.I<<8):x.Ka?x.b=0:(x.I<<=8,x.b+=8,x.Ka=1))}function _e(x){return le(x,1)}function be(x,N){var L=x.Ca;0>x.b&&pe(x);var z=x.b,te=L*N>>>8,ie=(x.I>>>z>te)+0;for(ie?(L-=te,x.I-=te+1<<z>>>0):L=te+1,z=L,te=0;256<=z;)te+=8,z>>=8;return z=7^te+Ao[z],x.b-=z,x.Ca=(L<<z)-1,ie}function Le(x,N,L){x[N+0]=L>>24&255,x[N+1]=L>>16&255,x[N+2]=L>>8&255,x[N+3]=255&L}function he(x,N){return x[N+0]|x[N+1]<<8}function Ae(x,N){return he(x,N)|x[N+2]<<16}function de(x,N){return he(x,N)|he(x,N+2)<<16}function re(x,N){var L=1<<N;return e(x!=null),e(0<N),x.X=s(L),x.X==null?0:(x.Mb=32-N,x.Xa=N,1)}function Ke(x,N){e(x!=null),e(N!=null),e(x.Xa==N.Xa),a(N.X,0,x.X,0,1<<N.Xa)}function Oe(){this.X=[],this.Xa=this.Mb=0}function rt(x,N,L,z){e(L!=null),e(z!=null);var te=L[0],ie=z[0];return te==0&&(te=(x*ie+N/2)/N),ie==0&&(ie=(N*te+x/2)/x),0>=te||0>=ie?0:(L[0]=te,z[0]=ie,1)}function tt(x,N){return x+(1<<N)-1>>>N}function Et(x,N){return((4278255360&x)+(4278255360&N)>>>0&4278255360)+((16711935&x)+(16711935&N)>>>0&16711935)>>>0}function kt(x,N){F[N]=function(L,z,te,ie,ce,me,ye){var ke;for(ke=0;ke<ce;++ke){var De=F[x](me[ye+ke-1],te,ie+ke);me[ye+ke]=Et(L[z+ke],De)}}}function zt(){this.ud=this.hd=this.jd=0}function Tt(x,N){return((4278124286&(x^N))>>>1)+(x&N)>>>0}function at(x){return 0<=x&&256>x?x:0>x?0:255<x?255:void 0}function pt(x,N){return at(x+(x-N+.5>>1))}function At(x,N,L){return Math.abs(N-L)-Math.abs(x-L)}function Dt(x,N,L,z,te,ie,ce){for(z=ie[ce-1],L=0;L<te;++L)ie[ce+L]=z=Et(x[N+L],z)}function xt(x,N,L,z,te){var ie;for(ie=0;ie<L;++ie){var ce=x[N+ie],me=ce>>8&255,ye=16711935&(ye=(ye=16711935&ce)+((me<<16)+me));z[te+ie]=(4278255360&ce)+ye>>>0}}function St(x,N){N.jd=255&x,N.hd=x>>8&255,N.ud=x>>16&255}function ft(x,N,L,z,te,ie){var ce;for(ce=0;ce<z;++ce){var me=N[L+ce],ye=me>>>8,ke=me,De=255&(De=(De=me>>>16)+((x.jd<<24>>24)*(ye<<24>>24)>>>5));ke=255&(ke=(ke+=(x.hd<<24>>24)*(ye<<24>>24)>>>5)+((x.ud<<24>>24)*(De<<24>>24)>>>5)),te[ie+ce]=(4278255360&me)+(De<<16)+ke}}function yt(x,N,L,z,te){F[N]=function(ie,ce,me,ye,ke,De,Xe,Ne,Me){for(ye=Xe;ye<Ne;++ye)for(Xe=0;Xe<Me;++Xe)ke[De++]=te(me[z(ie[ce++])])},F[x]=function(ie,ce,me,ye,ke,De,Xe){var Ne=8>>ie.b,Me=ie.Ea,He=ie.K[0],ot=ie.w;if(8>Ne)for(ie=(1<<ie.b)-1,ot=(1<<Ne)-1;ce<me;++ce){var Ve,it=0;for(Ve=0;Ve<Me;++Ve)Ve&ie||(it=z(ye[ke++])),De[Xe++]=te(He[it&ot]),it>>=Ne}else F["VP8LMapColor"+L](ye,ke,He,ot,De,Xe,ce,me,Me)}}function er(x,N,L,z,te){for(L=N+L;N<L;){var ie=x[N++];z[te++]=ie>>16&255,z[te++]=ie>>8&255,z[te++]=255&ie}}function Lt(x,N,L,z,te){for(L=N+L;N<L;){var ie=x[N++];z[te++]=ie>>16&255,z[te++]=ie>>8&255,z[te++]=255&ie,z[te++]=ie>>24&255}}function Bt(x,N,L,z,te){for(L=N+L;N<L;){var ie=(ce=x[N++])>>16&240|ce>>12&15,ce=240&ce|ce>>28&15;z[te++]=ie,z[te++]=ce}}function we(x,N,L,z,te){for(L=N+L;N<L;){var ie=(ce=x[N++])>>16&248|ce>>13&7,ce=ce>>5&224|ce>>3&31;z[te++]=ie,z[te++]=ce}}function Ie(x,N,L,z,te){for(L=N+L;N<L;){var ie=x[N++];z[te++]=255&ie,z[te++]=ie>>8&255,z[te++]=ie>>16&255}}function ve(x,N,L,z,te,ie){if(ie==0)for(L=N+L;N<L;)Le(z,((ie=x[N++])[0]>>24|ie[1]>>8&65280|ie[2]<<8&16711680|ie[3]<<24)>>>0),te+=32;else a(z,te,x,N,L)}function Ue(x,N){F[N][0]=F[x+"0"],F[N][1]=F[x+"1"],F[N][2]=F[x+"2"],F[N][3]=F[x+"3"],F[N][4]=F[x+"4"],F[N][5]=F[x+"5"],F[N][6]=F[x+"6"],F[N][7]=F[x+"7"],F[N][8]=F[x+"8"],F[N][9]=F[x+"9"],F[N][10]=F[x+"10"],F[N][11]=F[x+"11"],F[N][12]=F[x+"12"],F[N][13]=F[x+"13"],F[N][14]=F[x+"0"],F[N][15]=F[x+"0"]}function Be(x){return x==Uu||x==Kf||x==Oc||x==Jf}function Rt(){this.eb=[],this.size=this.A=this.fb=0}function Ht(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Kt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Rt,this.f.kb=new Ht,this.sd=null}function $t(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Nr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Jn(x){return alert("todo:WebPSamplerProcessPlane"),x.T}function ja(x,N){var L=x.T,z=N.ba.f.RGBA,te=z.eb,ie=z.fb+x.ka*z.A,ce=Hn[N.ba.S],me=x.y,ye=x.O,ke=x.f,De=x.N,Xe=x.ea,Ne=x.W,Me=N.cc,He=N.dc,ot=N.Mc,Ve=N.Nc,it=x.ka,dt=x.ka+x.T,jt=x.U,vt=jt+1>>1;for(it==0?ce(me,ye,null,null,ke,De,Xe,Ne,ke,De,Xe,Ne,te,ie,null,null,jt):(ce(N.ec,N.fc,me,ye,Me,He,ot,Ve,ke,De,Xe,Ne,te,ie-z.A,te,ie,jt),++L);it+2<dt;it+=2)Me=ke,He=De,ot=Xe,Ve=Ne,De+=x.Rc,Ne+=x.Rc,ie+=2*z.A,ce(me,(ye+=2*x.fa)-x.fa,me,ye,Me,He,ot,Ve,ke,De,Xe,Ne,te,ie-z.A,te,ie,jt);return ye+=x.fa,x.j+dt<x.o?(a(N.ec,N.fc,me,ye,jt),a(N.cc,N.dc,ke,De,vt),a(N.Mc,N.Nc,Xe,Ne,vt),L--):1&dt||ce(me,ye,null,null,ke,De,Xe,Ne,ke,De,Xe,Ne,te,ie+z.A,null,null,jt),L}function Ct(x,N,L){var z=x.F,te=[x.J];if(z!=null){var ie=x.U,ce=N.ba.S,me=ce==Bu||ce==Oc;N=N.ba.f.RGBA;var ye=[0],ke=x.ka;ye[0]=x.T,x.Kb&&(ke==0?--ye[0]:(--ke,te[0]-=x.width),x.j+x.ka+x.T==x.o&&(ye[0]=x.o-x.j-ke));var De=N.eb;ke=N.fb+ke*N.A,x=Lu(z,te[0],x.width,ie,ye,De,ke+(me?0:3),N.A),e(L==ye),x&&Be(ce)&&Bl(De,ke,me,ie,ye,N.A)}return 0}function Ha(x){var N=x.ma,L=N.ba.S,z=11>L,te=L==es||L==Zs||L==Bu||L==Tc||L==12||Be(L);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!Eo(N.Oa,x,te?11:12))return 0;if(te&&Be(L)&&Ou(),x.da)alert("todo:use_scaling");else{if(z){if(N.Ib=Jn,x.Kb){if(L=x.U+1>>1,N.memory=s(x.U+2*L),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+x.U,N.Mc=N.cc,N.Nc=N.dc+L,N.Ib=ja,Ou()}}else alert("todo:EmitYUV");te&&(N.Jb=Ct,z&&_i())}if(z&&!fl){for(x=0;256>x;++x)$n[x]=89858*(x-128)+Fc>>ni,S1[x]=-22014*(x-128)+Fc,am[x]=-45773*(x-128),rh[x]=113618*(x-128)+Fc>>ni;for(x=Hl;x<ul;++x)N=76283*(x-16)+Fc>>ni,N1[x-Hl]=Da(N,255),k1[x-Hl]=Da(N+8>>4,15);fl=1}return 1}function _t(x){var N=x.ma,L=x.U,z=x.T;return e(!(1&x.ka)),0>=L||0>=z?0:(L=N.Ib(x,N),N.Jb!=null&&N.Jb(x,N,L),N.Dc+=L,1)}function mr(x){x.ma.memory=null}function Jr(x,N,L,z){return M(x,8)!=47?0:(N[0]=M(x,14)+1,L[0]=M(x,14)+1,z[0]=M(x,1),M(x,3)!=0?0:!x.h)}function qr(x,N){if(4>x)return x+1;var L=x-2>>1;return(2+(1&x)<<L)+M(N,L)+1}function Xa(x,N){return 120<N?N-120:1<=(L=((L=ei[N-1])>>4)*x+(8-(15&L)))?L:1;var L}function $r(x,N,L){var z=B(L),te=x[N+=255&z].g-8;return 0<te&&(Z(L,L.u+8),z=B(L),N+=x[N].value,N+=z&(1<<te)-1),Z(L,L.u+x[N].g),x[N].value}function Ea(x,N,L){return L.g+=x.g,L.value+=x.value<<N>>>0,e(8>=L.g),x.g}function ae(x,N,L){var z=x.xc;return e((N=z==0?0:x.vc[x.md*(L>>z)+(N>>z)])<x.Wb),x.Ya[N]}function je(x,N,L,z){var te=x.ab,ie=x.c*N,ce=x.C;N=ce+N;var me=L,ye=z;for(z=x.Ta,L=x.Ua;0<te--;){var ke=x.gc[te],De=ce,Xe=N,Ne=me,Me=ye,He=(ye=z,me=L,ke.Ea);switch(e(De<Xe),e(Xe<=ke.nc),ke.hc){case 2:Ja(Ne,Me,(Xe-De)*He,ye,me);break;case 0:var ot=De,Ve=Xe,it=ye,dt=me,jt=(Xt=ke).Ea;ot==0&&(jc(Ne,Me,null,null,1,it,dt),Dt(Ne,Me+1,0,0,jt-1,it,dt+1),Me+=jt,dt+=jt,++ot);for(var vt=1<<Xt.b,tr=vt-1,Wt=tt(jt,Xt.b),br=Xt.K,Xt=Xt.w+(ot>>Xt.b)*Wt;ot<Ve;){var Pr=br,Ca=Xt,jr=1;for(Ec(Ne,Me,it,dt-jt,1,it,dt);jr<jt;){var Vt=(jr&~tr)+vt;Vt>jt&&(Vt=jt),(0,Co[Pr[Ca++]>>8&15])(Ne,Me+ +jr,it,dt+jr-jt,Vt-jr,it,dt+jr),jr=Vt}Me+=jt,dt+=jt,++ot&tr||(Xt+=Wt)}Xe!=ke.nc&&a(ye,me-He,ye,me+(Xe-De-1)*He,He);break;case 1:for(He=Ne,Ve=Me,jt=(Ne=ke.Ea)-(dt=Ne&~(it=(Me=1<<ke.b)-1)),ot=tt(Ne,ke.b),vt=ke.K,ke=ke.w+(De>>ke.b)*ot;De<Xe;){for(tr=vt,Wt=ke,br=new zt,Xt=Ve+dt,Pr=Ve+Ne;Ve<Xt;)St(tr[Wt++],br),Ac(br,He,Ve,Me,ye,me),Ve+=Me,me+=Me;Ve<Pr&&(St(tr[Wt++],br),Ac(br,He,Ve,jt,ye,me),Ve+=jt,me+=jt),++De&it||(ke+=ot)}break;case 3:if(Ne==ye&&Me==me&&0<ke.b){for(Ve=ye,Ne=He=me+(Xe-De)*He-(dt=(Xe-De)*tt(ke.Ea,ke.b)),Me=ye,it=me,ot=[],dt=(jt=dt)-1;0<=dt;--dt)ot[dt]=Me[it+dt];for(dt=jt-1;0<=dt;--dt)Ve[Ne+dt]=ot[dt];Wf(ke,De,Xe,ye,He,ye,me)}else Wf(ke,De,Xe,Ne,Me,ye,me)}me=z,ye=L}ye!=L&&a(z,L,me,ye,ie)}function ge(x,N){var L=x.V,z=x.Ba+x.c*x.C,te=N-x.C;if(e(N<=x.l.o),e(16>=te),0<te){var ie=x.l,ce=x.Ta,me=x.Ua,ye=ie.width;if(je(x,te,L,z),te=me=[me],e((L=x.C)<(z=N)),e(ie.v<ie.va),z>ie.o&&(z=ie.o),L<ie.j){var ke=ie.j-L;L=ie.j,te[0]+=ke*ye}if(L>=z?L=0:(te[0]+=4*ie.v,ie.ka=L-ie.j,ie.U=ie.va-ie.v,ie.T=z-L,L=1),L){if(me=me[0],11>(L=x.ca).S){var De=L.f.RGBA,Xe=(z=L.S,te=ie.U,ie=ie.T,ke=De.eb,De.A),Ne=ie;for(De=De.fb+x.Ma*De.A;0<Ne--;){var Me=ce,He=me,ot=te,Ve=ke,it=De;switch(z){case Yf:Cc(Me,He,ot,Ve,it);break;case es:To(Me,He,ot,Ve,it);break;case Uu:To(Me,He,ot,Ve,it),Bl(Ve,it,0,ot,1,0);break;case Xf:Ml(Me,He,ot,Ve,it);break;case Zs:ve(Me,He,ot,Ve,it,1);break;case Kf:ve(Me,He,ot,Ve,it,1),Bl(Ve,it,0,ot,1,0);break;case Bu:ve(Me,He,ot,Ve,it,0);break;case Oc:ve(Me,He,ot,Ve,it,0),Bl(Ve,it,1,ot,1,0);break;case Tc:Oo(Me,He,ot,Ve,it);break;case Jf:Oo(Me,He,ot,Ve,it),Js(Ve,it,ot,1,0);break;case sl:Ji(Me,He,ot,Ve,it);break;default:e(0)}me+=ye,De+=Xe}x.Ma+=ie}else alert("todo:EmitRescaledRowsYUVA");e(x.Ma<=L.height)}}x.C=N,e(x.C<=x.i)}function xe(x){var N;if(0<x.ua)return 0;for(N=0;N<x.Wb;++N){var L=x.Ya[N].G,z=x.Ya[N].H;if(0<L[1][z[1]+0].g||0<L[2][z[2]+0].g||0<L[3][z[3]+0].g)return 0}return 1}function Se(x,N,L,z,te,ie){if(x.Z!=0){var ce=x.qd,me=x.rd;for(e(Fo[x.Z]!=null);N<L;++N)Fo[x.Z](ce,me,z,te,z,te,ie),ce=z,me=te,te+=ie;x.qd=ce,x.rd=me}}function Ce(x,N){var L=x.l.ma,z=L.Z==0||L.Z==1?x.l.j:x.C;if(z=x.C<z?z:x.C,e(N<=x.l.o),N>z){var te=x.l.width,ie=L.ca,ce=L.tb+te*z,me=x.V,ye=x.Ba+x.c*z,ke=x.gc;e(x.ab==1),e(ke[0].hc==3),Ki(ke[0],z,N,me,ye,ie,ce),Se(L,z,N,ie,ce,te)}x.C=x.Ma=N}function We(x,N,L,z,te,ie,ce){var me=x.$/z,ye=x.$%z,ke=x.m,De=x.s,Xe=L+x.$,Ne=Xe;te=L+z*te;var Me=L+z*ie,He=280+De.ua,ot=x.Pb?me:16777216,Ve=0<De.ua?De.Wa:null,it=De.wc,dt=Xe<Me?ae(De,ye,me):null;e(x.C<ie),e(Me<=te);var jt=!1;e:for(;;){for(;jt||Xe<Me;){var vt=0;if(me>=ot){var tr=Xe-L;e((ot=x).Pb),ot.wd=ot.m,ot.xd=tr,0<ot.s.ua&&Ke(ot.s.Wa,ot.s.vb),ot=me+il}if(ye&it||(dt=ae(De,ye,me)),e(dt!=null),dt.Qb&&(N[Xe]=dt.qb,jt=!0),!jt)if(oe(ke),dt.jc){vt=ke,tr=N;var Wt=Xe,br=dt.pd[B(vt)&nl-1];e(dt.jc),256>br.g?(Z(vt,vt.u+br.g),tr[Wt]=br.value,vt=0):(Z(vt,vt.u+br.g-256),e(256<=br.value),vt=br.value),vt==0&&(jt=!0)}else vt=$r(dt.G[0],dt.H[0],ke);if(ke.h)break;if(jt||256>vt){if(!jt)if(dt.nd)N[Xe]=(dt.qb|vt<<8)>>>0;else{if(oe(ke),jt=$r(dt.G[1],dt.H[1],ke),oe(ke),tr=$r(dt.G[2],dt.H[2],ke),Wt=$r(dt.G[3],dt.H[3],ke),ke.h)break;N[Xe]=(Wt<<24|jt<<16|vt<<8|tr)>>>0}if(jt=!1,++Xe,++ye>=z&&(ye=0,++me,ce!=null&&me<=ie&&!(me%16)&&ce(x,me),Ve!=null))for(;Ne<Xe;)vt=N[Ne++],Ve.X[(506832829*vt&4294967295)>>>Ve.Mb]=vt}else if(280>vt){if(vt=qr(vt-256,ke),tr=$r(dt.G[4],dt.H[4],ke),oe(ke),tr=Xa(z,tr=qr(tr,ke)),ke.h)break;if(Xe-L<tr||te-Xe<vt)break e;for(Wt=0;Wt<vt;++Wt)N[Xe+Wt]=N[Xe+Wt-tr];for(Xe+=vt,ye+=vt;ye>=z;)ye-=z,++me,ce!=null&&me<=ie&&!(me%16)&&ce(x,me);if(e(Xe<=te),ye&it&&(dt=ae(De,ye,me)),Ve!=null)for(;Ne<Xe;)vt=N[Ne++],Ve.X[(506832829*vt&4294967295)>>>Ve.Mb]=vt}else{if(!(vt<He))break e;for(jt=vt-280,e(Ve!=null);Ne<Xe;)vt=N[Ne++],Ve.X[(506832829*vt&4294967295)>>>Ve.Mb]=vt;vt=Xe,e(!(jt>>>(tr=Ve).Xa)),N[vt]=tr.X[jt],jt=!0}jt||e(ke.h==q(ke))}if(x.Pb&&ke.h&&Xe<te)e(x.m.h),x.a=5,x.m=x.wd,x.$=x.xd,0<x.s.ua&&Ke(x.s.vb,x.s.Wa);else{if(ke.h)break e;ce?.(x,me>ie?ie:me),x.a=0,x.$=Xe-L}return 1}return x.a=3,0}function st(x){e(x!=null),x.vc=null,x.yc=null,x.Ya=null;var N=x.Wa;N!=null&&(N.X=null),x.vb=null,e(x!=null)}function Ge(){var x=new gr;return x==null?null:(x.a=0,x.xb=xd,Ue("Predictor","VP8LPredictors"),Ue("Predictor","VP8LPredictors_C"),Ue("PredictorAdd","VP8LPredictorsAdd"),Ue("PredictorAdd","VP8LPredictorsAdd_C"),Ja=xt,Ac=ft,Cc=er,To=Lt,Oo=Bt,Ji=we,Ml=Ie,F.VP8LMapColor32b=Xi,F.VP8LMapColor8b=Un,x)}function Ye(x,N,L,z,te){var ie=1,ce=[x],me=[N],ye=z.m,ke=z.s,De=null,Xe=0;e:for(;;){if(L)for(;ie&&M(ye,1);){var Ne=ce,Me=me,He=z,ot=1,Ve=He.m,it=He.gc[He.ab],dt=M(Ve,2);if(He.Oc&1<<dt)ie=0;else{switch(He.Oc|=1<<dt,it.hc=dt,it.Ea=Ne[0],it.nc=Me[0],it.K=[null],++He.ab,e(4>=He.ab),dt){case 0:case 1:it.b=M(Ve,3)+2,ot=Ye(tt(it.Ea,it.b),tt(it.nc,it.b),0,He,it.K),it.K=it.K[0];break;case 3:var jt,vt=M(Ve,8)+1,tr=16<vt?0:4<vt?1:2<vt?2:3;if(Ne[0]=tt(it.Ea,tr),it.b=tr,jt=ot=Ye(vt,1,0,He,it.K)){var Wt,br=vt,Xt=it,Pr=1<<(8>>Xt.b),Ca=s(Pr);if(Ca==null)jt=0;else{var jr=Xt.K[0],Vt=Xt.w;for(Ca[0]=Xt.K[0][0],Wt=1;Wt<1*br;++Wt)Ca[Wt]=Et(jr[Vt+Wt],Ca[Wt-1]);for(;Wt<4*Pr;++Wt)Ca[Wt]=0;Xt.K[0]=null,Xt.K[0]=Ca,jt=1}}ot=jt;break;case 2:break;default:e(0)}ie=ot}}if(ce=ce[0],me=me[0],ie&&M(ye,1)&&!(ie=1<=(Xe=M(ye,4))&&11>=Xe)){z.a=3;break e}var Ut;if(Ut=ie)t:{var La,dr,Cr,la=z,yn=ce,Wn=me,ba=Xe,on=L,ts=la.m,ln=la.s,Dr=[null],Yr=1,Pa=0,ea=ti[ba];r:for(;;){if(on&&M(ts,1)){var _n=M(ts,3)+2,Ma=tt(yn,_n),Xr=tt(Wn,_n),en=Ma*Xr;if(!Ye(Ma,Xr,0,la,Dr))break r;for(Dr=Dr[0],ln.xc=_n,La=0;La<en;++La){var ca=Dr[La]>>8&65535;Dr[La]=ca,ca>=Yr&&(Yr=ca+1)}}if(ts.h)break r;for(dr=0;5>dr;++dr){var cn=ql[dr];!dr&&0<ba&&(cn+=1<<ba),Pa<cn&&(Pa=cn)}var un=o(Yr*ea,I),ha=Yr,Gr=o(ha,ne);if(Gr==null)var rs=null;else e(65536>=ha),rs=Gr;var Wa=s(Pa);if(rs==null||Wa==null||un==null){la.a=1;break r}var lr=un;for(La=Cr=0;La<Yr;++La){var cr=rs[La],Kr=cr.G,Ss=cr.H,si=0,ms=1,fn=0;for(dr=0;5>dr;++dr){cn=ql[dr],Kr[dr]=lr,Ss[dr]=Cr,!dr&&0<ba&&(cn+=1<<ba);n:{var hl,dl=cn,nh=la,wa=Wa,_d=lr,bd=Cr,sh=0,Lo=nh.m,j1=M(Lo,1);if(n(wa,0,0,dl),j1){var wd=M(Lo,1)+1,Sd=M(Lo,1),ih=M(Lo,Sd==0?1:8);wa[ih]=1,wd==2&&(wa[ih=M(Lo,8)]=1);var On=1}else{var Va=s(19),$u=M(Lo,4)+4;if(19<$u){nh.a=3;var ml=0;break n}for(hl=0;hl<$u;++hl)Va[qu[hl]]=M(Lo,3);var Pc=void 0,$l=void 0,eo=nh,oh=Va,Mc=dl,lh=wa,ch=0,Po=eo.m,Nd=8,kd=o(128,I);a:for(;O(kd,0,7,oh,19);){if(M(Po,1)){var nm=2+2*M(Po,3);if((Pc=2+M(Po,nm))>Mc)break a}else Pc=Mc;for($l=0;$l<Mc&&Pc--;){oe(Po);var jd=kd[0+(127&B(Po))];Z(Po,Po.u+jd.g);var pl=jd.value;if(16>pl)lh[$l++]=pl,pl!=0&&(Nd=pl);else{var sm=pl==16,im=pl-16,om=Rc[im],Ed=M(Po,Qs[im])+om;if($l+Ed>Mc)break a;for(var lm=sm?Nd:0;0<Ed--;)lh[$l++]=lm}}ch=1;break a}ch||(eo.a=3),On=ch}(On=On&&!Lo.h)&&(sh=O(_d,bd,8,wa,dl)),On&&sh!=0?ml=sh:(nh.a=3,ml=0)}if(ml==0)break r;if(ms&&Zf[dr]==1&&(ms=lr[Cr].g==0),si+=lr[Cr].g,Cr+=ml,3>=dr){var Wl,uh=Wa[0];for(Wl=1;Wl<cn;++Wl)Wa[Wl]>uh&&(uh=Wa[Wl]);fn+=uh}}if(cr.nd=ms,cr.Qb=0,ms&&(cr.qb=(Kr[3][Ss[3]+0].value<<24|Kr[1][Ss[1]+0].value<<16|Kr[2][Ss[2]+0].value)>>>0,si==0&&256>Kr[0][Ss[0]+0].value&&(cr.Qb=1,cr.qb+=Kr[0][Ss[0]+0].value<<8)),cr.jc=!cr.Qb&&6>fn,cr.jc){var Wu,to=cr;for(Wu=0;Wu<nl;++Wu){var Mo=Wu,Io=to.pd[Mo],fh=to.G[0][to.H[0]+Mo];256<=fh.value?(Io.g=fh.g+256,Io.value=fh.value):(Io.g=0,Io.value=0,Mo>>=Ea(fh,8,Io),Mo>>=Ea(to.G[1][to.H[1]+Mo],16,Io),Mo>>=Ea(to.G[2][to.H[2]+Mo],0,Io),Ea(to.G[3][to.H[3]+Mo],24,Io))}}}ln.vc=Dr,ln.Wb=Yr,ln.Ya=rs,ln.yc=un,Ut=1;break t}Ut=0}if(!(ie=Ut)){z.a=3;break e}if(0<Xe){if(ke.ua=1<<Xe,!re(ke.Wa,Xe)){z.a=1,ie=0;break e}}else ke.ua=0;var hh=z,Vl=ce,cm=me,Ic=hh.s,Bc=Ic.xc;if(hh.c=Vl,hh.i=cm,Ic.md=tt(Vl,Bc),Ic.wc=Bc==0?-1:(1<<Bc)-1,L){z.xb=ol;break e}if((De=s(ce*me))==null){z.a=1,ie=0;break e}ie=(ie=We(z,De,0,ce,me,me,null))&&!ye.h;break e}return ie?(te!=null?te[0]=De:(e(De==null),e(L)),z.$=0,L||st(ke)):st(ke),ie}function Je(x,N){var L=x.c*x.i,z=L+N+16*N;return e(x.c<=N),x.V=s(z),x.V==null?(x.Ta=null,x.Ua=0,x.a=1,0):(x.Ta=x.V,x.Ua=x.Ba+L+N,1)}function Nt(x,N){var L=x.C,z=N-L,te=x.V,ie=x.Ba+x.c*L;for(e(N<=x.l.o);0<z;){var ce=16<z?16:z,me=x.l.ma,ye=x.l.width,ke=ye*ce,De=me.ca,Xe=me.tb+ye*L,Ne=x.Ta,Me=x.Ua;je(x,ce,te,ie),Hs(Ne,Me,De,Xe,ke),Se(me,L,L+ce,De,Xe,ye),z-=ce,te+=ce*x.c,L+=ce}e(L==N),x.C=x.Ma=N}function Ft(){this.ub=this.yd=this.td=this.Rb=0}function qt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ot(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Mt(){this.Yb=(function(){var x=[];return(function N(L,z,te){for(var ie=te[z],ce=0;ce<ie&&(L.push(te.length>z+1?[]:0),!(te.length<z+1));ce++)N(L[ce],z+1,te)})(x,0,[3,11]),x})()}function Yt(){this.jb=s(3),this.Wc=u([4,8],Mt),this.Xc=u([4,17],Mt)}function oa(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Fr(){this.ld=this.La=this.dd=this.tc=0}function fa(){this.Na=this.la=0}function ls(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function pi(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function gi(){this.uc=this.M=this.Nb=0,this.wa=Array(new Fr),this.Y=0,this.ya=Array(new pi),this.aa=0,this.l=new po}function Is(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Qo(){this.cb=this.a=0,this.sc="",this.m=new A,this.Od=new Ft,this.Kc=new qt,this.ed=new oa,this.Qa=new Ot,this.Ic=this.$c=this.Aa=0,this.D=new gi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,A),this.ia=0,this.pb=o(4,ls),this.Pa=new Yt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Is),this.Hd=0,this.rb=Array(new fa),this.sb=0,this.wa=Array(new Fr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new pi),this.L=this.aa=0,this.gd=u([4,2],Fr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Da(x,N){return 0>x?0:x>N?N:x}function po(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function vi(){var x=new Qo;return x!=null&&(x.a=0,x.sc="OK",x.cb=0,x.Xb=0,$s||($s=el)),x}function Zr(x,N,L){return x.a==0&&(x.a=N,x.sc=L,x.cb=0),0}function bu(x,N,L){return 3<=L&&x[N+0]==157&&x[N+1]==1&&x[N+2]==42}function zi(x,N){if(x==null)return 0;if(x.a=0,x.sc="OK",N==null)return Zr(x,2,"null VP8Io passed to VP8GetHeaders()");var L=N.data,z=N.w,te=N.ha;if(4>te)return Zr(x,7,"Truncated header.");var ie=L[z+0]|L[z+1]<<8|L[z+2]<<16,ce=x.Od;if(ce.Rb=!(1&ie),ce.td=ie>>1&7,ce.yd=ie>>4&1,ce.ub=ie>>5,3<ce.td)return Zr(x,3,"Incorrect keyframe parameters.");if(!ce.yd)return Zr(x,4,"Frame not displayable.");z+=3,te-=3;var me=x.Kc;if(ce.Rb){if(7>te)return Zr(x,7,"cannot parse picture header");if(!bu(L,z,te))return Zr(x,3,"Bad code word");me.c=16383&(L[z+4]<<8|L[z+3]),me.Td=L[z+4]>>6,me.i=16383&(L[z+6]<<8|L[z+5]),me.Ud=L[z+6]>>6,z+=7,te-=7,x.za=me.c+15>>4,x.Ub=me.i+15>>4,N.width=me.c,N.height=me.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,n((ie=x.Pa).jb,0,255,ie.jb.length),e((ie=x.Qa)!=null),ie.Cb=0,ie.Bb=0,ie.Fb=1,n(ie.Zb,0,0,ie.Zb.length),n(ie.Lb,0,0,ie.Lb)}if(ce.ub>te)return Zr(x,7,"bad partition length");Q(ie=x.m,L,z,ce.ub),z+=ce.ub,te-=ce.ub,ce.Rb&&(me.Ld=_e(ie),me.Kd=_e(ie)),me=x.Qa;var ye,ke=x.Pa;if(e(ie!=null),e(me!=null),me.Cb=_e(ie),me.Cb){if(me.Bb=_e(ie),_e(ie)){for(me.Fb=_e(ie),ye=0;4>ye;++ye)me.Zb[ye]=_e(ie)?ee(ie,7):0;for(ye=0;4>ye;++ye)me.Lb[ye]=_e(ie)?ee(ie,6):0}if(me.Bb)for(ye=0;3>ye;++ye)ke.jb[ye]=_e(ie)?le(ie,8):255}else me.Bb=0;if(ie.Ka)return Zr(x,3,"cannot parse segment header");if((me=x.ed).zd=_e(ie),me.Tb=le(ie,6),me.wb=le(ie,3),me.Pc=_e(ie),me.Pc&&_e(ie)){for(ke=0;4>ke;++ke)_e(ie)&&(me.vd[ke]=ee(ie,6));for(ke=0;4>ke;++ke)_e(ie)&&(me.od[ke]=ee(ie,6))}if(x.L=me.Tb==0?0:me.zd?1:2,ie.Ka)return Zr(x,3,"cannot parse filter header");var De=te;if(te=ye=z,z=ye+De,me=De,x.Xb=(1<<le(x.m,2))-1,De<3*(ke=x.Xb))L=7;else{for(ye+=3*ke,me-=3*ke,De=0;De<ke;++De){var Xe=L[te+0]|L[te+1]<<8|L[te+2]<<16;Xe>me&&(Xe=me),Q(x.Jc[+De],L,ye,Xe),ye+=Xe,me-=Xe,te+=3}Q(x.Jc[+ke],L,ye,me),L=ye<z?0:5}if(L!=0)return Zr(x,L,"cannot parse partitions");for(L=le(ye=x.m,7),te=_e(ye)?ee(ye,4):0,z=_e(ye)?ee(ye,4):0,me=_e(ye)?ee(ye,4):0,ke=_e(ye)?ee(ye,4):0,ye=_e(ye)?ee(ye,4):0,De=x.Qa,Xe=0;4>Xe;++Xe){if(De.Cb){var Ne=De.Zb[Xe];De.Fb||(Ne+=L)}else{if(0<Xe){x.pb[Xe]=x.pb[0];continue}Ne=L}var Me=x.pb[Xe];Me.Sc[0]=ri[Da(Ne+te,127)],Me.Sc[1]=ai[Da(Ne+0,127)],Me.Eb[0]=2*ri[Da(Ne+z,127)],Me.Eb[1]=101581*ai[Da(Ne+me,127)]>>16,8>Me.Eb[1]&&(Me.Eb[1]=8),Me.Qc[0]=ri[Da(Ne+ke,117)],Me.Qc[1]=ai[Da(Ne+ye,127)],Me.lc=Ne+ye}if(!ce.Rb)return Zr(x,4,"Not a key frame.");for(_e(ie),ce=x.Pa,L=0;4>L;++L){for(te=0;8>te;++te)for(z=0;3>z;++z)for(me=0;11>me;++me)ke=be(ie,Aa[L][te][z][me])?le(ie,8):rm[L][te][z][me],ce.Wc[L][te].Yb[z][me]=ke;for(te=0;17>te;++te)ce.Xc[L][te]=ce.Wc[L][Ir[te]]}return x.kc=_e(ie),x.kc&&(x.Bd=le(ie,8)),x.cb=1}function el(x,N,L,z,te,ie,ce){var me=N[te].Yb[L];for(L=0;16>te;++te){if(!be(x,me[L+0]))return te;for(;!be(x,me[L+1]);)if(me=N[++te].Yb[0],L=0,te==16)return 16;var ye=N[te+1].Yb;if(be(x,me[L+2])){var ke=x,De=0;if(be(ke,(Ne=me)[(Xe=L)+3]))if(be(ke,Ne[Xe+6])){for(me=0,Xe=2*(De=be(ke,Ne[Xe+8]))+(Ne=be(ke,Ne[Xe+9+De])),De=0,Ne=tm[Xe];Ne[me];++me)De+=De+be(ke,Ne[me]);De+=3+(8<<Xe)}else be(ke,Ne[Xe+7])?(De=7+2*be(ke,165),De+=be(ke,145)):De=5+be(ke,159);else De=be(ke,Ne[Xe+4])?3+be(ke,Ne[Xe+5]):2;me=ye[2]}else De=1,me=ye[1];ye=ce+vd[te],0>(ke=x).b&&pe(ke);var Xe,Ne=ke.b,Me=(Xe=ke.Ca>>1)-(ke.I>>Ne)>>31;--ke.b,ke.Ca+=Me,ke.Ca|=1,ke.I-=(Xe+1&Me)<<Ne,ie[ye]=((De^Me)-Me)*z[(0<te)+0]}return 16}function wu(x){var N=x.rb[x.sb-1];N.la=0,N.Na=0,n(x.zc,0,0,x.zc.length),x.ja=0}function cs(x,N,L,z,te){te=x[N+L+32*z]+(te>>3),x[N+L+32*z]=-256&te?0>te?0:255:te}function vn(x,N,L,z,te,ie){cs(x,N,0,L,z+te),cs(x,N,1,L,z+ie),cs(x,N,2,L,z-ie),cs(x,N,3,L,z-te)}function nn(x){return(20091*x>>16)+x}function yc(x,N,L,z){var te,ie=0,ce=s(16);for(te=0;4>te;++te){var me=x[N+0]+x[N+8],ye=x[N+0]-x[N+8],ke=(35468*x[N+4]>>16)-nn(x[N+12]),De=nn(x[N+4])+(35468*x[N+12]>>16);ce[ie+0]=me+De,ce[ie+1]=ye+ke,ce[ie+2]=ye-ke,ce[ie+3]=me-De,ie+=4,N++}for(te=ie=0;4>te;++te)me=(x=ce[ie+0]+4)+ce[ie+8],ye=x-ce[ie+8],ke=(35468*ce[ie+4]>>16)-nn(ce[ie+12]),cs(L,z,0,0,me+(De=nn(ce[ie+4])+(35468*ce[ie+12]>>16))),cs(L,z,1,0,ye+ke),cs(L,z,2,0,ye-ke),cs(L,z,3,0,me-De),ie++,z+=32}function Pf(x,N,L,z){var te=x[N+0]+4,ie=35468*x[N+4]>>16,ce=nn(x[N+4]),me=35468*x[N+1]>>16;vn(L,z,0,te+ce,x=nn(x[N+1]),me),vn(L,z,1,te+ie,x,me),vn(L,z,2,te-ie,x,me),vn(L,z,3,te-ce,x,me)}function Su(x,N,L,z,te){yc(x,N,L,z),te&&yc(x,N+16,L,z+4)}function us(x,N,L,z){Ro(x,N+0,L,z,1),Ro(x,N+32,L,z+128,1)}function Nu(x,N,L,z){var te;for(x=x[N+0]+4,te=0;4>te;++te)for(N=0;4>N;++N)cs(L,z,N,te,x)}function ku(x,N,L,z){x[N+0]&&Qr(x,N+0,L,z),x[N+16]&&Qr(x,N+16,L,z+4),x[N+32]&&Qr(x,N+32,L,z+128),x[N+48]&&Qr(x,N+48,L,z+128+4)}function xi(x,N,L,z){var te,ie=s(16);for(te=0;4>te;++te){var ce=x[N+0+te]+x[N+12+te],me=x[N+4+te]+x[N+8+te],ye=x[N+4+te]-x[N+8+te],ke=x[N+0+te]-x[N+12+te];ie[0+te]=ce+me,ie[8+te]=ce-me,ie[4+te]=ke+ye,ie[12+te]=ke-ye}for(te=0;4>te;++te)ce=(x=ie[0+4*te]+3)+ie[3+4*te],me=ie[1+4*te]+ie[2+4*te],ye=ie[1+4*te]-ie[2+4*te],ke=x-ie[3+4*te],L[z+0]=ce+me>>3,L[z+16]=ke+ye>>3,L[z+32]=ce-me>>3,L[z+48]=ke-ye>>3,z+=64}function Tl(x,N,L){var z,te=N-32,ie=Qn,ce=255-x[te-1];for(z=0;z<L;++z){var me,ye=ie,ke=ce+x[N-1];for(me=0;me<L;++me)x[N+me]=ye[ke+x[te+me]];N+=32}}function Mf(x,N){Tl(x,N,4)}function If(x,N){Tl(x,N,8)}function ju(x,N){Tl(x,N,16)}function Eu(x,N){var L;for(L=0;16>L;++L)a(x,N+32*L,x,N-32,16)}function Bf(x,N){var L;for(L=16;0<L;--L)n(x,N,x[N-1],16),N+=32}function bs(x,N,L){var z;for(z=0;16>z;++z)n(N,L+32*z,x,16)}function yi(x,N){var L,z=16;for(L=0;16>L;++L)z+=x[N-1+32*L]+x[N+L-32];bs(z>>5,x,N)}function go(x,N){var L,z=8;for(L=0;16>L;++L)z+=x[N-1+32*L];bs(z>>4,x,N)}function Ol(x,N){var L,z=8;for(L=0;16>L;++L)z+=x[N+L-32];bs(z>>4,x,N)}function tl(x,N){bs(128,x,N)}function hr(x,N,L){return x+2*N+L+2>>2}function Uf(x,N){var L,z=N-32;for(z=new Uint8Array([hr(x[z-1],x[z+0],x[z+1]),hr(x[z+0],x[z+1],x[z+2]),hr(x[z+1],x[z+2],x[z+3]),hr(x[z+2],x[z+3],x[z+4])]),L=0;4>L;++L)a(x,N+32*L,z,0,z.length)}function Au(x,N){var L=x[N-1],z=x[N-1+32],te=x[N-1+64],ie=x[N-1+96];Le(x,N+0,16843009*hr(x[N-1-32],L,z)),Le(x,N+32,16843009*hr(L,z,te)),Le(x,N+64,16843009*hr(z,te,ie)),Le(x,N+96,16843009*hr(te,ie,ie))}function qf(x,N){var L,z=4;for(L=0;4>L;++L)z+=x[N+L-32]+x[N-1+32*L];for(z>>=3,L=0;4>L;++L)n(x,N+32*L,z,4)}function Bs(x,N){var L=x[N-1+0],z=x[N-1+32],te=x[N-1+64],ie=x[N-1-32],ce=x[N+0-32],me=x[N+1-32],ye=x[N+2-32],ke=x[N+3-32];x[N+0+96]=hr(z,te,x[N-1+96]),x[N+1+96]=x[N+0+64]=hr(L,z,te),x[N+2+96]=x[N+1+64]=x[N+0+32]=hr(ie,L,z),x[N+3+96]=x[N+2+64]=x[N+1+32]=x[N+0+0]=hr(ce,ie,L),x[N+3+64]=x[N+2+32]=x[N+1+0]=hr(me,ce,ie),x[N+3+32]=x[N+2+0]=hr(ye,me,ce),x[N+3+0]=hr(ke,ye,me)}function In(x,N){var L=x[N+1-32],z=x[N+2-32],te=x[N+3-32],ie=x[N+4-32],ce=x[N+5-32],me=x[N+6-32],ye=x[N+7-32];x[N+0+0]=hr(x[N+0-32],L,z),x[N+1+0]=x[N+0+32]=hr(L,z,te),x[N+2+0]=x[N+1+32]=x[N+0+64]=hr(z,te,ie),x[N+3+0]=x[N+2+32]=x[N+1+64]=x[N+0+96]=hr(te,ie,ce),x[N+3+32]=x[N+2+64]=x[N+1+96]=hr(ie,ce,me),x[N+3+64]=x[N+2+96]=hr(ce,me,ye),x[N+3+96]=hr(me,ye,ye)}function Cu(x,N){var L=x[N-1+0],z=x[N-1+32],te=x[N-1+64],ie=x[N-1-32],ce=x[N+0-32],me=x[N+1-32],ye=x[N+2-32],ke=x[N+3-32];x[N+0+0]=x[N+1+64]=ie+ce+1>>1,x[N+1+0]=x[N+2+64]=ce+me+1>>1,x[N+2+0]=x[N+3+64]=me+ye+1>>1,x[N+3+0]=ye+ke+1>>1,x[N+0+96]=hr(te,z,L),x[N+0+64]=hr(z,L,ie),x[N+0+32]=x[N+1+96]=hr(L,ie,ce),x[N+1+32]=x[N+2+96]=hr(ie,ce,me),x[N+2+32]=x[N+3+96]=hr(ce,me,ye),x[N+3+32]=hr(me,ye,ke)}function Rl(x,N){var L=x[N+0-32],z=x[N+1-32],te=x[N+2-32],ie=x[N+3-32],ce=x[N+4-32],me=x[N+5-32],ye=x[N+6-32],ke=x[N+7-32];x[N+0+0]=L+z+1>>1,x[N+1+0]=x[N+0+64]=z+te+1>>1,x[N+2+0]=x[N+1+64]=te+ie+1>>1,x[N+3+0]=x[N+2+64]=ie+ce+1>>1,x[N+0+32]=hr(L,z,te),x[N+1+32]=x[N+0+96]=hr(z,te,ie),x[N+2+32]=x[N+1+96]=hr(te,ie,ce),x[N+3+32]=x[N+2+96]=hr(ie,ce,me),x[N+3+64]=hr(ce,me,ye),x[N+3+96]=hr(me,ye,ke)}function Us(x,N){var L=x[N-1+0],z=x[N-1+32],te=x[N-1+64],ie=x[N-1+96];x[N+0+0]=L+z+1>>1,x[N+2+0]=x[N+0+32]=z+te+1>>1,x[N+2+32]=x[N+0+64]=te+ie+1>>1,x[N+1+0]=hr(L,z,te),x[N+3+0]=x[N+1+32]=hr(z,te,ie),x[N+3+32]=x[N+1+64]=hr(te,ie,ie),x[N+3+64]=x[N+2+64]=x[N+0+96]=x[N+1+96]=x[N+2+96]=x[N+3+96]=ie}function Dl(x,N){var L=x[N-1+0],z=x[N-1+32],te=x[N-1+64],ie=x[N-1+96],ce=x[N-1-32],me=x[N+0-32],ye=x[N+1-32],ke=x[N+2-32];x[N+0+0]=x[N+2+32]=L+ce+1>>1,x[N+0+32]=x[N+2+64]=z+L+1>>1,x[N+0+64]=x[N+2+96]=te+z+1>>1,x[N+0+96]=ie+te+1>>1,x[N+3+0]=hr(me,ye,ke),x[N+2+0]=hr(ce,me,ye),x[N+1+0]=x[N+3+32]=hr(L,ce,me),x[N+1+32]=x[N+3+64]=hr(z,L,ce),x[N+1+64]=x[N+3+96]=hr(te,z,L),x[N+1+96]=hr(ie,te,z)}function Hi(x,N){var L;for(L=0;8>L;++L)a(x,N+32*L,x,N-32,8)}function zf(x,N){var L;for(L=0;8>L;++L)n(x,N,x[N-1],8),N+=32}function Ys(x,N,L){var z;for(z=0;8>z;++z)n(N,L+32*z,x,8)}function _c(x,N){var L,z=8;for(L=0;8>L;++L)z+=x[N+L-32]+x[N-1+32*L];Ys(z>>4,x,N)}function bc(x,N){var L,z=4;for(L=0;8>L;++L)z+=x[N+L-32];Ys(z>>3,x,N)}function Cn(x,N){var L,z=4;for(L=0;8>L;++L)z+=x[N-1+32*L];Ys(z>>3,x,N)}function $i(x,N){Ys(128,x,N)}function Xs(x,N,L){var z=x[N-L],te=x[N+0],ie=3*(te-z)+Do[1020+x[N-2*L]-x[N+L]],ce=Iu[112+(ie+4>>3)];x[N-L]=Qn[255+z+Iu[112+(ie+3>>3)]],x[N+0]=Qn[255+te-ce]}function vo(x,N,L,z){var te=x[N+0],ie=x[N+L];return qn[255+x[N-2*L]-x[N-L]]>z||qn[255+ie-te]>z}function wc(x,N,L,z){return 4*qn[255+x[N-L]-x[N+0]]+qn[255+x[N-2*L]-x[N+L]]<=z}function Fl(x,N,L,z,te){var ie=x[N-3*L],ce=x[N-2*L],me=x[N-L],ye=x[N+0],ke=x[N+L],De=x[N+2*L],Xe=x[N+3*L];return 4*qn[255+me-ye]+qn[255+ce-ke]>z?0:qn[255+x[N-4*L]-ie]<=te&&qn[255+ie-ce]<=te&&qn[255+ce-me]<=te&&qn[255+Xe-De]<=te&&qn[255+De-ke]<=te&&qn[255+ke-ye]<=te}function xo(x,N,L,z){var te=2*z+1;for(z=0;16>z;++z)wc(x,N+z,L,te)&&Xs(x,N+z,L)}function yo(x,N,L,z){var te=2*z+1;for(z=0;16>z;++z)wc(x,N+z*L,1,te)&&Xs(x,N+z*L,1)}function Ll(x,N,L,z){var te;for(te=3;0<te;--te)xo(x,N+=4*L,L,z)}function Tu(x,N,L,z){var te;for(te=3;0<te;--te)yo(x,N+=4,L,z)}function _o(x,N,L,z,te,ie,ce,me){for(ie=2*ie+1;0<te--;){if(Fl(x,N,L,ie,ce))if(vo(x,N,L,me))Xs(x,N,L);else{var ye=x,ke=N,De=L,Xe=ye[ke-2*De],Ne=ye[ke-De],Me=ye[ke+0],He=ye[ke+De],ot=ye[ke+2*De],Ve=27*(dt=Do[1020+3*(Me-Ne)+Do[1020+Xe-He]])+63>>7,it=18*dt+63>>7,dt=9*dt+63>>7;ye[ke-3*De]=Qn[255+ye[ke-3*De]+dt],ye[ke-2*De]=Qn[255+Xe+it],ye[ke-De]=Qn[255+Ne+Ve],ye[ke+0]=Qn[255+Me-Ve],ye[ke+De]=Qn[255+He-it],ye[ke+2*De]=Qn[255+ot-dt]}N+=z}}function bo(x,N,L,z,te,ie,ce,me){for(ie=2*ie+1;0<te--;){if(Fl(x,N,L,ie,ce))if(vo(x,N,L,me))Xs(x,N,L);else{var ye=x,ke=N,De=L,Xe=ye[ke-De],Ne=ye[ke+0],Me=ye[ke+De],He=Iu[112+(4+(ot=3*(Ne-Xe))>>3)],ot=Iu[112+(ot+3>>3)],Ve=He+1>>1;ye[ke-2*De]=Qn[255+ye[ke-2*De]+Ve],ye[ke-De]=Qn[255+Xe+ot],ye[ke+0]=Qn[255+Ne-He],ye[ke+De]=Qn[255+Me-Ve]}N+=z}}function Hf(x,N,L,z,te,ie){_o(x,N,L,1,16,z,te,ie)}function wo(x,N,L,z,te,ie){_o(x,N,1,L,16,z,te,ie)}function $f(x,N,L,z,te,ie){var ce;for(ce=3;0<ce;--ce)bo(x,N+=4*L,L,1,16,z,te,ie)}function T(x,N,L,z,te,ie){var ce;for(ce=3;0<ce;--ce)bo(x,N+=4,1,L,16,z,te,ie)}function J(x,N,L,z,te,ie,ce,me){_o(x,N,te,1,8,ie,ce,me),_o(L,z,te,1,8,ie,ce,me)}function Ee(x,N,L,z,te,ie,ce,me){_o(x,N,1,te,8,ie,ce,me),_o(L,z,1,te,8,ie,ce,me)}function Re(x,N,L,z,te,ie,ce,me){bo(x,N+4*te,te,1,8,ie,ce,me),bo(L,z+4*te,te,1,8,ie,ce,me)}function qe(x,N,L,z,te,ie,ce,me){bo(x,N+4,1,te,8,ie,ce,me),bo(L,z+4,1,te,8,ie,ce,me)}function ht(){this.ba=new Kt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Nr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function bt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Jt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ar(){this.ua=0,this.Wa=new Oe,this.vb=new Oe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ne,this.yc=new I}function gr(){this.xb=this.a=0,this.l=new po,this.ca=new Kt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new D,this.Pb=0,this.wd=new D,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ar,this.ab=0,this.gc=o(4,Jt),this.Oc=0}function kr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new po,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Wr(x,N,L,z,te,ie,ce){for(x=x==null?0:x[N+0],N=0;N<ce;++N)te[ie+N]=x+L[z+N]&255,x=te[ie+N]}function Fa(x,N,L,z,te,ie,ce){var me;if(x==null)Wr(null,null,L,z,te,ie,ce);else for(me=0;me<ce;++me)te[ie+me]=x[N+me]+L[z+me]&255}function Ka(x,N,L,z,te,ie,ce){if(x==null)Wr(null,null,L,z,te,ie,ce);else{var me,ye=x[N+0],ke=ye,De=ye;for(me=0;me<ce;++me)ke=De+(ye=x[N+me])-ke,De=L[z+me]+(-256&ke?0>ke?0:255:ke)&255,ke=ye,te[ie+me]=De}}function ya(x,N,L,z){var te=N.width,ie=N.o;if(e(x!=null&&N!=null),0>L||0>=z||L+z>ie)return null;if(!x.Cc){if(x.ga==null){var ce;if(x.ga=new kr,(ce=x.ga==null)||(ce=N.width*N.o,e(x.Gb.length==0),x.Gb=s(ce),x.Uc=0,x.Gb==null?ce=0:(x.mb=x.Gb,x.nb=x.Uc,x.rc=null,ce=1),ce=!ce),!ce){ce=x.ga;var me=x.Fa,ye=x.P,ke=x.qc,De=x.mb,Xe=x.nb,Ne=ye+1,Me=ke-1,He=ce.l;if(e(me!=null&&De!=null&&N!=null),Fo[0]=null,Fo[1]=Wr,Fo[2]=Fa,Fo[3]=Ka,ce.ca=De,ce.tb=Xe,ce.c=N.width,ce.i=N.height,e(0<ce.c&&0<ce.i),1>=ke)N=0;else if(ce.$a=3&me[ye+0],ce.Z=me[ye+0]>>2&3,ce.Lc=me[ye+0]>>4&3,ye=me[ye+0]>>6&3,0>ce.$a||1<ce.$a||4<=ce.Z||1<ce.Lc||ye)N=0;else if(He.put=_t,He.ac=Ha,He.bc=mr,He.ma=ce,He.width=N.width,He.height=N.height,He.Da=N.Da,He.v=N.v,He.va=N.va,He.j=N.j,He.o=N.o,ce.$a)e:{e(ce.$a==1),N=Ge();t:for(;;){if(N==null){N=0;break e}if(e(ce!=null),ce.mc=N,N.c=ce.c,N.i=ce.i,N.l=ce.l,N.l.ma=ce,N.l.width=ce.c,N.l.height=ce.i,N.a=0,K(N.m,me,Ne,Me),!Ye(ce.c,ce.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&xe(N.s)?(ce.ic=1,me=N.c*N.i,N.Ta=null,N.Ua=0,N.V=s(me),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(ce.ic=0,N=Je(N,ce.c)),!N))break t;N=1;break e}ce.mc=null,N=0}else N=Me>=ce.c*ce.i;ce=!N}if(ce)return null;x.ga.Lc!=1?x.Ga=0:z=ie-L}e(x.ga!=null),e(L+z<=ie);e:{if(N=(me=x.ga).c,ie=me.l.o,me.$a==0){if(Ne=x.rc,Me=x.Vc,He=x.Fa,ye=x.P+1+L*N,ke=x.mb,De=x.nb+L*N,e(ye<=x.P+x.qc),me.Z!=0)for(e(Fo[me.Z]!=null),ce=0;ce<z;++ce)Fo[me.Z](Ne,Me,He,ye,ke,De,N),Ne=ke,Me=De,De+=N,ye+=N;else for(ce=0;ce<z;++ce)a(ke,De,He,ye,N),Ne=ke,Me=De,De+=N,ye+=N;x.rc=Ne,x.Vc=Me}else{if(e(me.mc!=null),N=L+z,e((ce=me.mc)!=null),e(N<=ce.i),ce.C>=N)N=1;else if(me.ic||_i(),me.ic){me=ce.V,Ne=ce.Ba,Me=ce.c;var ot=ce.i,Ve=(He=1,ye=ce.$/Me,ke=ce.$%Me,De=ce.m,Xe=ce.s,ce.$),it=Me*ot,dt=Me*N,jt=Xe.wc,vt=Ve<dt?ae(Xe,ke,ye):null;e(Ve<=it),e(N<=ot),e(xe(Xe));t:for(;;){for(;!De.h&&Ve<dt;){if(ke&jt||(vt=ae(Xe,ke,ye)),e(vt!=null),oe(De),256>(ot=$r(vt.G[0],vt.H[0],De)))me[Ne+Ve]=ot,++Ve,++ke>=Me&&(ke=0,++ye<=N&&!(ye%16)&&Ce(ce,ye));else{if(!(280>ot)){He=0;break t}ot=qr(ot-256,De);var tr,Wt=$r(vt.G[4],vt.H[4],De);if(oe(De),!(Ve>=(Wt=Xa(Me,Wt=qr(Wt,De)))&&it-Ve>=ot)){He=0;break t}for(tr=0;tr<ot;++tr)me[Ne+Ve+tr]=me[Ne+Ve+tr-Wt];for(Ve+=ot,ke+=ot;ke>=Me;)ke-=Me,++ye<=N&&!(ye%16)&&Ce(ce,ye);Ve<dt&&ke&jt&&(vt=ae(Xe,ke,ye))}e(De.h==q(De))}Ce(ce,ye>N?N:ye);break t}!He||De.h&&Ve<it?(He=0,ce.a=De.h?5:3):ce.$=Ve,N=He}else N=We(ce,ce.V,ce.Ba,ce.c,ce.i,N,Nt);if(!N){z=0;break e}}L+z>=ie&&(x.Cc=1),z=1}if(!z)return null;if(x.Cc&&((z=x.ga)!=null&&(z.mc=null),x.ga=null,0<x.Ga))return alert("todo:WebPDequantizeLevels"),null}return x.nb+L*te}function xn(x,N,L,z,te,ie){for(;0<te--;){var ce,me=x,ye=N+(L?1:0),ke=x,De=N+(L?0:3);for(ce=0;ce<z;++ce){var Xe=ke[De+4*ce];Xe!=255&&(Xe*=32897,me[ye+4*ce+0]=me[ye+4*ce+0]*Xe>>23,me[ye+4*ce+1]=me[ye+4*ce+1]*Xe>>23,me[ye+4*ce+2]=me[ye+4*ce+2]*Xe>>23)}N+=ie}}function sn(x,N,L,z,te){for(;0<z--;){var ie;for(ie=0;ie<L;++ie){var ce=x[N+2*ie+0],me=15&(ke=x[N+2*ie+1]),ye=4369*me,ke=(240&ke|ke>>4)*ye>>16;x[N+2*ie+0]=(240&ce|ce>>4)*ye>>16&240|(15&ce|ce<<4)*ye>>16>>4&15,x[N+2*ie+1]=240&ke|me}N+=te}}function Bn(x,N,L,z,te,ie,ce,me){var ye,ke,De=255;for(ke=0;ke<te;++ke){for(ye=0;ye<z;++ye){var Xe=x[N+ye];ie[ce+4*ye]=Xe,De&=Xe}N+=L,ce+=me}return De!=255}function So(x,N,L,z,te){var ie;for(ie=0;ie<te;++ie)L[z+ie]=x[N+ie]>>8}function _i(){Bl=xn,Js=sn,Lu=Bn,Hs=So}function No(x,N,L){F[x]=function(z,te,ie,ce,me,ye,ke,De,Xe,Ne,Me,He,ot,Ve,it,dt,jt){var vt,tr=jt-1>>1,Wt=me[ye+0]|ke[De+0]<<16,br=Xe[Ne+0]|Me[He+0]<<16;e(z!=null);var Xt=3*Wt+br+131074>>2;for(N(z[te+0],255&Xt,Xt>>16,ot,Ve),ie!=null&&(Xt=3*br+Wt+131074>>2,N(ie[ce+0],255&Xt,Xt>>16,it,dt)),vt=1;vt<=tr;++vt){var Pr=me[ye+vt]|ke[De+vt]<<16,Ca=Xe[Ne+vt]|Me[He+vt]<<16,jr=Wt+Pr+br+Ca+524296,Vt=jr+2*(Pr+br)>>3;Xt=Vt+Wt>>1,Wt=(jr=jr+2*(Wt+Ca)>>3)+Pr>>1,N(z[te+2*vt-1],255&Xt,Xt>>16,ot,Ve+(2*vt-1)*L),N(z[te+2*vt-0],255&Wt,Wt>>16,ot,Ve+(2*vt-0)*L),ie!=null&&(Xt=jr+br>>1,Wt=Vt+Ca>>1,N(ie[ce+2*vt-1],255&Xt,Xt>>16,it,dt+(2*vt-1)*L),N(ie[ce+2*vt+0],255&Wt,Wt>>16,it,dt+(2*vt+0)*L)),Wt=Pr,br=Ca}1&jt||(Xt=3*Wt+br+131074>>2,N(z[te+jt-1],255&Xt,Xt>>16,ot,Ve+(jt-1)*L),ie!=null&&(Xt=3*br+Wt+131074>>2,N(ie[ce+jt-1],255&Xt,Xt>>16,it,dt+(jt-1)*L)))}}function Ou(){Hn[Yf]=zl,Hn[es]=Dc,Hn[Xf]=yd,Hn[Zs]=eh,Hn[Bu]=ll,Hn[Tc]=Qi,Hn[sl]=cl,Hn[Uu]=Dc,Hn[Kf]=eh,Hn[Oc]=ll,Hn[Jf]=Qi}function Sc(x){return x&-16384?0>x?0:255:x>>th}function Wi(x,N){return Sc((19077*x>>8)+(26149*N>>8)-14234)}function bi(x,N,L){return Sc((19077*x>>8)-(6419*N>>8)-(13320*L>>8)+8708)}function Pl(x,N){return Sc((19077*x>>8)+(33050*N>>8)-17685)}function ko(x,N,L,z,te){z[te+0]=Wi(x,L),z[te+1]=bi(x,N,L),z[te+2]=Pl(x,N)}function Tn(x,N,L,z,te){z[te+0]=Pl(x,N),z[te+1]=bi(x,N,L),z[te+2]=Wi(x,L)}function rl(x,N,L,z,te){var ie=bi(x,N,L);N=ie<<3&224|Pl(x,N)>>3,z[te+0]=248&Wi(x,L)|ie>>5,z[te+1]=N}function al(x,N,L,z,te){var ie=240&Pl(x,N)|15;z[te+0]=240&Wi(x,L)|bi(x,N,L)>>4,z[te+1]=ie}function Nc(x,N,L,z,te){z[te+0]=255,ko(x,N,L,z,te+1)}function Vi(x,N,L,z,te){Tn(x,N,L,z,te),z[te+3]=255}function fs(x,N,L,z,te){ko(x,N,L,z,te),z[te+3]=255}function jo(x,N,L){F[x]=function(z,te,ie,ce,me,ye,ke,De,Xe){for(var Ne=De+(-2&Xe)*L;De!=Ne;)N(z[te+0],ie[ce+0],me[ye+0],ke,De),N(z[te+1],ie[ce+0],me[ye+0],ke,De+L),te+=2,++ce,++ye,De+=2*L;1&Xe&&N(z[te+0],ie[ce+0],me[ye+0],ke,De)}}function kc(x,N,L){return L==0?x==0?N==0?6:5:N==0?4:0:L}function Ru(x,N,L,z,te){switch(x>>>30){case 3:Ro(N,L,z,te,0);break;case 2:Zn(N,L,z,te);break;case 1:Qr(N,L,z,te)}}function qs(x,N){var L,z,te=N.M,ie=N.Nb,ce=x.oc,me=x.pc+40,ye=x.oc,ke=x.pc+584,De=x.oc,Xe=x.pc+600;for(L=0;16>L;++L)ce[me+32*L-1]=129;for(L=0;8>L;++L)ye[ke+32*L-1]=129,De[Xe+32*L-1]=129;for(0<te?ce[me-1-32]=ye[ke-1-32]=De[Xe-1-32]=129:(n(ce,me-32-1,127,21),n(ye,ke-32-1,127,9),n(De,Xe-32-1,127,9)),z=0;z<x.za;++z){var Ne=N.ya[N.aa+z];if(0<z){for(L=-1;16>L;++L)a(ce,me+32*L-4,ce,me+32*L+12,4);for(L=-1;8>L;++L)a(ye,ke+32*L-4,ye,ke+32*L+4,4),a(De,Xe+32*L-4,De,Xe+32*L+4,4)}var Me=x.Gd,He=x.Hd+z,ot=Ne.ad,Ve=Ne.Hc;if(0<te&&(a(ce,me-32,Me[He].y,0,16),a(ye,ke-32,Me[He].f,0,8),a(De,Xe-32,Me[He].ea,0,8)),Ne.Za){var it=ce,dt=me-32+16;for(0<te&&(z>=x.za-1?n(it,dt,Me[He].y[15],4):a(it,dt,Me[He+1].y,0,4)),L=0;4>L;L++)it[dt+128+L]=it[dt+256+L]=it[dt+384+L]=it[dt+0+L];for(L=0;16>L;++L,Ve<<=2)it=ce,dt=me+Qa[L],$a[Ne.Ob[L]](it,dt),Ru(Ve,ot,16*+L,it,dt)}else if(it=kc(z,te,Ne.Ob[0]),ds[it](ce,me),Ve!=0)for(L=0;16>L;++L,Ve<<=2)Ru(Ve,ot,16*+L,ce,me+Qa[L]);for(L=Ne.Gc,it=kc(z,te,Ne.Dd),ki[it](ye,ke),ki[it](De,Xe),Ve=ot,it=ye,dt=ke,255&(Ne=0|L)&&(170&Ne?Ks(Ve,256,it,dt):Vr(Ve,256,it,dt)),Ne=De,Ve=Xe,255&(L>>=8)&&(170&L?Ks(ot,320,Ne,Ve):Vr(ot,320,Ne,Ve)),te<x.Ub-1&&(a(Me[He].y,0,ce,me+480,16),a(Me[He].f,0,ye,ke+224,8),a(Me[He].ea,0,De,Xe+224,8)),L=8*ie*x.B,Me=x.sa,He=x.ta+16*z+16*ie*x.R,ot=x.qa,Ne=x.ra+8*z+L,Ve=x.Ha,it=x.Ia+8*z+L,L=0;16>L;++L)a(Me,He+L*x.R,ce,me+32*L,16);for(L=0;8>L;++L)a(ot,Ne+L*x.B,ye,ke+32*L,8),a(Ve,it+L*x.B,De,Xe+32*L,8)}}function wi(x,N,L,z,te,ie,ce,me,ye){var ke=[0],De=[0],Xe=0,Ne=ye!=null?ye.kd:0,Me=ye??new bt;if(x==null||12>L)return 7;Me.data=x,Me.w=N,Me.ha=L,N=[N],L=[L],Me.gb=[Me.gb];e:{var He=N,ot=L,Ve=Me.gb;if(e(x!=null),e(ot!=null),e(Ve!=null),Ve[0]=0,12<=ot[0]&&!r(x,He[0],"RIFF")){if(r(x,He[0]+8,"WEBP")){Ve=3;break e}var it=de(x,He[0]+4);if(12>it||4294967286<it){Ve=3;break e}if(Ne&&it>ot[0]-8){Ve=7;break e}Ve[0]=it,He[0]+=12,ot[0]-=12}Ve=0}if(Ve!=0)return Ve;for(it=0<Me.gb[0],L=L[0];;){e:{var dt=x;ot=N,Ve=L;var jt=ke,vt=De,tr=He=[0];if((Xt=Xe=[Xe])[0]=0,8>Ve[0])Ve=7;else{if(!r(dt,ot[0],"VP8X")){if(de(dt,ot[0]+4)!=10){Ve=3;break e}if(18>Ve[0]){Ve=7;break e}var Wt=de(dt,ot[0]+8),br=1+Ae(dt,ot[0]+12);if(2147483648<=br*(dt=1+Ae(dt,ot[0]+15))){Ve=3;break e}tr!=null&&(tr[0]=Wt),jt!=null&&(jt[0]=br),vt!=null&&(vt[0]=dt),ot[0]+=18,Ve[0]-=18,Xt[0]=1}Ve=0}}if(Xe=Xe[0],He=He[0],Ve!=0)return Ve;if(ot=!!(2&He),!it&&Xe)return 3;if(ie!=null&&(ie[0]=!!(16&He)),ce!=null&&(ce[0]=ot),me!=null&&(me[0]=0),ce=ke[0],He=De[0],Xe&&ot&&ye==null){Ve=0;break}if(4>L){Ve=7;break}if(it&&Xe||!it&&!Xe&&!r(x,N[0],"ALPH")){L=[L],Me.na=[Me.na],Me.P=[Me.P],Me.Sa=[Me.Sa];e:{Wt=x,Ve=N,it=L;var Xt=Me.gb;jt=Me.na,vt=Me.P,tr=Me.Sa,br=22,e(Wt!=null),e(it!=null),dt=Ve[0];var Pr=it[0];for(e(jt!=null),e(tr!=null),jt[0]=null,vt[0]=null,tr[0]=0;;){if(Ve[0]=dt,it[0]=Pr,8>Pr){Ve=7;break e}var Ca=de(Wt,dt+4);if(4294967286<Ca){Ve=3;break e}var jr=8+Ca+1&-2;if(br+=jr,0<Xt&&br>Xt){Ve=3;break e}if(!r(Wt,dt,"VP8 ")||!r(Wt,dt,"VP8L")){Ve=0;break e}if(Pr[0]<jr){Ve=7;break e}r(Wt,dt,"ALPH")||(jt[0]=Wt,vt[0]=dt+8,tr[0]=Ca),dt+=jr,Pr-=jr}}if(L=L[0],Me.na=Me.na[0],Me.P=Me.P[0],Me.Sa=Me.Sa[0],Ve!=0)break}L=[L],Me.Ja=[Me.Ja],Me.xa=[Me.xa];e:if(Xt=x,Ve=N,it=L,jt=Me.gb[0],vt=Me.Ja,tr=Me.xa,Wt=Ve[0],dt=!r(Xt,Wt,"VP8 "),br=!r(Xt,Wt,"VP8L"),e(Xt!=null),e(it!=null),e(vt!=null),e(tr!=null),8>it[0])Ve=7;else{if(dt||br){if(Xt=de(Xt,Wt+4),12<=jt&&Xt>jt-12){Ve=3;break e}if(Ne&&Xt>it[0]-8){Ve=7;break e}vt[0]=Xt,Ve[0]+=8,it[0]-=8,tr[0]=br}else tr[0]=5<=it[0]&&Xt[Wt+0]==47&&!(Xt[Wt+4]>>5),vt[0]=it[0];Ve=0}if(L=L[0],Me.Ja=Me.Ja[0],Me.xa=Me.xa[0],N=N[0],Ve!=0)break;if(4294967286<Me.Ja)return 3;if(me==null||ot||(me[0]=Me.xa?2:1),ce=[ce],He=[He],Me.xa){if(5>L){Ve=7;break}me=ce,Ne=He,ot=ie,x==null||5>L?x=0:5<=L&&x[N+0]==47&&!(x[N+4]>>5)?(it=[0],Xt=[0],jt=[0],K(vt=new D,x,N,L),Jr(vt,it,Xt,jt)?(me!=null&&(me[0]=it[0]),Ne!=null&&(Ne[0]=Xt[0]),ot!=null&&(ot[0]=jt[0]),x=1):x=0):x=0}else{if(10>L){Ve=7;break}me=He,x==null||10>L||!bu(x,N+3,L-3)?x=0:(Ne=x[N+0]|x[N+1]<<8|x[N+2]<<16,ot=16383&(x[N+7]<<8|x[N+6]),x=16383&(x[N+9]<<8|x[N+8]),1&Ne||3<(Ne>>1&7)||!(Ne>>4&1)||Ne>>5>=Me.Ja||!ot||!x?x=0:(ce&&(ce[0]=ot),me&&(me[0]=x),x=1))}if(!x||(ce=ce[0],He=He[0],Xe&&(ke[0]!=ce||De[0]!=He)))return 3;ye!=null&&(ye[0]=Me,ye.offset=N-ye.w,e(4294967286>N-ye.w),e(ye.offset==ye.ha-L));break}return Ve==0||Ve==7&&Xe&&ye==null?(ie!=null&&(ie[0]|=Me.na!=null&&0<Me.na.length),z!=null&&(z[0]=ce),te!=null&&(te[0]=He),0):Ve}function Eo(x,N,L){var z=N.width,te=N.height,ie=0,ce=0,me=z,ye=te;if(N.Da=x!=null&&0<x.Da,N.Da&&(me=x.cd,ye=x.bd,ie=x.v,ce=x.j,11>L||(ie&=-2,ce&=-2),0>ie||0>ce||0>=me||0>=ye||ie+me>z||ce+ye>te))return 0;if(N.v=ie,N.j=ce,N.va=ie+me,N.o=ce+ye,N.U=me,N.T=ye,N.da=x!=null&&0<x.da,N.da){if(!rt(me,ye,L=[x.ib],ie=[x.hb]))return 0;N.ib=L[0],N.hb=ie[0]}return N.ob=x!=null&&x.ob,N.Kb=x==null||!x.Sd,N.da&&(N.ob=N.ib<3*z/4&&N.hb<3*te/4,N.Kb=0),1}function Du(x){if(x==null)return 2;if(11>x.S){var N=x.f.RGBA;N.fb+=(x.height-1)*N.A,N.A=-N.A}else N=x.f.kb,x=x.height,N.O+=(x-1)*N.fa,N.fa=-N.fa,N.N+=(x-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(x-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(x-1)*N.lb,N.lb=-N.lb);return 0}function Si(x,N,L,z){if(z==null||0>=x||0>=N)return 2;if(L!=null){if(L.Da){var te=L.cd,ie=L.bd,ce=-2&L.v,me=-2&L.j;if(0>ce||0>me||0>=te||0>=ie||ce+te>x||me+ie>N)return 2;x=te,N=ie}if(L.da){if(!rt(x,N,te=[L.ib],ie=[L.hb]))return 2;x=te[0],N=ie[0]}}z.width=x,z.height=N;e:{var ye=z.width,ke=z.height;if(x=z.S,0>=ye||0>=ke||!(x>=Yf&&13>x))x=2;else{if(0>=z.Rd&&z.sd==null){ce=ie=te=N=0;var De=(me=ye*ah[x])*ke;if(11>x||(ie=(ke+1)/2*(N=(ye+1)/2),x==12&&(ce=(te=ye)*ke)),(ke=s(De+2*ie+ce))==null){x=1;break e}z.sd=ke,11>x?((ye=z.f.RGBA).eb=ke,ye.fb=0,ye.A=me,ye.size=De):((ye=z.f.kb).y=ke,ye.O=0,ye.fa=me,ye.Fd=De,ye.f=ke,ye.N=0+De,ye.Ab=N,ye.Cd=ie,ye.ea=ke,ye.W=0+De+ie,ye.Db=N,ye.Ed=ie,x==12&&(ye.F=ke,ye.J=0+De+2*ie),ye.Tc=ce,ye.lb=te)}if(N=1,te=z.S,ie=z.width,ce=z.height,te>=Yf&&13>te)if(11>te)x=z.f.RGBA,N&=(me=Math.abs(x.A))*(ce-1)+ie<=x.size,N&=me>=ie*ah[te],N&=x.eb!=null;else{x=z.f.kb,me=(ie+1)/2,De=(ce+1)/2,ye=Math.abs(x.fa),ke=Math.abs(x.Ab);var Xe=Math.abs(x.Db),Ne=Math.abs(x.lb),Me=Ne*(ce-1)+ie;N&=ye*(ce-1)+ie<=x.Fd,N&=ke*(De-1)+me<=x.Cd,N=(N&=Xe*(De-1)+me<=x.Ed)&ye>=ie&ke>=me&Xe>=me,N&=x.y!=null,N&=x.f!=null,N&=x.ea!=null,te==12&&(N&=Ne>=ie,N&=Me<=x.Tc,N&=x.F!=null)}else N=0;x=N?0:2}}return x!=0||L!=null&&L.fd&&(x=Du(z)),x}var nl=64,ws=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],hs=24,Gi=32,Yi=8,Ao=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];kt("Predictor0","PredictorAdd0"),F.Predictor0=function(){return 4278190080},F.Predictor1=function(x){return x},F.Predictor2=function(x,N,L){return N[L+0]},F.Predictor3=function(x,N,L){return N[L+1]},F.Predictor4=function(x,N,L){return N[L-1]},F.Predictor5=function(x,N,L){return Tt(Tt(x,N[L+1]),N[L+0])},F.Predictor6=function(x,N,L){return Tt(x,N[L-1])},F.Predictor7=function(x,N,L){return Tt(x,N[L+0])},F.Predictor8=function(x,N,L){return Tt(N[L-1],N[L+0])},F.Predictor9=function(x,N,L){return Tt(N[L+0],N[L+1])},F.Predictor10=function(x,N,L){return Tt(Tt(x,N[L-1]),Tt(N[L+0],N[L+1]))},F.Predictor11=function(x,N,L){var z=N[L+0];return 0>=At(z>>24&255,x>>24&255,(N=N[L-1])>>24&255)+At(z>>16&255,x>>16&255,N>>16&255)+At(z>>8&255,x>>8&255,N>>8&255)+At(255&z,255&x,255&N)?z:x},F.Predictor12=function(x,N,L){var z=N[L+0];return(at((x>>24&255)+(z>>24&255)-((N=N[L-1])>>24&255))<<24|at((x>>16&255)+(z>>16&255)-(N>>16&255))<<16|at((x>>8&255)+(z>>8&255)-(N>>8&255))<<8|at((255&x)+(255&z)-(255&N)))>>>0},F.Predictor13=function(x,N,L){var z=N[L-1];return(pt((x=Tt(x,N[L+0]))>>24&255,z>>24&255)<<24|pt(x>>16&255,z>>16&255)<<16|pt(x>>8&255,z>>8&255)<<8|pt(255&x,255&z))>>>0};var jc=F.PredictorAdd0;F.PredictorAdd1=Dt,kt("Predictor2","PredictorAdd2"),kt("Predictor3","PredictorAdd3"),kt("Predictor4","PredictorAdd4"),kt("Predictor5","PredictorAdd5"),kt("Predictor6","PredictorAdd6"),kt("Predictor7","PredictorAdd7"),kt("Predictor8","PredictorAdd8"),kt("Predictor9","PredictorAdd9"),kt("Predictor10","PredictorAdd10"),kt("Predictor11","PredictorAdd11"),kt("Predictor12","PredictorAdd12"),kt("Predictor13","PredictorAdd13");var Ec=F.PredictorAdd2;yt("ColorIndexInverseTransform","MapARGB","32b",function(x){return x>>8&255},function(x){return x}),yt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(x){return x},function(x){return x>>8&255});var Ja,Wf=F.ColorIndexInverseTransform,Xi=F.MapARGB,Ki=F.VP8LColorIndexInverseTransformAlpha,Un=F.MapAlpha,Co=F.VP8LPredictorsAdd=[];Co.length=16,(F.VP8LPredictors=[]).length=16,(F.VP8LPredictorsAdd_C=[]).length=16,(F.VP8LPredictors_C=[]).length=16;var Ac,Cc,To,Oo,Ji,Ml,zs,Ro,Zn,Ks,Qr,Vr,_a,Za,Zi,Ni,Il,Fu,md,Z0,Q0,em,pd,gd,Bl,Js,Lu,Hs,Ul=s(511),Vf=s(2041),Pu=s(225),Mu=s(767),Gf=0,Do=Vf,Iu=Pu,Qn=Mu,qn=Ul,Yf=0,es=1,Xf=2,Zs=3,Bu=4,Tc=5,sl=6,Uu=7,Kf=8,Oc=9,Jf=10,Qs=[2,3,7],Rc=[3,3,11],ql=[280,256,256,256,40],Zf=[0,1,1,1,0],qu=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ei=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ti=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],il=8,ri=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ai=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],$s=null,tm=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],vd=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Qf=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],rm=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],zn=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Aa=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Ir=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ds=[],$a=[],ki=[],ol=1,xd=2,Fo=[],Hn=[];No("UpsampleRgbLinePair",ko,3),No("UpsampleBgrLinePair",Tn,3),No("UpsampleRgbaLinePair",fs,4),No("UpsampleBgraLinePair",Vi,4),No("UpsampleArgbLinePair",Nc,4),No("UpsampleRgba4444LinePair",al,2),No("UpsampleRgb565LinePair",rl,2);var zl=F.UpsampleRgbLinePair,yd=F.UpsampleBgrLinePair,Dc=F.UpsampleRgbaLinePair,eh=F.UpsampleBgraLinePair,ll=F.UpsampleArgbLinePair,Qi=F.UpsampleRgba4444LinePair,cl=F.UpsampleRgb565LinePair,ni=16,Fc=1<<ni-1,Hl=-227,ul=482,th=6,fl=0,$n=s(256),rh=s(256),am=s(256),S1=s(256),N1=s(ul-Hl),k1=s(ul-Hl);jo("YuvToRgbRow",ko,3),jo("YuvToBgrRow",Tn,3),jo("YuvToRgbaRow",fs,4),jo("YuvToBgraRow",Vi,4),jo("YuvToArgbRow",Nc,4),jo("YuvToRgba4444Row",al,2),jo("YuvToRgb565Row",rl,2);var Qa=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Lc=[0,2,8],zu=[8,7,6,4,4,2,2,2,1,1,1,1],Hu=1;this.WebPDecodeRGBA=function(x,N,L,z,te){var ie=es,ce=new ht,me=new Kt;ce.ba=me,me.S=ie,me.width=[me.width],me.height=[me.height];var ye=me.width,ke=me.height,De=new $t;if(De==null||x==null)var Xe=2;else e(De!=null),Xe=wi(x,N,L,De.width,De.height,De.Pd,De.Qd,De.format,null);if(Xe!=0?ye=0:(ye!=null&&(ye[0]=De.width[0]),ke!=null&&(ke[0]=De.height[0]),ye=1),ye){me.width=me.width[0],me.height=me.height[0],z!=null&&(z[0]=me.width),te!=null&&(te[0]=me.height);e:{if(z=new po,(te=new bt).data=x,te.w=N,te.ha=L,te.kd=1,N=[0],e(te!=null),((x=wi(te.data,te.w,te.ha,null,null,null,N,null,te))==0||x==7)&&N[0]&&(x=4),(N=x)==0){if(e(ce!=null),z.data=te.data,z.w=te.w+te.offset,z.ha=te.ha-te.offset,z.put=_t,z.ac=Ha,z.bc=mr,z.ma=ce,te.xa){if((x=Ge())==null){ce=1;break e}if((function(Ne,Me){var He=[0],ot=[0],Ve=[0];t:for(;;){if(Ne==null)return 0;if(Me==null)return Ne.a=2,0;if(Ne.l=Me,Ne.a=0,K(Ne.m,Me.data,Me.w,Me.ha),!Jr(Ne.m,He,ot,Ve)){Ne.a=3;break t}if(Ne.xb=xd,Me.width=He[0],Me.height=ot[0],!Ye(He[0],ot[0],1,Ne,null))break t;return 1}return e(Ne.a!=0),0})(x,z)){if(z=(N=Si(z.width,z.height,ce.Oa,ce.ba))==0){t:{z=x;r:for(;;){if(z==null){z=0;break t}if(e(z.s.yc!=null),e(z.s.Ya!=null),e(0<z.s.Wb),e((L=z.l)!=null),e((te=L.ma)!=null),z.xb!=0){if(z.ca=te.ba,z.tb=te.tb,e(z.ca!=null),!Eo(te.Oa,L,Zs)){z.a=2;break r}if(!Je(z,L.width)||L.da)break r;if((L.da||Be(z.ca.S))&&_i(),11>z.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),z.ca.f.kb.F!=null&&_i()),z.Pb&&0<z.s.ua&&z.s.vb.X==null&&!re(z.s.vb,z.s.Wa.Xa)){z.a=1;break r}z.xb=0}if(!We(z,z.V,z.Ba,z.c,z.i,L.o,ge))break r;te.Dc=z.Ma,z=1;break t}e(z.a!=0),z=0}z=!z}z&&(N=x.a)}else N=x.a}else{if((x=new vi)==null){ce=1;break e}if(x.Fa=te.na,x.P=te.P,x.qc=te.Sa,zi(x,z)){if((N=Si(z.width,z.height,ce.Oa,ce.ba))==0){if(x.Aa=0,L=ce.Oa,e((te=x)!=null),L!=null){if(0<(ye=0>(ye=L.Md)?0:100<ye?255:255*ye/100)){for(ke=De=0;4>ke;++ke)12>(Xe=te.pb[ke]).lc&&(Xe.ia=ye*zu[0>Xe.lc?0:Xe.lc]>>3),De|=Xe.ia;De&&(alert("todo:VP8InitRandom"),te.ia=1)}te.Ga=L.Id,100<te.Ga?te.Ga=100:0>te.Ga&&(te.Ga=0)}(function(Ne,Me){if(Ne==null)return 0;if(Me==null)return Zr(Ne,2,"NULL VP8Io parameter in VP8Decode().");if(!Ne.cb&&!zi(Ne,Me))return 0;if(e(Ne.cb),Me.ac==null||Me.ac(Me)){Me.ob&&(Ne.L=0);var He=Lc[Ne.L];if(Ne.L==2?(Ne.yb=0,Ne.zb=0):(Ne.yb=Me.v-He>>4,Ne.zb=Me.j-He>>4,0>Ne.yb&&(Ne.yb=0),0>Ne.zb&&(Ne.zb=0)),Ne.Va=Me.o+15+He>>4,Ne.Hb=Me.va+15+He>>4,Ne.Hb>Ne.za&&(Ne.Hb=Ne.za),Ne.Va>Ne.Ub&&(Ne.Va=Ne.Ub),0<Ne.L){var ot=Ne.ed;for(He=0;4>He;++He){var Ve;if(Ne.Qa.Cb){var it=Ne.Qa.Lb[He];Ne.Qa.Fb||(it+=ot.Tb)}else it=ot.Tb;for(Ve=0;1>=Ve;++Ve){var dt=Ne.gd[He][Ve],jt=it;if(ot.Pc&&(jt+=ot.vd[0],Ve&&(jt+=ot.od[0])),0<(jt=0>jt?0:63<jt?63:jt)){var vt=jt;0<ot.wb&&(vt=4<ot.wb?vt>>2:vt>>1)>9-ot.wb&&(vt=9-ot.wb),1>vt&&(vt=1),dt.dd=vt,dt.tc=2*jt+vt,dt.ld=40<=jt?2:15<=jt?1:0}else dt.tc=0;dt.La=Ve}}}He=0}else Zr(Ne,6,"Frame setup failed"),He=Ne.a;if(He=He==0){if(He){Ne.$c=0,0<Ne.Aa||(Ne.Ic=Hu);t:{He=Ne.Ic,ot=4*(vt=Ne.za);var tr=32*vt,Wt=vt+1,br=0<Ne.L?vt*(0<Ne.Aa?2:1):0,Xt=(Ne.Aa==2?2:1)*vt;if((dt=ot+832+(Ve=3*(16*He+Lc[Ne.L])/2*tr)+(it=Ne.Fa!=null&&0<Ne.Fa.length?Ne.Kc.c*Ne.Kc.i:0))!=dt)He=0;else{if(dt>Ne.Vb){if(Ne.Vb=0,Ne.Ec=s(dt),Ne.Fc=0,Ne.Ec==null){He=Zr(Ne,1,"no memory during frame initialization.");break t}Ne.Vb=dt}dt=Ne.Ec,jt=Ne.Fc,Ne.Ac=dt,Ne.Bc=jt,jt+=ot,Ne.Gd=o(tr,Is),Ne.Hd=0,Ne.rb=o(Wt+1,fa),Ne.sb=1,Ne.wa=br?o(br,Fr):null,Ne.Y=0,Ne.D.Nb=0,Ne.D.wa=Ne.wa,Ne.D.Y=Ne.Y,0<Ne.Aa&&(Ne.D.Y+=vt),e(!0),Ne.oc=dt,Ne.pc=jt,jt+=832,Ne.ya=o(Xt,pi),Ne.aa=0,Ne.D.ya=Ne.ya,Ne.D.aa=Ne.aa,Ne.Aa==2&&(Ne.D.aa+=vt),Ne.R=16*vt,Ne.B=8*vt,vt=(tr=Lc[Ne.L])*Ne.R,tr=tr/2*Ne.B,Ne.sa=dt,Ne.ta=jt+vt,Ne.qa=Ne.sa,Ne.ra=Ne.ta+16*He*Ne.R+tr,Ne.Ha=Ne.qa,Ne.Ia=Ne.ra+8*He*Ne.B+tr,Ne.$c=0,jt+=Ve,Ne.mb=it?dt:null,Ne.nb=it?jt:null,e(jt+it<=Ne.Fc+Ne.Vb),wu(Ne),n(Ne.Ac,Ne.Bc,0,ot),He=1}}if(He){if(Me.ka=0,Me.y=Ne.sa,Me.O=Ne.ta,Me.f=Ne.qa,Me.N=Ne.ra,Me.ea=Ne.Ha,Me.Vd=Ne.Ia,Me.fa=Ne.R,Me.Rc=Ne.B,Me.F=null,Me.J=0,!Gf){for(He=-255;255>=He;++He)Ul[255+He]=0>He?-He:He;for(He=-1020;1020>=He;++He)Vf[1020+He]=-128>He?-128:127<He?127:He;for(He=-112;112>=He;++He)Pu[112+He]=-16>He?-16:15<He?15:He;for(He=-255;510>=He;++He)Mu[255+He]=0>He?0:255<He?255:He;Gf=1}zs=xi,Ro=Su,Ks=us,Qr=Nu,Vr=ku,Zn=Pf,_a=Hf,Za=wo,Zi=J,Ni=Ee,Il=$f,Fu=T,md=Re,Z0=qe,Q0=xo,em=yo,pd=Ll,gd=Tu,$a[0]=qf,$a[1]=Mf,$a[2]=Uf,$a[3]=Au,$a[4]=Bs,$a[5]=Cu,$a[6]=In,$a[7]=Rl,$a[8]=Dl,$a[9]=Us,ds[0]=yi,ds[1]=ju,ds[2]=Eu,ds[3]=Bf,ds[4]=go,ds[5]=Ol,ds[6]=tl,ki[0]=_c,ki[1]=If,ki[2]=Hi,ki[3]=zf,ki[4]=Cn,ki[5]=bc,ki[6]=$i,He=1}else He=0}He&&(He=(function(Pr,Ca){for(Pr.M=0;Pr.M<Pr.Va;++Pr.M){var jr,Vt=Pr.Jc[Pr.M&Pr.Xb],Ut=Pr.m,La=Pr;for(jr=0;jr<La.za;++jr){var dr=Ut,Cr=La,la=Cr.Ac,yn=Cr.Bc+4*jr,Wn=Cr.zc,ba=Cr.ya[Cr.aa+jr];if(Cr.Qa.Bb?ba.$b=be(dr,Cr.Pa.jb[0])?2+be(dr,Cr.Pa.jb[2]):be(dr,Cr.Pa.jb[1]):ba.$b=0,Cr.kc&&(ba.Ad=be(dr,Cr.Bd)),ba.Za=!be(dr,145)+0,ba.Za){var on=ba.Ob,ts=0;for(Cr=0;4>Cr;++Cr){var ln,Dr=Wn[0+Cr];for(ln=0;4>ln;++ln){Dr=zn[la[yn+ln]][Dr];for(var Yr=Qf[be(dr,Dr[0])];0<Yr;)Yr=Qf[2*Yr+be(dr,Dr[Yr])];Dr=-Yr,la[yn+ln]=Dr}a(on,ts,la,yn,4),ts+=4,Wn[0+Cr]=Dr}}else Dr=be(dr,156)?be(dr,128)?1:3:be(dr,163)?2:0,ba.Ob[0]=Dr,n(la,yn,Dr,4),n(Wn,0,Dr,4);ba.Dd=be(dr,142)?be(dr,114)?be(dr,183)?1:3:2:0}if(La.m.Ka)return Zr(Pr,7,"Premature end-of-partition0 encountered.");for(;Pr.ja<Pr.za;++Pr.ja){if(La=Vt,dr=(Ut=Pr).rb[Ut.sb-1],la=Ut.rb[Ut.sb+Ut.ja],jr=Ut.ya[Ut.aa+Ut.ja],yn=Ut.kc?jr.Ad:0)dr.la=la.la=0,jr.Za||(dr.Na=la.Na=0),jr.Hc=0,jr.Gc=0,jr.ia=0;else{var Pa,ea;if(dr=la,la=La,yn=Ut.Pa.Xc,Wn=Ut.ya[Ut.aa+Ut.ja],ba=Ut.pb[Wn.$b],Cr=Wn.ad,on=0,ts=Ut.rb[Ut.sb-1],Dr=ln=0,n(Cr,on,0,384),Wn.Za)var _n=0,Ma=yn[3];else{Yr=s(16);var Xr=dr.Na+ts.Na;if(Xr=$s(la,yn[1],Xr,ba.Eb,0,Yr,0),dr.Na=ts.Na=(0<Xr)+0,1<Xr)zs(Yr,0,Cr,on);else{var en=Yr[0]+3>>3;for(Yr=0;256>Yr;Yr+=16)Cr[on+Yr]=en}_n=1,Ma=yn[0]}var ca=15&dr.la,cn=15&ts.la;for(Yr=0;4>Yr;++Yr){var un=1&cn;for(en=ea=0;4>en;++en)ca=ca>>1|(un=(Xr=$s(la,Ma,Xr=un+(1&ca),ba.Sc,_n,Cr,on))>_n)<<7,ea=ea<<2|(3<Xr?3:1<Xr?2:Cr[on+0]!=0),on+=16;ca>>=4,cn=cn>>1|un<<7,ln=(ln<<8|ea)>>>0}for(Ma=ca,_n=cn>>4,Pa=0;4>Pa;Pa+=2){for(ea=0,ca=dr.la>>4+Pa,cn=ts.la>>4+Pa,Yr=0;2>Yr;++Yr){for(un=1&cn,en=0;2>en;++en)Xr=un+(1&ca),ca=ca>>1|(un=0<(Xr=$s(la,yn[2],Xr,ba.Qc,0,Cr,on)))<<3,ea=ea<<2|(3<Xr?3:1<Xr?2:Cr[on+0]!=0),on+=16;ca>>=2,cn=cn>>1|un<<5}Dr|=ea<<4*Pa,Ma|=ca<<4<<Pa,_n|=(240&cn)<<Pa}dr.la=Ma,ts.la=_n,Wn.Hc=ln,Wn.Gc=Dr,Wn.ia=43690&Dr?0:ba.ia,yn=!(ln|Dr)}if(0<Ut.L&&(Ut.wa[Ut.Y+Ut.ja]=Ut.gd[jr.$b][jr.Za],Ut.wa[Ut.Y+Ut.ja].La|=!yn),La.Ka)return Zr(Pr,7,"Premature end-of-file encountered.")}if(wu(Pr),Ut=Ca,La=1,jr=(Vt=Pr).D,dr=0<Vt.L&&Vt.M>=Vt.zb&&Vt.M<=Vt.Va,Vt.Aa==0)t:{if(jr.M=Vt.M,jr.uc=dr,qs(Vt,jr),La=1,jr=(ea=Vt.D).Nb,dr=(Dr=Lc[Vt.L])*Vt.R,la=Dr/2*Vt.B,Yr=16*jr*Vt.R,en=8*jr*Vt.B,yn=Vt.sa,Wn=Vt.ta-dr+Yr,ba=Vt.qa,Cr=Vt.ra-la+en,on=Vt.Ha,ts=Vt.Ia-la+en,cn=(ca=ea.M)==0,ln=ca>=Vt.Va-1,Vt.Aa==2&&qs(Vt,ea),ea.uc)for(un=(Xr=Vt).D.M,e(Xr.D.uc),ea=Xr.yb;ea<Xr.Hb;++ea){_n=ea,Ma=un;var ha=(Gr=(fn=Xr).D).Nb;Pa=fn.R;var Gr=Gr.wa[Gr.Y+_n],rs=fn.sa,Wa=fn.ta+16*ha*Pa+16*_n,lr=Gr.dd,cr=Gr.tc;if(cr!=0)if(e(3<=cr),fn.L==1)0<_n&&em(rs,Wa,Pa,cr+4),Gr.La&&gd(rs,Wa,Pa,cr),0<Ma&&Q0(rs,Wa,Pa,cr+4),Gr.La&&pd(rs,Wa,Pa,cr);else{var Kr=fn.B,Ss=fn.qa,si=fn.ra+8*ha*Kr+8*_n,ms=fn.Ha,fn=fn.Ia+8*ha*Kr+8*_n;ha=Gr.ld,0<_n&&(Za(rs,Wa,Pa,cr+4,lr,ha),Ni(Ss,si,ms,fn,Kr,cr+4,lr,ha)),Gr.La&&(Fu(rs,Wa,Pa,cr,lr,ha),Z0(Ss,si,ms,fn,Kr,cr,lr,ha)),0<Ma&&(_a(rs,Wa,Pa,cr+4,lr,ha),Zi(Ss,si,ms,fn,Kr,cr+4,lr,ha)),Gr.La&&(Il(rs,Wa,Pa,cr,lr,ha),md(Ss,si,ms,fn,Kr,cr,lr,ha))}}if(Vt.ia&&alert("todo:DitherRow"),Ut.put!=null){if(ea=16*ca,ca=16*(ca+1),cn?(Ut.y=Vt.sa,Ut.O=Vt.ta+Yr,Ut.f=Vt.qa,Ut.N=Vt.ra+en,Ut.ea=Vt.Ha,Ut.W=Vt.Ia+en):(ea-=Dr,Ut.y=yn,Ut.O=Wn,Ut.f=ba,Ut.N=Cr,Ut.ea=on,Ut.W=ts),ln||(ca-=Dr),ca>Ut.o&&(ca=Ut.o),Ut.F=null,Ut.J=null,Vt.Fa!=null&&0<Vt.Fa.length&&ea<ca&&(Ut.J=ya(Vt,Ut,ea,ca-ea),Ut.F=Vt.mb,Ut.F==null&&Ut.F.length==0)){La=Zr(Vt,3,"Could not decode alpha data.");break t}ea<Ut.j&&(Dr=Ut.j-ea,ea=Ut.j,e(!(1&Dr)),Ut.O+=Vt.R*Dr,Ut.N+=Vt.B*(Dr>>1),Ut.W+=Vt.B*(Dr>>1),Ut.F!=null&&(Ut.J+=Ut.width*Dr)),ea<ca&&(Ut.O+=Ut.v,Ut.N+=Ut.v>>1,Ut.W+=Ut.v>>1,Ut.F!=null&&(Ut.J+=Ut.v),Ut.ka=ea-Ut.j,Ut.U=Ut.va-Ut.v,Ut.T=ca-ea,La=Ut.put(Ut))}jr+1!=Vt.Ic||ln||(a(Vt.sa,Vt.ta-dr,yn,Wn+16*Vt.R,dr),a(Vt.qa,Vt.ra-la,ba,Cr+8*Vt.B,la),a(Vt.Ha,Vt.Ia-la,on,ts+8*Vt.B,la))}if(!La)return Zr(Pr,6,"Output aborted.")}return 1})(Ne,Me)),Me.bc!=null&&Me.bc(Me),He&=1}return He?(Ne.cb=0,He):0})(x,z)||(N=x.a)}}else N=x.a}N==0&&ce.Oa!=null&&ce.Oa.fd&&(N=Du(ce.ba))}ce=N}ie=ce!=0?null:11>ie?me.f.RGBA.eb:me.f.kb.y}else ie=null;return ie};var ah=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(F,X){for(var P="",O=0;O<4;O++)P+=String.fromCharCode(F[X++]);return P}function m(F,X){return F[X+0]|F[X+1]<<8}function v(F,X){return(F[X+0]|F[X+1]<<8|F[X+2]<<16)>>>0}function y(F,X){return(F[X+0]|F[X+1]<<8|F[X+2]<<16|F[X+3]<<24)>>>0}new f;var g=[0],b=[0],_=[],S=new f,E=t,C=(function(F,X){var P={},O=0,I=!1,W=0,ne=0;if(P.frames=[],!(function(A,D){for(var B=0;B<4;B++)if(A[D+B]!="RIFF".charCodeAt(B))return!0;return!1})(F,X)){for(y(F,X+=4),X+=8;X<F.length;){var Q=h(F,X),le=y(F,X+=4);X+=4;var ee=le+(1&le);switch(Q){case"VP8 ":case"VP8L":P.frames[O]===void 0&&(P.frames[O]={}),(M=P.frames[O]).src_off=I?ne:X-8,M.src_size=W+le+8,O++,I&&(I=!1,W=0,ne=0);break;case"VP8X":(M=P.header={}).feature_flags=F[X];var K=X+4;M.canvas_width=1+v(F,K),K+=3,M.canvas_height=1+v(F,K),K+=3;break;case"ALPH":I=!0,W=ee+8,ne=X-8;break;case"ANIM":(M=P.header).bgcolor=y(F,X),K=X+4,M.loop_count=m(F,K),K+=2;break;case"ANMF":var ue,M;(M=P.frames[O]={}).offset_x=2*v(F,X),X+=3,M.offset_y=2*v(F,X),X+=3,M.width=1+v(F,X),X+=3,M.height=1+v(F,X),X+=3,M.duration=v(F,X),X+=3,ue=F[X++],M.dispose=1&ue,M.blend=ue>>1&1}Q!="ANMF"&&(X+=ee)}return P}})(E,0);C.response=E,C.rgbaoutput=!0,C.dataurl=!1;var j=C.header?C.header:null,R=C.frames?C.frames:null;if(j){j.loop_counter=j.loop_count,g=[j.canvas_height],b=[j.canvas_width];for(var H=0;H<R.length&&R[H].blend!=0;H++);}var Y=R[0],U=S.WebPDecodeRGBA(E,Y.src_off,Y.src_size,b,g);Y.rgba=U,Y.imgwidth=b[0],Y.imgheight=g[0];for(var V=0;V<b[0]*g[0]*4;V++)_[V]=U[V];return this.width=b,this.height=g,this.data=_,this}(function(t){var e,r,a,n,s,o,u,f,h,m=function(A){return A=A||{},this.isStrokeTransparent=A.isStrokeTransparent||!1,this.strokeOpacity=A.strokeOpacity||1,this.strokeStyle=A.strokeStyle||"#000000",this.fillStyle=A.fillStyle||"#000000",this.isFillTransparent=A.isFillTransparent||!1,this.fillOpacity=A.fillOpacity||1,this.font=A.font||"10px sans-serif",this.textBaseline=A.textBaseline||"alphabetic",this.textAlign=A.textAlign||"left",this.lineWidth=A.lineWidth||1,this.lineJoin=A.lineJoin||"miter",this.lineCap=A.lineCap||"butt",this.path=A.path||[],this.transform=A.transform!==void 0?A.transform.clone():new f,this.globalCompositeOperation=A.globalCompositeOperation||"normal",this.globalAlpha=A.globalAlpha||1,this.clip_path=A.clip_path||[],this.currentPoint=A.currentPoint||new o,this.miterLimit=A.miterLimit||10,this.lastPoint=A.lastPoint||new o,this.lineDashOffset=A.lineDashOffset||0,this.lineDash=A.lineDash||[],this.margin=A.margin||[0,0,0,0],this.prevPageLastElemOffset=A.prevPageLastElemOffset||0,this.ignoreClearRect=typeof A.ignoreClearRect!="boolean"||A.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new v(this),e=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,u=this.internal.Rectangle,f=this.internal.Matrix,h=new m}]);var v=function(A){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var D=A;Object.defineProperty(this,"pdf",{get:function(){return D}});var B=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return B},set:function(re){B=!!re}});var q=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return q},set:function(re){q=!!re}});var Z=0;Object.defineProperty(this,"posX",{get:function(){return Z},set:function(re){isNaN(re)||(Z=re)}});var oe=0;Object.defineProperty(this,"posY",{get:function(){return oe},set:function(re){isNaN(re)||(oe=re)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(re){var Ke;typeof re=="number"?Ke=[re,re,re,re]:((Ke=new Array(4))[0]=re[0],Ke[1]=re.length>=2?re[1]:Ke[0],Ke[2]=re.length>=3?re[2]:Ke[0],Ke[3]=re.length>=4?re[3]:Ke[1]),h.margin=Ke}});var pe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return pe},set:function(re){pe=re}});var _e=0;Object.defineProperty(this,"lastBreak",{get:function(){return _e},set:function(re){_e=re}});var be=[];Object.defineProperty(this,"pageBreaks",{get:function(){return be},set:function(re){be=re}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(re){re instanceof m&&(h=re)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(re){h.path=re}});var Le=[];Object.defineProperty(this,"ctxStack",{get:function(){return Le},set:function(re){Le=re}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(re){var Ke;Ke=y(re),this.ctx.fillStyle=Ke.style,this.ctx.isFillTransparent=Ke.a===0,this.ctx.fillOpacity=Ke.a,this.pdf.setFillColor(Ke.r,Ke.g,Ke.b,{a:Ke.a}),this.pdf.setTextColor(Ke.r,Ke.g,Ke.b,{a:Ke.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(re){var Ke=y(re);this.ctx.strokeStyle=Ke.style,this.ctx.isStrokeTransparent=Ke.a===0,this.ctx.strokeOpacity=Ke.a,Ke.a===0?this.pdf.setDrawColor(255,255,255):(Ke.a,this.pdf.setDrawColor(Ke.r,Ke.g,Ke.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(re){["butt","round","square"].indexOf(re)!==-1&&(this.ctx.lineCap=re,this.pdf.setLineCap(re))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(re){isNaN(re)||(this.ctx.lineWidth=re,this.pdf.setLineWidth(re))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(re){["bevel","round","miter"].indexOf(re)!==-1&&(this.ctx.lineJoin=re,this.pdf.setLineJoin(re))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(re){isNaN(re)||(this.ctx.miterLimit=re,this.pdf.setMiterLimit(re))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(re){this.ctx.textBaseline=re}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(re){["right","end","center","left","start"].indexOf(re)!==-1&&(this.ctx.textAlign=re)}});var he=null,Ae=null,de=null;Object.defineProperty(this,"fontFaces",{get:function(){return de},set:function(re){he=null,Ae=null,de=re}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(re){var Ke;if(this.ctx.font=re,(Ke=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(re))!==null){var Oe=Ke[1];Ke[2];var rt=Ke[3],tt=Ke[4];Ke[5];var Et=Ke[6],kt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(tt)[2];tt=Math.floor(kt==="px"?parseFloat(tt)*this.pdf.internal.scaleFactor:kt==="em"?parseFloat(tt)*this.pdf.getFontSize():parseFloat(tt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(tt);var zt=(function(yt){var er,Lt,Bt=[],we=yt.trim();if(we==="")return Ov;if(we in aS)return[aS[we]];for(;we!=="";){switch(Lt=null,er=(we=sS(we)).charAt(0)){case'"':case"'":Lt=uz(we.substring(1),er);break;default:Lt=fz(we)}if(Lt===null||(Bt.push(Lt[0]),(we=sS(Lt[1]))!==""&&we.charAt(0)!==","))return Ov;we=we.replace(/^,/,"")}return Bt})(Et);if(this.fontFaces){var Tt=(function(yt,er){var Lt=yt.getFontList(),Bt=JSON.stringify(Lt);if(he===null||Ae!==Bt){var we=(function(Ie){var ve=[];return Object.keys(Ie).forEach(function(Ue){Ie[Ue].forEach(function(Be){var Rt=null;switch(Be){case"bold":Rt={family:Ue,weight:"bold"};break;case"italic":Rt={family:Ue,style:"italic"};break;case"bolditalic":Rt={family:Ue,weight:"bold",style:"italic"};break;case"":case"normal":Rt={family:Ue}}Rt!==null&&(Rt.ref={name:Ue,style:Be},ve.push(Rt))})}),ve})(Lt);he=(function(Ie){for(var ve={},Ue=0;Ue<Ie.length;++Ue){var Be=Tv(Ie[Ue]),Rt=Be.family,Ht=Be.stretch,Kt=Be.style,$t=Be.weight;ve[Rt]=ve[Rt]||{},ve[Rt][Ht]=ve[Rt][Ht]||{},ve[Rt][Ht][Kt]=ve[Rt][Ht][Kt]||{},ve[Rt][Ht][Kt][$t]=Be}return ve})(we.concat(er)),Ae=Bt}return he})(this.pdf,this.fontFaces),at=zt.map(function(yt){return{family:yt,stretch:"normal",weight:rt,style:Oe}}),pt=(function(yt,er,Lt){for(var Bt=(Lt=Lt||{}).defaultFontFamily||"times",we=Object.assign({},cz,Lt.genericFontFamilies||{}),Ie=null,ve=null,Ue=0;Ue<er.length;++Ue)if(we[(Ie=Tv(er[Ue])).family]&&(Ie.family=we[Ie.family]),yt.hasOwnProperty(Ie.family)){ve=yt[Ie.family];break}if(!(ve=ve||yt[Bt]))throw new Error("Could not find a font-family for the rule '"+nS(Ie)+"' and default family '"+Bt+"'.");if(ve=(function(Be,Rt){if(Rt[Be])return Rt[Be];var Ht=O2[Be],Kt=Ht<=O2.normal?-1:1,$t=rS(Rt,qk,Ht,Kt);if(!$t)throw new Error("Could not find a matching font-stretch value for "+Be);return $t})(Ie.stretch,ve),ve=(function(Be,Rt){if(Rt[Be])return Rt[Be];for(var Ht=Uk[Be],Kt=0;Kt<Ht.length;++Kt)if(Rt[Ht[Kt]])return Rt[Ht[Kt]];throw new Error("Could not find a matching font-style for "+Be)})(Ie.style,ve),!(ve=(function(Be,Rt){if(Rt[Be])return Rt[Be];if(Be===400&&Rt[500])return Rt[500];if(Be===500&&Rt[400])return Rt[400];var Ht=lz[Be],Kt=rS(Rt,zk,Ht,Be<400?-1:1);if(!Kt)throw new Error("Could not find a matching font-weight for value "+Be);return Kt})(Ie.weight,ve)))throw new Error("Failed to resolve a font for the rule '"+nS(Ie)+"'.");return ve})(Tt,at);this.pdf.setFont(pt.ref.name,pt.ref.style)}else{var At="";(rt==="bold"||parseInt(rt,10)>=700||Oe==="bold")&&(At="bold"),Oe==="italic"&&(At+="italic"),At.length===0&&(At="normal");for(var Dt="",xt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},St=0;St<zt.length;St++){if(this.pdf.internal.getFont(zt[St],At,{noFallback:!0,disableWarning:!0})!==void 0){Dt=zt[St];break}if(At==="bolditalic"&&this.pdf.internal.getFont(zt[St],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Dt=zt[St],At="bold";else if(this.pdf.internal.getFont(zt[St],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Dt=zt[St],At="normal";break}}if(Dt===""){for(var ft=0;ft<zt.length;ft++)if(xt[zt[ft]]){Dt=xt[zt[ft]];break}}Dt=Dt===""?"Times":Dt,this.pdf.setFont(Dt,At)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(re){this.ctx.globalCompositeOperation=re}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(re){this.ctx.globalAlpha=re}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(re){this.ctx.lineDashOffset=re,M.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(re){this.ctx.lineDash=re,M.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(re){this.ctx.ignoreClearRect=!!re}})};v.prototype.setLineDash=function(A){this.lineDash=A},v.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},v.prototype.fill=function(){R.call(this,"fill",!1)},v.prototype.stroke=function(){R.call(this,"stroke",!1)},v.prototype.beginPath=function(){this.path=[{type:"begin"}]},v.prototype.moveTo=function(A,D){if(isNaN(A)||isNaN(D))throw Oa.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var B=this.ctx.transform.applyToPoint(new o(A,D));this.path.push({type:"mt",x:B.x,y:B.y}),this.ctx.lastPoint=new o(A,D)},v.prototype.closePath=function(){var A=new o(0,0),D=0;for(D=this.path.length-1;D!==-1;D--)if(this.path[D].type==="begin"&&va(this.path[D+1])==="object"&&typeof this.path[D+1].x=="number"){A=new o(this.path[D+1].x,this.path[D+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(A.x,A.y)},v.prototype.lineTo=function(A,D){if(isNaN(A)||isNaN(D))throw Oa.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var B=this.ctx.transform.applyToPoint(new o(A,D));this.path.push({type:"lt",x:B.x,y:B.y}),this.ctx.lastPoint=new o(B.x,B.y)},v.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),R.call(this,null,!0)},v.prototype.quadraticCurveTo=function(A,D,B,q){if(isNaN(B)||isNaN(q)||isNaN(A)||isNaN(D))throw Oa.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Z=this.ctx.transform.applyToPoint(new o(B,q)),oe=this.ctx.transform.applyToPoint(new o(A,D));this.path.push({type:"qct",x1:oe.x,y1:oe.y,x:Z.x,y:Z.y}),this.ctx.lastPoint=new o(Z.x,Z.y)},v.prototype.bezierCurveTo=function(A,D,B,q,Z,oe){if(isNaN(Z)||isNaN(oe)||isNaN(A)||isNaN(D)||isNaN(B)||isNaN(q))throw Oa.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var pe=this.ctx.transform.applyToPoint(new o(Z,oe)),_e=this.ctx.transform.applyToPoint(new o(A,D)),be=this.ctx.transform.applyToPoint(new o(B,q));this.path.push({type:"bct",x1:_e.x,y1:_e.y,x2:be.x,y2:be.y,x:pe.x,y:pe.y}),this.ctx.lastPoint=new o(pe.x,pe.y)},v.prototype.arc=function(A,D,B,q,Z,oe){if(isNaN(A)||isNaN(D)||isNaN(B)||isNaN(q)||isNaN(Z))throw Oa.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(oe=!!oe,!this.ctx.transform.isIdentity){var pe=this.ctx.transform.applyToPoint(new o(A,D));A=pe.x,D=pe.y;var _e=this.ctx.transform.applyToPoint(new o(0,B)),be=this.ctx.transform.applyToPoint(new o(0,0));B=Math.sqrt(Math.pow(_e.x-be.x,2)+Math.pow(_e.y-be.y,2))}Math.abs(Z-q)>=2*Math.PI&&(q=0,Z=2*Math.PI),this.path.push({type:"arc",x:A,y:D,radius:B,startAngle:q,endAngle:Z,counterclockwise:oe})},v.prototype.arcTo=function(A,D,B,q,Z){throw new Error("arcTo not implemented.")},v.prototype.rect=function(A,D,B,q){if(isNaN(A)||isNaN(D)||isNaN(B)||isNaN(q))throw Oa.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(A,D),this.lineTo(A+B,D),this.lineTo(A+B,D+q),this.lineTo(A,D+q),this.lineTo(A,D),this.lineTo(A+B,D),this.lineTo(A,D)},v.prototype.fillRect=function(A,D,B,q){if(isNaN(A)||isNaN(D)||isNaN(B)||isNaN(q))throw Oa.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var Z={};this.lineCap!=="butt"&&(Z.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Z.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(A,D,B,q),this.fill(),Z.hasOwnProperty("lineCap")&&(this.lineCap=Z.lineCap),Z.hasOwnProperty("lineJoin")&&(this.lineJoin=Z.lineJoin)}},v.prototype.strokeRect=function(A,D,B,q){if(isNaN(A)||isNaN(D)||isNaN(B)||isNaN(q))throw Oa.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(A,D,B,q),this.stroke())},v.prototype.clearRect=function(A,D,B,q){if(isNaN(A)||isNaN(D)||isNaN(B)||isNaN(q))throw Oa.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(A,D,B,q))},v.prototype.save=function(A){A=typeof A!="boolean"||A;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("q");if(this.pdf.setPage(D),A){this.ctx.fontSize=this.pdf.internal.getFontSize();var q=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=q}},v.prototype.restore=function(A){A=typeof A!="boolean"||A;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("Q");this.pdf.setPage(D),A&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},v.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var y=function(A){var D,B,q,Z;if(A.isCanvasGradient===!0&&(A=A.getColor()),!A)return{r:0,g:0,b:0,a:0,style:A};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(A))D=0,B=0,q=0,Z=0;else{var oe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(A);if(oe!==null)D=parseInt(oe[1]),B=parseInt(oe[2]),q=parseInt(oe[3]),Z=1;else if((oe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(A))!==null)D=parseInt(oe[1]),B=parseInt(oe[2]),q=parseInt(oe[3]),Z=parseFloat(oe[4]);else{if(Z=1,typeof A=="string"&&A.charAt(0)!=="#"){var pe=new Dk(A);A=pe.ok?pe.toHex():"#000000"}A.length===4?(D=A.substring(1,2),D+=D,B=A.substring(2,3),B+=B,q=A.substring(3,4),q+=q):(D=A.substring(1,3),B=A.substring(3,5),q=A.substring(5,7)),D=parseInt(D,16),B=parseInt(B,16),q=parseInt(q,16)}}return{r:D,g:B,b:q,a:Z,style:A}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};v.prototype.fillText=function(A,D,B,q){if(isNaN(D)||isNaN(B)||typeof A!="string")throw Oa.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(q=isNaN(q)?void 0:q,!g.call(this)){var Z=ee(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;O.call(this,{text:A,x:D,y:B,scale:oe,angle:Z,align:this.textAlign,maxWidth:q})}},v.prototype.strokeText=function(A,D,B,q){if(isNaN(D)||isNaN(B)||typeof A!="string")throw Oa.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){q=isNaN(q)?void 0:q;var Z=ee(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;O.call(this,{text:A,x:D,y:B,scale:oe,renderingMode:"stroke",angle:Z,align:this.textAlign,maxWidth:q})}},v.prototype.measureText=function(A){if(typeof A!="string")throw Oa.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var D=this.pdf,B=this.pdf.internal.scaleFactor,q=D.internal.getFontSize(),Z=D.getStringUnitWidth(A)*q/D.internal.scaleFactor;return new function(oe){var pe=(oe=oe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return pe}}),this}({width:Z*=Math.round(96*B/72*1e4)/1e4})},v.prototype.scale=function(A,D){if(isNaN(A)||isNaN(D))throw Oa.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var B=new f(A,0,0,D,0,0);this.ctx.transform=this.ctx.transform.multiply(B)},v.prototype.rotate=function(A){if(isNaN(A))throw Oa.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var D=new f(Math.cos(A),Math.sin(A),-Math.sin(A),Math.cos(A),0,0);this.ctx.transform=this.ctx.transform.multiply(D)},v.prototype.translate=function(A,D){if(isNaN(A)||isNaN(D))throw Oa.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var B=new f(1,0,0,1,A,D);this.ctx.transform=this.ctx.transform.multiply(B)},v.prototype.transform=function(A,D,B,q,Z,oe){if(isNaN(A)||isNaN(D)||isNaN(B)||isNaN(q)||isNaN(Z)||isNaN(oe))throw Oa.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var pe=new f(A,D,B,q,Z,oe);this.ctx.transform=this.ctx.transform.multiply(pe)},v.prototype.setTransform=function(A,D,B,q,Z,oe){A=isNaN(A)?1:A,D=isNaN(D)?0:D,B=isNaN(B)?0:B,q=isNaN(q)?1:q,Z=isNaN(Z)?0:Z,oe=isNaN(oe)?0:oe,this.ctx.transform=new f(A,D,B,q,Z,oe)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};v.prototype.drawImage=function(A,D,B,q,Z,oe,pe,_e,be){var Le=this.pdf.getImageProperties(A),he=1,Ae=1,de=1,re=1;q!==void 0&&_e!==void 0&&(de=_e/q,re=be/Z,he=Le.width/q*_e/q,Ae=Le.height/Z*be/Z),oe===void 0&&(oe=D,pe=B,D=0,B=0),q!==void 0&&_e===void 0&&(_e=q,be=Z),q===void 0&&_e===void 0&&(_e=Le.width,be=Le.height);var Ke=this.ctx.transform.decompose(),Oe=ee(Ke.rotate.shx),rt=new f,tt=(rt=(rt=(rt=rt.multiply(Ke.translate)).multiply(Ke.skew)).multiply(Ke.scale)).applyToRectangle(new u(oe-D*de,pe-B*re,q*he,Z*Ae));if(this.autoPaging){for(var Et,kt=S.call(this,tt),zt=[],Tt=0;Tt<kt.length;Tt+=1)zt.indexOf(kt[Tt])===-1&&zt.push(kt[Tt]);j(zt);for(var at=zt[0],pt=zt[zt.length-1],At=at;At<pt+1;At++){this.pdf.setPage(At);var Dt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xt=At===1?this.posY+this.margin[0]:this.margin[0],St=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],yt=At===1?0:St+(At-2)*ft;if(this.ctx.clip_path.length!==0){var er=this.path;Et=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(Et,this.posX+this.margin[3],-yt+xt+this.ctx.prevPageLastElemOffset),H.call(this,"fill",!0),this.path=er}var Lt=JSON.parse(JSON.stringify(tt));Lt=C([Lt],this.posX+this.margin[3],-yt+xt+this.ctx.prevPageLastElemOffset)[0];var Bt=(At>at||At<pt)&&_.call(this);Bt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Dt,ft,null).clip().discardPath()),this.pdf.addImage(A,"JPEG",Lt.x,Lt.y,Lt.w,Lt.h,null,null,Oe),Bt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(A,"JPEG",tt.x,tt.y,tt.w,tt.h,null,null,Oe)};var S=function(A,D,B){var q=[];D=D||this.pdf.internal.pageSize.width,B=B||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Z=this.posY+this.ctx.prevPageLastElemOffset;switch(A.type){default:case"mt":case"lt":q.push(Math.floor((A.y+Z)/B)+1);break;case"arc":q.push(Math.floor((A.y+Z-A.radius)/B)+1),q.push(Math.floor((A.y+Z+A.radius)/B)+1);break;case"qct":var oe=K(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x,A.y);q.push(Math.floor((oe.y+Z)/B)+1),q.push(Math.floor((oe.y+oe.h+Z)/B)+1);break;case"bct":var pe=ue(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x2,A.y2,A.x,A.y);q.push(Math.floor((pe.y+Z)/B)+1),q.push(Math.floor((pe.y+pe.h+Z)/B)+1);break;case"rect":q.push(Math.floor((A.y+Z)/B)+1),q.push(Math.floor((A.y+A.h+Z)/B)+1)}for(var _e=0;_e<q.length;_e+=1)for(;this.pdf.internal.getNumberOfPages()<q[_e];)E.call(this);return q},E=function(){var A=this.fillStyle,D=this.strokeStyle,B=this.font,q=this.lineCap,Z=this.lineWidth,oe=this.lineJoin;this.pdf.addPage(),this.fillStyle=A,this.strokeStyle=D,this.font=B,this.lineCap=q,this.lineWidth=Z,this.lineJoin=oe},C=function(A,D,B){for(var q=0;q<A.length;q++)switch(A[q].type){case"bct":A[q].x2+=D,A[q].y2+=B;case"qct":A[q].x1+=D,A[q].y1+=B;default:A[q].x+=D,A[q].y+=B}return A},j=function(A){return A.sort(function(D,B){return D-B})},R=function(A,D){var B=this.fillStyle,q=this.strokeStyle,Z=this.lineCap,oe=this.lineWidth,pe=Math.abs(oe*this.ctx.transform.scaleX),_e=this.lineJoin;if(this.autoPaging){for(var be,Le,he=JSON.parse(JSON.stringify(this.path)),Ae=JSON.parse(JSON.stringify(this.path)),de=[],re=0;re<Ae.length;re++)if(Ae[re].x!==void 0)for(var Ke=S.call(this,Ae[re]),Oe=0;Oe<Ke.length;Oe+=1)de.indexOf(Ke[Oe])===-1&&de.push(Ke[Oe]);for(var rt=0;rt<de.length;rt++)for(;this.pdf.internal.getNumberOfPages()<de[rt];)E.call(this);j(de);for(var tt=de[0],Et=de[de.length-1],kt=tt;kt<Et+1;kt++){this.pdf.setPage(kt),this.fillStyle=B,this.strokeStyle=q,this.lineCap=Z,this.lineWidth=pe,this.lineJoin=_e;var zt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Tt=kt===1?this.posY+this.margin[0]:this.margin[0],at=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],pt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],At=kt===1?0:at+(kt-2)*pt;if(this.ctx.clip_path.length!==0){var Dt=this.path;be=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(be,this.posX+this.margin[3],-At+Tt+this.ctx.prevPageLastElemOffset),H.call(this,A,!0),this.path=Dt}if(Le=JSON.parse(JSON.stringify(he)),this.path=C(Le,this.posX+this.margin[3],-At+Tt+this.ctx.prevPageLastElemOffset),D===!1||kt===0){var xt=(kt>tt||kt<Et)&&_.call(this);xt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],zt,pt,null).clip().discardPath()),H.call(this,A,D),xt&&this.pdf.restoreGraphicsState()}this.lineWidth=oe}this.path=he}else this.lineWidth=pe,H.call(this,A,D),this.lineWidth=oe},H=function(A,D){if((A!=="stroke"||D||!b.call(this))&&(A==="stroke"||D||!g.call(this))){for(var B,q,Z=[],oe=this.path,pe=0;pe<oe.length;pe++){var _e=oe[pe];switch(_e.type){case"begin":Z.push({begin:!0});break;case"close":Z.push({close:!0});break;case"mt":Z.push({start:_e,deltas:[],abs:[]});break;case"lt":var be=Z.length;if(oe[pe-1]&&!isNaN(oe[pe-1].x)&&(B=[_e.x-oe[pe-1].x,_e.y-oe[pe-1].y],be>0)){for(;be>=0;be--)if(Z[be-1].close!==!0&&Z[be-1].begin!==!0){Z[be-1].deltas.push(B),Z[be-1].abs.push(_e);break}}break;case"bct":B=[_e.x1-oe[pe-1].x,_e.y1-oe[pe-1].y,_e.x2-oe[pe-1].x,_e.y2-oe[pe-1].y,_e.x-oe[pe-1].x,_e.y-oe[pe-1].y],Z[Z.length-1].deltas.push(B);break;case"qct":var Le=oe[pe-1].x+2/3*(_e.x1-oe[pe-1].x),he=oe[pe-1].y+2/3*(_e.y1-oe[pe-1].y),Ae=_e.x+2/3*(_e.x1-_e.x),de=_e.y+2/3*(_e.y1-_e.y),re=_e.x,Ke=_e.y;B=[Le-oe[pe-1].x,he-oe[pe-1].y,Ae-oe[pe-1].x,de-oe[pe-1].y,re-oe[pe-1].x,Ke-oe[pe-1].y],Z[Z.length-1].deltas.push(B);break;case"arc":Z.push({deltas:[],abs:[],arc:!0}),Array.isArray(Z[Z.length-1].abs)&&Z[Z.length-1].abs.push(_e)}}q=D?null:A==="stroke"?"stroke":"fill";for(var Oe=!1,rt=0;rt<Z.length;rt++)if(Z[rt].arc)for(var tt=Z[rt].abs,Et=0;Et<tt.length;Et++){var kt=tt[Et];kt.type==="arc"?V.call(this,kt.x,kt.y,kt.radius,kt.startAngle,kt.endAngle,kt.counterclockwise,void 0,D,!Oe):I.call(this,kt.x,kt.y),Oe=!0}else if(Z[rt].close===!0)this.pdf.internal.out("h"),Oe=!1;else if(Z[rt].begin!==!0){var zt=Z[rt].start.x,Tt=Z[rt].start.y;W.call(this,Z[rt].deltas,zt,Tt),Oe=!0}q&&F.call(this,q),D&&X.call(this)}},Y=function(A){var D=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,B=D*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return A-B;case"top":return A+D-B;case"hanging":return A+D-2*B;case"middle":return A+D/2-B;default:return A}},U=function(A){return A+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};v.prototype.createLinearGradient=function(){var A=function(){};return A.colorStops=[],A.addColorStop=function(D,B){this.colorStops.push([D,B])},A.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},A.isCanvasGradient=!0,A},v.prototype.createPattern=function(){return this.createLinearGradient()},v.prototype.createRadialGradient=function(){return this.createLinearGradient()};var V=function(A,D,B,q,Z,oe,pe,_e,be){for(var Le=Q.call(this,B,q,Z,oe),he=0;he<Le.length;he++){var Ae=Le[he];he===0&&(be?P.call(this,Ae.x1+A,Ae.y1+D):I.call(this,Ae.x1+A,Ae.y1+D)),ne.call(this,A,D,Ae.x2,Ae.y2,Ae.x3,Ae.y3,Ae.x4,Ae.y4)}_e?X.call(this):F.call(this,pe)},F=function(A){switch(A){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},X=function(){this.pdf.clip(),this.pdf.discardPath()},P=function(A,D){this.pdf.internal.out(r(A)+" "+a(D)+" m")},O=function(A){var D;switch(A.align){case"right":case"end":D="right";break;case"center":D="center";break;default:D="left"}var B,q,Z,oe=this.pdf.getTextDimensions(A.text),pe=Y.call(this,A.y),_e=U.call(this,pe)-oe.h,be=this.ctx.transform.applyToPoint(new o(A.x,pe));if(this.autoPaging){var Le=this.ctx.transform.decompose(),he=new f;he=(he=(he=he.multiply(Le.translate)).multiply(Le.skew)).multiply(Le.scale);for(var Ae=this.ctx.transform.applyToRectangle(new u(A.x,pe,oe.w,oe.h)),de=he.applyToRectangle(new u(A.x,_e,oe.w,oe.h)),re=S.call(this,de),Ke=[],Oe=0;Oe<re.length;Oe+=1)Ke.indexOf(re[Oe])===-1&&Ke.push(re[Oe]);j(Ke);for(var rt=Ke[0],tt=Ke[Ke.length-1],Et=rt;Et<tt+1;Et++){this.pdf.setPage(Et);var kt=Et===1?this.posY+this.margin[0]:this.margin[0],zt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Tt=this.pdf.internal.pageSize.height-this.margin[2],at=Tt-this.margin[0],pt=this.pdf.internal.pageSize.width-this.margin[1],At=pt-this.margin[3],Dt=Et===1?0:zt+(Et-2)*at;if(this.ctx.clip_path.length!==0){var xt=this.path;B=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(B,this.posX+this.margin[3],-1*Dt+kt),H.call(this,"fill",!0),this.path=xt}var St=C([JSON.parse(JSON.stringify(de))],this.posX+this.margin[3],-Dt+kt+this.ctx.prevPageLastElemOffset)[0];A.scale>=.01&&(q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(q*A.scale),Z=this.lineWidth,this.lineWidth=Z*A.scale);var ft=this.autoPaging!=="text";if(ft||St.y+St.h<=Tt){if(ft||St.y>=kt&&St.x<=pt){var yt=ft?A.text:this.pdf.splitTextToSize(A.text,A.maxWidth||pt-St.x)[0],er=C([JSON.parse(JSON.stringify(Ae))],this.posX+this.margin[3],-Dt+kt+this.ctx.prevPageLastElemOffset)[0],Lt=ft&&(Et>rt||Et<tt)&&_.call(this);Lt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],At,at,null).clip().discardPath()),this.pdf.text(yt,er.x,er.y,{angle:A.angle,align:D,renderingMode:A.renderingMode}),Lt&&this.pdf.restoreGraphicsState()}}else St.y<Tt&&(this.ctx.prevPageLastElemOffset+=Tt-St.y);A.scale>=.01&&(this.pdf.setFontSize(q),this.lineWidth=Z)}}else A.scale>=.01&&(q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(q*A.scale),Z=this.lineWidth,this.lineWidth=Z*A.scale),this.pdf.text(A.text,be.x+this.posX,be.y+this.posY,{angle:A.angle,align:D,renderingMode:A.renderingMode,maxWidth:A.maxWidth}),A.scale>=.01&&(this.pdf.setFontSize(q),this.lineWidth=Z)},I=function(A,D,B,q){B=B||0,q=q||0,this.pdf.internal.out(r(A+B)+" "+a(D+q)+" l")},W=function(A,D,B){return this.pdf.lines(A,D,B,null,null)},ne=function(A,D,B,q,Z,oe,pe,_e){this.pdf.internal.out([e(n(B+A)),e(s(q+D)),e(n(Z+A)),e(s(oe+D)),e(n(pe+A)),e(s(_e+D)),"c"].join(" "))},Q=function(A,D,B,q){for(var Z=2*Math.PI,oe=Math.PI/2;D>B;)D-=Z;var pe=Math.abs(B-D);pe<Z&&q&&(pe=Z-pe);for(var _e=[],be=q?-1:1,Le=D;pe>1e-5;){var he=Le+be*Math.min(pe,oe);_e.push(le.call(this,A,Le,he)),pe-=Math.abs(he-Le),Le=he}return _e},le=function(A,D,B){var q=(B-D)/2,Z=A*Math.cos(q),oe=A*Math.sin(q),pe=Z,_e=-oe,be=pe*pe+_e*_e,Le=be+pe*Z+_e*oe,he=4/3*(Math.sqrt(2*be*Le)-Le)/(pe*oe-_e*Z),Ae=pe-he*_e,de=_e+he*pe,re=Ae,Ke=-de,Oe=q+D,rt=Math.cos(Oe),tt=Math.sin(Oe);return{x1:A*Math.cos(D),y1:A*Math.sin(D),x2:Ae*rt-de*tt,y2:Ae*tt+de*rt,x3:re*rt-Ke*tt,y3:re*tt+Ke*rt,x4:A*Math.cos(B),y4:A*Math.sin(B)}},ee=function(A){return 180*A/Math.PI},K=function(A,D,B,q,Z,oe){var pe=A+.5*(B-A),_e=D+.5*(q-D),be=Z+.5*(B-Z),Le=oe+.5*(q-oe),he=Math.min(A,Z,pe,be),Ae=Math.max(A,Z,pe,be),de=Math.min(D,oe,_e,Le),re=Math.max(D,oe,_e,Le);return new u(he,de,Ae-he,re-de)},ue=function(A,D,B,q,Z,oe,pe,_e){var be,Le,he,Ae,de,re,Ke,Oe,rt,tt,Et,kt,zt,Tt,at=B-A,pt=q-D,At=Z-B,Dt=oe-q,xt=pe-Z,St=_e-oe;for(Le=0;Le<41;Le++)rt=(Ke=(he=A+(be=Le/40)*at)+be*((de=B+be*At)-he))+be*(de+be*(Z+be*xt-de)-Ke),tt=(Oe=(Ae=D+be*pt)+be*((re=q+be*Dt)-Ae))+be*(re+be*(oe+be*St-re)-Oe),Le==0?(Et=rt,kt=tt,zt=rt,Tt=tt):(Et=Math.min(Et,rt),kt=Math.min(kt,tt),zt=Math.max(zt,rt),Tt=Math.max(Tt,tt));return new u(Math.round(Et),Math.round(kt),Math.round(zt-Et),Math.round(Tt-kt))},M=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var A,D,B=(A=this.ctx.lineDash,D=this.ctx.lineDashOffset,JSON.stringify({lineDash:A,lineDashOffset:D}));this.prevLineDash!==B&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=B)}}})(sr.API),(function(t){var e=function(o){var u,f,h,m,v,y,g,b,_,S;for(f=[],h=0,m=(o+=u="\0\0\0\0".slice(o.length%4||4)).length;m>h;h+=4)(v=(o.charCodeAt(h)<<24)+(o.charCodeAt(h+1)<<16)+(o.charCodeAt(h+2)<<8)+o.charCodeAt(h+3))!==0?(y=(v=((v=((v=((v=(v-(S=v%85))/85)-(_=v%85))/85)-(b=v%85))/85)-(g=v%85))/85)%85,f.push(y+33,g+33,b+33,_+33,S+33)):f.push(122);return(function(E,C){for(var j=C;j>0;j--)E.pop()})(f,u.length),String.fromCharCode.apply(String,f)+"~>"},r=function(o){var u,f,h,m,v,y=String,g="length",b=255,_="charCodeAt",S="slice",E="replace";for(o[S](-2),o=o[S](0,-2)[E](/\s/g,"")[E]("z","!!!!!"),h=[],m=0,v=(o+=u="uuuuu"[S](o[g]%5||5))[g];v>m;m+=5)f=52200625*(o[_](m)-33)+614125*(o[_](m+1)-33)+7225*(o[_](m+2)-33)+85*(o[_](m+3)-33)+(o[_](m+4)-33),h.push(b&f>>24,b&f>>16,b&f>>8,b&f);return(function(C,j){for(var R=j;R>0;R--)C.pop()})(h,u[g]),y.fromCharCode.apply(y,h)},a=function(o){return o.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">"},n=function(o){var u=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),u.test(o)===!1)return"";for(var f="",h=0;h<o.length;h+=2)f+=String.fromCharCode("0x"+(o[h]+o[h+1]));return f},s=function(o){for(var u=new Uint8Array(o.length),f=o.length;f--;)u[f]=o.charCodeAt(f);return(u=N2(u)).reduce(function(h,m){return h+String.fromCharCode(m)},"")};t.processDataByFilters=function(o,u){var f=0,h=o||"",m=[];for(typeof(u=u||[])=="string"&&(u=[u]),f=0;f<u.length;f+=1)switch(u[f]){case"ASCII85Decode":case"/ASCII85Decode":h=r(h),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":h=e(h),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":h=n(h),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":h=a(h),m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":h=s(h),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+u[f]+'" is not implemented')}return{data:h,reverseChain:m.reverse().join(" ")}}})(sr.API),(function(t){t.loadFile=function(e,r,a){return(function(n,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var u=void 0;try{u=(function(f,h,m){var v=new XMLHttpRequest,y=0,g=function(b){var _=b.length,S=[],E=String.fromCharCode;for(y=0;y<_;y+=1)S.push(E(255&b.charCodeAt(y)));return S.join("")};if(v.open("GET",f,!h),v.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(v.onload=function(){v.status===200?m(g(this.responseText)):m(void 0)}),v.send(null),h&&v.status===200)return g(v.responseText)})(n,s,o)}catch{}return u})(e,r,a)},t.loadImageFile=t.loadFile})(sr.API),(function(t){function e(){return(wr.html2canvas?Promise.resolve(wr.html2canvas):hv(()=>import("./html2canvas.esm-Ge7aVWlp.js"),[])).catch(function(u){return Promise.reject(new Error("Could not load html2canvas: "+u))}).then(function(u){return u.default?u.default:u})}function r(){return(wr.DOMPurify?Promise.resolve(wr.DOMPurify):hv(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(u){return Promise.reject(new Error("Could not load dompurify: "+u))}).then(function(u){return u.default?u.default:u})}var a=function(u){var f=va(u);return f==="undefined"?"undefined":f==="string"||u instanceof String?"string":f==="number"||u instanceof Number?"number":f==="function"||u instanceof Function?"function":u&&u.constructor===Array?"array":u&&u.nodeType===1?"element":f==="object"?"object":"unknown"},n=function(u,f){var h=document.createElement(u);for(var m in f.className&&(h.className=f.className),f.innerHTML&&f.dompurify&&(h.innerHTML=f.dompurify.sanitize(f.innerHTML)),f.style)h.style[m]=f.style[m];return h},s=function u(f,h){for(var m=f.nodeType===3?document.createTextNode(f.nodeValue):f.cloneNode(!1),v=f.firstChild;v;v=v.nextSibling)h!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||m.appendChild(u(v,h));return f.nodeType===1&&(f.nodeName==="CANVAS"?(m.width=f.width,m.height=f.height,m.getContext("2d").drawImage(f,0,0)):f.nodeName!=="TEXTAREA"&&f.nodeName!=="SELECT"||(m.value=f.value),m.addEventListener("load",function(){m.scrollTop=f.scrollTop,m.scrollLeft=f.scrollLeft},!0)),m},o=function u(f){var h=Object.assign(u.convert(Promise.resolve()),JSON.parse(JSON.stringify(u.template))),m=u.convert(Promise.resolve(),h);return(m=m.setProgress(1,u,1,[u])).set(f)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(u,f){return u.__proto__=f||o.prototype,u},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(u,f){return this.then(function(){switch(f=f||(function(h){switch(a(h)){case"string":return"string";case"element":return h.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(u),f){case"string":return this.then(r).then(function(h){return this.set({src:n("div",{innerHTML:u,dompurify:h})})});case"element":return this.set({src:u});case"canvas":return this.set({canvas:u});case"img":return this.set({img:u});default:return this.error("Unknown source type.")}})},o.prototype.to=function(u){switch(u){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var u={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},f=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);f.tagName==="BODY"&&(u.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:u}),this.prop.container.appendChild(f),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var u=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(u).then(e).then(function(f){var h=Object.assign({},this.opt.html2canvas);return delete h.onrendered,f(this.prop.container,h)}).then(function(f){(this.opt.html2canvas.onrendered||function(){})(f),this.prop.canvas=f,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var u=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(u).then(e).then(function(f){var h=this.opt.jsPDF,m=this.opt.fontFaces,v=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,y=Object.assign({async:!0,allowTaint:!0,scale:v,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete y.onrendered,h.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,h.context2d.posX=this.opt.x,h.context2d.posY=this.opt.y,h.context2d.margin=this.opt.margin,h.context2d.fontFaces=m,m)for(var g=0;g<m.length;++g){var b=m[g],_=b.src.find(function(S){return S.format==="truetype"});_&&h.addFont(_.url,b.ref.name,b.ref.style)}return y.windowHeight=y.windowHeight||0,y.windowHeight=y.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):y.windowHeight,h.context2d.save(!0),f(this.prop.container,y)}).then(function(f){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(f),this.prop.canvas=f,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var u=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=u})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(u,f,h){return(h=h||"pdf").toLowerCase()==="img"||h.toLowerCase()==="image"?this.outputImg(u,f):this.outputPdf(u,f)},o.prototype.outputPdf=function(u,f){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(u,f)})},o.prototype.outputImg=function(u){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(u){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+u+'" is not supported.'}})},o.prototype.save=function(u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(u?{filename:u}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(u){if(a(u)!=="object")return this;var f=Object.keys(u||{}).map(function(h){if(h in o.template.prop)return function(){this.prop[h]=u[h]};switch(h){case"margin":return this.setMargin.bind(this,u.margin);case"jsPDF":return function(){return this.opt.jsPDF=u.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,u.pageSize);default:return function(){this.opt[h]=u[h]}}},this);return this.then(function(){return this.thenList(f)})},o.prototype.get=function(u,f){return this.then(function(){var h=u in o.template.prop?this.prop[u]:this.opt[u];return f?f(h):h})},o.prototype.setMargin=function(u){return this.then(function(){switch(a(u)){case"number":u=[u,u,u,u];case"array":if(u.length===2&&(u=[u[0],u[1],u[0],u[1]]),u.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=u}).then(this.setPageSize)},o.prototype.setPageSize=function(u){function f(h,m){return Math.floor(h*m/72*96)}return this.then(function(){(u=u||sr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(u.inner={width:u.width-this.opt.margin[1]-this.opt.margin[3],height:u.height-this.opt.margin[0]-this.opt.margin[2]},u.inner.px={width:f(u.inner.width,u.k),height:f(u.inner.height,u.k)},u.inner.ratio=u.inner.height/u.inner.width),this.prop.pageSize=u})},o.prototype.setProgress=function(u,f,h,m){return u!=null&&(this.progress.val=u),f!=null&&(this.progress.state=f),h!=null&&(this.progress.n=h),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(u,f,h,m){return this.setProgress(u?this.progress.val+u:null,f||null,h?this.progress.n+h:null,m?this.progress.stack.concat(m):null)},o.prototype.then=function(u,f){var h=this;return this.thenCore(u,f,function(m,v){return h.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(y){return h.updateProgress(null,m),y}).then(m,v).then(function(y){return h.updateProgress(1),y})})},o.prototype.thenCore=function(u,f,h){h=h||Promise.prototype.then;var m=this;u&&(u=u.bind(m)),f&&(f=f.bind(m));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?m:o.convert(Object.assign({},m),Promise.prototype),y=h.call(v,u,f);return o.convert(y,m.__proto__)},o.prototype.thenExternal=function(u,f){return Promise.prototype.then.call(this,u,f)},o.prototype.thenList=function(u){var f=this;return u.forEach(function(h){f=f.thenCore(h)}),f},o.prototype.catch=function(u){u&&(u=u.bind(this));var f=Promise.prototype.catch.call(this,u);return o.convert(f,this)},o.prototype.catchExternal=function(u){return Promise.prototype.catch.call(this,u)},o.prototype.error=function(u){return this.then(function(){throw new Error(u)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,sr.getPageSize=function(u,f,h){if(va(u)==="object"){var m=u;u=m.orientation,f=m.unit||f,h=m.format||h}f=f||"mm",h=h||"a4",u=(""+(u||"P")).toLowerCase();var v,y=(""+h).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(f){case"pt":v=1;break;case"mm":v=72/25.4;break;case"cm":v=72/2.54;break;case"in":v=72;break;case"px":v=.75;break;case"pc":case"em":v=12;break;case"ex":v=6;break;default:throw"Invalid unit: "+f}var b,_=0,S=0;if(g.hasOwnProperty(y))_=g[y][1]/v,S=g[y][0]/v;else try{_=h[1],S=h[0]}catch{throw new Error("Invalid format: "+h)}if(u==="p"||u==="portrait")u="p",S>_&&(b=S,S=_,_=b);else{if(u!=="l"&&u!=="landscape")throw"Invalid orientation: "+u;u="l",_>S&&(b=S,S=_,_=b)}return{width:S,height:_,unit:f,k:v,orientation:u}},t.html=function(u,f){(f=f||{}).callback=f.callback||function(){},f.html2canvas=f.html2canvas||{},f.html2canvas.canvas=f.html2canvas.canvas||this.canvas,f.jsPDF=f.jsPDF||this,f.fontFaces=f.fontFaces?f.fontFaces.map(Tv):null;var h=new o(f);return f.worker?h:h.from(u).doCallback()}})(sr.API),sr.API.addJS=function(t){return oS=t,this.internal.events.subscribe("postPutResources",function(){_p=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(_p+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),iS=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+oS+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){_p!==void 0&&iS!==void 0&&this.internal.out("/Names <</JavaScript "+_p+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),s=0;s<n.length;s++){var o=n[s],u=a.exec(o);if(u!=null){var f=u[1];r.internal.newObjectDeferredBegin(f,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,m=[];for(s=0;s<h;s++){var v=r.internal.newObject();m.push(v);var y=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+y.objId+" 0 R /XYZ null null null]>> endobj")}var g=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<m.length;s++)r.internal.write("(page_"+(s+1)+")"+m[s]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+g+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,s){var o={title:n,options:s,children:[]};return a==null&&(a=this.root),a.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<a.children.length;s++){var o=a.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(a)),s>0&&this.line("/Prev "+this.makeRef(a.children[s-1])),s<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var u=this.count=this.count_r({count:0},o);if(u>0&&this.line("/Count "+u),o.options&&o.options.pageNumber){var f=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+f.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var h=0;h<a.children.length;h++)this.renderItems(a.children[h])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var s=0;s<n.children.length;s++)a.count++,this.count_r(a,n.children[s]);return a.count}}])})(sr.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,a,n,s,o,u){var f,h=this.decode.DCT_DECODE,m=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,f=(function(v){for(var y,g=256*v.charCodeAt(4)+v.charCodeAt(5),b=v.length,_={width:0,height:0,numcomponents:1},S=4;S<b;S+=2){if(S+=g,e.indexOf(v.charCodeAt(S+1))!==-1){y=256*v.charCodeAt(S+5)+v.charCodeAt(S+6),_={width:256*v.charCodeAt(S+7)+v.charCodeAt(S+8),height:y,numcomponents:v.charCodeAt(S+9)};break}g=256*v.charCodeAt(S+2)+v.charCodeAt(S+3)}return _})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),f.numcomponents){case 1:u=this.color_spaces.DEVICE_GRAY;break;case 4:u=this.color_spaces.DEVICE_CMYK;break;case 3:u=this.color_spaces.DEVICE_RGB}m={data:r,width:f.width,height:f.height,colorSpace:u,bitsPerComponent:8,filter:h,index:a,alias:n}}return m}})(sr.API),sr.API.processPNG=function(t,e,r,a){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var n,s=Yq(t,{checkCrc:!0}),o=s.width,u=s.height,f=s.channels,h=s.palette,m=s.depth;n=h&&f===1?(function(V){for(var F=V.width,X=V.height,P=V.data,O=V.palette,I=V.depth,W=!1,ne=[],Q=[],le=void 0,ee=!1,K=0,ue=0;ue<O.length;ue++){var M=f5(O[ue],4),A=M[0],D=M[1],B=M[2],q=M[3];ne.push(A,D,B),q!=null&&(q===0?(K++,Q.length<1&&Q.push(ue)):q<255&&(ee=!0))}if(ee||K>1){W=!0,Q=void 0;var Z=F*X;le=new Uint8Array(Z);for(var oe=new DataView(P.buffer),pe=0;pe<Z;pe++){var _e=Rv(oe,pe,I),be=f5(O[_e],4)[3];le[pe]=be}}else K===0&&(Q=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:W?8:void 0,colorBytes:P,alphaBytes:le,needSMask:W,palette:ne,mask:Q}})(s):f===2||f===4?(function(V){for(var F=V.data,X=V.width,P=V.height,O=V.channels,I=V.depth,W=O===2?"DeviceGray":"DeviceRGB",ne=O-1,Q=X*P,le=ne,ee=Q*le,K=1*Q,ue=Math.ceil(ee*I/8),M=Math.ceil(K*I/8),A=new Uint8Array(ue),D=new Uint8Array(M),B=new DataView(F.buffer),q=new DataView(A.buffer),Z=new DataView(D.buffer),oe=!1,pe=0;pe<Q;pe++){for(var _e=pe*O,be=0;be<le;be++)gS(q,Rv(B,_e+be,I),pe*le+be,I);var Le=Rv(B,_e+le,I);Le<(1<<I)-1&&(oe=!0),gS(Z,Le,1*pe,I)}return{colorSpace:W,colorsPerPixel:ne,sMaskBitsPerComponent:oe?I:void 0,colorBytes:A,alphaBytes:D,needSMask:oe}})(s):(function(V){var F=V.data,X=V.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:X,colorsPerPixel:X==="DeviceGray"?1:3,colorBytes:F instanceof Uint16Array?(function(P){for(var O=P.length,I=new Uint8Array(2*O),W=new DataView(I.buffer,I.byteOffset,I.byteLength),ne=0;ne<O;ne++)W.setUint16(2*ne,P[ne],!1);return I})(F):F,needSMask:!1}})(s);var v,y,g,b=n,_=b.colorSpace,S=b.colorsPerPixel,E=b.sMaskBitsPerComponent,C=b.colorBytes,j=b.alphaBytes,R=b.needSMask,H=b.palette,Y=b.mask,U=null;return a!==sr.API.image_compression.NONE&&typeof N2=="function"?(U=(function(V){var F;switch(V){case sr.API.image_compression.FAST:F=11;break;case sr.API.image_compression.MEDIUM:F=13;break;case sr.API.image_compression.SLOW:F=14;break;default:F=12}return F})(a),v=this.decode.FLATE_DECODE,y="/Predictor ".concat(U," /Colors ").concat(S," /BitsPerComponent ").concat(m," /Columns ").concat(o),t=fS(C,Math.ceil(o*S*m/8),S,m,a),R&&(g=fS(j,Math.ceil(o*E/8),1,E,a))):(v=void 0,y=void 0,t=C,R&&(g=j)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(g&&this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),{alias:r,data:t,index:e,filter:v,decodeParameters:y,transparency:Y,palette:H,sMask:g,predictor:U,width:o,height:u,bitsPerComponent:m,sMaskBitsPerComponent:E,colorSpace:_}}},(function(t){t.processGIF89A=function(e,r,a,n){var s=new pz(e),o=s.width,u=s.height,f=[];s.decodeAndBlitFrameRGBA(0,f);var h={data:f,width:o,height:u},m=new Dv(100).encode(h,100);return t.processJPEG.call(this,m,r,a,n)},t.processGIF87A=t.processGIF89A})(sr.API),zo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:n,green:a,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},zo.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Oa.log("bit decode error:"+r)}},zo.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var a=this.bottom_up?t:this.height-1-t,n=0;n<e;n++)for(var s=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+8*n*4,u=0;u<8&&8*n+u<this.width;u++){var f=this.palette[s>>7-u&1];this.data[o+4*u]=f.blue,this.data[o+4*u+1]=f.green,this.data[o+4*u+2]=f.red,this.data[o+4*u+3]=255}r!==0&&(this.pos+=4-r)}},zo.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<t;n++){var s=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+2*n*4,u=s>>4,f=15&s,h=this.palette[u];if(this.data[o]=h.blue,this.data[o+1]=h.green,this.data[o+2]=h.red,this.data[o+3]=255,2*n+1>=this.width)break;h=this.palette[f],this.data[o+4]=h.blue,this.data[o+4+1]=h.green,this.data[o+4+2]=h.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},zo.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*a;if(n<this.palette.length){var o=this.palette[n];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},zo.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,u=(s>>5&e)/e*255|0,f=(s>>10&e)/e*255|0,h=s>>15?255:0,m=a*this.width*4+4*n;this.data[m]=f,this.data[m+1]=u,this.data[m+2]=o,this.data[m+3]=h}this.pos+=t}},zo.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var u=(o&e)/e*255|0,f=(o>>5&r)/r*255|0,h=(o>>11)/e*255|0,m=n*this.width*4+4*s;this.data[m]=h,this.data[m+1]=f,this.data[m+2]=u,this.data[m+3]=255}this.pos+=t}},zo.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=s,this.data[o+1]=n,this.data[o+2]=a,this.data[o+3]=255}this.pos+=this.width%4}},zo.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),u=e*this.width*4+4*r;this.data[u]=s,this.data[u+1]=n,this.data[u+2]=a,this.data[u+3]=o}},zo.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,a,n){var s=new zo(e,!1),o=s.width,u=s.height,f={data:s.getData(),width:o,height:u},h=new Dv(100).encode(f,100);return t.processJPEG.call(this,h,r,a,n)}})(sr.API),xS.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,a,n){var s=new xS(e),o=s.width,u=s.height,f={data:s.getData(),width:o,height:u},h=new Dv(100).encode(f,100);return t.processJPEG.call(this,h,r,a,n)}})(sr.API),sr.API.processRGBA=function(t,e,r){for(var a=t.data,n=a.length,s=new Uint8Array(n/4*3),o=new Uint8Array(n/4),u=0,f=0,h=0;h<n;h+=4){var m=a[h],v=a[h+1],y=a[h+2],g=a[h+3];s[u++]=m,s[u++]=v,s[u++]=y,o[f++]=g}var b=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:b,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},sr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Ph=sr.API,bp=Ph.getCharWidthsArray=function(t,e){var r,a,n=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),u=e.widths?e.widths:n.metadata.Unicode.widths,f=u.fof?u.fof:1,h=e.kerning?e.kerning:n.metadata.Unicode.kerning,m=h.fof?h.fof:1,v=e.doKerning!==!1,y=0,g=t.length,b=0,_=u[0]||f,S=[];for(r=0;r<g;r++)a=t.charCodeAt(r),typeof n.metadata.widthOfString=="function"?S.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+o*(1e3/s)||0)/1e3):(y=v&&va(h[a])==="object"&&!isNaN(parseInt(h[a][b],10))?h[a][b]/m:0,S.push((u[a]||_)/f+y)),b=a;return S},lS=Ph.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),a=e.font||this.internal.getFont(),n=e.charSpace||this.internal.getCharSpace();return Ph.processArabic&&(t=Ph.processArabic(t)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(t,r,n)/r:bp.apply(this,arguments).reduce(function(s,o){return s+o},0)},cS=function(t,e,r,a){for(var n=[],s=0,o=t.length,u=0;s!==o&&u+e[s]<r;)u+=e[s],s++;n.push(t.slice(0,s));var f=s;for(u=0;s!==o;)u+e[s]>a&&(n.push(t.slice(f,s)),u=0,f=s),u+=e[s],s++;return f!==s&&n.push(t.slice(f,s)),n},uS=function(t,e,r){r||(r={});var a,n,s,o,u,f,h,m=[],v=[m],y=r.textIndent||0,g=0,b=0,_=t.split(" "),S=bp.apply(this,[" ",r])[0];if(f=r.lineIndent===-1?_[0].length+2:r.lineIndent||0){var E=Array(f).join(" "),C=[];_.map(function(R){(R=R.split(/\s*\n/)).length>1?C=C.concat(R.map(function(H,Y){return(Y&&H.length?`
`:"")+H})):C.push(R[0])}),_=C,f=lS.apply(this,[E,r])}for(s=0,o=_.length;s<o;s++){var j=0;if(a=_[s],f&&a[0]==`
`&&(a=a.substr(1),j=1),y+g+(b=(n=bp.apply(this,[a,r])).reduce(function(R,H){return R+H},0))>e||j){if(b>e){for(u=cS.apply(this,[a,n,e-(y+g),e]),m.push(u.shift()),m=[u.pop()];u.length;)v.push([u.shift()]);b=n.slice(a.length-(m[0]?m[0].length:0)).reduce(function(R,H){return R+H},0)}else m=[a];v.push(m),y=b+f,g=S}else m.push(a),y+=g+b,g=S}return h=f?function(R,H){return(H?E:"")+R.join(" ")}:function(R){return R.join(" ")},v.map(h)},Ph.splitTextToSize=function(t,e,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var v=this.internal.getFont(m.fontName,m.fontStyle),y="Unicode";return v.metadata[y]?{widths:v.metadata[y].widths||{0:1},kerning:v.metadata[y].kerning||{}}:{font:v.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/n;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=r.lineIndent;var u,f,h=[];for(u=0,f=a.length;u<f;u++)h=h.concat(uS.apply(this,[a[u],o,s]));return h},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",a={},n={},s=0;s<16;s++)a[r[s]]=e[s],n[e[s]]=r[s];var o=function(y){return"0x"+parseInt(y,10).toString(16)},u=t.__fontmetrics__.compress=function(y){var g,b,_,S,E=["{"];for(var C in y){if(g=y[C],isNaN(parseInt(C,10))?b="'"+C+"'":(C=parseInt(C,10),b=(b=o(C).slice(2)).slice(0,-1)+n[b.slice(-1)]),typeof g=="number")g<0?(_=o(g).slice(3),S="-"):(_=o(g).slice(2),S=""),_=S+_.slice(0,-1)+n[_.slice(-1)];else{if(va(g)!=="object")throw new Error("Don't know what to do with value type "+va(g)+".");_=u(g)}E.push(b+_)}return E.push("}"),E.join("")},f=t.__fontmetrics__.uncompress=function(y){if(typeof y!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,b,_,S,E={},C=1,j=E,R=[],H="",Y="",U=y.length-1,V=1;V<U;V+=1)(S=y[V])=="'"?g?(_=g.join(""),g=void 0):g=[]:g?g.push(S):S=="{"?(R.push([j,_]),j={},_=void 0):S=="}"?((b=R.pop())[0][b[1]]=j,_=void 0,j=b[0]):S=="-"?C=-1:_===void 0?a.hasOwnProperty(S)?(H+=a[S],_=parseInt(H,16)*C,C=1,H=""):H+=S:a.hasOwnProperty(S)?(Y+=a[S],j[_]=parseInt(Y,16)*C,C=1,_=void 0,Y=""):Y+=S;return E},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:f("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},v={Unicode:{"Courier-Oblique":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":f("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":f("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":f("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:f("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:f("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":f("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:f("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":f("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":f("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":f("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(y){var g=y.font,b=v.Unicode[g.postScriptName];b&&(g.metadata.Unicode={},g.metadata.Unicode.widths=b.widths,g.metadata.Unicode.kerning=b.kerning);var _=m.Unicode[g.postScriptName];_&&(g.metadata.Unicode.encoding=_,g.encoding=_.codePages[0])}])})(sr.API),(function(t){var e=function(r){for(var a=r.length,n=new Uint8Array(a),s=0;s<a;s++)n[s]=r.charCodeAt(s);return n};t.API.events.push(["addFont",function(r){var a=void 0,n=r.font,s=r.instance;if(!n.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=s.existsFileInVFS(n.postScriptName)===!1?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(o,u){u=/^\x00\x01\x00\x00/.test(u)?e(u):e(Ap(u)),o.metadata=t.API.TTFFont.open(u),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(n,a)}}])})(sr),sr.API.addSvgAsImage=function(t,e,r,a,n,s,o,u){if(isNaN(e)||isNaN(r))throw Oa.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(n))throw Oa.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var f=document.createElement("canvas");f.width=a,f.height=n;var h=f.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,f.width,f.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},v=this;return(wr.canvg?Promise.resolve(wr.canvg):hv(()=>import("./index.es-DQWSq6wS.js"),[])).catch(function(y){return Promise.reject(new Error("Could not load canvg: "+y))}).then(function(y){return y.default?y.default:y}).then(function(y){return y.fromString(h,t,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(m)}).then(function(){v.addImage(f.toDataURL("image/jpeg",1),e,r,a,n,o,u)})},sr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(e,r);return this},sr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var a,n,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},u=Object.keys(o),f=[],h=0,m=0,v=0;function y(b,_){var S,E=!1;for(S=0;S<b.length;S+=1)b[S]===_&&(E=!0);return E}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var g=u.length;for(v=0;v<g;v+=1)r[u[v]].value=r[u[v]].defaultValue,r[u[v]].explicitSet=!1}if(va(t)==="object"){for(n in t)if(s=t[n],y(u,n)&&s!==void 0){if(r[n].type==="boolean"&&typeof s=="boolean")r[n].value=s;else if(r[n].type==="name"&&y(r[n].valueSet,s))r[n].value=s;else if(r[n].type==="integer"&&Number.isInteger(s))r[n].value=s;else if(r[n].type==="array"){for(h=0;h<s.length;h+=1)if(a=!0,s[h].length===1&&typeof s[h][0]=="number")f.push(String(s[h]-1));else if(s[h].length>1){for(m=0;m<s[h].length;m+=1)typeof s[h][m]!="number"&&(a=!1);a===!0&&f.push([s[h][0]-1,s[h][1]-1].join(" "))}r[n].value="["+f.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,_=[];for(b in r)r[b].explicitSet===!0&&(r[b].type==="name"?_.push("/"+b+" /"+r[b].value):_.push("/"+b+" "+r[b].value));_.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+_.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(a)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),u=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),f=unescape(encodeURIComponent("</x:xmpmeta>")),h=s.length+o.length+u.length+n.length+f.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(n+s+o+u+f),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(sr.API),(function(t){var e=t.API,r=e.pdfEscape16=function(s,o){for(var u,f=o.metadata.Unicode.widths,h=["","0","00","000","0000"],m=[""],v=0,y=s.length;v<y;++v){if(u=o.metadata.characterToGlyph(s.charCodeAt(v)),o.metadata.glyIdsUsed.push(u),o.metadata.toUnicode[u]=s.charCodeAt(v),f.indexOf(u)==-1&&(f.push(u),f.push([parseInt(o.metadata.widthOfGlyph(u),10)])),u=="0")return m.join("");u=u.toString(16),m.push(h[4-u.length],u)}return m.join("")},a=function(s){var o,u,f,h,m,v,y;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,f=[],v=0,y=(u=Object.keys(s).sort(function(g,b){return g-b})).length;v<y;v++)o=u[v],f.length>=100&&(m+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar`,f=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(h=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),f.push("<"+o+"><"+h+">"));return f.length&&(m+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar
`),m+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var u=o.font,f=o.out,h=o.newObject,m=o.putStream;if(u.metadata instanceof t.API.TTFFont&&u.encoding==="Identity-H"){for(var v=u.metadata.Unicode.widths,y=u.metadata.subset.encode(u.metadata.glyIdsUsed,1),g="",b=0;b<y.length;b++)g+=String.fromCharCode(y[b]);var _=h();m({data:g,addLength1:!0,objectId:_}),f("endobj");var S=h();m({data:a(u.metadata.toUnicode),addLength1:!0,objectId:S}),f("endobj");var E=h();f("<<"),f("/Type /FontDescriptor"),f("/FontName /"+qh(u.fontName)),f("/FontFile2 "+_+" 0 R"),f("/FontBBox "+t.API.PDFObject.convert(u.metadata.bbox)),f("/Flags "+u.metadata.flags),f("/StemV "+u.metadata.stemV),f("/ItalicAngle "+u.metadata.italicAngle),f("/Ascent "+u.metadata.ascender),f("/Descent "+u.metadata.decender),f("/CapHeight "+u.metadata.capHeight),f(">>"),f("endobj");var C=h();f("<<"),f("/Type /Font"),f("/BaseFont /"+qh(u.fontName)),f("/FontDescriptor "+E+" 0 R"),f("/W "+t.API.PDFObject.convert(v)),f("/CIDToGIDMap /Identity"),f("/DW 1000"),f("/Subtype /CIDFontType2"),f("/CIDSystemInfo"),f("<<"),f("/Supplement 0"),f("/Registry (Adobe)"),f("/Ordering ("+u.encoding+")"),f(">>"),f(">>"),f("endobj"),u.objectNumber=h(),f("<<"),f("/Type /Font"),f("/Subtype /Type0"),f("/ToUnicode "+S+" 0 R"),f("/BaseFont /"+qh(u.fontName)),f("/Encoding /"+u.encoding),f("/DescendantFonts ["+C+" 0 R]"),f(">>"),f("endobj"),u.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var u=o.font,f=o.out,h=o.newObject,m=o.putStream;if(u.metadata instanceof t.API.TTFFont&&u.encoding==="WinAnsiEncoding"){for(var v=u.metadata.rawData,y="",g=0;g<v.length;g++)y+=String.fromCharCode(v[g]);var b=h();m({data:y,addLength1:!0,objectId:b}),f("endobj");var _=h();m({data:a(u.metadata.toUnicode),addLength1:!0,objectId:_}),f("endobj");var S=h();f("<<"),f("/Descent "+u.metadata.decender),f("/CapHeight "+u.metadata.capHeight),f("/StemV "+u.metadata.stemV),f("/Type /FontDescriptor"),f("/FontFile2 "+b+" 0 R"),f("/Flags 96"),f("/FontBBox "+t.API.PDFObject.convert(u.metadata.bbox)),f("/FontName /"+qh(u.fontName)),f("/ItalicAngle "+u.metadata.italicAngle),f("/Ascent "+u.metadata.ascender),f(">>"),f("endobj"),u.objectNumber=h();for(var E=0;E<u.metadata.hmtx.widths.length;E++)u.metadata.hmtx.widths[E]=parseInt(u.metadata.hmtx.widths[E]*(1e3/u.metadata.head.unitsPerEm));f("<</Subtype/TrueType/Type/Font/ToUnicode "+_+" 0 R/BaseFont/"+qh(u.fontName)+"/FontDescriptor "+S+" 0 R/Encoding/"+u.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(u.metadata.hmtx.widths)+">>"),f("endobj"),u.isAlreadyPutted=!0}})(s)}]);var n=function(s){var o,u=s.text||"",f=s.x,h=s.y,m=s.options||{},v=s.mutex||{},y=v.pdfEscape,g=v.activeFontKey,b=v.fonts,_=g,S="",E=0,C="",j=b[_].encoding;if(b[_].encoding!=="Identity-H")return{text:u,x:f,y:h,options:m,mutex:v};for(C=u,_=g,Array.isArray(u)&&(C=u[0]),E=0;E<C.length;E+=1)b[_].metadata.hasOwnProperty("cmap")&&(o=b[_].metadata.cmap.unicode.codeMap[C[E].charCodeAt(0)]),o||C[E].charCodeAt(0)<256&&b[_].metadata.hasOwnProperty("Unicode")?S+=C[E]:S+="";var R="";return parseInt(_.slice(1))<14||j==="WinAnsiEncoding"?R=y(S,_).split("").map(function(H){return H.charCodeAt(0).toString(16)}).join(""):j==="Identity-H"&&(R=r(S,b[_])),v.isHex=!0,{text:R,x:f,y:h,options:m,mutex:v}};e.events.push(["postProcessText",function(s){var o=s.text||"",u=[],f={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var h=0;for(h=0;h<o.length;h+=1)Array.isArray(o[h])&&o[h].length===3?u.push([n(Object.assign({},f,{text:o[h][0]})).text,o[h][1],o[h][2]]):u.push(n(Object.assign({},f,{text:o[h]})).text);s.text=u}else s.text=n(Object.assign({},f,{text:o})).text}])})(sr),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,a){return e.call(this),this.internal.vFS[r]=a,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(sr.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(a){var n,s,o,u,f,h,m,v=e,y=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},S=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],E=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),C=!1,j=0;this.__bidiEngine__={};var R=function(P){var O=P.charCodeAt(),I=O>>8,W=_[I];return W!==void 0?v[256*W+(255&O)]:I===252||I===253?"AL":E.test(I)?"L":I===8?"R":"N"},H=function(P){for(var O,I=0;I<P.length;I++){if((O=R(P.charAt(I)))==="L")return!1;if(O==="R")return!0}return!1},Y=function(P,O,I,W){var ne,Q,le,ee,K=O[W];switch(K){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":C=!1;break;case"N":case"AN":break;case"EN":C&&(K="AN");break;case"AL":C=!0,K="R";break;case"WS":case"BN":K="N";break;case"CS":W<1||W+1>=O.length||(ne=I[W-1])!=="EN"&&ne!=="AN"||(Q=O[W+1])!=="EN"&&Q!=="AN"?K="N":C&&(Q="AN"),K=Q===ne?Q:"N";break;case"ES":K=(ne=W>0?I[W-1]:"B")==="EN"&&W+1<O.length&&O[W+1]==="EN"?"EN":"N";break;case"ET":if(W>0&&I[W-1]==="EN"){K="EN";break}if(C){K="N";break}for(le=W+1,ee=O.length;le<ee&&O[le]==="ET";)le++;K=le<ee&&O[le]==="EN"?"EN":"N";break;case"NSM":if(o&&!u){for(ee=O.length,le=W+1;le<ee&&O[le]==="NSM";)le++;if(le<ee){var ue=P[W],M=ue>=1425&&ue<=2303||ue===64286;if(ne=O[le],M&&(ne==="R"||ne==="AL")){K="R";break}}}K=W<1||(ne=O[W-1])==="B"?"N":I[W-1];break;case"B":C=!1,n=!0,K=j;break;case"S":s=!0,K="N"}return K},U=function(P,O,I){var W=P.split("");return I&&V(W,I,{hiLevel:j}),W.reverse(),O&&O.reverse(),W.join("")},V=function(P,O,I){var W,ne,Q,le,ee,K=-1,ue=P.length,M=0,A=[],D=j?g:y,B=[];for(C=!1,n=!1,s=!1,ne=0;ne<ue;ne++)B[ne]=R(P[ne]);for(Q=0;Q<ue;Q++){if(ee=M,A[Q]=Y(P,B,A,Q),W=240&(M=D[ee][b[A[Q]]]),M&=15,O[Q]=le=D[M][5],W>0)if(W===16){for(ne=K;ne<Q;ne++)O[ne]=1;K=-1}else K=-1;if(D[M][6])K===-1&&(K=Q);else if(K>-1){for(ne=K;ne<Q;ne++)O[ne]=le;K=-1}B[Q]==="B"&&(O[Q]=0),I.hiLevel|=le}s&&(function(q,Z,oe){for(var pe=0;pe<oe;pe++)if(q[pe]==="S"){Z[pe]=j;for(var _e=pe-1;_e>=0&&q[_e]==="WS";_e--)Z[_e]=j}})(B,O,ue)},F=function(P,O,I,W,ne){if(!(ne.hiLevel<P)){if(P===1&&j===1&&!n)return O.reverse(),void(I&&I.reverse());for(var Q,le,ee,K,ue=O.length,M=0;M<ue;){if(W[M]>=P){for(ee=M+1;ee<ue&&W[ee]>=P;)ee++;for(K=M,le=ee-1;K<le;K++,le--)Q=O[K],O[K]=O[le],O[le]=Q,I&&(Q=I[K],I[K]=I[le],I[le]=Q);M=ee}M++}}},X=function(P,O,I){var W=P.split(""),ne={hiLevel:j};return I||(I=[]),V(W,I,ne),(function(Q,le,ee){if(ee.hiLevel!==0&&m)for(var K,ue=0;ue<Q.length;ue++)le[ue]===1&&(K=S.indexOf(Q[ue]))>=0&&(Q[ue]=S[K+1])})(W,I,ne),F(2,W,O,I,ne),F(1,W,O,I,ne),W.join("")};return this.__bidiEngine__.doBidiReorder=function(P,O,I){if((function(ne,Q){if(Q)for(var le=0;le<ne.length;le++)Q[le]=le;u===void 0&&(u=H(ne)),h===void 0&&(h=H(ne))})(P,O),o||!f||h)if(o&&f&&u^h)j=u?1:0,P=U(P,O,I);else if(!o&&f&&h)j=u?1:0,P=X(P,O,I),P=U(P,O);else if(!o||u||f||h){if(o&&!f&&u^h)P=U(P,O),u?(j=0,P=X(P,O,I)):(j=1,P=X(P,O,I),P=U(P,O));else if(o&&u&&!f&&h)j=1,P=X(P,O,I),P=U(P,O);else if(!o&&!f&&u^h){var W=m;u?(j=1,P=X(P,O,I),j=0,m=!1,P=X(P,O,I),m=W):(j=0,P=X(P,O,I),P=U(P,O),j=1,m=!1,P=X(P,O,I),m=W,P=U(P,O))}}else j=0,P=X(P,O,I);else j=u?1:0,P=X(P,O,I);return P},this.__bidiEngine__.setOptions=function(P){P&&(o=P.isInputVisual,f=P.isOutputVisual,u=P.isInputRtl,h=P.isOutputRtl,m=P.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(a){var n=a.text;a.x,a.y;var s=a.options||{};a.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(n)==="[object Array]"){var u=0;for(o=[],u=0;u<n.length;u+=1)Object.prototype.toString.call(n[u])==="[object Array]"?o.push([r.doBidiReorder(n[u][0]),n[u][1],n[u][2]]):o.push([r.doBidiReorder(n[u])]);a.text=o}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])})(sr),sr.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new gu(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new Tz(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new gz(this.contents),this.head=new xz(this),this.name=new Sz(this),this.cmap=new $k(this),this.toUnicode={},this.hhea=new yz(this),this.maxp=new Nz(this),this.hmtx=new kz(this),this.post=new bz(this),this.os2=new _z(this),this.loca=new Cz(this),this.glyf=new jz(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,a,n,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,u,f,h;for(h=[],o=0,u=(f=this.bbox).length;o<u;o++)e=f[o],h.push(Math.round(e*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),32768&(r=n>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,a){var n,s,o,u;for(o=0,s=0,u=(e=""+e).length;0<=u?s<u:s>u;s=0<=u?++s:--s)n=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*e},t})();var Zo,gu=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,a;for(a=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},t.prototype.writeString=function(e){var r,a,n;for(n=[],r=0,a=e.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(e.charCodeAt(r)));return n},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,a,n,s,o,u,f;return e=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),s=this.readByte(),o=this.readByte(),u=this.readByte(),f=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^s)+65536*(255^o)+256*(255^u)+(255^f)+1):72057594037927940*e+281474976710656*r+1099511627776*a+4294967296*n+16777216*s+65536*o+256*u+f},t.prototype.writeLongLong=function(e){var r,a;return r=Math.floor(e/4294967296),a=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,a;for(r=[],a=0;0<=e?a<e:a>e;a=0<=e?++a:--a)r.push(this.readByte());return r},t.prototype.write=function(e){var r,a,n,s;for(s=[],a=0,n=e.length;a<n;a++)r=e[a],s.push(this.writeByte(r));return s},t})(),gz=(function(){var t;function e(r){var a,n,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,s=this.tableCount;0<=s?n<s:n>s;n=0<=s?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return e.prototype.encode=function(r){var a,n,s,o,u,f,h,m,v,y,g,b,_;for(_ in g=Object.keys(r).length,f=Math.log(2),v=16*Math.floor(Math.log(g)/f),o=Math.floor(v/f),m=16*g-v,(n=new gu).writeInt(this.scalarType),n.writeShort(g),n.writeShort(v),n.writeShort(o),n.writeShort(m),s=16*g,h=n.pos+s,u=null,b=[],r)for(y=r[_],n.writeString(_),n.writeInt(t(y)),n.writeInt(h),n.writeInt(y.length),b=b.concat(y),_==="head"&&(u=h),h+=y.length;h%4;)b.push(0),h++;return n.write(b),a=2981146554-t(n.data),n.pos=u+8,n.writeUInt32(a),n.data},t=function(r){var a,n,s,o;for(r=Wk.call(r);r.length%4;)r.push(0);for(s=new gu(r),n=0,a=0,o=r.length;a<o;a=a+=4)n+=s.readUInt32();return 4294967295&n},e})(),vz={}.hasOwnProperty,Cl=function(t,e){for(var r in e)vz.call(e,r)&&(t[r]=e[r]);function a(){this.constructor=t}return a.prototype=e.prototype,t.prototype=new a,t.__super__=e.prototype,t};Zo=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var xz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Cl(t,Zo),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new gu).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t})(),yS=(function(){function t(e,r){var a,n,s,o,u,f,h,m,v,y,g,b,_,S,E,C,j;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),v=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(f=0;f<256;++f)this.codeMap[f]=e.readByte();break;case 4:for(g=e.readUInt16(),y=g/2,e.pos+=6,s=(function(){var R,H;for(H=[],f=R=0;0<=y?R<y:R>y;f=0<=y?++R:--R)H.push(e.readUInt16());return H})(),e.pos+=2,_=(function(){var R,H;for(H=[],f=R=0;0<=y?R<y:R>y;f=0<=y?++R:--R)H.push(e.readUInt16());return H})(),h=(function(){var R,H;for(H=[],f=R=0;0<=y?R<y:R>y;f=0<=y?++R:--R)H.push(e.readUInt16());return H})(),m=(function(){var R,H;for(H=[],f=R=0;0<=y?R<y:R>y;f=0<=y?++R:--R)H.push(e.readUInt16());return H})(),n=(this.length-e.pos+this.offset)/2,u=(function(){var R,H;for(H=[],f=R=0;0<=n?R<n:R>n;f=0<=n?++R:--R)H.push(e.readUInt16());return H})(),f=E=0,j=s.length;E<j;f=++E)for(S=s[f],a=C=b=_[f];b<=S?C<=S:C>=S;a=b<=S?++C:--C)m[f]===0?o=a+h[f]:(o=u[m[f]/2+(a-b)-(y-f)]||0)!==0&&(o+=h[f]),this.codeMap[a]=65535&o}e.pos=v}return t.encode=function(e,r){var a,n,s,o,u,f,h,m,v,y,g,b,_,S,E,C,j,R,H,Y,U,V,F,X,P,O,I,W,ne,Q,le,ee,K,ue,M,A,D,B,q,Z,oe,pe,_e,be,Le,he;switch(W=new gu,o=Object.keys(e).sort(function(Ae,de){return Ae-de}),r){case"macroman":for(_=0,S=(function(){var Ae=[];for(b=0;b<256;++b)Ae.push(0);return Ae})(),C={0:0},s={},ne=0,K=o.length;ne<K;ne++)C[_e=e[n=o[ne]]]==null&&(C[_e]=++_),s[n]={old:e[n],new:C[e[n]]},S[n]=C[e[n]];return W.writeUInt16(1),W.writeUInt16(0),W.writeUInt32(12),W.writeUInt16(0),W.writeUInt16(262),W.writeUInt16(0),W.write(S),{charMap:s,subtable:W.data,maxGlyphID:_+1};case"unicode":for(O=[],v=[],j=0,C={},a={},E=h=null,Q=0,ue=o.length;Q<ue;Q++)C[H=e[n=o[Q]]]==null&&(C[H]=++j),a[n]={old:H,new:C[H]},u=C[H]-n,E!=null&&u===h||(E&&v.push(E),O.push(n),h=u),E=n;for(E&&v.push(E),v.push(65535),O.push(65535),X=2*(F=O.length),V=2*Math.pow(Math.log(F)/Math.LN2,2),y=Math.log(V/2)/Math.LN2,U=2*F-V,f=[],Y=[],g=[],b=le=0,M=O.length;le<M;b=++le){if(P=O[b],m=v[b],P===65535){f.push(0),Y.push(0);break}if(P-(I=a[P].new)>=32768)for(f.push(0),Y.push(2*(g.length+F-b)),n=ee=P;P<=m?ee<=m:ee>=m;n=P<=m?++ee:--ee)g.push(a[n].new);else f.push(I-P),Y.push(0)}for(W.writeUInt16(3),W.writeUInt16(1),W.writeUInt32(12),W.writeUInt16(4),W.writeUInt16(16+8*F+2*g.length),W.writeUInt16(0),W.writeUInt16(X),W.writeUInt16(V),W.writeUInt16(y),W.writeUInt16(U),oe=0,A=v.length;oe<A;oe++)n=v[oe],W.writeUInt16(n);for(W.writeUInt16(0),pe=0,D=O.length;pe<D;pe++)n=O[pe],W.writeUInt16(n);for(be=0,B=f.length;be<B;be++)u=f[be],W.writeUInt16(u);for(Le=0,q=Y.length;Le<q;Le++)R=Y[Le],W.writeUInt16(R);for(he=0,Z=g.length;he<Z;he++)_=g[he],W.writeUInt16(_);return{charMap:a,subtable:W.data,maxGlyphID:j+1}}},t})(),$k=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Cl(t,Zo),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,a,n;for(e.pos=this.offset,this.version=e.readUInt16(),n=e.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)r=new yS(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var a,n;return r==null&&(r="macroman"),a=yS.encode(e,r),(n=new gu).writeUInt16(0),n.writeUInt16(1),a.table=n.data.concat(a.subtable),a},t})(),yz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Cl(t,Zo),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),_z=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Cl(t,Zo),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var r,a;for(a=[],r=0;r<10;++r)a.push(e.readByte());return a})(),this.charRange=(function(){var r,a;for(a=[],r=0;r<4;++r)a.push(e.readInt());return a})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var r,a;for(a=[],r=0;r<2;r=++r)a.push(e.readInt());return a})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),bz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Cl(t,Zo),t.prototype.tag="post",t.prototype.parse=function(e){var r,a,n;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(a=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],n=[];e.pos<this.offset+this.length;)r=e.readByte(),n.push(this.names.push(e.readString(r)));return n;case 151552:return a=e.readUInt16(),this.offsets=e.read(a);case 262144:return this.map=(function(){var o,u,f;for(f=[],s=o=0,u=this.file.maxp.numGlyphs;0<=u?o<u:o>u;s=0<=u?++o:--o)f.push(e.readUInt32());return f}).call(this)}},t})(),wz=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Sz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Cl(t,Zo),t.prototype.tag="name",t.prototype.parse=function(e){var r,a,n,s,o,u,f,h,m,v,y;for(e.pos=this.offset,e.readShort(),r=e.readShort(),u=e.readShort(),a=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)a.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+u+e.readShort()});for(f={},s=m=0,v=a.length;m<v;s=++m)n=a[s],e.pos=n.offset,h=e.readString(n.length),o=new wz(h,n),f[y=n.nameID]==null&&(f[y]=[]),f[n.nameID].push(o);this.strings=f,this.copyright=f[0],this.fontFamily=f[1],this.fontSubfamily=f[2],this.uniqueSubfamily=f[3],this.fontName=f[4],this.version=f[5];try{this.postscriptName=f[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=f[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=f[7],this.manufacturer=f[8],this.designer=f[9],this.description=f[10],this.vendorUrl=f[11],this.designerUrl=f[12],this.license=f[13],this.licenseUrl=f[14],this.preferredFamily=f[15],this.preferredSubfamily=f[17],this.compatibleFull=f[18],this.sampleText=f[19]},t})(),Nz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Cl(t,Zo),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),kz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Cl(t,Zo),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,a,n,s,o,u,f;for(e.pos=this.offset,this.metrics=[],r=0,u=this.file.hhea.numberOfMetrics;0<=u?r<u:r>u;r=0<=u?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var h,m;for(m=[],r=h=0;0<=n?h<n:h>n;r=0<=n?++h:--h)m.push(e.readInt16());return m})(),this.widths=(function(){var h,m,v,y;for(y=[],h=0,m=(v=this.metrics).length;h<m;h++)s=v[h],y.push(s.advance);return y}).call(this),a=this.widths[this.widths.length-1],f=[],r=o=0;0<=n?o<n:o>n;r=0<=n?++o:--o)f.push(this.widths.push(a));return f},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),Wk=[].slice,jz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Cl(t,Zo),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,a,n,s,o,u,f,h,m,v;return e in this.cache?this.cache[e]:(s=this.file.loca,r=this.file.contents,a=s.indexOf(e),(n=s.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+a,o=(u=new gu(r.read(n))).readShort(),h=u.readShort(),v=u.readShort(),f=u.readShort(),m=u.readShort(),this.cache[e]=o===-1?new Az(u,h,v,f,m):new Ez(u,o,h,v,f,m),this.cache[e]))},t.prototype.encode=function(e,r,a){var n,s,o,u,f;for(o=[],s=[],u=0,f=r.length;u<f;u++)n=e[r[u]],s.push(o.length),n&&(o=o.concat(n.encode(a)));return s.push(o.length),{table:o,offsets:s}},t})(),Ez=(function(){function t(e,r,a,n,s,o){this.raw=e,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=s,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),Az=(function(){function t(e,r,a,n,s){var o,u;for(this.raw=e,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;u=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&u;)o.pos+=1&u?4:2,128&u?o.pos+=8:64&u?o.pos+=4:8&u&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,a;for(r=new gu(Wk.call(this.raw.data)),e=0,a=this.glyphIDs.length;e<a;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),Cz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Cl(t,Zo),t.prototype.tag="loca",t.prototype.parse=function(e){var r,a;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var n,s;for(s=[],a=0,n=this.length;a<n;a+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var n,s;for(s=[],a=0,n=this.length;a<n;a+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var a=new Uint32Array(this.offsets.length),n=0,s=0,o=0;o<a.length;++o)if(a[o]=n,s<r.length&&r[s]==o){++s,a[o]=n;var u=this.offsets[o],f=this.offsets[o+1]-u;f>0&&(n+=f)}for(var h=new Array(4*a.length),m=0;m<a.length;++m)h[4*m+3]=255&a[m],h[4*m+2]=(65280&a[m])>>8,h[4*m+1]=(16711680&a[m])>>16,h[4*m]=(4278190080&a[m])>>24;return h},t})(),Tz=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,a,n,s;for(r in n=this.font.cmap.tables[0].codeMap,e={},s=this.subset)a=s[r],e[r]=n[a];return e},t.prototype.glyphsFor=function(e){var r,a,n,s,o,u,f;for(n={},o=0,u=e.length;o<u;o++)n[s=e[o]]=this.font.glyf.glyphFor(s);for(s in r=[],n)(a=n[s])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(s in f=this.glyphsFor(r))a=f[s],n[s]=a;return n},t.prototype.encode=function(e,r){var a,n,s,o,u,f,h,m,v,y,g,b,_,S,E;for(n in a=$k.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),g={0:0},E=a.charMap)g[(f=E[n]).old]=f.new;for(b in y=a.maxGlyphID,o)b in g||(g[b]=y++);return m=(function(C){var j,R;for(j in R={},C)R[C[j]]=j;return R})(g),v=Object.keys(m).sort(function(C,j){return C-j}),_=(function(){var C,j,R;for(R=[],C=0,j=v.length;C<j;C++)u=v[C],R.push(m[u]);return R})(),s=this.font.glyf.encode(o,_,g),h=this.font.loca.encode(s.offsets,_),S={cmap:this.font.cmap.raw(),glyf:s.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(S["OS/2"]=this.font.os2.raw()),this.font.directory.encode(S)},t})();sr.API.PDFObject=(function(){var t;function e(){}return t=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},e.convert=function(r){var a,n,s,o;if(Array.isArray(r))return"["+(function(){var u,f,h;for(h=[],u=0,f=r.length;u<f;u++)a=r[u],h.push(e.convert(a));return h})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in s=["<<"],r)o=r[n],s.push("/"+n+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+r},e})();function Vk(t,e,r,a,n){a=a||{};var s=1.15,o=n.internal.scaleFactor,u=n.internal.getFontSize()/o,f=n.getLineHeightFactor?n.getLineHeightFactor():s,h=u*f,m=/\r\n|\r|\n/g,v="",y=1;if((a.valign==="middle"||a.valign==="bottom"||a.halign==="center"||a.halign==="right")&&(v=typeof t=="string"?t.split(m):t,y=v.length||1),r+=u*(2-s),a.valign==="middle"?r-=y/2*h:a.valign==="bottom"&&(r-=y*h),a.halign==="center"||a.halign==="right"){var g=u;if(a.halign==="center"&&(g*=.5),v&&y>=1){for(var b=0;b<v.length;b++)n.text(v[b],e-n.getStringUnitWidth(v[b])*g,r),r+=h;return n}e-=n.getStringUnitWidth(t)*g}return a.halign==="justify"?n.text(t,e,r,{maxWidth:a.maxWidth||100,align:"justify"}):n.text(t,e,r),n}var _S={},ed=(function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:_S=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var a,n,s;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var o=this.jsPDFDocument.internal.getFont(),u=o.fontStyle,f=o.fontName;if(e.font&&(f=e.font),e.fontStyle){u=e.fontStyle;var h=this.getFontList()[f];h&&h.indexOf(u)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(h[0]),u=h[0])}if(this.jsPDFDocument.setFont(f,u),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var m=t.unifyColor(e.fillColor);m&&(a=this.jsPDFDocument).setFillColor.apply(a,m),m=t.unifyColor(e.textColor),m&&(n=this.jsPDFDocument).setTextColor.apply(n,m),m=t.unifyColor(e.lineColor),m&&(s=this.jsPDFDocument).setDrawColor.apply(s,m),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,a){return this.jsPDFDocument.splitTextToSize(e,r,a)},t.prototype.rect=function(e,r,a,n,s){return this.jsPDFDocument.rect(e,r,a,n,s)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return _S||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t})(),R2=function(t,e){return R2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},R2(t,e)};function Gk(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");R2(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Yk=(function(t){Gk(e,t);function e(r){var a=t.call(this)||this;return a._element=r,a}return e})(Array);function Oz(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Rz(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function r1(t,e,r){r.applyStyles(e,!0);var a=Array.isArray(t)?t:[t],n=a.map(function(s){return r.getTextWidth(s)}).reduce(function(s,o){return Math.max(s,o)},0);return n}function Xk(t,e,r,a){var n=e.settings.tableLineWidth,s=e.settings.tableLineColor;t.applyStyles({lineWidth:n,lineColor:s});var o=Kk(n,!1);o&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),a.y-r.y,o)}function Kk(t,e){var r=t>0,a=e||e===0;return r&&a?"DF":r?"S":a?"F":null}function b1(t,e){var r,a,n,s;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(a=t.top)!==null&&a!==void 0?a:e,right:(n=t.right)!==null&&n!==void 0?n:e,bottom:(s=t.bottom)!==null&&s!==void 0?s:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function Jk(t,e){var r=b1(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function Dz(t,e,r,a,n){var s={},o=1.3333333333333333,u=Fv(e,function(j){return n.getComputedStyle(j).backgroundColor});u!=null&&(s.fillColor=u);var f=Fv(e,function(j){return n.getComputedStyle(j).color});f!=null&&(s.textColor=f);var h=Lz(a,r);h&&(s.cellPadding=h);var m="borderTopColor",v=o*r,y=a.borderTopWidth;if(a.borderBottomWidth===y&&a.borderRightWidth===y&&a.borderLeftWidth===y){var g=(parseFloat(y)||0)/v;g&&(s.lineWidth=g)}else s.lineWidth={top:(parseFloat(a.borderTopWidth)||0)/v,right:(parseFloat(a.borderRightWidth)||0)/v,bottom:(parseFloat(a.borderBottomWidth)||0)/v,left:(parseFloat(a.borderLeftWidth)||0)/v},s.lineWidth.top||(s.lineWidth.right?m="borderRightColor":s.lineWidth.bottom?m="borderBottomColor":s.lineWidth.left&&(m="borderLeftColor"));var b=Fv(e,function(j){return n.getComputedStyle(j)[m]});b!=null&&(s.lineColor=b);var _=["left","right","center","justify"];_.indexOf(a.textAlign)!==-1&&(s.halign=a.textAlign),_=["middle","bottom","top"],_.indexOf(a.verticalAlign)!==-1&&(s.valign=a.verticalAlign);var S=parseInt(a.fontSize||"");isNaN(S)||(s.fontSize=S/o);var E=Fz(a);E&&(s.fontStyle=E);var C=(a.fontFamily||"").toLowerCase();return t.indexOf(C)!==-1&&(s.font=C),s}function Fz(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function Fv(t,e){var r=Zk(t,e);if(!r)return null;var a=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!a||!Array.isArray(a))return null;var n=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])],s=parseInt(a[4]);return s===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Zk(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:Zk(t.parentElement,e):r}function Lz(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],a=96/(72/e),n=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,s=r.map(function(u){return parseInt(u||"0")/a}),o=b1(s,0);return n>o.top&&(o.top=n),n>o.bottom&&(o.bottom=n),o}function Qk(t,e,r,a,n){var s,o;a===void 0&&(a=!1),n===void 0&&(n=!1);var u;typeof e=="string"?u=r.document.querySelector(e):u=e;var f=Object.keys(t.getFontList()),h=t.scaleFactor(),m=[],v=[],y=[];if(!u)return console.error("Html table could not be found with input: ",e),{head:m,body:v,foot:y};for(var g=0;g<u.rows.length;g++){var b=u.rows[g],_=(o=(s=b?.parentElement)===null||s===void 0?void 0:s.tagName)===null||o===void 0?void 0:o.toLowerCase(),S=Pz(f,h,r,b,a,n);S&&(_==="thead"?m.push(S):_==="tfoot"?y.push(S):v.push(S))}return{head:m,body:v,foot:y}}function Pz(t,e,r,a,n,s){for(var o=new Yk(a),u=0;u<a.cells.length;u++){var f=a.cells[u],h=r.getComputedStyle(f);if(n||h.display!=="none"){var m=void 0;s&&(m=Dz(t,f,e,h,r)),o.push({rowSpan:f.rowSpan,colSpan:f.colSpan,styles:m,_element:f,content:Mz(f)})}}var v=r.getComputedStyle(a);if(o.length>0&&(n||v.display!=="none"))return o}function Mz(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function Iz(t,e,r){for(var a=0,n=[t,e,r];a<n.length;a++){var s=n[a];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function lc(t,e,r,a,n){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),o=1;o<arguments.length;o++){var u=arguments[o];if(u!=null)for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(s[f]=u[f])}return s}function ej(t,e){var r=new ed(t),a=r.getDocumentOptions(),n=r.getGlobalOptions();Iz(n,a,e);var s=lc({},n,a,e),o;typeof window<"u"&&(o=window);var u=Bz(n,a,e),f=Uz(n,a,e),h=qz(r,s),m=Hz(r,s,o);return{id:e.tableId,content:m,hooks:f,styles:u,settings:h}}function Bz(t,e,r){for(var a={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(f){if(f==="columnStyles"){var h=t[f],m=e[f],v=r[f];a.columnStyles=lc({},h,m,v)}else{var y=[t,e,r],g=y.map(function(b){return b[f]||{}});a[f]=lc({},g[0],g[1],g[2])}},s=0,o=Object.keys(a);s<o.length;s++){var u=o[s];n(u)}return a}function Uz(t,e,r){for(var a=[t,e,r],n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,o=a;s<o.length;s++){var u=o[s];u.didParseCell&&n.didParseCell.push(u.didParseCell),u.willDrawCell&&n.willDrawCell.push(u.willDrawCell),u.didDrawCell&&n.didDrawCell.push(u.didDrawCell),u.willDrawPage&&n.willDrawPage.push(u.willDrawPage),u.didDrawPage&&n.didDrawPage.push(u.didDrawPage)}return n}function qz(t,e){var r,a,n,s,o,u,f,h,m,v,y,g,b=b1(e.margin,40/t.scaleFactor()),_=(r=zz(t,e.startY))!==null&&r!==void 0?r:b.top,S;e.showFoot===!0?S="everyPage":e.showFoot===!1?S="never":S=(a=e.showFoot)!==null&&a!==void 0?a:"everyPage";var E;e.showHead===!0?E="everyPage":e.showHead===!1?E="never":E=(n=e.showHead)!==null&&n!==void 0?n:"everyPage";var C=(s=e.useCss)!==null&&s!==void 0?s:!1,j=e.theme||(C?"plain":"striped"),R=!!e.horizontalPageBreak,H=(o=e.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(u=e.includeHiddenHtml)!==null&&u!==void 0?u:!1,useCss:C,theme:j,startY:_,margin:b,pageBreak:(f=e.pageBreak)!==null&&f!==void 0?f:"auto",rowPageBreak:(h=e.rowPageBreak)!==null&&h!==void 0?h:"auto",tableWidth:(m=e.tableWidth)!==null&&m!==void 0?m:"auto",showHead:E,showFoot:S,tableLineWidth:(v=e.tableLineWidth)!==null&&v!==void 0?v:0,tableLineColor:(y=e.tableLineColor)!==null&&y!==void 0?y:200,horizontalPageBreak:R,horizontalPageBreakRepeat:H,horizontalPageBreakBehaviour:(g=e.horizontalPageBreakBehaviour)!==null&&g!==void 0?g:"afterAllRows"}}function zz(t,e){var r=t.getLastAutoTable(),a=t.scaleFactor(),n=t.pageNumber(),s=!1;if(r&&r.startPageNumber){var o=r.startPageNumber+r.pageNumber-1;s=o===n}return typeof e=="number"?e:(e==null||e===!1)&&s&&r?.finalY!=null?r.finalY+20/a:null}function Hz(t,e,r){var a=e.head||[],n=e.body||[],s=e.foot||[];if(e.html){var o=e.includeHiddenHtml;if(r){var u=Qk(t,e.html,r,o,e.useCss)||{};a=u.head||a,n=u.body||a,s=u.foot||a}else console.error("Cannot parse html in non browser environment")}var f=e.columns||$z(a,n,s);return{columns:f,head:a,body:n,foot:s}}function $z(t,e,r){var a=t[0]||e[0]||r[0]||[],n=[];return Object.keys(a).filter(function(s){return s!=="_element"}).forEach(function(s){var o=1,u;Array.isArray(a)?u=a[parseInt(s)]:u=a[s],typeof u=="object"&&!Array.isArray(u)&&(o=u?.colSpan||1);for(var f=0;f<o;f++){var h=void 0;Array.isArray(a)?h=n.length:h=s+(f>0?"_".concat(f):"");var m={dataKey:h};n.push(m)}}),n}var D2=(function(){function t(e,r,a){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=a,this.doc=e.getDocument()}return t})(),Wz=(function(t){Gk(e,t);function e(r,a,n,s,o,u){var f=t.call(this,r,a,u)||this;return f.cell=n,f.row=s,f.column=o,f.section=s.section,f}return e})(D2),Vz=(function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,a,n,s,o){for(var u=0,f=r;u<f.length;u++){var h=f[u],m=new Wz(e,this,a,n,s,o),v=h(m)===!1;if(a.text=Array.isArray(a.text)?a.text:[a.text],v)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var a=0,n=this.hooks.didDrawPage;a<n.length;a++){var s=n[a];s(new D2(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var a=0,n=this.hooks.willDrawPage;a<n.length;a++){var s=n[a];s(new D2(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(n,s){return n+s.wrappedWidth},0);return r}else{var a=this.settings.margin;return e-a.left-a.right}},t})(),tj=(function(){function t(e,r,a,n,s){s===void 0&&(s=!1),this.height=0,this.raw=e,e instanceof Yk&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=a,this.cells=n,this.spansMultiplePages=s}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(a,n){var s;return Math.max(a,((s=r.cells[n.index])===null||s===void 0?void 0:s.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(a){var n=r.cells[a.index];return n?n.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var a=this;return e.reduce(function(n,s){var o=a.cells[s.index];if(!o)return 0;var u=r.getLineHeight(o.styles.fontSize),f=o.padding("vertical"),h=f+u;return h>n?h:n},0)},t})(),rj=(function(){function t(e,r,a){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=a,this.raw=e;var s=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,s=(n=e.content)!==null&&n!==void 0?n:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var o=s!=null?""+s:"",u=/\r\n|\r|\n/g;this.text=o.split(u)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var a;if(this.styles.halign==="right")a=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var n=this.width-this.padding("horizontal");a=this.x+n/2+this.padding("left")}else a=this.x+this.padding("left");return{x:a,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var a=Array.isArray(this.text)?this.text.length:1,n=this.styles.fontSize/e*r,s=a*n+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=b1(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t})(),Gz=(function(){function t(e,r,a){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=a}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,a=0,n=e.allRows();a<n.length;a++){var s=n[a],o=s.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(r=Math.max(r,o.styles.cellWidth))}return r},t})();function Yz(t,e){Xz(t,e);var r=[],a=0;e.columns.forEach(function(s){var o=s.getMaxCustomCellWidth(e);o?s.width=o:(s.width=s.wrappedWidth,r.push(s)),a+=s.width});var n=e.getWidth(t.pageSize().width)-a;n&&(n=F2(r,n,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),n&&(n=F2(r,n,function(s){return s.minWidth})),n=Math.abs(n),!e.settings.horizontalPageBreak&&n>.1/t.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),Jz(e),Zz(e,t),Kz(e)}function Xz(t,e){var r=t.scaleFactor(),a=e.settings.horizontalPageBreak,n=Jk(t,e);e.allRows().forEach(function(s){for(var o=0,u=e.columns;o<u.length;o++){var f=u[o],h=s.cells[f.index];if(h){var m=e.hooks.didParseCell;e.callCellHooks(t,m,h,s,f,null);var v=h.padding("horizontal");h.contentWidth=r1(h.text,h.styles,t)+v;var y=r1(h.text.join(" ").split(/[^\S\u00A0]+/),h.styles,t);if(h.minReadableWidth=y+h.padding("horizontal"),typeof h.styles.cellWidth=="number")h.minWidth=h.styles.cellWidth,h.wrappedWidth=h.styles.cellWidth;else if(h.styles.cellWidth==="wrap"||a===!0)h.contentWidth>n?(h.minWidth=n,h.wrappedWidth=n):(h.minWidth=h.contentWidth,h.wrappedWidth=h.contentWidth);else{var g=10/r;h.minWidth=h.styles.minCellWidth||g,h.wrappedWidth=h.contentWidth,h.minWidth>h.wrappedWidth&&(h.wrappedWidth=h.minWidth)}}}}),e.allRows().forEach(function(s){for(var o=0,u=e.columns;o<u.length;o++){var f=u[o],h=s.cells[f.index];if(h&&h.colSpan===1)f.wrappedWidth=Math.max(f.wrappedWidth,h.wrappedWidth),f.minWidth=Math.max(f.minWidth,h.minWidth),f.minReadableWidth=Math.max(f.minReadableWidth,h.minReadableWidth);else{var m=e.styles.columnStyles[f.dataKey]||e.styles.columnStyles[f.index]||{},v=m.cellWidth||m.minCellWidth;v&&typeof v=="number"&&(f.minWidth=v,f.wrappedWidth=v)}h&&(h.colSpan>1&&!f.minWidth&&(f.minWidth=h.minWidth),h.colSpan>1&&!f.wrappedWidth&&(f.wrappedWidth=h.minWidth))}})}function F2(t,e,r){for(var a=e,n=t.reduce(function(g,b){return g+b.wrappedWidth},0),s=0;s<t.length;s++){var o=t[s],u=o.wrappedWidth/n,f=a*u,h=o.width+f,m=r(o),v=h<m?m:h;e-=v-o.width,o.width=v}if(e=Math.round(e*1e10)/1e10,e){var y=t.filter(function(g){return e<0?g.width>r(g):!0});y.length&&(e=F2(y,e,r))}return e}function Kz(t){for(var e={},r=1,a=t.allRows(),n=0;n<a.length;n++)for(var s=a[n],o=0,u=t.columns;o<u.length;o++){var f=u[o],h=e[f.index];if(r>1)r--,delete s.cells[f.index];else if(h)h.cell.height+=s.height,r=h.cell.colSpan,delete s.cells[f.index],h.left--,h.left<=1&&delete e[f.index];else{var m=s.cells[f.index];if(!m)continue;if(m.height=s.height,m.rowSpan>1){var v=a.length-n,y=m.rowSpan>v?v:m.rowSpan;e[f.index]={cell:m,left:y,row:s}}}}}function Jz(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var a=e[r],n=null,s=0,o=0,u=0;u<t.columns.length;u++){var f=t.columns[u];if(o-=1,o>1&&t.columns[u+1])s+=f.width,delete a.cells[f.index];else if(n){var h=n;delete a.cells[f.index],n=null,h.width=f.width+s}else{var h=a.cells[f.index];if(!h)continue;if(o=h.colSpan,s=0,h.colSpan>1){n=h,s+=f.width;continue}h.width=f.width+s}}}function Zz(t,e){for(var r={count:0,height:0},a=0,n=t.allRows();a<n.length;a++){for(var s=n[a],o=0,u=t.columns;o<u.length;o++){var f=u[o],h=s.cells[f.index];if(h){e.applyStyles(h.styles,!0);var m=h.width-h.padding("horizontal");if(h.styles.overflow==="linebreak")h.text=e.splitTextToSize(h.text,m+1/e.scaleFactor(),{fontSize:h.styles.fontSize});else if(h.styles.overflow==="ellipsize")h.text=bS(h.text,m,h.styles,e,"...");else if(h.styles.overflow==="hidden")h.text=bS(h.text,m,h.styles,e,"");else if(typeof h.styles.overflow=="function"){var v=h.styles.overflow(h.text,m);typeof v=="string"?h.text=[v]:h.text=v}h.contentHeight=h.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var y=h.contentHeight/h.rowSpan;h.rowSpan>1&&r.count*r.height<y*h.rowSpan?r={height:y,count:h.rowSpan}:r&&r.count>0&&r.height>y&&(y=r.height),y>s.height&&(s.height=y)}}r.count--}}function bS(t,e,r,a,n){return t.map(function(s){return Qz(s,e,r,a,n)})}function Qz(t,e,r,a,n){var s=1e4*a.scaleFactor();if(e=Math.ceil(e*s)/s,e>=r1(t,r,a))return t;for(;e<r1(t+n,r,a)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+n}function aj(t,e){var r=new ed(t),a=eH(e,r.scaleFactor()),n=new Vz(e,a);return Yz(r,n),r.applyStyles(r.userStyles),n}function eH(t,e){var r=t.content,a=rH(r.columns);if(r.head.length===0){var n=wS(a,"head");n&&r.head.push(n)}if(r.foot.length===0){var n=wS(a,"foot");n&&r.foot.push(n)}var s=t.settings.theme,o=t.styles;return{columns:a,head:Lv("head",r.head,a,o,s,e),body:Lv("body",r.body,a,o,s,e),foot:Lv("foot",r.foot,a,o,s,e)}}function Lv(t,e,r,a,n,s){var o={},u=e.map(function(f,h){for(var m=0,v={},y=0,g=0,b=0,_=r;b<_.length;b++){var S=_[b];if(o[S.index]==null||o[S.index].left===0)if(g===0){var E=void 0;Array.isArray(f)?E=f[S.index-y-m]:E=f[S.dataKey];var C={};typeof E=="object"&&!Array.isArray(E)&&(C=E?.styles||{});var j=aH(t,S,h,n,a,s,C),R=new rj(E,j,t);v[S.dataKey]=R,v[S.index]=R,g=R.colSpan-1,o[S.index]={left:R.rowSpan-1,times:g}}else g--,y++;else o[S.index].left--,g=o[S.index].times,m++}return new tj(f,h,t,v)});return u}function wS(t,e){var r={};return t.forEach(function(a){if(a.raw!=null){var n=tH(e,a.raw);n!=null&&(r[a.dataKey]=n)}}),Object.keys(r).length>0?r:null}function tH(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function rH(t){return t.map(function(e,r){var a,n;return typeof e=="object"?n=(a=e.dataKey)!==null&&a!==void 0?a:r:n=r,new Gz(n,e,r)})}function aH(t,e,r,a,n,s,o){var u=Rz(a),f;t==="head"?f=n.headStyles:t==="body"?f=n.bodyStyles:t==="foot"&&(f=n.footStyles);var h=lc({},u.table,u[t],n.styles,f),m=n.columnStyles[e.dataKey]||n.columnStyles[e.index]||{},v=t==="body"?m:{},y=t==="body"&&r%2===0?lc({},u.alternateRow,n.alternateRowStyles):{},g=Oz(s),b=lc({},g,h,y,v);return lc(b,o)}function nH(t,e,r){var a;r===void 0&&(r={});var n=Jk(t,e),s=new Map,o=[],u=[],f=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?f=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(f=[e.settings.horizontalPageBreakRepeat]),f.forEach(function(y){var g=e.columns.find(function(b){return b.dataKey===y||b.index===y});g&&!s.has(g.index)&&(s.set(g.index,!0),o.push(g.index),u.push(e.columns[g.index]),n-=g.wrappedWidth)});for(var h=!0,m=(a=r?.start)!==null&&a!==void 0?a:0;m<e.columns.length;){if(s.has(m)){m++;continue}var v=e.columns[m].wrappedWidth;if(h||n>=v)h=!1,o.push(m),u.push(e.columns[m]),n-=v;else break;m++}return{colIndexes:o,columns:u,lastIndex:m-1}}function sH(t,e){for(var r=[],a=0;a<e.columns.length;a++){var n=nH(t,e,{start:a});n.columns.length&&(r.push(n),a=n.lastIndex)}return r}function nj(t,e){var r=e.settings,a=r.startY,n=r.margin,s={x:n.left,y:a},o=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),u=a+n.bottom+o;if(r.pageBreak==="avoid"){var f=e.body,h=f.reduce(function(y,g){return y+g.height},0);u+=h}var m=new ed(t);(r.pageBreak==="always"||r.startY!=null&&u>m.pageSize().height)&&(ij(m),s.y=n.top),e.callWillDrawPageHooks(m,s);var v=lc({},s);e.startPageNumber=m.pageNumber(),r.horizontalPageBreak?iH(m,e,v,s):(m.applyStyles(m.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(y){return mc(m,e,y,s,e.columns)}),m.applyStyles(m.userStyles),e.body.forEach(function(y,g){var b=g===e.body.length-1;a1(m,e,y,b,v,s,e.columns)}),m.applyStyles(m.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(y){return mc(m,e,y,s,e.columns)})),Xk(m,e,v,s),e.callEndPageHooks(m,s),e.finalY=s.y,t.lastAutoTable=e,m.applyStyles(m.userStyles)}function iH(t,e,r,a){var n=sH(t,e),s=e.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")n.forEach(function(h,m){t.applyStyles(t.userStyles),m>0?x0(t,e,r,a,h.columns,!0):SS(t,e,a,h.columns),oH(t,e,r,a,h.columns),Pv(t,e,a,h.columns)});else for(var o=-1,u=n[0],f=function(){var h=o;if(u){t.applyStyles(t.userStyles);var m=u.columns;o>=0?x0(t,e,r,a,m,!0):SS(t,e,a,m),h=NS(t,e,o+1,a,m),Pv(t,e,a,m)}var v=h-o;n.slice(1).forEach(function(y){t.applyStyles(t.userStyles),x0(t,e,r,a,y.columns,!0),NS(t,e,o+1,a,y.columns,v),Pv(t,e,a,y.columns)}),o=h};o<e.body.length-1;)f()}function SS(t,e,r,a){var n=e.settings;t.applyStyles(t.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&e.head.forEach(function(s){return mc(t,e,s,r,a)})}function oH(t,e,r,a,n){t.applyStyles(t.userStyles),e.body.forEach(function(s,o){var u=o===e.body.length-1;a1(t,e,s,u,r,a,n)})}function NS(t,e,r,a,n,s){t.applyStyles(t.userStyles),s=s??e.body.length;var o=Math.min(r+s,e.body.length),u=-1;return e.body.slice(r,o).forEach(function(f,h){var m=r+h===e.body.length-1,v=sj(t,e,m,a);f.canEntireRowFit(v,n)&&(mc(t,e,f,a,n),u=r+h)}),u}function Pv(t,e,r,a){var n=e.settings;t.applyStyles(t.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&e.foot.forEach(function(s){return mc(t,e,s,r,a)})}function lH(t,e,r){var a=r.getLineHeight(t.styles.fontSize),n=t.padding("vertical"),s=Math.floor((e-n)/a);return Math.max(0,s)}function cH(t,e,r,a){var n={};t.spansMultiplePages=!0,t.height=0;for(var s=0,o=0,u=r.columns;o<u.length;o++){var f=u[o],h=t.cells[f.index];if(h){Array.isArray(h.text)||(h.text=[h.text]);var m=new rj(h.raw,h.styles,h.section);m=lc(m,h),m.text=[];var v=lH(h,e,a);h.text.length>v&&(m.text=h.text.splice(v,h.text.length));var y=a.scaleFactor(),g=a.getLineHeightFactor();h.contentHeight=h.getContentHeight(y,g),h.contentHeight>=e&&(h.contentHeight=e,m.styles.minCellHeight-=e),h.contentHeight>t.height&&(t.height=h.contentHeight),m.contentHeight=m.getContentHeight(y,g),m.contentHeight>s&&(s=m.contentHeight),n[f.index]=m}}var b=new tj(t.raw,-1,t.section,n,!0);b.height=s;for(var _=0,S=r.columns;_<S.length;_++){var f=S[_],m=b.cells[f.index];m&&(m.height=b.height);var h=t.cells[f.index];h&&(h.height=t.height)}return b}function uH(t,e,r,a){var n=t.pageSize().height,s=a.settings.margin,o=s.top+s.bottom,u=n-o;e.section==="body"&&(u-=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns));var f=e.getMinimumRowHeight(a.columns,t),h=f<r;if(f>u)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!h)return!1;var m=e.hasRowSpan(a.columns),v=e.getMaxCellHeight(a.columns)>u;return v?(m&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(m||a.settings.rowPageBreak==="avoid")}function a1(t,e,r,a,n,s,o){var u=sj(t,e,a,s);if(r.canEntireRowFit(u,o))mc(t,e,r,s,o);else if(uH(t,r,u,e)){var f=cH(r,u,e,t);mc(t,e,r,s,o),x0(t,e,n,s,o),a1(t,e,f,a,n,s,o)}else x0(t,e,n,s,o),a1(t,e,r,a,n,s,o)}function mc(t,e,r,a,n){a.x=e.settings.margin.left;for(var s=0,o=n;s<o.length;s++){var u=o[s],f=r.cells[u.index];if(!f){a.x+=u.width;continue}t.applyStyles(f.styles),f.x=a.x,f.y=a.y;var h=e.callCellHooks(t,e.hooks.willDrawCell,f,r,u,a);if(h===!1){a.x+=u.width;continue}fH(t,f,a);var m=f.getTextPos();Vk(f.text,m.x,m.y,{halign:f.styles.halign,valign:f.styles.valign,maxWidth:Math.ceil(f.width-f.padding("left")-f.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,f,r,u,a),a.x+=u.width}a.y+=r.height}function fH(t,e,r){var a=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof a.lineWidth=="number"){var n=Kk(a.lineWidth,a.fillColor);n&&t.rect(e.x,r.y,e.width,e.height,n)}else typeof a.lineWidth=="object"&&(a.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),hH(t,e,r,a.lineWidth))}function hH(t,e,r,a){var n,s,o,u;a.top&&(n=r.x,s=r.y,o=r.x+e.width,u=r.y,a.right&&(o+=.5*a.right),a.left&&(n-=.5*a.left),f(a.top,n,s,o,u)),a.bottom&&(n=r.x,s=r.y+e.height,o=r.x+e.width,u=r.y+e.height,a.right&&(o+=.5*a.right),a.left&&(n-=.5*a.left),f(a.bottom,n,s,o,u)),a.left&&(n=r.x,s=r.y,o=r.x,u=r.y+e.height,a.top&&(s-=.5*a.top),a.bottom&&(u+=.5*a.bottom),f(a.left,n,s,o,u)),a.right&&(n=r.x+e.width,s=r.y,o=r.x+e.width,u=r.y+e.height,a.top&&(s-=.5*a.top),a.bottom&&(u+=.5*a.bottom),f(a.right,n,s,o,u));function f(h,m,v,y,g){t.getDocument().setLineWidth(h),t.getDocument().line(m,v,y,g,"S")}}function sj(t,e,r,a){var n=e.settings.margin.bottom,s=e.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(n+=e.getFootHeight(e.columns)),t.pageSize().height-a.y-n}function x0(t,e,r,a,n,s){n===void 0&&(n=[]),s===void 0&&(s=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!s&&e.foot.forEach(function(u){return mc(t,e,u,a,n)}),e.callEndPageHooks(t,a);var o=e.settings.margin;Xk(t,e,r,a),ij(t),e.pageNumber++,a.x=o.left,a.y=o.top,r.y=o.top,e.callWillDrawPageHooks(t,a),e.settings.showHead==="everyPage"&&(e.head.forEach(function(u){return mc(t,e,u,a,n)}),t.applyStyles(t.userStyles))}function ij(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function dH(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var a=e[0],n=ej(this,a),s=aj(this,n);return nj(this,s),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,a,n){Vk(e,r,a,n,this)},t.API.autoTableSetDefaults=function(e){return ed.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){ed.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var a;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=new ed(this),s=Qk(n,e,window,r,!1),o=s.head,u=s.body,f=((a=o[0])===null||a===void 0?void 0:a.map(function(h){return h.content}))||[];return{columns:f,rows:u,data:u}}}var Mv;function $h(t,e){var r=ej(t,e),a=aj(t,r);nj(t,a)}try{if(typeof window<"u"&&window){var kS=window,jS=kS.jsPDF||((Mv=kS.jspdf)===null||Mv===void 0?void 0:Mv.jsPDF);jS&&dH(jS)}}catch(t){console.error("Could not apply autoTable plugin",t)}const ES=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},mH=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});function pH({project:t,company:e,onShowToast:r}){const{branding:a}=od(),[n,s]=se.useState([]),[o,u]=se.useState(!0),[f,h]=se.useState("all"),[m,v]=se.useState(null),[y,g]=se.useState(new Set),[b,_]=se.useState("recent"),[S,E]=se.useState(new Set),[C,j]=se.useState({start:"",end:""}),[R,H]=se.useState(!1),[Y,U]=se.useState(null),[V,F]=se.useState("");se.useEffect(()=>{X()},[t.id]);const X=async()=>{try{const Ae=await ut.getTMTickets(t.id);s(Ae)}catch(Ae){console.error("Error loading tickets:",Ae),r("Error loading T&M tickets","error")}finally{u(!1)}},P=async(Ae,de)=>{try{await ut.updateTMTicketStatus(Ae,de),s(n.map(re=>re.id===Ae?{...re,status:de}:re)),r(`Ticket ${de}`,"success")}catch(re){console.error("Error updating status:",re),r("Error updating status","error")}},O=Ae=>{Ae.ce_pco_number?(U(Ae),F(""),H(!0)):P(Ae.id,"approved")},I=async()=>{if(Y)try{const Ae=parseFloat(V)||0;await ut.approveTMTicket(Y.id,null,null,Ae),s(n.map(de=>de.id===Y.id?{...de,status:"approved",change_order_value:Ae}:de)),r(`Ticket approved with $${Ae.toLocaleString()} change order`,"success"),H(!1),U(null),F("")}catch(Ae){console.error("Error approving ticket:",Ae),r("Error approving ticket","error")}},W=async Ae=>{if(confirm("Delete this T&M ticket?"))try{await ut.deleteTMTicket(Ae),s(n.filter(de=>de.id!==Ae)),r("Ticket deleted","success")}catch(de){console.error("Error deleting ticket:",de),r("Error deleting ticket","error")}},ne=Ae=>{let de=0;return Ae.t_and_m_items&&Ae.t_and_m_items.forEach(re=>{re.materials_equipment?.cost_per_unit&&(de+=re.quantity*re.materials_equipment.cost_per_unit)}),de},Q=Ae=>Ae.t_and_m_workers?Ae.t_and_m_workers.reduce((de,re)=>{const Ke=parseFloat(re.hours)||0,Oe=parseFloat(re.overtime_hours)||0;return de+Ke+Oe},0):0,le=Ae=>new Date(Ae).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),ee=(Ae,de)=>{de.stopPropagation(),g(re=>{const Ke=new Set(re);return Ke.has(Ae)?Ke.delete(Ae):Ke.add(Ae),Ke})},K=()=>{const Ae=f==="all"?n:n.filter(re=>re.status===f),de=Ae.every(re=>y.has(re.id));g(de?new Set:new Set(Ae.map(re=>re.id)))},ue=()=>{g(new Set)},M=()=>{const Ae=f==="all"?n:n.filter(de=>de.status===f);return y.size>0?Ae.filter(de=>y.has(de.id)):Ae},A=()=>{const Ae=M();if(Ae.length===0){r("No tickets to export","error");return}const de=[],re=[],Ke=[];Ae.forEach(Et=>{const kt=le(Et.work_date),zt=Et.status;Et.t_and_m_workers&&Et.t_and_m_workers.forEach(Tt=>{const at=parseFloat(Tt.hours)||0,pt=parseFloat(Tt.overtime_hours)||0;de.push({Date:kt,Status:zt,"Worker Name":Tt.name,Role:Tt.role||"Laborer","Regular Hours":at,"OT Hours":pt,"Total Hours":at+pt})}),Et.t_and_m_items&&Et.t_and_m_items.forEach(Tt=>{const at=Tt.custom_name||Tt.materials_equipment?.name||"Unknown",pt=Tt.custom_category||Tt.materials_equipment?.category||"Unknown",At=Tt.materials_equipment?.unit||"each",Dt=Tt.materials_equipment?.cost_per_unit||0,xt=Tt.quantity*Dt;re.push({Date:kt,Status:zt,Category:pt,Item:at,Quantity:Tt.quantity,Unit:At,"Cost/Unit":Dt,Total:xt})}),Ke.push({Date:kt,Status:zt,Workers:Et.t_and_m_workers?.length||0,"Total Hours":Q(Et),Items:Et.t_and_m_items?.length||0,"Materials Cost":ne(Et),Notes:Et.notes||""})});const Oe=au.book_new(),rt=au.json_to_sheet(Ke);if(au.book_append_sheet(Oe,rt,"Summary"),de.length>0){const Et=au.json_to_sheet(de);au.book_append_sheet(Oe,Et,"Workers")}if(re.length>0){const Et=au.json_to_sheet(re);au.book_append_sheet(Oe,Et,"Materials & Equipment")}const tt=`${t.name}_TM_${new Date().toISOString().split("T")[0]}.xlsx`;TB(Oe,tt),r("Export downloaded!","success")},D=async()=>{const Ae=M();if(Ae.length===0){r("No tickets to export","error");return}r("Generating PDF...","info");const de=new sr,re=de.internal.pageSize.getWidth(),Ke=de.internal.pageSize.getHeight(),Oe=20;let rt=Oe;const tt=ES(a?.primary_color||"#3B82F6"),Et=ES(a?.secondary_color||"#1E40AF");de.setFillColor(...tt),de.rect(0,0,re,45,"F"),de.setFillColor(...Et),de.rect(0,42,re,3,"F");let kt=Oe;if(a?.logo_url)try{const _t=await mH(a.logo_url);_t&&(de.addImage(_t,"PNG",Oe,7,30,30),kt=Oe+30+10)}catch(_t){console.error("Error adding logo:",_t)}de.setTextColor(255,255,255),de.setFontSize(22),de.setFont("helvetica","bold"),de.text(e?.name||"Company Name",kt,20),de.setFontSize(10),de.setFont("helvetica","normal"),de.text("TIME & MATERIALS REPORT",kt,30),de.setFontSize(9),de.text(`Report Date: ${new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}`,re-Oe,18,{align:"right"}),t.job_number&&de.text(`Job #: ${t.job_number}`,re-Oe,26,{align:"right"}),de.text(`Status: ${f.charAt(0).toUpperCase()+f.slice(1)}`,re-Oe,34,{align:"right"}),rt=55,de.setFillColor(248,250,252),de.rect(Oe,rt-5,re-Oe*2,30,"F"),de.setDrawColor(...tt),de.setLineWidth(.5),de.rect(Oe,rt-5,re-Oe*2,30,"S"),de.setTextColor(...tt),de.setFontSize(14),de.setFont("helvetica","bold"),de.text(`Project: ${t.name}`,Oe+5,rt+7),de.setFontSize(10),de.setFont("helvetica","normal"),de.setTextColor(51,65,85);const zt=Ae.map(_t=>new Date(_t.work_date)).sort((_t,mr)=>_t-mr),Tt=zt[0]?.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),at=zt[zt.length-1]?.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});de.text(`Date Range: ${Tt} - ${at}`,Oe+5,rt+17),de.text(`Total Tickets: ${Ae.length}`,re-Oe-5,rt+7,{align:"right"}),rt+=40;const pt=Ae.reduce((_t,mr)=>_t+Q(mr),0),At=Ae.reduce((_t,mr)=>_t+ne(mr),0),Dt=new Set(Ae.flatMap(_t=>_t.t_and_m_workers?.map(mr=>mr.name)||[])).size;de.setTextColor(...tt),de.setFontSize(12),de.setFont("helvetica","bold"),de.text("SUMMARY",Oe,rt),rt+=8;const xt=(re-Oe*2-20)/3,St=[{label:"Total Labor Hours",value:pt.toFixed(1)},{label:"Unique Workers",value:Dt.toString()},{label:"Materials Cost",value:`$${At.toFixed(2)}`}],ft=tt.map(_t=>Math.min(255,_t+180));St.forEach((_t,mr)=>{const Jr=Oe+mr*(xt+10);de.setFillColor(...ft),de.rect(Jr,rt,xt,25,"F"),de.setDrawColor(...tt),de.setLineWidth(.5),de.rect(Jr,rt,xt,25,"S"),de.setTextColor(...tt),de.setFontSize(16),de.setFont("helvetica","bold"),de.text(_t.value,Jr+xt/2,rt+12,{align:"center"}),de.setTextColor(100,116,139),de.setFontSize(8),de.setFont("helvetica","normal"),de.text(_t.label,Jr+xt/2,rt+20,{align:"center"})}),rt+=35;const yt=[],er=[],Lt=[];let Bt=0,we=0,Ie=0,ve=0,Ue=0,Be=0;Ae.forEach(_t=>{_t.t_and_m_workers&&_t.t_and_m_workers.forEach(mr=>{const Jr=parseFloat(mr.hours)||0,qr=parseFloat(mr.overtime_hours)||0,Xa=mr.role||"Laborer",$r=[le(_t.work_date),mr.name,Jr.toString(),qr>0?qr.toString():"-",(Jr+qr).toString()];Xa==="Foreman"||Xa==="Superintendent"?(yt.push($r),Bt+=Jr,we+=qr):Xa==="Operator"?(er.push($r),Ie+=Jr,ve+=qr):(Lt.push($r),Ue+=Jr,Be+=qr)})});const Rt=(_t,mr,Jr,qr)=>{mr.length!==0&&(rt>Ke-80&&(de.addPage(),rt=Oe),de.setTextColor(...tt),de.setFontSize(11),de.setFont("helvetica","bold"),de.text(_t,Oe,rt),rt+=5,$h(de,{startY:rt,head:[["Date","Name","Reg Hrs","OT Hrs","Total"]],body:mr,margin:{left:Oe,right:Oe},headStyles:{fillColor:tt,textColor:[255,255,255],fontStyle:"bold",fontSize:9},bodyStyles:{fontSize:9,textColor:[51,65,85]},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{0:{cellWidth:30},2:{halign:"center",cellWidth:22},3:{halign:"center",cellWidth:22},4:{halign:"center",cellWidth:22}},foot:[["","SUBTOTAL:",Jr.toString(),qr>0?qr.toString():"-",(Jr+qr).toString()]],footStyles:{fillColor:Et,textColor:[255,255,255],fontStyle:"bold",fontSize:9}}),rt=de.lastAutoTable.finalY+10)};if(yt.length>0||er.length>0||Lt.length>0){de.setTextColor(...tt),de.setFontSize(12),de.setFont("helvetica","bold"),de.text("LABOR",Oe,rt),rt+=8,Rt("SUPERVISION",yt,Bt,we),Rt("OPERATORS",er,Ie,ve),Rt("LABORERS",Lt,Ue,Be);const _t=Bt+Ie+Ue,mr=we+ve+Be;de.setFillColor(...tt),de.rect(Oe,rt,re-Oe*2,12,"F"),de.setTextColor(255,255,255),de.setFontSize(10),de.setFont("helvetica","bold"),de.text("LABOR TOTAL:",Oe+5,rt+8),de.text(`${_t} Reg + ${mr} OT = ${_t+mr} Hours`,re-Oe-5,rt+8,{align:"right"}),rt+=20}rt>Ke-100&&(de.addPage(),rt=Oe);const Ht={},Kt={},$t=["Containment","PPE","Disposal","Equipment","Other"];Ae.forEach(_t=>{_t.t_and_m_items&&_t.t_and_m_items.forEach(mr=>{const Jr=mr.custom_name||mr.materials_equipment?.name||"Unknown",qr=mr.custom_category||mr.materials_equipment?.category||"Other",Xa=mr.materials_equipment?.unit||"each",$r=mr.materials_equipment?.cost_per_unit||0,Ea=mr.quantity*$r;Ht[qr]||(Ht[qr]=[],Kt[qr]=0),Ht[qr].push([le(_t.work_date),Jr,mr.quantity.toString(),Xa,`$${$r.toFixed(2)}`,`$${Ea.toFixed(2)}`]),Kt[qr]+=Ea})});const Nr=(_t,mr,Jr)=>{!mr||mr.length===0||(rt>Ke-80&&(de.addPage(),rt=Oe),de.setTextColor(...tt),de.setFontSize(11),de.setFont("helvetica","bold"),de.text(_t.toUpperCase(),Oe,rt),rt+=5,$h(de,{startY:rt,head:[["Date","Item","Qty","Unit","Rate","Total"]],body:mr,margin:{left:Oe,right:Oe},headStyles:{fillColor:tt,textColor:[255,255,255],fontStyle:"bold",fontSize:9},bodyStyles:{fontSize:9,textColor:[51,65,85]},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{2:{halign:"center",cellWidth:20},3:{halign:"center",cellWidth:25},4:{halign:"right",cellWidth:25},5:{halign:"right",cellWidth:30}},foot:[["","","","","Subtotal:",`$${Jr.toFixed(2)}`]],footStyles:{fillColor:Et,textColor:[255,255,255],fontStyle:"bold",fontSize:9}}),rt=de.lastAutoTable.finalY+10)};Object.keys(Ht).length>0&&(de.setTextColor(...tt),de.setFontSize(12),de.setFont("helvetica","bold"),de.text("MATERIALS & EQUIPMENT",Oe,rt),rt+=8,$t.forEach(_t=>{Ht[_t]&&Nr(_t,Ht[_t],Kt[_t])}),Object.keys(Ht).forEach(_t=>{$t.includes(_t)||Nr(_t,Ht[_t],Kt[_t])}),de.setFillColor(...tt),de.rect(Oe,rt,re-Oe*2,12,"F"),de.setTextColor(255,255,255),de.setFontSize(10),de.setFont("helvetica","bold"),de.text("MATERIALS TOTAL:",Oe+5,rt+8),de.text(`$${At.toFixed(2)}`,re-Oe-5,rt+8,{align:"right"}),rt+=20),rt>Ke-80&&(de.addPage(),rt=Oe),rt+=10,de.setDrawColor(...tt),de.setLineWidth(1),de.line(Oe,rt,re-Oe,rt),rt+=15,de.setTextColor(...tt),de.setFontSize(12),de.setFont("helvetica","bold"),de.text("AUTHORIZATION",Oe,rt),rt+=10,de.setFontSize(10),de.setFont("helvetica","normal"),de.setTextColor(71,85,105),de.text("I hereby authorize the above time and materials charges as accurate and approved for billing.",Oe,rt),rt+=25;const ja=(re-Oe*2-30)/2;de.setDrawColor(...Et),de.setLineWidth(.5),de.line(Oe,rt+20,Oe+ja,rt+20),de.setFontSize(9),de.setTextColor(100,116,139),de.text("Authorized Signature (GC / Client)",Oe,rt+28),de.text("Date: ____________________",Oe,rt+38),de.line(Oe+ja+30,rt+20,re-Oe,rt+20),de.text("Print Name",Oe+ja+30,rt+28),de.text("Title: ____________________",Oe+ja+30,rt+38);const Ct=de.internal.getNumberOfPages();for(let _t=1;_t<=Ct;_t++){de.setPage(_t);const mr=Ke-15;de.setFontSize(8),de.setTextColor(148,163,184),de.text(`${e?.name||"Company"} - T&M Report - ${t.name}`,Oe,mr),de.text(`Page ${_t} of ${Ct}`,re-Oe,mr,{align:"right"})}const Ha=`${t.name}_TM_Report_${new Date().toISOString().split("T")[0]}.pdf`;de.save(Ha),r("PDF exported!","success")},B=se.useMemo(()=>{let Ae=f==="all"?[...n]:n.filter(de=>de.status===f);if(C.start){const de=new Date(C.start);de.setHours(0,0,0,0),Ae=Ae.filter(re=>new Date(re.work_date)>=de)}if(C.end){const de=new Date(C.end);de.setHours(23,59,59,999),Ae=Ae.filter(re=>new Date(re.work_date)<=de)}if(b==="recent"){const de=new Date;de.setDate(de.getDate()-7),de.setHours(0,0,0,0),Ae=Ae.filter(re=>new Date(re.work_date)>=de)}return Ae},[n,f,b,C]),q=se.useMemo(()=>{if(b!=="all")return null;const Ae={};return B.forEach(de=>{const re=new Date(de.work_date),Ke=`${re.getFullYear()}-${String(re.getMonth()+1).padStart(2,"0")}`,Oe=re.toLocaleDateString("en-US",{month:"long",year:"numeric"});Ae[Ke]||(Ae[Ke]={label:Oe,tickets:[],hours:0,cost:0}),Ae[Ke].tickets.push(de),Ae[Ke].hours+=Q(de),Ae[Ke].cost+=ne(de)}),Object.entries(Ae).sort((de,re)=>re[0].localeCompare(de[0]))},[B,b]);se.useEffect(()=>{if(q&&q.length>0){const Ae=q[0][0];E(new Set([Ae]))}},[q]);const Z=Ae=>{const de=new Set(S);de.has(Ae)?de.delete(Ae):de.add(Ae),E(de)},oe=B.reduce((Ae,de)=>Ae+Q(de),0),pe=B.reduce((Ae,de)=>Ae+ne(de),0),_e=f==="all"?n.length:n.filter(Ae=>Ae.status===f).length;if(o)return l.jsx("div",{className:"loading",children:"Loading T&M tickets..."});const be=B.length>0&&B.every(Ae=>y.has(Ae.id)),Le=y.size>0,he=Ae=>l.jsxs("div",{className:`tm-ticket-card ${Ae.status} ${y.has(Ae.id)?"selected":""}`,children:[l.jsxs("div",{className:"tm-ticket-header",onClick:()=>v(m===Ae.id?null:Ae.id),children:[l.jsx("input",{type:"checkbox",checked:y.has(Ae.id),onChange:de=>ee(Ae.id,de),onClick:de=>de.stopPropagation(),className:"tm-checkbox"}),l.jsxs("div",{className:"tm-ticket-info",children:[l.jsx("span",{className:"tm-ticket-date",children:le(Ae.work_date)}),Ae.ce_pco_number&&l.jsx("span",{className:"tm-ce-badge",children:Ae.ce_pco_number}),l.jsx("span",{className:`tm-ticket-status ${Ae.status}`,children:Ae.status})]}),l.jsxs("div",{className:"tm-ticket-summary",children:[l.jsxs("span",{className:"tm-ticket-hours",children:[Q(Ae)," hrs"]}),l.jsxs("span",{className:"tm-ticket-total",children:["$",ne(Ae).toFixed(2)]}),l.jsx("span",{className:"tm-expand-arrow",children:m===Ae.id?"":""})]})]}),m===Ae.id&&l.jsxs("div",{className:"tm-ticket-details",children:[Ae.t_and_m_workers?.length>0&&l.jsxs("div",{className:"tm-detail-section",children:[l.jsxs("h4",{children:[l.jsx(Ui,{size:16,className:"inline-icon"})," Workers"]}),l.jsx("div",{className:"tm-detail-list",children:Ae.t_and_m_workers.map(de=>l.jsxs("div",{className:"tm-detail-row",children:[l.jsxs("span",{children:[de.role&&de.role!=="Laborer"&&l.jsx("span",{className:"tm-role-badge",children:de.role}),de.name]}),l.jsxs("span",{children:[de.hours," hrs",parseFloat(de.overtime_hours)>0&&l.jsxs("span",{className:"tm-ot-badge",children:[" +",de.overtime_hours," OT"]})]})]},de.id))})]}),Ae.t_and_m_items?.length>0&&l.jsxs("div",{className:"tm-detail-section",children:[l.jsxs("h4",{children:[l.jsx(Y2,{size:16,className:"inline-icon"})," Materials & Equipment"]}),l.jsx("div",{className:"tm-detail-list",children:Ae.t_and_m_items.map(de=>l.jsxs("div",{className:"tm-detail-row",children:[l.jsx("span",{children:de.custom_name?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"tm-custom-badge",children:"Custom"})," ",de.custom_name]}):de.materials_equipment?.name}),l.jsxs("span",{className:"tm-detail-qty",children:[de.quantity," ",de.materials_equipment?.unit||"each",de.materials_equipment?.cost_per_unit>0&&l.jsxs("span",{className:"tm-item-cost",children:["$",(de.quantity*de.materials_equipment.cost_per_unit).toFixed(2)]})]})]},de.id))})]}),Ae.notes&&l.jsxs("div",{className:"tm-detail-section",children:[l.jsxs("h4",{children:[l.jsx(hc,{size:16,className:"inline-icon"})," Description"]}),l.jsx("p",{className:"tm-notes-text",children:Ae.notes})]}),Ae.photos&&Ae.photos.length>0&&l.jsxs("div",{className:"tm-detail-section",children:[l.jsxs("h4",{children:[l.jsx(jp,{size:16,className:"inline-icon"})," Photos (",Ae.photos.length,")"]}),l.jsx("div",{className:"tm-photos-grid",children:Ae.photos.map((de,re)=>l.jsx("a",{href:de,target:"_blank",rel:"noopener noreferrer",className:"tm-photo-thumb",children:l.jsx("img",{src:de,alt:`Photo ${re+1}`})},re))})]}),Ae.ce_pco_number&&Ae.change_order_value>0&&l.jsxs("div",{className:"tm-change-order-value",children:[l.jsx("span",{className:"tm-co-label",children:"Change Order Value:"}),l.jsxs("span",{className:"tm-co-amount",children:["$",Ae.change_order_value.toLocaleString()]})]}),l.jsxs("div",{className:"tm-ticket-actions",children:[Ae.status==="pending"&&l.jsxs(l.Fragment,{children:[l.jsxs("button",{className:"btn btn-success btn-small",onClick:de=>{de.stopPropagation(),O(Ae)},children:["Approve ",Ae.ce_pco_number?"+ CO":""]}),l.jsx("button",{className:"btn btn-warning btn-small",onClick:de=>{de.stopPropagation(),P(Ae.id,"rejected")},children:"Reject"})]}),Ae.status==="approved"&&l.jsx("button",{className:"btn btn-primary btn-small",onClick:de=>{de.stopPropagation(),P(Ae.id,"billed")},children:"Mark Billed"}),Ae.status==="rejected"&&l.jsx("button",{className:"btn btn-secondary btn-small",onClick:de=>{de.stopPropagation(),P(Ae.id,"pending")},children:"Restore"}),l.jsx("button",{className:"btn btn-danger btn-small",onClick:de=>{de.stopPropagation(),W(Ae.id)},children:"Delete"})]})]})]},Ae.id);return l.jsxs("div",{className:"tm-list",children:[l.jsxs("div",{className:"tm-list-header",children:[l.jsxs("div",{className:"tm-list-title",children:[l.jsx("h3",{children:"T&M Tickets"}),l.jsxs("div",{className:"tm-export-buttons",children:[Le&&l.jsxs("button",{className:"btn btn-ghost btn-small",onClick:ue,children:["Clear (",y.size,")"]}),l.jsxs("button",{className:"btn btn-secondary btn-small",onClick:A,children:["Excel ",Le?`(${y.size})`:""]}),l.jsxs("button",{className:"btn btn-primary btn-small",onClick:D,children:["PDF ",Le?`(${y.size})`:""]})]})]}),l.jsx("div",{className:"tm-filter-tabs",children:["all","pending","approved","billed","rejected"].map(Ae=>l.jsxs("button",{className:`tm-filter-tab ${f===Ae?"active":""}`,onClick:()=>{h(Ae),ue()},children:[Ae.charAt(0).toUpperCase()+Ae.slice(1),l.jsx("span",{className:"tm-filter-count",children:Ae==="all"?n.length:n.filter(de=>de.status===Ae).length})]},Ae))}),l.jsxs("div",{className:"view-mode-bar",children:[l.jsxs("div",{className:"view-mode-tabs",children:[l.jsx("button",{className:`view-mode-tab ${b==="recent"?"active":""}`,onClick:()=>{_("recent"),j({start:"",end:""})},children:"Recent (7 days)"}),l.jsxs("button",{className:`view-mode-tab ${b==="all"?"active":""}`,onClick:()=>_("all"),children:["All (",_e,")"]})]}),b==="all"&&l.jsxs("div",{className:"date-filter",children:[l.jsx(q0,{size:16}),l.jsx("input",{type:"date",value:C.start,onChange:Ae=>j(de=>({...de,start:Ae.target.value})),placeholder:"Start date"}),l.jsx("span",{children:"to"}),l.jsx("input",{type:"date",value:C.end,onChange:Ae=>j(de=>({...de,end:Ae.target.value})),placeholder:"End date"}),(C.start||C.end)&&l.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>j({start:"",end:""}),children:"Clear"})]})]})]}),B.length>0&&l.jsxs("div",{className:"tm-summary-bar",children:[l.jsxs("div",{className:"tm-summary-stat",children:[l.jsx("span",{className:"tm-summary-label",children:"Tickets"}),l.jsx("span",{className:"tm-summary-value",children:B.length})]}),l.jsxs("div",{className:"tm-summary-stat",children:[l.jsx("span",{className:"tm-summary-label",children:"Total Hours"}),l.jsx("span",{className:"tm-summary-value",children:oe.toFixed(1)})]}),l.jsxs("div",{className:"tm-summary-stat",children:[l.jsx("span",{className:"tm-summary-label",children:"Materials Cost"}),l.jsxs("span",{className:"tm-summary-value",children:["$",pe.toFixed(2)]})]})]}),B.length===0?l.jsxs("div",{className:"tm-empty-state",children:[l.jsxs("p",{children:["No ",f==="all"?"":f," T&M tickets",b==="recent"?" in the last 7 days":""]}),b==="recent"&&_e>0&&l.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>_("all"),children:"View All Tickets"})]}):l.jsxs("div",{className:"tm-tickets",children:[l.jsx("div",{className:"tm-select-all-row",children:l.jsxs("label",{className:"tm-checkbox-label",onClick:K,children:[l.jsx("input",{type:"checkbox",checked:be,onChange:K,className:"tm-checkbox"}),l.jsxs("span",{children:["Select All (",B.length,")"]})]})}),b==="all"&&q?q.map(([Ae,de])=>l.jsxs("div",{className:"month-group",children:[l.jsxs("div",{className:"month-header",onClick:()=>Z(Ae),children:[l.jsxs("div",{className:"month-header-left",children:[S.has(Ae)?l.jsx(ld,{size:18}):l.jsx(jf,{size:18}),l.jsx("span",{className:"month-label",children:de.label}),l.jsxs("span",{className:"month-count",children:[de.tickets.length," tickets"]})]}),l.jsxs("div",{className:"month-header-right",children:[l.jsxs("span",{className:"month-stat",children:[de.hours.toFixed(1)," hrs"]}),l.jsxs("span",{className:"month-stat",children:["$",de.cost.toFixed(2)]})]})]}),S.has(Ae)&&l.jsx("div",{className:"month-tickets",children:de.tickets.map(re=>he(re))})]},Ae)):B.map(Ae=>he(Ae))]}),R&&Y&&l.jsx("div",{className:"modal-overlay",onClick:()=>H(!1),children:l.jsxs("div",{className:"modal change-order-modal",onClick:Ae=>Ae.stopPropagation(),children:[l.jsx("h3",{children:"Approve Change Order Work"}),l.jsxs("p",{className:"modal-subtitle",children:["This T&M ticket is associated with ",l.jsx("strong",{children:Y.ce_pco_number})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Change Order Value ($)"}),l.jsx("input",{type:"number",value:V,onChange:Ae=>F(Ae.target.value),placeholder:"Enter the change order amount",autoFocus:!0}),l.jsx("p",{className:"form-help",children:"This amount will be added to the project's total contract value."})]}),l.jsxs("div",{className:"modal-actions",children:[l.jsx("button",{className:"btn btn-secondary",onClick:()=>H(!1),children:"Cancel"}),l.jsxs("button",{className:"btn btn-success",onClick:I,children:["Approve with $",parseFloat(V||0).toLocaleString()]})]})]})})]})}function gH({project:t,onClose:e,onShareCreated:r}){const{user:a}=$4(),[n,s]=se.useState(!1),[o,u]=se.useState(null),[f,h]=se.useState([]),[m,v]=se.useState(!1),[y,g]=se.useState({progress:!0,photos:!0,daily_reports:!0,tm_tickets:!1,crew_info:!1}),[b,_]=se.useState("never"),[S,E]=se.useState("");se.useEffect(()=>{C()},[t.id]);const C=async()=>{try{const O=await ut.getProjectShares(t.id);h(O)}catch(O){console.error("Error loading shares:",O)}},j=O=>{g(I=>({...I,[O]:!I[O]}))},R=()=>{if(b==="never")return null;const O=new Date;if(b==="30days")O.setDate(O.getDate()+30);else if(b==="90days")O.setDate(O.getDate()+90);else if(b==="custom"&&S)return new Date(S).toISOString();return O.toISOString()},H=async()=>{s(!0);try{const O=R(),I=await ut.createProjectShare(t.id,a.id,y,O);u({type:"success",message:"Share link created!"}),v(!1),C(),r&&r(I)}catch(O){console.error("Error creating share:",O),u({type:"error",message:"Failed to create share link"})}finally{s(!1)}},Y=O=>{const I=`${window.location.origin}/view/${O}`;navigator.clipboard.writeText(I),u({type:"success",message:"Link copied to clipboard!"})},U=async O=>{if(confirm("Are you sure you want to revoke this share link?"))try{await ut.revokeProjectShare(O),u({type:"success",message:"Share link revoked"}),C()}catch(I){console.error("Error revoking share:",I),u({type:"error",message:"Failed to revoke share link"})}},V=async O=>{if(confirm("Are you sure you want to permanently delete this share link?"))try{await ut.deleteProjectShare(O),u({type:"success",message:"Share link deleted"}),C()}catch(I){console.error("Error deleting share:",I),u({type:"error",message:"Failed to delete share link"})}},F=O=>O?new Date(O).toLocaleDateString():"Never",X=O=>O?new Date(O)<new Date:!1,P=O=>{const I=[];return O.progress&&I.push("Progress"),O.photos&&I.push("Photos"),O.daily_reports&&I.push("Reports"),O.tm_tickets&&I.push("T&M"),O.crew_info&&I.push("Crew"),I.join(", ")};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"modal-overlay",onClick:e,children:l.jsxs("div",{className:"modal-content share-modal",onClick:O=>O.stopPropagation(),children:[l.jsxs("div",{className:"modal-header",children:[l.jsxs("h2",{children:["Share Project: ",t.name]}),l.jsx("button",{className:"close-btn",onClick:e,children:""})]}),l.jsxs("div",{className:"modal-body",children:[f.length>0&&l.jsxs("div",{className:"existing-shares",children:[l.jsx("h3",{children:"Active Share Links"}),l.jsx("div",{className:"shares-list",children:f.map(O=>l.jsxs("div",{className:`share-item ${!O.is_active||X(O.expires_at)?"inactive":""}`,children:[l.jsxs("div",{className:"share-info",children:[l.jsxs("div",{className:"share-token",children:[l.jsxs("code",{children:[window.location.origin,"/view/",O.share_token]}),l.jsx("button",{className:"btn-small",onClick:()=>Y(O.share_token),disabled:!O.is_active||X(O.expires_at),children:"Copy"})]}),l.jsxs("div",{className:"share-meta",children:[l.jsx("span",{className:"permissions",children:P(O.permissions)}),l.jsxs("span",{className:"expiry",children:["Expires: ",F(O.expires_at)]}),l.jsxs("span",{className:"views",children:["Views: ",O.view_count||0,O.last_viewed_at&&` (Last: ${F(O.last_viewed_at)})`]})]}),!O.is_active&&l.jsx("div",{className:"status-badge revoked",children:"Revoked"}),X(O.expires_at)&&O.is_active&&l.jsx("div",{className:"status-badge expired",children:"Expired"})]}),l.jsxs("div",{className:"share-actions",children:[O.is_active&&!X(O.expires_at)&&l.jsx("button",{className:"btn-secondary",onClick:()=>U(O.id),children:"Revoke"}),l.jsx("button",{className:"btn-danger",onClick:()=>V(O.id),children:"Delete"})]})]},O.id))})]}),!m&&l.jsx("button",{className:"btn-primary",onClick:()=>v(!0),children:"+ Create New Share Link"}),m&&l.jsxs("div",{className:"new-share-form",children:[l.jsx("h3",{children:"Create New Share Link"}),l.jsxs("div",{className:"form-section",children:[l.jsx("label",{children:"Permissions"}),l.jsxs("div",{className:"checkbox-group",children:[l.jsxs("label",{children:[l.jsx("input",{type:"checkbox",checked:y.progress,onChange:()=>j("progress")}),"Progress/completion status"]}),l.jsxs("label",{children:[l.jsx("input",{type:"checkbox",checked:y.photos,onChange:()=>j("photos")}),"Photos feed"]}),l.jsxs("label",{children:[l.jsx("input",{type:"checkbox",checked:y.daily_reports,onChange:()=>j("daily_reports")}),"Daily reports"]}),l.jsxs("label",{children:[l.jsx("input",{type:"checkbox",checked:y.tm_tickets,onChange:()=>j("tm_tickets")}),"T&M tickets"]}),l.jsxs("label",{children:[l.jsx("input",{type:"checkbox",checked:y.crew_info,onChange:()=>j("crew_info")}),"Crew information"]})]})]}),l.jsxs("div",{className:"form-section",children:[l.jsx("label",{children:"Link Expiration"}),l.jsxs("div",{className:"radio-group",children:[l.jsxs("label",{children:[l.jsx("input",{type:"radio",value:"never",checked:b==="never",onChange:O=>_(O.target.value)}),"Never expires"]}),l.jsxs("label",{children:[l.jsx("input",{type:"radio",value:"30days",checked:b==="30days",onChange:O=>_(O.target.value)}),"30 days"]}),l.jsxs("label",{children:[l.jsx("input",{type:"radio",value:"90days",checked:b==="90days",onChange:O=>_(O.target.value)}),"90 days"]}),l.jsxs("label",{children:[l.jsx("input",{type:"radio",value:"custom",checked:b==="custom",onChange:O=>_(O.target.value)}),"Custom date"]})]}),b==="custom"&&l.jsx("input",{type:"date",value:S,onChange:O=>E(O.target.value),min:new Date().toISOString().split("T")[0],className:"date-input"})]}),l.jsxs("div",{className:"form-actions",children:[l.jsx("button",{className:"btn-secondary",onClick:()=>v(!1),children:"Cancel"}),l.jsx("button",{className:"btn-primary",onClick:H,disabled:n,children:n?"Generating...":"Generate Share Link"})]})]})]})]})}),o&&l.jsx(uf,{message:o.message,type:o.type,onClose:()=>u(null)}),l.jsx("style",{children:`
        .share-modal {
          max-width: 700px;
          max-height: 80vh;
          overflow-y: auto;
        }

        .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1.5rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .modal-header h2 {
          margin: 0;
          font-size: 1.25rem;
        }

        .close-btn {
          background: none;
          border: none;
          font-size: 2rem;
          cursor: pointer;
          color: #6b7280;
          padding: 0;
          width: 2rem;
          height: 2rem;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .close-btn:hover {
          color: #111827;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .existing-shares {
          margin-bottom: 2rem;
        }

        .existing-shares h3 {
          margin-top: 0;
          margin-bottom: 1rem;
          font-size: 1.1rem;
        }

        .shares-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .share-item {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1rem;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          gap: 1rem;
        }

        .share-item.inactive {
          opacity: 0.6;
          background-color: #f9fafb;
        }

        .share-info {
          flex: 1;
        }

        .share-token {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
        }

        .share-token code {
          background-color: #f3f4f6;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.875rem;
          flex: 1;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .share-meta {
          display: flex;
          flex-wrap: wrap;
          gap: 1rem;
          font-size: 0.875rem;
          color: #6b7280;
        }

        .status-badge {
          display: inline-block;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.75rem;
          font-weight: 500;
          margin-top: 0.5rem;
        }

        .status-badge.revoked {
          background-color: #fee2e2;
          color: #991b1b;
        }

        .status-badge.expired {
          background-color: #fef3c7;
          color: #92400e;
        }

        .share-actions {
          display: flex;
          gap: 0.5rem;
          flex-shrink: 0;
        }

        .new-share-form {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1.5rem;
          background-color: #f9fafb;
        }

        .new-share-form h3 {
          margin-top: 0;
          margin-bottom: 1.5rem;
          font-size: 1.1rem;
        }

        .form-section {
          margin-bottom: 1.5rem;
        }

        .form-section label {
          display: block;
          font-weight: 500;
          margin-bottom: 0.5rem;
        }

        .checkbox-group,
        .radio-group {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .checkbox-group label,
        .radio-group label {
          font-weight: normal;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .checkbox-group input[type="checkbox"],
        .radio-group input[type="radio"] {
          margin: 0;
        }

        .date-input {
          margin-top: 0.5rem;
          padding: 0.5rem;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          width: 100%;
        }

        .form-actions {
          display: flex;
          justify-content: flex-end;
          gap: 0.5rem;
          margin-top: 1.5rem;
        }

        .btn-small {
          padding: 0.25rem 0.75rem;
          font-size: 0.875rem;
          border: 1px solid #d1d5db;
          background-color: white;
          border-radius: 4px;
          cursor: pointer;
        }

        .btn-small:hover:not(:disabled) {
          background-color: #f3f4f6;
        }

        .btn-small:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-primary,
        .btn-secondary,
        .btn-danger {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          opacity: 0.9;
        }

        .btn-primary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-secondary {
          background-color: #f3f4f6;
          color: #374151;
        }

        .btn-secondary:hover {
          background-color: #e5e7eb;
        }

        .btn-danger {
          background-color: #ef4444;
          color: white;
        }

        .btn-danger:hover {
          background-color: #dc2626;
        }
      `})]})}const Iv=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},vH=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});function xH({project:t,companyId:e,company:r,onShowToast:a}){const{branding:n}=od(),[s,o]=se.useState([]),[u,f]=se.useState(null),[h,m]=se.useState(!1),[v,y]=se.useState(!0),[g,b]=se.useState(null),[_,S]=se.useState("recent"),[E,C]=se.useState(new Set),[j,R]=se.useState({start:"",end:""});se.useEffect(()=>{H()},[t?.id]);const H=async()=>{y(!0);try{const ee=t?await ut.getInjuryReports(t.id):await ut.getCompanyInjuryReports(e);o(ee)}catch(ee){console.error("Error loading injury reports:",ee),b({type:"error",message:"Failed to load injury reports"})}finally{y(!1)}},Y=()=>{H(),m(!1),b({type:"success",message:"Injury report created successfully"})},U=ee=>{f(ee)},V=()=>{f(null)},F=ee=>ee?new Date(ee).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",X=ee=>ee?new Date(`2000-01-01T${ee}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"",P=ee=>({minor:"Minor Injury",serious:"Serious Injury",critical:"Critical Injury",near_miss:"Near Miss"})[ee]||ee,O=ee=>({reported:"#fbbf24",under_investigation:"#3b82f6",closed:"#10b981"})[ee]||"#9ca3af",I=ee=>({minor:"#10b981",serious:"#f59e0b",critical:"#ef4444",near_miss:"#6b7280"})[ee]||"#9ca3af",W=se.useMemo(()=>{let ee=[...s];if(j.start){const K=new Date(j.start);K.setHours(0,0,0,0),ee=ee.filter(ue=>new Date(ue.incident_date)>=K)}if(j.end){const K=new Date(j.end);K.setHours(23,59,59,999),ee=ee.filter(ue=>new Date(ue.incident_date)<=K)}if(_==="recent"){const K=new Date;K.setDate(K.getDate()-7),K.setHours(0,0,0,0),ee=ee.filter(ue=>new Date(ue.incident_date)>=K)}return ee},[s,_,j]),ne=se.useMemo(()=>{if(_!=="all")return null;const ee={};return W.forEach(K=>{const ue=new Date(K.incident_date),M=`${ue.getFullYear()}-${String(ue.getMonth()+1).padStart(2,"0")}`,A=ue.toLocaleDateString("en-US",{month:"long",year:"numeric"});ee[M]||(ee[M]={label:A,reports:[]}),ee[M].reports.push(K)}),Object.entries(ee).sort((K,ue)=>ue[0].localeCompare(K[0]))},[W,_]);se.useEffect(()=>{if(ne&&ne.length>0){const ee=ne[0][0];C(new Set([ee]))}},[ne]);const Q=ee=>{const K=new Set(E);K.has(ee)?K.delete(ee):K.add(ee),C(K)},le=async()=>{if(s.length===0){b({type:"error",message:"No reports to export"});return}b({type:"info",message:"Generating PDF..."});const ee=new sr,K=ee.internal.pageSize.getWidth(),ue=20;let M=ue;const A=Iv(n?.primary_color||"#3B82F6"),D=Iv(n?.secondary_color||"#1E40AF");ee.setFillColor(...A),ee.rect(0,0,K,45,"F"),ee.setFillColor(...D),ee.rect(0,42,K,3,"F");let B=ue;if(n?.logo_url)try{const oe=await vH(n.logo_url);oe&&(ee.addImage(oe,"PNG",ue,7,30,30),B=ue+40)}catch(oe){console.error("Error adding logo:",oe)}ee.setTextColor(255,255,255),ee.setFontSize(22),ee.setFont("helvetica","bold"),ee.text(r?.name||"Company",B,20),ee.setFontSize(10),ee.setFont("helvetica","normal"),ee.text("INJURY & INCIDENT REPORTS",B,30),ee.setFontSize(9),ee.text(`Generated: ${new Date().toLocaleDateString()}`,K-ue,20,{align:"right"}),ee.text(`Total Reports: ${s.length}`,K-ue,28,{align:"right"}),M=55,t&&(ee.setFillColor(248,250,252),ee.rect(ue,M-5,K-ue*2,15,"F"),ee.setTextColor(...A),ee.setFontSize(12),ee.setFont("helvetica","bold"),ee.text(`Project: ${t.name}`,ue+5,M+5),M+=20),s.forEach(oe=>{M>200&&(ee.addPage(),M=ue);const pe=Iv(I(oe.injury_type));ee.setFillColor(...pe),ee.rect(ue,M,K-ue*2,12,"F"),ee.setTextColor(255,255,255),ee.setFontSize(11),ee.setFont("helvetica","bold"),ee.text(`${oe.employee_name} - ${P(oe.injury_type)}`,ue+5,M+8),ee.text(F(oe.incident_date),K-ue-5,M+8,{align:"right"}),M+=17,ee.setTextColor(50,50,50),ee.setFontSize(9),ee.setFont("helvetica","normal"),ee.text(`Location: ${oe.incident_location}`,ue+5,M),oe.incident_time&&ee.text(`Time: ${X(oe.incident_time)}`,ue+100,M),M+=6,ee.setFont("helvetica","bold"),ee.text("Description:",ue+5,M),ee.setFont("helvetica","normal"),M+=5;const _e=ee.splitTextToSize(oe.incident_description,K-ue*2-10);ee.text(_e,ue+5,M),M+=_e.length*4+3;const be=[];oe.body_part_affected&&be.push(`Body Part: ${oe.body_part_affected}`),oe.osha_recordable&&be.push("OSHA Recordable"),oe.workers_comp_claim&&be.push("Workers' Comp Filed"),oe.medical_treatment_required&&be.push("Medical Treatment Required"),be.length>0&&(ee.setFontSize(8),ee.setTextColor(100,100,100),ee.text(be.join("  |  "),ue+5,M),M+=5),ee.setFontSize(8),ee.text(`Reported by: ${oe.reported_by_name} (${oe.reported_by_title})`,ue+5,M),M+=12});const q=ee.internal.getNumberOfPages();for(let oe=1;oe<=q;oe++)ee.setPage(oe),ee.setFontSize(8),ee.setTextColor(150,150,150),ee.text(`Page ${oe} of ${q}`,K/2,ee.internal.pageSize.getHeight()-10,{align:"center"}),ee.text("CONFIDENTIAL - Injury Report",ue,ee.internal.pageSize.getHeight()-10);const Z=`Injury_Reports_${new Date().toISOString().split("T")[0]}.pdf`;ee.save(Z),b({type:"success",message:"PDF exported!"})};return v?l.jsxs("div",{className:"loading-container",children:[l.jsx("div",{className:"spinner"}),l.jsx("p",{children:"Loading injury reports..."})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"injury-reports-section",children:[l.jsxs("div",{className:"section-header",children:[l.jsx("h3",{children:"Injury & Incident Reports"}),l.jsxs("div",{className:"section-header-actions",children:[s.length>0&&l.jsx("button",{className:"btn-secondary",onClick:le,children:"PDF"}),l.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"+ File Injury Report"})]})]}),l.jsxs("div",{className:"view-mode-bar",children:[l.jsxs("div",{className:"view-mode-tabs",children:[l.jsx("button",{className:`view-mode-tab ${_==="recent"?"active":""}`,onClick:()=>{S("recent"),R({start:"",end:""})},children:"Recent (7 days)"}),l.jsxs("button",{className:`view-mode-tab ${_==="all"?"active":""}`,onClick:()=>S("all"),children:["All (",s.length,")"]})]}),_==="all"&&l.jsxs("div",{className:"date-filter",children:[l.jsx(q0,{size:16}),l.jsx("input",{type:"date",value:j.start,onChange:ee=>R(K=>({...K,start:ee.target.value})),placeholder:"Start date"}),l.jsx("span",{children:"to"}),l.jsx("input",{type:"date",value:j.end,onChange:ee=>R(K=>({...K,end:ee.target.value})),placeholder:"End date"}),(j.start||j.end)&&l.jsx("button",{className:"btn-ghost",onClick:()=>R({start:"",end:""}),children:"Clear"})]})]}),W.length===0?l.jsxs("div",{className:"empty-state",children:[l.jsx("div",{className:"empty-state-icon",children:""}),l.jsxs("h4",{children:["No Injury Reports",_==="recent"?" in the last 7 days":""]}),l.jsx("p",{children:'Click "File Injury Report" to document a workplace incident'}),_==="recent"&&s.length>0&&l.jsx("button",{className:"btn-secondary",onClick:()=>S("all"),children:"View All Reports"})]}):l.jsx("div",{className:"reports-list",children:_==="all"&&ne?ne.map(([ee,K])=>l.jsxs("div",{className:"month-group",children:[l.jsx("div",{className:"month-header",onClick:()=>Q(ee),children:l.jsxs("div",{className:"month-header-left",children:[E.has(ee)?l.jsx(ld,{size:18}):l.jsx(jf,{size:18}),l.jsx("span",{className:"month-label",children:K.label}),l.jsxs("span",{className:"month-count",children:[K.reports.length," reports"]})]})}),E.has(ee)&&l.jsx("div",{className:"month-reports",children:K.reports.map(ue=>l.jsxs("div",{className:"report-card",onClick:()=>U(ue),children:[l.jsxs("div",{className:"report-header",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"report-date",children:[F(ue.incident_date)," at ",X(ue.incident_time)]}),l.jsx("div",{className:"employee-name",children:ue.employee_name})]}),l.jsxs("div",{className:"report-badges",children:[l.jsx("span",{className:"badge",style:{backgroundColor:I(ue.injury_type)},children:P(ue.injury_type)}),l.jsx("span",{className:"badge",style:{backgroundColor:O(ue.status)},children:ue.status.replace("_"," ")})]})]}),l.jsxs("div",{className:"report-summary",children:[l.jsxs("div",{className:"summary-item",children:[l.jsx("strong",{children:"Location:"})," ",ue.incident_location]}),l.jsxs("div",{className:"summary-item",children:[l.jsx("strong",{children:"Reported by:"})," ",ue.reported_by_name," (",ue.reported_by_title,")"]}),ue.body_part_affected&&l.jsxs("div",{className:"summary-item",children:[l.jsx("strong",{children:"Body Part:"})," ",ue.body_part_affected]}),ue.osha_recordable&&l.jsx("div",{className:"summary-item",children:l.jsx("span",{className:"osha-badge",children:"OSHA Recordable"})})]}),l.jsxs("div",{className:"report-description",children:[ue.incident_description.substring(0,150),ue.incident_description.length>150&&"..."]}),l.jsx("div",{className:"report-footer",children:l.jsx("span",{children:"Click to view full details"})})]},ue.id))})]},ee)):W.map(ee=>l.jsxs("div",{className:"report-card",onClick:()=>U(ee),children:[l.jsxs("div",{className:"report-header",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"report-date",children:[F(ee.incident_date)," at ",X(ee.incident_time)]}),l.jsx("div",{className:"employee-name",children:ee.employee_name})]}),l.jsxs("div",{className:"report-badges",children:[l.jsx("span",{className:"badge",style:{backgroundColor:I(ee.injury_type)},children:P(ee.injury_type)}),l.jsx("span",{className:"badge",style:{backgroundColor:O(ee.status)},children:ee.status.replace("_"," ")})]})]}),l.jsxs("div",{className:"report-summary",children:[l.jsxs("div",{className:"summary-item",children:[l.jsx("strong",{children:"Location:"})," ",ee.incident_location]}),l.jsxs("div",{className:"summary-item",children:[l.jsx("strong",{children:"Reported by:"})," ",ee.reported_by_name," (",ee.reported_by_title,")"]}),ee.body_part_affected&&l.jsxs("div",{className:"summary-item",children:[l.jsx("strong",{children:"Body Part:"})," ",ee.body_part_affected]}),ee.osha_recordable&&l.jsx("div",{className:"summary-item",children:l.jsx("span",{className:"osha-badge",children:"OSHA Recordable"})})]}),l.jsxs("div",{className:"report-description",children:[ee.incident_description.substring(0,150),ee.incident_description.length>150&&"..."]}),l.jsx("div",{className:"report-footer",children:l.jsx("span",{children:"Click to view full details"})})]},ee.id))}),u&&l.jsx("div",{className:"modal-overlay",onClick:V,children:l.jsxs("div",{className:"modal-content report-details-modal",onClick:ee=>ee.stopPropagation(),children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("h2",{children:"Injury Report Details"}),l.jsx("button",{className:"close-btn",onClick:V,children:""})]}),l.jsxs("div",{className:"modal-body",children:[l.jsxs("section",{className:"details-section",children:[l.jsx("h3",{children:"Incident Information"}),l.jsxs("div",{className:"detail-grid",children:[l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Date & Time"}),l.jsxs("div",{children:[F(u.incident_date)," at ",X(u.incident_time)]})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Location"}),l.jsx("div",{children:u.incident_location})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Injury Type"}),l.jsx("div",{children:l.jsx("span",{className:"badge",style:{backgroundColor:I(u.injury_type)},children:P(u.injury_type)})})]}),u.body_part_affected&&l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Body Part Affected"}),l.jsx("div",{children:u.body_part_affected})]})]}),l.jsxs("div",{className:"detail-item full-width",children:[l.jsx("label",{children:"Description"}),l.jsx("div",{className:"description-box",children:u.incident_description})]})]}),l.jsxs("section",{className:"details-section",children:[l.jsx("h3",{children:"Injured Employee"}),l.jsxs("div",{className:"detail-grid",children:[l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Name"}),l.jsx("div",{children:u.employee_name})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Job Title"}),l.jsx("div",{children:u.employee_job_title})]}),u.employee_phone&&l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Phone"}),l.jsx("div",{children:u.employee_phone})]}),u.employee_email&&l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Email"}),l.jsx("div",{children:u.employee_email})]}),u.employee_address&&l.jsxs("div",{className:"detail-item full-width",children:[l.jsx("label",{children:"Address"}),l.jsx("div",{children:u.employee_address})]})]})]}),l.jsxs("section",{className:"details-section",children:[l.jsx("h3",{children:"Reported By"}),l.jsxs("div",{className:"detail-grid",children:[l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Name"}),l.jsx("div",{children:u.reported_by_name})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Title"}),l.jsx("div",{children:u.reported_by_title})]}),u.reported_by_phone&&l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Phone"}),l.jsx("div",{children:u.reported_by_phone})]}),u.reported_by_email&&l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Email"}),l.jsx("div",{children:u.reported_by_email})]})]})]}),u.witnesses&&u.witnesses.length>0&&l.jsxs("section",{className:"details-section",children:[l.jsx("h3",{children:"Witnesses"}),u.witnesses.map((ee,K)=>l.jsxs("div",{className:"witness-card",children:[l.jsxs("div",{className:"witness-header",children:[l.jsx("strong",{children:ee.name}),ee.phone&&l.jsxs("span",{children:["  ",ee.phone]}),ee.email&&l.jsxs("span",{children:["  ",ee.email]})]}),ee.testimony&&l.jsx("div",{className:"witness-testimony",children:l.jsxs("em",{children:['"',ee.testimony,'"']})})]},K))]}),u.medical_treatment_required&&l.jsxs("section",{className:"details-section",children:[l.jsx("h3",{children:"Medical Treatment"}),l.jsxs("div",{className:"detail-grid",children:[u.medical_facility_name&&l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Facility"}),l.jsx("div",{children:u.medical_facility_name})]}),u.medical_facility_address&&l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Address"}),l.jsx("div",{children:u.medical_facility_address})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Hospitalized"}),l.jsx("div",{children:u.hospitalized?"Yes":"No"})]})]})]}),l.jsxs("section",{className:"details-section",children:[l.jsx("h3",{children:"Actions & Safety"}),u.immediate_actions_taken&&l.jsxs("div",{className:"detail-item full-width",children:[l.jsx("label",{children:"Immediate Actions Taken"}),l.jsx("div",{className:"description-box",children:u.immediate_actions_taken})]}),u.corrective_actions_planned&&l.jsxs("div",{className:"detail-item full-width",children:[l.jsx("label",{children:"Corrective Actions Planned"}),l.jsx("div",{className:"description-box",children:u.corrective_actions_planned})]}),l.jsxs("div",{className:"detail-grid",children:[u.safety_equipment_used&&l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Safety Equipment Used"}),l.jsx("div",{children:u.safety_equipment_used})]}),u.safety_equipment_failed&&l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Safety Equipment Failed"}),l.jsx("div",{children:u.safety_equipment_failed})]})]})]}),l.jsxs("section",{className:"details-section",children:[l.jsx("h3",{children:"Regulatory & Work Impact"}),l.jsxs("div",{className:"detail-grid",children:[l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"OSHA Recordable"}),l.jsx("div",{children:u.osha_recordable?"Yes":"No"})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Workers' Comp Claim"}),l.jsx("div",{children:u.workers_comp_claim?"Yes":"No"})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Days Away From Work"}),l.jsx("div",{children:u.days_away_from_work||0})]}),l.jsxs("div",{className:"detail-item",children:[l.jsx("label",{children:"Restricted Work Days"}),l.jsx("div",{children:u.restricted_work_days||0})]})]})]}),l.jsxs("div",{className:"report-meta",children:["Filed on ",F(u.created_at)]})]})]})}),h&&l.jsx(W4,{project:t,companyId:e,onClose:()=>m(!1),onReportCreated:Y}),g&&l.jsx(uf,{message:g.message,type:g.type,onClose:()=>b(null)})]}),l.jsx("style",{children:`
        .injury-reports-section {
          margin-top: 2rem;
        }

        .section-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
        }

        .section-header h3 {
          margin: 0;
          font-size: 1.25rem;
          color: #111827;
        }

        .view-mode-bar {
          display: flex;
          justify-content: space-between;
          align-items: center;
          gap: 1rem;
          margin-bottom: 1rem;
          padding: 0.75rem;
          background: #f8fafc;
          border-radius: 8px;
          flex-wrap: wrap;
        }

        .view-mode-tabs {
          display: flex;
          gap: 0.5rem;
        }

        .view-mode-tab {
          padding: 0.5rem 1rem;
          border: none;
          border-radius: 6px;
          font-size: 0.875rem;
          cursor: pointer;
          background: transparent;
          color: #64748b;
          transition: all 0.2s;
        }

        .view-mode-tab:hover {
          background: #e2e8f0;
        }

        .view-mode-tab.active {
          background: var(--primary-color, #3b82f6);
          color: white;
        }

        .date-filter {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          color: #64748b;
        }

        .date-filter input[type="date"] {
          padding: 0.4rem 0.5rem;
          border: 1px solid #e2e8f0;
          border-radius: 4px;
          font-size: 0.875rem;
        }

        .btn-ghost {
          background: transparent;
          border: none;
          padding: 0.4rem 0.75rem;
          color: #64748b;
          cursor: pointer;
          border-radius: 4px;
          font-size: 0.875rem;
        }

        .btn-ghost:hover {
          background: #e2e8f0;
        }

        .month-group {
          margin-bottom: 0.5rem;
        }

        .month-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 0.75rem 1rem;
          background: #f1f5f9;
          border-radius: 8px;
          cursor: pointer;
          transition: background 0.2s;
        }

        .month-header:hover {
          background: #e2e8f0;
        }

        .month-header-left {
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .month-label {
          font-weight: 600;
          color: #1e293b;
        }

        .month-count {
          font-size: 0.875rem;
          color: #64748b;
        }

        .month-reports {
          margin-top: 0.5rem;
          padding-left: 0.5rem;
        }

        .reports-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .report-card {
          background: white;
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1.5rem;
          cursor: pointer;
          transition: all 0.2s;
        }

        .report-card:hover {
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          border-color: var(--primary-color, #3b82f6);
        }

        .report-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 1rem;
        }

        .report-date {
          font-size: 0.875rem;
          color: #6b7280;
          margin-bottom: 0.25rem;
        }

        .employee-name {
          font-size: 1.125rem;
          font-weight: 600;
          color: #111827;
        }

        .report-badges {
          display: flex;
          gap: 0.5rem;
          flex-wrap: wrap;
        }

        .badge {
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-size: 0.75rem;
          font-weight: 500;
          color: white;
          text-transform: capitalize;
        }

        .osha-badge {
          background-color: #dc2626;
          color: white;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.75rem;
          font-weight: 600;
        }

        .report-summary {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 0.75rem;
          margin-bottom: 1rem;
          padding: 1rem;
          background-color: #f9fafb;
          border-radius: 6px;
        }

        .summary-item {
          font-size: 0.875rem;
          color: #374151;
        }

        .summary-item strong {
          color: #111827;
        }

        .report-description {
          color: #6b7280;
          line-height: 1.6;
          margin-bottom: 1rem;
        }

        .report-footer {
          text-align: right;
          font-size: 0.875rem;
          color: var(--primary-color, #3b82f6);
        }

        .report-details-modal {
          max-width: 900px;
          max-height: 90vh;
          overflow-y: auto;
        }

        .details-section {
          margin-bottom: 2rem;
          padding-bottom: 2rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .details-section:last-child {
          border-bottom: none;
        }

        .details-section h3 {
          margin-top: 0;
          margin-bottom: 1rem;
          font-size: 1.125rem;
          color: #111827;
        }

        .detail-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 1rem;
        }

        .detail-item label {
          display: block;
          font-size: 0.875rem;
          font-weight: 600;
          color: #6b7280;
          margin-bottom: 0.25rem;
        }

        .detail-item div {
          color: #111827;
        }

        .detail-item.full-width {
          grid-column: 1 / -1;
        }

        .description-box {
          background-color: #f9fafb;
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          padding: 1rem;
          white-space: pre-wrap;
          line-height: 1.6;
        }

        .witness-card {
          background-color: #f9fafb;
          border-radius: 6px;
          padding: 1rem;
          margin-bottom: 0.5rem;
        }

        .witness-header {
          margin-bottom: 0.5rem;
          color: #111827;
        }

        .witness-testimony {
          color: #6b7280;
          font-size: 0.875rem;
          padding-left: 1rem;
          border-left: 3px solid #d1d5db;
        }

        .report-meta {
          text-align: center;
          font-size: 0.875rem;
          color: #6b7280;
          padding-top: 1rem;
          border-top: 1px solid #e5e7eb;
        }

        .empty-state {
          text-align: center;
          padding: 3rem 1rem;
        }

        .empty-state-icon {
          font-size: 3rem;
          margin-bottom: 1rem;
        }

        .empty-state h4 {
          margin: 0 0 0.5rem 0;
          color: #111827;
        }

        .empty-state p {
          margin: 0;
          color: #6b7280;
        }

        .section-header-actions {
          display: flex;
          gap: 0.5rem;
          align-items: center;
        }

        .btn-primary, .btn-secondary {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-secondary {
          background-color: #e5e7eb;
          color: #374151;
        }

        .btn-primary:hover, .btn-secondary:hover {
          opacity: 0.9;
        }

        .loading-container {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 3rem;
        }

        .spinner {
          width: 40px;
          height: 40px;
          border: 4px solid #e5e7eb;
          border-top-color: var(--primary-color, #3b82f6);
          border-radius: 50%;
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .report-header {
            flex-direction: column;
            gap: 0.5rem;
          }

          .report-summary {
            grid-template-columns: 1fr;
          }

          .detail-grid {
            grid-template-columns: 1fr;
          }

          .report-details-modal {
            max-width: 100%;
            height: 100vh;
            max-height: 100vh;
            border-radius: 0;
          }
        }
      `})]})}const Bv=[{id:"message",label:"Messages",Icon:z0,description:"Chat messages from field"},{id:"material_request",label:"Material Requests",Icon:Ef,description:"Equipment and material requests"},{id:"injury_report",label:"Safety Reports",Icon:V2,description:"Injury and safety incident reports"},{id:"tm_ticket",label:"T&M Tickets",Icon:fu,description:"Time and materials tickets"}];function yH({project:t,company:e,onShowToast:r,onClose:a}){const[n,s]=se.useState([]),[o,u]=se.useState({}),[f,h]=se.useState([]),[m,v]=se.useState(!0),[y,g]=se.useState(!1);se.useEffect(()=>{b()},[t?.id,e?.id]);const b=async()=>{if(!(!t?.id||!e?.id))try{v(!0);const j=await ut.getCompanyUsers(e.id);s(j);const R=await ut.getProjectNotificationPreferences(t.id),H={};R.forEach(U=>{H[U.user_id]={types:U.notification_types||[],presetId:null}}),u(H);const Y=await ut.getNotificationPresets(e.id);h(Y)}catch(j){console.error("Error loading notification settings:",j),r?.("Error loading notification settings","error")}finally{v(!1)}},_=(j,R)=>{u(H=>{const Y=H[j]||{types:[]},U=Y.types.includes(R)?Y.types.filter(V=>V!==R):[...Y.types,R];return{...H,[j]:{types:U,presetId:null}}})},S=(j,R)=>{const H=f.find(Y=>Y.id===R);H&&u(Y=>({...Y,[j]:{types:[...H.notification_types],presetId:R}}))},E=(j,R)=>{u(H=>({...H,[j]:{types:R?Bv.map(Y=>Y.id):[],presetId:null}}))},C=async()=>{try{g(!0);const j=Object.entries(o).map(([R,H])=>({userId:R,notificationTypes:H.types}));await ut.setProjectNotificationPreferences(t.id,j),r?.("Notification settings saved","success"),a?.()}catch(j){console.error("Error saving notification settings:",j),r?.("Error saving notification settings","error")}finally{g(!1)}};return m?l.jsxs("div",{className:"notification-settings",children:[l.jsxs("div",{className:"notification-settings-header",children:[l.jsx("h3",{children:"Notification Settings"}),l.jsx("button",{className:"close-btn",onClick:a,children:""})]}),l.jsx("div",{className:"loading-message",children:"Loading..."})]}):l.jsxs("div",{className:"notification-settings",children:[l.jsxs("div",{className:"notification-settings-header",children:[l.jsxs("h3",{children:["Notification Settings for ",t?.name]}),l.jsx("button",{className:"close-btn",onClick:a,children:""})]}),l.jsx("p",{className:"settings-description",children:"Choose who receives notifications when field workers send messages, request materials, submit safety reports, or create T&M tickets for this project."}),n.length===0?l.jsxs("div",{className:"no-users-message",children:[l.jsx("p",{children:"No users found in this company."}),l.jsx("small",{children:"Users need to be added to the company to receive notifications."})]}):l.jsx("div",{className:"notification-users-list",children:n.map(j=>{const R=o[j.id]||{types:[],presetId:null},H=R.types.length===Bv.length,Y=R.types.length>0&&!H;return l.jsxs("div",{className:"notification-user-row",children:[l.jsxs("div",{className:"user-info",children:[l.jsx("div",{className:"user-avatar",children:j.name?.charAt(0).toUpperCase()||j.email?.charAt(0).toUpperCase()}),l.jsxs("div",{className:"user-details",children:[l.jsx("span",{className:"user-name",children:j.name||j.email}),j.role&&l.jsx("span",{className:"user-role",children:j.role})]})]}),l.jsxs("div",{className:"notification-controls",children:[l.jsxs("select",{className:"preset-select",value:R.presetId||"",onChange:U=>U.target.value&&S(j.id,U.target.value),children:[l.jsx("option",{value:"",children:"Apply preset..."}),f.map(U=>l.jsx("option",{value:U.id,children:U.name},U.id))]}),l.jsx("button",{className:`toggle-all-btn ${H?"all-on":Y?"some-on":""}`,onClick:()=>E(j.id,!H),title:H?"Disable all":"Enable all",children:H?"All On":Y?"Some":"None"})]}),l.jsx("div",{className:"notification-types",children:Bv.map(U=>l.jsxs("label",{className:`notification-type-toggle ${R.types.includes(U.id)?"active":""}`,title:U.description,children:[l.jsx("input",{type:"checkbox",checked:R.types.includes(U.id),onChange:()=>_(j.id,U.id)}),l.jsx("span",{className:"type-icon",children:l.jsx(U.Icon,{size:16})}),l.jsx("span",{className:"type-label",children:U.label})]},U.id))})]},j.id)})}),l.jsxs("div",{className:"notification-settings-footer",children:[l.jsx("button",{className:"btn-secondary",onClick:a,children:"Cancel"}),l.jsx("button",{className:"btn-primary",onClick:C,disabled:y,children:y?"Saving...":"Save Settings"})]})]})}function _H({project:t,company:e,onShowToast:r}){const[a,n]=se.useState([]),[s,o]=se.useState(!0),[u,f]=se.useState("all"),[h,m]=se.useState(null),[v,y]=se.useState("recent"),[g,b]=se.useState(new Set),[_,S]=se.useState({start:"",end:""});se.useEffect(()=>{E();const I=ut.subscribeToMaterialRequests?.(t.id,()=>{E()});return()=>{I&&ut.unsubscribe?.(I)}},[t.id]);const E=async()=>{try{const I=await ut.getMaterialRequests(t.id);n(I||[])}catch(I){console.error("Error loading material requests:",I),r?.("Error loading material requests","error")}finally{o(!1)}},C=async(I,W)=>{try{await ut.updateMaterialRequest(I,W,"Office"),n(a.map(ne=>ne.id===I?{...ne,status:W}:ne)),r?.(`Request ${W}`,"success")}catch(ne){console.error("Error updating status:",ne),r?.("Error updating status","error")}},j=I=>new Date(I).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),R=I=>new Date(I).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),H=I=>{switch(I){case"urgent":return"priority-urgent";case"low":return"priority-low";default:return"priority-normal"}},Y=I=>{switch(I){case"urgent":return"";case"low":return"";default:return""}},U=se.useMemo(()=>{let I=u==="all"?[...a]:a.filter(W=>W.status===u);if(_.start){const W=new Date(_.start);W.setHours(0,0,0,0),I=I.filter(ne=>new Date(ne.created_at)>=W)}if(_.end){const W=new Date(_.end);W.setHours(23,59,59,999),I=I.filter(ne=>new Date(ne.created_at)<=W)}if(v==="recent"){const W=new Date;W.setDate(W.getDate()-7),W.setHours(0,0,0,0),I=I.filter(ne=>new Date(ne.created_at)>=W)}return I},[a,u,v,_]),V=se.useMemo(()=>{if(v!=="all")return null;const I={};return U.forEach(W=>{const ne=new Date(W.created_at),Q=`${ne.getFullYear()}-${String(ne.getMonth()+1).padStart(2,"0")}`,le=ne.toLocaleDateString("en-US",{month:"long",year:"numeric"});I[Q]||(I[Q]={label:le,requests:[],itemCount:0}),I[Q].requests.push(W),I[Q].itemCount+=W.items?.length||0}),Object.entries(I).sort((W,ne)=>ne[0].localeCompare(W[0]))},[U,v]);se.useEffect(()=>{if(V&&V.length>0){const I=V[0][0];b(new Set([I]))}},[V]);const F=I=>{const W=new Set(g);W.has(I)?W.delete(I):W.add(I),b(W)},X={all:a.length,pending:a.filter(I=>I.status==="pending").length,ordered:a.filter(I=>I.status==="ordered").length,delivered:a.filter(I=>I.status==="delivered").length,cancelled:a.filter(I=>I.status==="cancelled").length},P=u==="all"?a.length:a.filter(I=>I.status===u).length;if(s)return l.jsx("div",{className:"loading",children:"Loading material requests..."});const O=I=>l.jsxs("div",{className:`material-request-card ${I.status} ${I.priority==="urgent"?"urgent":""}`,children:[l.jsxs("div",{className:"material-request-header-row",onClick:()=>m(h===I.id?null:I.id),children:[l.jsxs("div",{className:"material-request-info",children:[l.jsxs("span",{className:`material-priority-badge ${H(I.priority)}`,children:[Y(I.priority)," ",I.priority]}),l.jsx("span",{className:"material-request-date",children:j(I.created_at)}),l.jsx("span",{className:"material-request-time",children:R(I.created_at)})]}),l.jsxs("div",{className:"material-request-summary",children:[l.jsxs("span",{className:"material-items-count",children:[I.items?.length||0," item",(I.items?.length||0)!==1?"s":""]}),l.jsx("span",{className:`material-status ${I.status}`,children:I.status}),l.jsx("span",{className:"material-expand-arrow",children:h===I.id?"":""})]})]}),h===I.id&&l.jsxs("div",{className:"material-request-details",children:[l.jsxs("div",{className:"material-detail-section",children:[l.jsxs("div",{className:"material-requester",children:[l.jsx("span",{className:"requester-label",children:"Requested by:"}),l.jsx("span",{className:"requester-name",children:I.requested_by||"Field"})]}),I.needed_by&&l.jsxs("div",{className:"material-needed-by",children:[l.jsx("span",{className:"needed-label",children:"Needed by:"}),l.jsx("span",{className:"needed-date",children:j(I.needed_by)})]})]}),I.items?.length>0&&l.jsxs("div",{className:"material-detail-section",children:[l.jsx("h4",{children:"Items Requested"}),l.jsx("div",{className:"material-items-list",children:I.items.map((W,ne)=>l.jsxs("div",{className:"material-item-row",children:[l.jsx("span",{className:"item-name",children:W.name}),l.jsxs("span",{className:"item-quantity",children:[W.quantity," ",W.unit]})]},ne))})]}),I.notes&&l.jsxs("div",{className:"material-detail-section",children:[l.jsx("h4",{children:"Notes"}),l.jsx("p",{className:"material-notes",children:I.notes})]}),l.jsxs("div",{className:"material-request-actions",children:[I.status==="pending"&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:"btn btn-success btn-small",onClick:W=>{W.stopPropagation(),C(I.id,"ordered")},children:"Mark Ordered"}),l.jsx("button",{className:"btn btn-danger btn-small",onClick:W=>{W.stopPropagation(),C(I.id,"cancelled")},children:"Cancel"})]}),I.status==="ordered"&&l.jsx("button",{className:"btn btn-success btn-small",onClick:W=>{W.stopPropagation(),C(I.id,"delivered")},children:"Mark Delivered"}),I.status==="cancelled"&&l.jsx("button",{className:"btn btn-secondary btn-small",onClick:W=>{W.stopPropagation(),C(I.id,"pending")},children:"Restore"})]})]})]},I.id);return l.jsxs("div",{className:"material-requests-list card",children:[l.jsxs("div",{className:"material-requests-header",children:[l.jsxs("div",{className:"material-requests-title",children:[l.jsx("h3",{children:"Material Requests"}),X.pending>0&&l.jsxs("span",{className:"pending-badge",children:[X.pending," pending"]})]}),l.jsx("div",{className:"material-filter-tabs",children:["all","pending","ordered","delivered","cancelled"].map(I=>l.jsxs("button",{className:`material-filter-tab ${u===I?"active":""}`,onClick:()=>f(I),children:[I.charAt(0).toUpperCase()+I.slice(1),l.jsx("span",{className:"material-filter-count",children:X[I]})]},I))}),l.jsxs("div",{className:"view-mode-bar",children:[l.jsxs("div",{className:"view-mode-tabs",children:[l.jsx("button",{className:`view-mode-tab ${v==="recent"?"active":""}`,onClick:()=>{y("recent"),S({start:"",end:""})},children:"Recent (7 days)"}),l.jsxs("button",{className:`view-mode-tab ${v==="all"?"active":""}`,onClick:()=>y("all"),children:["All (",P,")"]})]}),v==="all"&&l.jsxs("div",{className:"date-filter",children:[l.jsx(q0,{size:16}),l.jsx("input",{type:"date",value:_.start,onChange:I=>S(W=>({...W,start:I.target.value})),placeholder:"Start date"}),l.jsx("span",{children:"to"}),l.jsx("input",{type:"date",value:_.end,onChange:I=>S(W=>({...W,end:I.target.value})),placeholder:"End date"}),(_.start||_.end)&&l.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>S({start:"",end:""}),children:"Clear"})]})]})]}),U.length===0?l.jsxs("div",{className:"material-empty-state",children:[l.jsx("span",{className:"empty-icon",children:l.jsx(Ef,{size:32})}),l.jsxs("p",{children:["No ",u==="all"?"":u," material requests",v==="recent"?" in the last 7 days":""]}),v==="recent"&&P>0&&l.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>y("all"),children:"View All Requests"})]}):l.jsx("div",{className:"material-requests",children:v==="all"&&V?V.map(([I,W])=>l.jsxs("div",{className:"month-group",children:[l.jsxs("div",{className:"month-header",onClick:()=>F(I),children:[l.jsxs("div",{className:"month-header-left",children:[g.has(I)?l.jsx(ld,{size:18}):l.jsx(jf,{size:18}),l.jsx("span",{className:"month-label",children:W.label}),l.jsxs("span",{className:"month-count",children:[W.requests.length," requests"]})]}),l.jsx("div",{className:"month-header-right",children:l.jsxs("span",{className:"month-stat",children:[W.itemCount," items"]})})]}),g.has(I)&&l.jsx("div",{className:"month-requests",children:W.requests.map(ne=>O(ne))})]},I)):U.map(I=>O(I))})]})}const AS=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},bH=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});function wH({project:t,company:e,onShowToast:r}){const{branding:a}=od(),[n,s]=se.useState([]),[o,u]=se.useState(!0),[f,h]=se.useState(null),[m,v]=se.useState(new Set),[y,g]=se.useState(!1),[b,_]=se.useState("recent"),[S,E]=se.useState(new Set),[C,j]=se.useState({start:"",end:""});se.useEffect(()=>{R();const ue=ut.subscribeToDailyReports?.(t.id,()=>{R()});return()=>{ue&&ut.unsubscribe?.(ue)}},[t.id]);const R=async()=>{try{const ue=await ut.getDailyReports(t.id,365);s(ue||[])}catch(ue){console.error("Error loading daily reports:",ue),r?.("Error loading daily reports","error")}finally{u(!1)}},H=se.useMemo(()=>{let ue=[...n];if(C.start){const M=new Date(C.start);M.setHours(0,0,0,0),ue=ue.filter(A=>new Date(A.report_date||A.created_at)>=M)}if(C.end){const M=new Date(C.end);M.setHours(23,59,59,999),ue=ue.filter(A=>new Date(A.report_date||A.created_at)<=M)}if(b==="recent"){const M=new Date;M.setDate(M.getDate()-7),M.setHours(0,0,0,0),ue=ue.filter(A=>new Date(A.report_date||A.created_at)>=M)}return ue},[n,b,C]),Y=se.useMemo(()=>{if(b!=="all")return null;const ue={};return H.forEach(M=>{const A=new Date(M.report_date||M.created_at),D=`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}`,B=A.toLocaleDateString("en-US",{month:"long",year:"numeric"});ue[D]||(ue[D]={label:B,reports:[]}),ue[D].reports.push(M)}),Object.entries(ue).sort((M,A)=>A[0].localeCompare(M[0]))},[H,b]);se.useEffect(()=>{if(Y&&Y.length>0){const ue=Y[0][0];E(new Set([ue]))}},[Y]);const U=()=>{g(!y),y&&v(new Set)},V=ue=>{const M=new Set(m);M.has(ue)?M.delete(ue):M.add(ue),v(M)},F=()=>{m.size===H.length?v(new Set):v(new Set(H.map(ue=>ue.id)))},X=ue=>{const M=new Set(S);M.has(ue)?M.delete(ue):M.add(ue),E(M)},P=()=>m.size>0?H.filter(ue=>m.has(ue.id)):H,O=ue=>new Date(ue).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}),I=ue=>new Date(ue).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),W=ue=>{switch(ue){case"submitted":return"";case"reviewed":return"";case"draft":return"";default:return""}},ne=ue=>{switch(ue){case"submitted":return"Submitted";case"reviewed":return"Reviewed";case"draft":return"Draft";default:return ue}},Q=async()=>{const ue=P();if(ue.length===0){r?.("No reports to export","error");return}r?.("Generating PDF...","info");const M=new sr,A=M.internal.pageSize.getWidth(),D=20;let B=D;const q=AS(a?.primary_color||"#3B82F6"),Z=AS(a?.secondary_color||"#1E40AF");M.setFillColor(...q),M.rect(0,0,A,45,"F"),M.setFillColor(...Z),M.rect(0,42,A,3,"F");let oe=D;if(a?.logo_url)try{const be=await bH(a.logo_url);be&&(M.addImage(be,"PNG",D,7,30,30),oe=D+40)}catch(be){console.error("Error adding logo:",be)}M.setTextColor(255,255,255),M.setFontSize(22),M.setFont("helvetica","bold"),M.text(e?.name||"Company Name",oe,20),M.setFontSize(10),M.setFont("helvetica","normal"),M.text("DAILY REPORTS SUMMARY",oe,30),M.setFontSize(9),M.text(`Generated: ${new Date().toLocaleDateString()}`,A-D,20,{align:"right"}),t.job_number&&M.text(`Job #: ${t.job_number}`,A-D,28,{align:"right"}),B=55,M.setFillColor(248,250,252),M.rect(D,B-5,A-D*2,20,"F"),M.setTextColor(...q),M.setFontSize(14),M.setFont("helvetica","bold"),M.text(`Project: ${t.name}`,D+5,B+7),M.setFontSize(10),M.setTextColor(100,100,100),M.text(`${ue.length} Report${ue.length!==1?"s":""}`,A-D-5,B+7,{align:"right"}),B+=25,ue.forEach((be,Le)=>{B>250&&(M.addPage(),B=D),M.setFillColor(...q),M.setTextColor(255,255,255),M.rect(D,B,A-D*2,10,"F"),M.setFontSize(11),M.setFont("helvetica","bold"),M.text(O(be.report_date||be.created_at),D+5,B+7),M.text(ne(be.status),A-D-5,B+7,{align:"right"}),B+=15,M.setTextColor(50,50,50),M.setFontSize(10),M.setFont("helvetica","normal");const he=`Crew: ${be.crew_count||0}  |  Tasks: ${be.tasks_completed||0}  |  T&M: ${be.tm_tickets_count||0}  |  Photos: ${be.photos_count||0}`;if(M.text(he,D+5,B),B+=8,be.crew_list?.length>0){M.setFont("helvetica","bold"),M.text("Crew:",D+5,B),M.setFont("helvetica","normal");const Ae=be.crew_list.map(re=>`${re.name} (${re.role})`).join(", "),de=M.splitTextToSize(Ae,A-D*2-30);M.text(de,D+25,B),B+=de.length*5+3}if(be.field_notes){M.setFont("helvetica","bold"),M.text("Notes:",D+5,B),M.setFont("helvetica","normal");const Ae=M.splitTextToSize(be.field_notes,A-D*2-30);M.text(Ae,D+25,B),B+=Ae.length*5+3}if(be.issues){M.setTextColor(180,50,50),M.setFont("helvetica","bold"),M.text("Issues:",D+5,B),M.setFont("helvetica","normal");const Ae=M.splitTextToSize(be.issues,A-D*2-30);M.text(Ae,D+25,B),M.setTextColor(50,50,50),B+=Ae.length*5+3}B+=10});const pe=M.internal.getNumberOfPages();for(let be=1;be<=pe;be++)M.setPage(be),M.setFontSize(8),M.setTextColor(150,150,150),M.text(`Page ${be} of ${pe}`,A/2,M.internal.pageSize.getHeight()-10,{align:"center"});const _e=`${t.name}_Daily_Reports_${new Date().toISOString().split("T")[0]}.pdf`;M.save(_e),r?.("PDF exported!","success")},le=ue=>l.jsxs("div",{className:`daily-report-card ${ue.status} ${m.has(ue.id)?"selected":""}`,children:[l.jsxs("div",{className:"daily-report-header-row",onClick:()=>h(f===ue.id?null:ue.id),children:[y&&l.jsx("input",{type:"checkbox",className:"report-checkbox",checked:m.has(ue.id),onChange:M=>{M.stopPropagation(),V(ue.id)},onClick:M=>M.stopPropagation()}),l.jsxs("div",{className:"daily-report-info",children:[l.jsx("span",{className:"report-date",children:O(ue.report_date||ue.created_at)}),l.jsxs("span",{className:`report-status ${ue.status}`,children:[W(ue.status)," ",ne(ue.status)]})]}),l.jsxs("div",{className:"daily-report-summary",children:[l.jsxs("span",{className:"report-crew",children:[ue.crew_count||0," crew"]}),l.jsxs("span",{className:"report-tasks",children:[ue.tasks_completed||0," tasks"]}),l.jsx("span",{className:"report-expand",children:f===ue.id?"":""})]})]}),f===ue.id&&l.jsxs("div",{className:"daily-report-details",children:[l.jsxs("div",{className:"report-stats-grid",children:[l.jsxs("div",{className:"report-stat",children:[l.jsx("span",{className:"stat-value",children:ue.crew_count||0}),l.jsx("span",{className:"stat-label",children:"Crew on Site"})]}),l.jsxs("div",{className:"report-stat",children:[l.jsx("span",{className:"stat-value",children:ue.tasks_completed||0}),l.jsx("span",{className:"stat-label",children:"Tasks Done"})]}),l.jsxs("div",{className:"report-stat",children:[l.jsx("span",{className:"stat-value",children:ue.tm_tickets_count||0}),l.jsx("span",{className:"stat-label",children:"T&M Tickets"})]}),l.jsxs("div",{className:"report-stat",children:[l.jsx("span",{className:"stat-value",children:ue.photos_count||0}),l.jsx("span",{className:"stat-label",children:"Photos"})]})]}),ue.crew_list?.length>0&&l.jsxs("div",{className:"report-section",children:[l.jsx("h4",{children:"Crew"}),l.jsx("div",{className:"report-crew-list",children:ue.crew_list.map((M,A)=>l.jsxs("div",{className:"crew-member",children:[l.jsx("span",{className:"crew-name",children:M.name}),l.jsx("span",{className:"crew-role",children:M.role})]},A))})]}),ue.completed_tasks?.length>0&&l.jsxs("div",{className:"report-section",children:[l.jsx("h4",{children:"Completed Today"}),l.jsx("ul",{className:"report-tasks-list",children:ue.completed_tasks.map((M,A)=>l.jsxs("li",{children:[M.name,M.group&&l.jsx("span",{className:"task-group",children:M.group})]},A))})]}),ue.field_notes&&l.jsxs("div",{className:"report-section",children:[l.jsx("h4",{children:"Field Notes"}),l.jsx("p",{className:"report-notes",children:ue.field_notes})]}),ue.issues&&l.jsxs("div",{className:"report-section issues",children:[l.jsx("h4",{children:"Issues / Concerns"}),l.jsx("p",{className:"report-issues",children:ue.issues})]}),ue.submitted_at&&l.jsx("div",{className:"report-meta",children:l.jsxs("span",{children:["Submitted by ",ue.submitted_by||"Field"," at ",I(ue.submitted_at)]})})]})]},ue.id);if(o)return l.jsx("div",{className:"loading",children:"Loading daily reports..."});const ee=n.length,K=H.length;return l.jsxs("div",{className:"daily-reports-list card",children:[l.jsxs("div",{className:"daily-reports-header",children:[l.jsx("h3",{children:"Daily Reports"}),l.jsx("div",{className:"daily-reports-actions",children:n.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:`btn btn-small ${y?"btn-primary":"btn-secondary"}`,onClick:U,children:y?"Cancel":"Select"}),l.jsxs("button",{className:"btn btn-secondary btn-small",onClick:Q,children:["PDF",m.size>0?` (${m.size})`:""]})]})})]}),n.length>0&&l.jsxs("div",{className:"view-mode-bar",children:[l.jsxs("div",{className:"view-mode-tabs",children:[l.jsx("button",{className:`view-mode-tab ${b==="recent"?"active":""}`,onClick:()=>_("recent"),children:"Recent (7 days)"}),l.jsxs("button",{className:`view-mode-tab ${b==="all"?"active":""}`,onClick:()=>_("all"),children:["All (",ee,")"]})]}),b==="all"&&l.jsxs("div",{className:"date-filter",children:[l.jsx(q0,{size:14,className:"date-filter-icon"}),l.jsx("input",{type:"date",value:C.start,onChange:ue=>j(M=>({...M,start:ue.target.value})),className:"date-input"}),l.jsx("span",{className:"date-separator",children:"to"}),l.jsx("input",{type:"date",value:C.end,onChange:ue=>j(M=>({...M,end:ue.target.value})),className:"date-input"}),(C.start||C.end)&&l.jsx("button",{className:"date-clear",onClick:()=>j({start:"",end:""}),children:"Clear"})]})]}),y&&H.length>0&&l.jsxs("div",{className:"select-all-bar",children:[l.jsxs("label",{className:"select-all-label",children:[l.jsx("input",{type:"checkbox",checked:m.size===H.length&&H.length>0,onChange:F}),"Select All (",H.length,")"]}),m.size>0&&l.jsxs("span",{className:"selected-count",children:[m.size," selected"]})]}),n.length===0?l.jsxs("div",{className:"reports-empty-state",children:[l.jsx("span",{className:"empty-icon",children:l.jsx(fu,{size:32})}),l.jsx("p",{children:"No daily reports yet"}),l.jsx("small",{children:"Reports from the field will appear here"})]}):H.length===0?l.jsxs("div",{className:"reports-empty-state",children:[l.jsx("span",{className:"empty-icon",children:l.jsx(fu,{size:32})}),l.jsx("p",{children:"No reports in this time period"}),l.jsx("small",{children:b==="recent"?"No reports in the last 7 days":"Try adjusting your date filter"})]}):b==="recent"?l.jsxs("div",{className:"daily-reports",children:[H.map(ue=>le(ue)),ee>K&&l.jsx("div",{className:"view-all-prompt",children:l.jsxs("button",{className:"btn btn-secondary",onClick:()=>_("all"),children:["View All ",ee," Reports"]})})]}):l.jsx("div",{className:"daily-reports grouped",children:Y?.map(([ue,{label:M,reports:A}])=>l.jsxs("div",{className:"month-group",children:[l.jsxs("div",{className:"month-header",onClick:()=>X(ue),children:[S.has(ue)?l.jsx(ld,{size:18,className:"month-chevron"}):l.jsx(jf,{size:18,className:"month-chevron"}),l.jsx("span",{className:"month-label",children:M}),l.jsxs("span",{className:"month-count",children:[A.length," report",A.length!==1?"s":""]})]}),S.has(ue)&&l.jsx("div",{className:"month-reports",children:A.map(D=>le(D))})]},ue))})]})}function SH({project:t,company:e,userName:r,onShowToast:a}){const[n,s]=se.useState([]),[o,u]=se.useState(!0),[f,h]=se.useState(!1),[m,v]=se.useState(""),[y,g]=se.useState(0),[b,_]=se.useState(!1),S=se.useRef(null);se.useEffect(()=>{E();const Y=ut.subscribeToMessages?.(t.id,U=>{U.new&&(s(V=>[...V,U.new]),U.new.sender_type==="field"&&g(V=>V+1))});return()=>{Y&&ut.unsubscribe?.(Y)}},[t.id]),se.useEffect(()=>{b&&(S.current?.scrollIntoView({behavior:"smooth"}),ut.markMessagesRead?.(t.id,"office"),g(0))},[n,b]);const E=async()=>{try{const U=(await ut.getMessages(t.id,50)||[]).sort((F,X)=>new Date(F.created_at)-new Date(X.created_at));s(U);const V=U.filter(F=>F.sender_type==="field"&&!F.is_read).length;g(V)}catch(Y){console.error("Error loading messages:",Y)}finally{u(!1)}},C=async()=>{if(m.trim()){h(!0);try{const Y=await ut.sendMessage(t.id,m.trim(),"office",r||"Office");s(U=>[...U,Y]),v("")}catch(Y){console.error("Error sending message:",Y),a?.("Error sending message","error")}finally{h(!1)}}},j=Y=>{Y.key==="Enter"&&!Y.shiftKey&&(Y.preventDefault(),C())},R=Y=>{const U=new Date(Y),V=new Date;return U.toDateString()===V.toDateString()?U.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):U.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})},H=n.slice(-3);return o?l.jsxs("div",{className:"project-messages card",children:[l.jsx("div",{className:"project-messages-header",children:l.jsx("h3",{children:"Messages"})}),l.jsx("div",{className:"loading",children:"Loading messages..."})]}):l.jsxs("div",{className:`project-messages card ${b?"expanded":""}`,children:[l.jsxs("div",{className:"project-messages-header",onClick:()=>_(!b),children:[l.jsxs("div",{className:"messages-title-row",children:[l.jsx("h3",{children:"Messages"}),y>0&&l.jsxs("span",{className:"messages-unread-badge",children:[y," new"]})]}),l.jsx("button",{className:"messages-toggle-btn",children:b?" Collapse":" Expand"})]}),!b&&n.length>0&&l.jsxs("div",{className:"messages-preview",children:[H.map(Y=>l.jsxs("div",{className:`preview-message ${Y.sender_type}`,children:[l.jsxs("span",{className:"preview-sender",children:[Y.sender_type==="office"?l.jsx(S0,{size:12,className:"inline-icon"}):l.jsx(Ui,{size:12,className:"inline-icon"})," ",Y.sender_name,":"]}),l.jsxs("span",{className:"preview-text",children:[Y.message?.slice(0,50),Y.message?.length>50?"...":""]})]},Y.id)),n.length===0&&l.jsx("p",{className:"no-messages-hint",children:"No messages yet. Click to start chatting."})]}),b&&l.jsxs("div",{className:"messages-full",children:[l.jsxs("div",{className:"messages-list-container",children:[n.length===0?l.jsxs("div",{className:"messages-empty",children:[l.jsx("span",{className:"empty-icon",children:l.jsx(z0,{size:32})}),l.jsx("p",{children:"No messages yet"}),l.jsx("small",{children:"Send a message to the field crew"})]}):n.map(Y=>l.jsxs("div",{className:`message-bubble ${Y.sender_type==="office"?"sent":"received"}`,children:[l.jsxs("div",{className:"message-sender",children:[Y.sender_type==="office"?l.jsx(S0,{size:14,className:"inline-icon"}):l.jsx(Ui,{size:14,className:"inline-icon"})," ",Y.sender_name]}),l.jsx("div",{className:"message-text",children:Y.message}),Y.photo_url&&l.jsx("img",{src:Y.photo_url,alt:"Attached",className:"message-photo"}),l.jsx("div",{className:"message-time",children:R(Y.created_at)})]},Y.id)),l.jsx("div",{ref:S})]}),l.jsxs("div",{className:"messages-input-row",children:[l.jsx("textarea",{value:m,onChange:Y=>v(Y.target.value),onKeyDown:j,placeholder:"Type a message...",rows:1,disabled:f}),l.jsx("button",{className:"btn btn-primary send-btn",onClick:C,disabled:f||!m.trim(),children:f?"...":"Send"})]})]})]})}function NH({project:t,company:e,onShowToast:r}){const[a,n]=se.useState(null),[s,o]=se.useState(!0),[u,f]=se.useState(!1);se.useEffect(()=>{if(t?.id&&e?.id){h();const b=ut.subscribeToCrewCheckins?.(t.id,()=>{h()});return()=>{b&&ut.unsubscribe?.(b)}}},[t?.id,e?.id]);const h=async()=>{try{const b=await ut.calculateManDayCosts(t.id,e.id,t.work_type||"demolition",t.job_type||"standard");n(b)}catch(b){console.error("Error loading man day costs:",b)}finally{o(!1)}},m=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),v=b=>new Date(b).toLocaleDateString("en-US",{month:"short",day:"numeric"}),y=b=>({foreman:"Foreman",supervisor:"Supervisor",operator:"Operator",laborer:"Laborer"})[b]||b.charAt(0).toUpperCase()+b.slice(1);if(s)return l.jsxs("div",{className:"man-day-costs card",children:[l.jsx("div",{className:"man-day-header",children:l.jsx("h3",{children:"Man Day Costs"})}),l.jsx("div",{className:"loading",children:"Loading..."})]});if(!a||a.totalManDays===0)return l.jsxs("div",{className:"man-day-costs card",children:[l.jsx("div",{className:"man-day-header",children:l.jsx("h3",{children:"Man Day Costs"})}),l.jsxs("div",{className:"man-day-empty",children:[l.jsx("span",{className:"empty-icon",children:l.jsx(Ui,{size:32})}),l.jsx("p",{children:"No crew check-ins yet"}),l.jsx("small",{children:"Costs will appear as crew checks in from the field"})]})]});const g=Object.entries(a.byRole||{});return l.jsxs("div",{className:"man-day-costs card",children:[l.jsxs("div",{className:"man-day-header",onClick:()=>f(!u),children:[l.jsxs("div",{className:"man-day-title-row",children:[l.jsx("h3",{children:"Man Day Costs"}),l.jsx("span",{className:"man-day-total",children:m(a.totalCost)})]}),l.jsx("button",{className:"man-day-toggle",children:u?" Collapse":" Details"})]}),l.jsxs("div",{className:"man-day-summary",children:[l.jsxs("div",{className:"man-day-stat",children:[l.jsx("span",{className:"stat-value",children:a.daysWorked}),l.jsx("span",{className:"stat-label",children:"Days Worked"})]}),l.jsxs("div",{className:"man-day-stat",children:[l.jsx("span",{className:"stat-value",children:a.totalManDays}),l.jsx("span",{className:"stat-label",children:"Total Man Days"})]}),l.jsxs("div",{className:"man-day-stat",children:[l.jsx("span",{className:"stat-value",children:m(a.totalCost)}),l.jsx("span",{className:"stat-label",children:"Total Labor Cost"})]}),l.jsxs("div",{className:"man-day-stat",children:[l.jsx("span",{className:"stat-value",children:a.daysWorked>0?m(a.totalCost/a.daysWorked):"$0"}),l.jsx("span",{className:"stat-label",children:"Avg Cost/Day"})]})]}),u&&l.jsxs("div",{className:"man-day-details",children:[g.length>0&&l.jsxs("div",{className:"man-day-section",children:[l.jsx("h4",{children:"By Role"}),l.jsx("div",{className:"man-day-role-list",children:g.map(([b,_])=>l.jsxs("div",{className:"man-day-role-row",children:[l.jsxs("div",{className:"role-info",children:[l.jsx("span",{className:"role-name",children:y(b)}),l.jsxs("span",{className:"role-rate",children:[m(_.rate),"/day"]})]}),l.jsxs("div",{className:"role-stats",children:[l.jsxs("span",{className:"role-count",children:[_.count," days"]}),l.jsx("span",{className:"role-cost",children:m(_.cost)})]})]},b))})]}),a.byDate?.length>0&&l.jsxs("div",{className:"man-day-section",children:[l.jsx("h4",{children:"Recent Activity"}),l.jsx("div",{className:"man-day-date-list",children:a.byDate.slice(0,7).map((b,_)=>l.jsxs("div",{className:"man-day-date-row",children:[l.jsx("span",{className:"date-label",children:v(b.date)}),l.jsxs("span",{className:"date-workers",children:[b.workers," crew"]}),l.jsx("span",{className:"date-cost",children:m(b.cost)})]},_))}),a.byDate.length>7&&l.jsxs("p",{className:"man-day-more",children:["+ ",a.byDate.length-7," more days"]})]})]})]})}const Ii=t=>((t||0)/100).toFixed(2),Gt=t=>{const e=(t||0)/100;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)},ic=t=>Math.round((parseFloat(t)||0)*100),nu=t=>((t||0)/100).toFixed(2),Sn=t=>`${nu(t)}%`,Ju=t=>Math.round((parseFloat(t)||0)*100),kH=(t,e,r,a)=>{const n=parseFloat(t)||0,s=parseFloat(e)||0,o=parseInt(r)||0,u=parseInt(a)||0,f=Math.round(n*o),h=Math.round(s*u),m=f+h;return{regularTotal:f,overtimeTotal:h,total:m}},CS=(t,e)=>{const r=parseFloat(t)||0,a=parseInt(e)||0;return Math.round(r*a)},wp=(t,e)=>{const r=parseInt(t)||0,a=parseInt(e)||0;return Math.round(r*a/1e4)},Uv=(t,e)=>{const r=parseInt(t)||0,a=parseInt(e)||0;return Math.round(r*a/1e4)},w1=t=>{const e=(t.change_order_labor||[]).reduce((_,S)=>_+(parseInt(S.total)||0),0),r=(t.change_order_materials||[]).reduce((_,S)=>_+(parseInt(S.total)||0),0),a=(t.change_order_equipment||[]).reduce((_,S)=>_+(parseInt(S.total)||0),0),n=(t.change_order_subcontractors||[]).reduce((_,S)=>_+(parseInt(S.total)||0),0),s=wp(e,t.labor_markup_percent||1500),o=wp(r,t.materials_markup_percent||1500),u=wp(a,t.equipment_markup_percent||1500),f=wp(n,t.subcontractors_markup_percent||500),h=e+r+a+n+s+o+u+f,m=Uv(h,t.liability_insurance_percent||144),v=Uv(h,t.bond_percent||100),y=Uv(h,t.license_fee_percent||10),g=m+v+y,b=h+g;return{labor_subtotal:e,materials_subtotal:r,equipment_subtotal:a,subcontractors_subtotal:n,labor_markup_amount:s,materials_markup_amount:o,equipment_markup_amount:u,subcontractors_markup_amount:f,liability_insurance_amount:m,bond_amount:v,license_fee_amount:y,additional_fees_total:g,cor_subtotal:h,cor_total:b}},qv=t=>{const e=[];if(t.title?.trim()||e.push("Title is required"),t.scope_of_work?.trim()||e.push("Scope of work is required"),t.period_start||e.push("Start date is required"),t.period_end||e.push("End date is required"),t.period_start&&t.period_end){const f=new Date(t.period_start);new Date(t.period_end)<f&&e.push("End date must be after start date")}const r=(t.change_order_labor||[]).length>0,a=(t.change_order_materials||[]).length>0,n=(t.change_order_equipment||[]).length>0,s=(t.change_order_subcontractors||[]).length>0;!r&&!a&&!n&&!s&&e.push("At least one line item (labor, materials, equipment, or subcontractor) is required"),w1(t).cor_total<=0&&e.push("COR total must be greater than zero");const u=5e3;return t.labor_markup_percent>u&&e.push("Labor markup percentage seems too high (>50%)"),t.materials_markup_percent>u&&e.push("Materials markup percentage seems too high (>50%)"),t.equipment_markup_percent>u&&e.push("Equipment markup percentage seems too high (>50%)"),t.subcontractors_markup_percent>u&&e.push("Subcontractors markup percentage seems too high (>50%)"),{valid:e.length===0,errors:e}},oj=t=>{const e={draft:{label:"Draft",color:"#6b7280",bgColor:"#f3f4f6"},pending_approval:{label:"Pending Approval",color:"#d97706",bgColor:"#fef3c7"},approved:{label:"Approved",color:"#059669",bgColor:"#d1fae5"},rejected:{label:"Rejected",color:"#dc2626",bgColor:"#fee2e2"},billed:{label:"Billed",color:"#2563eb",bgColor:"#dbeafe"},closed:{label:"Closed",color:"#4b5563",bgColor:"#e5e7eb"}};return e[t]||e.draft},uu=t=>t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",qx=(t,e)=>{const r=uu(t),a=uu(e);return r&&a?`${r} - ${a}`:r||a||""},Zu={labor_markup:1500,materials_markup:1500,equipment_markup:1500,subcontractors_markup:500,liability_insurance:144,bond:100,license_fee:10},TS=["Foreman","Superintendent","Operator","Laborer"],jH=[{value:"standard",label:"Standard"},{value:"pla",label:"PLA (Project Labor Agreement)"},{value:"prevailing",label:"Prevailing Wage"}],zv={materials:[{value:"backup_sheet",label:"Backup Sheet"},{value:"invoice",label:"Invoice"},{value:"mobilization",label:"Mobilization"},{value:"custom",label:"Custom Entry"}],equipment:[{value:"backup_sheet",label:"Backup Sheet"},{value:"invoice",label:"Invoice"},{value:"custom",label:"Custom Entry"}],subcontractors:[{value:"invoice",label:"Invoice"},{value:"quote",label:"Quote"},{value:"custom",label:"Custom Entry"}]},OS=["each","day","week","month","hour","sqft","lf","gallon","pound","ton","cy","lump sum"];function EH({project:t,company:e,areas:r,onShowToast:a,onCreateCOR:n,onViewCOR:s,onEditCOR:o}){const[u,f]=se.useState([]),[h,m]=se.useState(!0),[v,y]=se.useState("all"),[g,b]=se.useState("all"),[_,S]=se.useState(null),[E,C]=se.useState(new Set),[j,R]=se.useState("recent"),[H,Y]=se.useState(new Set),[U,V]=se.useState({start:"",end:""}),[F,X]=se.useState(null);se.useEffect(()=>{P(),O();const M=ut.subscribeToCORs?.(t.id,()=>{P(),O()});return()=>{M&&ut.unsubscribe?.(M)}},[t.id]);const P=async()=>{try{const M=await ut.getCORs(t.id);f(M||[])}catch(M){console.error("Error loading CORs:",M),a?.("Error loading change order requests","error")}finally{m(!1)}},O=async()=>{try{const M=await ut.getCORStats?.(t.id);X(M)}catch(M){console.error("Error loading COR stats:",M)}},I=async(M,A)=>{if(A?.stopPropagation(),!!confirm("Are you sure you want to delete this COR? This action cannot be undone."))try{await ut.deleteCOR(M),f(u.filter(D=>D.id!==M)),a?.("COR deleted","success"),O()}catch(D){console.error("Error deleting COR:",D),a?.("Error deleting COR","error")}},W=async(M,A)=>{A?.stopPropagation();try{await ut.submitCORForApproval(M),await P(),a?.("COR submitted for approval","success"),O()}catch(D){console.error("Error submitting COR:",D?.message||D),a?.(D?.message||"Error submitting COR","error")}},ne=se.useMemo(()=>{let M=[...u];if(v!=="all"&&(M=M.filter(A=>A.status===v)),g!=="all"&&(M=M.filter(A=>A.area_id===g)),U.start){const A=new Date(U.start);A.setHours(0,0,0,0),M=M.filter(D=>new Date(D.created_at)>=A)}if(U.end){const A=new Date(U.end);A.setHours(23,59,59,999),M=M.filter(D=>new Date(D.created_at)<=A)}if(j==="recent"){const A=new Date;A.setDate(A.getDate()-7),A.setHours(0,0,0,0),M=M.filter(D=>new Date(D.created_at)>=A)}return M.sort((A,D)=>new Date(D.created_at)-new Date(A.created_at)),M},[u,v,g,j,U]),Q=se.useMemo(()=>{if(j!=="all")return null;const M={};return ne.forEach(A=>{const D=new Date(A.created_at),B=`${D.getFullYear()}-${String(D.getMonth()+1).padStart(2,"0")}`,q=D.toLocaleDateString("en-US",{month:"long",year:"numeric"});M[B]||(M[B]={label:q,cors:[],totalAmount:0}),M[B].cors.push(A),M[B].totalAmount+=A.cor_total||0}),Object.entries(M).sort((A,D)=>D[0].localeCompare(A[0]))},[ne,j]);se.useEffect(()=>{if(Q&&Q.length>0){const M=Q[0][0];Y(new Set([M]))}},[Q]);const le=M=>{const A=new Set(H);A.has(M)?A.delete(M):A.add(M),Y(A)},ee=se.useMemo(()=>({all:u.length,draft:u.filter(M=>M.status==="draft").length,pending_approval:u.filter(M=>M.status==="pending_approval").length,approved:u.filter(M=>M.status==="approved").length,rejected:u.filter(M=>M.status==="rejected").length,billed:u.filter(M=>M.status==="billed").length,closed:u.filter(M=>M.status==="closed").length}),[u]);v==="all"?u.length:u.filter(M=>M.status===v).length;const K=M=>r?.find(D=>D.id===M)?.name||"No Area",ue=M=>{const A=oj(M.status);M.id;const D=M.status==="draft",B=M.status==="draft",q=M.status==="draft";return l.jsxs("div",{className:`cor-card ${M.status}`,onClick:()=>s?.(M),onKeyDown:Z=>{(Z.key==="Enter"||Z.key===" ")&&(Z.preventDefault(),s?.(M))},tabIndex:0,role:"button","aria-label":`View COR ${M.cor_number}: ${M.title||"Untitled"}, ${A.label}, ${Gt(M.cor_total||0)}`,children:[l.jsxs("div",{className:"cor-card-header",children:[l.jsxs("div",{className:"cor-card-left",children:[l.jsx("span",{className:"cor-number",children:M.cor_number}),l.jsx("span",{className:"cor-status-badge",style:{backgroundColor:A.bgColor,color:A.color},children:A.label})]}),l.jsx("div",{className:"cor-card-right",children:l.jsx("span",{className:"cor-total",children:Gt(M.cor_total||0)})})]}),l.jsxs("div",{className:"cor-card-body",children:[l.jsx("h4",{className:"cor-title",children:M.title||"Untitled COR"}),l.jsxs("div",{className:"cor-meta",children:[M.area_id&&l.jsx("span",{className:"cor-area",children:K(M.area_id)}),l.jsx("span",{className:"cor-period",children:qx(M.period_start,M.period_end)})]})]}),l.jsxs("div",{className:"cor-card-footer",children:[l.jsx("span",{className:"cor-created",children:uu(M.created_at)}),l.jsxs("div",{className:"cor-actions",onClick:Z=>Z.stopPropagation(),children:[q&&l.jsx("button",{className:"cor-action-btn submit",onClick:Z=>W(M.id,Z),title:"Submit for Approval","aria-label":`Submit COR ${M.cor_number} for approval`,children:l.jsx(q4,{size:14,"aria-hidden":"true"})}),D&&l.jsx("button",{className:"cor-action-btn edit",onClick:Z=>{Z.stopPropagation(),o?.(M)},title:"Edit","aria-label":`Edit COR ${M.cor_number}`,children:l.jsx(G2,{size:14,"aria-hidden":"true"})}),l.jsx("button",{className:"cor-action-btn view",onClick:Z=>{Z.stopPropagation(),s?.(M)},title:"View Details","aria-label":`View COR ${M.cor_number} details`,children:l.jsx(qC,{size:14,"aria-hidden":"true"})}),B&&l.jsx("button",{className:"cor-action-btn delete",onClick:Z=>I(M.id,Z),title:"Delete","aria-label":`Delete COR ${M.cor_number}`,children:l.jsx(cf,{size:14,"aria-hidden":"true"})})]})]})]},M.id)};return h?l.jsx("div",{className:"loading",children:"Loading change order requests..."}):l.jsxs("div",{className:"cor-list",children:[l.jsxs("div",{className:"cor-list-header",children:[l.jsxs("div",{className:"cor-list-info",children:[l.jsx("h3",{children:"Change Orders"}),l.jsxs("div",{className:"cor-stats-inline",children:[l.jsxs("span",{className:"cor-stat-item",children:[ee.all," total"]}),ee.pending_approval>0&&l.jsxs("span",{className:"cor-stat-item pending",children:[ee.pending_approval," pending"]}),F?.totalApproved>0&&l.jsx("span",{className:"cor-stat-item approved",children:Gt(F.totalApproved)})]})]}),l.jsxs("button",{className:"btn btn-primary btn-small",onClick:n,children:[l.jsx(Sl,{size:14})," New COR"]})]}),l.jsxs("div",{className:"cor-controls",children:[l.jsx("div",{className:"cor-filter-pills",role:"tablist",children:[{id:"all",label:"All"},{id:"draft",label:"Draft"},{id:"pending_approval",label:"Pending"},{id:"approved",label:"Approved"}].map(M=>l.jsxs("button",{role:"tab","aria-selected":v===M.id,className:`cor-pill ${v===M.id?"active":""}`,onClick:()=>y(M.id),children:[M.label,ee[M.id]>0&&l.jsx("span",{className:"cor-pill-count",children:ee[M.id]})]},M.id))}),l.jsxs("div",{className:"cor-view-toggle",children:[l.jsx("button",{className:`cor-toggle-btn ${j==="recent"?"active":""}`,onClick:()=>{R("recent"),V({start:"",end:""})},children:"Recent"}),l.jsx("button",{className:`cor-toggle-btn ${j==="all"?"active":""}`,onClick:()=>R("all"),children:"All"})]})]}),j==="all"&&l.jsxs("div",{className:"cor-date-filter",children:[l.jsx(q0,{size:14}),l.jsx("input",{type:"date",value:U.start,onChange:M=>V(A=>({...A,start:M.target.value}))}),l.jsx("span",{className:"cor-date-sep",children:"to"}),l.jsx("input",{type:"date",value:U.end,onChange:M=>V(A=>({...A,end:M.target.value}))}),(U.start||U.end)&&l.jsx("button",{className:"cor-clear-btn",onClick:()=>V({start:"",end:""}),children:"Clear"})]}),ne.length===0?l.jsxs("div",{className:"cor-empty",children:[l.jsx(hc,{size:24,className:"cor-empty-icon"}),l.jsxs("p",{children:["No change orders ",v!=="all"?`(${v.replace("_"," ")})`:""]}),l.jsxs("button",{className:"btn btn-primary btn-small",onClick:n,children:[l.jsx(Sl,{size:14})," Create COR"]})]}):l.jsx("div",{className:"cor-cards",children:j==="all"&&Q?Q.map(([M,A])=>l.jsxs("div",{className:"cor-month-group",children:[l.jsxs("button",{className:"cor-month-header",onClick:()=>le(M),children:[l.jsxs("div",{className:"cor-month-left",children:[H.has(M)?l.jsx(ld,{size:16}):l.jsx(jf,{size:16}),l.jsx("span",{children:A.label}),l.jsx("span",{className:"cor-month-count",children:A.cors.length})]}),l.jsx("span",{className:"cor-month-total",children:Gt(A.totalAmount)})]}),H.has(M)&&l.jsx("div",{className:"cor-month-items",children:A.cors.map(D=>ue(D))})]},M)):ne.map(M=>ue(M))})]})}function AH({projectId:t,corId:e,onImport:r,onClose:a,onShowToast:n}){const[s,o]=se.useState([]),[u,f]=se.useState(!0),[h,m]=se.useState(new Set),[v,y]=se.useState(null),[g,b]=se.useState(""),[_,S]=se.useState("unassigned");se.useEffect(()=>{E()},[t]);const E=async()=>{try{const V=await ut.getTMTickets(t);o(V||[])}catch(V){console.error("Error loading tickets:",V),n?.("Error loading tickets","error")}finally{f(!1)}},C=se.useMemo(()=>{let V=[...s];if(_==="unassigned"?V=V.filter(F=>!F.assigned_cor_id):_==="approved"&&(V=V.filter(F=>F.status==="approved")),g){const F=g.toLowerCase();V=V.filter(X=>X.work_description?.toLowerCase().includes(F)||X.ce_pco_number?.toLowerCase().includes(F)||X.ticket_date?.includes(F))}return V.sort((F,X)=>new Date(X.ticket_date)-new Date(F.ticket_date)),V},[s,_,g]),j=V=>{const F=new Set(h);F.has(V)?F.delete(V):F.add(V),m(F)},R=()=>{h.size===C.length?m(new Set):m(new Set(C.map(V=>V.id)))},H=V=>new Date(V).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),Y=V=>{const F=V.workers?.length||0,X=V.items?.length||0,P=V.materials_equipment?.filter(I=>I.type==="equipment")?.length||0;let O=0;return V.workers?.forEach(I=>{O+=(parseFloat(I.regular_hours)||0)+(parseFloat(I.overtime_hours)||0)}),{workerCount:F,itemCount:X,equipmentCount:P,laborHours:O}},U=()=>{if(h.size===0){n?.("Please select at least one ticket","error");return}const V=s.filter(O=>h.has(O.id)),F=[],X=[],P=[];V.forEach(O=>{O.workers?.forEach(I=>{F.push({id:`import-${O.id}-${I.id||Date.now()}`,labor_class:I.role||"Laborer",wage_type:"standard",regular_hours:parseFloat(I.regular_hours)||0,overtime_hours:parseFloat(I.overtime_hours)||0,regular_rate:0,overtime_rate:0,total:0,source_ticket_id:O.id,source_ticket_date:O.ticket_date})}),O.items?.forEach(I=>{X.push({id:`import-${O.id}-${I.id||Date.now()}`,description:I.description||I.name,source_type:"backup_sheet",source_reference:`Ticket ${H(O.ticket_date)}`,quantity:parseFloat(I.quantity)||1,unit:I.unit||"each",unit_cost:ic(I.unit_cost||0),total:ic((I.quantity||1)*(I.unit_cost||0)),source_ticket_id:O.id})}),O.materials_equipment?.filter(I=>I.type==="equipment").forEach(I=>{P.push({id:`import-${O.id}-${I.id||Date.now()}`,description:I.description||I.name,source_type:"backup_sheet",source_reference:`Ticket ${H(O.ticket_date)}`,quantity:parseFloat(I.quantity)||1,unit:I.unit||"day",unit_cost:ic(I.unit_cost||I.cost||0),total:ic((I.quantity||1)*(I.unit_cost||I.cost||0)),source_ticket_id:O.id})})}),r?.({ticketIds:Array.from(h),laborItems:F,materialsItems:X,equipmentItems:P}),a?.()};return u?l.jsx("div",{className:"modal-overlay",onClick:a,role:"dialog","aria-modal":"true","aria-label":"Loading tickets",children:l.jsx("div",{className:"modal-content ticket-selector-modal",onClick:V=>V.stopPropagation(),children:l.jsx("div",{className:"loading",role:"status","aria-live":"polite",children:"Loading tickets..."})})}):l.jsx("div",{className:"modal-overlay",onClick:a,role:"dialog","aria-modal":"true","aria-labelledby":"ticket-selector-title",children:l.jsxs("div",{className:"modal-content ticket-selector-modal",onClick:V=>V.stopPropagation(),children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("h2",{id:"ticket-selector-title",children:"Import from T&M Tickets"}),l.jsx("button",{className:"close-btn",onClick:a,"aria-label":"Close ticket selector",children:l.jsx(c1,{size:20,"aria-hidden":"true"})})]}),l.jsxs("div",{className:"ticket-selector-controls",children:[l.jsxs("div",{className:"ticket-search",children:[l.jsx(hT,{size:16,"aria-hidden":"true"}),l.jsx("input",{type:"text",placeholder:"Search tickets...",value:g,onChange:V=>b(V.target.value),"aria-label":"Search tickets"})]}),l.jsxs("div",{className:"ticket-filters",role:"group","aria-label":"Filter tickets by status",children:[l.jsx("button",{className:`filter-btn ${_==="unassigned"?"active":""}`,onClick:()=>S("unassigned"),"aria-pressed":_==="unassigned",children:"Unassigned"}),l.jsx("button",{className:`filter-btn ${_==="approved"?"active":""}`,onClick:()=>S("approved"),"aria-pressed":_==="approved",children:"Approved"}),l.jsx("button",{className:`filter-btn ${_==="all"?"active":""}`,onClick:()=>S("all"),"aria-pressed":_==="all",children:"All"})]})]}),l.jsxs("div",{className:"ticket-selector-header",children:[l.jsxs("label",{className:"select-all",children:[l.jsx("input",{type:"checkbox",checked:h.size===C.length&&C.length>0,onChange:R,"aria-label":`Select all ${C.length} tickets`}),l.jsxs("span",{children:["Select All (",C.length,")"]})]}),l.jsxs("span",{className:"selected-count",children:[h.size," selected"]})]}),l.jsx("div",{className:"modal-body ticket-selector-body",children:C.length===0?l.jsxs("div",{className:"ticket-empty",children:[l.jsx(hc,{size:32}),l.jsx("p",{children:"No tickets found"}),_==="unassigned"&&l.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>S("all"),children:"Show all tickets"})]}):l.jsx("div",{className:"ticket-list",children:C.map(V=>{const F=Y(V),X=h.has(V.id),P=v===V.id;return l.jsxs("div",{className:`ticket-item ${X?"selected":""} ${V.assigned_cor_id?"assigned":""}`,children:[l.jsxs("div",{className:"ticket-item-main",children:[l.jsx("label",{className:"ticket-checkbox",children:l.jsx("input",{type:"checkbox",checked:X,onChange:()=>j(V.id),disabled:V.assigned_cor_id&&V.assigned_cor_id!==e})}),l.jsxs("div",{className:"ticket-item-info",onClick:()=>y(P?null:V.id),children:[l.jsxs("div",{className:"ticket-item-header",children:[l.jsx("span",{className:"ticket-date",children:H(V.ticket_date)}),l.jsx("span",{className:`ticket-status ${V.status}`,children:V.status}),V.ce_pco_number&&l.jsxs("span",{className:"ticket-pco",children:["CE/PCO: ",V.ce_pco_number]})]}),l.jsx("div",{className:"ticket-item-desc",children:V.work_description||"No description"}),l.jsxs("div",{className:"ticket-item-summary",children:[F.workerCount>0&&l.jsxs("span",{children:[l.jsx(z4,{size:12})," ",F.workerCount," workers"]}),F.itemCount>0&&l.jsxs("span",{children:[l.jsx(Ef,{size:12})," ",F.itemCount," items"]}),F.equipmentCount>0&&l.jsxs("span",{children:[l.jsx(l1,{size:12})," ",F.equipmentCount," equipment"]}),F.laborHours>0&&l.jsxs("span",{children:[F.laborHours," hrs"]})]})]}),l.jsx("button",{className:"ticket-expand-btn",onClick:()=>y(P?null:V.id),children:P?l.jsx(ld,{size:16}):l.jsx(jf,{size:16})})]}),P&&l.jsxs("div",{className:"ticket-item-details",children:[V.workers?.length>0&&l.jsxs("div",{className:"ticket-detail-section",children:[l.jsx("h5",{children:"Workers"}),l.jsx("ul",{children:V.workers.map((O,I)=>l.jsxs("li",{children:[O.name||O.role," - ",O.regular_hours||0," reg hrs",O.overtime_hours>0&&`, ${O.overtime_hours} OT hrs`]},I))})]}),V.items?.length>0&&l.jsxs("div",{className:"ticket-detail-section",children:[l.jsx("h5",{children:"Materials"}),l.jsx("ul",{children:V.items.map((O,I)=>l.jsxs("li",{children:[O.description||O.name," - ",O.quantity," ",O.unit]},I))})]}),V.materials_equipment?.filter(O=>O.type==="equipment").length>0&&l.jsxs("div",{className:"ticket-detail-section",children:[l.jsx("h5",{children:"Equipment"}),l.jsx("ul",{children:V.materials_equipment.filter(O=>O.type==="equipment").map((O,I)=>l.jsx("li",{children:O.description||O.name},I))})]})]})]},V.id)})})}),l.jsxs("div",{className:"modal-footer",children:[l.jsx("button",{className:"btn btn-secondary",onClick:a,children:"Cancel"}),l.jsxs("button",{className:"btn btn-primary",onClick:U,disabled:h.size===0,children:[l.jsx(M4,{size:16})," Import ",h.size," Ticket",h.size!==1?"s":""]})]})]})})}const Sp=[{id:1,label:"Title & Info",shortLabel:"Info"},{id:2,label:"Period",shortLabel:"Period"},{id:3,label:"Labor",shortLabel:"Labor"},{id:4,label:"Materials",shortLabel:"Materials"},{id:5,label:"Equipment",shortLabel:"Equipment"},{id:6,label:"Subcontractors",shortLabel:"Subs"},{id:7,label:"Markups & Fees",shortLabel:"Markups"},{id:8,label:"Summary",shortLabel:"Summary"},{id:9,label:"Submit",shortLabel:"Submit"}];function CH({project:t,company:e,areas:r,existingCOR:a,onClose:n,onSaved:s,onShowToast:o}){const[u,f]=se.useState(1),[h,m]=se.useState(!1),[v,y]=se.useState([]),[g,b]=se.useState(!1),[_,S]=se.useState(a?.title||""),[E,C]=se.useState(a?.scope_of_work||""),[j,R]=se.useState(a?.area_id||""),[H,Y]=se.useState(a?.cor_number||""),[U,V]=se.useState(a?.period_start||""),[F,X]=se.useState(a?.period_end||""),[P,O]=se.useState(a?.change_order_labor||[]),[I,W]=se.useState(a?.change_order_materials||[]),[ne,Q]=se.useState(a?.change_order_equipment||[]),[le,ee]=se.useState(a?.change_order_subcontractors||[]),[K,ue]=se.useState(a?.labor_markup_percent??Zu.labor_markup),[M,A]=se.useState(a?.materials_markup_percent??Zu.materials_markup),[D,B]=se.useState(a?.equipment_markup_percent??Zu.equipment_markup),[q,Z]=se.useState(a?.subcontractors_markup_percent??Zu.subcontractors_markup),[oe,pe]=se.useState(a?.liability_insurance_percent??Zu.liability_insurance),[_e,be]=se.useState(a?.bond_percent??Zu.bond),[Le,he]=se.useState(a?.license_fee_percent??Zu.license_fee);se.useEffect(()=>{Ae(),a||re()},[]);const Ae=async()=>{try{const ve=await ut.getLaborRates?.(e?.id,t?.work_type,t?.job_type);y(ve||[])}catch(ve){console.error("Error loading labor rates:",ve)}},de=ve=>{const Ue=ve?.toLowerCase()||"";return v.find(Be=>Be.role?.toLowerCase()===Ue)||null},re=async()=>{try{const ve=await ut.getNextCORNumber?.(t.id);Y(ve||`COR-${Date.now()}`)}catch(ve){console.error("Error generating COR number:",ve),Y(`COR-${Date.now()}`)}},Ke=se.useMemo(()=>({title:_,scope_of_work:E,area_id:j||null,cor_number:H,period_start:U,period_end:F,change_order_labor:P,change_order_materials:I,change_order_equipment:ne,change_order_subcontractors:le,labor_markup_percent:K,materials_markup_percent:M,equipment_markup_percent:D,subcontractors_markup_percent:q,liability_insurance_percent:oe,bond_percent:_e,license_fee_percent:Le}),[_,E,j,H,U,F,P,I,ne,le,K,M,D,q,oe,_e,Le]),Oe=se.useMemo(()=>w1(Ke),[Ke]),rt=ve=>{switch(ve){case 1:return _.trim()?E.trim()?!0:(o?.("Scope of work is required","error"),!1):(o?.("Title is required","error"),!1);case 2:return U?F?new Date(F)<new Date(U)?(o?.("End date must be after start date","error"),!1):!0:(o?.("End date is required","error"),!1):(o?.("Start date is required","error"),!1);default:return!0}},tt=()=>{rt(u)&&f(Math.min(u+1,Sp.length))},Et=()=>{f(Math.max(u-1,1))},kt=ve=>{if(ve<u)f(ve);else if(ve>u){for(let Ue=u;Ue<ve;Ue++)if(!rt(Ue))return;f(ve)}},zt=()=>{const ve=TS[0],Ue=de(ve);O([...P,{id:`temp-${Date.now()}`,labor_class:ve,wage_type:"standard",regular_hours:0,overtime_hours:0,regular_rate:Ue?Math.round((parseFloat(Ue.regular_rate)||0)*100):0,overtime_rate:Ue?Math.round((parseFloat(Ue.overtime_rate)||0)*100):0,total:0}])},Tt=(ve,Ue,Be)=>{const Rt=[...P];if(Rt[ve]={...Rt[ve],[Ue]:Be},Ue==="labor_class"){const Kt=de(Be);Kt&&(Rt[ve].regular_rate=Math.round((parseFloat(Kt.regular_rate)||0)*100),Rt[ve].overtime_rate=Math.round((parseFloat(Kt.overtime_rate)||0)*100))}const{total:Ht}=kH(Rt[ve].regular_hours,Rt[ve].overtime_hours,Rt[ve].regular_rate,Rt[ve].overtime_rate);Rt[ve].total=Ht,O(Rt)},at=ve=>{O(P.filter((Ue,Be)=>Be!==ve))},pt=()=>{W([...I,{id:`temp-${Date.now()}`,description:"",source_type:"backup_sheet",source_reference:"",quantity:1,unit:"each",unit_cost:0,total:0}])},At=(ve,Ue,Be)=>{const Rt=[...I];Rt[ve]={...Rt[ve],[Ue]:Be},Rt[ve].total=CS(Rt[ve].quantity,Rt[ve].unit_cost),W(Rt)},Dt=ve=>{W(I.filter((Ue,Be)=>Be!==ve))},xt=()=>{Q([...ne,{id:`temp-${Date.now()}`,description:"",source_type:"backup_sheet",source_reference:"",quantity:1,unit:"day",unit_cost:0,total:0}])},St=(ve,Ue,Be)=>{const Rt=[...ne];Rt[ve]={...Rt[ve],[Ue]:Be},Rt[ve].total=CS(Rt[ve].quantity,Rt[ve].unit_cost),Q(Rt)},ft=ve=>{Q(ne.filter((Ue,Be)=>Be!==ve))},yt=()=>{ee([...le,{id:`temp-${Date.now()}`,company_name:"",description:"",source_type:"invoice",source_reference:"",amount:0,total:0}])},er=(ve,Ue,Be)=>{const Rt=[...le];Rt[ve]={...Rt[ve],[Ue]:Be},Ue==="amount"&&(Rt[ve].total=parseInt(Be)||0),ee(Rt)},Lt=ve=>{ee(le.filter((Ue,Be)=>Be!==ve))},Bt=ve=>{ve.laborItems?.length>0&&O([...P,...ve.laborItems]),ve.materialsItems?.length>0&&W([...I,...ve.materialsItems]),ve.equipmentItems?.length>0&&Q([...ne,...ve.equipmentItems]),o?.(`Imported data from ${ve.ticketIds.length} ticket(s)`,"success")},we=async()=>{m(!0);try{const ve={company_id:e.id,project_id:t.id,...Ke,...Oe,status:"draft"};let Ue;a?.id?Ue=await ut.updateCOR(a.id,ve):Ue=await ut.createCOR(ve),Ue?.id&&await ut.saveCORLineItems(Ue.id,{laborItems:P,materialItems:I,equipmentItems:ne,subcontractorItems:le}),o?.("COR saved as draft","success"),s?.(Ue),n?.()}catch(ve){console.error("Error saving COR:",ve),o?.("Error saving COR","error")}finally{m(!1)}},Ie=async()=>{const ve=qv(Ke);if(!ve.valid){o?.(ve.errors[0],"error");return}m(!0);try{const Ue={company_id:e.id,project_id:t.id,...Ke,...Oe,status:"pending_approval"};let Be;a?.id?(Be=await ut.updateCOR(a.id,{...Ue,status:"draft"}),await ut.saveCORLineItems(a.id,{laborItems:P,materialItems:I,equipmentItems:ne,subcontractorItems:le}),await ut.submitCORForApproval(a.id)):(Be=await ut.createCOR({...Ue,status:"draft"}),Be?.id&&(await ut.saveCORLineItems(Be.id,{laborItems:P,materialItems:I,equipmentItems:ne,subcontractorItems:le}),await ut.submitCORForApproval(Be.id))),o?.("COR submitted for approval","success"),s?.(Be),n?.()}catch(Ue){console.error("Error submitting COR:",Ue),o?.("Error submitting COR","error")}finally{m(!1)}};return l.jsxs("div",{className:"modal-overlay",onClick:n,children:[l.jsxs("div",{className:"modal-content cor-form-modal",onClick:ve=>ve.stopPropagation(),children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("h2",{children:a?"Edit Change Order Request":"New Change Order Request"}),l.jsx("button",{className:"close-btn",onClick:n,children:l.jsx(c1,{size:20})})]}),l.jsx("div",{className:"cor-progress-steps",children:Sp.map(ve=>l.jsxs("div",{className:`cor-step ${u>=ve.id?"active":""} ${u===ve.id?"current":""}`,onClick:()=>kt(ve.id),children:[l.jsx("span",{className:"cor-step-number",children:ve.id}),l.jsx("span",{className:"cor-step-label",children:ve.shortLabel})]},ve.id))}),l.jsxs("div",{className:"modal-body cor-form-body",children:[u===1&&l.jsxs("div",{className:"cor-form-step",children:[l.jsx("h3",{children:"Basic Information"}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"COR Number"}),l.jsx("input",{type:"text",value:H,onChange:ve=>Y(ve.target.value),placeholder:"Auto-generated",className:"input-readonly",readOnly:!0})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Title *"}),l.jsx("input",{type:"text",value:_,onChange:ve=>S(ve.target.value),placeholder:"e.g., Additional Demolition Work - Building A"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Scope of Work *"}),l.jsx("textarea",{value:E,onChange:ve=>C(ve.target.value),rows:4,placeholder:"Describe the scope of work covered by this change order..."})]}),r&&r.length>0&&l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Work Area (Optional)"}),l.jsxs("select",{value:j,onChange:ve=>R(ve.target.value),children:[l.jsx("option",{value:"",children:"No specific area"}),r.map(ve=>l.jsx("option",{value:ve.id,children:ve.name},ve.id))]})]})]}),u===2&&l.jsxs("div",{className:"cor-form-step",children:[l.jsx("h3",{children:"Work Period"}),l.jsx("p",{className:"step-description",children:"Specify the date range for this change order work."}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Start Date *"}),l.jsx("input",{type:"date",value:U,onChange:ve=>V(ve.target.value)})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"End Date *"}),l.jsx("input",{type:"date",value:F,onChange:ve=>X(ve.target.value),min:U})]})]})]}),u===3&&l.jsxs("div",{className:"cor-form-step",children:[l.jsxs("div",{className:"step-header",children:[l.jsxs("div",{children:[l.jsx("h3",{children:"Labor"}),l.jsx("p",{className:"step-description",children:"Add labor costs for this change order."})]}),l.jsxs("div",{className:"step-header-actions",children:[l.jsxs("button",{className:"btn btn-ghost",onClick:()=>b(!0),children:[l.jsx(hc,{size:16})," Import from Tickets"]}),l.jsxs("button",{className:"btn btn-secondary",onClick:zt,children:[l.jsx(Sl,{size:16})," Add Labor"]})]})]}),P.length===0?l.jsxs("div",{className:"empty-items",children:[l.jsx("p",{children:"No labor items added yet."}),l.jsxs("button",{className:"btn btn-primary",onClick:zt,children:[l.jsx(Sl,{size:16})," Add First Labor Item"]})]}):l.jsx("div",{className:"line-items-list",children:P.map((ve,Ue)=>l.jsxs("div",{className:"line-item labor-item",children:[l.jsxs("div",{className:"line-item-header",children:[l.jsxs("span",{className:"line-item-number",children:["#",Ue+1]}),l.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>at(Ue),children:l.jsx(cf,{size:14})})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Labor Class"}),l.jsx("select",{value:ve.labor_class,onChange:Be=>Tt(Ue,"labor_class",Be.target.value),children:TS.map(Be=>l.jsx("option",{value:Be,children:Be},Be))})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Wage Type"}),l.jsx("select",{value:ve.wage_type,onChange:Be=>Tt(Ue,"wage_type",Be.target.value),children:jH.map(Be=>l.jsx("option",{value:Be.value,children:Be.label},Be.value))})]})]}),l.jsxs("div",{className:"form-row four-col",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Reg Hours"}),l.jsx("input",{type:"number",step:"0.5",min:"0",value:ve.regular_hours,onChange:Be=>Tt(Ue,"regular_hours",Be.target.value)})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Reg Rate ($/hr)"}),l.jsx("input",{type:"number",step:"0.01",min:"0",value:Ii(ve.regular_rate),onChange:Be=>Tt(Ue,"regular_rate",ic(Be.target.value))})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"OT Hours"}),l.jsx("input",{type:"number",step:"0.5",min:"0",value:ve.overtime_hours,onChange:Be=>Tt(Ue,"overtime_hours",Be.target.value)})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"OT Rate ($/hr)"}),l.jsx("input",{type:"number",step:"0.01",min:"0",value:Ii(ve.overtime_rate),onChange:Be=>Tt(Ue,"overtime_rate",ic(Be.target.value))})]})]}),l.jsxs("div",{className:"line-item-total",children:["Total: ",l.jsx("strong",{children:Gt(ve.total)})]})]},ve.id||Ue))}),l.jsxs("div",{className:"section-subtotal",children:["Labor Subtotal: ",l.jsx("strong",{children:Gt(Oe.labor_subtotal)})]})]}),u===4&&l.jsxs("div",{className:"cor-form-step",children:[l.jsxs("div",{className:"step-header",children:[l.jsxs("div",{children:[l.jsx("h3",{children:"Materials"}),l.jsx("p",{className:"step-description",children:"Add material costs for this change order."})]}),l.jsxs("button",{className:"btn btn-secondary",onClick:pt,children:[l.jsx(Sl,{size:16})," Add Material"]})]}),I.length===0?l.jsxs("div",{className:"empty-items",children:[l.jsx("p",{children:"No materials added yet."}),l.jsxs("button",{className:"btn btn-primary",onClick:pt,children:[l.jsx(Sl,{size:16})," Add First Material"]})]}):l.jsx("div",{className:"line-items-list",children:I.map((ve,Ue)=>l.jsxs("div",{className:"line-item",children:[l.jsxs("div",{className:"line-item-header",children:[l.jsxs("span",{className:"line-item-number",children:["#",Ue+1]}),l.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>Dt(Ue),children:l.jsx(cf,{size:14})})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Description"}),l.jsx("input",{type:"text",value:ve.description,onChange:Be=>At(Ue,"description",Be.target.value),placeholder:"Material description"})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Source"}),l.jsx("select",{value:ve.source_type,onChange:Be=>At(Ue,"source_type",Be.target.value),children:zv.materials.map(Be=>l.jsx("option",{value:Be.value,children:Be.label},Be.value))})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Reference"}),l.jsx("input",{type:"text",value:ve.source_reference,onChange:Be=>At(Ue,"source_reference",Be.target.value),placeholder:"Ticket #, Invoice #"})]})]}),l.jsxs("div",{className:"form-row three-col",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Quantity"}),l.jsx("input",{type:"number",step:"0.01",min:"0",value:ve.quantity,onChange:Be=>At(Ue,"quantity",Be.target.value)})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Unit"}),l.jsx("select",{value:ve.unit,onChange:Be=>At(Ue,"unit",Be.target.value),children:OS.map(Be=>l.jsx("option",{value:Be,children:Be},Be))})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Unit Cost ($)"}),l.jsx("input",{type:"number",step:"0.01",min:"0",value:Ii(ve.unit_cost),onChange:Be=>At(Ue,"unit_cost",ic(Be.target.value))})]})]}),l.jsxs("div",{className:"line-item-total",children:["Total: ",l.jsx("strong",{children:Gt(ve.total)})]})]},ve.id||Ue))}),l.jsxs("div",{className:"section-subtotal",children:["Materials Subtotal: ",l.jsx("strong",{children:Gt(Oe.materials_subtotal)})]})]}),u===5&&l.jsxs("div",{className:"cor-form-step",children:[l.jsxs("div",{className:"step-header",children:[l.jsxs("div",{children:[l.jsx("h3",{children:"Equipment"}),l.jsx("p",{className:"step-description",children:"Add equipment rental costs for this change order."})]}),l.jsxs("button",{className:"btn btn-secondary",onClick:xt,children:[l.jsx(Sl,{size:16})," Add Equipment"]})]}),ne.length===0?l.jsxs("div",{className:"empty-items",children:[l.jsx("p",{children:"No equipment added yet."}),l.jsxs("button",{className:"btn btn-primary",onClick:xt,children:[l.jsx(Sl,{size:16})," Add First Equipment"]})]}):l.jsx("div",{className:"line-items-list",children:ne.map((ve,Ue)=>l.jsxs("div",{className:"line-item",children:[l.jsxs("div",{className:"line-item-header",children:[l.jsxs("span",{className:"line-item-number",children:["#",Ue+1]}),l.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>ft(Ue),children:l.jsx(cf,{size:14})})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Description"}),l.jsx("input",{type:"text",value:ve.description,onChange:Be=>St(Ue,"description",Be.target.value),placeholder:"Equipment description"})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Source"}),l.jsx("select",{value:ve.source_type,onChange:Be=>St(Ue,"source_type",Be.target.value),children:zv.equipment.map(Be=>l.jsx("option",{value:Be.value,children:Be.label},Be.value))})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Reference"}),l.jsx("input",{type:"text",value:ve.source_reference,onChange:Be=>St(Ue,"source_reference",Be.target.value),placeholder:"Ticket #, Invoice #"})]})]}),l.jsxs("div",{className:"form-row three-col",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Quantity"}),l.jsx("input",{type:"number",step:"0.01",min:"0",value:ve.quantity,onChange:Be=>St(Ue,"quantity",Be.target.value)})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Unit"}),l.jsx("select",{value:ve.unit,onChange:Be=>St(Ue,"unit",Be.target.value),children:OS.map(Be=>l.jsx("option",{value:Be,children:Be},Be))})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Unit Cost ($)"}),l.jsx("input",{type:"number",step:"0.01",min:"0",value:Ii(ve.unit_cost),onChange:Be=>St(Ue,"unit_cost",ic(Be.target.value))})]})]}),l.jsxs("div",{className:"line-item-total",children:["Total: ",l.jsx("strong",{children:Gt(ve.total)})]})]},ve.id||Ue))}),l.jsxs("div",{className:"section-subtotal",children:["Equipment Subtotal: ",l.jsx("strong",{children:Gt(Oe.equipment_subtotal)})]})]}),u===6&&l.jsxs("div",{className:"cor-form-step",children:[l.jsxs("div",{className:"step-header",children:[l.jsxs("div",{children:[l.jsx("h3",{children:"Subcontractors"}),l.jsx("p",{className:"step-description",children:"Add subcontractor costs for this change order."})]}),l.jsxs("button",{className:"btn btn-secondary",onClick:yt,children:[l.jsx(Sl,{size:16})," Add Subcontractor"]})]}),le.length===0?l.jsxs("div",{className:"empty-items",children:[l.jsx("p",{children:"No subcontractors added yet."}),l.jsxs("button",{className:"btn btn-primary",onClick:yt,children:[l.jsx(Sl,{size:16})," Add First Subcontractor"]})]}):l.jsx("div",{className:"line-items-list",children:le.map((ve,Ue)=>l.jsxs("div",{className:"line-item",children:[l.jsxs("div",{className:"line-item-header",children:[l.jsxs("span",{className:"line-item-number",children:["#",Ue+1]}),l.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>Lt(Ue),children:l.jsx(cf,{size:14})})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Company Name"}),l.jsx("input",{type:"text",value:ve.company_name,onChange:Be=>er(Ue,"company_name",Be.target.value),placeholder:"Subcontractor company name"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Description of Work"}),l.jsx("input",{type:"text",value:ve.description,onChange:Be=>er(Ue,"description",Be.target.value),placeholder:"Work performed"})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Source"}),l.jsx("select",{value:ve.source_type,onChange:Be=>er(Ue,"source_type",Be.target.value),children:zv.subcontractors.map(Be=>l.jsx("option",{value:Be.value,children:Be.label},Be.value))})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Reference"}),l.jsx("input",{type:"text",value:ve.source_reference,onChange:Be=>er(Ue,"source_reference",Be.target.value),placeholder:"Invoice #, Quote #"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Amount ($)"}),l.jsx("input",{type:"number",step:"0.01",min:"0",value:Ii(ve.amount),onChange:Be=>er(Ue,"amount",ic(Be.target.value))})]})]}),l.jsxs("div",{className:"line-item-total",children:["Total: ",l.jsx("strong",{children:Gt(ve.total)})]})]},ve.id||Ue))}),l.jsxs("div",{className:"section-subtotal",children:["Subcontractors Subtotal: ",l.jsx("strong",{children:Gt(Oe.subcontractors_subtotal)})]})]}),u===7&&l.jsxs("div",{className:"cor-form-step",children:[l.jsx("h3",{children:"Markups & Fees"}),l.jsx("p",{className:"step-description",children:"Configure markup percentages and additional fees."}),l.jsxs("div",{className:"markups-section",children:[l.jsx("h4",{children:"Markups"}),l.jsxs("div",{className:"markups-grid",children:[l.jsxs("div",{className:"markup-item",children:[l.jsx("label",{children:"Labor Markup"}),l.jsxs("div",{className:"markup-input",children:[l.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:nu(K),onChange:ve=>ue(Ju(ve.target.value))}),l.jsx("span",{children:"%"})]}),l.jsxs("span",{className:"markup-amount",children:["+",Gt(Oe.labor_markup_amount)]})]}),l.jsxs("div",{className:"markup-item",children:[l.jsx("label",{children:"Materials Markup"}),l.jsxs("div",{className:"markup-input",children:[l.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:nu(M),onChange:ve=>A(Ju(ve.target.value))}),l.jsx("span",{children:"%"})]}),l.jsxs("span",{className:"markup-amount",children:["+",Gt(Oe.materials_markup_amount)]})]}),l.jsxs("div",{className:"markup-item",children:[l.jsx("label",{children:"Equipment Markup"}),l.jsxs("div",{className:"markup-input",children:[l.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:nu(D),onChange:ve=>B(Ju(ve.target.value))}),l.jsx("span",{children:"%"})]}),l.jsxs("span",{className:"markup-amount",children:["+",Gt(Oe.equipment_markup_amount)]})]}),l.jsxs("div",{className:"markup-item",children:[l.jsx("label",{children:"Subcontractors Markup"}),l.jsxs("div",{className:"markup-input",children:[l.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:nu(q),onChange:ve=>Z(Ju(ve.target.value))}),l.jsx("span",{children:"%"})]}),l.jsxs("span",{className:"markup-amount",children:["+",Gt(Oe.subcontractors_markup_amount)]})]})]})]}),l.jsxs("div",{className:"fees-section",children:[l.jsx("h4",{children:"Additional Fees"}),l.jsxs("div",{className:"fees-grid",children:[l.jsxs("div",{className:"fee-item",children:[l.jsx("label",{children:"Liability Insurance"}),l.jsxs("div",{className:"fee-input",children:[l.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:nu(oe),onChange:ve=>pe(Ju(ve.target.value))}),l.jsx("span",{children:"%"})]}),l.jsxs("span",{className:"fee-amount",children:["+",Gt(Oe.liability_insurance_amount)]})]}),l.jsxs("div",{className:"fee-item",children:[l.jsx("label",{children:"Bond"}),l.jsxs("div",{className:"fee-input",children:[l.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:nu(_e),onChange:ve=>be(Ju(ve.target.value))}),l.jsx("span",{children:"%"})]}),l.jsxs("span",{className:"fee-amount",children:["+",Gt(Oe.bond_amount)]})]}),l.jsxs("div",{className:"fee-item",children:[l.jsx("label",{children:"City License Fee"}),l.jsxs("div",{className:"fee-input",children:[l.jsx("input",{type:"number",step:"0.001",min:"0",max:"100",value:nu(Le),onChange:ve=>he(Ju(ve.target.value))}),l.jsx("span",{children:"%"})]}),l.jsxs("span",{className:"fee-amount",children:["+",Gt(Oe.license_fee_amount)]})]})]})]})]}),u===8&&l.jsxs("div",{className:"cor-form-step",children:[l.jsx("h3",{children:"Summary"}),l.jsxs("div",{className:"cor-summary",children:[l.jsxs("div",{className:"summary-header",children:[l.jsx("div",{className:"summary-title",children:_||"Untitled COR"}),l.jsx("div",{className:"summary-number",children:H})]}),l.jsxs("div",{className:"summary-section",children:[l.jsx("h4",{children:"Costs Breakdown"}),l.jsxs("div",{className:"summary-line",children:[l.jsxs("span",{children:["Labor (",P.length," items)"]}),l.jsx("span",{children:Gt(Oe.labor_subtotal)})]}),l.jsxs("div",{className:"summary-line indent",children:[l.jsxs("span",{children:["+ Markup (",Sn(K),")"]}),l.jsx("span",{children:Gt(Oe.labor_markup_amount)})]}),l.jsxs("div",{className:"summary-line",children:[l.jsxs("span",{children:["Materials (",I.length," items)"]}),l.jsx("span",{children:Gt(Oe.materials_subtotal)})]}),l.jsxs("div",{className:"summary-line indent",children:[l.jsxs("span",{children:["+ Markup (",Sn(M),")"]}),l.jsx("span",{children:Gt(Oe.materials_markup_amount)})]}),l.jsxs("div",{className:"summary-line",children:[l.jsxs("span",{children:["Equipment (",ne.length," items)"]}),l.jsx("span",{children:Gt(Oe.equipment_subtotal)})]}),l.jsxs("div",{className:"summary-line indent",children:[l.jsxs("span",{children:["+ Markup (",Sn(D),")"]}),l.jsx("span",{children:Gt(Oe.equipment_markup_amount)})]}),l.jsxs("div",{className:"summary-line",children:[l.jsxs("span",{children:["Subcontractors (",le.length," items)"]}),l.jsx("span",{children:Gt(Oe.subcontractors_subtotal)})]}),l.jsxs("div",{className:"summary-line indent",children:[l.jsxs("span",{children:["+ Markup (",Sn(q),")"]}),l.jsx("span",{children:Gt(Oe.subcontractors_markup_amount)})]})]}),l.jsxs("div",{className:"summary-subtotal",children:[l.jsx("span",{children:"COR Subtotal"}),l.jsx("span",{children:Gt(Oe.cor_subtotal)})]}),l.jsxs("div",{className:"summary-section",children:[l.jsx("h4",{children:"Additional Fees"}),l.jsxs("div",{className:"summary-line",children:[l.jsxs("span",{children:["Liability Insurance (",Sn(oe),")"]}),l.jsx("span",{children:Gt(Oe.liability_insurance_amount)})]}),l.jsxs("div",{className:"summary-line",children:[l.jsxs("span",{children:["Bond (",Sn(_e),")"]}),l.jsx("span",{children:Gt(Oe.bond_amount)})]}),l.jsxs("div",{className:"summary-line",children:[l.jsxs("span",{children:["City License Fee (",Sn(Le),")"]}),l.jsx("span",{children:Gt(Oe.license_fee_amount)})]})]}),l.jsxs("div",{className:"summary-total",children:[l.jsx("span",{children:"COR Total"}),l.jsx("span",{children:Gt(Oe.cor_total)})]})]})]}),u===9&&l.jsxs("div",{className:"cor-form-step",children:[l.jsx("h3",{children:"Submit Change Order Request"}),l.jsxs("div",{className:"submit-preview",children:[l.jsxs("div",{className:"preview-card",children:[l.jsxs("div",{className:"preview-header",children:[l.jsx("span",{className:"preview-number",children:H}),l.jsx("span",{className:"preview-total",children:Gt(Oe.cor_total)})]}),l.jsx("div",{className:"preview-title",children:_}),l.jsx("div",{className:"preview-scope",children:E})]}),(()=>{const ve=qv(Ke);return ve.valid?l.jsx("div",{className:"validation-success",children:"Ready to submit for approval!"}):l.jsxs("div",{className:"validation-errors",children:[l.jsx(V2,{size:20}),l.jsxs("div",{children:[l.jsx("strong",{children:"Please fix the following issues:"}),l.jsx("ul",{children:ve.errors.map((Ue,Be)=>l.jsx("li",{children:Ue},Be))})]})]})})(),l.jsxs("div",{className:"submit-actions",children:[l.jsxs("button",{className:"btn btn-secondary",onClick:we,disabled:h,children:[l.jsx(Gb,{size:16})," Save as Draft"]}),l.jsxs("button",{className:"btn btn-primary",onClick:Ie,disabled:h||!qv(Ke).valid,children:[l.jsx(q4,{size:16})," Submit for Approval"]})]})]})]})]}),l.jsxs("div",{className:"modal-footer cor-form-footer",children:[l.jsx("div",{className:"footer-left",children:u>1&&l.jsxs("button",{className:"btn btn-secondary",onClick:Et,disabled:h,children:[l.jsx(CC,{size:16})," Back"]})}),l.jsx("div",{className:"footer-center",children:l.jsxs("span",{className:"step-indicator",children:["Step ",u," of ",Sp.length]})}),l.jsxs("div",{className:"footer-right",children:[u<Sp.length&&l.jsxs("button",{className:"btn btn-primary",onClick:tt,disabled:h,children:["Next ",l.jsx(jf,{size:16})]}),u>1&&u<9&&l.jsxs("button",{className:"btn btn-ghost",onClick:we,disabled:h,children:[l.jsx(Gb,{size:14})," Save Draft"]})]})]})]}),g&&l.jsx(AH,{projectId:t.id,corId:a?.id,onImport:Bt,onClose:()=>b(!1),onShowToast:o})]})}const TH=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},OH=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});async function RH(t,e,r,a={}){const n=new sr,s=n.internal.pageSize.getWidth(),o=n.internal.pageSize.getHeight(),u=20;let f=u;const h=w1(t),m=a.primaryColor?TH(a.primaryColor):[30,58,138],v=[241,245,249];let y=null;if(a.logoUrl)try{y=await OH(a.logoUrl)}catch(H){console.error("Error loading logo:",H)}if(y)try{n.addImage(y,"PNG",u,f,40,15),f+=20}catch{n.setFontSize(16),n.setFont("helvetica","bold"),n.setTextColor(...m),n.text(r?.name||"Company Name",u,f+10),f+=20}else n.setFontSize(16),n.setFont("helvetica","bold"),n.setTextColor(...m),n.text(r?.name||"Company Name",u,f+10),f+=20;n.setFontSize(20),n.setFont("helvetica","bold"),n.setTextColor(0,0,0),n.text("CHANGE ORDER REQUEST",u,f),f+=10,n.setFontSize(12),n.setFont("helvetica","normal"),n.setTextColor(100,100,100),n.text(t.cor_number||"COR-XXXX",u,f);const g=t.status?.replace("_"," ").toUpperCase()||"DRAFT";n.setTextColor(...m),n.text(g,s-u-n.getTextWidth(g),f),f+=12,n.setDrawColor(...m),n.setLineWidth(.5),n.line(u,f,s-u,f),f+=10,n.setFontSize(10),n.setTextColor(0,0,0);const b=u,_=s/2;n.setFont("helvetica","bold"),n.text("Project:",b,f),n.setFont("helvetica","normal"),n.text(e?.name||"Project Name",b+25,f),n.setFont("helvetica","bold"),n.text("Job #:",_,f),n.setFont("helvetica","normal"),n.text(e?.job_number||"N/A",_+25,f),f+=6,n.setFont("helvetica","bold"),n.text("Period:",b,f),n.setFont("helvetica","normal"),n.text(qx(t.period_start,t.period_end),b+25,f),n.setFont("helvetica","bold"),n.text("Date:",_,f),n.setFont("helvetica","normal"),n.text(uu(t.created_at),_+25,f),f+=10,n.setFont("helvetica","bold"),n.setFontSize(12),n.text(t.title||"Untitled Change Order",u,f),f+=8,n.setFont("helvetica","normal"),n.setFontSize(10),n.setTextColor(80,80,80);const S=n.splitTextToSize(t.scope_of_work||"No scope of work provided.",s-u*2);n.text(S,u,f),f+=S.length*5+10,t.change_order_labor?.length>0&&(n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("LABOR",u,f),f+=6,$h(n,{startY:f,head:[["Class","Type","Reg Hrs","Reg Rate","OT Hrs","OT Rate","Total"]],body:t.change_order_labor.map(H=>[H.labor_class,H.wage_type,H.regular_hours.toString(),`$${Ii(H.regular_rate)}/hr`,H.overtime_hours?.toString()||"-",H.overtime_hours?`$${Ii(H.overtime_rate)}/hr`:"-",Gt(H.total)]),foot:[[{content:`Subtotal: ${Gt(h.labor_subtotal)}`,colSpan:5,styles:{halign:"right",fontStyle:"bold"}},{content:`+${Sn(t.labor_markup_percent||1500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Gt(h.labor_subtotal+h.labor_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:u,right:u},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),f=n.lastAutoTable.finalY+10),t.change_order_materials?.length>0&&(f>o-80&&(n.addPage(),f=u),n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("MATERIALS",u,f),f+=6,$h(n,{startY:f,head:[["Description","Source","Qty","Unit","Unit Cost","Total"]],body:t.change_order_materials.map(H=>[H.description,H.source_reference||H.source_type,H.quantity.toString(),H.unit,`$${Ii(H.unit_cost)}`,Gt(H.total)]),foot:[[{content:`Subtotal: ${Gt(h.materials_subtotal)}`,colSpan:4,styles:{halign:"right",fontStyle:"bold"}},{content:`+${Sn(t.materials_markup_percent||1500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Gt(h.materials_subtotal+h.materials_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:u,right:u},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),f=n.lastAutoTable.finalY+10),t.change_order_equipment?.length>0&&(f>o-80&&(n.addPage(),f=u),n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("EQUIPMENT",u,f),f+=6,$h(n,{startY:f,head:[["Description","Source","Qty","Unit","Unit Cost","Total"]],body:t.change_order_equipment.map(H=>[H.description,H.source_reference||H.source_type,H.quantity.toString(),H.unit,`$${Ii(H.unit_cost)}`,Gt(H.total)]),foot:[[{content:`Subtotal: ${Gt(h.equipment_subtotal)}`,colSpan:4,styles:{halign:"right",fontStyle:"bold"}},{content:`+${Sn(t.equipment_markup_percent||1500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Gt(h.equipment_subtotal+h.equipment_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:u,right:u},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),f=n.lastAutoTable.finalY+10),t.change_order_subcontractors?.length>0&&(f>o-80&&(n.addPage(),f=u),n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("SUBCONTRACTORS",u,f),f+=6,$h(n,{startY:f,head:[["Company","Description","Source","Amount"]],body:t.change_order_subcontractors.map(H=>[H.company_name,H.description,H.source_reference||H.source_type,Gt(H.total)]),foot:[[{content:`Subtotal: ${Gt(h.subcontractors_subtotal)}`,colSpan:2,styles:{halign:"right",fontStyle:"bold"}},{content:`+${Sn(t.subcontractors_markup_percent||500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Gt(h.subcontractors_subtotal+h.subcontractors_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:u,right:u},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),f=n.lastAutoTable.finalY+10),f>o-100&&(n.addPage(),f=u),n.setFillColor(...v),n.roundedRect(u,f,s-u*2,70,3,3,"F"),f+=10,n.setFontSize(10),n.setFont("helvetica","normal"),n.setTextColor(0,0,0);const E=u+10,C=s-u-60;if(n.text("COR Subtotal:",E,f),n.setFont("helvetica","bold"),n.text(Gt(h.cor_subtotal),C,f,{align:"right"}),f+=8,n.setFont("helvetica","normal"),n.setFontSize(9),n.text(`Liability Insurance (${Sn(t.liability_insurance_percent||144)}):`,E,f),n.text(Gt(h.liability_insurance_amount),C,f,{align:"right"}),f+=6,n.text(`Bond (${Sn(t.bond_percent||100)}):`,E,f),n.text(Gt(h.bond_amount),C,f,{align:"right"}),f+=6,n.text(`City License Fee (${Sn(t.license_fee_percent||10)}):`,E,f),n.text(Gt(h.license_fee_amount),C,f,{align:"right"}),f+=10,n.setFillColor(...m),n.roundedRect(E-5,f-3,s-u*2-10,16,2,2,"F"),n.setTextColor(255,255,255),n.setFontSize(12),n.setFont("helvetica","bold"),n.text("COR TOTAL:",E,f+8),n.text(Gt(h.cor_total),C,f+8,{align:"right"}),f+=25,f>o-80&&(n.addPage(),f=u),f+=10,n.setTextColor(0,0,0),n.setFontSize(10),n.setFont("helvetica","bold"),n.text("APPROVAL",u,f),f+=10,n.setFont("helvetica","normal"),n.setFontSize(9),n.setDrawColor(0,0,0),n.line(u,f+15,u+70,f+15),n.text("GC Signature",u,f+22),n.line(u+90,f+15,u+150,f+15),n.text("Date",u+90,f+22),t.gc_signature)try{n.addImage(t.gc_signature,"PNG",u,f-5,60,20),n.text(t.gc_signer_name||"",u,f+28),n.text(uu(t.signed_at),u+90,f+10)}catch(H){console.error("Error adding signature:",H)}const j=o-10;n.setFontSize(8),n.setTextColor(150,150,150),n.text(`Generated on ${new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`,u,j),n.text("Page 1",s-u,j,{align:"right"});const R=`${t.cor_number||"COR"}_${e?.job_number||"export"}.pdf`;n.save(R)}function DH({onSave:t,onClose:e,signerName:r=""}){const a=se.useRef(null),[n,s]=se.useState(r),[o,u]=se.useState(!1),[f,h]=se.useState(!1),m=()=>{const C=a.current;return C?C.getContext("2d"):null},v=C=>{const j=a.current;if(!j)return{x:0,y:0};const R=j.getBoundingClientRect(),H=j.width/R.width,Y=j.height/R.height,U=C.touches?C.touches[0].clientX:C.clientX,V=C.touches?C.touches[0].clientY:C.clientY;return{x:(U-R.left)*H,y:(V-R.top)*Y}},y=C=>{C.preventDefault();const j=m();if(!j)return;const{x:R,y:H}=v(C);j.beginPath(),j.moveTo(R,H),h(!0),u(!0)},g=C=>{if(!f)return;C.preventDefault();const j=m();if(!j)return;const{x:R,y:H}=v(C);j.lineTo(R,H),j.stroke()},b=()=>{h(!1)},_=()=>{const C=a.current,j=m();!C||!j||(j.clearRect(0,0,C.width,C.height),u(!1))},S=C=>{if(!C)return;a.current=C;const j=C.getContext("2d");j.strokeStyle="#1e293b",j.lineWidth=2,j.lineCap="round",j.lineJoin="round"},E=()=>{if(!o||!n.trim())return;const C=a.current;if(!C)return;const j=C.toDataURL("image/png");t({signature:j,signerName:n.trim(),signedAt:new Date().toISOString()})};return l.jsx("div",{className:"modal-overlay",onClick:e,role:"dialog","aria-modal":"true","aria-labelledby":"signature-title",children:l.jsxs("div",{className:"modal-content signature-modal",onClick:C=>C.stopPropagation(),children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("h2",{id:"signature-title",children:"GC Signature"}),l.jsx("button",{className:"close-btn",onClick:e,"aria-label":"Close signature modal",children:l.jsx(c1,{size:20,"aria-hidden":"true"})})]}),l.jsxs("div",{className:"modal-body signature-body",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"signer-name",children:"Signer Name *"}),l.jsx("input",{id:"signer-name",type:"text",value:n,onChange:C=>s(C.target.value),placeholder:"Enter full name","aria-required":"true"})]}),l.jsxs("div",{className:"signature-area",children:[l.jsxs("div",{className:"signature-label",id:"signature-instructions",children:[l.jsx(tT,{size:16,"aria-hidden":"true"}),l.jsx("span",{children:"Sign below"})]}),l.jsxs("div",{className:"signature-canvas-container",children:[l.jsx("canvas",{ref:S,width:500,height:200,className:"signature-canvas",onMouseDown:y,onMouseMove:g,onMouseUp:b,onMouseLeave:b,onTouchStart:y,onTouchMove:g,onTouchEnd:b,role:"img","aria-label":"Signature drawing area. Use mouse or touch to draw your signature.","aria-describedby":"signature-instructions",tabIndex:0}),!o&&l.jsx("div",{className:"signature-placeholder",children:"Sign here"})]}),l.jsxs("button",{className:"btn btn-ghost btn-small",onClick:_,disabled:!o,"aria-label":"Clear signature",children:[l.jsx(cT,{size:14,"aria-hidden":"true"})," Clear"]})]}),l.jsx("p",{className:"signature-legal",role:"note",children:"By signing above, I acknowledge that I have reviewed and approve this Change Order Request."})]}),l.jsxs("div",{className:"modal-footer",children:[l.jsx("button",{className:"btn btn-secondary",onClick:e,"aria-label":"Cancel and close",children:"Cancel"}),l.jsxs("button",{className:"btn btn-primary",onClick:E,disabled:!o||!n.trim(),"aria-label":"Save signature",children:[l.jsx(M4,{size:16,"aria-hidden":"true"})," Save Signature"]})]})]})})}function FH({cor:t,project:e,company:r,areas:a,onClose:n,onEdit:s,onShowToast:o,onStatusChange:u}){const[f,h]=se.useState(!0),[m,v]=se.useState(t),[y,g]=se.useState(!1);se.useEffect(()=>{(async()=>{try{const X=await ut.getCORById(t.id);X&&v(X)}catch(X){console.error("Error fetching COR details:",X),o?.("Error loading COR details","error")}finally{h(!1)}})()},[t.id]);const b=se.useMemo(()=>w1(m),[m]),_=oj(m.status),S=m.status==="pending_approval",E=m.status==="draft",C=F=>a?.find(P=>P.id===F)?.name||null,j=async()=>{if(confirm("Approve this change order request?")){h(!0);try{await ut.approveCOR(m.id),v({...m,status:"approved",approved_at:new Date().toISOString()}),o?.("COR approved","success"),u?.()}catch(F){console.error("Error approving COR:",F),o?.("Error approving COR","error")}finally{h(!1)}}},R=async()=>{const F=prompt("Enter rejection reason (optional):");if(F!==null){h(!0);try{await ut.rejectCOR(m.id,F),v({...m,status:"rejected",rejection_reason:F}),o?.("COR rejected","success"),u?.()}catch(X){console.error("Error rejecting COR:",X),o?.("Error rejecting COR","error")}finally{h(!1)}}},H=async()=>{if(confirm("Mark this COR as billed?")){h(!0);try{await ut.markCORAsBilled(m.id),v({...m,status:"billed"}),o?.("COR marked as billed","success"),u?.()}catch(F){console.error("Error marking COR as billed:",F),o?.("Error updating status","error")}finally{h(!1)}}},Y=async F=>{h(!0);try{await ut.saveCORSignature?.(m.id,{gc_signature:F.signature,gc_signer_name:F.signerName,signed_at:F.signedAt}),v({...m,gc_signature:F.signature,gc_signer_name:F.signerName,signed_at:F.signedAt}),g(!1),o?.("Signature saved","success"),u?.()}catch(X){console.error("Error saving signature:",X),o?.("Error saving signature","error")}finally{h(!1)}},U=m.status==="approved"&&!m.gc_signature,V=async()=>{try{o?.("Generating PDF...","info"),await RH(m,e,r),o?.("PDF downloaded","success")}catch(F){console.error("Error exporting PDF:",F),o?.("Error generating PDF","error")}};return f?l.jsx("div",{className:"modal-overlay",onClick:n,children:l.jsx("div",{className:"modal-content cor-detail-modal",onClick:F=>F.stopPropagation(),children:l.jsx("div",{className:"cor-detail-loading",children:"Loading COR details..."})})}):l.jsxs("div",{className:"modal-overlay",onClick:n,role:"dialog","aria-modal":"true","aria-labelledby":"cor-detail-title",children:[l.jsxs("div",{className:"modal-content cor-detail-modal",onClick:F=>F.stopPropagation(),children:[l.jsxs("div",{className:"modal-header cor-detail-header",children:[l.jsxs("div",{className:"cor-detail-title-row",children:[l.jsxs("div",{children:[l.jsx("div",{className:"cor-detail-number",children:m.cor_number}),l.jsx("h2",{id:"cor-detail-title",children:m.title||"Untitled COR"})]}),l.jsx("button",{className:"close-btn",onClick:n,"aria-label":"Close COR details",children:l.jsx(c1,{size:20,"aria-hidden":"true"})})]}),l.jsxs("div",{className:"cor-detail-meta",children:[l.jsx("span",{className:"cor-detail-status",style:{backgroundColor:_.bgColor,color:_.color},children:_.label}),C(m.area_id)&&l.jsx("span",{className:"cor-detail-area",children:C(m.area_id)}),l.jsxs("span",{className:"cor-detail-period",children:[l.jsx(PC,{size:14})," ",qx(m.period_start,m.period_end)]})]})]}),l.jsxs("div",{className:"modal-body cor-detail-body",children:[l.jsxs("div",{className:"cor-detail-section",children:[l.jsxs("h3",{children:[l.jsx(hc,{size:18})," Scope of Work"]}),l.jsx("p",{className:"cor-scope-text",children:m.scope_of_work||"No scope of work provided."})]}),l.jsxs("div",{className:"cor-detail-section pricing-breakdown",children:[l.jsxs("h3",{children:[l.jsx(Ip,{size:18})," Pricing Breakdown"]}),l.jsxs("div",{className:"pricing-category",children:[l.jsxs("div",{className:"category-header",children:[l.jsxs("div",{className:"category-title",children:[l.jsx(z4,{size:16}),l.jsx("span",{children:"Labor"})]}),l.jsx("span",{className:"category-subtotal",children:Gt(b.labor_subtotal)})]}),m.change_order_labor?.length>0?l.jsx("div",{className:"category-items",children:l.jsxs("table",{className:"pricing-table",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Class"}),l.jsx("th",{children:"Type"}),l.jsx("th",{children:"Reg Hrs"}),l.jsx("th",{children:"Reg Rate"}),l.jsx("th",{children:"OT Hrs"}),l.jsx("th",{children:"OT Rate"}),l.jsx("th",{className:"text-right",children:"Total"})]})}),l.jsx("tbody",{children:m.change_order_labor.map((F,X)=>l.jsxs("tr",{children:[l.jsx("td",{children:F.labor_class}),l.jsx("td",{children:F.wage_type}),l.jsx("td",{children:F.regular_hours}),l.jsxs("td",{children:["$",Ii(F.regular_rate),"/hr"]}),l.jsx("td",{children:F.overtime_hours||"-"}),l.jsx("td",{children:F.overtime_hours?`$${Ii(F.overtime_rate)}/hr`:"-"}),l.jsx("td",{className:"text-right",children:Gt(F.total)})]},X))})]})}):l.jsx("div",{className:"category-empty",children:"No labor items"}),l.jsxs("div",{className:"category-markup",children:[l.jsxs("span",{children:["Markup (",Sn(m.labor_markup_percent||1500),")"]}),l.jsxs("span",{children:["+",Gt(b.labor_markup_amount)]})]})]}),l.jsxs("div",{className:"pricing-category",children:[l.jsxs("div",{className:"category-header",children:[l.jsxs("div",{className:"category-title",children:[l.jsx(Ef,{size:16}),l.jsx("span",{children:"Materials"})]}),l.jsx("span",{className:"category-subtotal",children:Gt(b.materials_subtotal)})]}),m.change_order_materials?.length>0?l.jsx("div",{className:"category-items",children:l.jsxs("table",{className:"pricing-table",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Description"}),l.jsx("th",{children:"Source"}),l.jsx("th",{children:"Qty"}),l.jsx("th",{children:"Unit"}),l.jsx("th",{children:"Unit Cost"}),l.jsx("th",{className:"text-right",children:"Total"})]})}),l.jsx("tbody",{children:m.change_order_materials.map((F,X)=>l.jsxs("tr",{children:[l.jsx("td",{children:F.description}),l.jsx("td",{children:F.source_reference||F.source_type}),l.jsx("td",{children:F.quantity}),l.jsx("td",{children:F.unit}),l.jsxs("td",{children:["$",Ii(F.unit_cost)]}),l.jsx("td",{className:"text-right",children:Gt(F.total)})]},X))})]})}):l.jsx("div",{className:"category-empty",children:"No material items"}),l.jsxs("div",{className:"category-markup",children:[l.jsxs("span",{children:["Markup (",Sn(m.materials_markup_percent||1500),")"]}),l.jsxs("span",{children:["+",Gt(b.materials_markup_amount)]})]})]}),l.jsxs("div",{className:"pricing-category",children:[l.jsxs("div",{className:"category-header",children:[l.jsxs("div",{className:"category-title",children:[l.jsx(l1,{size:16}),l.jsx("span",{children:"Equipment"})]}),l.jsx("span",{className:"category-subtotal",children:Gt(b.equipment_subtotal)})]}),m.change_order_equipment?.length>0?l.jsx("div",{className:"category-items",children:l.jsxs("table",{className:"pricing-table",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Description"}),l.jsx("th",{children:"Source"}),l.jsx("th",{children:"Qty"}),l.jsx("th",{children:"Unit"}),l.jsx("th",{children:"Unit Cost"}),l.jsx("th",{className:"text-right",children:"Total"})]})}),l.jsx("tbody",{children:m.change_order_equipment.map((F,X)=>l.jsxs("tr",{children:[l.jsx("td",{children:F.description}),l.jsx("td",{children:F.source_reference||F.source_type}),l.jsx("td",{children:F.quantity}),l.jsx("td",{children:F.unit}),l.jsxs("td",{children:["$",Ii(F.unit_cost)]}),l.jsx("td",{className:"text-right",children:Gt(F.total)})]},X))})]})}):l.jsx("div",{className:"category-empty",children:"No equipment items"}),l.jsxs("div",{className:"category-markup",children:[l.jsxs("span",{children:["Markup (",Sn(m.equipment_markup_percent||1500),")"]}),l.jsxs("span",{children:["+",Gt(b.equipment_markup_amount)]})]})]}),l.jsxs("div",{className:"pricing-category",children:[l.jsxs("div",{className:"category-header",children:[l.jsxs("div",{className:"category-title",children:[l.jsx(S0,{size:16}),l.jsx("span",{children:"Subcontractors"})]}),l.jsx("span",{className:"category-subtotal",children:Gt(b.subcontractors_subtotal)})]}),m.change_order_subcontractors?.length>0?l.jsx("div",{className:"category-items",children:l.jsxs("table",{className:"pricing-table",children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"Company"}),l.jsx("th",{children:"Description"}),l.jsx("th",{children:"Source"}),l.jsx("th",{className:"text-right",children:"Amount"})]})}),l.jsx("tbody",{children:m.change_order_subcontractors.map((F,X)=>l.jsxs("tr",{children:[l.jsx("td",{children:F.company_name}),l.jsx("td",{children:F.description}),l.jsx("td",{children:F.source_reference||F.source_type}),l.jsx("td",{className:"text-right",children:Gt(F.total)})]},X))})]})}):l.jsx("div",{className:"category-empty",children:"No subcontractor items"}),l.jsxs("div",{className:"category-markup",children:[l.jsxs("span",{children:["Markup (",Sn(m.subcontractors_markup_percent||500),")"]}),l.jsxs("span",{children:["+",Gt(b.subcontractors_markup_amount)]})]})]}),l.jsxs("div",{className:"cor-subtotal-row",children:[l.jsx("span",{children:"COR Subtotal"}),l.jsx("span",{children:Gt(b.cor_subtotal)})]}),l.jsxs("div",{className:"pricing-category fees-category",children:[l.jsxs("div",{className:"category-header",children:[l.jsxs("div",{className:"category-title",children:[l.jsx(nT,{size:16}),l.jsx("span",{children:"Additional Fees"})]}),l.jsx("span",{className:"category-subtotal",children:Gt(b.additional_fees_total)})]}),l.jsxs("div",{className:"fees-list",children:[l.jsxs("div",{className:"fee-row",children:[l.jsxs("div",{className:"fee-label",children:[l.jsx(pT,{size:14}),l.jsxs("span",{children:["Liability Insurance (",Sn(m.liability_insurance_percent||144),")"]})]}),l.jsx("span",{className:"fee-amount",children:Gt(b.liability_insurance_amount)})]}),l.jsxs("div",{className:"fee-row",children:[l.jsxs("div",{className:"fee-label",children:[l.jsx(hc,{size:14}),l.jsxs("span",{children:["Bond (",Sn(m.bond_percent||100),")"]})]}),l.jsx("span",{className:"fee-amount",children:Gt(b.bond_amount)})]}),l.jsxs("div",{className:"fee-row",children:[l.jsxs("div",{className:"fee-label",children:[l.jsx(P4,{size:14}),l.jsxs("span",{children:["City License Fee (",Sn(m.license_fee_percent||10),")"]})]}),l.jsx("span",{className:"fee-amount",children:Gt(b.license_fee_amount)})]})]})]}),l.jsxs("div",{className:"cor-total-row",children:[l.jsx("span",{children:"COR TOTAL"}),l.jsx("span",{children:Gt(b.cor_total)})]})]}),m.gc_signature&&l.jsxs("div",{className:"cor-detail-section signature-section",children:[l.jsxs("h3",{children:[l.jsx(vT,{size:18})," GC Signature"]}),l.jsxs("div",{className:"signature-display",children:[l.jsx("img",{src:m.gc_signature,alt:"GC Signature",className:"signature-image"}),l.jsxs("div",{className:"signature-info",children:[l.jsx("span",{className:"signer-name",children:m.gc_signer_name}),l.jsxs("span",{className:"signed-date",children:["Signed: ",uu(m.signed_at)]})]})]})]}),m.status==="rejected"&&m.rejection_reason&&l.jsxs("div",{className:"cor-detail-section rejection-section",children:[l.jsxs("h3",{children:[l.jsx(Vb,{size:18})," Rejection Reason"]}),l.jsx("p",{className:"rejection-text",children:m.rejection_reason})]})]}),l.jsxs("div",{className:"modal-footer cor-detail-footer",children:[l.jsxs("div",{className:"footer-info",children:[l.jsxs("span",{children:["Created: ",uu(m.created_at)]}),m.approved_at&&l.jsxs("span",{children:["Approved: ",uu(m.approved_at)]})]}),l.jsxs("div",{className:"footer-actions",role:"group","aria-label":"COR actions",children:[E&&l.jsxs("button",{className:"btn btn-secondary",onClick:()=>s?.(m),disabled:f,"aria-label":"Edit this COR",children:[l.jsx(G2,{size:16,"aria-hidden":"true"})," Edit"]}),S&&l.jsxs(l.Fragment,{children:[l.jsxs("button",{className:"btn btn-danger",onClick:R,disabled:f,"aria-label":"Reject this COR",children:[l.jsx(Vb,{size:16,"aria-hidden":"true"})," Reject"]}),l.jsxs("button",{className:"btn btn-success",onClick:j,disabled:f,"aria-label":"Approve this COR",children:[l.jsx(I4,{size:16,"aria-hidden":"true"})," Approve"]})]}),U&&l.jsxs("button",{className:"btn btn-success",onClick:()=>g(!0),disabled:f,"aria-label":"Get GC signature for this COR",children:[l.jsx(QC,{size:16,"aria-hidden":"true"})," Get GC Signature"]}),m.status==="approved"&&l.jsxs("button",{className:"btn btn-primary",onClick:H,disabled:f,"aria-label":"Mark this COR as billed",children:[l.jsx(Ip,{size:16,"aria-hidden":"true"})," Mark Billed"]}),l.jsxs("button",{className:"btn btn-secondary",onClick:V,"aria-label":"Export COR to PDF",children:[l.jsx(BC,{size:16,"aria-hidden":"true"})," Export PDF"]})]})]})]}),y&&l.jsx(DH,{onSave:Y,onClose:()=>g(!1),signerName:""})]})}function LH({company:t,onShowToast:e,navigateToProjectId:r,onProjectNavigated:a}){const[n,s]=se.useState([]),[o,u]=se.useState([]),[f,h]=se.useState(null),[m,v]=se.useState([]),[y,g]=se.useState(!0),[b,_]=se.useState(!1),[S,E]=se.useState(null),[C,j]=se.useState(!1),[R,H]=se.useState(!1),[Y,U]=se.useState(!1),[V,F]=se.useState("overview"),[X,P]=se.useState([]),[O,I]=se.useState(!1),[W,ne]=se.useState(null),[Q,le]=se.useState(!1),[ee,K]=se.useState(null);se.useEffect(()=>{t?.id&&(M(),ue())},[t?.id]);const ue=async()=>{try{const at=await ut.getDumpSites(t.id);P(at||[])}catch(at){console.error("Error loading dump sites:",at)}};se.useEffect(()=>{if(r&&n.length>0){const at=n.find(pt=>pt.id===r);at&&(h(at),a?.())}},[r,n]),se.useEffect(()=>{if(f){A(f.id);const at=ut.subscribeToAreas(f.id,pt=>{A(f.id)});return()=>ut.unsubscribe(at)}},[f]);const M=async()=>{try{const at=await ut.getProjects(t?.id);s(at);const pt=await Promise.all(at.map(async At=>{const Dt=await ut.getAreas(At.id),xt=await ut.getTMTickets(At.id),St=await ut.getChangeOrderTotals(At.id),ft=await ut.getDailyReports(At.id,100),yt=await ut.getInjuryReports(At.id),er=await ut.getMaterialRequests(At.id),Lt=await ut.calculateManDayCosts(At.id,t?.id,At.work_type||"demolition",At.job_type||"standard"),Bt=await ut.calculateHaulOffCosts(At.id),we=l2(Dt),Ie=St?.totalApprovedValue||0,ve=At.contract_value+Ie,Ue=we/100*ve,Be=xt.filter(Kt=>Kt.status==="pending").length,Rt=new Date;Rt.setDate(Rt.getDate()-7);const Ht=ft.filter(Kt=>new Date(Kt.report_date)>=Rt).length;return{...At,areas:Dt,progress:we,billable:Ue,changeOrderValue:Ie,revisedContractValue:ve,changeOrderPending:St?.pendingCount||0,totalTickets:xt.length,pendingTickets:Be,approvedTickets:xt.filter(Kt=>Kt.status==="approved").length,dailyReportsCount:ft.length,recentDailyReports:Ht,injuryReportsCount:yt.length,lastDailyReport:ft[0]?.report_date||null,pendingMaterialRequests:er.filter(Kt=>Kt.status==="pending").length,totalMaterialRequests:er.length,laborCost:Lt?.totalCost||0,laborDaysWorked:Lt?.byDate?.length||0,laborManDays:Lt?.totalManDays||0,avgDailyBurn:Lt?.byDate?.length>0?Lt.totalCost/Lt.byDate.length:0,haulOffCost:Bt?.totalCost||0,haulOffLoads:Bt?.totalLoads||0,haulOffDays:Bt?.daysWithHaulOff||0,haulOffByType:Bt?.byWasteType||{},totalBurn:(Lt?.totalCost||0)+(Bt?.totalCost||0),totalBurnDays:Math.max(Lt?.byDate?.length||0,Bt?.daysWithHaulOff||0)}}));u(pt)}catch(at){console.error("Error loading projects:",at),e("Error loading projects","error")}finally{g(!1)}},A=async at=>{try{const pt=await ut.getAreas(at);v(pt)}catch(pt){console.error("Error loading areas:",pt)}},D=at=>{h(at)},B=()=>{h(null),v([]),_(!1),E(null),F("overview"),M()},q=()=>{E({name:f.name,job_number:f.job_number||"",address:f.address||"",general_contractor:f.general_contractor||"",client_contact:f.client_contact||"",client_phone:f.client_phone||"",contract_value:f.contract_value,work_type:f.work_type||"demolition",job_type:f.job_type||"standard",pin:f.pin||"",default_dump_site_id:f.default_dump_site_id||"",areas:m.map(at=>({id:at.id,name:at.name,weight:at.weight,isNew:!1}))}),_(!0)},Z=()=>{_(!1),E(null)},oe=(at,pt)=>{E(At=>({...At,[at]:pt}))},pe=(at,pt,At)=>{E(Dt=>({...Dt,areas:Dt.areas.map((xt,St)=>St===at?{...xt,[pt]:At}:xt)}))},_e=()=>{E(at=>({...at,areas:[...at.areas,{id:null,name:"",weight:"",isNew:!0}]}))},be=at=>{S.areas.length>1&&E(pt=>({...pt,areas:pt.areas.filter((At,Dt)=>Dt!==at)}))},Le=async()=>{if(!S.name.trim()){e("Please enter a project name","error");return}const at=parseFloat(S.contract_value);if(!at||at<=0){e("Please enter a valid contract value","error");return}if(S.pin&&S.pin.length!==4){e("PIN must be 4 digits","error");return}if(S.pin&&S.pin!==f.pin&&!await ut.isPinAvailable(S.pin,f.id)){e("This PIN is already in use","error");return}const pt=S.areas.filter(Dt=>Dt.name.trim()&&parseFloat(Dt.weight)>0);if(pt.length===0){e("Please add at least one area","error");return}if(pt.reduce((Dt,xt)=>Dt+parseFloat(xt.weight),0)!==100){e("Area weights must total 100%","error");return}j(!0);try{await ut.updateProject(f.id,{name:S.name.trim(),job_number:S.job_number?.trim()||null,address:S.address?.trim()||null,general_contractor:S.general_contractor?.trim()||null,client_contact:S.client_contact?.trim()||null,client_phone:S.client_phone?.trim()||null,contract_value:at,work_type:S.work_type||"demolition",job_type:S.job_type||"standard",pin:S.pin||null,default_dump_site_id:S.default_dump_site_id||null});const Dt=m.map(ft=>ft.id),xt=S.areas.filter(ft=>ft.id).map(ft=>ft.id);for(const ft of Dt)xt.includes(ft)||await ut.deleteArea(ft);for(let ft=0;ft<pt.length;ft++){const yt=pt[ft];yt.id?await ut.updateArea(yt.id,{name:yt.name.trim(),weight:parseFloat(yt.weight),sort_order:ft}):await ut.createArea({project_id:f.id,name:yt.name.trim(),weight:parseFloat(yt.weight),status:"not_started",sort_order:ft})}const St=await ut.getProject(f.id);h(St),await A(f.id),_(!1),E(null),e("Project updated!","success")}catch(Dt){console.error("Error saving project:",Dt?.message||Dt),e(Dt?.message||"Error saving changes","error")}finally{j(!1)}},he=async()=>{if(confirm("Are you sure you want to delete this project? This cannot be undone."))try{await ut.deleteProject(f.id),e("Project deleted","success"),B()}catch(at){console.error("Error deleting project:",at),e("Error deleting project","error")}};if(y)return l.jsxs("div",{className:"loading",children:[l.jsx("div",{className:"spinner"}),"Loading projects..."]});if(f){const at=l2(m),pt=o.find(we=>we.id===f.id),At=pt?.changeOrderValue||0,Dt=f.contract_value+At,xt=at/100*Dt;if(b&&S){const we=S.areas.reduce((Ie,ve)=>Ie+(parseFloat(ve.weight)||0),0);return l.jsxs("div",{children:[l.jsx("button",{className:"btn btn-secondary btn-small",onClick:Z,style:{marginBottom:"1.5rem"},children:" Cancel"}),l.jsx("h1",{children:"Edit Project"}),l.jsx("p",{className:"subtitle",children:"Update project details"}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{children:"Basic Info"}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",style:{flex:2},children:[l.jsx("label",{children:"Project Name *"}),l.jsx("input",{type:"text",value:S.name,onChange:Ie=>oe("name",Ie.target.value),placeholder:"e.g., Downtown Office Demolition"})]}),l.jsxs("div",{className:"form-group",style:{flex:1},children:[l.jsx("label",{children:"Job Number"}),l.jsx("input",{type:"text",value:S.job_number,onChange:Ie=>oe("job_number",Ie.target.value),placeholder:"e.g., 2024-001"})]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Project Address"}),l.jsx("input",{type:"text",value:S.address,onChange:Ie=>oe("address",Ie.target.value),placeholder:"123 Main St, City, State 12345"})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{children:"Client & Contractor"}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"General Contractor"}),l.jsx("input",{type:"text",value:S.general_contractor,onChange:Ie=>oe("general_contractor",Ie.target.value),placeholder:"e.g., ABC Construction"})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Client Contact"}),l.jsx("input",{type:"text",value:S.client_contact,onChange:Ie=>oe("client_contact",Ie.target.value),placeholder:"Contact name"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Client Phone"}),l.jsx("input",{type:"tel",value:S.client_phone,onChange:Ie=>oe("client_phone",Ie.target.value),placeholder:"(555) 123-4567"})]})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{children:"Financials & Settings"}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Contract Value ($) *"}),l.jsx("input",{type:"number",value:S.contract_value,onChange:Ie=>oe("contract_value",Ie.target.value),placeholder:"0"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Foreman PIN"}),l.jsx("input",{type:"text",value:S.pin,onChange:Ie=>oe("pin",Ie.target.value.replace(/\D/g,"").slice(0,4)),placeholder:"4 digits",maxLength:4}),l.jsx("span",{className:"form-hint",children:"Used for field crew access"})]})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Work Type"}),l.jsxs("select",{value:S.work_type,onChange:Ie=>oe("work_type",Ie.target.value),children:[l.jsx("option",{value:"demolition",children:"Demolition"}),l.jsx("option",{value:"environmental",children:"Environmental"})]}),l.jsx("span",{className:"form-hint",children:"Affects labor rate calculations"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Job Type"}),l.jsxs("select",{value:S.job_type,onChange:Ie=>oe("job_type",Ie.target.value),children:[l.jsx("option",{value:"standard",children:"Standard"}),l.jsx("option",{value:"prevailing_wage",children:"Prevailing Wage"})]})]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Default Dump Site"}),l.jsxs("select",{value:S.default_dump_site_id,onChange:Ie=>oe("default_dump_site_id",Ie.target.value),children:[l.jsx("option",{value:"",children:"-- Select Dump Site --"}),X.map(Ie=>l.jsx("option",{value:Ie.id,children:Ie.name},Ie.id))]}),l.jsx("span",{className:"form-hint",children:"Used for haul-off tracking and cost estimates"})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h3",{children:"Areas"}),l.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",marginBottom:"1rem"},children:"Weights must total 100%."}),S.areas.map((Ie,ve)=>l.jsxs("div",{className:"area-row",children:[l.jsx("input",{type:"text",placeholder:"Area name",value:Ie.name,onChange:Ue=>pe(ve,"name",Ue.target.value)}),l.jsx("input",{type:"number",placeholder:"%",value:Ie.weight,onChange:Ue=>pe(ve,"weight",Ue.target.value)}),l.jsx("button",{className:"remove-btn",onClick:()=>be(ve),children:""})]},ve)),l.jsxs("div",{className:"weight-total",children:[l.jsx("span",{className:"weight-total-label",children:"Total Weight:"}),l.jsxs("span",{className:`weight-total-value ${we===100?"valid":"invalid"}`,children:[we,"%"]})]}),l.jsx("button",{className:"btn btn-secondary",onClick:_e,children:"+ Add Area"})]}),l.jsx("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem"},children:l.jsx("button",{className:"btn btn-primary",onClick:Le,disabled:C,style:{flex:1},children:C?"Saving...":"Save Changes"})}),l.jsx("button",{className:"btn btn-danger btn-full",onClick:he,children:"Delete Project"})]})}const St=m.filter(we=>we.status==="done").length,ft=m.filter(we=>we.status==="working").length,yt=m.filter(we=>we.status==="not_started").length,er=Dt>0?Math.round(xt/Dt*100):0,Lt=At>0,Bt=[{id:"overview",label:"Overview",Icon:VC},{id:"financials",label:"Financials",Icon:Ip},{id:"reports",label:"Reports",Icon:fu},{id:"activity",label:"Activity",Icon:z0},{id:"info",label:"Info",Icon:B4}];return l.jsxs("div",{className:"project-view tabbed",children:[l.jsxs("div",{className:"pv-sticky-header",children:[l.jsxs("div",{className:"pv-header-row",children:[l.jsxs("button",{className:"pv-back",onClick:B,children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Back"})]}),l.jsxs("div",{className:"pv-actions",children:[l.jsx("button",{className:"pv-action",onClick:()=>H(!0),children:"Share"}),l.jsx("button",{className:"pv-action",onClick:()=>U(!0),children:"Alerts"}),l.jsx("button",{className:"pv-action",onClick:q,children:"Edit"})]})]}),l.jsxs("div",{className:"pv-header-title",children:[l.jsx("h1",{children:f.name}),(f.job_number||f.work_type)&&l.jsxs("span",{className:"pv-header-meta",children:[f.job_number&&`Job #${f.job_number}`,f.job_number&&f.work_type&&"  ",f.work_type]})]}),l.jsxs("div",{className:"pv-metrics-bar",children:[l.jsxs("div",{className:"pv-metric",children:[l.jsxs("span",{className:"pv-metric-value",children:[at,"%"]}),l.jsx("span",{className:"pv-metric-label",children:"Complete"})]}),l.jsx("div",{className:"pv-metric-divider"}),l.jsxs("div",{className:"pv-metric",children:[l.jsx("span",{className:"pv-metric-value",children:Yn(xt)}),l.jsx("span",{className:"pv-metric-label",children:"Billed"})]}),l.jsx("div",{className:"pv-metric-divider"}),l.jsxs("div",{className:"pv-metric",children:[l.jsx("span",{className:"pv-metric-value highlight",children:Yn(Dt-xt)}),l.jsx("span",{className:"pv-metric-label",children:"Remaining"})]})]}),l.jsx("div",{className:"pv-tabs",children:Bt.map(we=>l.jsxs("button",{className:`pv-tab ${V===we.id?"active":""}`,onClick:()=>F(we.id),children:[l.jsx(we.Icon,{size:16,className:"pv-tab-icon"}),l.jsx("span",{className:"pv-tab-label",children:we.label})]},we.id))})]}),l.jsxs("div",{className:"pv-tab-content",children:[V==="overview"&&l.jsxs("div",{className:"pv-tab-panel",children:[l.jsxs("div",{className:"pv-card pv-health-card",children:[l.jsxs("div",{className:"pv-health-header",children:[l.jsxs("div",{className:"pv-health-status",children:[l.jsx("span",{className:`pv-health-indicator ${at>=100?"complete":at>0?"active":"pending"}`}),l.jsx("span",{className:"pv-health-label",children:at>=100?"Complete":at>0?"In Progress":"Not Started"})]}),l.jsxs("div",{className:"pv-health-percent",children:[at,"%"]})]}),l.jsx("div",{className:"pv-health-bar",children:l.jsx("div",{className:"pv-health-fill",style:{width:`${at}%`}})}),l.jsx("div",{className:"pv-health-context",children:l.jsxs("span",{children:[St," of ",m.length," work areas complete"]})})]}),l.jsxs("div",{className:"pv-card",children:[l.jsxs("div",{className:"pv-card-header",children:[l.jsx("h3",{children:"Work Areas"}),l.jsxs("div",{className:"pv-area-summary",children:[St>0&&l.jsxs("span",{className:"pv-count done",children:[St," Complete"]}),ft>0&&l.jsxs("span",{className:"pv-count working",children:[ft," Active"]}),yt>0&&l.jsxs("span",{className:"pv-count pending",children:[yt," Pending"]})]})]}),l.jsx("div",{className:"pv-areas-grid",children:m.map(we=>l.jsxs("div",{className:`pv-area-card ${we.status}`,children:[l.jsxs("div",{className:"pv-area-status",children:[we.status==="done"&&l.jsx("span",{className:"pv-check",children:""}),we.status==="working"&&l.jsx("span",{className:"pv-working",children:""}),we.status==="not_started"&&l.jsx("span",{className:"pv-pending",children:""})]}),l.jsxs("div",{className:"pv-area-info",children:[l.jsx("span",{className:"pv-area-name",children:we.name}),l.jsxs("span",{className:"pv-area-weight",children:[we.weight,"% of contract"]})]})]},we.id))})]}),(pt?.pendingTickets>0||pt?.pendingMaterialRequests>0)&&l.jsxs("div",{className:"pv-card pv-attention-card",children:[l.jsx("h3",{children:"Needs Attention"}),l.jsxs("div",{className:"pv-attention-items",children:[pt?.pendingTickets>0&&l.jsxs("div",{className:"pv-attention-item",onClick:()=>F("financials"),children:[l.jsx("span",{className:"pv-attention-count",children:pt.pendingTickets}),l.jsx("span",{className:"pv-attention-label",children:"T&M tickets awaiting approval"}),l.jsx("span",{className:"pv-attention-arrow",children:""})]}),pt?.pendingMaterialRequests>0&&l.jsxs("div",{className:"pv-attention-item",onClick:()=>F("activity"),children:[l.jsx("span",{className:"pv-attention-count",children:pt.pendingMaterialRequests}),l.jsx("span",{className:"pv-attention-label",children:"Material requests pending review"}),l.jsx("span",{className:"pv-attention-arrow",children:""})]})]})]})]}),V==="financials"&&l.jsxs("div",{className:"pv-tab-panel financials-tab",children:[l.jsx("div",{className:"financials-hero",children:l.jsxs("div",{className:"financials-hero-grid",children:[l.jsxs("div",{className:"fin-metric",children:[l.jsx("div",{className:"fin-metric-label",children:"Contract"}),l.jsx("div",{className:"fin-metric-value",children:Yn(Dt)}),Lt&&l.jsxs("div",{className:"fin-metric-detail green",children:["+",Yn(At)," COs"]})]}),l.jsxs("div",{className:"fin-metric",children:[l.jsx("div",{className:"fin-metric-label",children:"Earned"}),l.jsx("div",{className:"fin-metric-value",children:Yn(xt)}),l.jsx("div",{className:"fin-metric-bar",children:l.jsx("div",{className:"fin-metric-fill",style:{width:`${er}%`}})})]}),l.jsxs("div",{className:"fin-metric",children:[l.jsx("div",{className:"fin-metric-label",children:"Remaining"}),l.jsx("div",{className:"fin-metric-value green",children:Yn(Dt-xt)}),l.jsxs("div",{className:"fin-metric-detail",children:[100-er,"% left"]})]}),l.jsxs("div",{className:"fin-metric",children:[l.jsx("div",{className:"fin-metric-label",children:"Costs"}),l.jsx("div",{className:"fin-metric-value",children:Yn(pt?.totalBurn||0)}),xt>0&&l.jsxs("div",{className:`fin-metric-detail ${pt?.totalBurn/xt>.6?"warning":""}`,children:[Math.round((pt?.totalBurn||0)/xt*100),"% of revenue"]})]})]})}),l.jsxs("div",{className:"financials-pipeline",children:[l.jsxs("div",{className:"pipeline-header",children:[l.jsx("h2",{children:"Extra Work"}),l.jsxs("div",{className:"pipeline-flow",children:[l.jsx("span",{className:"pipeline-step",children:"T&M Tickets"}),l.jsx("span",{className:"pipeline-arrow",children:""}),l.jsx("span",{className:"pipeline-step active",children:"Change Orders"})]})]}),l.jsxs("div",{className:"pipeline-content",children:[l.jsxs("div",{className:"pipeline-section",children:[l.jsxs("div",{className:"pipeline-section-header",children:[l.jsx("h3",{children:"T&M Tickets"}),l.jsxs("span",{className:"pipeline-badge",children:[pt?.totalTickets||0," total",pt?.pendingTickets>0&&`  ${pt.pendingTickets} pending`]})]}),l.jsx(pH,{project:f,company:t,onShowToast:e})]}),l.jsx("div",{className:"pipeline-section",children:l.jsx(EH,{project:f,company:t,areas:m,onShowToast:e,onCreateCOR:()=>{ne(null),I(!0)},onViewCOR:we=>{K(we),le(!0)},onEditCOR:we=>{ne(we),I(!0)}})})]})]}),l.jsxs("details",{className:"financials-details",children:[l.jsxs("summary",{className:"financials-details-summary",children:[l.jsx(Ui,{size:16}),l.jsx("span",{children:"Cost Breakdown"}),l.jsx("span",{className:"financials-details-value",children:Yn(pt?.totalBurn||0)})]}),l.jsx("div",{className:"financials-details-content",children:l.jsx(NH,{project:f,company:t,onShowToast:e})})]})]}),V==="reports"&&l.jsxs("div",{className:"pv-tab-panel",children:[l.jsxs("div",{className:"pv-card pv-reports-summary",children:[l.jsx("h3",{children:"Field Documentation Summary"}),l.jsxs("div",{className:"pv-reports-stats",children:[l.jsxs("div",{className:"pv-report-stat",children:[l.jsx("span",{className:"pv-report-stat-value",children:pt?.dailyReportsCount||0}),l.jsx("span",{className:"pv-report-stat-label",children:"Daily Reports Filed"})]}),l.jsxs("div",{className:"pv-report-stat",children:[l.jsx("span",{className:"pv-report-stat-value",children:pt?.recentDailyReports||0}),l.jsx("span",{className:"pv-report-stat-label",children:"Reports This Week"})]}),l.jsxs("div",{className:"pv-report-stat injury",children:[l.jsx("span",{className:"pv-report-stat-value",children:pt?.injuryReportsCount||0}),l.jsx("span",{className:"pv-report-stat-label",children:"Injury Reports"})]})]}),pt?.lastDailyReport&&l.jsxs("div",{className:"pv-last-report",children:["Last report filed: ",new Date(pt.lastDailyReport).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]}),l.jsx(wH,{project:f,company:t,onShowToast:e}),l.jsx(xH,{project:f,companyId:t?.id||f?.company_id,company:t,onShowToast:e})]}),V==="activity"&&l.jsxs("div",{className:"pv-tab-panel",children:[l.jsxs("div",{className:"pv-card pv-activity-summary",children:[l.jsx("h3",{children:"Project Activity Status"}),l.jsxs("div",{className:"pv-activity-stats",children:[l.jsxs("div",{className:`pv-activity-stat ${pt?.pendingMaterialRequests>0?"has-pending":""}`,children:[l.jsx("span",{className:"pv-activity-stat-value",children:pt?.pendingMaterialRequests||0}),l.jsx("span",{className:"pv-activity-stat-label",children:"Pending Requests"})]}),l.jsxs("div",{className:"pv-activity-stat",children:[l.jsx("span",{className:"pv-activity-stat-value",children:pt?.totalMaterialRequests||0}),l.jsx("span",{className:"pv-activity-stat-label",children:"Total Requests"})]})]})]}),l.jsx(_H,{project:f,company:t,onShowToast:e}),l.jsx("div",{className:"pv-messages-full",children:l.jsx(SH,{project:f,company:t,userName:t?.name||"Office",onShowToast:e})})]}),V==="info"&&l.jsxs("div",{className:"pv-tab-panel",children:[l.jsxs("div",{className:"pv-card pv-info-card",children:[l.jsxs("div",{className:"pv-info-header",children:[l.jsx("h3",{children:"Project Details"}),l.jsx("button",{className:"btn btn-secondary btn-sm",onClick:q,children:"Edit Project"})]}),l.jsxs("div",{className:"pv-info-grid",children:[l.jsxs("div",{className:"pv-info-section",children:[l.jsx("div",{className:"pv-info-section-title",children:"Basic Information"}),l.jsxs("div",{className:"pv-info-row",children:[l.jsx("span",{className:"pv-info-label",children:"Project Name"}),l.jsx("span",{className:"pv-info-value",children:f.name})]}),f.job_number&&l.jsxs("div",{className:"pv-info-row",children:[l.jsx("span",{className:"pv-info-label",children:"Job Number"}),l.jsx("span",{className:"pv-info-value",children:f.job_number})]}),f.address&&l.jsxs("div",{className:"pv-info-row",children:[l.jsxs("span",{className:"pv-info-label",children:[l.jsx(YC,{size:14,className:"pv-info-icon"}),"Address"]}),l.jsx("span",{className:"pv-info-value",children:f.address})]})]}),l.jsxs("div",{className:"pv-info-section",children:[l.jsxs("div",{className:"pv-info-section-title",children:[l.jsx(P4,{size:16,className:"pv-info-icon"}),"Client & Contractor"]}),f.general_contractor?l.jsxs("div",{className:"pv-info-row",children:[l.jsx("span",{className:"pv-info-label",children:"General Contractor"}),l.jsx("span",{className:"pv-info-value",children:f.general_contractor})]}):l.jsx("div",{className:"pv-info-empty",children:"No general contractor specified"}),f.client_contact&&l.jsxs("div",{className:"pv-info-row",children:[l.jsx("span",{className:"pv-info-label",children:"Client Contact"}),l.jsx("span",{className:"pv-info-value",children:f.client_contact})]}),f.client_phone&&l.jsxs("div",{className:"pv-info-row",children:[l.jsxs("span",{className:"pv-info-label",children:[l.jsx(iT,{size:14,className:"pv-info-icon"}),"Phone"]}),l.jsx("a",{href:`tel:${f.client_phone}`,className:"pv-info-value pv-info-link",children:f.client_phone})]})]}),l.jsxs("div",{className:"pv-info-section",children:[l.jsx("div",{className:"pv-info-section-title",children:"Project Settings"}),l.jsxs("div",{className:"pv-info-row",children:[l.jsx("span",{className:"pv-info-label",children:"Work Type"}),l.jsx("span",{className:"pv-info-value pv-info-badge",children:f.work_type==="environmental"?"Environmental":"Demolition"})]}),l.jsxs("div",{className:"pv-info-row",children:[l.jsx("span",{className:"pv-info-label",children:"Job Type"}),l.jsx("span",{className:"pv-info-value pv-info-badge",children:f.job_type==="prevailing_wage"?"Prevailing Wage":"Standard"})]}),f.pin&&l.jsxs("div",{className:"pv-info-row",children:[l.jsx("span",{className:"pv-info-label",children:"Foreman PIN"}),l.jsx("span",{className:"pv-info-value pv-info-mono",children:f.pin})]}),f.default_dump_site_id&&l.jsxs("div",{className:"pv-info-row",children:[l.jsx("span",{className:"pv-info-label",children:"Default Dump Site"}),l.jsx("span",{className:"pv-info-value",children:X.find(we=>we.id===f.default_dump_site_id)?.name||"Unknown"})]})]}),l.jsxs("div",{className:"pv-info-section",children:[l.jsxs("div",{className:"pv-info-section-title",children:[l.jsx(Ip,{size:16,className:"pv-info-icon"}),"Contract"]}),l.jsxs("div",{className:"pv-info-row",children:[l.jsx("span",{className:"pv-info-label",children:"Original Contract"}),l.jsx("span",{className:"pv-info-value pv-info-currency",children:Yn(f.contract_value)})]}),At>0&&l.jsxs("div",{className:"pv-info-row",children:[l.jsx("span",{className:"pv-info-label",children:"Change Orders"}),l.jsxs("span",{className:"pv-info-value pv-info-currency positive",children:["+",Yn(At)]})]}),l.jsxs("div",{className:"pv-info-row pv-info-total",children:[l.jsx("span",{className:"pv-info-label",children:"Current Value"}),l.jsx("span",{className:"pv-info-value pv-info-currency",children:Yn(Dt)})]})]})]})]}),l.jsxs("div",{className:"pv-card",children:[l.jsxs("h3",{children:["Work Areas (",m.length,")"]}),l.jsx("div",{className:"pv-info-areas",children:m.map(we=>l.jsxs("div",{className:`pv-info-area ${we.status}`,children:[l.jsx("span",{className:"pv-info-area-name",children:we.name}),l.jsxs("span",{className:"pv-info-area-weight",children:[we.weight,"%"]}),l.jsx("span",{className:`pv-info-area-status status-badge ${we.status}`,children:we.status==="done"?"Complete":we.status==="working"?"In Progress":"Not Started"})]},we.id))})]})]})]}),R&&l.jsx(gH,{project:f,onClose:()=>H(!1),onShareCreated:we=>{e("Share link created successfully!","success")}}),Y&&l.jsx("div",{className:"notification-settings-modal",children:l.jsx(yH,{project:f,company:t,onShowToast:e,onClose:()=>U(!1)})}),O&&l.jsx(CH,{project:f,company:t,areas:m,existingCOR:W,onClose:()=>{I(!1),ne(null)},onSaved:()=>{I(!1),ne(null)},onShowToast:e}),Q&&ee&&l.jsx(FH,{cor:ee,project:f,company:t,areas:m,onClose:()=>{le(!1),K(null)},onEdit:we=>{le(!1),K(null),ne(we),I(!0)},onShowToast:e,onStatusChange:()=>{}})]})}if(n.length===0)return l.jsxs("div",{className:"empty-state",children:[l.jsx(fu,{size:48,className:"empty-state-icon"}),l.jsx("h3",{children:"No Projects Yet"}),l.jsx("p",{children:"Create your first project to get started"})]});const Ae=o.reduce((at,pt)=>at+(pt.contract_value||0),0),de=o.reduce((at,pt)=>at+(pt.changeOrderValue||0),0),re=Ae+de,Ke=o.reduce((at,pt)=>at+(pt.billable||0),0),Oe=re-Ke,rt=re>0?Math.round(Ke/re*100):0,tt=o.filter(at=>at.progress>=100).length,Et=o.filter(at=>at.progress<100&&at.billable<=(at.revisedContractValue||at.contract_value)*(at.progress/100)*1.1).length,kt=o.filter(at=>at.billable>(at.revisedContractValue||at.contract_value)*.9&&at.progress<90).length,zt=o.filter(at=>at.billable>(at.revisedContractValue||at.contract_value)).length,Tt=o.filter(at=>(at.changeOrderValue||0)>0).length;return l.jsxs("div",{children:[l.jsxs("div",{className:"business-overview",children:[l.jsxs("div",{className:"bo-header",children:[l.jsx("h2",{className:"bo-title",children:"Portfolio Overview"}),l.jsxs("div",{className:"bo-project-count",children:[n.length," Active Project",n.length!==1?"s":""]})]}),l.jsxs("div",{className:"bo-financial",children:[l.jsx("div",{className:"bo-progress-bar",children:l.jsx("div",{className:"bo-progress-fill",style:{width:`${Math.min(rt,100)}%`}})}),l.jsxs("div",{className:"bo-financial-row",children:[l.jsxs("div",{className:"bo-metric primary",children:[l.jsx("span",{className:"bo-metric-value",children:Yn(Ke)}),l.jsx("span",{className:"bo-metric-label",children:"Earned Revenue"})]}),l.jsx("div",{className:"bo-metric-separator",children:"of"}),l.jsxs("div",{className:"bo-metric primary",children:[l.jsx("span",{className:"bo-metric-value",children:Yn(re)}),l.jsx("span",{className:"bo-metric-label",children:"Total Portfolio"})]}),l.jsxs("div",{className:"bo-metric highlight",children:[l.jsx("span",{className:"bo-metric-value",children:Yn(Oe)}),l.jsx("span",{className:"bo-metric-label",children:"Remaining to Bill"})]})]}),de>0&&l.jsxs("div",{className:"bo-change-orders",children:[l.jsxs("div",{className:"bo-co-item",children:[l.jsx("span",{className:"bo-co-label",children:"Original Contracts"}),l.jsx("span",{className:"bo-co-value",children:Yn(Ae)})]}),l.jsxs("div",{className:"bo-co-item bo-co-added",children:[l.jsxs("span",{className:"bo-co-label",children:["+ Change Orders (",Tt," project",Tt!==1?"s":"",")"]}),l.jsxs("span",{className:"bo-co-value",children:["+",Yn(de)]})]})]})]}),l.jsxs("div",{className:"bo-health",children:[l.jsx("div",{className:"bo-health-title",children:"Project Health"}),l.jsxs("div",{className:"bo-health-pills",children:[tt>0&&l.jsxs("div",{className:"bo-pill complete",children:[l.jsx("span",{className:"bo-pill-count",children:tt}),l.jsx("span",{className:"bo-pill-label",children:"Complete"})]}),Et>0&&l.jsxs("div",{className:"bo-pill on-track",children:[l.jsx("span",{className:"bo-pill-count",children:Et}),l.jsx("span",{className:"bo-pill-label",children:"On Track"})]}),kt>0&&l.jsxs("div",{className:"bo-pill at-risk",children:[l.jsx("span",{className:"bo-pill-count",children:kt}),l.jsx("span",{className:"bo-pill-label",children:"At Risk"})]}),zt>0&&l.jsxs("div",{className:"bo-pill over-budget",children:[l.jsx("span",{className:"bo-pill-count",children:zt}),l.jsx("span",{className:"bo-pill-label",children:"Over Budget"})]})]})]})]}),l.jsxs("div",{className:"dashboard-header",children:[l.jsx("h2",{children:"Projects"}),l.jsxs("span",{className:"project-count",children:[n.length," active"]})]}),l.jsx("div",{className:"project-list",children:o.map(at=>l.jsx(PH,{project:at,onClick:()=>D(at)},at.id))})]})}function PH({project:t,onClick:e}){const r=H4(t.areas||[]),a=OT(t.areas||[]),n=t.contract_value-t.billable,s=t.billable>t.contract_value*.9&&t.progress<90;return l.jsxs("div",{className:`project-card enhanced ${s?"at-risk":""}`,onClick:e,children:[l.jsxs("div",{className:"project-card-header",children:[l.jsxs("div",{children:[l.jsx("div",{className:"project-card-name",children:t.name}),l.jsx("div",{className:"project-card-value",children:Yn(t.contract_value)})]}),l.jsx("span",{className:`status-badge ${r}`,children:a})]}),l.jsxs("div",{className:"project-stats-row",children:[l.jsxs("div",{className:"project-stat",children:[l.jsxs("span",{className:"stat-value",children:[t.progress,"%"]}),l.jsx("span",{className:"stat-label",children:"Complete"})]}),l.jsxs("div",{className:"project-stat",children:[l.jsx("span",{className:"stat-value",children:Yn(t.billable)}),l.jsx("span",{className:"stat-label",children:"Billable"})]}),l.jsxs("div",{className:"project-stat",children:[l.jsx("span",{className:`stat-value ${n<0?"negative":""}`,children:Yn(Math.abs(n))}),l.jsx("span",{className:"stat-label",children:n>=0?"Remaining":"Over Budget"})]})]}),l.jsx("div",{className:"mini-progress-bar",children:l.jsx("div",{className:"mini-progress-fill",style:{width:`${t.progress}%`}})}),(t.pendingTickets>0||t.totalTickets>0)&&l.jsxs("div",{className:"project-badges",children:[t.pendingTickets>0&&l.jsxs("span",{className:"badge pending",children:[t.pendingTickets," Pending T&M"]}),t.approvedTickets>0&&l.jsxs("span",{className:"badge approved",children:[t.approvedTickets," Approved T&M"]})]})]})}function MH({onProjectCreated:t,onShowToast:e}){const[r,a]=se.useState(""),[n,s]=se.useState(""),[o,u]=se.useState(""),[f,h]=se.useState(""),[m,v]=se.useState(""),[y,g]=se.useState(""),[b,_]=se.useState("demolition"),[S,E]=se.useState("standard"),[C,j]=se.useState([{name:"",weight:"",group:""},{name:"",weight:"",group:""},{name:"",weight:"",group:""}]),[R,H]=se.useState(!1),[Y,U]=se.useState(!1),[V,F]=se.useState(!1),[X,P]=se.useState([]),O=se.useRef(null),I=C.reduce((pe,_e)=>pe+(parseFloat(_e.weight)||0),0),W=pe=>{const _e=pe.replace(/\D/g,"").slice(0,4);g(_e)},ne=()=>{const pe=Math.floor(1e3+Math.random()*9e3).toString();g(pe)},Q=(pe,_e,be)=>{j(Le=>Le.map((he,Ae)=>Ae===pe?{...he,[_e]:be}:he))},le=()=>{j(pe=>[...pe,{name:"",weight:"",group:""}])},ee=pe=>{C.length>1&&j(_e=>_e.filter((be,Le)=>Le!==pe))},K=()=>{a(""),s(""),u(""),h(""),v(""),g(""),_("demolition"),E("standard"),j([{name:"",weight:"",group:""},{name:"",weight:"",group:""},{name:"",weight:"",group:""}]),F(!1),P([])},ue=()=>{O.current?.click()},M=pe=>new Promise((_e,be)=>{const Le=new FileReader;Le.onload=he=>{try{const Ae=new Uint8Array(he.target.result),de=_2(Ae,{type:"array"}),re=de.SheetNames[0],Ke=de.Sheets[re],Oe=au.sheet_to_json(Ke,{header:1}),rt=[];let tt="General";const Et=/^\$?\d{1,3}(,\d{3})*(\.\d{2})?$/,kt=/^(\d+\.?\d*|[A-Z]\.?\d*)$/i,zt=/^(SF|LF|EA|LS|Days?|MD|Load|CY|SY|GAL|TON)$/i,Tt=/^\d{1,3}(,\d{3})*$|^\d+$/,at=/^(Item|#|No\.?|Description|Scheduled|Value|Amount|Quantity|Unit|Total|Application|Balance|Completed|Stored|Retainage)/i;for(const Dt of Oe){if(!Dt||Dt.length===0)continue;const xt=Dt.map(Ie=>Ie==null?"":String(Ie).trim()).filter(Ie=>Ie.length>0);if(xt.length===0)continue;const St=xt.join(" ");if(at.test(xt[0])||xt.length>1&&at.test(xt[1])||/^(Total|Subtotal|Grand Total|Base Bid|Contract Sum)/i.test(St))continue;const ft=xt.some(Ie=>Et.test(Ie.replace(/[$,]/g,"")+(Ie.includes(".")?"":".00")));if((!ft&&xt.length<=3&&/^(L\d|Level|Floor|\d+(?:st|nd|rd|th)|Plaza|Street|Basement|Roof|Penthouse|Site|Exterior|Interior|Misc|MEP|ABATEMENT|DEMOLITION|UNIVERSAL|SOFT|TRASH|DEMO|Phase|Division|Section|Area|Building|Wing)/i.test(xt[0])||xt.length===2&&kt.test(xt[0])&&!ft&&!/^\d+\.\d+$/.test(xt[0]))&&!ft){tt=(xt.find(ve=>!kt.test(ve)&&ve.length>1)||xt.join(" ")).replace(/\s*\(\d{1,3}(?:,\d{3})*\s*SF\)\s*$/i,"").replace(/\s*[-:]\s*$/,"").trim();continue}let er="",Lt=!1,Bt="";const we=[];for(let Ie=0;Ie<xt.length;Ie++){const ve=xt[Ie];if(Ie===0&&kt.test(ve)){Bt=ve;continue}if(!/^ID-\d+$/i.test(ve)&&!/^KN\s*\d+$/i.test(ve)){if(Et.test(ve.replace(/[$,]/g,"")+(ve.includes(".")?"":".00"))||/^\$/.test(ve)){Lt=!0;continue}if(Tt.test(ve.replace(/,/g,""))){Lt=!0;continue}zt.test(ve)||/^\d+\.?\d*%$/.test(ve)||ve.length>1&&!kt.test(ve)&&we.push(ve)}}er=we.join(" ").trim(),er=er.replace(/\s+/g," ").replace(/^[-]\s*/,"").trim(),!(er.length<3)&&(/^(Plan|Page|Total|Base Bid|Payment|Condition|Exclusion|Subtotal)/i.test(er)||Lt&&er.length>=3&&rt.push({name:er,group:tt,itemNumber:Bt,selected:!0}))}const pt=new Set,At=rt.filter(Dt=>{const xt=`${Dt.group}:${Dt.name}`;return pt.has(xt)?!1:(pt.add(xt),!0)});_e(At)}catch(Ae){be(Ae)}},Le.onerror=()=>be(new Error("Failed to read file")),Le.readAsArrayBuffer(pe)}),A=async pe=>{const _e=pe.target.files?.[0];if(!_e)return;const be=_e.name.split(".").pop().toLowerCase();if(!["xlsx","xls","csv"].includes(be)){e("Please upload an Excel file (.xlsx, .xls, or .csv)","error");return}U(!0);try{const Le=await M(_e);if(Le.length===0){e("No tasks found. Check Excel format.","error"),U(!1);return}P(Le),F(!0),e(`Found ${Le.length} tasks`,"success")}catch(Le){console.error("Excel import error:",Le),e("Error reading Excel file","error")}finally{U(!1),O.current&&(O.current.value="")}},D=pe=>{P(_e=>_e.map((be,Le)=>Le===pe?{...be,selected:!be.selected}:be))},B=()=>{const pe=X.filter(Le=>Le.selected);if(pe.length===0){e("Please select at least one task","error");return}const _e=Math.round(100/pe.length*100)/100,be=pe.map((Le,he)=>({name:Le.name,weight:he===pe.length-1?(100-_e*(pe.length-1)).toFixed(2):_e.toFixed(2),group:Le.group}));j(be),F(!1),e("Tasks imported!","success")},q=async()=>{if(!r.trim()){e("Please enter a project name","error");return}const pe=parseFloat(m);if(!pe||pe<=0){e("Please enter a valid contract value","error");return}if(y.length!==4){e("Please enter a 4-digit PIN","error");return}if(!await ut.isPinAvailable(y)){e("This PIN is already in use. Try another.","error");return}const be=C.filter(Le=>Le.name.trim()&&parseFloat(Le.weight)>0);if(be.length===0){e("Please add at least one area","error");return}if(Math.abs(I-100)>.1){e("Area weights must total 100%","error");return}H(!0);try{const Le=await ut.createProject({name:r.trim(),job_number:n.trim()||null,address:o.trim()||null,general_contractor:f.trim()||null,contract_value:pe,pin:y,work_type:b,job_type:S});for(let he=0;he<be.length;he++)await ut.createArea({project_id:Le.id,name:be[he].name.trim(),weight:parseFloat(be[he].weight),group_name:be[he].group||null,status:"not_started",sort_order:he});e("Project created!","success"),K(),t()}catch(Le){console.error("Error creating project:",Le),e("Error creating project","error")}finally{H(!1)}};if(V){const pe=[...new Set(X.map(be=>be.group))],_e=X.filter(be=>be.selected).length;return l.jsxs("div",{children:[l.jsx("h1",{children:"Review Imported Tasks"}),l.jsx("p",{className:"subtitle",children:"Select the tasks to include in your project"}),l.jsx("div",{className:"import-summary",children:l.jsxs("span",{children:[_e," of ",X.length," tasks selected"]})}),pe.map(be=>{const Le=X.filter(Ae=>Ae.group===be),he=Le.filter(Ae=>Ae.selected).length;return l.jsxs("div",{className:"card import-group",children:[l.jsxs("div",{className:"import-group-header",children:[l.jsx("h3",{children:be}),l.jsxs("span",{className:"import-group-count",children:[he,"/",Le.length]})]}),l.jsx("div",{className:"import-task-list",children:Le.map(Ae=>{const de=X.indexOf(Ae);return l.jsxs("label",{className:"import-task-item",children:[l.jsx("input",{type:"checkbox",checked:Ae.selected,onChange:()=>D(de)}),l.jsx("span",{className:"import-task-name",children:Ae.name})]},de)})})]},be)}),l.jsxs("div",{className:"import-actions",children:[l.jsx("button",{className:"btn btn-secondary",onClick:()=>F(!1),children:"Cancel"}),l.jsxs("button",{className:"btn btn-primary",onClick:B,children:["Use Selected Tasks (",_e,")"]})]})]})}const Z=C.reduce((pe,_e,be)=>{const Le=_e.group||"General";return pe[Le]||(pe[Le]=[]),pe[Le].push({..._e,originalIndex:be}),pe},{}),oe=Object.keys(Z).length>1||Object.keys(Z).length===1&&!Z.General;return l.jsxs("div",{children:[l.jsx("h1",{children:"New Project"}),l.jsx("p",{className:"subtitle",children:"Set up a new project to track"}),l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Project Name"}),l.jsx("input",{type:"text",placeholder:"e.g., Sunrise Apartments",value:r,onChange:pe=>a(pe.target.value)})]}),l.jsxs("div",{className:"form-row-2",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Job Number"}),l.jsx("input",{type:"text",placeholder:"e.g., 4032",value:n,onChange:pe=>s(pe.target.value)})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Contract Value ($)"}),l.jsx("input",{type:"number",placeholder:"e.g., 365000",value:m,onChange:pe=>v(pe.target.value)})]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Project Address"}),l.jsx("input",{type:"text",placeholder:"e.g., 123 Main St, Los Angeles, CA 90001",value:o,onChange:pe=>u(pe.target.value)})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"General Contractor"}),l.jsx("input",{type:"text",placeholder:"e.g., ABC Construction Inc.",value:f,onChange:pe=>h(pe.target.value)})]}),l.jsxs("div",{className:"form-row-2",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Work Type"}),l.jsxs("div",{className:"project-type-toggle",children:[l.jsx("button",{type:"button",className:`toggle-btn ${b==="demolition"?"active":""}`,onClick:()=>_("demolition"),children:"Demolition"}),l.jsx("button",{type:"button",className:`toggle-btn ${b==="abatement"?"active":""}`,onClick:()=>_("abatement"),children:"Abatement"})]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Job Type"}),l.jsxs("div",{className:"project-type-toggle",children:[l.jsx("button",{type:"button",className:`toggle-btn ${S==="standard"?"active":""}`,onClick:()=>E("standard"),children:"Standard"}),l.jsx("button",{type:"button",className:`toggle-btn ${S==="pla"?"active":""}`,onClick:()=>E("pla"),children:"PLA"})]})]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Foreman PIN (4 digits)"}),l.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Foremen will enter this PIN to access this project"}),l.jsxs("div",{className:"pin-input-row",children:[l.jsx("input",{type:"text",placeholder:"e.g., 2847",value:y,onChange:pe=>W(pe.target.value),maxLength:4,className:"pin-input"}),l.jsx("button",{type:"button",className:"btn btn-secondary",onClick:ne,children:"Generate"})]})]})]}),l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"areas-header",children:[l.jsxs("div",{children:[l.jsx("h3",{children:"Areas / Tasks"}),l.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",marginTop:"0.25rem"},children:"Define the areas for this project. Weights must total 100%."})]}),l.jsxs("div",{className:"import-btn-container",children:[l.jsx("input",{ref:O,type:"file",accept:".xlsx,.xls,.csv",onChange:A,style:{display:"none"}}),l.jsx("button",{className:"btn btn-secondary btn-small",onClick:ue,disabled:Y,children:Y?"Reading...":" Import Excel"})]})]}),oe?Object.entries(Z).map(([pe,_e])=>l.jsxs("div",{className:"area-group",children:[l.jsx("div",{className:"area-group-header",children:pe}),_e.map(be=>l.jsxs("div",{className:"area-row",children:[l.jsx("input",{type:"text",placeholder:"Task name",value:be.name,onChange:Le=>Q(be.originalIndex,"name",Le.target.value)}),l.jsx("input",{type:"number",placeholder:"%",min:"0",max:"100",value:be.weight,onChange:Le=>Q(be.originalIndex,"weight",Le.target.value)}),l.jsx("button",{className:"remove-btn",onClick:()=>ee(be.originalIndex),children:""})]},be.originalIndex))]},pe)):C.map((pe,_e)=>l.jsxs("div",{className:"area-row",children:[l.jsx("input",{type:"text",placeholder:"Area name (e.g., Level 1)",value:pe.name,onChange:be=>Q(_e,"name",be.target.value)}),l.jsx("input",{type:"number",placeholder:"%",min:"0",max:"100",value:pe.weight,onChange:be=>Q(_e,"weight",be.target.value)}),l.jsx("button",{className:"remove-btn",onClick:()=>ee(_e),children:""})]},_e)),l.jsxs("div",{className:"weight-total",children:[l.jsx("span",{className:"weight-total-label",children:"Total Weight:"}),l.jsxs("span",{className:`weight-total-value ${Math.abs(I-100)<.1?"valid":"invalid"}`,children:[I.toFixed(1),"%"]})]}),l.jsx("button",{className:"btn btn-secondary",onClick:le,children:"+ Add Area"})]}),l.jsx("button",{className:"btn btn-primary btn-full",onClick:q,disabled:R,children:R?"Creating...":"Create Project"})]})}function IH({company:t,onShowToast:e}){const{branding:r,updateBranding:a,uploadBrandingImage:n,loading:s}=od(),[o,u]=se.useState(!1),[f,h]=se.useState(!1),[m,v]=se.useState(r),[y,g]=se.useState(""),[b,_]=se.useState(!1),S=se.useRef(null),E=se.useRef(null),C=se.useRef(null);se.useEffect(()=>{t?.id&&j()},[t?.id]);const j=async()=>{try{const{data:W,error:ne}=await Pe.from("companies").select("office_code").eq("id",t.id).single();!ne&&W?.office_code&&g(W.office_code)}catch(W){console.error("Error loading office code:",W)}},R=async()=>{if(confirm("Regenerate office code? Current code will stop working immediately.")){_(!0);try{const W=Math.random().toString(36).substring(2,8).toUpperCase(),{error:ne}=await Pe.from("companies").update({office_code:W}).eq("id",t.id);if(ne)throw ne;g(W),e?.("Office code regenerated","success")}catch(W){console.error("Error regenerating code:",W),e?.("Error regenerating code","error")}finally{_(!1)}}},H=()=>{navigator.clipboard.writeText(y),e?.("Office code copied to clipboard","success")},Y=t?.subscription_tier||"free",U=["pro","business","enterprise"].includes(Y),V=["business","enterprise"].includes(Y),F=Y==="enterprise",X=(W,ne)=>{v(Q=>({...Q,[W]:ne}))},P=async(W,ne)=>{if(W){if(W.size>5*1024*1024){e?.("Image must be smaller than 5MB","error");return}if(!W.type.startsWith("image/")){e?.("Please upload an image file","error");return}try{const Q=await n(W,ne);Q.success?(X(`${ne}_url`,Q.url),e?.(`${ne.charAt(0).toUpperCase()+ne.slice(1)} uploaded successfully`,"success")):e?.(Q.error||"Failed to upload image","error")}catch(Q){console.error("Upload error:",Q),e?.("Failed to upload image","error")}}},O=async()=>{try{u(!0);const W=/^#[0-9A-F]{6}$/i;if(!W.test(m.primary_color)){e?.("Primary color must be a valid hex color (e.g., #3B82F6)","error");return}if(!W.test(m.secondary_color)){e?.("Secondary color must be a valid hex color (e.g., #1E40AF)","error");return}const ne=await a(m);ne.success?e?.("Branding settings saved successfully!","success"):e?.(ne.error||"Failed to save branding settings","error")}catch(W){console.error("Save error:",W),e?.("Failed to save branding settings","error")}finally{u(!1)}},I=()=>{f?(document.documentElement.style.setProperty("--primary-color",r.primary_color),document.documentElement.style.setProperty("--secondary-color",r.secondary_color),document.title=r.custom_app_name||"FieldSync"):(document.documentElement.style.setProperty("--primary-color",m.primary_color),document.documentElement.style.setProperty("--secondary-color",m.secondary_color),document.title=m.custom_app_name||"FieldSync"),h(!f)};return s?l.jsxs("div",{className:"settings-loading",children:[l.jsx("div",{className:"spinner"}),l.jsx("p",{children:"Loading branding settings..."})]}):l.jsxs("div",{className:"branding-settings",children:[l.jsxs("div",{className:"settings-header",children:[l.jsx("h2",{children:" Branding Settings"}),Y==="free"&&l.jsx("div",{className:"tier-badge tier-free",children:"Free Plan - Upgrade for branding options"}),Y==="pro"&&l.jsx("div",{className:"tier-badge tier-pro",children:"Pro Plan"}),Y==="business"&&l.jsx("div",{className:"tier-badge tier-business",children:"Business Plan"}),Y==="enterprise"&&l.jsx("div",{className:"tier-badge tier-enterprise",children:"Enterprise Plan"})]}),l.jsxs("div",{className:"settings-section security-section",children:[l.jsx("h3",{children:"Security"}),l.jsxs("div",{className:"setting-item",children:[l.jsx("label",{children:"Office Code"}),l.jsx("p",{className:"help-text",style:{marginBottom:"0.75rem"},children:"Share this code with office staff only. Required to create new office accounts."}),l.jsxs("div",{className:"office-code-display",children:[l.jsx("code",{className:"office-code-value",children:y||"------"}),l.jsx("button",{className:"btn-secondary btn-small",onClick:H,disabled:!y,children:"Copy"}),l.jsx("button",{className:"btn-secondary btn-small",onClick:R,disabled:b,children:b?"...":"Regenerate"})]}),l.jsx("p",{className:"help-text",style:{marginTop:"0.5rem",color:"var(--accent-amber)"},children:"Field workers should NOT have this code - they use project PINs only."})]}),l.jsxs("div",{className:"setting-item",children:[l.jsx("label",{children:"Company Code"}),l.jsx("p",{className:"help-text",style:{marginBottom:"0.75rem"},children:"Public code for employees to find your company."}),l.jsxs("div",{className:"office-code-display",children:[l.jsx("code",{className:"office-code-value",children:t?.code||"------"}),l.jsx("button",{className:"btn-secondary btn-small",onClick:()=>{navigator.clipboard.writeText(t?.code||""),e?.("Company code copied","success")},disabled:!t?.code,children:"Copy"})]})]})]}),l.jsxs("div",{className:"settings-section",children:[l.jsx("h3",{children:"Visual Identity"}),l.jsxs("div",{className:"setting-item",children:[l.jsx("label",{children:"Logo"}),U?l.jsxs(l.Fragment,{children:[m.logo_url&&l.jsx("div",{className:"logo-preview",children:l.jsx("img",{src:m.logo_url,alt:"Logo preview"})}),l.jsx("input",{ref:S,type:"file",accept:"image/*",style:{display:"none"},onChange:W=>P(W.target.files[0],"logo")}),l.jsx("button",{className:"btn-secondary",onClick:()=>S.current?.click(),children:m.logo_url?"Change Logo":"Upload Logo"}),l.jsx("p",{className:"help-text",children:"Recommended: 200x60px, PNG with transparent background"})]}):l.jsx("div",{className:"upgrade-notice",children:l.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your logo"})})]}),l.jsxs("div",{className:"setting-item",children:[l.jsx("label",{htmlFor:"app-name",children:"App Name"}),U?l.jsxs(l.Fragment,{children:[l.jsx("input",{id:"app-name",type:"text",className:"input",value:m.custom_app_name||"",onChange:W=>X("custom_app_name",W.target.value),placeholder:"FieldSync",maxLength:50}),l.jsx("p",{className:"help-text",children:"This name appears in the browser tab and throughout the app"})]}):l.jsx("div",{className:"upgrade-notice",children:l.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your app name"})})]}),l.jsxs("div",{className:"setting-item",children:[l.jsx("label",{htmlFor:"primary-color",children:"Primary Color"}),U?l.jsxs("div",{className:"color-input-group",children:[l.jsx("input",{id:"primary-color",type:"color",value:m.primary_color||"#3B82F6",onChange:W=>X("primary_color",W.target.value),className:"color-picker"}),l.jsx("input",{type:"text",className:"input color-text",value:m.primary_color||"#3B82F6",onChange:W=>X("primary_color",W.target.value),placeholder:"#3B82F6",pattern:"^#[0-9A-Fa-f]{6}$"})]}):l.jsx("div",{className:"upgrade-notice",children:l.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize colors"})})]}),l.jsxs("div",{className:"setting-item",children:[l.jsx("label",{htmlFor:"secondary-color",children:"Secondary Color"}),U?l.jsxs("div",{className:"color-input-group",children:[l.jsx("input",{id:"secondary-color",type:"color",value:m.secondary_color||"#1E40AF",onChange:W=>X("secondary_color",W.target.value),className:"color-picker"}),l.jsx("input",{type:"text",className:"input color-text",value:m.secondary_color||"#1E40AF",onChange:W=>X("secondary_color",W.target.value),placeholder:"#1E40AF",pattern:"^#[0-9A-Fa-f]{6}$"})]}):l.jsx("div",{className:"upgrade-notice",children:l.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize colors"})})]}),l.jsxs("div",{className:"setting-item",children:[l.jsx("label",{children:"Favicon"}),U?l.jsxs(l.Fragment,{children:[m.favicon_url&&l.jsx("div",{className:"favicon-preview",children:l.jsx("img",{src:m.favicon_url,alt:"Favicon preview"})}),l.jsx("input",{ref:E,type:"file",accept:"image/*",style:{display:"none"},onChange:W=>P(W.target.files[0],"favicon")}),l.jsx("button",{className:"btn-secondary",onClick:()=>E.current?.click(),children:m.favicon_url?"Change Favicon":"Upload Favicon"}),l.jsx("p",{className:"help-text",children:"Recommended: 32x32px or 64x64px, PNG or ICO format"})]}):l.jsx("div",{className:"upgrade-notice",children:l.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your favicon"})})]}),l.jsxs("div",{className:"setting-item",children:[l.jsx("label",{children:"Login Background"}),V?l.jsxs(l.Fragment,{children:[m.login_background_url&&l.jsx("div",{className:"background-preview",children:l.jsx("img",{src:m.login_background_url,alt:"Background preview"})}),l.jsx("input",{ref:C,type:"file",accept:"image/*",style:{display:"none"},onChange:W=>P(W.target.files[0],"login_background")}),l.jsx("button",{className:"btn-secondary",onClick:()=>C.current?.click(),children:m.login_background_url?"Change Background":"Upload Background"}),l.jsx("p",{className:"help-text",children:"Recommended: 1920x1080px, JPG or PNG"})]}):l.jsx("div",{className:"upgrade-notice",children:l.jsx("p",{children:" Upgrade to Business or Enterprise to customize login background"})})]})]}),l.jsxs("div",{className:"settings-section",children:[l.jsx("h3",{children:"White-Label Options"}),l.jsxs("div",{className:"setting-item",children:[l.jsxs("label",{className:"checkbox-label",children:[l.jsx("input",{type:"checkbox",checked:m.hide_fieldsync_branding||!1,onChange:W=>X("hide_fieldsync_branding",W.target.checked),disabled:!V}),l.jsx("span",{children:'Hide "Powered by FieldSync"'})]}),!V&&l.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]})]}),l.jsxs("div",{className:"settings-section",children:[l.jsx("h3",{children:"Email Branding"}),l.jsxs("div",{className:"setting-item",children:[l.jsx("label",{htmlFor:"email-from-name",children:"From Name"}),l.jsx("input",{id:"email-from-name",type:"text",className:"input",value:m.email_from_name||"",onChange:W=>X("email_from_name",W.target.value),placeholder:"Your Company Name",disabled:!V}),!V&&l.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]}),l.jsxs("div",{className:"setting-item",children:[l.jsx("label",{htmlFor:"email-from-address",children:"From Email"}),l.jsx("input",{id:"email-from-address",type:"email",className:"input",value:m.email_from_address||"",onChange:W=>X("email_from_address",W.target.value),placeholder:"noreply@yourcompany.com",disabled:!V}),!V&&l.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]})]}),l.jsxs("div",{className:"settings-section",children:[l.jsx("h3",{children:"Custom Domain"}),l.jsxs("div",{className:"setting-item",children:[l.jsx("label",{htmlFor:"custom-domain",children:"Domain"}),F?l.jsxs(l.Fragment,{children:[l.jsx("input",{id:"custom-domain",type:"text",className:"input",value:m.custom_domain||"",onChange:W=>X("custom_domain",W.target.value),placeholder:"app.yourcompany.com"}),m.custom_domain&&l.jsx("div",{className:`domain-status ${m.domain_verified?"verified":"pending"}`,children:m.domain_verified?l.jsx(l.Fragment,{children:" Connected"}):l.jsx(l.Fragment,{children:" DNS setup required"})}),l.jsx("p",{className:"help-text",children:"Contact support to configure DNS and SSL certificate for your custom domain"})]}):l.jsxs("div",{className:"upgrade-notice",children:[l.jsx("p",{children:" Enterprise plan required for custom domain support"}),l.jsx("p",{className:"help-text",children:"Custom domains allow you to host the app at your own URL (e.g., app.yourcompany.com)"})]})]})]}),l.jsxs("div",{className:"settings-actions",children:[l.jsx("button",{className:"btn-secondary",onClick:I,children:f?"Exit Preview":"Preview Changes"}),l.jsx("button",{className:"btn-primary",onClick:O,disabled:o||!U,children:o?"Saving...":"Save Changes"})]}),f&&l.jsx("div",{className:"preview-banner",children:"Preview Mode Active - Your changes are not yet saved"})]})}const Hv=["foreman","operator","laborer"],$v=["demolition","abatement"],Wv=["standard","pla"];function BH({company:t,onShowToast:e}){const[r,a]=se.useState({}),[n,s]=se.useState(!1),[o,u]=se.useState(!1),[f,h]=se.useState("demolition"),[m,v]=se.useState(!0);se.useEffect(()=>{t?.id&&g()},[t?.id]);const y=()=>{const j={};return $v.forEach(R=>{j[R]={},Wv.forEach(H=>{j[R][H]={},Hv.forEach(Y=>{j[R][H][Y]={regular:"",overtime:""}})})}),j},g=async()=>{if(!$e){a(y()),v(!1);return}const j=y();try{const{data:R,error:H}=await Pe.from("labor_rates").select("*").eq("company_id",t.id);if(H){a(j),v(!1);return}R&&R.length>0&&R.forEach(Y=>{j[Y.work_type]&&j[Y.work_type][Y.job_type]&&j[Y.work_type][Y.job_type][Y.role]&&(j[Y.work_type][Y.job_type][Y.role]={regular:Y.regular_rate||"",overtime:Y.overtime_rate||""})}),a(j)}catch(R){console.error("Error loading labor rates:",R),a(j)}finally{v(!1)}},b=async()=>{if(!$e){e("Labor rates require database connection","error");return}u(!0);try{await Pe.from("labor_rates").delete().eq("company_id",t.id);const j=[];$v.forEach(H=>{Wv.forEach(Y=>{Hv.forEach(U=>{const V=r[H]?.[Y]?.[U]||{regular:0,overtime:0};j.push({company_id:t.id,role:U,work_type:H,job_type:Y,regular_rate:parseFloat(V.regular)||0,overtime_rate:parseFloat(V.overtime)||0})})})});const{error:R}=await Pe.from("labor_rates").insert(j);if(R)throw R;e("Labor rates saved","success"),s(!1)}catch(j){console.error("Error saving labor rates:",j),e("Error saving rates: "+(j.message||"Unknown error"),"error")}finally{u(!1)}},_=(j,R,H,Y,U)=>{a(V=>({...V,[j]:{...V[j],[R]:{...V[j]?.[R],[H]:{...V[j]?.[R]?.[H],[Y]:U}}}}))},S=j=>j.charAt(0).toUpperCase()+j.slice(1),E=j=>j.charAt(0).toUpperCase()+j.slice(1),C=j=>j==="pla"?"PLA (Prevailing Wage)":"Standard (Private)";return m?l.jsx("div",{className:"loading",children:"Loading labor rates..."}):l.jsxs("div",{className:"pricing-section",children:[l.jsxs("div",{className:"pricing-section-header",children:[l.jsxs("div",{children:[l.jsx("h2",{children:"Labor Rates"}),l.jsx("p",{className:"section-desc",children:"Configure hourly rates by role, work type, and job classification"})]}),n?l.jsxs("div",{className:"rate-actions",children:[l.jsx("button",{className:"btn btn-secondary",onClick:()=>{s(!1),g()},children:"Cancel"}),l.jsx("button",{className:"btn btn-primary",onClick:b,disabled:o,children:o?"Saving...":"Save All Rates"})]}):l.jsx("button",{className:"btn btn-primary",onClick:()=>s(!0),children:"Edit Rates"})]}),l.jsx("div",{className:"work-type-tabs",children:$v.map(j=>l.jsx("button",{className:`work-type-tab ${f===j?"active":""}`,onClick:()=>h(j),children:E(j)},j))}),l.jsx("div",{className:"labor-rates-container",children:Wv.map(j=>l.jsxs("div",{className:"job-type-section",children:[l.jsx("h3",{className:"job-type-header",children:C(j)}),l.jsxs("div",{className:"rates-table",children:[l.jsxs("div",{className:"rates-table-header",children:[l.jsx("div",{className:"rate-cell role-cell",children:"Role"}),l.jsx("div",{className:"rate-cell",children:"Regular"}),l.jsx("div",{className:"rate-cell",children:"Overtime"})]}),Hv.map(R=>{const H=r[f]?.[j]?.[R]||{regular:"",overtime:""};return l.jsxs("div",{className:"rates-table-row",children:[l.jsx("div",{className:"rate-cell role-cell",children:S(R)}),l.jsx("div",{className:"rate-cell",children:n?l.jsxs("div",{className:"rate-input-inline",children:[l.jsx("span",{children:"$"}),l.jsx("input",{type:"number",value:H.regular,onChange:Y=>_(f,j,R,"regular",Y.target.value),placeholder:"0.00",step:"0.01"}),l.jsx("span",{children:"/hr"})]}):l.jsxs("span",{className:"rate-value",children:["$",(parseFloat(H.regular)||0).toFixed(2),"/hr"]})}),l.jsx("div",{className:"rate-cell",children:n?l.jsxs("div",{className:"rate-input-inline",children:[l.jsx("span",{children:"$"}),l.jsx("input",{type:"number",value:H.overtime,onChange:Y=>_(f,j,R,"overtime",Y.target.value),placeholder:"0.00",step:"0.01"}),l.jsx("span",{children:"/hr"})]}):l.jsxs("span",{className:"rate-value ot",children:["$",(parseFloat(H.overtime)||0).toFixed(2),"/hr"]})})]},R)})]})]},j))})]})}const Np=["Containment","PPE","Disposal","Equipment"];function UH({company:t,onShowToast:e}){const[r,a]=se.useState([]),[n,s]=se.useState(!0),[o,u]=se.useState("all"),[f,h]=se.useState(null),[m,v]=se.useState(!1),[y,g]=se.useState({name:"",category:"Equipment",unit:"each",cost_per_unit:""}),[b,_]=se.useState([]),[S,E]=se.useState(!1);se.useEffect(()=>{t?.id&&C()},[t?.id]);const C=async()=>{s(!0);try{const P=await ut.getAllMaterialsEquipment(t.id);a(P||[]),j(P||[])}catch(P){console.error("Error loading items:",P),e("Error loading materials","error")}finally{s(!1)}},j=P=>{const O={},I=[];P.filter(ne=>ne.active!==!1).forEach(ne=>{const Q=ne.name.toLowerCase().trim();O[Q]||(O[Q]=[]),O[Q].push(ne)}),Object.entries(O).forEach(([ne,Q])=>{Q.length>1&&I.push({name:ne,items:Q})}),_(I)},R=async P=>{try{const O=P.items.filter(ne=>ne.cost_per_unit>0),I=O.length>0?O[0]:P.items[0],W=P.items.filter(ne=>ne.id!==I.id);for(const ne of W)await ut.deleteMaterialEquipment(ne.id);e(`Merged ${P.items.length} items into one`,"success"),C()}catch(O){console.error("Error merging duplicates:",O),e("Error merging duplicates","error")}},H=async()=>{if(confirm(`Merge all ${b.length} duplicate groups?`))try{for(const P of b){const O=P.items.filter(ne=>ne.cost_per_unit>0),I=O.length>0?O[0]:P.items[0],W=P.items.filter(ne=>ne.id!==I.id);for(const ne of W)await ut.deleteMaterialEquipment(ne.id)}e("All duplicates merged!","success"),C(),E(!1)}catch(P){console.error("Error merging all duplicates:",P),e("Error merging duplicates","error")}},Y=async()=>{if(!y.name.trim()){e("Enter item name","error");return}try{await ut.createMaterialEquipment({company_id:t.id,name:y.name.trim(),category:y.category,unit:y.unit||"each",cost_per_unit:parseFloat(y.cost_per_unit)||0,active:!0}),e("Item added","success"),g({name:"",category:"Equipment",unit:"each",cost_per_unit:""}),v(!1),C()}catch(P){console.error("Error adding item:",P),e("Error adding item","error")}},U=async P=>{try{await ut.updateMaterialEquipment(P.id,{name:P.name,category:P.category,unit:P.unit,cost_per_unit:parseFloat(P.cost_per_unit)||0}),e("Item updated","success"),h(null),C()}catch(O){console.error("Error updating item:",O),e("Error updating item","error")}},V=async P=>{if(confirm("Delete this item?"))try{await ut.deleteMaterialEquipment(P),e("Item deleted","success"),C()}catch(O){console.error("Error deleting item:",O),e("Error deleting item","error")}},F=o==="all"?r.filter(P=>P.active!==!1):r.filter(P=>P.category===o&&P.active!==!1),X=F.reduce((P,O)=>{const I=O.category||"Other";return P[I]||(P[I]=[]),P[I].push(O),P},{});return n?l.jsx("div",{className:"loading",children:"Loading materials..."}):l.jsxs("div",{className:"pricing-section",children:[l.jsxs("div",{className:"materials-header",children:[l.jsxs("div",{className:"materials-title",children:[l.jsx("h2",{children:"Materials & Equipment"}),l.jsxs("span",{className:"materials-count",children:[r.filter(P=>P.active!==!1).length," items"]})]}),l.jsxs("div",{className:"materials-actions",children:[b.length>0&&l.jsxs("button",{className:`btn btn-warning ${S?"active":""}`,onClick:()=>E(!S),children:[b.length," Duplicates"]}),l.jsx("button",{className:"btn btn-primary",onClick:()=>v(!0),children:"+ Add Item"})]})]}),S&&b.length>0&&l.jsxs("div",{className:"duplicates-panel",children:[l.jsxs("div",{className:"duplicates-header",children:[l.jsx("h3",{children:"Duplicate Items Found"}),l.jsxs("button",{className:"btn btn-success btn-small",onClick:H,children:["Merge All (",b.length,")"]})]}),l.jsx("div",{className:"duplicates-list",children:b.map((P,O)=>l.jsxs("div",{className:"duplicate-group",children:[l.jsxs("div",{className:"duplicate-name",children:['"',P.name,'" x ',P.items.length]}),l.jsx("div",{className:"duplicate-items",children:P.items.map(I=>l.jsxs("span",{className:"duplicate-item",children:[I.category," - $",I.cost_per_unit||0]},I.id))}),l.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>R(P),children:"Merge"})]},O))})]}),m&&l.jsxs("div",{className:"add-item-form",children:[l.jsx("h3",{children:"Add New Item"}),l.jsxs("div",{className:"form-row",children:[l.jsx("input",{type:"text",placeholder:"Item Name",value:y.name,onChange:P=>g({...y,name:P.target.value}),autoFocus:!0}),l.jsx("select",{value:y.category,onChange:P=>g({...y,category:P.target.value}),children:Np.map(P=>l.jsx("option",{value:P,children:P},P))})]}),l.jsxs("div",{className:"form-row",children:[l.jsx("input",{type:"text",placeholder:"Unit (e.g., each, day, hour)",value:y.unit,onChange:P=>g({...y,unit:P.target.value})}),l.jsx("input",{type:"number",placeholder:"Cost per unit",value:y.cost_per_unit,onChange:P=>g({...y,cost_per_unit:P.target.value}),step:"0.01"})]}),l.jsxs("div",{className:"form-actions",children:[l.jsx("button",{className:"btn btn-secondary",onClick:()=>v(!1),children:"Cancel"}),l.jsx("button",{className:"btn btn-primary",onClick:Y,children:"Add Item"})]})]}),l.jsxs("div",{className:"materials-filter",children:[l.jsx("button",{className:`filter-tab ${o==="all"?"active":""}`,onClick:()=>u("all"),children:"All"}),Np.map(P=>l.jsxs("button",{className:`filter-tab ${o===P?"active":""}`,onClick:()=>u(P),children:[P,l.jsx("span",{className:"filter-count",children:r.filter(O=>O.category===P&&O.active!==!1).length})]},P))]}),l.jsxs("div",{className:"materials-list",children:[o==="all"?Object.entries(X).map(([P,O])=>l.jsxs("div",{className:"materials-category",children:[l.jsx("h3",{className:"category-header",children:P}),l.jsx("div",{className:"category-items",children:O.map(I=>l.jsx(RS,{item:I,editingItem:f,setEditingItem:h,handleUpdateItem:U,handleDeleteItem:V,categories:Np},I.id))})]},P)):l.jsxs("div",{className:"materials-category",children:[l.jsx("h3",{className:"category-header",children:o}),l.jsx("div",{className:"category-items",children:F.map(P=>l.jsx(RS,{item:P,editingItem:f,setEditingItem:h,handleUpdateItem:U,handleDeleteItem:V,categories:Np},P.id))})]}),F.length===0&&l.jsx("div",{className:"empty-state",children:l.jsx("p",{children:"No items in this category"})})]})]})}function RS({item:t,editingItem:e,setEditingItem:r,handleUpdateItem:a,handleDeleteItem:n,categories:s}){return e?.id===t.id?l.jsx("div",{className:"material-item",children:l.jsxs("div",{className:"item-edit-form",children:[l.jsx("input",{type:"text",value:e.name,onChange:o=>r({...e,name:o.target.value})}),l.jsx("select",{value:e.category,onChange:o=>r({...e,category:o.target.value}),children:s.map(o=>l.jsx("option",{value:o,children:o},o))}),l.jsx("input",{type:"text",value:e.unit,onChange:o=>r({...e,unit:o.target.value}),placeholder:"Unit"}),l.jsx("input",{type:"number",value:e.cost_per_unit,onChange:o=>r({...e,cost_per_unit:o.target.value}),placeholder:"Cost",step:"0.01"}),l.jsxs("div",{className:"edit-actions",children:[l.jsx("button",{className:"btn btn-success btn-small",onClick:()=>a(e),children:"Save"}),l.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>r(null),children:"Cancel"})]})]})}):l.jsxs("div",{className:"material-item",children:[l.jsxs("div",{className:"item-info",children:[l.jsx("span",{className:"item-name",children:t.name}),l.jsx("span",{className:"item-unit",children:t.unit||"each"})]}),l.jsxs("div",{className:"item-cost",children:["$",(t.cost_per_unit||0).toFixed(2)]}),l.jsxs("div",{className:"item-actions",children:[l.jsx("button",{className:"btn-icon",onClick:()=>r({...t}),title:"Edit",children:l.jsx(U4,{size:16})}),l.jsx("button",{className:"btn-icon danger",onClick:()=>n(t.id),title:"Delete",children:l.jsx(cf,{size:16})})]})]})}const qH=[{id:"trash",label:"Trash",description:"General debris"},{id:"metal",label:"Metal",description:"Scrap metal (recyclable)"},{id:"copper",label:"Copper",description:"Copper scrap (recyclable)"},{id:"concrete",label:"Concrete",description:"Concrete/masonry"},{id:"hazardous",label:"Hazardous",description:"Hazardous materials"}];function zH({company:t,onShowToast:e}){const[r,a]=se.useState([]),[n,s]=se.useState(!0),[o,u]=se.useState(!1),[f,h]=se.useState(null),[m,v]=se.useState({name:"",address:"",notes:""}),[y,g]=se.useState(!1),[b,_]=se.useState({}),S=se.useRef({});se.useEffect(()=>{t?.id&&E()},[t?.id]),se.useEffect(()=>()=>{Object.values(S.current).forEach(F=>clearTimeout(F))},[]);const E=async()=>{s(!0);try{const F=await ut.getDumpSites(t.id);a(F||[])}catch(F){console.error("Error loading dump sites:",F),e("Error loading dump sites","error")}finally{s(!1)}},C=async()=>{if(!m.name.trim()){e("Please enter a site name","error");return}g(!0);try{await ut.createDumpSite(t.id,m.name,m.address,m.notes),e("Dump site added","success"),v({name:"",address:"",notes:""}),u(!1),E()}catch(F){console.error("Error adding dump site:",F),e("Error adding dump site","error")}finally{g(!1)}},j=async()=>{if(!f?.name.trim()){e("Please enter a site name","error");return}g(!0);try{await ut.updateDumpSite(f.id,{name:f.name,address:f.address,notes:f.notes}),e("Dump site updated","success"),h(null),E()}catch(F){console.error("Error updating dump site:",F),e("Error updating dump site","error")}finally{g(!1)}},R=async F=>{if(confirm("Are you sure you want to delete this dump site?"))try{await ut.deleteDumpSite(F),e("Dump site deleted","success"),E()}catch(X){console.error("Error deleting dump site:",X),e("Error deleting dump site","error")}},H=se.useCallback(async(F,X,P)=>{try{await ut.setDumpSiteRate(F,X,P),a(O=>O.map(I=>{if(I.id===F){const W=[...I.dump_site_rates||[]],ne=W.findIndex(Q=>Q.waste_type===X);return ne>=0?W[ne]={...W[ne],estimated_cost_per_load:P}:W.push({waste_type:X,estimated_cost_per_load:P}),{...I,dump_site_rates:W}}return I})),_(O=>{const I={...O};return delete I[`${F}-${X}`],I})}catch(O){console.error("Error saving rate:",O?.message||O),e("Error saving rate","error")}},[e]),Y=(F,X,P)=>{const O=`${F}-${X}`;_(I=>({...I,[O]:P})),S.current[O]&&clearTimeout(S.current[O]),S.current[O]=setTimeout(()=>{const I=parseFloat(P)||0;H(F,X,I)},500)},U=(F,X)=>{const P=`${F.id}-${X}`;return b[P]!==void 0?b[P]:F.dump_site_rates?.find(I=>I.waste_type===X)?.estimated_cost_per_load??""},V=F=>{if(F===""||F===null||F===void 0)return"";const X=parseFloat(F);return X<0?`-$${Math.abs(X).toFixed(0)}`:`$${X.toFixed(0)}`};return n?l.jsx("div",{className:"loading",children:"Loading dump sites..."}):l.jsxs("div",{className:"pricing-section",children:[l.jsxs("div",{className:"dump-site-header",children:[l.jsxs("div",{children:[l.jsx("h2",{children:"Disposal & Haul-Off"}),l.jsx("p",{className:"section-desc",children:"Configure dump sites and estimated costs per load for each waste type. Use negative values for recyclables (metal, copper) to indicate revenue."})]}),l.jsx("button",{className:"btn btn-primary",onClick:()=>u(!0),children:"+ Add Dump Site"})]}),o&&l.jsxs("div",{className:"dump-site-form card",children:[l.jsx("h4",{children:"Add Dump Site"}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Site Name *"}),l.jsx("input",{type:"text",value:m.name,onChange:F=>v({...m,name:F.target.value}),placeholder:"e.g., Metro Landfill"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Address"}),l.jsx("input",{type:"text",value:m.address,onChange:F=>v({...m,address:F.target.value}),placeholder:"123 Main St, City"})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Notes"}),l.jsx("input",{type:"text",value:m.notes,onChange:F=>v({...m,notes:F.target.value}),placeholder:"Operating hours, contact, etc."})]}),l.jsxs("div",{className:"form-actions",children:[l.jsx("button",{className:"btn btn-secondary",onClick:()=>u(!1),children:"Cancel"}),l.jsx("button",{className:"btn btn-primary",onClick:C,disabled:y,children:y?"Adding...":"Add Site"})]})]}),r.length===0?l.jsxs("div",{className:"dump-site-empty",children:[l.jsx("p",{children:"No dump sites configured yet."}),l.jsx("p",{children:"Add a dump site to start tracking haul-off costs."})]}):l.jsx("div",{className:"dump-sites-list",children:r.map(F=>l.jsxs("div",{className:"dump-site-card card",children:[f?.id===F.id?l.jsxs("div",{className:"dump-site-edit",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Site Name *"}),l.jsx("input",{type:"text",value:f.name,onChange:X=>h({...f,name:X.target.value})})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Address"}),l.jsx("input",{type:"text",value:f.address||"",onChange:X=>h({...f,address:X.target.value})})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{children:"Notes"}),l.jsx("input",{type:"text",value:f.notes||"",onChange:X=>h({...f,notes:X.target.value})})]}),l.jsxs("div",{className:"form-actions",children:[l.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>h(null),children:"Cancel"}),l.jsx("button",{className:"btn btn-primary btn-sm",onClick:j,disabled:y,children:y?"Saving...":"Save"})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"dump-site-info",children:[l.jsx("div",{className:"dump-site-name",children:F.name}),F.address&&l.jsx("div",{className:"dump-site-address",children:F.address}),F.notes&&l.jsx("div",{className:"dump-site-notes",children:F.notes})]}),l.jsxs("div",{className:"dump-site-actions",children:[l.jsx("button",{className:"btn-icon",onClick:()=>h({...F}),title:"Edit",children:l.jsx(U4,{size:16})}),l.jsx("button",{className:"btn-icon",onClick:()=>R(F.id),title:"Delete",children:l.jsx(cf,{size:16})})]})]}),l.jsxs("div",{className:"dump-site-rates",children:[l.jsx("div",{className:"rates-header",children:"Estimated Cost per Load"}),l.jsx("div",{className:"rates-grid",children:qH.map(X=>l.jsxs("div",{className:"rate-item",children:[l.jsxs("label",{children:[l.jsx("span",{className:"rate-label",children:X.label}),l.jsx("span",{className:"rate-desc",children:X.description})]}),l.jsxs("div",{className:"rate-input-wrapper",children:[l.jsx("span",{className:"rate-prefix",children:"$"}),l.jsx("input",{type:"number",className:"rate-input",value:U(F,X.id),onChange:P=>Y(F.id,X.id,P.target.value),placeholder:"0"})]}),U(F,X.id)!==""&&l.jsxs("span",{className:`rate-preview ${parseFloat(U(F,X.id))<0?"revenue":"cost"}`,children:[V(U(F,X.id)),"/load"]})]},X.id))}),l.jsx("div",{className:"rates-note",children:"Tip: Use negative values for recyclables that generate revenue (e.g., -50 for metal)"})]})]},F.id))})]})}const HH=[{id:"labor",label:"Labor Rates",Icon:Ui},{id:"materials",label:"Materials & Equipment",Icon:Y2},{id:"disposal",label:"Disposal & Haul-Off",Icon:l1}];function $H({company:t,onShowToast:e}){const[r,a]=se.useState("labor");return l.jsxs("div",{className:"pricing-manager",children:[l.jsxs("div",{className:"pricing-header",children:[l.jsx("h1",{children:"Pricing Configuration"}),l.jsx("p",{className:"pricing-subtitle",children:"Set up labor rates, materials pricing, and disposal costs"})]}),l.jsx("div",{className:"pricing-tabs",children:HH.map(n=>l.jsxs("button",{className:`pricing-tab ${r===n.id?"active":""}`,onClick:()=>a(n.id),children:[l.jsx(n.Icon,{size:18,className:"pricing-tab-icon"}),l.jsx("span",{className:"pricing-tab-label",children:n.label})]},n.id))}),l.jsxs("div",{className:"pricing-content",children:[r==="labor"&&l.jsx(BH,{company:t,onShowToast:e}),r==="materials"&&l.jsx(UH,{company:t,onShowToast:e}),r==="disposal"&&l.jsx(zH,{company:t,onShowToast:e})]})]})}function WH({shareToken:t}){const[e,r]=se.useState(!0),[a,n]=se.useState(null),[s,o]=se.useState(null),[u,f]=se.useState(0),{branding:h}=od();se.useEffect(()=>{m()},[t]);const m=async()=>{r(!0),n(null);try{const R=await ut.getPublicProjectData(t);if(!R){n("This share link is invalid or has expired.");return}o(R)}catch(R){console.error("Error loading public data:",R),n("Failed to load project data.")}finally{r(!1)}},v=R=>R?new Date(R).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",y=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(R);if(e)return l.jsxs("div",{className:"public-view",children:[l.jsxs("div",{className:"loading-container",children:[l.jsx("div",{className:"spinner"}),l.jsx("p",{children:"Loading project..."})]}),l.jsx("style",{children:Vv})]});if(a)return l.jsxs("div",{className:"public-view",children:[l.jsxs("div",{className:"error-container",children:[l.jsx("div",{className:"error-icon",children:l.jsx(o1,{size:48})}),l.jsx("h2",{children:a}),l.jsx("p",{children:"Please contact the project owner for a valid link."})]}),l.jsx("style",{children:Vv})]});const{share:g,project:b,progress:_,areas:S,photos:E,dailyReports:C,tmTickets:j}=s;return l.jsxs("div",{className:"public-view",children:[l.jsx("header",{className:"public-header",children:l.jsxs("div",{className:"container",children:[l.jsx(Nl,{size:"large"}),l.jsx("div",{className:"header-meta",children:l.jsxs("span",{className:"last-updated",children:["Last updated: ",v(b.updated_at||b.created_at)]})})]})}),l.jsx("main",{className:"public-main",children:l.jsxs("div",{className:"container",children:[l.jsxs("div",{className:"project-header",children:[l.jsx("h1",{children:b.name}),b.address&&l.jsx("p",{className:"project-address",children:b.address})]}),g.permissions.progress&&l.jsxs("div",{className:"public-card progress-card",children:[l.jsx("h2",{children:"Project Progress"}),l.jsxs("div",{className:"progress-visual",children:[l.jsxs("div",{className:"progress-circle",children:[l.jsxs("svg",{viewBox:"0 0 100 100",children:[l.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),l.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"var(--primary-color, #3b82f6)",strokeWidth:"8",strokeDasharray:`${_*2.827} 282.7`,strokeLinecap:"round",transform:"rotate(-90 50 50)"})]}),l.jsxs("div",{className:"progress-percentage",children:[_,"%"]})]}),l.jsxs("div",{className:"progress-details",children:[l.jsx("div",{className:"progress-label",children:"Complete"}),S&&S.length>0&&l.jsxs("div",{className:"areas-summary",children:[S.filter(R=>R.status==="done").length," of ",S.length," areas completed"]})]})]}),S&&S.length>0&&l.jsxs("div",{className:"areas-list",children:[l.jsx("h3",{children:"Work Areas"}),S.map(R=>l.jsxs("div",{className:"area-item",children:[l.jsxs("div",{className:"area-info",children:[l.jsx("span",{className:"area-name",children:R.name}),l.jsxs("span",{className:"area-weight",children:[R.weight,"%"]})]}),l.jsx("div",{className:`area-status status-${R.status}`,children:R.status==="done"?" Complete":R.status==="working"?" In Progress":" Not Started"})]},R.id))]})]}),g.permissions.photos&&E&&E.length>0&&l.jsxs("div",{className:"public-card photos-card",children:[l.jsx("h2",{children:"Recent Photos"}),l.jsxs("div",{className:"photos-carousel",children:[l.jsxs("div",{className:"carousel-main",children:[E[u]&&l.jsx("img",{src:E[u].url,alt:`Project photo from ${v(E[u].date)}`,className:"carousel-image"}),l.jsx("div",{className:"carousel-date",children:v(E[u]?.date)})]}),l.jsx("div",{className:"carousel-thumbnails",children:E.slice(0,10).map((R,H)=>l.jsx("div",{className:`thumbnail ${H===u?"active":""}`,onClick:()=>f(H),children:l.jsx("img",{src:R.url,alt:`Thumbnail ${H+1}`})},H))}),E.length>1&&l.jsxs("div",{className:"carousel-controls",children:[l.jsx("button",{onClick:()=>f(R=>R>0?R-1:E.length-1),className:"carousel-btn",children:""}),l.jsxs("span",{className:"carousel-counter",children:[u+1," / ",E.length]}),l.jsx("button",{onClick:()=>f(R=>R<E.length-1?R+1:0),className:"carousel-btn",children:""})]})]})]}),g.permissions.daily_reports&&C&&C.length>0&&l.jsxs("div",{className:"public-card reports-card",children:[l.jsx("h2",{children:"Daily Reports"}),l.jsx("div",{className:"reports-list",children:C.map((R,H)=>l.jsxs("div",{className:"report-item",children:[l.jsx("div",{className:"report-date",children:v(R.report_date)}),l.jsxs("div",{className:"report-content",children:[R.crew_count&&l.jsxs("div",{className:"report-field",children:[l.jsx("strong",{children:"Crew:"})," ",R.crew_count," workers"]}),R.tasks_completed&&l.jsxs("div",{className:"report-field",children:[l.jsx("strong",{children:"Tasks Completed:"})," ",R.tasks_completed]}),R.weather&&l.jsxs("div",{className:"report-field",children:[l.jsx("strong",{children:"Weather:"})," ",R.weather]}),R.notes&&l.jsxs("div",{className:"report-field",children:[l.jsx("strong",{children:"Notes:"})," ",R.notes]})]})]},H))})]}),g.permissions.tm_tickets&&j&&j.length>0&&l.jsxs("div",{className:"public-card tm-card",children:[l.jsx("h2",{children:"Time & Materials Tickets"}),l.jsx("div",{className:"tm-list",children:j.map((R,H)=>l.jsxs("div",{className:"tm-item",children:[l.jsxs("div",{className:"tm-header",children:[l.jsx("span",{className:"tm-date",children:v(R.work_date)}),l.jsx("span",{className:`tm-status status-${R.status}`,children:R.status})]}),R.description&&l.jsx("div",{className:"tm-description",children:R.description}),R.total_amount&&l.jsxs("div",{className:"tm-amount",children:["Total: ",y(R.total_amount)]})]},H))})]})]})}),l.jsx("footer",{className:"public-footer",children:l.jsx("div",{className:"container",children:!h?.hide_fieldsync_branding&&l.jsx("p",{children:"Powered by FieldSync"})})}),l.jsx("style",{children:Vv})]})}const Vv=`
  .public-view {
    min-height: 100vh;
    background-color: #f9fafb;
    display: flex;
    flex-direction: column;
  }

  .container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 1rem;
    width: 100%;
  }

  /* Header */
  .public-header {
    background-color: white;
    border-bottom: 1px solid #e5e7eb;
    padding: 1.5rem 0;
  }

  .public-header .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .header-meta {
    font-size: 0.875rem;
    color: #6b7280;
  }

  /* Main Content */
  .public-main {
    flex: 1;
    padding: 2rem 0;
  }

  .project-header {
    margin-bottom: 2rem;
  }

  .project-header h1 {
    font-size: 2rem;
    margin: 0 0 0.5rem 0;
    color: #111827;
  }

  .project-address {
    font-size: 1rem;
    color: #6b7280;
    margin: 0;
  }

  /* Cards */
  .public-card {
    background-color: white;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .public-card h2 {
    font-size: 1.5rem;
    margin: 0 0 1.5rem 0;
    color: #111827;
  }

  .public-card h3 {
    font-size: 1.125rem;
    margin: 1.5rem 0 1rem 0;
    color: #374151;
  }

  /* Progress Card */
  .progress-visual {
    display: flex;
    align-items: center;
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .progress-circle {
    position: relative;
    width: 150px;
    height: 150px;
    flex-shrink: 0;
  }

  .progress-circle svg {
    width: 100%;
    height: 100%;
  }

  .progress-percentage {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2rem;
    font-weight: bold;
    color: var(--primary-color, #3b82f6);
  }

  .progress-details {
    flex: 1;
  }

  .progress-label {
    font-size: 1.25rem;
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.5rem;
  }

  .areas-summary {
    font-size: 1rem;
    color: #6b7280;
  }

  /* Areas List */
  .areas-list {
    border-top: 1px solid #e5e7eb;
    padding-top: 1rem;
  }

  .area-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 0;
    border-bottom: 1px solid #f3f4f6;
  }

  .area-item:last-child {
    border-bottom: none;
  }

  .area-info {
    flex: 1;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-right: 1rem;
  }

  .area-name {
    font-weight: 500;
    color: #374151;
  }

  .area-weight {
    color: #6b7280;
    font-size: 0.875rem;
  }

  .area-status {
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    white-space: nowrap;
  }

  .area-status.status-done {
    background-color: #d1fae5;
    color: #065f46;
  }

  .area-status.status-working {
    background-color: #fef3c7;
    color: #92400e;
  }

  .area-status.status-not_started {
    background-color: #f3f4f6;
    color: #6b7280;
  }

  /* Photos Carousel */
  .photos-carousel {
    position: relative;
  }

  .carousel-main {
    position: relative;
    width: 100%;
    height: 400px;
    background-color: #111827;
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 1rem;
  }

  .carousel-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }

  .carousel-date {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
    color: white;
    padding: 1rem;
    text-align: center;
  }

  .carousel-thumbnails {
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
  }

  .thumbnail {
    flex-shrink: 0;
    width: 80px;
    height: 80px;
    border-radius: 4px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: border-color 0.2s;
  }

  .thumbnail:hover {
    border-color: #d1d5db;
  }

  .thumbnail.active {
    border-color: var(--primary-color, #3b82f6);
  }

  .thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .carousel-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
  }

  .carousel-btn {
    background-color: white;
    border: 1px solid #d1d5db;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.25rem;
    transition: background-color 0.2s;
  }

  .carousel-btn:hover {
    background-color: #f3f4f6;
  }

  .carousel-counter {
    font-size: 0.875rem;
    color: #6b7280;
  }

  /* Daily Reports */
  .reports-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .report-item {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1rem;
  }

  .report-date {
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.75rem;
    font-size: 1.125rem;
  }

  .report-content {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .report-field {
    color: #374151;
    line-height: 1.5;
  }

  .report-field strong {
    color: #111827;
  }

  /* T&M Tickets */
  .tm-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .tm-item {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1rem;
  }

  .tm-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
  }

  .tm-date {
    font-weight: 600;
    color: #111827;
  }

  .tm-status {
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    text-transform: capitalize;
  }

  .tm-status.status-approved {
    background-color: #d1fae5;
    color: #065f46;
  }

  .tm-status.status-pending {
    background-color: #fef3c7;
    color: #92400e;
  }

  .tm-status.status-rejected {
    background-color: #fee2e2;
    color: #991b1b;
  }

  .tm-description {
    color: #374151;
    margin-bottom: 0.5rem;
  }

  .tm-amount {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--primary-color, #3b82f6);
  }

  /* Footer */
  .public-footer {
    background-color: white;
    border-top: 1px solid #e5e7eb;
    padding: 2rem 0;
    margin-top: auto;
  }

  .public-footer p {
    text-align: center;
    color: #6b7280;
    margin: 0;
    font-size: 0.875rem;
  }

  /* Loading & Error States */
  .loading-container,
  .error-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 2rem;
  }

  .spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #e5e7eb;
    border-top-color: var(--primary-color, #3b82f6);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .loading-container p {
    margin-top: 1rem;
    color: #6b7280;
  }

  .error-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
  }

  .error-container h2 {
    color: #111827;
    margin: 0 0 0.5rem 0;
  }

  .error-container p {
    color: #6b7280;
    margin: 0;
  }

  /* Mobile Responsive */
  @media (max-width: 768px) {
    .project-header h1 {
      font-size: 1.5rem;
    }

    .public-card {
      padding: 1.5rem;
    }

    .progress-visual {
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .progress-circle {
      width: 120px;
      height: 120px;
    }

    .progress-percentage {
      font-size: 1.5rem;
    }

    .carousel-main {
      height: 300px;
    }

    .area-item {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }

    .area-info {
      width: 100%;
      margin-right: 0;
    }
  }
`;function VH({company:t,projects:e,userId:r,onNotificationClick:a,onShowToast:n}){const[s,o]=se.useState([]),[u,f]=se.useState(0),[h,m]=se.useState(!1),[v,y]=se.useState(!1),[g,b]=se.useState({}),_=se.useRef(null);se.useRef(null);const S=se.useRef(null);se.useEffect(()=>{r&&E()},[r]);const E=async()=>{try{const O=await ut.getUserNotificationPreferences(r),I={};O.forEach(W=>{I[W.project_id]=W.notification_types||[]}),b(I)}catch(O){console.error("Error loading user preferences:",O)}},C=(O,I)=>g[O]?g[O].length===0?!1:g[O].includes(I):!0;se.useEffect(()=>{if(!t?.id||!e||e.length===0)return;j();const O=R();return()=>{O&&ut.unsubscribe(O)}},[t?.id,e,g]),se.useEffect(()=>()=>{S.current&&(S.current.close().catch(()=>{}),S.current=null)},[]),se.useEffect(()=>{function O(I){_.current&&!_.current.contains(I.target)&&m(!1)}return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[]);const j=async()=>{if(!e||e.length===0)return;const O=[];for(const I of e)try{C(I.id,"message")&&(await ut.getMessages(I.id,20)).filter(Q=>Q.sender_type==="field"&&!Q.is_read).forEach(Q=>{O.push({id:`msg-${Q.id}`,type:"message",title:"New Message",message:Q.message?.slice(0,50)+(Q.message?.length>50?"...":""),projectId:I.id,projectName:I.name,senderName:Q.sender_name,createdAt:Q.created_at,isRead:Q.is_read,data:Q})}),C(I.id,"material_request")&&(await ut.getMaterialRequests(I.id,"pending")).forEach(ne=>{O.push({id:`req-${ne.id}`,type:"material_request",title:"Material Request",message:`${ne.items?.length||0} items requested`,projectId:I.id,projectName:I.name,senderName:ne.requested_by,priority:ne.priority,createdAt:ne.created_at,isRead:!1,data:ne})})}catch(W){console.error("Error loading notifications for project:",I.id,W)}try{(await ut.getCompanyInjuryReports(t.id,"open")).slice(0,5).forEach(W=>{if(C(W.project_id,"injury_report")){const ne=e.find(Q=>Q.id===W.project_id);O.push({id:`injury-${W.id}`,type:"injury_report",title:"Safety Report",message:`${W.injury_type} - ${W.injured_person_name}`,projectId:W.project_id,projectName:ne?.name||"Unknown Project",senderName:W.reported_by_name,createdAt:W.created_at,isRead:W.status!=="open",data:W})}})}catch(I){console.error("Error loading injury reports:",I)}O.sort((I,W)=>new Date(W.createdAt)-new Date(I.createdAt)),o(O.slice(0,50)),f(O.filter(I=>!I.isRead).length)},R=()=>{if(!t?.id||!e||e.length===0)return null;const O=e.map(W=>W.id),I=ut.subscribeToCompanyActivity(t.id,O,{onMessage:W=>{if(W.new?.sender_type==="field"){if(!C(W.new.project_id,"message"))return;H({id:`msg-${W.new.id}`,type:"message",title:"New Message",message:W.new.message?.slice(0,50)+(W.new.message?.length>50?"...":""),projectId:W.new.project_id,projectName:e.find(ne=>ne.id===W.new.project_id)?.name||"Project",senderName:W.new.sender_name,createdAt:W.new.created_at,isRead:!1,data:W.new})}},onMaterialRequest:W=>{C(W.new.project_id,"material_request")&&H({id:`req-${W.new.id}`,type:"material_request",title:"Material Request",message:`${W.new.items?.length||0} items requested`,projectId:W.new.project_id,projectName:e.find(ne=>ne.id===W.new.project_id)?.name||"Project",senderName:W.new.requested_by,priority:W.new.priority,createdAt:W.new.created_at,isRead:!1,data:W.new})},onTMTicket:W=>{if(W.eventType==="INSERT"){if(!C(W.new.project_id,"tm_ticket"))return;H({id:`tm-${W.new.id}`,type:"tm_ticket",title:"New T&M Ticket",message:`Submitted by ${W.new.created_by_name||"Field"}`,projectId:W.new.project_id,projectName:e.find(ne=>ne.id===W.new.project_id)?.name||"Project",senderName:W.new.created_by_name,createdAt:W.new.created_at,isRead:!1,data:W.new})}},onInjuryReport:W=>{C(W.new.project_id,"injury_report")&&H({id:`injury-${W.new.id}`,type:"injury_report",title:"Safety Report",message:`${W.new.injury_type} - ${W.new.injured_person_name}`,projectId:W.new.project_id,projectName:e.find(ne=>ne.id===W.new.project_id)?.name||"Project",senderName:W.new.reported_by_name,createdAt:W.new.created_at,isRead:!1,data:W.new})}});return I&&y(!0),I},H=O=>{o(W=>[O,...W.slice(0,49)]),f(W=>W+1),Y();const I=U(O.type);n?.(`${I} ${O.title}: ${O.message}`,"info")},Y=()=>{try{(!S.current||S.current.state==="closed")&&(S.current=new(window.AudioContext||window.webkitAudioContext));const O=S.current;O.state==="suspended"&&O.resume();const I=O.createOscillator(),W=O.createGain();I.connect(W),W.connect(O.destination),I.frequency.value=800,I.type="sine",W.gain.value=.3,I.start(),I.stop(O.currentTime+.15),setTimeout(()=>{if(!S.current||S.current.state==="closed")return;const ne=S.current.createOscillator(),Q=S.current.createGain();ne.connect(Q),Q.connect(S.current.destination),ne.frequency.value=1e3,ne.type="sine",Q.gain.value=.3,ne.start(),ne.stop(S.current.currentTime+.15)},150)}catch{}},U=O=>{switch(O){case"message":return l.jsx(z0,{size:16});case"material_request":return l.jsx(Ef,{size:16});case"injury_report":return l.jsx(V2,{size:16});case"tm_ticket":return l.jsx(fu,{size:16});default:return l.jsx(bC,{size:16})}},V=O=>{switch(O){case"message":return"blue";case"material_request":return"orange";case"injury_report":return"red";case"tm_ticket":return"green";default:return"gray"}},F=O=>{o(I=>I.map(W=>W.id===O.id?{...W,isRead:!0}:W)),f(I=>Math.max(0,I-1)),m(!1),a?.(O)},X=async()=>{for(const O of e)try{await ut.markMessagesRead(O.id,"office")}catch{}o(O=>O.map(I=>({...I,isRead:!0}))),f(0)},P=O=>{const I=new Date(O),ne=new Date-I,Q=Math.floor(ne/6e4),le=Math.floor(ne/36e5),ee=Math.floor(ne/864e5);return Q<1?"Just now":Q<60?`${Q}m ago`:le<24?`${le}h ago`:ee<7?`${ee}d ago`:I.toLocaleDateString()};return l.jsxs("div",{className:"notification-center",ref:_,children:[l.jsxs("button",{className:`notification-bell ${u>0?"has-notifications":""}`,onClick:()=>m(!h),title:`${u} unread notifications`,children:[l.jsx("span",{className:"bell-icon",children:""}),u>0&&l.jsx("span",{className:"notification-badge",children:u>99?"99+":u}),v&&l.jsx("span",{className:"connection-dot"})]}),h&&l.jsxs("div",{className:"notification-dropdown",children:[l.jsxs("div",{className:"notification-header",children:[l.jsx("h4",{children:"Notifications"}),u>0&&l.jsx("button",{className:"mark-all-read",onClick:X,children:"Mark all read"})]}),l.jsx("div",{className:"notification-list",children:s.length===0?l.jsxs("div",{className:"notification-empty",children:[l.jsx("span",{className:"empty-icon",children:""}),l.jsx("p",{children:"No notifications yet"}),l.jsx("small",{children:"You'll see updates from the field here"})]}):s.map(O=>l.jsxs("div",{className:`notification-item ${O.isRead?"read":"unread"} ${V(O.type)}`,onClick:()=>F(O),children:[l.jsx("div",{className:"notification-icon",children:U(O.type)}),l.jsxs("div",{className:"notification-content",children:[l.jsxs("div",{className:"notification-title",children:[O.title,O.priority==="urgent"&&l.jsx("span",{className:"priority-badge urgent",children:"URGENT"})]}),l.jsx("div",{className:"notification-message",children:O.message}),l.jsxs("div",{className:"notification-meta",children:[l.jsx("span",{className:"notification-project",children:O.projectName}),l.jsx("span",{className:"notification-time",children:P(O.createdAt)})]})]}),!O.isRead&&l.jsx("div",{className:"unread-dot"})]},O.id))}),s.length>0&&l.jsx("div",{className:"notification-footer",children:l.jsx("button",{className:"view-all-btn",onClick:()=>{m(!1),a?.({type:"view_all"})},children:"View All Activity"})})]})]})}class kp extends se.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,r){this.setState({error:e,errorInfo:r}),console.error("ErrorBoundary caught an error:",e,r)}handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};handleReload=()=>{window.location.reload()};render(){return this.state.hasError?l.jsx("div",{className:"error-boundary",children:l.jsxs("div",{className:"error-boundary-content",children:[l.jsx("div",{className:"error-icon",children:l.jsx(o1,{size:48})}),l.jsx("h2",{children:"Something went wrong"}),l.jsx("p",{children:"We're sorry, but something unexpected happened. Please try again."}),l.jsxs("div",{className:"error-actions",children:[l.jsx("button",{className:"btn btn-primary",onClick:this.handleRetry,children:"Try Again"}),l.jsx("button",{className:"btn btn-secondary",onClick:this.handleReload,children:"Reload Page"})]}),!1]})}):this.props.children}}function DS(){const[t,e]=se.useState(o0()),[r,a]=se.useState(0),[n,s]=se.useState(!1),[o,u]=se.useState(!1);return se.useEffect(()=>{const f=O4(async m=>{e(m),m&&o&&(s(!0),setTimeout(()=>s(!1),3e3)),m||u(!0);const v=await Xg();a(v)});Xg().then(a);const h=setInterval(async()=>{if(!o0()){const m=await Xg();a(m)}},5e3);return()=>{f(),clearInterval(h)}},[o]),t&&r===0&&!n?null:l.jsxs("div",{className:`offline-indicator ${t?"online":"offline"} ${n?"synced":""}`,children:[l.jsx("div",{className:"offline-indicator-content",children:t?n?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"online-icon",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("polyline",{points:"20 6 9 17 4 12"})})}),l.jsx("span",{className:"offline-text",children:"Changes synced!"})]}):r>0?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"syncing-icon",children:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("polyline",{points:"23 4 23 10 17 10"}),l.jsx("polyline",{points:"1 20 1 14 7 14"}),l.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})}),l.jsxs("span",{className:"offline-text",children:["Syncing ",r,"..."]})]}):null:l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"offline-icon",children:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),l.jsx("path",{d:"M16.72 11.06A10.94 10.94 0 0 1 19 12.55"}),l.jsx("path",{d:"M5 12.55a10.94 10.94 0 0 1 5.17-2.39"}),l.jsx("path",{d:"M10.71 5.05A16 16 0 0 1 22.58 9"}),l.jsx("path",{d:"M1.42 9a15.91 15.91 0 0 1 4.7-2.88"}),l.jsx("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),l.jsx("line",{x1:"12",y1:"20",x2:"12.01",y2:"20"})]})}),l.jsxs("span",{className:"offline-text",children:["Offline",r>0&&l.jsxs("span",{className:"pending-badge",children:[r," pending"]})]})]})}),l.jsx("style",{children:`
        .offline-indicator {
          position: fixed;
          bottom: 20px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 9999;
          padding: 10px 16px;
          border-radius: 24px;
          font-size: 14px;
          font-weight: 500;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
          from {
            transform: translateX(-50%) translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
          }
        }

        .offline-indicator.offline {
          background: #1f2937;
          color: #fbbf24;
        }

        .offline-indicator.online {
          background: #065f46;
          color: #d1fae5;
        }

        .offline-indicator.synced {
          background: #065f46;
          color: #d1fae5;
        }

        .offline-indicator-content {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .offline-icon,
        .online-icon,
        .syncing-icon {
          display: flex;
          align-items: center;
        }

        .syncing-icon svg {
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }

        .offline-text {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .pending-badge {
          background: rgba(251, 191, 36, 0.2);
          padding: 2px 8px;
          border-radius: 12px;
          font-size: 12px;
        }

        @media (max-width: 480px) {
          .offline-indicator {
            bottom: 70px; /* Above mobile nav */
            left: 16px;
            right: 16px;
            transform: none;
          }
        }
      `})]})}function GH(){const[t,e]=se.useState("entry"),[r,a]=se.useState(null),[n,s]=se.useState(null),[o,u]=se.useState([]),[f,h]=se.useState([]),[m,v]=se.useState(null),[y,g]=se.useState(null),[b,_]=se.useState(!0),[S,E]=se.useState("dashboard"),[C,j]=se.useState(null),[R,H]=se.useState(!1),[Y,U]=se.useState(null);se.useEffect(()=>{const ue=window.location.pathname.match(/^\/view\/([a-zA-Z0-9]+)$/);ue?(g(ue[1]),e("public"),_(!1)):V()},[]);const V=async()=>{try{const{data:{user:K}}=await Pe.auth.getUser();if(!K){_(!1);return}const{data:ue,error:M}=await Pe.from("users").select("*").eq("id",K.id).single();if(ue){a(ue);const A=await ut.getUserCompanies(K.id);u(A);const D=localStorage.getItem("selectedCompanyId");let B=null;if(D&&A.find(q=>q.id===D))B=A.find(q=>q.id===D);else if(A.length>0)B=A[0];else if(ue.company_id){const{data:q}=await Pe.from("companies").select("*").eq("id",ue.company_id).single();B=q}if(B){const{data:q}=await Pe.from("companies").select("*").eq("id",B.id).single();s(q),e("office")}}}catch(K){console.error("Auth check error:",K)}finally{_(!1)}},F=K=>{v(K),e("foreman")},X=async(K,ue)=>{try{const{data:M,error:A}=await Pe.auth.signInWithPassword({email:K,password:ue});if(A){W(A.message||"Invalid credentials","error");return}const{data:D,error:B}=await Pe.from("users").select("*").eq("id",M.user.id).single();if(B){console.error("User fetch error:",B),W("Error loading profile","error");return}if(D){a(D);const q=await ut.getUserCompanies(M.user.id);u(q);const Z=localStorage.getItem("selectedCompanyId");let oe=null;if(Z&&q.find(pe=>pe.id===Z))oe=q.find(pe=>pe.id===Z);else if(q.length>0)oe=q[0];else if(D.company_id){const{data:pe}=await Pe.from("companies").select("*").eq("id",D.company_id).single();oe=pe}if(oe){const{data:pe}=await Pe.from("companies").select("*").eq("id",oe.id).single();s(pe),e("office")}else W("No company access. Please contact admin.","error")}else W("Profile not found. Please contact admin.","error")}catch(M){console.error("Login error:",M),W("Login failed","error")}},P=async K=>{try{const{data:ue}=await Pe.from("companies").select("*").eq("id",K).single();ue&&(s(ue),localStorage.setItem("selectedCompanyId",K),H(!1),E("dashboard"),W(`Switched to ${ue.name}`,"success"))}catch(ue){console.error("Switch company error:",ue),W("Error switching company","error")}},O=async()=>{try{await mC.signOut(),a(null),s(null),u([]),e("entry"),E("dashboard"),localStorage.removeItem("selectedCompanyId")}catch(K){console.error("Logout error:",K),W("Error signing out","error")}},I=()=>{v(null),e("entry")},W=(K,ue="")=>{j({message:K,type:ue})},ne=()=>{E("dashboard"),n?.id&&Q()},Q=async()=>{if(n?.id)try{const K=await ut.getProjects(n.id);h(K)}catch(K){console.error("Error loading projects:",K)}};se.useEffect(()=>{n?.id&&t==="office"&&Q()},[n?.id,t]);const le=K=>{if(K.type==="view_all"){E("dashboard"),U(null);return}E("dashboard"),K.projectId&&U(K.projectId)},ee=()=>{U(null)};return b?l.jsx(Jd,{companyId:n?.id,children:l.jsxs("div",{className:"loading-screen",children:[l.jsx(Nl,{className:"loading-logo"}),l.jsx("div",{className:"spinner"})]})}):t==="entry"?l.jsxs(Jd,{children:[l.jsx(kp,{children:l.jsx(TT,{onForemanAccess:F,onOfficeLogin:X,onShowToast:W})}),C&&l.jsx(uf,{message:C.message,type:C.type,onClose:()=>j(null)})]}):t==="public"&&y?l.jsxs(Jd,{children:[l.jsx(kp,{children:l.jsx(WH,{shareToken:y})}),C&&l.jsx(uf,{message:C.message,type:C.type,onClose:()=>j(null)})]}):t==="foreman"&&m?l.jsxs(Jd,{companyId:m.company_id,children:[l.jsx(kp,{children:l.jsx(BT,{project:m,companyId:m.company_id,onShowToast:W,onExit:I})}),l.jsx(DS,{}),C&&l.jsx(uf,{message:C.message,type:C.type,onClose:()=>j(null)})]}):l.jsx(Jd,{companyId:n?.id,children:l.jsxs("div",{children:[!$e&&l.jsx("div",{className:"demo-banner",children:"Demo Mode - Data saved locally in your browser"}),l.jsx("nav",{className:"nav",children:l.jsxs("div",{className:"nav-content",children:[l.jsx(Nl,{}),l.jsxs("div",{className:"nav-tabs",children:[l.jsx("button",{className:`nav-tab ${S==="dashboard"?"active":""}`,onClick:()=>E("dashboard"),children:"Dashboard"}),l.jsx("button",{className:`nav-tab ${S==="setup"?"active":""}`,onClick:()=>E("setup"),children:"+ New Project"}),l.jsx("button",{className:`nav-tab ${S==="pricing"?"active":""}`,onClick:()=>E("pricing"),children:"Pricing"}),l.jsx("button",{className:`nav-tab ${S==="branding"?"active":""}`,onClick:()=>E("branding"),children:"Branding"})]}),l.jsxs("div",{className:"nav-user",children:[l.jsx(VH,{company:n,projects:f,userId:r?.id,onNotificationClick:le,onShowToast:W}),o.length>1&&l.jsxs("div",{className:"company-switcher",children:[l.jsxs("button",{className:"company-switcher-btn",onClick:()=>H(!R),children:[n?.name||"Select Company",l.jsx("span",{className:"switcher-arrow",children:""})]}),R&&l.jsx("div",{className:"company-dropdown",children:o.map(K=>l.jsxs("button",{className:`company-option ${K.id===n?.id?"active":""}`,onClick:()=>P(K.id),children:[K.name,K.id===n?.id&&l.jsx("span",{className:"check",children:""})]},K.id))})]}),o.length<=1&&n&&l.jsx("span",{className:"nav-company-name",children:n.name}),l.jsx("span",{className:"nav-user-name",children:r?.name||r?.email}),l.jsx("button",{className:"nav-logout",onClick:O,children:"Sign Out"})]})]})}),l.jsx(kp,{children:l.jsxs("div",{className:"container",children:[S==="dashboard"&&l.jsx(LH,{company:n,onShowToast:W,navigateToProjectId:Y,onProjectNavigated:ee}),S==="setup"&&l.jsx(MH,{onProjectCreated:ne,onShowToast:W}),S==="pricing"&&l.jsx($H,{company:n,onShowToast:W}),S==="branding"&&l.jsx(IH,{company:n,onShowToast:W})]},n?.id)}),l.jsx(DS,{}),C&&l.jsx(uf,{message:C.message,type:C.type,onClose:()=>j(null)})]})})}AE.createRoot(document.getElementById("root")).render(l.jsx(_E.StrictMode,{children:l.jsx(GH,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered:",t.scope),setInterval(()=>{t.update()},6e4)}).catch(t=>{console.log("SW registration failed:",t)})});export{va as _,YH as c,L2 as g};
