{"version":3,"mappings":"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","names":["STATUS_OPTIONS","CORLogRow","entry","isEditing","isSaving","onEdit","onSave","onCancel","statusDisplay","editValues","setEditValues","useState","dateSentRef","useRef","useEffect","handleKeyDown","e","handleSave","handleCancel","status","formatDateDisplay","dateStr","formatDateInput","jsxs","jsx","prev","opt","ChevronDown","Loader2","Check","X","Edit3","STATUS_DISPLAY","STATUS_CATEGORIES","CORLog","project","company","onShowToast","logEntries","setLogEntries","loading","setLoading","editingId","setEditingId","savingId","setSavingId","refreshing","setRefreshing","loadCORLog","subscription","db","data","error","handleRefresh","entryId","updates","changeOrderId","groupedEntries","useMemo","pending","approved","voided","summary","sum","exportToPDF","jsPDF","__vitePreload","n","autoTable","doc","pageWidth","tableData","formatCurrency","finalY","col1X","col2X","fileName","exportToExcel","XLSX","ws","wb","amountCol","range","row","cellRef","renderSectionTable","entries","showHeader","FileSpreadsheet","RefreshCw","FileText","Clock","CheckCircle","XCircle","CORCard","memo","cor","isSelected","selectMode","areas","onToggleSelect","onView","onDelete","onSubmitForApproval","statusInfo","getStatusInfo","canEdit","canDelete","canSubmit","getAreaName","areaId","a","handleClick","CheckSquare","Square","formatDate","Send","Eye","Trash2","CORList","refreshKey","onCreateCOR","onViewCOR","onEditCOR","previewMode","previewLimit","onViewAll","onDisplayModeChange","branding","useBranding","cors","setCORs","filter","setFilter","areaFilter","setAreaFilter","groupFilter","setGroupFilter","expandedCOR","setExpandedCOR","selectedCORs","setSelectedCORs","setSelectMode","showGroupModal","setShowGroupModal","newGroupName","setNewGroupName","showExportMenu","setShowExportMenu","exportMenuRef","handleClickOutside","displayMode","setDisplayMode","handleDisplayModeChange","mode","viewMode","setViewMode","expandedMonths","setExpandedMonths","dateFilter","setDateFilter","stats","setStats","loadCORs","useCallback","loadStats","c","rejected","billed","totalValue","approvedValue","pendingValue","summaryData","s","wsSummary","detailHeaders","detailData","wsDetail","name","sheetData","pageHeight","margin","primaryColor","hexToRgb","secondaryColor","logoOffset","logoBase64","loadImageAsBase64","yPos","boxWidth","box","i","boxX","boxColor","lightColor","statusKey","key","footerY","handleDelete","corId","handleSubmitForApproval","toggleCORSelection","next","exitSelectMode","handleGroupSelected","availableGroups","groups","filteredCORs","filtered","startDate","endDate","sevenDaysAgo","b","corsByMonth","date","monthKey","monthLabel","currentMonthKey","toggleMonthExpand","newExpanded","counts","renderCORCard","CardSkeleton","Download","List","Table","Plus","Fragment","FolderPlus","group","Calendar","monthData","ChevronRight","CountBadge"],"ignoreList":[],"sources":["../../src/components/cor/CORLogRow.jsx","../../src/components/cor/CORLog.jsx","../../src/components/cor/CORCard.jsx","../../src/components/cor/CORList.jsx"],"sourcesContent":["import { useState, useRef, useEffect } from 'react'\nimport { Edit3, Check, X, Loader2, ChevronDown } from 'lucide-react'\nimport { formatCurrency } from '../../lib/corCalculations'\n\n// Available status options for editing\nconst STATUS_OPTIONS = [\n  { value: 'draft', label: 'Draft' },\n  { value: 'pending_approval', label: 'Pending Approval' },\n  { value: 'approved', label: 'Approved' },\n  { value: 'rejected', label: 'Rejected' },\n  { value: 'billed', label: 'Billed' },\n  { value: 'closed', label: 'Closed' }\n]\n\nexport default function CORLogRow({\n  entry,\n  isEditing,\n  isSaving,\n  onEdit,\n  onSave,\n  onCancel,\n  statusDisplay\n}) {\n  const [editValues, setEditValues] = useState({\n    dateSentToClient: entry.dateSentToClient || '',\n    ceNumber: entry.ceNumber || '',\n    comments: entry.comments || '',\n    status: entry.changeOrder?.status || 'draft'\n  })\n\n  const dateSentRef = useRef(null)\n\n  // Focus first editable field when entering edit mode\n  useEffect(() => {\n    if (isEditing && dateSentRef.current) {\n      dateSentRef.current.focus()\n    }\n  }, [isEditing])\n\n  // Reset edit values when entry changes\n  useEffect(() => {\n    setEditValues({\n      dateSentToClient: entry.dateSentToClient || '',\n      ceNumber: entry.ceNumber || '',\n      comments: entry.comments || '',\n      status: entry.changeOrder?.status || 'draft'\n    })\n  }, [entry])\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault()\n      handleSave()\n    } else if (e.key === 'Escape') {\n      handleCancel()\n    }\n  }\n\n  const handleSave = () => {\n    onSave(editValues)\n  }\n\n  const handleCancel = () => {\n    setEditValues({\n      dateSentToClient: entry.dateSentToClient || '',\n      ceNumber: entry.ceNumber || '',\n      comments: entry.comments || '',\n      status: entry.changeOrder?.status || 'draft'\n    })\n    onCancel()\n  }\n\n  const status = statusDisplay[entry.changeOrder.status] || { label: entry.changeOrder.status, className: '' }\n\n  // Format date for display\n  const formatDateDisplay = (dateStr) => {\n    if (!dateStr) return '-'\n    try {\n      return new Date(dateStr).toLocaleDateString('en-US', {\n        month: 'short',\n        day: 'numeric',\n        year: 'numeric'\n      })\n    } catch {\n      return dateStr\n    }\n  }\n\n  // Format date for input\n  const formatDateInput = (dateStr) => {\n    if (!dateStr) return ''\n    try {\n      const date = new Date(dateStr)\n      return date.toISOString().split('T')[0]\n    } catch {\n      return dateStr\n    }\n  }\n\n  if (isEditing) {\n    return (\n      <tr className=\"cor-log-row editing\">\n        <td className=\"col-log-num\">{entry.logNumber}</td>\n        <td className=\"col-date-sent\">\n          <input\n            ref={dateSentRef}\n            type=\"date\"\n            value={formatDateInput(editValues.dateSentToClient)}\n            onChange={(e) => setEditValues(prev => ({ ...prev, dateSentToClient: e.target.value }))}\n            onKeyDown={handleKeyDown}\n            disabled={isSaving}\n            className=\"cor-log-input\"\n          />\n        </td>\n        <td className=\"col-ce-num\">\n          <input\n            type=\"text\"\n            value={editValues.ceNumber}\n            onChange={(e) => setEditValues(prev => ({ ...prev, ceNumber: e.target.value }))}\n            onKeyDown={handleKeyDown}\n            disabled={isSaving}\n            placeholder=\"CE-XXX\"\n            className=\"cor-log-input\"\n            maxLength={50}\n          />\n        </td>\n        <td className=\"col-description\">\n          <span className=\"cor-log-title\">{entry.changeOrder.title || 'Untitled'}</span>\n          <span className=\"cor-log-number\">{entry.changeOrder.corNumber}</span>\n        </td>\n        <td className=\"col-amount\">{formatCurrency(entry.changeOrder.corTotal || 0)}</td>\n        <td className=\"col-status\">\n          <div className=\"cor-log-status-select\">\n            <select\n              value={editValues.status}\n              onChange={(e) => setEditValues(prev => ({ ...prev, status: e.target.value }))}\n              disabled={isSaving}\n              className=\"cor-log-select\"\n            >\n              {STATUS_OPTIONS.map(opt => (\n                <option key={opt.value} value={opt.value}>{opt.label}</option>\n              ))}\n            </select>\n            <ChevronDown size={14} className=\"select-icon\" />\n          </div>\n        </td>\n        <td className=\"col-comments\">\n          <textarea\n            value={editValues.comments}\n            onChange={(e) => setEditValues(prev => ({ ...prev, comments: e.target.value }))}\n            onKeyDown={handleKeyDown}\n            disabled={isSaving}\n            placeholder=\"Add comments...\"\n            className=\"cor-log-textarea\"\n            rows={2}\n          />\n        </td>\n        <td className=\"col-actions\">\n          {isSaving ? (\n            <Loader2 size={16} className=\"spin\" />\n          ) : (\n            <div className=\"cor-log-edit-actions\">\n              <button\n                className=\"btn btn-icon btn-success\"\n                onClick={handleSave}\n                title=\"Save\"\n              >\n                <Check size={14} />\n              </button>\n              <button\n                className=\"btn btn-icon btn-ghost\"\n                onClick={handleCancel}\n                title=\"Cancel\"\n              >\n                <X size={14} />\n              </button>\n            </div>\n          )}\n        </td>\n      </tr>\n    )\n  }\n\n  return (\n    <tr className=\"cor-log-row\">\n      <td className=\"col-log-num\">{entry.logNumber}</td>\n      <td className=\"col-date-sent editable\" onClick={onEdit}>\n        {formatDateDisplay(entry.dateSentToClient)}\n      </td>\n      <td className=\"col-ce-num editable\" onClick={onEdit}>\n        {entry.ceNumber || '-'}\n      </td>\n      <td className=\"col-description\">\n        <span className=\"cor-log-title\">{entry.changeOrder.title || 'Untitled'}</span>\n        <span className=\"cor-log-number\">{entry.changeOrder.corNumber}</span>\n      </td>\n      <td className=\"col-amount\">{formatCurrency(entry.changeOrder.corTotal || 0)}</td>\n      <td className=\"col-status editable\" onClick={onEdit}>\n        <span className={`cor-log-status ${status.className}`}>{status.label}</span>\n      </td>\n      <td className=\"col-comments editable\" onClick={onEdit}>\n        {entry.comments || <span className=\"placeholder\">Click to add...</span>}\n      </td>\n      <td className=\"col-actions\">\n        <button\n          className=\"btn btn-icon btn-ghost\"\n          onClick={onEdit}\n          title=\"Edit\"\n        >\n          <Edit3 size={14} />\n        </button>\n      </td>\n    </tr>\n  )\n}\n","import { useState, useEffect, useMemo } from 'react'\nimport { FileSpreadsheet, Download, FileText, Loader2, RefreshCw, Clock, CheckCircle, XCircle } from 'lucide-react'\nimport { db } from '../../lib/supabase'\nimport { formatCurrency } from '../../lib/corCalculations'\nimport CORLogRow from './CORLogRow'\n\n// Status display mapping for client presentation\nconst STATUS_DISPLAY = {\n  draft: { label: 'Draft', className: 'draft' },\n  pending_approval: { label: 'Pending', className: 'pending' },\n  approved: { label: 'Approved', className: 'approved' },\n  rejected: { label: 'Rejected', className: 'rejected' },\n  billed: { label: 'Billed', className: 'billed' },\n  closed: { label: 'Closed', className: 'closed' }\n}\n\n// Status categories for grouping\nconst STATUS_CATEGORIES = {\n  pending: ['draft', 'pending_approval'],\n  approved: ['approved', 'billed'],\n  void: ['rejected', 'closed']\n}\n\nexport default function CORLog({ project, company, onShowToast }) {\n  const [logEntries, setLogEntries] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [editingId, setEditingId] = useState(null)\n  const [savingId, setSavingId] = useState(null)\n  const [refreshing, setRefreshing] = useState(false)\n\n  useEffect(() => {\n    loadCORLog()\n\n    // Subscribe to COR log changes\n    const subscription = db.subscribeToCORLog?.(project.id, () => {\n      loadCORLog()\n    })\n\n    return () => {\n      if (subscription) db.unsubscribe?.(subscription)\n    }\n  }, [project.id])\n\n  const loadCORLog = async () => {\n    try {\n      const data = await db.getCORLog(project.id)\n      setLogEntries(data || [])\n    } catch (error) {\n      console.error('Error loading COR log:', error)\n      onShowToast?.('Error loading COR log', 'error')\n    } finally {\n      setLoading(false)\n      setRefreshing(false)\n    }\n  }\n\n  const handleRefresh = () => {\n    setRefreshing(true)\n    loadCORLog()\n  }\n\n  const handleSave = async (entryId, updates, changeOrderId) => {\n    setSavingId(entryId)\n    try {\n      // Update log entry fields\n      await db.updateCORLogEntry(entryId, updates)\n\n      // If status changed, update the change order status too\n      if (updates.status) {\n        await db.updateChangeOrderStatus(changeOrderId, updates.status)\n      }\n\n      // Update local state\n      setLogEntries(prev => prev.map(entry =>\n        entry.id === entryId\n          ? {\n              ...entry,\n              dateSentToClient: updates.dateSentToClient,\n              ceNumber: updates.ceNumber,\n              comments: updates.comments,\n              changeOrder: {\n                ...entry.changeOrder,\n                status: updates.status || entry.changeOrder.status\n              }\n            }\n          : entry\n      ))\n      setEditingId(null)\n      onShowToast?.('Log entry updated', 'success')\n    } catch (error) {\n      console.error('Error updating log entry:', error)\n      onShowToast?.('Error updating log entry', 'error')\n    } finally {\n      setSavingId(null)\n    }\n  }\n\n  // Group entries by status category\n  const groupedEntries = useMemo(() => {\n    const pending = logEntries.filter(e => STATUS_CATEGORIES.pending.includes(e.changeOrder.status))\n    const approved = logEntries.filter(e => STATUS_CATEGORIES.approved.includes(e.changeOrder.status))\n    const voided = logEntries.filter(e => STATUS_CATEGORIES.void.includes(e.changeOrder.status))\n\n    return { pending, approved, voided }\n  }, [logEntries])\n\n  // Calculate summary statistics\n  const summary = useMemo(() => {\n    const { pending, approved, voided } = groupedEntries\n\n    return {\n      totalCORs: logEntries.length,\n      approvedCount: approved.length,\n      pendingCount: pending.length,\n      voidCount: voided.length,\n      approvedTotal: approved.reduce((sum, e) => sum + (e.changeOrder.corTotal || 0), 0),\n      pendingTotal: pending.reduce((sum, e) => sum + (e.changeOrder.corTotal || 0), 0),\n      voidTotal: voided.reduce((sum, e) => sum + (e.changeOrder.corTotal || 0), 0),\n      grandTotal: logEntries.reduce((sum, e) => sum + (e.changeOrder.corTotal || 0), 0)\n    }\n  }, [logEntries, groupedEntries])\n\n  // Export to PDF\n  const exportToPDF = async () => {\n    try {\n      // Dynamic import for jspdf\n      const { default: jsPDF } = await import('jspdf')\n      const { default: autoTable } = await import('jspdf-autotable')\n\n      const doc = new jsPDF('landscape')\n      const pageWidth = doc.internal.pageSize.width\n\n      // Header\n      doc.setFontSize(18)\n      doc.setFont(undefined, 'bold')\n      doc.text('CHANGE ORDER LOG', pageWidth / 2, 20, { align: 'center' })\n\n      doc.setFontSize(12)\n      doc.setFont(undefined, 'normal')\n      doc.text(`Project: ${project.name}`, pageWidth / 2, 28, { align: 'center' })\n      if (project.job_number) {\n        doc.text(`Job #${project.job_number}`, pageWidth / 2, 35, { align: 'center' })\n      }\n      doc.setFontSize(10)\n      doc.text(`Generated: ${new Date().toLocaleDateString()}`, pageWidth / 2, 42, { align: 'center' })\n\n      // Company info if available\n      if (company?.name) {\n        doc.setFontSize(11)\n        doc.setFont(undefined, 'bold')\n        doc.text(company.name, 14, 20)\n        doc.setFont(undefined, 'normal')\n        if (company.phone) {\n          doc.setFontSize(9)\n          doc.text(company.phone, 14, 25)\n        }\n      }\n\n      // Table data - include all editable columns\n      const tableData = logEntries.map(entry => [\n        entry.logNumber,\n        entry.changeOrder.corNumber || '-',\n        entry.dateSentToClient ? new Date(entry.dateSentToClient).toLocaleDateString() : '-',\n        entry.ceNumber || '-',\n        entry.changeOrder.title || 'Untitled',\n        formatCurrency(entry.changeOrder.corTotal || 0),\n        STATUS_DISPLAY[entry.changeOrder.status]?.label || entry.changeOrder.status,\n        entry.comments || '-'\n      ])\n\n      // Generate table with all columns\n      autoTable(doc, {\n        startY: 50,\n        head: [['Log #', 'COR #', 'Date Sent', 'CE #', 'Description', 'Amount', 'Status', 'Comments']],\n        body: tableData,\n        styles: {\n          fontSize: 8,\n          cellPadding: 3,\n          overflow: 'linebreak',\n          valign: 'top'\n        },\n        headStyles: {\n          fillColor: [51, 51, 51],\n          textColor: 255,\n          fontStyle: 'bold',\n          fontSize: 8\n        },\n        columnStyles: {\n          0: { cellWidth: 12, halign: 'center' },  // Log #\n          1: { cellWidth: 18 },                     // COR #\n          2: { cellWidth: 22 },                     // Date Sent\n          3: { cellWidth: 18 },                     // CE #\n          4: { cellWidth: 55 },                     // Description\n          5: { cellWidth: 22, halign: 'right' },    // Amount\n          6: { cellWidth: 18, halign: 'center' },   // Status\n          7: { cellWidth: 'auto', minCellWidth: 50 } // Comments - flexible width\n        },\n        alternateRowStyles: {\n          fillColor: [248, 248, 248]\n        },\n        didParseCell: (data) => {\n          // Style status cells based on value\n          if (data.column.index === 6 && data.section === 'body') {\n            const status = data.cell.raw?.toLowerCase()\n            if (status === 'approved' || status === 'billed') {\n              data.cell.styles.textColor = [5, 150, 105]\n            } else if (status === 'pending' || status === 'pending approval') {\n              data.cell.styles.textColor = [217, 119, 6]\n            } else if (status === 'rejected' || status === 'void') {\n              data.cell.styles.textColor = [220, 38, 38]\n            }\n          }\n        }\n      })\n\n      // Summary section\n      const finalY = (doc.lastAutoTable?.finalY || 100) + 10\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'bold')\n      doc.text('SUMMARY', 14, finalY)\n\n      doc.setFont(undefined, 'normal')\n      doc.setFontSize(9)\n      const col1X = 14\n      const col2X = 100\n      doc.text(`Total CORs: ${summary.totalCORs}`, col1X, finalY + 7)\n      doc.text(`Approved: ${summary.approvedCount} (${formatCurrency(summary.approvedTotal)})`, col1X, finalY + 14)\n      doc.text(`Pending: ${summary.pendingCount} (${formatCurrency(summary.pendingTotal)})`, col2X, finalY + 7)\n      doc.text(`Void: ${summary.voidCount} (${formatCurrency(summary.voidTotal)})`, col2X, finalY + 14)\n\n      doc.setFont(undefined, 'bold')\n      doc.setFontSize(10)\n      doc.text(`Total Value: ${formatCurrency(summary.grandTotal)}`, col1X, finalY + 24)\n\n      // Save\n      const fileName = `COR_Log_${project.job_number || project.name.replace(/\\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.pdf`\n      doc.save(fileName)\n\n      onShowToast?.('PDF exported successfully', 'success')\n    } catch (error) {\n      console.error('Error exporting PDF:', error)\n      onShowToast?.('Error exporting PDF', 'error')\n    }\n  }\n\n  // Export to Excel\n  const exportToExcel = async () => {\n    try {\n      // Dynamic import for xlsx\n      const XLSX = await import('xlsx')\n\n      // Prepare data\n      const data = logEntries.map(entry => ({\n        'Log #': entry.logNumber,\n        'COR Number': entry.changeOrder.corNumber,\n        'Date Sent to Client': entry.dateSentToClient || '',\n        'CE Number': entry.ceNumber || '',\n        'Description': entry.changeOrder.title || 'Untitled',\n        'Amount': entry.changeOrder.corTotal || 0,\n        'Status': STATUS_DISPLAY[entry.changeOrder.status]?.label || entry.changeOrder.status,\n        'Created Date': entry.changeOrder.createdAt ? new Date(entry.changeOrder.createdAt).toLocaleDateString() : '',\n        'Approved Date': entry.changeOrder.approvedAt ? new Date(entry.changeOrder.approvedAt).toLocaleDateString() : '',\n        'Approved By': entry.changeOrder.approvedBy || '',\n        'Comments': entry.comments || ''\n      }))\n\n      // Add summary row\n      data.push({})\n      data.push({\n        'Log #': 'SUMMARY',\n        'Description': `Total CORs: ${summary.totalCORs}`,\n        'Amount': summary.grandTotal,\n        'Status': `Approved: ${summary.approvedCount}, Pending: ${summary.pendingCount}`\n      })\n\n      // Create workbook\n      const ws = XLSX.utils.json_to_sheet(data)\n      const wb = XLSX.utils.book_new()\n      XLSX.utils.book_append_sheet(wb, ws, 'COR Log')\n\n      // Format amount column\n      const amountCol = 5 // 0-indexed, 'Amount' column\n      const range = XLSX.utils.decode_range(ws['!ref'])\n      for (let row = range.s.r + 1; row <= range.e.r; row++) {\n        const cellRef = XLSX.utils.encode_cell({ r: row, c: amountCol })\n        if (ws[cellRef] && typeof ws[cellRef].v === 'number') {\n          ws[cellRef].z = '$#,##0.00'\n        }\n      }\n\n      // Column widths\n      ws['!cols'] = [\n        { wch: 8 },   // Log #\n        { wch: 12 },  // COR Number\n        { wch: 15 },  // Date Sent\n        { wch: 12 },  // CE Number\n        { wch: 40 },  // Description\n        { wch: 12 },  // Amount\n        { wch: 12 },  // Status\n        { wch: 12 },  // Created Date\n        { wch: 12 },  // Approved Date\n        { wch: 20 },  // Approved By\n        { wch: 30 }   // Comments\n      ]\n\n      // Save\n      const fileName = `COR_Log_${project.job_number || project.name}_${new Date().toISOString().split('T')[0]}.xlsx`\n      XLSX.writeFile(wb, fileName)\n\n      onShowToast?.('Excel exported successfully', 'success')\n    } catch (error) {\n      console.error('Error exporting Excel:', error)\n      onShowToast?.('Error exporting Excel', 'error')\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"cor-log cor-log-loading\">\n        <Loader2 size={24} className=\"spin\" />\n        <span>Loading COR Log...</span>\n      </div>\n    )\n  }\n\n  // Helper to render a section table\n  const renderSectionTable = (entries, showHeader = true) => (\n    <table className=\"cor-log-table\">\n      {showHeader && (\n        <thead>\n          <tr>\n            <th className=\"col-log-num\">Log #</th>\n            <th className=\"col-date-sent\">Date Sent</th>\n            <th className=\"col-ce-num\">CE #</th>\n            <th className=\"col-description\">Description</th>\n            <th className=\"col-amount\">Amount</th>\n            <th className=\"col-status\">Status</th>\n            <th className=\"col-comments\">Comments</th>\n            <th className=\"col-actions\">Actions</th>\n          </tr>\n        </thead>\n      )}\n      <tbody>\n        {entries.map(entry => (\n          <CORLogRow\n            key={entry.id}\n            entry={entry}\n            isEditing={editingId === entry.id}\n            isSaving={savingId === entry.id}\n            onEdit={() => setEditingId(entry.id)}\n            onSave={(updates) => handleSave(entry.id, updates, entry.changeOrder.id)}\n            onCancel={() => setEditingId(null)}\n            statusDisplay={STATUS_DISPLAY}\n          />\n        ))}\n      </tbody>\n    </table>\n  )\n\n  return (\n    <div className=\"cor-log cor-log-expanded\">\n      {/* Header */}\n      <div className=\"cor-log-header\">\n        <div className=\"cor-log-title\">\n          <FileSpreadsheet size={20} />\n          <h3>Change Order Log</h3>\n          <span className=\"cor-log-count\">{logEntries.length} entries</span>\n        </div>\n        <div className=\"cor-log-actions\">\n          <button\n            className=\"btn btn-icon btn-ghost\"\n            onClick={handleRefresh}\n            disabled={refreshing}\n            title=\"Refresh\"\n          >\n            <RefreshCw size={16} className={refreshing ? 'spin' : ''} />\n          </button>\n          <button className=\"btn btn-secondary btn-small\" onClick={exportToExcel}>\n            <FileSpreadsheet size={14} /> Excel\n          </button>\n          <button className=\"btn btn-secondary btn-small\" onClick={exportToPDF}>\n            <FileText size={14} /> PDF\n          </button>\n        </div>\n      </div>\n\n      {/* Summary Cards */}\n      <div className=\"cor-log-summary-cards\">\n        <div className=\"summary-card pending\">\n          <Clock size={18} />\n          <div className=\"summary-card-content\">\n            <span className=\"summary-card-label\">Pending</span>\n            <span className=\"summary-card-count\">{summary.pendingCount} CORs</span>\n            <span className=\"summary-card-amount\">{formatCurrency(summary.pendingTotal)}</span>\n          </div>\n        </div>\n        <div className=\"summary-card approved\">\n          <CheckCircle size={18} />\n          <div className=\"summary-card-content\">\n            <span className=\"summary-card-label\">Approved</span>\n            <span className=\"summary-card-count\">{summary.approvedCount} CORs</span>\n            <span className=\"summary-card-amount\">{formatCurrency(summary.approvedTotal)}</span>\n          </div>\n        </div>\n        <div className=\"summary-card void\">\n          <XCircle size={18} />\n          <div className=\"summary-card-content\">\n            <span className=\"summary-card-label\">Void</span>\n            <span className=\"summary-card-count\">{summary.voidCount} CORs</span>\n            <span className=\"summary-card-amount\">{formatCurrency(summary.voidTotal)}</span>\n          </div>\n        </div>\n        <div className=\"summary-card total\">\n          <FileSpreadsheet size={18} />\n          <div className=\"summary-card-content\">\n            <span className=\"summary-card-label\">Total</span>\n            <span className=\"summary-card-count\">{summary.totalCORs} CORs</span>\n            <span className=\"summary-card-amount\">{formatCurrency(summary.grandTotal)}</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Content */}\n      {logEntries.length === 0 ? (\n        <div className=\"cor-log-empty\">\n          <FileSpreadsheet size={32} />\n          <p>No change orders in log</p>\n          <span>CORs will appear here as they are created</span>\n        </div>\n      ) : (\n        <div className=\"cor-log-sections\">\n          {/* Pending Section */}\n          {groupedEntries.pending.length > 0 && (\n            <div className=\"cor-log-section pending\">\n              <div className=\"cor-log-section-header\">\n                <Clock size={16} />\n                <h4>Pending Change Orders</h4>\n                <span className=\"section-count\">{groupedEntries.pending.length}</span>\n                <span className=\"section-total\">{formatCurrency(summary.pendingTotal)}</span>\n              </div>\n              <div className=\"cor-log-table-wrapper\">\n                {renderSectionTable(groupedEntries.pending)}\n              </div>\n            </div>\n          )}\n\n          {/* Approved Section */}\n          {groupedEntries.approved.length > 0 && (\n            <div className=\"cor-log-section approved\">\n              <div className=\"cor-log-section-header\">\n                <CheckCircle size={16} />\n                <h4>Approved Change Orders</h4>\n                <span className=\"section-count\">{groupedEntries.approved.length}</span>\n                <span className=\"section-total\">{formatCurrency(summary.approvedTotal)}</span>\n              </div>\n              <div className=\"cor-log-table-wrapper\">\n                {renderSectionTable(groupedEntries.approved)}\n              </div>\n            </div>\n          )}\n\n          {/* Void Section */}\n          {groupedEntries.voided.length > 0 && (\n            <div className=\"cor-log-section void\">\n              <div className=\"cor-log-section-header\">\n                <XCircle size={16} />\n                <h4>Void Change Orders</h4>\n                <span className=\"section-count\">{groupedEntries.voided.length}</span>\n                <span className=\"section-total\">{formatCurrency(summary.voidTotal)}</span>\n              </div>\n              <div className=\"cor-log-table-wrapper\">\n                {renderSectionTable(groupedEntries.voided)}\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n","import { memo } from 'react'\nimport { Eye, Edit3, Trash2, Send, CheckSquare, Square, CheckCircle } from 'lucide-react'\nimport { formatCurrency, getStatusInfo, formatDate, formatDateRange } from '../../lib/corCalculations'\n\n/**\n * Memoized COR Card component\n * Prevents unnecessary re-renders when parent list updates\n */\nconst CORCard = memo(function CORCard({\n  cor,\n  isSelected,\n  selectMode,\n  areas,\n  onToggleSelect,\n  onView,\n  onEdit,\n  onDelete,\n  onSubmitForApproval\n}) {\n  const statusInfo = getStatusInfo(cor.status)\n  const canEdit = ['draft', 'pending_approval', 'approved'].includes(cor.status)\n  const canDelete = ['draft', 'pending_approval', 'rejected'].includes(cor.status)\n  const canSubmit = cor.status === 'draft'\n\n  const getAreaName = (areaId) => {\n    const area = areas?.find(a => a.id === areaId)\n    return area?.name || 'No Area'\n  }\n\n  const handleClick = () => {\n    if (selectMode) {\n      onToggleSelect(cor.id)\n    } else {\n      onView?.(cor)\n    }\n  }\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Enter' || e.key === ' ') {\n      e.preventDefault()\n      handleClick()\n    }\n  }\n\n  return (\n    <div\n      className={`cor-card hover-lift animate-fade-in-up ${cor.status} ${isSelected ? 'selected' : ''}`}\n      onClick={handleClick}\n      onKeyDown={handleKeyDown}\n      tabIndex={0}\n      role=\"button\"\n      aria-label={`${selectMode ? (isSelected ? 'Deselect' : 'Select') : 'View'} COR ${cor.cor_number}: ${cor.title || 'Untitled'}, ${statusInfo.label}, ${formatCurrency(cor.cor_total || 0)}`}\n    >\n      <div className=\"cor-card-header\">\n        <div className=\"cor-card-left\">\n          {selectMode && (\n            <button\n              className=\"cor-select-checkbox\"\n              onClick={(e) => { e.stopPropagation(); onToggleSelect(cor.id, e); }}\n              aria-label={isSelected ? 'Deselect' : 'Select'}\n            >\n              {isSelected ? <CheckSquare size={18} /> : <Square size={18} />}\n            </button>\n          )}\n          <span className=\"cor-number\">{cor.cor_number}</span>\n          <span\n            className=\"cor-status-badge\"\n            style={{ backgroundColor: statusInfo.bgColor, color: statusInfo.color }}\n          >\n            {statusInfo.label}\n          </span>\n          {(cor.gc_signature_data || cor.client_signature_data) && (\n            <span className=\"cor-signed-badge\" title={`Signed by ${cor.gc_signature_name || cor.client_signature_name || 'Client'}`}>\n              <CheckCircle size={12} /> Signed\n            </span>\n          )}\n        </div>\n        <div className=\"cor-card-right\">\n          <span className=\"cor-total\">{formatCurrency(cor.cor_total || 0)}</span>\n        </div>\n      </div>\n\n      <div className=\"cor-card-body\">\n        <h4 className=\"cor-title\">{cor.title || 'Untitled COR'}</h4>\n        <div className=\"cor-meta\">\n          {cor.group_name && (\n            <span className=\"cor-group-badge\">{cor.group_name}</span>\n          )}\n          {cor.area_id && (\n            <span className=\"cor-area\">{getAreaName(cor.area_id)}</span>\n          )}\n          <span className=\"cor-period\">{formatDateRange(cor.period_start, cor.period_end)}</span>\n        </div>\n      </div>\n\n      <div className=\"cor-card-footer\">\n        <span className=\"cor-created\">{formatDate(cor.created_at)}</span>\n        <div className=\"cor-actions\" onClick={e => e.stopPropagation()}>\n          {canSubmit && (\n            <button\n              className=\"cor-action-btn submit\"\n              onClick={(e) => onSubmitForApproval(cor.id, e)}\n              title=\"Submit for Approval\"\n              aria-label={`Submit COR ${cor.cor_number} for approval`}\n            >\n              <Send size={14} aria-hidden=\"true\" />\n            </button>\n          )}\n          {canEdit && (\n            <button\n              className=\"cor-action-btn edit\"\n              onClick={(e) => { e.stopPropagation(); onEdit?.(cor); }}\n              title=\"Edit\"\n              aria-label={`Edit COR ${cor.cor_number}`}\n            >\n              <Edit3 size={14} aria-hidden=\"true\" />\n            </button>\n          )}\n          <button\n            className=\"cor-action-btn view\"\n            onClick={(e) => { e.stopPropagation(); onView?.(cor); }}\n            title=\"View Details\"\n            aria-label={`View COR ${cor.cor_number} details`}\n          >\n            <Eye size={14} aria-hidden=\"true\" />\n          </button>\n          {canDelete && (\n            <button\n              className=\"cor-action-btn delete\"\n              onClick={(e) => onDelete(cor.id, e)}\n              title=\"Delete\"\n              aria-label={`Delete COR ${cor.cor_number}`}\n            >\n              <Trash2 size={14} aria-hidden=\"true\" />\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n})\n\nexport default CORCard\n","import { useState, useEffect, useMemo, useRef, useCallback } from 'react'\nimport { FileText, Plus, ChevronDown, ChevronRight, Calendar, Download, FolderPlus, X, List, Table, FileSpreadsheet, CheckSquare } from 'lucide-react'\nimport { db } from '../../lib/supabase'\nimport { formatCurrency, getStatusInfo, formatDate, formatDateRange, calculateCORTotals } from '../../lib/corCalculations'\nimport { hexToRgb, loadImageAsBase64 } from '../../lib/imageUtils'\nimport { CardSkeleton, CountBadge } from '../ui'\nimport { useBranding } from '../../lib/BrandingContext'\nimport CORLog from './CORLog'\nimport CORCard from './CORCard'\n\n// Status display mapping for exports\nconst STATUS_DISPLAY = {\n  draft: { label: 'Draft', color: [107, 114, 128], bgColor: [243, 244, 246] },\n  pending_approval: { label: 'Pending Approval', color: [217, 119, 6], bgColor: [254, 243, 199] },\n  approved: { label: 'Approved', color: [5, 150, 105], bgColor: [209, 250, 229] },\n  rejected: { label: 'Rejected', color: [220, 38, 38], bgColor: [254, 226, 226] },\n  billed: { label: 'Billed', color: [37, 99, 235], bgColor: [219, 234, 254] },\n  closed: { label: 'Closed', color: [75, 85, 99], bgColor: [229, 231, 235] }\n}\n\nexport default function CORList({\n  project,\n  company,\n  areas,\n  refreshKey,\n  onShowToast,\n  onCreateCOR,\n  onViewCOR,\n  onEditCOR,\n  // Preview mode props\n  previewMode = false,  // When true, shows limited items with \"See All\" button\n  previewLimit = 5,     // Number of items to show in preview mode\n  onViewAll,            // Callback when \"See All\" is clicked\n  onDisplayModeChange   // Callback when display mode changes (for parent layout adjustments)\n}) {\n  const { branding } = useBranding()\n  const [cors, setCORs] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [filter, setFilter] = useState('all')\n  const [areaFilter, setAreaFilter] = useState('all')\n  const [groupFilter, setGroupFilter] = useState('all')\n  const [expandedCOR, setExpandedCOR] = useState(null)\n  const [selectedCORs, setSelectedCORs] = useState(new Set())\n  const [selectMode, setSelectMode] = useState(false)\n  const [showGroupModal, setShowGroupModal] = useState(false)\n  const [newGroupName, setNewGroupName] = useState('')\n  const [showExportMenu, setShowExportMenu] = useState(false)\n  const exportMenuRef = useRef(null)\n\n  // Close export menu when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (e) => {\n      if (exportMenuRef.current && !exportMenuRef.current.contains(e.target)) {\n        setShowExportMenu(false)\n      }\n    }\n    if (showExportMenu) {\n      document.addEventListener('mousedown', handleClickOutside)\n    }\n    return () => document.removeEventListener('mousedown', handleClickOutside)\n  }, [showExportMenu])\n\n  // Display mode state - 'list' (card view) or 'log' (table view for client presentation)\n  const [displayMode, setDisplayMode] = useState('list') // 'list' | 'log'\n\n  // Notify parent when display mode changes\n  const handleDisplayModeChange = (mode) => {\n    setDisplayMode(mode)\n    onDisplayModeChange?.(mode)\n  }\n\n  // View mode state - default to 'all' in preview mode so we can limit by count\n  const [viewMode, setViewMode] = useState(previewMode ? 'all' : 'recent') // 'recent' | 'all'\n  const [expandedMonths, setExpandedMonths] = useState(new Set())\n  const [dateFilter, setDateFilter] = useState({ start: '', end: '' })\n\n  // Stats state\n  const [stats, setStats] = useState(null)\n\n  // Define load functions before useEffect that uses them\n  const loadCORs = useCallback(async () => {\n    try {\n      const data = await db.getCORs(project.id)\n      setCORs(data || [])\n    } catch (error) {\n      console.error('Error loading CORs:', error)\n      onShowToast?.('Error loading change order requests', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }, [project.id]) // onShowToast is stable\n\n  const loadStats = useCallback(async () => {\n    try {\n      const data = await db.getCORStats?.(project.id)\n      setStats(data)\n    } catch (error) {\n      console.error('Error loading COR stats:', error)\n    }\n  }, [project.id])\n\n  useEffect(() => {\n    loadCORs()\n    loadStats()\n\n    // Subscribe to realtime updates\n    const subscription = db.subscribeToCORs?.(project.id, () => {\n      loadCORs()\n      loadStats()\n    })\n\n    return () => {\n      if (subscription) db.unsubscribe?.(subscription)\n    }\n  }, [project.id, refreshKey, loadCORs, loadStats])\n\n  // Professional Excel Export\n  const exportToExcel = async () => {\n    if (cors.length === 0) {\n      onShowToast?.('No CORs to export', 'error')\n      return\n    }\n\n    onShowToast?.('Generating Excel report...', 'info')\n\n    try {\n      const XLSX = await import('xlsx')\n\n      // Calculate statistics\n      const approved = cors.filter(c => c.status === 'approved')\n      const pending = cors.filter(c => ['draft', 'pending_approval'].includes(c.status))\n      const rejected = cors.filter(c => c.status === 'rejected')\n      const billed = cors.filter(c => c.status === 'billed')\n      const totalValue = cors.reduce((sum, c) => sum + (c.cor_total || 0), 0) / 100\n      const approvedValue = approved.reduce((sum, c) => sum + (c.cor_total || 0), 0) / 100\n      const pendingValue = pending.reduce((sum, c) => sum + (c.cor_total || 0), 0) / 100\n\n      // Create workbook\n      const wb = XLSX.utils.book_new()\n\n      // === SUMMARY SHEET ===\n      const summaryData = [\n        ['CHANGE ORDER REQUEST SUMMARY'],\n        [],\n        ['Company:', company?.name || ''],\n        ['Project:', project.name],\n        ['Job Number:', project.job_number || 'N/A'],\n        ['Report Date:', new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })],\n        [],\n        ['FINANCIAL OVERVIEW'],\n        [],\n        ['Category', 'Count', 'Value'],\n        ['Total CORs', cors.length, totalValue],\n        ['Approved', approved.length, approvedValue],\n        ['Pending Approval', pending.length, pendingValue],\n        ['Rejected', rejected.length, rejected.reduce((s, c) => s + (c.cor_total || 0), 0) / 100],\n        ['Billed', billed.length, billed.reduce((s, c) => s + (c.cor_total || 0), 0) / 100],\n        [],\n        ['CONTRACT IMPACT'],\n        [],\n        ['Original Contract Value:', project.contract_value || 0],\n        ['Total Approved CORs:', approvedValue],\n        ['Revised Contract Value:', (project.contract_value || 0) + approvedValue],\n        ['Pending COR Value:', pendingValue],\n        ['Potential Total:', (project.contract_value || 0) + approvedValue + pendingValue]\n      ]\n\n      const wsSummary = XLSX.utils.aoa_to_sheet(summaryData)\n      wsSummary['!cols'] = [{ wch: 25 }, { wch: 15 }, { wch: 18 }]\n      XLSX.utils.book_append_sheet(wb, wsSummary, 'Summary')\n\n      // === DETAIL SHEET ===\n      const detailHeaders = [\n        'COR #', 'Title', 'Description', 'Amount', 'Status',\n        'Created Date', 'Submitted Date', 'Approved Date', 'Approved By',\n        'Work Period Start', 'Work Period End', 'Area'\n      ]\n\n      const detailData = cors.map(cor => [\n        cor.cor_number || '',\n        cor.title || 'Untitled',\n        cor.scope_of_work || '',\n        (cor.cor_total || 0) / 100,\n        STATUS_DISPLAY[cor.status]?.label || cor.status,\n        cor.created_at ? new Date(cor.created_at).toLocaleDateString() : '',\n        cor.submitted_at ? new Date(cor.submitted_at).toLocaleDateString() : '',\n        cor.approved_at ? new Date(cor.approved_at).toLocaleDateString() : '',\n        cor.approved_by_name || '',\n        cor.period_start ? new Date(cor.period_start).toLocaleDateString() : '',\n        cor.period_end ? new Date(cor.period_end).toLocaleDateString() : '',\n        cor.area?.name || ''\n      ])\n\n      const wsDetail = XLSX.utils.aoa_to_sheet([detailHeaders, ...detailData])\n      wsDetail['!cols'] = [\n        { wch: 10 }, { wch: 30 }, { wch: 40 }, { wch: 14 }, { wch: 16 },\n        { wch: 12 }, { wch: 12 }, { wch: 12 }, { wch: 18 },\n        { wch: 12 }, { wch: 12 }, { wch: 15 }\n      ]\n\n      // Format currency column\n      for (let i = 1; i <= detailData.length; i++) {\n        const cellRef = XLSX.utils.encode_cell({ r: i, c: 3 })\n        if (wsDetail[cellRef]) wsDetail[cellRef].z = '$#,##0.00'\n      }\n\n      XLSX.utils.book_append_sheet(wb, wsDetail, 'COR Details')\n\n      // === STATUS BREAKDOWN SHEET ===\n      const statusSheets = [\n        { name: 'Approved CORs', data: approved, status: 'approved' },\n        { name: 'Pending CORs', data: pending, status: 'pending' }\n      ]\n\n      statusSheets.forEach(({ name, data }) => {\n        if (data.length > 0) {\n          const sheetData = [\n            ['COR #', 'Title', 'Amount', 'Date'],\n            ...data.map(cor => [\n              cor.cor_number || '',\n              cor.title || 'Untitled',\n              (cor.cor_total || 0) / 100,\n              cor.created_at ? new Date(cor.created_at).toLocaleDateString() : ''\n            ]),\n            [],\n            ['TOTAL', '', data.reduce((s, c) => s + (c.cor_total || 0), 0) / 100, '']\n          ]\n          const ws = XLSX.utils.aoa_to_sheet(sheetData)\n          ws['!cols'] = [{ wch: 12 }, { wch: 40 }, { wch: 14 }, { wch: 12 }]\n          XLSX.utils.book_append_sheet(wb, ws, name)\n        }\n      })\n\n      // Save file\n      const fileName = `COR_Report_${project.job_number || project.name}_${new Date().toISOString().split('T')[0]}.xlsx`\n      XLSX.writeFile(wb, fileName)\n\n      onShowToast?.('Excel report exported successfully', 'success')\n    } catch (error) {\n      console.error('Export error:', error)\n      onShowToast?.('Export failed', 'error')\n    }\n  }\n\n  // Professional PDF Export with Branding\n  const exportToPDF = async () => {\n    if (cors.length === 0) {\n      onShowToast?.('No CORs to export', 'error')\n      return\n    }\n\n    onShowToast?.('Generating PDF report...', 'info')\n\n    try {\n      const { default: jsPDF } = await import('jspdf')\n      const { default: autoTable } = await import('jspdf-autotable')\n\n      const doc = new jsPDF('landscape')\n      const pageWidth = doc.internal.pageSize.width\n      const pageHeight = doc.internal.pageSize.height\n      const margin = 15\n\n      // Get brand colors\n      const primaryColor = hexToRgb(branding?.primary_color || '#3B82F6')\n      const secondaryColor = hexToRgb(branding?.secondary_color || '#1E40AF')\n\n      // === HEADER WITH BRANDING ===\n      // Primary color header bar\n      doc.setFillColor(...primaryColor)\n      doc.rect(0, 0, pageWidth, 40, 'F')\n\n      // Secondary color accent stripe\n      doc.setFillColor(...secondaryColor)\n      doc.rect(0, 38, pageWidth, 3, 'F')\n\n      // Company logo if available\n      let logoOffset = margin\n      if (branding?.logo_url) {\n        try {\n          const logoBase64 = await loadImageAsBase64(branding.logo_url)\n          if (logoBase64) {\n            doc.addImage(logoBase64, 'PNG', margin, 6, 28, 28)\n            logoOffset = margin + 35\n          }\n        } catch (e) {\n          console.error('Logo load error:', e)\n        }\n      }\n\n      // Company name and document title\n      doc.setTextColor(255, 255, 255)\n      doc.setFontSize(20)\n      doc.setFont('helvetica', 'bold')\n      doc.text(company?.name || 'Company', logoOffset, 18)\n\n      doc.setFontSize(11)\n      doc.setFont('helvetica', 'normal')\n      doc.text('CHANGE ORDER REQUEST REPORT', logoOffset, 28)\n\n      // Right side - date and job info\n      doc.setFontSize(9)\n      doc.text(new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' }), pageWidth - margin, 15, { align: 'right' })\n      if (project.job_number) {\n        doc.text(`Job #: ${project.job_number}`, pageWidth - margin, 23, { align: 'right' })\n      }\n      doc.text(`${cors.length} Change Orders`, pageWidth - margin, 31, { align: 'right' })\n\n      // === PROJECT INFO BOX ===\n      let yPos = 50\n\n      doc.setFillColor(248, 250, 252)\n      doc.setDrawColor(...primaryColor)\n      doc.setLineWidth(0.5)\n      doc.roundedRect(margin, yPos, pageWidth - margin * 2, 25, 3, 3, 'FD')\n\n      doc.setTextColor(...primaryColor)\n      doc.setFontSize(14)\n      doc.setFont('helvetica', 'bold')\n      doc.text(project.name, margin + 8, yPos + 10)\n\n      doc.setTextColor(100, 116, 139)\n      doc.setFontSize(9)\n      doc.setFont('helvetica', 'normal')\n      if (project.address) {\n        doc.text(project.address, margin + 8, yPos + 18)\n      }\n\n      // === FINANCIAL SUMMARY BOXES ===\n      yPos += 35\n\n      const approved = cors.filter(c => c.status === 'approved')\n      const pending = cors.filter(c => ['draft', 'pending_approval'].includes(c.status))\n      const totalValue = cors.reduce((sum, c) => sum + (c.cor_total || 0), 0)\n      const approvedValue = approved.reduce((sum, c) => sum + (c.cor_total || 0), 0)\n      const pendingValue = pending.reduce((sum, c) => sum + (c.cor_total || 0), 0)\n\n      const boxWidth = (pageWidth - margin * 2 - 30) / 4\n      const summaryBoxes = [\n        { label: 'Total CORs', value: cors.length.toString(), subValue: formatCurrency(totalValue) },\n        { label: 'Approved', value: approved.length.toString(), subValue: formatCurrency(approvedValue), color: [5, 150, 105] },\n        { label: 'Pending', value: pending.length.toString(), subValue: formatCurrency(pendingValue), color: [217, 119, 6] },\n        { label: 'Revised Contract', value: formatCurrency((project.contract_value || 0) * 100 + approvedValue), subValue: `+${formatCurrency(approvedValue)} from original`, color: primaryColor }\n      ]\n\n      summaryBoxes.forEach((box, i) => {\n        const boxX = margin + (i * (boxWidth + 10))\n        const boxColor = box.color || primaryColor\n        const lightColor = boxColor.map(c => Math.min(255, c + 200))\n\n        doc.setFillColor(...lightColor)\n        doc.setDrawColor(...boxColor)\n        doc.roundedRect(boxX, yPos, boxWidth, 32, 2, 2, 'FD')\n\n        doc.setTextColor(...boxColor)\n        doc.setFontSize(18)\n        doc.setFont('helvetica', 'bold')\n        doc.text(box.value, boxX + boxWidth / 2, yPos + 14, { align: 'center' })\n\n        doc.setTextColor(100, 116, 139)\n        doc.setFontSize(8)\n        doc.setFont('helvetica', 'normal')\n        doc.text(box.label, boxX + boxWidth / 2, yPos + 22, { align: 'center' })\n\n        if (box.subValue) {\n          doc.setFontSize(7)\n          doc.text(box.subValue, boxX + boxWidth / 2, yPos + 28, { align: 'center' })\n        }\n      })\n\n      // === COR TABLE ===\n      yPos += 42\n\n      doc.setTextColor(...primaryColor)\n      doc.setFontSize(11)\n      doc.setFont('helvetica', 'bold')\n      doc.text('CHANGE ORDER DETAILS', margin, yPos)\n      yPos += 5\n\n      const tableData = cors.map((cor, i) => {\n        const status = STATUS_DISPLAY[cor.status] || { label: cor.status, color: [107, 114, 128] }\n        return [\n          (i + 1).toString(),\n          cor.cor_number || '-',\n          cor.title || 'Untitled',\n          formatCurrency(cor.cor_total || 0),\n          status.label,\n          cor.created_at ? new Date(cor.created_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: '2-digit' }) : '-'\n        ]\n      })\n\n      autoTable(doc, {\n        startY: yPos,\n        head: [['#', 'COR #', 'Description', 'Amount', 'Status', 'Date']],\n        body: tableData,\n        theme: 'grid',\n        styles: {\n          fontSize: 9,\n          cellPadding: 4,\n          lineColor: [226, 232, 240],\n          lineWidth: 0.1\n        },\n        headStyles: {\n          fillColor: primaryColor,\n          textColor: [255, 255, 255],\n          fontStyle: 'bold',\n          halign: 'center'\n        },\n        columnStyles: {\n          0: { cellWidth: 12, halign: 'center' },\n          1: { cellWidth: 25, halign: 'center' },\n          2: { cellWidth: 'auto' },\n          3: { cellWidth: 30, halign: 'right', fontStyle: 'bold' },\n          4: { cellWidth: 28, halign: 'center' },\n          5: { cellWidth: 28, halign: 'center' }\n        },\n        alternateRowStyles: {\n          fillColor: [248, 250, 252]\n        },\n        didParseCell: (data) => {\n          // Color-code status column\n          if (data.column.index === 4 && data.section === 'body') {\n            const statusKey = Object.keys(STATUS_DISPLAY).find(\n              key => STATUS_DISPLAY[key].label === data.cell.raw\n            )\n            if (statusKey) {\n              data.cell.styles.textColor = STATUS_DISPLAY[statusKey].color\n              data.cell.styles.fontStyle = 'bold'\n            }\n          }\n        }\n      })\n\n      // === FOOTER ===\n      const footerY = pageHeight - 12\n      doc.setDrawColor(226, 232, 240)\n      doc.setLineWidth(0.5)\n      doc.line(margin, footerY - 5, pageWidth - margin, footerY - 5)\n\n      doc.setTextColor(148, 163, 184)\n      doc.setFontSize(8)\n      doc.setFont('helvetica', 'normal')\n      doc.text(`Generated on ${new Date().toLocaleString()}`, margin, footerY)\n      doc.text(`${company?.name || 'FieldSync'}  Confidential`, pageWidth / 2, footerY, { align: 'center' })\n      doc.text('Page 1 of 1', pageWidth - margin, footerY, { align: 'right' })\n\n      // Save\n      const fileName = `COR_Report_${project.job_number || project.name}_${new Date().toISOString().split('T')[0]}.pdf`\n      doc.save(fileName)\n\n      onShowToast?.('PDF report exported successfully', 'success')\n    } catch (error) {\n      console.error('Export error:', error)\n      onShowToast?.('Export failed', 'error')\n    }\n  }\n\n  const handleDelete = useCallback(async (corId, e) => {\n    e?.stopPropagation()\n    if (!confirm('Are you sure you want to delete this COR? This action cannot be undone.')) return\n\n    try {\n      await db.deleteCOR(corId)\n      setCORs(prev => prev.filter(c => c.id !== corId))\n      onShowToast?.('COR deleted', 'success')\n      loadStats()\n    } catch (error) {\n      console.error('Error deleting COR:', error)\n      onShowToast?.('Error deleting COR', 'error')\n    }\n  }, [loadStats]) // onShowToast is stable (memoized in App.jsx)\n\n  const handleSubmitForApproval = useCallback(async (corId, e) => {\n    e?.stopPropagation()\n    try {\n      await db.submitCORForApproval(corId)\n      await loadCORs()\n      onShowToast?.('COR submitted for approval', 'success')\n      loadStats()\n    } catch (error) {\n      console.error('Error submitting COR:', error?.message || error)\n      onShowToast?.(error?.message || 'Error submitting COR', 'error')\n    }\n  }, [loadCORs, loadStats]) // onShowToast is stable (memoized in App.jsx)\n\n  // Toggle COR selection\n  const toggleCORSelection = useCallback((corId, e) => {\n    e?.stopPropagation()\n    setSelectedCORs(prev => {\n      const next = new Set(prev)\n      if (next.has(corId)) {\n        next.delete(corId)\n      } else {\n        next.add(corId)\n      }\n      return next\n    })\n  }, [])\n\n  // Exit select mode\n  const exitSelectMode = () => {\n    setSelectMode(false)\n    setSelectedCORs(new Set())\n  }\n\n  // Group selected CORs\n  const handleGroupSelected = async () => {\n    if (!newGroupName.trim()) {\n      onShowToast?.('Please enter a group name', 'error')\n      return\n    }\n\n    try {\n      await db.bulkUpdateCORGroup([...selectedCORs], newGroupName.trim())\n      onShowToast?.(`${selectedCORs.size} CORs grouped as \"${newGroupName.trim()}\"`, 'success')\n      setShowGroupModal(false)\n      setNewGroupName('')\n      setSelectedCORs(new Set())\n      setSelectMode(false)\n      loadCORs()\n    } catch (error) {\n      console.error('Error grouping CORs:', error)\n      onShowToast?.('Error grouping CORs', 'error')\n    }\n  }\n\n  // Get unique groups from CORs\n  const availableGroups = useMemo(() => {\n    const groups = cors\n      .map(c => c.group_name)\n      .filter(Boolean)\n    return [...new Set(groups)].sort()\n  }, [cors])\n\n  // Filter CORs by status, area, group, view mode, and date range\n  const filteredCORs = useMemo(() => {\n    let filtered = [...cors]\n\n    // Status filter\n    if (filter !== 'all') {\n      filtered = filtered.filter(c => c.status === filter)\n    }\n\n    // Area filter\n    if (areaFilter !== 'all') {\n      filtered = filtered.filter(c => c.area_id === areaFilter)\n    }\n\n    // Group filter\n    if (groupFilter !== 'all') {\n      filtered = filtered.filter(c => c.group_name === groupFilter)\n    }\n\n    // Apply date filter if set\n    if (dateFilter.start) {\n      const startDate = new Date(dateFilter.start)\n      startDate.setHours(0, 0, 0, 0)\n      filtered = filtered.filter(c => {\n        const corDate = new Date(c.created_at)\n        return corDate >= startDate\n      })\n    }\n    if (dateFilter.end) {\n      const endDate = new Date(dateFilter.end)\n      endDate.setHours(23, 59, 59, 999)\n      filtered = filtered.filter(c => {\n        const corDate = new Date(c.created_at)\n        return corDate <= endDate\n      })\n    }\n\n    // In recent mode (not preview mode), show only last 7 days\n    if (viewMode === 'recent' && !previewMode) {\n      const sevenDaysAgo = new Date()\n      sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7)\n      sevenDaysAgo.setHours(0, 0, 0, 0)\n      filtered = filtered.filter(c => {\n        const corDate = new Date(c.created_at)\n        return corDate >= sevenDaysAgo\n      })\n    }\n\n    // Sort by created_at descending\n    filtered.sort((a, b) => new Date(b.created_at) - new Date(a.created_at))\n\n    // In preview mode, limit to previewLimit items\n    if (previewMode) {\n      filtered = filtered.slice(0, previewLimit)\n    }\n\n    return filtered\n  }, [cors, filter, areaFilter, groupFilter, viewMode, dateFilter, previewMode, previewLimit])\n\n  // Group CORs by month for 'all' view\n  const corsByMonth = useMemo(() => {\n    if (viewMode !== 'all') return null\n\n    const groups = {}\n    filteredCORs.forEach(cor => {\n      const date = new Date(cor.created_at)\n      const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`\n      const monthLabel = date.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })\n\n      if (!groups[monthKey]) {\n        groups[monthKey] = { label: monthLabel, cors: [], totalAmount: 0 }\n      }\n      groups[monthKey].cors.push(cor)\n      groups[monthKey].totalAmount += cor.cor_total || 0\n    })\n\n    return Object.entries(groups).sort((a, b) => b[0].localeCompare(a[0]))\n  }, [filteredCORs, viewMode])\n\n  // Auto-expand current month\n  useEffect(() => {\n    if (corsByMonth && corsByMonth.length > 0) {\n      const currentMonthKey = corsByMonth[0][0]\n      setExpandedMonths(new Set([currentMonthKey]))\n    }\n  }, [corsByMonth])\n\n  const toggleMonthExpand = (monthKey) => {\n    const newExpanded = new Set(expandedMonths)\n    if (newExpanded.has(monthKey)) {\n      newExpanded.delete(monthKey)\n    } else {\n      newExpanded.add(monthKey)\n    }\n    setExpandedMonths(newExpanded)\n  }\n\n  // Count by status\n  const counts = useMemo(() => ({\n    all: cors.length,\n    draft: cors.filter(c => c.status === 'draft').length,\n    pending_approval: cors.filter(c => c.status === 'pending_approval').length,\n    approved: cors.filter(c => c.status === 'approved').length,\n    rejected: cors.filter(c => c.status === 'rejected').length,\n    billed: cors.filter(c => c.status === 'billed').length,\n    closed: cors.filter(c => c.status === 'closed').length\n  }), [cors])\n\n  const totalCORsCount = filter === 'all' ? cors.length : cors.filter(c => c.status === filter).length\n\n  // Render COR card using memoized component\n  const renderCORCard = (cor) => (\n    <CORCard\n      key={cor.id}\n      cor={cor}\n      isSelected={selectedCORs.has(cor.id)}\n      selectMode={selectMode}\n      areas={areas}\n      onToggleSelect={toggleCORSelection}\n      onView={onViewCOR}\n      onEdit={onEditCOR}\n      onDelete={handleDelete}\n      onSubmitForApproval={handleSubmitForApproval}\n    />\n  )\n\n  if (loading) {\n    return (\n      <div className=\"cor-list\">\n        <div className=\"cor-loading-skeletons\">\n          {[1, 2, 3].map(i => (\n            <CardSkeleton key={i} />\n          ))}\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className={`cor-list ${previewMode ? 'cor-list-preview' : ''}`}>\n      {/* Clean Header */}\n      <div className=\"cor-list-header\">\n        <div className=\"cor-list-info\">\n          <h3>Change Orders</h3>\n          <div className=\"cor-stats-inline\">\n            <span className=\"cor-stat-item\">{counts.all} total</span>\n            {counts.pending_approval > 0 && (\n              <span className=\"cor-stat-item pending\">{counts.pending_approval} pending</span>\n            )}\n            {stats?.totalApproved > 0 && (\n              <span className=\"cor-stat-item approved\">{formatCurrency(stats.totalApproved)}</span>\n            )}\n          </div>\n        </div>\n        <div className=\"cor-header-actions\">\n          {/* Export buttons - always visible */}\n          {/* Export Dropdown */}\n          <div className=\"cor-export-dropdown\" ref={exportMenuRef}>\n            <button\n              className=\"btn btn-secondary btn-small\"\n              onClick={() => setShowExportMenu(!showExportMenu)}\n              disabled={cors.length === 0}\n            >\n              <Download size={14} /> Export <ChevronDown size={12} />\n            </button>\n            {showExportMenu && (\n              <div className=\"cor-export-menu\">\n                <button onClick={() => { exportToPDF(); setShowExportMenu(false); }}>\n                  <FileText size={14} /> Export as PDF\n                </button>\n                <button onClick={() => { exportToExcel(); setShowExportMenu(false); }}>\n                  <FileSpreadsheet size={14} /> Export as Excel\n                </button>\n              </div>\n            )}\n          </div>\n          {/* Display Mode Toggle - Log button is prominent for business use */}\n          <div className=\"cor-display-toggle\">\n            <button\n              className={`cor-display-btn ${displayMode === 'list' ? 'active' : ''}`}\n              onClick={() => handleDisplayModeChange('list')}\n              title=\"List View\"\n            >\n              <List size={14} />\n              <span>List</span>\n            </button>\n            <button\n              className={`cor-display-btn log-btn ${displayMode === 'log' ? 'active' : ''}`}\n              onClick={() => handleDisplayModeChange('log')}\n              title=\"COR Log - Edit & Export for Clients\"\n            >\n              <Table size={14} />\n              <span>COR Log</span>\n            </button>\n          </div>\n          {previewMode ? (\n            // In preview mode, show \"See All\" button and New COR button\n            <>\n              <button className=\"btn btn-primary btn-small\" onClick={onCreateCOR}>\n                <Plus size={14} /> New COR\n              </button>\n            </>\n          ) : (\n            // Full mode shows select and new buttons\n            <>\n              {displayMode === 'list' && (\n                <button\n                  className={`btn btn-secondary btn-small ${selectMode ? 'active' : ''}`}\n                  onClick={() => selectMode ? exitSelectMode() : setSelectMode(true)}\n                >\n                  {selectMode ? <><X size={14} /> Cancel</> : <><CheckSquare size={14} /> Select</>}\n                </button>\n              )}\n              <button className=\"btn btn-primary btn-small\" onClick={onCreateCOR}>\n                <Plus size={14} /> New COR\n              </button>\n            </>\n          )}\n        </div>\n      </div>\n\n      {/* Log View - renders CORLog in a full-screen modal for better editing */}\n      {displayMode === 'log' && (\n        <div className=\"cor-log-modal-overlay\" onClick={() => handleDisplayModeChange('list')}>\n          <div className=\"cor-log-modal\" onClick={(e) => e.stopPropagation()}>\n            <div className=\"cor-log-modal-header\">\n              <h2>Change Order Log</h2>\n              <button\n                className=\"cor-log-modal-close\"\n                onClick={() => handleDisplayModeChange('list')}\n                title=\"Close\"\n              >\n                <X size={24} />\n              </button>\n            </div>\n            <div className=\"cor-log-modal-content\">\n              <CORLog project={project} company={company} onShowToast={onShowToast} />\n            </div>\n          </div>\n        </div>\n      )}\n\n      {displayMode === 'list' && (\n        <>\n          {/* Selection Action Bar */}\n          {selectMode && selectedCORs.size > 0 && (\n            <div className=\"cor-selection-bar\">\n              <span className=\"selection-count\">{selectedCORs.size} selected</span>\n              <button\n                className=\"btn btn-primary btn-small\"\n                onClick={() => setShowGroupModal(true)}\n              >\n                <FolderPlus size={14} /> Group Selected\n              </button>\n            </div>\n          )}\n\n          {/* Minimal Filter Row - hidden in preview mode */}\n          {!previewMode && (\n            <div className=\"cor-controls\">\n              <div className=\"cor-filter-pills\" role=\"tablist\">\n                {[\n                  { id: 'all', label: 'All' },\n                  { id: 'draft', label: 'Draft' },\n                  { id: 'pending_approval', label: 'Pending' },\n                  { id: 'approved', label: 'Approved' }\n                ].map(status => (\n                  <button\n                    key={status.id}\n                    role=\"tab\"\n                    aria-selected={filter === status.id}\n                    className={`cor-pill ${filter === status.id ? 'active' : ''}`}\n                    onClick={() => setFilter(status.id)}\n                  >\n                    {status.label}\n                    {counts[status.id] > 0 && <span className=\"cor-pill-count\">{counts[status.id]}</span>}\n                  </button>\n                ))}\n              </div>\n\n              {/* Group Filter */}\n              {availableGroups.length > 0 && (\n                <select\n                  className=\"cor-group-filter\"\n                  value={groupFilter}\n                  onChange={(e) => setGroupFilter(e.target.value)}\n                >\n                  <option value=\"all\">All Groups</option>\n                  {availableGroups.map(group => (\n                    <option key={group} value={group}>{group}</option>\n                  ))}\n                </select>\n              )}\n\n              {/* View Toggle */}\n              <div className=\"cor-view-toggle\">\n                <button\n                  className={`cor-toggle-btn ${viewMode === 'recent' ? 'active' : ''}`}\n                  onClick={() => { setViewMode('recent'); setDateFilter({ start: '', end: '' }); }}\n                >\n                  Recent\n                </button>\n                <button\n                  className={`cor-toggle-btn ${viewMode === 'all' ? 'active' : ''}`}\n                  onClick={() => setViewMode('all')}\n                >\n                  All\n                </button>\n              </div>\n            </div>\n          )}\n\n          {/* Date Filter - Only in All mode and not preview mode */}\n          {viewMode === 'all' && !previewMode && (\n            <div className=\"cor-date-filter\">\n              <Calendar size={14} />\n              <input\n                type=\"date\"\n                value={dateFilter.start}\n                onChange={(e) => setDateFilter(prev => ({ ...prev, start: e.target.value }))}\n              />\n              <span className=\"cor-date-sep\">to</span>\n              <input\n                type=\"date\"\n                value={dateFilter.end}\n                onChange={(e) => setDateFilter(prev => ({ ...prev, end: e.target.value }))}\n              />\n              {(dateFilter.start || dateFilter.end) && (\n                <button className=\"cor-clear-btn\" onClick={() => setDateFilter({ start: '', end: '' })}>\n                  Clear\n                </button>\n              )}\n            </div>\n          )}\n\n          {/* COR List */}\n          {filteredCORs.length === 0 ? (\n            <div className=\"cor-empty\">\n              <FileText size={24} className=\"cor-empty-icon\" />\n              <p>No change orders {filter !== 'all' ? `(${filter.replace('_', ' ')})` : ''}</p>\n              <button className=\"btn btn-primary btn-small\" onClick={onCreateCOR}>\n                <Plus size={14} /> Create COR\n              </button>\n            </div>\n          ) : (\n            <div className=\"cor-cards stagger-children\">\n              {viewMode === 'all' && corsByMonth ? (\n                corsByMonth.map(([monthKey, monthData]) => (\n                  <div key={monthKey} className=\"cor-month-group animate-fade-in\">\n                    <button\n                      className=\"cor-month-header\"\n                      onClick={() => toggleMonthExpand(monthKey)}\n                    >\n                      <div className=\"cor-month-left\">\n                        {expandedMonths.has(monthKey) ? <ChevronDown size={16} /> : <ChevronRight size={16} />}\n                        <span>{monthData.label}</span>\n                        <CountBadge count={monthData.cors.length} size=\"small\" />\n                      </div>\n                      <span className=\"cor-month-total\">{formatCurrency(monthData.totalAmount)}</span>\n                    </button>\n                    {expandedMonths.has(monthKey) && (\n                      <div className=\"cor-month-items stagger-children\">\n                        {monthData.cors.map(cor => renderCORCard(cor))}\n                      </div>\n                    )}\n                  </div>\n                ))\n              ) : (\n                filteredCORs.map(cor => renderCORCard(cor))\n              )}\n            </div>\n          )}\n\n          {/* See All Footer - only in preview mode when there are more items */}\n          {previewMode && cors.length > previewLimit && (\n            <button className=\"cor-see-all-btn\" onClick={onViewAll}>\n              See all {cors.length} change orders\n              <ChevronRight size={16} />\n            </button>\n          )}\n        </>\n      )}\n\n      {/* Group Modal */}\n      {showGroupModal && (\n        <div className=\"modal-overlay\" onClick={() => setShowGroupModal(false)}>\n          <div className=\"modal-content cor-group-modal\" onClick={e => e.stopPropagation()}>\n            <div className=\"modal-header\">\n              <h3>Group {selectedCORs.size} CORs</h3>\n              <button className=\"close-btn\" onClick={() => setShowGroupModal(false)}>\n                <X size={20} />\n              </button>\n            </div>\n            <div className=\"modal-body\">\n              <div className=\"form-group\">\n                <label>Group Name</label>\n                <input\n                  type=\"text\"\n                  value={newGroupName}\n                  onChange={(e) => setNewGroupName(e.target.value)}\n                  placeholder=\"e.g., Phase 1, Building A, Week 1\"\n                  autoFocus\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter') handleGroupSelected()\n                    if (e.key === 'Escape') setShowGroupModal(false)\n                  }}\n                />\n              </div>\n              {availableGroups.length > 0 && (\n                <div className=\"existing-groups\">\n                  <label>Or select existing group:</label>\n                  <div className=\"group-chips\">\n                    {availableGroups.map(group => (\n                      <button\n                        key={group}\n                        className=\"group-chip\"\n                        onClick={() => setNewGroupName(group)}\n                      >\n                        {group}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n            <div className=\"modal-footer\">\n              <button className=\"btn btn-secondary\" onClick={() => setShowGroupModal(false)}>\n                Cancel\n              </button>\n              <button className=\"btn btn-primary\" onClick={handleGroupSelected}>\n                Group CORs\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n"],"file":"CORList-CW1F-Pbk.js"}