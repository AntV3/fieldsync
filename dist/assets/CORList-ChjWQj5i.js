import{_ as xe}from"./pdf-aQqpMATS.js";import{as as e,aL as Ue,ar as O,aO as ye,aP as Ie}from"./index-DQmUZqiB.js";import{r as i,_ as Ee,ay as He,j as Ye,h as qe,P as Xe,az as Je,a8 as Qe,D as Ke,q as Re,F as Oe,z as Ze,aw as et,aA as tt,n as be,X as Ce,aB as at,O as st,y as we}from"./icons-B-oSmWeD.js";import{g as lt,f,a as nt,b as rt}from"./corCalculations-D9qkkIbo.js";import{c as ot,C as it}from"./Dashboard-Dmc0y8PL.js";import ct from"./CORLog-DfkCyciu.js";import"./react-DXGY7bZi.js";import"./supabase-VuevzHjS.js";const dt=i.memo(function({cor:r,isSelected:w,selectMode:V,areas:h,onToggleSelect:E,onView:Y,onEdit:oe,onDelete:C,onSubmitForApproval:T}){const k=lt(r.status),ie=["draft","pending_approval","approved"].includes(r.status),F=["draft","pending_approval","rejected"].includes(r.status),o=r.status==="draft",q=c=>h?.find(G=>G.id===c)?.name||"No Area",X=()=>{V?E(r.id):Y?.(r)},ce=c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),X())};return e.jsxs("div",{className:`cor-card hover-lift animate-fade-in-up ${r.status} ${w?"selected":""}`,onClick:X,onKeyDown:ce,tabIndex:0,role:"button","aria-label":`${V?w?"Deselect":"Select":"View"} COR ${r.cor_number}: ${r.title||"Untitled"}, ${k.label}, ${f(r.cor_total||0)}`,children:[e.jsxs("div",{className:"cor-card-header",children:[e.jsxs("div",{className:"cor-card-left",children:[V&&e.jsx("button",{className:"cor-select-checkbox",onClick:c=>{c.stopPropagation(),E(r.id,c)},"aria-label":w?"Deselect":"Select",children:w?e.jsx(Ee,{size:18}):e.jsx(He,{size:18})}),e.jsx("span",{className:"cor-number",children:r.cor_number}),e.jsx("span",{className:"cor-status-badge",style:{backgroundColor:k.bgColor,color:k.color},children:k.label}),(r.gc_signature_data||r.client_signature_data)&&e.jsxs("span",{className:"cor-signed-badge",title:`Signed by ${r.gc_signature_name||r.client_signature_name||"Client"}`,children:[e.jsx(Ye,{size:12})," Signed"]})]}),e.jsx("div",{className:"cor-card-right",children:e.jsx("span",{className:"cor-total",children:f(r.cor_total||0)})})]}),e.jsxs("div",{className:"cor-card-body",children:[e.jsx("h4",{className:"cor-title",children:r.title||"Untitled COR"}),e.jsxs("div",{className:"cor-meta",children:[r.group_name&&e.jsx("span",{className:"cor-group-badge",children:r.group_name}),r.area_id&&e.jsx("span",{className:"cor-area",children:q(r.area_id)}),e.jsx("span",{className:"cor-period",children:nt(r.period_start,r.period_end)})]})]}),e.jsxs("div",{className:"cor-card-footer",children:[e.jsx("span",{className:"cor-created",children:rt(r.created_at)}),e.jsxs("div",{className:"cor-actions",onClick:c=>c.stopPropagation(),children:[o&&e.jsx("button",{className:"cor-action-btn submit",onClick:c=>T(r.id,c),title:"Submit for Approval","aria-label":`Submit COR ${r.cor_number} for approval`,children:e.jsx(qe,{size:14,"aria-hidden":"true"})}),ie&&e.jsx("button",{className:"cor-action-btn edit",onClick:c=>{c.stopPropagation(),oe?.(r)},title:"Edit","aria-label":`Edit COR ${r.cor_number}`,children:e.jsx(Xe,{size:14,"aria-hidden":"true"})}),e.jsx("button",{className:"cor-action-btn view",onClick:c=>{c.stopPropagation(),Y?.(r)},title:"View Details","aria-label":`View COR ${r.cor_number} details`,children:e.jsx(Je,{size:14,"aria-hidden":"true"})}),F&&e.jsx("button",{className:"cor-action-btn delete",onClick:c=>C(r.id,c),title:"Delete","aria-label":`Delete COR ${r.cor_number}`,children:e.jsx(Qe,{size:14,"aria-hidden":"true"})})]})]})]})}),H={draft:{label:"Draft",color:[107,114,128],bgColor:[243,244,246]},pending_approval:{label:"Pending Approval",color:[217,119,6],bgColor:[254,243,199]},approved:{label:"Approved",color:[5,150,105],bgColor:[209,250,229]},rejected:{label:"Rejected",color:[220,38,38],bgColor:[254,226,226]},billed:{label:"Billed",color:[37,99,235],bgColor:[219,234,254]},closed:{label:"Closed",color:[75,85,99],bgColor:[229,231,235]}};function vt({project:u,company:r,areas:w,refreshKey:V,onShowToast:h,onCreateCOR:E,onViewCOR:Y,onEditCOR:oe,previewMode:C=!1,previewLimit:T=5,onViewAll:k,onDisplayModeChange:ie}){const{branding:F}=Ue(),[o,q]=i.useState([]),[X,ce]=i.useState(!0),[c,fe]=i.useState("all"),[G,ut]=i.useState("all"),[J,ke]=i.useState("all"),[ht,pt]=i.useState(null),[A,de]=i.useState(new Set),[M,ue]=i.useState(!1),[Fe,z]=i.useState(!1),[Q,he]=i.useState(""),[K,Z]=i.useState(!1),pe=i.useRef(null);i.useEffect(()=>{const t=s=>{pe.current&&!pe.current.contains(s.target)&&Z(!1)};return K&&document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[K]);const[B,Ae]=i.useState("list"),ee=t=>{Ae(t),ie?.(t)},[_,je]=i.useState(C?"all":"recent"),[me,_e]=i.useState(new Set),[j,te]=i.useState({start:"",end:""}),[ve,ze]=i.useState(null),P=i.useCallback(async()=>{try{const t=await O.getCORs(u.id);q(t||[])}catch(t){console.error("Error loading CORs:",t),h?.("Error loading change order requests","error")}finally{ce(!1)}},[u.id]),D=i.useCallback(async()=>{try{const t=await O.getCORStats?.(u.id);ze(t)}catch(t){console.error("Error loading COR stats:",t)}},[u.id]);i.useEffect(()=>{P(),D();const t=O.subscribeToCORs?.(u.id,()=>{P(),D()});return()=>{t&&O.unsubscribe?.(t)}},[u.id,V,P,D]);const Pe=async()=>{if(o.length===0){h?.("No CORs to export","error");return}h?.("Generating Excel report...","info");try{const t=await xe(()=>import("./xlsx-BvJTHLik.js"),[]),s=o.filter(n=>n.status==="approved"),a=o.filter(n=>["draft","pending_approval"].includes(n.status)),d=o.filter(n=>n.status==="rejected"),$=o.filter(n=>n.status==="billed"),p=o.reduce((n,m)=>n+(m.cor_total||0),0)/100,b=s.reduce((n,m)=>n+(m.cor_total||0),0)/100,U=a.reduce((n,m)=>n+(m.cor_total||0),0)/100,v=t.utils.book_new(),x=[["CHANGE ORDER REQUEST SUMMARY"],[],["Company:",r?.name||""],["Project:",u.name],["Job Number:",u.job_number||"N/A"],["Report Date:",new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})],[],["FINANCIAL OVERVIEW"],[],["Category","Count","Value"],["Total CORs",o.length,p],["Approved",s.length,b],["Pending Approval",a.length,U],["Rejected",d.length,d.reduce((n,m)=>n+(m.cor_total||0),0)/100],["Billed",$.length,$.reduce((n,m)=>n+(m.cor_total||0),0)/100],[],["CONTRACT IMPACT"],[],["Original Contract Value:",u.contract_value||0],["Total Approved CORs:",b],["Revised Contract Value:",(u.contract_value||0)+b],["Pending COR Value:",U],["Potential Total:",(u.contract_value||0)+b+U]],I=t.utils.aoa_to_sheet(x);I["!cols"]=[{wch:25},{wch:15},{wch:18}],t.utils.book_append_sheet(v,I,"Summary");const le=["COR #","Title","Description","Amount","Status","Created Date","Submitted Date","Approved Date","Approved By","Work Period Start","Work Period End","Area"],ne=o.map(n=>[n.cor_number||"",n.title||"Untitled",n.scope_of_work||"",(n.cor_total||0)/100,H[n.status]?.label||n.status,n.created_at?new Date(n.created_at).toLocaleDateString():"",n.submitted_at?new Date(n.submitted_at).toLocaleDateString():"",n.approved_at?new Date(n.approved_at).toLocaleDateString():"",n.approved_by_name||"",n.period_start?new Date(n.period_start).toLocaleDateString():"",n.period_end?new Date(n.period_end).toLocaleDateString():"",n.area?.name||""]),N=t.utils.aoa_to_sheet([le,...ne]);N["!cols"]=[{wch:10},{wch:30},{wch:40},{wch:14},{wch:16},{wch:12},{wch:12},{wch:12},{wch:18},{wch:12},{wch:12},{wch:15}];for(let n=1;n<=ne.length;n++){const m=t.utils.encode_cell({r:n,c:3});N[m]&&(N[m].z="$#,##0.00")}t.utils.book_append_sheet(v,N,"COR Details"),[{name:"Approved CORs",data:s,status:"approved"},{name:"Pending CORs",data:a,status:"pending"}].forEach(({name:n,data:m})=>{if(m.length>0){const R=[["COR #","Title","Amount","Date"],...m.map(l=>[l.cor_number||"",l.title||"Untitled",(l.cor_total||0)/100,l.created_at?new Date(l.created_at).toLocaleDateString():""]),[],["TOTAL","",m.reduce((l,g)=>l+(g.cor_total||0),0)/100,""]],re=t.utils.aoa_to_sheet(R);re["!cols"]=[{wch:12},{wch:40},{wch:14},{wch:12}],t.utils.book_append_sheet(v,re,n)}});const y=`COR_Report_${u.job_number||u.name}_${new Date().toISOString().split("T")[0]}.xlsx`;t.writeFile(v,y),h?.("Excel report exported successfully","success")}catch(t){console.error("Export error:",t),h?.("Export failed","error")}},Le=async()=>{if(o.length===0){h?.("No CORs to export","error");return}h?.("Generating PDF report...","info");try{const{default:t}=await xe(async()=>{const{default:l}=await import("./pdf-aQqpMATS.js").then(g=>g.j);return{default:l}},[]),{default:s}=await xe(async()=>{const{default:l}=await import("./pdf-aQqpMATS.js").then(g=>g.c);return{default:l}},[]),a=new t("landscape"),d=a.internal.pageSize.width,$=a.internal.pageSize.height,p=15,b=ye(F?.primary_color||"#3B82F6"),U=ye(F?.secondary_color||"#1E40AF");a.setFillColor(...b),a.rect(0,0,d,40,"F"),a.setFillColor(...U),a.rect(0,38,d,3,"F");let v=p;if(F?.logo_url)try{const l=await Ie(F.logo_url);l&&(a.addImage(l,"PNG",p,6,28,28),v=p+35)}catch(l){console.error("Logo load error:",l)}a.setTextColor(255,255,255),a.setFontSize(20),a.setFont("helvetica","bold"),a.text(r?.name||"Company",v,18),a.setFontSize(11),a.setFont("helvetica","normal"),a.text("CHANGE ORDER REQUEST REPORT",v,28),a.setFontSize(9),a.text(new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),d-p,15,{align:"right"}),u.job_number&&a.text(`Job #: ${u.job_number}`,d-p,23,{align:"right"}),a.text(`${o.length} Change Orders`,d-p,31,{align:"right"});let x=50;a.setFillColor(248,250,252),a.setDrawColor(...b),a.setLineWidth(.5),a.roundedRect(p,x,d-p*2,25,3,3,"FD"),a.setTextColor(...b),a.setFontSize(14),a.setFont("helvetica","bold"),a.text(u.name,p+8,x+10),a.setTextColor(100,116,139),a.setFontSize(9),a.setFont("helvetica","normal"),u.address&&a.text(u.address,p+8,x+18),x+=35;const I=o.filter(l=>l.status==="approved"),le=o.filter(l=>["draft","pending_approval"].includes(l.status)),ne=o.reduce((l,g)=>l+(g.cor_total||0),0),N=I.reduce((l,g)=>l+(g.cor_total||0),0),De=le.reduce((l,g)=>l+(g.cor_total||0),0),y=(d-p*2-30)/4;[{label:"Total CORs",value:o.length.toString(),subValue:f(ne)},{label:"Approved",value:I.length.toString(),subValue:f(N),color:[5,150,105]},{label:"Pending",value:le.length.toString(),subValue:f(De),color:[217,119,6]},{label:"Revised Contract",value:f((u.contract_value||0)*100+N),subValue:`+${f(N)} from original`,color:b}].forEach((l,g)=>{const S=p+g*(y+10),ge=l.color||b,Be=ge.map(We=>Math.min(255,We+200));a.setFillColor(...Be),a.setDrawColor(...ge),a.roundedRect(S,x,y,32,2,2,"FD"),a.setTextColor(...ge),a.setFontSize(18),a.setFont("helvetica","bold"),a.text(l.value,S+y/2,x+14,{align:"center"}),a.setTextColor(100,116,139),a.setFontSize(8),a.setFont("helvetica","normal"),a.text(l.label,S+y/2,x+22,{align:"center"}),l.subValue&&(a.setFontSize(7),a.text(l.subValue,S+y/2,x+28,{align:"center"}))}),x+=42,a.setTextColor(...b),a.setFontSize(11),a.setFont("helvetica","bold"),a.text("CHANGE ORDER DETAILS",p,x),x+=5;const m=o.map((l,g)=>{const S=H[l.status]||{label:l.status,color:[107,114,128]};return[(g+1).toString(),l.cor_number||"-",l.title||"Untitled",f(l.cor_total||0),S.label,l.created_at?new Date(l.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"2-digit"}):"-"]});s(a,{startY:x,head:[["#","COR #","Description","Amount","Status","Date"]],body:m,theme:"grid",styles:{fontSize:9,cellPadding:4,lineColor:[226,232,240],lineWidth:.1},headStyles:{fillColor:b,textColor:[255,255,255],fontStyle:"bold",halign:"center"},columnStyles:{0:{cellWidth:12,halign:"center"},1:{cellWidth:25,halign:"center"},2:{cellWidth:"auto"},3:{cellWidth:30,halign:"right",fontStyle:"bold"},4:{cellWidth:28,halign:"center"},5:{cellWidth:28,halign:"center"}},alternateRowStyles:{fillColor:[248,250,252]},didParseCell:l=>{if(l.column.index===4&&l.section==="body"){const g=Object.keys(H).find(S=>H[S].label===l.cell.raw);g&&(l.cell.styles.textColor=H[g].color,l.cell.styles.fontStyle="bold")}}});const R=$-12;a.setDrawColor(226,232,240),a.setLineWidth(.5),a.line(p,R-5,d-p,R-5),a.setTextColor(148,163,184),a.setFontSize(8),a.setFont("helvetica","normal"),a.text(`Generated on ${new Date().toLocaleString()}`,p,R),a.text(`${r?.name||"FieldSync"} â€¢ Confidential`,d/2,R,{align:"center"}),a.text("Page 1 of 1",d-p,R,{align:"right"});const re=`COR_Report_${u.job_number||u.name}_${new Date().toISOString().split("T")[0]}.pdf`;a.save(re),h?.("PDF report exported successfully","success")}catch(t){console.error("Export error:",t),h?.("Export failed","error")}},$e=i.useCallback(async(t,s)=>{if(s?.stopPropagation(),!!confirm("Are you sure you want to delete this COR? This action cannot be undone."))try{await O.deleteCOR(t),q(a=>a.filter(d=>d.id!==t)),h?.("COR deleted","success"),D()}catch(a){console.error("Error deleting COR:",a),h?.("Error deleting COR","error")}},[D]),Ve=i.useCallback(async(t,s)=>{s?.stopPropagation();try{await O.submitCORForApproval(t),await P(),h?.("COR submitted for approval","success"),D()}catch(a){console.error("Error submitting COR:",a?.message||a),h?.(a?.message||"Error submitting COR","error")}},[P,D]),Te=i.useCallback((t,s)=>{s?.stopPropagation(),de(a=>{const d=new Set(a);return d.has(t)?d.delete(t):d.add(t),d})},[]),Ge=()=>{ue(!1),de(new Set)},Ne=async()=>{if(!Q.trim()){h?.("Please enter a group name","error");return}try{await O.bulkUpdateCORGroup([...A],Q.trim()),h?.(`${A.size} CORs grouped as "${Q.trim()}"`,"success"),z(!1),he(""),de(new Set),ue(!1),P()}catch(t){console.error("Error grouping CORs:",t),h?.("Error grouping CORs","error")}},ae=i.useMemo(()=>{const t=o.map(s=>s.group_name).filter(Boolean);return[...new Set(t)].sort()},[o]),se=i.useMemo(()=>{let t=[...o];if(c!=="all"&&(t=t.filter(s=>s.status===c)),G!=="all"&&(t=t.filter(s=>s.area_id===G)),J!=="all"&&(t=t.filter(s=>s.group_name===J)),j.start){const s=new Date(j.start);s.setHours(0,0,0,0),t=t.filter(a=>new Date(a.created_at)>=s)}if(j.end){const s=new Date(j.end);s.setHours(23,59,59,999),t=t.filter(a=>new Date(a.created_at)<=s)}if(_==="recent"&&!C){const s=new Date;s.setDate(s.getDate()-7),s.setHours(0,0,0,0),t=t.filter(a=>new Date(a.created_at)>=s)}return t.sort((s,a)=>new Date(a.created_at)-new Date(s.created_at)),C&&(t=t.slice(0,T)),t},[o,c,G,J,_,j,C,T]),L=i.useMemo(()=>{if(_!=="all")return null;const t={};return se.forEach(s=>{const a=new Date(s.created_at),d=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,$=a.toLocaleDateString("en-US",{month:"long",year:"numeric"});t[d]||(t[d]={label:$,cors:[],totalAmount:0}),t[d].cors.push(s),t[d].totalAmount+=s.cor_total||0}),Object.entries(t).sort((s,a)=>a[0].localeCompare(s[0]))},[se,_]);i.useEffect(()=>{if(L&&L.length>0){const t=L[0][0];_e(new Set([t]))}},[L]);const Me=t=>{const s=new Set(me);s.has(t)?s.delete(t):s.add(t),_e(s)},W=i.useMemo(()=>({all:o.length,draft:o.filter(t=>t.status==="draft").length,pending_approval:o.filter(t=>t.status==="pending_approval").length,approved:o.filter(t=>t.status==="approved").length,rejected:o.filter(t=>t.status==="rejected").length,billed:o.filter(t=>t.status==="billed").length,closed:o.filter(t=>t.status==="closed").length}),[o]);c==="all"?o.length:o.filter(t=>t.status===c).length;const Se=t=>e.jsx(dt,{cor:t,isSelected:A.has(t.id),selectMode:M,areas:w,onToggleSelect:Te,onView:Y,onEdit:oe,onDelete:$e,onSubmitForApproval:Ve},t.id);return X?e.jsx("div",{className:"cor-list",children:e.jsx("div",{className:"cor-loading-skeletons",children:[1,2,3].map(t=>e.jsx(ot,{},t))})}):e.jsxs("div",{className:`cor-list ${C?"cor-list-preview":""}`,children:[e.jsxs("div",{className:"cor-list-header",children:[e.jsxs("div",{className:"cor-list-info",children:[e.jsx("h3",{children:"Change Orders"}),e.jsxs("div",{className:"cor-stats-inline",children:[e.jsxs("span",{className:"cor-stat-item",children:[W.all," total"]}),W.pending_approval>0&&e.jsxs("span",{className:"cor-stat-item pending",children:[W.pending_approval," pending"]}),ve?.totalApproved>0&&e.jsx("span",{className:"cor-stat-item approved",children:f(ve.totalApproved)})]})]}),e.jsxs("div",{className:"cor-header-actions",children:[e.jsxs("div",{className:"cor-export-dropdown",ref:pe,children:[e.jsxs("button",{className:"btn btn-secondary btn-small",onClick:()=>Z(!K),disabled:o.length===0,children:[e.jsx(Ke,{size:14})," Export ",e.jsx(Re,{size:12})]}),K&&e.jsxs("div",{className:"cor-export-menu",children:[e.jsxs("button",{onClick:()=>{Le(),Z(!1)},children:[e.jsx(Oe,{size:14})," Export as PDF"]}),e.jsxs("button",{onClick:()=>{Pe(),Z(!1)},children:[e.jsx(Ze,{size:14})," Export as Excel"]})]})]}),e.jsxs("div",{className:"cor-display-toggle",children:[e.jsxs("button",{className:`cor-display-btn ${B==="list"?"active":""}`,onClick:()=>ee("list"),title:"List View",children:[e.jsx(et,{size:14}),e.jsx("span",{children:"List"})]}),e.jsxs("button",{className:`cor-display-btn log-btn ${B==="log"?"active":""}`,onClick:()=>ee("log"),title:"COR Log - Edit & Export for Clients",children:[e.jsx(tt,{size:14}),e.jsx("span",{children:"COR Log"})]})]}),C?e.jsx(e.Fragment,{children:e.jsxs("button",{className:"btn btn-primary btn-small",onClick:E,children:[e.jsx(be,{size:14})," New COR"]})}):e.jsxs(e.Fragment,{children:[B==="list"&&e.jsx("button",{className:`btn btn-secondary btn-small ${M?"active":""}`,onClick:()=>M?Ge():ue(!0),children:M?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{size:14})," Cancel"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{size:14})," Select"]})}),e.jsxs("button",{className:"btn btn-primary btn-small",onClick:E,children:[e.jsx(be,{size:14})," New COR"]})]})]})]}),B==="log"&&e.jsx("div",{className:"cor-log-modal-overlay",onClick:()=>ee("list"),children:e.jsxs("div",{className:"cor-log-modal",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"cor-log-modal-header",children:[e.jsx("h2",{children:"Change Order Log"}),e.jsx("button",{className:"cor-log-modal-close",onClick:()=>ee("list"),title:"Close",children:e.jsx(Ce,{size:24})})]}),e.jsx("div",{className:"cor-log-modal-content",children:e.jsx(ct,{project:u,company:r,onShowToast:h})})]})}),B==="list"&&e.jsxs(e.Fragment,{children:[M&&A.size>0&&e.jsxs("div",{className:"cor-selection-bar",children:[e.jsxs("span",{className:"selection-count",children:[A.size," selected"]}),e.jsxs("button",{className:"btn btn-primary btn-small",onClick:()=>z(!0),children:[e.jsx(at,{size:14})," Group Selected"]})]}),!C&&e.jsxs("div",{className:"cor-controls",children:[e.jsx("div",{className:"cor-filter-pills",role:"tablist",children:[{id:"all",label:"All"},{id:"draft",label:"Draft"},{id:"pending_approval",label:"Pending"},{id:"approved",label:"Approved"}].map(t=>e.jsxs("button",{role:"tab","aria-selected":c===t.id,className:`cor-pill ${c===t.id?"active":""}`,onClick:()=>fe(t.id),children:[t.label,W[t.id]>0&&e.jsx("span",{className:"cor-pill-count",children:W[t.id]})]},t.id))}),ae.length>0&&e.jsxs("select",{className:"cor-group-filter",value:J,onChange:t=>ke(t.target.value),children:[e.jsx("option",{value:"all",children:"All Groups"}),ae.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("div",{className:"cor-view-toggle",children:[e.jsx("button",{className:`cor-toggle-btn ${_==="recent"?"active":""}`,onClick:()=>{je("recent"),te({start:"",end:""})},children:"Recent"}),e.jsx("button",{className:`cor-toggle-btn ${_==="all"?"active":""}`,onClick:()=>je("all"),children:"All"})]})]}),_==="all"&&!C&&e.jsxs("div",{className:"cor-date-filter",children:[e.jsx(st,{size:14}),e.jsx("input",{type:"date",value:j.start,onChange:t=>te(s=>({...s,start:t.target.value}))}),e.jsx("span",{className:"cor-date-sep",children:"to"}),e.jsx("input",{type:"date",value:j.end,onChange:t=>te(s=>({...s,end:t.target.value}))}),(j.start||j.end)&&e.jsx("button",{className:"cor-clear-btn",onClick:()=>te({start:"",end:""}),children:"Clear"})]}),se.length===0?e.jsxs("div",{className:"cor-empty",children:[e.jsx(Oe,{size:24,className:"cor-empty-icon"}),e.jsxs("p",{children:["No change orders ",c!=="all"?`(${c.replace("_"," ")})`:""]}),e.jsxs("button",{className:"btn btn-primary btn-small",onClick:E,children:[e.jsx(be,{size:14})," Create COR"]})]}):e.jsx("div",{className:"cor-cards stagger-children",children:_==="all"&&L?L.map(([t,s])=>e.jsxs("div",{className:"cor-month-group animate-fade-in",children:[e.jsxs("button",{className:"cor-month-header",onClick:()=>Me(t),children:[e.jsxs("div",{className:"cor-month-left",children:[me.has(t)?e.jsx(Re,{size:16}):e.jsx(we,{size:16}),e.jsx("span",{children:s.label}),e.jsx(it,{count:s.cors.length,size:"small"})]}),e.jsx("span",{className:"cor-month-total",children:f(s.totalAmount)})]}),me.has(t)&&e.jsx("div",{className:"cor-month-items stagger-children",children:s.cors.map(a=>Se(a))})]},t)):se.map(t=>Se(t))}),C&&o.length>T&&e.jsxs("button",{className:"cor-see-all-btn",onClick:k,children:["See all ",o.length," change orders",e.jsx(we,{size:16})]})]}),Fe&&e.jsx("div",{className:"modal-overlay",onClick:()=>z(!1),children:e.jsxs("div",{className:"modal-content cor-group-modal",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{children:["Group ",A.size," CORs"]}),e.jsx("button",{className:"close-btn",onClick:()=>z(!1),children:e.jsx(Ce,{size:20})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Group Name"}),e.jsx("input",{type:"text",value:Q,onChange:t=>he(t.target.value),placeholder:"e.g., Phase 1, Building A, Week 1",autoFocus:!0,onKeyDown:t=>{t.key==="Enter"&&Ne(),t.key==="Escape"&&z(!1)}})]}),ae.length>0&&e.jsxs("div",{className:"existing-groups",children:[e.jsx("label",{children:"Or select existing group:"}),e.jsx("div",{className:"group-chips",children:ae.map(t=>e.jsx("button",{className:"group-chip",onClick:()=>he(t),children:t},t))})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>z(!1),children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:Ne,children:"Group CORs"})]})]})})]})}export{vt as default};
//# sourceMappingURL=CORList-ChjWQj5i.js.map
