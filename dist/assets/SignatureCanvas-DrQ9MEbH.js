import{q as e}from"./index-BGtkE9hQ.js";import{r,X as V,a as _,af as K,R as Q,C as Z}from"./icons-Bl--ZLwb.js";function se({onSave:I,onClose:c,title:R="Signature",enhanced:a=!1,slot:l=null,documentType:m=null,documentTitle:x="",signerName:M="",signerTitle:P="",signerCompany:z="",legalText:p=null,requireAcknowledgment:b=!1,canvasWidth:E=500,canvasHeight:Y=180,lockBodyScroll:v=!1}){const o=r.useRef(null),[d,X]=r.useState(M),[y,q]=r.useState(P),[f,A]=r.useState(z),[u,j]=r.useState(!1),[L,w]=r.useState(!1),[C,O]=r.useState(!b),$=l?l===1?"GC Authorization":"Client Authorization":R,N=m==="cor"?"Change Order Request":m==="tm_ticket"?"T&M Work Order":"document",F=`I acknowledge that this electronic signature is legally binding and that I have reviewed and approve this ${N}. I understand that my signature, name, and IP address will be recorded for verification purposes.`;r.useEffect(()=>{if(!v)return;const t=document.body.style.overflow,s=document.body.style.position,n=document.body.style.top,i=window.scrollY;return document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${i}px`,document.body.style.width="100%",()=>{document.body.style.overflow=t,document.body.style.position=s,document.body.style.top=n,document.body.style.width="",window.scrollTo(0,i)}},[v]);const g=()=>{const t=o.current;return t?t.getContext("2d"):null},S=t=>{const s=o.current;if(!s)return{x:0,y:0};const n=s.getBoundingClientRect(),i=s.width/n.width,G=s.height/n.height,H=t.touches?.length?t.touches[0].clientX:t.clientX,J=t.touches?.length?t.touches[0].clientY:t.clientY;return{x:(H-n.left)*i,y:(J-n.top)*G}},k=t=>{t.preventDefault();const s=g();if(!s)return;const{x:n,y:i}=S(t);s.beginPath(),s.moveTo(n,i),w(!0),j(!0)},T=t=>{if(!L)return;t.preventDefault();const s=g();if(!s)return;const{x:n,y:i}=S(t);s.lineTo(n,i),s.stroke()},h=()=>{w(!1)},U=()=>{const t=o.current,s=g();!t||!s||(s.clearRect(0,0,t.width,t.height),j(!1))},B=t=>{if(!t)return;o.current=t;const s=t.getContext("2d");s.strokeStyle="#1e293b",s.lineWidth=2,s.lineCap="round",s.lineJoin="round"},D=u&&d.trim()&&C,W=()=>{if(!D)return;const t=o.current;if(!t)return;const n={signature:t.toDataURL("image/png"),signerName:d.trim(),signedAt:new Date().toISOString()};a&&(n.signerTitle=y.trim()||null,n.signerCompany=f.trim()||null),I(n)};return e.jsx("div",{className:"modal-overlay",onClick:c,role:"dialog","aria-modal":"true","aria-labelledby":"signature-title",children:e.jsxs("div",{className:`modal-content signature-modal${a?" enhanced":""}`,onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{className:"signature-header-info",children:[e.jsx("h2",{id:"signature-title",children:$}),x&&e.jsx("span",{className:"signature-doc-ref",children:x})]}),e.jsx("button",{className:"close-btn",onClick:c,"aria-label":"Close signature modal",children:e.jsx(V,{size:20,"aria-hidden":"true"})})]}),e.jsxs("div",{className:"modal-body signature-body",children:[l&&e.jsxs("div",{className:"signature-slot-badge",children:[e.jsx(_,{size:14}),e.jsxs("span",{children:["Signature ",l," of 2"]})]}),e.jsxs("div",{className:"signature-fields",children:[e.jsxs("div",{className:"form-group required",children:[e.jsx("label",{htmlFor:"sig-name",children:a?"Print Name":"Signer Name *"}),e.jsx("input",{id:"sig-name",type:"text",value:d,onChange:t=>X(t.target.value),placeholder:a?"Enter your full legal name":"Enter full name","aria-required":"true",className:"input-required"})]}),a&&e.jsxs("div",{className:"signature-fields-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"sig-title",children:"Title"}),e.jsx("input",{id:"sig-title",type:"text",value:y,onChange:t=>q(t.target.value),placeholder:"e.g., Project Manager"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"sig-company",children:"Company"}),e.jsx("input",{id:"sig-company",type:"text",value:f,onChange:t=>A(t.target.value),placeholder:"e.g., ABC Construction"})]})]})]}),e.jsxs("div",{className:"signature-area",children:[e.jsxs("div",{className:"signature-label",id:"signature-instructions",children:[e.jsx(K,{size:16,"aria-hidden":"true"}),e.jsx("span",{children:a?"Draw your signature below":"Sign below"})]}),e.jsxs("div",{className:"signature-canvas-container",children:[e.jsx("canvas",{ref:B,width:E,height:Y,className:"signature-canvas",onMouseDown:k,onMouseMove:T,onMouseUp:h,onMouseLeave:h,onTouchStart:k,onTouchMove:T,onTouchEnd:h,role:"img","aria-label":"Signature drawing area. Use mouse or touch to draw your signature.","aria-describedby":"signature-instructions",tabIndex:0}),!u&&e.jsx("div",{className:"signature-placeholder",children:"Sign here"})]}),e.jsxs("button",{className:"btn btn-ghost btn-small",onClick:U,disabled:!u,"aria-label":"Clear signature",children:[e.jsx(Q,{size:14,"aria-hidden":"true"})," Clear"]})]}),b?e.jsx("div",{className:"signature-acknowledgment",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:C,onChange:t=>O(t.target.checked)}),e.jsx("span",{children:p||F})]})}):e.jsx("p",{className:"signature-legal",role:"note",children:p||`By signing above, I acknowledge that I have reviewed and approve this ${N}.`})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:c,"aria-label":"Cancel and close",children:"Cancel"}),e.jsxs("button",{className:"btn btn-primary",onClick:W,disabled:!D,"aria-label":a?"Submit signature":"Save signature",children:[e.jsx(Z,{size:16,"aria-hidden":"true"})," ",a?"Submit Signature":"Save Signature"]})]})]})})}export{se as S};
//# sourceMappingURL=SignatureCanvas-DrQ9MEbH.js.map
