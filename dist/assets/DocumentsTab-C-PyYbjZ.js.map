{"version":3,"file":"DocumentsTab-C-PyYbjZ.js","sources":["../../src/lib/constants.js","../../src/components/documents/DocumentUploadModal.jsx","../../src/components/documents/DocumentDetail.jsx","../../src/components/documents/FolderManager.jsx","../../src/components/documents/DocumentsTab.jsx"],"sourcesContent":["/**\n * Application Constants\n * Centralized configuration values to avoid hardcoding\n */\n\n// ============================================\n// PAGINATION\n// ============================================\nexport const PAGINATION = {\n  TICKETS_PER_PAGE: 25,\n  CORS_PER_PAGE: 25,\n  REPORTS_PER_PAGE: 20,\n  DEFAULT_PREVIEW_LIMIT: 5\n}\n\n// ============================================\n// TIME PRESETS\n// ============================================\nexport const TIME_PRESETS = {\n  FULL_DAY: {\n    timeStarted: '07:00',\n    timeEnded: '15:30',\n    hours: 8,\n    overtimeHours: 0\n  },\n  TEN_HOUR: {\n    timeStarted: '06:00',\n    timeEnded: '16:30',\n    hours: 8,\n    overtimeHours: 2\n  },\n  HALF_DAY: {\n    timeStarted: '07:00',\n    timeEnded: '11:30',\n    hours: 4,\n    overtimeHours: 0\n  }\n}\n\n// ============================================\n// RETRY CONFIGURATION\n// ============================================\nexport const RETRY_CONFIG = {\n  MAX_RETRIES: 3,\n  BASE_DELAY_MS: 1000,\n  MAX_DELAY_MS: 10000\n}\n\n// ============================================\n// CACHE CONFIGURATION\n// ============================================\nexport const CACHE_CONFIG = {\n  OFFLINE_DB_NAME: 'fieldsync-offline',\n  OFFLINE_DB_VERSION: 2,\n  SESSION_KEY: 'fieldsync_field_session',\n  DEVICE_ID_KEY: 'fieldsync_device_id',\n  SELECTED_COMPANY_KEY: 'selectedCompanyId'\n}\n\n// ============================================\n// STATUS CONFIGURATIONS\n// ============================================\nexport const COR_STATUS = {\n  DRAFT: 'draft',\n  PENDING_APPROVAL: 'pending_approval',\n  APPROVED: 'approved',\n  REJECTED: 'rejected',\n  BILLED: 'billed',\n  CLOSED: 'closed'\n}\n\nexport const COR_STATUS_DISPLAY = {\n  draft: { label: 'Draft', color: [107, 114, 128], bgColor: [243, 244, 246] },\n  pending_approval: { label: 'Pending Approval', color: [217, 119, 6], bgColor: [254, 243, 199] },\n  approved: { label: 'Approved', color: [5, 150, 105], bgColor: [209, 250, 229] },\n  rejected: { label: 'Rejected', color: [220, 38, 38], bgColor: [254, 226, 226] },\n  billed: { label: 'Billed', color: [37, 99, 235], bgColor: [219, 234, 254] },\n  closed: { label: 'Closed', color: [75, 85, 99], bgColor: [229, 231, 235] }\n}\n\nexport const TICKET_STATUS = {\n  PENDING: 'pending',\n  APPROVED: 'approved',\n  BILLED: 'billed',\n  REJECTED: 'rejected'\n}\n\n// ============================================\n// WORKER ROLES\n// ============================================\nexport const WORKER_ROLES = {\n  FOREMAN: 'Foreman',\n  SUPERINTENDENT: 'Superintendent',\n  OPERATOR: 'Operator',\n  LABORER: 'Laborer'\n}\n\nexport const DEFAULT_LABOR_RATES = {\n  Foreman: 85,\n  Superintendent: 95,\n  Operator: 75,\n  Laborer: 55\n}\n\n// ============================================\n// FILE UPLOAD LIMITS\n// ============================================\nexport const UPLOAD_LIMITS = {\n  MAX_IMAGE_SIZE_MB: 10,\n  MAX_IMAGE_SIZE_BYTES: 10 * 1024 * 1024,\n  MAX_IMAGES_PER_TICKET: 20,\n  IMAGE_COMPRESSION_QUALITY: 0.8,\n  IMAGE_MAX_WIDTH: 1920,\n  IMAGE_MAX_HEIGHT: 1080\n}\n\n// ============================================\n// PDF EXPORT CONFIGURATION\n// ============================================\nexport const PDF_CONFIG = {\n  IMAGE_LOAD_TIMEOUT_MS: 5000,\n  PAGE_MARGIN: 20,\n  HEADER_HEIGHT: 40,\n  FOOTER_HEIGHT: 20,\n  DEFAULT_FONT_SIZE: 10\n}\n\n// ============================================\n// VALIDATION LIMITS\n// ============================================\nexport const VALIDATION = {\n  MAX_AMOUNT: 10000000, // $10 million\n  MAX_TEXT_LENGTH: 10000,\n  MIN_PASSWORD_LENGTH: 8,\n  MAX_TITLE_LENGTH: 200,\n  MAX_DESCRIPTION_LENGTH: 5000\n}\n\n// ============================================\n// UI CONFIGURATION\n// ============================================\nexport const UI_CONFIG = {\n  TOAST_DURATION_MS: 5000,\n  DEBOUNCE_DELAY_MS: 300,\n  ANIMATION_DURATION_MS: 200,\n  RECENT_DAYS_FILTER: 7\n}\n\n// ============================================\n// DEFAULT COLORS\n// ============================================\nexport const COLORS = {\n  PRIMARY: '#3b82f6',\n  PRIMARY_RGB: [59, 130, 246],\n  SUCCESS: '#10b981',\n  WARNING: '#f59e0b',\n  DANGER: '#ef4444',\n  DARK_SLATE: [30, 41, 59]\n}\n\n// ============================================\n// DOCUMENT MANAGEMENT\n// ============================================\nexport const DOCUMENT_CATEGORIES = [\n  { id: 'plans', label: 'Plans & Drawings', icon: 'Map' },\n  { id: 'specs', label: 'Specifications', icon: 'FileText' },\n  { id: 'permits', label: 'Permits & Approvals', icon: 'Shield' },\n  { id: 'contracts', label: 'Contracts', icon: 'FileSignature' },\n  { id: 'submittals', label: 'Submittals', icon: 'Send' },\n  { id: 'rfis', label: 'RFIs', icon: 'HelpCircle' },\n  { id: 'photos', label: 'Site Photos', icon: 'Camera' },\n  { id: 'reports', label: 'Reports', icon: 'ClipboardList' },\n  { id: 'safety', label: 'Safety Documents', icon: 'AlertTriangle' },\n  { id: 'general', label: 'General', icon: 'Folder' }\n]\n\nexport const ALLOWED_FILE_TYPES = {\n  // Documents\n  'application/pdf': { ext: 'pdf', maxSize: 25 * 1024 * 1024, label: 'PDF' },\n  'application/msword': { ext: 'doc', maxSize: 15 * 1024 * 1024, label: 'Word' },\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document': { ext: 'docx', maxSize: 15 * 1024 * 1024, label: 'Word' },\n\n  // Spreadsheets\n  'application/vnd.ms-excel': { ext: 'xls', maxSize: 15 * 1024 * 1024, label: 'Excel' },\n  'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': { ext: 'xlsx', maxSize: 15 * 1024 * 1024, label: 'Excel' },\n\n  // Images\n  'image/jpeg': { ext: 'jpg', maxSize: 10 * 1024 * 1024, label: 'Image' },\n  'image/png': { ext: 'png', maxSize: 10 * 1024 * 1024, label: 'Image' }\n}\n\nexport const DOCUMENT_VISIBILITY = {\n  ALL: 'all',\n  OFFICE_ONLY: 'office_only',\n  ADMIN_ONLY: 'admin_only'\n}\n\nexport const DOCUMENT_VISIBILITY_LABELS = {\n  all: { label: 'Everyone', description: 'Visible to all team members including field users' },\n  office_only: { label: 'Office Only', description: 'Only visible to office staff and admins' },\n  admin_only: { label: 'Admins Only', description: 'Only visible to company administrators' }\n}\n\nexport const DOCUMENT_APPROVAL_STATUS = {\n  PENDING: 'pending',\n  APPROVED: 'approved',\n  REJECTED: 'rejected'\n}\n\n// Categories that require admin approval before becoming visible\nexport const APPROVAL_REQUIRED_CATEGORIES = ['contracts']\n\nexport const DOCUMENTS_PER_PAGE = 25\n\n// Storage limit per project (in bytes) - 250 MB\n// Keeps costs minimal during pre-revenue phase\n// Increase this once subscription billing is active\nexport const PROJECT_STORAGE_LIMIT_BYTES = 250 * 1024 * 1024 // 250 MB\n","import { useState, useRef, useCallback } from 'react'\nimport { X, Upload, CloudUpload, File, AlertCircle, Loader2, CheckCircle } from 'lucide-react'\nimport { db } from '../../lib/supabase'\nimport { DOCUMENT_CATEGORIES, ALLOWED_FILE_TYPES, DOCUMENT_VISIBILITY_LABELS, APPROVAL_REQUIRED_CATEGORIES } from '../../lib/constants'\n\n// Format file size\nconst formatFileSize = (bytes) => {\n  if (!bytes) return '0 B'\n  const units = ['B', 'KB', 'MB', 'GB']\n  let size = bytes\n  let unitIndex = 0\n  while (size >= 1024 && unitIndex < units.length - 1) {\n    size /= 1024\n    unitIndex++\n  }\n  return `${size.toFixed(size < 10 ? 1 : 0)} ${units[unitIndex]}`\n}\n\nexport default function DocumentUploadModal({ projectId, companyId, folderId, folderName, onClose, onUploadComplete, onShowToast }) {\n  const [file, setFile] = useState(null)\n  const [dragActive, setDragActive] = useState(false)\n  const [uploading, setUploading] = useState(false)\n  const [uploadProgress, setUploadProgress] = useState('')\n  const [error, setError] = useState(null)\n\n  // Form state\n  const [name, setName] = useState('')\n  const [description, setDescription] = useState('')\n  const [category, setCategory] = useState('general')\n  const [visibility, setVisibility] = useState('all')\n\n  const fileInputRef = useRef(null)\n\n  // Validate file\n  const validateFile = (file) => {\n    if (!file) return 'Please select a file'\n\n    const fileType = ALLOWED_FILE_TYPES[file.type]\n    if (!fileType) {\n      return `File type not supported. Allowed: PDF, Word, Excel, Images`\n    }\n\n    if (file.size > fileType.maxSize) {\n      return `File too large. Maximum size for ${fileType.label}: ${formatFileSize(fileType.maxSize)}`\n    }\n\n    return null\n  }\n\n  // Handle file selection\n  const handleFileSelect = useCallback((selectedFile) => {\n    const validationError = validateFile(selectedFile)\n    if (validationError) {\n      setError(validationError)\n      return\n    }\n\n    setError(null)\n    setFile(selectedFile)\n    // Auto-fill name from filename (without extension)\n    if (!name) {\n      const nameWithoutExt = selectedFile.name.replace(/\\.[^/.]+$/, '')\n      setName(nameWithoutExt)\n    }\n  }, [name])\n\n  // Handle drag events\n  const handleDrag = (e) => {\n    e.preventDefault()\n    e.stopPropagation()\n    if (e.type === 'dragenter' || e.type === 'dragover') {\n      setDragActive(true)\n    } else if (e.type === 'dragleave') {\n      setDragActive(false)\n    }\n  }\n\n  // Handle drop\n  const handleDrop = (e) => {\n    e.preventDefault()\n    e.stopPropagation()\n    setDragActive(false)\n\n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\n      handleFileSelect(e.dataTransfer.files[0])\n    }\n  }\n\n  // Handle input change\n  const handleInputChange = (e) => {\n    if (e.target.files && e.target.files[0]) {\n      handleFileSelect(e.target.files[0])\n    }\n  }\n\n  // Handle upload\n  const handleUpload = async () => {\n    if (!file) {\n      setError('Please select a file')\n      return\n    }\n\n    if (!name.trim()) {\n      setError('Please enter a document name')\n      return\n    }\n\n    setUploading(true)\n    setError(null)\n    setUploadProgress('Uploading document...')\n\n    try {\n      const document = await db.uploadDocument(companyId, projectId, file, {\n        name: name.trim(),\n        description: description.trim() || null,\n        category,\n        visibility,\n        folderId: folderId || null\n      })\n\n      setUploadProgress('Upload complete!')\n      onUploadComplete(document)\n    } catch (err) {\n      console.error('Upload error:', err)\n      setError(err.message || 'Failed to upload document')\n      setUploading(false)\n    }\n  }\n\n  // Check if category requires approval\n  const requiresApproval = APPROVAL_REQUIRED_CATEGORIES.includes(category)\n\n  return (\n    <div className=\"modal-overlay\" onClick={onClose}>\n      <div className=\"document-upload-modal\" onClick={e => e.stopPropagation()}>\n        {/* Header */}\n        <div className=\"modal-header\">\n          <div>\n            <h2>Upload Document</h2>\n            {folderName && (\n              <span className=\"modal-subtitle\">to {folderName}</span>\n            )}\n          </div>\n          <button className=\"modal-close\" onClick={onClose}>\n            <X size={20} />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"modal-content\">\n          {/* Dropzone */}\n          <div\n            className={`document-dropzone ${dragActive ? 'drag-active' : ''} ${file ? 'has-file' : ''}`}\n            onDragEnter={handleDrag}\n            onDragLeave={handleDrag}\n            onDragOver={handleDrag}\n            onDrop={handleDrop}\n            onClick={() => !file && fileInputRef.current?.click()}\n          >\n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              accept={Object.keys(ALLOWED_FILE_TYPES).join(',')}\n              onChange={handleInputChange}\n              style={{ display: 'none' }}\n            />\n\n            {file ? (\n              <div className=\"dropzone-file\">\n                <File size={32} />\n                <div className=\"dropzone-file-info\">\n                  <span className=\"dropzone-file-name\">{file.name}</span>\n                  <span className=\"dropzone-file-size\">{formatFileSize(file.size)}</span>\n                </div>\n                <button\n                  className=\"dropzone-file-remove\"\n                  onClick={(e) => {\n                    e.stopPropagation()\n                    setFile(null)\n                    setError(null)\n                  }}\n                >\n                  <X size={16} />\n                </button>\n              </div>\n            ) : (\n              <>\n                <CloudUpload size={48} />\n                <p className=\"dropzone-text\">\n                  Drag & drop files here<br />\n                  or click to browse\n                </p>\n                <p className=\"dropzone-hint\">\n                  PDF, Word, Excel, Images &bull; Max 25MB\n                </p>\n              </>\n            )}\n          </div>\n\n          {/* Error */}\n          {error && (\n            <div className=\"document-upload-error\">\n              <AlertCircle size={16} />\n              {error}\n            </div>\n          )}\n\n          {/* Form fields */}\n          <div className=\"document-upload-form\">\n            <div className=\"form-group\">\n              <label htmlFor=\"doc-name\">Document Name *</label>\n              <input\n                id=\"doc-name\"\n                type=\"text\"\n                value={name}\n                onChange={(e) => setName(e.target.value)}\n                placeholder=\"Enter document name\"\n                disabled={uploading}\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"doc-category\">Category</label>\n              <select\n                id=\"doc-category\"\n                value={category}\n                onChange={(e) => setCategory(e.target.value)}\n                disabled={uploading}\n              >\n                {DOCUMENT_CATEGORIES.map(cat => (\n                  <option key={cat.id} value={cat.id}>{cat.label}</option>\n                ))}\n              </select>\n              {requiresApproval && (\n                <p className=\"form-hint warning\">\n                  <AlertCircle size={14} />\n                  Documents in this category require admin approval before becoming visible.\n                </p>\n              )}\n            </div>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"doc-description\">Description</label>\n              <textarea\n                id=\"doc-description\"\n                value={description}\n                onChange={(e) => setDescription(e.target.value)}\n                placeholder=\"Optional description...\"\n                rows={3}\n                disabled={uploading}\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label>Visibility</label>\n              <div className=\"visibility-options\">\n                {Object.entries(DOCUMENT_VISIBILITY_LABELS).map(([key, { label, description }]) => (\n                  <label key={key} className={`visibility-option ${visibility === key ? 'selected' : ''}`}>\n                    <input\n                      type=\"radio\"\n                      name=\"visibility\"\n                      value={key}\n                      checked={visibility === key}\n                      onChange={(e) => setVisibility(e.target.value)}\n                      disabled={uploading}\n                    />\n                    <div className=\"visibility-content\">\n                      <span className=\"visibility-label\">{label}</span>\n                      <span className=\"visibility-desc\">{description}</span>\n                    </div>\n                  </label>\n                ))}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div className=\"modal-footer\">\n          {uploading ? (\n            <div className=\"upload-progress\">\n              <Loader2 size={20} className=\"spinner\" />\n              <span>{uploadProgress}</span>\n            </div>\n          ) : (\n            <>\n              <button className=\"btn btn-secondary\" onClick={onClose}>\n                Cancel\n              </button>\n              <button\n                className=\"btn btn-primary\"\n                onClick={handleUpload}\n                disabled={!file || !name.trim()}\n              >\n                <Upload size={18} />\n                Upload Document\n              </button>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n","import { useState, useEffect } from 'react'\nimport { ArrowLeft, Download, Upload, Edit2, Archive, CheckCircle, XCircle, Clock, FileText, User, Calendar, Folder, Eye, Link2, Loader2, AlertCircle } from 'lucide-react'\nimport { db } from '../../lib/supabase'\nimport { DOCUMENT_CATEGORIES, DOCUMENT_VISIBILITY_LABELS } from '../../lib/constants'\n\n// Format file size\nconst formatFileSize = (bytes) => {\n  if (!bytes) return '0 B'\n  const units = ['B', 'KB', 'MB', 'GB']\n  let size = bytes\n  let unitIndex = 0\n  while (size >= 1024 && unitIndex < units.length - 1) {\n    size /= 1024\n    unitIndex++\n  }\n  return `${size.toFixed(size < 10 ? 1 : 0)} ${units[unitIndex]}`\n}\n\n// Format date\nconst formatDate = (dateString) => {\n  if (!dateString) return ''\n  const date = new Date(dateString)\n  return date.toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric',\n    year: 'numeric',\n    hour: 'numeric',\n    minute: '2-digit'\n  })\n}\n\nexport default function DocumentDetail({ document: initialDocument, onBack, onUpdate, onShowToast, isOfficeOrAdmin }) {\n  const [document, setDocument] = useState(initialDocument)\n  const [versions, setVersions] = useState([])\n  const [loadingVersions, setLoadingVersions] = useState(true)\n  const [showRejectModal, setShowRejectModal] = useState(false)\n  const [rejectReason, setRejectReason] = useState('')\n  const [processing, setProcessing] = useState(false)\n\n  const category = DOCUMENT_CATEGORIES.find(c => c.id === document.category)\n  const visibilityInfo = DOCUMENT_VISIBILITY_LABELS[document.visibility]\n  const isPending = document.approval_status === 'pending'\n  const isRejected = document.approval_status === 'rejected'\n  const isAdmin = isOfficeOrAdmin // Simplified - in real app, check for admin specifically\n\n  // Load versions\n  useEffect(() => {\n    loadVersions()\n  }, [document.id])\n\n  const loadVersions = async () => {\n    setLoadingVersions(true)\n    try {\n      const versionList = await db.getDocumentVersions(document.id)\n      setVersions(versionList)\n    } catch (error) {\n      console.error('Error loading versions:', error)\n    } finally {\n      setLoadingVersions(false)\n    }\n  }\n\n  // Handle download\n  const handleDownload = async () => {\n    await db.logDocumentAccess(document.id, 'downloaded')\n    const url = `${import.meta.env.VITE_SUPABASE_URL}/storage/v1/object/public/project-documents/${document.storage_path}`\n    window.open(url, '_blank')\n  }\n\n  // Handle approve\n  const handleApprove = async () => {\n    setProcessing(true)\n    try {\n      await db.approveDocument(document.id)\n      setDocument(prev => ({ ...prev, approval_status: 'approved' }))\n      onShowToast?.('Document approved', 'success')\n      onUpdate?.()\n    } catch (error) {\n      console.error('Error approving document:', error)\n      onShowToast?.('Failed to approve document', 'error')\n    } finally {\n      setProcessing(false)\n    }\n  }\n\n  // Handle reject\n  const handleReject = async () => {\n    if (!rejectReason.trim()) {\n      onShowToast?.('Please provide a reason for rejection', 'error')\n      return\n    }\n\n    setProcessing(true)\n    try {\n      await db.rejectDocument(document.id, rejectReason.trim())\n      setDocument(prev => ({ ...prev, approval_status: 'rejected', rejection_reason: rejectReason.trim() }))\n      setShowRejectModal(false)\n      setRejectReason('')\n      onShowToast?.('Document rejected', 'success')\n      onUpdate?.()\n    } catch (error) {\n      console.error('Error rejecting document:', error)\n      onShowToast?.('Failed to reject document', 'error')\n    } finally {\n      setProcessing(false)\n    }\n  }\n\n  // Handle archive\n  const handleArchive = async () => {\n    if (!confirm('Are you sure you want to archive this document?')) return\n\n    setProcessing(true)\n    try {\n      await db.archiveDocument(document.id)\n      onShowToast?.('Document archived', 'success')\n      onBack()\n      onUpdate?.()\n    } catch (error) {\n      console.error('Error archiving document:', error)\n      onShowToast?.('Failed to archive document', 'error')\n    } finally {\n      setProcessing(false)\n    }\n  }\n\n  return (\n    <div className=\"document-detail\">\n      {/* Header */}\n      <div className=\"document-detail-header\">\n        <button className=\"back-btn\" onClick={onBack}>\n          <ArrowLeft size={20} />\n          Back\n        </button>\n\n        <div className=\"document-detail-actions\">\n          <button className=\"btn btn-secondary\" onClick={handleDownload}>\n            <Download size={18} />\n            Download\n          </button>\n          {isOfficeOrAdmin && (\n            <button className=\"btn btn-secondary btn-danger\" onClick={handleArchive} disabled={processing}>\n              <Archive size={18} />\n              Archive\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Document info */}\n      <div className=\"document-detail-content\">\n        <div className=\"document-detail-main\">\n          {/* Title and status */}\n          <div className=\"document-detail-title\">\n            <h2>{document.name}</h2>\n            {document.version > 1 && (\n              <span className=\"version-badge\">v{document.version}</span>\n            )}\n          </div>\n\n          {/* Status badges */}\n          {(isPending || isRejected) && (\n            <div className=\"document-detail-status\">\n              {isPending && (\n                <div className=\"status-banner pending\">\n                  <Clock size={18} />\n                  <span>Pending Approval</span>\n                  {isAdmin && (\n                    <div className=\"status-actions\">\n                      <button\n                        className=\"btn btn-sm btn-success\"\n                        onClick={handleApprove}\n                        disabled={processing}\n                      >\n                        <CheckCircle size={16} />\n                        Approve\n                      </button>\n                      <button\n                        className=\"btn btn-sm btn-danger\"\n                        onClick={() => setShowRejectModal(true)}\n                        disabled={processing}\n                      >\n                        <XCircle size={16} />\n                        Reject\n                      </button>\n                    </div>\n                  )}\n                </div>\n              )}\n              {isRejected && (\n                <div className=\"status-banner rejected\">\n                  <XCircle size={18} />\n                  <div className=\"rejected-info\">\n                    <span>Rejected</span>\n                    {document.rejection_reason && (\n                      <p className=\"rejection-reason\">{document.rejection_reason}</p>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Metadata */}\n          <div className=\"document-detail-meta\">\n            <div className=\"meta-item\">\n              <FileText size={16} />\n              <span>{document.file_name}</span>\n            </div>\n            <div className=\"meta-item\">\n              <Folder size={16} />\n              <span>{category?.label || document.category}</span>\n            </div>\n            <div className=\"meta-item\">\n              <span className=\"meta-size\">{formatFileSize(document.file_size_bytes)}</span>\n            </div>\n            <div className=\"meta-item\">\n              <Calendar size={16} />\n              <span>{formatDate(document.uploaded_at)}</span>\n            </div>\n            <div className=\"meta-item\">\n              <User size={16} />\n              <span>{document.uploaded_by_user?.email || 'Unknown'}</span>\n            </div>\n            <div className=\"meta-item\">\n              <Eye size={16} />\n              <span>{visibilityInfo?.label || document.visibility}</span>\n            </div>\n          </div>\n\n          {/* Description */}\n          {document.description && (\n            <div className=\"document-detail-description\">\n              <h3>Description</h3>\n              <p>{document.description}</p>\n            </div>\n          )}\n\n          {/* Linked resource */}\n          {document.resource_type && document.resource_id && (\n            <div className=\"document-detail-linked\">\n              <h3>\n                <Link2 size={16} />\n                Linked To\n              </h3>\n              <p>\n                {document.resource_type === 'cor' && 'Change Order Request'}\n                {document.resource_type === 'tm_ticket' && 'T&M Ticket'}\n                {document.resource_type === 'daily_report' && 'Daily Report'}\n              </p>\n            </div>\n          )}\n        </div>\n\n        {/* Version history */}\n        <div className=\"document-detail-sidebar\">\n          <h3>Version History</h3>\n          {loadingVersions ? (\n            <div className=\"versions-loading\">\n              <Loader2 size={20} className=\"spinner\" />\n              Loading versions...\n            </div>\n          ) : versions.length === 0 ? (\n            <p className=\"versions-empty\">No version history</p>\n          ) : (\n            <div className=\"versions-list\">\n              {versions.map(version => (\n                <div\n                  key={version.id}\n                  className={`version-item ${version.id === document.id ? 'current' : ''}`}\n                >\n                  <div className=\"version-info\">\n                    <span className=\"version-number\">\n                      v{version.version}\n                      {version.is_current && <span className=\"current-badge\">Current</span>}\n                    </span>\n                    <span className=\"version-date\">{formatDate(version.uploaded_at)}</span>\n                    <span className=\"version-user\">{version.uploaded_by_user?.email}</span>\n                  </div>\n                  <button\n                    className=\"version-download\"\n                    onClick={async () => {\n                      await db.logDocumentAccess(version.id, 'downloaded')\n                      window.open(`${import.meta.env.VITE_SUPABASE_URL}/storage/v1/object/public/project-documents/${version.storage_path}`, '_blank')\n                    }}\n                    title=\"Download this version\"\n                  >\n                    <Download size={16} />\n                  </button>\n                </div>\n              ))}\n            </div>\n          )}\n\n          {/* Upload new version */}\n          {isOfficeOrAdmin && (\n            <div className=\"upload-version\">\n              <p className=\"upload-version-hint\">\n                To upload a new version, use the main upload button and select \"Replace existing document\"\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Reject Modal */}\n      {showRejectModal && (\n        <div className=\"modal-overlay\" onClick={() => setShowRejectModal(false)}>\n          <div className=\"reject-modal\" onClick={e => e.stopPropagation()}>\n            <h3>Reject Document</h3>\n            <p>Please provide a reason for rejection:</p>\n            <textarea\n              value={rejectReason}\n              onChange={(e) => setRejectReason(e.target.value)}\n              placeholder=\"Enter reason...\"\n              rows={4}\n            />\n            <div className=\"modal-actions\">\n              <button className=\"btn btn-secondary\" onClick={() => setShowRejectModal(false)}>\n                Cancel\n              </button>\n              <button\n                className=\"btn btn-danger\"\n                onClick={handleReject}\n                disabled={!rejectReason.trim() || processing}\n              >\n                {processing ? <Loader2 size={16} className=\"spinner\" /> : <XCircle size={16} />}\n                Reject Document\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n","import { useState } from 'react'\nimport { X, Plus, Folder, FileText, Map, Shield, FileSignature, Camera, ClipboardList, AlertTriangle, HelpCircle, Send, Trash2, Edit2, GripVertical, Loader2 } from 'lucide-react'\nimport { db } from '../../lib/supabase'\n\n// Available icons for folders\nconst FOLDER_ICON_OPTIONS = [\n  { id: 'folder', label: 'Folder', icon: Folder },\n  { id: 'plans', label: 'Plans', icon: Map },\n  { id: 'specs', label: 'Specs', icon: FileText },\n  { id: 'permits', label: 'Permits', icon: Shield },\n  { id: 'contracts', label: 'Contracts', icon: FileSignature },\n  { id: 'submittals', label: 'Submittals', icon: Send },\n  { id: 'rfis', label: 'RFIs', icon: HelpCircle },\n  { id: 'photos', label: 'Photos', icon: Camera },\n  { id: 'reports', label: 'Reports', icon: ClipboardList },\n  { id: 'safety', label: 'Safety', icon: AlertTriangle }\n]\n\n// Available colors for folders\nconst FOLDER_COLOR_OPTIONS = [\n  { id: 'blue', label: 'Blue', hex: '#3b82f6' },\n  { id: 'green', label: 'Green', hex: '#10b981' },\n  { id: 'yellow', label: 'Yellow', hex: '#f59e0b' },\n  { id: 'red', label: 'Red', hex: '#ef4444' },\n  { id: 'purple', label: 'Purple', hex: '#8b5cf6' },\n  { id: 'pink', label: 'Pink', hex: '#ec4899' },\n  { id: 'orange', label: 'Orange', hex: '#f97316' },\n  { id: 'gray', label: 'Gray', hex: '#6b7280' }\n]\n\nexport default function FolderManager({\n  projectId,\n  companyId,\n  folders,\n  onFoldersChange,\n  onClose,\n  onShowToast\n}) {\n  const [showCreateModal, setShowCreateModal] = useState(false)\n  const [editingFolder, setEditingFolder] = useState(null)\n  const [deleting, setDeleting] = useState(null)\n  const [saving, setSaving] = useState(false)\n\n  // Form state\n  const [folderName, setFolderName] = useState('')\n  const [folderIcon, setFolderIcon] = useState('folder')\n  const [folderColor, setFolderColor] = useState('blue')\n  const [folderDescription, setFolderDescription] = useState('')\n\n  const resetForm = () => {\n    setFolderName('')\n    setFolderIcon('folder')\n    setFolderColor('blue')\n    setFolderDescription('')\n    setEditingFolder(null)\n  }\n\n  const openCreateModal = () => {\n    resetForm()\n    setShowCreateModal(true)\n  }\n\n  const openEditModal = (folder) => {\n    setFolderName(folder.name)\n    setFolderIcon(folder.icon || 'folder')\n    setFolderColor(folder.color || 'blue')\n    setFolderDescription(folder.description || '')\n    setEditingFolder(folder)\n    setShowCreateModal(true)\n  }\n\n  const handleSubmit = async (e) => {\n    e.preventDefault()\n    if (!folderName.trim()) {\n      onShowToast?.('Please enter a folder name', 'error')\n      return\n    }\n\n    setSaving(true)\n    try {\n      if (editingFolder) {\n        // Update existing folder\n        await db.updateFolder(editingFolder.id, {\n          name: folderName.trim(),\n          icon: folderIcon,\n          color: folderColor,\n          description: folderDescription.trim() || null\n        })\n        onShowToast?.('Folder updated', 'success')\n      } else {\n        // Create new folder\n        const maxOrder = Math.max(0, ...folders.map(f => f.sort_order || 0))\n        await db.createFolder(companyId, projectId, {\n          name: folderName.trim(),\n          icon: folderIcon,\n          color: folderColor,\n          description: folderDescription.trim() || null,\n          sort_order: maxOrder + 1\n        })\n        onShowToast?.('Folder created', 'success')\n      }\n      setShowCreateModal(false)\n      resetForm()\n      onFoldersChange?.()\n    } catch (error) {\n      console.error('Error saving folder:', error)\n      if (error.message?.includes('duplicate key') || error.code === '23505') {\n        onShowToast?.('A folder with this name already exists', 'error')\n      } else {\n        onShowToast?.('Failed to save folder', 'error')\n      }\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const handleDelete = async (folder) => {\n    if (!confirm(`Delete \"${folder.name}\"? Documents in this folder will be moved to Unfiled.`)) {\n      return\n    }\n\n    setDeleting(folder.id)\n    try {\n      await db.deleteFolder(folder.id)\n      onShowToast?.('Folder deleted', 'success')\n      onFoldersChange?.()\n    } catch (error) {\n      console.error('Error deleting folder:', error)\n      onShowToast?.('Failed to delete folder', 'error')\n    } finally {\n      setDeleting(null)\n    }\n  }\n\n  const selectedIconData = FOLDER_ICON_OPTIONS.find(i => i.id === folderIcon)\n  const selectedColorData = FOLDER_COLOR_OPTIONS.find(c => c.id === folderColor)\n\n  return (\n    <div className=\"folder-manager\">\n      {/* Header */}\n      <div className=\"folder-manager-header\">\n        <h3>Manage Folders</h3>\n        <button className=\"btn btn-primary btn-sm\" onClick={openCreateModal}>\n          <Plus size={16} />\n          New Folder\n        </button>\n      </div>\n\n      {/* Folder list */}\n      <div className=\"folder-manager-list\">\n        {folders.length === 0 ? (\n          <div className=\"folder-manager-empty\">\n            <Folder size={40} />\n            <p>No folders created yet</p>\n            <button className=\"btn btn-secondary\" onClick={openCreateModal}>\n              Create First Folder\n            </button>\n          </div>\n        ) : (\n          folders.map(folder => {\n            const IconComp = FOLDER_ICON_OPTIONS.find(i => i.id === folder.icon)?.icon || Folder\n            const colorHex = FOLDER_COLOR_OPTIONS.find(c => c.id === folder.color)?.hex || '#3b82f6'\n            return (\n              <div key={folder.id} className=\"folder-manager-item\">\n                <div className=\"folder-manager-item-drag\">\n                  <GripVertical size={16} />\n                </div>\n                <div\n                  className=\"folder-manager-item-icon\"\n                  style={{ backgroundColor: `${colorHex}15` }}\n                >\n                  <IconComp size={20} style={{ color: colorHex }} />\n                </div>\n                <div className=\"folder-manager-item-info\">\n                  <span className=\"folder-manager-item-name\">{folder.name}</span>\n                  <span className=\"folder-manager-item-count\">\n                    {folder.document_count || 0} documents\n                  </span>\n                </div>\n                <div className=\"folder-manager-item-actions\">\n                  <button\n                    className=\"folder-action-btn\"\n                    onClick={() => openEditModal(folder)}\n                    title=\"Edit folder\"\n                  >\n                    <Edit2 size={16} />\n                  </button>\n                  <button\n                    className=\"folder-action-btn danger\"\n                    onClick={() => handleDelete(folder)}\n                    disabled={deleting === folder.id}\n                    title=\"Delete folder\"\n                  >\n                    {deleting === folder.id ? (\n                      <Loader2 size={16} className=\"spinner\" />\n                    ) : (\n                      <Trash2 size={16} />\n                    )}\n                  </button>\n                </div>\n              </div>\n            )\n          })\n        )}\n      </div>\n\n      {/* Create/Edit Modal */}\n      {showCreateModal && (\n        <div className=\"modal-overlay\" onClick={() => setShowCreateModal(false)}>\n          <div className=\"folder-modal\" onClick={e => e.stopPropagation()}>\n            <div className=\"folder-modal-header\">\n              <h3>{editingFolder ? 'Edit Folder' : 'Create Folder'}</h3>\n              <button className=\"modal-close\" onClick={() => setShowCreateModal(false)}>\n                <X size={20} />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit}>\n              <div className=\"folder-modal-content\">\n                {/* Preview */}\n                <div className=\"folder-preview\">\n                  <div\n                    className=\"folder-preview-icon\"\n                    style={{ backgroundColor: `${selectedColorData?.hex}15` }}\n                  >\n                    {selectedIconData && (\n                      <selectedIconData.icon\n                        size={40}\n                        style={{ color: selectedColorData?.hex }}\n                      />\n                    )}\n                  </div>\n                  <span className=\"folder-preview-name\">\n                    {folderName || 'Folder Name'}\n                  </span>\n                </div>\n\n                {/* Name input */}\n                <div className=\"form-group\">\n                  <label htmlFor=\"folder-name\">Folder Name *</label>\n                  <input\n                    id=\"folder-name\"\n                    type=\"text\"\n                    value={folderName}\n                    onChange={(e) => setFolderName(e.target.value)}\n                    placeholder=\"e.g., Site Plans, Safety Documents\"\n                    autoFocus\n                  />\n                </div>\n\n                {/* Icon selection */}\n                <div className=\"form-group\">\n                  <label>Icon</label>\n                  <div className=\"folder-icon-grid\">\n                    {FOLDER_ICON_OPTIONS.map(opt => (\n                      <button\n                        key={opt.id}\n                        type=\"button\"\n                        className={`folder-icon-option ${folderIcon === opt.id ? 'selected' : ''}`}\n                        onClick={() => setFolderIcon(opt.id)}\n                        title={opt.label}\n                      >\n                        <opt.icon size={20} />\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Color selection */}\n                <div className=\"form-group\">\n                  <label>Color</label>\n                  <div className=\"folder-color-grid\">\n                    {FOLDER_COLOR_OPTIONS.map(opt => (\n                      <button\n                        key={opt.id}\n                        type=\"button\"\n                        className={`folder-color-option ${folderColor === opt.id ? 'selected' : ''}`}\n                        onClick={() => setFolderColor(opt.id)}\n                        style={{ backgroundColor: opt.hex }}\n                        title={opt.label}\n                      />\n                    ))}\n                  </div>\n                </div>\n\n                {/* Description */}\n                <div className=\"form-group\">\n                  <label htmlFor=\"folder-desc\">Description (optional)</label>\n                  <input\n                    id=\"folder-desc\"\n                    type=\"text\"\n                    value={folderDescription}\n                    onChange={(e) => setFolderDescription(e.target.value)}\n                    placeholder=\"Brief description of folder contents\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"folder-modal-footer\">\n                <button\n                  type=\"button\"\n                  className=\"btn btn-secondary\"\n                  onClick={() => setShowCreateModal(false)}\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"submit\"\n                  className=\"btn btn-primary\"\n                  disabled={!folderName.trim() || saving}\n                >\n                  {saving ? (\n                    <>\n                      <Loader2 size={16} className=\"spinner\" />\n                      Saving...\n                    </>\n                  ) : editingFolder ? (\n                    'Save Changes'\n                  ) : (\n                    'Create Folder'\n                  )}\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n","import { useState, useEffect, useCallback, useRef } from 'react'\nimport { Upload, Search, FolderOpen, Loader2, X, ArrowLeft, Folder, FileText, Download, File, Image, FileSpreadsheet, Plus, Eye, Archive, CheckCircle, Settings2 } from 'lucide-react'\nimport { db } from '../../lib/supabase'\nimport { DOCUMENTS_PER_PAGE } from '../../lib/constants'\nimport DocumentUploadModal from './DocumentUploadModal'\nimport DocumentDetail from './DocumentDetail'\nimport FolderGrid from './FolderGrid'\nimport FolderManager from './FolderManager'\n\n// Get file type icon\nconst getFileIcon = (mimeType) => {\n  if (mimeType?.startsWith('image/')) return Image\n  if (mimeType?.includes('spreadsheet') || mimeType?.includes('excel')) return FileSpreadsheet\n  if (mimeType?.includes('pdf')) return FileText\n  return File\n}\n\n// Format file size\nconst formatFileSize = (bytes) => {\n  if (!bytes) return '0 B'\n  const units = ['B', 'KB', 'MB', 'GB']\n  let size = bytes\n  let unitIndex = 0\n  while (size >= 1024 && unitIndex < units.length - 1) {\n    size /= 1024\n    unitIndex++\n  }\n  return `${size.toFixed(size < 10 ? 1 : 0)} ${units[unitIndex]}`\n}\n\n// Format date\nconst formatDate = (dateString) => {\n  if (!dateString) return ''\n  const date = new Date(dateString)\n  return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n}\n\n// Folder color mapping\nconst FOLDER_COLORS = {\n  blue: '#3b82f6',\n  green: '#10b981',\n  yellow: '#f59e0b',\n  red: '#ef4444',\n  purple: '#8b5cf6',\n  pink: '#ec4899',\n  gray: '#6b7280',\n  orange: '#f97316'\n}\n\nexport default function DocumentsTab({ project, companyId, onShowToast, userRole }) {\n  const [folders, setFolders] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [selectedFolder, setSelectedFolder] = useState(null)\n  const [documents, setDocuments] = useState([])\n  const [loadingDocs, setLoadingDocs] = useState(false)\n  const [hasMore, setHasMore] = useState(false)\n  const [page, setPage] = useState(0)\n  const [totalCount, setTotalCount] = useState(0)\n\n  // Search\n  const [searchQuery, setSearchQuery] = useState('')\n  const [searchResults, setSearchResults] = useState(null)\n  const [searching, setSearching] = useState(false)\n\n  // Modals\n  const [showUploadModal, setShowUploadModal] = useState(false)\n  const [showFolderManager, setShowFolderManager] = useState(false)\n  const [selectedDocument, setSelectedDocument] = useState(null)\n  const [uploadToFolder, setUploadToFolder] = useState(null)\n\n  const isOfficeOrAdmin = userRole === 'office' || userRole === 'administrator'\n  const isFieldUser = userRole === 'foreman'\n\n  // Track selected folder for real-time updates\n  const selectedFolderRef = useRef(null)\n\n  // Load folders\n  const loadFolders = useCallback(async () => {\n    setLoading(true)\n    try {\n      const folderList = await db.getProjectFolders(project.id)\n      setFolders(folderList)\n    } catch (error) {\n      console.error('Error loading folders:', error)\n      onShowToast?.('Failed to load folders', 'error')\n    } finally {\n      setLoading(false)\n    }\n  }, [project.id, onShowToast])\n\n  // Initial load and real-time subscriptions\n  useEffect(() => {\n    loadFolders()\n\n    // Subscribe to real-time document and folder changes\n    const folderSub = db.subscribeToDocumentFolders?.(project.id, () => {\n      loadFolders()\n    })\n    const docSub = db.subscribeToDocuments?.(project.id, () => {\n      // Refresh folder counts when documents change\n      loadFolders()\n      // If a folder is open, refresh its documents\n      if (selectedFolderRef.current) {\n        loadFolderDocuments(selectedFolderRef.current, true)\n      }\n    })\n\n    return () => {\n      folderSub?.unsubscribe?.()\n      docSub?.unsubscribe?.()\n    }\n  }, [loadFolders, project.id])\n\n  // Load documents in folder\n  const loadFolderDocuments = async (folder, reset = false) => {\n    if (reset) {\n      setPage(0)\n      setLoadingDocs(true)\n    }\n\n    try {\n      const currentPage = reset ? 0 : page\n      const result = await db.getFolderDocuments(folder.id, {\n        page: currentPage,\n        limit: DOCUMENTS_PER_PAGE\n      })\n\n      if (reset) {\n        setDocuments(result.documents)\n      } else {\n        setDocuments(prev => [...prev, ...result.documents])\n      }\n      setTotalCount(result.totalCount)\n      setHasMore(result.hasMore)\n    } catch (error) {\n      console.error('Error loading documents:', error)\n      onShowToast?.('Failed to load documents', 'error')\n    } finally {\n      setLoadingDocs(false)\n    }\n  }\n\n  // Open folder\n  const openFolder = (folder) => {\n    setSelectedFolder(folder)\n    selectedFolderRef.current = folder\n    setSearchQuery('')\n    setSearchResults(null)\n    loadFolderDocuments(folder, true)\n  }\n\n  // Go back to folder list\n  const goBack = () => {\n    setSelectedFolder(null)\n    selectedFolderRef.current = null\n    setDocuments([])\n    setSearchResults(null)\n    setSearchQuery('')\n  }\n\n  // Search documents\n  const performSearch = useCallback(async (query) => {\n    if (!query.trim()) {\n      setSearchResults(null)\n      return\n    }\n\n    setSearching(true)\n    try {\n      const results = await db.searchDocuments(project.id, query.trim())\n      setSearchResults(results)\n    } catch (error) {\n      console.error('Error searching documents:', error)\n    } finally {\n      setSearching(false)\n    }\n  }, [project.id])\n\n  // Debounced search\n  const searchTimeoutRef = useRef(null)\n  const handleSearch = useCallback((query) => {\n    setSearchQuery(query)\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current)\n    }\n    searchTimeoutRef.current = setTimeout(() => {\n      performSearch(query)\n    }, 300)\n  }, [performSearch])\n\n  useEffect(() => {\n    return () => {\n      if (searchTimeoutRef.current) {\n        clearTimeout(searchTimeoutRef.current)\n      }\n    }\n  }, [])\n\n  // Handle upload complete\n  const handleUploadComplete = () => {\n    setShowUploadModal(false)\n    setUploadToFolder(null)\n    loadFolders()\n    if (selectedFolder) {\n      loadFolderDocuments(selectedFolder, true)\n    }\n    onShowToast?.('Document uploaded successfully', 'success')\n  }\n\n  // Handle document action\n  const handleDocumentAction = async (action, document) => {\n    try {\n      switch (action) {\n        case 'view':\n          setSelectedDocument(document)\n          break\n        case 'download':\n          await db.logDocumentAccess(document.id, 'downloaded')\n          window.open(document.url || `${import.meta.env.VITE_SUPABASE_URL}/storage/v1/object/public/project-documents/${document.storage_path}`, '_blank')\n          break\n        case 'archive':\n          await db.archiveDocument(document.id)\n          if (selectedFolder) {\n            loadFolderDocuments(selectedFolder, true)\n          }\n          loadFolders()\n          onShowToast?.('Document archived', 'success')\n          break\n        case 'approve':\n          await db.approveDocument(document.id)\n          if (selectedFolder) {\n            loadFolderDocuments(selectedFolder, true)\n          }\n          onShowToast?.('Document approved', 'success')\n          break\n        default:\n          break\n      }\n    } catch (error) {\n      console.error('Error performing action:', error)\n      onShowToast?.('Action failed', 'error')\n    }\n  }\n\n  // Start upload to specific folder\n  const startUploadToFolder = (folder) => {\n    setUploadToFolder(folder)\n    setShowUploadModal(true)\n  }\n\n  // Field user view - clean folder grid\n  if (isFieldUser) {\n    return (\n      <FolderGrid\n        projectId={project.id}\n        onShowToast={onShowToast}\n      />\n    )\n  }\n\n  // Document detail view\n  if (selectedDocument) {\n    return (\n      <DocumentDetail\n        document={selectedDocument}\n        onBack={() => setSelectedDocument(null)}\n        onUpdate={() => {\n          if (selectedFolder) {\n            loadFolderDocuments(selectedFolder, true)\n          }\n          loadFolders()\n        }}\n        onShowToast={onShowToast}\n        isOfficeOrAdmin={isOfficeOrAdmin}\n      />\n    )\n  }\n\n  // Loading state\n  if (loading) {\n    return (\n      <div className=\"docs-container\">\n        <div className=\"docs-loading\">\n          <Loader2 size={24} className=\"spinner\" />\n          <span>Loading documents...</span>\n        </div>\n      </div>\n    )\n  }\n\n  // Inside folder view\n  if (selectedFolder) {\n    const folderColor = FOLDER_COLORS[selectedFolder.color] || FOLDER_COLORS.blue\n    const displayDocs = searchResults !== null ? searchResults : documents\n\n    return (\n      <div className=\"docs-container\">\n        {/* Folder Header */}\n        <div className=\"docs-folder-header\">\n          <button className=\"docs-back-btn\" onClick={goBack}>\n            <ArrowLeft size={18} />\n            <span>Back</span>\n          </button>\n\n          <div className=\"docs-folder-info\">\n            <div className=\"docs-folder-icon\" style={{ backgroundColor: `${folderColor}15` }}>\n              <Folder size={20} style={{ color: folderColor }} />\n            </div>\n            <div>\n              <h2 className=\"docs-folder-name\">{selectedFolder.name}</h2>\n              <span className=\"docs-folder-count\">{totalCount} files</span>\n            </div>\n          </div>\n\n          <button className=\"docs-upload-btn\" onClick={() => startUploadToFolder(selectedFolder)}>\n            <Upload size={18} />\n            <span>Upload</span>\n          </button>\n        </div>\n\n        {/* Search Bar */}\n        <div className=\"docs-search-wrapper\">\n          <div className=\"docs-search\">\n            <Search size={16} />\n            <input\n              type=\"text\"\n              placeholder=\"Search in folder...\"\n              value={searchQuery}\n              onChange={(e) => handleSearch(e.target.value)}\n            />\n            {searchQuery && (\n              <button onClick={() => { setSearchQuery(''); setSearchResults(null) }}>\n                <X size={16} />\n              </button>\n            )}\n            {searching && <Loader2 size={16} className=\"spinner\" />}\n          </div>\n        </div>\n\n        {/* Search Results Info */}\n        {searchResults !== null && (\n          <div className=\"docs-search-info\">\n            <span>{searchResults.length} result{searchResults.length !== 1 ? 's' : ''} for \"{searchQuery}\"</span>\n            <button onClick={() => { setSearchQuery(''); setSearchResults(null) }}>Clear</button>\n          </div>\n        )}\n\n        {/* Document List */}\n        <div className=\"docs-list\">\n          {loadingDocs ? (\n            <div className=\"docs-loading\">\n              <Loader2 size={24} className=\"spinner\" />\n              <span>Loading...</span>\n            </div>\n          ) : displayDocs.length === 0 ? (\n            <div className=\"docs-empty\">\n              <Folder size={48} style={{ color: folderColor, opacity: 0.3 }} />\n              <h3>{searchResults !== null ? 'No results' : 'Empty folder'}</h3>\n              <p>{searchResults !== null ? 'Try a different search term.' : 'Upload your first document.'}</p>\n              {searchResults === null && (\n                <button className=\"docs-empty-btn\" onClick={() => startUploadToFolder(selectedFolder)}>\n                  <Upload size={16} />\n                  Upload Document\n                </button>\n              )}\n            </div>\n          ) : (\n            <>\n              {displayDocs.map(doc => {\n                const FileIcon = getFileIcon(doc.mime_type)\n                const isPending = doc.approval_status === 'pending'\n                return (\n                  <div key={doc.id} className={`docs-item ${isPending ? 'pending' : ''}`}>\n                    <div className=\"docs-item-icon\">\n                      <FileIcon size={20} />\n                    </div>\n                    <div className=\"docs-item-info\">\n                      <span className=\"docs-item-name\">\n                        {doc.name}\n                        {doc.version > 1 && <span className=\"docs-item-version\">v{doc.version}</span>}\n                      </span>\n                      <span className=\"docs-item-meta\">\n                        {formatFileSize(doc.file_size_bytes)}  {formatDate(doc.uploaded_at)}\n                      </span>\n                    </div>\n                    {isPending && <span className=\"docs-badge pending\">Pending</span>}\n                    <div className=\"docs-item-actions\">\n                      <button onClick={() => handleDocumentAction('view', doc)} title=\"View\">\n                        <Eye size={16} />\n                      </button>\n                      <button onClick={() => handleDocumentAction('download', doc)} title=\"Download\">\n                        <Download size={16} />\n                      </button>\n                      {isPending && (\n                        <button className=\"approve\" onClick={() => handleDocumentAction('approve', doc)} title=\"Approve\">\n                          <CheckCircle size={16} />\n                        </button>\n                      )}\n                      <button className=\"danger\" onClick={() => handleDocumentAction('archive', doc)} title=\"Archive\">\n                        <Archive size={16} />\n                      </button>\n                    </div>\n                  </div>\n                )\n              })}\n\n              {/* Load More */}\n              {hasMore && searchResults === null && (\n                <button\n                  className=\"docs-load-more\"\n                  onClick={() => {\n                    setPage(prev => prev + 1)\n                    loadFolderDocuments(selectedFolder, false)\n                  }}\n                  disabled={loadingDocs}\n                >\n                  Load More ({documents.length} of {totalCount})\n                </button>\n              )}\n            </>\n          )}\n        </div>\n\n        {/* Upload Modal */}\n        {showUploadModal && (\n          <DocumentUploadModal\n            projectId={project.id}\n            companyId={companyId}\n            folderId={uploadToFolder?.id}\n            folderName={uploadToFolder?.name}\n            onClose={() => { setShowUploadModal(false); setUploadToFolder(null) }}\n            onUploadComplete={handleUploadComplete}\n            onShowToast={onShowToast}\n          />\n        )}\n      </div>\n    )\n  }\n\n  // Main folder list view\n  return (\n    <div className=\"docs-container\">\n      {/* Header */}\n      <div className=\"docs-header\">\n        <div className=\"docs-search\">\n          <Search size={16} />\n          <input\n            type=\"text\"\n            placeholder=\"Search documents...\"\n            value={searchQuery}\n            onChange={(e) => handleSearch(e.target.value)}\n          />\n          {searchQuery && (\n            <button onClick={() => { setSearchQuery(''); setSearchResults(null) }}>\n              <X size={16} />\n            </button>\n          )}\n          {searching && <Loader2 size={16} className=\"spinner\" />}\n        </div>\n\n        <button className=\"docs-manage-btn\" onClick={() => setShowFolderManager(true)}>\n          <Settings2 size={18} />\n          <span>Manage</span>\n        </button>\n      </div>\n\n      {/* Search Results */}\n      {searchResults !== null ? (\n        <>\n          <div className=\"docs-search-info\">\n            <span>{searchResults.length} result{searchResults.length !== 1 ? 's' : ''}</span>\n            <button onClick={() => { setSearchQuery(''); setSearchResults(null) }}>Clear</button>\n          </div>\n          <div className=\"docs-list\">\n            {searchResults.map(doc => {\n              const FileIcon = getFileIcon(doc.mime_type)\n              return (\n                <div key={doc.id} className=\"docs-item\">\n                  <div className=\"docs-item-icon\">\n                    <FileIcon size={20} />\n                  </div>\n                  <div className=\"docs-item-info\">\n                    <span className=\"docs-item-name\">{doc.name}</span>\n                    <span className=\"docs-item-meta\">\n                      {formatFileSize(doc.file_size_bytes)}  {formatDate(doc.uploaded_at)}\n                    </span>\n                  </div>\n                  <div className=\"docs-item-actions\">\n                    <button onClick={() => handleDocumentAction('view', doc)}>\n                      <Eye size={16} />\n                    </button>\n                    <button onClick={() => handleDocumentAction('download', doc)}>\n                      <Download size={16} />\n                    </button>\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n        </>\n      ) : (\n        /* Folder Grid */\n        <div className=\"docs-grid\">\n          {folders.length === 0 ? (\n            <div className=\"docs-empty-state\">\n              <FolderOpen size={56} />\n              <h3>No folders yet</h3>\n              <p>Create folders to organize your documents</p>\n              <button onClick={() => setShowFolderManager(true)}>\n                <Plus size={18} />\n                Create Folder\n              </button>\n            </div>\n          ) : (\n            folders.map(folder => {\n              const color = FOLDER_COLORS[folder.color] || FOLDER_COLORS.blue\n              return (\n                <div key={folder.id} className=\"docs-folder-card\" onClick={() => openFolder(folder)}>\n                  <div className=\"docs-folder-card-icon\" style={{ backgroundColor: `${color}12` }}>\n                    <Folder size={28} style={{ color }} />\n                  </div>\n                  <div className=\"docs-folder-card-content\">\n                    <span className=\"docs-folder-card-name\">{folder.name}</span>\n                    <span className=\"docs-folder-card-count\">\n                      {folder.document_count || 0} {folder.document_count === 1 ? 'file' : 'files'}\n                    </span>\n                  </div>\n                  <button\n                    className=\"docs-folder-card-upload\"\n                    onClick={(e) => { e.stopPropagation(); startUploadToFolder(folder) }}\n                    title=\"Upload\"\n                  >\n                    <Plus size={18} />\n                  </button>\n                </div>\n              )\n            })\n          )}\n        </div>\n      )}\n\n      {/* Folder Manager Modal */}\n      {showFolderManager && (\n        <div className=\"modal-overlay\" onClick={() => setShowFolderManager(false)}>\n          <div className=\"docs-manager-modal\" onClick={e => e.stopPropagation()}>\n            <div className=\"docs-manager-header\">\n              <h2>Manage Folders</h2>\n              <button onClick={() => setShowFolderManager(false)}>\n                <X size={20} />\n              </button>\n            </div>\n            <FolderManager\n              projectId={project.id}\n              companyId={companyId}\n              folders={folders}\n              onFoldersChange={loadFolders}\n              onClose={() => setShowFolderManager(false)}\n              onShowToast={onShowToast}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Upload Modal */}\n      {showUploadModal && (\n        <DocumentUploadModal\n          projectId={project.id}\n          companyId={companyId}\n          folderId={uploadToFolder?.id}\n          folderName={uploadToFolder?.name}\n          onClose={() => { setShowUploadModal(false); setUploadToFolder(null) }}\n          onUploadComplete={handleUploadComplete}\n          onShowToast={onShowToast}\n        />\n      )}\n    </div>\n  )\n}\n"],"names":["DOCUMENT_CATEGORIES","ALLOWED_FILE_TYPES","DOCUMENT_VISIBILITY_LABELS","APPROVAL_REQUIRED_CATEGORIES","DOCUMENTS_PER_PAGE","formatFileSize","bytes","units","size","unitIndex","DocumentUploadModal","projectId","companyId","folderId","folderName","onClose","onUploadComplete","onShowToast","file","setFile","useState","dragActive","setDragActive","uploading","setUploading","uploadProgress","setUploadProgress","error","setError","name","setName","description","setDescription","category","setCategory","visibility","setVisibility","fileInputRef","useRef","validateFile","fileType","handleFileSelect","useCallback","selectedFile","validationError","nameWithoutExt","handleDrag","e","handleDrop","handleInputChange","handleUpload","document","db","err","requiresApproval","jsx","jsxs","X","File","Fragment","CloudUpload","AlertCircle","cat","key","label","Loader2","Upload","formatDate","dateString","DocumentDetail","initialDocument","onBack","onUpdate","isOfficeOrAdmin","setDocument","versions","setVersions","loadingVersions","setLoadingVersions","showRejectModal","setShowRejectModal","rejectReason","setRejectReason","processing","setProcessing","c","visibilityInfo","isPending","isRejected","isAdmin","useEffect","loadVersions","versionList","handleDownload","url","handleApprove","prev","handleReject","handleArchive","ArrowLeft","Download","Archive","Clock","CheckCircle","XCircle","FileText","Folder","Calendar","User","Eye","Link2","version","FOLDER_ICON_OPTIONS","Map","Shield","FileSignature","Send","HelpCircle","Camera","ClipboardList","AlertTriangle","FOLDER_COLOR_OPTIONS","FolderManager","folders","onFoldersChange","showCreateModal","setShowCreateModal","editingFolder","setEditingFolder","deleting","setDeleting","saving","setSaving","setFolderName","folderIcon","setFolderIcon","folderColor","setFolderColor","folderDescription","setFolderDescription","resetForm","openCreateModal","openEditModal","folder","handleSubmit","maxOrder","f","handleDelete","selectedIconData","i","selectedColorData","Plus","IconComp","colorHex","GripVertical","Edit2","Trash2","opt","getFileIcon","mimeType","Image","FileSpreadsheet","FOLDER_COLORS","DocumentsTab","project","userRole","setFolders","loading","setLoading","selectedFolder","setSelectedFolder","documents","setDocuments","loadingDocs","setLoadingDocs","hasMore","setHasMore","page","setPage","totalCount","setTotalCount","searchQuery","setSearchQuery","searchResults","setSearchResults","searching","setSearching","showUploadModal","setShowUploadModal","showFolderManager","setShowFolderManager","selectedDocument","setSelectedDocument","uploadToFolder","setUploadToFolder","isFieldUser","selectedFolderRef","loadFolders","folderList","folderSub","docSub","loadFolderDocuments","reset","currentPage","result","openFolder","goBack","performSearch","query","results","searchTimeoutRef","handleSearch","handleUploadComplete","handleDocumentAction","action","startUploadToFolder","FolderGrid","displayDocs","Search","doc","FileIcon","Settings2","FolderOpen","color"],"mappings":"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"}