function jE(t,e){for(var r=0;r<e.length;r++){const a=e[r];if(typeof a!="string"&&!Array.isArray(a)){for(const n in a)if(n!=="default"&&!(n in t)){const s=Object.getOwnPropertyDescriptor(a,n);s&&Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:()=>a[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();var l$=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function EE(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function a(){var n=!1;try{n=this instanceof a}catch{}return n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(a){var n=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(r,a,n.get?n:{enumerable:!0,get:function(){return t[a]}})}),r}var Bg={exports:{}},Zh={};var ub;function AE(){if(ub)return Zh;ub=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(a,n,s){var l=null;if(s!==void 0&&(l=""+s),n.key!==void 0&&(l=""+n.key),"key"in n){s={};for(var c in n)c!=="key"&&(s[c]=n[c])}else s=n;return n=s.ref,{$$typeof:t,type:a,key:l,ref:n!==void 0?n:null,props:s}}return Zh.Fragment=e,Zh.jsx=r,Zh.jsxs=r,Zh}var fb;function CE(){return fb||(fb=1,Bg.exports=AE()),Bg.exports}var o=CE(),Ug={exports:{}},Ar={};var db;function TE(){if(db)return Ar;db=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),x=Symbol.iterator;function g(U){return U===null||typeof U!="object"?null:(U=x&&U[x]||U["@@iterator"],typeof U=="function"?U:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,w={};function A(U,k,F){this.props=U,this.context=k,this.refs=w,this.updater=F||b}A.prototype.isReactComponent={},A.prototype.setState=function(U,k){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,k,"setState")},A.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function C(){}C.prototype=A.prototype;function E(U,k,F){this.props=U,this.context=k,this.refs=w,this.updater=F||b}var R=E.prototype=new C;R.constructor=E,_(R,A.prototype),R.isPureReactComponent=!0;var Y=Array.isArray;function W(){}var B={H:null,A:null,T:null,S:null},q=Object.prototype.hasOwnProperty;function L(U,k,F){var I=F.ref;return{$$typeof:t,type:U,key:k,ref:I!==void 0?I:null,props:F}}function J(U,k){return L(U.type,k,U.props)}function D(U){return typeof U=="object"&&U!==null&&U.$$typeof===t}function T(U){var k={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(F){return k[F]})}var M=/\/+/g;function V(U,k){return typeof U=="object"&&U!==null&&U.key!=null?T(""+U.key):k.toString(36)}function ie(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(W,W):(U.status="pending",U.then(function(k){U.status==="pending"&&(U.status="fulfilled",U.value=k)},function(k){U.status==="pending"&&(U.status="rejected",U.reason=k)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function X(U,k,F,I,z){var te=typeof U;(te==="undefined"||te==="boolean")&&(U=null);var se=!1;if(U===null)se=!0;else switch(te){case"bigint":case"string":case"number":se=!0;break;case"object":switch(U.$$typeof){case t:case e:se=!0;break;case m:return se=U._init,X(se(U._payload),k,F,I,z)}}if(se)return z=z(U),se=I===""?"."+V(U,0):I,Y(z)?(F="",se!=null&&(F=se.replace(M,"$&/")+"/"),X(z,k,F,"",function(_e){return _e})):z!=null&&(D(z)&&(z=J(z,F+(z.key==null||U&&U.key===z.key?"":(""+z.key).replace(M,"$&/")+"/")+se)),k.push(z)),1;se=0;var pe=I===""?".":I+":";if(Y(U))for(var ve=0;ve<U.length;ve++)I=U[ve],te=pe+V(I,ve),se+=X(I,k,F,te,z);else if(ve=g(U),typeof ve=="function")for(U=ve.call(U),ve=0;!(I=U.next()).done;)I=I.value,te=pe+V(I,ve++),se+=X(I,k,F,te,z);else if(te==="object"){if(typeof U.then=="function")return X(ie(U),k,F,I,z);throw k=String(U),Error("Objects are not valid as a React child (found: "+(k==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":k)+"). If you meant to render a collection of children, use an array instead.")}return se}function Z(U,k,F){if(U==null)return U;var I=[],z=0;return X(U,I,"","",function(te){return k.call(F,te,z++)}),I}function K(U){if(U._status===-1){var k=U._result;k=k(),k.then(function(F){(U._status===0||U._status===-1)&&(U._status=1,U._result=F)},function(F){(U._status===0||U._status===-1)&&(U._status=2,U._result=F)}),U._status===-1&&(U._status=0,U._result=k)}if(U._status===1)return U._result.default;throw U._result}var re=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var k=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(k))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},de={map:Z,forEach:function(U,k,F){Z(U,function(){k.apply(this,arguments)},F)},count:function(U){var k=0;return Z(U,function(){k++}),k},toArray:function(U){return Z(U,function(k){return k})||[]},only:function(U){if(!D(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return Ar.Activity=v,Ar.Children=de,Ar.Component=A,Ar.Fragment=r,Ar.Profiler=n,Ar.PureComponent=E,Ar.StrictMode=a,Ar.Suspense=f,Ar.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,Ar.__COMPILER_RUNTIME={__proto__:null,c:function(U){return B.H.useMemoCache(U)}},Ar.cache=function(U){return function(){return U.apply(null,arguments)}},Ar.cacheSignal=function(){return null},Ar.cloneElement=function(U,k,F){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var I=_({},U.props),z=U.key;if(k!=null)for(te in k.key!==void 0&&(z=""+k.key),k)!q.call(k,te)||te==="key"||te==="__self"||te==="__source"||te==="ref"&&k.ref===void 0||(I[te]=k[te]);var te=arguments.length-2;if(te===1)I.children=F;else if(1<te){for(var se=Array(te),pe=0;pe<te;pe++)se[pe]=arguments[pe+2];I.children=se}return L(U.type,z,I)},Ar.createContext=function(U){return U={$$typeof:l,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:s,_context:U},U},Ar.createElement=function(U,k,F){var I,z={},te=null;if(k!=null)for(I in k.key!==void 0&&(te=""+k.key),k)q.call(k,I)&&I!=="key"&&I!=="__self"&&I!=="__source"&&(z[I]=k[I]);var se=arguments.length-2;if(se===1)z.children=F;else if(1<se){for(var pe=Array(se),ve=0;ve<se;ve++)pe[ve]=arguments[ve+2];z.children=pe}if(U&&U.defaultProps)for(I in se=U.defaultProps,se)z[I]===void 0&&(z[I]=se[I]);return L(U,te,z)},Ar.createRef=function(){return{current:null}},Ar.forwardRef=function(U){return{$$typeof:c,render:U}},Ar.isValidElement=D,Ar.lazy=function(U){return{$$typeof:m,_payload:{_status:-1,_result:U},_init:K}},Ar.memo=function(U,k){return{$$typeof:d,type:U,compare:k===void 0?null:k}},Ar.startTransition=function(U){var k=B.T,F={};B.T=F;try{var I=U(),z=B.S;z!==null&&z(F,I),typeof I=="object"&&I!==null&&typeof I.then=="function"&&I.then(W,re)}catch(te){re(te)}finally{k!==null&&F.types!==null&&(k.types=F.types),B.T=k}},Ar.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},Ar.use=function(U){return B.H.use(U)},Ar.useActionState=function(U,k,F){return B.H.useActionState(U,k,F)},Ar.useCallback=function(U,k){return B.H.useCallback(U,k)},Ar.useContext=function(U){return B.H.useContext(U)},Ar.useDebugValue=function(){},Ar.useDeferredValue=function(U,k){return B.H.useDeferredValue(U,k)},Ar.useEffect=function(U,k){return B.H.useEffect(U,k)},Ar.useEffectEvent=function(U){return B.H.useEffectEvent(U)},Ar.useId=function(){return B.H.useId()},Ar.useImperativeHandle=function(U,k,F){return B.H.useImperativeHandle(U,k,F)},Ar.useInsertionEffect=function(U,k){return B.H.useInsertionEffect(U,k)},Ar.useLayoutEffect=function(U,k){return B.H.useLayoutEffect(U,k)},Ar.useMemo=function(U,k){return B.H.useMemo(U,k)},Ar.useOptimistic=function(U,k){return B.H.useOptimistic(U,k)},Ar.useReducer=function(U,k,F){return B.H.useReducer(U,k,F)},Ar.useRef=function(U){return B.H.useRef(U)},Ar.useState=function(U){return B.H.useState(U)},Ar.useSyncExternalStore=function(U,k,F){return B.H.useSyncExternalStore(U,k,F)},Ar.useTransition=function(){return B.H.useTransition()},Ar.version="19.2.0",Ar}var hb;function zx(){return hb||(hb=1,Ug.exports=TE()),Ug.exports}var ne=zx();const OE=qx(ne);var qg={exports:{}},Qh={},zg={exports:{}},Hg={};var mb;function RE(){return mb||(mb=1,(function(t){function e(X,Z){var K=X.length;X.push(Z);e:for(;0<K;){var re=K-1>>>1,de=X[re];if(0<n(de,Z))X[re]=Z,X[K]=de,K=re;else break e}}function r(X){return X.length===0?null:X[0]}function a(X){if(X.length===0)return null;var Z=X[0],K=X.pop();if(K!==Z){X[0]=K;e:for(var re=0,de=X.length,U=de>>>1;re<U;){var k=2*(re+1)-1,F=X[k],I=k+1,z=X[I];if(0>n(F,K))I<de&&0>n(z,F)?(X[re]=z,X[I]=K,re=I):(X[re]=F,X[k]=K,re=k);else if(I<de&&0>n(z,K))X[re]=z,X[I]=K,re=I;else break e}}return Z}function n(X,Z){var K=X.sortIndex-Z.sortIndex;return K!==0?K:X.id-Z.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var f=[],d=[],m=1,v=null,x=3,g=!1,b=!1,_=!1,w=!1,A=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function R(X){for(var Z=r(d);Z!==null;){if(Z.callback===null)a(d);else if(Z.startTime<=X)a(d),Z.sortIndex=Z.expirationTime,e(f,Z);else break;Z=r(d)}}function Y(X){if(_=!1,R(X),!b)if(r(f)!==null)b=!0,W||(W=!0,T());else{var Z=r(d);Z!==null&&ie(Y,Z.startTime-X)}}var W=!1,B=-1,q=5,L=-1;function J(){return w?!0:!(t.unstable_now()-L<q)}function D(){if(w=!1,W){var X=t.unstable_now();L=X;var Z=!0;try{e:{b=!1,_&&(_=!1,C(B),B=-1),g=!0;var K=x;try{t:{for(R(X),v=r(f);v!==null&&!(v.expirationTime>X&&J());){var re=v.callback;if(typeof re=="function"){v.callback=null,x=v.priorityLevel;var de=re(v.expirationTime<=X);if(X=t.unstable_now(),typeof de=="function"){v.callback=de,R(X),Z=!0;break t}v===r(f)&&a(f),R(X)}else a(f);v=r(f)}if(v!==null)Z=!0;else{var U=r(d);U!==null&&ie(Y,U.startTime-X),Z=!1}}break e}finally{v=null,x=K,g=!1}Z=void 0}}finally{Z?T():W=!1}}}var T;if(typeof E=="function")T=function(){E(D)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,V=M.port2;M.port1.onmessage=D,T=function(){V.postMessage(null)}}else T=function(){A(D,0)};function ie(X,Z){B=A(function(){X(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(X){switch(x){case 1:case 2:case 3:var Z=3;break;default:Z=x}var K=x;x=Z;try{return X()}finally{x=K}},t.unstable_requestPaint=function(){w=!0},t.unstable_runWithPriority=function(X,Z){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var K=x;x=X;try{return Z()}finally{x=K}},t.unstable_scheduleCallback=function(X,Z,K){var re=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?re+K:re):K=re,X){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=K+de,X={id:m++,callback:Z,priorityLevel:X,startTime:K,expirationTime:de,sortIndex:-1},K>re?(X.sortIndex=K,e(d,X),r(f)===null&&X===r(d)&&(_?(C(B),B=-1):_=!0,ie(Y,K-re))):(X.sortIndex=de,e(f,X),b||g||(b=!0,W||(W=!0,T()))),X},t.unstable_shouldYield=J,t.unstable_wrapCallback=function(X){var Z=x;return function(){var K=x;x=Z;try{return X.apply(this,arguments)}finally{x=K}}}})(Hg)),Hg}var pb;function DE(){return pb||(pb=1,zg.exports=RE()),zg.exports}var $g={exports:{}},Ns={};var gb;function FE(){if(gb)return Ns;gb=1;var t=zx();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function s(f,d,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:v==null?null:""+v,children:f,containerInfo:d,implementation:m}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ns.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Ns.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(f,d,null,m)},Ns.flushSync=function(f){var d=l.T,m=a.p;try{if(l.T=null,a.p=2,f)return f()}finally{l.T=d,a.p=m,a.d.f()}},Ns.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,a.d.C(f,d))},Ns.prefetchDNS=function(f){typeof f=="string"&&a.d.D(f)},Ns.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,v=c(m,d.crossOrigin),x=typeof d.integrity=="string"?d.integrity:void 0,g=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?a.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:v,integrity:x,fetchPriority:g}):m==="script"&&a.d.X(f,{crossOrigin:v,integrity:x,fetchPriority:g,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ns.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=c(d.as,d.crossOrigin);a.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&a.d.M(f)},Ns.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,v=c(m,d.crossOrigin);a.d.L(f,m,{crossOrigin:v,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ns.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=c(d.as,d.crossOrigin);a.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else a.d.m(f)},Ns.requestFormReset=function(f){a.d.r(f)},Ns.unstable_batchedUpdates=function(f,d){return f(d)},Ns.useFormState=function(f,d,m){return l.H.useFormState(f,d,m)},Ns.useFormStatus=function(){return l.H.useHostTransitionStatus()},Ns.version="19.2.0",Ns}var vb;function LE(){if(vb)return $g.exports;vb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),$g.exports=FE(),$g.exports}var xb;function PE(){if(xb)return Qh;xb=1;var t=DE(),e=zx(),r=LE();function a(i){var u="https://react.dev/errors/"+i;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+i+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function s(i){var u=i,h=i;if(i.alternate)for(;u.return;)u=u.return;else{i=u;do u=i,(u.flags&4098)!==0&&(h=u.return),i=u.return;while(i)}return u.tag===3?h:null}function l(i){if(i.tag===13){var u=i.memoizedState;if(u===null&&(i=i.alternate,i!==null&&(u=i.memoizedState)),u!==null)return u.dehydrated}return null}function c(i){if(i.tag===31){var u=i.memoizedState;if(u===null&&(i=i.alternate,i!==null&&(u=i.memoizedState)),u!==null)return u.dehydrated}return null}function f(i){if(s(i)!==i)throw Error(a(188))}function d(i){var u=i.alternate;if(!u){if(u=s(i),u===null)throw Error(a(188));return u!==i?null:i}for(var h=i,p=u;;){var S=h.return;if(S===null)break;var j=S.alternate;if(j===null){if(p=S.return,p!==null){h=p;continue}break}if(S.child===j.child){for(j=S.child;j;){if(j===h)return f(S),i;if(j===p)return f(S),u;j=j.sibling}throw Error(a(188))}if(h.return!==p.return)h=S,p=j;else{for(var G=!1,ue=S.child;ue;){if(ue===h){G=!0,h=S,p=j;break}if(ue===p){G=!0,p=S,h=j;break}ue=ue.sibling}if(!G){for(ue=j.child;ue;){if(ue===h){G=!0,h=j,p=S;break}if(ue===p){G=!0,p=j,h=S;break}ue=ue.sibling}if(!G)throw Error(a(189))}}if(h.alternate!==p)throw Error(a(190))}if(h.tag!==3)throw Error(a(188));return h.stateNode.current===h?i:u}function m(i){var u=i.tag;if(u===5||u===26||u===27||u===6)return i;for(i=i.child;i!==null;){if(u=m(i),u!==null)return u;i=i.sibling}return null}var v=Object.assign,x=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),E=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function T(i){return i===null||typeof i!="object"?null:(i=D&&i[D]||i["@@iterator"],typeof i=="function"?i:null)}var M=Symbol.for("react.client.reference");function V(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===M?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case _:return"Fragment";case A:return"Profiler";case w:return"StrictMode";case Y:return"Suspense";case W:return"SuspenseList";case L:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case b:return"Portal";case E:return i.displayName||"Context";case C:return(i._context.displayName||"Context")+".Consumer";case R:var u=i.render;return i=i.displayName,i||(i=u.displayName||u.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case B:return u=i.displayName||null,u!==null?u:V(i.type)||"Memo";case q:u=i._payload,i=i._init;try{return V(i(u))}catch{}}return null}var ie=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},re=[],de=-1;function U(i){return{current:i}}function k(i){0>de||(i.current=re[de],re[de]=null,de--)}function F(i,u){de++,re[de]=i.current,i.current=u}var I=U(null),z=U(null),te=U(null),se=U(null);function pe(i,u){switch(F(te,u),F(z,i),F(I,null),u.nodeType){case 9:case 11:i=(i=u.documentElement)&&(i=i.namespaceURI)?D_(i):0;break;default:if(i=u.tagName,u=u.namespaceURI)u=D_(u),i=F_(u,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}k(I),F(I,i)}function ve(){k(I),k(z),k(te)}function _e(i){i.memoizedState!==null&&F(se,i);var u=I.current,h=F_(u,i.type);u!==h&&(F(z,i),F(I,h))}function Pe(i){z.current===i&&(k(I),k(z)),se.current===i&&(k(se),Yh._currentValue=K)}var fe,st;function mt(i){if(fe===void 0)try{throw Error()}catch(h){var u=h.stack.trim().match(/\n( *(at )?)/);fe=u&&u[1]||"",st=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+fe+i+st}var he=!1;function at(i,u){if(!i||he)return"";he=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(u){var _t=function(){throw Error()};if(Object.defineProperty(_t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_t,[])}catch(rt){var tt=rt}Reflect.construct(i,[],_t)}else{try{_t.call()}catch(rt){tt=rt}i.call(_t.prototype)}}else{try{throw Error()}catch(rt){tt=rt}(_t=i())&&typeof _t.catch=="function"&&_t.catch(function(){})}}catch(rt){if(rt&&tt&&typeof rt.stack=="string")return[rt.stack,tt.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var j=p.DetermineComponentFrameRoot(),G=j[0],ue=j[1];if(G&&ue){var Te=G.split(`
`),Qe=ue.split(`
`);for(S=p=0;p<Te.length&&!Te[p].includes("DetermineComponentFrameRoot");)p++;for(;S<Qe.length&&!Qe[S].includes("DetermineComponentFrameRoot");)S++;if(p===Te.length||S===Qe.length)for(p=Te.length-1,S=Qe.length-1;1<=p&&0<=S&&Te[p]!==Qe[S];)S--;for(;1<=p&&0<=S;p--,S--)if(Te[p]!==Qe[S]){if(p!==1||S!==1)do if(p--,S--,0>S||Te[p]!==Qe[S]){var dt=`
`+Te[p].replace(" at new "," at ");return i.displayName&&dt.includes("<anonymous>")&&(dt=dt.replace("<anonymous>",i.displayName)),dt}while(1<=p&&0<=S);break}}}finally{he=!1,Error.prepareStackTrace=h}return(h=i?i.displayName||i.name:"")?mt(h):""}function we(i,u){switch(i.tag){case 26:case 27:case 5:return mt(i.type);case 16:return mt("Lazy");case 13:return i.child!==u&&u!==null?mt("Suspense Fallback"):mt("Suspense");case 19:return mt("SuspenseList");case 0:case 15:return at(i.type,!1);case 11:return at(i.type.render,!1);case 1:return at(i.type,!0);case 31:return mt("Activity");default:return""}}function ye(i){try{var u="",h=null;do u+=we(i,h),h=i,i=i.return;while(i);return u}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Be=Object.prototype.hasOwnProperty,Et=t.unstable_scheduleCallback,Xe=t.unstable_cancelCallback,lt=t.unstable_shouldYield,jt=t.unstable_requestPaint,Dt=t.unstable_now,Wt=t.unstable_getCurrentPriorityLevel,et=t.unstable_ImmediatePriority,ht=t.unstable_UserBlockingPriority,yt=t.unstable_NormalPriority,ft=t.unstable_LowPriority,pt=t.unstable_IdlePriority,wt=t.log,Lt=t.unstable_setDisableYieldValue,Pt=null,zt=null;function Ce(i){if(typeof wt=="function"&&Lt(i),zt&&typeof zt.setStrictMode=="function")try{zt.setStrictMode(Pt,i)}catch{}}var Ve=Math.clz32?Math.clz32:Me,ce=Math.log,Re=Math.LN2;function Me(i){return i>>>=0,i===0?32:31-(ce(i)/Re|0)|0}var Tt=256,$t=262144,or=4194304;function Ht(i){var u=i&42;if(u!==0)return u;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function mr(i,u,h){var p=i.pendingLanes;if(p===0)return 0;var S=0,j=i.suspendedLanes,G=i.pingedLanes;i=i.warmLanes;var ue=p&134217727;return ue!==0?(p=ue&~j,p!==0?S=Ht(p):(G&=ue,G!==0?S=Ht(G):h||(h=ue&~i,h!==0&&(S=Ht(h))))):(ue=p&~j,ue!==0?S=Ht(ue):G!==0?S=Ht(G):h||(h=p&~i,h!==0&&(S=Ht(h)))),S===0?0:u!==0&&u!==S&&(u&j)===0&&(j=S&-S,h=u&-u,j>=h||j===32&&(h&4194048)!==0)?u:S}function Ca(i,u){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&u)===0}function Na(i,u){switch(i){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ct(){var i=or;return or<<=1,(or&62914560)===0&&(or=4194304),i}function Oa(i){for(var u=[],h=0;31>h;h++)u.push(i);return u}function ar(i,u){i.pendingLanes|=u,u!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function za(i,u,h,p,S,j){var G=i.pendingLanes;i.pendingLanes=h,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=h,i.entangledLanes&=h,i.errorRecoveryDisabledLanes&=h,i.shellSuspendCounter=0;var ue=i.entanglements,Te=i.expirationTimes,Qe=i.hiddenUpdates;for(h=G&~h;0<h;){var dt=31-Ve(h),_t=1<<dt;ue[dt]=0,Te[dt]=-1;var tt=Qe[dt];if(tt!==null)for(Qe[dt]=null,dt=0;dt<tt.length;dt++){var rt=tt[dt];rt!==null&&(rt.lane&=-536870913)}h&=~_t}p!==0&&os(i,p,0),j!==0&&S===0&&i.tag!==0&&(i.suspendedLanes|=j&~(G&~u))}function os(i,u,h){i.pendingLanes|=u,i.suspendedLanes&=~u;var p=31-Ve(u);i.entangledLanes|=u,i.entanglements[p]=i.entanglements[p]|1073741824|h&261930}function rn(i,u){var h=i.entangledLanes|=u;for(i=i.entanglements;h;){var p=31-Ve(h),S=1<<p;S&u|i[p]&u&&(i[p]|=u),h&=~S}}function Mn(i,u){var h=u&-u;return h=(h&42)!==0?1:Ut(h),(h&(i.suspendedLanes|u))!==0?0:h}function Ut(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function er(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function ae(){var i=Z.p;return i!==0?i:(i=window.event,i===void 0?32:ab(i.type))}function Se(i,u){var h=Z.p;try{return Z.p=i,u()}finally{Z.p=h}}var ge=Math.random().toString(36).slice(2),xe="__reactFiber$"+ge,Ne="__reactProps$"+ge,ke="__reactContainer$"+ge,He="__reactEvents$"+ge,nt="__reactListeners$"+ge,Ge="__reactHandles$"+ge,Ye="__reactResources$"+ge,Je="__reactMarker$"+ge;function kt(i){delete i[xe],delete i[Ne],delete i[He],delete i[nt],delete i[Ge]}function Rt(i){var u=i[xe];if(u)return u;for(var h=i.parentNode;h;){if(u=h[ke]||h[xe]){if(h=u.alternate,u.child!==null||h!==null&&h.child!==null)for(i=q_(i);i!==null;){if(h=i[xe])return h;i=q_(i)}return u}i=h,h=i.parentNode}return null}function qt(i){if(i=i[xe]||i[ke]){var u=i.tag;if(u===5||u===6||u===13||u===31||u===26||u===27||u===3)return i}return null}function Ot(i){var u=i.tag;if(u===5||u===26||u===27||u===6)return i.stateNode;throw Error(a(33))}function Mt(i){var u=i[Ye];return u||(u=i[Ye]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function Xt(i){i[Je]=!0}var sa=new Set,Lr={};function ca(i,u){ls(i,u),ls(i+"Capture",u)}function ls(i,u){for(Lr[i]=u,i=0;i<u.length;i++)sa.add(u[i])}var pi=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gi={},Is={};function Qo(i){return Be.call(Is,i)?!0:Be.call(gi,i)?!1:pi.test(i)?Is[i]=!0:(gi[i]=!0,!1)}function Ra(i,u,h){if(Qo(u))if(h===null)i.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":i.removeAttribute(u);return;case"boolean":var p=u.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(u);return}}i.setAttribute(u,""+h)}}function po(i,u,h){if(h===null)i.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttribute(u,""+h)}}function vi(i,u,h,p){if(p===null)i.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(h);return}i.setAttributeNS(u,h,""+p)}}function Kr(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Su(i){var u=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function zi(i,u,h){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,u);if(!i.hasOwnProperty(u)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,j=p.set;return Object.defineProperty(i,u,{configurable:!0,get:function(){return S.call(this)},set:function(G){h=""+G,j.call(this,G)}}),Object.defineProperty(i,u,{enumerable:p.enumerable}),{getValue:function(){return h},setValue:function(G){h=""+G},stopTracking:function(){i._valueTracker=null,delete i[u]}}}}function el(i){if(!i._valueTracker){var u=Su(i)?"checked":"value";i._valueTracker=zi(i,u,""+i[u])}}function Nu(i){if(!i)return!1;var u=i._valueTracker;if(!u)return!0;var h=u.getValue(),p="";return i&&(p=Su(i)?i.checked?"true":"false":i.value),i=p,i!==h?(u.setValue(i),!0):!1}function cs(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var gn=/[\n"\\]/g;function an(i){return i.replace(gn,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function _c(i,u,h,p,S,j,G,ue){i.name="",G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?i.type=G:i.removeAttribute("type"),u!=null?G==="number"?(u===0&&i.value===""||i.value!=u)&&(i.value=""+Kr(u)):i.value!==""+Kr(u)&&(i.value=""+Kr(u)):G!=="submit"&&G!=="reset"||i.removeAttribute("value"),u!=null?ku(i,G,Kr(u)):h!=null?ku(i,G,Kr(h)):p!=null&&i.removeAttribute("value"),S==null&&j!=null&&(i.defaultChecked=!!j),S!=null&&(i.checked=S&&typeof S!="function"&&typeof S!="symbol"),ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"?i.name=""+Kr(ue):i.removeAttribute("name")}function Mf(i,u,h,p,S,j,G,ue){if(j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(i.type=j),u!=null||h!=null){if(!(j!=="submit"&&j!=="reset"||u!=null)){el(i);return}h=h!=null?""+Kr(h):"",u=u!=null?""+Kr(u):h,ue||u===i.value||(i.value=u),i.defaultValue=u}p=p??S,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=ue?i.checked:!!p,i.defaultChecked=!!p,G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"&&(i.name=G),el(i)}function ku(i,u,h){u==="number"&&cs(i.ownerDocument)===i||i.defaultValue===""+h||(i.defaultValue=""+h)}function us(i,u,h,p){if(i=i.options,u){u={};for(var S=0;S<h.length;S++)u["$"+h[S]]=!0;for(h=0;h<i.length;h++)S=u.hasOwnProperty("$"+i[h].value),i[h].selected!==S&&(i[h].selected=S),S&&p&&(i[h].defaultSelected=!0)}else{for(h=""+Kr(h),u=null,S=0;S<i.length;S++){if(i[S].value===h){i[S].selected=!0,p&&(i[S].defaultSelected=!0);return}u!==null||i[S].disabled||(u=i[S])}u!==null&&(u.selected=!0)}}function ju(i,u,h){if(u!=null&&(u=""+Kr(u),u!==i.value&&(i.value=u),h==null)){i.defaultValue!==u&&(i.defaultValue=u);return}i.defaultValue=h!=null?""+Kr(h):""}function Eu(i,u,h,p){if(u==null){if(p!=null){if(h!=null)throw Error(a(92));if(ie(p)){if(1<p.length)throw Error(a(93));p=p[0]}h=p}h==null&&(h=""),u=h}h=Kr(u),i.defaultValue=h,p=i.textContent,p===h&&p!==""&&p!==null&&(i.value=p),el(i)}function xi(i,u){if(u){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=u;return}}i.textContent=u}var Ol=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function If(i,u,h){var p=u.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?p?i.setProperty(u,""):u==="float"?i.cssFloat="":i[u]="":p?i.setProperty(u,h):typeof h!="number"||h===0||Ol.has(u)?u==="float"?i.cssFloat=h:i[u]=(""+h).trim():i[u]=h+"px"}function Bf(i,u,h){if(u!=null&&typeof u!="object")throw Error(a(62));if(i=i.style,h!=null){for(var p in h)!h.hasOwnProperty(p)||u!=null&&u.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var S in u)p=u[S],u.hasOwnProperty(S)&&h[S]!==p&&If(i,S,p)}else for(var j in u)u.hasOwnProperty(j)&&If(i,j,u[j])}function Au(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Uf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function bs(i){return Uf.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function yi(){}var go=null;function Rl(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var tl=null,pr=null;function qf(i){var u=qt(i);if(u&&(i=u.stateNode)){var h=i[Ne]||null;e:switch(i=u.stateNode,u.type){case"input":if(_c(i,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),u=h.name,h.type==="radio"&&u!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+an(""+u)+'"][type="radio"]'),u=0;u<h.length;u++){var p=h[u];if(p!==i&&p.form===i.form){var S=p[Ne]||null;if(!S)throw Error(a(90));_c(p,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(u=0;u<h.length;u++)p=h[u],p.form===i.form&&Nu(p)}break e;case"textarea":ju(i,h.value,h.defaultValue);break e;case"select":u=h.value,u!=null&&us(i,!!h.multiple,u,!1)}}}var Tu=!1;function zf(i,u,h){if(Tu)return i(u,h);Tu=!0;try{var p=i(u);return p}finally{if(Tu=!1,(tl!==null||pr!==null)&&(Am(),tl&&(u=tl,i=pr,pr=tl=null,qf(u),i)))for(u=0;u<i.length;u++)qf(i[u])}}function Bs(i,u){var h=i.stateNode;if(h===null)return null;var p=h[Ne]||null;if(p===null)return null;h=p[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(a(231,u,typeof h));return h}var In=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ou=!1;if(In)try{var Dl={};Object.defineProperty(Dl,"passive",{get:function(){Ou=!0}}),window.addEventListener("test",Dl,Dl),window.removeEventListener("test",Dl,Dl)}catch{Ou=!1}var Us=null,Fl=null,Hi=null;function Hf(){if(Hi)return Hi;var i,u=Fl,h=u.length,p,S="value"in Us?Us.value:Us.textContent,j=S.length;for(i=0;i<h&&u[i]===S[i];i++);var G=h-i;for(p=1;p<=G&&u[h-p]===S[j-p];p++);return Hi=S.slice(i,1<p?1-p:void 0)}function Ys(i){var u=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&u===13&&(i=13)):i=u,i===10&&(i=13),32<=i||i===13?i:0}function bc(){return!0}function wc(){return!1}function An(i){function u(h,p,S,j,G){this._reactName=h,this._targetInst=S,this.type=p,this.nativeEvent=j,this.target=G,this.currentTarget=null;for(var ue in i)i.hasOwnProperty(ue)&&(h=i[ue],this[ue]=h?h(j):j[ue]);return this.isDefaultPrevented=(j.defaultPrevented!=null?j.defaultPrevented:j.returnValue===!1)?bc:wc,this.isPropagationStopped=wc,this}return v(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=bc)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=bc)},persist:function(){},isPersistent:bc}),u}var $i={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xs=An($i),vo=v({},$i,{view:0,detail:0}),Sc=An(vo),Ll,xo,yo,Pl=v({},vo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xr,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==yo&&(yo&&i.type==="mousemove"?(Ll=i.screenX-yo.screenX,xo=i.screenY-yo.screenY):xo=Ll=0,yo=i),Ll)},movementY:function(i){return"movementY"in i?i.movementY:xo}}),Ru=An(Pl),_o=v({},Pl,{dataTransfer:0}),bo=An(_o),$f=v({},vo,{relatedTarget:0}),wo=An($f),Wf=v({},$i,{animationName:0,elapsedTime:0,pseudoElement:0}),O=An(Wf),Q=v({},$i,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Ae=An(Q),Oe=v({},$i,{data:0}),qe=An(Oe),gt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},St={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nr(i){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(i):(i=Jt[i])?!!u[i]:!1}function xr(){return nr}var jr=v({},vo,{key:function(i){if(i.key){var u=gt[i.key]||i.key;if(u!=="Unidentified")return u}return i.type==="keypress"?(i=Ys(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?St[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xr,charCode:function(i){return i.type==="keypress"?Ys(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ys(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),$r=An(jr),Da=v({},Pl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ya=An(Da),va=v({},vo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xr}),vn=An(va),nn=v({},$i,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bn=An(nn),So=v({},Pl,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),_i=An(So),No=v({},$i,{newState:0,oldState:0}),Du=An(No),Nc=[9,13,27,32],Wi=In&&"CompositionEvent"in window,bi=null;In&&"documentMode"in document&&(bi=document.documentMode);var Ml=In&&"TextEvent"in window&&!bi,ko=In&&(!Wi||bi&&8<bi&&11>=bi),Cn=" ",rl=!1;function al(i,u){switch(i){case"keyup":return Nc.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kc(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Vi=!1;function fs(i,u){switch(i){case"compositionend":return kc(u);case"keypress":return u.which!==32?null:(rl=!0,Cn);case"textInput":return i=u.data,i===Cn&&rl?null:i;default:return null}}function jo(i,u){if(Vi)return i==="compositionend"||!Wi&&al(i,u)?(i=Hf(),Hi=Fl=Us=null,Vi=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return ko&&u.locale!=="ko"?null:u.data;default:return null}}var jc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fu(i){var u=i&&i.nodeName&&i.nodeName.toLowerCase();return u==="input"?!!jc[i.type]:u==="textarea"}function qs(i,u,h,p){tl?pr?pr.push(p):pr=[p]:tl=p,u=Lm(u,"onChange"),0<u.length&&(h=new Xs("onChange","change",null,h,p),i.push({event:h,listeners:u}))}var wi=null,Eo=null;function Lu(i){E_(i,0)}function Si(i){var u=Ot(i);if(Nu(u))return i}function nl(i,u){if(i==="change")return u}var ws=!1;if(In){var ds;if(In){var Gi="oninput"in document;if(!Gi){var Yi=document.createElement("div");Yi.setAttribute("oninput","return;"),Gi=typeof Yi.oninput=="function"}ds=Gi}else ds=!1;ws=ds&&(!document.documentMode||9<document.documentMode)}function Ao(){wi&&(wi.detachEvent("onpropertychange",Ec),Eo=wi=null)}function Ec(i){if(i.propertyName==="value"&&Si(Eo)){var u=[];qs(u,Eo,i,Rl(i)),zf(Lu,u)}}function Ac(i,u,h){i==="focusin"?(Ao(),wi=u,Eo=h,wi.attachEvent("onpropertychange",Ec)):i==="focusout"&&Ao()}function Xa(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Si(Eo)}function Vf(i,u){if(i==="click")return Si(u)}function Xi(i,u){if(i==="input"||i==="change")return Si(u)}function Ki(i,u){return i===u&&(i!==0||1/i===1/u)||i!==i&&u!==u}var Un=typeof Object.is=="function"?Object.is:Ki;function Co(i,u){if(Un(i,u))return!0;if(typeof i!="object"||i===null||typeof u!="object"||u===null)return!1;var h=Object.keys(i),p=Object.keys(u);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var S=h[p];if(!Be.call(u,S)||!Un(i[S],u[S]))return!1}return!0}function Cc(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Tc(i,u){var h=Cc(i);i=0;for(var p;h;){if(h.nodeType===3){if(p=i+h.textContent.length,i<=u&&p>=u)return{node:h,offset:u-i};i=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Cc(h)}}function To(i,u){return i&&u?i===u?!0:i&&i.nodeType===3?!1:u&&u.nodeType===3?To(i,u.parentNode):"contains"in i?i.contains(u):i.compareDocumentPosition?!!(i.compareDocumentPosition(u)&16):!1:!1}function Oo(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var u=cs(i.document);u instanceof i.HTMLIFrameElement;){try{var h=typeof u.contentWindow.location.href=="string"}catch{h=!1}if(h)i=u.contentWindow;else break;u=cs(i.document)}return u}function Ji(i){var u=i&&i.nodeName&&i.nodeName.toLowerCase();return u&&(u==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||u==="textarea"||i.contentEditable==="true")}var Il=In&&"documentMode"in document&&11>=document.documentMode,zs=null,Ro=null,Jn=null,Ks=!1;function Jr(i,u,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Ks||zs==null||zs!==cs(p)||(p=zs,"selectionStart"in p&&Ji(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Jn&&Co(Jn,p)||(Jn=p,p=Lm(Ro,"onSelect"),0<p.length&&(u=new Xs("onSelect","select",null,u,h),i.push({event:u,listeners:p}),u.target=zs)))}function Wr(i,u){var h={};return h[i.toLowerCase()]=u.toLowerCase(),h["Webkit"+i]="webkit"+u,h["Moz"+i]="moz"+u,h}var xa={animationend:Wr("Animation","AnimationEnd"),animationiteration:Wr("Animation","AnimationIteration"),animationstart:Wr("Animation","AnimationStart"),transitionrun:Wr("Transition","TransitionRun"),transitionstart:Wr("Transition","TransitionStart"),transitioncancel:Wr("Transition","TransitionCancel"),transitionend:Wr("Transition","TransitionEnd")},Ka={},Zi={};In&&(Zi=document.createElement("div").style,"AnimationEvent"in window||(delete xa.animationend.animation,delete xa.animationiteration.animation,delete xa.animationstart.animation),"TransitionEvent"in window||delete xa.transitionend.transition);function Ni(i){if(Ka[i])return Ka[i];if(!xa[i])return i;var u=xa[i],h;for(h in u)if(u.hasOwnProperty(h)&&h in Zi)return Ka[i]=u[h];return i}var Bl=Ni("animationend"),Pu=Ni("animationiteration"),vh=Ni("animationstart"),nm=Ni("transitionrun"),sm=Ni("transitionstart"),im=Ni("transitioncancel"),xh=Ni("transitionend"),yh=new Map,Ul="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ul.push("scrollEnd");function Js(i,u){yh.set(i,u),ca(u,[i])}var Mu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Hs=[],ql=0,Gf=0;function Iu(){for(var i=ql,u=Gf=ql=0;u<i;){var h=Hs[u];Hs[u++]=null;var p=Hs[u];Hs[u++]=null;var S=Hs[u];Hs[u++]=null;var j=Hs[u];if(Hs[u++]=null,p!==null&&S!==null){var G=p.pending;G===null?S.next=S:(S.next=G.next,G.next=S),p.pending=S}j!==0&&Uu(h,S,j)}}function Bu(i,u,h,p){Hs[ql++]=i,Hs[ql++]=u,Hs[ql++]=h,Hs[ql++]=p,Gf|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function Yf(i,u,h,p){return Bu(i,u,h,p),Zn(i)}function Do(i,u){return Bu(i,null,null,u),Zn(i)}function Uu(i,u,h){i.lanes|=h;var p=i.alternate;p!==null&&(p.lanes|=h);for(var S=!1,j=i.return;j!==null;)j.childLanes|=h,p=j.alternate,p!==null&&(p.childLanes|=h),j.tag===22&&(i=j.stateNode,i===null||i._visibility&1||(S=!0)),i=j,j=j.return;return i.tag===3?(j=i.stateNode,S&&u!==null&&(S=31-Ve(h),i=j.hiddenUpdates,p=i[S],p===null?i[S]=[u]:p.push(u),u.lane=h|536870912),j):null}function Zn(i){if(50<qh)throw qh=0,cg=null,Error(a(185));for(var u=i.return;u!==null;)i=u,u=i.return;return i.tag===3?i.stateNode:null}var qn={};function Xf(i,u,h,p){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qn(i,u,h,p){return new Xf(i,u,h,p)}function Kf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Zs(i,u){var h=i.alternate;return h===null?(h=Qn(i.tag,u,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=u,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&65011712,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,u=i.dependencies,h.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h.refCleanup=i.refCleanup,h}function qu(i,u){i.flags&=65011714;var h=i.alternate;return h===null?(i.childLanes=0,i.lanes=u,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=h.childLanes,i.lanes=h.lanes,i.child=h.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=h.memoizedProps,i.memoizedState=h.memoizedState,i.updateQueue=h.updateQueue,i.type=h.type,u=h.dependencies,i.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),i}function Oc(i,u,h,p,S,j){var G=0;if(p=i,typeof i=="function")Kf(i)&&(G=1);else if(typeof i=="string")G=mE(i,h,I.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case L:return i=Qn(31,h,u,S),i.elementType=L,i.lanes=j,i;case _:return sl(h.children,S,j,u);case w:G=8,S|=24;break;case A:return i=Qn(12,h,u,S|2),i.elementType=A,i.lanes=j,i;case Y:return i=Qn(13,h,u,S),i.elementType=Y,i.lanes=j,i;case W:return i=Qn(19,h,u,S),i.elementType=W,i.lanes=j,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case E:G=10;break e;case C:G=9;break e;case R:G=11;break e;case B:G=14;break e;case q:G=16,p=null;break e}G=29,h=Error(a(130,i===null?"null":typeof i,"")),p=null}return u=Qn(G,h,u,S),u.elementType=i,u.type=p,u.lanes=j,u}function sl(i,u,h,p){return i=Qn(7,i,p,u),i.lanes=h,i}function zu(i,u,h){return i=Qn(6,i,null,u),i.lanes=h,i}function Jf(i){var u=Qn(18,null,null,0);return u.stateNode=i,u}function Rc(i,u,h){return u=Qn(4,i.children!==null?i.children:[],i.key,u),u.lanes=h,u.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},u}var Zf=new WeakMap;function Qs(i,u){if(typeof i=="object"&&i!==null){var h=Zf.get(i);return h!==void 0?h:(u={value:i,source:u,stack:ye(u)},Zf.set(i,u),u)}return{value:i,source:u,stack:ye(u)}}var Dc=[],zl=0,Qf=null,Hu=0,ei=[],ti=0,il=null,ri=1,ai="";function $s(i,u){Dc[zl++]=Hu,Dc[zl++]=Qf,Qf=i,Hu=u}function om(i,u,h){ei[ti++]=ri,ei[ti++]=ai,ei[ti++]=il,il=i;var p=ri;i=ai;var S=32-Ve(p)-1;p&=~(1<<S),h+=1;var j=32-Ve(u)+S;if(30<j){var G=S-S%5;j=(p&(1<<G)-1).toString(32),p>>=G,S-=G,ri=1<<32-Ve(u)+S|h<<S|p,ai=j+i}else ri=1<<j|h<<S|p,ai=i}function _h(i){i.return!==null&&($s(i,1),om(i,1,0))}function ed(i){for(;i===Qf;)Qf=Dc[--zl],Dc[zl]=null,Hu=Dc[--zl],Dc[zl]=null;for(;i===il;)il=ei[--ti],ei[ti]=null,ai=ei[--ti],ei[ti]=null,ri=ei[--ti],ei[ti]=null}function lm(i,u){ei[ti++]=ri,ei[ti++]=ai,ei[ti++]=il,ri=u.id,ai=u.overflow,il=i}var zn=null,ka=null,Br=!1,hs=null,Ha=!1,ki=Error(a(519));function ol(i){var u=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Fc(Qs(u,i)),ki}function bh(i){var u=i.stateNode,h=i.type,p=i.memoizedProps;switch(u[xe]=i,u[Ne]=p,h){case"dialog":qr("cancel",u),qr("close",u);break;case"iframe":case"object":case"embed":qr("load",u);break;case"video":case"audio":for(h=0;h<Hh.length;h++)qr(Hh[h],u);break;case"source":qr("error",u);break;case"img":case"image":case"link":qr("error",u),qr("load",u);break;case"details":qr("toggle",u);break;case"input":qr("invalid",u),Mf(u,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":qr("invalid",u);break;case"textarea":qr("invalid",u),Eu(u,p.value,p.defaultValue,p.children)}h=p.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||u.textContent===""+h||p.suppressHydrationWarning===!0||O_(u.textContent,h)?(p.popover!=null&&(qr("beforetoggle",u),qr("toggle",u)),p.onScroll!=null&&qr("scroll",u),p.onScrollEnd!=null&&qr("scrollend",u),p.onClick!=null&&(u.onclick=yi),u=!0):u=!1,u||ol(i,!0)}function Fo(i){for(zn=i.return;zn;)switch(zn.tag){case 5:case 31:case 13:Ha=!1;return;case 27:case 3:Ha=!0;return;default:zn=zn.return}}function Hn(i){if(i!==zn)return!1;if(!Br)return Fo(i),Br=!0,!1;var u=i.tag,h;if((h=u!==3&&u!==27)&&((h=u===5)&&(h=i.type,h=!(h!=="form"&&h!=="button")||Ng(i.type,i.memoizedProps)),h=!h),h&&ka&&ol(i),Fo(i),u===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));ka=U_(i)}else if(u===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));ka=U_(i)}else u===27?(u=ka,Yc(i.type)?(i=Cg,Cg=null,ka=i):ka=u):ka=zn?ro(i.stateNode.nextSibling):null;return!0}function Hl(){ka=zn=null,Br=!1}function wh(){var i=hs;return i!==null&&(ci===null?ci=i:ci.push.apply(ci,i),hs=null),i}function Fc(i){hs===null?hs=[i]:hs.push(i)}var td=U(null),ll=null,Qi=null;function cl(i,u,h){F(td,u._currentValue),u._currentValue=h}function ni(i){i._currentValue=td.current,k(td)}function Lc(i,u,h){for(;i!==null;){var p=i.alternate;if((i.childLanes&u)!==u?(i.childLanes|=u,p!==null&&(p.childLanes|=u)):p!==null&&(p.childLanes&u)!==u&&(p.childLanes|=u),i===h)break;i=i.return}}function $l(i,u,h,p){var S=i.child;for(S!==null&&(S.return=i);S!==null;){var j=S.dependencies;if(j!==null){var G=S.child;j=j.firstContext;e:for(;j!==null;){var ue=j;j=S;for(var Te=0;Te<u.length;Te++)if(ue.context===u[Te]){j.lanes|=h,ue=j.alternate,ue!==null&&(ue.lanes|=h),Lc(j.return,h,i),p||(G=null);break e}j=ue.next}}else if(S.tag===18){if(G=S.return,G===null)throw Error(a(341));G.lanes|=h,j=G.alternate,j!==null&&(j.lanes|=h),Lc(G,h,i),G=null}else G=S.child;if(G!==null)G.return=S;else for(G=S;G!==null;){if(G===i){G=null;break}if(S=G.sibling,S!==null){S.return=G.return,G=S;break}G=G.return}S=G}}function ul(i,u,h,p){i=null;for(var S=u,j=!1;S!==null;){if(!j){if((S.flags&524288)!==0)j=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var G=S.alternate;if(G===null)throw Error(a(387));if(G=G.memoizedProps,G!==null){var ue=S.type;Un(S.pendingProps.value,G.value)||(i!==null?i.push(ue):i=[ue])}}else if(S===se.current){if(G=S.alternate,G===null)throw Error(a(387));G.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(i!==null?i.push(Yh):i=[Yh])}S=S.return}i!==null&&$l(u,i,h,p),u.flags|=262144}function rd(i){for(i=i.firstContext;i!==null;){if(!Un(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function fl(i){ll=i,Qi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function $n(i){return cm(ll,i)}function ad(i,u){return ll===null&&fl(i),cm(i,u)}function cm(i,u){var h=u._currentValue;if(u={context:u,memoizedValue:h,next:null},Qi===null){if(i===null)throw Error(a(308));Qi=u,i.dependencies={lanes:0,firstContext:u},i.flags|=524288}else Qi=Qi.next=u;return h}var A1=typeof AbortController<"u"?AbortController:function(){var i=[],u=this.signal={aborted:!1,addEventListener:function(h,p){i.push(p)}};this.abort=function(){u.aborted=!0,i.forEach(function(h){return h()})}},C1=t.unstable_scheduleCallback,T1=t.unstable_NormalPriority,Ja={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pc(){return{controller:new A1,data:new Map,refCount:0}}function $u(i){i.refCount--,i.refCount===0&&C1(T1,function(){i.controller.abort()})}var Wu=null,nd=0,y=0,N=null;function P(i,u){if(Wu===null){var h=Wu=[];nd=0,y=pg(),N={status:"pending",value:void 0,then:function(p){h.push(p)}}}return nd++,u.then(H,H),u}function H(){if(--nd===0&&Wu!==null){N!==null&&(N.status="fulfilled");var i=Wu;Wu=null,y=0,N=null;for(var u=0;u<i.length;u++)(0,i[u])()}}function ee(i,u){var h=[],p={status:"pending",value:null,reason:null,then:function(S){h.push(S)}};return i.then(function(){p.status="fulfilled",p.value=u;for(var S=0;S<h.length;S++)(0,h[S])(u)},function(S){for(p.status="rejected",p.reason=S,S=0;S<h.length;S++)(0,h[S])(void 0)}),p}var oe=X.S;X.S=function(i,u){t_=Dt(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&P(i,u),oe!==null&&oe(i,u)};var le=U(null);function me(){var i=le.current;return i!==null?i:Ea.pooledCache}function be(i,u){u===null?F(le,le.current):F(le,u.pool)}function Ee(){var i=me();return i===null?null:{parent:Ja._currentValue,pool:i}}var Fe=Error(a(460)),Ke=Error(a(474)),je=Error(a(542)),Ie={then:function(){}};function $e(i){return i=i.status,i==="fulfilled"||i==="rejected"}function ct(i,u,h){switch(h=i[h],h===void 0?i.push(u):h!==u&&(u.then(yi,yi),u=h),u.status){case"fulfilled":return u.value;case"rejected":throw i=u.reason,At(i),i;default:if(typeof u.status=="string")u.then(yi,yi);else{if(i=Ea,i!==null&&100<i.shellSuspendCounter)throw Error(a(482));i=u,i.status="pending",i.then(function(p){if(u.status==="pending"){var S=u;S.status="fulfilled",S.value=p}},function(p){if(u.status==="pending"){var S=u;S.status="rejected",S.reason=p}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw i=u.reason,At(i),i}throw it=u,Fe}}function We(i){try{var u=i._init;return u(i._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(it=h,Fe):h}}var it=null;function vt(){if(it===null)throw Error(a(459));var i=it;return it=null,i}function At(i){if(i===Fe||i===je)throw Error(a(483))}var bt=null,tr=0;function Vt(i){var u=tr;return tr+=1,bt===null&&(bt=[]),ct(bt,i,u)}function Nr(i,u){u=u.props.ref,i.ref=u!==void 0?u:null}function Kt(i,u){throw u.$$typeof===x?Error(a(525)):(i=Object.prototype.toString.call(u),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":i)))}function Mr(i){function u(ze,Le){if(i){var Ze=ze.deletions;Ze===null?(ze.deletions=[Le],ze.flags|=16):Ze.push(Le)}}function h(ze,Le){if(!i)return null;for(;Le!==null;)u(ze,Le),Le=Le.sibling;return null}function p(ze){for(var Le=new Map;ze!==null;)ze.key!==null?Le.set(ze.key,ze):Le.set(ze.index,ze),ze=ze.sibling;return Le}function S(ze,Le){return ze=Zs(ze,Le),ze.index=0,ze.sibling=null,ze}function j(ze,Le,Ze){return ze.index=Ze,i?(Ze=ze.alternate,Ze!==null?(Ze=Ze.index,Ze<Le?(ze.flags|=67108866,Le):Ze):(ze.flags|=67108866,Le)):(ze.flags|=1048576,Le)}function G(ze){return i&&ze.alternate===null&&(ze.flags|=67108866),ze}function ue(ze,Le,Ze,xt){return Le===null||Le.tag!==6?(Le=zu(Ze,ze.mode,xt),Le.return=ze,Le):(Le=S(Le,Ze),Le.return=ze,Le)}function Te(ze,Le,Ze,xt){var dr=Ze.type;return dr===_?dt(ze,Le,Ze.props.children,xt,Ze.key):Le!==null&&(Le.elementType===dr||typeof dr=="object"&&dr!==null&&dr.$$typeof===q&&We(dr)===Le.type)?(Le=S(Le,Ze.props),Nr(Le,Ze),Le.return=ze,Le):(Le=Oc(Ze.type,Ze.key,Ze.props,null,ze.mode,xt),Nr(Le,Ze),Le.return=ze,Le)}function Qe(ze,Le,Ze,xt){return Le===null||Le.tag!==4||Le.stateNode.containerInfo!==Ze.containerInfo||Le.stateNode.implementation!==Ze.implementation?(Le=Rc(Ze,ze.mode,xt),Le.return=ze,Le):(Le=S(Le,Ze.children||[]),Le.return=ze,Le)}function dt(ze,Le,Ze,xt,dr){return Le===null||Le.tag!==7?(Le=sl(Ze,ze.mode,xt,dr),Le.return=ze,Le):(Le=S(Le,Ze),Le.return=ze,Le)}function _t(ze,Le,Ze){if(typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint")return Le=zu(""+Le,ze.mode,Ze),Le.return=ze,Le;if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case g:return Ze=Oc(Le.type,Le.key,Le.props,null,ze.mode,Ze),Nr(Ze,Le),Ze.return=ze,Ze;case b:return Le=Rc(Le,ze.mode,Ze),Le.return=ze,Le;case q:return Le=We(Le),_t(ze,Le,Ze)}if(ie(Le)||T(Le))return Le=sl(Le,ze.mode,Ze,null),Le.return=ze,Le;if(typeof Le.then=="function")return _t(ze,Vt(Le),Ze);if(Le.$$typeof===E)return _t(ze,ad(ze,Le),Ze);Kt(ze,Le)}return null}function tt(ze,Le,Ze,xt){var dr=Le!==null?Le.key:null;if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint")return dr!==null?null:ue(ze,Le,""+Ze,xt);if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case g:return Ze.key===dr?Te(ze,Le,Ze,xt):null;case b:return Ze.key===dr?Qe(ze,Le,Ze,xt):null;case q:return Ze=We(Ze),tt(ze,Le,Ze,xt)}if(ie(Ze)||T(Ze))return dr!==null?null:dt(ze,Le,Ze,xt,null);if(typeof Ze.then=="function")return tt(ze,Le,Vt(Ze),xt);if(Ze.$$typeof===E)return tt(ze,Le,ad(ze,Ze),xt);Kt(ze,Ze)}return null}function rt(ze,Le,Ze,xt,dr){if(typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint")return ze=ze.get(Ze)||null,ue(Le,ze,""+xt,dr);if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case g:return ze=ze.get(xt.key===null?Ze:xt.key)||null,Te(Le,ze,xt,dr);case b:return ze=ze.get(xt.key===null?Ze:xt.key)||null,Qe(Le,ze,xt,dr);case q:return xt=We(xt),rt(ze,Le,Ze,xt,dr)}if(ie(xt)||T(xt))return ze=ze.get(Ze)||null,dt(Le,ze,xt,dr,null);if(typeof xt.then=="function")return rt(ze,Le,Ze,Vt(xt),dr);if(xt.$$typeof===E)return rt(ze,Le,Ze,ad(Le,xt),dr);Kt(Le,xt)}return null}function Zt(ze,Le,Ze,xt){for(var dr=null,ta=null,sr=Le,Rr=Le=0,Hr=null;sr!==null&&Rr<Ze.length;Rr++){sr.index>Rr?(Hr=sr,sr=null):Hr=sr.sibling;var ra=tt(ze,sr,Ze[Rr],xt);if(ra===null){sr===null&&(sr=Hr);break}i&&sr&&ra.alternate===null&&u(ze,sr),Le=j(ra,Le,Rr),ta===null?dr=ra:ta.sibling=ra,ta=ra,sr=Hr}if(Rr===Ze.length)return h(ze,sr),Br&&$s(ze,Rr),dr;if(sr===null){for(;Rr<Ze.length;Rr++)sr=_t(ze,Ze[Rr],xt),sr!==null&&(Le=j(sr,Le,Rr),ta===null?dr=sr:ta.sibling=sr,ta=sr);return Br&&$s(ze,Rr),dr}for(sr=p(sr);Rr<Ze.length;Rr++)Hr=rt(sr,ze,Rr,Ze[Rr],xt),Hr!==null&&(i&&Hr.alternate!==null&&sr.delete(Hr.key===null?Rr:Hr.key),Le=j(Hr,Le,Rr),ta===null?dr=Hr:ta.sibling=Hr,ta=Hr);return i&&sr.forEach(function(Qc){return u(ze,Qc)}),Br&&$s(ze,Rr),dr}function vr(ze,Le,Ze,xt){if(Ze==null)throw Error(a(151));for(var dr=null,ta=null,sr=Le,Rr=Le=0,Hr=null,ra=Ze.next();sr!==null&&!ra.done;Rr++,ra=Ze.next()){sr.index>Rr?(Hr=sr,sr=null):Hr=sr.sibling;var Qc=tt(ze,sr,ra.value,xt);if(Qc===null){sr===null&&(sr=Hr);break}i&&sr&&Qc.alternate===null&&u(ze,sr),Le=j(Qc,Le,Rr),ta===null?dr=Qc:ta.sibling=Qc,ta=Qc,sr=Hr}if(ra.done)return h(ze,sr),Br&&$s(ze,Rr),dr;if(sr===null){for(;!ra.done;Rr++,ra=Ze.next())ra=_t(ze,ra.value,xt),ra!==null&&(Le=j(ra,Le,Rr),ta===null?dr=ra:ta.sibling=ra,ta=ra);return Br&&$s(ze,Rr),dr}for(sr=p(sr);!ra.done;Rr++,ra=Ze.next())ra=rt(sr,ze,Rr,ra.value,xt),ra!==null&&(i&&ra.alternate!==null&&sr.delete(ra.key===null?Rr:ra.key),Le=j(ra,Le,Rr),ta===null?dr=ra:ta.sibling=ra,ta=ra);return i&&sr.forEach(function(kE){return u(ze,kE)}),Br&&$s(ze,Rr),dr}function wa(ze,Le,Ze,xt){if(typeof Ze=="object"&&Ze!==null&&Ze.type===_&&Ze.key===null&&(Ze=Ze.props.children),typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case g:e:{for(var dr=Ze.key;Le!==null;){if(Le.key===dr){if(dr=Ze.type,dr===_){if(Le.tag===7){h(ze,Le.sibling),xt=S(Le,Ze.props.children),xt.return=ze,ze=xt;break e}}else if(Le.elementType===dr||typeof dr=="object"&&dr!==null&&dr.$$typeof===q&&We(dr)===Le.type){h(ze,Le.sibling),xt=S(Le,Ze.props),Nr(xt,Ze),xt.return=ze,ze=xt;break e}h(ze,Le);break}else u(ze,Le);Le=Le.sibling}Ze.type===_?(xt=sl(Ze.props.children,ze.mode,xt,Ze.key),xt.return=ze,ze=xt):(xt=Oc(Ze.type,Ze.key,Ze.props,null,ze.mode,xt),Nr(xt,Ze),xt.return=ze,ze=xt)}return G(ze);case b:e:{for(dr=Ze.key;Le!==null;){if(Le.key===dr)if(Le.tag===4&&Le.stateNode.containerInfo===Ze.containerInfo&&Le.stateNode.implementation===Ze.implementation){h(ze,Le.sibling),xt=S(Le,Ze.children||[]),xt.return=ze,ze=xt;break e}else{h(ze,Le);break}else u(ze,Le);Le=Le.sibling}xt=Rc(Ze,ze.mode,xt),xt.return=ze,ze=xt}return G(ze);case q:return Ze=We(Ze),wa(ze,Le,Ze,xt)}if(ie(Ze))return Zt(ze,Le,Ze,xt);if(T(Ze)){if(dr=T(Ze),typeof dr!="function")throw Error(a(150));return Ze=dr.call(Ze),vr(ze,Le,Ze,xt)}if(typeof Ze.then=="function")return wa(ze,Le,Vt(Ze),xt);if(Ze.$$typeof===E)return wa(ze,Le,ad(ze,Ze),xt);Kt(ze,Ze)}return typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint"?(Ze=""+Ze,Le!==null&&Le.tag===6?(h(ze,Le.sibling),xt=S(Le,Ze),xt.return=ze,ze=xt):(h(ze,Le),xt=zu(Ze,ze.mode,xt),xt.return=ze,ze=xt),G(ze)):h(ze,Le)}return function(ze,Le,Ze,xt){try{tr=0;var dr=wa(ze,Le,Ze,xt);return bt=null,dr}catch(sr){if(sr===Fe||sr===je)throw sr;var ta=Qn(29,sr,null,ze.mode);return ta.lanes=xt,ta.return=ze,ta}finally{}}}var ja=Mr(!0),Er=Mr(!1),Gt=!1;function Bt(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Fa(i,u){i=i.updateQueue,u.updateQueue===i&&(u.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function gr(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Tr(i,u,h){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(la&2)!==0){var S=p.pending;return S===null?u.next=u:(u.next=S.next,S.next=u),p.pending=u,u=Zn(i),Uu(i,null,h),u}return Bu(i,p,u,h),Zn(i)}function ia(i,u,h){if(u=u.updateQueue,u!==null&&(u=u.shared,(h&4194048)!==0)){var p=u.lanes;p&=i.pendingLanes,h|=p,u.lanes=h,rn(i,h)}}function xn(i,u){var h=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var S=null,j=null;if(h=h.firstBaseUpdate,h!==null){do{var G={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};j===null?S=j=G:j=j.next=G,h=h.next}while(h!==null);j===null?S=j=u:j=j.next=u}else S=j=u;h={baseState:p.baseState,firstBaseUpdate:S,lastBaseUpdate:j,shared:p.shared,callbacks:p.callbacks},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=u:i.next=u,h.lastBaseUpdate=u}var Wn=!1;function ya(){if(Wn){var i=N;if(i!==null)throw i}}function sn(i,u,h,p){Wn=!1;var S=i.updateQueue;Gt=!1;var j=S.firstBaseUpdate,G=S.lastBaseUpdate,ue=S.shared.pending;if(ue!==null){S.shared.pending=null;var Te=ue,Qe=Te.next;Te.next=null,G===null?j=Qe:G.next=Qe,G=Te;var dt=i.alternate;dt!==null&&(dt=dt.updateQueue,ue=dt.lastBaseUpdate,ue!==G&&(ue===null?dt.firstBaseUpdate=Qe:ue.next=Qe,dt.lastBaseUpdate=Te))}if(j!==null){var _t=S.baseState;G=0,dt=Qe=Te=null,ue=j;do{var tt=ue.lane&-536870913,rt=tt!==ue.lane;if(rt?(zr&tt)===tt:(p&tt)===tt){tt!==0&&tt===y&&(Wn=!0),dt!==null&&(dt=dt.next={lane:0,tag:ue.tag,payload:ue.payload,callback:null,next:null});e:{var Zt=i,vr=ue;tt=u;var wa=h;switch(vr.tag){case 1:if(Zt=vr.payload,typeof Zt=="function"){_t=Zt.call(wa,_t,tt);break e}_t=Zt;break e;case 3:Zt.flags=Zt.flags&-65537|128;case 0:if(Zt=vr.payload,tt=typeof Zt=="function"?Zt.call(wa,_t,tt):Zt,tt==null)break e;_t=v({},_t,tt);break e;case 2:Gt=!0}}tt=ue.callback,tt!==null&&(i.flags|=64,rt&&(i.flags|=8192),rt=S.callbacks,rt===null?S.callbacks=[tt]:rt.push(tt))}else rt={lane:tt,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},dt===null?(Qe=dt=rt,Te=_t):dt=dt.next=rt,G|=tt;if(ue=ue.next,ue===null){if(ue=S.shared.pending,ue===null)break;rt=ue,ue=rt.next,rt.next=null,S.lastBaseUpdate=rt,S.shared.pending=null}}while(!0);dt===null&&(Te=_t),S.baseState=Te,S.firstBaseUpdate=Qe,S.lastBaseUpdate=dt,j===null&&(S.shared.lanes=0),Hc|=G,i.lanes=G,i.memoizedState=_t}}function es(i,u){if(typeof i!="function")throw Error(a(191,i));i.call(u)}function on(i,u){var h=i.callbacks;if(h!==null)for(i.callbacks=null,i=0;i<h.length;i++)es(h[i],u)}var Fr=U(null),Gr=U(0);function La(i,u){i=ec,F(Gr,i),F(Fr,u),ec=i|u.baseLanes}function Zr(){F(Gr,ec),F(Fr,Fr.current)}function yn(){ec=Gr.current,k(Fr),k(Gr)}var Pa=U(null),Yr=null;function Za(i){var u=i.alternate;F(Vr,Vr.current&1),F(Pa,i),Yr===null&&(u===null||Fr.current!==null||u.memoizedState!==null)&&(Yr=i)}function oa(i){F(Vr,Vr.current),F(Pa,i),Yr===null&&(Yr=i)}function ln(i){i.tag===22?(F(Vr,Vr.current),F(Pa,i),Yr===null&&(Yr=i)):cn()}function cn(){F(Vr,Vr.current),F(Pa,Pa.current)}function ua(i){k(Pa),Yr===i&&(Yr=null),k(Vr)}var Vr=U(0);function ts(i){for(var u=i;u!==null;){if(u.tag===13){var h=u.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||Eg(h)||Ag(h)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var $a=0,ur=null,fr=null,Xr=null,Ss=!1,si=!1,ms=!1,un=0,dl=0,hl=null,sd=0;function _a(){throw Error(a(321))}function Sh(i,u){if(u===null)return!1;for(var h=0;h<u.length&&h<i.length;h++)if(!Un(i[h],u[h]))return!1;return!0}function Nh(i,u,h,p,S,j){return $a=j,ur=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,X.H=i===null||i.memoizedState===null?dy:I1,ms=!1,j=h(p,S),ms=!1,si&&(j=Lo(u,h,p,S)),id(i),j}function id(i){X.H=Rh;var u=fr!==null&&fr.next!==null;if($a=0,Xr=fr=ur=null,Ss=!1,dl=0,hl=null,u)throw Error(a(300));i===null||On||(i=i.dependencies,i!==null&&rd(i)&&(On=!0))}function Lo(i,u,h,p){ur=i;var S=0;do{if(si&&(hl=null),dl=0,si=!1,25<=S)throw Error(a(301));if(S+=1,Xr=fr=null,i.updateQueue!=null){var j=i.updateQueue;j.lastEffect=null,j.events=null,j.stores=null,j.memoCache!=null&&(j.memoCache.index=0)}X.H=hy,j=u(h,p)}while(si);return j}function O1(){var i=X.H,u=i.useState()[0];return u=typeof u.then=="function"?ml(u):u,i=i.useState()[0],(fr!==null?fr.memoizedState:null)!==i&&(ur.flags|=1024),u}function kh(){var i=un!==0;return un=0,i}function jh(i,u,h){u.updateQueue=i.updateQueue,u.flags&=-2053,i.lanes&=~h}function od(i){if(Ss){for(i=i.memoizedState;i!==null;){var u=i.queue;u!==null&&(u.pending=null),i=i.next}Ss=!1}$a=0,Xr=fr=ur=null,si=!1,dl=un=0,hl=null}function Tn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xr===null?ur.memoizedState=Xr=i:Xr=Xr.next=i,Xr}function Wa(){if(fr===null){var i=ur.alternate;i=i!==null?i.memoizedState:null}else i=fr.next;var u=Xr===null?ur.memoizedState:Xr.next;if(u!==null)Xr=u,fr=i;else{if(i===null)throw ur.alternate===null?Error(a(467)):Error(a(310));fr=i,i={memoizedState:fr.memoizedState,baseState:fr.baseState,baseQueue:fr.baseQueue,queue:fr.queue,next:null},Xr===null?ur.memoizedState=Xr=i:Xr=Xr.next=i}return Xr}function Vu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ml(i){var u=dl;return dl+=1,hl===null&&(hl=[]),i=ct(hl,i,u),u=ur,(Xr===null?u.memoizedState:Xr.next)===null&&(u=u.alternate,X.H=u===null||u.memoizedState===null?dy:I1),i}function Mc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return ml(i);if(i.$$typeof===E)return $n(i)}throw Error(a(438,String(i)))}function Wl(i){var u=null,h=ur.updateQueue;if(h!==null&&(u=h.memoCache),u==null){var p=ur.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(u={data:p.data.map(function(S){return S.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),h===null&&(h=Vu(),ur.updateQueue=h),h.memoCache=u,h=u.data[u.index],h===void 0)for(h=u.data[u.index]=Array(i),p=0;p<i;p++)h[p]=J;return u.index++,h}function eo(i,u){return typeof u=="function"?u(i):u}function ld(i){var u=Wa();return Ic(u,fr,i)}function Ic(i,u,h){var p=i.queue;if(p===null)throw Error(a(311));p.lastRenderedReducer=h;var S=i.baseQueue,j=p.pending;if(j!==null){if(S!==null){var G=S.next;S.next=j.next,j.next=G}u.baseQueue=S=j,p.pending=null}if(j=i.baseState,S===null)i.memoizedState=j;else{u=S.next;var ue=G=null,Te=null,Qe=u,dt=!1;do{var _t=Qe.lane&-536870913;if(_t!==Qe.lane?(zr&_t)===_t:($a&_t)===_t){var tt=Qe.revertLane;if(tt===0)Te!==null&&(Te=Te.next={lane:0,revertLane:0,gesture:null,action:Qe.action,hasEagerState:Qe.hasEagerState,eagerState:Qe.eagerState,next:null}),_t===y&&(dt=!0);else if(($a&tt)===tt){Qe=Qe.next,tt===y&&(dt=!0);continue}else _t={lane:0,revertLane:Qe.revertLane,gesture:null,action:Qe.action,hasEagerState:Qe.hasEagerState,eagerState:Qe.eagerState,next:null},Te===null?(ue=Te=_t,G=j):Te=Te.next=_t,ur.lanes|=tt,Hc|=tt;_t=Qe.action,ms&&h(j,_t),j=Qe.hasEagerState?Qe.eagerState:h(j,_t)}else tt={lane:_t,revertLane:Qe.revertLane,gesture:Qe.gesture,action:Qe.action,hasEagerState:Qe.hasEagerState,eagerState:Qe.eagerState,next:null},Te===null?(ue=Te=tt,G=j):Te=Te.next=tt,ur.lanes|=_t,Hc|=_t;Qe=Qe.next}while(Qe!==null&&Qe!==u);if(Te===null?G=j:Te.next=ue,!Un(j,i.memoizedState)&&(On=!0,dt&&(h=N,h!==null)))throw h;i.memoizedState=j,i.baseState=G,i.baseQueue=Te,p.lastRenderedState=j}return S===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function cd(i){var u=Wa(),h=u.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=i;var p=h.dispatch,S=h.pending,j=u.memoizedState;if(S!==null){h.pending=null;var G=S=S.next;do j=i(j,G.action),G=G.next;while(G!==S);Un(j,u.memoizedState)||(On=!0),u.memoizedState=j,u.baseQueue===null&&(u.baseState=j),h.lastRenderedState=j}return[j,p]}function ud(i,u,h){var p=ur,S=Wa(),j=Br;if(j){if(h===void 0)throw Error(a(407));h=h()}else h=u();var G=!Un((fr||S).memoizedState,h);if(G&&(S.memoizedState=h,On=!0),S=S.queue,R1(Ah.bind(null,p,S,i),[i]),S.getSnapshot!==u||G||Xr!==null&&Xr.memoizedState.tag&1){if(p.flags|=2048,Gl(9,{destroy:void 0},Eh.bind(null,p,S,h,u),null),Ea===null)throw Error(a(349));j||($a&127)!==0||Po(p,u,h)}return h}function Po(i,u,h){i.flags|=16384,i={getSnapshot:u,value:h},u=ur.updateQueue,u===null?(u=Vu(),ur.updateQueue=u,u.stores=[i]):(h=u.stores,h===null?u.stores=[i]:h.push(i))}function Eh(i,u,h,p){u.value=h,u.getSnapshot=p,um(u)&&Ch(i)}function Ah(i,u,h){return h(function(){um(u)&&Ch(i)})}function um(i){var u=i.getSnapshot;i=i.value;try{var h=u();return!Un(i,h)}catch{return!0}}function Ch(i){var u=Do(i,2);u!==null&&ui(u,i,2)}function pl(i){var u=Tn();if(typeof i=="function"){var h=i;if(i=h(),ms){Ce(!0);try{h()}finally{Ce(!1)}}}return u.memoizedState=u.baseState=i,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:i},u}function fm(i,u,h,p){return i.baseState=h,Ic(i,fr,typeof p=="function"?p:eo)}function dm(i,u,h,p,S){if(gm(i))throw Error(a(485));if(i=u.action,i!==null){var j={payload:S,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(G){j.listeners.push(G)}};X.T!==null?h(!0):j.isTransition=!1,p(j),h=u.pending,h===null?(j.next=u.pending=j,hm(u,j)):(j.next=h.next,u.pending=h.next=j)}}function hm(i,u){var h=u.action,p=u.payload,S=i.state;if(u.isTransition){var j=X.T,G={};X.T=G;try{var ue=h(S,p),Te=X.S;Te!==null&&Te(G,ue),Th(i,u,ue)}catch(Qe){Vl(i,u,Qe)}finally{j!==null&&G.types!==null&&(j.types=G.types),X.T=j}}else try{j=h(S,p),Th(i,u,j)}catch(Qe){Vl(i,u,Qe)}}function Th(i,u,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(p){mm(i,u,p)},function(p){return Vl(i,u,p)}):mm(i,u,h)}function mm(i,u,h){u.status="fulfilled",u.value=h,fd(u),i.state=h,u=i.pending,u!==null&&(h=u.next,h===u?i.pending=null:(h=h.next,u.next=h,hm(i,h)))}function Vl(i,u,h){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do u.status="rejected",u.reason=h,fd(u),u=u.next;while(u!==p)}i.action=null}function fd(i){i=i.listeners;for(var u=0;u<i.length;u++)(0,i[u])()}function Gu(i,u){return u}function to(i,u){if(Br){var h=Ea.formState;if(h!==null){e:{var p=ur;if(Br){if(ka){t:{for(var S=ka,j=Ha;S.nodeType!==8;){if(!j){S=null;break t}if(S=ro(S.nextSibling),S===null){S=null;break t}}j=S.data,S=j==="F!"||j==="F"?S:null}if(S){ka=ro(S.nextSibling),p=S.data==="F!";break e}}ol(p)}p=!1}p&&(u=h[0])}}return h=Tn(),h.memoizedState=h.baseState=u,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gu,lastRenderedState:u},h.queue=p,h=cy.bind(null,ur,p),p.dispatch=h,p=pl(!1),j=M1.bind(null,ur,!1,p.queue),p=Tn(),S={state:u,dispatch:null,action:i,pending:null},p.queue=S,h=dm.bind(null,ur,S,j,h),S.dispatch=h,p.memoizedState=i,[u,h,!1]}function Mo(i){var u=Wa();return Io(u,fr,i)}function Io(i,u,h){if(u=Ic(i,u,Gu)[0],i=ld(eo)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var p=ml(u)}catch(G){throw G===Fe?je:G}else p=u;u=Wa();var S=u.queue,j=S.dispatch;return h!==u.memoizedState&&(ur.flags|=2048,Gl(9,{destroy:void 0},dd.bind(null,S,h),null)),[p,j,i]}function dd(i,u){i.action=u}function hd(i){var u=Wa(),h=fr;if(h!==null)return Io(u,h,i);Wa(),u=u.memoizedState,h=Wa();var p=h.queue.dispatch;return h.memoizedState=i,[u,p,!1]}function Gl(i,u,h,p){return i={tag:i,create:h,deps:p,inst:u,next:null},u=ur.updateQueue,u===null&&(u=Vu(),ur.updateQueue=u),h=u.lastEffect,h===null?u.lastEffect=i.next=i:(p=h.next,h.next=i,i.next=p,u.lastEffect=i),i}function pm(){return Wa().memoizedState}function Bc(i,u,h,p){var S=Tn();ur.flags|=i,S.memoizedState=Gl(1|u,{destroy:void 0},h,p===void 0?null:p)}function Uc(i,u,h,p){var S=Wa();p=p===void 0?null:p;var j=S.memoizedState.inst;fr!==null&&p!==null&&Sh(p,fr.memoizedState.deps)?S.memoizedState=Gl(u,j,h,p):(ur.flags|=i,S.memoizedState=Gl(1|u,j,h,p))}function X2(i,u){Bc(8390656,8,i,u)}function R1(i,u){Uc(2048,8,i,u)}function yj(i){ur.flags|=4;var u=ur.updateQueue;if(u===null)u=Vu(),ur.updateQueue=u,u.events=[i];else{var h=u.events;h===null?u.events=[i]:h.push(i)}}function K2(i){var u=Wa().memoizedState;return yj({ref:u,nextImpl:i}),function(){if((la&2)!==0)throw Error(a(440));return u.impl.apply(void 0,arguments)}}function J2(i,u){return Uc(4,2,i,u)}function Z2(i,u){return Uc(4,4,i,u)}function Q2(i,u){if(typeof u=="function"){i=i();var h=u(i);return function(){typeof h=="function"?h():u(null)}}if(u!=null)return i=i(),u.current=i,function(){u.current=null}}function ey(i,u,h){h=h!=null?h.concat([i]):null,Uc(4,4,Q2.bind(null,u,i),h)}function D1(){}function ty(i,u){var h=Wa();u=u===void 0?null:u;var p=h.memoizedState;return u!==null&&Sh(u,p[1])?p[0]:(h.memoizedState=[i,u],i)}function ry(i,u){var h=Wa();u=u===void 0?null:u;var p=h.memoizedState;if(u!==null&&Sh(u,p[1]))return p[0];if(p=i(),ms){Ce(!0);try{i()}finally{Ce(!1)}}return h.memoizedState=[p,u],p}function F1(i,u,h){return h===void 0||($a&1073741824)!==0&&(zr&261930)===0?i.memoizedState=u:(i.memoizedState=h,i=a_(),ur.lanes|=i,Hc|=i,h)}function ay(i,u,h,p){return Un(h,u)?h:Fr.current!==null?(i=F1(i,h,p),Un(i,u)||(On=!0),i):($a&42)===0||($a&1073741824)!==0&&(zr&261930)===0?(On=!0,i.memoizedState=h):(i=a_(),ur.lanes|=i,Hc|=i,u)}function ny(i,u,h,p,S){var j=Z.p;Z.p=j!==0&&8>j?j:8;var G=X.T,ue={};X.T=ue,M1(i,!1,u,h);try{var Te=S(),Qe=X.S;if(Qe!==null&&Qe(ue,Te),Te!==null&&typeof Te=="object"&&typeof Te.then=="function"){var dt=ee(Te,p);Oh(i,u,dt,Ai(i))}else Oh(i,u,p,Ai(i))}catch(_t){Oh(i,u,{then:function(){},status:"rejected",reason:_t},Ai())}finally{Z.p=j,G!==null&&ue.types!==null&&(G.types=ue.types),X.T=G}}function _j(){}function L1(i,u,h,p){if(i.tag!==5)throw Error(a(476));var S=sy(i).queue;ny(i,S,u,K,h===null?_j:function(){return iy(i),h(p)})}function sy(i){var u=i.memoizedState;if(u!==null)return u;u={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:K},next:null};var h={};return u.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:h},next:null},i.memoizedState=u,i=i.alternate,i!==null&&(i.memoizedState=u),u}function iy(i){var u=sy(i);u.next===null&&(u=i.alternate.memoizedState),Oh(i,u.next.queue,{},Ai())}function P1(){return $n(Yh)}function oy(){return Wa().memoizedState}function ly(){return Wa().memoizedState}function bj(i){for(var u=i.return;u!==null;){switch(u.tag){case 24:case 3:var h=Ai();i=gr(h);var p=Tr(u,i,h);p!==null&&(ui(p,u,h),ia(p,u,h)),u={cache:Pc()},i.payload=u;return}u=u.return}}function wj(i,u,h){var p=Ai();h={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},gm(i)?uy(u,h):(h=Yf(i,u,h,p),h!==null&&(ui(h,i,p),fy(h,u,p)))}function cy(i,u,h){var p=Ai();Oh(i,u,h,p)}function Oh(i,u,h,p){var S={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(gm(i))uy(u,S);else{var j=i.alternate;if(i.lanes===0&&(j===null||j.lanes===0)&&(j=u.lastRenderedReducer,j!==null))try{var G=u.lastRenderedState,ue=j(G,h);if(S.hasEagerState=!0,S.eagerState=ue,Un(ue,G))return Bu(i,u,S,0),Ea===null&&Iu(),!1}catch{}finally{}if(h=Yf(i,u,S,p),h!==null)return ui(h,i,p),fy(h,u,p),!0}return!1}function M1(i,u,h,p){if(p={lane:2,revertLane:pg(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},gm(i)){if(u)throw Error(a(479))}else u=Yf(i,h,p,2),u!==null&&ui(u,i,2)}function gm(i){var u=i.alternate;return i===ur||u!==null&&u===ur}function uy(i,u){si=Ss=!0;var h=i.pending;h===null?u.next=u:(u.next=h.next,h.next=u),i.pending=u}function fy(i,u,h){if((h&4194048)!==0){var p=u.lanes;p&=i.pendingLanes,h|=p,u.lanes=h,rn(i,h)}}var Rh={readContext:$n,use:Mc,useCallback:_a,useContext:_a,useEffect:_a,useImperativeHandle:_a,useLayoutEffect:_a,useInsertionEffect:_a,useMemo:_a,useReducer:_a,useRef:_a,useState:_a,useDebugValue:_a,useDeferredValue:_a,useTransition:_a,useSyncExternalStore:_a,useId:_a,useHostTransitionStatus:_a,useFormState:_a,useActionState:_a,useOptimistic:_a,useMemoCache:_a,useCacheRefresh:_a};Rh.useEffectEvent=_a;var dy={readContext:$n,use:Mc,useCallback:function(i,u){return Tn().memoizedState=[i,u===void 0?null:u],i},useContext:$n,useEffect:X2,useImperativeHandle:function(i,u,h){h=h!=null?h.concat([i]):null,Bc(4194308,4,Q2.bind(null,u,i),h)},useLayoutEffect:function(i,u){return Bc(4194308,4,i,u)},useInsertionEffect:function(i,u){Bc(4,2,i,u)},useMemo:function(i,u){var h=Tn();u=u===void 0?null:u;var p=i();if(ms){Ce(!0);try{i()}finally{Ce(!1)}}return h.memoizedState=[p,u],p},useReducer:function(i,u,h){var p=Tn();if(h!==void 0){var S=h(u);if(ms){Ce(!0);try{h(u)}finally{Ce(!1)}}}else S=u;return p.memoizedState=p.baseState=S,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:S},p.queue=i,i=i.dispatch=wj.bind(null,ur,i),[p.memoizedState,i]},useRef:function(i){var u=Tn();return i={current:i},u.memoizedState=i},useState:function(i){i=pl(i);var u=i.queue,h=cy.bind(null,ur,u);return u.dispatch=h,[i.memoizedState,h]},useDebugValue:D1,useDeferredValue:function(i,u){var h=Tn();return F1(h,i,u)},useTransition:function(){var i=pl(!1);return i=ny.bind(null,ur,i.queue,!0,!1),Tn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,u,h){var p=ur,S=Tn();if(Br){if(h===void 0)throw Error(a(407));h=h()}else{if(h=u(),Ea===null)throw Error(a(349));(zr&127)!==0||Po(p,u,h)}S.memoizedState=h;var j={value:h,getSnapshot:u};return S.queue=j,X2(Ah.bind(null,p,j,i),[i]),p.flags|=2048,Gl(9,{destroy:void 0},Eh.bind(null,p,j,h,u),null),h},useId:function(){var i=Tn(),u=Ea.identifierPrefix;if(Br){var h=ai,p=ri;h=(p&~(1<<32-Ve(p)-1)).toString(32)+h,u="_"+u+"R_"+h,h=un++,0<h&&(u+="H"+h.toString(32)),u+="_"}else h=sd++,u="_"+u+"r_"+h.toString(32)+"_";return i.memoizedState=u},useHostTransitionStatus:P1,useFormState:to,useActionState:to,useOptimistic:function(i){var u=Tn();u.memoizedState=u.baseState=i;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=h,u=M1.bind(null,ur,!0,h),h.dispatch=u,[i,u]},useMemoCache:Wl,useCacheRefresh:function(){return Tn().memoizedState=bj.bind(null,ur)},useEffectEvent:function(i){var u=Tn(),h={impl:i};return u.memoizedState=h,function(){if((la&2)!==0)throw Error(a(440));return h.impl.apply(void 0,arguments)}}},I1={readContext:$n,use:Mc,useCallback:ty,useContext:$n,useEffect:R1,useImperativeHandle:ey,useInsertionEffect:J2,useLayoutEffect:Z2,useMemo:ry,useReducer:ld,useRef:pm,useState:function(){return ld(eo)},useDebugValue:D1,useDeferredValue:function(i,u){var h=Wa();return ay(h,fr.memoizedState,i,u)},useTransition:function(){var i=ld(eo)[0],u=Wa().memoizedState;return[typeof i=="boolean"?i:ml(i),u]},useSyncExternalStore:ud,useId:oy,useHostTransitionStatus:P1,useFormState:Mo,useActionState:Mo,useOptimistic:function(i,u){var h=Wa();return fm(h,fr,i,u)},useMemoCache:Wl,useCacheRefresh:ly};I1.useEffectEvent=K2;var hy={readContext:$n,use:Mc,useCallback:ty,useContext:$n,useEffect:R1,useImperativeHandle:ey,useInsertionEffect:J2,useLayoutEffect:Z2,useMemo:ry,useReducer:cd,useRef:pm,useState:function(){return cd(eo)},useDebugValue:D1,useDeferredValue:function(i,u){var h=Wa();return fr===null?F1(h,i,u):ay(h,fr.memoizedState,i,u)},useTransition:function(){var i=cd(eo)[0],u=Wa().memoizedState;return[typeof i=="boolean"?i:ml(i),u]},useSyncExternalStore:ud,useId:oy,useHostTransitionStatus:P1,useFormState:hd,useActionState:hd,useOptimistic:function(i,u){var h=Wa();return fr!==null?fm(h,fr,i,u):(h.baseState=i,[i,h.queue.dispatch])},useMemoCache:Wl,useCacheRefresh:ly};hy.useEffectEvent=K2;function B1(i,u,h,p){u=i.memoizedState,h=h(p,u),h=h==null?u:v({},u,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var U1={enqueueSetState:function(i,u,h){i=i._reactInternals;var p=Ai(),S=gr(p);S.payload=u,h!=null&&(S.callback=h),u=Tr(i,S,p),u!==null&&(ui(u,i,p),ia(u,i,p))},enqueueReplaceState:function(i,u,h){i=i._reactInternals;var p=Ai(),S=gr(p);S.tag=1,S.payload=u,h!=null&&(S.callback=h),u=Tr(i,S,p),u!==null&&(ui(u,i,p),ia(u,i,p))},enqueueForceUpdate:function(i,u){i=i._reactInternals;var h=Ai(),p=gr(h);p.tag=2,u!=null&&(p.callback=u),u=Tr(i,p,h),u!==null&&(ui(u,i,h),ia(u,i,h))}};function my(i,u,h,p,S,j,G){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,j,G):u.prototype&&u.prototype.isPureReactComponent?!Co(h,p)||!Co(S,j):!0}function py(i,u,h,p){i=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(h,p),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(h,p),u.state!==i&&U1.enqueueReplaceState(u,u.state,null)}function Yu(i,u){var h=u;if("ref"in u){h={};for(var p in u)p!=="ref"&&(h[p]=u[p])}if(i=i.defaultProps){h===u&&(h=v({},h));for(var S in i)h[S]===void 0&&(h[S]=i[S])}return h}function gy(i){Mu(i)}function vy(i){console.error(i)}function xy(i){Mu(i)}function vm(i,u){try{var h=i.onUncaughtError;h(u.value,{componentStack:u.stack})}catch(p){setTimeout(function(){throw p})}}function yy(i,u,h){try{var p=i.onCaughtError;p(h.value,{componentStack:h.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function q1(i,u,h){return h=gr(h),h.tag=3,h.payload={element:null},h.callback=function(){vm(i,u)},h}function _y(i){return i=gr(i),i.tag=3,i}function by(i,u,h,p){var S=h.type.getDerivedStateFromError;if(typeof S=="function"){var j=p.value;i.payload=function(){return S(j)},i.callback=function(){yy(u,h,p)}}var G=h.stateNode;G!==null&&typeof G.componentDidCatch=="function"&&(i.callback=function(){yy(u,h,p),typeof S!="function"&&($c===null?$c=new Set([this]):$c.add(this));var ue=p.stack;this.componentDidCatch(p.value,{componentStack:ue!==null?ue:""})})}function Sj(i,u,h,p,S){if(h.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(u=h.alternate,u!==null&&ul(u,h,S,!0),h=Pa.current,h!==null){switch(h.tag){case 31:case 13:return Yr===null?Cm():h.alternate===null&&fn===0&&(fn=3),h.flags&=-257,h.flags|=65536,h.lanes=S,p===Ie?h.flags|=16384:(u=h.updateQueue,u===null?h.updateQueue=new Set([p]):u.add(p),dg(i,p,S)),!1;case 22:return h.flags|=65536,p===Ie?h.flags|=16384:(u=h.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([p])},h.updateQueue=u):(h=u.retryQueue,h===null?u.retryQueue=new Set([p]):h.add(p)),dg(i,p,S)),!1}throw Error(a(435,h.tag))}return dg(i,p,S),Cm(),!1}if(Br)return u=Pa.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=S,p!==ki&&(i=Error(a(422),{cause:p}),Fc(Qs(i,h)))):(p!==ki&&(u=Error(a(423),{cause:p}),Fc(Qs(u,h))),i=i.current.alternate,i.flags|=65536,S&=-S,i.lanes|=S,p=Qs(p,h),S=q1(i.stateNode,p,S),xn(i,S),fn!==4&&(fn=2)),!1;var j=Error(a(520),{cause:p});if(j=Qs(j,h),Uh===null?Uh=[j]:Uh.push(j),fn!==4&&(fn=2),u===null)return!0;p=Qs(p,h),h=u;do{switch(h.tag){case 3:return h.flags|=65536,i=S&-S,h.lanes|=i,i=q1(h.stateNode,p,i),xn(h,i),!1;case 1:if(u=h.type,j=h.stateNode,(h.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&($c===null||!$c.has(j))))return h.flags|=65536,S&=-S,h.lanes|=S,S=_y(S),by(S,i,h,p),xn(h,S),!1}h=h.return}while(h!==null);return!1}var z1=Error(a(461)),On=!1;function ps(i,u,h,p){u.child=i===null?Er(u,null,h,p):ja(u,i.child,h,p)}function wy(i,u,h,p,S){h=h.render;var j=u.ref;if("ref"in p){var G={};for(var ue in p)ue!=="ref"&&(G[ue]=p[ue])}else G=p;return fl(u),p=Nh(i,u,h,G,j,S),ue=kh(),i!==null&&!On?(jh(i,u,S),Yl(i,u,S)):(Br&&ue&&_h(u),u.flags|=1,ps(i,u,p,S),u.child)}function Sy(i,u,h,p,S){if(i===null){var j=h.type;return typeof j=="function"&&!Kf(j)&&j.defaultProps===void 0&&h.compare===null?(u.tag=15,u.type=j,Ny(i,u,j,p,S)):(i=Oc(h.type,null,p,u,u.mode,S),i.ref=u.ref,i.return=u,u.child=i)}if(j=i.child,!K1(i,S)){var G=j.memoizedProps;if(h=h.compare,h=h!==null?h:Co,h(G,p)&&i.ref===u.ref)return Yl(i,u,S)}return u.flags|=1,i=Zs(j,p),i.ref=u.ref,i.return=u,u.child=i}function Ny(i,u,h,p,S){if(i!==null){var j=i.memoizedProps;if(Co(j,p)&&i.ref===u.ref)if(On=!1,u.pendingProps=p=j,K1(i,S))(i.flags&131072)!==0&&(On=!0);else return u.lanes=i.lanes,Yl(i,u,S)}return H1(i,u,h,p,S)}function ky(i,u,h,p){var S=p.children,j=i!==null?i.memoizedState:null;if(i===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((u.flags&128)!==0){if(j=j!==null?j.baseLanes|h:h,i!==null){for(p=u.child=i.child,S=0;p!==null;)S=S|p.lanes|p.childLanes,p=p.sibling;p=S&~j}else p=0,u.child=null;return jy(i,u,j,h,p)}if((h&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},i!==null&&be(u,j!==null?j.cachePool:null),j!==null?La(u,j):Zr(),ln(u);else return p=u.lanes=536870912,jy(i,u,j!==null?j.baseLanes|h:h,h,p)}else j!==null?(be(u,j.cachePool),La(u,j),cn(),u.memoizedState=null):(i!==null&&be(u,null),Zr(),cn());return ps(i,u,S,h),u.child}function Dh(i,u){return i!==null&&i.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function jy(i,u,h,p,S){var j=me();return j=j===null?null:{parent:Ja._currentValue,pool:j},u.memoizedState={baseLanes:h,cachePool:j},i!==null&&be(u,null),Zr(),ln(u),i!==null&&ul(i,u,p,!0),u.childLanes=S,null}function xm(i,u){return u=_m({mode:u.mode,children:u.children},i.mode),u.ref=i.ref,i.child=u,u.return=i,u}function Ey(i,u,h){return ja(u,i.child,null,h),i=xm(u,u.pendingProps),i.flags|=2,ua(u),u.memoizedState=null,i}function Nj(i,u,h){var p=u.pendingProps,S=(u.flags&128)!==0;if(u.flags&=-129,i===null){if(Br){if(p.mode==="hidden")return i=xm(u,p),u.lanes=536870912,Dh(null,i);if(oa(u),(i=ka)?(i=B_(i,Ha),i=i!==null&&i.data==="&"?i:null,i!==null&&(u.memoizedState={dehydrated:i,treeContext:il!==null?{id:ri,overflow:ai}:null,retryLane:536870912,hydrationErrors:null},h=Jf(i),h.return=u,u.child=h,zn=u,ka=null)):i=null,i===null)throw ol(u);return u.lanes=536870912,null}return xm(u,p)}var j=i.memoizedState;if(j!==null){var G=j.dehydrated;if(oa(u),S)if(u.flags&256)u.flags&=-257,u=Ey(i,u,h);else if(u.memoizedState!==null)u.child=i.child,u.flags|=128,u=null;else throw Error(a(558));else if(On||ul(i,u,h,!1),S=(h&i.childLanes)!==0,On||S){if(p=Ea,p!==null&&(G=Mn(p,h),G!==0&&G!==j.retryLane))throw j.retryLane=G,Do(i,G),ui(p,i,G),z1;Cm(),u=Ey(i,u,h)}else i=j.treeContext,ka=ro(G.nextSibling),zn=u,Br=!0,hs=null,Ha=!1,i!==null&&lm(u,i),u=xm(u,p),u.flags|=4096;return u}return i=Zs(i.child,{mode:p.mode,children:p.children}),i.ref=u.ref,u.child=i,i.return=u,i}function ym(i,u){var h=u.ref;if(h===null)i!==null&&i.ref!==null&&(u.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(a(284));(i===null||i.ref!==h)&&(u.flags|=4194816)}}function H1(i,u,h,p,S){return fl(u),h=Nh(i,u,h,p,void 0,S),p=kh(),i!==null&&!On?(jh(i,u,S),Yl(i,u,S)):(Br&&p&&_h(u),u.flags|=1,ps(i,u,h,S),u.child)}function Ay(i,u,h,p,S,j){return fl(u),u.updateQueue=null,h=Lo(u,p,h,S),id(i),p=kh(),i!==null&&!On?(jh(i,u,j),Yl(i,u,j)):(Br&&p&&_h(u),u.flags|=1,ps(i,u,h,j),u.child)}function Cy(i,u,h,p,S){if(fl(u),u.stateNode===null){var j=qn,G=h.contextType;typeof G=="object"&&G!==null&&(j=$n(G)),j=new h(p,j),u.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,j.updater=U1,u.stateNode=j,j._reactInternals=u,j=u.stateNode,j.props=p,j.state=u.memoizedState,j.refs={},Bt(u),G=h.contextType,j.context=typeof G=="object"&&G!==null?$n(G):qn,j.state=u.memoizedState,G=h.getDerivedStateFromProps,typeof G=="function"&&(B1(u,h,G,p),j.state=u.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof j.getSnapshotBeforeUpdate=="function"||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(G=j.state,typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount(),G!==j.state&&U1.enqueueReplaceState(j,j.state,null),sn(u,p,j,S),ya(),j.state=u.memoizedState),typeof j.componentDidMount=="function"&&(u.flags|=4194308),p=!0}else if(i===null){j=u.stateNode;var ue=u.memoizedProps,Te=Yu(h,ue);j.props=Te;var Qe=j.context,dt=h.contextType;G=qn,typeof dt=="object"&&dt!==null&&(G=$n(dt));var _t=h.getDerivedStateFromProps;dt=typeof _t=="function"||typeof j.getSnapshotBeforeUpdate=="function",ue=u.pendingProps!==ue,dt||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(ue||Qe!==G)&&py(u,j,p,G),Gt=!1;var tt=u.memoizedState;j.state=tt,sn(u,p,j,S),ya(),Qe=u.memoizedState,ue||tt!==Qe||Gt?(typeof _t=="function"&&(B1(u,h,_t,p),Qe=u.memoizedState),(Te=Gt||my(u,h,Te,p,tt,Qe,G))?(dt||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(u.flags|=4194308)):(typeof j.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=p,u.memoizedState=Qe),j.props=p,j.state=Qe,j.context=G,p=Te):(typeof j.componentDidMount=="function"&&(u.flags|=4194308),p=!1)}else{j=u.stateNode,Fa(i,u),G=u.memoizedProps,dt=Yu(h,G),j.props=dt,_t=u.pendingProps,tt=j.context,Qe=h.contextType,Te=qn,typeof Qe=="object"&&Qe!==null&&(Te=$n(Qe)),ue=h.getDerivedStateFromProps,(Qe=typeof ue=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(G!==_t||tt!==Te)&&py(u,j,p,Te),Gt=!1,tt=u.memoizedState,j.state=tt,sn(u,p,j,S),ya();var rt=u.memoizedState;G!==_t||tt!==rt||Gt||i!==null&&i.dependencies!==null&&rd(i.dependencies)?(typeof ue=="function"&&(B1(u,h,ue,p),rt=u.memoizedState),(dt=Gt||my(u,h,dt,p,tt,rt,Te)||i!==null&&i.dependencies!==null&&rd(i.dependencies))?(Qe||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(p,rt,Te),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(p,rt,Te)),typeof j.componentDidUpdate=="function"&&(u.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof j.componentDidUpdate!="function"||G===i.memoizedProps&&tt===i.memoizedState||(u.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||G===i.memoizedProps&&tt===i.memoizedState||(u.flags|=1024),u.memoizedProps=p,u.memoizedState=rt),j.props=p,j.state=rt,j.context=Te,p=dt):(typeof j.componentDidUpdate!="function"||G===i.memoizedProps&&tt===i.memoizedState||(u.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||G===i.memoizedProps&&tt===i.memoizedState||(u.flags|=1024),p=!1)}return j=p,ym(i,u),p=(u.flags&128)!==0,j||p?(j=u.stateNode,h=p&&typeof h.getDerivedStateFromError!="function"?null:j.render(),u.flags|=1,i!==null&&p?(u.child=ja(u,i.child,null,S),u.child=ja(u,null,h,S)):ps(i,u,h,S),u.memoizedState=j.state,i=u.child):i=Yl(i,u,S),i}function Ty(i,u,h,p){return Hl(),u.flags|=256,ps(i,u,h,p),u.child}var $1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function W1(i){return{baseLanes:i,cachePool:Ee()}}function V1(i,u,h){return i=i!==null?i.childLanes&~h:0,u&&(i|=Ei),i}function Oy(i,u,h){var p=u.pendingProps,S=!1,j=(u.flags&128)!==0,G;if((G=j)||(G=i!==null&&i.memoizedState===null?!1:(Vr.current&2)!==0),G&&(S=!0,u.flags&=-129),G=(u.flags&32)!==0,u.flags&=-33,i===null){if(Br){if(S?Za(u):cn(),(i=ka)?(i=B_(i,Ha),i=i!==null&&i.data!=="&"?i:null,i!==null&&(u.memoizedState={dehydrated:i,treeContext:il!==null?{id:ri,overflow:ai}:null,retryLane:536870912,hydrationErrors:null},h=Jf(i),h.return=u,u.child=h,zn=u,ka=null)):i=null,i===null)throw ol(u);return Ag(i)?u.lanes=32:u.lanes=536870912,null}var ue=p.children;return p=p.fallback,S?(cn(),S=u.mode,ue=_m({mode:"hidden",children:ue},S),p=sl(p,S,h,null),ue.return=u,p.return=u,ue.sibling=p,u.child=ue,p=u.child,p.memoizedState=W1(h),p.childLanes=V1(i,G,h),u.memoizedState=$1,Dh(null,p)):(Za(u),G1(u,ue))}var Te=i.memoizedState;if(Te!==null&&(ue=Te.dehydrated,ue!==null)){if(j)u.flags&256?(Za(u),u.flags&=-257,u=Y1(i,u,h)):u.memoizedState!==null?(cn(),u.child=i.child,u.flags|=128,u=null):(cn(),ue=p.fallback,S=u.mode,p=_m({mode:"visible",children:p.children},S),ue=sl(ue,S,h,null),ue.flags|=2,p.return=u,ue.return=u,p.sibling=ue,u.child=p,ja(u,i.child,null,h),p=u.child,p.memoizedState=W1(h),p.childLanes=V1(i,G,h),u.memoizedState=$1,u=Dh(null,p));else if(Za(u),Ag(ue)){if(G=ue.nextSibling&&ue.nextSibling.dataset,G)var Qe=G.dgst;G=Qe,p=Error(a(419)),p.stack="",p.digest=G,Fc({value:p,source:null,stack:null}),u=Y1(i,u,h)}else if(On||ul(i,u,h,!1),G=(h&i.childLanes)!==0,On||G){if(G=Ea,G!==null&&(p=Mn(G,h),p!==0&&p!==Te.retryLane))throw Te.retryLane=p,Do(i,p),ui(G,i,p),z1;Eg(ue)||Cm(),u=Y1(i,u,h)}else Eg(ue)?(u.flags|=192,u.child=i.child,u=null):(i=Te.treeContext,ka=ro(ue.nextSibling),zn=u,Br=!0,hs=null,Ha=!1,i!==null&&lm(u,i),u=G1(u,p.children),u.flags|=4096);return u}return S?(cn(),ue=p.fallback,S=u.mode,Te=i.child,Qe=Te.sibling,p=Zs(Te,{mode:"hidden",children:p.children}),p.subtreeFlags=Te.subtreeFlags&65011712,Qe!==null?ue=Zs(Qe,ue):(ue=sl(ue,S,h,null),ue.flags|=2),ue.return=u,p.return=u,p.sibling=ue,u.child=p,Dh(null,p),p=u.child,ue=i.child.memoizedState,ue===null?ue=W1(h):(S=ue.cachePool,S!==null?(Te=Ja._currentValue,S=S.parent!==Te?{parent:Te,pool:Te}:S):S=Ee(),ue={baseLanes:ue.baseLanes|h,cachePool:S}),p.memoizedState=ue,p.childLanes=V1(i,G,h),u.memoizedState=$1,Dh(i.child,p)):(Za(u),h=i.child,i=h.sibling,h=Zs(h,{mode:"visible",children:p.children}),h.return=u,h.sibling=null,i!==null&&(G=u.deletions,G===null?(u.deletions=[i],u.flags|=16):G.push(i)),u.child=h,u.memoizedState=null,h)}function G1(i,u){return u=_m({mode:"visible",children:u},i.mode),u.return=i,i.child=u}function _m(i,u){return i=Qn(22,i,null,u),i.lanes=0,i}function Y1(i,u,h){return ja(u,i.child,null,h),i=G1(u,u.pendingProps.children),i.flags|=2,u.memoizedState=null,i}function Ry(i,u,h){i.lanes|=u;var p=i.alternate;p!==null&&(p.lanes|=u),Lc(i.return,u,h)}function X1(i,u,h,p,S,j){var G=i.memoizedState;G===null?i.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:S,treeForkCount:j}:(G.isBackwards=u,G.rendering=null,G.renderingStartTime=0,G.last=p,G.tail=h,G.tailMode=S,G.treeForkCount=j)}function Dy(i,u,h){var p=u.pendingProps,S=p.revealOrder,j=p.tail;p=p.children;var G=Vr.current,ue=(G&2)!==0;if(ue?(G=G&1|2,u.flags|=128):G&=1,F(Vr,G),ps(i,u,p,h),p=Br?Hu:0,!ue&&i!==null&&(i.flags&128)!==0)e:for(i=u.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Ry(i,h,u);else if(i.tag===19)Ry(i,h,u);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===u)break e;for(;i.sibling===null;){if(i.return===null||i.return===u)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(S){case"forwards":for(h=u.child,S=null;h!==null;)i=h.alternate,i!==null&&ts(i)===null&&(S=h),h=h.sibling;h=S,h===null?(S=u.child,u.child=null):(S=h.sibling,h.sibling=null),X1(u,!1,S,h,j,p);break;case"backwards":case"unstable_legacy-backwards":for(h=null,S=u.child,u.child=null;S!==null;){if(i=S.alternate,i!==null&&ts(i)===null){u.child=S;break}i=S.sibling,S.sibling=h,h=S,S=i}X1(u,!0,h,null,j,p);break;case"together":X1(u,!1,null,null,void 0,p);break;default:u.memoizedState=null}return u.child}function Yl(i,u,h){if(i!==null&&(u.dependencies=i.dependencies),Hc|=u.lanes,(h&u.childLanes)===0)if(i!==null){if(ul(i,u,h,!1),(h&u.childLanes)===0)return null}else return null;if(i!==null&&u.child!==i.child)throw Error(a(153));if(u.child!==null){for(i=u.child,h=Zs(i,i.pendingProps),u.child=h,h.return=u;i.sibling!==null;)i=i.sibling,h=h.sibling=Zs(i,i.pendingProps),h.return=u;h.sibling=null}return u.child}function K1(i,u){return(i.lanes&u)!==0?!0:(i=i.dependencies,!!(i!==null&&rd(i)))}function kj(i,u,h){switch(u.tag){case 3:pe(u,u.stateNode.containerInfo),cl(u,Ja,i.memoizedState.cache),Hl();break;case 27:case 5:_e(u);break;case 4:pe(u,u.stateNode.containerInfo);break;case 10:cl(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,oa(u),null;break;case 13:var p=u.memoizedState;if(p!==null)return p.dehydrated!==null?(Za(u),u.flags|=128,null):(h&u.child.childLanes)!==0?Oy(i,u,h):(Za(u),i=Yl(i,u,h),i!==null?i.sibling:null);Za(u);break;case 19:var S=(i.flags&128)!==0;if(p=(h&u.childLanes)!==0,p||(ul(i,u,h,!1),p=(h&u.childLanes)!==0),S){if(p)return Dy(i,u,h);u.flags|=128}if(S=u.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),F(Vr,Vr.current),p)break;return null;case 22:return u.lanes=0,ky(i,u,h,u.pendingProps);case 24:cl(u,Ja,i.memoizedState.cache)}return Yl(i,u,h)}function Fy(i,u,h){if(i!==null)if(i.memoizedProps!==u.pendingProps)On=!0;else{if(!K1(i,h)&&(u.flags&128)===0)return On=!1,kj(i,u,h);On=(i.flags&131072)!==0}else On=!1,Br&&(u.flags&1048576)!==0&&om(u,Hu,u.index);switch(u.lanes=0,u.tag){case 16:e:{var p=u.pendingProps;if(i=We(u.elementType),u.type=i,typeof i=="function")Kf(i)?(p=Yu(i,p),u.tag=1,u=Cy(null,u,i,p,h)):(u.tag=0,u=H1(null,u,i,p,h));else{if(i!=null){var S=i.$$typeof;if(S===R){u.tag=11,u=wy(null,u,i,p,h);break e}else if(S===B){u.tag=14,u=Sy(null,u,i,p,h);break e}}throw u=V(i)||i,Error(a(306,u,""))}}return u;case 0:return H1(i,u,u.type,u.pendingProps,h);case 1:return p=u.type,S=Yu(p,u.pendingProps),Cy(i,u,p,S,h);case 3:e:{if(pe(u,u.stateNode.containerInfo),i===null)throw Error(a(387));p=u.pendingProps;var j=u.memoizedState;S=j.element,Fa(i,u),sn(u,p,null,h);var G=u.memoizedState;if(p=G.cache,cl(u,Ja,p),p!==j.cache&&$l(u,[Ja],h,!0),ya(),p=G.element,j.isDehydrated)if(j={element:p,isDehydrated:!1,cache:G.cache},u.updateQueue.baseState=j,u.memoizedState=j,u.flags&256){u=Ty(i,u,p,h);break e}else if(p!==S){S=Qs(Error(a(424)),u),Fc(S),u=Ty(i,u,p,h);break e}else{switch(i=u.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(ka=ro(i.firstChild),zn=u,Br=!0,hs=null,Ha=!0,h=Er(u,null,p,h),u.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Hl(),p===S){u=Yl(i,u,h);break e}ps(i,u,p,h)}u=u.child}return u;case 26:return ym(i,u),i===null?(h=W_(u.type,null,u.pendingProps,null))?u.memoizedState=h:Br||(h=u.type,i=u.pendingProps,p=Pm(te.current).createElement(h),p[xe]=u,p[Ne]=i,gs(p,h,i),Xt(p),u.stateNode=p):u.memoizedState=W_(u.type,i.memoizedProps,u.pendingProps,i.memoizedState),null;case 27:return _e(u),i===null&&Br&&(p=u.stateNode=z_(u.type,u.pendingProps,te.current),zn=u,Ha=!0,S=ka,Yc(u.type)?(Cg=S,ka=ro(p.firstChild)):ka=S),ps(i,u,u.pendingProps.children,h),ym(i,u),i===null&&(u.flags|=4194304),u.child;case 5:return i===null&&Br&&((S=p=ka)&&(p=tE(p,u.type,u.pendingProps,Ha),p!==null?(u.stateNode=p,zn=u,ka=ro(p.firstChild),Ha=!1,S=!0):S=!1),S||ol(u)),_e(u),S=u.type,j=u.pendingProps,G=i!==null?i.memoizedProps:null,p=j.children,Ng(S,j)?p=null:G!==null&&Ng(S,G)&&(u.flags|=32),u.memoizedState!==null&&(S=Nh(i,u,O1,null,null,h),Yh._currentValue=S),ym(i,u),ps(i,u,p,h),u.child;case 6:return i===null&&Br&&((i=h=ka)&&(h=rE(h,u.pendingProps,Ha),h!==null?(u.stateNode=h,zn=u,ka=null,i=!0):i=!1),i||ol(u)),null;case 13:return Oy(i,u,h);case 4:return pe(u,u.stateNode.containerInfo),p=u.pendingProps,i===null?u.child=ja(u,null,p,h):ps(i,u,p,h),u.child;case 11:return wy(i,u,u.type,u.pendingProps,h);case 7:return ps(i,u,u.pendingProps,h),u.child;case 8:return ps(i,u,u.pendingProps.children,h),u.child;case 12:return ps(i,u,u.pendingProps.children,h),u.child;case 10:return p=u.pendingProps,cl(u,u.type,p.value),ps(i,u,p.children,h),u.child;case 9:return S=u.type._context,p=u.pendingProps.children,fl(u),S=$n(S),p=p(S),u.flags|=1,ps(i,u,p,h),u.child;case 14:return Sy(i,u,u.type,u.pendingProps,h);case 15:return Ny(i,u,u.type,u.pendingProps,h);case 19:return Dy(i,u,h);case 31:return Nj(i,u,h);case 22:return ky(i,u,h,u.pendingProps);case 24:return fl(u),p=$n(Ja),i===null?(S=me(),S===null&&(S=Ea,j=Pc(),S.pooledCache=j,j.refCount++,j!==null&&(S.pooledCacheLanes|=h),S=j),u.memoizedState={parent:p,cache:S},Bt(u),cl(u,Ja,S)):((i.lanes&h)!==0&&(Fa(i,u),sn(u,null,null,h),ya()),S=i.memoizedState,j=u.memoizedState,S.parent!==p?(S={parent:p,cache:p},u.memoizedState=S,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=S),cl(u,Ja,p)):(p=j.cache,cl(u,Ja,p),p!==S.cache&&$l(u,[Ja],h,!0))),ps(i,u,u.pendingProps.children,h),u.child;case 29:throw u.pendingProps}throw Error(a(156,u.tag))}function Xl(i){i.flags|=4}function J1(i,u,h,p,S){if((u=(i.mode&32)!==0)&&(u=!1),u){if(i.flags|=16777216,(S&335544128)===S)if(i.stateNode.complete)i.flags|=8192;else if(o_())i.flags|=8192;else throw it=Ie,Ke}else i.flags&=-16777217}function Ly(i,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!K_(u))if(o_())i.flags|=8192;else throw it=Ie,Ke}function bm(i,u){u!==null&&(i.flags|=4),i.flags&16384&&(u=i.tag!==22?Ct():536870912,i.lanes|=u,vd|=u)}function Fh(i,u){if(!Br)switch(i.tailMode){case"hidden":u=i.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?u||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Ma(i){var u=i.alternate!==null&&i.alternate.child===i.child,h=0,p=0;if(u)for(var S=i.child;S!==null;)h|=S.lanes|S.childLanes,p|=S.subtreeFlags&65011712,p|=S.flags&65011712,S.return=i,S=S.sibling;else for(S=i.child;S!==null;)h|=S.lanes|S.childLanes,p|=S.subtreeFlags,p|=S.flags,S.return=i,S=S.sibling;return i.subtreeFlags|=p,i.childLanes=h,u}function jj(i,u,h){var p=u.pendingProps;switch(ed(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ma(u),null;case 1:return Ma(u),null;case 3:return h=u.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),ni(Ja),ve(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(i===null||i.child===null)&&(Hn(u)?Xl(u):i===null||i.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,wh())),Ma(u),null;case 26:var S=u.type,j=u.memoizedState;return i===null?(Xl(u),j!==null?(Ma(u),Ly(u,j)):(Ma(u),J1(u,S,null,p,h))):j?j!==i.memoizedState?(Xl(u),Ma(u),Ly(u,j)):(Ma(u),u.flags&=-16777217):(i=i.memoizedProps,i!==p&&Xl(u),Ma(u),J1(u,S,i,p,h)),null;case 27:if(Pe(u),h=te.current,S=u.type,i!==null&&u.stateNode!=null)i.memoizedProps!==p&&Xl(u);else{if(!p){if(u.stateNode===null)throw Error(a(166));return Ma(u),null}i=I.current,Hn(u)?bh(u):(i=z_(S,p,h),u.stateNode=i,Xl(u))}return Ma(u),null;case 5:if(Pe(u),S=u.type,i!==null&&u.stateNode!=null)i.memoizedProps!==p&&Xl(u);else{if(!p){if(u.stateNode===null)throw Error(a(166));return Ma(u),null}if(j=I.current,Hn(u))bh(u);else{var G=Pm(te.current);switch(j){case 1:j=G.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:j=G.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":j=G.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":j=G.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":j=G.createElement("div"),j.innerHTML="<script><\/script>",j=j.removeChild(j.firstChild);break;case"select":j=typeof p.is=="string"?G.createElement("select",{is:p.is}):G.createElement("select"),p.multiple?j.multiple=!0:p.size&&(j.size=p.size);break;default:j=typeof p.is=="string"?G.createElement(S,{is:p.is}):G.createElement(S)}}j[xe]=u,j[Ne]=p;e:for(G=u.child;G!==null;){if(G.tag===5||G.tag===6)j.appendChild(G.stateNode);else if(G.tag!==4&&G.tag!==27&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===u)break e;for(;G.sibling===null;){if(G.return===null||G.return===u)break e;G=G.return}G.sibling.return=G.return,G=G.sibling}u.stateNode=j;e:switch(gs(j,S,p),S){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Xl(u)}}return Ma(u),J1(u,u.type,i===null?null:i.memoizedProps,u.pendingProps,h),null;case 6:if(i&&u.stateNode!=null)i.memoizedProps!==p&&Xl(u);else{if(typeof p!="string"&&u.stateNode===null)throw Error(a(166));if(i=te.current,Hn(u)){if(i=u.stateNode,h=u.memoizedProps,p=null,S=zn,S!==null)switch(S.tag){case 27:case 5:p=S.memoizedProps}i[xe]=u,i=!!(i.nodeValue===h||p!==null&&p.suppressHydrationWarning===!0||O_(i.nodeValue,h)),i||ol(u,!0)}else i=Pm(i).createTextNode(p),i[xe]=u,u.stateNode=i}return Ma(u),null;case 31:if(h=u.memoizedState,i===null||i.memoizedState!==null){if(p=Hn(u),h!==null){if(i===null){if(!p)throw Error(a(318));if(i=u.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(557));i[xe]=u}else Hl(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Ma(u),i=!1}else h=wh(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=h),i=!0;if(!i)return u.flags&256?(ua(u),u):(ua(u),null);if((u.flags&128)!==0)throw Error(a(558))}return Ma(u),null;case 13:if(p=u.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(S=Hn(u),p!==null&&p.dehydrated!==null){if(i===null){if(!S)throw Error(a(318));if(S=u.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(a(317));S[xe]=u}else Hl(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Ma(u),S=!1}else S=wh(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=S),S=!0;if(!S)return u.flags&256?(ua(u),u):(ua(u),null)}return ua(u),(u.flags&128)!==0?(u.lanes=h,u):(h=p!==null,i=i!==null&&i.memoizedState!==null,h&&(p=u.child,S=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(S=p.alternate.memoizedState.cachePool.pool),j=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(j=p.memoizedState.cachePool.pool),j!==S&&(p.flags|=2048)),h!==i&&h&&(u.child.flags|=8192),bm(u,u.updateQueue),Ma(u),null);case 4:return ve(),i===null&&yg(u.stateNode.containerInfo),Ma(u),null;case 10:return ni(u.type),Ma(u),null;case 19:if(k(Vr),p=u.memoizedState,p===null)return Ma(u),null;if(S=(u.flags&128)!==0,j=p.rendering,j===null)if(S)Fh(p,!1);else{if(fn!==0||i!==null&&(i.flags&128)!==0)for(i=u.child;i!==null;){if(j=ts(i),j!==null){for(u.flags|=128,Fh(p,!1),i=j.updateQueue,u.updateQueue=i,bm(u,i),u.subtreeFlags=0,i=h,h=u.child;h!==null;)qu(h,i),h=h.sibling;return F(Vr,Vr.current&1|2),Br&&$s(u,p.treeForkCount),u.child}i=i.sibling}p.tail!==null&&Dt()>jm&&(u.flags|=128,S=!0,Fh(p,!1),u.lanes=4194304)}else{if(!S)if(i=ts(j),i!==null){if(u.flags|=128,S=!0,i=i.updateQueue,u.updateQueue=i,bm(u,i),Fh(p,!0),p.tail===null&&p.tailMode==="hidden"&&!j.alternate&&!Br)return Ma(u),null}else 2*Dt()-p.renderingStartTime>jm&&h!==536870912&&(u.flags|=128,S=!0,Fh(p,!1),u.lanes=4194304);p.isBackwards?(j.sibling=u.child,u.child=j):(i=p.last,i!==null?i.sibling=j:u.child=j,p.last=j)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=Dt(),i.sibling=null,h=Vr.current,F(Vr,S?h&1|2:h&1),Br&&$s(u,p.treeForkCount),i):(Ma(u),null);case 22:case 23:return ua(u),yn(),p=u.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(u.flags|=8192):p&&(u.flags|=8192),p?(h&536870912)!==0&&(u.flags&128)===0&&(Ma(u),u.subtreeFlags&6&&(u.flags|=8192)):Ma(u),h=u.updateQueue,h!==null&&bm(u,h.retryQueue),h=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),p=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==h&&(u.flags|=2048),i!==null&&k(le),null;case 24:return h=null,i!==null&&(h=i.memoizedState.cache),u.memoizedState.cache!==h&&(u.flags|=2048),ni(Ja),Ma(u),null;case 25:return null;case 30:return null}throw Error(a(156,u.tag))}function Ej(i,u){switch(ed(u),u.tag){case 1:return i=u.flags,i&65536?(u.flags=i&-65537|128,u):null;case 3:return ni(Ja),ve(),i=u.flags,(i&65536)!==0&&(i&128)===0?(u.flags=i&-65537|128,u):null;case 26:case 27:case 5:return Pe(u),null;case 31:if(u.memoizedState!==null){if(ua(u),u.alternate===null)throw Error(a(340));Hl()}return i=u.flags,i&65536?(u.flags=i&-65537|128,u):null;case 13:if(ua(u),i=u.memoizedState,i!==null&&i.dehydrated!==null){if(u.alternate===null)throw Error(a(340));Hl()}return i=u.flags,i&65536?(u.flags=i&-65537|128,u):null;case 19:return k(Vr),null;case 4:return ve(),null;case 10:return ni(u.type),null;case 22:case 23:return ua(u),yn(),i!==null&&k(le),i=u.flags,i&65536?(u.flags=i&-65537|128,u):null;case 24:return ni(Ja),null;case 25:return null;default:return null}}function Py(i,u){switch(ed(u),u.tag){case 3:ni(Ja),ve();break;case 26:case 27:case 5:Pe(u);break;case 4:ve();break;case 31:u.memoizedState!==null&&ua(u);break;case 13:ua(u);break;case 19:k(Vr);break;case 10:ni(u.type);break;case 22:case 23:ua(u),yn(),i!==null&&k(le);break;case 24:ni(Ja)}}function Lh(i,u){try{var h=u.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var S=p.next;h=S;do{if((h.tag&i)===i){p=void 0;var j=h.create,G=h.inst;p=j(),G.destroy=p}h=h.next}while(h!==S)}}catch(ue){da(u,u.return,ue)}}function qc(i,u,h){try{var p=u.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var j=S.next;p=j;do{if((p.tag&i)===i){var G=p.inst,ue=G.destroy;if(ue!==void 0){G.destroy=void 0,S=u;var Te=h,Qe=ue;try{Qe()}catch(dt){da(S,Te,dt)}}}p=p.next}while(p!==j)}}catch(dt){da(u,u.return,dt)}}function My(i){var u=i.updateQueue;if(u!==null){var h=i.stateNode;try{on(u,h)}catch(p){da(i,i.return,p)}}}function Iy(i,u,h){h.props=Yu(i.type,i.memoizedProps),h.state=i.memoizedState;try{h.componentWillUnmount()}catch(p){da(i,u,p)}}function Ph(i,u){try{var h=i.ref;if(h!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof h=="function"?i.refCleanup=h(p):h.current=p}}catch(S){da(i,u,S)}}function gl(i,u){var h=i.ref,p=i.refCleanup;if(h!==null)if(typeof p=="function")try{p()}catch(S){da(i,u,S)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(S){da(i,u,S)}else h.current=null}function By(i){var u=i.type,h=i.memoizedProps,p=i.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":h.autoFocus&&p.focus();break e;case"img":h.src?p.src=h.src:h.srcSet&&(p.srcset=h.srcSet)}}catch(S){da(i,i.return,S)}}function Z1(i,u,h){try{var p=i.stateNode;Xj(p,i.type,h,u),p[Ne]=u}catch(S){da(i,i.return,S)}}function Uy(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Yc(i.type)||i.tag===4}function Q1(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Uy(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Yc(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function eg(i,u,h){var p=i.tag;if(p===5||p===6)i=i.stateNode,u?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(i,u):(u=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,u.appendChild(i),h=h._reactRootContainer,h!=null||u.onclick!==null||(u.onclick=yi));else if(p!==4&&(p===27&&Yc(i.type)&&(h=i.stateNode,u=null),i=i.child,i!==null))for(eg(i,u,h),i=i.sibling;i!==null;)eg(i,u,h),i=i.sibling}function wm(i,u,h){var p=i.tag;if(p===5||p===6)i=i.stateNode,u?h.insertBefore(i,u):h.appendChild(i);else if(p!==4&&(p===27&&Yc(i.type)&&(h=i.stateNode),i=i.child,i!==null))for(wm(i,u,h),i=i.sibling;i!==null;)wm(i,u,h),i=i.sibling}function qy(i){var u=i.stateNode,h=i.memoizedProps;try{for(var p=i.type,S=u.attributes;S.length;)u.removeAttributeNode(S[0]);gs(u,p,h),u[xe]=i,u[Ne]=h}catch(j){da(i,i.return,j)}}var Kl=!1,Rn=!1,tg=!1,zy=typeof WeakSet=="function"?WeakSet:Set,rs=null;function Aj(i,u){if(i=i.containerInfo,wg=Hm,i=Oo(i),Ji(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var S=p.anchorOffset,j=p.focusNode;p=p.focusOffset;try{h.nodeType,j.nodeType}catch{h=null;break e}var G=0,ue=-1,Te=-1,Qe=0,dt=0,_t=i,tt=null;t:for(;;){for(var rt;_t!==h||S!==0&&_t.nodeType!==3||(ue=G+S),_t!==j||p!==0&&_t.nodeType!==3||(Te=G+p),_t.nodeType===3&&(G+=_t.nodeValue.length),(rt=_t.firstChild)!==null;)tt=_t,_t=rt;for(;;){if(_t===i)break t;if(tt===h&&++Qe===S&&(ue=G),tt===j&&++dt===p&&(Te=G),(rt=_t.nextSibling)!==null)break;_t=tt,tt=_t.parentNode}_t=rt}h=ue===-1||Te===-1?null:{start:ue,end:Te}}else h=null}h=h||{start:0,end:0}}else h=null;for(Sg={focusedElem:i,selectionRange:h},Hm=!1,rs=u;rs!==null;)if(u=rs,i=u.child,(u.subtreeFlags&1028)!==0&&i!==null)i.return=u,rs=i;else for(;rs!==null;){switch(u=rs,j=u.alternate,i=u.flags,u.tag){case 0:if((i&4)!==0&&(i=u.updateQueue,i=i!==null?i.events:null,i!==null))for(h=0;h<i.length;h++)S=i[h],S.ref.impl=S.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&j!==null){i=void 0,h=u,S=j.memoizedProps,j=j.memoizedState,p=h.stateNode;try{var Zt=Yu(h.type,S);i=p.getSnapshotBeforeUpdate(Zt,j),p.__reactInternalSnapshotBeforeUpdate=i}catch(vr){da(h,h.return,vr)}}break;case 3:if((i&1024)!==0){if(i=u.stateNode.containerInfo,h=i.nodeType,h===9)jg(i);else if(h===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":jg(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(a(163))}if(i=u.sibling,i!==null){i.return=u.return,rs=i;break}rs=u.return}}function Hy(i,u,h){var p=h.flags;switch(h.tag){case 0:case 11:case 15:Zl(i,h),p&4&&Lh(5,h);break;case 1:if(Zl(i,h),p&4)if(i=h.stateNode,u===null)try{i.componentDidMount()}catch(G){da(h,h.return,G)}else{var S=Yu(h.type,u.memoizedProps);u=u.memoizedState;try{i.componentDidUpdate(S,u,i.__reactInternalSnapshotBeforeUpdate)}catch(G){da(h,h.return,G)}}p&64&&My(h),p&512&&Ph(h,h.return);break;case 3:if(Zl(i,h),p&64&&(i=h.updateQueue,i!==null)){if(u=null,h.child!==null)switch(h.child.tag){case 27:case 5:u=h.child.stateNode;break;case 1:u=h.child.stateNode}try{on(i,u)}catch(G){da(h,h.return,G)}}break;case 27:u===null&&p&4&&qy(h);case 26:case 5:Zl(i,h),u===null&&p&4&&By(h),p&512&&Ph(h,h.return);break;case 12:Zl(i,h);break;case 31:Zl(i,h),p&4&&Vy(i,h);break;case 13:Zl(i,h),p&4&&Gy(i,h),p&64&&(i=h.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(h=Mj.bind(null,h),aE(i,h))));break;case 22:if(p=h.memoizedState!==null||Kl,!p){u=u!==null&&u.memoizedState!==null||Rn,S=Kl;var j=Rn;Kl=p,(Rn=u)&&!j?Ql(i,h,(h.subtreeFlags&8772)!==0):Zl(i,h),Kl=S,Rn=j}break;case 30:break;default:Zl(i,h)}}function $y(i){var u=i.alternate;u!==null&&(i.alternate=null,$y(u)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(u=i.stateNode,u!==null&&kt(u)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Va=null,ii=!1;function Jl(i,u,h){for(h=h.child;h!==null;)Wy(i,u,h),h=h.sibling}function Wy(i,u,h){if(zt&&typeof zt.onCommitFiberUnmount=="function")try{zt.onCommitFiberUnmount(Pt,h)}catch{}switch(h.tag){case 26:Rn||gl(h,u),Jl(i,u,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Rn||gl(h,u);var p=Va,S=ii;Yc(h.type)&&(Va=h.stateNode,ii=!1),Jl(i,u,h),Wh(h.stateNode),Va=p,ii=S;break;case 5:Rn||gl(h,u);case 6:if(p=Va,S=ii,Va=null,Jl(i,u,h),Va=p,ii=S,Va!==null)if(ii)try{(Va.nodeType===9?Va.body:Va.nodeName==="HTML"?Va.ownerDocument.body:Va).removeChild(h.stateNode)}catch(j){da(h,u,j)}else try{Va.removeChild(h.stateNode)}catch(j){da(h,u,j)}break;case 18:Va!==null&&(ii?(i=Va,M_(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,h.stateNode),kd(i)):M_(Va,h.stateNode));break;case 4:p=Va,S=ii,Va=h.stateNode.containerInfo,ii=!0,Jl(i,u,h),Va=p,ii=S;break;case 0:case 11:case 14:case 15:qc(2,h,u),Rn||qc(4,h,u),Jl(i,u,h);break;case 1:Rn||(gl(h,u),p=h.stateNode,typeof p.componentWillUnmount=="function"&&Iy(h,u,p)),Jl(i,u,h);break;case 21:Jl(i,u,h);break;case 22:Rn=(p=Rn)||h.memoizedState!==null,Jl(i,u,h),Rn=p;break;default:Jl(i,u,h)}}function Vy(i,u){if(u.memoizedState===null&&(i=u.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{kd(i)}catch(h){da(u,u.return,h)}}}function Gy(i,u){if(u.memoizedState===null&&(i=u.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{kd(i)}catch(h){da(u,u.return,h)}}function Cj(i){switch(i.tag){case 31:case 13:case 19:var u=i.stateNode;return u===null&&(u=i.stateNode=new zy),u;case 22:return i=i.stateNode,u=i._retryCache,u===null&&(u=i._retryCache=new zy),u;default:throw Error(a(435,i.tag))}}function Sm(i,u){var h=Cj(i);u.forEach(function(p){if(!h.has(p)){h.add(p);var S=Ij.bind(null,i,p);p.then(S,S)}})}function oi(i,u){var h=u.deletions;if(h!==null)for(var p=0;p<h.length;p++){var S=h[p],j=i,G=u,ue=G;e:for(;ue!==null;){switch(ue.tag){case 27:if(Yc(ue.type)){Va=ue.stateNode,ii=!1;break e}break;case 5:Va=ue.stateNode,ii=!1;break e;case 3:case 4:Va=ue.stateNode.containerInfo,ii=!0;break e}ue=ue.return}if(Va===null)throw Error(a(160));Wy(j,G,S),Va=null,ii=!1,j=S.alternate,j!==null&&(j.return=null),S.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)Yy(u,i),u=u.sibling}var Bo=null;function Yy(i,u){var h=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:oi(u,i),li(i),p&4&&(qc(3,i,i.return),Lh(3,i),qc(5,i,i.return));break;case 1:oi(u,i),li(i),p&512&&(Rn||h===null||gl(h,h.return)),p&64&&Kl&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(h=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=h===null?p:h.concat(p))));break;case 26:var S=Bo;if(oi(u,i),li(i),p&512&&(Rn||h===null||gl(h,h.return)),p&4){var j=h!==null?h.memoizedState:null;if(p=i.memoizedState,h===null)if(p===null)if(i.stateNode===null){e:{p=i.type,h=i.memoizedProps,S=S.ownerDocument||S;t:switch(p){case"title":j=S.getElementsByTagName("title")[0],(!j||j[Je]||j[xe]||j.namespaceURI==="http://www.w3.org/2000/svg"||j.hasAttribute("itemprop"))&&(j=S.createElement(p),S.head.insertBefore(j,S.querySelector("head > title"))),gs(j,p,h),j[xe]=i,Xt(j),p=j;break e;case"link":var G=Y_("link","href",S).get(p+(h.href||""));if(G){for(var ue=0;ue<G.length;ue++)if(j=G[ue],j.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&j.getAttribute("rel")===(h.rel==null?null:h.rel)&&j.getAttribute("title")===(h.title==null?null:h.title)&&j.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){G.splice(ue,1);break t}}j=S.createElement(p),gs(j,p,h),S.head.appendChild(j);break;case"meta":if(G=Y_("meta","content",S).get(p+(h.content||""))){for(ue=0;ue<G.length;ue++)if(j=G[ue],j.getAttribute("content")===(h.content==null?null:""+h.content)&&j.getAttribute("name")===(h.name==null?null:h.name)&&j.getAttribute("property")===(h.property==null?null:h.property)&&j.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&j.getAttribute("charset")===(h.charSet==null?null:h.charSet)){G.splice(ue,1);break t}}j=S.createElement(p),gs(j,p,h),S.head.appendChild(j);break;default:throw Error(a(468,p))}j[xe]=i,Xt(j),p=j}i.stateNode=p}else X_(S,i.type,i.stateNode);else i.stateNode=G_(S,p,i.memoizedProps);else j!==p?(j===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):j.count--,p===null?X_(S,i.type,i.stateNode):G_(S,p,i.memoizedProps)):p===null&&i.stateNode!==null&&Z1(i,i.memoizedProps,h.memoizedProps)}break;case 27:oi(u,i),li(i),p&512&&(Rn||h===null||gl(h,h.return)),h!==null&&p&4&&Z1(i,i.memoizedProps,h.memoizedProps);break;case 5:if(oi(u,i),li(i),p&512&&(Rn||h===null||gl(h,h.return)),i.flags&32){S=i.stateNode;try{xi(S,"")}catch(Zt){da(i,i.return,Zt)}}p&4&&i.stateNode!=null&&(S=i.memoizedProps,Z1(i,S,h!==null?h.memoizedProps:S)),p&1024&&(tg=!0);break;case 6:if(oi(u,i),li(i),p&4){if(i.stateNode===null)throw Error(a(162));p=i.memoizedProps,h=i.stateNode;try{h.nodeValue=p}catch(Zt){da(i,i.return,Zt)}}break;case 3:if(Bm=null,S=Bo,Bo=Mm(u.containerInfo),oi(u,i),Bo=S,li(i),p&4&&h!==null&&h.memoizedState.isDehydrated)try{kd(u.containerInfo)}catch(Zt){da(i,i.return,Zt)}tg&&(tg=!1,Xy(i));break;case 4:p=Bo,Bo=Mm(i.stateNode.containerInfo),oi(u,i),li(i),Bo=p;break;case 12:oi(u,i),li(i);break;case 31:oi(u,i),li(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Sm(i,p)));break;case 13:oi(u,i),li(i),i.child.flags&8192&&i.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(km=Dt()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Sm(i,p)));break;case 22:S=i.memoizedState!==null;var Te=h!==null&&h.memoizedState!==null,Qe=Kl,dt=Rn;if(Kl=Qe||S,Rn=dt||Te,oi(u,i),Rn=dt,Kl=Qe,li(i),p&8192)e:for(u=i.stateNode,u._visibility=S?u._visibility&-2:u._visibility|1,S&&(h===null||Te||Kl||Rn||Xu(i)),h=null,u=i;;){if(u.tag===5||u.tag===26){if(h===null){Te=h=u;try{if(j=Te.stateNode,S)G=j.style,typeof G.setProperty=="function"?G.setProperty("display","none","important"):G.display="none";else{ue=Te.stateNode;var _t=Te.memoizedProps.style,tt=_t!=null&&_t.hasOwnProperty("display")?_t.display:null;ue.style.display=tt==null||typeof tt=="boolean"?"":(""+tt).trim()}}catch(Zt){da(Te,Te.return,Zt)}}}else if(u.tag===6){if(h===null){Te=u;try{Te.stateNode.nodeValue=S?"":Te.memoizedProps}catch(Zt){da(Te,Te.return,Zt)}}}else if(u.tag===18){if(h===null){Te=u;try{var rt=Te.stateNode;S?I_(rt,!0):I_(Te.stateNode,!1)}catch(Zt){da(Te,Te.return,Zt)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===i)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break e;for(;u.sibling===null;){if(u.return===null||u.return===i)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}p&4&&(p=i.updateQueue,p!==null&&(h=p.retryQueue,h!==null&&(p.retryQueue=null,Sm(i,h))));break;case 19:oi(u,i),li(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Sm(i,p)));break;case 30:break;case 21:break;default:oi(u,i),li(i)}}function li(i){var u=i.flags;if(u&2){try{for(var h,p=i.return;p!==null;){if(Uy(p)){h=p;break}p=p.return}if(h==null)throw Error(a(160));switch(h.tag){case 27:var S=h.stateNode,j=Q1(i);wm(i,j,S);break;case 5:var G=h.stateNode;h.flags&32&&(xi(G,""),h.flags&=-33);var ue=Q1(i);wm(i,ue,G);break;case 3:case 4:var Te=h.stateNode.containerInfo,Qe=Q1(i);eg(i,Qe,Te);break;default:throw Error(a(161))}}catch(dt){da(i,i.return,dt)}i.flags&=-3}u&4096&&(i.flags&=-4097)}function Xy(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var u=i;Xy(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),i=i.sibling}}function Zl(i,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Hy(i,u.alternate,u),u=u.sibling}function Xu(i){for(i=i.child;i!==null;){var u=i;switch(u.tag){case 0:case 11:case 14:case 15:qc(4,u,u.return),Xu(u);break;case 1:gl(u,u.return);var h=u.stateNode;typeof h.componentWillUnmount=="function"&&Iy(u,u.return,h),Xu(u);break;case 27:Wh(u.stateNode);case 26:case 5:gl(u,u.return),Xu(u);break;case 22:u.memoizedState===null&&Xu(u);break;case 30:Xu(u);break;default:Xu(u)}i=i.sibling}}function Ql(i,u,h){for(h=h&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var p=u.alternate,S=i,j=u,G=j.flags;switch(j.tag){case 0:case 11:case 15:Ql(S,j,h),Lh(4,j);break;case 1:if(Ql(S,j,h),p=j,S=p.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(Qe){da(p,p.return,Qe)}if(p=j,S=p.updateQueue,S!==null){var ue=p.stateNode;try{var Te=S.shared.hiddenCallbacks;if(Te!==null)for(S.shared.hiddenCallbacks=null,S=0;S<Te.length;S++)es(Te[S],ue)}catch(Qe){da(p,p.return,Qe)}}h&&G&64&&My(j),Ph(j,j.return);break;case 27:qy(j);case 26:case 5:Ql(S,j,h),h&&p===null&&G&4&&By(j),Ph(j,j.return);break;case 12:Ql(S,j,h);break;case 31:Ql(S,j,h),h&&G&4&&Vy(S,j);break;case 13:Ql(S,j,h),h&&G&4&&Gy(S,j);break;case 22:j.memoizedState===null&&Ql(S,j,h),Ph(j,j.return);break;case 30:break;default:Ql(S,j,h)}u=u.sibling}}function rg(i,u){var h=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),i=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(i=u.memoizedState.cachePool.pool),i!==h&&(i!=null&&i.refCount++,h!=null&&$u(h))}function ag(i,u){i=null,u.alternate!==null&&(i=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==i&&(u.refCount++,i!=null&&$u(i))}function Uo(i,u,h,p){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Ky(i,u,h,p),u=u.sibling}function Ky(i,u,h,p){var S=u.flags;switch(u.tag){case 0:case 11:case 15:Uo(i,u,h,p),S&2048&&Lh(9,u);break;case 1:Uo(i,u,h,p);break;case 3:Uo(i,u,h,p),S&2048&&(i=null,u.alternate!==null&&(i=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==i&&(u.refCount++,i!=null&&$u(i)));break;case 12:if(S&2048){Uo(i,u,h,p),i=u.stateNode;try{var j=u.memoizedProps,G=j.id,ue=j.onPostCommit;typeof ue=="function"&&ue(G,u.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Te){da(u,u.return,Te)}}else Uo(i,u,h,p);break;case 31:Uo(i,u,h,p);break;case 13:Uo(i,u,h,p);break;case 23:break;case 22:j=u.stateNode,G=u.alternate,u.memoizedState!==null?j._visibility&2?Uo(i,u,h,p):Mh(i,u):j._visibility&2?Uo(i,u,h,p):(j._visibility|=2,md(i,u,h,p,(u.subtreeFlags&10256)!==0||!1)),S&2048&&rg(G,u);break;case 24:Uo(i,u,h,p),S&2048&&ag(u.alternate,u);break;default:Uo(i,u,h,p)}}function md(i,u,h,p,S){for(S=S&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var j=i,G=u,ue=h,Te=p,Qe=G.flags;switch(G.tag){case 0:case 11:case 15:md(j,G,ue,Te,S),Lh(8,G);break;case 23:break;case 22:var dt=G.stateNode;G.memoizedState!==null?dt._visibility&2?md(j,G,ue,Te,S):Mh(j,G):(dt._visibility|=2,md(j,G,ue,Te,S)),S&&Qe&2048&&rg(G.alternate,G);break;case 24:md(j,G,ue,Te,S),S&&Qe&2048&&ag(G.alternate,G);break;default:md(j,G,ue,Te,S)}u=u.sibling}}function Mh(i,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var h=i,p=u,S=p.flags;switch(p.tag){case 22:Mh(h,p),S&2048&&rg(p.alternate,p);break;case 24:Mh(h,p),S&2048&&ag(p.alternate,p);break;default:Mh(h,p)}u=u.sibling}}var Ih=8192;function pd(i,u,h){if(i.subtreeFlags&Ih)for(i=i.child;i!==null;)Jy(i,u,h),i=i.sibling}function Jy(i,u,h){switch(i.tag){case 26:pd(i,u,h),i.flags&Ih&&i.memoizedState!==null&&pE(h,Bo,i.memoizedState,i.memoizedProps);break;case 5:pd(i,u,h);break;case 3:case 4:var p=Bo;Bo=Mm(i.stateNode.containerInfo),pd(i,u,h),Bo=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=Ih,Ih=16777216,pd(i,u,h),Ih=p):pd(i,u,h));break;default:pd(i,u,h)}}function Zy(i){var u=i.alternate;if(u!==null&&(i=u.child,i!==null)){u.child=null;do u=i.sibling,i.sibling=null,i=u;while(i!==null)}}function Bh(i){var u=i.deletions;if((i.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var p=u[h];rs=p,e_(p,i)}Zy(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Qy(i),i=i.sibling}function Qy(i){switch(i.tag){case 0:case 11:case 15:Bh(i),i.flags&2048&&qc(9,i,i.return);break;case 3:Bh(i);break;case 12:Bh(i);break;case 22:var u=i.stateNode;i.memoizedState!==null&&u._visibility&2&&(i.return===null||i.return.tag!==13)?(u._visibility&=-3,Nm(i)):Bh(i);break;default:Bh(i)}}function Nm(i){var u=i.deletions;if((i.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var p=u[h];rs=p,e_(p,i)}Zy(i)}for(i=i.child;i!==null;){switch(u=i,u.tag){case 0:case 11:case 15:qc(8,u,u.return),Nm(u);break;case 22:h=u.stateNode,h._visibility&2&&(h._visibility&=-3,Nm(u));break;default:Nm(u)}i=i.sibling}}function e_(i,u){for(;rs!==null;){var h=rs;switch(h.tag){case 0:case 11:case 15:qc(8,h,u);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var p=h.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:$u(h.memoizedState.cache)}if(p=h.child,p!==null)p.return=h,rs=p;else e:for(h=i;rs!==null;){p=rs;var S=p.sibling,j=p.return;if($y(p),p===h){rs=null;break e}if(S!==null){S.return=j,rs=S;break e}rs=j}}}var Tj={getCacheForType:function(i){var u=$n(Ja),h=u.data.get(i);return h===void 0&&(h=i(),u.data.set(i,h)),h},cacheSignal:function(){return $n(Ja).controller.signal}},Oj=typeof WeakMap=="function"?WeakMap:Map,la=0,Ea=null,Ur=null,zr=0,fa=0,ji=null,zc=!1,gd=!1,ng=!1,ec=0,fn=0,Hc=0,Ku=0,sg=0,Ei=0,vd=0,Uh=null,ci=null,ig=!1,km=0,t_=0,jm=1/0,Em=null,$c=null,Vn=0,Wc=null,xd=null,tc=0,og=0,lg=null,r_=null,qh=0,cg=null;function Ai(){return(la&2)!==0&&zr!==0?zr&-zr:X.T!==null?pg():ae()}function a_(){if(Ei===0)if((zr&536870912)===0||Br){var i=$t;$t<<=1,($t&3932160)===0&&($t=262144),Ei=i}else Ei=536870912;return i=Pa.current,i!==null&&(i.flags|=32),Ei}function ui(i,u,h){(i===Ea&&(fa===2||fa===9)||i.cancelPendingCommit!==null)&&(yd(i,0),Vc(i,zr,Ei,!1)),ar(i,h),((la&2)===0||i!==Ea)&&(i===Ea&&((la&2)===0&&(Ku|=h),fn===4&&Vc(i,zr,Ei,!1)),vl(i))}function n_(i,u,h){if((la&6)!==0)throw Error(a(327));var p=!h&&(u&127)===0&&(u&i.expiredLanes)===0||Ca(i,u),S=p?Fj(i,u):fg(i,u,!0),j=p;do{if(S===0){gd&&!p&&Vc(i,u,0,!1);break}else{if(h=i.current.alternate,j&&!Rj(h)){S=fg(i,u,!1),j=!1;continue}if(S===2){if(j=u,i.errorRecoveryDisabledLanes&j)var G=0;else G=i.pendingLanes&-536870913,G=G!==0?G:G&536870912?536870912:0;if(G!==0){u=G;e:{var ue=i;S=Uh;var Te=ue.current.memoizedState.isDehydrated;if(Te&&(yd(ue,G).flags|=256),G=fg(ue,G,!1),G!==2){if(ng&&!Te){ue.errorRecoveryDisabledLanes|=j,Ku|=j,S=4;break e}j=ci,ci=S,j!==null&&(ci===null?ci=j:ci.push.apply(ci,j))}S=G}if(j=!1,S!==2)continue}}if(S===1){yd(i,0),Vc(i,u,0,!0);break}e:{switch(p=i,j=S,j){case 0:case 1:throw Error(a(345));case 4:if((u&4194048)!==u)break;case 6:Vc(p,u,Ei,!zc);break e;case 2:ci=null;break;case 3:case 5:break;default:throw Error(a(329))}if((u&62914560)===u&&(S=km+300-Dt(),10<S)){if(Vc(p,u,Ei,!zc),mr(p,0,!0)!==0)break e;tc=u,p.timeoutHandle=L_(s_.bind(null,p,h,ci,Em,ig,u,Ei,Ku,vd,zc,j,"Throttled",-0,0),S);break e}s_(p,h,ci,Em,ig,u,Ei,Ku,vd,zc,j,null,-0,0)}}break}while(!0);vl(i)}function s_(i,u,h,p,S,j,G,ue,Te,Qe,dt,_t,tt,rt){if(i.timeoutHandle=-1,_t=u.subtreeFlags,_t&8192||(_t&16785408)===16785408){_t={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:yi},Jy(u,j,_t);var Zt=(j&62914560)===j?km-Dt():(j&4194048)===j?t_-Dt():0;if(Zt=gE(_t,Zt),Zt!==null){tc=j,i.cancelPendingCommit=Zt(h_.bind(null,i,u,j,h,p,S,G,ue,Te,dt,_t,null,tt,rt)),Vc(i,j,G,!Qe);return}}h_(i,u,j,h,p,S,G,ue,Te)}function Rj(i){for(var u=i;;){var h=u.tag;if((h===0||h===11||h===15)&&u.flags&16384&&(h=u.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var p=0;p<h.length;p++){var S=h[p],j=S.getSnapshot;S=S.value;try{if(!Un(j(),S))return!1}catch{return!1}}if(h=u.child,u.subtreeFlags&16384&&h!==null)h.return=u,u=h;else{if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Vc(i,u,h,p){u&=~sg,u&=~Ku,i.suspendedLanes|=u,i.pingedLanes&=~u,p&&(i.warmLanes|=u),p=i.expirationTimes;for(var S=u;0<S;){var j=31-Ve(S),G=1<<j;p[j]=-1,S&=~G}h!==0&&os(i,h,u)}function Am(){return(la&6)===0?(zh(0),!1):!0}function ug(){if(Ur!==null){if(fa===0)var i=Ur.return;else i=Ur,Qi=ll=null,od(i),bt=null,tr=0,i=Ur;for(;i!==null;)Py(i.alternate,i),i=i.return;Ur=null}}function yd(i,u){var h=i.timeoutHandle;h!==-1&&(i.timeoutHandle=-1,Zj(h)),h=i.cancelPendingCommit,h!==null&&(i.cancelPendingCommit=null,h()),tc=0,ug(),Ea=i,Ur=h=Zs(i.current,null),zr=u,fa=0,ji=null,zc=!1,gd=Ca(i,u),ng=!1,vd=Ei=sg=Ku=Hc=fn=0,ci=Uh=null,ig=!1,(u&8)!==0&&(u|=u&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=u;0<p;){var S=31-Ve(p),j=1<<S;u|=i[S],p&=~j}return ec=u,Iu(),h}function i_(i,u){ur=null,X.H=Rh,u===Fe||u===je?(u=vt(),fa=3):u===Ke?(u=vt(),fa=4):fa=u===z1?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,ji=u,Ur===null&&(fn=1,vm(i,Qs(u,i.current)))}function o_(){var i=Pa.current;return i===null?!0:(zr&4194048)===zr?Yr===null:(zr&62914560)===zr||(zr&536870912)!==0?i===Yr:!1}function l_(){var i=X.H;return X.H=Rh,i===null?Rh:i}function c_(){var i=X.A;return X.A=Tj,i}function Cm(){fn=4,zc||(zr&4194048)!==zr&&Pa.current!==null||(gd=!0),(Hc&134217727)===0&&(Ku&134217727)===0||Ea===null||Vc(Ea,zr,Ei,!1)}function fg(i,u,h){var p=la;la|=2;var S=l_(),j=c_();(Ea!==i||zr!==u)&&(Em=null,yd(i,u)),u=!1;var G=fn;e:do try{if(fa!==0&&Ur!==null){var ue=Ur,Te=ji;switch(fa){case 8:ug(),G=6;break e;case 3:case 2:case 9:case 6:Pa.current===null&&(u=!0);var Qe=fa;if(fa=0,ji=null,_d(i,ue,Te,Qe),h&&gd){G=0;break e}break;default:Qe=fa,fa=0,ji=null,_d(i,ue,Te,Qe)}}Dj(),G=fn;break}catch(dt){i_(i,dt)}while(!0);return u&&i.shellSuspendCounter++,Qi=ll=null,la=p,X.H=S,X.A=j,Ur===null&&(Ea=null,zr=0,Iu()),G}function Dj(){for(;Ur!==null;)u_(Ur)}function Fj(i,u){var h=la;la|=2;var p=l_(),S=c_();Ea!==i||zr!==u?(Em=null,jm=Dt()+500,yd(i,u)):gd=Ca(i,u);e:do try{if(fa!==0&&Ur!==null){u=Ur;var j=ji;t:switch(fa){case 1:fa=0,ji=null,_d(i,u,j,1);break;case 2:case 9:if($e(j)){fa=0,ji=null,f_(u);break}u=function(){fa!==2&&fa!==9||Ea!==i||(fa=7),vl(i)},j.then(u,u);break e;case 3:fa=7;break e;case 4:fa=5;break e;case 7:$e(j)?(fa=0,ji=null,f_(u)):(fa=0,ji=null,_d(i,u,j,7));break;case 5:var G=null;switch(Ur.tag){case 26:G=Ur.memoizedState;case 5:case 27:var ue=Ur;if(G?K_(G):ue.stateNode.complete){fa=0,ji=null;var Te=ue.sibling;if(Te!==null)Ur=Te;else{var Qe=ue.return;Qe!==null?(Ur=Qe,Tm(Qe)):Ur=null}break t}}fa=0,ji=null,_d(i,u,j,5);break;case 6:fa=0,ji=null,_d(i,u,j,6);break;case 8:ug(),fn=6;break e;default:throw Error(a(462))}}Lj();break}catch(dt){i_(i,dt)}while(!0);return Qi=ll=null,X.H=p,X.A=S,la=h,Ur!==null?0:(Ea=null,zr=0,Iu(),fn)}function Lj(){for(;Ur!==null&&!lt();)u_(Ur)}function u_(i){var u=Fy(i.alternate,i,ec);i.memoizedProps=i.pendingProps,u===null?Tm(i):Ur=u}function f_(i){var u=i,h=u.alternate;switch(u.tag){case 15:case 0:u=Ay(h,u,u.pendingProps,u.type,void 0,zr);break;case 11:u=Ay(h,u,u.pendingProps,u.type.render,u.ref,zr);break;case 5:od(u);default:Py(h,u),u=Ur=qu(u,ec),u=Fy(h,u,ec)}i.memoizedProps=i.pendingProps,u===null?Tm(i):Ur=u}function _d(i,u,h,p){Qi=ll=null,od(u),bt=null,tr=0;var S=u.return;try{if(Sj(i,S,u,h,zr)){fn=1,vm(i,Qs(h,i.current)),Ur=null;return}}catch(j){if(S!==null)throw Ur=S,j;fn=1,vm(i,Qs(h,i.current)),Ur=null;return}u.flags&32768?(Br||p===1?i=!0:gd||(zr&536870912)!==0?i=!1:(zc=i=!0,(p===2||p===9||p===3||p===6)&&(p=Pa.current,p!==null&&p.tag===13&&(p.flags|=16384))),d_(u,i)):Tm(u)}function Tm(i){var u=i;do{if((u.flags&32768)!==0){d_(u,zc);return}i=u.return;var h=jj(u.alternate,u,ec);if(h!==null){Ur=h;return}if(u=u.sibling,u!==null){Ur=u;return}Ur=u=i}while(u!==null);fn===0&&(fn=5)}function d_(i,u){do{var h=Ej(i.alternate,i);if(h!==null){h.flags&=32767,Ur=h;return}if(h=i.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!u&&(i=i.sibling,i!==null)){Ur=i;return}Ur=i=h}while(i!==null);fn=6,Ur=null}function h_(i,u,h,p,S,j,G,ue,Te){i.cancelPendingCommit=null;do Om();while(Vn!==0);if((la&6)!==0)throw Error(a(327));if(u!==null){if(u===i.current)throw Error(a(177));if(j=u.lanes|u.childLanes,j|=Gf,za(i,h,j,G,ue,Te),i===Ea&&(Ur=Ea=null,zr=0),xd=u,Wc=i,tc=h,og=j,lg=S,r_=p,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Bj(yt,function(){return x_(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||p){p=X.T,X.T=null,S=Z.p,Z.p=2,G=la,la|=4;try{Aj(i,u,h)}finally{la=G,Z.p=S,X.T=p}}Vn=1,m_(),p_(),g_()}}function m_(){if(Vn===1){Vn=0;var i=Wc,u=xd,h=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||h){h=X.T,X.T=null;var p=Z.p;Z.p=2;var S=la;la|=4;try{Yy(u,i);var j=Sg,G=Oo(i.containerInfo),ue=j.focusedElem,Te=j.selectionRange;if(G!==ue&&ue&&ue.ownerDocument&&To(ue.ownerDocument.documentElement,ue)){if(Te!==null&&Ji(ue)){var Qe=Te.start,dt=Te.end;if(dt===void 0&&(dt=Qe),"selectionStart"in ue)ue.selectionStart=Qe,ue.selectionEnd=Math.min(dt,ue.value.length);else{var _t=ue.ownerDocument||document,tt=_t&&_t.defaultView||window;if(tt.getSelection){var rt=tt.getSelection(),Zt=ue.textContent.length,vr=Math.min(Te.start,Zt),wa=Te.end===void 0?vr:Math.min(Te.end,Zt);!rt.extend&&vr>wa&&(G=wa,wa=vr,vr=G);var ze=Tc(ue,vr),Le=Tc(ue,wa);if(ze&&Le&&(rt.rangeCount!==1||rt.anchorNode!==ze.node||rt.anchorOffset!==ze.offset||rt.focusNode!==Le.node||rt.focusOffset!==Le.offset)){var Ze=_t.createRange();Ze.setStart(ze.node,ze.offset),rt.removeAllRanges(),vr>wa?(rt.addRange(Ze),rt.extend(Le.node,Le.offset)):(Ze.setEnd(Le.node,Le.offset),rt.addRange(Ze))}}}}for(_t=[],rt=ue;rt=rt.parentNode;)rt.nodeType===1&&_t.push({element:rt,left:rt.scrollLeft,top:rt.scrollTop});for(typeof ue.focus=="function"&&ue.focus(),ue=0;ue<_t.length;ue++){var xt=_t[ue];xt.element.scrollLeft=xt.left,xt.element.scrollTop=xt.top}}Hm=!!wg,Sg=wg=null}finally{la=S,Z.p=p,X.T=h}}i.current=u,Vn=2}}function p_(){if(Vn===2){Vn=0;var i=Wc,u=xd,h=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||h){h=X.T,X.T=null;var p=Z.p;Z.p=2;var S=la;la|=4;try{Hy(i,u.alternate,u)}finally{la=S,Z.p=p,X.T=h}}Vn=3}}function g_(){if(Vn===4||Vn===3){Vn=0,jt();var i=Wc,u=xd,h=tc,p=r_;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?Vn=5:(Vn=0,xd=Wc=null,v_(i,i.pendingLanes));var S=i.pendingLanes;if(S===0&&($c=null),er(h),u=u.stateNode,zt&&typeof zt.onCommitFiberRoot=="function")try{zt.onCommitFiberRoot(Pt,u,void 0,(u.current.flags&128)===128)}catch{}if(p!==null){u=X.T,S=Z.p,Z.p=2,X.T=null;try{for(var j=i.onRecoverableError,G=0;G<p.length;G++){var ue=p[G];j(ue.value,{componentStack:ue.stack})}}finally{X.T=u,Z.p=S}}(tc&3)!==0&&Om(),vl(i),S=i.pendingLanes,(h&261930)!==0&&(S&42)!==0?i===cg?qh++:(qh=0,cg=i):qh=0,zh(0)}}function v_(i,u){(i.pooledCacheLanes&=u)===0&&(u=i.pooledCache,u!=null&&(i.pooledCache=null,$u(u)))}function Om(){return m_(),p_(),g_(),x_()}function x_(){if(Vn!==5)return!1;var i=Wc,u=og;og=0;var h=er(tc),p=X.T,S=Z.p;try{Z.p=32>h?32:h,X.T=null,h=lg,lg=null;var j=Wc,G=tc;if(Vn=0,xd=Wc=null,tc=0,(la&6)!==0)throw Error(a(331));var ue=la;if(la|=4,Qy(j.current),Ky(j,j.current,G,h),la=ue,zh(0,!1),zt&&typeof zt.onPostCommitFiberRoot=="function")try{zt.onPostCommitFiberRoot(Pt,j)}catch{}return!0}finally{Z.p=S,X.T=p,v_(i,u)}}function y_(i,u,h){u=Qs(h,u),u=q1(i.stateNode,u,2),i=Tr(i,u,2),i!==null&&(ar(i,2),vl(i))}function da(i,u,h){if(i.tag===3)y_(i,i,h);else for(;u!==null;){if(u.tag===3){y_(u,i,h);break}else if(u.tag===1){var p=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&($c===null||!$c.has(p))){i=Qs(h,i),h=_y(2),p=Tr(u,h,2),p!==null&&(by(h,p,u,i),ar(p,2),vl(p));break}}u=u.return}}function dg(i,u,h){var p=i.pingCache;if(p===null){p=i.pingCache=new Oj;var S=new Set;p.set(u,S)}else S=p.get(u),S===void 0&&(S=new Set,p.set(u,S));S.has(h)||(ng=!0,S.add(h),i=Pj.bind(null,i,u,h),u.then(i,i))}function Pj(i,u,h){var p=i.pingCache;p!==null&&p.delete(u),i.pingedLanes|=i.suspendedLanes&h,i.warmLanes&=~h,Ea===i&&(zr&h)===h&&(fn===4||fn===3&&(zr&62914560)===zr&&300>Dt()-km?(la&2)===0&&yd(i,0):sg|=h,vd===zr&&(vd=0)),vl(i)}function __(i,u){u===0&&(u=Ct()),i=Do(i,u),i!==null&&(ar(i,u),vl(i))}function Mj(i){var u=i.memoizedState,h=0;u!==null&&(h=u.retryLane),__(i,h)}function Ij(i,u){var h=0;switch(i.tag){case 31:case 13:var p=i.stateNode,S=i.memoizedState;S!==null&&(h=S.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(a(314))}p!==null&&p.delete(u),__(i,h)}function Bj(i,u){return Et(i,u)}var Rm=null,bd=null,hg=!1,Dm=!1,mg=!1,Gc=0;function vl(i){i!==bd&&i.next===null&&(bd===null?Rm=bd=i:bd=bd.next=i),Dm=!0,hg||(hg=!0,qj())}function zh(i,u){if(!mg&&Dm){mg=!0;do for(var h=!1,p=Rm;p!==null;){if(i!==0){var S=p.pendingLanes;if(S===0)var j=0;else{var G=p.suspendedLanes,ue=p.pingedLanes;j=(1<<31-Ve(42|i)+1)-1,j&=S&~(G&~ue),j=j&201326741?j&201326741|1:j?j|2:0}j!==0&&(h=!0,N_(p,j))}else j=zr,j=mr(p,p===Ea?j:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(j&3)===0||Ca(p,j)||(h=!0,N_(p,j));p=p.next}while(h);mg=!1}}function Uj(){b_()}function b_(){Dm=hg=!1;var i=0;Gc!==0&&Jj()&&(i=Gc);for(var u=Dt(),h=null,p=Rm;p!==null;){var S=p.next,j=w_(p,u);j===0?(p.next=null,h===null?Rm=S:h.next=S,S===null&&(bd=h)):(h=p,(i!==0||(j&3)!==0)&&(Dm=!0)),p=S}Vn!==0&&Vn!==5||zh(i),Gc!==0&&(Gc=0)}function w_(i,u){for(var h=i.suspendedLanes,p=i.pingedLanes,S=i.expirationTimes,j=i.pendingLanes&-62914561;0<j;){var G=31-Ve(j),ue=1<<G,Te=S[G];Te===-1?((ue&h)===0||(ue&p)!==0)&&(S[G]=Na(ue,u)):Te<=u&&(i.expiredLanes|=ue),j&=~ue}if(u=Ea,h=zr,h=mr(i,i===u?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,h===0||i===u&&(fa===2||fa===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&Xe(p),i.callbackNode=null,i.callbackPriority=0;if((h&3)===0||Ca(i,h)){if(u=h&-h,u===i.callbackPriority)return u;switch(p!==null&&Xe(p),er(h)){case 2:case 8:h=ht;break;case 32:h=yt;break;case 268435456:h=pt;break;default:h=yt}return p=S_.bind(null,i),h=Et(h,p),i.callbackPriority=u,i.callbackNode=h,u}return p!==null&&p!==null&&Xe(p),i.callbackPriority=2,i.callbackNode=null,2}function S_(i,u){if(Vn!==0&&Vn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var h=i.callbackNode;if(Om()&&i.callbackNode!==h)return null;var p=zr;return p=mr(i,i===Ea?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(n_(i,p,u),w_(i,Dt()),i.callbackNode!=null&&i.callbackNode===h?S_.bind(null,i):null)}function N_(i,u){if(Om())return null;n_(i,u,!0)}function qj(){Qj(function(){(la&6)!==0?Et(et,Uj):b_()})}function pg(){if(Gc===0){var i=y;i===0&&(i=Tt,Tt<<=1,(Tt&261888)===0&&(Tt=256)),Gc=i}return Gc}function k_(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:bs(""+i)}function j_(i,u){var h=u.ownerDocument.createElement("input");return h.name=u.name,h.value=u.value,i.id&&h.setAttribute("form",i.id),u.parentNode.insertBefore(h,u),i=new FormData(i),h.parentNode.removeChild(h),i}function zj(i,u,h,p,S){if(u==="submit"&&h&&h.stateNode===S){var j=k_((S[Ne]||null).action),G=p.submitter;G&&(u=(u=G[Ne]||null)?k_(u.formAction):G.getAttribute("formAction"),u!==null&&(j=u,G=null));var ue=new Xs("action","action",null,p,S);i.push({event:ue,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Gc!==0){var Te=G?j_(S,G):new FormData(S);L1(h,{pending:!0,data:Te,method:S.method,action:j},null,Te)}}else typeof j=="function"&&(ue.preventDefault(),Te=G?j_(S,G):new FormData(S),L1(h,{pending:!0,data:Te,method:S.method,action:j},j,Te))},currentTarget:S}]})}}for(var gg=0;gg<Ul.length;gg++){var vg=Ul[gg],Hj=vg.toLowerCase(),$j=vg[0].toUpperCase()+vg.slice(1);Js(Hj,"on"+$j)}Js(Bl,"onAnimationEnd"),Js(Pu,"onAnimationIteration"),Js(vh,"onAnimationStart"),Js("dblclick","onDoubleClick"),Js("focusin","onFocus"),Js("focusout","onBlur"),Js(nm,"onTransitionRun"),Js(sm,"onTransitionStart"),Js(im,"onTransitionCancel"),Js(xh,"onTransitionEnd"),ls("onMouseEnter",["mouseout","mouseover"]),ls("onMouseLeave",["mouseout","mouseover"]),ls("onPointerEnter",["pointerout","pointerover"]),ls("onPointerLeave",["pointerout","pointerover"]),ca("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ca("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ca("onBeforeInput",["compositionend","keypress","textInput","paste"]),ca("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ca("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ca("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Hh));function E_(i,u){u=(u&4)!==0;for(var h=0;h<i.length;h++){var p=i[h],S=p.event;p=p.listeners;e:{var j=void 0;if(u)for(var G=p.length-1;0<=G;G--){var ue=p[G],Te=ue.instance,Qe=ue.currentTarget;if(ue=ue.listener,Te!==j&&S.isPropagationStopped())break e;j=ue,S.currentTarget=Qe;try{j(S)}catch(dt){Mu(dt)}S.currentTarget=null,j=Te}else for(G=0;G<p.length;G++){if(ue=p[G],Te=ue.instance,Qe=ue.currentTarget,ue=ue.listener,Te!==j&&S.isPropagationStopped())break e;j=ue,S.currentTarget=Qe;try{j(S)}catch(dt){Mu(dt)}S.currentTarget=null,j=Te}}}}function qr(i,u){var h=u[He];h===void 0&&(h=u[He]=new Set);var p=i+"__bubble";h.has(p)||(A_(u,i,2,!1),h.add(p))}function xg(i,u,h){var p=0;u&&(p|=4),A_(h,i,p,u)}var Fm="_reactListening"+Math.random().toString(36).slice(2);function yg(i){if(!i[Fm]){i[Fm]=!0,sa.forEach(function(h){h!=="selectionchange"&&(Wj.has(h)||xg(h,!1,i),xg(h,!0,i))});var u=i.nodeType===9?i:i.ownerDocument;u===null||u[Fm]||(u[Fm]=!0,xg("selectionchange",!1,u))}}function A_(i,u,h,p){switch(ab(u)){case 2:var S=yE;break;case 8:S=_E;break;default:S=Fg}h=S.bind(null,u,h,i),S=void 0,!Ou||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(S=!0),p?S!==void 0?i.addEventListener(u,h,{capture:!0,passive:S}):i.addEventListener(u,h,!0):S!==void 0?i.addEventListener(u,h,{passive:S}):i.addEventListener(u,h,!1)}function _g(i,u,h,p,S){var j=p;if((u&1)===0&&(u&2)===0&&p!==null)e:for(;;){if(p===null)return;var G=p.tag;if(G===3||G===4){var ue=p.stateNode.containerInfo;if(ue===S)break;if(G===4)for(G=p.return;G!==null;){var Te=G.tag;if((Te===3||Te===4)&&G.stateNode.containerInfo===S)return;G=G.return}for(;ue!==null;){if(G=Rt(ue),G===null)return;if(Te=G.tag,Te===5||Te===6||Te===26||Te===27){p=j=G;continue e}ue=ue.parentNode}}p=p.return}zf(function(){var Qe=j,dt=Rl(h),_t=[];e:{var tt=yh.get(i);if(tt!==void 0){var rt=Xs,Zt=i;switch(i){case"keypress":if(Ys(h)===0)break e;case"keydown":case"keyup":rt=$r;break;case"focusin":Zt="focus",rt=wo;break;case"focusout":Zt="blur",rt=wo;break;case"beforeblur":case"afterblur":rt=wo;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":rt=Ru;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":rt=bo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":rt=vn;break;case Bl:case Pu:case vh:rt=O;break;case xh:rt=Bn;break;case"scroll":case"scrollend":rt=Sc;break;case"wheel":rt=_i;break;case"copy":case"cut":case"paste":rt=Ae;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":rt=Ya;break;case"toggle":case"beforetoggle":rt=Du}var vr=(u&4)!==0,wa=!vr&&(i==="scroll"||i==="scrollend"),ze=vr?tt!==null?tt+"Capture":null:tt;vr=[];for(var Le=Qe,Ze;Le!==null;){var xt=Le;if(Ze=xt.stateNode,xt=xt.tag,xt!==5&&xt!==26&&xt!==27||Ze===null||ze===null||(xt=Bs(Le,ze),xt!=null&&vr.push($h(Le,xt,Ze))),wa)break;Le=Le.return}0<vr.length&&(tt=new rt(tt,Zt,null,h,dt),_t.push({event:tt,listeners:vr}))}}if((u&7)===0){e:{if(tt=i==="mouseover"||i==="pointerover",rt=i==="mouseout"||i==="pointerout",tt&&h!==go&&(Zt=h.relatedTarget||h.fromElement)&&(Rt(Zt)||Zt[ke]))break e;if((rt||tt)&&(tt=dt.window===dt?dt:(tt=dt.ownerDocument)?tt.defaultView||tt.parentWindow:window,rt?(Zt=h.relatedTarget||h.toElement,rt=Qe,Zt=Zt?Rt(Zt):null,Zt!==null&&(wa=s(Zt),vr=Zt.tag,Zt!==wa||vr!==5&&vr!==27&&vr!==6)&&(Zt=null)):(rt=null,Zt=Qe),rt!==Zt)){if(vr=Ru,xt="onMouseLeave",ze="onMouseEnter",Le="mouse",(i==="pointerout"||i==="pointerover")&&(vr=Ya,xt="onPointerLeave",ze="onPointerEnter",Le="pointer"),wa=rt==null?tt:Ot(rt),Ze=Zt==null?tt:Ot(Zt),tt=new vr(xt,Le+"leave",rt,h,dt),tt.target=wa,tt.relatedTarget=Ze,xt=null,Rt(dt)===Qe&&(vr=new vr(ze,Le+"enter",Zt,h,dt),vr.target=Ze,vr.relatedTarget=wa,xt=vr),wa=xt,rt&&Zt)t:{for(vr=Vj,ze=rt,Le=Zt,Ze=0,xt=ze;xt;xt=vr(xt))Ze++;xt=0;for(var dr=Le;dr;dr=vr(dr))xt++;for(;0<Ze-xt;)ze=vr(ze),Ze--;for(;0<xt-Ze;)Le=vr(Le),xt--;for(;Ze--;){if(ze===Le||Le!==null&&ze===Le.alternate){vr=ze;break t}ze=vr(ze),Le=vr(Le)}vr=null}else vr=null;rt!==null&&C_(_t,tt,rt,vr,!1),Zt!==null&&wa!==null&&C_(_t,wa,Zt,vr,!0)}}e:{if(tt=Qe?Ot(Qe):window,rt=tt.nodeName&&tt.nodeName.toLowerCase(),rt==="select"||rt==="input"&&tt.type==="file")var ta=nl;else if(Fu(tt))if(ws)ta=Xi;else{ta=Xa;var sr=Ac}else rt=tt.nodeName,!rt||rt.toLowerCase()!=="input"||tt.type!=="checkbox"&&tt.type!=="radio"?Qe&&Au(Qe.elementType)&&(ta=nl):ta=Vf;if(ta&&(ta=ta(i,Qe))){qs(_t,ta,h,dt);break e}sr&&sr(i,tt,Qe),i==="focusout"&&Qe&&tt.type==="number"&&Qe.memoizedProps.value!=null&&ku(tt,"number",tt.value)}switch(sr=Qe?Ot(Qe):window,i){case"focusin":(Fu(sr)||sr.contentEditable==="true")&&(zs=sr,Ro=Qe,Jn=null);break;case"focusout":Jn=Ro=zs=null;break;case"mousedown":Ks=!0;break;case"contextmenu":case"mouseup":case"dragend":Ks=!1,Jr(_t,h,dt);break;case"selectionchange":if(Il)break;case"keydown":case"keyup":Jr(_t,h,dt)}var Rr;if(Wi)e:{switch(i){case"compositionstart":var Hr="onCompositionStart";break e;case"compositionend":Hr="onCompositionEnd";break e;case"compositionupdate":Hr="onCompositionUpdate";break e}Hr=void 0}else Vi?al(i,h)&&(Hr="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(Hr="onCompositionStart");Hr&&(ko&&h.locale!=="ko"&&(Vi||Hr!=="onCompositionStart"?Hr==="onCompositionEnd"&&Vi&&(Rr=Hf()):(Us=dt,Fl="value"in Us?Us.value:Us.textContent,Vi=!0)),sr=Lm(Qe,Hr),0<sr.length&&(Hr=new qe(Hr,i,null,h,dt),_t.push({event:Hr,listeners:sr}),Rr?Hr.data=Rr:(Rr=kc(h),Rr!==null&&(Hr.data=Rr)))),(Rr=Ml?fs(i,h):jo(i,h))&&(Hr=Lm(Qe,"onBeforeInput"),0<Hr.length&&(sr=new qe("onBeforeInput","beforeinput",null,h,dt),_t.push({event:sr,listeners:Hr}),sr.data=Rr)),zj(_t,i,Qe,h,dt)}E_(_t,u)})}function $h(i,u,h){return{instance:i,listener:u,currentTarget:h}}function Lm(i,u){for(var h=u+"Capture",p=[];i!==null;){var S=i,j=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||j===null||(S=Bs(i,h),S!=null&&p.unshift($h(i,S,j)),S=Bs(i,u),S!=null&&p.push($h(i,S,j))),i.tag===3)return p;i=i.return}return[]}function Vj(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function C_(i,u,h,p,S){for(var j=u._reactName,G=[];h!==null&&h!==p;){var ue=h,Te=ue.alternate,Qe=ue.stateNode;if(ue=ue.tag,Te!==null&&Te===p)break;ue!==5&&ue!==26&&ue!==27||Qe===null||(Te=Qe,S?(Qe=Bs(h,j),Qe!=null&&G.unshift($h(h,Qe,Te))):S||(Qe=Bs(h,j),Qe!=null&&G.push($h(h,Qe,Te)))),h=h.return}G.length!==0&&i.push({event:u,listeners:G})}var Gj=/\r\n?/g,Yj=/\u0000|\uFFFD/g;function T_(i){return(typeof i=="string"?i:""+i).replace(Gj,`
`).replace(Yj,"")}function O_(i,u){return u=T_(u),T_(i)===u}function ba(i,u,h,p,S,j){switch(h){case"children":typeof p=="string"?u==="body"||u==="textarea"&&p===""||xi(i,p):(typeof p=="number"||typeof p=="bigint")&&u!=="body"&&xi(i,""+p);break;case"className":po(i,"class",p);break;case"tabIndex":po(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":po(i,h,p);break;case"style":Bf(i,p,j);break;case"data":if(u!=="object"){po(i,"data",p);break}case"src":case"href":if(p===""&&(u!=="a"||h!=="href")){i.removeAttribute(h);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(h);break}p=bs(""+p),i.setAttribute(h,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof j=="function"&&(h==="formAction"?(u!=="input"&&ba(i,u,"name",S.name,S,null),ba(i,u,"formEncType",S.formEncType,S,null),ba(i,u,"formMethod",S.formMethod,S,null),ba(i,u,"formTarget",S.formTarget,S,null)):(ba(i,u,"encType",S.encType,S,null),ba(i,u,"method",S.method,S,null),ba(i,u,"target",S.target,S,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(h);break}p=bs(""+p),i.setAttribute(h,p);break;case"onClick":p!=null&&(i.onclick=yi);break;case"onScroll":p!=null&&qr("scroll",i);break;case"onScrollEnd":p!=null&&qr("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(h=p.__html,h!=null){if(S.children!=null)throw Error(a(60));i.innerHTML=h}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}h=bs(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(h,""+p):i.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(h,""):i.removeAttribute(h);break;case"capture":case"download":p===!0?i.setAttribute(h,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(h,p):i.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(h,p):i.removeAttribute(h);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(h):i.setAttribute(h,p);break;case"popover":qr("beforetoggle",i),qr("toggle",i),Ra(i,"popover",p);break;case"xlinkActuate":vi(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":vi(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":vi(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":vi(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":vi(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":vi(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":vi(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":vi(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":vi(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Ra(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Cu.get(h)||h,Ra(i,h,p))}}function bg(i,u,h,p,S,j){switch(h){case"style":Bf(i,p,j);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(h=p.__html,h!=null){if(S.children!=null)throw Error(a(60));i.innerHTML=h}}break;case"children":typeof p=="string"?xi(i,p):(typeof p=="number"||typeof p=="bigint")&&xi(i,""+p);break;case"onScroll":p!=null&&qr("scroll",i);break;case"onScrollEnd":p!=null&&qr("scrollend",i);break;case"onClick":p!=null&&(i.onclick=yi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Lr.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(S=h.endsWith("Capture"),u=h.slice(2,S?h.length-7:void 0),j=i[Ne]||null,j=j!=null?j[h]:null,typeof j=="function"&&i.removeEventListener(u,j,S),typeof p=="function")){typeof j!="function"&&j!==null&&(h in i?i[h]=null:i.hasAttribute(h)&&i.removeAttribute(h)),i.addEventListener(u,p,S);break e}h in i?i[h]=p:p===!0?i.setAttribute(h,""):Ra(i,h,p)}}}function gs(i,u,h){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":qr("error",i),qr("load",i);var p=!1,S=!1,j;for(j in h)if(h.hasOwnProperty(j)){var G=h[j];if(G!=null)switch(j){case"src":p=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,u));default:ba(i,u,j,G,h,null)}}S&&ba(i,u,"srcSet",h.srcSet,h,null),p&&ba(i,u,"src",h.src,h,null);return;case"input":qr("invalid",i);var ue=j=G=S=null,Te=null,Qe=null;for(p in h)if(h.hasOwnProperty(p)){var dt=h[p];if(dt!=null)switch(p){case"name":S=dt;break;case"type":G=dt;break;case"checked":Te=dt;break;case"defaultChecked":Qe=dt;break;case"value":j=dt;break;case"defaultValue":ue=dt;break;case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(a(137,u));break;default:ba(i,u,p,dt,h,null)}}Mf(i,j,ue,Te,Qe,G,S,!1);return;case"select":qr("invalid",i),p=G=j=null;for(S in h)if(h.hasOwnProperty(S)&&(ue=h[S],ue!=null))switch(S){case"value":j=ue;break;case"defaultValue":G=ue;break;case"multiple":p=ue;default:ba(i,u,S,ue,h,null)}u=j,h=G,i.multiple=!!p,u!=null?us(i,!!p,u,!1):h!=null&&us(i,!!p,h,!0);return;case"textarea":qr("invalid",i),j=S=p=null;for(G in h)if(h.hasOwnProperty(G)&&(ue=h[G],ue!=null))switch(G){case"value":p=ue;break;case"defaultValue":S=ue;break;case"children":j=ue;break;case"dangerouslySetInnerHTML":if(ue!=null)throw Error(a(91));break;default:ba(i,u,G,ue,h,null)}Eu(i,p,S,j);return;case"option":for(Te in h)if(h.hasOwnProperty(Te)&&(p=h[Te],p!=null))switch(Te){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:ba(i,u,Te,p,h,null)}return;case"dialog":qr("beforetoggle",i),qr("toggle",i),qr("cancel",i),qr("close",i);break;case"iframe":case"object":qr("load",i);break;case"video":case"audio":for(p=0;p<Hh.length;p++)qr(Hh[p],i);break;case"image":qr("error",i),qr("load",i);break;case"details":qr("toggle",i);break;case"embed":case"source":case"link":qr("error",i),qr("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Qe in h)if(h.hasOwnProperty(Qe)&&(p=h[Qe],p!=null))switch(Qe){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,u));default:ba(i,u,Qe,p,h,null)}return;default:if(Au(u)){for(dt in h)h.hasOwnProperty(dt)&&(p=h[dt],p!==void 0&&bg(i,u,dt,p,h,void 0));return}}for(ue in h)h.hasOwnProperty(ue)&&(p=h[ue],p!=null&&ba(i,u,ue,p,h,null))}function Xj(i,u,h,p){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,j=null,G=null,ue=null,Te=null,Qe=null,dt=null;for(rt in h){var _t=h[rt];if(h.hasOwnProperty(rt)&&_t!=null)switch(rt){case"checked":break;case"value":break;case"defaultValue":Te=_t;default:p.hasOwnProperty(rt)||ba(i,u,rt,null,p,_t)}}for(var tt in p){var rt=p[tt];if(_t=h[tt],p.hasOwnProperty(tt)&&(rt!=null||_t!=null))switch(tt){case"type":j=rt;break;case"name":S=rt;break;case"checked":Qe=rt;break;case"defaultChecked":dt=rt;break;case"value":G=rt;break;case"defaultValue":ue=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(a(137,u));break;default:rt!==_t&&ba(i,u,tt,rt,p,_t)}}_c(i,G,ue,Te,Qe,dt,j,S);return;case"select":rt=G=ue=tt=null;for(j in h)if(Te=h[j],h.hasOwnProperty(j)&&Te!=null)switch(j){case"value":break;case"multiple":rt=Te;default:p.hasOwnProperty(j)||ba(i,u,j,null,p,Te)}for(S in p)if(j=p[S],Te=h[S],p.hasOwnProperty(S)&&(j!=null||Te!=null))switch(S){case"value":tt=j;break;case"defaultValue":ue=j;break;case"multiple":G=j;default:j!==Te&&ba(i,u,S,j,p,Te)}u=ue,h=G,p=rt,tt!=null?us(i,!!h,tt,!1):!!p!=!!h&&(u!=null?us(i,!!h,u,!0):us(i,!!h,h?[]:"",!1));return;case"textarea":rt=tt=null;for(ue in h)if(S=h[ue],h.hasOwnProperty(ue)&&S!=null&&!p.hasOwnProperty(ue))switch(ue){case"value":break;case"children":break;default:ba(i,u,ue,null,p,S)}for(G in p)if(S=p[G],j=h[G],p.hasOwnProperty(G)&&(S!=null||j!=null))switch(G){case"value":tt=S;break;case"defaultValue":rt=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(a(91));break;default:S!==j&&ba(i,u,G,S,p,j)}ju(i,tt,rt);return;case"option":for(var Zt in h)if(tt=h[Zt],h.hasOwnProperty(Zt)&&tt!=null&&!p.hasOwnProperty(Zt))switch(Zt){case"selected":i.selected=!1;break;default:ba(i,u,Zt,null,p,tt)}for(Te in p)if(tt=p[Te],rt=h[Te],p.hasOwnProperty(Te)&&tt!==rt&&(tt!=null||rt!=null))switch(Te){case"selected":i.selected=tt&&typeof tt!="function"&&typeof tt!="symbol";break;default:ba(i,u,Te,tt,p,rt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var vr in h)tt=h[vr],h.hasOwnProperty(vr)&&tt!=null&&!p.hasOwnProperty(vr)&&ba(i,u,vr,null,p,tt);for(Qe in p)if(tt=p[Qe],rt=h[Qe],p.hasOwnProperty(Qe)&&tt!==rt&&(tt!=null||rt!=null))switch(Qe){case"children":case"dangerouslySetInnerHTML":if(tt!=null)throw Error(a(137,u));break;default:ba(i,u,Qe,tt,p,rt)}return;default:if(Au(u)){for(var wa in h)tt=h[wa],h.hasOwnProperty(wa)&&tt!==void 0&&!p.hasOwnProperty(wa)&&bg(i,u,wa,void 0,p,tt);for(dt in p)tt=p[dt],rt=h[dt],!p.hasOwnProperty(dt)||tt===rt||tt===void 0&&rt===void 0||bg(i,u,dt,tt,p,rt);return}}for(var ze in h)tt=h[ze],h.hasOwnProperty(ze)&&tt!=null&&!p.hasOwnProperty(ze)&&ba(i,u,ze,null,p,tt);for(_t in p)tt=p[_t],rt=h[_t],!p.hasOwnProperty(_t)||tt===rt||tt==null&&rt==null||ba(i,u,_t,tt,p,rt)}function R_(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Kj(){if(typeof performance.getEntriesByType=="function"){for(var i=0,u=0,h=performance.getEntriesByType("resource"),p=0;p<h.length;p++){var S=h[p],j=S.transferSize,G=S.initiatorType,ue=S.duration;if(j&&ue&&R_(G)){for(G=0,ue=S.responseEnd,p+=1;p<h.length;p++){var Te=h[p],Qe=Te.startTime;if(Qe>ue)break;var dt=Te.transferSize,_t=Te.initiatorType;dt&&R_(_t)&&(Te=Te.responseEnd,G+=dt*(Te<ue?1:(ue-Qe)/(Te-Qe)))}if(--p,u+=8*(j+G)/(S.duration/1e3),i++,10<i)break}}if(0<i)return u/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var wg=null,Sg=null;function Pm(i){return i.nodeType===9?i:i.ownerDocument}function D_(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function F_(i,u){if(i===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&u==="foreignObject"?0:i}function Ng(i,u){return i==="textarea"||i==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var kg=null;function Jj(){var i=window.event;return i&&i.type==="popstate"?i===kg?!1:(kg=i,!0):(kg=null,!1)}var L_=typeof setTimeout=="function"?setTimeout:void 0,Zj=typeof clearTimeout=="function"?clearTimeout:void 0,P_=typeof Promise=="function"?Promise:void 0,Qj=typeof queueMicrotask=="function"?queueMicrotask:typeof P_<"u"?function(i){return P_.resolve(null).then(i).catch(eE)}:L_;function eE(i){setTimeout(function(){throw i})}function Yc(i){return i==="head"}function M_(i,u){var h=u,p=0;do{var S=h.nextSibling;if(i.removeChild(h),S&&S.nodeType===8)if(h=S.data,h==="/$"||h==="/&"){if(p===0){i.removeChild(S),kd(u);return}p--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")p++;else if(h==="html")Wh(i.ownerDocument.documentElement);else if(h==="head"){h=i.ownerDocument.head,Wh(h);for(var j=h.firstChild;j;){var G=j.nextSibling,ue=j.nodeName;j[Je]||ue==="SCRIPT"||ue==="STYLE"||ue==="LINK"&&j.rel.toLowerCase()==="stylesheet"||h.removeChild(j),j=G}}else h==="body"&&Wh(i.ownerDocument.body);h=S}while(h);kd(u)}function I_(i,u){var h=i;i=0;do{var p=h.nextSibling;if(h.nodeType===1?u?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(u?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),p&&p.nodeType===8)if(h=p.data,h==="/$"){if(i===0)break;i--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||i++;h=p}while(h)}function jg(i){var u=i.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var h=u;switch(u=u.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":jg(h),kt(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}i.removeChild(h)}}function tE(i,u,h,p){for(;i.nodeType===1;){var S=h;if(i.nodeName.toLowerCase()!==u.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Je])switch(u){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(j=i.getAttribute("rel"),j==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(j!==S.rel||i.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||i.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||i.getAttribute("title")!==(S.title==null?null:S.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(j=i.getAttribute("src"),(j!==(S.src==null?null:S.src)||i.getAttribute("type")!==(S.type==null?null:S.type)||i.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&j&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(u==="input"&&i.type==="hidden"){var j=S.name==null?null:""+S.name;if(S.type==="hidden"&&i.getAttribute("name")===j)return i}else return i;if(i=ro(i.nextSibling),i===null)break}return null}function rE(i,u,h){if(u==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!h||(i=ro(i.nextSibling),i===null))return null;return i}function B_(i,u){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=ro(i.nextSibling),i===null))return null;return i}function Eg(i){return i.data==="$?"||i.data==="$~"}function Ag(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function aE(i,u){var h=i.ownerDocument;if(i.data==="$~")i._reactRetry=u;else if(i.data!=="$?"||h.readyState!=="loading")u();else{var p=function(){u(),h.removeEventListener("DOMContentLoaded",p)};h.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function ro(i){for(;i!=null;i=i.nextSibling){var u=i.nodeType;if(u===1||u===3)break;if(u===8){if(u=i.data,u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"||u==="F!"||u==="F")break;if(u==="/$"||u==="/&")return null}}return i}var Cg=null;function U_(i){i=i.nextSibling;for(var u=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"||h==="/&"){if(u===0)return ro(i.nextSibling);u--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||u++}i=i.nextSibling}return null}function q_(i){i=i.previousSibling;for(var u=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(u===0)return i;u--}else h!=="/$"&&h!=="/&"||u++}i=i.previousSibling}return null}function z_(i,u,h){switch(u=Pm(h),i){case"html":if(i=u.documentElement,!i)throw Error(a(452));return i;case"head":if(i=u.head,!i)throw Error(a(453));return i;case"body":if(i=u.body,!i)throw Error(a(454));return i;default:throw Error(a(451))}}function Wh(i){for(var u=i.attributes;u.length;)i.removeAttributeNode(u[0]);kt(i)}var ao=new Map,H_=new Set;function Mm(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var rc=Z.d;Z.d={f:nE,r:sE,D:iE,C:oE,L:lE,m:cE,X:fE,S:uE,M:dE};function nE(){var i=rc.f(),u=Am();return i||u}function sE(i){var u=qt(i);u!==null&&u.tag===5&&u.type==="form"?iy(u):rc.r(i)}var wd=typeof document>"u"?null:document;function $_(i,u,h){var p=wd;if(p&&typeof u=="string"&&u){var S=an(u);S='link[rel="'+i+'"][href="'+S+'"]',typeof h=="string"&&(S+='[crossorigin="'+h+'"]'),H_.has(S)||(H_.add(S),i={rel:i,crossOrigin:h,href:u},p.querySelector(S)===null&&(u=p.createElement("link"),gs(u,"link",i),Xt(u),p.head.appendChild(u)))}}function iE(i){rc.D(i),$_("dns-prefetch",i,null)}function oE(i,u){rc.C(i,u),$_("preconnect",i,u)}function lE(i,u,h){rc.L(i,u,h);var p=wd;if(p&&i&&u){var S='link[rel="preload"][as="'+an(u)+'"]';u==="image"&&h&&h.imageSrcSet?(S+='[imagesrcset="'+an(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(S+='[imagesizes="'+an(h.imageSizes)+'"]')):S+='[href="'+an(i)+'"]';var j=S;switch(u){case"style":j=Sd(i);break;case"script":j=Nd(i)}ao.has(j)||(i=v({rel:"preload",href:u==="image"&&h&&h.imageSrcSet?void 0:i,as:u},h),ao.set(j,i),p.querySelector(S)!==null||u==="style"&&p.querySelector(Vh(j))||u==="script"&&p.querySelector(Gh(j))||(u=p.createElement("link"),gs(u,"link",i),Xt(u),p.head.appendChild(u)))}}function cE(i,u){rc.m(i,u);var h=wd;if(h&&i){var p=u&&typeof u.as=="string"?u.as:"script",S='link[rel="modulepreload"][as="'+an(p)+'"][href="'+an(i)+'"]',j=S;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":j=Nd(i)}if(!ao.has(j)&&(i=v({rel:"modulepreload",href:i},u),ao.set(j,i),h.querySelector(S)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Gh(j)))return}p=h.createElement("link"),gs(p,"link",i),Xt(p),h.head.appendChild(p)}}}function uE(i,u,h){rc.S(i,u,h);var p=wd;if(p&&i){var S=Mt(p).hoistableStyles,j=Sd(i);u=u||"default";var G=S.get(j);if(!G){var ue={loading:0,preload:null};if(G=p.querySelector(Vh(j)))ue.loading=5;else{i=v({rel:"stylesheet",href:i,"data-precedence":u},h),(h=ao.get(j))&&Tg(i,h);var Te=G=p.createElement("link");Xt(Te),gs(Te,"link",i),Te._p=new Promise(function(Qe,dt){Te.onload=Qe,Te.onerror=dt}),Te.addEventListener("load",function(){ue.loading|=1}),Te.addEventListener("error",function(){ue.loading|=2}),ue.loading|=4,Im(G,u,p)}G={type:"stylesheet",instance:G,count:1,state:ue},S.set(j,G)}}}function fE(i,u){rc.X(i,u);var h=wd;if(h&&i){var p=Mt(h).hoistableScripts,S=Nd(i),j=p.get(S);j||(j=h.querySelector(Gh(S)),j||(i=v({src:i,async:!0},u),(u=ao.get(S))&&Og(i,u),j=h.createElement("script"),Xt(j),gs(j,"link",i),h.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},p.set(S,j))}}function dE(i,u){rc.M(i,u);var h=wd;if(h&&i){var p=Mt(h).hoistableScripts,S=Nd(i),j=p.get(S);j||(j=h.querySelector(Gh(S)),j||(i=v({src:i,async:!0,type:"module"},u),(u=ao.get(S))&&Og(i,u),j=h.createElement("script"),Xt(j),gs(j,"link",i),h.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},p.set(S,j))}}function W_(i,u,h,p){var S=(S=te.current)?Mm(S):null;if(!S)throw Error(a(446));switch(i){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(u=Sd(h.href),h=Mt(S).hoistableStyles,p=h.get(u),p||(p={type:"style",instance:null,count:0,state:null},h.set(u,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){i=Sd(h.href);var j=Mt(S).hoistableStyles,G=j.get(i);if(G||(S=S.ownerDocument||S,G={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},j.set(i,G),(j=S.querySelector(Vh(i)))&&!j._p&&(G.instance=j,G.state.loading=5),ao.has(i)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},ao.set(i,h),j||hE(S,i,h,G.state))),u&&p===null)throw Error(a(528,""));return G}if(u&&p!==null)throw Error(a(529,""));return null;case"script":return u=h.async,h=h.src,typeof h=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=Nd(h),h=Mt(S).hoistableScripts,p=h.get(u),p||(p={type:"script",instance:null,count:0,state:null},h.set(u,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,i))}}function Sd(i){return'href="'+an(i)+'"'}function Vh(i){return'link[rel="stylesheet"]['+i+"]"}function V_(i){return v({},i,{"data-precedence":i.precedence,precedence:null})}function hE(i,u,h,p){i.querySelector('link[rel="preload"][as="style"]['+u+"]")?p.loading=1:(u=i.createElement("link"),p.preload=u,u.addEventListener("load",function(){return p.loading|=1}),u.addEventListener("error",function(){return p.loading|=2}),gs(u,"link",h),Xt(u),i.head.appendChild(u))}function Nd(i){return'[src="'+an(i)+'"]'}function Gh(i){return"script[async]"+i}function G_(i,u,h){if(u.count++,u.instance===null)switch(u.type){case"style":var p=i.querySelector('style[data-href~="'+an(h.href)+'"]');if(p)return u.instance=p,Xt(p),p;var S=v({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Xt(p),gs(p,"style",S),Im(p,h.precedence,i),u.instance=p;case"stylesheet":S=Sd(h.href);var j=i.querySelector(Vh(S));if(j)return u.state.loading|=4,u.instance=j,Xt(j),j;p=V_(h),(S=ao.get(S))&&Tg(p,S),j=(i.ownerDocument||i).createElement("link"),Xt(j);var G=j;return G._p=new Promise(function(ue,Te){G.onload=ue,G.onerror=Te}),gs(j,"link",p),u.state.loading|=4,Im(j,h.precedence,i),u.instance=j;case"script":return j=Nd(h.src),(S=i.querySelector(Gh(j)))?(u.instance=S,Xt(S),S):(p=h,(S=ao.get(j))&&(p=v({},h),Og(p,S)),i=i.ownerDocument||i,S=i.createElement("script"),Xt(S),gs(S,"link",p),i.head.appendChild(S),u.instance=S);case"void":return null;default:throw Error(a(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(p=u.instance,u.state.loading|=4,Im(p,h.precedence,i));return u.instance}function Im(i,u,h){for(var p=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=p.length?p[p.length-1]:null,j=S,G=0;G<p.length;G++){var ue=p[G];if(ue.dataset.precedence===u)j=ue;else if(j!==S)break}j?j.parentNode.insertBefore(i,j.nextSibling):(u=h.nodeType===9?h.head:h,u.insertBefore(i,u.firstChild))}function Tg(i,u){i.crossOrigin==null&&(i.crossOrigin=u.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=u.referrerPolicy),i.title==null&&(i.title=u.title)}function Og(i,u){i.crossOrigin==null&&(i.crossOrigin=u.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=u.referrerPolicy),i.integrity==null&&(i.integrity=u.integrity)}var Bm=null;function Y_(i,u,h){if(Bm===null){var p=new Map,S=Bm=new Map;S.set(h,p)}else S=Bm,p=S.get(h),p||(p=new Map,S.set(h,p));if(p.has(i))return p;for(p.set(i,null),h=h.getElementsByTagName(i),S=0;S<h.length;S++){var j=h[S];if(!(j[Je]||j[xe]||i==="link"&&j.getAttribute("rel")==="stylesheet")&&j.namespaceURI!=="http://www.w3.org/2000/svg"){var G=j.getAttribute(u)||"";G=i+G;var ue=p.get(G);ue?ue.push(j):p.set(G,[j])}}return p}function X_(i,u,h){i=i.ownerDocument||i,i.head.insertBefore(h,u==="title"?i.querySelector("head > title"):null)}function mE(i,u,h){if(h===1||u.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return i=u.disabled,typeof u.precedence=="string"&&i==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function K_(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function pE(i,u,h,p){if(h.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var S=Sd(p.href),j=u.querySelector(Vh(S));if(j){u=j._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(i.count++,i=Um.bind(i),u.then(i,i)),h.state.loading|=4,h.instance=j,Xt(j);return}j=u.ownerDocument||u,p=V_(p),(S=ao.get(S))&&Tg(p,S),j=j.createElement("link"),Xt(j);var G=j;G._p=new Promise(function(ue,Te){G.onload=ue,G.onerror=Te}),gs(j,"link",p),h.instance=j}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(h,u),(u=h.state.preload)&&(h.state.loading&3)===0&&(i.count++,h=Um.bind(i),u.addEventListener("load",h),u.addEventListener("error",h))}}var Rg=0;function gE(i,u){return i.stylesheets&&i.count===0&&zm(i,i.stylesheets),0<i.count||0<i.imgCount?function(h){var p=setTimeout(function(){if(i.stylesheets&&zm(i,i.stylesheets),i.unsuspend){var j=i.unsuspend;i.unsuspend=null,j()}},6e4+u);0<i.imgBytes&&Rg===0&&(Rg=62500*Kj());var S=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&zm(i,i.stylesheets),i.unsuspend)){var j=i.unsuspend;i.unsuspend=null,j()}},(i.imgBytes>Rg?50:800)+u);return i.unsuspend=h,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(S)}}:null}function Um(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)zm(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var qm=null;function zm(i,u){i.stylesheets=null,i.unsuspend!==null&&(i.count++,qm=new Map,u.forEach(vE,i),qm=null,Um.call(i))}function vE(i,u){if(!(u.state.loading&4)){var h=qm.get(i);if(h)var p=h.get(null);else{h=new Map,qm.set(i,h);for(var S=i.querySelectorAll("link[data-precedence],style[data-precedence]"),j=0;j<S.length;j++){var G=S[j];(G.nodeName==="LINK"||G.getAttribute("media")!=="not all")&&(h.set(G.dataset.precedence,G),p=G)}p&&h.set(null,p)}S=u.instance,G=S.getAttribute("data-precedence"),j=h.get(G)||p,j===p&&h.set(null,S),h.set(G,S),this.count++,p=Um.bind(this),S.addEventListener("load",p),S.addEventListener("error",p),j?j.parentNode.insertBefore(S,j.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(S,i.firstChild)),u.state.loading|=4}}var Yh={$$typeof:E,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function xE(i,u,h,p,S,j,G,ue,Te){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Oa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oa(0),this.hiddenUpdates=Oa(null),this.identifierPrefix=p,this.onUncaughtError=S,this.onCaughtError=j,this.onRecoverableError=G,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Te,this.incompleteTransitions=new Map}function J_(i,u,h,p,S,j,G,ue,Te,Qe,dt,_t){return i=new xE(i,u,h,G,Te,Qe,dt,_t,ue),u=1,j===!0&&(u|=24),j=Qn(3,null,null,u),i.current=j,j.stateNode=i,u=Pc(),u.refCount++,i.pooledCache=u,u.refCount++,j.memoizedState={element:p,isDehydrated:h,cache:u},Bt(j),i}function Z_(i){return i?(i=qn,i):qn}function Q_(i,u,h,p,S,j){S=Z_(S),p.context===null?p.context=S:p.pendingContext=S,p=gr(u),p.payload={element:h},j=j===void 0?null:j,j!==null&&(p.callback=j),h=Tr(i,p,u),h!==null&&(ui(h,i,u),ia(h,i,u))}function eb(i,u){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<u?h:u}}function Dg(i,u){eb(i,u),(i=i.alternate)&&eb(i,u)}function tb(i){if(i.tag===13||i.tag===31){var u=Do(i,67108864);u!==null&&ui(u,i,67108864),Dg(i,67108864)}}function rb(i){if(i.tag===13||i.tag===31){var u=Ai();u=Ut(u);var h=Do(i,u);h!==null&&ui(h,i,u),Dg(i,u)}}var Hm=!0;function yE(i,u,h,p){var S=X.T;X.T=null;var j=Z.p;try{Z.p=2,Fg(i,u,h,p)}finally{Z.p=j,X.T=S}}function _E(i,u,h,p){var S=X.T;X.T=null;var j=Z.p;try{Z.p=8,Fg(i,u,h,p)}finally{Z.p=j,X.T=S}}function Fg(i,u,h,p){if(Hm){var S=Lg(p);if(S===null)_g(i,u,p,$m,h),nb(i,p);else if(wE(S,i,u,h,p))p.stopPropagation();else if(nb(i,p),u&4&&-1<bE.indexOf(i)){for(;S!==null;){var j=qt(S);if(j!==null)switch(j.tag){case 3:if(j=j.stateNode,j.current.memoizedState.isDehydrated){var G=Ht(j.pendingLanes);if(G!==0){var ue=j;for(ue.pendingLanes|=2,ue.entangledLanes|=2;G;){var Te=1<<31-Ve(G);ue.entanglements[1]|=Te,G&=~Te}vl(j),(la&6)===0&&(jm=Dt()+500,zh(0))}}break;case 31:case 13:ue=Do(j,2),ue!==null&&ui(ue,j,2),Am(),Dg(j,2)}if(j=Lg(p),j===null&&_g(i,u,p,$m,h),j===S)break;S=j}S!==null&&p.stopPropagation()}else _g(i,u,p,null,h)}}function Lg(i){return i=Rl(i),Pg(i)}var $m=null;function Pg(i){if($m=null,i=Rt(i),i!==null){var u=s(i);if(u===null)i=null;else{var h=u.tag;if(h===13){if(i=l(u),i!==null)return i;i=null}else if(h===31){if(i=c(u),i!==null)return i;i=null}else if(h===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;i=null}else u!==i&&(i=null)}}return $m=i,null}function ab(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Wt()){case et:return 2;case ht:return 8;case yt:case ft:return 32;case pt:return 268435456;default:return 32}default:return 32}}var Mg=!1,Xc=null,Kc=null,Jc=null,Xh=new Map,Kh=new Map,Zc=[],bE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function nb(i,u){switch(i){case"focusin":case"focusout":Xc=null;break;case"dragenter":case"dragleave":Kc=null;break;case"mouseover":case"mouseout":Jc=null;break;case"pointerover":case"pointerout":Xh.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kh.delete(u.pointerId)}}function Jh(i,u,h,p,S,j){return i===null||i.nativeEvent!==j?(i={blockedOn:u,domEventName:h,eventSystemFlags:p,nativeEvent:j,targetContainers:[S]},u!==null&&(u=qt(u),u!==null&&tb(u)),i):(i.eventSystemFlags|=p,u=i.targetContainers,S!==null&&u.indexOf(S)===-1&&u.push(S),i)}function wE(i,u,h,p,S){switch(u){case"focusin":return Xc=Jh(Xc,i,u,h,p,S),!0;case"dragenter":return Kc=Jh(Kc,i,u,h,p,S),!0;case"mouseover":return Jc=Jh(Jc,i,u,h,p,S),!0;case"pointerover":var j=S.pointerId;return Xh.set(j,Jh(Xh.get(j)||null,i,u,h,p,S)),!0;case"gotpointercapture":return j=S.pointerId,Kh.set(j,Jh(Kh.get(j)||null,i,u,h,p,S)),!0}return!1}function sb(i){var u=Rt(i.target);if(u!==null){var h=s(u);if(h!==null){if(u=h.tag,u===13){if(u=l(h),u!==null){i.blockedOn=u,Se(i.priority,function(){rb(h)});return}}else if(u===31){if(u=c(h),u!==null){i.blockedOn=u,Se(i.priority,function(){rb(h)});return}}else if(u===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Wm(i){if(i.blockedOn!==null)return!1;for(var u=i.targetContainers;0<u.length;){var h=Lg(i.nativeEvent);if(h===null){h=i.nativeEvent;var p=new h.constructor(h.type,h);go=p,h.target.dispatchEvent(p),go=null}else return u=qt(h),u!==null&&tb(u),i.blockedOn=h,!1;u.shift()}return!0}function ib(i,u,h){Wm(i)&&h.delete(u)}function SE(){Mg=!1,Xc!==null&&Wm(Xc)&&(Xc=null),Kc!==null&&Wm(Kc)&&(Kc=null),Jc!==null&&Wm(Jc)&&(Jc=null),Xh.forEach(ib),Kh.forEach(ib)}function Vm(i,u){i.blockedOn===u&&(i.blockedOn=null,Mg||(Mg=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,SE)))}var Gm=null;function ob(i){Gm!==i&&(Gm=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Gm===i&&(Gm=null);for(var u=0;u<i.length;u+=3){var h=i[u],p=i[u+1],S=i[u+2];if(typeof p!="function"){if(Pg(p||h)===null)continue;break}var j=qt(h);j!==null&&(i.splice(u,3),u-=3,L1(j,{pending:!0,data:S,method:h.method,action:p},p,S))}}))}function kd(i){function u(Te){return Vm(Te,i)}Xc!==null&&Vm(Xc,i),Kc!==null&&Vm(Kc,i),Jc!==null&&Vm(Jc,i),Xh.forEach(u),Kh.forEach(u);for(var h=0;h<Zc.length;h++){var p=Zc[h];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Zc.length&&(h=Zc[0],h.blockedOn===null);)sb(h),h.blockedOn===null&&Zc.shift();if(h=(i.ownerDocument||i).$$reactFormReplay,h!=null)for(p=0;p<h.length;p+=3){var S=h[p],j=h[p+1],G=S[Ne]||null;if(typeof j=="function")G||ob(h);else if(G){var ue=null;if(j&&j.hasAttribute("formAction")){if(S=j,G=j[Ne]||null)ue=G.formAction;else if(Pg(S)!==null)continue}else ue=G.action;typeof ue=="function"?h[p+1]=ue:(h.splice(p,3),p-=3),ob(h)}}}function lb(){function i(j){j.canIntercept&&j.info==="react-transition"&&j.intercept({handler:function(){return new Promise(function(G){return S=G})},focusReset:"manual",scroll:"manual"})}function u(){S!==null&&(S(),S=null),p||setTimeout(h,20)}function h(){if(!p&&!navigation.transition){var j=navigation.currentEntry;j&&j.url!=null&&navigation.navigate(j.url,{state:j.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,S=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",u),navigation.addEventListener("navigateerror",u),setTimeout(h,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",u),navigation.removeEventListener("navigateerror",u),S!==null&&(S(),S=null)}}}function Ig(i){this._internalRoot=i}Ym.prototype.render=Ig.prototype.render=function(i){var u=this._internalRoot;if(u===null)throw Error(a(409));var h=u.current,p=Ai();Q_(h,p,i,u,null,null)},Ym.prototype.unmount=Ig.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var u=i.containerInfo;Q_(i.current,2,null,i,null,null),Am(),u[ke]=null}};function Ym(i){this._internalRoot=i}Ym.prototype.unstable_scheduleHydration=function(i){if(i){var u=ae();i={blockedOn:null,target:i,priority:u};for(var h=0;h<Zc.length&&u!==0&&u<Zc[h].priority;h++);Zc.splice(h,0,i),h===0&&sb(i)}};var cb=e.version;if(cb!=="19.2.0")throw Error(a(527,cb,"19.2.0"));Z.findDOMNode=function(i){var u=i._reactInternals;if(u===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=d(u),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var NE={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xm.isDisabled&&Xm.supportsFiber)try{Pt=Xm.inject(NE),zt=Xm}catch{}}return Qh.createRoot=function(i,u){if(!n(i))throw Error(a(299));var h=!1,p="",S=gy,j=vy,G=xy;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(p=u.identifierPrefix),u.onUncaughtError!==void 0&&(S=u.onUncaughtError),u.onCaughtError!==void 0&&(j=u.onCaughtError),u.onRecoverableError!==void 0&&(G=u.onRecoverableError)),u=J_(i,1,!1,null,null,h,p,null,S,j,G,lb),i[ke]=u.current,yg(i),new Ig(u)},Qh.hydrateRoot=function(i,u,h){if(!n(i))throw Error(a(299));var p=!1,S="",j=gy,G=vy,ue=xy,Te=null;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(S=h.identifierPrefix),h.onUncaughtError!==void 0&&(j=h.onUncaughtError),h.onCaughtError!==void 0&&(G=h.onCaughtError),h.onRecoverableError!==void 0&&(ue=h.onRecoverableError),h.formState!==void 0&&(Te=h.formState)),u=J_(i,1,!0,u,h??null,p,S,Te,j,G,ue,lb),u.context=Z_(null),h=u.current,p=Ai(),p=Ut(p),S=gr(p),S.callback=null,Tr(h,S,p),h=p,u.current.lanes=h,ar(u,h),vl(u),i[ke]=u.current,yg(i),new Ym(u)},Qh.version="19.2.0",Qh}var yb;function ME(){if(yb)return qg.exports;yb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),qg.exports=PE(),qg.exports}var IE=ME();const BE=qx(IE);var Qv=function(t,e){return Qv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},Qv(t,e)};function $S(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Qv(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ip=function(){return Ip=Object.assign||function(e){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ip.apply(this,arguments)};function lh(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(t);n<a.length;n++)e.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(r[a[n]]=t[a[n]]);return r}function WS(t,e,r,a){var n=arguments.length,s=n<3?e:a===null?a=Object.getOwnPropertyDescriptor(e,r):a,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,a);else for(var c=t.length-1;c>=0;c--)(l=t[c])&&(s=(n<3?l(s):n>3?l(e,r,s):l(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function VS(t,e){return function(r,a){e(r,a,t)}}function GS(t,e,r,a,n,s){function l(A){if(A!==void 0&&typeof A!="function")throw new TypeError("Function expected");return A}for(var c=a.kind,f=c==="getter"?"get":c==="setter"?"set":"value",d=!e&&t?a.static?t:t.prototype:null,m=e||(d?Object.getOwnPropertyDescriptor(d,a.name):{}),v,x=!1,g=r.length-1;g>=0;g--){var b={};for(var _ in a)b[_]=_==="access"?{}:a[_];for(var _ in a.access)b.access[_]=a.access[_];b.addInitializer=function(A){if(x)throw new TypeError("Cannot add initializers after decoration has completed");s.push(l(A||null))};var w=(0,r[g])(c==="accessor"?{get:m.get,set:m.set}:m[f],b);if(c==="accessor"){if(w===void 0)continue;if(w===null||typeof w!="object")throw new TypeError("Object expected");(v=l(w.get))&&(m.get=v),(v=l(w.set))&&(m.set=v),(v=l(w.init))&&n.unshift(v)}else(v=l(w))&&(c==="field"?n.unshift(v):m[f]=v)}d&&Object.defineProperty(d,a.name,m),x=!0}function YS(t,e,r){for(var a=arguments.length>2,n=0;n<e.length;n++)r=a?e[n].call(t,r):e[n].call(t);return a?r:void 0}function XS(t){return typeof t=="symbol"?t:"".concat(t)}function KS(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function JS(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Qt(t,e,r,a){function n(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function c(m){try{d(a.next(m))}catch(v){l(v)}}function f(m){try{d(a.throw(m))}catch(v){l(v)}}function d(m){m.done?s(m.value):n(m.value).then(c,f)}d((a=a.apply(t,e||[])).next())})}function ZS(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},a,n,s,l=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return l.next=c(0),l.throw=c(1),l.return=c(2),typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(d){return function(m){return f([d,m])}}function f(d){if(a)throw new TypeError("Generator is already executing.");for(;l&&(l=0,d[0]&&(r=0)),r;)try{if(a=1,n&&(s=d[0]&2?n.return:d[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,d[1])).done)return s;switch(n=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,n=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){r.label=d[1];break}if(d[0]===6&&r.label<s[1]){r.label=s[1],s=d;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(d);break}s[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(m){d=[6,m],n=0}finally{a=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var u1=Object.create?(function(t,e,r,a){a===void 0&&(a=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,a,n)}):(function(t,e,r,a){a===void 0&&(a=r),t[a]=e[r]});function QS(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&u1(e,t,r)}function Bp(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],a=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&a>=t.length&&(t=void 0),{value:t&&t[a++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Hx(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var a=r.call(t),n,s=[],l;try{for(;(e===void 0||e-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(c){l={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(l)throw l.error}}return s}function e4(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Hx(arguments[e]));return t}function t4(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var a=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],l=0,c=s.length;l<c;l++,n++)a[n]=s[l];return a}function r4(t,e,r){if(r||arguments.length===2)for(var a=0,n=e.length,s;a<n;a++)(s||!(a in e))&&(s||(s=Array.prototype.slice.call(e,0,a)),s[a]=e[a]);return t.concat(s||Array.prototype.slice.call(e))}function nh(t){return this instanceof nh?(this.v=t,this):new nh(t)}function a4(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r.apply(t,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),n[Symbol.asyncIterator]=function(){return this},n;function l(g){return function(b){return Promise.resolve(b).then(g,v)}}function c(g,b){a[g]&&(n[g]=function(_){return new Promise(function(w,A){s.push([g,_,w,A])>1||f(g,_)})},b&&(n[g]=b(n[g])))}function f(g,b){try{d(a[g](b))}catch(_){x(s[0][3],_)}}function d(g){g.value instanceof nh?Promise.resolve(g.value.v).then(m,v):x(s[0][2],g)}function m(g){f("next",g)}function v(g){f("throw",g)}function x(g,b){g(b),s.shift(),s.length&&f(s[0][0],s[0][1])}}function n4(t){var e,r;return e={},a("next"),a("throw",function(n){throw n}),a("return"),e[Symbol.iterator]=function(){return this},e;function a(n,s){e[n]=t[n]?function(l){return(r=!r)?{value:nh(t[n](l)),done:!1}:s?s(l):l}:s}}function s4(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Bp=="function"?Bp(t):t[Symbol.iterator](),r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r);function a(s){r[s]=t[s]&&function(l){return new Promise(function(c,f){l=t[s](l),n(c,f,l.done,l.value)})}}function n(s,l,c,f){Promise.resolve(f).then(function(d){s({value:d,done:c})},l)}}function i4(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var UE=Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e},ex=function(t){return ex=Object.getOwnPropertyNames||function(e){var r=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[r.length]=a);return r},ex(t)};function o4(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=ex(t),a=0;a<r.length;a++)r[a]!=="default"&&u1(e,t,r[a]);return UE(e,t),e}function l4(t){return t&&t.__esModule?t:{default:t}}function c4(t,e,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(t):a?a.value:e.get(t)}function u4(t,e,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}function f4(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function d4(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var a,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");a=e[Symbol.asyncDispose]}if(a===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");a=e[Symbol.dispose],r&&(n=a)}if(typeof a!="function")throw new TypeError("Object not disposable.");n&&(a=function(){try{n.call(this)}catch(s){return Promise.reject(s)}}),t.stack.push({value:e,dispose:a,async:r})}else r&&t.stack.push({async:!0});return e}var qE=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var a=new Error(r);return a.name="SuppressedError",a.error=t,a.suppressed=e,a};function h4(t){function e(s){t.error=t.hasError?new qE(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var r,a=0;function n(){for(;r=t.stack.pop();)try{if(!r.async&&a===1)return a=0,t.stack.push(r),Promise.resolve().then(n);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return a|=2,Promise.resolve(s).then(n,function(l){return e(l),n()})}else a|=1}catch(l){e(l)}if(a===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return n()}function m4(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,a,n,s,l){return a?e?".jsx":".js":n&&(!s||!l)?r:n+s+"."+l.toLowerCase()+"js"}):t}const zE={__extends:$S,__assign:Ip,__rest:lh,__decorate:WS,__param:VS,__esDecorate:GS,__runInitializers:YS,__propKey:XS,__setFunctionName:KS,__metadata:JS,__awaiter:Qt,__generator:ZS,__createBinding:u1,__exportStar:QS,__values:Bp,__read:Hx,__spread:e4,__spreadArrays:t4,__spreadArray:r4,__await:nh,__asyncGenerator:a4,__asyncDelegator:n4,__asyncValues:s4,__makeTemplateObject:i4,__importStar:o4,__importDefault:l4,__classPrivateFieldGet:c4,__classPrivateFieldSet:u4,__classPrivateFieldIn:f4,__addDisposableResource:d4,__disposeResources:h4,__rewriteRelativeImportExtension:m4},HE=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:d4,get __assign(){return Ip},__asyncDelegator:n4,__asyncGenerator:a4,__asyncValues:s4,__await:nh,__awaiter:Qt,__classPrivateFieldGet:c4,__classPrivateFieldIn:f4,__classPrivateFieldSet:u4,__createBinding:u1,__decorate:WS,__disposeResources:h4,__esDecorate:GS,__exportStar:QS,__extends:$S,__generator:ZS,__importDefault:l4,__importStar:o4,__makeTemplateObject:i4,__metadata:JS,__param:VS,__propKey:XS,__read:Hx,__rest:lh,__rewriteRelativeImportExtension:m4,__runInitializers:YS,__setFunctionName:KS,__spread:e4,__spreadArray:r4,__spreadArrays:t4,__values:Bp,default:zE},Symbol.toStringTag,{value:"Module"})),$E=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class $x extends Error{constructor(e,r="FunctionsError",a){super(e),this.name=r,this.context=a}}class WE extends $x{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class _b extends $x{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class bb extends $x{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var tx;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(tx||(tx={}));class VE{constructor(e,{headers:r={},customFetch:a,region:n=tx.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=$E(a)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Qt(this,arguments,void 0,function*(r,a={}){var n;let s,l;try{const{headers:c,method:f,body:d,signal:m,timeout:v}=a;let x={},{region:g}=a;g||(g=this.region);const b=new URL(`${this.url}/${r}`);g&&g!=="any"&&(x["x-region"]=g,b.searchParams.set("forceFunctionRegion",g));let _;d&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",_=d):typeof d=="string"?(x["Content-Type"]="text/plain",_=d):typeof FormData<"u"&&d instanceof FormData?_=d:(x["Content-Type"]="application/json",_=JSON.stringify(d)):_=d;let w=m;v&&(l=new AbortController,s=setTimeout(()=>l.abort(),v),m?(w=l.signal,m.addEventListener("abort",()=>l.abort())):w=l.signal);const A=yield this.fetch(b.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),c),body:_,signal:w}).catch(Y=>{throw new WE(Y)}),C=A.headers.get("x-relay-error");if(C&&C==="true")throw new _b(A);if(!A.ok)throw new bb(A);let E=((n=A.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),R;return E==="application/json"?R=yield A.json():E==="application/octet-stream"||E==="application/pdf"?R=yield A.blob():E==="text/event-stream"?R=A:E==="multipart/form-data"?R=yield A.formData():R=yield A.text(),{data:R,error:null,response:A}}catch(c){return{data:null,error:c,response:c instanceof bb||c instanceof _b?c.context:void 0}}finally{s&&clearTimeout(s)}})}}var ks={};const ch=EE(HE);var Km={},Jm={},Zm={},Qm={},ep={},tp={},wb;function p4(){if(wb)return tp;wb=1,Object.defineProperty(tp,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return tp.default=t,tp}var Sb;function g4(){if(Sb)return ep;Sb=1,Object.defineProperty(ep,"__esModule",{value:!0});const e=ch.__importDefault(p4());class r{constructor(n){var s,l;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(s=n.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=n.signal,this.isMaybeSingle=(l=n.isMaybeSingle)!==null&&l!==void 0?l:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,s){return this.headers=new Headers(this.headers),this.headers.set(n,s),this}then(n,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const l=this.fetch;let c=l(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var d,m,v,x;let g=null,b=null,_=null,w=f.status,A=f.statusText;if(f.ok){if(this.method!=="HEAD"){const Y=await f.text();Y===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?b=Y:b=JSON.parse(Y))}const E=(m=this.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),R=(v=f.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");E&&R&&R.length>1&&(_=parseInt(R[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(g={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,_=null,w=406,A="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const E=await f.text();try{g=JSON.parse(E),Array.isArray(g)&&f.status===404&&(b=[],g=null,w=200,A="OK")}catch{f.status===404&&E===""?(w=204,A="No Content"):g={message:E}}if(g&&this.isMaybeSingle&&(!((x=g?.details)===null||x===void 0)&&x.includes("0 rows"))&&(g=null,w=200,A="OK"),g&&this.shouldThrowOnError)throw new e.default(g)}return{error:g,data:b,count:_,status:w,statusText:A}});return this.shouldThrowOnError||(c=c.catch(f=>{var d,m,v,x,g,b;let _="";const w=f?.cause;if(w){const A=(d=w?.message)!==null&&d!==void 0?d:"",C=(m=w?.code)!==null&&m!==void 0?m:"";_=`${(v=f?.name)!==null&&v!==void 0?v:"FetchError"}: ${f?.message}`,_+=`

Caused by: ${(x=w?.name)!==null&&x!==void 0?x:"Error"}: ${A}`,C&&(_+=` (${C})`),w?.stack&&(_+=`
${w.stack}`)}else _=(g=f?.stack)!==null&&g!==void 0?g:"";return{error:{message:`${(b=f?.name)!==null&&b!==void 0?b:"FetchError"}: ${f?.message}`,details:_,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),c.then(n,s)}returns(){return this}overrideTypes(){return this}}return ep.default=r,ep}var Nb;function v4(){if(Nb)return Qm;Nb=1,Object.defineProperty(Qm,"__esModule",{value:!0});const e=ch.__importDefault(g4());class r extends e.default{select(n){let s=!1;const l=(n??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join("");return this.url.searchParams.set("select",l),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:s=!0,nullsFirst:l,foreignTable:c,referencedTable:f=c}={}){const d=f?`${f}.order`:"order",m=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${m?`${m},`:""}${n}.${s?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:s,referencedTable:l=s}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${n}`),this}range(n,s,{foreignTable:l,referencedTable:c=l}={}){const f=typeof c>"u"?"offset":`${c}.offset`,d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(f,`${n}`),this.url.searchParams.set(d,`${s-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:s=!1,settings:l=!1,buffers:c=!1,wal:f=!1,format:d="text"}={}){var m;const v=[n?"analyze":null,s?"verbose":null,l?"settings":null,c?"buffers":null,f?"wal":null].filter(Boolean).join("|"),x=(m=this.headers.get("Accept"))!==null&&m!==void 0?m:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${x}"; options=${v};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return Qm.default=r,Qm}var kb;function Wx(){if(kb)return Zm;kb=1,Object.defineProperty(Zm,"__esModule",{value:!0});const e=ch.__importDefault(v4()),r=new RegExp("[,()]");class a extends e.default{eq(s,l){return this.url.searchParams.append(s,`eq.${l}`),this}neq(s,l){return this.url.searchParams.append(s,`neq.${l}`),this}gt(s,l){return this.url.searchParams.append(s,`gt.${l}`),this}gte(s,l){return this.url.searchParams.append(s,`gte.${l}`),this}lt(s,l){return this.url.searchParams.append(s,`lt.${l}`),this}lte(s,l){return this.url.searchParams.append(s,`lte.${l}`),this}like(s,l){return this.url.searchParams.append(s,`like.${l}`),this}likeAllOf(s,l){return this.url.searchParams.append(s,`like(all).{${l.join(",")}}`),this}likeAnyOf(s,l){return this.url.searchParams.append(s,`like(any).{${l.join(",")}}`),this}ilike(s,l){return this.url.searchParams.append(s,`ilike.${l}`),this}ilikeAllOf(s,l){return this.url.searchParams.append(s,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(s,l){return this.url.searchParams.append(s,`ilike(any).{${l.join(",")}}`),this}regexMatch(s,l){return this.url.searchParams.append(s,`match.${l}`),this}regexIMatch(s,l){return this.url.searchParams.append(s,`imatch.${l}`),this}is(s,l){return this.url.searchParams.append(s,`is.${l}`),this}isDistinct(s,l){return this.url.searchParams.append(s,`isdistinct.${l}`),this}in(s,l){const c=Array.from(new Set(l)).map(f=>typeof f=="string"&&r.test(f)?`"${f}"`:`${f}`).join(",");return this.url.searchParams.append(s,`in.(${c})`),this}contains(s,l){return typeof l=="string"?this.url.searchParams.append(s,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(s,`cs.{${l.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(l)}`),this}containedBy(s,l){return typeof l=="string"?this.url.searchParams.append(s,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(s,`cd.{${l.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(l)}`),this}rangeGt(s,l){return this.url.searchParams.append(s,`sr.${l}`),this}rangeGte(s,l){return this.url.searchParams.append(s,`nxl.${l}`),this}rangeLt(s,l){return this.url.searchParams.append(s,`sl.${l}`),this}rangeLte(s,l){return this.url.searchParams.append(s,`nxr.${l}`),this}rangeAdjacent(s,l){return this.url.searchParams.append(s,`adj.${l}`),this}overlaps(s,l){return typeof l=="string"?this.url.searchParams.append(s,`ov.${l}`):this.url.searchParams.append(s,`ov.{${l.join(",")}}`),this}textSearch(s,l,{config:c,type:f}={}){let d="";f==="plain"?d="pl":f==="phrase"?d="ph":f==="websearch"&&(d="w");const m=c===void 0?"":`(${c})`;return this.url.searchParams.append(s,`${d}fts${m}.${l}`),this}match(s){return Object.entries(s).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(s,l,c){return this.url.searchParams.append(s,`not.${l}.${c}`),this}or(s,{foreignTable:l,referencedTable:c=l}={}){const f=c?`${c}.or`:"or";return this.url.searchParams.append(f,`(${s})`),this}filter(s,l,c){return this.url.searchParams.append(s,`${l}.${c}`),this}}return Zm.default=a,Zm}var jb;function x4(){if(jb)return Jm;jb=1,Object.defineProperty(Jm,"__esModule",{value:!0});const e=ch.__importDefault(Wx());class r{constructor(n,{headers:s={},schema:l,fetch:c}){this.url=n,this.headers=new Headers(s),this.schema=l,this.fetch=c}select(n,s){const{head:l=!1,count:c}=s??{},f=l?"HEAD":"GET";let d=!1;const m=(n??"*").split("").map(v=>/\s/.test(v)&&!d?"":(v==='"'&&(d=!d),v)).join("");return this.url.searchParams.set("select",m),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:s,defaultToNull:l=!0}={}){var c;const f="POST";if(s&&this.headers.append("Prefer",`count=${s}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const d=n.reduce((m,v)=>m.concat(Object.keys(v)),[]);if(d.length>0){const m=[...new Set(d)].map(v=>`"${v}"`);this.url.searchParams.set("columns",m.join(","))}}return new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}upsert(n,{onConflict:s,ignoreDuplicates:l=!1,count:c,defaultToNull:f=!0}={}){var d;const m="POST";if(this.headers.append("Prefer",`resolution=${l?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),c&&this.headers.append("Prefer",`count=${c}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const v=n.reduce((x,g)=>x.concat(Object.keys(g)),[]);if(v.length>0){const x=[...new Set(v)].map(g=>`"${g}"`);this.url.searchParams.set("columns",x.join(","))}}return new e.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(n,{count:s}={}){var l;const c="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}delete({count:n}={}){var s;const l="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return Jm.default=r,Jm}var Eb;function GE(){if(Eb)return Km;Eb=1,Object.defineProperty(Km,"__esModule",{value:!0});const t=ch,e=t.__importDefault(x4()),r=t.__importDefault(Wx());class a{constructor(s,{headers:l={},schema:c,fetch:f}={}){this.url=s,this.headers=new Headers(l),this.schemaName=c,this.fetch=f}from(s){if(!s||typeof s!="string"||s.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const l=new URL(`${this.url}/${s}`);return new e.default(l,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new a(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,l={},{head:c=!1,get:f=!1,count:d}={}){var m;let v;const x=new URL(`${this.url}/rpc/${s}`);let g;c||f?(v=c?"HEAD":"GET",Object.entries(l).filter(([_,w])=>w!==void 0).map(([_,w])=>[_,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([_,w])=>{x.searchParams.append(_,w)})):(v="POST",g=l);const b=new Headers(this.headers);return d&&b.set("Prefer",`count=${d}`),new r.default({method:v,url:x,headers:b,schema:this.schemaName,body:g,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}}return Km.default=a,Km}var Ab;function YE(){if(Ab)return ks;Ab=1,Object.defineProperty(ks,"__esModule",{value:!0}),ks.PostgrestError=ks.PostgrestBuilder=ks.PostgrestTransformBuilder=ks.PostgrestFilterBuilder=ks.PostgrestQueryBuilder=ks.PostgrestClient=void 0;const t=ch,e=t.__importDefault(GE());ks.PostgrestClient=e.default;const r=t.__importDefault(x4());ks.PostgrestQueryBuilder=r.default;const a=t.__importDefault(Wx());ks.PostgrestFilterBuilder=a.default;const n=t.__importDefault(v4());ks.PostgrestTransformBuilder=n.default;const s=t.__importDefault(g4());ks.PostgrestBuilder=s.default;const l=t.__importDefault(p4());return ks.PostgrestError=l.default,ks.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:s.default,PostgrestError:l.default},ks}var y4=YE();const _4=qx(y4),XE=jE({__proto__:null,default:_4},[y4]),{PostgrestClient:KE,PostgrestQueryBuilder:c$,PostgrestFilterBuilder:u$,PostgrestTransformBuilder:f$,PostgrestBuilder:d$,PostgrestError:h$}=_4||XE;class JE{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,n=parseInt(a.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const a=this.getWebSocketConstructor();return new a(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const ZE="2.86.0",QE=`realtime-js/${ZE}`,b4="1.0.0",eA="2.0.0",Cb=b4,rx=1e4,tA=1e3,rA=100;var af;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(af||(af={}));var Gn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Gn||(Gn={}));var Wo;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Wo||(Wo={}));var ax;(function(t){t.websocket="websocket"})(ax||(ax={}));var nf;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(nf||(nf={}));class aA{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let a=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,a;const n=(a=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var r,a;const n=(a=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},l=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(e,r,a){var n,s;const l=e.topic,c=(n=e.ref)!==null&&n!==void 0?n:"",f=(s=e.join_ref)!==null&&s!==void 0?s:"",d=e.payload.event,m=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},v=Object.keys(m).length===0?"":JSON.stringify(m);if(f.length>255)throw new Error(`joinRef length ${f.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`metadata length ${v.length} exceeds maximum of 255`);const x=this.USER_BROADCAST_PUSH_META_LENGTH+f.length+c.length+l.length+d.length+v.length,g=new ArrayBuffer(this.HEADER_LENGTH+x);let b=new DataView(g),_=0;b.setUint8(_++,this.KINDS.userBroadcastPush),b.setUint8(_++,f.length),b.setUint8(_++,c.length),b.setUint8(_++,l.length),b.setUint8(_++,d.length),b.setUint8(_++,v.length),b.setUint8(_++,r),Array.from(f,A=>b.setUint8(_++,A.charCodeAt(0))),Array.from(c,A=>b.setUint8(_++,A.charCodeAt(0))),Array.from(l,A=>b.setUint8(_++,A.charCodeAt(0))),Array.from(d,A=>b.setUint8(_++,A.charCodeAt(0))),Array.from(v,A=>b.setUint8(_++,A.charCodeAt(0)));var w=new Uint8Array(g.byteLength+a.byteLength);return w.set(new Uint8Array(g),0),w.set(new Uint8Array(a),g.byteLength),w.buffer}decode(e,r){if(this._isArrayBuffer(e)){let a=this._binaryDecode(e);return r(a)}if(typeof e=="string"){const a=JSON.parse(e),[n,s,l,c,f]=a;return r({join_ref:n,ref:s,topic:l,event:c,payload:f})}return r({})}_binaryDecode(e){const r=new DataView(e),a=r.getUint8(0),n=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,n)}}_decodeUserBroadcast(e,r,a){const n=r.getUint8(1),s=r.getUint8(2),l=r.getUint8(3),c=r.getUint8(4);let f=this.HEADER_LENGTH+4;const d=a.decode(e.slice(f,f+n));f=f+n;const m=a.decode(e.slice(f,f+s));f=f+s;const v=a.decode(e.slice(f,f+l));f=f+l;const x=e.slice(f,e.byteLength),g=c===this.JSON_ENCODING?JSON.parse(a.decode(x)):x,b={type:this.BROADCAST_EVENT,event:m,payload:g};return l>0&&(b.meta=JSON.parse(v)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([a])=>r.includes(a)))}}class w4{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ta;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ta||(Ta={}));const Tb=(t,e,r={})=>{var a;const n=(a=r.skipTypes)!==null&&a!==void 0?a:[];return e?Object.keys(e).reduce((s,l)=>(s[l]=nA(l,t,e,n),s),{}):{}},nA=(t,e,r,a)=>{const n=e.find(c=>c.name===t),s=n?.type,l=r[t];return s&&!a.includes(s)?S4(s,l):nx(l)},S4=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return lA(e,r)}switch(t){case Ta.bool:return sA(e);case Ta.float4:case Ta.float8:case Ta.int2:case Ta.int4:case Ta.int8:case Ta.numeric:case Ta.oid:return iA(e);case Ta.json:case Ta.jsonb:return oA(e);case Ta.timestamp:return cA(e);case Ta.abstime:case Ta.date:case Ta.daterange:case Ta.int4range:case Ta.int8range:case Ta.money:case Ta.reltime:case Ta.text:case Ta.time:case Ta.timestamptz:case Ta.timetz:case Ta.tsrange:case Ta.tstzrange:return nx(e);default:return nx(e)}},nx=t=>t,sA=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},iA=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},oA=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},lA=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,a=t[r];if(t[0]==="{"&&a==="}"){let s;const l=t.slice(1,r);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(c=>S4(e,c))}return t},cA=t=>typeof t=="string"?t.replace(" ","T"):t,N4=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Wg{constructor(e,r,a={},n=rx){this.channel=e,this.event=r,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var a;return this._hasReceived(e)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(a=>a.status===e).forEach(a=>a.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ob;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Ob||(Ob={}));class c0{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:s,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=c0.syncState(this.state,n,s,l),this.pendingDiffs.forEach(f=>{this.state=c0.syncDiff(this.state,f,s,l)}),this.pendingDiffs=[],c()}),this.channel._on(a.diff,{},n=>{const{onJoin:s,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=c0.syncDiff(this.state,n,s,l),c())}),this.onJoin((n,s,l)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:s,newPresences:l})}),this.onLeave((n,s,l)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,a,n){const s=this.cloneDeep(e),l=this.transformState(r),c={},f={};return this.map(s,(d,m)=>{l[d]||(f[d]=m)}),this.map(l,(d,m)=>{const v=s[d];if(v){const x=m.map(w=>w.presence_ref),g=v.map(w=>w.presence_ref),b=m.filter(w=>g.indexOf(w.presence_ref)<0),_=v.filter(w=>x.indexOf(w.presence_ref)<0);b.length>0&&(c[d]=b),_.length>0&&(f[d]=_)}else c[d]=m}),this.syncDiff(s,{joins:c,leaves:f},a,n)}static syncDiff(e,r,a,n){const{joins:s,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(s,(c,f)=>{var d;const m=(d=e[c])!==null&&d!==void 0?d:[];if(e[c]=this.cloneDeep(f),m.length>0){const v=e[c].map(g=>g.presence_ref),x=m.filter(g=>v.indexOf(g.presence_ref)<0);e[c].unshift(...x)}a(c,m,f)}),this.map(l,(c,f)=>{let d=e[c];if(!d)return;const m=f.map(v=>v.presence_ref);d=d.filter(v=>m.indexOf(v.presence_ref)<0),e[c]=d,n(c,d,f),d.length===0&&delete e[c]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(a=>r(a,e[a]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,a)=>{const n=e[a];return"metas"in n?r[a]=n.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[a]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Rb;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Rb||(Rb={}));var u0;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(u0||(u0={}));var sc;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(sc||(sc={}));class Vx{constructor(e,r={config:{}},a){var n,s;if(this.topic=e,this.params=r,this.socket=a,this.bindings={},this.state=Gn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Wg(this,Wo.join,this.params,this.timeout),this.rejoinTimer=new w4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Gn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Gn.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Gn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Wo.reply,{},(l,c)=>{this._trigger(this._replyEventName(c),l)}),this.presence=new c0(this),this.broadcastEndpointURL=N4(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var a,n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Gn.closed){const{config:{broadcast:l,presence:c,private:f}}=this.params,d=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(g=>g.filter))!==null&&n!==void 0?n:[],m=!!this.bindings[u0.PRESENCE]&&this.bindings[u0.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,v={},x={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:m}),postgres_changes:d,private:f};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(g=>e?.(sc.CHANNEL_ERROR,g)),this._onClose(()=>e?.(sc.CLOSED)),this.updateJoinPayload(Object.assign({config:x},v)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:g})=>{var b;if(this.socket.setAuth(),g===void 0){e?.(sc.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,w=(b=_?.length)!==null&&b!==void 0?b:0,A=[];for(let C=0;C<w;C++){const E=_[C],{filter:{event:R,schema:Y,table:W,filter:B}}=E,q=g&&g[C];if(q&&q.event===R&&q.schema===Y&&q.table===W&&q.filter===B)A.push(Object.assign(Object.assign({},E),{id:q.id}));else{this.unsubscribe(),this.state=Gn.errored,e?.(sc.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,e&&e(sc.SUBSCRIBED);return}}).receive("error",g=>{this.state=Gn.errored,e?.(sc.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e?.(sc.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,a){return this.state===Gn.joined&&e===u0.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,a)}async httpSend(e,r,a={}){var n;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const l={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=a.timeout)!==null&&n!==void 0?n:this.timeout);if(c.status===202)return{success:!0};let f=c.statusText;try{const d=await c.json();f=d.error||d.message||f}catch{}return Promise.reject(new Error(f))}async send(e,r={}){var a,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:l}=e,f={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=d.body)===null||n===void 0?void 0:n.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,c,f;const d=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((f=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||f===void 0)&&f.ack)&&s("ok"),d.receive("ok",()=>s("ok")),d.receive("error",()=>s("error")),d.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Gn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Wo.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new Wg(this,Wo.leave,{},e),a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Gn.closed,this.bindings={}}async _fetchWithTimeout(e,r,a){const n=new AbortController,s=setTimeout(()=>n.abort(),a),l=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(s),l}_push(e,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Wg(this,e,r,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>rA){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,a){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,a){var n,s;const l=e.toLocaleLowerCase(),{close:c,error:f,leave:d,join:m}=Wo;if(a&&[c,f,d,m].indexOf(l)>=0&&a!==this._joinRef())return;let x=this._onMessage(l,r,a);if(r&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(g=>{var b,_,w;return((b=g.filter)===null||b===void 0?void 0:b.event)==="*"||((w=(_=g.filter)===null||_===void 0?void 0:_.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===l}).map(g=>g.callback(x,a)):(s=this.bindings[l])===null||s===void 0||s.filter(g=>{var b,_,w,A,C,E;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in g){const R=g.id,Y=(b=g.filter)===null||b===void 0?void 0:b.event;return R&&((_=r.ids)===null||_===void 0?void 0:_.includes(R))&&(Y==="*"||Y?.toLocaleLowerCase()===((w=r.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const R=(C=(A=g?.filter)===null||A===void 0?void 0:A.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return R==="*"||R===((E=r?.event)===null||E===void 0?void 0:E.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===l}).map(g=>{if(typeof x=="object"&&"ids"in x){const b=x.data,{schema:_,table:w,commit_timestamp:A,type:C,errors:E}=b;x=Object.assign(Object.assign({},{schema:_,table:w,commit_timestamp:A,eventType:C,new:{},old:{},errors:E}),this._getPayloadRecords(b))}g.callback(x,a)})}_isClosed(){return this.state===Gn.closed}_isJoined(){return this.state===Gn.joined}_isJoining(){return this.state===Gn.joining}_isLeaving(){return this.state===Gn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,a){const n=e.toLocaleLowerCase(),s={type:n,filter:r,callback:a};return this.bindings[n]?this.bindings[n].push(s):this.bindings[n]=[s],this}_off(e,r){const a=e.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var s;return!(((s=n.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===a&&Vx.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const a in e)if(e[a]!==r[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Wo.close,{},e)}_onError(e){this._on(Wo.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Gn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Tb(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Tb(e.columns,e.old_record)),r}}const Vg=()=>{},rp={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},uA=[1e3,2e3,5e3,1e4],fA=1e4,dA=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class hA{constructor(e,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=rx,this.transport=null,this.heartbeatIntervalMs=rp.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Vg,this.ref=0,this.reconnectTimer=null,this.vsn=Cb,this.logger=Vg,this.conn=null,this.sendBuffer=[],this.serializer=new aA,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...s)=>n(...s):(...s)=>fetch(...s),!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${ax.websocket}`,this.httpEndpoint=N4(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=JE.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,a){this.logger(e,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case af.connecting:return nf.Connecting;case af.open:return nf.Open;case af.closing:return nf.Closing;default:return nf.Closed}}isConnected(){return this.connectionState()===nf.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const a=`realtime:${e}`,n=this.getChannels().find(s=>s.topic===a);if(n)return n;{const s=new Vx(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:a,payload:n,ref:s}=e,l=()=>{this.encode(e,c=>{var f;(f=this.conn)===null||f===void 0||f.send(c)})};this.log("push",`${r} ${a} (${s})`,n),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(tA,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},rp.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(a=>a.topic===e&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:n,payload:s,ref:l}=r,c=l?`(${l})`:"",f=s.status||"";this.log("receive",`${f} ${a} ${n} ${c}`.trim(),s),this.channels.filter(d=>d._isMember(a)).forEach(d=>d._trigger(n,s,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===af.open||this.conn.readyState===af.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Wo.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const a=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${a}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const a=new Blob([dA],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const n={access_token:r,version:QE};r&&a.updateJoinPayload(n),a.joinedOnce&&a._isJoined()&&a._push(Wo.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(a=>{try{a(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(a){this.log("error",`error triggering ${e} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new w4(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},rp.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,a,n,s,l,c,f,d,m,v,x,g;switch(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=e?.timeout)!==null&&a!==void 0?a:rx,this.heartbeatIntervalMs=(n=e?.heartbeatIntervalMs)!==null&&n!==void 0?n:rp.HEARTBEAT_INTERVAL,this.worker=(s=e?.worker)!==null&&s!==void 0?s:!1,this.accessToken=(l=e?.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(c=e?.heartbeatCallback)!==null&&c!==void 0?c:Vg,this.vsn=(f=e?.vsn)!==null&&f!==void 0?f:Cb,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(b=>uA[b-1]||fA),this.vsn){case b4:this.encode=(m=e?.encode)!==null&&m!==void 0?m:((b,_)=>_(JSON.stringify(b))),this.decode=(v=e?.decode)!==null&&v!==void 0?v:((b,_)=>_(JSON.parse(b)));break;case eA:this.encode=(x=e?.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(g=e?.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class f1 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Qa(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class mA extends f1{constructor(e,r,a){super(e),this.name="StorageApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class sx extends f1{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const Gx=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),pA=()=>Response,ix=t=>{if(Array.isArray(t))return t.map(r=>ix(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,a])=>{const n=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[n]=ix(a)}),e},gA=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},vA=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t),Gg=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},xA=(t,e,r)=>Qt(void 0,void 0,void 0,function*(){const a=yield pA();t instanceof a&&!r?.noResolveJson?t.json().then(n=>{const s=t.status||500,l=n?.statusCode||s+"";e(new mA(Gg(n),s,l))}).catch(n=>{e(new sx(Gg(n),n))}):e(new sx(Gg(t),t))}),yA=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"||!a?n:(gA(a)?(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(a)):n.body=a,e?.duplex&&(n.duplex=e.duplex),Object.assign(Object.assign({},n),r))};function W0(t,e,r,a,n,s){return Qt(this,void 0,void 0,function*(){return new Promise((l,c)=>{t(r,yA(e,a,n,s)).then(f=>{if(!f.ok)throw f;return a?.noResolveJson?f:f.json()}).then(f=>l(f)).catch(f=>xA(f,c,a))})})}function S0(t,e,r,a){return Qt(this,void 0,void 0,function*(){return W0(t,"GET",e,r,a)})}function $o(t,e,r,a,n){return Qt(this,void 0,void 0,function*(){return W0(t,"POST",e,a,n,r)})}function ox(t,e,r,a,n){return Qt(this,void 0,void 0,function*(){return W0(t,"PUT",e,a,n,r)})}function _A(t,e,r,a){return Qt(this,void 0,void 0,function*(){return W0(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}function Yx(t,e,r,a,n){return Qt(this,void 0,void 0,function*(){return W0(t,"DELETE",e,a,n,r)})}class bA{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return Qt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Qa(e))return{data:null,error:e};throw e}})}}var k4;class wA{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[k4]="BlobDownloadBuilder",this.promise=null}asStream(){return new bA(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Qt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Qa(e))return{data:null,error:e};throw e}})}}k4=Symbol.toStringTag;const SA={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Db={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class NA{constructor(e,r={},a,n){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=a,this.fetch=Gx(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,a,n){return Qt(this,void 0,void 0,function*(){try{let s;const l=Object.assign(Object.assign({},Db),n);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const f=l.metadata;typeof Blob<"u"&&a instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),f&&s.append("metadata",this.encodeMetadata(f)),s.append("",a)):typeof FormData<"u"&&a instanceof FormData?(s=a,s.has("cacheControl")||s.append("cacheControl",l.cacheControl),f&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(f))):(s=a,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,f&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(f))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!l.duplex&&(l.duplex="half")),n?.headers&&(c=Object.assign(Object.assign({},c),n.headers));const d=this._removeEmptyFolders(r),m=this._getFinalPath(d),v=yield(e=="PUT"?ox:$o)(this.fetch,`${this.url}/object/${m}`,s,Object.assign({headers:c},l?.duplex?{duplex:l.duplex}:{}));return{data:{path:d,id:v.Id,fullPath:v.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qa(s))return{data:null,error:s};throw s}})}upload(e,r,a){return Qt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,a)})}uploadToSignedUrl(e,r,a,n){return Qt(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),l=this._getFinalPath(s),c=new URL(this.url+`/object/upload/sign/${l}`);c.searchParams.set("token",r);try{let f;const d=Object.assign({upsert:Db.upsert},n),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&a instanceof Blob?(f=new FormData,f.append("cacheControl",d.cacheControl),f.append("",a)):typeof FormData<"u"&&a instanceof FormData?(f=a,f.append("cacheControl",d.cacheControl)):(f=a,m["cache-control"]=`max-age=${d.cacheControl}`,m["content-type"]=d.contentType);const v=yield ox(this.fetch,c.toString(),f,{headers:m});return{data:{path:s,fullPath:v.Key},error:null}}catch(f){if(this.shouldThrowOnError)throw f;if(Qa(f))return{data:null,error:f};throw f}})}createSignedUploadUrl(e,r){return Qt(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e);const n=Object.assign({},this.headers);r?.upsert&&(n["x-upsert"]="true");const s=yield $o(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:n}),l=new URL(this.url+s.url),c=l.searchParams.get("token");if(!c)throw new f1("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:c},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Qa(a))return{data:null,error:a};throw a}})}update(e,r,a){return Qt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,a)})}move(e,r,a){return Qt(this,void 0,void 0,function*(){try{return{data:yield $o(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qa(n))return{data:null,error:n};throw n}})}copy(e,r,a){return Qt(this,void 0,void 0,function*(){try{return{data:{path:(yield $o(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qa(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,a){return Qt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),s=yield $o(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},a?.transform?{transform:a.transform}:{}),{headers:this.headers});const l=a?.download?`&download=${a.download===!0?"":a.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${l}`)},{data:s,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qa(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,a){return Qt(this,void 0,void 0,function*(){try{const n=yield $o(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),s=a?.download?`&download=${a.download===!0?"":a.download}`:"";return{data:n.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${s}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qa(n))return{data:null,error:n};throw n}})}download(e,r){const n=typeof r?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(r?.transform||{}),l=s?`?${s}`:"",c=this._getFinalPath(e),f=()=>S0(this.fetch,`${this.url}/${n}/${c}${l}`,{headers:this.headers,noResolveJson:!0});return new wA(f,this.shouldThrowOnError)}info(e){return Qt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const a=yield S0(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:ix(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Qa(a))return{data:null,error:a};throw a}})}exists(e){return Qt(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield _A(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Qa(a)&&a instanceof sx){const n=a.originalError;if([400,404].includes(n?.status))return{data:!1,error:a}}throw a}})}getPublicUrl(e,r){const a=this._getFinalPath(e),n=[],s=r?.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&n.push(s);const c=typeof r?.transform<"u"?"render/image":"object",f=this.transformOptsToQueryString(r?.transform||{});f!==""&&n.push(f);let d=n.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${a}${d}`)}}}remove(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield Yx(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qa(r))return{data:null,error:r};throw r}})}list(e,r,a){return Qt(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},SA),r),{prefix:e||""});return{data:yield $o(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},a),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qa(n))return{data:null,error:n};throw n}})}listV2(e,r){return Qt(this,void 0,void 0,function*(){try{const a=Object.assign({},e);return{data:yield $o(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Qa(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const j4="2.86.0",E4={"X-Client-Info":`storage-js/${j4}`};class kA{constructor(e,r={},a,n){this.shouldThrowOnError=!1;const s=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},E4),r),this.fetch=Gx(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return Qt(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield S0(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qa(r))return{data:null,error:r};throw r}})}getBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield S0(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qa(r))return{data:null,error:r};throw r}})}createBucket(e){return Qt(this,arguments,void 0,function*(r,a={public:!1}){try{return{data:yield $o(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Qa(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return Qt(this,void 0,void 0,function*(){try{return{data:yield ox(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Qa(a))return{data:null,error:a};throw a}})}emptyBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield $o(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qa(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield Yx(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qa(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}var N0=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function jA(t,e,r){const a=new URL(e,t);if(r)for(const[n,s]of Object.entries(r))s!==void 0&&a.searchParams.set(n,s);return a.toString()}async function EA(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function AA(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:n,body:s,headers:l}){const c=jA(t.baseUrl,a,n),f=await EA(t.auth),d=await e(c,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...f,...l},body:s?JSON.stringify(s):void 0}),m=await d.text(),v=(d.headers.get("content-type")||"").includes("application/json"),x=v&&m?JSON.parse(m):m;if(!d.ok){const g=v?x:void 0,b=g?.error;throw new N0(b?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:b?.type,icebergCode:b?.code,details:g})}return{status:d.status,headers:d.headers,data:x}}}}function ap(t){return t.join("")}var CA=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:ap(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ap(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ap(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ap(t.namespace)}`}),!0}catch(e){if(e instanceof N0&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof N0&&r.status===409)return;throw r}}};function jd(t){return t.join("")}var TA=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${jd(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${jd(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${jd(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${jd(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${jd(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${jd(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof N0&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof N0&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},OA=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=AA({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new CA(this.client,e),this.tableOps=new TA(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}};class RA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},E4),r),this.fetch=Gx(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield $o(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qa(r))return{data:null,error:r};throw r}})}listBuckets(e){return Qt(this,void 0,void 0,function*(){try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const a=r.toString(),n=a?`${this.url}/bucket?${a}`:`${this.url}/bucket`;return{data:yield S0(this.fetch,n,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qa(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield Yx(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qa(r))return{data:null,error:r};throw r}})}from(e){if(!vA(e))throw new f1("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");return new OA({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>Qt(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch})}}const Xx={"X-Client-Info":`storage-js/${j4}`,"Content-Type":"application/json"};class A4 extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Fi(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class Yg extends A4{constructor(e,r,a){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class DA extends A4{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var Fb;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Fb||(Fb={}));const Kx=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),FA=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Lb=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),LA=(t,e,r)=>Qt(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!r?.noResolveJson){const n=t.status||500,s=t;if(typeof s.json=="function")s.json().then(l=>{const c=l?.statusCode||l?.code||n+"";e(new Yg(Lb(l),n,c))}).catch(()=>{const l=n+"",c=s.statusText||`HTTP ${n} error`;e(new Yg(c,n,l))});else{const l=n+"",c=s.statusText||`HTTP ${n} error`;e(new Yg(c,n,l))}}else e(new DA(Lb(t),t))}),PA=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return a?(FA(a)?(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(a)):n.body=a,Object.assign(Object.assign({},n),r)):n};function MA(t,e,r,a,n,s){return Qt(this,void 0,void 0,function*(){return new Promise((l,c)=>{t(r,PA(e,a,n,s)).then(f=>{if(!f.ok)throw f;if(a?.noResolveJson)return f;const d=f.headers.get("content-type");return!d||!d.includes("application/json")?{}:f.json()}).then(f=>l(f)).catch(f=>LA(f,c,a))})})}function Li(t,e,r,a,n){return Qt(this,void 0,void 0,function*(){return MA(t,"POST",e,a,n,r)})}class IA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Xx),r),this.fetch=Kx(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return Qt(this,void 0,void 0,function*(){try{return{data:(yield Li(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}getIndex(e,r){return Qt(this,void 0,void 0,function*(){try{return{data:yield Li(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Fi(a))return{data:null,error:a};throw a}})}listIndexes(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield Li(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return Qt(this,void 0,void 0,function*(){try{return{data:(yield Li(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Fi(a))return{data:null,error:a};throw a}})}}class BA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Xx),r),this.fetch=Kx(a)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return Qt(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Li(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}getVectors(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield Li(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}listVectors(e){return Qt(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Li(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}queryVectors(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield Li(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}deleteVectors(e){return Qt(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Li(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}}class UA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Xx),r),this.fetch=Kx(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:(yield Li(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}getBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield Li(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}listBuckets(){return Qt(this,arguments,void 0,function*(e={}){try{return{data:yield Li(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:(yield Li(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fi(r))return{data:null,error:r};throw r}})}}class qA extends UA{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new zA(this.url,this.headers,e,this.fetch)}createBucket(e){const r=Object.create(null,{createBucket:{get:()=>super.createBucket}});return Qt(this,void 0,void 0,function*(){return r.createBucket.call(this,e)})}getBucket(e){const r=Object.create(null,{getBucket:{get:()=>super.getBucket}});return Qt(this,void 0,void 0,function*(){return r.getBucket.call(this,e)})}listBuckets(){const e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return Qt(this,arguments,void 0,function*(r={}){return e.listBuckets.call(this,r)})}deleteBucket(e){const r=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return Qt(this,void 0,void 0,function*(){return r.deleteBucket.call(this,e)})}}class zA extends IA{constructor(e,r,a,n){super(e,r,n),this.vectorBucketName=a}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Qt(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Qt(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Qt(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Qt(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new HA(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class HA extends BA{constructor(e,r,a,n,s){super(e,r,s),this.vectorBucketName=a,this.indexName=n}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Qt(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Qt(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Qt(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Qt(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Qt(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class $A extends kA{constructor(e,r={},a,n){super(e,r,a,n)}from(e){return new NA(this.url,this.headers,e,this.fetch)}get vectors(){return new qA(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new RA(this.url+"/iceberg",this.headers,this.fetch)}}const WA="2.86.0";let s0="";typeof Deno<"u"?s0="deno":typeof document<"u"?s0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?s0="react-native":s0="node";const VA={"X-Client-Info":`supabase-js-${s0}/${WA}`},GA={headers:VA},YA={schema:"public"},XA={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},KA={},JA=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),ZA=()=>Headers,QA=(t,e,r)=>{const a=JA(r),n=ZA();return async(s,l)=>{var c;const f=(c=await e())!==null&&c!==void 0?c:t;let d=new n(l?.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${f}`),a(s,Object.assign(Object.assign({},l),{headers:d}))}};function e6(t){return t.endsWith("/")?t:t+"/"}function t6(t,e){var r,a;const{db:n,auth:s,realtime:l,global:c}=t,{db:f,auth:d,realtime:m,global:v}=e,x={db:Object.assign(Object.assign({},f),n),auth:Object.assign(Object.assign({},d),s),realtime:Object.assign(Object.assign({},m),l),storage:{},global:Object.assign(Object.assign(Object.assign({},v),c),{headers:Object.assign(Object.assign({},(r=v?.headers)!==null&&r!==void 0?r:{}),(a=c?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return t.accessToken?x.accessToken=t.accessToken:delete x.accessToken,x}function r6(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(e6(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const C4="2.86.0",Bd=30*1e3,lx=3,Xg=lx*Bd,a6="http://localhost:9999",n6="supabase.auth.token",s6={"X-Client-Info":`gotrue-js/${C4}`},cx="X-Supabase-Api-Version",T4={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},i6=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,o6=600*1e3;class k0 extends Error{constructor(e,r,a){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function lr(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class l6 extends k0{constructor(e,r,a){super(e,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function c6(t){return lr(t)&&t.name==="AuthApiError"}class sf extends k0{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class yu extends k0{constructor(e,r,a,n){super(e,a,n),this.name=r,this.status=a}}class Oi extends yu{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function u6(t){return lr(t)&&t.name==="AuthSessionMissingError"}class Ed extends yu{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class np extends yu{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class sp extends yu{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function f6(t){return lr(t)&&t.name==="AuthImplicitGrantRedirectError"}class Pb extends yu{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ux extends yu{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Kg(t){return lr(t)&&t.name==="AuthRetryableFetchError"}class Mb extends yu{constructor(e,r,a){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class fx extends yu{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Up="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ib=` 	
\r=`.split(""),d6=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Ib.length;e+=1)t[Ib[e].charCodeAt(0)]=-2;for(let e=0;e<Up.length;e+=1)t[Up[e].charCodeAt(0)]=e;return t})();function Bb(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;r(Up[a]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;r(Up[a]),e.queuedBits-=6}}function O4(t,e,r){const a=d6[t];if(a>-1)for(e.queue=e.queue<<6|a,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Ub(t){const e=[],r=l=>{e.push(String.fromCodePoint(l))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},s=l=>{p6(l,a,r)};for(let l=0;l<t.length;l+=1)O4(t.charCodeAt(l),n,s);return e.join("")}function h6(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function m6(t,e){for(let r=0;r<t.length;r+=1){let a=t.charCodeAt(r);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}h6(a,e)}}function p6(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let a=1;a<6;a+=1)if((t>>7-a&1)===0){e.utf8seq=a;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Yd(t){const e=[],r={queue:0,queuedBits:0},a=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)O4(t.charCodeAt(n),r,a);return new Uint8Array(e)}function g6(t){const e=[];return m6(t,r=>e.push(r)),new Uint8Array(e)}function cf(t){const e=[],r={queue:0,queuedBits:0},a=n=>{e.push(n)};return t.forEach(n=>Bb(n,r,a)),Bb(null,r,a),e.join("")}function v6(t){return Math.round(Date.now()/1e3)+t}function x6(){return Symbol("auth-callback")}const vs=()=>typeof window<"u"&&typeof document<"u",Ju={tested:!1,writable:!1},R4=()=>{if(!vs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ju.tested)return Ju.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ju.tested=!0,Ju.writable=!0}catch{Ju.tested=!0,Ju.writable=!1}return Ju.writable};function y6(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,s)=>{e[s]=n})}catch{}return r.searchParams.forEach((a,n)=>{e[n]=a}),e}const D4=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),_6=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ud=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Zu=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},eu=async(t,e)=>{await t.removeItem(e)};class d1{constructor(){this.promise=new d1.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}d1.promiseConstructor=Promise;function Jg(t){const e=t.split(".");if(e.length!==3)throw new fx("Invalid JWT structure");for(let a=0;a<e.length;a++)if(!i6.test(e[a]))throw new fx("JWT not in base64url format");return{header:JSON.parse(Ub(e[0])),payload:JSON.parse(Ub(e[1])),signature:Yd(e[2]),raw:{header:e[0],payload:e[1]}}}async function b6(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function w6(t,e){return new Promise((a,n)=>{(async()=>{for(let s=0;s<1/0;s++)try{const l=await t(s);if(!e(s,null,l)){a(l);return}}catch(l){if(!e(s,l)){n(l);return}}})()})}function S6(t){return("0"+t.toString(16)).substr(-2)}function N6(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let n="";for(let s=0;s<56;s++)n+=r.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(e),Array.from(e,S6).join("")}async function k6(t){const r=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(a);return Array.from(n).map(s=>String.fromCharCode(s)).join("")}async function j6(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await k6(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ad(t,e,r=!1){const a=N6();let n=a;r&&(n+="/PASSWORD_RECOVERY"),await Ud(t,`${e}-code-verifier`,n);const s=await j6(a);return[s,a===s?"plain":"s256"]}const E6=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function A6(t){const e=t.headers.get(cx);if(!e||!e.match(E6))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function C6(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function T6(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const O6=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Cd(t){if(!O6.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Zg(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function R6(t,e){return new Proxy(t,{get:(r,a,n)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const s=a.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,n)}return!e.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,a,n)}})}function qb(t){return JSON.parse(JSON.stringify(t))}const tf=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),D6=[502,503,504];async function zb(t){var e;if(!_6(t))throw new ux(tf(t),0);if(D6.includes(t.status))throw new ux(tf(t),t.status);let r;try{r=await t.json()}catch(s){throw new sf(tf(s),s)}let a;const n=A6(t);if(n&&n.getTime()>=T4["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new Mb(tf(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(a==="session_not_found")throw new Oi}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0))throw new Mb(tf(r),t.status,r.weak_password.reasons);throw new l6(tf(r),t.status||500,a)}const F6=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),r))};async function yr(t,e,r,a){var n;const s=Object.assign({},a?.headers);s[cx]||(s[cx]=T4["2024-01-01"].name),a?.jwt&&(s.Authorization=`Bearer ${a.jwt}`);const l=(n=a?.query)!==null&&n!==void 0?n:{};a?.redirectTo&&(l.redirect_to=a.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",f=await L6(t,e,r+c,{headers:s,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(f):{data:Object.assign({},f),error:null}}async function L6(t,e,r,a,n,s){const l=F6(e,a,n,s);let c;try{c=await t(r,Object.assign({},l))}catch(f){throw console.error(f),new ux(tf(f),0)}if(c.ok||await zb(c),a?.noResolveJson)return c;try{return await c.json()}catch(f){await zb(f)}}function Ho(t){var e;let r=null;I6(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=v6(t.expires_in)));const a=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:a},error:null}}function Hb(t){const e=Ho(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(e.data.weak_password=t.weak_password),e}function ou(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function P6(t){return{data:t,error:null}}function M6(t){const{action_link:e,email_otp:r,hashed_token:a,redirect_to:n,verification_type:s}=t,l=lh(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:r,hashed_token:a,redirect_to:n,verification_type:s},f=Object.assign({},l);return{data:{properties:c,user:f},error:null}}function $b(t){return t}function I6(t){return t.access_token&&t.refresh_token&&t.expires_in}const Qg=["global","local","others"];class B6{constructor({url:e="",headers:r={},fetch:a}){this.url=e,this.headers=r,this.fetch=D4(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=Qg[0]){if(Qg.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Qg.join(", ")}`);try{return await yr(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(a){if(lr(a))return{data:null,error:a};throw a}}async inviteUserByEmail(e,r={}){try{return await yr(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ou})}catch(a){if(lr(a))return{data:{user:null},error:a};throw a}}async generateLink(e){try{const{options:r}=e,a=lh(e,["options"]),n=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(n.new_email=a?.newEmail,delete n.newEmail),await yr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:M6,redirectTo:r?.redirectTo})}catch(r){if(lr(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await yr(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ou})}catch(r){if(lr(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,a,n,s,l,c,f;try{const d={nextPage:null,lastPage:0,total:0},m=await yr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(s=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""},xform:$b});if(m.error)throw m.error;const v=await m.json(),x=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,g=(f=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&f!==void 0?f:[];return g.length>0&&(g.forEach(b=>{const _=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(b.split(";")[1].split("=")[1]);d[`${w}Page`]=_}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},v),d),error:null}}catch(d){if(lr(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Cd(e);try{return await yr(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ou})}catch(r){if(lr(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Cd(e);try{return await yr(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:ou})}catch(a){if(lr(a))return{data:{user:null},error:a};throw a}}async deleteUser(e,r=!1){Cd(e);try{return await yr(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:ou})}catch(a){if(lr(a))return{data:{user:null},error:a};throw a}}async _listFactors(e){Cd(e.userId);try{const{data:r,error:a}=await yr(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:a}}catch(r){if(lr(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Cd(e.userId),Cd(e.id);try{return{data:await yr(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(lr(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,a,n,s,l,c,f;try{const d={nextPage:null,lastPage:0,total:0},m=await yr(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(s=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""},xform:$b});if(m.error)throw m.error;const v=await m.json(),x=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,g=(f=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&f!==void 0?f:[];return g.length>0&&(g.forEach(b=>{const _=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(b.split(";")[1].split("=")[1]);d[`${w}Page`]=_}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},v),d),error:null}}catch(d){if(lr(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await yr(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(lr(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await yr(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(lr(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await yr(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(lr(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(e){try{return await yr(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(lr(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await yr(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(lr(r))return{data:null,error:r};throw r}}}function Wb(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const Td={debug:!!(globalThis&&R4()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class F4 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class U6 extends F4{}async function q6(t,e,r){Td.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const a=new globalThis.AbortController;return e>0&&setTimeout(()=>{a.abort(),Td.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){Td.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{Td.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Td.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new U6(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Td.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function z6(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function L4(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function H6(t){return parseInt(t,16)}function $6(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,a=>a.toString(16).padStart(2,"0")).join("")}function W6(t){var e;const{chainId:r,domain:a,expirationTime:n,issuedAt:s=new Date,nonce:l,notBefore:c,requestId:f,resources:d,scheme:m,uri:v,version:x}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!v)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const g=L4(t.address),b=m?`${m}://${a}`:a,_=t.statement?`${t.statement}
`:"",w=`${b} wants you to sign in with your Ethereum account:
${g}

${_}`;let A=`URI: ${v}
Version: ${x}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${s.toISOString()}`;if(n&&(A+=`
Expiration Time: ${n.toISOString()}`),c&&(A+=`
Not Before: ${c.toISOString()}`),f&&(A+=`
Request ID: ${f}`),d){let C=`
Resources:`;for(const E of d){if(!E||typeof E!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${E}`);C+=`
- ${E}`}A+=C}return`${w}
${A}`}class Pn extends Error{constructor({message:e,code:r,cause:a,name:n}){var s;super(e,{cause:a}),this.__isWebAuthnError=!0,this.name=(s=n??(a instanceof Error?a.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class qp extends Pn{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function V6({error:t,options:e}){var r,a,n;const{publicKey:s}=e;if(!s)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Pn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Pn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((a=s.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Pn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Pn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Pn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Pn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return s.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new Pn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Pn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const l=window.location.hostname;if(P4(l)){if(s.rp.id!==l)return new Pn({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Pn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Pn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Pn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Pn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function G6({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Pn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Pn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if(P4(a)){if(r.rpId!==a)return new Pn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Pn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Pn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Pn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class Y6{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const X6=new Y6;function K6(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:a}=t,n=lh(t,["challenge","user","excludeCredentials"]),s=Yd(e).buffer,l=Object.assign(Object.assign({},r),{id:Yd(r.id).buffer}),c=Object.assign(Object.assign({},n),{challenge:s,user:l});if(a&&a.length>0){c.excludeCredentials=new Array(a.length);for(let f=0;f<a.length;f++){const d=a[f];c.excludeCredentials[f]=Object.assign(Object.assign({},d),{id:Yd(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return c}function J6(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,a=lh(t,["challenge","allowCredentials"]),n=Yd(e).buffer,s=Object.assign(Object.assign({},a),{challenge:n});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const c=r[l];s.allowCredentials[l]=Object.assign(Object.assign({},c),{id:Yd(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return s}function Z6(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:cf(new Uint8Array(t.response.attestationObject)),clientDataJSON:cf(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Q6(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,a=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:cf(new Uint8Array(n.authenticatorData)),clientDataJSON:cf(new Uint8Array(n.clientDataJSON)),signature:cf(new Uint8Array(n.signature)),userHandle:n.userHandle?cf(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function P4(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Vb(){var t,e;return!!(vs()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function eC(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new qp("Browser returned unexpected credential type",e)}:{data:null,error:new qp("Empty credential response",e)}}catch(e){return{data:null,error:V6({error:e,options:t})}}}async function tC(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new qp("Browser returned unexpected credential type",e)}:{data:null,error:new qp("Empty credential response",e)}}catch(e){return{data:null,error:G6({error:e,options:t})}}}const rC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},aC={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function zp(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),a={};for(const n of t)if(n)for(const s in n){const l=n[s];if(l!==void 0)if(Array.isArray(l))a[s]=l;else if(r(l))a[s]=l;else if(e(l)){const c=a[s];e(c)?a[s]=zp(c,l):a[s]=zp(l)}else a[s]=l}return a}function nC(t,e){return zp(rC,t,e||{})}function sC(t,e){return zp(aC,t,e||{})}class iC{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:a,signal:n},s){try{const{data:l,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!l)return{data:null,error:c};const f=n??X6.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:d}=l.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${a}`),d.displayName||(d.displayName=d.name)}switch(l.webauthn.type){case"create":{const d=nC(l.webauthn.credential_options.publicKey,s?.create),{data:m,error:v}=await eC({publicKey:d,signal:f});return m?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:v}}case"request":{const d=sC(l.webauthn.credential_options.publicKey,s?.request),{data:m,error:v}=await tC(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:d,signal:f}));return m?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:v}}}}catch(l){return lr(l)?{data:null,error:l}:{data:null,error:new sf("Unexpected error in challenge",l)}}}async _verify({challengeId:e,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:a})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},s){if(!r)return{data:null,error:new k0("rpId is required for WebAuthn authentication")};try{if(!Vb())return{data:null,error:new sf("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:a},signal:n},{request:s});if(!l)return{data:null,error:c};const{webauthn:f}=l;return this._verify({factorId:e,challengeId:l.challengeId,webauthn:{type:f.type,rpId:r,rpOrigins:a,credential_response:f.credential_response}})}catch(l){return lr(l)?{data:null,error:l}:{data:null,error:new sf("Unexpected error in authenticate",l)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},s){if(!r)return{data:null,error:new k0("rpId is required for WebAuthn registration")};try{if(!Vb())return{data:null,error:new sf("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this._enroll({friendlyName:e});if(!l)return await this.client.mfa.listFactors().then(m=>{var v;return(v=m.data)===null||v===void 0?void 0:v.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===e&&x.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m?.id}):void 0),{data:null,error:c};const{data:f,error:d}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:n},{create:s});return f?this._verify({factorId:l.id,challengeId:f.challengeId,webauthn:{rpId:r,rpOrigins:a,type:f.webauthn.type,credential_response:f.webauthn.credential_response}}):{data:null,error:d}}catch(l){return lr(l)?{data:null,error:l}:{data:null,error:new sf("Unexpected error in register",l)}}}}z6();const oC={url:a6,storageKey:n6,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:s6,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Gb(t,e,r){return await r()}const Od={};class j0{get jwks(){var e,r;return(r=(e=Od[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Od[this.storageKey]=Object.assign(Object.assign({},Od[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Od[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Od[this.storageKey]=Object.assign(Object.assign({},Od[this.storageKey]),{cachedAt:e})}constructor(e){var r,a,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},oC),e);if(this.storageKey=s.storageKey,this.instanceID=(r=j0.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,j0.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&vs()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new B6({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=D4(s.fetch),this.lock=s.lock||Gb,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,s.lock?this.lock=s.lock:vs()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=q6:this.lock=Gb,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new iC(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:R4()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Wb(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Wb(this.memoryStorage)),vs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${C4}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},a="none";if(vs()&&(r=y6(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),vs()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:s}=await this._getSessionFromURL(r,a);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),f6(s)){const f=(e=s.details)===null||e===void 0?void 0:e.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:l,redirectType:c}=n;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return lr(r)?this._returnResult({error:r}):this._returnResult({error:new sf("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,a,n;try{const s=await yr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Ho}),{data:l,error:c}=s;if(c||!l)return this._returnResult({data:{user:null,session:null},error:c});const f=l.session,d=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:d,session:f},error:null})}catch(s){if(lr(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(e){var r,a,n;try{let s;if("email"in e){const{email:m,password:v,options:x}=e;let g=null,b=null;this.flowType==="pkce"&&([g,b]=await Ad(this.storage,this.storageKey)),s=await yr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x?.emailRedirectTo,body:{email:m,password:v,data:(r=x?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:g,code_challenge_method:b},xform:Ho})}else if("phone"in e){const{phone:m,password:v,options:x}=e;s=await yr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:v,data:(a=x?.data)!==null&&a!==void 0?a:{},channel:(n=x?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:Ho})}else throw new np("You must provide either an email or phone number and a password");const{data:l,error:c}=s;if(c||!l)return this._returnResult({data:{user:null,session:null},error:c});const f=l.session,d=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:d,session:f},error:null})}catch(s){if(lr(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:l,options:c}=e;r=await yr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Hb})}else if("phone"in e){const{phone:s,password:l,options:c}=e;r=await yr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Hb})}else throw new np("You must provide either an email or phone number and a password");const{data:a,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!a||!a.session||!a.user){const s=new Ed;return this._returnResult({data:{user:null,session:null},error:s})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(r){if(lr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,a,n,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,a,n,s,l,c,f,d,m,v,x;let g,b;if("message"in e)g=e.message,b=e.signature;else{const{chain:_,wallet:w,statement:A,options:C}=e;let E;if(vs())if(typeof w=="object")E=w;else{const L=window;if("ethereum"in L&&typeof L.ethereum=="object"&&"request"in L.ethereum&&typeof L.ethereum.request=="function")E=L.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=w}const R=new URL((r=C?.url)!==null&&r!==void 0?r:window.location.href),Y=await E.request({method:"eth_requestAccounts"}).then(L=>L).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!Y||Y.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const W=L4(Y[0]);let B=(a=C?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!B){const L=await E.request({method:"eth_chainId"});B=H6(L)}const q={domain:R.host,address:W,statement:A,uri:R.href,version:"1",chainId:B,nonce:(n=C?.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(l=(s=C?.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(c=C?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(f=C?.signInWithEthereum)===null||f===void 0?void 0:f.notBefore,requestId:(d=C?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(m=C?.signInWithEthereum)===null||m===void 0?void 0:m.resources};g=W6(q),b=await E.request({method:"personal_sign",params:[$6(g),W]})}try{const{data:_,error:w}=await yr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:b},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Ho});if(w)throw w;if(!_||!_.session||!_.user){const A=new Ed;return this._returnResult({data:{user:null,session:null},error:A})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:w})}catch(_){if(lr(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var r,a,n,s,l,c,f,d,m,v,x,g;let b,_;if("message"in e)b=e.message,_=e.signature;else{const{chain:w,wallet:A,statement:C,options:E}=e;let R;if(vs())if(typeof A=="object")R=A;else{const W=window;if("solana"in W&&typeof W.solana=="object"&&("signIn"in W.solana&&typeof W.solana.signIn=="function"||"signMessage"in W.solana&&typeof W.solana.signMessage=="function"))R=W.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!E?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");R=A}const Y=new URL((r=E?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in R&&R.signIn){const W=await R.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},E?.signInWithSolana),{version:"1",domain:Y.host,uri:Y.href}),C?{statement:C}:null));let B;if(Array.isArray(W)&&W[0]&&typeof W[0]=="object")B=W[0];else if(W&&typeof W=="object"&&"signedMessage"in W&&"signature"in W)B=W;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in B&&"signature"in B&&(typeof B.signedMessage=="string"||B.signedMessage instanceof Uint8Array)&&B.signature instanceof Uint8Array)b=typeof B.signedMessage=="string"?B.signedMessage:new TextDecoder().decode(B.signedMessage),_=B.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in R)||typeof R.signMessage!="function"||!("publicKey"in R)||typeof R!="object"||!R.publicKey||!("toBase58"in R.publicKey)||typeof R.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${Y.host} wants you to sign in with your Solana account:`,R.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${Y.href}`,`Issued At: ${(n=(a=E?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((s=E?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${E.signInWithSolana.notBefore}`]:[],...!((l=E?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${E.signInWithSolana.expirationTime}`]:[],...!((c=E?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${E.signInWithSolana.chainId}`]:[],...!((f=E?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${E.signInWithSolana.nonce}`]:[],...!((d=E?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${E.signInWithSolana.requestId}`]:[],...!((v=(m=E?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||v===void 0)&&v.length?["Resources",...E.signInWithSolana.resources.map(B=>`- ${B}`)]:[]].join(`
`);const W=await R.signMessage(new TextEncoder().encode(b),"utf8");if(!W||!(W instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=W}}try{const{data:w,error:A}=await yr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:cf(_)},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Ho});if(A)throw A;if(!w||!w.session||!w.user){const C=new Ed;return this._returnResult({data:{user:null,session:null},error:C})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:A})}catch(w){if(lr(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async _exchangeCodeForSession(e){const r=await Zu(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(r??"").split("/");try{const{data:s,error:l}=await yr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:a},xform:Ho});if(await eu(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!s||!s.session||!s.user){const c=new Ed;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:n??null}),error:l})}catch(s){if(lr(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(e){try{const{options:r,provider:a,token:n,access_token:s,nonce:l}=e,c=await yr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Ho}),{data:f,error:d}=c;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!f||!f.session||!f.user){const m=new Ed;return this._returnResult({data:{user:null,session:null},error:m})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:f,error:d})}catch(r){if(lr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,a,n,s,l;try{if("email"in e){const{email:c,options:f}=e;let d=null,m=null;this.flowType==="pkce"&&([d,m]=await Ad(this.storage,this.storageKey));const{error:v}=await yr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=f?.data)!==null&&r!==void 0?r:{},create_user:(a=f?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:d,code_challenge_method:m},redirectTo:f?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:v})}if("phone"in e){const{phone:c,options:f}=e,{data:d,error:m}=await yr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(n=f?.data)!==null&&n!==void 0?n:{},create_user:(s=f?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(l=f?.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:m})}throw new np("You must provide either an email or phone number.")}catch(c){if(lr(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var r,a;try{let n,s;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(a=e.options)===null||a===void 0?void 0:a.captchaToken);const{data:l,error:c}=await yr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:n,xform:Ho});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const f=l.session,d=l.user;return f?.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),this._returnResult({data:{user:d,session:f},error:null})}catch(n){if(lr(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,a,n,s,l;try{let c=null,f=null;this.flowType==="pkce"&&([c,f]=await Ad(this.storage,this.storageKey));const d=await yr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(a=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:f}),headers:this.headers,xform:P6});return!((s=d.data)===null||s===void 0)&&s.url&&vs()&&!(!((l=e.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(c){if(lr(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:a}=e;if(a)throw a;if(!r)throw new Oi;const{error:n}=await yr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(lr(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:a,type:n,options:s}=e,{error:l}=await yr(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in e){const{phone:a,type:n,options:s}=e,{data:l,error:c}=await yr(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l?.message_id},error:c})}throw new np("You must provide either an email or phone number and a type")}catch(r){if(lr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Zu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const a=e.expires_at?e.expires_at*1e3-Date.now()<Xg:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",e.expires_at),!a){if(this.userStorage){const l=await Zu(this.userStorage,this.storageKey+"-user");l?.user?e.user=l.user:e.user=Zg()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};e.user=R6(e.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await yr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ou}):await this._useSession(async r=>{var a,n,s;const{data:l,error:c}=r;if(c)throw c;return!(!((a=l.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Oi}:await yr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0,xform:ou})})}catch(r){if(lr(r))return u6(r)&&(await this._removeSession(),await eu(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async a=>{const{data:n,error:s}=a;if(s)throw s;if(!n.session)throw new Oi;const l=n.session;let c=null,f=null;this.flowType==="pkce"&&e.email!=null&&([c,f]=await Ad(this.storage,this.storageKey));const{data:d,error:m}=await yr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:f}),jwt:l.access_token,xform:ou});if(m)throw m;return l.user=d.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(a){if(lr(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Oi;const r=Date.now()/1e3;let a=r,n=!0,s=null;const{payload:l}=Jg(e.access_token);if(l.exp&&(a=l.exp,n=a<=r),n){const{data:c,error:f}=await this._callRefreshToken(e.refresh_token);if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!c)return{data:{user:null,session:null},error:null};s=c}else{const{data:c,error:f}=await this._getUser(e.access_token);if(f)throw f;s={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(lr(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var a;if(!e){const{data:l,error:c}=r;if(c)throw c;e=(a=l.session)!==null&&a!==void 0?a:void 0}if(!e?.refresh_token)throw new Oi;const{data:n,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(lr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!vs())throw new sp("No browser detected.");if(e.error||e.error_description||e.error_code)throw new sp(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Pb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new sp("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Pb("No code detected.");const{data:C,error:E}=await this._exchangeCodeForSession(e.code);if(E)throw E;const R=new URL(window.location.href);return R.searchParams.delete("code"),window.history.replaceState(window.history.state,"",R.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:s,refresh_token:l,expires_in:c,expires_at:f,token_type:d}=e;if(!s||!c||!l||!d)throw new sp("No session defined in URL");const m=Math.round(Date.now()/1e3),v=parseInt(c);let x=m+v;f&&(x=parseInt(f));const g=x-m;g*1e3<=Bd&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${v}s`);const b=x-v;m-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,x,m):m-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,x,m);const{data:_,error:w}=await this._getUser(s);if(w)throw w;const A={provider_token:a,provider_refresh_token:n,access_token:s,expires_in:v,expires_at:x,refresh_token:l,token_type:d,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:A,redirectType:e.type},error:null})}catch(a){if(lr(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Zu(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return this._returnResult({error:s});const l=(a=n.session)===null||a===void 0?void 0:a.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(c6(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await eu(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=x6(),a={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(e){return await this._useSession(async r=>{var a,n;try{const{data:{session:s},error:l}=r;if(l)throw l;await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await Ad(this.storage,this.storageKey,!0));try{return await yr(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(lr(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var e;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(lr(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:a,error:n}=await this._useSession(async s=>{var l,c,f,d,m;const{data:v,error:x}=s;if(x)throw x;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(f=e.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await yr(this.fetch,"GET",g,{headers:this.headers,jwt:(m=(d=v.session)===null||d===void 0?void 0:d.access_token)!==null&&m!==void 0?m:void 0})});if(n)throw n;return vs()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:e.provider,url:a?.url},error:null})}catch(a){if(lr(a))return this._returnResult({data:{provider:e.provider,url:null},error:a});throw a}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var a;try{const{error:n,data:{session:s}}=r;if(n)throw n;const{options:l,provider:c,token:f,access_token:d,nonce:m}=e,v=await yr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=s?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:c,id_token:f,access_token:d,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Ho}),{data:x,error:g}=v;return g?this._returnResult({data:{user:null,session:null},error:g}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new Ed}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:g}))}catch(n){if(lr(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var a,n;const{data:s,error:l}=r;if(l)throw l;return await yr(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(lr(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await w6(async n=>(n>0&&await b6(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await yr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ho})),(n,s)=>{const l=200*Math.pow(2,n);return s&&Kg(s)&&Date.now()+l-a<Bd})}catch(a){if(this._debug(r,"error",a),lr(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",a),vs()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:e,url:a},error:null}}async _recoverAndRefresh(){var e,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await Zu(this.storage,this.storageKey);if(n&&this.userStorage){let l=await Zu(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:n.user},await Ud(this.userStorage,this.storageKey+"-user",l)),n.user=(e=l?.user)!==null&&e!==void 0?e:Zg()}else if(n&&!n.user&&!n.user){const l=await Zu(this.storage,this.storageKey+"-user");l&&l?.user?(n.user=l.user,await eu(this.storage,this.storageKey+"-user"),await Ud(this.storage,this.storageKey,n)):n.user=Zg()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const s=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Xg;if(this._debug(a,`session has${s?"":" not"} expired with margin of ${Xg}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:l}=await this._callRefreshToken(n.refresh_token);l&&(console.error(l),Kg(l)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:c}=await this._getUser(n.access_token);!c&&l?.user?(n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(a,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n),console.error(n);return}finally{this._debug(a,"end")}}async _callRefreshToken(e){var r,a;if(!e)throw new Oi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new d1;const{data:s,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!s.session)throw new Oi;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const c={data:s.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(s){if(this._debug(n,"error",s),lr(s)){const l={data:null,error:s};return Kg(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(s),s}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,a=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,r)}catch(f){s.push(f)}});if(await Promise.all(l),s.length>0){for(let c=0;c<s.length;c+=1)console.error(s[c]);throw s[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await Ud(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const s=qb(n);await Ud(this.storage,this.storageKey,s)}else{const n=qb(r);await Ud(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await eu(this.storage,this.storageKey),await eu(this.storage,this.storageKey+"-code-verifier"),await eu(this.storage,this.storageKey+"-user"),this.userStorage&&await eu(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&vs()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Bd);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-e)/Bd);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Bd}ms, refresh threshold is ${lx} ticks`),n<=lx&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof F4)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!vs()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,a){const n=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[s,l]=await Ad(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});n.push(c.toString())}if(a?.queryParams){const s=new URLSearchParams(a.queryParams);n.push(s.toString())}return a?.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;return s?this._returnResult({data:null,error:s}):await yr(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(lr(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var a,n;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:f,error:d}=await yr(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&f.type==="totp"&&(!((n=f?.totp)===null||n===void 0)&&n.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),this._returnResult({data:f,error:null}))})}catch(r){if(lr(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?Z6(e.webauthn.credential_response):Q6(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:f}=await yr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:l,headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token});return f?this._returnResult({data:null,error:f}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:f}))})}catch(r){if(lr(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=await yr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token});if(l.error)return l;const{data:c}=l;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:K6(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:J6(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(lr(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:a}=await this._challenge({factorId:e.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const n={all:[],phone:[],totp:[],webauthn:[]};for(const s of(e=r?.factors)!==null&&e!==void 0?e:[])n.all.push(s),s.status==="verified"&&n[s.factor_type].push(s);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:a},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=Jg(a.access_token);let l=null;s.aal&&(l=s.aal);let c=l;((r=(e=a.user.factors)===null||e===void 0?void 0:e.filter(m=>m.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const d=s.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?await yr(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:a.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Oi})})}catch(r){if(lr(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async a=>{const{data:{session:n},error:s}=a;if(s)return this._returnResult({data:null,error:s});if(!n)return this._returnResult({data:null,error:new Oi});const l=await yr(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&vs()&&!r?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(a){if(lr(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(e,r){try{return await this._useSession(async a=>{const{data:{session:n},error:s}=a;if(s)return this._returnResult({data:null,error:s});if(!n)return this._returnResult({data:null,error:new Oi});const l=await yr(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&vs()&&!r?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(a){if(lr(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:a}=e;return a?this._returnResult({data:null,error:a}):r?await yr(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new Oi})})}catch(e){if(lr(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?(await yr(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Oi})})}catch(r){if(lr(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let a=r.keys.find(c=>c.kid===e);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(c=>c.kid===e),a&&this.jwks_cached_at+o6>n)return a;const{data:s,error:l}=await yr(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=n,a=s.keys.find(c=>c.kid===e),!a)?null:a}async getClaims(e,r={}){try{let a=e;if(!a){const{data:g,error:b}=await this.getSession();if(b||!g.session)return this._returnResult({data:null,error:b});a=g.session.access_token}const{header:n,payload:s,signature:l,raw:{header:c,payload:f}}=Jg(a);r?.allowExpired||C6(s.exp);const d=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:g}=await this.getUser(a);if(g)throw g;return{data:{claims:s,header:n,signature:l},error:null}}const m=T6(n.alg),v=await crypto.subtle.importKey("jwk",d,m,!0,["verify"]);if(!await crypto.subtle.verify(m,v,l,g6(`${c}.${f}`)))throw new fx("Invalid JWT signature");return{data:{claims:s,header:n,signature:l},error:null}}catch(a){if(lr(a))return this._returnResult({data:null,error:a});throw a}}}j0.nextInstanceID={};const lC=j0;class cC extends lC{constructor(e){super(e)}}class uC{constructor(e,r,a){var n,s,l;this.supabaseUrl=e,this.supabaseKey=r;const c=r6(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const f=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:YA,realtime:KA,auth:Object.assign(Object.assign({},XA),{storageKey:f}),global:GA},m=t6(a??{},d);this.storageKey=(n=m.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=m.global.headers)!==null&&s!==void 0?s:{},m.accessToken?(this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(v,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=m.auth)!==null&&l!==void 0?l:{},this.headers,m.global.fetch),this.fetch=QA(r,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.accessToken&&this.accessToken().then(v=>this.realtime.setAuth(v)).catch(v=>console.warn("Failed to set initial Realtime auth token:",v)),this.rest=new KE(new URL("rest/v1",c).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),this.storage=new $A(this.storageUrl.href,this.headers,this.fetch,a?.storage),m.accessToken||this._listenForAuthEvents()}get functions(){return new VE(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},a={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,a)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:a}=await this.auth.getSession();return(r=(e=a.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:s,storageKey:l,flowType:c,lock:f,debug:d,throwOnError:m},v,x){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new cC({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),v),storageKey:l,autoRefreshToken:e,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:s,flowType:c,lock:f,debug:d,throwOnError:m,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new hA(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a?.access_token)})}_handleTokenChanged(e,r,a){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const fC=(t,e,r)=>new uC(t,e,r);function dC(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}dC()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const hC="fieldsync-offline",mC=1,bn={PROJECTS:"projects",AREAS:"areas",CREW_CHECKINS:"crew_checkins",PENDING_ACTIONS:"pending_actions",CACHED_DATA:"cached_data"};let uf=null;const gc=()=>new Promise((t,e)=>{if(uf){t(uf);return}const r=indexedDB.open(hC,mC);r.onerror=()=>{console.error("Failed to open offline database"),e(r.error)},r.onsuccess=()=>{uf=r.result,console.log("Offline database initialized"),t(uf)},r.onupgradeneeded=a=>{const n=a.target.result;if(n.objectStoreNames.contains(bn.PROJECTS)||n.createObjectStore(bn.PROJECTS,{keyPath:"id"}).createIndex("company_id","company_id",{unique:!1}),n.objectStoreNames.contains(bn.AREAS)||n.createObjectStore(bn.AREAS,{keyPath:"id"}).createIndex("project_id","project_id",{unique:!1}),n.objectStoreNames.contains(bn.CREW_CHECKINS)||n.createObjectStore(bn.CREW_CHECKINS,{keyPath:"id"}).createIndex("project_id","project_id",{unique:!1}),!n.objectStoreNames.contains(bn.PENDING_ACTIONS)){const s=n.createObjectStore(bn.PENDING_ACTIONS,{keyPath:"id",autoIncrement:!0});s.createIndex("type","type",{unique:!1}),s.createIndex("created_at","created_at",{unique:!1})}n.objectStoreNames.contains(bn.CACHED_DATA)||n.createObjectStore(bn.CACHED_DATA,{keyPath:"key"})}}),kf=(t,e="readonly")=>{if(!uf)throw new Error("Database not initialized");return uf.transaction(t,e).objectStore(t)},pC=async(t,e)=>(await gc(),new Promise((r,a)=>{const s=kf(t,"readwrite").put(e);s.onsuccess=()=>r(s.result),s.onerror=()=>a(s.error)})),M4=async(t,e)=>(await gc(),new Promise((r,a)=>{const n=uf.transaction(t,"readwrite"),s=n.objectStore(t);e.forEach(l=>s.put(l)),n.oncomplete=()=>r(),n.onerror=()=>a(n.error)})),gC=async(t,e)=>(await gc(),new Promise((r,a)=>{const s=kf(t).get(e);s.onsuccess=()=>r(s.result),s.onerror=()=>a(s.error)})),I4=async t=>(await gc(),new Promise((e,r)=>{const n=kf(t).getAll();n.onsuccess=()=>e(n.result||[]),n.onerror=()=>r(n.error)})),B4=async(t,e,r)=>(await gc(),new Promise((a,n)=>{const c=kf(t).index(e).getAll(r);c.onsuccess=()=>a(c.result||[]),c.onerror=()=>n(c.error)})),vC=async(t,e)=>(await gc(),new Promise((r,a)=>{const s=kf(t,"readwrite").delete(e);s.onsuccess=()=>r(),s.onerror=()=>a(s.error)})),iu={UPDATE_AREA_STATUS:"UPDATE_AREA_STATUS",CREATE_TM_TICKET:"CREATE_TM_TICKET",SAVE_CREW_CHECKIN:"SAVE_CREW_CHECKIN",SUBMIT_DAILY_REPORT:"SUBMIT_DAILY_REPORT",SEND_MESSAGE:"SEND_MESSAGE",CREATE_MATERIAL_REQUEST:"CREATE_MATERIAL_REQUEST"},Yb=async(t,e,r={})=>{await gc();const a={type:t,payload:e,metadata:r,created_at:new Date().toISOString(),attempts:0,last_error:null};return new Promise((n,s)=>{const c=kf(bn.PENDING_ACTIONS,"readwrite").add(a);c.onsuccess=()=>{console.log(`Queued offline action: ${t}`),n(c.result)},c.onerror=()=>s(c.error)})},U4=async()=>I4(bn.PENDING_ACTIONS),ev=async()=>(await U4()).length,xC=async t=>vC(bn.PENDING_ACTIONS,t),yC=async(t,e)=>(await gc(),new Promise((r,a)=>{const n=kf(bn.PENDING_ACTIONS,"readwrite"),s=n.get(t);s.onsuccess=()=>{const l=s.result;if(l){const c={...l,...e},f=n.put(c);f.onsuccess=()=>r(c),f.onerror=()=>a(f.error)}else a(new Error("Action not found"))},s.onerror=()=>a(s.error)})),_C=async t=>M4(bn.PROJECTS,t),Xb=async t=>t?B4(bn.PROJECTS,"company_id",t):I4(bn.PROJECTS),bC=async t=>M4(bn.AREAS,t),Kb=async t=>B4(bn.AREAS,"project_id",t),tv=async(t,e)=>{const r=await gC(bn.AREAS,t);return r&&(r.status=e,r.updated_at=new Date().toISOString(),await pC(bn.AREAS,r)),r};let Jx=navigator.onLine;const dx=new Set,q4=t=>(dx.add(t),()=>dx.delete(t)),f0=()=>Jx,Jb=t=>{Jx=t,dx.forEach(e=>e(t))};typeof window<"u"&&(window.addEventListener("online",()=>{console.log("Connection restored"),Jb(!0)}),window.addEventListener("offline",()=>{console.log("Connection lost"),Jb(!1)}));let rv=!1;const wC=async t=>{if(rv||!Jx)return{synced:0,failed:0};rv=!0;const e={synced:0,failed:0};try{const r=await U4();console.log(`Syncing ${r.length} pending actions...`);for(const a of r)try{await SC(a,t),await xC(a.id),e.synced++,console.log(`Synced action: ${a.type}`)}catch(n){console.error(`Failed to sync action ${a.type}:`,n),e.failed++,await yC(a.id,{attempts:(a.attempts||0)+1,last_error:n.message,last_attempt:new Date().toISOString()})}}finally{rv=!1}return e},SC=async(t,e)=>{const{type:r,payload:a}=t;switch(r){case iu.UPDATE_AREA_STATUS:return e.updateAreaStatus(a.areaId,a.status);case iu.CREATE_TM_TICKET:const n=await e.createTMTicket(a.ticket);return a.workers?.length>0&&await e.addTMWorkers(n.id,a.workers),a.items?.length>0&&await e.addTMItems(n.id,a.items),n;case iu.SAVE_CREW_CHECKIN:return e.saveCrewCheckin(a.projectId,a.workers,a.checkInDate);case iu.SUBMIT_DAILY_REPORT:return await e.saveDailyReport(a.projectId,a.reportData),e.submitDailyReport(a.projectId,a.submittedBy);case iu.SEND_MESSAGE:return e.sendMessage(a.projectId,a.senderType,a.senderName,a.content);case iu.CREATE_MATERIAL_REQUEST:return e.createMaterialRequest(a.projectId,a.items,a.requestedBy,a.neededBy,a.priority,a.notes);default:throw new Error(`Unknown action type: ${r}`)}},z4="",NC="",Ue=!!z4;gc().catch(t=>console.error("Failed to init offline DB:",t));const De=Ue?fC(z4,NC):null,H4="fieldsync_data",hx="fieldsync_user",cr=()=>{const t=localStorage.getItem(H4);return t?JSON.parse(t):{projects:[],areas:[],users:[],assignments:[]}},aa=t=>{localStorage.setItem(H4,JSON.stringify(t))},ip=()=>{const t=localStorage.getItem(hx);return t?JSON.parse(t):null},op=t=>{t?localStorage.setItem(hx,JSON.stringify(t)):localStorage.removeItem(hx)},kC={async signUp(t,e,r,a){if(Ue){const{data:n,error:s}=await De.auth.signUp({email:t,password:e,options:{data:{name:r,role:a}}});if(s)throw s;return n}else{const n=cr(),s={id:crypto.randomUUID(),email:t,name:r,role:a,created_at:new Date().toISOString()};return n.users.push(s),aa(n),op(s),{user:s}}},async signIn(t,e){if(Ue){const{data:r,error:a}=await De.auth.signInWithPassword({email:t,password:e});if(a)throw a;return r}else{const a=cr().users.find(n=>n.email===t);if(!a)throw new Error("User not found");return op(a),{user:a}}},async signOut(){if(Ue){const{error:t}=await De.auth.signOut();if(t)throw t}else op(null)},async getUser(){if(Ue){const{data:{user:t}}=await De.auth.getUser();return t}else return ip()},async getProfile(){if(Ue){const{data:{user:t}}=await De.auth.getUser();if(!t)return null;const{data:e,error:r}=await De.from("users").select("*").eq("id",t.id).single();return r?{id:t.id,email:t.email,name:t.user_metadata?.name||"",role:t.user_metadata?.role||"foreman"}:e}else return ip()},async updateRole(t,e){if(Ue){const{data:r,error:a}=await De.from("users").update({role:e}).eq("id",t).select().single();if(a)throw a;return r}else{const r=cr(),a=r.users.find(n=>n.id===t);return a&&(a.role=e,aa(r),ip()?.id===t&&op(a)),a}},onAuthStateChange(t){if(Ue)return De.auth.onAuthStateChange(t);{const e=ip();return t(e?"SIGNED_IN":"SIGNED_OUT",{user:e}),{data:{subscription:{unsubscribe:()=>{}}}}}}},ot={async getProjects(t=null,e=!1){if(Ue){if(!f0()){console.log("Offline: returning cached projects");const s=await Xb(t);return e?s:s.filter(l=>l.status!=="archived")}let r=De.from("projects").select("*").order("created_at",{ascending:!1});t&&(r=r.eq("company_id",t)),e||(r=r.eq("status","active"));const{data:a,error:n}=await r;if(n){console.log("Error fetching projects, trying cache:",n.message);const s=await Xb(t);if(s.length>0)return s;throw n}return a?.length>0&&_C(a).catch(s=>console.error("Failed to cache projects:",s)),a}else{const r=cr().projects;return e?r:r.filter(a=>a.status!=="archived")}},async getArchivedProjects(t){if(Ue){const{data:e,error:r}=await De.from("projects").select("*").eq("company_id",t).eq("status","archived").order("archived_at",{ascending:!1});if(r)throw r;return e}else return cr().projects.filter(e=>e.status==="archived")},async getProjectCount(t){if(Ue){const{count:e,error:r}=await De.from("projects").select("*",{count:"exact",head:!0}).eq("company_id",t).in("status",["active","archived"]);if(r)throw r;return e||0}else return cr().projects.filter(r=>r.company_id===t&&r.status!=="deleted").length},async archiveProject(t){if(Ue){const{data:e,error:r}=await De.from("projects").update({status:"archived",archived_at:new Date().toISOString()}).eq("id",t).select().single();if(r)throw r;return e}else{const e=cr(),r=e.projects.find(a=>a.id===t);return r&&(r.status="archived",r.archived_at=new Date().toISOString(),aa(e)),r}},async restoreProject(t){if(Ue){const{data:e,error:r}=await De.from("projects").update({status:"active",archived_at:null}).eq("id",t).select().single();if(r)throw r;return e}else{const e=cr(),r=e.projects.find(a=>a.id===t);return r&&(r.status="active",r.archived_at=null,aa(e)),r}},async getProject(t){if(Ue){const{data:e,error:r}=await De.from("projects").select("*").eq("id",t).single();if(r)throw r;return e}else return cr().projects.find(e=>e.id===t)},async createProject(t){if(Ue){const{data:e,error:r}=await De.from("projects").insert({...t,status:"active"}).select().single();if(r)throw r;return e}else{const e=cr(),r={...t,id:crypto.randomUUID(),status:"active",created_at:new Date().toISOString()};return e.projects.push(r),aa(e),r}},async getProjectByPin(t){if(Ue){const{data:e,error:r}=await De.from("projects").select("*").eq("pin",t).eq("status","active").single();return r?null:e}else return cr().projects.find(r=>r.pin===t&&r.status==="active")||null},async getProjectByPinAndCompany(t,e){if(Ue){const{data:r,error:a}=await De.from("projects").select("*").eq("pin",t).eq("company_id",e).eq("status","active").single();return a?null:r}else return cr().projects.find(a=>a.pin===t&&a.company_id===e&&a.status==="active")||null},async isPinAvailable(t,e=null){if(Ue){let r=De.from("projects").select("id").eq("pin",t);e&&(r=r.neq("id",e));const{data:a,error:n}=await r;if(n)throw n;return a.length===0}else return!cr().projects.some(a=>a.pin===t&&a.id!==e)},async updateProjectPin(t,e){if(Ue){const{data:r,error:a}=await De.from("projects").update({pin:e}).eq("id",t).select().single();if(a)throw a;return r}else{const r=cr(),a=r.projects.find(n=>n.id===t);return a&&(a.pin=e,aa(r)),a}},async updateProject(t,e){if(Ue){const{data:r,error:a}=await De.from("projects").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating project:",a),a;return r}else{const r=cr(),a=r.projects.find(n=>n.id===t);return a&&(Object.assign(a,e),aa(r)),a}},async deleteProject(t){if(Ue){const{error:e}=await De.from("projects").delete().eq("id",t);if(e)throw e}else{const e=cr();e.projects=e.projects.filter(r=>r.id!==t),e.areas=e.areas.filter(r=>r.project_id!==t),aa(e)}},async getAreas(t){if(Ue){if(!f0())return console.log("Offline: returning cached areas"),Kb(t);const{data:e,error:r}=await De.from("areas").select("*").eq("project_id",t).order("sort_order",{ascending:!0});if(r){console.log("Error fetching areas, trying cache:",r.message);const a=await Kb(t);if(a.length>0)return a;throw r}return e?.length>0&&bC(e).catch(a=>console.error("Failed to cache areas:",a)),e}else return cr().areas.filter(e=>e.project_id===t)},async createArea(t){if(Ue){const{data:e,error:r}=await De.from("areas").insert(t).select().single();if(r)throw r;return e}else{const e=cr(),r={...t,id:crypto.randomUUID(),created_at:new Date().toISOString()};return e.areas.push(r),aa(e),r}},async updateAreaStatus(t,e){if(Ue){if(!f0()){console.log("Offline: queuing area status update");const n=await tv(t,e);return await Yb(iu.UPDATE_AREA_STATUS,{areaId:t,status:e}),n}const{data:r,error:a}=await De.from("areas").update({status:e}).eq("id",t).select().single();if(a){if(a.message?.includes("fetch")||a.message?.includes("network")){console.log("Network error: queuing area status update");const n=await tv(t,e);return await Yb(iu.UPDATE_AREA_STATUS,{areaId:t,status:e}),n}throw a}return r&&tv(t,e).catch(n=>console.error("Failed to update cached area:",n)),r}else{const r=cr(),a=r.areas.find(n=>n.id===t);return a&&(a.status=e,a.updated_at=new Date().toISOString()),aa(r),a}},async updateArea(t,e){if(Ue){const{data:r,error:a}=await De.from("areas").update(e).eq("id",t).select().single();if(a)throw a;return r}else{const r=cr(),a=r.areas.find(n=>n.id===t);return a&&(Object.assign(a,e),a.updated_at=new Date().toISOString()),aa(r),a}},async deleteArea(t){if(Ue){const{error:e}=await De.from("areas").delete().eq("id",t);if(e)throw e}else{const e=cr();e.areas=e.areas.filter(r=>r.id!==t),aa(e)}},subscribeToAreas(t,e){return Ue?De.channel(`areas:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"areas",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToMessages(t,e){return Ue?De.channel(`messages:${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToMaterialRequests(t,e){return Ue?De.channel(`material_requests:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"material_requests",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToDailyReports(t,e){return Ue?De.channel(`daily_reports:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"daily_reports",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToCrewCheckins(t,e){return Ue?De.channel(`crew_checkins:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"crew_checkins",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToInjuryReports(t,e){return Ue?De.channel(`injury_reports:${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"injury_reports",filter:`company_id=eq.${t}`},e).subscribe():null},subscribeToTMTickets(t,e){return Ue?De.channel(`tm_tickets:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"t_and_m_tickets",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToCompanyActivity(t,e,r){if(!Ue||!e||e.length===0)return null;const a=De.channel(`company_activity:${t}`);return e.forEach(n=>{a.on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`project_id=eq.${n}`},s=>r.onMessage?.(s)),a.on("postgres_changes",{event:"INSERT",schema:"public",table:"material_requests",filter:`project_id=eq.${n}`},s=>r.onMaterialRequest?.(s)),a.on("postgres_changes",{event:"INSERT",schema:"public",table:"t_and_m_tickets",filter:`project_id=eq.${n}`},s=>r.onTMTicket?.(s))}),a.on("postgres_changes",{event:"INSERT",schema:"public",table:"injury_reports",filter:`company_id=eq.${t}`},n=>r.onInjuryReport?.(n)),a.subscribe()},unsubscribe(t){t&&Ue&&De.removeChannel(t)},async getAssignedProjects(t){if(Ue){const{data:e,error:r}=await De.from("project_assignments").select(`
          project_id,
          projects (*)
        `).eq("user_id",t);if(r)throw r;return e.map(a=>a.projects)}else{const e=cr();return(e.assignments?.filter(a=>a.user_id===t)||[]).map(a=>e.projects.find(n=>n.id===a.project_id)).filter(Boolean)}},async assignUserToProject(t,e,r){if(Ue){const{data:a,error:n}=await De.from("project_assignments").insert({project_id:t,user_id:e,assigned_by:r}).select().single();if(n)throw n;return a}else{const a=cr();a.assignments||(a.assignments=[]);const n={id:crypto.randomUUID(),project_id:t,user_id:e,assigned_by:r,assigned_at:new Date().toISOString()};return a.assignments.push(n),aa(a),n}},async removeUserFromProject(t,e){if(Ue){const{error:r}=await De.from("project_assignments").delete().eq("project_id",t).eq("user_id",e);if(r)throw r}else{const r=cr();r.assignments=r.assignments?.filter(a=>!(a.project_id===t&&a.user_id===e))||[],aa(r)}},async getProjectAssignments(t){if(Ue){const{data:e,error:r}=await De.from("project_assignments").select(`
          user_id,
          users (id, email, name, role)
        `).eq("project_id",t);if(r)throw r;return e.map(a=>a.users)}else{const e=cr();return(e.assignments?.filter(a=>a.project_id===t)||[]).map(a=>e.users.find(n=>n.id===a.user_id)).filter(Boolean)}},async getAllUsers(){if(Ue){const{data:t,error:e}=await De.from("users").select("*").order("name");if(e)throw e;return t}else return cr().users||[]},async getForemen(){if(Ue){const{data:t,error:e}=await De.from("users").select("*").eq("role","foreman").order("name");if(e)throw e;return t}else return(cr().users||[]).filter(t=>t.role==="foreman")},async logActivity(t,e,r,a,n,s){if(Ue){const{error:l}=await De.from("activity_log").insert({user_id:t,project_id:e,area_id:r,action:a,old_value:n,new_value:s});l&&console.error("Error logging activity:",l)}},async getProjectActivity(t,e=50){if(Ue){const{data:r,error:a}=await De.from("activity_log").select(`
          *,
          users (name, email),
          areas (name)
        `).eq("project_id",t).order("created_at",{ascending:!1}).limit(e);if(a)throw a;return r}return[]},async getMaterialsEquipment(t){if(Ue){const{data:e,error:r}=await De.from("materials_equipment").select("*").eq("company_id",t).eq("active",!0).order("category").order("name");if(r)throw r;return e}return[]},async getMaterialsEquipmentByCategory(t,e){if(Ue){const{data:r,error:a}=await De.from("materials_equipment").select("*").eq("company_id",t).eq("category",e).eq("active",!0).order("name");if(a)throw a;return r}return[]},async getAllMaterialsEquipment(t){if(Ue){const{data:e,error:r}=await De.from("materials_equipment").select("*").eq("company_id",t).order("category").order("name");if(r)throw r;return e}return[]},async createMaterialEquipment(t){if(Ue){const{data:e,error:r}=await De.from("materials_equipment").insert(t).select().single();if(r)throw r;return e}return null},async updateMaterialEquipment(t,e){if(Ue){const{data:r,error:a}=await De.from("materials_equipment").update(e).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteMaterialEquipment(t){if(Ue){const{error:e}=await De.from("materials_equipment").update({active:!1}).eq("id",t);if(e)throw e}},async getTMTickets(t){if(Ue){const{data:e,error:r}=await De.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).order("created_at",{ascending:!1});if(r)throw r;return e}return[]},async getChangeOrderTotals(t){if(Ue){const{data:e,error:r}=await De.from("t_and_m_tickets").select("ce_pco_number, change_order_value, status").eq("project_id",t).not("ce_pco_number","is",null).neq("ce_pco_number","");if(r)throw r;const a={};let n=0,s=0;return e?.forEach(l=>{const c=l.ce_pco_number;if(a[c]||(a[c]={approved:0,pending:0,count:0}),a[c].count++,l.status==="approved"||l.status==="billed"){const f=parseFloat(l.change_order_value)||0;a[c].approved+=f,n+=f}else l.status==="pending"&&s++}),{changeOrders:a,totalApprovedValue:n,pendingCount:s}}return{changeOrders:{},totalApprovedValue:0,pendingCount:0}},async getTMTicketsByStatus(t,e){if(Ue){const{data:r,error:a}=await De.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).eq("status",e).order("created_at",{ascending:!1});if(a)throw a;return r}return[]},async createTMTicket(t){if(Ue){const{data:e,error:r}=await De.from("t_and_m_tickets").insert({project_id:t.project_id,work_date:t.work_date,ce_pco_number:t.ce_pco_number||null,notes:t.notes,photos:t.photos||[],status:"pending",created_by_name:t.created_by_name||"Field User"}).select().single();if(r)throw r;return e}return null},async addTMWorkers(t,e){if(Ue){const r=e.map(n=>({ticket_id:t,name:n.name,hours:n.hours,overtime_hours:n.overtime_hours||0,time_started:n.time_started||null,time_ended:n.time_ended||null,role:n.role||"Laborer"})),{error:a}=await De.from("t_and_m_workers").insert(r);if(a)throw a}},async addTMItems(t,e){if(Ue){const r=e.map(n=>({ticket_id:t,material_equipment_id:n.material_equipment_id||null,custom_name:n.custom_name||null,custom_category:n.custom_category||null,quantity:n.quantity})),{error:a}=await De.from("t_and_m_items").insert(r);if(a)throw a}},async updateTMTicketStatus(t,e){if(Ue){const{data:r,error:a}=await De.from("t_and_m_tickets").update({status:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async approveTMTicket(t,e,r,a=null){if(Ue){const n={status:"approved",approved_by_user_id:e,approved_by_name:r,approved_at:new Date().toISOString(),rejected_by_user_id:null,rejected_by_name:null,rejected_at:null,rejection_reason:null};a!==null&&(n.change_order_value=parseFloat(a)||0);const{data:s,error:l}=await De.from("t_and_m_tickets").update(n).eq("id",t).select().single();if(l)throw l;return s}return null},async rejectTMTicket(t,e,r,a=""){if(Ue){const{data:n,error:s}=await De.from("t_and_m_tickets").update({status:"rejected",rejected_by_user_id:e,rejected_by_name:r,rejected_at:new Date().toISOString(),rejection_reason:a,approved_by_user_id:null,approved_by_name:null,approved_at:null}).eq("id",t).select().single();if(s)throw s;return n}return null},canApproveTickets(t){return["owner","admin","manager"].includes(t)},async updateTMTicketPhotos(t,e){if(Ue){const{data:r,error:a}=await De.from("t_and_m_tickets").update({photos:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteTMTicket(t){if(Ue){const{error:e}=await De.from("t_and_m_tickets").delete().eq("id",t);if(e)throw e}},async getCompanyByCode(t){if(Ue){const{data:e,error:r}=await De.from("companies").select("*").eq("code",t).single();return r?null:e}return null},async getCompany(t){if(Ue){const{data:e,error:r}=await De.from("companies").select("*").eq("id",t).single();if(r)throw r;return e}return null},async getUserCompanies(t){if(Ue){const{data:e,error:r}=await De.from("user_companies").select(`
          id,
          role,
          company_id,
          companies (
            id,
            name,
            code
          )
        `).eq("user_id",t).order("created_at",{ascending:!0});return r?(console.error("Error fetching user companies:",r),[]):e.map(a=>({id:a.companies.id,name:a.companies.name,code:a.companies.code,role:a.role}))}return[]},async uploadPhoto(t,e,r,a){if(!Ue)return null;const n=Date.now(),s=Math.random().toString(36).substring(7),l=a.name?.split(".").pop()||"jpg",c=`${n}-${s}.${l}`,f=`${t}/${e}/${r}/${c}`,{data:d,error:m}=await De.storage.from("tm-photos").upload(f,a,{cacheControl:"3600",upsert:!1});if(m)throw m;const{data:v}=De.storage.from("tm-photos").getPublicUrl(f);return v.publicUrl},async uploadPhotoBase64(t,e,r,a,n="photo.jpg"){if(!Ue)return null;const l=await(await fetch(a)).blob(),c=Date.now(),f=Math.random().toString(36).substring(7),d=n.split(".").pop()||"jpg",m=`${c}-${f}.${d}`,v=`${t}/${e}/${r}/${m}`,{data:x,error:g}=await De.storage.from("tm-photos").upload(v,l,{cacheControl:"3600",upsert:!1,contentType:l.type});if(g)throw g;const{data:b}=De.storage.from("tm-photos").getPublicUrl(v);return b.publicUrl},async deletePhoto(t){if(!Ue)return;const r=new URL(t).pathname.match(/\/tm-photos\/(.+)$/);if(!r)return;const a=r[1],{error:n}=await De.storage.from("tm-photos").remove([a]);if(n)throw n},async getCrewCheckin(t,e=null){if(!Ue)return null;const r=e||new Date().toISOString().split("T")[0],{data:a,error:n}=await De.from("crew_checkins").select("*").eq("project_id",t).eq("check_in_date",r).single();return n&&n.code!=="PGRST116"&&console.error("Error fetching crew checkin:",n),a},async saveCrewCheckin(t,e,r=null,a=null){if(!Ue)return null;const n=a||new Date().toISOString().split("T")[0],{data:s,error:l}=await De.from("crew_checkins").upsert({project_id:t,check_in_date:n,workers:e,created_by:r,updated_at:new Date().toISOString()},{onConflict:"project_id,check_in_date"}).select().single();if(l)throw console.error("Error saving crew checkin:",l),l;return s},async addCrewMember(t,e,r=null){if(!Ue)return null;const a=await this.getCrewCheckin(t),n=a?.workers||[];return n.find(s=>s.name.toLowerCase()===e.name.toLowerCase())?a:(n.push(e),await this.saveCrewCheckin(t,n,r))},async removeCrewMember(t,e){if(!Ue)return null;const r=await this.getCrewCheckin(t);if(!r)return null;const a=r.workers.filter(n=>n.name.toLowerCase()!==e.toLowerCase());return await this.saveCrewCheckin(t,a,r.created_by)},async getCrewCheckinHistory(t,e=30){if(!Ue)return[];const{data:r,error:a}=await De.from("crew_checkins").select("*").eq("project_id",t).order("check_in_date",{ascending:!1}).limit(e);return a?(console.error("Error fetching crew history:",a),[]):r||[]},async getLaborRates(t,e=null,r=null){if(!Ue)return[];let a=De.from("labor_rates").select("*").eq("company_id",t);e&&(a=a.eq("work_type",e)),r&&(a=a.eq("job_type",r));const{data:n,error:s}=await a;return s?(console.error("Error fetching labor rates:",s),[]):n||[]},async calculateManDayCosts(t,e,r,a){if(!Ue)return{totalCost:0,totalManDays:0,breakdown:[]};const n=await this.getCrewCheckinHistory(t,365),s=await this.getLaborRates(e,r,a),l={};s.forEach(v=>{l[v.role.toLowerCase()]=parseFloat(v.regular_rate)||0});let c=0,f=0;const d={},m=[];return n.forEach(v=>{const x=v.workers||[];let g=0;const b={};x.forEach(_=>{const w=(_.role||"laborer").toLowerCase(),A=l[w]||0;b[w]||(b[w]={count:0,cost:0}),b[w].count++,b[w].cost+=A,g+=A,d[w]||(d[w]={count:0,cost:0,rate:A}),d[w].count++,d[w].cost+=A}),c+=g,f+=x.length,m.push({date:v.check_in_date,workers:x.length,cost:g,breakdown:b})}),{totalCost:c,totalManDays:f,byRole:d,byDate:m,daysWorked:n.length}},async getDailyReport(t,e=null){if(!Ue)return null;const r=e||new Date().toISOString().split("T")[0],{data:a,error:n}=await De.from("daily_reports").select("*").eq("project_id",t).eq("report_date",r).single();return n&&n.code!=="PGRST116"&&console.error("Error fetching daily report:",n),a},async compileDailyReport(t,e=null){if(!Ue)return null;const r=e||new Date().toISOString().split("T")[0],a=await this.getCrewCheckin(t,r),{data:n}=await De.from("areas").select("*").eq("project_id",t),s=n?.filter(f=>f.status==="done"&&f.completed_at?.startsWith(r))||[],{data:l}=await De.from("t_and_m_tickets").select("*").eq("project_id",t).eq("work_date",r),c=l?.reduce((f,d)=>f+(d.photos?.length||0),0)||0;return{crew_count:a?.workers?.length||0,crew_list:a?.workers||[],tasks_completed:s.length,tasks_total:n?.length||0,completed_tasks:s.map(f=>({name:f.name,group:f.group_name})),tm_tickets_count:l?.length||0,photos_count:c}},async saveDailyReport(t,e,r=null){if(!Ue)return null;const a=r||new Date().toISOString().split("T")[0],{data:n,error:s}=await De.from("daily_reports").upsert({project_id:t,report_date:a,...e,updated_at:new Date().toISOString()},{onConflict:"project_id,report_date"}).select().single();if(s)throw console.error("Error saving daily report:",s),s;return n},async submitDailyReport(t,e,r=null){if(!Ue)return null;const a=r||new Date().toISOString().split("T")[0],n=await this.compileDailyReport(t,a),{data:s,error:l}=await De.from("daily_reports").upsert({project_id:t,report_date:a,...n,status:"submitted",submitted_at:new Date().toISOString(),submitted_by:e,updated_at:new Date().toISOString()},{onConflict:"project_id,report_date"}).select().single();if(l)throw console.error("Error submitting daily report:",l),l;return s},async getDailyReports(t,e=30){if(!Ue)return[];const{data:r,error:a}=await De.from("daily_reports").select("*").eq("project_id",t).order("report_date",{ascending:!1}).limit(e);return a?(console.error("Error fetching daily reports:",a),[]):r||[]},async sendMessage(t,e,r,a,n=null,s=null,l="general",c=null){if(!Ue)return null;const{data:f,error:d}=await De.from("messages").insert({project_id:t,sender_type:r,sender_name:a,sender_user_id:n,message:e,photo_url:s,message_type:l,parent_message_id:c}).select().single();if(d)throw console.error("Error sending message:",d),d;return f},async getMessages(t,e=50){if(!Ue)return[];const{data:r,error:a}=await De.from("messages").select("*").eq("project_id",t).order("created_at",{ascending:!1}).limit(e);return a?(console.error("Error fetching messages:",a),[]):r||[]},async getUnreadCount(t,e){if(!Ue)return 0;const r=e==="field"?"office":"field",{count:a,error:n}=await De.from("messages").select("*",{count:"exact",head:!0}).eq("project_id",t).eq("sender_type",r).eq("is_read",!1);return n?(console.error("Error getting unread count:",n),0):a||0},async markMessagesRead(t,e){if(!Ue)return;const r=e==="field"?"office":"field",{error:a}=await De.from("messages").update({is_read:!0,read_at:new Date().toISOString()}).eq("project_id",t).eq("sender_type",r).eq("is_read",!1);a&&console.error("Error marking messages read:",a)},async createMaterialRequest(t,e,r,a=null,n="normal",s=null){if(!Ue)return null;const{data:l,error:c}=await De.from("material_requests").insert({project_id:t,items:e,requested_by:r,needed_by:a,priority:n,notes:s}).select().single();if(c)throw console.error("Error creating material request:",c),c;return l},async getMaterialRequests(t,e=null){if(!Ue)return[];let r=De.from("material_requests").select("*").eq("project_id",t).order("created_at",{ascending:!1});e&&(r=r.eq("status",e));const{data:a,error:n}=await r;return n?(console.error("Error fetching material requests:",n),[]):a||[]},async getPendingRequestsCount(t){if(!Ue)return 0;const{count:e,error:r}=await De.from("material_requests").select("*",{count:"exact",head:!0}).eq("project_id",t).eq("status","pending");return r?0:e||0},async updateMaterialRequest(t,e,r,a=null,n=null){if(!Ue)return null;const s={status:e,responded_by:r,responded_at:new Date().toISOString(),response_notes:a,updated_at:new Date().toISOString()};n&&(s.expected_delivery=n),e==="delivered"&&(s.delivered_at=new Date().toISOString());const{data:l,error:c}=await De.from("material_requests").update(s).eq("id",t).select().single();if(c)throw console.error("Error updating material request:",c),c;return l},generateShareToken(){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let e="";for(let r=0;r<12;r++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},async createProjectShare(t,e,r,a=null){if(!Ue){const f=cr();f.projectShares||(f.projectShares=[]);const d={id:crypto.randomUUID(),project_id:t,share_token:this.generateShareToken(),created_by:e,expires_at:a,is_active:!0,permissions:r,view_count:0,last_viewed_at:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return f.projectShares.push(d),aa(f),d}const{data:n,error:s}=await De.rpc("generate_share_token");if(s)throw console.error("Error generating share token:",s),s;const{data:l,error:c}=await De.from("project_shares").insert({project_id:t,share_token:n,created_by:e,expires_at:a,permissions:r}).select().single();if(c)throw console.error("Error creating project share:",c),c;return l},async getShareByToken(t){if(!Ue){const a=cr();if(!a.projectShares)return null;const n=a.projectShares.find(s=>s.share_token===t&&s.is_active&&(!s.expires_at||new Date(s.expires_at)>new Date));return n&&(n.view_count++,n.last_viewed_at=new Date().toISOString(),aa(a)),n}const{data:e,error:r}=await De.from("project_shares").select("*, projects(*)").eq("share_token",t).eq("is_active",!0).single();return r?(console.error("Error fetching share by token:",r),null):e.expires_at&&new Date(e.expires_at)<new Date?null:(await De.rpc("increment_share_view_count",{token:t}),e)},async getProjectShares(t){if(!Ue){const a=cr();return a.projectShares?a.projectShares.filter(n=>n.project_id===t):[]}const{data:e,error:r}=await De.from("project_shares").select("*, users(name, email)").eq("project_id",t).order("created_at",{ascending:!1});return r?(console.error("Error fetching project shares:",r),[]):e||[]},async updateProjectShare(t,e){if(!Ue){const n=cr();if(!n.projectShares)return null;const s=n.projectShares.findIndex(l=>l.id===t);return s===-1?null:(n.projectShares[s]={...n.projectShares[s],...e,updated_at:new Date().toISOString()},aa(n),n.projectShares[s])}const{data:r,error:a}=await De.from("project_shares").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating project share:",a),a;return r},async revokeProjectShare(t){return this.updateProjectShare(t,{is_active:!1})},async deleteProjectShare(t){if(!Ue){const r=cr();if(!r.projectShares)return;r.projectShares=r.projectShares.filter(a=>a.id!==t),aa(r);return}const{error:e}=await De.from("project_shares").delete().eq("id",t);if(e)throw console.error("Error deleting project share:",e),e},async getPublicProjectData(t){const e=await this.getShareByToken(t);if(!e)return null;const r=e.project_id||e.projects?.id;if(!Ue){const s=cr(),l=s.projects.find(v=>v.id===r);if(!l)return null;const c=s.areas.filter(v=>v.project_id===r),f=c.reduce((v,x)=>v+parseFloat(x.weight||0),0),d=c.filter(v=>v.status==="done").reduce((v,x)=>v+parseFloat(x.weight||0),0),m=f>0?Math.round(d/f*100):0;return{share:e,project:l,progress:m,areas:e.permissions.progress?c:[],photos:[],dailyReports:[],tmTickets:[]}}const a=e.projects||await this.getProject(r);if(!a)return null;const n={share:e,project:a,areas:[],photos:[],dailyReports:[],tmTickets:[]};if(e.permissions.progress){n.areas=await this.getAreas(r);const s=n.areas.reduce((c,f)=>c+parseFloat(f.weight||0),0),l=n.areas.filter(c=>c.status==="done").reduce((c,f)=>c+parseFloat(f.weight||0),0);n.progress=s>0?Math.round(l/s*100):0}if(e.permissions.photos){const{data:s}=await De.from("t_and_m_tickets").select("photos, work_date").eq("project_id",r).not("photos","is",null).order("work_date",{ascending:!1}).limit(20);n.photos=s?.flatMap(l=>(l.photos||[]).map(c=>({url:c,date:l.work_date})))||[]}if(e.permissions.daily_reports){const{data:s}=await De.from("daily_reports").select("*").eq("project_id",r).order("report_date",{ascending:!1}).limit(10);n.dailyReports=s||[]}return e.permissions.tm_tickets&&(n.tmTickets=await this.getTMTickets(r)),n},async createInjuryReport(t){if(!Ue){const a=cr();a.injuryReports||(a.injuryReports=[]);const n={id:crypto.randomUUID(),...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return a.injuryReports.push(n),aa(a),n}const{data:e,error:r}=await De.from("injury_reports").insert(t).select().single();if(r)throw console.error("Error creating injury report:",r),r;return e},async getInjuryReports(t){if(!Ue){const a=cr();return a.injuryReports?a.injuryReports.filter(n=>n.project_id===t).sort((n,s)=>new Date(s.incident_date)-new Date(n.incident_date)):[]}const{data:e,error:r}=await De.from("injury_reports").select("*").eq("project_id",t).order("incident_date",{ascending:!1});return r?(console.error("Error fetching injury reports:",r),[]):e||[]},async getCompanyInjuryReports(t,e=null){if(!Ue){const s=cr();if(!s.injuryReports)return[];let l=s.injuryReports.filter(c=>c.company_id===t);return e&&(l=l.filter(c=>c.status===e)),l.sort((c,f)=>new Date(f.incident_date)-new Date(c.incident_date))}let r=De.from("injury_reports").select("*, projects(name)").eq("company_id",t).order("incident_date",{ascending:!1});e&&(r=r.eq("status",e));const{data:a,error:n}=await r;return n?(console.error("Error fetching company injury reports:",n),[]):a||[]},async getInjuryReport(t){if(!Ue){const a=cr();return a.injuryReports?a.injuryReports.find(n=>n.id===t):null}const{data:e,error:r}=await De.from("injury_reports").select("*, projects(name, pin), users(name, email)").eq("id",t).single();return r?(console.error("Error fetching injury report:",r),null):e},async updateInjuryReport(t,e){if(!Ue){const n=cr();if(!n.injuryReports)return null;const s=n.injuryReports.findIndex(l=>l.id===t);return s===-1?null:(n.injuryReports[s]={...n.injuryReports[s],...e,updated_at:new Date().toISOString()},aa(n),n.injuryReports[s])}const{data:r,error:a}=await De.from("injury_reports").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating injury report:",a),a;return r},async closeInjuryReport(t,e){return this.updateInjuryReport(t,{status:"closed",closed_at:new Date().toISOString(),closed_by:e})},async deleteInjuryReport(t){if(!Ue){const r=cr();if(!r.injuryReports)return;r.injuryReports=r.injuryReports.filter(a=>a.id!==t),aa(r);return}const{error:e}=await De.from("injury_reports").delete().eq("id",t);if(e)throw console.error("Error deleting injury report:",e),e},async getInjuryStatistics(t,e=null,r=null){if(!Ue){const s=cr();if(!s.injuryReports)return{total_incidents:0,minor_injuries:0,serious_injuries:0,critical_injuries:0,near_misses:0,osha_recordable:0,total_days_away:0,total_restricted_days:0};let l=s.injuryReports.filter(c=>c.company_id===t);return e&&(l=l.filter(c=>new Date(c.incident_date)>=new Date(e))),r&&(l=l.filter(c=>new Date(c.incident_date)<=new Date(r))),{total_incidents:l.length,minor_injuries:l.filter(c=>c.injury_type==="minor").length,serious_injuries:l.filter(c=>c.injury_type==="serious").length,critical_injuries:l.filter(c=>c.injury_type==="critical").length,near_misses:l.filter(c=>c.injury_type==="near_miss").length,osha_recordable:l.filter(c=>c.osha_recordable).length,total_days_away:l.reduce((c,f)=>c+(f.days_away_from_work||0),0),total_restricted_days:l.reduce((c,f)=>c+(f.restricted_work_days||0),0)}}const{data:a,error:n}=await De.rpc("get_injury_statistics",{comp_id:t,start_date:e,end_date:r});return n?(console.error("Error fetching injury statistics:",n),null):a[0]||null},async addWitness(t,e){if(!Ue){const n=cr();if(!n.injuryReports)return null;const s=n.injuryReports.findIndex(f=>f.id===t);if(s===-1)return null;const l=n.injuryReports[s],c=l.witnesses||[];return c.push(e),n.injuryReports[s]={...l,witnesses:c,updated_at:new Date().toISOString()},aa(n),n.injuryReports[s]}const r=await this.getInjuryReport(t);if(!r)return null;const a=r.witnesses||[];return a.push(e),this.updateInjuryReport(t,{witnesses:a})},async removeWitness(t,e){if(!Ue){const n=cr();if(!n.injuryReports)return null;const s=n.injuryReports.findIndex(f=>f.id===t);if(s===-1)return null;const l=n.injuryReports[s],c=l.witnesses||[];return c.splice(e,1),n.injuryReports[s]={...l,witnesses:c,updated_at:new Date().toISOString()},aa(n),n.injuryReports[s]}const r=await this.getInjuryReport(t);if(!r)return null;const a=r.witnesses||[];return a.splice(e,1),this.updateInjuryReport(t,{witnesses:a})},async getCompanyUsers(t){if(Ue){const{data:e,error:r}=await De.from("user_companies").select(`
          user_id,
          role,
          users (
            id,
            name,
            email
          )
        `).eq("company_id",t);return r?(console.error("Error fetching company users:",r),[]):e?.map(a=>({id:a.user_id,name:a.users?.name||a.users?.email,email:a.users?.email,role:a.role}))||[]}return[]},async getProjectNotificationPreferences(t){if(Ue){const{data:r,error:a}=await De.from("notification_preferences").select(`
          *,
          users (
            id,
            name,
            email
          )
        `).eq("project_id",t);return a?(console.error("Error fetching notification preferences:",a),[]):r||[]}const e=cr();return e.notificationPreferences?e.notificationPreferences.filter(r=>r.project_id===t):[]},async getUserNotificationPreferences(t){if(Ue){const{data:r,error:a}=await De.from("notification_preferences").select(`
          *,
          projects (
            id,
            name
          )
        `).eq("user_id",t);return a?(console.error("Error fetching user notification preferences:",a),[]):r||[]}const e=cr();return e.notificationPreferences?e.notificationPreferences.filter(r=>r.user_id===t):[]},async setNotificationPreference(t,e,r){if(Ue){const{data:l,error:c}=await De.from("notification_preferences").upsert({project_id:t,user_id:e,notification_types:r,updated_at:new Date().toISOString()},{onConflict:"project_id,user_id"}).select().single();if(c)throw console.error("Error setting notification preference:",c),c;return l}const a=cr();a.notificationPreferences||(a.notificationPreferences=[]);const n=a.notificationPreferences.findIndex(l=>l.project_id===t&&l.user_id===e),s={id:n>=0?a.notificationPreferences[n].id:crypto.randomUUID(),project_id:t,user_id:e,notification_types:r,created_at:n>=0?a.notificationPreferences[n].created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return n>=0?a.notificationPreferences[n]=s:a.notificationPreferences.push(s),aa(a),s},async removeNotificationPreference(t,e){if(Ue){const{error:a}=await De.from("notification_preferences").delete().eq("project_id",t).eq("user_id",e);if(a)throw console.error("Error removing notification preference:",a),a;return!0}const r=cr();return r.notificationPreferences&&(r.notificationPreferences=r.notificationPreferences.filter(a=>!(a.project_id===t&&a.user_id===e)),aa(r)),!0},async setProjectNotificationPreferences(t,e){const r=[];for(const a of e)if(a.notificationTypes&&a.notificationTypes.length>0){const n=await this.setNotificationPreference(t,a.userId,a.notificationTypes);r.push(n)}else await this.removeNotificationPreference(t,a.userId);return r},async getNotificationPresets(t){if(Ue){const{data:r,error:a}=await De.from("notification_presets").select("*").eq("company_id",t).order("name");return a?(console.error("Error fetching notification presets:",a),[]):r||[]}const e=cr();return e.notificationPresets?e.notificationPresets.filter(r=>r.company_id===t):[{id:"preset-1",name:"Project Manager",notification_types:["message","material_request","injury_report","tm_ticket"],company_id:t},{id:"preset-2",name:"Safety Officer",notification_types:["injury_report"],company_id:t},{id:"preset-3",name:"Purchasing",notification_types:["material_request"],company_id:t},{id:"preset-4",name:"Accounting",notification_types:["tm_ticket"],company_id:t}]},async createNotificationPreset(t,e,r){if(Ue){const{data:s,error:l}=await De.from("notification_presets").insert({company_id:t,name:e,notification_types:r}).select().single();if(l)throw console.error("Error creating notification preset:",l),l;return s}const a=cr();a.notificationPresets||(a.notificationPresets=[]);const n={id:crypto.randomUUID(),company_id:t,name:e,notification_types:r,created_at:new Date().toISOString()};return a.notificationPresets.push(n),aa(a),n},async updateNotificationPreset(t,e,r){if(Ue){const{data:s,error:l}=await De.from("notification_presets").update({name:e,notification_types:r,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(l)throw console.error("Error updating notification preset:",l),l;return s}const a=cr();if(!a.notificationPresets)return null;const n=a.notificationPresets.findIndex(s=>s.id===t);return n===-1?null:(a.notificationPresets[n]={...a.notificationPresets[n],name:e,notification_types:r,updated_at:new Date().toISOString()},aa(a),a.notificationPresets[n])},async deleteNotificationPreset(t){if(Ue){const{error:r}=await De.from("notification_presets").delete().eq("id",t);if(r)throw console.error("Error deleting notification preset:",r),r;return!0}const e=cr();return e.notificationPresets&&(e.notificationPresets=e.notificationPresets.filter(r=>r.id!==t),aa(e)),!0},async getDumpSites(t){if(Ue){const{data:r,error:a}=await De.from("dump_sites").select(`
          *,
          dump_site_rates (*)
        `).eq("company_id",t).eq("active",!0).order("name");return a?(console.error("Error fetching dump sites:",a),[]):r||[]}return(cr().dumpSites||[]).filter(r=>r.company_id===t&&r.active)},async createDumpSite(t,e,r="",a=""){if(Ue){const{data:l,error:c}=await De.from("dump_sites").insert({company_id:t,name:e,address:r,notes:a,active:!0}).select().single();if(c)throw console.error("Error creating dump site:",c),c;return l}const n=cr();n.dumpSites||(n.dumpSites=[]);const s={id:crypto.randomUUID(),company_id:t,name:e,address:r,notes:a,active:!0,created_at:new Date().toISOString(),dump_site_rates:[]};return n.dumpSites.push(s),aa(n),s},async updateDumpSite(t,e){if(Ue){const{data:n,error:s}=await De.from("dump_sites").update({...e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(s)throw console.error("Error updating dump site:",s),s;return n}const r=cr();if(!r.dumpSites)return null;const a=r.dumpSites.findIndex(n=>n.id===t);return a===-1?null:(r.dumpSites[a]={...r.dumpSites[a],...e},aa(r),r.dumpSites[a])},async deleteDumpSite(t){return this.updateDumpSite(t,{active:!1})},async setDumpSiteRate(t,e,r,a="load"){if(Ue){const{data:c}=await De.from("dump_site_rates").select("id").eq("dump_site_id",t).eq("waste_type",e).maybeSingle();if(c){const{data:f,error:d}=await De.from("dump_site_rates").update({estimated_cost_per_load:r,unit:a}).eq("id",c.id).select().single();if(d)throw console.error("Error updating dump site rate:",d),d;return f}else{const{data:f,error:d}=await De.from("dump_site_rates").insert({dump_site_id:t,waste_type:e,estimated_cost_per_load:r,unit:a}).select().single();if(d)throw console.error("Error inserting dump site rate:",d),d;return f}}const n=cr();n.dumpSiteRates||(n.dumpSiteRates=[]);const s=n.dumpSiteRates.findIndex(c=>c.dump_site_id===t&&c.waste_type===e),l={id:s>=0?n.dumpSiteRates[s].id:crypto.randomUUID(),dump_site_id:t,waste_type:e,estimated_cost_per_load:r,unit:a,created_at:new Date().toISOString()};return s>=0?n.dumpSiteRates[s]=l:n.dumpSiteRates.push(l),aa(n),l},async getDumpSiteRates(t){if(Ue){const{data:r,error:a}=await De.from("dump_site_rates").select("*").eq("dump_site_id",t);return a?(console.error("Error fetching dump site rates:",a),[]):r||[]}return(cr().dumpSiteRates||[]).filter(r=>r.dump_site_id===t)},async getHaulOffs(t){if(Ue){const{data:r,error:a}=await De.from("haul_offs").select(`
          *,
          dump_sites (name)
        `).eq("project_id",t).order("work_date",{ascending:!1});return a?(console.error("Error fetching haul-offs:",a),[]):r||[]}return(cr().haulOffs||[]).filter(r=>r.project_id===t).sort((r,a)=>new Date(a.work_date)-new Date(r.work_date))},async createHaulOff(t,e){const r={project_id:t,dump_site_id:e.dumpSiteId,waste_type:e.wasteType,loads:e.loads,hauling_company:e.haulingCompany||"",work_date:e.workDate,notes:e.notes||"",estimated_cost:e.estimatedCost||0,created_by:e.createdBy||""};if(Ue){const{data:s,error:l}=await De.from("haul_offs").insert(r).select().single();if(l)throw console.error("Error creating haul-off:",l),l;return s}const a=cr();a.haulOffs||(a.haulOffs=[]);const n={...r,id:crypto.randomUUID(),created_at:new Date().toISOString()};return a.haulOffs.push(n),aa(a),n},async calculateHaulOffCosts(t){const e=await this.getHaulOffs(t);let r=0,a=0;const n={},s=[],l={};e.forEach(f=>{const d=parseFloat(f.estimated_cost)||0,m=parseInt(f.loads)||0;r+=d,a+=m,n[f.waste_type]||(n[f.waste_type]={loads:0,cost:0}),n[f.waste_type].loads+=m,n[f.waste_type].cost+=d,l[f.work_date]||(l[f.work_date]={date:f.work_date,loads:0,cost:0}),l[f.work_date].loads+=m,l[f.work_date].cost+=d}),Object.values(l).sort((f,d)=>new Date(d.date)-new Date(f.date)).forEach(f=>s.push(f));const c=s.length;return{totalCost:r,totalLoads:a,byWasteType:n,byDate:s,daysWithHaulOff:c,avgDailyHaulOffCost:c>0?r/c:0}},subscribeToHaulOffs(t,e){return Ue?De.channel(`haul_offs:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"haul_offs",filter:`project_id=eq.${t}`},e).subscribe():null},async createCOR(t){if(Ue){const{data:e,error:r}=await De.from("change_orders").insert({company_id:t.company_id,project_id:t.project_id,area_id:t.area_id||null,cor_number:t.cor_number,title:t.title,description:t.description||"",scope_of_work:t.scope_of_work,period_start:t.period_start,period_end:t.period_end,status:"draft",labor_markup_percent:t.labor_markup_percent??1500,materials_markup_percent:t.materials_markup_percent??1500,equipment_markup_percent:t.equipment_markup_percent??1500,subcontractors_markup_percent:t.subcontractors_markup_percent??500,liability_insurance_percent:t.liability_insurance_percent??144,bond_percent:t.bond_percent??100,license_fee_percent:t.license_fee_percent??10,created_by:t.created_by||null}).select().single();if(r)throw r;return e}return null},async updateCOR(t,e){if(Ue){const{data:r,error:a}=await De.from("change_orders").update({...e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteCOR(t){if(Ue){const{error:e}=await De.from("change_orders").delete().eq("id",t);if(e)throw e}},async getCORs(t,e={}){if(Ue){let r=De.from("change_orders").select(`
          *,
          areas (id, name),
          labor_count:change_order_labor(count),
          materials_count:change_order_materials(count),
          equipment_count:change_order_equipment(count),
          subcontractors_count:change_order_subcontractors(count),
          tickets_count:change_order_ticket_associations(count)
        `).eq("project_id",t);e.status&&(r=r.eq("status",e.status)),e.area_id&&(r=r.eq("area_id",e.area_id)),e.date_start&&(r=r.gte("period_start",e.date_start)),e.date_end&&(r=r.lte("period_end",e.date_end)),r=r.order("created_at",{ascending:!1});const{data:a,error:n}=await r;if(n)throw n;return a}return[]},async getCORById(t){if(Ue){const{data:e,error:r}=await De.from("change_orders").select(`
          *,
          areas (id, name),
          change_order_labor (*),
          change_order_materials (*),
          change_order_equipment (*),
          change_order_subcontractors (*),
          change_order_ticket_associations (
            *,
            t_and_m_tickets (
              id, work_date, ce_pco_number, status, notes
            )
          )
        `).eq("id",t).single();if(r)throw r;return e}return null},async getCORsByArea(t,e){if(Ue){const{data:r,error:a}=await De.from("change_orders").select("*").eq("project_id",t).eq("area_id",e).order("created_at",{ascending:!1});if(a)throw a;return r}return[]},async getNextCORNumber(t){if(Ue){const{data:e,error:r}=await De.from("change_orders").select("cor_number").eq("project_id",t).order("created_at",{ascending:!1}).limit(1);if(r)throw r;if(e&&e.length>0){const a=e[0].cor_number.match(/COR #(\d+)/);if(a)return`COR #${parseInt(a[1])+1}`}return"COR #1"}return"COR #1"},async addCORLaborItem(t,e){if(Ue){const r=Math.round(e.regular_hours*e.regular_rate),a=Math.round(e.overtime_hours*e.overtime_rate),n=r+a,{data:s,error:l}=await De.from("change_order_labor").insert({change_order_id:t,labor_class:e.labor_class,wage_type:e.wage_type||"standard",regular_hours:e.regular_hours||0,overtime_hours:e.overtime_hours||0,regular_rate:e.regular_rate||0,overtime_rate:e.overtime_rate||0,regular_total:r,overtime_total:a,total:n,sort_order:e.sort_order||0,source_ticket_id:e.source_ticket_id||null}).select().single();if(l)throw l;return s}return null},async updateCORLaborItem(t,e){if(Ue){let r={...e};if(e.regular_hours!==void 0||e.regular_rate!==void 0||e.overtime_hours!==void 0||e.overtime_rate!==void 0){const{data:s}=await De.from("change_order_labor").select("regular_hours, overtime_hours, regular_rate, overtime_rate").eq("id",t).single(),l=e.regular_hours??s?.regular_hours??0,c=e.overtime_hours??s?.overtime_hours??0,f=e.regular_rate??s?.regular_rate??0,d=e.overtime_rate??s?.overtime_rate??0;r.regular_total=Math.round(l*f),r.overtime_total=Math.round(c*d),r.total=r.regular_total+r.overtime_total}const{data:a,error:n}=await De.from("change_order_labor").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCORLaborItem(t){if(Ue){const{error:e}=await De.from("change_order_labor").delete().eq("id",t);if(e)throw e}},async addCORMaterialItem(t,e){if(Ue){const r=Math.round(e.quantity*e.unit_cost),{data:a,error:n}=await De.from("change_order_materials").insert({change_order_id:t,description:e.description,quantity:e.quantity||1,unit:e.unit||"each",unit_cost:e.unit_cost||0,total:r,source_type:e.source_type||"custom",source_reference:e.source_reference||null,source_ticket_id:e.source_ticket_id||null,sort_order:e.sort_order||0}).select().single();if(n)throw n;return a}return null},async updateCORMaterialItem(t,e){if(Ue){let r={...e};if(e.quantity!==void 0||e.unit_cost!==void 0){const{data:s}=await De.from("change_order_materials").select("quantity, unit_cost").eq("id",t).single(),l=e.quantity??s?.quantity??1,c=e.unit_cost??s?.unit_cost??0;r.total=Math.round(l*c)}const{data:a,error:n}=await De.from("change_order_materials").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCORMaterialItem(t){if(Ue){const{error:e}=await De.from("change_order_materials").delete().eq("id",t);if(e)throw e}},async addCOREquipmentItem(t,e){if(Ue){const r=Math.round(e.quantity*e.unit_cost),{data:a,error:n}=await De.from("change_order_equipment").insert({change_order_id:t,description:e.description,quantity:e.quantity||1,unit:e.unit||"day",unit_cost:e.unit_cost||0,total:r,source_type:e.source_type||"custom",source_reference:e.source_reference||null,source_ticket_id:e.source_ticket_id||null,sort_order:e.sort_order||0}).select().single();if(n)throw n;return a}return null},async updateCOREquipmentItem(t,e){if(Ue){let r={...e};if(e.quantity!==void 0||e.unit_cost!==void 0){const{data:s}=await De.from("change_order_equipment").select("quantity, unit_cost").eq("id",t).single(),l=e.quantity??s?.quantity??1,c=e.unit_cost??s?.unit_cost??0;r.total=Math.round(l*c)}const{data:a,error:n}=await De.from("change_order_equipment").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCOREquipmentItem(t){if(Ue){const{error:e}=await De.from("change_order_equipment").delete().eq("id",t);if(e)throw e}},async addCORSubcontractorItem(t,e){if(Ue){const r=Math.round(e.quantity*e.unit_cost),{data:a,error:n}=await De.from("change_order_subcontractors").insert({change_order_id:t,description:e.description,quantity:e.quantity||1,unit:e.unit||"lump sum",unit_cost:e.unit_cost||0,total:r,source_type:e.source_type||"custom",source_reference:e.source_reference||null,sort_order:e.sort_order||0}).select().single();if(n)throw n;return a}return null},async updateCORSubcontractorItem(t,e){if(Ue){let r={...e};if(e.quantity!==void 0||e.unit_cost!==void 0){const{data:s}=await De.from("change_order_subcontractors").select("quantity, unit_cost").eq("id",t).single(),l=e.quantity??s?.quantity??1,c=e.unit_cost??s?.unit_cost??0;r.total=Math.round(l*c)}const{data:a,error:n}=await De.from("change_order_subcontractors").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCORSubcontractorItem(t){if(Ue){const{error:e}=await De.from("change_order_subcontractors").delete().eq("id",t);if(e)throw e}},async addBulkLaborItems(t,e){if(Ue&&e.length>0){const r=e.map((s,l)=>{const c=Math.round(s.regular_hours*s.regular_rate),f=Math.round(s.overtime_hours*s.overtime_rate);return{change_order_id:t,labor_class:s.labor_class,wage_type:s.wage_type||"standard",regular_hours:s.regular_hours||0,overtime_hours:s.overtime_hours||0,regular_rate:s.regular_rate||0,overtime_rate:s.overtime_rate||0,regular_total:c,overtime_total:f,total:c+f,sort_order:s.sort_order??l,source_ticket_id:s.source_ticket_id||null}}),{data:a,error:n}=await De.from("change_order_labor").insert(r).select();if(n)throw n;return a}return[]},async addBulkMaterialItems(t,e){if(Ue&&e.length>0){const r=e.map((s,l)=>({change_order_id:t,description:s.description,quantity:s.quantity||1,unit:s.unit||"each",unit_cost:s.unit_cost||0,total:Math.round((s.quantity||1)*(s.unit_cost||0)),source_type:s.source_type||"custom",source_reference:s.source_reference||null,source_ticket_id:s.source_ticket_id||null,sort_order:s.sort_order??l})),{data:a,error:n}=await De.from("change_order_materials").insert(r).select();if(n)throw n;return a}return[]},async addBulkEquipmentItems(t,e){if(Ue&&e.length>0){const r=e.map((s,l)=>({change_order_id:t,description:s.description,quantity:s.quantity||1,unit:s.unit||"day",unit_cost:s.unit_cost||0,total:Math.round((s.quantity||1)*(s.unit_cost||0)),source_type:s.source_type||"custom",source_reference:s.source_reference||null,source_ticket_id:s.source_ticket_id||null,sort_order:s.sort_order??l})),{data:a,error:n}=await De.from("change_order_equipment").insert(r).select();if(n)throw n;return a}return[]},async addBulkSubcontractorItems(t,e){if(Ue&&e.length>0){const r=e.map((s,l)=>({change_order_id:t,description:s.description,quantity:s.quantity||1,unit:s.unit||"lump sum",unit_cost:s.unit_cost||0,total:Math.round((s.quantity||1)*(s.unit_cost||0)),source_type:s.source_type||"custom",source_reference:s.source_reference||null,sort_order:s.sort_order??l})),{data:a,error:n}=await De.from("change_order_subcontractors").insert(r).select();if(n)throw n;return a}return[]},async clearCORLineItems(t){Ue&&(await De.from("change_order_labor").delete().eq("change_order_id",t),await De.from("change_order_materials").delete().eq("change_order_id",t),await De.from("change_order_equipment").delete().eq("change_order_id",t),await De.from("change_order_subcontractors").delete().eq("change_order_id",t))},async saveCORLineItems(t,{laborItems:e,materialItems:r,equipmentItems:a,subcontractorItems:n}){if(Ue){await this.clearCORLineItems(t);const s=await Promise.all([e?.length>0?this.addBulkLaborItems(t,e):[],r?.length>0?this.addBulkMaterialItems(t,r):[],a?.length>0?this.addBulkEquipmentItems(t,a):[],n?.length>0?this.addBulkSubcontractorItems(t,n):[]]);return{labor:s[0],materials:s[1],equipment:s[2],subcontractors:s[3]}}return null},async assignTicketToCOR(t,e){if(Ue){const{data:r,error:a}=await De.from("change_order_ticket_associations").insert({change_order_id:e,ticket_id:t,data_imported:!1}).select().single();if(a)throw a;const{error:n}=await De.from("t_and_m_tickets").update({assigned_cor_id:e}).eq("id",t);if(n)throw n;return r}return null},async unassignTicketFromCOR(t,e){if(Ue){const{error:r}=await De.from("change_order_ticket_associations").delete().eq("ticket_id",t).eq("change_order_id",e);if(r)throw r;const{error:a}=await De.from("t_and_m_tickets").update({assigned_cor_id:null}).eq("id",t);if(a)throw a}},async getTicketsForCOR(t){if(Ue){const{data:e,error:r}=await De.from("change_order_ticket_associations").select(`
          *,
          t_and_m_tickets (
            *,
            t_and_m_workers (*),
            t_and_m_items (
              *,
              materials_equipment (name, unit, cost_per_unit, category)
            )
          )
        `).eq("change_order_id",t);if(r)throw r;return e}return[]},async getUnassignedTickets(t){if(Ue){const{data:e,error:r}=await De.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).is("assigned_cor_id",null).order("work_date",{ascending:!1});if(r)throw r;return e}return[]},async importTicketDataToCOR(t,e,r,a,n){if(Ue){const{data:s,error:l}=await De.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("id",t).single();if(l)throw l;const{data:c,error:f}=await De.from("labor_rates").select("*").eq("company_id",r).eq("work_type",a||"demolition").eq("job_type",n||"standard");if(f)throw f;const d={};c?.forEach(_=>{d[_.role.toLowerCase()]=_});const m={};s.t_and_m_workers?.forEach(_=>{const w=(_.role||"laborer").toLowerCase();m[w]||(m[w]={regular_hours:0,overtime_hours:0}),m[w].regular_hours+=parseFloat(_.hours)||0,m[w].overtime_hours+=parseFloat(_.overtime_hours)||0});const v=Object.entries(m).map(([_,w])=>{const A=d[_]||{regular_rate:0,overtime_rate:0},C=Math.round((parseFloat(A.regular_rate)||0)*100),E=Math.round((parseFloat(A.overtime_rate)||0)*100);return{labor_class:_.charAt(0).toUpperCase()+_.slice(1),wage_type:n||"standard",regular_hours:w.regular_hours,overtime_hours:w.overtime_hours,regular_rate:C,overtime_rate:E,source_ticket_id:t}});v.length>0&&await this.addBulkLaborItems(e,v);const x=[],g=[];s.t_and_m_items?.forEach(_=>{const w=_.custom_name||_.materials_equipment?.name||"Unknown Item",A=_.custom_category||_.materials_equipment?.category||"Other",C=_.materials_equipment?.unit||"each",E=Math.round((parseFloat(_.materials_equipment?.cost_per_unit)||0)*100),R={description:w,quantity:_.quantity||1,unit:C,unit_cost:E,source_type:"backup_sheet",source_ticket_id:t};A==="Equipment"?g.push(R):x.push(R)}),x.length>0&&await this.addBulkMaterialItems(e,x),g.length>0&&await this.addBulkEquipmentItems(e,g);const{error:b}=await De.from("change_order_ticket_associations").update({data_imported:!0,imported_at:new Date().toISOString()}).eq("change_order_id",e).eq("ticket_id",t);if(b)throw b;return{laborItems:v,materialItems:x,equipmentItems:g}}return null},async reimportTicketDataToCOR(t,e,r,a,n){return Ue?(await De.from("change_order_labor").delete().eq("change_order_id",e).eq("source_ticket_id",t),await De.from("change_order_materials").delete().eq("change_order_id",e).eq("source_ticket_id",t),await De.from("change_order_equipment").delete().eq("change_order_id",e).eq("source_ticket_id",t),this.importTicketDataToCOR(t,e,r,a,n)):null},async recalculateCOR(t){if(Ue){const{error:e}=await De.rpc("recalculate_cor_totals",{cor_id:t});if(e)throw e;return this.getCORById(t)}return null},async updateCORMarkupPercentages(t,e){if(Ue){const r={};e.labor!==void 0&&(r.labor_markup_percent=e.labor),e.materials!==void 0&&(r.materials_markup_percent=e.materials),e.equipment!==void 0&&(r.equipment_markup_percent=e.equipment),e.subcontractors!==void 0&&(r.subcontractors_markup_percent=e.subcontractors);const{data:a,error:n}=await De.from("change_orders").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async updateCORFeePercentages(t,e){if(Ue){const r={};e.liabilityInsurance!==void 0&&(r.liability_insurance_percent=e.liabilityInsurance),e.bond!==void 0&&(r.bond_percent=e.bond),e.licenseFee!==void 0&&(r.license_fee_percent=e.licenseFee);const{data:a,error:n}=await De.from("change_orders").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async submitCORForApproval(t){if(Ue){const{data:e,error:r}=await De.from("change_orders").update({status:"pending_approval",submitted_at:new Date().toISOString()}).eq("id",t).select().single();if(r)throw r;return e}return null},async approveCOR(t,e){if(Ue){const{data:r,error:a}=await De.from("change_orders").update({status:"approved",approved_by:e,approved_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return r}return null},async rejectCOR(t,e=null){if(Ue){const{data:r,error:a}=await De.from("change_orders").update({status:"rejected",rejection_reason:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async markCORAsBilled(t){if(Ue){const{data:e,error:r}=await De.from("change_orders").update({status:"billed"}).eq("id",t).select().single();if(r)throw r;return e}return null},async closeCOR(t){if(Ue){const{data:e,error:r}=await De.from("change_orders").update({status:"closed"}).eq("id",t).select().single();if(r)throw r;return e}return null},async saveCORSignature(t,e,r){if(Ue){const{data:a,error:n}=await De.from("change_orders").update({gc_signature_data:e,gc_signature_name:r,gc_signature_date:new Date().toISOString(),status:"approved"}).eq("id",t).select().single();if(n)throw n;return a}return null},async getCORStats(t){if(Ue){const{data:e,error:r}=await De.from("change_orders").select("status, cor_total").eq("project_id",t);if(r)throw r;const a={total_cors:e.length,draft_count:0,pending_count:0,approved_count:0,rejected_count:0,billed_count:0,total_approved_value:0,total_pending_value:0,total_billed_value:0};return e.forEach(n=>{switch(n.status){case"draft":a.draft_count++;break;case"pending_approval":a.pending_count++,a.total_pending_value+=n.cor_total||0;break;case"approved":a.approved_count++,a.total_approved_value+=n.cor_total||0;break;case"rejected":a.rejected_count++;break;case"billed":case"closed":a.billed_count++,a.total_billed_value+=n.cor_total||0;break}}),a}return{total_cors:0,draft_count:0,pending_count:0,approved_count:0,rejected_count:0,billed_count:0,total_approved_value:0,total_pending_value:0,total_billed_value:0}},subscribeToCORs(t,e){return Ue?De.channel(`change_orders:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"change_orders",filter:`project_id=eq.${t}`},e).subscribe():null},async createSignatureRequest(t,e,r,a,n=null,s=null){if(Ue){const{data:l,error:c}=await De.rpc("generate_signature_token");if(c)throw c;const{data:f,error:d}=await De.from("signature_requests").insert({document_type:t,document_id:e,company_id:r,project_id:a,signature_token:l,expires_at:s,created_by:n}).select().single();if(d)throw d;return f}return null},async getSignatureRequestByToken(t){if(Ue){await De.rpc("increment_signature_view_count",{token:t});const{data:e,error:r}=await De.from("signature_requests").select(`
          *,
          signatures (*)
        `).eq("signature_token",t).single();if(r)throw r;return e}return null},async getSignatureRequestsForDocument(t,e){if(Ue){const{data:r,error:a}=await De.from("signature_requests").select(`
          *,
          signatures (*)
        `).eq("document_type",t).eq("document_id",e).order("created_at",{ascending:!1});if(a)throw a;return r||[]}return[]},async addSignature(t,e,r){if(Ue){const{data:a,error:n}=await De.from("signatures").insert({signature_request_id:t,signature_slot:e,signature_image:r.signature,signer_name:r.signerName,signer_title:r.signerTitle||null,signer_company:r.signerCompany||null,signed_at:r.signedAt||new Date().toISOString(),ip_address:r.ipAddress||null,user_agent:r.userAgent||null}).select().single();if(n)throw n;return a}return null},async syncSignatureToDocument(t,e){if(!Ue)return null;const{document_type:r,document_id:a}=e,n=t.signature_slot,s={};n===1?(s.gc_signature_data=t.signature_image,s.gc_signature_name=t.signer_name,s.gc_signature_title=t.signer_title,s.gc_signature_company=t.signer_company,s.gc_signature_date=t.signed_at,s.gc_signature_ip=t.ip_address):n===2&&(s.client_signature_data=t.signature_image,s.client_signature_name=t.signer_name,s.client_signature_title=t.signer_title,s.client_signature_company=t.signer_company,s.client_signature_date=t.signed_at,s.client_signature_ip=t.ip_address);const l=r==="cor"?"change_orders":"t_and_m_tickets",{data:c,error:f}=await De.from(l).update(s).eq("id",a).select().single();if(f)throw f;return c},async revokeSignatureRequest(t){if(Ue){const{data:e,error:r}=await De.from("signature_requests").update({status:"revoked"}).eq("id",t).select().single();if(r)throw r;return e}return null},async getDocumentForSigning(t,e){if(!Ue)return null;if(t==="cor"){const{data:r,error:a}=await De.from("change_orders").select(`
          *,
          projects (
            id,
            name,
            job_number,
            companies (
              id,
              name,
              logo_url
            )
          ),
          change_order_labor (*),
          change_order_materials (*),
          change_order_equipment (*),
          change_order_subcontractors (*)
        `).eq("id",e).single();if(a)throw a;return r}else if(t==="tm_ticket"){const{data:r,error:a}=await De.from("t_and_m_tickets").select(`
          *,
          projects (
            id,
            name,
            job_number,
            companies (
              id,
              name,
              logo_url
            )
          ),
          t_and_m_workers (*),
          t_and_m_items (*)
        `).eq("id",e).single();if(a)throw a;return r}return null}};q4(async t=>{if(t&&Ue){console.log("Back online - syncing pending actions...");try{const e=await wC(ot);e.synced>0&&console.log(`Synced ${e.synced} pending actions`),e.failed>0&&console.warn(`Failed to sync ${e.failed} actions`)}catch(e){console.error("Error syncing pending actions:",e)}}});const $4=ne.createContext(),Ci={logo_url:null,favicon_url:null,login_background_url:null,primary_color:"#3B82F6",secondary_color:"#1E40AF",custom_app_name:"FieldSync",hide_fieldsync_branding:!1,email_from_name:"FieldSync",email_from_address:null,custom_domain:null,domain_verified:!1};function Rd({children:t,companyId:e}){const[r,a]=ne.useState(Ci),[n,s]=ne.useState(!0);ne.useEffect(()=>{e?l(e):c()},[e]),ne.useEffect(()=>{m(r)},[r]);const l=async g=>{try{if(s(!0),!Ue){a(Ci),s(!1);return}const{data:b,error:_}=await De.from("company_branding").select("*").eq("company_id",g).single();_?(_.code==="PGRST116"?await f(g):console.error("Error loading branding:",_),a(Ci)):a({...Ci,...b})}catch(b){console.error("Error in loadBranding:",b),a(Ci)}finally{s(!1)}},c=async()=>{try{s(!0);const g=window.location.hostname;if(g==="localhost"||g==="127.0.0.1"){a(Ci),s(!1);return}if(!Ue){a(Ci),s(!1);return}const{data:b,error:_}=await De.rpc("get_branding_by_domain",{domain_name:g});_||!b||b.length===0?a(Ci):a({...Ci,...b[0]})}catch(g){console.error("Error loading branding by domain:",g),a(Ci)}finally{s(!1)}},f=async g=>{try{const{data:b,error:_}=await De.from("company_branding").insert({company_id:g,...Ci}).select().single();_&&console.error("Error creating default branding:",_)}catch(b){console.error("Error in createDefaultBranding:",b)}},d=async g=>{try{if(!Ue)return a(R=>({...R,...g})),{success:!0};if(!e)return{success:!1,error:"No company ID"};const b={},_=["logo_url","favicon_url","login_background_url","primary_color","secondary_color","custom_app_name","hide_fieldsync_branding","email_from_name","email_from_address","custom_domain","domain_verified"];for(const R of _)g[R]!==void 0&&(b[R]=g[R]);const{data:w,error:A}=await De.from("company_branding").select("id").eq("company_id",e).single();if(A&&A.code==="PGRST116"){const{data:R,error:Y}=await De.from("company_branding").insert({company_id:e,...b}).select().single();return Y?(console.error("Error creating branding:",Y),{success:!1,error:Y.message}):(a({...Ci,...R}),{success:!0,data:R})}const{data:C,error:E}=await De.from("company_branding").update(b).eq("company_id",e).select().single();return E?(console.error("Error updating branding:",E),{success:!1,error:E.message}):(a({...Ci,...C}),{success:!0,data:C})}catch(b){return console.error("Error in updateBranding:",b),{success:!1,error:b.message}}},m=g=>{const b=document.documentElement;if(b.style.setProperty("--primary-color",g.primary_color),b.style.setProperty("--secondary-color",g.secondary_color),g.favicon_url){let _=document.querySelector("link[rel*='icon']");_||(_=document.createElement("link"),_.rel="icon",document.head.appendChild(_)),_.href=g.favicon_url}document.title=g.custom_app_name||"FieldSync"},x={branding:r,loading:n,updateBranding:d,uploadBrandingImage:async(g,b)=>{try{if(!Ue)return{success:!0,url:URL.createObjectURL(g)};const _=g.name.split(".").pop(),A=`branding/${`${e}/${b}-${Date.now()}.${_}`}`,{data:C,error:E}=await De.storage.from("public").upload(A,g,{cacheControl:"3600",upsert:!0});if(E)return console.error("Error uploading image:",E),{success:!1,error:E.message};const{data:{publicUrl:R}}=De.storage.from("public").getPublicUrl(A);return{success:!0,url:R}}catch(_){return console.error("Error in uploadBrandingImage:",_),{success:!1,error:_.message}}},refreshBranding:()=>e?l(e):c()};return o.jsx($4.Provider,{value:x,children:t})}function uh(){const t=ne.useContext($4);if(!t)throw new Error("useBranding must be used within a BrandingProvider");return t}const jC=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),EC=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,a)=>a?a.toUpperCase():r.toLowerCase()),Zb=t=>{const e=EC(t);return e.charAt(0).toUpperCase()+e.slice(1)},W4=(...t)=>t.filter((e,r,a)=>!!e&&e.trim()!==""&&a.indexOf(e)===r).join(" ").trim(),AC=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var CC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const TC=ne.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:s,iconNode:l,...c},f)=>ne.createElement("svg",{ref:f,...CC,width:e,height:e,stroke:t,strokeWidth:a?Number(r)*24/Number(e):r,className:W4("lucide",n),...!s&&!AC(c)&&{"aria-hidden":"true"},...c},[...l.map(([d,m])=>ne.createElement(d,m)),...Array.isArray(s)?s:[s]]));const br=(t,e)=>{const r=ne.forwardRef(({className:a,...n},s)=>ne.createElement(TC,{ref:s,iconNode:e,className:W4(`lucide-${jC(Zb(t))}`,`lucide-${t}`,a),...n}));return r.displayName=Zb(t),r};const OC=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],RC=br("bell",OC);const DC=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],E0=br("briefcase",DC);const FC=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Zx=br("building-2",FC);const LC=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],V0=br("calendar",LC);const PC=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Op=br("camera",PC);const MC=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],A0=br("check",MC);const IC=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],jf=br("chevron-down",IC);const BC=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],UC=br("chevron-left",BC);const qC=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ef=br("chevron-right",qC);const zC=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],HC=br("chevron-up",zC);const $C=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],G0=br("circle-alert",$C);const WC=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],$d=br("circle-check-big",WC);const VC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Qb=br("circle-x",VC);const GC=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],hu=br("clipboard-list",GC);const YC=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Hp=br("clock",YC);const XC=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ew=br("copy",XC);const KC=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],$p=br("dollar-sign",KC);const JC=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ZC=br("download",JC);const QC=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],tw=br("external-link",QC);const eT=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],tT=br("eye",eT);const rT=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],El=br("file-text",rT);const aT=[["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["rect",{x:"2",y:"15",width:"20",height:"4",rx:"1",key:"g3x8cw"}]],Ui=br("hard-hat",aT);const nT=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],V4=br("info",nT);const sT=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],iT=br("layout-grid",sT);const oT=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Qx=br("link",oT);const lT=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],cT=br("map-pin",lT);const uT=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Y0=br("message-square",uT);const fT=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Af=br("package",fT);const dT=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],e2=br("pen-line",dT);const hT=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],mT=br("pen-tool",hT);const pT=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],G4=br("pen",pT);const gT=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Y4=br("pencil",gT);const vT=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],xT=br("percent",vT);const yT=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],_T=br("phone",yT);const bT=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Sl=br("plus",bT);const wT=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],X4=br("rotate-ccw",wT);const ST=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],rw=br("save",ST);const NT=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],kT=br("search",NT);const jT=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],K4=br("send",jT);const ET=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],J4=br("shield",ET);const AT=[["path",{d:"M14 13V8.5C14 7 15 7 15 5a3 3 0 0 0-6 0c0 2 1 2 1 3.5V13",key:"i9gjdv"}],["path",{d:"M20 15.5a2.5 2.5 0 0 0-2.5-2.5h-11A2.5 2.5 0 0 0 4 15.5V17a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1z",key:"1vzg3v"}],["path",{d:"M5 22h14",key:"ehvnwv"}]],CT=br("stamp",AT);const TT=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],cu=br("trash-2",TT);const OT=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],h1=br("triangle-alert",OT);const RT=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],m1=br("truck",RT);const DT=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],FT=br("upload",DT);const LT=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],PT=br("user-check",LT);const MT=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Z4=br("users",MT);const IT=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],t2=br("wrench",IT);const BT=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],fh=br("x",BT);const UT=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],qT=br("zap",UT);function Nl({className:t="",showPoweredBy:e=!1}){const{branding:r}=uh();return o.jsxs("div",{className:`app-logo ${t}`,children:[r.logo_url?o.jsx("img",{src:r.logo_url,alt:r.custom_app_name||"Logo",className:"custom-logo"}):o.jsxs("div",{className:"logo",children:[r.custom_app_name||"Field",o.jsx("span",{children:"Sync"})]}),e&&!r.hide_fieldsync_branding&&o.jsx("div",{className:"powered-by",children:"Powered by FieldSync"})]})}function zT({onForemanAccess:t,onOfficeLogin:e,onShowToast:r}){const[a,n]=ne.useState(null),[s,l]=ne.useState(""),[c,f]=ne.useState(null),[d,m]=ne.useState(""),[v,x]=ne.useState(!1),[g,b]=ne.useState(""),[_,w]=ne.useState(""),[A,C]=ne.useState(1),[E,R]=ne.useState(null),[Y,W]=ne.useState(""),[B,q]=ne.useState(""),[L,J]=ne.useState(""),[D,T]=ne.useState(""),M=F=>{const I=F.toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,20);l(I)},V=async()=>{if(s.length<2){r("Enter company code","error");return}x(!0);try{const F=await ot.getCompanyByCode(s);F?f(F):(r("Invalid company code","error"),l(""))}catch{r("Error checking code","error")}finally{x(!1)}},ie=async F=>{if(F.length===4){x(!0);try{const I=await ot.getProjectByPinAndCompany(F,c.id);I?t(I):(r("Invalid PIN","error"),m(""))}catch{r("Error checking PIN","error")}finally{x(!1)}}},X=F=>{if(d.length<4){const I=d+F;m(I),I.length===4&&setTimeout(()=>ie(I),200)}},Z=()=>{m(F=>F.slice(0,-1))},K=()=>{f(null),m("")},re=()=>{if(!g.trim()||!_.trim()){r("Enter email and password","error");return}e(g,_)},de=async()=>{if(s.length<2){r("Enter company code","error");return}x(!0);try{const F=await ot.getCompanyByCode(s);F?(R(F),C(2)):(r("Invalid company code","error"),l(""))}catch{r("Error checking code","error")}finally{x(!1)}},U=async()=>{if(!Y.trim()){r("Enter office code","error");return}x(!0);try{const{data:F,error:I}=await De.rpc("verify_office_code",{company_id:E.id,code:Y.trim()});if(I)throw I;F===!0?C(3):(r("Invalid office code","error"),W(""))}catch{r("Error verifying code","error")}finally{x(!1)}},k=async()=>{if(!B.trim()){r("Enter your name","error");return}if(!L.trim()||!L.includes("@")){r("Enter valid email","error");return}if(D.length<6){r("Password must be 6+ characters","error");return}x(!0);try{const{data:F,error:I}=await De.auth.signUp({email:L,password:D});if(I)throw I;const z=F.user?.id;if(!z)throw new Error("Failed to create user");const{error:te}=await De.from("users").insert({id:z,email:L,password_hash:"managed_by_supabase_auth",name:B.trim(),company_id:E.id,role:"member",is_active:!0});if(te)throw te;const{error:se}=await De.from("user_companies").insert({user_id:z,company_id:E.id,role:"member"});se&&console.error("Error adding to user_companies:",se),r("Account created! Logging you in...","success"),setTimeout(()=>{window.location.reload()},1e3)}catch(F){console.error("Join error:",F),r(F.message||"Error creating account","error")}finally{x(!1)}};if(a===null)return o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsxs("div",{className:"entry-buttons",children:[o.jsxs("button",{className:"entry-mode-btn foreman",onClick:()=>n("foreman"),children:[o.jsx("span",{className:"entry-mode-icon",children:o.jsx(Ui,{size:32})}),o.jsx("span",{className:"entry-mode-title",children:"Foreman"}),o.jsx("span",{className:"entry-mode-desc",children:"Enter project PIN"})]}),o.jsxs("button",{className:"entry-mode-btn office",onClick:()=>n("office"),children:[o.jsx("span",{className:"entry-mode-icon",children:o.jsx(E0,{size:32})}),o.jsx("span",{className:"entry-mode-title",children:"Office"}),o.jsx("span",{className:"entry-mode-desc",children:"Sign in to dashboard"})]})]})]})});if(a==="foreman")return c?o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx("button",{className:"entry-back",onClick:K,children:""}),o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsx("div",{className:"entry-company-badge",children:c.name}),o.jsx("p",{className:"entry-subtitle",children:"Enter project PIN"}),o.jsx("div",{className:"pin-display",children:[0,1,2,3].map(F=>o.jsx("div",{className:`pin-dot ${d.length>F?"filled":""}`,children:d.length>F?"":""},F))}),o.jsxs("div",{className:"number-pad",children:[[1,2,3,4,5,6,7,8,9].map(F=>o.jsx("button",{className:"num-btn",onClick:()=>X(F.toString()),disabled:v,children:F},F)),o.jsx("button",{className:"num-btn empty",disabled:!0}),o.jsx("button",{className:"num-btn",onClick:()=>X("0"),disabled:v,children:"0"}),o.jsx("button",{className:"num-btn backspace",onClick:Z,disabled:v||d.length===0,children:""})]}),v&&o.jsx("div",{className:"entry-loading",children:o.jsx("div",{className:"spinner"})})]})}):o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx("button",{className:"entry-back",onClick:()=>n(null),children:""}),o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsx("p",{className:"entry-subtitle",children:"Enter company code"}),o.jsxs("div",{className:"entry-input-group",children:[o.jsx("input",{type:"text",value:s,onChange:F=>M(F.target.value),placeholder:"Company Code",disabled:v,autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&V()}}),o.jsx("button",{className:"entry-submit-btn",onClick:V,disabled:v||s.length<2,children:v?"...":""})]})]})});if(a==="office")return o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx("button",{className:"entry-back",onClick:()=>n(null),children:""}),o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsx("p",{className:"entry-subtitle",children:"Sign in to your account"}),o.jsxs("div",{className:"entry-form",children:[o.jsx("input",{type:"email",value:g,onChange:F=>b(F.target.value),placeholder:"Email",autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&re()}}),o.jsx("input",{type:"password",value:_,onChange:F=>w(F.target.value),placeholder:"Password",onKeyDown:F=>{F.key==="Enter"&&re()}}),o.jsx("button",{className:"entry-login-btn",onClick:re,children:"Sign In"})]}),o.jsxs("div",{className:"entry-signup-hint",children:[o.jsx("p",{children:"New employee?"}),o.jsx("button",{className:"entry-join-link",onClick:()=>n("join"),children:"Join your company"})]})]})});if(a==="join")return A===1?o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx("button",{className:"entry-back",onClick:()=>n("office"),children:""}),o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsx("p",{className:"entry-subtitle",children:"Enter your company code"}),o.jsx("p",{className:"entry-hint",children:"Ask your manager or admin for the code"}),o.jsxs("div",{className:"entry-input-group",children:[o.jsx("input",{type:"text",value:s,onChange:F=>M(F.target.value),placeholder:"Company Code",disabled:v,autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&de()}}),o.jsx("button",{className:"entry-submit-btn",onClick:de,disabled:v||s.length<2,children:v?"...":""})]})]})}):A===2?o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx("button",{className:"entry-back",onClick:()=>{C(1),R(null),W("")},children:""}),o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsx("div",{className:"entry-company-badge",children:E?.name}),o.jsx("p",{className:"entry-subtitle",children:"Enter office code"}),o.jsx("p",{className:"entry-hint",children:"This code is only for office staff"}),o.jsxs("div",{className:"entry-input-group",children:[o.jsx("input",{type:"password",value:Y,onChange:F=>W(F.target.value),placeholder:"Office Code",disabled:v,autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&U()}}),o.jsx("button",{className:"entry-submit-btn",onClick:U,disabled:v||!Y.trim(),children:v?"...":""})]})]})}):o.jsx("div",{className:"entry-container",children:o.jsxs("div",{className:"entry-card",children:[o.jsx("button",{className:"entry-back",onClick:()=>{C(2),W("")},children:""}),o.jsx(Nl,{className:"entry-logo",showPoweredBy:!1}),o.jsx("div",{className:"entry-company-badge",children:E?.name}),o.jsx("p",{className:"entry-subtitle",children:"Create your account"}),o.jsxs("div",{className:"entry-form",children:[o.jsx("input",{type:"text",value:B,onChange:F=>q(F.target.value),placeholder:"Your Name",autoFocus:!0}),o.jsx("input",{type:"email",value:L,onChange:F=>J(F.target.value),placeholder:"Email"}),o.jsx("input",{type:"password",value:D,onChange:F=>T(F.target.value),placeholder:"Password (6+ characters)",onKeyDown:F=>{F.key==="Enter"&&k()}}),o.jsx("button",{className:"entry-login-btn",onClick:k,disabled:v,children:v?"Creating...":"Join Company"})]}),o.jsx("p",{className:"entry-join-note",children:"You'll join as a team member. Your admin can update your role."})]})})}function Yn(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}function mx(t){if(!t||t.length===0)return 0;let e=0;return t.forEach(r=>{r.status==="done"&&(e+=r.weight)}),Math.round(e)}function Q4(t){if(!t||t.length===0)return"not_started";const e=t.some(n=>n.status==="working"),r=t.some(n=>n.status==="done");return t.every(n=>n.status==="done")?"done":e||r?"working":"not_started"}function HT(t){const e=Q4(t);return e==="done"?"Complete":e==="working"?"In Progress":"Not Started"}const aw=["Containment","PPE","Disposal","Equipment"];function $T({project:t,companyId:e,maxPhotos:r=10,onSubmit:a,onCancel:n,onShowToast:s}){const[l,c]=ne.useState(1),[f,d]=ne.useState(new Date().toISOString().split("T")[0]),[m,v]=ne.useState(""),[x,g]=ne.useState(""),[b,_]=ne.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}]),[w,A]=ne.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}]),[C,E]=ne.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}]),[R,Y]=ne.useState([]),[W,B]=ne.useState(""),[q,L]=ne.useState([]),[J,D]=ne.useState(!1),[T,M]=ne.useState(""),[V,ie]=ne.useState([]),[X,Z]=ne.useState(!1),[K,re]=ne.useState(null),[de,U]=ne.useState([]),[k,F]=ne.useState(!1),[I,z]=ne.useState(!1),[te,se]=ne.useState({name:"",category:"",quantity:""});ne.useEffect(()=>{pe()},[t.id]);const pe=async()=>{try{const Ce=await ot.getCrewCheckin(t.id);Ce?.workers&&ie(Ce.workers)}catch(Ce){console.error("Error loading crew:",Ce)}};ne.useEffect(()=>{K&&e&&ve(K)},[K,e]);const ve=async Ce=>{F(!0);try{const Ve=await ot.getMaterialsEquipmentByCategory(e,Ce);U(Ve)}catch(Ve){console.error("Error loading items:",Ve),s("Error loading items","error")}finally{F(!1)}},_e=()=>{_([...b,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}])},Pe=(Ce,Ve,ce)=>{_(b.map((Re,Me)=>Me===Ce?{...Re,[Ve]:ce}:Re))},fe=Ce=>{b.length>1?_(b.filter((Ve,ce)=>ce!==Ce)):_([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}])},st=()=>{E([...C,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},mt=(Ce,Ve,ce)=>{E(C.map((Re,Me)=>Me===Ce?{...Re,[Ve]:ce}:Re))},he=Ce=>{C.length>1?E(C.filter((Ve,ce)=>ce!==Ce)):E([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},at=()=>{A([...w,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},we=(Ce,Ve,ce)=>{A(w.map((Re,Me)=>Me===Ce?{...Re,[Ve]:ce}:Re))},ye=Ce=>{w.length>1?A(w.filter((Ve,ce)=>ce!==Ce)):A([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},Be=Ce=>{const Ve=R.findIndex(ce=>ce.material_equipment_id===Ce.id);Ve>=0?Y(R.map((ce,Re)=>Re===Ve?{...ce,quantity:ce.quantity+1}:ce)):Y([...R,{material_equipment_id:Ce.id,name:Ce.name,unit:Ce.unit,category:Ce.category,quantity:1,isCustom:!1}]),s(`Added ${Ce.name}`,"success")},Et=()=>{if(!te.name||!te.category||!te.quantity){s("Fill in all fields","error");return}Y([...R,{material_equipment_id:null,custom_name:te.name,custom_category:te.category,name:te.name,category:te.category,quantity:parseFloat(te.quantity),unit:"each",isCustom:!0}]),se({name:"",category:"",quantity:""}),z(!1),re(null),s("Custom item added","success")},Xe=(Ce,Ve)=>{const ce=parseFloat(Ve)||0;ce<=0?lt(Ce):Y(R.map((Re,Me)=>Me===Ce?{...Re,quantity:ce}:Re))},lt=Ce=>{Y(R.filter((Ve,ce)=>ce!==Ce))},jt=Ce=>{const Ve=Array.from(Ce.target.files);if(Ve.length===0)return;const ce=r===-1?1/0:r-q.length;if(ce<=0){s(`Photo limit reached (${r} max)`,"error"),Ce.target.value="";return}const Re=Ve.slice(0,ce);Re.length<Ve.length&&s(`Only ${Re.length} photo(s) added (${r} max)`,"error"),Re.forEach(Me=>{if(!Me.type.startsWith("image/")){s("Please select an image file","error");return}const Tt=URL.createObjectURL(Me);L($t=>[...$t,{id:Date.now()+Math.random(),file:Me,previewUrl:Tt,name:Me.name}])}),Ce.target.value=""},Dt=Ce=>{const Ve=q.find(ce=>ce.id===Ce);Ve?.previewUrl&&URL.revokeObjectURL(Ve.previewUrl),L(q.filter(ce=>ce.id!==Ce))},Wt=()=>{if(l===1){const Ce=b.some(Re=>Re.name.trim()&&(parseFloat(Re.hours)>0||parseFloat(Re.overtimeHours)>0)),Ve=w.some(Re=>Re.name.trim()&&(parseFloat(Re.hours)>0||parseFloat(Re.overtimeHours)>0)),ce=C.some(Re=>Re.name.trim()&&(parseFloat(Re.hours)>0||parseFloat(Re.overtimeHours)>0));return Ce||Ve||ce}return!0},et=()=>{l<3&&c(l+1)},ht=()=>{K?(re(null),z(!1)):I?z(!1):l>1?c(l-1):n()},yt=async()=>{if(!x.trim()){s("Enter your name to submit","error");return}const Ce=b.filter(Re=>Re.name.trim()&&(parseFloat(Re.hours)>0||parseFloat(Re.overtimeHours)>0)),Ve=w.filter(Re=>Re.name.trim()&&(parseFloat(Re.hours)>0||parseFloat(Re.overtimeHours)>0)),ce=C.filter(Re=>Re.name.trim()&&(parseFloat(Re.hours)>0||parseFloat(Re.overtimeHours)>0));if(Ce.length===0&&Ve.length===0&&ce.length===0){s("Add at least one worker","error");return}D(!0),M("Creating ticket...");try{const Re=await ot.createTMTicket({project_id:t.id,work_date:f,ce_pco_number:m.trim()||null,notes:W.trim()||null,photos:[],created_by_name:x.trim()});let Me=[];if(q.length>0){M(`Uploading ${q.length} photo${q.length>1?"s":""}...`);const $t=q.map(Ht=>ot.uploadPhoto(e,t.id,Re.id,Ht.file).catch(mr=>(console.error("Error uploading photo:",mr),null)));Me=(await Promise.all($t)).filter(Ht=>Ht!==null)}Me.length>0&&(M("Saving photos..."),await ot.updateTMTicketPhotos(Re.id,Me));const Tt=[...Ce.map($t=>({name:$t.name.trim(),hours:parseFloat($t.hours)||0,overtime_hours:parseFloat($t.overtimeHours)||0,time_started:$t.timeStarted||null,time_ended:$t.timeEnded||null,role:$t.role})),...Ve.map($t=>({name:$t.name.trim(),hours:parseFloat($t.hours)||0,overtime_hours:parseFloat($t.overtimeHours)||0,time_started:$t.timeStarted||null,time_ended:$t.timeEnded||null,role:"Operator"})),...ce.map($t=>({name:$t.name.trim(),hours:parseFloat($t.hours)||0,overtime_hours:parseFloat($t.overtimeHours)||0,time_started:$t.timeStarted||null,time_ended:$t.timeEnded||null,role:"Laborer"}))];M("Saving workers..."),await ot.addTMWorkers(Re.id,Tt),R.length>0&&(M("Saving materials..."),await ot.addTMItems(Re.id,R.map($t=>({material_equipment_id:$t.material_equipment_id,custom_name:$t.custom_name||null,custom_category:$t.custom_category||null,quantity:$t.quantity})))),q.forEach($t=>{$t.previewUrl&&URL.revokeObjectURL($t.previewUrl)}),s("T&M submitted!","success"),a()}catch(Re){console.error("Error submitting T&M:",Re),s("Error submitting T&M","error")}finally{D(!1),M("")}},ft=b.filter(Ce=>Ce.name.trim()&&(parseFloat(Ce.hours)>0||parseFloat(Ce.overtimeHours)>0)),pt=w.filter(Ce=>Ce.name.trim()&&(parseFloat(Ce.hours)>0||parseFloat(Ce.overtimeHours)>0)),wt=C.filter(Ce=>Ce.name.trim()&&(parseFloat(Ce.hours)>0||parseFloat(Ce.overtimeHours)>0)),Lt=ft.length+pt.length+wt.length,Pt=[...ft,...pt,...wt].reduce((Ce,Ve)=>Ce+parseFloat(Ve.hours||0),0),zt=[...ft,...pt,...wt].reduce((Ce,Ve)=>Ce+parseFloat(Ve.overtimeHours||0),0);return R.reduce((Ce,Ve)=>Ce+Ve.quantity,0),l===2&&(K||I)?o.jsxs("div",{className:"tm-wizard",children:[o.jsxs("div",{className:"tm-wizard-header",children:[o.jsx("button",{className:"tm-back-btn",onClick:ht,children:""}),o.jsx("h2",{children:I?"Add Custom Item":K}),o.jsxs("div",{className:"tm-item-count",children:[R.length," items"]})]}),I?o.jsxs("div",{className:"tm-custom-form",children:[o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Item Name"}),o.jsx("input",{type:"text",placeholder:"What did you use?",value:te.name,onChange:Ce=>se({...te,name:Ce.target.value}),autoFocus:!0})]}),o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Category"}),o.jsx("div",{className:"tm-category-select",children:aw.map(Ce=>o.jsx("button",{className:`tm-cat-chip ${te.category===Ce?"active":""}`,onClick:()=>se({...te,category:Ce}),children:Ce},Ce))})]}),o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Quantity"}),o.jsx("input",{type:"number",placeholder:"How many?",value:te.quantity,onChange:Ce=>se({...te,quantity:Ce.target.value})})]}),o.jsx("button",{className:"tm-big-btn primary",onClick:Et,children:"Add Custom Item"})]}):o.jsx("div",{className:"tm-item-grid",children:k?o.jsx("div",{className:"tm-loading",children:"Loading..."}):o.jsxs(o.Fragment,{children:[de.map(Ce=>{const Ve=R.find(ce=>ce.material_equipment_id===Ce.id);return o.jsxs("button",{className:`tm-item-card ${Ve?"added":""}`,onClick:()=>Be(Ce),children:[o.jsx("span",{className:"tm-item-name",children:Ce.name}),o.jsx("span",{className:"tm-item-unit",children:Ce.unit}),Ve&&o.jsx("span",{className:"tm-item-badge",children:Ve.quantity})]},Ce.id)}),o.jsxs("button",{className:"tm-item-card custom",onClick:()=>z(!0),children:[o.jsx("span",{className:"tm-item-name",children:"+ Add Other"}),o.jsx("span",{className:"tm-item-unit",children:"Not on list"})]})]})}),!I&&R.length>0&&o.jsx("div",{className:"tm-wizard-footer",children:o.jsxs("button",{className:"tm-big-btn primary",onClick:()=>re(null),children:["Done Adding (",R.length," items)"]})})]}):o.jsxs("div",{className:"tm-wizard",children:[o.jsxs("div",{className:"tm-wizard-header",children:[o.jsx("button",{className:"tm-back-btn",onClick:ht,children:""}),o.jsxs("h2",{children:[l===1&&"Workers",l===2&&"Materials & Equipment",l===3&&"Review"]}),o.jsxs("div",{className:"tm-step-dots",children:[o.jsx("span",{className:`tm-dot ${l>=1?"active":""}`}),o.jsx("span",{className:`tm-dot ${l>=2?"active":""}`}),o.jsx("span",{className:`tm-dot ${l>=3?"active":""}`})]})]}),l===1&&o.jsxs("div",{className:"tm-step-content",children:[o.jsxs("div",{className:"tm-project-info",children:[t.job_number&&o.jsxs("div",{className:"tm-project-detail",children:[o.jsx("span",{className:"tm-project-label",children:"Job #"}),o.jsx("span",{className:"tm-project-value",children:t.job_number})]}),o.jsxs("div",{className:"tm-project-detail",children:[o.jsx("span",{className:"tm-project-label",children:"Project"}),o.jsx("span",{className:"tm-project-value",children:t.name})]}),t.address&&o.jsxs("div",{className:"tm-project-detail",children:[o.jsx("span",{className:"tm-project-label",children:"Address"}),o.jsx("span",{className:"tm-project-value",children:t.address})]}),t.general_contractor&&o.jsxs("div",{className:"tm-project-detail",children:[o.jsx("span",{className:"tm-project-label",children:"GC"}),o.jsx("span",{className:"tm-project-value",children:t.general_contractor})]})]}),o.jsxs("div",{className:"tm-field-row",children:[o.jsxs("div",{className:"tm-field tm-field-half",children:[o.jsx("label",{children:"Date"}),o.jsx("input",{type:"date",value:f,onChange:Ce=>d(Ce.target.value),className:"tm-date"})]}),o.jsxs("div",{className:"tm-field tm-field-half",children:[o.jsx("label",{children:"CE / PCO #"}),o.jsx("input",{type:"text",placeholder:"Change Event / PCO",value:m,onChange:Ce=>v(Ce.target.value),className:"tm-input"})]})]}),V.length>0&&o.jsxs("div",{className:"tm-crew-picker",children:[o.jsxs("button",{className:"tm-crew-picker-btn",onClick:()=>Z(!X),children:[o.jsx(Ui,{size:16})," ",X?"Hide":"Select from"," Today's Crew (",V.length,")"]}),X&&o.jsx("div",{className:"tm-crew-list",children:V.map((Ce,Ve)=>{const ce=b.some(Re=>Re.name.toLowerCase()===Ce.name.toLowerCase())||w.some(Re=>Re.name.toLowerCase()===Ce.name.toLowerCase())||C.some(Re=>Re.name.toLowerCase()===Ce.name.toLowerCase());return o.jsxs("button",{className:`tm-crew-item ${ce?"added":""}`,onClick:()=>{if(!ce){if(Ce.role==="Foreman"||Ce.role==="Supervisor"){const Re=b.findIndex(Me=>!Me.name.trim());Re>=0?Pe(Re,"name",Ce.name):_([...b,{name:Ce.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:Ce.role==="Supervisor"?"Superintendent":"Foreman"}])}else if(Ce.role==="Operator"){const Re=w.findIndex(Me=>!Me.name.trim());Re>=0?we(Re,"name",Ce.name):A([...w,{name:Ce.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])}else{const Re=C.findIndex(Me=>!Me.name.trim());Re>=0?mt(Re,"name",Ce.name):E([...C,{name:Ce.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])}s(`Added ${Ce.name}`,"success")}},disabled:ce,children:[o.jsx("span",{className:"tm-crew-item-name",children:Ce.name}),o.jsx("span",{className:`tm-crew-item-role ${(Ce.role||"laborer").toLowerCase()}`,children:Ce.role||"Laborer"}),ce&&o.jsx("span",{className:"tm-crew-item-check",children:""})]},Ve)})})]}),o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Supervision"}),o.jsx("div",{className:"tm-workers-list",children:b.map((Ce,Ve)=>o.jsxs("div",{className:"tm-worker-card-expanded",children:[o.jsxs("div",{className:"tm-worker-row-top",children:[o.jsx("div",{className:"tm-role-select",children:o.jsxs("select",{value:Ce.role,onChange:ce=>Pe(Ve,"role",ce.target.value),children:[o.jsx("option",{value:"Foreman",children:"Foreman"}),o.jsx("option",{value:"Superintendent",children:"Superintendent"})]})}),o.jsx("input",{type:"text",placeholder:"First & Last Name",value:Ce.name,onChange:ce=>Pe(Ve,"name",ce.target.value),className:"tm-worker-input"}),o.jsx("button",{className:"tm-remove",onClick:()=>fe(Ve),children:""})]}),o.jsxs("div",{className:"tm-worker-row-bottom",children:[o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"Start"}),o.jsx("input",{type:"time",value:Ce.timeStarted,onChange:ce=>Pe(Ve,"timeStarted",ce.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"End"}),o.jsx("input",{type:"time",value:Ce.timeEnded,onChange:ce=>Pe(Ve,"timeEnded",ce.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"Reg Hrs"}),o.jsx("input",{type:"number",placeholder:"0",value:Ce.hours,onChange:ce=>Pe(Ve,"hours",ce.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"OT Hrs"}),o.jsx("input",{type:"number",placeholder:"0",value:Ce.overtimeHours,onChange:ce=>Pe(Ve,"overtimeHours",ce.target.value)})]})]})]},Ve))}),o.jsx("button",{className:"tm-add-btn",onClick:_e,children:"+ Add Supervision"})]}),o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Operators"}),o.jsx("div",{className:"tm-workers-list",children:w.map((Ce,Ve)=>o.jsxs("div",{className:"tm-worker-card-expanded",children:[o.jsxs("div",{className:"tm-worker-row-top",children:[o.jsx("input",{type:"text",placeholder:"First & Last Name",value:Ce.name,onChange:ce=>we(Ve,"name",ce.target.value),className:"tm-worker-input"}),o.jsx("button",{className:"tm-remove",onClick:()=>ye(Ve),children:""})]}),o.jsxs("div",{className:"tm-worker-row-bottom",children:[o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"Start"}),o.jsx("input",{type:"time",value:Ce.timeStarted,onChange:ce=>we(Ve,"timeStarted",ce.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"End"}),o.jsx("input",{type:"time",value:Ce.timeEnded,onChange:ce=>we(Ve,"timeEnded",ce.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"Reg Hrs"}),o.jsx("input",{type:"number",placeholder:"0",value:Ce.hours,onChange:ce=>we(Ve,"hours",ce.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"OT Hrs"}),o.jsx("input",{type:"number",placeholder:"0",value:Ce.overtimeHours,onChange:ce=>we(Ve,"overtimeHours",ce.target.value)})]})]})]},Ve))}),o.jsx("button",{className:"tm-add-btn",onClick:at,children:"+ Add Operator"})]}),o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Laborers"}),o.jsx("div",{className:"tm-workers-list",children:C.map((Ce,Ve)=>o.jsxs("div",{className:"tm-worker-card-expanded",children:[o.jsxs("div",{className:"tm-worker-row-top",children:[o.jsx("input",{type:"text",placeholder:"First & Last Name",value:Ce.name,onChange:ce=>mt(Ve,"name",ce.target.value),className:"tm-worker-input"}),o.jsx("button",{className:"tm-remove",onClick:()=>he(Ve),children:""})]}),o.jsxs("div",{className:"tm-worker-row-bottom",children:[o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"Start"}),o.jsx("input",{type:"time",value:Ce.timeStarted,onChange:ce=>mt(Ve,"timeStarted",ce.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"End"}),o.jsx("input",{type:"time",value:Ce.timeEnded,onChange:ce=>mt(Ve,"timeEnded",ce.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"Reg Hrs"}),o.jsx("input",{type:"number",placeholder:"0",value:Ce.hours,onChange:ce=>mt(Ve,"hours",ce.target.value)})]}),o.jsxs("div",{className:"tm-time-group",children:[o.jsx("label",{children:"OT Hrs"}),o.jsx("input",{type:"number",placeholder:"0",value:Ce.overtimeHours,onChange:ce=>mt(Ve,"overtimeHours",ce.target.value)})]})]})]},Ve))}),o.jsx("button",{className:"tm-add-btn",onClick:st,children:"+ Add Laborer"})]}),o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"Description of Work"}),o.jsx("textarea",{placeholder:"What work was performed today?",value:W,onChange:Ce=>B(Ce.target.value),rows:3,className:"tm-description"})]}),o.jsxs("div",{className:"tm-field",children:[o.jsxs("label",{children:[o.jsx(Op,{size:16,className:"inline-icon"})," Photos",r!==-1&&o.jsxs("span",{className:"tm-photo-count",children:["(",q.length,"/",r,")"]})]}),q.length>0&&o.jsx("div",{className:"tm-photo-grid",children:q.map(Ce=>o.jsxs("div",{className:"tm-photo-item",children:[o.jsx("img",{src:Ce.previewUrl,alt:Ce.name}),o.jsx("button",{className:"tm-photo-remove",onClick:()=>Dt(Ce.id),children:""})]},Ce.id))}),(r===-1||q.length<r)&&o.jsxs("label",{className:"tm-photo-btn",children:[o.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:jt,style:{display:"none"}}),o.jsx(Op,{size:16,className:"inline-icon"})," ",q.length>0?"Add More Photos":"Add Photos"]}),r!==-1&&q.length>=r&&o.jsxs("div",{className:"tm-photo-limit-reached",children:["Photo limit reached (",r," max)"]})]})]}),l===2&&!K&&o.jsxs("div",{className:"tm-step-content",children:[o.jsxs("div",{className:"tm-field",children:[o.jsx("label",{children:"What was used?"}),o.jsx("div",{className:"tm-category-grid",children:aw.map(Ce=>{const Ve=R.filter(ce=>ce.category===Ce);return o.jsxs("button",{className:"tm-category-card",onClick:()=>re(Ce),children:[o.jsx("span",{className:"tm-cat-name",children:Ce}),Ve.length>0&&o.jsx("span",{className:"tm-cat-count",children:Ve.length})]},Ce)})})]}),R.length>0&&o.jsxs("div",{className:"tm-field",children:[o.jsxs("label",{children:["Added Items (",R.length,")"]}),o.jsx("div",{className:"tm-added-list",children:R.map((Ce,Ve)=>o.jsxs("div",{className:"tm-added-item",children:[o.jsxs("div",{className:"tm-added-info",children:[Ce.isCustom&&o.jsx("span",{className:"tm-custom-badge",children:"Custom"}),o.jsx("span",{className:"tm-added-name",children:Ce.name})]}),o.jsxs("div",{className:"tm-added-qty",children:[o.jsx("button",{onClick:()=>Xe(Ve,Ce.quantity-1),children:""}),o.jsx("span",{children:Ce.quantity}),o.jsx("button",{onClick:()=>Xe(Ve,Ce.quantity+1),children:"+"})]})]},Ve))})]})]}),l===3&&o.jsxs("div",{className:"tm-step-content",children:[o.jsx("div",{className:"tm-review-section",children:o.jsxs("div",{className:"tm-review-header",children:[o.jsx("span",{children:" Date"}),o.jsx("span",{children:new Date(f).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})]})}),W&&o.jsxs("div",{className:"tm-review-section",children:[o.jsx("div",{className:"tm-review-header",children:o.jsxs("span",{children:[o.jsx(El,{size:16,className:"inline-icon"})," Description"]})}),o.jsx("div",{className:"tm-review-notes",children:W})]}),q.length>0&&o.jsxs("div",{className:"tm-review-section",children:[o.jsxs("div",{className:"tm-review-header",children:[o.jsxs("span",{children:[o.jsx(Op,{size:16,className:"inline-icon"})," Photos"]}),o.jsx("span",{children:q.length})]}),o.jsx("div",{className:"tm-review-photos",children:q.map(Ce=>o.jsx("img",{src:Ce.previewUrl,alt:Ce.name},Ce.id))})]}),ft.length>0&&o.jsxs("div",{className:"tm-review-section",children:[o.jsxs("div",{className:"tm-review-header",children:[o.jsxs("span",{children:[o.jsx(PT,{size:16,className:"inline-icon"})," Supervision"]}),o.jsxs("span",{children:[ft.reduce((Ce,Ve)=>Ce+parseFloat(Ve.hours||0)+parseFloat(Ve.overtimeHours||0),0)," hrs"]})]}),o.jsx("div",{className:"tm-review-list",children:ft.map((Ce,Ve)=>o.jsxs("div",{className:"tm-review-row-detailed",children:[o.jsxs("div",{className:"tm-review-worker-name",children:[o.jsx("span",{className:"tm-role-badge",children:Ce.role})," ",Ce.name]}),o.jsxs("div",{className:"tm-review-worker-details",children:[Ce.timeStarted&&Ce.timeEnded&&o.jsxs("span",{className:"tm-review-time",children:[Ce.timeStarted," - ",Ce.timeEnded]}),o.jsxs("span",{className:"tm-review-hours",children:[Ce.hours||0," reg",parseFloat(Ce.overtimeHours)>0?` + ${Ce.overtimeHours} OT`:""]})]})]},Ve))})]}),pt.length>0&&o.jsxs("div",{className:"tm-review-section",children:[o.jsxs("div",{className:"tm-review-header",children:[o.jsx("span",{children:" Operators"}),o.jsxs("span",{children:[pt.reduce((Ce,Ve)=>Ce+parseFloat(Ve.hours||0)+parseFloat(Ve.overtimeHours||0),0)," hrs"]})]}),o.jsx("div",{className:"tm-review-list",children:pt.map((Ce,Ve)=>o.jsxs("div",{className:"tm-review-row-detailed",children:[o.jsx("div",{className:"tm-review-worker-name",children:Ce.name}),o.jsxs("div",{className:"tm-review-worker-details",children:[Ce.timeStarted&&Ce.timeEnded&&o.jsxs("span",{className:"tm-review-time",children:[Ce.timeStarted," - ",Ce.timeEnded]}),o.jsxs("span",{className:"tm-review-hours",children:[Ce.hours||0," reg",parseFloat(Ce.overtimeHours)>0?` + ${Ce.overtimeHours} OT`:""]})]})]},Ve))})]}),wt.length>0&&o.jsxs("div",{className:"tm-review-section",children:[o.jsxs("div",{className:"tm-review-header",children:[o.jsxs("span",{children:[o.jsx(Ui,{size:16,className:"inline-icon"})," Laborers"]}),o.jsxs("span",{children:[wt.reduce((Ce,Ve)=>Ce+parseFloat(Ve.hours||0)+parseFloat(Ve.overtimeHours||0),0)," hrs"]})]}),o.jsx("div",{className:"tm-review-list",children:wt.map((Ce,Ve)=>o.jsxs("div",{className:"tm-review-row-detailed",children:[o.jsx("div",{className:"tm-review-worker-name",children:Ce.name}),o.jsxs("div",{className:"tm-review-worker-details",children:[Ce.timeStarted&&Ce.timeEnded&&o.jsxs("span",{className:"tm-review-time",children:[Ce.timeStarted," - ",Ce.timeEnded]}),o.jsxs("span",{className:"tm-review-hours",children:[Ce.hours||0," reg",parseFloat(Ce.overtimeHours)>0?` + ${Ce.overtimeHours} OT`:""]})]})]},Ve))})]}),R.length>0&&o.jsxs("div",{className:"tm-review-section",children:[o.jsxs("div",{className:"tm-review-header",children:[o.jsxs("span",{children:[o.jsx(t2,{size:16,className:"inline-icon"})," Materials & Equipment"]}),o.jsxs("span",{children:[R.length," items"]})]}),o.jsx("div",{className:"tm-review-list",children:R.map((Ce,Ve)=>o.jsxs("div",{className:"tm-review-row",children:[o.jsxs("span",{children:[Ce.isCustom&&o.jsxs(o.Fragment,{children:[o.jsx(qT,{size:14,className:"inline-icon"})," "]}),Ce.name]}),o.jsxs("span",{children:[Ce.quantity," ",Ce.unit]})]},Ve))})]}),o.jsxs("div",{className:"tm-review-section tm-certification",children:[o.jsx("div",{className:"tm-review-header",children:o.jsxs("span",{children:[o.jsx(e2,{size:16,className:"inline-icon"})," Submitted By"]})}),o.jsx("input",{type:"text",className:"tm-certification-input",placeholder:"Enter your name",value:x,onChange:Ce=>g(Ce.target.value)}),o.jsx("p",{className:"tm-certification-note",children:"By submitting, you certify this T&M is accurate."})]})]}),o.jsxs("div",{className:"tm-wizard-footer",children:[l<3?o.jsx("button",{className:"tm-big-btn primary",onClick:et,disabled:l===1&&!Wt(),children:l===1?`Next: Materials (${Lt} workers, ${Pt+zt} hrs)`:l===2?`Review (${R.length} items)`:"Next"}):o.jsx("button",{className:"tm-big-btn submit",onClick:yt,disabled:J,children:J?T||"Submitting...":" Submit T&M"}),l===2&&o.jsx("button",{className:"tm-skip-btn",onClick:et,children:"Skip (no materials)"})]})]})}function WT({project:t,onShowToast:e}){const[r,a]=ne.useState([]),[n,s]=ne.useState(!0),[l,c]=ne.useState(!1),[f,d]=ne.useState(!1),[m,v]=ne.useState({name:"",role:"Laborer"});ne.useEffect(()=>{x()},[t.id]);const x=async()=>{try{const w=await ot.getCrewCheckin(t.id);w?.workers&&a(w.workers)}catch(w){console.error("Error loading crew:",w)}finally{s(!1)}},g=async()=>{if(!m.name.trim()){e("Enter worker name","error");return}if(r.find(w=>w.name.toLowerCase()===m.name.trim().toLowerCase())){e("Worker already added","error");return}c(!0);try{const w=[...r,{name:m.name.trim(),role:m.role}];await ot.saveCrewCheckin(t.id,w),a(w),v({name:"",role:"Laborer"}),d(!1),e("Crew member added","success")}catch(w){console.error("Error adding worker:",w),e("Error adding crew member","error")}finally{c(!1)}},b=async w=>{c(!0);try{const A=r.filter(C=>C.name.toLowerCase()!==w.toLowerCase());await ot.saveCrewCheckin(t.id,A),a(A),e("Crew member removed","success")}catch(A){console.error("Error removing worker:",A),e("Error removing crew member","error")}finally{c(!1)}},_=new Date().toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"});return n?o.jsxs("div",{className:"crew-checkin",children:[o.jsxs("div",{className:"crew-header",children:[o.jsxs("h3",{children:[o.jsx(Ui,{size:18,className:"inline-icon"})," Today's Crew"]}),o.jsx("span",{className:"crew-date",children:_})]}),o.jsx("div",{className:"crew-loading",children:"Loading..."})]}):o.jsxs("div",{className:"crew-checkin",children:[o.jsxs("div",{className:"crew-header",children:[o.jsxs("h3",{children:[o.jsx(Ui,{size:18,className:"inline-icon"})," Today's Crew"]}),o.jsx("span",{className:"crew-date",children:_})]}),r.length===0?o.jsxs("div",{className:"crew-empty",children:[o.jsx("p",{children:"No crew checked in yet"}),o.jsx("p",{className:"crew-empty-hint",children:"Add your crew for the day"})]}):o.jsx("div",{className:"crew-list",children:r.map(w=>o.jsxs("div",{className:"crew-member",children:[o.jsxs("div",{className:"crew-member-info",children:[o.jsx("span",{className:"crew-member-name",children:w.name}),o.jsx("span",{className:`crew-member-role ${w.role.toLowerCase()}`,children:w.role})]}),o.jsx("button",{className:"crew-remove-btn",onClick:()=>b(w.name),disabled:l,children:""})]},w.name))}),f?o.jsxs("div",{className:"crew-add-form",children:[o.jsx("input",{type:"text",value:m.name,onChange:w=>v({...m,name:w.target.value}),placeholder:"Name",autoFocus:!0}),o.jsxs("select",{value:m.role,onChange:w=>v({...m,role:w.target.value}),children:[o.jsx("option",{value:"Foreman",children:"Foreman"}),o.jsx("option",{value:"Laborer",children:"Laborer"}),o.jsx("option",{value:"Supervisor",children:"Supervisor"}),o.jsx("option",{value:"Operator",children:"Operator"})]}),o.jsxs("div",{className:"crew-add-buttons",children:[o.jsx("button",{className:"crew-add-confirm",onClick:g,disabled:l,children:l?"...":"Add"}),o.jsx("button",{className:"crew-add-cancel",onClick:()=>{d(!1),v({name:"",role:"Laborer"})},children:"Cancel"})]})]}):o.jsx("button",{className:"crew-add-btn",onClick:()=>d(!0),children:"+ Add Crew Member"}),o.jsxs("div",{className:"crew-count",children:[r.length," ",r.length===1?"person":"people"," on site"]})]})}function VT({project:t,onShowToast:e,onClose:r}){const[a,n]=ne.useState(!0),[s,l]=ne.useState(!1),[c,f]=ne.useState(null),[d,m]=ne.useState(""),[v,x]=ne.useState("");ne.useEffect(()=>{g()},[t.id]);const g=async()=>{try{const A=await ot.getDailyReport(t.id);if(A)f(A),m(A.field_notes||""),x(A.issues||"");else{const C=await ot.compileDailyReport(t.id);f({...C,status:"draft"})}}catch(A){console.error("Error loading report:",A),e("Error loading report","error")}finally{n(!1)}},b=async()=>{if(!Ue){e("Demo Mode: Report saved locally only - won't reach office","info"),r();return}l(!0);try{await ot.saveDailyReport(t.id,{field_notes:d,issues:v}),await ot.submitDailyReport(t.id,"Field")?(e("Daily report submitted!","success"),r()):e("Report not sent - check connection","error")}catch(A){console.error("Error submitting report:",A),e("Error submitting report","error")}finally{l(!1)}},_=new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"});if(a)return o.jsxs("div",{className:"daily-report",children:[o.jsxs("div",{className:"daily-report-header",children:[o.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),o.jsx("h2",{children:"Daily Report"})]}),o.jsx("div",{className:"daily-report-loading",children:"Compiling report..."})]});const w=c?.status==="submitted";return o.jsxs("div",{className:"daily-report",children:[o.jsxs("div",{className:"daily-report-header",children:[o.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),o.jsxs("div",{children:[o.jsx("h2",{children:"Daily Report"}),o.jsx("p",{className:"daily-report-date",children:_})]})]}),w&&o.jsxs("div",{className:"daily-report-submitted-banner",children:[" Submitted ",new Date(c.submitted_at).toLocaleTimeString()]}),o.jsxs("div",{className:"daily-report-content",children:[o.jsxs("div",{className:"daily-report-summary",children:[o.jsxs("div",{className:"daily-report-card",children:[o.jsx("div",{className:"daily-report-card-value",children:c.crew_count||0}),o.jsx("div",{className:"daily-report-card-label",children:"Crew on Site"})]}),o.jsxs("div",{className:"daily-report-card",children:[o.jsx("div",{className:"daily-report-card-value",children:c.tasks_completed||0}),o.jsx("div",{className:"daily-report-card-label",children:"Tasks Done"})]}),o.jsxs("div",{className:"daily-report-card",children:[o.jsx("div",{className:"daily-report-card-value",children:c.tm_tickets_count||0}),o.jsx("div",{className:"daily-report-card-label",children:"T&M Tickets"})]}),o.jsxs("div",{className:"daily-report-card",children:[o.jsx("div",{className:"daily-report-card-value",children:c.photos_count||0}),o.jsx("div",{className:"daily-report-card-label",children:"Photos"})]})]}),c.crew_list?.length>0&&o.jsxs("div",{className:"daily-report-section",children:[o.jsxs("h3",{children:[o.jsx(Ui,{size:18,className:"inline-icon"})," Crew"]}),o.jsx("div",{className:"daily-report-crew",children:c.crew_list.map((A,C)=>o.jsxs("div",{className:"daily-report-crew-item",children:[o.jsx("span",{children:A.name}),o.jsx("span",{className:"daily-report-crew-role",children:A.role})]},C))})]}),c.completed_tasks?.length>0&&o.jsxs("div",{className:"daily-report-section",children:[o.jsxs("h3",{children:[o.jsx($d,{size:18,className:"inline-icon"})," Completed Today"]}),o.jsx("ul",{className:"daily-report-tasks",children:c.completed_tasks.map((A,C)=>o.jsxs("li",{children:[A.name,A.group&&o.jsx("span",{className:"daily-report-task-group",children:A.group})]},C))})]}),o.jsxs("div",{className:"daily-report-section",children:[o.jsxs("h3",{children:[o.jsx(El,{size:18,className:"inline-icon"})," Notes"]}),o.jsx("textarea",{value:d,onChange:A=>m(A.target.value),placeholder:"Any notes about today's work...",rows:3,disabled:w})]}),o.jsxs("div",{className:"daily-report-section",children:[o.jsxs("h3",{children:[o.jsx(h1,{size:18,className:"inline-icon"})," Issues / Concerns"]}),o.jsx("textarea",{value:v,onChange:A=>x(A.target.value),placeholder:"Any problems, delays, or concerns...",rows:3,disabled:w})]})]}),!w&&o.jsxs("div",{className:"daily-report-footer",children:[o.jsx("button",{className:"btn btn-primary daily-report-submit",onClick:b,disabled:s,children:s?"Submitting...":o.jsxs(o.Fragment,{children:[o.jsx(FT,{size:16,className:"inline-icon"})," Submit Report"]})}),o.jsx("p",{className:"daily-report-hint",children:"This will be sent to the office"})]})]})}function GT({project:t,viewerType:e,viewerName:r,onShowToast:a,onClose:n}){const[s,l]=ne.useState([]),[c,f]=ne.useState(!0),[d,m]=ne.useState(!1),[v,x]=ne.useState(""),g=ne.useRef(null);ne.useEffect(()=>{b(),ot.markMessagesRead(t.id,e)},[t.id]),ne.useEffect(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[s]);const b=async()=>{try{const C=await ot.getMessages(t.id);l(C.reverse())}catch(C){console.error("Error loading messages:",C)}finally{f(!1)}},_=async()=>{if(v.trim()){if(!Ue){a("Demo Mode: Messages won't sync to other users","info");const C={id:Date.now(),project_id:t.id,message:v.trim(),sender_type:e,sender_name:r,created_at:new Date().toISOString()};l([...s,C]),x("");return}m(!0);try{const C=await ot.sendMessage(t.id,v.trim(),e,r);C?(l([...s,C]),x("")):a("Message not sent - check connection","error")}catch(C){console.error("Error sending message:",C),a("Error sending message","error")}finally{m(!1)}}},w=C=>{C.key==="Enter"&&!C.shiftKey&&(C.preventDefault(),_())},A=C=>{const E=new Date(C),R=new Date;return E.toDateString()===R.toDateString()?E.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):E.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})};return o.jsxs("div",{className:"messages-container",children:[o.jsxs("div",{className:"messages-header",children:[o.jsx("button",{className:"back-btn-simple",onClick:n,children:""}),o.jsxs("div",{children:[o.jsx("h2",{children:"Messages"}),o.jsx("p",{className:"messages-project",children:t.name})]})]}),o.jsxs("div",{className:"messages-list",children:[c?o.jsx("div",{className:"messages-loading",children:"Loading..."}):s.length===0?o.jsxs("div",{className:"messages-empty",children:[o.jsx("p",{children:"No messages yet"}),o.jsx("p",{className:"messages-empty-hint",children:e==="field"?"Messages from the office will appear here":"Send a message to the field crew"})]}):s.map(C=>o.jsx("div",{className:`message ${C.sender_type===e?"sent":"received"}`,children:o.jsxs("div",{className:"message-bubble",children:[o.jsxs("div",{className:"message-sender",children:[C.sender_type==="office"?o.jsx(E0,{size:14,className:"inline-icon"}):o.jsx(Ui,{size:14,className:"inline-icon"})," ",C.sender_name]}),o.jsx("div",{className:"message-text",children:C.message}),C.photo_url&&o.jsx("img",{src:C.photo_url,alt:"Attached",className:"message-photo"}),o.jsx("div",{className:"message-time",children:A(C.created_at)})]})},C.id)),o.jsx("div",{ref:g})]}),o.jsxs("div",{className:"messages-input-container",children:[o.jsx("textarea",{value:v,onChange:C=>x(C.target.value),onKeyDown:w,placeholder:"Type a message...",rows:1,disabled:d}),o.jsx("button",{className:"messages-send-btn",onClick:_,disabled:d||!v.trim(),children:d?"...":""})]})]})}function YT({project:t,requestedBy:e,onShowToast:r,onClose:a}){const[n,s]=ne.useState([{name:"",quantity:"",unit:"each"}]),[l,c]=ne.useState(""),[f,d]=ne.useState("normal"),[m,v]=ne.useState(""),[x,g]=ne.useState(!1),b=()=>{s([...n,{name:"",quantity:"",unit:"each"}])},_=(C,E,R)=>{s(n.map((Y,W)=>W===C?{...Y,[E]:R}:Y))},w=C=>{n.length>1&&s(n.filter((E,R)=>R!==C))},A=async()=>{const C=n.filter(E=>E.name.trim()&&parseFloat(E.quantity)>0);if(C.length===0){r("Add at least one item with quantity","error");return}if(!Ue){r("Demo Mode: Request saved locally only - won't reach office","info"),a();return}g(!0);try{await ot.createMaterialRequest(t.id,C,e,l||null,f,m||null)?(r("Request submitted!","success"),a()):r("Request not sent - check connection","error")}catch(E){console.error("Error submitting request:",E),r("Error submitting request","error")}finally{g(!1)}};return o.jsxs("div",{className:"material-request",children:[o.jsxs("div",{className:"material-request-header",children:[o.jsx("button",{className:"back-btn-simple",onClick:a,children:""}),o.jsx("h2",{children:"Request Materials"})]}),o.jsxs("div",{className:"material-request-content",children:[o.jsxs("div",{className:"material-request-section",children:[o.jsx("label",{children:"What do you need?"}),n.map((C,E)=>o.jsxs("div",{className:"material-request-item",children:[o.jsx("input",{type:"text",placeholder:"Item name",value:C.name,onChange:R=>_(E,"name",R.target.value),className:"material-request-name"}),o.jsx("input",{type:"number",placeholder:"Qty",value:C.quantity,onChange:R=>_(E,"quantity",R.target.value),className:"material-request-qty"}),o.jsxs("select",{value:C.unit,onChange:R=>_(E,"unit",R.target.value),className:"material-request-unit",children:[o.jsx("option",{value:"each",children:"each"}),o.jsx("option",{value:"rolls",children:"rolls"}),o.jsx("option",{value:"boxes",children:"boxes"}),o.jsx("option",{value:"bags",children:"bags"}),o.jsx("option",{value:"sheets",children:"sheets"}),o.jsx("option",{value:"gallons",children:"gal"}),o.jsx("option",{value:"feet",children:"ft"}),o.jsx("option",{value:"lbs",children:"lbs"})]}),o.jsx("button",{className:"material-request-remove",onClick:()=>w(E),children:""})]},E)),o.jsx("button",{className:"material-request-add",onClick:b,children:"+ Add Another Item"})]}),o.jsxs("div",{className:"material-request-section",children:[o.jsx("label",{children:"Priority"}),o.jsx("div",{className:"material-request-priority",children:["low","normal","urgent"].map(C=>o.jsxs("button",{className:`priority-btn ${f===C?"active":""} ${C}`,onClick:()=>d(C),children:[C==="urgent"&&" ",C==="normal"&&" ",C==="low"&&" ",C.charAt(0).toUpperCase()+C.slice(1)]},C))})]}),o.jsxs("div",{className:"material-request-section",children:[o.jsx("label",{children:"Needed By (optional)"}),o.jsx("input",{type:"date",value:l,onChange:C=>c(C.target.value),min:new Date().toISOString().split("T")[0]})]}),o.jsxs("div",{className:"material-request-section",children:[o.jsx("label",{children:"Notes (optional)"}),o.jsx("textarea",{value:m,onChange:C=>v(C.target.value),placeholder:"Any additional details...",rows:2})]})]}),o.jsx("div",{className:"material-request-footer",children:o.jsx("button",{className:"btn btn-primary",onClick:A,disabled:x,children:x?"Submitting...":o.jsxs(o.Fragment,{children:[o.jsx(Af,{size:16,className:"inline-icon"})," Submit Request"]})})})]})}const XT=ne.createContext({}),e3=()=>ne.useContext(XT);function lu({message:t,type:e="",onClose:r}){return ne.useEffect(()=>{const a=setTimeout(r,3e3);return()=>clearTimeout(a)},[r]),o.jsx("div",{className:"toast-container",children:o.jsx("div",{className:`toast ${e}`,children:t})})}function t3({project:t,companyId:e,onClose:r,onReportCreated:a}){const{user:n}=e3(),[s,l]=ne.useState(!1),[c,f]=ne.useState(null),[d,m]=ne.useState(1),[v,x]=ne.useState(new Date().toISOString().split("T")[0]),[g,b]=ne.useState(new Date().toTimeString().split(" ")[0].substring(0,5)),[_,w]=ne.useState(""),[A,C]=ne.useState(""),[E,R]=ne.useState("minor"),[Y,W]=ne.useState(""),[B,q]=ne.useState(""),[L,J]=ne.useState(""),[D,T]=ne.useState(""),[M,V]=ne.useState(""),[ie,X]=ne.useState(""),[Z,K]=ne.useState(""),[re,de]=ne.useState(n?.name||""),[U,k]=ne.useState(""),[F,I]=ne.useState(""),[z,te]=ne.useState(n?.email||""),[se,pe]=ne.useState([]),[ve,_e]=ne.useState(""),[Pe,fe]=ne.useState(""),[st,mt]=ne.useState(""),[he,at]=ne.useState(""),[we,ye]=ne.useState(!1),[Be,Et]=ne.useState(""),[Xe,lt]=ne.useState(""),[jt,Dt]=ne.useState(!1),[Wt,et]=ne.useState(""),[ht,yt]=ne.useState(""),[ft,pt]=ne.useState(""),[wt,Lt]=ne.useState(""),[Pt,zt]=ne.useState(!1),[Ce,Ve]=ne.useState(!1),[ce,Re]=ne.useState(0),[Me,Tt]=ne.useState(0),$t=()=>{if(!ve.trim()){f({type:"error",message:"Please enter witness name"});return}const Ct={name:ve,phone:Pe,email:st,testimony:he};pe([...se,Ct]),_e(""),fe(""),mt(""),at(""),f({type:"success",message:"Witness added"})},or=Ct=>{pe(se.filter((Oa,ar)=>ar!==Ct))},Ht=Ct=>{switch(Ct){case 1:if(!_.trim()||!A.trim())return f({type:"error",message:"Please fill in all incident details"}),!1;break;case 2:if(!B.trim()||!ie.trim())return f({type:"error",message:"Please fill in employee name and job title"}),!1;break;case 3:if(!re.trim()||!U.trim())return f({type:"error",message:"Please fill in supervisor name and title"}),!1;break}return!0},mr=()=>{Ht(d)&&m(d+1)},Ca=()=>{m(d-1)},Na=async()=>{if(Ht(d)){if(!Ue){f({type:"info",message:"Demo Mode: Report saved locally only - won't reach office"}),setTimeout(()=>{r()},1500);return}l(!0);try{const Ct={project_id:t.id,company_id:e,incident_date:v,incident_time:g,incident_location:_,incident_description:A,injury_type:E,body_part_affected:Y||null,employee_name:B,employee_phone:L||null,employee_email:D||null,employee_address:M||null,employee_job_title:ie,employee_hire_date:Z||null,medical_treatment_required:we,medical_facility_name:Be||null,medical_facility_address:Xe||null,hospitalized:jt,reported_by_name:re,reported_by_title:U,reported_by_phone:F||null,reported_by_email:z||null,witnesses:se,immediate_actions_taken:Wt||null,corrective_actions_planned:ht||null,safety_equipment_used:ft||null,safety_equipment_failed:wt||null,osha_recordable:Pt,workers_comp_claim:Ce,days_away_from_work:parseInt(ce)||0,restricted_work_days:parseInt(Me)||0,status:"reported",created_by:n?.id},Oa=await ot.createInjuryReport(Ct);f({type:"success",message:"Injury report submitted successfully"}),a&&a(Oa),setTimeout(()=>{r()},1500)}catch(Ct){console.error("Error submitting injury report:",Ct),f({type:"error",message:"Failed to submit injury report"})}finally{l(!1)}}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"modal-overlay",onClick:r,children:o.jsxs("div",{className:"modal-content injury-report-modal",onClick:Ct=>Ct.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Workplace Injury/Incident Report"}),o.jsx("button",{className:"close-btn",onClick:r,children:""})]}),o.jsxs("div",{className:"progress-steps",children:[o.jsx("div",{className:`step ${d>=1?"active":""}`,children:"1. Incident"}),o.jsx("div",{className:`step ${d>=2?"active":""}`,children:"2. Employee"}),o.jsx("div",{className:`step ${d>=3?"active":""}`,children:"3. Supervisor"}),o.jsx("div",{className:`step ${d>=4?"active":""}`,children:"4. Witnesses"}),o.jsx("div",{className:`step ${d>=5?"active":""}`,children:"5. Medical & Safety"})]}),o.jsxs("div",{className:"modal-body",children:[d===1&&o.jsxs("div",{className:"form-step",children:[o.jsx("h3",{children:"Incident Details"}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Date of Incident *"}),o.jsx("input",{type:"date",value:v,onChange:Ct=>x(Ct.target.value),max:new Date().toISOString().split("T")[0]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Time of Incident *"}),o.jsx("input",{type:"time",value:g,onChange:Ct=>b(Ct.target.value)})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Location on Site *"}),o.jsx("input",{type:"text",value:_,onChange:Ct=>w(Ct.target.value),placeholder:"e.g., Floor 2, near elevator shaft"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Incident Description *"}),o.jsx("textarea",{value:A,onChange:Ct=>C(Ct.target.value),rows:4,placeholder:"Describe what happened in detail..."})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Injury Type *"}),o.jsxs("select",{value:E,onChange:Ct=>R(Ct.target.value),children:[o.jsx("option",{value:"minor",children:"Minor Injury"}),o.jsx("option",{value:"serious",children:"Serious Injury"}),o.jsx("option",{value:"critical",children:"Critical Injury"}),o.jsx("option",{value:"near_miss",children:"Near Miss (No Injury)"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Body Part Affected"}),o.jsx("input",{type:"text",value:Y,onChange:Ct=>W(Ct.target.value),placeholder:"e.g., Left hand, lower back"})]})]})]}),d===2&&o.jsxs("div",{className:"form-step",children:[o.jsx("h3",{children:"Injured Employee Information"}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Full Name *"}),o.jsx("input",{type:"text",value:B,onChange:Ct=>q(Ct.target.value),placeholder:"First and last name"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Phone Number"}),o.jsx("input",{type:"tel",value:L,onChange:Ct=>J(Ct.target.value),placeholder:"(555) 123-4567"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Email Address"}),o.jsx("input",{type:"email",value:D,onChange:Ct=>T(Ct.target.value),placeholder:"email@example.com"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Home Address"}),o.jsx("input",{type:"text",value:M,onChange:Ct=>V(Ct.target.value),placeholder:"Street address, city, state, zip"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Job Title *"}),o.jsx("input",{type:"text",value:ie,onChange:Ct=>X(Ct.target.value),placeholder:"e.g., Carpenter, Electrician"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Hire Date"}),o.jsx("input",{type:"date",value:Z,onChange:Ct=>K(Ct.target.value)})]})]})]}),d===3&&o.jsxs("div",{className:"form-step",children:[o.jsx("h3",{children:"Foreman/Supervisor Making Report"}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Your Name *"}),o.jsx("input",{type:"text",value:re,onChange:Ct=>de(Ct.target.value),placeholder:"Full name"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Your Title *"}),o.jsx("input",{type:"text",value:U,onChange:Ct=>k(Ct.target.value),placeholder:"e.g., Site Foreman, Project Manager"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Your Phone Number"}),o.jsx("input",{type:"tel",value:F,onChange:Ct=>I(Ct.target.value),placeholder:"(555) 123-4567"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Your Email Address"}),o.jsx("input",{type:"email",value:z,onChange:Ct=>te(Ct.target.value),placeholder:"email@example.com"})]})]}),d===4&&o.jsxs("div",{className:"form-step",children:[o.jsx("h3",{children:"Witness Testimonies (Optional)"}),se.length>0&&o.jsx("div",{className:"witnesses-list",children:se.map((Ct,Oa)=>o.jsxs("div",{className:"witness-item",children:[o.jsxs("div",{className:"witness-info",children:[o.jsx("strong",{children:Ct.name}),Ct.phone&&o.jsxs("span",{children:["  ",Ct.phone]}),Ct.testimony&&o.jsxs("p",{className:"witness-testimony",children:['"',Ct.testimony,'"']})]}),o.jsx("button",{className:"btn-danger btn-small",onClick:()=>or(Oa),children:"Remove"})]},Oa))}),o.jsxs("div",{className:"add-witness-form",children:[o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Witness Name"}),o.jsx("input",{type:"text",value:ve,onChange:Ct=>_e(Ct.target.value),placeholder:"Full name"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Phone Number"}),o.jsx("input",{type:"tel",value:Pe,onChange:Ct=>fe(Ct.target.value),placeholder:"(555) 123-4567"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Email Address"}),o.jsx("input",{type:"email",value:st,onChange:Ct=>mt(Ct.target.value),placeholder:"email@example.com"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Witness Testimony"}),o.jsx("textarea",{value:he,onChange:Ct=>at(Ct.target.value),rows:3,placeholder:"What did the witness see or hear?"})]}),o.jsx("button",{className:"btn-secondary",onClick:$t,children:"+ Add Witness"})]})]}),d===5&&o.jsxs("div",{className:"form-step",children:[o.jsx("h3",{children:"Medical Treatment & Safety"}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:we,onChange:Ct=>ye(Ct.target.checked)}),"Medical treatment required"]})}),we&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Medical Facility Name"}),o.jsx("input",{type:"text",value:Be,onChange:Ct=>Et(Ct.target.value),placeholder:"Hospital or clinic name"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Medical Facility Address"}),o.jsx("input",{type:"text",value:Xe,onChange:Ct=>lt(Ct.target.value),placeholder:"Street address"})]}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:jt,onChange:Ct=>Dt(Ct.target.checked)}),"Employee was hospitalized"]})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Immediate Actions Taken"}),o.jsx("textarea",{value:Wt,onChange:Ct=>et(Ct.target.value),rows:2,placeholder:"What was done immediately after the incident?"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Corrective Actions Planned"}),o.jsx("textarea",{value:ht,onChange:Ct=>yt(Ct.target.value),rows:2,placeholder:"What will be done to prevent this in the future?"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Safety Equipment Used"}),o.jsx("input",{type:"text",value:ft,onChange:Ct=>pt(Ct.target.value),placeholder:"e.g., Hard hat, gloves, harness"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Safety Equipment Failed"}),o.jsx("input",{type:"text",value:wt,onChange:Ct=>Lt(Ct.target.value),placeholder:"Equipment that failed, if any"})]})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Days Away From Work"}),o.jsx("input",{type:"number",min:"0",value:ce,onChange:Ct=>Re(Ct.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Restricted Work Days"}),o.jsx("input",{type:"number",min:"0",value:Me,onChange:Ct=>Tt(Ct.target.value)})]})]}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:Pt,onChange:Ct=>zt(Ct.target.checked)}),"OSHA Recordable Incident"]})}),o.jsx("div",{className:"form-group checkbox-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:Ce,onChange:Ct=>Ve(Ct.target.checked)}),"Workers' Compensation Claim Filed"]})})]})]}),o.jsx("div",{className:"modal-footer",children:o.jsxs("div",{className:"form-actions",children:[d>1&&o.jsx("button",{className:"btn-secondary",onClick:Ca,children:" Back"}),o.jsx("button",{className:"btn-secondary",onClick:r,children:"Cancel"}),d<5?o.jsx("button",{className:"btn-primary",onClick:mr,children:"Next "}):o.jsx("button",{className:"btn-primary",onClick:Na,disabled:s,children:s?"Submitting...":"Submit Report"})]})})]})}),c&&o.jsx(lu,{message:c.message,type:c.type,onClose:()=>f(null)}),o.jsx("style",{children:`
        .injury-report-modal {
          max-width: 800px;
          max-height: 90vh;
          overflow-y: auto;
        }

        .progress-steps {
          display: flex;
          justify-content: space-between;
          padding: 1rem 1.5rem;
          border-bottom: 1px solid #e5e7eb;
          background-color: #f9fafb;
          overflow-x: auto;
        }

        .progress-steps .step {
          font-size: 0.875rem;
          color: #9ca3af;
          font-weight: 500;
          white-space: nowrap;
          padding: 0.5rem;
        }

        .progress-steps .step.active {
          color: var(--primary-color, #3b82f6);
          font-weight: 600;
        }

        .form-step h3 {
          margin-top: 0;
          margin-bottom: 1.5rem;
          color: #111827;
          font-size: 1.25rem;
        }

        .form-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 500;
          color: #374151;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
          width: 100%;
          padding: 0.5rem;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          font-size: 1rem;
        }

        .form-group textarea {
          resize: vertical;
        }

        .checkbox-group label {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-weight: normal;
          cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
          width: auto;
          margin: 0;
        }

        .witnesses-list {
          margin-bottom: 1.5rem;
        }

        .witness-item {
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          padding: 1rem;
          margin-bottom: 0.5rem;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
        }

        .witness-info {
          flex: 1;
        }

        .witness-testimony {
          margin-top: 0.5rem;
          color: #6b7280;
          font-style: italic;
          font-size: 0.875rem;
        }

        .add-witness-form {
          border: 2px dashed #d1d5db;
          border-radius: 6px;
          padding: 1rem;
          background-color: #f9fafb;
        }

        .modal-footer {
          border-top: 1px solid #e5e7eb;
          padding: 1rem 1.5rem;
        }

        .form-actions {
          display: flex;
          justify-content: space-between;
          gap: 0.5rem;
        }

        .btn-primary,
        .btn-secondary,
        .btn-danger {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          opacity: 0.9;
        }

        .btn-primary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-secondary {
          background-color: #f3f4f6;
          color: #374151;
        }

        .btn-secondary:hover {
          background-color: #e5e7eb;
        }

        .btn-danger {
          background-color: #ef4444;
          color: white;
        }

        .btn-danger:hover {
          background-color: #dc2626;
        }

        .btn-small {
          padding: 0.25rem 0.75rem;
          font-size: 0.875rem;
        }

        @media (max-width: 768px) {
          .injury-report-modal {
            max-width: 100%;
            height: 100vh;
            max-height: 100vh;
            border-radius: 0;
          }

          .form-row {
            grid-template-columns: 1fr;
          }

          .progress-steps .step {
            font-size: 0.75rem;
            padding: 0.25rem;
          }
        }
      `})]})}const nw=[{id:"trash",label:"Trash",description:"General debris"},{id:"metal",label:"Metal",description:"Scrap metal (recyclable)"},{id:"copper",label:"Copper",description:"Copper scrap (recyclable)"},{id:"concrete",label:"Concrete",description:"Concrete/masonry"},{id:"hazardous",label:"Hazardous",description:"Hazardous materials"}];function KT({project:t,companyId:e,onClose:r,onSubmit:a,onShowToast:n}){const[s,l]=ne.useState(!1),[c,f]=ne.useState([]),[d,m]=ne.useState(!0),[v,x]=ne.useState(new Date().toISOString().split("T")[0]),[g,b]=ne.useState("trash"),[_,w]=ne.useState(1),[A,C]=ne.useState(""),[E,R]=ne.useState(t.default_dump_site_id||""),[Y,W]=ne.useState(""),[B,q]=ne.useState(null),[L,J]=ne.useState(null);ne.useEffect(()=>{D()},[e]),ne.useEffect(()=>{T()},[E,g,_,c]);const D=async()=>{try{const Z=await ot.getDumpSites(e);f(Z||[]),t.default_dump_site_id?R(t.default_dump_site_id):Z&&Z.length>0&&R(Z[0].id)}catch(Z){console.error("Error loading dump sites:",Z)}finally{m(!1)}},T=()=>{if(!E||!g||!_){q(null),J(null);return}const Z=c.find(re=>re.id===E);if(!Z||!Z.dump_site_rates){q(null),J(null);return}const K=Z.dump_site_rates.find(re=>re.waste_type===g);if(K&&K.estimated_cost_per_load!==null){const re=parseFloat(K.estimated_cost_per_load);J(re),q(re*parseInt(_))}else q(null),J(null)},M=Z=>Z==null?"--":Z<0?`-$${Math.abs(Z).toFixed(0)}`:`$${Z.toFixed(0)}`,V=async Z=>{if(Z.preventDefault(),!E){n("Please select a dump site","error");return}if(!_||_<1){n("Please enter number of loads","error");return}l(!0);try{await ot.createHaulOff(t.id,{dump_site_id:E,waste_type:g,loads:parseInt(_),hauling_company:A.trim()||null,work_date:v,notes:Y.trim()||null,estimated_cost:B,created_by:"Field"}),n("Haul-off logged successfully","success"),a&&a(),r()}catch(K){console.error("Error logging haul-off:",K),n("Error logging haul-off","error")}finally{l(!1)}},ie=c.find(Z=>Z.id===E),X=nw.find(Z=>Z.id===g);return o.jsxs("div",{className:"hauloff-form-container",children:[o.jsxs("div",{className:"hauloff-header",children:[o.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),o.jsx("h2",{children:"Log Haul-Off"})]}),o.jsxs("form",{onSubmit:V,className:"hauloff-form",children:[o.jsxs("div",{className:"hauloff-field",children:[o.jsx("label",{children:"Date"}),o.jsx("input",{type:"date",value:v,onChange:Z=>x(Z.target.value),max:new Date().toISOString().split("T")[0]})]}),o.jsxs("div",{className:"hauloff-field",children:[o.jsx("label",{children:"Waste Type"}),o.jsx("div",{className:"waste-type-grid",children:nw.map(Z=>o.jsxs("button",{type:"button",className:`waste-type-btn ${g===Z.id?"active":""} ${Z.id==="metal"||Z.id==="copper"?"recyclable":""}`,onClick:()=>b(Z.id),children:[o.jsx("span",{className:"waste-label",children:Z.label}),(Z.id==="metal"||Z.id==="copper")&&o.jsx("span",{className:"waste-badge",children:"$"})]},Z.id))})]}),o.jsxs("div",{className:"hauloff-field",children:[o.jsx("label",{children:"Number of Loads"}),o.jsxs("div",{className:"loads-input-row",children:[o.jsx("button",{type:"button",className:"loads-btn",onClick:()=>w(Math.max(1,_-1)),children:""}),o.jsx("input",{type:"number",value:_,onChange:Z=>w(Math.max(1,parseInt(Z.target.value)||1)),min:"1",className:"loads-input"}),o.jsx("button",{type:"button",className:"loads-btn",onClick:()=>w(_+1),children:"+"})]})]}),o.jsxs("div",{className:"hauloff-field",children:[o.jsx("label",{children:"Dump Site"}),d?o.jsx("div",{className:"loading-inline",children:"Loading sites..."}):c.length===0?o.jsx("div",{className:"no-sites-warning",children:"No dump sites configured. Ask office to add dump sites."}):o.jsxs("select",{value:E,onChange:Z=>R(Z.target.value),children:[o.jsx("option",{value:"",children:"-- Select Dump Site --"}),c.map(Z=>o.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),ie?.address&&o.jsx("span",{className:"field-hint",children:ie.address})]}),o.jsxs("div",{className:"hauloff-field",children:[o.jsx("label",{children:"Hauling Company (Optional)"}),o.jsx("input",{type:"text",value:A,onChange:Z=>C(Z.target.value),placeholder:"e.g., ABC Trucking"})]}),o.jsxs("div",{className:"hauloff-field",children:[o.jsx("label",{children:"Notes (Optional)"}),o.jsx("textarea",{value:Y,onChange:Z=>W(Z.target.value),placeholder:"Any additional notes...",rows:2})]}),o.jsxs("div",{className:"hauloff-estimate",children:[o.jsx("div",{className:"estimate-header",children:"Estimated Cost"}),B!==null?o.jsxs("div",{className:`estimate-value ${B<0?"revenue":""}`,children:[o.jsx("span",{className:"estimate-amount",children:M(B)}),o.jsxs("span",{className:"estimate-breakdown",children:[M(L),"/load  ",_," load",_>1?"s":""]}),B<0&&o.jsx("span",{className:"estimate-note revenue-note",children:"Revenue from recyclables"})]}):o.jsxs("div",{className:"estimate-value",children:[o.jsx("span",{className:"estimate-amount",children:"--"}),o.jsx("span",{className:"estimate-breakdown",children:E?ie?.dump_site_rates?.find(Z=>Z.waste_type===g)?"Unable to calculate":`No rate set for ${X?.label||g}`:"Select a dump site"})]}),o.jsx("div",{className:"estimate-disclaimer",children:"This is an estimate for burn rate tracking, not an invoice amount."})]}),o.jsxs("div",{className:"hauloff-actions",children:[o.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,disabled:s,children:"Cancel"}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:s||!E,children:s?"Saving...":"Log Haul-Off"})]})]})]})}function JT({project:t,companyId:e,onShowToast:r,onExit:a}){const[n,s]=ne.useState([]),[l,c]=ne.useState(!0),[f,d]=ne.useState(null),[m,v]=ne.useState({}),[x,g]=ne.useState(!1),[b,_]=ne.useState(!0),[w,A]=ne.useState(!1),[C,E]=ne.useState(!1),[R,Y]=ne.useState(!1),[W,B]=ne.useState(!1),[q,L]=ne.useState(!1),[J,D]=ne.useState(!1),[T,M]=ne.useState(0);ne.useEffect(()=>{V(),ie()},[t.id]);const V=async()=>{try{const z=await ot.getAreas(t.id);s(z);const te=[...new Set(z.map(pe=>pe.group_name||"General"))],se={};te.forEach(pe=>se[pe]=!1),v(se)}catch(z){console.error("Error loading areas:",z),r("Error loading areas","error")}finally{c(!1)}},ie=async()=>{const z=await ot.getUnreadCount(t.id,"field");M(z)},X=async(z,te)=>{const se=n.find(ve=>ve.id===z);if(!se)return;const pe=se.status===te?"not_started":te;d(z);try{await ot.updateAreaStatus(z,pe),s(ve=>ve.map(_e=>_e.id===z?{..._e,status:pe}:_e)),r("Updated","success")}catch(ve){console.error("Error updating status:",ve),r("Error updating","error")}finally{d(null)}},Z=z=>{v(te=>({...te,[z]:!te[z]}))};if(l)return o.jsx("div",{className:"foreman-container",children:o.jsxs("div",{className:"loading",children:[o.jsx("div",{className:"spinner"}),"Loading..."]})});if(x)return o.jsx("div",{className:"foreman-container",children:o.jsx($T,{project:t,companyId:e,onSubmit:()=>g(!1),onCancel:()=>g(!1),onShowToast:r})});if(w)return o.jsx(VT,{project:t,onShowToast:r,onClose:()=>A(!1)});if(C)return o.jsx(GT,{project:t,viewerType:"field",viewerName:"Field",onShowToast:r,onClose:()=>{E(!1),ie()}});if(R)return o.jsx(YT,{project:t,requestedBy:"Field",onShowToast:r,onClose:()=>Y(!1)});if(W)return o.jsx("div",{className:"foreman-container",children:o.jsx(t3,{project:t,companyId:e,onClose:()=>B(!1),onReportCreated:()=>{B(!1),r("Injury report submitted","success")}})});if(q)return o.jsx("div",{className:"foreman-container",children:o.jsx(KT,{project:t,companyId:e,onClose:()=>L(!1),onSubmit:()=>L(!1),onShowToast:r})});const K=mx(n),re=n.reduce((z,te)=>{const se=te.group_name||"General";return z[se]||(z[se]=[]),z[se].push(te),z},{}),de=Object.keys(re).length>1||Object.keys(re).length===1&&!re.General,U=z=>`${z.filter(se=>se.status==="done").length}/${z.length}`,k=n.filter(z=>z.status==="done").length,F=n.filter(z=>z.status==="working").length,I=n.length-k;return o.jsxs("div",{className:"foreman-container",children:[o.jsxs("div",{className:"foreman-header",children:[o.jsx("button",{className:"back-btn-simple",onClick:a,children:""}),o.jsxs("div",{className:"foreman-header-info",children:[o.jsx("div",{className:"foreman-project-name",children:t.name}),o.jsxs("div",{className:"foreman-progress",children:[K,"% Complete"]})]}),o.jsx("button",{className:"foreman-info-btn",onClick:()=>D(!J),children:o.jsx(V4,{size:20})})]}),J&&o.jsxs("div",{className:"foreman-project-info",children:[t.job_number&&o.jsxs("div",{className:"foreman-info-row",children:[o.jsx("span",{className:"foreman-info-label",children:"Job #"}),o.jsx("span",{className:"foreman-info-value",children:t.job_number})]}),t.address&&o.jsxs("div",{className:"foreman-info-row",children:[o.jsx("span",{className:"foreman-info-label",children:"Address"}),o.jsx("span",{className:"foreman-info-value",children:t.address})]}),t.general_contractor&&o.jsxs("div",{className:"foreman-info-row",children:[o.jsx("span",{className:"foreman-info-label",children:"GC / Client"}),o.jsx("span",{className:"foreman-info-value",children:t.general_contractor})]}),t.client_contact&&o.jsxs("div",{className:"foreman-info-row",children:[o.jsx("span",{className:"foreman-info-label",children:"Contact"}),o.jsx("span",{className:"foreman-info-value",children:t.client_contact})]}),t.client_phone&&o.jsxs("div",{className:"foreman-info-row",children:[o.jsx("span",{className:"foreman-info-label",children:"Phone"}),o.jsx("a",{href:`tel:${t.client_phone}`,className:"foreman-info-value foreman-info-link",children:t.client_phone})]})]}),o.jsxs("div",{className:"foreman-stats",children:[o.jsxs("div",{className:"foreman-stat",children:[o.jsx("div",{className:"foreman-stat-value working",children:F}),o.jsx("div",{className:"foreman-stat-label",children:"Working"})]}),o.jsxs("div",{className:"foreman-stat",children:[o.jsx("div",{className:"foreman-stat-value done",children:k}),o.jsx("div",{className:"foreman-stat-label",children:"Done"})]}),o.jsxs("div",{className:"foreman-stat",children:[o.jsx("div",{className:"foreman-stat-value remaining",children:I}),o.jsx("div",{className:"foreman-stat-label",children:"Remaining"})]})]}),o.jsxs("div",{className:"field-actions",children:[o.jsxs("button",{className:"field-action-btn",onClick:()=>g(!0),children:[o.jsx(El,{size:20,className:"icon"}),"T&M Ticket"]}),o.jsxs("button",{className:"field-action-btn",onClick:()=>E(!0),children:[o.jsx(Y0,{size:20,className:"icon"}),"Messages",T>0&&o.jsx("span",{className:"badge",children:T})]}),o.jsxs("button",{className:"field-action-btn",onClick:()=>Y(!0),children:[o.jsx(Af,{size:20,className:"icon"}),"Materials"]}),o.jsxs("button",{className:"field-action-btn",onClick:()=>A(!0),children:[o.jsx(hu,{size:20,className:"icon"}),"Daily Report"]}),o.jsxs("button",{className:"field-action-btn",onClick:()=>L(!0),children:[o.jsx(m1,{size:20,className:"icon"}),"Haul-Off"]}),o.jsxs("button",{className:"field-action-btn danger",onClick:()=>B(!0),children:[o.jsx(h1,{size:20,className:"icon"}),"Report Injury"]})]}),o.jsx(WT,{project:t,onShowToast:r}),o.jsx("div",{className:"foreman-areas",children:de?Object.entries(re).map(([z,te])=>o.jsxs("div",{className:"foreman-group",children:[o.jsxs("div",{className:"foreman-group-header",onClick:()=>Z(z),children:[o.jsxs("div",{className:"foreman-group-title",children:[o.jsx("span",{className:"foreman-group-arrow",children:m[z]?"":""}),o.jsx("span",{className:"foreman-group-name",children:z})]}),o.jsx("span",{className:"foreman-group-progress",children:U(te)})]}),m[z]&&o.jsx("div",{className:"foreman-group-tasks",children:te.map(se=>o.jsxs("div",{className:`foreman-area-card ${se.status}`,children:[o.jsx("div",{className:"foreman-area-name",children:se.name}),o.jsxs("div",{className:"foreman-area-buttons",children:[o.jsx("button",{className:`foreman-btn working ${se.status==="working"?"active":""}`,onClick:()=>X(se.id,"working"),disabled:f===se.id,children:f===se.id?"...":"Working"}),o.jsx("button",{className:`foreman-btn done ${se.status==="done"?"active":""}`,onClick:()=>X(se.id,"done"),disabled:f===se.id,children:f===se.id?"...":"Done"})]})]},se.id))})]},z)):n.map(z=>o.jsxs("div",{className:`foreman-area-card ${z.status}`,children:[o.jsx("div",{className:"foreman-area-name",children:z.name}),o.jsxs("div",{className:"foreman-area-buttons",children:[o.jsx("button",{className:`foreman-btn working ${z.status==="working"?"active":""}`,onClick:()=>X(z.id,"working"),disabled:f===z.id,children:f===z.id?"...":"Working"}),o.jsx("button",{className:`foreman-btn done ${z.status==="done"?"active":""}`,onClick:()=>X(z.id,"done"),disabled:f===z.id,children:f===z.id?"...":"Done"})]})]},z.id))}),n.length===0&&o.jsxs("div",{className:"foreman-empty",children:[o.jsx(hu,{size:48,className:"foreman-empty-icon"}),o.jsx("div",{className:"foreman-empty-text",children:"No areas yet"}),o.jsx("div",{className:"foreman-empty-subtext",children:"Office needs to add areas to this project"})]})]})}const sw=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never";function r3({documentType:t,documentId:e,companyId:r,projectId:a,documentTitle:n="",onClose:s,onShowToast:l}){const[c,f]=ne.useState(!0),[d,m]=ne.useState(!1),[v,x]=ne.useState([]),[g,b]=ne.useState(null),[_,w]=ne.useState(!1),[A,C]=ne.useState("never");ne.useEffect(()=>{E()},[t,e]);const E=async()=>{try{f(!0);const L=await ot.getSignatureRequestsForDocument(t,e);x(L||[])}catch(L){console.error("Error loading signature requests:",L)}finally{f(!1)}},R=async()=>{try{m(!0);let L=null;if(A!=="never"){const D=parseInt(A);L=new Date,L.setDate(L.getDate()+D),L=L.toISOString()}const J=await ot.createSignatureRequest(t,e,r,a,null,L);if(J){const D=`${window.location.origin}/sign/${J.signature_token}`;b(D),await E(),l?.("Signature link created","success")}}catch(L){console.error("Error generating signature link:",L),l?.("Failed to create signature link","error")}finally{m(!1)}},Y=async L=>{try{await navigator.clipboard.writeText(L),w(!0),l?.("Link copied to clipboard","success"),setTimeout(()=>w(!1),2e3)}catch(J){console.error("Error copying to clipboard:",J)}},W=async L=>{if(confirm("Are you sure you want to revoke this signature link? It will no longer be usable."))try{await ot.revokeSignatureRequest(L),await E(),l?.("Signature link revoked","success")}catch(J){console.error("Error revoking signature request:",J),l?.("Failed to revoke link","error")}},B=L=>{switch(L){case"pending":return{label:"Awaiting Signatures",color:"#f59e0b",bg:"#fef3c7"};case"partially_signed":return{label:"1 of 2 Signed",color:"#3b82f6",bg:"#dbeafe"};case"completed":return{label:"Fully Signed",color:"#10b981",bg:"#d1fae5"};case"revoked":return{label:"Revoked",color:"#ef4444",bg:"#fee2e2"};case"expired":return{label:"Expired",color:"#6b7280",bg:"#f3f4f6"};default:return{label:L,color:"#6b7280",bg:"#f3f4f6"}}},q=t==="cor"?"Change Order":"T&M Ticket";return o.jsx("div",{className:"modal-overlay",onClick:s,role:"dialog","aria-modal":"true",children:o.jsxs("div",{className:"modal-content signature-link-modal",onClick:L=>L.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{children:[o.jsx("h2",{children:"Get Signature Link"}),n&&o.jsx("span",{className:"modal-subtitle",children:n})]}),o.jsx("button",{className:"close-btn",onClick:s,"aria-label":"Close",children:o.jsx(fh,{size:20})})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"signature-link-section",children:[o.jsxs("h3",{children:[o.jsx(Qx,{size:16}),"Create New Signature Link"]}),o.jsxs("p",{className:"section-description",children:["Generate a secure link that allows GC/Client to sign this ",q," without logging in."]}),o.jsxs("div",{className:"link-options",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Link Expiration"}),o.jsxs("select",{value:A,onChange:L=>C(L.target.value),disabled:d,children:[o.jsx("option",{value:"never",children:"Never expires"}),o.jsx("option",{value:"7",children:"7 days"}),o.jsx("option",{value:"30",children:"30 days"}),o.jsx("option",{value:"90",children:"90 days"})]})]}),o.jsx("button",{className:"btn btn-primary",onClick:R,disabled:d,children:d?"Generating...":"Generate Link"})]}),g&&o.jsxs("div",{className:"new-link-box",children:[o.jsxs("div",{className:"link-display",children:[o.jsx("input",{type:"text",value:g,readOnly:!0,className:"link-input"}),o.jsxs("button",{className:"btn btn-secondary copy-btn",onClick:()=>Y(g),children:[_?o.jsx(A0,{size:16}):o.jsx(ew,{size:16}),_?"Copied!":"Copy"]})]}),o.jsxs("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"preview-link",children:[o.jsx(tw,{size:14}),"Preview link"]})]})]}),o.jsxs("div",{className:"signature-link-section",children:[o.jsxs("h3",{children:[o.jsx(Hp,{size:16}),"Existing Signature Links"]}),c?o.jsx("div",{className:"loading-inline",children:"Loading..."}):v.length===0?o.jsxs("p",{className:"empty-state",children:["No signature links have been created for this ",q,"."]}):o.jsx("div",{className:"existing-links-list",children:v.map(L=>{const J=B(L.status),D=`${window.location.origin}/sign/${L.signature_token}`,T=L.signatures?.length||0;return o.jsxs("div",{className:"existing-link-card",children:[o.jsxs("div",{className:"link-card-header",children:[o.jsx("span",{className:"status-badge",style:{color:J.color,backgroundColor:J.bg},children:J.label}),o.jsxs("span",{className:"link-created",children:["Created ",sw(L.created_at)]})]}),o.jsxs("div",{className:"link-card-body",children:[o.jsxs("div",{className:"link-info",children:[o.jsxs("span",{className:"link-token",children:["...",L.signature_token.slice(-8)]}),L.expires_at&&o.jsxs("span",{className:"link-expires",children:["Expires ",sw(L.expires_at)]}),o.jsxs("span",{className:"link-views",children:[L.view_count," view",L.view_count!==1?"s":""]})]}),T>0&&o.jsx("div",{className:"signatures-summary",children:L.signatures.map(M=>o.jsxs("div",{className:"sig-item",children:[o.jsx(A0,{size:12}),o.jsxs("span",{children:["Slot ",M.signature_slot,": ",M.signer_name,M.signer_company&&` (${M.signer_company})`]})]},M.id))})]}),o.jsxs("div",{className:"link-card-actions",children:[L.status!=="revoked"&&L.status!=="expired"&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{className:"btn btn-ghost btn-small",onClick:()=>Y(D),children:[o.jsx(ew,{size:14})," Copy"]}),o.jsxs("a",{href:D,target:"_blank",rel:"noopener noreferrer",className:"btn btn-ghost btn-small",children:[o.jsx(tw,{size:14})," Open"]})]}),L.status!=="completed"&&L.status!=="revoked"&&o.jsxs("button",{className:"btn btn-ghost btn-small btn-danger",onClick:()=>W(L.id),children:[o.jsx(cu,{size:14})," Revoke"]})]})]},L.id)})})]}),o.jsxs("div",{className:"signature-info-box",children:[o.jsx(G0,{size:16}),o.jsxs("div",{children:[o.jsx("strong",{children:"How it works:"}),o.jsxs("ul",{children:[o.jsx("li",{children:"Share the link with your GC or Client"}),o.jsx("li",{children:"They can view the document and sign without logging in"}),o.jsx("li",{children:"Supports 2 signatures (GC + Client)"}),o.jsx("li",{children:"Signatures are recorded with name, title, company, date, and IP"})]})]})]})]}),o.jsx("div",{className:"modal-footer",children:o.jsx("button",{className:"btn btn-secondary",onClick:s,children:"Close"})})]})})}var Wp={};Wp.version="0.18.5";var a3=1252,ZT=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],r2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},a2=function(t){ZT.indexOf(t)!=-1&&(a3=r2[0]=t)};function QT(){a2(1252)}var Vo=function(t){a2(t)};function n2(){Vo(1200),QT()}function iw(t){for(var e=[],r=0,a=t.length;r<a;++r)e[r]=t.charCodeAt(r);return e}function e8(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function n3(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var i0=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?e8(t.slice(2)):e==254&&r==255?n3(t.slice(2)):e==65279?t.slice(1):t},lp=function(e){return String.fromCharCode(e)},ow=function(e){return String.fromCharCode(e)},C0,uu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function T0(t){for(var e="",r=0,a=0,n=0,s=0,l=0,c=0,f=0,d=0;d<t.length;)r=t.charCodeAt(d++),s=r>>2,a=t.charCodeAt(d++),l=(r&3)<<4|a>>4,n=t.charCodeAt(d++),c=(a&15)<<2|n>>6,f=n&63,isNaN(a)?c=f=64:isNaN(n)&&(f=64),e+=uu.charAt(s)+uu.charAt(l)+uu.charAt(c)+uu.charAt(f);return e}function qi(t){var e="",r=0,a=0,n=0,s=0,l=0,c=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)s=uu.indexOf(t.charAt(d++)),l=uu.indexOf(t.charAt(d++)),r=s<<2|l>>4,e+=String.fromCharCode(r),c=uu.indexOf(t.charAt(d++)),a=(l&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(a)),f=uu.indexOf(t.charAt(d++)),n=(c&3)<<6|f,f!==64&&(e+=String.fromCharCode(n));return e}var Pr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),vc=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function mu(t){return Pr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function lw(t){return Pr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Pi=function(e){return Pr?vc(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function p1(t){if(typeof ArrayBuffer>"u")return Pi(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),a=0;a!=t.length;++a)r[a]=t.charCodeAt(a)&255;return e}function _u(t){if(Array.isArray(t))return t.map(function(a){return String.fromCharCode(a)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function t8(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function s2(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return s2(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var ss=Pr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:vc(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var a=new Uint8Array(r),n=0;for(e=0,r=0;e<t.length;r+=n,++e)if(n=t[e].length,t[e]instanceof Uint8Array)a.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";a.set(new Uint8Array(t[e]),r)}return a}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function r8(t){for(var e=[],r=0,a=t.length+250,n=mu(t.length+255),s=0;s<t.length;++s){var l=t.charCodeAt(s);if(l<128)n[r++]=l;else if(l<2048)n[r++]=192|l>>6&31,n[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=t.charCodeAt(++s)&1023;n[r++]=240|l>>8&7,n[r++]=128|l>>2&63,n[r++]=128|c>>6&15|(l&3)<<4,n[r++]=128|c&63}else n[r++]=224|l>>12&15,n[r++]=128|l>>6&63,n[r++]=128|l&63;r>a&&(e.push(n.slice(0,r)),r=0,n=mu(65535),a=65530)}return e.push(n.slice(0,r)),ss(e)}var Gs=/\u0000/g,o0=/[\u0001-\u0006]/g;function Xd(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Go(t,e){var r=""+t;return r.length>=e?r:hn("0",e-r.length)+r}function i2(t,e){var r=""+t;return r.length>=e?r:hn(" ",e-r.length)+r}function Vp(t,e){var r=""+t;return r.length>=e?r:r+hn(" ",e-r.length)}function a8(t,e){var r=""+Math.round(t);return r.length>=e?r:hn("0",e-r.length)+r}function n8(t,e){var r=""+t;return r.length>=e?r:hn("0",e-r.length)+r}var cw=Math.pow(2,32);function Dd(t,e){if(t>cw||t<-cw)return a8(t,e);var r=Math.round(t);return n8(r,e)}function Gp(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var uw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],av=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function s8(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var _r={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},fw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},i8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Yp(t,e,r){for(var a=t<0?-1:1,n=t*a,s=0,l=1,c=0,f=1,d=0,m=0,v=Math.floor(n);d<e&&(v=Math.floor(n),c=v*l+s,m=v*d+f,!(n-v<5e-8));)n=1/(n-v),s=l,l=c,f=d,d=m;if(m>e&&(d>e?(m=f,c=s):(m=d,c=l)),!r)return[0,a*c,m];var x=Math.floor(a*c/m);return[x,a*c-x*m,m]}function ff(t,e,r){if(t>2958465||t<0)return null;var a=t|0,n=Math.floor(86400*(t-a)),s=0,l=[],c={D:a,T:n,u:86400*(t-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++n==86400&&(c.T=n=0,++a,++c.D)),a===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(a===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var f=new Date(1900,0,1);f.setDate(f.getDate()+a-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],s=f.getDay(),a<60&&(s=(s+6)%7),r&&(s=d8(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=n%60,n=Math.floor(n/60),c.M=n%60,n=Math.floor(n/60),c.H=n,c.q=s,c}var s3=new Date(1899,11,31,0,0,0),o8=s3.getTime(),l8=new Date(1900,2,1,0,0,0);function i3(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=l8&&(r+=1440*60*1e3),(r-(o8+(t.getTimezoneOffset()-s3.getTimezoneOffset())*6e4))/(1440*60*1e3)}function o2(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function c8(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function u8(t){var e=t<0?12:11,r=o2(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function f8(t){var e=o2(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function O0(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=u8(t):e===10?r=t.toFixed(10).substr(0,12):r=f8(t),o2(c8(r.toUpperCase()))}function vf(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):O0(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return fo(14,i3(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function d8(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function h8(t,e,r,a){var n="",s=0,l=0,c=r.y,f,d=0;switch(t){case 98:c=r.y+543;case 121:switch(e.length){case 1:case 2:f=c%100,d=2;break;default:f=c%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:f=r.m,d=e.length;break;case 3:return av[r.m-1][1];case 5:return av[r.m-1][0];default:return av[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=r.d,d=e.length;break;case 3:return uw[r.q][0];default:return uw[r.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Go(r.S,e.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),e==="s"?s===0?"0":""+s/l:(n=Go(s,2+a),e==="ss"?n.substr(0,2):"."+n.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:f=c,d=1;break}var m=d>0?Go(f,d):"";return m}function fu(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,a=t.substr(0,r);r!=t.length;r+=e)a+=(a.length>0?",":"")+t.substr(r,e);return a}var o3=/%/g;function m8(t,e,r){var a=e.replace(o3,""),n=e.length-a.length;return fc(t,a,r*Math.pow(10,2*n))+hn("%",n)}function p8(t,e,r){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return fc(t,e.substr(0,a),r/Math.pow(10,3*(e.length-a)))}function l3(t,e){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+l3(t,-e);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(e/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),r.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,m){return f+d+m.substr(0,(n+s)%n)+"."+m.substr(s)+"E"})}else r=e.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var c3=/# (\?+)( ?)\/( ?)(\d+)/;function g8(t,e,r){var a=parseInt(t[4],10),n=Math.round(e*a),s=Math.floor(n/a),l=n-s*a,c=a;return r+(s===0?"":""+s)+" "+(l===0?hn(" ",t[1].length+1+t[4].length):i2(l,t[1].length)+t[2]+"/"+t[3]+Go(c,t[4].length))}function v8(t,e,r){return r+(e===0?"":""+e)+hn(" ",t[1].length+2+t[4].length)}var u3=/^#*0*\.([0#]+)/,f3=/\).*[0#]/,d3=/\(###\) ###\\?-####/;function Ws(t){for(var e="",r,a=0;a!=t.length;++a)switch(r=t.charCodeAt(a)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function dw(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function hw(t,e){var r=t-Math.floor(t),a=Math.pow(10,e);return e<(""+Math.round(r*a)).length?0:Math.round(r*a)}function x8(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function y8(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function so(t,e,r){if(t.charCodeAt(0)===40&&!e.match(f3)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?so("n",a,r):"("+so("n",a,-r)+")"}if(e.charCodeAt(e.length-1)===44)return p8(t,e,r);if(e.indexOf("%")!==-1)return m8(t,e,r);if(e.indexOf("E")!==-1)return l3(e,r);if(e.charCodeAt(0)===36)return"$"+so(t,e.substr(e.charAt(1)==" "?2:1),r);var n,s,l,c,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Dd(f,e.length);if(e.match(/^[#?]+$/))return n=Dd(r,0),n==="0"&&(n=""),n.length>e.length?n:Ws(e.substr(0,e.length-n.length))+n;if(s=e.match(c3))return g8(s,f,d);if(e.match(/^#+0+$/))return d+Dd(f,e.length-e.indexOf("0"));if(s=e.match(u3))return n=dw(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ws(s[1])).replace(/\.$/,"."+Ws(s[1])).replace(/\.(\d*)$/,function(b,_){return"."+_+hn("0",Ws(s[1]).length-_.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+dw(f,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+fu(Dd(f,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+so(t,e,-r):fu(""+(Math.floor(r)+x8(r,s[1].length)))+"."+Go(hw(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return so(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Xd(so(t,e.replace(/[\\-]/g,""),r)),l=0,Xd(Xd(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<n.length?n.charAt(l++):b==="0"?"0":""}));if(e.match(d3))return n=so(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=Yp(f,Math.pow(10,l)-1,!1),n=""+d,m=fc("n",s[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+s[2]+"/"+s[3],m=Vp(c[2],l),m.length<s[4].length&&(m=Ws(s[4].substr(s[4].length-m.length))+m),n+=m,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=Yp(f,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?i2(c[1],l)+s[2]+"/"+s[3]+Vp(c[2],l):hn(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=Dd(r,0),e.length<=n.length?n:Ws(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var v=e.indexOf(".")-l,x=e.length-n.length-v;return Ws(e.substr(0,v)+n+e.substr(e.length-x))}if(s=e.match(/^00,000\.([#0]*0)$/))return l=hw(r,s[1].length),r<0?"-"+so(t,e,-r):fu(y8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Go(0,3-b.length):"")+b})+"."+Go(l,s[1].length);switch(e){case"###,##0.00":return so(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=fu(Dd(f,0));return g!=="0"?d+g:"";case"###,###.00":return so(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return so(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function _8(t,e,r){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return fc(t,e.substr(0,a),r/Math.pow(10,3*(e.length-a)))}function b8(t,e,r){var a=e.replace(o3,""),n=e.length-a.length;return fc(t,a,r*Math.pow(10,2*n))+hn("%",n)}function h3(t,e){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+h3(t,-e);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(e/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!r.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,m){return f+d+m.substr(0,(n+s)%n)+"."+m.substr(s)+"E"})}else r=e.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function _l(t,e,r){if(t.charCodeAt(0)===40&&!e.match(f3)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_l("n",a,r):"("+_l("n",a,-r)+")"}if(e.charCodeAt(e.length-1)===44)return _8(t,e,r);if(e.indexOf("%")!==-1)return b8(t,e,r);if(e.indexOf("E")!==-1)return h3(e,r);if(e.charCodeAt(0)===36)return"$"+_l(t,e.substr(e.charAt(1)==" "?2:1),r);var n,s,l,c,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Go(f,e.length);if(e.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>e.length?n:Ws(e.substr(0,e.length-n.length))+n;if(s=e.match(c3))return v8(s,f,d);if(e.match(/^#+0+$/))return d+Go(f,e.length-e.indexOf("0"));if(s=e.match(u3))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Ws(s[1])).replace(/\.$/,"."+Ws(s[1])),n=n.replace(/\.(\d*)$/,function(b,_){return"."+_+hn("0",Ws(s[1]).length-_.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+fu(""+f);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_l(t,e,-r):fu(""+r)+"."+hn("0",s[1].length);if(s=e.match(/^#,#*,#0/))return _l(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Xd(_l(t,e.replace(/[\\-]/g,""),r)),l=0,Xd(Xd(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<n.length?n.charAt(l++):b==="0"?"0":""}));if(e.match(d3))return n=_l(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=Yp(f,Math.pow(10,l)-1,!1),n=""+d,m=fc("n",s[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+s[2]+"/"+s[3],m=Vp(c[2],l),m.length<s[4].length&&(m=Ws(s[4].substr(s[4].length-m.length))+m),n+=m,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=Yp(f,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?i2(c[1],l)+s[2]+"/"+s[3]+Vp(c[2],l):hn(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=""+r,e.length<=n.length?n:Ws(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var v=e.indexOf(".")-l,x=e.length-n.length-v;return Ws(e.substr(0,v)+n+e.substr(e.length-x))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+_l(t,e,-r):fu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Go(0,3-b.length):"")+b})+"."+Go(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=fu(""+f);return g!=="0"?d+g:"";default:if(e.match(/\.[0#?]*$/))return _l(t,e.slice(0,e.lastIndexOf(".")),r)+Ws(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function fc(t,e,r){return(r|0)===r?_l(t,e,r):so(t,e,r)}function w8(t){for(var e=[],r=!1,a=0,n=0;a<t.length;++a)switch(t.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:e[e.length]=t.substr(n,a-n),n=a+1}if(e[e.length]=t.substr(n),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var m3=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function dh(t){for(var e=0,r="",a="";e<t.length;)switch(r=t.charAt(e)){case"G":Gp(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(a=r;t.charAt(e++)!=="]"&&e<t.length;)a+=t.charAt(e);if(a.match(m3))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function S8(t,e,r,a){for(var n=[],s="",l=0,c="",f="t",d,m,v,x="H";l<t.length;)switch(c=t.charAt(l)){case"G":if(!Gp(t,l))throw new Error("unrecognized character "+c+" in "+t);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(v=t.charCodeAt(++l))!==34&&l<t.length;)s+=String.fromCharCode(v);n[n.length]={t:"t",v:s},++l;break;case"\\":var g=t.charAt(++l),b=g==="("||g===")"?g:"t";n[n.length]={t:b,v:g},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(d==null&&(d=ff(e,r,t.charAt(l+1)==="2"),d==null))return"";n[n.length]={t:"X",v:t.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=ff(e,r),d==null))return"";for(s=c;++l<t.length&&t.charAt(l).toLowerCase()===c;)s+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),n[n.length]={t:c,v:s},f=c;break;case"A":case"a":case"":var _={t:c,v:c};if(d==null&&(d=ff(e,r)),t.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(_.v=d.H>=12?"P":"A"),_.t="T",x="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(_.v=d.H>=12?"PM":"AM"),_.t="T",l+=5,x="h"):t.substr(l,5).toUpperCase()==="/"?(d!=null&&(_.v=d.H>=12?"":""),_.t="T",l+=5,x="h"):(_.t="t",++l),d==null&&_.t==="T")return"";n[n.length]=_,f=c;break;case"[":for(s=c;t.charAt(l++)!=="]"&&l<t.length;)s+=t.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(m3)){if(d==null&&(d=ff(e,r),d==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},f=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",dh(t)||(n[n.length]={t:"t",v:s}));break;case".":if(d!=null){for(s=c;++l<t.length&&(c=t.charAt(l))==="0";)s+=c;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++l<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(l))>-1;)s+=c;n[n.length]={t:"n",v:s};break;case"?":for(s=c;t.charAt(++l)===c;)s+=c;n[n.length]={t:c,v:s},f=c;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:a===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)s+=t.charAt(l);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:c,v:c},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);n[n.length]={t:"t",v:c},++l;break}var w=0,A=0,C;for(l=n.length-1,f="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=x,f="h",w<1&&(w=1);break;case"s":(C=n[l].v.match(/\.0+$/))&&(A=Math.max(A,C[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":f=n[l].t;break;case"m":f==="s"&&(n[l].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&n[l].v.match(/[Hh]/)&&(w=1),w<2&&n[l].v.match(/[Mm]/)&&(w=2),w<3&&n[l].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var E="",R;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=h8(n[l].t.charCodeAt(0),n[l].v,d,A),n[l].t="t";break;case"n":case"?":for(R=l+1;n[R]!=null&&((c=n[R].t)==="?"||c==="D"||(c===" "||c==="t")&&n[R+1]!=null&&(n[R+1].t==="?"||n[R+1].t==="t"&&n[R+1].v==="/")||n[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(n[R].v==="/"||n[R].v===" "&&n[R+1]!=null&&n[R+1].t=="?"));)n[l].v+=n[R].v,n[R]={v:"",t:";"},++R;E+=n[l].v,l=R-1;break;case"G":n[l].t="t",n[l].v=vf(e,r);break}var Y="",W,B;if(E.length>0){E.charCodeAt(0)==40?(W=e<0&&E.charCodeAt(0)===45?-e:e,B=fc("n",E,W)):(W=e<0&&a>1?-e:e,B=fc("n",E,W),W<0&&n[0]&&n[0].t=="t"&&(B=B.substr(1),n[0].v="-"+n[0].v)),R=B.length-1;var q=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){q=l;break}var L=n.length;if(q===n.length&&B.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(R>=n[l].v.length-1?(R-=n[l].v.length,n[l].v=B.substr(R+1,n[l].v.length)):R<0?n[l].v="":(n[l].v=B.substr(0,R+1),R=-1),n[l].t="t",L=l);R>=0&&L<n.length&&(n[L].v=B.substr(0,R+1)+n[L].v)}else if(q!==n.length&&B.indexOf("E")===-1){for(R=B.indexOf(".")-1,l=q;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(m=n[l].v.indexOf(".")>-1&&l===q?n[l].v.indexOf(".")-1:n[l].v.length-1,Y=n[l].v.substr(m+1);m>=0;--m)R>=0&&(n[l].v.charAt(m)==="0"||n[l].v.charAt(m)==="#")&&(Y=B.charAt(R--)+Y);n[l].v=Y,n[l].t="t",L=l}for(R>=0&&L<n.length&&(n[L].v=B.substr(0,R+1)+n[L].v),R=B.indexOf(".")+1,l=q;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==q)){for(m=n[l].v.indexOf(".")>-1&&l===q?n[l].v.indexOf(".")+1:0,Y=n[l].v.substr(0,m);m<n[l].v.length;++m)R<B.length&&(Y+=B.charAt(R++));n[l].v=Y,n[l].t="t",L=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(W=a>1&&e<0&&l>0&&n[l-1].v==="-"?-e:e,n[l].v=fc(n[l].t,n[l].v,W),n[l].t="t");var J="";for(l=0;l!==n.length;++l)n[l]!=null&&(J+=n[l].v);return J}var mw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function pw(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function N8(t,e){var r=w8(t),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(mw),c=r[1].match(mw);return pw(e,l)?[a,r[0]]:pw(e,c)?[a,r[1]]:[a,r[l!=null&&c!=null?2:1]]}return[a,s]}function fo(t,e,r){r==null&&(r={});var a="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?a=r.dateNF:a=t;break;case"number":t==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:_r)[t],a==null&&(a=r.table&&r.table[fw[t]]||_r[fw[t]]),a==null&&(a=i8[t]||"General");break}if(Gp(a,0))return vf(e,r);e instanceof Date&&(e=i3(e,r.date1904));var n=N8(a,e);if(Gp(n[1]))return vf(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return S8(n[1],e,r,n[0])}function dc(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(_r[r]==null){e<0&&(e=r);continue}if(_r[r]==t){e=r;break}}e<0&&(e=391)}return _r[e]=t,e}function g1(t){for(var e=0;e!=392;++e)t[e]!==void 0&&dc(t[e],e)}function hh(){_r=s8()}var k8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},p3=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function j8(t){var e=typeof t=="number"?_r[t]:t;return e=e.replace(p3,"(\\d+)"),new RegExp("^"+e+"$")}function E8(t,e,r){var a=-1,n=-1,s=-1,l=-1,c=-1,f=-1;(e.match(p3)||[]).forEach(function(v,x){var g=parseInt(r[x+1],10);switch(v.toLowerCase().charAt(0)){case"y":a=g;break;case"d":s=g;break;case"h":l=g;break;case"s":f=g;break;case"m":l>=0?c=g:n=g;break}}),f>=0&&c==-1&&n>=0&&(c=n,n=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?d:a==-1&&n==-1&&s==-1?m:d+"T"+m}var A8=(function(){var t={};t.version="1.2.0";function e(){for(var B=0,q=new Array(256),L=0;L!=256;++L)B=L,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,q[L]=B;return typeof Int32Array<"u"?new Int32Array(q):q}var r=e();function a(B){var q=0,L=0,J=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(J=0;J!=256;++J)D[J]=B[J];for(J=0;J!=256;++J)for(L=B[J],q=256+J;q<4096;q+=256)L=D[q]=L>>>8^B[L&255];var T=[];for(J=1;J!=16;++J)T[J-1]=typeof Int32Array<"u"?D.subarray(J*256,J*256+256):D.slice(J*256,J*256+256);return T}var n=a(r),s=n[0],l=n[1],c=n[2],f=n[3],d=n[4],m=n[5],v=n[6],x=n[7],g=n[8],b=n[9],_=n[10],w=n[11],A=n[12],C=n[13],E=n[14];function R(B,q){for(var L=q^-1,J=0,D=B.length;J<D;)L=L>>>8^r[(L^B.charCodeAt(J++))&255];return~L}function Y(B,q){for(var L=q^-1,J=B.length-15,D=0;D<J;)L=E[B[D++]^L&255]^C[B[D++]^L>>8&255]^A[B[D++]^L>>16&255]^w[B[D++]^L>>>24]^_[B[D++]]^b[B[D++]]^g[B[D++]]^x[B[D++]]^v[B[D++]]^m[B[D++]]^d[B[D++]]^f[B[D++]]^c[B[D++]]^l[B[D++]]^s[B[D++]]^r[B[D++]];for(J+=15;D<J;)L=L>>>8^r[(L^B[D++])&255];return~L}function W(B,q){for(var L=q^-1,J=0,D=B.length,T=0,M=0;J<D;)T=B.charCodeAt(J++),T<128?L=L>>>8^r[(L^T)&255]:T<2048?(L=L>>>8^r[(L^(192|T>>6&31))&255],L=L>>>8^r[(L^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,M=B.charCodeAt(J++)&1023,L=L>>>8^r[(L^(240|T>>8&7))&255],L=L>>>8^r[(L^(128|T>>2&63))&255],L=L>>>8^r[(L^(128|M>>6&15|(T&3)<<4))&255],L=L>>>8^r[(L^(128|M&63))&255]):(L=L>>>8^r[(L^(224|T>>12&15))&255],L=L>>>8^r[(L^(128|T>>6&63))&255],L=L>>>8^r[(L^(128|T&63))&255]);return~L}return t.table=r,t.bstr=R,t.buf=Y,t.str=W,t})(),hr=(function(){var e={};e.version="1.2.1";function r(ae,Se){for(var ge=ae.split("/"),xe=Se.split("/"),Ne=0,ke=0,He=Math.min(ge.length,xe.length);Ne<He;++Ne){if(ke=ge[Ne].length-xe[Ne].length)return ke;if(ge[Ne]!=xe[Ne])return ge[Ne]<xe[Ne]?-1:1}return ge.length-xe.length}function a(ae){if(ae.charAt(ae.length-1)=="/")return ae.slice(0,-1).indexOf("/")===-1?ae:a(ae.slice(0,-1));var Se=ae.lastIndexOf("/");return Se===-1?ae:ae.slice(0,Se+1)}function n(ae){if(ae.charAt(ae.length-1)=="/")return n(ae.slice(0,-1));var Se=ae.lastIndexOf("/");return Se===-1?ae:ae.slice(Se+1)}function s(ae,Se){typeof Se=="string"&&(Se=new Date(Se));var ge=Se.getHours();ge=ge<<6|Se.getMinutes(),ge=ge<<5|Se.getSeconds()>>>1,ae.write_shift(2,ge);var xe=Se.getFullYear()-1980;xe=xe<<4|Se.getMonth()+1,xe=xe<<5|Se.getDate(),ae.write_shift(2,xe)}function l(ae){var Se=ae.read_shift(2)&65535,ge=ae.read_shift(2)&65535,xe=new Date,Ne=ge&31;ge>>>=5;var ke=ge&15;ge>>>=4,xe.setMilliseconds(0),xe.setFullYear(ge+1980),xe.setMonth(ke-1),xe.setDate(Ne);var He=Se&31;Se>>>=5;var nt=Se&63;return Se>>>=6,xe.setHours(Se),xe.setMinutes(nt),xe.setSeconds(He<<1),xe}function c(ae){ys(ae,0);for(var Se={},ge=0;ae.l<=ae.length-4;){var xe=ae.read_shift(2),Ne=ae.read_shift(2),ke=ae.l+Ne,He={};switch(xe){case 21589:ge=ae.read_shift(1),ge&1&&(He.mtime=ae.read_shift(4)),Ne>5&&(ge&2&&(He.atime=ae.read_shift(4)),ge&4&&(He.ctime=ae.read_shift(4))),He.mtime&&(He.mt=new Date(He.mtime*1e3));break}ae.l=ke,Se[xe]=He}return Se}var f;function d(){return f||(f={})}function m(ae,Se){if(ae[0]==80&&ae[1]==75)return Tt(ae,Se);if((ae[0]|32)==109&&(ae[1]|32)==105)return ar(ae,Se);if(ae.length<512)throw new Error("CFB file size "+ae.length+" < 512");var ge=3,xe=512,Ne=0,ke=0,He=0,nt=0,Ge=0,Ye=[],Je=ae.slice(0,512);ys(Je,0);var kt=v(Je);switch(ge=kt[0],ge){case 3:xe=512;break;case 4:xe=4096;break;case 0:if(kt[1]==0)return Tt(ae,Se);default:throw new Error("Major Version: Expected 3 or 4 saw "+ge)}xe!==512&&(Je=ae.slice(0,xe),ys(Je,28));var Rt=ae.slice(0,xe);x(Je,ge);var qt=Je.read_shift(4,"i");if(ge===3&&qt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qt);Je.l+=4,He=Je.read_shift(4,"i"),Je.l+=4,Je.chk("00100000","Mini Stream Cutoff Size: "),nt=Je.read_shift(4,"i"),Ne=Je.read_shift(4,"i"),Ge=Je.read_shift(4,"i"),ke=Je.read_shift(4,"i");for(var Ot=-1,Mt=0;Mt<109&&(Ot=Je.read_shift(4,"i"),!(Ot<0));++Mt)Ye[Mt]=Ot;var Xt=g(ae,xe);w(Ge,ke,Xt,xe,Ye);var sa=C(Xt,He,Ye,xe);sa[He].name="!Directory",Ne>0&&nt!==M&&(sa[nt].name="!MiniFAT"),sa[Ye[0]].name="!FAT",sa.fat_addrs=Ye,sa.ssz=xe;var Lr={},ca=[],ls=[],pi=[];E(He,sa,Xt,ca,Ne,Lr,ls,nt),b(ls,pi,ca),ca.shift();var gi={FileIndex:ls,FullPaths:pi};return Se&&Se.raw&&(gi.raw={header:Rt,sectors:Xt}),gi}function v(ae){if(ae[ae.l]==80&&ae[ae.l+1]==75)return[0,0];ae.chk(V,"Header Signature: "),ae.l+=16;var Se=ae.read_shift(2,"u");return[ae.read_shift(2,"u"),Se]}function x(ae,Se){var ge=9;switch(ae.l+=2,ge=ae.read_shift(2)){case 9:if(Se!=3)throw new Error("Sector Shift: Expected 9 saw "+ge);break;case 12:if(Se!=4)throw new Error("Sector Shift: Expected 12 saw "+ge);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ge)}ae.chk("0600","Mini Sector Shift: "),ae.chk("000000000000","Reserved: ")}function g(ae,Se){for(var ge=Math.ceil(ae.length/Se)-1,xe=[],Ne=1;Ne<ge;++Ne)xe[Ne-1]=ae.slice(Ne*Se,(Ne+1)*Se);return xe[ge-1]=ae.slice(ge*Se),xe}function b(ae,Se,ge){for(var xe=0,Ne=0,ke=0,He=0,nt=0,Ge=ge.length,Ye=[],Je=[];xe<Ge;++xe)Ye[xe]=Je[xe]=xe,Se[xe]=ge[xe];for(;nt<Je.length;++nt)xe=Je[nt],Ne=ae[xe].L,ke=ae[xe].R,He=ae[xe].C,Ye[xe]===xe&&(Ne!==-1&&Ye[Ne]!==Ne&&(Ye[xe]=Ye[Ne]),ke!==-1&&Ye[ke]!==ke&&(Ye[xe]=Ye[ke])),He!==-1&&(Ye[He]=xe),Ne!==-1&&xe!=Ye[xe]&&(Ye[Ne]=Ye[xe],Je.lastIndexOf(Ne)<nt&&Je.push(Ne)),ke!==-1&&xe!=Ye[xe]&&(Ye[ke]=Ye[xe],Je.lastIndexOf(ke)<nt&&Je.push(ke));for(xe=1;xe<Ge;++xe)Ye[xe]===xe&&(ke!==-1&&Ye[ke]!==ke?Ye[xe]=Ye[ke]:Ne!==-1&&Ye[Ne]!==Ne&&(Ye[xe]=Ye[Ne]));for(xe=1;xe<Ge;++xe)if(ae[xe].type!==0){if(nt=xe,nt!=Ye[nt])do nt=Ye[nt],Se[xe]=Se[nt]+"/"+Se[xe];while(nt!==0&&Ye[nt]!==-1&&nt!=Ye[nt]);Ye[xe]=-1}for(Se[0]+="/",xe=1;xe<Ge;++xe)ae[xe].type!==2&&(Se[xe]+="/")}function _(ae,Se,ge){for(var xe=ae.start,Ne=ae.size,ke=[],He=xe;ge&&Ne>0&&He>=0;)ke.push(Se.slice(He*T,He*T+T)),Ne-=T,He=of(ge,He*4);return ke.length===0?ut(0):ss(ke).slice(0,ae.size)}function w(ae,Se,ge,xe,Ne){var ke=M;if(ae===M){if(Se!==0)throw new Error("DIFAT chain shorter than expected")}else if(ae!==-1){var He=ge[ae],nt=(xe>>>2)-1;if(!He)return;for(var Ge=0;Ge<nt&&(ke=of(He,Ge*4))!==M;++Ge)Ne.push(ke);w(of(He,xe-4),Se-1,ge,xe,Ne)}}function A(ae,Se,ge,xe,Ne){var ke=[],He=[];Ne||(Ne=[]);var nt=xe-1,Ge=0,Ye=0;for(Ge=Se;Ge>=0;){Ne[Ge]=!0,ke[ke.length]=Ge,He.push(ae[Ge]);var Je=ge[Math.floor(Ge*4/xe)];if(Ye=Ge*4&nt,xe<4+Ye)throw new Error("FAT boundary crossed: "+Ge+" 4 "+xe);if(!ae[Je])break;Ge=of(ae[Je],Ye)}return{nodes:ke,data:Ew([He])}}function C(ae,Se,ge,xe){var Ne=ae.length,ke=[],He=[],nt=[],Ge=[],Ye=xe-1,Je=0,kt=0,Rt=0,qt=0;for(Je=0;Je<Ne;++Je)if(nt=[],Rt=Je+Se,Rt>=Ne&&(Rt-=Ne),!He[Rt]){Ge=[];var Ot=[];for(kt=Rt;kt>=0;){Ot[kt]=!0,He[kt]=!0,nt[nt.length]=kt,Ge.push(ae[kt]);var Mt=ge[Math.floor(kt*4/xe)];if(qt=kt*4&Ye,xe<4+qt)throw new Error("FAT boundary crossed: "+kt+" 4 "+xe);if(!ae[Mt]||(kt=of(ae[Mt],qt),Ot[kt]))break}ke[Rt]={nodes:nt,data:Ew([Ge])}}return ke}function E(ae,Se,ge,xe,Ne,ke,He,nt){for(var Ge=0,Ye=xe.length?2:0,Je=Se[ae].data,kt=0,Rt=0,qt;kt<Je.length;kt+=128){var Ot=Je.slice(kt,kt+128);ys(Ot,64),Rt=Ot.read_shift(2),qt=m2(Ot,0,Rt-Ye),xe.push(qt);var Mt={name:qt,type:Ot.read_shift(1),color:Ot.read_shift(1),L:Ot.read_shift(4,"i"),R:Ot.read_shift(4,"i"),C:Ot.read_shift(4,"i"),clsid:Ot.read_shift(16),state:Ot.read_shift(4,"i"),start:0,size:0},Xt=Ot.read_shift(2)+Ot.read_shift(2)+Ot.read_shift(2)+Ot.read_shift(2);Xt!==0&&(Mt.ct=R(Ot,Ot.l-8));var sa=Ot.read_shift(2)+Ot.read_shift(2)+Ot.read_shift(2)+Ot.read_shift(2);sa!==0&&(Mt.mt=R(Ot,Ot.l-8)),Mt.start=Ot.read_shift(4,"i"),Mt.size=Ot.read_shift(4,"i"),Mt.size<0&&Mt.start<0&&(Mt.size=Mt.type=0,Mt.start=M,Mt.name=""),Mt.type===5?(Ge=Mt.start,Ne>0&&Ge!==M&&(Se[Ge].name="!StreamData")):Mt.size>=4096?(Mt.storage="fat",Se[Mt.start]===void 0&&(Se[Mt.start]=A(ge,Mt.start,Se.fat_addrs,Se.ssz)),Se[Mt.start].name=Mt.name,Mt.content=Se[Mt.start].data.slice(0,Mt.size)):(Mt.storage="minifat",Mt.size<0?Mt.size=0:Ge!==M&&Mt.start!==M&&Se[Ge]&&(Mt.content=_(Mt,Se[Ge].data,(Se[nt]||{}).data))),Mt.content&&ys(Mt.content,0),ke[qt]=Mt,He.push(Mt)}}function R(ae,Se){return new Date((Di(ae,Se+4)/1e7*Math.pow(2,32)+Di(ae,Se)/1e7-11644473600)*1e3)}function Y(ae,Se){return d(),m(f.readFileSync(ae),Se)}function W(ae,Se){var ge=Se&&Se.type;switch(ge||Pr&&Buffer.isBuffer(ae)&&(ge="buffer"),ge||"base64"){case"file":return Y(ae,Se);case"base64":return m(Pi(qi(ae)),Se);case"binary":return m(Pi(ae),Se)}return m(ae,Se)}function B(ae,Se){var ge=Se||{},xe=ge.root||"Root Entry";if(ae.FullPaths||(ae.FullPaths=[]),ae.FileIndex||(ae.FileIndex=[]),ae.FullPaths.length!==ae.FileIndex.length)throw new Error("inconsistent CFB structure");ae.FullPaths.length===0&&(ae.FullPaths[0]=xe+"/",ae.FileIndex[0]={name:xe,type:5}),ge.CLSID&&(ae.FileIndex[0].clsid=ge.CLSID),q(ae)}function q(ae){var Se="Sh33tJ5";if(!hr.find(ae,"/"+Se)){var ge=ut(4);ge[0]=55,ge[1]=ge[3]=50,ge[2]=54,ae.FileIndex.push({name:Se,type:2,content:ge,size:4,L:69,R:69,C:69}),ae.FullPaths.push(ae.FullPaths[0]+Se),L(ae)}}function L(ae,Se){B(ae);for(var ge=!1,xe=!1,Ne=ae.FullPaths.length-1;Ne>=0;--Ne){var ke=ae.FileIndex[Ne];switch(ke.type){case 0:xe?ge=!0:(ae.FileIndex.pop(),ae.FullPaths.pop());break;case 1:case 2:case 5:xe=!0,isNaN(ke.R*ke.L*ke.C)&&(ge=!0),ke.R>-1&&ke.L>-1&&ke.R==ke.L&&(ge=!0);break;default:ge=!0;break}}if(!(!ge&&!Se)){var He=new Date(1987,1,19),nt=0,Ge=Object.create?Object.create(null):{},Ye=[];for(Ne=0;Ne<ae.FullPaths.length;++Ne)Ge[ae.FullPaths[Ne]]=!0,ae.FileIndex[Ne].type!==0&&Ye.push([ae.FullPaths[Ne],ae.FileIndex[Ne]]);for(Ne=0;Ne<Ye.length;++Ne){var Je=a(Ye[Ne][0]);xe=Ge[Je],xe||(Ye.push([Je,{name:n(Je).replace("/",""),type:1,clsid:X,ct:He,mt:He,content:null}]),Ge[Je]=!0)}for(Ye.sort(function(qt,Ot){return r(qt[0],Ot[0])}),ae.FullPaths=[],ae.FileIndex=[],Ne=0;Ne<Ye.length;++Ne)ae.FullPaths[Ne]=Ye[Ne][0],ae.FileIndex[Ne]=Ye[Ne][1];for(Ne=0;Ne<Ye.length;++Ne){var kt=ae.FileIndex[Ne],Rt=ae.FullPaths[Ne];if(kt.name=n(Rt).replace("/",""),kt.L=kt.R=kt.C=-(kt.color=1),kt.size=kt.content?kt.content.length:0,kt.start=0,kt.clsid=kt.clsid||X,Ne===0)kt.C=Ye.length>1?1:-1,kt.size=0,kt.type=5;else if(Rt.slice(-1)=="/"){for(nt=Ne+1;nt<Ye.length&&a(ae.FullPaths[nt])!=Rt;++nt);for(kt.C=nt>=Ye.length?-1:nt,nt=Ne+1;nt<Ye.length&&a(ae.FullPaths[nt])!=a(Rt);++nt);kt.R=nt>=Ye.length?-1:nt,kt.type=1}else a(ae.FullPaths[Ne+1]||"")==a(Rt)&&(kt.R=Ne+1),kt.type=2}}}function J(ae,Se){var ge=Se||{};if(ge.fileType=="mad")return za(ae,ge);switch(L(ae),ge.fileType){case"zip":return or(ae,ge)}var xe=(function(qt){for(var Ot=0,Mt=0,Xt=0;Xt<qt.FileIndex.length;++Xt){var sa=qt.FileIndex[Xt];if(sa.content){var Lr=sa.content.length;Lr>0&&(Lr<4096?Ot+=Lr+63>>6:Mt+=Lr+511>>9)}}for(var ca=qt.FullPaths.length+3>>2,ls=Ot+7>>3,pi=Ot+127>>7,gi=ls+Mt+ca+pi,Is=gi+127>>7,Qo=Is<=109?0:Math.ceil((Is-109)/127);gi+Is+Qo+127>>7>Is;)Qo=++Is<=109?0:Math.ceil((Is-109)/127);var Ra=[1,Qo,Is,pi,ca,Mt,Ot,0];return qt.FileIndex[0].size=Ot<<6,Ra[7]=(qt.FileIndex[0].start=Ra[0]+Ra[1]+Ra[2]+Ra[3]+Ra[4]+Ra[5])+(Ra[6]+7>>3),Ra})(ae),Ne=ut(xe[7]<<9),ke=0,He=0;{for(ke=0;ke<8;++ke)Ne.write_shift(1,ie[ke]);for(ke=0;ke<8;++ke)Ne.write_shift(2,0);for(Ne.write_shift(2,62),Ne.write_shift(2,3),Ne.write_shift(2,65534),Ne.write_shift(2,9),Ne.write_shift(2,6),ke=0;ke<3;++ke)Ne.write_shift(2,0);for(Ne.write_shift(4,0),Ne.write_shift(4,xe[2]),Ne.write_shift(4,xe[0]+xe[1]+xe[2]+xe[3]-1),Ne.write_shift(4,0),Ne.write_shift(4,4096),Ne.write_shift(4,xe[3]?xe[0]+xe[1]+xe[2]-1:M),Ne.write_shift(4,xe[3]),Ne.write_shift(-4,xe[1]?xe[0]-1:M),Ne.write_shift(4,xe[1]),ke=0;ke<109;++ke)Ne.write_shift(-4,ke<xe[2]?xe[1]+ke:-1)}if(xe[1])for(He=0;He<xe[1];++He){for(;ke<236+He*127;++ke)Ne.write_shift(-4,ke<xe[2]?xe[1]+ke:-1);Ne.write_shift(-4,He===xe[1]-1?M:He+1)}var nt=function(qt){for(He+=qt;ke<He-1;++ke)Ne.write_shift(-4,ke+1);qt&&(++ke,Ne.write_shift(-4,M))};for(He=ke=0,He+=xe[1];ke<He;++ke)Ne.write_shift(-4,Z.DIFSECT);for(He+=xe[2];ke<He;++ke)Ne.write_shift(-4,Z.FATSECT);nt(xe[3]),nt(xe[4]);for(var Ge=0,Ye=0,Je=ae.FileIndex[0];Ge<ae.FileIndex.length;++Ge)Je=ae.FileIndex[Ge],Je.content&&(Ye=Je.content.length,!(Ye<4096)&&(Je.start=He,nt(Ye+511>>9)));for(nt(xe[6]+7>>3);Ne.l&511;)Ne.write_shift(-4,Z.ENDOFCHAIN);for(He=ke=0,Ge=0;Ge<ae.FileIndex.length;++Ge)Je=ae.FileIndex[Ge],Je.content&&(Ye=Je.content.length,!(!Ye||Ye>=4096)&&(Je.start=He,nt(Ye+63>>6)));for(;Ne.l&511;)Ne.write_shift(-4,Z.ENDOFCHAIN);for(ke=0;ke<xe[4]<<2;++ke){var kt=ae.FullPaths[ke];if(!kt||kt.length===0){for(Ge=0;Ge<17;++Ge)Ne.write_shift(4,0);for(Ge=0;Ge<3;++Ge)Ne.write_shift(4,-1);for(Ge=0;Ge<12;++Ge)Ne.write_shift(4,0);continue}Je=ae.FileIndex[ke],ke===0&&(Je.start=Je.size?Je.start-1:M);var Rt=ke===0&&ge.root||Je.name;if(Ye=2*(Rt.length+1),Ne.write_shift(64,Rt,"utf16le"),Ne.write_shift(2,Ye),Ne.write_shift(1,Je.type),Ne.write_shift(1,Je.color),Ne.write_shift(-4,Je.L),Ne.write_shift(-4,Je.R),Ne.write_shift(-4,Je.C),Je.clsid)Ne.write_shift(16,Je.clsid,"hex");else for(Ge=0;Ge<4;++Ge)Ne.write_shift(4,0);Ne.write_shift(4,Je.state||0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,Je.start),Ne.write_shift(4,Je.size),Ne.write_shift(4,0)}for(ke=1;ke<ae.FileIndex.length;++ke)if(Je=ae.FileIndex[ke],Je.size>=4096)if(Ne.l=Je.start+1<<9,Pr&&Buffer.isBuffer(Je.content))Je.content.copy(Ne,Ne.l,0,Je.size),Ne.l+=Je.size+511&-512;else{for(Ge=0;Ge<Je.size;++Ge)Ne.write_shift(1,Je.content[Ge]);for(;Ge&511;++Ge)Ne.write_shift(1,0)}for(ke=1;ke<ae.FileIndex.length;++ke)if(Je=ae.FileIndex[ke],Je.size>0&&Je.size<4096)if(Pr&&Buffer.isBuffer(Je.content))Je.content.copy(Ne,Ne.l,0,Je.size),Ne.l+=Je.size+63&-64;else{for(Ge=0;Ge<Je.size;++Ge)Ne.write_shift(1,Je.content[Ge]);for(;Ge&63;++Ge)Ne.write_shift(1,0)}if(Pr)Ne.l=Ne.length;else for(;Ne.l<Ne.length;)Ne.write_shift(1,0);return Ne}function D(ae,Se){var ge=ae.FullPaths.map(function(Ge){return Ge.toUpperCase()}),xe=ge.map(function(Ge){var Ye=Ge.split("/");return Ye[Ye.length-(Ge.slice(-1)=="/"?2:1)]}),Ne=!1;Se.charCodeAt(0)===47?(Ne=!0,Se=ge[0].slice(0,-1)+Se):Ne=Se.indexOf("/")!==-1;var ke=Se.toUpperCase(),He=Ne===!0?ge.indexOf(ke):xe.indexOf(ke);if(He!==-1)return ae.FileIndex[He];var nt=!ke.match(o0);for(ke=ke.replace(Gs,""),nt&&(ke=ke.replace(o0,"!")),He=0;He<ge.length;++He)if((nt?ge[He].replace(o0,"!"):ge[He]).replace(Gs,"")==ke||(nt?xe[He].replace(o0,"!"):xe[He]).replace(Gs,"")==ke)return ae.FileIndex[He];return null}var T=64,M=-2,V="d0cf11e0a1b11ae1",ie=[208,207,17,224,161,177,26,225],X="00000000000000000000000000000000",Z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:V,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:X,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(ae,Se,ge){d();var xe=J(ae,ge);f.writeFileSync(Se,xe)}function re(ae){for(var Se=new Array(ae.length),ge=0;ge<ae.length;++ge)Se[ge]=String.fromCharCode(ae[ge]);return Se.join("")}function de(ae,Se){var ge=J(ae,Se);switch(Se&&Se.type||"buffer"){case"file":return d(),f.writeFileSync(Se.filename,ge),ge;case"binary":return typeof ge=="string"?ge:re(ge);case"base64":return T0(typeof ge=="string"?ge:re(ge));case"buffer":if(Pr)return Buffer.isBuffer(ge)?ge:vc(ge);case"array":return typeof ge=="string"?Pi(ge):ge}return ge}var U;function k(ae){try{var Se=ae.InflateRaw,ge=new Se;if(ge._processChunk(new Uint8Array([3,0]),ge._finishFlushFlag),ge.bytesRead)U=ae;else throw new Error("zlib does not expose bytesRead")}catch(xe){console.error("cannot use native zlib: "+(xe.message||xe))}}function F(ae,Se){if(!U)return Re(ae,Se);var ge=U.InflateRaw,xe=new ge,Ne=xe._processChunk(ae.slice(ae.l),xe._finishFlushFlag);return ae.l+=xe.bytesRead,Ne}function I(ae){return U?U.deflateRawSync(ae):pt(ae)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(ae){var Se=(ae<<1|ae<<11)&139536|(ae<<5|ae<<15)&558144;return(Se>>16|Se>>8|Se)&255}for(var ve=typeof Uint8Array<"u",_e=ve?new Uint8Array(256):[],Pe=0;Pe<256;++Pe)_e[Pe]=pe(Pe);function fe(ae,Se){var ge=_e[ae&255];return Se<=8?ge>>>8-Se:(ge=ge<<8|_e[ae>>8&255],Se<=16?ge>>>16-Se:(ge=ge<<8|_e[ae>>16&255],ge>>>24-Se))}function st(ae,Se){var ge=Se&7,xe=Se>>>3;return(ae[xe]|(ge<=6?0:ae[xe+1]<<8))>>>ge&3}function mt(ae,Se){var ge=Se&7,xe=Se>>>3;return(ae[xe]|(ge<=5?0:ae[xe+1]<<8))>>>ge&7}function he(ae,Se){var ge=Se&7,xe=Se>>>3;return(ae[xe]|(ge<=4?0:ae[xe+1]<<8))>>>ge&15}function at(ae,Se){var ge=Se&7,xe=Se>>>3;return(ae[xe]|(ge<=3?0:ae[xe+1]<<8))>>>ge&31}function we(ae,Se){var ge=Se&7,xe=Se>>>3;return(ae[xe]|(ge<=1?0:ae[xe+1]<<8))>>>ge&127}function ye(ae,Se,ge){var xe=Se&7,Ne=Se>>>3,ke=(1<<ge)-1,He=ae[Ne]>>>xe;return ge<8-xe||(He|=ae[Ne+1]<<8-xe,ge<16-xe)||(He|=ae[Ne+2]<<16-xe,ge<24-xe)||(He|=ae[Ne+3]<<24-xe),He&ke}function Be(ae,Se,ge){var xe=Se&7,Ne=Se>>>3;return xe<=5?ae[Ne]|=(ge&7)<<xe:(ae[Ne]|=ge<<xe&255,ae[Ne+1]=(ge&7)>>8-xe),Se+3}function Et(ae,Se,ge){var xe=Se&7,Ne=Se>>>3;return ge=(ge&1)<<xe,ae[Ne]|=ge,Se+1}function Xe(ae,Se,ge){var xe=Se&7,Ne=Se>>>3;return ge<<=xe,ae[Ne]|=ge&255,ge>>>=8,ae[Ne+1]=ge,Se+8}function lt(ae,Se,ge){var xe=Se&7,Ne=Se>>>3;return ge<<=xe,ae[Ne]|=ge&255,ge>>>=8,ae[Ne+1]=ge&255,ae[Ne+2]=ge>>>8,Se+16}function jt(ae,Se){var ge=ae.length,xe=2*ge>Se?2*ge:Se+5,Ne=0;if(ge>=Se)return ae;if(Pr){var ke=lw(xe);if(ae.copy)ae.copy(ke);else for(;Ne<ae.length;++Ne)ke[Ne]=ae[Ne];return ke}else if(ve){var He=new Uint8Array(xe);if(He.set)He.set(ae);else for(;Ne<ge;++Ne)He[Ne]=ae[Ne];return He}return ae.length=xe,ae}function Dt(ae){for(var Se=new Array(ae),ge=0;ge<ae;++ge)Se[ge]=0;return Se}function Wt(ae,Se,ge){var xe=1,Ne=0,ke=0,He=0,nt=0,Ge=ae.length,Ye=ve?new Uint16Array(32):Dt(32);for(ke=0;ke<32;++ke)Ye[ke]=0;for(ke=Ge;ke<ge;++ke)ae[ke]=0;Ge=ae.length;var Je=ve?new Uint16Array(Ge):Dt(Ge);for(ke=0;ke<Ge;++ke)Ye[Ne=ae[ke]]++,xe<Ne&&(xe=Ne),Je[ke]=0;for(Ye[0]=0,ke=1;ke<=xe;++ke)Ye[ke+16]=nt=nt+Ye[ke-1]<<1;for(ke=0;ke<Ge;++ke)nt=ae[ke],nt!=0&&(Je[ke]=Ye[nt+16]++);var kt=0;for(ke=0;ke<Ge;++ke)if(kt=ae[ke],kt!=0)for(nt=fe(Je[ke],xe)>>xe-kt,He=(1<<xe+4-kt)-1;He>=0;--He)Se[nt|He<<kt]=kt&15|ke<<4;return xe}var et=ve?new Uint16Array(512):Dt(512),ht=ve?new Uint16Array(32):Dt(32);if(!ve){for(var yt=0;yt<512;++yt)et[yt]=0;for(yt=0;yt<32;++yt)ht[yt]=0}(function(){for(var ae=[],Se=0;Se<32;Se++)ae.push(5);Wt(ae,ht,32);var ge=[];for(Se=0;Se<=143;Se++)ge.push(8);for(;Se<=255;Se++)ge.push(9);for(;Se<=279;Se++)ge.push(7);for(;Se<=287;Se++)ge.push(8);Wt(ge,et,288)})();var ft=(function(){for(var Se=ve?new Uint8Array(32768):[],ge=0,xe=0;ge<se.length-1;++ge)for(;xe<se[ge+1];++xe)Se[xe]=ge;for(;xe<32768;++xe)Se[xe]=29;var Ne=ve?new Uint8Array(259):[];for(ge=0,xe=0;ge<te.length-1;++ge)for(;xe<te[ge+1];++xe)Ne[xe]=ge;function ke(nt,Ge){for(var Ye=0;Ye<nt.length;){var Je=Math.min(65535,nt.length-Ye),kt=Ye+Je==nt.length;for(Ge.write_shift(1,+kt),Ge.write_shift(2,Je),Ge.write_shift(2,~Je&65535);Je-- >0;)Ge[Ge.l++]=nt[Ye++]}return Ge.l}function He(nt,Ge){for(var Ye=0,Je=0,kt=ve?new Uint16Array(32768):[];Je<nt.length;){var Rt=Math.min(65535,nt.length-Je);if(Rt<10){for(Ye=Be(Ge,Ye,+(Je+Rt==nt.length)),Ye&7&&(Ye+=8-(Ye&7)),Ge.l=Ye/8|0,Ge.write_shift(2,Rt),Ge.write_shift(2,~Rt&65535);Rt-- >0;)Ge[Ge.l++]=nt[Je++];Ye=Ge.l*8;continue}Ye=Be(Ge,Ye,+(Je+Rt==nt.length)+2);for(var qt=0;Rt-- >0;){var Ot=nt[Je];qt=(qt<<5^Ot)&32767;var Mt=-1,Xt=0;if((Mt=kt[qt])&&(Mt|=Je&-32768,Mt>Je&&(Mt-=32768),Mt<Je))for(;nt[Mt+Xt]==nt[Je+Xt]&&Xt<250;)++Xt;if(Xt>2){Ot=Ne[Xt],Ot<=22?Ye=Xe(Ge,Ye,_e[Ot+1]>>1)-1:(Xe(Ge,Ye,3),Ye+=5,Xe(Ge,Ye,_e[Ot-23]>>5),Ye+=3);var sa=Ot<8?0:Ot-4>>2;sa>0&&(lt(Ge,Ye,Xt-te[Ot]),Ye+=sa),Ot=Se[Je-Mt],Ye=Xe(Ge,Ye,_e[Ot]>>3),Ye-=3;var Lr=Ot<4?0:Ot-2>>1;Lr>0&&(lt(Ge,Ye,Je-Mt-se[Ot]),Ye+=Lr);for(var ca=0;ca<Xt;++ca)kt[qt]=Je&32767,qt=(qt<<5^nt[Je])&32767,++Je;Rt-=Xt-1}else Ot<=143?Ot=Ot+48:Ye=Et(Ge,Ye,1),Ye=Xe(Ge,Ye,_e[Ot]),kt[qt]=Je&32767,++Je}Ye=Xe(Ge,Ye,0)-1}return Ge.l=(Ye+7)/8|0,Ge.l}return function(Ge,Ye){return Ge.length<8?ke(Ge,Ye):He(Ge,Ye)}})();function pt(ae){var Se=ut(50+Math.floor(ae.length*1.1)),ge=ft(ae,Se);return Se.slice(0,ge)}var wt=ve?new Uint16Array(32768):Dt(32768),Lt=ve?new Uint16Array(32768):Dt(32768),Pt=ve?new Uint16Array(128):Dt(128),zt=1,Ce=1;function Ve(ae,Se){var ge=at(ae,Se)+257;Se+=5;var xe=at(ae,Se)+1;Se+=5;var Ne=he(ae,Se)+4;Se+=4;for(var ke=0,He=ve?new Uint8Array(19):Dt(19),nt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ge=1,Ye=ve?new Uint8Array(8):Dt(8),Je=ve?new Uint8Array(8):Dt(8),kt=He.length,Rt=0;Rt<Ne;++Rt)He[z[Rt]]=ke=mt(ae,Se),Ge<ke&&(Ge=ke),Ye[ke]++,Se+=3;var qt=0;for(Ye[0]=0,Rt=1;Rt<=Ge;++Rt)Je[Rt]=qt=qt+Ye[Rt-1]<<1;for(Rt=0;Rt<kt;++Rt)(qt=He[Rt])!=0&&(nt[Rt]=Je[qt]++);var Ot=0;for(Rt=0;Rt<kt;++Rt)if(Ot=He[Rt],Ot!=0){qt=_e[nt[Rt]]>>8-Ot;for(var Mt=(1<<7-Ot)-1;Mt>=0;--Mt)Pt[qt|Mt<<Ot]=Ot&7|Rt<<3}var Xt=[];for(Ge=1;Xt.length<ge+xe;)switch(qt=Pt[we(ae,Se)],Se+=qt&7,qt>>>=3){case 16:for(ke=3+st(ae,Se),Se+=2,qt=Xt[Xt.length-1];ke-- >0;)Xt.push(qt);break;case 17:for(ke=3+mt(ae,Se),Se+=3;ke-- >0;)Xt.push(0);break;case 18:for(ke=11+we(ae,Se),Se+=7;ke-- >0;)Xt.push(0);break;default:Xt.push(qt),Ge<qt&&(Ge=qt);break}var sa=Xt.slice(0,ge),Lr=Xt.slice(ge);for(Rt=ge;Rt<286;++Rt)sa[Rt]=0;for(Rt=xe;Rt<30;++Rt)Lr[Rt]=0;return zt=Wt(sa,wt,286),Ce=Wt(Lr,Lt,30),Se}function ce(ae,Se){if(ae[0]==3&&!(ae[1]&3))return[mu(Se),2];for(var ge=0,xe=0,Ne=lw(Se||1<<18),ke=0,He=Ne.length>>>0,nt=0,Ge=0;(xe&1)==0;){if(xe=mt(ae,ge),ge+=3,xe>>>1)xe>>1==1?(nt=9,Ge=5):(ge=Ve(ae,ge),nt=zt,Ge=Ce);else{ge&7&&(ge+=8-(ge&7));var Ye=ae[ge>>>3]|ae[(ge>>>3)+1]<<8;if(ge+=32,Ye>0)for(!Se&&He<ke+Ye&&(Ne=jt(Ne,ke+Ye),He=Ne.length);Ye-- >0;)Ne[ke++]=ae[ge>>>3],ge+=8;continue}for(;;){!Se&&He<ke+32767&&(Ne=jt(Ne,ke+32767),He=Ne.length);var Je=ye(ae,ge,nt),kt=xe>>>1==1?et[Je]:wt[Je];if(ge+=kt&15,kt>>>=4,(kt>>>8&255)===0)Ne[ke++]=kt;else{if(kt==256)break;kt-=257;var Rt=kt<8?0:kt-4>>2;Rt>5&&(Rt=0);var qt=ke+te[kt];Rt>0&&(qt+=ye(ae,ge,Rt),ge+=Rt),Je=ye(ae,ge,Ge),kt=xe>>>1==1?ht[Je]:Lt[Je],ge+=kt&15,kt>>>=4;var Ot=kt<4?0:kt-2>>1,Mt=se[kt];for(Ot>0&&(Mt+=ye(ae,ge,Ot),ge+=Ot),!Se&&He<qt&&(Ne=jt(Ne,qt+100),He=Ne.length);ke<qt;)Ne[ke]=Ne[ke-Mt],++ke}}}return Se?[Ne,ge+7>>>3]:[Ne.slice(0,ke),ge+7>>>3]}function Re(ae,Se){var ge=ae.slice(ae.l||0),xe=ce(ge,Se);return ae.l+=xe[1],xe[0]}function Me(ae,Se){if(ae)typeof console<"u"&&console.error(Se);else throw new Error(Se)}function Tt(ae,Se){var ge=ae;ys(ge,0);var xe=[],Ne=[],ke={FileIndex:xe,FullPaths:Ne};B(ke,{root:Se.root});for(var He=ge.length-4;(ge[He]!=80||ge[He+1]!=75||ge[He+2]!=5||ge[He+3]!=6)&&He>=0;)--He;ge.l=He+4,ge.l+=4;var nt=ge.read_shift(2);ge.l+=6;var Ge=ge.read_shift(4);for(ge.l=Ge,He=0;He<nt;++He){ge.l+=20;var Ye=ge.read_shift(4),Je=ge.read_shift(4),kt=ge.read_shift(2),Rt=ge.read_shift(2),qt=ge.read_shift(2);ge.l+=8;var Ot=ge.read_shift(4),Mt=c(ge.slice(ge.l+kt,ge.l+kt+Rt));ge.l+=kt+Rt+qt;var Xt=ge.l;ge.l=Ot+4,$t(ge,Ye,Je,ke,Mt),ge.l=Xt}return ke}function $t(ae,Se,ge,xe,Ne){ae.l+=2;var ke=ae.read_shift(2),He=ae.read_shift(2),nt=l(ae);if(ke&8257)throw new Error("Unsupported ZIP encryption");for(var Ge=ae.read_shift(4),Ye=ae.read_shift(4),Je=ae.read_shift(4),kt=ae.read_shift(2),Rt=ae.read_shift(2),qt="",Ot=0;Ot<kt;++Ot)qt+=String.fromCharCode(ae[ae.l++]);if(Rt){var Mt=c(ae.slice(ae.l,ae.l+Rt));(Mt[21589]||{}).mt&&(nt=Mt[21589].mt),((Ne||{})[21589]||{}).mt&&(nt=Ne[21589].mt)}ae.l+=Rt;var Xt=ae.slice(ae.l,ae.l+Ye);switch(He){case 8:Xt=F(ae,Je);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+He)}var sa=!1;ke&8&&(Ge=ae.read_shift(4),Ge==134695760&&(Ge=ae.read_shift(4),sa=!0),Ye=ae.read_shift(4),Je=ae.read_shift(4)),Ye!=Se&&Me(sa,"Bad compressed size: "+Se+" != "+Ye),Je!=ge&&Me(sa,"Bad uncompressed size: "+ge+" != "+Je),rn(xe,qt,Xt,{unsafe:!0,mt:nt})}function or(ae,Se){var ge=Se||{},xe=[],Ne=[],ke=ut(1),He=ge.compression?8:0,nt=0,Ge=0,Ye=0,Je=0,kt=0,Rt=ae.FullPaths[0],qt=Rt,Ot=ae.FileIndex[0],Mt=[],Xt=0;for(Ge=1;Ge<ae.FullPaths.length;++Ge)if(qt=ae.FullPaths[Ge].slice(Rt.length),Ot=ae.FileIndex[Ge],!(!Ot.size||!Ot.content||qt=="Sh33tJ5")){var sa=Je,Lr=ut(qt.length);for(Ye=0;Ye<qt.length;++Ye)Lr.write_shift(1,qt.charCodeAt(Ye)&127);Lr=Lr.slice(0,Lr.l),Mt[kt]=A8.buf(Ot.content,0);var ca=Ot.content;He==8&&(ca=I(ca)),ke=ut(30),ke.write_shift(4,67324752),ke.write_shift(2,20),ke.write_shift(2,nt),ke.write_shift(2,He),Ot.mt?s(ke,Ot.mt):ke.write_shift(4,0),ke.write_shift(-4,Mt[kt]),ke.write_shift(4,ca.length),ke.write_shift(4,Ot.content.length),ke.write_shift(2,Lr.length),ke.write_shift(2,0),Je+=ke.length,xe.push(ke),Je+=Lr.length,xe.push(Lr),Je+=ca.length,xe.push(ca),ke=ut(46),ke.write_shift(4,33639248),ke.write_shift(2,0),ke.write_shift(2,20),ke.write_shift(2,nt),ke.write_shift(2,He),ke.write_shift(4,0),ke.write_shift(-4,Mt[kt]),ke.write_shift(4,ca.length),ke.write_shift(4,Ot.content.length),ke.write_shift(2,Lr.length),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(4,0),ke.write_shift(4,sa),Xt+=ke.l,Ne.push(ke),Xt+=Lr.length,Ne.push(Lr),++kt}return ke=ut(22),ke.write_shift(4,101010256),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,kt),ke.write_shift(2,kt),ke.write_shift(4,Xt),ke.write_shift(4,Je),ke.write_shift(2,0),ss([ss(xe),ss(Ne),ke])}var Ht={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function mr(ae,Se){if(ae.ctype)return ae.ctype;var ge=ae.name||"",xe=ge.match(/\.([^\.]+)$/);return xe&&Ht[xe[1]]||Se&&(xe=(ge=Se).match(/[\.\\]([^\.\\])+$/),xe&&Ht[xe[1]])?Ht[xe[1]]:"application/octet-stream"}function Ca(ae){for(var Se=T0(ae),ge=[],xe=0;xe<Se.length;xe+=76)ge.push(Se.slice(xe,xe+76));return ge.join(`\r
`)+`\r
`}function Na(ae){var Se=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ye){var Je=Ye.charCodeAt(0).toString(16).toUpperCase();return"="+(Je.length==1?"0"+Je:Je)});Se=Se.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Se.charAt(0)==`
`&&(Se="=0D"+Se.slice(1)),Se=Se.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ge=[],xe=Se.split(`\r
`),Ne=0;Ne<xe.length;++Ne){var ke=xe[Ne];if(ke.length==0){ge.push("");continue}for(var He=0;He<ke.length;){var nt=76,Ge=ke.slice(He,He+nt);Ge.charAt(nt-1)=="="?nt--:Ge.charAt(nt-2)=="="?nt-=2:Ge.charAt(nt-3)=="="&&(nt-=3),Ge=ke.slice(He,He+nt),He+=nt,He<ke.length&&(Ge+="="),ge.push(Ge)}}return ge.join(`\r
`)}function Ct(ae){for(var Se=[],ge=0;ge<ae.length;++ge){for(var xe=ae[ge];ge<=ae.length&&xe.charAt(xe.length-1)=="=";)xe=xe.slice(0,xe.length-1)+ae[++ge];Se.push(xe)}for(var Ne=0;Ne<Se.length;++Ne)Se[Ne]=Se[Ne].replace(/[=][0-9A-Fa-f]{2}/g,function(ke){return String.fromCharCode(parseInt(ke.slice(1),16))});return Pi(Se.join(`\r
`))}function Oa(ae,Se,ge){for(var xe="",Ne="",ke="",He,nt=0;nt<10;++nt){var Ge=Se[nt];if(!Ge||Ge.match(/^\s*$/))break;var Ye=Ge.match(/^(.*?):\s*([^\s].*)$/);if(Ye)switch(Ye[1].toLowerCase()){case"content-location":xe=Ye[2].trim();break;case"content-type":ke=Ye[2].trim();break;case"content-transfer-encoding":Ne=Ye[2].trim();break}}switch(++nt,Ne.toLowerCase()){case"base64":He=Pi(qi(Se.slice(nt).join("")));break;case"quoted-printable":He=Ct(Se.slice(nt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Ne)}var Je=rn(ae,xe.slice(ge.length),He,{unsafe:!0});ke&&(Je.ctype=ke)}function ar(ae,Se){if(re(ae.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ge=Se&&Se.root||"",xe=(Pr&&Buffer.isBuffer(ae)?ae.toString("binary"):re(ae)).split(`\r
`),Ne=0,ke="";for(Ne=0;Ne<xe.length;++Ne)if(ke=xe[Ne],!!/^Content-Location:/i.test(ke)&&(ke=ke.slice(ke.indexOf("file")),ge||(ge=ke.slice(0,ke.lastIndexOf("/")+1)),ke.slice(0,ge.length)!=ge))for(;ge.length>0&&(ge=ge.slice(0,ge.length-1),ge=ge.slice(0,ge.lastIndexOf("/")+1),ke.slice(0,ge.length)!=ge););var He=(xe[1]||"").match(/boundary="(.*?)"/);if(!He)throw new Error("MAD cannot find boundary");var nt="--"+(He[1]||""),Ge=[],Ye=[],Je={FileIndex:Ge,FullPaths:Ye};B(Je);var kt,Rt=0;for(Ne=0;Ne<xe.length;++Ne){var qt=xe[Ne];qt!==nt&&qt!==nt+"--"||(Rt++&&Oa(Je,xe.slice(kt,Ne),ge),kt=Ne)}return Je}function za(ae,Se){var ge=Se||{},xe=ge.boundary||"SheetJS";xe="------="+xe;for(var Ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+xe.slice(2)+'"',"","",""],ke=ae.FullPaths[0],He=ke,nt=ae.FileIndex[0],Ge=1;Ge<ae.FullPaths.length;++Ge)if(He=ae.FullPaths[Ge].slice(ke.length),nt=ae.FileIndex[Ge],!(!nt.size||!nt.content||He=="Sh33tJ5")){He=He.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Xt){return"_x"+Xt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Xt){return"_u"+Xt.charCodeAt(0).toString(16)+"_"});for(var Ye=nt.content,Je=Pr&&Buffer.isBuffer(Ye)?Ye.toString("binary"):re(Ye),kt=0,Rt=Math.min(1024,Je.length),qt=0,Ot=0;Ot<=Rt;++Ot)(qt=Je.charCodeAt(Ot))>=32&&qt<128&&++kt;var Mt=kt>=Rt*4/5;Ne.push(xe),Ne.push("Content-Location: "+(ge.root||"file:///C:/SheetJS/")+He),Ne.push("Content-Transfer-Encoding: "+(Mt?"quoted-printable":"base64")),Ne.push("Content-Type: "+mr(nt,He)),Ne.push(""),Ne.push(Mt?Na(Je):Ca(Je))}return Ne.push(xe+`--\r
`),Ne.join(`\r
`)}function os(ae){var Se={};return B(Se,ae),Se}function rn(ae,Se,ge,xe){var Ne=xe&&xe.unsafe;Ne||B(ae);var ke=!Ne&&hr.find(ae,Se);if(!ke){var He=ae.FullPaths[0];Se.slice(0,He.length)==He?He=Se:(He.slice(-1)!="/"&&(He+="/"),He=(He+Se).replace("//","/")),ke={name:n(Se),type:2},ae.FileIndex.push(ke),ae.FullPaths.push(He),Ne||hr.utils.cfb_gc(ae)}return ke.content=ge,ke.size=ge?ge.length:0,xe&&(xe.CLSID&&(ke.clsid=xe.CLSID),xe.mt&&(ke.mt=xe.mt),xe.ct&&(ke.ct=xe.ct)),ke}function Mn(ae,Se){B(ae);var ge=hr.find(ae,Se);if(ge){for(var xe=0;xe<ae.FileIndex.length;++xe)if(ae.FileIndex[xe]==ge)return ae.FileIndex.splice(xe,1),ae.FullPaths.splice(xe,1),!0}return!1}function Ut(ae,Se,ge){B(ae);var xe=hr.find(ae,Se);if(xe){for(var Ne=0;Ne<ae.FileIndex.length;++Ne)if(ae.FileIndex[Ne]==xe)return ae.FileIndex[Ne].name=n(ge),ae.FullPaths[Ne]=ge,!0}return!1}function er(ae){L(ae,!0)}return e.find=D,e.read=W,e.parse=m,e.write=de,e.writeFile=K,e.utils={cfb_new:os,cfb_add:rn,cfb_del:Mn,cfb_mov:Ut,cfb_gc:er,ReadShift:d0,CheckField:M3,prep_blob:ys,bconcat:ss,use_zlib:k,_deflateRaw:pt,_inflateRaw:Re,consts:Z},e})();function C8(t){return typeof t=="string"?p1(t):Array.isArray(t)?t8(t):t}function X0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=p1(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var a=r=="utf8"?kl(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,t);if(typeof Blob<"u"){var n=new Blob([C8(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,t);if(typeof saveAs<"u")return saveAs(n,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(t);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=_u(e)),c.write(e),c.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function T8(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+t)}function pn(t){for(var e=Object.keys(t),r=[],a=0;a<e.length;++a)Object.prototype.hasOwnProperty.call(t,e[a])&&r.push(e[a]);return r}function gw(t,e){for(var r=[],a=pn(t),n=0;n!==a.length;++n)r[t[a[n]][e]]==null&&(r[t[a[n]][e]]=a[n]);return r}function v1(t){for(var e=[],r=pn(t),a=0;a!==r.length;++a)e[t[r[a]]]=r[a];return e}function x1(t){for(var e=[],r=pn(t),a=0;a!==r.length;++a)e[t[r[a]]]=parseInt(r[a],10);return e}function O8(t){for(var e=[],r=pn(t),a=0;a!==r.length;++a)e[t[r[a]]]==null&&(e[t[r[a]]]=[]),e[t[r[a]]].push(r[a]);return e}var Xp=new Date(1899,11,30,0,0,0);function Kn(t,e){var r=t.getTime(),a=Xp.getTime()+(t.getTimezoneOffset()-Xp.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var g3=new Date,R8=Xp.getTime()+(g3.getTimezoneOffset()-Xp.getTimezoneOffset())*6e4,vw=g3.getTimezoneOffset();function y1(t){var e=new Date;return e.setTime(t*24*60*60*1e3+R8),e.getTimezoneOffset()!==vw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-vw)*6e4),e}function D8(t){var e=0,r=0,a=!1,n=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(n[s],10)}return e}var xw=new Date("2017-02-19T19:06:09.000Z"),v3=isNaN(xw.getFullYear())?new Date("2/19/17"):xw,F8=v3.getFullYear()==2017;function Ua(t,e){var r=new Date(t);if(F8)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(v3.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return t.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function xf(t,e){if(Pr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return kl(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return kl(n3(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return kl(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return kl(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var a=[],n=0;n!=t.length;++n)a.push(String.fromCharCode(t[n]));return a.join("")}function qa(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=qa(t[r]));return e}function hn(t,e){for(var r="";r.length<e;)r+=t;return r}function Yo(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,a=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return r=-r,s}),!isNaN(e=Number(a)))?e/r:e}var L8=["january","february","march","april","may","june","july","august","september","october","november","december"];function sh(t){var e=new Date(t),r=new Date(NaN),a=e.getYear(),n=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&L8.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&a!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var P8=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(t||typeof a=="string")return r.split(a);for(var s=r.split(a),l=[s[0]],c=1;c<s.length;++c)l.push(n),l.push(s[c]);return l}})();function x3(t){return t?t.content&&t.type?xf(t.content,!0):t.data?i0(t.data):t.asNodeBuffer&&Pr?i0(t.asNodeBuffer().toString("binary")):t.asBinary?i0(t.asBinary()):t._data&&t._data.getContent?i0(xf(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function y3(t){if(!t)return null;if(t.data)return iw(t.data);if(t.asNodeBuffer&&Pr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?iw(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function M8(t){return t&&t.name.slice(-4)===".bin"?y3(t):x3(t)}function lo(t,e){for(var r=t.FullPaths||pn(t.files),a=e.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||n==l)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function l2(t,e){var r=lo(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Fn(t,e,r){if(!r)return M8(l2(t,e));if(!e)return null;try{return Fn(t,e)}catch{return null}}function Mi(t,e,r){if(!r)return x3(l2(t,e));if(!e)return null;try{return Mi(t,e)}catch{return null}}function I8(t,e,r){return y3(l2(t,e))}function yw(t){for(var e=t.FullPaths||pn(t.files),r=[],a=0;a<e.length;++a)e[a].slice(-1)!="/"&&r.push(e[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Dr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var a;return Pr?a=vc(r):a=r8(r),hr.utils.cfb_add(t,e,a)}hr.utils.cfb_add(t,e,r)}else t.file(e,r)}function c2(){return hr.utils.cfb_new()}function _3(t,e){switch(e.type){case"base64":return hr.read(t,{type:"base64"});case"binary":return hr.read(t,{type:"binary"});case"buffer":case"array":return hr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function l0(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var a=t.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var En=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,B8=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,_w=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,U8=/<[^>]*>/g,Ms=En.match(_w)?_w:U8,q8=/<\w*:/,z8=/<(\/?)\w+:/;function Sr(t,e,r){for(var a={},n=0,s=0;n!==t.length&&!((s=t.charCodeAt(n))===32||s===10||s===13);++n);if(e||(a[0]=t.slice(0,n)),n===t.length)return a;var l=t.match(B8),c=0,f="",d=0,m="",v="",x=1;if(l)for(d=0;d!=l.length;++d){for(v=l[d],s=0;s!=v.length&&v.charCodeAt(s)!==61;++s);for(m=v.slice(0,s).trim();v.charCodeAt(s+1)==32;)++s;for(x=(n=v.charCodeAt(s+1))==34||n==39?1:0,f=v.slice(s+1+x,v.length-x),c=0;c!=m.length&&m.charCodeAt(c)!==58;++c);if(c===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),a[m]=f,a[m.toLowerCase()]=f;else{var g=(c===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(c+1);if(a[g]&&m.slice(c-3,c)=="ext")continue;a[g]=f,a[g.toLowerCase()]=f}}return a}function Al(t){return t.replace(z8,"<$1")}var b3={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},u2=v1(b3),Qr=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(t,function(c,f){return b3[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,f){return String.fromCharCode(parseInt(f,16))});var l=n.indexOf("]]>");return r(n.slice(0,s))+n.slice(s+9,l)+r(n.slice(l+3))}})(),f2=/[&<>'"]/g,H8=/[\u0000-\u0008\u000b-\u001f]/g;function ga(t){var e=t+"";return e.replace(f2,function(r){return u2[r]}).replace(H8,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function bw(t){return ga(t).replace(/ /g,"_x0020_")}var w3=/[\u0000-\u001f]/g;function d2(t){var e=t+"";return e.replace(f2,function(r){return u2[r]}).replace(/\n/g,"<br/>").replace(w3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function $8(t){var e=t+"";return e.replace(f2,function(r){return u2[r]}).replace(w3,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var ww=(function(){var t=/&#(\d+);/g;function e(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(t,e)}})();function W8(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ia(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function nv(t){for(var e="",r=0,a=0,n=0,s=0,l=0,c=0;r<t.length;){if(a=t.charCodeAt(r++),a<128){e+=String.fromCharCode(a);continue}if(n=t.charCodeAt(r++),a>191&&a<224){l=(a&31)<<6,l|=n&63,e+=String.fromCharCode(l);continue}if(s=t.charCodeAt(r++),a<240){e+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}l=t.charCodeAt(r++),c=((a&7)<<18|(n&63)<<12|(s&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function Sw(t){var e=mu(2*t.length),r,a,n=1,s=0,l=0,c;for(a=0;a<t.length;a+=n)n=1,(c=t.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(t.charCodeAt(a+1)&63),n=2):c<240?(r=(c&15)*4096+(t.charCodeAt(a+1)&63)*64+(t.charCodeAt(a+2)&63),n=3):(n=4,r=(c&7)*262144+(t.charCodeAt(a+1)&63)*4096+(t.charCodeAt(a+2)&63)*64+(t.charCodeAt(a+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(e[s++]=l&255,e[s++]=l>>>8,l=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Nw(t){return vc(t,"binary").toString("utf8")}var cp="foo bar baz",Sa=Pr&&(Nw(cp)==nv(cp)&&Nw||Sw(cp)==nv(cp)&&Sw)||nv,kl=Pr?function(t){return vc(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,a=0,n=0;r<t.length;)switch(a=t.charCodeAt(r++),!0){case a<128:e.push(String.fromCharCode(a));break;case a<2048:e.push(String.fromCharCode(192+(a>>6))),e.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=t.charCodeAt(r++)-56320+(a<<10),e.push(String.fromCharCode(240+(n>>18&7))),e.push(String.fromCharCode(144+(n>>12&63))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)));break;default:e.push(String.fromCharCode(224+(a>>12))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)))}return e.join("")},R0=(function(){var t={};return function(r,a){var n=r+"|"+(a||"");return t[n]?t[n]:t[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),S3=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<t.length;++n)a=a.replace(t[n][0],t[n][1]);return a}})(),V8=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),G8=/<\/?(?:vt:)?variant>/g,Y8=/<(?:vt:)([^>]*)>([\s\S]*)</;function kw(t,e){var r=Sr(t),a=t.match(V8(r.baseType))||[],n=[];if(a.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(s){var l=s.replace(G8,"").match(Y8);l&&n.push({v:Sa(l[2]),t:l[1]})}),n}var N3=/(^\s|\s$|\n)/;function _s(t,e){return"<"+t+(e.match(N3)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function D0(t){return pn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ft(t,e,r){return"<"+t+(r!=null?D0(r):"")+(e!=null?(e.match(N3)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function px(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function X8(t,e){switch(typeof t){case"string":var r=Ft("vt:lpwstr",ga(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ft((t|0)==t?"vt:i4":"vt:r8",ga(String(t)));case"boolean":return Ft("vt:bool",t?"true":"false")}if(t instanceof Date)return Ft("vt:filetime",px(t));throw new Error("Unable to serialize "+t)}function h2(t){if(Pr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Sa(_u(s2(t)));throw new Error("Bad input format: expected Buffer or string")}var F0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Xn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Cf=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ri={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function K8(t,e){for(var r=1-2*(t[e+7]>>>7),a=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),n=t[e+6]&15,s=5;s>=0;--s)n=n*256+t[e+s];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function J8(t,e,r){var a=(e<0||1/e==-1/0?1:0)<<7,n=0,s=0,l=a?-e:e;isFinite(l)?l==0?n=s=0:(n=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(e)?26985:0);for(var c=0;c<=5;++c,s/=256)t[r+c]=s&255;t[r+6]=(n&15)<<4|s&15,t[r+7]=n>>4|a}var jw=function(t){for(var e=[],r=10240,a=0;a<t[0].length;++a)if(t[0][a])for(var n=0,s=t[0][a].length;n<s;n+=r)e.push.apply(e,t[0][a].slice(n,n+r));return e},Ew=Pr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:vc(e)})):jw(t)}:jw,Aw=function(t,e,r){for(var a=[],n=e;n<r;n+=2)a.push(String.fromCharCode(lc(t,n)));return a.join("").replace(Gs,"")},m2=Pr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Gs,""):Aw(t,e,r)}:Aw,Cw=function(t,e,r){for(var a=[],n=e;n<e+r;++n)a.push(("0"+t[n].toString(16)).slice(-2));return a.join("")},k3=Pr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Cw(t,e,r)}:Cw,Tw=function(t,e,r){for(var a=[],n=e;n<r;n++)a.push(String.fromCharCode(qd(t,n)));return a.join("")},K0=Pr?function(e,r,a){return Buffer.isBuffer(e)?e.toString("utf8",r,a):Tw(e,r,a)}:Tw,j3=function(t,e){var r=Di(t,e);return r>0?K0(t,e+4,e+4+r-1):""},E3=j3,A3=function(t,e){var r=Di(t,e);return r>0?K0(t,e+4,e+4+r-1):""},C3=A3,T3=function(t,e){var r=2*Di(t,e);return r>0?K0(t,e+4,e+4+r-1):""},O3=T3,R3=function(e,r){var a=Di(e,r);return a>0?m2(e,r+4,r+4+a):""},D3=R3,F3=function(t,e){var r=Di(t,e);return r>0?K0(t,e+4,e+4+r):""},L3=F3,P3=function(t,e){return K8(t,e)},Kp=P3,p2=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Pr&&(E3=function(e,r){if(!Buffer.isBuffer(e))return j3(e,r);var a=e.readUInt32LE(r);return a>0?e.toString("utf8",r+4,r+4+a-1):""},C3=function(e,r){if(!Buffer.isBuffer(e))return A3(e,r);var a=e.readUInt32LE(r);return a>0?e.toString("utf8",r+4,r+4+a-1):""},O3=function(e,r){if(!Buffer.isBuffer(e))return T3(e,r);var a=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+a-1)},D3=function(e,r){if(!Buffer.isBuffer(e))return R3(e,r);var a=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+a)},L3=function(e,r){if(!Buffer.isBuffer(e))return F3(e,r);var a=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+a)},Kp=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):P3(e,r)},p2=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var qd=function(t,e){return t[e]},lc=function(t,e){return t[e+1]*256+t[e]},Z8=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Di=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},of=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Q8=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function d0(t,e){var r="",a,n,s=[],l,c,f,d;switch(e){case"dbcs":if(d=this.l,Pr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)r+=String.fromCharCode(lc(this,d)),d+=2;t*=2;break;case"utf8":r=K0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=m2(this,this.l,this.l+t);break;case"wstr":return d0.call(this,t,"dbcs");case"lpstr-ansi":r=E3(this,this.l),t=4+Di(this,this.l);break;case"lpstr-cp":r=C3(this,this.l),t=4+Di(this,this.l);break;case"lpwstr":r=O3(this,this.l),t=4+2*Di(this,this.l);break;case"lpp4":t=4+Di(this,this.l),r=D3(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Di(this,this.l),r=L3(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(l=qd(this,this.l+t++))!==0;)s.push(lp(l));r=s.join("");break;case"_wstr":for(t=0,r="";(l=lc(this,this.l+t))!==0;)s.push(lp(l)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",d=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=qd(this,d),this.l=d+1,c=d0.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(lp(lc(this,d))),d+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=qd(this,d),this.l=d+1,c=d0.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(lp(qd(this,d))),d+=1}r=s.join("");break;default:switch(t){case 1:return a=qd(this,this.l),this.l++,a;case 2:return a=(e==="i"?Z8:lc)(this,this.l),this.l+=2,a;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(a=(t>0?of:Q8)(this,this.l),this.l+=4,a):(n=Di(this,this.l),this.l+=4,n);case 8:case-8:if(e==="f")return t==8?n=Kp(this,this.l):n=Kp([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;t=8;case 16:r=k3(this,this.l,t);break}}return this.l+=t,r}var eO=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},tO=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},rO=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function aO(t,e,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=e.length;++n)rO(this,e.charCodeAt(n),this.l+2*n);a=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=e.length;++n)this[this.l+n]=e.charCodeAt(n)&255;a=e.length}else if(r==="hex"){for(;n<t;++n)this[this.l++]=parseInt(e.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(n=0;n<Math.min(e.length,t);++n){var l=e.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:a=1,this[this.l]=e&255;break;case 2:a=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:a=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:a=4,eO(this,e,this.l);break;case 8:if(a=8,r==="f"){J8(this,e,this.l);break}case 16:break;case-4:a=4,tO(this,e,this.l);break}return this.l+=a,this}function M3(t,e){var r=k3(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ys(t,e){t.l=e,t.read_shift=d0,t.chk=M3,t.write_shift=aO}function Ps(t,e){t.l+=e}function ut(t){var e=mu(t);return ys(e,0),e}function xc(t,e,r){if(t){var a,n,s;ys(t,t.l||0);for(var l=t.length,c=0,f=0;t.l<l;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var d=U0[c]||U0[65535];for(a=t.read_shift(1),s=a&127,n=1;n<4&&a&128;++n)s+=((a=t.read_shift(1))&127)<<7*n;f=t.l+s;var m=d.f&&d.f(t,s,r);if(t.l=f,e(m,d,c))return}}}function di(){var t=[],e=Pr?256:2048,r=function(d){var m=ut(d);return ys(m,0),m},a=r(e),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&t.push(a),a=null)},s=function(d){return a&&d<a.length-a.l?a:(n(),a=r(Math.max(d+1,e)))},l=function(){return n(),ss(t)},c=function(d){n(),a=d,a.l==null&&(a.l=a.length),s(e)};return{next:s,push:c,end:l,_bufs:t}}function Nt(t,e,r,a){var n=+e,s;if(!isNaN(n)){a||(a=U0[n].p||(r||[]).length||0),s=1+(n>=128?1:0)+1,a>=128&&++s,a>=16384&&++s,a>=2097152&&++s;var l=t.next(s);n<=127?l.write_shift(1,n):(l.write_shift(1,(n&127)+128),l.write_shift(1,n>>7));for(var c=0;c!=4;++c)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&p2(r)&&t.push(r)}}function h0(t,e,r){var a=qa(t);if(e.s?(a.cRel&&(a.c+=e.s.c),a.rRel&&(a.r+=e.s.r)):(a.cRel&&(a.c+=e.c),a.rRel&&(a.r+=e.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Ow(t,e,r){var a=qa(t);return a.s=h0(a.s,e.s,r),a.e=h0(a.e,e.s,r),a}function m0(t,e){if(t.cRel&&t.c<0)for(t=qa(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=qa(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=wr(t);return!t.cRel&&t.cRel!=null&&(r=iO(r)),!t.rRel&&t.rRel!=null&&(r=nO(r)),r}function sv(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+en(t.s.c)+":"+(t.e.cRel?"":"$")+en(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+jn(t.s.r)+":"+(t.e.rRel?"":"$")+jn(t.e.r):m0(t.s,e.biff)+":"+m0(t.e,e.biff)}function g2(t){return parseInt(sO(t),10)-1}function jn(t){return""+(t+1)}function nO(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function sO(t){return t.replace(/\$(\d+)$/,"$1")}function v2(t){for(var e=oO(t),r=0,a=0;a!==e.length;++a)r=26*r+e.charCodeAt(a)-64;return r-1}function en(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function iO(t){return t.replace(/^([A-Z])/,"$$$1")}function oO(t){return t.replace(/^\$([A-Z])/,"$1")}function lO(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function tn(t){for(var e=0,r=0,a=0;a<t.length;++a){var n=t.charCodeAt(a);n>=48&&n<=57?e=10*e+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:e-1}}function wr(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function hi(t){var e=t.indexOf(":");return e==-1?{s:tn(t),e:tn(t)}:{s:tn(t.slice(0,e)),e:tn(t.slice(e+1))}}function Or(t,e){return typeof e>"u"||typeof e=="number"?Or(t.s,t.e):(typeof t!="string"&&(t=wr(t)),typeof e!="string"&&(e=wr(e)),t==e?t:t+":"+e)}function ea(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=t.length;for(r=0;a<s&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(e.s.c=--r,r=0;a<s&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(e.s.r=--r,a===s||n!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++a,r=0;a!=s&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(e.e.c=--r,r=0;a!=s&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return e.e.r=--r,e}function Rw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=fo(t.z,r?Kn(e):e)}catch{}try{return t.w=fo((t.XF||{}).numFmtId||(r?14:0),r?Kn(e):e)}catch{return""+e}}function mc(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?yc[t.v]||t.v:e==null?Rw(t,t.v):Rw(t,e))}function bu(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",a={};return a[r]=t,{SheetNames:[r],Sheets:a}}function I3(t,e,r){var a=r||{},n=t?Array.isArray(t):a.dense,s=t||(n?[]:{}),l=0,c=0;if(s&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var f=typeof a.origin=="string"?tn(a.origin):a.origin;l=f.r,c=f.c}s["!ref"]||(s["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var m=ea(s["!ref"]);d.s.c=m.s.c,d.s.r=m.s.r,d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(d.e.r=l=m.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[v].length;++x)if(!(typeof e[v][x]>"u")){var g={v:e[v][x]},b=l+v,_=c+x;if(d.s.r>b&&(d.s.r=b),d.s.c>_&&(d.s.c=_),d.e.r<b&&(d.e.r=b),d.e.c<_&&(d.e.c=_),e[v][x]&&typeof e[v][x]=="object"&&!Array.isArray(e[v][x])&&!(e[v][x]instanceof Date))g=e[v][x];else if(Array.isArray(g.v)&&(g.f=e[v][x][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(a.nullError)g.t="e",g.v=0;else if(a.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=a.dateNF||_r[14],a.cellDates?(g.t="d",g.w=fo(g.z,Kn(g.v))):(g.t="n",g.v=Kn(g.v),g.w=fo(g.z,g.v))):g.t="s";if(n)s[b]||(s[b]=[]),s[b][_]&&s[b][_].z&&(g.z=s[b][_].z),s[b][_]=g;else{var w=wr({c:_,r:b});s[w]&&s[w].z&&(g.z=s[w].z),s[w]=g}}}return d.s.c<1e7&&(s["!ref"]=Or(d)),s}function mh(t,e){return I3(null,t,e)}function cO(t){return t.read_shift(4,"i")}function Xo(t,e){return e||(e=ut(4)),e.write_shift(4,t),e}function Ls(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function is(t,e){var r=!1;return e==null&&(r=!0,e=ut(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function uO(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function fO(t,e){return e||(e=ut(4)),e.write_shift(2,0),e.write_shift(2,0),e}function x2(t,e){var r=t.l,a=t.read_shift(1),n=Ls(t),s=[],l={t:n,h:n};if((a&1)!==0){for(var c=t.read_shift(4),f=0;f!=c;++f)s.push(uO(t));l.r=s}else l.r=[{ich:0,ifnt:0}];return t.l=r+e,l}function dO(t,e){var r=!1;return e==null&&(r=!0,e=ut(15+4*t.t.length)),e.write_shift(1,0),is(t.t,e),r?e.slice(0,e.l):e}var hO=x2;function mO(t,e){var r=!1;return e==null&&(r=!0,e=ut(23+4*t.t.length)),e.write_shift(1,1),is(t.t,e),e.write_shift(4,1),fO({},e),r?e.slice(0,e.l):e}function mo(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Tf(t,e){return e==null&&(e=ut(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Of(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Rf(t,e){return e==null&&(e=ut(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var pO=Ls,B3=is;function y2(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Jp(t,e){var r=!1;return e==null&&(r=!0,e=ut(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var gO=Ls,gx=y2,_2=Jp;function b2(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,a=e[0]&2;t.l+=4;var n=a===0?Kp([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):of(e,0)>>2;return r?n/100:n}function U3(t,e){e==null&&(e=ut(4));var r=0,a=0,n=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)e.write_shift(-4,((r?n:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function q3(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function vO(t,e){return e||(e=ut(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Df=q3,ph=vO;function Fs(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function yf(t,e){return(e||ut(8)).write_shift(8,t,"f")}function xO(t){var e={},r=t.read_shift(1),a=r>>>1,n=t.read_shift(1),s=t.read_shift(2,"i"),l=t.read_shift(1),c=t.read_shift(1),f=t.read_shift(1);switch(t.l++,a){case 0:e.auto=1;break;case 1:e.index=n;var d=df[n];d&&(e.rgb=P0(d));break;case 2:e.rgb=P0([l,c,f]);break;case 3:e.theme=n;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Zp(t,e){if(e||(e=ut(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var a=t.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),e.write_shift(1,parseInt(a.slice(0,2),16)),e.write_shift(1,parseInt(a.slice(2,4),16)),e.write_shift(1,parseInt(a.slice(4,6),16)),e.write_shift(1,255)}return e}function yO(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function _O(t,e){e||(e=ut(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function z3(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=t.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function bO(t){return z3(t,1)}function wO(t){return z3(t,2)}var w2=2,fi=3,up=11,Dw=12,Qp=19,fp=64,SO=65,NO=71,kO=4108,jO=4126,as=80,H3=81,EO=[as,H3],vx={1:{n:"CodePage",t:w2},2:{n:"Category",t:as},3:{n:"PresentationFormat",t:as},4:{n:"ByteCount",t:fi},5:{n:"LineCount",t:fi},6:{n:"ParagraphCount",t:fi},7:{n:"SlideCount",t:fi},8:{n:"NoteCount",t:fi},9:{n:"HiddenCount",t:fi},10:{n:"MultimediaClipCount",t:fi},11:{n:"ScaleCrop",t:up},12:{n:"HeadingPairs",t:kO},13:{n:"TitlesOfParts",t:jO},14:{n:"Manager",t:as},15:{n:"Company",t:as},16:{n:"LinksUpToDate",t:up},17:{n:"CharacterCount",t:fi},19:{n:"SharedDoc",t:up},22:{n:"HyperlinksChanged",t:up},23:{n:"AppVersion",t:fi,p:"version"},24:{n:"DigSig",t:SO},26:{n:"ContentType",t:as},27:{n:"ContentStatus",t:as},28:{n:"Language",t:as},29:{n:"Version",t:as},255:{},2147483648:{n:"Locale",t:Qp},2147483651:{n:"Behavior",t:Qp},1919054434:{}},xx={1:{n:"CodePage",t:w2},2:{n:"Title",t:as},3:{n:"Subject",t:as},4:{n:"Author",t:as},5:{n:"Keywords",t:as},6:{n:"Comments",t:as},7:{n:"Template",t:as},8:{n:"LastAuthor",t:as},9:{n:"RevNumber",t:as},10:{n:"EditTime",t:fp},11:{n:"LastPrinted",t:fp},12:{n:"CreatedDate",t:fp},13:{n:"ModifiedDate",t:fp},14:{n:"PageCount",t:fi},15:{n:"WordCount",t:fi},16:{n:"CharCount",t:fi},17:{n:"Thumbnail",t:NO},18:{n:"Application",t:as},19:{n:"DocSecurity",t:fi},255:{},2147483648:{n:"Locale",t:Qp},2147483651:{n:"Behavior",t:Qp},1919054434:{}},Fw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},AO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function CO(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var TO=CO([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),df=qa(TO),yc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},$3={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},yx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},dp={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function S2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function OO(t){var e=S2();if(!t||!t.match)return e;var r={};if((t.match(Ms)||[]).forEach(function(a){var n=Sr(a);switch(n[0].replace(q8,"<")){case"<?xml":break;case"<Types":e.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":e[yx[n.ContentType]]!==void 0&&e[yx[n.ContentType]].push(n.PartName);break}}),e.xmlns!==Xn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function W3(t,e){var r=O8(yx),a=[],n;a[a.length]=En,a[a.length]=Ft("Types",null,{xmlns:Xn.CT,"xmlns:xsd":Xn.xsd,"xmlns:xsi":Xn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Ft("Default",null,{Extension:f[0],ContentType:f[1]})}));var s=function(f){t[f]&&t[f].length>0&&(n=t[f][0],a[a.length]=Ft("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:dp[f][e.bookType]||dp[f].xlsx}))},l=function(f){(t[f]||[]).forEach(function(d){a[a.length]=Ft("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:dp[f][e.bookType]||dp[f].xlsx})})},c=function(f){(t[f]||[]).forEach(function(d){a[a.length]=Ft("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[f][0]})})};return s("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Ir={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function L0(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function p0(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var a={};return(t.match(Ms)||[]).forEach(function(n){var s=Sr(n);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:l0(s.Target,e);r[c]=l,a[s.Id]=l}}),r["!id"]=a,r}function Kd(t){var e=[En,Ft("Relationships",null,{xmlns:Xn.RELS})];return pn(t["!id"]).forEach(function(r){e[e.length]=Ft("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ma(t,e,r,a,n,s){if(n||(n={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,n.Id="rId"+e,n.Type=a,n.Target=r,[Ir.HLINK,Ir.XPATH,Ir.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),t["!id"][n.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][n.Id]=n,t[("/"+n.Target).replace("//","/")]=n,e}var RO="application/vnd.oasis.opendocument.spreadsheet";function DO(t,e){for(var r=h2(t),a,n;a=F0.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=Sr(a[0],!1),n.path=="/"&&n.type!==RO)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw a}}function FO(t){var e=[En];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Lw(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function LO(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function PO(t){var e=[En];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Lw(t[r][0],t[r][1])),e.push(LO("",t[r][0]));return e.push(Lw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function V3(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Wp.version+"</meta:generator></office:meta></office:document-meta>"}var uo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],MO=(function(){for(var t=new Array(uo.length),e=0;e<uo.length;++e){var r=uo[e],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return t})();function G3(t){var e={};t=Sa(t);for(var r=0;r<uo.length;++r){var a=uo[r],n=t.match(MO[r]);n!=null&&n.length>0&&(e[a[1]]=Qr(n[1])),a[2]==="date"&&e[a[1]]&&(e[a[1]]=Ua(e[a[1]]))}return e}function iv(t,e,r,a,n){n[t]!=null||e==null||e===""||(n[t]=e,e=ga(e),a[a.length]=r?Ft(t,e,r):_s(t,e))}function Y3(t,e){var r=e||{},a=[En,Ft("cp:coreProperties",null,{"xmlns:cp":Xn.CORE_PROPS,"xmlns:dc":Xn.dc,"xmlns:dcterms":Xn.dcterms,"xmlns:dcmitype":Xn.dcmitype,"xmlns:xsi":Xn.xsi})],n={};if(!t&&!r.Props)return a.join("");t&&(t.CreatedDate!=null&&iv("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:px(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),t.ModifiedDate!=null&&iv("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:px(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var s=0;s!=uo.length;++s){var l=uo[s],c=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:t?t[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&iv(l[0],c,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var hf=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],X3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function K3(t,e,r,a){var n=[];if(typeof t=="string")n=kw(t,a);else for(var s=0;s<t.length;++s)n=n.concat(t[s].map(function(m){return{v:m}}));var l=typeof e=="string"?kw(e,a).map(function(m){return m.v}):e,c=0,f=0;if(l.length>0)for(var d=0;d!==n.length;d+=2){switch(f=+n[d+1].v,n[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=l.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=l.slice(c,c+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=l.slice(c,c+f);break}c+=f}}function IO(t,e,r){var a={};return e||(e={}),t=Sa(t),hf.forEach(function(n){var s=(t.match(R0(n[0]))||[])[1];switch(n[2]){case"string":s&&(e[n[1]]=Qr(s));break;case"bool":e[n[1]]=s==="true";break;case"raw":var l=t.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(a[n[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&K3(a.HeadingPairs,a.TitlesOfParts,e,r),e}function J3(t){var e=[],r=Ft;return t||(t={}),t.Application="SheetJS",e[e.length]=En,e[e.length]=Ft("Properties",null,{xmlns:Xn.EXT_PROPS,"xmlns:vt":Xn.vt}),hf.forEach(function(a){if(t[a[1]]!==void 0){var n;switch(a[2]){case"string":n=ga(String(t[a[1]]));break;case"bool":n=t[a[1]]?"true":"false";break}n!==void 0&&(e[e.length]=r(a[0],n))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(a){return"<vt:lpstr>"+ga(a)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var BO=/<[^>]+>[^<]*/g;function UO(t,e){var r={},a="",n=t.match(BO);if(n)for(var s=0;s!=n.length;++s){var l=n[s],c=Sr(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Qr(c.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),d=f[0].slice(4),m=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=Qr(m);break;case"bool":r[a]=Ia(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(m);break;case"filetime":case"date":r[a]=Ua(m);break;case"cy":case"error":r[a]=Qr(m);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,f)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return r}function Z3(t){var e=[En,Ft("Properties",null,{xmlns:Xn.CUST_PROPS,"xmlns:vt":Xn.vt})];if(!t)return e.join("");var r=1;return pn(t).forEach(function(n){++r,e[e.length]=Ft("property",X8(t[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ga(n)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var _x={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ov;function qO(t,e,r){ov||(ov=v1(_x)),e=ov[e]||e,t[e]=r}function zO(t,e){var r=[];return pn(_x).map(function(a){for(var n=0;n<uo.length;++n)if(uo[n][1]==a)return uo[n];for(n=0;n<hf.length;++n)if(hf[n][1]==a)return hf[n];throw a}).forEach(function(a){if(t[a[1]]!=null){var n=e&&e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:t[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(_s(_x[a[1]]||a[1],n))}}),Ft("DocumentProperties",r.join(""),{xmlns:Ri.o})}function HO(t,e){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return t&&pn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var l=0;l<uo.length;++l)if(s==uo[l][1])return;for(l=0;l<hf.length;++l)if(s==hf[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var c=t[s],f="string";typeof c=="number"?(f="float",c=String(c)):c===!0||c===!1?(f="boolean",c=c?"1":"0"):c=String(c),n.push(Ft(bw(s),c,{"dt:dt":f}))}}),e&&pn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),n.push(Ft(bw(s),l,{"dt:dt":c}))}}),"<"+a+' xmlns="'+Ri.o+'">'+n.join("")+"</"+a+">"}function N2(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function $O(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var s=a/Math.pow(2,32)|0;s>0&&(a=a%Math.pow(2,32),n+=s);var l=ut(8);return l.write_shift(4,a),l.write_shift(4,n),l}function Q3(t,e,r){var a=t.l,n=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-a&3;)++t.l;return n}function eN(t,e,r){var a=t.read_shift(0,"lpwstr");return a}function tN(t,e,r){return e===31?eN(t):Q3(t,e,r)}function bx(t,e,r){return tN(t,e,r===!1?0:4)}function WO(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return tN(t,e,0)}function VO(t){for(var e=t.read_shift(4),r=[],a=0;a!=e;++a){var n=t.l;r[a]=t.read_shift(0,"lpwstr").replace(Gs,""),t.l-n&2&&(t.l+=2)}return r}function GO(t){for(var e=t.read_shift(4),r=[],a=0;a!=e;++a)r[a]=t.read_shift(0,"lpstr-cp").replace(Gs,"");return r}function YO(t){var e=t.l,r=e1(t,H3);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var a=e1(t,fi);return[r,a]}function XO(t){for(var e=t.read_shift(4),r=[],a=0;a<e/2;++a)r.push(YO(t));return r}function Pw(t,e){for(var r=t.read_shift(4),a={},n=0;n!=r;++n){var s=t.read_shift(4),l=t.read_shift(4);a[s]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(Gs,"").replace(o0,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),a}function rN(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function KO(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function e1(t,e,r){var a=t.read_shift(2),n,s=r||{};if(t.l+=2,e!==Dw&&a!==e&&EO.indexOf(e)===-1&&!((e&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+e+" saw "+a);switch(e===Dw?a:e){case 2:return n=t.read_shift(2,"i"),s.raw||(t.l+=2),n;case 3:return n=t.read_shift(4,"i"),n;case 11:return t.read_shift(4)!==0;case 19:return n=t.read_shift(4),n;case 30:return Q3(t,a,4).replace(Gs,"");case 31:return eN(t);case 64:return N2(t);case 65:return rN(t);case 71:return KO(t);case 80:return bx(t,a,!s.raw).replace(Gs,"");case 81:return WO(t,a).replace(Gs,"");case 4108:return XO(t);case 4126:case 4127:return a==4127?VO(t):GO(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+a)}}function Mw(t,e){var r=ut(4),a=ut(4);switch(r.write_shift(4,t==80?31:t),t){case 3:a.write_shift(-4,e);break;case 5:a=ut(8),a.write_shift(8,e,"f");break;case 11:a.write_shift(4,e?1:0);break;case 64:a=$O(e);break;case 31:case 80:for(a=ut(4+2*(e.length+1)+(e.length%2?0:2)),a.write_shift(4,e.length+1),a.write_shift(0,e,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return ss([r,a])}function Iw(t,e){var r=t.l,a=t.read_shift(4),n=t.read_shift(4),s=[],l=0,c=0,f=-1,d={};for(l=0;l!=n;++l){var m=t.read_shift(4),v=t.read_shift(4);s[l]=[m,v+r]}s.sort(function(C,E){return C[1]-E[1]});var x={};for(l=0;l!=n;++l){if(t.l!==s[l][1]){var g=!0;if(l>0&&e)switch(e[s[l-1][0]].t){case 2:t.l+2===s[l][1]&&(t.l+=2,g=!1);break;case 80:t.l<=s[l][1]&&(t.l=s[l][1],g=!1);break;case 4108:t.l<=s[l][1]&&(t.l=s[l][1],g=!1);break}if((!e||l==0)&&t.l<=s[l][1]&&(g=!1,t.l=s[l][1]),g)throw new Error("Read Error: Expected address "+s[l][1]+" at "+t.l+" :"+l)}if(e){var b=e[s[l][0]];if(x[b.n]=e1(t,b.t,{raw:!0}),b.p==="version"&&(x[b.n]=String(x[b.n]>>16)+"."+("0000"+String(x[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(x[b.n]){case 0:x[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Vo(c=x[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[b.n])}}else if(s[l][0]===1){if(c=x.CodePage=e1(t,w2),Vo(c),f!==-1){var _=t.l;t.l=s[f][1],d=Pw(t,c),t.l=_}}else if(s[l][0]===0){if(c===0){f=l,t.l=s[l+1][1];continue}d=Pw(t,c)}else{var w=d[s[l][0]],A;switch(t[t.l]){case 65:t.l+=4,A=rN(t);break;case 30:t.l+=4,A=bx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,A=bx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,A=t.read_shift(4,"i");break;case 19:t.l+=4,A=t.read_shift(4);break;case 5:t.l+=4,A=t.read_shift(8,"f");break;case 11:t.l+=4,A=_n(t,4);break;case 64:t.l+=4,A=Ua(N2(t));break;default:throw new Error("unparsed value: "+t[t.l])}x[w]=A}}return t.l=r+a,x}var aN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function JO(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Bw(t,e,r){var a=ut(8),n=[],s=[],l=8,c=0,f=ut(8),d=ut(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),s.push(f),n.push(d),l+=8+f.length,!e){d=ut(8),d.write_shift(4,0),n.unshift(d);var m=[ut(4)];for(m[0].write_shift(4,t.length),c=0;c<t.length;++c){var v=t[c][0];for(f=ut(8+2*(v.length+1)+(v.length%2?0:2)),f.write_shift(4,c+2),f.write_shift(4,v.length+1),f.write_shift(0,v,"dbcs");f.l!=f.length;)f.write_shift(1,0);m.push(f)}f=ss(m),s.unshift(f),l+=8+f.length}for(c=0;c<t.length;++c)if(!(e&&!e[t[c][0]])&&!(aN.indexOf(t[c][0])>-1||X3.indexOf(t[c][0])>-1)&&t[c][1]!=null){var x=t[c][1],g=0;if(e){g=+e[t[c][0]];var b=r[g];if(b.p=="version"&&typeof x=="string"){var _=x.split(".");x=(+_[0]<<16)+(+_[1]||0)}f=Mw(b.t,x)}else{var w=JO(x);w==-1&&(w=31,x=String(x)),f=Mw(w,x)}s.push(f),d=ut(8),d.write_shift(4,e?g:2+c),n.push(d),l+=8+f.length}var A=8*(s.length+1);for(c=0;c<s.length;++c)n[c].write_shift(4,A),A+=s[c].length;return a.write_shift(4,l),a.write_shift(4,s.length),ss([a].concat(n).concat(s))}function Uw(t,e,r){var a=t.content;if(!a)return{};ys(a,0);var n,s,l,c,f=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),m=a.read_shift(16);if(m!==hr.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),c=a.read_shift(4),n===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);n===2&&(l=a.read_shift(16),f=a.read_shift(4));var v=Iw(a,e),x={SystemIdentifier:d};for(var g in v)x[g]=v[g];if(x.FMTID=s,n===1)return x;if(f-a.l==2&&(a.l+=2),a.l!==f)throw new Error("Length mismatch 2: "+a.l+" !== "+f);var b;try{b=Iw(a,null)}catch{}for(g in b)x[g]=b[g];return x.FMTID=[s,l],x}function qw(t,e,r,a,n,s){var l=ut(n?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,hr.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,n?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,n?68:48);var f=Bw(t,r,a);if(c.push(f),n){var d=Bw(n,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+f.length),c.push(d)}return ss(c)}function tu(t,e){return t.read_shift(e),null}function ZO(t,e){e||(e=ut(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function QO(t,e,r){for(var a=[],n=t.l+e;t.l<n;)a.push(r(t,n-t.l));if(n!==t.l)throw new Error("Slurp error");return a}function _n(t,e){return t.read_shift(e)===1}function Vs(t,e){return e||(e=ut(2)),e.write_shift(2,+!!t),e}function Ln(t){return t.read_shift(2,"u")}function co(t,e){return e||(e=ut(2)),e.write_shift(2,t),e}function nN(t,e){return QO(t,e,Ln)}function e7(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function sN(t,e,r){return r||(r=ut(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function J0(t,e,r){var a=t.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=a?t.read_shift(a,n):"";return l}function t7(t){var e=t.read_shift(2),r=t.read_shift(1),a=r&4,n=r&8,s=1+(r&1),l=0,c,f={};n&&(l=t.read_shift(2)),a&&(c=t.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",m=e===0?"":t.read_shift(e,d);return n&&(t.l+=4*l),a&&(t.l+=c),f.t=m,n||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function r7(t){var e=t.t||"",r=ut(3);r.write_shift(2,e.length),r.write_shift(1,1);var a=ut(2*e.length);a.write_shift(2*e.length,e,"utf16le");var n=[r,a];return ss(n)}function _f(t,e,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var n=t.read_shift(1);return n===0?a=t.read_shift(e,"sbcs-cont"):a=t.read_shift(e,"dbcs-cont"),a}function Z0(t,e,r){var a=t.read_shift(r&&r.biff==2?1:2);return a===0?(t.l++,""):_f(t,a,r)}function Ff(t,e,r){if(r.biff>5)return Z0(t,e,r);var a=t.read_shift(1);return a===0?(t.l++,""):t.read_shift(a,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function iN(t,e,r){return r||(r=ut(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function a7(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function n7(t){var e=t.read_shift(4),r=t.l,a=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),t.l=r);var n=t.read_shift((a?e-24:e)>>1,"utf16le").replace(Gs,"");return a&&(t.l+=24),n}function s7(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var a=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=t.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(s>>1,"utf16le").replace(Gs,"");return r+l}function i7(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return n7(t);case"0303000000000000c000000000000046":return s7(t);default:throw new Error("Unsupported Moniker "+r)}}function hp(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Gs,""):"";return r}function zw(t,e){e||(e=ut(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function o7(t,e){var r=t.l+e,a=t.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=t.read_shift(2);t.l+=2;var s,l,c,f,d="",m,v;n&16&&(s=hp(t,r-t.l)),n&128&&(l=hp(t,r-t.l)),(n&257)===257&&(c=hp(t,r-t.l)),(n&257)===1&&(f=i7(t,r-t.l)),n&8&&(d=hp(t,r-t.l)),n&32&&(m=t.read_shift(16)),n&64&&(v=N2(t)),t.l=r;var x=l||c||f||"";x&&d&&(x+="#"+d),x||(x="#"+d),n&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var g={Target:x};return m&&(g.guid=m),v&&(g.time=v),s&&(g.Tooltip=s),g}function l7(t){var e=ut(512),r=0,a=t.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),s=n>-1?31:23;switch(a.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)e.write_shift(4,l[r]);if(s==28)a=a.slice(1),zw(a,e);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));var c=n>-1?a.slice(0,n):a;for(e.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)e.write_shift(2,c.charCodeAt(r));e.write_shift(2,0),s&8&&zw(n>-1?a.slice(n+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));for(var f=0;a.slice(f*3,f*3+3)=="../"||a.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,a.length-3*f+1),r=0;r<a.length-3*f;++r)e.write_shift(1,a.charCodeAt(r+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function oN(t){var e=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1),n=t.read_shift(1);return[e,r,a,n]}function lN(t,e){var r=oN(t);return r[3]=0,r}function Cl(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{r:e,c:r,ixfe:a}}function bf(t,e,r,a){return a||(a=ut(6)),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(2,r||0),a}function c7(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function u7(t,e,r){return e===0?"":Ff(t,e,r)}function f7(t,e,r){var a=r.biff>8?4:2,n=t.read_shift(a),s=t.read_shift(a,"i"),l=t.read_shift(a,"i");return[n,s,l]}function cN(t){var e=t.read_shift(2),r=b2(t);return[e,r]}function d7(t,e,r){t.l+=4,e-=4;var a=t.l+e,n=J0(t,e,r),s=t.read_shift(2);if(a-=t.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return t.l+=s,n}function _1(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2);return{s:{c:a,r:e},e:{c:n,r}}}function uN(t,e){return e||(e=ut(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function fN(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(1),n=t.read_shift(1);return{s:{c:a,r:e},e:{c:n,r}}}var h7=fN;function dN(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return t.l+=12,[r,e,a]}function m7(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function p7(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function js(t){t.l+=2,t.l+=t.read_shift(2)}var g7={0:js,4:js,5:js,6:js,7:p7,8:js,9:js,10:js,11:js,12:js,13:m7,14:js,15:js,16:js,17:js,18:js,19:js,20:js,21:dN};function v7(t,e){for(var r=t.l+e,a=[];t.l<r;){var n=t.read_shift(2);t.l-=2;try{a.push(g7[n](t,r-t.l))}catch{return t.l=r,a}}return t.l!=r&&(t.l=r),a}function mp(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function k2(t,e,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ut(n);return s.write_shift(2,a),s.write_shift(2,e),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function x7(t,e){return e===0||t.read_shift(2),1200}function y7(t,e,r){if(r.enc)return t.l+=e,"";var a=t.l,n=Ff(t,0,r);return t.read_shift(e+a-t.l),n}function _7(t,e){var r=!e||e.biff==8,a=ut(r?112:54);for(a.write_shift(e.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function b7(t,e,r){var a=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function w7(t,e,r){var a=t.read_shift(4),n=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=J0(t,0,r);return l.length===0&&(l="Sheet1"),{pos:a,hs:n,dt:s,name:l}}function S7(t,e){var r=!e||e.biff>=8?2:1,a=ut(8+r*t.name.length);a.write_shift(4,t.pos),a.write_shift(1,t.hs||0),a.write_shift(1,t.dt),a.write_shift(1,t.name.length),e.biff>=8&&a.write_shift(1,1),a.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function N7(t,e){for(var r=t.l+e,a=t.read_shift(4),n=t.read_shift(4),s=[],l=0;l!=n&&t.l<r;++l)s.push(t7(t));return s.Count=a,s.Unique=n,s}function k7(t,e){var r=ut(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var a=[],n=0;n<t.length;++n)a[n]=r7(t[n]);var s=ss([r].concat(a));return s.parts=[r.length].concat(a.map(function(l){return l.length})),s}function j7(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function E7(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var a=t.read_shift(1);return t.l+=3,a&7&&(e.level=a&7),a&32&&(e.hidden=!0),a&64&&(e.hpt=r/20),e}function A7(t){var e=c7(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function C7(t){return t.read_shift(2),t.read_shift(4)}function Hw(t,e,r){var a=0;r&&r.biff==2||(a=t.read_shift(2));var n=t.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,n]}function T7(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),f=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[a,n],Flags:s,CurTab:l,FirstTab:c,Selected:f,TabRatio:d}}function O7(){var t=ut(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function R7(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=t.read_shift(2);return{RTL:a&64}}function D7(t){var e=ut(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function F7(){}function L7(t,e,r){var a={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return a.name=J0(t,0,r),a}function P7(t,e){var r=t.name||"Arial",a=e&&e.biff==5,n=a?15+r.length:16+2*r.length,s=ut(n);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),s}function M7(t){var e=Cl(t);return e.isst=t.read_shift(4),e}function I7(t,e,r,a){var n=ut(10);return bf(t,e,a,n),n.write_shift(4,r),n}function B7(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=t.l+e,n=Cl(t);r.biff==2&&t.l++;var s=Z0(t,a-t.l,r);return n.val=s,n}function U7(t,e,r,a,n){var s=!n||n.biff==8,l=ut(8+ +s+(1+s)*r.length);return bf(t,e,a,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function q7(t,e,r){var a=t.read_shift(2),n=Ff(t,0,r);return[a,n]}function z7(t,e,r,a){var n=r&&r.biff==5;a||(a=ut(n?3+e.length:5+2*e.length)),a.write_shift(2,t),a.write_shift(n?1:2,e.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le");var s=a.length>a.l?a.slice(0,a.l):a;return s.l==null&&(s.l=s.length),s}var H7=Ff;function $w(t,e,r){var a=t.l+e,n=r.biff==8||!r.biff?4:2,s=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2),f=t.read_shift(2);return t.l=a,{s:{r:s,c},e:{r:l,c:f}}}function $7(t,e){var r=e.biff==8||!e.biff?4:2,a=ut(2*r+6);return a.write_shift(r,t.s.r),a.write_shift(r,t.e.r+1),a.write_shift(2,t.s.c),a.write_shift(2,t.e.c+1),a.write_shift(2,0),a}function W7(t){var e=t.read_shift(2),r=t.read_shift(2),a=cN(t);return{r:e,c:r,ixfe:a[0],rknum:a[1]}}function V7(t,e){for(var r=t.l+e-2,a=t.read_shift(2),n=t.read_shift(2),s=[];t.l<r;)s.push(cN(t));if(t.l!==r)throw new Error("MulRK read error");var l=t.read_shift(2);if(s.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:l,rkrec:s}}function G7(t,e){for(var r=t.l+e-2,a=t.read_shift(2),n=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var l=t.read_shift(2);if(s.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:l,ixfe:s}}function Y7(t,e,r,a){var n={},s=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(4),f=t.read_shift(2);return n.patternType=AO[c>>26],a.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=c&127,n.icvBottom=c>>7&127,n.icvDiag=c>>14&127,n.dgDiag=c>>21&15,n.icvFore=f&127,n.icvBack=f>>7&127,n.fsxButton=f>>14&1),n}function X7(t,e,r){var a={};return a.ifnt=t.read_shift(2),a.numFmtId=t.read_shift(2),a.flags=t.read_shift(2),a.fStyle=a.flags>>2&1,e-=6,a.data=Y7(t,e,a.fStyle,r),a}function Ww(t,e,r,a){var n=r&&r.biff==5;a||(a=ut(n?16:20)),a.write_shift(2,0),t.style?(a.write_shift(2,t.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,t.numFmtId||0),a.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&n&&(s|=1024),a.write_shift(4,s),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function K7(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function J7(t){var e=ut(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Vw(t,e,r){var a=Cl(t);(r.biff==2||e==9)&&++t.l;var n=e7(t);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function Z7(t,e,r,a,n,s){var l=ut(8);return bf(t,e,a,l),sN(r,s,l),l}function Q7(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Cl(t),n=Fs(t);return a.val=n,a}function eR(t,e,r,a){var n=ut(14);return bf(t,e,a,n),yf(r,n),n}var Gw=u7;function tR(t,e,r){var a=t.l+e,n=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=_f(t,s),c=[];a>t.l;)c.push(Z0(t));return[s,n,l,c]}function Yw(t,e,r){var a=t.read_shift(2),n,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=d7(t,e-2,r)),s.body=n||t.read_shift(e-2),typeof n=="string"&&(s.Name=n),s}var rR=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Xw(t,e,r){var a=t.l+e,n=t.read_shift(2),s=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),f=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=_f(t,l,r);n&32&&(d=rR[d.charCodeAt(0)]);var m=a-t.l;r&&r.biff==2&&--m;var v=a==t.l||c===0||!(m>0)?[]:vP(t,m,r,c);return{chKey:s,Name:d,itab:f,rgce:v}}function hN(t,e,r){if(r.biff<8)return aR(t,e,r);for(var a=[],n=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)a.push(f7(t,r.biff>8?12:6,r));if(t.l!=n)throw new Error("Bad ExternSheet: "+t.l+" != "+n);return a}function aR(t,e,r){t[t.l+1]==3&&t[t.l]++;var a=J0(t,e,r);return a.charCodeAt(0)==3?a.slice(1):a}function nR(t,e,r){if(r.biff<8){t.l+=e;return}var a=t.read_shift(2),n=t.read_shift(2),s=_f(t,a,r),l=_f(t,n,r);return[s,l]}function sR(t,e,r){var a=fN(t);t.l++;var n=t.read_shift(1);return e-=8,[xP(t,e,r),n,a]}function Kw(t,e,r){var a=h7(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[a,pP(t,e,r)]}function iR(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,a=t.read_shift(4);return[e,r,a]}function oR(t,e,r){if(!(r.biff<8)){var a=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),c=Ff(t,0,r);return r.biff<8&&t.read_shift(1),[{r:a,c:n},c,l,s]}}function lR(t,e,r){return oR(t,e,r)}function cR(t,e){for(var r=[],a=t.read_shift(2);a--;)r.push(_1(t));return r}function uR(t){var e=ut(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)uN(t[r],e);return e}function fR(t,e,r){if(r&&r.biff<8)return hR(t,e,r);var a=dN(t),n=v7(t,e-22,a[1]);return{cmo:a,ft:n}}var dR={8:function(t,e){var r=t.l+e;t.l+=10;var a=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var n=t.read_shift(1);return t.l+=n,t.l=r,{fmt:a}}};function hR(t,e,r){t.l+=4;var a=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((dR[a]||Ps)(t,e,r)),{cmo:[n,a,s],ft:l}}function mR(t,e,r){var a=t.l,n="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:l=a7(t,6,r);var c=t.read_shift(2);t.read_shift(2),Ln(t,2);var f=t.read_shift(2);t.l+=f;for(var d=1;d<t.lens.length-1;++d){if(t.l-a!=t.lens[d])throw new Error("TxO: bad continue record");var m=t[t.l],v=_f(t,t.lens[d+1]-t.lens[d]-1);if(n+=v,n.length>=(m?c:2*c))break}if(n.length!==c&&n.length!==c*2)throw new Error("cchText: "+c+" != "+n.length);return t.l=a+e,{t:n}}catch{return t.l=a+e,{t:n}}}function pR(t,e){var r=_1(t);t.l+=16;var a=o7(t,e-24);return[r,a]}function gR(t){var e=ut(24),r=tn(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)e.write_shift(1,parseInt(a[n],16));return ss([e,l7(t[1])])}function vR(t,e){t.read_shift(2);var r=_1(t),a=t.read_shift((e-10)/2,"dbcs-cont");return a=a.replace(Gs,""),[r,a]}function xR(t){var e=t[1].Tooltip,r=ut(10+2*(e.length+1));r.write_shift(2,2048);var a=tn(t[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<e.length;++n)r.write_shift(2,e.charCodeAt(n));return r.write_shift(2,0),r}function yR(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Fw[r]||r,r=t.read_shift(2),e[1]=Fw[r]||r,e}function _R(t){return t||(t=ut(4)),t.write_shift(2,1),t.write_shift(2,1),t}function bR(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(lN(t));return r}function wR(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(lN(t));return r}function SR(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function mN(t,e,r){if(!r.cellStyles)return Ps(t,e);var a=r&&r.biff>=12?4:2,n=t.read_shift(a),s=t.read_shift(a),l=t.read_shift(a),c=t.read_shift(a),f=t.read_shift(2);a==2&&(t.l+=2);var d={s:n,e:s,w:l,ixfe:c,flags:f};return(r.biff>=5||!r.biff)&&(d.level=f>>8&7),d}function NR(t,e){var r=ut(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var a=0;return t.hidden&&(a|=1),r.write_shift(1,a),a=t.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function kR(t,e){var r={};return e<32||(t.l+=16,r.header=Fs(t),r.footer=Fs(t),t.l+=2),r}function jR(t,e,r){var a={area:!1};if(r.biff!=5)return t.l+=e,a;var n=t.read_shift(1);return t.l+=3,n&16&&(a.area=!0),a}function ER(t){for(var e=ut(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var AR=Cl,CR=nN,TR=Z0;function OR(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n={fmt:e,env:r,len:a,data:t.slice(t.l,t.l+a)};return t.l+=a,n}function RR(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Cl(t);++t.l;var n=Ff(t,e-7,r);return a.t="str",a.val=n,a}function DR(t){var e=Cl(t);++t.l;var r=Fs(t);return e.t="n",e.val=r,e}function FR(t,e,r){var a=ut(15);return rm(a,t,e),a.write_shift(8,r,"f"),a}function LR(t){var e=Cl(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function PR(t,e,r){var a=ut(9);return rm(a,t,e),a.write_shift(2,r),a}function MR(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function IR(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function BR(t,e,r){var a=t.l+e,n=Cl(t),s=t.read_shift(2),l=_f(t,s,r);return t.l=a,n.t="str",n.val=l,n}var UR=[2,3,48,49,131,139,140,245],wx=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=v1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,f){var d=[],m=mu(1);switch(f.type){case"base64":m=Pi(qi(c));break;case"binary":m=Pi(c);break;case"buffer":case"array":m=c;break}ys(m,0);var v=m.read_shift(1),x=!!(v&136),g=!1,b=!1;switch(v){case 2:break;case 3:break;case 48:g=!0,x=!0;break;case 49:g=!0,x=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var _=0,w=521;v==2&&(_=m.read_shift(2)),m.l+=3,v!=2&&(_=m.read_shift(4)),_>1048576&&(_=1e6),v!=2&&(w=m.read_shift(2));var A=m.read_shift(2),C=f.codepage||1252;v!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(C=t[m[m.l]]),m.l+=1,m.l+=2),b&&(m.l+=36);for(var E=[],R={},Y=Math.min(m.length,v==2?521:w-10-(g?264:0)),W=b?32:11;m.l<Y&&m[m.l]!=13;)switch(R={},R.name=C0.utils.decode(C,m.slice(m.l,m.l+W)).replace(/[\u0000\r\n].*$/g,""),m.l+=W,R.type=String.fromCharCode(m.read_shift(1)),v!=2&&!b&&(R.offset=m.read_shift(4)),R.len=m.read_shift(1),v==2&&(R.offset=m.read_shift(2)),R.dec=m.read_shift(1),R.name.length&&E.push(R),v!=2&&(m.l+=b?13:14),R.type){case"B":(!g||R.len!=8)&&f.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(m[m.l]!==13&&(m.l=w-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=w;var B=0,q=0;for(d[0]=[],q=0;q!=E.length;++q)d[0][q]=E[q].name;for(;_-- >0;){if(m[m.l]===42){m.l+=A;continue}for(++m.l,d[++B]=[],q=0,q=0;q!=E.length;++q){var L=m.slice(m.l,m.l+E[q].len);m.l+=E[q].len,ys(L,0);var J=C0.utils.decode(C,L);switch(E[q].type){case"C":J.trim().length&&(d[B][q]=J.replace(/\s+$/,""));break;case"D":J.length===8?d[B][q]=new Date(+J.slice(0,4),+J.slice(4,6)-1,+J.slice(6,8)):d[B][q]=J;break;case"F":d[B][q]=parseFloat(J.trim());break;case"+":case"I":d[B][q]=b?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(J.trim().toUpperCase()){case"Y":case"T":d[B][q]=!0;break;case"N":case"F":d[B][q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+J+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));d[B][q]="##MEMO##"+(b?parseInt(J.trim(),10):L.read_shift(4));break;case"N":J=J.replace(/\u0000/g,"").trim(),J&&J!="."&&(d[B][q]=+J||0);break;case"@":d[B][q]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":d[B][q]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":d[B][q]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[B][q]=-L.read_shift(-8,"f");break;case"B":if(g&&E[q].len==8){d[B][q]=L.read_shift(8,"f");break}case"G":case"P":L.l+=E[q].len;break;case"0":if(E[q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[q].type)}}}if(v!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=E,d}function a(c,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var m=mh(r(c,d),d);return m["!cols"]=d.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete d.DBF,m}function n(c,f){try{return bu(a(c,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var d=f||{};if(+d.codepage>=0&&Vo(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var m=di(),v=a1(c,{header:1,raw:!0,cellDates:!0}),x=v[0],g=v.slice(1),b=c["!cols"]||[],_=0,w=0,A=0,C=1;for(_=0;_<x.length;++_){if(((b[_]||{}).DBF||{}).name){x[_]=b[_].DBF.name,++A;continue}if(x[_]!=null){if(++A,typeof x[_]=="number"&&(x[_]=x[_].toString(10)),typeof x[_]!="string")throw new Error("DBF Invalid column name "+x[_]+" |"+typeof x[_]+"|");if(x.indexOf(x[_])!==_){for(w=0;w<1024;++w)if(x.indexOf(x[_]+"_"+w)==-1){x[_]+="_"+w;break}}}}var E=ea(c["!ref"]),R=[],Y=[],W=[];for(_=0;_<=E.e.c-E.s.c;++_){var B="",q="",L=0,J=[];for(w=0;w<g.length;++w)g[w][_]!=null&&J.push(g[w][_]);if(J.length==0||x[_]==null){R[_]="?";continue}for(w=0;w<J.length;++w){switch(typeof J[w]){case"number":q="B";break;case"string":q="C";break;case"boolean":q="L";break;case"object":q=J[w]instanceof Date?"D":"C";break;default:q="C"}L=Math.max(L,String(J[w]).length),B=B&&B!=q?"C":q}L>250&&(L=250),q=((b[_]||{}).DBF||{}).type,q=="C"&&b[_].DBF.len>L&&(L=b[_].DBF.len),B=="B"&&q=="N"&&(B="N",W[_]=b[_].DBF.dec,L=b[_].DBF.len),Y[_]=B=="C"||q=="N"?L:s[B]||0,C+=Y[_],R[_]=B}var D=m.next(32);for(D.write_shift(4,318902576),D.write_shift(4,g.length),D.write_shift(2,296+32*A),D.write_shift(2,C),_=0;_<4;++_)D.write_shift(4,0);for(D.write_shift(4,0|(+e[a3]||3)<<8),_=0,w=0;_<x.length;++_)if(x[_]!=null){var T=m.next(32),M=(x[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,M,"sbcs"),T.write_shift(1,R[_]=="?"?"C":R[_],"sbcs"),T.write_shift(4,w),T.write_shift(1,Y[_]||s[R[_]]||0),T.write_shift(1,W[_]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),w+=Y[_]||s[R[_]]||0}var V=m.next(264);for(V.write_shift(4,13),_=0;_<65;++_)V.write_shift(4,0);for(_=0;_<g.length;++_){var ie=m.next(C);for(ie.write_shift(1,0),w=0;w<x.length;++w)if(x[w]!=null)switch(R[w]){case"L":ie.write_shift(1,g[_][w]==null?63:g[_][w]?84:70);break;case"B":ie.write_shift(8,g[_][w]||0,"f");break;case"N":var X="0";for(typeof g[_][w]=="number"&&(X=g[_][w].toFixed(W[w]||0)),A=0;A<Y[w]-X.length;++A)ie.write_shift(1,32);ie.write_shift(1,X,"sbcs");break;case"D":g[_][w]?(ie.write_shift(4,("0000"+g[_][w].getFullYear()).slice(-4),"sbcs"),ie.write_shift(2,("00"+(g[_][w].getMonth()+1)).slice(-2),"sbcs"),ie.write_shift(2,("00"+g[_][w].getDate()).slice(-2),"sbcs")):ie.write_shift(8,"00000000","sbcs");break;case"C":var Z=String(g[_][w]!=null?g[_][w]:"").slice(0,Y[w]);for(ie.write_shift(1,Z,"sbcs"),A=0;A<Y[w]-Z.length;++A)ie.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:n,to_sheet:a,from_sheet:l}})(),pN=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+pn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,g){var b=t[g];return typeof b=="number"?ow(b):b},a=function(x,g,b){var _=g.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return _==59?x:ow(_)};t["|"]=254;function n(x,g){switch(g.type){case"base64":return s(qi(x),g);case"binary":return s(x,g);case"buffer":return s(Pr&&Buffer.isBuffer(x)?x.toString("binary"):_u(x),g);case"array":return s(xf(x),g)}throw new Error("Unrecognized type "+g.type)}function s(x,g){var b=x.split(/[\n\r]+/),_=-1,w=-1,A=0,C=0,E=[],R=[],Y=null,W={},B=[],q=[],L=[],J=0,D;for(+g.codepage>=0&&Vo(+g.codepage);A!==b.length;++A){J=0;var T=b[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(e,r),M=T.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),V=M[0],ie;if(T.length>0)switch(V){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&R.push(T.slice(3).replace(/;;/g,";"));break;case"C":var X=!1,Z=!1,K=!1,re=!1,de=-1,U=-1;for(C=1;C<M.length;++C)switch(M[C].charAt(0)){case"A":break;case"X":w=parseInt(M[C].slice(1))-1,Z=!0;break;case"Y":for(_=parseInt(M[C].slice(1))-1,Z||(w=0),D=E.length;D<=_;++D)E[D]=[];break;case"K":ie=M[C].slice(1),ie.charAt(0)==='"'?ie=ie.slice(1,ie.length-1):ie==="TRUE"?ie=!0:ie==="FALSE"?ie=!1:isNaN(Yo(ie))?isNaN(sh(ie).getDate())||(ie=Ua(ie)):(ie=Yo(ie),Y!==null&&dh(Y)&&(ie=y1(ie))),X=!0;break;case"E":re=!0;var k=Jd(M[C].slice(1),{r:_,c:w});E[_][w]=[E[_][w],k];break;case"S":K=!0,E[_][w]=[E[_][w],"S5S"];break;case"G":break;case"R":de=parseInt(M[C].slice(1))-1;break;case"C":U=parseInt(M[C].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+T)}if(X&&(E[_][w]&&E[_][w].length==2?E[_][w][0]=ie:E[_][w]=ie,Y=null),K){if(re)throw new Error("SYLK shared formula cannot have own formula");var F=de>-1&&E[de][U];if(!F||!F[1])throw new Error("SYLK shared formula cannot find base");E[_][w][1]=DN(F[1],{r:_-de,c:w-U})}break;case"F":var I=0;for(C=1;C<M.length;++C)switch(M[C].charAt(0)){case"X":w=parseInt(M[C].slice(1))-1,++I;break;case"Y":for(_=parseInt(M[C].slice(1))-1,D=E.length;D<=_;++D)E[D]=[];break;case"M":J=parseInt(M[C].slice(1))/20;break;case"F":break;case"G":break;case"P":Y=R[parseInt(M[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=M[C].slice(1).split(" "),D=parseInt(L[0],10);D<=parseInt(L[1],10);++D)J=parseInt(L[2],10),q[D-1]=J===0?{hidden:!0}:{wch:J},pu(q[D-1]);break;case"C":w=parseInt(M[C].slice(1))-1,q[w]||(q[w]={});break;case"R":_=parseInt(M[C].slice(1))-1,B[_]||(B[_]={}),J>0?(B[_].hpt=J,B[_].hpx=oh(J)):J===0&&(B[_].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+T)}I<1&&(Y=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+T)}}return B.length>0&&(W["!rows"]=B),q.length>0&&(W["!cols"]=q),g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),[E,W]}function l(x,g){var b=n(x,g),_=b[0],w=b[1],A=mh(_,g);return pn(w).forEach(function(C){A[C]=w[C]}),A}function c(x,g){return bu(l(x,g),g)}function f(x,g,b,_){var w="C;Y"+(b+1)+";X"+(_+1)+";K";switch(x.t){case"n":w+=x.v||0,x.f&&!x.F&&(w+=";E"+O2(x.f,{r:b,c:_}));break;case"b":w+=x.v?"TRUE":"FALSE";break;case"e":w+=x.w||x.v;break;case"d":w+='"'+(x.w||x.v)+'"';break;case"s":w+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function d(x,g){g.forEach(function(b,_){var w="F;W"+(_+1)+" "+(_+1)+" ";b.hidden?w+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=M0(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=I0(b.wpx)),typeof b.wch=="number"&&(w+=Math.round(b.wch))),w.charAt(w.length-1)!=" "&&x.push(w)})}function m(x,g){g.forEach(function(b,_){var w="F;";b.hidden?w+="M0;":b.hpt?w+="M"+20*b.hpt+";":b.hpx&&(w+="M"+20*B0(b.hpx)+";"),w.length>2&&x.push(w+"R"+(_+1))})}function v(x,g){var b=["ID;PWXL;N;E"],_=[],w=ea(x["!ref"]),A,C=Array.isArray(x),E=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),x["!cols"]&&d(b,x["!cols"]),x["!rows"]&&m(b,x["!rows"]),b.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var R=w.s.r;R<=w.e.r;++R)for(var Y=w.s.c;Y<=w.e.c;++Y){var W=wr({r:R,c:Y});A=C?(x[R]||[])[Y]:x[W],!(!A||A.v==null&&(!A.f||A.F))&&_.push(f(A,x,R,Y))}return b.join(E)+E+_.join(E)+E+"E"+E}return{to_workbook:c,to_sheet:l,from_sheet:v}})(),gN=(function(){function t(s,l){switch(l.type){case"base64":return e(qi(s),l);case"binary":return e(s,l);case"buffer":return e(Pr&&Buffer.isBuffer(s)?s.toString("binary"):_u(s),l);case"array":return e(xf(s),l)}throw new Error("Unrecognized type "+l.type)}function e(s,l){for(var c=s.split(`
`),f=-1,d=-1,m=0,v=[];m!==c.length;++m){if(c[m].trim()==="BOT"){v[++f]=[],d=0;continue}if(!(f<0)){var x=c[m].trim().split(","),g=x[0],b=x[1];++m;for(var _=c[m]||"";(_.match(/["]/g)||[]).length&1&&m<c.length-1;)_+=`
`+c[++m];switch(_=_.trim(),+g){case-1:if(_==="BOT"){v[++f]=[],d=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?v[f][d]=!0:_==="FALSE"?v[f][d]=!1:isNaN(Yo(b))?isNaN(sh(b).getDate())?v[f][d]=b:v[f][d]=Ua(b):v[f][d]=Yo(b),++d;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),v[f][d++]=_!==""?_:null;break}if(_==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function r(s,l){return mh(t(s,l),l)}function a(s,l){return bu(r(s,l),l)}var n=(function(){var s=function(f,d,m,v,x){f.push(d),f.push(m+","+v),f.push('"'+x.replace(/"/g,'""')+'"')},l=function(f,d,m,v){f.push(d+","+m),f.push(d==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(f){var d=[],m=ea(f["!ref"]),v,x=Array.isArray(f);s(d,"TABLE",0,1,"sheetjs"),s(d,"VECTORS",0,m.e.r-m.s.r+1,""),s(d,"TUPLES",0,m.e.c-m.s.c+1,""),s(d,"DATA",0,0,"");for(var g=m.s.r;g<=m.e.r;++g){l(d,-1,0,"BOT");for(var b=m.s.c;b<=m.e.c;++b){var _=wr({r:g,c:b});if(v=x?(f[g]||[])[b]:f[_],!v){l(d,1,0,"");continue}switch(v.t){case"n":var w=v.w;!w&&v.v!=null&&(w=v.v),w==null?v.f&&!v.F?l(d,1,0,"="+v.f):l(d,1,0,""):l(d,0,w,"V");break;case"b":l(d,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=fo(v.z||_r[14],Kn(Ua(v.v)))),l(d,0,v.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var A=`\r
`,C=d.join(A);return C}})();return{to_workbook:a,to_sheet:r,from_sheet:n}})(),vN=(function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,x){for(var g=v.split(`
`),b=-1,_=-1,w=0,A=[];w!==g.length;++w){var C=g[w].trim().split(":");if(C[0]==="cell"){var E=tn(C[1]);if(A.length<=E.r)for(b=A.length;b<=E.r;++b)A[b]||(A[b]=[]);switch(b=E.r,_=E.c,C[2]){case"t":A[b][_]=t(C[3]);break;case"v":A[b][_]=+C[3];break;case"vtf":var R=C[C.length-1];case"vtc":switch(C[3]){case"nl":A[b][_]=!!+C[4];break;default:A[b][_]=+C[4];break}C[2]=="vtf"&&(A[b][_]=[A[b][_],R])}}}return x&&x.sheetRows&&(A=A.slice(0,x.sheetRows)),A}function a(v,x){return mh(r(v,x),x)}function n(v,x){return bu(a(v,x),x)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(v){if(!v||!v["!ref"])return"";for(var x=[],g=[],b,_="",w=hi(v["!ref"]),A=Array.isArray(v),C=w.s.r;C<=w.e.r;++C)for(var E=w.s.c;E<=w.e.c;++E)if(_=wr({r:C,c:E}),b=A?(v[C]||[])[E]:v[_],!(!b||b.v==null||b.t==="z")){switch(g=["cell",_,"t"],b.t){case"s":case"str":g.push(e(b.v));break;case"n":b.f?(g[2]="vtf",g[3]="n",g[4]=b.v,g[5]=e(b.f)):(g[2]="v",g[3]=b.v);break;case"b":g[2]="vt"+(b.f?"f":"c"),g[3]="nl",g[4]=b.v?"1":"0",g[5]=e(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var R=Kn(Ua(b.v));g[2]="vtc",g[3]="nd",g[4]=""+R,g[5]=b.w||fo(b.z||_r[14],R);break;case"e":continue}x.push(g.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function m(v){return[s,l,c,l,d(v),f].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:m}})(),ih=(function(){function t(m,v,x,g,b){b.raw?v[x][g]=m:m===""||(m==="TRUE"?v[x][g]=!0:m==="FALSE"?v[x][g]=!1:isNaN(Yo(m))?isNaN(sh(m).getDate())?v[x][g]=m:v[x][g]=Ua(m):v[x][g]=Yo(m))}function e(m,v){var x=v||{},g=[];if(!m||m.length===0)return g;for(var b=m.split(/[\r\n]/),_=b.length-1;_>=0&&b[_].length===0;)--_;for(var w=10,A=0,C=0;C<=_;++C)A=b[C].indexOf(" "),A==-1?A=b[C].length:A++,w=Math.max(w,A);for(C=0;C<=_;++C){g[C]=[];var E=0;for(t(b[C].slice(0,w).trim(),g,C,E,x),E=1;E<=(b[C].length-w)/10+1;++E)t(b[C].slice(w+(E-1)*10,w+E*10).trim(),g,C,E,x)}return x.sheetRows&&(g=g.slice(0,x.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(m){for(var v={},x=!1,g=0,b=0;g<m.length;++g)(b=m.charCodeAt(g))==34?x=!x:!x&&b in r&&(v[b]=(v[b]||0)+1);b=[];for(g in v)Object.prototype.hasOwnProperty.call(v,g)&&b.push([v[g],g]);if(!b.length){v=a;for(g in v)Object.prototype.hasOwnProperty.call(v,g)&&b.push([v[g],g])}return b.sort(function(_,w){return _[0]-w[0]||a[_[1]]-a[w[1]]}),r[b.pop()[1]]||44}function s(m,v){var x=v||{},g="",b=x.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(g=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(g=m.charAt(4),m=m.slice(6)):g=n(m.slice(0,1024)):x&&x.FS?g=x.FS:g=n(m.slice(0,1024));var w=0,A=0,C=0,E=0,R=0,Y=g.charCodeAt(0),W=!1,B=0,q=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var L=x.dateNF!=null?j8(x.dateNF):null;function J(){var D=m.slice(E,R),T={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)T.t="z";else if(x.raw)T.t="s",T.v=D;else if(D.trim().length===0)T.t="s",T.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(T.t="s",T.v=D.slice(2,-1).replace(/""/g,'"')):tL(D)?(T.t="n",T.f=D.slice(1)):(T.t="s",T.v=D);else if(D=="TRUE")T.t="b",T.v=!0;else if(D=="FALSE")T.t="b",T.v=!1;else if(!isNaN(C=Yo(D)))T.t="n",x.cellText!==!1&&(T.w=D),T.v=C;else if(!isNaN(sh(D).getDate())||L&&D.match(L)){T.z=x.dateNF||_r[14];var M=0;L&&D.match(L)&&(D=E8(D,x.dateNF,D.match(L)||[]),M=1),x.cellDates?(T.t="d",T.v=Ua(D,M)):(T.t="n",T.v=Kn(Ua(D,M))),x.cellText!==!1&&(T.w=fo(T.z,T.v instanceof Date?Kn(T.v):T.v)),x.cellNF||delete T.z}else T.t="s",T.v=D;if(T.t=="z"||(x.dense?(b[w]||(b[w]=[]),b[w][A]=T):b[wr({c:A,r:w})]=T),E=R+1,q=m.charCodeAt(E),_.e.c<A&&(_.e.c=A),_.e.r<w&&(_.e.r=w),B==Y)++A;else if(A=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;R<m.length;++R)switch(B=m.charCodeAt(R)){case 34:q===34&&(W=!W);break;case Y:case 10:case 13:if(!W&&J())break e;break}return R-E>0&&J(),b["!ref"]=Or(_),b}function l(m,v){return!(v&&v.PRN)||v.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?s(m,v):mh(e(m,v),v)}function c(m,v){var x="",g=v.type=="string"?[0,0,0,0]:B2(m,v);switch(v.type){case"base64":x=qi(m);break;case"binary":x=m;break;case"buffer":v.codepage==65001?x=m.toString("utf8"):v.codepage&&typeof C0<"u"||(x=Pr&&Buffer.isBuffer(m)?m.toString("binary"):_u(m));break;case"array":x=xf(m);break;case"string":x=m;break;default:throw new Error("Unrecognized type "+v.type)}return g[0]==239&&g[1]==187&&g[2]==191?x=Sa(x.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?x=Sa(x):v.type=="binary"&&typeof C0<"u",x.slice(0,19)=="socialcalc:version:"?vN.to_sheet(v.type=="string"?x:Sa(x),v):l(x,v)}function f(m,v){return bu(c(m,v),v)}function d(m){for(var v=[],x=ea(m["!ref"]),g,b=Array.isArray(m),_=x.s.r;_<=x.e.r;++_){for(var w=[],A=x.s.c;A<=x.e.c;++A){var C=wr({r:_,c:A});if(g=b?(m[_]||[])[A]:m[C],!g||g.v==null){w.push("          ");continue}for(var E=(g.w||(mc(g),g.w)||"").slice(0,10);E.length<10;)E+=" ";w.push(E+(A===0?" ":""))}v.push(w.join(""))}return v.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:d}})();function qR(t,e){var r=e||{},a=!!r.WTF;r.WTF=!0;try{var n=pN.to_workbook(t,r);return r.WTF=a,n}catch(s){if(r.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return ih.to_workbook(t,e)}}var mf=(function(){function t(k,F,I){if(k){ys(k,k.l||0);for(var z=I.Enum||de;k.l<k.length;){var te=k.read_shift(2),se=z[te]||z[65535],pe=k.read_shift(2),ve=k.l+pe,_e=se.f&&se.f(k,pe,I);if(k.l=ve,F(_e,se,te))return}}}function e(k,F){switch(F.type){case"base64":return r(Pi(qi(k)),F);case"binary":return r(Pi(k),F);case"buffer":case"array":return r(k,F)}throw"Unsupported type "+F.type}function r(k,F){if(!k)return k;var I=F||{},z=I.dense?[]:{},te="Sheet1",se="",pe=0,ve={},_e=[],Pe=[],fe={s:{r:0,c:0},e:{r:0,c:0}},st=I.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)I.Enum=de,t(k,function(we,ye,Be){switch(Be){case 0:I.vers=we,we>=4096&&(I.qpro=!0);break;case 6:fe=we;break;case 204:we&&(se=we);break;case 222:se=we;break;case 15:case 51:I.qpro||(we[1].v=we[1].v.slice(1));case 13:case 14:case 16:Be==14&&(we[2]&112)==112&&(we[2]&15)>1&&(we[2]&15)<15&&(we[1].z=I.dateNF||_r[14],I.cellDates&&(we[1].t="d",we[1].v=y1(we[1].v))),I.qpro&&we[3]>pe&&(z["!ref"]=Or(fe),ve[te]=z,_e.push(te),z=I.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},pe=we[3],te=se||"Sheet"+(pe+1),se="");var Et=I.dense?(z[we[0].r]||[])[we[0].c]:z[wr(we[0])];if(Et){Et.t=we[1].t,Et.v=we[1].v,we[1].z!=null&&(Et.z=we[1].z),we[1].f!=null&&(Et.f=we[1].f);break}I.dense?(z[we[0].r]||(z[we[0].r]=[]),z[we[0].r][we[0].c]=we[1]):z[wr(we[0])]=we[1];break}},I);else if(k[2]==26||k[2]==14)I.Enum=U,k[2]==14&&(I.qpro=!0,k.l=0),t(k,function(we,ye,Be){switch(Be){case 204:te=we;break;case 22:we[1].v=we[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(we[3]>pe&&(z["!ref"]=Or(fe),ve[te]=z,_e.push(te),z=I.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},pe=we[3],te="Sheet"+(pe+1)),st>0&&we[0].r>=st)break;I.dense?(z[we[0].r]||(z[we[0].r]=[]),z[we[0].r][we[0].c]=we[1]):z[wr(we[0])]=we[1],fe.e.c<we[0].c&&(fe.e.c=we[0].c),fe.e.r<we[0].r&&(fe.e.r=we[0].r);break;case 27:we[14e3]&&(Pe[we[14e3][0]]=we[14e3][1]);break;case 1537:Pe[we[0]]=we[1],we[0]==pe&&(te=we[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(z["!ref"]=Or(fe),ve[se||te]=z,_e.push(se||te),!Pe.length)return{SheetNames:_e,Sheets:ve};for(var mt={},he=[],at=0;at<Pe.length;++at)ve[_e[at]]?(he.push(Pe[at]||_e[at]),mt[Pe[at]]=ve[Pe[at]]||ve[_e[at]]):(he.push(Pe[at]),mt[Pe[at]]={"!ref":"A1"});return{SheetNames:he,Sheets:mt}}function a(k,F){var I=F||{};if(+I.codepage>=0&&Vo(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var z=di(),te=ea(k["!ref"]),se=Array.isArray(k),pe=[];It(z,0,s(1030)),It(z,6,f(te));for(var ve=Math.min(te.e.r,8191),_e=te.s.r;_e<=ve;++_e)for(var Pe=jn(_e),fe=te.s.c;fe<=te.e.c;++fe){_e===te.s.r&&(pe[fe]=en(fe));var st=pe[fe]+Pe,mt=se?(k[_e]||[])[fe]:k[st];if(!(!mt||mt.t=="z"))if(mt.t=="n")(mt.v|0)==mt.v&&mt.v>=-32768&&mt.v<=32767?It(z,13,g(_e,fe,mt.v)):It(z,14,_(_e,fe,mt.v));else{var he=mc(mt);It(z,15,v(_e,fe,he.slice(0,239)))}}return It(z,1),z.end()}function n(k,F){var I=F||{};if(+I.codepage>=0&&Vo(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var z=di();It(z,0,l(k));for(var te=0,se=0;te<k.SheetNames.length;++te)(k.Sheets[k.SheetNames[te]]||{})["!ref"]&&It(z,27,re(k.SheetNames[te],se++));var pe=0;for(te=0;te<k.SheetNames.length;++te){var ve=k.Sheets[k.SheetNames[te]];if(!(!ve||!ve["!ref"])){for(var _e=ea(ve["!ref"]),Pe=Array.isArray(ve),fe=[],st=Math.min(_e.e.r,8191),mt=_e.s.r;mt<=st;++mt)for(var he=jn(mt),at=_e.s.c;at<=_e.e.c;++at){mt===_e.s.r&&(fe[at]=en(at));var we=fe[at]+he,ye=Pe?(ve[mt]||[])[at]:ve[we];if(!(!ye||ye.t=="z"))if(ye.t=="n")It(z,23,J(mt,at,pe,ye.v));else{var Be=mc(ye);It(z,22,B(mt,at,pe,Be.slice(0,239)))}}++pe}}return It(z,1),z.end()}function s(k){var F=ut(2);return F.write_shift(2,k),F}function l(k){var F=ut(26);F.write_shift(2,4096),F.write_shift(2,4),F.write_shift(4,0);for(var I=0,z=0,te=0,se=0;se<k.SheetNames.length;++se){var pe=k.SheetNames[se],ve=k.Sheets[pe];if(!(!ve||!ve["!ref"])){++te;var _e=hi(ve["!ref"]);I<_e.e.r&&(I=_e.e.r),z<_e.e.c&&(z=_e.e.c)}}return I>8191&&(I=8191),F.write_shift(2,I),F.write_shift(1,te),F.write_shift(1,z),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(1,1),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(4,0),F}function c(k,F,I){var z={s:{c:0,r:0},e:{c:0,r:0}};return F==8&&I.qpro?(z.s.c=k.read_shift(1),k.l++,z.s.r=k.read_shift(2),z.e.c=k.read_shift(1),k.l++,z.e.r=k.read_shift(2),z):(z.s.c=k.read_shift(2),z.s.r=k.read_shift(2),F==12&&I.qpro&&(k.l+=2),z.e.c=k.read_shift(2),z.e.r=k.read_shift(2),F==12&&I.qpro&&(k.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function f(k){var F=ut(8);return F.write_shift(2,k.s.c),F.write_shift(2,k.s.r),F.write_shift(2,k.e.c),F.write_shift(2,k.e.r),F}function d(k,F,I){var z=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(z[0].c=k.read_shift(1),z[3]=k.read_shift(1),z[0].r=k.read_shift(2),k.l+=2):(z[2]=k.read_shift(1),z[0].c=k.read_shift(2),z[0].r=k.read_shift(2)),z}function m(k,F,I){var z=k.l+F,te=d(k,F,I);if(te[1].t="s",I.vers==20768){k.l++;var se=k.read_shift(1);return te[1].v=k.read_shift(se,"utf8"),te}return I.qpro&&k.l++,te[1].v=k.read_shift(z-k.l,"cstr"),te}function v(k,F,I){var z=ut(7+I.length);z.write_shift(1,255),z.write_shift(2,F),z.write_shift(2,k),z.write_shift(1,39);for(var te=0;te<z.length;++te){var se=I.charCodeAt(te);z.write_shift(1,se>=128?95:se)}return z.write_shift(1,0),z}function x(k,F,I){var z=d(k,F,I);return z[1].v=k.read_shift(2,"i"),z}function g(k,F,I){var z=ut(7);return z.write_shift(1,255),z.write_shift(2,F),z.write_shift(2,k),z.write_shift(2,I,"i"),z}function b(k,F,I){var z=d(k,F,I);return z[1].v=k.read_shift(8,"f"),z}function _(k,F,I){var z=ut(13);return z.write_shift(1,255),z.write_shift(2,F),z.write_shift(2,k),z.write_shift(8,I,"f"),z}function w(k,F,I){var z=k.l+F,te=d(k,F,I);if(te[1].v=k.read_shift(8,"f"),I.qpro)k.l=z;else{var se=k.read_shift(2);R(k.slice(k.l,k.l+se),te),k.l+=se}return te}function A(k,F,I){var z=F&32768;return F&=-32769,F=(z?k:0)+(F>=8192?F-16384:F),(z?"":"$")+(I?en(F):jn(F))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(k,F){ys(k,0);for(var I=[],z=0,te="",se="",pe="",ve="";k.l<k.length;){var _e=k[k.l++];switch(_e){case 0:I.push(k.read_shift(8,"f"));break;case 1:se=A(F[0].c,k.read_shift(2),!0),te=A(F[0].r,k.read_shift(2),!1),I.push(se+te);break;case 2:{var Pe=A(F[0].c,k.read_shift(2),!0),fe=A(F[0].r,k.read_shift(2),!1);se=A(F[0].c,k.read_shift(2),!0),te=A(F[0].r,k.read_shift(2),!1),I.push(Pe+fe+":"+se+te)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(k.read_shift(2));break;case 6:{for(var st="";_e=k[k.l++];)st+=String.fromCharCode(_e);I.push('"'+st.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:ve=I.pop(),pe=I.pop(),I.push(["AND","OR"][_e-20]+"("+pe+","+ve+")");break;default:if(_e<32&&E[_e])ve=I.pop(),pe=I.pop(),I.push(pe+E[_e]+ve);else if(C[_e]){if(z=C[_e][1],z==69&&(z=k[k.l++]),z>I.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+I.join("|")+"|");return}var mt=I.slice(-z);I.length-=z,I.push(C[_e][0]+"("+mt.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}I.length==1?F[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function Y(k){var F=[{c:0,r:0},{t:"n",v:0},0];return F[0].r=k.read_shift(2),F[3]=k[k.l++],F[0].c=k[k.l++],F}function W(k,F){var I=Y(k);return I[1].t="s",I[1].v=k.read_shift(F-4,"cstr"),I}function B(k,F,I,z){var te=ut(6+z.length);te.write_shift(2,k),te.write_shift(1,I),te.write_shift(1,F),te.write_shift(1,39);for(var se=0;se<z.length;++se){var pe=z.charCodeAt(se);te.write_shift(1,pe>=128?95:pe)}return te.write_shift(1,0),te}function q(k,F){var I=Y(k);I[1].v=k.read_shift(2);var z=I[1].v>>1;if(I[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return I[1].v=z,I}function L(k,F){var I=Y(k),z=k.read_shift(4),te=k.read_shift(4),se=k.read_shift(2);if(se==65535)return z===0&&te===3221225472?(I[1].t="e",I[1].v=15):z===0&&te===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var pe=se&32768;return se=(se&32767)-16446,I[1].v=(1-pe*2)*(te*Math.pow(2,se+32)+z*Math.pow(2,se)),I}function J(k,F,I,z){var te=ut(14);if(te.write_shift(2,k),te.write_shift(1,I),te.write_shift(1,F),z==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var se=0,pe=0,ve=0,_e=0;return z<0&&(se=1,z=-z),pe=Math.log2(z)|0,z/=Math.pow(2,pe-31),_e=z>>>0,(_e&2147483648)==0&&(z/=2,++pe,_e=z>>>0),z-=_e,_e|=2147483648,_e>>>=0,z*=Math.pow(2,32),ve=z>>>0,te.write_shift(4,ve),te.write_shift(4,_e),pe+=16383+(se?32768:0),te.write_shift(2,pe),te}function D(k,F){var I=L(k);return k.l+=F-14,I}function T(k,F){var I=Y(k),z=k.read_shift(4);return I[1].v=z>>6,I}function M(k,F){var I=Y(k),z=k.read_shift(8,"f");return I[1].v=z,I}function V(k,F){var I=M(k);return k.l+=F-10,I}function ie(k,F){return k[k.l+F-1]==0?k.read_shift(F,"cstr"):""}function X(k,F){var I=k[k.l++];I>F-1&&(I=F-1);for(var z="";z.length<I;)z+=String.fromCharCode(k[k.l++]);return z}function Z(k,F,I){if(!(!I.qpro||F<21)){var z=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var te=k.read_shift(F-21,"cstr");return[z,te]}}function K(k,F){for(var I={},z=k.l+F;k.l<z;){var te=k.read_shift(2);if(te==14e3){for(I[te]=[0,""],I[te][0]=k.read_shift(2);k[k.l];)I[te][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return I}function re(k,F){var I=ut(5+k.length);I.write_shift(2,14e3),I.write_shift(2,F);for(var z=0;z<k.length;++z){var te=k.charCodeAt(z);I[I.l++]=te>127?95:te}return I[I.l++]=0,I}var de={0:{n:"BOF",f:Ln},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ie},222:{n:"SHEETNAMELP",f:X},65535:{n:""}},U={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:q},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:V},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:e}})();function zR(t){var e={},r=t.match(Ms),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=Sr(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=r2[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return e}var HR=(function(){var t=R0("t"),e=R0("rPr");function r(s){var l=s.match(t);if(!l)return{t:"s",v:""};var c={t:"s",v:Qr(l[1])},f=s.match(e);return f&&(c.s=zR(f[1])),c}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(n).map(r).filter(function(c){return c.v})}})(),$R=(function(){var e=/(\r\n|\n)/g;function r(n,s,l){var c=[];n.u&&c.push("text-decoration: underline;"),n.uval&&c.push("text-underline-style:"+n.uval+";"),n.sz&&c.push("font-size:"+n.sz+"pt;"),n.outline&&c.push("text-effect: outline;"),n.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),n.b&&(s.push("<b>"),l.push("</b>")),n.i&&(s.push("<i>"),l.push("</i>")),n.strike&&(s.push("<s>"),l.push("</s>"));var f=n.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(s.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),n}function a(n){var s=[[],n.v,[]];return n.v?(n.s&&r(n.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}})(),WR=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,VR=/<(?:\w+:)?r>/,GR=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function j2(t,e){var r=e?e.cellHTML:!0,a={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Qr(Sa(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Sa(t),r&&(a.h=d2(a.t))):t.match(VR)&&(a.r=Sa(t),a.t=Qr(Sa((t.replace(GR,"").match(WR)||[]).join("").replace(Ms,""))),r&&(a.h=$R(HR(a.r)))),a):{t:""}}var YR=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,XR=/<(?:\w+:)?(?:si|sstItem)>/g,KR=/<\/(?:\w+:)?(?:si|sstItem)>/;function JR(t,e){var r=[],a="";if(!t)return r;var n=t.match(YR);if(n){a=n[2].replace(XR,"").split(KR);for(var s=0;s!=a.length;++s){var l=j2(a[s].trim(),e);l!=null&&(r[r.length]=l)}n=Sr(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var ZR=/^\s|\s$|[\t\n\r]/;function xN(t,e){if(!e.bookSST)return"";var r=[En];r[r.length]=Ft("sst",null,{xmlns:Cf[0],count:t.Count,uniqueCount:t.Unique});for(var a=0;a!=t.length;++a)if(t[a]!=null){var n=t[a],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(ZR)&&(s+=' xml:space="preserve"'),s+=">"+ga(n.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function QR(t){return[t.read_shift(4),t.read_shift(4)]}function eD(t,e){var r=[],a=!1;return xc(t,function(s,l,c){switch(c){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function tD(t,e){return e||(e=ut(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var rD=dO;function aD(t){var e=di();Nt(e,159,tD(t));for(var r=0;r<t.length;++r)Nt(e,19,rD(t[r]));return Nt(e,160),e.end()}function yN(t){for(var e=[],r=t.split(""),a=0;a<r.length;++a)e[a]=r[a].charCodeAt(0);return e}function hc(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function nD(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=hc(t,4),e.U=hc(t,4),e.W=hc(t,4),e}function sD(t){for(var e=t.read_shift(4),r=t.l+e-4,a={},n=t.read_shift(4),s=[];n-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(a.name=t.read_shift(0,"lpp4"),a.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return a}function iD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(sD(t));return e}function oD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function lD(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=hc(t,4),e.U=hc(t,4),e.W=hc(t,4),e}function cD(t){var e=lD(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function _N(t,e){var r=t.l+e,a={};a.Flags=t.read_shift(4)&63,t.l+=4,a.AlgID=t.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=t.read_shift(4),a.KeySize=t.read_shift(4),a.ProviderType=t.read_shift(4),t.l+=8,a.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,a}function bN(t,e){var r={},a=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,a),t.l=a,r}function uD(t){var e=hc(t);switch(e.Minor){case 2:return[e.Minor,fD(t)];case 3:return[e.Minor,dD()];case 4:return[e.Minor,hD(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function fD(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),a=_N(t,r),n=bN(t,t.length-t.l);return{t:"Std",h:a,v:n}}function dD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function hD(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),a={};return r.replace(Ms,function(s){var l=Sr(s);switch(Al(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){a[c]=l[c]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function mD(t,e){var r={},a=r.EncryptionVersionInfo=hc(t,4);if(e-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=t.read_shift(4),e-=4;var n=t.read_shift(4);return e-=4,r.EncryptionHeader=_N(t,n),e-=n,r.EncryptionVerifier=bN(t,e),r}function pD(t){var e={},r=e.EncryptionVersionInfo=hc(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function E2(t){var e=0,r,a=yN(t),n=a.length+1,s,l,c,f,d;for(r=mu(n),r[0]=a.length,s=1;s!=n;++s)r[s]=a[s-1];for(s=n-1;s>=0;--s)l=r[s],c=(e&16384)===0?0:1,f=e<<1&32767,d=c|f,e=d^l;return e^52811}var wN=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},n=function(l,c){return a(l^c)},s=function(l){for(var c=e[l.length-1],f=104,d=l.length-1;d>=0;--d)for(var m=l[d],v=0;v!=7;++v)m&64&&(c^=r[f]),m*=2,--f;return c};return function(l){for(var c=yN(l),f=s(c),d=c.length,m=mu(16),v=0;v!=16;++v)m[v]=0;var x,g,b;for((d&1)===1&&(x=f>>8,m[d]=n(t[0],x),--d,x=f&255,g=c[c.length-1],m[d]=n(g,x));d>0;)--d,x=f>>8,m[d]=n(c[d],x),--d,x=f&255,m[d]=n(c[d],x);for(d=15,b=15-c.length;b>0;)x=f>>8,m[d]=n(t[b],x),--d,--b,x=f&255,m[d]=n(c[d],x),--d,--b;return m}})(),gD=function(t,e,r,a,n){n||(n=e),a||(a=wN(t));var s,l;for(s=0;s!=e.length;++s)l=e[s],l^=a[r],l=(l>>5|l<<3)&255,n[s]=l,++r;return[n,r,a]},vD=function(t){var e=0,r=wN(t);return function(a){var n=gD("",a,e,r);return e=n[1],n[0]}};function xD(t,e,r,a){var n={key:Ln(t),verificationBytes:Ln(t)};return r.password&&(n.verifier=E2(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=vD(r.password)),n}function yD(t,e,r){var a=r||{};return a.Info=t.read_shift(2),t.l-=2,a.Info===1?a.Data=pD(t):a.Data=mD(t,e),a}function _D(t,e,r){var a={Type:r.biff>=8?t.read_shift(2):0};return a.Type?yD(t,e-2,a):xD(t,r.biff>=8?e:e-2,r,a),a}var SN=(function(){function t(n,s){switch(s.type){case"base64":return e(qi(n),s);case"binary":return e(n,s);case"buffer":return e(Pr&&Buffer.isBuffer(n)?n.toString("binary"):_u(n),s);case"array":return e(xf(n),s)}throw new Error("Unrecognized type "+s.type)}function e(n,s){var l=s||{},c=l.dense?[]:{},f=n.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(m,v){Array.isArray(c)&&(c[v]=[]);for(var x=/\\\w+\b/g,g=0,b,_=-1;b=x.exec(m);){switch(b[0]){case"\\cell":var w=m.slice(g,x.lastIndex-b[0].length);if(w[0]==" "&&(w=w.slice(1)),++_,w.length){var A={v:w,t:"s"};Array.isArray(c)?c[v][_]=A:c[wr({r:v,c:_})]=A}break}g=x.lastIndex}_>d.e.c&&(d.e.c=_)}),c["!ref"]=Or(d),c}function r(n,s){return bu(t(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],l=ea(n["!ref"]),c,f=Array.isArray(n),d=l.s.r;d<=l.e.r;++d){s.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)s.push("\\cellx"+(m+1));for(s.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var v=wr({r:d,c:m});c=f?(n[d]||[])[m]:n[v],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(mc(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:a}})();function bD(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function P0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function wD(t){var e=t[0]/255,r=t[1]/255,a=t[2]/255,n=Math.max(e,r,a),s=Math.min(e,r,a),l=n-s;if(l===0)return[0,0,e];var c=0,f=0,d=n+s;switch(f=l/(d>1?2-d:d),n){case e:c=((r-a)/l+6)%6;break;case r:c=(a-e)/l+2;break;case a:c=(e-r)/l+4;break}return[c/6,f,d/2]}function SD(t){var e=t[0],r=t[1],a=t[2],n=r*2*(a<.5?a:1-a),s=a-n/2,l=[s,s,s],c=6*e,f;if(r!==0)switch(c|0){case 0:case 6:f=n*c,l[0]+=n,l[1]+=f;break;case 1:f=n*(2-c),l[0]+=f,l[1]+=n;break;case 2:f=n*(c-2),l[1]+=n,l[2]+=f;break;case 3:f=n*(4-c),l[1]+=f,l[2]+=n;break;case 4:f=n*(c-4),l[2]+=n,l[0]+=f;break;case 5:f=n*(6-c),l[2]+=f,l[0]+=n;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function t1(t,e){if(e===0)return t;var r=wD(bD(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),P0(SD(r))}var NN=6,ND=15,kD=1,Ds=NN;function M0(t){return Math.floor((t+Math.round(128/Ds)/256)*Ds)}function I0(t){return Math.floor((t-5)/Ds*100+.5)/100}function r1(t){return Math.round((t*Ds+5)/Ds*256)/256}function lv(t){return r1(I0(M0(t)))}function A2(t){var e=Math.abs(t-lv(t)),r=Ds;if(e>.005)for(Ds=kD;Ds<ND;++Ds)Math.abs(t-lv(t))<=e&&(e=Math.abs(t-lv(t)),r=Ds);Ds=r}function pu(t){t.width?(t.wpx=M0(t.width),t.wch=I0(t.wpx),t.MDW=Ds):t.wpx?(t.wch=I0(t.wpx),t.width=r1(t.wch),t.MDW=Ds):typeof t.wch=="number"&&(t.width=r1(t.wch),t.wpx=M0(t.width),t.MDW=Ds),t.customWidth&&delete t.customWidth}var jD=96,kN=jD;function B0(t){return t*96/kN}function oh(t){return t*kN/96}var ED={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function AD(t,e,r,a){e.Borders=[];var n={},s=!1;(t[0].match(Ms)||[]).forEach(function(l){var c=Sr(l);switch(Al(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},c.diagonalUp&&(n.diagonalUp=Ia(c.diagonalUp)),c.diagonalDown&&(n.diagonalDown=Ia(c.diagonalDown)),e.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function CD(t,e,r,a){e.Fills=[];var n={},s=!1;(t[0].match(Ms)||[]).forEach(function(l){var c=Sr(l);switch(Al(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},e.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":c.patternType&&(n.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),c.indexed&&(n.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(n.bgColor.theme=parseInt(c.theme,10)),c.tint&&(n.bgColor.tint=parseFloat(c.tint)),c.rgb&&(n.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),c.theme&&(n.fgColor.theme=parseInt(c.theme,10)),c.tint&&(n.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(n.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function TD(t,e,r,a){e.Fonts=[];var n={},s=!1;(t[0].match(Ms)||[]).forEach(function(l){var c=Sr(l);switch(Al(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(n),n={};break;case"<name":c.val&&(n.name=Sa(c.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=c.val?Ia(c.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=c.val?Ia(c.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(c.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=c.val?Ia(c.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=c.val?Ia(c.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=c.val?Ia(c.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=c.val?Ia(c.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=c.val?Ia(c.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":c.val&&(n.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(n.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(n.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(n.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=r2[parseInt(c.val,10)];break;case"<color":if(n.color||(n.color={}),c.auto&&(n.color.auto=Ia(c.auto)),c.rgb)n.color.rgb=c.rgb.slice(-6);else if(c.indexed){n.color.index=parseInt(c.indexed,10);var f=df[n.color.index];n.color.index==81&&(f=df[1]),f||(f=df[1]),n.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(n.color.theme=parseInt(c.theme,10),c.tint&&(n.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=t1(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function OD(t,e,r){e.NumberFmt=[];for(var a=pn(_r),n=0;n<a.length;++n)e.NumberFmt[a[n]]=_r[a[n]];var s=t[0].match(Ms);if(s)for(n=0;n<s.length;++n){var l=Sr(s[n]);switch(Al(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Qr(Sa(l.formatCode)),f=parseInt(l.numFmtId,10);if(e.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=c}dc(c,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function RD(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)t[a]!=null&&(e[e.length]=Ft("numFmt",null,{numFmtId:a,formatCode:ga(t[a])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ft("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var pp=["numFmtId","fillId","fontId","borderId","xfId"],gp=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function DD(t,e,r){e.CellXf=[];var a,n=!1;(t[0].match(Ms)||[]).forEach(function(s){var l=Sr(s),c=0;switch(Al(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],c=0;c<pp.length;++c)a[pp[c]]&&(a[pp[c]]=parseInt(a[pp[c]],10));for(c=0;c<gp.length;++c)a[gp[c]]&&(a[gp[c]]=Ia(a[gp[c]]));if(e.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[a.numFmtId]==e.NumberFmt[c]){a.numFmtId=c;break}}e.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=Ia(l.wrapText)),a.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function FD(t){var e=[];return e[e.length]=Ft("cellXfs",null),t.forEach(function(r){e[e.length]=Ft("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ft("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var LD=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,d){var m={};if(!c)return m;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=c.match(e))&&OD(v,m,d),(v=c.match(n))&&TD(v,m,f,d),(v=c.match(a))&&CD(v,m,f,d),(v=c.match(s))&&AD(v,m,f,d),(v=c.match(r))&&DD(v,m,d),m}})();function jN(t,e){var r=[En,Ft("styleSheet",null,{xmlns:Cf[0],"xmlns:vt":Xn.vt})],a;return t.SSF&&(a=RD(t.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=FD(e.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function PD(t,e){var r=t.read_shift(2),a=Ls(t);return[r,a]}function MD(t,e,r){r||(r=ut(6+4*e.length)),r.write_shift(2,t),is(e,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function ID(t,e,r){var a={};a.sz=t.read_shift(2)/20;var n=yO(t);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=t.read_shift(2);switch(s===700&&(a.bold=1),t.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(a.underline=l);var c=t.read_shift(1);c>0&&(a.family=c);var f=t.read_shift(1);switch(f>0&&(a.charset=f),t.l++,a.color=xO(t),t.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Ls(t),a}function BD(t,e){e||(e=ut(153)),e.write_shift(2,t.sz*20),_O(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Zp(t.color,e);var a=0;return a=2,e.write_shift(1,a),is(t.name,e),e.length>e.l?e.slice(0,e.l):e}var UD=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],cv,qD=Ps;function Jw(t,e){e||(e=ut(84)),cv||(cv=v1(UD));var r=cv[t.patternType];r==null&&(r=40),e.write_shift(4,r);var a=0;if(r!=40)for(Zp({auto:1},e),Zp({auto:1},e);a<12;++a)e.write_shift(4,0);else{for(;a<4;++a)e.write_shift(4,0);for(;a<12;++a)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function zD(t,e){var r=t.l+e,a=t.read_shift(2),n=t.read_shift(2);return t.l=r,{ixfe:a,numFmtId:n}}function EN(t,e,r){r||(r=ut(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function e0(t,e){return e||(e=ut(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var HD=Ps;function $D(t,e){return e||(e=ut(51)),e.write_shift(1,0),e0(null,e),e0(null,e),e0(null,e),e0(null,e),e0(null,e),e.length>e.l?e.slice(0,e.l):e}function WD(t,e){return e||(e=ut(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Jp(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function VD(t,e,r){var a=ut(2052);return a.write_shift(4,t),Jp(e,a),Jp(r,a),a.length>a.l?a.slice(0,a.l):a}function GD(t,e,r){var a={};a.NumberFmt=[];for(var n in _r)a.NumberFmt[n]=_r[n];a.CellXf=[],a.Fonts=[];var s=[],l=!1;return xc(t,function(f,d,m){switch(m){case 44:a.NumberFmt[f[0]]=f[1],dc(f[1],f[0]);break;case 43:a.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=t1(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(m),l=!0;break;case 38:s.pop(),l=!1;break;default:if(d.T>0)s.push(m);else if(d.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),a}function YD(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&++r}),r!=0&&(Nt(t,615,Xo(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&Nt(t,44,MD(n,e[n]))}),Nt(t,616))}}function XD(t){var e=1;Nt(t,611,Xo(e)),Nt(t,43,BD({sz:12,color:{theme:1},name:"Calibri",family:2})),Nt(t,612)}function KD(t){var e=2;Nt(t,603,Xo(e)),Nt(t,45,Jw({patternType:"none"})),Nt(t,45,Jw({patternType:"gray125"})),Nt(t,604)}function JD(t){var e=1;Nt(t,613,Xo(e)),Nt(t,46,$D()),Nt(t,614)}function ZD(t){var e=1;Nt(t,626,Xo(e)),Nt(t,47,EN({numFmtId:0},65535)),Nt(t,627)}function QD(t,e){Nt(t,617,Xo(e.length)),e.forEach(function(r){Nt(t,47,EN(r,0))}),Nt(t,618)}function eF(t){var e=1;Nt(t,619,Xo(e)),Nt(t,48,WD({xfId:0,name:"Normal"})),Nt(t,620)}function tF(t){var e=0;Nt(t,505,Xo(e)),Nt(t,506)}function rF(t){var e=0;Nt(t,508,VD(e,"TableStyleMedium9","PivotStyleMedium4")),Nt(t,509)}function aF(t,e){var r=di();return Nt(r,278),YD(r,t.SSF),XD(r),KD(r),JD(r),ZD(r),QD(r,e.cellXfs),eF(r),tF(r),rF(r),Nt(r,279),r.end()}var nF=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function sF(t,e,r){e.themeElements.clrScheme=[];var a={};(t[0].match(Ms)||[]).forEach(function(n){var s=Sr(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[nF.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function iF(){}function oF(){}var lF=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,cF=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,uF=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function fF(t,e,r){e.themeElements={};var a;[["clrScheme",lF,sF],["fontScheme",cF,iF],["fmtScheme",uF,oF]].forEach(function(n){if(!(a=t.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,e,r)})}var dF=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function AN(t,e){(!t||t.length===0)&&(t=C2());var r,a={};if(!(r=t.match(dF)))throw new Error("themeElements not found in theme");return fF(r[0],a,e),a.raw=t,a}function C2(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[En];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function hF(t,e,r){var a=t.l+e,n=t.read_shift(4);if(n!==124226){if(!r.cellStyles){t.l=a;return}var s=t.slice(t.l);t.l=a;var l;try{l=_3(s,{type:"array"})}catch{return}var c=Mi(l,"theme/theme/theme1.xml",!0);if(c)return AN(c,r)}}function mF(t){return t.read_shift(4)}function pF(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=gF(t,4);break;case 2:e.xclrValue=oN(t);break;case 3:e.xclrValue=mF(t);break;case 4:t.l+=4;break}return t.l+=8,e}function gF(t,e){return Ps(t,e)}function vF(t,e){return Ps(t,e)}function xF(t){var e=t.read_shift(2),r=t.read_shift(2)-4,a=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=pF(t);break;case 6:a[1]=vF(t,r);break;case 14:case 15:a[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return a}function yF(t,e){var r=t.l+e;t.l+=2;var a=t.read_shift(2);t.l+=2;for(var n=t.read_shift(2),s=[];n-- >0;)s.push(xF(t,r-t.l));return{ixfe:a,ext:s}}function _F(t,e){e.forEach(function(r){r[0]})}function bF(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ls(t)}}function wF(t){var e=ut(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),is(t.name,e),e.slice(0,e.l)}function SF(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function NF(t){var e=ut(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function kF(t,e){var r=ut(8+2*e.length);return r.write_shift(4,t),is(e,r),r.slice(0,r.l)}function jF(t){return t.l+=4,t.read_shift(4)!=0}function EF(t,e){var r=ut(8);return r.write_shift(4,t),r.write_shift(4,1),r}function AF(t,e,r){var a={Types:[],Cell:[],Value:[]},n=r||{},s=[],l=!1,c=2;return xc(t,function(f,d,m){switch(m){case 335:a.Types.push({name:f.name});break;case 51:f.forEach(function(v){c==1?a.Cell.push({type:a.Types[v[0]-1].name,index:v[1]}):c==0&&a.Value.push({type:a.Types[v[0]-1].name,index:v[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:s.push(m),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!d.T){if(!l||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),a}function CF(){var t=di();return Nt(t,332),Nt(t,334,Xo(1)),Nt(t,335,wF({name:"XLDAPR",version:12e4,flags:3496657072})),Nt(t,336),Nt(t,339,kF(1,"XLDAPR")),Nt(t,52),Nt(t,35,Xo(514)),Nt(t,4096,Xo(0)),Nt(t,4097,co(1)),Nt(t,36),Nt(t,53),Nt(t,340),Nt(t,337,EF(1)),Nt(t,51,NF([[1,0]])),Nt(t,338),Nt(t,333),t.end()}function TF(t,e,r){var a={Types:[],Cell:[],Value:[]};if(!t)return a;var n=!1,s=2,l;return t.replace(Ms,function(c){var f=Sr(c);switch(Al(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==f.name&&(l=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[f.t-1].name,index:+f.v}):s==0&&a.Value.push({type:a.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),a}function CN(){var t=[En];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function OF(t){var e=[];if(!t)return e;var r=1;return(t.match(Ms)||[]).forEach(function(a){var n=Sr(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,e.push(n);break}}),e}function RF(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=wr(r);var a=t.read_shift(1);return a&2&&(e.l="1"),a&8&&(e.a="1"),e}function DF(t,e,r){var a=[];return xc(t,function(s,l,c){switch(c){case 63:a.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function FF(t,e,r,a){if(!t)return t;var n=a||{},s=!1;xc(t,function(c,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!f.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},n)}function LF(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Wd=1024;function TN(t,e){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Ft("xml",null,{"xmlns:v":Ri.v,"xmlns:o":Ri.o,"xmlns:x":Ri.x,"xmlns:mv":Ri.mv}).replace(/\/>/,">"),Ft("o:shapelayout",Ft("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ft("v:shapetype",[Ft("v:stroke",null,{joinstyle:"miter"}),Ft("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Wd<t*1e3;)Wd+=1e3;return e.forEach(function(s){var l=tn(s[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var f=c.type=="gradient"?Ft("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Ft("v:fill",f,c),m={on:"t",obscured:"t"};++Wd,n=n.concat(["<v:shape"+D0({id:"_x0000_s"+Wd,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Ft("v:shadow",null,m),Ft("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",_s("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),_s("x:AutoFill","False"),_s("x:Row",String(l.r)),_s("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function Zw(t,e,r,a){var n=Array.isArray(t),s;e.forEach(function(l){var c=tn(l.ref);if(n?(t[c.r]||(t[c.r]=[]),s=t[c.r][c.c]):s=t[l.ref],!s){s={t:"z"},n?t[c.r][c.c]=s:t[l.ref]=s;var f=ea(t["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var d=Or(f);d!==t["!ref"]&&(t["!ref"]=d)}s.c||(s.c=[]);var m={a:l.author,t:l.t,r:l.r,T:r};l.h&&(m.h=l.h);for(var v=s.c.length-1;v>=0;--v){if(!r&&s.c[v].T)return;r&&!s.c[v].T&&s.c.splice(v,1)}if(r&&a){for(v=0;v<a.length;++v)if(m.a==a[v].id){m.a=a[v].name||m.a;break}}s.c.push(m)})}function PF(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=Sr(c[0]),d={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},m=tn(f.ref);if(!(e.sheetRows&&e.sheetRows<=m.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!v&&!!v[1]&&j2(v[1])||{r:"",t:"",h:""};d.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),d.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=x.h),a.push(d)}}}}),a}function ON(t){var e=[En,Ft("comments",null,{xmlns:Cf[0]})],r=[];return e.push("<authors>"),t.forEach(function(a){a[1].forEach(function(n){var s=ga(n.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),e.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(a){var n=0,s=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(f){f.a&&(n=r.indexOf(ga(f.a))),s.push(f.t||"")}),e.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),s.length<=1)e.push(_s("t",ga(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,c=1;c<s.length;++c)l+=`Reply:
    `+s[c]+`
`;e.push(_s("t",ga(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function MF(t,e){var r=[],a=!1,n={},s=0;return t.replace(Ms,function(c,f){var d=Sr(c);switch(Al(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":s=f+c.length;break;case"</text>":n.t=t.slice(s,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),r}function IF(t,e,r){var a=[En,Ft("ThreadedComments",null,{xmlns:Xn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(n){var s="";(n[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var f={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?s=f.id:f.parentId=s,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),a.push(Ft("threadedComment",_s("text",l.t||""),f))})}),a.push("</ThreadedComments>"),a.join("")}function BF(t,e){var r=[],a=!1;return t.replace(Ms,function(s){var l=Sr(s);switch(Al(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function UF(t){var e=[En,Ft("personList",null,{xmlns:Xn.TCMNT,"xmlns:x":Cf[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,a){e.push(Ft("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function qF(t){var e={};e.iauthor=t.read_shift(4);var r=Df(t);return e.rfx=r.s,e.ref=wr(r.s),t.l+=16,e}function zF(t,e){return e==null&&(e=ut(36)),e.write_shift(4,t[1].iauthor),ph(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var HF=Ls;function $F(t){return is(t.slice(0,54))}function WF(t,e){var r=[],a=[],n={},s=!1;return xc(t,function(c,f,d){switch(d){case 632:a.push(c);break;case 635:n=c;break;case 637:n.t=c.t,n.h=c.h,n.r=c.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,e.sheetRows&&n.rfx&&e.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function VF(t){var e=di(),r=[];return Nt(e,628),Nt(e,630),t.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),Nt(e,632,$F(n.a)))})}),Nt(e,631),Nt(e,633),t.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var s={s:tn(a[0]),e:tn(a[0])};Nt(e,635,zF([s,n])),n.t&&n.t.length>0&&Nt(e,637,mO(n)),Nt(e,636),delete n.iauthor})}),Nt(e,634),Nt(e,629),e.end()}var GF="application/vnd.ms-office.vbaProject";function YF(t){var e=hr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");hr.utils.cfb_add(e,n,t.FileIndex[a].content)}}),hr.write(e)}function XF(t,e){e.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&hr.utils.cfb_add(t,n,e.FileIndex[a].content)}})}var RN=["xlsb","xlsm","xlam","biff8","xla"];function KF(){return{"!type":"dialog"}}function JF(){return{"!type":"dialog"}}function ZF(){return{"!type":"macro"}}function QF(){return{"!type":"macro"}}var Jd=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(a,n,s,l){var c=!1,f=!1;s.length==0?f=!0:s.charAt(0)=="["&&(f=!0,s=s.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var d=s.length>0?parseInt(s,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return c?m+=e.c:--m,f?d+=e.r:--d,n+(c?"":"$")+en(m)+(f?"":"$")+jn(d)}return function(n,s){return e=s,n.replace(t,r)}})(),T2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,O2=(function(){return function(e,r){return e.replace(T2,function(a,n,s,l,c,f){var d=v2(l)-(s?0:r.c),m=g2(f)-(c?0:r.r),v=m==0?"":c?m+1:"["+m+"]",x=d==0?"":s?d+1:"["+d+"]";return n+"R"+v+"C"+x})}})();function DN(t,e){return t.replace(T2,function(r,a,n,s,l,c){return a+(n=="$"?n+s:en(v2(s)+e.c))+(l=="$"?l+c:jn(g2(c)+e.r))})}function eL(t,e,r){var a=hi(e),n=a.s,s=tn(r),l={r:s.r-n.r,c:s.c-n.c};return DN(t,l)}function tL(t){return t.length!=1}function Qw(t){return t.replace(/_xlfn\./g,"")}function Dn(t){t.l+=1}function gu(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function FN(t,e,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return LN(t);r.biff==12&&(a=4)}var n=t.read_shift(a),s=t.read_shift(a),l=gu(t),c=gu(t);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function LN(t){var e=gu(t),r=gu(t),a=t.read_shift(1),n=t.read_shift(1);return{s:{r:e[0],c:a,cRel:e[1],rRel:e[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function rL(t,e,r){if(r.biff<8)return LN(t);var a=t.read_shift(r.biff==12?4:2),n=t.read_shift(r.biff==12?4:2),s=gu(t),l=gu(t);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function PN(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return aL(t);var a=t.read_shift(r&&r.biff==12?4:2),n=gu(t);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function aL(t){var e=gu(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function nL(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function sL(t,e,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return iL(t);var n=t.read_shift(a>=12?4:2),s=t.read_shift(2),l=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;n>524287;)n-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:l,rRel:c}}function iL(t){var e=t.read_shift(2),r=t.read_shift(1),a=(e&32768)>>15,n=(e&16384)>>14;return e&=16383,a==1&&e>=8192&&(e=e-16384),n==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:n,rRel:a}}function oL(t,e,r){var a=(t[t.l++]&96)>>5,n=FN(t,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function lL(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var l=FN(t,s,r);return[a,n,l]}function cL(t,e,r){var a=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function uL(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[a,n]}function fL(t,e,r){var a=(t[t.l++]&96)>>5,n=rL(t,e-1,r);return[a,n]}function dL(t,e,r){var a=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[a]}function e5(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function hL(t,e,r){t.l+=2;for(var a=t.read_shift(r&&r.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(t.read_shift(r&&r.biff==2?1:2));return n}function mL(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function pL(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function gL(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function vL(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[a]}function MN(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function xL(t){return t.read_shift(2),MN(t)}function yL(t){return t.read_shift(2),MN(t)}function _L(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=PN(t,0,r);return[a,n]}function bL(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=sL(t,0,r);return[a,n]}function wL(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=PN(t,0,r);return[a,n,s]}function SL(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(r&&r.biff<=3?1:2);return[jP[n],UN[n],a]}function NL(t,e,r){var a=t[t.l++],n=t.read_shift(1),s=r&&r.biff<=3?[a==88?-1:0,t.read_shift(1)]:kL(t);return[n,(s[0]===0?UN:kP)[s[1]]]}function kL(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function jL(t,e,r){t.l+=r&&r.biff==2?3:4}function EL(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var a=t.read_shift(2),n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function AL(t){return t.l++,yc[t.read_shift(1)]}function CL(t){return t.l++,t.read_shift(2)}function TL(t){return t.l++,t.read_shift(1)!==0}function OL(t){return t.l++,Fs(t)}function RL(t,e,r){return t.l++,J0(t,e-1,r)}function DL(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=_n(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=yc[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Fs(t);break;case 2:r[1]=Ff(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function FL(t,e,r){for(var a=t.read_shift(r.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((r.biff==12?Df:_1)(t));return n}function LL(t,e,r){var a=0,n=0;r.biff==12?(a=t.read_shift(4),n=t.read_shift(4)):(n=1+t.read_shift(1),a=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var s=0,l=[];s!=a&&(l[s]=[]);++s)for(var c=0;c!=n;++c)l[s][c]=DL(t,r.biff);return l}function PL(t,e,r){var a=t.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=t.read_shift(n);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[a,0,s]}function ML(t,e,r){if(r.biff==5)return IL(t);var a=t.read_shift(1)>>>5&3,n=t.read_shift(2),s=t.read_shift(4);return[a,n,s]}function IL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var a=t.read_shift(2);return t.l+=12,[e,r,a]}function BL(t,e,r){var a=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function UL(t,e,r){var a=t.read_shift(1)>>>5&3,n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function qL(t,e,r){var a=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[a]}function zL(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[a,n]}var HL=Ps,$L=Ps,WL=Ps;function Q0(t,e,r){return t.l+=2,[nL(t)]}function R2(t){return t.l+=6,[]}var VL=Q0,GL=R2,YL=R2,XL=Q0;function IN(t){return t.l+=2,[Ln(t),t.read_shift(2)&1]}var KL=Q0,JL=IN,ZL=R2,QL=Q0,eP=Q0,tP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function rP(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n=t.read_shift(2),s=t.read_shift(2),l=tP[r>>2&31];return{ixti:e,coltype:r&3,rt:l,idx:a,c:n,C:s}}function aP(t){return t.l+=2,[t.read_shift(4)]}function nP(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function sP(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function iP(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function oP(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function lP(t){return t.l+=4,[0,0]}var t5={1:{n:"PtgExp",f:EL},2:{n:"PtgTbl",f:WL},3:{n:"PtgAdd",f:Dn},4:{n:"PtgSub",f:Dn},5:{n:"PtgMul",f:Dn},6:{n:"PtgDiv",f:Dn},7:{n:"PtgPower",f:Dn},8:{n:"PtgConcat",f:Dn},9:{n:"PtgLt",f:Dn},10:{n:"PtgLe",f:Dn},11:{n:"PtgEq",f:Dn},12:{n:"PtgGe",f:Dn},13:{n:"PtgGt",f:Dn},14:{n:"PtgNe",f:Dn},15:{n:"PtgIsect",f:Dn},16:{n:"PtgUnion",f:Dn},17:{n:"PtgRange",f:Dn},18:{n:"PtgUplus",f:Dn},19:{n:"PtgUminus",f:Dn},20:{n:"PtgPercent",f:Dn},21:{n:"PtgParen",f:Dn},22:{n:"PtgMissArg",f:Dn},23:{n:"PtgStr",f:RL},26:{n:"PtgSheet",f:nP},27:{n:"PtgEndSheet",f:sP},28:{n:"PtgErr",f:AL},29:{n:"PtgBool",f:TL},30:{n:"PtgInt",f:CL},31:{n:"PtgNum",f:OL},32:{n:"PtgArray",f:dL},33:{n:"PtgFunc",f:SL},34:{n:"PtgFuncVar",f:NL},35:{n:"PtgName",f:PL},36:{n:"PtgRef",f:_L},37:{n:"PtgArea",f:oL},38:{n:"PtgMemArea",f:BL},39:{n:"PtgMemErr",f:HL},40:{n:"PtgMemNoMem",f:$L},41:{n:"PtgMemFunc",f:UL},42:{n:"PtgRefErr",f:qL},43:{n:"PtgAreaErr",f:cL},44:{n:"PtgRefN",f:bL},45:{n:"PtgAreaN",f:fL},46:{n:"PtgMemAreaN",f:iP},47:{n:"PtgMemNoMemN",f:oP},57:{n:"PtgNameX",f:ML},58:{n:"PtgRef3d",f:wL},59:{n:"PtgArea3d",f:lL},60:{n:"PtgRefErr3d",f:zL},61:{n:"PtgAreaErr3d",f:uL},255:{}},cP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},uP={1:{n:"PtgElfLel",f:IN},2:{n:"PtgElfRw",f:QL},3:{n:"PtgElfCol",f:VL},6:{n:"PtgElfRwV",f:eP},7:{n:"PtgElfColV",f:XL},10:{n:"PtgElfRadical",f:KL},11:{n:"PtgElfRadicalS",f:ZL},13:{n:"PtgElfColS",f:GL},15:{n:"PtgElfColSV",f:YL},16:{n:"PtgElfRadicalLel",f:JL},25:{n:"PtgList",f:rP},29:{n:"PtgSxName",f:aP},255:{}},fP={0:{n:"PtgAttrNoop",f:lP},1:{n:"PtgAttrSemi",f:vL},2:{n:"PtgAttrIf",f:pL},4:{n:"PtgAttrChoose",f:hL},8:{n:"PtgAttrGoto",f:mL},16:{n:"PtgAttrSum",f:jL},32:{n:"PtgAttrBaxcel",f:e5},33:{n:"PtgAttrBaxcel",f:e5},64:{n:"PtgAttrSpace",f:xL},65:{n:"PtgAttrSpaceSemi",f:yL},128:{n:"PtgAttrIfError",f:gL},255:{}};function em(t,e,r,a){if(a.biff<8)return Ps(t,e);for(var n=t.l+e,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=LL(t,0,a),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=FL(t,r[l][1],a),s.push(r[l][2]);break;case"PtgExp":a&&a.biff==12&&(r[l][1][1]=t.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return e=n-t.l,e!==0&&s.push(Ps(t,e)),s}function tm(t,e,r){for(var a=t.l+e,n,s,l=[];a!=t.l;)e=a-t.l,s=t[t.l],n=t5[s]||t5[cP[s]],(s===24||s===25)&&(n=(s===24?uP:fP)[t[t.l+1]]),!n||!n.f?Ps(t,e):l.push([n.n,n.f(t,e,r)]);return l}function dP(t){for(var e=[],r=0;r<t.length;++r){for(var a=t[r],n=[],s=0;s<a.length;++s){var l=a[s];if(l)switch(l[0]){case 2:n.push('"'+l[1].replace(/"/g,'""')+'"');break;default:n.push(l[1])}else n.push("")}e.push(n.join(","))}return e.join(";")}var hP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function mP(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function BN(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var a=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(t[a[0]][0]){case 357:return n=a[1]==-1?"#REF":t.SheetNames[a[1]],a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[a[0]][0];case 355:default:return"SH33TJSSRC"+t[a[0]][0]}switch(t[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":t.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 14849:return t[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[a[0]][0][3]?(n=a[1]==-1?"#REF":t[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+t[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function r5(t,e,r){var a=BN(t,e,r);return a=="#REF"?a:mP(a,r)}function Rs(t,e,r,a,n){var s=n&&n.biff||8,l={s:{c:0,r:0}},c=[],f,d,m,v=0,x=0,g,b="";if(!t[0]||!t[0][0])return"";for(var _=-1,w="",A=0,C=t[0].length;A<C;++A){var E=t[0][A];switch(E[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),d=c.pop(),_>=0){switch(t[0][_][1][0]){case 0:w=hn(" ",t[0][_][1][1]);break;case 1:w=hn("\r",t[0][_][1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}d=d+w,_=-1}c.push(d+hP[E[0]]+f);break;case"PtgIsect":f=c.pop(),d=c.pop(),c.push(d+" "+f);break;case"PtgUnion":f=c.pop(),d=c.pop(),c.push(d+","+f);break;case"PtgRange":f=c.pop(),d=c.pop(),c.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=h0(E[1][1],l,n),c.push(m0(m,s));break;case"PtgRefN":m=r?h0(E[1][1],r,n):E[1][1],c.push(m0(m,s));break;case"PtgRef3d":v=E[1][1],m=h0(E[1][2],l,n),b=r5(a,v,n),c.push(b+"!"+m0(m,s));break;case"PtgFunc":case"PtgFuncVar":var R=E[1][0],Y=E[1][1];R||(R=0),R&=127;var W=R==0?[]:c.slice(-R);c.length-=R,Y==="User"&&(Y=W.shift()),c.push(Y+"("+W.join(",")+")");break;case"PtgBool":c.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(E[1]);break;case"PtgNum":c.push(String(E[1]));break;case"PtgStr":c.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(E[1]);break;case"PtgAreaN":g=Ow(E[1][1],r?{s:r}:l,n),c.push(sv(g,n));break;case"PtgArea":g=Ow(E[1][1],l,n),c.push(sv(g,n));break;case"PtgArea3d":v=E[1][1],g=E[1][2],b=r5(a,v,n),c.push(b+"!"+sv(g,n));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=E[1][2];var B=(a.names||[])[x-1]||(a[0]||[])[x],q=B?B.Name:"SH33TJSNAME"+String(x);q&&q.slice(0,6)=="_xlfn."&&!n.xlfn&&(q=q.slice(6)),c.push(q);break;case"PtgNameX":var L=E[1][1];x=E[1][2];var J;if(n.biff<=5)L<0&&(L=-L),a[L]&&(J=a[L][x]);else{var D="";if(((a[L]||[])[0]||[])[0]==14849||(((a[L]||[])[0]||[])[0]==1025?a[L][x]&&a[L][x].itab>0&&(D=a.SheetNames[a[L][x].itab-1]+"!"):D=a.SheetNames[x-1]+"!"),a[L]&&a[L][x])D+=a[L][x].Name;else if(a[0]&&a[0][x])D+=a[0][x].Name;else{var T=(BN(a,L,n)||"").split(";;");T[x-1]?D=T[x-1]:D+="SH33TJSERRX"}c.push(D);break}J||(J={Name:"SH33TJSERRY"}),c.push(J.Name);break;case"PtgParen":var M="(",V=")";if(_>=0){switch(w="",t[0][_][1][0]){case 2:M=hn(" ",t[0][_][1][1])+M;break;case 3:M=hn("\r",t[0][_][1][1])+M;break;case 4:V=hn(" ",t[0][_][1][1])+V;break;case 5:V=hn("\r",t[0][_][1][1])+V;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}_=-1}c.push(M+c.pop()+V);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":m={c:E[1][1],r:E[1][0]};var ie={c:r.c,r:r.r};if(a.sharedf[wr(m)]){var X=a.sharedf[wr(m)];c.push(Rs(X,l,ie,a,n))}else{var Z=!1;for(f=0;f!=a.arrayf.length;++f)if(d=a.arrayf[f],!(m.c<d[0].s.c||m.c>d[0].e.c)&&!(m.r<d[0].s.r||m.r>d[0].e.r)){c.push(Rs(d[1],l,ie,a,n)),Z=!0;break}Z||c.push(E[1])}break;case"PtgArray":c.push("{"+dP(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&_>=0&&K.indexOf(t[0][A][0])==-1){E=t[0][_];var re=!0;switch(E[1][0]){case 4:re=!1;case 0:w=hn(" ",E[1][1]);break;case 5:re=!1;case 1:w=hn("\r",E[1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}c.push((re?w:"")+c.pop()+(re?"":w)),_=-1}}if(c.length>1&&n.WTF)throw new Error("bad formula stack");return c[0]}function pP(t,e,r){var a=t.l+e,n=r.biff==2?1:2,s,l=t.read_shift(n);if(l==65535)return[[],Ps(t,e-2)];var c=tm(t,l,r);return e!==l+n&&(s=em(t,e-l-n,c,r)),t.l=a,[c,s]}function gP(t,e,r){var a=t.l+e,n=r.biff==2?1:2,s,l=t.read_shift(n);if(l==65535)return[[],Ps(t,e-2)];var c=tm(t,l,r);return e!==l+n&&(s=em(t,e-l-n,c,r)),t.l=a,[c,s]}function vP(t,e,r,a){var n=t.l+e,s=tm(t,a,r),l;return n!==t.l&&(l=em(t,n-t.l,s,r)),[s,l]}function xP(t,e,r){var a=t.l+e,n,s=t.read_shift(2),l=tm(t,s,r);return s==65535?[[],Ps(t,e-2)]:(e!==s+2&&(n=em(t,a-s-2,l,r)),[l,n])}function yP(t){var e;if(lc(t,t.l+6)!==65535)return[Fs(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function _P(t){if(t==null){var e=ut(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return yf(t);return yf(0)}function uv(t,e,r){var a=t.l+e,n=Cl(t);r.biff==2&&++t.l;var s=yP(t),l=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var c=gP(t,a-t.l,r);return{cell:n,val:s[0],formula:c,shared:l>>3&1,tt:s[1]}}function bP(t,e,r,a,n){var s=bf(e,r,n),l=_P(t.v),c=ut(6),f=33;c.write_shift(2,f),c.write_shift(4,0);for(var d=ut(t.bf.length),m=0;m<t.bf.length;++m)d[m]=t.bf[m];var v=ss([s,l,c,d]);return v}function b1(t,e,r){var a=t.read_shift(4),n=tm(t,a,r),s=t.read_shift(4),l=s>0?em(t,s,n,r):null;return[n,l]}var wP=b1,w1=b1,SP=b1,NP=b1,kP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},UN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},jP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function a5(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function EP(t){var e="of:="+t.replace(T2,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function fv(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function AP(t){return t.replace(/\./,"!")}var g0={},Zd={},v0=typeof Map<"u";function D2(t,e,r){var a=0,n=t.length;if(r){if(v0?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=v0?r.get(e):r[e];a<s.length;++a)if(t[s[a]].t===e)return t.Count++,s[a]}}else for(;a<n;++a)if(t[a].t===e)return t.Count++,a;return t[n]={t:e},t.Count++,t.Unique++,r&&(v0?(r.has(e)||r.set(e,[]),r.get(e).push(n)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(n))),n}function S1(t,e){var r={min:t+1,max:t+1},a=-1;return e.MDW&&(Ds=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?a=I0(e.wpx):e.wch!=null&&(a=e.wch),a>-1?(r.width=r1(a),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function pf(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function wu(t,e,r){var a=r.revssf[e.z!=null?e.z:"General"],n=60,s=t.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){dc(e.z,n),r.ssf[n]=e.z,r.revssf[e.z]=a=n;break}}for(n=0;n!=s;++n)if(t[n].numFmtId===a)return n;return t[s]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function qN(t,e,r,a,n,s){try{a.cellNF&&(t.z=_r[e])}catch(c){if(a.WTF)throw c}if(!(t.t==="z"&&!a.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Ua(t.v)),(!a||a.cellText!==!1)&&t.t!=="z")try{if(_r[e]==null&&dc(k8[e]||"General",e),t.t==="e")t.w=t.w||yc[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=O0(t.v);else if(t.t==="d"){var l=Kn(t.v);(l|0)===l?t.w=l.toString(10):t.w=O0(l)}else{if(t.v===void 0)return"";t.w=vf(t.v,Zd)}else t.t==="d"?t.w=fo(e,Kn(t.v),Zd):t.w=fo(e,t.v,Zd)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=t1(n.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),a.WTF&&(t.s.fgColor.raw_rgb=n.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=t1(n.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),a.WTF&&(t.s.bgColor.raw_rgb=n.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&s.Fills)throw c}}}function CP(t,e,r){if(t&&t["!ref"]){var a=ea(t["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function TP(t,e){var r=ea(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Or(r))}var OP=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,RP=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,DP=/<(?:\w:)?hyperlink [^>]*>/mg,FP=/"(\w*:\w*)"/,LP=/<(?:\w:)?col\b[^>]*[\/]?>/g,PP=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,MP=/<(?:\w:)?pageMargins[^>]*\/>/g,zN=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,IP=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,BP=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function UP(t,e,r,a,n,s,l){if(!t)return t;a||(a={"!id":{}});var c=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",m="",v=t.match(RP);v?(d=t.slice(0,v.index),m=t.slice(v.index+v[0].length)):d=m=t;var x=d.match(zN);x?F2(x[0],c,n,r):(x=d.match(IP))&&zP(x[0],x[1]||"",c,n,r);var g=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var b=d.slice(g,g+50).match(FP);b&&TP(c,b[1])}var _=d.match(BP);_&&_[1]&&t9(_[1],n);var w=[];if(e.cellStyles){var A=d.match(LP);A&&KP(w,A)}v&&n9(v[1],c,e,f,s,l);var C=m.match(PP);C&&(c["!autofilter"]=ZP(C[0]));var E=[],R=m.match(OP);if(R)for(g=0;g!=R.length;++g)E[g]=ea(R[g].slice(R[g].indexOf('"')+1));var Y=m.match(DP);Y&&GP(c,Y,a);var W=m.match(MP);if(W&&(c["!margins"]=YP(Sr(W[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=Or(f)),e.sheetRows>0&&c["!ref"]){var B=ea(c["!ref"]);e.sheetRows<=+B.e.r&&(B.e.r=e.sheetRows-1,B.e.r>f.e.r&&(B.e.r=f.e.r),B.e.r<B.s.r&&(B.s.r=B.e.r),B.e.c>f.e.c&&(B.e.c=f.e.c),B.e.c<B.s.c&&(B.s.c=B.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Or(B))}return w.length>0&&(c["!cols"]=w),E.length>0&&(c["!merges"]=E),c}function qP(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Or(t[r])+'"/>';return e+"</mergeCells>"}function F2(t,e,r,a){var n=Sr(t);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Qr(Sa(n.codeName)))}function zP(t,e,r,a,n){F2(t.slice(0,t.indexOf(">")),r,a,n)}function HP(t,e,r,a,n){var s=!1,l={},c=null;if(a.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[r];try{e.Workbook&&(f=e.Workbook.Sheets[r].CodeName||f)}catch{}s=!0,l.codeName=kl(ga(f))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),c=(c||"")+Ft("outlinePr",null,d)}!s&&!c||(n[n.length]=Ft("sheetPr",c,l))}var $P=["objects","scenarios","selectLockedCells","selectUnlockedCells"],WP=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function VP(t){var e={sheet:1};return $P.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),WP.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=E2(t.password).toString(16).toUpperCase()),Ft("sheetProtection",null,e)}function GP(t,e,r){for(var a=Array.isArray(t),n=0;n!=e.length;++n){var s=Sr(Sa(e[n]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+Qr(s.location))):(s.Target="#"+Qr(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=ea(s.ref),f=c.s.r;f<=c.e.r;++f)for(var d=c.s.c;d<=c.e.c;++d){var m=wr({c:d,r:f});a?(t[f]||(t[f]=[]),t[f][d]||(t[f][d]={t:"z",v:void 0}),t[f][d].l=s):(t[m]||(t[m]={t:"z",v:void 0}),t[m].l=s)}}}function YP(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function XP(t){return pf(t),Ft("pageMargins",null,t)}function KP(t,e){for(var r=!1,a=0;a!=e.length;++a){var n=Sr(e[a],!0);n.hidden&&(n.hidden=Ia(n.hidden));var s=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,A2(n.width)),pu(n);s<=l;)t[s++]=qa(n)}}function JP(t,e){for(var r=["<cols>"],a,n=0;n!=e.length;++n)(a=e[n])&&(r[r.length]=Ft("col",null,S1(n,a)));return r[r.length]="</cols>",r.join("")}function ZP(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function QP(t,e,r,a){var n=typeof t.ref=="string"?t.ref:Or(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=hi(n);l.s.r==l.e.r&&(l.e.r=hi(e["!ref"]).e.r,n=Or(l));for(var c=0;c<s.length;++c){var f=s[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==a){f.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Ft("autoFilter",null,{ref:n})}var e9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function t9(t,e){e.Views||(e.Views=[{}]),(t.match(e9)||[]).forEach(function(r,a){var n=Sr(r);e.Views[a]||(e.Views[a]={}),+n.zoomScale&&(e.Views[a].zoom=+n.zoomScale),Ia(n.rightToLeft)&&(e.Views[a].RTL=!0)})}function r9(t,e,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Ft("sheetViews",Ft("sheetView",null,n),{})}function a9(t,e,r,a){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var n="",s=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":n=t.v?"1":"0";break;case"n":n=""+t.v;break;case"e":n=yc[t.v];break;case"d":a&&a.cellDates?n=Ua(t.v,-1).toISOString():(t=qa(t),t.t="n",n=""+(t.v=Kn(Ua(t.v)))),typeof t.z>"u"&&(t.z=_r[14]);break;default:n=t.v;break}var c=_s("v",ga(n)),f={r:e},d=wu(a.cellXfs,t,a);switch(d!==0&&(f.s=d),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){c=_s("v",""+D2(a.Strings,t.v,a.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=s&&(t.t=s,t.v=l),typeof t.f=="string"&&t.f){var m=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;c=Ft("f",ga(t.f),m)+(t.v!=null?c:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(f.cm=1),Ft("c",c,f)}var n9=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=R0("v"),l=R0("f");return function(f,d,m,v,x,g){for(var b=0,_="",w=[],A=[],C=0,E=0,R=0,Y="",W,B,q=0,L=0,J,D,T=0,M=0,V=Array.isArray(g.CellXf),ie,X=[],Z=[],K=Array.isArray(d),re=[],de={},U=!1,k=!!m.sheetStubs,F=f.split(e),I=0,z=F.length;I!=z;++I){_=F[I].trim();var te=_.length;if(te!==0){var se=0;e:for(b=0;b<te;++b)switch(_[b]){case">":if(_[b-1]!="/"){++b;break e}if(m&&m.cellStyles){if(B=Sr(_.slice(se,b),!0),q=B.r!=null?parseInt(B.r,10):q+1,L=-1,m.sheetRows&&m.sheetRows<q)continue;de={},U=!1,B.ht&&(U=!0,de.hpt=parseFloat(B.ht),de.hpx=oh(de.hpt)),B.hidden=="1"&&(U=!0,de.hidden=!0),B.outlineLevel!=null&&(U=!0,de.level=+B.outlineLevel),U&&(re[q-1]=de)}break;case"<":se=b;break}if(se>=b)break;if(B=Sr(_.slice(se,b),!0),q=B.r!=null?parseInt(B.r,10):q+1,L=-1,!(m.sheetRows&&m.sheetRows<q)){v.s.r>q-1&&(v.s.r=q-1),v.e.r<q-1&&(v.e.r=q-1),m&&m.cellStyles&&(de={},U=!1,B.ht&&(U=!0,de.hpt=parseFloat(B.ht),de.hpx=oh(de.hpt)),B.hidden=="1"&&(U=!0,de.hidden=!0),B.outlineLevel!=null&&(U=!0,de.level=+B.outlineLevel),U&&(re[q-1]=de)),w=_.slice(b).split(t);for(var pe=0;pe!=w.length&&w[pe].trim().charAt(0)=="<";++pe);for(w=w.slice(pe),b=0;b!=w.length;++b)if(_=w[b].trim(),_.length!==0){if(A=_.match(r),C=b,E=0,R=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,A!=null&&A.length===2){for(C=0,Y=A[1],E=0;E!=Y.length&&!((R=Y.charCodeAt(E)-64)<1||R>26);++E)C=26*C+R;--C,L=C}else++L;for(E=0;E!=_.length&&_.charCodeAt(E)!==62;++E);if(++E,B=Sr(_.slice(0,E),!0),B.r||(B.r=wr({r:q-1,c:L})),Y=_.slice(E),W={t:""},(A=Y.match(s))!=null&&A[1]!==""&&(W.v=Qr(A[1])),m.cellFormula){if((A=Y.match(l))!=null&&A[1]!==""){if(W.f=Qr(Sa(A[1])).replace(/\r\n/g,`
`),m.xlfn||(W.f=Qw(W.f)),A[0].indexOf('t="array"')>-1)W.F=(Y.match(n)||[])[1],W.F.indexOf(":")>-1&&X.push([ea(W.F),W.F]);else if(A[0].indexOf('t="shared"')>-1){D=Sr(A[0]);var ve=Qr(Sa(A[1]));m.xlfn||(ve=Qw(ve)),Z[parseInt(D.si,10)]=[D,ve,B.r]}}else(A=Y.match(/<f[^>]*\/>/))&&(D=Sr(A[0]),Z[D.si]&&(W.f=eL(Z[D.si][1],Z[D.si][2],B.r)));var _e=tn(B.r);for(E=0;E<X.length;++E)_e.r>=X[E][0].s.r&&_e.r<=X[E][0].e.r&&_e.c>=X[E][0].s.c&&_e.c<=X[E][0].e.c&&(W.F=X[E][1])}if(B.t==null&&W.v===void 0)if(W.f||W.F)W.v=0,W.t="n";else if(k)W.t="z";else continue;else W.t=B.t||"n";switch(v.s.c>L&&(v.s.c=L),v.e.c<L&&(v.e.c=L),W.t){case"n":if(W.v==""||W.v==null){if(!k)continue;W.t="z"}else W.v=parseFloat(W.v);break;case"s":if(typeof W.v>"u"){if(!k)continue;W.t="z"}else J=g0[parseInt(W.v,10)],W.v=J.t,W.r=J.r,m.cellHTML&&(W.h=J.h);break;case"str":W.t="s",W.v=W.v!=null?Sa(W.v):"",m.cellHTML&&(W.h=d2(W.v));break;case"inlineStr":A=Y.match(a),W.t="s",A!=null&&(J=j2(A[1]))?(W.v=J.t,m.cellHTML&&(W.h=J.h)):W.v="";break;case"b":W.v=Ia(W.v);break;case"d":m.cellDates?W.v=Ua(W.v,1):(W.v=Kn(Ua(W.v,1)),W.t="n");break;case"e":(!m||m.cellText!==!1)&&(W.w=W.v),W.v=$3[W.v];break}if(T=M=0,ie=null,V&&B.s!==void 0&&(ie=g.CellXf[B.s],ie!=null&&(ie.numFmtId!=null&&(T=ie.numFmtId),m.cellStyles&&ie.fillId!=null&&(M=ie.fillId))),qN(W,T,M,m,x,g),m.cellDates&&V&&W.t=="n"&&dh(_r[T])&&(W.t="d",W.v=y1(W.v)),B.cm&&m.xlmeta){var Pe=(m.xlmeta.Cell||[])[+B.cm-1];Pe&&Pe.type=="XLDAPR"&&(W.D=!0)}if(K){var fe=tn(B.r);d[fe.r]||(d[fe.r]=[]),d[fe.r][fe.c]=W}else d[B.r]=W}}}}re.length>0&&(d["!rows"]=re)}})();function s9(t,e,r,a){var n=[],s=[],l=ea(t["!ref"]),c="",f,d="",m=[],v=0,x=0,g=t["!rows"],b=Array.isArray(t),_={r:d},w,A=-1;for(x=l.s.c;x<=l.e.c;++x)m[x]=en(x);for(v=l.s.r;v<=l.e.r;++v){for(s=[],d=jn(v),x=l.s.c;x<=l.e.c;++x){f=m[x]+d;var C=b?(t[v]||[])[x]:t[f];C!==void 0&&(c=a9(C,f,t,e))!=null&&s.push(c)}(s.length>0||g&&g[v])&&(_={r:d},g&&g[v]&&(w=g[v],w.hidden&&(_.hidden=1),A=-1,w.hpx?A=B0(w.hpx):w.hpt&&(A=w.hpt),A>-1&&(_.ht=A,_.customHeight=1),w.level&&(_.outlineLevel=w.level)),n[n.length]=Ft("row",s.join(""),_))}if(g)for(;v<g.length;++v)g&&g[v]&&(_={r:v+1},w=g[v],w.hidden&&(_.hidden=1),A=-1,w.hpx?A=B0(w.hpx):w.hpt&&(A=w.hpt),A>-1&&(_.ht=A,_.customHeight=1),w.level&&(_.outlineLevel=w.level),n[n.length]=Ft("row","",_));return n.join("")}function HN(t,e,r,a){var n=[En,Ft("worksheet",null,{xmlns:Cf[0],"xmlns:r":Xn.r})],s=r.SheetNames[t],l=0,c="",f=r.Sheets[s];f==null&&(f={});var d=f["!ref"]||"A1",m=ea(d);if(m.e.c>16383||m.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),d=Or(m)}a||(a={}),f["!comments"]=[];var v=[];HP(f,r,t,e,n),n[n.length]=Ft("dimension",null,{ref:d}),n[n.length]=r9(f,e,t,r),e.sheetFormat&&(n[n.length]=Ft("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(n[n.length]=JP(f,f["!cols"])),n[l=n.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(c=s9(f,e),c.length>0&&(n[n.length]=c)),n.length>l+1&&(n[n.length]="</sheetData>",n[l]=n[l].replace("/>",">")),f["!protect"]&&(n[n.length]=VP(f["!protect"])),f["!autofilter"]!=null&&(n[n.length]=QP(f["!autofilter"],f,r,t)),f["!merges"]!=null&&f["!merges"].length>0&&(n[n.length]=qP(f["!merges"]));var x=-1,g,b=-1;return f["!links"].length>0&&(n[n.length]="<hyperlinks>",f["!links"].forEach(function(_){_[1].Target&&(g={ref:_[0]},_[1].Target.charAt(0)!="#"&&(b=ma(a,-1,ga(_[1].Target).replace(/#.*$/,""),Ir.HLINK),g["r:id"]="rId"+b),(x=_[1].Target.indexOf("#"))>-1&&(g.location=ga(_[1].Target.slice(x+1))),_[1].Tooltip&&(g.tooltip=ga(_[1].Tooltip)),n[n.length]=Ft("hyperlink",null,g))}),n[n.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(n[n.length]=XP(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(n[n.length]=_s("ignoredErrors",Ft("ignoredError",null,{numberStoredAsText:1,sqref:d}))),v.length>0&&(b=ma(a,-1,"../drawings/drawing"+(t+1)+".xml",Ir.DRAW),n[n.length]=Ft("drawing",null,{"r:id":"rId"+b}),f["!drawing"]=v),f["!comments"].length>0&&(b=ma(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ir.VML),n[n.length]=Ft("legacyDrawing",null,{"r:id":"rId"+b}),f["!legacy"]=b),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function i9(t,e){var r={},a=t.l+e;r.r=t.read_shift(4),t.l+=4;var n=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=a,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=n/20),r}function o9(t,e,r){var a=ut(145),n=(r["!rows"]||[])[t]||{};a.write_shift(4,t),a.write_shift(4,0);var s=320;n.hpx?s=B0(n.hpx)*20:n.hpt&&(s=n.hpt*20),a.write_shift(2,s),a.write_shift(1,0);var l=0;n.level&&(l|=n.level),n.hidden&&(l|=16),(n.hpx||n.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var c=0,f=a.l;a.l+=4;for(var d={r:t,c:0},m=0;m<16;++m)if(!(e.s.c>m+1<<10||e.e.c<m<<10)){for(var v=-1,x=-1,g=m<<10;g<m+1<<10;++g){d.c=g;var b=Array.isArray(r)?(r[d.r]||[])[d.c]:r[wr(d)];b&&(v<0&&(v=g),x=g)}v<0||(++c,a.write_shift(4,v),a.write_shift(4,x))}var _=a.l;return a.l=f,a.write_shift(4,c),a.l=_,a.length>a.l?a.slice(0,a.l):a}function l9(t,e,r,a){var n=o9(a,r,e);(n.length>17||(e["!rows"]||[])[a])&&Nt(t,0,n)}var c9=Df,u9=ph;function f9(){}function d9(t,e){var r={},a=t[t.l];return++t.l,r.above=!(a&64),r.left=!(a&128),t.l+=18,r.name=pO(t),r}function h9(t,e,r){r==null&&(r=ut(84+4*t.length));var a=192;e&&(e.above&&(a&=-65),e.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return Zp({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),B3(t,r),r.slice(0,r.l)}function m9(t){var e=mo(t);return[e]}function p9(t,e,r){return r==null&&(r=ut(8)),Tf(e,r)}function g9(t){var e=Of(t);return[e]}function v9(t,e,r){return r==null&&(r=ut(4)),Rf(e,r)}function x9(t){var e=mo(t),r=t.read_shift(1);return[e,r,"b"]}function y9(t,e,r){return r==null&&(r=ut(9)),Tf(e,r),r.write_shift(1,t.v?1:0),r}function _9(t){var e=Of(t),r=t.read_shift(1);return[e,r,"b"]}function b9(t,e,r){return r==null&&(r=ut(5)),Rf(e,r),r.write_shift(1,t.v?1:0),r}function w9(t){var e=mo(t),r=t.read_shift(1);return[e,r,"e"]}function S9(t,e,r){return r==null&&(r=ut(9)),Tf(e,r),r.write_shift(1,t.v),r}function N9(t){var e=Of(t),r=t.read_shift(1);return[e,r,"e"]}function k9(t,e,r){return r==null&&(r=ut(8)),Rf(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function j9(t){var e=mo(t),r=t.read_shift(4);return[e,r,"s"]}function E9(t,e,r){return r==null&&(r=ut(12)),Tf(e,r),r.write_shift(4,e.v),r}function A9(t){var e=Of(t),r=t.read_shift(4);return[e,r,"s"]}function C9(t,e,r){return r==null&&(r=ut(8)),Rf(e,r),r.write_shift(4,e.v),r}function T9(t){var e=mo(t),r=Fs(t);return[e,r,"n"]}function O9(t,e,r){return r==null&&(r=ut(16)),Tf(e,r),yf(t.v,r),r}function $N(t){var e=Of(t),r=Fs(t);return[e,r,"n"]}function R9(t,e,r){return r==null&&(r=ut(12)),Rf(e,r),yf(t.v,r),r}function D9(t){var e=mo(t),r=b2(t);return[e,r,"n"]}function F9(t,e,r){return r==null&&(r=ut(12)),Tf(e,r),U3(t.v,r),r}function L9(t){var e=Of(t),r=b2(t);return[e,r,"n"]}function P9(t,e,r){return r==null&&(r=ut(8)),Rf(e,r),U3(t.v,r),r}function M9(t){var e=mo(t),r=x2(t);return[e,r,"is"]}function I9(t){var e=mo(t),r=Ls(t);return[e,r,"str"]}function B9(t,e,r){return r==null&&(r=ut(12+4*t.v.length)),Tf(e,r),is(t.v,r),r.length>r.l?r.slice(0,r.l):r}function U9(t){var e=Of(t),r=Ls(t);return[e,r,"str"]}function q9(t,e,r){return r==null&&(r=ut(8+4*t.v.length)),Rf(e,r),is(t.v,r),r.length>r.l?r.slice(0,r.l):r}function z9(t,e,r){var a=t.l+e,n=mo(t);n.r=r["!row"];var s=t.read_shift(1),l=[n,s,"b"];if(r.cellFormula){t.l+=2;var c=w1(t,a-t.l,r);l[3]=Rs(c,null,n,r.supbooks,r)}else t.l=a;return l}function H9(t,e,r){var a=t.l+e,n=mo(t);n.r=r["!row"];var s=t.read_shift(1),l=[n,s,"e"];if(r.cellFormula){t.l+=2;var c=w1(t,a-t.l,r);l[3]=Rs(c,null,n,r.supbooks,r)}else t.l=a;return l}function $9(t,e,r){var a=t.l+e,n=mo(t);n.r=r["!row"];var s=Fs(t),l=[n,s,"n"];if(r.cellFormula){t.l+=2;var c=w1(t,a-t.l,r);l[3]=Rs(c,null,n,r.supbooks,r)}else t.l=a;return l}function W9(t,e,r){var a=t.l+e,n=mo(t);n.r=r["!row"];var s=Ls(t),l=[n,s,"str"];if(r.cellFormula){t.l+=2;var c=w1(t,a-t.l,r);l[3]=Rs(c,null,n,r.supbooks,r)}else t.l=a;return l}var V9=Df,G9=ph;function Y9(t,e){return e==null&&(e=ut(4)),e.write_shift(4,t),e}function X9(t,e){var r=t.l+e,a=Df(t),n=y2(t),s=Ls(t),l=Ls(t),c=Ls(t);t.l=r;var f={rfx:a,relId:n,loc:s,display:c};return l&&(f.Tooltip=l),f}function K9(t,e){var r=ut(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));ph({s:tn(t[0]),e:tn(t[0])},r),_2("rId"+e,r);var a=t[1].Target.indexOf("#"),n=a==-1?"":t[1].Target.slice(a+1);return is(n||"",r),is(t[1].Tooltip||"",r),is("",r),r.slice(0,r.l)}function J9(){}function Z9(t,e,r){var a=t.l+e,n=q3(t),s=t.read_shift(1),l=[n];if(l[2]=s,r.cellFormula){var c=wP(t,a-t.l,r);l[1]=c}else t.l=a;return l}function Q9(t,e,r){var a=t.l+e,n=Df(t),s=[n];if(r.cellFormula){var l=NP(t,a-t.l,r);s[1]=l,t.l=a}else t.l=a;return s}function eM(t,e,r){r==null&&(r=ut(18));var a=S1(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return e.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),e.level&&(n|=e.level<<8),r.write_shift(2,n),r}var WN=["left","right","top","bottom","header","footer"];function tM(t){var e={};return WN.forEach(function(r){e[r]=Fs(t)}),e}function rM(t,e){return e==null&&(e=ut(48)),pf(t),WN.forEach(function(r){yf(t[r],e)}),e}function aM(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function nM(t,e,r){r==null&&(r=ut(30));var a=924;return(((e||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function sM(t){var e=ut(24);return e.write_shift(4,4),e.write_shift(4,1),ph(t,e),e}function iM(t,e){return e==null&&(e=ut(66)),e.write_shift(2,t.password?E2(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function oM(){}function lM(){}function cM(t,e,r,a,n,s,l){if(!t)return t;var c=e||{};a||(a={"!id":{}});var f=c.dense?[]:{},d,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,x=!1,g,b,_,w,A,C,E,R,Y,W=[];c.biff=12,c["!row"]=0;var B=0,q=!1,L=[],J={},D=c.supbooks||n.supbooks||[[]];if(D.sharedf=J,D.arrayf=L,D.SheetNames=n.SheetNames||n.Sheets.map(function(K){return K.name}),!c.supbooks&&(c.supbooks=D,n.Names))for(var T=0;T<n.Names.length;++T)D[0][T+1]=n.Names[T];var M=[],V=[],ie=!1;U0[16]={n:"BrtShortReal",f:$N};var X;if(xc(t,function(re,de,U){if(!x)switch(U){case 148:d=re;break;case 0:g=re,c.sheetRows&&c.sheetRows<=g.r&&(x=!0),R=jn(w=g.r),c["!row"]=g.r,(re.hidden||re.hpt||re.level!=null)&&(re.hpt&&(re.hpx=oh(re.hpt)),V[re.r]=re);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:re[2]},re[2]){case"n":b.v=re[1];break;case"s":E=g0[re[1]],b.v=E.t,b.r=E.r;break;case"b":b.v=!!re[1];break;case"e":b.v=re[1],c.cellText!==!1&&(b.w=yc[b.v]);break;case"str":b.t="s",b.v=re[1];break;case"is":b.t="s",b.v=re[1].t;break}if((_=l.CellXf[re[0].iStyleRef])&&qN(b,_.numFmtId,null,c,s,l),A=re[0].c==-1?A+1:re[0].c,c.dense?(f[w]||(f[w]=[]),f[w][A]=b):f[en(A)+R]=b,c.cellFormula){for(q=!1,B=0;B<L.length;++B){var k=L[B];g.r>=k[0].s.r&&g.r<=k[0].e.r&&A>=k[0].s.c&&A<=k[0].e.c&&(b.F=Or(k[0]),q=!0)}!q&&re.length>3&&(b.f=re[3])}if(m.s.r>g.r&&(m.s.r=g.r),m.s.c>A&&(m.s.c=A),m.e.r<g.r&&(m.e.r=g.r),m.e.c<A&&(m.e.c=A),c.cellDates&&_&&b.t=="n"&&dh(_r[_.numFmtId])){var F=ff(b.v);F&&(b.t="d",b.v=new Date(F.y,F.m-1,F.d,F.H,F.M,F.S,F.u))}X&&(X.type=="XLDAPR"&&(b.D=!0),X=void 0);break;case 1:case 12:if(!c.sheetStubs||v)break;b={t:"z",v:void 0},A=re[0].c==-1?A+1:re[0].c,c.dense?(f[w]||(f[w]=[]),f[w][A]=b):f[en(A)+R]=b,m.s.r>g.r&&(m.s.r=g.r),m.s.c>A&&(m.s.c=A),m.e.r<g.r&&(m.e.r=g.r),m.e.c<A&&(m.e.c=A),X&&(X.type=="XLDAPR"&&(b.D=!0),X=void 0);break;case 176:W.push(re);break;case 49:X=((c.xlmeta||{}).Cell||[])[re-1];break;case 494:var I=a["!id"][re.relId];for(I?(re.Target=I.Target,re.loc&&(re.Target+="#"+re.loc),re.Rel=I):re.relId==""&&(re.Target="#"+re.loc),w=re.rfx.s.r;w<=re.rfx.e.r;++w)for(A=re.rfx.s.c;A<=re.rfx.e.c;++A)c.dense?(f[w]||(f[w]=[]),f[w][A]||(f[w][A]={t:"z",v:void 0}),f[w][A].l=re):(C=wr({c:A,r:w}),f[C]||(f[C]={t:"z",v:void 0}),f[C].l=re);break;case 426:if(!c.cellFormula)break;L.push(re),Y=c.dense?f[w][A]:f[en(A)+R],Y.f=Rs(re[1],m,{r:g.r,c:A},D,c),Y.F=Or(re[0]);break;case 427:if(!c.cellFormula)break;J[wr(re[0].s)]=re[1],Y=c.dense?f[w][A]:f[en(A)+R],Y.f=Rs(re[1],m,{r:g.r,c:A},D,c);break;case 60:if(!c.cellStyles)break;for(;re.e>=re.s;)M[re.e--]={width:re.w/256,hidden:!!(re.flags&1),level:re.level},ie||(ie=!0,A2(re.w/256)),pu(M[re.e+1]);break;case 161:f["!autofilter"]={ref:Or(re)};break;case 476:f["!margins"]=re;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),re.name&&(n.Sheets[r].CodeName=re.name),(re.above||re.left)&&(f["!outline"]={above:re.above,left:re.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),re.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!de.T){if(!v||c.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(m.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=Or(d||m)),c.sheetRows&&f["!ref"]){var Z=ea(f["!ref"]);c.sheetRows<=+Z.e.r&&(Z.e.r=c.sheetRows-1,Z.e.r>m.e.r&&(Z.e.r=m.e.r),Z.e.r<Z.s.r&&(Z.s.r=Z.e.r),Z.e.c>m.e.c&&(Z.e.c=m.e.c),Z.e.c<Z.s.c&&(Z.s.c=Z.e.c),f["!fullref"]=f["!ref"],f["!ref"]=Or(Z))}return W.length>0&&(f["!merges"]=W),M.length>0&&(f["!cols"]=M),V.length>0&&(f["!rows"]=V),f}function uM(t,e,r,a,n,s,l){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=qa(e),e.z=e.z||_r[14],e.v=Kn(Ua(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var f={r,c:a};switch(f.s=wu(n.cellXfs,e,n),e.l&&s["!links"].push([wr(f),e.l]),e.c&&s["!comments"].push([wr(f),e.c]),e.t){case"s":case"str":return n.bookSST?(c=D2(n.Strings,e.v,n.revStrings),f.t="s",f.v=c,l?Nt(t,18,C9(e,f)):Nt(t,7,E9(e,f))):(f.t="str",l?Nt(t,17,q9(e,f)):Nt(t,6,B9(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?Nt(t,13,P9(e,f)):Nt(t,2,F9(e,f)):l?Nt(t,16,R9(e,f)):Nt(t,5,O9(e,f)),!0;case"b":return f.t="b",l?Nt(t,15,b9(e,f)):Nt(t,4,y9(e,f)),!0;case"e":return f.t="e",l?Nt(t,14,k9(e,f)):Nt(t,3,S9(e,f)),!0}return l?Nt(t,12,v9(e,f)):Nt(t,1,p9(e,f)),!0}function fM(t,e,r,a){var n=ea(e["!ref"]||"A1"),s,l="",c=[];Nt(t,145);var f=Array.isArray(e),d=n.e.r;e["!rows"]&&(d=Math.max(n.e.r,e["!rows"].length-1));for(var m=n.s.r;m<=d;++m){l=jn(m),l9(t,e,n,m);var v=!1;if(m<=n.e.r)for(var x=n.s.c;x<=n.e.c;++x){m===n.s.r&&(c[x]=en(x)),s=c[x]+l;var g=f?(e[m]||[])[x]:e[s];if(!g){v=!1;continue}v=uM(t,g,m,x,a,e,v)}}Nt(t,146)}function dM(t,e){!e||!e["!merges"]||(Nt(t,177,Y9(e["!merges"].length)),e["!merges"].forEach(function(r){Nt(t,176,G9(r))}),Nt(t,178))}function hM(t,e){!e||!e["!cols"]||(Nt(t,390),e["!cols"].forEach(function(r,a){r&&Nt(t,60,eM(a,r))}),Nt(t,391))}function mM(t,e){!e||!e["!ref"]||(Nt(t,648),Nt(t,649,sM(ea(e["!ref"]))),Nt(t,650))}function pM(t,e,r){e["!links"].forEach(function(a){if(a[1].Target){var n=ma(r,-1,a[1].Target.replace(/#.*$/,""),Ir.HLINK);Nt(t,494,K9(a,n))}}),delete e["!links"]}function gM(t,e,r,a){if(e["!comments"].length>0){var n=ma(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ir.VML);Nt(t,551,_2("rId"+n)),e["!legacy"]=n}}function vM(t,e,r,a){if(e["!autofilter"]){var n=e["!autofilter"],s=typeof n.ref=="string"?n.ref:Or(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,c=hi(s);c.s.r==c.e.r&&(c.e.r=hi(e["!ref"]).e.r,s=Or(c));for(var f=0;f<l.length;++f){var d=l[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+s;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Nt(t,161,ph(ea(s))),Nt(t,162)}}function xM(t,e,r){Nt(t,133),Nt(t,137,nM(e,r)),Nt(t,138),Nt(t,134)}function yM(t,e){e["!protect"]&&Nt(t,535,iM(e["!protect"]))}function _M(t,e,r,a){var n=di(),s=r.SheetNames[t],l=r.Sheets[s]||{},c=s;try{r&&r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}var f=ea(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Nt(n,129),(r.vbaraw||l["!outline"])&&Nt(n,147,h9(c,l["!outline"])),Nt(n,148,u9(f)),xM(n,l,r.Workbook),hM(n,l),fM(n,l,t,e),yM(n,l),vM(n,l,r,t),dM(n,l),pM(n,l,a),l["!margins"]&&Nt(n,476,rM(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&mM(n,l),gM(n,l,t,a),Nt(n,130),n.end()}function bM(t){var e=[],r=t.match(/^<c:numCache>/),a;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=r?+l[2]:l[2])});var n=Qr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[e,n,a]}function wM(t,e,r,a,n,s){var l=s||{"!type":"chart"};if(!t)return s;var c=0,f=0,d="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var x=bM(v);m.s.r=m.s.c=0,m.e.c=c,d=en(c),x[0].forEach(function(g,b){l[d+jn(b)]={t:"n",v:g,z:x[1]},f=b}),m.e.r<f&&(m.e.r=f),++c}),c>0&&(l["!ref"]=Or(m)),l}function SM(t,e,r,a,n){if(!t)return t;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,c=t.match(zN);return c&&F2(c[0],s,n,r),(l=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function NM(t,e){t.l+=10;var r=Ls(t);return{name:r}}function kM(t,e,r,a,n){if(!t)return t;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return xc(t,function(f,d,m){switch(m){case 550:s["!rel"]=f;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),f.name&&(n.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},e),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var L2=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],jM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],EM=[],AM=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function n5(t,e){for(var r=0;r!=t.length;++r)for(var a=t[r],n=0;n!=e.length;++n){var s=e[n];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=Ia(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function s5(t,e){for(var r=0;r!=e.length;++r){var a=e[r];if(t[a[0]]==null)t[a[0]]=a[1];else switch(a[2]){case"bool":typeof t[a[0]]=="string"&&(t[a[0]]=Ia(t[a[0]]));break;case"int":typeof t[a[0]]=="string"&&(t[a[0]]=parseInt(t[a[0]],10));break}}}function VN(t){s5(t.WBProps,L2),s5(t.CalcPr,AM),n5(t.WBView,jM),n5(t.Sheets,EM),Zd.date1904=Ia(t.WBProps.date1904)}function CM(t){return!t.Workbook||!t.Workbook.WBProps?"false":Ia(t.Workbook.WBProps.date1904)?"true":"false"}var TM="][*?/\\".split("");function GN(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return TM.forEach(function(a){if(t.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function OM(t,e,r){t.forEach(function(a,n){GN(a);for(var s=0;s<n;++s)if(a==t[s])throw new Error("Duplicate Sheet Name: "+a);if(r){var l=e&&e[n]&&e[n].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function RM(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];OM(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)CP(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var DM=/<\w+:workbook/;function FM(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},l=0;if(t.replace(Ms,function(f,d){var m=Sr(f);switch(Al(m[0])){case"<?xml":break;case"<workbook":f.match(DM)&&(n="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=m[n];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":L2.forEach(function(v){if(m[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=Ia(m[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(m[v[0]],10);break;default:r.WBProps[v[0]]=m[v[0]]}}),m.codeName&&(r.WBProps.CodeName=Sa(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Qr(Sa(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=Sa(m.name),m.comment&&(s.Comment=m.comment),m.localSheetId&&(s.Sheet=+m.localSheetId),Ia(m.hidden||"0")&&(s.Hidden=!0),l=d+f.length;break;case"</definedName>":s.Ref=Qr(Sa(t.slice(l,d))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&e.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return f}),Cf.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return VN(r),r}function YN(t){var e=[En];e[e.length]=Ft("workbook",null,{xmlns:Cf[0],"xmlns:r":Xn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(L2.forEach(function(c){t.Workbook.WBProps[c[0]]!=null&&t.Workbook.WBProps[c[0]]!=c[1]&&(a[c[0]]=t.Workbook.WBProps[c[0]])}),t.Workbook.WBProps.CodeName&&(a.codeName=t.Workbook.WBProps.CodeName,delete a.CodeName)),e[e.length]=Ft("workbookPr",null,a);var n=t.Workbook&&t.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var l={name:ga(t.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=Ft("sheet",null,l)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(c){var f={name:c.Name};c.Comment&&(f.comment=c.Comment),c.Sheet!=null&&(f.localSheetId=""+c.Sheet),c.Hidden&&(f.hidden="1"),c.Ref&&(e[e.length]=Ft("definedName",ga(c.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function LM(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=gx(t),r.name=Ls(t),r}function PM(t,e){return e||(e=ut(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),_2(t.strRelID,e),is(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function MM(t,e){var r={},a=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var n=e>8?Ls(t):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function IM(t,e){e||(e=ut(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),B3(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function BM(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function UM(t,e,r){var a=t.l+e;t.l+=4,t.l+=1;var n=t.read_shift(4),s=gO(t),l=SP(t,0,r),c=y2(t);t.l=a;var f={Name:s,Ptg:l};return n<268435455&&(f.Sheet=n),c&&(f.Comment=c),f}function qM(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;e||(e={}),e.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],U0[16]={n:"BrtFRTArchID$",f:BM},xc(t,function(f,d,m){switch(m){case 156:l.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=Rs(f.Ptg,null,null,l,e),delete e.SID,delete f.Ptg,s.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,f]):l[0]=[m,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(m),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(m),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!d.T){if(!n||e.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},e),VN(r),r.Names=s,r.supbooks=l,r}function zM(t,e){Nt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var a=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Nt(t,156,PM(n))}Nt(t,144)}function HM(t,e){e||(e=ut(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return is("SheetJS",e),is(Wp.version,e),is(Wp.version,e),is("7262",e),e.length>e.l?e.slice(0,e.l):e}function $M(t,e){e||(e=ut(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function WM(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,a=0,n=-1,s=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&s==-1&&(s=a);s>n||(Nt(t,135),Nt(t,158,$M(n)),Nt(t,136))}}function VM(t,e){var r=di();return Nt(r,131),Nt(r,128,HM()),Nt(r,153,IM(t.Workbook&&t.Workbook.WBProps||null)),WM(r,t),zM(r,t),Nt(r,132),r.end()}function GM(t,e,r){return e.slice(-4)===".bin"?qM(t,r):FM(t,r)}function YM(t,e,r,a,n,s,l,c){return e.slice(-4)===".bin"?cM(t,a,r,n,s,l,c):UP(t,a,r,n,s,l,c)}function XM(t,e,r,a,n,s,l,c){return e.slice(-4)===".bin"?kM(t,a,r,n,s):SM(t,a,r,n,s)}function KM(t,e,r,a,n,s,l,c){return e.slice(-4)===".bin"?ZF():QF()}function JM(t,e,r,a,n,s,l,c){return e.slice(-4)===".bin"?KF():JF()}function ZM(t,e,r,a){return e.slice(-4)===".bin"?GD(t,r,a):LD(t,r,a)}function QM(t,e,r){return AN(t,r)}function eI(t,e,r){return e.slice(-4)===".bin"?eD(t,r):JR(t,r)}function tI(t,e,r){return e.slice(-4)===".bin"?WF(t,r):PF(t,r)}function rI(t,e,r){return e.slice(-4)===".bin"?DF(t):OF(t)}function aI(t,e,r,a){return r.slice(-4)===".bin"?FF(t,e,r,a):void 0}function nI(t,e,r){return e.slice(-4)===".bin"?AF(t,e,r):TF(t,e,r)}function sI(t,e,r){return(e.slice(-4)===".bin"?VM:YN)(t)}function iI(t,e,r,a,n){return(e.slice(-4)===".bin"?_M:HN)(t,r,a,n)}function oI(t,e,r){return(e.slice(-4)===".bin"?aF:jN)(t,r)}function lI(t,e,r){return(e.slice(-4)===".bin"?aD:xN)(t,r)}function cI(t,e,r){return(e.slice(-4)===".bin"?VF:ON)(t)}function uI(t){return(t.slice(-4)===".bin"?CF:CN)()}var XN=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,KN=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qo(t,e){var r=t.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=t.match(XN),s,l,c,f;if(n)for(f=0;f!=n.length;++f)s=n[f].match(KN),(l=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),a[c]=s[2].slice(1,s[2].length-1));return a}function fI(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var a=t.match(XN),n,s,l,c;if(a)for(c=0;c!=a.length;++c)n=a[c].match(KN),(s=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(s+1),r[l]=n[2].slice(1,n[2].length-1));return r}var x0;function dI(t,e){var r=x0[t]||Qr(t);return r==="General"?vf(e):fo(r,e)}function hI(t,e,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Ia(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Ua(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Qr(e)]=n}function mI(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||yc[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=O0(t.v):t.w=vf(t.v):t.w=dI(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var a=x0[e]||e||"General";if(r.cellNF&&(t.z=a),r.cellDates&&t.t=="n"&&dh(a)){var n=ff(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(r.WTF)throw s}}}function pI(t,e,r){if(r.cellStyles&&e.Interior){var a=e.Interior;a.Pattern&&(a.patternType=ED[a.Pattern]||a.Pattern)}t[e.ID]=e}function gI(t,e,r,a,n,s,l,c,f,d){var m="General",v=a.StyleID,x={};d=d||{};var g=[],b=0;for(v===void 0&&c&&(v=c.StyleID),v===void 0&&l&&(v=l.StyleID);s[v]!==void 0&&(s[v].nf&&(m=s[v].nf),s[v].Interior&&g.push(s[v].Interior),!!s[v].Parent);)v=s[v].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=Ia(t);break;case"String":a.t="s",a.r=ww(Qr(t)),a.v=t.indexOf("<")>-1?Qr(e||t).replace(/<.*?>/g,""):a.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),a.v=(Ua(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Qr(t):a.v<60&&(a.v=a.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+t),a.t||(a.t="n");break;case"Error":a.t="e",a.v=$3[t],d.cellText!==!1&&(a.w=t);break;default:t==""&&e==""?a.t="z":(a.t="s",a.v=ww(e||t));break}if(mI(a,m,d),d.cellFormula!==!1)if(a.Formula){var _=Qr(a.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),a.f=Jd(_,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Jd("RC:RC",n):a.ArrayRange&&(a.F=Jd(a.ArrayRange,n),f.push([ea(a.F),a.F]))}else for(b=0;b<f.length;++b)n.r>=f[b][0].s.r&&n.r<=f[b][0].e.r&&n.c>=f[b][0].s.c&&n.c<=f[b][0].e.c&&(a.F=f[b][1]);d.cellStyles&&(g.forEach(function(w){!x.patternType&&w.patternType&&(x.patternType=w.patternType)}),a.s=x),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function vI(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function dv(t,e){var r=e||{};hh();var a=i0(h2(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Sa(a));var n=a.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=qa(r);return l.type="string",ih.to_workbook(a,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ye){n.indexOf("<"+ye)>=0&&(s=!0)}),s)return rB(a,r);x0={"General Number":"General","General Date":_r[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":_r[15],"Short Date":_r[14],"Long Time":_r[19],"Medium Time":_r[18],"Short Time":_r[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:_r[2],Standard:_r[4],Percent:_r[10],Scientific:_r[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],d,m={},v=[],x=r.dense?[]:{},g="",b={},_={},w=qo('<Data ss:Type="String">'),A=0,C=0,E=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},Y={},W={},B="",q=0,L=[],J={},D={},T=0,M=[],V=[],ie={},X=[],Z,K=!1,re=[],de=[],U={},k=0,F=0,I={Sheets:[],WBProps:{date1904:!1}},z={};F0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";c=F0.exec(a);)switch(c[3]=(te=c[3]).toLowerCase()){case"data":if(te=="data"){if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?gI(a.slice(A,c.index),B,w,f[f.length-1][0]=="comment"?ie:b,{c:C,r:E},Y,X[C],_,re,r):(B="",w=qo(c[0]),A=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(V.length>0&&(b.c=V),(!r.sheetRows||r.sheetRows>E)&&b.v!==void 0&&(r.dense?(x[E]||(x[E]=[]),x[E][C]=b):x[en(C)+jn(E)]=b),b.HRef&&(b.l={Target:Qr(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(k=C+(parseInt(b.MergeAcross,10)|0),F=E+(parseInt(b.MergeDown,10)|0),L.push({s:{c:C,r:E},e:{c:k,r:F}})),!r.sheetStubs)b.MergeAcross?C=k+1:++C;else if(b.MergeAcross||b.MergeDown){for(var se=C;se<=k;++se)for(var pe=E;pe<=F;++pe)(se>C||pe>E)&&(r.dense?(x[pe]||(x[pe]=[]),x[pe][se]={t:"z"}):x[en(se)+jn(pe)]={t:"z"});C=k+1}else++C;else b=fI(c[0]),b.Index&&(C=+b.Index-1),C<R.s.c&&(R.s.c=C),C>R.e.c&&(R.e.c=C),c[0].slice(-2)==="/>"&&++C,V=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(E<R.s.r&&(R.s.r=E),E>R.e.r&&(R.e.r=E),c[0].slice(-2)==="/>"&&(_=qo(c[0]),_.Index&&(E=+_.Index-1)),C=0,++E):(_=qo(c[0]),_.Index&&(E=+_.Index-1),U={},(_.AutoFitHeight=="0"||_.Height)&&(U.hpx=parseInt(_.Height,10),U.hpt=B0(U.hpx),de[E]=U),_.Hidden=="1"&&(U.hidden=!0,de[E]=U));break;case"worksheet":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));v.push(g),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(x["!ref"]=Or(R),r.sheetRows&&r.sheetRows<=R.e.r&&(x["!fullref"]=x["!ref"],R.e.r=r.sheetRows-1,x["!ref"]=Or(R))),L.length&&(x["!merges"]=L),X.length>0&&(x["!cols"]=X),de.length>0&&(x["!rows"]=de),m[g]=x}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=C=0,f.push([c[3],!1]),d=qo(c[0]),g=Qr(d.Name),x=r.dense?[]:{},L=[],re=[],de=[],z={name:g,Hidden:0},I.Sheets.push(z);break;case"table":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),X=[],K=!1}break;case"style":c[1]==="/"?pI(Y,W,r):W=qo(c[0]);break;case"numberformat":W.nf=Qr(qo(c[0]).Format||"General"),x0[W.nf]&&(W.nf=x0[W.nf]);for(var ve=0;ve!=392&&_r[ve]!=W.nf;++ve);if(ve==392){for(ve=57;ve!=392;++ve)if(_r[ve]==null){dc(W.nf,ve);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(Z=qo(c[0]),Z.Hidden&&(Z.hidden=!0,delete Z.Hidden),Z.Width&&(Z.wpx=parseInt(Z.Width,10)),!K&&Z.wpx>10){K=!0,Ds=NN;for(var _e=0;_e<X.length;++_e)X[_e]&&pu(X[_e])}K&&pu(Z),X[Z.Index-1||X.length]=Z;for(var Pe=0;Pe<+Z.Span;++Pe)X[X.length]=qa(Z);break;case"namedrange":if(c[1]==="/")break;I.Names||(I.Names=[]);var fe=Sr(c[0]),st={Name:fe.Name,Ref:Jd(fe.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(st.Sheet=I.Sheets.length-1),I.Names.push(st);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?B+=a.slice(q,c.index):q=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;W.Interior=qo(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?qO(J,te,a.slice(T,c.index)):T=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));vI(ie),V.push(ie)}else f.push([c[3],!1]),d=qo(c[0]),ie={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var mt=qo(c[0]);x["!autofilter"]={ref:Jd(mt.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return u5(a,r);var he=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:he=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:he=!1}break;case"excelworkbook":switch(c[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:he=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:he=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(T,c.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else T=c.index+c[0].length;break;case"header":x["!margins"]||pf(x["!margins"]={},"xlml"),isNaN(+Sr(c[0]).Margin)||(x["!margins"].header=+Sr(c[0]).Margin);break;case"footer":x["!margins"]||pf(x["!margins"]={},"xlml"),isNaN(+Sr(c[0]).Margin)||(x["!margins"].footer=+Sr(c[0]).Margin);break;case"pagemargins":var at=Sr(c[0]);x["!margins"]||pf(x["!margins"]={},"xlml"),isNaN(+at.Top)||(x["!margins"].top=+at.Top),isNaN(+at.Left)||(x["!margins"].left=+at.Left),isNaN(+at.Right)||(x["!margins"].right=+at.Right),isNaN(+at.Bottom)||(x["!margins"].bottom=+at.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:he=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:he=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:he=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:he=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:he=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:he=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:he=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:he=!1}break;case"smarttags":break;default:he=!1;break}if(he||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?hI(D,te,M,a.slice(T,c.index)):(M=c,T=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var we={};return!r.bookSheets&&!r.bookProps&&(we.Sheets=m),we.SheetNames=v,we.Workbook=I,we.SSF=qa(_r),we.Props=J,we.Custprops=D,we}function Sx(t,e){switch(M2(e=e||{}),e.type||"base64"){case"base64":return dv(qi(t),e);case"binary":case"buffer":case"file":return dv(t,e);case"array":return dv(_u(t),e)}}function xI(t,e){var r=[];return t.Props&&r.push(zO(t.Props,e)),t.Custprops&&r.push(HO(t.Props,t.Custprops)),r.join("")}function yI(){return""}function _I(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(a,n){var s=[];s.push(Ft("NumberFormat",null,{"ss:Format":ga(_r[a.numFmtId])}));var l={"ss:ID":"s"+(21+n)};r.push(Ft("Style",s.join(""),l))}),Ft("Styles",r.join(""))}function JN(t){return Ft("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+O2(t.Ref,{r:0,c:0})})}function bI(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],a=0;a<e.length;++a){var n=e[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(JN(n)))}return Ft("Names",r.join(""))}function wI(t,e,r,a){if(!t||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,s=[],l=0;l<n.length;++l){var c=n[l];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||s.push(JN(c)))}return s.join("")}function SI(t,e,r,a){if(!t)return"";var n=[];if(t["!margins"]&&(n.push("<PageSetup>"),t["!margins"].header&&n.push(Ft("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&n.push(Ft("Footer",null,{"x:Margin":t["!margins"].footer})),n.push(Ft("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Ft("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(a.Workbook.Sheets[s]&&!a.Workbook.Sheets[s].Hidden);++s);s==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),t["!protect"]&&(n.push(_s("ProtectContents","True")),t["!protect"].objects&&n.push(_s("ProtectObjects","True")),t["!protect"].scenarios&&n.push(_s("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?n.push(_s("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&n.push(_s("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&n.push("<"+l[1]+"/>")})),n.length==0?"":Ft("WorksheetOptions",n.join(""),{xmlns:Ri.x})}function NI(t){return t.map(function(e){var r=W8(e.t||""),a=Ft("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ft("Comment",a,{"ss:Author":e.a})}).join("")}function kI(t,e,r,a,n,s,l){if(!t||t.v==null&&t.f==null)return"";var c={};if(t.f&&(c["ss:Formula"]="="+ga(O2(t.f,l))),t.F&&t.F.slice(0,e.length)==e){var f=tn(t.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(t.l&&t.l.Target&&(c["ss:HRef"]=ga(t.l.Target),t.l.Tooltip&&(c["x:HRefScreenTip"]=ga(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],m=0;m!=d.length;++m)d[m].s.c!=l.c||d[m].s.r!=l.r||(d[m].e.c>d[m].s.c&&(c["ss:MergeAcross"]=d[m].e.c-d[m].s.c),d[m].e.r>d[m].s.r&&(c["ss:MergeDown"]=d[m].e.r-d[m].s.r));var v="",x="";switch(t.t){case"z":if(!a.sheetStubs)return"";break;case"n":v="Number",x=String(t.v);break;case"b":v="Boolean",x=t.v?"1":"0";break;case"e":v="Error",x=yc[t.v];break;case"d":v="DateTime",x=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||_r[14]);break;case"s":v="String",x=$8(t.v||"");break}var g=wu(a.cellXfs,t,a);c["ss:StyleID"]="s"+(21+g),c["ss:Index"]=l.c+1;var b=t.v!=null?x:"",_=t.t=="z"?"":'<Data ss:Type="'+v+'">'+b+"</Data>";return(t.c||[]).length>0&&(_+=NI(t.c)),Ft("Cell",_,c)}function jI(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=oh(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function EI(t,e,r,a){if(!t["!ref"])return"";var n=ea(t["!ref"]),s=t["!merges"]||[],l=0,c=[];t["!cols"]&&t["!cols"].forEach(function(w,A){pu(w);var C=!!w.width,E=S1(A,w),R={"ss:Index":A+1};C&&(R["ss:Width"]=M0(E.width)),w.hidden&&(R["ss:Hidden"]="1"),c.push(Ft("Column",null,R))});for(var f=Array.isArray(t),d=n.s.r;d<=n.e.r;++d){for(var m=[jI(d,(t["!rows"]||[])[d])],v=n.s.c;v<=n.e.c;++v){var x=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>v)&&!(s[l].s.r>d)&&!(s[l].e.c<v)&&!(s[l].e.r<d)){(s[l].s.c!=v||s[l].s.r!=d)&&(x=!0);break}if(!x){var g={r:d,c:v},b=wr(g),_=f?(t[d]||[])[v]:t[b];m.push(kI(_,b,t,e,r,a,g))}}m.push("</Row>"),m.length>2&&c.push(m.join(""))}return c.join("")}function AI(t,e,r){var a=[],n=r.SheetNames[t],s=r.Sheets[n],l=s?wI(s,e,t,r):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=s?EI(s,e,t,r):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(SI(s,e,t,r)),a.join("")}function CI(t,e){e||(e={}),t.SSF||(t.SSF=qa(_r)),t.SSF&&(hh(),g1(t.SSF),e.revssf=x1(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],wu(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(xI(t,e)),r.push(yI()),r.push(""),r.push("");for(var a=0;a<t.SheetNames.length;++a)r.push(Ft("Worksheet",AI(a,e,t),{"ss:Name":ga(t.SheetNames[a])}));return r[2]=_I(t,e),r[3]=bI(t),En+Ft("Workbook",r.join(""),{xmlns:Ri.ss,"xmlns:o":Ri.o,"xmlns:x":Ri.x,"xmlns:ss":Ri.ss,"xmlns:dt":Ri.dt,"xmlns:html":Ri.html})}function TI(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=bO(r),r.length-r.l<=4)return e;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(e.UnicodeClipboardFormat=wO(r),a=r.read_shift(4),a==0||a>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var OI=[60,1084,2066,2165,2175];function RI(t,e,r,a,n){var s=a,l=[],c=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(c)}l.push(c),r.l+=s;for(var f=lc(r,r.l),d=Nx[f],m=0;d!=null&&OI.indexOf(f)>-1;)s=lc(r,r.l+2),m=r.l+4,f==2066?m+=4:(f==2165||f==2175)&&(m+=12),c=r.slice(m,r.l+4+s),l.push(c),r.l+=4+s,d=Nx[f=lc(r,r.l)];var v=ss(l);ys(v,0);var x=0;v.lens=[];for(var g=0;g<l.length;++g)v.lens.push(x),x+=l[g].length;if(v.length<a)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+a;return e.f(v,v.length,n)}function xl(t,e,r){if(t.t!=="z"&&t.XF){var a=0;try{a=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=_r[a])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||yc[t.v]:a===0||a=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=O0(t.v):t.w=vf(t.v):t.w=fo(a,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&a&&t.t=="n"&&dh(_r[a]||String(a))){var n=ff(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function vp(t,e,r){return{v:t,ixfe:e,t:r}}function DI(t,e){var r={opts:{}},a={},n=e.dense?[]:{},s={},l={},c=null,f=[],d="",m={},v,x="",g,b,_,w,A={},C=[],E,R,Y=[],W=[],B={Sheets:[],WBProps:{date1904:!1},Views:[{}]},q={},L=function(pt){return pt<8?df[pt]:pt<64&&W[pt-8]||df[pt]},J=function(pt,wt,Lt){var Pt=wt.XF.data;if(!(!Pt||!Pt.patternType||!Lt||!Lt.cellStyles)){wt.s={},wt.s.patternType=Pt.patternType;var zt;(zt=P0(L(Pt.icvFore)))&&(wt.s.fgColor={rgb:zt}),(zt=P0(L(Pt.icvBack)))&&(wt.s.bgColor={rgb:zt})}},D=function(pt,wt,Lt){if(!(U>1)&&!(Lt.sheetRows&&pt.r>=Lt.sheetRows)){if(Lt.cellStyles&&wt.XF&&wt.XF.data&&J(pt,wt,Lt),delete wt.ixfe,delete wt.XF,v=pt,x=wr(pt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),pt.r<l.s.r&&(l.s.r=pt.r),pt.c<l.s.c&&(l.s.c=pt.c),pt.r+1>l.e.r&&(l.e.r=pt.r+1),pt.c+1>l.e.c&&(l.e.c=pt.c+1),Lt.cellFormula&&wt.f){for(var Pt=0;Pt<C.length;++Pt)if(!(C[Pt][0].s.c>pt.c||C[Pt][0].s.r>pt.r)&&!(C[Pt][0].e.c<pt.c||C[Pt][0].e.r<pt.r)){wt.F=Or(C[Pt][0]),(C[Pt][0].s.c!=pt.c||C[Pt][0].s.r!=pt.r)&&delete wt.f,wt.f&&(wt.f=""+Rs(C[Pt][1],l,pt,re,T));break}}Lt.dense?(n[pt.r]||(n[pt.r]=[]),n[pt.r][pt.c]=wt):n[x]=wt}},T={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(T.password=e.password);var M,V=[],ie=[],X=[],Z=[],K=!1,re=[];re.SheetNames=T.snames,re.sharedf=T.sharedf,re.arrayf=T.arrayf,re.names=[],re.XTI=[];var de=0,U=0,k=0,F=[],I=[],z;T.codepage=1200,Vo(1200);for(var te=!1;t.l<t.length-1;){var se=t.l,pe=t.read_shift(2);if(pe===0&&de===10)break;var ve=t.l===t.length?0:t.read_shift(2),_e=Nx[pe];if(_e&&_e.f){if(e.bookSheets&&de===133&&pe!==133)break;if(de=pe,_e.r===2||_e.r==12){var Pe=t.read_shift(2);if(ve-=2,!T.enc&&Pe!==pe&&((Pe&255)<<8|Pe>>8)!==pe)throw new Error("rt mismatch: "+Pe+"!="+pe);_e.r==12&&(t.l+=10,ve-=10)}var fe={};if(pe===10?fe=_e.f(t,ve,T):fe=RI(pe,_e,t,ve,T),U==0&&[9,521,1033,2057].indexOf(de)===-1)continue;switch(pe){case 34:r.opts.Date1904=B.WBProps.date1904=fe;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(t.l=0),T.enc=fe,!e.password)throw new Error("File is password-protected");if(fe.valid==null)throw new Error("Encryption scheme unsupported");if(!fe.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=fe;break;case 66:var st=Number(fe);switch(st){case 21010:st=1200;break;case 32768:st=1e4;break;case 32769:st=1252;break}Vo(T.codepage=st),te=!0;break;case 317:T.rrtabid=fe;break;case 25:T.winlocked=fe;break;case 439:r.opts.RefreshAll=fe;break;case 12:r.opts.CalcCount=fe;break;case 16:r.opts.CalcDelta=fe;break;case 17:r.opts.CalcIter=fe;break;case 13:r.opts.CalcMode=fe;break;case 14:r.opts.CalcPrecision=fe;break;case 95:r.opts.CalcSaveRecalc=fe;break;case 15:T.CalcRefMode=fe;break;case 2211:r.opts.FullCalc=fe;break;case 129:fe.fDialog&&(n["!type"]="dialog"),fe.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),fe.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:Y.push(fe);break;case 430:re.push([fe]),re[re.length-1].XTI=[];break;case 35:case 547:re[re.length-1].push(fe);break;case 24:case 536:z={Name:fe.Name,Ref:Rs(fe.rgce,l,null,re,T)},fe.itab>0&&(z.Sheet=fe.itab-1),re.names.push(z),re[0]||(re[0]=[],re[0].XTI=[]),re[re.length-1].push(fe),fe.Name=="_xlnm._FilterDatabase"&&fe.itab>0&&fe.rgce&&fe.rgce[0]&&fe.rgce[0][0]&&fe.rgce[0][0][0]=="PtgArea3d"&&(I[fe.itab-1]={ref:Or(fe.rgce[0][0][1][2])});break;case 22:T.ExternCount=fe;break;case 23:re.length==0&&(re[0]=[],re[0].XTI=[]),re[re.length-1].XTI=re[re.length-1].XTI.concat(fe),re.XTI=re.XTI.concat(fe);break;case 2196:if(T.biff<8)break;z!=null&&(z.Comment=fe[1]);break;case 18:n["!protect"]=fe;break;case 19:fe!==0&&T.WTF&&console.error("Password verifier: "+fe);break;case 133:s[fe.pos]=fe,T.snames.push(fe.name);break;case 10:{if(--U)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=Or(l),e.sheetRows&&e.sheetRows<=l.e.r){var mt=l.e.r;l.e.r=e.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Or(l),l.e.r=mt}l.e.r++,l.e.c++}V.length>0&&(n["!merges"]=V),ie.length>0&&(n["!objects"]=ie),X.length>0&&(n["!cols"]=X),Z.length>0&&(n["!rows"]=Z),B.Sheets.push(q)}d===""?m=n:a[d]=n,n=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[fe.BIFFVer]||8),T.biffguess=fe.BIFFVer==0,fe.BIFFVer==0&&fe.dt==4096&&(T.biff=5,te=!0,Vo(T.codepage=28591)),T.biff==8&&fe.BIFFVer==0&&fe.dt==16&&(T.biff=2),U++)break;if(n=e.dense?[]:{},T.biff<8&&!te&&(te=!0,Vo(T.codepage=e.codepage||1252)),T.biff<5||fe.BIFFVer==0&&fe.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var he={pos:t.l-ve,name:d};s[he.pos]=he,T.snames.push(d)}else d=(s[se]||{name:""}).name;fe.dt==32&&(n["!type"]="chart"),fe.dt==64&&(n["!type"]="macro"),V=[],ie=[],T.arrayf=C=[],X=[],Z=[],K=!1,q={Hidden:(s[se]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(e.dense?(n[fe.r]||[])[fe.c]:n[wr({c:fe.c,r:fe.r})])&&++fe.c,E={ixfe:fe.ixfe,XF:Y[fe.ixfe]||{},v:fe.val,t:"n"},k>0&&(E.z=F[E.ixfe>>8&63]),xl(E,e,r.opts.Date1904),D({c:fe.c,r:fe.r},E,e);break;case 5:case 517:E={ixfe:fe.ixfe,XF:Y[fe.ixfe],v:fe.val,t:fe.t},k>0&&(E.z=F[E.ixfe>>8&63]),xl(E,e,r.opts.Date1904),D({c:fe.c,r:fe.r},E,e);break;case 638:E={ixfe:fe.ixfe,XF:Y[fe.ixfe],v:fe.rknum,t:"n"},k>0&&(E.z=F[E.ixfe>>8&63]),xl(E,e,r.opts.Date1904),D({c:fe.c,r:fe.r},E,e);break;case 189:for(var at=fe.c;at<=fe.C;++at){var we=fe.rkrec[at-fe.c][0];E={ixfe:we,XF:Y[we],v:fe.rkrec[at-fe.c][1],t:"n"},k>0&&(E.z=F[E.ixfe>>8&63]),xl(E,e,r.opts.Date1904),D({c:at,r:fe.r},E,e)}break;case 6:case 518:case 1030:{if(fe.val=="String"){c=fe;break}if(E=vp(fe.val,fe.cell.ixfe,fe.tt),E.XF=Y[E.ixfe],e.cellFormula){var ye=fe.formula;if(ye&&ye[0]&&ye[0][0]&&ye[0][0][0]=="PtgExp"){var Be=ye[0][0][1][0],Et=ye[0][0][1][1],Xe=wr({r:Be,c:Et});A[Xe]?E.f=""+Rs(fe.formula,l,fe.cell,re,T):E.F=((e.dense?(n[Be]||[])[Et]:n[Xe])||{}).F}else E.f=""+Rs(fe.formula,l,fe.cell,re,T)}k>0&&(E.z=F[E.ixfe>>8&63]),xl(E,e,r.opts.Date1904),D(fe.cell,E,e),c=fe}break;case 7:case 519:if(c)c.val=fe,E=vp(fe,c.cell.ixfe,"s"),E.XF=Y[E.ixfe],e.cellFormula&&(E.f=""+Rs(c.formula,l,c.cell,re,T)),k>0&&(E.z=F[E.ixfe>>8&63]),xl(E,e,r.opts.Date1904),D(c.cell,E,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(fe);var lt=wr(fe[0].s);if(g=e.dense?(n[fe[0].s.r]||[])[fe[0].s.c]:n[lt],e.cellFormula&&g){if(!c||!lt||!g)break;g.f=""+Rs(fe[1],l,fe[0],re,T),g.F=Or(fe[0])}}break;case 1212:{if(!e.cellFormula)break;if(x){if(!c)break;A[wr(c.cell)]=fe[0],g=e.dense?(n[c.cell.r]||[])[c.cell.c]:n[wr(c.cell)],(g||{}).f=""+Rs(fe[0],l,v,re,T)}}break;case 253:E=vp(f[fe.isst].t,fe.ixfe,"s"),f[fe.isst].h&&(E.h=f[fe.isst].h),E.XF=Y[E.ixfe],k>0&&(E.z=F[E.ixfe>>8&63]),xl(E,e,r.opts.Date1904),D({c:fe.c,r:fe.r},E,e);break;case 513:e.sheetStubs&&(E={ixfe:fe.ixfe,XF:Y[fe.ixfe],t:"z"},k>0&&(E.z=F[E.ixfe>>8&63]),xl(E,e,r.opts.Date1904),D({c:fe.c,r:fe.r},E,e));break;case 190:if(e.sheetStubs)for(var jt=fe.c;jt<=fe.C;++jt){var Dt=fe.ixfe[jt-fe.c];E={ixfe:Dt,XF:Y[Dt],t:"z"},k>0&&(E.z=F[E.ixfe>>8&63]),xl(E,e,r.opts.Date1904),D({c:jt,r:fe.r},E,e)}break;case 214:case 516:case 4:E=vp(fe.val,fe.ixfe,"s"),E.XF=Y[E.ixfe],k>0&&(E.z=F[E.ixfe>>8&63]),xl(E,e,r.opts.Date1904),D({c:fe.c,r:fe.r},E,e);break;case 0:case 512:U===1&&(l=fe);break;case 252:f=fe;break;case 1054:if(T.biff==4){F[k++]=fe[1];for(var Wt=0;Wt<k+163&&_r[Wt]!=fe[1];++Wt);Wt>=163&&dc(fe[1],k+163)}else dc(fe[1],fe[0]);break;case 30:{F[k++]=fe;for(var et=0;et<k+163&&_r[et]!=fe;++et);et>=163&&dc(fe,k+163)}break;case 229:V=V.concat(fe);break;case 93:ie[fe.cmo[0]]=T.lastobj=fe;break;case 438:T.lastobj.TxO=fe;break;case 127:T.lastobj.ImData=fe;break;case 440:for(w=fe[0].s.r;w<=fe[0].e.r;++w)for(_=fe[0].s.c;_<=fe[0].e.c;++_)g=e.dense?(n[w]||[])[_]:n[wr({c:_,r:w})],g&&(g.l=fe[1]);break;case 2048:for(w=fe[0].s.r;w<=fe[0].e.r;++w)for(_=fe[0].s.c;_<=fe[0].e.c;++_)g=e.dense?(n[w]||[])[_]:n[wr({c:_,r:w})],g&&g.l&&(g.l.Tooltip=fe[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;g=e.dense?(n[fe[0].r]||[])[fe[0].c]:n[wr(fe[0])];var ht=ie[fe[2]];g||(e.dense?(n[fe[0].r]||(n[fe[0].r]=[]),g=n[fe[0].r][fe[0].c]={t:"z"}):g=n[wr(fe[0])]={t:"z"},l.e.r=Math.max(l.e.r,fe[0].r),l.s.r=Math.min(l.s.r,fe[0].r),l.e.c=Math.max(l.e.c,fe[0].c),l.s.c=Math.min(l.s.c,fe[0].c)),g.c||(g.c=[]),b={a:fe[1],t:ht.TxO.t},g.c.push(b)}break;case 2173:_F(Y[fe.ixfe],fe.ext);break;case 125:{if(!T.cellStyles)break;for(;fe.e>=fe.s;)X[fe.e--]={width:fe.w/256,level:fe.level||0,hidden:!!(fe.flags&1)},K||(K=!0,A2(fe.w/256)),pu(X[fe.e+1])}break;case 520:{var yt={};fe.level!=null&&(Z[fe.r]=yt,yt.level=fe.level),fe.hidden&&(Z[fe.r]=yt,yt.hidden=!0),fe.hpt&&(Z[fe.r]=yt,yt.hpt=fe.hpt,yt.hpx=oh(fe.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||pf(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[pe]]=fe;break;case 161:n["!margins"]||pf(n["!margins"]={}),n["!margins"].header=fe.header,n["!margins"].footer=fe.footer;break;case 574:fe.RTL&&(B.Views[0].RTL=!0);break;case 146:W=fe;break;case 2198:M=fe;break;case 140:R=fe;break;case 442:d?q.CodeName=fe||q.name:B.WBProps.CodeName=fe||"ThisWorkbook";break}}else _e||console.error("Missing Info for XLS Record 0x"+pe.toString(16)),t.l+=ve}return r.SheetNames=pn(s).sort(function(ft,pt){return Number(ft)-Number(pt)}).map(function(ft){return s[ft].name}),e.bookSheets||(r.Sheets=a),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&I.forEach(function(ft,pt){r.Sheets[r.SheetNames[pt]]["!autofilter"]=ft}),r.Strings=f,r.SSF=qa(_r),T.enc&&(r.Encryption=T.enc),M&&(r.Themes=M),r.Metadata={},R!==void 0&&(r.Metadata.Country=R),re.names.length>0&&(B.Names=re.names),r.Workbook=B,r}var y0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function FI(t,e,r){var a=hr.find(t,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Uw(a,vx,y0.DSI);for(var s in n)e[s]=n[s]}catch(d){if(r.WTF)throw d}var l=hr.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var c=Uw(l,xx,y0.SI);for(var f in c)e[f]==null&&(e[f]=c[f])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(K3(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function LI(t,e){var r=[],a=[],n=[],s=0,l,c=gw(vx,"n"),f=gw(xx,"n");if(t.Props)for(l=pn(t.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(c,l[s])?r:Object.prototype.hasOwnProperty.call(f,l[s])?a:n).push([l[s],t.Props[l[s]]]);if(t.Custprops)for(l=pn(t.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(c,l[s])?r:Object.prototype.hasOwnProperty.call(f,l[s])?a:n).push([l[s],t.Custprops[l[s]]]);var d=[];for(s=0;s<n.length;++s)aN.indexOf(n[s][0])>-1||X3.indexOf(n[s][0])>-1||n[s][1]!=null&&d.push(n[s]);a.length&&hr.utils.cfb_add(e,"/SummaryInformation",qw(a,y0.SI,f,xx)),(r.length||d.length)&&hr.utils.cfb_add(e,"/DocumentSummaryInformation",qw(r,y0.DSI,c,vx,d.length?d:null,y0.UDI))}function ZN(t,e){e||(e={}),M2(e),n2(),e.codepage&&a2(e.codepage);var r,a;if(t.FullPaths){if(hr.find(t,"/encryption"))throw new Error("File is password-protected");r=hr.find(t,"!CompObj"),a=hr.find(t,"/Workbook")||hr.find(t,"/Book")}else{switch(e.type){case"base64":t=Pi(qi(t));break;case"binary":t=Pi(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ys(t,0),a={content:t}}var n,s;if(r&&TI(r),e.bookProps&&!e.bookSheets)n={};else{var l=Pr?"buffer":"array";if(a&&a.content)n=DI(a.content,e);else if((s=hr.find(t,"PerfectOffice_MAIN"))&&s.content)n=mf.to_workbook(s.content,(e.type=l,e));else if((s=hr.find(t,"NativeContent_MAIN"))&&s.content)n=mf.to_workbook(s.content,(e.type=l,e));else throw(s=hr.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&hr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=YF(t))}var c={};return t.FullPaths&&FI(t,c,e),n.Props=n.Custprops=c,e.bookFiles&&(n.cfb=t),n}function PI(t,e){var r=e||{},a=hr.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return hr.utils.cfb_add(a,n,QN(t,r)),r.biff==8&&(t.Props||t.Custprops)&&LI(t,a),r.biff==8&&t.vbaraw&&XF(a,hr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),a}var U0={0:{f:i9},1:{f:m9},2:{f:D9},3:{f:w9},4:{f:x9},5:{f:T9},6:{f:I9},7:{f:j9},8:{f:W9},9:{f:$9},10:{f:z9},11:{f:H9},12:{f:g9},13:{f:L9},14:{f:N9},15:{f:_9},16:{f:$N},17:{f:U9},18:{f:A9},19:{f:x2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:UM},40:{},42:{},43:{f:ID},44:{f:PD},45:{f:qD},46:{f:HD},47:{f:zD},48:{},49:{f:cO},50:{},51:{f:SF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:mN},62:{f:M9},63:{f:RF},64:{f:oM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ps,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:aM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:d9},148:{f:c9,p:16},151:{f:J9},152:{},153:{f:MM},154:{},155:{},156:{f:LM},157:{},158:{},159:{T:1,f:QR},160:{T:-1},161:{T:1,f:Df},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:V9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bF},336:{T:-1},337:{f:jF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:gx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:hN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Z9},427:{f:Q9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:tM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:f9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:X9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:gx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:HF},633:{T:1},634:{T:-1},635:{T:1,f:qF},636:{T:-1},637:{f:hO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:NM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:lM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Nx={6:{f:uv},10:{f:tu},12:{f:Ln},13:{f:Ln},14:{f:_n},15:{f:_n},16:{f:Fs},17:{f:_n},18:{f:_n},19:{f:Ln},20:{f:Gw},21:{f:Gw},23:{f:hN},24:{f:Xw},25:{f:_n},26:{},27:{},28:{f:lR},29:{},34:{f:_n},35:{f:Yw},38:{f:Fs},39:{f:Fs},40:{f:Fs},41:{f:Fs},42:{f:_n},43:{f:_n},47:{f:_D},49:{f:L7},51:{f:Ln},60:{},61:{f:T7},64:{f:_n},65:{f:F7},66:{f:Ln},77:{},80:{},81:{},82:{},85:{f:Ln},89:{},90:{},91:{},92:{f:y7},93:{f:fR},94:{},95:{f:_n},96:{},97:{},99:{f:_n},125:{f:mN},128:{f:K7},129:{f:b7},130:{f:Ln},131:{f:_n},132:{f:_n},133:{f:w7},134:{},140:{f:yR},141:{f:Ln},144:{},146:{f:wR},151:{},152:{},153:{},154:{},155:{},156:{f:Ln},157:{},158:{},160:{f:CR},161:{f:kR},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:V7},190:{f:G7},193:{f:tu},197:{},198:{},199:{},200:{},201:{},202:{f:_n},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ln},220:{},221:{f:_n},222:{},224:{f:X7},225:{f:x7},226:{f:tu},227:{},229:{f:cR},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:N7},253:{f:M7},255:{f:j7},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:nN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:_n},353:{f:tu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:tR},431:{f:_n},432:{},433:{},434:{},437:{},438:{f:mR},439:{f:_n},440:{f:pR},441:{},442:{f:Z0},443:{},444:{f:Ln},445:{},446:{},448:{f:tu},449:{f:C7,r:2},450:{f:tu},512:{f:$w},513:{f:AR},515:{f:Q7},516:{f:B7},517:{f:Vw},519:{f:TR},520:{f:E7},523:{},545:{f:Kw},549:{f:Hw},566:{},574:{f:R7},638:{f:W7},659:{},1048:{},1054:{f:q7},1084:{},1212:{f:sR},2048:{f:vR},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:mp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:tu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:SR,r:12},2173:{f:yF,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:_n,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:nR,r:12},2197:{},2198:{f:hF,r:12},2199:{},2200:{},2201:{},2202:{f:iR,r:12},2203:{f:tu},2204:{},2205:{},2206:{},2207:{},2211:{f:A7},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ln},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:jR},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:bR},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:$w},1:{},2:{f:LR},3:{f:DR},4:{f:RR},5:{f:Vw},7:{f:MR},8:{},9:{f:mp},11:{},22:{f:Ln},30:{f:H7},31:{},32:{},33:{f:Kw},36:{},37:{f:Hw},50:{f:IR},62:{},52:{},67:{},68:{f:Ln},69:{},86:{},126:{},127:{f:OR},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:BR},223:{},234:{},354:{},421:{},518:{f:uv},521:{f:mp},536:{f:Xw},547:{f:Yw},561:{},579:{},1030:{f:uv},1033:{f:mp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function It(t,e,r,a){var n=e;if(!isNaN(n)){var s=a||(r||[]).length||0,l=t.next(4);l.write_shift(2,n),l.write_shift(2,s),s>0&&p2(r)&&t.push(r)}}function MI(t,e,r,a){var n=(r||[]).length||0;if(n<=8224)return It(t,e,r,n);var s=e;if(!isNaN(s)){for(var l=r.parts||[],c=0,f=0,d=0;d+(l[c]||8224)<=8224;)d+=l[c]||8224,c++;var m=t.next(4);for(m.write_shift(2,s),m.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d;f<n;){for(m=t.next(4),m.write_shift(2,60),d=0;d+(l[c]||8224)<=8224;)d+=l[c]||8224,c++;m.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d}}}function rm(t,e,r){return t||(t=ut(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function II(t,e,r,a){var n=ut(9);return rm(n,t,e),sN(r,a||"b",n),n}function BI(t,e,r){var a=ut(8+2*r.length);return rm(a,t,e),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function UI(t,e,r,a){if(e.v!=null)switch(e.t){case"d":case"n":var n=e.t=="d"?Kn(Ua(e.v)):e.v;n==(n|0)&&n>=0&&n<65536?It(t,2,PR(r,a,n)):It(t,3,FR(r,a,n));return;case"b":case"e":It(t,5,II(r,a,e.v,e.t));return;case"s":case"str":It(t,4,BI(r,a,(e.v||"").slice(0,255)));return}It(t,1,rm(null,r,a))}function qI(t,e,r,a){var n=Array.isArray(e),s=ea(e["!ref"]||"A1"),l,c="",f=[];if(s.e.c>255||s.e.r>16383){if(a.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=Or(s)}for(var d=s.s.r;d<=s.e.r;++d){c=jn(d);for(var m=s.s.c;m<=s.e.c;++m){d===s.s.r&&(f[m]=en(m)),l=f[m]+c;var v=n?(e[d]||[])[m]:e[l];v&&UI(t,v,d,m)}}}function zI(t,e){for(var r=e||{},a=di(),n=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(n=s);if(n==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return It(a,r.biff==4?1033:r.biff==3?521:9,k2(t,16,r)),qI(a,t.Sheets[t.SheetNames[n]],n,r),It(a,10),a.end()}function HI(t,e,r){It(t,49,P7({sz:12,name:"Arial"},r))}function $I(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&It(t,1054,z7(n,e[n],r))})}function WI(t,e){var r=ut(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),It(t,2151,r),r=ut(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),uN(ea(e["!ref"]||"A1"),r),r.write_shift(4,4),It(t,2152,r)}function VI(t,e){for(var r=0;r<16;++r)It(t,224,Ww({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(a){It(t,224,Ww(a,0,e))})}function GI(t,e){for(var r=0;r<e["!links"].length;++r){var a=e["!links"][r];It(t,440,gR(a)),a[1].Tooltip&&It(t,2048,xR(a))}delete e["!links"]}function YI(t,e){if(e){var r=0;e.forEach(function(a,n){++r<=256&&a&&It(t,125,NR(S1(n,a),n))})}}function XI(t,e,r,a,n){var s=16+wu(n.cellXfs,e,n);if(e.v==null&&!e.bf){It(t,513,bf(r,a,s));return}if(e.bf)It(t,6,bP(e,r,a,n,s));else switch(e.t){case"d":case"n":var l=e.t=="d"?Kn(Ua(e.v)):e.v;It(t,515,eR(r,a,l,s));break;case"b":case"e":It(t,517,Z7(r,a,e.v,s,n,e.t));break;case"s":case"str":if(n.bookSST){var c=D2(n.Strings,e.v,n.revStrings);It(t,253,I7(r,a,c,s))}else It(t,516,U7(r,a,(e.v||"").slice(0,255),s,n));break;default:It(t,513,bf(r,a,s))}}function KI(t,e,r){var a=di(),n=r.SheetNames[t],s=r.Sheets[n]||{},l=(r||{}).Workbook||{},c=(l.Sheets||[])[t]||{},f=Array.isArray(s),d=e.biff==8,m,v="",x=[],g=ea(s["!ref"]||"A1"),b=d?65536:16384;if(g.e.c>255||g.e.r>=b){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,b-1)}It(a,2057,k2(r,16,e)),It(a,13,co(1)),It(a,12,co(100)),It(a,15,Vs(!0)),It(a,17,Vs(!1)),It(a,16,yf(.001)),It(a,95,Vs(!0)),It(a,42,Vs(!1)),It(a,43,Vs(!1)),It(a,130,co(1)),It(a,128,J7()),It(a,131,Vs(!1)),It(a,132,Vs(!1)),d&&YI(a,s["!cols"]),It(a,512,$7(g,e)),d&&(s["!links"]=[]);for(var _=g.s.r;_<=g.e.r;++_){v=jn(_);for(var w=g.s.c;w<=g.e.c;++w){_===g.s.r&&(x[w]=en(w)),m=x[w]+v;var A=f?(s[_]||[])[w]:s[m];A&&(XI(a,A,_,w,e),d&&A.l&&s["!links"].push([m,A.l]))}}var C=c.CodeName||c.name||n;return d&&It(a,574,D7((l.Views||[])[0])),d&&(s["!merges"]||[]).length&&It(a,229,uR(s["!merges"])),d&&GI(a,s),It(a,442,iN(C)),d&&WI(a,s),It(a,10),a.end()}function JI(t,e,r){var a=di(),n=(t||{}).Workbook||{},s=n.Sheets||[],l=n.WBProps||{},c=r.biff==8,f=r.biff==5;if(It(a,2057,k2(t,5,r)),r.bookType=="xla"&&It(a,135),It(a,225,c?co(1200):null),It(a,193,ZO(2)),f&&It(a,191),f&&It(a,192),It(a,226),It(a,92,_7("SheetJS",r)),It(a,66,co(c?1200:1252)),c&&It(a,353,co(0)),c&&It(a,448),It(a,317,ER(t.SheetNames.length)),c&&t.vbaraw&&It(a,211),c&&t.vbaraw){var d=l.CodeName||"ThisWorkbook";It(a,442,iN(d))}It(a,156,co(17)),It(a,25,Vs(!1)),It(a,18,Vs(!1)),It(a,19,co(0)),c&&It(a,431,Vs(!1)),c&&It(a,444,co(0)),It(a,61,O7()),It(a,64,Vs(!1)),It(a,141,co(0)),It(a,34,Vs(CM(t)=="true")),It(a,14,Vs(!0)),c&&It(a,439,Vs(!1)),It(a,218,co(0)),HI(a,t,r),$I(a,t.SSF,r),VI(a,r),c&&It(a,352,Vs(!1));var m=a.end(),v=di();c&&It(v,140,_R()),c&&r.Strings&&MI(v,252,k7(r.Strings)),It(v,10);var x=v.end(),g=di(),b=0,_=0;for(_=0;_<t.SheetNames.length;++_)b+=(c?12:11)+(c?2:1)*t.SheetNames[_].length;var w=m.length+b+x.length;for(_=0;_<t.SheetNames.length;++_){var A=s[_]||{};It(g,133,S7({pos:w,hs:A.Hidden||0,dt:0,name:t.SheetNames[_]},r)),w+=e[_].length}var C=g.end();if(b!=C.length)throw new Error("BS8 "+b+" != "+C.length);var E=[];return m.length&&E.push(m),C.length&&E.push(C),x.length&&E.push(x),ss(E)}function ZI(t,e){var r=e||{},a=[];t&&!t.SSF&&(t.SSF=qa(_r)),t&&t.SSF&&(hh(),g1(t.SSF),r.revssf=x1(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,I2(r),r.cellXfs=[],wu(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var n=0;n<t.SheetNames.length;++n)a[a.length]=KI(n,r,t);return a.unshift(JI(t,a,r)),ss(a)}function QN(t,e){for(var r=0;r<=t.SheetNames.length;++r){var a=t.Sheets[t.SheetNames[r]];if(!(!a||!a["!ref"])){var n=hi(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return ZI(t,e);case 4:case 3:case 2:return zI(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function i5(t,e){var r=e||{},a=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var n=t.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),l=n.index,c=s&&s.index||t.length,f=P8(t.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,m=0,v=0,x=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(l=0;l<f.length;++l){var _=f[l].trim(),w=_.slice(0,3).toLowerCase();if(w=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}m=0;continue}if(!(w!="<td"&&w!="<th")){var A=_.split(/<\/t[dh]>/i);for(c=0;c<A.length;++c){var C=A[c].trim();if(C.match(/<t[dh]/i)){for(var E=C,R=0;E.charAt(0)=="<"&&(R=E.indexOf(">"))>-1;)E=E.slice(R+1);for(var Y=0;Y<b.length;++Y){var W=b[Y];W.s.c==m&&W.s.r<d&&d<=W.e.r&&(m=W.e.c+1,Y=-1)}var B=Sr(C.slice(0,C.indexOf(">")));x=B.colspan?+B.colspan:1,((v=+B.rowspan)>1||x>1)&&b.push({s:{r:d,c:m},e:{r:d+(v||1)-1,c:m+x-1}});var q=B.t||B["data-t"]||"";if(!E.length){m+=x;continue}if(E=S3(E),g.s.r>d&&(g.s.r=d),g.e.r<d&&(g.e.r=d),g.s.c>m&&(g.s.c=m),g.e.c<m&&(g.e.c=m),!E.length){m+=x;continue}var L={t:"s",v:E};r.raw||!E.trim().length||q=="s"||(E==="TRUE"?L={t:"b",v:!0}:E==="FALSE"?L={t:"b",v:!1}:isNaN(Yo(E))?isNaN(sh(E).getDate())||(L={t:"d",v:Ua(E)},r.cellDates||(L={t:"n",v:Kn(L.v)}),L.z=r.dateNF||_r[14]):L={t:"n",v:Yo(E)}),r.dense?(a[d]||(a[d]=[]),a[d][m]=L):a[wr({r:d,c:m})]=L,m+=x}}}}return a["!ref"]=Or(g),b.length&&(a["!merges"]=b),a}function QI(t,e,r,a){for(var n=t["!merges"]||[],s=[],l=e.s.c;l<=e.e.c;++l){for(var c=0,f=0,d=0;d<n.length;++d)if(!(n[d].s.r>r||n[d].s.c>l)&&!(n[d].e.r<r||n[d].e.c<l)){if(n[d].s.r<r||n[d].s.c<l){c=-1;break}c=n[d].e.r-n[d].s.r+1,f=n[d].e.c-n[d].s.c+1;break}if(!(c<0)){var m=wr({r,c:l}),v=a.dense?(t[r]||[])[l]:t[m],x=v&&v.v!=null&&(v.h||d2(v.w||(mc(v),v.w)||""))||"",g={};c>1&&(g.rowspan=c),f>1&&(g.colspan=f),a.editable?x='<span contenteditable="true">'+x+"</span>":v&&(g["data-t"]=v&&v.t||"z",v.v!=null&&(g["data-v"]=v.v),v.z!=null&&(g["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+v.l.Target+'">'+x+"</a>")),g.id=(a.id||"sjs")+"-"+m,s.push(Ft("td",x,g))}}var b="<tr>";return b+s.join("")+"</tr>"}var eB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',tB="</body></html>";function rB(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return bu(i5(r[0],e),e);var a=q2();return r.forEach(function(n,s){z2(a,i5(n,e),"Sheet"+(s+1))}),a}function aB(t,e,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ek(t,e){var r=e||{},a=r.header!=null?r.header:eB,n=r.footer!=null?r.footer:tB,s=[a],l=hi(t["!ref"]);r.dense=Array.isArray(t),s.push(aB(t,l,r));for(var c=l.s.r;c<=l.e.r;++c)s.push(QI(t,l,c,r));return s.push("</table>"+n),s.join("")}function tk(t,e,r){var a=r||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var l=typeof a.origin=="string"?tn(a.origin):a.origin;n=l.r,s=l.c}var c=e.getElementsByTagName("tr"),f=Math.min(a.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:n,c:s}};if(t["!ref"]){var m=hi(t["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),n==-1&&(d.e.r=n=m.e.r+1)}var v=[],x=0,g=t["!rows"]||(t["!rows"]=[]),b=0,_=0,w=0,A=0,C=0,E=0;for(t["!cols"]||(t["!cols"]=[]);b<c.length&&_<f;++b){var R=c[b];if(o5(R)){if(a.display)continue;g[_]={hidden:!0}}var Y=R.children;for(w=A=0;w<Y.length;++w){var W=Y[w];if(!(a.display&&o5(W))){var B=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):S3(W.innerHTML),q=W.getAttribute("data-z")||W.getAttribute("z");for(x=0;x<v.length;++x){var L=v[x];L.s.c==A+s&&L.s.r<_+n&&_+n<=L.e.r&&(A=L.e.c+1-s,x=-1)}E=+W.getAttribute("colspan")||1,((C=+W.getAttribute("rowspan")||1)>1||E>1)&&v.push({s:{r:_+n,c:A+s},e:{r:_+n+(C||1)-1,c:A+s+(E||1)-1}});var J={t:"s",v:B},D=W.getAttribute("data-t")||W.getAttribute("t")||"";B!=null&&(B.length==0?J.t=D||"z":a.raw||B.trim().length==0||D=="s"||(B==="TRUE"?J={t:"b",v:!0}:B==="FALSE"?J={t:"b",v:!1}:isNaN(Yo(B))?isNaN(sh(B).getDate())||(J={t:"d",v:Ua(B)},a.cellDates||(J={t:"n",v:Kn(J.v)}),J.z=a.dateNF||_r[14]):J={t:"n",v:Yo(B)})),J.z===void 0&&q!=null&&(J.z=q);var T="",M=W.getElementsByTagName("A");if(M&&M.length)for(var V=0;V<M.length&&!(M[V].hasAttribute("href")&&(T=M[V].getAttribute("href"),T.charAt(0)!="#"));++V);T&&T.charAt(0)!="#"&&(J.l={Target:T}),a.dense?(t[_+n]||(t[_+n]=[]),t[_+n][A+s]=J):t[wr({c:A+s,r:_+n})]=J,d.e.c<A+s&&(d.e.c=A+s),A+=E}}++_}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),d.e.r=Math.max(d.e.r,_-1+n),t["!ref"]=Or(d),_>=f&&(t["!fullref"]=Or((d.e.r=c.length-b+_-1+n,d))),t}function rk(t,e){var r=e||{},a=r.dense?[]:{};return tk(a,t,e)}function nB(t,e){return bu(rk(t,e),e)}function o5(t){var e="",r=sB(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function sB(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function iB(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Qr(e.replace(/<[^>]*>/g,""));return[r]}var l5={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ak(t,e){var r=e||{},a=h2(t),n=[],s,l,c={name:""},f="",d=0,m,v,x={},g=[],b=r.dense?[]:{},_,w,A={value:""},C="",E=0,R=[],Y=-1,W=-1,B={s:{r:1e6,c:1e7},e:{r:0,c:0}},q=0,L={},J=[],D={},T=0,M=0,V=[],ie=1,X=1,Z=[],K={Names:[]},re={},de=["",""],U=[],k={},F="",I=0,z=!1,te=!1,se=0;for(F0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=F0.exec(a);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"":_[1]==="/"?(B.e.c>=B.s.c&&B.e.r>=B.s.r?b["!ref"]=Or(B):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=B.e.r&&(b["!fullref"]=b["!ref"],B.e.r=r.sheetRows-1,b["!ref"]=Or(B)),J.length&&(b["!merges"]=J),V.length&&(b["!rows"]=V),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),g.push(m.name),x[m.name]=b,te=!1):_[0].charAt(_[0].length-2)!=="/"&&(m=Sr(_[0],!1),Y=W=-1,B.s.r=B.s.c=1e7,B.e.r=B.e.c=0,b=r.dense?[]:{},J=[],V=[],te=!0);break;case"table-row-group":_[1]==="/"?--q:++q;break;case"table-row":case"":if(_[1]==="/"){Y+=ie,ie=1;break}if(v=Sr(_[0],!1),v.?Y=v.-1:Y==-1&&(Y=0),ie=+v["number-rows-repeated"]||1,ie<10)for(se=0;se<ie;++se)q>0&&(V[Y+se]={level:q});W=-1;break;case"covered-table-cell":_[1]!=="/"&&++W,r.sheetStubs&&(r.dense?(b[Y]||(b[Y]=[]),b[Y][W]={t:"z"}):b[wr({r:Y,c:W})]={t:"z"}),C="",R=[];break;case"table-cell":case"":if(_[0].charAt(_[0].length-2)==="/")++W,A=Sr(_[0],!1),X=parseInt(A["number-columns-repeated"]||"1",10),w={t:"z",v:null},A.formula&&r.cellFormula!=!1&&(w.f=a5(Qr(A.formula))),(A.||A["value-type"])=="string"&&(w.t="s",w.v=Qr(A["string-value"]||""),r.dense?(b[Y]||(b[Y]=[]),b[Y][W]=w):b[wr({r:Y,c:W})]=w),W+=X-1;else if(_[1]!=="/"){++W,C="",E=0,R=[],X=1;var pe=ie?Y+ie-1:Y;if(W>B.e.c&&(B.e.c=W),W<B.s.c&&(B.s.c=W),Y<B.s.r&&(B.s.r=Y),pe>B.e.r&&(B.e.r=pe),A=Sr(_[0],!1),U=[],k={},w={t:A.||A["value-type"],v:null},r.cellFormula)if(A.formula&&(A.formula=Qr(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(T=parseInt(A["number-matrix-rows-spanned"],10)||0,M=parseInt(A["number-matrix-columns-spanned"],10)||0,D={s:{r:Y,c:W},e:{r:Y+T-1,c:W+M-1}},w.F=Or(D),Z.push([D,w.F])),A.formula)w.f=a5(A.formula);else for(se=0;se<Z.length;++se)Y>=Z[se][0].s.r&&Y<=Z[se][0].e.r&&W>=Z[se][0].s.c&&W<=Z[se][0].e.c&&(w.F=Z[se][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(T=parseInt(A["number-rows-spanned"],10)||0,M=parseInt(A["number-columns-spanned"],10)||0,D={s:{r:Y,c:W},e:{r:Y+T-1,c:W+M-1}},J.push(D)),A["number-columns-repeated"]&&(X=parseInt(A["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Ia(A["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(A.value);break;case"percentage":w.t="n",w.v=parseFloat(A.value);break;case"currency":w.t="n",w.v=parseFloat(A.value);break;case"date":w.t="d",w.v=Ua(A["date-value"]),r.cellDates||(w.t="n",w.v=Kn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=D8(A["time-value"])/86400,r.cellDates&&(w.t="d",w.v=y1(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(A.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",A["string-value"]!=null&&(C=Qr(A["string-value"]),R=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(z=!1,w.t==="s"&&(w.v=C||"",R.length&&(w.R=R),z=E==0),re.Target&&(w.l=re),U.length>0&&(w.c=U,U=[]),C&&r.cellText!==!1&&(w.w=C),z&&(w.t="z",delete w.v),(!z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=Y))for(var ve=0;ve<ie;++ve){if(X=parseInt(A["number-columns-repeated"]||"1",10),r.dense)for(b[Y+ve]||(b[Y+ve]=[]),b[Y+ve][W]=ve==0?w:qa(w);--X>0;)b[Y+ve][W+X]=qa(w);else for(b[wr({r:Y+ve,c:W})]=w;--X>0;)b[wr({r:Y+ve,c:W+X})]=qa(w);B.e.c<=W&&(B.e.c=W)}X=parseInt(A["number-columns-repeated"]||"1",10),W+=X-1,X=0,w={},C="",R=[]}re={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((s=n.pop())[0]!==_[3])throw"Bad state: "+s}else _[0].charAt(_[0].length-2)!=="/"&&n.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((s=n.pop())[0]!==_[3])throw"Bad state: "+s;k.t=C,R.length&&(k.R=R),k.a=F,U.push(k)}else _[0].charAt(_[0].length-2)!=="/"&&n.push([_[3],!1]);F="",I=0,C="",E=0,R=[];break;case"creator":_[1]==="/"?F=a.slice(I,_.index):I=_.index+_[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((s=n.pop())[0]!==_[3])throw"Bad state: "+s}else _[0].charAt(_[0].length-2)!=="/"&&n.push([_[3],!1]);C="",E=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(L[c.name]=f,(s=n.pop())[0]!==_[3])throw"Bad state: "+s}else _[0].charAt(_[0].length-2)!=="/"&&(f="",c=Sr(_[0],!1),n.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Sr(_[0],!1),f+=l5[_[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Sr(_[0],!1),f+=l5[_[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":f+=a.slice(d,_.index);break}else d=_.index+_[0].length;break;case"named-range":l=Sr(_[0],!1),de=fv(l["cell-range-address"]);var _e={Name:l.name,Ref:de[0]+"!"+de[1]};te&&(_e.Sheet=g.length),K.Names.push(_e);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(_[1]==="/"&&(!A||!A["string-value"])){var Pe=iB(a.slice(E,_.index));C=(C.length>0?C+`
`:"")+Pe[0]}else Sr(_[0],!1),E=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{de=fv(Sr(_[0])["target-range-address"]),x[de[0]]["!autofilter"]={ref:de[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(re=Sr(_[0],!1),!re.href)break;re.Target=Qr(re.href),delete re.href,re.Target.charAt(0)=="#"&&re.Target.indexOf(".")>-1?(de=fv(re.Target.slice(1)),re.Target="#"+de[0]+"!"+de[1]):re.Target.match(/^\.\.[\\\/]/)&&(re.Target=re.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(_)}}var fe={Sheets:x,SheetNames:g,Workbook:K};return r.bookSheets&&delete fe.Sheets,fe}function c5(t,e){e=e||{},lo(t,"META-INF/manifest.xml")&&DO(Fn(t,"META-INF/manifest.xml"),e);var r=Mi(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=ak(Sa(r),e);return lo(t,"meta.xml")&&(a.Props=G3(Fn(t,"meta.xml"))),a}function u5(t,e){return ak(t,e)}var oB=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+D0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return En+e}})(),f5=(function(){var t=function(s){return ga(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(s,l,c){var f=[];f.push('      <table:table table:name="'+ga(l.SheetNames[c])+`" table:style-name="ta1">
`);var d=0,m=0,v=hi(s["!ref"]||"A1"),x=s["!merges"]||[],g=0,b=Array.isArray(s);if(s["!cols"])for(m=0;m<=v.e.c;++m)f.push("        <table:table-column"+(s["!cols"][m]?' table:style-name="co'+s["!cols"][m].ods+'"':"")+`></table:table-column>
`);var _="",w=s["!rows"]||[];for(d=0;d<v.s.r;++d)_=w[d]?' table:style-name="ro'+w[d].ods+'"':"",f.push("        <table:table-row"+_+`></table:table-row>
`);for(;d<=v.e.r;++d){for(_=w[d]?' table:style-name="ro'+w[d].ods+'"':"",f.push("        <table:table-row"+_+`>
`),m=0;m<v.s.c;++m)f.push(e);for(;m<=v.e.c;++m){var A=!1,C={},E="";for(g=0;g!=x.length;++g)if(!(x[g].s.c>m)&&!(x[g].s.r>d)&&!(x[g].e.c<m)&&!(x[g].e.r<d)){(x[g].s.c!=m||x[g].s.r!=d)&&(A=!0),C["table:number-columns-spanned"]=x[g].e.c-x[g].s.c+1,C["table:number-rows-spanned"]=x[g].e.r-x[g].s.r+1;break}if(A){f.push(r);continue}var R=wr({r:d,c:m}),Y=b?(s[d]||[])[m]:s[R];if(Y&&Y.f&&(C["table:formula"]=ga(EP(Y.f)),Y.F&&Y.F.slice(0,R.length)==R)){var W=hi(Y.F);C["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,C["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!Y){f.push(e);continue}switch(Y.t){case"b":E=Y.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=Y.v?"true":"false";break;case"n":E=Y.w||String(Y.v||0),C["office:value-type"]="float",C["office:value"]=Y.v||0;break;case"s":case"str":E=Y.v==null?"":Y.v,C["office:value-type"]="string";break;case"d":E=Y.w||Ua(Y.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=Ua(Y.v).toISOString(),C["table:style-name"]="ce1";break;default:f.push(e);continue}var B=t(E);if(Y.l&&Y.l.Target){var q=Y.l.Target;q=q.charAt(0)=="#"?"#"+AP(q.slice(1)):q,q.charAt(0)!="#"&&!q.match(/^\w+:/)&&(q="../"+q),B=Ft("text:a",B,{"xlink:href":q.replace(/&/g,"&amp;")})}f.push("          "+Ft("table:table-cell",Ft("text:p",B,{}),C)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},n=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var m=0;m<d["!cols"].length;++m)if(d["!cols"][m]){var v=d["!cols"][m];if(v.width==null&&v.wpx==null&&v.wch==null)continue;pu(v),v.ods=c;var x=d["!cols"][m].wpx+"px";s.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),s.push(`  </style:style>
`),++c}}});var f=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var m=0;m<d["!rows"].length;++m)if(d["!rows"][m]){d["!rows"][m].ods=f;var v=d["!rows"][m].hpx+"px";s.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),s.push(`  </style:style>
`),++f}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,c){var f=[En],d=D0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=D0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(f.push("<office:document"+d+m+`>
`),f.push(V3().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),n(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var v=0;v!=l.SheetNames.length;++v)f.push(a(l.Sheets[l.SheetNames[v]],l,v));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),c.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function nk(t,e){if(e.bookType=="fods")return f5(t,e);var r=c2(),a="",n=[],s=[];return a="mimetype",Dr(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Dr(r,a,f5(t,e)),n.push([a,"text/xml"]),s.push([a,"ContentFile"]),a="styles.xml",Dr(r,a,oB(t,e)),n.push([a,"text/xml"]),s.push([a,"StylesFile"]),a="meta.xml",Dr(r,a,En+V3()),n.push([a,"text/xml"]),s.push([a,"MetadataFile"]),a="manifest.rdf",Dr(r,a,PO(s)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Dr(r,a,FO(n)),r}function wf(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function kx(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Sa(_u(t))}function lB(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Pi(kl(t))}function cB(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var a=0;a<e.length;++a)if(t[r+a]!=e[a])continue e;return!0}return!1}function vu(t){var e=t.reduce(function(n,s){return n+s.length},0),r=new Uint8Array(e),a=0;return t.forEach(function(n){r.set(n,a),a+=n.length}),r}function d5(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function uB(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,a=t[e+14]&1,n=e+13;n>=e;--n)a=a*256+t[n];return(t[e+15]&128?-a:a)*Math.pow(10,r-6176)}function fB(t,e,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);t[e+15]|=a>>7,t[e+14]|=(a&127)<<1;for(var s=0;n>=1;++s,n/=256)t[e+s]=n&255;t[e+15]|=r>=0?0:128}function q0(t,e){var r=e?e[0]:0,a=t[r]&127;e:if(t[r++]>=128&&(a|=(t[r]&127)<<7,t[r++]<128||(a|=(t[r]&127)<<14,t[r++]<128)||(a|=(t[r]&127)<<21,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),a}function ha(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function mn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function na(t){for(var e=[],r=[0];r[0]<t.length;){var a=r[0],n=q0(t,r),s=n&7;n=Math.floor(n/8);var l=0,c;if(n==0)break;switch(s){case 0:{for(var f=r[0];t[r[0]++]>=128;);c=t.slice(f,r[0])}break;case 5:l=4,c=t.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,c=t.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=q0(t,r),c=t.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var d={data:c,type:s};e[n]==null?e[n]=[d]:e[n].push(d)}return e}function xs(t){var e=[];return t.forEach(function(r,a){r.forEach(function(n){n.data&&(e.push(ha(a*8+n.type)),n.type==2&&e.push(ha(n.data.length)),e.push(n.data))})}),vu(e)}function P2(t,e){return t?.map(function(r){return e(r.data)})||[]}function io(t){for(var e,r=[],a=[0];a[0]<t.length;){var n=q0(t,a),s=na(t.slice(a[0],a[0]+n));a[0]+=n;var l={id:mn(s[1][0].data),messages:[]};s[2].forEach(function(c){var f=na(c.data),d=mn(f[3][0].data);l.messages.push({meta:f,data:t.slice(a[0],a[0]+d)}),a[0]+=d}),(e=s[3])!=null&&e[0]&&(l.merge=mn(s[3][0].data)>>>0>0),r.push(l)}return r}function Fd(t){var e=[];return t.forEach(function(r){var a=[];a[1]=[{data:ha(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:ha(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(l){n.push(l.data),l.meta[3]=[{type:0,data:ha(l.data.length)}],a[2].push({data:xs(l.meta),type:2})});var s=xs(a);e.push(ha(s.length)),e.push(s),n.forEach(function(l){return e.push(l)})}),vu(e)}function dB(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],a=q0(e,r),n=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var l=e[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=e[r[0]],c>1&&(l|=e[r[0]+1]<<8),c>2&&(l|=e[r[0]+2]<<16),c>3&&(l|=e[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}n.push(e.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var f=0,d=0;if(s==1?(d=(e[r[0]]>>2&7)+4,f=(e[r[0]++]&224)<<3,f|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,s==2?(f=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(f=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),n=[vu(n)],f==0)throw new Error("Invalid offset 0");if(f>n[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(n.push(n[0].slice(-f)),d-=f;d>=n[n.length-1].length;)n.push(n[n.length-1]),d-=n[n.length-1].length;n.push(n[0].slice(-f,-f+d))}}var m=vu(n);if(m.length!=a)throw new Error("Unexpected length: ".concat(m.length," != ").concat(a));return m}function oo(t){for(var e=[],r=0;r<t.length;){var a=t[r++],n=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(dB(a,t.slice(r,r+n))),r+=n}if(r!==t.length)throw new Error("data is not a valid framed stream!");return vu(e)}function Ld(t){for(var e=[],r=0;r<t.length;){var a=Math.min(t.length-r,268435455),n=new Uint8Array(4);e.push(n);var s=ha(a),l=s.length;e.push(s),a<=60?(l++,e.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,e.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,e.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,e.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,e.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),e.push(t.slice(r,r+a)),l+=a,n[0]=0,n[1]=l&255,n[2]=l>>8&255,n[3]=l>>16&255,r+=a}return vu(e)}function hB(t,e,r,a){var n=wf(t),s=n.getUint32(4,!0),l=(a>1?12:8)+d5(s&(a>1?3470:398))*4,c=-1,f=-1,d=NaN,m=new Date(2001,0,1);s&512&&(c=n.getUint32(l,!0),l+=4),l+=d5(s&(a>1?12288:4096))*4,s&16&&(f=n.getUint32(l,!0),l+=4),s&32&&(d=n.getFloat64(l,!0),l+=8),s&64&&(m.setTime(m.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e[f]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(c>-1)v={t:"s",v:r[c]};else if(f>-1)v={t:"s",v:e[f]};else if(!isNaN(d))v={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function mB(t,e,r){var a=wf(t),n=a.getUint32(8,!0),s=12,l=-1,c=-1,f=NaN,d=NaN,m=new Date(2001,0,1);n&1&&(f=uB(t,s),s+=16),n&2&&(d=a.getFloat64(s,!0),s+=8),n&4&&(m.setTime(m.getTime()+a.getFloat64(s,!0)*1e3),s+=8),n&8&&(c=a.getUint32(s,!0),s+=4),n&16&&(l=a.getUint32(s,!0),s+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:f};break;case 3:v={t:"s",v:e[c]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)))}return v}function hv(t,e){var r=new Uint8Array(32),a=wf(r),n=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,fB(r,n,t.v),s|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,t.v?1:0,!0),s|=2,n+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,a.setUint32(n,e.indexOf(t.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(8,s,!0),r.slice(0,n)}function mv(t,e){var r=new Uint8Array(32),a=wf(r),n=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,a.setFloat64(n,t.v,!0),s|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,t.v?1:0,!0),s|=32,n+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,a.setUint32(n,e.indexOf(t.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(4,s,!0),r.slice(0,n)}function pB(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return hB(t,e,r,t[0]);case 5:return mB(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Os(t){var e=na(t);return q0(e[1][0].data)}function h5(t,e){var r=na(e.data),a=mn(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(l){var c=na(l.data),f=mn(c[1][0].data)>>>0;switch(a){case 1:s[f]=kx(c[3][0].data);break;case 8:{var d=t[Os(c[9][0].data)][0],m=na(d.data),v=t[Os(m[1][0].data)][0],x=mn(v.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var g=na(v.data);s[f]=g[3].map(function(b){return kx(b.data)}).join("")}break}}),s}function gB(t,e){var r,a,n,s,l,c,f,d,m,v,x,g,b,_,w=na(t),A=mn(w[1][0].data)>>>0,C=mn(w[2][0].data)>>>0,E=((a=(r=w[8])==null?void 0:r[0])==null?void 0:a.data)&&mn(w[8][0].data)>0||!1,R,Y;if((s=(n=w[7])==null?void 0:n[0])!=null&&s.data&&e!=0)R=(c=(l=w[7])==null?void 0:l[0])==null?void 0:c.data,Y=(d=(f=w[6])==null?void 0:f[0])==null?void 0:d.data;else if((v=(m=w[4])==null?void 0:m[0])!=null&&v.data&&e!=1)R=(g=(x=w[4])==null?void 0:x[0])==null?void 0:g.data,Y=(_=(b=w[3])==null?void 0:b[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var W=E?4:1,B=wf(R),q=[],L=0;L<R.length/2;++L){var J=B.getUint16(L*2,!0);J<65535&&q.push([L,J])}if(q.length!=C)throw"Expected ".concat(C," cells, found ").concat(q.length);var D=[];for(L=0;L<q.length-1;++L)D[q[L][0]]=Y.subarray(q[L][1]*W,q[L+1][1]*W);return q.length>=1&&(D[q[q.length-1][0]]=Y.subarray(q[q.length-1][1]*W)),{R:A,cells:D}}function vB(t,e){var r,a=na(e.data),n=(r=a?.[7])!=null&&r[0]?mn(a[7][0].data)>>>0>0?1:0:-1,s=P2(a[5],function(l){return gB(l,n)});return{nrows:mn(a[4][0].data)>>>0,data:s.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(f,d){if(l[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));l[c.R][d]=f}),l},[])}}function xB(t,e,r){var a,n=na(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(mn(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(mn(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Or(s);var l=na(n[4][0].data),c=h5(t,t[Os(l[4][0].data)][0]),f=(a=l[17])!=null&&a[0]?h5(t,t[Os(l[17][0].data)][0]):[],d=na(l[3][0].data),m=0;d[1].forEach(function(v){var x=na(v.data),g=t[Os(x[2][0].data)][0],b=mn(g.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var _=vB(t,g);_.data.forEach(function(w,A){w.forEach(function(C,E){var R=wr({r:m+A,c:E}),Y=pB(C,c,f);Y&&(r[R]=Y)})}),m+=_.nrows})}function yB(t,e){var r=na(e.data),a={"!ref":"A1"},n=t[Os(r[2][0].data)],s=mn(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return xB(t,n[0],a),a}function _B(t,e){var r,a=na(e.data),n={name:(r=a[1])!=null&&r[0]?kx(a[1][0].data):"",sheets:[]},s=P2(a[2],Os);return s.forEach(function(l){t[l].forEach(function(c){var f=mn(c.meta[1][0].data);f==6e3&&n.sheets.push(yB(t,c))})}),n}function bB(t,e){var r=q2(),a=na(e.data),n=P2(a[1],Os);if(n.forEach(function(s){t[s].forEach(function(l){var c=mn(l.meta[1][0].data);if(c==2){var f=_B(t,l);f.sheets.forEach(function(d,m){z2(r,d,m==0?f.name:f.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function pv(t){var e,r,a,n,s={},l=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=oo(f.content)}catch(v){return console.log("?? "+f.content.length+" "+(v.message||v))}var m;try{m=io(d)}catch(v){return console.log("## "+(v.message||v))}m.forEach(function(v){s[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var c=((n=(a=(r=(e=s?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&mn(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||l.forEach(function(f){s[f].forEach(function(d){var m=mn(d.meta[1][0].data)>>>0;if(m==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return bB(s,c)}function wB(t,e,r){var a,n,s,l;if(!((a=t[6])!=null&&a[0])||!((n=t[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(s=t[8])==null?void 0:s[0])==null?void 0:l.data)&&mn(t[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var f=0,d=wf(t[7][0].data),m=0,v=[],x=wf(t[4][0].data),g=0,b=[],_=0;_<e.length;++_){if(e[_]==null){d.setUint16(_*2,65535,!0),x.setUint16(_*2,65535);continue}d.setUint16(_*2,m,!0),x.setUint16(_*2,g,!0);var w,A;switch(typeof e[_]){case"string":w=hv({t:"s",v:e[_]},r),A=mv({t:"s",v:e[_]},r);break;case"number":w=hv({t:"n",v:e[_]},r),A=mv({t:"n",v:e[_]},r);break;case"boolean":w=hv({t:"b",v:e[_]},r),A=mv({t:"b",v:e[_]},r);break;default:throw new Error("Unsupported value "+e[_])}v.push(w),m+=w.length,b.push(A),g+=A.length,++f}for(t[2][0].data=ha(f);_<t[7][0].data.length/2;++_)d.setUint16(_*2,65535,!0),x.setUint16(_*2,65535,!0);return t[6][0].data=vu(v),t[3][0].data=vu(b),f}function SB(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=hi(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Or(a)));var s=a1(r,{range:a,header:1}),l=["~Sh33tJ5~"];s.forEach(function(F){return F.forEach(function(I){typeof I=="string"&&l.push(I)})});var c={},f=[],d=hr.read(e.numbers,{type:"base64"});d.FileIndex.map(function(F,I){return[F,d.FullPaths[I]]}).forEach(function(F){var I=F[0],z=F[1];if(I.type==2&&I.name.match(/\.iwa/)){var te=I.content,se=oo(te),pe=io(se);pe.forEach(function(ve){f.push(ve.id),c[ve.id]={deps:[],location:z,type:mn(ve.messages[0].meta[1][0].data)}})}}),f.sort(function(F,I){return F-I});var m=f.filter(function(F){return F>1}).map(function(F){return[F,ha(F)]});d.FileIndex.map(function(F,I){return[F,d.FullPaths[I]]}).forEach(function(F){var I=F[0];if(F[1],!!I.name.match(/\.iwa/)){var z=io(oo(I.content));z.forEach(function(te){te.messages.forEach(function(se){m.forEach(function(pe){te.messages.some(function(ve){return mn(ve.meta[1][0].data)!=11006&&cB(ve.data,pe[1])})&&c[pe[0]].deps.push(te.id)})})})}});for(var v=hr.find(d,c[1].location),x=io(oo(v.content)),g,b=0;b<x.length;++b){var _=x[b];_.id==1&&(g=_)}var w=Os(na(g.messages[0].data)[1][0].data);for(v=hr.find(d,c[w].location),x=io(oo(v.content)),b=0;b<x.length;++b)_=x[b],_.id==w&&(g=_);for(w=Os(na(g.messages[0].data)[2][0].data),v=hr.find(d,c[w].location),x=io(oo(v.content)),b=0;b<x.length;++b)_=x[b],_.id==w&&(g=_);for(w=Os(na(g.messages[0].data)[2][0].data),v=hr.find(d,c[w].location),x=io(oo(v.content)),b=0;b<x.length;++b)_=x[b],_.id==w&&(g=_);var A=na(g.messages[0].data);{A[6][0].data=ha(a.e.r+1),A[7][0].data=ha(a.e.c+1);var C=Os(A[46][0].data),E=hr.find(d,c[C].location),R=io(oo(E.content));{for(var Y=0;Y<R.length&&R[Y].id!=C;++Y);if(R[Y].id!=C)throw"Bad ColumnRowUIDMapArchive";var W=na(R[Y].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var B=0;B<=a.e.c;++B){var q=[];q[1]=q[2]=[{type:0,data:ha(B+420690)}],W[1].push({type:2,data:xs(q)}),W[2].push({type:0,data:ha(B)}),W[3].push({type:0,data:ha(B)})}W[4]=[],W[5]=[],W[6]=[];for(var L=0;L<=a.e.r;++L)q=[],q[1]=q[2]=[{type:0,data:ha(L+726270)}],W[4].push({type:2,data:xs(q)}),W[5].push({type:0,data:ha(L)}),W[6].push({type:0,data:ha(L)});R[Y].messages[0].data=xs(W)}E.content=Ld(Fd(R)),E.size=E.content.length,delete A[46];var J=na(A[4][0].data);{J[7][0].data=ha(a.e.r+1);var D=na(J[1][0].data),T=Os(D[2][0].data);E=hr.find(d,c[T].location),R=io(oo(E.content));{if(R[0].id!=T)throw"Bad HeaderStorageBucket";var M=na(R[0].messages[0].data);for(L=0;L<s.length;++L){var V=na(M[2][0].data);V[1][0].data=ha(L),V[4][0].data=ha(s[L].length),M[2][L]={type:M[2][0].type,data:xs(V)}}R[0].messages[0].data=xs(M)}E.content=Ld(Fd(R)),E.size=E.content.length;var ie=Os(J[2][0].data);E=hr.find(d,c[ie].location),R=io(oo(E.content));{if(R[0].id!=ie)throw"Bad HeaderStorageBucket";for(M=na(R[0].messages[0].data),B=0;B<=a.e.c;++B)V=na(M[2][0].data),V[1][0].data=ha(B),V[4][0].data=ha(a.e.r+1),M[2][B]={type:M[2][0].type,data:xs(V)};R[0].messages[0].data=xs(M)}E.content=Ld(Fd(R)),E.size=E.content.length;var X=Os(J[4][0].data);(function(){for(var F=hr.find(d,c[X].location),I=io(oo(F.content)),z,te=0;te<I.length;++te){var se=I[te];se.id==X&&(z=se)}var pe=na(z.messages[0].data);{pe[3]=[];var ve=[];l.forEach(function(fe,st){ve[1]=[{type:0,data:ha(st)}],ve[2]=[{type:0,data:ha(1)}],ve[3]=[{type:2,data:lB(fe)}],pe[3].push({type:2,data:xs(ve)})})}z.messages[0].data=xs(pe);var _e=Fd(I),Pe=Ld(_e);F.content=Pe,F.size=F.content.length})();var Z=na(J[3][0].data);{var K=Z[1][0];delete Z[2];var re=na(K.data);{var de=Os(re[2][0].data);(function(){for(var F=hr.find(d,c[de].location),I=io(oo(F.content)),z,te=0;te<I.length;++te){var se=I[te];se.id==de&&(z=se)}var pe=na(z.messages[0].data);{delete pe[6],delete Z[7];var ve=new Uint8Array(pe[5][0].data);pe[5]=[];for(var _e=0,Pe=0;Pe<=a.e.r;++Pe){var fe=na(ve);_e+=wB(fe,s[Pe],l),fe[1][0].data=ha(Pe),pe[5].push({data:xs(fe),type:2})}pe[1]=[{type:0,data:ha(a.e.c+1)}],pe[2]=[{type:0,data:ha(a.e.r+1)}],pe[3]=[{type:0,data:ha(_e)}],pe[4]=[{type:0,data:ha(a.e.r+1)}]}z.messages[0].data=xs(pe);var st=Fd(I),mt=Ld(st);F.content=mt,F.size=F.content.length})()}K.data=xs(re)}J[3][0].data=xs(Z)}A[4][0].data=xs(J)}g.messages[0].data=xs(A);var U=Fd(x),k=Ld(U);return v.content=k,v.size=v.content.length,d}function sk(t){return function(r){for(var a=0;a!=t.length;++a){var n=t[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function M2(t){sk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function I2(t){sk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function NB(t){return Ir.WS.indexOf(t)>-1?"sheet":t==Ir.CS?"chart":t==Ir.DS?"dialog":t==Ir.MS?"macro":t&&t.length?t:"sheet"}function kB(t,e){if(!t)return 0;try{t=e.map(function(a){return a.id||(a.id=a.strRelID),[a.name,t["!id"][a.id].Target,NB(t["!id"][a.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function jB(t,e,r,a,n,s,l,c,f,d,m,v){try{s[a]=p0(Mi(t,r,!0),e);var x=Fn(t,e),g;switch(c){case"sheet":g=YM(x,e,n,f,s[a],d,m,v);break;case"chart":if(g=XM(x,e,n,f,s[a],d,m,v),!g||!g["!drawel"])break;var b=l0(g["!drawel"].Target,e),_=L0(b),w=LF(Mi(t,b,!0),p0(Mi(t,_,!0),b)),A=l0(w,b),C=L0(A);g=wM(Mi(t,A,!0),A,f,p0(Mi(t,C,!0),A),d,g);break;case"macro":g=KM(x,e,n,f,s[a],d,m,v);break;case"dialog":g=JM(x,e,n,f,s[a],d,m,v);break;default:throw new Error("Unrecognized sheet type "+c)}l[a]=g;var E=[];s&&s[a]&&pn(s[a]).forEach(function(R){var Y="";if(s[a][R].Type==Ir.CMNT){Y=l0(s[a][R].Target,e);var W=tI(Fn(t,Y,!0),Y,f);if(!W||!W.length)return;Zw(g,W,!1)}s[a][R].Type==Ir.TCMNT&&(Y=l0(s[a][R].Target,e),E=E.concat(MF(Fn(t,Y,!0),f)))}),E&&E.length&&Zw(g,E,!0,f.people||[])}catch(R){if(f.WTF)throw R}}function no(t){return t.charAt(0)=="/"?t.slice(1):t}function EB(t,e){if(hh(),e=e||{},M2(e),lo(t,"META-INF/manifest.xml")||lo(t,"objectdata.xml"))return c5(t,e);if(lo(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof pv<"u"){if(t.FileIndex)return pv(t);var r=hr.utils.cfb_new();return yw(t).forEach(function(V){Dr(r,V,I8(t,V))}),pv(r)}throw new Error("Unsupported NUMBERS file")}if(!lo(t,"[Content_Types].xml"))throw lo(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):lo(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=yw(t),n=OO(Mi(t,"[Content_Types].xml")),s=!1,l,c;if(n.workbooks.length===0&&(c="xl/workbook.xml",Fn(t,c,!0)&&n.workbooks.push(c)),n.workbooks.length===0){if(c="xl/workbook.bin",!Fn(t,c,!0))throw new Error("Could not find workbook");n.workbooks.push(c),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var f={},d={};if(!e.bookSheets&&!e.bookProps){if(g0=[],n.sst)try{g0=eI(Fn(t,no(n.sst)),n.sst,e)}catch(V){if(e.WTF)throw V}e.cellStyles&&n.themes.length&&(f=QM(Mi(t,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],e)),n.style&&(d=ZM(Fn(t,no(n.style)),n.style,f,e))}n.links.map(function(V){try{var ie=p0(Mi(t,L0(no(V))),V);return aI(Fn(t,no(V)),ie,V,e)}catch{}});var m=GM(Fn(t,no(n.workbooks[0])),n.workbooks[0],e),v={},x="";n.coreprops.length&&(x=Fn(t,no(n.coreprops[0]),!0),x&&(v=G3(x)),n.extprops.length!==0&&(x=Fn(t,no(n.extprops[0]),!0),x&&IO(x,v,e)));var g={};(!e.bookSheets||e.bookProps)&&n.custprops.length!==0&&(x=Mi(t,no(n.custprops[0]),!0),x&&(g=UO(x,e)));var b={};if((e.bookSheets||e.bookProps)&&(m.Sheets?l=m.Sheets.map(function(ie){return ie.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),e.bookProps&&(b.Props=v,b.Custprops=g),e.bookSheets&&typeof l<"u"&&(b.SheetNames=l),e.bookSheets?b.SheetNames:e.bookProps))return b;l={};var _={};e.bookDeps&&n.calcchain&&(_=rI(Fn(t,no(n.calcchain)),n.calcchain));var w=0,A={},C,E;{var R=m.Sheets;v.Worksheets=R.length,v.SheetNames=[];for(var Y=0;Y!=R.length;++Y)v.SheetNames[Y]=R[Y].name}var W=s?"bin":"xml",B=n.workbooks[0].lastIndexOf("/"),q=(n.workbooks[0].slice(0,B+1)+"_rels/"+n.workbooks[0].slice(B+1)+".rels").replace(/^\//,"");lo(t,q)||(q="xl/_rels/workbook."+W+".rels");var L=p0(Mi(t,q,!0),q.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(e.xlmeta=nI(Fn(t,no(n.metadata[0])),n.metadata[0],e)),(n.people||[]).length>=1&&(e.people=BF(Fn(t,no(n.people[0])),e)),L&&(L=kB(L,m.Sheets));var J=Fn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=v.Worksheets;++w){var D="sheet";if(L&&L[w]?(C="xl/"+L[w][1].replace(/[\/]?xl\//,""),lo(t,C)||(C=L[w][1]),lo(t,C)||(C=q.replace(/_rels\/.*$/,"")+L[w][1]),D=L[w][2]):(C="xl/worksheets/sheet"+(w+1-J)+"."+W,C=C.replace(/sheet0\./,"sheet.")),E=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(v.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var T=!1,M=0;M!=e.sheets.length;++M)typeof e.sheets[M]=="number"&&e.sheets[M]==w&&(T=1),typeof e.sheets[M]=="string"&&e.sheets[M].toLowerCase()==v.SheetNames[w].toLowerCase()&&(T=1);if(!T)continue e}}jB(t,C,E,v.SheetNames[w],w,A,l,D,e,m,f,d)}return b={Directory:n,Workbook:m,Props:v,Custprops:g,Deps:_,Sheets:l,SheetNames:v.SheetNames,Strings:g0,Styles:d,Themes:f,SSF:qa(_r)},e&&e.bookFiles&&(t.files?(b.keys=a,b.files=t.files):(b.keys=[],b.files={},t.FullPaths.forEach(function(V,ie){V=V.replace(/^Root Entry[\/]/,""),b.keys.push(V),b.files[V]=t.FileIndex[ie]}))),e&&e.bookVBA&&(n.vba.length>0?b.vbaraw=Fn(t,no(n.vba[0]),!0):n.defaults&&n.defaults.bin===GF&&(b.vbaraw=Fn(t,"xl/vbaProject.bin",!0))),b}function AB(t,e){var r=e||{},a="Workbook",n=hr.find(t,a);try{if(a="/!DataSpaces/Version",n=hr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(nD(n.content),a="/!DataSpaces/DataSpaceMap",n=hr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=iD(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=hr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=oD(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=hr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);cD(n.content)}catch{}if(a="/EncryptionInfo",n=hr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=uD(n.content);if(a="/EncryptedPackage",n=hr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],n.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function CB(t,e){return e.bookType=="ods"?nk(t,e):e.bookType=="numbers"?SB(t,e):e.bookType=="xlsb"?TB(t,e):OB(t,e)}function TB(t,e){Wd=1024,t&&!t.SSF&&(t.SSF=qa(_r)),t&&t.SSF&&(hh(),g1(t.SSF),e.revssf=x1(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,v0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",a=RN.indexOf(e.bookType)>-1,n=S2();I2(e=e||{});var s=c2(),l="",c=0;if(e.cellXfs=[],wu(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",Dr(s,l,Y3(t.Props,e)),n.coreprops.push(l),ma(e.rels,2,l,Ir.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,Dr(s,l,J3(t.Props)),n.extprops.push(l),ma(e.rels,3,l,Ir.EXT_PROPS),t.Custprops!==t.Props&&pn(t.Custprops||{}).length>0&&(l="docProps/custom.xml",Dr(s,l,Z3(t.Custprops)),n.custprops.push(l),ma(e.rels,4,l,Ir.CUST_PROPS)),c=1;c<=t.SheetNames.length;++c){var m={"!id":{}},v=t.Sheets[t.SheetNames[c-1]],x=(v||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+c+"."+r,Dr(s,l,iI(c-1,l,e,t,m)),n.sheets.push(l),ma(e.wbrels,-1,"worksheets/sheet"+c+"."+r,Ir.WS[0])}if(v){var g=v["!comments"],b=!1,_="";g&&g.length>0&&(_="xl/comments"+c+"."+r,Dr(s,_,cI(g,_)),n.comments.push(_),ma(m,-1,"../comments"+c+"."+r,Ir.CMNT),b=!0),v["!legacy"]&&b&&Dr(s,"xl/drawings/vmlDrawing"+c+".vml",TN(c,v["!comments"])),delete v["!comments"],delete v["!legacy"]}m["!id"].rId1&&Dr(s,L0(l),Kd(m))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,Dr(s,l,lI(e.Strings,l,e)),n.strs.push(l),ma(e.wbrels,-1,"sharedStrings."+r,Ir.SST)),l="xl/workbook."+r,Dr(s,l,sI(t,l)),n.workbooks.push(l),ma(e.rels,1,l,Ir.WB),l="xl/theme/theme1.xml",Dr(s,l,C2(t.Themes,e)),n.themes.push(l),ma(e.wbrels,-1,"theme/theme1.xml",Ir.THEME),l="xl/styles."+r,Dr(s,l,oI(t,l,e)),n.styles.push(l),ma(e.wbrels,-1,"styles."+r,Ir.STY),t.vbaraw&&a&&(l="xl/vbaProject.bin",Dr(s,l,t.vbaraw),n.vba.push(l),ma(e.wbrels,-1,"vbaProject.bin",Ir.VBA)),l="xl/metadata."+r,Dr(s,l,uI(l)),n.metadata.push(l),ma(e.wbrels,-1,"metadata."+r,Ir.XLMETA),Dr(s,"[Content_Types].xml",W3(n,e)),Dr(s,"_rels/.rels",Kd(e.rels)),Dr(s,"xl/_rels/workbook."+r+".rels",Kd(e.wbrels)),delete e.revssf,delete e.ssf,s}function OB(t,e){Wd=1024,t&&!t.SSF&&(t.SSF=qa(_r)),t&&t.SSF&&(hh(),g1(t.SSF),e.revssf=x1(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,v0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",a=RN.indexOf(e.bookType)>-1,n=S2();I2(e=e||{});var s=c2(),l="",c=0;if(e.cellXfs=[],wu(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",Dr(s,l,Y3(t.Props,e)),n.coreprops.push(l),ma(e.rels,2,l,Ir.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,Dr(s,l,J3(t.Props)),n.extprops.push(l),ma(e.rels,3,l,Ir.EXT_PROPS),t.Custprops!==t.Props&&pn(t.Custprops||{}).length>0&&(l="docProps/custom.xml",Dr(s,l,Z3(t.Custprops)),n.custprops.push(l),ma(e.rels,4,l,Ir.CUST_PROPS));var m=["SheetJ5"];for(e.tcid=0,c=1;c<=t.SheetNames.length;++c){var v={"!id":{}},x=t.Sheets[t.SheetNames[c-1]],g=(x||{})["!type"]||"sheet";switch(g){case"chart":default:l="xl/worksheets/sheet"+c+"."+r,Dr(s,l,HN(c-1,e,t,v)),n.sheets.push(l),ma(e.wbrels,-1,"worksheets/sheet"+c+"."+r,Ir.WS[0])}if(x){var b=x["!comments"],_=!1,w="";if(b&&b.length>0){var A=!1;b.forEach(function(C){C[1].forEach(function(E){E.T==!0&&(A=!0)})}),A&&(w="xl/threadedComments/threadedComment"+c+"."+r,Dr(s,w,IF(b,m,e)),n.threadedcomments.push(w),ma(v,-1,"../threadedComments/threadedComment"+c+"."+r,Ir.TCMNT)),w="xl/comments"+c+"."+r,Dr(s,w,ON(b)),n.comments.push(w),ma(v,-1,"../comments"+c+"."+r,Ir.CMNT),_=!0}x["!legacy"]&&_&&Dr(s,"xl/drawings/vmlDrawing"+c+".vml",TN(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}v["!id"].rId1&&Dr(s,L0(l),Kd(v))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,Dr(s,l,xN(e.Strings,e)),n.strs.push(l),ma(e.wbrels,-1,"sharedStrings."+r,Ir.SST)),l="xl/workbook."+r,Dr(s,l,YN(t)),n.workbooks.push(l),ma(e.rels,1,l,Ir.WB),l="xl/theme/theme1.xml",Dr(s,l,C2(t.Themes,e)),n.themes.push(l),ma(e.wbrels,-1,"theme/theme1.xml",Ir.THEME),l="xl/styles."+r,Dr(s,l,jN(t,e)),n.styles.push(l),ma(e.wbrels,-1,"styles."+r,Ir.STY),t.vbaraw&&a&&(l="xl/vbaProject.bin",Dr(s,l,t.vbaraw),n.vba.push(l),ma(e.wbrels,-1,"vbaProject.bin",Ir.VBA)),l="xl/metadata."+r,Dr(s,l,CN()),n.metadata.push(l),ma(e.wbrels,-1,"metadata."+r,Ir.XLMETA),m.length>1&&(l="xl/persons/person.xml",Dr(s,l,UF(m)),n.people.push(l),ma(e.wbrels,-1,"persons/person.xml",Ir.PEOPLE)),Dr(s,"[Content_Types].xml",W3(n,e)),Dr(s,"_rels/.rels",Kd(e.rels)),Dr(s,"xl/_rels/workbook."+r+".rels",Kd(e.wbrels)),delete e.revssf,delete e.ssf,s}function B2(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=qi(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function RB(t,e){return hr.find(t,"EncryptedPackage")?AB(t,e):ZN(t,e)}function DB(t,e){var r,a=t,n=e||{};return n.type||(n.type=Pr&&Buffer.isBuffer(t)?"buffer":"base64"),r=_3(a,n),EB(r,n)}function ik(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Sx(t.slice(r),e);default:break e}return ih.to_workbook(t,e)}function FB(t,e){var r="",a=B2(t,e);switch(e.type){case"base64":r=qi(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=xf(t);break;default:throw new Error("Unrecognized type "+e.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Sa(r)),e.type="binary",ik(r,e)}function LB(t,e){var r=t;return e.type=="base64"&&(r=qi(r)),r=C0.utils.decode(1200,r.slice(2),"str"),e.type="binary",ik(r,e)}function PB(t){return t.match(/[^\x00-\x7F]/)?kl(t):t}function gv(t,e,r,a){return a?(r.type="string",ih.to_workbook(t,r)):ih.to_workbook(e,r)}function jx(t,e){n2();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return jx(new Uint8Array(t),(r=qa(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=t,n=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Zd={},r.dateNF&&(Zd.dateNF=r.dateNF),r.type||(r.type=Pr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Pr?"buffer":"binary",a=T8(t),typeof Uint8Array<"u"&&!Pr&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,a=PB(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return r=qa(r),r.type="array",jx(s2(a),r)}switch((n=B2(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return RB(hr.read(a,r),r);break;case 9:if(n[1]<=8)return ZN(a,r);break;case 60:return Sx(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return qR(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return gN.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?DB(a,r):gv(t,a,r,s);case 239:return n[3]===60?Sx(a,r):gv(t,a,r,s);case 255:if(n[1]===254)return LB(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return mf.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return mf.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return wx.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return SN.to_workbook(a,r);break;case 10:case 13:case 32:return FB(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return UR.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?wx.to_workbook(a,r):gv(t,a,r,s)}function ok(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return X0(e.file,hr.write(t,{type:Pr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return hr.write(t,e)}function MB(t,e){var r=qa(e||{}),a=CB(t,r);return IB(a,r)}function IB(t,e){var r={},a=Pr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=a;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+e.type)}var n=t.FullPaths?hr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(e.type=="binary"||e.type=="base64")return n;n=new Uint8Array(p1(n))}return e.password&&typeof encrypt_agile<"u"?ok(encrypt_agile(n,e.password),e):e.type==="file"?X0(e.file,n):e.type=="string"?Sa(n):n}function BB(t,e){var r=e||{},a=PI(t,r);return ok(a,r)}function bl(t,e,r){r||(r="");var a=r+t;switch(e.type){case"base64":return T0(kl(a));case"binary":return kl(a);case"string":return t;case"file":return X0(e.file,a,"utf8");case"buffer":return Pr?vc(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):bl(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function UB(t,e){switch(e.type){case"base64":return T0(t);case"binary":return t;case"string":return t;case"file":return X0(e.file,t,"binary");case"buffer":return Pr?vc(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function xp(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",a=0;a<t.length;++a)r+=String.fromCharCode(t[a]);return e.type=="base64"?T0(r):e.type=="string"?Sa(r):r;case"file":return X0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function lk(t,e){n2(),RM(t);var r=qa(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=lk(t,r);return r.type="array",p1(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=t.SheetNames.indexOf(r.sheet),!t.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return bl(CI(t,r),r);case"slk":case"sylk":return bl(pN.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"htm":case"html":return bl(ek(t.Sheets[t.SheetNames[n]],r),r);case"txt":return UB(ck(t.Sheets[t.SheetNames[n]],r),r);case"csv":return bl(U2(t.Sheets[t.SheetNames[n]],r),r,"\uFEFF");case"dif":return bl(gN.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"dbf":return xp(wx.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"prn":return bl(ih.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"rtf":return bl(SN.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"eth":return bl(vN.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"fods":return bl(nk(t,r),r);case"wk1":return xp(mf.sheet_to_wk1(t.Sheets[t.SheetNames[n]],r),r);case"wk3":return xp(mf.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),xp(QN(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),BB(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return MB(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function qB(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function zB(t,e,r){var a={};return a.type="file",a.file=e,qB(a),lk(t,a)}function HB(t,e,r,a,n,s,l,c){var f=jn(r),d=c.defval,m=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),v=!0,x=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!l||t[r])for(var g=e.s.c;g<=e.e.c;++g){var b=l?t[r][g]:t[a[g]+f];if(b===void 0||b.t===void 0){if(d===void 0)continue;s[g]!=null&&(x[s[g]]=d);continue}var _=b.v;switch(b.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(s[g]!=null){if(_==null)if(b.t=="e"&&_===null)x[s[g]]=null;else if(d!==void 0)x[s[g]]=d;else if(m&&_===null)x[s[g]]=null;else continue;else x[s[g]]=m&&(b.t!=="n"||b.t==="n"&&c.rawNumbers!==!1)?_:mc(b,_,c);_!=null&&(v=!1)}}return{row:x,isempty:v}}function a1(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,s=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},m=d.range!=null?d.range:t["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof m){case"string":f=ea(m);break;case"number":f=ea(t["!ref"]),f.s.r=m;break;default:f=m}a>0&&(n=0);var v=jn(f.s.r),x=[],g=[],b=0,_=0,w=Array.isArray(t),A=f.s.r,C=0,E={};w&&!t[A]&&(t[A]=[]);var R=d.skipHidden&&t["!cols"]||[],Y=d.skipHidden&&t["!rows"]||[];for(C=f.s.c;C<=f.e.c;++C)if(!(R[C]||{}).hidden)switch(x[C]=en(C),r=w?t[A][C]:t[x[C]+v],a){case 1:s[C]=C-f.s.c;break;case 2:s[C]=x[C];break;case 3:s[C]=d.header[C-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=l=mc(r,null,d),_=E[l]||0,!_)E[l]=1;else{do c=l+"_"+_++;while(E[c]);E[l]=_,E[c]=1}s[C]=c}for(A=f.s.r+n;A<=f.e.r;++A)if(!(Y[A]||{}).hidden){var W=HB(t,f,A,x,a,s,w,d);(W.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(g[b++]=W.row)}return g.length=b,g}var m5=/"/g;function $B(t,e,r,a,n,s,l,c){for(var f=!0,d=[],m="",v=jn(r),x=e.s.c;x<=e.e.c;++x)if(a[x]){var g=c.dense?(t[r]||[])[x]:t[a[x]+v];if(g==null)m="";else if(g.v!=null){f=!1,m=""+(c.rawNumbers&&g.t=="n"?g.v:mc(g,null,c));for(var b=0,_=0;b!==m.length;++b)if((_=m.charCodeAt(b))===n||_===s||_===34||c.forceQuotes){m='"'+m.replace(m5,'""')+'"';break}m=="ID"&&(m='"ID"')}else g.f!=null&&!g.F?(f=!1,m="="+g.f,m.indexOf(",")>=0&&(m='"'+m.replace(m5,'""')+'"')):m="";d.push(m)}return c.blankrows===!1&&f?null:d.join(l)}function U2(t,e){var r=[],a=e??{};if(t==null||t["!ref"]==null)return"";var n=ea(t["!ref"]),s=a.FS!==void 0?a.FS:",",l=s.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,f=c.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),m="",v=[];a.dense=Array.isArray(t);for(var x=a.skipHidden&&t["!cols"]||[],g=a.skipHidden&&t["!rows"]||[],b=n.s.c;b<=n.e.c;++b)(x[b]||{}).hidden||(v[b]=en(b));for(var _=0,w=n.s.r;w<=n.e.r;++w)(g[w]||{}).hidden||(m=$B(t,n,w,v,l,f,s,a),m!=null&&(a.strip&&(m=m.replace(d,"")),(m||a.blankrows!==!1)&&r.push((_++?c:"")+m)));return delete a.dense,r.join("")}function ck(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=U2(t,e);return r}function WB(t){var e="",r,a="";if(t==null||t["!ref"]==null)return[];var n=ea(t["!ref"]),s="",l=[],c,f=[],d=Array.isArray(t);for(c=n.s.c;c<=n.e.c;++c)l[c]=en(c);for(var m=n.s.r;m<=n.e.r;++m)for(s=jn(m),c=n.s.c;c<=n.e.c;++c)if(e=l[c]+s,r=d?(t[m]||[])[c]:t[e],a="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;a=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}f[f.length]=e+"="+a}return f}function uk(t,e,r){var a=r||{},n=+!a.skipHeader,s=t||{},l=0,c=0;if(s&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var f=typeof a.origin=="string"?tn(a.origin):a.origin;l=f.r,c=f.c}var d,m={s:{c:0,r:0},e:{c,r:l+e.length-1+n}};if(s["!ref"]){var v=ea(s["!ref"]);m.e.c=Math.max(m.e.c,v.e.c),m.e.r=Math.max(m.e.r,v.e.r),l==-1&&(l=v.e.r+1,m.e.r=l+e.length-1+n)}else l==-1&&(l=0,m.e.r=e.length-1+n);var x=a.header||[],g=0;e.forEach(function(_,w){pn(_).forEach(function(A){(g=x.indexOf(A))==-1&&(x[g=x.length]=A);var C=_[A],E="z",R="",Y=wr({c:c+g,r:l+w+n});d=z0(s,Y),C&&typeof C=="object"&&!(C instanceof Date)?s[Y]=C:(typeof C=="number"?E="n":typeof C=="boolean"?E="b":typeof C=="string"?E="s":C instanceof Date?(E="d",a.cellDates||(E="n",C=Kn(C)),R=a.dateNF||_r[14]):C===null&&a.nullError&&(E="e",C=0),d?(d.t=E,d.v=C,delete d.w,delete d.R,R&&(d.z=R)):s[Y]=d={t:E,v:C},R&&(d.z=R))})}),m.e.c=Math.max(m.e.c,c+x.length-1);var b=jn(l);if(n)for(g=0;g<x.length;++g)s[en(g+c)+b]={t:"s",v:x[g]};return s["!ref"]=Or(m),s}function VB(t,e){return uk(null,t,e)}function z0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var a=tn(e);return t[a.r]||(t[a.r]=[]),t[a.r][a.c]||(t[a.r][a.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?z0(t,wr(e)):z0(t,wr({r:e,c:r||0}))}function GB(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function q2(){return{SheetNames:[],Sheets:{}}}function z2(t,e,r,a){var n=1;if(!r)for(;n<=65535&&t.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var l=s&&s[1]||r;for(++n;n<=65535&&t.SheetNames.indexOf(r=l+n)!=-1;++n);}if(GN(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function YB(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var a=GB(t,e);switch(t.Workbook.Sheets[a]||(t.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[a].Hidden=r}function XB(t,e){return t.z=e,t}function fk(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function KB(t,e,r){return fk(t,"#"+e,r)}function JB(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function ZB(t,e,r,a){for(var n=typeof e!="string"?e:ea(e),s=typeof e=="string"?e:Or(e),l=n.s.r;l<=n.e.r;++l)for(var c=n.s.c;c<=n.e.c;++c){var f=z0(t,l,c);f.t="n",f.F=s,delete f.v,l==n.s.r&&c==n.s.c&&(f.f=r,a&&(f.D=!0))}return t}var nu={encode_col:en,encode_row:jn,encode_cell:wr,encode_range:Or,decode_col:v2,decode_row:g2,split_cell:lO,decode_cell:tn,decode_range:hi,format_cell:mc,sheet_add_aoa:I3,sheet_add_json:uk,sheet_add_dom:tk,aoa_to_sheet:mh,json_to_sheet:VB,table_to_sheet:rk,table_to_book:nB,sheet_to_csv:U2,sheet_to_txt:ck,sheet_to_json:a1,sheet_to_html:ek,sheet_to_formulae:WB,sheet_to_row_object_array:a1,sheet_get_cell:z0,book_new:q2,book_append_sheet:z2,book_set_sheet_visibility:YB,cell_set_number_format:XB,cell_set_hyperlink:fk,cell_set_internal_link:KB,cell_add_comment:JB,sheet_set_array_formula:ZB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const QB="modulepreload",eU=function(t){return"/"+t},p5={},vv=function(e,r,a){let n=Promise.resolve();if(r&&r.length>0){let f=function(d){return Promise.all(d.map(m=>Promise.resolve(m).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");n=f(r.map(d=>{if(d=eU(d),d in p5)return;p5[d]=!0;const m=d.endsWith(".css"),v=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${v}`))return;const x=document.createElement("link");if(x.rel=m?"stylesheet":QB,m||(x.as="script"),x.crossOrigin="",x.href=d,c&&x.setAttribute("nonce",c),document.head.appendChild(x),m)return new Promise((g,b)=>{x.addEventListener("load",g),x.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return n.then(l=>{for(const c of l||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})};function pa(t){"@babel/helpers - typeof";return pa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pa(t)}var Ko=Uint8Array,Bi=Uint16Array,H2=Int32Array,$2=new Ko([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),W2=new Ko([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),g5=new Ko([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dk=function(t,e){for(var r=new Bi(31),a=0;a<31;++a)r[a]=e+=1<<t[a-1];for(var n=new H2(r[30]),a=1;a<30;++a)for(var s=r[a];s<r[a+1];++s)n[s]=s-r[a]<<5|a;return{b:r,r:n}},hk=dk($2,2),tU=hk.b,Ex=hk.r;tU[28]=258,Ex[258]=28;var rU=dk(W2,0),v5=rU.r,Ax=new Bi(32768);for(var Ba=0;Ba<32768;++Ba){var ru=(Ba&43690)>>1|(Ba&21845)<<1;ru=(ru&52428)>>2|(ru&13107)<<2,ru=(ru&61680)>>4|(ru&3855)<<4,Ax[Ba]=((ru&65280)>>8|(ru&255)<<8)>>1}var _0=(function(t,e,r){for(var a=t.length,n=0,s=new Bi(e);n<a;++n)t[n]&&++s[t[n]-1];var l=new Bi(e);for(n=1;n<e;++n)l[n]=l[n-1]+s[n-1]<<1;var c;if(r){c=new Bi(1<<e);var f=15-e;for(n=0;n<a;++n)if(t[n])for(var d=n<<4|t[n],m=e-t[n],v=l[t[n]-1]++<<m,x=v|(1<<m)-1;v<=x;++v)c[Ax[v]>>f]=d}else for(c=new Bi(a),n=0;n<a;++n)t[n]&&(c[n]=Ax[l[t[n]-1]++]>>15-t[n]);return c}),Sf=new Ko(288);for(var Ba=0;Ba<144;++Ba)Sf[Ba]=8;for(var Ba=144;Ba<256;++Ba)Sf[Ba]=9;for(var Ba=256;Ba<280;++Ba)Sf[Ba]=7;for(var Ba=280;Ba<288;++Ba)Sf[Ba]=8;var n1=new Ko(32);for(var Ba=0;Ba<32;++Ba)n1[Ba]=5;var aU=_0(Sf,9,0),nU=_0(n1,5,0),mk=function(t){return(t+7)/8|0},sU=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Ko(t.subarray(e,r))},ac=function(t,e,r){r<<=e&7;var a=e/8|0;t[a]|=r,t[a+1]|=r>>8},t0=function(t,e,r){r<<=e&7;var a=e/8|0;t[a]|=r,t[a+1]|=r>>8,t[a+2]|=r>>16},xv=function(t,e){for(var r=[],a=0;a<t.length;++a)t[a]&&r.push({s:a,f:t[a]});var n=r.length,s=r.slice();if(!n)return{t:gk,l:0};if(n==1){var l=new Ko(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort(function(Y,W){return Y.f-W.f}),r.push({s:-1,f:25001});var c=r[0],f=r[1],d=0,m=1,v=2;for(r[0]={s:-1,f:c.f+f.f,l:c,r:f};m!=n-1;)c=r[r[d].f<r[v].f?d++:v++],f=r[d!=m&&r[d].f<r[v].f?d++:v++],r[m++]={s:-1,f:c.f+f.f,l:c,r:f};for(var x=s[0].s,a=1;a<n;++a)s[a].s>x&&(x=s[a].s);var g=new Bi(x+1),b=Cx(r[m-1],g,0);if(b>e){var a=0,_=0,w=b-e,A=1<<w;for(s.sort(function(W,B){return g[B.s]-g[W.s]||W.f-B.f});a<n;++a){var C=s[a].s;if(g[C]>e)_+=A-(1<<b-g[C]),g[C]=e;else break}for(_>>=w;_>0;){var E=s[a].s;g[E]<e?_-=1<<e-g[E]++-1:++a}for(;a>=0&&_;--a){var R=s[a].s;g[R]==e&&(--g[R],++_)}b=e}return{t:new Ko(g),l:b}},Cx=function(t,e,r){return t.s==-1?Math.max(Cx(t.l,e,r+1),Cx(t.r,e,r+1)):e[t.s]=r},x5=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Bi(++e),a=0,n=t[0],s=1,l=function(f){r[a++]=f},c=1;c<=e;++c)if(t[c]==n&&c!=e)++s;else{if(!n&&s>2){for(;s>138;s-=138)l(32754);s>2&&(l(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(l(n),--s;s>6;s-=6)l(8304);s>2&&(l(s-3<<5|8208),s=0)}for(;s--;)l(n);s=1,n=t[c]}return{c:r.subarray(0,a),n:e}},r0=function(t,e){for(var r=0,a=0;a<e.length;++a)r+=t[a]*e[a];return r},pk=function(t,e,r){var a=r.length,n=mk(e+2);t[n]=a&255,t[n+1]=a>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var s=0;s<a;++s)t[n+s+4]=r[s];return(n+4+a)*8},y5=function(t,e,r,a,n,s,l,c,f,d,m){ac(e,m++,r),++n[256];for(var v=xv(n,15),x=v.t,g=v.l,b=xv(s,15),_=b.t,w=b.l,A=x5(x),C=A.c,E=A.n,R=x5(_),Y=R.c,W=R.n,B=new Bi(19),q=0;q<C.length;++q)++B[C[q]&31];for(var q=0;q<Y.length;++q)++B[Y[q]&31];for(var L=xv(B,7),J=L.t,D=L.l,T=19;T>4&&!J[g5[T-1]];--T);var M=d+5<<3,V=r0(n,Sf)+r0(s,n1)+l,ie=r0(n,x)+r0(s,_)+l+14+3*T+r0(B,J)+2*B[16]+3*B[17]+7*B[18];if(f>=0&&M<=V&&M<=ie)return pk(e,m,t.subarray(f,f+d));var X,Z,K,re;if(ac(e,m,1+(ie<V)),m+=2,ie<V){X=_0(x,g,0),Z=x,K=_0(_,w,0),re=_;var de=_0(J,D,0);ac(e,m,E-257),ac(e,m+5,W-1),ac(e,m+10,T-4),m+=14;for(var q=0;q<T;++q)ac(e,m+3*q,J[g5[q]]);m+=3*T;for(var U=[C,Y],k=0;k<2;++k)for(var F=U[k],q=0;q<F.length;++q){var I=F[q]&31;ac(e,m,de[I]),m+=J[I],I>15&&(ac(e,m,F[q]>>5&127),m+=F[q]>>12)}}else X=aU,Z=Sf,K=nU,re=n1;for(var q=0;q<c;++q){var z=a[q];if(z>255){var I=z>>18&31;t0(e,m,X[I+257]),m+=Z[I+257],I>7&&(ac(e,m,z>>23&31),m+=$2[I]);var te=z&31;t0(e,m,K[te]),m+=re[te],te>3&&(t0(e,m,z>>5&8191),m+=W2[te])}else t0(e,m,X[z]),m+=Z[z]}return t0(e,m,X[256]),m+Z[256]},iU=new H2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),gk=new Ko(0),oU=function(t,e,r,a,n,s){var l=s.z||t.length,c=new Ko(a+l+5*(1+Math.ceil(l/7e3))+n),f=c.subarray(a,c.length-n),d=s.l,m=(s.r||0)&7;if(e){m&&(f[0]=s.r>>3);for(var v=iU[e-1],x=v>>13,g=v&8191,b=(1<<r)-1,_=s.p||new Bi(32768),w=s.h||new Bi(b+1),A=Math.ceil(r/3),C=2*A,E=function(mt){return(t[mt]^t[mt+1]<<A^t[mt+2]<<C)&b},R=new H2(25e3),Y=new Bi(288),W=new Bi(32),B=0,q=0,L=s.i||0,J=0,D=s.w||0,T=0;L+2<l;++L){var M=E(L),V=L&32767,ie=w[M];if(_[V]=ie,w[M]=V,D<=L){var X=l-L;if((B>7e3||J>24576)&&(X>423||!d)){m=y5(t,f,0,R,Y,W,q,J,T,L-T,m),J=B=q=0,T=L;for(var Z=0;Z<286;++Z)Y[Z]=0;for(var Z=0;Z<30;++Z)W[Z]=0}var K=2,re=0,de=g,U=V-ie&32767;if(X>2&&M==E(L-U))for(var k=Math.min(x,X)-1,F=Math.min(32767,L),I=Math.min(258,X);U<=F&&--de&&V!=ie;){if(t[L+K]==t[L+K-U]){for(var z=0;z<I&&t[L+z]==t[L+z-U];++z);if(z>K){if(K=z,re=U,z>k)break;for(var te=Math.min(U,z-2),se=0,Z=0;Z<te;++Z){var pe=L-U+Z&32767,ve=_[pe],_e=pe-ve&32767;_e>se&&(se=_e,ie=pe)}}}V=ie,ie=_[V],U+=V-ie&32767}if(re){R[J++]=268435456|Ex[K]<<18|v5[re];var Pe=Ex[K]&31,fe=v5[re]&31;q+=$2[Pe]+W2[fe],++Y[257+Pe],++W[fe],D=L+K,++B}else R[J++]=t[L],++Y[t[L]]}}for(L=Math.max(L,D);L<l;++L)R[J++]=t[L],++Y[t[L]];m=y5(t,f,d,R,Y,W,q,J,T,L-T,m),d||(s.r=m&7|f[m/8|0]<<3,m-=7,s.h=w,s.p=_,s.i=L,s.w=D)}else{for(var L=s.w||0;L<l+d;L+=65535){var st=L+65535;st>=l&&(f[m/8|0]=d,st=l),m=pk(f,m+1,t.subarray(L,st))}s.i=l}return sU(c,0,a+mk(m)+n)},vk=function(){var t=1,e=0;return{p:function(r){for(var a=t,n=e,s=r.length|0,l=0;l!=s;){for(var c=Math.min(l+2655,s);l<c;++l)n+=a+=r[l];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}t=a,e=n},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},lU=function(t,e,r,a,n){if(!n&&(n={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),l=new Ko(s.length+t.length);l.set(s),l.set(t,s.length),t=l,n.w=s.length}return oU(t,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,a,n)},xk=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},cU=function(t,e){var r=e.level,a=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=a<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var n=vk();n.p(e.dictionary),xk(t,2,n.d())}};function Tx(t,e){e||(e={});var r=vk();r.p(t);var a=lU(t,e,e.dictionary?6:2,4);return cU(a,e),xk(a,a.length-4,r.d()),a}var uU=typeof TextDecoder<"u"&&new TextDecoder,fU=0;try{uU.decode(gk,{stream:!0}),fU=1}catch{}function dU(t){if(Array.isArray(t))return t}function hU(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var a,n,s,l,c=[],f=!0,d=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(f=(a=s.call(r)).done)&&(c.push(a.value),c.length!==e);f=!0);}catch(m){d=!0,n=m}finally{try{if(!f&&r.return!=null&&(l=r.return(),Object(l)!==l))return}finally{if(d)throw n}}return c}}function _5(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}function mU(t,e){if(t){if(typeof t=="string")return _5(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_5(t,e):void 0}}function pU(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b5(t,e){return dU(t)||hU(t,e)||mU(t,e)||pU()}function w5(t,e="utf8"){return new TextDecoder(e).decode(t)}const gU=new TextEncoder;function vU(t){return gU.encode(t)}const xU=1024*8,yU=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),yv={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class V2{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=xU,r={}){let a=!1;typeof e=="number"?e=new ArrayBuffer(e):(a=!0,this.lastWrittenByte=e.byteLength);const n=r.offset?r.offset>>>0:0,s=e.byteLength-n;let l=n;(ArrayBuffer.isView(e)||e instanceof V2)&&(e.byteLength!==e.buffer.byteLength&&(l=e.byteOffset+n),e=e.buffer),a?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=l,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,l,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const a=(this.offset+e)*2,n=new Uint8Array(a);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const a=yv[r].BYTES_PER_ELEMENT*e,n=this.byteOffset+this.offset,s=this.buffer.slice(n,n+a);if(this.littleEndian===yU&&r!=="uint8"&&r!=="int8"){const c=new Uint8Array(this.buffer.slice(n,n+a));c.reverse();const f=new yv[r](c.buffer);return this.offset+=a,f.reverse(),f}const l=new yv[r](s);return this.offset+=a,l}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let a=0;a<e;a++)r+=this.readChar();return r}readUtf8(e=1){return w5(this.readBytes(e))}decodeText(e=1,r="utf8"){return w5(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(vU(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function gh(t){let e=t.length;for(;--e>=0;)t[e]=0}const _U=3,bU=258,yk=29,wU=256,SU=wU+1+yk,_k=30,NU=512,kU=new Array((SU+2)*2);gh(kU);const jU=new Array(_k*2);gh(jU);const EU=new Array(NU);gh(EU);const AU=new Array(bU-_U+1);gh(AU);const CU=new Array(yk);gh(CU);const TU=new Array(_k);gh(TU);const OU=(t,e,r,a)=>{let n=t&65535|0,s=t>>>16&65535|0,l=0;for(;r!==0;){l=r>2e3?2e3:r,r-=l;do n=n+e[a++]|0,s=s+n|0;while(--l);n%=65521,s%=65521}return n|s<<16|0};var Ox=OU;const RU=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var a=0;a<8;a++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},DU=new Uint32Array(RU()),FU=(t,e,r,a)=>{const n=DU,s=a+r;t^=-1;for(let l=a;l<s;l++)t=t>>>8^n[(t^e[l])&255];return t^-1};var yl=FU,Rx={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},bk={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const LU=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var PU=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const a in r)LU(r,a)&&(t[a]=r[a])}}return t},MU=t=>{let e=0;for(let a=0,n=t.length;a<n;a++)e+=t[a].length;const r=new Uint8Array(e);for(let a=0,n=0,s=t.length;a<s;a++){let l=t[a];r.set(l,n),n+=l.length}return r},wk={assign:PU,flattenChunks:MU};let Sk=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Sk=!1}const H0=new Uint8Array(256);for(let t=0;t<256;t++)H0[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;H0[254]=H0[254]=1;var IU=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,a,n,s,l=t.length,c=0;for(n=0;n<l;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<l&&(a=t.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),c+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(c),s=0,n=0;s<c;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<l&&(a=t.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};const BU=(t,e)=>{if(e<65534&&t.subarray&&Sk)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let a=0;a<e;a++)r+=String.fromCharCode(t[a]);return r};var UU=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let a,n;const s=new Array(r*2);for(n=0,a=0;a<r;){let l=t[a++];if(l<128){s[n++]=l;continue}let c=H0[l];if(c>4){s[n++]=65533,a+=c-1;continue}for(l&=c===2?31:c===3?15:7;c>1&&a<r;)l=l<<6|t[a++]&63,c--;if(c>1){s[n++]=65533;continue}l<65536?s[n++]=l:(l-=65536,s[n++]=55296|l>>10&1023,s[n++]=56320|l&1023)}return BU(s,n)},qU=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+H0[t[r]]>e?r:e},Dx={string2buf:IU,buf2string:UU,utf8border:qU};function zU(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var HU=zU;const yp=16209,$U=16191;var WU=function(e,r){let a,n,s,l,c,f,d,m,v,x,g,b,_,w,A,C,E,R,Y,W,B,q,L,J;const D=e.state;a=e.next_in,L=e.input,n=a+(e.avail_in-5),s=e.next_out,J=e.output,l=s-(r-e.avail_out),c=s+(e.avail_out-257),f=D.dmax,d=D.wsize,m=D.whave,v=D.wnext,x=D.window,g=D.hold,b=D.bits,_=D.lencode,w=D.distcode,A=(1<<D.lenbits)-1,C=(1<<D.distbits)-1;e:do{b<15&&(g+=L[a++]<<b,b+=8,g+=L[a++]<<b,b+=8),E=_[g&A];t:for(;;){if(R=E>>>24,g>>>=R,b-=R,R=E>>>16&255,R===0)J[s++]=E&65535;else if(R&16){Y=E&65535,R&=15,R&&(b<R&&(g+=L[a++]<<b,b+=8),Y+=g&(1<<R)-1,g>>>=R,b-=R),b<15&&(g+=L[a++]<<b,b+=8,g+=L[a++]<<b,b+=8),E=w[g&C];r:for(;;){if(R=E>>>24,g>>>=R,b-=R,R=E>>>16&255,R&16){if(W=E&65535,R&=15,b<R&&(g+=L[a++]<<b,b+=8,b<R&&(g+=L[a++]<<b,b+=8)),W+=g&(1<<R)-1,W>f){e.msg="invalid distance too far back",D.mode=yp;break e}if(g>>>=R,b-=R,R=s-l,W>R){if(R=W-R,R>m&&D.sane){e.msg="invalid distance too far back",D.mode=yp;break e}if(B=0,q=x,v===0){if(B+=d-R,R<Y){Y-=R;do J[s++]=x[B++];while(--R);B=s-W,q=J}}else if(v<R){if(B+=d+v-R,R-=v,R<Y){Y-=R;do J[s++]=x[B++];while(--R);if(B=0,v<Y){R=v,Y-=R;do J[s++]=x[B++];while(--R);B=s-W,q=J}}}else if(B+=v-R,R<Y){Y-=R;do J[s++]=x[B++];while(--R);B=s-W,q=J}for(;Y>2;)J[s++]=q[B++],J[s++]=q[B++],J[s++]=q[B++],Y-=3;Y&&(J[s++]=q[B++],Y>1&&(J[s++]=q[B++]))}else{B=s-W;do J[s++]=J[B++],J[s++]=J[B++],J[s++]=J[B++],Y-=3;while(Y>2);Y&&(J[s++]=J[B++],Y>1&&(J[s++]=J[B++]))}}else if((R&64)===0){E=w[(E&65535)+(g&(1<<R)-1)];continue r}else{e.msg="invalid distance code",D.mode=yp;break e}break}}else if((R&64)===0){E=_[(E&65535)+(g&(1<<R)-1)];continue t}else if(R&32){D.mode=$U;break e}else{e.msg="invalid literal/length code",D.mode=yp;break e}break}}while(a<n&&s<c);Y=b>>3,a-=Y,b-=Y<<3,g&=(1<<b)-1,e.next_in=a,e.next_out=s,e.avail_in=a<n?5+(n-a):5-(a-n),e.avail_out=s<c?257+(c-s):257-(s-c),D.hold=g,D.bits=b};const Pd=15,S5=852,N5=592,k5=0,_v=1,j5=2,VU=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),GU=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),YU=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),XU=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),KU=(t,e,r,a,n,s,l,c)=>{const f=c.bits;let d=0,m=0,v=0,x=0,g=0,b=0,_=0,w=0,A=0,C=0,E,R,Y,W,B,q=null,L;const J=new Uint16Array(Pd+1),D=new Uint16Array(Pd+1);let T=null,M,V,ie;for(d=0;d<=Pd;d++)J[d]=0;for(m=0;m<a;m++)J[e[r+m]]++;for(g=f,x=Pd;x>=1&&J[x]===0;x--);if(g>x&&(g=x),x===0)return n[s++]=1<<24|64<<16|0,n[s++]=1<<24|64<<16|0,c.bits=1,0;for(v=1;v<x&&J[v]===0;v++);for(g<v&&(g=v),w=1,d=1;d<=Pd;d++)if(w<<=1,w-=J[d],w<0)return-1;if(w>0&&(t===k5||x!==1))return-1;for(D[1]=0,d=1;d<Pd;d++)D[d+1]=D[d]+J[d];for(m=0;m<a;m++)e[r+m]!==0&&(l[D[e[r+m]]++]=m);if(t===k5?(q=T=l,L=20):t===_v?(q=VU,T=GU,L=257):(q=YU,T=XU,L=0),C=0,m=0,d=v,B=s,b=g,_=0,Y=-1,A=1<<g,W=A-1,t===_v&&A>S5||t===j5&&A>N5)return 1;for(;;){M=d-_,l[m]+1<L?(V=0,ie=l[m]):l[m]>=L?(V=T[l[m]-L],ie=q[l[m]-L]):(V=96,ie=0),E=1<<d-_,R=1<<b,v=R;do R-=E,n[B+(C>>_)+R]=M<<24|V<<16|ie|0;while(R!==0);for(E=1<<d-1;C&E;)E>>=1;if(E!==0?(C&=E-1,C+=E):C=0,m++,--J[d]===0){if(d===x)break;d=e[r+l[m]]}if(d>g&&(C&W)!==Y){for(_===0&&(_=g),B+=v,b=d-_,w=1<<b;b+_<x&&(w-=J[b+_],!(w<=0));)b++,w<<=1;if(A+=1<<b,t===_v&&A>S5||t===j5&&A>N5)return 1;Y=C&W,n[Y]=g<<24|b<<16|B-s|0}}return C!==0&&(n[B+C]=d-_<<24|64<<16|0),c.bits=g,0};var b0=KU;const JU=0,Nk=1,kk=2,{Z_FINISH:E5,Z_BLOCK:ZU,Z_TREES:_p,Z_OK:Nf,Z_STREAM_END:QU,Z_NEED_DICT:eq,Z_STREAM_ERROR:ho,Z_DATA_ERROR:jk,Z_MEM_ERROR:Ek,Z_BUF_ERROR:tq,Z_DEFLATED:A5}=bk,N1=16180,C5=16181,T5=16182,O5=16183,R5=16184,D5=16185,F5=16186,L5=16187,P5=16188,M5=16189,s1=16190,nc=16191,bv=16192,I5=16193,wv=16194,B5=16195,U5=16196,q5=16197,z5=16198,bp=16199,wp=16200,H5=16201,$5=16202,W5=16203,V5=16204,G5=16205,Sv=16206,Y5=16207,X5=16208,Ga=16209,Ak=16210,Ck=16211,rq=852,aq=592,nq=15,sq=nq,K5=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function iq(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Lf=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<N1||e.mode>Ck?1:0},Tk=t=>{if(Lf(t))return ho;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=N1,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(rq),e.distcode=e.distdyn=new Int32Array(aq),e.sane=1,e.back=-1,Nf},Ok=t=>{if(Lf(t))return ho;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Tk(t)},Rk=(t,e)=>{let r;if(Lf(t))return ho;const a=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?ho:(a.window!==null&&a.wbits!==e&&(a.window=null),a.wrap=r,a.wbits=e,Ok(t))},Dk=(t,e)=>{if(!t)return ho;const r=new iq;t.state=r,r.strm=t,r.window=null,r.mode=N1;const a=Rk(t,e);return a!==Nf&&(t.state=null),a},oq=t=>Dk(t,sq);let J5=!0,Nv,kv;const lq=t=>{if(J5){Nv=new Int32Array(512),kv=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(b0(Nk,t.lens,0,288,Nv,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;b0(kk,t.lens,0,32,kv,0,t.work,{bits:5}),J5=!1}t.lencode=Nv,t.lenbits=9,t.distcode=kv,t.distbits=5},Fk=(t,e,r,a)=>{let n;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),a>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>a&&(n=a),s.window.set(e.subarray(r-a,r-a+n),s.wnext),a-=n,a?(s.window.set(e.subarray(r-a,r),0),s.wnext=a,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0},cq=(t,e)=>{let r,a,n,s,l,c,f,d,m,v,x,g,b,_,w=0,A,C,E,R,Y,W,B,q;const L=new Uint8Array(4);let J,D;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Lf(t)||!t.output||!t.input&&t.avail_in!==0)return ho;r=t.state,r.mode===nc&&(r.mode=bv),l=t.next_out,n=t.output,f=t.avail_out,s=t.next_in,a=t.input,c=t.avail_in,d=r.hold,m=r.bits,v=c,x=f,q=Nf;e:for(;;)switch(r.mode){case N1:if(r.wrap===0){r.mode=bv;break}for(;m<16;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,L[0]=d&255,L[1]=d>>>8&255,r.check=yl(r.check,L,2,0),d=0,m=0,r.mode=C5;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){t.msg="incorrect header check",r.mode=Ga;break}if((d&15)!==A5){t.msg="unknown compression method",r.mode=Ga;break}if(d>>>=4,m-=4,B=(d&15)+8,r.wbits===0&&(r.wbits=B),B>15||B>r.wbits){t.msg="invalid window size",r.mode=Ga;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=d&512?M5:nc,d=0,m=0;break;case C5:for(;m<16;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(r.flags=d,(r.flags&255)!==A5){t.msg="unknown compression method",r.mode=Ga;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Ga;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(L[0]=d&255,L[1]=d>>>8&255,r.check=yl(r.check,L,2,0)),d=0,m=0,r.mode=T5;case T5:for(;m<32;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(L[0]=d&255,L[1]=d>>>8&255,L[2]=d>>>16&255,L[3]=d>>>24&255,r.check=yl(r.check,L,4,0)),d=0,m=0,r.mode=O5;case O5:for(;m<16;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(L[0]=d&255,L[1]=d>>>8&255,r.check=yl(r.check,L,2,0)),d=0,m=0,r.mode=R5;case R5:if(r.flags&1024){for(;m<16;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(L[0]=d&255,L[1]=d>>>8&255,r.check=yl(r.check,L,2,0)),d=0,m=0}else r.head&&(r.head.extra=null);r.mode=D5;case D5:if(r.flags&1024&&(g=r.length,g>c&&(g=c),g&&(r.head&&(B=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(s,s+g),B)),r.flags&512&&r.wrap&4&&(r.check=yl(r.check,a,g,s)),c-=g,s+=g,r.length-=g),r.length))break e;r.length=0,r.mode=F5;case F5:if(r.flags&2048){if(c===0)break e;g=0;do B=a[s+g++],r.head&&B&&r.length<65536&&(r.head.name+=String.fromCharCode(B));while(B&&g<c);if(r.flags&512&&r.wrap&4&&(r.check=yl(r.check,a,g,s)),c-=g,s+=g,B)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=L5;case L5:if(r.flags&4096){if(c===0)break e;g=0;do B=a[s+g++],r.head&&B&&r.length<65536&&(r.head.comment+=String.fromCharCode(B));while(B&&g<c);if(r.flags&512&&r.wrap&4&&(r.check=yl(r.check,a,g,s)),c-=g,s+=g,B)break e}else r.head&&(r.head.comment=null);r.mode=P5;case P5:if(r.flags&512){for(;m<16;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(r.wrap&4&&d!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Ga;break}d=0,m=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=nc;break;case M5:for(;m<32;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}t.adler=r.check=K5(d),d=0,m=0,r.mode=s1;case s1:if(r.havedict===0)return t.next_out=l,t.avail_out=f,t.next_in=s,t.avail_in=c,r.hold=d,r.bits=m,eq;t.adler=r.check=1,r.mode=nc;case nc:if(e===ZU||e===_p)break e;case bv:if(r.last){d>>>=m&7,m-=m&7,r.mode=Sv;break}for(;m<3;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}switch(r.last=d&1,d>>>=1,m-=1,d&3){case 0:r.mode=I5;break;case 1:if(lq(r),r.mode=bp,e===_p){d>>>=2,m-=2;break e}break;case 2:r.mode=U5;break;case 3:t.msg="invalid block type",r.mode=Ga}d>>>=2,m-=2;break;case I5:for(d>>>=m&7,m-=m&7;m<32;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if((d&65535)!==(d>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Ga;break}if(r.length=d&65535,d=0,m=0,r.mode=wv,e===_p)break e;case wv:r.mode=B5;case B5:if(g=r.length,g){if(g>c&&(g=c),g>f&&(g=f),g===0)break e;n.set(a.subarray(s,s+g),l),c-=g,s+=g,f-=g,l+=g,r.length-=g;break}r.mode=nc;break;case U5:for(;m<14;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(r.nlen=(d&31)+257,d>>>=5,m-=5,r.ndist=(d&31)+1,d>>>=5,m-=5,r.ncode=(d&15)+4,d>>>=4,m-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Ga;break}r.have=0,r.mode=q5;case q5:for(;r.have<r.ncode;){for(;m<3;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}r.lens[T[r.have++]]=d&7,d>>>=3,m-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,J={bits:r.lenbits},q=b0(JU,r.lens,0,19,r.lencode,0,r.work,J),r.lenbits=J.bits,q){t.msg="invalid code lengths set",r.mode=Ga;break}r.have=0,r.mode=z5;case z5:for(;r.have<r.nlen+r.ndist;){for(;w=r.lencode[d&(1<<r.lenbits)-1],A=w>>>24,C=w>>>16&255,E=w&65535,!(A<=m);){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(E<16)d>>>=A,m-=A,r.lens[r.have++]=E;else{if(E===16){for(D=A+2;m<D;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(d>>>=A,m-=A,r.have===0){t.msg="invalid bit length repeat",r.mode=Ga;break}B=r.lens[r.have-1],g=3+(d&3),d>>>=2,m-=2}else if(E===17){for(D=A+3;m<D;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}d>>>=A,m-=A,B=0,g=3+(d&7),d>>>=3,m-=3}else{for(D=A+7;m<D;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}d>>>=A,m-=A,B=0,g=11+(d&127),d>>>=7,m-=7}if(r.have+g>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Ga;break}for(;g--;)r.lens[r.have++]=B}}if(r.mode===Ga)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Ga;break}if(r.lenbits=9,J={bits:r.lenbits},q=b0(Nk,r.lens,0,r.nlen,r.lencode,0,r.work,J),r.lenbits=J.bits,q){t.msg="invalid literal/lengths set",r.mode=Ga;break}if(r.distbits=6,r.distcode=r.distdyn,J={bits:r.distbits},q=b0(kk,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,J),r.distbits=J.bits,q){t.msg="invalid distances set",r.mode=Ga;break}if(r.mode=bp,e===_p)break e;case bp:r.mode=wp;case wp:if(c>=6&&f>=258){t.next_out=l,t.avail_out=f,t.next_in=s,t.avail_in=c,r.hold=d,r.bits=m,WU(t,x),l=t.next_out,n=t.output,f=t.avail_out,s=t.next_in,a=t.input,c=t.avail_in,d=r.hold,m=r.bits,r.mode===nc&&(r.back=-1);break}for(r.back=0;w=r.lencode[d&(1<<r.lenbits)-1],A=w>>>24,C=w>>>16&255,E=w&65535,!(A<=m);){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(C&&(C&240)===0){for(R=A,Y=C,W=E;w=r.lencode[W+((d&(1<<R+Y)-1)>>R)],A=w>>>24,C=w>>>16&255,E=w&65535,!(R+A<=m);){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}d>>>=R,m-=R,r.back+=R}if(d>>>=A,m-=A,r.back+=A,r.length=E,C===0){r.mode=G5;break}if(C&32){r.back=-1,r.mode=nc;break}if(C&64){t.msg="invalid literal/length code",r.mode=Ga;break}r.extra=C&15,r.mode=H5;case H5:if(r.extra){for(D=r.extra;m<D;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,m-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=$5;case $5:for(;w=r.distcode[d&(1<<r.distbits)-1],A=w>>>24,C=w>>>16&255,E=w&65535,!(A<=m);){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if((C&240)===0){for(R=A,Y=C,W=E;w=r.distcode[W+((d&(1<<R+Y)-1)>>R)],A=w>>>24,C=w>>>16&255,E=w&65535,!(R+A<=m);){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}d>>>=R,m-=R,r.back+=R}if(d>>>=A,m-=A,r.back+=A,C&64){t.msg="invalid distance code",r.mode=Ga;break}r.offset=E,r.extra=C&15,r.mode=W5;case W5:if(r.extra){for(D=r.extra;m<D;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,m-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Ga;break}r.mode=V5;case V5:if(f===0)break e;if(g=x-f,r.offset>g){if(g=r.offset-g,g>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Ga;break}g>r.wnext?(g-=r.wnext,b=r.wsize-g):b=r.wnext-g,g>r.length&&(g=r.length),_=r.window}else _=n,b=l-r.offset,g=r.length;g>f&&(g=f),f-=g,r.length-=g;do n[l++]=_[b++];while(--g);r.length===0&&(r.mode=wp);break;case G5:if(f===0)break e;n[l++]=r.length,f--,r.mode=wp;break;case Sv:if(r.wrap){for(;m<32;){if(c===0)break e;c--,d|=a[s++]<<m,m+=8}if(x-=f,t.total_out+=x,r.total+=x,r.wrap&4&&x&&(t.adler=r.check=r.flags?yl(r.check,n,x,l-x):Ox(r.check,n,x,l-x)),x=f,r.wrap&4&&(r.flags?d:K5(d))!==r.check){t.msg="incorrect data check",r.mode=Ga;break}d=0,m=0}r.mode=Y5;case Y5:if(r.wrap&&r.flags){for(;m<32;){if(c===0)break e;c--,d+=a[s++]<<m,m+=8}if(r.wrap&4&&d!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Ga;break}d=0,m=0}r.mode=X5;case X5:q=QU;break e;case Ga:q=jk;break e;case Ak:return Ek;case Ck:default:return ho}return t.next_out=l,t.avail_out=f,t.next_in=s,t.avail_in=c,r.hold=d,r.bits=m,(r.wsize||x!==t.avail_out&&r.mode<Ga&&(r.mode<Sv||e!==E5))&&Fk(t,t.output,t.next_out,x-t.avail_out),v-=t.avail_in,x-=t.avail_out,t.total_in+=v,t.total_out+=x,r.total+=x,r.wrap&4&&x&&(t.adler=r.check=r.flags?yl(r.check,n,x,t.next_out-x):Ox(r.check,n,x,t.next_out-x)),t.data_type=r.bits+(r.last?64:0)+(r.mode===nc?128:0)+(r.mode===bp||r.mode===wv?256:0),(v===0&&x===0||e===E5)&&q===Nf&&(q=tq),q},uq=t=>{if(Lf(t))return ho;let e=t.state;return e.window&&(e.window=null),t.state=null,Nf},fq=(t,e)=>{if(Lf(t))return ho;const r=t.state;return(r.wrap&2)===0?ho:(r.head=e,e.done=!1,Nf)},dq=(t,e)=>{const r=e.length;let a,n,s;return Lf(t)||(a=t.state,a.wrap!==0&&a.mode!==s1)?ho:a.mode===s1&&(n=1,n=Ox(n,e,r,0),n!==a.check)?jk:(s=Fk(t,e,r,r),s?(a.mode=Ak,Ek):(a.havedict=1,Nf))};var hq=Ok,mq=Rk,pq=Tk,gq=oq,vq=Dk,xq=cq,yq=uq,_q=fq,bq=dq,wq="pako inflate (from Nodeca project)",ic={inflateReset:hq,inflateReset2:mq,inflateResetKeep:pq,inflateInit:gq,inflateInit2:vq,inflate:xq,inflateEnd:yq,inflateGetHeader:_q,inflateSetDictionary:bq,inflateInfo:wq};function Sq(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Nq=Sq;const Lk=Object.prototype.toString,{Z_NO_FLUSH:kq,Z_FINISH:jq,Z_OK:$0,Z_STREAM_END:jv,Z_NEED_DICT:Ev,Z_STREAM_ERROR:Eq,Z_DATA_ERROR:Z5,Z_MEM_ERROR:Aq}=bk;function am(t){this.options=wk.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new HU,this.strm.avail_out=0;let r=ic.inflateInit2(this.strm,e.windowBits);if(r!==$0)throw new Error(Rx[r]);if(this.header=new Nq,ic.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Dx.string2buf(e.dictionary):Lk.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=ic.inflateSetDictionary(this.strm,e.dictionary),r!==$0)))throw new Error(Rx[r])}am.prototype.push=function(t,e){const r=this.strm,a=this.options.chunkSize,n=this.options.dictionary;let s,l,c;if(this.ended)return!1;for(e===~~e?l=e:l=e===!0?jq:kq,Lk.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),s=ic.inflate(r,l),s===Ev&&n&&(s=ic.inflateSetDictionary(r,n),s===$0?s=ic.inflate(r,l):s===Z5&&(s=Ev));r.avail_in>0&&s===jv&&r.state.wrap>0&&t[r.next_in]!==0;)ic.inflateReset(r),s=ic.inflate(r,l);switch(s){case Eq:case Z5:case Ev:case Aq:return this.onEnd(s),this.ended=!0,!1}if(c=r.avail_out,r.next_out&&(r.avail_out===0||s===jv))if(this.options.to==="string"){let f=Dx.utf8border(r.output,r.next_out),d=r.next_out-f,m=Dx.buf2string(r.output,f);r.next_out=d,r.avail_out=a-d,d&&r.output.set(r.output.subarray(f,f+d),0),this.onData(m)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===$0&&c===0)){if(s===jv)return s=ic.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};am.prototype.onData=function(t){this.chunks.push(t)};am.prototype.onEnd=function(t){t===$0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=wk.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Cq(t,e){const r=new am(e);if(r.push(t),r.err)throw r.msg||Rx[r.err];return r.result}var Tq=am,Oq=Cq,Rq={Inflate:Tq,inflate:Oq};const{Inflate:Dq,inflate:Fq}=Rq;var Q5=Dq,Lq=Fq;const Pk=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;Pk[t]=e}const eS=4294967295;function Pq(t,e,r){let a=t;for(let n=0;n<r;n++)a=Pk[(a^e[n])&255]^a>>>8;return a}function Mq(t,e){return(Pq(eS,t,e)^eS)>>>0}function tS(t,e,r){const a=t.readUint32(),n=Mq(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(n!==a)throw new Error(`CRC mismatch for chunk ${r}. Expected ${a}, found ${n}`)}function Mk(t,e,r){for(let a=0;a<r;a++)e[a]=t[a]}function Ik(t,e,r,a){let n=0;for(;n<a;n++)e[n]=t[n];for(;n<r;n++)e[n]=t[n]+e[n-a]&255}function Bk(t,e,r,a){let n=0;if(r.length===0)for(;n<a;n++)e[n]=t[n];else for(;n<a;n++)e[n]=t[n]+r[n]&255}function Uk(t,e,r,a,n){let s=0;if(r.length===0){for(;s<n;s++)e[s]=t[s];for(;s<a;s++)e[s]=t[s]+(e[s-n]>>1)&255}else{for(;s<n;s++)e[s]=t[s]+(r[s]>>1)&255;for(;s<a;s++)e[s]=t[s]+(e[s-n]+r[s]>>1)&255}}function qk(t,e,r,a,n){let s=0;if(r.length===0){for(;s<n;s++)e[s]=t[s];for(;s<a;s++)e[s]=t[s]+e[s-n]&255}else{for(;s<n;s++)e[s]=t[s]+r[s]&255;for(;s<a;s++)e[s]=t[s]+Iq(e[s-n],r[s],r[s-n])&255}}function Iq(t,e,r){const a=t+e-r,n=Math.abs(a-t),s=Math.abs(a-e),l=Math.abs(a-r);return n<=s&&n<=l?t:s<=l?e:r}function Bq(t,e,r,a,n,s){switch(t){case 0:Mk(e,r,n);break;case 1:Ik(e,r,n,s);break;case 2:Bk(e,r,a,n);break;case 3:Uk(e,r,a,n,s);break;case 4:qk(e,r,a,n,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const Uq=new Uint16Array([255]),qq=new Uint8Array(Uq.buffer),zq=qq[0]===255;function Hq(t){const{data:e,width:r,height:a,channels:n,depth:s}=t,l=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],c=Math.ceil(s/8)*n,f=new Uint8Array(a*r*c);let d=0;for(let m=0;m<7;m++){const v=l[m],x=Math.ceil((r-v.x)/v.xStep),g=Math.ceil((a-v.y)/v.yStep);if(x<=0||g<=0)continue;const b=x*c,_=new Uint8Array(b);for(let w=0;w<g;w++){const A=e[d++],C=e.subarray(d,d+b);d+=b;const E=new Uint8Array(b);Bq(A,C,E,_,b,c),_.set(E);for(let R=0;R<x;R++){const Y=v.x+R*v.xStep,W=v.y+w*v.yStep;if(!(Y>=r||W>=a))for(let B=0;B<c;B++)f[(W*r+Y)*c+B]=E[R*c+B]}}}if(s===16){const m=new Uint16Array(f.buffer);if(zq)for(let v=0;v<m.length;v++)m[v]=$q(m[v]);return m}else return f}function $q(t){return(t&255)<<8|t>>8&255}const Wq=new Uint16Array([255]),Vq=new Uint8Array(Wq.buffer),Gq=Vq[0]===255,Yq=new Uint8Array(0);function rS(t){const{data:e,width:r,height:a,channels:n,depth:s}=t,l=Math.ceil(s/8)*n,c=Math.ceil(s/8*n*r),f=new Uint8Array(a*c);let d=Yq,m=0,v,x;for(let g=0;g<a;g++){switch(v=e.subarray(m+1,m+1+c),x=f.subarray(g*c,(g+1)*c),e[m]){case 0:Mk(v,x,c);break;case 1:Ik(v,x,c,l);break;case 2:Bk(v,x,d,c);break;case 3:Uk(v,x,d,c,l);break;case 4:qk(v,x,d,c,l);break;default:throw new Error(`Unsupported filter: ${e[m]}`)}d=x,m+=c+1}if(s===16){const g=new Uint16Array(f.buffer);if(Gq)for(let b=0;b<g.length;b++)g[b]=Xq(g[b]);return g}else return f}function Xq(t){return(t&255)<<8|t>>8&255}const Rp=Uint8Array.of(137,80,78,71,13,10,26,10);function aS(t){if(!Kq(t.readBytes(Rp.length)))throw new Error("wrong PNG signature")}function Kq(t){if(t.length<Rp.length)return!1;for(let e=0;e<Rp.length;e++)if(t[e]!==Rp[e])return!1;return!0}const Jq="tEXt",Zq=0,zk=new TextDecoder("latin1");function Qq(t){if(tz(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const ez=/^[\u0000-\u00FF]*$/;function tz(t){if(!ez.test(t))throw new Error("invalid latin1 text")}function rz(t,e,r){const a=Hk(e);t[a]=az(e,r-a.length-1)}function Hk(t){for(t.mark();t.readByte()!==Zq;);const e=t.offset;t.reset();const r=zk.decode(t.readBytes(e-t.offset-1));return t.skip(1),Qq(r),r}function az(t,e){return zk.decode(t.readBytes(e))}const Ti={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Av={UNKNOWN:-1,DEFLATE:0},nS={UNKNOWN:-1,ADAPTIVE:0},Cv={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Sp={NONE:0,BACKGROUND:1,PREVIOUS:2},Tv={SOURCE:0,OVER:1};class nz extends V2{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,r={}){super(e);const{checkCrc:a=!1}=r;this._checkCrc=a,this._inflator=new Q5,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Av.UNKNOWN,this._filterMethod=nS.UNKNOWN,this._interlaceMethod=Cv.UNKNOWN,this._colorType=Ti.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(aS(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeChunk(e,r)}return this.decodeImage(),this._png}decodeApng(){for(aS(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(e,r)}return this.decodeApngImage(),this._apng}decodeChunk(e,r){const a=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case Jq:rz(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-a!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?tS(this,e+4,r):this.skip(4)}decodeApngChunk(e,r){const a=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,r),this.offset=a+e;break}if(this.offset-a!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?tS(this,e+4,r):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=sz(this.readUint8());const r=this.readUint8();this._colorType=r;let a;switch(r){case Ti.GREYSCALE:a=1;break;case Ti.TRUECOLOUR:a=3;break;case Ti.INDEXED_COLOUR:a=1;break;case Ti.GREYSCALE_ALPHA:a=2;break;case Ti.TRUECOLOUR_ALPHA:a=4;break;case Ti.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==Av.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const r=e/3;this._hasPalette=!0;const a=[];this._palette=a;for(let n=0;n<r;n++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const r=e,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let r=e,a=this.offset+this.byteOffset;if(a+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Ti.GREYSCALE:case Ti.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let r=0;r<e/2;r++)this._transparency[r]=this.readUint16();break}case Ti.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let r=0;for(;r<e;r++){const a=this.readByte();this._palette[r].push(a)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case Ti.UNKNOWN:case Ti.GREYSCALE_ALPHA:case Ti.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const r=Hk(this),a=this.readUint8();if(a!==Av.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const n=this.readBytes(e-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:Lq(n)}}decodepHYs(){const e=this.readUint32(),r=this.readUint32(),a=this.readByte();this._png.resolution={x:e,y:r,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const r={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(e);if(a){if(a.data=rS({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)r.data=a.data;else{const n=this._apng.frames.at(e-1);this.disposeFrame(a,n,r),this.addFrameDataToCanvas(r,a)}this._apng.frames.push(r)}}return this._apng}disposeFrame(e,r,a){switch(e.disposeOp){case Sp.NONE:break;case Sp.BACKGROUND:for(let n=0;n<this._png.height;n++)for(let s=0;s<this._png.width;s++){const l=(n*e.width+s)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case Sp.PREVIOUS:a.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,r){const a=1<<this._png.depth,n=(s,l)=>{const c=((s+r.yOffset)*this._png.width+r.xOffset+l)*this._png.channels,f=(s*r.width+l)*this._png.channels;return{index:c,frameIndex:f}};switch(r.blendOp){case Tv.SOURCE:for(let s=0;s<r.height;s++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:f}=n(s,l);for(let d=0;d<this._png.channels;d++)e.data[c+d]=r.data[f+d]}break;case Tv.OVER:for(let s=0;s<r.height;s++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:f}=n(s,l);for(let d=0;d<this._png.channels;d++){const m=r.data[f+this._png.channels-1]/a,v=d%(this._png.channels-1)===0?1:r.data[f+d],x=Math.floor(m*v+(1-m)*e.data[c+d]);e.data[c+d]+=x}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==nS.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Cv.NO_INTERLACE)this._png.data=rS({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Cv.ADAM7)this._png.data=Hq({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,r=this._frames.at(-1);r?r.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Sp.NONE,blendOp:Tv.SOURCE,data:e}),this._inflator=new Q5,this._writingDataChunks=!1}}function sz(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var sS;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(sS||(sS={}));function iz(t,e){return new nz(t,e).decode()}var kr=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Ov(){kr.console&&typeof kr.console.log=="function"&&kr.console.log.apply(kr.console,arguments)}var Aa={log:Ov,warn:function(t){kr.console&&(typeof kr.console.warn=="function"?kr.console.warn.apply(kr.console,arguments):Ov.call(null,arguments))},error:function(t){kr.console&&(typeof kr.console.error=="function"?kr.console.error.apply(kr.console,arguments):Ov(t))}};function Rv(t,e,r){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="blob",a.onload=function(){rf(a.response,e,r)},a.onerror=function(){Aa.error("could not download file")},a.send()}function iS(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Np(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var rf=kr.saveAs||((typeof window>"u"?"undefined":pa(window))!=="object"||window!==kr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var a=kr.URL||kr.webkitURL,n=document.createElement("a");e=e||t.name||"download",n.download=e,n.rel="noopener",typeof t=="string"?(n.href=t,n.origin!==location.origin?iS(n.href)?Rv(t,e,r):Np(n,n.target="_blank"):Np(n)):(n.href=a.createObjectURL(t),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){Np(n)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(iS(t))Rv(t,e,r);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout(function(){Np(a)})}else navigator.msSaveOrOpenBlob((function(n,s){return s===void 0?s={autoBom:!1}:pa(s)!=="object"&&(Aa.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(t,r),e)}:function(t,e,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof t=="string")return Rv(t,e,r);var n=t.type==="application/octet-stream",s=/constructor/i.test(kr.HTMLElement)||kr.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||n&&s)&&(typeof FileReader>"u"?"undefined":pa(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var m=c.result;m=l?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=m:location=m,a=null},c.readAsDataURL(t)}else{var f=kr.URL||kr.webkitURL,d=f.createObjectURL(t);a?a.location=d:location.href=d,a=null,setTimeout(function(){f.revokeObjectURL(d)},4e4)}});function $k(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,s=r[a].process,l=n.exec(t);l&&(e=s(l),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),f=this.g.toString(16),d=this.b.toString(16);return c.length==1&&(c="0"+c),f.length==1&&(f="0"+f),d.length==1&&(d="0"+d),"#"+c+f+d}}var Dp=kr.atob.bind(kr),oS=kr.btoa.bind(kr);function Dv(t,e){var r=t[0],a=t[1],n=t[2],s=t[3];r=Es(r,a,n,s,e[0],7,-680876936),s=Es(s,r,a,n,e[1],12,-389564586),n=Es(n,s,r,a,e[2],17,606105819),a=Es(a,n,s,r,e[3],22,-1044525330),r=Es(r,a,n,s,e[4],7,-176418897),s=Es(s,r,a,n,e[5],12,1200080426),n=Es(n,s,r,a,e[6],17,-1473231341),a=Es(a,n,s,r,e[7],22,-45705983),r=Es(r,a,n,s,e[8],7,1770035416),s=Es(s,r,a,n,e[9],12,-1958414417),n=Es(n,s,r,a,e[10],17,-42063),a=Es(a,n,s,r,e[11],22,-1990404162),r=Es(r,a,n,s,e[12],7,1804603682),s=Es(s,r,a,n,e[13],12,-40341101),n=Es(n,s,r,a,e[14],17,-1502002290),r=As(r,a=Es(a,n,s,r,e[15],22,1236535329),n,s,e[1],5,-165796510),s=As(s,r,a,n,e[6],9,-1069501632),n=As(n,s,r,a,e[11],14,643717713),a=As(a,n,s,r,e[0],20,-373897302),r=As(r,a,n,s,e[5],5,-701558691),s=As(s,r,a,n,e[10],9,38016083),n=As(n,s,r,a,e[15],14,-660478335),a=As(a,n,s,r,e[4],20,-405537848),r=As(r,a,n,s,e[9],5,568446438),s=As(s,r,a,n,e[14],9,-1019803690),n=As(n,s,r,a,e[3],14,-187363961),a=As(a,n,s,r,e[8],20,1163531501),r=As(r,a,n,s,e[13],5,-1444681467),s=As(s,r,a,n,e[2],9,-51403784),n=As(n,s,r,a,e[7],14,1735328473),r=Cs(r,a=As(a,n,s,r,e[12],20,-1926607734),n,s,e[5],4,-378558),s=Cs(s,r,a,n,e[8],11,-2022574463),n=Cs(n,s,r,a,e[11],16,1839030562),a=Cs(a,n,s,r,e[14],23,-35309556),r=Cs(r,a,n,s,e[1],4,-1530992060),s=Cs(s,r,a,n,e[4],11,1272893353),n=Cs(n,s,r,a,e[7],16,-155497632),a=Cs(a,n,s,r,e[10],23,-1094730640),r=Cs(r,a,n,s,e[13],4,681279174),s=Cs(s,r,a,n,e[0],11,-358537222),n=Cs(n,s,r,a,e[3],16,-722521979),a=Cs(a,n,s,r,e[6],23,76029189),r=Cs(r,a,n,s,e[9],4,-640364487),s=Cs(s,r,a,n,e[12],11,-421815835),n=Cs(n,s,r,a,e[15],16,530742520),r=Ts(r,a=Cs(a,n,s,r,e[2],23,-995338651),n,s,e[0],6,-198630844),s=Ts(s,r,a,n,e[7],10,1126891415),n=Ts(n,s,r,a,e[14],15,-1416354905),a=Ts(a,n,s,r,e[5],21,-57434055),r=Ts(r,a,n,s,e[12],6,1700485571),s=Ts(s,r,a,n,e[3],10,-1894986606),n=Ts(n,s,r,a,e[10],15,-1051523),a=Ts(a,n,s,r,e[1],21,-2054922799),r=Ts(r,a,n,s,e[8],6,1873313359),s=Ts(s,r,a,n,e[15],10,-30611744),n=Ts(n,s,r,a,e[6],15,-1560198380),a=Ts(a,n,s,r,e[13],21,1309151649),r=Ts(r,a,n,s,e[4],6,-145523070),s=Ts(s,r,a,n,e[11],10,-1120210379),n=Ts(n,s,r,a,e[2],15,718787259),a=Ts(a,n,s,r,e[9],21,-343485551),t[0]=du(r,t[0]),t[1]=du(a,t[1]),t[2]=du(n,t[2]),t[3]=du(s,t[3])}function k1(t,e,r,a,n,s){return e=du(du(e,t),du(a,s)),du(e<<n|e>>>32-n,r)}function Es(t,e,r,a,n,s,l){return k1(e&r|~e&a,t,e,n,s,l)}function As(t,e,r,a,n,s,l){return k1(e&a|r&~a,t,e,n,s,l)}function Cs(t,e,r,a,n,s,l){return k1(e^r^a,t,e,n,s,l)}function Ts(t,e,r,a,n,s,l){return k1(r^(e|~a),t,e,n,s,l)}function Wk(t){var e,r=t.length,a=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Dv(a,oz(t.substring(e-64,e)));t=t.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)n[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(Dv(a,n),e=0;e<16;e++)n[e]=0;return n[14]=8*r,Dv(a,n),a}function oz(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var lS="0123456789abcdef".split("");function lz(t){for(var e="",r=0;r<4;r++)e+=lS[t>>8*r+4&15]+lS[t>>8*r&15];return e}function cz(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Fx(t){return Wk(t).map(cz).join("")}var uz=(function(t){for(var e=0;e<t.length;e++)t[e]=lz(t[e]);return t.join("")})(Wk("hello"))!="5d41402abc4b2a76b9719d911017c592";function du(t,e){if(uz){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}function Lx(t,e){var r,a,n,s;if(t!==r){for(var l=(n=t,s=1+(256/t.length|0),new Array(s+1).join(n)),c=[],f=0;f<256;f++)c[f]=f;var d=0;for(f=0;f<256;f++){var m=c[f];d=(d+m+l.charCodeAt(f))%256,c[f]=c[d],c[d]=m}r=t,a=c}else c=a;var v=e.length,x=0,g=0,b="";for(f=0;f<v;f++)g=(g+(m=c[x=(x+1)%256]))%256,c[x]=c[g],c[g]=m,l=c[(c[x]+c[g])%256],b+=String.fromCharCode(e.charCodeAt(f)^l);return b}var cS={print:4,modify:8,copy:16,"annot-forms":32};function zd(t,e,r,a){this.v=1,this.r=2;var n=192;t.forEach(function(c){if(cS.perm!==void 0)throw new Error("Invalid permission: "+c);n+=cS[c]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),l=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,l),this.P=-(1+(255^n)),this.encryptionKey=Fx(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=Lx(this.encryptionKey,this.padding)}function Hd(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,a=0;a<r;a++){var n=t.charCodeAt(a);e+=n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?"#"+("0"+n.toString(16)).slice(-2):t[a]}return e}function uS(t){if(pa(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var s=Math.random().toString(35);return e[r][s]=[a,!!n],s},this.unsubscribe=function(r){for(var a in e)if(e[a][r])return delete e[a][r],Object.keys(e[a]).length===0&&delete e[a],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var s in e[r]){var l=e[r][s];try{l[0].apply(t,a)}catch(c){kr.console&&Aa.error("jsPDF PubSub Error",c.message,c)}l[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function i1(t){if(!(this instanceof i1))return new i1(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function Vk(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function lf(t,e,r,a,n){if(!(this instanceof lf))return new lf(t,e,r,a,n);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,Vk.call(this,a,n)}function Vd(t,e,r,a,n){if(!(this instanceof Vd))return new Vd(t,e,r,a,n);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,Vk.call(this,a,n)}function ir(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],s=arguments[3],l=[],c=1,f=16,d="S",m=null;pa(t=t||{})==="object"&&(r=t.orientation,a=t.unit||a,n=t.format||n,s=t.compress||t.compressPdf||s,(m=t.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),c=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(f=t.floatPrecision),d=t.defaultPathOperation||"S"),l=t.filters||(s===!0?["FlateEncode"]:l),a=a||"mm",r=(""+(r||"P")).toLowerCase();var v=t.putOnlyUsedFonts||!1,x={},g={internal:{},__private__:{}};g.__private__.PubSub=uS;var b="1.3",_=g.__private__.getPdfVersion=function(){return b};g.__private__.setPdfVersion=function(O){b=O};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return w};var A=g.__private__.getPageFormat=function(O){return w[O]};n=n||"a4";var C="compat",E="advanced",R=C;function Y(){this.saveGraphicsState(),he(new ar(pt,0,0,-pt,0,wo()*pt).toString()+" cm"),this.setFontSize(this.getFontSize()/pt),d="n",R=E}function W(){this.restoreGraphicsState(),d="S",R=C}var B=g.__private__.combineFontStyleAndFontWeight=function(O,Q){if(O=="bold"&&Q=="normal"||O=="bold"&&Q==400||O=="normal"&&Q=="italic"||O=="bold"&&Q=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Q&&(O=Q==400||Q==="normal"?O==="italic"?"italic":"normal":Q!=700&&Q!=="bold"||O!=="normal"?(Q==700?"bold":Q)+""+O:"bold"),O};g.advancedAPI=function(O){var Q=R===C;return Q&&Y.call(this),typeof O!="function"||(O(this),Q&&W.call(this)),this},g.compatAPI=function(O){var Q=R===E;return Q&&W.call(this),typeof O!="function"||(O(this),Q&&Y.call(this)),this},g.isAdvancedAPI=function(){return R===E};var q,L=function(O){if(R!==E)throw new Error(O+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},J=g.roundToPrecision=g.__private__.roundToPrecision=function(O,Q){var Ae=e||Q;if(isNaN(O)||isNaN(Ae))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return O.toFixed(Ae).replace(/0+$/,"")};q=g.hpf=g.__private__.hpf=typeof f=="number"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return J(O,f)}:f==="smart"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return J(O,O>-1&&O<1?16:5)}:function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return J(O,16)};var D=g.f2=g.__private__.f2=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f2");return J(O,2)},T=g.__private__.f3=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f3");return J(O,3)},M=g.scale=g.__private__.scale=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.scale");return R===C?O*pt:R===E?O:void 0},V=function(O){return M((function(Q){return R===C?wo()-Q:R===E?Q:void 0})(O))};g.__private__.setPrecision=g.setPrecision=function(O){typeof parseInt(O,10)=="number"&&(e=parseInt(O,10))};var ie,X="00000000000000000000000000000000",Z=g.__private__.getFileId=function(){return X},K=g.__private__.setFileId=function(O){return X=O!==void 0&&/^[a-fA-F0-9]{32}$/.test(O)?O.toUpperCase():X.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(gn=new zd(m.userPermissions,m.userPassword,m.ownerPassword,X)),X};g.setFileId=function(O){return K(O),this},g.getFileId=function(){return Z()};var re=g.__private__.convertDateToPDFDate=function(O){var Q=O.getTimezoneOffset(),Ae=Q<0?"+":"-",Oe=Math.floor(Math.abs(Q/60)),qe=Math.abs(Q%60),gt=[Ae,I(Oe),"'",I(qe),"'"].join("");return["D:",O.getFullYear(),I(O.getMonth()+1),I(O.getDate()),I(O.getHours()),I(O.getMinutes()),I(O.getSeconds()),gt].join("")},de=g.__private__.convertPDFDateToDate=function(O){var Q=parseInt(O.substr(2,4),10),Ae=parseInt(O.substr(6,2),10)-1,Oe=parseInt(O.substr(8,2),10),qe=parseInt(O.substr(10,2),10),gt=parseInt(O.substr(12,2),10),St=parseInt(O.substr(14,2),10);return new Date(Q,Ae,Oe,qe,gt,St,0)},U=g.__private__.setCreationDate=function(O){var Q;if(O===void 0&&(O=new Date),O instanceof Date)Q=re(O);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(O))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Q=O}return ie=Q},k=g.__private__.getCreationDate=function(O){var Q=ie;return O==="jsDate"&&(Q=de(ie)),Q};g.setCreationDate=function(O){return U(O),this},g.getCreationDate=function(O){return k(O)};var F,I=g.__private__.padd2=function(O){return("0"+parseInt(O)).slice(-2)},z=g.__private__.padd2Hex=function(O){return("00"+(O=O.toString())).substr(O.length)},te=0,se=[],pe=[],ve=0,_e=[],Pe=[],fe=!1,st=pe;g.__private__.setCustomOutputDestination=function(O){fe=!0,st=O};var mt=function(O){fe||(st=O)};g.__private__.resetCustomOutputDestination=function(){fe=!1,st=pe};var he=g.__private__.out=function(O){return O=O.toString(),ve+=O.length+1,st.push(O),st},at=g.__private__.write=function(O){return he(arguments.length===1?O.toString():Array.prototype.join.call(arguments," "))},we=g.__private__.getArrayBuffer=function(O){for(var Q=O.length,Ae=new ArrayBuffer(Q),Oe=new Uint8Array(Ae);Q--;)Oe[Q]=O.charCodeAt(Q);return Ae},ye=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return ye};var Be=t.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(O){return Be=R===E?O/pt:O,this};var Et,Xe=g.__private__.getFontSize=g.getFontSize=function(){return R===C?Be:Be*pt},lt=t.R2L||!1;g.__private__.setR2L=g.setR2L=function(O){return lt=O,this},g.__private__.getR2L=g.getR2L=function(){return lt};var jt,Dt=g.__private__.setZoomMode=function(O){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(O))Et=O;else if(isNaN(O)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(O)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+O+'" is not recognized.');Et=O}else Et=parseInt(O,10)};g.__private__.getZoomMode=function(){return Et};var Wt,et=g.__private__.setPageMode=function(O){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(O)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+O+'" is not recognized.');jt=O};g.__private__.getPageMode=function(){return jt};var ht=g.__private__.setLayoutMode=function(O){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(O)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+O+'" is not recognized.');Wt=O};g.__private__.getLayoutMode=function(){return Wt},g.__private__.setDisplayMode=g.setDisplayMode=function(O,Q,Ae){return Dt(O),ht(Q),et(Ae),this};var yt={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(O){if(Object.keys(yt).indexOf(O)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return yt[O]},g.__private__.getDocumentProperties=function(){return yt},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(O){for(var Q in yt)yt.hasOwnProperty(Q)&&O[Q]&&(yt[Q]=O[Q]);return this},g.__private__.setDocumentProperty=function(O,Q){if(Object.keys(yt).indexOf(O)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return yt[O]=Q};var ft,pt,wt,Lt,Pt,zt={},Ce={},Ve=[],ce={},Re={},Me={},Tt={},$t=null,or=0,Ht=[],mr=new uS(g),Ca=t.hotfixes||[],Na={},Ct={},Oa=[],ar=function O(Q,Ae,Oe,qe,gt,St){if(!(this instanceof O))return new O(Q,Ae,Oe,qe,gt,St);isNaN(Q)&&(Q=1),isNaN(Ae)&&(Ae=0),isNaN(Oe)&&(Oe=0),isNaN(qe)&&(qe=1),isNaN(gt)&&(gt=0),isNaN(St)&&(St=0),this._matrix=[Q,Ae,Oe,qe,gt,St]};Object.defineProperty(ar.prototype,"sx",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(ar.prototype,"shy",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(ar.prototype,"shx",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(ar.prototype,"sy",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(ar.prototype,"tx",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(ar.prototype,"ty",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(ar.prototype,"a",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(ar.prototype,"b",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(ar.prototype,"c",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(ar.prototype,"d",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(ar.prototype,"e",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(ar.prototype,"f",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(ar.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ar.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ar.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ar.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ar.prototype.join=function(O){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(q).join(O)},ar.prototype.multiply=function(O){var Q=O.sx*this.sx+O.shy*this.shx,Ae=O.sx*this.shy+O.shy*this.sy,Oe=O.shx*this.sx+O.sy*this.shx,qe=O.shx*this.shy+O.sy*this.sy,gt=O.tx*this.sx+O.ty*this.shx+this.tx,St=O.tx*this.shy+O.ty*this.sy+this.ty;return new ar(Q,Ae,Oe,qe,gt,St)},ar.prototype.decompose=function(){var O=this.sx,Q=this.shy,Ae=this.shx,Oe=this.sy,qe=this.tx,gt=this.ty,St=Math.sqrt(O*O+Q*Q),Jt=(O/=St)*Ae+(Q/=St)*Oe;Ae-=O*Jt,Oe-=Q*Jt;var nr=Math.sqrt(Ae*Ae+Oe*Oe);return Jt/=nr,O*(Oe/=nr)<Q*(Ae/=nr)&&(O=-O,Q=-Q,Jt=-Jt,St=-St),{scale:new ar(St,0,0,nr,0,0),translate:new ar(1,0,0,1,qe,gt),rotate:new ar(O,Q,-Q,O,0,0),skew:new ar(1,0,Jt,1,0,0)}},ar.prototype.toString=function(O){return this.join(" ")},ar.prototype.inversed=function(){var O=this.sx,Q=this.shy,Ae=this.shx,Oe=this.sy,qe=this.tx,gt=this.ty,St=1/(O*Oe-Q*Ae),Jt=Oe*St,nr=-Q*St,xr=-Ae*St,jr=O*St;return new ar(Jt,nr,xr,jr,-Jt*qe-xr*gt,-nr*qe-jr*gt)},ar.prototype.applyToPoint=function(O){var Q=O.x*this.sx+O.y*this.shx+this.tx,Ae=O.x*this.shy+O.y*this.sy+this.ty;return new Xs(Q,Ae)},ar.prototype.applyToRectangle=function(O){var Q=this.applyToPoint(O),Ae=this.applyToPoint(new Xs(O.x+O.w,O.y+O.h));return new vo(Q.x,Q.y,Ae.x-Q.x,Ae.y-Q.y)},ar.prototype.clone=function(){var O=this.sx,Q=this.shy,Ae=this.shx,Oe=this.sy,qe=this.tx,gt=this.ty;return new ar(O,Q,Ae,Oe,qe,gt)},g.Matrix=ar;var za=g.matrixMult=function(O,Q){return Q.multiply(O)},os=new ar(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=os;var rn=function(O,Q){if(!Re[O]){var Ae=(Q instanceof lf?"Sh":"P")+(Object.keys(ce).length+1).toString(10);Q.id=Ae,Re[O]=Ae,ce[Ae]=Q,mr.publish("addPattern",Q)}};g.ShadingPattern=lf,g.TilingPattern=Vd,g.addShadingPattern=function(O,Q){return L("addShadingPattern()"),rn(O,Q),this},g.beginTilingPattern=function(O){L("beginTilingPattern()"),Ll(O.boundingBox[0],O.boundingBox[1],O.boundingBox[2]-O.boundingBox[0],O.boundingBox[3]-O.boundingBox[1],O.matrix)},g.endTilingPattern=function(O,Q){L("endTilingPattern()"),Q.stream=Pe[F].join(`
`),rn(O,Q),mr.publish("endTilingPattern",Q),Oa.pop().restore()};var Mn,Ut=g.__private__.newObject=function(){var O=er();return ae(O,!0),O},er=g.__private__.newObjectDeferred=function(){return te++,se[te]=function(){return ve},te},ae=function(O,Q){return Q=typeof Q=="boolean"&&Q,se[O]=ve,Q&&he(O+" 0 obj"),O},Se=g.__private__.newAdditionalObject=function(){var O={objId:er(),content:""};return _e.push(O),O},ge=er(),xe=er(),Ne=g.__private__.decodeColorString=function(O){var Q=O.split(" ");if(Q.length!==2||Q[1]!=="g"&&Q[1]!=="G")Q.length!==5||Q[4]!=="k"&&Q[4]!=="K"||(Q=[(1-Q[0])*(1-Q[3]),(1-Q[1])*(1-Q[3]),(1-Q[2])*(1-Q[3]),"r"]);else{var Ae=parseFloat(Q[0]);Q=[Ae,Ae,Ae,"r"]}for(var Oe="#",qe=0;qe<3;qe++)Oe+=("0"+Math.floor(255*parseFloat(Q[qe])).toString(16)).slice(-2);return Oe},ke=g.__private__.encodeColorString=function(O){var Q;typeof O=="string"&&(O={ch1:O});var Ae=O.ch1,Oe=O.ch2,qe=O.ch3,gt=O.ch4,St=O.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ae=="string"&&Ae.charAt(0)!=="#"){var Jt=new $k(Ae);if(Jt.ok)Ae=Jt.toHex();else if(!/^\d*\.?\d*$/.test(Ae))throw new Error('Invalid color "'+Ae+'" passed to jsPDF.encodeColorString.')}if(typeof Ae=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ae)&&(Ae="#"+Ae[1]+Ae[1]+Ae[2]+Ae[2]+Ae[3]+Ae[3]),typeof Ae=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ae)){var nr=parseInt(Ae.substr(1),16);Ae=nr>>16&255,Oe=nr>>8&255,qe=255&nr}if(Oe===void 0||gt===void 0&&Ae===Oe&&Oe===qe)Q=typeof Ae=="string"?Ae+" "+St[0]:O.precision===2?D(Ae/255)+" "+St[0]:T(Ae/255)+" "+St[0];else if(gt===void 0||pa(gt)==="object"){if(gt&&!isNaN(gt.a)&&gt.a===0)return["1.","1.","1.",St[1]].join(" ");Q=typeof Ae=="string"?[Ae,Oe,qe,St[1]].join(" "):O.precision===2?[D(Ae/255),D(Oe/255),D(qe/255),St[1]].join(" "):[T(Ae/255),T(Oe/255),T(qe/255),St[1]].join(" ")}else Q=typeof Ae=="string"?[Ae,Oe,qe,gt,St[2]].join(" "):O.precision===2?[D(Ae),D(Oe),D(qe),D(gt),St[2]].join(" "):[T(Ae),T(Oe),T(qe),T(gt),St[2]].join(" ");return Q},He=g.__private__.getFilters=function(){return l},nt=g.__private__.putStream=function(O){var Q=(O=O||{}).data||"",Ae=O.filters||He(),Oe=O.alreadyAppliedFilters||[],qe=O.addLength1||!1,gt=Q.length,St=O.objectId,Jt=function(vn){return vn};if(m!==null&&St===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(Jt=gn.encryptor(St,0));var nr={};Ae===!0&&(Ae=["FlateEncode"]);var xr=O.additionalKeyValues||[],jr=(nr=ir.API.processDataByFilters!==void 0?ir.API.processDataByFilters(Q,Ae):{data:Q,reverseChain:[]}).reverseChain+(Array.isArray(Oe)?Oe.join(" "):Oe.toString());if(nr.data.length!==0&&(xr.push({key:"Length",value:nr.data.length}),qe===!0&&xr.push({key:"Length1",value:gt})),jr.length!=0)if(jr.split("/").length-1==1)xr.push({key:"Filter",value:jr});else{xr.push({key:"Filter",value:"["+jr+"]"});for(var $r=0;$r<xr.length;$r+=1)if(xr[$r].key==="DecodeParms"){for(var Da=[],Ya=0;Ya<nr.reverseChain.split("/").length-1;Ya+=1)Da.push("null");Da.push(xr[$r].value),xr[$r].value="["+Da.join(" ")+"]"}}he("<<");for(var va=0;va<xr.length;va++)he("/"+xr[va].key+" "+xr[va].value);he(">>"),nr.data.length!==0&&(he("stream"),he(Jt(nr.data)),he("endstream"))},Ge=g.__private__.putPage=function(O){var Q=O.number,Ae=O.data,Oe=O.objId,qe=O.contentsObjId;ae(Oe,!0),he("<</Type /Page"),he("/Parent "+O.rootDictionaryObjId+" 0 R"),he("/Resources "+O.resourceDictionaryObjId+" 0 R"),he("/MediaBox ["+parseFloat(q(O.mediaBox.bottomLeftX))+" "+parseFloat(q(O.mediaBox.bottomLeftY))+" "+q(O.mediaBox.topRightX)+" "+q(O.mediaBox.topRightY)+"]"),O.cropBox!==null&&he("/CropBox ["+q(O.cropBox.bottomLeftX)+" "+q(O.cropBox.bottomLeftY)+" "+q(O.cropBox.topRightX)+" "+q(O.cropBox.topRightY)+"]"),O.bleedBox!==null&&he("/BleedBox ["+q(O.bleedBox.bottomLeftX)+" "+q(O.bleedBox.bottomLeftY)+" "+q(O.bleedBox.topRightX)+" "+q(O.bleedBox.topRightY)+"]"),O.trimBox!==null&&he("/TrimBox ["+q(O.trimBox.bottomLeftX)+" "+q(O.trimBox.bottomLeftY)+" "+q(O.trimBox.topRightX)+" "+q(O.trimBox.topRightY)+"]"),O.artBox!==null&&he("/ArtBox ["+q(O.artBox.bottomLeftX)+" "+q(O.artBox.bottomLeftY)+" "+q(O.artBox.topRightX)+" "+q(O.artBox.topRightY)+"]"),typeof O.userUnit=="number"&&O.userUnit!==1&&he("/UserUnit "+O.userUnit),mr.publish("putPage",{objId:Oe,pageContext:Ht[Q],pageNumber:Q,page:Ae}),he("/Contents "+qe+" 0 R"),he(">>"),he("endobj");var gt=Ae.join(`
`);return R===E&&(gt+=`
Q`),ae(qe,!0),nt({data:gt,filters:He(),objectId:qe}),he("endobj"),Oe},Ye=g.__private__.putPages=function(){var O,Q,Ae=[];for(O=1;O<=or;O++)Ht[O].objId=er(),Ht[O].contentsObjId=er();for(O=1;O<=or;O++)Ae.push(Ge({number:O,data:Pe[O],objId:Ht[O].objId,contentsObjId:Ht[O].contentsObjId,mediaBox:Ht[O].mediaBox,cropBox:Ht[O].cropBox,bleedBox:Ht[O].bleedBox,trimBox:Ht[O].trimBox,artBox:Ht[O].artBox,userUnit:Ht[O].userUnit,rootDictionaryObjId:ge,resourceDictionaryObjId:xe}));ae(ge,!0),he("<</Type /Pages");var Oe="/Kids [";for(Q=0;Q<or;Q++)Oe+=Ae[Q]+" 0 R ";he(Oe+"]"),he("/Count "+or),he(">>"),he("endobj"),mr.publish("postPutPages")},Je=function(O){mr.publish("putFont",{font:O,out:he,newObject:Ut,putStream:nt}),O.isAlreadyPutted!==!0&&(O.objectNumber=Ut(),he("<<"),he("/Type /Font"),he("/BaseFont /"+Hd(O.postScriptName)),he("/Subtype /Type1"),typeof O.encoding=="string"&&he("/Encoding /"+O.encoding),he("/FirstChar 32"),he("/LastChar 255"),he(">>"),he("endobj"))},kt=function(O){O.objectNumber=Ut();var Q=[];Q.push({key:"Type",value:"/XObject"}),Q.push({key:"Subtype",value:"/Form"}),Q.push({key:"BBox",value:"["+[q(O.x),q(O.y),q(O.x+O.width),q(O.y+O.height)].join(" ")+"]"}),Q.push({key:"Matrix",value:"["+O.matrix.toString()+"]"});var Ae=O.pages[1].join(`
`);nt({data:Ae,additionalKeyValues:Q,objectId:O.objectNumber}),he("endobj")},Rt=function(O,Q){Q||(Q=21);var Ae=Ut(),Oe=(function(St,Jt){var nr,xr=[],jr=1/(Jt-1);for(nr=0;nr<1;nr+=jr)xr.push(nr);if(xr.push(1),St[0].offset!=0){var $r={offset:0,color:St[0].color};St.unshift($r)}if(St[St.length-1].offset!=1){var Da={offset:1,color:St[St.length-1].color};St.push(Da)}for(var Ya="",va=0,vn=0;vn<xr.length;vn++){for(nr=xr[vn];nr>St[va+1].offset;)va++;var nn=St[va].offset,Bn=(nr-nn)/(St[va+1].offset-nn),So=St[va].color,_i=St[va+1].color;Ya+=z(Math.round((1-Bn)*So[0]+Bn*_i[0]).toString(16))+z(Math.round((1-Bn)*So[1]+Bn*_i[1]).toString(16))+z(Math.round((1-Bn)*So[2]+Bn*_i[2]).toString(16))}return Ya.trim()})(O.colors,Q),qe=[];qe.push({key:"FunctionType",value:"0"}),qe.push({key:"Domain",value:"[0.0 1.0]"}),qe.push({key:"Size",value:"["+Q+"]"}),qe.push({key:"BitsPerSample",value:"8"}),qe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),nt({data:Oe,additionalKeyValues:qe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ae}),he("endobj"),O.objectNumber=Ut(),he("<< /ShadingType "+O.type),he("/ColorSpace /DeviceRGB");var gt="/Coords ["+q(parseFloat(O.coords[0]))+" "+q(parseFloat(O.coords[1]))+" ";O.type===2?gt+=q(parseFloat(O.coords[2]))+" "+q(parseFloat(O.coords[3])):gt+=q(parseFloat(O.coords[2]))+" "+q(parseFloat(O.coords[3]))+" "+q(parseFloat(O.coords[4]))+" "+q(parseFloat(O.coords[5])),he(gt+="]"),O.matrix&&he("/Matrix ["+O.matrix.toString()+"]"),he("/Function "+Ae+" 0 R"),he("/Extend [true true]"),he(">>"),he("endobj")},qt=function(O,Q){var Ae=er(),Oe=Ut();Q.push({resourcesOid:Ae,objectOid:Oe}),O.objectNumber=Oe;var qe=[];qe.push({key:"Type",value:"/Pattern"}),qe.push({key:"PatternType",value:"1"}),qe.push({key:"PaintType",value:"1"}),qe.push({key:"TilingType",value:"1"}),qe.push({key:"BBox",value:"["+O.boundingBox.map(q).join(" ")+"]"}),qe.push({key:"XStep",value:q(O.xStep)}),qe.push({key:"YStep",value:q(O.yStep)}),qe.push({key:"Resources",value:Ae+" 0 R"}),O.matrix&&qe.push({key:"Matrix",value:"["+O.matrix.toString()+"]"}),nt({data:O.stream,additionalKeyValues:qe,objectId:O.objectNumber}),he("endobj")},Ot=function(O){for(var Q in O.objectNumber=Ut(),he("<<"),O)switch(Q){case"opacity":he("/ca "+D(O[Q]));break;case"stroke-opacity":he("/CA "+D(O[Q]))}he(">>"),he("endobj")},Mt=function(O){ae(O.resourcesOid,!0),he("<<"),he("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Q in he("/Font <<"),zt)zt.hasOwnProperty(Q)&&(v===!1||v===!0&&x.hasOwnProperty(Q))&&he("/"+Q+" "+zt[Q].objectNumber+" 0 R");he(">>")})(),(function(){if(Object.keys(ce).length>0){for(var Q in he("/Shading <<"),ce)ce.hasOwnProperty(Q)&&ce[Q]instanceof lf&&ce[Q].objectNumber>=0&&he("/"+Q+" "+ce[Q].objectNumber+" 0 R");mr.publish("putShadingPatternDict"),he(">>")}})(),(function(Q){if(Object.keys(ce).length>0){for(var Ae in he("/Pattern <<"),ce)ce.hasOwnProperty(Ae)&&ce[Ae]instanceof g.TilingPattern&&ce[Ae].objectNumber>=0&&ce[Ae].objectNumber<Q&&he("/"+Ae+" "+ce[Ae].objectNumber+" 0 R");mr.publish("putTilingPatternDict"),he(">>")}})(O.objectOid),(function(){if(Object.keys(Me).length>0){var Q;for(Q in he("/ExtGState <<"),Me)Me.hasOwnProperty(Q)&&Me[Q].objectNumber>=0&&he("/"+Q+" "+Me[Q].objectNumber+" 0 R");mr.publish("putGStateDict"),he(">>")}})(),(function(){for(var Q in he("/XObject <<"),Na)Na.hasOwnProperty(Q)&&Na[Q].objectNumber>=0&&he("/"+Q+" "+Na[Q].objectNumber+" 0 R");mr.publish("putXobjectDict"),he(">>")})(),he(">>"),he("endobj")},Xt=function(O){Ce[O.fontName]=Ce[O.fontName]||{},Ce[O.fontName][O.fontStyle]=O.id},sa=function(O,Q,Ae,Oe,qe){var gt={id:"F"+(Object.keys(zt).length+1).toString(10),postScriptName:O,fontName:Q,fontStyle:Ae,encoding:Oe,isStandardFont:qe||!1,metadata:{}};return mr.publish("addFont",{font:gt,instance:this}),zt[gt.id]=gt,Xt(gt),gt.id},Lr=g.__private__.pdfEscape=g.pdfEscape=function(O,Q){return(function(Ae,Oe){var qe,gt,St,Jt,nr,xr,jr,$r,Da;if(St=(Oe=Oe||{}).sourceEncoding||"Unicode",nr=Oe.outputEncoding,(Oe.autoencode||nr)&&zt[ft].metadata&&zt[ft].metadata[St]&&zt[ft].metadata[St].encoding&&(Jt=zt[ft].metadata[St].encoding,!nr&&zt[ft].encoding&&(nr=zt[ft].encoding),!nr&&Jt.codePages&&(nr=Jt.codePages[0]),typeof nr=="string"&&(nr=Jt[nr]),nr)){for(jr=!1,xr=[],qe=0,gt=Ae.length;qe<gt;qe++)($r=nr[Ae.charCodeAt(qe)])?xr.push(String.fromCharCode($r)):xr.push(Ae[qe]),xr[qe].charCodeAt(0)>>8&&(jr=!0);Ae=xr.join("")}for(qe=Ae.length;jr===void 0&&qe!==0;)Ae.charCodeAt(qe-1)>>8&&(jr=!0),qe--;if(!jr)return Ae;for(xr=Oe.noBOM?[]:[254,255],qe=0,gt=Ae.length;qe<gt;qe++){if((Da=($r=Ae.charCodeAt(qe))>>8)>>8)throw new Error("Character at position "+qe+" of string '"+Ae+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");xr.push(Da),xr.push($r-(Da<<8))}return String.fromCharCode.apply(void 0,xr)})(O,Q).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ca=g.__private__.beginPage=function(O){Pe[++or]=[],Ht[or]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(O[0]),topRightY:Number(O[1])}},gi(or),mt(Pe[F])},ls=function(O,Q){var Ae,Oe,qe;switch(r=Q||r,typeof O=="string"&&(Ae=A(O.toLowerCase()),Array.isArray(Ae)&&(Oe=Ae[0],qe=Ae[1])),Array.isArray(O)&&(Oe=O[0]*pt,qe=O[1]*pt),isNaN(Oe)&&(Oe=n[0],qe=n[1]),(Oe>14400||qe>14400)&&(Aa.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Oe=Math.min(14400,Oe),qe=Math.min(14400,qe)),n=[Oe,qe],r.substr(0,1)){case"l":qe>Oe&&(n=[qe,Oe]);break;case"p":Oe>qe&&(n=[qe,Oe])}ca(n),pr(Rl),he(Us),wc!==0&&he(wc+" J"),An!==0&&he(An+" j"),mr.publish("addPage",{pageNumber:or})},pi=function(O){O>0&&O<=or&&(Pe.splice(O,1),Ht.splice(O,1),or--,F>or&&(F=or),this.setPage(F))},gi=function(O){O>0&&O<=or&&(F=O)},Is=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return Pe.length-1},Qo=function(O,Q,Ae){var Oe,qe=void 0;return Ae=Ae||{},O=O!==void 0?O:zt[ft].fontName,Q=Q!==void 0?Q:zt[ft].fontStyle,Oe=O.toLowerCase(),Ce[Oe]!==void 0&&Ce[Oe][Q]!==void 0?qe=Ce[Oe][Q]:Ce[O]!==void 0&&Ce[O][Q]!==void 0?qe=Ce[O][Q]:Ae.disableWarning===!1&&Aa.warn("Unable to look up font label for font '"+O+"', '"+Q+"'. Refer to getFontList() for available fonts."),qe||Ae.noFallback||(qe=Ce.times[Q])==null&&(qe=Ce.times.normal),qe},Ra=g.__private__.putInfo=function(){var O=Ut(),Q=function(Oe){return Oe};for(var Ae in m!==null&&(Q=gn.encryptor(O,0)),he("<<"),he("/Producer ("+Lr(Q("jsPDF "+ir.version))+")"),yt)yt.hasOwnProperty(Ae)&&yt[Ae]&&he("/"+Ae.substr(0,1).toUpperCase()+Ae.substr(1)+" ("+Lr(Q(yt[Ae]))+")");he("/CreationDate ("+Lr(Q(ie))+")"),he(">>"),he("endobj")},po=g.__private__.putCatalog=function(O){var Q=(O=O||{}).rootDictionaryObjId||ge;switch(Ut(),he("<<"),he("/Type /Catalog"),he("/Pages "+Q+" 0 R"),Et||(Et="fullwidth"),Et){case"fullwidth":he("/OpenAction [3 0 R /FitH null]");break;case"fullheight":he("/OpenAction [3 0 R /FitV null]");break;case"fullpage":he("/OpenAction [3 0 R /Fit]");break;case"original":he("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ae=""+Et;Ae.substr(Ae.length-1)==="%"&&(Et=parseInt(Et)/100),typeof Et=="number"&&he("/OpenAction [3 0 R /XYZ null null "+D(Et)+"]")}switch(Wt||(Wt="continuous"),Wt){case"continuous":he("/PageLayout /OneColumn");break;case"single":he("/PageLayout /SinglePage");break;case"two":case"twoleft":he("/PageLayout /TwoColumnLeft");break;case"tworight":he("/PageLayout /TwoColumnRight")}jt&&he("/PageMode /"+jt),mr.publish("putCatalog"),he(">>"),he("endobj")},vi=g.__private__.putTrailer=function(){he("trailer"),he("<<"),he("/Size "+(te+1)),he("/Root "+te+" 0 R"),he("/Info "+(te-1)+" 0 R"),m!==null&&he("/Encrypt "+gn.oid+" 0 R"),he("/ID [ <"+X+"> <"+X+"> ]"),he(">>")},Kr=g.__private__.putHeader=function(){he("%PDF-"+b),he("%")},Su=g.__private__.putXRef=function(){var O="0000000000";he("xref"),he("0 "+(te+1)),he("0000000000 65535 f ");for(var Q=1;Q<=te;Q++)typeof se[Q]=="function"?he((O+se[Q]()).slice(-10)+" 00000 n "):se[Q]!==void 0?he((O+se[Q]).slice(-10)+" 00000 n "):he("0000000000 00000 n ")},zi=g.__private__.buildDocument=function(){var O;te=0,ve=0,pe=[],se=[],_e=[],ge=er(),xe=er(),mt(pe),mr.publish("buildDocument"),Kr(),Ye(),(function(){mr.publish("putAdditionalObjects");for(var Ae=0;Ae<_e.length;Ae++){var Oe=_e[Ae];ae(Oe.objId,!0),he(Oe.content),he("endobj")}mr.publish("postPutAdditionalObjects")})(),O=[],(function(){for(var Ae in zt)zt.hasOwnProperty(Ae)&&(v===!1||v===!0&&x.hasOwnProperty(Ae))&&Je(zt[Ae])})(),(function(){var Ae;for(Ae in Me)Me.hasOwnProperty(Ae)&&Ot(Me[Ae])})(),(function(){for(var Ae in Na)Na.hasOwnProperty(Ae)&&kt(Na[Ae])})(),(function(Ae){var Oe;for(Oe in ce)ce.hasOwnProperty(Oe)&&(ce[Oe]instanceof lf?Rt(ce[Oe]):ce[Oe]instanceof Vd&&qt(ce[Oe],Ae))})(O),mr.publish("putResources"),O.forEach(Mt),Mt({resourcesOid:xe,objectOid:Number.MAX_SAFE_INTEGER}),mr.publish("postPutResources"),m!==null&&(gn.oid=Ut(),he("<<"),he("/Filter /Standard"),he("/V "+gn.v),he("/R "+gn.r),he("/U <"+gn.toHexString(gn.U)+">"),he("/O <"+gn.toHexString(gn.O)+">"),he("/P "+gn.P),he(">>"),he("endobj")),Ra(),po();var Q=ve;return Su(),vi(),he("startxref"),he(""+Q),he("%%EOF"),mt(Pe[F]),pe.join(`
`)},el=g.__private__.getBlob=function(O){return new Blob([we(O)],{type:"application/pdf"})},Nu=g.output=g.__private__.output=(Mn=function(O,Q){switch(typeof(Q=Q||{})=="string"?Q={filename:Q}:Q.filename=Q.filename||"generated.pdf",O){case void 0:return zi();case"save":g.save(Q.filename);break;case"arraybuffer":return we(zi());case"blob":return el(zi());case"bloburi":case"bloburl":if(kr.URL!==void 0&&typeof kr.URL.createObjectURL=="function")return kr.URL&&kr.URL.createObjectURL(el(zi()))||void 0;Aa.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ae="",Oe=zi();try{Ae=oS(Oe)}catch{Ae=oS(unescape(encodeURIComponent(Oe)))}return"data:application/pdf;filename="+Q.filename+";base64,"+Ae;case"pdfobjectnewwindow":if(Object.prototype.toString.call(kr)==="[object Window]"){var qe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",gt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Q.pdfObjectUrl&&(qe=Q.pdfObjectUrl,gt="");var St='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+qe+'"'+gt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Q)+");<\/script></body></html>",Jt=kr.open();return Jt!==null&&Jt.document.write(St),Jt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(kr)==="[object Window]"){var nr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Q.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Q.filename+'" width="500px" height="400px" /></body></html>',xr=kr.open();if(xr!==null){xr.document.write(nr);var jr=this;xr.document.documentElement.querySelector("#pdfViewer").onload=function(){xr.document.title=Q.filename,xr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(jr.output("bloburl"))}}return xr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(kr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var $r='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Q)+'"></iframe></body></html>',Da=kr.open();if(Da!==null&&(Da.document.write($r),Da.document.title=Q.filename),Da||typeof safari>"u")return Da;break;case"datauri":case"dataurl":return kr.document.location.href=this.output("datauristring",Q);default:return null}},Mn.foo=function(){try{return Mn.apply(this,arguments)}catch(Ae){var O=Ae.stack||"";~O.indexOf(" at ")&&(O=O.split(" at ")[1]);var Q="Error in function "+O.split(`
`)[0].split("<")[0]+": "+Ae.message;if(!kr.console)throw new Error(Q);kr.console.error(Q,Ae),kr.alert&&alert(Q)}},Mn.foo.bar=Mn,Mn.foo),cs=function(O){return Array.isArray(Ca)===!0&&Ca.indexOf(O)>-1};switch(a){case"pt":pt=1;break;case"mm":pt=72/25.4;break;case"cm":pt=72/2.54;break;case"in":pt=72;break;case"px":pt=cs("px_scaling")==1?.75:96/72;break;case"pc":case"em":pt=12;break;case"ex":pt=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);pt=a}var gn=null;U(),K();var an=g.__private__.getPageInfo=g.getPageInfo=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ht[O].objId,pageNumber:O,pageContext:Ht[O]}},_c=g.__private__.getPageInfoByObjId=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Q in Ht)if(Ht[Q].objId===O)break;return an(Q)},Mf=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:Ht[F].objId,pageNumber:F,pageContext:Ht[F]}};g.addPage=function(){return ls.apply(this,arguments),this},g.setPage=function(){return gi.apply(this,arguments),mt.call(this,Pe[F]),this},g.insertPage=function(O){return this.addPage(),this.movePage(F,O),this},g.movePage=function(O,Q){var Ae,Oe;if(O>Q){Ae=Pe[O],Oe=Ht[O];for(var qe=O;qe>Q;qe--)Pe[qe]=Pe[qe-1],Ht[qe]=Ht[qe-1];Pe[Q]=Ae,Ht[Q]=Oe,this.setPage(Q)}else if(O<Q){Ae=Pe[O],Oe=Ht[O];for(var gt=O;gt<Q;gt++)Pe[gt]=Pe[gt+1],Ht[gt]=Ht[gt+1];Pe[Q]=Ae,Ht[Q]=Oe,this.setPage(Q)}return this},g.deletePage=function(){return pi.apply(this,arguments),this},g.__private__.text=g.text=function(O,Q,Ae,Oe,qe){var gt,St,Jt,nr,xr,jr,$r,Da,Ya,va=(Oe=Oe||{}).scope||this;if(typeof O=="number"&&typeof Q=="number"&&(typeof Ae=="string"||Array.isArray(Ae))){var vn=Ae;Ae=Q,Q=O,O=vn}if(arguments[3]instanceof ar==0?(Jt=arguments[4],nr=arguments[5],pa($r=arguments[3])==="object"&&$r!==null||(typeof Jt=="string"&&(nr=Jt,Jt=null),typeof $r=="string"&&(nr=$r,$r=null),typeof $r=="number"&&(Jt=$r,$r=null),Oe={flags:$r,angle:Jt,align:nr})):(L("The transform parameter of text() with a Matrix value"),Ya=qe),isNaN(Q)||isNaN(Ae)||O==null)throw new Error("Invalid arguments passed to jsPDF.text");if(O.length===0)return va;var nn,Bn="",So=typeof Oe.lineHeightFactor=="number"?Oe.lineHeightFactor:go,_i=va.internal.scaleFactor;function No(Jr){return Jr=Jr.split("	").join(Array(Oe.TabLen||9).join(" ")),Lr(Jr,$r)}function Du(Jr){for(var Wr,xa=Jr.concat(),Ka=[],Zi=xa.length;Zi--;)typeof(Wr=xa.shift())=="string"?Ka.push(Wr):Array.isArray(Jr)&&(Wr.length===1||Wr[1]===void 0&&Wr[2]===void 0)?Ka.push(Wr[0]):Ka.push([Wr[0],Wr[1],Wr[2]]);return Ka}function Nc(Jr,Wr){var xa;if(typeof Jr=="string")xa=Wr(Jr)[0];else if(Array.isArray(Jr)){for(var Ka,Zi,Ni=Jr.concat(),Bl=[],Pu=Ni.length;Pu--;)typeof(Ka=Ni.shift())=="string"?Bl.push(Wr(Ka)[0]):Array.isArray(Ka)&&typeof Ka[0]=="string"&&(Zi=Wr(Ka[0],Ka[1],Ka[2]),Bl.push([Zi[0],Zi[1],Zi[2]]));xa=Bl}return xa}var Wi=!1,bi=!0;if(typeof O=="string")Wi=!0;else if(Array.isArray(O)){var Ml=O.concat();St=[];for(var ko,Cn=Ml.length;Cn--;)(typeof(ko=Ml.shift())!="string"||Array.isArray(ko)&&typeof ko[0]!="string")&&(bi=!1);Wi=bi}if(Wi===!1)throw new Error('Type of text must be string or Array. "'+O+'" is not recognized.');typeof O=="string"&&(O=O.match(/[\r?\n]/)?O.split(/\r\n|\r|\n/g):[O]);var rl=Be/va.internal.scaleFactor,al=rl*(So-1);switch(Oe.baseline){case"bottom":Ae-=al;break;case"top":Ae+=rl-al;break;case"hanging":Ae+=rl-2*al;break;case"middle":Ae+=rl/2-al}if((jr=Oe.maxWidth||0)>0&&(typeof O=="string"?O=va.splitTextToSize(O,jr):Object.prototype.toString.call(O)==="[object Array]"&&(O=O.reduce(function(Jr,Wr){return Jr.concat(va.splitTextToSize(Wr,jr))},[]))),gt={text:O,x:Q,y:Ae,options:Oe,mutex:{pdfEscape:Lr,activeFontKey:ft,fonts:zt,activeFontSize:Be}},mr.publish("preProcessText",gt),O=gt.text,Jt=(Oe=gt.options).angle,Ya instanceof ar==0&&Jt&&typeof Jt=="number"){Jt*=Math.PI/180,Oe.rotationDirection===0&&(Jt=-Jt),R===E&&(Jt=-Jt);var kc=Math.cos(Jt),Vi=Math.sin(Jt);Ya=new ar(kc,Vi,-Vi,kc,0,0)}else Jt&&Jt instanceof ar&&(Ya=Jt);R!==E||Ya||(Ya=os),(xr=Oe.charSpace||Ys)!==void 0&&(Bn+=q(M(xr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Da=Oe.horizontalScale)!==void 0&&(Bn+=q(100*Da)+` Tz
`),Oe.lang;var fs=-1,jo=Oe.renderingMode!==void 0?Oe.renderingMode:Oe.stroke,jc=va.internal.getCurrentPageInfo().pageContext;switch(jo){case 0:case!1:case"fill":fs=0;break;case 1:case!0:case"stroke":fs=1;break;case 2:case"fillThenStroke":fs=2;break;case 3:case"invisible":fs=3;break;case 4:case"fillAndAddForClipping":fs=4;break;case 5:case"strokeAndAddPathForClipping":fs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":fs=6;break;case 7:case"addToPathForClipping":fs=7}var Fu=jc.usedRenderingMode!==void 0?jc.usedRenderingMode:-1;fs!==-1?Bn+=fs+` Tr
`:Fu!==-1&&(Bn+=`0 Tr
`),fs!==-1&&(jc.usedRenderingMode=fs),nr=Oe.align||"left";var qs,wi=Be*So,Eo=va.internal.pageSize.getWidth(),Lu=zt[ft];xr=Oe.charSpace||Ys,jr=Oe.maxWidth||0,$r=Object.assign({autoencode:!0,noBOM:!0},Oe.flags);var Si=[],nl=function(Jr){return va.getStringUnitWidth(Jr,{font:Lu,charSpace:xr,fontSize:Be,doKerning:!1})*Be/_i};if(Object.prototype.toString.call(O)==="[object Array]"){var ws;St=Du(O),nr!=="left"&&(qs=St.map(nl));var ds,Gi=0;if(nr==="right"){Q-=qs[0],O=[],Cn=St.length;for(var Yi=0;Yi<Cn;Yi++)Yi===0?(ds=Bs(Q),ws=In(Ae)):(ds=M(Gi-qs[Yi]),ws=-wi),O.push([St[Yi],ds,ws]),Gi=qs[Yi]}else if(nr==="center"){Q-=qs[0]/2,O=[],Cn=St.length;for(var Ao=0;Ao<Cn;Ao++)Ao===0?(ds=Bs(Q),ws=In(Ae)):(ds=M((Gi-qs[Ao])/2),ws=-wi),O.push([St[Ao],ds,ws]),Gi=qs[Ao]}else if(nr==="left"){O=[],Cn=St.length;for(var Ec=0;Ec<Cn;Ec++)O.push(St[Ec])}else if(nr==="justify"&&Lu.encoding==="Identity-H"){O=[],Cn=St.length,jr=jr!==0?jr:Eo;for(var Ac=0,Xa=0;Xa<Cn;Xa++)if(ws=Xa===0?In(Ae):-wi,ds=Xa===0?Bs(Q):Ac,Xa<Cn-1){var Vf=M((jr-qs[Xa])/(St[Xa].split(" ").length-1)),Xi=St[Xa].split(" ");O.push([Xi[0]+" ",ds,ws]),Ac=0;for(var Ki=1;Ki<Xi.length;Ki++){var Un=(nl(Xi[Ki-1]+" "+Xi[Ki])-nl(Xi[Ki]))*_i+Vf;Ki==Xi.length-1?O.push([Xi[Ki],Un,0]):O.push([Xi[Ki]+" ",Un,0]),Ac-=Un}}else O.push([St[Xa],ds,ws]);O.push(["",Ac,0])}else{if(nr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(O=[],Cn=St.length,jr=jr!==0?jr:Eo,Xa=0;Xa<Cn;Xa++){ws=Xa===0?In(Ae):-wi,ds=Xa===0?Bs(Q):0;var Co=St[Xa].split(" ").length-1,Cc=Co>0?(jr-qs[Xa])/Co:0;Xa<Cn-1?Si.push(q(M(Cc))):Si.push(0),O.push([St[Xa],ds,ws])}}}(typeof Oe.R2L=="boolean"?Oe.R2L:lt)===!0&&(O=Nc(O,function(Jr,Wr,xa){return[Jr.split("").reverse().join(""),Wr,xa]})),gt={text:O,x:Q,y:Ae,options:Oe,mutex:{pdfEscape:Lr,activeFontKey:ft,fonts:zt,activeFontSize:Be}},mr.publish("postProcessText",gt),O=gt.text,nn=gt.mutex.isHex||!1;var Tc=zt[ft].encoding;Tc!=="WinAnsiEncoding"&&Tc!=="StandardEncoding"||(O=Nc(O,function(Jr,Wr,xa){return[No(Jr),Wr,xa]})),St=Du(O),O=[];for(var To,Oo,Ji,Il=Array.isArray(St[0])?1:0,zs="",Ro=function(Jr,Wr,xa){var Ka="";return xa instanceof ar?(xa=typeof Oe.angle=="number"?za(xa,new ar(1,0,0,1,Jr,Wr)):za(new ar(1,0,0,1,Jr,Wr),xa),R===E&&(xa=za(new ar(1,0,0,-1,0,0),xa)),Ka=xa.join(" ")+` Tm
`):Ka=q(Jr)+" "+q(Wr)+` Td
`,Ka},Jn=0;Jn<St.length;Jn++){switch(zs="",Il){case 1:Ji=(nn?"<":"(")+St[Jn][0]+(nn?">":")"),To=parseFloat(St[Jn][1]),Oo=parseFloat(St[Jn][2]);break;case 0:Ji=(nn?"<":"(")+St[Jn]+(nn?">":")"),To=Bs(Q),Oo=In(Ae)}Si!==void 0&&Si[Jn]!==void 0&&(zs=Si[Jn]+` Tw
`),Jn===0?O.push(zs+Ro(To,Oo,Ya)+Ji):Il===0?O.push(zs+Ji):Il===1&&O.push(zs+Ro(To,Oo,Ya)+Ji)}O=Il===0?O.join(` Tj
T* `):O.join(` Tj
`),O+=` Tj
`;var Ks=`BT
/`;return Ks+=ft+" "+Be+` Tf
`,Ks+=q(Be*So)+` TL
`,Ks+=Hi+`
`,Ks+=Bn,Ks+=O,he(Ks+="ET"),x[ft]=!0,va};var ku=g.__private__.clip=g.clip=function(O){return he(O==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return ku("evenodd")},g.__private__.discardPath=g.discardPath=function(){return he("n"),this};var us=g.__private__.isValidStyle=function(O){var Q=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(O)!==-1&&(Q=!0),Q};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(O){return us(O)&&(d=O),this};var ju=g.__private__.getStyle=g.getStyle=function(O){var Q=d;switch(O){case"D":case"S":Q="S";break;case"F":Q="f";break;case"FD":case"DF":Q="B";break;case"f":case"f*":case"B":case"B*":Q=O}return Q},Eu=g.close=function(){return he("h"),this};g.stroke=function(){return he("S"),this},g.fill=function(O){return xi("f",O),this},g.fillEvenOdd=function(O){return xi("f*",O),this},g.fillStroke=function(O){return xi("B",O),this},g.fillStrokeEvenOdd=function(O){return xi("B*",O),this};var xi=function(O,Q){pa(Q)==="object"?Bf(Q,O):he(O)},Ol=function(O){O===null||R===E&&O===void 0||(O=ju(O),he(O))};function If(O,Q,Ae,Oe,qe){var gt=new Vd(Q||this.boundingBox,Ae||this.xStep,Oe||this.yStep,this.gState,qe||this.matrix);gt.stream=this.stream;var St=O+"$$"+this.cloneIndex+++"$$";return rn(St,gt),gt}var Bf=function(O,Q){var Ae=Re[O.key],Oe=ce[Ae];if(Oe instanceof lf)he("q"),he(Au(Q)),Oe.gState&&g.setGState(Oe.gState),he(O.matrix.toString()+" cm"),he("/"+Ae+" sh"),he("Q");else if(Oe instanceof Vd){var qe=new ar(1,0,0,-1,0,wo());O.matrix&&(qe=qe.multiply(O.matrix||os),Ae=If.call(Oe,O.key,O.boundingBox,O.xStep,O.yStep,qe).id),he("q"),he("/Pattern cs"),he("/"+Ae+" scn"),Oe.gState&&g.setGState(Oe.gState),he(Q),he("Q")}},Au=function(O){switch(O){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Cu=g.moveTo=function(O,Q){return he(q(M(O))+" "+q(V(Q))+" m"),this},Uf=g.lineTo=function(O,Q){return he(q(M(O))+" "+q(V(Q))+" l"),this},bs=g.curveTo=function(O,Q,Ae,Oe,qe,gt){return he([q(M(O)),q(V(Q)),q(M(Ae)),q(V(Oe)),q(M(qe)),q(V(gt)),"c"].join(" ")),this};g.__private__.line=g.line=function(O,Q,Ae,Oe,qe){if(isNaN(O)||isNaN(Q)||isNaN(Ae)||isNaN(Oe)||!us(qe))throw new Error("Invalid arguments passed to jsPDF.line");return R===C?this.lines([[Ae-O,Oe-Q]],O,Q,[1,1],qe||"S"):this.lines([[Ae-O,Oe-Q]],O,Q,[1,1]).stroke()},g.__private__.lines=g.lines=function(O,Q,Ae,Oe,qe,gt){var St,Jt,nr,xr,jr,$r,Da,Ya,va,vn,nn,Bn;if(typeof O=="number"&&(Bn=Ae,Ae=Q,Q=O,O=Bn),Oe=Oe||[1,1],gt=gt||!1,isNaN(Q)||isNaN(Ae)||!Array.isArray(O)||!Array.isArray(Oe)||!us(qe)||typeof gt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Cu(Q,Ae),St=Oe[0],Jt=Oe[1],xr=O.length,vn=Q,nn=Ae,nr=0;nr<xr;nr++)(jr=O[nr]).length===2?(vn=jr[0]*St+vn,nn=jr[1]*Jt+nn,Uf(vn,nn)):($r=jr[0]*St+vn,Da=jr[1]*Jt+nn,Ya=jr[2]*St+vn,va=jr[3]*Jt+nn,vn=jr[4]*St+vn,nn=jr[5]*Jt+nn,bs($r,Da,Ya,va,vn,nn));return gt&&Eu(),Ol(qe),this},g.path=function(O){for(var Q=0;Q<O.length;Q++){var Ae=O[Q],Oe=Ae.c;switch(Ae.op){case"m":Cu(Oe[0],Oe[1]);break;case"l":Uf(Oe[0],Oe[1]);break;case"c":bs.apply(this,Oe);break;case"h":Eu()}}return this},g.__private__.rect=g.rect=function(O,Q,Ae,Oe,qe){if(isNaN(O)||isNaN(Q)||isNaN(Ae)||isNaN(Oe)||!us(qe))throw new Error("Invalid arguments passed to jsPDF.rect");return R===C&&(Oe=-Oe),he([q(M(O)),q(V(Q)),q(M(Ae)),q(M(Oe)),"re"].join(" ")),Ol(qe),this},g.__private__.triangle=g.triangle=function(O,Q,Ae,Oe,qe,gt,St){if(isNaN(O)||isNaN(Q)||isNaN(Ae)||isNaN(Oe)||isNaN(qe)||isNaN(gt)||!us(St))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ae-O,Oe-Q],[qe-Ae,gt-Oe],[O-qe,Q-gt]],O,Q,[1,1],St,!0),this},g.__private__.roundedRect=g.roundedRect=function(O,Q,Ae,Oe,qe,gt,St){if(isNaN(O)||isNaN(Q)||isNaN(Ae)||isNaN(Oe)||isNaN(qe)||isNaN(gt)||!us(St))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Jt=4/3*(Math.SQRT2-1);return qe=Math.min(qe,.5*Ae),gt=Math.min(gt,.5*Oe),this.lines([[Ae-2*qe,0],[qe*Jt,0,qe,gt-gt*Jt,qe,gt],[0,Oe-2*gt],[0,gt*Jt,-qe*Jt,gt,-qe,gt],[2*qe-Ae,0],[-qe*Jt,0,-qe,-gt*Jt,-qe,-gt],[0,2*gt-Oe],[0,-gt*Jt,qe*Jt,-gt,qe,-gt]],O+qe,Q,[1,1],St,!0),this},g.__private__.ellipse=g.ellipse=function(O,Q,Ae,Oe,qe){if(isNaN(O)||isNaN(Q)||isNaN(Ae)||isNaN(Oe)||!us(qe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var gt=4/3*(Math.SQRT2-1)*Ae,St=4/3*(Math.SQRT2-1)*Oe;return Cu(O+Ae,Q),bs(O+Ae,Q-St,O+gt,Q-Oe,O,Q-Oe),bs(O-gt,Q-Oe,O-Ae,Q-St,O-Ae,Q),bs(O-Ae,Q+St,O-gt,Q+Oe,O,Q+Oe),bs(O+gt,Q+Oe,O+Ae,Q+St,O+Ae,Q),Ol(qe),this},g.__private__.circle=g.circle=function(O,Q,Ae,Oe){if(isNaN(O)||isNaN(Q)||isNaN(Ae)||!us(Oe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(O,Q,Ae,Ae,Oe)},g.setFont=function(O,Q,Ae){return Ae&&(Q=B(Q,Ae)),ft=Qo(O,Q,{disableWarning:!1}),this};var yi=g.__private__.getFont=g.getFont=function(){return zt[Qo.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var O,Q,Ae={};for(O in Ce)if(Ce.hasOwnProperty(O))for(Q in Ae[O]=[],Ce[O])Ce[O].hasOwnProperty(Q)&&Ae[O].push(Q);return Ae},g.addFont=function(O,Q,Ae,Oe,qe){var gt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&gt.indexOf(arguments[3])!==-1?qe=arguments[3]:arguments[3]&&gt.indexOf(arguments[3])==-1&&(Ae=B(Ae,Oe)),sa.call(this,O,Q,Ae,qe=qe||"Identity-H")};var go,Rl=t.lineWidth||.200025,tl=g.__private__.getLineWidth=g.getLineWidth=function(){return Rl},pr=g.__private__.setLineWidth=g.setLineWidth=function(O){return Rl=O,he(q(M(O))+" w"),this};g.__private__.setLineDash=ir.API.setLineDash=ir.API.setLineDashPattern=function(O,Q){if(O=O||[],Q=Q||0,isNaN(Q)||!Array.isArray(O))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return O=O.map(function(Ae){return q(M(Ae))}).join(" "),Q=q(M(Q)),he("["+O+"] "+Q+" d"),this};var qf=g.__private__.getLineHeight=g.getLineHeight=function(){return Be*go};g.__private__.getLineHeight=g.getLineHeight=function(){return Be*go};var Tu=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(O){return typeof(O=O||1.15)=="number"&&(go=O),this},zf=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return go};Tu(t.lineHeight);var Bs=g.__private__.getHorizontalCoordinate=function(O){return M(O)},In=g.__private__.getVerticalCoordinate=function(O){return R===E?O:Ht[F].mediaBox.topRightY-Ht[F].mediaBox.bottomLeftY-M(O)},Ou=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(O){return q(Bs(O))},Dl=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(O){return q(In(O))},Us=t.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return Ne(Us)},g.__private__.setStrokeColor=g.setDrawColor=function(O,Q,Ae,Oe){return Us=ke({ch1:O,ch2:Q,ch3:Ae,ch4:Oe,pdfColorType:"draw",precision:2}),he(Us),this};var Fl=t.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return Ne(Fl)},g.__private__.setFillColor=g.setFillColor=function(O,Q,Ae,Oe){return Fl=ke({ch1:O,ch2:Q,ch3:Ae,ch4:Oe,pdfColorType:"fill",precision:2}),he(Fl),this};var Hi=t.textColor||"0 g",Hf=g.__private__.getTextColor=g.getTextColor=function(){return Ne(Hi)};g.__private__.setTextColor=g.setTextColor=function(O,Q,Ae,Oe){return Hi=ke({ch1:O,ch2:Q,ch3:Ae,ch4:Oe,pdfColorType:"text",precision:3}),this};var Ys=t.charSpace,bc=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(Ys||0)};g.__private__.setCharSpace=g.setCharSpace=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ys=O,this};var wc=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(O){var Q=g.CapJoinStyles[O];if(Q===void 0)throw new Error("Line cap style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return wc=Q,he(Q+" J"),this};var An=0;g.__private__.setLineJoin=g.setLineJoin=function(O){var Q=g.CapJoinStyles[O];if(Q===void 0)throw new Error("Line join style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return An=Q,he(Q+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(O){if(O=O||0,isNaN(O))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return he(q(M(O))+" M"),this},g.GState=i1,g.setGState=function(O){(O=typeof O=="string"?Me[Tt[O]]:$i(null,O)).equals($t)||(he("/"+O.id+" gs"),$t=O)};var $i=function(O,Q){if(!O||!Tt[O]){var Ae=!1;for(var Oe in Me)if(Me.hasOwnProperty(Oe)&&Me[Oe].equals(Q)){Ae=!0;break}if(Ae)Q=Me[Oe];else{var qe="GS"+(Object.keys(Me).length+1).toString(10);Me[qe]=Q,Q.id=qe}return O&&(Tt[O]=Q.id),mr.publish("addGState",Q),Q}};g.addGState=function(O,Q){return $i(O,Q),this},g.saveGraphicsState=function(){return he("q"),Ve.push({key:ft,size:Be,color:Hi}),this},g.restoreGraphicsState=function(){he("Q");var O=Ve.pop();return ft=O.key,Be=O.size,Hi=O.color,$t=null,this},g.setCurrentTransformationMatrix=function(O){return he(O.toString()+" cm"),this},g.comment=function(O){return he("#"+O),this};var Xs=function(O,Q){var Ae=O||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ae},set:function(gt){isNaN(gt)||(Ae=parseFloat(gt))}});var Oe=Q||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Oe},set:function(gt){isNaN(gt)||(Oe=parseFloat(gt))}});var qe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return qe},set:function(gt){qe=gt.toString()}}),this},vo=function(O,Q,Ae,Oe){Xs.call(this,O,Q),this.type="rect";var qe=Ae||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return qe},set:function(St){isNaN(St)||(qe=parseFloat(St))}});var gt=Oe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return gt},set:function(St){isNaN(St)||(gt=parseFloat(St))}}),this},Sc=function(){this.page=or,this.currentPage=F,this.pages=Pe.slice(0),this.pagesContext=Ht.slice(0),this.x=wt,this.y=Lt,this.matrix=Pt,this.width=yo(F),this.height=Ru(F),this.outputDestination=st,this.id="",this.objectNumber=-1};Sc.prototype.restore=function(){or=this.page,F=this.currentPage,Ht=this.pagesContext,Pe=this.pages,wt=this.x,Lt=this.y,Pt=this.matrix,Pl(F,this.width),_o(F,this.height),st=this.outputDestination};var Ll=function(O,Q,Ae,Oe,qe){Oa.push(new Sc),or=F=0,Pe=[],wt=O,Lt=Q,Pt=qe,ca([Ae,Oe])};for(var xo in g.beginFormObject=function(O,Q,Ae,Oe,qe){return Ll(O,Q,Ae,Oe,qe),this},g.endFormObject=function(O){return(function(Q){if(Ct[Q])Oa.pop().restore();else{var Ae=new Sc,Oe="Xo"+(Object.keys(Na).length+1).toString(10);Ae.id=Oe,Ct[Q]=Oe,Na[Oe]=Ae,mr.publish("addFormObject",Ae),Oa.pop().restore()}})(O),this},g.doFormObject=function(O,Q){var Ae=Na[Ct[O]];return he("q"),he(Q.toString()+" cm"),he("/"+Ae.id+" Do"),he("Q"),this},g.getFormObject=function(O){var Q=Na[Ct[O]];return{x:Q.x,y:Q.y,width:Q.width,height:Q.height,matrix:Q.matrix}},g.save=function(O,Q){return O=O||"generated.pdf",(Q=Q||{}).returnPromise=Q.returnPromise||!1,Q.returnPromise===!1?(rf(el(zi()),O),typeof rf.unload=="function"&&kr.setTimeout&&setTimeout(rf.unload,911),this):new Promise(function(Ae,Oe){try{var qe=rf(el(zi()),O);typeof rf.unload=="function"&&kr.setTimeout&&setTimeout(rf.unload,911),Ae(qe)}catch(gt){Oe(gt.message)}})},ir.API)ir.API.hasOwnProperty(xo)&&(xo==="events"&&ir.API.events.length?(function(O,Q){var Ae,Oe,qe;for(qe=Q.length-1;qe!==-1;qe--)Ae=Q[qe][0],Oe=Q[qe][1],O.subscribe.apply(O,[Ae].concat(typeof Oe=="function"?[Oe]:Oe))})(mr,ir.API.events):g[xo]=ir.API[xo]);function yo(O){return Ht[O].mediaBox.topRightX-Ht[O].mediaBox.bottomLeftX}function Pl(O,Q){Ht[O].mediaBox.topRightX=Q+Ht[O].mediaBox.bottomLeftX}function Ru(O){return Ht[O].mediaBox.topRightY-Ht[O].mediaBox.bottomLeftY}function _o(O,Q){Ht[O].mediaBox.topRightY=Q+Ht[O].mediaBox.bottomLeftY}var bo=g.getPageWidth=function(O){return yo(O=O||F)/pt},$f=g.setPageWidth=function(O,Q){Pl(O,Q*pt)},wo=g.getPageHeight=function(O){return Ru(O=O||F)/pt},Wf=g.setPageHeight=function(O,Q){_o(O,Q*pt)};return g.internal={pdfEscape:Lr,getStyle:ju,getFont:yi,getFontSize:Xe,getCharSpace:bc,getTextColor:Hf,getLineHeight:qf,getLineHeightFactor:zf,getLineWidth:tl,write:at,getHorizontalCoordinate:Bs,getVerticalCoordinate:In,getCoordinateString:Ou,getVerticalCoordinateString:Dl,collections:{},newObject:Ut,newAdditionalObject:Se,newObjectDeferred:er,newObjectDeferredBegin:ae,getFilters:He,putStream:nt,events:mr,scaleFactor:pt,pageSize:{getWidth:function(){return bo(F)},setWidth:function(O){$f(F,O)},getHeight:function(){return wo(F)},setHeight:function(O){Wf(F,O)}},encryptionOptions:m,encryption:gn,getEncryptor:function(O){return m!==null?gn.encryptor(O,0):function(Q){return Q}},output:Nu,getNumberOfPages:Is,get pages(){return Pe},out:he,f2:D,f3:T,getPageInfo:an,getPageInfoByObjId:_c,getCurrentPageInfo:Mf,getPDFVersion:_,Point:Xs,Rectangle:vo,Matrix:ar,hasHotfix:cs},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return bo(F)},set:function(O){$f(F,O)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return wo(F)},set:function(O){Wf(F,O)},enumerable:!0,configurable:!0}),(function(O){for(var Q=0,Ae=ye.length;Q<Ae;Q++){var Oe=sa.call(this,O[Q][0],O[Q][1],O[Q][2],ye[Q][3],!0);v===!1&&(x[Oe]=!0);var qe=O[Q][0].split("-");Xt({id:Oe,fontName:qe[0],fontStyle:qe[1]||""})}mr.publish("addFonts",{fonts:zt,dictionary:Ce})}).call(g,ye),ft="F1",ls(n,r),mr.publish("initialized"),g}zd.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},zd.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},zd.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},zd.prototype.processOwnerPassword=function(t,e){return Lx(Fx(e).substr(0,5),t)},zd.prototype.encryptor=function(t,e){var r=Fx(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(a){return Lx(r,a)}},i1.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||pa(t)!==pa(this))return!1;var a=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;a++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&a--;return a===0},ir.API={events:[]},ir.version="3.0.4";var dn=ir.API,G2=1,Pf=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Md=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Cr=function(t){return t.toFixed(2)},au=function(t){return t.toFixed(5)};dn.__acroform__={};var mi=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},fS=function(t){return t*G2},wl=function(t){var e=new Yk,r=rr.internal.getHeight(t)||0,a=rr.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Cr(a)),Number(Cr(r))],e},fz=dn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},dz=dn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},hz=dn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Sn=dn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return hz(t,e-1)},Nn=dn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return fz(t,e-1)},kn=dn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return dz(t,e-1)},mz=dn.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,a=e.internal.getVerticalCoordinate,n=t[0],s=t[1],l=t[2],c=t[3],f={};return f.lowerLeft_X=r(n)||0,f.lowerLeft_Y=a(s+c)||0,f.upperRight_X=r(n+l)||0,f.upperRight_Y=a(s)||0,[Number(Cr(f.lowerLeft_X)),Number(Cr(f.lowerLeft_Y)),Number(Cr(f.upperRight_X)),Number(Cr(f.upperRight_Y))]},pz=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,a=Px(t,r),n=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+n+" "+Cr(a.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(a.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=wl(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},Px=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,a={text:"",fontSize:""},n=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");n=t.multiline?n.map(function(D){return D.split(`
`)}):n.map(function(D){return[D]});var s=r,l=rr.internal.getHeight(t)||0;l=l<0?-l:l;var c=rr.internal.getWidth(t)||0;c=c<0?-c:c;var f=function(D,T,M){if(D+1<n.length){var V=T+" "+n[D+1][0];return kp(V,t,M).width<=c-4}return!1};s++;e:for(;s>0;){e="",s--;var d,m,v=kp("3",t,s).height,x=t.multiline?l-s:(l-v)/2,g=x+=2,b=0,_=0,w=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+kp(e,t,s=12).width+", FieldWidth:"+c+`
`;break}for(var A="",C=0,E=0;E<n.length;E++)if(n.hasOwnProperty(E)){var R=!1;if(n[E].length!==1&&w!==n[E].length-1){if((v+2)*(C+2)+2>l)continue e;A+=n[E][w],R=!0,_=E,E--}else{A=(A+=n[E][w]+" ").substr(A.length-1)==" "?A.substr(0,A.length-1):A;var Y=parseInt(E),W=f(Y,A,s),B=E>=n.length-1;if(W&&!B){A+=" ",w=0;continue}if(W||B){if(B)_=Y;else if(t.multiline&&(v+2)*(C+2)+2>l)continue e}else{if(!t.multiline||(v+2)*(C+2)+2>l)continue e;_=Y}}for(var q="",L=b;L<=_;L++){var J=n[L];if(t.multiline){if(L===_){q+=J[w]+" ",w=(w+1)%J.length;continue}if(L===b){q+=J[J.length-1]+" ";continue}}q+=J[0]+" "}switch(q=q.substr(q.length-1)==" "?q.substr(0,q.length-1):q,m=kp(q,t,s).width,t.textAlign){case"right":d=c-m-2;break;case"center":d=(c-m)/2;break;default:d=2}e+=Cr(d)+" "+Cr(g)+` Td
`,e+="("+Pf(q)+`) Tj
`,e+=-Cr(d)+` 0 Td
`,g=-(s+2),m=0,b=R?_:_+1,C++,A=""}break}return a.text=e,a.fontSize=s,a},kp=function(t,e,r){var a=e.scope.internal.getFont(e.fontName,e.fontStyle),n=e.scope.getStringUnitWidth(t,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},gz={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},vz=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},xz=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Jo.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(gz)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");G2=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Xk,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var s=a[n];s.objId=void 0,s.hasAnnotation&&vz(s,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(a,n){var s=!a;for(var l in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(l)){var c=a[l],f=[],d=c.Rect;if(c.Rect&&(c.Rect=mz(c.Rect,n)),n.internal.newObjectDeferredBegin(c.objId,!0),c.DA=rr.createDefaultAppearanceStream(c),pa(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(f=c.getKeyValueListForStream()),c.Rect=d,c.hasAppearanceStream&&!c.appearanceStreamContent){var m=pz(c);f.push({key:"AP",value:"<</N "+m+">>"}),n.internal.acroformPlugin.xForms.push(m)}if(c.appearanceStreamContent){var v="";for(var x in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(x)){var g=c.appearanceStreamContent[x];if(v+="/"+x+" ",v+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var l in g)if(g.hasOwnProperty(l)){var b=g[l];typeof b=="function"&&(b=b.call(n,c)),v+="/"+l+" "+b+" ",n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b)}}else typeof(b=g)=="function"&&(b=b.call(n,c)),v+="/"+l+" "+b,n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b);v+=">>"}f.push({key:"AP",value:`<<
`+v+">>"})}n.internal.putStream({additionalKeyValues:f,objectId:c.objId}),n.internal.out("endobj")}s&&(function(_,w){for(var A in _)if(_.hasOwnProperty(A)){var C=A,E=_[A];w.internal.newObjectDeferredBegin(E.objId,!0),pa(E)==="object"&&typeof E.putStream=="function"&&E.putStream(),delete _[C]}})(n.internal.acroformPlugin.xForms,n)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},Gk=dn.__acroform__.arrayToPdfArray=function(t,e,r){var a=function(l){return l};if(Array.isArray(t)){for(var n="[",s=0;s<t.length;s++)switch(s!==0&&(n+=" "),pa(t[s])){case"boolean":case"number":case"object":n+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&r&&(a=r.internal.getEncryptor(e)),n+="("+Pf(a(t[s].toString()))+")"):n+=t[s].toString()}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Fv=function(t,e,r){var a=function(n){return n};return e!==void 0&&r&&(a=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Pf(a(t))+")"},jl=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};jl.prototype.toString=function(){return this.objId+" 0 R"},jl.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},jl.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var a=e[r],n=this[a];n&&(Array.isArray(n)?t.push({key:a,value:Gk(n,this.objId,this.scope)}):n instanceof jl?(n.scope=this.scope,t.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&t.push({key:a,value:n}))}return t};var Yk=function(){jl.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};mi(Yk,jl);var Xk=function(){jl.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Pf(r(t))+")"}},set:function(r){t=r}})};mi(Xk,jl);var Jo=function t(){jl.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(A){if(isNaN(A))throw new Error('Invalid value "'+A+'" for attribute F supplied.');e=A}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Sn(e,3)},set:function(A){A?this.F=Nn(e,3):this.F=kn(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(A){if(isNaN(A))throw new Error('Invalid value "'+A+'" for attribute Ff supplied.');r=A}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(A){a=A!==void 0?A:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(A){a[0]=A}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(A){a[1]=A}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(A){a[2]=A}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(A){a[3]=A}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(A){switch(A){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=A;break;default:throw new Error('Invalid value "'+A+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof o1)return;s="FieldObject"+t.FieldNum++}var A=function(C){return C};return this.scope&&(A=this.scope.internal.getEncryptor(this.objId)),"("+Pf(A(s))+")"},set:function(A){s=A.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(A){s=A}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(A){l=A}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(A){c=A}});var f=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return f},set:function(A){f=A}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/G2:d},set:function(A){d=A}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(A){m=A}});var v="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!v||this instanceof o1||this instanceof gf))return Fv(v,this.objId,this.scope)},set:function(A){A=A.toString(),v=A}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof ns==0?Fv(x,this.objId,this.scope):x},set:function(A){A=A.toString(),x=this instanceof ns==0?A.substr(0,1)==="("?Md(A.substr(1,A.length-2)):Md(A):A}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ns==1?Md(x.substr(1,x.length-1)):x},set:function(A){A=A.toString(),x=this instanceof ns==1?"/"+A:A}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(A){this.V=A}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof ns==0?Fv(g,this.objId,this.scope):g},set:function(A){A=A.toString(),g=this instanceof ns==0?A.substr(0,1)==="("?Md(A.substr(1,A.length-2)):Md(A):A}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ns==1?Md(g.substr(1,g.length-1)):g},set:function(A){A=A.toString(),g=this instanceof ns==1?"/"+A:A}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,_=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return _},set:function(A){A=!!A,_=A}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(A){b=A}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,1)},set:function(A){A?this.Ff=Nn(this.Ff,1):this.Ff=kn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,2)},set:function(A){A?this.Ff=Nn(this.Ff,2):this.Ff=kn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,3)},set:function(A){A?this.Ff=Nn(this.Ff,3):this.Ff=kn(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(A){if([0,1,2].indexOf(A)===-1)throw new Error('Invalid value "'+A+'" for attribute Q supplied.');w=A}}),Object.defineProperty(this,"textAlign",{get:function(){var A;switch(w){case 0:default:A="left";break;case 1:A="center";break;case 2:A="right"}return A},configurable:!0,enumerable:!0,set:function(A){switch(A){case"right":case 2:w=2;break;case"center":case 1:w=1;break;default:w=0}}})};mi(Jo,jl);var Qd=function(){Jo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Gk(e,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=(function(s,l,c){c||(c=1);for(var f,d=[];f=l.exec(s);)d.push(f[c]);return d})(a,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,18)},set:function(r){r?this.Ff=Nn(this.Ff,18):this.Ff=kn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Nn(this.Ff,19):this.Ff=kn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,20)},set:function(r){r?(this.Ff=Nn(this.Ff,20),e.sort()):this.Ff=kn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,22)},set:function(r){r?this.Ff=Nn(this.Ff,22):this.Ff=kn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,23)},set:function(r){r?this.Ff=Nn(this.Ff,23):this.Ff=kn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,27)},set:function(r){r?this.Ff=Nn(this.Ff,27):this.Ff=kn(this.Ff,27)}}),this.hasAppearanceStream=!1};mi(Qd,Jo);var eh=function(){Qd.call(this),this.fontName="helvetica",this.combo=!1};mi(eh,Qd);var th=function(){eh.call(this),this.combo=!0};mi(th,eh);var Fp=function(){th.call(this),this.edit=!0};mi(Fp,th);var ns=function(){Jo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,15)},set:function(r){r?this.Ff=Nn(this.Ff,15):this.Ff=kn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,16)},set:function(r){r?this.Ff=Nn(this.Ff,16):this.Ff=kn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,17)},set:function(r){r?this.Ff=Nn(this.Ff,17):this.Ff=kn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,26)},set:function(r){r?this.Ff=Nn(this.Ff,26):this.Ff=kn(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var a,n=[];for(a in n.push("<<"),e)n.push("/"+a+" ("+Pf(r(e[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){pa(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};mi(ns,Jo);var Lp=function(){ns.call(this),this.pushButton=!0};mi(Lp,ns);var rh=function(){ns.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};mi(rh,ns);var o1=function(){var t,e;Jo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(n){e=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(c){return c};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var s,l=[];for(s in l.push("<<"),a)l.push("/"+s+" ("+Pf(n(a[s]))+")");return l.push(">>"),l.join(`
`)},set:function(n){pa(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=rr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};mi(o1,Jo),rh.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},rh.prototype.createOption=function(t){var e=new o1;return e.Parent=this,e.optionName=t,this.Kids.push(e),yz.call(this.scope,e),e};var Pp=function(){ns.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=rr.CheckBox.createAppearanceStream()};mi(Pp,ns);var gf=function(){Jo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,13)},set:function(e){e?this.Ff=Nn(this.Ff,13):this.Ff=kn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,21)},set:function(e){e?this.Ff=Nn(this.Ff,21):this.Ff=kn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,23)},set:function(e){e?this.Ff=Nn(this.Ff,23):this.Ff=kn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,24)},set:function(e){e?this.Ff=Nn(this.Ff,24):this.Ff=kn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,25)},set:function(e){e?this.Ff=Nn(this.Ff,25):this.Ff=kn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,26)},set:function(e){e?this.Ff=Nn(this.Ff,26):this.Ff=kn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};mi(gf,Jo);var Mp=function(){gf.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Sn(this.Ff,14)},set:function(t){t?this.Ff=Nn(this.Ff,14):this.Ff=kn(this.Ff,14)}}),this.password=!0};mi(Mp,gf);var rr={CheckBox:{createAppearanceStream:function(){return{N:{On:rr.CheckBox.YesNormal},D:{On:rr.CheckBox.YesPushDown,Off:rr.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=wl(t);e.scope=t.scope;var r=[],a=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=Px(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Cr(rr.internal.getWidth(t))+" "+Cr(rr.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+Cr(s.fontSize)+" Tf "+n),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=wl(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),n=[],s=rr.internal.getHeight(t),l=rr.internal.getWidth(t),c=Px(t,t.caption);return n.push("1 g"),n.push("0 0 "+Cr(l)+" "+Cr(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+Cr(l-1)+" "+Cr(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+Cr(c.fontSize)+" Tf "+a),n.push(c.text),n.push("ET"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=wl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Cr(rr.internal.getWidth(t))+" "+Cr(rr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:rr.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=rr.RadioButton.Circle.YesNormal,e.D[t]=rr.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=wl(t);e.scope=t.scope;var r=[],a=rr.internal.getWidth(t)<=rr.internal.getHeight(t)?rr.internal.getWidth(t)/4:rr.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=rr.internal.Bezier_C,s=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+au(rr.internal.getWidth(t)/2)+" "+au(rr.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=wl(t);e.scope=t.scope;var r=[],a=rr.internal.getWidth(t)<=rr.internal.getHeight(t)?rr.internal.getWidth(t)/4:rr.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*rr.internal.Bezier_C).toFixed(5)),l=Number((a*rr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+au(rr.internal.getWidth(t)/2)+" "+au(rr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+au(rr.internal.getWidth(t)/2)+" "+au(rr.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+l+" "+l+" "+a+" 0 "+a+" c"),r.push("-"+l+" "+a+" -"+a+" "+l+" -"+a+" 0 c"),r.push("-"+a+" -"+l+" -"+l+" -"+a+" 0 -"+a+" c"),r.push(l+" -"+a+" "+a+" -"+l+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=wl(t);e.scope=t.scope;var r=[],a=rr.internal.getWidth(t)<=rr.internal.getHeight(t)?rr.internal.getWidth(t)/4:rr.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*rr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+au(rr.internal.getWidth(t)/2)+" "+au(rr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:rr.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=rr.RadioButton.Cross.YesNormal,e.D[t]=rr.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=wl(t);e.scope=t.scope;var r=[],a=rr.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Cr(rr.internal.getWidth(t)-2)+" "+Cr(rr.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Cr(a.x1.x)+" "+Cr(a.x1.y)+" m"),r.push(Cr(a.x2.x)+" "+Cr(a.x2.y)+" l"),r.push(Cr(a.x4.x)+" "+Cr(a.x4.y)+" m"),r.push(Cr(a.x3.x)+" "+Cr(a.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=wl(t);e.scope=t.scope;var r=rr.internal.calculateCross(t),a=[];return a.push("0.749023 g"),a.push("0 0 "+Cr(rr.internal.getWidth(t))+" "+Cr(rr.internal.getHeight(t))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Cr(rr.internal.getWidth(t)-2)+" "+Cr(rr.internal.getHeight(t)-2)+" re"),a.push("W"),a.push("n"),a.push(Cr(r.x1.x)+" "+Cr(r.x1.y)+" m"),a.push(Cr(r.x2.x)+" "+Cr(r.x2.y)+" l"),a.push(Cr(r.x4.x)+" "+Cr(r.x4.y)+" m"),a.push(Cr(r.x3.x)+" "+Cr(r.x3.y)+" l"),a.push("s"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(t){var e=wl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Cr(rr.internal.getWidth(t))+" "+Cr(rr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};rr.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=rr.internal.getWidth(t),r=rr.internal.getHeight(t),a=Math.min(e,r);return{x1:{x:(e-a)/2,y:(r-a)/2+a},x2:{x:(e-a)/2+a,y:(r-a)/2},x3:{x:(e-a)/2,y:(r-a)/2},x4:{x:(e-a)/2+a,y:(r-a)/2+a}}}},rr.internal.getWidth=function(t){var e=0;return pa(t)==="object"&&(e=fS(t.Rect[2])),e},rr.internal.getHeight=function(t){var e=0;return pa(t)==="object"&&(e=fS(t.Rect[3])),e};var yz=dn.addField=function(t){if(xz(this,t),!(t instanceof Jo))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};dn.AcroFormChoiceField=Qd,dn.AcroFormListBox=eh,dn.AcroFormComboBox=th,dn.AcroFormEditBox=Fp,dn.AcroFormButton=ns,dn.AcroFormPushButton=Lp,dn.AcroFormRadioButton=rh,dn.AcroFormCheckBox=Pp,dn.AcroFormTextField=gf,dn.AcroFormPasswordField=Mp,dn.AcroFormAppearance=rr,dn.AcroForm={ChoiceField:Qd,ListBox:eh,ComboBox:th,EditBox:Fp,Button:ns,PushButton:Lp,RadioButton:rh,CheckBox:Pp,TextField:gf,PasswordField:Mp,Appearance:rr},ir.AcroForm={ChoiceField:Qd,ListBox:eh,ComboBox:th,EditBox:Fp,Button:ns,PushButton:Lp,RadioButton:rh,CheckBox:Pp,TextField:gf,PasswordField:Mp,Appearance:rr};ir.AcroForm;function Kk(t){return t.reduce(function(e,r,a){return e[r]=a,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(D,T){var M,V,ie,X,Z,K=r;if((T=T||r)==="RGBA"||D.data!==void 0&&D.data instanceof Uint8ClampedArray&&"height"in D&&"width"in D)return"RGBA";if(W(D))for(Z in a)for(ie=a[Z],M=0;M<ie.length;M+=1){for(X=!0,V=0;V<ie[M].length;V+=1)if(ie[M][V]!==void 0&&ie[M][V]!==D[V]){X=!1;break}if(X===!0){K=Z;break}}else for(Z in a)for(ie=a[Z],M=0;M<ie.length;M+=1){for(X=!0,V=0;V<ie[M].length;V+=1)if(ie[M][V]!==void 0&&ie[M][V]!==D.charCodeAt(V)){X=!1;break}if(X===!0){K=Z;break}}return K===r&&T!==r&&(K=T),K},s=function D(T){for(var M=this.internal.write,V=this.internal.putStream,ie=(0,this.internal.getFilters)();ie.indexOf("FlateEncode")!==-1;)ie.splice(ie.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var X=[];if(X.push({key:"Type",value:"/XObject"}),X.push({key:"Subtype",value:"/Image"}),X.push({key:"Width",value:T.width}),X.push({key:"Height",value:T.height}),T.colorSpace===A.INDEXED?X.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(X.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===A.DEVICE_CMYK&&X.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),X.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&X.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var Z="",K=0,re=T.transparency.length;K<re;K++)Z+=T.transparency[K]+" "+T.transparency[K]+" ";X.push({key:"Mask",value:"["+Z+"]"})}T.sMask!==void 0&&X.push({key:"SMask",value:T.objectId+1+" 0 R"});var de=T.filter!==void 0?["/"+T.filter]:void 0;if(V({data:T.data,additionalKeyValues:X,alreadyAppliedFilters:de,objectId:T.objectId}),M("endobj"),"sMask"in T&&T.sMask!==void 0){var U,k=(U=T.sMaskBitsPerComponent)!==null&&U!==void 0?U:T.bitsPerComponent,F={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:k,data:T.sMask};"filter"in T&&(F.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(k," /Columns ").concat(T.width),F.filter=T.filter),D.call(this,F)}if(T.colorSpace===A.INDEXED){var I=this.internal.newObject();V({data:q(new Uint8Array(T.palette)),objectId:I}),M("endobj")}},l=function(){var D=this.internal.collections[e+"images"];for(var T in D)s.call(this,D[T])},c=function(){var D,T=this.internal.collections[e+"images"],M=this.internal.write;for(var V in T)M("/I"+(D=T[V]).index,D.objectId,"0","R")},f=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",c))},d=function(){var D=this.internal.collections[e+"images"];return f.call(this),D},m=function(){return Object.keys(this.internal.collections[e+"images"]).length},v=function(D){return typeof t["process"+D.toUpperCase()]=="function"},x=function(D){return pa(D)==="object"&&D.nodeType===1},g=function(D,T){if(D.nodeName==="IMG"&&D.hasAttribute("src")){var M=""+D.getAttribute("src");if(M.indexOf("data:image/")===0)return Dp(unescape(M).split("base64,").pop());var V=t.loadFile(M,!0);if(V!==void 0)return V}if(D.nodeName==="CANVAS"){if(D.width===0||D.height===0)throw new Error("Given canvas must have data. Canvas width: "+D.width+", height: "+D.height);var ie;switch(T){case"PNG":ie="image/png";break;case"WEBP":ie="image/webp";break;default:ie="image/jpeg"}return Dp(D.toDataURL(ie,1).split("base64,").pop())}},b=function(D){var T=this.internal.collections[e+"images"];if(T){for(var M in T)if(D===T[M].alias)return T[M]}},_=function(D,T,M){return D||T||(D=-96,T=-96),D<0&&(D=-1*M.width*72/D/this.internal.scaleFactor),T<0&&(T=-1*M.height*72/T/this.internal.scaleFactor),D===0&&(D=T*M.width/M.height),T===0&&(T=D*M.height/M.width),[D,T]},w=function(D,T,M,V,ie,X){var Z=_.call(this,M,V,ie),K=this.internal.getCoordinateString,re=this.internal.getVerticalCoordinateString,de=d.call(this);if(M=Z[0],V=Z[1],de[ie.index]=ie,X){X*=Math.PI/180;var U=Math.cos(X),k=Math.sin(X),F=function(z){return z.toFixed(4)},I=[F(U),F(k),F(-1*k),F(U),0,0,"cm"]}this.internal.write("q"),X?(this.internal.write([1,"0","0",1,K(D),re(T+V),"cm"].join(" ")),this.internal.write(I.join(" ")),this.internal.write([K(M),"0","0",K(V),"0","0","cm"].join(" "))):this.internal.write([K(M),"0","0",K(V),K(D),re(T+V),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ie.index+" Do"),this.internal.write("Q")},A=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var C=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},E=t.__addimage__.sHashCode=function(D){var T,M,V=0;if(typeof D=="string")for(M=D.length,T=0;T<M;T++)V=(V<<5)-V+D.charCodeAt(T),V|=0;else if(W(D))for(M=D.byteLength/2,T=0;T<M;T++)V=(V<<5)-V+D[T],V|=0;return V},R=t.__addimage__.validateStringAsBase64=function(D){(D=D||"").toString().trim();var T=!0;return D.length===0&&(T=!1),D.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(D.substr(0,D.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(D.substr(-2))===!1&&(T=!1),T},Y=t.__addimage__.extractImageFromDataUrl=function(D){if(D==null||!(D=D.trim()).startsWith("data:"))return null;var T=D.indexOf(",");return T<0?null:D.substring(0,T).trim().endsWith("base64")?D.substring(T+1):null};t.__addimage__.isArrayBuffer=function(D){return D instanceof ArrayBuffer};var W=t.__addimage__.isArrayBufferView=function(D){return D instanceof Int8Array||D instanceof Uint8Array||D instanceof Uint8ClampedArray||D instanceof Int16Array||D instanceof Uint16Array||D instanceof Int32Array||D instanceof Uint32Array||D instanceof Float32Array||D instanceof Float64Array},B=t.__addimage__.binaryStringToUint8Array=function(D){for(var T=D.length,M=new Uint8Array(T),V=0;V<T;V++)M[V]=D.charCodeAt(V);return M},q=t.__addimage__.arrayBufferToBinaryString=function(D){for(var T="",M=W(D)?D:new Uint8Array(D),V=0;V<M.length;V+=8192)T+=String.fromCharCode.apply(null,M.subarray(V,V+8192));return T};t.addImage=function(){var D,T,M,V,ie,X,Z,K,re;if(typeof arguments[1]=="number"?(T=r,M=arguments[1],V=arguments[2],ie=arguments[3],X=arguments[4],Z=arguments[5],K=arguments[6],re=arguments[7]):(T=arguments[1],M=arguments[2],V=arguments[3],ie=arguments[4],X=arguments[5],Z=arguments[6],K=arguments[7],re=arguments[8]),pa(D=arguments[0])==="object"&&!x(D)&&"imageData"in D){var de=D;D=de.imageData,T=de.format||T||r,M=de.x||M||0,V=de.y||V||0,ie=de.w||de.width||ie,X=de.h||de.height||X,Z=de.alias||Z,K=de.compression||K,re=de.rotation||de.angle||re}var U=this.internal.getFilters();if(K===void 0&&U.indexOf("FlateEncode")!==-1&&(K="SLOW"),isNaN(M)||isNaN(V))throw new Error("Invalid coordinates passed to jsPDF.addImage");f.call(this);var k=L.call(this,D,T,Z,K);return w.call(this,M,V,ie,X,k,re),this};var L=function(D,T,M,V){var ie,X,Z;if(typeof D=="string"&&n(D)===r){D=unescape(D);var K=J(D,!1);(K!==""||(K=t.loadFile(D,!0))!==void 0)&&(D=K)}if(x(D)&&(D=g(D,T)),T=n(D,T),!v(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((Z=M)==null||Z.length===0)&&(M=(function(re){return typeof re=="string"||W(re)?E(re):W(re.data)?E(re.data):null})(D)),(ie=b.call(this,M))||(D instanceof Uint8Array||T==="RGBA"||(X=D,D=B(D)),ie=this["process"+T.toUpperCase()](D,m.call(this),M,(function(re){return re&&typeof re=="string"&&(re=re.toUpperCase()),re in t.image_compression?re:C.NONE})(V),X)),!ie)throw new Error("An unknown error occurred whilst processing the image.");return ie},J=t.__addimage__.convertBase64ToBinaryString=function(D,T){T=typeof T!="boolean"||T;var M,V="";if(typeof D=="string"){var ie;M=(ie=Y(D))!==null&&ie!==void 0?ie:D;try{V=Dp(M)}catch(X){if(T)throw R(M)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+X.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return V};t.getImageProperties=function(D){var T,M,V="";if(x(D)&&(D=g(D)),typeof D=="string"&&n(D)===r&&((V=J(D,!1))===""&&(V=t.loadFile(D)||""),D=V),M=n(D),!v(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(D instanceof Uint8Array||(D=B(D)),!(T=this["process"+M.toUpperCase()](D)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=M,T}})(ir.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};ir.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var a,n,s,l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,f=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,m=!1,v=0;v<d.length&&!m;v++)switch((a=d[v]).type){case"link":(e(a.options.url)||e(a.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var x=0;x<d.length;x++){a=d[x];var g=this.internal.pdfEscape,b=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var _=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),A=this.internal.getEncryptor(_.objId),C=a.title||"Note";s="<</Type /Annot /Subtype /Text "+(n="/Rect ["+l(a.bounds.x)+" "+c(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y)+"] ")+"/Contents ("+g(A(a.contents))+")",s+=" /Popup "+w.objId+" 0 R",s+=" /P "+f.objId+" 0 R",s+=" /T ("+g(A(C))+") >>",_.content=s;var E=_.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+l(a.bounds.x+30)+" "+c(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w+30)+" "+c(a.bounds.y)+"] ")+" /Parent "+E,a.open&&(s+=" /Open true"),s+=" >>",w.content=s,this.internal.write(_.objId,"0 R",w.objId,"0 R");break;case"freetext":n="/Rect ["+l(a.bounds.x)+" "+c(a.bounds.y)+" "+l(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y+a.bounds.h)+"] ";var R=a.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+g(b(a.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+R+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(a.options.name){var Y=this.annotations._nameMap[a.options.name];a.options.pageNumber=Y.page,a.options.top=Y.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",s="",a.options.url)s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+g(b(a.options.url))+") >>";else if(a.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,s+=" /FitV "+a.options.left+"]";break;default:var W=c(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),s+=" /XYZ "+a.options.left+" "+W+" "+a.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},t.link=function(r,a,n,s,l){var c=this.internal.getCurrentPageInfo(),f=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:f(r),y:d(a),w:f(r+n),h:d(a+s)},options:l,type:"link"})},t.textWithLink=function(r,a,n,s){var l,c,f=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){c=s.maxWidth;var m=this.splitTextToSize(r,c).length;l=Math.ceil(d*m)}else c=f,l=d;return this.text(r,a,n,s),n+=.2*d,s.align==="center"&&(a-=f/2),s.align==="right"&&(a-=f),this.link(a,n-d,c,l,s),f},t.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}})(ir.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(_){return e[_.charCodeAt(0)]!==void 0},l=t.__arabicParser__.isArabicLetter=function(_){return typeof _=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(_)},c=t.__arabicParser__.isArabicEndLetter=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length<=2},f=t.__arabicParser__.isArabicAlfLetter=function(_){return l(_)&&n.indexOf(_.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length>=3};var m=t.__arabicParser__.arabicLetterHasMedialForm=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length==4},v=t.__arabicParser__.resolveLigatures=function(_){var w=0,A=r,C="",E=0;for(w=0;w<_.length;w+=1)A[_.charCodeAt(w)]!==void 0?(E++,typeof(A=A[_.charCodeAt(w)])=="number"&&(C+=String.fromCharCode(A),A=r,E=0),w===_.length-1&&(A=r,C+=_.charAt(w-(E-1)),w-=E-1,E=0)):(A=r,C+=_.charAt(w-E),w-=E,E=0);return C};t.__arabicParser__.isArabicDiacritic=function(_){return _!==void 0&&a[_.charCodeAt(0)]!==void 0};var x=t.__arabicParser__.getCorrectForm=function(_,w,A){return l(_)?s(_)===!1?-1:!d(_)||!l(w)&&!l(A)||!l(A)&&c(w)||c(_)&&!l(w)||c(_)&&f(w)||c(_)&&c(w)?0:m(_)&&l(w)&&!c(w)&&l(A)&&d(A)?3:c(_)||!l(A)?1:2:-1},g=function(_){var w=0,A=0,C=0,E="",R="",Y="",W=(_=_||"").split("\\s+"),B=[];for(w=0;w<W.length;w+=1){for(B.push(""),A=0;A<W[w].length;A+=1)E=W[w][A],R=W[w][A-1],Y=W[w][A+1],l(E)?(C=x(E,R,Y),B[w]+=C!==-1?String.fromCharCode(e[E.charCodeAt(0)][C]):E):B[w]+=E;B[w]=v(B[w])}return B.join(" ")},b=t.__arabicParser__.processArabic=t.processArabic=function(){var _,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,A=[];if(Array.isArray(w)){var C=0;for(A=[],C=0;C<w.length;C+=1)Array.isArray(w[C])?A.push([g(w[C][0]),w[C][1],w[C][2]]):A.push([g(w[C])]);_=A}else _=g(w);return typeof arguments[0]=="string"?_:(arguments[0].text=_,arguments[0])};t.events.push(["preProcessText",b])})(ir.API),ir.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(c){r=c}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(c){a=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(c){s=c}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(c){l=c}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(ir.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var f=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return f},set:function(_){f=_}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(_){d=_}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(_){m=_}});var v=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return v},set:function(_){v=_}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(_){x=_}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(_){g=_}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(_){b=_}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(f){return a.call(this),this.internal.__cell__.headerFunction=typeof f=="function"?f:void 0,this},t.getTextDimensions=function(f,d){a.call(this);var m=(d=d||{}).fontSize||this.getFontSize(),v=d.font||this.getFont(),x=d.scaleFactor||this.internal.scaleFactor,g=0,b=0,_=0,w=this;if(!Array.isArray(f)&&typeof f!="string"){if(typeof f!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");f=String(f)}var A=d.maxWidth;A>0?typeof f=="string"?f=this.splitTextToSize(f,A):Object.prototype.toString.call(f)==="[object Array]"&&(f=f.reduce(function(E,R){return E.concat(w.splitTextToSize(R,A))},[])):f=Array.isArray(f)?f:[f];for(var C=0;C<f.length;C++)g<(_=this.getStringUnitWidth(f[C],{font:v})*m)&&(g=_);return g!==0&&(b=f.length),{w:g/=x,h:Math.max((b*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/x,0)}},t.cellAddPage=function(){a.call(this),this.addPage();var f=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(f.left,f.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=t.cell=function(){var f;f=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),a.call(this);var d=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,v=this.internal.__cell__.margins||e,x=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===f.lineNumber?(f.x=(d.x||0)+(d.width||0),f.y=d.y||0):d.y+d.height+f.height+v.bottom>this.getPageHeight()?(this.cellAddPage(),f.y=v.top,g&&x&&(this.printHeaderRow(f.lineNumber,!0),f.y+=x[0].height)):f.y=d.y+d.height||f.y),f.text[0]!==void 0&&(this.rect(f.x,f.y,f.width,f.height,r===!0?"FD":void 0),f.align==="right"?this.text(f.text,f.x+f.width-m,f.y+m,{align:"right",baseline:"top"}):f.align==="center"?this.text(f.text,f.x+f.width/2,f.y+m,{align:"center",baseline:"top",maxWidth:f.width-m-m}):this.text(f.text,f.x+m,f.y+m,{align:"left",baseline:"top",maxWidth:f.width-m-m})),this.internal.__cell__.lastCell=f,this};t.table=function(f,d,m,v,x){if(a.call(this),!m)throw new Error("No data for PDF table.");var g,b,_,w,A=[],C=[],E=[],R={},Y={},W=[],B=[],q=(x=x||{}).autoSize||!1,L=x.printHeaders!==!1,J=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,D=x.margins||Object.assign({width:this.getPageWidth()},e),T=typeof x.padding=="number"?x.padding:3,M=x.headerBackgroundColor||"#c8c8c8",V=x.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=L,this.internal.__cell__.margins=D,this.internal.__cell__.table_font_size=J,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=M,this.internal.__cell__.headerTextColor=V,this.setFontSize(J),v==null)C=A=Object.keys(m[0]),E=A.map(function(){return"left"});else if(Array.isArray(v)&&pa(v[0])==="object")for(A=v.map(function(de){return de.name}),C=v.map(function(de){return de.prompt||de.name||""}),E=v.map(function(de){return de.align||"left"}),g=0;g<v.length;g+=1)Y[v[g].name]=.7499990551181103*v[g].width;else Array.isArray(v)&&typeof v[0]=="string"&&(C=A=v,E=A.map(function(){return"left"}));if(q||Array.isArray(v)&&typeof v[0]=="string")for(g=0;g<A.length;g+=1){for(R[w=A[g]]=m.map(function(de){return de[w]}),this.setFont(void 0,"bold"),W.push(this.getTextDimensions(C[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=R[w],this.setFont(void 0,"normal"),_=0;_<b.length;_+=1)W.push(this.getTextDimensions(b[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Y[w]=Math.max.apply(null,W)+T+T,W=[]}if(L){var ie={};for(g=0;g<A.length;g+=1)ie[A[g]]={},ie[A[g]].text=C[g],ie[A[g]].align=E[g];var X=c.call(this,ie,Y);B=A.map(function(de){return new s(f,d,Y[de],X,ie[de].text,void 0,ie[de].align)}),this.setTableHeaderRow(B),this.printHeaderRow(1,!1)}var Z=v.reduce(function(de,U){return de[U.name]=U.align,de},{});for(g=0;g<m.length;g+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:g,data:m[g]},this);var K=c.call(this,m[g],Y);for(_=0;_<A.length;_+=1){var re=m[g][A[_]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:g,col:_,data:re},this),l.call(this,new s(f,d,Y[A[_]],K,re,g+2,Z[A[_]]))}}return this.internal.__cell__.table_x=f,this.internal.__cell__.table_y=d,this};var c=function(f,d){var m=this.internal.__cell__.padding,v=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(f).map(function(g){var b=f[g];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,d[g]-m-m)},this).map(function(g){return this.getLineHeightFactor()*g.length*v/x+m+m},this).reduce(function(g,b){return Math.max(g,b)},0)};t.setTableHeaderRow=function(f){a.call(this),this.internal.__cell__.tableHeaderRow=f},t.printHeaderRow=function(f,d){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var v=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(v[0],v[1],v[2],v[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){m=this.internal.__cell__.tableHeaderRow[g].clone(),d&&(m.y=this.internal.__cell__.margins.top||0,x.push(m)),m.lineNumber=f;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,m),this.setTextColor(b)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),r=!1}})(ir.API);var Jk={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Zk=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Mx=Kk(Zk),Qk=[100,200,300,400,500,600,700,800,900],_z=Kk(Qk);function Lv(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(s){return Jk[s=s||"normal"]?s:"normal"})(t.style),a=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(t.weight),n=(function(s){return typeof Mx[s=s||"normal"]=="number"?s:"normal"})(t.stretch);return{family:e,style:r,weight:a,stretch:n,src:t.src||[],ref:t.ref||{name:e,style:[n,r,a].join(" ")}}}function dS(t,e,r,a){var n;for(n=r;n>=0&&n<e.length;n+=a)if(t[e[n]])return t[e[n]];for(n=r;n>=0&&n<e.length;n-=a)if(t[e[n]])return t[e[n]]}var bz={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},hS={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function mS(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function pS(t){return t.trimLeft()}function wz(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function Sz(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var jp,gS,vS,Id,Ep,xS,yS,_S,Pv=["times"];function bS(t,e,r,a,n){var s=4,l=SS;switch(n){case ir.API.image_compression.FAST:s=1,l=wS;break;case ir.API.image_compression.MEDIUM:s=6,l=NS;break;case ir.API.image_compression.SLOW:s=9,l=kS}t=(function(f,d,m,v){for(var x,g=f.length/d,b=new Uint8Array(f.length+g),_=[Nz,wS,SS,NS,kS],w=0;w<g;w+=1){var A=w*d,C=f.subarray(A,A+d);if(v)b.set(v(C,m,x),A+w);else{for(var E=_.length,R=[],Y=0;Y<E;Y+=1)R[Y]=_[Y](C,m,x);var W=jz(R.concat());b.set(R[W],A+w)}x=C}return b})(t,e,Math.ceil(r*a/8),l);var c=Tx(t,{level:s});return ir.API.__addimage__.arrayBufferToBinaryString(c)}function Nz(t){var e=Array.apply([],t);return e.unshift(0),e}function wS(t,e){var r=t.length,a=[];a[0]=1;for(var n=0;n<r;n+=1){var s=t[n-e]||0;a[n+1]=t[n]-s+256&255}return a}function SS(t,e,r){var a=t.length,n=[];n[0]=2;for(var s=0;s<a;s+=1){var l=r&&r[s]||0;n[s+1]=t[s]-l+256&255}return n}function NS(t,e,r){var a=t.length,n=[];n[0]=3;for(var s=0;s<a;s+=1){var l=t[s-e]||0,c=r&&r[s]||0;n[s+1]=t[s]+256-(l+c>>>1)&255}return n}function kS(t,e,r){var a=t.length,n=[];n[0]=4;for(var s=0;s<a;s+=1){var l=kz(t[s-e]||0,r&&r[s]||0,r&&r[s-e]||0);n[s+1]=t[s]-l+256&255}return n}function kz(t,e,r){if(t===e&&e===r)return t;var a=Math.abs(e-r),n=Math.abs(t-r),s=Math.abs(t+e-r-r);return a<=n&&a<=s?t:n<=s?e:r}function jz(t){var e=t.map(function(r){return r.reduce(function(a,n){return a+Math.abs(n)},0)});return e.indexOf(Math.min.apply(null,e))}function Mv(t,e,r){var a=e*r,n=Math.floor(a/8),s=16-(a-8*n+r),l=(1<<r)-1;return ej(t,n)>>s&l}function jS(t,e,r,a){var n=r*a,s=Math.floor(n/8),l=16-(n-8*s+a),c=(1<<a)-1,f=(e&c)<<l;(function(d,m,v){if(m+1<d.byteLength)d.setUint16(m,v,!1);else{var x=v>>8&255;d.setUint8(m,x)}})(t,s,ej(t,s)&~(c<<l)&65535|f)}function ej(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function Ez(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,a=t[e++]|t[e++]<<8,n=t[e++],s=n>>7,l=1<<1+(7&n);t[e++],t[e++];var c=null,f=null;s&&(c=e,f=l,e+=3*l);var d=!0,m=[],v=0,x=null,g=0,b=null;for(this.width=r,this.height=a;d&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,b=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((D=t[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var _=t[e++];v=t[e++]|t[e++]<<8,x=t[e++],1&_||(x=null),g=_>>2&7,e++;break;case 254:for(;;){if(!((D=t[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var w=t[e++]|t[e++]<<8,A=t[e++]|t[e++]<<8,C=t[e++]|t[e++]<<8,E=t[e++]|t[e++]<<8,R=t[e++],Y=R>>6&1,W=1<<1+(7&R),B=c,q=f,L=!1;R>>7&&(L=!0,B=e,q=W,e+=3*W);var J=e;for(e++;;){var D;if(!((D=t[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}m.push({x:w,y:A,width:C,height:E,has_local_palette:L,palette_offset:B,palette_size:q,data_offset:J,data_length:e-J,transparent_index:x,interlaced:!!Y,delay:v,disposal:g});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return b},this.frameInfo=function(T){if(T<0||T>=m.length)throw new Error("Frame index out of range.");return m[T]},this.decodeAndBlitFrameBGRA=function(T,M){var V=this.frameInfo(T),ie=V.width*V.height,X=new Uint8Array(ie);ES(t,V.data_offset,X,ie);var Z=V.palette_offset,K=V.transparent_index;K===null&&(K=256);var re=V.width,de=r-re,U=re,k=4*(V.y*r+V.x),F=4*((V.y+V.height)*r+V.x),I=k,z=4*de;V.interlaced===!0&&(z+=4*r*7);for(var te=8,se=0,pe=X.length;se<pe;++se){var ve=X[se];if(U===0&&(U=re,(I+=z)>=F&&(z=4*de+4*r*(te-1),I=k+(re+de)*(te<<1),te>>=1)),ve===K)I+=4;else{var _e=t[Z+3*ve],Pe=t[Z+3*ve+1],fe=t[Z+3*ve+2];M[I++]=fe,M[I++]=Pe,M[I++]=_e,M[I++]=255}--U}},this.decodeAndBlitFrameRGBA=function(T,M){var V=this.frameInfo(T),ie=V.width*V.height,X=new Uint8Array(ie);ES(t,V.data_offset,X,ie);var Z=V.palette_offset,K=V.transparent_index;K===null&&(K=256);var re=V.width,de=r-re,U=re,k=4*(V.y*r+V.x),F=4*((V.y+V.height)*r+V.x),I=k,z=4*de;V.interlaced===!0&&(z+=4*r*7);for(var te=8,se=0,pe=X.length;se<pe;++se){var ve=X[se];if(U===0&&(U=re,(I+=z)>=F&&(z=4*de+4*r*(te-1),I=k+(re+de)*(te<<1),te>>=1)),ve===K)I+=4;else{var _e=t[Z+3*ve],Pe=t[Z+3*ve+1],fe=t[Z+3*ve+2];M[I++]=_e,M[I++]=Pe,M[I++]=fe,M[I++]=255}--U}}}function ES(t,e,r,a){for(var n=t[e++],s=1<<n,l=s+1,c=l+1,f=n+1,d=(1<<f)-1,m=0,v=0,x=0,g=t[e++],b=new Int32Array(4096),_=null;;){for(;m<16&&g!==0;)v|=t[e++]<<m,m+=8,g===1?g=t[e++]:--g;if(m<f)break;var w=v&d;if(v>>=f,m-=f,w!==s){if(w===l)break;for(var A=w<c?w:_,C=0,E=A;E>s;)E=b[E]>>8,++C;var R=E;if(x+C+(A!==w?1:0)>a)return void Aa.log("Warning, gif stream longer than expected.");r[x++]=R;var Y=x+=C;for(A!==w&&(r[x++]=R),E=A;C--;)E=b[E],r[--Y]=255&E,E>>=8;_!==null&&c<4096&&(b[c++]=_<<8|R,c>=d+1&&f<12&&(++f,d=d<<1|1)),_=w}else c=l+1,d=(1<<(f=n+1))-1,_=null}return x!==a&&Aa.log("Warning, gif stream shorter than expected."),r}function Iv(t){var e,r,a,n,s,l=Math.floor,c=new Array(64),f=new Array(64),d=new Array(64),m=new Array(64),v=new Array(65535),x=new Array(65535),g=new Array(64),b=new Array(64),_=[],w=0,A=7,C=new Array(64),E=new Array(64),R=new Array(64),Y=new Array(256),W=new Array(2048),B=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],q=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],D=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],V=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ie=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function X(k,F){for(var I=0,z=0,te=new Array,se=1;se<=16;se++){for(var pe=1;pe<=k[se];pe++)te[F[z]]=[],te[F[z]][0]=I,te[F[z]][1]=se,z++,I++;I*=2}return te}function Z(k){for(var F=k[0],I=k[1]-1;I>=0;)F&1<<I&&(w|=1<<A),I--,--A<0&&(w==255?(K(255),K(0)):K(w),A=7,w=0)}function K(k){_.push(k)}function re(k){K(k>>8&255),K(255&k)}function de(k,F,I,z,te){for(var se,pe=te[0],ve=te[240],_e=(function(Be,Et){var Xe,lt,jt,Dt,Wt,et,ht,yt,ft,pt,wt=0;for(ft=0;ft<8;++ft){Xe=Be[wt],lt=Be[wt+1],jt=Be[wt+2],Dt=Be[wt+3],Wt=Be[wt+4],et=Be[wt+5],ht=Be[wt+6];var Lt=Xe+(yt=Be[wt+7]),Pt=Xe-yt,zt=lt+ht,Ce=lt-ht,Ve=jt+et,ce=jt-et,Re=Dt+Wt,Me=Dt-Wt,Tt=Lt+Re,$t=Lt-Re,or=zt+Ve,Ht=zt-Ve;Be[wt]=Tt+or,Be[wt+4]=Tt-or;var mr=.707106781*(Ht+$t);Be[wt+2]=$t+mr,Be[wt+6]=$t-mr;var Ca=.382683433*((Tt=Me+ce)-(Ht=Ce+Pt)),Na=.5411961*Tt+Ca,Ct=1.306562965*Ht+Ca,Oa=.707106781*(or=ce+Ce),ar=Pt+Oa,za=Pt-Oa;Be[wt+5]=za+Na,Be[wt+3]=za-Na,Be[wt+1]=ar+Ct,Be[wt+7]=ar-Ct,wt+=8}for(wt=0,ft=0;ft<8;++ft){Xe=Be[wt],lt=Be[wt+8],jt=Be[wt+16],Dt=Be[wt+24],Wt=Be[wt+32],et=Be[wt+40],ht=Be[wt+48];var os=Xe+(yt=Be[wt+56]),rn=Xe-yt,Mn=lt+ht,Ut=lt-ht,er=jt+et,ae=jt-et,Se=Dt+Wt,ge=Dt-Wt,xe=os+Se,Ne=os-Se,ke=Mn+er,He=Mn-er;Be[wt]=xe+ke,Be[wt+32]=xe-ke;var nt=.707106781*(He+Ne);Be[wt+16]=Ne+nt,Be[wt+48]=Ne-nt;var Ge=.382683433*((xe=ge+ae)-(He=Ut+rn)),Ye=.5411961*xe+Ge,Je=1.306562965*He+Ge,kt=.707106781*(ke=ae+Ut),Rt=rn+kt,qt=rn-kt;Be[wt+40]=qt+Ye,Be[wt+24]=qt-Ye,Be[wt+8]=Rt+Je,Be[wt+56]=Rt-Je,wt++}for(ft=0;ft<64;++ft)pt=Be[ft]*Et[ft],g[ft]=pt>0?pt+.5|0:pt-.5|0;return g})(k,F),Pe=0;Pe<64;++Pe)b[B[Pe]]=_e[Pe];var fe=b[0]-I;I=b[0],fe==0?Z(z[0]):(Z(z[x[se=32767+fe]]),Z(v[se]));for(var st=63;st>0&&b[st]==0;)st--;if(st==0)return Z(pe),I;for(var mt,he=1;he<=st;){for(var at=he;b[he]==0&&he<=st;)++he;var we=he-at;if(we>=16){mt=we>>4;for(var ye=1;ye<=mt;++ye)Z(ve);we&=15}se=32767+b[he],Z(te[(we<<4)+x[se]]),Z(v[se]),he++}return st!=63&&Z(pe),I}function U(k){k=Math.min(Math.max(k,1),100),s!=k&&((function(F){for(var I=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],z=0;z<64;z++){var te=l((I[z]*F+50)/100);te=Math.min(Math.max(te,1),255),c[B[z]]=te}for(var se=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],pe=0;pe<64;pe++){var ve=l((se[pe]*F+50)/100);ve=Math.min(Math.max(ve,1),255),f[B[pe]]=ve}for(var _e=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Pe=0,fe=0;fe<8;fe++)for(var st=0;st<8;st++)d[Pe]=1/(c[B[Pe]]*_e[fe]*_e[st]*8),m[Pe]=1/(f[B[Pe]]*_e[fe]*_e[st]*8),Pe++})(k<50?Math.floor(5e3/k):Math.floor(200-2*k)),s=k)}this.encode=function(k,F){F&&U(F),_=new Array,w=0,A=7,re(65496),re(65504),re(16),K(74),K(70),K(73),K(70),K(0),K(1),K(1),K(0),re(1),re(1),K(0),K(0),(function(){re(65499),re(132),K(0);for(var lt=0;lt<64;lt++)K(c[lt]);K(1);for(var jt=0;jt<64;jt++)K(f[jt])})(),(function(lt,jt){re(65472),re(17),K(8),re(jt),re(lt),K(3),K(1),K(17),K(0),K(2),K(17),K(1),K(3),K(17),K(1)})(k.width,k.height),(function(){re(65476),re(418),K(0);for(var lt=0;lt<16;lt++)K(q[lt+1]);for(var jt=0;jt<=11;jt++)K(L[jt]);K(16);for(var Dt=0;Dt<16;Dt++)K(J[Dt+1]);for(var Wt=0;Wt<=161;Wt++)K(D[Wt]);K(1);for(var et=0;et<16;et++)K(T[et+1]);for(var ht=0;ht<=11;ht++)K(M[ht]);K(17);for(var yt=0;yt<16;yt++)K(V[yt+1]);for(var ft=0;ft<=161;ft++)K(ie[ft])})(),re(65498),re(12),K(3),K(1),K(0),K(2),K(17),K(3),K(17),K(0),K(63),K(0);var I=0,z=0,te=0;w=0,A=7,this.encode.displayName="_encode_";for(var se,pe,ve,_e,Pe,fe,st,mt,he,at=k.data,we=k.width,ye=k.height,Be=4*we,Et=0;Et<ye;){for(se=0;se<Be;){for(Pe=Be*Et+se,st=-1,mt=0,he=0;he<64;he++)fe=Pe+(mt=he>>3)*Be+(st=4*(7&he)),Et+mt>=ye&&(fe-=Be*(Et+1+mt-ye)),se+st>=Be&&(fe-=se+st-Be+4),pe=at[fe++],ve=at[fe++],_e=at[fe++],C[he]=(W[pe]+W[ve+256|0]+W[_e+512|0]>>16)-128,E[he]=(W[pe+768|0]+W[ve+1024|0]+W[_e+1280|0]>>16)-128,R[he]=(W[pe+1280|0]+W[ve+1536|0]+W[_e+1792|0]>>16)-128;I=de(C,d,I,e,a),z=de(E,m,z,r,n),te=de(R,m,te,r,n),se+=32}Et+=8}if(A>=0){var Xe=[];Xe[1]=A+1,Xe[0]=(1<<A+1)-1,Z(Xe)}return re(65497),new Uint8Array(_)},t=t||50,(function(){for(var k=String.fromCharCode,F=0;F<256;F++)Y[F]=k(F)})(),e=X(q,L),r=X(T,M),a=X(J,D),n=X(V,ie),(function(){for(var k=1,F=2,I=1;I<=15;I++){for(var z=k;z<F;z++)x[32767+z]=I,v[32767+z]=[],v[32767+z][1]=I,v[32767+z][0]=z;for(var te=-(F-1);te<=-k;te++)x[32767+te]=I,v[32767+te]=[],v[32767+te][1]=I,v[32767+te][0]=F-1+te;k<<=1,F<<=1}})(),(function(){for(var k=0;k<256;k++)W[k]=19595*k,W[k+256|0]=38470*k,W[k+512|0]=7471*k+32768,W[k+768|0]=-11059*k,W[k+1024|0]=-21709*k,W[k+1280|0]=32768*k+8421375,W[k+1536|0]=-27439*k,W[k+1792|0]=-5329*k})(),U(t)}function zo(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function AS(t){function e(L){if(!L)throw Error("assert :P")}function r(L,J,D){for(var T=0;4>T;T++)if(L[J+T]!=D.charCodeAt(T))return!0;return!1}function a(L,J,D,T,M){for(var V=0;V<M;V++)L[J+V]=D[T+V]}function n(L,J,D,T){for(var M=0;M<T;M++)L[J+M]=D}function s(L){return new Int32Array(L)}function l(L,J){for(var D=[],T=0;T<L;T++)D.push(new J);return D}function c(L,J){var D=[];return(function T(M,V,ie){for(var X=ie[V],Z=0;Z<X&&(M.push(ie.length>V+1?[]:new J),!(ie.length<V+1));Z++)T(M[Z],V+1,ie)})(D,0,L),D}var f=function(){var L=this;function J(y,N){for(var P=1<<N-1>>>0;y&P;)P>>>=1;return P?(y&P-1)+P:y}function D(y,N,P,H,ee){e(!(H%P));do y[N+(H-=P)]=ee;while(0<H)}function T(y,N,P,H,ee){if(e(2328>=ee),512>=ee)var oe=s(512);else if((oe=s(ee))==null)return 0;return(function(le,me,be,Ee,Fe,Ke){var je,Ie,$e=me,ct=1<<be,We=s(16),it=s(16);for(e(Fe!=0),e(Ee!=null),e(le!=null),e(0<be),Ie=0;Ie<Fe;++Ie){if(15<Ee[Ie])return 0;++We[Ee[Ie]]}if(We[0]==Fe)return 0;for(it[1]=0,je=1;15>je;++je){if(We[je]>1<<je)return 0;it[je+1]=it[je]+We[je]}for(Ie=0;Ie<Fe;++Ie)je=Ee[Ie],0<Ee[Ie]&&(Ke[it[je]++]=Ie);if(it[15]==1)return(Ee=new M).g=0,Ee.value=Ke[0],D(le,$e,1,ct,Ee),ct;var vt,At=-1,bt=ct-1,tr=0,Vt=1,Nr=1,Kt=1<<be;for(Ie=0,je=1,Fe=2;je<=be;++je,Fe<<=1){if(Vt+=Nr<<=1,0>(Nr-=We[je]))return 0;for(;0<We[je];--We[je])(Ee=new M).g=je,Ee.value=Ke[Ie++],D(le,$e+tr,Fe,Kt,Ee),tr=J(tr,je)}for(je=be+1,Fe=2;15>=je;++je,Fe<<=1){if(Vt+=Nr<<=1,0>(Nr-=We[je]))return 0;for(;0<We[je];--We[je]){if(Ee=new M,(tr&bt)!=At){for($e+=Kt,vt=1<<(At=je)-be;15>At&&!(0>=(vt-=We[At]));)++At,vt<<=1;ct+=Kt=1<<(vt=At-be),le[me+(At=tr&bt)].g=vt+be,le[me+At].value=$e-me-At}Ee.g=je-be,Ee.value=Ke[Ie++],D(le,$e+(tr>>be),Fe,Kt,Ee),tr=J(tr,je)}}return Vt!=2*it[15]-1?0:ct})(y,N,P,H,ee,oe)}function M(){this.value=this.g=0}function V(){this.value=this.g=0}function ie(){this.G=l(5,M),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(nl,V)}function X(y,N,P,H){e(y!=null),e(N!=null),e(2147483648>H),y.Ca=254,y.I=0,y.b=-8,y.Ka=0,y.oa=N,y.pa=P,y.Jd=N,y.Yc=P+H,y.Zc=4<=H?P+H-4+1:P,pe(y)}function Z(y,N){for(var P=0;0<N--;)P|=_e(y,128)<<N;return P}function K(y,N){var P=Z(y,N);return ve(y)?-P:P}function re(y,N,P,H){var ee,oe=0;for(e(y!=null),e(N!=null),e(4294967288>H),y.Sb=H,y.Ra=0,y.u=0,y.h=0,4<H&&(H=4),ee=0;ee<H;++ee)oe+=N[P+ee]<<8*ee;y.Ra=oe,y.bb=H,y.oa=N,y.pa=P}function de(y){for(;8<=y.u&&y.bb<y.Sb;)y.Ra>>>=8,y.Ra+=y.oa[y.pa+y.bb]<<Gi-8>>>0,++y.bb,y.u-=8;z(y)&&(y.h=1,y.u=0)}function U(y,N){if(e(0<=N),!y.h&&N<=ds){var P=I(y)&ws[N];return y.u+=N,de(y),P}return y.h=1,y.u=0}function k(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function F(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function I(y){return y.Ra>>>(y.u&Gi-1)>>>0}function z(y){return e(y.bb<=y.Sb),y.h||y.bb==y.Sb&&y.u>Gi}function te(y,N){y.u=N,y.h=z(y)}function se(y){y.u>=Yi&&(e(y.u>=Yi),de(y))}function pe(y){e(y!=null&&y.oa!=null),y.pa<y.Zc?(y.I=(y.oa[y.pa++]|y.I<<8)>>>0,y.b+=8):(e(y!=null&&y.oa!=null),y.pa<y.Yc?(y.b+=8,y.I=y.oa[y.pa++]|y.I<<8):y.Ka?y.b=0:(y.I<<=8,y.b+=8,y.Ka=1))}function ve(y){return Z(y,1)}function _e(y,N){var P=y.Ca;0>y.b&&pe(y);var H=y.b,ee=P*N>>>8,oe=(y.I>>>H>ee)+0;for(oe?(P-=ee,y.I-=ee+1<<H>>>0):P=ee+1,H=P,ee=0;256<=H;)ee+=8,H>>=8;return H=7^ee+Ao[H],y.b-=H,y.Ca=(P<<H)-1,oe}function Pe(y,N,P){y[N+0]=P>>24&255,y[N+1]=P>>16&255,y[N+2]=P>>8&255,y[N+3]=255&P}function fe(y,N){return y[N+0]|y[N+1]<<8}function st(y,N){return fe(y,N)|y[N+2]<<16}function mt(y,N){return fe(y,N)|fe(y,N+2)<<16}function he(y,N){var P=1<<N;return e(y!=null),e(0<N),y.X=s(P),y.X==null?0:(y.Mb=32-N,y.Xa=N,1)}function at(y,N){e(y!=null),e(N!=null),e(y.Xa==N.Xa),a(N.X,0,y.X,0,1<<N.Xa)}function we(){this.X=[],this.Xa=this.Mb=0}function ye(y,N,P,H){e(P!=null),e(H!=null);var ee=P[0],oe=H[0];return ee==0&&(ee=(y*oe+N/2)/N),oe==0&&(oe=(N*ee+y/2)/y),0>=ee||0>=oe?0:(P[0]=ee,H[0]=oe,1)}function Be(y,N){return y+(1<<N)-1>>>N}function Et(y,N){return((4278255360&y)+(4278255360&N)>>>0&4278255360)+((16711935&y)+(16711935&N)>>>0&16711935)>>>0}function Xe(y,N){L[N]=function(P,H,ee,oe,le,me,be){var Ee;for(Ee=0;Ee<le;++Ee){var Fe=L[y](me[be+Ee-1],ee,oe+Ee);me[be+Ee]=Et(P[H+Ee],Fe)}}}function lt(){this.ud=this.hd=this.jd=0}function jt(y,N){return((4278124286&(y^N))>>>1)+(y&N)>>>0}function Dt(y){return 0<=y&&256>y?y:0>y?0:255<y?255:void 0}function Wt(y,N){return Dt(y+(y-N+.5>>1))}function et(y,N,P){return Math.abs(N-P)-Math.abs(y-P)}function ht(y,N,P,H,ee,oe,le){for(H=oe[le-1],P=0;P<ee;++P)oe[le+P]=H=Et(y[N+P],H)}function yt(y,N,P,H,ee){var oe;for(oe=0;oe<P;++oe){var le=y[N+oe],me=le>>8&255,be=16711935&(be=(be=16711935&le)+((me<<16)+me));H[ee+oe]=(4278255360&le)+be>>>0}}function ft(y,N){N.jd=255&y,N.hd=y>>8&255,N.ud=y>>16&255}function pt(y,N,P,H,ee,oe){var le;for(le=0;le<H;++le){var me=N[P+le],be=me>>>8,Ee=me,Fe=255&(Fe=(Fe=me>>>16)+((y.jd<<24>>24)*(be<<24>>24)>>>5));Ee=255&(Ee=(Ee+=(y.hd<<24>>24)*(be<<24>>24)>>>5)+((y.ud<<24>>24)*(Fe<<24>>24)>>>5)),ee[oe+le]=(4278255360&me)+(Fe<<16)+Ee}}function wt(y,N,P,H,ee){L[N]=function(oe,le,me,be,Ee,Fe,Ke,je,Ie){for(be=Ke;be<je;++be)for(Ke=0;Ke<Ie;++Ke)Ee[Fe++]=ee(me[H(oe[le++])])},L[y]=function(oe,le,me,be,Ee,Fe,Ke){var je=8>>oe.b,Ie=oe.Ea,$e=oe.K[0],ct=oe.w;if(8>je)for(oe=(1<<oe.b)-1,ct=(1<<je)-1;le<me;++le){var We,it=0;for(We=0;We<Ie;++We)We&oe||(it=H(be[Ee++])),Fe[Ke++]=ee($e[it&ct]),it>>=je}else L["VP8LMapColor"+P](be,Ee,$e,ct,Fe,Ke,le,me,Ie)}}function Lt(y,N,P,H,ee){for(P=N+P;N<P;){var oe=y[N++];H[ee++]=oe>>16&255,H[ee++]=oe>>8&255,H[ee++]=255&oe}}function Pt(y,N,P,H,ee){for(P=N+P;N<P;){var oe=y[N++];H[ee++]=oe>>16&255,H[ee++]=oe>>8&255,H[ee++]=255&oe,H[ee++]=oe>>24&255}}function zt(y,N,P,H,ee){for(P=N+P;N<P;){var oe=(le=y[N++])>>16&240|le>>12&15,le=240&le|le>>28&15;H[ee++]=oe,H[ee++]=le}}function Ce(y,N,P,H,ee){for(P=N+P;N<P;){var oe=(le=y[N++])>>16&248|le>>13&7,le=le>>5&224|le>>3&31;H[ee++]=oe,H[ee++]=le}}function Ve(y,N,P,H,ee){for(P=N+P;N<P;){var oe=y[N++];H[ee++]=255&oe,H[ee++]=oe>>8&255,H[ee++]=oe>>16&255}}function ce(y,N,P,H,ee,oe){if(oe==0)for(P=N+P;N<P;)Pe(H,((oe=y[N++])[0]>>24|oe[1]>>8&65280|oe[2]<<8&16711680|oe[3]<<24)>>>0),ee+=32;else a(H,ee,y,N,P)}function Re(y,N){L[N][0]=L[y+"0"],L[N][1]=L[y+"1"],L[N][2]=L[y+"2"],L[N][3]=L[y+"3"],L[N][4]=L[y+"4"],L[N][5]=L[y+"5"],L[N][6]=L[y+"6"],L[N][7]=L[y+"7"],L[N][8]=L[y+"8"],L[N][9]=L[y+"9"],L[N][10]=L[y+"10"],L[N][11]=L[y+"11"],L[N][12]=L[y+"12"],L[N][13]=L[y+"13"],L[N][14]=L[y+"0"],L[N][15]=L[y+"0"]}function Me(y){return y==zu||y==Jf||y==Rc||y==Zf}function Tt(){this.eb=[],this.size=this.A=this.fb=0}function $t(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function or(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Tt,this.f.kb=new $t,this.sd=null}function Ht(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function mr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ca(y){return alert("todo:WebPSamplerProcessPlane"),y.T}function Na(y,N){var P=y.T,H=N.ba.f.RGBA,ee=H.eb,oe=H.fb+y.ka*H.A,le=Hn[N.ba.S],me=y.y,be=y.O,Ee=y.f,Fe=y.N,Ke=y.ea,je=y.W,Ie=N.cc,$e=N.dc,ct=N.Mc,We=N.Nc,it=y.ka,vt=y.ka+y.T,At=y.U,bt=At+1>>1;for(it==0?le(me,be,null,null,Ee,Fe,Ke,je,Ee,Fe,Ke,je,ee,oe,null,null,At):(le(N.ec,N.fc,me,be,Ie,$e,ct,We,Ee,Fe,Ke,je,ee,oe-H.A,ee,oe,At),++P);it+2<vt;it+=2)Ie=Ee,$e=Fe,ct=Ke,We=je,Fe+=y.Rc,je+=y.Rc,oe+=2*H.A,le(me,(be+=2*y.fa)-y.fa,me,be,Ie,$e,ct,We,Ee,Fe,Ke,je,ee,oe-H.A,ee,oe,At);return be+=y.fa,y.j+vt<y.o?(a(N.ec,N.fc,me,be,At),a(N.cc,N.dc,Ee,Fe,bt),a(N.Mc,N.Nc,Ke,je,bt),P--):1&vt||le(me,be,null,null,Ee,Fe,Ke,je,Ee,Fe,Ke,je,ee,oe+H.A,null,null,At),P}function Ct(y,N,P){var H=y.F,ee=[y.J];if(H!=null){var oe=y.U,le=N.ba.S,me=le==qu||le==Rc;N=N.ba.f.RGBA;var be=[0],Ee=y.ka;be[0]=y.T,y.Kb&&(Ee==0?--be[0]:(--Ee,ee[0]-=y.width),y.j+y.ka+y.T==y.o&&(be[0]=y.o-y.j-Ee));var Fe=N.eb;Ee=N.fb+Ee*N.A,y=Mu(H,ee[0],y.width,oe,be,Fe,Ee+(me?0:3),N.A),e(P==be),y&&Me(le)&&Ul(Fe,Ee,me,oe,be,N.A)}return 0}function Oa(y){var N=y.ma,P=N.ba.S,H=11>P,ee=P==Qn||P==Zs||P==qu||P==Oc||P==12||Me(P);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!Eo(N.Oa,y,ee?11:12))return 0;if(ee&&Me(P)&&Du(),y.da)alert("todo:use_scaling");else{if(H){if(N.Ib=Ca,y.Kb){if(P=y.U+1>>1,N.memory=s(y.U+2*P),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+y.U,N.Mc=N.cc,N.Nc=N.dc+P,N.Ib=Na,Du()}}else alert("todo:EmitYUV");ee&&(N.Jb=Ct,H&&_i())}if(H&&!fl){for(y=0;256>y;++y)$n[y]=89858*(y-128)+Lc>>ni,A1[y]=-22014*(y-128)+Lc,cm[y]=-45773*(y-128),ad[y]=113618*(y-128)+Lc>>ni;for(y=$l;y<ul;++y)N=76283*(y-16)+Lc>>ni,C1[y-$l]=Ra(N,255),T1[y-$l]=Ra(N+8>>4,15);fl=1}return 1}function ar(y){var N=y.ma,P=y.U,H=y.T;return e(!(1&y.ka)),0>=P||0>=H?0:(P=N.Ib(y,N),N.Jb!=null&&N.Jb(y,N,P),N.Dc+=P,1)}function za(y){y.ma.memory=null}function os(y,N,P,H){return U(y,8)!=47?0:(N[0]=U(y,14)+1,P[0]=U(y,14)+1,H[0]=U(y,1),U(y,3)!=0?0:!y.h)}function rn(y,N){if(4>y)return y+1;var P=y-2>>1;return(2+(1&y)<<P)+U(N,P)+1}function Mn(y,N){return 120<N?N-120:1<=(P=((P=ei[N-1])>>4)*y+(8-(15&P)))?P:1;var P}function Ut(y,N,P){var H=I(P),ee=y[N+=255&H].g-8;return 0<ee&&(te(P,P.u+8),H=I(P),N+=y[N].value,N+=H&(1<<ee)-1),te(P,P.u+y[N].g),y[N].value}function er(y,N,P){return P.g+=y.g,P.value+=y.value<<N>>>0,e(8>=P.g),y.g}function ae(y,N,P){var H=y.xc;return e((N=H==0?0:y.vc[y.md*(P>>H)+(N>>H)])<y.Wb),y.Ya[N]}function Se(y,N,P,H){var ee=y.ab,oe=y.c*N,le=y.C;N=le+N;var me=P,be=H;for(H=y.Ta,P=y.Ua;0<ee--;){var Ee=y.gc[ee],Fe=le,Ke=N,je=me,Ie=be,$e=(be=H,me=P,Ee.Ea);switch(e(Fe<Ke),e(Ke<=Ee.nc),Ee.hc){case 2:Xa(je,Ie,(Ke-Fe)*$e,be,me);break;case 0:var ct=Fe,We=Ke,it=be,vt=me,At=(Kt=Ee).Ea;ct==0&&(Ec(je,Ie,null,null,1,it,vt),ht(je,Ie+1,0,0,At-1,it,vt+1),Ie+=At,vt+=At,++ct);for(var bt=1<<Kt.b,tr=bt-1,Vt=Be(At,Kt.b),Nr=Kt.K,Kt=Kt.w+(ct>>Kt.b)*Vt;ct<We;){var Mr=Nr,ja=Kt,Er=1;for(Ac(je,Ie,it,vt-At,1,it,vt);Er<At;){var Gt=(Er&~tr)+bt;Gt>At&&(Gt=At),(0,Co[Mr[ja++]>>8&15])(je,Ie+ +Er,it,vt+Er-At,Gt-Er,it,vt+Er),Er=Gt}Ie+=At,vt+=At,++ct&tr||(Kt+=Vt)}Ke!=Ee.nc&&a(be,me-$e,be,me+(Ke-Fe-1)*$e,$e);break;case 1:for($e=je,We=Ie,At=(je=Ee.Ea)-(vt=je&~(it=(Ie=1<<Ee.b)-1)),ct=Be(je,Ee.b),bt=Ee.K,Ee=Ee.w+(Fe>>Ee.b)*ct;Fe<Ke;){for(tr=bt,Vt=Ee,Nr=new lt,Kt=We+vt,Mr=We+je;We<Kt;)ft(tr[Vt++],Nr),Cc(Nr,$e,We,Ie,be,me),We+=Ie,me+=Ie;We<Mr&&(ft(tr[Vt++],Nr),Cc(Nr,$e,We,At,be,me),We+=At,me+=At),++Fe&it||(Ee+=ct)}break;case 3:if(je==be&&Ie==me&&0<Ee.b){for(We=be,je=$e=me+(Ke-Fe)*$e-(vt=(Ke-Fe)*Be(Ee.Ea,Ee.b)),Ie=be,it=me,ct=[],vt=(At=vt)-1;0<=vt;--vt)ct[vt]=Ie[it+vt];for(vt=At-1;0<=vt;--vt)We[je+vt]=ct[vt];Vf(Ee,Fe,Ke,be,$e,be,me)}else Vf(Ee,Fe,Ke,je,Ie,be,me)}me=H,be=P}be!=P&&a(H,P,me,be,oe)}function ge(y,N){var P=y.V,H=y.Ba+y.c*y.C,ee=N-y.C;if(e(N<=y.l.o),e(16>=ee),0<ee){var oe=y.l,le=y.Ta,me=y.Ua,be=oe.width;if(Se(y,ee,P,H),ee=me=[me],e((P=y.C)<(H=N)),e(oe.v<oe.va),H>oe.o&&(H=oe.o),P<oe.j){var Ee=oe.j-P;P=oe.j,ee[0]+=Ee*be}if(P>=H?P=0:(ee[0]+=4*oe.v,oe.ka=P-oe.j,oe.U=oe.va-oe.v,oe.T=H-P,P=1),P){if(me=me[0],11>(P=y.ca).S){var Fe=P.f.RGBA,Ke=(H=P.S,ee=oe.U,oe=oe.T,Ee=Fe.eb,Fe.A),je=oe;for(Fe=Fe.fb+y.Ma*Fe.A;0<je--;){var Ie=le,$e=me,ct=ee,We=Ee,it=Fe;switch(H){case Xf:Tc(Ie,$e,ct,We,it);break;case Qn:To(Ie,$e,ct,We,it);break;case zu:To(Ie,$e,ct,We,it),Ul(We,it,0,ct,1,0);break;case Kf:Il(Ie,$e,ct,We,it);break;case Zs:ce(Ie,$e,ct,We,it,1);break;case Jf:ce(Ie,$e,ct,We,it,1),Ul(We,it,0,ct,1,0);break;case qu:ce(Ie,$e,ct,We,it,0);break;case Rc:ce(Ie,$e,ct,We,it,0),Ul(We,it,1,ct,1,0);break;case Oc:Oo(Ie,$e,ct,We,it);break;case Zf:Oo(Ie,$e,ct,We,it),Js(We,it,ct,1,0);break;case sl:Ji(Ie,$e,ct,We,it);break;default:e(0)}me+=be,Fe+=Ke}y.Ma+=oe}else alert("todo:EmitRescaledRowsYUVA");e(y.Ma<=P.height)}}y.C=N,e(y.C<=y.i)}function xe(y){var N;if(0<y.ua)return 0;for(N=0;N<y.Wb;++N){var P=y.Ya[N].G,H=y.Ya[N].H;if(0<P[1][H[1]+0].g||0<P[2][H[2]+0].g||0<P[3][H[3]+0].g)return 0}return 1}function Ne(y,N,P,H,ee,oe){if(y.Z!=0){var le=y.qd,me=y.rd;for(e(Fo[y.Z]!=null);N<P;++N)Fo[y.Z](le,me,H,ee,H,ee,oe),le=H,me=ee,ee+=oe;y.qd=le,y.rd=me}}function ke(y,N){var P=y.l.ma,H=P.Z==0||P.Z==1?y.l.j:y.C;if(H=y.C<H?H:y.C,e(N<=y.l.o),N>H){var ee=y.l.width,oe=P.ca,le=P.tb+ee*H,me=y.V,be=y.Ba+y.c*H,Ee=y.gc;e(y.ab==1),e(Ee[0].hc==3),Ki(Ee[0],H,N,me,be,oe,le),Ne(P,H,N,oe,le,ee)}y.C=y.Ma=N}function He(y,N,P,H,ee,oe,le){var me=y.$/H,be=y.$%H,Ee=y.m,Fe=y.s,Ke=P+y.$,je=Ke;ee=P+H*ee;var Ie=P+H*oe,$e=280+Fe.ua,ct=y.Pb?me:16777216,We=0<Fe.ua?Fe.Wa:null,it=Fe.wc,vt=Ke<Ie?ae(Fe,be,me):null;e(y.C<oe),e(Ie<=ee);var At=!1;e:for(;;){for(;At||Ke<Ie;){var bt=0;if(me>=ct){var tr=Ke-P;e((ct=y).Pb),ct.wd=ct.m,ct.xd=tr,0<ct.s.ua&&at(ct.s.Wa,ct.s.vb),ct=me+il}if(be&it||(vt=ae(Fe,be,me)),e(vt!=null),vt.Qb&&(N[Ke]=vt.qb,At=!0),!At)if(se(Ee),vt.jc){bt=Ee,tr=N;var Vt=Ke,Nr=vt.pd[I(bt)&nl-1];e(vt.jc),256>Nr.g?(te(bt,bt.u+Nr.g),tr[Vt]=Nr.value,bt=0):(te(bt,bt.u+Nr.g-256),e(256<=Nr.value),bt=Nr.value),bt==0&&(At=!0)}else bt=Ut(vt.G[0],vt.H[0],Ee);if(Ee.h)break;if(At||256>bt){if(!At)if(vt.nd)N[Ke]=(vt.qb|bt<<8)>>>0;else{if(se(Ee),At=Ut(vt.G[1],vt.H[1],Ee),se(Ee),tr=Ut(vt.G[2],vt.H[2],Ee),Vt=Ut(vt.G[3],vt.H[3],Ee),Ee.h)break;N[Ke]=(Vt<<24|At<<16|bt<<8|tr)>>>0}if(At=!1,++Ke,++be>=H&&(be=0,++me,le!=null&&me<=oe&&!(me%16)&&le(y,me),We!=null))for(;je<Ke;)bt=N[je++],We.X[(506832829*bt&4294967295)>>>We.Mb]=bt}else if(280>bt){if(bt=rn(bt-256,Ee),tr=Ut(vt.G[4],vt.H[4],Ee),se(Ee),tr=Mn(H,tr=rn(tr,Ee)),Ee.h)break;if(Ke-P<tr||ee-Ke<bt)break e;for(Vt=0;Vt<bt;++Vt)N[Ke+Vt]=N[Ke+Vt-tr];for(Ke+=bt,be+=bt;be>=H;)be-=H,++me,le!=null&&me<=oe&&!(me%16)&&le(y,me);if(e(Ke<=ee),be&it&&(vt=ae(Fe,be,me)),We!=null)for(;je<Ke;)bt=N[je++],We.X[(506832829*bt&4294967295)>>>We.Mb]=bt}else{if(!(bt<$e))break e;for(At=bt-280,e(We!=null);je<Ke;)bt=N[je++],We.X[(506832829*bt&4294967295)>>>We.Mb]=bt;bt=Ke,e(!(At>>>(tr=We).Xa)),N[bt]=tr.X[At],At=!0}At||e(Ee.h==z(Ee))}if(y.Pb&&Ee.h&&Ke<ee)e(y.m.h),y.a=5,y.m=y.wd,y.$=y.xd,0<y.s.ua&&at(y.s.vb,y.s.Wa);else{if(Ee.h)break e;le?.(y,me>oe?oe:me),y.a=0,y.$=Ke-P}return 1}return y.a=3,0}function nt(y){e(y!=null),y.vc=null,y.yc=null,y.Ya=null;var N=y.Wa;N!=null&&(N.X=null),y.vb=null,e(y!=null)}function Ge(){var y=new xr;return y==null?null:(y.a=0,y.xb=bh,Re("Predictor","VP8LPredictors"),Re("Predictor","VP8LPredictors_C"),Re("PredictorAdd","VP8LPredictorsAdd"),Re("PredictorAdd","VP8LPredictorsAdd_C"),Xa=yt,Cc=pt,Tc=Lt,To=Pt,Oo=zt,Ji=Ce,Il=Ve,L.VP8LMapColor32b=Xi,L.VP8LMapColor8b=Un,y)}function Ye(y,N,P,H,ee){var oe=1,le=[y],me=[N],be=H.m,Ee=H.s,Fe=null,Ke=0;e:for(;;){if(P)for(;oe&&U(be,1);){var je=le,Ie=me,$e=H,ct=1,We=$e.m,it=$e.gc[$e.ab],vt=U(We,2);if($e.Oc&1<<vt)oe=0;else{switch($e.Oc|=1<<vt,it.hc=vt,it.Ea=je[0],it.nc=Ie[0],it.K=[null],++$e.ab,e(4>=$e.ab),vt){case 0:case 1:it.b=U(We,3)+2,ct=Ye(Be(it.Ea,it.b),Be(it.nc,it.b),0,$e,it.K),it.K=it.K[0];break;case 3:var At,bt=U(We,8)+1,tr=16<bt?0:4<bt?1:2<bt?2:3;if(je[0]=Be(it.Ea,tr),it.b=tr,At=ct=Ye(bt,1,0,$e,it.K)){var Vt,Nr=bt,Kt=it,Mr=1<<(8>>Kt.b),ja=s(Mr);if(ja==null)At=0;else{var Er=Kt.K[0],Gt=Kt.w;for(ja[0]=Kt.K[0][0],Vt=1;Vt<1*Nr;++Vt)ja[Vt]=Et(Er[Gt+Vt],ja[Vt-1]);for(;Vt<4*Mr;++Vt)ja[Vt]=0;Kt.K[0]=null,Kt.K[0]=ja,At=1}}ct=At;break;case 2:break;default:e(0)}oe=ct}}if(le=le[0],me=me[0],oe&&U(be,1)&&!(oe=1<=(Ke=U(be,4))&&11>=Ke)){H.a=3;break e}var Bt;if(Bt=oe)t:{var Fa,gr,Tr,ia=H,xn=le,Wn=me,ya=Ke,sn=P,es=ia.m,on=ia.s,Fr=[null],Gr=1,La=0,Zr=ti[ya];r:for(;;){if(sn&&U(es,1)){var yn=U(es,3)+2,Pa=Be(xn,yn),Yr=Be(Wn,yn),Za=Pa*Yr;if(!Ye(Pa,Yr,0,ia,Fr))break r;for(Fr=Fr[0],on.xc=yn,Fa=0;Fa<Za;++Fa){var oa=Fr[Fa]>>8&65535;Fr[Fa]=oa,oa>=Gr&&(Gr=oa+1)}}if(es.h)break r;for(gr=0;5>gr;++gr){var ln=zl[gr];!gr&&0<ya&&(ln+=1<<ya),La<ln&&(La=ln)}var cn=l(Gr*Zr,M),ua=Gr,Vr=l(ua,ie);if(Vr==null)var ts=null;else e(65536>=ua),ts=Vr;var $a=s(La);if(ts==null||$a==null||cn==null){ia.a=1;break r}var ur=cn;for(Fa=Tr=0;Fa<Gr;++Fa){var fr=ts[Fa],Xr=fr.G,Ss=fr.H,si=0,ms=1,un=0;for(gr=0;5>gr;++gr){ln=zl[gr],Xr[gr]=ur,Ss[gr]=Tr,!gr&&0<ya&&(ln+=1<<ya);n:{var dl,hl=ln,sd=ia,_a=$a,Sh=ur,Nh=Tr,id=0,Lo=sd.m,O1=U(Lo,1);if(n(_a,0,0,hl),O1){var kh=U(Lo,1)+1,jh=U(Lo,1),od=U(Lo,jh==0?1:8);_a[od]=1,kh==2&&(_a[od=U(Lo,8)]=1);var Tn=1}else{var Wa=s(19),Vu=U(Lo,4)+4;if(19<Vu){sd.a=3;var ml=0;break n}for(dl=0;dl<Vu;++dl)Wa[Hu[dl]]=U(Lo,3);var Mc=void 0,Wl=void 0,eo=sd,ld=Wa,Ic=hl,cd=_a,ud=0,Po=eo.m,Eh=8,Ah=l(128,M);a:for(;T(Ah,0,7,ld,19);){if(U(Po,1)){var um=2+2*U(Po,3);if((Mc=2+U(Po,um))>Ic)break a}else Mc=Ic;for(Wl=0;Wl<Ic&&Mc--;){se(Po);var Ch=Ah[0+(127&I(Po))];te(Po,Po.u+Ch.g);var pl=Ch.value;if(16>pl)cd[Wl++]=pl,pl!=0&&(Eh=pl);else{var fm=pl==16,dm=pl-16,hm=Dc[dm],Th=U(Po,Qs[dm])+hm;if(Wl+Th>Ic)break a;for(var mm=fm?Eh:0;0<Th--;)cd[Wl++]=mm}}ud=1;break a}ud||(eo.a=3),Tn=ud}(Tn=Tn&&!Lo.h)&&(id=T(Sh,Nh,8,_a,hl)),Tn&&id!=0?ml=id:(sd.a=3,ml=0)}if(ml==0)break r;if(ms&&Qf[gr]==1&&(ms=ur[Tr].g==0),si+=ur[Tr].g,Tr+=ml,3>=gr){var Vl,fd=$a[0];for(Vl=1;Vl<ln;++Vl)$a[Vl]>fd&&(fd=$a[Vl]);un+=fd}}if(fr.nd=ms,fr.Qb=0,ms&&(fr.qb=(Xr[3][Ss[3]+0].value<<24|Xr[1][Ss[1]+0].value<<16|Xr[2][Ss[2]+0].value)>>>0,si==0&&256>Xr[0][Ss[0]+0].value&&(fr.Qb=1,fr.qb+=Xr[0][Ss[0]+0].value<<8)),fr.jc=!fr.Qb&&6>un,fr.jc){var Gu,to=fr;for(Gu=0;Gu<nl;++Gu){var Mo=Gu,Io=to.pd[Mo],dd=to.G[0][to.H[0]+Mo];256<=dd.value?(Io.g=dd.g+256,Io.value=dd.value):(Io.g=0,Io.value=0,Mo>>=er(dd,8,Io),Mo>>=er(to.G[1][to.H[1]+Mo],16,Io),Mo>>=er(to.G[2][to.H[2]+Mo],0,Io),er(to.G[3][to.H[3]+Mo],24,Io))}}}on.vc=Fr,on.Wb=Gr,on.Ya=ts,on.yc=cn,Bt=1;break t}Bt=0}if(!(oe=Bt)){H.a=3;break e}if(0<Ke){if(Ee.ua=1<<Ke,!he(Ee.Wa,Ke)){H.a=1,oe=0;break e}}else Ee.ua=0;var hd=H,Gl=le,pm=me,Bc=hd.s,Uc=Bc.xc;if(hd.c=Gl,hd.i=pm,Bc.md=Be(Gl,Uc),Bc.wc=Uc==0?-1:(1<<Uc)-1,P){H.xb=ol;break e}if((Fe=s(le*me))==null){H.a=1,oe=0;break e}oe=(oe=He(H,Fe,0,le,me,me,null))&&!be.h;break e}return oe?(ee!=null?ee[0]=Fe:(e(Fe==null),e(P)),H.$=0,P||nt(Ee)):nt(Ee),oe}function Je(y,N){var P=y.c*y.i,H=P+N+16*N;return e(y.c<=N),y.V=s(H),y.V==null?(y.Ta=null,y.Ua=0,y.a=1,0):(y.Ta=y.V,y.Ua=y.Ba+P+N,1)}function kt(y,N){var P=y.C,H=N-P,ee=y.V,oe=y.Ba+y.c*P;for(e(N<=y.l.o);0<H;){var le=16<H?16:H,me=y.l.ma,be=y.l.width,Ee=be*le,Fe=me.ca,Ke=me.tb+be*P,je=y.Ta,Ie=y.Ua;Se(y,le,ee,oe),Hs(je,Ie,Fe,Ke,Ee),Ne(me,P,P+le,Fe,Ke,be),H-=le,ee+=le*y.c,P+=le}e(P==N),y.C=y.Ma=N}function Rt(){this.ub=this.yd=this.td=this.Rb=0}function qt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ot(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Mt(){this.Yb=(function(){var y=[];return(function N(P,H,ee){for(var oe=ee[H],le=0;le<oe&&(P.push(ee.length>H+1?[]:0),!(ee.length<H+1));le++)N(P[le],H+1,ee)})(y,0,[3,11]),y})()}function Xt(){this.jb=s(3),this.Wc=c([4,8],Mt),this.Xc=c([4,17],Mt)}function sa(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Lr(){this.ld=this.La=this.dd=this.tc=0}function ca(){this.Na=this.la=0}function ls(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function pi(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function gi(){this.uc=this.M=this.Nb=0,this.wa=Array(new Lr),this.Y=0,this.ya=Array(new pi),this.aa=0,this.l=new po}function Is(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Qo(){this.cb=this.a=0,this.sc="",this.m=new k,this.Od=new Rt,this.Kc=new qt,this.ed=new sa,this.Qa=new Ot,this.Ic=this.$c=this.Aa=0,this.D=new gi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,k),this.ia=0,this.pb=l(4,ls),this.Pa=new Xt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Is),this.Hd=0,this.rb=Array(new ca),this.sb=0,this.wa=Array(new Lr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new pi),this.L=this.aa=0,this.gd=c([4,2],Lr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ra(y,N){return 0>y?0:y>N?N:y}function po(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function vi(){var y=new Qo;return y!=null&&(y.a=0,y.sc="OK",y.cb=0,y.Xb=0,$s||($s=el)),y}function Kr(y,N,P){return y.a==0&&(y.a=N,y.sc=P,y.cb=0),0}function Su(y,N,P){return 3<=P&&y[N+0]==157&&y[N+1]==1&&y[N+2]==42}function zi(y,N){if(y==null)return 0;if(y.a=0,y.sc="OK",N==null)return Kr(y,2,"null VP8Io passed to VP8GetHeaders()");var P=N.data,H=N.w,ee=N.ha;if(4>ee)return Kr(y,7,"Truncated header.");var oe=P[H+0]|P[H+1]<<8|P[H+2]<<16,le=y.Od;if(le.Rb=!(1&oe),le.td=oe>>1&7,le.yd=oe>>4&1,le.ub=oe>>5,3<le.td)return Kr(y,3,"Incorrect keyframe parameters.");if(!le.yd)return Kr(y,4,"Frame not displayable.");H+=3,ee-=3;var me=y.Kc;if(le.Rb){if(7>ee)return Kr(y,7,"cannot parse picture header");if(!Su(P,H,ee))return Kr(y,3,"Bad code word");me.c=16383&(P[H+4]<<8|P[H+3]),me.Td=P[H+4]>>6,me.i=16383&(P[H+6]<<8|P[H+5]),me.Ud=P[H+6]>>6,H+=7,ee-=7,y.za=me.c+15>>4,y.Ub=me.i+15>>4,N.width=me.c,N.height=me.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,n((oe=y.Pa).jb,0,255,oe.jb.length),e((oe=y.Qa)!=null),oe.Cb=0,oe.Bb=0,oe.Fb=1,n(oe.Zb,0,0,oe.Zb.length),n(oe.Lb,0,0,oe.Lb)}if(le.ub>ee)return Kr(y,7,"bad partition length");X(oe=y.m,P,H,le.ub),H+=le.ub,ee-=le.ub,le.Rb&&(me.Ld=ve(oe),me.Kd=ve(oe)),me=y.Qa;var be,Ee=y.Pa;if(e(oe!=null),e(me!=null),me.Cb=ve(oe),me.Cb){if(me.Bb=ve(oe),ve(oe)){for(me.Fb=ve(oe),be=0;4>be;++be)me.Zb[be]=ve(oe)?K(oe,7):0;for(be=0;4>be;++be)me.Lb[be]=ve(oe)?K(oe,6):0}if(me.Bb)for(be=0;3>be;++be)Ee.jb[be]=ve(oe)?Z(oe,8):255}else me.Bb=0;if(oe.Ka)return Kr(y,3,"cannot parse segment header");if((me=y.ed).zd=ve(oe),me.Tb=Z(oe,6),me.wb=Z(oe,3),me.Pc=ve(oe),me.Pc&&ve(oe)){for(Ee=0;4>Ee;++Ee)ve(oe)&&(me.vd[Ee]=K(oe,6));for(Ee=0;4>Ee;++Ee)ve(oe)&&(me.od[Ee]=K(oe,6))}if(y.L=me.Tb==0?0:me.zd?1:2,oe.Ka)return Kr(y,3,"cannot parse filter header");var Fe=ee;if(ee=be=H,H=be+Fe,me=Fe,y.Xb=(1<<Z(y.m,2))-1,Fe<3*(Ee=y.Xb))P=7;else{for(be+=3*Ee,me-=3*Ee,Fe=0;Fe<Ee;++Fe){var Ke=P[ee+0]|P[ee+1]<<8|P[ee+2]<<16;Ke>me&&(Ke=me),X(y.Jc[+Fe],P,be,Ke),be+=Ke,me-=Ke,ee+=3}X(y.Jc[+Ee],P,be,me),P=be<H?0:5}if(P!=0)return Kr(y,P,"cannot parse partitions");for(P=Z(be=y.m,7),ee=ve(be)?K(be,4):0,H=ve(be)?K(be,4):0,me=ve(be)?K(be,4):0,Ee=ve(be)?K(be,4):0,be=ve(be)?K(be,4):0,Fe=y.Qa,Ke=0;4>Ke;++Ke){if(Fe.Cb){var je=Fe.Zb[Ke];Fe.Fb||(je+=P)}else{if(0<Ke){y.pb[Ke]=y.pb[0];continue}je=P}var Ie=y.pb[Ke];Ie.Sc[0]=ri[Ra(je+ee,127)],Ie.Sc[1]=ai[Ra(je+0,127)],Ie.Eb[0]=2*ri[Ra(je+H,127)],Ie.Eb[1]=101581*ai[Ra(je+me,127)]>>16,8>Ie.Eb[1]&&(Ie.Eb[1]=8),Ie.Qc[0]=ri[Ra(je+Ee,117)],Ie.Qc[1]=ai[Ra(je+be,127)],Ie.lc=je+be}if(!le.Rb)return Kr(y,4,"Not a key frame.");for(ve(oe),le=y.Pa,P=0;4>P;++P){for(ee=0;8>ee;++ee)for(H=0;3>H;++H)for(me=0;11>me;++me)Ee=_e(oe,ka[P][ee][H][me])?Z(oe,8):lm[P][ee][H][me],le.Wc[P][ee].Yb[H][me]=Ee;for(ee=0;17>ee;++ee)le.Xc[P][ee]=le.Wc[P][Br[ee]]}return y.kc=ve(oe),y.kc&&(y.Bd=Z(oe,8)),y.cb=1}function el(y,N,P,H,ee,oe,le){var me=N[ee].Yb[P];for(P=0;16>ee;++ee){if(!_e(y,me[P+0]))return ee;for(;!_e(y,me[P+1]);)if(me=N[++ee].Yb[0],P=0,ee==16)return 16;var be=N[ee+1].Yb;if(_e(y,me[P+2])){var Ee=y,Fe=0;if(_e(Ee,(je=me)[(Ke=P)+3]))if(_e(Ee,je[Ke+6])){for(me=0,Ke=2*(Fe=_e(Ee,je[Ke+8]))+(je=_e(Ee,je[Ke+9+Fe])),Fe=0,je=om[Ke];je[me];++me)Fe+=Fe+_e(Ee,je[me]);Fe+=3+(8<<Ke)}else _e(Ee,je[Ke+7])?(Fe=7+2*_e(Ee,165),Fe+=_e(Ee,145)):Fe=5+_e(Ee,159);else Fe=_e(Ee,je[Ke+4])?3+_e(Ee,je[Ke+5]):2;me=be[2]}else Fe=1,me=be[1];be=le+_h[ee],0>(Ee=y).b&&pe(Ee);var Ke,je=Ee.b,Ie=(Ke=Ee.Ca>>1)-(Ee.I>>je)>>31;--Ee.b,Ee.Ca+=Ie,Ee.Ca|=1,Ee.I-=(Ke+1&Ie)<<je,oe[be]=((Fe^Ie)-Ie)*H[(0<ee)+0]}return 16}function Nu(y){var N=y.rb[y.sb-1];N.la=0,N.Na=0,n(y.zc,0,0,y.zc.length),y.ja=0}function cs(y,N,P,H,ee){ee=y[N+P+32*H]+(ee>>3),y[N+P+32*H]=-256&ee?0>ee?0:255:ee}function gn(y,N,P,H,ee,oe){cs(y,N,0,P,H+ee),cs(y,N,1,P,H+oe),cs(y,N,2,P,H-oe),cs(y,N,3,P,H-ee)}function an(y){return(20091*y>>16)+y}function _c(y,N,P,H){var ee,oe=0,le=s(16);for(ee=0;4>ee;++ee){var me=y[N+0]+y[N+8],be=y[N+0]-y[N+8],Ee=(35468*y[N+4]>>16)-an(y[N+12]),Fe=an(y[N+4])+(35468*y[N+12]>>16);le[oe+0]=me+Fe,le[oe+1]=be+Ee,le[oe+2]=be-Ee,le[oe+3]=me-Fe,oe+=4,N++}for(ee=oe=0;4>ee;++ee)me=(y=le[oe+0]+4)+le[oe+8],be=y-le[oe+8],Ee=(35468*le[oe+4]>>16)-an(le[oe+12]),cs(P,H,0,0,me+(Fe=an(le[oe+4])+(35468*le[oe+12]>>16))),cs(P,H,1,0,be+Ee),cs(P,H,2,0,be-Ee),cs(P,H,3,0,me-Fe),oe++,H+=32}function Mf(y,N,P,H){var ee=y[N+0]+4,oe=35468*y[N+4]>>16,le=an(y[N+4]),me=35468*y[N+1]>>16;gn(P,H,0,ee+le,y=an(y[N+1]),me),gn(P,H,1,ee+oe,y,me),gn(P,H,2,ee-oe,y,me),gn(P,H,3,ee-le,y,me)}function ku(y,N,P,H,ee){_c(y,N,P,H),ee&&_c(y,N+16,P,H+4)}function us(y,N,P,H){Ro(y,N+0,P,H,1),Ro(y,N+32,P,H+128,1)}function ju(y,N,P,H){var ee;for(y=y[N+0]+4,ee=0;4>ee;++ee)for(N=0;4>N;++N)cs(P,H,N,ee,y)}function Eu(y,N,P,H){y[N+0]&&Jr(y,N+0,P,H),y[N+16]&&Jr(y,N+16,P,H+4),y[N+32]&&Jr(y,N+32,P,H+128),y[N+48]&&Jr(y,N+48,P,H+128+4)}function xi(y,N,P,H){var ee,oe=s(16);for(ee=0;4>ee;++ee){var le=y[N+0+ee]+y[N+12+ee],me=y[N+4+ee]+y[N+8+ee],be=y[N+4+ee]-y[N+8+ee],Ee=y[N+0+ee]-y[N+12+ee];oe[0+ee]=le+me,oe[8+ee]=le-me,oe[4+ee]=Ee+be,oe[12+ee]=Ee-be}for(ee=0;4>ee;++ee)le=(y=oe[0+4*ee]+3)+oe[3+4*ee],me=oe[1+4*ee]+oe[2+4*ee],be=oe[1+4*ee]-oe[2+4*ee],Ee=y-oe[3+4*ee],P[H+0]=le+me>>3,P[H+16]=Ee+be>>3,P[H+32]=le-me>>3,P[H+48]=Ee-be>>3,H+=64}function Ol(y,N,P){var H,ee=N-32,oe=Zn,le=255-y[ee-1];for(H=0;H<P;++H){var me,be=oe,Ee=le+y[N-1];for(me=0;me<P;++me)y[N+me]=be[Ee+y[ee+me]];N+=32}}function If(y,N){Ol(y,N,4)}function Bf(y,N){Ol(y,N,8)}function Au(y,N){Ol(y,N,16)}function Cu(y,N){var P;for(P=0;16>P;++P)a(y,N+32*P,y,N-32,16)}function Uf(y,N){var P;for(P=16;0<P;--P)n(y,N,y[N-1],16),N+=32}function bs(y,N,P){var H;for(H=0;16>H;++H)n(N,P+32*H,y,16)}function yi(y,N){var P,H=16;for(P=0;16>P;++P)H+=y[N-1+32*P]+y[N+P-32];bs(H>>5,y,N)}function go(y,N){var P,H=8;for(P=0;16>P;++P)H+=y[N-1+32*P];bs(H>>4,y,N)}function Rl(y,N){var P,H=8;for(P=0;16>P;++P)H+=y[N+P-32];bs(H>>4,y,N)}function tl(y,N){bs(128,y,N)}function pr(y,N,P){return y+2*N+P+2>>2}function qf(y,N){var P,H=N-32;for(H=new Uint8Array([pr(y[H-1],y[H+0],y[H+1]),pr(y[H+0],y[H+1],y[H+2]),pr(y[H+1],y[H+2],y[H+3]),pr(y[H+2],y[H+3],y[H+4])]),P=0;4>P;++P)a(y,N+32*P,H,0,H.length)}function Tu(y,N){var P=y[N-1],H=y[N-1+32],ee=y[N-1+64],oe=y[N-1+96];Pe(y,N+0,16843009*pr(y[N-1-32],P,H)),Pe(y,N+32,16843009*pr(P,H,ee)),Pe(y,N+64,16843009*pr(H,ee,oe)),Pe(y,N+96,16843009*pr(ee,oe,oe))}function zf(y,N){var P,H=4;for(P=0;4>P;++P)H+=y[N+P-32]+y[N-1+32*P];for(H>>=3,P=0;4>P;++P)n(y,N+32*P,H,4)}function Bs(y,N){var P=y[N-1+0],H=y[N-1+32],ee=y[N-1+64],oe=y[N-1-32],le=y[N+0-32],me=y[N+1-32],be=y[N+2-32],Ee=y[N+3-32];y[N+0+96]=pr(H,ee,y[N-1+96]),y[N+1+96]=y[N+0+64]=pr(P,H,ee),y[N+2+96]=y[N+1+64]=y[N+0+32]=pr(oe,P,H),y[N+3+96]=y[N+2+64]=y[N+1+32]=y[N+0+0]=pr(le,oe,P),y[N+3+64]=y[N+2+32]=y[N+1+0]=pr(me,le,oe),y[N+3+32]=y[N+2+0]=pr(be,me,le),y[N+3+0]=pr(Ee,be,me)}function In(y,N){var P=y[N+1-32],H=y[N+2-32],ee=y[N+3-32],oe=y[N+4-32],le=y[N+5-32],me=y[N+6-32],be=y[N+7-32];y[N+0+0]=pr(y[N+0-32],P,H),y[N+1+0]=y[N+0+32]=pr(P,H,ee),y[N+2+0]=y[N+1+32]=y[N+0+64]=pr(H,ee,oe),y[N+3+0]=y[N+2+32]=y[N+1+64]=y[N+0+96]=pr(ee,oe,le),y[N+3+32]=y[N+2+64]=y[N+1+96]=pr(oe,le,me),y[N+3+64]=y[N+2+96]=pr(le,me,be),y[N+3+96]=pr(me,be,be)}function Ou(y,N){var P=y[N-1+0],H=y[N-1+32],ee=y[N-1+64],oe=y[N-1-32],le=y[N+0-32],me=y[N+1-32],be=y[N+2-32],Ee=y[N+3-32];y[N+0+0]=y[N+1+64]=oe+le+1>>1,y[N+1+0]=y[N+2+64]=le+me+1>>1,y[N+2+0]=y[N+3+64]=me+be+1>>1,y[N+3+0]=be+Ee+1>>1,y[N+0+96]=pr(ee,H,P),y[N+0+64]=pr(H,P,oe),y[N+0+32]=y[N+1+96]=pr(P,oe,le),y[N+1+32]=y[N+2+96]=pr(oe,le,me),y[N+2+32]=y[N+3+96]=pr(le,me,be),y[N+3+32]=pr(me,be,Ee)}function Dl(y,N){var P=y[N+0-32],H=y[N+1-32],ee=y[N+2-32],oe=y[N+3-32],le=y[N+4-32],me=y[N+5-32],be=y[N+6-32],Ee=y[N+7-32];y[N+0+0]=P+H+1>>1,y[N+1+0]=y[N+0+64]=H+ee+1>>1,y[N+2+0]=y[N+1+64]=ee+oe+1>>1,y[N+3+0]=y[N+2+64]=oe+le+1>>1,y[N+0+32]=pr(P,H,ee),y[N+1+32]=y[N+0+96]=pr(H,ee,oe),y[N+2+32]=y[N+1+96]=pr(ee,oe,le),y[N+3+32]=y[N+2+96]=pr(oe,le,me),y[N+3+64]=pr(le,me,be),y[N+3+96]=pr(me,be,Ee)}function Us(y,N){var P=y[N-1+0],H=y[N-1+32],ee=y[N-1+64],oe=y[N-1+96];y[N+0+0]=P+H+1>>1,y[N+2+0]=y[N+0+32]=H+ee+1>>1,y[N+2+32]=y[N+0+64]=ee+oe+1>>1,y[N+1+0]=pr(P,H,ee),y[N+3+0]=y[N+1+32]=pr(H,ee,oe),y[N+3+32]=y[N+1+64]=pr(ee,oe,oe),y[N+3+64]=y[N+2+64]=y[N+0+96]=y[N+1+96]=y[N+2+96]=y[N+3+96]=oe}function Fl(y,N){var P=y[N-1+0],H=y[N-1+32],ee=y[N-1+64],oe=y[N-1+96],le=y[N-1-32],me=y[N+0-32],be=y[N+1-32],Ee=y[N+2-32];y[N+0+0]=y[N+2+32]=P+le+1>>1,y[N+0+32]=y[N+2+64]=H+P+1>>1,y[N+0+64]=y[N+2+96]=ee+H+1>>1,y[N+0+96]=oe+ee+1>>1,y[N+3+0]=pr(me,be,Ee),y[N+2+0]=pr(le,me,be),y[N+1+0]=y[N+3+32]=pr(P,le,me),y[N+1+32]=y[N+3+64]=pr(H,P,le),y[N+1+64]=y[N+3+96]=pr(ee,H,P),y[N+1+96]=pr(oe,ee,H)}function Hi(y,N){var P;for(P=0;8>P;++P)a(y,N+32*P,y,N-32,8)}function Hf(y,N){var P;for(P=0;8>P;++P)n(y,N,y[N-1],8),N+=32}function Ys(y,N,P){var H;for(H=0;8>H;++H)n(N,P+32*H,y,8)}function bc(y,N){var P,H=8;for(P=0;8>P;++P)H+=y[N+P-32]+y[N-1+32*P];Ys(H>>4,y,N)}function wc(y,N){var P,H=4;for(P=0;8>P;++P)H+=y[N+P-32];Ys(H>>3,y,N)}function An(y,N){var P,H=4;for(P=0;8>P;++P)H+=y[N-1+32*P];Ys(H>>3,y,N)}function $i(y,N){Ys(128,y,N)}function Xs(y,N,P){var H=y[N-P],ee=y[N+0],oe=3*(ee-H)+Do[1020+y[N-2*P]-y[N+P]],le=Uu[112+(oe+4>>3)];y[N-P]=Zn[255+H+Uu[112+(oe+3>>3)]],y[N+0]=Zn[255+ee-le]}function vo(y,N,P,H){var ee=y[N+0],oe=y[N+P];return qn[255+y[N-2*P]-y[N-P]]>H||qn[255+oe-ee]>H}function Sc(y,N,P,H){return 4*qn[255+y[N-P]-y[N+0]]+qn[255+y[N-2*P]-y[N+P]]<=H}function Ll(y,N,P,H,ee){var oe=y[N-3*P],le=y[N-2*P],me=y[N-P],be=y[N+0],Ee=y[N+P],Fe=y[N+2*P],Ke=y[N+3*P];return 4*qn[255+me-be]+qn[255+le-Ee]>H?0:qn[255+y[N-4*P]-oe]<=ee&&qn[255+oe-le]<=ee&&qn[255+le-me]<=ee&&qn[255+Ke-Fe]<=ee&&qn[255+Fe-Ee]<=ee&&qn[255+Ee-be]<=ee}function xo(y,N,P,H){var ee=2*H+1;for(H=0;16>H;++H)Sc(y,N+H,P,ee)&&Xs(y,N+H,P)}function yo(y,N,P,H){var ee=2*H+1;for(H=0;16>H;++H)Sc(y,N+H*P,1,ee)&&Xs(y,N+H*P,1)}function Pl(y,N,P,H){var ee;for(ee=3;0<ee;--ee)xo(y,N+=4*P,P,H)}function Ru(y,N,P,H){var ee;for(ee=3;0<ee;--ee)yo(y,N+=4,P,H)}function _o(y,N,P,H,ee,oe,le,me){for(oe=2*oe+1;0<ee--;){if(Ll(y,N,P,oe,le))if(vo(y,N,P,me))Xs(y,N,P);else{var be=y,Ee=N,Fe=P,Ke=be[Ee-2*Fe],je=be[Ee-Fe],Ie=be[Ee+0],$e=be[Ee+Fe],ct=be[Ee+2*Fe],We=27*(vt=Do[1020+3*(Ie-je)+Do[1020+Ke-$e]])+63>>7,it=18*vt+63>>7,vt=9*vt+63>>7;be[Ee-3*Fe]=Zn[255+be[Ee-3*Fe]+vt],be[Ee-2*Fe]=Zn[255+Ke+it],be[Ee-Fe]=Zn[255+je+We],be[Ee+0]=Zn[255+Ie-We],be[Ee+Fe]=Zn[255+$e-it],be[Ee+2*Fe]=Zn[255+ct-vt]}N+=H}}function bo(y,N,P,H,ee,oe,le,me){for(oe=2*oe+1;0<ee--;){if(Ll(y,N,P,oe,le))if(vo(y,N,P,me))Xs(y,N,P);else{var be=y,Ee=N,Fe=P,Ke=be[Ee-Fe],je=be[Ee+0],Ie=be[Ee+Fe],$e=Uu[112+(4+(ct=3*(je-Ke))>>3)],ct=Uu[112+(ct+3>>3)],We=$e+1>>1;be[Ee-2*Fe]=Zn[255+be[Ee-2*Fe]+We],be[Ee-Fe]=Zn[255+Ke+ct],be[Ee+0]=Zn[255+je-$e],be[Ee+Fe]=Zn[255+Ie-We]}N+=H}}function $f(y,N,P,H,ee,oe){_o(y,N,P,1,16,H,ee,oe)}function wo(y,N,P,H,ee,oe){_o(y,N,1,P,16,H,ee,oe)}function Wf(y,N,P,H,ee,oe){var le;for(le=3;0<le;--le)bo(y,N+=4*P,P,1,16,H,ee,oe)}function O(y,N,P,H,ee,oe){var le;for(le=3;0<le;--le)bo(y,N+=4,1,P,16,H,ee,oe)}function Q(y,N,P,H,ee,oe,le,me){_o(y,N,ee,1,8,oe,le,me),_o(P,H,ee,1,8,oe,le,me)}function Ae(y,N,P,H,ee,oe,le,me){_o(y,N,1,ee,8,oe,le,me),_o(P,H,1,ee,8,oe,le,me)}function Oe(y,N,P,H,ee,oe,le,me){bo(y,N+4*ee,ee,1,8,oe,le,me),bo(P,H+4*ee,ee,1,8,oe,le,me)}function qe(y,N,P,H,ee,oe,le,me){bo(y,N+4,1,ee,8,oe,le,me),bo(P,H+4,1,ee,8,oe,le,me)}function gt(){this.ba=new or,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new mr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function St(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Jt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function nr(){this.ua=0,this.Wa=new we,this.vb=new we,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ie,this.yc=new M}function xr(){this.xb=this.a=0,this.l=new po,this.ca=new or,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new F,this.Pb=0,this.wd=new F,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new nr,this.ab=0,this.gc=l(4,Jt),this.Oc=0}function jr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new po,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function $r(y,N,P,H,ee,oe,le){for(y=y==null?0:y[N+0],N=0;N<le;++N)ee[oe+N]=y+P[H+N]&255,y=ee[oe+N]}function Da(y,N,P,H,ee,oe,le){var me;if(y==null)$r(null,null,P,H,ee,oe,le);else for(me=0;me<le;++me)ee[oe+me]=y[N+me]+P[H+me]&255}function Ya(y,N,P,H,ee,oe,le){if(y==null)$r(null,null,P,H,ee,oe,le);else{var me,be=y[N+0],Ee=be,Fe=be;for(me=0;me<le;++me)Ee=Fe+(be=y[N+me])-Ee,Fe=P[H+me]+(-256&Ee?0>Ee?0:255:Ee)&255,Ee=be,ee[oe+me]=Fe}}function va(y,N,P,H){var ee=N.width,oe=N.o;if(e(y!=null&&N!=null),0>P||0>=H||P+H>oe)return null;if(!y.Cc){if(y.ga==null){var le;if(y.ga=new jr,(le=y.ga==null)||(le=N.width*N.o,e(y.Gb.length==0),y.Gb=s(le),y.Uc=0,y.Gb==null?le=0:(y.mb=y.Gb,y.nb=y.Uc,y.rc=null,le=1),le=!le),!le){le=y.ga;var me=y.Fa,be=y.P,Ee=y.qc,Fe=y.mb,Ke=y.nb,je=be+1,Ie=Ee-1,$e=le.l;if(e(me!=null&&Fe!=null&&N!=null),Fo[0]=null,Fo[1]=$r,Fo[2]=Da,Fo[3]=Ya,le.ca=Fe,le.tb=Ke,le.c=N.width,le.i=N.height,e(0<le.c&&0<le.i),1>=Ee)N=0;else if(le.$a=3&me[be+0],le.Z=me[be+0]>>2&3,le.Lc=me[be+0]>>4&3,be=me[be+0]>>6&3,0>le.$a||1<le.$a||4<=le.Z||1<le.Lc||be)N=0;else if($e.put=ar,$e.ac=Oa,$e.bc=za,$e.ma=le,$e.width=N.width,$e.height=N.height,$e.Da=N.Da,$e.v=N.v,$e.va=N.va,$e.j=N.j,$e.o=N.o,le.$a)e:{e(le.$a==1),N=Ge();t:for(;;){if(N==null){N=0;break e}if(e(le!=null),le.mc=N,N.c=le.c,N.i=le.i,N.l=le.l,N.l.ma=le,N.l.width=le.c,N.l.height=le.i,N.a=0,re(N.m,me,je,Ie),!Ye(le.c,le.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&xe(N.s)?(le.ic=1,me=N.c*N.i,N.Ta=null,N.Ua=0,N.V=s(me),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(le.ic=0,N=Je(N,le.c)),!N))break t;N=1;break e}le.mc=null,N=0}else N=Ie>=le.c*le.i;le=!N}if(le)return null;y.ga.Lc!=1?y.Ga=0:H=oe-P}e(y.ga!=null),e(P+H<=oe);e:{if(N=(me=y.ga).c,oe=me.l.o,me.$a==0){if(je=y.rc,Ie=y.Vc,$e=y.Fa,be=y.P+1+P*N,Ee=y.mb,Fe=y.nb+P*N,e(be<=y.P+y.qc),me.Z!=0)for(e(Fo[me.Z]!=null),le=0;le<H;++le)Fo[me.Z](je,Ie,$e,be,Ee,Fe,N),je=Ee,Ie=Fe,Fe+=N,be+=N;else for(le=0;le<H;++le)a(Ee,Fe,$e,be,N),je=Ee,Ie=Fe,Fe+=N,be+=N;y.rc=je,y.Vc=Ie}else{if(e(me.mc!=null),N=P+H,e((le=me.mc)!=null),e(N<=le.i),le.C>=N)N=1;else if(me.ic||_i(),me.ic){me=le.V,je=le.Ba,Ie=le.c;var ct=le.i,We=($e=1,be=le.$/Ie,Ee=le.$%Ie,Fe=le.m,Ke=le.s,le.$),it=Ie*ct,vt=Ie*N,At=Ke.wc,bt=We<vt?ae(Ke,Ee,be):null;e(We<=it),e(N<=ct),e(xe(Ke));t:for(;;){for(;!Fe.h&&We<vt;){if(Ee&At||(bt=ae(Ke,Ee,be)),e(bt!=null),se(Fe),256>(ct=Ut(bt.G[0],bt.H[0],Fe)))me[je+We]=ct,++We,++Ee>=Ie&&(Ee=0,++be<=N&&!(be%16)&&ke(le,be));else{if(!(280>ct)){$e=0;break t}ct=rn(ct-256,Fe);var tr,Vt=Ut(bt.G[4],bt.H[4],Fe);if(se(Fe),!(We>=(Vt=Mn(Ie,Vt=rn(Vt,Fe)))&&it-We>=ct)){$e=0;break t}for(tr=0;tr<ct;++tr)me[je+We+tr]=me[je+We+tr-Vt];for(We+=ct,Ee+=ct;Ee>=Ie;)Ee-=Ie,++be<=N&&!(be%16)&&ke(le,be);We<vt&&Ee&At&&(bt=ae(Ke,Ee,be))}e(Fe.h==z(Fe))}ke(le,be>N?N:be);break t}!$e||Fe.h&&We<it?($e=0,le.a=Fe.h?5:3):le.$=We,N=$e}else N=He(le,le.V,le.Ba,le.c,le.i,N,kt);if(!N){H=0;break e}}P+H>=oe&&(y.Cc=1),H=1}if(!H)return null;if(y.Cc&&((H=y.ga)!=null&&(H.mc=null),y.ga=null,0<y.Ga))return alert("todo:WebPDequantizeLevels"),null}return y.nb+P*ee}function vn(y,N,P,H,ee,oe){for(;0<ee--;){var le,me=y,be=N+(P?1:0),Ee=y,Fe=N+(P?0:3);for(le=0;le<H;++le){var Ke=Ee[Fe+4*le];Ke!=255&&(Ke*=32897,me[be+4*le+0]=me[be+4*le+0]*Ke>>23,me[be+4*le+1]=me[be+4*le+1]*Ke>>23,me[be+4*le+2]=me[be+4*le+2]*Ke>>23)}N+=oe}}function nn(y,N,P,H,ee){for(;0<H--;){var oe;for(oe=0;oe<P;++oe){var le=y[N+2*oe+0],me=15&(Ee=y[N+2*oe+1]),be=4369*me,Ee=(240&Ee|Ee>>4)*be>>16;y[N+2*oe+0]=(240&le|le>>4)*be>>16&240|(15&le|le<<4)*be>>16>>4&15,y[N+2*oe+1]=240&Ee|me}N+=ee}}function Bn(y,N,P,H,ee,oe,le,me){var be,Ee,Fe=255;for(Ee=0;Ee<ee;++Ee){for(be=0;be<H;++be){var Ke=y[N+be];oe[le+4*be]=Ke,Fe&=Ke}N+=P,le+=me}return Fe!=255}function So(y,N,P,H,ee){var oe;for(oe=0;oe<ee;++oe)P[H+oe]=y[N+oe]>>8}function _i(){Ul=vn,Js=nn,Mu=Bn,Hs=So}function No(y,N,P){L[y]=function(H,ee,oe,le,me,be,Ee,Fe,Ke,je,Ie,$e,ct,We,it,vt,At){var bt,tr=At-1>>1,Vt=me[be+0]|Ee[Fe+0]<<16,Nr=Ke[je+0]|Ie[$e+0]<<16;e(H!=null);var Kt=3*Vt+Nr+131074>>2;for(N(H[ee+0],255&Kt,Kt>>16,ct,We),oe!=null&&(Kt=3*Nr+Vt+131074>>2,N(oe[le+0],255&Kt,Kt>>16,it,vt)),bt=1;bt<=tr;++bt){var Mr=me[be+bt]|Ee[Fe+bt]<<16,ja=Ke[je+bt]|Ie[$e+bt]<<16,Er=Vt+Mr+Nr+ja+524296,Gt=Er+2*(Mr+Nr)>>3;Kt=Gt+Vt>>1,Vt=(Er=Er+2*(Vt+ja)>>3)+Mr>>1,N(H[ee+2*bt-1],255&Kt,Kt>>16,ct,We+(2*bt-1)*P),N(H[ee+2*bt-0],255&Vt,Vt>>16,ct,We+(2*bt-0)*P),oe!=null&&(Kt=Er+Nr>>1,Vt=Gt+ja>>1,N(oe[le+2*bt-1],255&Kt,Kt>>16,it,vt+(2*bt-1)*P),N(oe[le+2*bt+0],255&Vt,Vt>>16,it,vt+(2*bt+0)*P)),Vt=Mr,Nr=ja}1&At||(Kt=3*Vt+Nr+131074>>2,N(H[ee+At-1],255&Kt,Kt>>16,ct,We+(At-1)*P),oe!=null&&(Kt=3*Nr+Vt+131074>>2,N(oe[le+At-1],255&Kt,Kt>>16,it,vt+(At-1)*P)))}}function Du(){Hn[Xf]=Hl,Hn[Qn]=Fc,Hn[Kf]=wh,Hn[Zs]=td,Hn[qu]=ll,Hn[Oc]=Qi,Hn[sl]=cl,Hn[zu]=Fc,Hn[Jf]=td,Hn[Rc]=ll,Hn[Zf]=Qi}function Nc(y){return y&-16384?0>y?0:255:y>>rd}function Wi(y,N){return Nc((19077*y>>8)+(26149*N>>8)-14234)}function bi(y,N,P){return Nc((19077*y>>8)-(6419*N>>8)-(13320*P>>8)+8708)}function Ml(y,N){return Nc((19077*y>>8)+(33050*N>>8)-17685)}function ko(y,N,P,H,ee){H[ee+0]=Wi(y,P),H[ee+1]=bi(y,N,P),H[ee+2]=Ml(y,N)}function Cn(y,N,P,H,ee){H[ee+0]=Ml(y,N),H[ee+1]=bi(y,N,P),H[ee+2]=Wi(y,P)}function rl(y,N,P,H,ee){var oe=bi(y,N,P);N=oe<<3&224|Ml(y,N)>>3,H[ee+0]=248&Wi(y,P)|oe>>5,H[ee+1]=N}function al(y,N,P,H,ee){var oe=240&Ml(y,N)|15;H[ee+0]=240&Wi(y,P)|bi(y,N,P)>>4,H[ee+1]=oe}function kc(y,N,P,H,ee){H[ee+0]=255,ko(y,N,P,H,ee+1)}function Vi(y,N,P,H,ee){Cn(y,N,P,H,ee),H[ee+3]=255}function fs(y,N,P,H,ee){ko(y,N,P,H,ee),H[ee+3]=255}function jo(y,N,P){L[y]=function(H,ee,oe,le,me,be,Ee,Fe,Ke){for(var je=Fe+(-2&Ke)*P;Fe!=je;)N(H[ee+0],oe[le+0],me[be+0],Ee,Fe),N(H[ee+1],oe[le+0],me[be+0],Ee,Fe+P),ee+=2,++le,++be,Fe+=2*P;1&Ke&&N(H[ee+0],oe[le+0],me[be+0],Ee,Fe)}}function jc(y,N,P){return P==0?y==0?N==0?6:5:N==0?4:0:P}function Fu(y,N,P,H,ee){switch(y>>>30){case 3:Ro(N,P,H,ee,0);break;case 2:Jn(N,P,H,ee);break;case 1:Jr(N,P,H,ee)}}function qs(y,N){var P,H,ee=N.M,oe=N.Nb,le=y.oc,me=y.pc+40,be=y.oc,Ee=y.pc+584,Fe=y.oc,Ke=y.pc+600;for(P=0;16>P;++P)le[me+32*P-1]=129;for(P=0;8>P;++P)be[Ee+32*P-1]=129,Fe[Ke+32*P-1]=129;for(0<ee?le[me-1-32]=be[Ee-1-32]=Fe[Ke-1-32]=129:(n(le,me-32-1,127,21),n(be,Ee-32-1,127,9),n(Fe,Ke-32-1,127,9)),H=0;H<y.za;++H){var je=N.ya[N.aa+H];if(0<H){for(P=-1;16>P;++P)a(le,me+32*P-4,le,me+32*P+12,4);for(P=-1;8>P;++P)a(be,Ee+32*P-4,be,Ee+32*P+4,4),a(Fe,Ke+32*P-4,Fe,Ke+32*P+4,4)}var Ie=y.Gd,$e=y.Hd+H,ct=je.ad,We=je.Hc;if(0<ee&&(a(le,me-32,Ie[$e].y,0,16),a(be,Ee-32,Ie[$e].f,0,8),a(Fe,Ke-32,Ie[$e].ea,0,8)),je.Za){var it=le,vt=me-32+16;for(0<ee&&(H>=y.za-1?n(it,vt,Ie[$e].y[15],4):a(it,vt,Ie[$e+1].y,0,4)),P=0;4>P;P++)it[vt+128+P]=it[vt+256+P]=it[vt+384+P]=it[vt+0+P];for(P=0;16>P;++P,We<<=2)it=le,vt=me+Ja[P],Ha[je.Ob[P]](it,vt),Fu(We,ct,16*+P,it,vt)}else if(it=jc(H,ee,je.Ob[0]),hs[it](le,me),We!=0)for(P=0;16>P;++P,We<<=2)Fu(We,ct,16*+P,le,me+Ja[P]);for(P=je.Gc,it=jc(H,ee,je.Dd),ki[it](be,Ee),ki[it](Fe,Ke),We=ct,it=be,vt=Ee,255&(je=0|P)&&(170&je?Ks(We,256,it,vt):Wr(We,256,it,vt)),je=Fe,We=Ke,255&(P>>=8)&&(170&P?Ks(ct,320,je,We):Wr(ct,320,je,We)),ee<y.Ub-1&&(a(Ie[$e].y,0,le,me+480,16),a(Ie[$e].f,0,be,Ee+224,8),a(Ie[$e].ea,0,Fe,Ke+224,8)),P=8*oe*y.B,Ie=y.sa,$e=y.ta+16*H+16*oe*y.R,ct=y.qa,je=y.ra+8*H+P,We=y.Ha,it=y.Ia+8*H+P,P=0;16>P;++P)a(Ie,$e+P*y.R,le,me+32*P,16);for(P=0;8>P;++P)a(ct,je+P*y.B,be,Ee+32*P,8),a(We,it+P*y.B,Fe,Ke+32*P,8)}}function wi(y,N,P,H,ee,oe,le,me,be){var Ee=[0],Fe=[0],Ke=0,je=be!=null?be.kd:0,Ie=be??new St;if(y==null||12>P)return 7;Ie.data=y,Ie.w=N,Ie.ha=P,N=[N],P=[P],Ie.gb=[Ie.gb];e:{var $e=N,ct=P,We=Ie.gb;if(e(y!=null),e(ct!=null),e(We!=null),We[0]=0,12<=ct[0]&&!r(y,$e[0],"RIFF")){if(r(y,$e[0]+8,"WEBP")){We=3;break e}var it=mt(y,$e[0]+4);if(12>it||4294967286<it){We=3;break e}if(je&&it>ct[0]-8){We=7;break e}We[0]=it,$e[0]+=12,ct[0]-=12}We=0}if(We!=0)return We;for(it=0<Ie.gb[0],P=P[0];;){e:{var vt=y;ct=N,We=P;var At=Ee,bt=Fe,tr=$e=[0];if((Kt=Ke=[Ke])[0]=0,8>We[0])We=7;else{if(!r(vt,ct[0],"VP8X")){if(mt(vt,ct[0]+4)!=10){We=3;break e}if(18>We[0]){We=7;break e}var Vt=mt(vt,ct[0]+8),Nr=1+st(vt,ct[0]+12);if(2147483648<=Nr*(vt=1+st(vt,ct[0]+15))){We=3;break e}tr!=null&&(tr[0]=Vt),At!=null&&(At[0]=Nr),bt!=null&&(bt[0]=vt),ct[0]+=18,We[0]-=18,Kt[0]=1}We=0}}if(Ke=Ke[0],$e=$e[0],We!=0)return We;if(ct=!!(2&$e),!it&&Ke)return 3;if(oe!=null&&(oe[0]=!!(16&$e)),le!=null&&(le[0]=ct),me!=null&&(me[0]=0),le=Ee[0],$e=Fe[0],Ke&&ct&&be==null){We=0;break}if(4>P){We=7;break}if(it&&Ke||!it&&!Ke&&!r(y,N[0],"ALPH")){P=[P],Ie.na=[Ie.na],Ie.P=[Ie.P],Ie.Sa=[Ie.Sa];e:{Vt=y,We=N,it=P;var Kt=Ie.gb;At=Ie.na,bt=Ie.P,tr=Ie.Sa,Nr=22,e(Vt!=null),e(it!=null),vt=We[0];var Mr=it[0];for(e(At!=null),e(tr!=null),At[0]=null,bt[0]=null,tr[0]=0;;){if(We[0]=vt,it[0]=Mr,8>Mr){We=7;break e}var ja=mt(Vt,vt+4);if(4294967286<ja){We=3;break e}var Er=8+ja+1&-2;if(Nr+=Er,0<Kt&&Nr>Kt){We=3;break e}if(!r(Vt,vt,"VP8 ")||!r(Vt,vt,"VP8L")){We=0;break e}if(Mr[0]<Er){We=7;break e}r(Vt,vt,"ALPH")||(At[0]=Vt,bt[0]=vt+8,tr[0]=ja),vt+=Er,Mr-=Er}}if(P=P[0],Ie.na=Ie.na[0],Ie.P=Ie.P[0],Ie.Sa=Ie.Sa[0],We!=0)break}P=[P],Ie.Ja=[Ie.Ja],Ie.xa=[Ie.xa];e:if(Kt=y,We=N,it=P,At=Ie.gb[0],bt=Ie.Ja,tr=Ie.xa,Vt=We[0],vt=!r(Kt,Vt,"VP8 "),Nr=!r(Kt,Vt,"VP8L"),e(Kt!=null),e(it!=null),e(bt!=null),e(tr!=null),8>it[0])We=7;else{if(vt||Nr){if(Kt=mt(Kt,Vt+4),12<=At&&Kt>At-12){We=3;break e}if(je&&Kt>it[0]-8){We=7;break e}bt[0]=Kt,We[0]+=8,it[0]-=8,tr[0]=Nr}else tr[0]=5<=it[0]&&Kt[Vt+0]==47&&!(Kt[Vt+4]>>5),bt[0]=it[0];We=0}if(P=P[0],Ie.Ja=Ie.Ja[0],Ie.xa=Ie.xa[0],N=N[0],We!=0)break;if(4294967286<Ie.Ja)return 3;if(me==null||ct||(me[0]=Ie.xa?2:1),le=[le],$e=[$e],Ie.xa){if(5>P){We=7;break}me=le,je=$e,ct=oe,y==null||5>P?y=0:5<=P&&y[N+0]==47&&!(y[N+4]>>5)?(it=[0],Kt=[0],At=[0],re(bt=new F,y,N,P),os(bt,it,Kt,At)?(me!=null&&(me[0]=it[0]),je!=null&&(je[0]=Kt[0]),ct!=null&&(ct[0]=At[0]),y=1):y=0):y=0}else{if(10>P){We=7;break}me=$e,y==null||10>P||!Su(y,N+3,P-3)?y=0:(je=y[N+0]|y[N+1]<<8|y[N+2]<<16,ct=16383&(y[N+7]<<8|y[N+6]),y=16383&(y[N+9]<<8|y[N+8]),1&je||3<(je>>1&7)||!(je>>4&1)||je>>5>=Ie.Ja||!ct||!y?y=0:(le&&(le[0]=ct),me&&(me[0]=y),y=1))}if(!y||(le=le[0],$e=$e[0],Ke&&(Ee[0]!=le||Fe[0]!=$e)))return 3;be!=null&&(be[0]=Ie,be.offset=N-be.w,e(4294967286>N-be.w),e(be.offset==be.ha-P));break}return We==0||We==7&&Ke&&be==null?(oe!=null&&(oe[0]|=Ie.na!=null&&0<Ie.na.length),H!=null&&(H[0]=le),ee!=null&&(ee[0]=$e),0):We}function Eo(y,N,P){var H=N.width,ee=N.height,oe=0,le=0,me=H,be=ee;if(N.Da=y!=null&&0<y.Da,N.Da&&(me=y.cd,be=y.bd,oe=y.v,le=y.j,11>P||(oe&=-2,le&=-2),0>oe||0>le||0>=me||0>=be||oe+me>H||le+be>ee))return 0;if(N.v=oe,N.j=le,N.va=oe+me,N.o=le+be,N.U=me,N.T=be,N.da=y!=null&&0<y.da,N.da){if(!ye(me,be,P=[y.ib],oe=[y.hb]))return 0;N.ib=P[0],N.hb=oe[0]}return N.ob=y!=null&&y.ob,N.Kb=y==null||!y.Sd,N.da&&(N.ob=N.ib<3*H/4&&N.hb<3*ee/4,N.Kb=0),1}function Lu(y){if(y==null)return 2;if(11>y.S){var N=y.f.RGBA;N.fb+=(y.height-1)*N.A,N.A=-N.A}else N=y.f.kb,y=y.height,N.O+=(y-1)*N.fa,N.fa=-N.fa,N.N+=(y-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(y-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(y-1)*N.lb,N.lb=-N.lb);return 0}function Si(y,N,P,H){if(H==null||0>=y||0>=N)return 2;if(P!=null){if(P.Da){var ee=P.cd,oe=P.bd,le=-2&P.v,me=-2&P.j;if(0>le||0>me||0>=ee||0>=oe||le+ee>y||me+oe>N)return 2;y=ee,N=oe}if(P.da){if(!ye(y,N,ee=[P.ib],oe=[P.hb]))return 2;y=ee[0],N=oe[0]}}H.width=y,H.height=N;e:{var be=H.width,Ee=H.height;if(y=H.S,0>=be||0>=Ee||!(y>=Xf&&13>y))y=2;else{if(0>=H.Rd&&H.sd==null){le=oe=ee=N=0;var Fe=(me=be*nd[y])*Ee;if(11>y||(oe=(Ee+1)/2*(N=(be+1)/2),y==12&&(le=(ee=be)*Ee)),(Ee=s(Fe+2*oe+le))==null){y=1;break e}H.sd=Ee,11>y?((be=H.f.RGBA).eb=Ee,be.fb=0,be.A=me,be.size=Fe):((be=H.f.kb).y=Ee,be.O=0,be.fa=me,be.Fd=Fe,be.f=Ee,be.N=0+Fe,be.Ab=N,be.Cd=oe,be.ea=Ee,be.W=0+Fe+oe,be.Db=N,be.Ed=oe,y==12&&(be.F=Ee,be.J=0+Fe+2*oe),be.Tc=le,be.lb=ee)}if(N=1,ee=H.S,oe=H.width,le=H.height,ee>=Xf&&13>ee)if(11>ee)y=H.f.RGBA,N&=(me=Math.abs(y.A))*(le-1)+oe<=y.size,N&=me>=oe*nd[ee],N&=y.eb!=null;else{y=H.f.kb,me=(oe+1)/2,Fe=(le+1)/2,be=Math.abs(y.fa),Ee=Math.abs(y.Ab);var Ke=Math.abs(y.Db),je=Math.abs(y.lb),Ie=je*(le-1)+oe;N&=be*(le-1)+oe<=y.Fd,N&=Ee*(Fe-1)+me<=y.Cd,N=(N&=Ke*(Fe-1)+me<=y.Ed)&be>=oe&Ee>=me&Ke>=me,N&=y.y!=null,N&=y.f!=null,N&=y.ea!=null,ee==12&&(N&=je>=oe,N&=Ie<=y.Tc,N&=y.F!=null)}else N=0;y=N?0:2}}return y!=0||P!=null&&P.fd&&(y=Lu(H)),y}var nl=64,ws=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ds=24,Gi=32,Yi=8,Ao=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Xe("Predictor0","PredictorAdd0"),L.Predictor0=function(){return 4278190080},L.Predictor1=function(y){return y},L.Predictor2=function(y,N,P){return N[P+0]},L.Predictor3=function(y,N,P){return N[P+1]},L.Predictor4=function(y,N,P){return N[P-1]},L.Predictor5=function(y,N,P){return jt(jt(y,N[P+1]),N[P+0])},L.Predictor6=function(y,N,P){return jt(y,N[P-1])},L.Predictor7=function(y,N,P){return jt(y,N[P+0])},L.Predictor8=function(y,N,P){return jt(N[P-1],N[P+0])},L.Predictor9=function(y,N,P){return jt(N[P+0],N[P+1])},L.Predictor10=function(y,N,P){return jt(jt(y,N[P-1]),jt(N[P+0],N[P+1]))},L.Predictor11=function(y,N,P){var H=N[P+0];return 0>=et(H>>24&255,y>>24&255,(N=N[P-1])>>24&255)+et(H>>16&255,y>>16&255,N>>16&255)+et(H>>8&255,y>>8&255,N>>8&255)+et(255&H,255&y,255&N)?H:y},L.Predictor12=function(y,N,P){var H=N[P+0];return(Dt((y>>24&255)+(H>>24&255)-((N=N[P-1])>>24&255))<<24|Dt((y>>16&255)+(H>>16&255)-(N>>16&255))<<16|Dt((y>>8&255)+(H>>8&255)-(N>>8&255))<<8|Dt((255&y)+(255&H)-(255&N)))>>>0},L.Predictor13=function(y,N,P){var H=N[P-1];return(Wt((y=jt(y,N[P+0]))>>24&255,H>>24&255)<<24|Wt(y>>16&255,H>>16&255)<<16|Wt(y>>8&255,H>>8&255)<<8|Wt(255&y,255&H))>>>0};var Ec=L.PredictorAdd0;L.PredictorAdd1=ht,Xe("Predictor2","PredictorAdd2"),Xe("Predictor3","PredictorAdd3"),Xe("Predictor4","PredictorAdd4"),Xe("Predictor5","PredictorAdd5"),Xe("Predictor6","PredictorAdd6"),Xe("Predictor7","PredictorAdd7"),Xe("Predictor8","PredictorAdd8"),Xe("Predictor9","PredictorAdd9"),Xe("Predictor10","PredictorAdd10"),Xe("Predictor11","PredictorAdd11"),Xe("Predictor12","PredictorAdd12"),Xe("Predictor13","PredictorAdd13");var Ac=L.PredictorAdd2;wt("ColorIndexInverseTransform","MapARGB","32b",function(y){return y>>8&255},function(y){return y}),wt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(y){return y},function(y){return y>>8&255});var Xa,Vf=L.ColorIndexInverseTransform,Xi=L.MapARGB,Ki=L.VP8LColorIndexInverseTransformAlpha,Un=L.MapAlpha,Co=L.VP8LPredictorsAdd=[];Co.length=16,(L.VP8LPredictors=[]).length=16,(L.VP8LPredictorsAdd_C=[]).length=16,(L.VP8LPredictors_C=[]).length=16;var Cc,Tc,To,Oo,Ji,Il,zs,Ro,Jn,Ks,Jr,Wr,xa,Ka,Zi,Ni,Bl,Pu,vh,nm,sm,im,xh,yh,Ul,Js,Mu,Hs,ql=s(511),Gf=s(2041),Iu=s(225),Bu=s(767),Yf=0,Do=Gf,Uu=Iu,Zn=Bu,qn=ql,Xf=0,Qn=1,Kf=2,Zs=3,qu=4,Oc=5,sl=6,zu=7,Jf=8,Rc=9,Zf=10,Qs=[2,3,7],Dc=[3,3,11],zl=[280,256,256,256,40],Qf=[0,1,1,1,0],Hu=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ei=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ti=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],il=8,ri=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ai=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],$s=null,om=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],_h=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ed=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],lm=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],zn=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ka=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Br=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],hs=[],Ha=[],ki=[],ol=1,bh=2,Fo=[],Hn=[];No("UpsampleRgbLinePair",ko,3),No("UpsampleBgrLinePair",Cn,3),No("UpsampleRgbaLinePair",fs,4),No("UpsampleBgraLinePair",Vi,4),No("UpsampleArgbLinePair",kc,4),No("UpsampleRgba4444LinePair",al,2),No("UpsampleRgb565LinePair",rl,2);var Hl=L.UpsampleRgbLinePair,wh=L.UpsampleBgrLinePair,Fc=L.UpsampleRgbaLinePair,td=L.UpsampleBgraLinePair,ll=L.UpsampleArgbLinePair,Qi=L.UpsampleRgba4444LinePair,cl=L.UpsampleRgb565LinePair,ni=16,Lc=1<<ni-1,$l=-227,ul=482,rd=6,fl=0,$n=s(256),ad=s(256),cm=s(256),A1=s(256),C1=s(ul-$l),T1=s(ul-$l);jo("YuvToRgbRow",ko,3),jo("YuvToBgrRow",Cn,3),jo("YuvToRgbaRow",fs,4),jo("YuvToBgraRow",Vi,4),jo("YuvToArgbRow",kc,4),jo("YuvToRgba4444Row",al,2),jo("YuvToRgb565Row",rl,2);var Ja=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Pc=[0,2,8],$u=[8,7,6,4,4,2,2,2,1,1,1,1],Wu=1;this.WebPDecodeRGBA=function(y,N,P,H,ee){var oe=Qn,le=new gt,me=new or;le.ba=me,me.S=oe,me.width=[me.width],me.height=[me.height];var be=me.width,Ee=me.height,Fe=new Ht;if(Fe==null||y==null)var Ke=2;else e(Fe!=null),Ke=wi(y,N,P,Fe.width,Fe.height,Fe.Pd,Fe.Qd,Fe.format,null);if(Ke!=0?be=0:(be!=null&&(be[0]=Fe.width[0]),Ee!=null&&(Ee[0]=Fe.height[0]),be=1),be){me.width=me.width[0],me.height=me.height[0],H!=null&&(H[0]=me.width),ee!=null&&(ee[0]=me.height);e:{if(H=new po,(ee=new St).data=y,ee.w=N,ee.ha=P,ee.kd=1,N=[0],e(ee!=null),((y=wi(ee.data,ee.w,ee.ha,null,null,null,N,null,ee))==0||y==7)&&N[0]&&(y=4),(N=y)==0){if(e(le!=null),H.data=ee.data,H.w=ee.w+ee.offset,H.ha=ee.ha-ee.offset,H.put=ar,H.ac=Oa,H.bc=za,H.ma=le,ee.xa){if((y=Ge())==null){le=1;break e}if((function(je,Ie){var $e=[0],ct=[0],We=[0];t:for(;;){if(je==null)return 0;if(Ie==null)return je.a=2,0;if(je.l=Ie,je.a=0,re(je.m,Ie.data,Ie.w,Ie.ha),!os(je.m,$e,ct,We)){je.a=3;break t}if(je.xb=bh,Ie.width=$e[0],Ie.height=ct[0],!Ye($e[0],ct[0],1,je,null))break t;return 1}return e(je.a!=0),0})(y,H)){if(H=(N=Si(H.width,H.height,le.Oa,le.ba))==0){t:{H=y;r:for(;;){if(H==null){H=0;break t}if(e(H.s.yc!=null),e(H.s.Ya!=null),e(0<H.s.Wb),e((P=H.l)!=null),e((ee=P.ma)!=null),H.xb!=0){if(H.ca=ee.ba,H.tb=ee.tb,e(H.ca!=null),!Eo(ee.Oa,P,Zs)){H.a=2;break r}if(!Je(H,P.width)||P.da)break r;if((P.da||Me(H.ca.S))&&_i(),11>H.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),H.ca.f.kb.F!=null&&_i()),H.Pb&&0<H.s.ua&&H.s.vb.X==null&&!he(H.s.vb,H.s.Wa.Xa)){H.a=1;break r}H.xb=0}if(!He(H,H.V,H.Ba,H.c,H.i,P.o,ge))break r;ee.Dc=H.Ma,H=1;break t}e(H.a!=0),H=0}H=!H}H&&(N=y.a)}else N=y.a}else{if((y=new vi)==null){le=1;break e}if(y.Fa=ee.na,y.P=ee.P,y.qc=ee.Sa,zi(y,H)){if((N=Si(H.width,H.height,le.Oa,le.ba))==0){if(y.Aa=0,P=le.Oa,e((ee=y)!=null),P!=null){if(0<(be=0>(be=P.Md)?0:100<be?255:255*be/100)){for(Ee=Fe=0;4>Ee;++Ee)12>(Ke=ee.pb[Ee]).lc&&(Ke.ia=be*$u[0>Ke.lc?0:Ke.lc]>>3),Fe|=Ke.ia;Fe&&(alert("todo:VP8InitRandom"),ee.ia=1)}ee.Ga=P.Id,100<ee.Ga?ee.Ga=100:0>ee.Ga&&(ee.Ga=0)}(function(je,Ie){if(je==null)return 0;if(Ie==null)return Kr(je,2,"NULL VP8Io parameter in VP8Decode().");if(!je.cb&&!zi(je,Ie))return 0;if(e(je.cb),Ie.ac==null||Ie.ac(Ie)){Ie.ob&&(je.L=0);var $e=Pc[je.L];if(je.L==2?(je.yb=0,je.zb=0):(je.yb=Ie.v-$e>>4,je.zb=Ie.j-$e>>4,0>je.yb&&(je.yb=0),0>je.zb&&(je.zb=0)),je.Va=Ie.o+15+$e>>4,je.Hb=Ie.va+15+$e>>4,je.Hb>je.za&&(je.Hb=je.za),je.Va>je.Ub&&(je.Va=je.Ub),0<je.L){var ct=je.ed;for($e=0;4>$e;++$e){var We;if(je.Qa.Cb){var it=je.Qa.Lb[$e];je.Qa.Fb||(it+=ct.Tb)}else it=ct.Tb;for(We=0;1>=We;++We){var vt=je.gd[$e][We],At=it;if(ct.Pc&&(At+=ct.vd[0],We&&(At+=ct.od[0])),0<(At=0>At?0:63<At?63:At)){var bt=At;0<ct.wb&&(bt=4<ct.wb?bt>>2:bt>>1)>9-ct.wb&&(bt=9-ct.wb),1>bt&&(bt=1),vt.dd=bt,vt.tc=2*At+bt,vt.ld=40<=At?2:15<=At?1:0}else vt.tc=0;vt.La=We}}}$e=0}else Kr(je,6,"Frame setup failed"),$e=je.a;if($e=$e==0){if($e){je.$c=0,0<je.Aa||(je.Ic=Wu);t:{$e=je.Ic,ct=4*(bt=je.za);var tr=32*bt,Vt=bt+1,Nr=0<je.L?bt*(0<je.Aa?2:1):0,Kt=(je.Aa==2?2:1)*bt;if((vt=ct+832+(We=3*(16*$e+Pc[je.L])/2*tr)+(it=je.Fa!=null&&0<je.Fa.length?je.Kc.c*je.Kc.i:0))!=vt)$e=0;else{if(vt>je.Vb){if(je.Vb=0,je.Ec=s(vt),je.Fc=0,je.Ec==null){$e=Kr(je,1,"no memory during frame initialization.");break t}je.Vb=vt}vt=je.Ec,At=je.Fc,je.Ac=vt,je.Bc=At,At+=ct,je.Gd=l(tr,Is),je.Hd=0,je.rb=l(Vt+1,ca),je.sb=1,je.wa=Nr?l(Nr,Lr):null,je.Y=0,je.D.Nb=0,je.D.wa=je.wa,je.D.Y=je.Y,0<je.Aa&&(je.D.Y+=bt),e(!0),je.oc=vt,je.pc=At,At+=832,je.ya=l(Kt,pi),je.aa=0,je.D.ya=je.ya,je.D.aa=je.aa,je.Aa==2&&(je.D.aa+=bt),je.R=16*bt,je.B=8*bt,bt=(tr=Pc[je.L])*je.R,tr=tr/2*je.B,je.sa=vt,je.ta=At+bt,je.qa=je.sa,je.ra=je.ta+16*$e*je.R+tr,je.Ha=je.qa,je.Ia=je.ra+8*$e*je.B+tr,je.$c=0,At+=We,je.mb=it?vt:null,je.nb=it?At:null,e(At+it<=je.Fc+je.Vb),Nu(je),n(je.Ac,je.Bc,0,ct),$e=1}}if($e){if(Ie.ka=0,Ie.y=je.sa,Ie.O=je.ta,Ie.f=je.qa,Ie.N=je.ra,Ie.ea=je.Ha,Ie.Vd=je.Ia,Ie.fa=je.R,Ie.Rc=je.B,Ie.F=null,Ie.J=0,!Yf){for($e=-255;255>=$e;++$e)ql[255+$e]=0>$e?-$e:$e;for($e=-1020;1020>=$e;++$e)Gf[1020+$e]=-128>$e?-128:127<$e?127:$e;for($e=-112;112>=$e;++$e)Iu[112+$e]=-16>$e?-16:15<$e?15:$e;for($e=-255;510>=$e;++$e)Bu[255+$e]=0>$e?0:255<$e?255:$e;Yf=1}zs=xi,Ro=ku,Ks=us,Jr=ju,Wr=Eu,Jn=Mf,xa=$f,Ka=wo,Zi=Q,Ni=Ae,Bl=Wf,Pu=O,vh=Oe,nm=qe,sm=xo,im=yo,xh=Pl,yh=Ru,Ha[0]=zf,Ha[1]=If,Ha[2]=qf,Ha[3]=Tu,Ha[4]=Bs,Ha[5]=Ou,Ha[6]=In,Ha[7]=Dl,Ha[8]=Fl,Ha[9]=Us,hs[0]=yi,hs[1]=Au,hs[2]=Cu,hs[3]=Uf,hs[4]=go,hs[5]=Rl,hs[6]=tl,ki[0]=bc,ki[1]=Bf,ki[2]=Hi,ki[3]=Hf,ki[4]=An,ki[5]=wc,ki[6]=$i,$e=1}else $e=0}$e&&($e=(function(Mr,ja){for(Mr.M=0;Mr.M<Mr.Va;++Mr.M){var Er,Gt=Mr.Jc[Mr.M&Mr.Xb],Bt=Mr.m,Fa=Mr;for(Er=0;Er<Fa.za;++Er){var gr=Bt,Tr=Fa,ia=Tr.Ac,xn=Tr.Bc+4*Er,Wn=Tr.zc,ya=Tr.ya[Tr.aa+Er];if(Tr.Qa.Bb?ya.$b=_e(gr,Tr.Pa.jb[0])?2+_e(gr,Tr.Pa.jb[2]):_e(gr,Tr.Pa.jb[1]):ya.$b=0,Tr.kc&&(ya.Ad=_e(gr,Tr.Bd)),ya.Za=!_e(gr,145)+0,ya.Za){var sn=ya.Ob,es=0;for(Tr=0;4>Tr;++Tr){var on,Fr=Wn[0+Tr];for(on=0;4>on;++on){Fr=zn[ia[xn+on]][Fr];for(var Gr=ed[_e(gr,Fr[0])];0<Gr;)Gr=ed[2*Gr+_e(gr,Fr[Gr])];Fr=-Gr,ia[xn+on]=Fr}a(sn,es,ia,xn,4),es+=4,Wn[0+Tr]=Fr}}else Fr=_e(gr,156)?_e(gr,128)?1:3:_e(gr,163)?2:0,ya.Ob[0]=Fr,n(ia,xn,Fr,4),n(Wn,0,Fr,4);ya.Dd=_e(gr,142)?_e(gr,114)?_e(gr,183)?1:3:2:0}if(Fa.m.Ka)return Kr(Mr,7,"Premature end-of-partition0 encountered.");for(;Mr.ja<Mr.za;++Mr.ja){if(Fa=Gt,gr=(Bt=Mr).rb[Bt.sb-1],ia=Bt.rb[Bt.sb+Bt.ja],Er=Bt.ya[Bt.aa+Bt.ja],xn=Bt.kc?Er.Ad:0)gr.la=ia.la=0,Er.Za||(gr.Na=ia.Na=0),Er.Hc=0,Er.Gc=0,Er.ia=0;else{var La,Zr;if(gr=ia,ia=Fa,xn=Bt.Pa.Xc,Wn=Bt.ya[Bt.aa+Bt.ja],ya=Bt.pb[Wn.$b],Tr=Wn.ad,sn=0,es=Bt.rb[Bt.sb-1],Fr=on=0,n(Tr,sn,0,384),Wn.Za)var yn=0,Pa=xn[3];else{Gr=s(16);var Yr=gr.Na+es.Na;if(Yr=$s(ia,xn[1],Yr,ya.Eb,0,Gr,0),gr.Na=es.Na=(0<Yr)+0,1<Yr)zs(Gr,0,Tr,sn);else{var Za=Gr[0]+3>>3;for(Gr=0;256>Gr;Gr+=16)Tr[sn+Gr]=Za}yn=1,Pa=xn[0]}var oa=15&gr.la,ln=15&es.la;for(Gr=0;4>Gr;++Gr){var cn=1&ln;for(Za=Zr=0;4>Za;++Za)oa=oa>>1|(cn=(Yr=$s(ia,Pa,Yr=cn+(1&oa),ya.Sc,yn,Tr,sn))>yn)<<7,Zr=Zr<<2|(3<Yr?3:1<Yr?2:Tr[sn+0]!=0),sn+=16;oa>>=4,ln=ln>>1|cn<<7,on=(on<<8|Zr)>>>0}for(Pa=oa,yn=ln>>4,La=0;4>La;La+=2){for(Zr=0,oa=gr.la>>4+La,ln=es.la>>4+La,Gr=0;2>Gr;++Gr){for(cn=1&ln,Za=0;2>Za;++Za)Yr=cn+(1&oa),oa=oa>>1|(cn=0<(Yr=$s(ia,xn[2],Yr,ya.Qc,0,Tr,sn)))<<3,Zr=Zr<<2|(3<Yr?3:1<Yr?2:Tr[sn+0]!=0),sn+=16;oa>>=2,ln=ln>>1|cn<<5}Fr|=Zr<<4*La,Pa|=oa<<4<<La,yn|=(240&ln)<<La}gr.la=Pa,es.la=yn,Wn.Hc=on,Wn.Gc=Fr,Wn.ia=43690&Fr?0:ya.ia,xn=!(on|Fr)}if(0<Bt.L&&(Bt.wa[Bt.Y+Bt.ja]=Bt.gd[Er.$b][Er.Za],Bt.wa[Bt.Y+Bt.ja].La|=!xn),Fa.Ka)return Kr(Mr,7,"Premature end-of-file encountered.")}if(Nu(Mr),Bt=ja,Fa=1,Er=(Gt=Mr).D,gr=0<Gt.L&&Gt.M>=Gt.zb&&Gt.M<=Gt.Va,Gt.Aa==0)t:{if(Er.M=Gt.M,Er.uc=gr,qs(Gt,Er),Fa=1,Er=(Zr=Gt.D).Nb,gr=(Fr=Pc[Gt.L])*Gt.R,ia=Fr/2*Gt.B,Gr=16*Er*Gt.R,Za=8*Er*Gt.B,xn=Gt.sa,Wn=Gt.ta-gr+Gr,ya=Gt.qa,Tr=Gt.ra-ia+Za,sn=Gt.Ha,es=Gt.Ia-ia+Za,ln=(oa=Zr.M)==0,on=oa>=Gt.Va-1,Gt.Aa==2&&qs(Gt,Zr),Zr.uc)for(cn=(Yr=Gt).D.M,e(Yr.D.uc),Zr=Yr.yb;Zr<Yr.Hb;++Zr){yn=Zr,Pa=cn;var ua=(Vr=(un=Yr).D).Nb;La=un.R;var Vr=Vr.wa[Vr.Y+yn],ts=un.sa,$a=un.ta+16*ua*La+16*yn,ur=Vr.dd,fr=Vr.tc;if(fr!=0)if(e(3<=fr),un.L==1)0<yn&&im(ts,$a,La,fr+4),Vr.La&&yh(ts,$a,La,fr),0<Pa&&sm(ts,$a,La,fr+4),Vr.La&&xh(ts,$a,La,fr);else{var Xr=un.B,Ss=un.qa,si=un.ra+8*ua*Xr+8*yn,ms=un.Ha,un=un.Ia+8*ua*Xr+8*yn;ua=Vr.ld,0<yn&&(Ka(ts,$a,La,fr+4,ur,ua),Ni(Ss,si,ms,un,Xr,fr+4,ur,ua)),Vr.La&&(Pu(ts,$a,La,fr,ur,ua),nm(Ss,si,ms,un,Xr,fr,ur,ua)),0<Pa&&(xa(ts,$a,La,fr+4,ur,ua),Zi(Ss,si,ms,un,Xr,fr+4,ur,ua)),Vr.La&&(Bl(ts,$a,La,fr,ur,ua),vh(Ss,si,ms,un,Xr,fr,ur,ua))}}if(Gt.ia&&alert("todo:DitherRow"),Bt.put!=null){if(Zr=16*oa,oa=16*(oa+1),ln?(Bt.y=Gt.sa,Bt.O=Gt.ta+Gr,Bt.f=Gt.qa,Bt.N=Gt.ra+Za,Bt.ea=Gt.Ha,Bt.W=Gt.Ia+Za):(Zr-=Fr,Bt.y=xn,Bt.O=Wn,Bt.f=ya,Bt.N=Tr,Bt.ea=sn,Bt.W=es),on||(oa-=Fr),oa>Bt.o&&(oa=Bt.o),Bt.F=null,Bt.J=null,Gt.Fa!=null&&0<Gt.Fa.length&&Zr<oa&&(Bt.J=va(Gt,Bt,Zr,oa-Zr),Bt.F=Gt.mb,Bt.F==null&&Bt.F.length==0)){Fa=Kr(Gt,3,"Could not decode alpha data.");break t}Zr<Bt.j&&(Fr=Bt.j-Zr,Zr=Bt.j,e(!(1&Fr)),Bt.O+=Gt.R*Fr,Bt.N+=Gt.B*(Fr>>1),Bt.W+=Gt.B*(Fr>>1),Bt.F!=null&&(Bt.J+=Bt.width*Fr)),Zr<oa&&(Bt.O+=Bt.v,Bt.N+=Bt.v>>1,Bt.W+=Bt.v>>1,Bt.F!=null&&(Bt.J+=Bt.v),Bt.ka=Zr-Bt.j,Bt.U=Bt.va-Bt.v,Bt.T=oa-Zr,Fa=Bt.put(Bt))}Er+1!=Gt.Ic||on||(a(Gt.sa,Gt.ta-gr,xn,Wn+16*Gt.R,gr),a(Gt.qa,Gt.ra-ia,ya,Tr+8*Gt.B,ia),a(Gt.Ha,Gt.Ia-ia,sn,es+8*Gt.B,ia))}if(!Fa)return Kr(Mr,6,"Output aborted.")}return 1})(je,Ie)),Ie.bc!=null&&Ie.bc(Ie),$e&=1}return $e?(je.cb=0,$e):0})(y,H)||(N=y.a)}}else N=y.a}N==0&&le.Oa!=null&&le.Oa.fd&&(N=Lu(le.ba))}le=N}oe=le!=0?null:11>oe?me.f.RGBA.eb:me.f.kb.y}else oe=null;return oe};var nd=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(L,J){for(var D="",T=0;T<4;T++)D+=String.fromCharCode(L[J++]);return D}function m(L,J){return L[J+0]|L[J+1]<<8}function v(L,J){return(L[J+0]|L[J+1]<<8|L[J+2]<<16)>>>0}function x(L,J){return(L[J+0]|L[J+1]<<8|L[J+2]<<16|L[J+3]<<24)>>>0}new f;var g=[0],b=[0],_=[],w=new f,A=t,C=(function(L,J){var D={},T=0,M=!1,V=0,ie=0;if(D.frames=[],!(function(k,F){for(var I=0;I<4;I++)if(k[F+I]!="RIFF".charCodeAt(I))return!0;return!1})(L,J)){for(x(L,J+=4),J+=8;J<L.length;){var X=d(L,J),Z=x(L,J+=4);J+=4;var K=Z+(1&Z);switch(X){case"VP8 ":case"VP8L":D.frames[T]===void 0&&(D.frames[T]={}),(U=D.frames[T]).src_off=M?ie:J-8,U.src_size=V+Z+8,T++,M&&(M=!1,V=0,ie=0);break;case"VP8X":(U=D.header={}).feature_flags=L[J];var re=J+4;U.canvas_width=1+v(L,re),re+=3,U.canvas_height=1+v(L,re),re+=3;break;case"ALPH":M=!0,V=K+8,ie=J-8;break;case"ANIM":(U=D.header).bgcolor=x(L,J),re=J+4,U.loop_count=m(L,re),re+=2;break;case"ANMF":var de,U;(U=D.frames[T]={}).offset_x=2*v(L,J),J+=3,U.offset_y=2*v(L,J),J+=3,U.width=1+v(L,J),J+=3,U.height=1+v(L,J),J+=3,U.duration=v(L,J),J+=3,de=L[J++],U.dispose=1&de,U.blend=de>>1&1}X!="ANMF"&&(J+=K)}return D}})(A,0);C.response=A,C.rgbaoutput=!0,C.dataurl=!1;var E=C.header?C.header:null,R=C.frames?C.frames:null;if(E){E.loop_counter=E.loop_count,g=[E.canvas_height],b=[E.canvas_width];for(var Y=0;Y<R.length&&R[Y].blend!=0;Y++);}var W=R[0],B=w.WebPDecodeRGBA(A,W.src_off,W.src_size,b,g);W.rgba=B,W.imgwidth=b[0],W.imgheight=g[0];for(var q=0;q<b[0]*g[0]*4;q++)_[q]=B[q];return this.width=b,this.height=g,this.data=_,this}(function(t){var e,r,a,n,s,l,c,f,d,m=function(k){return k=k||{},this.isStrokeTransparent=k.isStrokeTransparent||!1,this.strokeOpacity=k.strokeOpacity||1,this.strokeStyle=k.strokeStyle||"#000000",this.fillStyle=k.fillStyle||"#000000",this.isFillTransparent=k.isFillTransparent||!1,this.fillOpacity=k.fillOpacity||1,this.font=k.font||"10px sans-serif",this.textBaseline=k.textBaseline||"alphabetic",this.textAlign=k.textAlign||"left",this.lineWidth=k.lineWidth||1,this.lineJoin=k.lineJoin||"miter",this.lineCap=k.lineCap||"butt",this.path=k.path||[],this.transform=k.transform!==void 0?k.transform.clone():new f,this.globalCompositeOperation=k.globalCompositeOperation||"normal",this.globalAlpha=k.globalAlpha||1,this.clip_path=k.clip_path||[],this.currentPoint=k.currentPoint||new l,this.miterLimit=k.miterLimit||10,this.lastPoint=k.lastPoint||new l,this.lineDashOffset=k.lineDashOffset||0,this.lineDash=k.lineDash||[],this.margin=k.margin||[0,0,0,0],this.prevPageLastElemOffset=k.prevPageLastElemOffset||0,this.ignoreClearRect=typeof k.ignoreClearRect!="boolean"||k.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new v(this),e=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,l=this.internal.Point,c=this.internal.Rectangle,f=this.internal.Matrix,d=new m}]);var v=function(k){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var F=k;Object.defineProperty(this,"pdf",{get:function(){return F}});var I=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return I},set:function(he){I=!!he}});var z=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return z},set:function(he){z=!!he}});var te=0;Object.defineProperty(this,"posX",{get:function(){return te},set:function(he){isNaN(he)||(te=he)}});var se=0;Object.defineProperty(this,"posY",{get:function(){return se},set:function(he){isNaN(he)||(se=he)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(he){var at;typeof he=="number"?at=[he,he,he,he]:((at=new Array(4))[0]=he[0],at[1]=he.length>=2?he[1]:at[0],at[2]=he.length>=3?he[2]:at[0],at[3]=he.length>=4?he[3]:at[1]),d.margin=at}});var pe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return pe},set:function(he){pe=he}});var ve=0;Object.defineProperty(this,"lastBreak",{get:function(){return ve},set:function(he){ve=he}});var _e=[];Object.defineProperty(this,"pageBreaks",{get:function(){return _e},set:function(he){_e=he}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(he){he instanceof m&&(d=he)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(he){d.path=he}});var Pe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Pe},set:function(he){Pe=he}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(he){var at;at=x(he),this.ctx.fillStyle=at.style,this.ctx.isFillTransparent=at.a===0,this.ctx.fillOpacity=at.a,this.pdf.setFillColor(at.r,at.g,at.b,{a:at.a}),this.pdf.setTextColor(at.r,at.g,at.b,{a:at.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(he){var at=x(he);this.ctx.strokeStyle=at.style,this.ctx.isStrokeTransparent=at.a===0,this.ctx.strokeOpacity=at.a,at.a===0?this.pdf.setDrawColor(255,255,255):(at.a,this.pdf.setDrawColor(at.r,at.g,at.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(he){["butt","round","square"].indexOf(he)!==-1&&(this.ctx.lineCap=he,this.pdf.setLineCap(he))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(he){isNaN(he)||(this.ctx.lineWidth=he,this.pdf.setLineWidth(he))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(he){["bevel","round","miter"].indexOf(he)!==-1&&(this.ctx.lineJoin=he,this.pdf.setLineJoin(he))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(he){isNaN(he)||(this.ctx.miterLimit=he,this.pdf.setMiterLimit(he))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(he){this.ctx.textBaseline=he}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(he){["right","end","center","left","start"].indexOf(he)!==-1&&(this.ctx.textAlign=he)}});var fe=null,st=null,mt=null;Object.defineProperty(this,"fontFaces",{get:function(){return mt},set:function(he){fe=null,st=null,mt=he}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(he){var at;if(this.ctx.font=he,(at=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(he))!==null){var we=at[1];at[2];var ye=at[3],Be=at[4];at[5];var Et=at[6],Xe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Be)[2];Be=Math.floor(Xe==="px"?parseFloat(Be)*this.pdf.internal.scaleFactor:Xe==="em"?parseFloat(Be)*this.pdf.getFontSize():parseFloat(Be)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Be);var lt=(function(wt){var Lt,Pt,zt=[],Ce=wt.trim();if(Ce==="")return Pv;if(Ce in hS)return[hS[Ce]];for(;Ce!=="";){switch(Pt=null,Lt=(Ce=pS(Ce)).charAt(0)){case'"':case"'":Pt=wz(Ce.substring(1),Lt);break;default:Pt=Sz(Ce)}if(Pt===null||(zt.push(Pt[0]),(Ce=pS(Pt[1]))!==""&&Ce.charAt(0)!==","))return Pv;Ce=Ce.replace(/^,/,"")}return zt})(Et);if(this.fontFaces){var jt=(function(wt,Lt){var Pt=wt.getFontList(),zt=JSON.stringify(Pt);if(fe===null||st!==zt){var Ce=(function(Ve){var ce=[];return Object.keys(Ve).forEach(function(Re){Ve[Re].forEach(function(Me){var Tt=null;switch(Me){case"bold":Tt={family:Re,weight:"bold"};break;case"italic":Tt={family:Re,style:"italic"};break;case"bolditalic":Tt={family:Re,weight:"bold",style:"italic"};break;case"":case"normal":Tt={family:Re}}Tt!==null&&(Tt.ref={name:Re,style:Me},ce.push(Tt))})}),ce})(Pt);fe=(function(Ve){for(var ce={},Re=0;Re<Ve.length;++Re){var Me=Lv(Ve[Re]),Tt=Me.family,$t=Me.stretch,or=Me.style,Ht=Me.weight;ce[Tt]=ce[Tt]||{},ce[Tt][$t]=ce[Tt][$t]||{},ce[Tt][$t][or]=ce[Tt][$t][or]||{},ce[Tt][$t][or][Ht]=Me}return ce})(Ce.concat(Lt)),st=zt}return fe})(this.pdf,this.fontFaces),Dt=lt.map(function(wt){return{family:wt,stretch:"normal",weight:ye,style:we}}),Wt=(function(wt,Lt,Pt){for(var zt=(Pt=Pt||{}).defaultFontFamily||"times",Ce=Object.assign({},bz,Pt.genericFontFamilies||{}),Ve=null,ce=null,Re=0;Re<Lt.length;++Re)if(Ce[(Ve=Lv(Lt[Re])).family]&&(Ve.family=Ce[Ve.family]),wt.hasOwnProperty(Ve.family)){ce=wt[Ve.family];break}if(!(ce=ce||wt[zt]))throw new Error("Could not find a font-family for the rule '"+mS(Ve)+"' and default family '"+zt+"'.");if(ce=(function(Me,Tt){if(Tt[Me])return Tt[Me];var $t=Mx[Me],or=$t<=Mx.normal?-1:1,Ht=dS(Tt,Zk,$t,or);if(!Ht)throw new Error("Could not find a matching font-stretch value for "+Me);return Ht})(Ve.stretch,ce),ce=(function(Me,Tt){if(Tt[Me])return Tt[Me];for(var $t=Jk[Me],or=0;or<$t.length;++or)if(Tt[$t[or]])return Tt[$t[or]];throw new Error("Could not find a matching font-style for "+Me)})(Ve.style,ce),!(ce=(function(Me,Tt){if(Tt[Me])return Tt[Me];if(Me===400&&Tt[500])return Tt[500];if(Me===500&&Tt[400])return Tt[400];var $t=_z[Me],or=dS(Tt,Qk,$t,Me<400?-1:1);if(!or)throw new Error("Could not find a matching font-weight for value "+Me);return or})(Ve.weight,ce)))throw new Error("Failed to resolve a font for the rule '"+mS(Ve)+"'.");return ce})(jt,Dt);this.pdf.setFont(Wt.ref.name,Wt.ref.style)}else{var et="";(ye==="bold"||parseInt(ye,10)>=700||we==="bold")&&(et="bold"),we==="italic"&&(et+="italic"),et.length===0&&(et="normal");for(var ht="",yt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ft=0;ft<lt.length;ft++){if(this.pdf.internal.getFont(lt[ft],et,{noFallback:!0,disableWarning:!0})!==void 0){ht=lt[ft];break}if(et==="bolditalic"&&this.pdf.internal.getFont(lt[ft],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ht=lt[ft],et="bold";else if(this.pdf.internal.getFont(lt[ft],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ht=lt[ft],et="normal";break}}if(ht===""){for(var pt=0;pt<lt.length;pt++)if(yt[lt[pt]]){ht=yt[lt[pt]];break}}ht=ht===""?"Times":ht,this.pdf.setFont(ht,et)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(he){this.ctx.globalCompositeOperation=he}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(he){this.ctx.globalAlpha=he}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(he){this.ctx.lineDashOffset=he,U.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(he){this.ctx.lineDash=he,U.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(he){this.ctx.ignoreClearRect=!!he}})};v.prototype.setLineDash=function(k){this.lineDash=k},v.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},v.prototype.fill=function(){R.call(this,"fill",!1)},v.prototype.stroke=function(){R.call(this,"stroke",!1)},v.prototype.beginPath=function(){this.path=[{type:"begin"}]},v.prototype.moveTo=function(k,F){if(isNaN(k)||isNaN(F))throw Aa.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var I=this.ctx.transform.applyToPoint(new l(k,F));this.path.push({type:"mt",x:I.x,y:I.y}),this.ctx.lastPoint=new l(k,F)},v.prototype.closePath=function(){var k=new l(0,0),F=0;for(F=this.path.length-1;F!==-1;F--)if(this.path[F].type==="begin"&&pa(this.path[F+1])==="object"&&typeof this.path[F+1].x=="number"){k=new l(this.path[F+1].x,this.path[F+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(k.x,k.y)},v.prototype.lineTo=function(k,F){if(isNaN(k)||isNaN(F))throw Aa.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var I=this.ctx.transform.applyToPoint(new l(k,F));this.path.push({type:"lt",x:I.x,y:I.y}),this.ctx.lastPoint=new l(I.x,I.y)},v.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),R.call(this,null,!0)},v.prototype.quadraticCurveTo=function(k,F,I,z){if(isNaN(I)||isNaN(z)||isNaN(k)||isNaN(F))throw Aa.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var te=this.ctx.transform.applyToPoint(new l(I,z)),se=this.ctx.transform.applyToPoint(new l(k,F));this.path.push({type:"qct",x1:se.x,y1:se.y,x:te.x,y:te.y}),this.ctx.lastPoint=new l(te.x,te.y)},v.prototype.bezierCurveTo=function(k,F,I,z,te,se){if(isNaN(te)||isNaN(se)||isNaN(k)||isNaN(F)||isNaN(I)||isNaN(z))throw Aa.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var pe=this.ctx.transform.applyToPoint(new l(te,se)),ve=this.ctx.transform.applyToPoint(new l(k,F)),_e=this.ctx.transform.applyToPoint(new l(I,z));this.path.push({type:"bct",x1:ve.x,y1:ve.y,x2:_e.x,y2:_e.y,x:pe.x,y:pe.y}),this.ctx.lastPoint=new l(pe.x,pe.y)},v.prototype.arc=function(k,F,I,z,te,se){if(isNaN(k)||isNaN(F)||isNaN(I)||isNaN(z)||isNaN(te))throw Aa.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(se=!!se,!this.ctx.transform.isIdentity){var pe=this.ctx.transform.applyToPoint(new l(k,F));k=pe.x,F=pe.y;var ve=this.ctx.transform.applyToPoint(new l(0,I)),_e=this.ctx.transform.applyToPoint(new l(0,0));I=Math.sqrt(Math.pow(ve.x-_e.x,2)+Math.pow(ve.y-_e.y,2))}Math.abs(te-z)>=2*Math.PI&&(z=0,te=2*Math.PI),this.path.push({type:"arc",x:k,y:F,radius:I,startAngle:z,endAngle:te,counterclockwise:se})},v.prototype.arcTo=function(k,F,I,z,te){throw new Error("arcTo not implemented.")},v.prototype.rect=function(k,F,I,z){if(isNaN(k)||isNaN(F)||isNaN(I)||isNaN(z))throw Aa.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(k,F),this.lineTo(k+I,F),this.lineTo(k+I,F+z),this.lineTo(k,F+z),this.lineTo(k,F),this.lineTo(k+I,F),this.lineTo(k,F)},v.prototype.fillRect=function(k,F,I,z){if(isNaN(k)||isNaN(F)||isNaN(I)||isNaN(z))throw Aa.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var te={};this.lineCap!=="butt"&&(te.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(te.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(k,F,I,z),this.fill(),te.hasOwnProperty("lineCap")&&(this.lineCap=te.lineCap),te.hasOwnProperty("lineJoin")&&(this.lineJoin=te.lineJoin)}},v.prototype.strokeRect=function(k,F,I,z){if(isNaN(k)||isNaN(F)||isNaN(I)||isNaN(z))throw Aa.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(k,F,I,z),this.stroke())},v.prototype.clearRect=function(k,F,I,z){if(isNaN(k)||isNaN(F)||isNaN(I)||isNaN(z))throw Aa.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(k,F,I,z))},v.prototype.save=function(k){k=typeof k!="boolean"||k;for(var F=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("q");if(this.pdf.setPage(F),k){this.ctx.fontSize=this.pdf.internal.getFontSize();var z=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=z}},v.prototype.restore=function(k){k=typeof k!="boolean"||k;for(var F=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("Q");this.pdf.setPage(F),k&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},v.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(k){var F,I,z,te;if(k.isCanvasGradient===!0&&(k=k.getColor()),!k)return{r:0,g:0,b:0,a:0,style:k};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(k))F=0,I=0,z=0,te=0;else{var se=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(k);if(se!==null)F=parseInt(se[1]),I=parseInt(se[2]),z=parseInt(se[3]),te=1;else if((se=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(k))!==null)F=parseInt(se[1]),I=parseInt(se[2]),z=parseInt(se[3]),te=parseFloat(se[4]);else{if(te=1,typeof k=="string"&&k.charAt(0)!=="#"){var pe=new $k(k);k=pe.ok?pe.toHex():"#000000"}k.length===4?(F=k.substring(1,2),F+=F,I=k.substring(2,3),I+=I,z=k.substring(3,4),z+=z):(F=k.substring(1,3),I=k.substring(3,5),z=k.substring(5,7)),F=parseInt(F,16),I=parseInt(I,16),z=parseInt(z,16)}}return{r:F,g:I,b:z,a:te,style:k}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};v.prototype.fillText=function(k,F,I,z){if(isNaN(F)||isNaN(I)||typeof k!="string")throw Aa.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(z=isNaN(z)?void 0:z,!g.call(this)){var te=K(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;T.call(this,{text:k,x:F,y:I,scale:se,angle:te,align:this.textAlign,maxWidth:z})}},v.prototype.strokeText=function(k,F,I,z){if(isNaN(F)||isNaN(I)||typeof k!="string")throw Aa.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){z=isNaN(z)?void 0:z;var te=K(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;T.call(this,{text:k,x:F,y:I,scale:se,renderingMode:"stroke",angle:te,align:this.textAlign,maxWidth:z})}},v.prototype.measureText=function(k){if(typeof k!="string")throw Aa.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var F=this.pdf,I=this.pdf.internal.scaleFactor,z=F.internal.getFontSize(),te=F.getStringUnitWidth(k)*z/F.internal.scaleFactor;return new function(se){var pe=(se=se||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return pe}}),this}({width:te*=Math.round(96*I/72*1e4)/1e4})},v.prototype.scale=function(k,F){if(isNaN(k)||isNaN(F))throw Aa.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var I=new f(k,0,0,F,0,0);this.ctx.transform=this.ctx.transform.multiply(I)},v.prototype.rotate=function(k){if(isNaN(k))throw Aa.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var F=new f(Math.cos(k),Math.sin(k),-Math.sin(k),Math.cos(k),0,0);this.ctx.transform=this.ctx.transform.multiply(F)},v.prototype.translate=function(k,F){if(isNaN(k)||isNaN(F))throw Aa.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var I=new f(1,0,0,1,k,F);this.ctx.transform=this.ctx.transform.multiply(I)},v.prototype.transform=function(k,F,I,z,te,se){if(isNaN(k)||isNaN(F)||isNaN(I)||isNaN(z)||isNaN(te)||isNaN(se))throw Aa.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var pe=new f(k,F,I,z,te,se);this.ctx.transform=this.ctx.transform.multiply(pe)},v.prototype.setTransform=function(k,F,I,z,te,se){k=isNaN(k)?1:k,F=isNaN(F)?0:F,I=isNaN(I)?0:I,z=isNaN(z)?1:z,te=isNaN(te)?0:te,se=isNaN(se)?0:se,this.ctx.transform=new f(k,F,I,z,te,se)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};v.prototype.drawImage=function(k,F,I,z,te,se,pe,ve,_e){var Pe=this.pdf.getImageProperties(k),fe=1,st=1,mt=1,he=1;z!==void 0&&ve!==void 0&&(mt=ve/z,he=_e/te,fe=Pe.width/z*ve/z,st=Pe.height/te*_e/te),se===void 0&&(se=F,pe=I,F=0,I=0),z!==void 0&&ve===void 0&&(ve=z,_e=te),z===void 0&&ve===void 0&&(ve=Pe.width,_e=Pe.height);var at=this.ctx.transform.decompose(),we=K(at.rotate.shx),ye=new f,Be=(ye=(ye=(ye=ye.multiply(at.translate)).multiply(at.skew)).multiply(at.scale)).applyToRectangle(new c(se-F*mt,pe-I*he,z*fe,te*st));if(this.autoPaging){for(var Et,Xe=w.call(this,Be),lt=[],jt=0;jt<Xe.length;jt+=1)lt.indexOf(Xe[jt])===-1&&lt.push(Xe[jt]);E(lt);for(var Dt=lt[0],Wt=lt[lt.length-1],et=Dt;et<Wt+1;et++){this.pdf.setPage(et);var ht=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],yt=et===1?this.posY+this.margin[0]:this.margin[0],ft=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],pt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],wt=et===1?0:ft+(et-2)*pt;if(this.ctx.clip_path.length!==0){var Lt=this.path;Et=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(Et,this.posX+this.margin[3],-wt+yt+this.ctx.prevPageLastElemOffset),Y.call(this,"fill",!0),this.path=Lt}var Pt=JSON.parse(JSON.stringify(Be));Pt=C([Pt],this.posX+this.margin[3],-wt+yt+this.ctx.prevPageLastElemOffset)[0];var zt=(et>Dt||et<Wt)&&_.call(this);zt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ht,pt,null).clip().discardPath()),this.pdf.addImage(k,"JPEG",Pt.x,Pt.y,Pt.w,Pt.h,null,null,we),zt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(k,"JPEG",Be.x,Be.y,Be.w,Be.h,null,null,we)};var w=function(k,F,I){var z=[];F=F||this.pdf.internal.pageSize.width,I=I||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var te=this.posY+this.ctx.prevPageLastElemOffset;switch(k.type){default:case"mt":case"lt":z.push(Math.floor((k.y+te)/I)+1);break;case"arc":z.push(Math.floor((k.y+te-k.radius)/I)+1),z.push(Math.floor((k.y+te+k.radius)/I)+1);break;case"qct":var se=re(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x,k.y);z.push(Math.floor((se.y+te)/I)+1),z.push(Math.floor((se.y+se.h+te)/I)+1);break;case"bct":var pe=de(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x2,k.y2,k.x,k.y);z.push(Math.floor((pe.y+te)/I)+1),z.push(Math.floor((pe.y+pe.h+te)/I)+1);break;case"rect":z.push(Math.floor((k.y+te)/I)+1),z.push(Math.floor((k.y+k.h+te)/I)+1)}for(var ve=0;ve<z.length;ve+=1)for(;this.pdf.internal.getNumberOfPages()<z[ve];)A.call(this);return z},A=function(){var k=this.fillStyle,F=this.strokeStyle,I=this.font,z=this.lineCap,te=this.lineWidth,se=this.lineJoin;this.pdf.addPage(),this.fillStyle=k,this.strokeStyle=F,this.font=I,this.lineCap=z,this.lineWidth=te,this.lineJoin=se},C=function(k,F,I){for(var z=0;z<k.length;z++)switch(k[z].type){case"bct":k[z].x2+=F,k[z].y2+=I;case"qct":k[z].x1+=F,k[z].y1+=I;default:k[z].x+=F,k[z].y+=I}return k},E=function(k){return k.sort(function(F,I){return F-I})},R=function(k,F){var I=this.fillStyle,z=this.strokeStyle,te=this.lineCap,se=this.lineWidth,pe=Math.abs(se*this.ctx.transform.scaleX),ve=this.lineJoin;if(this.autoPaging){for(var _e,Pe,fe=JSON.parse(JSON.stringify(this.path)),st=JSON.parse(JSON.stringify(this.path)),mt=[],he=0;he<st.length;he++)if(st[he].x!==void 0)for(var at=w.call(this,st[he]),we=0;we<at.length;we+=1)mt.indexOf(at[we])===-1&&mt.push(at[we]);for(var ye=0;ye<mt.length;ye++)for(;this.pdf.internal.getNumberOfPages()<mt[ye];)A.call(this);E(mt);for(var Be=mt[0],Et=mt[mt.length-1],Xe=Be;Xe<Et+1;Xe++){this.pdf.setPage(Xe),this.fillStyle=I,this.strokeStyle=z,this.lineCap=te,this.lineWidth=pe,this.lineJoin=ve;var lt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],jt=Xe===1?this.posY+this.margin[0]:this.margin[0],Dt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Wt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],et=Xe===1?0:Dt+(Xe-2)*Wt;if(this.ctx.clip_path.length!==0){var ht=this.path;_e=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(_e,this.posX+this.margin[3],-et+jt+this.ctx.prevPageLastElemOffset),Y.call(this,k,!0),this.path=ht}if(Pe=JSON.parse(JSON.stringify(fe)),this.path=C(Pe,this.posX+this.margin[3],-et+jt+this.ctx.prevPageLastElemOffset),F===!1||Xe===0){var yt=(Xe>Be||Xe<Et)&&_.call(this);yt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lt,Wt,null).clip().discardPath()),Y.call(this,k,F),yt&&this.pdf.restoreGraphicsState()}this.lineWidth=se}this.path=fe}else this.lineWidth=pe,Y.call(this,k,F),this.lineWidth=se},Y=function(k,F){if((k!=="stroke"||F||!b.call(this))&&(k==="stroke"||F||!g.call(this))){for(var I,z,te=[],se=this.path,pe=0;pe<se.length;pe++){var ve=se[pe];switch(ve.type){case"begin":te.push({begin:!0});break;case"close":te.push({close:!0});break;case"mt":te.push({start:ve,deltas:[],abs:[]});break;case"lt":var _e=te.length;if(se[pe-1]&&!isNaN(se[pe-1].x)&&(I=[ve.x-se[pe-1].x,ve.y-se[pe-1].y],_e>0)){for(;_e>=0;_e--)if(te[_e-1].close!==!0&&te[_e-1].begin!==!0){te[_e-1].deltas.push(I),te[_e-1].abs.push(ve);break}}break;case"bct":I=[ve.x1-se[pe-1].x,ve.y1-se[pe-1].y,ve.x2-se[pe-1].x,ve.y2-se[pe-1].y,ve.x-se[pe-1].x,ve.y-se[pe-1].y],te[te.length-1].deltas.push(I);break;case"qct":var Pe=se[pe-1].x+2/3*(ve.x1-se[pe-1].x),fe=se[pe-1].y+2/3*(ve.y1-se[pe-1].y),st=ve.x+2/3*(ve.x1-ve.x),mt=ve.y+2/3*(ve.y1-ve.y),he=ve.x,at=ve.y;I=[Pe-se[pe-1].x,fe-se[pe-1].y,st-se[pe-1].x,mt-se[pe-1].y,he-se[pe-1].x,at-se[pe-1].y],te[te.length-1].deltas.push(I);break;case"arc":te.push({deltas:[],abs:[],arc:!0}),Array.isArray(te[te.length-1].abs)&&te[te.length-1].abs.push(ve)}}z=F?null:k==="stroke"?"stroke":"fill";for(var we=!1,ye=0;ye<te.length;ye++)if(te[ye].arc)for(var Be=te[ye].abs,Et=0;Et<Be.length;Et++){var Xe=Be[Et];Xe.type==="arc"?q.call(this,Xe.x,Xe.y,Xe.radius,Xe.startAngle,Xe.endAngle,Xe.counterclockwise,void 0,F,!we):M.call(this,Xe.x,Xe.y),we=!0}else if(te[ye].close===!0)this.pdf.internal.out("h"),we=!1;else if(te[ye].begin!==!0){var lt=te[ye].start.x,jt=te[ye].start.y;V.call(this,te[ye].deltas,lt,jt),we=!0}z&&L.call(this,z),F&&J.call(this)}},W=function(k){var F=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,I=F*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return k-I;case"top":return k+F-I;case"hanging":return k+F-2*I;case"middle":return k+F/2-I;default:return k}},B=function(k){return k+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};v.prototype.createLinearGradient=function(){var k=function(){};return k.colorStops=[],k.addColorStop=function(F,I){this.colorStops.push([F,I])},k.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},k.isCanvasGradient=!0,k},v.prototype.createPattern=function(){return this.createLinearGradient()},v.prototype.createRadialGradient=function(){return this.createLinearGradient()};var q=function(k,F,I,z,te,se,pe,ve,_e){for(var Pe=X.call(this,I,z,te,se),fe=0;fe<Pe.length;fe++){var st=Pe[fe];fe===0&&(_e?D.call(this,st.x1+k,st.y1+F):M.call(this,st.x1+k,st.y1+F)),ie.call(this,k,F,st.x2,st.y2,st.x3,st.y3,st.x4,st.y4)}ve?J.call(this):L.call(this,pe)},L=function(k){switch(k){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},J=function(){this.pdf.clip(),this.pdf.discardPath()},D=function(k,F){this.pdf.internal.out(r(k)+" "+a(F)+" m")},T=function(k){var F;switch(k.align){case"right":case"end":F="right";break;case"center":F="center";break;default:F="left"}var I,z,te,se=this.pdf.getTextDimensions(k.text),pe=W.call(this,k.y),ve=B.call(this,pe)-se.h,_e=this.ctx.transform.applyToPoint(new l(k.x,pe));if(this.autoPaging){var Pe=this.ctx.transform.decompose(),fe=new f;fe=(fe=(fe=fe.multiply(Pe.translate)).multiply(Pe.skew)).multiply(Pe.scale);for(var st=this.ctx.transform.applyToRectangle(new c(k.x,pe,se.w,se.h)),mt=fe.applyToRectangle(new c(k.x,ve,se.w,se.h)),he=w.call(this,mt),at=[],we=0;we<he.length;we+=1)at.indexOf(he[we])===-1&&at.push(he[we]);E(at);for(var ye=at[0],Be=at[at.length-1],Et=ye;Et<Be+1;Et++){this.pdf.setPage(Et);var Xe=Et===1?this.posY+this.margin[0]:this.margin[0],lt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],jt=this.pdf.internal.pageSize.height-this.margin[2],Dt=jt-this.margin[0],Wt=this.pdf.internal.pageSize.width-this.margin[1],et=Wt-this.margin[3],ht=Et===1?0:lt+(Et-2)*Dt;if(this.ctx.clip_path.length!==0){var yt=this.path;I=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(I,this.posX+this.margin[3],-1*ht+Xe),Y.call(this,"fill",!0),this.path=yt}var ft=C([JSON.parse(JSON.stringify(mt))],this.posX+this.margin[3],-ht+Xe+this.ctx.prevPageLastElemOffset)[0];k.scale>=.01&&(z=this.pdf.internal.getFontSize(),this.pdf.setFontSize(z*k.scale),te=this.lineWidth,this.lineWidth=te*k.scale);var pt=this.autoPaging!=="text";if(pt||ft.y+ft.h<=jt){if(pt||ft.y>=Xe&&ft.x<=Wt){var wt=pt?k.text:this.pdf.splitTextToSize(k.text,k.maxWidth||Wt-ft.x)[0],Lt=C([JSON.parse(JSON.stringify(st))],this.posX+this.margin[3],-ht+Xe+this.ctx.prevPageLastElemOffset)[0],Pt=pt&&(Et>ye||Et<Be)&&_.call(this);Pt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],et,Dt,null).clip().discardPath()),this.pdf.text(wt,Lt.x,Lt.y,{angle:k.angle,align:F,renderingMode:k.renderingMode}),Pt&&this.pdf.restoreGraphicsState()}}else ft.y<jt&&(this.ctx.prevPageLastElemOffset+=jt-ft.y);k.scale>=.01&&(this.pdf.setFontSize(z),this.lineWidth=te)}}else k.scale>=.01&&(z=this.pdf.internal.getFontSize(),this.pdf.setFontSize(z*k.scale),te=this.lineWidth,this.lineWidth=te*k.scale),this.pdf.text(k.text,_e.x+this.posX,_e.y+this.posY,{angle:k.angle,align:F,renderingMode:k.renderingMode,maxWidth:k.maxWidth}),k.scale>=.01&&(this.pdf.setFontSize(z),this.lineWidth=te)},M=function(k,F,I,z){I=I||0,z=z||0,this.pdf.internal.out(r(k+I)+" "+a(F+z)+" l")},V=function(k,F,I){return this.pdf.lines(k,F,I,null,null)},ie=function(k,F,I,z,te,se,pe,ve){this.pdf.internal.out([e(n(I+k)),e(s(z+F)),e(n(te+k)),e(s(se+F)),e(n(pe+k)),e(s(ve+F)),"c"].join(" "))},X=function(k,F,I,z){for(var te=2*Math.PI,se=Math.PI/2;F>I;)F-=te;var pe=Math.abs(I-F);pe<te&&z&&(pe=te-pe);for(var ve=[],_e=z?-1:1,Pe=F;pe>1e-5;){var fe=Pe+_e*Math.min(pe,se);ve.push(Z.call(this,k,Pe,fe)),pe-=Math.abs(fe-Pe),Pe=fe}return ve},Z=function(k,F,I){var z=(I-F)/2,te=k*Math.cos(z),se=k*Math.sin(z),pe=te,ve=-se,_e=pe*pe+ve*ve,Pe=_e+pe*te+ve*se,fe=4/3*(Math.sqrt(2*_e*Pe)-Pe)/(pe*se-ve*te),st=pe-fe*ve,mt=ve+fe*pe,he=st,at=-mt,we=z+F,ye=Math.cos(we),Be=Math.sin(we);return{x1:k*Math.cos(F),y1:k*Math.sin(F),x2:st*ye-mt*Be,y2:st*Be+mt*ye,x3:he*ye-at*Be,y3:he*Be+at*ye,x4:k*Math.cos(I),y4:k*Math.sin(I)}},K=function(k){return 180*k/Math.PI},re=function(k,F,I,z,te,se){var pe=k+.5*(I-k),ve=F+.5*(z-F),_e=te+.5*(I-te),Pe=se+.5*(z-se),fe=Math.min(k,te,pe,_e),st=Math.max(k,te,pe,_e),mt=Math.min(F,se,ve,Pe),he=Math.max(F,se,ve,Pe);return new c(fe,mt,st-fe,he-mt)},de=function(k,F,I,z,te,se,pe,ve){var _e,Pe,fe,st,mt,he,at,we,ye,Be,Et,Xe,lt,jt,Dt=I-k,Wt=z-F,et=te-I,ht=se-z,yt=pe-te,ft=ve-se;for(Pe=0;Pe<41;Pe++)ye=(at=(fe=k+(_e=Pe/40)*Dt)+_e*((mt=I+_e*et)-fe))+_e*(mt+_e*(te+_e*yt-mt)-at),Be=(we=(st=F+_e*Wt)+_e*((he=z+_e*ht)-st))+_e*(he+_e*(se+_e*ft-he)-we),Pe==0?(Et=ye,Xe=Be,lt=ye,jt=Be):(Et=Math.min(Et,ye),Xe=Math.min(Xe,Be),lt=Math.max(lt,ye),jt=Math.max(jt,Be));return new c(Math.round(Et),Math.round(Xe),Math.round(lt-Et),Math.round(jt-Xe))},U=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var k,F,I=(k=this.ctx.lineDash,F=this.ctx.lineDashOffset,JSON.stringify({lineDash:k,lineDashOffset:F}));this.prevLineDash!==I&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=I)}}})(ir.API),(function(t){var e=function(l){var c,f,d,m,v,x,g,b,_,w;for(f=[],d=0,m=(l+=c="\0\0\0\0".slice(l.length%4||4)).length;m>d;d+=4)(v=(l.charCodeAt(d)<<24)+(l.charCodeAt(d+1)<<16)+(l.charCodeAt(d+2)<<8)+l.charCodeAt(d+3))!==0?(x=(v=((v=((v=((v=(v-(w=v%85))/85)-(_=v%85))/85)-(b=v%85))/85)-(g=v%85))/85)%85,f.push(x+33,g+33,b+33,_+33,w+33)):f.push(122);return(function(A,C){for(var E=C;E>0;E--)A.pop()})(f,c.length),String.fromCharCode.apply(String,f)+"~>"},r=function(l){var c,f,d,m,v,x=String,g="length",b=255,_="charCodeAt",w="slice",A="replace";for(l[w](-2),l=l[w](0,-2)[A](/\s/g,"")[A]("z","!!!!!"),d=[],m=0,v=(l+=c="uuuuu"[w](l[g]%5||5))[g];v>m;m+=5)f=52200625*(l[_](m)-33)+614125*(l[_](m+1)-33)+7225*(l[_](m+2)-33)+85*(l[_](m+3)-33)+(l[_](m+4)-33),d.push(b&f>>24,b&f>>16,b&f>>8,b&f);return(function(C,E){for(var R=E;R>0;R--)C.pop()})(d,c[g]),x.fromCharCode.apply(x,d)},a=function(l){return l.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">"},n=function(l){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((l=l.replace(/\s/g,"")).indexOf(">")!==-1&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),c.test(l)===!1)return"";for(var f="",d=0;d<l.length;d+=2)f+=String.fromCharCode("0x"+(l[d]+l[d+1]));return f},s=function(l){for(var c=new Uint8Array(l.length),f=l.length;f--;)c[f]=l.charCodeAt(f);return(c=Tx(c)).reduce(function(d,m){return d+String.fromCharCode(m)},"")};t.processDataByFilters=function(l,c){var f=0,d=l||"",m=[];for(typeof(c=c||[])=="string"&&(c=[c]),f=0;f<c.length;f+=1)switch(c[f]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=e(d),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=n(d),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=a(d),m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=s(d),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[f]+'" is not implemented')}return{data:d,reverseChain:m.reverse().join(" ")}}})(ir.API),(function(t){t.loadFile=function(e,r,a){return(function(n,s,l){s=s!==!1,l=typeof l=="function"?l:function(){};var c=void 0;try{c=(function(f,d,m){var v=new XMLHttpRequest,x=0,g=function(b){var _=b.length,w=[],A=String.fromCharCode;for(x=0;x<_;x+=1)w.push(A(255&b.charCodeAt(x)));return w.join("")};if(v.open("GET",f,!d),v.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(v.onload=function(){v.status===200?m(g(this.responseText)):m(void 0)}),v.send(null),d&&v.status===200)return g(v.responseText)})(n,s,l)}catch{}return c})(e,r,a)},t.loadImageFile=t.loadFile})(ir.API),(function(t){function e(){return(kr.html2canvas?Promise.resolve(kr.html2canvas):vv(()=>import("./html2canvas.esm-Ge7aVWlp.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function r(){return(kr.DOMPurify?Promise.resolve(kr.DOMPurify):vv(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var a=function(c){var f=pa(c);return f==="undefined"?"undefined":f==="string"||c instanceof String?"string":f==="number"||c instanceof Number?"number":f==="function"||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&c.nodeType===1?"element":f==="object"?"object":"unknown"},n=function(c,f){var d=document.createElement(c);for(var m in f.className&&(d.className=f.className),f.innerHTML&&f.dompurify&&(d.innerHTML=f.dompurify.sanitize(f.innerHTML)),f.style)d.style[m]=f.style[m];return d},s=function c(f,d){for(var m=f.nodeType===3?document.createTextNode(f.nodeValue):f.cloneNode(!1),v=f.firstChild;v;v=v.nextSibling)d!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||m.appendChild(c(v,d));return f.nodeType===1&&(f.nodeName==="CANVAS"?(m.width=f.width,m.height=f.height,m.getContext("2d").drawImage(f,0,0)):f.nodeName!=="TEXTAREA"&&f.nodeName!=="SELECT"||(m.value=f.value),m.addEventListener("load",function(){m.scrollTop=f.scrollTop,m.scrollLeft=f.scrollLeft},!0)),m},l=function c(f){var d=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),m=c.convert(Promise.resolve(),d);return(m=m.setProgress(1,c,1,[c])).set(f)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(c,f){return c.__proto__=f||l.prototype,c},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(c,f){return this.then(function(){switch(f=f||(function(d){switch(a(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(c),f){case"string":return this.then(r).then(function(d){return this.set({src:n("div",{innerHTML:c,dompurify:d})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},l.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},f=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);f.tagName==="BODY"&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(f),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(f){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,f(this.prop.container,d)}).then(function(f){(this.opt.html2canvas.onrendered||function(){})(f),this.prop.canvas=f,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(f){var d=this.opt.jsPDF,m=this.opt.fontFaces,v=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:v,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=m,m)for(var g=0;g<m.length;++g){var b=m[g],_=b.src.find(function(w){return w.format==="truetype"});_&&d.addFont(_.url,b.ref.name,b.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,d.context2d.save(!0),f(this.prop.container,x)}).then(function(f){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(f),this.prop.canvas=f,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(c,f,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(c,f):this.outputPdf(c,f)},l.prototype.outputPdf=function(c,f){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,f)})},l.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},l.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(c){if(a(c)!=="object")return this;var f=Object.keys(c||{}).map(function(d){if(d in l.template.prop)return function(){this.prop[d]=c[d]};switch(d){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[d]=c[d]}}},this);return this.then(function(){return this.thenList(f)})},l.prototype.get=function(c,f){return this.then(function(){var d=c in l.template.prop?this.prop[c]:this.opt[c];return f?f(d):d})},l.prototype.setMargin=function(c){return this.then(function(){switch(a(c)){case"number":c=[c,c,c,c];case"array":if(c.length===2&&(c=[c[0],c[1],c[0],c[1]]),c.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},l.prototype.setPageSize=function(c){function f(d,m){return Math.floor(d*m/72*96)}return this.then(function(){(c=c||ir.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:f(c.inner.width,c.k),height:f(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},l.prototype.setProgress=function(c,f,d,m){return c!=null&&(this.progress.val=c),f!=null&&(this.progress.state=f),d!=null&&(this.progress.n=d),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(c,f,d,m){return this.setProgress(c?this.progress.val+c:null,f||null,d?this.progress.n+d:null,m?this.progress.stack.concat(m):null)},l.prototype.then=function(c,f){var d=this;return this.thenCore(c,f,function(m,v){return d.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(x){return d.updateProgress(null,m),x}).then(m,v).then(function(x){return d.updateProgress(1),x})})},l.prototype.thenCore=function(c,f,d){d=d||Promise.prototype.then;var m=this;c&&(c=c.bind(m)),f&&(f=f.bind(m));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?m:l.convert(Object.assign({},m),Promise.prototype),x=d.call(v,c,f);return l.convert(x,m.__proto__)},l.prototype.thenExternal=function(c,f){return Promise.prototype.then.call(this,c,f)},l.prototype.thenList=function(c){var f=this;return c.forEach(function(d){f=f.thenCore(d)}),f},l.prototype.catch=function(c){c&&(c=c.bind(this));var f=Promise.prototype.catch.call(this,c);return l.convert(f,this)},l.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},l.prototype.error=function(c){return this.then(function(){throw new Error(c)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,ir.getPageSize=function(c,f,d){if(pa(c)==="object"){var m=c;c=m.orientation,f=m.unit||f,d=m.format||d}f=f||"mm",d=d||"a4",c=(""+(c||"P")).toLowerCase();var v,x=(""+d).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(f){case"pt":v=1;break;case"mm":v=72/25.4;break;case"cm":v=72/2.54;break;case"in":v=72;break;case"px":v=.75;break;case"pc":case"em":v=12;break;case"ex":v=6;break;default:throw"Invalid unit: "+f}var b,_=0,w=0;if(g.hasOwnProperty(x))_=g[x][1]/v,w=g[x][0]/v;else try{_=d[1],w=d[0]}catch{throw new Error("Invalid format: "+d)}if(c==="p"||c==="portrait")c="p",w>_&&(b=w,w=_,_=b);else{if(c!=="l"&&c!=="landscape")throw"Invalid orientation: "+c;c="l",_>w&&(b=w,w=_,_=b)}return{width:w,height:_,unit:f,k:v,orientation:c}},t.html=function(c,f){(f=f||{}).callback=f.callback||function(){},f.html2canvas=f.html2canvas||{},f.html2canvas.canvas=f.html2canvas.canvas||this.canvas,f.jsPDF=f.jsPDF||this,f.fontFaces=f.fontFaces?f.fontFaces.map(Lv):null;var d=new l(f);return f.worker?d:d.from(c).doCallback()}})(ir.API),ir.API.addJS=function(t){return vS=t,this.internal.events.subscribe("postPutResources",function(){jp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(jp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),gS=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+vS+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){jp!==void 0&&gS!==void 0&&this.internal.out("/Names <</JavaScript "+jp+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),s=0;s<n.length;s++){var l=n[s],c=a.exec(l);if(c!=null){var f=c[1];r.internal.newObjectDeferredBegin(f,!1)}r.internal.write(l)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,m=[];for(s=0;s<d;s++){var v=r.internal.newObject();m.push(v);var x=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var g=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<m.length;s++)r.internal.write("(page_"+(s+1)+")"+m[s]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+g+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,s){var l={title:n,options:s,children:[]};return a==null&&(a=this.root),a.children.push(l),l},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<a.children.length;s++){var l=a.children[s];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(a)),s>0&&this.line("/Prev "+this.makeRef(a.children[s-1])),s<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[s+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var c=this.count=this.count_r({count:0},l);if(c>0&&this.line("/Count "+c),l.options&&l.options.pageNumber){var f=r.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+f.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var d=0;d<a.children.length;d++)this.renderItems(a.children[d])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var s=0;s<n.children.length;s++)a.count++,this.count_r(a,n.children[s]);return a.count}}])})(ir.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,a,n,s,l,c){var f,d=this.decode.DCT_DECODE,m=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=l||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,f=(function(v){for(var x,g=256*v.charCodeAt(4)+v.charCodeAt(5),b=v.length,_={width:0,height:0,numcomponents:1},w=4;w<b;w+=2){if(w+=g,e.indexOf(v.charCodeAt(w+1))!==-1){x=256*v.charCodeAt(w+5)+v.charCodeAt(w+6),_={width:256*v.charCodeAt(w+7)+v.charCodeAt(w+8),height:x,numcomponents:v.charCodeAt(w+9)};break}g=256*v.charCodeAt(w+2)+v.charCodeAt(w+3)}return _})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),f.numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}m={data:r,width:f.width,height:f.height,colorSpace:c,bitsPerComponent:8,filter:d,index:a,alias:n}}return m}})(ir.API),ir.API.processPNG=function(t,e,r,a){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var n,s=iz(t,{checkCrc:!0}),l=s.width,c=s.height,f=s.channels,d=s.palette,m=s.depth;n=d&&f===1?(function(q){for(var L=q.width,J=q.height,D=q.data,T=q.palette,M=q.depth,V=!1,ie=[],X=[],Z=void 0,K=!1,re=0,de=0;de<T.length;de++){var U=b5(T[de],4),k=U[0],F=U[1],I=U[2],z=U[3];ie.push(k,F,I),z!=null&&(z===0?(re++,X.length<1&&X.push(de)):z<255&&(K=!0))}if(K||re>1){V=!0,X=void 0;var te=L*J;Z=new Uint8Array(te);for(var se=new DataView(D.buffer),pe=0;pe<te;pe++){var ve=Mv(se,pe,M),_e=b5(T[ve],4)[3];Z[pe]=_e}}else re===0&&(X=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:V?8:void 0,colorBytes:D,alphaBytes:Z,needSMask:V,palette:ie,mask:X}})(s):f===2||f===4?(function(q){for(var L=q.data,J=q.width,D=q.height,T=q.channels,M=q.depth,V=T===2?"DeviceGray":"DeviceRGB",ie=T-1,X=J*D,Z=ie,K=X*Z,re=1*X,de=Math.ceil(K*M/8),U=Math.ceil(re*M/8),k=new Uint8Array(de),F=new Uint8Array(U),I=new DataView(L.buffer),z=new DataView(k.buffer),te=new DataView(F.buffer),se=!1,pe=0;pe<X;pe++){for(var ve=pe*T,_e=0;_e<Z;_e++)jS(z,Mv(I,ve+_e,M),pe*Z+_e,M);var Pe=Mv(I,ve+Z,M);Pe<(1<<M)-1&&(se=!0),jS(te,Pe,1*pe,M)}return{colorSpace:V,colorsPerPixel:ie,sMaskBitsPerComponent:se?M:void 0,colorBytes:k,alphaBytes:F,needSMask:se}})(s):(function(q){var L=q.data,J=q.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:J,colorsPerPixel:J==="DeviceGray"?1:3,colorBytes:L instanceof Uint16Array?(function(D){for(var T=D.length,M=new Uint8Array(2*T),V=new DataView(M.buffer,M.byteOffset,M.byteLength),ie=0;ie<T;ie++)V.setUint16(2*ie,D[ie],!1);return M})(L):L,needSMask:!1}})(s);var v,x,g,b=n,_=b.colorSpace,w=b.colorsPerPixel,A=b.sMaskBitsPerComponent,C=b.colorBytes,E=b.alphaBytes,R=b.needSMask,Y=b.palette,W=b.mask,B=null;return a!==ir.API.image_compression.NONE&&typeof Tx=="function"?(B=(function(q){var L;switch(q){case ir.API.image_compression.FAST:L=11;break;case ir.API.image_compression.MEDIUM:L=13;break;case ir.API.image_compression.SLOW:L=14;break;default:L=12}return L})(a),v=this.decode.FLATE_DECODE,x="/Predictor ".concat(B," /Colors ").concat(w," /BitsPerComponent ").concat(m," /Columns ").concat(l),t=bS(C,Math.ceil(l*w*m/8),w,m,a),R&&(g=bS(E,Math.ceil(l*A/8),1,A,a))):(v=void 0,x=void 0,t=C,R&&(g=E)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(g&&this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),{alias:r,data:t,index:e,filter:v,decodeParameters:x,transparency:W,palette:Y,sMask:g,predictor:B,width:l,height:c,bitsPerComponent:m,sMaskBitsPerComponent:A,colorSpace:_}}},(function(t){t.processGIF89A=function(e,r,a,n){var s=new Ez(e),l=s.width,c=s.height,f=[];s.decodeAndBlitFrameRGBA(0,f);var d={data:f,width:l,height:c},m=new Iv(100).encode(d,100);return t.processJPEG.call(this,m,r,a,n)},t.processGIF87A=t.processGIF89A})(ir.API),zo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:n,green:a,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},zo.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Aa.log("bit decode error:"+r)}},zo.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var a=this.bottom_up?t:this.height-1-t,n=0;n<e;n++)for(var s=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+8*n*4,c=0;c<8&&8*n+c<this.width;c++){var f=this.palette[s>>7-c&1];this.data[l+4*c]=f.blue,this.data[l+4*c+1]=f.green,this.data[l+4*c+2]=f.red,this.data[l+4*c+3]=255}r!==0&&(this.pos+=4-r)}},zo.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<t;n++){var s=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+2*n*4,c=s>>4,f=15&s,d=this.palette[c];if(this.data[l]=d.blue,this.data[l+1]=d.green,this.data[l+2]=d.red,this.data[l+3]=255,2*n+1>=this.width)break;d=this.palette[f],this.data[l+4]=d.blue,this.data[l+4+1]=d.green,this.data[l+4+2]=d.red,this.data[l+4+3]=255}e!==0&&(this.pos+=4-e)}},zo.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*a;if(n<this.palette.length){var l=this.palette[n];this.data[s]=l.red,this.data[s+1]=l.green,this.data[s+2]=l.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},zo.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&e)/e*255|0,c=(s>>5&e)/e*255|0,f=(s>>10&e)/e*255|0,d=s>>15?255:0,m=a*this.width*4+4*n;this.data[m]=f,this.data[m+1]=c,this.data[m+2]=l,this.data[m+3]=d}this.pos+=t}},zo.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,s=0;s<this.width;s++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(l&e)/e*255|0,f=(l>>5&r)/r*255|0,d=(l>>11)/e*255|0,m=n*this.width*4+4*s;this.data[m]=d,this.data[m+1]=f,this.data[m+2]=c,this.data[m+3]=255}this.pos+=t}},zo.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=s,this.data[l+1]=n,this.data[l+2]=a,this.data[l+3]=255}this.pos+=this.width%4}},zo.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=e*this.width*4+4*r;this.data[c]=s,this.data[c+1]=n,this.data[c+2]=a,this.data[c+3]=l}},zo.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,a,n){var s=new zo(e,!1),l=s.width,c=s.height,f={data:s.getData(),width:l,height:c},d=new Iv(100).encode(f,100);return t.processJPEG.call(this,d,r,a,n)}})(ir.API),AS.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,a,n){var s=new AS(e),l=s.width,c=s.height,f={data:s.getData(),width:l,height:c},d=new Iv(100).encode(f,100);return t.processJPEG.call(this,d,r,a,n)}})(ir.API),ir.API.processRGBA=function(t,e,r){for(var a=t.data,n=a.length,s=new Uint8Array(n/4*3),l=new Uint8Array(n/4),c=0,f=0,d=0;d<n;d+=4){var m=a[d],v=a[d+1],x=a[d+2],g=a[d+3];s[c++]=m,s[c++]=v,s[c++]=x,l[f++]=g}var b=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:b,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},ir.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Id=ir.API,Ep=Id.getCharWidthsArray=function(t,e){var r,a,n=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),l=e.charSpace||this.internal.getCharSpace(),c=e.widths?e.widths:n.metadata.Unicode.widths,f=c.fof?c.fof:1,d=e.kerning?e.kerning:n.metadata.Unicode.kerning,m=d.fof?d.fof:1,v=e.doKerning!==!1,x=0,g=t.length,b=0,_=c[0]||f,w=[];for(r=0;r<g;r++)a=t.charCodeAt(r),typeof n.metadata.widthOfString=="function"?w.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+l*(1e3/s)||0)/1e3):(x=v&&pa(d[a])==="object"&&!isNaN(parseInt(d[a][b],10))?d[a][b]/m:0,w.push((c[a]||_)/f+x)),b=a;return w},xS=Id.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),a=e.font||this.internal.getFont(),n=e.charSpace||this.internal.getCharSpace();return Id.processArabic&&(t=Id.processArabic(t)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(t,r,n)/r:Ep.apply(this,arguments).reduce(function(s,l){return s+l},0)},yS=function(t,e,r,a){for(var n=[],s=0,l=t.length,c=0;s!==l&&c+e[s]<r;)c+=e[s],s++;n.push(t.slice(0,s));var f=s;for(c=0;s!==l;)c+e[s]>a&&(n.push(t.slice(f,s)),c=0,f=s),c+=e[s],s++;return f!==s&&n.push(t.slice(f,s)),n},_S=function(t,e,r){r||(r={});var a,n,s,l,c,f,d,m=[],v=[m],x=r.textIndent||0,g=0,b=0,_=t.split(" "),w=Ep.apply(this,[" ",r])[0];if(f=r.lineIndent===-1?_[0].length+2:r.lineIndent||0){var A=Array(f).join(" "),C=[];_.map(function(R){(R=R.split(/\s*\n/)).length>1?C=C.concat(R.map(function(Y,W){return(W&&Y.length?`
`:"")+Y})):C.push(R[0])}),_=C,f=xS.apply(this,[A,r])}for(s=0,l=_.length;s<l;s++){var E=0;if(a=_[s],f&&a[0]==`
`&&(a=a.substr(1),E=1),x+g+(b=(n=Ep.apply(this,[a,r])).reduce(function(R,Y){return R+Y},0))>e||E){if(b>e){for(c=yS.apply(this,[a,n,e-(x+g),e]),m.push(c.shift()),m=[c.pop()];c.length;)v.push([c.shift()]);b=n.slice(a.length-(m[0]?m[0].length:0)).reduce(function(R,Y){return R+Y},0)}else m=[a];v.push(m),x=b+f,g=w}else m.push(a),x+=g+b,g=w}return d=f?function(R,Y){return(Y?A:"")+R.join(" ")}:function(R){return R.join(" ")},v.map(d)},Id.splitTextToSize=function(t,e,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var v=this.internal.getFont(m.fontName,m.fontStyle),x="Unicode";return v.metadata[x]?{widths:v.metadata[x].widths||{0:1},kerning:v.metadata[x].kerning||{}}:{font:v.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(t)?t:String(t).split(/\r?\n/);var l=1*this.internal.scaleFactor*e/n;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=r.lineIndent;var c,f,d=[];for(c=0,f=a.length;c<f;c++)d=d.concat(_S.apply(this,[a[c],l,s]));return d},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",a={},n={},s=0;s<16;s++)a[r[s]]=e[s],n[e[s]]=r[s];var l=function(x){return"0x"+parseInt(x,10).toString(16)},c=t.__fontmetrics__.compress=function(x){var g,b,_,w,A=["{"];for(var C in x){if(g=x[C],isNaN(parseInt(C,10))?b="'"+C+"'":(C=parseInt(C,10),b=(b=l(C).slice(2)).slice(0,-1)+n[b.slice(-1)]),typeof g=="number")g<0?(_=l(g).slice(3),w="-"):(_=l(g).slice(2),w=""),_=w+_.slice(0,-1)+n[_.slice(-1)];else{if(pa(g)!=="object")throw new Error("Don't know what to do with value type "+pa(g)+".");_=c(g)}A.push(b+_)}return A.push("}"),A.join("")},f=t.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,b,_,w,A={},C=1,E=A,R=[],Y="",W="",B=x.length-1,q=1;q<B;q+=1)(w=x[q])=="'"?g?(_=g.join(""),g=void 0):g=[]:g?g.push(w):w=="{"?(R.push([E,_]),E={},_=void 0):w=="}"?((b=R.pop())[0][b[1]]=E,_=void 0,E=b[0]):w=="-"?C=-1:_===void 0?a.hasOwnProperty(w)?(Y+=a[w],_=parseInt(Y,16)*C,C=1,Y=""):Y+=w:a.hasOwnProperty(w)?(W+=a[w],E[_]=parseInt(W,16)*C,C=1,_=void 0,W=""):W+=w;return A},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:f("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},v={Unicode:{"Courier-Oblique":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":f("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":f("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":f("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:f("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:f("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":f("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:f("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":f("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":f("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":f("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(x){var g=x.font,b=v.Unicode[g.postScriptName];b&&(g.metadata.Unicode={},g.metadata.Unicode.widths=b.widths,g.metadata.Unicode.kerning=b.kerning);var _=m.Unicode[g.postScriptName];_&&(g.metadata.Unicode.encoding=_,g.encoding=_.codePages[0])}])})(ir.API),(function(t){var e=function(r){for(var a=r.length,n=new Uint8Array(a),s=0;s<a;s++)n[s]=r.charCodeAt(s);return n};t.API.events.push(["addFont",function(r){var a=void 0,n=r.font,s=r.instance;if(!n.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=s.existsFileInVFS(n.postScriptName)===!1?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(l,c){c=/^\x00\x01\x00\x00/.test(c)?e(c):e(Dp(c)),l.metadata=t.API.TTFFont.open(c),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(n,a)}}])})(ir),ir.API.addSvgAsImage=function(t,e,r,a,n,s,l,c){if(isNaN(e)||isNaN(r))throw Aa.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(n))throw Aa.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var f=document.createElement("canvas");f.width=a,f.height=n;var d=f.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,f.width,f.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},v=this;return(kr.canvg?Promise.resolve(kr.canvg):vv(()=>import("./index.es-BAsIjWG_.js"),[])).catch(function(x){return Promise.reject(new Error("Could not load canvg: "+x))}).then(function(x){return x.default?x.default:x}).then(function(x){return x.fromString(d,t,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(x){return x.render(m)}).then(function(){v.addImage(f.toDataURL("image/jpeg",1),e,r,a,n,l,c)})},ir.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(e,r);return this},ir.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var a,n,s,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(l),f=[],d=0,m=0,v=0;function x(b,_){var w,A=!1;for(w=0;w<b.length;w+=1)b[w]===_&&(A=!0);return A}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var g=c.length;for(v=0;v<g;v+=1)r[c[v]].value=r[c[v]].defaultValue,r[c[v]].explicitSet=!1}if(pa(t)==="object"){for(n in t)if(s=t[n],x(c,n)&&s!==void 0){if(r[n].type==="boolean"&&typeof s=="boolean")r[n].value=s;else if(r[n].type==="name"&&x(r[n].valueSet,s))r[n].value=s;else if(r[n].type==="integer"&&Number.isInteger(s))r[n].value=s;else if(r[n].type==="array"){for(d=0;d<s.length;d+=1)if(a=!0,s[d].length===1&&typeof s[d][0]=="number")f.push(String(s[d]-1));else if(s[d].length>1){for(m=0;m<s[d].length;m+=1)typeof s[d][m]!="number"&&(a=!1);a===!0&&f.push([s[d][0]-1,s[d][1]-1].join(" "))}r[n].value="["+f.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,_=[];for(b in r)r[b].explicitSet===!0&&(r[b].type==="name"?_.push("/"+b+" /"+r[b].value):_.push("/"+b+" "+r[b].value));_.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+_.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(a)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),f=unescape(encodeURIComponent("</x:xmpmeta>")),d=s.length+l.length+c.length+n.length+f.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(n+s+l+c+f),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(ir.API),(function(t){var e=t.API,r=e.pdfEscape16=function(s,l){for(var c,f=l.metadata.Unicode.widths,d=["","0","00","000","0000"],m=[""],v=0,x=s.length;v<x;++v){if(c=l.metadata.characterToGlyph(s.charCodeAt(v)),l.metadata.glyIdsUsed.push(c),l.metadata.toUnicode[c]=s.charCodeAt(v),f.indexOf(c)==-1&&(f.push(c),f.push([parseInt(l.metadata.widthOfGlyph(c),10)])),c=="0")return m.join("");c=c.toString(16),m.push(d[4-c.length],c)}return m.join("")},a=function(s){var l,c,f,d,m,v,x;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,f=[],v=0,x=(c=Object.keys(s).sort(function(g,b){return g-b})).length;v<x;v++)l=c[v],f.length>=100&&(m+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar`,f=[]),s[l]!==void 0&&s[l]!==null&&typeof s[l].toString=="function"&&(d=("0000"+s[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),f.push("<"+l+"><"+d+">"));return f.length&&(m+=`
`+f.length+` beginbfchar
`+f.join(`
`)+`
endbfchar
`),m+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(l){var c=l.font,f=l.out,d=l.newObject,m=l.putStream;if(c.metadata instanceof t.API.TTFFont&&c.encoding==="Identity-H"){for(var v=c.metadata.Unicode.widths,x=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),g="",b=0;b<x.length;b++)g+=String.fromCharCode(x[b]);var _=d();m({data:g,addLength1:!0,objectId:_}),f("endobj");var w=d();m({data:a(c.metadata.toUnicode),addLength1:!0,objectId:w}),f("endobj");var A=d();f("<<"),f("/Type /FontDescriptor"),f("/FontName /"+Hd(c.fontName)),f("/FontFile2 "+_+" 0 R"),f("/FontBBox "+t.API.PDFObject.convert(c.metadata.bbox)),f("/Flags "+c.metadata.flags),f("/StemV "+c.metadata.stemV),f("/ItalicAngle "+c.metadata.italicAngle),f("/Ascent "+c.metadata.ascender),f("/Descent "+c.metadata.decender),f("/CapHeight "+c.metadata.capHeight),f(">>"),f("endobj");var C=d();f("<<"),f("/Type /Font"),f("/BaseFont /"+Hd(c.fontName)),f("/FontDescriptor "+A+" 0 R"),f("/W "+t.API.PDFObject.convert(v)),f("/CIDToGIDMap /Identity"),f("/DW 1000"),f("/Subtype /CIDFontType2"),f("/CIDSystemInfo"),f("<<"),f("/Supplement 0"),f("/Registry (Adobe)"),f("/Ordering ("+c.encoding+")"),f(">>"),f(">>"),f("endobj"),c.objectNumber=d(),f("<<"),f("/Type /Font"),f("/Subtype /Type0"),f("/ToUnicode "+w+" 0 R"),f("/BaseFont /"+Hd(c.fontName)),f("/Encoding /"+c.encoding),f("/DescendantFonts ["+C+" 0 R]"),f(">>"),f("endobj"),c.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(l){var c=l.font,f=l.out,d=l.newObject,m=l.putStream;if(c.metadata instanceof t.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var v=c.metadata.rawData,x="",g=0;g<v.length;g++)x+=String.fromCharCode(v[g]);var b=d();m({data:x,addLength1:!0,objectId:b}),f("endobj");var _=d();m({data:a(c.metadata.toUnicode),addLength1:!0,objectId:_}),f("endobj");var w=d();f("<<"),f("/Descent "+c.metadata.decender),f("/CapHeight "+c.metadata.capHeight),f("/StemV "+c.metadata.stemV),f("/Type /FontDescriptor"),f("/FontFile2 "+b+" 0 R"),f("/Flags 96"),f("/FontBBox "+t.API.PDFObject.convert(c.metadata.bbox)),f("/FontName /"+Hd(c.fontName)),f("/ItalicAngle "+c.metadata.italicAngle),f("/Ascent "+c.metadata.ascender),f(">>"),f("endobj"),c.objectNumber=d();for(var A=0;A<c.metadata.hmtx.widths.length;A++)c.metadata.hmtx.widths[A]=parseInt(c.metadata.hmtx.widths[A]*(1e3/c.metadata.head.unitsPerEm));f("<</Subtype/TrueType/Type/Font/ToUnicode "+_+" 0 R/BaseFont/"+Hd(c.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),f("endobj"),c.isAlreadyPutted=!0}})(s)}]);var n=function(s){var l,c=s.text||"",f=s.x,d=s.y,m=s.options||{},v=s.mutex||{},x=v.pdfEscape,g=v.activeFontKey,b=v.fonts,_=g,w="",A=0,C="",E=b[_].encoding;if(b[_].encoding!=="Identity-H")return{text:c,x:f,y:d,options:m,mutex:v};for(C=c,_=g,Array.isArray(c)&&(C=c[0]),A=0;A<C.length;A+=1)b[_].metadata.hasOwnProperty("cmap")&&(l=b[_].metadata.cmap.unicode.codeMap[C[A].charCodeAt(0)]),l||C[A].charCodeAt(0)<256&&b[_].metadata.hasOwnProperty("Unicode")?w+=C[A]:w+="";var R="";return parseInt(_.slice(1))<14||E==="WinAnsiEncoding"?R=x(w,_).split("").map(function(Y){return Y.charCodeAt(0).toString(16)}).join(""):E==="Identity-H"&&(R=r(w,b[_])),v.isHex=!0,{text:R,x:f,y:d,options:m,mutex:v}};e.events.push(["postProcessText",function(s){var l=s.text||"",c=[],f={text:l,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(l)){var d=0;for(d=0;d<l.length;d+=1)Array.isArray(l[d])&&l[d].length===3?c.push([n(Object.assign({},f,{text:l[d][0]})).text,l[d][1],l[d][2]]):c.push(n(Object.assign({},f,{text:l[d]})).text);s.text=c}else s.text=n(Object.assign({},f,{text:l})).text}])})(ir),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,a){return e.call(this),this.internal.vFS[r]=a,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(ir.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(a){var n,s,l,c,f,d,m,v=e,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],A=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),C=!1,E=0;this.__bidiEngine__={};var R=function(D){var T=D.charCodeAt(),M=T>>8,V=_[M];return V!==void 0?v[256*V+(255&T)]:M===252||M===253?"AL":A.test(M)?"L":M===8?"R":"N"},Y=function(D){for(var T,M=0;M<D.length;M++){if((T=R(D.charAt(M)))==="L")return!1;if(T==="R")return!0}return!1},W=function(D,T,M,V){var ie,X,Z,K,re=T[V];switch(re){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":C=!1;break;case"N":case"AN":break;case"EN":C&&(re="AN");break;case"AL":C=!0,re="R";break;case"WS":case"BN":re="N";break;case"CS":V<1||V+1>=T.length||(ie=M[V-1])!=="EN"&&ie!=="AN"||(X=T[V+1])!=="EN"&&X!=="AN"?re="N":C&&(X="AN"),re=X===ie?X:"N";break;case"ES":re=(ie=V>0?M[V-1]:"B")==="EN"&&V+1<T.length&&T[V+1]==="EN"?"EN":"N";break;case"ET":if(V>0&&M[V-1]==="EN"){re="EN";break}if(C){re="N";break}for(Z=V+1,K=T.length;Z<K&&T[Z]==="ET";)Z++;re=Z<K&&T[Z]==="EN"?"EN":"N";break;case"NSM":if(l&&!c){for(K=T.length,Z=V+1;Z<K&&T[Z]==="NSM";)Z++;if(Z<K){var de=D[V],U=de>=1425&&de<=2303||de===64286;if(ie=T[Z],U&&(ie==="R"||ie==="AL")){re="R";break}}}re=V<1||(ie=T[V-1])==="B"?"N":M[V-1];break;case"B":C=!1,n=!0,re=E;break;case"S":s=!0,re="N"}return re},B=function(D,T,M){var V=D.split("");return M&&q(V,M,{hiLevel:E}),V.reverse(),T&&T.reverse(),V.join("")},q=function(D,T,M){var V,ie,X,Z,K,re=-1,de=D.length,U=0,k=[],F=E?g:x,I=[];for(C=!1,n=!1,s=!1,ie=0;ie<de;ie++)I[ie]=R(D[ie]);for(X=0;X<de;X++){if(K=U,k[X]=W(D,I,k,X),V=240&(U=F[K][b[k[X]]]),U&=15,T[X]=Z=F[U][5],V>0)if(V===16){for(ie=re;ie<X;ie++)T[ie]=1;re=-1}else re=-1;if(F[U][6])re===-1&&(re=X);else if(re>-1){for(ie=re;ie<X;ie++)T[ie]=Z;re=-1}I[X]==="B"&&(T[X]=0),M.hiLevel|=Z}s&&(function(z,te,se){for(var pe=0;pe<se;pe++)if(z[pe]==="S"){te[pe]=E;for(var ve=pe-1;ve>=0&&z[ve]==="WS";ve--)te[ve]=E}})(I,T,de)},L=function(D,T,M,V,ie){if(!(ie.hiLevel<D)){if(D===1&&E===1&&!n)return T.reverse(),void(M&&M.reverse());for(var X,Z,K,re,de=T.length,U=0;U<de;){if(V[U]>=D){for(K=U+1;K<de&&V[K]>=D;)K++;for(re=U,Z=K-1;re<Z;re++,Z--)X=T[re],T[re]=T[Z],T[Z]=X,M&&(X=M[re],M[re]=M[Z],M[Z]=X);U=K}U++}}},J=function(D,T,M){var V=D.split(""),ie={hiLevel:E};return M||(M=[]),q(V,M,ie),(function(X,Z,K){if(K.hiLevel!==0&&m)for(var re,de=0;de<X.length;de++)Z[de]===1&&(re=w.indexOf(X[de]))>=0&&(X[de]=w[re+1])})(V,M,ie),L(2,V,T,M,ie),L(1,V,T,M,ie),V.join("")};return this.__bidiEngine__.doBidiReorder=function(D,T,M){if((function(ie,X){if(X)for(var Z=0;Z<ie.length;Z++)X[Z]=Z;c===void 0&&(c=Y(ie)),d===void 0&&(d=Y(ie))})(D,T),l||!f||d)if(l&&f&&c^d)E=c?1:0,D=B(D,T,M);else if(!l&&f&&d)E=c?1:0,D=J(D,T,M),D=B(D,T);else if(!l||c||f||d){if(l&&!f&&c^d)D=B(D,T),c?(E=0,D=J(D,T,M)):(E=1,D=J(D,T,M),D=B(D,T));else if(l&&c&&!f&&d)E=1,D=J(D,T,M),D=B(D,T);else if(!l&&!f&&c^d){var V=m;c?(E=1,D=J(D,T,M),E=0,m=!1,D=J(D,T,M),m=V):(E=0,D=J(D,T,M),D=B(D,T),E=1,m=!1,D=J(D,T,M),m=V,D=B(D,T))}}else E=0,D=J(D,T,M);else E=c?1:0,D=J(D,T,M);return D},this.__bidiEngine__.setOptions=function(D){D&&(l=D.isInputVisual,f=D.isOutputVisual,c=D.isInputRtl,d=D.isOutputRtl,m=D.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(a){var n=a.text;a.x,a.y;var s=a.options||{};a.mutex,s.lang;var l=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(n)==="[object Array]"){var c=0;for(l=[],c=0;c<n.length;c+=1)Object.prototype.toString.call(n[c])==="[object Array]"?l.push([r.doBidiReorder(n[c][0]),n[c][1],n[c][2]]):l.push([r.doBidiReorder(n[c])]);a.text=l}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])})(ir),ir.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new xu(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new zz(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new Az(this.contents),this.head=new Tz(this),this.name=new Lz(this),this.cmap=new tj(this),this.toUnicode={},this.hhea=new Oz(this),this.maxp=new Pz(this),this.hmtx=new Mz(this),this.post=new Dz(this),this.os2=new Rz(this),this.loca=new qz(this),this.glyf=new Iz(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,a,n,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,c,f,d;for(d=[],l=0,c=(f=this.bbox).length;l<c;l++)e=f[l],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),32768&(r=n>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,a){var n,s,l,c;for(l=0,s=0,c=(e=""+e).length;0<=c?s<c:s>c;s=0<=c?++s:--s)n=e.charCodeAt(s),l+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return l*(r/1e3)},t.prototype.lineHeight=function(e,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*e},t})();var Zo,xu=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,a;for(a=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},t.prototype.writeString=function(e){var r,a,n;for(n=[],r=0,a=e.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(e.charCodeAt(r)));return n},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,a,n,s,l,c,f;return e=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),s=this.readByte(),l=this.readByte(),c=this.readByte(),f=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^s)+65536*(255^l)+256*(255^c)+(255^f)+1):72057594037927940*e+281474976710656*r+1099511627776*a+4294967296*n+16777216*s+65536*l+256*c+f},t.prototype.writeLongLong=function(e){var r,a;return r=Math.floor(e/4294967296),a=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,a;for(r=[],a=0;0<=e?a<e:a>e;a=0<=e?++a:--a)r.push(this.readByte());return r},t.prototype.write=function(e){var r,a,n,s;for(s=[],a=0,n=e.length;a<n;a++)r=e[a],s.push(this.writeByte(r));return s},t})(),Az=(function(){var t;function e(r){var a,n,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,s=this.tableCount;0<=s?n<s:n>s;n=0<=s?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return e.prototype.encode=function(r){var a,n,s,l,c,f,d,m,v,x,g,b,_;for(_ in g=Object.keys(r).length,f=Math.log(2),v=16*Math.floor(Math.log(g)/f),l=Math.floor(v/f),m=16*g-v,(n=new xu).writeInt(this.scalarType),n.writeShort(g),n.writeShort(v),n.writeShort(l),n.writeShort(m),s=16*g,d=n.pos+s,c=null,b=[],r)for(x=r[_],n.writeString(_),n.writeInt(t(x)),n.writeInt(d),n.writeInt(x.length),b=b.concat(x),_==="head"&&(c=d),d+=x.length;d%4;)b.push(0),d++;return n.write(b),a=2981146554-t(n.data),n.pos=c+8,n.writeUInt32(a),n.data},t=function(r){var a,n,s,l;for(r=rj.call(r);r.length%4;)r.push(0);for(s=new xu(r),n=0,a=0,l=r.length;a<l;a=a+=4)n+=s.readUInt32();return 4294967295&n},e})(),Cz={}.hasOwnProperty,Tl=function(t,e){for(var r in e)Cz.call(e,r)&&(t[r]=e[r]);function a(){this.constructor=t}return a.prototype=e.prototype,t.prototype=new a,t.__super__=e.prototype,t};Zo=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var Tz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Zo),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new xu).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t})(),CS=(function(){function t(e,r){var a,n,s,l,c,f,d,m,v,x,g,b,_,w,A,C,E;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),v=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(f=0;f<256;++f)this.codeMap[f]=e.readByte();break;case 4:for(g=e.readUInt16(),x=g/2,e.pos+=6,s=(function(){var R,Y;for(Y=[],f=R=0;0<=x?R<x:R>x;f=0<=x?++R:--R)Y.push(e.readUInt16());return Y})(),e.pos+=2,_=(function(){var R,Y;for(Y=[],f=R=0;0<=x?R<x:R>x;f=0<=x?++R:--R)Y.push(e.readUInt16());return Y})(),d=(function(){var R,Y;for(Y=[],f=R=0;0<=x?R<x:R>x;f=0<=x?++R:--R)Y.push(e.readUInt16());return Y})(),m=(function(){var R,Y;for(Y=[],f=R=0;0<=x?R<x:R>x;f=0<=x?++R:--R)Y.push(e.readUInt16());return Y})(),n=(this.length-e.pos+this.offset)/2,c=(function(){var R,Y;for(Y=[],f=R=0;0<=n?R<n:R>n;f=0<=n?++R:--R)Y.push(e.readUInt16());return Y})(),f=A=0,E=s.length;A<E;f=++A)for(w=s[f],a=C=b=_[f];b<=w?C<=w:C>=w;a=b<=w?++C:--C)m[f]===0?l=a+d[f]:(l=c[m[f]/2+(a-b)-(x-f)]||0)!==0&&(l+=d[f]),this.codeMap[a]=65535&l}e.pos=v}return t.encode=function(e,r){var a,n,s,l,c,f,d,m,v,x,g,b,_,w,A,C,E,R,Y,W,B,q,L,J,D,T,M,V,ie,X,Z,K,re,de,U,k,F,I,z,te,se,pe,ve,_e,Pe,fe;switch(V=new xu,l=Object.keys(e).sort(function(st,mt){return st-mt}),r){case"macroman":for(_=0,w=(function(){var st=[];for(b=0;b<256;++b)st.push(0);return st})(),C={0:0},s={},ie=0,re=l.length;ie<re;ie++)C[ve=e[n=l[ie]]]==null&&(C[ve]=++_),s[n]={old:e[n],new:C[e[n]]},w[n]=C[e[n]];return V.writeUInt16(1),V.writeUInt16(0),V.writeUInt32(12),V.writeUInt16(0),V.writeUInt16(262),V.writeUInt16(0),V.write(w),{charMap:s,subtable:V.data,maxGlyphID:_+1};case"unicode":for(T=[],v=[],E=0,C={},a={},A=d=null,X=0,de=l.length;X<de;X++)C[Y=e[n=l[X]]]==null&&(C[Y]=++E),a[n]={old:Y,new:C[Y]},c=C[Y]-n,A!=null&&c===d||(A&&v.push(A),T.push(n),d=c),A=n;for(A&&v.push(A),v.push(65535),T.push(65535),J=2*(L=T.length),q=2*Math.pow(Math.log(L)/Math.LN2,2),x=Math.log(q/2)/Math.LN2,B=2*L-q,f=[],W=[],g=[],b=Z=0,U=T.length;Z<U;b=++Z){if(D=T[b],m=v[b],D===65535){f.push(0),W.push(0);break}if(D-(M=a[D].new)>=32768)for(f.push(0),W.push(2*(g.length+L-b)),n=K=D;D<=m?K<=m:K>=m;n=D<=m?++K:--K)g.push(a[n].new);else f.push(M-D),W.push(0)}for(V.writeUInt16(3),V.writeUInt16(1),V.writeUInt32(12),V.writeUInt16(4),V.writeUInt16(16+8*L+2*g.length),V.writeUInt16(0),V.writeUInt16(J),V.writeUInt16(q),V.writeUInt16(x),V.writeUInt16(B),se=0,k=v.length;se<k;se++)n=v[se],V.writeUInt16(n);for(V.writeUInt16(0),pe=0,F=T.length;pe<F;pe++)n=T[pe],V.writeUInt16(n);for(_e=0,I=f.length;_e<I;_e++)c=f[_e],V.writeUInt16(c);for(Pe=0,z=W.length;Pe<z;Pe++)R=W[Pe],V.writeUInt16(R);for(fe=0,te=g.length;fe<te;fe++)_=g[fe],V.writeUInt16(_);return{charMap:a,subtable:V.data,maxGlyphID:E+1}}},t})(),tj=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Zo),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,a,n;for(e.pos=this.offset,this.version=e.readUInt16(),n=e.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)r=new CS(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var a,n;return r==null&&(r="macroman"),a=CS.encode(e,r),(n=new xu).writeUInt16(0),n.writeUInt16(1),a.table=n.data.concat(a.subtable),a},t})(),Oz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Zo),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),Rz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Zo),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var r,a;for(a=[],r=0;r<10;++r)a.push(e.readByte());return a})(),this.charRange=(function(){var r,a;for(a=[],r=0;r<4;++r)a.push(e.readInt());return a})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var r,a;for(a=[],r=0;r<2;r=++r)a.push(e.readInt());return a})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),Dz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Zo),t.prototype.tag="post",t.prototype.parse=function(e){var r,a,n;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(a=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],n=[];e.pos<this.offset+this.length;)r=e.readByte(),n.push(this.names.push(e.readString(r)));return n;case 151552:return a=e.readUInt16(),this.offsets=e.read(a);case 262144:return this.map=(function(){var l,c,f;for(f=[],s=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;s=0<=c?++l:--l)f.push(e.readUInt32());return f}).call(this)}},t})(),Fz=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Lz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Zo),t.prototype.tag="name",t.prototype.parse=function(e){var r,a,n,s,l,c,f,d,m,v,x;for(e.pos=this.offset,e.readShort(),r=e.readShort(),c=e.readShort(),a=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)a.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+c+e.readShort()});for(f={},s=m=0,v=a.length;m<v;s=++m)n=a[s],e.pos=n.offset,d=e.readString(n.length),l=new Fz(d,n),f[x=n.nameID]==null&&(f[x]=[]),f[n.nameID].push(l);this.strings=f,this.copyright=f[0],this.fontFamily=f[1],this.fontSubfamily=f[2],this.uniqueSubfamily=f[3],this.fontName=f[4],this.version=f[5];try{this.postscriptName=f[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=f[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=f[7],this.manufacturer=f[8],this.designer=f[9],this.description=f[10],this.vendorUrl=f[11],this.designerUrl=f[12],this.license=f[13],this.licenseUrl=f[14],this.preferredFamily=f[15],this.preferredSubfamily=f[17],this.compatibleFull=f[18],this.sampleText=f[19]},t})(),Pz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Zo),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),Mz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Zo),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,a,n,s,l,c,f;for(e.pos=this.offset,this.metrics=[],r=0,c=this.file.hhea.numberOfMetrics;0<=c?r<c:r>c;r=0<=c?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var d,m;for(m=[],r=d=0;0<=n?d<n:d>n;r=0<=n?++d:--d)m.push(e.readInt16());return m})(),this.widths=(function(){var d,m,v,x;for(x=[],d=0,m=(v=this.metrics).length;d<m;d++)s=v[d],x.push(s.advance);return x}).call(this),a=this.widths[this.widths.length-1],f=[],r=l=0;0<=n?l<n:l>n;r=0<=n?++l:--l)f.push(this.widths.push(a));return f},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),rj=[].slice,Iz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Zo),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,a,n,s,l,c,f,d,m,v;return e in this.cache?this.cache[e]:(s=this.file.loca,r=this.file.contents,a=s.indexOf(e),(n=s.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+a,l=(c=new xu(r.read(n))).readShort(),d=c.readShort(),v=c.readShort(),f=c.readShort(),m=c.readShort(),this.cache[e]=l===-1?new Uz(c,d,v,f,m):new Bz(c,l,d,v,f,m),this.cache[e]))},t.prototype.encode=function(e,r,a){var n,s,l,c,f;for(l=[],s=[],c=0,f=r.length;c<f;c++)n=e[r[c]],s.push(l.length),n&&(l=l.concat(n.encode(a)));return s.push(l.length),{table:l,offsets:s}},t})(),Bz=(function(){function t(e,r,a,n,s,l){this.raw=e,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=s,this.yMax=l,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),Uz=(function(){function t(e,r,a,n,s){var l,c;for(this.raw=e,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;c=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&c;)l.pos+=1&c?4:2,128&c?l.pos+=8:64&c?l.pos+=4:8&c&&(l.pos+=2)}return t.prototype.encode=function(){var e,r,a;for(r=new xu(rj.call(this.raw.data)),e=0,a=this.glyphIDs.length;e<a;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),qz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tl(t,Zo),t.prototype.tag="loca",t.prototype.parse=function(e){var r,a;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var n,s;for(s=[],a=0,n=this.length;a<n;a+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var n,s;for(s=[],a=0,n=this.length;a<n;a+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var a=new Uint32Array(this.offsets.length),n=0,s=0,l=0;l<a.length;++l)if(a[l]=n,s<r.length&&r[s]==l){++s,a[l]=n;var c=this.offsets[l],f=this.offsets[l+1]-c;f>0&&(n+=f)}for(var d=new Array(4*a.length),m=0;m<a.length;++m)d[4*m+3]=255&a[m],d[4*m+2]=(65280&a[m])>>8,d[4*m+1]=(16711680&a[m])>>16,d[4*m]=(4278190080&a[m])>>24;return d},t})(),zz=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,a,n,s;for(r in n=this.font.cmap.tables[0].codeMap,e={},s=this.subset)a=s[r],e[r]=n[a];return e},t.prototype.glyphsFor=function(e){var r,a,n,s,l,c,f;for(n={},l=0,c=e.length;l<c;l++)n[s=e[l]]=this.font.glyf.glyphFor(s);for(s in r=[],n)(a=n[s])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(s in f=this.glyphsFor(r))a=f[s],n[s]=a;return n},t.prototype.encode=function(e,r){var a,n,s,l,c,f,d,m,v,x,g,b,_,w,A;for(n in a=tj.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(e),g={0:0},A=a.charMap)g[(f=A[n]).old]=f.new;for(b in x=a.maxGlyphID,l)b in g||(g[b]=x++);return m=(function(C){var E,R;for(E in R={},C)R[C[E]]=E;return R})(g),v=Object.keys(m).sort(function(C,E){return C-E}),_=(function(){var C,E,R;for(R=[],C=0,E=v.length;C<E;C++)c=v[C],R.push(m[c]);return R})(),s=this.font.glyf.encode(l,_,g),d=this.font.loca.encode(s.offsets,_),w={cmap:this.font.cmap.raw(),glyf:s.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},t})();ir.API.PDFObject=(function(){var t;function e(){}return t=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},e.convert=function(r){var a,n,s,l;if(Array.isArray(r))return"["+(function(){var c,f,d;for(d=[],c=0,f=r.length;c<f;c++)a=r[c],d.push(e.convert(a));return d})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in s=["<<"],r)l=r[n],s.push("/"+n+" "+e.convert(l));return s.push(">>"),s.join(`
`)}return""+r},e})();function aj(t,e,r,a,n){a=a||{};var s=1.15,l=n.internal.scaleFactor,c=n.internal.getFontSize()/l,f=n.getLineHeightFactor?n.getLineHeightFactor():s,d=c*f,m=/\r\n|\r|\n/g,v="",x=1;if((a.valign==="middle"||a.valign==="bottom"||a.halign==="center"||a.halign==="right")&&(v=typeof t=="string"?t.split(m):t,x=v.length||1),r+=c*(2-s),a.valign==="middle"?r-=x/2*d:a.valign==="bottom"&&(r-=x*d),a.halign==="center"||a.halign==="right"){var g=c;if(a.halign==="center"&&(g*=.5),v&&x>=1){for(var b=0;b<v.length;b++)n.text(v[b],e-n.getStringUnitWidth(v[b])*g,r),r+=d;return n}e-=n.getStringUnitWidth(t)*g}return a.halign==="justify"?n.text(t,e,r,{maxWidth:a.maxWidth||100,align:"justify"}):n.text(t,e,r),n}var TS={},ah=(function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:TS=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var a,n,s;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var l=this.jsPDFDocument.internal.getFont(),c=l.fontStyle,f=l.fontName;if(e.font&&(f=e.font),e.fontStyle){c=e.fontStyle;var d=this.getFontList()[f];d&&d.indexOf(c)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),c=d[0])}if(this.jsPDFDocument.setFont(f,c),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var m=t.unifyColor(e.fillColor);m&&(a=this.jsPDFDocument).setFillColor.apply(a,m),m=t.unifyColor(e.textColor),m&&(n=this.jsPDFDocument).setTextColor.apply(n,m),m=t.unifyColor(e.lineColor),m&&(s=this.jsPDFDocument).setDrawColor.apply(s,m),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,a){return this.jsPDFDocument.splitTextToSize(e,r,a)},t.prototype.rect=function(e,r,a,n,s){return this.jsPDFDocument.rect(e,r,a,n,s)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return TS||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t})(),Ix=function(t,e){return Ix=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},Ix(t,e)};function nj(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ix(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var sj=(function(t){nj(e,t);function e(r){var a=t.call(this)||this;return a._element=r,a}return e})(Array);function Hz(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function $z(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function l1(t,e,r){r.applyStyles(e,!0);var a=Array.isArray(t)?t:[t],n=a.map(function(s){return r.getTextWidth(s)}).reduce(function(s,l){return Math.max(s,l)},0);return n}function ij(t,e,r,a){var n=e.settings.tableLineWidth,s=e.settings.tableLineColor;t.applyStyles({lineWidth:n,lineColor:s});var l=oj(n,!1);l&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),a.y-r.y,l)}function oj(t,e){var r=t>0,a=e||e===0;return r&&a?"DF":r?"S":a?"F":null}function j1(t,e){var r,a,n,s;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(a=t.top)!==null&&a!==void 0?a:e,right:(n=t.right)!==null&&n!==void 0?n:e,bottom:(s=t.bottom)!==null&&s!==void 0?s:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function lj(t,e){var r=j1(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function Wz(t,e,r,a,n){var s={},l=1.3333333333333333,c=Bv(e,function(E){return n.getComputedStyle(E).backgroundColor});c!=null&&(s.fillColor=c);var f=Bv(e,function(E){return n.getComputedStyle(E).color});f!=null&&(s.textColor=f);var d=Gz(a,r);d&&(s.cellPadding=d);var m="borderTopColor",v=l*r,x=a.borderTopWidth;if(a.borderBottomWidth===x&&a.borderRightWidth===x&&a.borderLeftWidth===x){var g=(parseFloat(x)||0)/v;g&&(s.lineWidth=g)}else s.lineWidth={top:(parseFloat(a.borderTopWidth)||0)/v,right:(parseFloat(a.borderRightWidth)||0)/v,bottom:(parseFloat(a.borderBottomWidth)||0)/v,left:(parseFloat(a.borderLeftWidth)||0)/v},s.lineWidth.top||(s.lineWidth.right?m="borderRightColor":s.lineWidth.bottom?m="borderBottomColor":s.lineWidth.left&&(m="borderLeftColor"));var b=Bv(e,function(E){return n.getComputedStyle(E)[m]});b!=null&&(s.lineColor=b);var _=["left","right","center","justify"];_.indexOf(a.textAlign)!==-1&&(s.halign=a.textAlign),_=["middle","bottom","top"],_.indexOf(a.verticalAlign)!==-1&&(s.valign=a.verticalAlign);var w=parseInt(a.fontSize||"");isNaN(w)||(s.fontSize=w/l);var A=Vz(a);A&&(s.fontStyle=A);var C=(a.fontFamily||"").toLowerCase();return t.indexOf(C)!==-1&&(s.font=C),s}function Vz(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function Bv(t,e){var r=cj(t,e);if(!r)return null;var a=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!a||!Array.isArray(a))return null;var n=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])],s=parseInt(a[4]);return s===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function cj(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:cj(t.parentElement,e):r}function Gz(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],a=96/(72/e),n=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,s=r.map(function(c){return parseInt(c||"0")/a}),l=j1(s,0);return n>l.top&&(l.top=n),n>l.bottom&&(l.bottom=n),l}function uj(t,e,r,a,n){var s,l;a===void 0&&(a=!1),n===void 0&&(n=!1);var c;typeof e=="string"?c=r.document.querySelector(e):c=e;var f=Object.keys(t.getFontList()),d=t.scaleFactor(),m=[],v=[],x=[];if(!c)return console.error("Html table could not be found with input: ",e),{head:m,body:v,foot:x};for(var g=0;g<c.rows.length;g++){var b=c.rows[g],_=(l=(s=b?.parentElement)===null||s===void 0?void 0:s.tagName)===null||l===void 0?void 0:l.toLowerCase(),w=Yz(f,d,r,b,a,n);w&&(_==="thead"?m.push(w):_==="tfoot"?x.push(w):v.push(w))}return{head:m,body:v,foot:x}}function Yz(t,e,r,a,n,s){for(var l=new sj(a),c=0;c<a.cells.length;c++){var f=a.cells[c],d=r.getComputedStyle(f);if(n||d.display!=="none"){var m=void 0;s&&(m=Wz(t,f,e,d,r)),l.push({rowSpan:f.rowSpan,colSpan:f.colSpan,styles:m,_element:f,content:Xz(f)})}}var v=r.getComputedStyle(a);if(l.length>0&&(n||v.display!=="none"))return l}function Xz(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function Kz(t,e,r){for(var a=0,n=[t,e,r];a<n.length;a++){var s=n[a];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function cc(t,e,r,a,n){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),l=1;l<arguments.length;l++){var c=arguments[l];if(c!=null)for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(s[f]=c[f])}return s}function fj(t,e){var r=new ah(t),a=r.getDocumentOptions(),n=r.getGlobalOptions();Kz(n,a,e);var s=cc({},n,a,e),l;typeof window<"u"&&(l=window);var c=Jz(n,a,e),f=Zz(n,a,e),d=Qz(r,s),m=tH(r,s,l);return{id:e.tableId,content:m,hooks:f,styles:c,settings:d}}function Jz(t,e,r){for(var a={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(f){if(f==="columnStyles"){var d=t[f],m=e[f],v=r[f];a.columnStyles=cc({},d,m,v)}else{var x=[t,e,r],g=x.map(function(b){return b[f]||{}});a[f]=cc({},g[0],g[1],g[2])}},s=0,l=Object.keys(a);s<l.length;s++){var c=l[s];n(c)}return a}function Zz(t,e,r){for(var a=[t,e,r],n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,l=a;s<l.length;s++){var c=l[s];c.didParseCell&&n.didParseCell.push(c.didParseCell),c.willDrawCell&&n.willDrawCell.push(c.willDrawCell),c.didDrawCell&&n.didDrawCell.push(c.didDrawCell),c.willDrawPage&&n.willDrawPage.push(c.willDrawPage),c.didDrawPage&&n.didDrawPage.push(c.didDrawPage)}return n}function Qz(t,e){var r,a,n,s,l,c,f,d,m,v,x,g,b=j1(e.margin,40/t.scaleFactor()),_=(r=eH(t,e.startY))!==null&&r!==void 0?r:b.top,w;e.showFoot===!0?w="everyPage":e.showFoot===!1?w="never":w=(a=e.showFoot)!==null&&a!==void 0?a:"everyPage";var A;e.showHead===!0?A="everyPage":e.showHead===!1?A="never":A=(n=e.showHead)!==null&&n!==void 0?n:"everyPage";var C=(s=e.useCss)!==null&&s!==void 0?s:!1,E=e.theme||(C?"plain":"striped"),R=!!e.horizontalPageBreak,Y=(l=e.horizontalPageBreakRepeat)!==null&&l!==void 0?l:null;return{includeHiddenHtml:(c=e.includeHiddenHtml)!==null&&c!==void 0?c:!1,useCss:C,theme:E,startY:_,margin:b,pageBreak:(f=e.pageBreak)!==null&&f!==void 0?f:"auto",rowPageBreak:(d=e.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(m=e.tableWidth)!==null&&m!==void 0?m:"auto",showHead:A,showFoot:w,tableLineWidth:(v=e.tableLineWidth)!==null&&v!==void 0?v:0,tableLineColor:(x=e.tableLineColor)!==null&&x!==void 0?x:200,horizontalPageBreak:R,horizontalPageBreakRepeat:Y,horizontalPageBreakBehaviour:(g=e.horizontalPageBreakBehaviour)!==null&&g!==void 0?g:"afterAllRows"}}function eH(t,e){var r=t.getLastAutoTable(),a=t.scaleFactor(),n=t.pageNumber(),s=!1;if(r&&r.startPageNumber){var l=r.startPageNumber+r.pageNumber-1;s=l===n}return typeof e=="number"?e:(e==null||e===!1)&&s&&r?.finalY!=null?r.finalY+20/a:null}function tH(t,e,r){var a=e.head||[],n=e.body||[],s=e.foot||[];if(e.html){var l=e.includeHiddenHtml;if(r){var c=uj(t,e.html,r,l,e.useCss)||{};a=c.head||a,n=c.body||a,s=c.foot||a}else console.error("Cannot parse html in non browser environment")}var f=e.columns||rH(a,n,s);return{columns:f,head:a,body:n,foot:s}}function rH(t,e,r){var a=t[0]||e[0]||r[0]||[],n=[];return Object.keys(a).filter(function(s){return s!=="_element"}).forEach(function(s){var l=1,c;Array.isArray(a)?c=a[parseInt(s)]:c=a[s],typeof c=="object"&&!Array.isArray(c)&&(l=c?.colSpan||1);for(var f=0;f<l;f++){var d=void 0;Array.isArray(a)?d=n.length:d=s+(f>0?"_".concat(f):"");var m={dataKey:d};n.push(m)}}),n}var Bx=(function(){function t(e,r,a){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=a,this.doc=e.getDocument()}return t})(),aH=(function(t){nj(e,t);function e(r,a,n,s,l,c){var f=t.call(this,r,a,c)||this;return f.cell=n,f.row=s,f.column=l,f.section=s.section,f}return e})(Bx),nH=(function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,a,n,s,l){for(var c=0,f=r;c<f.length;c++){var d=f[c],m=new aH(e,this,a,n,s,l),v=d(m)===!1;if(a.text=Array.isArray(a.text)?a.text:[a.text],v)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var a=0,n=this.hooks.didDrawPage;a<n.length;a++){var s=n[a];s(new Bx(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var a=0,n=this.hooks.willDrawPage;a<n.length;a++){var s=n[a];s(new Bx(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(n,s){return n+s.wrappedWidth},0);return r}else{var a=this.settings.margin;return e-a.left-a.right}},t})(),dj=(function(){function t(e,r,a,n,s){s===void 0&&(s=!1),this.height=0,this.raw=e,e instanceof sj&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=a,this.cells=n,this.spansMultiplePages=s}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(a,n){var s;return Math.max(a,((s=r.cells[n.index])===null||s===void 0?void 0:s.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(a){var n=r.cells[a.index];return n?n.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var a=this;return e.reduce(function(n,s){var l=a.cells[s.index];if(!l)return 0;var c=r.getLineHeight(l.styles.fontSize),f=l.padding("vertical"),d=f+c;return d>n?d:n},0)},t})(),hj=(function(){function t(e,r,a){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=a,this.raw=e;var s=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,s=(n=e.content)!==null&&n!==void 0?n:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var l=s!=null?""+s:"",c=/\r\n|\r|\n/g;this.text=l.split(c)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var a;if(this.styles.halign==="right")a=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var n=this.width-this.padding("horizontal");a=this.x+n/2+this.padding("left")}else a=this.x+this.padding("left");return{x:a,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var a=Array.isArray(this.text)?this.text.length:1,n=this.styles.fontSize/e*r,s=a*n+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=j1(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t})(),sH=(function(){function t(e,r,a){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=a}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,a=0,n=e.allRows();a<n.length;a++){var s=n[a],l=s.cells[this.index];l&&typeof l.styles.cellWidth=="number"&&(r=Math.max(r,l.styles.cellWidth))}return r},t})();function iH(t,e){oH(t,e);var r=[],a=0;e.columns.forEach(function(s){var l=s.getMaxCustomCellWidth(e);l?s.width=l:(s.width=s.wrappedWidth,r.push(s)),a+=s.width});var n=e.getWidth(t.pageSize().width)-a;n&&(n=Ux(r,n,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),n&&(n=Ux(r,n,function(s){return s.minWidth})),n=Math.abs(n),!e.settings.horizontalPageBreak&&n>.1/t.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),cH(e),uH(e,t),lH(e)}function oH(t,e){var r=t.scaleFactor(),a=e.settings.horizontalPageBreak,n=lj(t,e);e.allRows().forEach(function(s){for(var l=0,c=e.columns;l<c.length;l++){var f=c[l],d=s.cells[f.index];if(d){var m=e.hooks.didParseCell;e.callCellHooks(t,m,d,s,f,null);var v=d.padding("horizontal");d.contentWidth=l1(d.text,d.styles,t)+v;var x=l1(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,t);if(d.minReadableWidth=x+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||a===!0)d.contentWidth>n?(d.minWidth=n,d.wrappedWidth=n):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var g=10/r;d.minWidth=d.styles.minCellWidth||g,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),e.allRows().forEach(function(s){for(var l=0,c=e.columns;l<c.length;l++){var f=c[l],d=s.cells[f.index];if(d&&d.colSpan===1)f.wrappedWidth=Math.max(f.wrappedWidth,d.wrappedWidth),f.minWidth=Math.max(f.minWidth,d.minWidth),f.minReadableWidth=Math.max(f.minReadableWidth,d.minReadableWidth);else{var m=e.styles.columnStyles[f.dataKey]||e.styles.columnStyles[f.index]||{},v=m.cellWidth||m.minCellWidth;v&&typeof v=="number"&&(f.minWidth=v,f.wrappedWidth=v)}d&&(d.colSpan>1&&!f.minWidth&&(f.minWidth=d.minWidth),d.colSpan>1&&!f.wrappedWidth&&(f.wrappedWidth=d.minWidth))}})}function Ux(t,e,r){for(var a=e,n=t.reduce(function(g,b){return g+b.wrappedWidth},0),s=0;s<t.length;s++){var l=t[s],c=l.wrappedWidth/n,f=a*c,d=l.width+f,m=r(l),v=d<m?m:d;e-=v-l.width,l.width=v}if(e=Math.round(e*1e10)/1e10,e){var x=t.filter(function(g){return e<0?g.width>r(g):!0});x.length&&(e=Ux(x,e,r))}return e}function lH(t){for(var e={},r=1,a=t.allRows(),n=0;n<a.length;n++)for(var s=a[n],l=0,c=t.columns;l<c.length;l++){var f=c[l],d=e[f.index];if(r>1)r--,delete s.cells[f.index];else if(d)d.cell.height+=s.height,r=d.cell.colSpan,delete s.cells[f.index],d.left--,d.left<=1&&delete e[f.index];else{var m=s.cells[f.index];if(!m)continue;if(m.height=s.height,m.rowSpan>1){var v=a.length-n,x=m.rowSpan>v?v:m.rowSpan;e[f.index]={cell:m,left:x,row:s}}}}}function cH(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var a=e[r],n=null,s=0,l=0,c=0;c<t.columns.length;c++){var f=t.columns[c];if(l-=1,l>1&&t.columns[c+1])s+=f.width,delete a.cells[f.index];else if(n){var d=n;delete a.cells[f.index],n=null,d.width=f.width+s}else{var d=a.cells[f.index];if(!d)continue;if(l=d.colSpan,s=0,d.colSpan>1){n=d,s+=f.width;continue}d.width=f.width+s}}}function uH(t,e){for(var r={count:0,height:0},a=0,n=t.allRows();a<n.length;a++){for(var s=n[a],l=0,c=t.columns;l<c.length;l++){var f=c[l],d=s.cells[f.index];if(d){e.applyStyles(d.styles,!0);var m=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=e.splitTextToSize(d.text,m+1/e.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=OS(d.text,m,d.styles,e,"...");else if(d.styles.overflow==="hidden")d.text=OS(d.text,m,d.styles,e,"");else if(typeof d.styles.overflow=="function"){var v=d.styles.overflow(d.text,m);typeof v=="string"?d.text=[v]:d.text=v}d.contentHeight=d.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var x=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<x*d.rowSpan?r={height:x,count:d.rowSpan}:r&&r.count>0&&r.height>x&&(x=r.height),x>s.height&&(s.height=x)}}r.count--}}function OS(t,e,r,a,n){return t.map(function(s){return fH(s,e,r,a,n)})}function fH(t,e,r,a,n){var s=1e4*a.scaleFactor();if(e=Math.ceil(e*s)/s,e>=l1(t,r,a))return t;for(;e<l1(t+n,r,a)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+n}function mj(t,e){var r=new ah(t),a=dH(e,r.scaleFactor()),n=new nH(e,a);return iH(r,n),r.applyStyles(r.userStyles),n}function dH(t,e){var r=t.content,a=mH(r.columns);if(r.head.length===0){var n=RS(a,"head");n&&r.head.push(n)}if(r.foot.length===0){var n=RS(a,"foot");n&&r.foot.push(n)}var s=t.settings.theme,l=t.styles;return{columns:a,head:Uv("head",r.head,a,l,s,e),body:Uv("body",r.body,a,l,s,e),foot:Uv("foot",r.foot,a,l,s,e)}}function Uv(t,e,r,a,n,s){var l={},c=e.map(function(f,d){for(var m=0,v={},x=0,g=0,b=0,_=r;b<_.length;b++){var w=_[b];if(l[w.index]==null||l[w.index].left===0)if(g===0){var A=void 0;Array.isArray(f)?A=f[w.index-x-m]:A=f[w.dataKey];var C={};typeof A=="object"&&!Array.isArray(A)&&(C=A?.styles||{});var E=pH(t,w,d,n,a,s,C),R=new hj(A,E,t);v[w.dataKey]=R,v[w.index]=R,g=R.colSpan-1,l[w.index]={left:R.rowSpan-1,times:g}}else g--,x++;else l[w.index].left--,g=l[w.index].times,m++}return new dj(f,d,t,v)});return c}function RS(t,e){var r={};return t.forEach(function(a){if(a.raw!=null){var n=hH(e,a.raw);n!=null&&(r[a.dataKey]=n)}}),Object.keys(r).length>0?r:null}function hH(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function mH(t){return t.map(function(e,r){var a,n;return typeof e=="object"?n=(a=e.dataKey)!==null&&a!==void 0?a:r:n=r,new sH(n,e,r)})}function pH(t,e,r,a,n,s,l){var c=$z(a),f;t==="head"?f=n.headStyles:t==="body"?f=n.bodyStyles:t==="foot"&&(f=n.footStyles);var d=cc({},c.table,c[t],n.styles,f),m=n.columnStyles[e.dataKey]||n.columnStyles[e.index]||{},v=t==="body"?m:{},x=t==="body"&&r%2===0?cc({},c.alternateRow,n.alternateRowStyles):{},g=Hz(s),b=cc({},g,d,x,v);return cc(b,l)}function gH(t,e,r){var a;r===void 0&&(r={});var n=lj(t,e),s=new Map,l=[],c=[],f=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?f=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(f=[e.settings.horizontalPageBreakRepeat]),f.forEach(function(x){var g=e.columns.find(function(b){return b.dataKey===x||b.index===x});g&&!s.has(g.index)&&(s.set(g.index,!0),l.push(g.index),c.push(e.columns[g.index]),n-=g.wrappedWidth)});for(var d=!0,m=(a=r?.start)!==null&&a!==void 0?a:0;m<e.columns.length;){if(s.has(m)){m++;continue}var v=e.columns[m].wrappedWidth;if(d||n>=v)d=!1,l.push(m),c.push(e.columns[m]),n-=v;else break;m++}return{colIndexes:l,columns:c,lastIndex:m-1}}function vH(t,e){for(var r=[],a=0;a<e.columns.length;a++){var n=gH(t,e,{start:a});n.columns.length&&(r.push(n),a=n.lastIndex)}return r}function pj(t,e){var r=e.settings,a=r.startY,n=r.margin,s={x:n.left,y:a},l=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),c=a+n.bottom+l;if(r.pageBreak==="avoid"){var f=e.body,d=f.reduce(function(x,g){return x+g.height},0);c+=d}var m=new ah(t);(r.pageBreak==="always"||r.startY!=null&&c>m.pageSize().height)&&(vj(m),s.y=n.top),e.callWillDrawPageHooks(m,s);var v=cc({},s);e.startPageNumber=m.pageNumber(),r.horizontalPageBreak?xH(m,e,v,s):(m.applyStyles(m.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(x){return pc(m,e,x,s,e.columns)}),m.applyStyles(m.userStyles),e.body.forEach(function(x,g){var b=g===e.body.length-1;c1(m,e,x,b,v,s,e.columns)}),m.applyStyles(m.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(x){return pc(m,e,x,s,e.columns)})),ij(m,e,v,s),e.callEndPageHooks(m,s),e.finalY=s.y,t.lastAutoTable=e,m.applyStyles(m.userStyles)}function xH(t,e,r,a){var n=vH(t,e),s=e.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")n.forEach(function(d,m){t.applyStyles(t.userStyles),m>0?w0(t,e,r,a,d.columns,!0):DS(t,e,a,d.columns),yH(t,e,r,a,d.columns),qv(t,e,a,d.columns)});else for(var l=-1,c=n[0],f=function(){var d=l;if(c){t.applyStyles(t.userStyles);var m=c.columns;l>=0?w0(t,e,r,a,m,!0):DS(t,e,a,m),d=FS(t,e,l+1,a,m),qv(t,e,a,m)}var v=d-l;n.slice(1).forEach(function(x){t.applyStyles(t.userStyles),w0(t,e,r,a,x.columns,!0),FS(t,e,l+1,a,x.columns,v),qv(t,e,a,x.columns)}),l=d};l<e.body.length-1;)f()}function DS(t,e,r,a){var n=e.settings;t.applyStyles(t.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&e.head.forEach(function(s){return pc(t,e,s,r,a)})}function yH(t,e,r,a,n){t.applyStyles(t.userStyles),e.body.forEach(function(s,l){var c=l===e.body.length-1;c1(t,e,s,c,r,a,n)})}function FS(t,e,r,a,n,s){t.applyStyles(t.userStyles),s=s??e.body.length;var l=Math.min(r+s,e.body.length),c=-1;return e.body.slice(r,l).forEach(function(f,d){var m=r+d===e.body.length-1,v=gj(t,e,m,a);f.canEntireRowFit(v,n)&&(pc(t,e,f,a,n),c=r+d)}),c}function qv(t,e,r,a){var n=e.settings;t.applyStyles(t.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&e.foot.forEach(function(s){return pc(t,e,s,r,a)})}function _H(t,e,r){var a=r.getLineHeight(t.styles.fontSize),n=t.padding("vertical"),s=Math.floor((e-n)/a);return Math.max(0,s)}function bH(t,e,r,a){var n={};t.spansMultiplePages=!0,t.height=0;for(var s=0,l=0,c=r.columns;l<c.length;l++){var f=c[l],d=t.cells[f.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var m=new hj(d.raw,d.styles,d.section);m=cc(m,d),m.text=[];var v=_H(d,e,a);d.text.length>v&&(m.text=d.text.splice(v,d.text.length));var x=a.scaleFactor(),g=a.getLineHeightFactor();d.contentHeight=d.getContentHeight(x,g),d.contentHeight>=e&&(d.contentHeight=e,m.styles.minCellHeight-=e),d.contentHeight>t.height&&(t.height=d.contentHeight),m.contentHeight=m.getContentHeight(x,g),m.contentHeight>s&&(s=m.contentHeight),n[f.index]=m}}var b=new dj(t.raw,-1,t.section,n,!0);b.height=s;for(var _=0,w=r.columns;_<w.length;_++){var f=w[_],m=b.cells[f.index];m&&(m.height=b.height);var d=t.cells[f.index];d&&(d.height=t.height)}return b}function wH(t,e,r,a){var n=t.pageSize().height,s=a.settings.margin,l=s.top+s.bottom,c=n-l;e.section==="body"&&(c-=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns));var f=e.getMinimumRowHeight(a.columns,t),d=f<r;if(f>c)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var m=e.hasRowSpan(a.columns),v=e.getMaxCellHeight(a.columns)>c;return v?(m&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(m||a.settings.rowPageBreak==="avoid")}function c1(t,e,r,a,n,s,l){var c=gj(t,e,a,s);if(r.canEntireRowFit(c,l))pc(t,e,r,s,l);else if(wH(t,r,c,e)){var f=bH(r,c,e,t);pc(t,e,r,s,l),w0(t,e,n,s,l),c1(t,e,f,a,n,s,l)}else w0(t,e,n,s,l),c1(t,e,r,a,n,s,l)}function pc(t,e,r,a,n){a.x=e.settings.margin.left;for(var s=0,l=n;s<l.length;s++){var c=l[s],f=r.cells[c.index];if(!f){a.x+=c.width;continue}t.applyStyles(f.styles),f.x=a.x,f.y=a.y;var d=e.callCellHooks(t,e.hooks.willDrawCell,f,r,c,a);if(d===!1){a.x+=c.width;continue}SH(t,f,a);var m=f.getTextPos();aj(f.text,m.x,m.y,{halign:f.styles.halign,valign:f.styles.valign,maxWidth:Math.ceil(f.width-f.padding("left")-f.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,f,r,c,a),a.x+=c.width}a.y+=r.height}function SH(t,e,r){var a=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof a.lineWidth=="number"){var n=oj(a.lineWidth,a.fillColor);n&&t.rect(e.x,r.y,e.width,e.height,n)}else typeof a.lineWidth=="object"&&(a.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),NH(t,e,r,a.lineWidth))}function NH(t,e,r,a){var n,s,l,c;a.top&&(n=r.x,s=r.y,l=r.x+e.width,c=r.y,a.right&&(l+=.5*a.right),a.left&&(n-=.5*a.left),f(a.top,n,s,l,c)),a.bottom&&(n=r.x,s=r.y+e.height,l=r.x+e.width,c=r.y+e.height,a.right&&(l+=.5*a.right),a.left&&(n-=.5*a.left),f(a.bottom,n,s,l,c)),a.left&&(n=r.x,s=r.y,l=r.x,c=r.y+e.height,a.top&&(s-=.5*a.top),a.bottom&&(c+=.5*a.bottom),f(a.left,n,s,l,c)),a.right&&(n=r.x+e.width,s=r.y,l=r.x+e.width,c=r.y+e.height,a.top&&(s-=.5*a.top),a.bottom&&(c+=.5*a.bottom),f(a.right,n,s,l,c));function f(d,m,v,x,g){t.getDocument().setLineWidth(d),t.getDocument().line(m,v,x,g,"S")}}function gj(t,e,r,a){var n=e.settings.margin.bottom,s=e.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(n+=e.getFootHeight(e.columns)),t.pageSize().height-a.y-n}function w0(t,e,r,a,n,s){n===void 0&&(n=[]),s===void 0&&(s=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!s&&e.foot.forEach(function(c){return pc(t,e,c,a,n)}),e.callEndPageHooks(t,a);var l=e.settings.margin;ij(t,e,r,a),vj(t),e.pageNumber++,a.x=l.left,a.y=l.top,r.y=l.top,e.callWillDrawPageHooks(t,a),e.settings.showHead==="everyPage"&&(e.head.forEach(function(c){return pc(t,e,c,a,n)}),t.applyStyles(t.userStyles))}function vj(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function kH(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var a=e[0],n=fj(this,a),s=mj(this,n);return pj(this,s),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,a,n){aj(e,r,a,n,this)},t.API.autoTableSetDefaults=function(e){return ah.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){ah.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var a;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=new ah(this),s=uj(n,e,window,r,!1),l=s.head,c=s.body,f=((a=l[0])===null||a===void 0?void 0:a.map(function(d){return d.content}))||[];return{columns:f,rows:c,data:c}}}var zv;function Gd(t,e){var r=fj(t,e),a=mj(t,r);pj(t,a)}try{if(typeof window<"u"&&window){var LS=window,PS=LS.jsPDF||((zv=LS.jspdf)===null||zv===void 0?void 0:zv.jsPDF);PS&&kH(PS)}}catch(t){console.error("Could not apply autoTable plugin",t)}const MS=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},jH=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});function EH({project:t,company:e,onShowToast:r}){const{branding:a}=uh(),[n,s]=ne.useState([]),[l,c]=ne.useState(!0),[f,d]=ne.useState("all"),[m,v]=ne.useState(null),[x,g]=ne.useState(new Set),[b,_]=ne.useState("recent"),[w,A]=ne.useState(new Set),[C,E]=ne.useState({start:"",end:""}),[R,Y]=ne.useState(!1),[W,B]=ne.useState(null),[q,L]=ne.useState(""),[J,D]=ne.useState(!1),[T,M]=ne.useState(null);ne.useEffect(()=>{V()},[t.id]);const V=async()=>{try{const we=await ot.getTMTickets(t.id);s(we)}catch(we){console.error("Error loading tickets:",we),r("Error loading T&M tickets","error")}finally{c(!1)}},ie=async(we,ye)=>{try{await ot.updateTMTicketStatus(we,ye),s(n.map(Be=>Be.id===we?{...Be,status:ye}:Be)),r(`Ticket ${ye}`,"success")}catch(Be){console.error("Error updating status:",Be),r("Error updating status","error")}},X=we=>{we.ce_pco_number?(B(we),L(""),Y(!0)):ie(we.id,"approved")},Z=async()=>{if(W)try{const we=parseFloat(q)||0;await ot.approveTMTicket(W.id,null,null,we),s(n.map(ye=>ye.id===W.id?{...ye,status:"approved",change_order_value:we}:ye)),r(`Ticket approved with $${we.toLocaleString()} change order`,"success"),Y(!1),B(null),L("")}catch(we){console.error("Error approving ticket:",we),r("Error approving ticket","error")}},K=async we=>{if(confirm("Delete this T&M ticket?"))try{await ot.deleteTMTicket(we),s(n.filter(ye=>ye.id!==we)),r("Ticket deleted","success")}catch(ye){console.error("Error deleting ticket:",ye),r("Error deleting ticket","error")}},re=we=>{let ye=0;return we.t_and_m_items&&we.t_and_m_items.forEach(Be=>{Be.materials_equipment?.cost_per_unit&&(ye+=Be.quantity*Be.materials_equipment.cost_per_unit)}),ye},de=we=>we.t_and_m_workers?we.t_and_m_workers.reduce((ye,Be)=>{const Et=parseFloat(Be.hours)||0,Xe=parseFloat(Be.overtime_hours)||0;return ye+Et+Xe},0):0,U=we=>new Date(we).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),k=(we,ye)=>{ye.stopPropagation(),g(Be=>{const Et=new Set(Be);return Et.has(we)?Et.delete(we):Et.add(we),Et})},F=()=>{const we=f==="all"?n:n.filter(Be=>Be.status===f),ye=we.every(Be=>x.has(Be.id));g(ye?new Set:new Set(we.map(Be=>Be.id)))},I=()=>{g(new Set)},z=()=>{const we=f==="all"?n:n.filter(ye=>ye.status===f);return x.size>0?we.filter(ye=>x.has(ye.id)):we},te=()=>{const we=z();if(we.length===0){r("No tickets to export","error");return}const ye=[],Be=[],Et=[];we.forEach(Dt=>{const Wt=U(Dt.work_date),et=Dt.status;Dt.t_and_m_workers&&Dt.t_and_m_workers.forEach(ht=>{const yt=parseFloat(ht.hours)||0,ft=parseFloat(ht.overtime_hours)||0;ye.push({Date:Wt,Status:et,"Worker Name":ht.name,Role:ht.role||"Laborer","Regular Hours":yt,"OT Hours":ft,"Total Hours":yt+ft})}),Dt.t_and_m_items&&Dt.t_and_m_items.forEach(ht=>{const yt=ht.custom_name||ht.materials_equipment?.name||"Unknown",ft=ht.custom_category||ht.materials_equipment?.category||"Unknown",pt=ht.materials_equipment?.unit||"each",wt=ht.materials_equipment?.cost_per_unit||0,Lt=ht.quantity*wt;Be.push({Date:Wt,Status:et,Category:ft,Item:yt,Quantity:ht.quantity,Unit:pt,"Cost/Unit":wt,Total:Lt})}),Et.push({Date:Wt,Status:et,Workers:Dt.t_and_m_workers?.length||0,"Total Hours":de(Dt),Items:Dt.t_and_m_items?.length||0,"Materials Cost":re(Dt),Notes:Dt.notes||""})});const Xe=nu.book_new(),lt=nu.json_to_sheet(Et);if(nu.book_append_sheet(Xe,lt,"Summary"),ye.length>0){const Dt=nu.json_to_sheet(ye);nu.book_append_sheet(Xe,Dt,"Workers")}if(Be.length>0){const Dt=nu.json_to_sheet(Be);nu.book_append_sheet(Xe,Dt,"Materials & Equipment")}const jt=`${t.name}_TM_${new Date().toISOString().split("T")[0]}.xlsx`;zB(Xe,jt),r("Export downloaded!","success")},se=async()=>{const we=z();if(we.length===0){r("No tickets to export","error");return}r("Generating PDF...","info");const ye=new ir,Be=ye.internal.pageSize.getWidth(),Et=ye.internal.pageSize.getHeight(),Xe=20;let lt=Xe;const jt=MS(a?.primary_color||"#3B82F6"),Dt=MS(a?.secondary_color||"#1E40AF");ye.setFillColor(...jt),ye.rect(0,0,Be,45,"F"),ye.setFillColor(...Dt),ye.rect(0,42,Be,3,"F");let Wt=Xe;if(a?.logo_url)try{const Ut=await jH(a.logo_url);Ut&&(ye.addImage(Ut,"PNG",Xe,7,30,30),Wt=Xe+30+10)}catch(Ut){console.error("Error adding logo:",Ut)}ye.setTextColor(255,255,255),ye.setFontSize(22),ye.setFont("helvetica","bold"),ye.text(e?.name||"Company Name",Wt,20),ye.setFontSize(10),ye.setFont("helvetica","normal"),ye.text("TIME & MATERIALS REPORT",Wt,30),ye.setFontSize(9),ye.text(`Report Date: ${new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}`,Be-Xe,18,{align:"right"}),t.job_number&&ye.text(`Job #: ${t.job_number}`,Be-Xe,26,{align:"right"}),ye.text(`Status: ${f.charAt(0).toUpperCase()+f.slice(1)}`,Be-Xe,34,{align:"right"}),lt=55,ye.setFillColor(248,250,252),ye.rect(Xe,lt-5,Be-Xe*2,30,"F"),ye.setDrawColor(...jt),ye.setLineWidth(.5),ye.rect(Xe,lt-5,Be-Xe*2,30,"S"),ye.setTextColor(...jt),ye.setFontSize(14),ye.setFont("helvetica","bold"),ye.text(`Project: ${t.name}`,Xe+5,lt+7),ye.setFontSize(10),ye.setFont("helvetica","normal"),ye.setTextColor(51,65,85);const et=we.map(Ut=>new Date(Ut.work_date)).sort((Ut,er)=>Ut-er),ht=et[0]?.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),yt=et[et.length-1]?.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});ye.text(`Date Range: ${ht} - ${yt}`,Xe+5,lt+17),ye.text(`Total Tickets: ${we.length}`,Be-Xe-5,lt+7,{align:"right"}),lt+=40;const ft=we.reduce((Ut,er)=>Ut+de(er),0),pt=we.reduce((Ut,er)=>Ut+re(er),0),wt=new Set(we.flatMap(Ut=>Ut.t_and_m_workers?.map(er=>er.name)||[])).size;ye.setTextColor(...jt),ye.setFontSize(12),ye.setFont("helvetica","bold"),ye.text("SUMMARY",Xe,lt),lt+=8;const Lt=(Be-Xe*2-20)/3,Pt=[{label:"Total Labor Hours",value:ft.toFixed(1)},{label:"Unique Workers",value:wt.toString()},{label:"Materials Cost",value:`$${pt.toFixed(2)}`}],zt=jt.map(Ut=>Math.min(255,Ut+180));Pt.forEach((Ut,er)=>{const ae=Xe+er*(Lt+10);ye.setFillColor(...zt),ye.rect(ae,lt,Lt,25,"F"),ye.setDrawColor(...jt),ye.setLineWidth(.5),ye.rect(ae,lt,Lt,25,"S"),ye.setTextColor(...jt),ye.setFontSize(16),ye.setFont("helvetica","bold"),ye.text(Ut.value,ae+Lt/2,lt+12,{align:"center"}),ye.setTextColor(100,116,139),ye.setFontSize(8),ye.setFont("helvetica","normal"),ye.text(Ut.label,ae+Lt/2,lt+20,{align:"center"})}),lt+=35;const Ce=[],Ve=[],ce=[];let Re=0,Me=0,Tt=0,$t=0,or=0,Ht=0;we.forEach(Ut=>{Ut.t_and_m_workers&&Ut.t_and_m_workers.forEach(er=>{const ae=parseFloat(er.hours)||0,Se=parseFloat(er.overtime_hours)||0,ge=er.role||"Laborer",xe=[U(Ut.work_date),er.name,ae.toString(),Se>0?Se.toString():"-",(ae+Se).toString()];ge==="Foreman"||ge==="Superintendent"?(Ce.push(xe),Re+=ae,Me+=Se):ge==="Operator"?(Ve.push(xe),Tt+=ae,$t+=Se):(ce.push(xe),or+=ae,Ht+=Se)})});const mr=(Ut,er,ae,Se)=>{er.length!==0&&(lt>Et-80&&(ye.addPage(),lt=Xe),ye.setTextColor(...jt),ye.setFontSize(11),ye.setFont("helvetica","bold"),ye.text(Ut,Xe,lt),lt+=5,Gd(ye,{startY:lt,head:[["Date","Name","Reg Hrs","OT Hrs","Total"]],body:er,margin:{left:Xe,right:Xe},headStyles:{fillColor:jt,textColor:[255,255,255],fontStyle:"bold",fontSize:9},bodyStyles:{fontSize:9,textColor:[51,65,85]},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{0:{cellWidth:30},2:{halign:"center",cellWidth:22},3:{halign:"center",cellWidth:22},4:{halign:"center",cellWidth:22}},foot:[["","SUBTOTAL:",ae.toString(),Se>0?Se.toString():"-",(ae+Se).toString()]],footStyles:{fillColor:Dt,textColor:[255,255,255],fontStyle:"bold",fontSize:9}}),lt=ye.lastAutoTable.finalY+10)};if(Ce.length>0||Ve.length>0||ce.length>0){ye.setTextColor(...jt),ye.setFontSize(12),ye.setFont("helvetica","bold"),ye.text("LABOR",Xe,lt),lt+=8,mr("SUPERVISION",Ce,Re,Me),mr("OPERATORS",Ve,Tt,$t),mr("LABORERS",ce,or,Ht);const Ut=Re+Tt+or,er=Me+$t+Ht;ye.setFillColor(...jt),ye.rect(Xe,lt,Be-Xe*2,12,"F"),ye.setTextColor(255,255,255),ye.setFontSize(10),ye.setFont("helvetica","bold"),ye.text("LABOR TOTAL:",Xe+5,lt+8),ye.text(`${Ut} Reg + ${er} OT = ${Ut+er} Hours`,Be-Xe-5,lt+8,{align:"right"}),lt+=20}lt>Et-100&&(ye.addPage(),lt=Xe);const Ca={},Na={},Ct=["Containment","PPE","Disposal","Equipment","Other"];we.forEach(Ut=>{Ut.t_and_m_items&&Ut.t_and_m_items.forEach(er=>{const ae=er.custom_name||er.materials_equipment?.name||"Unknown",Se=er.custom_category||er.materials_equipment?.category||"Other",ge=er.materials_equipment?.unit||"each",xe=er.materials_equipment?.cost_per_unit||0,Ne=er.quantity*xe;Ca[Se]||(Ca[Se]=[],Na[Se]=0),Ca[Se].push([U(Ut.work_date),ae,er.quantity.toString(),ge,`$${xe.toFixed(2)}`,`$${Ne.toFixed(2)}`]),Na[Se]+=Ne})});const Oa=(Ut,er,ae)=>{!er||er.length===0||(lt>Et-80&&(ye.addPage(),lt=Xe),ye.setTextColor(...jt),ye.setFontSize(11),ye.setFont("helvetica","bold"),ye.text(Ut.toUpperCase(),Xe,lt),lt+=5,Gd(ye,{startY:lt,head:[["Date","Item","Qty","Unit","Rate","Total"]],body:er,margin:{left:Xe,right:Xe},headStyles:{fillColor:jt,textColor:[255,255,255],fontStyle:"bold",fontSize:9},bodyStyles:{fontSize:9,textColor:[51,65,85]},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{2:{halign:"center",cellWidth:20},3:{halign:"center",cellWidth:25},4:{halign:"right",cellWidth:25},5:{halign:"right",cellWidth:30}},foot:[["","","","","Subtotal:",`$${ae.toFixed(2)}`]],footStyles:{fillColor:Dt,textColor:[255,255,255],fontStyle:"bold",fontSize:9}}),lt=ye.lastAutoTable.finalY+10)};Object.keys(Ca).length>0&&(ye.setTextColor(...jt),ye.setFontSize(12),ye.setFont("helvetica","bold"),ye.text("MATERIALS & EQUIPMENT",Xe,lt),lt+=8,Ct.forEach(Ut=>{Ca[Ut]&&Oa(Ut,Ca[Ut],Na[Ut])}),Object.keys(Ca).forEach(Ut=>{Ct.includes(Ut)||Oa(Ut,Ca[Ut],Na[Ut])}),ye.setFillColor(...jt),ye.rect(Xe,lt,Be-Xe*2,12,"F"),ye.setTextColor(255,255,255),ye.setFontSize(10),ye.setFont("helvetica","bold"),ye.text("MATERIALS TOTAL:",Xe+5,lt+8),ye.text(`$${pt.toFixed(2)}`,Be-Xe-5,lt+8,{align:"right"}),lt+=20),lt>Et-80&&(ye.addPage(),lt=Xe),lt+=10,ye.setDrawColor(...jt),ye.setLineWidth(1),ye.line(Xe,lt,Be-Xe,lt),lt+=15,ye.setTextColor(...jt),ye.setFontSize(12),ye.setFont("helvetica","bold"),ye.text("AUTHORIZATION",Xe,lt),lt+=10,ye.setFontSize(10),ye.setFont("helvetica","normal"),ye.setTextColor(71,85,105),ye.text("I hereby authorize the above time and materials charges as accurate and approved for billing.",Xe,lt),lt+=20;const za=ticketsToExport[0]||{},os=(Ut,er,ae,Se,ge,xe,Ne)=>{ye.setFont("helvetica","bold"),ye.setFontSize(8),ye.setTextColor(...jt),ye.text(er,Xe,Ut),ye.setFont("helvetica","normal"),ye.setFontSize(9),ye.setTextColor(100,116,139);const ke=Ut+18;if(ye.setDrawColor(...Dt),ye.setLineWidth(.5),ye.line(Xe,ke,Xe+70,ke),ye.text("Signature",Xe,ke+8),ye.line(Xe+85,ke,Xe+145,ke),ye.text("Title / Company",Xe+85,ke+8),ye.line(Be-Xe-40,ke,Be-Xe,ke),ye.text("Date",Be-Xe-40,ke+8),ae)try{if(ye.addImage(ae,"PNG",Xe,ke-16,60,16),Se&&(ye.setFontSize(8),ye.text(Se,Xe,ke+15)),ge||xe){const He=[ge,xe].filter(Boolean).join(" - ");ye.text(He,Xe+85,ke-5)}if(Ne){const He=new Date(Ne).toLocaleDateString();ye.text(He,Be-Xe-40,ke-5)}}catch(He){console.error("Error adding signature to PDF:",He)}return ke+25};lt=os(lt,"GC AUTHORIZATION",za.gc_signature_data,za.gc_signature_name,za.gc_signature_title,za.gc_signature_company,za.gc_signature_date),lt+=8,lt=os(lt,"CLIENT AUTHORIZATION",za.client_signature_data,za.client_signature_name,za.client_signature_title,za.client_signature_company,za.client_signature_date);const rn=ye.internal.getNumberOfPages();for(let Ut=1;Ut<=rn;Ut++){ye.setPage(Ut);const er=Et-15;ye.setFontSize(8),ye.setTextColor(148,163,184),ye.text(`${e?.name||"Company"} - T&M Report - ${t.name}`,Xe,er),ye.text(`Page ${Ut} of ${rn}`,Be-Xe,er,{align:"right"})}const Mn=`${t.name}_TM_Report_${new Date().toISOString().split("T")[0]}.pdf`;ye.save(Mn),r("PDF exported!","success")},pe=ne.useMemo(()=>{let we=f==="all"?[...n]:n.filter(ye=>ye.status===f);if(C.start){const ye=new Date(C.start);ye.setHours(0,0,0,0),we=we.filter(Be=>new Date(Be.work_date)>=ye)}if(C.end){const ye=new Date(C.end);ye.setHours(23,59,59,999),we=we.filter(Be=>new Date(Be.work_date)<=ye)}if(b==="recent"){const ye=new Date;ye.setDate(ye.getDate()-7),ye.setHours(0,0,0,0),we=we.filter(Be=>new Date(Be.work_date)>=ye)}return we},[n,f,b,C]),ve=ne.useMemo(()=>{if(b!=="all")return null;const we={};return pe.forEach(ye=>{const Be=new Date(ye.work_date),Et=`${Be.getFullYear()}-${String(Be.getMonth()+1).padStart(2,"0")}`,Xe=Be.toLocaleDateString("en-US",{month:"long",year:"numeric"});we[Et]||(we[Et]={label:Xe,tickets:[],hours:0,cost:0}),we[Et].tickets.push(ye),we[Et].hours+=de(ye),we[Et].cost+=re(ye)}),Object.entries(we).sort((ye,Be)=>Be[0].localeCompare(ye[0]))},[pe,b]);ne.useEffect(()=>{if(ve&&ve.length>0){const we=ve[0][0];A(new Set([we]))}},[ve]);const _e=we=>{const ye=new Set(w);ye.has(we)?ye.delete(we):ye.add(we),A(ye)},Pe=pe.reduce((we,ye)=>we+de(ye),0),fe=pe.reduce((we,ye)=>we+re(ye),0),st=f==="all"?n.length:n.filter(we=>we.status===f).length;if(l)return o.jsx("div",{className:"loading",children:"Loading T&M tickets..."});const mt=pe.length>0&&pe.every(we=>x.has(we.id)),he=x.size>0,at=we=>o.jsxs("div",{className:`tm-ticket-card ${we.status} ${x.has(we.id)?"selected":""}`,children:[o.jsxs("div",{className:"tm-ticket-header",onClick:()=>v(m===we.id?null:we.id),children:[o.jsx("input",{type:"checkbox",checked:x.has(we.id),onChange:ye=>k(we.id,ye),onClick:ye=>ye.stopPropagation(),className:"tm-checkbox"}),o.jsxs("div",{className:"tm-ticket-info",children:[o.jsx("span",{className:"tm-ticket-date",children:U(we.work_date)}),we.ce_pco_number&&o.jsx("span",{className:"tm-ce-badge",children:we.ce_pco_number}),o.jsx("span",{className:`tm-ticket-status ${we.status}`,children:we.status})]}),o.jsxs("div",{className:"tm-ticket-summary",children:[o.jsxs("span",{className:"tm-ticket-hours",children:[de(we)," hrs"]}),o.jsxs("span",{className:"tm-ticket-total",children:["$",re(we).toFixed(2)]}),o.jsx("span",{className:"tm-expand-arrow",children:m===we.id?"":""})]})]}),m===we.id&&o.jsxs("div",{className:"tm-ticket-details",children:[we.t_and_m_workers?.length>0&&o.jsxs("div",{className:"tm-detail-section",children:[o.jsxs("h4",{children:[o.jsx(Ui,{size:16,className:"inline-icon"})," Workers"]}),o.jsx("div",{className:"tm-detail-list",children:we.t_and_m_workers.map(ye=>o.jsxs("div",{className:"tm-detail-row",children:[o.jsxs("span",{children:[ye.role&&ye.role!=="Laborer"&&o.jsx("span",{className:"tm-role-badge",children:ye.role}),ye.name]}),o.jsxs("span",{children:[ye.hours," hrs",parseFloat(ye.overtime_hours)>0&&o.jsxs("span",{className:"tm-ot-badge",children:[" +",ye.overtime_hours," OT"]})]})]},ye.id))})]}),we.t_and_m_items?.length>0&&o.jsxs("div",{className:"tm-detail-section",children:[o.jsxs("h4",{children:[o.jsx(t2,{size:16,className:"inline-icon"})," Materials & Equipment"]}),o.jsx("div",{className:"tm-detail-list",children:we.t_and_m_items.map(ye=>o.jsxs("div",{className:"tm-detail-row",children:[o.jsx("span",{children:ye.custom_name?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"tm-custom-badge",children:"Custom"})," ",ye.custom_name]}):ye.materials_equipment?.name}),o.jsxs("span",{className:"tm-detail-qty",children:[ye.quantity," ",ye.materials_equipment?.unit||"each",ye.materials_equipment?.cost_per_unit>0&&o.jsxs("span",{className:"tm-item-cost",children:["$",(ye.quantity*ye.materials_equipment.cost_per_unit).toFixed(2)]})]})]},ye.id))})]}),we.notes&&o.jsxs("div",{className:"tm-detail-section",children:[o.jsxs("h4",{children:[o.jsx(El,{size:16,className:"inline-icon"})," Description"]}),o.jsx("p",{className:"tm-notes-text",children:we.notes})]}),we.photos&&we.photos.length>0&&o.jsxs("div",{className:"tm-detail-section",children:[o.jsxs("h4",{children:[o.jsx(Op,{size:16,className:"inline-icon"})," Photos (",we.photos.length,")"]}),o.jsx("div",{className:"tm-photos-grid",children:we.photos.map((ye,Be)=>o.jsx("a",{href:ye,target:"_blank",rel:"noopener noreferrer",className:"tm-photo-thumb",children:o.jsx("img",{src:ye,alt:`Photo ${Be+1}`})},Be))})]}),we.ce_pco_number&&we.change_order_value>0&&o.jsxs("div",{className:"tm-change-order-value",children:[o.jsx("span",{className:"tm-co-label",children:"Change Order Value:"}),o.jsxs("span",{className:"tm-co-amount",children:["$",we.change_order_value.toLocaleString()]})]}),o.jsxs("div",{className:"tm-ticket-actions",children:[we.status==="pending"&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{className:"btn btn-success btn-small",onClick:ye=>{ye.stopPropagation(),X(we)},children:["Approve ",we.ce_pco_number?"+ CO":""]}),o.jsx("button",{className:"btn btn-warning btn-small",onClick:ye=>{ye.stopPropagation(),ie(we.id,"rejected")},children:"Reject"})]}),we.status==="approved"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"btn btn-primary btn-small",onClick:ye=>{ye.stopPropagation(),ie(we.id,"billed")},children:"Mark Billed"}),o.jsxs("button",{className:"btn btn-secondary btn-small",onClick:ye=>{ye.stopPropagation(),M(we),D(!0)},children:[o.jsx(Qx,{size:14})," Signature Link"]})]}),we.status==="rejected"&&o.jsx("button",{className:"btn btn-secondary btn-small",onClick:ye=>{ye.stopPropagation(),ie(we.id,"pending")},children:"Restore"}),o.jsx("button",{className:"btn btn-danger btn-small",onClick:ye=>{ye.stopPropagation(),K(we.id)},children:"Delete"})]})]})]},we.id);return o.jsxs("div",{className:"tm-list",children:[o.jsxs("div",{className:"tm-list-header",children:[o.jsxs("div",{className:"tm-list-title",children:[o.jsx("h3",{children:"T&M Tickets"}),o.jsxs("div",{className:"tm-export-buttons",children:[he&&o.jsxs("button",{className:"btn btn-ghost btn-small",onClick:I,children:["Clear (",x.size,")"]}),o.jsxs("button",{className:"btn btn-secondary btn-small",onClick:te,children:["Excel ",he?`(${x.size})`:""]}),o.jsxs("button",{className:"btn btn-primary btn-small",onClick:se,children:["PDF ",he?`(${x.size})`:""]})]})]}),o.jsx("div",{className:"tm-filter-tabs",children:["all","pending","approved","billed","rejected"].map(we=>o.jsxs("button",{className:`tm-filter-tab ${f===we?"active":""}`,onClick:()=>{d(we),I()},children:[we.charAt(0).toUpperCase()+we.slice(1),o.jsx("span",{className:"tm-filter-count",children:we==="all"?n.length:n.filter(ye=>ye.status===we).length})]},we))}),o.jsxs("div",{className:"view-mode-bar",children:[o.jsxs("div",{className:"view-mode-tabs",children:[o.jsx("button",{className:`view-mode-tab ${b==="recent"?"active":""}`,onClick:()=>{_("recent"),E({start:"",end:""})},children:"Recent (7 days)"}),o.jsxs("button",{className:`view-mode-tab ${b==="all"?"active":""}`,onClick:()=>_("all"),children:["All (",st,")"]})]}),b==="all"&&o.jsxs("div",{className:"date-filter",children:[o.jsx(V0,{size:16}),o.jsx("input",{type:"date",value:C.start,onChange:we=>E(ye=>({...ye,start:we.target.value})),placeholder:"Start date"}),o.jsx("span",{children:"to"}),o.jsx("input",{type:"date",value:C.end,onChange:we=>E(ye=>({...ye,end:we.target.value})),placeholder:"End date"}),(C.start||C.end)&&o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>E({start:"",end:""}),children:"Clear"})]})]})]}),pe.length>0&&o.jsxs("div",{className:"tm-summary-bar",children:[o.jsxs("div",{className:"tm-summary-stat",children:[o.jsx("span",{className:"tm-summary-label",children:"Tickets"}),o.jsx("span",{className:"tm-summary-value",children:pe.length})]}),o.jsxs("div",{className:"tm-summary-stat",children:[o.jsx("span",{className:"tm-summary-label",children:"Total Hours"}),o.jsx("span",{className:"tm-summary-value",children:Pe.toFixed(1)})]}),o.jsxs("div",{className:"tm-summary-stat",children:[o.jsx("span",{className:"tm-summary-label",children:"Materials Cost"}),o.jsxs("span",{className:"tm-summary-value",children:["$",fe.toFixed(2)]})]})]}),pe.length===0?o.jsxs("div",{className:"tm-empty-state",children:[o.jsxs("p",{children:["No ",f==="all"?"":f," T&M tickets",b==="recent"?" in the last 7 days":""]}),b==="recent"&&st>0&&o.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>_("all"),children:"View All Tickets"})]}):o.jsxs("div",{className:"tm-tickets",children:[o.jsx("div",{className:"tm-select-all-row",children:o.jsxs("label",{className:"tm-checkbox-label",onClick:F,children:[o.jsx("input",{type:"checkbox",checked:mt,onChange:F,className:"tm-checkbox"}),o.jsxs("span",{children:["Select All (",pe.length,")"]})]})}),b==="all"&&ve?ve.map(([we,ye])=>o.jsxs("div",{className:"month-group",children:[o.jsxs("div",{className:"month-header",onClick:()=>_e(we),children:[o.jsxs("div",{className:"month-header-left",children:[w.has(we)?o.jsx(jf,{size:18}):o.jsx(Ef,{size:18}),o.jsx("span",{className:"month-label",children:ye.label}),o.jsxs("span",{className:"month-count",children:[ye.tickets.length," tickets"]})]}),o.jsxs("div",{className:"month-header-right",children:[o.jsxs("span",{className:"month-stat",children:[ye.hours.toFixed(1)," hrs"]}),o.jsxs("span",{className:"month-stat",children:["$",ye.cost.toFixed(2)]})]})]}),w.has(we)&&o.jsx("div",{className:"month-tickets",children:ye.tickets.map(Be=>at(Be))})]},we)):pe.map(we=>at(we))]}),R&&W&&o.jsx("div",{className:"modal-overlay",onClick:()=>Y(!1),children:o.jsxs("div",{className:"modal change-order-modal",onClick:we=>we.stopPropagation(),children:[o.jsx("h3",{children:"Approve Change Order Work"}),o.jsxs("p",{className:"modal-subtitle",children:["This T&M ticket is associated with ",o.jsx("strong",{children:W.ce_pco_number})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Change Order Value ($)"}),o.jsx("input",{type:"number",value:q,onChange:we=>L(we.target.value),placeholder:"Enter the change order amount",autoFocus:!0}),o.jsx("p",{className:"form-help",children:"This amount will be added to the project's total contract value."})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{className:"btn btn-secondary",onClick:()=>Y(!1),children:"Cancel"}),o.jsxs("button",{className:"btn btn-success",onClick:Z,children:["Approve with $",parseFloat(q||0).toLocaleString()]})]})]})}),J&&T&&o.jsx(r3,{documentType:"tm_ticket",documentId:T.id,companyId:e?.id,projectId:t?.id,documentTitle:`T&M Ticket - ${new Date(T.work_date).toLocaleDateString()}${T.ce_pco_number?` (${T.ce_pco_number})`:""}`,onClose:()=>{D(!1),M(null)},onShowToast:r})]})}function AH({project:t,onClose:e,onShareCreated:r}){const{user:a}=e3(),[n,s]=ne.useState(!1),[l,c]=ne.useState(null),[f,d]=ne.useState([]),[m,v]=ne.useState(!1),[x,g]=ne.useState({progress:!0,photos:!0,daily_reports:!0,tm_tickets:!1,crew_info:!1}),[b,_]=ne.useState("never"),[w,A]=ne.useState("");ne.useEffect(()=>{C()},[t.id]);const C=async()=>{try{const T=await ot.getProjectShares(t.id);d(T)}catch(T){console.error("Error loading shares:",T)}},E=T=>{g(M=>({...M,[T]:!M[T]}))},R=()=>{if(b==="never")return null;const T=new Date;if(b==="30days")T.setDate(T.getDate()+30);else if(b==="90days")T.setDate(T.getDate()+90);else if(b==="custom"&&w)return new Date(w).toISOString();return T.toISOString()},Y=async()=>{s(!0);try{const T=R(),M=await ot.createProjectShare(t.id,a.id,x,T);c({type:"success",message:"Share link created!"}),v(!1),C(),r&&r(M)}catch(T){console.error("Error creating share:",T),c({type:"error",message:"Failed to create share link"})}finally{s(!1)}},W=T=>{const M=`${window.location.origin}/view/${T}`;navigator.clipboard.writeText(M),c({type:"success",message:"Link copied to clipboard!"})},B=async T=>{if(confirm("Are you sure you want to revoke this share link?"))try{await ot.revokeProjectShare(T),c({type:"success",message:"Share link revoked"}),C()}catch(M){console.error("Error revoking share:",M),c({type:"error",message:"Failed to revoke share link"})}},q=async T=>{if(confirm("Are you sure you want to permanently delete this share link?"))try{await ot.deleteProjectShare(T),c({type:"success",message:"Share link deleted"}),C()}catch(M){console.error("Error deleting share:",M),c({type:"error",message:"Failed to delete share link"})}},L=T=>T?new Date(T).toLocaleDateString():"Never",J=T=>T?new Date(T)<new Date:!1,D=T=>{const M=[];return T.progress&&M.push("Progress"),T.photos&&M.push("Photos"),T.daily_reports&&M.push("Reports"),T.tm_tickets&&M.push("T&M"),T.crew_info&&M.push("Crew"),M.join(", ")};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"modal-overlay",onClick:e,children:o.jsxs("div",{className:"modal-content share-modal",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("h2",{children:["Share Project: ",t.name]}),o.jsx("button",{className:"close-btn",onClick:e,children:""})]}),o.jsxs("div",{className:"modal-body",children:[f.length>0&&o.jsxs("div",{className:"existing-shares",children:[o.jsx("h3",{children:"Active Share Links"}),o.jsx("div",{className:"shares-list",children:f.map(T=>o.jsxs("div",{className:`share-item ${!T.is_active||J(T.expires_at)?"inactive":""}`,children:[o.jsxs("div",{className:"share-info",children:[o.jsxs("div",{className:"share-token",children:[o.jsxs("code",{children:[window.location.origin,"/view/",T.share_token]}),o.jsx("button",{className:"btn-small",onClick:()=>W(T.share_token),disabled:!T.is_active||J(T.expires_at),children:"Copy"})]}),o.jsxs("div",{className:"share-meta",children:[o.jsx("span",{className:"permissions",children:D(T.permissions)}),o.jsxs("span",{className:"expiry",children:["Expires: ",L(T.expires_at)]}),o.jsxs("span",{className:"views",children:["Views: ",T.view_count||0,T.last_viewed_at&&` (Last: ${L(T.last_viewed_at)})`]})]}),!T.is_active&&o.jsx("div",{className:"status-badge revoked",children:"Revoked"}),J(T.expires_at)&&T.is_active&&o.jsx("div",{className:"status-badge expired",children:"Expired"})]}),o.jsxs("div",{className:"share-actions",children:[T.is_active&&!J(T.expires_at)&&o.jsx("button",{className:"btn-secondary",onClick:()=>B(T.id),children:"Revoke"}),o.jsx("button",{className:"btn-danger",onClick:()=>q(T.id),children:"Delete"})]})]},T.id))})]}),!m&&o.jsx("button",{className:"btn-primary",onClick:()=>v(!0),children:"+ Create New Share Link"}),m&&o.jsxs("div",{className:"new-share-form",children:[o.jsx("h3",{children:"Create New Share Link"}),o.jsxs("div",{className:"form-section",children:[o.jsx("label",{children:"Permissions"}),o.jsxs("div",{className:"checkbox-group",children:[o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:x.progress,onChange:()=>E("progress")}),"Progress/completion status"]}),o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:x.photos,onChange:()=>E("photos")}),"Photos feed"]}),o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:x.daily_reports,onChange:()=>E("daily_reports")}),"Daily reports"]}),o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:x.tm_tickets,onChange:()=>E("tm_tickets")}),"T&M tickets"]}),o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:x.crew_info,onChange:()=>E("crew_info")}),"Crew information"]})]})]}),o.jsxs("div",{className:"form-section",children:[o.jsx("label",{children:"Link Expiration"}),o.jsxs("div",{className:"radio-group",children:[o.jsxs("label",{children:[o.jsx("input",{type:"radio",value:"never",checked:b==="never",onChange:T=>_(T.target.value)}),"Never expires"]}),o.jsxs("label",{children:[o.jsx("input",{type:"radio",value:"30days",checked:b==="30days",onChange:T=>_(T.target.value)}),"30 days"]}),o.jsxs("label",{children:[o.jsx("input",{type:"radio",value:"90days",checked:b==="90days",onChange:T=>_(T.target.value)}),"90 days"]}),o.jsxs("label",{children:[o.jsx("input",{type:"radio",value:"custom",checked:b==="custom",onChange:T=>_(T.target.value)}),"Custom date"]})]}),b==="custom"&&o.jsx("input",{type:"date",value:w,onChange:T=>A(T.target.value),min:new Date().toISOString().split("T")[0],className:"date-input"})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{className:"btn-secondary",onClick:()=>v(!1),children:"Cancel"}),o.jsx("button",{className:"btn-primary",onClick:Y,disabled:n,children:n?"Generating...":"Generate Share Link"})]})]})]})]})}),l&&o.jsx(lu,{message:l.message,type:l.type,onClose:()=>c(null)}),o.jsx("style",{children:`
        .share-modal {
          max-width: 700px;
          max-height: 80vh;
          overflow-y: auto;
        }

        .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1.5rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .modal-header h2 {
          margin: 0;
          font-size: 1.25rem;
        }

        .close-btn {
          background: none;
          border: none;
          font-size: 2rem;
          cursor: pointer;
          color: #6b7280;
          padding: 0;
          width: 2rem;
          height: 2rem;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .close-btn:hover {
          color: #111827;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .existing-shares {
          margin-bottom: 2rem;
        }

        .existing-shares h3 {
          margin-top: 0;
          margin-bottom: 1rem;
          font-size: 1.1rem;
        }

        .shares-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .share-item {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1rem;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          gap: 1rem;
        }

        .share-item.inactive {
          opacity: 0.6;
          background-color: #f9fafb;
        }

        .share-info {
          flex: 1;
        }

        .share-token {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
        }

        .share-token code {
          background-color: #f3f4f6;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.875rem;
          flex: 1;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .share-meta {
          display: flex;
          flex-wrap: wrap;
          gap: 1rem;
          font-size: 0.875rem;
          color: #6b7280;
        }

        .status-badge {
          display: inline-block;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.75rem;
          font-weight: 500;
          margin-top: 0.5rem;
        }

        .status-badge.revoked {
          background-color: #fee2e2;
          color: #991b1b;
        }

        .status-badge.expired {
          background-color: #fef3c7;
          color: #92400e;
        }

        .share-actions {
          display: flex;
          gap: 0.5rem;
          flex-shrink: 0;
        }

        .new-share-form {
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1.5rem;
          background-color: #f9fafb;
        }

        .new-share-form h3 {
          margin-top: 0;
          margin-bottom: 1.5rem;
          font-size: 1.1rem;
        }

        .form-section {
          margin-bottom: 1.5rem;
        }

        .form-section label {
          display: block;
          font-weight: 500;
          margin-bottom: 0.5rem;
        }

        .checkbox-group,
        .radio-group {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .checkbox-group label,
        .radio-group label {
          font-weight: normal;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .checkbox-group input[type="checkbox"],
        .radio-group input[type="radio"] {
          margin: 0;
        }

        .date-input {
          margin-top: 0.5rem;
          padding: 0.5rem;
          border: 1px solid #d1d5db;
          border-radius: 4px;
          width: 100%;
        }

        .form-actions {
          display: flex;
          justify-content: flex-end;
          gap: 0.5rem;
          margin-top: 1.5rem;
        }

        .btn-small {
          padding: 0.25rem 0.75rem;
          font-size: 0.875rem;
          border: 1px solid #d1d5db;
          background-color: white;
          border-radius: 4px;
          cursor: pointer;
        }

        .btn-small:hover:not(:disabled) {
          background-color: #f3f4f6;
        }

        .btn-small:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-primary,
        .btn-secondary,
        .btn-danger {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          opacity: 0.9;
        }

        .btn-primary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-secondary {
          background-color: #f3f4f6;
          color: #374151;
        }

        .btn-secondary:hover {
          background-color: #e5e7eb;
        }

        .btn-danger {
          background-color: #ef4444;
          color: white;
        }

        .btn-danger:hover {
          background-color: #dc2626;
        }
      `})]})}const Hv=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},CH=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});function TH({project:t,companyId:e,company:r,onShowToast:a}){const{branding:n}=uh(),[s,l]=ne.useState([]),[c,f]=ne.useState(null),[d,m]=ne.useState(!1),[v,x]=ne.useState(!0),[g,b]=ne.useState(null),[_,w]=ne.useState("recent"),[A,C]=ne.useState(new Set),[E,R]=ne.useState({start:"",end:""});ne.useEffect(()=>{Y()},[t?.id]);const Y=async()=>{x(!0);try{const K=t?await ot.getInjuryReports(t.id):await ot.getCompanyInjuryReports(e);l(K)}catch(K){console.error("Error loading injury reports:",K),b({type:"error",message:"Failed to load injury reports"})}finally{x(!1)}},W=()=>{Y(),m(!1),b({type:"success",message:"Injury report created successfully"})},B=K=>{f(K)},q=()=>{f(null)},L=K=>K?new Date(K).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",J=K=>K?new Date(`2000-01-01T${K}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"",D=K=>({minor:"Minor Injury",serious:"Serious Injury",critical:"Critical Injury",near_miss:"Near Miss"})[K]||K,T=K=>({reported:"#fbbf24",under_investigation:"#3b82f6",closed:"#10b981"})[K]||"#9ca3af",M=K=>({minor:"#10b981",serious:"#f59e0b",critical:"#ef4444",near_miss:"#6b7280"})[K]||"#9ca3af",V=ne.useMemo(()=>{let K=[...s];if(E.start){const re=new Date(E.start);re.setHours(0,0,0,0),K=K.filter(de=>new Date(de.incident_date)>=re)}if(E.end){const re=new Date(E.end);re.setHours(23,59,59,999),K=K.filter(de=>new Date(de.incident_date)<=re)}if(_==="recent"){const re=new Date;re.setDate(re.getDate()-7),re.setHours(0,0,0,0),K=K.filter(de=>new Date(de.incident_date)>=re)}return K},[s,_,E]),ie=ne.useMemo(()=>{if(_!=="all")return null;const K={};return V.forEach(re=>{const de=new Date(re.incident_date),U=`${de.getFullYear()}-${String(de.getMonth()+1).padStart(2,"0")}`,k=de.toLocaleDateString("en-US",{month:"long",year:"numeric"});K[U]||(K[U]={label:k,reports:[]}),K[U].reports.push(re)}),Object.entries(K).sort((re,de)=>de[0].localeCompare(re[0]))},[V,_]);ne.useEffect(()=>{if(ie&&ie.length>0){const K=ie[0][0];C(new Set([K]))}},[ie]);const X=K=>{const re=new Set(A);re.has(K)?re.delete(K):re.add(K),C(re)},Z=async()=>{if(s.length===0){b({type:"error",message:"No reports to export"});return}b({type:"info",message:"Generating PDF..."});const K=new ir,re=K.internal.pageSize.getWidth(),de=20;let U=de;const k=Hv(n?.primary_color||"#3B82F6"),F=Hv(n?.secondary_color||"#1E40AF");K.setFillColor(...k),K.rect(0,0,re,45,"F"),K.setFillColor(...F),K.rect(0,42,re,3,"F");let I=de;if(n?.logo_url)try{const se=await CH(n.logo_url);se&&(K.addImage(se,"PNG",de,7,30,30),I=de+40)}catch(se){console.error("Error adding logo:",se)}K.setTextColor(255,255,255),K.setFontSize(22),K.setFont("helvetica","bold"),K.text(r?.name||"Company",I,20),K.setFontSize(10),K.setFont("helvetica","normal"),K.text("INJURY & INCIDENT REPORTS",I,30),K.setFontSize(9),K.text(`Generated: ${new Date().toLocaleDateString()}`,re-de,20,{align:"right"}),K.text(`Total Reports: ${s.length}`,re-de,28,{align:"right"}),U=55,t&&(K.setFillColor(248,250,252),K.rect(de,U-5,re-de*2,15,"F"),K.setTextColor(...k),K.setFontSize(12),K.setFont("helvetica","bold"),K.text(`Project: ${t.name}`,de+5,U+5),U+=20),s.forEach(se=>{U>200&&(K.addPage(),U=de);const pe=Hv(M(se.injury_type));K.setFillColor(...pe),K.rect(de,U,re-de*2,12,"F"),K.setTextColor(255,255,255),K.setFontSize(11),K.setFont("helvetica","bold"),K.text(`${se.employee_name} - ${D(se.injury_type)}`,de+5,U+8),K.text(L(se.incident_date),re-de-5,U+8,{align:"right"}),U+=17,K.setTextColor(50,50,50),K.setFontSize(9),K.setFont("helvetica","normal"),K.text(`Location: ${se.incident_location}`,de+5,U),se.incident_time&&K.text(`Time: ${J(se.incident_time)}`,de+100,U),U+=6,K.setFont("helvetica","bold"),K.text("Description:",de+5,U),K.setFont("helvetica","normal"),U+=5;const ve=K.splitTextToSize(se.incident_description,re-de*2-10);K.text(ve,de+5,U),U+=ve.length*4+3;const _e=[];se.body_part_affected&&_e.push(`Body Part: ${se.body_part_affected}`),se.osha_recordable&&_e.push("OSHA Recordable"),se.workers_comp_claim&&_e.push("Workers' Comp Filed"),se.medical_treatment_required&&_e.push("Medical Treatment Required"),_e.length>0&&(K.setFontSize(8),K.setTextColor(100,100,100),K.text(_e.join("  |  "),de+5,U),U+=5),K.setFontSize(8),K.text(`Reported by: ${se.reported_by_name} (${se.reported_by_title})`,de+5,U),U+=12});const z=K.internal.getNumberOfPages();for(let se=1;se<=z;se++)K.setPage(se),K.setFontSize(8),K.setTextColor(150,150,150),K.text(`Page ${se} of ${z}`,re/2,K.internal.pageSize.getHeight()-10,{align:"center"}),K.text("CONFIDENTIAL - Injury Report",de,K.internal.pageSize.getHeight()-10);const te=`Injury_Reports_${new Date().toISOString().split("T")[0]}.pdf`;K.save(te),b({type:"success",message:"PDF exported!"})};return v?o.jsxs("div",{className:"loading-container",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading injury reports..."})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"injury-reports-section",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("h3",{children:"Injury & Incident Reports"}),o.jsxs("div",{className:"section-header-actions",children:[s.length>0&&o.jsx("button",{className:"btn-secondary",onClick:Z,children:"PDF"}),o.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"+ File Injury Report"})]})]}),o.jsxs("div",{className:"view-mode-bar",children:[o.jsxs("div",{className:"view-mode-tabs",children:[o.jsx("button",{className:`view-mode-tab ${_==="recent"?"active":""}`,onClick:()=>{w("recent"),R({start:"",end:""})},children:"Recent (7 days)"}),o.jsxs("button",{className:`view-mode-tab ${_==="all"?"active":""}`,onClick:()=>w("all"),children:["All (",s.length,")"]})]}),_==="all"&&o.jsxs("div",{className:"date-filter",children:[o.jsx(V0,{size:16}),o.jsx("input",{type:"date",value:E.start,onChange:K=>R(re=>({...re,start:K.target.value})),placeholder:"Start date"}),o.jsx("span",{children:"to"}),o.jsx("input",{type:"date",value:E.end,onChange:K=>R(re=>({...re,end:K.target.value})),placeholder:"End date"}),(E.start||E.end)&&o.jsx("button",{className:"btn-ghost",onClick:()=>R({start:"",end:""}),children:"Clear"})]})]}),V.length===0?o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:""}),o.jsxs("h4",{children:["No Injury Reports",_==="recent"?" in the last 7 days":""]}),o.jsx("p",{children:'Click "File Injury Report" to document a workplace incident'}),_==="recent"&&s.length>0&&o.jsx("button",{className:"btn-secondary",onClick:()=>w("all"),children:"View All Reports"})]}):o.jsx("div",{className:"reports-list",children:_==="all"&&ie?ie.map(([K,re])=>o.jsxs("div",{className:"month-group",children:[o.jsx("div",{className:"month-header",onClick:()=>X(K),children:o.jsxs("div",{className:"month-header-left",children:[A.has(K)?o.jsx(jf,{size:18}):o.jsx(Ef,{size:18}),o.jsx("span",{className:"month-label",children:re.label}),o.jsxs("span",{className:"month-count",children:[re.reports.length," reports"]})]})}),A.has(K)&&o.jsx("div",{className:"month-reports",children:re.reports.map(de=>o.jsxs("div",{className:"report-card",onClick:()=>B(de),children:[o.jsxs("div",{className:"report-header",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"report-date",children:[L(de.incident_date)," at ",J(de.incident_time)]}),o.jsx("div",{className:"employee-name",children:de.employee_name})]}),o.jsxs("div",{className:"report-badges",children:[o.jsx("span",{className:"badge",style:{backgroundColor:M(de.injury_type)},children:D(de.injury_type)}),o.jsx("span",{className:"badge",style:{backgroundColor:T(de.status)},children:de.status.replace("_"," ")})]})]}),o.jsxs("div",{className:"report-summary",children:[o.jsxs("div",{className:"summary-item",children:[o.jsx("strong",{children:"Location:"})," ",de.incident_location]}),o.jsxs("div",{className:"summary-item",children:[o.jsx("strong",{children:"Reported by:"})," ",de.reported_by_name," (",de.reported_by_title,")"]}),de.body_part_affected&&o.jsxs("div",{className:"summary-item",children:[o.jsx("strong",{children:"Body Part:"})," ",de.body_part_affected]}),de.osha_recordable&&o.jsx("div",{className:"summary-item",children:o.jsx("span",{className:"osha-badge",children:"OSHA Recordable"})})]}),o.jsxs("div",{className:"report-description",children:[de.incident_description.substring(0,150),de.incident_description.length>150&&"..."]}),o.jsx("div",{className:"report-footer",children:o.jsx("span",{children:"Click to view full details"})})]},de.id))})]},K)):V.map(K=>o.jsxs("div",{className:"report-card",onClick:()=>B(K),children:[o.jsxs("div",{className:"report-header",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"report-date",children:[L(K.incident_date)," at ",J(K.incident_time)]}),o.jsx("div",{className:"employee-name",children:K.employee_name})]}),o.jsxs("div",{className:"report-badges",children:[o.jsx("span",{className:"badge",style:{backgroundColor:M(K.injury_type)},children:D(K.injury_type)}),o.jsx("span",{className:"badge",style:{backgroundColor:T(K.status)},children:K.status.replace("_"," ")})]})]}),o.jsxs("div",{className:"report-summary",children:[o.jsxs("div",{className:"summary-item",children:[o.jsx("strong",{children:"Location:"})," ",K.incident_location]}),o.jsxs("div",{className:"summary-item",children:[o.jsx("strong",{children:"Reported by:"})," ",K.reported_by_name," (",K.reported_by_title,")"]}),K.body_part_affected&&o.jsxs("div",{className:"summary-item",children:[o.jsx("strong",{children:"Body Part:"})," ",K.body_part_affected]}),K.osha_recordable&&o.jsx("div",{className:"summary-item",children:o.jsx("span",{className:"osha-badge",children:"OSHA Recordable"})})]}),o.jsxs("div",{className:"report-description",children:[K.incident_description.substring(0,150),K.incident_description.length>150&&"..."]}),o.jsx("div",{className:"report-footer",children:o.jsx("span",{children:"Click to view full details"})})]},K.id))}),c&&o.jsx("div",{className:"modal-overlay",onClick:q,children:o.jsxs("div",{className:"modal-content report-details-modal",onClick:K=>K.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Injury Report Details"}),o.jsx("button",{className:"close-btn",onClick:q,children:""})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Incident Information"}),o.jsxs("div",{className:"detail-grid",children:[o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Date & Time"}),o.jsxs("div",{children:[L(c.incident_date)," at ",J(c.incident_time)]})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Location"}),o.jsx("div",{children:c.incident_location})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Injury Type"}),o.jsx("div",{children:o.jsx("span",{className:"badge",style:{backgroundColor:M(c.injury_type)},children:D(c.injury_type)})})]}),c.body_part_affected&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Body Part Affected"}),o.jsx("div",{children:c.body_part_affected})]})]}),o.jsxs("div",{className:"detail-item full-width",children:[o.jsx("label",{children:"Description"}),o.jsx("div",{className:"description-box",children:c.incident_description})]})]}),o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Injured Employee"}),o.jsxs("div",{className:"detail-grid",children:[o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Name"}),o.jsx("div",{children:c.employee_name})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Job Title"}),o.jsx("div",{children:c.employee_job_title})]}),c.employee_phone&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Phone"}),o.jsx("div",{children:c.employee_phone})]}),c.employee_email&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Email"}),o.jsx("div",{children:c.employee_email})]}),c.employee_address&&o.jsxs("div",{className:"detail-item full-width",children:[o.jsx("label",{children:"Address"}),o.jsx("div",{children:c.employee_address})]})]})]}),o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Reported By"}),o.jsxs("div",{className:"detail-grid",children:[o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Name"}),o.jsx("div",{children:c.reported_by_name})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Title"}),o.jsx("div",{children:c.reported_by_title})]}),c.reported_by_phone&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Phone"}),o.jsx("div",{children:c.reported_by_phone})]}),c.reported_by_email&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Email"}),o.jsx("div",{children:c.reported_by_email})]})]})]}),c.witnesses&&c.witnesses.length>0&&o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Witnesses"}),c.witnesses.map((K,re)=>o.jsxs("div",{className:"witness-card",children:[o.jsxs("div",{className:"witness-header",children:[o.jsx("strong",{children:K.name}),K.phone&&o.jsxs("span",{children:["  ",K.phone]}),K.email&&o.jsxs("span",{children:["  ",K.email]})]}),K.testimony&&o.jsx("div",{className:"witness-testimony",children:o.jsxs("em",{children:['"',K.testimony,'"']})})]},re))]}),c.medical_treatment_required&&o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Medical Treatment"}),o.jsxs("div",{className:"detail-grid",children:[c.medical_facility_name&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Facility"}),o.jsx("div",{children:c.medical_facility_name})]}),c.medical_facility_address&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Address"}),o.jsx("div",{children:c.medical_facility_address})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Hospitalized"}),o.jsx("div",{children:c.hospitalized?"Yes":"No"})]})]})]}),o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Actions & Safety"}),c.immediate_actions_taken&&o.jsxs("div",{className:"detail-item full-width",children:[o.jsx("label",{children:"Immediate Actions Taken"}),o.jsx("div",{className:"description-box",children:c.immediate_actions_taken})]}),c.corrective_actions_planned&&o.jsxs("div",{className:"detail-item full-width",children:[o.jsx("label",{children:"Corrective Actions Planned"}),o.jsx("div",{className:"description-box",children:c.corrective_actions_planned})]}),o.jsxs("div",{className:"detail-grid",children:[c.safety_equipment_used&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Safety Equipment Used"}),o.jsx("div",{children:c.safety_equipment_used})]}),c.safety_equipment_failed&&o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Safety Equipment Failed"}),o.jsx("div",{children:c.safety_equipment_failed})]})]})]}),o.jsxs("section",{className:"details-section",children:[o.jsx("h3",{children:"Regulatory & Work Impact"}),o.jsxs("div",{className:"detail-grid",children:[o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"OSHA Recordable"}),o.jsx("div",{children:c.osha_recordable?"Yes":"No"})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Workers' Comp Claim"}),o.jsx("div",{children:c.workers_comp_claim?"Yes":"No"})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Days Away From Work"}),o.jsx("div",{children:c.days_away_from_work||0})]}),o.jsxs("div",{className:"detail-item",children:[o.jsx("label",{children:"Restricted Work Days"}),o.jsx("div",{children:c.restricted_work_days||0})]})]})]}),o.jsxs("div",{className:"report-meta",children:["Filed on ",L(c.created_at)]})]})]})}),d&&o.jsx(t3,{project:t,companyId:e,onClose:()=>m(!1),onReportCreated:W}),g&&o.jsx(lu,{message:g.message,type:g.type,onClose:()=>b(null)})]}),o.jsx("style",{children:`
        .injury-reports-section {
          margin-top: 2rem;
        }

        .section-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
        }

        .section-header h3 {
          margin: 0;
          font-size: 1.25rem;
          color: #111827;
        }

        .view-mode-bar {
          display: flex;
          justify-content: space-between;
          align-items: center;
          gap: 1rem;
          margin-bottom: 1rem;
          padding: 0.75rem;
          background: #f8fafc;
          border-radius: 8px;
          flex-wrap: wrap;
        }

        .view-mode-tabs {
          display: flex;
          gap: 0.5rem;
        }

        .view-mode-tab {
          padding: 0.5rem 1rem;
          border: none;
          border-radius: 6px;
          font-size: 0.875rem;
          cursor: pointer;
          background: transparent;
          color: #64748b;
          transition: all 0.2s;
        }

        .view-mode-tab:hover {
          background: #e2e8f0;
        }

        .view-mode-tab.active {
          background: var(--primary-color, #3b82f6);
          color: white;
        }

        .date-filter {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          color: #64748b;
        }

        .date-filter input[type="date"] {
          padding: 0.4rem 0.5rem;
          border: 1px solid #e2e8f0;
          border-radius: 4px;
          font-size: 0.875rem;
        }

        .btn-ghost {
          background: transparent;
          border: none;
          padding: 0.4rem 0.75rem;
          color: #64748b;
          cursor: pointer;
          border-radius: 4px;
          font-size: 0.875rem;
        }

        .btn-ghost:hover {
          background: #e2e8f0;
        }

        .month-group {
          margin-bottom: 0.5rem;
        }

        .month-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 0.75rem 1rem;
          background: #f1f5f9;
          border-radius: 8px;
          cursor: pointer;
          transition: background 0.2s;
        }

        .month-header:hover {
          background: #e2e8f0;
        }

        .month-header-left {
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .month-label {
          font-weight: 600;
          color: #1e293b;
        }

        .month-count {
          font-size: 0.875rem;
          color: #64748b;
        }

        .month-reports {
          margin-top: 0.5rem;
          padding-left: 0.5rem;
        }

        .reports-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .report-card {
          background: white;
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 1.5rem;
          cursor: pointer;
          transition: all 0.2s;
        }

        .report-card:hover {
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          border-color: var(--primary-color, #3b82f6);
        }

        .report-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 1rem;
        }

        .report-date {
          font-size: 0.875rem;
          color: #6b7280;
          margin-bottom: 0.25rem;
        }

        .employee-name {
          font-size: 1.125rem;
          font-weight: 600;
          color: #111827;
        }

        .report-badges {
          display: flex;
          gap: 0.5rem;
          flex-wrap: wrap;
        }

        .badge {
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-size: 0.75rem;
          font-weight: 500;
          color: white;
          text-transform: capitalize;
        }

        .osha-badge {
          background-color: #dc2626;
          color: white;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.75rem;
          font-weight: 600;
        }

        .report-summary {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 0.75rem;
          margin-bottom: 1rem;
          padding: 1rem;
          background-color: #f9fafb;
          border-radius: 6px;
        }

        .summary-item {
          font-size: 0.875rem;
          color: #374151;
        }

        .summary-item strong {
          color: #111827;
        }

        .report-description {
          color: #6b7280;
          line-height: 1.6;
          margin-bottom: 1rem;
        }

        .report-footer {
          text-align: right;
          font-size: 0.875rem;
          color: var(--primary-color, #3b82f6);
        }

        .report-details-modal {
          max-width: 900px;
          max-height: 90vh;
          overflow-y: auto;
        }

        .details-section {
          margin-bottom: 2rem;
          padding-bottom: 2rem;
          border-bottom: 1px solid #e5e7eb;
        }

        .details-section:last-child {
          border-bottom: none;
        }

        .details-section h3 {
          margin-top: 0;
          margin-bottom: 1rem;
          font-size: 1.125rem;
          color: #111827;
        }

        .detail-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 1rem;
        }

        .detail-item label {
          display: block;
          font-size: 0.875rem;
          font-weight: 600;
          color: #6b7280;
          margin-bottom: 0.25rem;
        }

        .detail-item div {
          color: #111827;
        }

        .detail-item.full-width {
          grid-column: 1 / -1;
        }

        .description-box {
          background-color: #f9fafb;
          border: 1px solid #e5e7eb;
          border-radius: 6px;
          padding: 1rem;
          white-space: pre-wrap;
          line-height: 1.6;
        }

        .witness-card {
          background-color: #f9fafb;
          border-radius: 6px;
          padding: 1rem;
          margin-bottom: 0.5rem;
        }

        .witness-header {
          margin-bottom: 0.5rem;
          color: #111827;
        }

        .witness-testimony {
          color: #6b7280;
          font-size: 0.875rem;
          padding-left: 1rem;
          border-left: 3px solid #d1d5db;
        }

        .report-meta {
          text-align: center;
          font-size: 0.875rem;
          color: #6b7280;
          padding-top: 1rem;
          border-top: 1px solid #e5e7eb;
        }

        .empty-state {
          text-align: center;
          padding: 3rem 1rem;
        }

        .empty-state-icon {
          font-size: 3rem;
          margin-bottom: 1rem;
        }

        .empty-state h4 {
          margin: 0 0 0.5rem 0;
          color: #111827;
        }

        .empty-state p {
          margin: 0;
          color: #6b7280;
        }

        .section-header-actions {
          display: flex;
          gap: 0.5rem;
          align-items: center;
        }

        .btn-primary, .btn-secondary {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-secondary {
          background-color: #e5e7eb;
          color: #374151;
        }

        .btn-primary:hover, .btn-secondary:hover {
          opacity: 0.9;
        }

        .loading-container {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 3rem;
        }

        .spinner {
          width: 40px;
          height: 40px;
          border: 4px solid #e5e7eb;
          border-top-color: var(--primary-color, #3b82f6);
          border-radius: 50%;
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .report-header {
            flex-direction: column;
            gap: 0.5rem;
          }

          .report-summary {
            grid-template-columns: 1fr;
          }

          .detail-grid {
            grid-template-columns: 1fr;
          }

          .report-details-modal {
            max-width: 100%;
            height: 100vh;
            max-height: 100vh;
            border-radius: 0;
          }
        }
      `})]})}const $v=[{id:"message",label:"Messages",Icon:Y0,description:"Chat messages from field"},{id:"material_request",label:"Material Requests",Icon:Af,description:"Equipment and material requests"},{id:"injury_report",label:"Safety Reports",Icon:G0,description:"Injury and safety incident reports"},{id:"tm_ticket",label:"T&M Tickets",Icon:hu,description:"Time and materials tickets"}];function OH({project:t,company:e,onShowToast:r,onClose:a}){const[n,s]=ne.useState([]),[l,c]=ne.useState({}),[f,d]=ne.useState([]),[m,v]=ne.useState(!0),[x,g]=ne.useState(!1);ne.useEffect(()=>{b()},[t?.id,e?.id]);const b=async()=>{if(!(!t?.id||!e?.id))try{v(!0);const E=await ot.getCompanyUsers(e.id);s(E);const R=await ot.getProjectNotificationPreferences(t.id),Y={};R.forEach(B=>{Y[B.user_id]={types:B.notification_types||[],presetId:null}}),c(Y);const W=await ot.getNotificationPresets(e.id);d(W)}catch(E){console.error("Error loading notification settings:",E),r?.("Error loading notification settings","error")}finally{v(!1)}},_=(E,R)=>{c(Y=>{const W=Y[E]||{types:[]},B=W.types.includes(R)?W.types.filter(q=>q!==R):[...W.types,R];return{...Y,[E]:{types:B,presetId:null}}})},w=(E,R)=>{const Y=f.find(W=>W.id===R);Y&&c(W=>({...W,[E]:{types:[...Y.notification_types],presetId:R}}))},A=(E,R)=>{c(Y=>({...Y,[E]:{types:R?$v.map(W=>W.id):[],presetId:null}}))},C=async()=>{try{g(!0);const E=Object.entries(l).map(([R,Y])=>({userId:R,notificationTypes:Y.types}));await ot.setProjectNotificationPreferences(t.id,E),r?.("Notification settings saved","success"),a?.()}catch(E){console.error("Error saving notification settings:",E),r?.("Error saving notification settings","error")}finally{g(!1)}};return m?o.jsxs("div",{className:"notification-settings",children:[o.jsxs("div",{className:"notification-settings-header",children:[o.jsx("h3",{children:"Notification Settings"}),o.jsx("button",{className:"close-btn",onClick:a,children:""})]}),o.jsx("div",{className:"loading-message",children:"Loading..."})]}):o.jsxs("div",{className:"notification-settings",children:[o.jsxs("div",{className:"notification-settings-header",children:[o.jsxs("h3",{children:["Notification Settings for ",t?.name]}),o.jsx("button",{className:"close-btn",onClick:a,children:""})]}),o.jsx("p",{className:"settings-description",children:"Choose who receives notifications when field workers send messages, request materials, submit safety reports, or create T&M tickets for this project."}),n.length===0?o.jsxs("div",{className:"no-users-message",children:[o.jsx("p",{children:"No users found in this company."}),o.jsx("small",{children:"Users need to be added to the company to receive notifications."})]}):o.jsx("div",{className:"notification-users-list",children:n.map(E=>{const R=l[E.id]||{types:[],presetId:null},Y=R.types.length===$v.length,W=R.types.length>0&&!Y;return o.jsxs("div",{className:"notification-user-row",children:[o.jsxs("div",{className:"user-info",children:[o.jsx("div",{className:"user-avatar",children:E.name?.charAt(0).toUpperCase()||E.email?.charAt(0).toUpperCase()}),o.jsxs("div",{className:"user-details",children:[o.jsx("span",{className:"user-name",children:E.name||E.email}),E.role&&o.jsx("span",{className:"user-role",children:E.role})]})]}),o.jsxs("div",{className:"notification-controls",children:[o.jsxs("select",{className:"preset-select",value:R.presetId||"",onChange:B=>B.target.value&&w(E.id,B.target.value),children:[o.jsx("option",{value:"",children:"Apply preset..."}),f.map(B=>o.jsx("option",{value:B.id,children:B.name},B.id))]}),o.jsx("button",{className:`toggle-all-btn ${Y?"all-on":W?"some-on":""}`,onClick:()=>A(E.id,!Y),title:Y?"Disable all":"Enable all",children:Y?"All On":W?"Some":"None"})]}),o.jsx("div",{className:"notification-types",children:$v.map(B=>o.jsxs("label",{className:`notification-type-toggle ${R.types.includes(B.id)?"active":""}`,title:B.description,children:[o.jsx("input",{type:"checkbox",checked:R.types.includes(B.id),onChange:()=>_(E.id,B.id)}),o.jsx("span",{className:"type-icon",children:o.jsx(B.Icon,{size:16})}),o.jsx("span",{className:"type-label",children:B.label})]},B.id))})]},E.id)})}),o.jsxs("div",{className:"notification-settings-footer",children:[o.jsx("button",{className:"btn-secondary",onClick:a,children:"Cancel"}),o.jsx("button",{className:"btn-primary",onClick:C,disabled:x,children:x?"Saving...":"Save Settings"})]})]})}function RH({project:t,company:e,onShowToast:r}){const[a,n]=ne.useState([]),[s,l]=ne.useState(!0),[c,f]=ne.useState("all"),[d,m]=ne.useState(null),[v,x]=ne.useState("recent"),[g,b]=ne.useState(new Set),[_,w]=ne.useState({start:"",end:""});ne.useEffect(()=>{A();const M=ot.subscribeToMaterialRequests?.(t.id,()=>{A()});return()=>{M&&ot.unsubscribe?.(M)}},[t.id]);const A=async()=>{try{const M=await ot.getMaterialRequests(t.id);n(M||[])}catch(M){console.error("Error loading material requests:",M),r?.("Error loading material requests","error")}finally{l(!1)}},C=async(M,V)=>{try{await ot.updateMaterialRequest(M,V,"Office"),n(a.map(ie=>ie.id===M?{...ie,status:V}:ie)),r?.(`Request ${V}`,"success")}catch(ie){console.error("Error updating status:",ie),r?.("Error updating status","error")}},E=M=>new Date(M).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),R=M=>new Date(M).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),Y=M=>{switch(M){case"urgent":return"priority-urgent";case"low":return"priority-low";default:return"priority-normal"}},W=M=>{switch(M){case"urgent":return"";case"low":return"";default:return""}},B=ne.useMemo(()=>{let M=c==="all"?[...a]:a.filter(V=>V.status===c);if(_.start){const V=new Date(_.start);V.setHours(0,0,0,0),M=M.filter(ie=>new Date(ie.created_at)>=V)}if(_.end){const V=new Date(_.end);V.setHours(23,59,59,999),M=M.filter(ie=>new Date(ie.created_at)<=V)}if(v==="recent"){const V=new Date;V.setDate(V.getDate()-7),V.setHours(0,0,0,0),M=M.filter(ie=>new Date(ie.created_at)>=V)}return M},[a,c,v,_]),q=ne.useMemo(()=>{if(v!=="all")return null;const M={};return B.forEach(V=>{const ie=new Date(V.created_at),X=`${ie.getFullYear()}-${String(ie.getMonth()+1).padStart(2,"0")}`,Z=ie.toLocaleDateString("en-US",{month:"long",year:"numeric"});M[X]||(M[X]={label:Z,requests:[],itemCount:0}),M[X].requests.push(V),M[X].itemCount+=V.items?.length||0}),Object.entries(M).sort((V,ie)=>ie[0].localeCompare(V[0]))},[B,v]);ne.useEffect(()=>{if(q&&q.length>0){const M=q[0][0];b(new Set([M]))}},[q]);const L=M=>{const V=new Set(g);V.has(M)?V.delete(M):V.add(M),b(V)},J={all:a.length,pending:a.filter(M=>M.status==="pending").length,ordered:a.filter(M=>M.status==="ordered").length,delivered:a.filter(M=>M.status==="delivered").length,cancelled:a.filter(M=>M.status==="cancelled").length},D=c==="all"?a.length:a.filter(M=>M.status===c).length;if(s)return o.jsx("div",{className:"loading",children:"Loading material requests..."});const T=M=>o.jsxs("div",{className:`material-request-card ${M.status} ${M.priority==="urgent"?"urgent":""}`,children:[o.jsxs("div",{className:"material-request-header-row",onClick:()=>m(d===M.id?null:M.id),children:[o.jsxs("div",{className:"material-request-info",children:[o.jsxs("span",{className:`material-priority-badge ${Y(M.priority)}`,children:[W(M.priority)," ",M.priority]}),o.jsx("span",{className:"material-request-date",children:E(M.created_at)}),o.jsx("span",{className:"material-request-time",children:R(M.created_at)})]}),o.jsxs("div",{className:"material-request-summary",children:[o.jsxs("span",{className:"material-items-count",children:[M.items?.length||0," item",(M.items?.length||0)!==1?"s":""]}),o.jsx("span",{className:`material-status ${M.status}`,children:M.status}),o.jsx("span",{className:"material-expand-arrow",children:d===M.id?"":""})]})]}),d===M.id&&o.jsxs("div",{className:"material-request-details",children:[o.jsxs("div",{className:"material-detail-section",children:[o.jsxs("div",{className:"material-requester",children:[o.jsx("span",{className:"requester-label",children:"Requested by:"}),o.jsx("span",{className:"requester-name",children:M.requested_by||"Field"})]}),M.needed_by&&o.jsxs("div",{className:"material-needed-by",children:[o.jsx("span",{className:"needed-label",children:"Needed by:"}),o.jsx("span",{className:"needed-date",children:E(M.needed_by)})]})]}),M.items?.length>0&&o.jsxs("div",{className:"material-detail-section",children:[o.jsx("h4",{children:"Items Requested"}),o.jsx("div",{className:"material-items-list",children:M.items.map((V,ie)=>o.jsxs("div",{className:"material-item-row",children:[o.jsx("span",{className:"item-name",children:V.name}),o.jsxs("span",{className:"item-quantity",children:[V.quantity," ",V.unit]})]},ie))})]}),M.notes&&o.jsxs("div",{className:"material-detail-section",children:[o.jsx("h4",{children:"Notes"}),o.jsx("p",{className:"material-notes",children:M.notes})]}),o.jsxs("div",{className:"material-request-actions",children:[M.status==="pending"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"btn btn-success btn-small",onClick:V=>{V.stopPropagation(),C(M.id,"ordered")},children:"Mark Ordered"}),o.jsx("button",{className:"btn btn-danger btn-small",onClick:V=>{V.stopPropagation(),C(M.id,"cancelled")},children:"Cancel"})]}),M.status==="ordered"&&o.jsx("button",{className:"btn btn-success btn-small",onClick:V=>{V.stopPropagation(),C(M.id,"delivered")},children:"Mark Delivered"}),M.status==="cancelled"&&o.jsx("button",{className:"btn btn-secondary btn-small",onClick:V=>{V.stopPropagation(),C(M.id,"pending")},children:"Restore"})]})]})]},M.id);return o.jsxs("div",{className:"material-requests-list card",children:[o.jsxs("div",{className:"material-requests-header",children:[o.jsxs("div",{className:"material-requests-title",children:[o.jsx("h3",{children:"Material Requests"}),J.pending>0&&o.jsxs("span",{className:"pending-badge",children:[J.pending," pending"]})]}),o.jsx("div",{className:"material-filter-tabs",children:["all","pending","ordered","delivered","cancelled"].map(M=>o.jsxs("button",{className:`material-filter-tab ${c===M?"active":""}`,onClick:()=>f(M),children:[M.charAt(0).toUpperCase()+M.slice(1),o.jsx("span",{className:"material-filter-count",children:J[M]})]},M))}),o.jsxs("div",{className:"view-mode-bar",children:[o.jsxs("div",{className:"view-mode-tabs",children:[o.jsx("button",{className:`view-mode-tab ${v==="recent"?"active":""}`,onClick:()=>{x("recent"),w({start:"",end:""})},children:"Recent (7 days)"}),o.jsxs("button",{className:`view-mode-tab ${v==="all"?"active":""}`,onClick:()=>x("all"),children:["All (",D,")"]})]}),v==="all"&&o.jsxs("div",{className:"date-filter",children:[o.jsx(V0,{size:16}),o.jsx("input",{type:"date",value:_.start,onChange:M=>w(V=>({...V,start:M.target.value})),placeholder:"Start date"}),o.jsx("span",{children:"to"}),o.jsx("input",{type:"date",value:_.end,onChange:M=>w(V=>({...V,end:M.target.value})),placeholder:"End date"}),(_.start||_.end)&&o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>w({start:"",end:""}),children:"Clear"})]})]})]}),B.length===0?o.jsxs("div",{className:"material-empty-state",children:[o.jsx("span",{className:"empty-icon",children:o.jsx(Af,{size:32})}),o.jsxs("p",{children:["No ",c==="all"?"":c," material requests",v==="recent"?" in the last 7 days":""]}),v==="recent"&&D>0&&o.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>x("all"),children:"View All Requests"})]}):o.jsx("div",{className:"material-requests",children:v==="all"&&q?q.map(([M,V])=>o.jsxs("div",{className:"month-group",children:[o.jsxs("div",{className:"month-header",onClick:()=>L(M),children:[o.jsxs("div",{className:"month-header-left",children:[g.has(M)?o.jsx(jf,{size:18}):o.jsx(Ef,{size:18}),o.jsx("span",{className:"month-label",children:V.label}),o.jsxs("span",{className:"month-count",children:[V.requests.length," requests"]})]}),o.jsx("div",{className:"month-header-right",children:o.jsxs("span",{className:"month-stat",children:[V.itemCount," items"]})})]}),g.has(M)&&o.jsx("div",{className:"month-requests",children:V.requests.map(ie=>T(ie))})]},M)):B.map(M=>T(M))})]})}const IS=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},DH=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});function FH({project:t,company:e,onShowToast:r}){const{branding:a}=uh(),[n,s]=ne.useState([]),[l,c]=ne.useState(!0),[f,d]=ne.useState(null),[m,v]=ne.useState(new Set),[x,g]=ne.useState(!1),[b,_]=ne.useState("recent"),[w,A]=ne.useState(new Set),[C,E]=ne.useState({start:"",end:""});ne.useEffect(()=>{R();const de=ot.subscribeToDailyReports?.(t.id,()=>{R()});return()=>{de&&ot.unsubscribe?.(de)}},[t.id]);const R=async()=>{try{const de=await ot.getDailyReports(t.id,365);s(de||[])}catch(de){console.error("Error loading daily reports:",de),r?.("Error loading daily reports","error")}finally{c(!1)}},Y=ne.useMemo(()=>{let de=[...n];if(C.start){const U=new Date(C.start);U.setHours(0,0,0,0),de=de.filter(k=>new Date(k.report_date||k.created_at)>=U)}if(C.end){const U=new Date(C.end);U.setHours(23,59,59,999),de=de.filter(k=>new Date(k.report_date||k.created_at)<=U)}if(b==="recent"){const U=new Date;U.setDate(U.getDate()-7),U.setHours(0,0,0,0),de=de.filter(k=>new Date(k.report_date||k.created_at)>=U)}return de},[n,b,C]),W=ne.useMemo(()=>{if(b!=="all")return null;const de={};return Y.forEach(U=>{const k=new Date(U.report_date||U.created_at),F=`${k.getFullYear()}-${String(k.getMonth()+1).padStart(2,"0")}`,I=k.toLocaleDateString("en-US",{month:"long",year:"numeric"});de[F]||(de[F]={label:I,reports:[]}),de[F].reports.push(U)}),Object.entries(de).sort((U,k)=>k[0].localeCompare(U[0]))},[Y,b]);ne.useEffect(()=>{if(W&&W.length>0){const de=W[0][0];A(new Set([de]))}},[W]);const B=()=>{g(!x),x&&v(new Set)},q=de=>{const U=new Set(m);U.has(de)?U.delete(de):U.add(de),v(U)},L=()=>{m.size===Y.length?v(new Set):v(new Set(Y.map(de=>de.id)))},J=de=>{const U=new Set(w);U.has(de)?U.delete(de):U.add(de),A(U)},D=()=>m.size>0?Y.filter(de=>m.has(de.id)):Y,T=de=>new Date(de).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}),M=de=>new Date(de).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),V=de=>{switch(de){case"submitted":return"";case"reviewed":return"";case"draft":return"";default:return""}},ie=de=>{switch(de){case"submitted":return"Submitted";case"reviewed":return"Reviewed";case"draft":return"Draft";default:return de}},X=async()=>{const de=D();if(de.length===0){r?.("No reports to export","error");return}r?.("Generating PDF...","info");const U=new ir,k=U.internal.pageSize.getWidth(),F=20;let I=F;const z=IS(a?.primary_color||"#3B82F6"),te=IS(a?.secondary_color||"#1E40AF");U.setFillColor(...z),U.rect(0,0,k,45,"F"),U.setFillColor(...te),U.rect(0,42,k,3,"F");let se=F;if(a?.logo_url)try{const _e=await DH(a.logo_url);_e&&(U.addImage(_e,"PNG",F,7,30,30),se=F+40)}catch(_e){console.error("Error adding logo:",_e)}U.setTextColor(255,255,255),U.setFontSize(22),U.setFont("helvetica","bold"),U.text(e?.name||"Company Name",se,20),U.setFontSize(10),U.setFont("helvetica","normal"),U.text("DAILY REPORTS SUMMARY",se,30),U.setFontSize(9),U.text(`Generated: ${new Date().toLocaleDateString()}`,k-F,20,{align:"right"}),t.job_number&&U.text(`Job #: ${t.job_number}`,k-F,28,{align:"right"}),I=55,U.setFillColor(248,250,252),U.rect(F,I-5,k-F*2,20,"F"),U.setTextColor(...z),U.setFontSize(14),U.setFont("helvetica","bold"),U.text(`Project: ${t.name}`,F+5,I+7),U.setFontSize(10),U.setTextColor(100,100,100),U.text(`${de.length} Report${de.length!==1?"s":""}`,k-F-5,I+7,{align:"right"}),I+=25,de.forEach((_e,Pe)=>{I>250&&(U.addPage(),I=F),U.setFillColor(...z),U.setTextColor(255,255,255),U.rect(F,I,k-F*2,10,"F"),U.setFontSize(11),U.setFont("helvetica","bold"),U.text(T(_e.report_date||_e.created_at),F+5,I+7),U.text(ie(_e.status),k-F-5,I+7,{align:"right"}),I+=15,U.setTextColor(50,50,50),U.setFontSize(10),U.setFont("helvetica","normal");const fe=`Crew: ${_e.crew_count||0}  |  Tasks: ${_e.tasks_completed||0}  |  T&M: ${_e.tm_tickets_count||0}  |  Photos: ${_e.photos_count||0}`;if(U.text(fe,F+5,I),I+=8,_e.crew_list?.length>0){U.setFont("helvetica","bold"),U.text("Crew:",F+5,I),U.setFont("helvetica","normal");const st=_e.crew_list.map(he=>`${he.name} (${he.role})`).join(", "),mt=U.splitTextToSize(st,k-F*2-30);U.text(mt,F+25,I),I+=mt.length*5+3}if(_e.field_notes){U.setFont("helvetica","bold"),U.text("Notes:",F+5,I),U.setFont("helvetica","normal");const st=U.splitTextToSize(_e.field_notes,k-F*2-30);U.text(st,F+25,I),I+=st.length*5+3}if(_e.issues){U.setTextColor(180,50,50),U.setFont("helvetica","bold"),U.text("Issues:",F+5,I),U.setFont("helvetica","normal");const st=U.splitTextToSize(_e.issues,k-F*2-30);U.text(st,F+25,I),U.setTextColor(50,50,50),I+=st.length*5+3}I+=10});const pe=U.internal.getNumberOfPages();for(let _e=1;_e<=pe;_e++)U.setPage(_e),U.setFontSize(8),U.setTextColor(150,150,150),U.text(`Page ${_e} of ${pe}`,k/2,U.internal.pageSize.getHeight()-10,{align:"center"});const ve=`${t.name}_Daily_Reports_${new Date().toISOString().split("T")[0]}.pdf`;U.save(ve),r?.("PDF exported!","success")},Z=de=>o.jsxs("div",{className:`daily-report-card ${de.status} ${m.has(de.id)?"selected":""}`,children:[o.jsxs("div",{className:"daily-report-header-row",onClick:()=>d(f===de.id?null:de.id),children:[x&&o.jsx("input",{type:"checkbox",className:"report-checkbox",checked:m.has(de.id),onChange:U=>{U.stopPropagation(),q(de.id)},onClick:U=>U.stopPropagation()}),o.jsxs("div",{className:"daily-report-info",children:[o.jsx("span",{className:"report-date",children:T(de.report_date||de.created_at)}),o.jsxs("span",{className:`report-status ${de.status}`,children:[V(de.status)," ",ie(de.status)]})]}),o.jsxs("div",{className:"daily-report-summary",children:[o.jsxs("span",{className:"report-crew",children:[de.crew_count||0," crew"]}),o.jsxs("span",{className:"report-tasks",children:[de.tasks_completed||0," tasks"]}),o.jsx("span",{className:"report-expand",children:f===de.id?"":""})]})]}),f===de.id&&o.jsxs("div",{className:"daily-report-details",children:[o.jsxs("div",{className:"report-stats-grid",children:[o.jsxs("div",{className:"report-stat",children:[o.jsx("span",{className:"stat-value",children:de.crew_count||0}),o.jsx("span",{className:"stat-label",children:"Crew on Site"})]}),o.jsxs("div",{className:"report-stat",children:[o.jsx("span",{className:"stat-value",children:de.tasks_completed||0}),o.jsx("span",{className:"stat-label",children:"Tasks Done"})]}),o.jsxs("div",{className:"report-stat",children:[o.jsx("span",{className:"stat-value",children:de.tm_tickets_count||0}),o.jsx("span",{className:"stat-label",children:"T&M Tickets"})]}),o.jsxs("div",{className:"report-stat",children:[o.jsx("span",{className:"stat-value",children:de.photos_count||0}),o.jsx("span",{className:"stat-label",children:"Photos"})]})]}),de.crew_list?.length>0&&o.jsxs("div",{className:"report-section",children:[o.jsx("h4",{children:"Crew"}),o.jsx("div",{className:"report-crew-list",children:de.crew_list.map((U,k)=>o.jsxs("div",{className:"crew-member",children:[o.jsx("span",{className:"crew-name",children:U.name}),o.jsx("span",{className:"crew-role",children:U.role})]},k))})]}),de.completed_tasks?.length>0&&o.jsxs("div",{className:"report-section",children:[o.jsx("h4",{children:"Completed Today"}),o.jsx("ul",{className:"report-tasks-list",children:de.completed_tasks.map((U,k)=>o.jsxs("li",{children:[U.name,U.group&&o.jsx("span",{className:"task-group",children:U.group})]},k))})]}),de.field_notes&&o.jsxs("div",{className:"report-section",children:[o.jsx("h4",{children:"Field Notes"}),o.jsx("p",{className:"report-notes",children:de.field_notes})]}),de.issues&&o.jsxs("div",{className:"report-section issues",children:[o.jsx("h4",{children:"Issues / Concerns"}),o.jsx("p",{className:"report-issues",children:de.issues})]}),de.submitted_at&&o.jsx("div",{className:"report-meta",children:o.jsxs("span",{children:["Submitted by ",de.submitted_by||"Field"," at ",M(de.submitted_at)]})})]})]},de.id);if(l)return o.jsx("div",{className:"loading",children:"Loading daily reports..."});const K=n.length,re=Y.length;return o.jsxs("div",{className:"daily-reports-list card",children:[o.jsxs("div",{className:"daily-reports-header",children:[o.jsx("h3",{children:"Daily Reports"}),o.jsx("div",{className:"daily-reports-actions",children:n.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:`btn btn-small ${x?"btn-primary":"btn-secondary"}`,onClick:B,children:x?"Cancel":"Select"}),o.jsxs("button",{className:"btn btn-secondary btn-small",onClick:X,children:["PDF",m.size>0?` (${m.size})`:""]})]})})]}),n.length>0&&o.jsxs("div",{className:"view-mode-bar",children:[o.jsxs("div",{className:"view-mode-tabs",children:[o.jsx("button",{className:`view-mode-tab ${b==="recent"?"active":""}`,onClick:()=>_("recent"),children:"Recent (7 days)"}),o.jsxs("button",{className:`view-mode-tab ${b==="all"?"active":""}`,onClick:()=>_("all"),children:["All (",K,")"]})]}),b==="all"&&o.jsxs("div",{className:"date-filter",children:[o.jsx(V0,{size:14,className:"date-filter-icon"}),o.jsx("input",{type:"date",value:C.start,onChange:de=>E(U=>({...U,start:de.target.value})),className:"date-input"}),o.jsx("span",{className:"date-separator",children:"to"}),o.jsx("input",{type:"date",value:C.end,onChange:de=>E(U=>({...U,end:de.target.value})),className:"date-input"}),(C.start||C.end)&&o.jsx("button",{className:"date-clear",onClick:()=>E({start:"",end:""}),children:"Clear"})]})]}),x&&Y.length>0&&o.jsxs("div",{className:"select-all-bar",children:[o.jsxs("label",{className:"select-all-label",children:[o.jsx("input",{type:"checkbox",checked:m.size===Y.length&&Y.length>0,onChange:L}),"Select All (",Y.length,")"]}),m.size>0&&o.jsxs("span",{className:"selected-count",children:[m.size," selected"]})]}),n.length===0?o.jsxs("div",{className:"reports-empty-state",children:[o.jsx("span",{className:"empty-icon",children:o.jsx(hu,{size:32})}),o.jsx("p",{children:"No daily reports yet"}),o.jsx("small",{children:"Reports from the field will appear here"})]}):Y.length===0?o.jsxs("div",{className:"reports-empty-state",children:[o.jsx("span",{className:"empty-icon",children:o.jsx(hu,{size:32})}),o.jsx("p",{children:"No reports in this time period"}),o.jsx("small",{children:b==="recent"?"No reports in the last 7 days":"Try adjusting your date filter"})]}):b==="recent"?o.jsxs("div",{className:"daily-reports",children:[Y.map(de=>Z(de)),K>re&&o.jsx("div",{className:"view-all-prompt",children:o.jsxs("button",{className:"btn btn-secondary",onClick:()=>_("all"),children:["View All ",K," Reports"]})})]}):o.jsx("div",{className:"daily-reports grouped",children:W?.map(([de,{label:U,reports:k}])=>o.jsxs("div",{className:"month-group",children:[o.jsxs("div",{className:"month-header",onClick:()=>J(de),children:[w.has(de)?o.jsx(jf,{size:18,className:"month-chevron"}):o.jsx(Ef,{size:18,className:"month-chevron"}),o.jsx("span",{className:"month-label",children:U}),o.jsxs("span",{className:"month-count",children:[k.length," report",k.length!==1?"s":""]})]}),w.has(de)&&o.jsx("div",{className:"month-reports",children:k.map(F=>Z(F))})]},de))})]})}function LH({project:t,company:e,userName:r,onShowToast:a}){const[n,s]=ne.useState([]),[l,c]=ne.useState(!0),[f,d]=ne.useState(!1),[m,v]=ne.useState(""),[x,g]=ne.useState(0),[b,_]=ne.useState(!1),w=ne.useRef(null);ne.useEffect(()=>{A();const W=ot.subscribeToMessages?.(t.id,B=>{B.new&&(s(q=>[...q,B.new]),B.new.sender_type==="field"&&g(q=>q+1))});return()=>{W&&ot.unsubscribe?.(W)}},[t.id]),ne.useEffect(()=>{b&&(w.current?.scrollIntoView({behavior:"smooth"}),ot.markMessagesRead?.(t.id,"office"),g(0))},[n,b]);const A=async()=>{try{const B=(await ot.getMessages(t.id,50)||[]).sort((L,J)=>new Date(L.created_at)-new Date(J.created_at));s(B);const q=B.filter(L=>L.sender_type==="field"&&!L.is_read).length;g(q)}catch(W){console.error("Error loading messages:",W)}finally{c(!1)}},C=async()=>{if(m.trim()){d(!0);try{const W=await ot.sendMessage(t.id,m.trim(),"office",r||"Office");s(B=>[...B,W]),v("")}catch(W){console.error("Error sending message:",W),a?.("Error sending message","error")}finally{d(!1)}}},E=W=>{W.key==="Enter"&&!W.shiftKey&&(W.preventDefault(),C())},R=W=>{const B=new Date(W),q=new Date;return B.toDateString()===q.toDateString()?B.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):B.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})},Y=n.slice(-3);return l?o.jsxs("div",{className:"project-messages card",children:[o.jsx("div",{className:"project-messages-header",children:o.jsx("h3",{children:"Messages"})}),o.jsx("div",{className:"loading",children:"Loading messages..."})]}):o.jsxs("div",{className:`project-messages card ${b?"expanded":""}`,children:[o.jsxs("div",{className:"project-messages-header",onClick:()=>_(!b),children:[o.jsxs("div",{className:"messages-title-row",children:[o.jsx("h3",{children:"Messages"}),x>0&&o.jsxs("span",{className:"messages-unread-badge",children:[x," new"]})]}),o.jsx("button",{className:"messages-toggle-btn",children:b?" Collapse":" Expand"})]}),!b&&n.length>0&&o.jsxs("div",{className:"messages-preview",children:[Y.map(W=>o.jsxs("div",{className:`preview-message ${W.sender_type}`,children:[o.jsxs("span",{className:"preview-sender",children:[W.sender_type==="office"?o.jsx(E0,{size:12,className:"inline-icon"}):o.jsx(Ui,{size:12,className:"inline-icon"})," ",W.sender_name,":"]}),o.jsxs("span",{className:"preview-text",children:[W.message?.slice(0,50),W.message?.length>50?"...":""]})]},W.id)),n.length===0&&o.jsx("p",{className:"no-messages-hint",children:"No messages yet. Click to start chatting."})]}),b&&o.jsxs("div",{className:"messages-full",children:[o.jsxs("div",{className:"messages-list-container",children:[n.length===0?o.jsxs("div",{className:"messages-empty",children:[o.jsx("span",{className:"empty-icon",children:o.jsx(Y0,{size:32})}),o.jsx("p",{children:"No messages yet"}),o.jsx("small",{children:"Send a message to the field crew"})]}):n.map(W=>o.jsxs("div",{className:`message-bubble ${W.sender_type==="office"?"sent":"received"}`,children:[o.jsxs("div",{className:"message-sender",children:[W.sender_type==="office"?o.jsx(E0,{size:14,className:"inline-icon"}):o.jsx(Ui,{size:14,className:"inline-icon"})," ",W.sender_name]}),o.jsx("div",{className:"message-text",children:W.message}),W.photo_url&&o.jsx("img",{src:W.photo_url,alt:"Attached",className:"message-photo"}),o.jsx("div",{className:"message-time",children:R(W.created_at)})]},W.id)),o.jsx("div",{ref:w})]}),o.jsxs("div",{className:"messages-input-row",children:[o.jsx("textarea",{value:m,onChange:W=>v(W.target.value),onKeyDown:E,placeholder:"Type a message...",rows:1,disabled:f}),o.jsx("button",{className:"btn btn-primary send-btn",onClick:C,disabled:f||!m.trim(),children:f?"...":"Send"})]})]})]})}function PH({project:t,company:e,onShowToast:r}){const[a,n]=ne.useState(null),[s,l]=ne.useState(!0),[c,f]=ne.useState(!1);ne.useEffect(()=>{if(t?.id&&e?.id){d();const b=ot.subscribeToCrewCheckins?.(t.id,()=>{d()});return()=>{b&&ot.unsubscribe?.(b)}}},[t?.id,e?.id]);const d=async()=>{try{const b=await ot.calculateManDayCosts(t.id,e.id,t.work_type||"demolition",t.job_type||"standard");n(b)}catch(b){console.error("Error loading man day costs:",b)}finally{l(!1)}},m=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),v=b=>new Date(b).toLocaleDateString("en-US",{month:"short",day:"numeric"}),x=b=>({foreman:"Foreman",supervisor:"Supervisor",operator:"Operator",laborer:"Laborer"})[b]||b.charAt(0).toUpperCase()+b.slice(1);if(s)return o.jsxs("div",{className:"man-day-costs card",children:[o.jsx("div",{className:"man-day-header",children:o.jsx("h3",{children:"Man Day Costs"})}),o.jsx("div",{className:"loading",children:"Loading..."})]});if(!a||a.totalManDays===0)return o.jsxs("div",{className:"man-day-costs card",children:[o.jsx("div",{className:"man-day-header",children:o.jsx("h3",{children:"Man Day Costs"})}),o.jsxs("div",{className:"man-day-empty",children:[o.jsx("span",{className:"empty-icon",children:o.jsx(Ui,{size:32})}),o.jsx("p",{children:"No crew check-ins yet"}),o.jsx("small",{children:"Costs will appear as crew checks in from the field"})]})]});const g=Object.entries(a.byRole||{});return o.jsxs("div",{className:"man-day-costs card",children:[o.jsxs("div",{className:"man-day-header",onClick:()=>f(!c),children:[o.jsxs("div",{className:"man-day-title-row",children:[o.jsx("h3",{children:"Man Day Costs"}),o.jsx("span",{className:"man-day-total",children:m(a.totalCost)})]}),o.jsx("button",{className:"man-day-toggle",children:c?" Collapse":" Details"})]}),o.jsxs("div",{className:"man-day-summary",children:[o.jsxs("div",{className:"man-day-stat",children:[o.jsx("span",{className:"stat-value",children:a.daysWorked}),o.jsx("span",{className:"stat-label",children:"Days Worked"})]}),o.jsxs("div",{className:"man-day-stat",children:[o.jsx("span",{className:"stat-value",children:a.totalManDays}),o.jsx("span",{className:"stat-label",children:"Total Man Days"})]}),o.jsxs("div",{className:"man-day-stat",children:[o.jsx("span",{className:"stat-value",children:m(a.totalCost)}),o.jsx("span",{className:"stat-label",children:"Total Labor Cost"})]}),o.jsxs("div",{className:"man-day-stat",children:[o.jsx("span",{className:"stat-value",children:a.daysWorked>0?m(a.totalCost/a.daysWorked):"$0"}),o.jsx("span",{className:"stat-label",children:"Avg Cost/Day"})]})]}),c&&o.jsxs("div",{className:"man-day-details",children:[g.length>0&&o.jsxs("div",{className:"man-day-section",children:[o.jsx("h4",{children:"By Role"}),o.jsx("div",{className:"man-day-role-list",children:g.map(([b,_])=>o.jsxs("div",{className:"man-day-role-row",children:[o.jsxs("div",{className:"role-info",children:[o.jsx("span",{className:"role-name",children:x(b)}),o.jsxs("span",{className:"role-rate",children:[m(_.rate),"/day"]})]}),o.jsxs("div",{className:"role-stats",children:[o.jsxs("span",{className:"role-count",children:[_.count," days"]}),o.jsx("span",{className:"role-cost",children:m(_.cost)})]})]},b))})]}),a.byDate?.length>0&&o.jsxs("div",{className:"man-day-section",children:[o.jsx("h4",{children:"Recent Activity"}),o.jsx("div",{className:"man-day-date-list",children:a.byDate.slice(0,7).map((b,_)=>o.jsxs("div",{className:"man-day-date-row",children:[o.jsx("span",{className:"date-label",children:v(b.date)}),o.jsxs("span",{className:"date-workers",children:[b.workers," crew"]}),o.jsx("span",{className:"date-cost",children:m(b.cost)})]},_))}),a.byDate.length>7&&o.jsxs("p",{className:"man-day-more",children:["+ ",a.byDate.length-7," more days"]})]})]})]})}const Ii=t=>((t||0)/100).toFixed(2),Yt=t=>{const e=(t||0)/100;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)},oc=t=>Math.round((parseFloat(t)||0)*100),su=t=>((t||0)/100).toFixed(2),wn=t=>`${su(t)}%`,Qu=t=>Math.round((parseFloat(t)||0)*100),MH=(t,e,r,a)=>{const n=parseFloat(t)||0,s=parseFloat(e)||0,l=parseInt(r)||0,c=parseInt(a)||0,f=Math.round(n*l),d=Math.round(s*c),m=f+d;return{regularTotal:f,overtimeTotal:d,total:m}},BS=(t,e)=>{const r=parseFloat(t)||0,a=parseInt(e)||0;return Math.round(r*a)},Ap=(t,e)=>{const r=parseInt(t)||0,a=parseInt(e)||0;return Math.round(r*a/1e4)},Wv=(t,e)=>{const r=parseInt(t)||0,a=parseInt(e)||0;return Math.round(r*a/1e4)},E1=t=>{const e=(t.change_order_labor||[]).reduce((_,w)=>_+(parseInt(w.total)||0),0),r=(t.change_order_materials||[]).reduce((_,w)=>_+(parseInt(w.total)||0),0),a=(t.change_order_equipment||[]).reduce((_,w)=>_+(parseInt(w.total)||0),0),n=(t.change_order_subcontractors||[]).reduce((_,w)=>_+(parseInt(w.total)||0),0),s=Ap(e,t.labor_markup_percent||1500),l=Ap(r,t.materials_markup_percent||1500),c=Ap(a,t.equipment_markup_percent||1500),f=Ap(n,t.subcontractors_markup_percent||500),d=e+r+a+n+s+l+c+f,m=Wv(d,t.liability_insurance_percent||144),v=Wv(d,t.bond_percent||100),x=Wv(d,t.license_fee_percent||10),g=m+v+x,b=d+g;return{labor_subtotal:e,materials_subtotal:r,equipment_subtotal:a,subcontractors_subtotal:n,labor_markup_amount:s,materials_markup_amount:l,equipment_markup_amount:c,subcontractors_markup_amount:f,liability_insurance_amount:m,bond_amount:v,license_fee_amount:x,additional_fees_total:g,cor_subtotal:d,cor_total:b}},Vv=t=>{const e=[];if(t.title?.trim()||e.push("Title is required"),t.scope_of_work?.trim()||e.push("Scope of work is required"),t.period_start||e.push("Start date is required"),t.period_end||e.push("End date is required"),t.period_start&&t.period_end){const f=new Date(t.period_start);new Date(t.period_end)<f&&e.push("End date must be after start date")}const r=(t.change_order_labor||[]).length>0,a=(t.change_order_materials||[]).length>0,n=(t.change_order_equipment||[]).length>0,s=(t.change_order_subcontractors||[]).length>0;!r&&!a&&!n&&!s&&e.push("At least one line item (labor, materials, equipment, or subcontractor) is required"),E1(t).cor_total<=0&&e.push("COR total must be greater than zero");const c=5e3;return t.labor_markup_percent>c&&e.push("Labor markup percentage seems too high (>50%)"),t.materials_markup_percent>c&&e.push("Materials markup percentage seems too high (>50%)"),t.equipment_markup_percent>c&&e.push("Equipment markup percentage seems too high (>50%)"),t.subcontractors_markup_percent>c&&e.push("Subcontractors markup percentage seems too high (>50%)"),{valid:e.length===0,errors:e}},xj=t=>{const e={draft:{label:"Draft",color:"#6b7280",bgColor:"#f3f4f6"},pending_approval:{label:"Pending Approval",color:"#d97706",bgColor:"#fef3c7"},approved:{label:"Approved",color:"#059669",bgColor:"#d1fae5"},rejected:{label:"Rejected",color:"#dc2626",bgColor:"#fee2e2"},billed:{label:"Billed",color:"#2563eb",bgColor:"#dbeafe"},closed:{label:"Closed",color:"#4b5563",bgColor:"#e5e7eb"}};return e[t]||e.draft},uc=t=>t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",Y2=(t,e)=>{const r=uc(t),a=uc(e);return r&&a?`${r} - ${a}`:r||a||""},ef={labor_markup:1500,materials_markup:1500,equipment_markup:1500,subcontractors_markup:500,liability_insurance:144,bond:100,license_fee:10},US=["Foreman","Superintendent","Operator","Laborer"],IH=[{value:"standard",label:"Standard"},{value:"pla",label:"PLA (Project Labor Agreement)"},{value:"prevailing",label:"Prevailing Wage"}],Gv={materials:[{value:"backup_sheet",label:"Backup Sheet"},{value:"invoice",label:"Invoice"},{value:"mobilization",label:"Mobilization"},{value:"custom",label:"Custom Entry"}],equipment:[{value:"backup_sheet",label:"Backup Sheet"},{value:"invoice",label:"Invoice"},{value:"custom",label:"Custom Entry"}],subcontractors:[{value:"invoice",label:"Invoice"},{value:"quote",label:"Quote"},{value:"custom",label:"Custom Entry"}]},qS=["each","day","week","month","hour","sqft","lf","gallon","pound","ton","cy","lump sum"];function BH({project:t,company:e,areas:r,refreshKey:a,onShowToast:n,onCreateCOR:s,onViewCOR:l,onEditCOR:c}){const[f,d]=ne.useState([]),[m,v]=ne.useState(!0),[x,g]=ne.useState("all"),[b,_]=ne.useState("all"),[w,A]=ne.useState(null),[C,E]=ne.useState(new Set),[R,Y]=ne.useState("recent"),[W,B]=ne.useState(new Set),[q,L]=ne.useState({start:"",end:""}),[J,D]=ne.useState(null);ne.useEffect(()=>{T(),M();const k=ot.subscribeToCORs?.(t.id,()=>{T(),M()});return()=>{k&&ot.unsubscribe?.(k)}},[t.id,a]);const T=async()=>{try{const k=await ot.getCORs(t.id);d(k||[])}catch(k){console.error("Error loading CORs:",k),n?.("Error loading change order requests","error")}finally{v(!1)}},M=async()=>{try{const k=await ot.getCORStats?.(t.id);D(k)}catch(k){console.error("Error loading COR stats:",k)}},V=async(k,F)=>{if(F?.stopPropagation(),!!confirm("Are you sure you want to delete this COR? This action cannot be undone."))try{await ot.deleteCOR(k),d(f.filter(I=>I.id!==k)),n?.("COR deleted","success"),M()}catch(I){console.error("Error deleting COR:",I),n?.("Error deleting COR","error")}},ie=async(k,F)=>{F?.stopPropagation();try{await ot.submitCORForApproval(k),await T(),n?.("COR submitted for approval","success"),M()}catch(I){console.error("Error submitting COR:",I?.message||I),n?.(I?.message||"Error submitting COR","error")}},X=ne.useMemo(()=>{let k=[...f];if(x!=="all"&&(k=k.filter(F=>F.status===x)),b!=="all"&&(k=k.filter(F=>F.area_id===b)),q.start){const F=new Date(q.start);F.setHours(0,0,0,0),k=k.filter(I=>new Date(I.created_at)>=F)}if(q.end){const F=new Date(q.end);F.setHours(23,59,59,999),k=k.filter(I=>new Date(I.created_at)<=F)}if(R==="recent"){const F=new Date;F.setDate(F.getDate()-7),F.setHours(0,0,0,0),k=k.filter(I=>new Date(I.created_at)>=F)}return k.sort((F,I)=>new Date(I.created_at)-new Date(F.created_at)),k},[f,x,b,R,q]),Z=ne.useMemo(()=>{if(R!=="all")return null;const k={};return X.forEach(F=>{const I=new Date(F.created_at),z=`${I.getFullYear()}-${String(I.getMonth()+1).padStart(2,"0")}`,te=I.toLocaleDateString("en-US",{month:"long",year:"numeric"});k[z]||(k[z]={label:te,cors:[],totalAmount:0}),k[z].cors.push(F),k[z].totalAmount+=F.cor_total||0}),Object.entries(k).sort((F,I)=>I[0].localeCompare(F[0]))},[X,R]);ne.useEffect(()=>{if(Z&&Z.length>0){const k=Z[0][0];B(new Set([k]))}},[Z]);const K=k=>{const F=new Set(W);F.has(k)?F.delete(k):F.add(k),B(F)},re=ne.useMemo(()=>({all:f.length,draft:f.filter(k=>k.status==="draft").length,pending_approval:f.filter(k=>k.status==="pending_approval").length,approved:f.filter(k=>k.status==="approved").length,rejected:f.filter(k=>k.status==="rejected").length,billed:f.filter(k=>k.status==="billed").length,closed:f.filter(k=>k.status==="closed").length}),[f]);x==="all"?f.length:f.filter(k=>k.status===x).length;const de=k=>r?.find(I=>I.id===k)?.name||"No Area",U=k=>{const F=xj(k.status);k.id;const I=k.status==="draft",z=k.status==="draft",te=k.status==="draft";return o.jsxs("div",{className:`cor-card ${k.status}`,onClick:()=>l?.(k),onKeyDown:se=>{(se.key==="Enter"||se.key===" ")&&(se.preventDefault(),l?.(k))},tabIndex:0,role:"button","aria-label":`View COR ${k.cor_number}: ${k.title||"Untitled"}, ${F.label}, ${Yt(k.cor_total||0)}`,children:[o.jsxs("div",{className:"cor-card-header",children:[o.jsxs("div",{className:"cor-card-left",children:[o.jsx("span",{className:"cor-number",children:k.cor_number}),o.jsx("span",{className:"cor-status-badge",style:{backgroundColor:F.bgColor,color:F.color},children:F.label})]}),o.jsx("div",{className:"cor-card-right",children:o.jsx("span",{className:"cor-total",children:Yt(k.cor_total||0)})})]}),o.jsxs("div",{className:"cor-card-body",children:[o.jsx("h4",{className:"cor-title",children:k.title||"Untitled COR"}),o.jsxs("div",{className:"cor-meta",children:[k.area_id&&o.jsx("span",{className:"cor-area",children:de(k.area_id)}),o.jsx("span",{className:"cor-period",children:Y2(k.period_start,k.period_end)})]})]}),o.jsxs("div",{className:"cor-card-footer",children:[o.jsx("span",{className:"cor-created",children:uc(k.created_at)}),o.jsxs("div",{className:"cor-actions",onClick:se=>se.stopPropagation(),children:[te&&o.jsx("button",{className:"cor-action-btn submit",onClick:se=>ie(k.id,se),title:"Submit for Approval","aria-label":`Submit COR ${k.cor_number} for approval`,children:o.jsx(K4,{size:14,"aria-hidden":"true"})}),I&&o.jsx("button",{className:"cor-action-btn edit",onClick:se=>{se.stopPropagation(),c?.(k)},title:"Edit","aria-label":`Edit COR ${k.cor_number}`,children:o.jsx(e2,{size:14,"aria-hidden":"true"})}),o.jsx("button",{className:"cor-action-btn view",onClick:se=>{se.stopPropagation(),l?.(k)},title:"View Details","aria-label":`View COR ${k.cor_number} details`,children:o.jsx(tT,{size:14,"aria-hidden":"true"})}),z&&o.jsx("button",{className:"cor-action-btn delete",onClick:se=>V(k.id,se),title:"Delete","aria-label":`Delete COR ${k.cor_number}`,children:o.jsx(cu,{size:14,"aria-hidden":"true"})})]})]})]},k.id)};return m?o.jsx("div",{className:"loading",children:"Loading change order requests..."}):o.jsxs("div",{className:"cor-list",children:[o.jsxs("div",{className:"cor-list-header",children:[o.jsxs("div",{className:"cor-list-info",children:[o.jsx("h3",{children:"Change Orders"}),o.jsxs("div",{className:"cor-stats-inline",children:[o.jsxs("span",{className:"cor-stat-item",children:[re.all," total"]}),re.pending_approval>0&&o.jsxs("span",{className:"cor-stat-item pending",children:[re.pending_approval," pending"]}),J?.totalApproved>0&&o.jsx("span",{className:"cor-stat-item approved",children:Yt(J.totalApproved)})]})]}),o.jsxs("button",{className:"btn btn-primary btn-small",onClick:s,children:[o.jsx(Sl,{size:14})," New COR"]})]}),o.jsxs("div",{className:"cor-controls",children:[o.jsx("div",{className:"cor-filter-pills",role:"tablist",children:[{id:"all",label:"All"},{id:"draft",label:"Draft"},{id:"pending_approval",label:"Pending"},{id:"approved",label:"Approved"}].map(k=>o.jsxs("button",{role:"tab","aria-selected":x===k.id,className:`cor-pill ${x===k.id?"active":""}`,onClick:()=>g(k.id),children:[k.label,re[k.id]>0&&o.jsx("span",{className:"cor-pill-count",children:re[k.id]})]},k.id))}),o.jsxs("div",{className:"cor-view-toggle",children:[o.jsx("button",{className:`cor-toggle-btn ${R==="recent"?"active":""}`,onClick:()=>{Y("recent"),L({start:"",end:""})},children:"Recent"}),o.jsx("button",{className:`cor-toggle-btn ${R==="all"?"active":""}`,onClick:()=>Y("all"),children:"All"})]})]}),R==="all"&&o.jsxs("div",{className:"cor-date-filter",children:[o.jsx(V0,{size:14}),o.jsx("input",{type:"date",value:q.start,onChange:k=>L(F=>({...F,start:k.target.value}))}),o.jsx("span",{className:"cor-date-sep",children:"to"}),o.jsx("input",{type:"date",value:q.end,onChange:k=>L(F=>({...F,end:k.target.value}))}),(q.start||q.end)&&o.jsx("button",{className:"cor-clear-btn",onClick:()=>L({start:"",end:""}),children:"Clear"})]}),X.length===0?o.jsxs("div",{className:"cor-empty",children:[o.jsx(El,{size:24,className:"cor-empty-icon"}),o.jsxs("p",{children:["No change orders ",x!=="all"?`(${x.replace("_"," ")})`:""]}),o.jsxs("button",{className:"btn btn-primary btn-small",onClick:s,children:[o.jsx(Sl,{size:14})," Create COR"]})]}):o.jsx("div",{className:"cor-cards",children:R==="all"&&Z?Z.map(([k,F])=>o.jsxs("div",{className:"cor-month-group",children:[o.jsxs("button",{className:"cor-month-header",onClick:()=>K(k),children:[o.jsxs("div",{className:"cor-month-left",children:[W.has(k)?o.jsx(jf,{size:16}):o.jsx(Ef,{size:16}),o.jsx("span",{children:F.label}),o.jsx("span",{className:"cor-month-count",children:F.cors.length})]}),o.jsx("span",{className:"cor-month-total",children:Yt(F.totalAmount)})]}),W.has(k)&&o.jsx("div",{className:"cor-month-items",children:F.cors.map(I=>U(I))})]},k)):X.map(k=>U(k))})]})}function UH({projectId:t,corId:e,onImport:r,onClose:a,onShowToast:n}){const[s,l]=ne.useState([]),[c,f]=ne.useState(!0),[d,m]=ne.useState(new Set),[v,x]=ne.useState(null),[g,b]=ne.useState(""),[_,w]=ne.useState("unassigned");ne.useEffect(()=>{A()},[t]);const A=async()=>{try{const q=await ot.getTMTickets(t);l(q||[])}catch(q){console.error("Error loading tickets:",q),n?.("Error loading tickets","error")}finally{f(!1)}},C=ne.useMemo(()=>{let q=[...s];if(_==="unassigned"?q=q.filter(L=>!L.assigned_cor_id):_==="approved"&&(q=q.filter(L=>L.status==="approved")),g){const L=g.toLowerCase();q=q.filter(J=>J.work_description?.toLowerCase().includes(L)||J.ce_pco_number?.toLowerCase().includes(L)||J.ticket_date?.includes(L))}return q.sort((L,J)=>new Date(J.ticket_date)-new Date(L.ticket_date)),q},[s,_,g]),E=q=>{const L=new Set(d);L.has(q)?L.delete(q):L.add(q),m(L)},R=()=>{d.size===C.length?m(new Set):m(new Set(C.map(q=>q.id)))},Y=q=>new Date(q).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),W=q=>{const L=q.workers?.length||0,J=q.items?.length||0,D=q.materials_equipment?.filter(M=>M.type==="equipment")?.length||0;let T=0;return q.workers?.forEach(M=>{T+=(parseFloat(M.regular_hours)||0)+(parseFloat(M.overtime_hours)||0)}),{workerCount:L,itemCount:J,equipmentCount:D,laborHours:T}},B=()=>{if(d.size===0){n?.("Please select at least one ticket","error");return}const q=s.filter(T=>d.has(T.id)),L=[],J=[],D=[];q.forEach(T=>{T.workers?.forEach(M=>{L.push({id:`import-${T.id}-${M.id||Date.now()}`,labor_class:M.role||"Laborer",wage_type:"standard",regular_hours:parseFloat(M.regular_hours)||0,overtime_hours:parseFloat(M.overtime_hours)||0,regular_rate:0,overtime_rate:0,total:0,source_ticket_id:T.id,source_ticket_date:T.ticket_date})}),T.items?.forEach(M=>{J.push({id:`import-${T.id}-${M.id||Date.now()}`,description:M.description||M.name,source_type:"backup_sheet",source_reference:`Ticket ${Y(T.ticket_date)}`,quantity:parseFloat(M.quantity)||1,unit:M.unit||"each",unit_cost:oc(M.unit_cost||0),total:oc((M.quantity||1)*(M.unit_cost||0)),source_ticket_id:T.id})}),T.materials_equipment?.filter(M=>M.type==="equipment").forEach(M=>{D.push({id:`import-${T.id}-${M.id||Date.now()}`,description:M.description||M.name,source_type:"backup_sheet",source_reference:`Ticket ${Y(T.ticket_date)}`,quantity:parseFloat(M.quantity)||1,unit:M.unit||"day",unit_cost:oc(M.unit_cost||M.cost||0),total:oc((M.quantity||1)*(M.unit_cost||M.cost||0)),source_ticket_id:T.id})})}),r?.({ticketIds:Array.from(d),laborItems:L,materialsItems:J,equipmentItems:D}),a?.()};return c?o.jsx("div",{className:"modal-overlay",onClick:a,role:"dialog","aria-modal":"true","aria-label":"Loading tickets",children:o.jsx("div",{className:"modal-content ticket-selector-modal",onClick:q=>q.stopPropagation(),children:o.jsx("div",{className:"loading",role:"status","aria-live":"polite",children:"Loading tickets..."})})}):o.jsx("div",{className:"modal-overlay",onClick:a,role:"dialog","aria-modal":"true","aria-labelledby":"ticket-selector-title",children:o.jsxs("div",{className:"modal-content ticket-selector-modal",onClick:q=>q.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{id:"ticket-selector-title",children:"Import from T&M Tickets"}),o.jsx("button",{className:"close-btn",onClick:a,"aria-label":"Close ticket selector",children:o.jsx(fh,{size:20,"aria-hidden":"true"})})]}),o.jsxs("div",{className:"ticket-selector-controls",children:[o.jsxs("div",{className:"ticket-search",children:[o.jsx(kT,{size:16,"aria-hidden":"true"}),o.jsx("input",{type:"text",placeholder:"Search tickets...",value:g,onChange:q=>b(q.target.value),"aria-label":"Search tickets"})]}),o.jsxs("div",{className:"ticket-filters",role:"group","aria-label":"Filter tickets by status",children:[o.jsx("button",{className:`filter-btn ${_==="unassigned"?"active":""}`,onClick:()=>w("unassigned"),"aria-pressed":_==="unassigned",children:"Unassigned"}),o.jsx("button",{className:`filter-btn ${_==="approved"?"active":""}`,onClick:()=>w("approved"),"aria-pressed":_==="approved",children:"Approved"}),o.jsx("button",{className:`filter-btn ${_==="all"?"active":""}`,onClick:()=>w("all"),"aria-pressed":_==="all",children:"All"})]})]}),o.jsxs("div",{className:"ticket-selector-header",children:[o.jsxs("label",{className:"select-all",children:[o.jsx("input",{type:"checkbox",checked:d.size===C.length&&C.length>0,onChange:R,"aria-label":`Select all ${C.length} tickets`}),o.jsxs("span",{children:["Select All (",C.length,")"]})]}),o.jsxs("span",{className:"selected-count",children:[d.size," selected"]})]}),o.jsx("div",{className:"modal-body ticket-selector-body",children:C.length===0?o.jsxs("div",{className:"ticket-empty",children:[o.jsx(El,{size:32}),o.jsx("p",{children:"No tickets found"}),_==="unassigned"&&o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>w("all"),children:"Show all tickets"})]}):o.jsx("div",{className:"ticket-list",children:C.map(q=>{const L=W(q),J=d.has(q.id),D=v===q.id;return o.jsxs("div",{className:`ticket-item ${J?"selected":""} ${q.assigned_cor_id?"assigned":""}`,children:[o.jsxs("div",{className:"ticket-item-main",children:[o.jsx("label",{className:"ticket-checkbox",children:o.jsx("input",{type:"checkbox",checked:J,onChange:()=>E(q.id),disabled:q.assigned_cor_id&&q.assigned_cor_id!==e})}),o.jsxs("div",{className:"ticket-item-info",onClick:()=>x(D?null:q.id),children:[o.jsxs("div",{className:"ticket-item-header",children:[o.jsx("span",{className:"ticket-date",children:Y(q.ticket_date)}),o.jsx("span",{className:`ticket-status ${q.status}`,children:q.status}),q.ce_pco_number&&o.jsxs("span",{className:"ticket-pco",children:["CE/PCO: ",q.ce_pco_number]})]}),o.jsx("div",{className:"ticket-item-desc",children:q.work_description||"No description"}),o.jsxs("div",{className:"ticket-item-summary",children:[L.workerCount>0&&o.jsxs("span",{children:[o.jsx(Z4,{size:12})," ",L.workerCount," workers"]}),L.itemCount>0&&o.jsxs("span",{children:[o.jsx(Af,{size:12})," ",L.itemCount," items"]}),L.equipmentCount>0&&o.jsxs("span",{children:[o.jsx(m1,{size:12})," ",L.equipmentCount," equipment"]}),L.laborHours>0&&o.jsxs("span",{children:[L.laborHours," hrs"]})]})]}),o.jsx("button",{className:"ticket-expand-btn",onClick:()=>x(D?null:q.id),children:D?o.jsx(jf,{size:16}):o.jsx(Ef,{size:16})})]}),D&&o.jsxs("div",{className:"ticket-item-details",children:[q.workers?.length>0&&o.jsxs("div",{className:"ticket-detail-section",children:[o.jsx("h5",{children:"Workers"}),o.jsx("ul",{children:q.workers.map((T,M)=>o.jsxs("li",{children:[T.name||T.role," - ",T.regular_hours||0," reg hrs",T.overtime_hours>0&&`, ${T.overtime_hours} OT hrs`]},M))})]}),q.items?.length>0&&o.jsxs("div",{className:"ticket-detail-section",children:[o.jsx("h5",{children:"Materials"}),o.jsx("ul",{children:q.items.map((T,M)=>o.jsxs("li",{children:[T.description||T.name," - ",T.quantity," ",T.unit]},M))})]}),q.materials_equipment?.filter(T=>T.type==="equipment").length>0&&o.jsxs("div",{className:"ticket-detail-section",children:[o.jsx("h5",{children:"Equipment"}),o.jsx("ul",{children:q.materials_equipment.filter(T=>T.type==="equipment").map((T,M)=>o.jsx("li",{children:T.description||T.name},M))})]})]})]},q.id)})})}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{className:"btn btn-secondary",onClick:a,children:"Cancel"}),o.jsxs("button",{className:"btn btn-primary",onClick:B,disabled:d.size===0,children:[o.jsx(A0,{size:16})," Import ",d.size," Ticket",d.size!==1?"s":""]})]})]})})}const Cp=[{id:1,label:"Title & Info",shortLabel:"Info"},{id:2,label:"Period",shortLabel:"Period"},{id:3,label:"Labor",shortLabel:"Labor"},{id:4,label:"Materials",shortLabel:"Materials"},{id:5,label:"Equipment",shortLabel:"Equipment"},{id:6,label:"Subcontractors",shortLabel:"Subs"},{id:7,label:"Markups & Fees",shortLabel:"Markups"},{id:8,label:"Summary",shortLabel:"Summary"},{id:9,label:"Submit",shortLabel:"Submit"}];function qH({project:t,company:e,areas:r,existingCOR:a,onClose:n,onSaved:s,onShowToast:l}){const[c,f]=ne.useState(1),[d,m]=ne.useState(!1),[v,x]=ne.useState([]),[g,b]=ne.useState(!1),[_,w]=ne.useState(a?.title||""),[A,C]=ne.useState(a?.scope_of_work||""),[E,R]=ne.useState(a?.area_id||""),[Y,W]=ne.useState(a?.cor_number||""),[B,q]=ne.useState(a?.period_start||""),[L,J]=ne.useState(a?.period_end||""),[D,T]=ne.useState(a?.change_order_labor||[]),[M,V]=ne.useState(a?.change_order_materials||[]),[ie,X]=ne.useState(a?.change_order_equipment||[]),[Z,K]=ne.useState(a?.change_order_subcontractors||[]),[re,de]=ne.useState(a?.labor_markup_percent??ef.labor_markup),[U,k]=ne.useState(a?.materials_markup_percent??ef.materials_markup),[F,I]=ne.useState(a?.equipment_markup_percent??ef.equipment_markup),[z,te]=ne.useState(a?.subcontractors_markup_percent??ef.subcontractors_markup),[se,pe]=ne.useState(a?.liability_insurance_percent??ef.liability_insurance),[ve,_e]=ne.useState(a?.bond_percent??ef.bond),[Pe,fe]=ne.useState(a?.license_fee_percent??ef.license_fee);ne.useEffect(()=>{st(),a||he()},[]);const st=async()=>{try{const ce=await ot.getLaborRates?.(e?.id,t?.work_type,t?.job_type);x(ce||[])}catch(ce){console.error("Error loading labor rates:",ce)}},mt=ce=>{const Re=ce?.toLowerCase()||"";return v.find(Me=>Me.role?.toLowerCase()===Re)||null},he=async()=>{try{const ce=await ot.getNextCORNumber?.(t.id);W(ce||`COR-${Date.now()}`)}catch(ce){console.error("Error generating COR number:",ce),W(`COR-${Date.now()}`)}},at=ne.useMemo(()=>({title:_,scope_of_work:A,area_id:E||null,cor_number:Y,period_start:B,period_end:L,change_order_labor:D,change_order_materials:M,change_order_equipment:ie,change_order_subcontractors:Z,labor_markup_percent:re,materials_markup_percent:U,equipment_markup_percent:F,subcontractors_markup_percent:z,liability_insurance_percent:se,bond_percent:ve,license_fee_percent:Pe}),[_,A,E,Y,B,L,D,M,ie,Z,re,U,F,z,se,ve,Pe]),we=ne.useMemo(()=>E1(at),[at]),ye=ce=>{switch(ce){case 1:return _.trim()?A.trim()?!0:(l?.("Scope of work is required","error"),!1):(l?.("Title is required","error"),!1);case 2:return B?L?new Date(L)<new Date(B)?(l?.("End date must be after start date","error"),!1):!0:(l?.("End date is required","error"),!1):(l?.("Start date is required","error"),!1);default:return!0}},Be=()=>{ye(c)&&f(Math.min(c+1,Cp.length))},Et=()=>{f(Math.max(c-1,1))},Xe=ce=>{if(ce<c)f(ce);else if(ce>c){for(let Re=c;Re<ce;Re++)if(!ye(Re))return;f(ce)}},lt=()=>{const ce=US[0],Re=mt(ce);T([...D,{id:`temp-${Date.now()}`,labor_class:ce,wage_type:"standard",regular_hours:0,overtime_hours:0,regular_rate:Re?Math.round((parseFloat(Re.regular_rate)||0)*100):0,overtime_rate:Re?Math.round((parseFloat(Re.overtime_rate)||0)*100):0,total:0}])},jt=(ce,Re,Me)=>{const Tt=[...D];if(Tt[ce]={...Tt[ce],[Re]:Me},Re==="labor_class"){const or=mt(Me);or&&(Tt[ce].regular_rate=Math.round((parseFloat(or.regular_rate)||0)*100),Tt[ce].overtime_rate=Math.round((parseFloat(or.overtime_rate)||0)*100))}const{total:$t}=MH(Tt[ce].regular_hours,Tt[ce].overtime_hours,Tt[ce].regular_rate,Tt[ce].overtime_rate);Tt[ce].total=$t,T(Tt)},Dt=ce=>{T(D.filter((Re,Me)=>Me!==ce))},Wt=()=>{V([...M,{id:`temp-${Date.now()}`,description:"",source_type:"backup_sheet",source_reference:"",quantity:1,unit:"each",unit_cost:0,total:0}])},et=(ce,Re,Me)=>{const Tt=[...M];Tt[ce]={...Tt[ce],[Re]:Me},Tt[ce].total=BS(Tt[ce].quantity,Tt[ce].unit_cost),V(Tt)},ht=ce=>{V(M.filter((Re,Me)=>Me!==ce))},yt=()=>{X([...ie,{id:`temp-${Date.now()}`,description:"",source_type:"backup_sheet",source_reference:"",quantity:1,unit:"day",unit_cost:0,total:0}])},ft=(ce,Re,Me)=>{const Tt=[...ie];Tt[ce]={...Tt[ce],[Re]:Me},Tt[ce].total=BS(Tt[ce].quantity,Tt[ce].unit_cost),X(Tt)},pt=ce=>{X(ie.filter((Re,Me)=>Me!==ce))},wt=()=>{K([...Z,{id:`temp-${Date.now()}`,company_name:"",description:"",source_type:"invoice",source_reference:"",amount:0,total:0}])},Lt=(ce,Re,Me)=>{const Tt=[...Z];Tt[ce]={...Tt[ce],[Re]:Me},Re==="amount"&&(Tt[ce].total=parseInt(Me)||0),K(Tt)},Pt=ce=>{K(Z.filter((Re,Me)=>Me!==ce))},zt=ce=>{ce.laborItems?.length>0&&T([...D,...ce.laborItems]),ce.materialsItems?.length>0&&V([...M,...ce.materialsItems]),ce.equipmentItems?.length>0&&X([...ie,...ce.equipmentItems]),l?.(`Imported data from ${ce.ticketIds.length} ticket(s)`,"success")},Ce=async()=>{m(!0);try{const ce={company_id:e.id,project_id:t.id,...at,...we,status:"draft"};let Re;a?.id?Re=await ot.updateCOR(a.id,ce):Re=await ot.createCOR(ce),Re?.id&&await ot.saveCORLineItems(Re.id,{laborItems:D,materialItems:M,equipmentItems:ie,subcontractorItems:Z}),l?.("COR saved as draft","success"),s?.(Re),n?.()}catch(ce){console.error("Error saving COR:",ce),l?.("Error saving COR","error")}finally{m(!1)}},Ve=async()=>{const ce=Vv(at);if(!ce.valid){l?.(ce.errors[0],"error");return}m(!0);try{const Re={company_id:e.id,project_id:t.id,...at,...we,status:"pending_approval"};let Me;a?.id?(Me=await ot.updateCOR(a.id,{...Re,status:"draft"}),await ot.saveCORLineItems(a.id,{laborItems:D,materialItems:M,equipmentItems:ie,subcontractorItems:Z}),await ot.submitCORForApproval(a.id)):(Me=await ot.createCOR({...Re,status:"draft"}),Me?.id&&(await ot.saveCORLineItems(Me.id,{laborItems:D,materialItems:M,equipmentItems:ie,subcontractorItems:Z}),await ot.submitCORForApproval(Me.id))),l?.("COR submitted for approval","success"),s?.(Me),n?.()}catch(Re){console.error("Error submitting COR:",Re),l?.("Error submitting COR","error")}finally{m(!1)}};return o.jsxs("div",{className:"modal-overlay",onClick:n,children:[o.jsxs("div",{className:"modal-content cor-form-modal",onClick:ce=>ce.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:a?"Edit Change Order Request":"New Change Order Request"}),o.jsx("button",{className:"close-btn",onClick:n,children:o.jsx(fh,{size:20})})]}),o.jsx("div",{className:"cor-progress-steps",children:Cp.map(ce=>o.jsxs("div",{className:`cor-step ${c>=ce.id?"active":""} ${c===ce.id?"current":""}`,onClick:()=>Xe(ce.id),children:[o.jsx("span",{className:"cor-step-number",children:ce.id}),o.jsx("span",{className:"cor-step-label",children:ce.shortLabel})]},ce.id))}),o.jsxs("div",{className:"modal-body cor-form-body",children:[c===1&&o.jsxs("div",{className:"cor-form-step",children:[o.jsx("h3",{children:"Basic Information"}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"COR Number"}),o.jsx("input",{type:"text",value:Y,onChange:ce=>W(ce.target.value),placeholder:"Auto-generated",className:"input-readonly",readOnly:!0})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Title *"}),o.jsx("input",{type:"text",value:_,onChange:ce=>w(ce.target.value),placeholder:"e.g., Additional Demolition Work - Building A"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Scope of Work *"}),o.jsx("textarea",{value:A,onChange:ce=>C(ce.target.value),rows:4,placeholder:"Describe the scope of work covered by this change order..."})]}),r&&r.length>0&&o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Work Area (Optional)"}),o.jsxs("select",{value:E,onChange:ce=>R(ce.target.value),children:[o.jsx("option",{value:"",children:"No specific area"}),r.map(ce=>o.jsx("option",{value:ce.id,children:ce.name},ce.id))]})]})]}),c===2&&o.jsxs("div",{className:"cor-form-step",children:[o.jsx("h3",{children:"Work Period"}),o.jsx("p",{className:"step-description",children:"Specify the date range for this change order work."}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Start Date *"}),o.jsx("input",{type:"date",value:B,onChange:ce=>q(ce.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"End Date *"}),o.jsx("input",{type:"date",value:L,onChange:ce=>J(ce.target.value),min:B})]})]})]}),c===3&&o.jsxs("div",{className:"cor-form-step",children:[o.jsxs("div",{className:"step-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Labor"}),o.jsx("p",{className:"step-description",children:"Add labor costs for this change order."})]}),o.jsxs("div",{className:"step-header-actions",children:[o.jsxs("button",{className:"btn btn-ghost",onClick:()=>b(!0),children:[o.jsx(El,{size:16})," Import from Tickets"]}),o.jsxs("button",{className:"btn btn-secondary",onClick:lt,children:[o.jsx(Sl,{size:16})," Add Labor"]})]})]}),D.length===0?o.jsxs("div",{className:"empty-items",children:[o.jsx("p",{children:"No labor items added yet."}),o.jsxs("button",{className:"btn btn-primary",onClick:lt,children:[o.jsx(Sl,{size:16})," Add First Labor Item"]})]}):o.jsx("div",{className:"line-items-list",children:D.map((ce,Re)=>o.jsxs("div",{className:"line-item labor-item",children:[o.jsxs("div",{className:"line-item-header",children:[o.jsxs("span",{className:"line-item-number",children:["#",Re+1]}),o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>Dt(Re),children:o.jsx(cu,{size:14})})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Labor Class"}),o.jsx("select",{value:ce.labor_class,onChange:Me=>jt(Re,"labor_class",Me.target.value),children:US.map(Me=>o.jsx("option",{value:Me,children:Me},Me))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Wage Type"}),o.jsx("select",{value:ce.wage_type,onChange:Me=>jt(Re,"wage_type",Me.target.value),children:IH.map(Me=>o.jsx("option",{value:Me.value,children:Me.label},Me.value))})]})]}),o.jsxs("div",{className:"form-row four-col",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Reg Hours"}),o.jsx("input",{type:"number",step:"0.5",min:"0",value:ce.regular_hours,onChange:Me=>jt(Re,"regular_hours",Me.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Reg Rate ($/hr)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:Ii(ce.regular_rate),onChange:Me=>jt(Re,"regular_rate",oc(Me.target.value))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"OT Hours"}),o.jsx("input",{type:"number",step:"0.5",min:"0",value:ce.overtime_hours,onChange:Me=>jt(Re,"overtime_hours",Me.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"OT Rate ($/hr)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:Ii(ce.overtime_rate),onChange:Me=>jt(Re,"overtime_rate",oc(Me.target.value))})]})]}),o.jsxs("div",{className:"line-item-total",children:["Total: ",o.jsx("strong",{children:Yt(ce.total)})]})]},ce.id||Re))}),o.jsxs("div",{className:"section-subtotal",children:["Labor Subtotal: ",o.jsx("strong",{children:Yt(we.labor_subtotal)})]})]}),c===4&&o.jsxs("div",{className:"cor-form-step",children:[o.jsxs("div",{className:"step-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Materials"}),o.jsx("p",{className:"step-description",children:"Add material costs for this change order."})]}),o.jsxs("button",{className:"btn btn-secondary",onClick:Wt,children:[o.jsx(Sl,{size:16})," Add Material"]})]}),M.length===0?o.jsxs("div",{className:"empty-items",children:[o.jsx("p",{children:"No materials added yet."}),o.jsxs("button",{className:"btn btn-primary",onClick:Wt,children:[o.jsx(Sl,{size:16})," Add First Material"]})]}):o.jsx("div",{className:"line-items-list",children:M.map((ce,Re)=>o.jsxs("div",{className:"line-item",children:[o.jsxs("div",{className:"line-item-header",children:[o.jsxs("span",{className:"line-item-number",children:["#",Re+1]}),o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>ht(Re),children:o.jsx(cu,{size:14})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Description"}),o.jsx("input",{type:"text",value:ce.description,onChange:Me=>et(Re,"description",Me.target.value),placeholder:"Material description"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Source"}),o.jsx("select",{value:ce.source_type,onChange:Me=>et(Re,"source_type",Me.target.value),children:Gv.materials.map(Me=>o.jsx("option",{value:Me.value,children:Me.label},Me.value))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Reference"}),o.jsx("input",{type:"text",value:ce.source_reference,onChange:Me=>et(Re,"source_reference",Me.target.value),placeholder:"Ticket #, Invoice #"})]})]}),o.jsxs("div",{className:"form-row three-col",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Quantity"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:ce.quantity,onChange:Me=>et(Re,"quantity",Me.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Unit"}),o.jsx("select",{value:ce.unit,onChange:Me=>et(Re,"unit",Me.target.value),children:qS.map(Me=>o.jsx("option",{value:Me,children:Me},Me))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Unit Cost ($)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:Ii(ce.unit_cost),onChange:Me=>et(Re,"unit_cost",oc(Me.target.value))})]})]}),o.jsxs("div",{className:"line-item-total",children:["Total: ",o.jsx("strong",{children:Yt(ce.total)})]})]},ce.id||Re))}),o.jsxs("div",{className:"section-subtotal",children:["Materials Subtotal: ",o.jsx("strong",{children:Yt(we.materials_subtotal)})]})]}),c===5&&o.jsxs("div",{className:"cor-form-step",children:[o.jsxs("div",{className:"step-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Equipment"}),o.jsx("p",{className:"step-description",children:"Add equipment rental costs for this change order."})]}),o.jsxs("button",{className:"btn btn-secondary",onClick:yt,children:[o.jsx(Sl,{size:16})," Add Equipment"]})]}),ie.length===0?o.jsxs("div",{className:"empty-items",children:[o.jsx("p",{children:"No equipment added yet."}),o.jsxs("button",{className:"btn btn-primary",onClick:yt,children:[o.jsx(Sl,{size:16})," Add First Equipment"]})]}):o.jsx("div",{className:"line-items-list",children:ie.map((ce,Re)=>o.jsxs("div",{className:"line-item",children:[o.jsxs("div",{className:"line-item-header",children:[o.jsxs("span",{className:"line-item-number",children:["#",Re+1]}),o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>pt(Re),children:o.jsx(cu,{size:14})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Description"}),o.jsx("input",{type:"text",value:ce.description,onChange:Me=>ft(Re,"description",Me.target.value),placeholder:"Equipment description"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Source"}),o.jsx("select",{value:ce.source_type,onChange:Me=>ft(Re,"source_type",Me.target.value),children:Gv.equipment.map(Me=>o.jsx("option",{value:Me.value,children:Me.label},Me.value))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Reference"}),o.jsx("input",{type:"text",value:ce.source_reference,onChange:Me=>ft(Re,"source_reference",Me.target.value),placeholder:"Ticket #, Invoice #"})]})]}),o.jsxs("div",{className:"form-row three-col",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Quantity"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:ce.quantity,onChange:Me=>ft(Re,"quantity",Me.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Unit"}),o.jsx("select",{value:ce.unit,onChange:Me=>ft(Re,"unit",Me.target.value),children:qS.map(Me=>o.jsx("option",{value:Me,children:Me},Me))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Unit Cost ($)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:Ii(ce.unit_cost),onChange:Me=>ft(Re,"unit_cost",oc(Me.target.value))})]})]}),o.jsxs("div",{className:"line-item-total",children:["Total: ",o.jsx("strong",{children:Yt(ce.total)})]})]},ce.id||Re))}),o.jsxs("div",{className:"section-subtotal",children:["Equipment Subtotal: ",o.jsx("strong",{children:Yt(we.equipment_subtotal)})]})]}),c===6&&o.jsxs("div",{className:"cor-form-step",children:[o.jsxs("div",{className:"step-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Subcontractors"}),o.jsx("p",{className:"step-description",children:"Add subcontractor costs for this change order."})]}),o.jsxs("button",{className:"btn btn-secondary",onClick:wt,children:[o.jsx(Sl,{size:16})," Add Subcontractor"]})]}),Z.length===0?o.jsxs("div",{className:"empty-items",children:[o.jsx("p",{children:"No subcontractors added yet."}),o.jsxs("button",{className:"btn btn-primary",onClick:wt,children:[o.jsx(Sl,{size:16})," Add First Subcontractor"]})]}):o.jsx("div",{className:"line-items-list",children:Z.map((ce,Re)=>o.jsxs("div",{className:"line-item",children:[o.jsxs("div",{className:"line-item-header",children:[o.jsxs("span",{className:"line-item-number",children:["#",Re+1]}),o.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>Pt(Re),children:o.jsx(cu,{size:14})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Company Name"}),o.jsx("input",{type:"text",value:ce.company_name,onChange:Me=>Lt(Re,"company_name",Me.target.value),placeholder:"Subcontractor company name"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Description of Work"}),o.jsx("input",{type:"text",value:ce.description,onChange:Me=>Lt(Re,"description",Me.target.value),placeholder:"Work performed"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Source"}),o.jsx("select",{value:ce.source_type,onChange:Me=>Lt(Re,"source_type",Me.target.value),children:Gv.subcontractors.map(Me=>o.jsx("option",{value:Me.value,children:Me.label},Me.value))})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Reference"}),o.jsx("input",{type:"text",value:ce.source_reference,onChange:Me=>Lt(Re,"source_reference",Me.target.value),placeholder:"Invoice #, Quote #"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Amount ($)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:Ii(ce.amount),onChange:Me=>Lt(Re,"amount",oc(Me.target.value))})]})]}),o.jsxs("div",{className:"line-item-total",children:["Total: ",o.jsx("strong",{children:Yt(ce.total)})]})]},ce.id||Re))}),o.jsxs("div",{className:"section-subtotal",children:["Subcontractors Subtotal: ",o.jsx("strong",{children:Yt(we.subcontractors_subtotal)})]})]}),c===7&&o.jsxs("div",{className:"cor-form-step",children:[o.jsx("h3",{children:"Markups & Fees"}),o.jsx("p",{className:"step-description",children:"Configure markup percentages and additional fees."}),o.jsxs("div",{className:"markups-section",children:[o.jsx("h4",{children:"Markups"}),o.jsxs("div",{className:"markups-grid",children:[o.jsxs("div",{className:"markup-item",children:[o.jsx("label",{children:"Labor Markup"}),o.jsxs("div",{className:"markup-input",children:[o.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:su(re),onChange:ce=>de(Qu(ce.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"markup-amount",children:["+",Yt(we.labor_markup_amount)]})]}),o.jsxs("div",{className:"markup-item",children:[o.jsx("label",{children:"Materials Markup"}),o.jsxs("div",{className:"markup-input",children:[o.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:su(U),onChange:ce=>k(Qu(ce.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"markup-amount",children:["+",Yt(we.materials_markup_amount)]})]}),o.jsxs("div",{className:"markup-item",children:[o.jsx("label",{children:"Equipment Markup"}),o.jsxs("div",{className:"markup-input",children:[o.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:su(F),onChange:ce=>I(Qu(ce.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"markup-amount",children:["+",Yt(we.equipment_markup_amount)]})]}),o.jsxs("div",{className:"markup-item",children:[o.jsx("label",{children:"Subcontractors Markup"}),o.jsxs("div",{className:"markup-input",children:[o.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:su(z),onChange:ce=>te(Qu(ce.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"markup-amount",children:["+",Yt(we.subcontractors_markup_amount)]})]})]})]}),o.jsxs("div",{className:"fees-section",children:[o.jsx("h4",{children:"Additional Fees"}),o.jsxs("div",{className:"fees-grid",children:[o.jsxs("div",{className:"fee-item",children:[o.jsx("label",{children:"Liability Insurance"}),o.jsxs("div",{className:"fee-input",children:[o.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:su(se),onChange:ce=>pe(Qu(ce.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"fee-amount",children:["+",Yt(we.liability_insurance_amount)]})]}),o.jsxs("div",{className:"fee-item",children:[o.jsx("label",{children:"Bond"}),o.jsxs("div",{className:"fee-input",children:[o.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:su(ve),onChange:ce=>_e(Qu(ce.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"fee-amount",children:["+",Yt(we.bond_amount)]})]}),o.jsxs("div",{className:"fee-item",children:[o.jsx("label",{children:"City License Fee"}),o.jsxs("div",{className:"fee-input",children:[o.jsx("input",{type:"number",step:"0.001",min:"0",max:"100",value:su(Pe),onChange:ce=>fe(Qu(ce.target.value))}),o.jsx("span",{children:"%"})]}),o.jsxs("span",{className:"fee-amount",children:["+",Yt(we.license_fee_amount)]})]})]})]})]}),c===8&&o.jsxs("div",{className:"cor-form-step",children:[o.jsx("h3",{children:"Summary"}),o.jsxs("div",{className:"cor-summary",children:[o.jsxs("div",{className:"summary-header",children:[o.jsx("div",{className:"summary-title",children:_||"Untitled COR"}),o.jsx("div",{className:"summary-number",children:Y})]}),o.jsxs("div",{className:"summary-section",children:[o.jsx("h4",{children:"Costs Breakdown"}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["Labor (",D.length," items)"]}),o.jsx("span",{children:Yt(we.labor_subtotal)})]}),o.jsxs("div",{className:"summary-line indent",children:[o.jsxs("span",{children:["+ Markup (",wn(re),")"]}),o.jsx("span",{children:Yt(we.labor_markup_amount)})]}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["Materials (",M.length," items)"]}),o.jsx("span",{children:Yt(we.materials_subtotal)})]}),o.jsxs("div",{className:"summary-line indent",children:[o.jsxs("span",{children:["+ Markup (",wn(U),")"]}),o.jsx("span",{children:Yt(we.materials_markup_amount)})]}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["Equipment (",ie.length," items)"]}),o.jsx("span",{children:Yt(we.equipment_subtotal)})]}),o.jsxs("div",{className:"summary-line indent",children:[o.jsxs("span",{children:["+ Markup (",wn(F),")"]}),o.jsx("span",{children:Yt(we.equipment_markup_amount)})]}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["Subcontractors (",Z.length," items)"]}),o.jsx("span",{children:Yt(we.subcontractors_subtotal)})]}),o.jsxs("div",{className:"summary-line indent",children:[o.jsxs("span",{children:["+ Markup (",wn(z),")"]}),o.jsx("span",{children:Yt(we.subcontractors_markup_amount)})]})]}),o.jsxs("div",{className:"summary-subtotal",children:[o.jsx("span",{children:"COR Subtotal"}),o.jsx("span",{children:Yt(we.cor_subtotal)})]}),o.jsxs("div",{className:"summary-section",children:[o.jsx("h4",{children:"Additional Fees"}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["Liability Insurance (",wn(se),")"]}),o.jsx("span",{children:Yt(we.liability_insurance_amount)})]}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["Bond (",wn(ve),")"]}),o.jsx("span",{children:Yt(we.bond_amount)})]}),o.jsxs("div",{className:"summary-line",children:[o.jsxs("span",{children:["City License Fee (",wn(Pe),")"]}),o.jsx("span",{children:Yt(we.license_fee_amount)})]})]}),o.jsxs("div",{className:"summary-total",children:[o.jsx("span",{children:"COR Total"}),o.jsx("span",{children:Yt(we.cor_total)})]})]})]}),c===9&&o.jsxs("div",{className:"cor-form-step",children:[o.jsx("h3",{children:"Submit Change Order Request"}),o.jsxs("div",{className:"submit-preview",children:[o.jsxs("div",{className:"preview-card",children:[o.jsxs("div",{className:"preview-header",children:[o.jsx("span",{className:"preview-number",children:Y}),o.jsx("span",{className:"preview-total",children:Yt(we.cor_total)})]}),o.jsx("div",{className:"preview-title",children:_}),o.jsx("div",{className:"preview-scope",children:A})]}),(()=>{const ce=Vv(at);return ce.valid?o.jsx("div",{className:"validation-success",children:"Ready to submit for approval!"}):o.jsxs("div",{className:"validation-errors",children:[o.jsx(G0,{size:20}),o.jsxs("div",{children:[o.jsx("strong",{children:"Please fix the following issues:"}),o.jsx("ul",{children:ce.errors.map((Re,Me)=>o.jsx("li",{children:Re},Me))})]})]})})(),o.jsxs("div",{className:"submit-actions",children:[o.jsxs("button",{className:"btn btn-secondary",onClick:Ce,disabled:d,children:[o.jsx(rw,{size:16})," Save as Draft"]}),o.jsxs("button",{className:"btn btn-primary",onClick:Ve,disabled:d||!Vv(at).valid,children:[o.jsx(K4,{size:16})," Submit for Approval"]})]})]})]})]}),o.jsxs("div",{className:"modal-footer cor-form-footer",children:[o.jsx("div",{className:"footer-left",children:c>1&&o.jsxs("button",{className:"btn btn-secondary",onClick:Et,disabled:d,children:[o.jsx(UC,{size:16})," Back"]})}),o.jsx("div",{className:"footer-center",children:o.jsxs("span",{className:"step-indicator",children:["Step ",c," of ",Cp.length]})}),o.jsxs("div",{className:"footer-right",children:[c<Cp.length&&o.jsxs("button",{className:"btn btn-primary",onClick:Be,disabled:d,children:["Next ",o.jsx(Ef,{size:16})]}),c>1&&c<9&&o.jsxs("button",{className:"btn btn-ghost",onClick:Ce,disabled:d,children:[o.jsx(rw,{size:14})," Save Draft"]})]})]})]}),g&&o.jsx(UH,{projectId:t.id,corId:a?.id,onImport:zt,onClose:()=>b(!1),onShowToast:l})]})}const zH=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},HH=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});async function $H(t,e,r,a={}){const n=new ir,s=n.internal.pageSize.getWidth(),l=n.internal.pageSize.getHeight(),c=20;let f=c;const d=E1(t),m=a.primaryColor?zH(a.primaryColor):[30,58,138],v=[241,245,249];let x=null;if(a.logoUrl)try{x=await HH(a.logoUrl)}catch(W){console.error("Error loading logo:",W)}if(x)try{n.addImage(x,"PNG",c,f,40,15),f+=20}catch{n.setFontSize(16),n.setFont("helvetica","bold"),n.setTextColor(...m),n.text(r?.name||"Company Name",c,f+10),f+=20}else n.setFontSize(16),n.setFont("helvetica","bold"),n.setTextColor(...m),n.text(r?.name||"Company Name",c,f+10),f+=20;n.setFontSize(20),n.setFont("helvetica","bold"),n.setTextColor(0,0,0),n.text("CHANGE ORDER REQUEST",c,f),f+=10,n.setFontSize(12),n.setFont("helvetica","normal"),n.setTextColor(100,100,100),n.text(t.cor_number||"COR-XXXX",c,f);const g=t.status?.replace("_"," ").toUpperCase()||"DRAFT";n.setTextColor(...m),n.text(g,s-c-n.getTextWidth(g),f),f+=12,n.setDrawColor(...m),n.setLineWidth(.5),n.line(c,f,s-c,f),f+=10,n.setFontSize(10),n.setTextColor(0,0,0);const b=c,_=s/2;n.setFont("helvetica","bold"),n.text("Project:",b,f),n.setFont("helvetica","normal"),n.text(e?.name||"Project Name",b+25,f),n.setFont("helvetica","bold"),n.text("Job #:",_,f),n.setFont("helvetica","normal"),n.text(e?.job_number||"N/A",_+25,f),f+=6,n.setFont("helvetica","bold"),n.text("Period:",b,f),n.setFont("helvetica","normal"),n.text(Y2(t.period_start,t.period_end),b+25,f),n.setFont("helvetica","bold"),n.text("Date:",_,f),n.setFont("helvetica","normal"),n.text(uc(t.created_at),_+25,f),f+=10,n.setFont("helvetica","bold"),n.setFontSize(12),n.text(t.title||"Untitled Change Order",c,f),f+=8,n.setFont("helvetica","normal"),n.setFontSize(10),n.setTextColor(80,80,80);const w=n.splitTextToSize(t.scope_of_work||"No scope of work provided.",s-c*2);n.text(w,c,f),f+=w.length*5+10,t.change_order_labor?.length>0&&(n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("LABOR",c,f),f+=6,Gd(n,{startY:f,head:[["Class","Type","Reg Hrs","Reg Rate","OT Hrs","OT Rate","Total"]],body:t.change_order_labor.map(W=>[W.labor_class,W.wage_type,W.regular_hours.toString(),`$${Ii(W.regular_rate)}/hr`,W.overtime_hours?.toString()||"-",W.overtime_hours?`$${Ii(W.overtime_rate)}/hr`:"-",Yt(W.total)]),foot:[[{content:`Subtotal: ${Yt(d.labor_subtotal)}`,colSpan:5,styles:{halign:"right",fontStyle:"bold"}},{content:`+${wn(t.labor_markup_percent||1500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Yt(d.labor_subtotal+d.labor_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:c,right:c},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),f=n.lastAutoTable.finalY+10),t.change_order_materials?.length>0&&(f>l-80&&(n.addPage(),f=c),n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("MATERIALS",c,f),f+=6,Gd(n,{startY:f,head:[["Description","Source","Qty","Unit","Unit Cost","Total"]],body:t.change_order_materials.map(W=>[W.description,W.source_reference||W.source_type,W.quantity.toString(),W.unit,`$${Ii(W.unit_cost)}`,Yt(W.total)]),foot:[[{content:`Subtotal: ${Yt(d.materials_subtotal)}`,colSpan:4,styles:{halign:"right",fontStyle:"bold"}},{content:`+${wn(t.materials_markup_percent||1500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Yt(d.materials_subtotal+d.materials_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:c,right:c},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),f=n.lastAutoTable.finalY+10),t.change_order_equipment?.length>0&&(f>l-80&&(n.addPage(),f=c),n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("EQUIPMENT",c,f),f+=6,Gd(n,{startY:f,head:[["Description","Source","Qty","Unit","Unit Cost","Total"]],body:t.change_order_equipment.map(W=>[W.description,W.source_reference||W.source_type,W.quantity.toString(),W.unit,`$${Ii(W.unit_cost)}`,Yt(W.total)]),foot:[[{content:`Subtotal: ${Yt(d.equipment_subtotal)}`,colSpan:4,styles:{halign:"right",fontStyle:"bold"}},{content:`+${wn(t.equipment_markup_percent||1500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Yt(d.equipment_subtotal+d.equipment_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:c,right:c},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),f=n.lastAutoTable.finalY+10),t.change_order_subcontractors?.length>0&&(f>l-80&&(n.addPage(),f=c),n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("SUBCONTRACTORS",c,f),f+=6,Gd(n,{startY:f,head:[["Company","Description","Source","Amount"]],body:t.change_order_subcontractors.map(W=>[W.company_name,W.description,W.source_reference||W.source_type,Yt(W.total)]),foot:[[{content:`Subtotal: ${Yt(d.subcontractors_subtotal)}`,colSpan:2,styles:{halign:"right",fontStyle:"bold"}},{content:`+${wn(t.subcontractors_markup_percent||500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Yt(d.subcontractors_subtotal+d.subcontractors_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:c,right:c},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),f=n.lastAutoTable.finalY+10),f>l-100&&(n.addPage(),f=c),n.setFillColor(...v),n.roundedRect(c,f,s-c*2,70,3,3,"F"),f+=10,n.setFontSize(10),n.setFont("helvetica","normal"),n.setTextColor(0,0,0);const A=c+10,C=s-c-60;n.text("COR Subtotal:",A,f),n.setFont("helvetica","bold"),n.text(Yt(d.cor_subtotal),C,f,{align:"right"}),f+=8,n.setFont("helvetica","normal"),n.setFontSize(9),n.text(`Liability Insurance (${wn(t.liability_insurance_percent||144)}):`,A,f),n.text(Yt(d.liability_insurance_amount),C,f,{align:"right"}),f+=6,n.text(`Bond (${wn(t.bond_percent||100)}):`,A,f),n.text(Yt(d.bond_amount),C,f,{align:"right"}),f+=6,n.text(`City License Fee (${wn(t.license_fee_percent||10)}):`,A,f),n.text(Yt(d.license_fee_amount),C,f,{align:"right"}),f+=10,n.setFillColor(...m),n.roundedRect(A-5,f-3,s-c*2-10,16,2,2,"F"),n.setTextColor(255,255,255),n.setFontSize(12),n.setFont("helvetica","bold"),n.text("COR TOTAL:",A,f+8),n.text(Yt(d.cor_total),C,f+8,{align:"right"}),f+=25,f>l-120&&(n.addPage(),f=c),f+=10,n.setTextColor(0,0,0),n.setFontSize(10),n.setFont("helvetica","bold"),n.text("AUTHORIZATION",c,f),f+=15,n.setFont("helvetica","normal"),n.setFontSize(9),n.setDrawColor(0,0,0);const E=(W,B,q,L,J,D,T)=>{n.setFont("helvetica","bold"),n.setFontSize(8),n.text(B,c,W),n.setFont("helvetica","normal"),n.setFontSize(9);const M=W+20;if(n.line(c,M,c+70,M),n.text("Signature",c,M+8),n.line(c+85,M,c+145,M),n.text("Title / Company",c+85,M+8),n.line(s-c-40,M,s-c,M),n.text("Date",s-c-40,M+8),q)try{if(n.addImage(q,"PNG",c,M-18,60,18),L&&(n.setFontSize(8),n.text(L,c,M+15)),J||D){const V=[J,D].filter(Boolean).join(" - ");n.text(V,c+85,M-5)}T&&n.text(uc(T),s-c-40,M-5)}catch(V){console.error("Error adding signature:",V)}return M+25};f=E(f,"GC AUTHORIZATION",t.gc_signature_data||t.gc_signature,t.gc_signature_name||t.gc_signer_name,t.gc_signature_title,t.gc_signature_company,t.gc_signature_date||t.signed_at),f+=10,f=E(f,"CLIENT AUTHORIZATION",t.client_signature_data,t.client_signature_name,t.client_signature_title,t.client_signature_company,t.client_signature_date);const R=l-10;n.setFontSize(8),n.setTextColor(150,150,150),n.text(`Generated on ${new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`,c,R),n.text("Page 1",s-c,R,{align:"right"});const Y=`${t.cor_number||"COR"}_${e?.job_number||"export"}.pdf`;n.save(Y)}function WH({onSave:t,onClose:e,signerName:r=""}){const a=ne.useRef(null),[n,s]=ne.useState(r),[l,c]=ne.useState(!1),[f,d]=ne.useState(!1),m=()=>{const C=a.current;return C?C.getContext("2d"):null},v=C=>{const E=a.current;if(!E)return{x:0,y:0};const R=E.getBoundingClientRect(),Y=E.width/R.width,W=E.height/R.height,B=C.touches?C.touches[0].clientX:C.clientX,q=C.touches?C.touches[0].clientY:C.clientY;return{x:(B-R.left)*Y,y:(q-R.top)*W}},x=C=>{C.preventDefault();const E=m();if(!E)return;const{x:R,y:Y}=v(C);E.beginPath(),E.moveTo(R,Y),d(!0),c(!0)},g=C=>{if(!f)return;C.preventDefault();const E=m();if(!E)return;const{x:R,y:Y}=v(C);E.lineTo(R,Y),E.stroke()},b=()=>{d(!1)},_=()=>{const C=a.current,E=m();!C||!E||(E.clearRect(0,0,C.width,C.height),c(!1))},w=C=>{if(!C)return;a.current=C;const E=C.getContext("2d");E.strokeStyle="#1e293b",E.lineWidth=2,E.lineCap="round",E.lineJoin="round"},A=()=>{if(!l||!n.trim())return;const C=a.current;if(!C)return;const E=C.toDataURL("image/png");t({signature:E,signerName:n.trim(),signedAt:new Date().toISOString()})};return o.jsx("div",{className:"modal-overlay",onClick:e,role:"dialog","aria-modal":"true","aria-labelledby":"signature-title",children:o.jsxs("div",{className:"modal-content signature-modal",onClick:C=>C.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{id:"signature-title",children:"GC Signature"}),o.jsx("button",{className:"close-btn",onClick:e,"aria-label":"Close signature modal",children:o.jsx(fh,{size:20,"aria-hidden":"true"})})]}),o.jsxs("div",{className:"modal-body signature-body",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"signer-name",children:"Signer Name *"}),o.jsx("input",{id:"signer-name",type:"text",value:n,onChange:C=>s(C.target.value),placeholder:"Enter full name","aria-required":"true"})]}),o.jsxs("div",{className:"signature-area",children:[o.jsxs("div",{className:"signature-label",id:"signature-instructions",children:[o.jsx(G4,{size:16,"aria-hidden":"true"}),o.jsx("span",{children:"Sign below"})]}),o.jsxs("div",{className:"signature-canvas-container",children:[o.jsx("canvas",{ref:w,width:500,height:200,className:"signature-canvas",onMouseDown:x,onMouseMove:g,onMouseUp:b,onMouseLeave:b,onTouchStart:x,onTouchMove:g,onTouchEnd:b,role:"img","aria-label":"Signature drawing area. Use mouse or touch to draw your signature.","aria-describedby":"signature-instructions",tabIndex:0}),!l&&o.jsx("div",{className:"signature-placeholder",children:"Sign here"})]}),o.jsxs("button",{className:"btn btn-ghost btn-small",onClick:_,disabled:!l,"aria-label":"Clear signature",children:[o.jsx(X4,{size:14,"aria-hidden":"true"})," Clear"]})]}),o.jsx("p",{className:"signature-legal",role:"note",children:"By signing above, I acknowledge that I have reviewed and approve this Change Order Request."})]}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{className:"btn btn-secondary",onClick:e,"aria-label":"Cancel and close",children:"Cancel"}),o.jsxs("button",{className:"btn btn-primary",onClick:A,disabled:!l||!n.trim(),"aria-label":"Save signature",children:[o.jsx(A0,{size:16,"aria-hidden":"true"})," Save Signature"]})]})]})})}function VH({cor:t,project:e,company:r,areas:a,onClose:n,onEdit:s,onShowToast:l,onStatusChange:c}){const[f,d]=ne.useState(!0),[m,v]=ne.useState(t),[x,g]=ne.useState(!1),[b,_]=ne.useState(!1);ne.useEffect(()=>{(async()=>{try{const T=await ot.getCORById(t.id);T&&v(T)}catch(T){console.error("Error fetching COR details:",T),l?.("Error loading COR details","error")}finally{d(!1)}})()},[t.id]);const w=ne.useMemo(()=>E1(m),[m]),A=xj(m.status),C=m.status==="pending_approval",E=m.status==="draft",R=D=>a?.find(M=>M.id===D)?.name||null,Y=async()=>{if(confirm("Approve this change order request?")){d(!0);try{await ot.approveCOR(m.id),v({...m,status:"approved",approved_at:new Date().toISOString()}),l?.("COR approved","success"),c?.()}catch(D){console.error("Error approving COR:",D),l?.("Error approving COR","error")}finally{d(!1)}}},W=async()=>{const D=prompt("Enter rejection reason (optional):");if(D!==null){d(!0);try{await ot.rejectCOR(m.id,D),v({...m,status:"rejected",rejection_reason:D}),l?.("COR rejected","success"),c?.()}catch(T){console.error("Error rejecting COR:",T),l?.("Error rejecting COR","error")}finally{d(!1)}}},B=async()=>{if(confirm("Mark this COR as billed?")){d(!0);try{await ot.markCORAsBilled(m.id),v({...m,status:"billed"}),l?.("COR marked as billed","success"),c?.()}catch(D){console.error("Error marking COR as billed:",D),l?.("Error updating status","error")}finally{d(!1)}}},q=async D=>{d(!0);try{await ot.saveCORSignature?.(m.id,{gc_signature:D.signature,gc_signer_name:D.signerName,signed_at:D.signedAt}),v({...m,gc_signature:D.signature,gc_signer_name:D.signerName,signed_at:D.signedAt}),g(!1),l?.("Signature saved","success"),c?.()}catch(T){console.error("Error saving signature:",T),l?.("Error saving signature","error")}finally{d(!1)}},L=m.status==="approved"&&!m.gc_signature,J=async()=>{try{l?.("Generating PDF...","info"),await $H(m,e,r),l?.("PDF downloaded","success")}catch(D){console.error("Error exporting PDF:",D),l?.("Error generating PDF","error")}};return f?o.jsx("div",{className:"modal-overlay",onClick:n,children:o.jsx("div",{className:"modal-content cor-detail-modal",onClick:D=>D.stopPropagation(),children:o.jsx("div",{className:"cor-detail-loading",children:"Loading COR details..."})})}):o.jsxs("div",{className:"modal-overlay",onClick:n,role:"dialog","aria-modal":"true","aria-labelledby":"cor-detail-title",children:[o.jsxs("div",{className:"modal-content cor-detail-modal",onClick:D=>D.stopPropagation(),children:[o.jsxs("div",{className:"modal-header cor-detail-header",children:[o.jsxs("div",{className:"cor-detail-title-row",children:[o.jsxs("div",{children:[o.jsx("div",{className:"cor-detail-number",children:m.cor_number}),o.jsx("h2",{id:"cor-detail-title",children:m.title||"Untitled COR"})]}),o.jsx("button",{className:"close-btn",onClick:n,"aria-label":"Close COR details",children:o.jsx(fh,{size:20,"aria-hidden":"true"})})]}),o.jsxs("div",{className:"cor-detail-meta",children:[o.jsx("span",{className:"cor-detail-status",style:{backgroundColor:A.bgColor,color:A.color},children:A.label}),R(m.area_id)&&o.jsx("span",{className:"cor-detail-area",children:R(m.area_id)}),o.jsxs("span",{className:"cor-detail-period",children:[o.jsx(Hp,{size:14})," ",Y2(m.period_start,m.period_end)]})]})]}),o.jsxs("div",{className:"modal-body cor-detail-body",children:[o.jsxs("div",{className:"cor-detail-section",children:[o.jsxs("h3",{children:[o.jsx(El,{size:18})," Scope of Work"]}),o.jsx("p",{className:"cor-scope-text",children:m.scope_of_work||"No scope of work provided."})]}),o.jsxs("div",{className:"cor-detail-section pricing-breakdown",children:[o.jsxs("h3",{children:[o.jsx($p,{size:18})," Pricing Breakdown"]}),o.jsxs("div",{className:"pricing-category",children:[o.jsxs("div",{className:"category-header",children:[o.jsxs("div",{className:"category-title",children:[o.jsx(Z4,{size:16}),o.jsx("span",{children:"Labor"})]}),o.jsx("span",{className:"category-subtotal",children:Yt(w.labor_subtotal)})]}),m.change_order_labor?.length>0?o.jsx("div",{className:"category-items",children:o.jsxs("table",{className:"pricing-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Class"}),o.jsx("th",{children:"Type"}),o.jsx("th",{children:"Reg Hrs"}),o.jsx("th",{children:"Reg Rate"}),o.jsx("th",{children:"OT Hrs"}),o.jsx("th",{children:"OT Rate"}),o.jsx("th",{className:"text-right",children:"Total"})]})}),o.jsx("tbody",{children:m.change_order_labor.map((D,T)=>o.jsxs("tr",{children:[o.jsx("td",{children:D.labor_class}),o.jsx("td",{children:D.wage_type}),o.jsx("td",{children:D.regular_hours}),o.jsxs("td",{children:["$",Ii(D.regular_rate),"/hr"]}),o.jsx("td",{children:D.overtime_hours||"-"}),o.jsx("td",{children:D.overtime_hours?`$${Ii(D.overtime_rate)}/hr`:"-"}),o.jsx("td",{className:"text-right",children:Yt(D.total)})]},T))})]})}):o.jsx("div",{className:"category-empty",children:"No labor items"}),o.jsxs("div",{className:"category-markup",children:[o.jsxs("span",{children:["Markup (",wn(m.labor_markup_percent||1500),")"]}),o.jsxs("span",{children:["+",Yt(w.labor_markup_amount)]})]})]}),o.jsxs("div",{className:"pricing-category",children:[o.jsxs("div",{className:"category-header",children:[o.jsxs("div",{className:"category-title",children:[o.jsx(Af,{size:16}),o.jsx("span",{children:"Materials"})]}),o.jsx("span",{className:"category-subtotal",children:Yt(w.materials_subtotal)})]}),m.change_order_materials?.length>0?o.jsx("div",{className:"category-items",children:o.jsxs("table",{className:"pricing-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Description"}),o.jsx("th",{children:"Source"}),o.jsx("th",{children:"Qty"}),o.jsx("th",{children:"Unit"}),o.jsx("th",{children:"Unit Cost"}),o.jsx("th",{className:"text-right",children:"Total"})]})}),o.jsx("tbody",{children:m.change_order_materials.map((D,T)=>o.jsxs("tr",{children:[o.jsx("td",{children:D.description}),o.jsx("td",{children:D.source_reference||D.source_type}),o.jsx("td",{children:D.quantity}),o.jsx("td",{children:D.unit}),o.jsxs("td",{children:["$",Ii(D.unit_cost)]}),o.jsx("td",{className:"text-right",children:Yt(D.total)})]},T))})]})}):o.jsx("div",{className:"category-empty",children:"No material items"}),o.jsxs("div",{className:"category-markup",children:[o.jsxs("span",{children:["Markup (",wn(m.materials_markup_percent||1500),")"]}),o.jsxs("span",{children:["+",Yt(w.materials_markup_amount)]})]})]}),o.jsxs("div",{className:"pricing-category",children:[o.jsxs("div",{className:"category-header",children:[o.jsxs("div",{className:"category-title",children:[o.jsx(m1,{size:16}),o.jsx("span",{children:"Equipment"})]}),o.jsx("span",{className:"category-subtotal",children:Yt(w.equipment_subtotal)})]}),m.change_order_equipment?.length>0?o.jsx("div",{className:"category-items",children:o.jsxs("table",{className:"pricing-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Description"}),o.jsx("th",{children:"Source"}),o.jsx("th",{children:"Qty"}),o.jsx("th",{children:"Unit"}),o.jsx("th",{children:"Unit Cost"}),o.jsx("th",{className:"text-right",children:"Total"})]})}),o.jsx("tbody",{children:m.change_order_equipment.map((D,T)=>o.jsxs("tr",{children:[o.jsx("td",{children:D.description}),o.jsx("td",{children:D.source_reference||D.source_type}),o.jsx("td",{children:D.quantity}),o.jsx("td",{children:D.unit}),o.jsxs("td",{children:["$",Ii(D.unit_cost)]}),o.jsx("td",{className:"text-right",children:Yt(D.total)})]},T))})]})}):o.jsx("div",{className:"category-empty",children:"No equipment items"}),o.jsxs("div",{className:"category-markup",children:[o.jsxs("span",{children:["Markup (",wn(m.equipment_markup_percent||1500),")"]}),o.jsxs("span",{children:["+",Yt(w.equipment_markup_amount)]})]})]}),o.jsxs("div",{className:"pricing-category",children:[o.jsxs("div",{className:"category-header",children:[o.jsxs("div",{className:"category-title",children:[o.jsx(E0,{size:16}),o.jsx("span",{children:"Subcontractors"})]}),o.jsx("span",{className:"category-subtotal",children:Yt(w.subcontractors_subtotal)})]}),m.change_order_subcontractors?.length>0?o.jsx("div",{className:"category-items",children:o.jsxs("table",{className:"pricing-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Company"}),o.jsx("th",{children:"Description"}),o.jsx("th",{children:"Source"}),o.jsx("th",{className:"text-right",children:"Amount"})]})}),o.jsx("tbody",{children:m.change_order_subcontractors.map((D,T)=>o.jsxs("tr",{children:[o.jsx("td",{children:D.company_name}),o.jsx("td",{children:D.description}),o.jsx("td",{children:D.source_reference||D.source_type}),o.jsx("td",{className:"text-right",children:Yt(D.total)})]},T))})]})}):o.jsx("div",{className:"category-empty",children:"No subcontractor items"}),o.jsxs("div",{className:"category-markup",children:[o.jsxs("span",{children:["Markup (",wn(m.subcontractors_markup_percent||500),")"]}),o.jsxs("span",{children:["+",Yt(w.subcontractors_markup_amount)]})]})]}),o.jsxs("div",{className:"cor-subtotal-row",children:[o.jsx("span",{children:"COR Subtotal"}),o.jsx("span",{children:Yt(w.cor_subtotal)})]}),o.jsxs("div",{className:"pricing-category fees-category",children:[o.jsxs("div",{className:"category-header",children:[o.jsxs("div",{className:"category-title",children:[o.jsx(xT,{size:16}),o.jsx("span",{children:"Additional Fees"})]}),o.jsx("span",{className:"category-subtotal",children:Yt(w.additional_fees_total)})]}),o.jsxs("div",{className:"fees-list",children:[o.jsxs("div",{className:"fee-row",children:[o.jsxs("div",{className:"fee-label",children:[o.jsx(J4,{size:14}),o.jsxs("span",{children:["Liability Insurance (",wn(m.liability_insurance_percent||144),")"]})]}),o.jsx("span",{className:"fee-amount",children:Yt(w.liability_insurance_amount)})]}),o.jsxs("div",{className:"fee-row",children:[o.jsxs("div",{className:"fee-label",children:[o.jsx(El,{size:14}),o.jsxs("span",{children:["Bond (",wn(m.bond_percent||100),")"]})]}),o.jsx("span",{className:"fee-amount",children:Yt(w.bond_amount)})]}),o.jsxs("div",{className:"fee-row",children:[o.jsxs("div",{className:"fee-label",children:[o.jsx(Zx,{size:14}),o.jsxs("span",{children:["City License Fee (",wn(m.license_fee_percent||10),")"]})]}),o.jsx("span",{className:"fee-amount",children:Yt(w.license_fee_amount)})]})]})]}),o.jsxs("div",{className:"cor-total-row",children:[o.jsx("span",{children:"COR TOTAL"}),o.jsx("span",{children:Yt(w.cor_total)})]})]}),(m.gc_signature_data||m.gc_signature||m.client_signature_data)&&o.jsxs("div",{className:"cor-detail-section signature-section",children:[o.jsxs("h3",{children:[o.jsx(CT,{size:18})," Signatures"]}),o.jsxs("div",{className:"dual-signatures",children:[(m.gc_signature_data||m.gc_signature)&&o.jsxs("div",{className:"signature-block",children:[o.jsx("span",{className:"signature-label",children:"GC Authorization"}),o.jsxs("div",{className:"signature-display",children:[o.jsx("img",{src:m.gc_signature_data||m.gc_signature,alt:"GC Signature",className:"signature-image"}),o.jsxs("div",{className:"signature-info",children:[o.jsx("span",{className:"signer-name",children:m.gc_signature_name||m.gc_signer_name}),(m.gc_signature_title||m.gc_signature_company)&&o.jsxs("span",{className:"signer-org",children:[m.gc_signature_title,m.gc_signature_title&&m.gc_signature_company&&" - ",m.gc_signature_company]}),o.jsxs("span",{className:"signed-date",children:["Signed: ",uc(m.gc_signature_date||m.signed_at)]})]})]})]}),m.client_signature_data&&o.jsxs("div",{className:"signature-block",children:[o.jsx("span",{className:"signature-label",children:"Client Authorization"}),o.jsxs("div",{className:"signature-display",children:[o.jsx("img",{src:m.client_signature_data,alt:"Client Signature",className:"signature-image"}),o.jsxs("div",{className:"signature-info",children:[o.jsx("span",{className:"signer-name",children:m.client_signature_name}),(m.client_signature_title||m.client_signature_company)&&o.jsxs("span",{className:"signer-org",children:[m.client_signature_title,m.client_signature_title&&m.client_signature_company&&" - ",m.client_signature_company]}),o.jsxs("span",{className:"signed-date",children:["Signed: ",uc(m.client_signature_date)]})]})]})]})]})]}),m.status==="rejected"&&m.rejection_reason&&o.jsxs("div",{className:"cor-detail-section rejection-section",children:[o.jsxs("h3",{children:[o.jsx(Qb,{size:18})," Rejection Reason"]}),o.jsx("p",{className:"rejection-text",children:m.rejection_reason})]})]}),o.jsxs("div",{className:"modal-footer cor-detail-footer",children:[o.jsxs("div",{className:"footer-info",children:[o.jsxs("span",{children:["Created: ",uc(m.created_at)]}),m.approved_at&&o.jsxs("span",{children:["Approved: ",uc(m.approved_at)]})]}),o.jsxs("div",{className:"footer-actions",role:"group","aria-label":"COR actions",children:[E&&o.jsxs("button",{className:"btn btn-secondary",onClick:()=>s?.(m),disabled:f,"aria-label":"Edit this COR",children:[o.jsx(e2,{size:16,"aria-hidden":"true"})," Edit"]}),C&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{className:"btn btn-danger",onClick:W,disabled:f,"aria-label":"Reject this COR",children:[o.jsx(Qb,{size:16,"aria-hidden":"true"})," Reject"]}),o.jsxs("button",{className:"btn btn-success",onClick:Y,disabled:f,"aria-label":"Approve this COR",children:[o.jsx($d,{size:16,"aria-hidden":"true"})," Approve"]})]}),L&&o.jsxs("button",{className:"btn btn-success",onClick:()=>g(!0),disabled:f,"aria-label":"Get GC signature for this COR",children:[o.jsx(mT,{size:16,"aria-hidden":"true"})," Get GC Signature"]}),(m.status==="approved"||m.status==="pending_approval")&&o.jsxs("button",{className:"btn btn-secondary",onClick:()=>_(!0),disabled:f,"aria-label":"Get shareable signature link",children:[o.jsx(Qx,{size:16,"aria-hidden":"true"})," Get Signature Link"]}),m.status==="approved"&&o.jsxs("button",{className:"btn btn-primary",onClick:B,disabled:f,"aria-label":"Mark this COR as billed",children:[o.jsx($p,{size:16,"aria-hidden":"true"})," Mark Billed"]}),o.jsxs("button",{className:"btn btn-secondary",onClick:J,"aria-label":"Export COR to PDF",children:[o.jsx(ZC,{size:16,"aria-hidden":"true"})," Export PDF"]})]})]})]}),x&&o.jsx(WH,{onSave:q,onClose:()=>g(!1),signerName:""}),b&&o.jsx(r3,{documentType:"cor",documentId:m.id,companyId:r?.id,projectId:e?.id,documentTitle:`COR ${m.cor_number}: ${m.title||"Untitled"}`,onClose:()=>_(!1),onShowToast:l})]})}function GH({company:t,onShowToast:e,navigateToProjectId:r,onProjectNavigated:a}){const[n,s]=ne.useState([]),[l,c]=ne.useState([]),[f,d]=ne.useState(null),[m,v]=ne.useState([]),[x,g]=ne.useState(!0),[b,_]=ne.useState(!1),[w,A]=ne.useState(null),[C,E]=ne.useState(!1),[R,Y]=ne.useState(!1),[W,B]=ne.useState(!1),[q,L]=ne.useState("overview"),[J,D]=ne.useState([]),[T,M]=ne.useState(!1),[V,ie]=ne.useState(null),[X,Z]=ne.useState(!1),[K,re]=ne.useState(null),[de,U]=ne.useState(0);ne.useEffect(()=>{t?.id&&(F(),k())},[t?.id]);const k=async()=>{try{const et=await ot.getDumpSites(t.id);D(et||[])}catch(et){console.error("Error loading dump sites:",et)}};ne.useEffect(()=>{if(r&&n.length>0){const et=n.find(ht=>ht.id===r);et&&(d(et),a?.())}},[r,n]),ne.useEffect(()=>{if(f){I(f.id);const et=ot.subscribeToAreas(f.id,ht=>{I(f.id)});return()=>ot.unsubscribe(et)}},[f]);const F=async()=>{try{const et=await ot.getProjects(t?.id);s(et);const ht=await Promise.all(et.map(async yt=>{const ft=await ot.getAreas(yt.id),pt=await ot.getTMTickets(yt.id),wt=await ot.getChangeOrderTotals(yt.id),Lt=await ot.getDailyReports(yt.id,100),Pt=await ot.getInjuryReports(yt.id),zt=await ot.getMaterialRequests(yt.id),Ce=await ot.calculateManDayCosts(yt.id,t?.id,yt.work_type||"demolition",yt.job_type||"standard"),Ve=await ot.calculateHaulOffCosts(yt.id),ce=mx(ft),Re=wt?.totalApprovedValue||0,Me=yt.contract_value+Re,Tt=ce/100*Me,$t=pt.filter(mr=>mr.status==="pending").length,or=new Date;or.setDate(or.getDate()-7);const Ht=Lt.filter(mr=>new Date(mr.report_date)>=or).length;return{...yt,areas:ft,progress:ce,billable:Tt,changeOrderValue:Re,revisedContractValue:Me,changeOrderPending:wt?.pendingCount||0,totalTickets:pt.length,pendingTickets:$t,approvedTickets:pt.filter(mr=>mr.status==="approved").length,dailyReportsCount:Lt.length,recentDailyReports:Ht,injuryReportsCount:Pt.length,lastDailyReport:Lt[0]?.report_date||null,pendingMaterialRequests:zt.filter(mr=>mr.status==="pending").length,totalMaterialRequests:zt.length,laborCost:Ce?.totalCost||0,laborDaysWorked:Ce?.byDate?.length||0,laborManDays:Ce?.totalManDays||0,avgDailyBurn:Ce?.byDate?.length>0?Ce.totalCost/Ce.byDate.length:0,haulOffCost:Ve?.totalCost||0,haulOffLoads:Ve?.totalLoads||0,haulOffDays:Ve?.daysWithHaulOff||0,haulOffByType:Ve?.byWasteType||{},totalBurn:(Ce?.totalCost||0)+(Ve?.totalCost||0),totalBurnDays:Math.max(Ce?.byDate?.length||0,Ve?.daysWithHaulOff||0)}}));c(ht)}catch(et){console.error("Error loading projects:",et),e("Error loading projects","error")}finally{g(!1)}},I=async et=>{try{const ht=await ot.getAreas(et);v(ht)}catch(ht){console.error("Error loading areas:",ht)}},z=et=>{d(et)},te=()=>{d(null),v([]),_(!1),A(null),L("overview"),F()},se=()=>{A({name:f.name,job_number:f.job_number||"",address:f.address||"",general_contractor:f.general_contractor||"",client_contact:f.client_contact||"",client_phone:f.client_phone||"",contract_value:f.contract_value,work_type:f.work_type||"demolition",job_type:f.job_type||"standard",pin:f.pin||"",default_dump_site_id:f.default_dump_site_id||"",areas:m.map(et=>({id:et.id,name:et.name,weight:et.weight,isNew:!1}))}),_(!0)},pe=()=>{_(!1),A(null)},ve=(et,ht)=>{A(yt=>({...yt,[et]:ht}))},_e=(et,ht,yt)=>{A(ft=>({...ft,areas:ft.areas.map((pt,wt)=>wt===et?{...pt,[ht]:yt}:pt)}))},Pe=()=>{A(et=>({...et,areas:[...et.areas,{id:null,name:"",weight:"",isNew:!0}]}))},fe=et=>{w.areas.length>1&&A(ht=>({...ht,areas:ht.areas.filter((yt,ft)=>ft!==et)}))},st=async()=>{if(!w.name.trim()){e("Please enter a project name","error");return}const et=parseFloat(w.contract_value);if(!et||et<=0){e("Please enter a valid contract value","error");return}if(w.pin&&w.pin.length!==4){e("PIN must be 4 digits","error");return}if(w.pin&&w.pin!==f.pin&&!await ot.isPinAvailable(w.pin,f.id)){e("This PIN is already in use","error");return}const ht=w.areas.filter(ft=>ft.name.trim()&&parseFloat(ft.weight)>0);if(ht.length===0){e("Please add at least one area","error");return}if(ht.reduce((ft,pt)=>ft+parseFloat(pt.weight),0)!==100){e("Area weights must total 100%","error");return}E(!0);try{await ot.updateProject(f.id,{name:w.name.trim(),job_number:w.job_number?.trim()||null,address:w.address?.trim()||null,general_contractor:w.general_contractor?.trim()||null,client_contact:w.client_contact?.trim()||null,client_phone:w.client_phone?.trim()||null,contract_value:et,work_type:w.work_type||"demolition",job_type:w.job_type||"standard",pin:w.pin||null,default_dump_site_id:w.default_dump_site_id||null});const ft=m.map(Lt=>Lt.id),pt=w.areas.filter(Lt=>Lt.id).map(Lt=>Lt.id);for(const Lt of ft)pt.includes(Lt)||await ot.deleteArea(Lt);for(let Lt=0;Lt<ht.length;Lt++){const Pt=ht[Lt];Pt.id?await ot.updateArea(Pt.id,{name:Pt.name.trim(),weight:parseFloat(Pt.weight),sort_order:Lt}):await ot.createArea({project_id:f.id,name:Pt.name.trim(),weight:parseFloat(Pt.weight),status:"not_started",sort_order:Lt})}const wt=await ot.getProject(f.id);d(wt),await I(f.id),_(!1),A(null),e("Project updated!","success")}catch(ft){console.error("Error saving project:",ft?.message||ft),e(ft?.message||"Error saving changes","error")}finally{E(!1)}},mt=async()=>{if(confirm("Are you sure you want to delete this project? This cannot be undone."))try{await ot.deleteProject(f.id),e("Project deleted","success"),te()}catch(et){console.error("Error deleting project:",et),e("Error deleting project","error")}};if(x)return o.jsxs("div",{className:"loading",children:[o.jsx("div",{className:"spinner"}),"Loading projects..."]});if(f){const et=mx(m),ht=l.find(ce=>ce.id===f.id),yt=ht?.changeOrderValue||0,ft=f.contract_value+yt,pt=et/100*ft;if(b&&w){const ce=w.areas.reduce((Re,Me)=>Re+(parseFloat(Me.weight)||0),0);return o.jsxs("div",{children:[o.jsx("button",{className:"btn btn-secondary btn-small",onClick:pe,style:{marginBottom:"1.5rem"},children:" Cancel"}),o.jsx("h1",{children:"Edit Project"}),o.jsx("p",{className:"subtitle",children:"Update project details"}),o.jsxs("div",{className:"card",children:[o.jsx("h3",{children:"Basic Info"}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",style:{flex:2},children:[o.jsx("label",{children:"Project Name *"}),o.jsx("input",{type:"text",value:w.name,onChange:Re=>ve("name",Re.target.value),placeholder:"e.g., Downtown Office Demolition"})]}),o.jsxs("div",{className:"form-group",style:{flex:1},children:[o.jsx("label",{children:"Job Number"}),o.jsx("input",{type:"text",value:w.job_number,onChange:Re=>ve("job_number",Re.target.value),placeholder:"e.g., 2024-001"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Project Address"}),o.jsx("input",{type:"text",value:w.address,onChange:Re=>ve("address",Re.target.value),placeholder:"123 Main St, City, State 12345"})]})]}),o.jsxs("div",{className:"card",children:[o.jsx("h3",{children:"Client & Contractor"}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"General Contractor"}),o.jsx("input",{type:"text",value:w.general_contractor,onChange:Re=>ve("general_contractor",Re.target.value),placeholder:"e.g., ABC Construction"})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Client Contact"}),o.jsx("input",{type:"text",value:w.client_contact,onChange:Re=>ve("client_contact",Re.target.value),placeholder:"Contact name"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Client Phone"}),o.jsx("input",{type:"tel",value:w.client_phone,onChange:Re=>ve("client_phone",Re.target.value),placeholder:"(555) 123-4567"})]})]})]}),o.jsxs("div",{className:"card",children:[o.jsx("h3",{children:"Financials & Settings"}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Contract Value ($) *"}),o.jsx("input",{type:"number",value:w.contract_value,onChange:Re=>ve("contract_value",Re.target.value),placeholder:"0"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Foreman PIN"}),o.jsx("input",{type:"text",value:w.pin,onChange:Re=>ve("pin",Re.target.value.replace(/\D/g,"").slice(0,4)),placeholder:"4 digits",maxLength:4}),o.jsx("span",{className:"form-hint",children:"Used for field crew access"})]})]}),o.jsxs("div",{className:"form-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Work Type"}),o.jsxs("select",{value:w.work_type,onChange:Re=>ve("work_type",Re.target.value),children:[o.jsx("option",{value:"demolition",children:"Demolition"}),o.jsx("option",{value:"environmental",children:"Environmental"})]}),o.jsx("span",{className:"form-hint",children:"Affects labor rate calculations"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Job Type"}),o.jsxs("select",{value:w.job_type,onChange:Re=>ve("job_type",Re.target.value),children:[o.jsx("option",{value:"standard",children:"Standard"}),o.jsx("option",{value:"prevailing_wage",children:"Prevailing Wage"})]})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Default Dump Site"}),o.jsxs("select",{value:w.default_dump_site_id,onChange:Re=>ve("default_dump_site_id",Re.target.value),children:[o.jsx("option",{value:"",children:"-- Select Dump Site --"}),J.map(Re=>o.jsx("option",{value:Re.id,children:Re.name},Re.id))]}),o.jsx("span",{className:"form-hint",children:"Used for haul-off tracking and cost estimates"})]})]}),o.jsxs("div",{className:"card",children:[o.jsx("h3",{children:"Areas"}),o.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",marginBottom:"1rem"},children:"Weights must total 100%."}),w.areas.map((Re,Me)=>o.jsxs("div",{className:"area-row",children:[o.jsx("input",{type:"text",placeholder:"Area name",value:Re.name,onChange:Tt=>_e(Me,"name",Tt.target.value)}),o.jsx("input",{type:"number",placeholder:"%",value:Re.weight,onChange:Tt=>_e(Me,"weight",Tt.target.value)}),o.jsx("button",{className:"remove-btn",onClick:()=>fe(Me),children:""})]},Me)),o.jsxs("div",{className:"weight-total",children:[o.jsx("span",{className:"weight-total-label",children:"Total Weight:"}),o.jsxs("span",{className:`weight-total-value ${ce===100?"valid":"invalid"}`,children:[ce,"%"]})]}),o.jsx("button",{className:"btn btn-secondary",onClick:Pe,children:"+ Add Area"})]}),o.jsx("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem"},children:o.jsx("button",{className:"btn btn-primary",onClick:st,disabled:C,style:{flex:1},children:C?"Saving...":"Save Changes"})}),o.jsx("button",{className:"btn btn-danger btn-full",onClick:mt,children:"Delete Project"})]})}const wt=m.filter(ce=>ce.status==="done").length,Lt=m.filter(ce=>ce.status==="working").length,Pt=m.filter(ce=>ce.status==="not_started").length,zt=ft>0?Math.round(pt/ft*100):0,Ce=yt>0,Ve=[{id:"overview",label:"Overview",Icon:iT},{id:"financials",label:"Financials",Icon:$p},{id:"reports",label:"Reports",Icon:hu},{id:"activity",label:"Activity",Icon:Y0},{id:"info",label:"Info",Icon:V4}];return o.jsxs("div",{className:"project-view tabbed",children:[o.jsxs("div",{className:"pv-sticky-header",children:[o.jsxs("div",{className:"pv-header-row",children:[o.jsxs("button",{className:"pv-back",onClick:te,children:[o.jsx("span",{children:""}),o.jsx("span",{children:"Back"})]}),o.jsxs("div",{className:"pv-actions",children:[o.jsx("button",{className:"pv-action",onClick:()=>Y(!0),children:"Share"}),o.jsx("button",{className:"pv-action",onClick:()=>B(!0),children:"Alerts"}),o.jsx("button",{className:"pv-action",onClick:se,children:"Edit"})]})]}),o.jsxs("div",{className:"pv-header-title",children:[o.jsx("h1",{children:f.name}),(f.job_number||f.work_type)&&o.jsxs("span",{className:"pv-header-meta",children:[f.job_number&&`Job #${f.job_number}`,f.job_number&&f.work_type&&"  ",f.work_type]})]}),o.jsxs("div",{className:"pv-metrics-bar",children:[o.jsxs("div",{className:"pv-metric",children:[o.jsxs("span",{className:"pv-metric-value",children:[et,"%"]}),o.jsx("span",{className:"pv-metric-label",children:"Complete"})]}),o.jsx("div",{className:"pv-metric-divider"}),o.jsxs("div",{className:"pv-metric",children:[o.jsx("span",{className:"pv-metric-value",children:Yn(pt)}),o.jsx("span",{className:"pv-metric-label",children:"Billed"})]}),o.jsx("div",{className:"pv-metric-divider"}),o.jsxs("div",{className:"pv-metric",children:[o.jsx("span",{className:"pv-metric-value highlight",children:Yn(ft-pt)}),o.jsx("span",{className:"pv-metric-label",children:"Remaining"})]})]}),o.jsx("div",{className:"pv-tabs",children:Ve.map(ce=>o.jsxs("button",{className:`pv-tab ${q===ce.id?"active":""}`,onClick:()=>L(ce.id),children:[o.jsx(ce.Icon,{size:16,className:"pv-tab-icon"}),o.jsx("span",{className:"pv-tab-label",children:ce.label})]},ce.id))})]}),o.jsxs("div",{className:"pv-tab-content",children:[q==="overview"&&o.jsxs("div",{className:"pv-tab-panel",children:[o.jsxs("div",{className:"pv-card pv-health-card",children:[o.jsxs("div",{className:"pv-health-header",children:[o.jsxs("div",{className:"pv-health-status",children:[o.jsx("span",{className:`pv-health-indicator ${et>=100?"complete":et>0?"active":"pending"}`}),o.jsx("span",{className:"pv-health-label",children:et>=100?"Complete":et>0?"In Progress":"Not Started"})]}),o.jsxs("div",{className:"pv-health-percent",children:[et,"%"]})]}),o.jsx("div",{className:"pv-health-bar",children:o.jsx("div",{className:"pv-health-fill",style:{width:`${et}%`}})}),o.jsx("div",{className:"pv-health-context",children:o.jsxs("span",{children:[wt," of ",m.length," work areas complete"]})})]}),o.jsxs("div",{className:"pv-card",children:[o.jsxs("div",{className:"pv-card-header",children:[o.jsx("h3",{children:"Work Areas"}),o.jsxs("div",{className:"pv-area-summary",children:[wt>0&&o.jsxs("span",{className:"pv-count done",children:[wt," Complete"]}),Lt>0&&o.jsxs("span",{className:"pv-count working",children:[Lt," Active"]}),Pt>0&&o.jsxs("span",{className:"pv-count pending",children:[Pt," Pending"]})]})]}),o.jsx("div",{className:"pv-areas-grid",children:m.map(ce=>o.jsxs("div",{className:`pv-area-card ${ce.status}`,children:[o.jsxs("div",{className:"pv-area-status",children:[ce.status==="done"&&o.jsx("span",{className:"pv-check",children:""}),ce.status==="working"&&o.jsx("span",{className:"pv-working",children:""}),ce.status==="not_started"&&o.jsx("span",{className:"pv-pending",children:""})]}),o.jsxs("div",{className:"pv-area-info",children:[o.jsx("span",{className:"pv-area-name",children:ce.name}),o.jsxs("span",{className:"pv-area-weight",children:[ce.weight,"% of contract"]})]})]},ce.id))})]}),(ht?.pendingTickets>0||ht?.pendingMaterialRequests>0)&&o.jsxs("div",{className:"pv-card pv-attention-card",children:[o.jsx("h3",{children:"Needs Attention"}),o.jsxs("div",{className:"pv-attention-items",children:[ht?.pendingTickets>0&&o.jsxs("div",{className:"pv-attention-item",onClick:()=>L("financials"),children:[o.jsx("span",{className:"pv-attention-count",children:ht.pendingTickets}),o.jsx("span",{className:"pv-attention-label",children:"T&M tickets awaiting approval"}),o.jsx("span",{className:"pv-attention-arrow",children:""})]}),ht?.pendingMaterialRequests>0&&o.jsxs("div",{className:"pv-attention-item",onClick:()=>L("activity"),children:[o.jsx("span",{className:"pv-attention-count",children:ht.pendingMaterialRequests}),o.jsx("span",{className:"pv-attention-label",children:"Material requests pending review"}),o.jsx("span",{className:"pv-attention-arrow",children:""})]})]})]})]}),q==="financials"&&o.jsxs("div",{className:"pv-tab-panel financials-tab",children:[o.jsx("div",{className:"financials-hero",children:o.jsxs("div",{className:"financials-hero-grid",children:[o.jsxs("div",{className:"fin-metric",children:[o.jsx("div",{className:"fin-metric-label",children:"Contract"}),o.jsx("div",{className:"fin-metric-value",children:Yn(ft)}),Ce&&o.jsxs("div",{className:"fin-metric-detail green",children:["+",Yn(yt)," COs"]})]}),o.jsxs("div",{className:"fin-metric",children:[o.jsx("div",{className:"fin-metric-label",children:"Earned"}),o.jsx("div",{className:"fin-metric-value",children:Yn(pt)}),o.jsx("div",{className:"fin-metric-bar",children:o.jsx("div",{className:"fin-metric-fill",style:{width:`${zt}%`}})})]}),o.jsxs("div",{className:"fin-metric",children:[o.jsx("div",{className:"fin-metric-label",children:"Remaining"}),o.jsx("div",{className:"fin-metric-value green",children:Yn(ft-pt)}),o.jsxs("div",{className:"fin-metric-detail",children:[100-zt,"% left"]})]}),o.jsxs("div",{className:"fin-metric",children:[o.jsx("div",{className:"fin-metric-label",children:"Costs"}),o.jsx("div",{className:"fin-metric-value",children:Yn(ht?.totalBurn||0)}),pt>0&&o.jsxs("div",{className:`fin-metric-detail ${ht?.totalBurn/pt>.6?"warning":""}`,children:[Math.round((ht?.totalBurn||0)/pt*100),"% of revenue"]})]})]})}),o.jsxs("div",{className:"financials-pipeline",children:[o.jsxs("div",{className:"pipeline-header",children:[o.jsx("h2",{children:"Extra Work"}),o.jsxs("div",{className:"pipeline-flow",children:[o.jsx("span",{className:"pipeline-step",children:"T&M Tickets"}),o.jsx("span",{className:"pipeline-arrow",children:""}),o.jsx("span",{className:"pipeline-step active",children:"Change Orders"})]})]}),o.jsxs("div",{className:"pipeline-content",children:[o.jsxs("div",{className:"pipeline-section",children:[o.jsxs("div",{className:"pipeline-section-header",children:[o.jsx("h3",{children:"T&M Tickets"}),o.jsxs("span",{className:"pipeline-badge",children:[ht?.totalTickets||0," total",ht?.pendingTickets>0&&`  ${ht.pendingTickets} pending`]})]}),o.jsx(EH,{project:f,company:t,onShowToast:e})]}),o.jsx("div",{className:"pipeline-section",children:o.jsx(BH,{project:f,company:t,areas:m,refreshKey:de,onShowToast:e,onCreateCOR:()=>{ie(null),M(!0)},onViewCOR:ce=>{re(ce),Z(!0)},onEditCOR:ce=>{ie(ce),M(!0)}})})]})]}),o.jsxs("details",{className:"financials-details",children:[o.jsxs("summary",{className:"financials-details-summary",children:[o.jsx(Ui,{size:16}),o.jsx("span",{children:"Cost Breakdown"}),o.jsx("span",{className:"financials-details-value",children:Yn(ht?.totalBurn||0)})]}),o.jsx("div",{className:"financials-details-content",children:o.jsx(PH,{project:f,company:t,onShowToast:e})})]})]}),q==="reports"&&o.jsxs("div",{className:"pv-tab-panel",children:[o.jsxs("div",{className:"pv-card pv-reports-summary",children:[o.jsx("h3",{children:"Field Documentation Summary"}),o.jsxs("div",{className:"pv-reports-stats",children:[o.jsxs("div",{className:"pv-report-stat",children:[o.jsx("span",{className:"pv-report-stat-value",children:ht?.dailyReportsCount||0}),o.jsx("span",{className:"pv-report-stat-label",children:"Daily Reports Filed"})]}),o.jsxs("div",{className:"pv-report-stat",children:[o.jsx("span",{className:"pv-report-stat-value",children:ht?.recentDailyReports||0}),o.jsx("span",{className:"pv-report-stat-label",children:"Reports This Week"})]}),o.jsxs("div",{className:"pv-report-stat injury",children:[o.jsx("span",{className:"pv-report-stat-value",children:ht?.injuryReportsCount||0}),o.jsx("span",{className:"pv-report-stat-label",children:"Injury Reports"})]})]}),ht?.lastDailyReport&&o.jsxs("div",{className:"pv-last-report",children:["Last report filed: ",new Date(ht.lastDailyReport).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]}),o.jsx(FH,{project:f,company:t,onShowToast:e}),o.jsx(TH,{project:f,companyId:t?.id||f?.company_id,company:t,onShowToast:e})]}),q==="activity"&&o.jsxs("div",{className:"pv-tab-panel",children:[o.jsxs("div",{className:"pv-card pv-activity-summary",children:[o.jsx("h3",{children:"Project Activity Status"}),o.jsxs("div",{className:"pv-activity-stats",children:[o.jsxs("div",{className:`pv-activity-stat ${ht?.pendingMaterialRequests>0?"has-pending":""}`,children:[o.jsx("span",{className:"pv-activity-stat-value",children:ht?.pendingMaterialRequests||0}),o.jsx("span",{className:"pv-activity-stat-label",children:"Pending Requests"})]}),o.jsxs("div",{className:"pv-activity-stat",children:[o.jsx("span",{className:"pv-activity-stat-value",children:ht?.totalMaterialRequests||0}),o.jsx("span",{className:"pv-activity-stat-label",children:"Total Requests"})]})]})]}),o.jsx(RH,{project:f,company:t,onShowToast:e}),o.jsx("div",{className:"pv-messages-full",children:o.jsx(LH,{project:f,company:t,userName:t?.name||"Office",onShowToast:e})})]}),q==="info"&&o.jsxs("div",{className:"pv-tab-panel",children:[o.jsxs("div",{className:"pv-card pv-info-card",children:[o.jsxs("div",{className:"pv-info-header",children:[o.jsx("h3",{children:"Project Details"}),o.jsx("button",{className:"btn btn-secondary btn-sm",onClick:se,children:"Edit Project"})]}),o.jsxs("div",{className:"pv-info-grid",children:[o.jsxs("div",{className:"pv-info-section",children:[o.jsx("div",{className:"pv-info-section-title",children:"Basic Information"}),o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Project Name"}),o.jsx("span",{className:"pv-info-value",children:f.name})]}),f.job_number&&o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Job Number"}),o.jsx("span",{className:"pv-info-value",children:f.job_number})]}),f.address&&o.jsxs("div",{className:"pv-info-row",children:[o.jsxs("span",{className:"pv-info-label",children:[o.jsx(cT,{size:14,className:"pv-info-icon"}),"Address"]}),o.jsx("span",{className:"pv-info-value",children:f.address})]})]}),o.jsxs("div",{className:"pv-info-section",children:[o.jsxs("div",{className:"pv-info-section-title",children:[o.jsx(Zx,{size:16,className:"pv-info-icon"}),"Client & Contractor"]}),f.general_contractor?o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"General Contractor"}),o.jsx("span",{className:"pv-info-value",children:f.general_contractor})]}):o.jsx("div",{className:"pv-info-empty",children:"No general contractor specified"}),f.client_contact&&o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Client Contact"}),o.jsx("span",{className:"pv-info-value",children:f.client_contact})]}),f.client_phone&&o.jsxs("div",{className:"pv-info-row",children:[o.jsxs("span",{className:"pv-info-label",children:[o.jsx(_T,{size:14,className:"pv-info-icon"}),"Phone"]}),o.jsx("a",{href:`tel:${f.client_phone}`,className:"pv-info-value pv-info-link",children:f.client_phone})]})]}),o.jsxs("div",{className:"pv-info-section",children:[o.jsx("div",{className:"pv-info-section-title",children:"Project Settings"}),o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Work Type"}),o.jsx("span",{className:"pv-info-value pv-info-badge",children:f.work_type==="environmental"?"Environmental":"Demolition"})]}),o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Job Type"}),o.jsx("span",{className:"pv-info-value pv-info-badge",children:f.job_type==="prevailing_wage"?"Prevailing Wage":"Standard"})]}),f.pin&&o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Foreman PIN"}),o.jsx("span",{className:"pv-info-value pv-info-mono",children:f.pin})]}),f.default_dump_site_id&&o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Default Dump Site"}),o.jsx("span",{className:"pv-info-value",children:J.find(ce=>ce.id===f.default_dump_site_id)?.name||"Unknown"})]})]}),o.jsxs("div",{className:"pv-info-section",children:[o.jsxs("div",{className:"pv-info-section-title",children:[o.jsx($p,{size:16,className:"pv-info-icon"}),"Contract"]}),o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Original Contract"}),o.jsx("span",{className:"pv-info-value pv-info-currency",children:Yn(f.contract_value)})]}),yt>0&&o.jsxs("div",{className:"pv-info-row",children:[o.jsx("span",{className:"pv-info-label",children:"Change Orders"}),o.jsxs("span",{className:"pv-info-value pv-info-currency positive",children:["+",Yn(yt)]})]}),o.jsxs("div",{className:"pv-info-row pv-info-total",children:[o.jsx("span",{className:"pv-info-label",children:"Current Value"}),o.jsx("span",{className:"pv-info-value pv-info-currency",children:Yn(ft)})]})]})]})]}),o.jsxs("div",{className:"pv-card",children:[o.jsxs("h3",{children:["Work Areas (",m.length,")"]}),o.jsx("div",{className:"pv-info-areas",children:m.map(ce=>o.jsxs("div",{className:`pv-info-area ${ce.status}`,children:[o.jsx("span",{className:"pv-info-area-name",children:ce.name}),o.jsxs("span",{className:"pv-info-area-weight",children:[ce.weight,"%"]}),o.jsx("span",{className:`pv-info-area-status status-badge ${ce.status}`,children:ce.status==="done"?"Complete":ce.status==="working"?"In Progress":"Not Started"})]},ce.id))})]})]})]}),R&&o.jsx(AH,{project:f,onClose:()=>Y(!1),onShareCreated:ce=>{e("Share link created successfully!","success")}}),W&&o.jsx("div",{className:"notification-settings-modal",children:o.jsx(OH,{project:f,company:t,onShowToast:e,onClose:()=>B(!1)})}),T&&o.jsx(qH,{project:f,company:t,areas:m,existingCOR:V,onClose:()=>{M(!1),ie(null)},onSaved:()=>{M(!1),ie(null),U(ce=>ce+1)},onShowToast:e}),X&&K&&o.jsx(VH,{cor:K,project:f,company:t,areas:m,onClose:()=>{Z(!1),re(null)},onEdit:ce=>{Z(!1),re(null),ie(ce),M(!0)},onShowToast:e,onStatusChange:()=>{}})]})}if(n.length===0)return o.jsxs("div",{className:"empty-state",children:[o.jsx(hu,{size:48,className:"empty-state-icon"}),o.jsx("h3",{children:"No Projects Yet"}),o.jsx("p",{children:"Create your first project to get started"})]});const he=l.reduce((et,ht)=>et+(ht.contract_value||0),0),at=l.reduce((et,ht)=>et+(ht.changeOrderValue||0),0),we=he+at,ye=l.reduce((et,ht)=>et+(ht.billable||0),0),Be=we-ye,Et=we>0?Math.round(ye/we*100):0,Xe=l.filter(et=>et.progress>=100).length,lt=l.filter(et=>et.progress<100&&et.billable<=(et.revisedContractValue||et.contract_value)*(et.progress/100)*1.1).length,jt=l.filter(et=>et.billable>(et.revisedContractValue||et.contract_value)*.9&&et.progress<90).length,Dt=l.filter(et=>et.billable>(et.revisedContractValue||et.contract_value)).length,Wt=l.filter(et=>(et.changeOrderValue||0)>0).length;return o.jsxs("div",{children:[o.jsxs("div",{className:"business-overview",children:[o.jsxs("div",{className:"bo-header",children:[o.jsx("h2",{className:"bo-title",children:"Portfolio Overview"}),o.jsxs("div",{className:"bo-project-count",children:[n.length," Active Project",n.length!==1?"s":""]})]}),o.jsxs("div",{className:"bo-financial",children:[o.jsx("div",{className:"bo-progress-bar",children:o.jsx("div",{className:"bo-progress-fill",style:{width:`${Math.min(Et,100)}%`}})}),o.jsxs("div",{className:"bo-financial-row",children:[o.jsxs("div",{className:"bo-metric primary",children:[o.jsx("span",{className:"bo-metric-value",children:Yn(ye)}),o.jsx("span",{className:"bo-metric-label",children:"Earned Revenue"})]}),o.jsx("div",{className:"bo-metric-separator",children:"of"}),o.jsxs("div",{className:"bo-metric primary",children:[o.jsx("span",{className:"bo-metric-value",children:Yn(we)}),o.jsx("span",{className:"bo-metric-label",children:"Total Portfolio"})]}),o.jsxs("div",{className:"bo-metric highlight",children:[o.jsx("span",{className:"bo-metric-value",children:Yn(Be)}),o.jsx("span",{className:"bo-metric-label",children:"Remaining to Bill"})]})]}),at>0&&o.jsxs("div",{className:"bo-change-orders",children:[o.jsxs("div",{className:"bo-co-item",children:[o.jsx("span",{className:"bo-co-label",children:"Original Contracts"}),o.jsx("span",{className:"bo-co-value",children:Yn(he)})]}),o.jsxs("div",{className:"bo-co-item bo-co-added",children:[o.jsxs("span",{className:"bo-co-label",children:["+ Change Orders (",Wt," project",Wt!==1?"s":"",")"]}),o.jsxs("span",{className:"bo-co-value",children:["+",Yn(at)]})]})]})]}),o.jsxs("div",{className:"bo-health",children:[o.jsx("div",{className:"bo-health-title",children:"Project Health"}),o.jsxs("div",{className:"bo-health-pills",children:[Xe>0&&o.jsxs("div",{className:"bo-pill complete",children:[o.jsx("span",{className:"bo-pill-count",children:Xe}),o.jsx("span",{className:"bo-pill-label",children:"Complete"})]}),lt>0&&o.jsxs("div",{className:"bo-pill on-track",children:[o.jsx("span",{className:"bo-pill-count",children:lt}),o.jsx("span",{className:"bo-pill-label",children:"On Track"})]}),jt>0&&o.jsxs("div",{className:"bo-pill at-risk",children:[o.jsx("span",{className:"bo-pill-count",children:jt}),o.jsx("span",{className:"bo-pill-label",children:"At Risk"})]}),Dt>0&&o.jsxs("div",{className:"bo-pill over-budget",children:[o.jsx("span",{className:"bo-pill-count",children:Dt}),o.jsx("span",{className:"bo-pill-label",children:"Over Budget"})]})]})]})]}),o.jsxs("div",{className:"dashboard-header",children:[o.jsx("h2",{children:"Projects"}),o.jsxs("span",{className:"project-count",children:[n.length," active"]})]}),o.jsx("div",{className:"project-list",children:l.map(et=>o.jsx(YH,{project:et,onClick:()=>z(et)},et.id))})]})}function YH({project:t,onClick:e}){const r=Q4(t.areas||[]),a=HT(t.areas||[]),n=t.contract_value-t.billable,s=t.billable>t.contract_value*.9&&t.progress<90;return o.jsxs("div",{className:`project-card enhanced ${s?"at-risk":""}`,onClick:e,children:[o.jsxs("div",{className:"project-card-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"project-card-name",children:t.name}),o.jsx("div",{className:"project-card-value",children:Yn(t.contract_value)})]}),o.jsx("span",{className:`status-badge ${r}`,children:a})]}),o.jsxs("div",{className:"project-stats-row",children:[o.jsxs("div",{className:"project-stat",children:[o.jsxs("span",{className:"stat-value",children:[t.progress,"%"]}),o.jsx("span",{className:"stat-label",children:"Complete"})]}),o.jsxs("div",{className:"project-stat",children:[o.jsx("span",{className:"stat-value",children:Yn(t.billable)}),o.jsx("span",{className:"stat-label",children:"Billable"})]}),o.jsxs("div",{className:"project-stat",children:[o.jsx("span",{className:`stat-value ${n<0?"negative":""}`,children:Yn(Math.abs(n))}),o.jsx("span",{className:"stat-label",children:n>=0?"Remaining":"Over Budget"})]})]}),o.jsx("div",{className:"mini-progress-bar",children:o.jsx("div",{className:"mini-progress-fill",style:{width:`${t.progress}%`}})}),(t.pendingTickets>0||t.totalTickets>0)&&o.jsxs("div",{className:"project-badges",children:[t.pendingTickets>0&&o.jsxs("span",{className:"badge pending",children:[t.pendingTickets," Pending T&M"]}),t.approvedTickets>0&&o.jsxs("span",{className:"badge approved",children:[t.approvedTickets," Approved T&M"]})]})]})}function XH({onProjectCreated:t,onShowToast:e}){const[r,a]=ne.useState(""),[n,s]=ne.useState(""),[l,c]=ne.useState(""),[f,d]=ne.useState(""),[m,v]=ne.useState(""),[x,g]=ne.useState(""),[b,_]=ne.useState("demolition"),[w,A]=ne.useState("standard"),[C,E]=ne.useState([{name:"",weight:"",group:""},{name:"",weight:"",group:""},{name:"",weight:"",group:""}]),[R,Y]=ne.useState(!1),[W,B]=ne.useState(!1),[q,L]=ne.useState(!1),[J,D]=ne.useState([]),T=ne.useRef(null),M=C.reduce((pe,ve)=>pe+(parseFloat(ve.weight)||0),0),V=pe=>{const ve=pe.replace(/\D/g,"").slice(0,4);g(ve)},ie=()=>{const pe=Math.floor(1e3+Math.random()*9e3).toString();g(pe)},X=(pe,ve,_e)=>{E(Pe=>Pe.map((fe,st)=>st===pe?{...fe,[ve]:_e}:fe))},Z=()=>{E(pe=>[...pe,{name:"",weight:"",group:""}])},K=pe=>{C.length>1&&E(ve=>ve.filter((_e,Pe)=>Pe!==pe))},re=()=>{a(""),s(""),c(""),d(""),v(""),g(""),_("demolition"),A("standard"),E([{name:"",weight:"",group:""},{name:"",weight:"",group:""},{name:"",weight:"",group:""}]),L(!1),D([])},de=()=>{T.current?.click()},U=pe=>new Promise((ve,_e)=>{const Pe=new FileReader;Pe.onload=fe=>{try{const st=new Uint8Array(fe.target.result),mt=jx(st,{type:"array"}),he=mt.SheetNames[0],at=mt.Sheets[he],we=nu.sheet_to_json(at,{header:1}),ye=[];let Be="General";const Et=/^\$?\d{1,3}(,\d{3})*(\.\d{2})?$/,Xe=/^(\d+\.?\d*|[A-Z]\.?\d*)$/i,lt=/^(SF|LF|EA|LS|Days?|MD|Load|CY|SY|GAL|TON)$/i,jt=/^\d{1,3}(,\d{3})*$|^\d+$/,Dt=/^(Item|#|No\.?|Description|Scheduled|Value|Amount|Quantity|Unit|Total|Application|Balance|Completed|Stored|Retainage)/i;for(const ht of we){if(!ht||ht.length===0)continue;const yt=ht.map(Ve=>Ve==null?"":String(Ve).trim()).filter(Ve=>Ve.length>0);if(yt.length===0)continue;const ft=yt.join(" ");if(Dt.test(yt[0])||yt.length>1&&Dt.test(yt[1])||/^(Total|Subtotal|Grand Total|Base Bid|Contract Sum)/i.test(ft))continue;const pt=yt.some(Ve=>Et.test(Ve.replace(/[$,]/g,"")+(Ve.includes(".")?"":".00")));if((!pt&&yt.length<=3&&/^(L\d|Level|Floor|\d+(?:st|nd|rd|th)|Plaza|Street|Basement|Roof|Penthouse|Site|Exterior|Interior|Misc|MEP|ABATEMENT|DEMOLITION|UNIVERSAL|SOFT|TRASH|DEMO|Phase|Division|Section|Area|Building|Wing)/i.test(yt[0])||yt.length===2&&Xe.test(yt[0])&&!pt&&!/^\d+\.\d+$/.test(yt[0]))&&!pt){Be=(yt.find(ce=>!Xe.test(ce)&&ce.length>1)||yt.join(" ")).replace(/\s*\(\d{1,3}(?:,\d{3})*\s*SF\)\s*$/i,"").replace(/\s*[-:]\s*$/,"").trim();continue}let Lt="",Pt=!1,zt="";const Ce=[];for(let Ve=0;Ve<yt.length;Ve++){const ce=yt[Ve];if(Ve===0&&Xe.test(ce)){zt=ce;continue}if(!/^ID-\d+$/i.test(ce)&&!/^KN\s*\d+$/i.test(ce)){if(Et.test(ce.replace(/[$,]/g,"")+(ce.includes(".")?"":".00"))||/^\$/.test(ce)){Pt=!0;continue}if(jt.test(ce.replace(/,/g,""))){Pt=!0;continue}lt.test(ce)||/^\d+\.?\d*%$/.test(ce)||ce.length>1&&!Xe.test(ce)&&Ce.push(ce)}}Lt=Ce.join(" ").trim(),Lt=Lt.replace(/\s+/g," ").replace(/^[-]\s*/,"").trim(),!(Lt.length<3)&&(/^(Plan|Page|Total|Base Bid|Payment|Condition|Exclusion|Subtotal)/i.test(Lt)||Pt&&Lt.length>=3&&ye.push({name:Lt,group:Be,itemNumber:zt,selected:!0}))}const Wt=new Set,et=ye.filter(ht=>{const yt=`${ht.group}:${ht.name}`;return Wt.has(yt)?!1:(Wt.add(yt),!0)});ve(et)}catch(st){_e(st)}},Pe.onerror=()=>_e(new Error("Failed to read file")),Pe.readAsArrayBuffer(pe)}),k=async pe=>{const ve=pe.target.files?.[0];if(!ve)return;const _e=ve.name.split(".").pop().toLowerCase();if(!["xlsx","xls","csv"].includes(_e)){e("Please upload an Excel file (.xlsx, .xls, or .csv)","error");return}B(!0);try{const Pe=await U(ve);if(Pe.length===0){e("No tasks found. Check Excel format.","error"),B(!1);return}D(Pe),L(!0),e(`Found ${Pe.length} tasks`,"success")}catch(Pe){console.error("Excel import error:",Pe),e("Error reading Excel file","error")}finally{B(!1),T.current&&(T.current.value="")}},F=pe=>{D(ve=>ve.map((_e,Pe)=>Pe===pe?{..._e,selected:!_e.selected}:_e))},I=()=>{const pe=J.filter(Pe=>Pe.selected);if(pe.length===0){e("Please select at least one task","error");return}const ve=Math.round(100/pe.length*100)/100,_e=pe.map((Pe,fe)=>({name:Pe.name,weight:fe===pe.length-1?(100-ve*(pe.length-1)).toFixed(2):ve.toFixed(2),group:Pe.group}));E(_e),L(!1),e("Tasks imported!","success")},z=async()=>{if(!r.trim()){e("Please enter a project name","error");return}const pe=parseFloat(m);if(!pe||pe<=0){e("Please enter a valid contract value","error");return}if(x.length!==4){e("Please enter a 4-digit PIN","error");return}if(!await ot.isPinAvailable(x)){e("This PIN is already in use. Try another.","error");return}const _e=C.filter(Pe=>Pe.name.trim()&&parseFloat(Pe.weight)>0);if(_e.length===0){e("Please add at least one area","error");return}if(Math.abs(M-100)>.1){e("Area weights must total 100%","error");return}Y(!0);try{const Pe=await ot.createProject({name:r.trim(),job_number:n.trim()||null,address:l.trim()||null,general_contractor:f.trim()||null,contract_value:pe,pin:x,work_type:b,job_type:w});for(let fe=0;fe<_e.length;fe++)await ot.createArea({project_id:Pe.id,name:_e[fe].name.trim(),weight:parseFloat(_e[fe].weight),group_name:_e[fe].group||null,status:"not_started",sort_order:fe});e("Project created!","success"),re(),t()}catch(Pe){console.error("Error creating project:",Pe),e("Error creating project","error")}finally{Y(!1)}};if(q){const pe=[...new Set(J.map(_e=>_e.group))],ve=J.filter(_e=>_e.selected).length;return o.jsxs("div",{children:[o.jsx("h1",{children:"Review Imported Tasks"}),o.jsx("p",{className:"subtitle",children:"Select the tasks to include in your project"}),o.jsx("div",{className:"import-summary",children:o.jsxs("span",{children:[ve," of ",J.length," tasks selected"]})}),pe.map(_e=>{const Pe=J.filter(st=>st.group===_e),fe=Pe.filter(st=>st.selected).length;return o.jsxs("div",{className:"card import-group",children:[o.jsxs("div",{className:"import-group-header",children:[o.jsx("h3",{children:_e}),o.jsxs("span",{className:"import-group-count",children:[fe,"/",Pe.length]})]}),o.jsx("div",{className:"import-task-list",children:Pe.map(st=>{const mt=J.indexOf(st);return o.jsxs("label",{className:"import-task-item",children:[o.jsx("input",{type:"checkbox",checked:st.selected,onChange:()=>F(mt)}),o.jsx("span",{className:"import-task-name",children:st.name})]},mt)})})]},_e)}),o.jsxs("div",{className:"import-actions",children:[o.jsx("button",{className:"btn btn-secondary",onClick:()=>L(!1),children:"Cancel"}),o.jsxs("button",{className:"btn btn-primary",onClick:I,children:["Use Selected Tasks (",ve,")"]})]})]})}const te=C.reduce((pe,ve,_e)=>{const Pe=ve.group||"General";return pe[Pe]||(pe[Pe]=[]),pe[Pe].push({...ve,originalIndex:_e}),pe},{}),se=Object.keys(te).length>1||Object.keys(te).length===1&&!te.General;return o.jsxs("div",{children:[o.jsx("h1",{children:"New Project"}),o.jsx("p",{className:"subtitle",children:"Set up a new project to track"}),o.jsxs("div",{className:"card",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Project Name"}),o.jsx("input",{type:"text",placeholder:"e.g., Sunrise Apartments",value:r,onChange:pe=>a(pe.target.value)})]}),o.jsxs("div",{className:"form-row-2",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Job Number"}),o.jsx("input",{type:"text",placeholder:"e.g., 4032",value:n,onChange:pe=>s(pe.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Contract Value ($)"}),o.jsx("input",{type:"number",placeholder:"e.g., 365000",value:m,onChange:pe=>v(pe.target.value)})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Project Address"}),o.jsx("input",{type:"text",placeholder:"e.g., 123 Main St, Los Angeles, CA 90001",value:l,onChange:pe=>c(pe.target.value)})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"General Contractor"}),o.jsx("input",{type:"text",placeholder:"e.g., ABC Construction Inc.",value:f,onChange:pe=>d(pe.target.value)})]}),o.jsxs("div",{className:"form-row-2",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Work Type"}),o.jsxs("div",{className:"project-type-toggle",children:[o.jsx("button",{type:"button",className:`toggle-btn ${b==="demolition"?"active":""}`,onClick:()=>_("demolition"),children:"Demolition"}),o.jsx("button",{type:"button",className:`toggle-btn ${b==="abatement"?"active":""}`,onClick:()=>_("abatement"),children:"Abatement"})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Job Type"}),o.jsxs("div",{className:"project-type-toggle",children:[o.jsx("button",{type:"button",className:`toggle-btn ${w==="standard"?"active":""}`,onClick:()=>A("standard"),children:"Standard"}),o.jsx("button",{type:"button",className:`toggle-btn ${w==="pla"?"active":""}`,onClick:()=>A("pla"),children:"PLA"})]})]})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Foreman PIN (4 digits)"}),o.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Foremen will enter this PIN to access this project"}),o.jsxs("div",{className:"pin-input-row",children:[o.jsx("input",{type:"text",placeholder:"e.g., 2847",value:x,onChange:pe=>V(pe.target.value),maxLength:4,className:"pin-input"}),o.jsx("button",{type:"button",className:"btn btn-secondary",onClick:ie,children:"Generate"})]})]})]}),o.jsxs("div",{className:"card",children:[o.jsxs("div",{className:"areas-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Areas / Tasks"}),o.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",marginTop:"0.25rem"},children:"Define the areas for this project. Weights must total 100%."})]}),o.jsxs("div",{className:"import-btn-container",children:[o.jsx("input",{ref:T,type:"file",accept:".xlsx,.xls,.csv",onChange:k,style:{display:"none"}}),o.jsx("button",{className:"btn btn-secondary btn-small",onClick:de,disabled:W,children:W?"Reading...":" Import Excel"})]})]}),se?Object.entries(te).map(([pe,ve])=>o.jsxs("div",{className:"area-group",children:[o.jsx("div",{className:"area-group-header",children:pe}),ve.map(_e=>o.jsxs("div",{className:"area-row",children:[o.jsx("input",{type:"text",placeholder:"Task name",value:_e.name,onChange:Pe=>X(_e.originalIndex,"name",Pe.target.value)}),o.jsx("input",{type:"number",placeholder:"%",min:"0",max:"100",value:_e.weight,onChange:Pe=>X(_e.originalIndex,"weight",Pe.target.value)}),o.jsx("button",{className:"remove-btn",onClick:()=>K(_e.originalIndex),children:""})]},_e.originalIndex))]},pe)):C.map((pe,ve)=>o.jsxs("div",{className:"area-row",children:[o.jsx("input",{type:"text",placeholder:"Area name (e.g., Level 1)",value:pe.name,onChange:_e=>X(ve,"name",_e.target.value)}),o.jsx("input",{type:"number",placeholder:"%",min:"0",max:"100",value:pe.weight,onChange:_e=>X(ve,"weight",_e.target.value)}),o.jsx("button",{className:"remove-btn",onClick:()=>K(ve),children:""})]},ve)),o.jsxs("div",{className:"weight-total",children:[o.jsx("span",{className:"weight-total-label",children:"Total Weight:"}),o.jsxs("span",{className:`weight-total-value ${Math.abs(M-100)<.1?"valid":"invalid"}`,children:[M.toFixed(1),"%"]})]}),o.jsx("button",{className:"btn btn-secondary",onClick:Z,children:"+ Add Area"})]}),o.jsx("button",{className:"btn btn-primary btn-full",onClick:z,disabled:R,children:R?"Creating...":"Create Project"})]})}function KH({company:t,onShowToast:e}){const{branding:r,updateBranding:a,uploadBrandingImage:n,loading:s}=uh(),[l,c]=ne.useState(!1),[f,d]=ne.useState(!1),[m,v]=ne.useState(r),[x,g]=ne.useState(""),[b,_]=ne.useState(!1),w=ne.useRef(null),A=ne.useRef(null),C=ne.useRef(null);ne.useEffect(()=>{t?.id&&E()},[t?.id]);const E=async()=>{try{const{data:V,error:ie}=await De.from("companies").select("office_code").eq("id",t.id).single();!ie&&V?.office_code&&g(V.office_code)}catch(V){console.error("Error loading office code:",V)}},R=async()=>{if(confirm("Regenerate office code? Current code will stop working immediately.")){_(!0);try{const V=Math.random().toString(36).substring(2,8).toUpperCase(),{error:ie}=await De.from("companies").update({office_code:V}).eq("id",t.id);if(ie)throw ie;g(V),e?.("Office code regenerated","success")}catch(V){console.error("Error regenerating code:",V),e?.("Error regenerating code","error")}finally{_(!1)}}},Y=()=>{navigator.clipboard.writeText(x),e?.("Office code copied to clipboard","success")},W=t?.subscription_tier||"free",B=["pro","business","enterprise"].includes(W),q=["business","enterprise"].includes(W),L=W==="enterprise",J=(V,ie)=>{v(X=>({...X,[V]:ie}))},D=async(V,ie)=>{if(V){if(V.size>5*1024*1024){e?.("Image must be smaller than 5MB","error");return}if(!V.type.startsWith("image/")){e?.("Please upload an image file","error");return}try{const X=await n(V,ie);X.success?(J(`${ie}_url`,X.url),e?.(`${ie.charAt(0).toUpperCase()+ie.slice(1)} uploaded successfully`,"success")):e?.(X.error||"Failed to upload image","error")}catch(X){console.error("Upload error:",X),e?.("Failed to upload image","error")}}},T=async()=>{try{c(!0);const V=/^#[0-9A-F]{6}$/i;if(!V.test(m.primary_color)){e?.("Primary color must be a valid hex color (e.g., #3B82F6)","error");return}if(!V.test(m.secondary_color)){e?.("Secondary color must be a valid hex color (e.g., #1E40AF)","error");return}const ie=await a(m);ie.success?e?.("Branding settings saved successfully!","success"):e?.(ie.error||"Failed to save branding settings","error")}catch(V){console.error("Save error:",V),e?.("Failed to save branding settings","error")}finally{c(!1)}},M=()=>{f?(document.documentElement.style.setProperty("--primary-color",r.primary_color),document.documentElement.style.setProperty("--secondary-color",r.secondary_color),document.title=r.custom_app_name||"FieldSync"):(document.documentElement.style.setProperty("--primary-color",m.primary_color),document.documentElement.style.setProperty("--secondary-color",m.secondary_color),document.title=m.custom_app_name||"FieldSync"),d(!f)};return s?o.jsxs("div",{className:"settings-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading branding settings..."})]}):o.jsxs("div",{className:"branding-settings",children:[o.jsxs("div",{className:"settings-header",children:[o.jsx("h2",{children:" Branding Settings"}),W==="free"&&o.jsx("div",{className:"tier-badge tier-free",children:"Free Plan - Upgrade for branding options"}),W==="pro"&&o.jsx("div",{className:"tier-badge tier-pro",children:"Pro Plan"}),W==="business"&&o.jsx("div",{className:"tier-badge tier-business",children:"Business Plan"}),W==="enterprise"&&o.jsx("div",{className:"tier-badge tier-enterprise",children:"Enterprise Plan"})]}),o.jsxs("div",{className:"settings-section security-section",children:[o.jsx("h3",{children:"Security"}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{children:"Office Code"}),o.jsx("p",{className:"help-text",style:{marginBottom:"0.75rem"},children:"Share this code with office staff only. Required to create new office accounts."}),o.jsxs("div",{className:"office-code-display",children:[o.jsx("code",{className:"office-code-value",children:x||"------"}),o.jsx("button",{className:"btn-secondary btn-small",onClick:Y,disabled:!x,children:"Copy"}),o.jsx("button",{className:"btn-secondary btn-small",onClick:R,disabled:b,children:b?"...":"Regenerate"})]}),o.jsx("p",{className:"help-text",style:{marginTop:"0.5rem",color:"var(--accent-amber)"},children:"Field workers should NOT have this code - they use project PINs only."})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{children:"Company Code"}),o.jsx("p",{className:"help-text",style:{marginBottom:"0.75rem"},children:"Public code for employees to find your company."}),o.jsxs("div",{className:"office-code-display",children:[o.jsx("code",{className:"office-code-value",children:t?.code||"------"}),o.jsx("button",{className:"btn-secondary btn-small",onClick:()=>{navigator.clipboard.writeText(t?.code||""),e?.("Company code copied","success")},disabled:!t?.code,children:"Copy"})]})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h3",{children:"Visual Identity"}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{children:"Logo"}),B?o.jsxs(o.Fragment,{children:[m.logo_url&&o.jsx("div",{className:"logo-preview",children:o.jsx("img",{src:m.logo_url,alt:"Logo preview"})}),o.jsx("input",{ref:w,type:"file",accept:"image/*",style:{display:"none"},onChange:V=>D(V.target.files[0],"logo")}),o.jsx("button",{className:"btn-secondary",onClick:()=>w.current?.click(),children:m.logo_url?"Change Logo":"Upload Logo"}),o.jsx("p",{className:"help-text",children:"Recommended: 200x60px, PNG with transparent background"})]}):o.jsx("div",{className:"upgrade-notice",children:o.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your logo"})})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{htmlFor:"app-name",children:"App Name"}),B?o.jsxs(o.Fragment,{children:[o.jsx("input",{id:"app-name",type:"text",className:"input",value:m.custom_app_name||"",onChange:V=>J("custom_app_name",V.target.value),placeholder:"FieldSync",maxLength:50}),o.jsx("p",{className:"help-text",children:"This name appears in the browser tab and throughout the app"})]}):o.jsx("div",{className:"upgrade-notice",children:o.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your app name"})})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{htmlFor:"primary-color",children:"Primary Color"}),B?o.jsxs("div",{className:"color-input-group",children:[o.jsx("input",{id:"primary-color",type:"color",value:m.primary_color||"#3B82F6",onChange:V=>J("primary_color",V.target.value),className:"color-picker"}),o.jsx("input",{type:"text",className:"input color-text",value:m.primary_color||"#3B82F6",onChange:V=>J("primary_color",V.target.value),placeholder:"#3B82F6",pattern:"^#[0-9A-Fa-f]{6}$"})]}):o.jsx("div",{className:"upgrade-notice",children:o.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize colors"})})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{htmlFor:"secondary-color",children:"Secondary Color"}),B?o.jsxs("div",{className:"color-input-group",children:[o.jsx("input",{id:"secondary-color",type:"color",value:m.secondary_color||"#1E40AF",onChange:V=>J("secondary_color",V.target.value),className:"color-picker"}),o.jsx("input",{type:"text",className:"input color-text",value:m.secondary_color||"#1E40AF",onChange:V=>J("secondary_color",V.target.value),placeholder:"#1E40AF",pattern:"^#[0-9A-Fa-f]{6}$"})]}):o.jsx("div",{className:"upgrade-notice",children:o.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize colors"})})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{children:"Favicon"}),B?o.jsxs(o.Fragment,{children:[m.favicon_url&&o.jsx("div",{className:"favicon-preview",children:o.jsx("img",{src:m.favicon_url,alt:"Favicon preview"})}),o.jsx("input",{ref:A,type:"file",accept:"image/*",style:{display:"none"},onChange:V=>D(V.target.files[0],"favicon")}),o.jsx("button",{className:"btn-secondary",onClick:()=>A.current?.click(),children:m.favicon_url?"Change Favicon":"Upload Favicon"}),o.jsx("p",{className:"help-text",children:"Recommended: 32x32px or 64x64px, PNG or ICO format"})]}):o.jsx("div",{className:"upgrade-notice",children:o.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your favicon"})})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{children:"Login Background"}),q?o.jsxs(o.Fragment,{children:[m.login_background_url&&o.jsx("div",{className:"background-preview",children:o.jsx("img",{src:m.login_background_url,alt:"Background preview"})}),o.jsx("input",{ref:C,type:"file",accept:"image/*",style:{display:"none"},onChange:V=>D(V.target.files[0],"login_background")}),o.jsx("button",{className:"btn-secondary",onClick:()=>C.current?.click(),children:m.login_background_url?"Change Background":"Upload Background"}),o.jsx("p",{className:"help-text",children:"Recommended: 1920x1080px, JPG or PNG"})]}):o.jsx("div",{className:"upgrade-notice",children:o.jsx("p",{children:" Upgrade to Business or Enterprise to customize login background"})})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h3",{children:"White-Label Options"}),o.jsxs("div",{className:"setting-item",children:[o.jsxs("label",{className:"checkbox-label",children:[o.jsx("input",{type:"checkbox",checked:m.hide_fieldsync_branding||!1,onChange:V=>J("hide_fieldsync_branding",V.target.checked),disabled:!q}),o.jsx("span",{children:'Hide "Powered by FieldSync"'})]}),!q&&o.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h3",{children:"Email Branding"}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{htmlFor:"email-from-name",children:"From Name"}),o.jsx("input",{id:"email-from-name",type:"text",className:"input",value:m.email_from_name||"",onChange:V=>J("email_from_name",V.target.value),placeholder:"Your Company Name",disabled:!q}),!q&&o.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{htmlFor:"email-from-address",children:"From Email"}),o.jsx("input",{id:"email-from-address",type:"email",className:"input",value:m.email_from_address||"",onChange:V=>J("email_from_address",V.target.value),placeholder:"noreply@yourcompany.com",disabled:!q}),!q&&o.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h3",{children:"Custom Domain"}),o.jsxs("div",{className:"setting-item",children:[o.jsx("label",{htmlFor:"custom-domain",children:"Domain"}),L?o.jsxs(o.Fragment,{children:[o.jsx("input",{id:"custom-domain",type:"text",className:"input",value:m.custom_domain||"",onChange:V=>J("custom_domain",V.target.value),placeholder:"app.yourcompany.com"}),m.custom_domain&&o.jsx("div",{className:`domain-status ${m.domain_verified?"verified":"pending"}`,children:m.domain_verified?o.jsx(o.Fragment,{children:" Connected"}):o.jsx(o.Fragment,{children:" DNS setup required"})}),o.jsx("p",{className:"help-text",children:"Contact support to configure DNS and SSL certificate for your custom domain"})]}):o.jsxs("div",{className:"upgrade-notice",children:[o.jsx("p",{children:" Enterprise plan required for custom domain support"}),o.jsx("p",{className:"help-text",children:"Custom domains allow you to host the app at your own URL (e.g., app.yourcompany.com)"})]})]})]}),o.jsxs("div",{className:"settings-actions",children:[o.jsx("button",{className:"btn-secondary",onClick:M,children:f?"Exit Preview":"Preview Changes"}),o.jsx("button",{className:"btn-primary",onClick:T,disabled:l||!B,children:l?"Saving...":"Save Changes"})]}),f&&o.jsx("div",{className:"preview-banner",children:"Preview Mode Active - Your changes are not yet saved"})]})}const Yv=["foreman","operator","laborer"],Xv=["demolition","abatement"],Kv=["standard","pla"];function JH({company:t,onShowToast:e}){const[r,a]=ne.useState({}),[n,s]=ne.useState(!1),[l,c]=ne.useState(!1),[f,d]=ne.useState("demolition"),[m,v]=ne.useState(!0);ne.useEffect(()=>{t?.id&&g()},[t?.id]);const x=()=>{const E={};return Xv.forEach(R=>{E[R]={},Kv.forEach(Y=>{E[R][Y]={},Yv.forEach(W=>{E[R][Y][W]={regular:"",overtime:""}})})}),E},g=async()=>{if(!Ue){a(x()),v(!1);return}const E=x();try{const{data:R,error:Y}=await De.from("labor_rates").select("*").eq("company_id",t.id);if(Y){a(E),v(!1);return}R&&R.length>0&&R.forEach(W=>{E[W.work_type]&&E[W.work_type][W.job_type]&&E[W.work_type][W.job_type][W.role]&&(E[W.work_type][W.job_type][W.role]={regular:W.regular_rate||"",overtime:W.overtime_rate||""})}),a(E)}catch(R){console.error("Error loading labor rates:",R),a(E)}finally{v(!1)}},b=async()=>{if(!Ue){e("Labor rates require database connection","error");return}c(!0);try{await De.from("labor_rates").delete().eq("company_id",t.id);const E=[];Xv.forEach(Y=>{Kv.forEach(W=>{Yv.forEach(B=>{const q=r[Y]?.[W]?.[B]||{regular:0,overtime:0};E.push({company_id:t.id,role:B,work_type:Y,job_type:W,regular_rate:parseFloat(q.regular)||0,overtime_rate:parseFloat(q.overtime)||0})})})});const{error:R}=await De.from("labor_rates").insert(E);if(R)throw R;e("Labor rates saved","success"),s(!1)}catch(E){console.error("Error saving labor rates:",E),e("Error saving rates: "+(E.message||"Unknown error"),"error")}finally{c(!1)}},_=(E,R,Y,W,B)=>{a(q=>({...q,[E]:{...q[E],[R]:{...q[E]?.[R],[Y]:{...q[E]?.[R]?.[Y],[W]:B}}}}))},w=E=>E.charAt(0).toUpperCase()+E.slice(1),A=E=>E.charAt(0).toUpperCase()+E.slice(1),C=E=>E==="pla"?"PLA (Prevailing Wage)":"Standard (Private)";return m?o.jsx("div",{className:"loading",children:"Loading labor rates..."}):o.jsxs("div",{className:"pricing-section",children:[o.jsxs("div",{className:"pricing-section-header",children:[o.jsxs("div",{children:[o.jsx("h2",{children:"Labor Rates"}),o.jsx("p",{className:"section-desc",children:"Configure hourly rates by role, work type, and job classification"})]}),n?o.jsxs("div",{className:"rate-actions",children:[o.jsx("button",{className:"btn btn-secondary",onClick:()=>{s(!1),g()},children:"Cancel"}),o.jsx("button",{className:"btn btn-primary",onClick:b,disabled:l,children:l?"Saving...":"Save All Rates"})]}):o.jsx("button",{className:"btn btn-primary",onClick:()=>s(!0),children:"Edit Rates"})]}),o.jsx("div",{className:"work-type-tabs",children:Xv.map(E=>o.jsx("button",{className:`work-type-tab ${f===E?"active":""}`,onClick:()=>d(E),children:A(E)},E))}),o.jsx("div",{className:"labor-rates-container",children:Kv.map(E=>o.jsxs("div",{className:"job-type-section",children:[o.jsx("h3",{className:"job-type-header",children:C(E)}),o.jsxs("div",{className:"rates-table",children:[o.jsxs("div",{className:"rates-table-header",children:[o.jsx("div",{className:"rate-cell role-cell",children:"Role"}),o.jsx("div",{className:"rate-cell",children:"Regular"}),o.jsx("div",{className:"rate-cell",children:"Overtime"})]}),Yv.map(R=>{const Y=r[f]?.[E]?.[R]||{regular:"",overtime:""};return o.jsxs("div",{className:"rates-table-row",children:[o.jsx("div",{className:"rate-cell role-cell",children:w(R)}),o.jsx("div",{className:"rate-cell",children:n?o.jsxs("div",{className:"rate-input-inline",children:[o.jsx("span",{children:"$"}),o.jsx("input",{type:"number",value:Y.regular,onChange:W=>_(f,E,R,"regular",W.target.value),placeholder:"0.00",step:"0.01"}),o.jsx("span",{children:"/hr"})]}):o.jsxs("span",{className:"rate-value",children:["$",(parseFloat(Y.regular)||0).toFixed(2),"/hr"]})}),o.jsx("div",{className:"rate-cell",children:n?o.jsxs("div",{className:"rate-input-inline",children:[o.jsx("span",{children:"$"}),o.jsx("input",{type:"number",value:Y.overtime,onChange:W=>_(f,E,R,"overtime",W.target.value),placeholder:"0.00",step:"0.01"}),o.jsx("span",{children:"/hr"})]}):o.jsxs("span",{className:"rate-value ot",children:["$",(parseFloat(Y.overtime)||0).toFixed(2),"/hr"]})})]},R)})]})]},E))})]})}const Tp=["Containment","PPE","Disposal","Equipment"];function ZH({company:t,onShowToast:e}){const[r,a]=ne.useState([]),[n,s]=ne.useState(!0),[l,c]=ne.useState("all"),[f,d]=ne.useState(null),[m,v]=ne.useState(!1),[x,g]=ne.useState({name:"",category:"Equipment",unit:"each",cost_per_unit:""}),[b,_]=ne.useState([]),[w,A]=ne.useState(!1);ne.useEffect(()=>{t?.id&&C()},[t?.id]);const C=async()=>{s(!0);try{const D=await ot.getAllMaterialsEquipment(t.id);a(D||[]),E(D||[])}catch(D){console.error("Error loading items:",D),e("Error loading materials","error")}finally{s(!1)}},E=D=>{const T={},M=[];D.filter(ie=>ie.active!==!1).forEach(ie=>{const X=ie.name.toLowerCase().trim();T[X]||(T[X]=[]),T[X].push(ie)}),Object.entries(T).forEach(([ie,X])=>{X.length>1&&M.push({name:ie,items:X})}),_(M)},R=async D=>{try{const T=D.items.filter(ie=>ie.cost_per_unit>0),M=T.length>0?T[0]:D.items[0],V=D.items.filter(ie=>ie.id!==M.id);for(const ie of V)await ot.deleteMaterialEquipment(ie.id);e(`Merged ${D.items.length} items into one`,"success"),C()}catch(T){console.error("Error merging duplicates:",T),e("Error merging duplicates","error")}},Y=async()=>{if(confirm(`Merge all ${b.length} duplicate groups?`))try{for(const D of b){const T=D.items.filter(ie=>ie.cost_per_unit>0),M=T.length>0?T[0]:D.items[0],V=D.items.filter(ie=>ie.id!==M.id);for(const ie of V)await ot.deleteMaterialEquipment(ie.id)}e("All duplicates merged!","success"),C(),A(!1)}catch(D){console.error("Error merging all duplicates:",D),e("Error merging duplicates","error")}},W=async()=>{if(!x.name.trim()){e("Enter item name","error");return}try{await ot.createMaterialEquipment({company_id:t.id,name:x.name.trim(),category:x.category,unit:x.unit||"each",cost_per_unit:parseFloat(x.cost_per_unit)||0,active:!0}),e("Item added","success"),g({name:"",category:"Equipment",unit:"each",cost_per_unit:""}),v(!1),C()}catch(D){console.error("Error adding item:",D),e("Error adding item","error")}},B=async D=>{try{await ot.updateMaterialEquipment(D.id,{name:D.name,category:D.category,unit:D.unit,cost_per_unit:parseFloat(D.cost_per_unit)||0}),e("Item updated","success"),d(null),C()}catch(T){console.error("Error updating item:",T),e("Error updating item","error")}},q=async D=>{if(confirm("Delete this item?"))try{await ot.deleteMaterialEquipment(D),e("Item deleted","success"),C()}catch(T){console.error("Error deleting item:",T),e("Error deleting item","error")}},L=l==="all"?r.filter(D=>D.active!==!1):r.filter(D=>D.category===l&&D.active!==!1),J=L.reduce((D,T)=>{const M=T.category||"Other";return D[M]||(D[M]=[]),D[M].push(T),D},{});return n?o.jsx("div",{className:"loading",children:"Loading materials..."}):o.jsxs("div",{className:"pricing-section",children:[o.jsxs("div",{className:"materials-header",children:[o.jsxs("div",{className:"materials-title",children:[o.jsx("h2",{children:"Materials & Equipment"}),o.jsxs("span",{className:"materials-count",children:[r.filter(D=>D.active!==!1).length," items"]})]}),o.jsxs("div",{className:"materials-actions",children:[b.length>0&&o.jsxs("button",{className:`btn btn-warning ${w?"active":""}`,onClick:()=>A(!w),children:[b.length," Duplicates"]}),o.jsx("button",{className:"btn btn-primary",onClick:()=>v(!0),children:"+ Add Item"})]})]}),w&&b.length>0&&o.jsxs("div",{className:"duplicates-panel",children:[o.jsxs("div",{className:"duplicates-header",children:[o.jsx("h3",{children:"Duplicate Items Found"}),o.jsxs("button",{className:"btn btn-success btn-small",onClick:Y,children:["Merge All (",b.length,")"]})]}),o.jsx("div",{className:"duplicates-list",children:b.map((D,T)=>o.jsxs("div",{className:"duplicate-group",children:[o.jsxs("div",{className:"duplicate-name",children:['"',D.name,'" x ',D.items.length]}),o.jsx("div",{className:"duplicate-items",children:D.items.map(M=>o.jsxs("span",{className:"duplicate-item",children:[M.category," - $",M.cost_per_unit||0]},M.id))}),o.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>R(D),children:"Merge"})]},T))})]}),m&&o.jsxs("div",{className:"add-item-form",children:[o.jsx("h3",{children:"Add New Item"}),o.jsxs("div",{className:"form-row",children:[o.jsx("input",{type:"text",placeholder:"Item Name",value:x.name,onChange:D=>g({...x,name:D.target.value}),autoFocus:!0}),o.jsx("select",{value:x.category,onChange:D=>g({...x,category:D.target.value}),children:Tp.map(D=>o.jsx("option",{value:D,children:D},D))})]}),o.jsxs("div",{className:"form-row",children:[o.jsx("input",{type:"text",placeholder:"Unit (e.g., each, day, hour)",value:x.unit,onChange:D=>g({...x,unit:D.target.value})}),o.jsx("input",{type:"number",placeholder:"Cost per unit",value:x.cost_per_unit,onChange:D=>g({...x,cost_per_unit:D.target.value}),step:"0.01"})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{className:"btn btn-secondary",onClick:()=>v(!1),children:"Cancel"}),o.jsx("button",{className:"btn btn-primary",onClick:W,children:"Add Item"})]})]}),o.jsxs("div",{className:"materials-filter",children:[o.jsx("button",{className:`filter-tab ${l==="all"?"active":""}`,onClick:()=>c("all"),children:"All"}),Tp.map(D=>o.jsxs("button",{className:`filter-tab ${l===D?"active":""}`,onClick:()=>c(D),children:[D,o.jsx("span",{className:"filter-count",children:r.filter(T=>T.category===D&&T.active!==!1).length})]},D))]}),o.jsxs("div",{className:"materials-list",children:[l==="all"?Object.entries(J).map(([D,T])=>o.jsxs("div",{className:"materials-category",children:[o.jsx("h3",{className:"category-header",children:D}),o.jsx("div",{className:"category-items",children:T.map(M=>o.jsx(zS,{item:M,editingItem:f,setEditingItem:d,handleUpdateItem:B,handleDeleteItem:q,categories:Tp},M.id))})]},D)):o.jsxs("div",{className:"materials-category",children:[o.jsx("h3",{className:"category-header",children:l}),o.jsx("div",{className:"category-items",children:L.map(D=>o.jsx(zS,{item:D,editingItem:f,setEditingItem:d,handleUpdateItem:B,handleDeleteItem:q,categories:Tp},D.id))})]}),L.length===0&&o.jsx("div",{className:"empty-state",children:o.jsx("p",{children:"No items in this category"})})]})]})}function zS({item:t,editingItem:e,setEditingItem:r,handleUpdateItem:a,handleDeleteItem:n,categories:s}){return e?.id===t.id?o.jsx("div",{className:"material-item",children:o.jsxs("div",{className:"item-edit-form",children:[o.jsx("input",{type:"text",value:e.name,onChange:l=>r({...e,name:l.target.value})}),o.jsx("select",{value:e.category,onChange:l=>r({...e,category:l.target.value}),children:s.map(l=>o.jsx("option",{value:l,children:l},l))}),o.jsx("input",{type:"text",value:e.unit,onChange:l=>r({...e,unit:l.target.value}),placeholder:"Unit"}),o.jsx("input",{type:"number",value:e.cost_per_unit,onChange:l=>r({...e,cost_per_unit:l.target.value}),placeholder:"Cost",step:"0.01"}),o.jsxs("div",{className:"edit-actions",children:[o.jsx("button",{className:"btn btn-success btn-small",onClick:()=>a(e),children:"Save"}),o.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>r(null),children:"Cancel"})]})]})}):o.jsxs("div",{className:"material-item",children:[o.jsxs("div",{className:"item-info",children:[o.jsx("span",{className:"item-name",children:t.name}),o.jsx("span",{className:"item-unit",children:t.unit||"each"})]}),o.jsxs("div",{className:"item-cost",children:["$",(t.cost_per_unit||0).toFixed(2)]}),o.jsxs("div",{className:"item-actions",children:[o.jsx("button",{className:"btn-icon",onClick:()=>r({...t}),title:"Edit",children:o.jsx(Y4,{size:16})}),o.jsx("button",{className:"btn-icon danger",onClick:()=>n(t.id),title:"Delete",children:o.jsx(cu,{size:16})})]})]})}const QH=[{id:"trash",label:"Trash",description:"General debris"},{id:"metal",label:"Metal",description:"Scrap metal (recyclable)"},{id:"copper",label:"Copper",description:"Copper scrap (recyclable)"},{id:"concrete",label:"Concrete",description:"Concrete/masonry"},{id:"hazardous",label:"Hazardous",description:"Hazardous materials"}];function e$({company:t,onShowToast:e}){const[r,a]=ne.useState([]),[n,s]=ne.useState(!0),[l,c]=ne.useState(!1),[f,d]=ne.useState(null),[m,v]=ne.useState({name:"",address:"",notes:""}),[x,g]=ne.useState(!1),[b,_]=ne.useState({}),w=ne.useRef({});ne.useEffect(()=>{t?.id&&A()},[t?.id]),ne.useEffect(()=>()=>{Object.values(w.current).forEach(L=>clearTimeout(L))},[]);const A=async()=>{s(!0);try{const L=await ot.getDumpSites(t.id);a(L||[])}catch(L){console.error("Error loading dump sites:",L),e("Error loading dump sites","error")}finally{s(!1)}},C=async()=>{if(!m.name.trim()){e("Please enter a site name","error");return}g(!0);try{await ot.createDumpSite(t.id,m.name,m.address,m.notes),e("Dump site added","success"),v({name:"",address:"",notes:""}),c(!1),A()}catch(L){console.error("Error adding dump site:",L),e("Error adding dump site","error")}finally{g(!1)}},E=async()=>{if(!f?.name.trim()){e("Please enter a site name","error");return}g(!0);try{await ot.updateDumpSite(f.id,{name:f.name,address:f.address,notes:f.notes}),e("Dump site updated","success"),d(null),A()}catch(L){console.error("Error updating dump site:",L),e("Error updating dump site","error")}finally{g(!1)}},R=async L=>{if(confirm("Are you sure you want to delete this dump site?"))try{await ot.deleteDumpSite(L),e("Dump site deleted","success"),A()}catch(J){console.error("Error deleting dump site:",J),e("Error deleting dump site","error")}},Y=ne.useCallback(async(L,J,D)=>{try{await ot.setDumpSiteRate(L,J,D),a(T=>T.map(M=>{if(M.id===L){const V=[...M.dump_site_rates||[]],ie=V.findIndex(X=>X.waste_type===J);return ie>=0?V[ie]={...V[ie],estimated_cost_per_load:D}:V.push({waste_type:J,estimated_cost_per_load:D}),{...M,dump_site_rates:V}}return M})),_(T=>{const M={...T};return delete M[`${L}-${J}`],M})}catch(T){console.error("Error saving rate:",T?.message||T),e("Error saving rate","error")}},[e]),W=(L,J,D)=>{const T=`${L}-${J}`;_(M=>({...M,[T]:D})),w.current[T]&&clearTimeout(w.current[T]),w.current[T]=setTimeout(()=>{const M=parseFloat(D)||0;Y(L,J,M)},500)},B=(L,J)=>{const D=`${L.id}-${J}`;return b[D]!==void 0?b[D]:L.dump_site_rates?.find(M=>M.waste_type===J)?.estimated_cost_per_load??""},q=L=>{if(L===""||L===null||L===void 0)return"";const J=parseFloat(L);return J<0?`-$${Math.abs(J).toFixed(0)}`:`$${J.toFixed(0)}`};return n?o.jsx("div",{className:"loading",children:"Loading dump sites..."}):o.jsxs("div",{className:"pricing-section",children:[o.jsxs("div",{className:"dump-site-header",children:[o.jsxs("div",{children:[o.jsx("h2",{children:"Disposal & Haul-Off"}),o.jsx("p",{className:"section-desc",children:"Configure dump sites and estimated costs per load for each waste type. Use negative values for recyclables (metal, copper) to indicate revenue."})]}),o.jsx("button",{className:"btn btn-primary",onClick:()=>c(!0),children:"+ Add Dump Site"})]}),l&&o.jsxs("div",{className:"dump-site-form card",children:[o.jsx("h4",{children:"Add Dump Site"}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Site Name *"}),o.jsx("input",{type:"text",value:m.name,onChange:L=>v({...m,name:L.target.value}),placeholder:"e.g., Metro Landfill"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Address"}),o.jsx("input",{type:"text",value:m.address,onChange:L=>v({...m,address:L.target.value}),placeholder:"123 Main St, City"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Notes"}),o.jsx("input",{type:"text",value:m.notes,onChange:L=>v({...m,notes:L.target.value}),placeholder:"Operating hours, contact, etc."})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{className:"btn btn-secondary",onClick:()=>c(!1),children:"Cancel"}),o.jsx("button",{className:"btn btn-primary",onClick:C,disabled:x,children:x?"Adding...":"Add Site"})]})]}),r.length===0?o.jsxs("div",{className:"dump-site-empty",children:[o.jsx("p",{children:"No dump sites configured yet."}),o.jsx("p",{children:"Add a dump site to start tracking haul-off costs."})]}):o.jsx("div",{className:"dump-sites-list",children:r.map(L=>o.jsxs("div",{className:"dump-site-card card",children:[f?.id===L.id?o.jsxs("div",{className:"dump-site-edit",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Site Name *"}),o.jsx("input",{type:"text",value:f.name,onChange:J=>d({...f,name:J.target.value})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Address"}),o.jsx("input",{type:"text",value:f.address||"",onChange:J=>d({...f,address:J.target.value})})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Notes"}),o.jsx("input",{type:"text",value:f.notes||"",onChange:J=>d({...f,notes:J.target.value})})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>d(null),children:"Cancel"}),o.jsx("button",{className:"btn btn-primary btn-sm",onClick:E,disabled:x,children:x?"Saving...":"Save"})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"dump-site-info",children:[o.jsx("div",{className:"dump-site-name",children:L.name}),L.address&&o.jsx("div",{className:"dump-site-address",children:L.address}),L.notes&&o.jsx("div",{className:"dump-site-notes",children:L.notes})]}),o.jsxs("div",{className:"dump-site-actions",children:[o.jsx("button",{className:"btn-icon",onClick:()=>d({...L}),title:"Edit",children:o.jsx(Y4,{size:16})}),o.jsx("button",{className:"btn-icon",onClick:()=>R(L.id),title:"Delete",children:o.jsx(cu,{size:16})})]})]}),o.jsxs("div",{className:"dump-site-rates",children:[o.jsx("div",{className:"rates-header",children:"Estimated Cost per Load"}),o.jsx("div",{className:"rates-grid",children:QH.map(J=>o.jsxs("div",{className:"rate-item",children:[o.jsxs("label",{children:[o.jsx("span",{className:"rate-label",children:J.label}),o.jsx("span",{className:"rate-desc",children:J.description})]}),o.jsxs("div",{className:"rate-input-wrapper",children:[o.jsx("span",{className:"rate-prefix",children:"$"}),o.jsx("input",{type:"number",className:"rate-input",value:B(L,J.id),onChange:D=>W(L.id,J.id,D.target.value),placeholder:"0"})]}),B(L,J.id)!==""&&o.jsxs("span",{className:`rate-preview ${parseFloat(B(L,J.id))<0?"revenue":"cost"}`,children:[q(B(L,J.id)),"/load"]})]},J.id))}),o.jsx("div",{className:"rates-note",children:"Tip: Use negative values for recyclables that generate revenue (e.g., -50 for metal)"})]})]},L.id))})]})}const t$=[{id:"labor",label:"Labor Rates",Icon:Ui},{id:"materials",label:"Materials & Equipment",Icon:t2},{id:"disposal",label:"Disposal & Haul-Off",Icon:m1}];function r$({company:t,onShowToast:e}){const[r,a]=ne.useState("labor");return o.jsxs("div",{className:"pricing-manager",children:[o.jsxs("div",{className:"pricing-header",children:[o.jsx("h1",{children:"Pricing Configuration"}),o.jsx("p",{className:"pricing-subtitle",children:"Set up labor rates, materials pricing, and disposal costs"})]}),o.jsx("div",{className:"pricing-tabs",children:t$.map(n=>o.jsxs("button",{className:`pricing-tab ${r===n.id?"active":""}`,onClick:()=>a(n.id),children:[o.jsx(n.Icon,{size:18,className:"pricing-tab-icon"}),o.jsx("span",{className:"pricing-tab-label",children:n.label})]},n.id))}),o.jsxs("div",{className:"pricing-content",children:[r==="labor"&&o.jsx(JH,{company:t,onShowToast:e}),r==="materials"&&o.jsx(ZH,{company:t,onShowToast:e}),r==="disposal"&&o.jsx(e$,{company:t,onShowToast:e})]})]})}function a$({shareToken:t}){const[e,r]=ne.useState(!0),[a,n]=ne.useState(null),[s,l]=ne.useState(null),[c,f]=ne.useState(0),{branding:d}=uh();ne.useEffect(()=>{m()},[t]);const m=async()=>{r(!0),n(null);try{const R=await ot.getPublicProjectData(t);if(!R){n("This share link is invalid or has expired.");return}l(R)}catch(R){console.error("Error loading public data:",R),n("Failed to load project data.")}finally{r(!1)}},v=R=>R?new Date(R).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",x=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(R);if(e)return o.jsxs("div",{className:"public-view",children:[o.jsxs("div",{className:"loading-container",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading project..."})]}),o.jsx("style",{children:Jv})]});if(a)return o.jsxs("div",{className:"public-view",children:[o.jsxs("div",{className:"error-container",children:[o.jsx("div",{className:"error-icon",children:o.jsx(h1,{size:48})}),o.jsx("h2",{children:a}),o.jsx("p",{children:"Please contact the project owner for a valid link."})]}),o.jsx("style",{children:Jv})]});const{share:g,project:b,progress:_,areas:w,photos:A,dailyReports:C,tmTickets:E}=s;return o.jsxs("div",{className:"public-view",children:[o.jsx("header",{className:"public-header",children:o.jsxs("div",{className:"container",children:[o.jsx(Nl,{size:"large"}),o.jsx("div",{className:"header-meta",children:o.jsxs("span",{className:"last-updated",children:["Last updated: ",v(b.updated_at||b.created_at)]})})]})}),o.jsx("main",{className:"public-main",children:o.jsxs("div",{className:"container",children:[o.jsxs("div",{className:"project-header",children:[o.jsx("h1",{children:b.name}),b.address&&o.jsx("p",{className:"project-address",children:b.address})]}),g.permissions.progress&&o.jsxs("div",{className:"public-card progress-card",children:[o.jsx("h2",{children:"Project Progress"}),o.jsxs("div",{className:"progress-visual",children:[o.jsxs("div",{className:"progress-circle",children:[o.jsxs("svg",{viewBox:"0 0 100 100",children:[o.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),o.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"var(--primary-color, #3b82f6)",strokeWidth:"8",strokeDasharray:`${_*2.827} 282.7`,strokeLinecap:"round",transform:"rotate(-90 50 50)"})]}),o.jsxs("div",{className:"progress-percentage",children:[_,"%"]})]}),o.jsxs("div",{className:"progress-details",children:[o.jsx("div",{className:"progress-label",children:"Complete"}),w&&w.length>0&&o.jsxs("div",{className:"areas-summary",children:[w.filter(R=>R.status==="done").length," of ",w.length," areas completed"]})]})]}),w&&w.length>0&&o.jsxs("div",{className:"areas-list",children:[o.jsx("h3",{children:"Work Areas"}),w.map(R=>o.jsxs("div",{className:"area-item",children:[o.jsxs("div",{className:"area-info",children:[o.jsx("span",{className:"area-name",children:R.name}),o.jsxs("span",{className:"area-weight",children:[R.weight,"%"]})]}),o.jsx("div",{className:`area-status status-${R.status}`,children:R.status==="done"?" Complete":R.status==="working"?" In Progress":" Not Started"})]},R.id))]})]}),g.permissions.photos&&A&&A.length>0&&o.jsxs("div",{className:"public-card photos-card",children:[o.jsx("h2",{children:"Recent Photos"}),o.jsxs("div",{className:"photos-carousel",children:[o.jsxs("div",{className:"carousel-main",children:[A[c]&&o.jsx("img",{src:A[c].url,alt:`Project photo from ${v(A[c].date)}`,className:"carousel-image"}),o.jsx("div",{className:"carousel-date",children:v(A[c]?.date)})]}),o.jsx("div",{className:"carousel-thumbnails",children:A.slice(0,10).map((R,Y)=>o.jsx("div",{className:`thumbnail ${Y===c?"active":""}`,onClick:()=>f(Y),children:o.jsx("img",{src:R.url,alt:`Thumbnail ${Y+1}`})},Y))}),A.length>1&&o.jsxs("div",{className:"carousel-controls",children:[o.jsx("button",{onClick:()=>f(R=>R>0?R-1:A.length-1),className:"carousel-btn",children:""}),o.jsxs("span",{className:"carousel-counter",children:[c+1," / ",A.length]}),o.jsx("button",{onClick:()=>f(R=>R<A.length-1?R+1:0),className:"carousel-btn",children:""})]})]})]}),g.permissions.daily_reports&&C&&C.length>0&&o.jsxs("div",{className:"public-card reports-card",children:[o.jsx("h2",{children:"Daily Reports"}),o.jsx("div",{className:"reports-list",children:C.map((R,Y)=>o.jsxs("div",{className:"report-item",children:[o.jsx("div",{className:"report-date",children:v(R.report_date)}),o.jsxs("div",{className:"report-content",children:[R.crew_count&&o.jsxs("div",{className:"report-field",children:[o.jsx("strong",{children:"Crew:"})," ",R.crew_count," workers"]}),R.tasks_completed&&o.jsxs("div",{className:"report-field",children:[o.jsx("strong",{children:"Tasks Completed:"})," ",R.tasks_completed]}),R.weather&&o.jsxs("div",{className:"report-field",children:[o.jsx("strong",{children:"Weather:"})," ",R.weather]}),R.notes&&o.jsxs("div",{className:"report-field",children:[o.jsx("strong",{children:"Notes:"})," ",R.notes]})]})]},Y))})]}),g.permissions.tm_tickets&&E&&E.length>0&&o.jsxs("div",{className:"public-card tm-card",children:[o.jsx("h2",{children:"Time & Materials Tickets"}),o.jsx("div",{className:"tm-list",children:E.map((R,Y)=>o.jsxs("div",{className:"tm-item",children:[o.jsxs("div",{className:"tm-header",children:[o.jsx("span",{className:"tm-date",children:v(R.work_date)}),o.jsx("span",{className:`tm-status status-${R.status}`,children:R.status})]}),R.description&&o.jsx("div",{className:"tm-description",children:R.description}),R.total_amount&&o.jsxs("div",{className:"tm-amount",children:["Total: ",x(R.total_amount)]})]},Y))})]})]})}),o.jsx("footer",{className:"public-footer",children:o.jsx("div",{className:"container",children:!d?.hide_fieldsync_branding&&o.jsx("p",{children:"Powered by FieldSync"})})}),o.jsx("style",{children:Jv})]})}const Jv=`
  .public-view {
    min-height: 100vh;
    background-color: #f9fafb;
    display: flex;
    flex-direction: column;
  }

  .container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 1rem;
    width: 100%;
  }

  /* Header */
  .public-header {
    background-color: white;
    border-bottom: 1px solid #e5e7eb;
    padding: 1.5rem 0;
  }

  .public-header .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .header-meta {
    font-size: 0.875rem;
    color: #6b7280;
  }

  /* Main Content */
  .public-main {
    flex: 1;
    padding: 2rem 0;
  }

  .project-header {
    margin-bottom: 2rem;
  }

  .project-header h1 {
    font-size: 2rem;
    margin: 0 0 0.5rem 0;
    color: #111827;
  }

  .project-address {
    font-size: 1rem;
    color: #6b7280;
    margin: 0;
  }

  /* Cards */
  .public-card {
    background-color: white;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .public-card h2 {
    font-size: 1.5rem;
    margin: 0 0 1.5rem 0;
    color: #111827;
  }

  .public-card h3 {
    font-size: 1.125rem;
    margin: 1.5rem 0 1rem 0;
    color: #374151;
  }

  /* Progress Card */
  .progress-visual {
    display: flex;
    align-items: center;
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .progress-circle {
    position: relative;
    width: 150px;
    height: 150px;
    flex-shrink: 0;
  }

  .progress-circle svg {
    width: 100%;
    height: 100%;
  }

  .progress-percentage {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2rem;
    font-weight: bold;
    color: var(--primary-color, #3b82f6);
  }

  .progress-details {
    flex: 1;
  }

  .progress-label {
    font-size: 1.25rem;
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.5rem;
  }

  .areas-summary {
    font-size: 1rem;
    color: #6b7280;
  }

  /* Areas List */
  .areas-list {
    border-top: 1px solid #e5e7eb;
    padding-top: 1rem;
  }

  .area-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 0;
    border-bottom: 1px solid #f3f4f6;
  }

  .area-item:last-child {
    border-bottom: none;
  }

  .area-info {
    flex: 1;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-right: 1rem;
  }

  .area-name {
    font-weight: 500;
    color: #374151;
  }

  .area-weight {
    color: #6b7280;
    font-size: 0.875rem;
  }

  .area-status {
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    white-space: nowrap;
  }

  .area-status.status-done {
    background-color: #d1fae5;
    color: #065f46;
  }

  .area-status.status-working {
    background-color: #fef3c7;
    color: #92400e;
  }

  .area-status.status-not_started {
    background-color: #f3f4f6;
    color: #6b7280;
  }

  /* Photos Carousel */
  .photos-carousel {
    position: relative;
  }

  .carousel-main {
    position: relative;
    width: 100%;
    height: 400px;
    background-color: #111827;
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 1rem;
  }

  .carousel-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }

  .carousel-date {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
    color: white;
    padding: 1rem;
    text-align: center;
  }

  .carousel-thumbnails {
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
  }

  .thumbnail {
    flex-shrink: 0;
    width: 80px;
    height: 80px;
    border-radius: 4px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: border-color 0.2s;
  }

  .thumbnail:hover {
    border-color: #d1d5db;
  }

  .thumbnail.active {
    border-color: var(--primary-color, #3b82f6);
  }

  .thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .carousel-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
  }

  .carousel-btn {
    background-color: white;
    border: 1px solid #d1d5db;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.25rem;
    transition: background-color 0.2s;
  }

  .carousel-btn:hover {
    background-color: #f3f4f6;
  }

  .carousel-counter {
    font-size: 0.875rem;
    color: #6b7280;
  }

  /* Daily Reports */
  .reports-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .report-item {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1rem;
  }

  .report-date {
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.75rem;
    font-size: 1.125rem;
  }

  .report-content {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .report-field {
    color: #374151;
    line-height: 1.5;
  }

  .report-field strong {
    color: #111827;
  }

  /* T&M Tickets */
  .tm-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .tm-item {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1rem;
  }

  .tm-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
  }

  .tm-date {
    font-weight: 600;
    color: #111827;
  }

  .tm-status {
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    text-transform: capitalize;
  }

  .tm-status.status-approved {
    background-color: #d1fae5;
    color: #065f46;
  }

  .tm-status.status-pending {
    background-color: #fef3c7;
    color: #92400e;
  }

  .tm-status.status-rejected {
    background-color: #fee2e2;
    color: #991b1b;
  }

  .tm-description {
    color: #374151;
    margin-bottom: 0.5rem;
  }

  .tm-amount {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--primary-color, #3b82f6);
  }

  /* Footer */
  .public-footer {
    background-color: white;
    border-top: 1px solid #e5e7eb;
    padding: 2rem 0;
    margin-top: auto;
  }

  .public-footer p {
    text-align: center;
    color: #6b7280;
    margin: 0;
    font-size: 0.875rem;
  }

  /* Loading & Error States */
  .loading-container,
  .error-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 2rem;
  }

  .spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #e5e7eb;
    border-top-color: var(--primary-color, #3b82f6);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .loading-container p {
    margin-top: 1rem;
    color: #6b7280;
  }

  .error-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
  }

  .error-container h2 {
    color: #111827;
    margin: 0 0 0.5rem 0;
  }

  .error-container p {
    color: #6b7280;
    margin: 0;
  }

  /* Mobile Responsive */
  @media (max-width: 768px) {
    .project-header h1 {
      font-size: 1.5rem;
    }

    .public-card {
      padding: 1.5rem;
    }

    .progress-visual {
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .progress-circle {
      width: 120px;
      height: 120px;
    }

    .progress-percentage {
      font-size: 1.5rem;
    }

    .carousel-main {
      height: 300px;
    }

    .area-item {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }

    .area-info {
      width: 100%;
      margin-right: 0;
    }
  }
`;function n$({onSave:t,onClose:e,slot:r=1,documentType:a="cor",documentTitle:n="",signerName:s="",signerTitle:l="",signerCompany:c=""}){const f=ne.useRef(null),[d,m]=ne.useState(s),[v,x]=ne.useState(l),[g,b]=ne.useState(c),[_,w]=ne.useState(!1),[A,C]=ne.useState(!1),[E,R]=ne.useState(!1),Y=r===1?"GC Authorization":"Client Authorization",W=a==="cor"?"Change Order Request":"T&M Work Order",B=()=>{const X=f.current;return X?X.getContext("2d"):null},q=X=>{const Z=f.current;if(!Z)return{x:0,y:0};const K=Z.getBoundingClientRect(),re=Z.width/K.width,de=Z.height/K.height,U=X.touches?X.touches[0].clientX:X.clientX,k=X.touches?X.touches[0].clientY:X.clientY;return{x:(U-K.left)*re,y:(k-K.top)*de}},L=X=>{X.preventDefault();const Z=B();if(!Z)return;const{x:K,y:re}=q(X);Z.beginPath(),Z.moveTo(K,re),C(!0),w(!0)},J=X=>{if(!A)return;X.preventDefault();const Z=B();if(!Z)return;const{x:K,y:re}=q(X);Z.lineTo(K,re),Z.stroke()},D=()=>{C(!1)},T=()=>{const X=f.current,Z=B();!X||!Z||(Z.clearRect(0,0,X.width,X.height),w(!1))},M=X=>{if(!X)return;f.current=X;const Z=X.getContext("2d");Z.strokeStyle="#1e293b",Z.lineWidth=2,Z.lineCap="round",Z.lineJoin="round"},V=_&&d.trim()&&E,ie=()=>{if(!V)return;const X=f.current;if(!X)return;const Z=X.toDataURL("image/png");t({signature:Z,signerName:d.trim(),signerTitle:v.trim()||null,signerCompany:g.trim()||null,signedAt:new Date().toISOString()})};return o.jsx("div",{className:"modal-overlay",onClick:e,role:"dialog","aria-modal":"true","aria-labelledby":"signature-title",children:o.jsxs("div",{className:"modal-content signature-modal enhanced",onClick:X=>X.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{className:"signature-header-info",children:[o.jsx("h2",{id:"signature-title",children:Y}),n&&o.jsx("span",{className:"signature-doc-ref",children:n})]}),o.jsx("button",{className:"close-btn",onClick:e,"aria-label":"Close signature modal",children:o.jsx(fh,{size:20,"aria-hidden":"true"})})]}),o.jsxs("div",{className:"modal-body signature-body",children:[o.jsxs("div",{className:"signature-slot-badge",children:[o.jsx(J4,{size:14}),o.jsxs("span",{children:["Signature ",r," of 2"]})]}),o.jsxs("div",{className:"signature-fields",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"signer-name",children:"Print Name *"}),o.jsx("input",{id:"signer-name",type:"text",value:d,onChange:X=>m(X.target.value),placeholder:"Enter your full legal name","aria-required":"true"})]}),o.jsxs("div",{className:"signature-fields-row",children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"signer-title",children:"Title"}),o.jsx("input",{id:"signer-title",type:"text",value:v,onChange:X=>x(X.target.value),placeholder:"e.g., Project Manager"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"signer-company",children:"Company"}),o.jsx("input",{id:"signer-company",type:"text",value:g,onChange:X=>b(X.target.value),placeholder:"e.g., ABC Construction"})]})]})]}),o.jsxs("div",{className:"signature-area",children:[o.jsxs("div",{className:"signature-label",id:"signature-instructions",children:[o.jsx(G4,{size:16,"aria-hidden":"true"}),o.jsx("span",{children:"Draw your signature below"})]}),o.jsxs("div",{className:"signature-canvas-container",children:[o.jsx("canvas",{ref:M,width:500,height:180,className:"signature-canvas",onMouseDown:L,onMouseMove:J,onMouseUp:D,onMouseLeave:D,onTouchStart:L,onTouchMove:J,onTouchEnd:D,role:"img","aria-label":"Signature drawing area. Use mouse or touch to draw your signature.","aria-describedby":"signature-instructions",tabIndex:0}),!_&&o.jsx("div",{className:"signature-placeholder",children:"Sign here"})]}),o.jsxs("button",{className:"btn btn-ghost btn-small",onClick:T,disabled:!_,"aria-label":"Clear signature",children:[o.jsx(X4,{size:14,"aria-hidden":"true"})," Clear"]})]}),o.jsx("div",{className:"signature-acknowledgment",children:o.jsxs("label",{className:"checkbox-label",children:[o.jsx("input",{type:"checkbox",checked:E,onChange:X=>R(X.target.checked)}),o.jsxs("span",{children:["I acknowledge that this electronic signature is legally binding and that I have reviewed and approve this ",W,". I understand that my signature, name, and IP address will be recorded for verification purposes."]})]})})]}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{className:"btn btn-secondary",onClick:e,"aria-label":"Cancel and close",children:"Cancel"}),o.jsxs("button",{className:"btn btn-primary",onClick:ie,disabled:!V,"aria-label":"Submit signature",children:[o.jsx(A0,{size:16,"aria-hidden":"true"})," Submit Signature"]})]})]})})}const Zv=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(t||0),a0=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"";function s$({signatureToken:t}){const[e,r]=ne.useState(!0),[a,n]=ne.useState(null),[s,l]=ne.useState(null),[c,f]=ne.useState(null),[d,m]=ne.useState(!1),[v,x]=ne.useState(null),[g,b]=ne.useState(!1),[_,w]=ne.useState(!1),[A,C]=ne.useState(null);ne.useEffect(()=>{E()},[t]);const E=async()=>{try{r(!0),n(null);const Z=await ot.getSignatureRequestByToken(t);if(!Z){n("This signature link is invalid or has expired.");return}if(Z.status==="completed"){n("This document has already been fully signed.");return}if(Z.status==="revoked"){n("This signature link has been revoked.");return}if(Z.status==="expired"){n("This signature link has expired.");return}l(Z);const K=await ot.getDocumentForSigning(Z.document_type,Z.document_id);if(!K){n("The document associated with this link could not be found.");return}f(K)}catch(Z){console.error("Error loading signature data:",Z),n("Unable to load signature request. Please try again.")}finally{r(!1)}},R=()=>{if(!s)return{slot1:null,slot2:null,availableSlots:[]};const Z=s.signatures||[],K=Z.find(U=>U.signature_slot===1),re=Z.find(U=>U.signature_slot===2),de=[];return K||de.push(1),re||de.push(2),{slot1:K,slot2:re,availableSlots:de}},Y=async()=>{try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch{return null}},W=async Z=>{if(!(!s||!v))try{b(!0);const K=await Y(),re=await ot.addSignature(s.id,v,{...Z,ipAddress:K,userAgent:navigator.userAgent});await ot.syncSignatureToDocument(re,s),await E(),m(!1),x(null),C(`Signature ${v} has been recorded successfully.`),setTimeout(()=>C(null),5e3)}catch(K){console.error("Error submitting signature:",K),n("Failed to submit signature. Please try again.")}finally{b(!1)}},B=Z=>{x(Z),m(!0)};if(e)return o.jsx("div",{className:"signature-page",children:o.jsxs("div",{className:"signature-page-loading",children:[o.jsx("div",{className:"loading-spinner"}),o.jsx("p",{children:"Loading document..."})]})});if(a)return o.jsx("div",{className:"signature-page",children:o.jsxs("div",{className:"signature-page-error",children:[o.jsx(G0,{size:48}),o.jsx("h2",{children:"Unable to Load Document"}),o.jsx("p",{children:a})]})});const{slot1:q,slot2:L,availableSlots:J}=R(),D=J.length===0,T=s?.document_type==="cor",M=c?.projects?.companies,V=c?.projects,X=(()=>{if(T)return{title:`COR ${c.cor_number}`,subtitle:c.title||"Change Order Request",amount:c.cor_total,period:c.period_start&&c.period_end?`${a0(c.period_start)} - ${a0(c.period_end)}`:null,status:c.status};{const Z=c.t_and_m_workers?.length||0,K=c.t_and_m_workers?.reduce((re,de)=>re+(de.hours||0),0)||0;return{title:"T&M Ticket",subtitle:c.ce_pco_number?`CE/PCO: ${c.ce_pco_number}`:"Time & Materials",amount:c.change_order_value,period:a0(c.work_date),status:c.status,workers:Z,hours:K}}})();return o.jsxs("div",{className:"signature-page",children:[o.jsxs("header",{className:"signature-page-header",children:[M?.logo_url?o.jsx("img",{src:M.logo_url,alt:M.name,className:"company-logo"}):o.jsx("div",{className:"company-logo-placeholder",children:o.jsx(Zx,{size:24})}),o.jsxs("div",{className:"company-info",children:[o.jsx("h1",{children:M?.name||"FieldSync"}),o.jsx("span",{className:"doc-type-label",children:"Document Signature"})]})]}),A&&o.jsxs("div",{className:"signature-success-banner",children:[o.jsx($d,{size:18}),A]}),o.jsxs("main",{className:"signature-page-content",children:[o.jsxs("div",{className:"signature-document-card",children:[o.jsxs("div",{className:"document-card-header",children:[o.jsx(El,{size:20}),o.jsxs("div",{className:"document-card-title",children:[o.jsx("h2",{children:X.title}),o.jsx("span",{className:"document-subtitle",children:X.subtitle})]})]}),o.jsxs("div",{className:"document-card-details",children:[o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Project"}),o.jsx("span",{className:"detail-value",children:V?.name})]}),V?.job_number&&o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Job #"}),o.jsx("span",{className:"detail-value",children:V.job_number})]}),X.amount>0&&o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Amount"}),o.jsx("span",{className:"detail-value amount",children:Zv(X.amount)})]}),X.period&&o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:T?"Period":"Work Date"}),o.jsx("span",{className:"detail-value",children:X.period})]}),!T&&X.workers>0&&o.jsxs("div",{className:"detail-row",children:[o.jsx("span",{className:"detail-label",children:"Workers"}),o.jsxs("span",{className:"detail-value",children:[X.workers," (",X.hours," hrs)"]})]})]}),o.jsxs("button",{className:"expand-details-btn",onClick:()=>w(!_),children:[_?o.jsx(HC,{size:16}):o.jsx(jf,{size:16}),_?"Hide Details":"View Full Details"]}),_&&o.jsx("div",{className:"document-full-details",children:T?o.jsxs(o.Fragment,{children:[c.description&&o.jsxs("div",{className:"detail-section",children:[o.jsx("h4",{children:"Description"}),o.jsx("p",{children:c.description})]}),c.change_order_labor?.length>0&&o.jsxs("div",{className:"detail-section",children:[o.jsxs("h4",{children:["Labor (",c.change_order_labor.length," items)"]}),o.jsxs("ul",{children:[c.change_order_labor.slice(0,5).map((Z,K)=>o.jsxs("li",{children:[Z.description,": ",Z.hours,"hrs @ ",Zv(Z.rate),"/hr"]},K)),c.change_order_labor.length>5&&o.jsxs("li",{className:"more-items",children:["+",c.change_order_labor.length-5," more items"]})]})]}),c.change_order_materials?.length>0&&o.jsxs("div",{className:"detail-section",children:[o.jsxs("h4",{children:["Materials (",c.change_order_materials.length," items)"]}),o.jsxs("ul",{children:[c.change_order_materials.slice(0,5).map((Z,K)=>o.jsxs("li",{children:[Z.description,": ",Z.quantity," @ ",Zv(Z.unit_cost)]},K)),c.change_order_materials.length>5&&o.jsxs("li",{className:"more-items",children:["+",c.change_order_materials.length-5," more items"]})]})]})]}):o.jsxs(o.Fragment,{children:[c.notes&&o.jsxs("div",{className:"detail-section",children:[o.jsx("h4",{children:"Work Description"}),o.jsx("p",{children:c.notes})]}),c.t_and_m_workers?.length>0&&o.jsxs("div",{className:"detail-section",children:[o.jsx("h4",{children:"Workers"}),o.jsx("ul",{children:c.t_and_m_workers.map((Z,K)=>o.jsxs("li",{children:[Z.name,": ",Z.hours,"hrs ",Z.overtime_hours>0&&`(+${Z.overtime_hours} OT)`]},K))})]})]})})]}),o.jsxs("div",{className:"signature-status-section",children:[o.jsx("h3",{children:"Signatures Required"}),o.jsxs("div",{className:`signature-slot-card ${q?"signed":"unsigned"}`,children:[o.jsxs("div",{className:"slot-header",children:[q?o.jsx($d,{size:20,className:"status-icon signed"}):o.jsx(Hp,{size:20,className:"status-icon pending"}),o.jsx("span",{className:"slot-label",children:"Signature 1 - GC Authorization"})]}),q?o.jsxs("div",{className:"slot-signed-info",children:[o.jsxs("div",{className:"signer-details",children:[o.jsx("span",{className:"signer-name",children:q.signer_name}),(q.signer_title||q.signer_company)&&o.jsxs("span",{className:"signer-org",children:[q.signer_title,q.signer_title&&q.signer_company&&" - ",q.signer_company]})]}),o.jsxs("span",{className:"signed-date",children:["Signed ",a0(q.signed_at)]})]}):o.jsx("button",{className:"btn btn-primary sign-btn",onClick:()=>B(1),disabled:g,children:"Sign as GC"})]}),o.jsxs("div",{className:`signature-slot-card ${L?"signed":"unsigned"}`,children:[o.jsxs("div",{className:"slot-header",children:[L?o.jsx($d,{size:20,className:"status-icon signed"}):o.jsx(Hp,{size:20,className:"status-icon pending"}),o.jsx("span",{className:"slot-label",children:"Signature 2 - Client Authorization"})]}),L?o.jsxs("div",{className:"slot-signed-info",children:[o.jsxs("div",{className:"signer-details",children:[o.jsx("span",{className:"signer-name",children:L.signer_name}),(L.signer_title||L.signer_company)&&o.jsxs("span",{className:"signer-org",children:[L.signer_title,L.signer_title&&L.signer_company&&" - ",L.signer_company]})]}),o.jsxs("span",{className:"signed-date",children:["Signed ",a0(L.signed_at)]})]}):o.jsx("button",{className:"btn btn-primary sign-btn",onClick:()=>B(2),disabled:g,children:"Sign as Client"})]}),D&&o.jsxs("div",{className:"fully-signed-message",children:[o.jsx($d,{size:24}),o.jsx("p",{children:"This document has been fully signed by all parties."})]})]})]}),o.jsx("footer",{className:"signature-page-footer",children:o.jsx("p",{children:"Powered by FieldSync"})}),d&&v&&o.jsx(n$,{slot:v,documentType:s.document_type,documentTitle:X.title,onSave:W,onClose:()=>{m(!1),x(null)}})]})}function i$({company:t,projects:e,userId:r,onNotificationClick:a,onShowToast:n}){const[s,l]=ne.useState([]),[c,f]=ne.useState(0),[d,m]=ne.useState(!1),[v,x]=ne.useState(!1),[g,b]=ne.useState({}),_=ne.useRef(null);ne.useRef(null);const w=ne.useRef(null);ne.useEffect(()=>{r&&A()},[r]);const A=async()=>{try{const T=await ot.getUserNotificationPreferences(r),M={};T.forEach(V=>{M[V.project_id]=V.notification_types||[]}),b(M)}catch(T){console.error("Error loading user preferences:",T)}},C=(T,M)=>g[T]?g[T].length===0?!1:g[T].includes(M):!0;ne.useEffect(()=>{if(!t?.id||!e||e.length===0)return;E();const T=R();return()=>{T&&ot.unsubscribe(T)}},[t?.id,e,g]),ne.useEffect(()=>()=>{w.current&&(w.current.close().catch(()=>{}),w.current=null)},[]),ne.useEffect(()=>{function T(M){_.current&&!_.current.contains(M.target)&&m(!1)}return document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T)},[]);const E=async()=>{if(!e||e.length===0)return;const T=[];for(const M of e)try{C(M.id,"message")&&(await ot.getMessages(M.id,20)).filter(X=>X.sender_type==="field"&&!X.is_read).forEach(X=>{T.push({id:`msg-${X.id}`,type:"message",title:"New Message",message:X.message?.slice(0,50)+(X.message?.length>50?"...":""),projectId:M.id,projectName:M.name,senderName:X.sender_name,createdAt:X.created_at,isRead:X.is_read,data:X})}),C(M.id,"material_request")&&(await ot.getMaterialRequests(M.id,"pending")).forEach(ie=>{T.push({id:`req-${ie.id}`,type:"material_request",title:"Material Request",message:`${ie.items?.length||0} items requested`,projectId:M.id,projectName:M.name,senderName:ie.requested_by,priority:ie.priority,createdAt:ie.created_at,isRead:!1,data:ie})})}catch(V){console.error("Error loading notifications for project:",M.id,V)}try{(await ot.getCompanyInjuryReports(t.id,"open")).slice(0,5).forEach(V=>{if(C(V.project_id,"injury_report")){const ie=e.find(X=>X.id===V.project_id);T.push({id:`injury-${V.id}`,type:"injury_report",title:"Safety Report",message:`${V.injury_type} - ${V.injured_person_name}`,projectId:V.project_id,projectName:ie?.name||"Unknown Project",senderName:V.reported_by_name,createdAt:V.created_at,isRead:V.status!=="open",data:V})}})}catch(M){console.error("Error loading injury reports:",M)}T.sort((M,V)=>new Date(V.createdAt)-new Date(M.createdAt)),l(T.slice(0,50)),f(T.filter(M=>!M.isRead).length)},R=()=>{if(!t?.id||!e||e.length===0)return null;const T=e.map(V=>V.id),M=ot.subscribeToCompanyActivity(t.id,T,{onMessage:V=>{if(V.new?.sender_type==="field"){if(!C(V.new.project_id,"message"))return;Y({id:`msg-${V.new.id}`,type:"message",title:"New Message",message:V.new.message?.slice(0,50)+(V.new.message?.length>50?"...":""),projectId:V.new.project_id,projectName:e.find(ie=>ie.id===V.new.project_id)?.name||"Project",senderName:V.new.sender_name,createdAt:V.new.created_at,isRead:!1,data:V.new})}},onMaterialRequest:V=>{C(V.new.project_id,"material_request")&&Y({id:`req-${V.new.id}`,type:"material_request",title:"Material Request",message:`${V.new.items?.length||0} items requested`,projectId:V.new.project_id,projectName:e.find(ie=>ie.id===V.new.project_id)?.name||"Project",senderName:V.new.requested_by,priority:V.new.priority,createdAt:V.new.created_at,isRead:!1,data:V.new})},onTMTicket:V=>{if(V.eventType==="INSERT"){if(!C(V.new.project_id,"tm_ticket"))return;Y({id:`tm-${V.new.id}`,type:"tm_ticket",title:"New T&M Ticket",message:`Submitted by ${V.new.created_by_name||"Field"}`,projectId:V.new.project_id,projectName:e.find(ie=>ie.id===V.new.project_id)?.name||"Project",senderName:V.new.created_by_name,createdAt:V.new.created_at,isRead:!1,data:V.new})}},onInjuryReport:V=>{C(V.new.project_id,"injury_report")&&Y({id:`injury-${V.new.id}`,type:"injury_report",title:"Safety Report",message:`${V.new.injury_type} - ${V.new.injured_person_name}`,projectId:V.new.project_id,projectName:e.find(ie=>ie.id===V.new.project_id)?.name||"Project",senderName:V.new.reported_by_name,createdAt:V.new.created_at,isRead:!1,data:V.new})}});return M&&x(!0),M},Y=T=>{l(V=>[T,...V.slice(0,49)]),f(V=>V+1),W();const M=B(T.type);n?.(`${M} ${T.title}: ${T.message}`,"info")},W=()=>{try{(!w.current||w.current.state==="closed")&&(w.current=new(window.AudioContext||window.webkitAudioContext));const T=w.current;T.state==="suspended"&&T.resume();const M=T.createOscillator(),V=T.createGain();M.connect(V),V.connect(T.destination),M.frequency.value=800,M.type="sine",V.gain.value=.3,M.start(),M.stop(T.currentTime+.15),setTimeout(()=>{if(!w.current||w.current.state==="closed")return;const ie=w.current.createOscillator(),X=w.current.createGain();ie.connect(X),X.connect(w.current.destination),ie.frequency.value=1e3,ie.type="sine",X.gain.value=.3,ie.start(),ie.stop(w.current.currentTime+.15)},150)}catch{}},B=T=>{switch(T){case"message":return o.jsx(Y0,{size:16});case"material_request":return o.jsx(Af,{size:16});case"injury_report":return o.jsx(G0,{size:16});case"tm_ticket":return o.jsx(hu,{size:16});default:return o.jsx(RC,{size:16})}},q=T=>{switch(T){case"message":return"blue";case"material_request":return"orange";case"injury_report":return"red";case"tm_ticket":return"green";default:return"gray"}},L=T=>{l(M=>M.map(V=>V.id===T.id?{...V,isRead:!0}:V)),f(M=>Math.max(0,M-1)),m(!1),a?.(T)},J=async()=>{for(const T of e)try{await ot.markMessagesRead(T.id,"office")}catch{}l(T=>T.map(M=>({...M,isRead:!0}))),f(0)},D=T=>{const M=new Date(T),ie=new Date-M,X=Math.floor(ie/6e4),Z=Math.floor(ie/36e5),K=Math.floor(ie/864e5);return X<1?"Just now":X<60?`${X}m ago`:Z<24?`${Z}h ago`:K<7?`${K}d ago`:M.toLocaleDateString()};return o.jsxs("div",{className:"notification-center",ref:_,children:[o.jsxs("button",{className:`notification-bell ${c>0?"has-notifications":""}`,onClick:()=>m(!d),title:`${c} unread notifications`,children:[o.jsx("span",{className:"bell-icon",children:""}),c>0&&o.jsx("span",{className:"notification-badge",children:c>99?"99+":c}),v&&o.jsx("span",{className:"connection-dot"})]}),d&&o.jsxs("div",{className:"notification-dropdown",children:[o.jsxs("div",{className:"notification-header",children:[o.jsx("h4",{children:"Notifications"}),c>0&&o.jsx("button",{className:"mark-all-read",onClick:J,children:"Mark all read"})]}),o.jsx("div",{className:"notification-list",children:s.length===0?o.jsxs("div",{className:"notification-empty",children:[o.jsx("span",{className:"empty-icon",children:""}),o.jsx("p",{children:"No notifications yet"}),o.jsx("small",{children:"You'll see updates from the field here"})]}):s.map(T=>o.jsxs("div",{className:`notification-item ${T.isRead?"read":"unread"} ${q(T.type)}`,onClick:()=>L(T),children:[o.jsx("div",{className:"notification-icon",children:B(T.type)}),o.jsxs("div",{className:"notification-content",children:[o.jsxs("div",{className:"notification-title",children:[T.title,T.priority==="urgent"&&o.jsx("span",{className:"priority-badge urgent",children:"URGENT"})]}),o.jsx("div",{className:"notification-message",children:T.message}),o.jsxs("div",{className:"notification-meta",children:[o.jsx("span",{className:"notification-project",children:T.projectName}),o.jsx("span",{className:"notification-time",children:D(T.createdAt)})]})]}),!T.isRead&&o.jsx("div",{className:"unread-dot"})]},T.id))}),s.length>0&&o.jsx("div",{className:"notification-footer",children:o.jsx("button",{className:"view-all-btn",onClick:()=>{m(!1),a?.({type:"view_all"})},children:"View All Activity"})})]})]})}class n0 extends ne.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,r){this.setState({error:e,errorInfo:r}),console.error("ErrorBoundary caught an error:",e,r)}handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};handleReload=()=>{window.location.reload()};render(){return this.state.hasError?o.jsx("div",{className:"error-boundary",children:o.jsxs("div",{className:"error-boundary-content",children:[o.jsx("div",{className:"error-icon",children:o.jsx(h1,{size:48})}),o.jsx("h2",{children:"Something went wrong"}),o.jsx("p",{children:"We're sorry, but something unexpected happened. Please try again."}),o.jsxs("div",{className:"error-actions",children:[o.jsx("button",{className:"btn btn-primary",onClick:this.handleRetry,children:"Try Again"}),o.jsx("button",{className:"btn btn-secondary",onClick:this.handleReload,children:"Reload Page"})]}),!1]})}):this.props.children}}function HS(){const[t,e]=ne.useState(f0()),[r,a]=ne.useState(0),[n,s]=ne.useState(!1),[l,c]=ne.useState(!1);return ne.useEffect(()=>{const f=q4(async m=>{e(m),m&&l&&(s(!0),setTimeout(()=>s(!1),3e3)),m||c(!0);const v=await ev();a(v)});ev().then(a);const d=setInterval(async()=>{if(!f0()){const m=await ev();a(m)}},5e3);return()=>{f(),clearInterval(d)}},[l]),t&&r===0&&!n?null:o.jsxs("div",{className:`offline-indicator ${t?"online":"offline"} ${n?"synced":""}`,children:[o.jsx("div",{className:"offline-indicator-content",children:t?n?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"online-icon",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"20 6 9 17 4 12"})})}),o.jsx("span",{className:"offline-text",children:"Changes synced!"})]}):r>0?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"syncing-icon",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("polyline",{points:"23 4 23 10 17 10"}),o.jsx("polyline",{points:"1 20 1 14 7 14"}),o.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})}),o.jsxs("span",{className:"offline-text",children:["Syncing ",r,"..."]})]}):null:o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"offline-icon",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),o.jsx("path",{d:"M16.72 11.06A10.94 10.94 0 0 1 19 12.55"}),o.jsx("path",{d:"M5 12.55a10.94 10.94 0 0 1 5.17-2.39"}),o.jsx("path",{d:"M10.71 5.05A16 16 0 0 1 22.58 9"}),o.jsx("path",{d:"M1.42 9a15.91 15.91 0 0 1 4.7-2.88"}),o.jsx("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),o.jsx("line",{x1:"12",y1:"20",x2:"12.01",y2:"20"})]})}),o.jsxs("span",{className:"offline-text",children:["Offline",r>0&&o.jsxs("span",{className:"pending-badge",children:[r," pending"]})]})]})}),o.jsx("style",{children:`
        .offline-indicator {
          position: fixed;
          bottom: 20px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 9999;
          padding: 10px 16px;
          border-radius: 24px;
          font-size: 14px;
          font-weight: 500;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
          from {
            transform: translateX(-50%) translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
          }
        }

        .offline-indicator.offline {
          background: #1f2937;
          color: #fbbf24;
        }

        .offline-indicator.online {
          background: #065f46;
          color: #d1fae5;
        }

        .offline-indicator.synced {
          background: #065f46;
          color: #d1fae5;
        }

        .offline-indicator-content {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .offline-icon,
        .online-icon,
        .syncing-icon {
          display: flex;
          align-items: center;
        }

        .syncing-icon svg {
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }

        .offline-text {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .pending-badge {
          background: rgba(251, 191, 36, 0.2);
          padding: 2px 8px;
          border-radius: 12px;
          font-size: 12px;
        }

        @media (max-width: 480px) {
          .offline-indicator {
            bottom: 70px; /* Above mobile nav */
            left: 16px;
            right: 16px;
            transform: none;
          }
        }
      `})]})}function o$(){const[t,e]=ne.useState("entry"),[r,a]=ne.useState(null),[n,s]=ne.useState(null),[l,c]=ne.useState([]),[f,d]=ne.useState([]),[m,v]=ne.useState(null),[x,g]=ne.useState(null),[b,_]=ne.useState(null),[w,A]=ne.useState(!0),[C,E]=ne.useState("dashboard"),[R,Y]=ne.useState(null),[W,B]=ne.useState(!1),[q,L]=ne.useState(null);ne.useEffect(()=>{const U=window.location.pathname,k=U.match(/^\/view\/([a-zA-Z0-9]+)$/),F=U.match(/^\/sign\/([a-zA-Z0-9_]+)$/);k?(g(k[1]),e("public"),A(!1)):F?(_(F[1]),e("signature"),A(!1)):J()},[]);const J=async()=>{try{const{data:{user:U}}=await De.auth.getUser();if(!U){A(!1);return}const{data:k,error:F}=await De.from("users").select("*").eq("id",U.id).single();if(k){a(k);const I=await ot.getUserCompanies(U.id);c(I);const z=localStorage.getItem("selectedCompanyId");let te=null;if(z&&I.find(se=>se.id===z))te=I.find(se=>se.id===z);else if(I.length>0)te=I[0];else if(k.company_id){const{data:se}=await De.from("companies").select("*").eq("id",k.company_id).single();te=se}if(te){const{data:se}=await De.from("companies").select("*").eq("id",te.id).single();s(se),e("office")}}}catch(U){console.error("Auth check error:",U)}finally{A(!1)}},D=U=>{v(U),e("foreman")},T=async(U,k)=>{try{const{data:F,error:I}=await De.auth.signInWithPassword({email:U,password:k});if(I){X(I.message||"Invalid credentials","error");return}const{data:z,error:te}=await De.from("users").select("*").eq("id",F.user.id).single();if(te){console.error("User fetch error:",te),X("Error loading profile","error");return}if(z){a(z);const se=await ot.getUserCompanies(F.user.id);c(se);const pe=localStorage.getItem("selectedCompanyId");let ve=null;if(pe&&se.find(_e=>_e.id===pe))ve=se.find(_e=>_e.id===pe);else if(se.length>0)ve=se[0];else if(z.company_id){const{data:_e}=await De.from("companies").select("*").eq("id",z.company_id).single();ve=_e}if(ve){const{data:_e}=await De.from("companies").select("*").eq("id",ve.id).single();s(_e),e("office")}else X("No company access. Please contact admin.","error")}else X("Profile not found. Please contact admin.","error")}catch(F){console.error("Login error:",F),X("Login failed","error")}},M=async U=>{try{const{data:k}=await De.from("companies").select("*").eq("id",U).single();k&&(s(k),localStorage.setItem("selectedCompanyId",U),B(!1),E("dashboard"),X(`Switched to ${k.name}`,"success"))}catch(k){console.error("Switch company error:",k),X("Error switching company","error")}},V=async()=>{try{await kC.signOut(),a(null),s(null),c([]),e("entry"),E("dashboard"),localStorage.removeItem("selectedCompanyId")}catch(U){console.error("Logout error:",U),X("Error signing out","error")}},ie=()=>{v(null),e("entry")},X=(U,k="")=>{Y({message:U,type:k})},Z=()=>{E("dashboard"),n?.id&&K()},K=async()=>{if(n?.id)try{const U=await ot.getProjects(n.id);d(U)}catch(U){console.error("Error loading projects:",U)}};ne.useEffect(()=>{n?.id&&t==="office"&&K()},[n?.id,t]);const re=U=>{if(U.type==="view_all"){E("dashboard"),L(null);return}E("dashboard"),U.projectId&&L(U.projectId)},de=()=>{L(null)};return w?o.jsx(Rd,{companyId:n?.id,children:o.jsxs("div",{className:"loading-screen",children:[o.jsx(Nl,{className:"loading-logo"}),o.jsx("div",{className:"spinner"})]})}):t==="entry"?o.jsxs(Rd,{children:[o.jsx(n0,{children:o.jsx(zT,{onForemanAccess:D,onOfficeLogin:T,onShowToast:X})}),R&&o.jsx(lu,{message:R.message,type:R.type,onClose:()=>Y(null)})]}):t==="public"&&x?o.jsxs(Rd,{children:[o.jsx(n0,{children:o.jsx(a$,{shareToken:x})}),R&&o.jsx(lu,{message:R.message,type:R.type,onClose:()=>Y(null)})]}):t==="signature"&&b?o.jsxs(Rd,{children:[o.jsx(n0,{children:o.jsx(s$,{signatureToken:b})}),R&&o.jsx(lu,{message:R.message,type:R.type,onClose:()=>Y(null)})]}):t==="foreman"&&m?o.jsxs(Rd,{companyId:m.company_id,children:[o.jsx(n0,{children:o.jsx(JT,{project:m,companyId:m.company_id,onShowToast:X,onExit:ie})}),o.jsx(HS,{}),R&&o.jsx(lu,{message:R.message,type:R.type,onClose:()=>Y(null)})]}):o.jsx(Rd,{companyId:n?.id,children:o.jsxs("div",{children:[!Ue&&o.jsx("div",{className:"demo-banner",children:"Demo Mode - Data saved locally in your browser"}),o.jsx("nav",{className:"nav",children:o.jsxs("div",{className:"nav-content",children:[o.jsx(Nl,{}),o.jsxs("div",{className:"nav-tabs",children:[o.jsx("button",{className:`nav-tab ${C==="dashboard"?"active":""}`,onClick:()=>E("dashboard"),children:"Dashboard"}),o.jsx("button",{className:`nav-tab ${C==="setup"?"active":""}`,onClick:()=>E("setup"),children:"+ New Project"}),o.jsx("button",{className:`nav-tab ${C==="pricing"?"active":""}`,onClick:()=>E("pricing"),children:"Pricing"}),o.jsx("button",{className:`nav-tab ${C==="branding"?"active":""}`,onClick:()=>E("branding"),children:"Branding"})]}),o.jsxs("div",{className:"nav-user",children:[o.jsx(i$,{company:n,projects:f,userId:r?.id,onNotificationClick:re,onShowToast:X}),l.length>1&&o.jsxs("div",{className:"company-switcher",children:[o.jsxs("button",{className:"company-switcher-btn",onClick:()=>B(!W),children:[n?.name||"Select Company",o.jsx("span",{className:"switcher-arrow",children:""})]}),W&&o.jsx("div",{className:"company-dropdown",children:l.map(U=>o.jsxs("button",{className:`company-option ${U.id===n?.id?"active":""}`,onClick:()=>M(U.id),children:[U.name,U.id===n?.id&&o.jsx("span",{className:"check",children:""})]},U.id))})]}),l.length<=1&&n&&o.jsx("span",{className:"nav-company-name",children:n.name}),o.jsx("span",{className:"nav-user-name",children:r?.name||r?.email}),o.jsx("button",{className:"nav-logout",onClick:V,children:"Sign Out"})]})]})}),o.jsx(n0,{children:o.jsxs("div",{className:"container",children:[C==="dashboard"&&o.jsx(GH,{company:n,onShowToast:X,navigateToProjectId:q,onProjectNavigated:de}),C==="setup"&&o.jsx(XH,{onProjectCreated:Z,onShowToast:X}),C==="pricing"&&o.jsx(r$,{company:n,onShowToast:X}),C==="branding"&&o.jsx(KH,{company:n,onShowToast:X})]},n?.id)}),o.jsx(HS,{}),R&&o.jsx(lu,{message:R.message,type:R.type,onClose:()=>Y(null)})]})})}BE.createRoot(document.getElementById("root")).render(o.jsx(OE.StrictMode,{children:o.jsx(o$,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered:",t.scope),setInterval(()=>{t.update()},6e4)}).catch(t=>{console.log("SW registration failed:",t)})});export{pa as _,l$ as c,qx as g};
