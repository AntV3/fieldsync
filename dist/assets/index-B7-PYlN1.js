function FE(t,e){for(var r=0;r<e.length;r++){const a=e[r];if(typeof a!="string"&&!Array.isArray(a)){for(const n in a)if(n!=="default"&&!(n in t)){const s=Object.getOwnPropertyDescriptor(a,n);s&&Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:()=>a[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();var C$=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function LE(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function a(){var n=!1;try{n=this instanceof a}catch{}return n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(a){var n=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(r,a,n.get?n:{enumerable:!0,get:function(){return t[a]}})}),r}var $g={exports:{}},n0={};var gb;function PE(){if(gb)return n0;gb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(a,n,s){var l=null;if(s!==void 0&&(l=""+s),n.key!==void 0&&(l=""+n.key),"key"in n){s={};for(var c in n)c!=="key"&&(s[c]=n[c])}else s=n;return n=s.ref,{$$typeof:t,type:a,key:l,ref:n!==void 0?n:null,props:s}}return n0.Fragment=e,n0.jsx=r,n0.jsxs=r,n0}var vb;function ME(){return vb||(vb=1,$g.exports=PE()),$g.exports}var i=ME(),Wg={exports:{}},Cr={};var xb;function IE(){if(xb)return Cr;xb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),x=Symbol.iterator;function g(U){return U===null||typeof U!="object"?null:(U=x&&U[x]||U["@@iterator"],typeof U=="function"?U:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,w={};function E(U,j,F){this.props=U,this.context=j,this.refs=w,this.updater=F||b}E.prototype.isReactComponent={},E.prototype.setState=function(U,j){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,j,"setState")},E.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function C(){}C.prototype=E.prototype;function A(U,j,F){this.props=U,this.context=j,this.refs=w,this.updater=F||b}var O=A.prototype=new C;O.constructor=A,_(O,E.prototype),O.isPureReactComponent=!0;var G=Array.isArray;function W(){}var B={H:null,A:null,T:null,S:null},q=Object.prototype.hasOwnProperty;function L(U,j,F){var I=F.ref;return{$$typeof:t,type:U,key:j,ref:I!==void 0?I:null,props:F}}function Z(U,j){return L(U.type,j,U.props)}function D(U){return typeof U=="object"&&U!==null&&U.$$typeof===t}function T(U){var j={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(F){return j[F]})}var M=/\/+/g;function V(U,j){return typeof U=="object"&&U!==null&&U.key!=null?T(""+U.key):j.toString(36)}function ie(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(W,W):(U.status="pending",U.then(function(j){U.status==="pending"&&(U.status="fulfilled",U.value=j)},function(j){U.status==="pending"&&(U.status="rejected",U.reason=j)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function X(U,j,F,I,z){var ne=typeof U;(ne==="undefined"||ne==="boolean")&&(U=null);var se=!1;if(U===null)se=!0;else switch(ne){case"bigint":case"string":case"number":se=!0;break;case"object":switch(U.$$typeof){case t:case e:se=!0;break;case m:return se=U._init,X(se(U._payload),j,F,I,z)}}if(se)return z=z(U),se=I===""?"."+V(U,0):I,G(z)?(F="",se!=null&&(F=se.replace(M,"$&/")+"/"),X(z,j,F,"",function(ge){return ge})):z!=null&&(D(z)&&(z=Z(z,F+(z.key==null||U&&U.key===z.key?"":(""+z.key).replace(M,"$&/")+"/")+se)),j.push(z)),1;se=0;var je=I===""?".":I+":";if(G(U))for(var Ne=0;Ne<U.length;Ne++)I=U[Ne],ne=je+V(I,Ne),se+=X(I,j,F,ne,z);else if(Ne=g(U),typeof Ne=="function")for(U=Ne.call(U),Ne=0;!(I=U.next()).done;)I=I.value,ne=je+V(I,Ne++),se+=X(I,j,F,ne,z);else if(ne==="object"){if(typeof U.then=="function")return X(ie(U),j,F,I,z);throw j=String(U),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.")}return se}function J(U,j,F){if(U==null)return U;var I=[],z=0;return X(U,I,"","",function(ne){return j.call(F,ne,z++)}),I}function K(U){if(U._status===-1){var j=U._result;j=j(),j.then(function(F){(U._status===0||U._status===-1)&&(U._status=1,U._result=F)},function(F){(U._status===0||U._status===-1)&&(U._status=2,U._result=F)}),U._status===-1&&(U._status=0,U._result=j)}if(U._status===1)return U._result.default;throw U._result}var te=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var j=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(j))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},fe={map:J,forEach:function(U,j,F){J(U,function(){j.apply(this,arguments)},F)},count:function(U){var j=0;return J(U,function(){j++}),j},toArray:function(U){return J(U,function(j){return j})||[]},only:function(U){if(!D(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return Cr.Activity=v,Cr.Children=fe,Cr.Component=E,Cr.Fragment=r,Cr.Profiler=n,Cr.PureComponent=A,Cr.StrictMode=a,Cr.Suspense=d,Cr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,Cr.__COMPILER_RUNTIME={__proto__:null,c:function(U){return B.H.useMemoCache(U)}},Cr.cache=function(U){return function(){return U.apply(null,arguments)}},Cr.cacheSignal=function(){return null},Cr.cloneElement=function(U,j,F){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var I=_({},U.props),z=U.key;if(j!=null)for(ne in j.key!==void 0&&(z=""+j.key),j)!q.call(j,ne)||ne==="key"||ne==="__self"||ne==="__source"||ne==="ref"&&j.ref===void 0||(I[ne]=j[ne]);var ne=arguments.length-2;if(ne===1)I.children=F;else if(1<ne){for(var se=Array(ne),je=0;je<ne;je++)se[je]=arguments[je+2];I.children=se}return L(U.type,z,I)},Cr.createContext=function(U){return U={$$typeof:l,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:s,_context:U},U},Cr.createElement=function(U,j,F){var I,z={},ne=null;if(j!=null)for(I in j.key!==void 0&&(ne=""+j.key),j)q.call(j,I)&&I!=="key"&&I!=="__self"&&I!=="__source"&&(z[I]=j[I]);var se=arguments.length-2;if(se===1)z.children=F;else if(1<se){for(var je=Array(se),Ne=0;Ne<se;Ne++)je[Ne]=arguments[Ne+2];z.children=je}if(U&&U.defaultProps)for(I in se=U.defaultProps,se)z[I]===void 0&&(z[I]=se[I]);return L(U,ne,z)},Cr.createRef=function(){return{current:null}},Cr.forwardRef=function(U){return{$$typeof:c,render:U}},Cr.isValidElement=D,Cr.lazy=function(U){return{$$typeof:m,_payload:{_status:-1,_result:U},_init:K}},Cr.memo=function(U,j){return{$$typeof:f,type:U,compare:j===void 0?null:j}},Cr.startTransition=function(U){var j=B.T,F={};B.T=F;try{var I=U(),z=B.S;z!==null&&z(F,I),typeof I=="object"&&I!==null&&typeof I.then=="function"&&I.then(W,te)}catch(ne){te(ne)}finally{j!==null&&F.types!==null&&(j.types=F.types),B.T=j}},Cr.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},Cr.use=function(U){return B.H.use(U)},Cr.useActionState=function(U,j,F){return B.H.useActionState(U,j,F)},Cr.useCallback=function(U,j){return B.H.useCallback(U,j)},Cr.useContext=function(U){return B.H.useContext(U)},Cr.useDebugValue=function(){},Cr.useDeferredValue=function(U,j){return B.H.useDeferredValue(U,j)},Cr.useEffect=function(U,j){return B.H.useEffect(U,j)},Cr.useEffectEvent=function(U){return B.H.useEffectEvent(U)},Cr.useId=function(){return B.H.useId()},Cr.useImperativeHandle=function(U,j,F){return B.H.useImperativeHandle(U,j,F)},Cr.useInsertionEffect=function(U,j){return B.H.useInsertionEffect(U,j)},Cr.useLayoutEffect=function(U,j){return B.H.useLayoutEffect(U,j)},Cr.useMemo=function(U,j){return B.H.useMemo(U,j)},Cr.useOptimistic=function(U,j){return B.H.useOptimistic(U,j)},Cr.useReducer=function(U,j,F){return B.H.useReducer(U,j,F)},Cr.useRef=function(U){return B.H.useRef(U)},Cr.useState=function(U){return B.H.useState(U)},Cr.useSyncExternalStore=function(U,j,F){return B.H.useSyncExternalStore(U,j,F)},Cr.useTransition=function(){return B.H.useTransition()},Cr.version="19.2.0",Cr}var yb;function Yx(){return yb||(yb=1,Wg.exports=IE()),Wg.exports}var ee=Yx();const BE=Gx(ee);var Vg={exports:{}},s0={},Gg={exports:{}},Yg={};var _b;function UE(){return _b||(_b=1,(function(t){function e(X,J){var K=X.length;X.push(J);e:for(;0<K;){var te=K-1>>>1,fe=X[te];if(0<n(fe,J))X[te]=J,X[K]=fe,K=te;else break e}}function r(X){return X.length===0?null:X[0]}function a(X){if(X.length===0)return null;var J=X[0],K=X.pop();if(K!==J){X[0]=K;e:for(var te=0,fe=X.length,U=fe>>>1;te<U;){var j=2*(te+1)-1,F=X[j],I=j+1,z=X[I];if(0>n(F,K))I<fe&&0>n(z,F)?(X[te]=z,X[I]=K,te=I):(X[te]=F,X[j]=K,te=j);else if(I<fe&&0>n(z,K))X[te]=z,X[I]=K,te=I;else break e}}return J}function n(X,J){var K=X.sortIndex-J.sortIndex;return K!==0?K:X.id-J.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var d=[],f=[],m=1,v=null,x=3,g=!1,b=!1,_=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function O(X){for(var J=r(f);J!==null;){if(J.callback===null)a(f);else if(J.startTime<=X)a(f),J.sortIndex=J.expirationTime,e(d,J);else break;J=r(f)}}function G(X){if(_=!1,O(X),!b)if(r(d)!==null)b=!0,W||(W=!0,T());else{var J=r(f);J!==null&&ie(G,J.startTime-X)}}var W=!1,B=-1,q=5,L=-1;function Z(){return w?!0:!(t.unstable_now()-L<q)}function D(){if(w=!1,W){var X=t.unstable_now();L=X;var J=!0;try{e:{b=!1,_&&(_=!1,C(B),B=-1),g=!0;var K=x;try{t:{for(O(X),v=r(d);v!==null&&!(v.expirationTime>X&&Z());){var te=v.callback;if(typeof te=="function"){v.callback=null,x=v.priorityLevel;var fe=te(v.expirationTime<=X);if(X=t.unstable_now(),typeof fe=="function"){v.callback=fe,O(X),J=!0;break t}v===r(d)&&a(d),O(X)}else a(d);v=r(d)}if(v!==null)J=!0;else{var U=r(f);U!==null&&ie(G,U.startTime-X),J=!1}}break e}finally{v=null,x=K,g=!1}J=void 0}}finally{J?T():W=!1}}}var T;if(typeof A=="function")T=function(){A(D)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,V=M.port2;M.port1.onmessage=D,T=function(){V.postMessage(null)}}else T=function(){E(D,0)};function ie(X,J){B=E(function(){X(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(X){switch(x){case 1:case 2:case 3:var J=3;break;default:J=x}var K=x;x=J;try{return X()}finally{x=K}},t.unstable_requestPaint=function(){w=!0},t.unstable_runWithPriority=function(X,J){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var K=x;x=X;try{return J()}finally{x=K}},t.unstable_scheduleCallback=function(X,J,K){var te=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?te+K:te):K=te,X){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=K+fe,X={id:m++,callback:J,priorityLevel:X,startTime:K,expirationTime:fe,sortIndex:-1},K>te?(X.sortIndex=K,e(f,X),r(d)===null&&X===r(f)&&(_?(C(B),B=-1):_=!0,ie(G,K-te))):(X.sortIndex=fe,e(d,X),b||g||(b=!0,W||(W=!0,T()))),X},t.unstable_shouldYield=Z,t.unstable_wrapCallback=function(X){var J=x;return function(){var K=x;x=J;try{return X.apply(this,arguments)}finally{x=K}}}})(Yg)),Yg}var bb;function qE(){return bb||(bb=1,Gg.exports=UE()),Gg.exports}var Xg={exports:{}},js={};var wb;function zE(){if(wb)return js;wb=1;var t=Yx();function e(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function s(d,f,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:v==null?null:""+v,children:d,containerInfo:f,implementation:m}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return js.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,js.createPortal=function(d,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return s(d,f,null,m)},js.flushSync=function(d){var f=l.T,m=a.p;try{if(l.T=null,a.p=2,d)return d()}finally{l.T=f,a.p=m,a.d.f()}},js.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,a.d.C(d,f))},js.prefetchDNS=function(d){typeof d=="string"&&a.d.D(d)},js.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var m=f.as,v=c(m,f.crossOrigin),x=typeof f.integrity=="string"?f.integrity:void 0,g=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?a.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:v,integrity:x,fetchPriority:g}):m==="script"&&a.d.X(d,{crossOrigin:v,integrity:x,fetchPriority:g,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},js.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=c(f.as,f.crossOrigin);a.d.M(d,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&a.d.M(d)},js.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,v=c(m,f.crossOrigin);a.d.L(d,m,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},js.preloadModule=function(d,f){if(typeof d=="string")if(f){var m=c(f.as,f.crossOrigin);a.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else a.d.m(d)},js.requestFormReset=function(d){a.d.r(d)},js.unstable_batchedUpdates=function(d,f){return d(f)},js.useFormState=function(d,f,m){return l.H.useFormState(d,f,m)},js.useFormStatus=function(){return l.H.useHostTransitionStatus()},js.version="19.2.0",js}var Sb;function HE(){if(Sb)return Xg.exports;Sb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Xg.exports=zE(),Xg.exports}var Nb;function $E(){if(Nb)return s0;Nb=1;var t=qE(),e=Yx(),r=HE();function a(o){var u="https://react.dev/errors/"+o;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+o+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function s(o){var u=o,h=o;if(o.alternate)for(;u.return;)u=u.return;else{o=u;do u=o,(u.flags&4098)!==0&&(h=u.return),o=u.return;while(o)}return u.tag===3?h:null}function l(o){if(o.tag===13){var u=o.memoizedState;if(u===null&&(o=o.alternate,o!==null&&(u=o.memoizedState)),u!==null)return u.dehydrated}return null}function c(o){if(o.tag===31){var u=o.memoizedState;if(u===null&&(o=o.alternate,o!==null&&(u=o.memoizedState)),u!==null)return u.dehydrated}return null}function d(o){if(s(o)!==o)throw Error(a(188))}function f(o){var u=o.alternate;if(!u){if(u=s(o),u===null)throw Error(a(188));return u!==o?null:o}for(var h=o,p=u;;){var S=h.return;if(S===null)break;var k=S.alternate;if(k===null){if(p=S.return,p!==null){h=p;continue}break}if(S.child===k.child){for(k=S.child;k;){if(k===h)return d(S),o;if(k===p)return d(S),u;k=k.sibling}throw Error(a(188))}if(h.return!==p.return)h=S,p=k;else{for(var Y=!1,de=S.child;de;){if(de===h){Y=!0,h=S,p=k;break}if(de===p){Y=!0,p=S,h=k;break}de=de.sibling}if(!Y){for(de=k.child;de;){if(de===h){Y=!0,h=k,p=S;break}if(de===p){Y=!0,p=k,h=S;break}de=de.sibling}if(!Y)throw Error(a(189))}}if(h.alternate!==p)throw Error(a(190))}if(h.tag!==3)throw Error(a(188));return h.stateNode.current===h?o:u}function m(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o;for(o=o.child;o!==null;){if(u=m(o),u!==null)return u;o=o.sibling}return null}var v=Object.assign,x=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),A=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),Z=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function T(o){return o===null||typeof o!="object"?null:(o=D&&o[D]||o["@@iterator"],typeof o=="function"?o:null)}var M=Symbol.for("react.client.reference");function V(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===M?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case _:return"Fragment";case E:return"Profiler";case w:return"StrictMode";case G:return"Suspense";case W:return"SuspenseList";case L:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case b:return"Portal";case A:return o.displayName||"Context";case C:return(o._context.displayName||"Context")+".Consumer";case O:var u=o.render;return o=o.displayName,o||(o=u.displayName||u.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case B:return u=o.displayName||null,u!==null?u:V(o.type)||"Memo";case q:u=o._payload,o=o._init;try{return V(o(u))}catch{}}return null}var ie=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},te=[],fe=-1;function U(o){return{current:o}}function j(o){0>fe||(o.current=te[fe],te[fe]=null,fe--)}function F(o,u){fe++,te[fe]=o.current,o.current=u}var I=U(null),z=U(null),ne=U(null),se=U(null);function je(o,u){switch(F(ne,u),F(z,o),F(I,null),u.nodeType){case 9:case 11:o=(o=u.documentElement)&&(o=o.namespaceURI)?B_(o):0;break;default:if(o=u.tagName,u=u.namespaceURI)u=B_(u),o=U_(u,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}j(I),F(I,o)}function Ne(){j(I),j(z),j(ne)}function ge(o){o.memoizedState!==null&&F(se,o);var u=I.current,h=U_(u,o.type);u!==h&&(F(z,o),F(I,h))}function Ie(o){z.current===o&&(j(I),j(z)),se.current===o&&(j(se),e0._currentValue=K)}var le,Ge;function rt(o){if(le===void 0)try{throw Error()}catch(h){var u=h.stack.trim().match(/\n( *(at )?)/);le=u&&u[1]||"",Ge=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+le+o+Ge}var ue=!1;function ot(o,u){if(!o||ue)return"";ue=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(u){var xt=function(){throw Error()};if(Object.defineProperty(xt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xt,[])}catch(it){var at=it}Reflect.construct(o,[],xt)}else{try{xt.call()}catch(it){at=it}o.call(xt.prototype)}}else{try{throw Error()}catch(it){at=it}(xt=o())&&typeof xt.catch=="function"&&xt.catch(function(){})}}catch(it){if(it&&at&&typeof it.stack=="string")return[it.stack,at.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=p.DetermineComponentFrameRoot(),Y=k[0],de=k[1];if(Y&&de){var Oe=Y.split(`
`),tt=de.split(`
`);for(S=p=0;p<Oe.length&&!Oe[p].includes("DetermineComponentFrameRoot");)p++;for(;S<tt.length&&!tt[S].includes("DetermineComponentFrameRoot");)S++;if(p===Oe.length||S===tt.length)for(p=Oe.length-1,S=tt.length-1;1<=p&&0<=S&&Oe[p]!==tt[S];)S--;for(;1<=p&&0<=S;p--,S--)if(Oe[p]!==tt[S]){if(p!==1||S!==1)do if(p--,S--,0>S||Oe[p]!==tt[S]){var ht=`
`+Oe[p].replace(" at new "," at ");return o.displayName&&ht.includes("<anonymous>")&&(ht=ht.replace("<anonymous>",o.displayName)),ht}while(1<=p&&0<=S);break}}}finally{ue=!1,Error.prepareStackTrace=h}return(h=o?o.displayName||o.name:"")?rt(h):""}function xe(o,u){switch(o.tag){case 26:case 27:case 5:return rt(o.type);case 16:return rt("Lazy");case 13:return o.child!==u&&u!==null?rt("Suspense Fallback"):rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return ot(o.type,!1);case 11:return ot(o.type.render,!1);case 1:return ot(o.type,!0);case 31:return rt("Activity");default:return""}}function ve(o){try{var u="",h=null;do u+=xe(o,h),h=o,o=o.return;while(o);return u}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Be=Object.prototype.hasOwnProperty,jt=t.unstable_scheduleCallback,Je=t.unstable_cancelCallback,ct=t.unstable_shouldYield,St=t.unstable_requestPaint,Ft=t.unstable_now,Xt=t.unstable_getCurrentPriorityLevel,Ut=t.unstable_ImmediatePriority,Wt=t.unstable_UserBlockingPriority,$t=t.unstable_NormalPriority,wt=t.unstable_LowPriority,Ce=t.unstable_IdlePriority,st=t.log,Dt=t.unstable_setDisableYieldValue,At=null,Ct=null;function Te(o){if(typeof st=="function"&&Dt(o),Ct&&typeof Ct.setStrictMode=="function")try{Ct.setStrictMode(At,o)}catch{}}var Ve=Math.clz32?Math.clz32:Fe,_e=Math.log,Ue=Math.LN2;function Fe(o){return o>>>=0,o===0?32:31-(_e(o)/Ue|0)|0}var gt=256,Ht=262144,Vt=4194304;function zt(o){var u=o&42;if(u!==0)return u;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return o&261888;case 262144:case 524288:case 1048576:case 2097152:return o&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function kt(o,u,h){var p=o.pendingLanes;if(p===0)return 0;var S=0,k=o.suspendedLanes,Y=o.pingedLanes;o=o.warmLanes;var de=p&134217727;return de!==0?(p=de&~k,p!==0?S=zt(p):(Y&=de,Y!==0?S=zt(Y):h||(h=de&~o,h!==0&&(S=zt(h))))):(de=p&~k,de!==0?S=zt(de):Y!==0?S=zt(Y):h||(h=p&~o,h!==0&&(S=zt(h)))),S===0?0:u!==0&&u!==S&&(u&k)===0&&(k=S&-S,h=u&-u,k>=h||k===32&&(h&4194048)!==0)?u:S}function sr(o,u){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&u)===0}function Pr(o,u){switch(o){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nt(){var o=Vt;return Vt<<=1,(Vt&62914560)===0&&(Vt=4194304),o}function fa(o){for(var u=[],h=0;31>h;h++)u.push(o);return u}function ir(o,u){o.pendingLanes|=u,u!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function Ea(o,u,h,p,S,k){var Y=o.pendingLanes;o.pendingLanes=h,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=h,o.entangledLanes&=h,o.errorRecoveryDisabledLanes&=h,o.shellSuspendCounter=0;var de=o.entanglements,Oe=o.expirationTimes,tt=o.hiddenUpdates;for(h=Y&~h;0<h;){var ht=31-Ve(h),xt=1<<ht;de[ht]=0,Oe[ht]=-1;var at=tt[ht];if(at!==null)for(tt[ht]=null,ht=0;ht<at.length;ht++){var it=at[ht];it!==null&&(it.lane&=-536870913)}h&=~xt}p!==0&&xn(o,p,0),k!==0&&S===0&&o.tag!==0&&(o.suspendedLanes|=k&~(Y&~u))}function xn(o,u,h){o.pendingLanes|=u,o.suspendedLanes&=~u;var p=31-Ve(u);o.entangledLanes|=u,o.entanglements[p]=o.entanglements[p]|1073741824|h&261930}function Ra(o,u){var h=o.entangledLanes|=u;for(o=o.entanglements;h;){var p=31-Ve(h),S=1<<p;S&u|o[p]&u&&(o[p]|=u),h&=~S}}function nn(o,u){var h=u&-u;return h=(h&42)!==0?1:Pt(h),(h&(o.suspendedLanes|u))!==0?0:h}function Pt(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Zt(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function ae(){var o=J.p;return o!==0?o:(o=window.event,o===void 0?32:cb(o.type))}function be(o,u){var h=J.p;try{return J.p=o,u()}finally{J.p=h}}var me=Math.random().toString(36).slice(2),pe="__reactFiber$"+me,Se="__reactProps$"+me,we="__reactContainer$"+me,$e="__reactEvents$"+me,lt="__reactListeners$"+me,Xe="__reactHandles$"+me,Ke="__reactResources$"+me,Qe="__reactMarker$"+me;function Et(o){delete o[pe],delete o[Se],delete o[$e],delete o[lt],delete o[Xe]}function Rt(o){var u=o[pe];if(u)return u;for(var h=o.parentNode;h;){if(u=h[we]||h[pe]){if(h=u.alternate,u.child!==null||h!==null&&h.child!==null)for(o=G_(o);o!==null;){if(h=o[pe])return h;o=G_(o)}return u}o=h,h=o.parentNode}return null}function qt(o){if(o=o[pe]||o[we]){var u=o.tag;if(u===5||u===6||u===13||u===31||u===26||u===27||u===3)return o}return null}function Ot(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o.stateNode;throw Error(a(33))}function Mt(o){var u=o[Ke];return u||(u=o[Ke]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function Jt(o){o[Qe]=!0}var oa=new Set,Mr={};function da(o,u){ls(o,u),ls(o+"Capture",u)}function ls(o,u){for(Mr[o]=u,o=0;o<u.length;o++)oa.add(u[o])}var gi=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),vi={},Bs={};function rl(o){return Be.call(Bs,o)?!0:Be.call(vi,o)?!1:gi.test(o)?Bs[o]=!0:(vi[o]=!0,!1)}function Fa(o,u,h){if(rl(u))if(h===null)o.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":o.removeAttribute(u);return;case"boolean":var p=u.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){o.removeAttribute(u);return}}o.setAttribute(u,""+h)}}function vo(o,u,h){if(h===null)o.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(u);return}o.setAttribute(u,""+h)}}function xi(o,u,h,p){if(p===null)o.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(h);return}o.setAttributeNS(u,h,""+p)}}function Qr(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Eu(o){var u=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function zi(o,u,h){var p=Object.getOwnPropertyDescriptor(o.constructor.prototype,u);if(!o.hasOwnProperty(u)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,k=p.set;return Object.defineProperty(o,u,{configurable:!0,get:function(){return S.call(this)},set:function(Y){h=""+Y,k.call(this,Y)}}),Object.defineProperty(o,u,{enumerable:p.enumerable}),{getValue:function(){return h},setValue:function(Y){h=""+Y},stopTracking:function(){o._valueTracker=null,delete o[u]}}}}function al(o){if(!o._valueTracker){var u=Eu(o)?"checked":"value";o._valueTracker=zi(o,u,""+o[u])}}function Au(o){if(!o)return!1;var u=o._valueTracker;if(!u)return!0;var h=u.getValue(),p="";return o&&(p=Eu(o)?o.checked?"true":"false":o.value),o=p,o!==h?(u.setValue(o),!0):!1}function cs(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var yn=/[\n"\\]/g;function sn(o){return o.replace(yn,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function jc(o,u,h,p,S,k,Y,de){o.name="",Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?o.type=Y:o.removeAttribute("type"),u!=null?Y==="number"?(u===0&&o.value===""||o.value!=u)&&(o.value=""+Qr(u)):o.value!==""+Qr(u)&&(o.value=""+Qr(u)):Y!=="submit"&&Y!=="reset"||o.removeAttribute("value"),u!=null?Cu(o,Y,Qr(u)):h!=null?Cu(o,Y,Qr(h)):p!=null&&o.removeAttribute("value"),S==null&&k!=null&&(o.defaultChecked=!!k),S!=null&&(o.checked=S&&typeof S!="function"&&typeof S!="symbol"),de!=null&&typeof de!="function"&&typeof de!="symbol"&&typeof de!="boolean"?o.name=""+Qr(de):o.removeAttribute("name")}function qd(o,u,h,p,S,k,Y,de){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(o.type=k),u!=null||h!=null){if(!(k!=="submit"&&k!=="reset"||u!=null)){al(o);return}h=h!=null?""+Qr(h):"",u=u!=null?""+Qr(u):h,de||u===o.value||(o.value=u),o.defaultValue=u}p=p??S,p=typeof p!="function"&&typeof p!="symbol"&&!!p,o.checked=de?o.checked:!!p,o.defaultChecked=!!p,Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"&&(o.name=Y),al(o)}function Cu(o,u,h){u==="number"&&cs(o.ownerDocument)===o||o.defaultValue===""+h||(o.defaultValue=""+h)}function us(o,u,h,p){if(o=o.options,u){u={};for(var S=0;S<h.length;S++)u["$"+h[S]]=!0;for(h=0;h<o.length;h++)S=u.hasOwnProperty("$"+o[h].value),o[h].selected!==S&&(o[h].selected=S),S&&p&&(o[h].defaultSelected=!0)}else{for(h=""+Qr(h),u=null,S=0;S<o.length;S++){if(o[S].value===h){o[S].selected=!0,p&&(o[S].defaultSelected=!0);return}u!==null||o[S].disabled||(u=o[S])}u!==null&&(u.selected=!0)}}function Tu(o,u,h){if(u!=null&&(u=""+Qr(u),u!==o.value&&(o.value=u),h==null)){o.defaultValue!==u&&(o.defaultValue=u);return}o.defaultValue=h!=null?""+Qr(h):""}function Ou(o,u,h,p){if(u==null){if(p!=null){if(h!=null)throw Error(a(92));if(ie(p)){if(1<p.length)throw Error(a(93));p=p[0]}h=p}h==null&&(h=""),u=h}h=Qr(u),o.defaultValue=h,p=o.textContent,p===h&&p!==""&&p!==null&&(o.value=p),al(o)}function yi(o,u){if(u){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=u;return}}o.textContent=u}var Rl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zd(o,u,h){var p=u.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?p?o.setProperty(u,""):u==="float"?o.cssFloat="":o[u]="":p?o.setProperty(u,h):typeof h!="number"||h===0||Rl.has(u)?u==="float"?o.cssFloat=h:o[u]=(""+h).trim():o[u]=h+"px"}function Hd(o,u,h){if(u!=null&&typeof u!="object")throw Error(a(62));if(o=o.style,h!=null){for(var p in h)!h.hasOwnProperty(p)||u!=null&&u.hasOwnProperty(p)||(p.indexOf("--")===0?o.setProperty(p,""):p==="float"?o.cssFloat="":o[p]="");for(var S in u)p=u[S],u.hasOwnProperty(S)&&h[S]!==p&&zd(o,S,p)}else for(var k in u)u.hasOwnProperty(k)&&zd(o,k,u[k])}function Ru(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Du=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),$d=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ws(o){return $d.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}function _i(){}var xo=null;function Dl(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var nl=null,vr=null;function Wd(o){var u=qt(o);if(u&&(o=u.stateNode)){var h=o[Se]||null;e:switch(o=u.stateNode,u.type){case"input":if(jc(o,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),u=h.name,h.type==="radio"&&u!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+sn(""+u)+'"][type="radio"]'),u=0;u<h.length;u++){var p=h[u];if(p!==o&&p.form===o.form){var S=p[Se]||null;if(!S)throw Error(a(90));jc(p,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(u=0;u<h.length;u++)p=h[u],p.form===o.form&&Au(p)}break e;case"textarea":Tu(o,h.value,h.defaultValue);break e;case"select":u=h.value,u!=null&&us(o,!!h.multiple,u,!1)}}}var Fu=!1;function Vd(o,u,h){if(Fu)return o(u,h);Fu=!0;try{var p=o(u);return p}finally{if(Fu=!1,(nl!==null||vr!==null)&&(Dm(),nl&&(u=nl,o=vr,vr=nl=null,Wd(u),o)))for(u=0;u<o.length;u++)Wd(o[u])}}function Us(o,u){var h=o.stateNode;if(h===null)return null;var p=h[Se]||null;if(p===null)return null;h=p[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(o=o.type,p=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!p;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(a(231,u,typeof h));return h}var Un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lu=!1;if(Un)try{var Fl={};Object.defineProperty(Fl,"passive",{get:function(){Lu=!0}}),window.addEventListener("test",Fl,Fl),window.removeEventListener("test",Fl,Fl)}catch{Lu=!1}var qs=null,Ll=null,Hi=null;function Gd(){if(Hi)return Hi;var o,u=Ll,h=u.length,p,S="value"in qs?qs.value:qs.textContent,k=S.length;for(o=0;o<h&&u[o]===S[o];o++);var Y=h-o;for(p=1;p<=Y&&u[h-p]===S[k-p];p++);return Hi=S.slice(o,1<p?1-p:void 0)}function Xs(o){var u=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&u===13&&(o=13)):o=u,o===10&&(o=13),32<=o||o===13?o:0}function kc(){return!0}function Ec(){return!1}function On(o){function u(h,p,S,k,Y){this._reactName=h,this._targetInst=S,this.type=p,this.nativeEvent=k,this.target=Y,this.currentTarget=null;for(var de in o)o.hasOwnProperty(de)&&(h=o[de],this[de]=h?h(k):k[de]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?kc:Ec,this.isPropagationStopped=Ec,this}return v(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=kc)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=kc)},persist:function(){},isPersistent:kc}),u}var $i={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ks=On($i),yo=v({},$i,{view:0,detail:0}),Ac=On(yo),Pl,_o,bo,Ml=v({},yo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_r,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==bo&&(bo&&o.type==="mousemove"?(Pl=o.screenX-bo.screenX,_o=o.screenY-bo.screenY):_o=Pl=0,bo=o),Pl)},movementY:function(o){return"movementY"in o?o.movementY:_o}}),Pu=On(Ml),wo=v({},Ml,{dataTransfer:0}),So=On(wo),Yd=v({},yo,{relatedTarget:0}),No=On(Yd),Xd=v({},$i,{animationName:0,elapsedTime:0,pseudoElement:0}),R=On(Xd),Q=v({},$i,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Ae=On(Q),Re=v({},$i,{data:0}),ze=On(Re),mt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_t={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},er={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function or(o){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(o):(o=er[o])?!!u[o]:!1}function _r(){return or}var Er=v({},yo,{key:function(o){if(o.key){var u=mt[o.key]||o.key;if(u!=="Unidentified")return u}return o.type==="keypress"?(o=Xs(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?_t[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_r,charCode:function(o){return o.type==="keypress"?Xs(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Xs(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Vr=On(Er),La=v({},Ml,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ka=On(La),_a=v({},yo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_r}),_n=On(_a),on=v({},$i,{propertyName:0,elapsedTime:0,pseudoElement:0}),qn=On(on),jo=v({},Ml,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),bi=On(jo),ko=v({},$i,{newState:0,oldState:0}),Mu=On(ko),Cc=[9,13,27,32],Wi=Un&&"CompositionEvent"in window,wi=null;Un&&"documentMode"in document&&(wi=document.documentMode);var Il=Un&&"TextEvent"in window&&!wi,Eo=Un&&(!Wi||wi&&8<wi&&11>=wi),Rn=" ",sl=!1;function il(o,u){switch(o){case"keyup":return Cc.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tc(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Vi=!1;function ds(o,u){switch(o){case"compositionend":return Tc(u);case"keypress":return u.which!==32?null:(sl=!0,Rn);case"textInput":return o=u.data,o===Rn&&sl?null:o;default:return null}}function Ao(o,u){if(Vi)return o==="compositionend"||!Wi&&il(o,u)?(o=Gd(),Hi=Ll=qs=null,Vi=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Eo&&u.locale!=="ko"?null:u.data;default:return null}}var Oc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Iu(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u==="input"?!!Oc[o.type]:u==="textarea"}function zs(o,u,h,p){nl?vr?vr.push(p):vr=[p]:nl=p,u=Um(u,"onChange"),0<u.length&&(h=new Ks("onChange","change",null,h,p),o.push({event:h,listeners:u}))}var Si=null,Co=null;function Bu(o){D_(o,0)}function Ni(o){var u=Ot(o);if(Au(u))return o}function ol(o,u){if(o==="change")return u}var Ss=!1;if(Un){var fs;if(Un){var Gi="oninput"in document;if(!Gi){var Yi=document.createElement("div");Yi.setAttribute("oninput","return;"),Gi=typeof Yi.oninput=="function"}fs=Gi}else fs=!1;Ss=fs&&(!document.documentMode||9<document.documentMode)}function To(){Si&&(Si.detachEvent("onpropertychange",Rc),Co=Si=null)}function Rc(o){if(o.propertyName==="value"&&Ni(Co)){var u=[];zs(u,Co,o,Dl(o)),Vd(Bu,u)}}function Dc(o,u,h){o==="focusin"?(To(),Si=u,Co=h,Si.attachEvent("onpropertychange",Rc)):o==="focusout"&&To()}function Ja(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Ni(Co)}function Kd(o,u){if(o==="click")return Ni(u)}function Xi(o,u){if(o==="input"||o==="change")return Ni(u)}function Ki(o,u){return o===u&&(o!==0||1/o===1/u)||o!==o&&u!==u}var zn=typeof Object.is=="function"?Object.is:Ki;function Oo(o,u){if(zn(o,u))return!0;if(typeof o!="object"||o===null||typeof u!="object"||u===null)return!1;var h=Object.keys(o),p=Object.keys(u);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var S=h[p];if(!Be.call(u,S)||!zn(o[S],u[S]))return!1}return!0}function Fc(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Lc(o,u){var h=Fc(o);o=0;for(var p;h;){if(h.nodeType===3){if(p=o+h.textContent.length,o<=u&&p>=u)return{node:h,offset:u-o};o=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Fc(h)}}function Ro(o,u){return o&&u?o===u?!0:o&&o.nodeType===3?!1:u&&u.nodeType===3?Ro(o,u.parentNode):"contains"in o?o.contains(u):o.compareDocumentPosition?!!(o.compareDocumentPosition(u)&16):!1:!1}function Do(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var u=cs(o.document);u instanceof o.HTMLIFrameElement;){try{var h=typeof u.contentWindow.location.href=="string"}catch{h=!1}if(h)o=u.contentWindow;else break;u=cs(o.document)}return u}function Ji(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u&&(u==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||u==="textarea"||o.contentEditable==="true")}var Bl=Un&&"documentMode"in document&&11>=document.documentMode,Hs=null,Fo=null,Zn=null,Js=!1;function ea(o,u,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Js||Hs==null||Hs!==cs(p)||(p=Hs,"selectionStart"in p&&Ji(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Zn&&Oo(Zn,p)||(Zn=p,p=Um(Fo,"onSelect"),0<p.length&&(u=new Ks("onSelect","select",null,u,h),o.push({event:u,listeners:p}),u.target=Hs)))}function Gr(o,u){var h={};return h[o.toLowerCase()]=u.toLowerCase(),h["Webkit"+o]="webkit"+u,h["Moz"+o]="moz"+u,h}var ba={animationend:Gr("Animation","AnimationEnd"),animationiteration:Gr("Animation","AnimationIteration"),animationstart:Gr("Animation","AnimationStart"),transitionrun:Gr("Transition","TransitionRun"),transitionstart:Gr("Transition","TransitionStart"),transitioncancel:Gr("Transition","TransitionCancel"),transitionend:Gr("Transition","TransitionEnd")},Za={},Zi={};Un&&(Zi=document.createElement("div").style,"AnimationEvent"in window||(delete ba.animationend.animation,delete ba.animationiteration.animation,delete ba.animationstart.animation),"TransitionEvent"in window||delete ba.transitionend.transition);function ji(o){if(Za[o])return Za[o];if(!ba[o])return o;var u=ba[o],h;for(h in u)if(u.hasOwnProperty(h)&&h in Zi)return Za[o]=u[h];return o}var Ul=ji("animationend"),Uu=ji("animationiteration"),Sh=ji("animationstart"),cm=ji("transitionrun"),um=ji("transitionstart"),dm=ji("transitioncancel"),Nh=ji("transitionend"),jh=new Map,ql="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ql.push("scrollEnd");function Zs(o,u){jh.set(o,u),da(u,[o])}var qu=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)},$s=[],zl=0,Jd=0;function zu(){for(var o=zl,u=Jd=zl=0;u<o;){var h=$s[u];$s[u++]=null;var p=$s[u];$s[u++]=null;var S=$s[u];$s[u++]=null;var k=$s[u];if($s[u++]=null,p!==null&&S!==null){var Y=p.pending;Y===null?S.next=S:(S.next=Y.next,Y.next=S),p.pending=S}k!==0&&$u(h,S,k)}}function Hu(o,u,h,p){$s[zl++]=o,$s[zl++]=u,$s[zl++]=h,$s[zl++]=p,Jd|=p,o.lanes|=p,o=o.alternate,o!==null&&(o.lanes|=p)}function Zd(o,u,h,p){return Hu(o,u,h,p),Qn(o)}function Lo(o,u){return Hu(o,null,null,u),Qn(o)}function $u(o,u,h){o.lanes|=h;var p=o.alternate;p!==null&&(p.lanes|=h);for(var S=!1,k=o.return;k!==null;)k.childLanes|=h,p=k.alternate,p!==null&&(p.childLanes|=h),k.tag===22&&(o=k.stateNode,o===null||o._visibility&1||(S=!0)),o=k,k=k.return;return o.tag===3?(k=o.stateNode,S&&u!==null&&(S=31-Ve(h),o=k.hiddenUpdates,p=o[S],p===null?o[S]=[u]:p.push(u),u.lane=h|536870912),k):null}function Qn(o){if(50<Gh)throw Gh=0,mg=null,Error(a(185));for(var u=o.return;u!==null;)o=u,u=o.return;return o.tag===3?o.stateNode:null}var Hn={};function Qd(o,u,h,p){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function es(o,u,h,p){return new Qd(o,u,h,p)}function ef(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Qs(o,u){var h=o.alternate;return h===null?(h=es(o.tag,u,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=u,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&65011712,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,u=o.dependencies,h.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h.refCleanup=o.refCleanup,h}function Wu(o,u){o.flags&=65011714;var h=o.alternate;return h===null?(o.childLanes=0,o.lanes=u,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=h.childLanes,o.lanes=h.lanes,o.child=h.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=h.memoizedProps,o.memoizedState=h.memoizedState,o.updateQueue=h.updateQueue,o.type=h.type,u=h.dependencies,o.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),o}function Pc(o,u,h,p,S,k){var Y=0;if(p=o,typeof o=="function")ef(o)&&(Y=1);else if(typeof o=="string")Y=wE(o,h,I.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case L:return o=es(31,h,u,S),o.elementType=L,o.lanes=k,o;case _:return ll(h.children,S,k,u);case w:Y=8,S|=24;break;case E:return o=es(12,h,u,S|2),o.elementType=E,o.lanes=k,o;case G:return o=es(13,h,u,S),o.elementType=G,o.lanes=k,o;case W:return o=es(19,h,u,S),o.elementType=W,o.lanes=k,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case A:Y=10;break e;case C:Y=9;break e;case O:Y=11;break e;case B:Y=14;break e;case q:Y=16,p=null;break e}Y=29,h=Error(a(130,o===null?"null":typeof o,"")),p=null}return u=es(Y,h,u,S),u.elementType=o,u.type=p,u.lanes=k,u}function ll(o,u,h,p){return o=es(7,o,p,u),o.lanes=h,o}function Vu(o,u,h){return o=es(6,o,null,u),o.lanes=h,o}function tf(o){var u=es(18,null,null,0);return u.stateNode=o,u}function Mc(o,u,h){return u=es(4,o.children!==null?o.children:[],o.key,u),u.lanes=h,u.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},u}var rf=new WeakMap;function ei(o,u){if(typeof o=="object"&&o!==null){var h=rf.get(o);return h!==void 0?h:(u={value:o,source:u,stack:ve(u)},rf.set(o,u),u)}return{value:o,source:u,stack:ve(u)}}var Ic=[],Hl=0,af=null,Gu=0,ti=[],ri=0,cl=null,ai=1,ni="";function Ws(o,u){Ic[Hl++]=Gu,Ic[Hl++]=af,af=o,Gu=u}function fm(o,u,h){ti[ri++]=ai,ti[ri++]=ni,ti[ri++]=cl,cl=o;var p=ai;o=ni;var S=32-Ve(p)-1;p&=~(1<<S),h+=1;var k=32-Ve(u)+S;if(30<k){var Y=S-S%5;k=(p&(1<<Y)-1).toString(32),p>>=Y,S-=Y,ai=1<<32-Ve(u)+S|h<<S|p,ni=k+o}else ai=1<<k|h<<S|p,ni=o}function kh(o){o.return!==null&&(Ws(o,1),fm(o,1,0))}function nf(o){for(;o===af;)af=Ic[--Hl],Ic[Hl]=null,Gu=Ic[--Hl],Ic[Hl]=null;for(;o===cl;)cl=ti[--ri],ti[ri]=null,ni=ti[--ri],ti[ri]=null,ai=ti[--ri],ti[ri]=null}function hm(o,u){ti[ri++]=ai,ti[ri++]=ni,ti[ri++]=cl,ai=u.id,ni=u.overflow,cl=o}var $n=null,Aa=null,qr=!1,hs=null,Wa=!1,ki=Error(a(519));function ul(o){var u=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Bc(ei(u,o)),ki}function Eh(o){var u=o.stateNode,h=o.type,p=o.memoizedProps;switch(u[pe]=o,u[Se]=p,h){case"dialog":Hr("cancel",u),Hr("close",u);break;case"iframe":case"object":case"embed":Hr("load",u);break;case"video":case"audio":for(h=0;h<Xh.length;h++)Hr(Xh[h],u);break;case"source":Hr("error",u);break;case"img":case"image":case"link":Hr("error",u),Hr("load",u);break;case"details":Hr("toggle",u);break;case"input":Hr("invalid",u),qd(u,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":Hr("invalid",u);break;case"textarea":Hr("invalid",u),Ou(u,p.value,p.defaultValue,p.children)}h=p.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||u.textContent===""+h||p.suppressHydrationWarning===!0||M_(u.textContent,h)?(p.popover!=null&&(Hr("beforetoggle",u),Hr("toggle",u)),p.onScroll!=null&&Hr("scroll",u),p.onScrollEnd!=null&&Hr("scrollend",u),p.onClick!=null&&(u.onclick=_i),u=!0):u=!1,u||ul(o,!0)}function Po(o){for($n=o.return;$n;)switch($n.tag){case 5:case 31:case 13:Wa=!1;return;case 27:case 3:Wa=!0;return;default:$n=$n.return}}function Wn(o){if(o!==$n)return!1;if(!qr)return Po(o),qr=!0,!1;var u=o.tag,h;if((h=u!==3&&u!==27)&&((h=u===5)&&(h=o.type,h=!(h!=="form"&&h!=="button")||Cg(o.type,o.memoizedProps)),h=!h),h&&Aa&&ul(o),Po(o),u===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(a(317));Aa=V_(o)}else if(u===31){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(a(317));Aa=V_(o)}else u===27?(u=Aa,Qc(o.type)?(o=Fg,Fg=null,Aa=o):Aa=u):Aa=$n?ro(o.stateNode.nextSibling):null;return!0}function $l(){Aa=$n=null,qr=!1}function Ah(){var o=hs;return o!==null&&(ui===null?ui=o:ui.push.apply(ui,o),hs=null),o}function Bc(o){hs===null?hs=[o]:hs.push(o)}var sf=U(null),dl=null,Qi=null;function fl(o,u,h){F(sf,u._currentValue),u._currentValue=h}function si(o){o._currentValue=sf.current,j(sf)}function Uc(o,u,h){for(;o!==null;){var p=o.alternate;if((o.childLanes&u)!==u?(o.childLanes|=u,p!==null&&(p.childLanes|=u)):p!==null&&(p.childLanes&u)!==u&&(p.childLanes|=u),o===h)break;o=o.return}}function Wl(o,u,h,p){var S=o.child;for(S!==null&&(S.return=o);S!==null;){var k=S.dependencies;if(k!==null){var Y=S.child;k=k.firstContext;e:for(;k!==null;){var de=k;k=S;for(var Oe=0;Oe<u.length;Oe++)if(de.context===u[Oe]){k.lanes|=h,de=k.alternate,de!==null&&(de.lanes|=h),Uc(k.return,h,o),p||(Y=null);break e}k=de.next}}else if(S.tag===18){if(Y=S.return,Y===null)throw Error(a(341));Y.lanes|=h,k=Y.alternate,k!==null&&(k.lanes|=h),Uc(Y,h,o),Y=null}else Y=S.child;if(Y!==null)Y.return=S;else for(Y=S;Y!==null;){if(Y===o){Y=null;break}if(S=Y.sibling,S!==null){S.return=Y.return,Y=S;break}Y=Y.return}S=Y}}function hl(o,u,h,p){o=null;for(var S=u,k=!1;S!==null;){if(!k){if((S.flags&524288)!==0)k=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var Y=S.alternate;if(Y===null)throw Error(a(387));if(Y=Y.memoizedProps,Y!==null){var de=S.type;zn(S.pendingProps.value,Y.value)||(o!==null?o.push(de):o=[de])}}else if(S===se.current){if(Y=S.alternate,Y===null)throw Error(a(387));Y.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(o!==null?o.push(e0):o=[e0])}S=S.return}o!==null&&Wl(u,o,h,p),u.flags|=262144}function of(o){for(o=o.firstContext;o!==null;){if(!zn(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function ml(o){dl=o,Qi=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Vn(o){return mm(dl,o)}function lf(o,u){return dl===null&&ml(o),mm(o,u)}function mm(o,u){var h=u._currentValue;if(u={context:u,memoizedValue:h,next:null},Qi===null){if(o===null)throw Error(a(308));Qi=u,o.dependencies={lanes:0,firstContext:u},o.flags|=524288}else Qi=Qi.next=u;return h}var D1=typeof AbortController<"u"?AbortController:function(){var o=[],u=this.signal={aborted:!1,addEventListener:function(h,p){o.push(p)}};this.abort=function(){u.aborted=!0,o.forEach(function(h){return h()})}},F1=t.unstable_scheduleCallback,L1=t.unstable_NormalPriority,Qa={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function qc(){return{controller:new D1,data:new Map,refCount:0}}function Yu(o){o.refCount--,o.refCount===0&&F1(L1,function(){o.controller.abort()})}var Xu=null,cf=0,y=0,N=null;function P(o,u){if(Xu===null){var h=Xu=[];cf=0,y=_g(),N={status:"pending",value:void 0,then:function(p){h.push(p)}}}return cf++,u.then(H,H),u}function H(){if(--cf===0&&Xu!==null){N!==null&&(N.status="fulfilled");var o=Xu;Xu=null,y=0,N=null;for(var u=0;u<o.length;u++)(0,o[u])()}}function re(o,u){var h=[],p={status:"pending",value:null,reason:null,then:function(S){h.push(S)}};return o.then(function(){p.status="fulfilled",p.value=u;for(var S=0;S<h.length;S++)(0,h[S])(u)},function(S){for(p.status="rejected",p.reason=S,S=0;S<h.length;S++)(0,h[S])(void 0)}),p}var oe=X.S;X.S=function(o,u){o_=Ft(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&P(o,u),oe!==null&&oe(o,u)};var ce=U(null);function he(){var o=ce.current;return o!==null?o:Ta.pooledCache}function ye(o,u){u===null?F(ce,ce.current):F(ce,u.pool)}function Ee(){var o=he();return o===null?null:{parent:Qa._currentValue,pool:o}}var Le=Error(a(460)),Ze=Error(a(474)),ke=Error(a(542)),Me={then:function(){}};function We(o){return o=o.status,o==="fulfilled"||o==="rejected"}function dt(o,u,h){switch(h=o[h],h===void 0?o.push(u):h!==u&&(u.then(_i,_i),u=h),u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,Tt(o),o;default:if(typeof u.status=="string")u.then(_i,_i);else{if(o=Ta,o!==null&&100<o.shellSuspendCounter)throw Error(a(482));o=u,o.status="pending",o.then(function(p){if(u.status==="pending"){var S=u;S.status="fulfilled",S.value=p}},function(p){if(u.status==="pending"){var S=u;S.status="rejected",S.reason=p}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,Tt(o),o}throw ut=u,Le}}function Ye(o){try{var u=o._init;return u(o._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(ut=h,Le):h}}var ut=null;function pt(){if(ut===null)throw Error(a(459));var o=ut;return ut=null,o}function Tt(o){if(o===Le||o===ke)throw Error(a(483))}var yt=null,ar=0;function Gt(o){var u=ar;return ar+=1,yt===null&&(yt=[]),dt(yt,o,u)}function jr(o,u){u=u.props.ref,o.ref=u!==void 0?u:null}function Qt(o,u){throw u.$$typeof===x?Error(a(525)):(o=Object.prototype.toString.call(u),Error(a(31,o==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":o)))}function Br(o){function u(He,Pe){if(o){var et=He.deletions;et===null?(He.deletions=[Pe],He.flags|=16):et.push(Pe)}}function h(He,Pe){if(!o)return null;for(;Pe!==null;)u(He,Pe),Pe=Pe.sibling;return null}function p(He){for(var Pe=new Map;He!==null;)He.key!==null?Pe.set(He.key,He):Pe.set(He.index,He),He=He.sibling;return Pe}function S(He,Pe){return He=Qs(He,Pe),He.index=0,He.sibling=null,He}function k(He,Pe,et){return He.index=et,o?(et=He.alternate,et!==null?(et=et.index,et<Pe?(He.flags|=67108866,Pe):et):(He.flags|=67108866,Pe)):(He.flags|=1048576,Pe)}function Y(He){return o&&He.alternate===null&&(He.flags|=67108866),He}function de(He,Pe,et,vt){return Pe===null||Pe.tag!==6?(Pe=Vu(et,He.mode,vt),Pe.return=He,Pe):(Pe=S(Pe,et),Pe.return=He,Pe)}function Oe(He,Pe,et,vt){var mr=et.type;return mr===_?ht(He,Pe,et.props.children,vt,et.key):Pe!==null&&(Pe.elementType===mr||typeof mr=="object"&&mr!==null&&mr.$$typeof===q&&Ye(mr)===Pe.type)?(Pe=S(Pe,et.props),jr(Pe,et),Pe.return=He,Pe):(Pe=Pc(et.type,et.key,et.props,null,He.mode,vt),jr(Pe,et),Pe.return=He,Pe)}function tt(He,Pe,et,vt){return Pe===null||Pe.tag!==4||Pe.stateNode.containerInfo!==et.containerInfo||Pe.stateNode.implementation!==et.implementation?(Pe=Mc(et,He.mode,vt),Pe.return=He,Pe):(Pe=S(Pe,et.children||[]),Pe.return=He,Pe)}function ht(He,Pe,et,vt,mr){return Pe===null||Pe.tag!==7?(Pe=ll(et,He.mode,vt,mr),Pe.return=He,Pe):(Pe=S(Pe,et),Pe.return=He,Pe)}function xt(He,Pe,et){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number"||typeof Pe=="bigint")return Pe=Vu(""+Pe,He.mode,et),Pe.return=He,Pe;if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case g:return et=Pc(Pe.type,Pe.key,Pe.props,null,He.mode,et),jr(et,Pe),et.return=He,et;case b:return Pe=Mc(Pe,He.mode,et),Pe.return=He,Pe;case q:return Pe=Ye(Pe),xt(He,Pe,et)}if(ie(Pe)||T(Pe))return Pe=ll(Pe,He.mode,et,null),Pe.return=He,Pe;if(typeof Pe.then=="function")return xt(He,Gt(Pe),et);if(Pe.$$typeof===A)return xt(He,lf(He,Pe),et);Qt(He,Pe)}return null}function at(He,Pe,et,vt){var mr=Pe!==null?Pe.key:null;if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return mr!==null?null:de(He,Pe,""+et,vt);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case g:return et.key===mr?Oe(He,Pe,et,vt):null;case b:return et.key===mr?tt(He,Pe,et,vt):null;case q:return et=Ye(et),at(He,Pe,et,vt)}if(ie(et)||T(et))return mr!==null?null:ht(He,Pe,et,vt,null);if(typeof et.then=="function")return at(He,Pe,Gt(et),vt);if(et.$$typeof===A)return at(He,Pe,lf(He,et),vt);Qt(He,et)}return null}function it(He,Pe,et,vt,mr){if(typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint")return He=He.get(et)||null,de(Pe,He,""+vt,mr);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case g:return He=He.get(vt.key===null?et:vt.key)||null,Oe(Pe,He,vt,mr);case b:return He=He.get(vt.key===null?et:vt.key)||null,tt(Pe,He,vt,mr);case q:return vt=Ye(vt),it(He,Pe,et,vt,mr)}if(ie(vt)||T(vt))return He=He.get(et)||null,ht(Pe,He,vt,mr,null);if(typeof vt.then=="function")return it(He,Pe,et,Gt(vt),mr);if(vt.$$typeof===A)return it(He,Pe,et,lf(Pe,vt),mr);Qt(Pe,vt)}return null}function tr(He,Pe,et,vt){for(var mr=null,na=null,lr=Pe,Dr=Pe=0,Wr=null;lr!==null&&Dr<et.length;Dr++){lr.index>Dr?(Wr=lr,lr=null):Wr=lr.sibling;var sa=at(He,lr,et[Dr],vt);if(sa===null){lr===null&&(lr=Wr);break}o&&lr&&sa.alternate===null&&u(He,lr),Pe=k(sa,Pe,Dr),na===null?mr=sa:na.sibling=sa,na=sa,lr=Wr}if(Dr===et.length)return h(He,lr),qr&&Ws(He,Dr),mr;if(lr===null){for(;Dr<et.length;Dr++)lr=xt(He,et[Dr],vt),lr!==null&&(Pe=k(lr,Pe,Dr),na===null?mr=lr:na.sibling=lr,na=lr);return qr&&Ws(He,Dr),mr}for(lr=p(lr);Dr<et.length;Dr++)Wr=it(lr,He,Dr,et[Dr],vt),Wr!==null&&(o&&Wr.alternate!==null&&lr.delete(Wr.key===null?Dr:Wr.key),Pe=k(Wr,Pe,Dr),na===null?mr=Wr:na.sibling=Wr,na=Wr);return o&&lr.forEach(function(nu){return u(He,nu)}),qr&&Ws(He,Dr),mr}function yr(He,Pe,et,vt){if(et==null)throw Error(a(151));for(var mr=null,na=null,lr=Pe,Dr=Pe=0,Wr=null,sa=et.next();lr!==null&&!sa.done;Dr++,sa=et.next()){lr.index>Dr?(Wr=lr,lr=null):Wr=lr.sibling;var nu=at(He,lr,sa.value,vt);if(nu===null){lr===null&&(lr=Wr);break}o&&lr&&nu.alternate===null&&u(He,lr),Pe=k(nu,Pe,Dr),na===null?mr=nu:na.sibling=nu,na=nu,lr=Wr}if(sa.done)return h(He,lr),qr&&Ws(He,Dr),mr;if(lr===null){for(;!sa.done;Dr++,sa=et.next())sa=xt(He,sa.value,vt),sa!==null&&(Pe=k(sa,Pe,Dr),na===null?mr=sa:na.sibling=sa,na=sa);return qr&&Ws(He,Dr),mr}for(lr=p(lr);!sa.done;Dr++,sa=et.next())sa=it(lr,He,Dr,sa.value,vt),sa!==null&&(o&&sa.alternate!==null&&lr.delete(sa.key===null?Dr:sa.key),Pe=k(sa,Pe,Dr),na===null?mr=sa:na.sibling=sa,na=sa);return o&&lr.forEach(function(DE){return u(He,DE)}),qr&&Ws(He,Dr),mr}function ja(He,Pe,et,vt){if(typeof et=="object"&&et!==null&&et.type===_&&et.key===null&&(et=et.props.children),typeof et=="object"&&et!==null){switch(et.$$typeof){case g:e:{for(var mr=et.key;Pe!==null;){if(Pe.key===mr){if(mr=et.type,mr===_){if(Pe.tag===7){h(He,Pe.sibling),vt=S(Pe,et.props.children),vt.return=He,He=vt;break e}}else if(Pe.elementType===mr||typeof mr=="object"&&mr!==null&&mr.$$typeof===q&&Ye(mr)===Pe.type){h(He,Pe.sibling),vt=S(Pe,et.props),jr(vt,et),vt.return=He,He=vt;break e}h(He,Pe);break}else u(He,Pe);Pe=Pe.sibling}et.type===_?(vt=ll(et.props.children,He.mode,vt,et.key),vt.return=He,He=vt):(vt=Pc(et.type,et.key,et.props,null,He.mode,vt),jr(vt,et),vt.return=He,He=vt)}return Y(He);case b:e:{for(mr=et.key;Pe!==null;){if(Pe.key===mr)if(Pe.tag===4&&Pe.stateNode.containerInfo===et.containerInfo&&Pe.stateNode.implementation===et.implementation){h(He,Pe.sibling),vt=S(Pe,et.children||[]),vt.return=He,He=vt;break e}else{h(He,Pe);break}else u(He,Pe);Pe=Pe.sibling}vt=Mc(et,He.mode,vt),vt.return=He,He=vt}return Y(He);case q:return et=Ye(et),ja(He,Pe,et,vt)}if(ie(et))return tr(He,Pe,et,vt);if(T(et)){if(mr=T(et),typeof mr!="function")throw Error(a(150));return et=mr.call(et),yr(He,Pe,et,vt)}if(typeof et.then=="function")return ja(He,Pe,Gt(et),vt);if(et.$$typeof===A)return ja(He,Pe,lf(He,et),vt);Qt(He,et)}return typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint"?(et=""+et,Pe!==null&&Pe.tag===6?(h(He,Pe.sibling),vt=S(Pe,et),vt.return=He,He=vt):(h(He,Pe),vt=Vu(et,He.mode,vt),vt.return=He,He=vt),Y(He)):h(He,Pe)}return function(He,Pe,et,vt){try{ar=0;var mr=ja(He,Pe,et,vt);return yt=null,mr}catch(lr){if(lr===Le||lr===ke)throw lr;var na=es(29,lr,null,He.mode);return na.lanes=vt,na.return=He,na}finally{}}}var Ca=Br(!0),Ar=Br(!1),Yt=!1;function Bt(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pa(o,u){o=o.updateQueue,u.updateQueue===o&&(u.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function xr(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function Or(o,u,h){var p=o.updateQueue;if(p===null)return null;if(p=p.shared,(ua&2)!==0){var S=p.pending;return S===null?u.next=u:(u.next=S.next,S.next=u),p.pending=u,u=Qn(o),$u(o,null,h),u}return Hu(o,p,u,h),Qn(o)}function la(o,u,h){if(u=u.updateQueue,u!==null&&(u=u.shared,(h&4194048)!==0)){var p=u.lanes;p&=o.pendingLanes,h|=p,u.lanes=h,Ra(o,h)}}function bn(o,u){var h=o.updateQueue,p=o.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var S=null,k=null;if(h=h.firstBaseUpdate,h!==null){do{var Y={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};k===null?S=k=Y:k=k.next=Y,h=h.next}while(h!==null);k===null?S=k=u:k=k.next=u}else S=k=u;h={baseState:p.baseState,firstBaseUpdate:S,lastBaseUpdate:k,shared:p.shared,callbacks:p.callbacks},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=u}var Gn=!1;function wa(){if(Gn){var o=N;if(o!==null)throw o}}function ln(o,u,h,p){Gn=!1;var S=o.updateQueue;Yt=!1;var k=S.firstBaseUpdate,Y=S.lastBaseUpdate,de=S.shared.pending;if(de!==null){S.shared.pending=null;var Oe=de,tt=Oe.next;Oe.next=null,Y===null?k=tt:Y.next=tt,Y=Oe;var ht=o.alternate;ht!==null&&(ht=ht.updateQueue,de=ht.lastBaseUpdate,de!==Y&&(de===null?ht.firstBaseUpdate=tt:de.next=tt,ht.lastBaseUpdate=Oe))}if(k!==null){var xt=S.baseState;Y=0,ht=tt=Oe=null,de=k;do{var at=de.lane&-536870913,it=at!==de.lane;if(it?($r&at)===at:(p&at)===at){at!==0&&at===y&&(Gn=!0),ht!==null&&(ht=ht.next={lane:0,tag:de.tag,payload:de.payload,callback:null,next:null});e:{var tr=o,yr=de;at=u;var ja=h;switch(yr.tag){case 1:if(tr=yr.payload,typeof tr=="function"){xt=tr.call(ja,xt,at);break e}xt=tr;break e;case 3:tr.flags=tr.flags&-65537|128;case 0:if(tr=yr.payload,at=typeof tr=="function"?tr.call(ja,xt,at):tr,at==null)break e;xt=v({},xt,at);break e;case 2:Yt=!0}}at=de.callback,at!==null&&(o.flags|=64,it&&(o.flags|=8192),it=S.callbacks,it===null?S.callbacks=[at]:it.push(at))}else it={lane:at,tag:de.tag,payload:de.payload,callback:de.callback,next:null},ht===null?(tt=ht=it,Oe=xt):ht=ht.next=it,Y|=at;if(de=de.next,de===null){if(de=S.shared.pending,de===null)break;it=de,de=it.next,it.next=null,S.lastBaseUpdate=it,S.shared.pending=null}}while(!0);ht===null&&(Oe=xt),S.baseState=Oe,S.firstBaseUpdate=tt,S.lastBaseUpdate=ht,k===null&&(S.shared.lanes=0),Yc|=Y,o.lanes=Y,o.memoizedState=xt}}function ts(o,u){if(typeof o!="function")throw Error(a(191,o));o.call(u)}function cn(o,u){var h=o.callbacks;if(h!==null)for(o.callbacks=null,o=0;o<h.length;o++)ts(h[o],u)}var Lr=U(null),Kr=U(0);function Ma(o,u){o=tc,F(Kr,o),F(Lr,u),tc=o|u.baseLanes}function ta(){F(Kr,tc),F(Lr,Lr.current)}function wn(){tc=Kr.current,j(Lr),j(Kr)}var Ia=U(null),Jr=null;function en(o){var u=o.alternate;F(Yr,Yr.current&1),F(Ia,o),Jr===null&&(u===null||Lr.current!==null||u.memoizedState!==null)&&(Jr=o)}function ca(o){F(Yr,Yr.current),F(Ia,o),Jr===null&&(Jr=o)}function un(o){o.tag===22?(F(Yr,Yr.current),F(Ia,o),Jr===null&&(Jr=o)):dn()}function dn(){F(Yr,Yr.current),F(Ia,Ia.current)}function ha(o){j(Ia),Jr===o&&(Jr=null),j(Yr)}var Yr=U(0);function rs(o){for(var u=o;u!==null;){if(u.tag===13){var h=u.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||Rg(h)||Dg(h)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Va=0,fr=null,hr=null,Zr=null,Ns=!1,ii=!1,ms=!1,fn=0,pl=0,gl=null,uf=0;function Sa(){throw Error(a(321))}function Ch(o,u){if(u===null)return!1;for(var h=0;h<u.length&&h<o.length;h++)if(!zn(o[h],u[h]))return!1;return!0}function Th(o,u,h,p,S,k){return Va=k,fr=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,X.H=o===null||o.memoizedState===null?xy:H1,ms=!1,k=h(p,S),ms=!1,ii&&(k=Mo(u,h,p,S)),df(o),k}function df(o){X.H=Ih;var u=hr!==null&&hr.next!==null;if(Va=0,Zr=hr=fr=null,Ns=!1,pl=0,gl=null,u)throw Error(a(300));o===null||Fn||(o=o.dependencies,o!==null&&of(o)&&(Fn=!0))}function Mo(o,u,h,p){fr=o;var S=0;do{if(ii&&(gl=null),pl=0,ii=!1,25<=S)throw Error(a(301));if(S+=1,Zr=hr=null,o.updateQueue!=null){var k=o.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}X.H=yy,k=u(h,p)}while(ii);return k}function P1(){var o=X.H,u=o.useState()[0];return u=typeof u.then=="function"?vl(u):u,o=o.useState()[0],(hr!==null?hr.memoizedState:null)!==o&&(fr.flags|=1024),u}function Oh(){var o=fn!==0;return fn=0,o}function Rh(o,u,h){u.updateQueue=o.updateQueue,u.flags&=-2053,o.lanes&=~h}function ff(o){if(Ns){for(o=o.memoizedState;o!==null;){var u=o.queue;u!==null&&(u.pending=null),o=o.next}Ns=!1}Va=0,Zr=hr=fr=null,ii=!1,pl=fn=0,gl=null}function Dn(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zr===null?fr.memoizedState=Zr=o:Zr=Zr.next=o,Zr}function Ga(){if(hr===null){var o=fr.alternate;o=o!==null?o.memoizedState:null}else o=hr.next;var u=Zr===null?fr.memoizedState:Zr.next;if(u!==null)Zr=u,hr=o;else{if(o===null)throw fr.alternate===null?Error(a(467)):Error(a(310));hr=o,o={memoizedState:hr.memoizedState,baseState:hr.baseState,baseQueue:hr.baseQueue,queue:hr.queue,next:null},Zr===null?fr.memoizedState=Zr=o:Zr=Zr.next=o}return Zr}function Ku(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function vl(o){var u=pl;return pl+=1,gl===null&&(gl=[]),o=dt(gl,o,u),u=fr,(Zr===null?u.memoizedState:Zr.next)===null&&(u=u.alternate,X.H=u===null||u.memoizedState===null?xy:H1),o}function zc(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return vl(o);if(o.$$typeof===A)return Vn(o)}throw Error(a(438,String(o)))}function Vl(o){var u=null,h=fr.updateQueue;if(h!==null&&(u=h.memoCache),u==null){var p=fr.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(u={data:p.data.map(function(S){return S.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),h===null&&(h=Ku(),fr.updateQueue=h),h.memoCache=u,h=u.data[u.index],h===void 0)for(h=u.data[u.index]=Array(o),p=0;p<o;p++)h[p]=Z;return u.index++,h}function eo(o,u){return typeof u=="function"?u(o):u}function hf(o){var u=Ga();return Hc(u,hr,o)}function Hc(o,u,h){var p=o.queue;if(p===null)throw Error(a(311));p.lastRenderedReducer=h;var S=o.baseQueue,k=p.pending;if(k!==null){if(S!==null){var Y=S.next;S.next=k.next,k.next=Y}u.baseQueue=S=k,p.pending=null}if(k=o.baseState,S===null)o.memoizedState=k;else{u=S.next;var de=Y=null,Oe=null,tt=u,ht=!1;do{var xt=tt.lane&-536870913;if(xt!==tt.lane?($r&xt)===xt:(Va&xt)===xt){var at=tt.revertLane;if(at===0)Oe!==null&&(Oe=Oe.next={lane:0,revertLane:0,gesture:null,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null}),xt===y&&(ht=!0);else if((Va&at)===at){tt=tt.next,at===y&&(ht=!0);continue}else xt={lane:0,revertLane:tt.revertLane,gesture:null,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null},Oe===null?(de=Oe=xt,Y=k):Oe=Oe.next=xt,fr.lanes|=at,Yc|=at;xt=tt.action,ms&&h(k,xt),k=tt.hasEagerState?tt.eagerState:h(k,xt)}else at={lane:xt,revertLane:tt.revertLane,gesture:tt.gesture,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null},Oe===null?(de=Oe=at,Y=k):Oe=Oe.next=at,fr.lanes|=xt,Yc|=xt;tt=tt.next}while(tt!==null&&tt!==u);if(Oe===null?Y=k:Oe.next=de,!zn(k,o.memoizedState)&&(Fn=!0,ht&&(h=N,h!==null)))throw h;o.memoizedState=k,o.baseState=Y,o.baseQueue=Oe,p.lastRenderedState=k}return S===null&&(p.lanes=0),[o.memoizedState,p.dispatch]}function mf(o){var u=Ga(),h=u.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=o;var p=h.dispatch,S=h.pending,k=u.memoizedState;if(S!==null){h.pending=null;var Y=S=S.next;do k=o(k,Y.action),Y=Y.next;while(Y!==S);zn(k,u.memoizedState)||(Fn=!0),u.memoizedState=k,u.baseQueue===null&&(u.baseState=k),h.lastRenderedState=k}return[k,p]}function pf(o,u,h){var p=fr,S=Ga(),k=qr;if(k){if(h===void 0)throw Error(a(407));h=h()}else h=u();var Y=!zn((hr||S).memoizedState,h);if(Y&&(S.memoizedState=h,Fn=!0),S=S.queue,M1(Fh.bind(null,p,S,o),[o]),S.getSnapshot!==u||Y||Zr!==null&&Zr.memoizedState.tag&1){if(p.flags|=2048,Yl(9,{destroy:void 0},Dh.bind(null,p,S,h,u),null),Ta===null)throw Error(a(349));k||(Va&127)!==0||Io(p,u,h)}return h}function Io(o,u,h){o.flags|=16384,o={getSnapshot:u,value:h},u=fr.updateQueue,u===null?(u=Ku(),fr.updateQueue=u,u.stores=[o]):(h=u.stores,h===null?u.stores=[o]:h.push(o))}function Dh(o,u,h,p){u.value=h,u.getSnapshot=p,pm(u)&&Lh(o)}function Fh(o,u,h){return h(function(){pm(u)&&Lh(o)})}function pm(o){var u=o.getSnapshot;o=o.value;try{var h=u();return!zn(o,h)}catch{return!0}}function Lh(o){var u=Lo(o,2);u!==null&&di(u,o,2)}function xl(o){var u=Dn();if(typeof o=="function"){var h=o;if(o=h(),ms){Te(!0);try{h()}finally{Te(!1)}}}return u.memoizedState=u.baseState=o,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:o},u}function gm(o,u,h,p){return o.baseState=h,Hc(o,hr,typeof p=="function"?p:eo)}function vm(o,u,h,p,S){if(bm(o))throw Error(a(485));if(o=u.action,o!==null){var k={payload:S,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Y){k.listeners.push(Y)}};X.T!==null?h(!0):k.isTransition=!1,p(k),h=u.pending,h===null?(k.next=u.pending=k,xm(u,k)):(k.next=h.next,u.pending=h.next=k)}}function xm(o,u){var h=u.action,p=u.payload,S=o.state;if(u.isTransition){var k=X.T,Y={};X.T=Y;try{var de=h(S,p),Oe=X.S;Oe!==null&&Oe(Y,de),Ph(o,u,de)}catch(tt){Gl(o,u,tt)}finally{k!==null&&Y.types!==null&&(k.types=Y.types),X.T=k}}else try{k=h(S,p),Ph(o,u,k)}catch(tt){Gl(o,u,tt)}}function Ph(o,u,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(p){ym(o,u,p)},function(p){return Gl(o,u,p)}):ym(o,u,h)}function ym(o,u,h){u.status="fulfilled",u.value=h,gf(u),o.state=h,u=o.pending,u!==null&&(h=u.next,h===u?o.pending=null:(h=h.next,u.next=h,xm(o,h)))}function Gl(o,u,h){var p=o.pending;if(o.pending=null,p!==null){p=p.next;do u.status="rejected",u.reason=h,gf(u),u=u.next;while(u!==p)}o.action=null}function gf(o){o=o.listeners;for(var u=0;u<o.length;u++)(0,o[u])()}function Ju(o,u){return u}function to(o,u){if(qr){var h=Ta.formState;if(h!==null){e:{var p=fr;if(qr){if(Aa){t:{for(var S=Aa,k=Wa;S.nodeType!==8;){if(!k){S=null;break t}if(S=ro(S.nextSibling),S===null){S=null;break t}}k=S.data,S=k==="F!"||k==="F"?S:null}if(S){Aa=ro(S.nextSibling),p=S.data==="F!";break e}}ul(p)}p=!1}p&&(u=h[0])}}return h=Dn(),h.memoizedState=h.baseState=u,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ju,lastRenderedState:u},h.queue=p,h=py.bind(null,fr,p),p.dispatch=h,p=xl(!1),k=z1.bind(null,fr,!1,p.queue),p=Dn(),S={state:u,dispatch:null,action:o,pending:null},p.queue=S,h=vm.bind(null,fr,S,k,h),S.dispatch=h,p.memoizedState=o,[u,h,!1]}function Bo(o){var u=Ga();return Uo(u,hr,o)}function Uo(o,u,h){if(u=Hc(o,u,Ju)[0],o=hf(eo)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var p=vl(u)}catch(Y){throw Y===Le?ke:Y}else p=u;u=Ga();var S=u.queue,k=S.dispatch;return h!==u.memoizedState&&(fr.flags|=2048,Yl(9,{destroy:void 0},vf.bind(null,S,h),null)),[p,k,o]}function vf(o,u){o.action=u}function xf(o){var u=Ga(),h=hr;if(h!==null)return Uo(u,h,o);Ga(),u=u.memoizedState,h=Ga();var p=h.queue.dispatch;return h.memoizedState=o,[u,p,!1]}function Yl(o,u,h,p){return o={tag:o,create:h,deps:p,inst:u,next:null},u=fr.updateQueue,u===null&&(u=Ku(),fr.updateQueue=u),h=u.lastEffect,h===null?u.lastEffect=o.next=o:(p=h.next,h.next=o,o.next=p,u.lastEffect=o),o}function _m(){return Ga().memoizedState}function $c(o,u,h,p){var S=Dn();fr.flags|=o,S.memoizedState=Yl(1|u,{destroy:void 0},h,p===void 0?null:p)}function Wc(o,u,h,p){var S=Ga();p=p===void 0?null:p;var k=S.memoizedState.inst;hr!==null&&p!==null&&Ch(p,hr.memoizedState.deps)?S.memoizedState=Yl(u,k,h,p):(fr.flags|=o,S.memoizedState=Yl(1|u,k,h,p))}function ty(o,u){$c(8390656,8,o,u)}function M1(o,u){Wc(2048,8,o,u)}function Ek(o){fr.flags|=4;var u=fr.updateQueue;if(u===null)u=Ku(),fr.updateQueue=u,u.events=[o];else{var h=u.events;h===null?u.events=[o]:h.push(o)}}function ry(o){var u=Ga().memoizedState;return Ek({ref:u,nextImpl:o}),function(){if((ua&2)!==0)throw Error(a(440));return u.impl.apply(void 0,arguments)}}function ay(o,u){return Wc(4,2,o,u)}function ny(o,u){return Wc(4,4,o,u)}function sy(o,u){if(typeof u=="function"){o=o();var h=u(o);return function(){typeof h=="function"?h():u(null)}}if(u!=null)return o=o(),u.current=o,function(){u.current=null}}function iy(o,u,h){h=h!=null?h.concat([o]):null,Wc(4,4,sy.bind(null,u,o),h)}function I1(){}function oy(o,u){var h=Ga();u=u===void 0?null:u;var p=h.memoizedState;return u!==null&&Ch(u,p[1])?p[0]:(h.memoizedState=[o,u],o)}function ly(o,u){var h=Ga();u=u===void 0?null:u;var p=h.memoizedState;if(u!==null&&Ch(u,p[1]))return p[0];if(p=o(),ms){Te(!0);try{o()}finally{Te(!1)}}return h.memoizedState=[p,u],p}function B1(o,u,h){return h===void 0||(Va&1073741824)!==0&&($r&261930)===0?o.memoizedState=u:(o.memoizedState=h,o=c_(),fr.lanes|=o,Yc|=o,h)}function cy(o,u,h,p){return zn(h,u)?h:Lr.current!==null?(o=B1(o,h,p),zn(o,u)||(Fn=!0),o):(Va&42)===0||(Va&1073741824)!==0&&($r&261930)===0?(Fn=!0,o.memoizedState=h):(o=c_(),fr.lanes|=o,Yc|=o,u)}function uy(o,u,h,p,S){var k=J.p;J.p=k!==0&&8>k?k:8;var Y=X.T,de={};X.T=de,z1(o,!1,u,h);try{var Oe=S(),tt=X.S;if(tt!==null&&tt(de,Oe),Oe!==null&&typeof Oe=="object"&&typeof Oe.then=="function"){var ht=re(Oe,p);Mh(o,u,ht,Ci(o))}else Mh(o,u,p,Ci(o))}catch(xt){Mh(o,u,{then:function(){},status:"rejected",reason:xt},Ci())}finally{J.p=k,Y!==null&&de.types!==null&&(Y.types=de.types),X.T=Y}}function Ak(){}function U1(o,u,h,p){if(o.tag!==5)throw Error(a(476));var S=dy(o).queue;uy(o,S,u,K,h===null?Ak:function(){return fy(o),h(p)})}function dy(o){var u=o.memoizedState;if(u!==null)return u;u={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:K},next:null};var h={};return u.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:h},next:null},o.memoizedState=u,o=o.alternate,o!==null&&(o.memoizedState=u),u}function fy(o){var u=dy(o);u.next===null&&(u=o.alternate.memoizedState),Mh(o,u.next.queue,{},Ci())}function q1(){return Vn(e0)}function hy(){return Ga().memoizedState}function my(){return Ga().memoizedState}function Ck(o){for(var u=o.return;u!==null;){switch(u.tag){case 24:case 3:var h=Ci();o=xr(h);var p=Or(u,o,h);p!==null&&(di(p,u,h),la(p,u,h)),u={cache:qc()},o.payload=u;return}u=u.return}}function Tk(o,u,h){var p=Ci();h={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},bm(o)?gy(u,h):(h=Zd(o,u,h,p),h!==null&&(di(h,o,p),vy(h,u,p)))}function py(o,u,h){var p=Ci();Mh(o,u,h,p)}function Mh(o,u,h,p){var S={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(bm(o))gy(u,S);else{var k=o.alternate;if(o.lanes===0&&(k===null||k.lanes===0)&&(k=u.lastRenderedReducer,k!==null))try{var Y=u.lastRenderedState,de=k(Y,h);if(S.hasEagerState=!0,S.eagerState=de,zn(de,Y))return Hu(o,u,S,0),Ta===null&&zu(),!1}catch{}finally{}if(h=Zd(o,u,S,p),h!==null)return di(h,o,p),vy(h,u,p),!0}return!1}function z1(o,u,h,p){if(p={lane:2,revertLane:_g(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},bm(o)){if(u)throw Error(a(479))}else u=Zd(o,h,p,2),u!==null&&di(u,o,2)}function bm(o){var u=o.alternate;return o===fr||u!==null&&u===fr}function gy(o,u){ii=Ns=!0;var h=o.pending;h===null?u.next=u:(u.next=h.next,h.next=u),o.pending=u}function vy(o,u,h){if((h&4194048)!==0){var p=u.lanes;p&=o.pendingLanes,h|=p,u.lanes=h,Ra(o,h)}}var Ih={readContext:Vn,use:zc,useCallback:Sa,useContext:Sa,useEffect:Sa,useImperativeHandle:Sa,useLayoutEffect:Sa,useInsertionEffect:Sa,useMemo:Sa,useReducer:Sa,useRef:Sa,useState:Sa,useDebugValue:Sa,useDeferredValue:Sa,useTransition:Sa,useSyncExternalStore:Sa,useId:Sa,useHostTransitionStatus:Sa,useFormState:Sa,useActionState:Sa,useOptimistic:Sa,useMemoCache:Sa,useCacheRefresh:Sa};Ih.useEffectEvent=Sa;var xy={readContext:Vn,use:zc,useCallback:function(o,u){return Dn().memoizedState=[o,u===void 0?null:u],o},useContext:Vn,useEffect:ty,useImperativeHandle:function(o,u,h){h=h!=null?h.concat([o]):null,$c(4194308,4,sy.bind(null,u,o),h)},useLayoutEffect:function(o,u){return $c(4194308,4,o,u)},useInsertionEffect:function(o,u){$c(4,2,o,u)},useMemo:function(o,u){var h=Dn();u=u===void 0?null:u;var p=o();if(ms){Te(!0);try{o()}finally{Te(!1)}}return h.memoizedState=[p,u],p},useReducer:function(o,u,h){var p=Dn();if(h!==void 0){var S=h(u);if(ms){Te(!0);try{h(u)}finally{Te(!1)}}}else S=u;return p.memoizedState=p.baseState=S,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:S},p.queue=o,o=o.dispatch=Tk.bind(null,fr,o),[p.memoizedState,o]},useRef:function(o){var u=Dn();return o={current:o},u.memoizedState=o},useState:function(o){o=xl(o);var u=o.queue,h=py.bind(null,fr,u);return u.dispatch=h,[o.memoizedState,h]},useDebugValue:I1,useDeferredValue:function(o,u){var h=Dn();return B1(h,o,u)},useTransition:function(){var o=xl(!1);return o=uy.bind(null,fr,o.queue,!0,!1),Dn().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,u,h){var p=fr,S=Dn();if(qr){if(h===void 0)throw Error(a(407));h=h()}else{if(h=u(),Ta===null)throw Error(a(349));($r&127)!==0||Io(p,u,h)}S.memoizedState=h;var k={value:h,getSnapshot:u};return S.queue=k,ty(Fh.bind(null,p,k,o),[o]),p.flags|=2048,Yl(9,{destroy:void 0},Dh.bind(null,p,k,h,u),null),h},useId:function(){var o=Dn(),u=Ta.identifierPrefix;if(qr){var h=ni,p=ai;h=(p&~(1<<32-Ve(p)-1)).toString(32)+h,u="_"+u+"R_"+h,h=fn++,0<h&&(u+="H"+h.toString(32)),u+="_"}else h=uf++,u="_"+u+"r_"+h.toString(32)+"_";return o.memoizedState=u},useHostTransitionStatus:q1,useFormState:to,useActionState:to,useOptimistic:function(o){var u=Dn();u.memoizedState=u.baseState=o;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=h,u=z1.bind(null,fr,!0,h),h.dispatch=u,[o,u]},useMemoCache:Vl,useCacheRefresh:function(){return Dn().memoizedState=Ck.bind(null,fr)},useEffectEvent:function(o){var u=Dn(),h={impl:o};return u.memoizedState=h,function(){if((ua&2)!==0)throw Error(a(440));return h.impl.apply(void 0,arguments)}}},H1={readContext:Vn,use:zc,useCallback:oy,useContext:Vn,useEffect:M1,useImperativeHandle:iy,useInsertionEffect:ay,useLayoutEffect:ny,useMemo:ly,useReducer:hf,useRef:_m,useState:function(){return hf(eo)},useDebugValue:I1,useDeferredValue:function(o,u){var h=Ga();return cy(h,hr.memoizedState,o,u)},useTransition:function(){var o=hf(eo)[0],u=Ga().memoizedState;return[typeof o=="boolean"?o:vl(o),u]},useSyncExternalStore:pf,useId:hy,useHostTransitionStatus:q1,useFormState:Bo,useActionState:Bo,useOptimistic:function(o,u){var h=Ga();return gm(h,hr,o,u)},useMemoCache:Vl,useCacheRefresh:my};H1.useEffectEvent=ry;var yy={readContext:Vn,use:zc,useCallback:oy,useContext:Vn,useEffect:M1,useImperativeHandle:iy,useInsertionEffect:ay,useLayoutEffect:ny,useMemo:ly,useReducer:mf,useRef:_m,useState:function(){return mf(eo)},useDebugValue:I1,useDeferredValue:function(o,u){var h=Ga();return hr===null?B1(h,o,u):cy(h,hr.memoizedState,o,u)},useTransition:function(){var o=mf(eo)[0],u=Ga().memoizedState;return[typeof o=="boolean"?o:vl(o),u]},useSyncExternalStore:pf,useId:hy,useHostTransitionStatus:q1,useFormState:xf,useActionState:xf,useOptimistic:function(o,u){var h=Ga();return hr!==null?gm(h,hr,o,u):(h.baseState=o,[o,h.queue.dispatch])},useMemoCache:Vl,useCacheRefresh:my};yy.useEffectEvent=ry;function $1(o,u,h,p){u=o.memoizedState,h=h(p,u),h=h==null?u:v({},u,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var W1={enqueueSetState:function(o,u,h){o=o._reactInternals;var p=Ci(),S=xr(p);S.payload=u,h!=null&&(S.callback=h),u=Or(o,S,p),u!==null&&(di(u,o,p),la(u,o,p))},enqueueReplaceState:function(o,u,h){o=o._reactInternals;var p=Ci(),S=xr(p);S.tag=1,S.payload=u,h!=null&&(S.callback=h),u=Or(o,S,p),u!==null&&(di(u,o,p),la(u,o,p))},enqueueForceUpdate:function(o,u){o=o._reactInternals;var h=Ci(),p=xr(h);p.tag=2,u!=null&&(p.callback=u),u=Or(o,p,h),u!==null&&(di(u,o,h),la(u,o,h))}};function _y(o,u,h,p,S,k,Y){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(p,k,Y):u.prototype&&u.prototype.isPureReactComponent?!Oo(h,p)||!Oo(S,k):!0}function by(o,u,h,p){o=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(h,p),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(h,p),u.state!==o&&W1.enqueueReplaceState(u,u.state,null)}function Zu(o,u){var h=u;if("ref"in u){h={};for(var p in u)p!=="ref"&&(h[p]=u[p])}if(o=o.defaultProps){h===u&&(h=v({},h));for(var S in o)h[S]===void 0&&(h[S]=o[S])}return h}function wy(o){qu(o)}function Sy(o){console.error(o)}function Ny(o){qu(o)}function wm(o,u){try{var h=o.onUncaughtError;h(u.value,{componentStack:u.stack})}catch(p){setTimeout(function(){throw p})}}function jy(o,u,h){try{var p=o.onCaughtError;p(h.value,{componentStack:h.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function V1(o,u,h){return h=xr(h),h.tag=3,h.payload={element:null},h.callback=function(){wm(o,u)},h}function ky(o){return o=xr(o),o.tag=3,o}function Ey(o,u,h,p){var S=h.type.getDerivedStateFromError;if(typeof S=="function"){var k=p.value;o.payload=function(){return S(k)},o.callback=function(){jy(u,h,p)}}var Y=h.stateNode;Y!==null&&typeof Y.componentDidCatch=="function"&&(o.callback=function(){jy(u,h,p),typeof S!="function"&&(Xc===null?Xc=new Set([this]):Xc.add(this));var de=p.stack;this.componentDidCatch(p.value,{componentStack:de!==null?de:""})})}function Ok(o,u,h,p,S){if(h.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(u=h.alternate,u!==null&&hl(u,h,S,!0),h=Ia.current,h!==null){switch(h.tag){case 31:case 13:return Jr===null?Fm():h.alternate===null&&hn===0&&(hn=3),h.flags&=-257,h.flags|=65536,h.lanes=S,p===Me?h.flags|=16384:(u=h.updateQueue,u===null?h.updateQueue=new Set([p]):u.add(p),vg(o,p,S)),!1;case 22:return h.flags|=65536,p===Me?h.flags|=16384:(u=h.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([p])},h.updateQueue=u):(h=u.retryQueue,h===null?u.retryQueue=new Set([p]):h.add(p)),vg(o,p,S)),!1}throw Error(a(435,h.tag))}return vg(o,p,S),Fm(),!1}if(qr)return u=Ia.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=S,p!==ki&&(o=Error(a(422),{cause:p}),Bc(ei(o,h)))):(p!==ki&&(u=Error(a(423),{cause:p}),Bc(ei(u,h))),o=o.current.alternate,o.flags|=65536,S&=-S,o.lanes|=S,p=ei(p,h),S=V1(o.stateNode,p,S),bn(o,S),hn!==4&&(hn=2)),!1;var k=Error(a(520),{cause:p});if(k=ei(k,h),Vh===null?Vh=[k]:Vh.push(k),hn!==4&&(hn=2),u===null)return!0;p=ei(p,h),h=u;do{switch(h.tag){case 3:return h.flags|=65536,o=S&-S,h.lanes|=o,o=V1(h.stateNode,p,o),bn(h,o),!1;case 1:if(u=h.type,k=h.stateNode,(h.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Xc===null||!Xc.has(k))))return h.flags|=65536,S&=-S,h.lanes|=S,S=ky(S),Ey(S,o,h,p),bn(h,S),!1}h=h.return}while(h!==null);return!1}var G1=Error(a(461)),Fn=!1;function ps(o,u,h,p){u.child=o===null?Ar(u,null,h,p):Ca(u,o.child,h,p)}function Ay(o,u,h,p,S){h=h.render;var k=u.ref;if("ref"in p){var Y={};for(var de in p)de!=="ref"&&(Y[de]=p[de])}else Y=p;return ml(u),p=Th(o,u,h,Y,k,S),de=Oh(),o!==null&&!Fn?(Rh(o,u,S),Xl(o,u,S)):(qr&&de&&kh(u),u.flags|=1,ps(o,u,p,S),u.child)}function Cy(o,u,h,p,S){if(o===null){var k=h.type;return typeof k=="function"&&!ef(k)&&k.defaultProps===void 0&&h.compare===null?(u.tag=15,u.type=k,Ty(o,u,k,p,S)):(o=Pc(h.type,null,p,u,u.mode,S),o.ref=u.ref,o.return=u,u.child=o)}if(k=o.child,!tg(o,S)){var Y=k.memoizedProps;if(h=h.compare,h=h!==null?h:Oo,h(Y,p)&&o.ref===u.ref)return Xl(o,u,S)}return u.flags|=1,o=Qs(k,p),o.ref=u.ref,o.return=u,u.child=o}function Ty(o,u,h,p,S){if(o!==null){var k=o.memoizedProps;if(Oo(k,p)&&o.ref===u.ref)if(Fn=!1,u.pendingProps=p=k,tg(o,S))(o.flags&131072)!==0&&(Fn=!0);else return u.lanes=o.lanes,Xl(o,u,S)}return Y1(o,u,h,p,S)}function Oy(o,u,h,p){var S=p.children,k=o!==null?o.memoizedState:null;if(o===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((u.flags&128)!==0){if(k=k!==null?k.baseLanes|h:h,o!==null){for(p=u.child=o.child,S=0;p!==null;)S=S|p.lanes|p.childLanes,p=p.sibling;p=S&~k}else p=0,u.child=null;return Ry(o,u,k,h,p)}if((h&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},o!==null&&ye(u,k!==null?k.cachePool:null),k!==null?Ma(u,k):ta(),un(u);else return p=u.lanes=536870912,Ry(o,u,k!==null?k.baseLanes|h:h,h,p)}else k!==null?(ye(u,k.cachePool),Ma(u,k),dn(),u.memoizedState=null):(o!==null&&ye(u,null),ta(),dn());return ps(o,u,S,h),u.child}function Bh(o,u){return o!==null&&o.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function Ry(o,u,h,p,S){var k=he();return k=k===null?null:{parent:Qa._currentValue,pool:k},u.memoizedState={baseLanes:h,cachePool:k},o!==null&&ye(u,null),ta(),un(u),o!==null&&hl(o,u,p,!0),u.childLanes=S,null}function Sm(o,u){return u=jm({mode:u.mode,children:u.children},o.mode),u.ref=o.ref,o.child=u,u.return=o,u}function Dy(o,u,h){return Ca(u,o.child,null,h),o=Sm(u,u.pendingProps),o.flags|=2,ha(u),u.memoizedState=null,o}function Rk(o,u,h){var p=u.pendingProps,S=(u.flags&128)!==0;if(u.flags&=-129,o===null){if(qr){if(p.mode==="hidden")return o=Sm(u,p),u.lanes=536870912,Bh(null,o);if(ca(u),(o=Aa)?(o=W_(o,Wa),o=o!==null&&o.data==="&"?o:null,o!==null&&(u.memoizedState={dehydrated:o,treeContext:cl!==null?{id:ai,overflow:ni}:null,retryLane:536870912,hydrationErrors:null},h=tf(o),h.return=u,u.child=h,$n=u,Aa=null)):o=null,o===null)throw ul(u);return u.lanes=536870912,null}return Sm(u,p)}var k=o.memoizedState;if(k!==null){var Y=k.dehydrated;if(ca(u),S)if(u.flags&256)u.flags&=-257,u=Dy(o,u,h);else if(u.memoizedState!==null)u.child=o.child,u.flags|=128,u=null;else throw Error(a(558));else if(Fn||hl(o,u,h,!1),S=(h&o.childLanes)!==0,Fn||S){if(p=Ta,p!==null&&(Y=nn(p,h),Y!==0&&Y!==k.retryLane))throw k.retryLane=Y,Lo(o,Y),di(p,o,Y),G1;Fm(),u=Dy(o,u,h)}else o=k.treeContext,Aa=ro(Y.nextSibling),$n=u,qr=!0,hs=null,Wa=!1,o!==null&&hm(u,o),u=Sm(u,p),u.flags|=4096;return u}return o=Qs(o.child,{mode:p.mode,children:p.children}),o.ref=u.ref,u.child=o,o.return=u,o}function Nm(o,u){var h=u.ref;if(h===null)o!==null&&o.ref!==null&&(u.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(a(284));(o===null||o.ref!==h)&&(u.flags|=4194816)}}function Y1(o,u,h,p,S){return ml(u),h=Th(o,u,h,p,void 0,S),p=Oh(),o!==null&&!Fn?(Rh(o,u,S),Xl(o,u,S)):(qr&&p&&kh(u),u.flags|=1,ps(o,u,h,S),u.child)}function Fy(o,u,h,p,S,k){return ml(u),u.updateQueue=null,h=Mo(u,p,h,S),df(o),p=Oh(),o!==null&&!Fn?(Rh(o,u,k),Xl(o,u,k)):(qr&&p&&kh(u),u.flags|=1,ps(o,u,h,k),u.child)}function Ly(o,u,h,p,S){if(ml(u),u.stateNode===null){var k=Hn,Y=h.contextType;typeof Y=="object"&&Y!==null&&(k=Vn(Y)),k=new h(p,k),u.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=W1,u.stateNode=k,k._reactInternals=u,k=u.stateNode,k.props=p,k.state=u.memoizedState,k.refs={},Bt(u),Y=h.contextType,k.context=typeof Y=="object"&&Y!==null?Vn(Y):Hn,k.state=u.memoizedState,Y=h.getDerivedStateFromProps,typeof Y=="function"&&($1(u,h,Y,p),k.state=u.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(Y=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),Y!==k.state&&W1.enqueueReplaceState(k,k.state,null),ln(u,p,k,S),wa(),k.state=u.memoizedState),typeof k.componentDidMount=="function"&&(u.flags|=4194308),p=!0}else if(o===null){k=u.stateNode;var de=u.memoizedProps,Oe=Zu(h,de);k.props=Oe;var tt=k.context,ht=h.contextType;Y=Hn,typeof ht=="object"&&ht!==null&&(Y=Vn(ht));var xt=h.getDerivedStateFromProps;ht=typeof xt=="function"||typeof k.getSnapshotBeforeUpdate=="function",de=u.pendingProps!==de,ht||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(de||tt!==Y)&&by(u,k,p,Y),Yt=!1;var at=u.memoizedState;k.state=at,ln(u,p,k,S),wa(),tt=u.memoizedState,de||at!==tt||Yt?(typeof xt=="function"&&($1(u,h,xt,p),tt=u.memoizedState),(Oe=Yt||_y(u,h,Oe,p,at,tt,Y))?(ht||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(u.flags|=4194308)):(typeof k.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=p,u.memoizedState=tt),k.props=p,k.state=tt,k.context=Y,p=Oe):(typeof k.componentDidMount=="function"&&(u.flags|=4194308),p=!1)}else{k=u.stateNode,Pa(o,u),Y=u.memoizedProps,ht=Zu(h,Y),k.props=ht,xt=u.pendingProps,at=k.context,tt=h.contextType,Oe=Hn,typeof tt=="object"&&tt!==null&&(Oe=Vn(tt)),de=h.getDerivedStateFromProps,(tt=typeof de=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(Y!==xt||at!==Oe)&&by(u,k,p,Oe),Yt=!1,at=u.memoizedState,k.state=at,ln(u,p,k,S),wa();var it=u.memoizedState;Y!==xt||at!==it||Yt||o!==null&&o.dependencies!==null&&of(o.dependencies)?(typeof de=="function"&&($1(u,h,de,p),it=u.memoizedState),(ht=Yt||_y(u,h,ht,p,at,it,Oe)||o!==null&&o.dependencies!==null&&of(o.dependencies))?(tt||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(p,it,Oe),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(p,it,Oe)),typeof k.componentDidUpdate=="function"&&(u.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof k.componentDidUpdate!="function"||Y===o.memoizedProps&&at===o.memoizedState||(u.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||Y===o.memoizedProps&&at===o.memoizedState||(u.flags|=1024),u.memoizedProps=p,u.memoizedState=it),k.props=p,k.state=it,k.context=Oe,p=ht):(typeof k.componentDidUpdate!="function"||Y===o.memoizedProps&&at===o.memoizedState||(u.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||Y===o.memoizedProps&&at===o.memoizedState||(u.flags|=1024),p=!1)}return k=p,Nm(o,u),p=(u.flags&128)!==0,k||p?(k=u.stateNode,h=p&&typeof h.getDerivedStateFromError!="function"?null:k.render(),u.flags|=1,o!==null&&p?(u.child=Ca(u,o.child,null,S),u.child=Ca(u,null,h,S)):ps(o,u,h,S),u.memoizedState=k.state,o=u.child):o=Xl(o,u,S),o}function Py(o,u,h,p){return $l(),u.flags|=256,ps(o,u,h,p),u.child}var X1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function K1(o){return{baseLanes:o,cachePool:Ee()}}function J1(o,u,h){return o=o!==null?o.childLanes&~h:0,u&&(o|=Ai),o}function My(o,u,h){var p=u.pendingProps,S=!1,k=(u.flags&128)!==0,Y;if((Y=k)||(Y=o!==null&&o.memoizedState===null?!1:(Yr.current&2)!==0),Y&&(S=!0,u.flags&=-129),Y=(u.flags&32)!==0,u.flags&=-33,o===null){if(qr){if(S?en(u):dn(),(o=Aa)?(o=W_(o,Wa),o=o!==null&&o.data!=="&"?o:null,o!==null&&(u.memoizedState={dehydrated:o,treeContext:cl!==null?{id:ai,overflow:ni}:null,retryLane:536870912,hydrationErrors:null},h=tf(o),h.return=u,u.child=h,$n=u,Aa=null)):o=null,o===null)throw ul(u);return Dg(o)?u.lanes=32:u.lanes=536870912,null}var de=p.children;return p=p.fallback,S?(dn(),S=u.mode,de=jm({mode:"hidden",children:de},S),p=ll(p,S,h,null),de.return=u,p.return=u,de.sibling=p,u.child=de,p=u.child,p.memoizedState=K1(h),p.childLanes=J1(o,Y,h),u.memoizedState=X1,Bh(null,p)):(en(u),Z1(u,de))}var Oe=o.memoizedState;if(Oe!==null&&(de=Oe.dehydrated,de!==null)){if(k)u.flags&256?(en(u),u.flags&=-257,u=Q1(o,u,h)):u.memoizedState!==null?(dn(),u.child=o.child,u.flags|=128,u=null):(dn(),de=p.fallback,S=u.mode,p=jm({mode:"visible",children:p.children},S),de=ll(de,S,h,null),de.flags|=2,p.return=u,de.return=u,p.sibling=de,u.child=p,Ca(u,o.child,null,h),p=u.child,p.memoizedState=K1(h),p.childLanes=J1(o,Y,h),u.memoizedState=X1,u=Bh(null,p));else if(en(u),Dg(de)){if(Y=de.nextSibling&&de.nextSibling.dataset,Y)var tt=Y.dgst;Y=tt,p=Error(a(419)),p.stack="",p.digest=Y,Bc({value:p,source:null,stack:null}),u=Q1(o,u,h)}else if(Fn||hl(o,u,h,!1),Y=(h&o.childLanes)!==0,Fn||Y){if(Y=Ta,Y!==null&&(p=nn(Y,h),p!==0&&p!==Oe.retryLane))throw Oe.retryLane=p,Lo(o,p),di(Y,o,p),G1;Rg(de)||Fm(),u=Q1(o,u,h)}else Rg(de)?(u.flags|=192,u.child=o.child,u=null):(o=Oe.treeContext,Aa=ro(de.nextSibling),$n=u,qr=!0,hs=null,Wa=!1,o!==null&&hm(u,o),u=Z1(u,p.children),u.flags|=4096);return u}return S?(dn(),de=p.fallback,S=u.mode,Oe=o.child,tt=Oe.sibling,p=Qs(Oe,{mode:"hidden",children:p.children}),p.subtreeFlags=Oe.subtreeFlags&65011712,tt!==null?de=Qs(tt,de):(de=ll(de,S,h,null),de.flags|=2),de.return=u,p.return=u,p.sibling=de,u.child=p,Bh(null,p),p=u.child,de=o.child.memoizedState,de===null?de=K1(h):(S=de.cachePool,S!==null?(Oe=Qa._currentValue,S=S.parent!==Oe?{parent:Oe,pool:Oe}:S):S=Ee(),de={baseLanes:de.baseLanes|h,cachePool:S}),p.memoizedState=de,p.childLanes=J1(o,Y,h),u.memoizedState=X1,Bh(o.child,p)):(en(u),h=o.child,o=h.sibling,h=Qs(h,{mode:"visible",children:p.children}),h.return=u,h.sibling=null,o!==null&&(Y=u.deletions,Y===null?(u.deletions=[o],u.flags|=16):Y.push(o)),u.child=h,u.memoizedState=null,h)}function Z1(o,u){return u=jm({mode:"visible",children:u},o.mode),u.return=o,o.child=u}function jm(o,u){return o=es(22,o,null,u),o.lanes=0,o}function Q1(o,u,h){return Ca(u,o.child,null,h),o=Z1(u,u.pendingProps.children),o.flags|=2,u.memoizedState=null,o}function Iy(o,u,h){o.lanes|=u;var p=o.alternate;p!==null&&(p.lanes|=u),Uc(o.return,u,h)}function eg(o,u,h,p,S,k){var Y=o.memoizedState;Y===null?o.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:S,treeForkCount:k}:(Y.isBackwards=u,Y.rendering=null,Y.renderingStartTime=0,Y.last=p,Y.tail=h,Y.tailMode=S,Y.treeForkCount=k)}function By(o,u,h){var p=u.pendingProps,S=p.revealOrder,k=p.tail;p=p.children;var Y=Yr.current,de=(Y&2)!==0;if(de?(Y=Y&1|2,u.flags|=128):Y&=1,F(Yr,Y),ps(o,u,p,h),p=qr?Gu:0,!de&&o!==null&&(o.flags&128)!==0)e:for(o=u.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Iy(o,h,u);else if(o.tag===19)Iy(o,h,u);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===u)break e;for(;o.sibling===null;){if(o.return===null||o.return===u)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}switch(S){case"forwards":for(h=u.child,S=null;h!==null;)o=h.alternate,o!==null&&rs(o)===null&&(S=h),h=h.sibling;h=S,h===null?(S=u.child,u.child=null):(S=h.sibling,h.sibling=null),eg(u,!1,S,h,k,p);break;case"backwards":case"unstable_legacy-backwards":for(h=null,S=u.child,u.child=null;S!==null;){if(o=S.alternate,o!==null&&rs(o)===null){u.child=S;break}o=S.sibling,S.sibling=h,h=S,S=o}eg(u,!0,h,null,k,p);break;case"together":eg(u,!1,null,null,void 0,p);break;default:u.memoizedState=null}return u.child}function Xl(o,u,h){if(o!==null&&(u.dependencies=o.dependencies),Yc|=u.lanes,(h&u.childLanes)===0)if(o!==null){if(hl(o,u,h,!1),(h&u.childLanes)===0)return null}else return null;if(o!==null&&u.child!==o.child)throw Error(a(153));if(u.child!==null){for(o=u.child,h=Qs(o,o.pendingProps),u.child=h,h.return=u;o.sibling!==null;)o=o.sibling,h=h.sibling=Qs(o,o.pendingProps),h.return=u;h.sibling=null}return u.child}function tg(o,u){return(o.lanes&u)!==0?!0:(o=o.dependencies,!!(o!==null&&of(o)))}function Dk(o,u,h){switch(u.tag){case 3:je(u,u.stateNode.containerInfo),fl(u,Qa,o.memoizedState.cache),$l();break;case 27:case 5:ge(u);break;case 4:je(u,u.stateNode.containerInfo);break;case 10:fl(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,ca(u),null;break;case 13:var p=u.memoizedState;if(p!==null)return p.dehydrated!==null?(en(u),u.flags|=128,null):(h&u.child.childLanes)!==0?My(o,u,h):(en(u),o=Xl(o,u,h),o!==null?o.sibling:null);en(u);break;case 19:var S=(o.flags&128)!==0;if(p=(h&u.childLanes)!==0,p||(hl(o,u,h,!1),p=(h&u.childLanes)!==0),S){if(p)return By(o,u,h);u.flags|=128}if(S=u.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),F(Yr,Yr.current),p)break;return null;case 22:return u.lanes=0,Oy(o,u,h,u.pendingProps);case 24:fl(u,Qa,o.memoizedState.cache)}return Xl(o,u,h)}function Uy(o,u,h){if(o!==null)if(o.memoizedProps!==u.pendingProps)Fn=!0;else{if(!tg(o,h)&&(u.flags&128)===0)return Fn=!1,Dk(o,u,h);Fn=(o.flags&131072)!==0}else Fn=!1,qr&&(u.flags&1048576)!==0&&fm(u,Gu,u.index);switch(u.lanes=0,u.tag){case 16:e:{var p=u.pendingProps;if(o=Ye(u.elementType),u.type=o,typeof o=="function")ef(o)?(p=Zu(o,p),u.tag=1,u=Ly(null,u,o,p,h)):(u.tag=0,u=Y1(null,u,o,p,h));else{if(o!=null){var S=o.$$typeof;if(S===O){u.tag=11,u=Ay(null,u,o,p,h);break e}else if(S===B){u.tag=14,u=Cy(null,u,o,p,h);break e}}throw u=V(o)||o,Error(a(306,u,""))}}return u;case 0:return Y1(o,u,u.type,u.pendingProps,h);case 1:return p=u.type,S=Zu(p,u.pendingProps),Ly(o,u,p,S,h);case 3:e:{if(je(u,u.stateNode.containerInfo),o===null)throw Error(a(387));p=u.pendingProps;var k=u.memoizedState;S=k.element,Pa(o,u),ln(u,p,null,h);var Y=u.memoizedState;if(p=Y.cache,fl(u,Qa,p),p!==k.cache&&Wl(u,[Qa],h,!0),wa(),p=Y.element,k.isDehydrated)if(k={element:p,isDehydrated:!1,cache:Y.cache},u.updateQueue.baseState=k,u.memoizedState=k,u.flags&256){u=Py(o,u,p,h);break e}else if(p!==S){S=ei(Error(a(424)),u),Bc(S),u=Py(o,u,p,h);break e}else{switch(o=u.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(Aa=ro(o.firstChild),$n=u,qr=!0,hs=null,Wa=!0,h=Ar(u,null,p,h),u.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if($l(),p===S){u=Xl(o,u,h);break e}ps(o,u,p,h)}u=u.child}return u;case 26:return Nm(o,u),o===null?(h=J_(u.type,null,u.pendingProps,null))?u.memoizedState=h:qr||(h=u.type,o=u.pendingProps,p=qm(ne.current).createElement(h),p[pe]=u,p[Se]=o,gs(p,h,o),Jt(p),u.stateNode=p):u.memoizedState=J_(u.type,o.memoizedProps,u.pendingProps,o.memoizedState),null;case 27:return ge(u),o===null&&qr&&(p=u.stateNode=Y_(u.type,u.pendingProps,ne.current),$n=u,Wa=!0,S=Aa,Qc(u.type)?(Fg=S,Aa=ro(p.firstChild)):Aa=S),ps(o,u,u.pendingProps.children,h),Nm(o,u),o===null&&(u.flags|=4194304),u.child;case 5:return o===null&&qr&&((S=p=Aa)&&(p=cE(p,u.type,u.pendingProps,Wa),p!==null?(u.stateNode=p,$n=u,Aa=ro(p.firstChild),Wa=!1,S=!0):S=!1),S||ul(u)),ge(u),S=u.type,k=u.pendingProps,Y=o!==null?o.memoizedProps:null,p=k.children,Cg(S,k)?p=null:Y!==null&&Cg(S,Y)&&(u.flags|=32),u.memoizedState!==null&&(S=Th(o,u,P1,null,null,h),e0._currentValue=S),Nm(o,u),ps(o,u,p,h),u.child;case 6:return o===null&&qr&&((o=h=Aa)&&(h=uE(h,u.pendingProps,Wa),h!==null?(u.stateNode=h,$n=u,Aa=null,o=!0):o=!1),o||ul(u)),null;case 13:return My(o,u,h);case 4:return je(u,u.stateNode.containerInfo),p=u.pendingProps,o===null?u.child=Ca(u,null,p,h):ps(o,u,p,h),u.child;case 11:return Ay(o,u,u.type,u.pendingProps,h);case 7:return ps(o,u,u.pendingProps,h),u.child;case 8:return ps(o,u,u.pendingProps.children,h),u.child;case 12:return ps(o,u,u.pendingProps.children,h),u.child;case 10:return p=u.pendingProps,fl(u,u.type,p.value),ps(o,u,p.children,h),u.child;case 9:return S=u.type._context,p=u.pendingProps.children,ml(u),S=Vn(S),p=p(S),u.flags|=1,ps(o,u,p,h),u.child;case 14:return Cy(o,u,u.type,u.pendingProps,h);case 15:return Ty(o,u,u.type,u.pendingProps,h);case 19:return By(o,u,h);case 31:return Rk(o,u,h);case 22:return Oy(o,u,h,u.pendingProps);case 24:return ml(u),p=Vn(Qa),o===null?(S=he(),S===null&&(S=Ta,k=qc(),S.pooledCache=k,k.refCount++,k!==null&&(S.pooledCacheLanes|=h),S=k),u.memoizedState={parent:p,cache:S},Bt(u),fl(u,Qa,S)):((o.lanes&h)!==0&&(Pa(o,u),ln(u,null,null,h),wa()),S=o.memoizedState,k=u.memoizedState,S.parent!==p?(S={parent:p,cache:p},u.memoizedState=S,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=S),fl(u,Qa,p)):(p=k.cache,fl(u,Qa,p),p!==S.cache&&Wl(u,[Qa],h,!0))),ps(o,u,u.pendingProps.children,h),u.child;case 29:throw u.pendingProps}throw Error(a(156,u.tag))}function Kl(o){o.flags|=4}function rg(o,u,h,p,S){if((u=(o.mode&32)!==0)&&(u=!1),u){if(o.flags|=16777216,(S&335544128)===S)if(o.stateNode.complete)o.flags|=8192;else if(h_())o.flags|=8192;else throw ut=Me,Ze}else o.flags&=-16777217}function qy(o,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!rb(u))if(h_())o.flags|=8192;else throw ut=Me,Ze}function km(o,u){u!==null&&(o.flags|=4),o.flags&16384&&(u=o.tag!==22?Nt():536870912,o.lanes|=u,wf|=u)}function Uh(o,u){if(!qr)switch(o.tailMode){case"hidden":u=o.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?u||o.tail===null?o.tail=null:o.tail.sibling=null:p.sibling=null}}function Ba(o){var u=o.alternate!==null&&o.alternate.child===o.child,h=0,p=0;if(u)for(var S=o.child;S!==null;)h|=S.lanes|S.childLanes,p|=S.subtreeFlags&65011712,p|=S.flags&65011712,S.return=o,S=S.sibling;else for(S=o.child;S!==null;)h|=S.lanes|S.childLanes,p|=S.subtreeFlags,p|=S.flags,S.return=o,S=S.sibling;return o.subtreeFlags|=p,o.childLanes=h,u}function Fk(o,u,h){var p=u.pendingProps;switch(nf(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ba(u),null;case 1:return Ba(u),null;case 3:return h=u.stateNode,p=null,o!==null&&(p=o.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),si(Qa),Ne(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(o===null||o.child===null)&&(Wn(u)?Kl(u):o===null||o.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Ah())),Ba(u),null;case 26:var S=u.type,k=u.memoizedState;return o===null?(Kl(u),k!==null?(Ba(u),qy(u,k)):(Ba(u),rg(u,S,null,p,h))):k?k!==o.memoizedState?(Kl(u),Ba(u),qy(u,k)):(Ba(u),u.flags&=-16777217):(o=o.memoizedProps,o!==p&&Kl(u),Ba(u),rg(u,S,o,p,h)),null;case 27:if(Ie(u),h=ne.current,S=u.type,o!==null&&u.stateNode!=null)o.memoizedProps!==p&&Kl(u);else{if(!p){if(u.stateNode===null)throw Error(a(166));return Ba(u),null}o=I.current,Wn(u)?Eh(u):(o=Y_(S,p,h),u.stateNode=o,Kl(u))}return Ba(u),null;case 5:if(Ie(u),S=u.type,o!==null&&u.stateNode!=null)o.memoizedProps!==p&&Kl(u);else{if(!p){if(u.stateNode===null)throw Error(a(166));return Ba(u),null}if(k=I.current,Wn(u))Eh(u);else{var Y=qm(ne.current);switch(k){case 1:k=Y.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:k=Y.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":k=Y.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":k=Y.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":k=Y.createElement("div"),k.innerHTML="<script><\/script>",k=k.removeChild(k.firstChild);break;case"select":k=typeof p.is=="string"?Y.createElement("select",{is:p.is}):Y.createElement("select"),p.multiple?k.multiple=!0:p.size&&(k.size=p.size);break;default:k=typeof p.is=="string"?Y.createElement(S,{is:p.is}):Y.createElement(S)}}k[pe]=u,k[Se]=p;e:for(Y=u.child;Y!==null;){if(Y.tag===5||Y.tag===6)k.appendChild(Y.stateNode);else if(Y.tag!==4&&Y.tag!==27&&Y.child!==null){Y.child.return=Y,Y=Y.child;continue}if(Y===u)break e;for(;Y.sibling===null;){if(Y.return===null||Y.return===u)break e;Y=Y.return}Y.sibling.return=Y.return,Y=Y.sibling}u.stateNode=k;e:switch(gs(k,S,p),S){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Kl(u)}}return Ba(u),rg(u,u.type,o===null?null:o.memoizedProps,u.pendingProps,h),null;case 6:if(o&&u.stateNode!=null)o.memoizedProps!==p&&Kl(u);else{if(typeof p!="string"&&u.stateNode===null)throw Error(a(166));if(o=ne.current,Wn(u)){if(o=u.stateNode,h=u.memoizedProps,p=null,S=$n,S!==null)switch(S.tag){case 27:case 5:p=S.memoizedProps}o[pe]=u,o=!!(o.nodeValue===h||p!==null&&p.suppressHydrationWarning===!0||M_(o.nodeValue,h)),o||ul(u,!0)}else o=qm(o).createTextNode(p),o[pe]=u,u.stateNode=o}return Ba(u),null;case 31:if(h=u.memoizedState,o===null||o.memoizedState!==null){if(p=Wn(u),h!==null){if(o===null){if(!p)throw Error(a(318));if(o=u.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(a(557));o[pe]=u}else $l(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Ba(u),o=!1}else h=Ah(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=h),o=!0;if(!o)return u.flags&256?(ha(u),u):(ha(u),null);if((u.flags&128)!==0)throw Error(a(558))}return Ba(u),null;case 13:if(p=u.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(S=Wn(u),p!==null&&p.dehydrated!==null){if(o===null){if(!S)throw Error(a(318));if(S=u.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(a(317));S[pe]=u}else $l(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;Ba(u),S=!1}else S=Ah(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=S),S=!0;if(!S)return u.flags&256?(ha(u),u):(ha(u),null)}return ha(u),(u.flags&128)!==0?(u.lanes=h,u):(h=p!==null,o=o!==null&&o.memoizedState!==null,h&&(p=u.child,S=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(S=p.alternate.memoizedState.cachePool.pool),k=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(k=p.memoizedState.cachePool.pool),k!==S&&(p.flags|=2048)),h!==o&&h&&(u.child.flags|=8192),km(u,u.updateQueue),Ba(u),null);case 4:return Ne(),o===null&&Ng(u.stateNode.containerInfo),Ba(u),null;case 10:return si(u.type),Ba(u),null;case 19:if(j(Yr),p=u.memoizedState,p===null)return Ba(u),null;if(S=(u.flags&128)!==0,k=p.rendering,k===null)if(S)Uh(p,!1);else{if(hn!==0||o!==null&&(o.flags&128)!==0)for(o=u.child;o!==null;){if(k=rs(o),k!==null){for(u.flags|=128,Uh(p,!1),o=k.updateQueue,u.updateQueue=o,km(u,o),u.subtreeFlags=0,o=h,h=u.child;h!==null;)Wu(h,o),h=h.sibling;return F(Yr,Yr.current&1|2),qr&&Ws(u,p.treeForkCount),u.child}o=o.sibling}p.tail!==null&&Ft()>Om&&(u.flags|=128,S=!0,Uh(p,!1),u.lanes=4194304)}else{if(!S)if(o=rs(k),o!==null){if(u.flags|=128,S=!0,o=o.updateQueue,u.updateQueue=o,km(u,o),Uh(p,!0),p.tail===null&&p.tailMode==="hidden"&&!k.alternate&&!qr)return Ba(u),null}else 2*Ft()-p.renderingStartTime>Om&&h!==536870912&&(u.flags|=128,S=!0,Uh(p,!1),u.lanes=4194304);p.isBackwards?(k.sibling=u.child,u.child=k):(o=p.last,o!==null?o.sibling=k:u.child=k,p.last=k)}return p.tail!==null?(o=p.tail,p.rendering=o,p.tail=o.sibling,p.renderingStartTime=Ft(),o.sibling=null,h=Yr.current,F(Yr,S?h&1|2:h&1),qr&&Ws(u,p.treeForkCount),o):(Ba(u),null);case 22:case 23:return ha(u),wn(),p=u.memoizedState!==null,o!==null?o.memoizedState!==null!==p&&(u.flags|=8192):p&&(u.flags|=8192),p?(h&536870912)!==0&&(u.flags&128)===0&&(Ba(u),u.subtreeFlags&6&&(u.flags|=8192)):Ba(u),h=u.updateQueue,h!==null&&km(u,h.retryQueue),h=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),p=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==h&&(u.flags|=2048),o!==null&&j(ce),null;case 24:return h=null,o!==null&&(h=o.memoizedState.cache),u.memoizedState.cache!==h&&(u.flags|=2048),si(Qa),Ba(u),null;case 25:return null;case 30:return null}throw Error(a(156,u.tag))}function Lk(o,u){switch(nf(u),u.tag){case 1:return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 3:return si(Qa),Ne(),o=u.flags,(o&65536)!==0&&(o&128)===0?(u.flags=o&-65537|128,u):null;case 26:case 27:case 5:return Ie(u),null;case 31:if(u.memoizedState!==null){if(ha(u),u.alternate===null)throw Error(a(340));$l()}return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 13:if(ha(u),o=u.memoizedState,o!==null&&o.dehydrated!==null){if(u.alternate===null)throw Error(a(340));$l()}return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 19:return j(Yr),null;case 4:return Ne(),null;case 10:return si(u.type),null;case 22:case 23:return ha(u),wn(),o!==null&&j(ce),o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 24:return si(Qa),null;case 25:return null;default:return null}}function zy(o,u){switch(nf(u),u.tag){case 3:si(Qa),Ne();break;case 26:case 27:case 5:Ie(u);break;case 4:Ne();break;case 31:u.memoizedState!==null&&ha(u);break;case 13:ha(u);break;case 19:j(Yr);break;case 10:si(u.type);break;case 22:case 23:ha(u),wn(),o!==null&&j(ce);break;case 24:si(Qa)}}function qh(o,u){try{var h=u.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var S=p.next;h=S;do{if((h.tag&o)===o){p=void 0;var k=h.create,Y=h.inst;p=k(),Y.destroy=p}h=h.next}while(h!==S)}}catch(de){pa(u,u.return,de)}}function Vc(o,u,h){try{var p=u.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var k=S.next;p=k;do{if((p.tag&o)===o){var Y=p.inst,de=Y.destroy;if(de!==void 0){Y.destroy=void 0,S=u;var Oe=h,tt=de;try{tt()}catch(ht){pa(S,Oe,ht)}}}p=p.next}while(p!==k)}}catch(ht){pa(u,u.return,ht)}}function Hy(o){var u=o.updateQueue;if(u!==null){var h=o.stateNode;try{cn(u,h)}catch(p){pa(o,o.return,p)}}}function $y(o,u,h){h.props=Zu(o.type,o.memoizedProps),h.state=o.memoizedState;try{h.componentWillUnmount()}catch(p){pa(o,u,p)}}function zh(o,u){try{var h=o.ref;if(h!==null){switch(o.tag){case 26:case 27:case 5:var p=o.stateNode;break;case 30:p=o.stateNode;break;default:p=o.stateNode}typeof h=="function"?o.refCleanup=h(p):h.current=p}}catch(S){pa(o,u,S)}}function yl(o,u){var h=o.ref,p=o.refCleanup;if(h!==null)if(typeof p=="function")try{p()}catch(S){pa(o,u,S)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(S){pa(o,u,S)}else h.current=null}function Wy(o){var u=o.type,h=o.memoizedProps,p=o.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":h.autoFocus&&p.focus();break e;case"img":h.src?p.src=h.src:h.srcSet&&(p.srcset=h.srcSet)}}catch(S){pa(o,o.return,S)}}function ag(o,u,h){try{var p=o.stateNode;aE(p,o.type,h,u),p[Se]=u}catch(S){pa(o,o.return,S)}}function Vy(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&Qc(o.type)||o.tag===4}function ng(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Vy(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&Qc(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function sg(o,u,h){var p=o.tag;if(p===5||p===6)o=o.stateNode,u?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(o,u):(u=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,u.appendChild(o),h=h._reactRootContainer,h!=null||u.onclick!==null||(u.onclick=_i));else if(p!==4&&(p===27&&Qc(o.type)&&(h=o.stateNode,u=null),o=o.child,o!==null))for(sg(o,u,h),o=o.sibling;o!==null;)sg(o,u,h),o=o.sibling}function Em(o,u,h){var p=o.tag;if(p===5||p===6)o=o.stateNode,u?h.insertBefore(o,u):h.appendChild(o);else if(p!==4&&(p===27&&Qc(o.type)&&(h=o.stateNode),o=o.child,o!==null))for(Em(o,u,h),o=o.sibling;o!==null;)Em(o,u,h),o=o.sibling}function Gy(o){var u=o.stateNode,h=o.memoizedProps;try{for(var p=o.type,S=u.attributes;S.length;)u.removeAttributeNode(S[0]);gs(u,p,h),u[pe]=o,u[Se]=h}catch(k){pa(o,o.return,k)}}var Jl=!1,Ln=!1,ig=!1,Yy=typeof WeakSet=="function"?WeakSet:Set,as=null;function Pk(o,u){if(o=o.containerInfo,Eg=Ym,o=Do(o),Ji(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var S=p.anchorOffset,k=p.focusNode;p=p.focusOffset;try{h.nodeType,k.nodeType}catch{h=null;break e}var Y=0,de=-1,Oe=-1,tt=0,ht=0,xt=o,at=null;t:for(;;){for(var it;xt!==h||S!==0&&xt.nodeType!==3||(de=Y+S),xt!==k||p!==0&&xt.nodeType!==3||(Oe=Y+p),xt.nodeType===3&&(Y+=xt.nodeValue.length),(it=xt.firstChild)!==null;)at=xt,xt=it;for(;;){if(xt===o)break t;if(at===h&&++tt===S&&(de=Y),at===k&&++ht===p&&(Oe=Y),(it=xt.nextSibling)!==null)break;xt=at,at=xt.parentNode}xt=it}h=de===-1||Oe===-1?null:{start:de,end:Oe}}else h=null}h=h||{start:0,end:0}}else h=null;for(Ag={focusedElem:o,selectionRange:h},Ym=!1,as=u;as!==null;)if(u=as,o=u.child,(u.subtreeFlags&1028)!==0&&o!==null)o.return=u,as=o;else for(;as!==null;){switch(u=as,k=u.alternate,o=u.flags,u.tag){case 0:if((o&4)!==0&&(o=u.updateQueue,o=o!==null?o.events:null,o!==null))for(h=0;h<o.length;h++)S=o[h],S.ref.impl=S.nextImpl;break;case 11:case 15:break;case 1:if((o&1024)!==0&&k!==null){o=void 0,h=u,S=k.memoizedProps,k=k.memoizedState,p=h.stateNode;try{var tr=Zu(h.type,S);o=p.getSnapshotBeforeUpdate(tr,k),p.__reactInternalSnapshotBeforeUpdate=o}catch(yr){pa(h,h.return,yr)}}break;case 3:if((o&1024)!==0){if(o=u.stateNode.containerInfo,h=o.nodeType,h===9)Og(o);else if(h===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":Og(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(a(163))}if(o=u.sibling,o!==null){o.return=u.return,as=o;break}as=u.return}}function Xy(o,u,h){var p=h.flags;switch(h.tag){case 0:case 11:case 15:Ql(o,h),p&4&&qh(5,h);break;case 1:if(Ql(o,h),p&4)if(o=h.stateNode,u===null)try{o.componentDidMount()}catch(Y){pa(h,h.return,Y)}else{var S=Zu(h.type,u.memoizedProps);u=u.memoizedState;try{o.componentDidUpdate(S,u,o.__reactInternalSnapshotBeforeUpdate)}catch(Y){pa(h,h.return,Y)}}p&64&&Hy(h),p&512&&zh(h,h.return);break;case 3:if(Ql(o,h),p&64&&(o=h.updateQueue,o!==null)){if(u=null,h.child!==null)switch(h.child.tag){case 27:case 5:u=h.child.stateNode;break;case 1:u=h.child.stateNode}try{cn(o,u)}catch(Y){pa(h,h.return,Y)}}break;case 27:u===null&&p&4&&Gy(h);case 26:case 5:Ql(o,h),u===null&&p&4&&Wy(h),p&512&&zh(h,h.return);break;case 12:Ql(o,h);break;case 31:Ql(o,h),p&4&&Zy(o,h);break;case 13:Ql(o,h),p&4&&Qy(o,h),p&64&&(o=h.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(h=Wk.bind(null,h),dE(o,h))));break;case 22:if(p=h.memoizedState!==null||Jl,!p){u=u!==null&&u.memoizedState!==null||Ln,S=Jl;var k=Ln;Jl=p,(Ln=u)&&!k?ec(o,h,(h.subtreeFlags&8772)!==0):Ql(o,h),Jl=S,Ln=k}break;case 30:break;default:Ql(o,h)}}function Ky(o){var u=o.alternate;u!==null&&(o.alternate=null,Ky(u)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(u=o.stateNode,u!==null&&Et(u)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var Ya=null,oi=!1;function Zl(o,u,h){for(h=h.child;h!==null;)Jy(o,u,h),h=h.sibling}function Jy(o,u,h){if(Ct&&typeof Ct.onCommitFiberUnmount=="function")try{Ct.onCommitFiberUnmount(At,h)}catch{}switch(h.tag){case 26:Ln||yl(h,u),Zl(o,u,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Ln||yl(h,u);var p=Ya,S=oi;Qc(h.type)&&(Ya=h.stateNode,oi=!1),Zl(o,u,h),Jh(h.stateNode),Ya=p,oi=S;break;case 5:Ln||yl(h,u);case 6:if(p=Ya,S=oi,Ya=null,Zl(o,u,h),Ya=p,oi=S,Ya!==null)if(oi)try{(Ya.nodeType===9?Ya.body:Ya.nodeName==="HTML"?Ya.ownerDocument.body:Ya).removeChild(h.stateNode)}catch(k){pa(h,u,k)}else try{Ya.removeChild(h.stateNode)}catch(k){pa(h,u,k)}break;case 18:Ya!==null&&(oi?(o=Ya,H_(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,h.stateNode),Tf(o)):H_(Ya,h.stateNode));break;case 4:p=Ya,S=oi,Ya=h.stateNode.containerInfo,oi=!0,Zl(o,u,h),Ya=p,oi=S;break;case 0:case 11:case 14:case 15:Vc(2,h,u),Ln||Vc(4,h,u),Zl(o,u,h);break;case 1:Ln||(yl(h,u),p=h.stateNode,typeof p.componentWillUnmount=="function"&&$y(h,u,p)),Zl(o,u,h);break;case 21:Zl(o,u,h);break;case 22:Ln=(p=Ln)||h.memoizedState!==null,Zl(o,u,h),Ln=p;break;default:Zl(o,u,h)}}function Zy(o,u){if(u.memoizedState===null&&(o=u.alternate,o!==null&&(o=o.memoizedState,o!==null))){o=o.dehydrated;try{Tf(o)}catch(h){pa(u,u.return,h)}}}function Qy(o,u){if(u.memoizedState===null&&(o=u.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Tf(o)}catch(h){pa(u,u.return,h)}}function Mk(o){switch(o.tag){case 31:case 13:case 19:var u=o.stateNode;return u===null&&(u=o.stateNode=new Yy),u;case 22:return o=o.stateNode,u=o._retryCache,u===null&&(u=o._retryCache=new Yy),u;default:throw Error(a(435,o.tag))}}function Am(o,u){var h=Mk(o);u.forEach(function(p){if(!h.has(p)){h.add(p);var S=Vk.bind(null,o,p);p.then(S,S)}})}function li(o,u){var h=u.deletions;if(h!==null)for(var p=0;p<h.length;p++){var S=h[p],k=o,Y=u,de=Y;e:for(;de!==null;){switch(de.tag){case 27:if(Qc(de.type)){Ya=de.stateNode,oi=!1;break e}break;case 5:Ya=de.stateNode,oi=!1;break e;case 3:case 4:Ya=de.stateNode.containerInfo,oi=!0;break e}de=de.return}if(Ya===null)throw Error(a(160));Jy(k,Y,S),Ya=null,oi=!1,k=S.alternate,k!==null&&(k.return=null),S.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)e_(u,o),u=u.sibling}var qo=null;function e_(o,u){var h=o.alternate,p=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:li(u,o),ci(o),p&4&&(Vc(3,o,o.return),qh(3,o),Vc(5,o,o.return));break;case 1:li(u,o),ci(o),p&512&&(Ln||h===null||yl(h,h.return)),p&64&&Jl&&(o=o.updateQueue,o!==null&&(p=o.callbacks,p!==null&&(h=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=h===null?p:h.concat(p))));break;case 26:var S=qo;if(li(u,o),ci(o),p&512&&(Ln||h===null||yl(h,h.return)),p&4){var k=h!==null?h.memoizedState:null;if(p=o.memoizedState,h===null)if(p===null)if(o.stateNode===null){e:{p=o.type,h=o.memoizedProps,S=S.ownerDocument||S;t:switch(p){case"title":k=S.getElementsByTagName("title")[0],(!k||k[Qe]||k[pe]||k.namespaceURI==="http://www.w3.org/2000/svg"||k.hasAttribute("itemprop"))&&(k=S.createElement(p),S.head.insertBefore(k,S.querySelector("head > title"))),gs(k,p,h),k[pe]=o,Jt(k),p=k;break e;case"link":var Y=eb("link","href",S).get(p+(h.href||""));if(Y){for(var de=0;de<Y.length;de++)if(k=Y[de],k.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&k.getAttribute("rel")===(h.rel==null?null:h.rel)&&k.getAttribute("title")===(h.title==null?null:h.title)&&k.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){Y.splice(de,1);break t}}k=S.createElement(p),gs(k,p,h),S.head.appendChild(k);break;case"meta":if(Y=eb("meta","content",S).get(p+(h.content||""))){for(de=0;de<Y.length;de++)if(k=Y[de],k.getAttribute("content")===(h.content==null?null:""+h.content)&&k.getAttribute("name")===(h.name==null?null:h.name)&&k.getAttribute("property")===(h.property==null?null:h.property)&&k.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&k.getAttribute("charset")===(h.charSet==null?null:h.charSet)){Y.splice(de,1);break t}}k=S.createElement(p),gs(k,p,h),S.head.appendChild(k);break;default:throw Error(a(468,p))}k[pe]=o,Jt(k),p=k}o.stateNode=p}else tb(S,o.type,o.stateNode);else o.stateNode=Q_(S,p,o.memoizedProps);else k!==p?(k===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):k.count--,p===null?tb(S,o.type,o.stateNode):Q_(S,p,o.memoizedProps)):p===null&&o.stateNode!==null&&ag(o,o.memoizedProps,h.memoizedProps)}break;case 27:li(u,o),ci(o),p&512&&(Ln||h===null||yl(h,h.return)),h!==null&&p&4&&ag(o,o.memoizedProps,h.memoizedProps);break;case 5:if(li(u,o),ci(o),p&512&&(Ln||h===null||yl(h,h.return)),o.flags&32){S=o.stateNode;try{yi(S,"")}catch(tr){pa(o,o.return,tr)}}p&4&&o.stateNode!=null&&(S=o.memoizedProps,ag(o,S,h!==null?h.memoizedProps:S)),p&1024&&(ig=!0);break;case 6:if(li(u,o),ci(o),p&4){if(o.stateNode===null)throw Error(a(162));p=o.memoizedProps,h=o.stateNode;try{h.nodeValue=p}catch(tr){pa(o,o.return,tr)}}break;case 3:if($m=null,S=qo,qo=zm(u.containerInfo),li(u,o),qo=S,ci(o),p&4&&h!==null&&h.memoizedState.isDehydrated)try{Tf(u.containerInfo)}catch(tr){pa(o,o.return,tr)}ig&&(ig=!1,t_(o));break;case 4:p=qo,qo=zm(o.stateNode.containerInfo),li(u,o),ci(o),qo=p;break;case 12:li(u,o),ci(o);break;case 31:li(u,o),ci(o),p&4&&(p=o.updateQueue,p!==null&&(o.updateQueue=null,Am(o,p)));break;case 13:li(u,o),ci(o),o.child.flags&8192&&o.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Tm=Ft()),p&4&&(p=o.updateQueue,p!==null&&(o.updateQueue=null,Am(o,p)));break;case 22:S=o.memoizedState!==null;var Oe=h!==null&&h.memoizedState!==null,tt=Jl,ht=Ln;if(Jl=tt||S,Ln=ht||Oe,li(u,o),Ln=ht,Jl=tt,ci(o),p&8192)e:for(u=o.stateNode,u._visibility=S?u._visibility&-2:u._visibility|1,S&&(h===null||Oe||Jl||Ln||Qu(o)),h=null,u=o;;){if(u.tag===5||u.tag===26){if(h===null){Oe=h=u;try{if(k=Oe.stateNode,S)Y=k.style,typeof Y.setProperty=="function"?Y.setProperty("display","none","important"):Y.display="none";else{de=Oe.stateNode;var xt=Oe.memoizedProps.style,at=xt!=null&&xt.hasOwnProperty("display")?xt.display:null;de.style.display=at==null||typeof at=="boolean"?"":(""+at).trim()}}catch(tr){pa(Oe,Oe.return,tr)}}}else if(u.tag===6){if(h===null){Oe=u;try{Oe.stateNode.nodeValue=S?"":Oe.memoizedProps}catch(tr){pa(Oe,Oe.return,tr)}}}else if(u.tag===18){if(h===null){Oe=u;try{var it=Oe.stateNode;S?$_(it,!0):$_(Oe.stateNode,!1)}catch(tr){pa(Oe,Oe.return,tr)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===o)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break e;for(;u.sibling===null;){if(u.return===null||u.return===o)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}p&4&&(p=o.updateQueue,p!==null&&(h=p.retryQueue,h!==null&&(p.retryQueue=null,Am(o,h))));break;case 19:li(u,o),ci(o),p&4&&(p=o.updateQueue,p!==null&&(o.updateQueue=null,Am(o,p)));break;case 30:break;case 21:break;default:li(u,o),ci(o)}}function ci(o){var u=o.flags;if(u&2){try{for(var h,p=o.return;p!==null;){if(Vy(p)){h=p;break}p=p.return}if(h==null)throw Error(a(160));switch(h.tag){case 27:var S=h.stateNode,k=ng(o);Em(o,k,S);break;case 5:var Y=h.stateNode;h.flags&32&&(yi(Y,""),h.flags&=-33);var de=ng(o);Em(o,de,Y);break;case 3:case 4:var Oe=h.stateNode.containerInfo,tt=ng(o);sg(o,tt,Oe);break;default:throw Error(a(161))}}catch(ht){pa(o,o.return,ht)}o.flags&=-3}u&4096&&(o.flags&=-4097)}function t_(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var u=o;t_(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),o=o.sibling}}function Ql(o,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Xy(o,u.alternate,u),u=u.sibling}function Qu(o){for(o=o.child;o!==null;){var u=o;switch(u.tag){case 0:case 11:case 14:case 15:Vc(4,u,u.return),Qu(u);break;case 1:yl(u,u.return);var h=u.stateNode;typeof h.componentWillUnmount=="function"&&$y(u,u.return,h),Qu(u);break;case 27:Jh(u.stateNode);case 26:case 5:yl(u,u.return),Qu(u);break;case 22:u.memoizedState===null&&Qu(u);break;case 30:Qu(u);break;default:Qu(u)}o=o.sibling}}function ec(o,u,h){for(h=h&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var p=u.alternate,S=o,k=u,Y=k.flags;switch(k.tag){case 0:case 11:case 15:ec(S,k,h),qh(4,k);break;case 1:if(ec(S,k,h),p=k,S=p.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(tt){pa(p,p.return,tt)}if(p=k,S=p.updateQueue,S!==null){var de=p.stateNode;try{var Oe=S.shared.hiddenCallbacks;if(Oe!==null)for(S.shared.hiddenCallbacks=null,S=0;S<Oe.length;S++)ts(Oe[S],de)}catch(tt){pa(p,p.return,tt)}}h&&Y&64&&Hy(k),zh(k,k.return);break;case 27:Gy(k);case 26:case 5:ec(S,k,h),h&&p===null&&Y&4&&Wy(k),zh(k,k.return);break;case 12:ec(S,k,h);break;case 31:ec(S,k,h),h&&Y&4&&Zy(S,k);break;case 13:ec(S,k,h),h&&Y&4&&Qy(S,k);break;case 22:k.memoizedState===null&&ec(S,k,h),zh(k,k.return);break;case 30:break;default:ec(S,k,h)}u=u.sibling}}function og(o,u){var h=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),o=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(o=u.memoizedState.cachePool.pool),o!==h&&(o!=null&&o.refCount++,h!=null&&Yu(h))}function lg(o,u){o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&Yu(o))}function zo(o,u,h,p){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)r_(o,u,h,p),u=u.sibling}function r_(o,u,h,p){var S=u.flags;switch(u.tag){case 0:case 11:case 15:zo(o,u,h,p),S&2048&&qh(9,u);break;case 1:zo(o,u,h,p);break;case 3:zo(o,u,h,p),S&2048&&(o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&Yu(o)));break;case 12:if(S&2048){zo(o,u,h,p),o=u.stateNode;try{var k=u.memoizedProps,Y=k.id,de=k.onPostCommit;typeof de=="function"&&de(Y,u.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(Oe){pa(u,u.return,Oe)}}else zo(o,u,h,p);break;case 31:zo(o,u,h,p);break;case 13:zo(o,u,h,p);break;case 23:break;case 22:k=u.stateNode,Y=u.alternate,u.memoizedState!==null?k._visibility&2?zo(o,u,h,p):Hh(o,u):k._visibility&2?zo(o,u,h,p):(k._visibility|=2,yf(o,u,h,p,(u.subtreeFlags&10256)!==0||!1)),S&2048&&og(Y,u);break;case 24:zo(o,u,h,p),S&2048&&lg(u.alternate,u);break;default:zo(o,u,h,p)}}function yf(o,u,h,p,S){for(S=S&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var k=o,Y=u,de=h,Oe=p,tt=Y.flags;switch(Y.tag){case 0:case 11:case 15:yf(k,Y,de,Oe,S),qh(8,Y);break;case 23:break;case 22:var ht=Y.stateNode;Y.memoizedState!==null?ht._visibility&2?yf(k,Y,de,Oe,S):Hh(k,Y):(ht._visibility|=2,yf(k,Y,de,Oe,S)),S&&tt&2048&&og(Y.alternate,Y);break;case 24:yf(k,Y,de,Oe,S),S&&tt&2048&&lg(Y.alternate,Y);break;default:yf(k,Y,de,Oe,S)}u=u.sibling}}function Hh(o,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var h=o,p=u,S=p.flags;switch(p.tag){case 22:Hh(h,p),S&2048&&og(p.alternate,p);break;case 24:Hh(h,p),S&2048&&lg(p.alternate,p);break;default:Hh(h,p)}u=u.sibling}}var $h=8192;function _f(o,u,h){if(o.subtreeFlags&$h)for(o=o.child;o!==null;)a_(o,u,h),o=o.sibling}function a_(o,u,h){switch(o.tag){case 26:_f(o,u,h),o.flags&$h&&o.memoizedState!==null&&SE(h,qo,o.memoizedState,o.memoizedProps);break;case 5:_f(o,u,h);break;case 3:case 4:var p=qo;qo=zm(o.stateNode.containerInfo),_f(o,u,h),qo=p;break;case 22:o.memoizedState===null&&(p=o.alternate,p!==null&&p.memoizedState!==null?(p=$h,$h=16777216,_f(o,u,h),$h=p):_f(o,u,h));break;default:_f(o,u,h)}}function n_(o){var u=o.alternate;if(u!==null&&(o=u.child,o!==null)){u.child=null;do u=o.sibling,o.sibling=null,o=u;while(o!==null)}}function Wh(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var p=u[h];as=p,i_(p,o)}n_(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)s_(o),o=o.sibling}function s_(o){switch(o.tag){case 0:case 11:case 15:Wh(o),o.flags&2048&&Vc(9,o,o.return);break;case 3:Wh(o);break;case 12:Wh(o);break;case 22:var u=o.stateNode;o.memoizedState!==null&&u._visibility&2&&(o.return===null||o.return.tag!==13)?(u._visibility&=-3,Cm(o)):Wh(o);break;default:Wh(o)}}function Cm(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var p=u[h];as=p,i_(p,o)}n_(o)}for(o=o.child;o!==null;){switch(u=o,u.tag){case 0:case 11:case 15:Vc(8,u,u.return),Cm(u);break;case 22:h=u.stateNode,h._visibility&2&&(h._visibility&=-3,Cm(u));break;default:Cm(u)}o=o.sibling}}function i_(o,u){for(;as!==null;){var h=as;switch(h.tag){case 0:case 11:case 15:Vc(8,h,u);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var p=h.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Yu(h.memoizedState.cache)}if(p=h.child,p!==null)p.return=h,as=p;else e:for(h=o;as!==null;){p=as;var S=p.sibling,k=p.return;if(Ky(p),p===h){as=null;break e}if(S!==null){S.return=k,as=S;break e}as=k}}}var Ik={getCacheForType:function(o){var u=Vn(Qa),h=u.data.get(o);return h===void 0&&(h=o(),u.data.set(o,h)),h},cacheSignal:function(){return Vn(Qa).controller.signal}},Bk=typeof WeakMap=="function"?WeakMap:Map,ua=0,Ta=null,zr=null,$r=0,ma=0,Ei=null,Gc=!1,bf=!1,cg=!1,tc=0,hn=0,Yc=0,ed=0,ug=0,Ai=0,wf=0,Vh=null,ui=null,dg=!1,Tm=0,o_=0,Om=1/0,Rm=null,Xc=null,Yn=0,Kc=null,Sf=null,rc=0,fg=0,hg=null,l_=null,Gh=0,mg=null;function Ci(){return(ua&2)!==0&&$r!==0?$r&-$r:X.T!==null?_g():ae()}function c_(){if(Ai===0)if(($r&536870912)===0||qr){var o=Ht;Ht<<=1,(Ht&3932160)===0&&(Ht=262144),Ai=o}else Ai=536870912;return o=Ia.current,o!==null&&(o.flags|=32),Ai}function di(o,u,h){(o===Ta&&(ma===2||ma===9)||o.cancelPendingCommit!==null)&&(Nf(o,0),Jc(o,$r,Ai,!1)),ir(o,h),((ua&2)===0||o!==Ta)&&(o===Ta&&((ua&2)===0&&(ed|=h),hn===4&&Jc(o,$r,Ai,!1)),_l(o))}function u_(o,u,h){if((ua&6)!==0)throw Error(a(327));var p=!h&&(u&127)===0&&(u&o.expiredLanes)===0||sr(o,u),S=p?zk(o,u):gg(o,u,!0),k=p;do{if(S===0){bf&&!p&&Jc(o,u,0,!1);break}else{if(h=o.current.alternate,k&&!Uk(h)){S=gg(o,u,!1),k=!1;continue}if(S===2){if(k=u,o.errorRecoveryDisabledLanes&k)var Y=0;else Y=o.pendingLanes&-536870913,Y=Y!==0?Y:Y&536870912?536870912:0;if(Y!==0){u=Y;e:{var de=o;S=Vh;var Oe=de.current.memoizedState.isDehydrated;if(Oe&&(Nf(de,Y).flags|=256),Y=gg(de,Y,!1),Y!==2){if(cg&&!Oe){de.errorRecoveryDisabledLanes|=k,ed|=k,S=4;break e}k=ui,ui=S,k!==null&&(ui===null?ui=k:ui.push.apply(ui,k))}S=Y}if(k=!1,S!==2)continue}}if(S===1){Nf(o,0),Jc(o,u,0,!0);break}e:{switch(p=o,k=S,k){case 0:case 1:throw Error(a(345));case 4:if((u&4194048)!==u)break;case 6:Jc(p,u,Ai,!Gc);break e;case 2:ui=null;break;case 3:case 5:break;default:throw Error(a(329))}if((u&62914560)===u&&(S=Tm+300-Ft(),10<S)){if(Jc(p,u,Ai,!Gc),kt(p,0,!0)!==0)break e;rc=u,p.timeoutHandle=q_(d_.bind(null,p,h,ui,Rm,dg,u,Ai,ed,wf,Gc,k,"Throttled",-0,0),S);break e}d_(p,h,ui,Rm,dg,u,Ai,ed,wf,Gc,k,null,-0,0)}}break}while(!0);_l(o)}function d_(o,u,h,p,S,k,Y,de,Oe,tt,ht,xt,at,it){if(o.timeoutHandle=-1,xt=u.subtreeFlags,xt&8192||(xt&16785408)===16785408){xt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_i},a_(u,k,xt);var tr=(k&62914560)===k?Tm-Ft():(k&4194048)===k?o_-Ft():0;if(tr=NE(xt,tr),tr!==null){rc=k,o.cancelPendingCommit=tr(y_.bind(null,o,u,k,h,p,S,Y,de,Oe,ht,xt,null,at,it)),Jc(o,k,Y,!tt);return}}y_(o,u,k,h,p,S,Y,de,Oe)}function Uk(o){for(var u=o;;){var h=u.tag;if((h===0||h===11||h===15)&&u.flags&16384&&(h=u.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var p=0;p<h.length;p++){var S=h[p],k=S.getSnapshot;S=S.value;try{if(!zn(k(),S))return!1}catch{return!1}}if(h=u.child,u.subtreeFlags&16384&&h!==null)h.return=u,u=h;else{if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Jc(o,u,h,p){u&=~ug,u&=~ed,o.suspendedLanes|=u,o.pingedLanes&=~u,p&&(o.warmLanes|=u),p=o.expirationTimes;for(var S=u;0<S;){var k=31-Ve(S),Y=1<<k;p[k]=-1,S&=~Y}h!==0&&xn(o,h,u)}function Dm(){return(ua&6)===0?(Yh(0),!1):!0}function pg(){if(zr!==null){if(ma===0)var o=zr.return;else o=zr,Qi=dl=null,ff(o),yt=null,ar=0,o=zr;for(;o!==null;)zy(o.alternate,o),o=o.return;zr=null}}function Nf(o,u){var h=o.timeoutHandle;h!==-1&&(o.timeoutHandle=-1,iE(h)),h=o.cancelPendingCommit,h!==null&&(o.cancelPendingCommit=null,h()),rc=0,pg(),Ta=o,zr=h=Qs(o.current,null),$r=u,ma=0,Ei=null,Gc=!1,bf=sr(o,u),cg=!1,wf=Ai=ug=ed=Yc=hn=0,ui=Vh=null,dg=!1,(u&8)!==0&&(u|=u&32);var p=o.entangledLanes;if(p!==0)for(o=o.entanglements,p&=u;0<p;){var S=31-Ve(p),k=1<<S;u|=o[S],p&=~k}return tc=u,zu(),h}function f_(o,u){fr=null,X.H=Ih,u===Le||u===ke?(u=pt(),ma=3):u===Ze?(u=pt(),ma=4):ma=u===G1?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Ei=u,zr===null&&(hn=1,wm(o,ei(u,o.current)))}function h_(){var o=Ia.current;return o===null?!0:($r&4194048)===$r?Jr===null:($r&62914560)===$r||($r&536870912)!==0?o===Jr:!1}function m_(){var o=X.H;return X.H=Ih,o===null?Ih:o}function p_(){var o=X.A;return X.A=Ik,o}function Fm(){hn=4,Gc||($r&4194048)!==$r&&Ia.current!==null||(bf=!0),(Yc&134217727)===0&&(ed&134217727)===0||Ta===null||Jc(Ta,$r,Ai,!1)}function gg(o,u,h){var p=ua;ua|=2;var S=m_(),k=p_();(Ta!==o||$r!==u)&&(Rm=null,Nf(o,u)),u=!1;var Y=hn;e:do try{if(ma!==0&&zr!==null){var de=zr,Oe=Ei;switch(ma){case 8:pg(),Y=6;break e;case 3:case 2:case 9:case 6:Ia.current===null&&(u=!0);var tt=ma;if(ma=0,Ei=null,jf(o,de,Oe,tt),h&&bf){Y=0;break e}break;default:tt=ma,ma=0,Ei=null,jf(o,de,Oe,tt)}}qk(),Y=hn;break}catch(ht){f_(o,ht)}while(!0);return u&&o.shellSuspendCounter++,Qi=dl=null,ua=p,X.H=S,X.A=k,zr===null&&(Ta=null,$r=0,zu()),Y}function qk(){for(;zr!==null;)g_(zr)}function zk(o,u){var h=ua;ua|=2;var p=m_(),S=p_();Ta!==o||$r!==u?(Rm=null,Om=Ft()+500,Nf(o,u)):bf=sr(o,u);e:do try{if(ma!==0&&zr!==null){u=zr;var k=Ei;t:switch(ma){case 1:ma=0,Ei=null,jf(o,u,k,1);break;case 2:case 9:if(We(k)){ma=0,Ei=null,v_(u);break}u=function(){ma!==2&&ma!==9||Ta!==o||(ma=7),_l(o)},k.then(u,u);break e;case 3:ma=7;break e;case 4:ma=5;break e;case 7:We(k)?(ma=0,Ei=null,v_(u)):(ma=0,Ei=null,jf(o,u,k,7));break;case 5:var Y=null;switch(zr.tag){case 26:Y=zr.memoizedState;case 5:case 27:var de=zr;if(Y?rb(Y):de.stateNode.complete){ma=0,Ei=null;var Oe=de.sibling;if(Oe!==null)zr=Oe;else{var tt=de.return;tt!==null?(zr=tt,Lm(tt)):zr=null}break t}}ma=0,Ei=null,jf(o,u,k,5);break;case 6:ma=0,Ei=null,jf(o,u,k,6);break;case 8:pg(),hn=6;break e;default:throw Error(a(462))}}Hk();break}catch(ht){f_(o,ht)}while(!0);return Qi=dl=null,X.H=p,X.A=S,ua=h,zr!==null?0:(Ta=null,$r=0,zu(),hn)}function Hk(){for(;zr!==null&&!ct();)g_(zr)}function g_(o){var u=Uy(o.alternate,o,tc);o.memoizedProps=o.pendingProps,u===null?Lm(o):zr=u}function v_(o){var u=o,h=u.alternate;switch(u.tag){case 15:case 0:u=Fy(h,u,u.pendingProps,u.type,void 0,$r);break;case 11:u=Fy(h,u,u.pendingProps,u.type.render,u.ref,$r);break;case 5:ff(u);default:zy(h,u),u=zr=Wu(u,tc),u=Uy(h,u,tc)}o.memoizedProps=o.pendingProps,u===null?Lm(o):zr=u}function jf(o,u,h,p){Qi=dl=null,ff(u),yt=null,ar=0;var S=u.return;try{if(Ok(o,S,u,h,$r)){hn=1,wm(o,ei(h,o.current)),zr=null;return}}catch(k){if(S!==null)throw zr=S,k;hn=1,wm(o,ei(h,o.current)),zr=null;return}u.flags&32768?(qr||p===1?o=!0:bf||($r&536870912)!==0?o=!1:(Gc=o=!0,(p===2||p===9||p===3||p===6)&&(p=Ia.current,p!==null&&p.tag===13&&(p.flags|=16384))),x_(u,o)):Lm(u)}function Lm(o){var u=o;do{if((u.flags&32768)!==0){x_(u,Gc);return}o=u.return;var h=Fk(u.alternate,u,tc);if(h!==null){zr=h;return}if(u=u.sibling,u!==null){zr=u;return}zr=u=o}while(u!==null);hn===0&&(hn=5)}function x_(o,u){do{var h=Lk(o.alternate,o);if(h!==null){h.flags&=32767,zr=h;return}if(h=o.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!u&&(o=o.sibling,o!==null)){zr=o;return}zr=o=h}while(o!==null);hn=6,zr=null}function y_(o,u,h,p,S,k,Y,de,Oe){o.cancelPendingCommit=null;do Pm();while(Yn!==0);if((ua&6)!==0)throw Error(a(327));if(u!==null){if(u===o.current)throw Error(a(177));if(k=u.lanes|u.childLanes,k|=Jd,Ea(o,h,k,Y,de,Oe),o===Ta&&(zr=Ta=null,$r=0),Sf=u,Kc=o,rc=h,fg=k,hg=S,l_=p,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,Gk($t,function(){return N_(),null})):(o.callbackNode=null,o.callbackPriority=0),p=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||p){p=X.T,X.T=null,S=J.p,J.p=2,Y=ua,ua|=4;try{Pk(o,u,h)}finally{ua=Y,J.p=S,X.T=p}}Yn=1,__(),b_(),w_()}}function __(){if(Yn===1){Yn=0;var o=Kc,u=Sf,h=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||h){h=X.T,X.T=null;var p=J.p;J.p=2;var S=ua;ua|=4;try{e_(u,o);var k=Ag,Y=Do(o.containerInfo),de=k.focusedElem,Oe=k.selectionRange;if(Y!==de&&de&&de.ownerDocument&&Ro(de.ownerDocument.documentElement,de)){if(Oe!==null&&Ji(de)){var tt=Oe.start,ht=Oe.end;if(ht===void 0&&(ht=tt),"selectionStart"in de)de.selectionStart=tt,de.selectionEnd=Math.min(ht,de.value.length);else{var xt=de.ownerDocument||document,at=xt&&xt.defaultView||window;if(at.getSelection){var it=at.getSelection(),tr=de.textContent.length,yr=Math.min(Oe.start,tr),ja=Oe.end===void 0?yr:Math.min(Oe.end,tr);!it.extend&&yr>ja&&(Y=ja,ja=yr,yr=Y);var He=Lc(de,yr),Pe=Lc(de,ja);if(He&&Pe&&(it.rangeCount!==1||it.anchorNode!==He.node||it.anchorOffset!==He.offset||it.focusNode!==Pe.node||it.focusOffset!==Pe.offset)){var et=xt.createRange();et.setStart(He.node,He.offset),it.removeAllRanges(),yr>ja?(it.addRange(et),it.extend(Pe.node,Pe.offset)):(et.setEnd(Pe.node,Pe.offset),it.addRange(et))}}}}for(xt=[],it=de;it=it.parentNode;)it.nodeType===1&&xt.push({element:it,left:it.scrollLeft,top:it.scrollTop});for(typeof de.focus=="function"&&de.focus(),de=0;de<xt.length;de++){var vt=xt[de];vt.element.scrollLeft=vt.left,vt.element.scrollTop=vt.top}}Ym=!!Eg,Ag=Eg=null}finally{ua=S,J.p=p,X.T=h}}o.current=u,Yn=2}}function b_(){if(Yn===2){Yn=0;var o=Kc,u=Sf,h=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||h){h=X.T,X.T=null;var p=J.p;J.p=2;var S=ua;ua|=4;try{Xy(o,u.alternate,u)}finally{ua=S,J.p=p,X.T=h}}Yn=3}}function w_(){if(Yn===4||Yn===3){Yn=0,St();var o=Kc,u=Sf,h=rc,p=l_;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?Yn=5:(Yn=0,Sf=Kc=null,S_(o,o.pendingLanes));var S=o.pendingLanes;if(S===0&&(Xc=null),Zt(h),u=u.stateNode,Ct&&typeof Ct.onCommitFiberRoot=="function")try{Ct.onCommitFiberRoot(At,u,void 0,(u.current.flags&128)===128)}catch{}if(p!==null){u=X.T,S=J.p,J.p=2,X.T=null;try{for(var k=o.onRecoverableError,Y=0;Y<p.length;Y++){var de=p[Y];k(de.value,{componentStack:de.stack})}}finally{X.T=u,J.p=S}}(rc&3)!==0&&Pm(),_l(o),S=o.pendingLanes,(h&261930)!==0&&(S&42)!==0?o===mg?Gh++:(Gh=0,mg=o):Gh=0,Yh(0)}}function S_(o,u){(o.pooledCacheLanes&=u)===0&&(u=o.pooledCache,u!=null&&(o.pooledCache=null,Yu(u)))}function Pm(){return __(),b_(),w_(),N_()}function N_(){if(Yn!==5)return!1;var o=Kc,u=fg;fg=0;var h=Zt(rc),p=X.T,S=J.p;try{J.p=32>h?32:h,X.T=null,h=hg,hg=null;var k=Kc,Y=rc;if(Yn=0,Sf=Kc=null,rc=0,(ua&6)!==0)throw Error(a(331));var de=ua;if(ua|=4,s_(k.current),r_(k,k.current,Y,h),ua=de,Yh(0,!1),Ct&&typeof Ct.onPostCommitFiberRoot=="function")try{Ct.onPostCommitFiberRoot(At,k)}catch{}return!0}finally{J.p=S,X.T=p,S_(o,u)}}function j_(o,u,h){u=ei(h,u),u=V1(o.stateNode,u,2),o=Or(o,u,2),o!==null&&(ir(o,2),_l(o))}function pa(o,u,h){if(o.tag===3)j_(o,o,h);else for(;u!==null;){if(u.tag===3){j_(u,o,h);break}else if(u.tag===1){var p=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Xc===null||!Xc.has(p))){o=ei(h,o),h=ky(2),p=Or(u,h,2),p!==null&&(Ey(h,p,u,o),ir(p,2),_l(p));break}}u=u.return}}function vg(o,u,h){var p=o.pingCache;if(p===null){p=o.pingCache=new Bk;var S=new Set;p.set(u,S)}else S=p.get(u),S===void 0&&(S=new Set,p.set(u,S));S.has(h)||(cg=!0,S.add(h),o=$k.bind(null,o,u,h),u.then(o,o))}function $k(o,u,h){var p=o.pingCache;p!==null&&p.delete(u),o.pingedLanes|=o.suspendedLanes&h,o.warmLanes&=~h,Ta===o&&($r&h)===h&&(hn===4||hn===3&&($r&62914560)===$r&&300>Ft()-Tm?(ua&2)===0&&Nf(o,0):ug|=h,wf===$r&&(wf=0)),_l(o)}function k_(o,u){u===0&&(u=Nt()),o=Lo(o,u),o!==null&&(ir(o,u),_l(o))}function Wk(o){var u=o.memoizedState,h=0;u!==null&&(h=u.retryLane),k_(o,h)}function Vk(o,u){var h=0;switch(o.tag){case 31:case 13:var p=o.stateNode,S=o.memoizedState;S!==null&&(h=S.retryLane);break;case 19:p=o.stateNode;break;case 22:p=o.stateNode._retryCache;break;default:throw Error(a(314))}p!==null&&p.delete(u),k_(o,h)}function Gk(o,u){return jt(o,u)}var Mm=null,kf=null,xg=!1,Im=!1,yg=!1,Zc=0;function _l(o){o!==kf&&o.next===null&&(kf===null?Mm=kf=o:kf=kf.next=o),Im=!0,xg||(xg=!0,Xk())}function Yh(o,u){if(!yg&&Im){yg=!0;do for(var h=!1,p=Mm;p!==null;){if(o!==0){var S=p.pendingLanes;if(S===0)var k=0;else{var Y=p.suspendedLanes,de=p.pingedLanes;k=(1<<31-Ve(42|o)+1)-1,k&=S&~(Y&~de),k=k&201326741?k&201326741|1:k?k|2:0}k!==0&&(h=!0,T_(p,k))}else k=$r,k=kt(p,p===Ta?k:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(k&3)===0||sr(p,k)||(h=!0,T_(p,k));p=p.next}while(h);yg=!1}}function Yk(){E_()}function E_(){Im=xg=!1;var o=0;Zc!==0&&sE()&&(o=Zc);for(var u=Ft(),h=null,p=Mm;p!==null;){var S=p.next,k=A_(p,u);k===0?(p.next=null,h===null?Mm=S:h.next=S,S===null&&(kf=h)):(h=p,(o!==0||(k&3)!==0)&&(Im=!0)),p=S}Yn!==0&&Yn!==5||Yh(o),Zc!==0&&(Zc=0)}function A_(o,u){for(var h=o.suspendedLanes,p=o.pingedLanes,S=o.expirationTimes,k=o.pendingLanes&-62914561;0<k;){var Y=31-Ve(k),de=1<<Y,Oe=S[Y];Oe===-1?((de&h)===0||(de&p)!==0)&&(S[Y]=Pr(de,u)):Oe<=u&&(o.expiredLanes|=de),k&=~de}if(u=Ta,h=$r,h=kt(o,o===u?h:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),p=o.callbackNode,h===0||o===u&&(ma===2||ma===9)||o.cancelPendingCommit!==null)return p!==null&&p!==null&&Je(p),o.callbackNode=null,o.callbackPriority=0;if((h&3)===0||sr(o,h)){if(u=h&-h,u===o.callbackPriority)return u;switch(p!==null&&Je(p),Zt(h)){case 2:case 8:h=Wt;break;case 32:h=$t;break;case 268435456:h=Ce;break;default:h=$t}return p=C_.bind(null,o),h=jt(h,p),o.callbackPriority=u,o.callbackNode=h,u}return p!==null&&p!==null&&Je(p),o.callbackPriority=2,o.callbackNode=null,2}function C_(o,u){if(Yn!==0&&Yn!==5)return o.callbackNode=null,o.callbackPriority=0,null;var h=o.callbackNode;if(Pm()&&o.callbackNode!==h)return null;var p=$r;return p=kt(o,o===Ta?p:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),p===0?null:(u_(o,p,u),A_(o,Ft()),o.callbackNode!=null&&o.callbackNode===h?C_.bind(null,o):null)}function T_(o,u){if(Pm())return null;u_(o,u,!0)}function Xk(){oE(function(){(ua&6)!==0?jt(Ut,Yk):E_()})}function _g(){if(Zc===0){var o=y;o===0&&(o=gt,gt<<=1,(gt&261888)===0&&(gt=256)),Zc=o}return Zc}function O_(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:ws(""+o)}function R_(o,u){var h=u.ownerDocument.createElement("input");return h.name=u.name,h.value=u.value,o.id&&h.setAttribute("form",o.id),u.parentNode.insertBefore(h,u),o=new FormData(o),h.parentNode.removeChild(h),o}function Kk(o,u,h,p,S){if(u==="submit"&&h&&h.stateNode===S){var k=O_((S[Se]||null).action),Y=p.submitter;Y&&(u=(u=Y[Se]||null)?O_(u.formAction):Y.getAttribute("formAction"),u!==null&&(k=u,Y=null));var de=new Ks("action","action",null,p,S);o.push({event:de,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Zc!==0){var Oe=Y?R_(S,Y):new FormData(S);U1(h,{pending:!0,data:Oe,method:S.method,action:k},null,Oe)}}else typeof k=="function"&&(de.preventDefault(),Oe=Y?R_(S,Y):new FormData(S),U1(h,{pending:!0,data:Oe,method:S.method,action:k},k,Oe))},currentTarget:S}]})}}for(var bg=0;bg<ql.length;bg++){var wg=ql[bg],Jk=wg.toLowerCase(),Zk=wg[0].toUpperCase()+wg.slice(1);Zs(Jk,"on"+Zk)}Zs(Ul,"onAnimationEnd"),Zs(Uu,"onAnimationIteration"),Zs(Sh,"onAnimationStart"),Zs("dblclick","onDoubleClick"),Zs("focusin","onFocus"),Zs("focusout","onBlur"),Zs(cm,"onTransitionRun"),Zs(um,"onTransitionStart"),Zs(dm,"onTransitionCancel"),Zs(Nh,"onTransitionEnd"),ls("onMouseEnter",["mouseout","mouseover"]),ls("onMouseLeave",["mouseout","mouseover"]),ls("onPointerEnter",["pointerout","pointerover"]),ls("onPointerLeave",["pointerout","pointerover"]),da("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),da("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),da("onBeforeInput",["compositionend","keypress","textInput","paste"]),da("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),da("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),da("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qk=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xh));function D_(o,u){u=(u&4)!==0;for(var h=0;h<o.length;h++){var p=o[h],S=p.event;p=p.listeners;e:{var k=void 0;if(u)for(var Y=p.length-1;0<=Y;Y--){var de=p[Y],Oe=de.instance,tt=de.currentTarget;if(de=de.listener,Oe!==k&&S.isPropagationStopped())break e;k=de,S.currentTarget=tt;try{k(S)}catch(ht){qu(ht)}S.currentTarget=null,k=Oe}else for(Y=0;Y<p.length;Y++){if(de=p[Y],Oe=de.instance,tt=de.currentTarget,de=de.listener,Oe!==k&&S.isPropagationStopped())break e;k=de,S.currentTarget=tt;try{k(S)}catch(ht){qu(ht)}S.currentTarget=null,k=Oe}}}}function Hr(o,u){var h=u[$e];h===void 0&&(h=u[$e]=new Set);var p=o+"__bubble";h.has(p)||(F_(u,o,2,!1),h.add(p))}function Sg(o,u,h){var p=0;u&&(p|=4),F_(h,o,p,u)}var Bm="_reactListening"+Math.random().toString(36).slice(2);function Ng(o){if(!o[Bm]){o[Bm]=!0,oa.forEach(function(h){h!=="selectionchange"&&(Qk.has(h)||Sg(h,!1,o),Sg(h,!0,o))});var u=o.nodeType===9?o:o.ownerDocument;u===null||u[Bm]||(u[Bm]=!0,Sg("selectionchange",!1,u))}}function F_(o,u,h,p){switch(cb(u)){case 2:var S=EE;break;case 8:S=AE;break;default:S=Bg}h=S.bind(null,u,h,o),S=void 0,!Lu||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(S=!0),p?S!==void 0?o.addEventListener(u,h,{capture:!0,passive:S}):o.addEventListener(u,h,!0):S!==void 0?o.addEventListener(u,h,{passive:S}):o.addEventListener(u,h,!1)}function jg(o,u,h,p,S){var k=p;if((u&1)===0&&(u&2)===0&&p!==null)e:for(;;){if(p===null)return;var Y=p.tag;if(Y===3||Y===4){var de=p.stateNode.containerInfo;if(de===S)break;if(Y===4)for(Y=p.return;Y!==null;){var Oe=Y.tag;if((Oe===3||Oe===4)&&Y.stateNode.containerInfo===S)return;Y=Y.return}for(;de!==null;){if(Y=Rt(de),Y===null)return;if(Oe=Y.tag,Oe===5||Oe===6||Oe===26||Oe===27){p=k=Y;continue e}de=de.parentNode}}p=p.return}Vd(function(){var tt=k,ht=Dl(h),xt=[];e:{var at=jh.get(o);if(at!==void 0){var it=Ks,tr=o;switch(o){case"keypress":if(Xs(h)===0)break e;case"keydown":case"keyup":it=Vr;break;case"focusin":tr="focus",it=No;break;case"focusout":tr="blur",it=No;break;case"beforeblur":case"afterblur":it=No;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":it=Pu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":it=So;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":it=_n;break;case Ul:case Uu:case Sh:it=R;break;case Nh:it=qn;break;case"scroll":case"scrollend":it=Ac;break;case"wheel":it=bi;break;case"copy":case"cut":case"paste":it=Ae;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":it=Ka;break;case"toggle":case"beforetoggle":it=Mu}var yr=(u&4)!==0,ja=!yr&&(o==="scroll"||o==="scrollend"),He=yr?at!==null?at+"Capture":null:at;yr=[];for(var Pe=tt,et;Pe!==null;){var vt=Pe;if(et=vt.stateNode,vt=vt.tag,vt!==5&&vt!==26&&vt!==27||et===null||He===null||(vt=Us(Pe,He),vt!=null&&yr.push(Kh(Pe,vt,et))),ja)break;Pe=Pe.return}0<yr.length&&(at=new it(at,tr,null,h,ht),xt.push({event:at,listeners:yr}))}}if((u&7)===0){e:{if(at=o==="mouseover"||o==="pointerover",it=o==="mouseout"||o==="pointerout",at&&h!==xo&&(tr=h.relatedTarget||h.fromElement)&&(Rt(tr)||tr[we]))break e;if((it||at)&&(at=ht.window===ht?ht:(at=ht.ownerDocument)?at.defaultView||at.parentWindow:window,it?(tr=h.relatedTarget||h.toElement,it=tt,tr=tr?Rt(tr):null,tr!==null&&(ja=s(tr),yr=tr.tag,tr!==ja||yr!==5&&yr!==27&&yr!==6)&&(tr=null)):(it=null,tr=tt),it!==tr)){if(yr=Pu,vt="onMouseLeave",He="onMouseEnter",Pe="mouse",(o==="pointerout"||o==="pointerover")&&(yr=Ka,vt="onPointerLeave",He="onPointerEnter",Pe="pointer"),ja=it==null?at:Ot(it),et=tr==null?at:Ot(tr),at=new yr(vt,Pe+"leave",it,h,ht),at.target=ja,at.relatedTarget=et,vt=null,Rt(ht)===tt&&(yr=new yr(He,Pe+"enter",tr,h,ht),yr.target=et,yr.relatedTarget=ja,vt=yr),ja=vt,it&&tr)t:{for(yr=eE,He=it,Pe=tr,et=0,vt=He;vt;vt=yr(vt))et++;vt=0;for(var mr=Pe;mr;mr=yr(mr))vt++;for(;0<et-vt;)He=yr(He),et--;for(;0<vt-et;)Pe=yr(Pe),vt--;for(;et--;){if(He===Pe||Pe!==null&&He===Pe.alternate){yr=He;break t}He=yr(He),Pe=yr(Pe)}yr=null}else yr=null;it!==null&&L_(xt,at,it,yr,!1),tr!==null&&ja!==null&&L_(xt,ja,tr,yr,!0)}}e:{if(at=tt?Ot(tt):window,it=at.nodeName&&at.nodeName.toLowerCase(),it==="select"||it==="input"&&at.type==="file")var na=ol;else if(Iu(at))if(Ss)na=Xi;else{na=Ja;var lr=Dc}else it=at.nodeName,!it||it.toLowerCase()!=="input"||at.type!=="checkbox"&&at.type!=="radio"?tt&&Ru(tt.elementType)&&(na=ol):na=Kd;if(na&&(na=na(o,tt))){zs(xt,na,h,ht);break e}lr&&lr(o,at,tt),o==="focusout"&&tt&&at.type==="number"&&tt.memoizedProps.value!=null&&Cu(at,"number",at.value)}switch(lr=tt?Ot(tt):window,o){case"focusin":(Iu(lr)||lr.contentEditable==="true")&&(Hs=lr,Fo=tt,Zn=null);break;case"focusout":Zn=Fo=Hs=null;break;case"mousedown":Js=!0;break;case"contextmenu":case"mouseup":case"dragend":Js=!1,ea(xt,h,ht);break;case"selectionchange":if(Bl)break;case"keydown":case"keyup":ea(xt,h,ht)}var Dr;if(Wi)e:{switch(o){case"compositionstart":var Wr="onCompositionStart";break e;case"compositionend":Wr="onCompositionEnd";break e;case"compositionupdate":Wr="onCompositionUpdate";break e}Wr=void 0}else Vi?il(o,h)&&(Wr="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(Wr="onCompositionStart");Wr&&(Eo&&h.locale!=="ko"&&(Vi||Wr!=="onCompositionStart"?Wr==="onCompositionEnd"&&Vi&&(Dr=Gd()):(qs=ht,Ll="value"in qs?qs.value:qs.textContent,Vi=!0)),lr=Um(tt,Wr),0<lr.length&&(Wr=new ze(Wr,o,null,h,ht),xt.push({event:Wr,listeners:lr}),Dr?Wr.data=Dr:(Dr=Tc(h),Dr!==null&&(Wr.data=Dr)))),(Dr=Il?ds(o,h):Ao(o,h))&&(Wr=Um(tt,"onBeforeInput"),0<Wr.length&&(lr=new ze("onBeforeInput","beforeinput",null,h,ht),xt.push({event:lr,listeners:Wr}),lr.data=Dr)),Kk(xt,o,tt,h,ht)}D_(xt,u)})}function Kh(o,u,h){return{instance:o,listener:u,currentTarget:h}}function Um(o,u){for(var h=u+"Capture",p=[];o!==null;){var S=o,k=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||k===null||(S=Us(o,h),S!=null&&p.unshift(Kh(o,S,k)),S=Us(o,u),S!=null&&p.push(Kh(o,S,k))),o.tag===3)return p;o=o.return}return[]}function eE(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function L_(o,u,h,p,S){for(var k=u._reactName,Y=[];h!==null&&h!==p;){var de=h,Oe=de.alternate,tt=de.stateNode;if(de=de.tag,Oe!==null&&Oe===p)break;de!==5&&de!==26&&de!==27||tt===null||(Oe=tt,S?(tt=Us(h,k),tt!=null&&Y.unshift(Kh(h,tt,Oe))):S||(tt=Us(h,k),tt!=null&&Y.push(Kh(h,tt,Oe)))),h=h.return}Y.length!==0&&o.push({event:u,listeners:Y})}var tE=/\r\n?/g,rE=/\u0000|\uFFFD/g;function P_(o){return(typeof o=="string"?o:""+o).replace(tE,`
`).replace(rE,"")}function M_(o,u){return u=P_(u),P_(o)===u}function Na(o,u,h,p,S,k){switch(h){case"children":typeof p=="string"?u==="body"||u==="textarea"&&p===""||yi(o,p):(typeof p=="number"||typeof p=="bigint")&&u!=="body"&&yi(o,""+p);break;case"className":vo(o,"class",p);break;case"tabIndex":vo(o,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":vo(o,h,p);break;case"style":Hd(o,p,k);break;case"data":if(u!=="object"){vo(o,"data",p);break}case"src":case"href":if(p===""&&(u!=="a"||h!=="href")){o.removeAttribute(h);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){o.removeAttribute(h);break}p=ws(""+p),o.setAttribute(h,p);break;case"action":case"formAction":if(typeof p=="function"){o.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(h==="formAction"?(u!=="input"&&Na(o,u,"name",S.name,S,null),Na(o,u,"formEncType",S.formEncType,S,null),Na(o,u,"formMethod",S.formMethod,S,null),Na(o,u,"formTarget",S.formTarget,S,null)):(Na(o,u,"encType",S.encType,S,null),Na(o,u,"method",S.method,S,null),Na(o,u,"target",S.target,S,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){o.removeAttribute(h);break}p=ws(""+p),o.setAttribute(h,p);break;case"onClick":p!=null&&(o.onclick=_i);break;case"onScroll":p!=null&&Hr("scroll",o);break;case"onScrollEnd":p!=null&&Hr("scrollend",o);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(h=p.__html,h!=null){if(S.children!=null)throw Error(a(60));o.innerHTML=h}}break;case"multiple":o.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":o.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){o.removeAttribute("xlink:href");break}h=ws(""+p),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,""+p):o.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,""):o.removeAttribute(h);break;case"capture":case"download":p===!0?o.setAttribute(h,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?o.setAttribute(h,p):o.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?o.setAttribute(h,p):o.removeAttribute(h);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?o.removeAttribute(h):o.setAttribute(h,p);break;case"popover":Hr("beforetoggle",o),Hr("toggle",o),Fa(o,"popover",p);break;case"xlinkActuate":xi(o,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":xi(o,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":xi(o,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":xi(o,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":xi(o,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":xi(o,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":xi(o,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":xi(o,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":xi(o,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Fa(o,"is",p);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Du.get(h)||h,Fa(o,h,p))}}function kg(o,u,h,p,S,k){switch(h){case"style":Hd(o,p,k);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(h=p.__html,h!=null){if(S.children!=null)throw Error(a(60));o.innerHTML=h}}break;case"children":typeof p=="string"?yi(o,p):(typeof p=="number"||typeof p=="bigint")&&yi(o,""+p);break;case"onScroll":p!=null&&Hr("scroll",o);break;case"onScrollEnd":p!=null&&Hr("scrollend",o);break;case"onClick":p!=null&&(o.onclick=_i);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Mr.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(S=h.endsWith("Capture"),u=h.slice(2,S?h.length-7:void 0),k=o[Se]||null,k=k!=null?k[h]:null,typeof k=="function"&&o.removeEventListener(u,k,S),typeof p=="function")){typeof k!="function"&&k!==null&&(h in o?o[h]=null:o.hasAttribute(h)&&o.removeAttribute(h)),o.addEventListener(u,p,S);break e}h in o?o[h]=p:p===!0?o.setAttribute(h,""):Fa(o,h,p)}}}function gs(o,u,h){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Hr("error",o),Hr("load",o);var p=!1,S=!1,k;for(k in h)if(h.hasOwnProperty(k)){var Y=h[k];if(Y!=null)switch(k){case"src":p=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,u));default:Na(o,u,k,Y,h,null)}}S&&Na(o,u,"srcSet",h.srcSet,h,null),p&&Na(o,u,"src",h.src,h,null);return;case"input":Hr("invalid",o);var de=k=Y=S=null,Oe=null,tt=null;for(p in h)if(h.hasOwnProperty(p)){var ht=h[p];if(ht!=null)switch(p){case"name":S=ht;break;case"type":Y=ht;break;case"checked":Oe=ht;break;case"defaultChecked":tt=ht;break;case"value":k=ht;break;case"defaultValue":de=ht;break;case"children":case"dangerouslySetInnerHTML":if(ht!=null)throw Error(a(137,u));break;default:Na(o,u,p,ht,h,null)}}qd(o,k,de,Oe,tt,Y,S,!1);return;case"select":Hr("invalid",o),p=Y=k=null;for(S in h)if(h.hasOwnProperty(S)&&(de=h[S],de!=null))switch(S){case"value":k=de;break;case"defaultValue":Y=de;break;case"multiple":p=de;default:Na(o,u,S,de,h,null)}u=k,h=Y,o.multiple=!!p,u!=null?us(o,!!p,u,!1):h!=null&&us(o,!!p,h,!0);return;case"textarea":Hr("invalid",o),k=S=p=null;for(Y in h)if(h.hasOwnProperty(Y)&&(de=h[Y],de!=null))switch(Y){case"value":p=de;break;case"defaultValue":S=de;break;case"children":k=de;break;case"dangerouslySetInnerHTML":if(de!=null)throw Error(a(91));break;default:Na(o,u,Y,de,h,null)}Ou(o,p,S,k);return;case"option":for(Oe in h)if(h.hasOwnProperty(Oe)&&(p=h[Oe],p!=null))switch(Oe){case"selected":o.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Na(o,u,Oe,p,h,null)}return;case"dialog":Hr("beforetoggle",o),Hr("toggle",o),Hr("cancel",o),Hr("close",o);break;case"iframe":case"object":Hr("load",o);break;case"video":case"audio":for(p=0;p<Xh.length;p++)Hr(Xh[p],o);break;case"image":Hr("error",o),Hr("load",o);break;case"details":Hr("toggle",o);break;case"embed":case"source":case"link":Hr("error",o),Hr("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(tt in h)if(h.hasOwnProperty(tt)&&(p=h[tt],p!=null))switch(tt){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,u));default:Na(o,u,tt,p,h,null)}return;default:if(Ru(u)){for(ht in h)h.hasOwnProperty(ht)&&(p=h[ht],p!==void 0&&kg(o,u,ht,p,h,void 0));return}}for(de in h)h.hasOwnProperty(de)&&(p=h[de],p!=null&&Na(o,u,de,p,h,null))}function aE(o,u,h,p){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,k=null,Y=null,de=null,Oe=null,tt=null,ht=null;for(it in h){var xt=h[it];if(h.hasOwnProperty(it)&&xt!=null)switch(it){case"checked":break;case"value":break;case"defaultValue":Oe=xt;default:p.hasOwnProperty(it)||Na(o,u,it,null,p,xt)}}for(var at in p){var it=p[at];if(xt=h[at],p.hasOwnProperty(at)&&(it!=null||xt!=null))switch(at){case"type":k=it;break;case"name":S=it;break;case"checked":tt=it;break;case"defaultChecked":ht=it;break;case"value":Y=it;break;case"defaultValue":de=it;break;case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(a(137,u));break;default:it!==xt&&Na(o,u,at,it,p,xt)}}jc(o,Y,de,Oe,tt,ht,k,S);return;case"select":it=Y=de=at=null;for(k in h)if(Oe=h[k],h.hasOwnProperty(k)&&Oe!=null)switch(k){case"value":break;case"multiple":it=Oe;default:p.hasOwnProperty(k)||Na(o,u,k,null,p,Oe)}for(S in p)if(k=p[S],Oe=h[S],p.hasOwnProperty(S)&&(k!=null||Oe!=null))switch(S){case"value":at=k;break;case"defaultValue":de=k;break;case"multiple":Y=k;default:k!==Oe&&Na(o,u,S,k,p,Oe)}u=de,h=Y,p=it,at!=null?us(o,!!h,at,!1):!!p!=!!h&&(u!=null?us(o,!!h,u,!0):us(o,!!h,h?[]:"",!1));return;case"textarea":it=at=null;for(de in h)if(S=h[de],h.hasOwnProperty(de)&&S!=null&&!p.hasOwnProperty(de))switch(de){case"value":break;case"children":break;default:Na(o,u,de,null,p,S)}for(Y in p)if(S=p[Y],k=h[Y],p.hasOwnProperty(Y)&&(S!=null||k!=null))switch(Y){case"value":at=S;break;case"defaultValue":it=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(a(91));break;default:S!==k&&Na(o,u,Y,S,p,k)}Tu(o,at,it);return;case"option":for(var tr in h)if(at=h[tr],h.hasOwnProperty(tr)&&at!=null&&!p.hasOwnProperty(tr))switch(tr){case"selected":o.selected=!1;break;default:Na(o,u,tr,null,p,at)}for(Oe in p)if(at=p[Oe],it=h[Oe],p.hasOwnProperty(Oe)&&at!==it&&(at!=null||it!=null))switch(Oe){case"selected":o.selected=at&&typeof at!="function"&&typeof at!="symbol";break;default:Na(o,u,Oe,at,p,it)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var yr in h)at=h[yr],h.hasOwnProperty(yr)&&at!=null&&!p.hasOwnProperty(yr)&&Na(o,u,yr,null,p,at);for(tt in p)if(at=p[tt],it=h[tt],p.hasOwnProperty(tt)&&at!==it&&(at!=null||it!=null))switch(tt){case"children":case"dangerouslySetInnerHTML":if(at!=null)throw Error(a(137,u));break;default:Na(o,u,tt,at,p,it)}return;default:if(Ru(u)){for(var ja in h)at=h[ja],h.hasOwnProperty(ja)&&at!==void 0&&!p.hasOwnProperty(ja)&&kg(o,u,ja,void 0,p,at);for(ht in p)at=p[ht],it=h[ht],!p.hasOwnProperty(ht)||at===it||at===void 0&&it===void 0||kg(o,u,ht,at,p,it);return}}for(var He in h)at=h[He],h.hasOwnProperty(He)&&at!=null&&!p.hasOwnProperty(He)&&Na(o,u,He,null,p,at);for(xt in p)at=p[xt],it=h[xt],!p.hasOwnProperty(xt)||at===it||at==null&&it==null||Na(o,u,xt,at,p,it)}function I_(o){switch(o){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function nE(){if(typeof performance.getEntriesByType=="function"){for(var o=0,u=0,h=performance.getEntriesByType("resource"),p=0;p<h.length;p++){var S=h[p],k=S.transferSize,Y=S.initiatorType,de=S.duration;if(k&&de&&I_(Y)){for(Y=0,de=S.responseEnd,p+=1;p<h.length;p++){var Oe=h[p],tt=Oe.startTime;if(tt>de)break;var ht=Oe.transferSize,xt=Oe.initiatorType;ht&&I_(xt)&&(Oe=Oe.responseEnd,Y+=ht*(Oe<de?1:(de-tt)/(Oe-tt)))}if(--p,u+=8*(k+Y)/(S.duration/1e3),o++,10<o)break}}if(0<o)return u/o/1e6}return navigator.connection&&(o=navigator.connection.downlink,typeof o=="number")?o:5}var Eg=null,Ag=null;function qm(o){return o.nodeType===9?o:o.ownerDocument}function B_(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function U_(o,u){if(o===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&u==="foreignObject"?0:o}function Cg(o,u){return o==="textarea"||o==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var Tg=null;function sE(){var o=window.event;return o&&o.type==="popstate"?o===Tg?!1:(Tg=o,!0):(Tg=null,!1)}var q_=typeof setTimeout=="function"?setTimeout:void 0,iE=typeof clearTimeout=="function"?clearTimeout:void 0,z_=typeof Promise=="function"?Promise:void 0,oE=typeof queueMicrotask=="function"?queueMicrotask:typeof z_<"u"?function(o){return z_.resolve(null).then(o).catch(lE)}:q_;function lE(o){setTimeout(function(){throw o})}function Qc(o){return o==="head"}function H_(o,u){var h=u,p=0;do{var S=h.nextSibling;if(o.removeChild(h),S&&S.nodeType===8)if(h=S.data,h==="/$"||h==="/&"){if(p===0){o.removeChild(S),Tf(u);return}p--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")p++;else if(h==="html")Jh(o.ownerDocument.documentElement);else if(h==="head"){h=o.ownerDocument.head,Jh(h);for(var k=h.firstChild;k;){var Y=k.nextSibling,de=k.nodeName;k[Qe]||de==="SCRIPT"||de==="STYLE"||de==="LINK"&&k.rel.toLowerCase()==="stylesheet"||h.removeChild(k),k=Y}}else h==="body"&&Jh(o.ownerDocument.body);h=S}while(h);Tf(u)}function $_(o,u){var h=o;o=0;do{var p=h.nextSibling;if(h.nodeType===1?u?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(u?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),p&&p.nodeType===8)if(h=p.data,h==="/$"){if(o===0)break;o--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||o++;h=p}while(h)}function Og(o){var u=o.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var h=u;switch(u=u.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":Og(h),Et(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}o.removeChild(h)}}function cE(o,u,h,p){for(;o.nodeType===1;){var S=h;if(o.nodeName.toLowerCase()!==u.toLowerCase()){if(!p&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(p){if(!o[Qe])switch(u){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(k=o.getAttribute("rel"),k==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(k!==S.rel||o.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||o.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||o.getAttribute("title")!==(S.title==null?null:S.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(k=o.getAttribute("src"),(k!==(S.src==null?null:S.src)||o.getAttribute("type")!==(S.type==null?null:S.type)||o.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&k&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(u==="input"&&o.type==="hidden"){var k=S.name==null?null:""+S.name;if(S.type==="hidden"&&o.getAttribute("name")===k)return o}else return o;if(o=ro(o.nextSibling),o===null)break}return null}function uE(o,u,h){if(u==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!h||(o=ro(o.nextSibling),o===null))return null;return o}function W_(o,u){for(;o.nodeType!==8;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!u||(o=ro(o.nextSibling),o===null))return null;return o}function Rg(o){return o.data==="$?"||o.data==="$~"}function Dg(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState!=="loading"}function dE(o,u){var h=o.ownerDocument;if(o.data==="$~")o._reactRetry=u;else if(o.data!=="$?"||h.readyState!=="loading")u();else{var p=function(){u(),h.removeEventListener("DOMContentLoaded",p)};h.addEventListener("DOMContentLoaded",p),o._reactRetry=p}}function ro(o){for(;o!=null;o=o.nextSibling){var u=o.nodeType;if(u===1||u===3)break;if(u===8){if(u=o.data,u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"||u==="F!"||u==="F")break;if(u==="/$"||u==="/&")return null}}return o}var Fg=null;function V_(o){o=o.nextSibling;for(var u=0;o;){if(o.nodeType===8){var h=o.data;if(h==="/$"||h==="/&"){if(u===0)return ro(o.nextSibling);u--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||u++}o=o.nextSibling}return null}function G_(o){o=o.previousSibling;for(var u=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(u===0)return o;u--}else h!=="/$"&&h!=="/&"||u++}o=o.previousSibling}return null}function Y_(o,u,h){switch(u=qm(h),o){case"html":if(o=u.documentElement,!o)throw Error(a(452));return o;case"head":if(o=u.head,!o)throw Error(a(453));return o;case"body":if(o=u.body,!o)throw Error(a(454));return o;default:throw Error(a(451))}}function Jh(o){for(var u=o.attributes;u.length;)o.removeAttributeNode(u[0]);Et(o)}var ao=new Map,X_=new Set;function zm(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var ac=J.d;J.d={f:fE,r:hE,D:mE,C:pE,L:gE,m:vE,X:yE,S:xE,M:_E};function fE(){var o=ac.f(),u=Dm();return o||u}function hE(o){var u=qt(o);u!==null&&u.tag===5&&u.type==="form"?fy(u):ac.r(o)}var Ef=typeof document>"u"?null:document;function K_(o,u,h){var p=Ef;if(p&&typeof u=="string"&&u){var S=sn(u);S='link[rel="'+o+'"][href="'+S+'"]',typeof h=="string"&&(S+='[crossorigin="'+h+'"]'),X_.has(S)||(X_.add(S),o={rel:o,crossOrigin:h,href:u},p.querySelector(S)===null&&(u=p.createElement("link"),gs(u,"link",o),Jt(u),p.head.appendChild(u)))}}function mE(o){ac.D(o),K_("dns-prefetch",o,null)}function pE(o,u){ac.C(o,u),K_("preconnect",o,u)}function gE(o,u,h){ac.L(o,u,h);var p=Ef;if(p&&o&&u){var S='link[rel="preload"][as="'+sn(u)+'"]';u==="image"&&h&&h.imageSrcSet?(S+='[imagesrcset="'+sn(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(S+='[imagesizes="'+sn(h.imageSizes)+'"]')):S+='[href="'+sn(o)+'"]';var k=S;switch(u){case"style":k=Af(o);break;case"script":k=Cf(o)}ao.has(k)||(o=v({rel:"preload",href:u==="image"&&h&&h.imageSrcSet?void 0:o,as:u},h),ao.set(k,o),p.querySelector(S)!==null||u==="style"&&p.querySelector(Zh(k))||u==="script"&&p.querySelector(Qh(k))||(u=p.createElement("link"),gs(u,"link",o),Jt(u),p.head.appendChild(u)))}}function vE(o,u){ac.m(o,u);var h=Ef;if(h&&o){var p=u&&typeof u.as=="string"?u.as:"script",S='link[rel="modulepreload"][as="'+sn(p)+'"][href="'+sn(o)+'"]',k=S;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=Cf(o)}if(!ao.has(k)&&(o=v({rel:"modulepreload",href:o},u),ao.set(k,o),h.querySelector(S)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Qh(k)))return}p=h.createElement("link"),gs(p,"link",o),Jt(p),h.head.appendChild(p)}}}function xE(o,u,h){ac.S(o,u,h);var p=Ef;if(p&&o){var S=Mt(p).hoistableStyles,k=Af(o);u=u||"default";var Y=S.get(k);if(!Y){var de={loading:0,preload:null};if(Y=p.querySelector(Zh(k)))de.loading=5;else{o=v({rel:"stylesheet",href:o,"data-precedence":u},h),(h=ao.get(k))&&Lg(o,h);var Oe=Y=p.createElement("link");Jt(Oe),gs(Oe,"link",o),Oe._p=new Promise(function(tt,ht){Oe.onload=tt,Oe.onerror=ht}),Oe.addEventListener("load",function(){de.loading|=1}),Oe.addEventListener("error",function(){de.loading|=2}),de.loading|=4,Hm(Y,u,p)}Y={type:"stylesheet",instance:Y,count:1,state:de},S.set(k,Y)}}}function yE(o,u){ac.X(o,u);var h=Ef;if(h&&o){var p=Mt(h).hoistableScripts,S=Cf(o),k=p.get(S);k||(k=h.querySelector(Qh(S)),k||(o=v({src:o,async:!0},u),(u=ao.get(S))&&Pg(o,u),k=h.createElement("script"),Jt(k),gs(k,"link",o),h.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},p.set(S,k))}}function _E(o,u){ac.M(o,u);var h=Ef;if(h&&o){var p=Mt(h).hoistableScripts,S=Cf(o),k=p.get(S);k||(k=h.querySelector(Qh(S)),k||(o=v({src:o,async:!0,type:"module"},u),(u=ao.get(S))&&Pg(o,u),k=h.createElement("script"),Jt(k),gs(k,"link",o),h.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},p.set(S,k))}}function J_(o,u,h,p){var S=(S=ne.current)?zm(S):null;if(!S)throw Error(a(446));switch(o){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(u=Af(h.href),h=Mt(S).hoistableStyles,p=h.get(u),p||(p={type:"style",instance:null,count:0,state:null},h.set(u,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){o=Af(h.href);var k=Mt(S).hoistableStyles,Y=k.get(o);if(Y||(S=S.ownerDocument||S,Y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},k.set(o,Y),(k=S.querySelector(Zh(o)))&&!k._p&&(Y.instance=k,Y.state.loading=5),ao.has(o)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},ao.set(o,h),k||bE(S,o,h,Y.state))),u&&p===null)throw Error(a(528,""));return Y}if(u&&p!==null)throw Error(a(529,""));return null;case"script":return u=h.async,h=h.src,typeof h=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=Cf(h),h=Mt(S).hoistableScripts,p=h.get(u),p||(p={type:"script",instance:null,count:0,state:null},h.set(u,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,o))}}function Af(o){return'href="'+sn(o)+'"'}function Zh(o){return'link[rel="stylesheet"]['+o+"]"}function Z_(o){return v({},o,{"data-precedence":o.precedence,precedence:null})}function bE(o,u,h,p){o.querySelector('link[rel="preload"][as="style"]['+u+"]")?p.loading=1:(u=o.createElement("link"),p.preload=u,u.addEventListener("load",function(){return p.loading|=1}),u.addEventListener("error",function(){return p.loading|=2}),gs(u,"link",h),Jt(u),o.head.appendChild(u))}function Cf(o){return'[src="'+sn(o)+'"]'}function Qh(o){return"script[async]"+o}function Q_(o,u,h){if(u.count++,u.instance===null)switch(u.type){case"style":var p=o.querySelector('style[data-href~="'+sn(h.href)+'"]');if(p)return u.instance=p,Jt(p),p;var S=v({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return p=(o.ownerDocument||o).createElement("style"),Jt(p),gs(p,"style",S),Hm(p,h.precedence,o),u.instance=p;case"stylesheet":S=Af(h.href);var k=o.querySelector(Zh(S));if(k)return u.state.loading|=4,u.instance=k,Jt(k),k;p=Z_(h),(S=ao.get(S))&&Lg(p,S),k=(o.ownerDocument||o).createElement("link"),Jt(k);var Y=k;return Y._p=new Promise(function(de,Oe){Y.onload=de,Y.onerror=Oe}),gs(k,"link",p),u.state.loading|=4,Hm(k,h.precedence,o),u.instance=k;case"script":return k=Cf(h.src),(S=o.querySelector(Qh(k)))?(u.instance=S,Jt(S),S):(p=h,(S=ao.get(k))&&(p=v({},h),Pg(p,S)),o=o.ownerDocument||o,S=o.createElement("script"),Jt(S),gs(S,"link",p),o.head.appendChild(S),u.instance=S);case"void":return null;default:throw Error(a(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(p=u.instance,u.state.loading|=4,Hm(p,h.precedence,o));return u.instance}function Hm(o,u,h){for(var p=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=p.length?p[p.length-1]:null,k=S,Y=0;Y<p.length;Y++){var de=p[Y];if(de.dataset.precedence===u)k=de;else if(k!==S)break}k?k.parentNode.insertBefore(o,k.nextSibling):(u=h.nodeType===9?h.head:h,u.insertBefore(o,u.firstChild))}function Lg(o,u){o.crossOrigin==null&&(o.crossOrigin=u.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=u.referrerPolicy),o.title==null&&(o.title=u.title)}function Pg(o,u){o.crossOrigin==null&&(o.crossOrigin=u.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=u.referrerPolicy),o.integrity==null&&(o.integrity=u.integrity)}var $m=null;function eb(o,u,h){if($m===null){var p=new Map,S=$m=new Map;S.set(h,p)}else S=$m,p=S.get(h),p||(p=new Map,S.set(h,p));if(p.has(o))return p;for(p.set(o,null),h=h.getElementsByTagName(o),S=0;S<h.length;S++){var k=h[S];if(!(k[Qe]||k[pe]||o==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!=="http://www.w3.org/2000/svg"){var Y=k.getAttribute(u)||"";Y=o+Y;var de=p.get(Y);de?de.push(k):p.set(Y,[k])}}return p}function tb(o,u,h){o=o.ownerDocument||o,o.head.insertBefore(h,u==="title"?o.querySelector("head > title"):null)}function wE(o,u,h){if(h===1||u.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return o=u.disabled,typeof u.precedence=="string"&&o==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function rb(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}function SE(o,u,h,p){if(h.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var S=Af(p.href),k=u.querySelector(Zh(S));if(k){u=k._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(o.count++,o=Wm.bind(o),u.then(o,o)),h.state.loading|=4,h.instance=k,Jt(k);return}k=u.ownerDocument||u,p=Z_(p),(S=ao.get(S))&&Lg(p,S),k=k.createElement("link"),Jt(k);var Y=k;Y._p=new Promise(function(de,Oe){Y.onload=de,Y.onerror=Oe}),gs(k,"link",p),h.instance=k}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(h,u),(u=h.state.preload)&&(h.state.loading&3)===0&&(o.count++,h=Wm.bind(o),u.addEventListener("load",h),u.addEventListener("error",h))}}var Mg=0;function NE(o,u){return o.stylesheets&&o.count===0&&Gm(o,o.stylesheets),0<o.count||0<o.imgCount?function(h){var p=setTimeout(function(){if(o.stylesheets&&Gm(o,o.stylesheets),o.unsuspend){var k=o.unsuspend;o.unsuspend=null,k()}},6e4+u);0<o.imgBytes&&Mg===0&&(Mg=62500*nE());var S=setTimeout(function(){if(o.waitingForImages=!1,o.count===0&&(o.stylesheets&&Gm(o,o.stylesheets),o.unsuspend)){var k=o.unsuspend;o.unsuspend=null,k()}},(o.imgBytes>Mg?50:800)+u);return o.unsuspend=h,function(){o.unsuspend=null,clearTimeout(p),clearTimeout(S)}}:null}function Wm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Gm(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var Vm=null;function Gm(o,u){o.stylesheets=null,o.unsuspend!==null&&(o.count++,Vm=new Map,u.forEach(jE,o),Vm=null,Wm.call(o))}function jE(o,u){if(!(u.state.loading&4)){var h=Vm.get(o);if(h)var p=h.get(null);else{h=new Map,Vm.set(o,h);for(var S=o.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<S.length;k++){var Y=S[k];(Y.nodeName==="LINK"||Y.getAttribute("media")!=="not all")&&(h.set(Y.dataset.precedence,Y),p=Y)}p&&h.set(null,p)}S=u.instance,Y=S.getAttribute("data-precedence"),k=h.get(Y)||p,k===p&&h.set(null,S),h.set(Y,S),this.count++,p=Wm.bind(this),S.addEventListener("load",p),S.addEventListener("error",p),k?k.parentNode.insertBefore(S,k.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(S,o.firstChild)),u.state.loading|=4}}var e0={$$typeof:A,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function kE(o,u,h,p,S,k,Y,de,Oe){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fa(0),this.hiddenUpdates=fa(null),this.identifierPrefix=p,this.onUncaughtError=S,this.onCaughtError=k,this.onRecoverableError=Y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Oe,this.incompleteTransitions=new Map}function ab(o,u,h,p,S,k,Y,de,Oe,tt,ht,xt){return o=new kE(o,u,h,Y,Oe,tt,ht,xt,de),u=1,k===!0&&(u|=24),k=es(3,null,null,u),o.current=k,k.stateNode=o,u=qc(),u.refCount++,o.pooledCache=u,u.refCount++,k.memoizedState={element:p,isDehydrated:h,cache:u},Bt(k),o}function nb(o){return o?(o=Hn,o):Hn}function sb(o,u,h,p,S,k){S=nb(S),p.context===null?p.context=S:p.pendingContext=S,p=xr(u),p.payload={element:h},k=k===void 0?null:k,k!==null&&(p.callback=k),h=Or(o,p,u),h!==null&&(di(h,o,u),la(h,o,u))}function ib(o,u){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<u?h:u}}function Ig(o,u){ib(o,u),(o=o.alternate)&&ib(o,u)}function ob(o){if(o.tag===13||o.tag===31){var u=Lo(o,67108864);u!==null&&di(u,o,67108864),Ig(o,67108864)}}function lb(o){if(o.tag===13||o.tag===31){var u=Ci();u=Pt(u);var h=Lo(o,u);h!==null&&di(h,o,u),Ig(o,u)}}var Ym=!0;function EE(o,u,h,p){var S=X.T;X.T=null;var k=J.p;try{J.p=2,Bg(o,u,h,p)}finally{J.p=k,X.T=S}}function AE(o,u,h,p){var S=X.T;X.T=null;var k=J.p;try{J.p=8,Bg(o,u,h,p)}finally{J.p=k,X.T=S}}function Bg(o,u,h,p){if(Ym){var S=Ug(p);if(S===null)jg(o,u,p,Xm,h),ub(o,p);else if(TE(S,o,u,h,p))p.stopPropagation();else if(ub(o,p),u&4&&-1<CE.indexOf(o)){for(;S!==null;){var k=qt(S);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var Y=zt(k.pendingLanes);if(Y!==0){var de=k;for(de.pendingLanes|=2,de.entangledLanes|=2;Y;){var Oe=1<<31-Ve(Y);de.entanglements[1]|=Oe,Y&=~Oe}_l(k),(ua&6)===0&&(Om=Ft()+500,Yh(0))}}break;case 31:case 13:de=Lo(k,2),de!==null&&di(de,k,2),Dm(),Ig(k,2)}if(k=Ug(p),k===null&&jg(o,u,p,Xm,h),k===S)break;S=k}S!==null&&p.stopPropagation()}else jg(o,u,p,null,h)}}function Ug(o){return o=Dl(o),qg(o)}var Xm=null;function qg(o){if(Xm=null,o=Rt(o),o!==null){var u=s(o);if(u===null)o=null;else{var h=u.tag;if(h===13){if(o=l(u),o!==null)return o;o=null}else if(h===31){if(o=c(u),o!==null)return o;o=null}else if(h===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;o=null}else u!==o&&(o=null)}}return Xm=o,null}function cb(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Xt()){case Ut:return 2;case Wt:return 8;case $t:case wt:return 32;case Ce:return 268435456;default:return 32}default:return 32}}var zg=!1,eu=null,tu=null,ru=null,t0=new Map,r0=new Map,au=[],CE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ub(o,u){switch(o){case"focusin":case"focusout":eu=null;break;case"dragenter":case"dragleave":tu=null;break;case"mouseover":case"mouseout":ru=null;break;case"pointerover":case"pointerout":t0.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":r0.delete(u.pointerId)}}function a0(o,u,h,p,S,k){return o===null||o.nativeEvent!==k?(o={blockedOn:u,domEventName:h,eventSystemFlags:p,nativeEvent:k,targetContainers:[S]},u!==null&&(u=qt(u),u!==null&&ob(u)),o):(o.eventSystemFlags|=p,u=o.targetContainers,S!==null&&u.indexOf(S)===-1&&u.push(S),o)}function TE(o,u,h,p,S){switch(u){case"focusin":return eu=a0(eu,o,u,h,p,S),!0;case"dragenter":return tu=a0(tu,o,u,h,p,S),!0;case"mouseover":return ru=a0(ru,o,u,h,p,S),!0;case"pointerover":var k=S.pointerId;return t0.set(k,a0(t0.get(k)||null,o,u,h,p,S)),!0;case"gotpointercapture":return k=S.pointerId,r0.set(k,a0(r0.get(k)||null,o,u,h,p,S)),!0}return!1}function db(o){var u=Rt(o.target);if(u!==null){var h=s(u);if(h!==null){if(u=h.tag,u===13){if(u=l(h),u!==null){o.blockedOn=u,be(o.priority,function(){lb(h)});return}}else if(u===31){if(u=c(h),u!==null){o.blockedOn=u,be(o.priority,function(){lb(h)});return}}else if(u===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Km(o){if(o.blockedOn!==null)return!1;for(var u=o.targetContainers;0<u.length;){var h=Ug(o.nativeEvent);if(h===null){h=o.nativeEvent;var p=new h.constructor(h.type,h);xo=p,h.target.dispatchEvent(p),xo=null}else return u=qt(h),u!==null&&ob(u),o.blockedOn=h,!1;u.shift()}return!0}function fb(o,u,h){Km(o)&&h.delete(u)}function OE(){zg=!1,eu!==null&&Km(eu)&&(eu=null),tu!==null&&Km(tu)&&(tu=null),ru!==null&&Km(ru)&&(ru=null),t0.forEach(fb),r0.forEach(fb)}function Jm(o,u){o.blockedOn===u&&(o.blockedOn=null,zg||(zg=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,OE)))}var Zm=null;function hb(o){Zm!==o&&(Zm=o,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Zm===o&&(Zm=null);for(var u=0;u<o.length;u+=3){var h=o[u],p=o[u+1],S=o[u+2];if(typeof p!="function"){if(qg(p||h)===null)continue;break}var k=qt(h);k!==null&&(o.splice(u,3),u-=3,U1(k,{pending:!0,data:S,method:h.method,action:p},p,S))}}))}function Tf(o){function u(Oe){return Jm(Oe,o)}eu!==null&&Jm(eu,o),tu!==null&&Jm(tu,o),ru!==null&&Jm(ru,o),t0.forEach(u),r0.forEach(u);for(var h=0;h<au.length;h++){var p=au[h];p.blockedOn===o&&(p.blockedOn=null)}for(;0<au.length&&(h=au[0],h.blockedOn===null);)db(h),h.blockedOn===null&&au.shift();if(h=(o.ownerDocument||o).$$reactFormReplay,h!=null)for(p=0;p<h.length;p+=3){var S=h[p],k=h[p+1],Y=S[Se]||null;if(typeof k=="function")Y||hb(h);else if(Y){var de=null;if(k&&k.hasAttribute("formAction")){if(S=k,Y=k[Se]||null)de=Y.formAction;else if(qg(S)!==null)continue}else de=Y.action;typeof de=="function"?h[p+1]=de:(h.splice(p,3),p-=3),hb(h)}}}function mb(){function o(k){k.canIntercept&&k.info==="react-transition"&&k.intercept({handler:function(){return new Promise(function(Y){return S=Y})},focusReset:"manual",scroll:"manual"})}function u(){S!==null&&(S(),S=null),p||setTimeout(h,20)}function h(){if(!p&&!navigation.transition){var k=navigation.currentEntry;k&&k.url!=null&&navigation.navigate(k.url,{state:k.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,S=null;return navigation.addEventListener("navigate",o),navigation.addEventListener("navigatesuccess",u),navigation.addEventListener("navigateerror",u),setTimeout(h,100),function(){p=!0,navigation.removeEventListener("navigate",o),navigation.removeEventListener("navigatesuccess",u),navigation.removeEventListener("navigateerror",u),S!==null&&(S(),S=null)}}}function Hg(o){this._internalRoot=o}Qm.prototype.render=Hg.prototype.render=function(o){var u=this._internalRoot;if(u===null)throw Error(a(409));var h=u.current,p=Ci();sb(h,p,o,u,null,null)},Qm.prototype.unmount=Hg.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var u=o.containerInfo;sb(o.current,2,null,o,null,null),Dm(),u[we]=null}};function Qm(o){this._internalRoot=o}Qm.prototype.unstable_scheduleHydration=function(o){if(o){var u=ae();o={blockedOn:null,target:o,priority:u};for(var h=0;h<au.length&&u!==0&&u<au[h].priority;h++);au.splice(h,0,o),h===0&&db(o)}};var pb=e.version;if(pb!=="19.2.0")throw Error(a(527,pb,"19.2.0"));J.findDOMNode=function(o){var u=o._reactInternals;if(u===void 0)throw typeof o.render=="function"?Error(a(188)):(o=Object.keys(o).join(","),Error(a(268,o)));return o=f(u),o=o!==null?m(o):null,o=o===null?null:o.stateNode,o};var RE={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ep=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ep.isDisabled&&ep.supportsFiber)try{At=ep.inject(RE),Ct=ep}catch{}}return s0.createRoot=function(o,u){if(!n(o))throw Error(a(299));var h=!1,p="",S=wy,k=Sy,Y=Ny;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(p=u.identifierPrefix),u.onUncaughtError!==void 0&&(S=u.onUncaughtError),u.onCaughtError!==void 0&&(k=u.onCaughtError),u.onRecoverableError!==void 0&&(Y=u.onRecoverableError)),u=ab(o,1,!1,null,null,h,p,null,S,k,Y,mb),o[we]=u.current,Ng(o),new Hg(u)},s0.hydrateRoot=function(o,u,h){if(!n(o))throw Error(a(299));var p=!1,S="",k=wy,Y=Sy,de=Ny,Oe=null;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(S=h.identifierPrefix),h.onUncaughtError!==void 0&&(k=h.onUncaughtError),h.onCaughtError!==void 0&&(Y=h.onCaughtError),h.onRecoverableError!==void 0&&(de=h.onRecoverableError),h.formState!==void 0&&(Oe=h.formState)),u=ab(o,1,!0,u,h??null,p,S,Oe,k,Y,de,mb),u.context=nb(null),h=u.current,p=Ci(),p=Pt(p),S=xr(p),S.callback=null,Or(h,S,p),h=p,u.current.lanes=h,ir(u,h),_l(u),o[we]=u.current,Ng(o),new Qm(u)},s0.version="19.2.0",s0}var jb;function WE(){if(jb)return Vg.exports;jb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Vg.exports=$E(),Vg.exports}var VE=WE();const GE=Gx(VE);var sx=function(t,e){return sx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},sx(t,e)};function ZS(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");sx(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var $p=function(){return $p=Object.assign||function(e){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},$p.apply(this,arguments)};function hh(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(t);n<a.length;n++)e.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(r[a[n]]=t[a[n]]);return r}function QS(t,e,r,a){var n=arguments.length,s=n<3?e:a===null?a=Object.getOwnPropertyDescriptor(e,r):a,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,a);else for(var c=t.length-1;c>=0;c--)(l=t[c])&&(s=(n<3?l(s):n>3?l(e,r,s):l(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function e4(t,e){return function(r,a){e(r,a,t)}}function t4(t,e,r,a,n,s){function l(E){if(E!==void 0&&typeof E!="function")throw new TypeError("Function expected");return E}for(var c=a.kind,d=c==="getter"?"get":c==="setter"?"set":"value",f=!e&&t?a.static?t:t.prototype:null,m=e||(f?Object.getOwnPropertyDescriptor(f,a.name):{}),v,x=!1,g=r.length-1;g>=0;g--){var b={};for(var _ in a)b[_]=_==="access"?{}:a[_];for(var _ in a.access)b.access[_]=a.access[_];b.addInitializer=function(E){if(x)throw new TypeError("Cannot add initializers after decoration has completed");s.push(l(E||null))};var w=(0,r[g])(c==="accessor"?{get:m.get,set:m.set}:m[d],b);if(c==="accessor"){if(w===void 0)continue;if(w===null||typeof w!="object")throw new TypeError("Object expected");(v=l(w.get))&&(m.get=v),(v=l(w.set))&&(m.set=v),(v=l(w.init))&&n.unshift(v)}else(v=l(w))&&(c==="field"?n.unshift(v):m[d]=v)}f&&Object.defineProperty(f,a.name,m),x=!0}function r4(t,e,r){for(var a=arguments.length>2,n=0;n<e.length;n++)r=a?e[n].call(t,r):e[n].call(t);return a?r:void 0}function a4(t){return typeof t=="symbol"?t:"".concat(t)}function n4(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function s4(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function rr(t,e,r,a){function n(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function c(m){try{f(a.next(m))}catch(v){l(v)}}function d(m){try{f(a.throw(m))}catch(v){l(v)}}function f(m){m.done?s(m.value):n(m.value).then(c,d)}f((a=a.apply(t,e||[])).next())})}function i4(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},a,n,s,l=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return l.next=c(0),l.throw=c(1),l.return=c(2),typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function c(f){return function(m){return d([f,m])}}function d(f){if(a)throw new TypeError("Generator is already executing.");for(;l&&(l=0,f[0]&&(r=0)),r;)try{if(a=1,n&&(s=f[0]&2?n.return:f[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,f[1])).done)return s;switch(n=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,n=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(m){f=[6,m],n=0}finally{a=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}var p1=Object.create?(function(t,e,r,a){a===void 0&&(a=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,a,n)}):(function(t,e,r,a){a===void 0&&(a=r),t[a]=e[r]});function o4(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&p1(e,t,r)}function Wp(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],a=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&a>=t.length&&(t=void 0),{value:t&&t[a++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Xx(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var a=r.call(t),n,s=[],l;try{for(;(e===void 0||e-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(c){l={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(l)throw l.error}}return s}function l4(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Xx(arguments[e]));return t}function c4(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var a=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],l=0,c=s.length;l<c;l++,n++)a[n]=s[l];return a}function u4(t,e,r){if(r||arguments.length===2)for(var a=0,n=e.length,s;a<n;a++)(s||!(a in e))&&(s||(s=Array.prototype.slice.call(e,0,a)),s[a]=e[a]);return t.concat(s||Array.prototype.slice.call(e))}function ch(t){return this instanceof ch?(this.v=t,this):new ch(t)}function d4(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r.apply(t,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),n[Symbol.asyncIterator]=function(){return this},n;function l(g){return function(b){return Promise.resolve(b).then(g,v)}}function c(g,b){a[g]&&(n[g]=function(_){return new Promise(function(w,E){s.push([g,_,w,E])>1||d(g,_)})},b&&(n[g]=b(n[g])))}function d(g,b){try{f(a[g](b))}catch(_){x(s[0][3],_)}}function f(g){g.value instanceof ch?Promise.resolve(g.value.v).then(m,v):x(s[0][2],g)}function m(g){d("next",g)}function v(g){d("throw",g)}function x(g,b){g(b),s.shift(),s.length&&d(s[0][0],s[0][1])}}function f4(t){var e,r;return e={},a("next"),a("throw",function(n){throw n}),a("return"),e[Symbol.iterator]=function(){return this},e;function a(n,s){e[n]=t[n]?function(l){return(r=!r)?{value:ch(t[n](l)),done:!1}:s?s(l):l}:s}}function h4(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Wp=="function"?Wp(t):t[Symbol.iterator](),r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r);function a(s){r[s]=t[s]&&function(l){return new Promise(function(c,d){l=t[s](l),n(c,d,l.done,l.value)})}}function n(s,l,c,d){Promise.resolve(d).then(function(f){s({value:f,done:c})},l)}}function m4(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var YE=Object.create?(function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}):function(t,e){t.default=e},ix=function(t){return ix=Object.getOwnPropertyNames||function(e){var r=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[r.length]=a);return r},ix(t)};function p4(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=ix(t),a=0;a<r.length;a++)r[a]!=="default"&&p1(e,t,r[a]);return YE(e,t),e}function g4(t){return t&&t.__esModule?t:{default:t}}function v4(t,e,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(t):a?a.value:e.get(t)}function x4(t,e,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}function y4(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function _4(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var a,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");a=e[Symbol.asyncDispose]}if(a===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");a=e[Symbol.dispose],r&&(n=a)}if(typeof a!="function")throw new TypeError("Object not disposable.");n&&(a=function(){try{n.call(this)}catch(s){return Promise.reject(s)}}),t.stack.push({value:e,dispose:a,async:r})}else r&&t.stack.push({async:!0});return e}var XE=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var a=new Error(r);return a.name="SuppressedError",a.error=t,a.suppressed=e,a};function b4(t){function e(s){t.error=t.hasError?new XE(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var r,a=0;function n(){for(;r=t.stack.pop();)try{if(!r.async&&a===1)return a=0,t.stack.push(r),Promise.resolve().then(n);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return a|=2,Promise.resolve(s).then(n,function(l){return e(l),n()})}else a|=1}catch(l){e(l)}if(a===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return n()}function w4(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,a,n,s,l){return a?e?".jsx":".js":n&&(!s||!l)?r:n+s+"."+l.toLowerCase()+"js"}):t}const KE={__extends:ZS,__assign:$p,__rest:hh,__decorate:QS,__param:e4,__esDecorate:t4,__runInitializers:r4,__propKey:a4,__setFunctionName:n4,__metadata:s4,__awaiter:rr,__generator:i4,__createBinding:p1,__exportStar:o4,__values:Wp,__read:Xx,__spread:l4,__spreadArrays:c4,__spreadArray:u4,__await:ch,__asyncGenerator:d4,__asyncDelegator:f4,__asyncValues:h4,__makeTemplateObject:m4,__importStar:p4,__importDefault:g4,__classPrivateFieldGet:v4,__classPrivateFieldSet:x4,__classPrivateFieldIn:y4,__addDisposableResource:_4,__disposeResources:b4,__rewriteRelativeImportExtension:w4},JE=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:_4,get __assign(){return $p},__asyncDelegator:f4,__asyncGenerator:d4,__asyncValues:h4,__await:ch,__awaiter:rr,__classPrivateFieldGet:v4,__classPrivateFieldIn:y4,__classPrivateFieldSet:x4,__createBinding:p1,__decorate:QS,__disposeResources:b4,__esDecorate:t4,__exportStar:o4,__extends:ZS,__generator:i4,__importDefault:g4,__importStar:p4,__makeTemplateObject:m4,__metadata:s4,__param:e4,__propKey:a4,__read:Xx,__rest:hh,__rewriteRelativeImportExtension:w4,__runInitializers:r4,__setFunctionName:n4,__spread:l4,__spreadArray:u4,__spreadArrays:c4,__values:Wp,default:KE},Symbol.toStringTag,{value:"Module"})),ZE=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Kx extends Error{constructor(e,r="FunctionsError",a){super(e),this.name=r,this.context=a}}class QE extends Kx{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class kb extends Kx{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Eb extends Kx{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ox;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ox||(ox={}));class eA{constructor(e,{headers:r={},customFetch:a,region:n=ox.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=ZE(a)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return rr(this,arguments,void 0,function*(r,a={}){var n;let s,l;try{const{headers:c,method:d,body:f,signal:m,timeout:v}=a;let x={},{region:g}=a;g||(g=this.region);const b=new URL(`${this.url}/${r}`);g&&g!=="any"&&(x["x-region"]=g,b.searchParams.set("forceFunctionRegion",g));let _;f&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",_=f):typeof f=="string"?(x["Content-Type"]="text/plain",_=f):typeof FormData<"u"&&f instanceof FormData?_=f:(x["Content-Type"]="application/json",_=JSON.stringify(f)):_=f;let w=m;v&&(l=new AbortController,s=setTimeout(()=>l.abort(),v),m?(w=l.signal,m.addEventListener("abort",()=>l.abort())):w=l.signal);const E=yield this.fetch(b.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),c),body:_,signal:w}).catch(G=>{throw new QE(G)}),C=E.headers.get("x-relay-error");if(C&&C==="true")throw new kb(E);if(!E.ok)throw new Eb(E);let A=((n=E.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),O;return A==="application/json"?O=yield E.json():A==="application/octet-stream"||A==="application/pdf"?O=yield E.blob():A==="text/event-stream"?O=E:A==="multipart/form-data"?O=yield E.formData():O=yield E.text(),{data:O,error:null,response:E}}catch(c){return{data:null,error:c,response:c instanceof Eb||c instanceof kb?c.context:void 0}}finally{s&&clearTimeout(s)}})}}var ks={};const mh=LE(JE);var tp={},rp={},ap={},np={},sp={},ip={},Ab;function S4(){if(Ab)return ip;Ab=1,Object.defineProperty(ip,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return ip.default=t,ip}var Cb;function N4(){if(Cb)return sp;Cb=1,Object.defineProperty(sp,"__esModule",{value:!0});const e=mh.__importDefault(S4());class r{constructor(n){var s,l;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(s=n.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=n.signal,this.isMaybeSingle=(l=n.isMaybeSingle)!==null&&l!==void 0?l:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,s){return this.headers=new Headers(this.headers),this.headers.set(n,s),this}then(n,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const l=this.fetch;let c=l(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var f,m,v,x;let g=null,b=null,_=null,w=d.status,E=d.statusText;if(d.ok){if(this.method!=="HEAD"){const G=await d.text();G===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((f=this.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?b=G:b=JSON.parse(G))}const A=(m=this.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),O=(v=d.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");A&&O&&O.length>1&&(_=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(g={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,_=null,w=406,E="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const A=await d.text();try{g=JSON.parse(A),Array.isArray(g)&&d.status===404&&(b=[],g=null,w=200,E="OK")}catch{d.status===404&&A===""?(w=204,E="No Content"):g={message:A}}if(g&&this.isMaybeSingle&&(!((x=g?.details)===null||x===void 0)&&x.includes("0 rows"))&&(g=null,w=200,E="OK"),g&&this.shouldThrowOnError)throw new e.default(g)}return{error:g,data:b,count:_,status:w,statusText:E}});return this.shouldThrowOnError||(c=c.catch(d=>{var f,m,v,x,g,b;let _="";const w=d?.cause;if(w){const E=(f=w?.message)!==null&&f!==void 0?f:"",C=(m=w?.code)!==null&&m!==void 0?m:"";_=`${(v=d?.name)!==null&&v!==void 0?v:"FetchError"}: ${d?.message}`,_+=`

Caused by: ${(x=w?.name)!==null&&x!==void 0?x:"Error"}: ${E}`,C&&(_+=` (${C})`),w?.stack&&(_+=`
${w.stack}`)}else _=(g=d?.stack)!==null&&g!==void 0?g:"";return{error:{message:`${(b=d?.name)!==null&&b!==void 0?b:"FetchError"}: ${d?.message}`,details:_,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),c.then(n,s)}returns(){return this}overrideTypes(){return this}}return sp.default=r,sp}var Tb;function j4(){if(Tb)return np;Tb=1,Object.defineProperty(np,"__esModule",{value:!0});const e=mh.__importDefault(N4());class r extends e.default{select(n){let s=!1;const l=(n??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join("");return this.url.searchParams.set("select",l),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:s=!0,nullsFirst:l,foreignTable:c,referencedTable:d=c}={}){const f=d?`${d}.order`:"order",m=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${m?`${m},`:""}${n}.${s?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:s,referencedTable:l=s}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${n}`),this}range(n,s,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"offset":`${c}.offset`,f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${n}`),this.url.searchParams.set(f,`${s-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:s=!1,settings:l=!1,buffers:c=!1,wal:d=!1,format:f="text"}={}){var m;const v=[n?"analyze":null,s?"verbose":null,l?"settings":null,c?"buffers":null,d?"wal":null].filter(Boolean).join("|"),x=(m=this.headers.get("Accept"))!==null&&m!==void 0?m:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${x}"; options=${v};`),f==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return np.default=r,np}var Ob;function Jx(){if(Ob)return ap;Ob=1,Object.defineProperty(ap,"__esModule",{value:!0});const e=mh.__importDefault(j4()),r=new RegExp("[,()]");class a extends e.default{eq(s,l){return this.url.searchParams.append(s,`eq.${l}`),this}neq(s,l){return this.url.searchParams.append(s,`neq.${l}`),this}gt(s,l){return this.url.searchParams.append(s,`gt.${l}`),this}gte(s,l){return this.url.searchParams.append(s,`gte.${l}`),this}lt(s,l){return this.url.searchParams.append(s,`lt.${l}`),this}lte(s,l){return this.url.searchParams.append(s,`lte.${l}`),this}like(s,l){return this.url.searchParams.append(s,`like.${l}`),this}likeAllOf(s,l){return this.url.searchParams.append(s,`like(all).{${l.join(",")}}`),this}likeAnyOf(s,l){return this.url.searchParams.append(s,`like(any).{${l.join(",")}}`),this}ilike(s,l){return this.url.searchParams.append(s,`ilike.${l}`),this}ilikeAllOf(s,l){return this.url.searchParams.append(s,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(s,l){return this.url.searchParams.append(s,`ilike(any).{${l.join(",")}}`),this}regexMatch(s,l){return this.url.searchParams.append(s,`match.${l}`),this}regexIMatch(s,l){return this.url.searchParams.append(s,`imatch.${l}`),this}is(s,l){return this.url.searchParams.append(s,`is.${l}`),this}isDistinct(s,l){return this.url.searchParams.append(s,`isdistinct.${l}`),this}in(s,l){const c=Array.from(new Set(l)).map(d=>typeof d=="string"&&r.test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(s,`in.(${c})`),this}contains(s,l){return typeof l=="string"?this.url.searchParams.append(s,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(s,`cs.{${l.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(l)}`),this}containedBy(s,l){return typeof l=="string"?this.url.searchParams.append(s,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(s,`cd.{${l.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(l)}`),this}rangeGt(s,l){return this.url.searchParams.append(s,`sr.${l}`),this}rangeGte(s,l){return this.url.searchParams.append(s,`nxl.${l}`),this}rangeLt(s,l){return this.url.searchParams.append(s,`sl.${l}`),this}rangeLte(s,l){return this.url.searchParams.append(s,`nxr.${l}`),this}rangeAdjacent(s,l){return this.url.searchParams.append(s,`adj.${l}`),this}overlaps(s,l){return typeof l=="string"?this.url.searchParams.append(s,`ov.${l}`):this.url.searchParams.append(s,`ov.{${l.join(",")}}`),this}textSearch(s,l,{config:c,type:d}={}){let f="";d==="plain"?f="pl":d==="phrase"?f="ph":d==="websearch"&&(f="w");const m=c===void 0?"":`(${c})`;return this.url.searchParams.append(s,`${f}fts${m}.${l}`),this}match(s){return Object.entries(s).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(s,l,c){return this.url.searchParams.append(s,`not.${l}.${c}`),this}or(s,{foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${s})`),this}filter(s,l,c){return this.url.searchParams.append(s,`${l}.${c}`),this}}return ap.default=a,ap}var Rb;function k4(){if(Rb)return rp;Rb=1,Object.defineProperty(rp,"__esModule",{value:!0});const e=mh.__importDefault(Jx());class r{constructor(n,{headers:s={},schema:l,fetch:c}){this.url=n,this.headers=new Headers(s),this.schema=l,this.fetch=c}select(n,s){const{head:l=!1,count:c}=s??{},d=l?"HEAD":"GET";let f=!1;const m=(n??"*").split("").map(v=>/\s/.test(v)&&!f?"":(v==='"'&&(f=!f),v)).join("");return this.url.searchParams.set("select",m),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:s,defaultToNull:l=!0}={}){var c;const d="POST";if(s&&this.headers.append("Prefer",`count=${s}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const f=n.reduce((m,v)=>m.concat(Object.keys(v)),[]);if(f.length>0){const m=[...new Set(f)].map(v=>`"${v}"`);this.url.searchParams.set("columns",m.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}upsert(n,{onConflict:s,ignoreDuplicates:l=!1,count:c,defaultToNull:d=!0}={}){var f;const m="POST";if(this.headers.append("Prefer",`resolution=${l?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),c&&this.headers.append("Prefer",`count=${c}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const v=n.reduce((x,g)=>x.concat(Object.keys(g)),[]);if(v.length>0){const x=[...new Set(v)].map(g=>`"${g}"`);this.url.searchParams.set("columns",x.join(","))}}return new e.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}update(n,{count:s}={}){var l;const c="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}delete({count:n}={}){var s;const l="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return rp.default=r,rp}var Db;function tA(){if(Db)return tp;Db=1,Object.defineProperty(tp,"__esModule",{value:!0});const t=mh,e=t.__importDefault(k4()),r=t.__importDefault(Jx());class a{constructor(s,{headers:l={},schema:c,fetch:d}={}){this.url=s,this.headers=new Headers(l),this.schemaName=c,this.fetch=d}from(s){if(!s||typeof s!="string"||s.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const l=new URL(`${this.url}/${s}`);return new e.default(l,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new a(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,l={},{head:c=!1,get:d=!1,count:f}={}){var m;let v;const x=new URL(`${this.url}/rpc/${s}`);let g;c||d?(v=c?"HEAD":"GET",Object.entries(l).filter(([_,w])=>w!==void 0).map(([_,w])=>[_,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([_,w])=>{x.searchParams.append(_,w)})):(v="POST",g=l);const b=new Headers(this.headers);return f&&b.set("Prefer",`count=${f}`),new r.default({method:v,url:x,headers:b,schema:this.schemaName,body:g,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}}return tp.default=a,tp}var Fb;function rA(){if(Fb)return ks;Fb=1,Object.defineProperty(ks,"__esModule",{value:!0}),ks.PostgrestError=ks.PostgrestBuilder=ks.PostgrestTransformBuilder=ks.PostgrestFilterBuilder=ks.PostgrestQueryBuilder=ks.PostgrestClient=void 0;const t=mh,e=t.__importDefault(tA());ks.PostgrestClient=e.default;const r=t.__importDefault(k4());ks.PostgrestQueryBuilder=r.default;const a=t.__importDefault(Jx());ks.PostgrestFilterBuilder=a.default;const n=t.__importDefault(j4());ks.PostgrestTransformBuilder=n.default;const s=t.__importDefault(N4());ks.PostgrestBuilder=s.default;const l=t.__importDefault(S4());return ks.PostgrestError=l.default,ks.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:s.default,PostgrestError:l.default},ks}var E4=rA();const A4=Gx(E4),aA=FE({__proto__:null,default:A4},[E4]),{PostgrestClient:nA,PostgrestQueryBuilder:T$,PostgrestFilterBuilder:O$,PostgrestTransformBuilder:R$,PostgrestBuilder:D$,PostgrestError:F$}=A4||aA;class sA{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,n=parseInt(a.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const a=this.getWebSocketConstructor();return new a(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const iA="2.86.0",oA=`realtime-js/${iA}`,C4="1.0.0",lA="2.0.0",Lb=C4,lx=1e4,cA=1e3,uA=100;var ld;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ld||(ld={}));var Xn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Xn||(Xn={}));var Yo;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Yo||(Yo={}));var cx;(function(t){t.websocket="websocket"})(cx||(cx={}));var cd;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(cd||(cd={}));class dA{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let a=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,a;const n=(a=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var r,a;const n=(a=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},l=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(e,r,a){var n,s;const l=e.topic,c=(n=e.ref)!==null&&n!==void 0?n:"",d=(s=e.join_ref)!==null&&s!==void 0?s:"",f=e.payload.event,m=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},v=Object.keys(m).length===0?"":JSON.stringify(m);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`userEvent length ${f.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`metadata length ${v.length} exceeds maximum of 255`);const x=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+c.length+l.length+f.length+v.length,g=new ArrayBuffer(this.HEADER_LENGTH+x);let b=new DataView(g),_=0;b.setUint8(_++,this.KINDS.userBroadcastPush),b.setUint8(_++,d.length),b.setUint8(_++,c.length),b.setUint8(_++,l.length),b.setUint8(_++,f.length),b.setUint8(_++,v.length),b.setUint8(_++,r),Array.from(d,E=>b.setUint8(_++,E.charCodeAt(0))),Array.from(c,E=>b.setUint8(_++,E.charCodeAt(0))),Array.from(l,E=>b.setUint8(_++,E.charCodeAt(0))),Array.from(f,E=>b.setUint8(_++,E.charCodeAt(0))),Array.from(v,E=>b.setUint8(_++,E.charCodeAt(0)));var w=new Uint8Array(g.byteLength+a.byteLength);return w.set(new Uint8Array(g),0),w.set(new Uint8Array(a),g.byteLength),w.buffer}decode(e,r){if(this._isArrayBuffer(e)){let a=this._binaryDecode(e);return r(a)}if(typeof e=="string"){const a=JSON.parse(e),[n,s,l,c,d]=a;return r({join_ref:n,ref:s,topic:l,event:c,payload:d})}return r({})}_binaryDecode(e){const r=new DataView(e),a=r.getUint8(0),n=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,n)}}_decodeUserBroadcast(e,r,a){const n=r.getUint8(1),s=r.getUint8(2),l=r.getUint8(3),c=r.getUint8(4);let d=this.HEADER_LENGTH+4;const f=a.decode(e.slice(d,d+n));d=d+n;const m=a.decode(e.slice(d,d+s));d=d+s;const v=a.decode(e.slice(d,d+l));d=d+l;const x=e.slice(d,e.byteLength),g=c===this.JSON_ENCODING?JSON.parse(a.decode(x)):x,b={type:this.BROADCAST_EVENT,event:m,payload:g};return l>0&&(b.meta=JSON.parse(v)),{join_ref:null,ref:null,topic:f,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([a])=>r.includes(a)))}}class T4{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Da;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Da||(Da={}));const Pb=(t,e,r={})=>{var a;const n=(a=r.skipTypes)!==null&&a!==void 0?a:[];return e?Object.keys(e).reduce((s,l)=>(s[l]=fA(l,t,e,n),s),{}):{}},fA=(t,e,r,a)=>{const n=e.find(c=>c.name===t),s=n?.type,l=r[t];return s&&!a.includes(s)?O4(s,l):ux(l)},O4=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return gA(e,r)}switch(t){case Da.bool:return hA(e);case Da.float4:case Da.float8:case Da.int2:case Da.int4:case Da.int8:case Da.numeric:case Da.oid:return mA(e);case Da.json:case Da.jsonb:return pA(e);case Da.timestamp:return vA(e);case Da.abstime:case Da.date:case Da.daterange:case Da.int4range:case Da.int8range:case Da.money:case Da.reltime:case Da.text:case Da.time:case Da.timestamptz:case Da.timetz:case Da.tsrange:case Da.tstzrange:return ux(e);default:return ux(e)}},ux=t=>t,hA=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},mA=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},pA=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},gA=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,a=t[r];if(t[0]==="{"&&a==="}"){let s;const l=t.slice(1,r);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(c=>O4(e,c))}return t},vA=t=>typeof t=="string"?t.replace(" ","T"):t,R4=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Kg{constructor(e,r,a={},n=lx){this.channel=e,this.event=r,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var a;return this._hasReceived(e)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(a=>a.status===e).forEach(a=>a.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Mb;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Mb||(Mb={}));class p0{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:s,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=p0.syncState(this.state,n,s,l),this.pendingDiffs.forEach(d=>{this.state=p0.syncDiff(this.state,d,s,l)}),this.pendingDiffs=[],c()}),this.channel._on(a.diff,{},n=>{const{onJoin:s,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=p0.syncDiff(this.state,n,s,l),c())}),this.onJoin((n,s,l)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:s,newPresences:l})}),this.onLeave((n,s,l)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,a,n){const s=this.cloneDeep(e),l=this.transformState(r),c={},d={};return this.map(s,(f,m)=>{l[f]||(d[f]=m)}),this.map(l,(f,m)=>{const v=s[f];if(v){const x=m.map(w=>w.presence_ref),g=v.map(w=>w.presence_ref),b=m.filter(w=>g.indexOf(w.presence_ref)<0),_=v.filter(w=>x.indexOf(w.presence_ref)<0);b.length>0&&(c[f]=b),_.length>0&&(d[f]=_)}else c[f]=m}),this.syncDiff(s,{joins:c,leaves:d},a,n)}static syncDiff(e,r,a,n){const{joins:s,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(s,(c,d)=>{var f;const m=(f=e[c])!==null&&f!==void 0?f:[];if(e[c]=this.cloneDeep(d),m.length>0){const v=e[c].map(g=>g.presence_ref),x=m.filter(g=>v.indexOf(g.presence_ref)<0);e[c].unshift(...x)}a(c,m,d)}),this.map(l,(c,d)=>{let f=e[c];if(!f)return;const m=d.map(v=>v.presence_ref);f=f.filter(v=>m.indexOf(v.presence_ref)<0),e[c]=f,n(c,f,d),f.length===0&&delete e[c]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(a=>r(a,e[a]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,a)=>{const n=e[a];return"metas"in n?r[a]=n.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[a]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ib;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ib||(Ib={}));var g0;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(g0||(g0={}));var ic;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(ic||(ic={}));class Zx{constructor(e,r={config:{}},a){var n,s;if(this.topic=e,this.params=r,this.socket=a,this.bindings={},this.state=Xn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Kg(this,Yo.join,this.params,this.timeout),this.rejoinTimer=new T4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Xn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Xn.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Xn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Xn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Xn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Yo.reply,{},(l,c)=>{this._trigger(this._replyEventName(c),l)}),this.presence=new p0(this),this.broadcastEndpointURL=R4(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var a,n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Xn.closed){const{config:{broadcast:l,presence:c,private:d}}=this.params,f=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(g=>g.filter))!==null&&n!==void 0?n:[],m=!!this.bindings[g0.PRESENCE]&&this.bindings[g0.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,v={},x={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:m}),postgres_changes:f,private:d};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(g=>e?.(ic.CHANNEL_ERROR,g)),this._onClose(()=>e?.(ic.CLOSED)),this.updateJoinPayload(Object.assign({config:x},v)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:g})=>{var b;if(this.socket.setAuth(),g===void 0){e?.(ic.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,w=(b=_?.length)!==null&&b!==void 0?b:0,E=[];for(let C=0;C<w;C++){const A=_[C],{filter:{event:O,schema:G,table:W,filter:B}}=A,q=g&&g[C];if(q&&q.event===O&&q.schema===G&&q.table===W&&q.filter===B)E.push(Object.assign(Object.assign({},A),{id:q.id}));else{this.unsubscribe(),this.state=Xn.errored,e?.(ic.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,e&&e(ic.SUBSCRIBED);return}}).receive("error",g=>{this.state=Xn.errored,e?.(ic.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e?.(ic.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,a){return this.state===Xn.joined&&e===g0.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,a)}async httpSend(e,r,a={}){var n;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const l={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=a.timeout)!==null&&n!==void 0?n:this.timeout);if(c.status===202)return{success:!0};let d=c.statusText;try{const f=await c.json();d=f.error||f.message||d}catch{}return Promise.reject(new Error(d))}async send(e,r={}){var a,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:l}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=f.body)===null||n===void 0?void 0:n.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,c,d;const f=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&s("ok"),f.receive("ok",()=>s("ok")),f.receive("error",()=>s("error")),f.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Xn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Yo.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new Kg(this,Yo.leave,{},e),a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Xn.closed,this.bindings={}}async _fetchWithTimeout(e,r,a){const n=new AbortController,s=setTimeout(()=>n.abort(),a),l=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(s),l}_push(e,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Kg(this,e,r,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>uA){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,a){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,a){var n,s;const l=e.toLocaleLowerCase(),{close:c,error:d,leave:f,join:m}=Yo;if(a&&[c,d,f,m].indexOf(l)>=0&&a!==this._joinRef())return;let x=this._onMessage(l,r,a);if(r&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(g=>{var b,_,w;return((b=g.filter)===null||b===void 0?void 0:b.event)==="*"||((w=(_=g.filter)===null||_===void 0?void 0:_.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===l}).map(g=>g.callback(x,a)):(s=this.bindings[l])===null||s===void 0||s.filter(g=>{var b,_,w,E,C,A;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in g){const O=g.id,G=(b=g.filter)===null||b===void 0?void 0:b.event;return O&&((_=r.ids)===null||_===void 0?void 0:_.includes(O))&&(G==="*"||G?.toLocaleLowerCase()===((w=r.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const O=(C=(E=g?.filter)===null||E===void 0?void 0:E.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return O==="*"||O===((A=r?.event)===null||A===void 0?void 0:A.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===l}).map(g=>{if(typeof x=="object"&&"ids"in x){const b=x.data,{schema:_,table:w,commit_timestamp:E,type:C,errors:A}=b;x=Object.assign(Object.assign({},{schema:_,table:w,commit_timestamp:E,eventType:C,new:{},old:{},errors:A}),this._getPayloadRecords(b))}g.callback(x,a)})}_isClosed(){return this.state===Xn.closed}_isJoined(){return this.state===Xn.joined}_isJoining(){return this.state===Xn.joining}_isLeaving(){return this.state===Xn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,a){const n=e.toLocaleLowerCase(),s={type:n,filter:r,callback:a};return this.bindings[n]?this.bindings[n].push(s):this.bindings[n]=[s],this}_off(e,r){const a=e.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var s;return!(((s=n.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===a&&Zx.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const a in e)if(e[a]!==r[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Yo.close,{},e)}_onError(e){this._on(Yo.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Xn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Pb(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Pb(e.columns,e.old_record)),r}}const Jg=()=>{},op={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},xA=[1e3,2e3,5e3,1e4],yA=1e4,_A=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class bA{constructor(e,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=lx,this.transport=null,this.heartbeatIntervalMs=op.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Jg,this.ref=0,this.reconnectTimer=null,this.vsn=Lb,this.logger=Jg,this.conn=null,this.sendBuffer=[],this.serializer=new dA,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...s)=>n(...s):(...s)=>fetch(...s),!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${cx.websocket}`,this.httpEndpoint=R4(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=sA.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,a){this.logger(e,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case ld.connecting:return cd.Connecting;case ld.open:return cd.Open;case ld.closing:return cd.Closing;default:return cd.Closed}}isConnected(){return this.connectionState()===cd.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const a=`realtime:${e}`,n=this.getChannels().find(s=>s.topic===a);if(n)return n;{const s=new Zx(`realtime:${e}`,r,this);return this.channels.push(s),s}}push(e){const{topic:r,event:a,payload:n,ref:s}=e,l=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${r} ${a} (${s})`,n),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(cA,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},op.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(a=>a.topic===e&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:n,payload:s,ref:l}=r,c=l?`(${l})`:"",d=s.status||"";this.log("receive",`${d} ${a} ${n} ${c}`.trim(),s),this.channels.filter(f=>f._isMember(a)).forEach(f=>f._trigger(n,s,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===ld.open||this.conn.readyState===ld.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Yo.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const a=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${a}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const a=new Blob([_A],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const n={access_token:r,version:oA};r&&a.updateJoinPayload(n),a.joinedOnce&&a._isJoined()&&a._push(Yo.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(a=>{try{a(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(a){this.log("error",`error triggering ${e} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new T4(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},op.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,a,n,s,l,c,d,f,m,v,x,g;switch(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=e?.timeout)!==null&&a!==void 0?a:lx,this.heartbeatIntervalMs=(n=e?.heartbeatIntervalMs)!==null&&n!==void 0?n:op.HEARTBEAT_INTERVAL,this.worker=(s=e?.worker)!==null&&s!==void 0?s:!1,this.accessToken=(l=e?.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(c=e?.heartbeatCallback)!==null&&c!==void 0?c:Jg,this.vsn=(d=e?.vsn)!==null&&d!==void 0?d:Lb,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=e?.reconnectAfterMs)!==null&&f!==void 0?f:(b=>xA[b-1]||yA),this.vsn){case C4:this.encode=(m=e?.encode)!==null&&m!==void 0?m:((b,_)=>_(JSON.stringify(b))),this.decode=(v=e?.decode)!==null&&v!==void 0?v:((b,_)=>_(JSON.parse(b)));break;case lA:this.encode=(x=e?.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(g=e?.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class g1 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function tn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class wA extends g1{constructor(e,r,a){super(e),this.name="StorageApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class dx extends g1{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const Qx=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),SA=()=>Response,fx=t=>{if(Array.isArray(t))return t.map(r=>fx(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,a])=>{const n=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[n]=fx(a)}),e},NA=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},jA=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t),Zg=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},kA=(t,e,r)=>rr(void 0,void 0,void 0,function*(){const a=yield SA();t instanceof a&&!r?.noResolveJson?t.json().then(n=>{const s=t.status||500,l=n?.statusCode||s+"";e(new wA(Zg(n),s,l))}).catch(n=>{e(new dx(Zg(n),n))}):e(new dx(Zg(t),t))}),EA=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"||!a?n:(NA(a)?(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(a)):n.body=a,e?.duplex&&(n.duplex=e.duplex),Object.assign(Object.assign({},n),r))};function J0(t,e,r,a,n,s){return rr(this,void 0,void 0,function*(){return new Promise((l,c)=>{t(r,EA(e,a,n,s)).then(d=>{if(!d.ok)throw d;return a?.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>kA(d,c,a))})})}function C0(t,e,r,a){return rr(this,void 0,void 0,function*(){return J0(t,"GET",e,r,a)})}function Vo(t,e,r,a,n){return rr(this,void 0,void 0,function*(){return J0(t,"POST",e,a,n,r)})}function hx(t,e,r,a,n){return rr(this,void 0,void 0,function*(){return J0(t,"PUT",e,a,n,r)})}function AA(t,e,r,a){return rr(this,void 0,void 0,function*(){return J0(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}function e2(t,e,r,a,n){return rr(this,void 0,void 0,function*(){return J0(t,"DELETE",e,a,n,r)})}class CA{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return rr(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(tn(e))return{data:null,error:e};throw e}})}}var D4;class TA{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[D4]="BlobDownloadBuilder",this.promise=null}asStream(){return new CA(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return rr(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(tn(e))return{data:null,error:e};throw e}})}}D4=Symbol.toStringTag;const OA={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Bb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class RA{constructor(e,r={},a,n){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=a,this.fetch=Qx(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,a,n){return rr(this,void 0,void 0,function*(){try{let s;const l=Object.assign(Object.assign({},Bb),n);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&a instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),d&&s.append("metadata",this.encodeMetadata(d)),s.append("",a)):typeof FormData<"u"&&a instanceof FormData?(s=a,s.has("cacheControl")||s.append("cacheControl",l.cacheControl),d&&!s.has("metadata")&&s.append("metadata",this.encodeMetadata(d))):(s=a,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!l.duplex&&(l.duplex="half")),n?.headers&&(c=Object.assign(Object.assign({},c),n.headers));const f=this._removeEmptyFolders(r),m=this._getFinalPath(f),v=yield(e=="PUT"?hx:Vo)(this.fetch,`${this.url}/object/${m}`,s,Object.assign({headers:c},l?.duplex?{duplex:l.duplex}:{}));return{data:{path:f,id:v.Id,fullPath:v.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(tn(s))return{data:null,error:s};throw s}})}upload(e,r,a){return rr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,a)})}uploadToSignedUrl(e,r,a,n){return rr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),l=this._getFinalPath(s),c=new URL(this.url+`/object/upload/sign/${l}`);c.searchParams.set("token",r);try{let d;const f=Object.assign({upsert:Bb.upsert},n),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&a instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",a)):typeof FormData<"u"&&a instanceof FormData?(d=a,d.append("cacheControl",f.cacheControl)):(d=a,m["cache-control"]=`max-age=${f.cacheControl}`,m["content-type"]=f.contentType);const v=yield hx(this.fetch,c.toString(),d,{headers:m});return{data:{path:s,fullPath:v.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(tn(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,r){return rr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e);const n=Object.assign({},this.headers);r?.upsert&&(n["x-upsert"]="true");const s=yield Vo(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:n}),l=new URL(this.url+s.url),c=l.searchParams.get("token");if(!c)throw new g1("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:c},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(tn(a))return{data:null,error:a};throw a}})}update(e,r,a){return rr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,a)})}move(e,r,a){return rr(this,void 0,void 0,function*(){try{return{data:yield Vo(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(tn(n))return{data:null,error:n};throw n}})}copy(e,r,a){return rr(this,void 0,void 0,function*(){try{return{data:{path:(yield Vo(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(tn(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,a){return rr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),s=yield Vo(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},a?.transform?{transform:a.transform}:{}),{headers:this.headers});const l=a?.download?`&download=${a.download===!0?"":a.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${l}`)},{data:s,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(tn(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,a){return rr(this,void 0,void 0,function*(){try{const n=yield Vo(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),s=a?.download?`&download=${a.download===!0?"":a.download}`:"";return{data:n.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${s}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(tn(n))return{data:null,error:n};throw n}})}download(e,r){const n=typeof r?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(r?.transform||{}),l=s?`?${s}`:"",c=this._getFinalPath(e),d=()=>C0(this.fetch,`${this.url}/${n}/${c}${l}`,{headers:this.headers,noResolveJson:!0});return new TA(d,this.shouldThrowOnError)}info(e){return rr(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const a=yield C0(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:fx(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(tn(a))return{data:null,error:a};throw a}})}exists(e){return rr(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield AA(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(tn(a)&&a instanceof dx){const n=a.originalError;if([400,404].includes(n?.status))return{data:!1,error:a}}throw a}})}getPublicUrl(e,r){const a=this._getFinalPath(e),n=[],s=r?.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&n.push(s);const c=typeof r?.transform<"u"?"render/image":"object",d=this.transformOptsToQueryString(r?.transform||{});d!==""&&n.push(d);let f=n.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${a}${f}`)}}}remove(e){return rr(this,void 0,void 0,function*(){try{return{data:yield e2(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}list(e,r,a){return rr(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},OA),r),{prefix:e||""});return{data:yield Vo(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},a),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(tn(n))return{data:null,error:n};throw n}})}listV2(e,r){return rr(this,void 0,void 0,function*(){try{const a=Object.assign({},e);return{data:yield Vo(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(tn(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const F4="2.86.0",L4={"X-Client-Info":`storage-js/${F4}`};class DA{constructor(e,r={},a,n){this.shouldThrowOnError=!1;const s=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},L4),r),this.fetch=Qx(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return rr(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield C0(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}getBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield C0(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}createBucket(e){return rr(this,arguments,void 0,function*(r,a={public:!1}){try{return{data:yield Vo(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(tn(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return rr(this,void 0,void 0,function*(){try{return{data:yield hx(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(tn(a))return{data:null,error:a};throw a}})}emptyBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield Vo(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}deleteBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield e2(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}var T0=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function FA(t,e,r){const a=new URL(e,t);if(r)for(const[n,s]of Object.entries(r))s!==void 0&&a.searchParams.set(n,s);return a.toString()}async function LA(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function PA(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:n,body:s,headers:l}){const c=FA(t.baseUrl,a,n),d=await LA(t.auth),f=await e(c,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...d,...l},body:s?JSON.stringify(s):void 0}),m=await f.text(),v=(f.headers.get("content-type")||"").includes("application/json"),x=v&&m?JSON.parse(m):m;if(!f.ok){const g=v?x:void 0,b=g?.error;throw new T0(b?.message??`Request failed with status ${f.status}`,{status:f.status,icebergType:b?.type,icebergCode:b?.code,details:g})}return{status:f.status,headers:f.headers,data:x}}}}function lp(t){return t.join("")}var MA=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:lp(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${lp(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${lp(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${lp(t.namespace)}`}),!0}catch(e){if(e instanceof T0&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof T0&&r.status===409)return;throw r}}};function Of(t){return t.join("")}var IA=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Of(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Of(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Of(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Of(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Of(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Of(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof T0&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof T0&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},BA=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=PA({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new MA(this.client,e),this.tableOps=new IA(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}};class UA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},L4),r),this.fetch=Qx(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield Vo(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}listBuckets(e){return rr(this,void 0,void 0,function*(){try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const a=r.toString(),n=a?`${this.url}/bucket?${a}`:`${this.url}/bucket`;return{data:yield C0(this.fetch,n,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}deleteBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield e2(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(tn(r))return{data:null,error:r};throw r}})}from(e){if(!jA(e))throw new g1("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");return new BA({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>rr(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch})}}const t2={"X-Client-Info":`storage-js/${F4}`,"Content-Type":"application/json"};class P4 extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Li(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class Qg extends P4{constructor(e,r,a){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class qA extends P4{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var Ub;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Ub||(Ub={}));const r2=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),zA=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},qb=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),HA=(t,e,r)=>rr(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!r?.noResolveJson){const n=t.status||500,s=t;if(typeof s.json=="function")s.json().then(l=>{const c=l?.statusCode||l?.code||n+"";e(new Qg(qb(l),n,c))}).catch(()=>{const l=n+"",c=s.statusText||`HTTP ${n} error`;e(new Qg(c,n,l))});else{const l=n+"",c=s.statusText||`HTTP ${n} error`;e(new Qg(c,n,l))}}else e(new qA(qb(t),t))}),$A=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return a?(zA(a)?(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(a)):n.body=a,Object.assign(Object.assign({},n),r)):n};function WA(t,e,r,a,n,s){return rr(this,void 0,void 0,function*(){return new Promise((l,c)=>{t(r,$A(e,a,n,s)).then(d=>{if(!d.ok)throw d;if(a?.noResolveJson)return d;const f=d.headers.get("content-type");return!f||!f.includes("application/json")?{}:d.json()}).then(d=>l(d)).catch(d=>HA(d,c,a))})})}function Pi(t,e,r,a,n){return rr(this,void 0,void 0,function*(){return WA(t,"POST",e,a,n,r)})}class VA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},t2),r),this.fetch=r2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return rr(this,void 0,void 0,function*(){try{return{data:(yield Pi(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}getIndex(e,r){return rr(this,void 0,void 0,function*(){try{return{data:yield Pi(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Li(a))return{data:null,error:a};throw a}})}listIndexes(e){return rr(this,void 0,void 0,function*(){try{return{data:yield Pi(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return rr(this,void 0,void 0,function*(){try{return{data:(yield Pi(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Li(a))return{data:null,error:a};throw a}})}}class GA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},t2),r),this.fetch=r2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return rr(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Pi(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}getVectors(e){return rr(this,void 0,void 0,function*(){try{return{data:yield Pi(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}listVectors(e){return rr(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Pi(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}queryVectors(e){return rr(this,void 0,void 0,function*(){try{return{data:yield Pi(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}deleteVectors(e){return rr(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Pi(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}}class YA{constructor(e,r={},a){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},t2),r),this.fetch=r2(a)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:(yield Pi(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}getBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield Pi(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}listBuckets(){return rr(this,arguments,void 0,function*(e={}){try{return{data:yield Pi(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}deleteBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:(yield Pi(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Li(r))return{data:null,error:r};throw r}})}}class XA extends YA{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new KA(this.url,this.headers,e,this.fetch)}createBucket(e){const r=Object.create(null,{createBucket:{get:()=>super.createBucket}});return rr(this,void 0,void 0,function*(){return r.createBucket.call(this,e)})}getBucket(e){const r=Object.create(null,{getBucket:{get:()=>super.getBucket}});return rr(this,void 0,void 0,function*(){return r.getBucket.call(this,e)})}listBuckets(){const e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return rr(this,arguments,void 0,function*(r={}){return e.listBuckets.call(this,r)})}deleteBucket(e){const r=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return rr(this,void 0,void 0,function*(){return r.deleteBucket.call(this,e)})}}class KA extends VA{constructor(e,r,a,n){super(e,r,n),this.vectorBucketName=a}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return rr(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return rr(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return rr(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return rr(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new JA(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class JA extends GA{constructor(e,r,a,n,s){super(e,r,s),this.vectorBucketName=a,this.indexName=n}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return rr(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return rr(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return rr(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return rr(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return rr(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class ZA extends DA{constructor(e,r={},a,n){super(e,r,a,n)}from(e){return new RA(this.url,this.headers,e,this.fetch)}get vectors(){return new XA(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new UA(this.url+"/iceberg",this.headers,this.fetch)}}const QA="2.86.0";let d0="";typeof Deno<"u"?d0="deno":typeof document<"u"?d0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?d0="react-native":d0="node";const e6={"X-Client-Info":`supabase-js-${d0}/${QA}`},t6={headers:e6},r6={schema:"public"},a6={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},n6={},s6=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),i6=()=>Headers,o6=(t,e,r)=>{const a=s6(r),n=i6();return async(s,l)=>{var c;const d=(c=await e())!==null&&c!==void 0?c:t;let f=new n(l?.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),a(s,Object.assign(Object.assign({},l),{headers:f}))}};function l6(t){return t.endsWith("/")?t:t+"/"}function c6(t,e){var r,a;const{db:n,auth:s,realtime:l,global:c}=t,{db:d,auth:f,realtime:m,global:v}=e,x={db:Object.assign(Object.assign({},d),n),auth:Object.assign(Object.assign({},f),s),realtime:Object.assign(Object.assign({},m),l),storage:{},global:Object.assign(Object.assign(Object.assign({},v),c),{headers:Object.assign(Object.assign({},(r=v?.headers)!==null&&r!==void 0?r:{}),(a=c?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return t.accessToken?x.accessToken=t.accessToken:delete x.accessToken,x}function u6(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(l6(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const M4="2.86.0",$f=30*1e3,mx=3,ev=mx*$f,d6="http://localhost:9999",f6="supabase.auth.token",h6={"X-Client-Info":`gotrue-js/${M4}`},px="X-Supabase-Api-Version",I4={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},m6=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,p6=600*1e3;class O0 extends Error{constructor(e,r,a){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function dr(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class g6 extends O0{constructor(e,r,a){super(e,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function v6(t){return dr(t)&&t.name==="AuthApiError"}class ud extends O0{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Su extends O0{constructor(e,r,a,n){super(e,a,n),this.name=r,this.status=a}}class Ri extends Su{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function x6(t){return dr(t)&&t.name==="AuthSessionMissingError"}class Rf extends Su{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cp extends Su{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class up extends Su{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function y6(t){return dr(t)&&t.name==="AuthImplicitGrantRedirectError"}class zb extends Su{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class gx extends Su{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function tv(t){return dr(t)&&t.name==="AuthRetryableFetchError"}class Hb extends Su{constructor(e,r,a){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class vx extends Su{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Vp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),$b=` 	
\r=`.split(""),_6=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<$b.length;e+=1)t[$b[e].charCodeAt(0)]=-2;for(let e=0;e<Vp.length;e+=1)t[Vp[e].charCodeAt(0)]=e;return t})();function Wb(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;r(Vp[a]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;r(Vp[a]),e.queuedBits-=6}}function B4(t,e,r){const a=_6[t];if(a>-1)for(e.queue=e.queue<<6|a,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Vb(t){const e=[],r=l=>{e.push(String.fromCodePoint(l))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},s=l=>{S6(l,a,r)};for(let l=0;l<t.length;l+=1)B4(t.charCodeAt(l),n,s);return e.join("")}function b6(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function w6(t,e){for(let r=0;r<t.length;r+=1){let a=t.charCodeAt(r);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}b6(a,e)}}function S6(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let a=1;a<6;a+=1)if((t>>7-a&1)===0){e.utf8seq=a;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Zf(t){const e=[],r={queue:0,queuedBits:0},a=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)B4(t.charCodeAt(n),r,a);return new Uint8Array(e)}function N6(t){const e=[];return w6(t,r=>e.push(r)),new Uint8Array(e)}function hd(t){const e=[],r={queue:0,queuedBits:0},a=n=>{e.push(n)};return t.forEach(n=>Wb(n,r,a)),Wb(null,r,a),e.join("")}function j6(t){return Math.round(Date.now()/1e3)+t}function k6(){return Symbol("auth-callback")}const vs=()=>typeof window<"u"&&typeof document<"u",td={tested:!1,writable:!1},U4=()=>{if(!vs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(td.tested)return td.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),td.tested=!0,td.writable=!0}catch{td.tested=!0,td.writable=!1}return td.writable};function E6(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,s)=>{e[s]=n})}catch{}return r.searchParams.forEach((a,n)=>{e[n]=a}),e}const q4=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),A6=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Wf=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},rd=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},su=async(t,e)=>{await t.removeItem(e)};class v1{constructor(){this.promise=new v1.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}v1.promiseConstructor=Promise;function rv(t){const e=t.split(".");if(e.length!==3)throw new vx("Invalid JWT structure");for(let a=0;a<e.length;a++)if(!m6.test(e[a]))throw new vx("JWT not in base64url format");return{header:JSON.parse(Vb(e[0])),payload:JSON.parse(Vb(e[1])),signature:Zf(e[2]),raw:{header:e[0],payload:e[1]}}}async function C6(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function T6(t,e){return new Promise((a,n)=>{(async()=>{for(let s=0;s<1/0;s++)try{const l=await t(s);if(!e(s,null,l)){a(l);return}}catch(l){if(!e(s,l)){n(l);return}}})()})}function O6(t){return("0"+t.toString(16)).substr(-2)}function R6(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let n="";for(let s=0;s<56;s++)n+=r.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(e),Array.from(e,O6).join("")}async function D6(t){const r=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(a);return Array.from(n).map(s=>String.fromCharCode(s)).join("")}async function F6(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await D6(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Df(t,e,r=!1){const a=R6();let n=a;r&&(n+="/PASSWORD_RECOVERY"),await Wf(t,`${e}-code-verifier`,n);const s=await F6(a);return[s,a===s?"plain":"s256"]}const L6=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function P6(t){const e=t.headers.get(px);if(!e||!e.match(L6))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function M6(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function I6(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const B6=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ff(t){if(!B6.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function av(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function U6(t,e){return new Proxy(t,{get:(r,a,n)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const s=a.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,n)}return!e.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,a,n)}})}function Gb(t){return JSON.parse(JSON.stringify(t))}const id=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),q6=[502,503,504];async function Yb(t){var e;if(!A6(t))throw new gx(id(t),0);if(q6.includes(t.status))throw new gx(id(t),t.status);let r;try{r=await t.json()}catch(s){throw new ud(id(s),s)}let a;const n=P6(t);if(n&&n.getTime()>=I4["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new Hb(id(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(a==="session_not_found")throw new Ri}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0))throw new Hb(id(r),t.status,r.weak_password.reasons);throw new g6(id(r),t.status||500,a)}const z6=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),r))};async function br(t,e,r,a){var n;const s=Object.assign({},a?.headers);s[px]||(s[px]=I4["2024-01-01"].name),a?.jwt&&(s.Authorization=`Bearer ${a.jwt}`);const l=(n=a?.query)!==null&&n!==void 0?n:{};a?.redirectTo&&(l.redirect_to=a.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await H6(t,e,r+c,{headers:s,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(d):{data:Object.assign({},d),error:null}}async function H6(t,e,r,a,n,s){const l=z6(e,a,n,s);let c;try{c=await t(r,Object.assign({},l))}catch(d){throw console.error(d),new gx(id(d),0)}if(c.ok||await Yb(c),a?.noResolveJson)return c;try{return await c.json()}catch(d){await Yb(d)}}function Wo(t){var e;let r=null;V6(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=j6(t.expires_in)));const a=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:a},error:null}}function Xb(t){const e=Wo(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(e.data.weak_password=t.weak_password),e}function hu(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function $6(t){return{data:t,error:null}}function W6(t){const{action_link:e,email_otp:r,hashed_token:a,redirect_to:n,verification_type:s}=t,l=hh(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:r,hashed_token:a,redirect_to:n,verification_type:s},d=Object.assign({},l);return{data:{properties:c,user:d},error:null}}function Kb(t){return t}function V6(t){return t.access_token&&t.refresh_token&&t.expires_in}const nv=["global","local","others"];class G6{constructor({url:e="",headers:r={},fetch:a}){this.url=e,this.headers=r,this.fetch=q4(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=nv[0]){if(nv.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${nv.join(", ")}`);try{return await br(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(a){if(dr(a))return{data:null,error:a};throw a}}async inviteUserByEmail(e,r={}){try{return await br(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:hu})}catch(a){if(dr(a))return{data:{user:null},error:a};throw a}}async generateLink(e){try{const{options:r}=e,a=hh(e,["options"]),n=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(n.new_email=a?.newEmail,delete n.newEmail),await br(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:W6,redirectTo:r?.redirectTo})}catch(r){if(dr(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await br(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:hu})}catch(r){if(dr(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,a,n,s,l,c,d;try{const f={nextPage:null,lastPage:0,total:0},m=await br(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(s=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""},xform:Kb});if(m.error)throw m.error;const v=await m.json(),x=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,g=(d=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return g.length>0&&(g.forEach(b=>{const _=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(b.split(";")[1].split("=")[1]);f[`${w}Page`]=_}),f.total=parseInt(x)),{data:Object.assign(Object.assign({},v),f),error:null}}catch(f){if(dr(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){Ff(e);try{return await br(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:hu})}catch(r){if(dr(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Ff(e);try{return await br(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:hu})}catch(a){if(dr(a))return{data:{user:null},error:a};throw a}}async deleteUser(e,r=!1){Ff(e);try{return await br(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:hu})}catch(a){if(dr(a))return{data:{user:null},error:a};throw a}}async _listFactors(e){Ff(e.userId);try{const{data:r,error:a}=await br(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:a}}catch(r){if(dr(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Ff(e.userId),Ff(e.id);try{return{data:await br(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(dr(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,a,n,s,l,c,d;try{const f={nextPage:null,lastPage:0,total:0},m=await br(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(s=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""},xform:Kb});if(m.error)throw m.error;const v=await m.json(),x=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,g=(d=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return g.length>0&&(g.forEach(b=>{const _=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(b.split(";")[1].split("=")[1]);f[`${w}Page`]=_}),f.total=parseInt(x)),{data:Object.assign(Object.assign({},v),f),error:null}}catch(f){if(dr(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(e){try{return await br(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(dr(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await br(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(dr(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await br(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(dr(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(e){try{return await br(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(dr(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await br(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(dr(r))return{data:null,error:r};throw r}}}function Jb(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const Lf={debug:!!(globalThis&&U4()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class z4 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Y6 extends z4{}async function X6(t,e,r){Lf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const a=new globalThis.AbortController;return e>0&&setTimeout(()=>{a.abort(),Lf.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){Lf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{Lf.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Lf.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Y6(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Lf.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function K6(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function H4(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function J6(t){return parseInt(t,16)}function Z6(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,a=>a.toString(16).padStart(2,"0")).join("")}function Q6(t){var e;const{chainId:r,domain:a,expirationTime:n,issuedAt:s=new Date,nonce:l,notBefore:c,requestId:d,resources:f,scheme:m,uri:v,version:x}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!v)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const g=H4(t.address),b=m?`${m}://${a}`:a,_=t.statement?`${t.statement}
`:"",w=`${b} wants you to sign in with your Ethereum account:
${g}

${_}`;let E=`URI: ${v}
Version: ${x}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${s.toISOString()}`;if(n&&(E+=`
Expiration Time: ${n.toISOString()}`),c&&(E+=`
Not Before: ${c.toISOString()}`),d&&(E+=`
Request ID: ${d}`),f){let C=`
Resources:`;for(const A of f){if(!A||typeof A!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${A}`);C+=`
- ${A}`}E+=C}return`${w}
${E}`}class Bn extends Error{constructor({message:e,code:r,cause:a,name:n}){var s;super(e,{cause:a}),this.__isWebAuthnError=!0,this.name=(s=n??(a instanceof Error?a.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class Gp extends Bn{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function eC({error:t,options:e}){var r,a,n;const{publicKey:s}=e;if(!s)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Bn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Bn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((a=s.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Bn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Bn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Bn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Bn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return s.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new Bn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Bn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const l=window.location.hostname;if($4(l)){if(s.rp.id!==l)return new Bn({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Bn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Bn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Bn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Bn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function tC({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Bn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Bn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if($4(a)){if(r.rpId!==a)return new Bn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Bn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Bn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Bn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class rC{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const aC=new rC;function nC(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:a}=t,n=hh(t,["challenge","user","excludeCredentials"]),s=Zf(e).buffer,l=Object.assign(Object.assign({},r),{id:Zf(r.id).buffer}),c=Object.assign(Object.assign({},n),{challenge:s,user:l});if(a&&a.length>0){c.excludeCredentials=new Array(a.length);for(let d=0;d<a.length;d++){const f=a[d];c.excludeCredentials[d]=Object.assign(Object.assign({},f),{id:Zf(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return c}function sC(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,a=hh(t,["challenge","allowCredentials"]),n=Zf(e).buffer,s=Object.assign(Object.assign({},a),{challenge:n});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const c=r[l];s.allowCredentials[l]=Object.assign(Object.assign({},c),{id:Zf(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return s}function iC(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:hd(new Uint8Array(t.response.attestationObject)),clientDataJSON:hd(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function oC(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,a=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:hd(new Uint8Array(n.authenticatorData)),clientDataJSON:hd(new Uint8Array(n.clientDataJSON)),signature:hd(new Uint8Array(n.signature)),userHandle:n.userHandle?hd(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function $4(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Zb(){var t,e;return!!(vs()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function lC(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Gp("Browser returned unexpected credential type",e)}:{data:null,error:new Gp("Empty credential response",e)}}catch(e){return{data:null,error:eC({error:e,options:t})}}}async function cC(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Gp("Browser returned unexpected credential type",e)}:{data:null,error:new Gp("Empty credential response",e)}}catch(e){return{data:null,error:tC({error:e,options:t})}}}const uC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},dC={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Yp(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),a={};for(const n of t)if(n)for(const s in n){const l=n[s];if(l!==void 0)if(Array.isArray(l))a[s]=l;else if(r(l))a[s]=l;else if(e(l)){const c=a[s];e(c)?a[s]=Yp(c,l):a[s]=Yp(l)}else a[s]=l}return a}function fC(t,e){return Yp(uC,t,e||{})}function hC(t,e){return Yp(dC,t,e||{})}class mC{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:a,signal:n},s){try{const{data:l,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!l)return{data:null,error:c};const d=n??aC.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:f}=l.webauthn.credential_options.publicKey;f.name||(f.name=`${f.id}:${a}`),f.displayName||(f.displayName=f.name)}switch(l.webauthn.type){case"create":{const f=fC(l.webauthn.credential_options.publicKey,s?.create),{data:m,error:v}=await lC({publicKey:f,signal:d});return m?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:v}}case"request":{const f=hC(l.webauthn.credential_options.publicKey,s?.request),{data:m,error:v}=await cC(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:f,signal:d}));return m?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:v}}}}catch(l){return dr(l)?{data:null,error:l}:{data:null,error:new ud("Unexpected error in challenge",l)}}}async _verify({challengeId:e,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:a})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},s){if(!r)return{data:null,error:new O0("rpId is required for WebAuthn authentication")};try{if(!Zb())return{data:null,error:new ud("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:a},signal:n},{request:s});if(!l)return{data:null,error:c};const{webauthn:d}=l;return this._verify({factorId:e,challengeId:l.challengeId,webauthn:{type:d.type,rpId:r,rpOrigins:a,credential_response:d.credential_response}})}catch(l){return dr(l)?{data:null,error:l}:{data:null,error:new ud("Unexpected error in authenticate",l)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},s){if(!r)return{data:null,error:new O0("rpId is required for WebAuthn registration")};try{if(!Zb())return{data:null,error:new ud("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this._enroll({friendlyName:e});if(!l)return await this.client.mfa.listFactors().then(m=>{var v;return(v=m.data)===null||v===void 0?void 0:v.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===e&&x.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m?.id}):void 0),{data:null,error:c};const{data:d,error:f}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:n},{create:s});return d?this._verify({factorId:l.id,challengeId:d.challengeId,webauthn:{rpId:r,rpOrigins:a,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:f}}catch(l){return dr(l)?{data:null,error:l}:{data:null,error:new ud("Unexpected error in register",l)}}}}K6();const pC={url:d6,storageKey:f6,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:h6,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Qb(t,e,r){return await r()}const Pf={};class R0{get jwks(){var e,r;return(r=(e=Pf[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Pf[this.storageKey]=Object.assign(Object.assign({},Pf[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Pf[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Pf[this.storageKey]=Object.assign(Object.assign({},Pf[this.storageKey]),{cachedAt:e})}constructor(e){var r,a,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},pC),e);if(this.storageKey=s.storageKey,this.instanceID=(r=R0.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,R0.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&vs()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new G6({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=q4(s.fetch),this.lock=s.lock||Qb,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,s.lock?this.lock=s.lock:vs()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=X6:this.lock=Qb,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new mC(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:U4()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Jb(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Jb(this.memoryStorage)),vs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${M4}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},a="none";if(vs()&&(r=E6(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),vs()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:s}=await this._getSessionFromURL(r,a);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),y6(s)){const d=(e=s.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:l,redirectType:c}=n;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return dr(r)?this._returnResult({error:r}):this._returnResult({error:new ud("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,a,n;try{const s=await br(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Wo}),{data:l,error:c}=s;if(c||!l)return this._returnResult({data:{user:null,session:null},error:c});const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(s){if(dr(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(e){var r,a,n;try{let s;if("email"in e){const{email:m,password:v,options:x}=e;let g=null,b=null;this.flowType==="pkce"&&([g,b]=await Df(this.storage,this.storageKey)),s=await br(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x?.emailRedirectTo,body:{email:m,password:v,data:(r=x?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:g,code_challenge_method:b},xform:Wo})}else if("phone"in e){const{phone:m,password:v,options:x}=e;s=await br(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:v,data:(a=x?.data)!==null&&a!==void 0?a:{},channel:(n=x?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:Wo})}else throw new cp("You must provide either an email or phone number and a password");const{data:l,error:c}=s;if(c||!l)return this._returnResult({data:{user:null,session:null},error:c});const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(s){if(dr(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(e){try{let r;if("email"in e){const{email:s,password:l,options:c}=e;r=await br(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Xb})}else if("phone"in e){const{phone:s,password:l,options:c}=e;r=await br(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Xb})}else throw new cp("You must provide either an email or phone number and a password");const{data:a,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!a||!a.session||!a.user){const s=new Rf;return this._returnResult({data:{user:null,session:null},error:s})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(r){if(dr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,a,n,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,a,n,s,l,c,d,f,m,v,x;let g,b;if("message"in e)g=e.message,b=e.signature;else{const{chain:_,wallet:w,statement:E,options:C}=e;let A;if(vs())if(typeof w=="object")A=w;else{const L=window;if("ethereum"in L&&typeof L.ethereum=="object"&&"request"in L.ethereum&&typeof L.ethereum.request=="function")A=L.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");A=w}const O=new URL((r=C?.url)!==null&&r!==void 0?r:window.location.href),G=await A.request({method:"eth_requestAccounts"}).then(L=>L).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!G||G.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const W=H4(G[0]);let B=(a=C?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!B){const L=await A.request({method:"eth_chainId"});B=J6(L)}const q={domain:O.host,address:W,statement:E,uri:O.href,version:"1",chainId:B,nonce:(n=C?.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(l=(s=C?.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(c=C?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(d=C?.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(f=C?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(m=C?.signInWithEthereum)===null||m===void 0?void 0:m.resources};g=Q6(q),b=await A.request({method:"personal_sign",params:[Z6(g),W]})}try{const{data:_,error:w}=await br(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:b},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Wo});if(w)throw w;if(!_||!_.session||!_.user){const E=new Rf;return this._returnResult({data:{user:null,session:null},error:E})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:w})}catch(_){if(dr(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var r,a,n,s,l,c,d,f,m,v,x,g;let b,_;if("message"in e)b=e.message,_=e.signature;else{const{chain:w,wallet:E,statement:C,options:A}=e;let O;if(vs())if(typeof E=="object")O=E;else{const W=window;if("solana"in W&&typeof W.solana=="object"&&("signIn"in W.solana&&typeof W.solana.signIn=="function"||"signMessage"in W.solana&&typeof W.solana.signMessage=="function"))O=W.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!A?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=E}const G=new URL((r=A?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in O&&O.signIn){const W=await O.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},A?.signInWithSolana),{version:"1",domain:G.host,uri:G.href}),C?{statement:C}:null));let B;if(Array.isArray(W)&&W[0]&&typeof W[0]=="object")B=W[0];else if(W&&typeof W=="object"&&"signedMessage"in W&&"signature"in W)B=W;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in B&&"signature"in B&&(typeof B.signedMessage=="string"||B.signedMessage instanceof Uint8Array)&&B.signature instanceof Uint8Array)b=typeof B.signedMessage=="string"?B.signedMessage:new TextDecoder().decode(B.signedMessage),_=B.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in O)||typeof O.signMessage!="function"||!("publicKey"in O)||typeof O!="object"||!O.publicKey||!("toBase58"in O.publicKey)||typeof O.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${G.host} wants you to sign in with your Solana account:`,O.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${G.href}`,`Issued At: ${(n=(a=A?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((s=A?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${A.signInWithSolana.notBefore}`]:[],...!((l=A?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${A.signInWithSolana.expirationTime}`]:[],...!((c=A?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${A.signInWithSolana.chainId}`]:[],...!((d=A?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${A.signInWithSolana.nonce}`]:[],...!((f=A?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${A.signInWithSolana.requestId}`]:[],...!((v=(m=A?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||v===void 0)&&v.length?["Resources",...A.signInWithSolana.resources.map(B=>`- ${B}`)]:[]].join(`
`);const W=await O.signMessage(new TextEncoder().encode(b),"utf8");if(!W||!(W instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=W}}try{const{data:w,error:E}=await br(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:hd(_)},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Wo});if(E)throw E;if(!w||!w.session||!w.user){const C=new Rf;return this._returnResult({data:{user:null,session:null},error:C})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:E})}catch(w){if(dr(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async _exchangeCodeForSession(e){const r=await rd(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(r??"").split("/");try{const{data:s,error:l}=await br(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:a},xform:Wo});if(await su(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!s||!s.session||!s.user){const c=new Rf;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:n??null}),error:l})}catch(s){if(dr(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(e){try{const{options:r,provider:a,token:n,access_token:s,nonce:l}=e,c=await br(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Wo}),{data:d,error:f}=c;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!d||!d.session||!d.user){const m=new Rf;return this._returnResult({data:{user:null,session:null},error:m})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:f})}catch(r){if(dr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,a,n,s,l;try{if("email"in e){const{email:c,options:d}=e;let f=null,m=null;this.flowType==="pkce"&&([f,m]=await Df(this.storage,this.storageKey));const{error:v}=await br(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=d?.data)!==null&&r!==void 0?r:{},create_user:(a=d?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:m},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:v})}if("phone"in e){const{phone:c,options:d}=e,{data:f,error:m}=await br(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(n=d?.data)!==null&&n!==void 0?n:{},create_user:(s=d?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(l=d?.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:m})}throw new cp("You must provide either an email or phone number.")}catch(c){if(dr(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var r,a;try{let n,s;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,s=(a=e.options)===null||a===void 0?void 0:a.captchaToken);const{data:l,error:c}=await br(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:n,xform:Wo});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,f=l.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(n){if(dr(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,a,n,s,l;try{let c=null,d=null;this.flowType==="pkce"&&([c,d]=await Df(this.storage,this.storageKey));const f=await br(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(a=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:d}),headers:this.headers,xform:$6});return!((s=f.data)===null||s===void 0)&&s.url&&vs()&&!(!((l=e.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(f.data.url),this._returnResult(f)}catch(c){if(dr(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:a}=e;if(a)throw a;if(!r)throw new Ri;const{error:n}=await br(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(dr(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:a,type:n,options:s}=e,{error:l}=await br(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in e){const{phone:a,type:n,options:s}=e,{data:l,error:c}=await br(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l?.message_id},error:c})}throw new cp("You must provide either an email or phone number and a type")}catch(r){if(dr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await rd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const a=e.expires_at?e.expires_at*1e3-Date.now()<ev:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",e.expires_at),!a){if(this.userStorage){const l=await rd(this.userStorage,this.storageKey+"-user");l?.user?e.user=l.user:e.user=av()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};e.user=U6(e.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await br(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:hu}):await this._useSession(async r=>{var a,n,s;const{data:l,error:c}=r;if(c)throw c;return!(!((a=l.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ri}:await br(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0,xform:hu})})}catch(r){if(dr(r))return x6(r)&&(await this._removeSession(),await su(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async a=>{const{data:n,error:s}=a;if(s)throw s;if(!n.session)throw new Ri;const l=n.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await Df(this.storage,this.storageKey));const{data:f,error:m}=await br(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:hu});if(m)throw m;return l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(a){if(dr(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ri;const r=Date.now()/1e3;let a=r,n=!0,s=null;const{payload:l}=rv(e.access_token);if(l.exp&&(a=l.exp,n=a<=r),n){const{data:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c)return{data:{user:null,session:null},error:null};s=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;s={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(dr(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var a;if(!e){const{data:l,error:c}=r;if(c)throw c;e=(a=l.session)!==null&&a!==void 0?a:void 0}if(!e?.refresh_token)throw new Ri;const{data:n,error:s}=await this._callRefreshToken(e.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(dr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!vs())throw new up("No browser detected.");if(e.error||e.error_description||e.error_code)throw new up(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new zb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new up("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new zb("No code detected.");const{data:C,error:A}=await this._exchangeCodeForSession(e.code);if(A)throw A;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:s,refresh_token:l,expires_in:c,expires_at:d,token_type:f}=e;if(!s||!c||!l||!f)throw new up("No session defined in URL");const m=Math.round(Date.now()/1e3),v=parseInt(c);let x=m+v;d&&(x=parseInt(d));const g=x-m;g*1e3<=$f&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${v}s`);const b=x-v;m-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,x,m):m-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,x,m);const{data:_,error:w}=await this._getUser(s);if(w)throw w;const E={provider_token:a,provider_refresh_token:n,access_token:s,expires_in:v,expires_at:x,refresh_token:l,token_type:f,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:E,redirectType:e.type},error:null})}catch(a){if(dr(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await rd(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return this._returnResult({error:s});const l=(a=n.session)===null||a===void 0?void 0:a.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(v6(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await su(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=k6(),a={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(e){return await this._useSession(async r=>{var a,n;try{const{data:{session:s},error:l}=r;if(l)throw l;await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,r={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await Df(this.storage,this.storageKey,!0));try{return await br(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(dr(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var e;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(dr(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:a,error:n}=await this._useSession(async s=>{var l,c,d,f,m;const{data:v,error:x}=s;if(x)throw x;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await br(this.fetch,"GET",g,{headers:this.headers,jwt:(m=(f=v.session)===null||f===void 0?void 0:f.access_token)!==null&&m!==void 0?m:void 0})});if(n)throw n;return vs()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:e.provider,url:a?.url},error:null})}catch(a){if(dr(a))return this._returnResult({data:{provider:e.provider,url:null},error:a});throw a}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var a;try{const{error:n,data:{session:s}}=r;if(n)throw n;const{options:l,provider:c,token:d,access_token:f,nonce:m}=e,v=await br(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=s?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:c,id_token:d,access_token:f,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Wo}),{data:x,error:g}=v;return g?this._returnResult({data:{user:null,session:null},error:g}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new Rf}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:g}))}catch(n){if(dr(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var a,n;const{data:s,error:l}=r;if(l)throw l;return await br(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(dr(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await T6(async n=>(n>0&&await C6(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await br(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Wo})),(n,s)=>{const l=200*Math.pow(2,n);return s&&tv(s)&&Date.now()+l-a<$f})}catch(a){if(this._debug(r,"error",a),dr(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",a),vs()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:e,url:a},error:null}}async _recoverAndRefresh(){var e,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await rd(this.storage,this.storageKey);if(n&&this.userStorage){let l=await rd(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:n.user},await Wf(this.userStorage,this.storageKey+"-user",l)),n.user=(e=l?.user)!==null&&e!==void 0?e:av()}else if(n&&!n.user&&!n.user){const l=await rd(this.storage,this.storageKey+"-user");l&&l?.user?(n.user=l.user,await su(this.storage,this.storageKey+"-user"),await Wf(this.storage,this.storageKey,n)):n.user=av()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const s=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<ev;if(this._debug(a,`session has${s?"":" not"} expired with margin of ${ev}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:l}=await this._callRefreshToken(n.refresh_token);l&&(console.error(l),tv(l)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:c}=await this._getUser(n.access_token);!c&&l?.user?(n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(a,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n),console.error(n);return}finally{this._debug(a,"end")}}async _callRefreshToken(e){var r,a;if(!e)throw new Ri;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new v1;const{data:s,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!s.session)throw new Ri;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const c={data:s.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(s){if(this._debug(n,"error",s),dr(s)){const l={data:null,error:s};return tv(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(s),s}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,a=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:e,session:r});const s=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,r)}catch(d){s.push(d)}});if(await Promise.all(l),s.length>0){for(let c=0;c<s.length;c+=1)console.error(s[c]);throw s[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await Wf(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const s=Gb(n);await Wf(this.storage,this.storageKey,s)}else{const n=Gb(r);await Wf(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await su(this.storage,this.storageKey),await su(this.storage,this.storageKey+"-code-verifier"),await su(this.storage,this.storageKey+"-user"),this.userStorage&&await su(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&vs()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),$f);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-e)/$f);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${$f}ms, refresh threshold is ${mx} ticks`),n<=mx&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof z4)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!vs()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,a){const n=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[s,l]=await Df(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});n.push(c.toString())}if(a?.queryParams){const s=new URLSearchParams(a.queryParams);n.push(s.toString())}return a?.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;return s?this._returnResult({data:null,error:s}):await br(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(dr(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var a,n;const{data:s,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:d,error:f}=await br(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});return f?this._returnResult({data:null,error:f}):(e.factorType==="totp"&&d.type==="totp"&&(!((n=d?.totp)===null||n===void 0)&&n.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(r){if(dr(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?iC(e.webauthn.credential_response):oC(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:d}=await br(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:l,headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:d}))})}catch(r){if(dr(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:s}=r;if(s)return this._returnResult({data:null,error:s});const l=await br(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token});if(l.error)return l;const{data:c}=l;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:nC(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:sC(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(dr(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:a}=await this._challenge({factorId:e.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const n={all:[],phone:[],totp:[],webauthn:[]};for(const s of(e=r?.factors)!==null&&e!==void 0?e:[])n.all.push(s),s.status==="verified"&&n[s.factor_type].push(s);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:a},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=rv(a.access_token);let l=null;s.aal&&(l=s.aal);let c=l;((r=(e=a.user.factors)===null||e===void 0?void 0:e.filter(m=>m.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const f=s.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?await br(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:a.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Ri})})}catch(r){if(dr(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async a=>{const{data:{session:n},error:s}=a;if(s)return this._returnResult({data:null,error:s});if(!n)return this._returnResult({data:null,error:new Ri});const l=await br(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&vs()&&!r?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(a){if(dr(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(e,r){try{return await this._useSession(async a=>{const{data:{session:n},error:s}=a;if(s)return this._returnResult({data:null,error:s});if(!n)return this._returnResult({data:null,error:new Ri});const l=await br(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&vs()&&!r?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(a){if(dr(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:a}=e;return a?this._returnResult({data:null,error:a}):r?await br(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new Ri})})}catch(e){if(dr(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?(await br(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ri})})}catch(r){if(dr(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let a=r.keys.find(c=>c.kid===e);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(c=>c.kid===e),a&&this.jwks_cached_at+p6>n)return a;const{data:s,error:l}=await br(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=n,a=s.keys.find(c=>c.kid===e),!a)?null:a}async getClaims(e,r={}){try{let a=e;if(!a){const{data:g,error:b}=await this.getSession();if(b||!g.session)return this._returnResult({data:null,error:b});a=g.session.access_token}const{header:n,payload:s,signature:l,raw:{header:c,payload:d}}=rv(a);r?.allowExpired||M6(s.exp);const f=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!f){const{error:g}=await this.getUser(a);if(g)throw g;return{data:{claims:s,header:n,signature:l},error:null}}const m=I6(n.alg),v=await crypto.subtle.importKey("jwk",f,m,!0,["verify"]);if(!await crypto.subtle.verify(m,v,l,N6(`${c}.${d}`)))throw new vx("Invalid JWT signature");return{data:{claims:s,header:n,signature:l},error:null}}catch(a){if(dr(a))return this._returnResult({data:null,error:a});throw a}}}R0.nextInstanceID={};const gC=R0;class vC extends gC{constructor(e){super(e)}}class xC{constructor(e,r,a){var n,s,l;this.supabaseUrl=e,this.supabaseKey=r;const c=u6(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:r6,realtime:n6,auth:Object.assign(Object.assign({},a6),{storageKey:d}),global:t6},m=c6(a??{},f);this.storageKey=(n=m.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=m.global.headers)!==null&&s!==void 0?s:{},m.accessToken?(this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(v,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=m.auth)!==null&&l!==void 0?l:{},this.headers,m.global.fetch),this.fetch=o6(r,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.accessToken&&this.accessToken().then(v=>this.realtime.setAuth(v)).catch(v=>console.warn("Failed to set initial Realtime auth token:",v)),this.rest=new nA(new URL("rest/v1",c).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),this.storage=new ZA(this.storageUrl.href,this.headers,this.fetch,a?.storage),m.accessToken||this._listenForAuthEvents()}get functions(){return new eA(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},a={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,a)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:a}=await this.auth.getSession();return(r=(e=a.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:s,storageKey:l,flowType:c,lock:d,debug:f,throwOnError:m},v,x){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new vC({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),v),storageKey:l,autoRefreshToken:e,persistSession:r,detectSessionInUrl:a,storage:n,userStorage:s,flowType:c,lock:d,debug:f,throwOnError:m,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new bA(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a?.access_token)})}_handleTokenChanged(e,r,a){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const yC=(t,e,r)=>new xC(t,e,r);function _C(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}_C()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const bC="fieldsync-offline",wC=1,Nn={PROJECTS:"projects",AREAS:"areas",CREW_CHECKINS:"crew_checkins",PENDING_ACTIONS:"pending_actions",CACHED_DATA:"cached_data"};let md=null;const yc=()=>new Promise((t,e)=>{if(md){t(md);return}const r=indexedDB.open(bC,wC);r.onerror=()=>{console.error("Failed to open offline database"),e(r.error)},r.onsuccess=()=>{md=r.result,console.log("Offline database initialized"),t(md)},r.onupgradeneeded=a=>{const n=a.target.result;if(n.objectStoreNames.contains(Nn.PROJECTS)||n.createObjectStore(Nn.PROJECTS,{keyPath:"id"}).createIndex("company_id","company_id",{unique:!1}),n.objectStoreNames.contains(Nn.AREAS)||n.createObjectStore(Nn.AREAS,{keyPath:"id"}).createIndex("project_id","project_id",{unique:!1}),n.objectStoreNames.contains(Nn.CREW_CHECKINS)||n.createObjectStore(Nn.CREW_CHECKINS,{keyPath:"id"}).createIndex("project_id","project_id",{unique:!1}),!n.objectStoreNames.contains(Nn.PENDING_ACTIONS)){const s=n.createObjectStore(Nn.PENDING_ACTIONS,{keyPath:"id",autoIncrement:!0});s.createIndex("type","type",{unique:!1}),s.createIndex("created_at","created_at",{unique:!1})}n.objectStoreNames.contains(Nn.CACHED_DATA)||n.createObjectStore(Nn.CACHED_DATA,{keyPath:"key"})}}),Td=(t,e="readonly")=>{if(!md)throw new Error("Database not initialized");return md.transaction(t,e).objectStore(t)},SC=async(t,e)=>(await yc(),new Promise((r,a)=>{const s=Td(t,"readwrite").put(e);s.onsuccess=()=>r(s.result),s.onerror=()=>a(s.error)})),W4=async(t,e)=>(await yc(),new Promise((r,a)=>{const n=md.transaction(t,"readwrite"),s=n.objectStore(t);e.forEach(l=>s.put(l)),n.oncomplete=()=>r(),n.onerror=()=>a(n.error)})),NC=async(t,e)=>(await yc(),new Promise((r,a)=>{const s=Td(t).get(e);s.onsuccess=()=>r(s.result),s.onerror=()=>a(s.error)})),V4=async t=>(await yc(),new Promise((e,r)=>{const n=Td(t).getAll();n.onsuccess=()=>e(n.result||[]),n.onerror=()=>r(n.error)})),G4=async(t,e,r)=>(await yc(),new Promise((a,n)=>{const c=Td(t).index(e).getAll(r);c.onsuccess=()=>a(c.result||[]),c.onerror=()=>n(c.error)})),jC=async(t,e)=>(await yc(),new Promise((r,a)=>{const s=Td(t,"readwrite").delete(e);s.onsuccess=()=>r(),s.onerror=()=>a(s.error)})),fu={UPDATE_AREA_STATUS:"UPDATE_AREA_STATUS",CREATE_TM_TICKET:"CREATE_TM_TICKET",SAVE_CREW_CHECKIN:"SAVE_CREW_CHECKIN",SUBMIT_DAILY_REPORT:"SUBMIT_DAILY_REPORT",SEND_MESSAGE:"SEND_MESSAGE",CREATE_MATERIAL_REQUEST:"CREATE_MATERIAL_REQUEST"},ew=async(t,e,r={})=>{await yc();const a={type:t,payload:e,metadata:r,created_at:new Date().toISOString(),attempts:0,last_error:null};return new Promise((n,s)=>{const c=Td(Nn.PENDING_ACTIONS,"readwrite").add(a);c.onsuccess=()=>{console.log(`Queued offline action: ${t}`),n(c.result)},c.onerror=()=>s(c.error)})},Y4=async()=>V4(Nn.PENDING_ACTIONS),sv=async()=>(await Y4()).length,kC=async t=>jC(Nn.PENDING_ACTIONS,t),EC=async(t,e)=>(await yc(),new Promise((r,a)=>{const n=Td(Nn.PENDING_ACTIONS,"readwrite"),s=n.get(t);s.onsuccess=()=>{const l=s.result;if(l){const c={...l,...e},d=n.put(c);d.onsuccess=()=>r(c),d.onerror=()=>a(d.error)}else a(new Error("Action not found"))},s.onerror=()=>a(s.error)})),AC=async t=>W4(Nn.PROJECTS,t),tw=async t=>t?G4(Nn.PROJECTS,"company_id",t):V4(Nn.PROJECTS),CC=async t=>W4(Nn.AREAS,t),rw=async t=>G4(Nn.AREAS,"project_id",t),iv=async(t,e)=>{const r=await NC(Nn.AREAS,t);return r&&(r.status=e,r.updated_at=new Date().toISOString(),await SC(Nn.AREAS,r)),r};let a2=navigator.onLine;const xx=new Set,X4=t=>(xx.add(t),()=>xx.delete(t)),v0=()=>a2,aw=t=>{a2=t,xx.forEach(e=>e(t))};typeof window<"u"&&(window.addEventListener("online",()=>{console.log("Connection restored"),aw(!0)}),window.addEventListener("offline",()=>{console.log("Connection lost"),aw(!1)}));let ov=!1;const TC=async t=>{if(ov||!a2)return{synced:0,failed:0};ov=!0;const e={synced:0,failed:0};try{const r=await Y4();console.log(`Syncing ${r.length} pending actions...`);for(const a of r)try{await OC(a,t),await kC(a.id),e.synced++,console.log(`Synced action: ${a.type}`)}catch(n){console.error(`Failed to sync action ${a.type}:`,n),e.failed++,await EC(a.id,{attempts:(a.attempts||0)+1,last_error:n.message,last_attempt:new Date().toISOString()})}}finally{ov=!1}return e},OC=async(t,e)=>{const{type:r,payload:a}=t;switch(r){case fu.UPDATE_AREA_STATUS:return e.updateAreaStatus(a.areaId,a.status);case fu.CREATE_TM_TICKET:const n=await e.createTMTicket(a.ticket);return a.workers?.length>0&&await e.addTMWorkers(n.id,a.workers),a.items?.length>0&&await e.addTMItems(n.id,a.items),n;case fu.SAVE_CREW_CHECKIN:return e.saveCrewCheckin(a.projectId,a.workers,a.checkInDate);case fu.SUBMIT_DAILY_REPORT:return await e.saveDailyReport(a.projectId,a.reportData),e.submitDailyReport(a.projectId,a.submittedBy);case fu.SEND_MESSAGE:return e.sendMessage(a.projectId,a.senderType,a.senderName,a.content);case fu.CREATE_MATERIAL_REQUEST:return e.createMaterialRequest(a.projectId,a.items,a.requestedBy,a.neededBy,a.priority,a.notes);default:throw new Error(`Unknown action type: ${r}`)}},K4="",RC="",qe=!!K4;yc().catch(t=>console.error("Failed to init offline DB:",t));const De=qe?yC(K4,RC):null,J4="fieldsync_data",yx="fieldsync_user",cr=()=>{const t=localStorage.getItem(J4);return t?JSON.parse(t):{projects:[],areas:[],users:[],assignments:[]}},Xr=t=>{localStorage.setItem(J4,JSON.stringify(t))},dp=()=>{const t=localStorage.getItem(yx);return t?JSON.parse(t):null},fp=t=>{t?localStorage.setItem(yx,JSON.stringify(t)):localStorage.removeItem(yx)},DC={async signUp(t,e,r,a){if(qe){const{data:n,error:s}=await De.auth.signUp({email:t,password:e,options:{data:{name:r,role:a}}});if(s)throw s;return n}else{const n=cr(),s={id:crypto.randomUUID(),email:t,name:r,role:a,created_at:new Date().toISOString()};return n.users.push(s),Xr(n),fp(s),{user:s}}},async signIn(t,e){if(qe){const{data:r,error:a}=await De.auth.signInWithPassword({email:t,password:e});if(a)throw a;return r}else{const a=cr().users.find(n=>n.email===t);if(!a)throw new Error("User not found");return fp(a),{user:a}}},async signOut(){if(qe){const{error:t}=await De.auth.signOut();if(t)throw t}else fp(null)},async getUser(){if(qe){const{data:{user:t}}=await De.auth.getUser();return t}else return dp()},async getProfile(){if(qe){const{data:{user:t}}=await De.auth.getUser();if(!t)return null;const{data:e,error:r}=await De.from("users").select("*").eq("id",t.id).single();return r?{id:t.id,email:t.email,name:t.user_metadata?.name||"",role:t.user_metadata?.role||"foreman"}:e}else return dp()},async updateRole(t,e){if(qe){const{data:r,error:a}=await De.from("users").update({role:e}).eq("id",t).select().single();if(a)throw a;return r}else{const r=cr(),a=r.users.find(n=>n.id===t);return a&&(a.role=e,Xr(r),dp()?.id===t&&fp(a)),a}},onAuthStateChange(t){if(qe)return De.auth.onAuthStateChange(t);{const e=dp();return t(e?"SIGNED_IN":"SIGNED_OUT",{user:e}),{data:{subscription:{unsubscribe:()=>{}}}}}}},nt={async getProjects(t=null,e=!1){if(qe){if(!v0()){console.log("Offline: returning cached projects");const s=await tw(t);return e?s:s.filter(l=>l.status!=="archived")}let r=De.from("projects").select("*").order("created_at",{ascending:!1});t&&(r=r.eq("company_id",t)),e||(r=r.eq("status","active"));const{data:a,error:n}=await r;if(n){console.log("Error fetching projects, trying cache:",n.message);const s=await tw(t);if(s.length>0)return s;throw n}return a?.length>0&&AC(a).catch(s=>console.error("Failed to cache projects:",s)),a}else{const r=cr().projects;return e?r:r.filter(a=>a.status!=="archived")}},async getArchivedProjects(t){if(qe){const{data:e,error:r}=await De.from("projects").select("*").eq("company_id",t).eq("status","archived").order("archived_at",{ascending:!1});if(r)throw r;return e}else return cr().projects.filter(e=>e.status==="archived")},async getProjectCount(t){if(qe){const{count:e,error:r}=await De.from("projects").select("*",{count:"exact",head:!0}).eq("company_id",t).in("status",["active","archived"]);if(r)throw r;return e||0}else return cr().projects.filter(r=>r.company_id===t&&r.status!=="deleted").length},async archiveProject(t){if(qe){const{data:e,error:r}=await De.from("projects").update({status:"archived",archived_at:new Date().toISOString()}).eq("id",t).select().single();if(r)throw r;return e}else{const e=cr(),r=e.projects.find(a=>a.id===t);return r&&(r.status="archived",r.archived_at=new Date().toISOString(),Xr(e)),r}},async restoreProject(t){if(qe){const{data:e,error:r}=await De.from("projects").update({status:"active",archived_at:null}).eq("id",t).select().single();if(r)throw r;return e}else{const e=cr(),r=e.projects.find(a=>a.id===t);return r&&(r.status="active",r.archived_at=null,Xr(e)),r}},async getProject(t){if(qe){const{data:e,error:r}=await De.from("projects").select("*").eq("id",t).single();if(r)throw r;return e}else return cr().projects.find(e=>e.id===t)},async createProject(t){if(qe){console.log("Creating project with data:",t);const{data:e,error:r}=await De.from("projects").insert({...t,status:"active"}).select().single();if(r)throw console.error("Supabase createProject error:",r.message,r.details,r.hint),r;return e}else{const e=cr(),r={...t,id:crypto.randomUUID(),status:"active",created_at:new Date().toISOString()};return e.projects.push(r),Xr(e),r}},async getProjectByPin(t){if(qe){const{data:e,error:r}=await De.from("projects").select("*").eq("pin",t).eq("status","active").single();return r?null:e}else return cr().projects.find(r=>r.pin===t&&r.status==="active")||null},async getProjectByPinAndCompany(t,e){if(qe){const{data:r,error:a}=await De.from("projects").select("*").eq("pin",t).eq("company_id",e).eq("status","active").single();return a?null:r}else return cr().projects.find(a=>a.pin===t&&a.company_id===e&&a.status==="active")||null},async isPinAvailable(t,e=null){if(qe){let r=De.from("projects").select("id").eq("pin",t);e&&(r=r.neq("id",e));const{data:a,error:n}=await r;if(n)throw n;return a.length===0}else return!cr().projects.some(a=>a.pin===t&&a.id!==e)},async updateProjectPin(t,e){if(qe){const{data:r,error:a}=await De.from("projects").update({pin:e}).eq("id",t).select().single();if(a)throw a;return r}else{const r=cr(),a=r.projects.find(n=>n.id===t);return a&&(a.pin=e,Xr(r)),a}},async updateProject(t,e){if(qe){const{data:r,error:a}=await De.from("projects").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating project:",a),a;return r}else{const r=cr(),a=r.projects.find(n=>n.id===t);return a&&(Object.assign(a,e),Xr(r)),a}},async deleteProject(t){if(qe){const{error:e}=await De.from("projects").delete().eq("id",t);if(e)throw e}else{const e=cr();e.projects=e.projects.filter(r=>r.id!==t),e.areas=e.areas.filter(r=>r.project_id!==t),Xr(e)}},async getAreas(t){if(qe){if(!v0())return console.log("Offline: returning cached areas"),rw(t);const{data:e,error:r}=await De.from("areas").select("*").eq("project_id",t).order("sort_order",{ascending:!0});if(r){console.log("Error fetching areas, trying cache:",r.message);const a=await rw(t);if(a.length>0)return a;throw r}return e?.length>0&&CC(e).catch(a=>console.error("Failed to cache areas:",a)),e}else return cr().areas.filter(e=>e.project_id===t)},async createArea(t){if(qe){const{data:e,error:r}=await De.from("areas").insert(t).select().single();if(r)throw r;return e}else{const e=cr(),r={...t,id:crypto.randomUUID(),created_at:new Date().toISOString()};return e.areas.push(r),Xr(e),r}},async updateAreaStatus(t,e){if(qe){if(!v0()){console.log("Offline: queuing area status update");const n=await iv(t,e);return await ew(fu.UPDATE_AREA_STATUS,{areaId:t,status:e}),n}const{data:r,error:a}=await De.from("areas").update({status:e}).eq("id",t).select().single();if(a){if(a.message?.includes("fetch")||a.message?.includes("network")){console.log("Network error: queuing area status update");const n=await iv(t,e);return await ew(fu.UPDATE_AREA_STATUS,{areaId:t,status:e}),n}throw a}return r&&iv(t,e).catch(n=>console.error("Failed to update cached area:",n)),r}else{const r=cr(),a=r.areas.find(n=>n.id===t);return a&&(a.status=e,a.updated_at=new Date().toISOString()),Xr(r),a}},async updateArea(t,e){if(qe){const{data:r,error:a}=await De.from("areas").update(e).eq("id",t).select().single();if(a)throw a;return r}else{const r=cr(),a=r.areas.find(n=>n.id===t);return a&&(Object.assign(a,e),a.updated_at=new Date().toISOString()),Xr(r),a}},async deleteArea(t){if(qe){const{error:e}=await De.from("areas").delete().eq("id",t);if(e)throw e}else{const e=cr();e.areas=e.areas.filter(r=>r.id!==t),Xr(e)}},subscribeToAreas(t,e){return qe?De.channel(`areas:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"areas",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToMessages(t,e){return qe?De.channel(`messages:${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToMaterialRequests(t,e){return qe?De.channel(`material_requests:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"material_requests",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToDailyReports(t,e){return qe?De.channel(`daily_reports:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"daily_reports",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToCrewCheckins(t,e){return qe?De.channel(`crew_checkins:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"crew_checkins",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToInjuryReports(t,e){return qe?De.channel(`injury_reports:${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"injury_reports",filter:`company_id=eq.${t}`},e).subscribe():null},subscribeToTMTickets(t,e){return qe?De.channel(`tm_tickets:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"t_and_m_tickets",filter:`project_id=eq.${t}`},e).subscribe():null},subscribeToCompanyActivity(t,e,r){if(!qe||!e||e.length===0)return null;const a=De.channel(`company_activity:${t}`);return e.forEach(n=>{a.on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`project_id=eq.${n}`},s=>r.onMessage?.(s)),a.on("postgres_changes",{event:"INSERT",schema:"public",table:"material_requests",filter:`project_id=eq.${n}`},s=>r.onMaterialRequest?.(s)),a.on("postgres_changes",{event:"INSERT",schema:"public",table:"t_and_m_tickets",filter:`project_id=eq.${n}`},s=>r.onTMTicket?.(s))}),a.on("postgres_changes",{event:"INSERT",schema:"public",table:"injury_reports",filter:`company_id=eq.${t}`},n=>r.onInjuryReport?.(n)),a.subscribe()},unsubscribe(t){t&&qe&&De.removeChannel(t)},async getAssignedProjects(t){if(qe){const{data:e,error:r}=await De.from("project_assignments").select(`
          project_id,
          projects (*)
        `).eq("user_id",t);if(r)throw r;return e.map(a=>a.projects)}else{const e=cr();return(e.assignments?.filter(a=>a.user_id===t)||[]).map(a=>e.projects.find(n=>n.id===a.project_id)).filter(Boolean)}},async assignUserToProject(t,e,r){if(qe){const{data:a,error:n}=await De.from("project_assignments").insert({project_id:t,user_id:e,assigned_by:r}).select().single();if(n)throw n;return a}else{const a=cr();a.assignments||(a.assignments=[]);const n={id:crypto.randomUUID(),project_id:t,user_id:e,assigned_by:r,assigned_at:new Date().toISOString()};return a.assignments.push(n),Xr(a),n}},async removeUserFromProject(t,e){if(qe){const{error:r}=await De.from("project_assignments").delete().eq("project_id",t).eq("user_id",e);if(r)throw r}else{const r=cr();r.assignments=r.assignments?.filter(a=>!(a.project_id===t&&a.user_id===e))||[],Xr(r)}},async getProjectAssignments(t){if(qe){const{data:e,error:r}=await De.from("project_assignments").select(`
          user_id,
          users (id, email, name, role)
        `).eq("project_id",t);if(r)throw r;return e.map(a=>a.users)}else{const e=cr();return(e.assignments?.filter(a=>a.project_id===t)||[]).map(a=>e.users.find(n=>n.id===a.user_id)).filter(Boolean)}},async getAllUsers(){if(qe){const{data:t,error:e}=await De.from("users").select("*").order("name");if(e)throw e;return t}else return cr().users||[]},async getForemen(){if(qe){const{data:t,error:e}=await De.from("users").select("*").eq("role","foreman").order("name");if(e)throw e;return t}else return(cr().users||[]).filter(t=>t.role==="foreman")},async logActivity(t,e,r,a,n,s){if(qe){const{error:l}=await De.from("activity_log").insert({user_id:t,project_id:e,area_id:r,action:a,old_value:n,new_value:s});l&&console.error("Error logging activity:",l)}},async getProjectActivity(t,e=50){if(qe){const{data:r,error:a}=await De.from("activity_log").select(`
          *,
          users (name, email),
          areas (name)
        `).eq("project_id",t).order("created_at",{ascending:!1}).limit(e);if(a)throw a;return r}return[]},async getMaterialsEquipment(t){if(qe){const{data:e,error:r}=await De.from("materials_equipment").select("*").eq("company_id",t).eq("active",!0).order("category").order("name");if(r)throw r;return e}return[]},async getMaterialsEquipmentByCategory(t,e){if(qe){const{data:r,error:a}=await De.from("materials_equipment").select("*").eq("company_id",t).eq("category",e).eq("active",!0).order("name");if(a)throw a;return r}return[]},async getAllMaterialsEquipment(t){if(qe){const{data:e,error:r}=await De.from("materials_equipment").select("*").eq("company_id",t).order("category").order("name");if(r)throw r;return e}return[]},async createMaterialEquipment(t){if(qe){const{data:e,error:r}=await De.from("materials_equipment").insert(t).select().single();if(r)throw r;return e}return null},async updateMaterialEquipment(t,e){if(qe){const{data:r,error:a}=await De.from("materials_equipment").update(e).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteMaterialEquipment(t){if(qe){const{error:e}=await De.from("materials_equipment").update({active:!1}).eq("id",t);if(e)throw e}},async getTMTickets(t){if(qe){const{data:e,error:r}=await De.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).order("created_at",{ascending:!1});if(r)throw r;return e}return[]},async getChangeOrderTotals(t){if(qe){const{data:e,error:r}=await De.from("t_and_m_tickets").select("ce_pco_number, change_order_value, status").eq("project_id",t).not("ce_pco_number","is",null).neq("ce_pco_number","");if(r)throw r;const a={};let n=0,s=0;return e?.forEach(l=>{const c=l.ce_pco_number;if(a[c]||(a[c]={approved:0,pending:0,count:0}),a[c].count++,l.status==="approved"||l.status==="billed"){const d=parseFloat(l.change_order_value)||0;a[c].approved+=d,n+=d}else l.status==="pending"&&s++}),{changeOrders:a,totalApprovedValue:n,pendingCount:s}}return{changeOrders:{},totalApprovedValue:0,pendingCount:0}},async getTMTicketsByStatus(t,e){if(qe){const{data:r,error:a}=await De.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).eq("status",e).order("created_at",{ascending:!1});if(a)throw a;return r}return[]},async createTMTicket(t){if(qe){const{data:e,error:r}=await De.from("t_and_m_tickets").insert({project_id:t.project_id,work_date:t.work_date,ce_pco_number:t.ce_pco_number||null,notes:t.notes,photos:t.photos||[],status:"pending",created_by_name:t.created_by_name||"Field User"}).select().single();if(r)throw r;return e}return null},async addTMWorkers(t,e){if(qe){const r=e.map(n=>({ticket_id:t,name:n.name,hours:n.hours,overtime_hours:n.overtime_hours||0,time_started:n.time_started||null,time_ended:n.time_ended||null,role:n.role||"Laborer"})),{error:a}=await De.from("t_and_m_workers").insert(r);if(a)throw a}},async addTMItems(t,e){if(qe){const r=e.map(n=>({ticket_id:t,material_equipment_id:n.material_equipment_id||null,custom_name:n.custom_name||null,custom_category:n.custom_category||null,quantity:n.quantity})),{error:a}=await De.from("t_and_m_items").insert(r);if(a)throw a}},async updateTMTicketStatus(t,e){if(qe){const{data:r,error:a}=await De.from("t_and_m_tickets").update({status:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async approveTMTicket(t,e,r,a=null){if(qe){const n={status:"approved",approved_by_user_id:e,approved_by_name:r,approved_at:new Date().toISOString(),rejected_by_user_id:null,rejected_by_name:null,rejected_at:null,rejection_reason:null};a!==null&&(n.change_order_value=parseFloat(a)||0);const{data:s,error:l}=await De.from("t_and_m_tickets").update(n).eq("id",t).select().single();if(l)throw l;return s}return null},async rejectTMTicket(t,e,r,a=""){if(qe){const{data:n,error:s}=await De.from("t_and_m_tickets").update({status:"rejected",rejected_by_user_id:e,rejected_by_name:r,rejected_at:new Date().toISOString(),rejection_reason:a,approved_by_user_id:null,approved_by_name:null,approved_at:null}).eq("id",t).select().single();if(s)throw s;return n}return null},canApproveTickets(t){return["owner","admin","manager"].includes(t)},async updateTMTicketPhotos(t,e){if(qe){const{data:r,error:a}=await De.from("t_and_m_tickets").update({photos:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteTMTicket(t){if(qe){const{error:e}=await De.from("t_and_m_tickets").delete().eq("id",t);if(e)throw e}},async getCompanyByCode(t){if(qe){const{data:e,error:r}=await De.from("companies").select("*").eq("code",t).single();return r?null:e}return null},async getCompany(t){if(qe){const{data:e,error:r}=await De.from("companies").select("*").eq("id",t).single();if(r)throw r;return e}return null},async getUserCompanies(t){if(qe){const{data:e,error:r}=await De.from("user_companies").select(`
          id,
          role,
          company_id,
          companies (
            id,
            name,
            code
          )
        `).eq("user_id",t).order("created_at",{ascending:!0});return r?(console.error("Error fetching user companies:",r),[]):e.map(a=>({id:a.companies.id,name:a.companies.name,code:a.companies.code,role:a.role}))}return[]},async uploadPhoto(t,e,r,a){if(!qe)return null;const n=Date.now(),s=Math.random().toString(36).substring(7),l=a.name?.split(".").pop()||"jpg",c=`${n}-${s}.${l}`,d=`${t}/${e}/${r}/${c}`,{data:f,error:m}=await De.storage.from("tm-photos").upload(d,a,{cacheControl:"3600",upsert:!1});if(m)throw m;const{data:v}=De.storage.from("tm-photos").getPublicUrl(d);return v.publicUrl},async uploadPhotoBase64(t,e,r,a,n="photo.jpg"){if(!qe)return null;const l=await(await fetch(a)).blob(),c=Date.now(),d=Math.random().toString(36).substring(7),f=n.split(".").pop()||"jpg",m=`${c}-${d}.${f}`,v=`${t}/${e}/${r}/${m}`,{data:x,error:g}=await De.storage.from("tm-photos").upload(v,l,{cacheControl:"3600",upsert:!1,contentType:l.type});if(g)throw g;const{data:b}=De.storage.from("tm-photos").getPublicUrl(v);return b.publicUrl},async deletePhoto(t){if(!qe)return;const r=new URL(t).pathname.match(/\/tm-photos\/(.+)$/);if(!r)return;const a=r[1],{error:n}=await De.storage.from("tm-photos").remove([a]);if(n)throw n},async getCrewCheckin(t,e=null){if(!qe)return null;const r=e||new Date().toISOString().split("T")[0],{data:a,error:n}=await De.from("crew_checkins").select("*").eq("project_id",t).eq("check_in_date",r).single();return n&&n.code!=="PGRST116"&&console.error("Error fetching crew checkin:",n),a},async saveCrewCheckin(t,e,r=null,a=null){if(!qe)return null;const n=a||new Date().toISOString().split("T")[0],{data:s,error:l}=await De.from("crew_checkins").upsert({project_id:t,check_in_date:n,workers:e,created_by:r,updated_at:new Date().toISOString()},{onConflict:"project_id,check_in_date"}).select().single();if(l)throw console.error("Error saving crew checkin:",l),l;return s},async addCrewMember(t,e,r=null){if(!qe)return null;const a=await this.getCrewCheckin(t),n=a?.workers||[];return n.find(s=>s.name.toLowerCase()===e.name.toLowerCase())?a:(n.push(e),await this.saveCrewCheckin(t,n,r))},async removeCrewMember(t,e){if(!qe)return null;const r=await this.getCrewCheckin(t);if(!r)return null;const a=r.workers.filter(n=>n.name.toLowerCase()!==e.toLowerCase());return await this.saveCrewCheckin(t,a,r.created_by)},async getCrewCheckinHistory(t,e=30){if(!qe)return[];const{data:r,error:a}=await De.from("crew_checkins").select("*").eq("project_id",t).order("check_in_date",{ascending:!1}).limit(e);return a?(console.error("Error fetching crew history:",a),[]):r||[]},async getLaborRates(t,e=null,r=null){if(!qe)return[];let a=De.from("labor_rates").select("*").eq("company_id",t);e&&(a=a.eq("work_type",e)),r&&(a=a.eq("job_type",r));const{data:n,error:s}=await a;return s?(console.error("Error fetching labor rates:",s),[]):n||[]},async calculateManDayCosts(t,e,r,a){if(!qe)return{totalCost:0,totalManDays:0,breakdown:[]};const n=await this.getCrewCheckinHistory(t,365),s=await this.getLaborRates(e,r,a),l={};s.forEach(v=>{l[v.role.toLowerCase()]=parseFloat(v.regular_rate)||0});let c=0,d=0;const f={},m=[];return n.forEach(v=>{const x=v.workers||[];let g=0;const b={};x.forEach(_=>{const w=(_.role||"laborer").toLowerCase(),E=l[w]||0;b[w]||(b[w]={count:0,cost:0}),b[w].count++,b[w].cost+=E,g+=E,f[w]||(f[w]={count:0,cost:0,rate:E}),f[w].count++,f[w].cost+=E}),c+=g,d+=x.length,m.push({date:v.check_in_date,workers:x.length,cost:g,breakdown:b})}),{totalCost:c,totalManDays:d,byRole:f,byDate:m,daysWorked:n.length}},async getDailyReport(t,e=null){if(!qe)return null;const r=e||new Date().toISOString().split("T")[0],{data:a,error:n}=await De.from("daily_reports").select("*").eq("project_id",t).eq("report_date",r).single();return n&&n.code!=="PGRST116"&&console.error("Error fetching daily report:",n),a},async compileDailyReport(t,e=null){if(!qe)return null;const r=e||new Date().toISOString().split("T")[0],a=await this.getCrewCheckin(t,r),{data:n}=await De.from("areas").select("*").eq("project_id",t),s=n?.filter(d=>d.status==="done"&&d.completed_at?.startsWith(r))||[],{data:l}=await De.from("t_and_m_tickets").select("*").eq("project_id",t).eq("work_date",r),c=l?.reduce((d,f)=>d+(f.photos?.length||0),0)||0;return{crew_count:a?.workers?.length||0,crew_list:a?.workers||[],tasks_completed:s.length,tasks_total:n?.length||0,completed_tasks:s.map(d=>({name:d.name,group:d.group_name})),tm_tickets_count:l?.length||0,photos_count:c}},async saveDailyReport(t,e,r=null){if(!qe)return null;const a=r||new Date().toISOString().split("T")[0],{data:n,error:s}=await De.from("daily_reports").upsert({project_id:t,report_date:a,...e,updated_at:new Date().toISOString()},{onConflict:"project_id,report_date"}).select().single();if(s)throw console.error("Error saving daily report:",s),s;return n},async submitDailyReport(t,e,r=null){if(!qe)return null;const a=r||new Date().toISOString().split("T")[0],n=await this.compileDailyReport(t,a),{data:s,error:l}=await De.from("daily_reports").upsert({project_id:t,report_date:a,...n,status:"submitted",submitted_at:new Date().toISOString(),submitted_by:e,updated_at:new Date().toISOString()},{onConflict:"project_id,report_date"}).select().single();if(l)throw console.error("Error submitting daily report:",l),l;return s},async getDailyReports(t,e=30){if(!qe)return[];const{data:r,error:a}=await De.from("daily_reports").select("*").eq("project_id",t).order("report_date",{ascending:!1}).limit(e);return a?(console.error("Error fetching daily reports:",a),[]):r||[]},async sendMessage(t,e,r,a,n=null,s=null,l="general",c=null){if(!qe)return null;const{data:d,error:f}=await De.from("messages").insert({project_id:t,sender_type:r,sender_name:a,sender_user_id:n,message:e,photo_url:s,message_type:l,parent_message_id:c}).select().single();if(f)throw console.error("Error sending message:",f),f;return d},async getMessages(t,e=50){if(!qe)return[];const{data:r,error:a}=await De.from("messages").select("*").eq("project_id",t).order("created_at",{ascending:!1}).limit(e);return a?(console.error("Error fetching messages:",a),[]):r||[]},async getUnreadCount(t,e){if(!qe)return 0;const r=e==="field"?"office":"field",{count:a,error:n}=await De.from("messages").select("*",{count:"exact",head:!0}).eq("project_id",t).eq("sender_type",r).eq("is_read",!1);return n?(console.error("Error getting unread count:",n),0):a||0},async markMessagesRead(t,e){if(!qe)return;const r=e==="field"?"office":"field",{error:a}=await De.from("messages").update({is_read:!0,read_at:new Date().toISOString()}).eq("project_id",t).eq("sender_type",r).eq("is_read",!1);a&&console.error("Error marking messages read:",a)},async createMaterialRequest(t,e,r,a=null,n="normal",s=null){if(!qe)return null;const{data:l,error:c}=await De.from("material_requests").insert({project_id:t,items:e,requested_by:r,needed_by:a,priority:n,notes:s}).select().single();if(c)throw console.error("Error creating material request:",c),c;return l},async getMaterialRequests(t,e=null){if(!qe)return[];let r=De.from("material_requests").select("*").eq("project_id",t).order("created_at",{ascending:!1});e&&(r=r.eq("status",e));const{data:a,error:n}=await r;return n?(console.error("Error fetching material requests:",n),[]):a||[]},async getPendingRequestsCount(t){if(!qe)return 0;const{count:e,error:r}=await De.from("material_requests").select("*",{count:"exact",head:!0}).eq("project_id",t).eq("status","pending");return r?0:e||0},async updateMaterialRequest(t,e,r,a=null,n=null){if(!qe)return null;const s={status:e,responded_by:r,responded_at:new Date().toISOString(),response_notes:a,updated_at:new Date().toISOString()};n&&(s.expected_delivery=n),e==="delivered"&&(s.delivered_at=new Date().toISOString());const{data:l,error:c}=await De.from("material_requests").update(s).eq("id",t).select().single();if(c)throw console.error("Error updating material request:",c),c;return l},generateShareToken(){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let e="";for(let r=0;r<12;r++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},async createProjectShare(t,e,r,a=null){if(!qe){const d=cr();d.projectShares||(d.projectShares=[]);const f={id:crypto.randomUUID(),project_id:t,share_token:this.generateShareToken(),created_by:e,expires_at:a,is_active:!0,permissions:r,view_count:0,last_viewed_at:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return d.projectShares.push(f),Xr(d),f}const{data:n,error:s}=await De.rpc("generate_share_token");if(s)throw console.error("Error generating share token:",s),s;const{data:l,error:c}=await De.from("project_shares").insert({project_id:t,share_token:n,created_by:e,expires_at:a,permissions:r}).select().single();if(c)throw console.error("Error creating project share:",c),c;return l},async getShareByToken(t){if(!qe){const a=cr();if(!a.projectShares)return null;const n=a.projectShares.find(s=>s.share_token===t&&s.is_active&&(!s.expires_at||new Date(s.expires_at)>new Date));return n&&(n.view_count++,n.last_viewed_at=new Date().toISOString(),Xr(a)),n}const{data:e,error:r}=await De.from("project_shares").select("*, projects(*)").eq("share_token",t).eq("is_active",!0).single();return r?(console.error("Error fetching share by token:",r),null):e.expires_at&&new Date(e.expires_at)<new Date?null:(await De.rpc("increment_share_view_count",{token:t}),e)},async getProjectShares(t){if(!qe){const a=cr();return a.projectShares?a.projectShares.filter(n=>n.project_id===t):[]}const{data:e,error:r}=await De.from("project_shares").select("*, users(name, email)").eq("project_id",t).order("created_at",{ascending:!1});return r?(console.error("Error fetching project shares:",r),[]):e||[]},async updateProjectShare(t,e){if(!qe){const n=cr();if(!n.projectShares)return null;const s=n.projectShares.findIndex(l=>l.id===t);return s===-1?null:(n.projectShares[s]={...n.projectShares[s],...e,updated_at:new Date().toISOString()},Xr(n),n.projectShares[s])}const{data:r,error:a}=await De.from("project_shares").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating project share:",a),a;return r},async revokeProjectShare(t){return this.updateProjectShare(t,{is_active:!1})},async deleteProjectShare(t){if(!qe){const r=cr();if(!r.projectShares)return;r.projectShares=r.projectShares.filter(a=>a.id!==t),Xr(r);return}const{error:e}=await De.from("project_shares").delete().eq("id",t);if(e)throw console.error("Error deleting project share:",e),e},async getPublicProjectData(t){const e=await this.getShareByToken(t);if(!e)return null;const r=e.project_id||e.projects?.id;if(!qe){const s=cr(),l=s.projects.find(v=>v.id===r);if(!l)return null;const c=s.areas.filter(v=>v.project_id===r),d=c.reduce((v,x)=>v+parseFloat(x.weight||0),0),f=c.filter(v=>v.status==="done").reduce((v,x)=>v+parseFloat(x.weight||0),0),m=d>0?Math.round(f/d*100):0;return{share:e,project:l,progress:m,areas:e.permissions.progress?c:[],photos:[],dailyReports:[],tmTickets:[]}}const a=e.projects||await this.getProject(r);if(!a)return null;const n={share:e,project:a,areas:[],photos:[],dailyReports:[],tmTickets:[]};if(e.permissions.progress){n.areas=await this.getAreas(r);const s=n.areas.reduce((c,d)=>c+parseFloat(d.weight||0),0),l=n.areas.filter(c=>c.status==="done").reduce((c,d)=>c+parseFloat(d.weight||0),0);n.progress=s>0?Math.round(l/s*100):0}if(e.permissions.photos){const{data:s}=await De.from("t_and_m_tickets").select("photos, work_date").eq("project_id",r).not("photos","is",null).order("work_date",{ascending:!1}).limit(20);n.photos=s?.flatMap(l=>(l.photos||[]).map(c=>({url:c,date:l.work_date})))||[]}if(e.permissions.daily_reports){const{data:s}=await De.from("daily_reports").select("*").eq("project_id",r).order("report_date",{ascending:!1}).limit(10);n.dailyReports=s||[]}return e.permissions.tm_tickets&&(n.tmTickets=await this.getTMTickets(r)),n},async createInjuryReport(t){if(!qe){const a=cr();a.injuryReports||(a.injuryReports=[]);const n={id:crypto.randomUUID(),...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return a.injuryReports.push(n),Xr(a),n}const{data:e,error:r}=await De.from("injury_reports").insert(t).select().single();if(r)throw console.error("Error creating injury report:",r),r;return e},async getInjuryReports(t){if(!qe){const a=cr();return a.injuryReports?a.injuryReports.filter(n=>n.project_id===t).sort((n,s)=>new Date(s.incident_date)-new Date(n.incident_date)):[]}const{data:e,error:r}=await De.from("injury_reports").select("*").eq("project_id",t).order("incident_date",{ascending:!1});return r?(console.error("Error fetching injury reports:",r),[]):e||[]},async getCompanyInjuryReports(t,e=null){if(!qe){const s=cr();if(!s.injuryReports)return[];let l=s.injuryReports.filter(c=>c.company_id===t);return e&&(l=l.filter(c=>c.status===e)),l.sort((c,d)=>new Date(d.incident_date)-new Date(c.incident_date))}let r=De.from("injury_reports").select("*, projects(name)").eq("company_id",t).order("incident_date",{ascending:!1});e&&(r=r.eq("status",e));const{data:a,error:n}=await r;return n?(console.error("Error fetching company injury reports:",n),[]):a||[]},async getInjuryReport(t){if(!qe){const a=cr();return a.injuryReports?a.injuryReports.find(n=>n.id===t):null}const{data:e,error:r}=await De.from("injury_reports").select("*, projects(name, pin), users(name, email)").eq("id",t).single();return r?(console.error("Error fetching injury report:",r),null):e},async updateInjuryReport(t,e){if(!qe){const n=cr();if(!n.injuryReports)return null;const s=n.injuryReports.findIndex(l=>l.id===t);return s===-1?null:(n.injuryReports[s]={...n.injuryReports[s],...e,updated_at:new Date().toISOString()},Xr(n),n.injuryReports[s])}const{data:r,error:a}=await De.from("injury_reports").update(e).eq("id",t).select().single();if(a)throw console.error("Error updating injury report:",a),a;return r},async closeInjuryReport(t,e){return this.updateInjuryReport(t,{status:"closed",closed_at:new Date().toISOString(),closed_by:e})},async deleteInjuryReport(t){if(!qe){const r=cr();if(!r.injuryReports)return;r.injuryReports=r.injuryReports.filter(a=>a.id!==t),Xr(r);return}const{error:e}=await De.from("injury_reports").delete().eq("id",t);if(e)throw console.error("Error deleting injury report:",e),e},async getInjuryStatistics(t,e=null,r=null){if(!qe){const s=cr();if(!s.injuryReports)return{total_incidents:0,minor_injuries:0,serious_injuries:0,critical_injuries:0,near_misses:0,osha_recordable:0,total_days_away:0,total_restricted_days:0};let l=s.injuryReports.filter(c=>c.company_id===t);return e&&(l=l.filter(c=>new Date(c.incident_date)>=new Date(e))),r&&(l=l.filter(c=>new Date(c.incident_date)<=new Date(r))),{total_incidents:l.length,minor_injuries:l.filter(c=>c.injury_type==="minor").length,serious_injuries:l.filter(c=>c.injury_type==="serious").length,critical_injuries:l.filter(c=>c.injury_type==="critical").length,near_misses:l.filter(c=>c.injury_type==="near_miss").length,osha_recordable:l.filter(c=>c.osha_recordable).length,total_days_away:l.reduce((c,d)=>c+(d.days_away_from_work||0),0),total_restricted_days:l.reduce((c,d)=>c+(d.restricted_work_days||0),0)}}const{data:a,error:n}=await De.rpc("get_injury_statistics",{comp_id:t,start_date:e,end_date:r});return n?(console.error("Error fetching injury statistics:",n),null):a[0]||null},async addWitness(t,e){if(!qe){const n=cr();if(!n.injuryReports)return null;const s=n.injuryReports.findIndex(d=>d.id===t);if(s===-1)return null;const l=n.injuryReports[s],c=l.witnesses||[];return c.push(e),n.injuryReports[s]={...l,witnesses:c,updated_at:new Date().toISOString()},Xr(n),n.injuryReports[s]}const r=await this.getInjuryReport(t);if(!r)return null;const a=r.witnesses||[];return a.push(e),this.updateInjuryReport(t,{witnesses:a})},async removeWitness(t,e){if(!qe){const n=cr();if(!n.injuryReports)return null;const s=n.injuryReports.findIndex(d=>d.id===t);if(s===-1)return null;const l=n.injuryReports[s],c=l.witnesses||[];return c.splice(e,1),n.injuryReports[s]={...l,witnesses:c,updated_at:new Date().toISOString()},Xr(n),n.injuryReports[s]}const r=await this.getInjuryReport(t);if(!r)return null;const a=r.witnesses||[];return a.splice(e,1),this.updateInjuryReport(t,{witnesses:a})},async getCompanyUsers(t){if(qe){const{data:e,error:r}=await De.from("user_companies").select(`
          user_id,
          role,
          users (
            id,
            name,
            email
          )
        `).eq("company_id",t);return r?(console.error("Error fetching company users:",r),[]):e?.map(a=>({id:a.user_id,name:a.users?.name||a.users?.email,email:a.users?.email,role:a.role}))||[]}return[]},async getProjectNotificationPreferences(t){if(qe){const{data:r,error:a}=await De.from("notification_preferences").select(`
          *,
          users (
            id,
            name,
            email
          )
        `).eq("project_id",t);return a?(console.error("Error fetching notification preferences:",a),[]):r||[]}const e=cr();return e.notificationPreferences?e.notificationPreferences.filter(r=>r.project_id===t):[]},async getUserNotificationPreferences(t){if(qe){const{data:r,error:a}=await De.from("notification_preferences").select(`
          *,
          projects (
            id,
            name
          )
        `).eq("user_id",t);return a?(console.error("Error fetching user notification preferences:",a),[]):r||[]}const e=cr();return e.notificationPreferences?e.notificationPreferences.filter(r=>r.user_id===t):[]},async setNotificationPreference(t,e,r){if(qe){const{data:l,error:c}=await De.from("notification_preferences").upsert({project_id:t,user_id:e,notification_types:r,updated_at:new Date().toISOString()},{onConflict:"project_id,user_id"}).select().single();if(c)throw console.error("Error setting notification preference:",c),c;return l}const a=cr();a.notificationPreferences||(a.notificationPreferences=[]);const n=a.notificationPreferences.findIndex(l=>l.project_id===t&&l.user_id===e),s={id:n>=0?a.notificationPreferences[n].id:crypto.randomUUID(),project_id:t,user_id:e,notification_types:r,created_at:n>=0?a.notificationPreferences[n].created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return n>=0?a.notificationPreferences[n]=s:a.notificationPreferences.push(s),Xr(a),s},async removeNotificationPreference(t,e){if(qe){const{error:a}=await De.from("notification_preferences").delete().eq("project_id",t).eq("user_id",e);if(a)throw console.error("Error removing notification preference:",a),a;return!0}const r=cr();return r.notificationPreferences&&(r.notificationPreferences=r.notificationPreferences.filter(a=>!(a.project_id===t&&a.user_id===e)),Xr(r)),!0},async setProjectNotificationPreferences(t,e){const r=[];for(const a of e)if(a.notificationTypes&&a.notificationTypes.length>0){const n=await this.setNotificationPreference(t,a.userId,a.notificationTypes);r.push(n)}else await this.removeNotificationPreference(t,a.userId);return r},async getNotificationPresets(t){if(qe){const{data:r,error:a}=await De.from("notification_presets").select("*").eq("company_id",t).order("name");return a?(console.error("Error fetching notification presets:",a),[]):r||[]}const e=cr();return e.notificationPresets?e.notificationPresets.filter(r=>r.company_id===t):[{id:"preset-1",name:"Project Manager",notification_types:["message","material_request","injury_report","tm_ticket"],company_id:t},{id:"preset-2",name:"Safety Officer",notification_types:["injury_report"],company_id:t},{id:"preset-3",name:"Purchasing",notification_types:["material_request"],company_id:t},{id:"preset-4",name:"Accounting",notification_types:["tm_ticket"],company_id:t}]},async createNotificationPreset(t,e,r){if(qe){const{data:s,error:l}=await De.from("notification_presets").insert({company_id:t,name:e,notification_types:r}).select().single();if(l)throw console.error("Error creating notification preset:",l),l;return s}const a=cr();a.notificationPresets||(a.notificationPresets=[]);const n={id:crypto.randomUUID(),company_id:t,name:e,notification_types:r,created_at:new Date().toISOString()};return a.notificationPresets.push(n),Xr(a),n},async updateNotificationPreset(t,e,r){if(qe){const{data:s,error:l}=await De.from("notification_presets").update({name:e,notification_types:r,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(l)throw console.error("Error updating notification preset:",l),l;return s}const a=cr();if(!a.notificationPresets)return null;const n=a.notificationPresets.findIndex(s=>s.id===t);return n===-1?null:(a.notificationPresets[n]={...a.notificationPresets[n],name:e,notification_types:r,updated_at:new Date().toISOString()},Xr(a),a.notificationPresets[n])},async deleteNotificationPreset(t){if(qe){const{error:r}=await De.from("notification_presets").delete().eq("id",t);if(r)throw console.error("Error deleting notification preset:",r),r;return!0}const e=cr();return e.notificationPresets&&(e.notificationPresets=e.notificationPresets.filter(r=>r.id!==t),Xr(e)),!0},async getDumpSites(t){if(qe){const{data:r,error:a}=await De.from("dump_sites").select(`
          *,
          dump_site_rates (*)
        `).eq("company_id",t).eq("active",!0).order("name");return a?(console.error("Error fetching dump sites:",a),[]):r||[]}return(cr().dumpSites||[]).filter(r=>r.company_id===t&&r.active)},async createDumpSite(t,e,r="",a=""){if(qe){const{data:l,error:c}=await De.from("dump_sites").insert({company_id:t,name:e,address:r,notes:a,active:!0}).select().single();if(c)throw console.error("Error creating dump site:",c),c;return l}const n=cr();n.dumpSites||(n.dumpSites=[]);const s={id:crypto.randomUUID(),company_id:t,name:e,address:r,notes:a,active:!0,created_at:new Date().toISOString(),dump_site_rates:[]};return n.dumpSites.push(s),Xr(n),s},async updateDumpSite(t,e){if(qe){const{data:n,error:s}=await De.from("dump_sites").update({...e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(s)throw console.error("Error updating dump site:",s),s;return n}const r=cr();if(!r.dumpSites)return null;const a=r.dumpSites.findIndex(n=>n.id===t);return a===-1?null:(r.dumpSites[a]={...r.dumpSites[a],...e},Xr(r),r.dumpSites[a])},async deleteDumpSite(t){return this.updateDumpSite(t,{active:!1})},async setDumpSiteRate(t,e,r,a="load"){if(qe){const{data:c}=await De.from("dump_site_rates").select("id").eq("dump_site_id",t).eq("waste_type",e).maybeSingle();if(c){const{data:d,error:f}=await De.from("dump_site_rates").update({estimated_cost_per_load:r,unit:a}).eq("id",c.id).select().single();if(f)throw console.error("Error updating dump site rate:",f),f;return d}else{const{data:d,error:f}=await De.from("dump_site_rates").insert({dump_site_id:t,waste_type:e,estimated_cost_per_load:r,unit:a}).select().single();if(f)throw console.error("Error inserting dump site rate:",f),f;return d}}const n=cr();n.dumpSiteRates||(n.dumpSiteRates=[]);const s=n.dumpSiteRates.findIndex(c=>c.dump_site_id===t&&c.waste_type===e),l={id:s>=0?n.dumpSiteRates[s].id:crypto.randomUUID(),dump_site_id:t,waste_type:e,estimated_cost_per_load:r,unit:a,created_at:new Date().toISOString()};return s>=0?n.dumpSiteRates[s]=l:n.dumpSiteRates.push(l),Xr(n),l},async getDumpSiteRates(t){if(qe){const{data:r,error:a}=await De.from("dump_site_rates").select("*").eq("dump_site_id",t);return a?(console.error("Error fetching dump site rates:",a),[]):r||[]}return(cr().dumpSiteRates||[]).filter(r=>r.dump_site_id===t)},async getHaulOffs(t){if(qe){const{data:r,error:a}=await De.from("haul_offs").select(`
          *,
          dump_sites (name)
        `).eq("project_id",t).order("work_date",{ascending:!1});return a?(console.error("Error fetching haul-offs:",a),[]):r||[]}return(cr().haulOffs||[]).filter(r=>r.project_id===t).sort((r,a)=>new Date(a.work_date)-new Date(r.work_date))},async createHaulOff(t,e){const r={project_id:t,dump_site_id:e.dumpSiteId,waste_type:e.wasteType,loads:e.loads,hauling_company:e.haulingCompany||"",work_date:e.workDate,notes:e.notes||"",estimated_cost:e.estimatedCost||0,created_by:e.createdBy||""};if(qe){const{data:s,error:l}=await De.from("haul_offs").insert(r).select().single();if(l)throw console.error("Error creating haul-off:",l),l;return s}const a=cr();a.haulOffs||(a.haulOffs=[]);const n={...r,id:crypto.randomUUID(),created_at:new Date().toISOString()};return a.haulOffs.push(n),Xr(a),n},async calculateHaulOffCosts(t){const e=await this.getHaulOffs(t);let r=0,a=0;const n={},s=[],l={};e.forEach(d=>{const f=parseFloat(d.estimated_cost)||0,m=parseInt(d.loads)||0;r+=f,a+=m,n[d.waste_type]||(n[d.waste_type]={loads:0,cost:0}),n[d.waste_type].loads+=m,n[d.waste_type].cost+=f,l[d.work_date]||(l[d.work_date]={date:d.work_date,loads:0,cost:0}),l[d.work_date].loads+=m,l[d.work_date].cost+=f}),Object.values(l).sort((d,f)=>new Date(f.date)-new Date(d.date)).forEach(d=>s.push(d));const c=s.length;return{totalCost:r,totalLoads:a,byWasteType:n,byDate:s,daysWithHaulOff:c,avgDailyHaulOffCost:c>0?r/c:0}},subscribeToHaulOffs(t,e){return qe?De.channel(`haul_offs:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"haul_offs",filter:`project_id=eq.${t}`},e).subscribe():null},async createCOR(t){if(qe){const{data:e,error:r}=await De.from("change_orders").insert({company_id:t.company_id,project_id:t.project_id,area_id:t.area_id||null,cor_number:t.cor_number,title:t.title,description:t.description||"",scope_of_work:t.scope_of_work,period_start:t.period_start,period_end:t.period_end,status:"draft",labor_markup_percent:t.labor_markup_percent??1500,materials_markup_percent:t.materials_markup_percent??1500,equipment_markup_percent:t.equipment_markup_percent??1500,subcontractors_markup_percent:t.subcontractors_markup_percent??500,liability_insurance_percent:t.liability_insurance_percent??144,bond_percent:t.bond_percent??100,license_fee_percent:t.license_fee_percent??10,created_by:t.created_by||null}).select().single();if(r)throw r;return e}return null},async updateCOR(t,e){if(qe){const{data:r,error:a}=await De.from("change_orders").update({...e,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return r}return null},async deleteCOR(t){if(qe){const{error:e}=await De.from("change_orders").delete().eq("id",t);if(e)throw e}},async getCORs(t,e={}){if(qe){let r=De.from("change_orders").select(`
          *,
          areas (id, name),
          labor_count:change_order_labor(count),
          materials_count:change_order_materials(count),
          equipment_count:change_order_equipment(count),
          subcontractors_count:change_order_subcontractors(count),
          tickets_count:change_order_ticket_associations(count)
        `).eq("project_id",t);e.status&&(r=r.eq("status",e.status)),e.area_id&&(r=r.eq("area_id",e.area_id)),e.date_start&&(r=r.gte("period_start",e.date_start)),e.date_end&&(r=r.lte("period_end",e.date_end)),r=r.order("created_at",{ascending:!1});const{data:a,error:n}=await r;if(n)throw n;return a}return[]},async getCORById(t){if(qe){const{data:e,error:r}=await De.from("change_orders").select(`
          *,
          areas (id, name),
          change_order_labor (*),
          change_order_materials (*),
          change_order_equipment (*),
          change_order_subcontractors (*),
          change_order_ticket_associations (
            *,
            t_and_m_tickets (
              id, work_date, ce_pco_number, status, notes
            )
          )
        `).eq("id",t).single();if(r)throw r;return e}return null},async getCORsByArea(t,e){if(qe){const{data:r,error:a}=await De.from("change_orders").select("*").eq("project_id",t).eq("area_id",e).order("created_at",{ascending:!1});if(a)throw a;return r}return[]},async getNextCORNumber(t){if(qe){const{data:e,error:r}=await De.from("change_orders").select("cor_number").eq("project_id",t).order("created_at",{ascending:!1}).limit(1);if(r)throw r;if(e&&e.length>0){const a=e[0].cor_number.match(/COR #(\d+)/);if(a)return`COR #${parseInt(a[1])+1}`}return"COR #1"}return"COR #1"},async addCORLaborItem(t,e){if(qe){const r=Math.round(e.regular_hours*e.regular_rate),a=Math.round(e.overtime_hours*e.overtime_rate),n=r+a,{data:s,error:l}=await De.from("change_order_labor").insert({change_order_id:t,labor_class:e.labor_class,wage_type:e.wage_type||"standard",regular_hours:e.regular_hours||0,overtime_hours:e.overtime_hours||0,regular_rate:e.regular_rate||0,overtime_rate:e.overtime_rate||0,regular_total:r,overtime_total:a,total:n,sort_order:e.sort_order||0,source_ticket_id:e.source_ticket_id||null}).select().single();if(l)throw l;return s}return null},async updateCORLaborItem(t,e){if(qe){let r={...e};if(e.regular_hours!==void 0||e.regular_rate!==void 0||e.overtime_hours!==void 0||e.overtime_rate!==void 0){const{data:s}=await De.from("change_order_labor").select("regular_hours, overtime_hours, regular_rate, overtime_rate").eq("id",t).single(),l=e.regular_hours??s?.regular_hours??0,c=e.overtime_hours??s?.overtime_hours??0,d=e.regular_rate??s?.regular_rate??0,f=e.overtime_rate??s?.overtime_rate??0;r.regular_total=Math.round(l*d),r.overtime_total=Math.round(c*f),r.total=r.regular_total+r.overtime_total}const{data:a,error:n}=await De.from("change_order_labor").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCORLaborItem(t){if(qe){const{error:e}=await De.from("change_order_labor").delete().eq("id",t);if(e)throw e}},async addCORMaterialItem(t,e){if(qe){const r=Math.round(e.quantity*e.unit_cost),{data:a,error:n}=await De.from("change_order_materials").insert({change_order_id:t,description:e.description,quantity:e.quantity||1,unit:e.unit||"each",unit_cost:e.unit_cost||0,total:r,source_type:e.source_type||"custom",source_reference:e.source_reference||null,source_ticket_id:e.source_ticket_id||null,sort_order:e.sort_order||0}).select().single();if(n)throw n;return a}return null},async updateCORMaterialItem(t,e){if(qe){let r={...e};if(e.quantity!==void 0||e.unit_cost!==void 0){const{data:s}=await De.from("change_order_materials").select("quantity, unit_cost").eq("id",t).single(),l=e.quantity??s?.quantity??1,c=e.unit_cost??s?.unit_cost??0;r.total=Math.round(l*c)}const{data:a,error:n}=await De.from("change_order_materials").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCORMaterialItem(t){if(qe){const{error:e}=await De.from("change_order_materials").delete().eq("id",t);if(e)throw e}},async addCOREquipmentItem(t,e){if(qe){const r=Math.round(e.quantity*e.unit_cost),{data:a,error:n}=await De.from("change_order_equipment").insert({change_order_id:t,description:e.description,quantity:e.quantity||1,unit:e.unit||"day",unit_cost:e.unit_cost||0,total:r,source_type:e.source_type||"custom",source_reference:e.source_reference||null,source_ticket_id:e.source_ticket_id||null,sort_order:e.sort_order||0}).select().single();if(n)throw n;return a}return null},async updateCOREquipmentItem(t,e){if(qe){let r={...e};if(e.quantity!==void 0||e.unit_cost!==void 0){const{data:s}=await De.from("change_order_equipment").select("quantity, unit_cost").eq("id",t).single(),l=e.quantity??s?.quantity??1,c=e.unit_cost??s?.unit_cost??0;r.total=Math.round(l*c)}const{data:a,error:n}=await De.from("change_order_equipment").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCOREquipmentItem(t){if(qe){const{error:e}=await De.from("change_order_equipment").delete().eq("id",t);if(e)throw e}},async addCORSubcontractorItem(t,e){if(qe){const r=Math.round(e.quantity*e.unit_cost),{data:a,error:n}=await De.from("change_order_subcontractors").insert({change_order_id:t,description:e.description,quantity:e.quantity||1,unit:e.unit||"lump sum",unit_cost:e.unit_cost||0,total:r,source_type:e.source_type||"custom",source_reference:e.source_reference||null,sort_order:e.sort_order||0}).select().single();if(n)throw n;return a}return null},async updateCORSubcontractorItem(t,e){if(qe){let r={...e};if(e.quantity!==void 0||e.unit_cost!==void 0){const{data:s}=await De.from("change_order_subcontractors").select("quantity, unit_cost").eq("id",t).single(),l=e.quantity??s?.quantity??1,c=e.unit_cost??s?.unit_cost??0;r.total=Math.round(l*c)}const{data:a,error:n}=await De.from("change_order_subcontractors").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async deleteCORSubcontractorItem(t){if(qe){const{error:e}=await De.from("change_order_subcontractors").delete().eq("id",t);if(e)throw e}},async addBulkLaborItems(t,e){if(qe&&e.length>0){const r=e.map((s,l)=>{const c=Math.round(s.regular_hours*s.regular_rate),d=Math.round(s.overtime_hours*s.overtime_rate);return{change_order_id:t,labor_class:s.labor_class,wage_type:s.wage_type||"standard",regular_hours:s.regular_hours||0,overtime_hours:s.overtime_hours||0,regular_rate:s.regular_rate||0,overtime_rate:s.overtime_rate||0,regular_total:c,overtime_total:d,total:c+d,sort_order:s.sort_order??l,source_ticket_id:s.source_ticket_id||null}}),{data:a,error:n}=await De.from("change_order_labor").insert(r).select();if(n)throw n;return a}return[]},async addBulkMaterialItems(t,e){if(qe&&e.length>0){const r=e.map((s,l)=>({change_order_id:t,description:s.description,quantity:s.quantity||1,unit:s.unit||"each",unit_cost:s.unit_cost||0,total:Math.round((s.quantity||1)*(s.unit_cost||0)),source_type:s.source_type||"custom",source_reference:s.source_reference||null,source_ticket_id:s.source_ticket_id||null,sort_order:s.sort_order??l})),{data:a,error:n}=await De.from("change_order_materials").insert(r).select();if(n)throw n;return a}return[]},async addBulkEquipmentItems(t,e){if(qe&&e.length>0){const r=e.map((s,l)=>({change_order_id:t,description:s.description,quantity:s.quantity||1,unit:s.unit||"day",unit_cost:s.unit_cost||0,total:Math.round((s.quantity||1)*(s.unit_cost||0)),source_type:s.source_type||"custom",source_reference:s.source_reference||null,source_ticket_id:s.source_ticket_id||null,sort_order:s.sort_order??l})),{data:a,error:n}=await De.from("change_order_equipment").insert(r).select();if(n)throw n;return a}return[]},async addBulkSubcontractorItems(t,e){if(qe&&e.length>0){const r=e.map((s,l)=>({change_order_id:t,description:s.description,quantity:s.quantity||1,unit:s.unit||"lump sum",unit_cost:s.unit_cost||0,total:Math.round((s.quantity||1)*(s.unit_cost||0)),source_type:s.source_type||"custom",source_reference:s.source_reference||null,sort_order:s.sort_order??l})),{data:a,error:n}=await De.from("change_order_subcontractors").insert(r).select();if(n)throw n;return a}return[]},async clearCORLineItems(t){qe&&(await De.from("change_order_labor").delete().eq("change_order_id",t),await De.from("change_order_materials").delete().eq("change_order_id",t),await De.from("change_order_equipment").delete().eq("change_order_id",t),await De.from("change_order_subcontractors").delete().eq("change_order_id",t))},async saveCORLineItems(t,{laborItems:e,materialItems:r,equipmentItems:a,subcontractorItems:n}){if(qe){await this.clearCORLineItems(t);const s=await Promise.all([e?.length>0?this.addBulkLaborItems(t,e):[],r?.length>0?this.addBulkMaterialItems(t,r):[],a?.length>0?this.addBulkEquipmentItems(t,a):[],n?.length>0?this.addBulkSubcontractorItems(t,n):[]]);return{labor:s[0],materials:s[1],equipment:s[2],subcontractors:s[3]}}return null},async assignTicketToCOR(t,e){if(qe){const{data:r,error:a}=await De.from("change_order_ticket_associations").insert({change_order_id:e,ticket_id:t,data_imported:!1}).select().single();if(a)throw a;const{error:n}=await De.from("t_and_m_tickets").update({assigned_cor_id:e}).eq("id",t);if(n)throw n;return r}return null},async unassignTicketFromCOR(t,e){if(qe){const{error:r}=await De.from("change_order_ticket_associations").delete().eq("ticket_id",t).eq("change_order_id",e);if(r)throw r;const{error:a}=await De.from("t_and_m_tickets").update({assigned_cor_id:null}).eq("id",t);if(a)throw a}},async getTicketsForCOR(t){if(qe){const{data:e,error:r}=await De.from("change_order_ticket_associations").select(`
          *,
          t_and_m_tickets (
            *,
            t_and_m_workers (*),
            t_and_m_items (
              *,
              materials_equipment (name, unit, cost_per_unit, category)
            )
          )
        `).eq("change_order_id",t);if(r)throw r;return e}return[]},async getUnassignedTickets(t){if(qe){const{data:e,error:r}=await De.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("project_id",t).is("assigned_cor_id",null).order("work_date",{ascending:!1});if(r)throw r;return e}return[]},async importTicketDataToCOR(t,e,r,a,n){if(qe){const{data:s,error:l}=await De.from("t_and_m_tickets").select(`
          *,
          t_and_m_workers (*),
          t_and_m_items (
            *,
            materials_equipment (name, unit, cost_per_unit, category)
          )
        `).eq("id",t).single();if(l)throw l;const{data:c,error:d}=await De.from("labor_rates").select("*").eq("company_id",r).eq("work_type",a||"demolition").eq("job_type",n||"standard");if(d)throw d;const f={};c?.forEach(_=>{f[_.role.toLowerCase()]=_});const m={};s.t_and_m_workers?.forEach(_=>{const w=(_.role||"laborer").toLowerCase();m[w]||(m[w]={regular_hours:0,overtime_hours:0}),m[w].regular_hours+=parseFloat(_.hours)||0,m[w].overtime_hours+=parseFloat(_.overtime_hours)||0});const v=Object.entries(m).map(([_,w])=>{const E=f[_]||{regular_rate:0,overtime_rate:0},C=Math.round((parseFloat(E.regular_rate)||0)*100),A=Math.round((parseFloat(E.overtime_rate)||0)*100);return{labor_class:_.charAt(0).toUpperCase()+_.slice(1),wage_type:n||"standard",regular_hours:w.regular_hours,overtime_hours:w.overtime_hours,regular_rate:C,overtime_rate:A,source_ticket_id:t}});v.length>0&&await this.addBulkLaborItems(e,v);const x=[],g=[];s.t_and_m_items?.forEach(_=>{const w=_.custom_name||_.materials_equipment?.name||"Unknown Item",E=_.custom_category||_.materials_equipment?.category||"Other",C=_.materials_equipment?.unit||"each",A=Math.round((parseFloat(_.materials_equipment?.cost_per_unit)||0)*100),O={description:w,quantity:_.quantity||1,unit:C,unit_cost:A,source_type:"backup_sheet",source_ticket_id:t};E==="Equipment"?g.push(O):x.push(O)}),x.length>0&&await this.addBulkMaterialItems(e,x),g.length>0&&await this.addBulkEquipmentItems(e,g);const{error:b}=await De.from("change_order_ticket_associations").update({data_imported:!0,imported_at:new Date().toISOString()}).eq("change_order_id",e).eq("ticket_id",t);if(b)throw b;return{laborItems:v,materialItems:x,equipmentItems:g}}return null},async reimportTicketDataToCOR(t,e,r,a,n){return qe?(await De.from("change_order_labor").delete().eq("change_order_id",e).eq("source_ticket_id",t),await De.from("change_order_materials").delete().eq("change_order_id",e).eq("source_ticket_id",t),await De.from("change_order_equipment").delete().eq("change_order_id",e).eq("source_ticket_id",t),this.importTicketDataToCOR(t,e,r,a,n)):null},async recalculateCOR(t){if(qe){const{error:e}=await De.rpc("recalculate_cor_totals",{cor_id:t});if(e)throw e;return this.getCORById(t)}return null},async updateCORMarkupPercentages(t,e){if(qe){const r={};e.labor!==void 0&&(r.labor_markup_percent=e.labor),e.materials!==void 0&&(r.materials_markup_percent=e.materials),e.equipment!==void 0&&(r.equipment_markup_percent=e.equipment),e.subcontractors!==void 0&&(r.subcontractors_markup_percent=e.subcontractors);const{data:a,error:n}=await De.from("change_orders").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async updateCORFeePercentages(t,e){if(qe){const r={};e.liabilityInsurance!==void 0&&(r.liability_insurance_percent=e.liabilityInsurance),e.bond!==void 0&&(r.bond_percent=e.bond),e.licenseFee!==void 0&&(r.license_fee_percent=e.licenseFee);const{data:a,error:n}=await De.from("change_orders").update(r).eq("id",t).select().single();if(n)throw n;return a}return null},async submitCORForApproval(t){if(qe){const{data:e,error:r}=await De.from("change_orders").update({status:"pending_approval",submitted_at:new Date().toISOString()}).eq("id",t).select().single();if(r)throw r;return e}return null},async approveCOR(t,e){if(qe){const{data:r,error:a}=await De.from("change_orders").update({status:"approved",approved_by:e,approved_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return r}return null},async rejectCOR(t,e=null){if(qe){const{data:r,error:a}=await De.from("change_orders").update({status:"rejected",rejection_reason:e}).eq("id",t).select().single();if(a)throw a;return r}return null},async markCORAsBilled(t){if(qe){const{data:e,error:r}=await De.from("change_orders").update({status:"billed"}).eq("id",t).select().single();if(r)throw r;return e}return null},async closeCOR(t){if(qe){const{data:e,error:r}=await De.from("change_orders").update({status:"closed"}).eq("id",t).select().single();if(r)throw r;return e}return null},async saveCORSignature(t,e,r){if(qe){const{data:a,error:n}=await De.from("change_orders").update({gc_signature_data:e,gc_signature_name:r,gc_signature_date:new Date().toISOString(),status:"approved"}).eq("id",t).select().single();if(n)throw n;return a}return null},async getCORStats(t){if(qe){const{data:e,error:r}=await De.from("change_orders").select("status, cor_total").eq("project_id",t);if(r)throw r;const a={total_cors:e.length,draft_count:0,pending_count:0,approved_count:0,rejected_count:0,billed_count:0,total_approved_value:0,total_pending_value:0,total_billed_value:0};return e.forEach(n=>{switch(n.status){case"draft":a.draft_count++;break;case"pending_approval":a.pending_count++,a.total_pending_value+=n.cor_total||0;break;case"approved":a.approved_count++,a.total_approved_value+=n.cor_total||0;break;case"rejected":a.rejected_count++;break;case"billed":case"closed":a.billed_count++,a.total_billed_value+=n.cor_total||0;break}}),a}return{total_cors:0,draft_count:0,pending_count:0,approved_count:0,rejected_count:0,billed_count:0,total_approved_value:0,total_pending_value:0,total_billed_value:0}},subscribeToCORs(t,e){return qe?De.channel(`change_orders:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"change_orders",filter:`project_id=eq.${t}`},e).subscribe():null},async createSignatureRequest(t,e,r,a,n=null,s=null){if(qe){const{data:l,error:c}=await De.rpc("generate_signature_token");if(c)throw c;const{data:d,error:f}=await De.from("signature_requests").insert({document_type:t,document_id:e,company_id:r,project_id:a,signature_token:l,expires_at:s,created_by:n}).select().single();if(f)throw f;return d}return null},async getSignatureRequestByToken(t){if(qe){await De.rpc("increment_signature_view_count",{token:t});const{data:e,error:r}=await De.from("signature_requests").select(`
          *,
          signatures (*)
        `).eq("signature_token",t).single();if(r)throw r;return e}return null},async getSignatureRequestsForDocument(t,e){if(qe){const{data:r,error:a}=await De.from("signature_requests").select(`
          *,
          signatures (*)
        `).eq("document_type",t).eq("document_id",e).order("created_at",{ascending:!1});if(a)throw a;return r||[]}return[]},async addSignature(t,e,r){if(qe){const{data:a,error:n}=await De.from("signatures").insert({signature_request_id:t,signature_slot:e,signature_image:r.signature,signer_name:r.signerName,signer_title:r.signerTitle||null,signer_company:r.signerCompany||null,signed_at:r.signedAt||new Date().toISOString(),ip_address:r.ipAddress||null,user_agent:r.userAgent||null}).select().single();if(n)throw n;return a}return null},async syncSignatureToDocument(t,e){if(!qe)return null;const{document_type:r,document_id:a}=e,n=t.signature_slot,s={};n===1?(s.gc_signature_data=t.signature_image,s.gc_signature_name=t.signer_name,s.gc_signature_title=t.signer_title,s.gc_signature_company=t.signer_company,s.gc_signature_date=t.signed_at,s.gc_signature_ip=t.ip_address):n===2&&(s.client_signature_data=t.signature_image,s.client_signature_name=t.signer_name,s.client_signature_title=t.signer_title,s.client_signature_company=t.signer_company,s.client_signature_date=t.signed_at,s.client_signature_ip=t.ip_address);const l=r==="cor"?"change_orders":"t_and_m_tickets",{data:c,error:d}=await De.from(l).update(s).eq("id",a).select().single();if(d)throw d;return c},async revokeSignatureRequest(t){if(qe){const{data:e,error:r}=await De.from("signature_requests").update({status:"revoked"}).eq("id",t).select().single();if(r)throw r;return e}return null},async getDocumentForSigning(t,e){if(!qe)return null;if(t==="cor"){const{data:r,error:a}=await De.from("change_orders").select(`
          *,
          projects (
            id,
            name,
            job_number,
            companies (
              id,
              name,
              logo_url
            )
          ),
          change_order_labor (*),
          change_order_materials (*),
          change_order_equipment (*),
          change_order_subcontractors (*)
        `).eq("id",e).single();if(a)throw a;return r}else if(t==="tm_ticket"){const{data:r,error:a}=await De.from("t_and_m_tickets").select(`
          *,
          projects (
            id,
            name,
            job_number,
            companies (
              id,
              name,
              logo_url
            )
          ),
          t_and_m_workers (*),
          t_and_m_items (*)
        `).eq("id",e).single();if(a)throw a;return r}return null},async getProjectCosts(t){if(qe){const{data:r,error:a}=await De.from("project_costs").select("*").eq("project_id",t).order("cost_date",{ascending:!1});return a?(console.error("Error fetching project costs:",a),[]):r||[]}return(cr().projectCosts||[]).filter(r=>r.project_id===t).sort((r,a)=>new Date(a.cost_date)-new Date(r.cost_date))},async addProjectCost(t,e,r){const a={project_id:t,company_id:e,category:r.category,description:r.description,amount:parseFloat(r.amount),cost_date:r.cost_date||new Date().toISOString().split("T")[0],notes:r.notes||null,created_by:r.created_by||null};if(qe){const{data:l,error:c}=await De.from("project_costs").insert(a).select().single();if(c)throw console.error("Error adding project cost:",c),c;return l}const n=cr();n.projectCosts||(n.projectCosts=[]);const s={...a,id:crypto.randomUUID(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return n.projectCosts.push(s),Xr(n),s},async updateProjectCost(t,e){const r={category:e.category,description:e.description,amount:parseFloat(e.amount),cost_date:e.cost_date,notes:e.notes||null,updated_at:new Date().toISOString()};if(qe){const{data:s,error:l}=await De.from("project_costs").update(r).eq("id",t).select().single();if(l)throw console.error("Error updating project cost:",l),l;return s}const a=cr();if(!a.projectCosts)return null;const n=a.projectCosts.findIndex(s=>s.id===t);return n===-1?null:(a.projectCosts[n]={...a.projectCosts[n],...r},Xr(a),a.projectCosts[n])},async deleteProjectCost(t){if(qe){const{error:r}=await De.from("project_costs").delete().eq("id",t);if(r)throw console.error("Error deleting project cost:",r),r;return!0}const e=cr();return e.projectCosts&&(e.projectCosts=e.projectCosts.filter(r=>r.id!==t),Xr(e)),!0},async getProjectCostsSummary(t){const e=await this.getProjectCosts(t),r={};let a=0;return e.forEach(n=>{const s=parseFloat(n.amount)||0;a+=s,r[n.category]||(r[n.category]={category:n.category,total:0,count:0,items:[]}),r[n.category].total+=s,r[n.category].count++,r[n.category].items.push(n)}),Object.values(r).forEach(n=>{n.percentage=a>0?n.total/a*100:0}),{totalCost:a,byCategory:r,itemCount:e.length}}};X4(async t=>{if(t&&qe){console.log("Back online - syncing pending actions...");try{const e=await TC(nt);e.synced>0&&console.log(`Synced ${e.synced} pending actions`),e.failed>0&&console.warn(`Failed to sync ${e.failed} actions`)}catch(e){console.error("Error syncing pending actions:",e)}}});const Z4=ee.createContext(),Ti={logo_url:null,favicon_url:null,login_background_url:null,primary_color:"#3B82F6",secondary_color:"#1E40AF",custom_app_name:"FieldSync",hide_fieldsync_branding:!1,email_from_name:"FieldSync",email_from_address:null,custom_domain:null,domain_verified:!1};function Mf({children:t,companyId:e}){const[r,a]=ee.useState(Ti),[n,s]=ee.useState(!0);ee.useEffect(()=>{e?l(e):c()},[e]),ee.useEffect(()=>{m(r)},[r]);const l=async g=>{try{if(s(!0),!qe){a(Ti),s(!1);return}const{data:b,error:_}=await De.from("company_branding").select("*").eq("company_id",g).single();_?(_.code==="PGRST116"?await d(g):console.error("Error loading branding:",_),a(Ti)):a({...Ti,...b})}catch(b){console.error("Error in loadBranding:",b),a(Ti)}finally{s(!1)}},c=async()=>{try{s(!0);const g=window.location.hostname;if(g==="localhost"||g==="127.0.0.1"){a(Ti),s(!1);return}if(!qe){a(Ti),s(!1);return}const{data:b,error:_}=await De.rpc("get_branding_by_domain",{domain_name:g});_||!b||b.length===0?a(Ti):a({...Ti,...b[0]})}catch(g){console.error("Error loading branding by domain:",g),a(Ti)}finally{s(!1)}},d=async g=>{try{const{data:b,error:_}=await De.from("company_branding").insert({company_id:g,...Ti}).select().single();_&&console.error("Error creating default branding:",_)}catch(b){console.error("Error in createDefaultBranding:",b)}},f=async g=>{try{if(!qe)return a(O=>({...O,...g})),{success:!0};if(!e)return{success:!1,error:"No company ID"};const b={},_=["logo_url","favicon_url","login_background_url","primary_color","secondary_color","custom_app_name","hide_fieldsync_branding","email_from_name","email_from_address","custom_domain","domain_verified"];for(const O of _)g[O]!==void 0&&(b[O]=g[O]);const{data:w,error:E}=await De.from("company_branding").select("id").eq("company_id",e).single();if(E&&E.code==="PGRST116"){const{data:O,error:G}=await De.from("company_branding").insert({company_id:e,...b}).select().single();return G?(console.error("Error creating branding:",G),{success:!1,error:G.message}):(a({...Ti,...O}),{success:!0,data:O})}const{data:C,error:A}=await De.from("company_branding").update(b).eq("company_id",e).select().single();return A?(console.error("Error updating branding:",A),{success:!1,error:A.message}):(a({...Ti,...C}),{success:!0,data:C})}catch(b){return console.error("Error in updateBranding:",b),{success:!1,error:b.message}}},m=g=>{const b=document.documentElement;if(b.style.setProperty("--primary-color",g.primary_color),b.style.setProperty("--secondary-color",g.secondary_color),g.favicon_url){let _=document.querySelector("link[rel*='icon']");_||(_=document.createElement("link"),_.rel="icon",document.head.appendChild(_)),_.href=g.favicon_url}document.title=g.custom_app_name||"FieldSync"},x={branding:r,loading:n,updateBranding:f,uploadBrandingImage:async(g,b)=>{try{if(!qe)return{success:!0,url:URL.createObjectURL(g)};const _=g.name.split(".").pop(),E=`branding/${`${e}/${b}-${Date.now()}.${_}`}`,{data:C,error:A}=await De.storage.from("public").upload(E,g,{cacheControl:"3600",upsert:!0});if(A)return console.error("Error uploading image:",A),{success:!1,error:A.message};const{data:{publicUrl:O}}=De.storage.from("public").getPublicUrl(E);return{success:!0,url:O}}catch(_){return console.error("Error in uploadBrandingImage:",_),{success:!1,error:_.message}}},refreshBranding:()=>e?l(e):c()};return i.jsx(Z4.Provider,{value:x,children:t})}function ph(){const t=ee.useContext(Z4);if(!t)throw new Error("useBranding must be used within a BrandingProvider");return t}const FC=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),LC=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,a)=>a?a.toUpperCase():r.toLowerCase()),nw=t=>{const e=LC(t);return e.charAt(0).toUpperCase()+e.slice(1)},Q4=(...t)=>t.filter((e,r,a)=>!!e&&e.trim()!==""&&a.indexOf(e)===r).join(" ").trim(),PC=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var MC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const IC=ee.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:s,iconNode:l,...c},d)=>ee.createElement("svg",{ref:d,...MC,width:e,height:e,stroke:t,strokeWidth:a?Number(r)*24/Number(e):r,className:Q4("lucide",n),...!s&&!PC(c)&&{"aria-hidden":"true"},...c},[...l.map(([f,m])=>ee.createElement(f,m)),...Array.isArray(s)?s:[s]]));const gr=(t,e)=>{const r=ee.forwardRef(({className:a,...n},s)=>ee.createElement(IC,{ref:s,iconNode:e,className:Q4(`lucide-${FC(nw(t))}`,`lucide-${t}`,a),...n}));return r.displayName=nw(t),r};const BC=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],UC=gr("bell",BC);const qC=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],D0=gr("briefcase",qC);const zC=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],n2=gr("building-2",zC);const HC=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Z0=gr("calendar",HC);const $C=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Mp=gr("camera",$C);const WC=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],F0=gr("check",WC);const VC=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],_c=gr("chevron-down",VC);const GC=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],YC=gr("chevron-left",GC);const XC=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Od=gr("chevron-right",XC);const KC=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],s2=gr("chevron-up",KC);const JC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],gh=gr("circle-alert",JC);const ZC=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],pd=gr("circle-check-big",ZC);const QC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],sw=gr("circle-x",QC);const eT=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],uo=gr("clipboard-list",eT);const tT=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Xp=gr("clock",tT);const rT=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],iw=gr("copy",rT);const aT=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Qf=gr("dollar-sign",aT);const nT=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],sT=gr("download",nT);const iT=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],eN=gr("ellipsis",iT);const oT=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ow=gr("external-link",oT);const lT=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],cT=gr("eye",lT);const uT=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ho=gr("file-text",uT);const dT=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],fT=gr("flame",dT);const hT=[["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["rect",{x:"2",y:"15",width:"20",height:"4",rx:"1",key:"g3x8cw"}]],bs=gr("hard-hat",hT);const mT=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],_x=gr("info",mT);const pT=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],lw=gr("layout-grid",pT);const gT=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],i2=gr("link",gT);const vT=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],xT=gr("map-pin",vT);const yT=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],lc=gr("message-square",yT);const _T=[["path",{d:"M5 12h14",key:"1ays0h"}]],bT=gr("minus",_T);const wT=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],bc=gr("package",wT);const ST=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],o2=gr("pen-line",ST);const NT=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],jT=gr("pen-tool",NT);const kT=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],tN=gr("pen",kT);const ET=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],rN=gr("pencil",ET);const AT=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],CT=gr("percent",AT);const TT=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],OT=gr("phone",TT);const RT=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Go=gr("plus",RT);const DT=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],aN=gr("rotate-ccw",DT);const FT=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],cw=gr("save",FT);const LT=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],PT=gr("search",LT);const MT=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],nN=gr("send",MT);const IT=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],sN=gr("shield",IT);const BT=[["path",{d:"M14 13V8.5C14 7 15 7 15 5a3 3 0 0 0-6 0c0 2 1 2 1 3.5V13",key:"i9gjdv"}],["path",{d:"M20 15.5a2.5 2.5 0 0 0-2.5-2.5h-11A2.5 2.5 0 0 0 4 15.5V17a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1z",key:"1vzg3v"}],["path",{d:"M5 22h14",key:"ehvnwv"}]],UT=gr("stamp",BT);const qT=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],uc=gr("trash-2",qT);const zT=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],iN=gr("trending-down",zT);const HT=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],$T=gr("trending-up",HT);const WT=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],x1=gr("triangle-alert",WT);const VT=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],vh=gr("truck",VT);const GT=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],YT=gr("upload",GT);const XT=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],KT=gr("user-check",XT);const JT=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],y1=gr("users",JT);const ZT=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],Q0=gr("wrench",ZT);const QT=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Rd=gr("x",QT);const e8=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],t8=gr("zap",e8);function kl({className:t="",showPoweredBy:e=!1}){const{branding:r}=ph();return i.jsxs("div",{className:`app-logo ${t}`,children:[r.logo_url?i.jsx("img",{src:r.logo_url,alt:r.custom_app_name||"Logo",className:"custom-logo"}):i.jsxs("div",{className:"logo",children:[r.custom_app_name||"Field",i.jsx("span",{children:"Sync"})]}),e&&!r.hide_fieldsync_branding&&i.jsx("div",{className:"powered-by",children:"Powered by FieldSync"})]})}function r8({onForemanAccess:t,onOfficeLogin:e,onShowToast:r}){const[a,n]=ee.useState(null),[s,l]=ee.useState(""),[c,d]=ee.useState(null),[f,m]=ee.useState(""),[v,x]=ee.useState(!1),[g,b]=ee.useState(""),[_,w]=ee.useState(""),[E,C]=ee.useState(1),[A,O]=ee.useState(null),[G,W]=ee.useState(""),[B,q]=ee.useState(""),[L,Z]=ee.useState(""),[D,T]=ee.useState(""),M=F=>{const I=F.toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,20);l(I)},V=async()=>{if(s.length<2){r("Enter company code","error");return}x(!0);try{const F=await nt.getCompanyByCode(s);F?d(F):(r("Invalid company code","error"),l(""))}catch{r("Error checking code","error")}finally{x(!1)}},ie=async F=>{if(F.length===4){x(!0);try{const I=await nt.getProjectByPinAndCompany(F,c.id);I?t(I):(r("Invalid PIN","error"),m(""))}catch{r("Error checking PIN","error")}finally{x(!1)}}},X=F=>{if(f.length<4){const I=f+F;m(I),I.length===4&&setTimeout(()=>ie(I),200)}},J=()=>{m(F=>F.slice(0,-1))},K=()=>{d(null),m("")},te=()=>{if(!g.trim()||!_.trim()){r("Enter email and password","error");return}e(g,_)},fe=async()=>{if(s.length<2){r("Enter company code","error");return}x(!0);try{const F=await nt.getCompanyByCode(s);F?(O(F),C(2)):(r("Invalid company code","error"),l(""))}catch{r("Error checking code","error")}finally{x(!1)}},U=async()=>{if(!G.trim()){r("Enter office code","error");return}x(!0);try{const{data:F,error:I}=await De.rpc("verify_office_code",{company_id:A.id,code:G.trim()});if(I)throw I;F===!0?C(3):(r("Invalid office code","error"),W(""))}catch{r("Error verifying code","error")}finally{x(!1)}},j=async()=>{if(!B.trim()){r("Enter your name","error");return}if(!L.trim()||!L.includes("@")){r("Enter valid email","error");return}if(D.length<6){r("Password must be 6+ characters","error");return}x(!0);try{const{data:F,error:I}=await De.auth.signUp({email:L,password:D});if(I)throw I;const z=F.user?.id;if(!z)throw new Error("Failed to create user");const{error:ne}=await De.from("users").insert({id:z,email:L,password_hash:"managed_by_supabase_auth",name:B.trim(),company_id:A.id,role:"member",is_active:!0});if(ne)throw ne;const{error:se}=await De.from("user_companies").insert({user_id:z,company_id:A.id,role:"member"});se&&console.error("Error adding to user_companies:",se),r("Account created! Logging you in...","success"),setTimeout(()=>{window.location.reload()},1e3)}catch(F){console.error("Join error:",F),r(F.message||"Error creating account","error")}finally{x(!1)}};if(a===null)return i.jsx("div",{className:"entry-container",children:i.jsxs("div",{className:"entry-card",children:[i.jsx(kl,{className:"entry-logo",showPoweredBy:!1}),i.jsxs("div",{className:"entry-buttons",children:[i.jsxs("button",{className:"entry-mode-btn foreman",onClick:()=>n("foreman"),children:[i.jsx("span",{className:"entry-mode-icon",children:i.jsx(bs,{size:32})}),i.jsx("span",{className:"entry-mode-title",children:"Foreman"}),i.jsx("span",{className:"entry-mode-desc",children:"Enter project PIN"})]}),i.jsxs("button",{className:"entry-mode-btn office",onClick:()=>n("office"),children:[i.jsx("span",{className:"entry-mode-icon",children:i.jsx(D0,{size:32})}),i.jsx("span",{className:"entry-mode-title",children:"Office"}),i.jsx("span",{className:"entry-mode-desc",children:"Sign in to dashboard"})]})]})]})});if(a==="foreman")return c?i.jsx("div",{className:"entry-container",children:i.jsxs("div",{className:"entry-card",children:[i.jsx("button",{className:"entry-back",onClick:K,children:""}),i.jsx(kl,{className:"entry-logo",showPoweredBy:!1}),i.jsx("div",{className:"entry-company-badge",children:c.name}),i.jsx("p",{className:"entry-subtitle",children:"Enter project PIN"}),i.jsx("div",{className:"pin-display",children:[0,1,2,3].map(F=>i.jsx("div",{className:`pin-dot ${f.length>F?"filled":""}`,children:f.length>F?"":""},F))}),i.jsxs("div",{className:"number-pad",children:[[1,2,3,4,5,6,7,8,9].map(F=>i.jsx("button",{className:"num-btn",onClick:()=>X(F.toString()),disabled:v,children:F},F)),i.jsx("button",{className:"num-btn empty",disabled:!0}),i.jsx("button",{className:"num-btn",onClick:()=>X("0"),disabled:v,children:"0"}),i.jsx("button",{className:"num-btn backspace",onClick:J,disabled:v||f.length===0,children:""})]}),v&&i.jsx("div",{className:"entry-loading",children:i.jsx("div",{className:"spinner"})})]})}):i.jsx("div",{className:"entry-container",children:i.jsxs("div",{className:"entry-card",children:[i.jsx("button",{className:"entry-back",onClick:()=>n(null),children:""}),i.jsx(kl,{className:"entry-logo",showPoweredBy:!1}),i.jsx("p",{className:"entry-subtitle",children:"Enter company code"}),i.jsxs("div",{className:"entry-input-group",children:[i.jsx("input",{type:"text",value:s,onChange:F=>M(F.target.value),placeholder:"Company Code",disabled:v,autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&V()}}),i.jsx("button",{className:"entry-submit-btn",onClick:V,disabled:v||s.length<2,children:v?"...":""})]})]})});if(a==="office")return i.jsx("div",{className:"entry-container",children:i.jsxs("div",{className:"entry-card",children:[i.jsx("button",{className:"entry-back",onClick:()=>n(null),children:""}),i.jsx(kl,{className:"entry-logo",showPoweredBy:!1}),i.jsx("p",{className:"entry-subtitle",children:"Sign in to your account"}),i.jsxs("div",{className:"entry-form",children:[i.jsx("input",{type:"email",value:g,onChange:F=>b(F.target.value),placeholder:"Email",autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&te()}}),i.jsx("input",{type:"password",value:_,onChange:F=>w(F.target.value),placeholder:"Password",onKeyDown:F=>{F.key==="Enter"&&te()}}),i.jsx("button",{className:"entry-login-btn",onClick:te,children:"Sign In"})]}),i.jsxs("div",{className:"entry-signup-hint",children:[i.jsx("p",{children:"New employee?"}),i.jsx("button",{className:"entry-join-link",onClick:()=>n("join"),children:"Join your company"})]})]})});if(a==="join")return E===1?i.jsx("div",{className:"entry-container",children:i.jsxs("div",{className:"entry-card",children:[i.jsx("button",{className:"entry-back",onClick:()=>n("office"),children:""}),i.jsx(kl,{className:"entry-logo",showPoweredBy:!1}),i.jsx("p",{className:"entry-subtitle",children:"Enter your company code"}),i.jsx("p",{className:"entry-hint",children:"Ask your manager or admin for the code"}),i.jsxs("div",{className:"entry-input-group",children:[i.jsx("input",{type:"text",value:s,onChange:F=>M(F.target.value),placeholder:"Company Code",disabled:v,autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&fe()}}),i.jsx("button",{className:"entry-submit-btn",onClick:fe,disabled:v||s.length<2,children:v?"...":""})]})]})}):E===2?i.jsx("div",{className:"entry-container",children:i.jsxs("div",{className:"entry-card",children:[i.jsx("button",{className:"entry-back",onClick:()=>{C(1),O(null),W("")},children:""}),i.jsx(kl,{className:"entry-logo",showPoweredBy:!1}),i.jsx("div",{className:"entry-company-badge",children:A?.name}),i.jsx("p",{className:"entry-subtitle",children:"Enter office code"}),i.jsx("p",{className:"entry-hint",children:"This code is only for office staff"}),i.jsxs("div",{className:"entry-input-group",children:[i.jsx("input",{type:"password",value:G,onChange:F=>W(F.target.value),placeholder:"Office Code",disabled:v,autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&U()}}),i.jsx("button",{className:"entry-submit-btn",onClick:U,disabled:v||!G.trim(),children:v?"...":""})]})]})}):i.jsx("div",{className:"entry-container",children:i.jsxs("div",{className:"entry-card",children:[i.jsx("button",{className:"entry-back",onClick:()=>{C(2),W("")},children:""}),i.jsx(kl,{className:"entry-logo",showPoweredBy:!1}),i.jsx("div",{className:"entry-company-badge",children:A?.name}),i.jsx("p",{className:"entry-subtitle",children:"Create your account"}),i.jsxs("div",{className:"entry-form",children:[i.jsx("input",{type:"text",value:B,onChange:F=>q(F.target.value),placeholder:"Your Name",autoFocus:!0}),i.jsx("input",{type:"email",value:L,onChange:F=>Z(F.target.value),placeholder:"Email"}),i.jsx("input",{type:"password",value:D,onChange:F=>T(F.target.value),placeholder:"Password (6+ characters)",onKeyDown:F=>{F.key==="Enter"&&j()}}),i.jsx("button",{className:"entry-login-btn",onClick:j,disabled:v,children:v?"Creating...":"Join Company"})]}),i.jsx("p",{className:"entry-join-note",children:"You'll join as a team member. Your admin can update your role."})]})})}function Ua(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}function a8(t){if(!t||t.length===0)return 0;let e=0;return t.forEach(r=>{r.status==="done"&&(e+=r.weight)}),Math.round(e)}function uw(t){if(!t||t.length===0)return{progress:0,earnedValue:0,totalValue:0,isValueBased:!1};if(t.some(a=>a.scheduled_value>0)){const a=t.reduce((l,c)=>l+(c.scheduled_value||0),0),n=t.filter(l=>l.status==="done").reduce((l,c)=>l+(c.scheduled_value||0),0);return{progress:a>0?Math.round(n/a*100):0,earnedValue:n,totalValue:a,isValueBased:!0}}const r=t.filter(a=>a.status==="done").reduce((a,n)=>a+(n.weight||0),0);return{progress:Math.round(r),earnedValue:0,totalValue:0,isValueBased:!1}}function oN(t){if(!t||t.length===0)return"not_started";const e=t.some(n=>n.status==="working"),r=t.some(n=>n.status==="done");return t.every(n=>n.status==="done")?"done":e||r?"working":"not_started"}function n8(t){const e=oN(t);return e==="done"?"Complete":e==="working"?"In Progress":"Not Started"}const dw=["Containment","PPE","Disposal","Equipment"];function s8({project:t,companyId:e,maxPhotos:r=10,onSubmit:a,onCancel:n,onShowToast:s}){const[l,c]=ee.useState(1),[d,f]=ee.useState(new Date().toISOString().split("T")[0]),[m,v]=ee.useState(""),[x,g]=ee.useState(""),[b,_]=ee.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}]),[w,E]=ee.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}]),[C,A]=ee.useState([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}]),[O,G]=ee.useState([]),[W,B]=ee.useState(""),[q,L]=ee.useState([]),[Z,D]=ee.useState(!1),[T,M]=ee.useState(""),[V,ie]=ee.useState([]),[X,J]=ee.useState(!1),[K,te]=ee.useState(null),[fe,U]=ee.useState([]),[j,F]=ee.useState(!1),[I,z]=ee.useState(!1),[ne,se]=ee.useState({name:"",category:"",quantity:""});ee.useEffect(()=>{je()},[t.id]);const je=async()=>{try{const Te=await nt.getCrewCheckin(t.id);Te?.workers&&ie(Te.workers)}catch(Te){console.error("Error loading crew:",Te)}};ee.useEffect(()=>{K&&e&&Ne(K)},[K,e]);const Ne=async Te=>{F(!0);try{const Ve=await nt.getMaterialsEquipmentByCategory(e,Te);U(Ve)}catch(Ve){console.error("Error loading items:",Ve),s("Error loading items","error")}finally{F(!1)}},ge=()=>{_([...b,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}])},Ie=(Te,Ve,_e)=>{_(b.map((Ue,Fe)=>Fe===Te?{...Ue,[Ve]:_e}:Ue))},le=Te=>{b.length>1?_(b.filter((Ve,_e)=>_e!==Te)):_([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:"Foreman"}])},Ge=()=>{A([...C,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},rt=(Te,Ve,_e)=>{A(C.map((Ue,Fe)=>Fe===Te?{...Ue,[Ve]:_e}:Ue))},ue=Te=>{C.length>1?A(C.filter((Ve,_e)=>_e!==Te)):A([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},ot=()=>{E([...w,{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},xe=(Te,Ve,_e)=>{E(w.map((Ue,Fe)=>Fe===Te?{...Ue,[Ve]:_e}:Ue))},ve=Te=>{w.length>1?E(w.filter((Ve,_e)=>_e!==Te)):E([{name:"",hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])},Be=Te=>{const Ve=O.findIndex(_e=>_e.material_equipment_id===Te.id);Ve>=0?G(O.map((_e,Ue)=>Ue===Ve?{..._e,quantity:_e.quantity+1}:_e)):G([...O,{material_equipment_id:Te.id,name:Te.name,unit:Te.unit,category:Te.category,quantity:1,isCustom:!1}]),s(`Added ${Te.name}`,"success")},jt=()=>{if(!ne.name||!ne.category||!ne.quantity){s("Fill in all fields","error");return}G([...O,{material_equipment_id:null,custom_name:ne.name,custom_category:ne.category,name:ne.name,category:ne.category,quantity:parseFloat(ne.quantity),unit:"each",isCustom:!0}]),se({name:"",category:"",quantity:""}),z(!1),te(null),s("Custom item added","success")},Je=(Te,Ve)=>{const _e=parseFloat(Ve)||0;_e<=0?ct(Te):G(O.map((Ue,Fe)=>Fe===Te?{...Ue,quantity:_e}:Ue))},ct=Te=>{G(O.filter((Ve,_e)=>_e!==Te))},St=Te=>{const Ve=Array.from(Te.target.files);if(Ve.length===0)return;const _e=r===-1?1/0:r-q.length;if(_e<=0){s(`Photo limit reached (${r} max)`,"error"),Te.target.value="";return}const Ue=Ve.slice(0,_e);Ue.length<Ve.length&&s(`Only ${Ue.length} photo(s) added (${r} max)`,"error"),Ue.forEach(Fe=>{if(!Fe.type.startsWith("image/")){s("Please select an image file","error");return}const gt=URL.createObjectURL(Fe);L(Ht=>[...Ht,{id:Date.now()+Math.random(),file:Fe,previewUrl:gt,name:Fe.name}])}),Te.target.value=""},Ft=Te=>{const Ve=q.find(_e=>_e.id===Te);Ve?.previewUrl&&URL.revokeObjectURL(Ve.previewUrl),L(q.filter(_e=>_e.id!==Te))},Xt=()=>{if(l===1){const Te=b.some(Ue=>Ue.name.trim()&&(parseFloat(Ue.hours)>0||parseFloat(Ue.overtimeHours)>0)),Ve=w.some(Ue=>Ue.name.trim()&&(parseFloat(Ue.hours)>0||parseFloat(Ue.overtimeHours)>0)),_e=C.some(Ue=>Ue.name.trim()&&(parseFloat(Ue.hours)>0||parseFloat(Ue.overtimeHours)>0));return Te||Ve||_e}return!0},Ut=()=>{l<3&&c(l+1)},Wt=()=>{K?(te(null),z(!1)):I?z(!1):l>1?c(l-1):n()},$t=async()=>{if(!x.trim()){s("Enter your name to submit","error");return}const Te=b.filter(Ue=>Ue.name.trim()&&(parseFloat(Ue.hours)>0||parseFloat(Ue.overtimeHours)>0)),Ve=w.filter(Ue=>Ue.name.trim()&&(parseFloat(Ue.hours)>0||parseFloat(Ue.overtimeHours)>0)),_e=C.filter(Ue=>Ue.name.trim()&&(parseFloat(Ue.hours)>0||parseFloat(Ue.overtimeHours)>0));if(Te.length===0&&Ve.length===0&&_e.length===0){s("Add at least one worker","error");return}D(!0),M("Creating ticket...");try{const Ue=await nt.createTMTicket({project_id:t.id,work_date:d,ce_pco_number:m.trim()||null,notes:W.trim()||null,photos:[],created_by_name:x.trim()});let Fe=[];if(q.length>0){M(`Uploading ${q.length} photo${q.length>1?"s":""}...`);const Ht=q.map(zt=>nt.uploadPhoto(e,t.id,Ue.id,zt.file).catch(kt=>(console.error("Error uploading photo:",kt),null)));Fe=(await Promise.all(Ht)).filter(zt=>zt!==null)}Fe.length>0&&(M("Saving photos..."),await nt.updateTMTicketPhotos(Ue.id,Fe));const gt=[...Te.map(Ht=>({name:Ht.name.trim(),hours:parseFloat(Ht.hours)||0,overtime_hours:parseFloat(Ht.overtimeHours)||0,time_started:Ht.timeStarted||null,time_ended:Ht.timeEnded||null,role:Ht.role})),...Ve.map(Ht=>({name:Ht.name.trim(),hours:parseFloat(Ht.hours)||0,overtime_hours:parseFloat(Ht.overtimeHours)||0,time_started:Ht.timeStarted||null,time_ended:Ht.timeEnded||null,role:"Operator"})),..._e.map(Ht=>({name:Ht.name.trim(),hours:parseFloat(Ht.hours)||0,overtime_hours:parseFloat(Ht.overtimeHours)||0,time_started:Ht.timeStarted||null,time_ended:Ht.timeEnded||null,role:"Laborer"}))];M("Saving workers..."),await nt.addTMWorkers(Ue.id,gt),O.length>0&&(M("Saving materials..."),await nt.addTMItems(Ue.id,O.map(Ht=>({material_equipment_id:Ht.material_equipment_id,custom_name:Ht.custom_name||null,custom_category:Ht.custom_category||null,quantity:Ht.quantity})))),q.forEach(Ht=>{Ht.previewUrl&&URL.revokeObjectURL(Ht.previewUrl)}),s("T&M submitted!","success"),a()}catch(Ue){console.error("Error submitting T&M:",Ue),s("Error submitting T&M","error")}finally{D(!1),M("")}},wt=b.filter(Te=>Te.name.trim()&&(parseFloat(Te.hours)>0||parseFloat(Te.overtimeHours)>0)),Ce=w.filter(Te=>Te.name.trim()&&(parseFloat(Te.hours)>0||parseFloat(Te.overtimeHours)>0)),st=C.filter(Te=>Te.name.trim()&&(parseFloat(Te.hours)>0||parseFloat(Te.overtimeHours)>0)),Dt=wt.length+Ce.length+st.length,At=[...wt,...Ce,...st].reduce((Te,Ve)=>Te+parseFloat(Ve.hours||0),0),Ct=[...wt,...Ce,...st].reduce((Te,Ve)=>Te+parseFloat(Ve.overtimeHours||0),0);return O.reduce((Te,Ve)=>Te+Ve.quantity,0),l===2&&(K||I)?i.jsxs("div",{className:"tm-wizard",children:[i.jsxs("div",{className:"tm-wizard-header",children:[i.jsx("button",{className:"tm-back-btn",onClick:Wt,children:""}),i.jsx("h2",{children:I?"Add Custom Item":K}),i.jsxs("div",{className:"tm-item-count",children:[O.length," items"]})]}),I?i.jsxs("div",{className:"tm-custom-form",children:[i.jsxs("div",{className:"tm-field",children:[i.jsx("label",{children:"Item Name"}),i.jsx("input",{type:"text",placeholder:"What did you use?",value:ne.name,onChange:Te=>se({...ne,name:Te.target.value}),autoFocus:!0})]}),i.jsxs("div",{className:"tm-field",children:[i.jsx("label",{children:"Category"}),i.jsx("div",{className:"tm-category-select",children:dw.map(Te=>i.jsx("button",{className:`tm-cat-chip ${ne.category===Te?"active":""}`,onClick:()=>se({...ne,category:Te}),children:Te},Te))})]}),i.jsxs("div",{className:"tm-field",children:[i.jsx("label",{children:"Quantity"}),i.jsx("input",{type:"number",placeholder:"How many?",value:ne.quantity,onChange:Te=>se({...ne,quantity:Te.target.value})})]}),i.jsx("button",{className:"tm-big-btn primary",onClick:jt,children:"Add Custom Item"})]}):i.jsx("div",{className:"tm-item-grid",children:j?i.jsx("div",{className:"tm-loading",children:"Loading..."}):i.jsxs(i.Fragment,{children:[fe.map(Te=>{const Ve=O.find(_e=>_e.material_equipment_id===Te.id);return i.jsxs("button",{className:`tm-item-card ${Ve?"added":""}`,onClick:()=>Be(Te),children:[i.jsx("span",{className:"tm-item-name",children:Te.name}),i.jsx("span",{className:"tm-item-unit",children:Te.unit}),Ve&&i.jsx("span",{className:"tm-item-badge",children:Ve.quantity})]},Te.id)}),i.jsxs("button",{className:"tm-item-card custom",onClick:()=>z(!0),children:[i.jsx("span",{className:"tm-item-name",children:"+ Add Other"}),i.jsx("span",{className:"tm-item-unit",children:"Not on list"})]})]})}),!I&&O.length>0&&i.jsx("div",{className:"tm-wizard-footer",children:i.jsxs("button",{className:"tm-big-btn primary",onClick:()=>te(null),children:["Done Adding (",O.length," items)"]})})]}):i.jsxs("div",{className:"tm-wizard",children:[i.jsxs("div",{className:"tm-wizard-header",children:[i.jsx("button",{className:"tm-back-btn",onClick:Wt,children:""}),i.jsxs("h2",{children:[l===1&&"Workers",l===2&&"Materials & Equipment",l===3&&"Review"]}),i.jsxs("div",{className:"tm-step-dots",children:[i.jsx("span",{className:`tm-dot ${l>=1?"active":""}`}),i.jsx("span",{className:`tm-dot ${l>=2?"active":""}`}),i.jsx("span",{className:`tm-dot ${l>=3?"active":""}`})]})]}),l===1&&i.jsxs("div",{className:"tm-step-content",children:[i.jsxs("div",{className:"tm-project-info",children:[t.job_number&&i.jsxs("div",{className:"tm-project-detail",children:[i.jsx("span",{className:"tm-project-label",children:"Job #"}),i.jsx("span",{className:"tm-project-value",children:t.job_number})]}),i.jsxs("div",{className:"tm-project-detail",children:[i.jsx("span",{className:"tm-project-label",children:"Project"}),i.jsx("span",{className:"tm-project-value",children:t.name})]}),t.address&&i.jsxs("div",{className:"tm-project-detail",children:[i.jsx("span",{className:"tm-project-label",children:"Address"}),i.jsx("span",{className:"tm-project-value",children:t.address})]}),t.general_contractor&&i.jsxs("div",{className:"tm-project-detail",children:[i.jsx("span",{className:"tm-project-label",children:"GC"}),i.jsx("span",{className:"tm-project-value",children:t.general_contractor})]})]}),i.jsxs("div",{className:"tm-field-row",children:[i.jsxs("div",{className:"tm-field tm-field-half",children:[i.jsx("label",{children:"Date"}),i.jsx("input",{type:"date",value:d,onChange:Te=>f(Te.target.value),className:"tm-date"})]}),i.jsxs("div",{className:"tm-field tm-field-half",children:[i.jsx("label",{children:"CE / PCO #"}),i.jsx("input",{type:"text",placeholder:"Change Event / PCO",value:m,onChange:Te=>v(Te.target.value),className:"tm-input"})]})]}),V.length>0&&i.jsxs("div",{className:"tm-crew-picker",children:[i.jsxs("button",{className:"tm-crew-picker-btn",onClick:()=>J(!X),children:[i.jsx(bs,{size:16})," ",X?"Hide":"Select from"," Today's Crew (",V.length,")"]}),X&&i.jsx("div",{className:"tm-crew-list",children:V.map((Te,Ve)=>{const _e=b.some(Ue=>Ue.name.toLowerCase()===Te.name.toLowerCase())||w.some(Ue=>Ue.name.toLowerCase()===Te.name.toLowerCase())||C.some(Ue=>Ue.name.toLowerCase()===Te.name.toLowerCase());return i.jsxs("button",{className:`tm-crew-item ${_e?"added":""}`,onClick:()=>{if(!_e){if(Te.role==="Foreman"||Te.role==="Supervisor"){const Ue=b.findIndex(Fe=>!Fe.name.trim());Ue>=0?Ie(Ue,"name",Te.name):_([...b,{name:Te.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:"",role:Te.role==="Supervisor"?"Superintendent":"Foreman"}])}else if(Te.role==="Operator"){const Ue=w.findIndex(Fe=>!Fe.name.trim());Ue>=0?xe(Ue,"name",Te.name):E([...w,{name:Te.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])}else{const Ue=C.findIndex(Fe=>!Fe.name.trim());Ue>=0?rt(Ue,"name",Te.name):A([...C,{name:Te.name,hours:"",overtimeHours:"",timeStarted:"",timeEnded:""}])}s(`Added ${Te.name}`,"success")}},disabled:_e,children:[i.jsx("span",{className:"tm-crew-item-name",children:Te.name}),i.jsx("span",{className:`tm-crew-item-role ${(Te.role||"laborer").toLowerCase()}`,children:Te.role||"Laborer"}),_e&&i.jsx("span",{className:"tm-crew-item-check",children:""})]},Ve)})})]}),i.jsxs("div",{className:"tm-field",children:[i.jsx("label",{children:"Supervision"}),i.jsx("div",{className:"tm-workers-list",children:b.map((Te,Ve)=>i.jsxs("div",{className:"tm-worker-card-expanded",children:[i.jsxs("div",{className:"tm-worker-row-top",children:[i.jsx("div",{className:"tm-role-select",children:i.jsxs("select",{value:Te.role,onChange:_e=>Ie(Ve,"role",_e.target.value),children:[i.jsx("option",{value:"Foreman",children:"Foreman"}),i.jsx("option",{value:"Superintendent",children:"Superintendent"})]})}),i.jsx("input",{type:"text",placeholder:"First & Last Name",value:Te.name,onChange:_e=>Ie(Ve,"name",_e.target.value),className:"tm-worker-input"}),i.jsx("button",{className:"tm-remove",onClick:()=>le(Ve),children:""})]}),i.jsxs("div",{className:"tm-worker-row-bottom",children:[i.jsxs("div",{className:"tm-time-group",children:[i.jsx("label",{children:"Start"}),i.jsx("input",{type:"time",value:Te.timeStarted,onChange:_e=>Ie(Ve,"timeStarted",_e.target.value)})]}),i.jsxs("div",{className:"tm-time-group",children:[i.jsx("label",{children:"End"}),i.jsx("input",{type:"time",value:Te.timeEnded,onChange:_e=>Ie(Ve,"timeEnded",_e.target.value)})]}),i.jsxs("div",{className:"tm-time-group",children:[i.jsx("label",{children:"Reg Hrs"}),i.jsx("input",{type:"number",placeholder:"0",value:Te.hours,onChange:_e=>Ie(Ve,"hours",_e.target.value)})]}),i.jsxs("div",{className:"tm-time-group",children:[i.jsx("label",{children:"OT Hrs"}),i.jsx("input",{type:"number",placeholder:"0",value:Te.overtimeHours,onChange:_e=>Ie(Ve,"overtimeHours",_e.target.value)})]})]})]},Ve))}),i.jsx("button",{className:"tm-add-btn",onClick:ge,children:"+ Add Supervision"})]}),i.jsxs("div",{className:"tm-field",children:[i.jsx("label",{children:"Operators"}),i.jsx("div",{className:"tm-workers-list",children:w.map((Te,Ve)=>i.jsxs("div",{className:"tm-worker-card-expanded",children:[i.jsxs("div",{className:"tm-worker-row-top",children:[i.jsx("input",{type:"text",placeholder:"First & Last Name",value:Te.name,onChange:_e=>xe(Ve,"name",_e.target.value),className:"tm-worker-input"}),i.jsx("button",{className:"tm-remove",onClick:()=>ve(Ve),children:""})]}),i.jsxs("div",{className:"tm-worker-row-bottom",children:[i.jsxs("div",{className:"tm-time-group",children:[i.jsx("label",{children:"Start"}),i.jsx("input",{type:"time",value:Te.timeStarted,onChange:_e=>xe(Ve,"timeStarted",_e.target.value)})]}),i.jsxs("div",{className:"tm-time-group",children:[i.jsx("label",{children:"End"}),i.jsx("input",{type:"time",value:Te.timeEnded,onChange:_e=>xe(Ve,"timeEnded",_e.target.value)})]}),i.jsxs("div",{className:"tm-time-group",children:[i.jsx("label",{children:"Reg Hrs"}),i.jsx("input",{type:"number",placeholder:"0",value:Te.hours,onChange:_e=>xe(Ve,"hours",_e.target.value)})]}),i.jsxs("div",{className:"tm-time-group",children:[i.jsx("label",{children:"OT Hrs"}),i.jsx("input",{type:"number",placeholder:"0",value:Te.overtimeHours,onChange:_e=>xe(Ve,"overtimeHours",_e.target.value)})]})]})]},Ve))}),i.jsx("button",{className:"tm-add-btn",onClick:ot,children:"+ Add Operator"})]}),i.jsxs("div",{className:"tm-field",children:[i.jsx("label",{children:"Laborers"}),i.jsx("div",{className:"tm-workers-list",children:C.map((Te,Ve)=>i.jsxs("div",{className:"tm-worker-card-expanded",children:[i.jsxs("div",{className:"tm-worker-row-top",children:[i.jsx("input",{type:"text",placeholder:"First & Last Name",value:Te.name,onChange:_e=>rt(Ve,"name",_e.target.value),className:"tm-worker-input"}),i.jsx("button",{className:"tm-remove",onClick:()=>ue(Ve),children:""})]}),i.jsxs("div",{className:"tm-worker-row-bottom",children:[i.jsxs("div",{className:"tm-time-group",children:[i.jsx("label",{children:"Start"}),i.jsx("input",{type:"time",value:Te.timeStarted,onChange:_e=>rt(Ve,"timeStarted",_e.target.value)})]}),i.jsxs("div",{className:"tm-time-group",children:[i.jsx("label",{children:"End"}),i.jsx("input",{type:"time",value:Te.timeEnded,onChange:_e=>rt(Ve,"timeEnded",_e.target.value)})]}),i.jsxs("div",{className:"tm-time-group",children:[i.jsx("label",{children:"Reg Hrs"}),i.jsx("input",{type:"number",placeholder:"0",value:Te.hours,onChange:_e=>rt(Ve,"hours",_e.target.value)})]}),i.jsxs("div",{className:"tm-time-group",children:[i.jsx("label",{children:"OT Hrs"}),i.jsx("input",{type:"number",placeholder:"0",value:Te.overtimeHours,onChange:_e=>rt(Ve,"overtimeHours",_e.target.value)})]})]})]},Ve))}),i.jsx("button",{className:"tm-add-btn",onClick:Ge,children:"+ Add Laborer"})]}),i.jsxs("div",{className:"tm-field",children:[i.jsx("label",{children:"Description of Work"}),i.jsx("textarea",{placeholder:"What work was performed today?",value:W,onChange:Te=>B(Te.target.value),rows:3,className:"tm-description"})]}),i.jsxs("div",{className:"tm-field",children:[i.jsxs("label",{children:[i.jsx(Mp,{size:16,className:"inline-icon"})," Photos",r!==-1&&i.jsxs("span",{className:"tm-photo-count",children:["(",q.length,"/",r,")"]})]}),q.length>0&&i.jsx("div",{className:"tm-photo-grid",children:q.map(Te=>i.jsxs("div",{className:"tm-photo-item",children:[i.jsx("img",{src:Te.previewUrl,alt:Te.name}),i.jsx("button",{className:"tm-photo-remove",onClick:()=>Ft(Te.id),children:""})]},Te.id))}),(r===-1||q.length<r)&&i.jsxs("label",{className:"tm-photo-btn",children:[i.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:St,style:{display:"none"}}),i.jsx(Mp,{size:16,className:"inline-icon"})," ",q.length>0?"Add More Photos":"Add Photos"]}),r!==-1&&q.length>=r&&i.jsxs("div",{className:"tm-photo-limit-reached",children:["Photo limit reached (",r," max)"]})]})]}),l===2&&!K&&i.jsxs("div",{className:"tm-step-content",children:[i.jsxs("div",{className:"tm-field",children:[i.jsx("label",{children:"What was used?"}),i.jsx("div",{className:"tm-category-grid",children:dw.map(Te=>{const Ve=O.filter(_e=>_e.category===Te);return i.jsxs("button",{className:"tm-category-card",onClick:()=>te(Te),children:[i.jsx("span",{className:"tm-cat-name",children:Te}),Ve.length>0&&i.jsx("span",{className:"tm-cat-count",children:Ve.length})]},Te)})})]}),O.length>0&&i.jsxs("div",{className:"tm-field",children:[i.jsxs("label",{children:["Added Items (",O.length,")"]}),i.jsx("div",{className:"tm-added-list",children:O.map((Te,Ve)=>i.jsxs("div",{className:"tm-added-item",children:[i.jsxs("div",{className:"tm-added-info",children:[Te.isCustom&&i.jsx("span",{className:"tm-custom-badge",children:"Custom"}),i.jsx("span",{className:"tm-added-name",children:Te.name})]}),i.jsxs("div",{className:"tm-added-qty",children:[i.jsx("button",{onClick:()=>Je(Ve,Te.quantity-1),children:""}),i.jsx("span",{children:Te.quantity}),i.jsx("button",{onClick:()=>Je(Ve,Te.quantity+1),children:"+"})]})]},Ve))})]})]}),l===3&&i.jsxs("div",{className:"tm-step-content",children:[i.jsx("div",{className:"tm-review-section",children:i.jsxs("div",{className:"tm-review-header",children:[i.jsx("span",{children:" Date"}),i.jsx("span",{children:new Date(d).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})]})}),W&&i.jsxs("div",{className:"tm-review-section",children:[i.jsx("div",{className:"tm-review-header",children:i.jsxs("span",{children:[i.jsx(ho,{size:16,className:"inline-icon"})," Description"]})}),i.jsx("div",{className:"tm-review-notes",children:W})]}),q.length>0&&i.jsxs("div",{className:"tm-review-section",children:[i.jsxs("div",{className:"tm-review-header",children:[i.jsxs("span",{children:[i.jsx(Mp,{size:16,className:"inline-icon"})," Photos"]}),i.jsx("span",{children:q.length})]}),i.jsx("div",{className:"tm-review-photos",children:q.map(Te=>i.jsx("img",{src:Te.previewUrl,alt:Te.name},Te.id))})]}),wt.length>0&&i.jsxs("div",{className:"tm-review-section",children:[i.jsxs("div",{className:"tm-review-header",children:[i.jsxs("span",{children:[i.jsx(KT,{size:16,className:"inline-icon"})," Supervision"]}),i.jsxs("span",{children:[wt.reduce((Te,Ve)=>Te+parseFloat(Ve.hours||0)+parseFloat(Ve.overtimeHours||0),0)," hrs"]})]}),i.jsx("div",{className:"tm-review-list",children:wt.map((Te,Ve)=>i.jsxs("div",{className:"tm-review-row-detailed",children:[i.jsxs("div",{className:"tm-review-worker-name",children:[i.jsx("span",{className:"tm-role-badge",children:Te.role})," ",Te.name]}),i.jsxs("div",{className:"tm-review-worker-details",children:[Te.timeStarted&&Te.timeEnded&&i.jsxs("span",{className:"tm-review-time",children:[Te.timeStarted," - ",Te.timeEnded]}),i.jsxs("span",{className:"tm-review-hours",children:[Te.hours||0," reg",parseFloat(Te.overtimeHours)>0?` + ${Te.overtimeHours} OT`:""]})]})]},Ve))})]}),Ce.length>0&&i.jsxs("div",{className:"tm-review-section",children:[i.jsxs("div",{className:"tm-review-header",children:[i.jsx("span",{children:" Operators"}),i.jsxs("span",{children:[Ce.reduce((Te,Ve)=>Te+parseFloat(Ve.hours||0)+parseFloat(Ve.overtimeHours||0),0)," hrs"]})]}),i.jsx("div",{className:"tm-review-list",children:Ce.map((Te,Ve)=>i.jsxs("div",{className:"tm-review-row-detailed",children:[i.jsx("div",{className:"tm-review-worker-name",children:Te.name}),i.jsxs("div",{className:"tm-review-worker-details",children:[Te.timeStarted&&Te.timeEnded&&i.jsxs("span",{className:"tm-review-time",children:[Te.timeStarted," - ",Te.timeEnded]}),i.jsxs("span",{className:"tm-review-hours",children:[Te.hours||0," reg",parseFloat(Te.overtimeHours)>0?` + ${Te.overtimeHours} OT`:""]})]})]},Ve))})]}),st.length>0&&i.jsxs("div",{className:"tm-review-section",children:[i.jsxs("div",{className:"tm-review-header",children:[i.jsxs("span",{children:[i.jsx(bs,{size:16,className:"inline-icon"})," Laborers"]}),i.jsxs("span",{children:[st.reduce((Te,Ve)=>Te+parseFloat(Ve.hours||0)+parseFloat(Ve.overtimeHours||0),0)," hrs"]})]}),i.jsx("div",{className:"tm-review-list",children:st.map((Te,Ve)=>i.jsxs("div",{className:"tm-review-row-detailed",children:[i.jsx("div",{className:"tm-review-worker-name",children:Te.name}),i.jsxs("div",{className:"tm-review-worker-details",children:[Te.timeStarted&&Te.timeEnded&&i.jsxs("span",{className:"tm-review-time",children:[Te.timeStarted," - ",Te.timeEnded]}),i.jsxs("span",{className:"tm-review-hours",children:[Te.hours||0," reg",parseFloat(Te.overtimeHours)>0?` + ${Te.overtimeHours} OT`:""]})]})]},Ve))})]}),O.length>0&&i.jsxs("div",{className:"tm-review-section",children:[i.jsxs("div",{className:"tm-review-header",children:[i.jsxs("span",{children:[i.jsx(Q0,{size:16,className:"inline-icon"})," Materials & Equipment"]}),i.jsxs("span",{children:[O.length," items"]})]}),i.jsx("div",{className:"tm-review-list",children:O.map((Te,Ve)=>i.jsxs("div",{className:"tm-review-row",children:[i.jsxs("span",{children:[Te.isCustom&&i.jsxs(i.Fragment,{children:[i.jsx(t8,{size:14,className:"inline-icon"})," "]}),Te.name]}),i.jsxs("span",{children:[Te.quantity," ",Te.unit]})]},Ve))})]}),i.jsxs("div",{className:"tm-review-section tm-certification",children:[i.jsx("div",{className:"tm-review-header",children:i.jsxs("span",{children:[i.jsx(o2,{size:16,className:"inline-icon"})," Submitted By"]})}),i.jsx("input",{type:"text",className:"tm-certification-input",placeholder:"Enter your name",value:x,onChange:Te=>g(Te.target.value)}),i.jsx("p",{className:"tm-certification-note",children:"By submitting, you certify this T&M is accurate."})]})]}),i.jsxs("div",{className:"tm-wizard-footer",children:[l<3?i.jsx("button",{className:"tm-big-btn primary",onClick:Ut,disabled:l===1&&!Xt(),children:l===1?`Next: Materials (${Dt} workers, ${At+Ct} hrs)`:l===2?`Review (${O.length} items)`:"Next"}):i.jsx("button",{className:"tm-big-btn submit",onClick:$t,disabled:Z,children:Z?T||"Submitting...":" Submit T&M"}),l===2&&i.jsx("button",{className:"tm-skip-btn",onClick:Ut,children:"Skip (no materials)"})]})]})}function i8({project:t,onShowToast:e}){const[r,a]=ee.useState([]),[n,s]=ee.useState(!0),[l,c]=ee.useState(!1),[d,f]=ee.useState(!1),[m,v]=ee.useState({name:"",role:"Laborer"});ee.useEffect(()=>{x()},[t.id]);const x=async()=>{try{const w=await nt.getCrewCheckin(t.id);w?.workers&&a(w.workers)}catch(w){console.error("Error loading crew:",w)}finally{s(!1)}},g=async()=>{if(!m.name.trim()){e("Enter worker name","error");return}if(r.find(w=>w.name.toLowerCase()===m.name.trim().toLowerCase())){e("Worker already added","error");return}c(!0);try{const w=[...r,{name:m.name.trim(),role:m.role}];await nt.saveCrewCheckin(t.id,w),a(w),v({name:"",role:"Laborer"}),f(!1),e("Crew member added","success")}catch(w){console.error("Error adding worker:",w),e("Error adding crew member","error")}finally{c(!1)}},b=async w=>{c(!0);try{const E=r.filter(C=>C.name.toLowerCase()!==w.toLowerCase());await nt.saveCrewCheckin(t.id,E),a(E),e("Crew member removed","success")}catch(E){console.error("Error removing worker:",E),e("Error removing crew member","error")}finally{c(!1)}},_=new Date().toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"});return n?i.jsxs("div",{className:"crew-checkin",children:[i.jsxs("div",{className:"crew-header",children:[i.jsxs("h3",{children:[i.jsx(bs,{size:18,className:"inline-icon"})," Today's Crew"]}),i.jsx("span",{className:"crew-date",children:_})]}),i.jsx("div",{className:"crew-loading",children:"Loading..."})]}):i.jsxs("div",{className:"crew-checkin",children:[i.jsxs("div",{className:"crew-header",children:[i.jsxs("h3",{children:[i.jsx(bs,{size:18,className:"inline-icon"})," Today's Crew"]}),i.jsx("span",{className:"crew-date",children:_})]}),r.length===0?i.jsxs("div",{className:"crew-empty",children:[i.jsx("p",{children:"No crew checked in yet"}),i.jsx("p",{className:"crew-empty-hint",children:"Add your crew for the day"})]}):i.jsx("div",{className:"crew-list",children:r.map(w=>i.jsxs("div",{className:"crew-member",children:[i.jsxs("div",{className:"crew-member-info",children:[i.jsx("span",{className:"crew-member-name",children:w.name}),i.jsx("span",{className:`crew-member-role ${w.role.toLowerCase()}`,children:w.role})]}),i.jsx("button",{className:"crew-remove-btn",onClick:()=>b(w.name),disabled:l,children:""})]},w.name))}),d?i.jsxs("div",{className:"crew-add-form",children:[i.jsx("input",{type:"text",value:m.name,onChange:w=>v({...m,name:w.target.value}),placeholder:"Name",autoFocus:!0}),i.jsxs("select",{value:m.role,onChange:w=>v({...m,role:w.target.value}),children:[i.jsx("option",{value:"Foreman",children:"Foreman"}),i.jsx("option",{value:"Laborer",children:"Laborer"}),i.jsx("option",{value:"Supervisor",children:"Supervisor"}),i.jsx("option",{value:"Operator",children:"Operator"})]}),i.jsxs("div",{className:"crew-add-buttons",children:[i.jsx("button",{className:"crew-add-confirm",onClick:g,disabled:l,children:l?"...":"Add"}),i.jsx("button",{className:"crew-add-cancel",onClick:()=>{f(!1),v({name:"",role:"Laborer"})},children:"Cancel"})]})]}):i.jsx("button",{className:"crew-add-btn",onClick:()=>f(!0),children:"+ Add Crew Member"}),i.jsxs("div",{className:"crew-count",children:[r.length," ",r.length===1?"person":"people"," on site"]})]})}function o8({project:t,onShowToast:e,onClose:r}){const[a,n]=ee.useState(!0),[s,l]=ee.useState(!1),[c,d]=ee.useState(null),[f,m]=ee.useState(""),[v,x]=ee.useState("");ee.useEffect(()=>{g()},[t.id]);const g=async()=>{try{const E=await nt.getDailyReport(t.id);if(E)d(E),m(E.field_notes||""),x(E.issues||"");else{const C=await nt.compileDailyReport(t.id);d({...C,status:"draft"})}}catch(E){console.error("Error loading report:",E),e("Error loading report","error")}finally{n(!1)}},b=async()=>{if(!qe){e("Demo Mode: Report saved locally only - won't reach office","info"),r();return}l(!0);try{await nt.saveDailyReport(t.id,{field_notes:f,issues:v}),await nt.submitDailyReport(t.id,"Field")?(e("Daily report submitted!","success"),r()):e("Report not sent - check connection","error")}catch(E){console.error("Error submitting report:",E),e("Error submitting report","error")}finally{l(!1)}},_=new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"});if(a)return i.jsxs("div",{className:"daily-report",children:[i.jsxs("div",{className:"daily-report-header",children:[i.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),i.jsx("h2",{children:"Daily Report"})]}),i.jsx("div",{className:"daily-report-loading",children:"Compiling report..."})]});const w=c?.status==="submitted";return i.jsxs("div",{className:"daily-report",children:[i.jsxs("div",{className:"daily-report-header",children:[i.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),i.jsxs("div",{children:[i.jsx("h2",{children:"Daily Report"}),i.jsx("p",{className:"daily-report-date",children:_})]})]}),w&&i.jsxs("div",{className:"daily-report-submitted-banner",children:[" Submitted ",new Date(c.submitted_at).toLocaleTimeString()]}),i.jsxs("div",{className:"daily-report-content",children:[i.jsxs("div",{className:"daily-report-summary",children:[i.jsxs("div",{className:"daily-report-card",children:[i.jsx("div",{className:"daily-report-card-value",children:c.crew_count||0}),i.jsx("div",{className:"daily-report-card-label",children:"Crew on Site"})]}),i.jsxs("div",{className:"daily-report-card",children:[i.jsx("div",{className:"daily-report-card-value",children:c.tasks_completed||0}),i.jsx("div",{className:"daily-report-card-label",children:"Tasks Done"})]}),i.jsxs("div",{className:"daily-report-card",children:[i.jsx("div",{className:"daily-report-card-value",children:c.tm_tickets_count||0}),i.jsx("div",{className:"daily-report-card-label",children:"T&M Tickets"})]}),i.jsxs("div",{className:"daily-report-card",children:[i.jsx("div",{className:"daily-report-card-value",children:c.photos_count||0}),i.jsx("div",{className:"daily-report-card-label",children:"Photos"})]})]}),c.crew_list?.length>0&&i.jsxs("div",{className:"daily-report-section",children:[i.jsxs("h3",{children:[i.jsx(bs,{size:18,className:"inline-icon"})," Crew"]}),i.jsx("div",{className:"daily-report-crew",children:c.crew_list.map((E,C)=>i.jsxs("div",{className:"daily-report-crew-item",children:[i.jsx("span",{children:E.name}),i.jsx("span",{className:"daily-report-crew-role",children:E.role})]},C))})]}),c.completed_tasks?.length>0&&i.jsxs("div",{className:"daily-report-section",children:[i.jsxs("h3",{children:[i.jsx(pd,{size:18,className:"inline-icon"})," Completed Today"]}),i.jsx("ul",{className:"daily-report-tasks",children:c.completed_tasks.map((E,C)=>i.jsxs("li",{children:[E.name,E.group&&i.jsx("span",{className:"daily-report-task-group",children:E.group})]},C))})]}),i.jsxs("div",{className:"daily-report-section",children:[i.jsxs("h3",{children:[i.jsx(ho,{size:18,className:"inline-icon"})," Notes"]}),i.jsx("textarea",{value:f,onChange:E=>m(E.target.value),placeholder:"Any notes about today's work...",rows:3,disabled:w})]}),i.jsxs("div",{className:"daily-report-section",children:[i.jsxs("h3",{children:[i.jsx(x1,{size:18,className:"inline-icon"})," Issues / Concerns"]}),i.jsx("textarea",{value:v,onChange:E=>x(E.target.value),placeholder:"Any problems, delays, or concerns...",rows:3,disabled:w})]})]}),!w&&i.jsxs("div",{className:"daily-report-footer",children:[i.jsx("button",{className:"btn btn-primary daily-report-submit",onClick:b,disabled:s,children:s?"Submitting...":i.jsxs(i.Fragment,{children:[i.jsx(YT,{size:16,className:"inline-icon"})," Submit Report"]})}),i.jsx("p",{className:"daily-report-hint",children:"This will be sent to the office"})]})]})}function l8({project:t,viewerType:e,viewerName:r,onShowToast:a,onClose:n}){const[s,l]=ee.useState([]),[c,d]=ee.useState(!0),[f,m]=ee.useState(!1),[v,x]=ee.useState(""),g=ee.useRef(null);ee.useEffect(()=>{b(),nt.markMessagesRead(t.id,e)},[t.id]),ee.useEffect(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[s]);const b=async()=>{try{const C=await nt.getMessages(t.id);l(C.reverse())}catch(C){console.error("Error loading messages:",C)}finally{d(!1)}},_=async()=>{if(v.trim()){if(!qe){a("Demo Mode: Messages won't sync to other users","info");const C={id:Date.now(),project_id:t.id,message:v.trim(),sender_type:e,sender_name:r,created_at:new Date().toISOString()};l([...s,C]),x("");return}m(!0);try{const C=await nt.sendMessage(t.id,v.trim(),e,r);C?(l([...s,C]),x("")):a("Message not sent - check connection","error")}catch(C){console.error("Error sending message:",C),a("Error sending message","error")}finally{m(!1)}}},w=C=>{C.key==="Enter"&&!C.shiftKey&&(C.preventDefault(),_())},E=C=>{const A=new Date(C),O=new Date;return A.toDateString()===O.toDateString()?A.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):A.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})};return i.jsxs("div",{className:"messages-container",children:[i.jsxs("div",{className:"messages-header",children:[i.jsx("button",{className:"back-btn-simple",onClick:n,children:""}),i.jsxs("div",{children:[i.jsx("h2",{children:"Messages"}),i.jsx("p",{className:"messages-project",children:t.name})]})]}),i.jsxs("div",{className:"messages-list",children:[c?i.jsx("div",{className:"messages-loading",children:"Loading..."}):s.length===0?i.jsxs("div",{className:"messages-empty",children:[i.jsx("p",{children:"No messages yet"}),i.jsx("p",{className:"messages-empty-hint",children:e==="field"?"Messages from the office will appear here":"Send a message to the field crew"})]}):s.map(C=>i.jsx("div",{className:`message ${C.sender_type===e?"sent":"received"}`,children:i.jsxs("div",{className:"message-bubble",children:[i.jsxs("div",{className:"message-sender",children:[C.sender_type==="office"?i.jsx(D0,{size:14,className:"inline-icon"}):i.jsx(bs,{size:14,className:"inline-icon"})," ",C.sender_name]}),i.jsx("div",{className:"message-text",children:C.message}),C.photo_url&&i.jsx("img",{src:C.photo_url,alt:"Attached",className:"message-photo"}),i.jsx("div",{className:"message-time",children:E(C.created_at)})]})},C.id)),i.jsx("div",{ref:g})]}),i.jsxs("div",{className:"messages-input-container",children:[i.jsx("textarea",{value:v,onChange:C=>x(C.target.value),onKeyDown:w,placeholder:"Type a message...",rows:1,disabled:f}),i.jsx("button",{className:"messages-send-btn",onClick:_,disabled:f||!v.trim(),children:f?"...":""})]})]})}function c8({project:t,requestedBy:e,onShowToast:r,onClose:a}){const[n,s]=ee.useState([{name:"",quantity:"",unit:"each"}]),[l,c]=ee.useState(""),[d,f]=ee.useState("normal"),[m,v]=ee.useState(""),[x,g]=ee.useState(!1),b=()=>{s([...n,{name:"",quantity:"",unit:"each"}])},_=(C,A,O)=>{s(n.map((G,W)=>W===C?{...G,[A]:O}:G))},w=C=>{n.length>1&&s(n.filter((A,O)=>O!==C))},E=async()=>{const C=n.filter(A=>A.name.trim()&&parseFloat(A.quantity)>0);if(C.length===0){r("Add at least one item with quantity","error");return}if(!qe){r("Demo Mode: Request saved locally only - won't reach office","info"),a();return}g(!0);try{await nt.createMaterialRequest(t.id,C,e,l||null,d,m||null)?(r("Request submitted!","success"),a()):r("Request not sent - check connection","error")}catch(A){console.error("Error submitting request:",A),r("Error submitting request","error")}finally{g(!1)}};return i.jsxs("div",{className:"material-request",children:[i.jsxs("div",{className:"material-request-header",children:[i.jsx("button",{className:"back-btn-simple",onClick:a,children:""}),i.jsx("h2",{children:"Request Materials"})]}),i.jsxs("div",{className:"material-request-content",children:[i.jsxs("div",{className:"material-request-section",children:[i.jsx("label",{children:"What do you need?"}),n.map((C,A)=>i.jsxs("div",{className:"material-request-item",children:[i.jsx("input",{type:"text",placeholder:"Item name",value:C.name,onChange:O=>_(A,"name",O.target.value),className:"material-request-name"}),i.jsx("input",{type:"number",placeholder:"Qty",value:C.quantity,onChange:O=>_(A,"quantity",O.target.value),className:"material-request-qty"}),i.jsxs("select",{value:C.unit,onChange:O=>_(A,"unit",O.target.value),className:"material-request-unit",children:[i.jsx("option",{value:"each",children:"each"}),i.jsx("option",{value:"rolls",children:"rolls"}),i.jsx("option",{value:"boxes",children:"boxes"}),i.jsx("option",{value:"bags",children:"bags"}),i.jsx("option",{value:"sheets",children:"sheets"}),i.jsx("option",{value:"gallons",children:"gal"}),i.jsx("option",{value:"feet",children:"ft"}),i.jsx("option",{value:"lbs",children:"lbs"})]}),i.jsx("button",{className:"material-request-remove",onClick:()=>w(A),children:""})]},A)),i.jsx("button",{className:"material-request-add",onClick:b,children:"+ Add Another Item"})]}),i.jsxs("div",{className:"material-request-section",children:[i.jsx("label",{children:"Priority"}),i.jsx("div",{className:"material-request-priority",children:["low","normal","urgent"].map(C=>i.jsxs("button",{className:`priority-btn ${d===C?"active":""} ${C}`,onClick:()=>f(C),children:[C==="urgent"&&" ",C==="normal"&&" ",C==="low"&&" ",C.charAt(0).toUpperCase()+C.slice(1)]},C))})]}),i.jsxs("div",{className:"material-request-section",children:[i.jsx("label",{children:"Needed By (optional)"}),i.jsx("input",{type:"date",value:l,onChange:C=>c(C.target.value),min:new Date().toISOString().split("T")[0]})]}),i.jsxs("div",{className:"material-request-section",children:[i.jsx("label",{children:"Notes (optional)"}),i.jsx("textarea",{value:m,onChange:C=>v(C.target.value),placeholder:"Any additional details...",rows:2})]})]}),i.jsx("div",{className:"material-request-footer",children:i.jsx("button",{className:"btn btn-primary",onClick:E,disabled:x,children:x?"Submitting...":i.jsxs(i.Fragment,{children:[i.jsx(bc,{size:16,className:"inline-icon"})," Submit Request"]})})})]})}const u8=ee.createContext({}),lN=()=>ee.useContext(u8);function mu({message:t,type:e="",onClose:r}){return ee.useEffect(()=>{const a=setTimeout(r,3e3);return()=>clearTimeout(a)},[r]),i.jsx("div",{className:"toast-container",children:i.jsx("div",{className:`toast ${e}`,children:t})})}function cN({project:t,companyId:e,onClose:r,onReportCreated:a}){const{user:n}=lN(),[s,l]=ee.useState(!1),[c,d]=ee.useState(null),[f,m]=ee.useState(1),[v,x]=ee.useState(new Date().toISOString().split("T")[0]),[g,b]=ee.useState(new Date().toTimeString().split(" ")[0].substring(0,5)),[_,w]=ee.useState(""),[E,C]=ee.useState(""),[A,O]=ee.useState("minor"),[G,W]=ee.useState(""),[B,q]=ee.useState(""),[L,Z]=ee.useState(""),[D,T]=ee.useState(""),[M,V]=ee.useState(""),[ie,X]=ee.useState(""),[J,K]=ee.useState(""),[te,fe]=ee.useState(n?.name||""),[U,j]=ee.useState(""),[F,I]=ee.useState(""),[z,ne]=ee.useState(n?.email||""),[se,je]=ee.useState([]),[Ne,ge]=ee.useState(""),[Ie,le]=ee.useState(""),[Ge,rt]=ee.useState(""),[ue,ot]=ee.useState(""),[xe,ve]=ee.useState(!1),[Be,jt]=ee.useState(""),[Je,ct]=ee.useState(""),[St,Ft]=ee.useState(!1),[Xt,Ut]=ee.useState(""),[Wt,$t]=ee.useState(""),[wt,Ce]=ee.useState(""),[st,Dt]=ee.useState(""),[At,Ct]=ee.useState(!1),[Te,Ve]=ee.useState(!1),[_e,Ue]=ee.useState(0),[Fe,gt]=ee.useState(0),Ht=()=>{if(!Ne.trim()){d({type:"error",message:"Please enter witness name"});return}const Nt={name:Ne,phone:Ie,email:Ge,testimony:ue};je([...se,Nt]),ge(""),le(""),rt(""),ot(""),d({type:"success",message:"Witness added"})},Vt=Nt=>{je(se.filter((fa,ir)=>ir!==Nt))},zt=Nt=>{switch(Nt){case 1:if(!_.trim()||!E.trim())return d({type:"error",message:"Please fill in all incident details"}),!1;break;case 2:if(!B.trim()||!ie.trim())return d({type:"error",message:"Please fill in employee name and job title"}),!1;break;case 3:if(!te.trim()||!U.trim())return d({type:"error",message:"Please fill in supervisor name and title"}),!1;break}return!0},kt=()=>{zt(f)&&m(f+1)},sr=()=>{m(f-1)},Pr=async()=>{if(zt(f)){if(!qe){d({type:"info",message:"Demo Mode: Report saved locally only - won't reach office"}),setTimeout(()=>{r()},1500);return}l(!0);try{const Nt={project_id:t.id,company_id:e,incident_date:v,incident_time:g,incident_location:_,incident_description:E,injury_type:A,body_part_affected:G||null,employee_name:B,employee_phone:L||null,employee_email:D||null,employee_address:M||null,employee_job_title:ie,employee_hire_date:J||null,medical_treatment_required:xe,medical_facility_name:Be||null,medical_facility_address:Je||null,hospitalized:St,reported_by_name:te,reported_by_title:U,reported_by_phone:F||null,reported_by_email:z||null,witnesses:se,immediate_actions_taken:Xt||null,corrective_actions_planned:Wt||null,safety_equipment_used:wt||null,safety_equipment_failed:st||null,osha_recordable:At,workers_comp_claim:Te,days_away_from_work:parseInt(_e)||0,restricted_work_days:parseInt(Fe)||0,status:"reported",created_by:n?.id},fa=await nt.createInjuryReport(Nt);d({type:"success",message:"Injury report submitted successfully"}),a&&a(fa),setTimeout(()=>{r()},1500)}catch(Nt){console.error("Error submitting injury report:",Nt),d({type:"error",message:"Failed to submit injury report"})}finally{l(!1)}}};return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"modal-overlay",onClick:r,children:i.jsxs("div",{className:"modal-content injury-report-modal",onClick:Nt=>Nt.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{children:"Workplace Injury/Incident Report"}),i.jsx("button",{className:"close-btn",onClick:r,children:""})]}),i.jsxs("div",{className:"progress-steps",children:[i.jsx("div",{className:`step ${f>=1?"active":""}`,children:"1. Incident"}),i.jsx("div",{className:`step ${f>=2?"active":""}`,children:"2. Employee"}),i.jsx("div",{className:`step ${f>=3?"active":""}`,children:"3. Supervisor"}),i.jsx("div",{className:`step ${f>=4?"active":""}`,children:"4. Witnesses"}),i.jsx("div",{className:`step ${f>=5?"active":""}`,children:"5. Medical & Safety"})]}),i.jsxs("div",{className:"modal-body",children:[f===1&&i.jsxs("div",{className:"form-step",children:[i.jsx("h3",{children:"Incident Details"}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Date of Incident *"}),i.jsx("input",{type:"date",value:v,onChange:Nt=>x(Nt.target.value),max:new Date().toISOString().split("T")[0]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Time of Incident *"}),i.jsx("input",{type:"time",value:g,onChange:Nt=>b(Nt.target.value)})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Location on Site *"}),i.jsx("input",{type:"text",value:_,onChange:Nt=>w(Nt.target.value),placeholder:"e.g., Floor 2, near elevator shaft"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Incident Description *"}),i.jsx("textarea",{value:E,onChange:Nt=>C(Nt.target.value),rows:4,placeholder:"Describe what happened in detail..."})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Injury Type *"}),i.jsxs("select",{value:A,onChange:Nt=>O(Nt.target.value),children:[i.jsx("option",{value:"minor",children:"Minor Injury"}),i.jsx("option",{value:"serious",children:"Serious Injury"}),i.jsx("option",{value:"critical",children:"Critical Injury"}),i.jsx("option",{value:"near_miss",children:"Near Miss (No Injury)"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Body Part Affected"}),i.jsx("input",{type:"text",value:G,onChange:Nt=>W(Nt.target.value),placeholder:"e.g., Left hand, lower back"})]})]})]}),f===2&&i.jsxs("div",{className:"form-step",children:[i.jsx("h3",{children:"Injured Employee Information"}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Full Name *"}),i.jsx("input",{type:"text",value:B,onChange:Nt=>q(Nt.target.value),placeholder:"First and last name"})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Phone Number"}),i.jsx("input",{type:"tel",value:L,onChange:Nt=>Z(Nt.target.value),placeholder:"(555) 123-4567"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email Address"}),i.jsx("input",{type:"email",value:D,onChange:Nt=>T(Nt.target.value),placeholder:"email@example.com"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Home Address"}),i.jsx("input",{type:"text",value:M,onChange:Nt=>V(Nt.target.value),placeholder:"Street address, city, state, zip"})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Job Title *"}),i.jsx("input",{type:"text",value:ie,onChange:Nt=>X(Nt.target.value),placeholder:"e.g., Carpenter, Electrician"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Hire Date"}),i.jsx("input",{type:"date",value:J,onChange:Nt=>K(Nt.target.value)})]})]})]}),f===3&&i.jsxs("div",{className:"form-step",children:[i.jsx("h3",{children:"Foreman/Supervisor Making Report"}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Your Name *"}),i.jsx("input",{type:"text",value:te,onChange:Nt=>fe(Nt.target.value),placeholder:"Full name"})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Your Title *"}),i.jsx("input",{type:"text",value:U,onChange:Nt=>j(Nt.target.value),placeholder:"e.g., Site Foreman, Project Manager"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Your Phone Number"}),i.jsx("input",{type:"tel",value:F,onChange:Nt=>I(Nt.target.value),placeholder:"(555) 123-4567"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Your Email Address"}),i.jsx("input",{type:"email",value:z,onChange:Nt=>ne(Nt.target.value),placeholder:"email@example.com"})]})]}),f===4&&i.jsxs("div",{className:"form-step",children:[i.jsx("h3",{children:"Witness Testimonies (Optional)"}),se.length>0&&i.jsx("div",{className:"witnesses-list",children:se.map((Nt,fa)=>i.jsxs("div",{className:"witness-item",children:[i.jsxs("div",{className:"witness-info",children:[i.jsx("strong",{children:Nt.name}),Nt.phone&&i.jsxs("span",{children:["  ",Nt.phone]}),Nt.testimony&&i.jsxs("p",{className:"witness-testimony",children:['"',Nt.testimony,'"']})]}),i.jsx("button",{className:"btn-danger btn-small",onClick:()=>Vt(fa),children:"Remove"})]},fa))}),i.jsxs("div",{className:"add-witness-form",children:[i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Witness Name"}),i.jsx("input",{type:"text",value:Ne,onChange:Nt=>ge(Nt.target.value),placeholder:"Full name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Phone Number"}),i.jsx("input",{type:"tel",value:Ie,onChange:Nt=>le(Nt.target.value),placeholder:"(555) 123-4567"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Email Address"}),i.jsx("input",{type:"email",value:Ge,onChange:Nt=>rt(Nt.target.value),placeholder:"email@example.com"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Witness Testimony"}),i.jsx("textarea",{value:ue,onChange:Nt=>ot(Nt.target.value),rows:3,placeholder:"What did the witness see or hear?"})]}),i.jsx("button",{className:"btn-secondary",onClick:Ht,children:"+ Add Witness"})]})]}),f===5&&i.jsxs("div",{className:"form-step",children:[i.jsx("h3",{children:"Medical Treatment & Safety"}),i.jsx("div",{className:"form-group checkbox-group",children:i.jsxs("label",{children:[i.jsx("input",{type:"checkbox",checked:xe,onChange:Nt=>ve(Nt.target.checked)}),"Medical treatment required"]})}),xe&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Medical Facility Name"}),i.jsx("input",{type:"text",value:Be,onChange:Nt=>jt(Nt.target.value),placeholder:"Hospital or clinic name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Medical Facility Address"}),i.jsx("input",{type:"text",value:Je,onChange:Nt=>ct(Nt.target.value),placeholder:"Street address"})]}),i.jsx("div",{className:"form-group checkbox-group",children:i.jsxs("label",{children:[i.jsx("input",{type:"checkbox",checked:St,onChange:Nt=>Ft(Nt.target.checked)}),"Employee was hospitalized"]})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Immediate Actions Taken"}),i.jsx("textarea",{value:Xt,onChange:Nt=>Ut(Nt.target.value),rows:2,placeholder:"What was done immediately after the incident?"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Corrective Actions Planned"}),i.jsx("textarea",{value:Wt,onChange:Nt=>$t(Nt.target.value),rows:2,placeholder:"What will be done to prevent this in the future?"})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Safety Equipment Used"}),i.jsx("input",{type:"text",value:wt,onChange:Nt=>Ce(Nt.target.value),placeholder:"e.g., Hard hat, gloves, harness"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Safety Equipment Failed"}),i.jsx("input",{type:"text",value:st,onChange:Nt=>Dt(Nt.target.value),placeholder:"Equipment that failed, if any"})]})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Days Away From Work"}),i.jsx("input",{type:"number",min:"0",value:_e,onChange:Nt=>Ue(Nt.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Restricted Work Days"}),i.jsx("input",{type:"number",min:"0",value:Fe,onChange:Nt=>gt(Nt.target.value)})]})]}),i.jsx("div",{className:"form-group checkbox-group",children:i.jsxs("label",{children:[i.jsx("input",{type:"checkbox",checked:At,onChange:Nt=>Ct(Nt.target.checked)}),"OSHA Recordable Incident"]})}),i.jsx("div",{className:"form-group checkbox-group",children:i.jsxs("label",{children:[i.jsx("input",{type:"checkbox",checked:Te,onChange:Nt=>Ve(Nt.target.checked)}),"Workers' Compensation Claim Filed"]})})]})]}),i.jsx("div",{className:"modal-footer",children:i.jsxs("div",{className:"form-actions",children:[f>1&&i.jsx("button",{className:"btn-secondary",onClick:sr,children:" Back"}),i.jsx("button",{className:"btn-secondary",onClick:r,children:"Cancel"}),f<5?i.jsx("button",{className:"btn-primary",onClick:kt,children:"Next "}):i.jsx("button",{className:"btn-primary",onClick:Pr,disabled:s,children:s?"Submitting...":"Submit Report"})]})})]})}),c&&i.jsx(mu,{message:c.message,type:c.type,onClose:()=>d(null)}),i.jsx("style",{children:`
        .injury-report-modal {
          max-width: 800px;
          max-height: 90vh;
          overflow-y: auto;
        }

        .progress-steps {
          display: flex;
          justify-content: space-between;
          padding: 1rem 1.5rem;
          border-bottom: 1px solid var(--border-color);
          background-color: var(--bg-elevated);
          overflow-x: auto;
        }

        .progress-steps .step {
          font-size: 0.875rem;
          color: var(--text-muted);
          font-weight: 500;
          white-space: nowrap;
          padding: 0.5rem;
        }

        .progress-steps .step.active {
          color: var(--accent-primary);
          font-weight: 600;
        }

        .form-step h3 {
          margin-top: 0;
          margin-bottom: 1.5rem;
          color: var(--text-primary);
          font-size: 1.25rem;
        }

        .form-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 500;
          color: var(--text-secondary);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
          width: 100%;
          padding: 0.5rem;
          border: 1px solid var(--border-color);
          border-radius: 4px;
          font-size: 1rem;
          background: var(--bg-card);
          color: var(--text-primary);
        }

        .form-group textarea {
          resize: vertical;
        }

        .checkbox-group label {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-weight: normal;
          cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
          width: auto;
          margin: 0;
        }

        .witnesses-list {
          margin-bottom: 1.5rem;
        }

        .witness-item {
          border: 1px solid var(--border-color);
          border-radius: 6px;
          padding: 1rem;
          margin-bottom: 0.5rem;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
        }

        .witness-info {
          flex: 1;
          color: var(--text-primary);
        }

        .witness-testimony {
          margin-top: 0.5rem;
          color: var(--text-secondary);
          font-style: italic;
          font-size: 0.875rem;
        }

        .add-witness-form {
          border: 2px dashed var(--border-color);
          border-radius: 6px;
          padding: 1rem;
          background-color: var(--bg-elevated);
        }

        .modal-footer {
          border-top: 1px solid var(--border-color);
          padding: 1rem 1.5rem;
        }

        .form-actions {
          display: flex;
          justify-content: space-between;
          gap: 0.5rem;
        }

        .btn-primary,
        .btn-secondary,
        .btn-danger {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          opacity: 0.9;
        }

        .btn-primary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-secondary {
          background-color: var(--bg-elevated);
          color: var(--text-primary);
          border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
          background-color: var(--bg-tertiary);
        }

        .btn-danger {
          background-color: #ef4444;
          color: white;
        }

        .btn-danger:hover {
          background-color: #dc2626;
        }

        .btn-small {
          padding: 0.25rem 0.75rem;
          font-size: 0.875rem;
        }

        @media (max-width: 768px) {
          .injury-report-modal {
            max-width: 100%;
            height: 100vh;
            max-height: 100vh;
            border-radius: 0;
          }

          .form-row {
            grid-template-columns: 1fr;
          }

          .progress-steps .step {
            font-size: 0.75rem;
            padding: 0.25rem;
          }
        }
      `})]})}const fw=[{id:"trash",label:"Trash",description:"General debris"},{id:"metal",label:"Metal",description:"Scrap metal (recyclable)"},{id:"copper",label:"Copper",description:"Copper scrap (recyclable)"},{id:"concrete",label:"Concrete",description:"Concrete/masonry"},{id:"hazardous",label:"Hazardous",description:"Hazardous materials"}];function d8({project:t,companyId:e,onClose:r,onSubmit:a,onShowToast:n}){const[s,l]=ee.useState(!1),[c,d]=ee.useState([]),[f,m]=ee.useState(!0),[v,x]=ee.useState(new Date().toISOString().split("T")[0]),[g,b]=ee.useState("trash"),[_,w]=ee.useState(1),[E,C]=ee.useState(""),[A,O]=ee.useState(t.default_dump_site_id||""),[G,W]=ee.useState(""),[B,q]=ee.useState(null),[L,Z]=ee.useState(null);ee.useEffect(()=>{D()},[e]),ee.useEffect(()=>{T()},[A,g,_,c]);const D=async()=>{try{const J=await nt.getDumpSites(e);d(J||[]),t.default_dump_site_id?O(t.default_dump_site_id):J&&J.length>0&&O(J[0].id)}catch(J){console.error("Error loading dump sites:",J)}finally{m(!1)}},T=()=>{if(!A||!g||!_){q(null),Z(null);return}const J=c.find(te=>te.id===A);if(!J||!J.dump_site_rates){q(null),Z(null);return}const K=J.dump_site_rates.find(te=>te.waste_type===g);if(K&&K.estimated_cost_per_load!==null){const te=parseFloat(K.estimated_cost_per_load);Z(te),q(te*parseInt(_))}else q(null),Z(null)},M=J=>J==null?"--":J<0?`-$${Math.abs(J).toFixed(0)}`:`$${J.toFixed(0)}`,V=async J=>{if(J.preventDefault(),!A){n("Please select a dump site","error");return}if(!_||_<1){n("Please enter number of loads","error");return}l(!0);try{await nt.createHaulOff(t.id,{dump_site_id:A,waste_type:g,loads:parseInt(_),hauling_company:E.trim()||null,work_date:v,notes:G.trim()||null,estimated_cost:B,created_by:"Field"}),n("Haul-off logged successfully","success"),a&&a(),r()}catch(K){console.error("Error logging haul-off:",K),n("Error logging haul-off","error")}finally{l(!1)}},ie=c.find(J=>J.id===A),X=fw.find(J=>J.id===g);return i.jsxs("div",{className:"hauloff-form-container",children:[i.jsxs("div",{className:"hauloff-header",children:[i.jsx("button",{className:"back-btn-simple",onClick:r,children:""}),i.jsx("h2",{children:"Log Haul-Off"})]}),i.jsxs("form",{onSubmit:V,className:"hauloff-form",children:[i.jsxs("div",{className:"hauloff-field",children:[i.jsx("label",{children:"Date"}),i.jsx("input",{type:"date",value:v,onChange:J=>x(J.target.value),max:new Date().toISOString().split("T")[0]})]}),i.jsxs("div",{className:"hauloff-field",children:[i.jsx("label",{children:"Waste Type"}),i.jsx("div",{className:"waste-type-grid",children:fw.map(J=>i.jsxs("button",{type:"button",className:`waste-type-btn ${g===J.id?"active":""} ${J.id==="metal"||J.id==="copper"?"recyclable":""}`,onClick:()=>b(J.id),children:[i.jsx("span",{className:"waste-label",children:J.label}),(J.id==="metal"||J.id==="copper")&&i.jsx("span",{className:"waste-badge",children:"$"})]},J.id))})]}),i.jsxs("div",{className:"hauloff-field",children:[i.jsx("label",{children:"Number of Loads"}),i.jsxs("div",{className:"loads-input-row",children:[i.jsx("button",{type:"button",className:"loads-btn",onClick:()=>w(Math.max(1,_-1)),children:""}),i.jsx("input",{type:"number",value:_,onChange:J=>w(Math.max(1,parseInt(J.target.value)||1)),min:"1",className:"loads-input"}),i.jsx("button",{type:"button",className:"loads-btn",onClick:()=>w(_+1),children:"+"})]})]}),i.jsxs("div",{className:"hauloff-field",children:[i.jsx("label",{children:"Dump Site"}),f?i.jsx("div",{className:"loading-inline",children:"Loading sites..."}):c.length===0?i.jsx("div",{className:"no-sites-warning",children:"No dump sites configured. Ask office to add dump sites."}):i.jsxs("select",{value:A,onChange:J=>O(J.target.value),children:[i.jsx("option",{value:"",children:"-- Select Dump Site --"}),c.map(J=>i.jsx("option",{value:J.id,children:J.name},J.id))]}),ie?.address&&i.jsx("span",{className:"field-hint",children:ie.address})]}),i.jsxs("div",{className:"hauloff-field",children:[i.jsx("label",{children:"Hauling Company (Optional)"}),i.jsx("input",{type:"text",value:E,onChange:J=>C(J.target.value),placeholder:"e.g., ABC Trucking"})]}),i.jsxs("div",{className:"hauloff-field",children:[i.jsx("label",{children:"Notes (Optional)"}),i.jsx("textarea",{value:G,onChange:J=>W(J.target.value),placeholder:"Any additional notes...",rows:2})]}),i.jsxs("div",{className:"hauloff-estimate",children:[i.jsx("div",{className:"estimate-header",children:"Estimated Cost"}),B!==null?i.jsxs("div",{className:`estimate-value ${B<0?"revenue":""}`,children:[i.jsx("span",{className:"estimate-amount",children:M(B)}),i.jsxs("span",{className:"estimate-breakdown",children:[M(L),"/load  ",_," load",_>1?"s":""]}),B<0&&i.jsx("span",{className:"estimate-note revenue-note",children:"Revenue from recyclables"})]}):i.jsxs("div",{className:"estimate-value",children:[i.jsx("span",{className:"estimate-amount",children:"--"}),i.jsx("span",{className:"estimate-breakdown",children:A?ie?.dump_site_rates?.find(J=>J.waste_type===g)?"Unable to calculate":`No rate set for ${X?.label||g}`:"Select a dump site"})]}),i.jsx("div",{className:"estimate-disclaimer",children:"This is an estimate for burn rate tracking, not an invoice amount."})]}),i.jsxs("div",{className:"hauloff-actions",children:[i.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,disabled:s,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn btn-primary",disabled:s||!A,children:s?"Saving...":"Log Haul-Off"})]})]})]})}function f8({project:t,companyId:e,onShowToast:r,onExit:a}){const[n,s]=ee.useState([]),[l,c]=ee.useState(!0),[d,f]=ee.useState(null),[m,v]=ee.useState({}),[x,g]=ee.useState(!1),[b,_]=ee.useState(!0),[w,E]=ee.useState(!1),[C,A]=ee.useState(!1),[O,G]=ee.useState(!1),[W,B]=ee.useState(!1),[q,L]=ee.useState(!1),[Z,D]=ee.useState(!1),[T,M]=ee.useState(0);ee.useEffect(()=>{V(),ie()},[t.id]);const V=async()=>{try{const z=await nt.getAreas(t.id);s(z);const ne=[...new Set(z.map(je=>je.group_name||"General"))],se={};ne.forEach(je=>se[je]=!1),v(se)}catch(z){console.error("Error loading areas:",z),r("Error loading areas","error")}finally{c(!1)}},ie=async()=>{const z=await nt.getUnreadCount(t.id,"field");M(z)},X=async(z,ne)=>{const se=n.find(Ne=>Ne.id===z);if(!se)return;const je=se.status===ne?"not_started":ne;f(z);try{await nt.updateAreaStatus(z,je),s(Ne=>Ne.map(ge=>ge.id===z?{...ge,status:je}:ge)),r("Updated","success")}catch(Ne){console.error("Error updating status:",Ne),r("Error updating","error")}finally{f(null)}},J=z=>{v(ne=>({...ne,[z]:!ne[z]}))};if(l)return i.jsx("div",{className:"foreman-container",children:i.jsxs("div",{className:"loading",children:[i.jsx("div",{className:"spinner"}),"Loading..."]})});if(x)return i.jsx("div",{className:"foreman-container",children:i.jsx(s8,{project:t,companyId:e,onSubmit:()=>g(!1),onCancel:()=>g(!1),onShowToast:r})});if(w)return i.jsx(o8,{project:t,onShowToast:r,onClose:()=>E(!1)});if(C)return i.jsx(l8,{project:t,viewerType:"field",viewerName:"Field",onShowToast:r,onClose:()=>{A(!1),ie()}});if(O)return i.jsx(c8,{project:t,requestedBy:"Field",onShowToast:r,onClose:()=>G(!1)});if(W)return i.jsx("div",{className:"foreman-container",children:i.jsx(cN,{project:t,companyId:e,onClose:()=>B(!1),onReportCreated:()=>{B(!1),r("Injury report submitted","success")}})});if(q)return i.jsx("div",{className:"foreman-container",children:i.jsx(d8,{project:t,companyId:e,onClose:()=>L(!1),onSubmit:()=>L(!1),onShowToast:r})});const K=a8(n),te=n.reduce((z,ne)=>{const se=ne.group_name||"General";return z[se]||(z[se]=[]),z[se].push(ne),z},{}),fe=Object.keys(te).length>1||Object.keys(te).length===1&&!te.General,U=z=>`${z.filter(se=>se.status==="done").length}/${z.length}`,j=n.filter(z=>z.status==="done").length,F=n.filter(z=>z.status==="working").length,I=n.length-j;return i.jsxs("div",{className:"foreman-container",children:[i.jsxs("div",{className:"foreman-header",children:[i.jsx("button",{className:"back-btn-simple",onClick:a,children:""}),i.jsxs("div",{className:"foreman-header-info",children:[i.jsx("div",{className:"foreman-project-name",children:t.name}),i.jsxs("div",{className:"foreman-progress",children:[K,"% Complete"]})]}),i.jsx("button",{className:"foreman-info-btn",onClick:()=>D(!Z),children:i.jsx(_x,{size:20})})]}),Z&&i.jsxs("div",{className:"foreman-project-info",children:[t.job_number&&i.jsxs("div",{className:"foreman-info-row",children:[i.jsx("span",{className:"foreman-info-label",children:"Job #"}),i.jsx("span",{className:"foreman-info-value",children:t.job_number})]}),t.address&&i.jsxs("div",{className:"foreman-info-row",children:[i.jsx("span",{className:"foreman-info-label",children:"Address"}),i.jsx("span",{className:"foreman-info-value",children:t.address})]}),t.general_contractor&&i.jsxs("div",{className:"foreman-info-row",children:[i.jsx("span",{className:"foreman-info-label",children:"GC / Client"}),i.jsx("span",{className:"foreman-info-value",children:t.general_contractor})]}),t.client_contact&&i.jsxs("div",{className:"foreman-info-row",children:[i.jsx("span",{className:"foreman-info-label",children:"Contact"}),i.jsx("span",{className:"foreman-info-value",children:t.client_contact})]}),t.client_phone&&i.jsxs("div",{className:"foreman-info-row",children:[i.jsx("span",{className:"foreman-info-label",children:"Phone"}),i.jsx("a",{href:`tel:${t.client_phone}`,className:"foreman-info-value foreman-info-link",children:t.client_phone})]})]}),i.jsxs("div",{className:"foreman-stats",children:[i.jsxs("div",{className:"foreman-stat",children:[i.jsx("div",{className:"foreman-stat-value working",children:F}),i.jsx("div",{className:"foreman-stat-label",children:"Working"})]}),i.jsxs("div",{className:"foreman-stat",children:[i.jsx("div",{className:"foreman-stat-value done",children:j}),i.jsx("div",{className:"foreman-stat-label",children:"Done"})]}),i.jsxs("div",{className:"foreman-stat",children:[i.jsx("div",{className:"foreman-stat-value remaining",children:I}),i.jsx("div",{className:"foreman-stat-label",children:"Remaining"})]})]}),i.jsxs("div",{className:"field-actions",children:[i.jsxs("button",{className:"field-action-btn",onClick:()=>g(!0),children:[i.jsx(ho,{size:20,className:"icon"}),"T&M Ticket"]}),i.jsxs("button",{className:"field-action-btn",onClick:()=>A(!0),children:[i.jsx(lc,{size:20,className:"icon"}),"Messages",T>0&&i.jsx("span",{className:"badge",children:T})]}),i.jsxs("button",{className:"field-action-btn",onClick:()=>G(!0),children:[i.jsx(bc,{size:20,className:"icon"}),"Materials"]}),i.jsxs("button",{className:"field-action-btn",onClick:()=>E(!0),children:[i.jsx(uo,{size:20,className:"icon"}),"Daily Report"]}),i.jsxs("button",{className:"field-action-btn",onClick:()=>L(!0),children:[i.jsx(vh,{size:20,className:"icon"}),"Haul-Off"]}),i.jsxs("button",{className:"field-action-btn danger",onClick:()=>B(!0),children:[i.jsx(x1,{size:20,className:"icon"}),"Report Injury"]})]}),i.jsx(i8,{project:t,onShowToast:r}),i.jsx("div",{className:"foreman-areas",children:fe?Object.entries(te).map(([z,ne])=>i.jsxs("div",{className:"foreman-group",children:[i.jsxs("div",{className:"foreman-group-header",onClick:()=>J(z),children:[i.jsxs("div",{className:"foreman-group-title",children:[i.jsx("span",{className:"foreman-group-arrow",children:m[z]?"":""}),i.jsx("span",{className:"foreman-group-name",children:z})]}),i.jsx("span",{className:"foreman-group-progress",children:U(ne)})]}),m[z]&&i.jsx("div",{className:"foreman-group-tasks",children:ne.map(se=>i.jsxs("div",{className:`foreman-area-card ${se.status}`,children:[i.jsx("div",{className:"foreman-area-name",children:se.name}),i.jsxs("div",{className:"foreman-area-buttons",children:[i.jsx("button",{className:`foreman-btn working ${se.status==="working"?"active":""}`,onClick:()=>X(se.id,"working"),disabled:d===se.id,children:d===se.id?"...":"Working"}),i.jsx("button",{className:`foreman-btn done ${se.status==="done"?"active":""}`,onClick:()=>X(se.id,"done"),disabled:d===se.id,children:d===se.id?"...":"Done"})]})]},se.id))})]},z)):n.map(z=>i.jsxs("div",{className:`foreman-area-card ${z.status}`,children:[i.jsx("div",{className:"foreman-area-name",children:z.name}),i.jsxs("div",{className:"foreman-area-buttons",children:[i.jsx("button",{className:`foreman-btn working ${z.status==="working"?"active":""}`,onClick:()=>X(z.id,"working"),disabled:d===z.id,children:d===z.id?"...":"Working"}),i.jsx("button",{className:`foreman-btn done ${z.status==="done"?"active":""}`,onClick:()=>X(z.id,"done"),disabled:d===z.id,children:d===z.id?"...":"Done"})]})]},z.id))}),n.length===0&&i.jsxs("div",{className:"foreman-empty",children:[i.jsx(uo,{size:48,className:"foreman-empty-icon"}),i.jsx("div",{className:"foreman-empty-text",children:"No areas yet"}),i.jsx("div",{className:"foreman-empty-subtext",children:"Office needs to add areas to this project"})]})]})}const hw=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never";function uN({documentType:t,documentId:e,companyId:r,projectId:a,documentTitle:n="",onClose:s,onShowToast:l}){const[c,d]=ee.useState(!0),[f,m]=ee.useState(!1),[v,x]=ee.useState([]),[g,b]=ee.useState(null),[_,w]=ee.useState(!1),[E,C]=ee.useState("never");ee.useEffect(()=>{A()},[t,e]);const A=async()=>{try{d(!0);const L=await nt.getSignatureRequestsForDocument(t,e);x(L||[])}catch(L){console.error("Error loading signature requests:",L)}finally{d(!1)}},O=async()=>{try{m(!0);let L=null;if(E!=="never"){const D=parseInt(E);L=new Date,L.setDate(L.getDate()+D),L=L.toISOString()}const Z=await nt.createSignatureRequest(t,e,r,a,null,L);if(Z){const D=`${window.location.origin}/sign/${Z.signature_token}`;b(D),await A(),l?.("Signature link created","success")}}catch(L){console.error("Error generating signature link:",L),l?.("Failed to create signature link","error")}finally{m(!1)}},G=async L=>{try{await navigator.clipboard.writeText(L),w(!0),l?.("Link copied to clipboard","success"),setTimeout(()=>w(!1),2e3)}catch(Z){console.error("Error copying to clipboard:",Z)}},W=async L=>{if(confirm("Are you sure you want to revoke this signature link? It will no longer be usable."))try{await nt.revokeSignatureRequest(L),await A(),l?.("Signature link revoked","success")}catch(Z){console.error("Error revoking signature request:",Z),l?.("Failed to revoke link","error")}},B=L=>{switch(L){case"pending":return{label:"Awaiting Signatures",color:"#f59e0b",bg:"#fef3c7"};case"partially_signed":return{label:"1 of 2 Signed",color:"#3b82f6",bg:"#dbeafe"};case"completed":return{label:"Fully Signed",color:"#10b981",bg:"#d1fae5"};case"revoked":return{label:"Revoked",color:"#ef4444",bg:"#fee2e2"};case"expired":return{label:"Expired",color:"#6b7280",bg:"#f3f4f6"};default:return{label:L,color:"#6b7280",bg:"#f3f4f6"}}},q=t==="cor"?"Change Order":"T&M Ticket";return i.jsx("div",{className:"modal-overlay",onClick:s,role:"dialog","aria-modal":"true",children:i.jsxs("div",{className:"modal-content signature-link-modal",onClick:L=>L.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsxs("div",{children:[i.jsx("h2",{children:"Get Signature Link"}),n&&i.jsx("span",{className:"modal-subtitle",children:n})]}),i.jsx("button",{className:"close-btn",onClick:s,"aria-label":"Close",children:i.jsx(Rd,{size:20})})]}),i.jsxs("div",{className:"modal-body",children:[i.jsxs("div",{className:"signature-link-section",children:[i.jsxs("h3",{children:[i.jsx(i2,{size:16}),"Create New Signature Link"]}),i.jsxs("p",{className:"section-description",children:["Generate a secure link that allows GC/Client to sign this ",q," without logging in."]}),i.jsxs("div",{className:"link-options",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Link Expiration"}),i.jsxs("select",{value:E,onChange:L=>C(L.target.value),disabled:f,children:[i.jsx("option",{value:"never",children:"Never expires"}),i.jsx("option",{value:"7",children:"7 days"}),i.jsx("option",{value:"30",children:"30 days"}),i.jsx("option",{value:"90",children:"90 days"})]})]}),i.jsx("button",{className:"btn btn-primary",onClick:O,disabled:f,children:f?"Generating...":"Generate Link"})]}),g&&i.jsxs("div",{className:"new-link-box",children:[i.jsxs("div",{className:"link-display",children:[i.jsx("input",{type:"text",value:g,readOnly:!0,className:"link-input"}),i.jsxs("button",{className:"btn btn-secondary copy-btn",onClick:()=>G(g),children:[_?i.jsx(F0,{size:16}):i.jsx(iw,{size:16}),_?"Copied!":"Copy"]})]}),i.jsxs("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"preview-link",children:[i.jsx(ow,{size:14}),"Preview link"]})]})]}),i.jsxs("div",{className:"signature-link-section",children:[i.jsxs("h3",{children:[i.jsx(Xp,{size:16}),"Existing Signature Links"]}),c?i.jsx("div",{className:"loading-inline",children:"Loading..."}):v.length===0?i.jsxs("p",{className:"empty-state",children:["No signature links have been created for this ",q,"."]}):i.jsx("div",{className:"existing-links-list",children:v.map(L=>{const Z=B(L.status),D=`${window.location.origin}/sign/${L.signature_token}`,T=L.signatures?.length||0;return i.jsxs("div",{className:"existing-link-card",children:[i.jsxs("div",{className:"link-card-header",children:[i.jsx("span",{className:"status-badge",style:{color:Z.color,backgroundColor:Z.bg},children:Z.label}),i.jsxs("span",{className:"link-created",children:["Created ",hw(L.created_at)]})]}),i.jsxs("div",{className:"link-card-body",children:[i.jsxs("div",{className:"link-info",children:[i.jsxs("span",{className:"link-token",children:["...",L.signature_token.slice(-8)]}),L.expires_at&&i.jsxs("span",{className:"link-expires",children:["Expires ",hw(L.expires_at)]}),i.jsxs("span",{className:"link-views",children:[L.view_count," view",L.view_count!==1?"s":""]})]}),T>0&&i.jsx("div",{className:"signatures-summary",children:L.signatures.map(M=>i.jsxs("div",{className:"sig-item",children:[i.jsx(F0,{size:12}),i.jsxs("span",{children:["Slot ",M.signature_slot,": ",M.signer_name,M.signer_company&&` (${M.signer_company})`]})]},M.id))})]}),i.jsxs("div",{className:"link-card-actions",children:[L.status!=="revoked"&&L.status!=="expired"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{className:"btn btn-ghost btn-small",onClick:()=>G(D),children:[i.jsx(iw,{size:14})," Copy"]}),i.jsxs("a",{href:D,target:"_blank",rel:"noopener noreferrer",className:"btn btn-ghost btn-small",children:[i.jsx(ow,{size:14})," Open"]})]}),L.status!=="completed"&&L.status!=="revoked"&&i.jsxs("button",{className:"btn btn-ghost btn-small btn-danger",onClick:()=>W(L.id),children:[i.jsx(uc,{size:14})," Revoke"]})]})]},L.id)})})]}),i.jsxs("div",{className:"signature-info-box",children:[i.jsx(gh,{size:16}),i.jsxs("div",{children:[i.jsx("strong",{children:"How it works:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Share the link with your GC or Client"}),i.jsx("li",{children:"They can view the document and sign without logging in"}),i.jsx("li",{children:"Supports 2 signatures (GC + Client)"}),i.jsx("li",{children:"Signatures are recorded with name, title, company, date, and IP"})]})]})]})]}),i.jsx("div",{className:"modal-footer",children:i.jsx("button",{className:"btn btn-secondary",onClick:s,children:"Close"})})]})})}var Kp={};Kp.version="0.18.5";var dN=1252,h8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],l2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},c2=function(t){h8.indexOf(t)!=-1&&(dN=l2[0]=t)};function m8(){c2(1252)}var Xo=function(t){c2(t)};function u2(){Xo(1200),m8()}function mw(t){for(var e=[],r=0,a=t.length;r<a;++r)e[r]=t.charCodeAt(r);return e}function p8(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function fN(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var f0=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?p8(t.slice(2)):e==254&&r==255?fN(t.slice(2)):e==65279?t.slice(1):t},hp=function(e){return String.fromCharCode(e)},pw=function(e){return String.fromCharCode(e)},L0,pu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function P0(t){for(var e="",r=0,a=0,n=0,s=0,l=0,c=0,d=0,f=0;f<t.length;)r=t.charCodeAt(f++),s=r>>2,a=t.charCodeAt(f++),l=(r&3)<<4|a>>4,n=t.charCodeAt(f++),c=(a&15)<<2|n>>6,d=n&63,isNaN(a)?c=d=64:isNaN(n)&&(d=64),e+=pu.charAt(s)+pu.charAt(l)+pu.charAt(c)+pu.charAt(d);return e}function qi(t){var e="",r=0,a=0,n=0,s=0,l=0,c=0,d=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<t.length;)s=pu.indexOf(t.charAt(f++)),l=pu.indexOf(t.charAt(f++)),r=s<<2|l>>4,e+=String.fromCharCode(r),c=pu.indexOf(t.charAt(f++)),a=(l&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(a)),d=pu.indexOf(t.charAt(f++)),n=(c&3)<<6|d,d!==64&&(e+=String.fromCharCode(n));return e}var Ir=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),wc=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function xu(t){return Ir?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function gw(t){return Ir?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Mi=function(e){return Ir?wc(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function _1(t){if(typeof ArrayBuffer>"u")return Mi(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),a=0;a!=t.length;++a)r[a]=t.charCodeAt(a)&255;return e}function Nu(t){if(Array.isArray(t))return t.map(function(a){return String.fromCharCode(a)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function g8(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function d2(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return d2(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var is=Ir?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:wc(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var a=new Uint8Array(r),n=0;for(e=0,r=0;e<t.length;r+=n,++e)if(n=t[e].length,t[e]instanceof Uint8Array)a.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";a.set(new Uint8Array(t[e]),r)}return a}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function v8(t){for(var e=[],r=0,a=t.length+250,n=xu(t.length+255),s=0;s<t.length;++s){var l=t.charCodeAt(s);if(l<128)n[r++]=l;else if(l<2048)n[r++]=192|l>>6&31,n[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=t.charCodeAt(++s)&1023;n[r++]=240|l>>8&7,n[r++]=128|l>>2&63,n[r++]=128|c>>6&15|(l&3)<<4,n[r++]=128|c&63}else n[r++]=224|l>>12&15,n[r++]=128|l>>6&63,n[r++]=128|l&63;r>a&&(e.push(n.slice(0,r)),r=0,n=xu(65535),a=65530)}return e.push(n.slice(0,r)),is(e)}var Ys=/\u0000/g,h0=/[\u0001-\u0006]/g;function eh(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Ko(t,e){var r=""+t;return r.length>=e?r:pn("0",e-r.length)+r}function f2(t,e){var r=""+t;return r.length>=e?r:pn(" ",e-r.length)+r}function Jp(t,e){var r=""+t;return r.length>=e?r:r+pn(" ",e-r.length)}function x8(t,e){var r=""+Math.round(t);return r.length>=e?r:pn("0",e-r.length)+r}function y8(t,e){var r=""+t;return r.length>=e?r:pn("0",e-r.length)+r}var vw=Math.pow(2,32);function If(t,e){if(t>vw||t<-vw)return x8(t,e);var r=Math.round(t);return y8(r,e)}function Zp(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var xw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],lv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function _8(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var wr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},yw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},b8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Qp(t,e,r){for(var a=t<0?-1:1,n=t*a,s=0,l=1,c=0,d=1,f=0,m=0,v=Math.floor(n);f<e&&(v=Math.floor(n),c=v*l+s,m=v*f+d,!(n-v<5e-8));)n=1/(n-v),s=l,l=c,d=f,f=m;if(m>e&&(f>e?(m=d,c=s):(m=f,c=l)),!r)return[0,a*c,m];var x=Math.floor(a*c/m);return[x,a*c-x*m,m]}function gd(t,e,r){if(t>2958465||t<0)return null;var a=t|0,n=Math.floor(86400*(t-a)),s=0,l=[],c={D:a,T:n,u:86400*(t-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++n==86400&&(c.T=n=0,++a,++c.D)),a===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(a===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var d=new Date(1900,0,1);d.setDate(d.getDate()+a-1),l=[d.getFullYear(),d.getMonth()+1,d.getDate()],s=d.getDay(),a<60&&(s=(s+6)%7),r&&(s=E8(d,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=n%60,n=Math.floor(n/60),c.M=n%60,n=Math.floor(n/60),c.H=n,c.q=s,c}var hN=new Date(1899,11,31,0,0,0),w8=hN.getTime(),S8=new Date(1900,2,1,0,0,0);function mN(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=S8&&(r+=1440*60*1e3),(r-(w8+(t.getTimezoneOffset()-hN.getTimezoneOffset())*6e4))/(1440*60*1e3)}function h2(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function N8(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function j8(t){var e=t<0?12:11,r=h2(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function k8(t){var e=h2(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function M0(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=j8(t):e===10?r=t.toFixed(10).substr(0,12):r=k8(t),h2(N8(r.toUpperCase()))}function wd(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):M0(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return mo(14,mN(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function E8(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function A8(t,e,r,a){var n="",s=0,l=0,c=r.y,d,f=0;switch(t){case 98:c=r.y+543;case 121:switch(e.length){case 1:case 2:d=c%100,f=2;break;default:d=c%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:d=r.m,f=e.length;break;case 3:return lv[r.m-1][1];case 5:return lv[r.m-1][0];default:return lv[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:d=r.d,f=e.length;break;case 3:return xw[r.q][0];default:return xw[r.q][1]}break;case 104:switch(e.length){case 1:case 2:d=1+(r.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:d=r.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:d=r.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Ko(r.S,e.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),e==="s"?s===0?"0":""+s/l:(n=Ko(s,2+a),e==="ss"?n.substr(0,2):"."+n.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}f=e.length===3?1:2;break;case 101:d=c,f=1;break}var m=f>0?Ko(d,f):"";return m}function gu(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,a=t.substr(0,r);r!=t.length;r+=e)a+=(a.length>0?",":"")+t.substr(r,e);return a}var pN=/%/g;function C8(t,e,r){var a=e.replace(pN,""),n=e.length-a.length;return mc(t,a,r*Math.pow(10,2*n))+pn("%",n)}function T8(t,e,r){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return mc(t,e.substr(0,a),r/Math.pow(10,3*(e.length-a)))}function gN(t,e){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+gN(t,-e);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(e/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),r.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,m){return d+f+m.substr(0,(n+s)%n)+"."+m.substr(s)+"E"})}else r=e.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var vN=/# (\?+)( ?)\/( ?)(\d+)/;function O8(t,e,r){var a=parseInt(t[4],10),n=Math.round(e*a),s=Math.floor(n/a),l=n-s*a,c=a;return r+(s===0?"":""+s)+" "+(l===0?pn(" ",t[1].length+1+t[4].length):f2(l,t[1].length)+t[2]+"/"+t[3]+Ko(c,t[4].length))}function R8(t,e,r){return r+(e===0?"":""+e)+pn(" ",t[1].length+2+t[4].length)}var xN=/^#*0*\.([0#]+)/,yN=/\).*[0#]/,_N=/\(###\) ###\\?-####/;function Vs(t){for(var e="",r,a=0;a!=t.length;++a)switch(r=t.charCodeAt(a)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function _w(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function bw(t,e){var r=t-Math.floor(t),a=Math.pow(10,e);return e<(""+Math.round(r*a)).length?0:Math.round(r*a)}function D8(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function F8(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function so(t,e,r){if(t.charCodeAt(0)===40&&!e.match(yN)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?so("n",a,r):"("+so("n",a,-r)+")"}if(e.charCodeAt(e.length-1)===44)return T8(t,e,r);if(e.indexOf("%")!==-1)return C8(t,e,r);if(e.indexOf("E")!==-1)return gN(e,r);if(e.charCodeAt(0)===36)return"$"+so(t,e.substr(e.charAt(1)==" "?2:1),r);var n,s,l,c,d=Math.abs(r),f=r<0?"-":"";if(e.match(/^00+$/))return f+If(d,e.length);if(e.match(/^[#?]+$/))return n=If(r,0),n==="0"&&(n=""),n.length>e.length?n:Vs(e.substr(0,e.length-n.length))+n;if(s=e.match(vN))return O8(s,d,f);if(e.match(/^#+0+$/))return f+If(d,e.length-e.indexOf("0"));if(s=e.match(xN))return n=_w(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Vs(s[1])).replace(/\.$/,"."+Vs(s[1])).replace(/\.(\d*)$/,function(b,_){return"."+_+pn("0",Vs(s[1]).length-_.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return f+_w(d,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return f+gu(If(d,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+so(t,e,-r):gu(""+(Math.floor(r)+D8(r,s[1].length)))+"."+Ko(bw(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return so(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=eh(so(t,e.replace(/[\\-]/g,""),r)),l=0,eh(eh(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<n.length?n.charAt(l++):b==="0"?"0":""}));if(e.match(_N))return n=so(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=Qp(d,Math.pow(10,l)-1,!1),n=""+f,m=mc("n",s[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+s[2]+"/"+s[3],m=Jp(c[2],l),m.length<s[4].length&&(m=Vs(s[4].substr(s[4].length-m.length))+m),n+=m,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=Qp(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?f2(c[1],l)+s[2]+"/"+s[3]+Jp(c[2],l):pn(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=If(r,0),e.length<=n.length?n:Vs(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var v=e.indexOf(".")-l,x=e.length-n.length-v;return Vs(e.substr(0,v)+n+e.substr(e.length-x))}if(s=e.match(/^00,000\.([#0]*0)$/))return l=bw(r,s[1].length),r<0?"-"+so(t,e,-r):gu(F8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Ko(0,3-b.length):"")+b})+"."+Ko(l,s[1].length);switch(e){case"###,##0.00":return so(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=gu(If(d,0));return g!=="0"?f+g:"";case"###,###.00":return so(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return so(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function L8(t,e,r){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return mc(t,e.substr(0,a),r/Math.pow(10,3*(e.length-a)))}function P8(t,e,r){var a=e.replace(pN,""),n=e.length-a.length;return mc(t,a,r*Math.pow(10,2*n))+pn("%",n)}function bN(t,e){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+bN(t,-e);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(e/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!r.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,m){return d+f+m.substr(0,(n+s)%n)+"."+m.substr(s)+"E"})}else r=e.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Sl(t,e,r){if(t.charCodeAt(0)===40&&!e.match(yN)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Sl("n",a,r):"("+Sl("n",a,-r)+")"}if(e.charCodeAt(e.length-1)===44)return L8(t,e,r);if(e.indexOf("%")!==-1)return P8(t,e,r);if(e.indexOf("E")!==-1)return bN(e,r);if(e.charCodeAt(0)===36)return"$"+Sl(t,e.substr(e.charAt(1)==" "?2:1),r);var n,s,l,c,d=Math.abs(r),f=r<0?"-":"";if(e.match(/^00+$/))return f+Ko(d,e.length);if(e.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>e.length?n:Vs(e.substr(0,e.length-n.length))+n;if(s=e.match(vN))return R8(s,d,f);if(e.match(/^#+0+$/))return f+Ko(d,e.length-e.indexOf("0"));if(s=e.match(xN))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Vs(s[1])).replace(/\.$/,"."+Vs(s[1])),n=n.replace(/\.(\d*)$/,function(b,_){return"."+_+pn("0",Vs(s[1]).length-_.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return f+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return f+gu(""+d);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Sl(t,e,-r):gu(""+r)+"."+pn("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Sl(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=eh(Sl(t,e.replace(/[\\-]/g,""),r)),l=0,eh(eh(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<n.length?n.charAt(l++):b==="0"?"0":""}));if(e.match(_N))return n=Sl(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=Qp(d,Math.pow(10,l)-1,!1),n=""+f,m=mc("n",s[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+s[2]+"/"+s[3],m=Jp(c[2],l),m.length<s[4].length&&(m=Vs(s[4].substr(s[4].length-m.length))+m),n+=m,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=Qp(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?f2(c[1],l)+s[2]+"/"+s[3]+Jp(c[2],l):pn(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=""+r,e.length<=n.length?n:Vs(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var v=e.indexOf(".")-l,x=e.length-n.length-v;return Vs(e.substr(0,v)+n+e.substr(e.length-x))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Sl(t,e,-r):gu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Ko(0,3-b.length):"")+b})+"."+Ko(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=gu(""+d);return g!=="0"?f+g:"";default:if(e.match(/\.[0#?]*$/))return Sl(t,e.slice(0,e.lastIndexOf(".")),r)+Vs(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function mc(t,e,r){return(r|0)===r?Sl(t,e,r):so(t,e,r)}function M8(t){for(var e=[],r=!1,a=0,n=0;a<t.length;++a)switch(t.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:e[e.length]=t.substr(n,a-n),n=a+1}if(e[e.length]=t.substr(n),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var wN=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xh(t){for(var e=0,r="",a="";e<t.length;)switch(r=t.charAt(e)){case"G":Zp(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(a=r;t.charAt(e++)!=="]"&&e<t.length;)a+=t.charAt(e);if(a.match(wN))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function I8(t,e,r,a){for(var n=[],s="",l=0,c="",d="t",f,m,v,x="H";l<t.length;)switch(c=t.charAt(l)){case"G":if(!Zp(t,l))throw new Error("unrecognized character "+c+" in "+t);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(v=t.charCodeAt(++l))!==34&&l<t.length;)s+=String.fromCharCode(v);n[n.length]={t:"t",v:s},++l;break;case"\\":var g=t.charAt(++l),b=g==="("||g===")"?g:"t";n[n.length]={t:b,v:g},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(f==null&&(f=gd(e,r,t.charAt(l+1)==="2"),f==null))return"";n[n.length]={t:"X",v:t.substr(l,2)},d=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||f==null&&(f=gd(e,r),f==null))return"";for(s=c;++l<t.length&&t.charAt(l).toLowerCase()===c;)s+=c;c==="m"&&d.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),n[n.length]={t:c,v:s},d=c;break;case"A":case"a":case"":var _={t:c,v:c};if(f==null&&(f=gd(e,r)),t.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(_.v=f.H>=12?"P":"A"),_.t="T",x="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(_.v=f.H>=12?"PM":"AM"),_.t="T",l+=5,x="h"):t.substr(l,5).toUpperCase()==="/"?(f!=null&&(_.v=f.H>=12?"":""),_.t="T",l+=5,x="h"):(_.t="t",++l),f==null&&_.t==="T")return"";n[n.length]=_,d=c;break;case"[":for(s=c;t.charAt(l++)!=="]"&&l<t.length;)s+=t.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(wN)){if(f==null&&(f=gd(e,r),f==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},d=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",xh(t)||(n[n.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=c;++l<t.length&&(c=t.charAt(l))==="0";)s+=c;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++l<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(l))>-1;)s+=c;n[n.length]={t:"n",v:s};break;case"?":for(s=c;t.charAt(++l)===c;)s+=c;n[n.length]={t:c,v:s},d=c;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:a===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)s+=t.charAt(l);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:c,v:c},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);n[n.length]={t:"t",v:c},++l;break}var w=0,E=0,C;for(l=n.length-1,d="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=x,d="h",w<1&&(w=1);break;case"s":(C=n[l].v.match(/\.0+$/))&&(E=Math.max(E,C[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":d=n[l].t;break;case"m":d==="s"&&(n[l].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&n[l].v.match(/[Hh]/)&&(w=1),w<2&&n[l].v.match(/[Mm]/)&&(w=2),w<3&&n[l].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var A="",O;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=A8(n[l].t.charCodeAt(0),n[l].v,f,E),n[l].t="t";break;case"n":case"?":for(O=l+1;n[O]!=null&&((c=n[O].t)==="?"||c==="D"||(c===" "||c==="t")&&n[O+1]!=null&&(n[O+1].t==="?"||n[O+1].t==="t"&&n[O+1].v==="/")||n[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(n[O].v==="/"||n[O].v===" "&&n[O+1]!=null&&n[O+1].t=="?"));)n[l].v+=n[O].v,n[O]={v:"",t:";"},++O;A+=n[l].v,l=O-1;break;case"G":n[l].t="t",n[l].v=wd(e,r);break}var G="",W,B;if(A.length>0){A.charCodeAt(0)==40?(W=e<0&&A.charCodeAt(0)===45?-e:e,B=mc("n",A,W)):(W=e<0&&a>1?-e:e,B=mc("n",A,W),W<0&&n[0]&&n[0].t=="t"&&(B=B.substr(1),n[0].v="-"+n[0].v)),O=B.length-1;var q=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){q=l;break}var L=n.length;if(q===n.length&&B.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(O>=n[l].v.length-1?(O-=n[l].v.length,n[l].v=B.substr(O+1,n[l].v.length)):O<0?n[l].v="":(n[l].v=B.substr(0,O+1),O=-1),n[l].t="t",L=l);O>=0&&L<n.length&&(n[L].v=B.substr(0,O+1)+n[L].v)}else if(q!==n.length&&B.indexOf("E")===-1){for(O=B.indexOf(".")-1,l=q;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(m=n[l].v.indexOf(".")>-1&&l===q?n[l].v.indexOf(".")-1:n[l].v.length-1,G=n[l].v.substr(m+1);m>=0;--m)O>=0&&(n[l].v.charAt(m)==="0"||n[l].v.charAt(m)==="#")&&(G=B.charAt(O--)+G);n[l].v=G,n[l].t="t",L=l}for(O>=0&&L<n.length&&(n[L].v=B.substr(0,O+1)+n[L].v),O=B.indexOf(".")+1,l=q;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==q)){for(m=n[l].v.indexOf(".")>-1&&l===q?n[l].v.indexOf(".")+1:0,G=n[l].v.substr(0,m);m<n[l].v.length;++m)O<B.length&&(G+=B.charAt(O++));n[l].v=G,n[l].t="t",L=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(W=a>1&&e<0&&l>0&&n[l-1].v==="-"?-e:e,n[l].v=mc(n[l].t,n[l].v,W),n[l].t="t");var Z="";for(l=0;l!==n.length;++l)n[l]!=null&&(Z+=n[l].v);return Z}var ww=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Sw(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function B8(t,e){var r=M8(t),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(ww),c=r[1].match(ww);return Sw(e,l)?[a,r[0]]:Sw(e,c)?[a,r[1]]:[a,r[l!=null&&c!=null?2:1]]}return[a,s]}function mo(t,e,r){r==null&&(r={});var a="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?a=r.dateNF:a=t;break;case"number":t==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:wr)[t],a==null&&(a=r.table&&r.table[yw[t]]||wr[yw[t]]),a==null&&(a=b8[t]||"General");break}if(Zp(a,0))return wd(e,r);e instanceof Date&&(e=mN(e,r.date1904));var n=B8(a,e);if(Zp(n[1]))return wd(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return I8(n[1],e,r,n[0])}function pc(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(wr[r]==null){e<0&&(e=r);continue}if(wr[r]==t){e=r;break}}e<0&&(e=391)}return wr[e]=t,e}function b1(t){for(var e=0;e!=392;++e)t[e]!==void 0&&pc(t[e],e)}function yh(){wr=_8()}var U8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},SN=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function q8(t){var e=typeof t=="number"?wr[t]:t;return e=e.replace(SN,"(\\d+)"),new RegExp("^"+e+"$")}function z8(t,e,r){var a=-1,n=-1,s=-1,l=-1,c=-1,d=-1;(e.match(SN)||[]).forEach(function(v,x){var g=parseInt(r[x+1],10);switch(v.toLowerCase().charAt(0)){case"y":a=g;break;case"d":s=g;break;case"h":l=g;break;case"s":d=g;break;case"m":l>=0?c=g:n=g;break}}),d>=0&&c==-1&&n>=0&&(c=n,n=-1);var f=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return l==-1&&c==-1&&d==-1?f:a==-1&&n==-1&&s==-1?m:f+"T"+m}var H8=(function(){var t={};t.version="1.2.0";function e(){for(var B=0,q=new Array(256),L=0;L!=256;++L)B=L,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,q[L]=B;return typeof Int32Array<"u"?new Int32Array(q):q}var r=e();function a(B){var q=0,L=0,Z=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Z=0;Z!=256;++Z)D[Z]=B[Z];for(Z=0;Z!=256;++Z)for(L=B[Z],q=256+Z;q<4096;q+=256)L=D[q]=L>>>8^B[L&255];var T=[];for(Z=1;Z!=16;++Z)T[Z-1]=typeof Int32Array<"u"?D.subarray(Z*256,Z*256+256):D.slice(Z*256,Z*256+256);return T}var n=a(r),s=n[0],l=n[1],c=n[2],d=n[3],f=n[4],m=n[5],v=n[6],x=n[7],g=n[8],b=n[9],_=n[10],w=n[11],E=n[12],C=n[13],A=n[14];function O(B,q){for(var L=q^-1,Z=0,D=B.length;Z<D;)L=L>>>8^r[(L^B.charCodeAt(Z++))&255];return~L}function G(B,q){for(var L=q^-1,Z=B.length-15,D=0;D<Z;)L=A[B[D++]^L&255]^C[B[D++]^L>>8&255]^E[B[D++]^L>>16&255]^w[B[D++]^L>>>24]^_[B[D++]]^b[B[D++]]^g[B[D++]]^x[B[D++]]^v[B[D++]]^m[B[D++]]^f[B[D++]]^d[B[D++]]^c[B[D++]]^l[B[D++]]^s[B[D++]]^r[B[D++]];for(Z+=15;D<Z;)L=L>>>8^r[(L^B[D++])&255];return~L}function W(B,q){for(var L=q^-1,Z=0,D=B.length,T=0,M=0;Z<D;)T=B.charCodeAt(Z++),T<128?L=L>>>8^r[(L^T)&255]:T<2048?(L=L>>>8^r[(L^(192|T>>6&31))&255],L=L>>>8^r[(L^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,M=B.charCodeAt(Z++)&1023,L=L>>>8^r[(L^(240|T>>8&7))&255],L=L>>>8^r[(L^(128|T>>2&63))&255],L=L>>>8^r[(L^(128|M>>6&15|(T&3)<<4))&255],L=L>>>8^r[(L^(128|M&63))&255]):(L=L>>>8^r[(L^(224|T>>12&15))&255],L=L>>>8^r[(L^(128|T>>6&63))&255],L=L>>>8^r[(L^(128|T&63))&255]);return~L}return t.table=r,t.bstr=O,t.buf=G,t.str=W,t})(),pr=(function(){var e={};e.version="1.2.1";function r(ae,be){for(var me=ae.split("/"),pe=be.split("/"),Se=0,we=0,$e=Math.min(me.length,pe.length);Se<$e;++Se){if(we=me[Se].length-pe[Se].length)return we;if(me[Se]!=pe[Se])return me[Se]<pe[Se]?-1:1}return me.length-pe.length}function a(ae){if(ae.charAt(ae.length-1)=="/")return ae.slice(0,-1).indexOf("/")===-1?ae:a(ae.slice(0,-1));var be=ae.lastIndexOf("/");return be===-1?ae:ae.slice(0,be+1)}function n(ae){if(ae.charAt(ae.length-1)=="/")return n(ae.slice(0,-1));var be=ae.lastIndexOf("/");return be===-1?ae:ae.slice(be+1)}function s(ae,be){typeof be=="string"&&(be=new Date(be));var me=be.getHours();me=me<<6|be.getMinutes(),me=me<<5|be.getSeconds()>>>1,ae.write_shift(2,me);var pe=be.getFullYear()-1980;pe=pe<<4|be.getMonth()+1,pe=pe<<5|be.getDate(),ae.write_shift(2,pe)}function l(ae){var be=ae.read_shift(2)&65535,me=ae.read_shift(2)&65535,pe=new Date,Se=me&31;me>>>=5;var we=me&15;me>>>=4,pe.setMilliseconds(0),pe.setFullYear(me+1980),pe.setMonth(we-1),pe.setDate(Se);var $e=be&31;be>>>=5;var lt=be&63;return be>>>=6,pe.setHours(be),pe.setMinutes(lt),pe.setSeconds($e<<1),pe}function c(ae){ys(ae,0);for(var be={},me=0;ae.l<=ae.length-4;){var pe=ae.read_shift(2),Se=ae.read_shift(2),we=ae.l+Se,$e={};switch(pe){case 21589:me=ae.read_shift(1),me&1&&($e.mtime=ae.read_shift(4)),Se>5&&(me&2&&($e.atime=ae.read_shift(4)),me&4&&($e.ctime=ae.read_shift(4))),$e.mtime&&($e.mt=new Date($e.mtime*1e3));break}ae.l=we,be[pe]=$e}return be}var d;function f(){return d||(d={})}function m(ae,be){if(ae[0]==80&&ae[1]==75)return gt(ae,be);if((ae[0]|32)==109&&(ae[1]|32)==105)return ir(ae,be);if(ae.length<512)throw new Error("CFB file size "+ae.length+" < 512");var me=3,pe=512,Se=0,we=0,$e=0,lt=0,Xe=0,Ke=[],Qe=ae.slice(0,512);ys(Qe,0);var Et=v(Qe);switch(me=Et[0],me){case 3:pe=512;break;case 4:pe=4096;break;case 0:if(Et[1]==0)return gt(ae,be);default:throw new Error("Major Version: Expected 3 or 4 saw "+me)}pe!==512&&(Qe=ae.slice(0,pe),ys(Qe,28));var Rt=ae.slice(0,pe);x(Qe,me);var qt=Qe.read_shift(4,"i");if(me===3&&qt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qt);Qe.l+=4,$e=Qe.read_shift(4,"i"),Qe.l+=4,Qe.chk("00100000","Mini Stream Cutoff Size: "),lt=Qe.read_shift(4,"i"),Se=Qe.read_shift(4,"i"),Xe=Qe.read_shift(4,"i"),we=Qe.read_shift(4,"i");for(var Ot=-1,Mt=0;Mt<109&&(Ot=Qe.read_shift(4,"i"),!(Ot<0));++Mt)Ke[Mt]=Ot;var Jt=g(ae,pe);w(Xe,we,Jt,pe,Ke);var oa=C(Jt,$e,Ke,pe);oa[$e].name="!Directory",Se>0&&lt!==M&&(oa[lt].name="!MiniFAT"),oa[Ke[0]].name="!FAT",oa.fat_addrs=Ke,oa.ssz=pe;var Mr={},da=[],ls=[],gi=[];A($e,oa,Jt,da,Se,Mr,ls,lt),b(ls,gi,da),da.shift();var vi={FileIndex:ls,FullPaths:gi};return be&&be.raw&&(vi.raw={header:Rt,sectors:Jt}),vi}function v(ae){if(ae[ae.l]==80&&ae[ae.l+1]==75)return[0,0];ae.chk(V,"Header Signature: "),ae.l+=16;var be=ae.read_shift(2,"u");return[ae.read_shift(2,"u"),be]}function x(ae,be){var me=9;switch(ae.l+=2,me=ae.read_shift(2)){case 9:if(be!=3)throw new Error("Sector Shift: Expected 9 saw "+me);break;case 12:if(be!=4)throw new Error("Sector Shift: Expected 12 saw "+me);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+me)}ae.chk("0600","Mini Sector Shift: "),ae.chk("000000000000","Reserved: ")}function g(ae,be){for(var me=Math.ceil(ae.length/be)-1,pe=[],Se=1;Se<me;++Se)pe[Se-1]=ae.slice(Se*be,(Se+1)*be);return pe[me-1]=ae.slice(me*be),pe}function b(ae,be,me){for(var pe=0,Se=0,we=0,$e=0,lt=0,Xe=me.length,Ke=[],Qe=[];pe<Xe;++pe)Ke[pe]=Qe[pe]=pe,be[pe]=me[pe];for(;lt<Qe.length;++lt)pe=Qe[lt],Se=ae[pe].L,we=ae[pe].R,$e=ae[pe].C,Ke[pe]===pe&&(Se!==-1&&Ke[Se]!==Se&&(Ke[pe]=Ke[Se]),we!==-1&&Ke[we]!==we&&(Ke[pe]=Ke[we])),$e!==-1&&(Ke[$e]=pe),Se!==-1&&pe!=Ke[pe]&&(Ke[Se]=Ke[pe],Qe.lastIndexOf(Se)<lt&&Qe.push(Se)),we!==-1&&pe!=Ke[pe]&&(Ke[we]=Ke[pe],Qe.lastIndexOf(we)<lt&&Qe.push(we));for(pe=1;pe<Xe;++pe)Ke[pe]===pe&&(we!==-1&&Ke[we]!==we?Ke[pe]=Ke[we]:Se!==-1&&Ke[Se]!==Se&&(Ke[pe]=Ke[Se]));for(pe=1;pe<Xe;++pe)if(ae[pe].type!==0){if(lt=pe,lt!=Ke[lt])do lt=Ke[lt],be[pe]=be[lt]+"/"+be[pe];while(lt!==0&&Ke[lt]!==-1&&lt!=Ke[lt]);Ke[pe]=-1}for(be[0]+="/",pe=1;pe<Xe;++pe)ae[pe].type!==2&&(be[pe]+="/")}function _(ae,be,me){for(var pe=ae.start,Se=ae.size,we=[],$e=pe;me&&Se>0&&$e>=0;)we.push(be.slice($e*T,$e*T+T)),Se-=T,$e=dd(me,$e*4);return we.length===0?ft(0):is(we).slice(0,ae.size)}function w(ae,be,me,pe,Se){var we=M;if(ae===M){if(be!==0)throw new Error("DIFAT chain shorter than expected")}else if(ae!==-1){var $e=me[ae],lt=(pe>>>2)-1;if(!$e)return;for(var Xe=0;Xe<lt&&(we=dd($e,Xe*4))!==M;++Xe)Se.push(we);w(dd($e,pe-4),be-1,me,pe,Se)}}function E(ae,be,me,pe,Se){var we=[],$e=[];Se||(Se=[]);var lt=pe-1,Xe=0,Ke=0;for(Xe=be;Xe>=0;){Se[Xe]=!0,we[we.length]=Xe,$e.push(ae[Xe]);var Qe=me[Math.floor(Xe*4/pe)];if(Ke=Xe*4&lt,pe<4+Ke)throw new Error("FAT boundary crossed: "+Xe+" 4 "+pe);if(!ae[Qe])break;Xe=dd(ae[Qe],Ke)}return{nodes:we,data:Lw([$e])}}function C(ae,be,me,pe){var Se=ae.length,we=[],$e=[],lt=[],Xe=[],Ke=pe-1,Qe=0,Et=0,Rt=0,qt=0;for(Qe=0;Qe<Se;++Qe)if(lt=[],Rt=Qe+be,Rt>=Se&&(Rt-=Se),!$e[Rt]){Xe=[];var Ot=[];for(Et=Rt;Et>=0;){Ot[Et]=!0,$e[Et]=!0,lt[lt.length]=Et,Xe.push(ae[Et]);var Mt=me[Math.floor(Et*4/pe)];if(qt=Et*4&Ke,pe<4+qt)throw new Error("FAT boundary crossed: "+Et+" 4 "+pe);if(!ae[Mt]||(Et=dd(ae[Mt],qt),Ot[Et]))break}we[Rt]={nodes:lt,data:Lw([Xe])}}return we}function A(ae,be,me,pe,Se,we,$e,lt){for(var Xe=0,Ke=pe.length?2:0,Qe=be[ae].data,Et=0,Rt=0,qt;Et<Qe.length;Et+=128){var Ot=Qe.slice(Et,Et+128);ys(Ot,64),Rt=Ot.read_shift(2),qt=_2(Ot,0,Rt-Ke),pe.push(qt);var Mt={name:qt,type:Ot.read_shift(1),color:Ot.read_shift(1),L:Ot.read_shift(4,"i"),R:Ot.read_shift(4,"i"),C:Ot.read_shift(4,"i"),clsid:Ot.read_shift(16),state:Ot.read_shift(4,"i"),start:0,size:0},Jt=Ot.read_shift(2)+Ot.read_shift(2)+Ot.read_shift(2)+Ot.read_shift(2);Jt!==0&&(Mt.ct=O(Ot,Ot.l-8));var oa=Ot.read_shift(2)+Ot.read_shift(2)+Ot.read_shift(2)+Ot.read_shift(2);oa!==0&&(Mt.mt=O(Ot,Ot.l-8)),Mt.start=Ot.read_shift(4,"i"),Mt.size=Ot.read_shift(4,"i"),Mt.size<0&&Mt.start<0&&(Mt.size=Mt.type=0,Mt.start=M,Mt.name=""),Mt.type===5?(Xe=Mt.start,Se>0&&Xe!==M&&(be[Xe].name="!StreamData")):Mt.size>=4096?(Mt.storage="fat",be[Mt.start]===void 0&&(be[Mt.start]=E(me,Mt.start,be.fat_addrs,be.ssz)),be[Mt.start].name=Mt.name,Mt.content=be[Mt.start].data.slice(0,Mt.size)):(Mt.storage="minifat",Mt.size<0?Mt.size=0:Xe!==M&&Mt.start!==M&&be[Xe]&&(Mt.content=_(Mt,be[Xe].data,(be[lt]||{}).data))),Mt.content&&ys(Mt.content,0),we[qt]=Mt,$e.push(Mt)}}function O(ae,be){return new Date((Fi(ae,be+4)/1e7*Math.pow(2,32)+Fi(ae,be)/1e7-11644473600)*1e3)}function G(ae,be){return f(),m(d.readFileSync(ae),be)}function W(ae,be){var me=be&&be.type;switch(me||Ir&&Buffer.isBuffer(ae)&&(me="buffer"),me||"base64"){case"file":return G(ae,be);case"base64":return m(Mi(qi(ae)),be);case"binary":return m(Mi(ae),be)}return m(ae,be)}function B(ae,be){var me=be||{},pe=me.root||"Root Entry";if(ae.FullPaths||(ae.FullPaths=[]),ae.FileIndex||(ae.FileIndex=[]),ae.FullPaths.length!==ae.FileIndex.length)throw new Error("inconsistent CFB structure");ae.FullPaths.length===0&&(ae.FullPaths[0]=pe+"/",ae.FileIndex[0]={name:pe,type:5}),me.CLSID&&(ae.FileIndex[0].clsid=me.CLSID),q(ae)}function q(ae){var be="Sh33tJ5";if(!pr.find(ae,"/"+be)){var me=ft(4);me[0]=55,me[1]=me[3]=50,me[2]=54,ae.FileIndex.push({name:be,type:2,content:me,size:4,L:69,R:69,C:69}),ae.FullPaths.push(ae.FullPaths[0]+be),L(ae)}}function L(ae,be){B(ae);for(var me=!1,pe=!1,Se=ae.FullPaths.length-1;Se>=0;--Se){var we=ae.FileIndex[Se];switch(we.type){case 0:pe?me=!0:(ae.FileIndex.pop(),ae.FullPaths.pop());break;case 1:case 2:case 5:pe=!0,isNaN(we.R*we.L*we.C)&&(me=!0),we.R>-1&&we.L>-1&&we.R==we.L&&(me=!0);break;default:me=!0;break}}if(!(!me&&!be)){var $e=new Date(1987,1,19),lt=0,Xe=Object.create?Object.create(null):{},Ke=[];for(Se=0;Se<ae.FullPaths.length;++Se)Xe[ae.FullPaths[Se]]=!0,ae.FileIndex[Se].type!==0&&Ke.push([ae.FullPaths[Se],ae.FileIndex[Se]]);for(Se=0;Se<Ke.length;++Se){var Qe=a(Ke[Se][0]);pe=Xe[Qe],pe||(Ke.push([Qe,{name:n(Qe).replace("/",""),type:1,clsid:X,ct:$e,mt:$e,content:null}]),Xe[Qe]=!0)}for(Ke.sort(function(qt,Ot){return r(qt[0],Ot[0])}),ae.FullPaths=[],ae.FileIndex=[],Se=0;Se<Ke.length;++Se)ae.FullPaths[Se]=Ke[Se][0],ae.FileIndex[Se]=Ke[Se][1];for(Se=0;Se<Ke.length;++Se){var Et=ae.FileIndex[Se],Rt=ae.FullPaths[Se];if(Et.name=n(Rt).replace("/",""),Et.L=Et.R=Et.C=-(Et.color=1),Et.size=Et.content?Et.content.length:0,Et.start=0,Et.clsid=Et.clsid||X,Se===0)Et.C=Ke.length>1?1:-1,Et.size=0,Et.type=5;else if(Rt.slice(-1)=="/"){for(lt=Se+1;lt<Ke.length&&a(ae.FullPaths[lt])!=Rt;++lt);for(Et.C=lt>=Ke.length?-1:lt,lt=Se+1;lt<Ke.length&&a(ae.FullPaths[lt])!=a(Rt);++lt);Et.R=lt>=Ke.length?-1:lt,Et.type=1}else a(ae.FullPaths[Se+1]||"")==a(Rt)&&(Et.R=Se+1),Et.type=2}}}function Z(ae,be){var me=be||{};if(me.fileType=="mad")return Ea(ae,me);switch(L(ae),me.fileType){case"zip":return Vt(ae,me)}var pe=(function(qt){for(var Ot=0,Mt=0,Jt=0;Jt<qt.FileIndex.length;++Jt){var oa=qt.FileIndex[Jt];if(oa.content){var Mr=oa.content.length;Mr>0&&(Mr<4096?Ot+=Mr+63>>6:Mt+=Mr+511>>9)}}for(var da=qt.FullPaths.length+3>>2,ls=Ot+7>>3,gi=Ot+127>>7,vi=ls+Mt+da+gi,Bs=vi+127>>7,rl=Bs<=109?0:Math.ceil((Bs-109)/127);vi+Bs+rl+127>>7>Bs;)rl=++Bs<=109?0:Math.ceil((Bs-109)/127);var Fa=[1,rl,Bs,gi,da,Mt,Ot,0];return qt.FileIndex[0].size=Ot<<6,Fa[7]=(qt.FileIndex[0].start=Fa[0]+Fa[1]+Fa[2]+Fa[3]+Fa[4]+Fa[5])+(Fa[6]+7>>3),Fa})(ae),Se=ft(pe[7]<<9),we=0,$e=0;{for(we=0;we<8;++we)Se.write_shift(1,ie[we]);for(we=0;we<8;++we)Se.write_shift(2,0);for(Se.write_shift(2,62),Se.write_shift(2,3),Se.write_shift(2,65534),Se.write_shift(2,9),Se.write_shift(2,6),we=0;we<3;++we)Se.write_shift(2,0);for(Se.write_shift(4,0),Se.write_shift(4,pe[2]),Se.write_shift(4,pe[0]+pe[1]+pe[2]+pe[3]-1),Se.write_shift(4,0),Se.write_shift(4,4096),Se.write_shift(4,pe[3]?pe[0]+pe[1]+pe[2]-1:M),Se.write_shift(4,pe[3]),Se.write_shift(-4,pe[1]?pe[0]-1:M),Se.write_shift(4,pe[1]),we=0;we<109;++we)Se.write_shift(-4,we<pe[2]?pe[1]+we:-1)}if(pe[1])for($e=0;$e<pe[1];++$e){for(;we<236+$e*127;++we)Se.write_shift(-4,we<pe[2]?pe[1]+we:-1);Se.write_shift(-4,$e===pe[1]-1?M:$e+1)}var lt=function(qt){for($e+=qt;we<$e-1;++we)Se.write_shift(-4,we+1);qt&&(++we,Se.write_shift(-4,M))};for($e=we=0,$e+=pe[1];we<$e;++we)Se.write_shift(-4,J.DIFSECT);for($e+=pe[2];we<$e;++we)Se.write_shift(-4,J.FATSECT);lt(pe[3]),lt(pe[4]);for(var Xe=0,Ke=0,Qe=ae.FileIndex[0];Xe<ae.FileIndex.length;++Xe)Qe=ae.FileIndex[Xe],Qe.content&&(Ke=Qe.content.length,!(Ke<4096)&&(Qe.start=$e,lt(Ke+511>>9)));for(lt(pe[6]+7>>3);Se.l&511;)Se.write_shift(-4,J.ENDOFCHAIN);for($e=we=0,Xe=0;Xe<ae.FileIndex.length;++Xe)Qe=ae.FileIndex[Xe],Qe.content&&(Ke=Qe.content.length,!(!Ke||Ke>=4096)&&(Qe.start=$e,lt(Ke+63>>6)));for(;Se.l&511;)Se.write_shift(-4,J.ENDOFCHAIN);for(we=0;we<pe[4]<<2;++we){var Et=ae.FullPaths[we];if(!Et||Et.length===0){for(Xe=0;Xe<17;++Xe)Se.write_shift(4,0);for(Xe=0;Xe<3;++Xe)Se.write_shift(4,-1);for(Xe=0;Xe<12;++Xe)Se.write_shift(4,0);continue}Qe=ae.FileIndex[we],we===0&&(Qe.start=Qe.size?Qe.start-1:M);var Rt=we===0&&me.root||Qe.name;if(Ke=2*(Rt.length+1),Se.write_shift(64,Rt,"utf16le"),Se.write_shift(2,Ke),Se.write_shift(1,Qe.type),Se.write_shift(1,Qe.color),Se.write_shift(-4,Qe.L),Se.write_shift(-4,Qe.R),Se.write_shift(-4,Qe.C),Qe.clsid)Se.write_shift(16,Qe.clsid,"hex");else for(Xe=0;Xe<4;++Xe)Se.write_shift(4,0);Se.write_shift(4,Qe.state||0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,Qe.start),Se.write_shift(4,Qe.size),Se.write_shift(4,0)}for(we=1;we<ae.FileIndex.length;++we)if(Qe=ae.FileIndex[we],Qe.size>=4096)if(Se.l=Qe.start+1<<9,Ir&&Buffer.isBuffer(Qe.content))Qe.content.copy(Se,Se.l,0,Qe.size),Se.l+=Qe.size+511&-512;else{for(Xe=0;Xe<Qe.size;++Xe)Se.write_shift(1,Qe.content[Xe]);for(;Xe&511;++Xe)Se.write_shift(1,0)}for(we=1;we<ae.FileIndex.length;++we)if(Qe=ae.FileIndex[we],Qe.size>0&&Qe.size<4096)if(Ir&&Buffer.isBuffer(Qe.content))Qe.content.copy(Se,Se.l,0,Qe.size),Se.l+=Qe.size+63&-64;else{for(Xe=0;Xe<Qe.size;++Xe)Se.write_shift(1,Qe.content[Xe]);for(;Xe&63;++Xe)Se.write_shift(1,0)}if(Ir)Se.l=Se.length;else for(;Se.l<Se.length;)Se.write_shift(1,0);return Se}function D(ae,be){var me=ae.FullPaths.map(function(Xe){return Xe.toUpperCase()}),pe=me.map(function(Xe){var Ke=Xe.split("/");return Ke[Ke.length-(Xe.slice(-1)=="/"?2:1)]}),Se=!1;be.charCodeAt(0)===47?(Se=!0,be=me[0].slice(0,-1)+be):Se=be.indexOf("/")!==-1;var we=be.toUpperCase(),$e=Se===!0?me.indexOf(we):pe.indexOf(we);if($e!==-1)return ae.FileIndex[$e];var lt=!we.match(h0);for(we=we.replace(Ys,""),lt&&(we=we.replace(h0,"!")),$e=0;$e<me.length;++$e)if((lt?me[$e].replace(h0,"!"):me[$e]).replace(Ys,"")==we||(lt?pe[$e].replace(h0,"!"):pe[$e]).replace(Ys,"")==we)return ae.FileIndex[$e];return null}var T=64,M=-2,V="d0cf11e0a1b11ae1",ie=[208,207,17,224,161,177,26,225],X="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:V,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:X,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(ae,be,me){f();var pe=Z(ae,me);d.writeFileSync(be,pe)}function te(ae){for(var be=new Array(ae.length),me=0;me<ae.length;++me)be[me]=String.fromCharCode(ae[me]);return be.join("")}function fe(ae,be){var me=Z(ae,be);switch(be&&be.type||"buffer"){case"file":return f(),d.writeFileSync(be.filename,me),me;case"binary":return typeof me=="string"?me:te(me);case"base64":return P0(typeof me=="string"?me:te(me));case"buffer":if(Ir)return Buffer.isBuffer(me)?me:wc(me);case"array":return typeof me=="string"?Mi(me):me}return me}var U;function j(ae){try{var be=ae.InflateRaw,me=new be;if(me._processChunk(new Uint8Array([3,0]),me._finishFlushFlag),me.bytesRead)U=ae;else throw new Error("zlib does not expose bytesRead")}catch(pe){console.error("cannot use native zlib: "+(pe.message||pe))}}function F(ae,be){if(!U)return Ue(ae,be);var me=U.InflateRaw,pe=new me,Se=pe._processChunk(ae.slice(ae.l),pe._finishFlushFlag);return ae.l+=pe.bytesRead,Se}function I(ae){return U?U.deflateRawSync(ae):Ce(ae)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function je(ae){var be=(ae<<1|ae<<11)&139536|(ae<<5|ae<<15)&558144;return(be>>16|be>>8|be)&255}for(var Ne=typeof Uint8Array<"u",ge=Ne?new Uint8Array(256):[],Ie=0;Ie<256;++Ie)ge[Ie]=je(Ie);function le(ae,be){var me=ge[ae&255];return be<=8?me>>>8-be:(me=me<<8|ge[ae>>8&255],be<=16?me>>>16-be:(me=me<<8|ge[ae>>16&255],me>>>24-be))}function Ge(ae,be){var me=be&7,pe=be>>>3;return(ae[pe]|(me<=6?0:ae[pe+1]<<8))>>>me&3}function rt(ae,be){var me=be&7,pe=be>>>3;return(ae[pe]|(me<=5?0:ae[pe+1]<<8))>>>me&7}function ue(ae,be){var me=be&7,pe=be>>>3;return(ae[pe]|(me<=4?0:ae[pe+1]<<8))>>>me&15}function ot(ae,be){var me=be&7,pe=be>>>3;return(ae[pe]|(me<=3?0:ae[pe+1]<<8))>>>me&31}function xe(ae,be){var me=be&7,pe=be>>>3;return(ae[pe]|(me<=1?0:ae[pe+1]<<8))>>>me&127}function ve(ae,be,me){var pe=be&7,Se=be>>>3,we=(1<<me)-1,$e=ae[Se]>>>pe;return me<8-pe||($e|=ae[Se+1]<<8-pe,me<16-pe)||($e|=ae[Se+2]<<16-pe,me<24-pe)||($e|=ae[Se+3]<<24-pe),$e&we}function Be(ae,be,me){var pe=be&7,Se=be>>>3;return pe<=5?ae[Se]|=(me&7)<<pe:(ae[Se]|=me<<pe&255,ae[Se+1]=(me&7)>>8-pe),be+3}function jt(ae,be,me){var pe=be&7,Se=be>>>3;return me=(me&1)<<pe,ae[Se]|=me,be+1}function Je(ae,be,me){var pe=be&7,Se=be>>>3;return me<<=pe,ae[Se]|=me&255,me>>>=8,ae[Se+1]=me,be+8}function ct(ae,be,me){var pe=be&7,Se=be>>>3;return me<<=pe,ae[Se]|=me&255,me>>>=8,ae[Se+1]=me&255,ae[Se+2]=me>>>8,be+16}function St(ae,be){var me=ae.length,pe=2*me>be?2*me:be+5,Se=0;if(me>=be)return ae;if(Ir){var we=gw(pe);if(ae.copy)ae.copy(we);else for(;Se<ae.length;++Se)we[Se]=ae[Se];return we}else if(Ne){var $e=new Uint8Array(pe);if($e.set)$e.set(ae);else for(;Se<me;++Se)$e[Se]=ae[Se];return $e}return ae.length=pe,ae}function Ft(ae){for(var be=new Array(ae),me=0;me<ae;++me)be[me]=0;return be}function Xt(ae,be,me){var pe=1,Se=0,we=0,$e=0,lt=0,Xe=ae.length,Ke=Ne?new Uint16Array(32):Ft(32);for(we=0;we<32;++we)Ke[we]=0;for(we=Xe;we<me;++we)ae[we]=0;Xe=ae.length;var Qe=Ne?new Uint16Array(Xe):Ft(Xe);for(we=0;we<Xe;++we)Ke[Se=ae[we]]++,pe<Se&&(pe=Se),Qe[we]=0;for(Ke[0]=0,we=1;we<=pe;++we)Ke[we+16]=lt=lt+Ke[we-1]<<1;for(we=0;we<Xe;++we)lt=ae[we],lt!=0&&(Qe[we]=Ke[lt+16]++);var Et=0;for(we=0;we<Xe;++we)if(Et=ae[we],Et!=0)for(lt=le(Qe[we],pe)>>pe-Et,$e=(1<<pe+4-Et)-1;$e>=0;--$e)be[lt|$e<<Et]=Et&15|we<<4;return pe}var Ut=Ne?new Uint16Array(512):Ft(512),Wt=Ne?new Uint16Array(32):Ft(32);if(!Ne){for(var $t=0;$t<512;++$t)Ut[$t]=0;for($t=0;$t<32;++$t)Wt[$t]=0}(function(){for(var ae=[],be=0;be<32;be++)ae.push(5);Xt(ae,Wt,32);var me=[];for(be=0;be<=143;be++)me.push(8);for(;be<=255;be++)me.push(9);for(;be<=279;be++)me.push(7);for(;be<=287;be++)me.push(8);Xt(me,Ut,288)})();var wt=(function(){for(var be=Ne?new Uint8Array(32768):[],me=0,pe=0;me<se.length-1;++me)for(;pe<se[me+1];++pe)be[pe]=me;for(;pe<32768;++pe)be[pe]=29;var Se=Ne?new Uint8Array(259):[];for(me=0,pe=0;me<ne.length-1;++me)for(;pe<ne[me+1];++pe)Se[pe]=me;function we(lt,Xe){for(var Ke=0;Ke<lt.length;){var Qe=Math.min(65535,lt.length-Ke),Et=Ke+Qe==lt.length;for(Xe.write_shift(1,+Et),Xe.write_shift(2,Qe),Xe.write_shift(2,~Qe&65535);Qe-- >0;)Xe[Xe.l++]=lt[Ke++]}return Xe.l}function $e(lt,Xe){for(var Ke=0,Qe=0,Et=Ne?new Uint16Array(32768):[];Qe<lt.length;){var Rt=Math.min(65535,lt.length-Qe);if(Rt<10){for(Ke=Be(Xe,Ke,+(Qe+Rt==lt.length)),Ke&7&&(Ke+=8-(Ke&7)),Xe.l=Ke/8|0,Xe.write_shift(2,Rt),Xe.write_shift(2,~Rt&65535);Rt-- >0;)Xe[Xe.l++]=lt[Qe++];Ke=Xe.l*8;continue}Ke=Be(Xe,Ke,+(Qe+Rt==lt.length)+2);for(var qt=0;Rt-- >0;){var Ot=lt[Qe];qt=(qt<<5^Ot)&32767;var Mt=-1,Jt=0;if((Mt=Et[qt])&&(Mt|=Qe&-32768,Mt>Qe&&(Mt-=32768),Mt<Qe))for(;lt[Mt+Jt]==lt[Qe+Jt]&&Jt<250;)++Jt;if(Jt>2){Ot=Se[Jt],Ot<=22?Ke=Je(Xe,Ke,ge[Ot+1]>>1)-1:(Je(Xe,Ke,3),Ke+=5,Je(Xe,Ke,ge[Ot-23]>>5),Ke+=3);var oa=Ot<8?0:Ot-4>>2;oa>0&&(ct(Xe,Ke,Jt-ne[Ot]),Ke+=oa),Ot=be[Qe-Mt],Ke=Je(Xe,Ke,ge[Ot]>>3),Ke-=3;var Mr=Ot<4?0:Ot-2>>1;Mr>0&&(ct(Xe,Ke,Qe-Mt-se[Ot]),Ke+=Mr);for(var da=0;da<Jt;++da)Et[qt]=Qe&32767,qt=(qt<<5^lt[Qe])&32767,++Qe;Rt-=Jt-1}else Ot<=143?Ot=Ot+48:Ke=jt(Xe,Ke,1),Ke=Je(Xe,Ke,ge[Ot]),Et[qt]=Qe&32767,++Qe}Ke=Je(Xe,Ke,0)-1}return Xe.l=(Ke+7)/8|0,Xe.l}return function(Xe,Ke){return Xe.length<8?we(Xe,Ke):$e(Xe,Ke)}})();function Ce(ae){var be=ft(50+Math.floor(ae.length*1.1)),me=wt(ae,be);return be.slice(0,me)}var st=Ne?new Uint16Array(32768):Ft(32768),Dt=Ne?new Uint16Array(32768):Ft(32768),At=Ne?new Uint16Array(128):Ft(128),Ct=1,Te=1;function Ve(ae,be){var me=ot(ae,be)+257;be+=5;var pe=ot(ae,be)+1;be+=5;var Se=ue(ae,be)+4;be+=4;for(var we=0,$e=Ne?new Uint8Array(19):Ft(19),lt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Xe=1,Ke=Ne?new Uint8Array(8):Ft(8),Qe=Ne?new Uint8Array(8):Ft(8),Et=$e.length,Rt=0;Rt<Se;++Rt)$e[z[Rt]]=we=rt(ae,be),Xe<we&&(Xe=we),Ke[we]++,be+=3;var qt=0;for(Ke[0]=0,Rt=1;Rt<=Xe;++Rt)Qe[Rt]=qt=qt+Ke[Rt-1]<<1;for(Rt=0;Rt<Et;++Rt)(qt=$e[Rt])!=0&&(lt[Rt]=Qe[qt]++);var Ot=0;for(Rt=0;Rt<Et;++Rt)if(Ot=$e[Rt],Ot!=0){qt=ge[lt[Rt]]>>8-Ot;for(var Mt=(1<<7-Ot)-1;Mt>=0;--Mt)At[qt|Mt<<Ot]=Ot&7|Rt<<3}var Jt=[];for(Xe=1;Jt.length<me+pe;)switch(qt=At[xe(ae,be)],be+=qt&7,qt>>>=3){case 16:for(we=3+Ge(ae,be),be+=2,qt=Jt[Jt.length-1];we-- >0;)Jt.push(qt);break;case 17:for(we=3+rt(ae,be),be+=3;we-- >0;)Jt.push(0);break;case 18:for(we=11+xe(ae,be),be+=7;we-- >0;)Jt.push(0);break;default:Jt.push(qt),Xe<qt&&(Xe=qt);break}var oa=Jt.slice(0,me),Mr=Jt.slice(me);for(Rt=me;Rt<286;++Rt)oa[Rt]=0;for(Rt=pe;Rt<30;++Rt)Mr[Rt]=0;return Ct=Xt(oa,st,286),Te=Xt(Mr,Dt,30),be}function _e(ae,be){if(ae[0]==3&&!(ae[1]&3))return[xu(be),2];for(var me=0,pe=0,Se=gw(be||1<<18),we=0,$e=Se.length>>>0,lt=0,Xe=0;(pe&1)==0;){if(pe=rt(ae,me),me+=3,pe>>>1)pe>>1==1?(lt=9,Xe=5):(me=Ve(ae,me),lt=Ct,Xe=Te);else{me&7&&(me+=8-(me&7));var Ke=ae[me>>>3]|ae[(me>>>3)+1]<<8;if(me+=32,Ke>0)for(!be&&$e<we+Ke&&(Se=St(Se,we+Ke),$e=Se.length);Ke-- >0;)Se[we++]=ae[me>>>3],me+=8;continue}for(;;){!be&&$e<we+32767&&(Se=St(Se,we+32767),$e=Se.length);var Qe=ve(ae,me,lt),Et=pe>>>1==1?Ut[Qe]:st[Qe];if(me+=Et&15,Et>>>=4,(Et>>>8&255)===0)Se[we++]=Et;else{if(Et==256)break;Et-=257;var Rt=Et<8?0:Et-4>>2;Rt>5&&(Rt=0);var qt=we+ne[Et];Rt>0&&(qt+=ve(ae,me,Rt),me+=Rt),Qe=ve(ae,me,Xe),Et=pe>>>1==1?Wt[Qe]:Dt[Qe],me+=Et&15,Et>>>=4;var Ot=Et<4?0:Et-2>>1,Mt=se[Et];for(Ot>0&&(Mt+=ve(ae,me,Ot),me+=Ot),!be&&$e<qt&&(Se=St(Se,qt+100),$e=Se.length);we<qt;)Se[we]=Se[we-Mt],++we}}}return be?[Se,me+7>>>3]:[Se.slice(0,we),me+7>>>3]}function Ue(ae,be){var me=ae.slice(ae.l||0),pe=_e(me,be);return ae.l+=pe[1],pe[0]}function Fe(ae,be){if(ae)typeof console<"u"&&console.error(be);else throw new Error(be)}function gt(ae,be){var me=ae;ys(me,0);var pe=[],Se=[],we={FileIndex:pe,FullPaths:Se};B(we,{root:be.root});for(var $e=me.length-4;(me[$e]!=80||me[$e+1]!=75||me[$e+2]!=5||me[$e+3]!=6)&&$e>=0;)--$e;me.l=$e+4,me.l+=4;var lt=me.read_shift(2);me.l+=6;var Xe=me.read_shift(4);for(me.l=Xe,$e=0;$e<lt;++$e){me.l+=20;var Ke=me.read_shift(4),Qe=me.read_shift(4),Et=me.read_shift(2),Rt=me.read_shift(2),qt=me.read_shift(2);me.l+=8;var Ot=me.read_shift(4),Mt=c(me.slice(me.l+Et,me.l+Et+Rt));me.l+=Et+Rt+qt;var Jt=me.l;me.l=Ot+4,Ht(me,Ke,Qe,we,Mt),me.l=Jt}return we}function Ht(ae,be,me,pe,Se){ae.l+=2;var we=ae.read_shift(2),$e=ae.read_shift(2),lt=l(ae);if(we&8257)throw new Error("Unsupported ZIP encryption");for(var Xe=ae.read_shift(4),Ke=ae.read_shift(4),Qe=ae.read_shift(4),Et=ae.read_shift(2),Rt=ae.read_shift(2),qt="",Ot=0;Ot<Et;++Ot)qt+=String.fromCharCode(ae[ae.l++]);if(Rt){var Mt=c(ae.slice(ae.l,ae.l+Rt));(Mt[21589]||{}).mt&&(lt=Mt[21589].mt),((Se||{})[21589]||{}).mt&&(lt=Se[21589].mt)}ae.l+=Rt;var Jt=ae.slice(ae.l,ae.l+Ke);switch($e){case 8:Jt=F(ae,Qe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+$e)}var oa=!1;we&8&&(Xe=ae.read_shift(4),Xe==134695760&&(Xe=ae.read_shift(4),oa=!0),Ke=ae.read_shift(4),Qe=ae.read_shift(4)),Ke!=be&&Fe(oa,"Bad compressed size: "+be+" != "+Ke),Qe!=me&&Fe(oa,"Bad uncompressed size: "+me+" != "+Qe),Ra(pe,qt,Jt,{unsafe:!0,mt:lt})}function Vt(ae,be){var me=be||{},pe=[],Se=[],we=ft(1),$e=me.compression?8:0,lt=0,Xe=0,Ke=0,Qe=0,Et=0,Rt=ae.FullPaths[0],qt=Rt,Ot=ae.FileIndex[0],Mt=[],Jt=0;for(Xe=1;Xe<ae.FullPaths.length;++Xe)if(qt=ae.FullPaths[Xe].slice(Rt.length),Ot=ae.FileIndex[Xe],!(!Ot.size||!Ot.content||qt=="Sh33tJ5")){var oa=Qe,Mr=ft(qt.length);for(Ke=0;Ke<qt.length;++Ke)Mr.write_shift(1,qt.charCodeAt(Ke)&127);Mr=Mr.slice(0,Mr.l),Mt[Et]=H8.buf(Ot.content,0);var da=Ot.content;$e==8&&(da=I(da)),we=ft(30),we.write_shift(4,67324752),we.write_shift(2,20),we.write_shift(2,lt),we.write_shift(2,$e),Ot.mt?s(we,Ot.mt):we.write_shift(4,0),we.write_shift(-4,Mt[Et]),we.write_shift(4,da.length),we.write_shift(4,Ot.content.length),we.write_shift(2,Mr.length),we.write_shift(2,0),Qe+=we.length,pe.push(we),Qe+=Mr.length,pe.push(Mr),Qe+=da.length,pe.push(da),we=ft(46),we.write_shift(4,33639248),we.write_shift(2,0),we.write_shift(2,20),we.write_shift(2,lt),we.write_shift(2,$e),we.write_shift(4,0),we.write_shift(-4,Mt[Et]),we.write_shift(4,da.length),we.write_shift(4,Ot.content.length),we.write_shift(2,Mr.length),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(4,0),we.write_shift(4,oa),Jt+=we.l,Se.push(we),Jt+=Mr.length,Se.push(Mr),++Et}return we=ft(22),we.write_shift(4,101010256),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(2,Et),we.write_shift(2,Et),we.write_shift(4,Jt),we.write_shift(4,Qe),we.write_shift(2,0),is([is(pe),is(Se),we])}var zt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function kt(ae,be){if(ae.ctype)return ae.ctype;var me=ae.name||"",pe=me.match(/\.([^\.]+)$/);return pe&&zt[pe[1]]||be&&(pe=(me=be).match(/[\.\\]([^\.\\])+$/),pe&&zt[pe[1]])?zt[pe[1]]:"application/octet-stream"}function sr(ae){for(var be=P0(ae),me=[],pe=0;pe<be.length;pe+=76)me.push(be.slice(pe,pe+76));return me.join(`\r
`)+`\r
`}function Pr(ae){var be=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ke){var Qe=Ke.charCodeAt(0).toString(16).toUpperCase();return"="+(Qe.length==1?"0"+Qe:Qe)});be=be.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),be.charAt(0)==`
`&&(be="=0D"+be.slice(1)),be=be.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var me=[],pe=be.split(`\r
`),Se=0;Se<pe.length;++Se){var we=pe[Se];if(we.length==0){me.push("");continue}for(var $e=0;$e<we.length;){var lt=76,Xe=we.slice($e,$e+lt);Xe.charAt(lt-1)=="="?lt--:Xe.charAt(lt-2)=="="?lt-=2:Xe.charAt(lt-3)=="="&&(lt-=3),Xe=we.slice($e,$e+lt),$e+=lt,$e<we.length&&(Xe+="="),me.push(Xe)}}return me.join(`\r
`)}function Nt(ae){for(var be=[],me=0;me<ae.length;++me){for(var pe=ae[me];me<=ae.length&&pe.charAt(pe.length-1)=="=";)pe=pe.slice(0,pe.length-1)+ae[++me];be.push(pe)}for(var Se=0;Se<be.length;++Se)be[Se]=be[Se].replace(/[=][0-9A-Fa-f]{2}/g,function(we){return String.fromCharCode(parseInt(we.slice(1),16))});return Mi(be.join(`\r
`))}function fa(ae,be,me){for(var pe="",Se="",we="",$e,lt=0;lt<10;++lt){var Xe=be[lt];if(!Xe||Xe.match(/^\s*$/))break;var Ke=Xe.match(/^(.*?):\s*([^\s].*)$/);if(Ke)switch(Ke[1].toLowerCase()){case"content-location":pe=Ke[2].trim();break;case"content-type":we=Ke[2].trim();break;case"content-transfer-encoding":Se=Ke[2].trim();break}}switch(++lt,Se.toLowerCase()){case"base64":$e=Mi(qi(be.slice(lt).join("")));break;case"quoted-printable":$e=Nt(be.slice(lt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Se)}var Qe=Ra(ae,pe.slice(me.length),$e,{unsafe:!0});we&&(Qe.ctype=we)}function ir(ae,be){if(te(ae.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var me=be&&be.root||"",pe=(Ir&&Buffer.isBuffer(ae)?ae.toString("binary"):te(ae)).split(`\r
`),Se=0,we="";for(Se=0;Se<pe.length;++Se)if(we=pe[Se],!!/^Content-Location:/i.test(we)&&(we=we.slice(we.indexOf("file")),me||(me=we.slice(0,we.lastIndexOf("/")+1)),we.slice(0,me.length)!=me))for(;me.length>0&&(me=me.slice(0,me.length-1),me=me.slice(0,me.lastIndexOf("/")+1),we.slice(0,me.length)!=me););var $e=(pe[1]||"").match(/boundary="(.*?)"/);if(!$e)throw new Error("MAD cannot find boundary");var lt="--"+($e[1]||""),Xe=[],Ke=[],Qe={FileIndex:Xe,FullPaths:Ke};B(Qe);var Et,Rt=0;for(Se=0;Se<pe.length;++Se){var qt=pe[Se];qt!==lt&&qt!==lt+"--"||(Rt++&&fa(Qe,pe.slice(Et,Se),me),Et=Se)}return Qe}function Ea(ae,be){var me=be||{},pe=me.boundary||"SheetJS";pe="------="+pe;for(var Se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+pe.slice(2)+'"',"","",""],we=ae.FullPaths[0],$e=we,lt=ae.FileIndex[0],Xe=1;Xe<ae.FullPaths.length;++Xe)if($e=ae.FullPaths[Xe].slice(we.length),lt=ae.FileIndex[Xe],!(!lt.size||!lt.content||$e=="Sh33tJ5")){$e=$e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Jt){return"_x"+Jt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Jt){return"_u"+Jt.charCodeAt(0).toString(16)+"_"});for(var Ke=lt.content,Qe=Ir&&Buffer.isBuffer(Ke)?Ke.toString("binary"):te(Ke),Et=0,Rt=Math.min(1024,Qe.length),qt=0,Ot=0;Ot<=Rt;++Ot)(qt=Qe.charCodeAt(Ot))>=32&&qt<128&&++Et;var Mt=Et>=Rt*4/5;Se.push(pe),Se.push("Content-Location: "+(me.root||"file:///C:/SheetJS/")+$e),Se.push("Content-Transfer-Encoding: "+(Mt?"quoted-printable":"base64")),Se.push("Content-Type: "+kt(lt,$e)),Se.push(""),Se.push(Mt?Pr(Qe):sr(Qe))}return Se.push(pe+`--\r
`),Se.join(`\r
`)}function xn(ae){var be={};return B(be,ae),be}function Ra(ae,be,me,pe){var Se=pe&&pe.unsafe;Se||B(ae);var we=!Se&&pr.find(ae,be);if(!we){var $e=ae.FullPaths[0];be.slice(0,$e.length)==$e?$e=be:($e.slice(-1)!="/"&&($e+="/"),$e=($e+be).replace("//","/")),we={name:n(be),type:2},ae.FileIndex.push(we),ae.FullPaths.push($e),Se||pr.utils.cfb_gc(ae)}return we.content=me,we.size=me?me.length:0,pe&&(pe.CLSID&&(we.clsid=pe.CLSID),pe.mt&&(we.mt=pe.mt),pe.ct&&(we.ct=pe.ct)),we}function nn(ae,be){B(ae);var me=pr.find(ae,be);if(me){for(var pe=0;pe<ae.FileIndex.length;++pe)if(ae.FileIndex[pe]==me)return ae.FileIndex.splice(pe,1),ae.FullPaths.splice(pe,1),!0}return!1}function Pt(ae,be,me){B(ae);var pe=pr.find(ae,be);if(pe){for(var Se=0;Se<ae.FileIndex.length;++Se)if(ae.FileIndex[Se]==pe)return ae.FileIndex[Se].name=n(me),ae.FullPaths[Se]=me,!0}return!1}function Zt(ae){L(ae,!0)}return e.find=D,e.read=W,e.parse=m,e.write=fe,e.writeFile=K,e.utils={cfb_new:xn,cfb_add:Ra,cfb_del:nn,cfb_mov:Pt,cfb_gc:Zt,ReadShift:x0,CheckField:WN,prep_blob:ys,bconcat:is,use_zlib:j,_deflateRaw:Ce,_inflateRaw:Ue,consts:J},e})();function $8(t){return typeof t=="string"?_1(t):Array.isArray(t)?g8(t):t}function em(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=_1(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var a=r=="utf8"?El(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,t);if(typeof Blob<"u"){var n=new Blob([$8(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,t);if(typeof saveAs<"u")return saveAs(n,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(t);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=Nu(e)),c.write(e),c.close(),e}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+t)}function W8(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+t)}function vn(t){for(var e=Object.keys(t),r=[],a=0;a<e.length;++a)Object.prototype.hasOwnProperty.call(t,e[a])&&r.push(e[a]);return r}function Nw(t,e){for(var r=[],a=vn(t),n=0;n!==a.length;++n)r[t[a[n]][e]]==null&&(r[t[a[n]][e]]=a[n]);return r}function w1(t){for(var e=[],r=vn(t),a=0;a!==r.length;++a)e[t[r[a]]]=r[a];return e}function S1(t){for(var e=[],r=vn(t),a=0;a!==r.length;++a)e[t[r[a]]]=parseInt(r[a],10);return e}function V8(t){for(var e=[],r=vn(t),a=0;a!==r.length;++a)e[t[r[a]]]==null&&(e[t[r[a]]]=[]),e[t[r[a]]].push(r[a]);return e}var e1=new Date(1899,11,30,0,0,0);function Jn(t,e){var r=t.getTime(),a=e1.getTime()+(t.getTimezoneOffset()-e1.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var NN=new Date,G8=e1.getTime()+(NN.getTimezoneOffset()-e1.getTimezoneOffset())*6e4,jw=NN.getTimezoneOffset();function N1(t){var e=new Date;return e.setTime(t*24*60*60*1e3+G8),e.getTimezoneOffset()!==jw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-jw)*6e4),e}function Y8(t){var e=0,r=0,a=!1,n=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(n[s],10)}return e}var kw=new Date("2017-02-19T19:06:09.000Z"),jN=isNaN(kw.getFullYear())?new Date("2/19/17"):kw,X8=jN.getFullYear()==2017;function Ha(t,e){var r=new Date(t);if(X8)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(jN.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return t.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Sd(t,e){if(Ir&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return El(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return El(fN(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return El(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return El(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var a=[],n=0;n!=t.length;++n)a.push(String.fromCharCode(t[n]));return a.join("")}function $a(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=$a(t[r]));return e}function pn(t,e){for(var r="";r.length<e;)r+=t;return r}function Jo(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,a=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return r=-r,s}),!isNaN(e=Number(a)))?e/r:e}var K8=["january","february","march","april","may","june","july","august","september","october","november","december"];function uh(t){var e=new Date(t),r=new Date(NaN),a=e.getYear(),n=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&K8.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&a!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var J8=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(t||typeof a=="string")return r.split(a);for(var s=r.split(a),l=[s[0]],c=1;c<s.length;++c)l.push(n),l.push(s[c]);return l}})();function kN(t){return t?t.content&&t.type?Sd(t.content,!0):t.data?f0(t.data):t.asNodeBuffer&&Ir?f0(t.asNodeBuffer().toString("binary")):t.asBinary?f0(t.asBinary()):t._data&&t._data.getContent?f0(Sd(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function EN(t){if(!t)return null;if(t.data)return mw(t.data);if(t.asNodeBuffer&&Ir)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?mw(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function Z8(t){return t&&t.name.slice(-4)===".bin"?EN(t):kN(t)}function lo(t,e){for(var r=t.FullPaths||vn(t.files),a=e.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||n==l)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function m2(t,e){var r=lo(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Mn(t,e,r){if(!r)return Z8(m2(t,e));if(!e)return null;try{return Mn(t,e)}catch{return null}}function Ii(t,e,r){if(!r)return kN(m2(t,e));if(!e)return null;try{return Ii(t,e)}catch{return null}}function Q8(t,e,r){return EN(m2(t,e))}function Ew(t){for(var e=t.FullPaths||vn(t.files),r=[],a=0;a<e.length;++a)e[a].slice(-1)!="/"&&r.push(e[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Fr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var a;return Ir?a=wc(r):a=v8(r),pr.utils.cfb_add(t,e,a)}pr.utils.cfb_add(t,e,r)}else t.file(e,r)}function p2(){return pr.utils.cfb_new()}function AN(t,e){switch(e.type){case"base64":return pr.read(t,{type:"base64"});case"binary":return pr.read(t,{type:"binary"});case"buffer":case"array":return pr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function m0(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var a=t.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Tn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,eO=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Aw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tO=/<[^>]*>/g,Is=Tn.match(Aw)?Aw:tO,rO=/<\w*:/,aO=/<(\/?)\w+:/;function Nr(t,e,r){for(var a={},n=0,s=0;n!==t.length&&!((s=t.charCodeAt(n))===32||s===10||s===13);++n);if(e||(a[0]=t.slice(0,n)),n===t.length)return a;var l=t.match(eO),c=0,d="",f=0,m="",v="",x=1;if(l)for(f=0;f!=l.length;++f){for(v=l[f],s=0;s!=v.length&&v.charCodeAt(s)!==61;++s);for(m=v.slice(0,s).trim();v.charCodeAt(s+1)==32;)++s;for(x=(n=v.charCodeAt(s+1))==34||n==39?1:0,d=v.slice(s+1+x,v.length-x),c=0;c!=m.length&&m.charCodeAt(c)!==58;++c);if(c===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),a[m]=d,a[m.toLowerCase()]=d;else{var g=(c===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(c+1);if(a[g]&&m.slice(c-3,c)=="ext")continue;a[g]=d,a[g.toLowerCase()]=d}}return a}function Cl(t){return t.replace(aO,"<$1")}var CN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},g2=w1(CN),ra=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(t,function(c,d){return CN[c]||String.fromCharCode(parseInt(d,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,d){return String.fromCharCode(parseInt(d,16))});var l=n.indexOf("]]>");return r(n.slice(0,s))+n.slice(s+9,l)+r(n.slice(l+3))}})(),v2=/[&<>'"]/g,nO=/[\u0000-\u0008\u000b-\u001f]/g;function ya(t){var e=t+"";return e.replace(v2,function(r){return g2[r]}).replace(nO,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Cw(t){return ya(t).replace(/ /g,"_x0020_")}var TN=/[\u0000-\u001f]/g;function x2(t){var e=t+"";return e.replace(v2,function(r){return g2[r]}).replace(/\n/g,"<br/>").replace(TN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function sO(t){var e=t+"";return e.replace(v2,function(r){return g2[r]}).replace(TN,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Tw=(function(){var t=/&#(\d+);/g;function e(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(t,e)}})();function iO(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function qa(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function cv(t){for(var e="",r=0,a=0,n=0,s=0,l=0,c=0;r<t.length;){if(a=t.charCodeAt(r++),a<128){e+=String.fromCharCode(a);continue}if(n=t.charCodeAt(r++),a>191&&a<224){l=(a&31)<<6,l|=n&63,e+=String.fromCharCode(l);continue}if(s=t.charCodeAt(r++),a<240){e+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}l=t.charCodeAt(r++),c=((a&7)<<18|(n&63)<<12|(s&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function Ow(t){var e=xu(2*t.length),r,a,n=1,s=0,l=0,c;for(a=0;a<t.length;a+=n)n=1,(c=t.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(t.charCodeAt(a+1)&63),n=2):c<240?(r=(c&15)*4096+(t.charCodeAt(a+1)&63)*64+(t.charCodeAt(a+2)&63),n=3):(n=4,r=(c&7)*262144+(t.charCodeAt(a+1)&63)*4096+(t.charCodeAt(a+2)&63)*64+(t.charCodeAt(a+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(e[s++]=l&255,e[s++]=l>>>8,l=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Rw(t){return wc(t,"binary").toString("utf8")}var mp="foo bar baz",ka=Ir&&(Rw(mp)==cv(mp)&&Rw||Ow(mp)==cv(mp)&&Ow)||cv,El=Ir?function(t){return wc(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,a=0,n=0;r<t.length;)switch(a=t.charCodeAt(r++),!0){case a<128:e.push(String.fromCharCode(a));break;case a<2048:e.push(String.fromCharCode(192+(a>>6))),e.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=t.charCodeAt(r++)-56320+(a<<10),e.push(String.fromCharCode(240+(n>>18&7))),e.push(String.fromCharCode(144+(n>>12&63))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)));break;default:e.push(String.fromCharCode(224+(a>>12))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)))}return e.join("")},I0=(function(){var t={};return function(r,a){var n=r+"|"+(a||"");return t[n]?t[n]:t[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),ON=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<t.length;++n)a=a.replace(t[n][0],t[n][1]);return a}})(),oO=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),lO=/<\/?(?:vt:)?variant>/g,cO=/<(?:vt:)([^>]*)>([\s\S]*)</;function Dw(t,e){var r=Nr(t),a=t.match(oO(r.baseType))||[],n=[];if(a.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(s){var l=s.replace(lO,"").match(cO);l&&n.push({v:ka(l[2]),t:l[1]})}),n}var RN=/(^\s|\s$|\n)/;function _s(t,e){return"<"+t+(e.match(RN)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function B0(t){return vn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Lt(t,e,r){return"<"+t+(r!=null?B0(r):"")+(e!=null?(e.match(RN)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function bx(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function uO(t,e){switch(typeof t){case"string":var r=Lt("vt:lpwstr",ya(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Lt((t|0)==t?"vt:i4":"vt:r8",ya(String(t)));case"boolean":return Lt("vt:bool",t?"true":"false")}if(t instanceof Date)return Lt("vt:filetime",bx(t));throw new Error("Unable to serialize "+t)}function y2(t){if(Ir&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return ka(Nu(d2(t)));throw new Error("Bad input format: expected Buffer or string")}var U0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Kn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Dd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Di={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function dO(t,e){for(var r=1-2*(t[e+7]>>>7),a=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),n=t[e+6]&15,s=5;s>=0;--s)n=n*256+t[e+s];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function fO(t,e,r){var a=(e<0||1/e==-1/0?1:0)<<7,n=0,s=0,l=a?-e:e;isFinite(l)?l==0?n=s=0:(n=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(e)?26985:0);for(var c=0;c<=5;++c,s/=256)t[r+c]=s&255;t[r+6]=(n&15)<<4|s&15,t[r+7]=n>>4|a}var Fw=function(t){for(var e=[],r=10240,a=0;a<t[0].length;++a)if(t[0][a])for(var n=0,s=t[0][a].length;n<s;n+=r)e.push.apply(e,t[0][a].slice(n,n+r));return e},Lw=Ir?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:wc(e)})):Fw(t)}:Fw,Pw=function(t,e,r){for(var a=[],n=e;n<r;n+=2)a.push(String.fromCharCode(dc(t,n)));return a.join("").replace(Ys,"")},_2=Ir?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Ys,""):Pw(t,e,r)}:Pw,Mw=function(t,e,r){for(var a=[],n=e;n<e+r;++n)a.push(("0"+t[n].toString(16)).slice(-2));return a.join("")},DN=Ir?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Mw(t,e,r)}:Mw,Iw=function(t,e,r){for(var a=[],n=e;n<r;n++)a.push(String.fromCharCode(Vf(t,n)));return a.join("")},tm=Ir?function(e,r,a){return Buffer.isBuffer(e)?e.toString("utf8",r,a):Iw(e,r,a)}:Iw,FN=function(t,e){var r=Fi(t,e);return r>0?tm(t,e+4,e+4+r-1):""},LN=FN,PN=function(t,e){var r=Fi(t,e);return r>0?tm(t,e+4,e+4+r-1):""},MN=PN,IN=function(t,e){var r=2*Fi(t,e);return r>0?tm(t,e+4,e+4+r-1):""},BN=IN,UN=function(e,r){var a=Fi(e,r);return a>0?_2(e,r+4,r+4+a):""},qN=UN,zN=function(t,e){var r=Fi(t,e);return r>0?tm(t,e+4,e+4+r):""},HN=zN,$N=function(t,e){return dO(t,e)},t1=$N,b2=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ir&&(LN=function(e,r){if(!Buffer.isBuffer(e))return FN(e,r);var a=e.readUInt32LE(r);return a>0?e.toString("utf8",r+4,r+4+a-1):""},MN=function(e,r){if(!Buffer.isBuffer(e))return PN(e,r);var a=e.readUInt32LE(r);return a>0?e.toString("utf8",r+4,r+4+a-1):""},BN=function(e,r){if(!Buffer.isBuffer(e))return IN(e,r);var a=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+a-1)},qN=function(e,r){if(!Buffer.isBuffer(e))return UN(e,r);var a=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+a)},HN=function(e,r){if(!Buffer.isBuffer(e))return zN(e,r);var a=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+a)},t1=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):$N(e,r)},b2=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Vf=function(t,e){return t[e]},dc=function(t,e){return t[e+1]*256+t[e]},hO=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Fi=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},dd=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},mO=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function x0(t,e){var r="",a,n,s=[],l,c,d,f;switch(e){case"dbcs":if(f=this.l,Ir&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(d=0;d<t;++d)r+=String.fromCharCode(dc(this,f)),f+=2;t*=2;break;case"utf8":r=tm(this,this.l,this.l+t);break;case"utf16le":t*=2,r=_2(this,this.l,this.l+t);break;case"wstr":return x0.call(this,t,"dbcs");case"lpstr-ansi":r=LN(this,this.l),t=4+Fi(this,this.l);break;case"lpstr-cp":r=MN(this,this.l),t=4+Fi(this,this.l);break;case"lpwstr":r=BN(this,this.l),t=4+2*Fi(this,this.l);break;case"lpp4":t=4+Fi(this,this.l),r=qN(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Fi(this,this.l),r=HN(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(l=Vf(this,this.l+t++))!==0;)s.push(hp(l));r=s.join("");break;case"_wstr":for(t=0,r="";(l=dc(this,this.l+t))!==0;)s.push(hp(l)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",f=this.l,d=0;d<t;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Vf(this,f),this.l=f+1,c=x0.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(hp(dc(this,f))),f+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,d=0;d!=t;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Vf(this,f),this.l=f+1,c=x0.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(hp(Vf(this,f))),f+=1}r=s.join("");break;default:switch(t){case 1:return a=Vf(this,this.l),this.l++,a;case 2:return a=(e==="i"?hO:dc)(this,this.l),this.l+=2,a;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(a=(t>0?dd:mO)(this,this.l),this.l+=4,a):(n=Fi(this,this.l),this.l+=4,n);case 8:case-8:if(e==="f")return t==8?n=t1(this,this.l):n=t1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;t=8;case 16:r=DN(this,this.l,t);break}}return this.l+=t,r}var pO=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},gO=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},vO=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function xO(t,e,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=e.length;++n)vO(this,e.charCodeAt(n),this.l+2*n);a=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=e.length;++n)this[this.l+n]=e.charCodeAt(n)&255;a=e.length}else if(r==="hex"){for(;n<t;++n)this[this.l++]=parseInt(e.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(n=0;n<Math.min(e.length,t);++n){var l=e.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:a=1,this[this.l]=e&255;break;case 2:a=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:a=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:a=4,pO(this,e,this.l);break;case 8:if(a=8,r==="f"){fO(this,e,this.l);break}case 16:break;case-4:a=4,gO(this,e,this.l);break}return this.l+=a,this}function WN(t,e){var r=DN(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ys(t,e){t.l=e,t.read_shift=x0,t.chk=WN,t.write_shift=xO}function Ms(t,e){t.l+=e}function ft(t){var e=xu(t);return ys(e,0),e}function Sc(t,e,r){if(t){var a,n,s;ys(t,t.l||0);for(var l=t.length,c=0,d=0;t.l<l;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var f=V0[c]||V0[65535];for(a=t.read_shift(1),s=a&127,n=1;n<4&&a&128;++n)s+=((a=t.read_shift(1))&127)<<7*n;d=t.l+s;var m=f.f&&f.f(t,s,r);if(t.l=d,e(m,f,c))return}}}function hi(){var t=[],e=Ir?256:2048,r=function(f){var m=ft(f);return ys(m,0),m},a=r(e),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&t.push(a),a=null)},s=function(f){return a&&f<a.length-a.l?a:(n(),a=r(Math.max(f+1,e)))},l=function(){return n(),is(t)},c=function(f){n(),a=f,a.l==null&&(a.l=a.length),s(e)};return{next:s,push:c,end:l,_bufs:t}}function bt(t,e,r,a){var n=+e,s;if(!isNaN(n)){a||(a=V0[n].p||(r||[]).length||0),s=1+(n>=128?1:0)+1,a>=128&&++s,a>=16384&&++s,a>=2097152&&++s;var l=t.next(s);n<=127?l.write_shift(1,n):(l.write_shift(1,(n&127)+128),l.write_shift(1,n>>7));for(var c=0;c!=4;++c)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&b2(r)&&t.push(r)}}function y0(t,e,r){var a=$a(t);if(e.s?(a.cRel&&(a.c+=e.s.c),a.rRel&&(a.r+=e.s.r)):(a.cRel&&(a.c+=e.c),a.rRel&&(a.r+=e.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Bw(t,e,r){var a=$a(t);return a.s=y0(a.s,e.s,r),a.e=y0(a.e,e.s,r),a}function _0(t,e){if(t.cRel&&t.c<0)for(t=$a(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=$a(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Sr(t);return!t.cRel&&t.cRel!=null&&(r=bO(r)),!t.rRel&&t.rRel!=null&&(r=yO(r)),r}function uv(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+rn(t.s.c)+":"+(t.e.cRel?"":"$")+rn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Cn(t.s.r)+":"+(t.e.rRel?"":"$")+Cn(t.e.r):_0(t.s,e.biff)+":"+_0(t.e,e.biff)}function w2(t){return parseInt(_O(t),10)-1}function Cn(t){return""+(t+1)}function yO(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function _O(t){return t.replace(/\$(\d+)$/,"$1")}function S2(t){for(var e=wO(t),r=0,a=0;a!==e.length;++a)r=26*r+e.charCodeAt(a)-64;return r-1}function rn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function bO(t){return t.replace(/^([A-Z])/,"$$$1")}function wO(t){return t.replace(/^\$([A-Z])/,"$1")}function SO(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function an(t){for(var e=0,r=0,a=0;a<t.length;++a){var n=t.charCodeAt(a);n>=48&&n<=57?e=10*e+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:e-1}}function Sr(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function mi(t){var e=t.indexOf(":");return e==-1?{s:an(t),e:an(t)}:{s:an(t.slice(0,e)),e:an(t.slice(e+1))}}function Rr(t,e){return typeof e>"u"||typeof e=="number"?Rr(t.s,t.e):(typeof t!="string"&&(t=Sr(t)),typeof e!="string"&&(e=Sr(e)),t==e?t:t+":"+e)}function aa(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=t.length;for(r=0;a<s&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(e.s.c=--r,r=0;a<s&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(e.s.r=--r,a===s||n!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++a,r=0;a!=s&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(e.e.c=--r,r=0;a!=s&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return e.e.r=--r,e}function Uw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=mo(t.z,r?Jn(e):e)}catch{}try{return t.w=mo((t.XF||{}).numFmtId||(r?14:0),r?Jn(e):e)}catch{return""+e}}function vc(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Nc[t.v]||t.v:e==null?Uw(t,t.v):Uw(t,e))}function ju(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",a={};return a[r]=t,{SheetNames:[r],Sheets:a}}function VN(t,e,r){var a=r||{},n=t?Array.isArray(t):a.dense,s=t||(n?[]:{}),l=0,c=0;if(s&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var d=typeof a.origin=="string"?an(a.origin):a.origin;l=d.r,c=d.c}s["!ref"]||(s["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var m=aa(s["!ref"]);f.s.c=m.s.c,f.s.r=m.s.r,f.e.c=Math.max(f.e.c,m.e.c),f.e.r=Math.max(f.e.r,m.e.r),l==-1&&(f.e.r=l=m.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[v].length;++x)if(!(typeof e[v][x]>"u")){var g={v:e[v][x]},b=l+v,_=c+x;if(f.s.r>b&&(f.s.r=b),f.s.c>_&&(f.s.c=_),f.e.r<b&&(f.e.r=b),f.e.c<_&&(f.e.c=_),e[v][x]&&typeof e[v][x]=="object"&&!Array.isArray(e[v][x])&&!(e[v][x]instanceof Date))g=e[v][x];else if(Array.isArray(g.v)&&(g.f=e[v][x][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(a.nullError)g.t="e",g.v=0;else if(a.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=a.dateNF||wr[14],a.cellDates?(g.t="d",g.w=mo(g.z,Jn(g.v))):(g.t="n",g.v=Jn(g.v),g.w=mo(g.z,g.v))):g.t="s";if(n)s[b]||(s[b]=[]),s[b][_]&&s[b][_].z&&(g.z=s[b][_].z),s[b][_]=g;else{var w=Sr({c:_,r:b});s[w]&&s[w].z&&(g.z=s[w].z),s[w]=g}}}return f.s.c<1e7&&(s["!ref"]=Rr(f)),s}function _h(t,e){return VN(null,t,e)}function NO(t){return t.read_shift(4,"i")}function Zo(t,e){return e||(e=ft(4)),e.write_shift(4,t),e}function Ps(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function os(t,e){var r=!1;return e==null&&(r=!0,e=ft(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function jO(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function kO(t,e){return e||(e=ft(4)),e.write_shift(2,0),e.write_shift(2,0),e}function N2(t,e){var r=t.l,a=t.read_shift(1),n=Ps(t),s=[],l={t:n,h:n};if((a&1)!==0){for(var c=t.read_shift(4),d=0;d!=c;++d)s.push(jO(t));l.r=s}else l.r=[{ich:0,ifnt:0}];return t.l=r+e,l}function EO(t,e){var r=!1;return e==null&&(r=!0,e=ft(15+4*t.t.length)),e.write_shift(1,0),os(t.t,e),r?e.slice(0,e.l):e}var AO=N2;function CO(t,e){var r=!1;return e==null&&(r=!0,e=ft(23+4*t.t.length)),e.write_shift(1,1),os(t.t,e),e.write_shift(4,1),kO({},e),r?e.slice(0,e.l):e}function go(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Fd(t,e){return e==null&&(e=ft(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Ld(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Pd(t,e){return e==null&&(e=ft(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var TO=Ps,GN=os;function j2(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function r1(t,e){var r=!1;return e==null&&(r=!0,e=ft(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var OO=Ps,wx=j2,k2=r1;function E2(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,a=e[0]&2;t.l+=4;var n=a===0?t1([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):dd(e,0)>>2;return r?n/100:n}function YN(t,e){e==null&&(e=ft(4));var r=0,a=0,n=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)e.write_shift(-4,((r?n:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function XN(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function RO(t,e){return e||(e=ft(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Md=XN,bh=RO;function Ls(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Nd(t,e){return(e||ft(8)).write_shift(8,t,"f")}function DO(t){var e={},r=t.read_shift(1),a=r>>>1,n=t.read_shift(1),s=t.read_shift(2,"i"),l=t.read_shift(1),c=t.read_shift(1),d=t.read_shift(1);switch(t.l++,a){case 0:e.auto=1;break;case 1:e.index=n;var f=vd[n];f&&(e.rgb=z0(f));break;case 2:e.rgb=z0([l,c,d]);break;case 3:e.theme=n;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function a1(t,e){if(e||(e=ft(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var a=t.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),e.write_shift(1,parseInt(a.slice(0,2),16)),e.write_shift(1,parseInt(a.slice(2,4),16)),e.write_shift(1,parseInt(a.slice(4,6),16)),e.write_shift(1,255)}return e}function FO(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function LO(t,e){e||(e=ft(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function KN(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=t.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function PO(t){return KN(t,1)}function MO(t){return KN(t,2)}var A2=2,fi=3,pp=11,qw=12,n1=19,gp=64,IO=65,BO=71,UO=4108,qO=4126,ns=80,JN=81,zO=[ns,JN],Sx={1:{n:"CodePage",t:A2},2:{n:"Category",t:ns},3:{n:"PresentationFormat",t:ns},4:{n:"ByteCount",t:fi},5:{n:"LineCount",t:fi},6:{n:"ParagraphCount",t:fi},7:{n:"SlideCount",t:fi},8:{n:"NoteCount",t:fi},9:{n:"HiddenCount",t:fi},10:{n:"MultimediaClipCount",t:fi},11:{n:"ScaleCrop",t:pp},12:{n:"HeadingPairs",t:UO},13:{n:"TitlesOfParts",t:qO},14:{n:"Manager",t:ns},15:{n:"Company",t:ns},16:{n:"LinksUpToDate",t:pp},17:{n:"CharacterCount",t:fi},19:{n:"SharedDoc",t:pp},22:{n:"HyperlinksChanged",t:pp},23:{n:"AppVersion",t:fi,p:"version"},24:{n:"DigSig",t:IO},26:{n:"ContentType",t:ns},27:{n:"ContentStatus",t:ns},28:{n:"Language",t:ns},29:{n:"Version",t:ns},255:{},2147483648:{n:"Locale",t:n1},2147483651:{n:"Behavior",t:n1},1919054434:{}},Nx={1:{n:"CodePage",t:A2},2:{n:"Title",t:ns},3:{n:"Subject",t:ns},4:{n:"Author",t:ns},5:{n:"Keywords",t:ns},6:{n:"Comments",t:ns},7:{n:"Template",t:ns},8:{n:"LastAuthor",t:ns},9:{n:"RevNumber",t:ns},10:{n:"EditTime",t:gp},11:{n:"LastPrinted",t:gp},12:{n:"CreatedDate",t:gp},13:{n:"ModifiedDate",t:gp},14:{n:"PageCount",t:fi},15:{n:"WordCount",t:fi},16:{n:"CharCount",t:fi},17:{n:"Thumbnail",t:BO},18:{n:"Application",t:ns},19:{n:"DocSecurity",t:fi},255:{},2147483648:{n:"Locale",t:n1},2147483651:{n:"Behavior",t:n1},1919054434:{}},zw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},HO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function $O(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var WO=$O([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),vd=$a(WO),Nc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ZN={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},jx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},vp={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function C2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function VO(t){var e=C2();if(!t||!t.match)return e;var r={};if((t.match(Is)||[]).forEach(function(a){var n=Nr(a);switch(n[0].replace(rO,"<")){case"<?xml":break;case"<Types":e.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":e[jx[n.ContentType]]!==void 0&&e[jx[n.ContentType]].push(n.PartName);break}}),e.xmlns!==Kn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function QN(t,e){var r=V8(jx),a=[],n;a[a.length]=Tn,a[a.length]=Lt("Types",null,{xmlns:Kn.CT,"xmlns:xsd":Kn.xsd,"xmlns:xsi":Kn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Lt("Default",null,{Extension:d[0],ContentType:d[1]})}));var s=function(d){t[d]&&t[d].length>0&&(n=t[d][0],a[a.length]=Lt("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:vp[d][e.bookType]||vp[d].xlsx}))},l=function(d){(t[d]||[]).forEach(function(f){a[a.length]=Lt("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:vp[d][e.bookType]||vp[d].xlsx})})},c=function(d){(t[d]||[]).forEach(function(f){a[a.length]=Lt("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[d][0]})})};return s("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Ur={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function q0(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function b0(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var a={};return(t.match(Is)||[]).forEach(function(n){var s=Nr(n);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:m0(s.Target,e);r[c]=l,a[s.Id]=l}}),r["!id"]=a,r}function th(t){var e=[Tn,Lt("Relationships",null,{xmlns:Kn.RELS})];return vn(t["!id"]).forEach(function(r){e[e.length]=Lt("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function va(t,e,r,a,n,s){if(n||(n={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,n.Id="rId"+e,n.Type=a,n.Target=r,[Ur.HLINK,Ur.XPATH,Ur.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),t["!id"][n.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][n.Id]=n,t[("/"+n.Target).replace("//","/")]=n,e}var GO="application/vnd.oasis.opendocument.spreadsheet";function YO(t,e){for(var r=y2(t),a,n;a=U0.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=Nr(a[0],!1),n.path=="/"&&n.type!==GO)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw a}}function XO(t){var e=[Tn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Hw(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function KO(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function JO(t){var e=[Tn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Hw(t[r][0],t[r][1])),e.push(KO("",t[r][0]));return e.push(Hw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function e3(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Kp.version+"</meta:generator></office:meta></office:document-meta>"}var fo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ZO=(function(){for(var t=new Array(fo.length),e=0;e<fo.length;++e){var r=fo[e],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return t})();function t3(t){var e={};t=ka(t);for(var r=0;r<fo.length;++r){var a=fo[r],n=t.match(ZO[r]);n!=null&&n.length>0&&(e[a[1]]=ra(n[1])),a[2]==="date"&&e[a[1]]&&(e[a[1]]=Ha(e[a[1]]))}return e}function dv(t,e,r,a,n){n[t]!=null||e==null||e===""||(n[t]=e,e=ya(e),a[a.length]=r?Lt(t,e,r):_s(t,e))}function r3(t,e){var r=e||{},a=[Tn,Lt("cp:coreProperties",null,{"xmlns:cp":Kn.CORE_PROPS,"xmlns:dc":Kn.dc,"xmlns:dcterms":Kn.dcterms,"xmlns:dcmitype":Kn.dcmitype,"xmlns:xsi":Kn.xsi})],n={};if(!t&&!r.Props)return a.join("");t&&(t.CreatedDate!=null&&dv("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:bx(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),t.ModifiedDate!=null&&dv("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:bx(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var s=0;s!=fo.length;++s){var l=fo[s],c=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:t?t[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&dv(l[0],c,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var xd=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],a3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function n3(t,e,r,a){var n=[];if(typeof t=="string")n=Dw(t,a);else for(var s=0;s<t.length;++s)n=n.concat(t[s].map(function(m){return{v:m}}));var l=typeof e=="string"?Dw(e,a).map(function(m){return m.v}):e,c=0,d=0;if(l.length>0)for(var f=0;f!==n.length;f+=2){switch(d=+n[f+1].v,n[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=d,r.SheetNames=l.slice(c,c+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=d,r.DefinedNames=l.slice(c,c+d);break;case"Charts":case"Diagramme":r.Chartsheets=d,r.ChartNames=l.slice(c,c+d);break}c+=d}}function QO(t,e,r){var a={};return e||(e={}),t=ka(t),xd.forEach(function(n){var s=(t.match(I0(n[0]))||[])[1];switch(n[2]){case"string":s&&(e[n[1]]=ra(s));break;case"bool":e[n[1]]=s==="true";break;case"raw":var l=t.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(a[n[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&n3(a.HeadingPairs,a.TitlesOfParts,e,r),e}function s3(t){var e=[],r=Lt;return t||(t={}),t.Application="SheetJS",e[e.length]=Tn,e[e.length]=Lt("Properties",null,{xmlns:Kn.EXT_PROPS,"xmlns:vt":Kn.vt}),xd.forEach(function(a){if(t[a[1]]!==void 0){var n;switch(a[2]){case"string":n=ya(String(t[a[1]]));break;case"bool":n=t[a[1]]?"true":"false";break}n!==void 0&&(e[e.length]=r(a[0],n))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(a){return"<vt:lpstr>"+ya(a)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var e7=/<[^>]+>[^<]*/g;function t7(t,e){var r={},a="",n=t.match(e7);if(n)for(var s=0;s!=n.length;++s){var l=n[s],c=Nr(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=ra(c.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var d=l.split(">"),f=d[0].slice(4),m=d[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[a]=ra(m);break;case"bool":r[a]=qa(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(m);break;case"filetime":case"date":r[a]=Ha(m);break;case"cy":case"error":r[a]=ra(m);break;default:if(f.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,f,d)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return r}function i3(t){var e=[Tn,Lt("Properties",null,{xmlns:Kn.CUST_PROPS,"xmlns:vt":Kn.vt})];if(!t)return e.join("");var r=1;return vn(t).forEach(function(n){++r,e[e.length]=Lt("property",uO(t[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ya(n)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var kx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},fv;function r7(t,e,r){fv||(fv=w1(kx)),e=fv[e]||e,t[e]=r}function a7(t,e){var r=[];return vn(kx).map(function(a){for(var n=0;n<fo.length;++n)if(fo[n][1]==a)return fo[n];for(n=0;n<xd.length;++n)if(xd[n][1]==a)return xd[n];throw a}).forEach(function(a){if(t[a[1]]!=null){var n=e&&e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:t[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(_s(kx[a[1]]||a[1],n))}}),Lt("DocumentProperties",r.join(""),{xmlns:Di.o})}function n7(t,e){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return t&&vn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var l=0;l<fo.length;++l)if(s==fo[l][1])return;for(l=0;l<xd.length;++l)if(s==xd[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var c=t[s],d="string";typeof c=="number"?(d="float",c=String(c)):c===!0||c===!1?(d="boolean",c=c?"1":"0"):c=String(c),n.push(Lt(Cw(s),c,{"dt:dt":d}))}}),e&&vn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),n.push(Lt(Cw(s),l,{"dt:dt":c}))}}),"<"+a+' xmlns="'+Di.o+'">'+n.join("")+"</"+a+">"}function T2(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function s7(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var s=a/Math.pow(2,32)|0;s>0&&(a=a%Math.pow(2,32),n+=s);var l=ft(8);return l.write_shift(4,a),l.write_shift(4,n),l}function o3(t,e,r){var a=t.l,n=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-a&3;)++t.l;return n}function l3(t,e,r){var a=t.read_shift(0,"lpwstr");return a}function c3(t,e,r){return e===31?l3(t):o3(t,e,r)}function Ex(t,e,r){return c3(t,e,r===!1?0:4)}function i7(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return c3(t,e,0)}function o7(t){for(var e=t.read_shift(4),r=[],a=0;a!=e;++a){var n=t.l;r[a]=t.read_shift(0,"lpwstr").replace(Ys,""),t.l-n&2&&(t.l+=2)}return r}function l7(t){for(var e=t.read_shift(4),r=[],a=0;a!=e;++a)r[a]=t.read_shift(0,"lpstr-cp").replace(Ys,"");return r}function c7(t){var e=t.l,r=s1(t,JN);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var a=s1(t,fi);return[r,a]}function u7(t){for(var e=t.read_shift(4),r=[],a=0;a<e/2;++a)r.push(c7(t));return r}function $w(t,e){for(var r=t.read_shift(4),a={},n=0;n!=r;++n){var s=t.read_shift(4),l=t.read_shift(4);a[s]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(Ys,"").replace(h0,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),a}function u3(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function d7(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function s1(t,e,r){var a=t.read_shift(2),n,s=r||{};if(t.l+=2,e!==qw&&a!==e&&zO.indexOf(e)===-1&&!((e&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+e+" saw "+a);switch(e===qw?a:e){case 2:return n=t.read_shift(2,"i"),s.raw||(t.l+=2),n;case 3:return n=t.read_shift(4,"i"),n;case 11:return t.read_shift(4)!==0;case 19:return n=t.read_shift(4),n;case 30:return o3(t,a,4).replace(Ys,"");case 31:return l3(t);case 64:return T2(t);case 65:return u3(t);case 71:return d7(t);case 80:return Ex(t,a,!s.raw).replace(Ys,"");case 81:return i7(t,a).replace(Ys,"");case 4108:return u7(t);case 4126:case 4127:return a==4127?o7(t):l7(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+a)}}function Ww(t,e){var r=ft(4),a=ft(4);switch(r.write_shift(4,t==80?31:t),t){case 3:a.write_shift(-4,e);break;case 5:a=ft(8),a.write_shift(8,e,"f");break;case 11:a.write_shift(4,e?1:0);break;case 64:a=s7(e);break;case 31:case 80:for(a=ft(4+2*(e.length+1)+(e.length%2?0:2)),a.write_shift(4,e.length+1),a.write_shift(0,e,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return is([r,a])}function Vw(t,e){var r=t.l,a=t.read_shift(4),n=t.read_shift(4),s=[],l=0,c=0,d=-1,f={};for(l=0;l!=n;++l){var m=t.read_shift(4),v=t.read_shift(4);s[l]=[m,v+r]}s.sort(function(C,A){return C[1]-A[1]});var x={};for(l=0;l!=n;++l){if(t.l!==s[l][1]){var g=!0;if(l>0&&e)switch(e[s[l-1][0]].t){case 2:t.l+2===s[l][1]&&(t.l+=2,g=!1);break;case 80:t.l<=s[l][1]&&(t.l=s[l][1],g=!1);break;case 4108:t.l<=s[l][1]&&(t.l=s[l][1],g=!1);break}if((!e||l==0)&&t.l<=s[l][1]&&(g=!1,t.l=s[l][1]),g)throw new Error("Read Error: Expected address "+s[l][1]+" at "+t.l+" :"+l)}if(e){var b=e[s[l][0]];if(x[b.n]=s1(t,b.t,{raw:!0}),b.p==="version"&&(x[b.n]=String(x[b.n]>>16)+"."+("0000"+String(x[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(x[b.n]){case 0:x[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Xo(c=x[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[b.n])}}else if(s[l][0]===1){if(c=x.CodePage=s1(t,A2),Xo(c),d!==-1){var _=t.l;t.l=s[d][1],f=$w(t,c),t.l=_}}else if(s[l][0]===0){if(c===0){d=l,t.l=s[l+1][1];continue}f=$w(t,c)}else{var w=f[s[l][0]],E;switch(t[t.l]){case 65:t.l+=4,E=u3(t);break;case 30:t.l+=4,E=Ex(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,E=Ex(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,E=t.read_shift(4,"i");break;case 19:t.l+=4,E=t.read_shift(4);break;case 5:t.l+=4,E=t.read_shift(8,"f");break;case 11:t.l+=4,E=Sn(t,4);break;case 64:t.l+=4,E=Ha(T2(t));break;default:throw new Error("unparsed value: "+t[t.l])}x[w]=E}}return t.l=r+a,x}var d3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function f7(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Gw(t,e,r){var a=ft(8),n=[],s=[],l=8,c=0,d=ft(8),f=ft(8);if(d.write_shift(4,2),d.write_shift(4,1200),f.write_shift(4,1),s.push(d),n.push(f),l+=8+d.length,!e){f=ft(8),f.write_shift(4,0),n.unshift(f);var m=[ft(4)];for(m[0].write_shift(4,t.length),c=0;c<t.length;++c){var v=t[c][0];for(d=ft(8+2*(v.length+1)+(v.length%2?0:2)),d.write_shift(4,c+2),d.write_shift(4,v.length+1),d.write_shift(0,v,"dbcs");d.l!=d.length;)d.write_shift(1,0);m.push(d)}d=is(m),s.unshift(d),l+=8+d.length}for(c=0;c<t.length;++c)if(!(e&&!e[t[c][0]])&&!(d3.indexOf(t[c][0])>-1||a3.indexOf(t[c][0])>-1)&&t[c][1]!=null){var x=t[c][1],g=0;if(e){g=+e[t[c][0]];var b=r[g];if(b.p=="version"&&typeof x=="string"){var _=x.split(".");x=(+_[0]<<16)+(+_[1]||0)}d=Ww(b.t,x)}else{var w=f7(x);w==-1&&(w=31,x=String(x)),d=Ww(w,x)}s.push(d),f=ft(8),f.write_shift(4,e?g:2+c),n.push(f),l+=8+d.length}var E=8*(s.length+1);for(c=0;c<s.length;++c)n[c].write_shift(4,E),E+=s[c].length;return a.write_shift(4,l),a.write_shift(4,s.length),is([a].concat(n).concat(s))}function Yw(t,e,r){var a=t.content;if(!a)return{};ys(a,0);var n,s,l,c,d=0;a.chk("feff","Byte Order: "),a.read_shift(2);var f=a.read_shift(4),m=a.read_shift(16);if(m!==pr.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),c=a.read_shift(4),n===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);n===2&&(l=a.read_shift(16),d=a.read_shift(4));var v=Vw(a,e),x={SystemIdentifier:f};for(var g in v)x[g]=v[g];if(x.FMTID=s,n===1)return x;if(d-a.l==2&&(a.l+=2),a.l!==d)throw new Error("Length mismatch 2: "+a.l+" !== "+d);var b;try{b=Vw(a,null)}catch{}for(g in b)x[g]=b[g];return x.FMTID=[s,l],x}function Xw(t,e,r,a,n,s){var l=ft(n?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,pr.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,n?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,n?68:48);var d=Gw(t,r,a);if(c.push(d),n){var f=Gw(n,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+d.length),c.push(f)}return is(c)}function iu(t,e){return t.read_shift(e),null}function h7(t,e){e||(e=ft(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function m7(t,e,r){for(var a=[],n=t.l+e;t.l<n;)a.push(r(t,n-t.l));if(n!==t.l)throw new Error("Slurp error");return a}function Sn(t,e){return t.read_shift(e)===1}function Gs(t,e){return e||(e=ft(2)),e.write_shift(2,+!!t),e}function In(t){return t.read_shift(2,"u")}function co(t,e){return e||(e=ft(2)),e.write_shift(2,t),e}function f3(t,e){return m7(t,e,In)}function p7(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function h3(t,e,r){return r||(r=ft(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function rm(t,e,r){var a=t.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=a?t.read_shift(a,n):"";return l}function g7(t){var e=t.read_shift(2),r=t.read_shift(1),a=r&4,n=r&8,s=1+(r&1),l=0,c,d={};n&&(l=t.read_shift(2)),a&&(c=t.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",m=e===0?"":t.read_shift(e,f);return n&&(t.l+=4*l),a&&(t.l+=c),d.t=m,n||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function v7(t){var e=t.t||"",r=ft(3);r.write_shift(2,e.length),r.write_shift(1,1);var a=ft(2*e.length);a.write_shift(2*e.length,e,"utf16le");var n=[r,a];return is(n)}function jd(t,e,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var n=t.read_shift(1);return n===0?a=t.read_shift(e,"sbcs-cont"):a=t.read_shift(e,"dbcs-cont"),a}function am(t,e,r){var a=t.read_shift(r&&r.biff==2?1:2);return a===0?(t.l++,""):jd(t,a,r)}function Id(t,e,r){if(r.biff>5)return am(t,e,r);var a=t.read_shift(1);return a===0?(t.l++,""):t.read_shift(a,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function m3(t,e,r){return r||(r=ft(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function x7(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function y7(t){var e=t.read_shift(4),r=t.l,a=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),t.l=r);var n=t.read_shift((a?e-24:e)>>1,"utf16le").replace(Ys,"");return a&&(t.l+=24),n}function _7(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var a=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=t.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(s>>1,"utf16le").replace(Ys,"");return r+l}function b7(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return y7(t);case"0303000000000000c000000000000046":return _7(t);default:throw new Error("Unsupported Moniker "+r)}}function xp(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Ys,""):"";return r}function Kw(t,e){e||(e=ft(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function w7(t,e){var r=t.l+e,a=t.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=t.read_shift(2);t.l+=2;var s,l,c,d,f="",m,v;n&16&&(s=xp(t,r-t.l)),n&128&&(l=xp(t,r-t.l)),(n&257)===257&&(c=xp(t,r-t.l)),(n&257)===1&&(d=b7(t,r-t.l)),n&8&&(f=xp(t,r-t.l)),n&32&&(m=t.read_shift(16)),n&64&&(v=T2(t)),t.l=r;var x=l||c||d||"";x&&f&&(x+="#"+f),x||(x="#"+f),n&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var g={Target:x};return m&&(g.guid=m),v&&(g.time=v),s&&(g.Tooltip=s),g}function S7(t){var e=ft(512),r=0,a=t.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),s=n>-1?31:23;switch(a.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)e.write_shift(4,l[r]);if(s==28)a=a.slice(1),Kw(a,e);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));var c=n>-1?a.slice(0,n):a;for(e.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)e.write_shift(2,c.charCodeAt(r));e.write_shift(2,0),s&8&&Kw(n>-1?a.slice(n+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));for(var d=0;a.slice(d*3,d*3+3)=="../"||a.slice(d*3,d*3+3)=="..\\";)++d;for(e.write_shift(2,d),e.write_shift(4,a.length-3*d+1),r=0;r<a.length-3*d;++r)e.write_shift(1,a.charCodeAt(r+3*d)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function p3(t){var e=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1),n=t.read_shift(1);return[e,r,a,n]}function g3(t,e){var r=p3(t);return r[3]=0,r}function Tl(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{r:e,c:r,ixfe:a}}function kd(t,e,r,a){return a||(a=ft(6)),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(2,r||0),a}function N7(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function j7(t,e,r){return e===0?"":Id(t,e,r)}function k7(t,e,r){var a=r.biff>8?4:2,n=t.read_shift(a),s=t.read_shift(a,"i"),l=t.read_shift(a,"i");return[n,s,l]}function v3(t){var e=t.read_shift(2),r=E2(t);return[e,r]}function E7(t,e,r){t.l+=4,e-=4;var a=t.l+e,n=rm(t,e,r),s=t.read_shift(2);if(a-=t.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return t.l+=s,n}function j1(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2);return{s:{c:a,r:e},e:{c:n,r}}}function x3(t,e){return e||(e=ft(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function y3(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(1),n=t.read_shift(1);return{s:{c:a,r:e},e:{c:n,r}}}var A7=y3;function _3(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return t.l+=12,[r,e,a]}function C7(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function T7(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Es(t){t.l+=2,t.l+=t.read_shift(2)}var O7={0:Es,4:Es,5:Es,6:Es,7:T7,8:Es,9:Es,10:Es,11:Es,12:Es,13:C7,14:Es,15:Es,16:Es,17:Es,18:Es,19:Es,20:Es,21:_3};function R7(t,e){for(var r=t.l+e,a=[];t.l<r;){var n=t.read_shift(2);t.l-=2;try{a.push(O7[n](t,r-t.l))}catch{return t.l=r,a}}return t.l!=r&&(t.l=r),a}function yp(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function O2(t,e,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ft(n);return s.write_shift(2,a),s.write_shift(2,e),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function D7(t,e){return e===0||t.read_shift(2),1200}function F7(t,e,r){if(r.enc)return t.l+=e,"";var a=t.l,n=Id(t,0,r);return t.read_shift(e+a-t.l),n}function L7(t,e){var r=!e||e.biff==8,a=ft(r?112:54);for(a.write_shift(e.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function P7(t,e,r){var a=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function M7(t,e,r){var a=t.read_shift(4),n=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=rm(t,0,r);return l.length===0&&(l="Sheet1"),{pos:a,hs:n,dt:s,name:l}}function I7(t,e){var r=!e||e.biff>=8?2:1,a=ft(8+r*t.name.length);a.write_shift(4,t.pos),a.write_shift(1,t.hs||0),a.write_shift(1,t.dt),a.write_shift(1,t.name.length),e.biff>=8&&a.write_shift(1,1),a.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function B7(t,e){for(var r=t.l+e,a=t.read_shift(4),n=t.read_shift(4),s=[],l=0;l!=n&&t.l<r;++l)s.push(g7(t));return s.Count=a,s.Unique=n,s}function U7(t,e){var r=ft(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var a=[],n=0;n<t.length;++n)a[n]=v7(t[n]);var s=is([r].concat(a));return s.parts=[r.length].concat(a.map(function(l){return l.length})),s}function q7(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function z7(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var a=t.read_shift(1);return t.l+=3,a&7&&(e.level=a&7),a&32&&(e.hidden=!0),a&64&&(e.hpt=r/20),e}function H7(t){var e=N7(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function $7(t){return t.read_shift(2),t.read_shift(4)}function Jw(t,e,r){var a=0;r&&r.biff==2||(a=t.read_shift(2));var n=t.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,n]}function W7(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),d=t.read_shift(2),f=t.read_shift(2);return{Pos:[e,r],Dim:[a,n],Flags:s,CurTab:l,FirstTab:c,Selected:d,TabRatio:f}}function V7(){var t=ft(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function G7(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=t.read_shift(2);return{RTL:a&64}}function Y7(t){var e=ft(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function X7(){}function K7(t,e,r){var a={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return a.name=rm(t,0,r),a}function J7(t,e){var r=t.name||"Arial",a=e&&e.biff==5,n=a?15+r.length:16+2*r.length,s=ft(n);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),s}function Z7(t){var e=Tl(t);return e.isst=t.read_shift(4),e}function Q7(t,e,r,a){var n=ft(10);return kd(t,e,a,n),n.write_shift(4,r),n}function eR(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=t.l+e,n=Tl(t);r.biff==2&&t.l++;var s=am(t,a-t.l,r);return n.val=s,n}function tR(t,e,r,a,n){var s=!n||n.biff==8,l=ft(8+ +s+(1+s)*r.length);return kd(t,e,a,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function rR(t,e,r){var a=t.read_shift(2),n=Id(t,0,r);return[a,n]}function aR(t,e,r,a){var n=r&&r.biff==5;a||(a=ft(n?3+e.length:5+2*e.length)),a.write_shift(2,t),a.write_shift(n?1:2,e.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le");var s=a.length>a.l?a.slice(0,a.l):a;return s.l==null&&(s.l=s.length),s}var nR=Id;function Zw(t,e,r){var a=t.l+e,n=r.biff==8||!r.biff?4:2,s=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2),d=t.read_shift(2);return t.l=a,{s:{r:s,c},e:{r:l,c:d}}}function sR(t,e){var r=e.biff==8||!e.biff?4:2,a=ft(2*r+6);return a.write_shift(r,t.s.r),a.write_shift(r,t.e.r+1),a.write_shift(2,t.s.c),a.write_shift(2,t.e.c+1),a.write_shift(2,0),a}function iR(t){var e=t.read_shift(2),r=t.read_shift(2),a=v3(t);return{r:e,c:r,ixfe:a[0],rknum:a[1]}}function oR(t,e){for(var r=t.l+e-2,a=t.read_shift(2),n=t.read_shift(2),s=[];t.l<r;)s.push(v3(t));if(t.l!==r)throw new Error("MulRK read error");var l=t.read_shift(2);if(s.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:l,rkrec:s}}function lR(t,e){for(var r=t.l+e-2,a=t.read_shift(2),n=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var l=t.read_shift(2);if(s.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:l,ixfe:s}}function cR(t,e,r,a){var n={},s=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(4),d=t.read_shift(2);return n.patternType=HO[c>>26],a.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=c&127,n.icvBottom=c>>7&127,n.icvDiag=c>>14&127,n.dgDiag=c>>21&15,n.icvFore=d&127,n.icvBack=d>>7&127,n.fsxButton=d>>14&1),n}function uR(t,e,r){var a={};return a.ifnt=t.read_shift(2),a.numFmtId=t.read_shift(2),a.flags=t.read_shift(2),a.fStyle=a.flags>>2&1,e-=6,a.data=cR(t,e,a.fStyle,r),a}function Qw(t,e,r,a){var n=r&&r.biff==5;a||(a=ft(n?16:20)),a.write_shift(2,0),t.style?(a.write_shift(2,t.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,t.numFmtId||0),a.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&n&&(s|=1024),a.write_shift(4,s),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function dR(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function fR(t){var e=ft(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function e5(t,e,r){var a=Tl(t);(r.biff==2||e==9)&&++t.l;var n=p7(t);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function hR(t,e,r,a,n,s){var l=ft(8);return kd(t,e,a,l),h3(r,s,l),l}function mR(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Tl(t),n=Ls(t);return a.val=n,a}function pR(t,e,r,a){var n=ft(14);return kd(t,e,a,n),Nd(r,n),n}var t5=j7;function gR(t,e,r){var a=t.l+e,n=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=jd(t,s),c=[];a>t.l;)c.push(am(t));return[s,n,l,c]}function r5(t,e,r){var a=t.read_shift(2),n,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=E7(t,e-2,r)),s.body=n||t.read_shift(e-2),typeof n=="string"&&(s.Name=n),s}var vR=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function a5(t,e,r){var a=t.l+e,n=t.read_shift(2),s=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(r&&r.biff==2?1:2),d=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),d=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var f=jd(t,l,r);n&32&&(f=vR[f.charCodeAt(0)]);var m=a-t.l;r&&r.biff==2&&--m;var v=a==t.l||c===0||!(m>0)?[]:RP(t,m,r,c);return{chKey:s,Name:f,itab:d,rgce:v}}function b3(t,e,r){if(r.biff<8)return xR(t,e,r);for(var a=[],n=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)a.push(k7(t,r.biff>8?12:6,r));if(t.l!=n)throw new Error("Bad ExternSheet: "+t.l+" != "+n);return a}function xR(t,e,r){t[t.l+1]==3&&t[t.l]++;var a=rm(t,e,r);return a.charCodeAt(0)==3?a.slice(1):a}function yR(t,e,r){if(r.biff<8){t.l+=e;return}var a=t.read_shift(2),n=t.read_shift(2),s=jd(t,a,r),l=jd(t,n,r);return[s,l]}function _R(t,e,r){var a=y3(t);t.l++;var n=t.read_shift(1);return e-=8,[DP(t,e,r),n,a]}function n5(t,e,r){var a=A7(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[a,TP(t,e,r)]}function bR(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,a=t.read_shift(4);return[e,r,a]}function wR(t,e,r){if(!(r.biff<8)){var a=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),c=Id(t,0,r);return r.biff<8&&t.read_shift(1),[{r:a,c:n},c,l,s]}}function SR(t,e,r){return wR(t,e,r)}function NR(t,e){for(var r=[],a=t.read_shift(2);a--;)r.push(j1(t));return r}function jR(t){var e=ft(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)x3(t[r],e);return e}function kR(t,e,r){if(r&&r.biff<8)return AR(t,e,r);var a=_3(t),n=R7(t,e-22,a[1]);return{cmo:a,ft:n}}var ER={8:function(t,e){var r=t.l+e;t.l+=10;var a=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var n=t.read_shift(1);return t.l+=n,t.l=r,{fmt:a}}};function AR(t,e,r){t.l+=4;var a=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((ER[a]||Ms)(t,e,r)),{cmo:[n,a,s],ft:l}}function CR(t,e,r){var a=t.l,n="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:l=x7(t,6,r);var c=t.read_shift(2);t.read_shift(2),In(t,2);var d=t.read_shift(2);t.l+=d;for(var f=1;f<t.lens.length-1;++f){if(t.l-a!=t.lens[f])throw new Error("TxO: bad continue record");var m=t[t.l],v=jd(t,t.lens[f+1]-t.lens[f]-1);if(n+=v,n.length>=(m?c:2*c))break}if(n.length!==c&&n.length!==c*2)throw new Error("cchText: "+c+" != "+n.length);return t.l=a+e,{t:n}}catch{return t.l=a+e,{t:n}}}function TR(t,e){var r=j1(t);t.l+=16;var a=w7(t,e-24);return[r,a]}function OR(t){var e=ft(24),r=an(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)e.write_shift(1,parseInt(a[n],16));return is([e,S7(t[1])])}function RR(t,e){t.read_shift(2);var r=j1(t),a=t.read_shift((e-10)/2,"dbcs-cont");return a=a.replace(Ys,""),[r,a]}function DR(t){var e=t[1].Tooltip,r=ft(10+2*(e.length+1));r.write_shift(2,2048);var a=an(t[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<e.length;++n)r.write_shift(2,e.charCodeAt(n));return r.write_shift(2,0),r}function FR(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=zw[r]||r,r=t.read_shift(2),e[1]=zw[r]||r,e}function LR(t){return t||(t=ft(4)),t.write_shift(2,1),t.write_shift(2,1),t}function PR(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(g3(t));return r}function MR(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(g3(t));return r}function IR(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function w3(t,e,r){if(!r.cellStyles)return Ms(t,e);var a=r&&r.biff>=12?4:2,n=t.read_shift(a),s=t.read_shift(a),l=t.read_shift(a),c=t.read_shift(a),d=t.read_shift(2);a==2&&(t.l+=2);var f={s:n,e:s,w:l,ixfe:c,flags:d};return(r.biff>=5||!r.biff)&&(f.level=d>>8&7),f}function BR(t,e){var r=ft(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var a=0;return t.hidden&&(a|=1),r.write_shift(1,a),a=t.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function UR(t,e){var r={};return e<32||(t.l+=16,r.header=Ls(t),r.footer=Ls(t),t.l+=2),r}function qR(t,e,r){var a={area:!1};if(r.biff!=5)return t.l+=e,a;var n=t.read_shift(1);return t.l+=3,n&16&&(a.area=!0),a}function zR(t){for(var e=ft(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var HR=Tl,$R=f3,WR=am;function VR(t){var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n={fmt:e,env:r,len:a,data:t.slice(t.l,t.l+a)};return t.l+=a,n}function GR(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Tl(t);++t.l;var n=Id(t,e-7,r);return a.t="str",a.val=n,a}function YR(t){var e=Tl(t);++t.l;var r=Ls(t);return e.t="n",e.val=r,e}function XR(t,e,r){var a=ft(15);return om(a,t,e),a.write_shift(8,r,"f"),a}function KR(t){var e=Tl(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function JR(t,e,r){var a=ft(9);return om(a,t,e),a.write_shift(2,r),a}function ZR(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function QR(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function eD(t,e,r){var a=t.l+e,n=Tl(t),s=t.read_shift(2),l=jd(t,s,r);return t.l=a,n.t="str",n.val=l,n}var tD=[2,3,48,49,131,139,140,245],Ax=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=w1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,d){var f=[],m=xu(1);switch(d.type){case"base64":m=Mi(qi(c));break;case"binary":m=Mi(c);break;case"buffer":case"array":m=c;break}ys(m,0);var v=m.read_shift(1),x=!!(v&136),g=!1,b=!1;switch(v){case 2:break;case 3:break;case 48:g=!0,x=!0;break;case 49:g=!0,x=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var _=0,w=521;v==2&&(_=m.read_shift(2)),m.l+=3,v!=2&&(_=m.read_shift(4)),_>1048576&&(_=1e6),v!=2&&(w=m.read_shift(2));var E=m.read_shift(2),C=d.codepage||1252;v!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(C=t[m[m.l]]),m.l+=1,m.l+=2),b&&(m.l+=36);for(var A=[],O={},G=Math.min(m.length,v==2?521:w-10-(g?264:0)),W=b?32:11;m.l<G&&m[m.l]!=13;)switch(O={},O.name=L0.utils.decode(C,m.slice(m.l,m.l+W)).replace(/[\u0000\r\n].*$/g,""),m.l+=W,O.type=String.fromCharCode(m.read_shift(1)),v!=2&&!b&&(O.offset=m.read_shift(4)),O.len=m.read_shift(1),v==2&&(O.offset=m.read_shift(2)),O.dec=m.read_shift(1),O.name.length&&A.push(O),v!=2&&(m.l+=b?13:14),O.type){case"B":(!g||O.len!=8)&&d.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(m[m.l]!==13&&(m.l=w-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=w;var B=0,q=0;for(f[0]=[],q=0;q!=A.length;++q)f[0][q]=A[q].name;for(;_-- >0;){if(m[m.l]===42){m.l+=E;continue}for(++m.l,f[++B]=[],q=0,q=0;q!=A.length;++q){var L=m.slice(m.l,m.l+A[q].len);m.l+=A[q].len,ys(L,0);var Z=L0.utils.decode(C,L);switch(A[q].type){case"C":Z.trim().length&&(f[B][q]=Z.replace(/\s+$/,""));break;case"D":Z.length===8?f[B][q]=new Date(+Z.slice(0,4),+Z.slice(4,6)-1,+Z.slice(6,8)):f[B][q]=Z;break;case"F":f[B][q]=parseFloat(Z.trim());break;case"+":case"I":f[B][q]=b?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(Z.trim().toUpperCase()){case"Y":case"T":f[B][q]=!0;break;case"N":case"F":f[B][q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Z+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));f[B][q]="##MEMO##"+(b?parseInt(Z.trim(),10):L.read_shift(4));break;case"N":Z=Z.replace(/\u0000/g,"").trim(),Z&&Z!="."&&(f[B][q]=+Z||0);break;case"@":f[B][q]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":f[B][q]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":f[B][q]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[B][q]=-L.read_shift(-8,"f");break;case"B":if(g&&A[q].len==8){f[B][q]=L.read_shift(8,"f");break}case"G":case"P":L.l+=A[q].len;break;case"0":if(A[q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[q].type)}}}if(v!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return d&&d.sheetRows&&(f=f.slice(0,d.sheetRows)),d.DBF=A,f}function a(c,d){var f=d||{};f.dateNF||(f.dateNF="yyyymmdd");var m=_h(r(c,f),f);return m["!cols"]=f.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete f.DBF,m}function n(c,d){try{return ju(a(c,d),d)}catch(f){if(d&&d.WTF)throw f}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,d){var f=d||{};if(+f.codepage>=0&&Xo(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var m=hi(),v=l1(c,{header:1,raw:!0,cellDates:!0}),x=v[0],g=v.slice(1),b=c["!cols"]||[],_=0,w=0,E=0,C=1;for(_=0;_<x.length;++_){if(((b[_]||{}).DBF||{}).name){x[_]=b[_].DBF.name,++E;continue}if(x[_]!=null){if(++E,typeof x[_]=="number"&&(x[_]=x[_].toString(10)),typeof x[_]!="string")throw new Error("DBF Invalid column name "+x[_]+" |"+typeof x[_]+"|");if(x.indexOf(x[_])!==_){for(w=0;w<1024;++w)if(x.indexOf(x[_]+"_"+w)==-1){x[_]+="_"+w;break}}}}var A=aa(c["!ref"]),O=[],G=[],W=[];for(_=0;_<=A.e.c-A.s.c;++_){var B="",q="",L=0,Z=[];for(w=0;w<g.length;++w)g[w][_]!=null&&Z.push(g[w][_]);if(Z.length==0||x[_]==null){O[_]="?";continue}for(w=0;w<Z.length;++w){switch(typeof Z[w]){case"number":q="B";break;case"string":q="C";break;case"boolean":q="L";break;case"object":q=Z[w]instanceof Date?"D":"C";break;default:q="C"}L=Math.max(L,String(Z[w]).length),B=B&&B!=q?"C":q}L>250&&(L=250),q=((b[_]||{}).DBF||{}).type,q=="C"&&b[_].DBF.len>L&&(L=b[_].DBF.len),B=="B"&&q=="N"&&(B="N",W[_]=b[_].DBF.dec,L=b[_].DBF.len),G[_]=B=="C"||q=="N"?L:s[B]||0,C+=G[_],O[_]=B}var D=m.next(32);for(D.write_shift(4,318902576),D.write_shift(4,g.length),D.write_shift(2,296+32*E),D.write_shift(2,C),_=0;_<4;++_)D.write_shift(4,0);for(D.write_shift(4,0|(+e[dN]||3)<<8),_=0,w=0;_<x.length;++_)if(x[_]!=null){var T=m.next(32),M=(x[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,M,"sbcs"),T.write_shift(1,O[_]=="?"?"C":O[_],"sbcs"),T.write_shift(4,w),T.write_shift(1,G[_]||s[O[_]]||0),T.write_shift(1,W[_]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),w+=G[_]||s[O[_]]||0}var V=m.next(264);for(V.write_shift(4,13),_=0;_<65;++_)V.write_shift(4,0);for(_=0;_<g.length;++_){var ie=m.next(C);for(ie.write_shift(1,0),w=0;w<x.length;++w)if(x[w]!=null)switch(O[w]){case"L":ie.write_shift(1,g[_][w]==null?63:g[_][w]?84:70);break;case"B":ie.write_shift(8,g[_][w]||0,"f");break;case"N":var X="0";for(typeof g[_][w]=="number"&&(X=g[_][w].toFixed(W[w]||0)),E=0;E<G[w]-X.length;++E)ie.write_shift(1,32);ie.write_shift(1,X,"sbcs");break;case"D":g[_][w]?(ie.write_shift(4,("0000"+g[_][w].getFullYear()).slice(-4),"sbcs"),ie.write_shift(2,("00"+(g[_][w].getMonth()+1)).slice(-2),"sbcs"),ie.write_shift(2,("00"+g[_][w].getDate()).slice(-2),"sbcs")):ie.write_shift(8,"00000000","sbcs");break;case"C":var J=String(g[_][w]!=null?g[_][w]:"").slice(0,G[w]);for(ie.write_shift(1,J,"sbcs"),E=0;E<G[w]-J.length;++E)ie.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:n,to_sheet:a,from_sheet:l}})(),S3=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+vn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,g){var b=t[g];return typeof b=="number"?pw(b):b},a=function(x,g,b){var _=g.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return _==59?x:pw(_)};t["|"]=254;function n(x,g){switch(g.type){case"base64":return s(qi(x),g);case"binary":return s(x,g);case"buffer":return s(Ir&&Buffer.isBuffer(x)?x.toString("binary"):Nu(x),g);case"array":return s(Sd(x),g)}throw new Error("Unrecognized type "+g.type)}function s(x,g){var b=x.split(/[\n\r]+/),_=-1,w=-1,E=0,C=0,A=[],O=[],G=null,W={},B=[],q=[],L=[],Z=0,D;for(+g.codepage>=0&&Xo(+g.codepage);E!==b.length;++E){Z=0;var T=b[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(e,r),M=T.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),V=M[0],ie;if(T.length>0)switch(V){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&O.push(T.slice(3).replace(/;;/g,";"));break;case"C":var X=!1,J=!1,K=!1,te=!1,fe=-1,U=-1;for(C=1;C<M.length;++C)switch(M[C].charAt(0)){case"A":break;case"X":w=parseInt(M[C].slice(1))-1,J=!0;break;case"Y":for(_=parseInt(M[C].slice(1))-1,J||(w=0),D=A.length;D<=_;++D)A[D]=[];break;case"K":ie=M[C].slice(1),ie.charAt(0)==='"'?ie=ie.slice(1,ie.length-1):ie==="TRUE"?ie=!0:ie==="FALSE"?ie=!1:isNaN(Jo(ie))?isNaN(uh(ie).getDate())||(ie=Ha(ie)):(ie=Jo(ie),G!==null&&xh(G)&&(ie=N1(ie))),X=!0;break;case"E":te=!0;var j=rh(M[C].slice(1),{r:_,c:w});A[_][w]=[A[_][w],j];break;case"S":K=!0,A[_][w]=[A[_][w],"S5S"];break;case"G":break;case"R":fe=parseInt(M[C].slice(1))-1;break;case"C":U=parseInt(M[C].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+T)}if(X&&(A[_][w]&&A[_][w].length==2?A[_][w][0]=ie:A[_][w]=ie,G=null),K){if(te)throw new Error("SYLK shared formula cannot have own formula");var F=fe>-1&&A[fe][U];if(!F||!F[1])throw new Error("SYLK shared formula cannot find base");A[_][w][1]=q3(F[1],{r:_-fe,c:w-U})}break;case"F":var I=0;for(C=1;C<M.length;++C)switch(M[C].charAt(0)){case"X":w=parseInt(M[C].slice(1))-1,++I;break;case"Y":for(_=parseInt(M[C].slice(1))-1,D=A.length;D<=_;++D)A[D]=[];break;case"M":Z=parseInt(M[C].slice(1))/20;break;case"F":break;case"G":break;case"P":G=O[parseInt(M[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=M[C].slice(1).split(" "),D=parseInt(L[0],10);D<=parseInt(L[1],10);++D)Z=parseInt(L[2],10),q[D-1]=Z===0?{hidden:!0}:{wch:Z},yu(q[D-1]);break;case"C":w=parseInt(M[C].slice(1))-1,q[w]||(q[w]={});break;case"R":_=parseInt(M[C].slice(1))-1,B[_]||(B[_]={}),Z>0?(B[_].hpt=Z,B[_].hpx=fh(Z)):Z===0&&(B[_].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+T)}I<1&&(G=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+T)}}return B.length>0&&(W["!rows"]=B),q.length>0&&(W["!cols"]=q),g&&g.sheetRows&&(A=A.slice(0,g.sheetRows)),[A,W]}function l(x,g){var b=n(x,g),_=b[0],w=b[1],E=_h(_,g);return vn(w).forEach(function(C){E[C]=w[C]}),E}function c(x,g){return ju(l(x,g),g)}function d(x,g,b,_){var w="C;Y"+(b+1)+";X"+(_+1)+";K";switch(x.t){case"n":w+=x.v||0,x.f&&!x.F&&(w+=";E"+M2(x.f,{r:b,c:_}));break;case"b":w+=x.v?"TRUE":"FALSE";break;case"e":w+=x.w||x.v;break;case"d":w+='"'+(x.w||x.v)+'"';break;case"s":w+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function f(x,g){g.forEach(function(b,_){var w="F;W"+(_+1)+" "+(_+1)+" ";b.hidden?w+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=H0(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=$0(b.wpx)),typeof b.wch=="number"&&(w+=Math.round(b.wch))),w.charAt(w.length-1)!=" "&&x.push(w)})}function m(x,g){g.forEach(function(b,_){var w="F;";b.hidden?w+="M0;":b.hpt?w+="M"+20*b.hpt+";":b.hpx&&(w+="M"+20*W0(b.hpx)+";"),w.length>2&&x.push(w+"R"+(_+1))})}function v(x,g){var b=["ID;PWXL;N;E"],_=[],w=aa(x["!ref"]),E,C=Array.isArray(x),A=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),x["!cols"]&&f(b,x["!cols"]),x["!rows"]&&m(b,x["!rows"]),b.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var O=w.s.r;O<=w.e.r;++O)for(var G=w.s.c;G<=w.e.c;++G){var W=Sr({r:O,c:G});E=C?(x[O]||[])[G]:x[W],!(!E||E.v==null&&(!E.f||E.F))&&_.push(d(E,x,O,G))}return b.join(A)+A+_.join(A)+A+"E"+A}return{to_workbook:c,to_sheet:l,from_sheet:v}})(),N3=(function(){function t(s,l){switch(l.type){case"base64":return e(qi(s),l);case"binary":return e(s,l);case"buffer":return e(Ir&&Buffer.isBuffer(s)?s.toString("binary"):Nu(s),l);case"array":return e(Sd(s),l)}throw new Error("Unrecognized type "+l.type)}function e(s,l){for(var c=s.split(`
`),d=-1,f=-1,m=0,v=[];m!==c.length;++m){if(c[m].trim()==="BOT"){v[++d]=[],f=0;continue}if(!(d<0)){var x=c[m].trim().split(","),g=x[0],b=x[1];++m;for(var _=c[m]||"";(_.match(/["]/g)||[]).length&1&&m<c.length-1;)_+=`
`+c[++m];switch(_=_.trim(),+g){case-1:if(_==="BOT"){v[++d]=[],f=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?v[d][f]=!0:_==="FALSE"?v[d][f]=!1:isNaN(Jo(b))?isNaN(uh(b).getDate())?v[d][f]=b:v[d][f]=Ha(b):v[d][f]=Jo(b),++f;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),v[d][f++]=_!==""?_:null;break}if(_==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function r(s,l){return _h(t(s,l),l)}function a(s,l){return ju(r(s,l),l)}var n=(function(){var s=function(d,f,m,v,x){d.push(f),d.push(m+","+v),d.push('"'+x.replace(/"/g,'""')+'"')},l=function(d,f,m,v){d.push(f+","+m),d.push(f==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(d){var f=[],m=aa(d["!ref"]),v,x=Array.isArray(d);s(f,"TABLE",0,1,"sheetjs"),s(f,"VECTORS",0,m.e.r-m.s.r+1,""),s(f,"TUPLES",0,m.e.c-m.s.c+1,""),s(f,"DATA",0,0,"");for(var g=m.s.r;g<=m.e.r;++g){l(f,-1,0,"BOT");for(var b=m.s.c;b<=m.e.c;++b){var _=Sr({r:g,c:b});if(v=x?(d[g]||[])[b]:d[_],!v){l(f,1,0,"");continue}switch(v.t){case"n":var w=v.w;!w&&v.v!=null&&(w=v.v),w==null?v.f&&!v.F?l(f,1,0,"="+v.f):l(f,1,0,""):l(f,0,w,"V");break;case"b":l(f,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=mo(v.z||wr[14],Jn(Ha(v.v)))),l(f,0,v.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var E=`\r
`,C=f.join(E);return C}})();return{to_workbook:a,to_sheet:r,from_sheet:n}})(),j3=(function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,x){for(var g=v.split(`
`),b=-1,_=-1,w=0,E=[];w!==g.length;++w){var C=g[w].trim().split(":");if(C[0]==="cell"){var A=an(C[1]);if(E.length<=A.r)for(b=E.length;b<=A.r;++b)E[b]||(E[b]=[]);switch(b=A.r,_=A.c,C[2]){case"t":E[b][_]=t(C[3]);break;case"v":E[b][_]=+C[3];break;case"vtf":var O=C[C.length-1];case"vtc":switch(C[3]){case"nl":E[b][_]=!!+C[4];break;default:E[b][_]=+C[4];break}C[2]=="vtf"&&(E[b][_]=[E[b][_],O])}}}return x&&x.sheetRows&&(E=E.slice(0,x.sheetRows)),E}function a(v,x){return _h(r(v,x),x)}function n(v,x){return ju(a(v,x),x)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function f(v){if(!v||!v["!ref"])return"";for(var x=[],g=[],b,_="",w=mi(v["!ref"]),E=Array.isArray(v),C=w.s.r;C<=w.e.r;++C)for(var A=w.s.c;A<=w.e.c;++A)if(_=Sr({r:C,c:A}),b=E?(v[C]||[])[A]:v[_],!(!b||b.v==null||b.t==="z")){switch(g=["cell",_,"t"],b.t){case"s":case"str":g.push(e(b.v));break;case"n":b.f?(g[2]="vtf",g[3]="n",g[4]=b.v,g[5]=e(b.f)):(g[2]="v",g[3]=b.v);break;case"b":g[2]="vt"+(b.f?"f":"c"),g[3]="nl",g[4]=b.v?"1":"0",g[5]=e(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var O=Jn(Ha(b.v));g[2]="vtc",g[3]="nd",g[4]=""+O,g[5]=b.w||mo(b.z||wr[14],O);break;case"e":continue}x.push(g.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function m(v){return[s,l,c,l,f(v),d].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:m}})(),dh=(function(){function t(m,v,x,g,b){b.raw?v[x][g]=m:m===""||(m==="TRUE"?v[x][g]=!0:m==="FALSE"?v[x][g]=!1:isNaN(Jo(m))?isNaN(uh(m).getDate())?v[x][g]=m:v[x][g]=Ha(m):v[x][g]=Jo(m))}function e(m,v){var x=v||{},g=[];if(!m||m.length===0)return g;for(var b=m.split(/[\r\n]/),_=b.length-1;_>=0&&b[_].length===0;)--_;for(var w=10,E=0,C=0;C<=_;++C)E=b[C].indexOf(" "),E==-1?E=b[C].length:E++,w=Math.max(w,E);for(C=0;C<=_;++C){g[C]=[];var A=0;for(t(b[C].slice(0,w).trim(),g,C,A,x),A=1;A<=(b[C].length-w)/10+1;++A)t(b[C].slice(w+(A-1)*10,w+A*10).trim(),g,C,A,x)}return x.sheetRows&&(g=g.slice(0,x.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(m){for(var v={},x=!1,g=0,b=0;g<m.length;++g)(b=m.charCodeAt(g))==34?x=!x:!x&&b in r&&(v[b]=(v[b]||0)+1);b=[];for(g in v)Object.prototype.hasOwnProperty.call(v,g)&&b.push([v[g],g]);if(!b.length){v=a;for(g in v)Object.prototype.hasOwnProperty.call(v,g)&&b.push([v[g],g])}return b.sort(function(_,w){return _[0]-w[0]||a[_[1]]-a[w[1]]}),r[b.pop()[1]]||44}function s(m,v){var x=v||{},g="",b=x.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(g=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(g=m.charAt(4),m=m.slice(6)):g=n(m.slice(0,1024)):x&&x.FS?g=x.FS:g=n(m.slice(0,1024));var w=0,E=0,C=0,A=0,O=0,G=g.charCodeAt(0),W=!1,B=0,q=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var L=x.dateNF!=null?q8(x.dateNF):null;function Z(){var D=m.slice(A,O),T={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)T.t="z";else if(x.raw)T.t="s",T.v=D;else if(D.trim().length===0)T.t="s",T.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(T.t="s",T.v=D.slice(2,-1).replace(/""/g,'"')):gL(D)?(T.t="n",T.f=D.slice(1)):(T.t="s",T.v=D);else if(D=="TRUE")T.t="b",T.v=!0;else if(D=="FALSE")T.t="b",T.v=!1;else if(!isNaN(C=Jo(D)))T.t="n",x.cellText!==!1&&(T.w=D),T.v=C;else if(!isNaN(uh(D).getDate())||L&&D.match(L)){T.z=x.dateNF||wr[14];var M=0;L&&D.match(L)&&(D=z8(D,x.dateNF,D.match(L)||[]),M=1),x.cellDates?(T.t="d",T.v=Ha(D,M)):(T.t="n",T.v=Jn(Ha(D,M))),x.cellText!==!1&&(T.w=mo(T.z,T.v instanceof Date?Jn(T.v):T.v)),x.cellNF||delete T.z}else T.t="s",T.v=D;if(T.t=="z"||(x.dense?(b[w]||(b[w]=[]),b[w][E]=T):b[Sr({c:E,r:w})]=T),A=O+1,q=m.charCodeAt(A),_.e.c<E&&(_.e.c=E),_.e.r<w&&(_.e.r=w),B==G)++E;else if(E=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;O<m.length;++O)switch(B=m.charCodeAt(O)){case 34:q===34&&(W=!W);break;case G:case 10:case 13:if(!W&&Z())break e;break}return O-A>0&&Z(),b["!ref"]=Rr(_),b}function l(m,v){return!(v&&v.PRN)||v.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?s(m,v):_h(e(m,v),v)}function c(m,v){var x="",g=v.type=="string"?[0,0,0,0]:W2(m,v);switch(v.type){case"base64":x=qi(m);break;case"binary":x=m;break;case"buffer":v.codepage==65001?x=m.toString("utf8"):v.codepage&&typeof L0<"u"||(x=Ir&&Buffer.isBuffer(m)?m.toString("binary"):Nu(m));break;case"array":x=Sd(m);break;case"string":x=m;break;default:throw new Error("Unrecognized type "+v.type)}return g[0]==239&&g[1]==187&&g[2]==191?x=ka(x.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?x=ka(x):v.type=="binary"&&typeof L0<"u",x.slice(0,19)=="socialcalc:version:"?j3.to_sheet(v.type=="string"?x:ka(x),v):l(x,v)}function d(m,v){return ju(c(m,v),v)}function f(m){for(var v=[],x=aa(m["!ref"]),g,b=Array.isArray(m),_=x.s.r;_<=x.e.r;++_){for(var w=[],E=x.s.c;E<=x.e.c;++E){var C=Sr({r:_,c:E});if(g=b?(m[_]||[])[E]:m[C],!g||g.v==null){w.push("          ");continue}for(var A=(g.w||(vc(g),g.w)||"").slice(0,10);A.length<10;)A+=" ";w.push(A+(E===0?" ":""))}v.push(w.join(""))}return v.join(`
`)}return{to_workbook:d,to_sheet:c,from_sheet:f}})();function rD(t,e){var r=e||{},a=!!r.WTF;r.WTF=!0;try{var n=S3.to_workbook(t,r);return r.WTF=a,n}catch(s){if(r.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return dh.to_workbook(t,e)}}var yd=(function(){function t(j,F,I){if(j){ys(j,j.l||0);for(var z=I.Enum||fe;j.l<j.length;){var ne=j.read_shift(2),se=z[ne]||z[65535],je=j.read_shift(2),Ne=j.l+je,ge=se.f&&se.f(j,je,I);if(j.l=Ne,F(ge,se,ne))return}}}function e(j,F){switch(F.type){case"base64":return r(Mi(qi(j)),F);case"binary":return r(Mi(j),F);case"buffer":case"array":return r(j,F)}throw"Unsupported type "+F.type}function r(j,F){if(!j)return j;var I=F||{},z=I.dense?[]:{},ne="Sheet1",se="",je=0,Ne={},ge=[],Ie=[],le={s:{r:0,c:0},e:{r:0,c:0}},Ge=I.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)I.Enum=fe,t(j,function(xe,ve,Be){switch(Be){case 0:I.vers=xe,xe>=4096&&(I.qpro=!0);break;case 6:le=xe;break;case 204:xe&&(se=xe);break;case 222:se=xe;break;case 15:case 51:I.qpro||(xe[1].v=xe[1].v.slice(1));case 13:case 14:case 16:Be==14&&(xe[2]&112)==112&&(xe[2]&15)>1&&(xe[2]&15)<15&&(xe[1].z=I.dateNF||wr[14],I.cellDates&&(xe[1].t="d",xe[1].v=N1(xe[1].v))),I.qpro&&xe[3]>je&&(z["!ref"]=Rr(le),Ne[ne]=z,ge.push(ne),z=I.dense?[]:{},le={s:{r:0,c:0},e:{r:0,c:0}},je=xe[3],ne=se||"Sheet"+(je+1),se="");var jt=I.dense?(z[xe[0].r]||[])[xe[0].c]:z[Sr(xe[0])];if(jt){jt.t=xe[1].t,jt.v=xe[1].v,xe[1].z!=null&&(jt.z=xe[1].z),xe[1].f!=null&&(jt.f=xe[1].f);break}I.dense?(z[xe[0].r]||(z[xe[0].r]=[]),z[xe[0].r][xe[0].c]=xe[1]):z[Sr(xe[0])]=xe[1];break}},I);else if(j[2]==26||j[2]==14)I.Enum=U,j[2]==14&&(I.qpro=!0,j.l=0),t(j,function(xe,ve,Be){switch(Be){case 204:ne=xe;break;case 22:xe[1].v=xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>je&&(z["!ref"]=Rr(le),Ne[ne]=z,ge.push(ne),z=I.dense?[]:{},le={s:{r:0,c:0},e:{r:0,c:0}},je=xe[3],ne="Sheet"+(je+1)),Ge>0&&xe[0].r>=Ge)break;I.dense?(z[xe[0].r]||(z[xe[0].r]=[]),z[xe[0].r][xe[0].c]=xe[1]):z[Sr(xe[0])]=xe[1],le.e.c<xe[0].c&&(le.e.c=xe[0].c),le.e.r<xe[0].r&&(le.e.r=xe[0].r);break;case 27:xe[14e3]&&(Ie[xe[14e3][0]]=xe[14e3][1]);break;case 1537:Ie[xe[0]]=xe[1],xe[0]==je&&(ne=xe[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(z["!ref"]=Rr(le),Ne[se||ne]=z,ge.push(se||ne),!Ie.length)return{SheetNames:ge,Sheets:Ne};for(var rt={},ue=[],ot=0;ot<Ie.length;++ot)Ne[ge[ot]]?(ue.push(Ie[ot]||ge[ot]),rt[Ie[ot]]=Ne[Ie[ot]]||Ne[ge[ot]]):(ue.push(Ie[ot]),rt[Ie[ot]]={"!ref":"A1"});return{SheetNames:ue,Sheets:rt}}function a(j,F){var I=F||{};if(+I.codepage>=0&&Xo(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var z=hi(),ne=aa(j["!ref"]),se=Array.isArray(j),je=[];It(z,0,s(1030)),It(z,6,d(ne));for(var Ne=Math.min(ne.e.r,8191),ge=ne.s.r;ge<=Ne;++ge)for(var Ie=Cn(ge),le=ne.s.c;le<=ne.e.c;++le){ge===ne.s.r&&(je[le]=rn(le));var Ge=je[le]+Ie,rt=se?(j[ge]||[])[le]:j[Ge];if(!(!rt||rt.t=="z"))if(rt.t=="n")(rt.v|0)==rt.v&&rt.v>=-32768&&rt.v<=32767?It(z,13,g(ge,le,rt.v)):It(z,14,_(ge,le,rt.v));else{var ue=vc(rt);It(z,15,v(ge,le,ue.slice(0,239)))}}return It(z,1),z.end()}function n(j,F){var I=F||{};if(+I.codepage>=0&&Xo(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var z=hi();It(z,0,l(j));for(var ne=0,se=0;ne<j.SheetNames.length;++ne)(j.Sheets[j.SheetNames[ne]]||{})["!ref"]&&It(z,27,te(j.SheetNames[ne],se++));var je=0;for(ne=0;ne<j.SheetNames.length;++ne){var Ne=j.Sheets[j.SheetNames[ne]];if(!(!Ne||!Ne["!ref"])){for(var ge=aa(Ne["!ref"]),Ie=Array.isArray(Ne),le=[],Ge=Math.min(ge.e.r,8191),rt=ge.s.r;rt<=Ge;++rt)for(var ue=Cn(rt),ot=ge.s.c;ot<=ge.e.c;++ot){rt===ge.s.r&&(le[ot]=rn(ot));var xe=le[ot]+ue,ve=Ie?(Ne[rt]||[])[ot]:Ne[xe];if(!(!ve||ve.t=="z"))if(ve.t=="n")It(z,23,Z(rt,ot,je,ve.v));else{var Be=vc(ve);It(z,22,B(rt,ot,je,Be.slice(0,239)))}}++je}}return It(z,1),z.end()}function s(j){var F=ft(2);return F.write_shift(2,j),F}function l(j){var F=ft(26);F.write_shift(2,4096),F.write_shift(2,4),F.write_shift(4,0);for(var I=0,z=0,ne=0,se=0;se<j.SheetNames.length;++se){var je=j.SheetNames[se],Ne=j.Sheets[je];if(!(!Ne||!Ne["!ref"])){++ne;var ge=mi(Ne["!ref"]);I<ge.e.r&&(I=ge.e.r),z<ge.e.c&&(z=ge.e.c)}}return I>8191&&(I=8191),F.write_shift(2,I),F.write_shift(1,ne),F.write_shift(1,z),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(1,1),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(4,0),F}function c(j,F,I){var z={s:{c:0,r:0},e:{c:0,r:0}};return F==8&&I.qpro?(z.s.c=j.read_shift(1),j.l++,z.s.r=j.read_shift(2),z.e.c=j.read_shift(1),j.l++,z.e.r=j.read_shift(2),z):(z.s.c=j.read_shift(2),z.s.r=j.read_shift(2),F==12&&I.qpro&&(j.l+=2),z.e.c=j.read_shift(2),z.e.r=j.read_shift(2),F==12&&I.qpro&&(j.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function d(j){var F=ft(8);return F.write_shift(2,j.s.c),F.write_shift(2,j.s.r),F.write_shift(2,j.e.c),F.write_shift(2,j.e.r),F}function f(j,F,I){var z=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(z[0].c=j.read_shift(1),z[3]=j.read_shift(1),z[0].r=j.read_shift(2),j.l+=2):(z[2]=j.read_shift(1),z[0].c=j.read_shift(2),z[0].r=j.read_shift(2)),z}function m(j,F,I){var z=j.l+F,ne=f(j,F,I);if(ne[1].t="s",I.vers==20768){j.l++;var se=j.read_shift(1);return ne[1].v=j.read_shift(se,"utf8"),ne}return I.qpro&&j.l++,ne[1].v=j.read_shift(z-j.l,"cstr"),ne}function v(j,F,I){var z=ft(7+I.length);z.write_shift(1,255),z.write_shift(2,F),z.write_shift(2,j),z.write_shift(1,39);for(var ne=0;ne<z.length;++ne){var se=I.charCodeAt(ne);z.write_shift(1,se>=128?95:se)}return z.write_shift(1,0),z}function x(j,F,I){var z=f(j,F,I);return z[1].v=j.read_shift(2,"i"),z}function g(j,F,I){var z=ft(7);return z.write_shift(1,255),z.write_shift(2,F),z.write_shift(2,j),z.write_shift(2,I,"i"),z}function b(j,F,I){var z=f(j,F,I);return z[1].v=j.read_shift(8,"f"),z}function _(j,F,I){var z=ft(13);return z.write_shift(1,255),z.write_shift(2,F),z.write_shift(2,j),z.write_shift(8,I,"f"),z}function w(j,F,I){var z=j.l+F,ne=f(j,F,I);if(ne[1].v=j.read_shift(8,"f"),I.qpro)j.l=z;else{var se=j.read_shift(2);O(j.slice(j.l,j.l+se),ne),j.l+=se}return ne}function E(j,F,I){var z=F&32768;return F&=-32769,F=(z?j:0)+(F>=8192?F-16384:F),(z?"":"$")+(I?rn(F):Cn(F))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(j,F){ys(j,0);for(var I=[],z=0,ne="",se="",je="",Ne="";j.l<j.length;){var ge=j[j.l++];switch(ge){case 0:I.push(j.read_shift(8,"f"));break;case 1:se=E(F[0].c,j.read_shift(2),!0),ne=E(F[0].r,j.read_shift(2),!1),I.push(se+ne);break;case 2:{var Ie=E(F[0].c,j.read_shift(2),!0),le=E(F[0].r,j.read_shift(2),!1);se=E(F[0].c,j.read_shift(2),!0),ne=E(F[0].r,j.read_shift(2),!1),I.push(Ie+le+":"+se+ne)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(j.read_shift(2));break;case 6:{for(var Ge="";ge=j[j.l++];)Ge+=String.fromCharCode(ge);I.push('"'+Ge.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:Ne=I.pop(),je=I.pop(),I.push(["AND","OR"][ge-20]+"("+je+","+Ne+")");break;default:if(ge<32&&A[ge])Ne=I.pop(),je=I.pop(),I.push(je+A[ge]+Ne);else if(C[ge]){if(z=C[ge][1],z==69&&(z=j[j.l++]),z>I.length){console.error("WK1 bad formula parse 0x"+ge.toString(16)+":|"+I.join("|")+"|");return}var rt=I.slice(-z);I.length-=z,I.push(C[ge][0]+"("+rt.join(",")+")")}else return ge<=7?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=24?console.error("WK1 unsupported op "+ge.toString(16)):ge<=30?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=115?console.error("WK1 unsupported function opcode "+ge.toString(16)):console.error("WK1 unrecognized opcode "+ge.toString(16))}}I.length==1?F[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function G(j){var F=[{c:0,r:0},{t:"n",v:0},0];return F[0].r=j.read_shift(2),F[3]=j[j.l++],F[0].c=j[j.l++],F}function W(j,F){var I=G(j);return I[1].t="s",I[1].v=j.read_shift(F-4,"cstr"),I}function B(j,F,I,z){var ne=ft(6+z.length);ne.write_shift(2,j),ne.write_shift(1,I),ne.write_shift(1,F),ne.write_shift(1,39);for(var se=0;se<z.length;++se){var je=z.charCodeAt(se);ne.write_shift(1,je>=128?95:je)}return ne.write_shift(1,0),ne}function q(j,F){var I=G(j);I[1].v=j.read_shift(2);var z=I[1].v>>1;if(I[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return I[1].v=z,I}function L(j,F){var I=G(j),z=j.read_shift(4),ne=j.read_shift(4),se=j.read_shift(2);if(se==65535)return z===0&&ne===3221225472?(I[1].t="e",I[1].v=15):z===0&&ne===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var je=se&32768;return se=(se&32767)-16446,I[1].v=(1-je*2)*(ne*Math.pow(2,se+32)+z*Math.pow(2,se)),I}function Z(j,F,I,z){var ne=ft(14);if(ne.write_shift(2,j),ne.write_shift(1,I),ne.write_shift(1,F),z==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var se=0,je=0,Ne=0,ge=0;return z<0&&(se=1,z=-z),je=Math.log2(z)|0,z/=Math.pow(2,je-31),ge=z>>>0,(ge&2147483648)==0&&(z/=2,++je,ge=z>>>0),z-=ge,ge|=2147483648,ge>>>=0,z*=Math.pow(2,32),Ne=z>>>0,ne.write_shift(4,Ne),ne.write_shift(4,ge),je+=16383+(se?32768:0),ne.write_shift(2,je),ne}function D(j,F){var I=L(j);return j.l+=F-14,I}function T(j,F){var I=G(j),z=j.read_shift(4);return I[1].v=z>>6,I}function M(j,F){var I=G(j),z=j.read_shift(8,"f");return I[1].v=z,I}function V(j,F){var I=M(j);return j.l+=F-10,I}function ie(j,F){return j[j.l+F-1]==0?j.read_shift(F,"cstr"):""}function X(j,F){var I=j[j.l++];I>F-1&&(I=F-1);for(var z="";z.length<I;)z+=String.fromCharCode(j[j.l++]);return z}function J(j,F,I){if(!(!I.qpro||F<21)){var z=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var ne=j.read_shift(F-21,"cstr");return[z,ne]}}function K(j,F){for(var I={},z=j.l+F;j.l<z;){var ne=j.read_shift(2);if(ne==14e3){for(I[ne]=[0,""],I[ne][0]=j.read_shift(2);j[j.l];)I[ne][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return I}function te(j,F){var I=ft(5+j.length);I.write_shift(2,14e3),I.write_shift(2,F);for(var z=0;z<j.length;++z){var ne=j.charCodeAt(z);I[I.l++]=ne>127?95:ne}return I[I.l++]=0,I}var fe={0:{n:"BOF",f:In},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ie},222:{n:"SHEETNAMELP",f:X},65535:{n:""}},U={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:q},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:V},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:e}})();function aD(t){var e={},r=t.match(Is),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=Nr(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=l2[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return e}var nD=(function(){var t=I0("t"),e=I0("rPr");function r(s){var l=s.match(t);if(!l)return{t:"s",v:""};var c={t:"s",v:ra(l[1])},d=s.match(e);return d&&(c.s=aD(d[1])),c}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(n).map(r).filter(function(c){return c.v})}})(),sD=(function(){var e=/(\r\n|\n)/g;function r(n,s,l){var c=[];n.u&&c.push("text-decoration: underline;"),n.uval&&c.push("text-underline-style:"+n.uval+";"),n.sz&&c.push("font-size:"+n.sz+"pt;"),n.outline&&c.push("text-effect: outline;"),n.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),n.b&&(s.push("<b>"),l.push("</b>")),n.i&&(s.push("<i>"),l.push("</i>")),n.strike&&(s.push("<s>"),l.push("</s>"));var d=n.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(s.push("<"+d+">"),l.push("</"+d+">")),l.push("</span>"),n}function a(n){var s=[[],n.v,[]];return n.v?(n.s&&r(n.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}})(),iD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,oD=/<(?:\w+:)?r>/,lD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function R2(t,e){var r=e?e.cellHTML:!0,a={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=ra(ka(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=ka(t),r&&(a.h=x2(a.t))):t.match(oD)&&(a.r=ka(t),a.t=ra(ka((t.replace(lD,"").match(iD)||[]).join("").replace(Is,""))),r&&(a.h=sD(nD(a.r)))),a):{t:""}}var cD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,uD=/<(?:\w+:)?(?:si|sstItem)>/g,dD=/<\/(?:\w+:)?(?:si|sstItem)>/;function fD(t,e){var r=[],a="";if(!t)return r;var n=t.match(cD);if(n){a=n[2].replace(uD,"").split(dD);for(var s=0;s!=a.length;++s){var l=R2(a[s].trim(),e);l!=null&&(r[r.length]=l)}n=Nr(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var hD=/^\s|\s$|[\t\n\r]/;function k3(t,e){if(!e.bookSST)return"";var r=[Tn];r[r.length]=Lt("sst",null,{xmlns:Dd[0],count:t.Count,uniqueCount:t.Unique});for(var a=0;a!=t.length;++a)if(t[a]!=null){var n=t[a],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(hD)&&(s+=' xml:space="preserve"'),s+=">"+ya(n.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function mD(t){return[t.read_shift(4),t.read_shift(4)]}function pD(t,e){var r=[],a=!1;return Sc(t,function(s,l,c){switch(c){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function gD(t,e){return e||(e=ft(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var vD=EO;function xD(t){var e=hi();bt(e,159,gD(t));for(var r=0;r<t.length;++r)bt(e,19,vD(t[r]));return bt(e,160),e.end()}function E3(t){for(var e=[],r=t.split(""),a=0;a<r.length;++a)e[a]=r[a].charCodeAt(0);return e}function gc(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function yD(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=gc(t,4),e.U=gc(t,4),e.W=gc(t,4),e}function _D(t){for(var e=t.read_shift(4),r=t.l+e-4,a={},n=t.read_shift(4),s=[];n-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(a.name=t.read_shift(0,"lpp4"),a.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return a}function bD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(_D(t));return e}function wD(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function SD(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=gc(t,4),e.U=gc(t,4),e.W=gc(t,4),e}function ND(t){var e=SD(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function A3(t,e){var r=t.l+e,a={};a.Flags=t.read_shift(4)&63,t.l+=4,a.AlgID=t.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=t.read_shift(4),a.KeySize=t.read_shift(4),a.ProviderType=t.read_shift(4),t.l+=8,a.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,a}function C3(t,e){var r={},a=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,a),t.l=a,r}function jD(t){var e=gc(t);switch(e.Minor){case 2:return[e.Minor,kD(t)];case 3:return[e.Minor,ED()];case 4:return[e.Minor,AD(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function kD(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),a=A3(t,r),n=C3(t,t.length-t.l);return{t:"Std",h:a,v:n}}function ED(){throw new Error("File is password-protected: ECMA-376 Extensible")}function AD(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),a={};return r.replace(Is,function(s){var l=Nr(s);switch(Cl(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){a[c]=l[c]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function CD(t,e){var r={},a=r.EncryptionVersionInfo=gc(t,4);if(e-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=t.read_shift(4),e-=4;var n=t.read_shift(4);return e-=4,r.EncryptionHeader=A3(t,n),e-=n,r.EncryptionVerifier=C3(t,e),r}function TD(t){var e={},r=e.EncryptionVersionInfo=gc(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function D2(t){var e=0,r,a=E3(t),n=a.length+1,s,l,c,d,f;for(r=xu(n),r[0]=a.length,s=1;s!=n;++s)r[s]=a[s-1];for(s=n-1;s>=0;--s)l=r[s],c=(e&16384)===0?0:1,d=e<<1&32767,f=c|d,e=f^l;return e^52811}var T3=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},n=function(l,c){return a(l^c)},s=function(l){for(var c=e[l.length-1],d=104,f=l.length-1;f>=0;--f)for(var m=l[f],v=0;v!=7;++v)m&64&&(c^=r[d]),m*=2,--d;return c};return function(l){for(var c=E3(l),d=s(c),f=c.length,m=xu(16),v=0;v!=16;++v)m[v]=0;var x,g,b;for((f&1)===1&&(x=d>>8,m[f]=n(t[0],x),--f,x=d&255,g=c[c.length-1],m[f]=n(g,x));f>0;)--f,x=d>>8,m[f]=n(c[f],x),--f,x=d&255,m[f]=n(c[f],x);for(f=15,b=15-c.length;b>0;)x=d>>8,m[f]=n(t[b],x),--f,--b,x=d&255,m[f]=n(c[f],x),--f,--b;return m}})(),OD=function(t,e,r,a,n){n||(n=e),a||(a=T3(t));var s,l;for(s=0;s!=e.length;++s)l=e[s],l^=a[r],l=(l>>5|l<<3)&255,n[s]=l,++r;return[n,r,a]},RD=function(t){var e=0,r=T3(t);return function(a){var n=OD("",a,e,r);return e=n[1],n[0]}};function DD(t,e,r,a){var n={key:In(t),verificationBytes:In(t)};return r.password&&(n.verifier=D2(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=RD(r.password)),n}function FD(t,e,r){var a=r||{};return a.Info=t.read_shift(2),t.l-=2,a.Info===1?a.Data=TD(t):a.Data=CD(t,e),a}function LD(t,e,r){var a={Type:r.biff>=8?t.read_shift(2):0};return a.Type?FD(t,e-2,a):DD(t,r.biff>=8?e:e-2,r,a),a}var O3=(function(){function t(n,s){switch(s.type){case"base64":return e(qi(n),s);case"binary":return e(n,s);case"buffer":return e(Ir&&Buffer.isBuffer(n)?n.toString("binary"):Nu(n),s);case"array":return e(Sd(n),s)}throw new Error("Unrecognized type "+s.type)}function e(n,s){var l=s||{},c=l.dense?[]:{},d=n.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(m,v){Array.isArray(c)&&(c[v]=[]);for(var x=/\\\w+\b/g,g=0,b,_=-1;b=x.exec(m);){switch(b[0]){case"\\cell":var w=m.slice(g,x.lastIndex-b[0].length);if(w[0]==" "&&(w=w.slice(1)),++_,w.length){var E={v:w,t:"s"};Array.isArray(c)?c[v][_]=E:c[Sr({r:v,c:_})]=E}break}g=x.lastIndex}_>f.e.c&&(f.e.c=_)}),c["!ref"]=Rr(f),c}function r(n,s){return ju(t(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],l=aa(n["!ref"]),c,d=Array.isArray(n),f=l.s.r;f<=l.e.r;++f){s.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)s.push("\\cellx"+(m+1));for(s.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var v=Sr({r:f,c:m});c=d?(n[f]||[])[m]:n[v],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(vc(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:a}})();function PD(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function z0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function MD(t){var e=t[0]/255,r=t[1]/255,a=t[2]/255,n=Math.max(e,r,a),s=Math.min(e,r,a),l=n-s;if(l===0)return[0,0,e];var c=0,d=0,f=n+s;switch(d=l/(f>1?2-f:f),n){case e:c=((r-a)/l+6)%6;break;case r:c=(a-e)/l+2;break;case a:c=(e-r)/l+4;break}return[c/6,d,f/2]}function ID(t){var e=t[0],r=t[1],a=t[2],n=r*2*(a<.5?a:1-a),s=a-n/2,l=[s,s,s],c=6*e,d;if(r!==0)switch(c|0){case 0:case 6:d=n*c,l[0]+=n,l[1]+=d;break;case 1:d=n*(2-c),l[0]+=d,l[1]+=n;break;case 2:d=n*(c-2),l[1]+=n,l[2]+=d;break;case 3:d=n*(4-c),l[1]+=d,l[2]+=n;break;case 4:d=n*(c-4),l[2]+=n,l[0]+=d;break;case 5:d=n*(6-c),l[2]+=d,l[0]+=n;break}for(var f=0;f!=3;++f)l[f]=Math.round(l[f]*255);return l}function i1(t,e){if(e===0)return t;var r=MD(PD(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),z0(ID(r))}var R3=6,BD=15,UD=1,Fs=R3;function H0(t){return Math.floor((t+Math.round(128/Fs)/256)*Fs)}function $0(t){return Math.floor((t-5)/Fs*100+.5)/100}function o1(t){return Math.round((t*Fs+5)/Fs*256)/256}function hv(t){return o1($0(H0(t)))}function F2(t){var e=Math.abs(t-hv(t)),r=Fs;if(e>.005)for(Fs=UD;Fs<BD;++Fs)Math.abs(t-hv(t))<=e&&(e=Math.abs(t-hv(t)),r=Fs);Fs=r}function yu(t){t.width?(t.wpx=H0(t.width),t.wch=$0(t.wpx),t.MDW=Fs):t.wpx?(t.wch=$0(t.wpx),t.width=o1(t.wch),t.MDW=Fs):typeof t.wch=="number"&&(t.width=o1(t.wch),t.wpx=H0(t.width),t.MDW=Fs),t.customWidth&&delete t.customWidth}var qD=96,D3=qD;function W0(t){return t*96/D3}function fh(t){return t*D3/96}var zD={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function HD(t,e,r,a){e.Borders=[];var n={},s=!1;(t[0].match(Is)||[]).forEach(function(l){var c=Nr(l);switch(Cl(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},c.diagonalUp&&(n.diagonalUp=qa(c.diagonalUp)),c.diagonalDown&&(n.diagonalDown=qa(c.diagonalDown)),e.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function $D(t,e,r,a){e.Fills=[];var n={},s=!1;(t[0].match(Is)||[]).forEach(function(l){var c=Nr(l);switch(Cl(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},e.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":c.patternType&&(n.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),c.indexed&&(n.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(n.bgColor.theme=parseInt(c.theme,10)),c.tint&&(n.bgColor.tint=parseFloat(c.tint)),c.rgb&&(n.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),c.theme&&(n.fgColor.theme=parseInt(c.theme,10)),c.tint&&(n.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(n.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function WD(t,e,r,a){e.Fonts=[];var n={},s=!1;(t[0].match(Is)||[]).forEach(function(l){var c=Nr(l);switch(Cl(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(n),n={};break;case"<name":c.val&&(n.name=ka(c.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=c.val?qa(c.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=c.val?qa(c.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(c.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=c.val?qa(c.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=c.val?qa(c.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=c.val?qa(c.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=c.val?qa(c.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=c.val?qa(c.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":c.val&&(n.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(n.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(n.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(n.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=l2[parseInt(c.val,10)];break;case"<color":if(n.color||(n.color={}),c.auto&&(n.color.auto=qa(c.auto)),c.rgb)n.color.rgb=c.rgb.slice(-6);else if(c.indexed){n.color.index=parseInt(c.indexed,10);var d=vd[n.color.index];n.color.index==81&&(d=vd[1]),d||(d=vd[1]),n.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else c.theme&&(n.color.theme=parseInt(c.theme,10),c.tint&&(n.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=i1(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function VD(t,e,r){e.NumberFmt=[];for(var a=vn(wr),n=0;n<a.length;++n)e.NumberFmt[a[n]]=wr[a[n]];var s=t[0].match(Is);if(s)for(n=0;n<s.length;++n){var l=Nr(s[n]);switch(Cl(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=ra(ka(l.formatCode)),d=parseInt(l.numFmtId,10);if(e.NumberFmt[d]=c,d>0){if(d>392){for(d=392;d>60&&e.NumberFmt[d]!=null;--d);e.NumberFmt[d]=c}pc(c,d)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function GD(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)t[a]!=null&&(e[e.length]=Lt("numFmt",null,{numFmtId:a,formatCode:ya(t[a])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Lt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var _p=["numFmtId","fillId","fontId","borderId","xfId"],bp=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function YD(t,e,r){e.CellXf=[];var a,n=!1;(t[0].match(Is)||[]).forEach(function(s){var l=Nr(s),c=0;switch(Cl(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],c=0;c<_p.length;++c)a[_p[c]]&&(a[_p[c]]=parseInt(a[_p[c]],10));for(c=0;c<bp.length;++c)a[bp[c]]&&(a[bp[c]]=qa(a[bp[c]]));if(e.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[a.numFmtId]==e.NumberFmt[c]){a.numFmtId=c;break}}e.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};l.vertical&&(d.vertical=l.vertical),l.horizontal&&(d.horizontal=l.horizontal),l.textRotation!=null&&(d.textRotation=l.textRotation),l.indent&&(d.indent=l.indent),l.wrapText&&(d.wrapText=qa(l.wrapText)),a.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function XD(t){var e=[];return e[e.length]=Lt("cellXfs",null),t.forEach(function(r){e[e.length]=Lt("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Lt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var KD=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,d,f){var m={};if(!c)return m;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=c.match(e))&&VD(v,m,f),(v=c.match(n))&&WD(v,m,d,f),(v=c.match(a))&&$D(v,m,d,f),(v=c.match(s))&&HD(v,m,d,f),(v=c.match(r))&&YD(v,m,f),m}})();function F3(t,e){var r=[Tn,Lt("styleSheet",null,{xmlns:Dd[0],"xmlns:vt":Kn.vt})],a;return t.SSF&&(a=GD(t.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=XD(e.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function JD(t,e){var r=t.read_shift(2),a=Ps(t);return[r,a]}function ZD(t,e,r){r||(r=ft(6+4*e.length)),r.write_shift(2,t),os(e,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function QD(t,e,r){var a={};a.sz=t.read_shift(2)/20;var n=FO(t);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=t.read_shift(2);switch(s===700&&(a.bold=1),t.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(a.underline=l);var c=t.read_shift(1);c>0&&(a.family=c);var d=t.read_shift(1);switch(d>0&&(a.charset=d),t.l++,a.color=DO(t),t.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Ps(t),a}function eF(t,e){e||(e=ft(153)),e.write_shift(2,t.sz*20),LO(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),a1(t.color,e);var a=0;return a=2,e.write_shift(1,a),os(t.name,e),e.length>e.l?e.slice(0,e.l):e}var tF=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],mv,rF=Ms;function s5(t,e){e||(e=ft(84)),mv||(mv=w1(tF));var r=mv[t.patternType];r==null&&(r=40),e.write_shift(4,r);var a=0;if(r!=40)for(a1({auto:1},e),a1({auto:1},e);a<12;++a)e.write_shift(4,0);else{for(;a<4;++a)e.write_shift(4,0);for(;a<12;++a)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function aF(t,e){var r=t.l+e,a=t.read_shift(2),n=t.read_shift(2);return t.l=r,{ixfe:a,numFmtId:n}}function L3(t,e,r){r||(r=ft(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function i0(t,e){return e||(e=ft(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var nF=Ms;function sF(t,e){return e||(e=ft(51)),e.write_shift(1,0),i0(null,e),i0(null,e),i0(null,e),i0(null,e),i0(null,e),e.length>e.l?e.slice(0,e.l):e}function iF(t,e){return e||(e=ft(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),r1(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function oF(t,e,r){var a=ft(2052);return a.write_shift(4,t),r1(e,a),r1(r,a),a.length>a.l?a.slice(0,a.l):a}function lF(t,e,r){var a={};a.NumberFmt=[];for(var n in wr)a.NumberFmt[n]=wr[n];a.CellXf=[],a.Fonts=[];var s=[],l=!1;return Sc(t,function(d,f,m){switch(m){case 44:a.NumberFmt[d[0]]=d[1],pc(d[1],d[0]);break;case 43:a.Fonts.push(d),d.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(d.color.rgb=i1(e.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(m),l=!0;break;case 38:s.pop(),l=!1;break;default:if(f.T>0)s.push(m);else if(f.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),a}function cF(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&++r}),r!=0&&(bt(t,615,Zo(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&bt(t,44,ZD(n,e[n]))}),bt(t,616))}}function uF(t){var e=1;bt(t,611,Zo(e)),bt(t,43,eF({sz:12,color:{theme:1},name:"Calibri",family:2})),bt(t,612)}function dF(t){var e=2;bt(t,603,Zo(e)),bt(t,45,s5({patternType:"none"})),bt(t,45,s5({patternType:"gray125"})),bt(t,604)}function fF(t){var e=1;bt(t,613,Zo(e)),bt(t,46,sF()),bt(t,614)}function hF(t){var e=1;bt(t,626,Zo(e)),bt(t,47,L3({numFmtId:0},65535)),bt(t,627)}function mF(t,e){bt(t,617,Zo(e.length)),e.forEach(function(r){bt(t,47,L3(r,0))}),bt(t,618)}function pF(t){var e=1;bt(t,619,Zo(e)),bt(t,48,iF({xfId:0,name:"Normal"})),bt(t,620)}function gF(t){var e=0;bt(t,505,Zo(e)),bt(t,506)}function vF(t){var e=0;bt(t,508,oF(e,"TableStyleMedium9","PivotStyleMedium4")),bt(t,509)}function xF(t,e){var r=hi();return bt(r,278),cF(r,t.SSF),uF(r),dF(r),fF(r),hF(r),mF(r,e.cellXfs),pF(r),gF(r),vF(r),bt(r,279),r.end()}var yF=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function _F(t,e,r){e.themeElements.clrScheme=[];var a={};(t[0].match(Is)||[]).forEach(function(n){var s=Nr(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[yF.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function bF(){}function wF(){}var SF=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,NF=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,jF=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function kF(t,e,r){e.themeElements={};var a;[["clrScheme",SF,_F],["fontScheme",NF,bF],["fmtScheme",jF,wF]].forEach(function(n){if(!(a=t.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,e,r)})}var EF=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function P3(t,e){(!t||t.length===0)&&(t=L2());var r,a={};if(!(r=t.match(EF)))throw new Error("themeElements not found in theme");return kF(r[0],a,e),a.raw=t,a}function L2(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Tn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function AF(t,e,r){var a=t.l+e,n=t.read_shift(4);if(n!==124226){if(!r.cellStyles){t.l=a;return}var s=t.slice(t.l);t.l=a;var l;try{l=AN(s,{type:"array"})}catch{return}var c=Ii(l,"theme/theme/theme1.xml",!0);if(c)return P3(c,r)}}function CF(t){return t.read_shift(4)}function TF(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=OF(t,4);break;case 2:e.xclrValue=p3(t);break;case 3:e.xclrValue=CF(t);break;case 4:t.l+=4;break}return t.l+=8,e}function OF(t,e){return Ms(t,e)}function RF(t,e){return Ms(t,e)}function DF(t){var e=t.read_shift(2),r=t.read_shift(2)-4,a=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=TF(t);break;case 6:a[1]=RF(t,r);break;case 14:case 15:a[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return a}function FF(t,e){var r=t.l+e;t.l+=2;var a=t.read_shift(2);t.l+=2;for(var n=t.read_shift(2),s=[];n-- >0;)s.push(DF(t,r-t.l));return{ixfe:a,ext:s}}function LF(t,e){e.forEach(function(r){r[0]})}function PF(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ps(t)}}function MF(t){var e=ft(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),os(t.name,e),e.slice(0,e.l)}function IF(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function BF(t){var e=ft(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function UF(t,e){var r=ft(8+2*e.length);return r.write_shift(4,t),os(e,r),r.slice(0,r.l)}function qF(t){return t.l+=4,t.read_shift(4)!=0}function zF(t,e){var r=ft(8);return r.write_shift(4,t),r.write_shift(4,1),r}function HF(t,e,r){var a={Types:[],Cell:[],Value:[]},n=r||{},s=[],l=!1,c=2;return Sc(t,function(d,f,m){switch(m){case 335:a.Types.push({name:d.name});break;case 51:d.forEach(function(v){c==1?a.Cell.push({type:a.Types[v[0]-1].name,index:v[1]}):c==0&&a.Value.push({type:a.Types[v[0]-1].name,index:v[1]})});break;case 337:c=d?1:0;break;case 338:c=2;break;case 35:s.push(m),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!f.T){if(!l||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),a}function $F(){var t=hi();return bt(t,332),bt(t,334,Zo(1)),bt(t,335,MF({name:"XLDAPR",version:12e4,flags:3496657072})),bt(t,336),bt(t,339,UF(1,"XLDAPR")),bt(t,52),bt(t,35,Zo(514)),bt(t,4096,Zo(0)),bt(t,4097,co(1)),bt(t,36),bt(t,53),bt(t,340),bt(t,337,zF(1)),bt(t,51,BF([[1,0]])),bt(t,338),bt(t,333),t.end()}function WF(t,e,r){var a={Types:[],Cell:[],Value:[]};if(!t)return a;var n=!1,s=2,l;return t.replace(Is,function(c){var d=Nr(c);switch(Cl(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<a.Types.length;++f)a.Types[f].name==d.name&&(l=a.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[d.t-1].name,index:+d.v}):s==0&&a.Value.push({type:a.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+d.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return c}),a}function M3(){var t=[Tn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function VF(t){var e=[];if(!t)return e;var r=1;return(t.match(Is)||[]).forEach(function(a){var n=Nr(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,e.push(n);break}}),e}function GF(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Sr(r);var a=t.read_shift(1);return a&2&&(e.l="1"),a&8&&(e.a="1"),e}function YF(t,e,r){var a=[];return Sc(t,function(s,l,c){switch(c){case 63:a.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function XF(t,e,r,a){if(!t)return t;var n=a||{},s=!1;Sc(t,function(c,d,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!d.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},n)}function KF(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Xf=1024;function I3(t,e){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Lt("xml",null,{"xmlns:v":Di.v,"xmlns:o":Di.o,"xmlns:x":Di.x,"xmlns:mv":Di.mv}).replace(/\/>/,">"),Lt("o:shapelayout",Lt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Lt("v:shapetype",[Lt("v:stroke",null,{joinstyle:"miter"}),Lt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Xf<t*1e3;)Xf+=1e3;return e.forEach(function(s){var l=an(s[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var d=c.type=="gradient"?Lt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Lt("v:fill",d,c),m={on:"t",obscured:"t"};++Xf,n=n.concat(["<v:shape"+B0({id:"_x0000_s"+Xf,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Lt("v:shadow",null,m),Lt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",_s("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),_s("x:AutoFill","False"),_s("x:Row",String(l.r)),_s("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function i5(t,e,r,a){var n=Array.isArray(t),s;e.forEach(function(l){var c=an(l.ref);if(n?(t[c.r]||(t[c.r]=[]),s=t[c.r][c.c]):s=t[l.ref],!s){s={t:"z"},n?t[c.r][c.c]=s:t[l.ref]=s;var d=aa(t["!ref"]||"BDWGO1000001:A1");d.s.r>c.r&&(d.s.r=c.r),d.e.r<c.r&&(d.e.r=c.r),d.s.c>c.c&&(d.s.c=c.c),d.e.c<c.c&&(d.e.c=c.c);var f=Rr(d);f!==t["!ref"]&&(t["!ref"]=f)}s.c||(s.c=[]);var m={a:l.author,t:l.t,r:l.r,T:r};l.h&&(m.h=l.h);for(var v=s.c.length-1;v>=0;--v){if(!r&&s.c[v].T)return;r&&!s.c[v].T&&s.c.splice(v,1)}if(r&&a){for(v=0;v<a.length;++v)if(m.a==a[v].id){m.a=a[v].name||m.a;break}}s.c.push(m)})}function JF(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var d=Nr(c[0]),f={author:d.authorId&&r[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},m=an(d.ref);if(!(e.sheetRows&&e.sheetRows<=m.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!v&&!!v[1]&&R2(v[1])||{r:"",t:"",h:""};f.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),f.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(f.h=x.h),a.push(f)}}}}),a}function B3(t){var e=[Tn,Lt("comments",null,{xmlns:Dd[0]})],r=[];return e.push("<authors>"),t.forEach(function(a){a[1].forEach(function(n){var s=ya(n.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),e.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(a){var n=0,s=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(d){d.a&&(n=r.indexOf(ya(d.a))),s.push(d.t||"")}),e.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),s.length<=1)e.push(_s("t",ya(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,c=1;c<s.length;++c)l+=`Reply:
    `+s[c]+`
`;e.push(_s("t",ya(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function ZF(t,e){var r=[],a=!1,n={},s=0;return t.replace(Is,function(c,d){var f=Nr(c);switch(Cl(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":s=d+c.length;break;case"</text>":n.t=t.slice(s,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&e.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),r}function QF(t,e,r){var a=[Tn,Lt("ThreadedComments",null,{xmlns:Kn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(n){var s="";(n[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var d={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?s=d.id:d.parentId=s,l.ID=d.id,l.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),a.push(Lt("threadedComment",_s("text",l.t||""),d))})}),a.push("</ThreadedComments>"),a.join("")}function eL(t,e){var r=[],a=!1;return t.replace(Is,function(s){var l=Nr(s);switch(Cl(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function tL(t){var e=[Tn,Lt("personList",null,{xmlns:Kn.TCMNT,"xmlns:x":Dd[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,a){e.push(Lt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function rL(t){var e={};e.iauthor=t.read_shift(4);var r=Md(t);return e.rfx=r.s,e.ref=Sr(r.s),t.l+=16,e}function aL(t,e){return e==null&&(e=ft(36)),e.write_shift(4,t[1].iauthor),bh(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var nL=Ps;function sL(t){return os(t.slice(0,54))}function iL(t,e){var r=[],a=[],n={},s=!1;return Sc(t,function(c,d,f){switch(f){case 632:a.push(c);break;case 635:n=c;break;case 637:n.t=c.t,n.h=c.h,n.r=c.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,e.sheetRows&&n.rfx&&e.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}function oL(t){var e=hi(),r=[];return bt(e,628),bt(e,630),t.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),bt(e,632,sL(n.a)))})}),bt(e,631),bt(e,633),t.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var s={s:an(a[0]),e:an(a[0])};bt(e,635,aL([s,n])),n.t&&n.t.length>0&&bt(e,637,CO(n)),bt(e,636),delete n.iauthor})}),bt(e,634),bt(e,629),e.end()}var lL="application/vnd.ms-office.vbaProject";function cL(t){var e=pr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");pr.utils.cfb_add(e,n,t.FileIndex[a].content)}}),pr.write(e)}function uL(t,e){e.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&pr.utils.cfb_add(t,n,e.FileIndex[a].content)}})}var U3=["xlsb","xlsm","xlam","biff8","xla"];function dL(){return{"!type":"dialog"}}function fL(){return{"!type":"dialog"}}function hL(){return{"!type":"macro"}}function mL(){return{"!type":"macro"}}var rh=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(a,n,s,l){var c=!1,d=!1;s.length==0?d=!0:s.charAt(0)=="["&&(d=!0,s=s.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return c?m+=e.c:--m,d?f+=e.r:--f,n+(c?"":"$")+rn(m)+(d?"":"$")+Cn(f)}return function(n,s){return e=s,n.replace(t,r)}})(),P2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,M2=(function(){return function(e,r){return e.replace(P2,function(a,n,s,l,c,d){var f=S2(l)-(s?0:r.c),m=w2(d)-(c?0:r.r),v=m==0?"":c?m+1:"["+m+"]",x=f==0?"":s?f+1:"["+f+"]";return n+"R"+v+"C"+x})}})();function q3(t,e){return t.replace(P2,function(r,a,n,s,l,c){return a+(n=="$"?n+s:rn(S2(s)+e.c))+(l=="$"?l+c:Cn(w2(c)+e.r))})}function pL(t,e,r){var a=mi(e),n=a.s,s=an(r),l={r:s.r-n.r,c:s.c-n.c};return q3(t,l)}function gL(t){return t.length!=1}function o5(t){return t.replace(/_xlfn\./g,"")}function Pn(t){t.l+=1}function _u(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function z3(t,e,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return H3(t);r.biff==12&&(a=4)}var n=t.read_shift(a),s=t.read_shift(a),l=_u(t),c=_u(t);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function H3(t){var e=_u(t),r=_u(t),a=t.read_shift(1),n=t.read_shift(1);return{s:{r:e[0],c:a,cRel:e[1],rRel:e[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function vL(t,e,r){if(r.biff<8)return H3(t);var a=t.read_shift(r.biff==12?4:2),n=t.read_shift(r.biff==12?4:2),s=_u(t),l=_u(t);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function $3(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return xL(t);var a=t.read_shift(r&&r.biff==12?4:2),n=_u(t);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function xL(t){var e=_u(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function yL(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function _L(t,e,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return bL(t);var n=t.read_shift(a>=12?4:2),s=t.read_shift(2),l=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;n>524287;)n-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:l,rRel:c}}function bL(t){var e=t.read_shift(2),r=t.read_shift(1),a=(e&32768)>>15,n=(e&16384)>>14;return e&=16383,a==1&&e>=8192&&(e=e-16384),n==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:n,rRel:a}}function wL(t,e,r){var a=(t[t.l++]&96)>>5,n=z3(t,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function SL(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var l=z3(t,s,r);return[a,n,l]}function NL(t,e,r){var a=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function jL(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[a,n]}function kL(t,e,r){var a=(t[t.l++]&96)>>5,n=vL(t,e-1,r);return[a,n]}function EL(t,e,r){var a=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[a]}function l5(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function AL(t,e,r){t.l+=2;for(var a=t.read_shift(r&&r.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(t.read_shift(r&&r.biff==2?1:2));return n}function CL(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function TL(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function OL(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function RL(t,e,r){var a=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[a]}function W3(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function DL(t){return t.read_shift(2),W3(t)}function FL(t){return t.read_shift(2),W3(t)}function LL(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=$3(t,0,r);return[a,n]}function PL(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=_L(t,0,r);return[a,n]}function ML(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=$3(t,0,r);return[a,n,s]}function IL(t,e,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(r&&r.biff<=3?1:2);return[qP[n],Y3[n],a]}function BL(t,e,r){var a=t[t.l++],n=t.read_shift(1),s=r&&r.biff<=3?[a==88?-1:0,t.read_shift(1)]:UL(t);return[n,(s[0]===0?Y3:UP)[s[1]]]}function UL(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function qL(t,e,r){t.l+=r&&r.biff==2?3:4}function zL(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var a=t.read_shift(2),n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function HL(t){return t.l++,Nc[t.read_shift(1)]}function $L(t){return t.l++,t.read_shift(2)}function WL(t){return t.l++,t.read_shift(1)!==0}function VL(t){return t.l++,Ls(t)}function GL(t,e,r){return t.l++,rm(t,e-1,r)}function YL(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Sn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Nc[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Ls(t);break;case 2:r[1]=Id(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function XL(t,e,r){for(var a=t.read_shift(r.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((r.biff==12?Md:j1)(t));return n}function KL(t,e,r){var a=0,n=0;r.biff==12?(a=t.read_shift(4),n=t.read_shift(4)):(n=1+t.read_shift(1),a=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var s=0,l=[];s!=a&&(l[s]=[]);++s)for(var c=0;c!=n;++c)l[s][c]=YL(t,r.biff);return l}function JL(t,e,r){var a=t.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=t.read_shift(n);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[a,0,s]}function ZL(t,e,r){if(r.biff==5)return QL(t);var a=t.read_shift(1)>>>5&3,n=t.read_shift(2),s=t.read_shift(4);return[a,n,s]}function QL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var a=t.read_shift(2);return t.l+=12,[e,r,a]}function eP(t,e,r){var a=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function tP(t,e,r){var a=t.read_shift(1)>>>5&3,n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function rP(t,e,r){var a=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[a]}function aP(t,e,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[a,n]}var nP=Ms,sP=Ms,iP=Ms;function nm(t,e,r){return t.l+=2,[yL(t)]}function I2(t){return t.l+=6,[]}var oP=nm,lP=I2,cP=I2,uP=nm;function V3(t){return t.l+=2,[In(t),t.read_shift(2)&1]}var dP=nm,fP=V3,hP=I2,mP=nm,pP=nm,gP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function vP(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n=t.read_shift(2),s=t.read_shift(2),l=gP[r>>2&31];return{ixti:e,coltype:r&3,rt:l,idx:a,c:n,C:s}}function xP(t){return t.l+=2,[t.read_shift(4)]}function yP(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function _P(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function bP(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function wP(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function SP(t){return t.l+=4,[0,0]}var c5={1:{n:"PtgExp",f:zL},2:{n:"PtgTbl",f:iP},3:{n:"PtgAdd",f:Pn},4:{n:"PtgSub",f:Pn},5:{n:"PtgMul",f:Pn},6:{n:"PtgDiv",f:Pn},7:{n:"PtgPower",f:Pn},8:{n:"PtgConcat",f:Pn},9:{n:"PtgLt",f:Pn},10:{n:"PtgLe",f:Pn},11:{n:"PtgEq",f:Pn},12:{n:"PtgGe",f:Pn},13:{n:"PtgGt",f:Pn},14:{n:"PtgNe",f:Pn},15:{n:"PtgIsect",f:Pn},16:{n:"PtgUnion",f:Pn},17:{n:"PtgRange",f:Pn},18:{n:"PtgUplus",f:Pn},19:{n:"PtgUminus",f:Pn},20:{n:"PtgPercent",f:Pn},21:{n:"PtgParen",f:Pn},22:{n:"PtgMissArg",f:Pn},23:{n:"PtgStr",f:GL},26:{n:"PtgSheet",f:yP},27:{n:"PtgEndSheet",f:_P},28:{n:"PtgErr",f:HL},29:{n:"PtgBool",f:WL},30:{n:"PtgInt",f:$L},31:{n:"PtgNum",f:VL},32:{n:"PtgArray",f:EL},33:{n:"PtgFunc",f:IL},34:{n:"PtgFuncVar",f:BL},35:{n:"PtgName",f:JL},36:{n:"PtgRef",f:LL},37:{n:"PtgArea",f:wL},38:{n:"PtgMemArea",f:eP},39:{n:"PtgMemErr",f:nP},40:{n:"PtgMemNoMem",f:sP},41:{n:"PtgMemFunc",f:tP},42:{n:"PtgRefErr",f:rP},43:{n:"PtgAreaErr",f:NL},44:{n:"PtgRefN",f:PL},45:{n:"PtgAreaN",f:kL},46:{n:"PtgMemAreaN",f:bP},47:{n:"PtgMemNoMemN",f:wP},57:{n:"PtgNameX",f:ZL},58:{n:"PtgRef3d",f:ML},59:{n:"PtgArea3d",f:SL},60:{n:"PtgRefErr3d",f:aP},61:{n:"PtgAreaErr3d",f:jL},255:{}},NP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},jP={1:{n:"PtgElfLel",f:V3},2:{n:"PtgElfRw",f:mP},3:{n:"PtgElfCol",f:oP},6:{n:"PtgElfRwV",f:pP},7:{n:"PtgElfColV",f:uP},10:{n:"PtgElfRadical",f:dP},11:{n:"PtgElfRadicalS",f:hP},13:{n:"PtgElfColS",f:lP},15:{n:"PtgElfColSV",f:cP},16:{n:"PtgElfRadicalLel",f:fP},25:{n:"PtgList",f:vP},29:{n:"PtgSxName",f:xP},255:{}},kP={0:{n:"PtgAttrNoop",f:SP},1:{n:"PtgAttrSemi",f:RL},2:{n:"PtgAttrIf",f:TL},4:{n:"PtgAttrChoose",f:AL},8:{n:"PtgAttrGoto",f:CL},16:{n:"PtgAttrSum",f:qL},32:{n:"PtgAttrBaxcel",f:l5},33:{n:"PtgAttrBaxcel",f:l5},64:{n:"PtgAttrSpace",f:DL},65:{n:"PtgAttrSpaceSemi",f:FL},128:{n:"PtgAttrIfError",f:OL},255:{}};function sm(t,e,r,a){if(a.biff<8)return Ms(t,e);for(var n=t.l+e,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=KL(t,0,a),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=XL(t,r[l][1],a),s.push(r[l][2]);break;case"PtgExp":a&&a.biff==12&&(r[l][1][1]=t.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return e=n-t.l,e!==0&&s.push(Ms(t,e)),s}function im(t,e,r){for(var a=t.l+e,n,s,l=[];a!=t.l;)e=a-t.l,s=t[t.l],n=c5[s]||c5[NP[s]],(s===24||s===25)&&(n=(s===24?jP:kP)[t[t.l+1]]),!n||!n.f?Ms(t,e):l.push([n.n,n.f(t,e,r)]);return l}function EP(t){for(var e=[],r=0;r<t.length;++r){for(var a=t[r],n=[],s=0;s<a.length;++s){var l=a[s];if(l)switch(l[0]){case 2:n.push('"'+l[1].replace(/"/g,'""')+'"');break;default:n.push(l[1])}else n.push("")}e.push(n.join(","))}return e.join(";")}var AP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function CP(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function G3(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var a=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(t[a[0]][0]){case 357:return n=a[1]==-1?"#REF":t.SheetNames[a[1]],a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[a[0]][0];case 355:default:return"SH33TJSSRC"+t[a[0]][0]}switch(t[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":t.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 14849:return t[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[a[0]][0][3]?(n=a[1]==-1?"#REF":t[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+t[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function u5(t,e,r){var a=G3(t,e,r);return a=="#REF"?a:CP(a,r)}function Ds(t,e,r,a,n){var s=n&&n.biff||8,l={s:{c:0,r:0}},c=[],d,f,m,v=0,x=0,g,b="";if(!t[0]||!t[0][0])return"";for(var _=-1,w="",E=0,C=t[0].length;E<C;++E){var A=t[0][E];switch(A[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=c.pop(),f=c.pop(),_>=0){switch(t[0][_][1][0]){case 0:w=pn(" ",t[0][_][1][1]);break;case 1:w=pn("\r",t[0][_][1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}f=f+w,_=-1}c.push(f+AP[A[0]]+d);break;case"PtgIsect":d=c.pop(),f=c.pop(),c.push(f+" "+d);break;case"PtgUnion":d=c.pop(),f=c.pop(),c.push(f+","+d);break;case"PtgRange":d=c.pop(),f=c.pop(),c.push(f+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=y0(A[1][1],l,n),c.push(_0(m,s));break;case"PtgRefN":m=r?y0(A[1][1],r,n):A[1][1],c.push(_0(m,s));break;case"PtgRef3d":v=A[1][1],m=y0(A[1][2],l,n),b=u5(a,v,n),c.push(b+"!"+_0(m,s));break;case"PtgFunc":case"PtgFuncVar":var O=A[1][0],G=A[1][1];O||(O=0),O&=127;var W=O==0?[]:c.slice(-O);c.length-=O,G==="User"&&(G=W.shift()),c.push(G+"("+W.join(",")+")");break;case"PtgBool":c.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(A[1]);break;case"PtgNum":c.push(String(A[1]));break;case"PtgStr":c.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(A[1]);break;case"PtgAreaN":g=Bw(A[1][1],r?{s:r}:l,n),c.push(uv(g,n));break;case"PtgArea":g=Bw(A[1][1],l,n),c.push(uv(g,n));break;case"PtgArea3d":v=A[1][1],g=A[1][2],b=u5(a,v,n),c.push(b+"!"+uv(g,n));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=A[1][2];var B=(a.names||[])[x-1]||(a[0]||[])[x],q=B?B.Name:"SH33TJSNAME"+String(x);q&&q.slice(0,6)=="_xlfn."&&!n.xlfn&&(q=q.slice(6)),c.push(q);break;case"PtgNameX":var L=A[1][1];x=A[1][2];var Z;if(n.biff<=5)L<0&&(L=-L),a[L]&&(Z=a[L][x]);else{var D="";if(((a[L]||[])[0]||[])[0]==14849||(((a[L]||[])[0]||[])[0]==1025?a[L][x]&&a[L][x].itab>0&&(D=a.SheetNames[a[L][x].itab-1]+"!"):D=a.SheetNames[x-1]+"!"),a[L]&&a[L][x])D+=a[L][x].Name;else if(a[0]&&a[0][x])D+=a[0][x].Name;else{var T=(G3(a,L,n)||"").split(";;");T[x-1]?D=T[x-1]:D+="SH33TJSERRX"}c.push(D);break}Z||(Z={Name:"SH33TJSERRY"}),c.push(Z.Name);break;case"PtgParen":var M="(",V=")";if(_>=0){switch(w="",t[0][_][1][0]){case 2:M=pn(" ",t[0][_][1][1])+M;break;case 3:M=pn("\r",t[0][_][1][1])+M;break;case 4:V=pn(" ",t[0][_][1][1])+V;break;case 5:V=pn("\r",t[0][_][1][1])+V;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}_=-1}c.push(M+c.pop()+V);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":m={c:A[1][1],r:A[1][0]};var ie={c:r.c,r:r.r};if(a.sharedf[Sr(m)]){var X=a.sharedf[Sr(m)];c.push(Ds(X,l,ie,a,n))}else{var J=!1;for(d=0;d!=a.arrayf.length;++d)if(f=a.arrayf[d],!(m.c<f[0].s.c||m.c>f[0].e.c)&&!(m.r<f[0].s.r||m.r>f[0].e.r)){c.push(Ds(f[1],l,ie,a,n)),J=!0;break}J||c.push(A[1])}break;case"PtgArray":c.push("{"+EP(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&_>=0&&K.indexOf(t[0][E][0])==-1){A=t[0][_];var te=!0;switch(A[1][0]){case 4:te=!1;case 0:w=pn(" ",A[1][1]);break;case 5:te=!1;case 1:w=pn("\r",A[1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}c.push((te?w:"")+c.pop()+(te?"":w)),_=-1}}if(c.length>1&&n.WTF)throw new Error("bad formula stack");return c[0]}function TP(t,e,r){var a=t.l+e,n=r.biff==2?1:2,s,l=t.read_shift(n);if(l==65535)return[[],Ms(t,e-2)];var c=im(t,l,r);return e!==l+n&&(s=sm(t,e-l-n,c,r)),t.l=a,[c,s]}function OP(t,e,r){var a=t.l+e,n=r.biff==2?1:2,s,l=t.read_shift(n);if(l==65535)return[[],Ms(t,e-2)];var c=im(t,l,r);return e!==l+n&&(s=sm(t,e-l-n,c,r)),t.l=a,[c,s]}function RP(t,e,r,a){var n=t.l+e,s=im(t,a,r),l;return n!==t.l&&(l=sm(t,n-t.l,s,r)),[s,l]}function DP(t,e,r){var a=t.l+e,n,s=t.read_shift(2),l=im(t,s,r);return s==65535?[[],Ms(t,e-2)]:(e!==s+2&&(n=sm(t,a-s-2,l,r)),[l,n])}function FP(t){var e;if(dc(t,t.l+6)!==65535)return[Ls(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function LP(t){if(t==null){var e=ft(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Nd(t);return Nd(0)}function pv(t,e,r){var a=t.l+e,n=Tl(t);r.biff==2&&++t.l;var s=FP(t),l=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var c=OP(t,a-t.l,r);return{cell:n,val:s[0],formula:c,shared:l>>3&1,tt:s[1]}}function PP(t,e,r,a,n){var s=kd(e,r,n),l=LP(t.v),c=ft(6),d=33;c.write_shift(2,d),c.write_shift(4,0);for(var f=ft(t.bf.length),m=0;m<t.bf.length;++m)f[m]=t.bf[m];var v=is([s,l,c,f]);return v}function k1(t,e,r){var a=t.read_shift(4),n=im(t,a,r),s=t.read_shift(4),l=s>0?sm(t,s,n,r):null;return[n,l]}var MP=k1,E1=k1,IP=k1,BP=k1,UP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Y3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},qP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function d5(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function zP(t){var e="of:="+t.replace(P2,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function gv(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function HP(t){return t.replace(/\./,"!")}var w0={},ah={},S0=typeof Map<"u";function B2(t,e,r){var a=0,n=t.length;if(r){if(S0?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=S0?r.get(e):r[e];a<s.length;++a)if(t[s[a]].t===e)return t.Count++,s[a]}}else for(;a<n;++a)if(t[a].t===e)return t.Count++,a;return t[n]={t:e},t.Count++,t.Unique++,r&&(S0?(r.has(e)||r.set(e,[]),r.get(e).push(n)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(n))),n}function A1(t,e){var r={min:t+1,max:t+1},a=-1;return e.MDW&&(Fs=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?a=$0(e.wpx):e.wch!=null&&(a=e.wch),a>-1?(r.width=o1(a),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function _d(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function ku(t,e,r){var a=r.revssf[e.z!=null?e.z:"General"],n=60,s=t.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){pc(e.z,n),r.ssf[n]=e.z,r.revssf[e.z]=a=n;break}}for(n=0;n!=s;++n)if(t[n].numFmtId===a)return n;return t[s]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function X3(t,e,r,a,n,s){try{a.cellNF&&(t.z=wr[e])}catch(c){if(a.WTF)throw c}if(!(t.t==="z"&&!a.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Ha(t.v)),(!a||a.cellText!==!1)&&t.t!=="z")try{if(wr[e]==null&&pc(U8[e]||"General",e),t.t==="e")t.w=t.w||Nc[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=M0(t.v);else if(t.t==="d"){var l=Jn(t.v);(l|0)===l?t.w=l.toString(10):t.w=M0(l)}else{if(t.v===void 0)return"";t.w=wd(t.v,ah)}else t.t==="d"?t.w=mo(e,Jn(t.v),ah):t.w=mo(e,t.v,ah)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=i1(n.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),a.WTF&&(t.s.fgColor.raw_rgb=n.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=i1(n.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),a.WTF&&(t.s.bgColor.raw_rgb=n.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&s.Fills)throw c}}}function $P(t,e,r){if(t&&t["!ref"]){var a=aa(t["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function WP(t,e){var r=aa(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Rr(r))}var VP=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,GP=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,YP=/<(?:\w:)?hyperlink [^>]*>/mg,XP=/"(\w*:\w*)"/,KP=/<(?:\w:)?col\b[^>]*[\/]?>/g,JP=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,ZP=/<(?:\w:)?pageMargins[^>]*\/>/g,K3=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,QP=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,eM=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function tM(t,e,r,a,n,s,l){if(!t)return t;a||(a={"!id":{}});var c=e.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",m="",v=t.match(GP);v?(f=t.slice(0,v.index),m=t.slice(v.index+v[0].length)):f=m=t;var x=f.match(K3);x?U2(x[0],c,n,r):(x=f.match(QP))&&aM(x[0],x[1]||"",c,n,r);var g=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var b=f.slice(g,g+50).match(XP);b&&WP(c,b[1])}var _=f.match(eM);_&&_[1]&&gM(_[1],n);var w=[];if(e.cellStyles){var E=f.match(KP);E&&dM(w,E)}v&&yM(v[1],c,e,d,s,l);var C=m.match(JP);C&&(c["!autofilter"]=hM(C[0]));var A=[],O=m.match(VP);if(O)for(g=0;g!=O.length;++g)A[g]=aa(O[g].slice(O[g].indexOf('"')+1));var G=m.match(YP);G&&lM(c,G,a);var W=m.match(ZP);if(W&&(c["!margins"]=cM(Nr(W[0]))),!c["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(c["!ref"]=Rr(d)),e.sheetRows>0&&c["!ref"]){var B=aa(c["!ref"]);e.sheetRows<=+B.e.r&&(B.e.r=e.sheetRows-1,B.e.r>d.e.r&&(B.e.r=d.e.r),B.e.r<B.s.r&&(B.s.r=B.e.r),B.e.c>d.e.c&&(B.e.c=d.e.c),B.e.c<B.s.c&&(B.s.c=B.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Rr(B))}return w.length>0&&(c["!cols"]=w),A.length>0&&(c["!merges"]=A),c}function rM(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Rr(t[r])+'"/>';return e+"</mergeCells>"}function U2(t,e,r,a){var n=Nr(t);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=ra(ka(n.codeName)))}function aM(t,e,r,a,n){U2(t.slice(0,t.indexOf(">")),r,a,n)}function nM(t,e,r,a,n){var s=!1,l={},c=null;if(a.bookType!=="xlsx"&&e.vbaraw){var d=e.SheetNames[r];try{e.Workbook&&(d=e.Workbook.Sheets[r].CodeName||d)}catch{}s=!0,l.codeName=El(ya(d))}if(t&&t["!outline"]){var f={summaryBelow:1,summaryRight:1};t["!outline"].above&&(f.summaryBelow=0),t["!outline"].left&&(f.summaryRight=0),c=(c||"")+Lt("outlinePr",null,f)}!s&&!c||(n[n.length]=Lt("sheetPr",c,l))}var sM=["objects","scenarios","selectLockedCells","selectUnlockedCells"],iM=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function oM(t){var e={sheet:1};return sM.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),iM.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=D2(t.password).toString(16).toUpperCase()),Lt("sheetProtection",null,e)}function lM(t,e,r){for(var a=Array.isArray(t),n=0;n!=e.length;++n){var s=Nr(ka(e[n]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+ra(s.location))):(s.Target="#"+ra(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=aa(s.ref),d=c.s.r;d<=c.e.r;++d)for(var f=c.s.c;f<=c.e.c;++f){var m=Sr({c:f,r:d});a?(t[d]||(t[d]=[]),t[d][f]||(t[d][f]={t:"z",v:void 0}),t[d][f].l=s):(t[m]||(t[m]={t:"z",v:void 0}),t[m].l=s)}}}function cM(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function uM(t){return _d(t),Lt("pageMargins",null,t)}function dM(t,e){for(var r=!1,a=0;a!=e.length;++a){var n=Nr(e[a],!0);n.hidden&&(n.hidden=qa(n.hidden));var s=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,F2(n.width)),yu(n);s<=l;)t[s++]=$a(n)}}function fM(t,e){for(var r=["<cols>"],a,n=0;n!=e.length;++n)(a=e[n])&&(r[r.length]=Lt("col",null,A1(n,a)));return r[r.length]="</cols>",r.join("")}function hM(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function mM(t,e,r,a){var n=typeof t.ref=="string"?t.ref:Rr(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=mi(n);l.s.r==l.e.r&&(l.e.r=mi(e["!ref"]).e.r,n=Rr(l));for(var c=0;c<s.length;++c){var d=s[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Lt("autoFilter",null,{ref:n})}var pM=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function gM(t,e){e.Views||(e.Views=[{}]),(t.match(pM)||[]).forEach(function(r,a){var n=Nr(r);e.Views[a]||(e.Views[a]={}),+n.zoomScale&&(e.Views[a].zoom=+n.zoomScale),qa(n.rightToLeft)&&(e.Views[a].RTL=!0)})}function vM(t,e,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Lt("sheetViews",Lt("sheetView",null,n),{})}function xM(t,e,r,a){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var n="",s=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":n=t.v?"1":"0";break;case"n":n=""+t.v;break;case"e":n=Nc[t.v];break;case"d":a&&a.cellDates?n=Ha(t.v,-1).toISOString():(t=$a(t),t.t="n",n=""+(t.v=Jn(Ha(t.v)))),typeof t.z>"u"&&(t.z=wr[14]);break;default:n=t.v;break}var c=_s("v",ya(n)),d={r:e},f=ku(a.cellXfs,t,a);switch(f!==0&&(d.s=f),t.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){c=_s("v",""+B2(a.Strings,t.v,a.revStrings)),d.t="s";break}d.t="str";break}if(t.t!=s&&(t.t=s,t.v=l),typeof t.f=="string"&&t.f){var m=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;c=Lt("f",ya(t.f),m)+(t.v!=null?c:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(d.cm=1),Lt("c",c,d)}var yM=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=I0("v"),l=I0("f");return function(d,f,m,v,x,g){for(var b=0,_="",w=[],E=[],C=0,A=0,O=0,G="",W,B,q=0,L=0,Z,D,T=0,M=0,V=Array.isArray(g.CellXf),ie,X=[],J=[],K=Array.isArray(f),te=[],fe={},U=!1,j=!!m.sheetStubs,F=d.split(e),I=0,z=F.length;I!=z;++I){_=F[I].trim();var ne=_.length;if(ne!==0){var se=0;e:for(b=0;b<ne;++b)switch(_[b]){case">":if(_[b-1]!="/"){++b;break e}if(m&&m.cellStyles){if(B=Nr(_.slice(se,b),!0),q=B.r!=null?parseInt(B.r,10):q+1,L=-1,m.sheetRows&&m.sheetRows<q)continue;fe={},U=!1,B.ht&&(U=!0,fe.hpt=parseFloat(B.ht),fe.hpx=fh(fe.hpt)),B.hidden=="1"&&(U=!0,fe.hidden=!0),B.outlineLevel!=null&&(U=!0,fe.level=+B.outlineLevel),U&&(te[q-1]=fe)}break;case"<":se=b;break}if(se>=b)break;if(B=Nr(_.slice(se,b),!0),q=B.r!=null?parseInt(B.r,10):q+1,L=-1,!(m.sheetRows&&m.sheetRows<q)){v.s.r>q-1&&(v.s.r=q-1),v.e.r<q-1&&(v.e.r=q-1),m&&m.cellStyles&&(fe={},U=!1,B.ht&&(U=!0,fe.hpt=parseFloat(B.ht),fe.hpx=fh(fe.hpt)),B.hidden=="1"&&(U=!0,fe.hidden=!0),B.outlineLevel!=null&&(U=!0,fe.level=+B.outlineLevel),U&&(te[q-1]=fe)),w=_.slice(b).split(t);for(var je=0;je!=w.length&&w[je].trim().charAt(0)=="<";++je);for(w=w.slice(je),b=0;b!=w.length;++b)if(_=w[b].trim(),_.length!==0){if(E=_.match(r),C=b,A=0,O=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,E!=null&&E.length===2){for(C=0,G=E[1],A=0;A!=G.length&&!((O=G.charCodeAt(A)-64)<1||O>26);++A)C=26*C+O;--C,L=C}else++L;for(A=0;A!=_.length&&_.charCodeAt(A)!==62;++A);if(++A,B=Nr(_.slice(0,A),!0),B.r||(B.r=Sr({r:q-1,c:L})),G=_.slice(A),W={t:""},(E=G.match(s))!=null&&E[1]!==""&&(W.v=ra(E[1])),m.cellFormula){if((E=G.match(l))!=null&&E[1]!==""){if(W.f=ra(ka(E[1])).replace(/\r\n/g,`
`),m.xlfn||(W.f=o5(W.f)),E[0].indexOf('t="array"')>-1)W.F=(G.match(n)||[])[1],W.F.indexOf(":")>-1&&X.push([aa(W.F),W.F]);else if(E[0].indexOf('t="shared"')>-1){D=Nr(E[0]);var Ne=ra(ka(E[1]));m.xlfn||(Ne=o5(Ne)),J[parseInt(D.si,10)]=[D,Ne,B.r]}}else(E=G.match(/<f[^>]*\/>/))&&(D=Nr(E[0]),J[D.si]&&(W.f=pL(J[D.si][1],J[D.si][2],B.r)));var ge=an(B.r);for(A=0;A<X.length;++A)ge.r>=X[A][0].s.r&&ge.r<=X[A][0].e.r&&ge.c>=X[A][0].s.c&&ge.c<=X[A][0].e.c&&(W.F=X[A][1])}if(B.t==null&&W.v===void 0)if(W.f||W.F)W.v=0,W.t="n";else if(j)W.t="z";else continue;else W.t=B.t||"n";switch(v.s.c>L&&(v.s.c=L),v.e.c<L&&(v.e.c=L),W.t){case"n":if(W.v==""||W.v==null){if(!j)continue;W.t="z"}else W.v=parseFloat(W.v);break;case"s":if(typeof W.v>"u"){if(!j)continue;W.t="z"}else Z=w0[parseInt(W.v,10)],W.v=Z.t,W.r=Z.r,m.cellHTML&&(W.h=Z.h);break;case"str":W.t="s",W.v=W.v!=null?ka(W.v):"",m.cellHTML&&(W.h=x2(W.v));break;case"inlineStr":E=G.match(a),W.t="s",E!=null&&(Z=R2(E[1]))?(W.v=Z.t,m.cellHTML&&(W.h=Z.h)):W.v="";break;case"b":W.v=qa(W.v);break;case"d":m.cellDates?W.v=Ha(W.v,1):(W.v=Jn(Ha(W.v,1)),W.t="n");break;case"e":(!m||m.cellText!==!1)&&(W.w=W.v),W.v=ZN[W.v];break}if(T=M=0,ie=null,V&&B.s!==void 0&&(ie=g.CellXf[B.s],ie!=null&&(ie.numFmtId!=null&&(T=ie.numFmtId),m.cellStyles&&ie.fillId!=null&&(M=ie.fillId))),X3(W,T,M,m,x,g),m.cellDates&&V&&W.t=="n"&&xh(wr[T])&&(W.t="d",W.v=N1(W.v)),B.cm&&m.xlmeta){var Ie=(m.xlmeta.Cell||[])[+B.cm-1];Ie&&Ie.type=="XLDAPR"&&(W.D=!0)}if(K){var le=an(B.r);f[le.r]||(f[le.r]=[]),f[le.r][le.c]=W}else f[B.r]=W}}}}te.length>0&&(f["!rows"]=te)}})();function _M(t,e,r,a){var n=[],s=[],l=aa(t["!ref"]),c="",d,f="",m=[],v=0,x=0,g=t["!rows"],b=Array.isArray(t),_={r:f},w,E=-1;for(x=l.s.c;x<=l.e.c;++x)m[x]=rn(x);for(v=l.s.r;v<=l.e.r;++v){for(s=[],f=Cn(v),x=l.s.c;x<=l.e.c;++x){d=m[x]+f;var C=b?(t[v]||[])[x]:t[d];C!==void 0&&(c=xM(C,d,t,e))!=null&&s.push(c)}(s.length>0||g&&g[v])&&(_={r:f},g&&g[v]&&(w=g[v],w.hidden&&(_.hidden=1),E=-1,w.hpx?E=W0(w.hpx):w.hpt&&(E=w.hpt),E>-1&&(_.ht=E,_.customHeight=1),w.level&&(_.outlineLevel=w.level)),n[n.length]=Lt("row",s.join(""),_))}if(g)for(;v<g.length;++v)g&&g[v]&&(_={r:v+1},w=g[v],w.hidden&&(_.hidden=1),E=-1,w.hpx?E=W0(w.hpx):w.hpt&&(E=w.hpt),E>-1&&(_.ht=E,_.customHeight=1),w.level&&(_.outlineLevel=w.level),n[n.length]=Lt("row","",_));return n.join("")}function J3(t,e,r,a){var n=[Tn,Lt("worksheet",null,{xmlns:Dd[0],"xmlns:r":Kn.r})],s=r.SheetNames[t],l=0,c="",d=r.Sheets[s];d==null&&(d={});var f=d["!ref"]||"A1",m=aa(f);if(m.e.c>16383||m.e.r>1048575){if(e.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),f=Rr(m)}a||(a={}),d["!comments"]=[];var v=[];nM(d,r,t,e,n),n[n.length]=Lt("dimension",null,{ref:f}),n[n.length]=vM(d,e,t,r),e.sheetFormat&&(n[n.length]=Lt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(n[n.length]=fM(d,d["!cols"])),n[l=n.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(c=_M(d,e),c.length>0&&(n[n.length]=c)),n.length>l+1&&(n[n.length]="</sheetData>",n[l]=n[l].replace("/>",">")),d["!protect"]&&(n[n.length]=oM(d["!protect"])),d["!autofilter"]!=null&&(n[n.length]=mM(d["!autofilter"],d,r,t)),d["!merges"]!=null&&d["!merges"].length>0&&(n[n.length]=rM(d["!merges"]));var x=-1,g,b=-1;return d["!links"].length>0&&(n[n.length]="<hyperlinks>",d["!links"].forEach(function(_){_[1].Target&&(g={ref:_[0]},_[1].Target.charAt(0)!="#"&&(b=va(a,-1,ya(_[1].Target).replace(/#.*$/,""),Ur.HLINK),g["r:id"]="rId"+b),(x=_[1].Target.indexOf("#"))>-1&&(g.location=ya(_[1].Target.slice(x+1))),_[1].Tooltip&&(g.tooltip=ya(_[1].Tooltip)),n[n.length]=Lt("hyperlink",null,g))}),n[n.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(n[n.length]=uM(d["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(n[n.length]=_s("ignoredErrors",Lt("ignoredError",null,{numberStoredAsText:1,sqref:f}))),v.length>0&&(b=va(a,-1,"../drawings/drawing"+(t+1)+".xml",Ur.DRAW),n[n.length]=Lt("drawing",null,{"r:id":"rId"+b}),d["!drawing"]=v),d["!comments"].length>0&&(b=va(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ur.VML),n[n.length]=Lt("legacyDrawing",null,{"r:id":"rId"+b}),d["!legacy"]=b),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function bM(t,e){var r={},a=t.l+e;r.r=t.read_shift(4),t.l+=4;var n=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=a,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=n/20),r}function wM(t,e,r){var a=ft(145),n=(r["!rows"]||[])[t]||{};a.write_shift(4,t),a.write_shift(4,0);var s=320;n.hpx?s=W0(n.hpx)*20:n.hpt&&(s=n.hpt*20),a.write_shift(2,s),a.write_shift(1,0);var l=0;n.level&&(l|=n.level),n.hidden&&(l|=16),(n.hpx||n.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var c=0,d=a.l;a.l+=4;for(var f={r:t,c:0},m=0;m<16;++m)if(!(e.s.c>m+1<<10||e.e.c<m<<10)){for(var v=-1,x=-1,g=m<<10;g<m+1<<10;++g){f.c=g;var b=Array.isArray(r)?(r[f.r]||[])[f.c]:r[Sr(f)];b&&(v<0&&(v=g),x=g)}v<0||(++c,a.write_shift(4,v),a.write_shift(4,x))}var _=a.l;return a.l=d,a.write_shift(4,c),a.l=_,a.length>a.l?a.slice(0,a.l):a}function SM(t,e,r,a){var n=wM(a,r,e);(n.length>17||(e["!rows"]||[])[a])&&bt(t,0,n)}var NM=Md,jM=bh;function kM(){}function EM(t,e){var r={},a=t[t.l];return++t.l,r.above=!(a&64),r.left=!(a&128),t.l+=18,r.name=TO(t),r}function AM(t,e,r){r==null&&(r=ft(84+4*t.length));var a=192;e&&(e.above&&(a&=-65),e.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return a1({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),GN(t,r),r.slice(0,r.l)}function CM(t){var e=go(t);return[e]}function TM(t,e,r){return r==null&&(r=ft(8)),Fd(e,r)}function OM(t){var e=Ld(t);return[e]}function RM(t,e,r){return r==null&&(r=ft(4)),Pd(e,r)}function DM(t){var e=go(t),r=t.read_shift(1);return[e,r,"b"]}function FM(t,e,r){return r==null&&(r=ft(9)),Fd(e,r),r.write_shift(1,t.v?1:0),r}function LM(t){var e=Ld(t),r=t.read_shift(1);return[e,r,"b"]}function PM(t,e,r){return r==null&&(r=ft(5)),Pd(e,r),r.write_shift(1,t.v?1:0),r}function MM(t){var e=go(t),r=t.read_shift(1);return[e,r,"e"]}function IM(t,e,r){return r==null&&(r=ft(9)),Fd(e,r),r.write_shift(1,t.v),r}function BM(t){var e=Ld(t),r=t.read_shift(1);return[e,r,"e"]}function UM(t,e,r){return r==null&&(r=ft(8)),Pd(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function qM(t){var e=go(t),r=t.read_shift(4);return[e,r,"s"]}function zM(t,e,r){return r==null&&(r=ft(12)),Fd(e,r),r.write_shift(4,e.v),r}function HM(t){var e=Ld(t),r=t.read_shift(4);return[e,r,"s"]}function $M(t,e,r){return r==null&&(r=ft(8)),Pd(e,r),r.write_shift(4,e.v),r}function WM(t){var e=go(t),r=Ls(t);return[e,r,"n"]}function VM(t,e,r){return r==null&&(r=ft(16)),Fd(e,r),Nd(t.v,r),r}function Z3(t){var e=Ld(t),r=Ls(t);return[e,r,"n"]}function GM(t,e,r){return r==null&&(r=ft(12)),Pd(e,r),Nd(t.v,r),r}function YM(t){var e=go(t),r=E2(t);return[e,r,"n"]}function XM(t,e,r){return r==null&&(r=ft(12)),Fd(e,r),YN(t.v,r),r}function KM(t){var e=Ld(t),r=E2(t);return[e,r,"n"]}function JM(t,e,r){return r==null&&(r=ft(8)),Pd(e,r),YN(t.v,r),r}function ZM(t){var e=go(t),r=N2(t);return[e,r,"is"]}function QM(t){var e=go(t),r=Ps(t);return[e,r,"str"]}function e9(t,e,r){return r==null&&(r=ft(12+4*t.v.length)),Fd(e,r),os(t.v,r),r.length>r.l?r.slice(0,r.l):r}function t9(t){var e=Ld(t),r=Ps(t);return[e,r,"str"]}function r9(t,e,r){return r==null&&(r=ft(8+4*t.v.length)),Pd(e,r),os(t.v,r),r.length>r.l?r.slice(0,r.l):r}function a9(t,e,r){var a=t.l+e,n=go(t);n.r=r["!row"];var s=t.read_shift(1),l=[n,s,"b"];if(r.cellFormula){t.l+=2;var c=E1(t,a-t.l,r);l[3]=Ds(c,null,n,r.supbooks,r)}else t.l=a;return l}function n9(t,e,r){var a=t.l+e,n=go(t);n.r=r["!row"];var s=t.read_shift(1),l=[n,s,"e"];if(r.cellFormula){t.l+=2;var c=E1(t,a-t.l,r);l[3]=Ds(c,null,n,r.supbooks,r)}else t.l=a;return l}function s9(t,e,r){var a=t.l+e,n=go(t);n.r=r["!row"];var s=Ls(t),l=[n,s,"n"];if(r.cellFormula){t.l+=2;var c=E1(t,a-t.l,r);l[3]=Ds(c,null,n,r.supbooks,r)}else t.l=a;return l}function i9(t,e,r){var a=t.l+e,n=go(t);n.r=r["!row"];var s=Ps(t),l=[n,s,"str"];if(r.cellFormula){t.l+=2;var c=E1(t,a-t.l,r);l[3]=Ds(c,null,n,r.supbooks,r)}else t.l=a;return l}var o9=Md,l9=bh;function c9(t,e){return e==null&&(e=ft(4)),e.write_shift(4,t),e}function u9(t,e){var r=t.l+e,a=Md(t),n=j2(t),s=Ps(t),l=Ps(t),c=Ps(t);t.l=r;var d={rfx:a,relId:n,loc:s,display:c};return l&&(d.Tooltip=l),d}function d9(t,e){var r=ft(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));bh({s:an(t[0]),e:an(t[0])},r),k2("rId"+e,r);var a=t[1].Target.indexOf("#"),n=a==-1?"":t[1].Target.slice(a+1);return os(n||"",r),os(t[1].Tooltip||"",r),os("",r),r.slice(0,r.l)}function f9(){}function h9(t,e,r){var a=t.l+e,n=XN(t),s=t.read_shift(1),l=[n];if(l[2]=s,r.cellFormula){var c=MP(t,a-t.l,r);l[1]=c}else t.l=a;return l}function m9(t,e,r){var a=t.l+e,n=Md(t),s=[n];if(r.cellFormula){var l=BP(t,a-t.l,r);s[1]=l,t.l=a}else t.l=a;return s}function p9(t,e,r){r==null&&(r=ft(18));var a=A1(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return e.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),e.level&&(n|=e.level<<8),r.write_shift(2,n),r}var Q3=["left","right","top","bottom","header","footer"];function g9(t){var e={};return Q3.forEach(function(r){e[r]=Ls(t)}),e}function v9(t,e){return e==null&&(e=ft(48)),_d(t),Q3.forEach(function(r){Nd(t[r],e)}),e}function x9(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function y9(t,e,r){r==null&&(r=ft(30));var a=924;return(((e||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function _9(t){var e=ft(24);return e.write_shift(4,4),e.write_shift(4,1),bh(t,e),e}function b9(t,e){return e==null&&(e=ft(66)),e.write_shift(2,t.password?D2(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function w9(){}function S9(){}function N9(t,e,r,a,n,s,l){if(!t)return t;var c=e||{};a||(a={"!id":{}});var d=c.dense?[]:{},f,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,x=!1,g,b,_,w,E,C,A,O,G,W=[];c.biff=12,c["!row"]=0;var B=0,q=!1,L=[],Z={},D=c.supbooks||n.supbooks||[[]];if(D.sharedf=Z,D.arrayf=L,D.SheetNames=n.SheetNames||n.Sheets.map(function(K){return K.name}),!c.supbooks&&(c.supbooks=D,n.Names))for(var T=0;T<n.Names.length;++T)D[0][T+1]=n.Names[T];var M=[],V=[],ie=!1;V0[16]={n:"BrtShortReal",f:Z3};var X;if(Sc(t,function(te,fe,U){if(!x)switch(U){case 148:f=te;break;case 0:g=te,c.sheetRows&&c.sheetRows<=g.r&&(x=!0),O=Cn(w=g.r),c["!row"]=g.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=fh(te.hpt)),V[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:te[2]},te[2]){case"n":b.v=te[1];break;case"s":A=w0[te[1]],b.v=A.t,b.r=A.r;break;case"b":b.v=!!te[1];break;case"e":b.v=te[1],c.cellText!==!1&&(b.w=Nc[b.v]);break;case"str":b.t="s",b.v=te[1];break;case"is":b.t="s",b.v=te[1].t;break}if((_=l.CellXf[te[0].iStyleRef])&&X3(b,_.numFmtId,null,c,s,l),E=te[0].c==-1?E+1:te[0].c,c.dense?(d[w]||(d[w]=[]),d[w][E]=b):d[rn(E)+O]=b,c.cellFormula){for(q=!1,B=0;B<L.length;++B){var j=L[B];g.r>=j[0].s.r&&g.r<=j[0].e.r&&E>=j[0].s.c&&E<=j[0].e.c&&(b.F=Rr(j[0]),q=!0)}!q&&te.length>3&&(b.f=te[3])}if(m.s.r>g.r&&(m.s.r=g.r),m.s.c>E&&(m.s.c=E),m.e.r<g.r&&(m.e.r=g.r),m.e.c<E&&(m.e.c=E),c.cellDates&&_&&b.t=="n"&&xh(wr[_.numFmtId])){var F=gd(b.v);F&&(b.t="d",b.v=new Date(F.y,F.m-1,F.d,F.H,F.M,F.S,F.u))}X&&(X.type=="XLDAPR"&&(b.D=!0),X=void 0);break;case 1:case 12:if(!c.sheetStubs||v)break;b={t:"z",v:void 0},E=te[0].c==-1?E+1:te[0].c,c.dense?(d[w]||(d[w]=[]),d[w][E]=b):d[rn(E)+O]=b,m.s.r>g.r&&(m.s.r=g.r),m.s.c>E&&(m.s.c=E),m.e.r<g.r&&(m.e.r=g.r),m.e.c<E&&(m.e.c=E),X&&(X.type=="XLDAPR"&&(b.D=!0),X=void 0);break;case 176:W.push(te);break;case 49:X=((c.xlmeta||{}).Cell||[])[te-1];break;case 494:var I=a["!id"][te.relId];for(I?(te.Target=I.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=I):te.relId==""&&(te.Target="#"+te.loc),w=te.rfx.s.r;w<=te.rfx.e.r;++w)for(E=te.rfx.s.c;E<=te.rfx.e.c;++E)c.dense?(d[w]||(d[w]=[]),d[w][E]||(d[w][E]={t:"z",v:void 0}),d[w][E].l=te):(C=Sr({c:E,r:w}),d[C]||(d[C]={t:"z",v:void 0}),d[C].l=te);break;case 426:if(!c.cellFormula)break;L.push(te),G=c.dense?d[w][E]:d[rn(E)+O],G.f=Ds(te[1],m,{r:g.r,c:E},D,c),G.F=Rr(te[0]);break;case 427:if(!c.cellFormula)break;Z[Sr(te[0].s)]=te[1],G=c.dense?d[w][E]:d[rn(E)+O],G.f=Ds(te[1],m,{r:g.r,c:E},D,c);break;case 60:if(!c.cellStyles)break;for(;te.e>=te.s;)M[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},ie||(ie=!0,F2(te.w/256)),yu(M[te.e+1]);break;case 161:d["!autofilter"]={ref:Rr(te)};break;case 476:d["!margins"]=te;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),te.name&&(n.Sheets[r].CodeName=te.name),(te.above||te.left)&&(d["!outline"]={above:te.above,left:te.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),te.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!fe.T){if(!v||c.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},c),delete c.supbooks,delete c["!row"],!d["!ref"]&&(m.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(d["!ref"]=Rr(f||m)),c.sheetRows&&d["!ref"]){var J=aa(d["!ref"]);c.sheetRows<=+J.e.r&&(J.e.r=c.sheetRows-1,J.e.r>m.e.r&&(J.e.r=m.e.r),J.e.r<J.s.r&&(J.s.r=J.e.r),J.e.c>m.e.c&&(J.e.c=m.e.c),J.e.c<J.s.c&&(J.s.c=J.e.c),d["!fullref"]=d["!ref"],d["!ref"]=Rr(J))}return W.length>0&&(d["!merges"]=W),M.length>0&&(d["!cols"]=M),V.length>0&&(d["!rows"]=V),d}function j9(t,e,r,a,n,s,l){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=$a(e),e.z=e.z||wr[14],e.v=Jn(Ha(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var d={r,c:a};switch(d.s=ku(n.cellXfs,e,n),e.l&&s["!links"].push([Sr(d),e.l]),e.c&&s["!comments"].push([Sr(d),e.c]),e.t){case"s":case"str":return n.bookSST?(c=B2(n.Strings,e.v,n.revStrings),d.t="s",d.v=c,l?bt(t,18,$M(e,d)):bt(t,7,zM(e,d))):(d.t="str",l?bt(t,17,r9(e,d)):bt(t,6,e9(e,d))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?bt(t,13,JM(e,d)):bt(t,2,XM(e,d)):l?bt(t,16,GM(e,d)):bt(t,5,VM(e,d)),!0;case"b":return d.t="b",l?bt(t,15,PM(e,d)):bt(t,4,FM(e,d)),!0;case"e":return d.t="e",l?bt(t,14,UM(e,d)):bt(t,3,IM(e,d)),!0}return l?bt(t,12,RM(e,d)):bt(t,1,TM(e,d)),!0}function k9(t,e,r,a){var n=aa(e["!ref"]||"A1"),s,l="",c=[];bt(t,145);var d=Array.isArray(e),f=n.e.r;e["!rows"]&&(f=Math.max(n.e.r,e["!rows"].length-1));for(var m=n.s.r;m<=f;++m){l=Cn(m),SM(t,e,n,m);var v=!1;if(m<=n.e.r)for(var x=n.s.c;x<=n.e.c;++x){m===n.s.r&&(c[x]=rn(x)),s=c[x]+l;var g=d?(e[m]||[])[x]:e[s];if(!g){v=!1;continue}v=j9(t,g,m,x,a,e,v)}}bt(t,146)}function E9(t,e){!e||!e["!merges"]||(bt(t,177,c9(e["!merges"].length)),e["!merges"].forEach(function(r){bt(t,176,l9(r))}),bt(t,178))}function A9(t,e){!e||!e["!cols"]||(bt(t,390),e["!cols"].forEach(function(r,a){r&&bt(t,60,p9(a,r))}),bt(t,391))}function C9(t,e){!e||!e["!ref"]||(bt(t,648),bt(t,649,_9(aa(e["!ref"]))),bt(t,650))}function T9(t,e,r){e["!links"].forEach(function(a){if(a[1].Target){var n=va(r,-1,a[1].Target.replace(/#.*$/,""),Ur.HLINK);bt(t,494,d9(a,n))}}),delete e["!links"]}function O9(t,e,r,a){if(e["!comments"].length>0){var n=va(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ur.VML);bt(t,551,k2("rId"+n)),e["!legacy"]=n}}function R9(t,e,r,a){if(e["!autofilter"]){var n=e["!autofilter"],s=typeof n.ref=="string"?n.ref:Rr(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,c=mi(s);c.s.r==c.e.r&&(c.e.r=mi(e["!ref"]).e.r,s=Rr(c));for(var d=0;d<l.length;++d){var f=l[d];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==a){f.Ref="'"+r.SheetNames[a]+"'!"+s;break}}d==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),bt(t,161,bh(aa(s))),bt(t,162)}}function D9(t,e,r){bt(t,133),bt(t,137,y9(e,r)),bt(t,138),bt(t,134)}function F9(t,e){e["!protect"]&&bt(t,535,b9(e["!protect"]))}function L9(t,e,r,a){var n=hi(),s=r.SheetNames[t],l=r.Sheets[s]||{},c=s;try{r&&r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}var d=aa(l["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],bt(n,129),(r.vbaraw||l["!outline"])&&bt(n,147,AM(c,l["!outline"])),bt(n,148,jM(d)),D9(n,l,r.Workbook),A9(n,l),k9(n,l,t,e),F9(n,l),R9(n,l,r,t),E9(n,l),T9(n,l,a),l["!margins"]&&bt(n,476,v9(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&C9(n,l),O9(n,l,t,a),bt(n,130),n.end()}function P9(t){var e=[],r=t.match(/^<c:numCache>/),a;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=r?+l[2]:l[2])});var n=ra((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[e,n,a]}function M9(t,e,r,a,n,s){var l=s||{"!type":"chart"};if(!t)return s;var c=0,d=0,f="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var x=P9(v);m.s.r=m.s.c=0,m.e.c=c,f=rn(c),x[0].forEach(function(g,b){l[f+Cn(b)]={t:"n",v:g,z:x[1]},d=b}),m.e.r<d&&(m.e.r=d),++c}),c>0&&(l["!ref"]=Rr(m)),l}function I9(t,e,r,a,n){if(!t)return t;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,c=t.match(K3);return c&&U2(c[0],s,n,r),(l=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function B9(t,e){t.l+=10;var r=Ps(t);return{name:r}}function U9(t,e,r,a,n){if(!t)return t;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Sc(t,function(d,f,m){switch(m){case 550:s["!rel"]=d;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),d.name&&(n.Sheets[r].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},e),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var q2=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],q9=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],z9=[],H9=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function f5(t,e){for(var r=0;r!=t.length;++r)for(var a=t[r],n=0;n!=e.length;++n){var s=e[n];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=qa(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function h5(t,e){for(var r=0;r!=e.length;++r){var a=e[r];if(t[a[0]]==null)t[a[0]]=a[1];else switch(a[2]){case"bool":typeof t[a[0]]=="string"&&(t[a[0]]=qa(t[a[0]]));break;case"int":typeof t[a[0]]=="string"&&(t[a[0]]=parseInt(t[a[0]],10));break}}}function ej(t){h5(t.WBProps,q2),h5(t.CalcPr,H9),f5(t.WBView,q9),f5(t.Sheets,z9),ah.date1904=qa(t.WBProps.date1904)}function $9(t){return!t.Workbook||!t.Workbook.WBProps?"false":qa(t.Workbook.WBProps.date1904)?"true":"false"}var W9="][*?/\\".split("");function tj(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return W9.forEach(function(a){if(t.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function V9(t,e,r){t.forEach(function(a,n){tj(a);for(var s=0;s<n;++s)if(a==t[s])throw new Error("Duplicate Sheet Name: "+a);if(r){var l=e&&e[n]&&e[n].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function G9(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];V9(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)$P(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var Y9=/<\w+:workbook/;function X9(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},l=0;if(t.replace(Is,function(d,f){var m=Nr(d);switch(Cl(m[0])){case"<?xml":break;case"<workbook":d.match(Y9)&&(n="xmlns"+d.match(/<(\w+):/)[1]),r.xmlns=m[n];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":q2.forEach(function(v){if(m[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=qa(m[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(m[v[0]],10);break;default:r.WBProps[v[0]]=m[v[0]]}}),m.codeName&&(r.WBProps.CodeName=ka(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=ra(ka(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=ka(m.name),m.comment&&(s.Comment=m.comment),m.localSheetId&&(s.Sheet=+m.localSheetId),qa(m.hidden||"0")&&(s.Hidden=!0),l=f+d.length;break;case"</definedName>":s.Ref=ra(ka(t.slice(l,f))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&e.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return d}),Dd.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ej(r),r}function rj(t){var e=[Tn];e[e.length]=Lt("workbook",null,{xmlns:Dd[0],"xmlns:r":Kn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(q2.forEach(function(c){t.Workbook.WBProps[c[0]]!=null&&t.Workbook.WBProps[c[0]]!=c[1]&&(a[c[0]]=t.Workbook.WBProps[c[0]])}),t.Workbook.WBProps.CodeName&&(a.codeName=t.Workbook.WBProps.CodeName,delete a.CodeName)),e[e.length]=Lt("workbookPr",null,a);var n=t.Workbook&&t.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var l={name:ya(t.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=Lt("sheet",null,l)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(c){var d={name:c.Name};c.Comment&&(d.comment=c.Comment),c.Sheet!=null&&(d.localSheetId=""+c.Sheet),c.Hidden&&(d.hidden="1"),c.Ref&&(e[e.length]=Lt("definedName",ya(c.Ref),d))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function K9(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=wx(t),r.name=Ps(t),r}function J9(t,e){return e||(e=ft(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),k2(t.strRelID,e),os(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Z9(t,e){var r={},a=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var n=e>8?Ps(t):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function Q9(t,e){e||(e=ft(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),GN(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function eI(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function tI(t,e,r){var a=t.l+e;t.l+=4,t.l+=1;var n=t.read_shift(4),s=OO(t),l=IP(t,0,r),c=j2(t);t.l=a;var d={Name:s,Ptg:l};return n<268435455&&(d.Sheet=n),c&&(d.Comment=c),d}function rI(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;e||(e={}),e.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],V0[16]={n:"BrtFRTArchID$",f:eI},Sc(t,function(d,f,m){switch(m){case 156:l.SheetNames.push(d.name),r.Sheets.push(d);break;case 153:r.WBProps=d;break;case 39:d.Sheet!=null&&(e.SID=d.Sheet),d.Ref=Ds(d.Ptg,null,null,l,e),delete e.SID,delete d.Ptg,s.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,d]):l[0]=[m,d],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(d),l.XTI=l.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(m),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(m),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!f.T){if(!n||e.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},e),ej(r),r.Names=s,r.supbooks=l,r}function aI(t,e){bt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var a=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};bt(t,156,J9(n))}bt(t,144)}function nI(t,e){e||(e=ft(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return os("SheetJS",e),os(Kp.version,e),os(Kp.version,e),os("7262",e),e.length>e.l?e.slice(0,e.l):e}function sI(t,e){e||(e=ft(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function iI(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,a=0,n=-1,s=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&s==-1&&(s=a);s>n||(bt(t,135),bt(t,158,sI(n)),bt(t,136))}}function oI(t,e){var r=hi();return bt(r,131),bt(r,128,nI()),bt(r,153,Q9(t.Workbook&&t.Workbook.WBProps||null)),iI(r,t),aI(r,t),bt(r,132),r.end()}function lI(t,e,r){return e.slice(-4)===".bin"?rI(t,r):X9(t,r)}function cI(t,e,r,a,n,s,l,c){return e.slice(-4)===".bin"?N9(t,a,r,n,s,l,c):tM(t,a,r,n,s,l,c)}function uI(t,e,r,a,n,s,l,c){return e.slice(-4)===".bin"?U9(t,a,r,n,s):I9(t,a,r,n,s)}function dI(t,e,r,a,n,s,l,c){return e.slice(-4)===".bin"?hL():mL()}function fI(t,e,r,a,n,s,l,c){return e.slice(-4)===".bin"?dL():fL()}function hI(t,e,r,a){return e.slice(-4)===".bin"?lF(t,r,a):KD(t,r,a)}function mI(t,e,r){return P3(t,r)}function pI(t,e,r){return e.slice(-4)===".bin"?pD(t,r):fD(t,r)}function gI(t,e,r){return e.slice(-4)===".bin"?iL(t,r):JF(t,r)}function vI(t,e,r){return e.slice(-4)===".bin"?YF(t):VF(t)}function xI(t,e,r,a){return r.slice(-4)===".bin"?XF(t,e,r,a):void 0}function yI(t,e,r){return e.slice(-4)===".bin"?HF(t,e,r):WF(t,e,r)}function _I(t,e,r){return(e.slice(-4)===".bin"?oI:rj)(t)}function bI(t,e,r,a,n){return(e.slice(-4)===".bin"?L9:J3)(t,r,a,n)}function wI(t,e,r){return(e.slice(-4)===".bin"?xF:F3)(t,r)}function SI(t,e,r){return(e.slice(-4)===".bin"?xD:k3)(t,r)}function NI(t,e,r){return(e.slice(-4)===".bin"?oL:B3)(t)}function jI(t){return(t.slice(-4)===".bin"?$F:M3)()}var aj=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,nj=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ho(t,e){var r=t.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=t.match(aj),s,l,c,d;if(n)for(d=0;d!=n.length;++d)s=n[d].match(nj),(l=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),a[c]=s[2].slice(1,s[2].length-1));return a}function kI(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var a=t.match(aj),n,s,l,c;if(a)for(c=0;c!=a.length;++c)n=a[c].match(nj),(s=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(s+1),r[l]=n[2].slice(1,n[2].length-1));return r}var N0;function EI(t,e){var r=N0[t]||ra(t);return r==="General"?wd(e):mo(r,e)}function AI(t,e,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=qa(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Ha(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[ra(e)]=n}function CI(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Nc[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=M0(t.v):t.w=wd(t.v):t.w=EI(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var a=N0[e]||e||"General";if(r.cellNF&&(t.z=a),r.cellDates&&t.t=="n"&&xh(a)){var n=gd(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(r.WTF)throw s}}}function TI(t,e,r){if(r.cellStyles&&e.Interior){var a=e.Interior;a.Pattern&&(a.patternType=zD[a.Pattern]||a.Pattern)}t[e.ID]=e}function OI(t,e,r,a,n,s,l,c,d,f){var m="General",v=a.StyleID,x={};f=f||{};var g=[],b=0;for(v===void 0&&c&&(v=c.StyleID),v===void 0&&l&&(v=l.StyleID);s[v]!==void 0&&(s[v].nf&&(m=s[v].nf),s[v].Interior&&g.push(s[v].Interior),!!s[v].Parent);)v=s[v].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=qa(t);break;case"String":a.t="s",a.r=Tw(ra(t)),a.v=t.indexOf("<")>-1?ra(e||t).replace(/<.*?>/g,""):a.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),a.v=(Ha(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=ra(t):a.v<60&&(a.v=a.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+t),a.t||(a.t="n");break;case"Error":a.t="e",a.v=ZN[t],f.cellText!==!1&&(a.w=t);break;default:t==""&&e==""?a.t="z":(a.t="s",a.v=Tw(e||t));break}if(CI(a,m,f),f.cellFormula!==!1)if(a.Formula){var _=ra(a.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),a.f=rh(_,n),delete a.Formula,a.ArrayRange=="RC"?a.F=rh("RC:RC",n):a.ArrayRange&&(a.F=rh(a.ArrayRange,n),d.push([aa(a.F),a.F]))}else for(b=0;b<d.length;++b)n.r>=d[b][0].s.r&&n.r<=d[b][0].e.r&&n.c>=d[b][0].s.c&&n.c<=d[b][0].e.c&&(a.F=d[b][1]);f.cellStyles&&(g.forEach(function(w){!x.patternType&&w.patternType&&(x.patternType=w.patternType)}),a.s=x),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function RI(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function vv(t,e){var r=e||{};yh();var a=f0(y2(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=ka(a));var n=a.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=$a(r);return l.type="string",dh.to_workbook(a,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ve){n.indexOf("<"+ve)>=0&&(s=!0)}),s)return vB(a,r);N0={"General Number":"General","General Date":wr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":wr[15],"Short Date":wr[14],"Long Time":wr[19],"Medium Time":wr[18],"Short Time":wr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:wr[2],Standard:wr[4],Percent:wr[10],Scientific:wr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,d=[],f,m={},v=[],x=r.dense?[]:{},g="",b={},_={},w=Ho('<Data ss:Type="String">'),E=0,C=0,A=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},G={},W={},B="",q=0,L=[],Z={},D={},T=0,M=[],V=[],ie={},X=[],J,K=!1,te=[],fe=[],U={},j=0,F=0,I={Sheets:[],WBProps:{date1904:!1}},z={};U0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";c=U0.exec(a);)switch(c[3]=(ne=c[3]).toLowerCase()){case"data":if(ne=="data"){if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break}if(d[d.length-1][1])break;c[1]==="/"?OI(a.slice(E,c.index),B,w,d[d.length-1][0]=="comment"?ie:b,{c:C,r:A},G,X[C],_,te,r):(B="",w=Ho(c[0]),E=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(V.length>0&&(b.c=V),(!r.sheetRows||r.sheetRows>A)&&b.v!==void 0&&(r.dense?(x[A]||(x[A]=[]),x[A][C]=b):x[rn(C)+Cn(A)]=b),b.HRef&&(b.l={Target:ra(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(j=C+(parseInt(b.MergeAcross,10)|0),F=A+(parseInt(b.MergeDown,10)|0),L.push({s:{c:C,r:A},e:{c:j,r:F}})),!r.sheetStubs)b.MergeAcross?C=j+1:++C;else if(b.MergeAcross||b.MergeDown){for(var se=C;se<=j;++se)for(var je=A;je<=F;++je)(se>C||je>A)&&(r.dense?(x[je]||(x[je]=[]),x[je][se]={t:"z"}):x[rn(se)+Cn(je)]={t:"z"});C=j+1}else++C;else b=kI(c[0]),b.Index&&(C=+b.Index-1),C<O.s.c&&(O.s.c=C),C>O.e.c&&(O.e.c=C),c[0].slice(-2)==="/>"&&++C,V=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(A<O.s.r&&(O.s.r=A),A>O.e.r&&(O.e.r=A),c[0].slice(-2)==="/>"&&(_=Ho(c[0]),_.Index&&(A=+_.Index-1)),C=0,++A):(_=Ho(c[0]),_.Index&&(A=+_.Index-1),U={},(_.AutoFitHeight=="0"||_.Height)&&(U.hpx=parseInt(_.Height,10),U.hpt=W0(U.hpx),fe[A]=U),_.Hidden=="1"&&(U.hidden=!0,fe[A]=U));break;case"worksheet":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));v.push(g),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(x["!ref"]=Rr(O),r.sheetRows&&r.sheetRows<=O.e.r&&(x["!fullref"]=x["!ref"],O.e.r=r.sheetRows-1,x["!ref"]=Rr(O))),L.length&&(x["!merges"]=L),X.length>0&&(x["!cols"]=X),fe.length>0&&(x["!rows"]=fe),m[g]=x}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=C=0,d.push([c[3],!1]),f=Ho(c[0]),g=ra(f.Name),x=r.dense?[]:{},L=[],te=[],fe=[],z={name:g,Hidden:0},I.Sheets.push(z);break;case"table":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else{if(c[0].slice(-2)=="/>")break;d.push([c[3],!1]),X=[],K=!1}break;case"style":c[1]==="/"?TI(G,W,r):W=Ho(c[0]);break;case"numberformat":W.nf=ra(Ho(c[0]).Format||"General"),N0[W.nf]&&(W.nf=N0[W.nf]);for(var Ne=0;Ne!=392&&wr[Ne]!=W.nf;++Ne);if(Ne==392){for(Ne=57;Ne!=392;++Ne)if(wr[Ne]==null){pc(W.nf,Ne);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(J=Ho(c[0]),J.Hidden&&(J.hidden=!0,delete J.Hidden),J.Width&&(J.wpx=parseInt(J.Width,10)),!K&&J.wpx>10){K=!0,Fs=R3;for(var ge=0;ge<X.length;++ge)X[ge]&&yu(X[ge])}K&&yu(J),X[J.Index-1||X.length]=J;for(var Ie=0;Ie<+J.Span;++Ie)X[X.length]=$a(J);break;case"namedrange":if(c[1]==="/")break;I.Names||(I.Names=[]);var le=Nr(c[0]),Ge={Name:le.Name,Ref:rh(le.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(Ge.Sheet=I.Sheets.length-1),I.Names.push(Ge);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?B+=a.slice(q,c.index):q=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;W.Interior=Ho(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?r7(Z,ne,a.slice(T,c.index)):T=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else d.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));RI(ie),V.push(ie)}else d.push([c[3],!1]),f=Ho(c[0]),ie={a:f.Author};break;case"autofilter":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var rt=Ho(c[0]);x["!autofilter"]={ref:rh(rt.Range).replace(/\$/g,"")},d.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"null":break;default:if(d.length==0&&c[3]=="document"||d.length==0&&c[3]=="uof")return x5(a,r);var ue=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ue=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ue=!1}break;case"excelworkbook":switch(c[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ue=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:ue=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(T,c.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else T=c.index+c[0].length;break;case"header":x["!margins"]||_d(x["!margins"]={},"xlml"),isNaN(+Nr(c[0]).Margin)||(x["!margins"].header=+Nr(c[0]).Margin);break;case"footer":x["!margins"]||_d(x["!margins"]={},"xlml"),isNaN(+Nr(c[0]).Margin)||(x["!margins"].footer=+Nr(c[0]).Margin);break;case"pagemargins":var ot=Nr(c[0]);x["!margins"]||_d(x["!margins"]={},"xlml"),isNaN(+ot.Top)||(x["!margins"].top=+ot.Top),isNaN(+ot.Left)||(x["!margins"].left=+ot.Left),isNaN(+ot.Right)||(x["!margins"].right=+ot.Right),isNaN(+ot.Bottom)||(x["!margins"].bottom=+ot.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ue=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ue=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ue=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ue=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ue=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ue=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ue=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ue=!1}break;case"smarttags":break;default:ue=!1;break}if(ue||c[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?AI(D,ne,M,a.slice(T,c.index)):(M=c,T=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+d.join("|")}var xe={};return!r.bookSheets&&!r.bookProps&&(xe.Sheets=m),xe.SheetNames=v,xe.Workbook=I,xe.SSF=$a(wr),xe.Props=Z,xe.Custprops=D,xe}function Cx(t,e){switch(H2(e=e||{}),e.type||"base64"){case"base64":return vv(qi(t),e);case"binary":case"buffer":case"file":return vv(t,e);case"array":return vv(Nu(t),e)}}function DI(t,e){var r=[];return t.Props&&r.push(a7(t.Props,e)),t.Custprops&&r.push(n7(t.Props,t.Custprops)),r.join("")}function FI(){return""}function LI(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(a,n){var s=[];s.push(Lt("NumberFormat",null,{"ss:Format":ya(wr[a.numFmtId])}));var l={"ss:ID":"s"+(21+n)};r.push(Lt("Style",s.join(""),l))}),Lt("Styles",r.join(""))}function sj(t){return Lt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+M2(t.Ref,{r:0,c:0})})}function PI(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],a=0;a<e.length;++a){var n=e[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(sj(n)))}return Lt("Names",r.join(""))}function MI(t,e,r,a){if(!t||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,s=[],l=0;l<n.length;++l){var c=n[l];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||s.push(sj(c)))}return s.join("")}function II(t,e,r,a){if(!t)return"";var n=[];if(t["!margins"]&&(n.push("<PageSetup>"),t["!margins"].header&&n.push(Lt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&n.push(Lt("Footer",null,{"x:Margin":t["!margins"].footer})),n.push(Lt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Lt("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(a.Workbook.Sheets[s]&&!a.Workbook.Sheets[s].Hidden);++s);s==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),t["!protect"]&&(n.push(_s("ProtectContents","True")),t["!protect"].objects&&n.push(_s("ProtectObjects","True")),t["!protect"].scenarios&&n.push(_s("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?n.push(_s("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&n.push(_s("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&n.push("<"+l[1]+"/>")})),n.length==0?"":Lt("WorksheetOptions",n.join(""),{xmlns:Di.x})}function BI(t){return t.map(function(e){var r=iO(e.t||""),a=Lt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Lt("Comment",a,{"ss:Author":e.a})}).join("")}function UI(t,e,r,a,n,s,l){if(!t||t.v==null&&t.f==null)return"";var c={};if(t.f&&(c["ss:Formula"]="="+ya(M2(t.f,l))),t.F&&t.F.slice(0,e.length)==e){var d=an(t.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(d.r==l.r?"":"["+(d.r-l.r)+"]")+"C"+(d.c==l.c?"":"["+(d.c-l.c)+"]")}if(t.l&&t.l.Target&&(c["ss:HRef"]=ya(t.l.Target),t.l.Tooltip&&(c["x:HRefScreenTip"]=ya(t.l.Tooltip))),r["!merges"])for(var f=r["!merges"],m=0;m!=f.length;++m)f[m].s.c!=l.c||f[m].s.r!=l.r||(f[m].e.c>f[m].s.c&&(c["ss:MergeAcross"]=f[m].e.c-f[m].s.c),f[m].e.r>f[m].s.r&&(c["ss:MergeDown"]=f[m].e.r-f[m].s.r));var v="",x="";switch(t.t){case"z":if(!a.sheetStubs)return"";break;case"n":v="Number",x=String(t.v);break;case"b":v="Boolean",x=t.v?"1":"0";break;case"e":v="Error",x=Nc[t.v];break;case"d":v="DateTime",x=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||wr[14]);break;case"s":v="String",x=sO(t.v||"");break}var g=ku(a.cellXfs,t,a);c["ss:StyleID"]="s"+(21+g),c["ss:Index"]=l.c+1;var b=t.v!=null?x:"",_=t.t=="z"?"":'<Data ss:Type="'+v+'">'+b+"</Data>";return(t.c||[]).length>0&&(_+=BI(t.c)),Lt("Cell",_,c)}function qI(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=fh(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function zI(t,e,r,a){if(!t["!ref"])return"";var n=aa(t["!ref"]),s=t["!merges"]||[],l=0,c=[];t["!cols"]&&t["!cols"].forEach(function(w,E){yu(w);var C=!!w.width,A=A1(E,w),O={"ss:Index":E+1};C&&(O["ss:Width"]=H0(A.width)),w.hidden&&(O["ss:Hidden"]="1"),c.push(Lt("Column",null,O))});for(var d=Array.isArray(t),f=n.s.r;f<=n.e.r;++f){for(var m=[qI(f,(t["!rows"]||[])[f])],v=n.s.c;v<=n.e.c;++v){var x=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>v)&&!(s[l].s.r>f)&&!(s[l].e.c<v)&&!(s[l].e.r<f)){(s[l].s.c!=v||s[l].s.r!=f)&&(x=!0);break}if(!x){var g={r:f,c:v},b=Sr(g),_=d?(t[f]||[])[v]:t[b];m.push(UI(_,b,t,e,r,a,g))}}m.push("</Row>"),m.length>2&&c.push(m.join(""))}return c.join("")}function HI(t,e,r){var a=[],n=r.SheetNames[t],s=r.Sheets[n],l=s?MI(s,e,t,r):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=s?zI(s,e,t,r):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(II(s,e,t,r)),a.join("")}function $I(t,e){e||(e={}),t.SSF||(t.SSF=$a(wr)),t.SSF&&(yh(),b1(t.SSF),e.revssf=S1(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],ku(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(DI(t,e)),r.push(FI()),r.push(""),r.push("");for(var a=0;a<t.SheetNames.length;++a)r.push(Lt("Worksheet",HI(a,e,t),{"ss:Name":ya(t.SheetNames[a])}));return r[2]=LI(t,e),r[3]=PI(t),Tn+Lt("Workbook",r.join(""),{xmlns:Di.ss,"xmlns:o":Di.o,"xmlns:x":Di.x,"xmlns:ss":Di.ss,"xmlns:dt":Di.dt,"xmlns:html":Di.html})}function WI(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=PO(r),r.length-r.l<=4)return e;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(e.UnicodeClipboardFormat=MO(r),a=r.read_shift(4),a==0||a>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var VI=[60,1084,2066,2165,2175];function GI(t,e,r,a,n){var s=a,l=[],c=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(c)}l.push(c),r.l+=s;for(var d=dc(r,r.l),f=Tx[d],m=0;f!=null&&VI.indexOf(d)>-1;)s=dc(r,r.l+2),m=r.l+4,d==2066?m+=4:(d==2165||d==2175)&&(m+=12),c=r.slice(m,r.l+4+s),l.push(c),r.l+=4+s,f=Tx[d=dc(r,r.l)];var v=is(l);ys(v,0);var x=0;v.lens=[];for(var g=0;g<l.length;++g)v.lens.push(x),x+=l[g].length;if(v.length<a)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+a;return e.f(v,v.length,n)}function bl(t,e,r){if(t.t!=="z"&&t.XF){var a=0;try{a=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=wr[a])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Nc[t.v]:a===0||a=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=M0(t.v):t.w=wd(t.v):t.w=mo(a,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&a&&t.t=="n"&&xh(wr[a]||String(a))){var n=gd(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function wp(t,e,r){return{v:t,ixfe:e,t:r}}function YI(t,e){var r={opts:{}},a={},n=e.dense?[]:{},s={},l={},c=null,d=[],f="",m={},v,x="",g,b,_,w,E={},C=[],A,O,G=[],W=[],B={Sheets:[],WBProps:{date1904:!1},Views:[{}]},q={},L=function(Ce){return Ce<8?vd[Ce]:Ce<64&&W[Ce-8]||vd[Ce]},Z=function(Ce,st,Dt){var At=st.XF.data;if(!(!At||!At.patternType||!Dt||!Dt.cellStyles)){st.s={},st.s.patternType=At.patternType;var Ct;(Ct=z0(L(At.icvFore)))&&(st.s.fgColor={rgb:Ct}),(Ct=z0(L(At.icvBack)))&&(st.s.bgColor={rgb:Ct})}},D=function(Ce,st,Dt){if(!(U>1)&&!(Dt.sheetRows&&Ce.r>=Dt.sheetRows)){if(Dt.cellStyles&&st.XF&&st.XF.data&&Z(Ce,st,Dt),delete st.ixfe,delete st.XF,v=Ce,x=Sr(Ce),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Ce.r<l.s.r&&(l.s.r=Ce.r),Ce.c<l.s.c&&(l.s.c=Ce.c),Ce.r+1>l.e.r&&(l.e.r=Ce.r+1),Ce.c+1>l.e.c&&(l.e.c=Ce.c+1),Dt.cellFormula&&st.f){for(var At=0;At<C.length;++At)if(!(C[At][0].s.c>Ce.c||C[At][0].s.r>Ce.r)&&!(C[At][0].e.c<Ce.c||C[At][0].e.r<Ce.r)){st.F=Rr(C[At][0]),(C[At][0].s.c!=Ce.c||C[At][0].s.r!=Ce.r)&&delete st.f,st.f&&(st.f=""+Ds(C[At][1],l,Ce,te,T));break}}Dt.dense?(n[Ce.r]||(n[Ce.r]=[]),n[Ce.r][Ce.c]=st):n[x]=st}},T={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(T.password=e.password);var M,V=[],ie=[],X=[],J=[],K=!1,te=[];te.SheetNames=T.snames,te.sharedf=T.sharedf,te.arrayf=T.arrayf,te.names=[],te.XTI=[];var fe=0,U=0,j=0,F=[],I=[],z;T.codepage=1200,Xo(1200);for(var ne=!1;t.l<t.length-1;){var se=t.l,je=t.read_shift(2);if(je===0&&fe===10)break;var Ne=t.l===t.length?0:t.read_shift(2),ge=Tx[je];if(ge&&ge.f){if(e.bookSheets&&fe===133&&je!==133)break;if(fe=je,ge.r===2||ge.r==12){var Ie=t.read_shift(2);if(Ne-=2,!T.enc&&Ie!==je&&((Ie&255)<<8|Ie>>8)!==je)throw new Error("rt mismatch: "+Ie+"!="+je);ge.r==12&&(t.l+=10,Ne-=10)}var le={};if(je===10?le=ge.f(t,Ne,T):le=GI(je,ge,t,Ne,T),U==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(je){case 34:r.opts.Date1904=B.WBProps.date1904=le;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(t.l=0),T.enc=le,!e.password)throw new Error("File is password-protected");if(le.valid==null)throw new Error("Encryption scheme unsupported");if(!le.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=le;break;case 66:var Ge=Number(le);switch(Ge){case 21010:Ge=1200;break;case 32768:Ge=1e4;break;case 32769:Ge=1252;break}Xo(T.codepage=Ge),ne=!0;break;case 317:T.rrtabid=le;break;case 25:T.winlocked=le;break;case 439:r.opts.RefreshAll=le;break;case 12:r.opts.CalcCount=le;break;case 16:r.opts.CalcDelta=le;break;case 17:r.opts.CalcIter=le;break;case 13:r.opts.CalcMode=le;break;case 14:r.opts.CalcPrecision=le;break;case 95:r.opts.CalcSaveRecalc=le;break;case 15:T.CalcRefMode=le;break;case 2211:r.opts.FullCalc=le;break;case 129:le.fDialog&&(n["!type"]="dialog"),le.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),le.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:G.push(le);break;case 430:te.push([le]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(le);break;case 24:case 536:z={Name:le.Name,Ref:Ds(le.rgce,l,null,te,T)},le.itab>0&&(z.Sheet=le.itab-1),te.names.push(z),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(le),le.Name=="_xlnm._FilterDatabase"&&le.itab>0&&le.rgce&&le.rgce[0]&&le.rgce[0][0]&&le.rgce[0][0][0]=="PtgArea3d"&&(I[le.itab-1]={ref:Rr(le.rgce[0][0][1][2])});break;case 22:T.ExternCount=le;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(le),te.XTI=te.XTI.concat(le);break;case 2196:if(T.biff<8)break;z!=null&&(z.Comment=le[1]);break;case 18:n["!protect"]=le;break;case 19:le!==0&&T.WTF&&console.error("Password verifier: "+le);break;case 133:s[le.pos]=le,T.snames.push(le.name);break;case 10:{if(--U)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=Rr(l),e.sheetRows&&e.sheetRows<=l.e.r){var rt=l.e.r;l.e.r=e.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Rr(l),l.e.r=rt}l.e.r++,l.e.c++}V.length>0&&(n["!merges"]=V),ie.length>0&&(n["!objects"]=ie),X.length>0&&(n["!cols"]=X),J.length>0&&(n["!rows"]=J),B.Sheets.push(q)}f===""?m=n:a[f]=n,n=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[je]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[le.BIFFVer]||8),T.biffguess=le.BIFFVer==0,le.BIFFVer==0&&le.dt==4096&&(T.biff=5,ne=!0,Xo(T.codepage=28591)),T.biff==8&&le.BIFFVer==0&&le.dt==16&&(T.biff=2),U++)break;if(n=e.dense?[]:{},T.biff<8&&!ne&&(ne=!0,Xo(T.codepage=e.codepage||1252)),T.biff<5||le.BIFFVer==0&&le.dt==4096){f===""&&(f="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var ue={pos:t.l-Ne,name:f};s[ue.pos]=ue,T.snames.push(f)}else f=(s[se]||{name:""}).name;le.dt==32&&(n["!type"]="chart"),le.dt==64&&(n["!type"]="macro"),V=[],ie=[],T.arrayf=C=[],X=[],J=[],K=!1,q={Hidden:(s[se]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(e.dense?(n[le.r]||[])[le.c]:n[Sr({c:le.c,r:le.r})])&&++le.c,A={ixfe:le.ixfe,XF:G[le.ixfe]||{},v:le.val,t:"n"},j>0&&(A.z=F[A.ixfe>>8&63]),bl(A,e,r.opts.Date1904),D({c:le.c,r:le.r},A,e);break;case 5:case 517:A={ixfe:le.ixfe,XF:G[le.ixfe],v:le.val,t:le.t},j>0&&(A.z=F[A.ixfe>>8&63]),bl(A,e,r.opts.Date1904),D({c:le.c,r:le.r},A,e);break;case 638:A={ixfe:le.ixfe,XF:G[le.ixfe],v:le.rknum,t:"n"},j>0&&(A.z=F[A.ixfe>>8&63]),bl(A,e,r.opts.Date1904),D({c:le.c,r:le.r},A,e);break;case 189:for(var ot=le.c;ot<=le.C;++ot){var xe=le.rkrec[ot-le.c][0];A={ixfe:xe,XF:G[xe],v:le.rkrec[ot-le.c][1],t:"n"},j>0&&(A.z=F[A.ixfe>>8&63]),bl(A,e,r.opts.Date1904),D({c:ot,r:le.r},A,e)}break;case 6:case 518:case 1030:{if(le.val=="String"){c=le;break}if(A=wp(le.val,le.cell.ixfe,le.tt),A.XF=G[A.ixfe],e.cellFormula){var ve=le.formula;if(ve&&ve[0]&&ve[0][0]&&ve[0][0][0]=="PtgExp"){var Be=ve[0][0][1][0],jt=ve[0][0][1][1],Je=Sr({r:Be,c:jt});E[Je]?A.f=""+Ds(le.formula,l,le.cell,te,T):A.F=((e.dense?(n[Be]||[])[jt]:n[Je])||{}).F}else A.f=""+Ds(le.formula,l,le.cell,te,T)}j>0&&(A.z=F[A.ixfe>>8&63]),bl(A,e,r.opts.Date1904),D(le.cell,A,e),c=le}break;case 7:case 519:if(c)c.val=le,A=wp(le,c.cell.ixfe,"s"),A.XF=G[A.ixfe],e.cellFormula&&(A.f=""+Ds(c.formula,l,c.cell,te,T)),j>0&&(A.z=F[A.ixfe>>8&63]),bl(A,e,r.opts.Date1904),D(c.cell,A,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(le);var ct=Sr(le[0].s);if(g=e.dense?(n[le[0].s.r]||[])[le[0].s.c]:n[ct],e.cellFormula&&g){if(!c||!ct||!g)break;g.f=""+Ds(le[1],l,le[0],te,T),g.F=Rr(le[0])}}break;case 1212:{if(!e.cellFormula)break;if(x){if(!c)break;E[Sr(c.cell)]=le[0],g=e.dense?(n[c.cell.r]||[])[c.cell.c]:n[Sr(c.cell)],(g||{}).f=""+Ds(le[0],l,v,te,T)}}break;case 253:A=wp(d[le.isst].t,le.ixfe,"s"),d[le.isst].h&&(A.h=d[le.isst].h),A.XF=G[A.ixfe],j>0&&(A.z=F[A.ixfe>>8&63]),bl(A,e,r.opts.Date1904),D({c:le.c,r:le.r},A,e);break;case 513:e.sheetStubs&&(A={ixfe:le.ixfe,XF:G[le.ixfe],t:"z"},j>0&&(A.z=F[A.ixfe>>8&63]),bl(A,e,r.opts.Date1904),D({c:le.c,r:le.r},A,e));break;case 190:if(e.sheetStubs)for(var St=le.c;St<=le.C;++St){var Ft=le.ixfe[St-le.c];A={ixfe:Ft,XF:G[Ft],t:"z"},j>0&&(A.z=F[A.ixfe>>8&63]),bl(A,e,r.opts.Date1904),D({c:St,r:le.r},A,e)}break;case 214:case 516:case 4:A=wp(le.val,le.ixfe,"s"),A.XF=G[A.ixfe],j>0&&(A.z=F[A.ixfe>>8&63]),bl(A,e,r.opts.Date1904),D({c:le.c,r:le.r},A,e);break;case 0:case 512:U===1&&(l=le);break;case 252:d=le;break;case 1054:if(T.biff==4){F[j++]=le[1];for(var Xt=0;Xt<j+163&&wr[Xt]!=le[1];++Xt);Xt>=163&&pc(le[1],j+163)}else pc(le[1],le[0]);break;case 30:{F[j++]=le;for(var Ut=0;Ut<j+163&&wr[Ut]!=le;++Ut);Ut>=163&&pc(le,j+163)}break;case 229:V=V.concat(le);break;case 93:ie[le.cmo[0]]=T.lastobj=le;break;case 438:T.lastobj.TxO=le;break;case 127:T.lastobj.ImData=le;break;case 440:for(w=le[0].s.r;w<=le[0].e.r;++w)for(_=le[0].s.c;_<=le[0].e.c;++_)g=e.dense?(n[w]||[])[_]:n[Sr({c:_,r:w})],g&&(g.l=le[1]);break;case 2048:for(w=le[0].s.r;w<=le[0].e.r;++w)for(_=le[0].s.c;_<=le[0].e.c;++_)g=e.dense?(n[w]||[])[_]:n[Sr({c:_,r:w})],g&&g.l&&(g.l.Tooltip=le[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;g=e.dense?(n[le[0].r]||[])[le[0].c]:n[Sr(le[0])];var Wt=ie[le[2]];g||(e.dense?(n[le[0].r]||(n[le[0].r]=[]),g=n[le[0].r][le[0].c]={t:"z"}):g=n[Sr(le[0])]={t:"z"},l.e.r=Math.max(l.e.r,le[0].r),l.s.r=Math.min(l.s.r,le[0].r),l.e.c=Math.max(l.e.c,le[0].c),l.s.c=Math.min(l.s.c,le[0].c)),g.c||(g.c=[]),b={a:le[1],t:Wt.TxO.t},g.c.push(b)}break;case 2173:LF(G[le.ixfe],le.ext);break;case 125:{if(!T.cellStyles)break;for(;le.e>=le.s;)X[le.e--]={width:le.w/256,level:le.level||0,hidden:!!(le.flags&1)},K||(K=!0,F2(le.w/256)),yu(X[le.e+1])}break;case 520:{var $t={};le.level!=null&&(J[le.r]=$t,$t.level=le.level),le.hidden&&(J[le.r]=$t,$t.hidden=!0),le.hpt&&(J[le.r]=$t,$t.hpt=le.hpt,$t.hpx=fh(le.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||_d(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[je]]=le;break;case 161:n["!margins"]||_d(n["!margins"]={}),n["!margins"].header=le.header,n["!margins"].footer=le.footer;break;case 574:le.RTL&&(B.Views[0].RTL=!0);break;case 146:W=le;break;case 2198:M=le;break;case 140:O=le;break;case 442:f?q.CodeName=le||q.name:B.WBProps.CodeName=le||"ThisWorkbook";break}}else ge||console.error("Missing Info for XLS Record 0x"+je.toString(16)),t.l+=Ne}return r.SheetNames=vn(s).sort(function(wt,Ce){return Number(wt)-Number(Ce)}).map(function(wt){return s[wt].name}),e.bookSheets||(r.Sheets=a),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&I.forEach(function(wt,Ce){r.Sheets[r.SheetNames[Ce]]["!autofilter"]=wt}),r.Strings=d,r.SSF=$a(wr),T.enc&&(r.Encryption=T.enc),M&&(r.Themes=M),r.Metadata={},O!==void 0&&(r.Metadata.Country=O),te.names.length>0&&(B.Names=te.names),r.Workbook=B,r}var j0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function XI(t,e,r){var a=pr.find(t,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Yw(a,Sx,j0.DSI);for(var s in n)e[s]=n[s]}catch(f){if(r.WTF)throw f}var l=pr.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var c=Yw(l,Nx,j0.SI);for(var d in c)e[d]==null&&(e[d]=c[d])}catch(f){if(r.WTF)throw f}e.HeadingPairs&&e.TitlesOfParts&&(n3(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function KI(t,e){var r=[],a=[],n=[],s=0,l,c=Nw(Sx,"n"),d=Nw(Nx,"n");if(t.Props)for(l=vn(t.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(c,l[s])?r:Object.prototype.hasOwnProperty.call(d,l[s])?a:n).push([l[s],t.Props[l[s]]]);if(t.Custprops)for(l=vn(t.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(c,l[s])?r:Object.prototype.hasOwnProperty.call(d,l[s])?a:n).push([l[s],t.Custprops[l[s]]]);var f=[];for(s=0;s<n.length;++s)d3.indexOf(n[s][0])>-1||a3.indexOf(n[s][0])>-1||n[s][1]!=null&&f.push(n[s]);a.length&&pr.utils.cfb_add(e,"/SummaryInformation",Xw(a,j0.SI,d,Nx)),(r.length||f.length)&&pr.utils.cfb_add(e,"/DocumentSummaryInformation",Xw(r,j0.DSI,c,Sx,f.length?f:null,j0.UDI))}function ij(t,e){e||(e={}),H2(e),u2(),e.codepage&&c2(e.codepage);var r,a;if(t.FullPaths){if(pr.find(t,"/encryption"))throw new Error("File is password-protected");r=pr.find(t,"!CompObj"),a=pr.find(t,"/Workbook")||pr.find(t,"/Book")}else{switch(e.type){case"base64":t=Mi(qi(t));break;case"binary":t=Mi(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ys(t,0),a={content:t}}var n,s;if(r&&WI(r),e.bookProps&&!e.bookSheets)n={};else{var l=Ir?"buffer":"array";if(a&&a.content)n=YI(a.content,e);else if((s=pr.find(t,"PerfectOffice_MAIN"))&&s.content)n=yd.to_workbook(s.content,(e.type=l,e));else if((s=pr.find(t,"NativeContent_MAIN"))&&s.content)n=yd.to_workbook(s.content,(e.type=l,e));else throw(s=pr.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&pr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=cL(t))}var c={};return t.FullPaths&&XI(t,c,e),n.Props=n.Custprops=c,e.bookFiles&&(n.cfb=t),n}function JI(t,e){var r=e||{},a=pr.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return pr.utils.cfb_add(a,n,oj(t,r)),r.biff==8&&(t.Props||t.Custprops)&&KI(t,a),r.biff==8&&t.vbaraw&&uL(a,pr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),a}var V0={0:{f:bM},1:{f:CM},2:{f:YM},3:{f:MM},4:{f:DM},5:{f:WM},6:{f:QM},7:{f:qM},8:{f:i9},9:{f:s9},10:{f:a9},11:{f:n9},12:{f:OM},13:{f:KM},14:{f:BM},15:{f:LM},16:{f:Z3},17:{f:t9},18:{f:HM},19:{f:N2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:tI},40:{},42:{},43:{f:QD},44:{f:JD},45:{f:rF},46:{f:nF},47:{f:aF},48:{},49:{f:NO},50:{},51:{f:IF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:w3},62:{f:ZM},63:{f:GF},64:{f:w9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ms,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:x9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:EM},148:{f:NM,p:16},151:{f:f9},152:{},153:{f:Z9},154:{},155:{},156:{f:K9},157:{},158:{},159:{T:1,f:mD},160:{T:-1},161:{T:1,f:Md},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:o9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:PF},336:{T:-1},337:{f:qF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:wx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:b3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:h9},427:{f:m9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:g9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:kM},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:u9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:wx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:nL},633:{T:1},634:{T:-1},635:{T:1,f:rL},636:{T:-1},637:{f:AO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:B9},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:S9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Tx={6:{f:pv},10:{f:iu},12:{f:In},13:{f:In},14:{f:Sn},15:{f:Sn},16:{f:Ls},17:{f:Sn},18:{f:Sn},19:{f:In},20:{f:t5},21:{f:t5},23:{f:b3},24:{f:a5},25:{f:Sn},26:{},27:{},28:{f:SR},29:{},34:{f:Sn},35:{f:r5},38:{f:Ls},39:{f:Ls},40:{f:Ls},41:{f:Ls},42:{f:Sn},43:{f:Sn},47:{f:LD},49:{f:K7},51:{f:In},60:{},61:{f:W7},64:{f:Sn},65:{f:X7},66:{f:In},77:{},80:{},81:{},82:{},85:{f:In},89:{},90:{},91:{},92:{f:F7},93:{f:kR},94:{},95:{f:Sn},96:{},97:{},99:{f:Sn},125:{f:w3},128:{f:dR},129:{f:P7},130:{f:In},131:{f:Sn},132:{f:Sn},133:{f:M7},134:{},140:{f:FR},141:{f:In},144:{},146:{f:MR},151:{},152:{},153:{},154:{},155:{},156:{f:In},157:{},158:{},160:{f:$R},161:{f:UR},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:oR},190:{f:lR},193:{f:iu},197:{},198:{},199:{},200:{},201:{},202:{f:Sn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:In},220:{},221:{f:Sn},222:{},224:{f:uR},225:{f:D7},226:{f:iu},227:{},229:{f:NR},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:B7},253:{f:Z7},255:{f:q7},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:f3},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Sn},353:{f:iu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:gR},431:{f:Sn},432:{},433:{},434:{},437:{},438:{f:CR},439:{f:Sn},440:{f:TR},441:{},442:{f:am},443:{},444:{f:In},445:{},446:{},448:{f:iu},449:{f:$7,r:2},450:{f:iu},512:{f:Zw},513:{f:HR},515:{f:mR},516:{f:eR},517:{f:e5},519:{f:WR},520:{f:z7},523:{},545:{f:n5},549:{f:Jw},566:{},574:{f:G7},638:{f:iR},659:{},1048:{},1054:{f:rR},1084:{},1212:{f:_R},2048:{f:RR},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:yp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:iu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:IR,r:12},2173:{f:FF,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Sn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:yR,r:12},2197:{},2198:{f:AF,r:12},2199:{},2200:{},2201:{},2202:{f:bR,r:12},2203:{f:iu},2204:{},2205:{},2206:{},2207:{},2211:{f:H7},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:In},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:qR},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:PR},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Zw},1:{},2:{f:KR},3:{f:YR},4:{f:GR},5:{f:e5},7:{f:ZR},8:{},9:{f:yp},11:{},22:{f:In},30:{f:nR},31:{},32:{},33:{f:n5},36:{},37:{f:Jw},50:{f:QR},62:{},52:{},67:{},68:{f:In},69:{},86:{},126:{},127:{f:VR},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:eD},223:{},234:{},354:{},421:{},518:{f:pv},521:{f:yp},536:{f:a5},547:{f:r5},561:{},579:{},1030:{f:pv},1033:{f:yp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function It(t,e,r,a){var n=e;if(!isNaN(n)){var s=a||(r||[]).length||0,l=t.next(4);l.write_shift(2,n),l.write_shift(2,s),s>0&&b2(r)&&t.push(r)}}function ZI(t,e,r,a){var n=(r||[]).length||0;if(n<=8224)return It(t,e,r,n);var s=e;if(!isNaN(s)){for(var l=r.parts||[],c=0,d=0,f=0;f+(l[c]||8224)<=8224;)f+=l[c]||8224,c++;var m=t.next(4);for(m.write_shift(2,s),m.write_shift(2,f),t.push(r.slice(d,d+f)),d+=f;d<n;){for(m=t.next(4),m.write_shift(2,60),f=0;f+(l[c]||8224)<=8224;)f+=l[c]||8224,c++;m.write_shift(2,f),t.push(r.slice(d,d+f)),d+=f}}}function om(t,e,r){return t||(t=ft(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function QI(t,e,r,a){var n=ft(9);return om(n,t,e),h3(r,a||"b",n),n}function eB(t,e,r){var a=ft(8+2*r.length);return om(a,t,e),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function tB(t,e,r,a){if(e.v!=null)switch(e.t){case"d":case"n":var n=e.t=="d"?Jn(Ha(e.v)):e.v;n==(n|0)&&n>=0&&n<65536?It(t,2,JR(r,a,n)):It(t,3,XR(r,a,n));return;case"b":case"e":It(t,5,QI(r,a,e.v,e.t));return;case"s":case"str":It(t,4,eB(r,a,(e.v||"").slice(0,255)));return}It(t,1,om(null,r,a))}function rB(t,e,r,a){var n=Array.isArray(e),s=aa(e["!ref"]||"A1"),l,c="",d=[];if(s.e.c>255||s.e.r>16383){if(a.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=Rr(s)}for(var f=s.s.r;f<=s.e.r;++f){c=Cn(f);for(var m=s.s.c;m<=s.e.c;++m){f===s.s.r&&(d[m]=rn(m)),l=d[m]+c;var v=n?(e[f]||[])[m]:e[l];v&&tB(t,v,f,m)}}}function aB(t,e){for(var r=e||{},a=hi(),n=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(n=s);if(n==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return It(a,r.biff==4?1033:r.biff==3?521:9,O2(t,16,r)),rB(a,t.Sheets[t.SheetNames[n]],n,r),It(a,10),a.end()}function nB(t,e,r){It(t,49,J7({sz:12,name:"Arial"},r))}function sB(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)e[n]!=null&&It(t,1054,aR(n,e[n],r))})}function iB(t,e){var r=ft(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),It(t,2151,r),r=ft(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),x3(aa(e["!ref"]||"A1"),r),r.write_shift(4,4),It(t,2152,r)}function oB(t,e){for(var r=0;r<16;++r)It(t,224,Qw({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(a){It(t,224,Qw(a,0,e))})}function lB(t,e){for(var r=0;r<e["!links"].length;++r){var a=e["!links"][r];It(t,440,OR(a)),a[1].Tooltip&&It(t,2048,DR(a))}delete e["!links"]}function cB(t,e){if(e){var r=0;e.forEach(function(a,n){++r<=256&&a&&It(t,125,BR(A1(n,a),n))})}}function uB(t,e,r,a,n){var s=16+ku(n.cellXfs,e,n);if(e.v==null&&!e.bf){It(t,513,kd(r,a,s));return}if(e.bf)It(t,6,PP(e,r,a,n,s));else switch(e.t){case"d":case"n":var l=e.t=="d"?Jn(Ha(e.v)):e.v;It(t,515,pR(r,a,l,s));break;case"b":case"e":It(t,517,hR(r,a,e.v,s,n,e.t));break;case"s":case"str":if(n.bookSST){var c=B2(n.Strings,e.v,n.revStrings);It(t,253,Q7(r,a,c,s))}else It(t,516,tR(r,a,(e.v||"").slice(0,255),s,n));break;default:It(t,513,kd(r,a,s))}}function dB(t,e,r){var a=hi(),n=r.SheetNames[t],s=r.Sheets[n]||{},l=(r||{}).Workbook||{},c=(l.Sheets||[])[t]||{},d=Array.isArray(s),f=e.biff==8,m,v="",x=[],g=aa(s["!ref"]||"A1"),b=f?65536:16384;if(g.e.c>255||g.e.r>=b){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,b-1)}It(a,2057,O2(r,16,e)),It(a,13,co(1)),It(a,12,co(100)),It(a,15,Gs(!0)),It(a,17,Gs(!1)),It(a,16,Nd(.001)),It(a,95,Gs(!0)),It(a,42,Gs(!1)),It(a,43,Gs(!1)),It(a,130,co(1)),It(a,128,fR()),It(a,131,Gs(!1)),It(a,132,Gs(!1)),f&&cB(a,s["!cols"]),It(a,512,sR(g,e)),f&&(s["!links"]=[]);for(var _=g.s.r;_<=g.e.r;++_){v=Cn(_);for(var w=g.s.c;w<=g.e.c;++w){_===g.s.r&&(x[w]=rn(w)),m=x[w]+v;var E=d?(s[_]||[])[w]:s[m];E&&(uB(a,E,_,w,e),f&&E.l&&s["!links"].push([m,E.l]))}}var C=c.CodeName||c.name||n;return f&&It(a,574,Y7((l.Views||[])[0])),f&&(s["!merges"]||[]).length&&It(a,229,jR(s["!merges"])),f&&lB(a,s),It(a,442,m3(C)),f&&iB(a,s),It(a,10),a.end()}function fB(t,e,r){var a=hi(),n=(t||{}).Workbook||{},s=n.Sheets||[],l=n.WBProps||{},c=r.biff==8,d=r.biff==5;if(It(a,2057,O2(t,5,r)),r.bookType=="xla"&&It(a,135),It(a,225,c?co(1200):null),It(a,193,h7(2)),d&&It(a,191),d&&It(a,192),It(a,226),It(a,92,L7("SheetJS",r)),It(a,66,co(c?1200:1252)),c&&It(a,353,co(0)),c&&It(a,448),It(a,317,zR(t.SheetNames.length)),c&&t.vbaraw&&It(a,211),c&&t.vbaraw){var f=l.CodeName||"ThisWorkbook";It(a,442,m3(f))}It(a,156,co(17)),It(a,25,Gs(!1)),It(a,18,Gs(!1)),It(a,19,co(0)),c&&It(a,431,Gs(!1)),c&&It(a,444,co(0)),It(a,61,V7()),It(a,64,Gs(!1)),It(a,141,co(0)),It(a,34,Gs($9(t)=="true")),It(a,14,Gs(!0)),c&&It(a,439,Gs(!1)),It(a,218,co(0)),nB(a,t,r),sB(a,t.SSF,r),oB(a,r),c&&It(a,352,Gs(!1));var m=a.end(),v=hi();c&&It(v,140,LR()),c&&r.Strings&&ZI(v,252,U7(r.Strings)),It(v,10);var x=v.end(),g=hi(),b=0,_=0;for(_=0;_<t.SheetNames.length;++_)b+=(c?12:11)+(c?2:1)*t.SheetNames[_].length;var w=m.length+b+x.length;for(_=0;_<t.SheetNames.length;++_){var E=s[_]||{};It(g,133,I7({pos:w,hs:E.Hidden||0,dt:0,name:t.SheetNames[_]},r)),w+=e[_].length}var C=g.end();if(b!=C.length)throw new Error("BS8 "+b+" != "+C.length);var A=[];return m.length&&A.push(m),C.length&&A.push(C),x.length&&A.push(x),is(A)}function hB(t,e){var r=e||{},a=[];t&&!t.SSF&&(t.SSF=$a(wr)),t&&t.SSF&&(yh(),b1(t.SSF),r.revssf=S1(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,$2(r),r.cellXfs=[],ku(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var n=0;n<t.SheetNames.length;++n)a[a.length]=dB(n,r,t);return a.unshift(fB(t,a,r)),is(a)}function oj(t,e){for(var r=0;r<=t.SheetNames.length;++r){var a=t.Sheets[t.SheetNames[r]];if(!(!a||!a["!ref"])){var n=mi(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return hB(t,e);case 4:case 3:case 2:return aB(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function m5(t,e){var r=e||{},a=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var n=t.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),l=n.index,c=s&&s.index||t.length,d=J8(t.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,m=0,v=0,x=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(l=0;l<d.length;++l){var _=d[l].trim(),w=_.slice(0,3).toLowerCase();if(w=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}m=0;continue}if(!(w!="<td"&&w!="<th")){var E=_.split(/<\/t[dh]>/i);for(c=0;c<E.length;++c){var C=E[c].trim();if(C.match(/<t[dh]/i)){for(var A=C,O=0;A.charAt(0)=="<"&&(O=A.indexOf(">"))>-1;)A=A.slice(O+1);for(var G=0;G<b.length;++G){var W=b[G];W.s.c==m&&W.s.r<f&&f<=W.e.r&&(m=W.e.c+1,G=-1)}var B=Nr(C.slice(0,C.indexOf(">")));x=B.colspan?+B.colspan:1,((v=+B.rowspan)>1||x>1)&&b.push({s:{r:f,c:m},e:{r:f+(v||1)-1,c:m+x-1}});var q=B.t||B["data-t"]||"";if(!A.length){m+=x;continue}if(A=ON(A),g.s.r>f&&(g.s.r=f),g.e.r<f&&(g.e.r=f),g.s.c>m&&(g.s.c=m),g.e.c<m&&(g.e.c=m),!A.length){m+=x;continue}var L={t:"s",v:A};r.raw||!A.trim().length||q=="s"||(A==="TRUE"?L={t:"b",v:!0}:A==="FALSE"?L={t:"b",v:!1}:isNaN(Jo(A))?isNaN(uh(A).getDate())||(L={t:"d",v:Ha(A)},r.cellDates||(L={t:"n",v:Jn(L.v)}),L.z=r.dateNF||wr[14]):L={t:"n",v:Jo(A)}),r.dense?(a[f]||(a[f]=[]),a[f][m]=L):a[Sr({r:f,c:m})]=L,m+=x}}}}return a["!ref"]=Rr(g),b.length&&(a["!merges"]=b),a}function mB(t,e,r,a){for(var n=t["!merges"]||[],s=[],l=e.s.c;l<=e.e.c;++l){for(var c=0,d=0,f=0;f<n.length;++f)if(!(n[f].s.r>r||n[f].s.c>l)&&!(n[f].e.r<r||n[f].e.c<l)){if(n[f].s.r<r||n[f].s.c<l){c=-1;break}c=n[f].e.r-n[f].s.r+1,d=n[f].e.c-n[f].s.c+1;break}if(!(c<0)){var m=Sr({r,c:l}),v=a.dense?(t[r]||[])[l]:t[m],x=v&&v.v!=null&&(v.h||x2(v.w||(vc(v),v.w)||""))||"",g={};c>1&&(g.rowspan=c),d>1&&(g.colspan=d),a.editable?x='<span contenteditable="true">'+x+"</span>":v&&(g["data-t"]=v&&v.t||"z",v.v!=null&&(g["data-v"]=v.v),v.z!=null&&(g["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+v.l.Target+'">'+x+"</a>")),g.id=(a.id||"sjs")+"-"+m,s.push(Lt("td",x,g))}}var b="<tr>";return b+s.join("")+"</tr>"}var pB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',gB="</body></html>";function vB(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ju(m5(r[0],e),e);var a=G2();return r.forEach(function(n,s){Y2(a,m5(n,e),"Sheet"+(s+1))}),a}function xB(t,e,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function lj(t,e){var r=e||{},a=r.header!=null?r.header:pB,n=r.footer!=null?r.footer:gB,s=[a],l=mi(t["!ref"]);r.dense=Array.isArray(t),s.push(xB(t,l,r));for(var c=l.s.r;c<=l.e.r;++c)s.push(mB(t,l,c,r));return s.push("</table>"+n),s.join("")}function cj(t,e,r){var a=r||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var l=typeof a.origin=="string"?an(a.origin):a.origin;n=l.r,s=l.c}var c=e.getElementsByTagName("tr"),d=Math.min(a.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:n,c:s}};if(t["!ref"]){var m=mi(t["!ref"]);f.s.r=Math.min(f.s.r,m.s.r),f.s.c=Math.min(f.s.c,m.s.c),f.e.r=Math.max(f.e.r,m.e.r),f.e.c=Math.max(f.e.c,m.e.c),n==-1&&(f.e.r=n=m.e.r+1)}var v=[],x=0,g=t["!rows"]||(t["!rows"]=[]),b=0,_=0,w=0,E=0,C=0,A=0;for(t["!cols"]||(t["!cols"]=[]);b<c.length&&_<d;++b){var O=c[b];if(p5(O)){if(a.display)continue;g[_]={hidden:!0}}var G=O.children;for(w=E=0;w<G.length;++w){var W=G[w];if(!(a.display&&p5(W))){var B=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):ON(W.innerHTML),q=W.getAttribute("data-z")||W.getAttribute("z");for(x=0;x<v.length;++x){var L=v[x];L.s.c==E+s&&L.s.r<_+n&&_+n<=L.e.r&&(E=L.e.c+1-s,x=-1)}A=+W.getAttribute("colspan")||1,((C=+W.getAttribute("rowspan")||1)>1||A>1)&&v.push({s:{r:_+n,c:E+s},e:{r:_+n+(C||1)-1,c:E+s+(A||1)-1}});var Z={t:"s",v:B},D=W.getAttribute("data-t")||W.getAttribute("t")||"";B!=null&&(B.length==0?Z.t=D||"z":a.raw||B.trim().length==0||D=="s"||(B==="TRUE"?Z={t:"b",v:!0}:B==="FALSE"?Z={t:"b",v:!1}:isNaN(Jo(B))?isNaN(uh(B).getDate())||(Z={t:"d",v:Ha(B)},a.cellDates||(Z={t:"n",v:Jn(Z.v)}),Z.z=a.dateNF||wr[14]):Z={t:"n",v:Jo(B)})),Z.z===void 0&&q!=null&&(Z.z=q);var T="",M=W.getElementsByTagName("A");if(M&&M.length)for(var V=0;V<M.length&&!(M[V].hasAttribute("href")&&(T=M[V].getAttribute("href"),T.charAt(0)!="#"));++V);T&&T.charAt(0)!="#"&&(Z.l={Target:T}),a.dense?(t[_+n]||(t[_+n]=[]),t[_+n][E+s]=Z):t[Sr({c:E+s,r:_+n})]=Z,f.e.c<E+s&&(f.e.c=E+s),E+=A}}++_}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),f.e.r=Math.max(f.e.r,_-1+n),t["!ref"]=Rr(f),_>=d&&(t["!fullref"]=Rr((f.e.r=c.length-b+_-1+n,f))),t}function uj(t,e){var r=e||{},a=r.dense?[]:{};return cj(a,t,e)}function yB(t,e){return ju(uj(t,e),e)}function p5(t){var e="",r=_B(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function _B(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function bB(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ra(e.replace(/<[^>]*>/g,""));return[r]}var g5={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function dj(t,e){var r=e||{},a=y2(t),n=[],s,l,c={name:""},d="",f=0,m,v,x={},g=[],b=r.dense?[]:{},_,w,E={value:""},C="",A=0,O=[],G=-1,W=-1,B={s:{r:1e6,c:1e7},e:{r:0,c:0}},q=0,L={},Z=[],D={},T=0,M=0,V=[],ie=1,X=1,J=[],K={Names:[]},te={},fe=["",""],U=[],j={},F="",I=0,z=!1,ne=!1,se=0;for(U0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=U0.exec(a);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"":_[1]==="/"?(B.e.c>=B.s.c&&B.e.r>=B.s.r?b["!ref"]=Rr(B):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=B.e.r&&(b["!fullref"]=b["!ref"],B.e.r=r.sheetRows-1,b["!ref"]=Rr(B)),Z.length&&(b["!merges"]=Z),V.length&&(b["!rows"]=V),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),g.push(m.name),x[m.name]=b,ne=!1):_[0].charAt(_[0].length-2)!=="/"&&(m=Nr(_[0],!1),G=W=-1,B.s.r=B.s.c=1e7,B.e.r=B.e.c=0,b=r.dense?[]:{},Z=[],V=[],ne=!0);break;case"table-row-group":_[1]==="/"?--q:++q;break;case"table-row":case"":if(_[1]==="/"){G+=ie,ie=1;break}if(v=Nr(_[0],!1),v.?G=v.-1:G==-1&&(G=0),ie=+v["number-rows-repeated"]||1,ie<10)for(se=0;se<ie;++se)q>0&&(V[G+se]={level:q});W=-1;break;case"covered-table-cell":_[1]!=="/"&&++W,r.sheetStubs&&(r.dense?(b[G]||(b[G]=[]),b[G][W]={t:"z"}):b[Sr({r:G,c:W})]={t:"z"}),C="",O=[];break;case"table-cell":case"":if(_[0].charAt(_[0].length-2)==="/")++W,E=Nr(_[0],!1),X=parseInt(E["number-columns-repeated"]||"1",10),w={t:"z",v:null},E.formula&&r.cellFormula!=!1&&(w.f=d5(ra(E.formula))),(E.||E["value-type"])=="string"&&(w.t="s",w.v=ra(E["string-value"]||""),r.dense?(b[G]||(b[G]=[]),b[G][W]=w):b[Sr({r:G,c:W})]=w),W+=X-1;else if(_[1]!=="/"){++W,C="",A=0,O=[],X=1;var je=ie?G+ie-1:G;if(W>B.e.c&&(B.e.c=W),W<B.s.c&&(B.s.c=W),G<B.s.r&&(B.s.r=G),je>B.e.r&&(B.e.r=je),E=Nr(_[0],!1),U=[],j={},w={t:E.||E["value-type"],v:null},r.cellFormula)if(E.formula&&(E.formula=ra(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(T=parseInt(E["number-matrix-rows-spanned"],10)||0,M=parseInt(E["number-matrix-columns-spanned"],10)||0,D={s:{r:G,c:W},e:{r:G+T-1,c:W+M-1}},w.F=Rr(D),J.push([D,w.F])),E.formula)w.f=d5(E.formula);else for(se=0;se<J.length;++se)G>=J[se][0].s.r&&G<=J[se][0].e.r&&W>=J[se][0].s.c&&W<=J[se][0].e.c&&(w.F=J[se][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(T=parseInt(E["number-rows-spanned"],10)||0,M=parseInt(E["number-columns-spanned"],10)||0,D={s:{r:G,c:W},e:{r:G+T-1,c:W+M-1}},Z.push(D)),E["number-columns-repeated"]&&(X=parseInt(E["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=qa(E["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(E.value);break;case"percentage":w.t="n",w.v=parseFloat(E.value);break;case"currency":w.t="n",w.v=parseFloat(E.value);break;case"date":w.t="d",w.v=Ha(E["date-value"]),r.cellDates||(w.t="n",w.v=Jn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=Y8(E["time-value"])/86400,r.cellDates&&(w.t="d",w.v=N1(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(E.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",E["string-value"]!=null&&(C=ra(E["string-value"]),O=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(z=!1,w.t==="s"&&(w.v=C||"",O.length&&(w.R=O),z=A==0),te.Target&&(w.l=te),U.length>0&&(w.c=U,U=[]),C&&r.cellText!==!1&&(w.w=C),z&&(w.t="z",delete w.v),(!z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=G))for(var Ne=0;Ne<ie;++Ne){if(X=parseInt(E["number-columns-repeated"]||"1",10),r.dense)for(b[G+Ne]||(b[G+Ne]=[]),b[G+Ne][W]=Ne==0?w:$a(w);--X>0;)b[G+Ne][W+X]=$a(w);else for(b[Sr({r:G+Ne,c:W})]=w;--X>0;)b[Sr({r:G+Ne,c:W+X})]=$a(w);B.e.c<=W&&(B.e.c=W)}X=parseInt(E["number-columns-repeated"]||"1",10),W+=X-1,X=0,w={},C="",O=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((s=n.pop())[0]!==_[3])throw"Bad state: "+s}else _[0].charAt(_[0].length-2)!=="/"&&n.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((s=n.pop())[0]!==_[3])throw"Bad state: "+s;j.t=C,O.length&&(j.R=O),j.a=F,U.push(j)}else _[0].charAt(_[0].length-2)!=="/"&&n.push([_[3],!1]);F="",I=0,C="",A=0,O=[];break;case"creator":_[1]==="/"?F=a.slice(I,_.index):I=_.index+_[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((s=n.pop())[0]!==_[3])throw"Bad state: "+s}else _[0].charAt(_[0].length-2)!=="/"&&n.push([_[3],!1]);C="",A=0,O=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(L[c.name]=d,(s=n.pop())[0]!==_[3])throw"Bad state: "+s}else _[0].charAt(_[0].length-2)!=="/"&&(d="",c=Nr(_[0],!1),n.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Nr(_[0],!1),d+=g5[_[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Nr(_[0],!1),d+=g5[_[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":d+=a.slice(f,_.index);break}else f=_.index+_[0].length;break;case"named-range":l=Nr(_[0],!1),fe=gv(l["cell-range-address"]);var ge={Name:l.name,Ref:fe[0]+"!"+fe[1]};ne&&(ge.Sheet=g.length),K.Names.push(ge);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(_[1]==="/"&&(!E||!E["string-value"])){var Ie=bB(a.slice(A,_.index));C=(C.length>0?C+`
`:"")+Ie[0]}else Nr(_[0],!1),A=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{fe=gv(Nr(_[0])["target-range-address"]),x[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(te=Nr(_[0],!1),!te.href)break;te.Target=ra(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(fe=gv(te.Target.slice(1)),te.Target="#"+fe[0]+"!"+fe[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(_)}}var le={Sheets:x,SheetNames:g,Workbook:K};return r.bookSheets&&delete le.Sheets,le}function v5(t,e){e=e||{},lo(t,"META-INF/manifest.xml")&&YO(Mn(t,"META-INF/manifest.xml"),e);var r=Ii(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=dj(ka(r),e);return lo(t,"meta.xml")&&(a.Props=t3(Mn(t,"meta.xml"))),a}function x5(t,e){return dj(t,e)}var wB=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+B0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Tn+e}})(),y5=(function(){var t=function(s){return ya(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(s,l,c){var d=[];d.push('      <table:table table:name="'+ya(l.SheetNames[c])+`" table:style-name="ta1">
`);var f=0,m=0,v=mi(s["!ref"]||"A1"),x=s["!merges"]||[],g=0,b=Array.isArray(s);if(s["!cols"])for(m=0;m<=v.e.c;++m)d.push("        <table:table-column"+(s["!cols"][m]?' table:style-name="co'+s["!cols"][m].ods+'"':"")+`></table:table-column>
`);var _="",w=s["!rows"]||[];for(f=0;f<v.s.r;++f)_=w[f]?' table:style-name="ro'+w[f].ods+'"':"",d.push("        <table:table-row"+_+`></table:table-row>
`);for(;f<=v.e.r;++f){for(_=w[f]?' table:style-name="ro'+w[f].ods+'"':"",d.push("        <table:table-row"+_+`>
`),m=0;m<v.s.c;++m)d.push(e);for(;m<=v.e.c;++m){var E=!1,C={},A="";for(g=0;g!=x.length;++g)if(!(x[g].s.c>m)&&!(x[g].s.r>f)&&!(x[g].e.c<m)&&!(x[g].e.r<f)){(x[g].s.c!=m||x[g].s.r!=f)&&(E=!0),C["table:number-columns-spanned"]=x[g].e.c-x[g].s.c+1,C["table:number-rows-spanned"]=x[g].e.r-x[g].s.r+1;break}if(E){d.push(r);continue}var O=Sr({r:f,c:m}),G=b?(s[f]||[])[m]:s[O];if(G&&G.f&&(C["table:formula"]=ya(zP(G.f)),G.F&&G.F.slice(0,O.length)==O)){var W=mi(G.F);C["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,C["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!G){d.push(e);continue}switch(G.t){case"b":A=G.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=G.v?"true":"false";break;case"n":A=G.w||String(G.v||0),C["office:value-type"]="float",C["office:value"]=G.v||0;break;case"s":case"str":A=G.v==null?"":G.v,C["office:value-type"]="string";break;case"d":A=G.w||Ha(G.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=Ha(G.v).toISOString(),C["table:style-name"]="ce1";break;default:d.push(e);continue}var B=t(A);if(G.l&&G.l.Target){var q=G.l.Target;q=q.charAt(0)=="#"?"#"+HP(q.slice(1)):q,q.charAt(0)!="#"&&!q.match(/^\w+:/)&&(q="../"+q),B=Lt("text:a",B,{"xlink:href":q.replace(/&/g,"&amp;")})}d.push("          "+Lt("table:table-cell",Lt("text:p",B,{}),C)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},n=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var m=0;m<f["!cols"].length;++m)if(f["!cols"][m]){var v=f["!cols"][m];if(v.width==null&&v.wpx==null&&v.wch==null)continue;yu(v),v.ods=c;var x=f["!cols"][m].wpx+"px";s.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),s.push(`  </style:style>
`),++c}}});var d=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var m=0;m<f["!rows"].length;++m)if(f["!rows"][m]){f["!rows"][m].ods=d;var v=f["!rows"][m].hpx+"px";s.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),s.push(`  </style:style>
`),++d}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,c){var d=[Tn],f=B0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=B0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(d.push("<office:document"+f+m+`>
`),d.push(e3().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+f+`>
`),n(d,l),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var v=0;v!=l.SheetNames.length;++v)d.push(a(l.Sheets[l.SheetNames[v]],l,v));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),c.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}})();function fj(t,e){if(e.bookType=="fods")return y5(t,e);var r=p2(),a="",n=[],s=[];return a="mimetype",Fr(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Fr(r,a,y5(t,e)),n.push([a,"text/xml"]),s.push([a,"ContentFile"]),a="styles.xml",Fr(r,a,wB(t,e)),n.push([a,"text/xml"]),s.push([a,"StylesFile"]),a="meta.xml",Fr(r,a,Tn+e3()),n.push([a,"text/xml"]),s.push([a,"MetadataFile"]),a="manifest.rdf",Fr(r,a,JO(s)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Fr(r,a,XO(n)),r}function Ed(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ox(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):ka(Nu(t))}function SB(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Mi(El(t))}function NB(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var a=0;a<e.length;++a)if(t[r+a]!=e[a])continue e;return!0}return!1}function bu(t){var e=t.reduce(function(n,s){return n+s.length},0),r=new Uint8Array(e),a=0;return t.forEach(function(n){r.set(n,a),a+=n.length}),r}function _5(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function jB(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,a=t[e+14]&1,n=e+13;n>=e;--n)a=a*256+t[n];return(t[e+15]&128?-a:a)*Math.pow(10,r-6176)}function kB(t,e,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);t[e+15]|=a>>7,t[e+14]|=(a&127)<<1;for(var s=0;n>=1;++s,n/=256)t[e+s]=n&255;t[e+15]|=r>=0?0:128}function G0(t,e){var r=e?e[0]:0,a=t[r]&127;e:if(t[r++]>=128&&(a|=(t[r]&127)<<7,t[r++]<128||(a|=(t[r]&127)<<14,t[r++]<128)||(a|=(t[r]&127)<<21,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),a}function ga(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function gn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function ia(t){for(var e=[],r=[0];r[0]<t.length;){var a=r[0],n=G0(t,r),s=n&7;n=Math.floor(n/8);var l=0,c;if(n==0)break;switch(s){case 0:{for(var d=r[0];t[r[0]++]>=128;);c=t.slice(d,r[0])}break;case 5:l=4,c=t.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,c=t.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=G0(t,r),c=t.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var f={data:c,type:s};e[n]==null?e[n]=[f]:e[n].push(f)}return e}function xs(t){var e=[];return t.forEach(function(r,a){r.forEach(function(n){n.data&&(e.push(ga(a*8+n.type)),n.type==2&&e.push(ga(n.data.length)),e.push(n.data))})}),bu(e)}function z2(t,e){return t?.map(function(r){return e(r.data)})||[]}function io(t){for(var e,r=[],a=[0];a[0]<t.length;){var n=G0(t,a),s=ia(t.slice(a[0],a[0]+n));a[0]+=n;var l={id:gn(s[1][0].data),messages:[]};s[2].forEach(function(c){var d=ia(c.data),f=gn(d[3][0].data);l.messages.push({meta:d,data:t.slice(a[0],a[0]+f)}),a[0]+=f}),(e=s[3])!=null&&e[0]&&(l.merge=gn(s[3][0].data)>>>0>0),r.push(l)}return r}function Bf(t){var e=[];return t.forEach(function(r){var a=[];a[1]=[{data:ga(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:ga(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(l){n.push(l.data),l.meta[3]=[{type:0,data:ga(l.data.length)}],a[2].push({data:xs(l.meta),type:2})});var s=xs(a);e.push(ga(s.length)),e.push(s),n.forEach(function(l){return e.push(l)})}),bu(e)}function EB(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],a=G0(e,r),n=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var l=e[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=e[r[0]],c>1&&(l|=e[r[0]+1]<<8),c>2&&(l|=e[r[0]+2]<<16),c>3&&(l|=e[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}n.push(e.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var d=0,f=0;if(s==1?(f=(e[r[0]]>>2&7)+4,d=(e[r[0]++]&224)<<3,d|=e[r[0]++]):(f=(e[r[0]++]>>2)+1,s==2?(d=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(d=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),n=[bu(n)],d==0)throw new Error("Invalid offset 0");if(d>n[0].length)throw new Error("Invalid offset beyond length");if(f>=d)for(n.push(n[0].slice(-d)),f-=d;f>=n[n.length-1].length;)n.push(n[n.length-1]),f-=n[n.length-1].length;n.push(n[0].slice(-d,-d+f))}}var m=bu(n);if(m.length!=a)throw new Error("Unexpected length: ".concat(m.length," != ").concat(a));return m}function oo(t){for(var e=[],r=0;r<t.length;){var a=t[r++],n=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(EB(a,t.slice(r,r+n))),r+=n}if(r!==t.length)throw new Error("data is not a valid framed stream!");return bu(e)}function Uf(t){for(var e=[],r=0;r<t.length;){var a=Math.min(t.length-r,268435455),n=new Uint8Array(4);e.push(n);var s=ga(a),l=s.length;e.push(s),a<=60?(l++,e.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,e.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,e.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,e.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,e.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),e.push(t.slice(r,r+a)),l+=a,n[0]=0,n[1]=l&255,n[2]=l>>8&255,n[3]=l>>16&255,r+=a}return bu(e)}function AB(t,e,r,a){var n=Ed(t),s=n.getUint32(4,!0),l=(a>1?12:8)+_5(s&(a>1?3470:398))*4,c=-1,d=-1,f=NaN,m=new Date(2001,0,1);s&512&&(c=n.getUint32(l,!0),l+=4),l+=_5(s&(a>1?12288:4096))*4,s&16&&(d=n.getUint32(l,!0),l+=4),s&32&&(f=n.getFloat64(l,!0),l+=8),s&64&&(m.setTime(m.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:f};break;case 3:v={t:"s",v:e[d]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:f>0};break;case 7:v={t:"n",v:f/86400};break;case 8:v={t:"e",v:0};break;case 9:if(c>-1)v={t:"s",v:r[c]};else if(d>-1)v={t:"s",v:e[d]};else if(!isNaN(f))v={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function CB(t,e,r){var a=Ed(t),n=a.getUint32(8,!0),s=12,l=-1,c=-1,d=NaN,f=NaN,m=new Date(2001,0,1);n&1&&(d=jB(t,s),s+=16),n&2&&(f=a.getFloat64(s,!0),s+=8),n&4&&(m.setTime(m.getTime()+a.getFloat64(s,!0)*1e3),s+=8),n&8&&(c=a.getUint32(s,!0),s+=4),n&16&&(l=a.getUint32(s,!0),s+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e[c]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:f>0};break;case 7:v={t:"n",v:f/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)))}return v}function xv(t,e){var r=new Uint8Array(32),a=Ed(r),n=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,kB(r,n,t.v),s|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,t.v?1:0,!0),s|=2,n+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,a.setUint32(n,e.indexOf(t.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(8,s,!0),r.slice(0,n)}function yv(t,e){var r=new Uint8Array(32),a=Ed(r),n=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,a.setFloat64(n,t.v,!0),s|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,t.v?1:0,!0),s|=32,n+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,a.setUint32(n,e.indexOf(t.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(4,s,!0),r.slice(0,n)}function TB(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return AB(t,e,r,t[0]);case 5:return CB(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Rs(t){var e=ia(t);return G0(e[1][0].data)}function b5(t,e){var r=ia(e.data),a=gn(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(l){var c=ia(l.data),d=gn(c[1][0].data)>>>0;switch(a){case 1:s[d]=Ox(c[3][0].data);break;case 8:{var f=t[Rs(c[9][0].data)][0],m=ia(f.data),v=t[Rs(m[1][0].data)][0],x=gn(v.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var g=ia(v.data);s[d]=g[3].map(function(b){return Ox(b.data)}).join("")}break}}),s}function OB(t,e){var r,a,n,s,l,c,d,f,m,v,x,g,b,_,w=ia(t),E=gn(w[1][0].data)>>>0,C=gn(w[2][0].data)>>>0,A=((a=(r=w[8])==null?void 0:r[0])==null?void 0:a.data)&&gn(w[8][0].data)>0||!1,O,G;if((s=(n=w[7])==null?void 0:n[0])!=null&&s.data&&e!=0)O=(c=(l=w[7])==null?void 0:l[0])==null?void 0:c.data,G=(f=(d=w[6])==null?void 0:d[0])==null?void 0:f.data;else if((v=(m=w[4])==null?void 0:m[0])!=null&&v.data&&e!=1)O=(g=(x=w[4])==null?void 0:x[0])==null?void 0:g.data,G=(_=(b=w[3])==null?void 0:b[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var W=A?4:1,B=Ed(O),q=[],L=0;L<O.length/2;++L){var Z=B.getUint16(L*2,!0);Z<65535&&q.push([L,Z])}if(q.length!=C)throw"Expected ".concat(C," cells, found ").concat(q.length);var D=[];for(L=0;L<q.length-1;++L)D[q[L][0]]=G.subarray(q[L][1]*W,q[L+1][1]*W);return q.length>=1&&(D[q[q.length-1][0]]=G.subarray(q[q.length-1][1]*W)),{R:E,cells:D}}function RB(t,e){var r,a=ia(e.data),n=(r=a?.[7])!=null&&r[0]?gn(a[7][0].data)>>>0>0?1:0:-1,s=z2(a[5],function(l){return OB(l,n)});return{nrows:gn(a[4][0].data)>>>0,data:s.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(d,f){if(l[c.R][f])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(f));l[c.R][f]=d}),l},[])}}function DB(t,e,r){var a,n=ia(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(gn(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(gn(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Rr(s);var l=ia(n[4][0].data),c=b5(t,t[Rs(l[4][0].data)][0]),d=(a=l[17])!=null&&a[0]?b5(t,t[Rs(l[17][0].data)][0]):[],f=ia(l[3][0].data),m=0;f[1].forEach(function(v){var x=ia(v.data),g=t[Rs(x[2][0].data)][0],b=gn(g.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var _=RB(t,g);_.data.forEach(function(w,E){w.forEach(function(C,A){var O=Sr({r:m+E,c:A}),G=TB(C,c,d);G&&(r[O]=G)})}),m+=_.nrows})}function FB(t,e){var r=ia(e.data),a={"!ref":"A1"},n=t[Rs(r[2][0].data)],s=gn(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return DB(t,n[0],a),a}function LB(t,e){var r,a=ia(e.data),n={name:(r=a[1])!=null&&r[0]?Ox(a[1][0].data):"",sheets:[]},s=z2(a[2],Rs);return s.forEach(function(l){t[l].forEach(function(c){var d=gn(c.meta[1][0].data);d==6e3&&n.sheets.push(FB(t,c))})}),n}function PB(t,e){var r=G2(),a=ia(e.data),n=z2(a[1],Rs);if(n.forEach(function(s){t[s].forEach(function(l){var c=gn(l.meta[1][0].data);if(c==2){var d=LB(t,l);d.sheets.forEach(function(f,m){Y2(r,f,m==0?d.name:d.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function _v(t){var e,r,a,n,s={},l=[];if(t.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var f;try{f=oo(d.content)}catch(v){return console.log("?? "+d.content.length+" "+(v.message||v))}var m;try{m=io(f)}catch(v){return console.log("## "+(v.message||v))}m.forEach(function(v){s[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var c=((n=(a=(r=(e=s?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&gn(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||l.forEach(function(d){s[d].forEach(function(f){var m=gn(f.meta[1][0].data)>>>0;if(m==1)if(!c)c=f;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return PB(s,c)}function MB(t,e,r){var a,n,s,l;if(!((a=t[6])!=null&&a[0])||!((n=t[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(s=t[8])==null?void 0:s[0])==null?void 0:l.data)&&gn(t[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var d=0,f=Ed(t[7][0].data),m=0,v=[],x=Ed(t[4][0].data),g=0,b=[],_=0;_<e.length;++_){if(e[_]==null){f.setUint16(_*2,65535,!0),x.setUint16(_*2,65535);continue}f.setUint16(_*2,m,!0),x.setUint16(_*2,g,!0);var w,E;switch(typeof e[_]){case"string":w=xv({t:"s",v:e[_]},r),E=yv({t:"s",v:e[_]},r);break;case"number":w=xv({t:"n",v:e[_]},r),E=yv({t:"n",v:e[_]},r);break;case"boolean":w=xv({t:"b",v:e[_]},r),E=yv({t:"b",v:e[_]},r);break;default:throw new Error("Unsupported value "+e[_])}v.push(w),m+=w.length,b.push(E),g+=E.length,++d}for(t[2][0].data=ga(d);_<t[7][0].data.length/2;++_)f.setUint16(_*2,65535,!0),x.setUint16(_*2,65535,!0);return t[6][0].data=bu(v),t[3][0].data=bu(b),d}function IB(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=mi(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Rr(a)));var s=l1(r,{range:a,header:1}),l=["~Sh33tJ5~"];s.forEach(function(F){return F.forEach(function(I){typeof I=="string"&&l.push(I)})});var c={},d=[],f=pr.read(e.numbers,{type:"base64"});f.FileIndex.map(function(F,I){return[F,f.FullPaths[I]]}).forEach(function(F){var I=F[0],z=F[1];if(I.type==2&&I.name.match(/\.iwa/)){var ne=I.content,se=oo(ne),je=io(se);je.forEach(function(Ne){d.push(Ne.id),c[Ne.id]={deps:[],location:z,type:gn(Ne.messages[0].meta[1][0].data)}})}}),d.sort(function(F,I){return F-I});var m=d.filter(function(F){return F>1}).map(function(F){return[F,ga(F)]});f.FileIndex.map(function(F,I){return[F,f.FullPaths[I]]}).forEach(function(F){var I=F[0];if(F[1],!!I.name.match(/\.iwa/)){var z=io(oo(I.content));z.forEach(function(ne){ne.messages.forEach(function(se){m.forEach(function(je){ne.messages.some(function(Ne){return gn(Ne.meta[1][0].data)!=11006&&NB(Ne.data,je[1])})&&c[je[0]].deps.push(ne.id)})})})}});for(var v=pr.find(f,c[1].location),x=io(oo(v.content)),g,b=0;b<x.length;++b){var _=x[b];_.id==1&&(g=_)}var w=Rs(ia(g.messages[0].data)[1][0].data);for(v=pr.find(f,c[w].location),x=io(oo(v.content)),b=0;b<x.length;++b)_=x[b],_.id==w&&(g=_);for(w=Rs(ia(g.messages[0].data)[2][0].data),v=pr.find(f,c[w].location),x=io(oo(v.content)),b=0;b<x.length;++b)_=x[b],_.id==w&&(g=_);for(w=Rs(ia(g.messages[0].data)[2][0].data),v=pr.find(f,c[w].location),x=io(oo(v.content)),b=0;b<x.length;++b)_=x[b],_.id==w&&(g=_);var E=ia(g.messages[0].data);{E[6][0].data=ga(a.e.r+1),E[7][0].data=ga(a.e.c+1);var C=Rs(E[46][0].data),A=pr.find(f,c[C].location),O=io(oo(A.content));{for(var G=0;G<O.length&&O[G].id!=C;++G);if(O[G].id!=C)throw"Bad ColumnRowUIDMapArchive";var W=ia(O[G].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var B=0;B<=a.e.c;++B){var q=[];q[1]=q[2]=[{type:0,data:ga(B+420690)}],W[1].push({type:2,data:xs(q)}),W[2].push({type:0,data:ga(B)}),W[3].push({type:0,data:ga(B)})}W[4]=[],W[5]=[],W[6]=[];for(var L=0;L<=a.e.r;++L)q=[],q[1]=q[2]=[{type:0,data:ga(L+726270)}],W[4].push({type:2,data:xs(q)}),W[5].push({type:0,data:ga(L)}),W[6].push({type:0,data:ga(L)});O[G].messages[0].data=xs(W)}A.content=Uf(Bf(O)),A.size=A.content.length,delete E[46];var Z=ia(E[4][0].data);{Z[7][0].data=ga(a.e.r+1);var D=ia(Z[1][0].data),T=Rs(D[2][0].data);A=pr.find(f,c[T].location),O=io(oo(A.content));{if(O[0].id!=T)throw"Bad HeaderStorageBucket";var M=ia(O[0].messages[0].data);for(L=0;L<s.length;++L){var V=ia(M[2][0].data);V[1][0].data=ga(L),V[4][0].data=ga(s[L].length),M[2][L]={type:M[2][0].type,data:xs(V)}}O[0].messages[0].data=xs(M)}A.content=Uf(Bf(O)),A.size=A.content.length;var ie=Rs(Z[2][0].data);A=pr.find(f,c[ie].location),O=io(oo(A.content));{if(O[0].id!=ie)throw"Bad HeaderStorageBucket";for(M=ia(O[0].messages[0].data),B=0;B<=a.e.c;++B)V=ia(M[2][0].data),V[1][0].data=ga(B),V[4][0].data=ga(a.e.r+1),M[2][B]={type:M[2][0].type,data:xs(V)};O[0].messages[0].data=xs(M)}A.content=Uf(Bf(O)),A.size=A.content.length;var X=Rs(Z[4][0].data);(function(){for(var F=pr.find(f,c[X].location),I=io(oo(F.content)),z,ne=0;ne<I.length;++ne){var se=I[ne];se.id==X&&(z=se)}var je=ia(z.messages[0].data);{je[3]=[];var Ne=[];l.forEach(function(le,Ge){Ne[1]=[{type:0,data:ga(Ge)}],Ne[2]=[{type:0,data:ga(1)}],Ne[3]=[{type:2,data:SB(le)}],je[3].push({type:2,data:xs(Ne)})})}z.messages[0].data=xs(je);var ge=Bf(I),Ie=Uf(ge);F.content=Ie,F.size=F.content.length})();var J=ia(Z[3][0].data);{var K=J[1][0];delete J[2];var te=ia(K.data);{var fe=Rs(te[2][0].data);(function(){for(var F=pr.find(f,c[fe].location),I=io(oo(F.content)),z,ne=0;ne<I.length;++ne){var se=I[ne];se.id==fe&&(z=se)}var je=ia(z.messages[0].data);{delete je[6],delete J[7];var Ne=new Uint8Array(je[5][0].data);je[5]=[];for(var ge=0,Ie=0;Ie<=a.e.r;++Ie){var le=ia(Ne);ge+=MB(le,s[Ie],l),le[1][0].data=ga(Ie),je[5].push({data:xs(le),type:2})}je[1]=[{type:0,data:ga(a.e.c+1)}],je[2]=[{type:0,data:ga(a.e.r+1)}],je[3]=[{type:0,data:ga(ge)}],je[4]=[{type:0,data:ga(a.e.r+1)}]}z.messages[0].data=xs(je);var Ge=Bf(I),rt=Uf(Ge);F.content=rt,F.size=F.content.length})()}K.data=xs(te)}Z[3][0].data=xs(J)}E[4][0].data=xs(Z)}g.messages[0].data=xs(E);var U=Bf(x),j=Uf(U);return v.content=j,v.size=v.content.length,f}function hj(t){return function(r){for(var a=0;a!=t.length;++a){var n=t[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function H2(t){hj([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function $2(t){hj([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function BB(t){return Ur.WS.indexOf(t)>-1?"sheet":t==Ur.CS?"chart":t==Ur.DS?"dialog":t==Ur.MS?"macro":t&&t.length?t:"sheet"}function UB(t,e){if(!t)return 0;try{t=e.map(function(a){return a.id||(a.id=a.strRelID),[a.name,t["!id"][a.id].Target,BB(t["!id"][a.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function qB(t,e,r,a,n,s,l,c,d,f,m,v){try{s[a]=b0(Ii(t,r,!0),e);var x=Mn(t,e),g;switch(c){case"sheet":g=cI(x,e,n,d,s[a],f,m,v);break;case"chart":if(g=uI(x,e,n,d,s[a],f,m,v),!g||!g["!drawel"])break;var b=m0(g["!drawel"].Target,e),_=q0(b),w=KF(Ii(t,b,!0),b0(Ii(t,_,!0),b)),E=m0(w,b),C=q0(E);g=M9(Ii(t,E,!0),E,d,b0(Ii(t,C,!0),E),f,g);break;case"macro":g=dI(x,e,n,d,s[a],f,m,v);break;case"dialog":g=fI(x,e,n,d,s[a],f,m,v);break;default:throw new Error("Unrecognized sheet type "+c)}l[a]=g;var A=[];s&&s[a]&&vn(s[a]).forEach(function(O){var G="";if(s[a][O].Type==Ur.CMNT){G=m0(s[a][O].Target,e);var W=gI(Mn(t,G,!0),G,d);if(!W||!W.length)return;i5(g,W,!1)}s[a][O].Type==Ur.TCMNT&&(G=m0(s[a][O].Target,e),A=A.concat(ZF(Mn(t,G,!0),d)))}),A&&A.length&&i5(g,A,!0,d.people||[])}catch(O){if(d.WTF)throw O}}function no(t){return t.charAt(0)=="/"?t.slice(1):t}function zB(t,e){if(yh(),e=e||{},H2(e),lo(t,"META-INF/manifest.xml")||lo(t,"objectdata.xml"))return v5(t,e);if(lo(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof _v<"u"){if(t.FileIndex)return _v(t);var r=pr.utils.cfb_new();return Ew(t).forEach(function(V){Fr(r,V,Q8(t,V))}),_v(r)}throw new Error("Unsupported NUMBERS file")}if(!lo(t,"[Content_Types].xml"))throw lo(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):lo(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Ew(t),n=VO(Ii(t,"[Content_Types].xml")),s=!1,l,c;if(n.workbooks.length===0&&(c="xl/workbook.xml",Mn(t,c,!0)&&n.workbooks.push(c)),n.workbooks.length===0){if(c="xl/workbook.bin",!Mn(t,c,!0))throw new Error("Could not find workbook");n.workbooks.push(c),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var d={},f={};if(!e.bookSheets&&!e.bookProps){if(w0=[],n.sst)try{w0=pI(Mn(t,no(n.sst)),n.sst,e)}catch(V){if(e.WTF)throw V}e.cellStyles&&n.themes.length&&(d=mI(Ii(t,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],e)),n.style&&(f=hI(Mn(t,no(n.style)),n.style,d,e))}n.links.map(function(V){try{var ie=b0(Ii(t,q0(no(V))),V);return xI(Mn(t,no(V)),ie,V,e)}catch{}});var m=lI(Mn(t,no(n.workbooks[0])),n.workbooks[0],e),v={},x="";n.coreprops.length&&(x=Mn(t,no(n.coreprops[0]),!0),x&&(v=t3(x)),n.extprops.length!==0&&(x=Mn(t,no(n.extprops[0]),!0),x&&QO(x,v,e)));var g={};(!e.bookSheets||e.bookProps)&&n.custprops.length!==0&&(x=Ii(t,no(n.custprops[0]),!0),x&&(g=t7(x,e)));var b={};if((e.bookSheets||e.bookProps)&&(m.Sheets?l=m.Sheets.map(function(ie){return ie.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),e.bookProps&&(b.Props=v,b.Custprops=g),e.bookSheets&&typeof l<"u"&&(b.SheetNames=l),e.bookSheets?b.SheetNames:e.bookProps))return b;l={};var _={};e.bookDeps&&n.calcchain&&(_=vI(Mn(t,no(n.calcchain)),n.calcchain));var w=0,E={},C,A;{var O=m.Sheets;v.Worksheets=O.length,v.SheetNames=[];for(var G=0;G!=O.length;++G)v.SheetNames[G]=O[G].name}var W=s?"bin":"xml",B=n.workbooks[0].lastIndexOf("/"),q=(n.workbooks[0].slice(0,B+1)+"_rels/"+n.workbooks[0].slice(B+1)+".rels").replace(/^\//,"");lo(t,q)||(q="xl/_rels/workbook."+W+".rels");var L=b0(Ii(t,q,!0),q.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(e.xlmeta=yI(Mn(t,no(n.metadata[0])),n.metadata[0],e)),(n.people||[]).length>=1&&(e.people=eL(Mn(t,no(n.people[0])),e)),L&&(L=UB(L,m.Sheets));var Z=Mn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=v.Worksheets;++w){var D="sheet";if(L&&L[w]?(C="xl/"+L[w][1].replace(/[\/]?xl\//,""),lo(t,C)||(C=L[w][1]),lo(t,C)||(C=q.replace(/_rels\/.*$/,"")+L[w][1]),D=L[w][2]):(C="xl/worksheets/sheet"+(w+1-Z)+"."+W,C=C.replace(/sheet0\./,"sheet.")),A=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(v.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var T=!1,M=0;M!=e.sheets.length;++M)typeof e.sheets[M]=="number"&&e.sheets[M]==w&&(T=1),typeof e.sheets[M]=="string"&&e.sheets[M].toLowerCase()==v.SheetNames[w].toLowerCase()&&(T=1);if(!T)continue e}}qB(t,C,A,v.SheetNames[w],w,E,l,D,e,m,d,f)}return b={Directory:n,Workbook:m,Props:v,Custprops:g,Deps:_,Sheets:l,SheetNames:v.SheetNames,Strings:w0,Styles:f,Themes:d,SSF:$a(wr)},e&&e.bookFiles&&(t.files?(b.keys=a,b.files=t.files):(b.keys=[],b.files={},t.FullPaths.forEach(function(V,ie){V=V.replace(/^Root Entry[\/]/,""),b.keys.push(V),b.files[V]=t.FileIndex[ie]}))),e&&e.bookVBA&&(n.vba.length>0?b.vbaraw=Mn(t,no(n.vba[0]),!0):n.defaults&&n.defaults.bin===lL&&(b.vbaraw=Mn(t,"xl/vbaProject.bin",!0))),b}function HB(t,e){var r=e||{},a="Workbook",n=pr.find(t,a);try{if(a="/!DataSpaces/Version",n=pr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(yD(n.content),a="/!DataSpaces/DataSpaceMap",n=pr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=bD(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=pr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=wD(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=pr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);ND(n.content)}catch{}if(a="/EncryptionInfo",n=pr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=jD(n.content);if(a="/EncryptedPackage",n=pr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],n.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function $B(t,e){return e.bookType=="ods"?fj(t,e):e.bookType=="numbers"?IB(t,e):e.bookType=="xlsb"?WB(t,e):VB(t,e)}function WB(t,e){Xf=1024,t&&!t.SSF&&(t.SSF=$a(wr)),t&&t.SSF&&(yh(),b1(t.SSF),e.revssf=S1(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,S0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",a=U3.indexOf(e.bookType)>-1,n=C2();$2(e=e||{});var s=p2(),l="",c=0;if(e.cellXfs=[],ku(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",Fr(s,l,r3(t.Props,e)),n.coreprops.push(l),va(e.rels,2,l,Ur.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var d=[],f=0;f<t.SheetNames.length;++f)(t.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(t.SheetNames[f]);t.Props.SheetNames=d}for(t.Props.Worksheets=t.Props.SheetNames.length,Fr(s,l,s3(t.Props)),n.extprops.push(l),va(e.rels,3,l,Ur.EXT_PROPS),t.Custprops!==t.Props&&vn(t.Custprops||{}).length>0&&(l="docProps/custom.xml",Fr(s,l,i3(t.Custprops)),n.custprops.push(l),va(e.rels,4,l,Ur.CUST_PROPS)),c=1;c<=t.SheetNames.length;++c){var m={"!id":{}},v=t.Sheets[t.SheetNames[c-1]],x=(v||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+c+"."+r,Fr(s,l,bI(c-1,l,e,t,m)),n.sheets.push(l),va(e.wbrels,-1,"worksheets/sheet"+c+"."+r,Ur.WS[0])}if(v){var g=v["!comments"],b=!1,_="";g&&g.length>0&&(_="xl/comments"+c+"."+r,Fr(s,_,NI(g,_)),n.comments.push(_),va(m,-1,"../comments"+c+"."+r,Ur.CMNT),b=!0),v["!legacy"]&&b&&Fr(s,"xl/drawings/vmlDrawing"+c+".vml",I3(c,v["!comments"])),delete v["!comments"],delete v["!legacy"]}m["!id"].rId1&&Fr(s,q0(l),th(m))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,Fr(s,l,SI(e.Strings,l,e)),n.strs.push(l),va(e.wbrels,-1,"sharedStrings."+r,Ur.SST)),l="xl/workbook."+r,Fr(s,l,_I(t,l)),n.workbooks.push(l),va(e.rels,1,l,Ur.WB),l="xl/theme/theme1.xml",Fr(s,l,L2(t.Themes,e)),n.themes.push(l),va(e.wbrels,-1,"theme/theme1.xml",Ur.THEME),l="xl/styles."+r,Fr(s,l,wI(t,l,e)),n.styles.push(l),va(e.wbrels,-1,"styles."+r,Ur.STY),t.vbaraw&&a&&(l="xl/vbaProject.bin",Fr(s,l,t.vbaraw),n.vba.push(l),va(e.wbrels,-1,"vbaProject.bin",Ur.VBA)),l="xl/metadata."+r,Fr(s,l,jI(l)),n.metadata.push(l),va(e.wbrels,-1,"metadata."+r,Ur.XLMETA),Fr(s,"[Content_Types].xml",QN(n,e)),Fr(s,"_rels/.rels",th(e.rels)),Fr(s,"xl/_rels/workbook."+r+".rels",th(e.wbrels)),delete e.revssf,delete e.ssf,s}function VB(t,e){Xf=1024,t&&!t.SSF&&(t.SSF=$a(wr)),t&&t.SSF&&(yh(),b1(t.SSF),e.revssf=S1(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,S0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",a=U3.indexOf(e.bookType)>-1,n=C2();$2(e=e||{});var s=p2(),l="",c=0;if(e.cellXfs=[],ku(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",Fr(s,l,r3(t.Props,e)),n.coreprops.push(l),va(e.rels,2,l,Ur.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var d=[],f=0;f<t.SheetNames.length;++f)(t.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(t.SheetNames[f]);t.Props.SheetNames=d}t.Props.Worksheets=t.Props.SheetNames.length,Fr(s,l,s3(t.Props)),n.extprops.push(l),va(e.rels,3,l,Ur.EXT_PROPS),t.Custprops!==t.Props&&vn(t.Custprops||{}).length>0&&(l="docProps/custom.xml",Fr(s,l,i3(t.Custprops)),n.custprops.push(l),va(e.rels,4,l,Ur.CUST_PROPS));var m=["SheetJ5"];for(e.tcid=0,c=1;c<=t.SheetNames.length;++c){var v={"!id":{}},x=t.Sheets[t.SheetNames[c-1]],g=(x||{})["!type"]||"sheet";switch(g){case"chart":default:l="xl/worksheets/sheet"+c+"."+r,Fr(s,l,J3(c-1,e,t,v)),n.sheets.push(l),va(e.wbrels,-1,"worksheets/sheet"+c+"."+r,Ur.WS[0])}if(x){var b=x["!comments"],_=!1,w="";if(b&&b.length>0){var E=!1;b.forEach(function(C){C[1].forEach(function(A){A.T==!0&&(E=!0)})}),E&&(w="xl/threadedComments/threadedComment"+c+"."+r,Fr(s,w,QF(b,m,e)),n.threadedcomments.push(w),va(v,-1,"../threadedComments/threadedComment"+c+"."+r,Ur.TCMNT)),w="xl/comments"+c+"."+r,Fr(s,w,B3(b)),n.comments.push(w),va(v,-1,"../comments"+c+"."+r,Ur.CMNT),_=!0}x["!legacy"]&&_&&Fr(s,"xl/drawings/vmlDrawing"+c+".vml",I3(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}v["!id"].rId1&&Fr(s,q0(l),th(v))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,Fr(s,l,k3(e.Strings,e)),n.strs.push(l),va(e.wbrels,-1,"sharedStrings."+r,Ur.SST)),l="xl/workbook."+r,Fr(s,l,rj(t)),n.workbooks.push(l),va(e.rels,1,l,Ur.WB),l="xl/theme/theme1.xml",Fr(s,l,L2(t.Themes,e)),n.themes.push(l),va(e.wbrels,-1,"theme/theme1.xml",Ur.THEME),l="xl/styles."+r,Fr(s,l,F3(t,e)),n.styles.push(l),va(e.wbrels,-1,"styles."+r,Ur.STY),t.vbaraw&&a&&(l="xl/vbaProject.bin",Fr(s,l,t.vbaraw),n.vba.push(l),va(e.wbrels,-1,"vbaProject.bin",Ur.VBA)),l="xl/metadata."+r,Fr(s,l,M3()),n.metadata.push(l),va(e.wbrels,-1,"metadata."+r,Ur.XLMETA),m.length>1&&(l="xl/persons/person.xml",Fr(s,l,tL(m)),n.people.push(l),va(e.wbrels,-1,"persons/person.xml",Ur.PEOPLE)),Fr(s,"[Content_Types].xml",QN(n,e)),Fr(s,"_rels/.rels",th(e.rels)),Fr(s,"xl/_rels/workbook."+r+".rels",th(e.wbrels)),delete e.revssf,delete e.ssf,s}function W2(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=qi(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function GB(t,e){return pr.find(t,"EncryptedPackage")?HB(t,e):ij(t,e)}function YB(t,e){var r,a=t,n=e||{};return n.type||(n.type=Ir&&Buffer.isBuffer(t)?"buffer":"base64"),r=AN(a,n),zB(r,n)}function mj(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Cx(t.slice(r),e);default:break e}return dh.to_workbook(t,e)}function XB(t,e){var r="",a=W2(t,e);switch(e.type){case"base64":r=qi(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Sd(t);break;default:throw new Error("Unrecognized type "+e.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=ka(r)),e.type="binary",mj(r,e)}function KB(t,e){var r=t;return e.type=="base64"&&(r=qi(r)),r=L0.utils.decode(1200,r.slice(2),"str"),e.type="binary",mj(r,e)}function JB(t){return t.match(/[^\x00-\x7F]/)?El(t):t}function bv(t,e,r,a){return a?(r.type="string",dh.to_workbook(t,r)):dh.to_workbook(e,r)}function Rx(t,e){u2();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Rx(new Uint8Array(t),(r=$a(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=t,n=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ah={},r.dateNF&&(ah.dateNF=r.dateNF),r.type||(r.type=Ir&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ir?"buffer":"binary",a=W8(t),typeof Uint8Array<"u"&&!Ir&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,a=JB(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return r=$a(r),r.type="array",Rx(d2(a),r)}switch((n=W2(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return GB(pr.read(a,r),r);break;case 9:if(n[1]<=8)return ij(a,r);break;case 60:return Cx(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return rD(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return N3.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?YB(a,r):bv(t,a,r,s);case 239:return n[3]===60?Cx(a,r):bv(t,a,r,s);case 255:if(n[1]===254)return KB(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return yd.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return yd.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Ax.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return O3.to_workbook(a,r);break;case 10:case 13:case 32:return XB(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return tD.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Ax.to_workbook(a,r):bv(t,a,r,s)}function pj(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return em(e.file,pr.write(t,{type:Ir?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return pr.write(t,e)}function ZB(t,e){var r=$a(e||{}),a=$B(t,r);return QB(a,r)}function QB(t,e){var r={},a=Ir?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=a;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+e.type)}var n=t.FullPaths?pr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(e.type=="binary"||e.type=="base64")return n;n=new Uint8Array(_1(n))}return e.password&&typeof encrypt_agile<"u"?pj(encrypt_agile(n,e.password),e):e.type==="file"?em(e.file,n):e.type=="string"?ka(n):n}function eU(t,e){var r=e||{},a=JI(t,r);return pj(a,r)}function Nl(t,e,r){r||(r="");var a=r+t;switch(e.type){case"base64":return P0(El(a));case"binary":return El(a);case"string":return t;case"file":return em(e.file,a,"utf8");case"buffer":return Ir?wc(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Nl(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function tU(t,e){switch(e.type){case"base64":return P0(t);case"binary":return t;case"string":return t;case"file":return em(e.file,t,"binary");case"buffer":return Ir?wc(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Sp(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",a=0;a<t.length;++a)r+=String.fromCharCode(t[a]);return e.type=="base64"?P0(r):e.type=="string"?ka(r):r;case"file":return em(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function gj(t,e){u2(),G9(t);var r=$a(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=gj(t,r);return r.type="array",_1(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=t.SheetNames.indexOf(r.sheet),!t.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Nl($I(t,r),r);case"slk":case"sylk":return Nl(S3.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"htm":case"html":return Nl(lj(t.Sheets[t.SheetNames[n]],r),r);case"txt":return tU(vj(t.Sheets[t.SheetNames[n]],r),r);case"csv":return Nl(V2(t.Sheets[t.SheetNames[n]],r),r,"\uFEFF");case"dif":return Nl(N3.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"dbf":return Sp(Ax.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"prn":return Nl(dh.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"rtf":return Nl(O3.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"eth":return Nl(j3.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"fods":return Nl(fj(t,r),r);case"wk1":return Sp(yd.sheet_to_wk1(t.Sheets[t.SheetNames[n]],r),r);case"wk3":return Sp(yd.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Sp(oj(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),eU(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return ZB(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function rU(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function aU(t,e,r){var a={};return a.type="file",a.file=e,rU(a),gj(t,a)}function nU(t,e,r,a,n,s,l,c){var d=Cn(r),f=c.defval,m=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),v=!0,x=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!l||t[r])for(var g=e.s.c;g<=e.e.c;++g){var b=l?t[r][g]:t[a[g]+d];if(b===void 0||b.t===void 0){if(f===void 0)continue;s[g]!=null&&(x[s[g]]=f);continue}var _=b.v;switch(b.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(s[g]!=null){if(_==null)if(b.t=="e"&&_===null)x[s[g]]=null;else if(f!==void 0)x[s[g]]=f;else if(m&&_===null)x[s[g]]=null;else continue;else x[s[g]]=m&&(b.t!=="n"||b.t==="n"&&c.rawNumbers!==!1)?_:vc(b,_,c);_!=null&&(v=!1)}}return{row:x,isempty:v}}function l1(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,s=[],l=0,c="",d={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},m=f.range!=null?f.range:t["!ref"];switch(f.header===1?a=1:f.header==="A"?a=2:Array.isArray(f.header)?a=3:f.header==null&&(a=0),typeof m){case"string":d=aa(m);break;case"number":d=aa(t["!ref"]),d.s.r=m;break;default:d=m}a>0&&(n=0);var v=Cn(d.s.r),x=[],g=[],b=0,_=0,w=Array.isArray(t),E=d.s.r,C=0,A={};w&&!t[E]&&(t[E]=[]);var O=f.skipHidden&&t["!cols"]||[],G=f.skipHidden&&t["!rows"]||[];for(C=d.s.c;C<=d.e.c;++C)if(!(O[C]||{}).hidden)switch(x[C]=rn(C),r=w?t[E][C]:t[x[C]+v],a){case 1:s[C]=C-d.s.c;break;case 2:s[C]=x[C];break;case 3:s[C]=f.header[C-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=l=vc(r,null,f),_=A[l]||0,!_)A[l]=1;else{do c=l+"_"+_++;while(A[c]);A[l]=_,A[c]=1}s[C]=c}for(E=d.s.r+n;E<=d.e.r;++E)if(!(G[E]||{}).hidden){var W=nU(t,d,E,x,a,s,w,f);(W.isempty===!1||(a===1?f.blankrows!==!1:f.blankrows))&&(g[b++]=W.row)}return g.length=b,g}var w5=/"/g;function sU(t,e,r,a,n,s,l,c){for(var d=!0,f=[],m="",v=Cn(r),x=e.s.c;x<=e.e.c;++x)if(a[x]){var g=c.dense?(t[r]||[])[x]:t[a[x]+v];if(g==null)m="";else if(g.v!=null){d=!1,m=""+(c.rawNumbers&&g.t=="n"?g.v:vc(g,null,c));for(var b=0,_=0;b!==m.length;++b)if((_=m.charCodeAt(b))===n||_===s||_===34||c.forceQuotes){m='"'+m.replace(w5,'""')+'"';break}m=="ID"&&(m='"ID"')}else g.f!=null&&!g.F?(d=!1,m="="+g.f,m.indexOf(",")>=0&&(m='"'+m.replace(w5,'""')+'"')):m="";f.push(m)}return c.blankrows===!1&&d?null:f.join(l)}function V2(t,e){var r=[],a=e??{};if(t==null||t["!ref"]==null)return"";var n=aa(t["!ref"]),s=a.FS!==void 0?a.FS:",",l=s.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,d=c.charCodeAt(0),f=new RegExp((s=="|"?"\\|":s)+"+$"),m="",v=[];a.dense=Array.isArray(t);for(var x=a.skipHidden&&t["!cols"]||[],g=a.skipHidden&&t["!rows"]||[],b=n.s.c;b<=n.e.c;++b)(x[b]||{}).hidden||(v[b]=rn(b));for(var _=0,w=n.s.r;w<=n.e.r;++w)(g[w]||{}).hidden||(m=sU(t,n,w,v,l,d,s,a),m!=null&&(a.strip&&(m=m.replace(f,"")),(m||a.blankrows!==!1)&&r.push((_++?c:"")+m)));return delete a.dense,r.join("")}function vj(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=V2(t,e);return r}function iU(t){var e="",r,a="";if(t==null||t["!ref"]==null)return[];var n=aa(t["!ref"]),s="",l=[],c,d=[],f=Array.isArray(t);for(c=n.s.c;c<=n.e.c;++c)l[c]=rn(c);for(var m=n.s.r;m<=n.e.r;++m)for(s=Cn(m),c=n.s.c;c<=n.e.c;++c)if(e=l[c]+s,r=f?(t[m]||[])[c]:t[e],a="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;a=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}d[d.length]=e+"="+a}return d}function xj(t,e,r){var a=r||{},n=+!a.skipHeader,s=t||{},l=0,c=0;if(s&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var d=typeof a.origin=="string"?an(a.origin):a.origin;l=d.r,c=d.c}var f,m={s:{c:0,r:0},e:{c,r:l+e.length-1+n}};if(s["!ref"]){var v=aa(s["!ref"]);m.e.c=Math.max(m.e.c,v.e.c),m.e.r=Math.max(m.e.r,v.e.r),l==-1&&(l=v.e.r+1,m.e.r=l+e.length-1+n)}else l==-1&&(l=0,m.e.r=e.length-1+n);var x=a.header||[],g=0;e.forEach(function(_,w){vn(_).forEach(function(E){(g=x.indexOf(E))==-1&&(x[g=x.length]=E);var C=_[E],A="z",O="",G=Sr({c:c+g,r:l+w+n});f=Y0(s,G),C&&typeof C=="object"&&!(C instanceof Date)?s[G]=C:(typeof C=="number"?A="n":typeof C=="boolean"?A="b":typeof C=="string"?A="s":C instanceof Date?(A="d",a.cellDates||(A="n",C=Jn(C)),O=a.dateNF||wr[14]):C===null&&a.nullError&&(A="e",C=0),f?(f.t=A,f.v=C,delete f.w,delete f.R,O&&(f.z=O)):s[G]=f={t:A,v:C},O&&(f.z=O))})}),m.e.c=Math.max(m.e.c,c+x.length-1);var b=Cn(l);if(n)for(g=0;g<x.length;++g)s[rn(g+c)+b]={t:"s",v:x[g]};return s["!ref"]=Rr(m),s}function oU(t,e){return xj(null,t,e)}function Y0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var a=an(e);return t[a.r]||(t[a.r]=[]),t[a.r][a.c]||(t[a.r][a.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Y0(t,Sr(e)):Y0(t,Sr({r:e,c:r||0}))}function lU(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function G2(){return{SheetNames:[],Sheets:{}}}function Y2(t,e,r,a){var n=1;if(!r)for(;n<=65535&&t.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var l=s&&s[1]||r;for(++n;n<=65535&&t.SheetNames.indexOf(r=l+n)!=-1;++n);}if(tj(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function cU(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var a=lU(t,e);switch(t.Workbook.Sheets[a]||(t.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[a].Hidden=r}function uU(t,e){return t.z=e,t}function yj(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function dU(t,e,r){return yj(t,"#"+e,r)}function fU(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function hU(t,e,r,a){for(var n=typeof e!="string"?e:aa(e),s=typeof e=="string"?e:Rr(e),l=n.s.r;l<=n.e.r;++l)for(var c=n.s.c;c<=n.e.c;++c){var d=Y0(t,l,c);d.t="n",d.F=s,delete d.v,l==n.s.r&&c==n.s.c&&(d.f=r,a&&(d.D=!0))}return t}var uu={encode_col:rn,encode_row:Cn,encode_cell:Sr,encode_range:Rr,decode_col:S2,decode_row:w2,split_cell:SO,decode_cell:an,decode_range:mi,format_cell:vc,sheet_add_aoa:VN,sheet_add_json:xj,sheet_add_dom:cj,aoa_to_sheet:_h,json_to_sheet:oU,table_to_sheet:uj,table_to_book:yB,sheet_to_csv:V2,sheet_to_txt:vj,sheet_to_json:l1,sheet_to_html:lj,sheet_to_formulae:iU,sheet_to_row_object_array:l1,sheet_get_cell:Y0,book_new:G2,book_append_sheet:Y2,book_set_sheet_visibility:cU,cell_set_number_format:uU,cell_set_hyperlink:yj,cell_set_internal_link:dU,cell_add_comment:fU,sheet_set_array_formula:hU,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const mU="modulepreload",pU=function(t){return"/"+t},S5={},wv=function(e,r,a){let n=Promise.resolve();if(r&&r.length>0){let d=function(f){return Promise.all(f.map(m=>Promise.resolve(m).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");n=d(r.map(f=>{if(f=pU(f),f in S5)return;S5[f]=!0;const m=f.endsWith(".css"),v=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${v}`))return;const x=document.createElement("link");if(x.rel=m?"stylesheet":mU,m||(x.as="script"),x.crossOrigin="",x.href=f,c&&x.setAttribute("nonce",c),document.head.appendChild(x),m)return new Promise((g,b)=>{x.addEventListener("load",g),x.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function s(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return n.then(l=>{for(const c of l||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})};function xa(t){"@babel/helpers - typeof";return xa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xa(t)}var Qo=Uint8Array,Ui=Uint16Array,X2=Int32Array,K2=new Qo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),J2=new Qo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),N5=new Qo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_j=function(t,e){for(var r=new Ui(31),a=0;a<31;++a)r[a]=e+=1<<t[a-1];for(var n=new X2(r[30]),a=1;a<30;++a)for(var s=r[a];s<r[a+1];++s)n[s]=s-r[a]<<5|a;return{b:r,r:n}},bj=_j(K2,2),gU=bj.b,Dx=bj.r;gU[28]=258,Dx[258]=28;var vU=_j(J2,0),j5=vU.r,Fx=new Ui(32768);for(var za=0;za<32768;++za){var ou=(za&43690)>>1|(za&21845)<<1;ou=(ou&52428)>>2|(ou&13107)<<2,ou=(ou&61680)>>4|(ou&3855)<<4,Fx[za]=((ou&65280)>>8|(ou&255)<<8)>>1}var k0=(function(t,e,r){for(var a=t.length,n=0,s=new Ui(e);n<a;++n)t[n]&&++s[t[n]-1];var l=new Ui(e);for(n=1;n<e;++n)l[n]=l[n-1]+s[n-1]<<1;var c;if(r){c=new Ui(1<<e);var d=15-e;for(n=0;n<a;++n)if(t[n])for(var f=n<<4|t[n],m=e-t[n],v=l[t[n]-1]++<<m,x=v|(1<<m)-1;v<=x;++v)c[Fx[v]>>d]=f}else for(c=new Ui(a),n=0;n<a;++n)t[n]&&(c[n]=Fx[l[t[n]-1]++]>>15-t[n]);return c}),Ad=new Qo(288);for(var za=0;za<144;++za)Ad[za]=8;for(var za=144;za<256;++za)Ad[za]=9;for(var za=256;za<280;++za)Ad[za]=7;for(var za=280;za<288;++za)Ad[za]=8;var c1=new Qo(32);for(var za=0;za<32;++za)c1[za]=5;var xU=k0(Ad,9,0),yU=k0(c1,5,0),wj=function(t){return(t+7)/8|0},_U=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Qo(t.subarray(e,r))},nc=function(t,e,r){r<<=e&7;var a=e/8|0;t[a]|=r,t[a+1]|=r>>8},o0=function(t,e,r){r<<=e&7;var a=e/8|0;t[a]|=r,t[a+1]|=r>>8,t[a+2]|=r>>16},Sv=function(t,e){for(var r=[],a=0;a<t.length;++a)t[a]&&r.push({s:a,f:t[a]});var n=r.length,s=r.slice();if(!n)return{t:Nj,l:0};if(n==1){var l=new Qo(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort(function(G,W){return G.f-W.f}),r.push({s:-1,f:25001});var c=r[0],d=r[1],f=0,m=1,v=2;for(r[0]={s:-1,f:c.f+d.f,l:c,r:d};m!=n-1;)c=r[r[f].f<r[v].f?f++:v++],d=r[f!=m&&r[f].f<r[v].f?f++:v++],r[m++]={s:-1,f:c.f+d.f,l:c,r:d};for(var x=s[0].s,a=1;a<n;++a)s[a].s>x&&(x=s[a].s);var g=new Ui(x+1),b=Lx(r[m-1],g,0);if(b>e){var a=0,_=0,w=b-e,E=1<<w;for(s.sort(function(W,B){return g[B.s]-g[W.s]||W.f-B.f});a<n;++a){var C=s[a].s;if(g[C]>e)_+=E-(1<<b-g[C]),g[C]=e;else break}for(_>>=w;_>0;){var A=s[a].s;g[A]<e?_-=1<<e-g[A]++-1:++a}for(;a>=0&&_;--a){var O=s[a].s;g[O]==e&&(--g[O],++_)}b=e}return{t:new Qo(g),l:b}},Lx=function(t,e,r){return t.s==-1?Math.max(Lx(t.l,e,r+1),Lx(t.r,e,r+1)):e[t.s]=r},k5=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Ui(++e),a=0,n=t[0],s=1,l=function(d){r[a++]=d},c=1;c<=e;++c)if(t[c]==n&&c!=e)++s;else{if(!n&&s>2){for(;s>138;s-=138)l(32754);s>2&&(l(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(l(n),--s;s>6;s-=6)l(8304);s>2&&(l(s-3<<5|8208),s=0)}for(;s--;)l(n);s=1,n=t[c]}return{c:r.subarray(0,a),n:e}},l0=function(t,e){for(var r=0,a=0;a<e.length;++a)r+=t[a]*e[a];return r},Sj=function(t,e,r){var a=r.length,n=wj(e+2);t[n]=a&255,t[n+1]=a>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var s=0;s<a;++s)t[n+s+4]=r[s];return(n+4+a)*8},E5=function(t,e,r,a,n,s,l,c,d,f,m){nc(e,m++,r),++n[256];for(var v=Sv(n,15),x=v.t,g=v.l,b=Sv(s,15),_=b.t,w=b.l,E=k5(x),C=E.c,A=E.n,O=k5(_),G=O.c,W=O.n,B=new Ui(19),q=0;q<C.length;++q)++B[C[q]&31];for(var q=0;q<G.length;++q)++B[G[q]&31];for(var L=Sv(B,7),Z=L.t,D=L.l,T=19;T>4&&!Z[N5[T-1]];--T);var M=f+5<<3,V=l0(n,Ad)+l0(s,c1)+l,ie=l0(n,x)+l0(s,_)+l+14+3*T+l0(B,Z)+2*B[16]+3*B[17]+7*B[18];if(d>=0&&M<=V&&M<=ie)return Sj(e,m,t.subarray(d,d+f));var X,J,K,te;if(nc(e,m,1+(ie<V)),m+=2,ie<V){X=k0(x,g,0),J=x,K=k0(_,w,0),te=_;var fe=k0(Z,D,0);nc(e,m,A-257),nc(e,m+5,W-1),nc(e,m+10,T-4),m+=14;for(var q=0;q<T;++q)nc(e,m+3*q,Z[N5[q]]);m+=3*T;for(var U=[C,G],j=0;j<2;++j)for(var F=U[j],q=0;q<F.length;++q){var I=F[q]&31;nc(e,m,fe[I]),m+=Z[I],I>15&&(nc(e,m,F[q]>>5&127),m+=F[q]>>12)}}else X=xU,J=Ad,K=yU,te=c1;for(var q=0;q<c;++q){var z=a[q];if(z>255){var I=z>>18&31;o0(e,m,X[I+257]),m+=J[I+257],I>7&&(nc(e,m,z>>23&31),m+=K2[I]);var ne=z&31;o0(e,m,K[ne]),m+=te[ne],ne>3&&(o0(e,m,z>>5&8191),m+=J2[ne])}else o0(e,m,X[z]),m+=J[z]}return o0(e,m,X[256]),m+J[256]},bU=new X2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Nj=new Qo(0),wU=function(t,e,r,a,n,s){var l=s.z||t.length,c=new Qo(a+l+5*(1+Math.ceil(l/7e3))+n),d=c.subarray(a,c.length-n),f=s.l,m=(s.r||0)&7;if(e){m&&(d[0]=s.r>>3);for(var v=bU[e-1],x=v>>13,g=v&8191,b=(1<<r)-1,_=s.p||new Ui(32768),w=s.h||new Ui(b+1),E=Math.ceil(r/3),C=2*E,A=function(rt){return(t[rt]^t[rt+1]<<E^t[rt+2]<<C)&b},O=new X2(25e3),G=new Ui(288),W=new Ui(32),B=0,q=0,L=s.i||0,Z=0,D=s.w||0,T=0;L+2<l;++L){var M=A(L),V=L&32767,ie=w[M];if(_[V]=ie,w[M]=V,D<=L){var X=l-L;if((B>7e3||Z>24576)&&(X>423||!f)){m=E5(t,d,0,O,G,W,q,Z,T,L-T,m),Z=B=q=0,T=L;for(var J=0;J<286;++J)G[J]=0;for(var J=0;J<30;++J)W[J]=0}var K=2,te=0,fe=g,U=V-ie&32767;if(X>2&&M==A(L-U))for(var j=Math.min(x,X)-1,F=Math.min(32767,L),I=Math.min(258,X);U<=F&&--fe&&V!=ie;){if(t[L+K]==t[L+K-U]){for(var z=0;z<I&&t[L+z]==t[L+z-U];++z);if(z>K){if(K=z,te=U,z>j)break;for(var ne=Math.min(U,z-2),se=0,J=0;J<ne;++J){var je=L-U+J&32767,Ne=_[je],ge=je-Ne&32767;ge>se&&(se=ge,ie=je)}}}V=ie,ie=_[V],U+=V-ie&32767}if(te){O[Z++]=268435456|Dx[K]<<18|j5[te];var Ie=Dx[K]&31,le=j5[te]&31;q+=K2[Ie]+J2[le],++G[257+Ie],++W[le],D=L+K,++B}else O[Z++]=t[L],++G[t[L]]}}for(L=Math.max(L,D);L<l;++L)O[Z++]=t[L],++G[t[L]];m=E5(t,d,f,O,G,W,q,Z,T,L-T,m),f||(s.r=m&7|d[m/8|0]<<3,m-=7,s.h=w,s.p=_,s.i=L,s.w=D)}else{for(var L=s.w||0;L<l+f;L+=65535){var Ge=L+65535;Ge>=l&&(d[m/8|0]=f,Ge=l),m=Sj(d,m+1,t.subarray(L,Ge))}s.i=l}return _U(c,0,a+wj(m)+n)},jj=function(){var t=1,e=0;return{p:function(r){for(var a=t,n=e,s=r.length|0,l=0;l!=s;){for(var c=Math.min(l+2655,s);l<c;++l)n+=a+=r[l];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}t=a,e=n},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},SU=function(t,e,r,a,n){if(!n&&(n={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),l=new Qo(s.length+t.length);l.set(s),l.set(t,s.length),t=l,n.w=s.length}return wU(t,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,a,n)},kj=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},NU=function(t,e){var r=e.level,a=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=a<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var n=jj();n.p(e.dictionary),kj(t,2,n.d())}};function Px(t,e){e||(e={});var r=jj();r.p(t);var a=SU(t,e,e.dictionary?6:2,4);return NU(a,e),kj(a,a.length-4,r.d()),a}var jU=typeof TextDecoder<"u"&&new TextDecoder,kU=0;try{jU.decode(Nj,{stream:!0}),kU=1}catch{}function EU(t){if(Array.isArray(t))return t}function AU(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var a,n,s,l,c=[],d=!0,f=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(d=(a=s.call(r)).done)&&(c.push(a.value),c.length!==e);d=!0);}catch(m){f=!0,n=m}finally{try{if(!d&&r.return!=null&&(l=r.return(),Object(l)!==l))return}finally{if(f)throw n}}return c}}function A5(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}function CU(t,e){if(t){if(typeof t=="string")return A5(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?A5(t,e):void 0}}function TU(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C5(t,e){return EU(t)||AU(t,e)||CU(t,e)||TU()}function T5(t,e="utf8"){return new TextDecoder(e).decode(t)}const OU=new TextEncoder;function RU(t){return OU.encode(t)}const DU=1024*8,FU=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),Nv={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Z2{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=DU,r={}){let a=!1;typeof e=="number"?e=new ArrayBuffer(e):(a=!0,this.lastWrittenByte=e.byteLength);const n=r.offset?r.offset>>>0:0,s=e.byteLength-n;let l=n;(ArrayBuffer.isView(e)||e instanceof Z2)&&(e.byteLength!==e.buffer.byteLength&&(l=e.byteOffset+n),e=e.buffer),a?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=l,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,l,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const a=(this.offset+e)*2,n=new Uint8Array(a);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const a=Nv[r].BYTES_PER_ELEMENT*e,n=this.byteOffset+this.offset,s=this.buffer.slice(n,n+a);if(this.littleEndian===FU&&r!=="uint8"&&r!=="int8"){const c=new Uint8Array(this.buffer.slice(n,n+a));c.reverse();const d=new Nv[r](c.buffer);return this.offset+=a,d.reverse(),d}const l=new Nv[r](s);return this.offset+=a,l}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let a=0;a<e;a++)r+=this.readChar();return r}readUtf8(e=1){return T5(this.readBytes(e))}decodeText(e=1,r="utf8"){return T5(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(RU(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function wh(t){let e=t.length;for(;--e>=0;)t[e]=0}const LU=3,PU=258,Ej=29,MU=256,IU=MU+1+Ej,Aj=30,BU=512,UU=new Array((IU+2)*2);wh(UU);const qU=new Array(Aj*2);wh(qU);const zU=new Array(BU);wh(zU);const HU=new Array(PU-LU+1);wh(HU);const $U=new Array(Ej);wh($U);const WU=new Array(Aj);wh(WU);const VU=(t,e,r,a)=>{let n=t&65535|0,s=t>>>16&65535|0,l=0;for(;r!==0;){l=r>2e3?2e3:r,r-=l;do n=n+e[a++]|0,s=s+n|0;while(--l);n%=65521,s%=65521}return n|s<<16|0};var Mx=VU;const GU=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var a=0;a<8;a++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},YU=new Uint32Array(GU()),XU=(t,e,r,a)=>{const n=YU,s=a+r;t^=-1;for(let l=a;l<s;l++)t=t>>>8^n[(t^e[l])&255];return t^-1};var wl=XU,Ix={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Cj={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const KU=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var JU=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const a in r)KU(r,a)&&(t[a]=r[a])}}return t},ZU=t=>{let e=0;for(let a=0,n=t.length;a<n;a++)e+=t[a].length;const r=new Uint8Array(e);for(let a=0,n=0,s=t.length;a<s;a++){let l=t[a];r.set(l,n),n+=l.length}return r},Tj={assign:JU,flattenChunks:ZU};let Oj=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Oj=!1}const X0=new Uint8Array(256);for(let t=0;t<256;t++)X0[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;X0[254]=X0[254]=1;var QU=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,a,n,s,l=t.length,c=0;for(n=0;n<l;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<l&&(a=t.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),c+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(c),s=0,n=0;s<c;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<l&&(a=t.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};const eq=(t,e)=>{if(e<65534&&t.subarray&&Oj)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let a=0;a<e;a++)r+=String.fromCharCode(t[a]);return r};var tq=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let a,n;const s=new Array(r*2);for(n=0,a=0;a<r;){let l=t[a++];if(l<128){s[n++]=l;continue}let c=X0[l];if(c>4){s[n++]=65533,a+=c-1;continue}for(l&=c===2?31:c===3?15:7;c>1&&a<r;)l=l<<6|t[a++]&63,c--;if(c>1){s[n++]=65533;continue}l<65536?s[n++]=l:(l-=65536,s[n++]=55296|l>>10&1023,s[n++]=56320|l&1023)}return eq(s,n)},rq=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+X0[t[r]]>e?r:e},Bx={string2buf:QU,buf2string:tq,utf8border:rq};function aq(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var nq=aq;const Np=16209,sq=16191;var iq=function(e,r){let a,n,s,l,c,d,f,m,v,x,g,b,_,w,E,C,A,O,G,W,B,q,L,Z;const D=e.state;a=e.next_in,L=e.input,n=a+(e.avail_in-5),s=e.next_out,Z=e.output,l=s-(r-e.avail_out),c=s+(e.avail_out-257),d=D.dmax,f=D.wsize,m=D.whave,v=D.wnext,x=D.window,g=D.hold,b=D.bits,_=D.lencode,w=D.distcode,E=(1<<D.lenbits)-1,C=(1<<D.distbits)-1;e:do{b<15&&(g+=L[a++]<<b,b+=8,g+=L[a++]<<b,b+=8),A=_[g&E];t:for(;;){if(O=A>>>24,g>>>=O,b-=O,O=A>>>16&255,O===0)Z[s++]=A&65535;else if(O&16){G=A&65535,O&=15,O&&(b<O&&(g+=L[a++]<<b,b+=8),G+=g&(1<<O)-1,g>>>=O,b-=O),b<15&&(g+=L[a++]<<b,b+=8,g+=L[a++]<<b,b+=8),A=w[g&C];r:for(;;){if(O=A>>>24,g>>>=O,b-=O,O=A>>>16&255,O&16){if(W=A&65535,O&=15,b<O&&(g+=L[a++]<<b,b+=8,b<O&&(g+=L[a++]<<b,b+=8)),W+=g&(1<<O)-1,W>d){e.msg="invalid distance too far back",D.mode=Np;break e}if(g>>>=O,b-=O,O=s-l,W>O){if(O=W-O,O>m&&D.sane){e.msg="invalid distance too far back",D.mode=Np;break e}if(B=0,q=x,v===0){if(B+=f-O,O<G){G-=O;do Z[s++]=x[B++];while(--O);B=s-W,q=Z}}else if(v<O){if(B+=f+v-O,O-=v,O<G){G-=O;do Z[s++]=x[B++];while(--O);if(B=0,v<G){O=v,G-=O;do Z[s++]=x[B++];while(--O);B=s-W,q=Z}}}else if(B+=v-O,O<G){G-=O;do Z[s++]=x[B++];while(--O);B=s-W,q=Z}for(;G>2;)Z[s++]=q[B++],Z[s++]=q[B++],Z[s++]=q[B++],G-=3;G&&(Z[s++]=q[B++],G>1&&(Z[s++]=q[B++]))}else{B=s-W;do Z[s++]=Z[B++],Z[s++]=Z[B++],Z[s++]=Z[B++],G-=3;while(G>2);G&&(Z[s++]=Z[B++],G>1&&(Z[s++]=Z[B++]))}}else if((O&64)===0){A=w[(A&65535)+(g&(1<<O)-1)];continue r}else{e.msg="invalid distance code",D.mode=Np;break e}break}}else if((O&64)===0){A=_[(A&65535)+(g&(1<<O)-1)];continue t}else if(O&32){D.mode=sq;break e}else{e.msg="invalid literal/length code",D.mode=Np;break e}break}}while(a<n&&s<c);G=b>>3,a-=G,b-=G<<3,g&=(1<<b)-1,e.next_in=a,e.next_out=s,e.avail_in=a<n?5+(n-a):5-(a-n),e.avail_out=s<c?257+(c-s):257-(s-c),D.hold=g,D.bits=b};const qf=15,O5=852,R5=592,D5=0,jv=1,F5=2,oq=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lq=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),cq=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),uq=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),dq=(t,e,r,a,n,s,l,c)=>{const d=c.bits;let f=0,m=0,v=0,x=0,g=0,b=0,_=0,w=0,E=0,C=0,A,O,G,W,B,q=null,L;const Z=new Uint16Array(qf+1),D=new Uint16Array(qf+1);let T=null,M,V,ie;for(f=0;f<=qf;f++)Z[f]=0;for(m=0;m<a;m++)Z[e[r+m]]++;for(g=d,x=qf;x>=1&&Z[x]===0;x--);if(g>x&&(g=x),x===0)return n[s++]=1<<24|64<<16|0,n[s++]=1<<24|64<<16|0,c.bits=1,0;for(v=1;v<x&&Z[v]===0;v++);for(g<v&&(g=v),w=1,f=1;f<=qf;f++)if(w<<=1,w-=Z[f],w<0)return-1;if(w>0&&(t===D5||x!==1))return-1;for(D[1]=0,f=1;f<qf;f++)D[f+1]=D[f]+Z[f];for(m=0;m<a;m++)e[r+m]!==0&&(l[D[e[r+m]]++]=m);if(t===D5?(q=T=l,L=20):t===jv?(q=oq,T=lq,L=257):(q=cq,T=uq,L=0),C=0,m=0,f=v,B=s,b=g,_=0,G=-1,E=1<<g,W=E-1,t===jv&&E>O5||t===F5&&E>R5)return 1;for(;;){M=f-_,l[m]+1<L?(V=0,ie=l[m]):l[m]>=L?(V=T[l[m]-L],ie=q[l[m]-L]):(V=96,ie=0),A=1<<f-_,O=1<<b,v=O;do O-=A,n[B+(C>>_)+O]=M<<24|V<<16|ie|0;while(O!==0);for(A=1<<f-1;C&A;)A>>=1;if(A!==0?(C&=A-1,C+=A):C=0,m++,--Z[f]===0){if(f===x)break;f=e[r+l[m]]}if(f>g&&(C&W)!==G){for(_===0&&(_=g),B+=v,b=f-_,w=1<<b;b+_<x&&(w-=Z[b+_],!(w<=0));)b++,w<<=1;if(E+=1<<b,t===jv&&E>O5||t===F5&&E>R5)return 1;G=C&W,n[G]=g<<24|b<<16|B-s|0}}return C!==0&&(n[B+C]=f-_<<24|64<<16|0),c.bits=g,0};var E0=dq;const fq=0,Rj=1,Dj=2,{Z_FINISH:L5,Z_BLOCK:hq,Z_TREES:jp,Z_OK:Cd,Z_STREAM_END:mq,Z_NEED_DICT:pq,Z_STREAM_ERROR:po,Z_DATA_ERROR:Fj,Z_MEM_ERROR:Lj,Z_BUF_ERROR:gq,Z_DEFLATED:P5}=Cj,C1=16180,M5=16181,I5=16182,B5=16183,U5=16184,q5=16185,z5=16186,H5=16187,$5=16188,W5=16189,u1=16190,sc=16191,kv=16192,V5=16193,Ev=16194,G5=16195,Y5=16196,X5=16197,K5=16198,kp=16199,Ep=16200,J5=16201,Z5=16202,Q5=16203,eS=16204,tS=16205,Av=16206,rS=16207,aS=16208,Xa=16209,Pj=16210,Mj=16211,vq=852,xq=592,yq=15,_q=yq,nS=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function bq(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Bd=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<C1||e.mode>Mj?1:0},Ij=t=>{if(Bd(t))return po;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=C1,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(vq),e.distcode=e.distdyn=new Int32Array(xq),e.sane=1,e.back=-1,Cd},Bj=t=>{if(Bd(t))return po;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Ij(t)},Uj=(t,e)=>{let r;if(Bd(t))return po;const a=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?po:(a.window!==null&&a.wbits!==e&&(a.window=null),a.wrap=r,a.wbits=e,Bj(t))},qj=(t,e)=>{if(!t)return po;const r=new bq;t.state=r,r.strm=t,r.window=null,r.mode=C1;const a=Uj(t,e);return a!==Cd&&(t.state=null),a},wq=t=>qj(t,_q);let sS=!0,Cv,Tv;const Sq=t=>{if(sS){Cv=new Int32Array(512),Tv=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(E0(Rj,t.lens,0,288,Cv,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;E0(Dj,t.lens,0,32,Tv,0,t.work,{bits:5}),sS=!1}t.lencode=Cv,t.lenbits=9,t.distcode=Tv,t.distbits=5},zj=(t,e,r,a)=>{let n;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),a>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>a&&(n=a),s.window.set(e.subarray(r-a,r-a+n),s.wnext),a-=n,a?(s.window.set(e.subarray(r-a,r),0),s.wnext=a,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0},Nq=(t,e)=>{let r,a,n,s,l,c,d,f,m,v,x,g,b,_,w=0,E,C,A,O,G,W,B,q;const L=new Uint8Array(4);let Z,D;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Bd(t)||!t.output||!t.input&&t.avail_in!==0)return po;r=t.state,r.mode===sc&&(r.mode=kv),l=t.next_out,n=t.output,d=t.avail_out,s=t.next_in,a=t.input,c=t.avail_in,f=r.hold,m=r.bits,v=c,x=d,q=Cd;e:for(;;)switch(r.mode){case C1:if(r.wrap===0){r.mode=kv;break}for(;m<16;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}if(r.wrap&2&&f===35615){r.wbits===0&&(r.wbits=15),r.check=0,L[0]=f&255,L[1]=f>>>8&255,r.check=wl(r.check,L,2,0),f=0,m=0,r.mode=M5;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((f&255)<<8)+(f>>8))%31){t.msg="incorrect header check",r.mode=Xa;break}if((f&15)!==P5){t.msg="unknown compression method",r.mode=Xa;break}if(f>>>=4,m-=4,B=(f&15)+8,r.wbits===0&&(r.wbits=B),B>15||B>r.wbits){t.msg="invalid window size",r.mode=Xa;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=f&512?W5:sc,f=0,m=0;break;case M5:for(;m<16;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}if(r.flags=f,(r.flags&255)!==P5){t.msg="unknown compression method",r.mode=Xa;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Xa;break}r.head&&(r.head.text=f>>8&1),r.flags&512&&r.wrap&4&&(L[0]=f&255,L[1]=f>>>8&255,r.check=wl(r.check,L,2,0)),f=0,m=0,r.mode=I5;case I5:for(;m<32;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}r.head&&(r.head.time=f),r.flags&512&&r.wrap&4&&(L[0]=f&255,L[1]=f>>>8&255,L[2]=f>>>16&255,L[3]=f>>>24&255,r.check=wl(r.check,L,4,0)),f=0,m=0,r.mode=B5;case B5:for(;m<16;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}r.head&&(r.head.xflags=f&255,r.head.os=f>>8),r.flags&512&&r.wrap&4&&(L[0]=f&255,L[1]=f>>>8&255,r.check=wl(r.check,L,2,0)),f=0,m=0,r.mode=U5;case U5:if(r.flags&1024){for(;m<16;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}r.length=f,r.head&&(r.head.extra_len=f),r.flags&512&&r.wrap&4&&(L[0]=f&255,L[1]=f>>>8&255,r.check=wl(r.check,L,2,0)),f=0,m=0}else r.head&&(r.head.extra=null);r.mode=q5;case q5:if(r.flags&1024&&(g=r.length,g>c&&(g=c),g&&(r.head&&(B=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(s,s+g),B)),r.flags&512&&r.wrap&4&&(r.check=wl(r.check,a,g,s)),c-=g,s+=g,r.length-=g),r.length))break e;r.length=0,r.mode=z5;case z5:if(r.flags&2048){if(c===0)break e;g=0;do B=a[s+g++],r.head&&B&&r.length<65536&&(r.head.name+=String.fromCharCode(B));while(B&&g<c);if(r.flags&512&&r.wrap&4&&(r.check=wl(r.check,a,g,s)),c-=g,s+=g,B)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=H5;case H5:if(r.flags&4096){if(c===0)break e;g=0;do B=a[s+g++],r.head&&B&&r.length<65536&&(r.head.comment+=String.fromCharCode(B));while(B&&g<c);if(r.flags&512&&r.wrap&4&&(r.check=wl(r.check,a,g,s)),c-=g,s+=g,B)break e}else r.head&&(r.head.comment=null);r.mode=$5;case $5:if(r.flags&512){for(;m<16;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}if(r.wrap&4&&f!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Xa;break}f=0,m=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=sc;break;case W5:for(;m<32;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}t.adler=r.check=nS(f),f=0,m=0,r.mode=u1;case u1:if(r.havedict===0)return t.next_out=l,t.avail_out=d,t.next_in=s,t.avail_in=c,r.hold=f,r.bits=m,pq;t.adler=r.check=1,r.mode=sc;case sc:if(e===hq||e===jp)break e;case kv:if(r.last){f>>>=m&7,m-=m&7,r.mode=Av;break}for(;m<3;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}switch(r.last=f&1,f>>>=1,m-=1,f&3){case 0:r.mode=V5;break;case 1:if(Sq(r),r.mode=kp,e===jp){f>>>=2,m-=2;break e}break;case 2:r.mode=Y5;break;case 3:t.msg="invalid block type",r.mode=Xa}f>>>=2,m-=2;break;case V5:for(f>>>=m&7,m-=m&7;m<32;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}if((f&65535)!==(f>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Xa;break}if(r.length=f&65535,f=0,m=0,r.mode=Ev,e===jp)break e;case Ev:r.mode=G5;case G5:if(g=r.length,g){if(g>c&&(g=c),g>d&&(g=d),g===0)break e;n.set(a.subarray(s,s+g),l),c-=g,s+=g,d-=g,l+=g,r.length-=g;break}r.mode=sc;break;case Y5:for(;m<14;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}if(r.nlen=(f&31)+257,f>>>=5,m-=5,r.ndist=(f&31)+1,f>>>=5,m-=5,r.ncode=(f&15)+4,f>>>=4,m-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Xa;break}r.have=0,r.mode=X5;case X5:for(;r.have<r.ncode;){for(;m<3;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}r.lens[T[r.have++]]=f&7,f>>>=3,m-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Z={bits:r.lenbits},q=E0(fq,r.lens,0,19,r.lencode,0,r.work,Z),r.lenbits=Z.bits,q){t.msg="invalid code lengths set",r.mode=Xa;break}r.have=0,r.mode=K5;case K5:for(;r.have<r.nlen+r.ndist;){for(;w=r.lencode[f&(1<<r.lenbits)-1],E=w>>>24,C=w>>>16&255,A=w&65535,!(E<=m);){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}if(A<16)f>>>=E,m-=E,r.lens[r.have++]=A;else{if(A===16){for(D=E+2;m<D;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}if(f>>>=E,m-=E,r.have===0){t.msg="invalid bit length repeat",r.mode=Xa;break}B=r.lens[r.have-1],g=3+(f&3),f>>>=2,m-=2}else if(A===17){for(D=E+3;m<D;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}f>>>=E,m-=E,B=0,g=3+(f&7),f>>>=3,m-=3}else{for(D=E+7;m<D;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}f>>>=E,m-=E,B=0,g=11+(f&127),f>>>=7,m-=7}if(r.have+g>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Xa;break}for(;g--;)r.lens[r.have++]=B}}if(r.mode===Xa)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Xa;break}if(r.lenbits=9,Z={bits:r.lenbits},q=E0(Rj,r.lens,0,r.nlen,r.lencode,0,r.work,Z),r.lenbits=Z.bits,q){t.msg="invalid literal/lengths set",r.mode=Xa;break}if(r.distbits=6,r.distcode=r.distdyn,Z={bits:r.distbits},q=E0(Dj,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Z),r.distbits=Z.bits,q){t.msg="invalid distances set",r.mode=Xa;break}if(r.mode=kp,e===jp)break e;case kp:r.mode=Ep;case Ep:if(c>=6&&d>=258){t.next_out=l,t.avail_out=d,t.next_in=s,t.avail_in=c,r.hold=f,r.bits=m,iq(t,x),l=t.next_out,n=t.output,d=t.avail_out,s=t.next_in,a=t.input,c=t.avail_in,f=r.hold,m=r.bits,r.mode===sc&&(r.back=-1);break}for(r.back=0;w=r.lencode[f&(1<<r.lenbits)-1],E=w>>>24,C=w>>>16&255,A=w&65535,!(E<=m);){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}if(C&&(C&240)===0){for(O=E,G=C,W=A;w=r.lencode[W+((f&(1<<O+G)-1)>>O)],E=w>>>24,C=w>>>16&255,A=w&65535,!(O+E<=m);){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}f>>>=O,m-=O,r.back+=O}if(f>>>=E,m-=E,r.back+=E,r.length=A,C===0){r.mode=tS;break}if(C&32){r.back=-1,r.mode=sc;break}if(C&64){t.msg="invalid literal/length code",r.mode=Xa;break}r.extra=C&15,r.mode=J5;case J5:if(r.extra){for(D=r.extra;m<D;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,m-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=Z5;case Z5:for(;w=r.distcode[f&(1<<r.distbits)-1],E=w>>>24,C=w>>>16&255,A=w&65535,!(E<=m);){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}if((C&240)===0){for(O=E,G=C,W=A;w=r.distcode[W+((f&(1<<O+G)-1)>>O)],E=w>>>24,C=w>>>16&255,A=w&65535,!(O+E<=m);){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}f>>>=O,m-=O,r.back+=O}if(f>>>=E,m-=E,r.back+=E,C&64){t.msg="invalid distance code",r.mode=Xa;break}r.offset=A,r.extra=C&15,r.mode=Q5;case Q5:if(r.extra){for(D=r.extra;m<D;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,m-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Xa;break}r.mode=eS;case eS:if(d===0)break e;if(g=x-d,r.offset>g){if(g=r.offset-g,g>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Xa;break}g>r.wnext?(g-=r.wnext,b=r.wsize-g):b=r.wnext-g,g>r.length&&(g=r.length),_=r.window}else _=n,b=l-r.offset,g=r.length;g>d&&(g=d),d-=g,r.length-=g;do n[l++]=_[b++];while(--g);r.length===0&&(r.mode=Ep);break;case tS:if(d===0)break e;n[l++]=r.length,d--,r.mode=Ep;break;case Av:if(r.wrap){for(;m<32;){if(c===0)break e;c--,f|=a[s++]<<m,m+=8}if(x-=d,t.total_out+=x,r.total+=x,r.wrap&4&&x&&(t.adler=r.check=r.flags?wl(r.check,n,x,l-x):Mx(r.check,n,x,l-x)),x=d,r.wrap&4&&(r.flags?f:nS(f))!==r.check){t.msg="incorrect data check",r.mode=Xa;break}f=0,m=0}r.mode=rS;case rS:if(r.wrap&&r.flags){for(;m<32;){if(c===0)break e;c--,f+=a[s++]<<m,m+=8}if(r.wrap&4&&f!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Xa;break}f=0,m=0}r.mode=aS;case aS:q=mq;break e;case Xa:q=Fj;break e;case Pj:return Lj;case Mj:default:return po}return t.next_out=l,t.avail_out=d,t.next_in=s,t.avail_in=c,r.hold=f,r.bits=m,(r.wsize||x!==t.avail_out&&r.mode<Xa&&(r.mode<Av||e!==L5))&&zj(t,t.output,t.next_out,x-t.avail_out),v-=t.avail_in,x-=t.avail_out,t.total_in+=v,t.total_out+=x,r.total+=x,r.wrap&4&&x&&(t.adler=r.check=r.flags?wl(r.check,n,x,t.next_out-x):Mx(r.check,n,x,t.next_out-x)),t.data_type=r.bits+(r.last?64:0)+(r.mode===sc?128:0)+(r.mode===kp||r.mode===Ev?256:0),(v===0&&x===0||e===L5)&&q===Cd&&(q=gq),q},jq=t=>{if(Bd(t))return po;let e=t.state;return e.window&&(e.window=null),t.state=null,Cd},kq=(t,e)=>{if(Bd(t))return po;const r=t.state;return(r.wrap&2)===0?po:(r.head=e,e.done=!1,Cd)},Eq=(t,e)=>{const r=e.length;let a,n,s;return Bd(t)||(a=t.state,a.wrap!==0&&a.mode!==u1)?po:a.mode===u1&&(n=1,n=Mx(n,e,r,0),n!==a.check)?Fj:(s=zj(t,e,r,r),s?(a.mode=Pj,Lj):(a.havedict=1,Cd))};var Aq=Bj,Cq=Uj,Tq=Ij,Oq=wq,Rq=qj,Dq=Nq,Fq=jq,Lq=kq,Pq=Eq,Mq="pako inflate (from Nodeca project)",oc={inflateReset:Aq,inflateReset2:Cq,inflateResetKeep:Tq,inflateInit:Oq,inflateInit2:Rq,inflate:Dq,inflateEnd:Fq,inflateGetHeader:Lq,inflateSetDictionary:Pq,inflateInfo:Mq};function Iq(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Bq=Iq;const Hj=Object.prototype.toString,{Z_NO_FLUSH:Uq,Z_FINISH:qq,Z_OK:K0,Z_STREAM_END:Ov,Z_NEED_DICT:Rv,Z_STREAM_ERROR:zq,Z_DATA_ERROR:iS,Z_MEM_ERROR:Hq}=Cj;function lm(t){this.options=Tj.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new nq,this.strm.avail_out=0;let r=oc.inflateInit2(this.strm,e.windowBits);if(r!==K0)throw new Error(Ix[r]);if(this.header=new Bq,oc.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Bx.string2buf(e.dictionary):Hj.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=oc.inflateSetDictionary(this.strm,e.dictionary),r!==K0)))throw new Error(Ix[r])}lm.prototype.push=function(t,e){const r=this.strm,a=this.options.chunkSize,n=this.options.dictionary;let s,l,c;if(this.ended)return!1;for(e===~~e?l=e:l=e===!0?qq:Uq,Hj.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),s=oc.inflate(r,l),s===Rv&&n&&(s=oc.inflateSetDictionary(r,n),s===K0?s=oc.inflate(r,l):s===iS&&(s=Rv));r.avail_in>0&&s===Ov&&r.state.wrap>0&&t[r.next_in]!==0;)oc.inflateReset(r),s=oc.inflate(r,l);switch(s){case zq:case iS:case Rv:case Hq:return this.onEnd(s),this.ended=!0,!1}if(c=r.avail_out,r.next_out&&(r.avail_out===0||s===Ov))if(this.options.to==="string"){let d=Bx.utf8border(r.output,r.next_out),f=r.next_out-d,m=Bx.buf2string(r.output,d);r.next_out=f,r.avail_out=a-f,f&&r.output.set(r.output.subarray(d,d+f),0),this.onData(m)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===K0&&c===0)){if(s===Ov)return s=oc.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};lm.prototype.onData=function(t){this.chunks.push(t)};lm.prototype.onEnd=function(t){t===K0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Tj.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function $q(t,e){const r=new lm(e);if(r.push(t),r.err)throw r.msg||Ix[r.err];return r.result}var Wq=lm,Vq=$q,Gq={Inflate:Wq,inflate:Vq};const{Inflate:Yq,inflate:Xq}=Gq;var oS=Yq,Kq=Xq;const $j=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;$j[t]=e}const lS=4294967295;function Jq(t,e,r){let a=t;for(let n=0;n<r;n++)a=$j[(a^e[n])&255]^a>>>8;return a}function Zq(t,e){return(Jq(lS,t,e)^lS)>>>0}function cS(t,e,r){const a=t.readUint32(),n=Zq(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(n!==a)throw new Error(`CRC mismatch for chunk ${r}. Expected ${a}, found ${n}`)}function Wj(t,e,r){for(let a=0;a<r;a++)e[a]=t[a]}function Vj(t,e,r,a){let n=0;for(;n<a;n++)e[n]=t[n];for(;n<r;n++)e[n]=t[n]+e[n-a]&255}function Gj(t,e,r,a){let n=0;if(r.length===0)for(;n<a;n++)e[n]=t[n];else for(;n<a;n++)e[n]=t[n]+r[n]&255}function Yj(t,e,r,a,n){let s=0;if(r.length===0){for(;s<n;s++)e[s]=t[s];for(;s<a;s++)e[s]=t[s]+(e[s-n]>>1)&255}else{for(;s<n;s++)e[s]=t[s]+(r[s]>>1)&255;for(;s<a;s++)e[s]=t[s]+(e[s-n]+r[s]>>1)&255}}function Xj(t,e,r,a,n){let s=0;if(r.length===0){for(;s<n;s++)e[s]=t[s];for(;s<a;s++)e[s]=t[s]+e[s-n]&255}else{for(;s<n;s++)e[s]=t[s]+r[s]&255;for(;s<a;s++)e[s]=t[s]+Qq(e[s-n],r[s],r[s-n])&255}}function Qq(t,e,r){const a=t+e-r,n=Math.abs(a-t),s=Math.abs(a-e),l=Math.abs(a-r);return n<=s&&n<=l?t:s<=l?e:r}function ez(t,e,r,a,n,s){switch(t){case 0:Wj(e,r,n);break;case 1:Vj(e,r,n,s);break;case 2:Gj(e,r,a,n);break;case 3:Yj(e,r,a,n,s);break;case 4:Xj(e,r,a,n,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const tz=new Uint16Array([255]),rz=new Uint8Array(tz.buffer),az=rz[0]===255;function nz(t){const{data:e,width:r,height:a,channels:n,depth:s}=t,l=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],c=Math.ceil(s/8)*n,d=new Uint8Array(a*r*c);let f=0;for(let m=0;m<7;m++){const v=l[m],x=Math.ceil((r-v.x)/v.xStep),g=Math.ceil((a-v.y)/v.yStep);if(x<=0||g<=0)continue;const b=x*c,_=new Uint8Array(b);for(let w=0;w<g;w++){const E=e[f++],C=e.subarray(f,f+b);f+=b;const A=new Uint8Array(b);ez(E,C,A,_,b,c),_.set(A);for(let O=0;O<x;O++){const G=v.x+O*v.xStep,W=v.y+w*v.yStep;if(!(G>=r||W>=a))for(let B=0;B<c;B++)d[(W*r+G)*c+B]=A[O*c+B]}}}if(s===16){const m=new Uint16Array(d.buffer);if(az)for(let v=0;v<m.length;v++)m[v]=sz(m[v]);return m}else return d}function sz(t){return(t&255)<<8|t>>8&255}const iz=new Uint16Array([255]),oz=new Uint8Array(iz.buffer),lz=oz[0]===255,cz=new Uint8Array(0);function uS(t){const{data:e,width:r,height:a,channels:n,depth:s}=t,l=Math.ceil(s/8)*n,c=Math.ceil(s/8*n*r),d=new Uint8Array(a*c);let f=cz,m=0,v,x;for(let g=0;g<a;g++){switch(v=e.subarray(m+1,m+1+c),x=d.subarray(g*c,(g+1)*c),e[m]){case 0:Wj(v,x,c);break;case 1:Vj(v,x,c,l);break;case 2:Gj(v,x,f,c);break;case 3:Yj(v,x,f,c,l);break;case 4:Xj(v,x,f,c,l);break;default:throw new Error(`Unsupported filter: ${e[m]}`)}f=x,m+=c+1}if(s===16){const g=new Uint16Array(d.buffer);if(lz)for(let b=0;b<g.length;b++)g[b]=uz(g[b]);return g}else return d}function uz(t){return(t&255)<<8|t>>8&255}const Ip=Uint8Array.of(137,80,78,71,13,10,26,10);function dS(t){if(!dz(t.readBytes(Ip.length)))throw new Error("wrong PNG signature")}function dz(t){if(t.length<Ip.length)return!1;for(let e=0;e<Ip.length;e++)if(t[e]!==Ip[e])return!1;return!0}const fz="tEXt",hz=0,Kj=new TextDecoder("latin1");function mz(t){if(gz(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const pz=/^[\u0000-\u00FF]*$/;function gz(t){if(!pz.test(t))throw new Error("invalid latin1 text")}function vz(t,e,r){const a=Jj(e);t[a]=xz(e,r-a.length-1)}function Jj(t){for(t.mark();t.readByte()!==hz;);const e=t.offset;t.reset();const r=Kj.decode(t.readBytes(e-t.offset-1));return t.skip(1),mz(r),r}function xz(t,e){return Kj.decode(t.readBytes(e))}const Oi={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Dv={UNKNOWN:-1,DEFLATE:0},fS={UNKNOWN:-1,ADAPTIVE:0},Fv={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Ap={NONE:0,BACKGROUND:1,PREVIOUS:2},Lv={SOURCE:0,OVER:1};class yz extends Z2{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,r={}){super(e);const{checkCrc:a=!1}=r;this._checkCrc=a,this._inflator=new oS,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Dv.UNKNOWN,this._filterMethod=fS.UNKNOWN,this._interlaceMethod=Fv.UNKNOWN,this._colorType=Oi.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(dS(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeChunk(e,r)}return this.decodeImage(),this._png}decodeApng(){for(dS(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(e,r)}return this.decodeApngImage(),this._apng}decodeChunk(e,r){const a=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case fz:vz(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-a!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?cS(this,e+4,r):this.skip(4)}decodeApngChunk(e,r){const a=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,r),this.offset=a+e;break}if(this.offset-a!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?cS(this,e+4,r):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=_z(this.readUint8());const r=this.readUint8();this._colorType=r;let a;switch(r){case Oi.GREYSCALE:a=1;break;case Oi.TRUECOLOUR:a=3;break;case Oi.INDEXED_COLOUR:a=1;break;case Oi.GREYSCALE_ALPHA:a=2;break;case Oi.TRUECOLOUR_ALPHA:a=4;break;case Oi.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==Dv.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const r=e/3;this._hasPalette=!0;const a=[];this._palette=a;for(let n=0;n<r;n++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const r=e,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let r=e,a=this.offset+this.byteOffset;if(a+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Oi.GREYSCALE:case Oi.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let r=0;r<e/2;r++)this._transparency[r]=this.readUint16();break}case Oi.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let r=0;for(;r<e;r++){const a=this.readByte();this._palette[r].push(a)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case Oi.UNKNOWN:case Oi.GREYSCALE_ALPHA:case Oi.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const r=Jj(this),a=this.readUint8();if(a!==Dv.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const n=this.readBytes(e-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:Kq(n)}}decodepHYs(){const e=this.readUint32(),r=this.readUint32(),a=this.readByte();this._png.resolution={x:e,y:r,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const r={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(e);if(a){if(a.data=uS({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)r.data=a.data;else{const n=this._apng.frames.at(e-1);this.disposeFrame(a,n,r),this.addFrameDataToCanvas(r,a)}this._apng.frames.push(r)}}return this._apng}disposeFrame(e,r,a){switch(e.disposeOp){case Ap.NONE:break;case Ap.BACKGROUND:for(let n=0;n<this._png.height;n++)for(let s=0;s<this._png.width;s++){const l=(n*e.width+s)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case Ap.PREVIOUS:a.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,r){const a=1<<this._png.depth,n=(s,l)=>{const c=((s+r.yOffset)*this._png.width+r.xOffset+l)*this._png.channels,d=(s*r.width+l)*this._png.channels;return{index:c,frameIndex:d}};switch(r.blendOp){case Lv.SOURCE:for(let s=0;s<r.height;s++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:d}=n(s,l);for(let f=0;f<this._png.channels;f++)e.data[c+f]=r.data[d+f]}break;case Lv.OVER:for(let s=0;s<r.height;s++)for(let l=0;l<r.width;l++){const{index:c,frameIndex:d}=n(s,l);for(let f=0;f<this._png.channels;f++){const m=r.data[d+this._png.channels-1]/a,v=f%(this._png.channels-1)===0?1:r.data[d+f],x=Math.floor(m*v+(1-m)*e.data[c+f]);e.data[c+f]+=x}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==fS.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Fv.NO_INTERLACE)this._png.data=uS({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Fv.ADAM7)this._png.data=nz({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,r=this._frames.at(-1);r?r.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Ap.NONE,blendOp:Lv.SOURCE,data:e}),this._inflator=new oS,this._writingDataChunks=!1}}function _z(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var hS;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(hS||(hS={}));function bz(t,e){return new yz(t,e).decode()}var kr=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Pv(){kr.console&&typeof kr.console.log=="function"&&kr.console.log.apply(kr.console,arguments)}var Oa={log:Pv,warn:function(t){kr.console&&(typeof kr.console.warn=="function"?kr.console.warn.apply(kr.console,arguments):Pv.call(null,arguments))},error:function(t){kr.console&&(typeof kr.console.error=="function"?kr.console.error.apply(kr.console,arguments):Pv(t))}};function Mv(t,e,r){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="blob",a.onload=function(){od(a.response,e,r)},a.onerror=function(){Oa.error("could not download file")},a.send()}function mS(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Cp(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var od=kr.saveAs||((typeof window>"u"?"undefined":xa(window))!=="object"||window!==kr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var a=kr.URL||kr.webkitURL,n=document.createElement("a");e=e||t.name||"download",n.download=e,n.rel="noopener",typeof t=="string"?(n.href=t,n.origin!==location.origin?mS(n.href)?Mv(t,e,r):Cp(n,n.target="_blank"):Cp(n)):(n.href=a.createObjectURL(t),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){Cp(n)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(mS(t))Mv(t,e,r);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout(function(){Cp(a)})}else navigator.msSaveOrOpenBlob((function(n,s){return s===void 0?s={autoBom:!1}:xa(s)!=="object"&&(Oa.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(t,r),e)}:function(t,e,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof t=="string")return Mv(t,e,r);var n=t.type==="application/octet-stream",s=/constructor/i.test(kr.HTMLElement)||kr.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||n&&s)&&(typeof FileReader>"u"?"undefined":xa(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var m=c.result;m=l?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=m:location=m,a=null},c.readAsDataURL(t)}else{var d=kr.URL||kr.webkitURL,f=d.createObjectURL(t);a?a.location=f:location.href=f,a=null,setTimeout(function(){d.revokeObjectURL(f)},4e4)}});function Zj(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,s=r[a].process,l=n.exec(t);l&&(e=s(l),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),d=this.g.toString(16),f=this.b.toString(16);return c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),f.length==1&&(f="0"+f),"#"+c+d+f}}var Bp=kr.atob.bind(kr),pS=kr.btoa.bind(kr);function Iv(t,e){var r=t[0],a=t[1],n=t[2],s=t[3];r=As(r,a,n,s,e[0],7,-680876936),s=As(s,r,a,n,e[1],12,-389564586),n=As(n,s,r,a,e[2],17,606105819),a=As(a,n,s,r,e[3],22,-1044525330),r=As(r,a,n,s,e[4],7,-176418897),s=As(s,r,a,n,e[5],12,1200080426),n=As(n,s,r,a,e[6],17,-1473231341),a=As(a,n,s,r,e[7],22,-45705983),r=As(r,a,n,s,e[8],7,1770035416),s=As(s,r,a,n,e[9],12,-1958414417),n=As(n,s,r,a,e[10],17,-42063),a=As(a,n,s,r,e[11],22,-1990404162),r=As(r,a,n,s,e[12],7,1804603682),s=As(s,r,a,n,e[13],12,-40341101),n=As(n,s,r,a,e[14],17,-1502002290),r=Cs(r,a=As(a,n,s,r,e[15],22,1236535329),n,s,e[1],5,-165796510),s=Cs(s,r,a,n,e[6],9,-1069501632),n=Cs(n,s,r,a,e[11],14,643717713),a=Cs(a,n,s,r,e[0],20,-373897302),r=Cs(r,a,n,s,e[5],5,-701558691),s=Cs(s,r,a,n,e[10],9,38016083),n=Cs(n,s,r,a,e[15],14,-660478335),a=Cs(a,n,s,r,e[4],20,-405537848),r=Cs(r,a,n,s,e[9],5,568446438),s=Cs(s,r,a,n,e[14],9,-1019803690),n=Cs(n,s,r,a,e[3],14,-187363961),a=Cs(a,n,s,r,e[8],20,1163531501),r=Cs(r,a,n,s,e[13],5,-1444681467),s=Cs(s,r,a,n,e[2],9,-51403784),n=Cs(n,s,r,a,e[7],14,1735328473),r=Ts(r,a=Cs(a,n,s,r,e[12],20,-1926607734),n,s,e[5],4,-378558),s=Ts(s,r,a,n,e[8],11,-2022574463),n=Ts(n,s,r,a,e[11],16,1839030562),a=Ts(a,n,s,r,e[14],23,-35309556),r=Ts(r,a,n,s,e[1],4,-1530992060),s=Ts(s,r,a,n,e[4],11,1272893353),n=Ts(n,s,r,a,e[7],16,-155497632),a=Ts(a,n,s,r,e[10],23,-1094730640),r=Ts(r,a,n,s,e[13],4,681279174),s=Ts(s,r,a,n,e[0],11,-358537222),n=Ts(n,s,r,a,e[3],16,-722521979),a=Ts(a,n,s,r,e[6],23,76029189),r=Ts(r,a,n,s,e[9],4,-640364487),s=Ts(s,r,a,n,e[12],11,-421815835),n=Ts(n,s,r,a,e[15],16,530742520),r=Os(r,a=Ts(a,n,s,r,e[2],23,-995338651),n,s,e[0],6,-198630844),s=Os(s,r,a,n,e[7],10,1126891415),n=Os(n,s,r,a,e[14],15,-1416354905),a=Os(a,n,s,r,e[5],21,-57434055),r=Os(r,a,n,s,e[12],6,1700485571),s=Os(s,r,a,n,e[3],10,-1894986606),n=Os(n,s,r,a,e[10],15,-1051523),a=Os(a,n,s,r,e[1],21,-2054922799),r=Os(r,a,n,s,e[8],6,1873313359),s=Os(s,r,a,n,e[15],10,-30611744),n=Os(n,s,r,a,e[6],15,-1560198380),a=Os(a,n,s,r,e[13],21,1309151649),r=Os(r,a,n,s,e[4],6,-145523070),s=Os(s,r,a,n,e[11],10,-1120210379),n=Os(n,s,r,a,e[2],15,718787259),a=Os(a,n,s,r,e[9],21,-343485551),t[0]=vu(r,t[0]),t[1]=vu(a,t[1]),t[2]=vu(n,t[2]),t[3]=vu(s,t[3])}function T1(t,e,r,a,n,s){return e=vu(vu(e,t),vu(a,s)),vu(e<<n|e>>>32-n,r)}function As(t,e,r,a,n,s,l){return T1(e&r|~e&a,t,e,n,s,l)}function Cs(t,e,r,a,n,s,l){return T1(e&a|r&~a,t,e,n,s,l)}function Ts(t,e,r,a,n,s,l){return T1(e^r^a,t,e,n,s,l)}function Os(t,e,r,a,n,s,l){return T1(r^(e|~a),t,e,n,s,l)}function Qj(t){var e,r=t.length,a=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Iv(a,wz(t.substring(e-64,e)));t=t.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)n[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(Iv(a,n),e=0;e<16;e++)n[e]=0;return n[14]=8*r,Iv(a,n),a}function wz(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var gS="0123456789abcdef".split("");function Sz(t){for(var e="",r=0;r<4;r++)e+=gS[t>>8*r+4&15]+gS[t>>8*r&15];return e}function Nz(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Ux(t){return Qj(t).map(Nz).join("")}var jz=(function(t){for(var e=0;e<t.length;e++)t[e]=Sz(t[e]);return t.join("")})(Qj("hello"))!="5d41402abc4b2a76b9719d911017c592";function vu(t,e){if(jz){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}function qx(t,e){var r,a,n,s;if(t!==r){for(var l=(n=t,s=1+(256/t.length|0),new Array(s+1).join(n)),c=[],d=0;d<256;d++)c[d]=d;var f=0;for(d=0;d<256;d++){var m=c[d];f=(f+m+l.charCodeAt(d))%256,c[d]=c[f],c[f]=m}r=t,a=c}else c=a;var v=e.length,x=0,g=0,b="";for(d=0;d<v;d++)g=(g+(m=c[x=(x+1)%256]))%256,c[x]=c[g],c[g]=m,l=c[(c[x]+c[g])%256],b+=String.fromCharCode(e.charCodeAt(d)^l);return b}var vS={print:4,modify:8,copy:16,"annot-forms":32};function Gf(t,e,r,a){this.v=1,this.r=2;var n=192;t.forEach(function(c){if(vS.perm!==void 0)throw new Error("Invalid permission: "+c);n+=vS[c]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),l=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,l),this.P=-(1+(255^n)),this.encryptionKey=Ux(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=qx(this.encryptionKey,this.padding)}function Yf(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,a=0;a<r;a++){var n=t.charCodeAt(a);e+=n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?"#"+("0"+n.toString(16)).slice(-2):t[a]}return e}function xS(t){if(xa(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var s=Math.random().toString(35);return e[r][s]=[a,!!n],s},this.unsubscribe=function(r){for(var a in e)if(e[a][r])return delete e[a][r],Object.keys(e[a]).length===0&&delete e[a],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var s in e[r]){var l=e[r][s];try{l[0].apply(t,a)}catch(c){kr.console&&Oa.error("jsPDF PubSub Error",c.message,c)}l[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function d1(t){if(!(this instanceof d1))return new d1(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function ek(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function fd(t,e,r,a,n){if(!(this instanceof fd))return new fd(t,e,r,a,n);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,ek.call(this,a,n)}function Kf(t,e,r,a,n){if(!(this instanceof Kf))return new Kf(t,e,r,a,n);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,ek.call(this,a,n)}function ur(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],s=arguments[3],l=[],c=1,d=16,f="S",m=null;xa(t=t||{})==="object"&&(r=t.orientation,a=t.unit||a,n=t.format||n,s=t.compress||t.compressPdf||s,(m=t.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),c=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(d=t.floatPrecision),f=t.defaultPathOperation||"S"),l=t.filters||(s===!0?["FlateEncode"]:l),a=a||"mm",r=(""+(r||"P")).toLowerCase();var v=t.putOnlyUsedFonts||!1,x={},g={internal:{},__private__:{}};g.__private__.PubSub=xS;var b="1.3",_=g.__private__.getPdfVersion=function(){return b};g.__private__.setPdfVersion=function(R){b=R};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return w};var E=g.__private__.getPageFormat=function(R){return w[R]};n=n||"a4";var C="compat",A="advanced",O=C;function G(){this.saveGraphicsState(),ue(new ir(Ce,0,0,-Ce,0,No()*Ce).toString()+" cm"),this.setFontSize(this.getFontSize()/Ce),f="n",O=A}function W(){this.restoreGraphicsState(),f="S",O=C}var B=g.__private__.combineFontStyleAndFontWeight=function(R,Q){if(R=="bold"&&Q=="normal"||R=="bold"&&Q==400||R=="normal"&&Q=="italic"||R=="bold"&&Q=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Q&&(R=Q==400||Q==="normal"?R==="italic"?"italic":"normal":Q!=700&&Q!=="bold"||R!=="normal"?(Q==700?"bold":Q)+""+R:"bold"),R};g.advancedAPI=function(R){var Q=O===C;return Q&&G.call(this),typeof R!="function"||(R(this),Q&&W.call(this)),this},g.compatAPI=function(R){var Q=O===A;return Q&&W.call(this),typeof R!="function"||(R(this),Q&&G.call(this)),this},g.isAdvancedAPI=function(){return O===A};var q,L=function(R){if(O!==A)throw new Error(R+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Z=g.roundToPrecision=g.__private__.roundToPrecision=function(R,Q){var Ae=e||Q;if(isNaN(R)||isNaN(Ae))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return R.toFixed(Ae).replace(/0+$/,"")};q=g.hpf=g.__private__.hpf=typeof d=="number"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return Z(R,d)}:d==="smart"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return Z(R,R>-1&&R<1?16:5)}:function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return Z(R,16)};var D=g.f2=g.__private__.f2=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f2");return Z(R,2)},T=g.__private__.f3=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f3");return Z(R,3)},M=g.scale=g.__private__.scale=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.scale");return O===C?R*Ce:O===A?R:void 0},V=function(R){return M((function(Q){return O===C?No()-Q:O===A?Q:void 0})(R))};g.__private__.setPrecision=g.setPrecision=function(R){typeof parseInt(R,10)=="number"&&(e=parseInt(R,10))};var ie,X="00000000000000000000000000000000",J=g.__private__.getFileId=function(){return X},K=g.__private__.setFileId=function(R){return X=R!==void 0&&/^[a-fA-F0-9]{32}$/.test(R)?R.toUpperCase():X.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(yn=new Gf(m.userPermissions,m.userPassword,m.ownerPassword,X)),X};g.setFileId=function(R){return K(R),this},g.getFileId=function(){return J()};var te=g.__private__.convertDateToPDFDate=function(R){var Q=R.getTimezoneOffset(),Ae=Q<0?"+":"-",Re=Math.floor(Math.abs(Q/60)),ze=Math.abs(Q%60),mt=[Ae,I(Re),"'",I(ze),"'"].join("");return["D:",R.getFullYear(),I(R.getMonth()+1),I(R.getDate()),I(R.getHours()),I(R.getMinutes()),I(R.getSeconds()),mt].join("")},fe=g.__private__.convertPDFDateToDate=function(R){var Q=parseInt(R.substr(2,4),10),Ae=parseInt(R.substr(6,2),10)-1,Re=parseInt(R.substr(8,2),10),ze=parseInt(R.substr(10,2),10),mt=parseInt(R.substr(12,2),10),_t=parseInt(R.substr(14,2),10);return new Date(Q,Ae,Re,ze,mt,_t,0)},U=g.__private__.setCreationDate=function(R){var Q;if(R===void 0&&(R=new Date),R instanceof Date)Q=te(R);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(R))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Q=R}return ie=Q},j=g.__private__.getCreationDate=function(R){var Q=ie;return R==="jsDate"&&(Q=fe(ie)),Q};g.setCreationDate=function(R){return U(R),this},g.getCreationDate=function(R){return j(R)};var F,I=g.__private__.padd2=function(R){return("0"+parseInt(R)).slice(-2)},z=g.__private__.padd2Hex=function(R){return("00"+(R=R.toString())).substr(R.length)},ne=0,se=[],je=[],Ne=0,ge=[],Ie=[],le=!1,Ge=je;g.__private__.setCustomOutputDestination=function(R){le=!0,Ge=R};var rt=function(R){le||(Ge=R)};g.__private__.resetCustomOutputDestination=function(){le=!1,Ge=je};var ue=g.__private__.out=function(R){return R=R.toString(),Ne+=R.length+1,Ge.push(R),Ge},ot=g.__private__.write=function(R){return ue(arguments.length===1?R.toString():Array.prototype.join.call(arguments," "))},xe=g.__private__.getArrayBuffer=function(R){for(var Q=R.length,Ae=new ArrayBuffer(Q),Re=new Uint8Array(Ae);Q--;)Re[Q]=R.charCodeAt(Q);return Ae},ve=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return ve};var Be=t.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(R){return Be=O===A?R/Ce:R,this};var jt,Je=g.__private__.getFontSize=g.getFontSize=function(){return O===C?Be:Be*Ce},ct=t.R2L||!1;g.__private__.setR2L=g.setR2L=function(R){return ct=R,this},g.__private__.getR2L=g.getR2L=function(){return ct};var St,Ft=g.__private__.setZoomMode=function(R){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(R))jt=R;else if(isNaN(R)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(R)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+R+'" is not recognized.');jt=R}else jt=parseInt(R,10)};g.__private__.getZoomMode=function(){return jt};var Xt,Ut=g.__private__.setPageMode=function(R){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(R)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+R+'" is not recognized.');St=R};g.__private__.getPageMode=function(){return St};var Wt=g.__private__.setLayoutMode=function(R){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(R)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+R+'" is not recognized.');Xt=R};g.__private__.getLayoutMode=function(){return Xt},g.__private__.setDisplayMode=g.setDisplayMode=function(R,Q,Ae){return Ft(R),Wt(Q),Ut(Ae),this};var $t={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(R){if(Object.keys($t).indexOf(R)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return $t[R]},g.__private__.getDocumentProperties=function(){return $t},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(R){for(var Q in $t)$t.hasOwnProperty(Q)&&R[Q]&&($t[Q]=R[Q]);return this},g.__private__.setDocumentProperty=function(R,Q){if(Object.keys($t).indexOf(R)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return $t[R]=Q};var wt,Ce,st,Dt,At,Ct={},Te={},Ve=[],_e={},Ue={},Fe={},gt={},Ht=null,Vt=0,zt=[],kt=new xS(g),sr=t.hotfixes||[],Pr={},Nt={},fa=[],ir=function R(Q,Ae,Re,ze,mt,_t){if(!(this instanceof R))return new R(Q,Ae,Re,ze,mt,_t);isNaN(Q)&&(Q=1),isNaN(Ae)&&(Ae=0),isNaN(Re)&&(Re=0),isNaN(ze)&&(ze=1),isNaN(mt)&&(mt=0),isNaN(_t)&&(_t=0),this._matrix=[Q,Ae,Re,ze,mt,_t]};Object.defineProperty(ir.prototype,"sx",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(ir.prototype,"shy",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(ir.prototype,"shx",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(ir.prototype,"sy",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(ir.prototype,"tx",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(ir.prototype,"ty",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(ir.prototype,"a",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(ir.prototype,"b",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(ir.prototype,"c",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(ir.prototype,"d",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(ir.prototype,"e",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(ir.prototype,"f",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(ir.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ir.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ir.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ir.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ir.prototype.join=function(R){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(q).join(R)},ir.prototype.multiply=function(R){var Q=R.sx*this.sx+R.shy*this.shx,Ae=R.sx*this.shy+R.shy*this.sy,Re=R.shx*this.sx+R.sy*this.shx,ze=R.shx*this.shy+R.sy*this.sy,mt=R.tx*this.sx+R.ty*this.shx+this.tx,_t=R.tx*this.shy+R.ty*this.sy+this.ty;return new ir(Q,Ae,Re,ze,mt,_t)},ir.prototype.decompose=function(){var R=this.sx,Q=this.shy,Ae=this.shx,Re=this.sy,ze=this.tx,mt=this.ty,_t=Math.sqrt(R*R+Q*Q),er=(R/=_t)*Ae+(Q/=_t)*Re;Ae-=R*er,Re-=Q*er;var or=Math.sqrt(Ae*Ae+Re*Re);return er/=or,R*(Re/=or)<Q*(Ae/=or)&&(R=-R,Q=-Q,er=-er,_t=-_t),{scale:new ir(_t,0,0,or,0,0),translate:new ir(1,0,0,1,ze,mt),rotate:new ir(R,Q,-Q,R,0,0),skew:new ir(1,0,er,1,0,0)}},ir.prototype.toString=function(R){return this.join(" ")},ir.prototype.inversed=function(){var R=this.sx,Q=this.shy,Ae=this.shx,Re=this.sy,ze=this.tx,mt=this.ty,_t=1/(R*Re-Q*Ae),er=Re*_t,or=-Q*_t,_r=-Ae*_t,Er=R*_t;return new ir(er,or,_r,Er,-er*ze-_r*mt,-or*ze-Er*mt)},ir.prototype.applyToPoint=function(R){var Q=R.x*this.sx+R.y*this.shx+this.tx,Ae=R.x*this.shy+R.y*this.sy+this.ty;return new Ks(Q,Ae)},ir.prototype.applyToRectangle=function(R){var Q=this.applyToPoint(R),Ae=this.applyToPoint(new Ks(R.x+R.w,R.y+R.h));return new yo(Q.x,Q.y,Ae.x-Q.x,Ae.y-Q.y)},ir.prototype.clone=function(){var R=this.sx,Q=this.shy,Ae=this.shx,Re=this.sy,ze=this.tx,mt=this.ty;return new ir(R,Q,Ae,Re,ze,mt)},g.Matrix=ir;var Ea=g.matrixMult=function(R,Q){return Q.multiply(R)},xn=new ir(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=xn;var Ra=function(R,Q){if(!Ue[R]){var Ae=(Q instanceof fd?"Sh":"P")+(Object.keys(_e).length+1).toString(10);Q.id=Ae,Ue[R]=Ae,_e[Ae]=Q,kt.publish("addPattern",Q)}};g.ShadingPattern=fd,g.TilingPattern=Kf,g.addShadingPattern=function(R,Q){return L("addShadingPattern()"),Ra(R,Q),this},g.beginTilingPattern=function(R){L("beginTilingPattern()"),Pl(R.boundingBox[0],R.boundingBox[1],R.boundingBox[2]-R.boundingBox[0],R.boundingBox[3]-R.boundingBox[1],R.matrix)},g.endTilingPattern=function(R,Q){L("endTilingPattern()"),Q.stream=Ie[F].join(`
`),Ra(R,Q),kt.publish("endTilingPattern",Q),fa.pop().restore()};var nn,Pt=g.__private__.newObject=function(){var R=Zt();return ae(R,!0),R},Zt=g.__private__.newObjectDeferred=function(){return ne++,se[ne]=function(){return Ne},ne},ae=function(R,Q){return Q=typeof Q=="boolean"&&Q,se[R]=Ne,Q&&ue(R+" 0 obj"),R},be=g.__private__.newAdditionalObject=function(){var R={objId:Zt(),content:""};return ge.push(R),R},me=Zt(),pe=Zt(),Se=g.__private__.decodeColorString=function(R){var Q=R.split(" ");if(Q.length!==2||Q[1]!=="g"&&Q[1]!=="G")Q.length!==5||Q[4]!=="k"&&Q[4]!=="K"||(Q=[(1-Q[0])*(1-Q[3]),(1-Q[1])*(1-Q[3]),(1-Q[2])*(1-Q[3]),"r"]);else{var Ae=parseFloat(Q[0]);Q=[Ae,Ae,Ae,"r"]}for(var Re="#",ze=0;ze<3;ze++)Re+=("0"+Math.floor(255*parseFloat(Q[ze])).toString(16)).slice(-2);return Re},we=g.__private__.encodeColorString=function(R){var Q;typeof R=="string"&&(R={ch1:R});var Ae=R.ch1,Re=R.ch2,ze=R.ch3,mt=R.ch4,_t=R.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ae=="string"&&Ae.charAt(0)!=="#"){var er=new Zj(Ae);if(er.ok)Ae=er.toHex();else if(!/^\d*\.?\d*$/.test(Ae))throw new Error('Invalid color "'+Ae+'" passed to jsPDF.encodeColorString.')}if(typeof Ae=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ae)&&(Ae="#"+Ae[1]+Ae[1]+Ae[2]+Ae[2]+Ae[3]+Ae[3]),typeof Ae=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ae)){var or=parseInt(Ae.substr(1),16);Ae=or>>16&255,Re=or>>8&255,ze=255&or}if(Re===void 0||mt===void 0&&Ae===Re&&Re===ze)Q=typeof Ae=="string"?Ae+" "+_t[0]:R.precision===2?D(Ae/255)+" "+_t[0]:T(Ae/255)+" "+_t[0];else if(mt===void 0||xa(mt)==="object"){if(mt&&!isNaN(mt.a)&&mt.a===0)return["1.","1.","1.",_t[1]].join(" ");Q=typeof Ae=="string"?[Ae,Re,ze,_t[1]].join(" "):R.precision===2?[D(Ae/255),D(Re/255),D(ze/255),_t[1]].join(" "):[T(Ae/255),T(Re/255),T(ze/255),_t[1]].join(" ")}else Q=typeof Ae=="string"?[Ae,Re,ze,mt,_t[2]].join(" "):R.precision===2?[D(Ae),D(Re),D(ze),D(mt),_t[2]].join(" "):[T(Ae),T(Re),T(ze),T(mt),_t[2]].join(" ");return Q},$e=g.__private__.getFilters=function(){return l},lt=g.__private__.putStream=function(R){var Q=(R=R||{}).data||"",Ae=R.filters||$e(),Re=R.alreadyAppliedFilters||[],ze=R.addLength1||!1,mt=Q.length,_t=R.objectId,er=function(_n){return _n};if(m!==null&&_t===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(er=yn.encryptor(_t,0));var or={};Ae===!0&&(Ae=["FlateEncode"]);var _r=R.additionalKeyValues||[],Er=(or=ur.API.processDataByFilters!==void 0?ur.API.processDataByFilters(Q,Ae):{data:Q,reverseChain:[]}).reverseChain+(Array.isArray(Re)?Re.join(" "):Re.toString());if(or.data.length!==0&&(_r.push({key:"Length",value:or.data.length}),ze===!0&&_r.push({key:"Length1",value:mt})),Er.length!=0)if(Er.split("/").length-1==1)_r.push({key:"Filter",value:Er});else{_r.push({key:"Filter",value:"["+Er+"]"});for(var Vr=0;Vr<_r.length;Vr+=1)if(_r[Vr].key==="DecodeParms"){for(var La=[],Ka=0;Ka<or.reverseChain.split("/").length-1;Ka+=1)La.push("null");La.push(_r[Vr].value),_r[Vr].value="["+La.join(" ")+"]"}}ue("<<");for(var _a=0;_a<_r.length;_a++)ue("/"+_r[_a].key+" "+_r[_a].value);ue(">>"),or.data.length!==0&&(ue("stream"),ue(er(or.data)),ue("endstream"))},Xe=g.__private__.putPage=function(R){var Q=R.number,Ae=R.data,Re=R.objId,ze=R.contentsObjId;ae(Re,!0),ue("<</Type /Page"),ue("/Parent "+R.rootDictionaryObjId+" 0 R"),ue("/Resources "+R.resourceDictionaryObjId+" 0 R"),ue("/MediaBox ["+parseFloat(q(R.mediaBox.bottomLeftX))+" "+parseFloat(q(R.mediaBox.bottomLeftY))+" "+q(R.mediaBox.topRightX)+" "+q(R.mediaBox.topRightY)+"]"),R.cropBox!==null&&ue("/CropBox ["+q(R.cropBox.bottomLeftX)+" "+q(R.cropBox.bottomLeftY)+" "+q(R.cropBox.topRightX)+" "+q(R.cropBox.topRightY)+"]"),R.bleedBox!==null&&ue("/BleedBox ["+q(R.bleedBox.bottomLeftX)+" "+q(R.bleedBox.bottomLeftY)+" "+q(R.bleedBox.topRightX)+" "+q(R.bleedBox.topRightY)+"]"),R.trimBox!==null&&ue("/TrimBox ["+q(R.trimBox.bottomLeftX)+" "+q(R.trimBox.bottomLeftY)+" "+q(R.trimBox.topRightX)+" "+q(R.trimBox.topRightY)+"]"),R.artBox!==null&&ue("/ArtBox ["+q(R.artBox.bottomLeftX)+" "+q(R.artBox.bottomLeftY)+" "+q(R.artBox.topRightX)+" "+q(R.artBox.topRightY)+"]"),typeof R.userUnit=="number"&&R.userUnit!==1&&ue("/UserUnit "+R.userUnit),kt.publish("putPage",{objId:Re,pageContext:zt[Q],pageNumber:Q,page:Ae}),ue("/Contents "+ze+" 0 R"),ue(">>"),ue("endobj");var mt=Ae.join(`
`);return O===A&&(mt+=`
Q`),ae(ze,!0),lt({data:mt,filters:$e(),objectId:ze}),ue("endobj"),Re},Ke=g.__private__.putPages=function(){var R,Q,Ae=[];for(R=1;R<=Vt;R++)zt[R].objId=Zt(),zt[R].contentsObjId=Zt();for(R=1;R<=Vt;R++)Ae.push(Xe({number:R,data:Ie[R],objId:zt[R].objId,contentsObjId:zt[R].contentsObjId,mediaBox:zt[R].mediaBox,cropBox:zt[R].cropBox,bleedBox:zt[R].bleedBox,trimBox:zt[R].trimBox,artBox:zt[R].artBox,userUnit:zt[R].userUnit,rootDictionaryObjId:me,resourceDictionaryObjId:pe}));ae(me,!0),ue("<</Type /Pages");var Re="/Kids [";for(Q=0;Q<Vt;Q++)Re+=Ae[Q]+" 0 R ";ue(Re+"]"),ue("/Count "+Vt),ue(">>"),ue("endobj"),kt.publish("postPutPages")},Qe=function(R){kt.publish("putFont",{font:R,out:ue,newObject:Pt,putStream:lt}),R.isAlreadyPutted!==!0&&(R.objectNumber=Pt(),ue("<<"),ue("/Type /Font"),ue("/BaseFont /"+Yf(R.postScriptName)),ue("/Subtype /Type1"),typeof R.encoding=="string"&&ue("/Encoding /"+R.encoding),ue("/FirstChar 32"),ue("/LastChar 255"),ue(">>"),ue("endobj"))},Et=function(R){R.objectNumber=Pt();var Q=[];Q.push({key:"Type",value:"/XObject"}),Q.push({key:"Subtype",value:"/Form"}),Q.push({key:"BBox",value:"["+[q(R.x),q(R.y),q(R.x+R.width),q(R.y+R.height)].join(" ")+"]"}),Q.push({key:"Matrix",value:"["+R.matrix.toString()+"]"});var Ae=R.pages[1].join(`
`);lt({data:Ae,additionalKeyValues:Q,objectId:R.objectNumber}),ue("endobj")},Rt=function(R,Q){Q||(Q=21);var Ae=Pt(),Re=(function(_t,er){var or,_r=[],Er=1/(er-1);for(or=0;or<1;or+=Er)_r.push(or);if(_r.push(1),_t[0].offset!=0){var Vr={offset:0,color:_t[0].color};_t.unshift(Vr)}if(_t[_t.length-1].offset!=1){var La={offset:1,color:_t[_t.length-1].color};_t.push(La)}for(var Ka="",_a=0,_n=0;_n<_r.length;_n++){for(or=_r[_n];or>_t[_a+1].offset;)_a++;var on=_t[_a].offset,qn=(or-on)/(_t[_a+1].offset-on),jo=_t[_a].color,bi=_t[_a+1].color;Ka+=z(Math.round((1-qn)*jo[0]+qn*bi[0]).toString(16))+z(Math.round((1-qn)*jo[1]+qn*bi[1]).toString(16))+z(Math.round((1-qn)*jo[2]+qn*bi[2]).toString(16))}return Ka.trim()})(R.colors,Q),ze=[];ze.push({key:"FunctionType",value:"0"}),ze.push({key:"Domain",value:"[0.0 1.0]"}),ze.push({key:"Size",value:"["+Q+"]"}),ze.push({key:"BitsPerSample",value:"8"}),ze.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ze.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),lt({data:Re,additionalKeyValues:ze,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ae}),ue("endobj"),R.objectNumber=Pt(),ue("<< /ShadingType "+R.type),ue("/ColorSpace /DeviceRGB");var mt="/Coords ["+q(parseFloat(R.coords[0]))+" "+q(parseFloat(R.coords[1]))+" ";R.type===2?mt+=q(parseFloat(R.coords[2]))+" "+q(parseFloat(R.coords[3])):mt+=q(parseFloat(R.coords[2]))+" "+q(parseFloat(R.coords[3]))+" "+q(parseFloat(R.coords[4]))+" "+q(parseFloat(R.coords[5])),ue(mt+="]"),R.matrix&&ue("/Matrix ["+R.matrix.toString()+"]"),ue("/Function "+Ae+" 0 R"),ue("/Extend [true true]"),ue(">>"),ue("endobj")},qt=function(R,Q){var Ae=Zt(),Re=Pt();Q.push({resourcesOid:Ae,objectOid:Re}),R.objectNumber=Re;var ze=[];ze.push({key:"Type",value:"/Pattern"}),ze.push({key:"PatternType",value:"1"}),ze.push({key:"PaintType",value:"1"}),ze.push({key:"TilingType",value:"1"}),ze.push({key:"BBox",value:"["+R.boundingBox.map(q).join(" ")+"]"}),ze.push({key:"XStep",value:q(R.xStep)}),ze.push({key:"YStep",value:q(R.yStep)}),ze.push({key:"Resources",value:Ae+" 0 R"}),R.matrix&&ze.push({key:"Matrix",value:"["+R.matrix.toString()+"]"}),lt({data:R.stream,additionalKeyValues:ze,objectId:R.objectNumber}),ue("endobj")},Ot=function(R){for(var Q in R.objectNumber=Pt(),ue("<<"),R)switch(Q){case"opacity":ue("/ca "+D(R[Q]));break;case"stroke-opacity":ue("/CA "+D(R[Q]))}ue(">>"),ue("endobj")},Mt=function(R){ae(R.resourcesOid,!0),ue("<<"),ue("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Q in ue("/Font <<"),Ct)Ct.hasOwnProperty(Q)&&(v===!1||v===!0&&x.hasOwnProperty(Q))&&ue("/"+Q+" "+Ct[Q].objectNumber+" 0 R");ue(">>")})(),(function(){if(Object.keys(_e).length>0){for(var Q in ue("/Shading <<"),_e)_e.hasOwnProperty(Q)&&_e[Q]instanceof fd&&_e[Q].objectNumber>=0&&ue("/"+Q+" "+_e[Q].objectNumber+" 0 R");kt.publish("putShadingPatternDict"),ue(">>")}})(),(function(Q){if(Object.keys(_e).length>0){for(var Ae in ue("/Pattern <<"),_e)_e.hasOwnProperty(Ae)&&_e[Ae]instanceof g.TilingPattern&&_e[Ae].objectNumber>=0&&_e[Ae].objectNumber<Q&&ue("/"+Ae+" "+_e[Ae].objectNumber+" 0 R");kt.publish("putTilingPatternDict"),ue(">>")}})(R.objectOid),(function(){if(Object.keys(Fe).length>0){var Q;for(Q in ue("/ExtGState <<"),Fe)Fe.hasOwnProperty(Q)&&Fe[Q].objectNumber>=0&&ue("/"+Q+" "+Fe[Q].objectNumber+" 0 R");kt.publish("putGStateDict"),ue(">>")}})(),(function(){for(var Q in ue("/XObject <<"),Pr)Pr.hasOwnProperty(Q)&&Pr[Q].objectNumber>=0&&ue("/"+Q+" "+Pr[Q].objectNumber+" 0 R");kt.publish("putXobjectDict"),ue(">>")})(),ue(">>"),ue("endobj")},Jt=function(R){Te[R.fontName]=Te[R.fontName]||{},Te[R.fontName][R.fontStyle]=R.id},oa=function(R,Q,Ae,Re,ze){var mt={id:"F"+(Object.keys(Ct).length+1).toString(10),postScriptName:R,fontName:Q,fontStyle:Ae,encoding:Re,isStandardFont:ze||!1,metadata:{}};return kt.publish("addFont",{font:mt,instance:this}),Ct[mt.id]=mt,Jt(mt),mt.id},Mr=g.__private__.pdfEscape=g.pdfEscape=function(R,Q){return(function(Ae,Re){var ze,mt,_t,er,or,_r,Er,Vr,La;if(_t=(Re=Re||{}).sourceEncoding||"Unicode",or=Re.outputEncoding,(Re.autoencode||or)&&Ct[wt].metadata&&Ct[wt].metadata[_t]&&Ct[wt].metadata[_t].encoding&&(er=Ct[wt].metadata[_t].encoding,!or&&Ct[wt].encoding&&(or=Ct[wt].encoding),!or&&er.codePages&&(or=er.codePages[0]),typeof or=="string"&&(or=er[or]),or)){for(Er=!1,_r=[],ze=0,mt=Ae.length;ze<mt;ze++)(Vr=or[Ae.charCodeAt(ze)])?_r.push(String.fromCharCode(Vr)):_r.push(Ae[ze]),_r[ze].charCodeAt(0)>>8&&(Er=!0);Ae=_r.join("")}for(ze=Ae.length;Er===void 0&&ze!==0;)Ae.charCodeAt(ze-1)>>8&&(Er=!0),ze--;if(!Er)return Ae;for(_r=Re.noBOM?[]:[254,255],ze=0,mt=Ae.length;ze<mt;ze++){if((La=(Vr=Ae.charCodeAt(ze))>>8)>>8)throw new Error("Character at position "+ze+" of string '"+Ae+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");_r.push(La),_r.push(Vr-(La<<8))}return String.fromCharCode.apply(void 0,_r)})(R,Q).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},da=g.__private__.beginPage=function(R){Ie[++Vt]=[],zt[Vt]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(R[0]),topRightY:Number(R[1])}},vi(Vt),rt(Ie[F])},ls=function(R,Q){var Ae,Re,ze;switch(r=Q||r,typeof R=="string"&&(Ae=E(R.toLowerCase()),Array.isArray(Ae)&&(Re=Ae[0],ze=Ae[1])),Array.isArray(R)&&(Re=R[0]*Ce,ze=R[1]*Ce),isNaN(Re)&&(Re=n[0],ze=n[1]),(Re>14400||ze>14400)&&(Oa.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Re=Math.min(14400,Re),ze=Math.min(14400,ze)),n=[Re,ze],r.substr(0,1)){case"l":ze>Re&&(n=[ze,Re]);break;case"p":Re>ze&&(n=[ze,Re])}da(n),vr(Dl),ue(qs),Ec!==0&&ue(Ec+" J"),On!==0&&ue(On+" j"),kt.publish("addPage",{pageNumber:Vt})},gi=function(R){R>0&&R<=Vt&&(Ie.splice(R,1),zt.splice(R,1),Vt--,F>Vt&&(F=Vt),this.setPage(F))},vi=function(R){R>0&&R<=Vt&&(F=R)},Bs=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return Ie.length-1},rl=function(R,Q,Ae){var Re,ze=void 0;return Ae=Ae||{},R=R!==void 0?R:Ct[wt].fontName,Q=Q!==void 0?Q:Ct[wt].fontStyle,Re=R.toLowerCase(),Te[Re]!==void 0&&Te[Re][Q]!==void 0?ze=Te[Re][Q]:Te[R]!==void 0&&Te[R][Q]!==void 0?ze=Te[R][Q]:Ae.disableWarning===!1&&Oa.warn("Unable to look up font label for font '"+R+"', '"+Q+"'. Refer to getFontList() for available fonts."),ze||Ae.noFallback||(ze=Te.times[Q])==null&&(ze=Te.times.normal),ze},Fa=g.__private__.putInfo=function(){var R=Pt(),Q=function(Re){return Re};for(var Ae in m!==null&&(Q=yn.encryptor(R,0)),ue("<<"),ue("/Producer ("+Mr(Q("jsPDF "+ur.version))+")"),$t)$t.hasOwnProperty(Ae)&&$t[Ae]&&ue("/"+Ae.substr(0,1).toUpperCase()+Ae.substr(1)+" ("+Mr(Q($t[Ae]))+")");ue("/CreationDate ("+Mr(Q(ie))+")"),ue(">>"),ue("endobj")},vo=g.__private__.putCatalog=function(R){var Q=(R=R||{}).rootDictionaryObjId||me;switch(Pt(),ue("<<"),ue("/Type /Catalog"),ue("/Pages "+Q+" 0 R"),jt||(jt="fullwidth"),jt){case"fullwidth":ue("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ue("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ue("/OpenAction [3 0 R /Fit]");break;case"original":ue("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ae=""+jt;Ae.substr(Ae.length-1)==="%"&&(jt=parseInt(jt)/100),typeof jt=="number"&&ue("/OpenAction [3 0 R /XYZ null null "+D(jt)+"]")}switch(Xt||(Xt="continuous"),Xt){case"continuous":ue("/PageLayout /OneColumn");break;case"single":ue("/PageLayout /SinglePage");break;case"two":case"twoleft":ue("/PageLayout /TwoColumnLeft");break;case"tworight":ue("/PageLayout /TwoColumnRight")}St&&ue("/PageMode /"+St),kt.publish("putCatalog"),ue(">>"),ue("endobj")},xi=g.__private__.putTrailer=function(){ue("trailer"),ue("<<"),ue("/Size "+(ne+1)),ue("/Root "+ne+" 0 R"),ue("/Info "+(ne-1)+" 0 R"),m!==null&&ue("/Encrypt "+yn.oid+" 0 R"),ue("/ID [ <"+X+"> <"+X+"> ]"),ue(">>")},Qr=g.__private__.putHeader=function(){ue("%PDF-"+b),ue("%")},Eu=g.__private__.putXRef=function(){var R="0000000000";ue("xref"),ue("0 "+(ne+1)),ue("0000000000 65535 f ");for(var Q=1;Q<=ne;Q++)typeof se[Q]=="function"?ue((R+se[Q]()).slice(-10)+" 00000 n "):se[Q]!==void 0?ue((R+se[Q]).slice(-10)+" 00000 n "):ue("0000000000 00000 n ")},zi=g.__private__.buildDocument=function(){var R;ne=0,Ne=0,je=[],se=[],ge=[],me=Zt(),pe=Zt(),rt(je),kt.publish("buildDocument"),Qr(),Ke(),(function(){kt.publish("putAdditionalObjects");for(var Ae=0;Ae<ge.length;Ae++){var Re=ge[Ae];ae(Re.objId,!0),ue(Re.content),ue("endobj")}kt.publish("postPutAdditionalObjects")})(),R=[],(function(){for(var Ae in Ct)Ct.hasOwnProperty(Ae)&&(v===!1||v===!0&&x.hasOwnProperty(Ae))&&Qe(Ct[Ae])})(),(function(){var Ae;for(Ae in Fe)Fe.hasOwnProperty(Ae)&&Ot(Fe[Ae])})(),(function(){for(var Ae in Pr)Pr.hasOwnProperty(Ae)&&Et(Pr[Ae])})(),(function(Ae){var Re;for(Re in _e)_e.hasOwnProperty(Re)&&(_e[Re]instanceof fd?Rt(_e[Re]):_e[Re]instanceof Kf&&qt(_e[Re],Ae))})(R),kt.publish("putResources"),R.forEach(Mt),Mt({resourcesOid:pe,objectOid:Number.MAX_SAFE_INTEGER}),kt.publish("postPutResources"),m!==null&&(yn.oid=Pt(),ue("<<"),ue("/Filter /Standard"),ue("/V "+yn.v),ue("/R "+yn.r),ue("/U <"+yn.toHexString(yn.U)+">"),ue("/O <"+yn.toHexString(yn.O)+">"),ue("/P "+yn.P),ue(">>"),ue("endobj")),Fa(),vo();var Q=Ne;return Eu(),xi(),ue("startxref"),ue(""+Q),ue("%%EOF"),rt(Ie[F]),je.join(`
`)},al=g.__private__.getBlob=function(R){return new Blob([xe(R)],{type:"application/pdf"})},Au=g.output=g.__private__.output=(nn=function(R,Q){switch(typeof(Q=Q||{})=="string"?Q={filename:Q}:Q.filename=Q.filename||"generated.pdf",R){case void 0:return zi();case"save":g.save(Q.filename);break;case"arraybuffer":return xe(zi());case"blob":return al(zi());case"bloburi":case"bloburl":if(kr.URL!==void 0&&typeof kr.URL.createObjectURL=="function")return kr.URL&&kr.URL.createObjectURL(al(zi()))||void 0;Oa.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ae="",Re=zi();try{Ae=pS(Re)}catch{Ae=pS(unescape(encodeURIComponent(Re)))}return"data:application/pdf;filename="+Q.filename+";base64,"+Ae;case"pdfobjectnewwindow":if(Object.prototype.toString.call(kr)==="[object Window]"){var ze="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",mt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Q.pdfObjectUrl&&(ze=Q.pdfObjectUrl,mt="");var _t='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ze+'"'+mt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Q)+");<\/script></body></html>",er=kr.open();return er!==null&&er.document.write(_t),er}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(kr)==="[object Window]"){var or='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Q.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Q.filename+'" width="500px" height="400px" /></body></html>',_r=kr.open();if(_r!==null){_r.document.write(or);var Er=this;_r.document.documentElement.querySelector("#pdfViewer").onload=function(){_r.document.title=Q.filename,_r.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Er.output("bloburl"))}}return _r}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(kr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Vr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Q)+'"></iframe></body></html>',La=kr.open();if(La!==null&&(La.document.write(Vr),La.document.title=Q.filename),La||typeof safari>"u")return La;break;case"datauri":case"dataurl":return kr.document.location.href=this.output("datauristring",Q);default:return null}},nn.foo=function(){try{return nn.apply(this,arguments)}catch(Ae){var R=Ae.stack||"";~R.indexOf(" at ")&&(R=R.split(" at ")[1]);var Q="Error in function "+R.split(`
`)[0].split("<")[0]+": "+Ae.message;if(!kr.console)throw new Error(Q);kr.console.error(Q,Ae),kr.alert&&alert(Q)}},nn.foo.bar=nn,nn.foo),cs=function(R){return Array.isArray(sr)===!0&&sr.indexOf(R)>-1};switch(a){case"pt":Ce=1;break;case"mm":Ce=72/25.4;break;case"cm":Ce=72/2.54;break;case"in":Ce=72;break;case"px":Ce=cs("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ce=12;break;case"ex":Ce=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);Ce=a}var yn=null;U(),K();var sn=g.__private__.getPageInfo=g.getPageInfo=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:zt[R].objId,pageNumber:R,pageContext:zt[R]}},jc=g.__private__.getPageInfoByObjId=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Q in zt)if(zt[Q].objId===R)break;return sn(Q)},qd=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:zt[F].objId,pageNumber:F,pageContext:zt[F]}};g.addPage=function(){return ls.apply(this,arguments),this},g.setPage=function(){return vi.apply(this,arguments),rt.call(this,Ie[F]),this},g.insertPage=function(R){return this.addPage(),this.movePage(F,R),this},g.movePage=function(R,Q){var Ae,Re;if(R>Q){Ae=Ie[R],Re=zt[R];for(var ze=R;ze>Q;ze--)Ie[ze]=Ie[ze-1],zt[ze]=zt[ze-1];Ie[Q]=Ae,zt[Q]=Re,this.setPage(Q)}else if(R<Q){Ae=Ie[R],Re=zt[R];for(var mt=R;mt<Q;mt++)Ie[mt]=Ie[mt+1],zt[mt]=zt[mt+1];Ie[Q]=Ae,zt[Q]=Re,this.setPage(Q)}return this},g.deletePage=function(){return gi.apply(this,arguments),this},g.__private__.text=g.text=function(R,Q,Ae,Re,ze){var mt,_t,er,or,_r,Er,Vr,La,Ka,_a=(Re=Re||{}).scope||this;if(typeof R=="number"&&typeof Q=="number"&&(typeof Ae=="string"||Array.isArray(Ae))){var _n=Ae;Ae=Q,Q=R,R=_n}if(arguments[3]instanceof ir==0?(er=arguments[4],or=arguments[5],xa(Vr=arguments[3])==="object"&&Vr!==null||(typeof er=="string"&&(or=er,er=null),typeof Vr=="string"&&(or=Vr,Vr=null),typeof Vr=="number"&&(er=Vr,Vr=null),Re={flags:Vr,angle:er,align:or})):(L("The transform parameter of text() with a Matrix value"),Ka=ze),isNaN(Q)||isNaN(Ae)||R==null)throw new Error("Invalid arguments passed to jsPDF.text");if(R.length===0)return _a;var on,qn="",jo=typeof Re.lineHeightFactor=="number"?Re.lineHeightFactor:xo,bi=_a.internal.scaleFactor;function ko(ea){return ea=ea.split("	").join(Array(Re.TabLen||9).join(" ")),Mr(ea,Vr)}function Mu(ea){for(var Gr,ba=ea.concat(),Za=[],Zi=ba.length;Zi--;)typeof(Gr=ba.shift())=="string"?Za.push(Gr):Array.isArray(ea)&&(Gr.length===1||Gr[1]===void 0&&Gr[2]===void 0)?Za.push(Gr[0]):Za.push([Gr[0],Gr[1],Gr[2]]);return Za}function Cc(ea,Gr){var ba;if(typeof ea=="string")ba=Gr(ea)[0];else if(Array.isArray(ea)){for(var Za,Zi,ji=ea.concat(),Ul=[],Uu=ji.length;Uu--;)typeof(Za=ji.shift())=="string"?Ul.push(Gr(Za)[0]):Array.isArray(Za)&&typeof Za[0]=="string"&&(Zi=Gr(Za[0],Za[1],Za[2]),Ul.push([Zi[0],Zi[1],Zi[2]]));ba=Ul}return ba}var Wi=!1,wi=!0;if(typeof R=="string")Wi=!0;else if(Array.isArray(R)){var Il=R.concat();_t=[];for(var Eo,Rn=Il.length;Rn--;)(typeof(Eo=Il.shift())!="string"||Array.isArray(Eo)&&typeof Eo[0]!="string")&&(wi=!1);Wi=wi}if(Wi===!1)throw new Error('Type of text must be string or Array. "'+R+'" is not recognized.');typeof R=="string"&&(R=R.match(/[\r?\n]/)?R.split(/\r\n|\r|\n/g):[R]);var sl=Be/_a.internal.scaleFactor,il=sl*(jo-1);switch(Re.baseline){case"bottom":Ae-=il;break;case"top":Ae+=sl-il;break;case"hanging":Ae+=sl-2*il;break;case"middle":Ae+=sl/2-il}if((Er=Re.maxWidth||0)>0&&(typeof R=="string"?R=_a.splitTextToSize(R,Er):Object.prototype.toString.call(R)==="[object Array]"&&(R=R.reduce(function(ea,Gr){return ea.concat(_a.splitTextToSize(Gr,Er))},[]))),mt={text:R,x:Q,y:Ae,options:Re,mutex:{pdfEscape:Mr,activeFontKey:wt,fonts:Ct,activeFontSize:Be}},kt.publish("preProcessText",mt),R=mt.text,er=(Re=mt.options).angle,Ka instanceof ir==0&&er&&typeof er=="number"){er*=Math.PI/180,Re.rotationDirection===0&&(er=-er),O===A&&(er=-er);var Tc=Math.cos(er),Vi=Math.sin(er);Ka=new ir(Tc,Vi,-Vi,Tc,0,0)}else er&&er instanceof ir&&(Ka=er);O!==A||Ka||(Ka=xn),(_r=Re.charSpace||Xs)!==void 0&&(qn+=q(M(_r))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(La=Re.horizontalScale)!==void 0&&(qn+=q(100*La)+` Tz
`),Re.lang;var ds=-1,Ao=Re.renderingMode!==void 0?Re.renderingMode:Re.stroke,Oc=_a.internal.getCurrentPageInfo().pageContext;switch(Ao){case 0:case!1:case"fill":ds=0;break;case 1:case!0:case"stroke":ds=1;break;case 2:case"fillThenStroke":ds=2;break;case 3:case"invisible":ds=3;break;case 4:case"fillAndAddForClipping":ds=4;break;case 5:case"strokeAndAddPathForClipping":ds=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ds=6;break;case 7:case"addToPathForClipping":ds=7}var Iu=Oc.usedRenderingMode!==void 0?Oc.usedRenderingMode:-1;ds!==-1?qn+=ds+` Tr
`:Iu!==-1&&(qn+=`0 Tr
`),ds!==-1&&(Oc.usedRenderingMode=ds),or=Re.align||"left";var zs,Si=Be*jo,Co=_a.internal.pageSize.getWidth(),Bu=Ct[wt];_r=Re.charSpace||Xs,Er=Re.maxWidth||0,Vr=Object.assign({autoencode:!0,noBOM:!0},Re.flags);var Ni=[],ol=function(ea){return _a.getStringUnitWidth(ea,{font:Bu,charSpace:_r,fontSize:Be,doKerning:!1})*Be/bi};if(Object.prototype.toString.call(R)==="[object Array]"){var Ss;_t=Mu(R),or!=="left"&&(zs=_t.map(ol));var fs,Gi=0;if(or==="right"){Q-=zs[0],R=[],Rn=_t.length;for(var Yi=0;Yi<Rn;Yi++)Yi===0?(fs=Us(Q),Ss=Un(Ae)):(fs=M(Gi-zs[Yi]),Ss=-Si),R.push([_t[Yi],fs,Ss]),Gi=zs[Yi]}else if(or==="center"){Q-=zs[0]/2,R=[],Rn=_t.length;for(var To=0;To<Rn;To++)To===0?(fs=Us(Q),Ss=Un(Ae)):(fs=M((Gi-zs[To])/2),Ss=-Si),R.push([_t[To],fs,Ss]),Gi=zs[To]}else if(or==="left"){R=[],Rn=_t.length;for(var Rc=0;Rc<Rn;Rc++)R.push(_t[Rc])}else if(or==="justify"&&Bu.encoding==="Identity-H"){R=[],Rn=_t.length,Er=Er!==0?Er:Co;for(var Dc=0,Ja=0;Ja<Rn;Ja++)if(Ss=Ja===0?Un(Ae):-Si,fs=Ja===0?Us(Q):Dc,Ja<Rn-1){var Kd=M((Er-zs[Ja])/(_t[Ja].split(" ").length-1)),Xi=_t[Ja].split(" ");R.push([Xi[0]+" ",fs,Ss]),Dc=0;for(var Ki=1;Ki<Xi.length;Ki++){var zn=(ol(Xi[Ki-1]+" "+Xi[Ki])-ol(Xi[Ki]))*bi+Kd;Ki==Xi.length-1?R.push([Xi[Ki],zn,0]):R.push([Xi[Ki]+" ",zn,0]),Dc-=zn}}else R.push([_t[Ja],fs,Ss]);R.push(["",Dc,0])}else{if(or!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(R=[],Rn=_t.length,Er=Er!==0?Er:Co,Ja=0;Ja<Rn;Ja++){Ss=Ja===0?Un(Ae):-Si,fs=Ja===0?Us(Q):0;var Oo=_t[Ja].split(" ").length-1,Fc=Oo>0?(Er-zs[Ja])/Oo:0;Ja<Rn-1?Ni.push(q(M(Fc))):Ni.push(0),R.push([_t[Ja],fs,Ss])}}}(typeof Re.R2L=="boolean"?Re.R2L:ct)===!0&&(R=Cc(R,function(ea,Gr,ba){return[ea.split("").reverse().join(""),Gr,ba]})),mt={text:R,x:Q,y:Ae,options:Re,mutex:{pdfEscape:Mr,activeFontKey:wt,fonts:Ct,activeFontSize:Be}},kt.publish("postProcessText",mt),R=mt.text,on=mt.mutex.isHex||!1;var Lc=Ct[wt].encoding;Lc!=="WinAnsiEncoding"&&Lc!=="StandardEncoding"||(R=Cc(R,function(ea,Gr,ba){return[ko(ea),Gr,ba]})),_t=Mu(R),R=[];for(var Ro,Do,Ji,Bl=Array.isArray(_t[0])?1:0,Hs="",Fo=function(ea,Gr,ba){var Za="";return ba instanceof ir?(ba=typeof Re.angle=="number"?Ea(ba,new ir(1,0,0,1,ea,Gr)):Ea(new ir(1,0,0,1,ea,Gr),ba),O===A&&(ba=Ea(new ir(1,0,0,-1,0,0),ba)),Za=ba.join(" ")+` Tm
`):Za=q(ea)+" "+q(Gr)+` Td
`,Za},Zn=0;Zn<_t.length;Zn++){switch(Hs="",Bl){case 1:Ji=(on?"<":"(")+_t[Zn][0]+(on?">":")"),Ro=parseFloat(_t[Zn][1]),Do=parseFloat(_t[Zn][2]);break;case 0:Ji=(on?"<":"(")+_t[Zn]+(on?">":")"),Ro=Us(Q),Do=Un(Ae)}Ni!==void 0&&Ni[Zn]!==void 0&&(Hs=Ni[Zn]+` Tw
`),Zn===0?R.push(Hs+Fo(Ro,Do,Ka)+Ji):Bl===0?R.push(Hs+Ji):Bl===1&&R.push(Hs+Fo(Ro,Do,Ka)+Ji)}R=Bl===0?R.join(` Tj
T* `):R.join(` Tj
`),R+=` Tj
`;var Js=`BT
/`;return Js+=wt+" "+Be+` Tf
`,Js+=q(Be*jo)+` TL
`,Js+=Hi+`
`,Js+=qn,Js+=R,ue(Js+="ET"),x[wt]=!0,_a};var Cu=g.__private__.clip=g.clip=function(R){return ue(R==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return Cu("evenodd")},g.__private__.discardPath=g.discardPath=function(){return ue("n"),this};var us=g.__private__.isValidStyle=function(R){var Q=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(R)!==-1&&(Q=!0),Q};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(R){return us(R)&&(f=R),this};var Tu=g.__private__.getStyle=g.getStyle=function(R){var Q=f;switch(R){case"D":case"S":Q="S";break;case"F":Q="f";break;case"FD":case"DF":Q="B";break;case"f":case"f*":case"B":case"B*":Q=R}return Q},Ou=g.close=function(){return ue("h"),this};g.stroke=function(){return ue("S"),this},g.fill=function(R){return yi("f",R),this},g.fillEvenOdd=function(R){return yi("f*",R),this},g.fillStroke=function(R){return yi("B",R),this},g.fillStrokeEvenOdd=function(R){return yi("B*",R),this};var yi=function(R,Q){xa(Q)==="object"?Hd(Q,R):ue(R)},Rl=function(R){R===null||O===A&&R===void 0||(R=Tu(R),ue(R))};function zd(R,Q,Ae,Re,ze){var mt=new Kf(Q||this.boundingBox,Ae||this.xStep,Re||this.yStep,this.gState,ze||this.matrix);mt.stream=this.stream;var _t=R+"$$"+this.cloneIndex+++"$$";return Ra(_t,mt),mt}var Hd=function(R,Q){var Ae=Ue[R.key],Re=_e[Ae];if(Re instanceof fd)ue("q"),ue(Ru(Q)),Re.gState&&g.setGState(Re.gState),ue(R.matrix.toString()+" cm"),ue("/"+Ae+" sh"),ue("Q");else if(Re instanceof Kf){var ze=new ir(1,0,0,-1,0,No());R.matrix&&(ze=ze.multiply(R.matrix||xn),Ae=zd.call(Re,R.key,R.boundingBox,R.xStep,R.yStep,ze).id),ue("q"),ue("/Pattern cs"),ue("/"+Ae+" scn"),Re.gState&&g.setGState(Re.gState),ue(Q),ue("Q")}},Ru=function(R){switch(R){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Du=g.moveTo=function(R,Q){return ue(q(M(R))+" "+q(V(Q))+" m"),this},$d=g.lineTo=function(R,Q){return ue(q(M(R))+" "+q(V(Q))+" l"),this},ws=g.curveTo=function(R,Q,Ae,Re,ze,mt){return ue([q(M(R)),q(V(Q)),q(M(Ae)),q(V(Re)),q(M(ze)),q(V(mt)),"c"].join(" ")),this};g.__private__.line=g.line=function(R,Q,Ae,Re,ze){if(isNaN(R)||isNaN(Q)||isNaN(Ae)||isNaN(Re)||!us(ze))throw new Error("Invalid arguments passed to jsPDF.line");return O===C?this.lines([[Ae-R,Re-Q]],R,Q,[1,1],ze||"S"):this.lines([[Ae-R,Re-Q]],R,Q,[1,1]).stroke()},g.__private__.lines=g.lines=function(R,Q,Ae,Re,ze,mt){var _t,er,or,_r,Er,Vr,La,Ka,_a,_n,on,qn;if(typeof R=="number"&&(qn=Ae,Ae=Q,Q=R,R=qn),Re=Re||[1,1],mt=mt||!1,isNaN(Q)||isNaN(Ae)||!Array.isArray(R)||!Array.isArray(Re)||!us(ze)||typeof mt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Du(Q,Ae),_t=Re[0],er=Re[1],_r=R.length,_n=Q,on=Ae,or=0;or<_r;or++)(Er=R[or]).length===2?(_n=Er[0]*_t+_n,on=Er[1]*er+on,$d(_n,on)):(Vr=Er[0]*_t+_n,La=Er[1]*er+on,Ka=Er[2]*_t+_n,_a=Er[3]*er+on,_n=Er[4]*_t+_n,on=Er[5]*er+on,ws(Vr,La,Ka,_a,_n,on));return mt&&Ou(),Rl(ze),this},g.path=function(R){for(var Q=0;Q<R.length;Q++){var Ae=R[Q],Re=Ae.c;switch(Ae.op){case"m":Du(Re[0],Re[1]);break;case"l":$d(Re[0],Re[1]);break;case"c":ws.apply(this,Re);break;case"h":Ou()}}return this},g.__private__.rect=g.rect=function(R,Q,Ae,Re,ze){if(isNaN(R)||isNaN(Q)||isNaN(Ae)||isNaN(Re)||!us(ze))throw new Error("Invalid arguments passed to jsPDF.rect");return O===C&&(Re=-Re),ue([q(M(R)),q(V(Q)),q(M(Ae)),q(M(Re)),"re"].join(" ")),Rl(ze),this},g.__private__.triangle=g.triangle=function(R,Q,Ae,Re,ze,mt,_t){if(isNaN(R)||isNaN(Q)||isNaN(Ae)||isNaN(Re)||isNaN(ze)||isNaN(mt)||!us(_t))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ae-R,Re-Q],[ze-Ae,mt-Re],[R-ze,Q-mt]],R,Q,[1,1],_t,!0),this},g.__private__.roundedRect=g.roundedRect=function(R,Q,Ae,Re,ze,mt,_t){if(isNaN(R)||isNaN(Q)||isNaN(Ae)||isNaN(Re)||isNaN(ze)||isNaN(mt)||!us(_t))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var er=4/3*(Math.SQRT2-1);return ze=Math.min(ze,.5*Ae),mt=Math.min(mt,.5*Re),this.lines([[Ae-2*ze,0],[ze*er,0,ze,mt-mt*er,ze,mt],[0,Re-2*mt],[0,mt*er,-ze*er,mt,-ze,mt],[2*ze-Ae,0],[-ze*er,0,-ze,-mt*er,-ze,-mt],[0,2*mt-Re],[0,-mt*er,ze*er,-mt,ze,-mt]],R+ze,Q,[1,1],_t,!0),this},g.__private__.ellipse=g.ellipse=function(R,Q,Ae,Re,ze){if(isNaN(R)||isNaN(Q)||isNaN(Ae)||isNaN(Re)||!us(ze))throw new Error("Invalid arguments passed to jsPDF.ellipse");var mt=4/3*(Math.SQRT2-1)*Ae,_t=4/3*(Math.SQRT2-1)*Re;return Du(R+Ae,Q),ws(R+Ae,Q-_t,R+mt,Q-Re,R,Q-Re),ws(R-mt,Q-Re,R-Ae,Q-_t,R-Ae,Q),ws(R-Ae,Q+_t,R-mt,Q+Re,R,Q+Re),ws(R+mt,Q+Re,R+Ae,Q+_t,R+Ae,Q),Rl(ze),this},g.__private__.circle=g.circle=function(R,Q,Ae,Re){if(isNaN(R)||isNaN(Q)||isNaN(Ae)||!us(Re))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(R,Q,Ae,Ae,Re)},g.setFont=function(R,Q,Ae){return Ae&&(Q=B(Q,Ae)),wt=rl(R,Q,{disableWarning:!1}),this};var _i=g.__private__.getFont=g.getFont=function(){return Ct[rl.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var R,Q,Ae={};for(R in Te)if(Te.hasOwnProperty(R))for(Q in Ae[R]=[],Te[R])Te[R].hasOwnProperty(Q)&&Ae[R].push(Q);return Ae},g.addFont=function(R,Q,Ae,Re,ze){var mt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&mt.indexOf(arguments[3])!==-1?ze=arguments[3]:arguments[3]&&mt.indexOf(arguments[3])==-1&&(Ae=B(Ae,Re)),oa.call(this,R,Q,Ae,ze=ze||"Identity-H")};var xo,Dl=t.lineWidth||.200025,nl=g.__private__.getLineWidth=g.getLineWidth=function(){return Dl},vr=g.__private__.setLineWidth=g.setLineWidth=function(R){return Dl=R,ue(q(M(R))+" w"),this};g.__private__.setLineDash=ur.API.setLineDash=ur.API.setLineDashPattern=function(R,Q){if(R=R||[],Q=Q||0,isNaN(Q)||!Array.isArray(R))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return R=R.map(function(Ae){return q(M(Ae))}).join(" "),Q=q(M(Q)),ue("["+R+"] "+Q+" d"),this};var Wd=g.__private__.getLineHeight=g.getLineHeight=function(){return Be*xo};g.__private__.getLineHeight=g.getLineHeight=function(){return Be*xo};var Fu=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(R){return typeof(R=R||1.15)=="number"&&(xo=R),this},Vd=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return xo};Fu(t.lineHeight);var Us=g.__private__.getHorizontalCoordinate=function(R){return M(R)},Un=g.__private__.getVerticalCoordinate=function(R){return O===A?R:zt[F].mediaBox.topRightY-zt[F].mediaBox.bottomLeftY-M(R)},Lu=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(R){return q(Us(R))},Fl=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(R){return q(Un(R))},qs=t.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return Se(qs)},g.__private__.setStrokeColor=g.setDrawColor=function(R,Q,Ae,Re){return qs=we({ch1:R,ch2:Q,ch3:Ae,ch4:Re,pdfColorType:"draw",precision:2}),ue(qs),this};var Ll=t.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return Se(Ll)},g.__private__.setFillColor=g.setFillColor=function(R,Q,Ae,Re){return Ll=we({ch1:R,ch2:Q,ch3:Ae,ch4:Re,pdfColorType:"fill",precision:2}),ue(Ll),this};var Hi=t.textColor||"0 g",Gd=g.__private__.getTextColor=g.getTextColor=function(){return Se(Hi)};g.__private__.setTextColor=g.setTextColor=function(R,Q,Ae,Re){return Hi=we({ch1:R,ch2:Q,ch3:Ae,ch4:Re,pdfColorType:"text",precision:3}),this};var Xs=t.charSpace,kc=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(Xs||0)};g.__private__.setCharSpace=g.setCharSpace=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Xs=R,this};var Ec=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(R){var Q=g.CapJoinStyles[R];if(Q===void 0)throw new Error("Line cap style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ec=Q,ue(Q+" J"),this};var On=0;g.__private__.setLineJoin=g.setLineJoin=function(R){var Q=g.CapJoinStyles[R];if(Q===void 0)throw new Error("Line join style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return On=Q,ue(Q+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(R){if(R=R||0,isNaN(R))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ue(q(M(R))+" M"),this},g.GState=d1,g.setGState=function(R){(R=typeof R=="string"?Fe[gt[R]]:$i(null,R)).equals(Ht)||(ue("/"+R.id+" gs"),Ht=R)};var $i=function(R,Q){if(!R||!gt[R]){var Ae=!1;for(var Re in Fe)if(Fe.hasOwnProperty(Re)&&Fe[Re].equals(Q)){Ae=!0;break}if(Ae)Q=Fe[Re];else{var ze="GS"+(Object.keys(Fe).length+1).toString(10);Fe[ze]=Q,Q.id=ze}return R&&(gt[R]=Q.id),kt.publish("addGState",Q),Q}};g.addGState=function(R,Q){return $i(R,Q),this},g.saveGraphicsState=function(){return ue("q"),Ve.push({key:wt,size:Be,color:Hi}),this},g.restoreGraphicsState=function(){ue("Q");var R=Ve.pop();return wt=R.key,Be=R.size,Hi=R.color,Ht=null,this},g.setCurrentTransformationMatrix=function(R){return ue(R.toString()+" cm"),this},g.comment=function(R){return ue("#"+R),this};var Ks=function(R,Q){var Ae=R||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ae},set:function(mt){isNaN(mt)||(Ae=parseFloat(mt))}});var Re=Q||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Re},set:function(mt){isNaN(mt)||(Re=parseFloat(mt))}});var ze="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ze},set:function(mt){ze=mt.toString()}}),this},yo=function(R,Q,Ae,Re){Ks.call(this,R,Q),this.type="rect";var ze=Ae||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ze},set:function(_t){isNaN(_t)||(ze=parseFloat(_t))}});var mt=Re||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return mt},set:function(_t){isNaN(_t)||(mt=parseFloat(_t))}}),this},Ac=function(){this.page=Vt,this.currentPage=F,this.pages=Ie.slice(0),this.pagesContext=zt.slice(0),this.x=st,this.y=Dt,this.matrix=At,this.width=bo(F),this.height=Pu(F),this.outputDestination=Ge,this.id="",this.objectNumber=-1};Ac.prototype.restore=function(){Vt=this.page,F=this.currentPage,zt=this.pagesContext,Ie=this.pages,st=this.x,Dt=this.y,At=this.matrix,Ml(F,this.width),wo(F,this.height),Ge=this.outputDestination};var Pl=function(R,Q,Ae,Re,ze){fa.push(new Ac),Vt=F=0,Ie=[],st=R,Dt=Q,At=ze,da([Ae,Re])};for(var _o in g.beginFormObject=function(R,Q,Ae,Re,ze){return Pl(R,Q,Ae,Re,ze),this},g.endFormObject=function(R){return(function(Q){if(Nt[Q])fa.pop().restore();else{var Ae=new Ac,Re="Xo"+(Object.keys(Pr).length+1).toString(10);Ae.id=Re,Nt[Q]=Re,Pr[Re]=Ae,kt.publish("addFormObject",Ae),fa.pop().restore()}})(R),this},g.doFormObject=function(R,Q){var Ae=Pr[Nt[R]];return ue("q"),ue(Q.toString()+" cm"),ue("/"+Ae.id+" Do"),ue("Q"),this},g.getFormObject=function(R){var Q=Pr[Nt[R]];return{x:Q.x,y:Q.y,width:Q.width,height:Q.height,matrix:Q.matrix}},g.save=function(R,Q){return R=R||"generated.pdf",(Q=Q||{}).returnPromise=Q.returnPromise||!1,Q.returnPromise===!1?(od(al(zi()),R),typeof od.unload=="function"&&kr.setTimeout&&setTimeout(od.unload,911),this):new Promise(function(Ae,Re){try{var ze=od(al(zi()),R);typeof od.unload=="function"&&kr.setTimeout&&setTimeout(od.unload,911),Ae(ze)}catch(mt){Re(mt.message)}})},ur.API)ur.API.hasOwnProperty(_o)&&(_o==="events"&&ur.API.events.length?(function(R,Q){var Ae,Re,ze;for(ze=Q.length-1;ze!==-1;ze--)Ae=Q[ze][0],Re=Q[ze][1],R.subscribe.apply(R,[Ae].concat(typeof Re=="function"?[Re]:Re))})(kt,ur.API.events):g[_o]=ur.API[_o]);function bo(R){return zt[R].mediaBox.topRightX-zt[R].mediaBox.bottomLeftX}function Ml(R,Q){zt[R].mediaBox.topRightX=Q+zt[R].mediaBox.bottomLeftX}function Pu(R){return zt[R].mediaBox.topRightY-zt[R].mediaBox.bottomLeftY}function wo(R,Q){zt[R].mediaBox.topRightY=Q+zt[R].mediaBox.bottomLeftY}var So=g.getPageWidth=function(R){return bo(R=R||F)/Ce},Yd=g.setPageWidth=function(R,Q){Ml(R,Q*Ce)},No=g.getPageHeight=function(R){return Pu(R=R||F)/Ce},Xd=g.setPageHeight=function(R,Q){wo(R,Q*Ce)};return g.internal={pdfEscape:Mr,getStyle:Tu,getFont:_i,getFontSize:Je,getCharSpace:kc,getTextColor:Gd,getLineHeight:Wd,getLineHeightFactor:Vd,getLineWidth:nl,write:ot,getHorizontalCoordinate:Us,getVerticalCoordinate:Un,getCoordinateString:Lu,getVerticalCoordinateString:Fl,collections:{},newObject:Pt,newAdditionalObject:be,newObjectDeferred:Zt,newObjectDeferredBegin:ae,getFilters:$e,putStream:lt,events:kt,scaleFactor:Ce,pageSize:{getWidth:function(){return So(F)},setWidth:function(R){Yd(F,R)},getHeight:function(){return No(F)},setHeight:function(R){Xd(F,R)}},encryptionOptions:m,encryption:yn,getEncryptor:function(R){return m!==null?yn.encryptor(R,0):function(Q){return Q}},output:Au,getNumberOfPages:Bs,get pages(){return Ie},out:ue,f2:D,f3:T,getPageInfo:sn,getPageInfoByObjId:jc,getCurrentPageInfo:qd,getPDFVersion:_,Point:Ks,Rectangle:yo,Matrix:ir,hasHotfix:cs},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return So(F)},set:function(R){Yd(F,R)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return No(F)},set:function(R){Xd(F,R)},enumerable:!0,configurable:!0}),(function(R){for(var Q=0,Ae=ve.length;Q<Ae;Q++){var Re=oa.call(this,R[Q][0],R[Q][1],R[Q][2],ve[Q][3],!0);v===!1&&(x[Re]=!0);var ze=R[Q][0].split("-");Jt({id:Re,fontName:ze[0],fontStyle:ze[1]||""})}kt.publish("addFonts",{fonts:Ct,dictionary:Te})}).call(g,ve),wt="F1",ls(n,r),kt.publish("initialized"),g}Gf.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Gf.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Gf.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Gf.prototype.processOwnerPassword=function(t,e){return qx(Ux(e).substr(0,5),t)},Gf.prototype.encryptor=function(t,e){var r=Ux(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(a){return qx(r,a)}},d1.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||xa(t)!==xa(this))return!1;var a=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;a++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&a--;return a===0},ur.API={events:[]},ur.version="3.0.4";var mn=ur.API,Q2=1,Ud=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},zf=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Tr=function(t){return t.toFixed(2)},lu=function(t){return t.toFixed(5)};mn.__acroform__={};var pi=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},yS=function(t){return t*Q2},jl=function(t){var e=new rk,r=nr.internal.getHeight(t)||0,a=nr.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Tr(a)),Number(Tr(r))],e},kz=mn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},Ez=mn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},Az=mn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},kn=mn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Az(t,e-1)},En=mn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return kz(t,e-1)},An=mn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Ez(t,e-1)},Cz=mn.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,a=e.internal.getVerticalCoordinate,n=t[0],s=t[1],l=t[2],c=t[3],d={};return d.lowerLeft_X=r(n)||0,d.lowerLeft_Y=a(s+c)||0,d.upperRight_X=r(n+l)||0,d.upperRight_Y=a(s)||0,[Number(Tr(d.lowerLeft_X)),Number(Tr(d.lowerLeft_Y)),Number(Tr(d.upperRight_X)),Number(Tr(d.upperRight_Y))]},Tz=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,a=zx(t,r),n=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+n+" "+Tr(a.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(a.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=jl(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},zx=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,a={text:"",fontSize:""},n=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");n=t.multiline?n.map(function(D){return D.split(`
`)}):n.map(function(D){return[D]});var s=r,l=nr.internal.getHeight(t)||0;l=l<0?-l:l;var c=nr.internal.getWidth(t)||0;c=c<0?-c:c;var d=function(D,T,M){if(D+1<n.length){var V=T+" "+n[D+1][0];return Tp(V,t,M).width<=c-4}return!1};s++;e:for(;s>0;){e="",s--;var f,m,v=Tp("3",t,s).height,x=t.multiline?l-s:(l-v)/2,g=x+=2,b=0,_=0,w=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Tp(e,t,s=12).width+", FieldWidth:"+c+`
`;break}for(var E="",C=0,A=0;A<n.length;A++)if(n.hasOwnProperty(A)){var O=!1;if(n[A].length!==1&&w!==n[A].length-1){if((v+2)*(C+2)+2>l)continue e;E+=n[A][w],O=!0,_=A,A--}else{E=(E+=n[A][w]+" ").substr(E.length-1)==" "?E.substr(0,E.length-1):E;var G=parseInt(A),W=d(G,E,s),B=A>=n.length-1;if(W&&!B){E+=" ",w=0;continue}if(W||B){if(B)_=G;else if(t.multiline&&(v+2)*(C+2)+2>l)continue e}else{if(!t.multiline||(v+2)*(C+2)+2>l)continue e;_=G}}for(var q="",L=b;L<=_;L++){var Z=n[L];if(t.multiline){if(L===_){q+=Z[w]+" ",w=(w+1)%Z.length;continue}if(L===b){q+=Z[Z.length-1]+" ";continue}}q+=Z[0]+" "}switch(q=q.substr(q.length-1)==" "?q.substr(0,q.length-1):q,m=Tp(q,t,s).width,t.textAlign){case"right":f=c-m-2;break;case"center":f=(c-m)/2;break;default:f=2}e+=Tr(f)+" "+Tr(g)+` Td
`,e+="("+Ud(q)+`) Tj
`,e+=-Tr(f)+` 0 Td
`,g=-(s+2),m=0,b=O?_:_+1,C++,E=""}break}return a.text=e,a.fontSize=s,a},Tp=function(t,e,r){var a=e.scope.internal.getFont(e.fontName,e.fontStyle),n=e.scope.getStringUnitWidth(t,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},Oz={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Rz=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},Dz=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(el.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Oz)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Q2=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new ak,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var s=a[n];s.objId=void 0,s.hasAnnotation&&Rz(s,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(a,n){var s=!a;for(var l in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(l)){var c=a[l],d=[],f=c.Rect;if(c.Rect&&(c.Rect=Cz(c.Rect,n)),n.internal.newObjectDeferredBegin(c.objId,!0),c.DA=nr.createDefaultAppearanceStream(c),xa(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(d=c.getKeyValueListForStream()),c.Rect=f,c.hasAppearanceStream&&!c.appearanceStreamContent){var m=Tz(c);d.push({key:"AP",value:"<</N "+m+">>"}),n.internal.acroformPlugin.xForms.push(m)}if(c.appearanceStreamContent){var v="";for(var x in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(x)){var g=c.appearanceStreamContent[x];if(v+="/"+x+" ",v+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var l in g)if(g.hasOwnProperty(l)){var b=g[l];typeof b=="function"&&(b=b.call(n,c)),v+="/"+l+" "+b+" ",n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b)}}else typeof(b=g)=="function"&&(b=b.call(n,c)),v+="/"+l+" "+b,n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b);v+=">>"}d.push({key:"AP",value:`<<
`+v+">>"})}n.internal.putStream({additionalKeyValues:d,objectId:c.objId}),n.internal.out("endobj")}s&&(function(_,w){for(var E in _)if(_.hasOwnProperty(E)){var C=E,A=_[E];w.internal.newObjectDeferredBegin(A.objId,!0),xa(A)==="object"&&typeof A.putStream=="function"&&A.putStream(),delete _[C]}})(n.internal.acroformPlugin.xForms,n)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},tk=mn.__acroform__.arrayToPdfArray=function(t,e,r){var a=function(l){return l};if(Array.isArray(t)){for(var n="[",s=0;s<t.length;s++)switch(s!==0&&(n+=" "),xa(t[s])){case"boolean":case"number":case"object":n+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&r&&(a=r.internal.getEncryptor(e)),n+="("+Ud(a(t[s].toString()))+")"):n+=t[s].toString()}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Bv=function(t,e,r){var a=function(n){return n};return e!==void 0&&r&&(a=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Ud(a(t))+")"},Al=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Al.prototype.toString=function(){return this.objId+" 0 R"},Al.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Al.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var a=e[r],n=this[a];n&&(Array.isArray(n)?t.push({key:a,value:tk(n,this.objId,this.scope)}):n instanceof Al?(n.scope=this.scope,t.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&t.push({key:a,value:n}))}return t};var rk=function(){Al.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};pi(rk,Al);var ak=function(){Al.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Ud(r(t))+")"}},set:function(r){t=r}})};pi(ak,Al);var el=function t(){Al.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute F supplied.');e=E}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!kn(e,3)},set:function(E){E?this.F=En(e,3):this.F=An(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute Ff supplied.');r=E}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(E){a=E!==void 0?E:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(E){a[0]=E}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(E){a[1]=E}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(E){a[2]=E}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(E){a[3]=E}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(E){switch(E){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=E;break;default:throw new Error('Invalid value "'+E+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof f1)return;s="FieldObject"+t.FieldNum++}var E=function(C){return C};return this.scope&&(E=this.scope.internal.getEncryptor(this.objId)),"("+Ud(E(s))+")"},set:function(E){s=E.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(E){s=E}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(E){l=E}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(E){c=E}});var d=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return d},set:function(E){d=E}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/Q2:f},set:function(E){f=E}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(E){m=E}});var v="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!v||this instanceof f1||this instanceof bd))return Bv(v,this.objId,this.scope)},set:function(E){E=E.toString(),v=E}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof ss==0?Bv(x,this.objId,this.scope):x},set:function(E){E=E.toString(),x=this instanceof ss==0?E.substr(0,1)==="("?zf(E.substr(1,E.length-2)):zf(E):E}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ss==1?zf(x.substr(1,x.length-1)):x},set:function(E){E=E.toString(),x=this instanceof ss==1?"/"+E:E}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(E){this.V=E}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof ss==0?Bv(g,this.objId,this.scope):g},set:function(E){E=E.toString(),g=this instanceof ss==0?E.substr(0,1)==="("?zf(E.substr(1,E.length-2)):zf(E):E}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ss==1?zf(g.substr(1,g.length-1)):g},set:function(E){E=E.toString(),g=this instanceof ss==1?"/"+E:E}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,_=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return _},set:function(E){E=!!E,_=E}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(E){b=E}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,1)},set:function(E){E?this.Ff=En(this.Ff,1):this.Ff=An(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,2)},set:function(E){E?this.Ff=En(this.Ff,2):this.Ff=An(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,3)},set:function(E){E?this.Ff=En(this.Ff,3):this.Ff=An(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(E){if([0,1,2].indexOf(E)===-1)throw new Error('Invalid value "'+E+'" for attribute Q supplied.');w=E}}),Object.defineProperty(this,"textAlign",{get:function(){var E;switch(w){case 0:default:E="left";break;case 1:E="center";break;case 2:E="right"}return E},configurable:!0,enumerable:!0,set:function(E){switch(E){case"right":case 2:w=2;break;case"center":case 1:w=1;break;default:w=0}}})};pi(el,Al);var nh=function(){el.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return tk(e,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=(function(s,l,c){c||(c=1);for(var d,f=[];d=l.exec(s);)f.push(d[c]);return f})(a,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,18)},set:function(r){r?this.Ff=En(this.Ff,18):this.Ff=An(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=En(this.Ff,19):this.Ff=An(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,20)},set:function(r){r?(this.Ff=En(this.Ff,20),e.sort()):this.Ff=An(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,22)},set:function(r){r?this.Ff=En(this.Ff,22):this.Ff=An(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,23)},set:function(r){r?this.Ff=En(this.Ff,23):this.Ff=An(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,27)},set:function(r){r?this.Ff=En(this.Ff,27):this.Ff=An(this.Ff,27)}}),this.hasAppearanceStream=!1};pi(nh,el);var sh=function(){nh.call(this),this.fontName="helvetica",this.combo=!1};pi(sh,nh);var ih=function(){sh.call(this),this.combo=!0};pi(ih,sh);var Up=function(){ih.call(this),this.edit=!0};pi(Up,ih);var ss=function(){el.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,15)},set:function(r){r?this.Ff=En(this.Ff,15):this.Ff=An(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,16)},set:function(r){r?this.Ff=En(this.Ff,16):this.Ff=An(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,17)},set:function(r){r?this.Ff=En(this.Ff,17):this.Ff=An(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,26)},set:function(r){r?this.Ff=En(this.Ff,26):this.Ff=An(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var a,n=[];for(a in n.push("<<"),e)n.push("/"+a+" ("+Ud(r(e[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){xa(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};pi(ss,el);var qp=function(){ss.call(this),this.pushButton=!0};pi(qp,ss);var oh=function(){ss.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};pi(oh,ss);var f1=function(){var t,e;el.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(n){e=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(c){return c};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var s,l=[];for(s in l.push("<<"),a)l.push("/"+s+" ("+Ud(n(a[s]))+")");return l.push(">>"),l.join(`
`)},set:function(n){xa(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=nr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};pi(f1,el),oh.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},oh.prototype.createOption=function(t){var e=new f1;return e.Parent=this,e.optionName=t,this.Kids.push(e),Fz.call(this.scope,e),e};var zp=function(){ss.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=nr.CheckBox.createAppearanceStream()};pi(zp,ss);var bd=function(){el.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,13)},set:function(e){e?this.Ff=En(this.Ff,13):this.Ff=An(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,21)},set:function(e){e?this.Ff=En(this.Ff,21):this.Ff=An(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,23)},set:function(e){e?this.Ff=En(this.Ff,23):this.Ff=An(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,24)},set:function(e){e?this.Ff=En(this.Ff,24):this.Ff=An(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,25)},set:function(e){e?this.Ff=En(this.Ff,25):this.Ff=An(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,26)},set:function(e){e?this.Ff=En(this.Ff,26):this.Ff=An(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};pi(bd,el);var Hp=function(){bd.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!kn(this.Ff,14)},set:function(t){t?this.Ff=En(this.Ff,14):this.Ff=An(this.Ff,14)}}),this.password=!0};pi(Hp,bd);var nr={CheckBox:{createAppearanceStream:function(){return{N:{On:nr.CheckBox.YesNormal},D:{On:nr.CheckBox.YesPushDown,Off:nr.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=jl(t);e.scope=t.scope;var r=[],a=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=zx(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Tr(nr.internal.getWidth(t))+" "+Tr(nr.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+Tr(s.fontSize)+" Tf "+n),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=jl(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),n=[],s=nr.internal.getHeight(t),l=nr.internal.getWidth(t),c=zx(t,t.caption);return n.push("1 g"),n.push("0 0 "+Tr(l)+" "+Tr(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+Tr(l-1)+" "+Tr(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+Tr(c.fontSize)+" Tf "+a),n.push(c.text),n.push("ET"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=jl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Tr(nr.internal.getWidth(t))+" "+Tr(nr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:nr.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=nr.RadioButton.Circle.YesNormal,e.D[t]=nr.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=jl(t);e.scope=t.scope;var r=[],a=nr.internal.getWidth(t)<=nr.internal.getHeight(t)?nr.internal.getWidth(t)/4:nr.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=nr.internal.Bezier_C,s=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+lu(nr.internal.getWidth(t)/2)+" "+lu(nr.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=jl(t);e.scope=t.scope;var r=[],a=nr.internal.getWidth(t)<=nr.internal.getHeight(t)?nr.internal.getWidth(t)/4:nr.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*nr.internal.Bezier_C).toFixed(5)),l=Number((a*nr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+lu(nr.internal.getWidth(t)/2)+" "+lu(nr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+lu(nr.internal.getWidth(t)/2)+" "+lu(nr.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+l+" "+l+" "+a+" 0 "+a+" c"),r.push("-"+l+" "+a+" -"+a+" "+l+" -"+a+" 0 c"),r.push("-"+a+" -"+l+" -"+l+" -"+a+" 0 -"+a+" c"),r.push(l+" -"+a+" "+a+" -"+l+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=jl(t);e.scope=t.scope;var r=[],a=nr.internal.getWidth(t)<=nr.internal.getHeight(t)?nr.internal.getWidth(t)/4:nr.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*nr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+lu(nr.internal.getWidth(t)/2)+" "+lu(nr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:nr.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=nr.RadioButton.Cross.YesNormal,e.D[t]=nr.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=jl(t);e.scope=t.scope;var r=[],a=nr.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Tr(nr.internal.getWidth(t)-2)+" "+Tr(nr.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Tr(a.x1.x)+" "+Tr(a.x1.y)+" m"),r.push(Tr(a.x2.x)+" "+Tr(a.x2.y)+" l"),r.push(Tr(a.x4.x)+" "+Tr(a.x4.y)+" m"),r.push(Tr(a.x3.x)+" "+Tr(a.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=jl(t);e.scope=t.scope;var r=nr.internal.calculateCross(t),a=[];return a.push("0.749023 g"),a.push("0 0 "+Tr(nr.internal.getWidth(t))+" "+Tr(nr.internal.getHeight(t))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Tr(nr.internal.getWidth(t)-2)+" "+Tr(nr.internal.getHeight(t)-2)+" re"),a.push("W"),a.push("n"),a.push(Tr(r.x1.x)+" "+Tr(r.x1.y)+" m"),a.push(Tr(r.x2.x)+" "+Tr(r.x2.y)+" l"),a.push(Tr(r.x4.x)+" "+Tr(r.x4.y)+" m"),a.push(Tr(r.x3.x)+" "+Tr(r.x3.y)+" l"),a.push("s"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(t){var e=jl(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Tr(nr.internal.getWidth(t))+" "+Tr(nr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};nr.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=nr.internal.getWidth(t),r=nr.internal.getHeight(t),a=Math.min(e,r);return{x1:{x:(e-a)/2,y:(r-a)/2+a},x2:{x:(e-a)/2+a,y:(r-a)/2},x3:{x:(e-a)/2,y:(r-a)/2},x4:{x:(e-a)/2+a,y:(r-a)/2+a}}}},nr.internal.getWidth=function(t){var e=0;return xa(t)==="object"&&(e=yS(t.Rect[2])),e},nr.internal.getHeight=function(t){var e=0;return xa(t)==="object"&&(e=yS(t.Rect[3])),e};var Fz=mn.addField=function(t){if(Dz(this,t),!(t instanceof el))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};mn.AcroFormChoiceField=nh,mn.AcroFormListBox=sh,mn.AcroFormComboBox=ih,mn.AcroFormEditBox=Up,mn.AcroFormButton=ss,mn.AcroFormPushButton=qp,mn.AcroFormRadioButton=oh,mn.AcroFormCheckBox=zp,mn.AcroFormTextField=bd,mn.AcroFormPasswordField=Hp,mn.AcroFormAppearance=nr,mn.AcroForm={ChoiceField:nh,ListBox:sh,ComboBox:ih,EditBox:Up,Button:ss,PushButton:qp,RadioButton:oh,CheckBox:zp,TextField:bd,PasswordField:Hp,Appearance:nr},ur.AcroForm={ChoiceField:nh,ListBox:sh,ComboBox:ih,EditBox:Up,Button:ss,PushButton:qp,RadioButton:oh,CheckBox:zp,TextField:bd,PasswordField:Hp,Appearance:nr};ur.AcroForm;function nk(t){return t.reduce(function(e,r,a){return e[r]=a,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(D,T){var M,V,ie,X,J,K=r;if((T=T||r)==="RGBA"||D.data!==void 0&&D.data instanceof Uint8ClampedArray&&"height"in D&&"width"in D)return"RGBA";if(W(D))for(J in a)for(ie=a[J],M=0;M<ie.length;M+=1){for(X=!0,V=0;V<ie[M].length;V+=1)if(ie[M][V]!==void 0&&ie[M][V]!==D[V]){X=!1;break}if(X===!0){K=J;break}}else for(J in a)for(ie=a[J],M=0;M<ie.length;M+=1){for(X=!0,V=0;V<ie[M].length;V+=1)if(ie[M][V]!==void 0&&ie[M][V]!==D.charCodeAt(V)){X=!1;break}if(X===!0){K=J;break}}return K===r&&T!==r&&(K=T),K},s=function D(T){for(var M=this.internal.write,V=this.internal.putStream,ie=(0,this.internal.getFilters)();ie.indexOf("FlateEncode")!==-1;)ie.splice(ie.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var X=[];if(X.push({key:"Type",value:"/XObject"}),X.push({key:"Subtype",value:"/Image"}),X.push({key:"Width",value:T.width}),X.push({key:"Height",value:T.height}),T.colorSpace===E.INDEXED?X.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(X.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===E.DEVICE_CMYK&&X.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),X.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&X.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var J="",K=0,te=T.transparency.length;K<te;K++)J+=T.transparency[K]+" "+T.transparency[K]+" ";X.push({key:"Mask",value:"["+J+"]"})}T.sMask!==void 0&&X.push({key:"SMask",value:T.objectId+1+" 0 R"});var fe=T.filter!==void 0?["/"+T.filter]:void 0;if(V({data:T.data,additionalKeyValues:X,alreadyAppliedFilters:fe,objectId:T.objectId}),M("endobj"),"sMask"in T&&T.sMask!==void 0){var U,j=(U=T.sMaskBitsPerComponent)!==null&&U!==void 0?U:T.bitsPerComponent,F={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:j,data:T.sMask};"filter"in T&&(F.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(j," /Columns ").concat(T.width),F.filter=T.filter),D.call(this,F)}if(T.colorSpace===E.INDEXED){var I=this.internal.newObject();V({data:q(new Uint8Array(T.palette)),objectId:I}),M("endobj")}},l=function(){var D=this.internal.collections[e+"images"];for(var T in D)s.call(this,D[T])},c=function(){var D,T=this.internal.collections[e+"images"],M=this.internal.write;for(var V in T)M("/I"+(D=T[V]).index,D.objectId,"0","R")},d=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",c))},f=function(){var D=this.internal.collections[e+"images"];return d.call(this),D},m=function(){return Object.keys(this.internal.collections[e+"images"]).length},v=function(D){return typeof t["process"+D.toUpperCase()]=="function"},x=function(D){return xa(D)==="object"&&D.nodeType===1},g=function(D,T){if(D.nodeName==="IMG"&&D.hasAttribute("src")){var M=""+D.getAttribute("src");if(M.indexOf("data:image/")===0)return Bp(unescape(M).split("base64,").pop());var V=t.loadFile(M,!0);if(V!==void 0)return V}if(D.nodeName==="CANVAS"){if(D.width===0||D.height===0)throw new Error("Given canvas must have data. Canvas width: "+D.width+", height: "+D.height);var ie;switch(T){case"PNG":ie="image/png";break;case"WEBP":ie="image/webp";break;default:ie="image/jpeg"}return Bp(D.toDataURL(ie,1).split("base64,").pop())}},b=function(D){var T=this.internal.collections[e+"images"];if(T){for(var M in T)if(D===T[M].alias)return T[M]}},_=function(D,T,M){return D||T||(D=-96,T=-96),D<0&&(D=-1*M.width*72/D/this.internal.scaleFactor),T<0&&(T=-1*M.height*72/T/this.internal.scaleFactor),D===0&&(D=T*M.width/M.height),T===0&&(T=D*M.height/M.width),[D,T]},w=function(D,T,M,V,ie,X){var J=_.call(this,M,V,ie),K=this.internal.getCoordinateString,te=this.internal.getVerticalCoordinateString,fe=f.call(this);if(M=J[0],V=J[1],fe[ie.index]=ie,X){X*=Math.PI/180;var U=Math.cos(X),j=Math.sin(X),F=function(z){return z.toFixed(4)},I=[F(U),F(j),F(-1*j),F(U),0,0,"cm"]}this.internal.write("q"),X?(this.internal.write([1,"0","0",1,K(D),te(T+V),"cm"].join(" ")),this.internal.write(I.join(" ")),this.internal.write([K(M),"0","0",K(V),"0","0","cm"].join(" "))):this.internal.write([K(M),"0","0",K(V),K(D),te(T+V),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ie.index+" Do"),this.internal.write("Q")},E=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var C=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},A=t.__addimage__.sHashCode=function(D){var T,M,V=0;if(typeof D=="string")for(M=D.length,T=0;T<M;T++)V=(V<<5)-V+D.charCodeAt(T),V|=0;else if(W(D))for(M=D.byteLength/2,T=0;T<M;T++)V=(V<<5)-V+D[T],V|=0;return V},O=t.__addimage__.validateStringAsBase64=function(D){(D=D||"").toString().trim();var T=!0;return D.length===0&&(T=!1),D.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(D.substr(0,D.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(D.substr(-2))===!1&&(T=!1),T},G=t.__addimage__.extractImageFromDataUrl=function(D){if(D==null||!(D=D.trim()).startsWith("data:"))return null;var T=D.indexOf(",");return T<0?null:D.substring(0,T).trim().endsWith("base64")?D.substring(T+1):null};t.__addimage__.isArrayBuffer=function(D){return D instanceof ArrayBuffer};var W=t.__addimage__.isArrayBufferView=function(D){return D instanceof Int8Array||D instanceof Uint8Array||D instanceof Uint8ClampedArray||D instanceof Int16Array||D instanceof Uint16Array||D instanceof Int32Array||D instanceof Uint32Array||D instanceof Float32Array||D instanceof Float64Array},B=t.__addimage__.binaryStringToUint8Array=function(D){for(var T=D.length,M=new Uint8Array(T),V=0;V<T;V++)M[V]=D.charCodeAt(V);return M},q=t.__addimage__.arrayBufferToBinaryString=function(D){for(var T="",M=W(D)?D:new Uint8Array(D),V=0;V<M.length;V+=8192)T+=String.fromCharCode.apply(null,M.subarray(V,V+8192));return T};t.addImage=function(){var D,T,M,V,ie,X,J,K,te;if(typeof arguments[1]=="number"?(T=r,M=arguments[1],V=arguments[2],ie=arguments[3],X=arguments[4],J=arguments[5],K=arguments[6],te=arguments[7]):(T=arguments[1],M=arguments[2],V=arguments[3],ie=arguments[4],X=arguments[5],J=arguments[6],K=arguments[7],te=arguments[8]),xa(D=arguments[0])==="object"&&!x(D)&&"imageData"in D){var fe=D;D=fe.imageData,T=fe.format||T||r,M=fe.x||M||0,V=fe.y||V||0,ie=fe.w||fe.width||ie,X=fe.h||fe.height||X,J=fe.alias||J,K=fe.compression||K,te=fe.rotation||fe.angle||te}var U=this.internal.getFilters();if(K===void 0&&U.indexOf("FlateEncode")!==-1&&(K="SLOW"),isNaN(M)||isNaN(V))throw new Error("Invalid coordinates passed to jsPDF.addImage");d.call(this);var j=L.call(this,D,T,J,K);return w.call(this,M,V,ie,X,j,te),this};var L=function(D,T,M,V){var ie,X,J;if(typeof D=="string"&&n(D)===r){D=unescape(D);var K=Z(D,!1);(K!==""||(K=t.loadFile(D,!0))!==void 0)&&(D=K)}if(x(D)&&(D=g(D,T)),T=n(D,T),!v(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((J=M)==null||J.length===0)&&(M=(function(te){return typeof te=="string"||W(te)?A(te):W(te.data)?A(te.data):null})(D)),(ie=b.call(this,M))||(D instanceof Uint8Array||T==="RGBA"||(X=D,D=B(D)),ie=this["process"+T.toUpperCase()](D,m.call(this),M,(function(te){return te&&typeof te=="string"&&(te=te.toUpperCase()),te in t.image_compression?te:C.NONE})(V),X)),!ie)throw new Error("An unknown error occurred whilst processing the image.");return ie},Z=t.__addimage__.convertBase64ToBinaryString=function(D,T){T=typeof T!="boolean"||T;var M,V="";if(typeof D=="string"){var ie;M=(ie=G(D))!==null&&ie!==void 0?ie:D;try{V=Bp(M)}catch(X){if(T)throw O(M)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+X.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return V};t.getImageProperties=function(D){var T,M,V="";if(x(D)&&(D=g(D)),typeof D=="string"&&n(D)===r&&((V=Z(D,!1))===""&&(V=t.loadFile(D)||""),D=V),M=n(D),!v(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(D instanceof Uint8Array||(D=B(D)),!(T=this["process"+M.toUpperCase()](D)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=M,T}})(ur.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};ur.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var a,n,s,l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,d=this.internal.getPageInfoByObjId(r.objId),f=r.pageContext.annotations,m=!1,v=0;v<f.length&&!m;v++)switch((a=f[v]).type){case"link":(e(a.options.url)||e(a.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var x=0;x<f.length;x++){a=f[x];var g=this.internal.pdfEscape,b=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var _=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),E=this.internal.getEncryptor(_.objId),C=a.title||"Note";s="<</Type /Annot /Subtype /Text "+(n="/Rect ["+l(a.bounds.x)+" "+c(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y)+"] ")+"/Contents ("+g(E(a.contents))+")",s+=" /Popup "+w.objId+" 0 R",s+=" /P "+d.objId+" 0 R",s+=" /T ("+g(E(C))+") >>",_.content=s;var A=_.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+l(a.bounds.x+30)+" "+c(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w+30)+" "+c(a.bounds.y)+"] ")+" /Parent "+A,a.open&&(s+=" /Open true"),s+=" >>",w.content=s,this.internal.write(_.objId,"0 R",w.objId,"0 R");break;case"freetext":n="/Rect ["+l(a.bounds.x)+" "+c(a.bounds.y)+" "+l(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y+a.bounds.h)+"] ";var O=a.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+g(b(a.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+O+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(a.options.name){var G=this.annotations._nameMap[a.options.name];a.options.pageNumber=G.page,a.options.top=G.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",s="",a.options.url)s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+g(b(a.options.url))+") >>";else if(a.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,s+=" /FitV "+a.options.left+"]";break;default:var W=c(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),s+=" /XYZ "+a.options.left+" "+W+" "+a.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},t.link=function(r,a,n,s,l){var c=this.internal.getCurrentPageInfo(),d=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:d(r),y:f(a),w:d(r+n),h:f(a+s)},options:l,type:"link"})},t.textWithLink=function(r,a,n,s){var l,c,d=this.getTextWidth(r),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){c=s.maxWidth;var m=this.splitTextToSize(r,c).length;l=Math.ceil(f*m)}else c=d,l=f;return this.text(r,a,n,s),n+=.2*f,s.align==="center"&&(a-=d/2),s.align==="right"&&(a-=d),this.link(a,n-f,c,l,s),d},t.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}})(ur.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(_){return e[_.charCodeAt(0)]!==void 0},l=t.__arabicParser__.isArabicLetter=function(_){return typeof _=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(_)},c=t.__arabicParser__.isArabicEndLetter=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length<=2},d=t.__arabicParser__.isArabicAlfLetter=function(_){return l(_)&&n.indexOf(_.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length>=1};var f=t.__arabicParser__.arabicLetterHasFinalForm=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length>=3};var m=t.__arabicParser__.arabicLetterHasMedialForm=function(_){return l(_)&&s(_)&&e[_.charCodeAt(0)].length==4},v=t.__arabicParser__.resolveLigatures=function(_){var w=0,E=r,C="",A=0;for(w=0;w<_.length;w+=1)E[_.charCodeAt(w)]!==void 0?(A++,typeof(E=E[_.charCodeAt(w)])=="number"&&(C+=String.fromCharCode(E),E=r,A=0),w===_.length-1&&(E=r,C+=_.charAt(w-(A-1)),w-=A-1,A=0)):(E=r,C+=_.charAt(w-A),w-=A,A=0);return C};t.__arabicParser__.isArabicDiacritic=function(_){return _!==void 0&&a[_.charCodeAt(0)]!==void 0};var x=t.__arabicParser__.getCorrectForm=function(_,w,E){return l(_)?s(_)===!1?-1:!f(_)||!l(w)&&!l(E)||!l(E)&&c(w)||c(_)&&!l(w)||c(_)&&d(w)||c(_)&&c(w)?0:m(_)&&l(w)&&!c(w)&&l(E)&&f(E)?3:c(_)||!l(E)?1:2:-1},g=function(_){var w=0,E=0,C=0,A="",O="",G="",W=(_=_||"").split("\\s+"),B=[];for(w=0;w<W.length;w+=1){for(B.push(""),E=0;E<W[w].length;E+=1)A=W[w][E],O=W[w][E-1],G=W[w][E+1],l(A)?(C=x(A,O,G),B[w]+=C!==-1?String.fromCharCode(e[A.charCodeAt(0)][C]):A):B[w]+=A;B[w]=v(B[w])}return B.join(" ")},b=t.__arabicParser__.processArabic=t.processArabic=function(){var _,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,E=[];if(Array.isArray(w)){var C=0;for(E=[],C=0;C<w.length;C+=1)Array.isArray(w[C])?E.push([g(w[C][0]),w[C][1],w[C][2]]):E.push([g(w[C])]);_=E}else _=g(w);return typeof arguments[0]=="string"?_:(arguments[0].text=_,arguments[0])};t.events.push(["preProcessText",b])})(ur.API),ur.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(c){r=c}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(c){a=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(c){s=c}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(c){l=c}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(ur.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var d=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return d},set:function(_){d=_}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(_){f=_}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(_){m=_}});var v=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return v},set:function(_){v=_}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(_){x=_}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(_){g=_}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(_){b=_}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(d){return a.call(this),this.internal.__cell__.headerFunction=typeof d=="function"?d:void 0,this},t.getTextDimensions=function(d,f){a.call(this);var m=(f=f||{}).fontSize||this.getFontSize(),v=f.font||this.getFont(),x=f.scaleFactor||this.internal.scaleFactor,g=0,b=0,_=0,w=this;if(!Array.isArray(d)&&typeof d!="string"){if(typeof d!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");d=String(d)}var E=f.maxWidth;E>0?typeof d=="string"?d=this.splitTextToSize(d,E):Object.prototype.toString.call(d)==="[object Array]"&&(d=d.reduce(function(A,O){return A.concat(w.splitTextToSize(O,E))},[])):d=Array.isArray(d)?d:[d];for(var C=0;C<d.length;C++)g<(_=this.getStringUnitWidth(d[C],{font:v})*m)&&(g=_);return g!==0&&(b=d.length),{w:g/=x,h:Math.max((b*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/x,0)}},t.cellAddPage=function(){a.call(this),this.addPage();var d=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(d.left,d.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=t.cell=function(){var d;d=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),a.call(this);var f=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,v=this.internal.__cell__.margins||e,x=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===d.lineNumber?(d.x=(f.x||0)+(f.width||0),d.y=f.y||0):f.y+f.height+d.height+v.bottom>this.getPageHeight()?(this.cellAddPage(),d.y=v.top,g&&x&&(this.printHeaderRow(d.lineNumber,!0),d.y+=x[0].height)):d.y=f.y+f.height||d.y),d.text[0]!==void 0&&(this.rect(d.x,d.y,d.width,d.height,r===!0?"FD":void 0),d.align==="right"?this.text(d.text,d.x+d.width-m,d.y+m,{align:"right",baseline:"top"}):d.align==="center"?this.text(d.text,d.x+d.width/2,d.y+m,{align:"center",baseline:"top",maxWidth:d.width-m-m}):this.text(d.text,d.x+m,d.y+m,{align:"left",baseline:"top",maxWidth:d.width-m-m})),this.internal.__cell__.lastCell=d,this};t.table=function(d,f,m,v,x){if(a.call(this),!m)throw new Error("No data for PDF table.");var g,b,_,w,E=[],C=[],A=[],O={},G={},W=[],B=[],q=(x=x||{}).autoSize||!1,L=x.printHeaders!==!1,Z=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,D=x.margins||Object.assign({width:this.getPageWidth()},e),T=typeof x.padding=="number"?x.padding:3,M=x.headerBackgroundColor||"#c8c8c8",V=x.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=L,this.internal.__cell__.margins=D,this.internal.__cell__.table_font_size=Z,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=M,this.internal.__cell__.headerTextColor=V,this.setFontSize(Z),v==null)C=E=Object.keys(m[0]),A=E.map(function(){return"left"});else if(Array.isArray(v)&&xa(v[0])==="object")for(E=v.map(function(fe){return fe.name}),C=v.map(function(fe){return fe.prompt||fe.name||""}),A=v.map(function(fe){return fe.align||"left"}),g=0;g<v.length;g+=1)G[v[g].name]=.7499990551181103*v[g].width;else Array.isArray(v)&&typeof v[0]=="string"&&(C=E=v,A=E.map(function(){return"left"}));if(q||Array.isArray(v)&&typeof v[0]=="string")for(g=0;g<E.length;g+=1){for(O[w=E[g]]=m.map(function(fe){return fe[w]}),this.setFont(void 0,"bold"),W.push(this.getTextDimensions(C[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=O[w],this.setFont(void 0,"normal"),_=0;_<b.length;_+=1)W.push(this.getTextDimensions(b[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);G[w]=Math.max.apply(null,W)+T+T,W=[]}if(L){var ie={};for(g=0;g<E.length;g+=1)ie[E[g]]={},ie[E[g]].text=C[g],ie[E[g]].align=A[g];var X=c.call(this,ie,G);B=E.map(function(fe){return new s(d,f,G[fe],X,ie[fe].text,void 0,ie[fe].align)}),this.setTableHeaderRow(B),this.printHeaderRow(1,!1)}var J=v.reduce(function(fe,U){return fe[U.name]=U.align,fe},{});for(g=0;g<m.length;g+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:g,data:m[g]},this);var K=c.call(this,m[g],G);for(_=0;_<E.length;_+=1){var te=m[g][E[_]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:g,col:_,data:te},this),l.call(this,new s(d,f,G[E[_]],K,te,g+2,J[E[_]]))}}return this.internal.__cell__.table_x=d,this.internal.__cell__.table_y=f,this};var c=function(d,f){var m=this.internal.__cell__.padding,v=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(d).map(function(g){var b=d[g];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,f[g]-m-m)},this).map(function(g){return this.getLineHeightFactor()*g.length*v/x+m+m},this).reduce(function(g,b){return Math.max(g,b)},0)};t.setTableHeaderRow=function(d){a.call(this),this.internal.__cell__.tableHeaderRow=d},t.printHeaderRow=function(d,f){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var v=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(v[0],v[1],v[2],v[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){m=this.internal.__cell__.tableHeaderRow[g].clone(),f&&(m.y=this.internal.__cell__.margins.top||0,x.push(m)),m.lineNumber=d;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,m),this.setTextColor(b)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),r=!1}})(ur.API);var sk={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},ik=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Hx=nk(ik),ok=[100,200,300,400,500,600,700,800,900],Lz=nk(ok);function Uv(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(s){return sk[s=s||"normal"]?s:"normal"})(t.style),a=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(t.weight),n=(function(s){return typeof Hx[s=s||"normal"]=="number"?s:"normal"})(t.stretch);return{family:e,style:r,weight:a,stretch:n,src:t.src||[],ref:t.ref||{name:e,style:[n,r,a].join(" ")}}}function _S(t,e,r,a){var n;for(n=r;n>=0&&n<e.length;n+=a)if(t[e[n]])return t[e[n]];for(n=r;n>=0&&n<e.length;n-=a)if(t[e[n]])return t[e[n]]}var Pz={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},bS={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function wS(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function SS(t){return t.trimLeft()}function Mz(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function Iz(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Op,NS,jS,Hf,Rp,kS,ES,AS,qv=["times"];function CS(t,e,r,a,n){var s=4,l=OS;switch(n){case ur.API.image_compression.FAST:s=1,l=TS;break;case ur.API.image_compression.MEDIUM:s=6,l=RS;break;case ur.API.image_compression.SLOW:s=9,l=DS}t=(function(d,f,m,v){for(var x,g=d.length/f,b=new Uint8Array(d.length+g),_=[Bz,TS,OS,RS,DS],w=0;w<g;w+=1){var E=w*f,C=d.subarray(E,E+f);if(v)b.set(v(C,m,x),E+w);else{for(var A=_.length,O=[],G=0;G<A;G+=1)O[G]=_[G](C,m,x);var W=qz(O.concat());b.set(O[W],E+w)}x=C}return b})(t,e,Math.ceil(r*a/8),l);var c=Px(t,{level:s});return ur.API.__addimage__.arrayBufferToBinaryString(c)}function Bz(t){var e=Array.apply([],t);return e.unshift(0),e}function TS(t,e){var r=t.length,a=[];a[0]=1;for(var n=0;n<r;n+=1){var s=t[n-e]||0;a[n+1]=t[n]-s+256&255}return a}function OS(t,e,r){var a=t.length,n=[];n[0]=2;for(var s=0;s<a;s+=1){var l=r&&r[s]||0;n[s+1]=t[s]-l+256&255}return n}function RS(t,e,r){var a=t.length,n=[];n[0]=3;for(var s=0;s<a;s+=1){var l=t[s-e]||0,c=r&&r[s]||0;n[s+1]=t[s]+256-(l+c>>>1)&255}return n}function DS(t,e,r){var a=t.length,n=[];n[0]=4;for(var s=0;s<a;s+=1){var l=Uz(t[s-e]||0,r&&r[s]||0,r&&r[s-e]||0);n[s+1]=t[s]-l+256&255}return n}function Uz(t,e,r){if(t===e&&e===r)return t;var a=Math.abs(e-r),n=Math.abs(t-r),s=Math.abs(t+e-r-r);return a<=n&&a<=s?t:n<=s?e:r}function qz(t){var e=t.map(function(r){return r.reduce(function(a,n){return a+Math.abs(n)},0)});return e.indexOf(Math.min.apply(null,e))}function zv(t,e,r){var a=e*r,n=Math.floor(a/8),s=16-(a-8*n+r),l=(1<<r)-1;return lk(t,n)>>s&l}function FS(t,e,r,a){var n=r*a,s=Math.floor(n/8),l=16-(n-8*s+a),c=(1<<a)-1,d=(e&c)<<l;(function(f,m,v){if(m+1<f.byteLength)f.setUint16(m,v,!1);else{var x=v>>8&255;f.setUint8(m,x)}})(t,s,lk(t,s)&~(c<<l)&65535|d)}function lk(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function zz(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,a=t[e++]|t[e++]<<8,n=t[e++],s=n>>7,l=1<<1+(7&n);t[e++],t[e++];var c=null,d=null;s&&(c=e,d=l,e+=3*l);var f=!0,m=[],v=0,x=null,g=0,b=null;for(this.width=r,this.height=a;f&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,b=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((D=t[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var _=t[e++];v=t[e++]|t[e++]<<8,x=t[e++],1&_||(x=null),g=_>>2&7,e++;break;case 254:for(;;){if(!((D=t[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var w=t[e++]|t[e++]<<8,E=t[e++]|t[e++]<<8,C=t[e++]|t[e++]<<8,A=t[e++]|t[e++]<<8,O=t[e++],G=O>>6&1,W=1<<1+(7&O),B=c,q=d,L=!1;O>>7&&(L=!0,B=e,q=W,e+=3*W);var Z=e;for(e++;;){var D;if(!((D=t[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}m.push({x:w,y:E,width:C,height:A,has_local_palette:L,palette_offset:B,palette_size:q,data_offset:Z,data_length:e-Z,transparent_index:x,interlaced:!!G,delay:v,disposal:g});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return b},this.frameInfo=function(T){if(T<0||T>=m.length)throw new Error("Frame index out of range.");return m[T]},this.decodeAndBlitFrameBGRA=function(T,M){var V=this.frameInfo(T),ie=V.width*V.height,X=new Uint8Array(ie);LS(t,V.data_offset,X,ie);var J=V.palette_offset,K=V.transparent_index;K===null&&(K=256);var te=V.width,fe=r-te,U=te,j=4*(V.y*r+V.x),F=4*((V.y+V.height)*r+V.x),I=j,z=4*fe;V.interlaced===!0&&(z+=4*r*7);for(var ne=8,se=0,je=X.length;se<je;++se){var Ne=X[se];if(U===0&&(U=te,(I+=z)>=F&&(z=4*fe+4*r*(ne-1),I=j+(te+fe)*(ne<<1),ne>>=1)),Ne===K)I+=4;else{var ge=t[J+3*Ne],Ie=t[J+3*Ne+1],le=t[J+3*Ne+2];M[I++]=le,M[I++]=Ie,M[I++]=ge,M[I++]=255}--U}},this.decodeAndBlitFrameRGBA=function(T,M){var V=this.frameInfo(T),ie=V.width*V.height,X=new Uint8Array(ie);LS(t,V.data_offset,X,ie);var J=V.palette_offset,K=V.transparent_index;K===null&&(K=256);var te=V.width,fe=r-te,U=te,j=4*(V.y*r+V.x),F=4*((V.y+V.height)*r+V.x),I=j,z=4*fe;V.interlaced===!0&&(z+=4*r*7);for(var ne=8,se=0,je=X.length;se<je;++se){var Ne=X[se];if(U===0&&(U=te,(I+=z)>=F&&(z=4*fe+4*r*(ne-1),I=j+(te+fe)*(ne<<1),ne>>=1)),Ne===K)I+=4;else{var ge=t[J+3*Ne],Ie=t[J+3*Ne+1],le=t[J+3*Ne+2];M[I++]=ge,M[I++]=Ie,M[I++]=le,M[I++]=255}--U}}}function LS(t,e,r,a){for(var n=t[e++],s=1<<n,l=s+1,c=l+1,d=n+1,f=(1<<d)-1,m=0,v=0,x=0,g=t[e++],b=new Int32Array(4096),_=null;;){for(;m<16&&g!==0;)v|=t[e++]<<m,m+=8,g===1?g=t[e++]:--g;if(m<d)break;var w=v&f;if(v>>=d,m-=d,w!==s){if(w===l)break;for(var E=w<c?w:_,C=0,A=E;A>s;)A=b[A]>>8,++C;var O=A;if(x+C+(E!==w?1:0)>a)return void Oa.log("Warning, gif stream longer than expected.");r[x++]=O;var G=x+=C;for(E!==w&&(r[x++]=O),A=E;C--;)A=b[A],r[--G]=255&A,A>>=8;_!==null&&c<4096&&(b[c++]=_<<8|O,c>=f+1&&d<12&&(++d,f=f<<1|1)),_=w}else c=l+1,f=(1<<(d=n+1))-1,_=null}return x!==a&&Oa.log("Warning, gif stream shorter than expected."),r}function Hv(t){var e,r,a,n,s,l=Math.floor,c=new Array(64),d=new Array(64),f=new Array(64),m=new Array(64),v=new Array(65535),x=new Array(65535),g=new Array(64),b=new Array(64),_=[],w=0,E=7,C=new Array(64),A=new Array(64),O=new Array(64),G=new Array(256),W=new Array(2048),B=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],q=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],Z=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],D=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],V=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ie=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function X(j,F){for(var I=0,z=0,ne=new Array,se=1;se<=16;se++){for(var je=1;je<=j[se];je++)ne[F[z]]=[],ne[F[z]][0]=I,ne[F[z]][1]=se,z++,I++;I*=2}return ne}function J(j){for(var F=j[0],I=j[1]-1;I>=0;)F&1<<I&&(w|=1<<E),I--,--E<0&&(w==255?(K(255),K(0)):K(w),E=7,w=0)}function K(j){_.push(j)}function te(j){K(j>>8&255),K(255&j)}function fe(j,F,I,z,ne){for(var se,je=ne[0],Ne=ne[240],ge=(function(Be,jt){var Je,ct,St,Ft,Xt,Ut,Wt,$t,wt,Ce,st=0;for(wt=0;wt<8;++wt){Je=Be[st],ct=Be[st+1],St=Be[st+2],Ft=Be[st+3],Xt=Be[st+4],Ut=Be[st+5],Wt=Be[st+6];var Dt=Je+($t=Be[st+7]),At=Je-$t,Ct=ct+Wt,Te=ct-Wt,Ve=St+Ut,_e=St-Ut,Ue=Ft+Xt,Fe=Ft-Xt,gt=Dt+Ue,Ht=Dt-Ue,Vt=Ct+Ve,zt=Ct-Ve;Be[st]=gt+Vt,Be[st+4]=gt-Vt;var kt=.707106781*(zt+Ht);Be[st+2]=Ht+kt,Be[st+6]=Ht-kt;var sr=.382683433*((gt=Fe+_e)-(zt=Te+At)),Pr=.5411961*gt+sr,Nt=1.306562965*zt+sr,fa=.707106781*(Vt=_e+Te),ir=At+fa,Ea=At-fa;Be[st+5]=Ea+Pr,Be[st+3]=Ea-Pr,Be[st+1]=ir+Nt,Be[st+7]=ir-Nt,st+=8}for(st=0,wt=0;wt<8;++wt){Je=Be[st],ct=Be[st+8],St=Be[st+16],Ft=Be[st+24],Xt=Be[st+32],Ut=Be[st+40],Wt=Be[st+48];var xn=Je+($t=Be[st+56]),Ra=Je-$t,nn=ct+Wt,Pt=ct-Wt,Zt=St+Ut,ae=St-Ut,be=Ft+Xt,me=Ft-Xt,pe=xn+be,Se=xn-be,we=nn+Zt,$e=nn-Zt;Be[st]=pe+we,Be[st+32]=pe-we;var lt=.707106781*($e+Se);Be[st+16]=Se+lt,Be[st+48]=Se-lt;var Xe=.382683433*((pe=me+ae)-($e=Pt+Ra)),Ke=.5411961*pe+Xe,Qe=1.306562965*$e+Xe,Et=.707106781*(we=ae+Pt),Rt=Ra+Et,qt=Ra-Et;Be[st+40]=qt+Ke,Be[st+24]=qt-Ke,Be[st+8]=Rt+Qe,Be[st+56]=Rt-Qe,st++}for(wt=0;wt<64;++wt)Ce=Be[wt]*jt[wt],g[wt]=Ce>0?Ce+.5|0:Ce-.5|0;return g})(j,F),Ie=0;Ie<64;++Ie)b[B[Ie]]=ge[Ie];var le=b[0]-I;I=b[0],le==0?J(z[0]):(J(z[x[se=32767+le]]),J(v[se]));for(var Ge=63;Ge>0&&b[Ge]==0;)Ge--;if(Ge==0)return J(je),I;for(var rt,ue=1;ue<=Ge;){for(var ot=ue;b[ue]==0&&ue<=Ge;)++ue;var xe=ue-ot;if(xe>=16){rt=xe>>4;for(var ve=1;ve<=rt;++ve)J(Ne);xe&=15}se=32767+b[ue],J(ne[(xe<<4)+x[se]]),J(v[se]),ue++}return Ge!=63&&J(je),I}function U(j){j=Math.min(Math.max(j,1),100),s!=j&&((function(F){for(var I=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],z=0;z<64;z++){var ne=l((I[z]*F+50)/100);ne=Math.min(Math.max(ne,1),255),c[B[z]]=ne}for(var se=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],je=0;je<64;je++){var Ne=l((se[je]*F+50)/100);Ne=Math.min(Math.max(Ne,1),255),d[B[je]]=Ne}for(var ge=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ie=0,le=0;le<8;le++)for(var Ge=0;Ge<8;Ge++)f[Ie]=1/(c[B[Ie]]*ge[le]*ge[Ge]*8),m[Ie]=1/(d[B[Ie]]*ge[le]*ge[Ge]*8),Ie++})(j<50?Math.floor(5e3/j):Math.floor(200-2*j)),s=j)}this.encode=function(j,F){F&&U(F),_=new Array,w=0,E=7,te(65496),te(65504),te(16),K(74),K(70),K(73),K(70),K(0),K(1),K(1),K(0),te(1),te(1),K(0),K(0),(function(){te(65499),te(132),K(0);for(var ct=0;ct<64;ct++)K(c[ct]);K(1);for(var St=0;St<64;St++)K(d[St])})(),(function(ct,St){te(65472),te(17),K(8),te(St),te(ct),K(3),K(1),K(17),K(0),K(2),K(17),K(1),K(3),K(17),K(1)})(j.width,j.height),(function(){te(65476),te(418),K(0);for(var ct=0;ct<16;ct++)K(q[ct+1]);for(var St=0;St<=11;St++)K(L[St]);K(16);for(var Ft=0;Ft<16;Ft++)K(Z[Ft+1]);for(var Xt=0;Xt<=161;Xt++)K(D[Xt]);K(1);for(var Ut=0;Ut<16;Ut++)K(T[Ut+1]);for(var Wt=0;Wt<=11;Wt++)K(M[Wt]);K(17);for(var $t=0;$t<16;$t++)K(V[$t+1]);for(var wt=0;wt<=161;wt++)K(ie[wt])})(),te(65498),te(12),K(3),K(1),K(0),K(2),K(17),K(3),K(17),K(0),K(63),K(0);var I=0,z=0,ne=0;w=0,E=7,this.encode.displayName="_encode_";for(var se,je,Ne,ge,Ie,le,Ge,rt,ue,ot=j.data,xe=j.width,ve=j.height,Be=4*xe,jt=0;jt<ve;){for(se=0;se<Be;){for(Ie=Be*jt+se,Ge=-1,rt=0,ue=0;ue<64;ue++)le=Ie+(rt=ue>>3)*Be+(Ge=4*(7&ue)),jt+rt>=ve&&(le-=Be*(jt+1+rt-ve)),se+Ge>=Be&&(le-=se+Ge-Be+4),je=ot[le++],Ne=ot[le++],ge=ot[le++],C[ue]=(W[je]+W[Ne+256|0]+W[ge+512|0]>>16)-128,A[ue]=(W[je+768|0]+W[Ne+1024|0]+W[ge+1280|0]>>16)-128,O[ue]=(W[je+1280|0]+W[Ne+1536|0]+W[ge+1792|0]>>16)-128;I=fe(C,f,I,e,a),z=fe(A,m,z,r,n),ne=fe(O,m,ne,r,n),se+=32}jt+=8}if(E>=0){var Je=[];Je[1]=E+1,Je[0]=(1<<E+1)-1,J(Je)}return te(65497),new Uint8Array(_)},t=t||50,(function(){for(var j=String.fromCharCode,F=0;F<256;F++)G[F]=j(F)})(),e=X(q,L),r=X(T,M),a=X(Z,D),n=X(V,ie),(function(){for(var j=1,F=2,I=1;I<=15;I++){for(var z=j;z<F;z++)x[32767+z]=I,v[32767+z]=[],v[32767+z][1]=I,v[32767+z][0]=z;for(var ne=-(F-1);ne<=-j;ne++)x[32767+ne]=I,v[32767+ne]=[],v[32767+ne][1]=I,v[32767+ne][0]=F-1+ne;j<<=1,F<<=1}})(),(function(){for(var j=0;j<256;j++)W[j]=19595*j,W[j+256|0]=38470*j,W[j+512|0]=7471*j+32768,W[j+768|0]=-11059*j,W[j+1024|0]=-21709*j,W[j+1280|0]=32768*j+8421375,W[j+1536|0]=-27439*j,W[j+1792|0]=-5329*j})(),U(t)}function $o(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function PS(t){function e(L){if(!L)throw Error("assert :P")}function r(L,Z,D){for(var T=0;4>T;T++)if(L[Z+T]!=D.charCodeAt(T))return!0;return!1}function a(L,Z,D,T,M){for(var V=0;V<M;V++)L[Z+V]=D[T+V]}function n(L,Z,D,T){for(var M=0;M<T;M++)L[Z+M]=D}function s(L){return new Int32Array(L)}function l(L,Z){for(var D=[],T=0;T<L;T++)D.push(new Z);return D}function c(L,Z){var D=[];return(function T(M,V,ie){for(var X=ie[V],J=0;J<X&&(M.push(ie.length>V+1?[]:new Z),!(ie.length<V+1));J++)T(M[J],V+1,ie)})(D,0,L),D}var d=function(){var L=this;function Z(y,N){for(var P=1<<N-1>>>0;y&P;)P>>>=1;return P?(y&P-1)+P:y}function D(y,N,P,H,re){e(!(H%P));do y[N+(H-=P)]=re;while(0<H)}function T(y,N,P,H,re){if(e(2328>=re),512>=re)var oe=s(512);else if((oe=s(re))==null)return 0;return(function(ce,he,ye,Ee,Le,Ze){var ke,Me,We=he,dt=1<<ye,Ye=s(16),ut=s(16);for(e(Le!=0),e(Ee!=null),e(ce!=null),e(0<ye),Me=0;Me<Le;++Me){if(15<Ee[Me])return 0;++Ye[Ee[Me]]}if(Ye[0]==Le)return 0;for(ut[1]=0,ke=1;15>ke;++ke){if(Ye[ke]>1<<ke)return 0;ut[ke+1]=ut[ke]+Ye[ke]}for(Me=0;Me<Le;++Me)ke=Ee[Me],0<Ee[Me]&&(Ze[ut[ke]++]=Me);if(ut[15]==1)return(Ee=new M).g=0,Ee.value=Ze[0],D(ce,We,1,dt,Ee),dt;var pt,Tt=-1,yt=dt-1,ar=0,Gt=1,jr=1,Qt=1<<ye;for(Me=0,ke=1,Le=2;ke<=ye;++ke,Le<<=1){if(Gt+=jr<<=1,0>(jr-=Ye[ke]))return 0;for(;0<Ye[ke];--Ye[ke])(Ee=new M).g=ke,Ee.value=Ze[Me++],D(ce,We+ar,Le,Qt,Ee),ar=Z(ar,ke)}for(ke=ye+1,Le=2;15>=ke;++ke,Le<<=1){if(Gt+=jr<<=1,0>(jr-=Ye[ke]))return 0;for(;0<Ye[ke];--Ye[ke]){if(Ee=new M,(ar&yt)!=Tt){for(We+=Qt,pt=1<<(Tt=ke)-ye;15>Tt&&!(0>=(pt-=Ye[Tt]));)++Tt,pt<<=1;dt+=Qt=1<<(pt=Tt-ye),ce[he+(Tt=ar&yt)].g=pt+ye,ce[he+Tt].value=We-he-Tt}Ee.g=ke-ye,Ee.value=Ze[Me++],D(ce,We+(ar>>ye),Le,Qt,Ee),ar=Z(ar,ke)}}return Gt!=2*ut[15]-1?0:dt})(y,N,P,H,re,oe)}function M(){this.value=this.g=0}function V(){this.value=this.g=0}function ie(){this.G=l(5,M),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(ol,V)}function X(y,N,P,H){e(y!=null),e(N!=null),e(2147483648>H),y.Ca=254,y.I=0,y.b=-8,y.Ka=0,y.oa=N,y.pa=P,y.Jd=N,y.Yc=P+H,y.Zc=4<=H?P+H-4+1:P,je(y)}function J(y,N){for(var P=0;0<N--;)P|=ge(y,128)<<N;return P}function K(y,N){var P=J(y,N);return Ne(y)?-P:P}function te(y,N,P,H){var re,oe=0;for(e(y!=null),e(N!=null),e(4294967288>H),y.Sb=H,y.Ra=0,y.u=0,y.h=0,4<H&&(H=4),re=0;re<H;++re)oe+=N[P+re]<<8*re;y.Ra=oe,y.bb=H,y.oa=N,y.pa=P}function fe(y){for(;8<=y.u&&y.bb<y.Sb;)y.Ra>>>=8,y.Ra+=y.oa[y.pa+y.bb]<<Gi-8>>>0,++y.bb,y.u-=8;z(y)&&(y.h=1,y.u=0)}function U(y,N){if(e(0<=N),!y.h&&N<=fs){var P=I(y)&Ss[N];return y.u+=N,fe(y),P}return y.h=1,y.u=0}function j(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function F(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function I(y){return y.Ra>>>(y.u&Gi-1)>>>0}function z(y){return e(y.bb<=y.Sb),y.h||y.bb==y.Sb&&y.u>Gi}function ne(y,N){y.u=N,y.h=z(y)}function se(y){y.u>=Yi&&(e(y.u>=Yi),fe(y))}function je(y){e(y!=null&&y.oa!=null),y.pa<y.Zc?(y.I=(y.oa[y.pa++]|y.I<<8)>>>0,y.b+=8):(e(y!=null&&y.oa!=null),y.pa<y.Yc?(y.b+=8,y.I=y.oa[y.pa++]|y.I<<8):y.Ka?y.b=0:(y.I<<=8,y.b+=8,y.Ka=1))}function Ne(y){return J(y,1)}function ge(y,N){var P=y.Ca;0>y.b&&je(y);var H=y.b,re=P*N>>>8,oe=(y.I>>>H>re)+0;for(oe?(P-=re,y.I-=re+1<<H>>>0):P=re+1,H=P,re=0;256<=H;)re+=8,H>>=8;return H=7^re+To[H],y.b-=H,y.Ca=(P<<H)-1,oe}function Ie(y,N,P){y[N+0]=P>>24&255,y[N+1]=P>>16&255,y[N+2]=P>>8&255,y[N+3]=255&P}function le(y,N){return y[N+0]|y[N+1]<<8}function Ge(y,N){return le(y,N)|y[N+2]<<16}function rt(y,N){return le(y,N)|le(y,N+2)<<16}function ue(y,N){var P=1<<N;return e(y!=null),e(0<N),y.X=s(P),y.X==null?0:(y.Mb=32-N,y.Xa=N,1)}function ot(y,N){e(y!=null),e(N!=null),e(y.Xa==N.Xa),a(N.X,0,y.X,0,1<<N.Xa)}function xe(){this.X=[],this.Xa=this.Mb=0}function ve(y,N,P,H){e(P!=null),e(H!=null);var re=P[0],oe=H[0];return re==0&&(re=(y*oe+N/2)/N),oe==0&&(oe=(N*re+y/2)/y),0>=re||0>=oe?0:(P[0]=re,H[0]=oe,1)}function Be(y,N){return y+(1<<N)-1>>>N}function jt(y,N){return((4278255360&y)+(4278255360&N)>>>0&4278255360)+((16711935&y)+(16711935&N)>>>0&16711935)>>>0}function Je(y,N){L[N]=function(P,H,re,oe,ce,he,ye){var Ee;for(Ee=0;Ee<ce;++Ee){var Le=L[y](he[ye+Ee-1],re,oe+Ee);he[ye+Ee]=jt(P[H+Ee],Le)}}}function ct(){this.ud=this.hd=this.jd=0}function St(y,N){return((4278124286&(y^N))>>>1)+(y&N)>>>0}function Ft(y){return 0<=y&&256>y?y:0>y?0:255<y?255:void 0}function Xt(y,N){return Ft(y+(y-N+.5>>1))}function Ut(y,N,P){return Math.abs(N-P)-Math.abs(y-P)}function Wt(y,N,P,H,re,oe,ce){for(H=oe[ce-1],P=0;P<re;++P)oe[ce+P]=H=jt(y[N+P],H)}function $t(y,N,P,H,re){var oe;for(oe=0;oe<P;++oe){var ce=y[N+oe],he=ce>>8&255,ye=16711935&(ye=(ye=16711935&ce)+((he<<16)+he));H[re+oe]=(4278255360&ce)+ye>>>0}}function wt(y,N){N.jd=255&y,N.hd=y>>8&255,N.ud=y>>16&255}function Ce(y,N,P,H,re,oe){var ce;for(ce=0;ce<H;++ce){var he=N[P+ce],ye=he>>>8,Ee=he,Le=255&(Le=(Le=he>>>16)+((y.jd<<24>>24)*(ye<<24>>24)>>>5));Ee=255&(Ee=(Ee+=(y.hd<<24>>24)*(ye<<24>>24)>>>5)+((y.ud<<24>>24)*(Le<<24>>24)>>>5)),re[oe+ce]=(4278255360&he)+(Le<<16)+Ee}}function st(y,N,P,H,re){L[N]=function(oe,ce,he,ye,Ee,Le,Ze,ke,Me){for(ye=Ze;ye<ke;++ye)for(Ze=0;Ze<Me;++Ze)Ee[Le++]=re(he[H(oe[ce++])])},L[y]=function(oe,ce,he,ye,Ee,Le,Ze){var ke=8>>oe.b,Me=oe.Ea,We=oe.K[0],dt=oe.w;if(8>ke)for(oe=(1<<oe.b)-1,dt=(1<<ke)-1;ce<he;++ce){var Ye,ut=0;for(Ye=0;Ye<Me;++Ye)Ye&oe||(ut=H(ye[Ee++])),Le[Ze++]=re(We[ut&dt]),ut>>=ke}else L["VP8LMapColor"+P](ye,Ee,We,dt,Le,Ze,ce,he,Me)}}function Dt(y,N,P,H,re){for(P=N+P;N<P;){var oe=y[N++];H[re++]=oe>>16&255,H[re++]=oe>>8&255,H[re++]=255&oe}}function At(y,N,P,H,re){for(P=N+P;N<P;){var oe=y[N++];H[re++]=oe>>16&255,H[re++]=oe>>8&255,H[re++]=255&oe,H[re++]=oe>>24&255}}function Ct(y,N,P,H,re){for(P=N+P;N<P;){var oe=(ce=y[N++])>>16&240|ce>>12&15,ce=240&ce|ce>>28&15;H[re++]=oe,H[re++]=ce}}function Te(y,N,P,H,re){for(P=N+P;N<P;){var oe=(ce=y[N++])>>16&248|ce>>13&7,ce=ce>>5&224|ce>>3&31;H[re++]=oe,H[re++]=ce}}function Ve(y,N,P,H,re){for(P=N+P;N<P;){var oe=y[N++];H[re++]=255&oe,H[re++]=oe>>8&255,H[re++]=oe>>16&255}}function _e(y,N,P,H,re,oe){if(oe==0)for(P=N+P;N<P;)Ie(H,((oe=y[N++])[0]>>24|oe[1]>>8&65280|oe[2]<<8&16711680|oe[3]<<24)>>>0),re+=32;else a(H,re,y,N,P)}function Ue(y,N){L[N][0]=L[y+"0"],L[N][1]=L[y+"1"],L[N][2]=L[y+"2"],L[N][3]=L[y+"3"],L[N][4]=L[y+"4"],L[N][5]=L[y+"5"],L[N][6]=L[y+"6"],L[N][7]=L[y+"7"],L[N][8]=L[y+"8"],L[N][9]=L[y+"9"],L[N][10]=L[y+"10"],L[N][11]=L[y+"11"],L[N][12]=L[y+"12"],L[N][13]=L[y+"13"],L[N][14]=L[y+"0"],L[N][15]=L[y+"0"]}function Fe(y){return y==Vu||y==tf||y==Mc||y==rf}function gt(){this.eb=[],this.size=this.A=this.fb=0}function Ht(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Vt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new gt,this.f.kb=new Ht,this.sd=null}function zt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function kt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function sr(y){return alert("todo:WebPSamplerProcessPlane"),y.T}function Pr(y,N){var P=y.T,H=N.ba.f.RGBA,re=H.eb,oe=H.fb+y.ka*H.A,ce=Wn[N.ba.S],he=y.y,ye=y.O,Ee=y.f,Le=y.N,Ze=y.ea,ke=y.W,Me=N.cc,We=N.dc,dt=N.Mc,Ye=N.Nc,ut=y.ka,pt=y.ka+y.T,Tt=y.U,yt=Tt+1>>1;for(ut==0?ce(he,ye,null,null,Ee,Le,Ze,ke,Ee,Le,Ze,ke,re,oe,null,null,Tt):(ce(N.ec,N.fc,he,ye,Me,We,dt,Ye,Ee,Le,Ze,ke,re,oe-H.A,re,oe,Tt),++P);ut+2<pt;ut+=2)Me=Ee,We=Le,dt=Ze,Ye=ke,Le+=y.Rc,ke+=y.Rc,oe+=2*H.A,ce(he,(ye+=2*y.fa)-y.fa,he,ye,Me,We,dt,Ye,Ee,Le,Ze,ke,re,oe-H.A,re,oe,Tt);return ye+=y.fa,y.j+pt<y.o?(a(N.ec,N.fc,he,ye,Tt),a(N.cc,N.dc,Ee,Le,yt),a(N.Mc,N.Nc,Ze,ke,yt),P--):1&pt||ce(he,ye,null,null,Ee,Le,Ze,ke,Ee,Le,Ze,ke,re,oe+H.A,null,null,Tt),P}function Nt(y,N,P){var H=y.F,re=[y.J];if(H!=null){var oe=y.U,ce=N.ba.S,he=ce==Wu||ce==Mc;N=N.ba.f.RGBA;var ye=[0],Ee=y.ka;ye[0]=y.T,y.Kb&&(Ee==0?--ye[0]:(--Ee,re[0]-=y.width),y.j+y.ka+y.T==y.o&&(ye[0]=y.o-y.j-Ee));var Le=N.eb;Ee=N.fb+Ee*N.A,y=qu(H,re[0],y.width,oe,ye,Le,Ee+(he?0:3),N.A),e(P==ye),y&&Fe(ce)&&ql(Le,Ee,he,oe,ye,N.A)}return 0}function fa(y){var N=y.ma,P=N.ba.S,H=11>P,re=P==es||P==Qs||P==Wu||P==Pc||P==12||Fe(P);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!Co(N.Oa,y,re?11:12))return 0;if(re&&Fe(P)&&Mu(),y.da)alert("todo:use_scaling");else{if(H){if(N.Ib=sr,y.Kb){if(P=y.U+1>>1,N.memory=s(y.U+2*P),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+y.U,N.Mc=N.cc,N.Nc=N.dc+P,N.Ib=Pr,Mu()}}else alert("todo:EmitYUV");re&&(N.Jb=Nt,H&&bi())}if(H&&!ml){for(y=0;256>y;++y)Vn[y]=89858*(y-128)+Uc>>si,D1[y]=-22014*(y-128)+Uc,mm[y]=-45773*(y-128),lf[y]=113618*(y-128)+Uc>>si;for(y=Wl;y<hl;++y)N=76283*(y-16)+Uc>>si,F1[y-Wl]=Fa(N,255),L1[y-Wl]=Fa(N+8>>4,15);ml=1}return 1}function ir(y){var N=y.ma,P=y.U,H=y.T;return e(!(1&y.ka)),0>=P||0>=H?0:(P=N.Ib(y,N),N.Jb!=null&&N.Jb(y,N,P),N.Dc+=P,1)}function Ea(y){y.ma.memory=null}function xn(y,N,P,H){return U(y,8)!=47?0:(N[0]=U(y,14)+1,P[0]=U(y,14)+1,H[0]=U(y,1),U(y,3)!=0?0:!y.h)}function Ra(y,N){if(4>y)return y+1;var P=y-2>>1;return(2+(1&y)<<P)+U(N,P)+1}function nn(y,N){return 120<N?N-120:1<=(P=((P=ti[N-1])>>4)*y+(8-(15&P)))?P:1;var P}function Pt(y,N,P){var H=I(P),re=y[N+=255&H].g-8;return 0<re&&(ne(P,P.u+8),H=I(P),N+=y[N].value,N+=H&(1<<re)-1),ne(P,P.u+y[N].g),y[N].value}function Zt(y,N,P){return P.g+=y.g,P.value+=y.value<<N>>>0,e(8>=P.g),y.g}function ae(y,N,P){var H=y.xc;return e((N=H==0?0:y.vc[y.md*(P>>H)+(N>>H)])<y.Wb),y.Ya[N]}function be(y,N,P,H){var re=y.ab,oe=y.c*N,ce=y.C;N=ce+N;var he=P,ye=H;for(H=y.Ta,P=y.Ua;0<re--;){var Ee=y.gc[re],Le=ce,Ze=N,ke=he,Me=ye,We=(ye=H,he=P,Ee.Ea);switch(e(Le<Ze),e(Ze<=Ee.nc),Ee.hc){case 2:Ja(ke,Me,(Ze-Le)*We,ye,he);break;case 0:var dt=Le,Ye=Ze,ut=ye,pt=he,Tt=(Qt=Ee).Ea;dt==0&&(Rc(ke,Me,null,null,1,ut,pt),Wt(ke,Me+1,0,0,Tt-1,ut,pt+1),Me+=Tt,pt+=Tt,++dt);for(var yt=1<<Qt.b,ar=yt-1,Gt=Be(Tt,Qt.b),jr=Qt.K,Qt=Qt.w+(dt>>Qt.b)*Gt;dt<Ye;){var Br=jr,Ca=Qt,Ar=1;for(Dc(ke,Me,ut,pt-Tt,1,ut,pt);Ar<Tt;){var Yt=(Ar&~ar)+yt;Yt>Tt&&(Yt=Tt),(0,Oo[Br[Ca++]>>8&15])(ke,Me+ +Ar,ut,pt+Ar-Tt,Yt-Ar,ut,pt+Ar),Ar=Yt}Me+=Tt,pt+=Tt,++dt&ar||(Qt+=Gt)}Ze!=Ee.nc&&a(ye,he-We,ye,he+(Ze-Le-1)*We,We);break;case 1:for(We=ke,Ye=Me,Tt=(ke=Ee.Ea)-(pt=ke&~(ut=(Me=1<<Ee.b)-1)),dt=Be(ke,Ee.b),yt=Ee.K,Ee=Ee.w+(Le>>Ee.b)*dt;Le<Ze;){for(ar=yt,Gt=Ee,jr=new ct,Qt=Ye+pt,Br=Ye+ke;Ye<Qt;)wt(ar[Gt++],jr),Fc(jr,We,Ye,Me,ye,he),Ye+=Me,he+=Me;Ye<Br&&(wt(ar[Gt++],jr),Fc(jr,We,Ye,Tt,ye,he),Ye+=Tt,he+=Tt),++Le&ut||(Ee+=dt)}break;case 3:if(ke==ye&&Me==he&&0<Ee.b){for(Ye=ye,ke=We=he+(Ze-Le)*We-(pt=(Ze-Le)*Be(Ee.Ea,Ee.b)),Me=ye,ut=he,dt=[],pt=(Tt=pt)-1;0<=pt;--pt)dt[pt]=Me[ut+pt];for(pt=Tt-1;0<=pt;--pt)Ye[ke+pt]=dt[pt];Kd(Ee,Le,Ze,ye,We,ye,he)}else Kd(Ee,Le,Ze,ke,Me,ye,he)}he=H,ye=P}ye!=P&&a(H,P,he,ye,oe)}function me(y,N){var P=y.V,H=y.Ba+y.c*y.C,re=N-y.C;if(e(N<=y.l.o),e(16>=re),0<re){var oe=y.l,ce=y.Ta,he=y.Ua,ye=oe.width;if(be(y,re,P,H),re=he=[he],e((P=y.C)<(H=N)),e(oe.v<oe.va),H>oe.o&&(H=oe.o),P<oe.j){var Ee=oe.j-P;P=oe.j,re[0]+=Ee*ye}if(P>=H?P=0:(re[0]+=4*oe.v,oe.ka=P-oe.j,oe.U=oe.va-oe.v,oe.T=H-P,P=1),P){if(he=he[0],11>(P=y.ca).S){var Le=P.f.RGBA,Ze=(H=P.S,re=oe.U,oe=oe.T,Ee=Le.eb,Le.A),ke=oe;for(Le=Le.fb+y.Ma*Le.A;0<ke--;){var Me=ce,We=he,dt=re,Ye=Ee,ut=Le;switch(H){case Qd:Lc(Me,We,dt,Ye,ut);break;case es:Ro(Me,We,dt,Ye,ut);break;case Vu:Ro(Me,We,dt,Ye,ut),ql(Ye,ut,0,dt,1,0);break;case ef:Bl(Me,We,dt,Ye,ut);break;case Qs:_e(Me,We,dt,Ye,ut,1);break;case tf:_e(Me,We,dt,Ye,ut,1),ql(Ye,ut,0,dt,1,0);break;case Wu:_e(Me,We,dt,Ye,ut,0);break;case Mc:_e(Me,We,dt,Ye,ut,0),ql(Ye,ut,1,dt,1,0);break;case Pc:Do(Me,We,dt,Ye,ut);break;case rf:Do(Me,We,dt,Ye,ut),Zs(Ye,ut,dt,1,0);break;case ll:Ji(Me,We,dt,Ye,ut);break;default:e(0)}he+=ye,Le+=Ze}y.Ma+=oe}else alert("todo:EmitRescaledRowsYUVA");e(y.Ma<=P.height)}}y.C=N,e(y.C<=y.i)}function pe(y){var N;if(0<y.ua)return 0;for(N=0;N<y.Wb;++N){var P=y.Ya[N].G,H=y.Ya[N].H;if(0<P[1][H[1]+0].g||0<P[2][H[2]+0].g||0<P[3][H[3]+0].g)return 0}return 1}function Se(y,N,P,H,re,oe){if(y.Z!=0){var ce=y.qd,he=y.rd;for(e(Po[y.Z]!=null);N<P;++N)Po[y.Z](ce,he,H,re,H,re,oe),ce=H,he=re,re+=oe;y.qd=ce,y.rd=he}}function we(y,N){var P=y.l.ma,H=P.Z==0||P.Z==1?y.l.j:y.C;if(H=y.C<H?H:y.C,e(N<=y.l.o),N>H){var re=y.l.width,oe=P.ca,ce=P.tb+re*H,he=y.V,ye=y.Ba+y.c*H,Ee=y.gc;e(y.ab==1),e(Ee[0].hc==3),Ki(Ee[0],H,N,he,ye,oe,ce),Se(P,H,N,oe,ce,re)}y.C=y.Ma=N}function $e(y,N,P,H,re,oe,ce){var he=y.$/H,ye=y.$%H,Ee=y.m,Le=y.s,Ze=P+y.$,ke=Ze;re=P+H*re;var Me=P+H*oe,We=280+Le.ua,dt=y.Pb?he:16777216,Ye=0<Le.ua?Le.Wa:null,ut=Le.wc,pt=Ze<Me?ae(Le,ye,he):null;e(y.C<oe),e(Me<=re);var Tt=!1;e:for(;;){for(;Tt||Ze<Me;){var yt=0;if(he>=dt){var ar=Ze-P;e((dt=y).Pb),dt.wd=dt.m,dt.xd=ar,0<dt.s.ua&&ot(dt.s.Wa,dt.s.vb),dt=he+cl}if(ye&ut||(pt=ae(Le,ye,he)),e(pt!=null),pt.Qb&&(N[Ze]=pt.qb,Tt=!0),!Tt)if(se(Ee),pt.jc){yt=Ee,ar=N;var Gt=Ze,jr=pt.pd[I(yt)&ol-1];e(pt.jc),256>jr.g?(ne(yt,yt.u+jr.g),ar[Gt]=jr.value,yt=0):(ne(yt,yt.u+jr.g-256),e(256<=jr.value),yt=jr.value),yt==0&&(Tt=!0)}else yt=Pt(pt.G[0],pt.H[0],Ee);if(Ee.h)break;if(Tt||256>yt){if(!Tt)if(pt.nd)N[Ze]=(pt.qb|yt<<8)>>>0;else{if(se(Ee),Tt=Pt(pt.G[1],pt.H[1],Ee),se(Ee),ar=Pt(pt.G[2],pt.H[2],Ee),Gt=Pt(pt.G[3],pt.H[3],Ee),Ee.h)break;N[Ze]=(Gt<<24|Tt<<16|yt<<8|ar)>>>0}if(Tt=!1,++Ze,++ye>=H&&(ye=0,++he,ce!=null&&he<=oe&&!(he%16)&&ce(y,he),Ye!=null))for(;ke<Ze;)yt=N[ke++],Ye.X[(506832829*yt&4294967295)>>>Ye.Mb]=yt}else if(280>yt){if(yt=Ra(yt-256,Ee),ar=Pt(pt.G[4],pt.H[4],Ee),se(Ee),ar=nn(H,ar=Ra(ar,Ee)),Ee.h)break;if(Ze-P<ar||re-Ze<yt)break e;for(Gt=0;Gt<yt;++Gt)N[Ze+Gt]=N[Ze+Gt-ar];for(Ze+=yt,ye+=yt;ye>=H;)ye-=H,++he,ce!=null&&he<=oe&&!(he%16)&&ce(y,he);if(e(Ze<=re),ye&ut&&(pt=ae(Le,ye,he)),Ye!=null)for(;ke<Ze;)yt=N[ke++],Ye.X[(506832829*yt&4294967295)>>>Ye.Mb]=yt}else{if(!(yt<We))break e;for(Tt=yt-280,e(Ye!=null);ke<Ze;)yt=N[ke++],Ye.X[(506832829*yt&4294967295)>>>Ye.Mb]=yt;yt=Ze,e(!(Tt>>>(ar=Ye).Xa)),N[yt]=ar.X[Tt],Tt=!0}Tt||e(Ee.h==z(Ee))}if(y.Pb&&Ee.h&&Ze<re)e(y.m.h),y.a=5,y.m=y.wd,y.$=y.xd,0<y.s.ua&&ot(y.s.vb,y.s.Wa);else{if(Ee.h)break e;ce?.(y,he>oe?oe:he),y.a=0,y.$=Ze-P}return 1}return y.a=3,0}function lt(y){e(y!=null),y.vc=null,y.yc=null,y.Ya=null;var N=y.Wa;N!=null&&(N.X=null),y.vb=null,e(y!=null)}function Xe(){var y=new _r;return y==null?null:(y.a=0,y.xb=Eh,Ue("Predictor","VP8LPredictors"),Ue("Predictor","VP8LPredictors_C"),Ue("PredictorAdd","VP8LPredictorsAdd"),Ue("PredictorAdd","VP8LPredictorsAdd_C"),Ja=$t,Fc=Ce,Lc=Dt,Ro=At,Do=Ct,Ji=Te,Bl=Ve,L.VP8LMapColor32b=Xi,L.VP8LMapColor8b=zn,y)}function Ke(y,N,P,H,re){var oe=1,ce=[y],he=[N],ye=H.m,Ee=H.s,Le=null,Ze=0;e:for(;;){if(P)for(;oe&&U(ye,1);){var ke=ce,Me=he,We=H,dt=1,Ye=We.m,ut=We.gc[We.ab],pt=U(Ye,2);if(We.Oc&1<<pt)oe=0;else{switch(We.Oc|=1<<pt,ut.hc=pt,ut.Ea=ke[0],ut.nc=Me[0],ut.K=[null],++We.ab,e(4>=We.ab),pt){case 0:case 1:ut.b=U(Ye,3)+2,dt=Ke(Be(ut.Ea,ut.b),Be(ut.nc,ut.b),0,We,ut.K),ut.K=ut.K[0];break;case 3:var Tt,yt=U(Ye,8)+1,ar=16<yt?0:4<yt?1:2<yt?2:3;if(ke[0]=Be(ut.Ea,ar),ut.b=ar,Tt=dt=Ke(yt,1,0,We,ut.K)){var Gt,jr=yt,Qt=ut,Br=1<<(8>>Qt.b),Ca=s(Br);if(Ca==null)Tt=0;else{var Ar=Qt.K[0],Yt=Qt.w;for(Ca[0]=Qt.K[0][0],Gt=1;Gt<1*jr;++Gt)Ca[Gt]=jt(Ar[Yt+Gt],Ca[Gt-1]);for(;Gt<4*Br;++Gt)Ca[Gt]=0;Qt.K[0]=null,Qt.K[0]=Ca,Tt=1}}dt=Tt;break;case 2:break;default:e(0)}oe=dt}}if(ce=ce[0],he=he[0],oe&&U(ye,1)&&!(oe=1<=(Ze=U(ye,4))&&11>=Ze)){H.a=3;break e}var Bt;if(Bt=oe)t:{var Pa,xr,Or,la=H,bn=ce,Gn=he,wa=Ze,ln=P,ts=la.m,cn=la.s,Lr=[null],Kr=1,Ma=0,ta=ri[wa];r:for(;;){if(ln&&U(ts,1)){var wn=U(ts,3)+2,Ia=Be(bn,wn),Jr=Be(Gn,wn),en=Ia*Jr;if(!Ke(Ia,Jr,0,la,Lr))break r;for(Lr=Lr[0],cn.xc=wn,Pa=0;Pa<en;++Pa){var ca=Lr[Pa]>>8&65535;Lr[Pa]=ca,ca>=Kr&&(Kr=ca+1)}}if(ts.h)break r;for(xr=0;5>xr;++xr){var un=Hl[xr];!xr&&0<wa&&(un+=1<<wa),Ma<un&&(Ma=un)}var dn=l(Kr*ta,M),ha=Kr,Yr=l(ha,ie);if(Yr==null)var rs=null;else e(65536>=ha),rs=Yr;var Va=s(Ma);if(rs==null||Va==null||dn==null){la.a=1;break r}var fr=dn;for(Pa=Or=0;Pa<Kr;++Pa){var hr=rs[Pa],Zr=hr.G,Ns=hr.H,ii=0,ms=1,fn=0;for(xr=0;5>xr;++xr){un=Hl[xr],Zr[xr]=fr,Ns[xr]=Or,!xr&&0<wa&&(un+=1<<wa);n:{var pl,gl=un,uf=la,Sa=Va,Ch=fr,Th=Or,df=0,Mo=uf.m,P1=U(Mo,1);if(n(Sa,0,0,gl),P1){var Oh=U(Mo,1)+1,Rh=U(Mo,1),ff=U(Mo,Rh==0?1:8);Sa[ff]=1,Oh==2&&(Sa[ff=U(Mo,8)]=1);var Dn=1}else{var Ga=s(19),Ku=U(Mo,4)+4;if(19<Ku){uf.a=3;var vl=0;break n}for(pl=0;pl<Ku;++pl)Ga[Gu[pl]]=U(Mo,3);var zc=void 0,Vl=void 0,eo=uf,hf=Ga,Hc=gl,mf=Sa,pf=0,Io=eo.m,Dh=8,Fh=l(128,M);a:for(;T(Fh,0,7,hf,19);){if(U(Io,1)){var pm=2+2*U(Io,3);if((zc=2+U(Io,pm))>Hc)break a}else zc=Hc;for(Vl=0;Vl<Hc&&zc--;){se(Io);var Lh=Fh[0+(127&I(Io))];ne(Io,Io.u+Lh.g);var xl=Lh.value;if(16>xl)mf[Vl++]=xl,xl!=0&&(Dh=xl);else{var gm=xl==16,vm=xl-16,xm=Ic[vm],Ph=U(Io,ei[vm])+xm;if(Vl+Ph>Hc)break a;for(var ym=gm?Dh:0;0<Ph--;)mf[Vl++]=ym}}pf=1;break a}pf||(eo.a=3),Dn=pf}(Dn=Dn&&!Mo.h)&&(df=T(Ch,Th,8,Sa,gl)),Dn&&df!=0?vl=df:(uf.a=3,vl=0)}if(vl==0)break r;if(ms&&af[xr]==1&&(ms=fr[Or].g==0),ii+=fr[Or].g,Or+=vl,3>=xr){var Gl,gf=Va[0];for(Gl=1;Gl<un;++Gl)Va[Gl]>gf&&(gf=Va[Gl]);fn+=gf}}if(hr.nd=ms,hr.Qb=0,ms&&(hr.qb=(Zr[3][Ns[3]+0].value<<24|Zr[1][Ns[1]+0].value<<16|Zr[2][Ns[2]+0].value)>>>0,ii==0&&256>Zr[0][Ns[0]+0].value&&(hr.Qb=1,hr.qb+=Zr[0][Ns[0]+0].value<<8)),hr.jc=!hr.Qb&&6>fn,hr.jc){var Ju,to=hr;for(Ju=0;Ju<ol;++Ju){var Bo=Ju,Uo=to.pd[Bo],vf=to.G[0][to.H[0]+Bo];256<=vf.value?(Uo.g=vf.g+256,Uo.value=vf.value):(Uo.g=0,Uo.value=0,Bo>>=Zt(vf,8,Uo),Bo>>=Zt(to.G[1][to.H[1]+Bo],16,Uo),Bo>>=Zt(to.G[2][to.H[2]+Bo],0,Uo),Zt(to.G[3][to.H[3]+Bo],24,Uo))}}}cn.vc=Lr,cn.Wb=Kr,cn.Ya=rs,cn.yc=dn,Bt=1;break t}Bt=0}if(!(oe=Bt)){H.a=3;break e}if(0<Ze){if(Ee.ua=1<<Ze,!ue(Ee.Wa,Ze)){H.a=1,oe=0;break e}}else Ee.ua=0;var xf=H,Yl=ce,_m=he,$c=xf.s,Wc=$c.xc;if(xf.c=Yl,xf.i=_m,$c.md=Be(Yl,Wc),$c.wc=Wc==0?-1:(1<<Wc)-1,P){H.xb=ul;break e}if((Le=s(ce*he))==null){H.a=1,oe=0;break e}oe=(oe=$e(H,Le,0,ce,he,he,null))&&!ye.h;break e}return oe?(re!=null?re[0]=Le:(e(Le==null),e(P)),H.$=0,P||lt(Ee)):lt(Ee),oe}function Qe(y,N){var P=y.c*y.i,H=P+N+16*N;return e(y.c<=N),y.V=s(H),y.V==null?(y.Ta=null,y.Ua=0,y.a=1,0):(y.Ta=y.V,y.Ua=y.Ba+P+N,1)}function Et(y,N){var P=y.C,H=N-P,re=y.V,oe=y.Ba+y.c*P;for(e(N<=y.l.o);0<H;){var ce=16<H?16:H,he=y.l.ma,ye=y.l.width,Ee=ye*ce,Le=he.ca,Ze=he.tb+ye*P,ke=y.Ta,Me=y.Ua;be(y,ce,re,oe),$s(ke,Me,Le,Ze,Ee),Se(he,P,P+ce,Le,Ze,ye),H-=ce,re+=ce*y.c,P+=ce}e(P==N),y.C=y.Ma=N}function Rt(){this.ub=this.yd=this.td=this.Rb=0}function qt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ot(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Mt(){this.Yb=(function(){var y=[];return(function N(P,H,re){for(var oe=re[H],ce=0;ce<oe&&(P.push(re.length>H+1?[]:0),!(re.length<H+1));ce++)N(P[ce],H+1,re)})(y,0,[3,11]),y})()}function Jt(){this.jb=s(3),this.Wc=c([4,8],Mt),this.Xc=c([4,17],Mt)}function oa(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Mr(){this.ld=this.La=this.dd=this.tc=0}function da(){this.Na=this.la=0}function ls(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function gi(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function vi(){this.uc=this.M=this.Nb=0,this.wa=Array(new Mr),this.Y=0,this.ya=Array(new gi),this.aa=0,this.l=new vo}function Bs(){this.y=s(16),this.f=s(8),this.ea=s(8)}function rl(){this.cb=this.a=0,this.sc="",this.m=new j,this.Od=new Rt,this.Kc=new qt,this.ed=new oa,this.Qa=new Ot,this.Ic=this.$c=this.Aa=0,this.D=new vi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,j),this.ia=0,this.pb=l(4,ls),this.Pa=new Jt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Bs),this.Hd=0,this.rb=Array(new da),this.sb=0,this.wa=Array(new Mr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new gi),this.L=this.aa=0,this.gd=c([4,2],Mr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Fa(y,N){return 0>y?0:y>N?N:y}function vo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function xi(){var y=new rl;return y!=null&&(y.a=0,y.sc="OK",y.cb=0,y.Xb=0,Ws||(Ws=al)),y}function Qr(y,N,P){return y.a==0&&(y.a=N,y.sc=P,y.cb=0),0}function Eu(y,N,P){return 3<=P&&y[N+0]==157&&y[N+1]==1&&y[N+2]==42}function zi(y,N){if(y==null)return 0;if(y.a=0,y.sc="OK",N==null)return Qr(y,2,"null VP8Io passed to VP8GetHeaders()");var P=N.data,H=N.w,re=N.ha;if(4>re)return Qr(y,7,"Truncated header.");var oe=P[H+0]|P[H+1]<<8|P[H+2]<<16,ce=y.Od;if(ce.Rb=!(1&oe),ce.td=oe>>1&7,ce.yd=oe>>4&1,ce.ub=oe>>5,3<ce.td)return Qr(y,3,"Incorrect keyframe parameters.");if(!ce.yd)return Qr(y,4,"Frame not displayable.");H+=3,re-=3;var he=y.Kc;if(ce.Rb){if(7>re)return Qr(y,7,"cannot parse picture header");if(!Eu(P,H,re))return Qr(y,3,"Bad code word");he.c=16383&(P[H+4]<<8|P[H+3]),he.Td=P[H+4]>>6,he.i=16383&(P[H+6]<<8|P[H+5]),he.Ud=P[H+6]>>6,H+=7,re-=7,y.za=he.c+15>>4,y.Ub=he.i+15>>4,N.width=he.c,N.height=he.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,n((oe=y.Pa).jb,0,255,oe.jb.length),e((oe=y.Qa)!=null),oe.Cb=0,oe.Bb=0,oe.Fb=1,n(oe.Zb,0,0,oe.Zb.length),n(oe.Lb,0,0,oe.Lb)}if(ce.ub>re)return Qr(y,7,"bad partition length");X(oe=y.m,P,H,ce.ub),H+=ce.ub,re-=ce.ub,ce.Rb&&(he.Ld=Ne(oe),he.Kd=Ne(oe)),he=y.Qa;var ye,Ee=y.Pa;if(e(oe!=null),e(he!=null),he.Cb=Ne(oe),he.Cb){if(he.Bb=Ne(oe),Ne(oe)){for(he.Fb=Ne(oe),ye=0;4>ye;++ye)he.Zb[ye]=Ne(oe)?K(oe,7):0;for(ye=0;4>ye;++ye)he.Lb[ye]=Ne(oe)?K(oe,6):0}if(he.Bb)for(ye=0;3>ye;++ye)Ee.jb[ye]=Ne(oe)?J(oe,8):255}else he.Bb=0;if(oe.Ka)return Qr(y,3,"cannot parse segment header");if((he=y.ed).zd=Ne(oe),he.Tb=J(oe,6),he.wb=J(oe,3),he.Pc=Ne(oe),he.Pc&&Ne(oe)){for(Ee=0;4>Ee;++Ee)Ne(oe)&&(he.vd[Ee]=K(oe,6));for(Ee=0;4>Ee;++Ee)Ne(oe)&&(he.od[Ee]=K(oe,6))}if(y.L=he.Tb==0?0:he.zd?1:2,oe.Ka)return Qr(y,3,"cannot parse filter header");var Le=re;if(re=ye=H,H=ye+Le,he=Le,y.Xb=(1<<J(y.m,2))-1,Le<3*(Ee=y.Xb))P=7;else{for(ye+=3*Ee,he-=3*Ee,Le=0;Le<Ee;++Le){var Ze=P[re+0]|P[re+1]<<8|P[re+2]<<16;Ze>he&&(Ze=he),X(y.Jc[+Le],P,ye,Ze),ye+=Ze,he-=Ze,re+=3}X(y.Jc[+Ee],P,ye,he),P=ye<H?0:5}if(P!=0)return Qr(y,P,"cannot parse partitions");for(P=J(ye=y.m,7),re=Ne(ye)?K(ye,4):0,H=Ne(ye)?K(ye,4):0,he=Ne(ye)?K(ye,4):0,Ee=Ne(ye)?K(ye,4):0,ye=Ne(ye)?K(ye,4):0,Le=y.Qa,Ze=0;4>Ze;++Ze){if(Le.Cb){var ke=Le.Zb[Ze];Le.Fb||(ke+=P)}else{if(0<Ze){y.pb[Ze]=y.pb[0];continue}ke=P}var Me=y.pb[Ze];Me.Sc[0]=ai[Fa(ke+re,127)],Me.Sc[1]=ni[Fa(ke+0,127)],Me.Eb[0]=2*ai[Fa(ke+H,127)],Me.Eb[1]=101581*ni[Fa(ke+he,127)]>>16,8>Me.Eb[1]&&(Me.Eb[1]=8),Me.Qc[0]=ai[Fa(ke+Ee,117)],Me.Qc[1]=ni[Fa(ke+ye,127)],Me.lc=ke+ye}if(!ce.Rb)return Qr(y,4,"Not a key frame.");for(Ne(oe),ce=y.Pa,P=0;4>P;++P){for(re=0;8>re;++re)for(H=0;3>H;++H)for(he=0;11>he;++he)Ee=ge(oe,Aa[P][re][H][he])?J(oe,8):hm[P][re][H][he],ce.Wc[P][re].Yb[H][he]=Ee;for(re=0;17>re;++re)ce.Xc[P][re]=ce.Wc[P][qr[re]]}return y.kc=Ne(oe),y.kc&&(y.Bd=J(oe,8)),y.cb=1}function al(y,N,P,H,re,oe,ce){var he=N[re].Yb[P];for(P=0;16>re;++re){if(!ge(y,he[P+0]))return re;for(;!ge(y,he[P+1]);)if(he=N[++re].Yb[0],P=0,re==16)return 16;var ye=N[re+1].Yb;if(ge(y,he[P+2])){var Ee=y,Le=0;if(ge(Ee,(ke=he)[(Ze=P)+3]))if(ge(Ee,ke[Ze+6])){for(he=0,Ze=2*(Le=ge(Ee,ke[Ze+8]))+(ke=ge(Ee,ke[Ze+9+Le])),Le=0,ke=fm[Ze];ke[he];++he)Le+=Le+ge(Ee,ke[he]);Le+=3+(8<<Ze)}else ge(Ee,ke[Ze+7])?(Le=7+2*ge(Ee,165),Le+=ge(Ee,145)):Le=5+ge(Ee,159);else Le=ge(Ee,ke[Ze+4])?3+ge(Ee,ke[Ze+5]):2;he=ye[2]}else Le=1,he=ye[1];ye=ce+kh[re],0>(Ee=y).b&&je(Ee);var Ze,ke=Ee.b,Me=(Ze=Ee.Ca>>1)-(Ee.I>>ke)>>31;--Ee.b,Ee.Ca+=Me,Ee.Ca|=1,Ee.I-=(Ze+1&Me)<<ke,oe[ye]=((Le^Me)-Me)*H[(0<re)+0]}return 16}function Au(y){var N=y.rb[y.sb-1];N.la=0,N.Na=0,n(y.zc,0,0,y.zc.length),y.ja=0}function cs(y,N,P,H,re){re=y[N+P+32*H]+(re>>3),y[N+P+32*H]=-256&re?0>re?0:255:re}function yn(y,N,P,H,re,oe){cs(y,N,0,P,H+re),cs(y,N,1,P,H+oe),cs(y,N,2,P,H-oe),cs(y,N,3,P,H-re)}function sn(y){return(20091*y>>16)+y}function jc(y,N,P,H){var re,oe=0,ce=s(16);for(re=0;4>re;++re){var he=y[N+0]+y[N+8],ye=y[N+0]-y[N+8],Ee=(35468*y[N+4]>>16)-sn(y[N+12]),Le=sn(y[N+4])+(35468*y[N+12]>>16);ce[oe+0]=he+Le,ce[oe+1]=ye+Ee,ce[oe+2]=ye-Ee,ce[oe+3]=he-Le,oe+=4,N++}for(re=oe=0;4>re;++re)he=(y=ce[oe+0]+4)+ce[oe+8],ye=y-ce[oe+8],Ee=(35468*ce[oe+4]>>16)-sn(ce[oe+12]),cs(P,H,0,0,he+(Le=sn(ce[oe+4])+(35468*ce[oe+12]>>16))),cs(P,H,1,0,ye+Ee),cs(P,H,2,0,ye-Ee),cs(P,H,3,0,he-Le),oe++,H+=32}function qd(y,N,P,H){var re=y[N+0]+4,oe=35468*y[N+4]>>16,ce=sn(y[N+4]),he=35468*y[N+1]>>16;yn(P,H,0,re+ce,y=sn(y[N+1]),he),yn(P,H,1,re+oe,y,he),yn(P,H,2,re-oe,y,he),yn(P,H,3,re-ce,y,he)}function Cu(y,N,P,H,re){jc(y,N,P,H),re&&jc(y,N+16,P,H+4)}function us(y,N,P,H){Fo(y,N+0,P,H,1),Fo(y,N+32,P,H+128,1)}function Tu(y,N,P,H){var re;for(y=y[N+0]+4,re=0;4>re;++re)for(N=0;4>N;++N)cs(P,H,N,re,y)}function Ou(y,N,P,H){y[N+0]&&ea(y,N+0,P,H),y[N+16]&&ea(y,N+16,P,H+4),y[N+32]&&ea(y,N+32,P,H+128),y[N+48]&&ea(y,N+48,P,H+128+4)}function yi(y,N,P,H){var re,oe=s(16);for(re=0;4>re;++re){var ce=y[N+0+re]+y[N+12+re],he=y[N+4+re]+y[N+8+re],ye=y[N+4+re]-y[N+8+re],Ee=y[N+0+re]-y[N+12+re];oe[0+re]=ce+he,oe[8+re]=ce-he,oe[4+re]=Ee+ye,oe[12+re]=Ee-ye}for(re=0;4>re;++re)ce=(y=oe[0+4*re]+3)+oe[3+4*re],he=oe[1+4*re]+oe[2+4*re],ye=oe[1+4*re]-oe[2+4*re],Ee=y-oe[3+4*re],P[H+0]=ce+he>>3,P[H+16]=Ee+ye>>3,P[H+32]=ce-he>>3,P[H+48]=Ee-ye>>3,H+=64}function Rl(y,N,P){var H,re=N-32,oe=Qn,ce=255-y[re-1];for(H=0;H<P;++H){var he,ye=oe,Ee=ce+y[N-1];for(he=0;he<P;++he)y[N+he]=ye[Ee+y[re+he]];N+=32}}function zd(y,N){Rl(y,N,4)}function Hd(y,N){Rl(y,N,8)}function Ru(y,N){Rl(y,N,16)}function Du(y,N){var P;for(P=0;16>P;++P)a(y,N+32*P,y,N-32,16)}function $d(y,N){var P;for(P=16;0<P;--P)n(y,N,y[N-1],16),N+=32}function ws(y,N,P){var H;for(H=0;16>H;++H)n(N,P+32*H,y,16)}function _i(y,N){var P,H=16;for(P=0;16>P;++P)H+=y[N-1+32*P]+y[N+P-32];ws(H>>5,y,N)}function xo(y,N){var P,H=8;for(P=0;16>P;++P)H+=y[N-1+32*P];ws(H>>4,y,N)}function Dl(y,N){var P,H=8;for(P=0;16>P;++P)H+=y[N+P-32];ws(H>>4,y,N)}function nl(y,N){ws(128,y,N)}function vr(y,N,P){return y+2*N+P+2>>2}function Wd(y,N){var P,H=N-32;for(H=new Uint8Array([vr(y[H-1],y[H+0],y[H+1]),vr(y[H+0],y[H+1],y[H+2]),vr(y[H+1],y[H+2],y[H+3]),vr(y[H+2],y[H+3],y[H+4])]),P=0;4>P;++P)a(y,N+32*P,H,0,H.length)}function Fu(y,N){var P=y[N-1],H=y[N-1+32],re=y[N-1+64],oe=y[N-1+96];Ie(y,N+0,16843009*vr(y[N-1-32],P,H)),Ie(y,N+32,16843009*vr(P,H,re)),Ie(y,N+64,16843009*vr(H,re,oe)),Ie(y,N+96,16843009*vr(re,oe,oe))}function Vd(y,N){var P,H=4;for(P=0;4>P;++P)H+=y[N+P-32]+y[N-1+32*P];for(H>>=3,P=0;4>P;++P)n(y,N+32*P,H,4)}function Us(y,N){var P=y[N-1+0],H=y[N-1+32],re=y[N-1+64],oe=y[N-1-32],ce=y[N+0-32],he=y[N+1-32],ye=y[N+2-32],Ee=y[N+3-32];y[N+0+96]=vr(H,re,y[N-1+96]),y[N+1+96]=y[N+0+64]=vr(P,H,re),y[N+2+96]=y[N+1+64]=y[N+0+32]=vr(oe,P,H),y[N+3+96]=y[N+2+64]=y[N+1+32]=y[N+0+0]=vr(ce,oe,P),y[N+3+64]=y[N+2+32]=y[N+1+0]=vr(he,ce,oe),y[N+3+32]=y[N+2+0]=vr(ye,he,ce),y[N+3+0]=vr(Ee,ye,he)}function Un(y,N){var P=y[N+1-32],H=y[N+2-32],re=y[N+3-32],oe=y[N+4-32],ce=y[N+5-32],he=y[N+6-32],ye=y[N+7-32];y[N+0+0]=vr(y[N+0-32],P,H),y[N+1+0]=y[N+0+32]=vr(P,H,re),y[N+2+0]=y[N+1+32]=y[N+0+64]=vr(H,re,oe),y[N+3+0]=y[N+2+32]=y[N+1+64]=y[N+0+96]=vr(re,oe,ce),y[N+3+32]=y[N+2+64]=y[N+1+96]=vr(oe,ce,he),y[N+3+64]=y[N+2+96]=vr(ce,he,ye),y[N+3+96]=vr(he,ye,ye)}function Lu(y,N){var P=y[N-1+0],H=y[N-1+32],re=y[N-1+64],oe=y[N-1-32],ce=y[N+0-32],he=y[N+1-32],ye=y[N+2-32],Ee=y[N+3-32];y[N+0+0]=y[N+1+64]=oe+ce+1>>1,y[N+1+0]=y[N+2+64]=ce+he+1>>1,y[N+2+0]=y[N+3+64]=he+ye+1>>1,y[N+3+0]=ye+Ee+1>>1,y[N+0+96]=vr(re,H,P),y[N+0+64]=vr(H,P,oe),y[N+0+32]=y[N+1+96]=vr(P,oe,ce),y[N+1+32]=y[N+2+96]=vr(oe,ce,he),y[N+2+32]=y[N+3+96]=vr(ce,he,ye),y[N+3+32]=vr(he,ye,Ee)}function Fl(y,N){var P=y[N+0-32],H=y[N+1-32],re=y[N+2-32],oe=y[N+3-32],ce=y[N+4-32],he=y[N+5-32],ye=y[N+6-32],Ee=y[N+7-32];y[N+0+0]=P+H+1>>1,y[N+1+0]=y[N+0+64]=H+re+1>>1,y[N+2+0]=y[N+1+64]=re+oe+1>>1,y[N+3+0]=y[N+2+64]=oe+ce+1>>1,y[N+0+32]=vr(P,H,re),y[N+1+32]=y[N+0+96]=vr(H,re,oe),y[N+2+32]=y[N+1+96]=vr(re,oe,ce),y[N+3+32]=y[N+2+96]=vr(oe,ce,he),y[N+3+64]=vr(ce,he,ye),y[N+3+96]=vr(he,ye,Ee)}function qs(y,N){var P=y[N-1+0],H=y[N-1+32],re=y[N-1+64],oe=y[N-1+96];y[N+0+0]=P+H+1>>1,y[N+2+0]=y[N+0+32]=H+re+1>>1,y[N+2+32]=y[N+0+64]=re+oe+1>>1,y[N+1+0]=vr(P,H,re),y[N+3+0]=y[N+1+32]=vr(H,re,oe),y[N+3+32]=y[N+1+64]=vr(re,oe,oe),y[N+3+64]=y[N+2+64]=y[N+0+96]=y[N+1+96]=y[N+2+96]=y[N+3+96]=oe}function Ll(y,N){var P=y[N-1+0],H=y[N-1+32],re=y[N-1+64],oe=y[N-1+96],ce=y[N-1-32],he=y[N+0-32],ye=y[N+1-32],Ee=y[N+2-32];y[N+0+0]=y[N+2+32]=P+ce+1>>1,y[N+0+32]=y[N+2+64]=H+P+1>>1,y[N+0+64]=y[N+2+96]=re+H+1>>1,y[N+0+96]=oe+re+1>>1,y[N+3+0]=vr(he,ye,Ee),y[N+2+0]=vr(ce,he,ye),y[N+1+0]=y[N+3+32]=vr(P,ce,he),y[N+1+32]=y[N+3+64]=vr(H,P,ce),y[N+1+64]=y[N+3+96]=vr(re,H,P),y[N+1+96]=vr(oe,re,H)}function Hi(y,N){var P;for(P=0;8>P;++P)a(y,N+32*P,y,N-32,8)}function Gd(y,N){var P;for(P=0;8>P;++P)n(y,N,y[N-1],8),N+=32}function Xs(y,N,P){var H;for(H=0;8>H;++H)n(N,P+32*H,y,8)}function kc(y,N){var P,H=8;for(P=0;8>P;++P)H+=y[N+P-32]+y[N-1+32*P];Xs(H>>4,y,N)}function Ec(y,N){var P,H=4;for(P=0;8>P;++P)H+=y[N+P-32];Xs(H>>3,y,N)}function On(y,N){var P,H=4;for(P=0;8>P;++P)H+=y[N-1+32*P];Xs(H>>3,y,N)}function $i(y,N){Xs(128,y,N)}function Ks(y,N,P){var H=y[N-P],re=y[N+0],oe=3*(re-H)+Lo[1020+y[N-2*P]-y[N+P]],ce=$u[112+(oe+4>>3)];y[N-P]=Qn[255+H+$u[112+(oe+3>>3)]],y[N+0]=Qn[255+re-ce]}function yo(y,N,P,H){var re=y[N+0],oe=y[N+P];return Hn[255+y[N-2*P]-y[N-P]]>H||Hn[255+oe-re]>H}function Ac(y,N,P,H){return 4*Hn[255+y[N-P]-y[N+0]]+Hn[255+y[N-2*P]-y[N+P]]<=H}function Pl(y,N,P,H,re){var oe=y[N-3*P],ce=y[N-2*P],he=y[N-P],ye=y[N+0],Ee=y[N+P],Le=y[N+2*P],Ze=y[N+3*P];return 4*Hn[255+he-ye]+Hn[255+ce-Ee]>H?0:Hn[255+y[N-4*P]-oe]<=re&&Hn[255+oe-ce]<=re&&Hn[255+ce-he]<=re&&Hn[255+Ze-Le]<=re&&Hn[255+Le-Ee]<=re&&Hn[255+Ee-ye]<=re}function _o(y,N,P,H){var re=2*H+1;for(H=0;16>H;++H)Ac(y,N+H,P,re)&&Ks(y,N+H,P)}function bo(y,N,P,H){var re=2*H+1;for(H=0;16>H;++H)Ac(y,N+H*P,1,re)&&Ks(y,N+H*P,1)}function Ml(y,N,P,H){var re;for(re=3;0<re;--re)_o(y,N+=4*P,P,H)}function Pu(y,N,P,H){var re;for(re=3;0<re;--re)bo(y,N+=4,P,H)}function wo(y,N,P,H,re,oe,ce,he){for(oe=2*oe+1;0<re--;){if(Pl(y,N,P,oe,ce))if(yo(y,N,P,he))Ks(y,N,P);else{var ye=y,Ee=N,Le=P,Ze=ye[Ee-2*Le],ke=ye[Ee-Le],Me=ye[Ee+0],We=ye[Ee+Le],dt=ye[Ee+2*Le],Ye=27*(pt=Lo[1020+3*(Me-ke)+Lo[1020+Ze-We]])+63>>7,ut=18*pt+63>>7,pt=9*pt+63>>7;ye[Ee-3*Le]=Qn[255+ye[Ee-3*Le]+pt],ye[Ee-2*Le]=Qn[255+Ze+ut],ye[Ee-Le]=Qn[255+ke+Ye],ye[Ee+0]=Qn[255+Me-Ye],ye[Ee+Le]=Qn[255+We-ut],ye[Ee+2*Le]=Qn[255+dt-pt]}N+=H}}function So(y,N,P,H,re,oe,ce,he){for(oe=2*oe+1;0<re--;){if(Pl(y,N,P,oe,ce))if(yo(y,N,P,he))Ks(y,N,P);else{var ye=y,Ee=N,Le=P,Ze=ye[Ee-Le],ke=ye[Ee+0],Me=ye[Ee+Le],We=$u[112+(4+(dt=3*(ke-Ze))>>3)],dt=$u[112+(dt+3>>3)],Ye=We+1>>1;ye[Ee-2*Le]=Qn[255+ye[Ee-2*Le]+Ye],ye[Ee-Le]=Qn[255+Ze+dt],ye[Ee+0]=Qn[255+ke-We],ye[Ee+Le]=Qn[255+Me-Ye]}N+=H}}function Yd(y,N,P,H,re,oe){wo(y,N,P,1,16,H,re,oe)}function No(y,N,P,H,re,oe){wo(y,N,1,P,16,H,re,oe)}function Xd(y,N,P,H,re,oe){var ce;for(ce=3;0<ce;--ce)So(y,N+=4*P,P,1,16,H,re,oe)}function R(y,N,P,H,re,oe){var ce;for(ce=3;0<ce;--ce)So(y,N+=4,1,P,16,H,re,oe)}function Q(y,N,P,H,re,oe,ce,he){wo(y,N,re,1,8,oe,ce,he),wo(P,H,re,1,8,oe,ce,he)}function Ae(y,N,P,H,re,oe,ce,he){wo(y,N,1,re,8,oe,ce,he),wo(P,H,1,re,8,oe,ce,he)}function Re(y,N,P,H,re,oe,ce,he){So(y,N+4*re,re,1,8,oe,ce,he),So(P,H+4*re,re,1,8,oe,ce,he)}function ze(y,N,P,H,re,oe,ce,he){So(y,N+4,1,re,8,oe,ce,he),So(P,H+4,1,re,8,oe,ce,he)}function mt(){this.ba=new Vt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new kt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function _t(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function er(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function or(){this.ua=0,this.Wa=new xe,this.vb=new xe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ie,this.yc=new M}function _r(){this.xb=this.a=0,this.l=new vo,this.ca=new Vt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new F,this.Pb=0,this.wd=new F,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new or,this.ab=0,this.gc=l(4,er),this.Oc=0}function Er(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new vo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Vr(y,N,P,H,re,oe,ce){for(y=y==null?0:y[N+0],N=0;N<ce;++N)re[oe+N]=y+P[H+N]&255,y=re[oe+N]}function La(y,N,P,H,re,oe,ce){var he;if(y==null)Vr(null,null,P,H,re,oe,ce);else for(he=0;he<ce;++he)re[oe+he]=y[N+he]+P[H+he]&255}function Ka(y,N,P,H,re,oe,ce){if(y==null)Vr(null,null,P,H,re,oe,ce);else{var he,ye=y[N+0],Ee=ye,Le=ye;for(he=0;he<ce;++he)Ee=Le+(ye=y[N+he])-Ee,Le=P[H+he]+(-256&Ee?0>Ee?0:255:Ee)&255,Ee=ye,re[oe+he]=Le}}function _a(y,N,P,H){var re=N.width,oe=N.o;if(e(y!=null&&N!=null),0>P||0>=H||P+H>oe)return null;if(!y.Cc){if(y.ga==null){var ce;if(y.ga=new Er,(ce=y.ga==null)||(ce=N.width*N.o,e(y.Gb.length==0),y.Gb=s(ce),y.Uc=0,y.Gb==null?ce=0:(y.mb=y.Gb,y.nb=y.Uc,y.rc=null,ce=1),ce=!ce),!ce){ce=y.ga;var he=y.Fa,ye=y.P,Ee=y.qc,Le=y.mb,Ze=y.nb,ke=ye+1,Me=Ee-1,We=ce.l;if(e(he!=null&&Le!=null&&N!=null),Po[0]=null,Po[1]=Vr,Po[2]=La,Po[3]=Ka,ce.ca=Le,ce.tb=Ze,ce.c=N.width,ce.i=N.height,e(0<ce.c&&0<ce.i),1>=Ee)N=0;else if(ce.$a=3&he[ye+0],ce.Z=he[ye+0]>>2&3,ce.Lc=he[ye+0]>>4&3,ye=he[ye+0]>>6&3,0>ce.$a||1<ce.$a||4<=ce.Z||1<ce.Lc||ye)N=0;else if(We.put=ir,We.ac=fa,We.bc=Ea,We.ma=ce,We.width=N.width,We.height=N.height,We.Da=N.Da,We.v=N.v,We.va=N.va,We.j=N.j,We.o=N.o,ce.$a)e:{e(ce.$a==1),N=Xe();t:for(;;){if(N==null){N=0;break e}if(e(ce!=null),ce.mc=N,N.c=ce.c,N.i=ce.i,N.l=ce.l,N.l.ma=ce,N.l.width=ce.c,N.l.height=ce.i,N.a=0,te(N.m,he,ke,Me),!Ke(ce.c,ce.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&pe(N.s)?(ce.ic=1,he=N.c*N.i,N.Ta=null,N.Ua=0,N.V=s(he),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(ce.ic=0,N=Qe(N,ce.c)),!N))break t;N=1;break e}ce.mc=null,N=0}else N=Me>=ce.c*ce.i;ce=!N}if(ce)return null;y.ga.Lc!=1?y.Ga=0:H=oe-P}e(y.ga!=null),e(P+H<=oe);e:{if(N=(he=y.ga).c,oe=he.l.o,he.$a==0){if(ke=y.rc,Me=y.Vc,We=y.Fa,ye=y.P+1+P*N,Ee=y.mb,Le=y.nb+P*N,e(ye<=y.P+y.qc),he.Z!=0)for(e(Po[he.Z]!=null),ce=0;ce<H;++ce)Po[he.Z](ke,Me,We,ye,Ee,Le,N),ke=Ee,Me=Le,Le+=N,ye+=N;else for(ce=0;ce<H;++ce)a(Ee,Le,We,ye,N),ke=Ee,Me=Le,Le+=N,ye+=N;y.rc=ke,y.Vc=Me}else{if(e(he.mc!=null),N=P+H,e((ce=he.mc)!=null),e(N<=ce.i),ce.C>=N)N=1;else if(he.ic||bi(),he.ic){he=ce.V,ke=ce.Ba,Me=ce.c;var dt=ce.i,Ye=(We=1,ye=ce.$/Me,Ee=ce.$%Me,Le=ce.m,Ze=ce.s,ce.$),ut=Me*dt,pt=Me*N,Tt=Ze.wc,yt=Ye<pt?ae(Ze,Ee,ye):null;e(Ye<=ut),e(N<=dt),e(pe(Ze));t:for(;;){for(;!Le.h&&Ye<pt;){if(Ee&Tt||(yt=ae(Ze,Ee,ye)),e(yt!=null),se(Le),256>(dt=Pt(yt.G[0],yt.H[0],Le)))he[ke+Ye]=dt,++Ye,++Ee>=Me&&(Ee=0,++ye<=N&&!(ye%16)&&we(ce,ye));else{if(!(280>dt)){We=0;break t}dt=Ra(dt-256,Le);var ar,Gt=Pt(yt.G[4],yt.H[4],Le);if(se(Le),!(Ye>=(Gt=nn(Me,Gt=Ra(Gt,Le)))&&ut-Ye>=dt)){We=0;break t}for(ar=0;ar<dt;++ar)he[ke+Ye+ar]=he[ke+Ye+ar-Gt];for(Ye+=dt,Ee+=dt;Ee>=Me;)Ee-=Me,++ye<=N&&!(ye%16)&&we(ce,ye);Ye<pt&&Ee&Tt&&(yt=ae(Ze,Ee,ye))}e(Le.h==z(Le))}we(ce,ye>N?N:ye);break t}!We||Le.h&&Ye<ut?(We=0,ce.a=Le.h?5:3):ce.$=Ye,N=We}else N=$e(ce,ce.V,ce.Ba,ce.c,ce.i,N,Et);if(!N){H=0;break e}}P+H>=oe&&(y.Cc=1),H=1}if(!H)return null;if(y.Cc&&((H=y.ga)!=null&&(H.mc=null),y.ga=null,0<y.Ga))return alert("todo:WebPDequantizeLevels"),null}return y.nb+P*re}function _n(y,N,P,H,re,oe){for(;0<re--;){var ce,he=y,ye=N+(P?1:0),Ee=y,Le=N+(P?0:3);for(ce=0;ce<H;++ce){var Ze=Ee[Le+4*ce];Ze!=255&&(Ze*=32897,he[ye+4*ce+0]=he[ye+4*ce+0]*Ze>>23,he[ye+4*ce+1]=he[ye+4*ce+1]*Ze>>23,he[ye+4*ce+2]=he[ye+4*ce+2]*Ze>>23)}N+=oe}}function on(y,N,P,H,re){for(;0<H--;){var oe;for(oe=0;oe<P;++oe){var ce=y[N+2*oe+0],he=15&(Ee=y[N+2*oe+1]),ye=4369*he,Ee=(240&Ee|Ee>>4)*ye>>16;y[N+2*oe+0]=(240&ce|ce>>4)*ye>>16&240|(15&ce|ce<<4)*ye>>16>>4&15,y[N+2*oe+1]=240&Ee|he}N+=re}}function qn(y,N,P,H,re,oe,ce,he){var ye,Ee,Le=255;for(Ee=0;Ee<re;++Ee){for(ye=0;ye<H;++ye){var Ze=y[N+ye];oe[ce+4*ye]=Ze,Le&=Ze}N+=P,ce+=he}return Le!=255}function jo(y,N,P,H,re){var oe;for(oe=0;oe<re;++oe)P[H+oe]=y[N+oe]>>8}function bi(){ql=_n,Zs=on,qu=qn,$s=jo}function ko(y,N,P){L[y]=function(H,re,oe,ce,he,ye,Ee,Le,Ze,ke,Me,We,dt,Ye,ut,pt,Tt){var yt,ar=Tt-1>>1,Gt=he[ye+0]|Ee[Le+0]<<16,jr=Ze[ke+0]|Me[We+0]<<16;e(H!=null);var Qt=3*Gt+jr+131074>>2;for(N(H[re+0],255&Qt,Qt>>16,dt,Ye),oe!=null&&(Qt=3*jr+Gt+131074>>2,N(oe[ce+0],255&Qt,Qt>>16,ut,pt)),yt=1;yt<=ar;++yt){var Br=he[ye+yt]|Ee[Le+yt]<<16,Ca=Ze[ke+yt]|Me[We+yt]<<16,Ar=Gt+Br+jr+Ca+524296,Yt=Ar+2*(Br+jr)>>3;Qt=Yt+Gt>>1,Gt=(Ar=Ar+2*(Gt+Ca)>>3)+Br>>1,N(H[re+2*yt-1],255&Qt,Qt>>16,dt,Ye+(2*yt-1)*P),N(H[re+2*yt-0],255&Gt,Gt>>16,dt,Ye+(2*yt-0)*P),oe!=null&&(Qt=Ar+jr>>1,Gt=Yt+Ca>>1,N(oe[ce+2*yt-1],255&Qt,Qt>>16,ut,pt+(2*yt-1)*P),N(oe[ce+2*yt+0],255&Gt,Gt>>16,ut,pt+(2*yt+0)*P)),Gt=Br,jr=Ca}1&Tt||(Qt=3*Gt+jr+131074>>2,N(H[re+Tt-1],255&Qt,Qt>>16,dt,Ye+(Tt-1)*P),oe!=null&&(Qt=3*jr+Gt+131074>>2,N(oe[ce+Tt-1],255&Qt,Qt>>16,ut,pt+(Tt-1)*P)))}}function Mu(){Wn[Qd]=$l,Wn[es]=Bc,Wn[ef]=Ah,Wn[Qs]=sf,Wn[Wu]=dl,Wn[Pc]=Qi,Wn[ll]=fl,Wn[Vu]=Bc,Wn[tf]=sf,Wn[Mc]=dl,Wn[rf]=Qi}function Cc(y){return y&-16384?0>y?0:255:y>>of}function Wi(y,N){return Cc((19077*y>>8)+(26149*N>>8)-14234)}function wi(y,N,P){return Cc((19077*y>>8)-(6419*N>>8)-(13320*P>>8)+8708)}function Il(y,N){return Cc((19077*y>>8)+(33050*N>>8)-17685)}function Eo(y,N,P,H,re){H[re+0]=Wi(y,P),H[re+1]=wi(y,N,P),H[re+2]=Il(y,N)}function Rn(y,N,P,H,re){H[re+0]=Il(y,N),H[re+1]=wi(y,N,P),H[re+2]=Wi(y,P)}function sl(y,N,P,H,re){var oe=wi(y,N,P);N=oe<<3&224|Il(y,N)>>3,H[re+0]=248&Wi(y,P)|oe>>5,H[re+1]=N}function il(y,N,P,H,re){var oe=240&Il(y,N)|15;H[re+0]=240&Wi(y,P)|wi(y,N,P)>>4,H[re+1]=oe}function Tc(y,N,P,H,re){H[re+0]=255,Eo(y,N,P,H,re+1)}function Vi(y,N,P,H,re){Rn(y,N,P,H,re),H[re+3]=255}function ds(y,N,P,H,re){Eo(y,N,P,H,re),H[re+3]=255}function Ao(y,N,P){L[y]=function(H,re,oe,ce,he,ye,Ee,Le,Ze){for(var ke=Le+(-2&Ze)*P;Le!=ke;)N(H[re+0],oe[ce+0],he[ye+0],Ee,Le),N(H[re+1],oe[ce+0],he[ye+0],Ee,Le+P),re+=2,++ce,++ye,Le+=2*P;1&Ze&&N(H[re+0],oe[ce+0],he[ye+0],Ee,Le)}}function Oc(y,N,P){return P==0?y==0?N==0?6:5:N==0?4:0:P}function Iu(y,N,P,H,re){switch(y>>>30){case 3:Fo(N,P,H,re,0);break;case 2:Zn(N,P,H,re);break;case 1:ea(N,P,H,re)}}function zs(y,N){var P,H,re=N.M,oe=N.Nb,ce=y.oc,he=y.pc+40,ye=y.oc,Ee=y.pc+584,Le=y.oc,Ze=y.pc+600;for(P=0;16>P;++P)ce[he+32*P-1]=129;for(P=0;8>P;++P)ye[Ee+32*P-1]=129,Le[Ze+32*P-1]=129;for(0<re?ce[he-1-32]=ye[Ee-1-32]=Le[Ze-1-32]=129:(n(ce,he-32-1,127,21),n(ye,Ee-32-1,127,9),n(Le,Ze-32-1,127,9)),H=0;H<y.za;++H){var ke=N.ya[N.aa+H];if(0<H){for(P=-1;16>P;++P)a(ce,he+32*P-4,ce,he+32*P+12,4);for(P=-1;8>P;++P)a(ye,Ee+32*P-4,ye,Ee+32*P+4,4),a(Le,Ze+32*P-4,Le,Ze+32*P+4,4)}var Me=y.Gd,We=y.Hd+H,dt=ke.ad,Ye=ke.Hc;if(0<re&&(a(ce,he-32,Me[We].y,0,16),a(ye,Ee-32,Me[We].f,0,8),a(Le,Ze-32,Me[We].ea,0,8)),ke.Za){var ut=ce,pt=he-32+16;for(0<re&&(H>=y.za-1?n(ut,pt,Me[We].y[15],4):a(ut,pt,Me[We+1].y,0,4)),P=0;4>P;P++)ut[pt+128+P]=ut[pt+256+P]=ut[pt+384+P]=ut[pt+0+P];for(P=0;16>P;++P,Ye<<=2)ut=ce,pt=he+Qa[P],Wa[ke.Ob[P]](ut,pt),Iu(Ye,dt,16*+P,ut,pt)}else if(ut=Oc(H,re,ke.Ob[0]),hs[ut](ce,he),Ye!=0)for(P=0;16>P;++P,Ye<<=2)Iu(Ye,dt,16*+P,ce,he+Qa[P]);for(P=ke.Gc,ut=Oc(H,re,ke.Dd),ki[ut](ye,Ee),ki[ut](Le,Ze),Ye=dt,ut=ye,pt=Ee,255&(ke=0|P)&&(170&ke?Js(Ye,256,ut,pt):Gr(Ye,256,ut,pt)),ke=Le,Ye=Ze,255&(P>>=8)&&(170&P?Js(dt,320,ke,Ye):Gr(dt,320,ke,Ye)),re<y.Ub-1&&(a(Me[We].y,0,ce,he+480,16),a(Me[We].f,0,ye,Ee+224,8),a(Me[We].ea,0,Le,Ze+224,8)),P=8*oe*y.B,Me=y.sa,We=y.ta+16*H+16*oe*y.R,dt=y.qa,ke=y.ra+8*H+P,Ye=y.Ha,ut=y.Ia+8*H+P,P=0;16>P;++P)a(Me,We+P*y.R,ce,he+32*P,16);for(P=0;8>P;++P)a(dt,ke+P*y.B,ye,Ee+32*P,8),a(Ye,ut+P*y.B,Le,Ze+32*P,8)}}function Si(y,N,P,H,re,oe,ce,he,ye){var Ee=[0],Le=[0],Ze=0,ke=ye!=null?ye.kd:0,Me=ye??new _t;if(y==null||12>P)return 7;Me.data=y,Me.w=N,Me.ha=P,N=[N],P=[P],Me.gb=[Me.gb];e:{var We=N,dt=P,Ye=Me.gb;if(e(y!=null),e(dt!=null),e(Ye!=null),Ye[0]=0,12<=dt[0]&&!r(y,We[0],"RIFF")){if(r(y,We[0]+8,"WEBP")){Ye=3;break e}var ut=rt(y,We[0]+4);if(12>ut||4294967286<ut){Ye=3;break e}if(ke&&ut>dt[0]-8){Ye=7;break e}Ye[0]=ut,We[0]+=12,dt[0]-=12}Ye=0}if(Ye!=0)return Ye;for(ut=0<Me.gb[0],P=P[0];;){e:{var pt=y;dt=N,Ye=P;var Tt=Ee,yt=Le,ar=We=[0];if((Qt=Ze=[Ze])[0]=0,8>Ye[0])Ye=7;else{if(!r(pt,dt[0],"VP8X")){if(rt(pt,dt[0]+4)!=10){Ye=3;break e}if(18>Ye[0]){Ye=7;break e}var Gt=rt(pt,dt[0]+8),jr=1+Ge(pt,dt[0]+12);if(2147483648<=jr*(pt=1+Ge(pt,dt[0]+15))){Ye=3;break e}ar!=null&&(ar[0]=Gt),Tt!=null&&(Tt[0]=jr),yt!=null&&(yt[0]=pt),dt[0]+=18,Ye[0]-=18,Qt[0]=1}Ye=0}}if(Ze=Ze[0],We=We[0],Ye!=0)return Ye;if(dt=!!(2&We),!ut&&Ze)return 3;if(oe!=null&&(oe[0]=!!(16&We)),ce!=null&&(ce[0]=dt),he!=null&&(he[0]=0),ce=Ee[0],We=Le[0],Ze&&dt&&ye==null){Ye=0;break}if(4>P){Ye=7;break}if(ut&&Ze||!ut&&!Ze&&!r(y,N[0],"ALPH")){P=[P],Me.na=[Me.na],Me.P=[Me.P],Me.Sa=[Me.Sa];e:{Gt=y,Ye=N,ut=P;var Qt=Me.gb;Tt=Me.na,yt=Me.P,ar=Me.Sa,jr=22,e(Gt!=null),e(ut!=null),pt=Ye[0];var Br=ut[0];for(e(Tt!=null),e(ar!=null),Tt[0]=null,yt[0]=null,ar[0]=0;;){if(Ye[0]=pt,ut[0]=Br,8>Br){Ye=7;break e}var Ca=rt(Gt,pt+4);if(4294967286<Ca){Ye=3;break e}var Ar=8+Ca+1&-2;if(jr+=Ar,0<Qt&&jr>Qt){Ye=3;break e}if(!r(Gt,pt,"VP8 ")||!r(Gt,pt,"VP8L")){Ye=0;break e}if(Br[0]<Ar){Ye=7;break e}r(Gt,pt,"ALPH")||(Tt[0]=Gt,yt[0]=pt+8,ar[0]=Ca),pt+=Ar,Br-=Ar}}if(P=P[0],Me.na=Me.na[0],Me.P=Me.P[0],Me.Sa=Me.Sa[0],Ye!=0)break}P=[P],Me.Ja=[Me.Ja],Me.xa=[Me.xa];e:if(Qt=y,Ye=N,ut=P,Tt=Me.gb[0],yt=Me.Ja,ar=Me.xa,Gt=Ye[0],pt=!r(Qt,Gt,"VP8 "),jr=!r(Qt,Gt,"VP8L"),e(Qt!=null),e(ut!=null),e(yt!=null),e(ar!=null),8>ut[0])Ye=7;else{if(pt||jr){if(Qt=rt(Qt,Gt+4),12<=Tt&&Qt>Tt-12){Ye=3;break e}if(ke&&Qt>ut[0]-8){Ye=7;break e}yt[0]=Qt,Ye[0]+=8,ut[0]-=8,ar[0]=jr}else ar[0]=5<=ut[0]&&Qt[Gt+0]==47&&!(Qt[Gt+4]>>5),yt[0]=ut[0];Ye=0}if(P=P[0],Me.Ja=Me.Ja[0],Me.xa=Me.xa[0],N=N[0],Ye!=0)break;if(4294967286<Me.Ja)return 3;if(he==null||dt||(he[0]=Me.xa?2:1),ce=[ce],We=[We],Me.xa){if(5>P){Ye=7;break}he=ce,ke=We,dt=oe,y==null||5>P?y=0:5<=P&&y[N+0]==47&&!(y[N+4]>>5)?(ut=[0],Qt=[0],Tt=[0],te(yt=new F,y,N,P),xn(yt,ut,Qt,Tt)?(he!=null&&(he[0]=ut[0]),ke!=null&&(ke[0]=Qt[0]),dt!=null&&(dt[0]=Tt[0]),y=1):y=0):y=0}else{if(10>P){Ye=7;break}he=We,y==null||10>P||!Eu(y,N+3,P-3)?y=0:(ke=y[N+0]|y[N+1]<<8|y[N+2]<<16,dt=16383&(y[N+7]<<8|y[N+6]),y=16383&(y[N+9]<<8|y[N+8]),1&ke||3<(ke>>1&7)||!(ke>>4&1)||ke>>5>=Me.Ja||!dt||!y?y=0:(ce&&(ce[0]=dt),he&&(he[0]=y),y=1))}if(!y||(ce=ce[0],We=We[0],Ze&&(Ee[0]!=ce||Le[0]!=We)))return 3;ye!=null&&(ye[0]=Me,ye.offset=N-ye.w,e(4294967286>N-ye.w),e(ye.offset==ye.ha-P));break}return Ye==0||Ye==7&&Ze&&ye==null?(oe!=null&&(oe[0]|=Me.na!=null&&0<Me.na.length),H!=null&&(H[0]=ce),re!=null&&(re[0]=We),0):Ye}function Co(y,N,P){var H=N.width,re=N.height,oe=0,ce=0,he=H,ye=re;if(N.Da=y!=null&&0<y.Da,N.Da&&(he=y.cd,ye=y.bd,oe=y.v,ce=y.j,11>P||(oe&=-2,ce&=-2),0>oe||0>ce||0>=he||0>=ye||oe+he>H||ce+ye>re))return 0;if(N.v=oe,N.j=ce,N.va=oe+he,N.o=ce+ye,N.U=he,N.T=ye,N.da=y!=null&&0<y.da,N.da){if(!ve(he,ye,P=[y.ib],oe=[y.hb]))return 0;N.ib=P[0],N.hb=oe[0]}return N.ob=y!=null&&y.ob,N.Kb=y==null||!y.Sd,N.da&&(N.ob=N.ib<3*H/4&&N.hb<3*re/4,N.Kb=0),1}function Bu(y){if(y==null)return 2;if(11>y.S){var N=y.f.RGBA;N.fb+=(y.height-1)*N.A,N.A=-N.A}else N=y.f.kb,y=y.height,N.O+=(y-1)*N.fa,N.fa=-N.fa,N.N+=(y-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(y-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(y-1)*N.lb,N.lb=-N.lb);return 0}function Ni(y,N,P,H){if(H==null||0>=y||0>=N)return 2;if(P!=null){if(P.Da){var re=P.cd,oe=P.bd,ce=-2&P.v,he=-2&P.j;if(0>ce||0>he||0>=re||0>=oe||ce+re>y||he+oe>N)return 2;y=re,N=oe}if(P.da){if(!ve(y,N,re=[P.ib],oe=[P.hb]))return 2;y=re[0],N=oe[0]}}H.width=y,H.height=N;e:{var ye=H.width,Ee=H.height;if(y=H.S,0>=ye||0>=Ee||!(y>=Qd&&13>y))y=2;else{if(0>=H.Rd&&H.sd==null){ce=oe=re=N=0;var Le=(he=ye*cf[y])*Ee;if(11>y||(oe=(Ee+1)/2*(N=(ye+1)/2),y==12&&(ce=(re=ye)*Ee)),(Ee=s(Le+2*oe+ce))==null){y=1;break e}H.sd=Ee,11>y?((ye=H.f.RGBA).eb=Ee,ye.fb=0,ye.A=he,ye.size=Le):((ye=H.f.kb).y=Ee,ye.O=0,ye.fa=he,ye.Fd=Le,ye.f=Ee,ye.N=0+Le,ye.Ab=N,ye.Cd=oe,ye.ea=Ee,ye.W=0+Le+oe,ye.Db=N,ye.Ed=oe,y==12&&(ye.F=Ee,ye.J=0+Le+2*oe),ye.Tc=ce,ye.lb=re)}if(N=1,re=H.S,oe=H.width,ce=H.height,re>=Qd&&13>re)if(11>re)y=H.f.RGBA,N&=(he=Math.abs(y.A))*(ce-1)+oe<=y.size,N&=he>=oe*cf[re],N&=y.eb!=null;else{y=H.f.kb,he=(oe+1)/2,Le=(ce+1)/2,ye=Math.abs(y.fa),Ee=Math.abs(y.Ab);var Ze=Math.abs(y.Db),ke=Math.abs(y.lb),Me=ke*(ce-1)+oe;N&=ye*(ce-1)+oe<=y.Fd,N&=Ee*(Le-1)+he<=y.Cd,N=(N&=Ze*(Le-1)+he<=y.Ed)&ye>=oe&Ee>=he&Ze>=he,N&=y.y!=null,N&=y.f!=null,N&=y.ea!=null,re==12&&(N&=ke>=oe,N&=Me<=y.Tc,N&=y.F!=null)}else N=0;y=N?0:2}}return y!=0||P!=null&&P.fd&&(y=Bu(H)),y}var ol=64,Ss=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],fs=24,Gi=32,Yi=8,To=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Je("Predictor0","PredictorAdd0"),L.Predictor0=function(){return 4278190080},L.Predictor1=function(y){return y},L.Predictor2=function(y,N,P){return N[P+0]},L.Predictor3=function(y,N,P){return N[P+1]},L.Predictor4=function(y,N,P){return N[P-1]},L.Predictor5=function(y,N,P){return St(St(y,N[P+1]),N[P+0])},L.Predictor6=function(y,N,P){return St(y,N[P-1])},L.Predictor7=function(y,N,P){return St(y,N[P+0])},L.Predictor8=function(y,N,P){return St(N[P-1],N[P+0])},L.Predictor9=function(y,N,P){return St(N[P+0],N[P+1])},L.Predictor10=function(y,N,P){return St(St(y,N[P-1]),St(N[P+0],N[P+1]))},L.Predictor11=function(y,N,P){var H=N[P+0];return 0>=Ut(H>>24&255,y>>24&255,(N=N[P-1])>>24&255)+Ut(H>>16&255,y>>16&255,N>>16&255)+Ut(H>>8&255,y>>8&255,N>>8&255)+Ut(255&H,255&y,255&N)?H:y},L.Predictor12=function(y,N,P){var H=N[P+0];return(Ft((y>>24&255)+(H>>24&255)-((N=N[P-1])>>24&255))<<24|Ft((y>>16&255)+(H>>16&255)-(N>>16&255))<<16|Ft((y>>8&255)+(H>>8&255)-(N>>8&255))<<8|Ft((255&y)+(255&H)-(255&N)))>>>0},L.Predictor13=function(y,N,P){var H=N[P-1];return(Xt((y=St(y,N[P+0]))>>24&255,H>>24&255)<<24|Xt(y>>16&255,H>>16&255)<<16|Xt(y>>8&255,H>>8&255)<<8|Xt(255&y,255&H))>>>0};var Rc=L.PredictorAdd0;L.PredictorAdd1=Wt,Je("Predictor2","PredictorAdd2"),Je("Predictor3","PredictorAdd3"),Je("Predictor4","PredictorAdd4"),Je("Predictor5","PredictorAdd5"),Je("Predictor6","PredictorAdd6"),Je("Predictor7","PredictorAdd7"),Je("Predictor8","PredictorAdd8"),Je("Predictor9","PredictorAdd9"),Je("Predictor10","PredictorAdd10"),Je("Predictor11","PredictorAdd11"),Je("Predictor12","PredictorAdd12"),Je("Predictor13","PredictorAdd13");var Dc=L.PredictorAdd2;st("ColorIndexInverseTransform","MapARGB","32b",function(y){return y>>8&255},function(y){return y}),st("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(y){return y},function(y){return y>>8&255});var Ja,Kd=L.ColorIndexInverseTransform,Xi=L.MapARGB,Ki=L.VP8LColorIndexInverseTransformAlpha,zn=L.MapAlpha,Oo=L.VP8LPredictorsAdd=[];Oo.length=16,(L.VP8LPredictors=[]).length=16,(L.VP8LPredictorsAdd_C=[]).length=16,(L.VP8LPredictors_C=[]).length=16;var Fc,Lc,Ro,Do,Ji,Bl,Hs,Fo,Zn,Js,ea,Gr,ba,Za,Zi,ji,Ul,Uu,Sh,cm,um,dm,Nh,jh,ql,Zs,qu,$s,zl=s(511),Jd=s(2041),zu=s(225),Hu=s(767),Zd=0,Lo=Jd,$u=zu,Qn=Hu,Hn=zl,Qd=0,es=1,ef=2,Qs=3,Wu=4,Pc=5,ll=6,Vu=7,tf=8,Mc=9,rf=10,ei=[2,3,7],Ic=[3,3,11],Hl=[280,256,256,256,40],af=[0,1,1,1,0],Gu=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ti=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ri=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],cl=8,ai=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ni=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ws=null,fm=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],kh=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],nf=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],hm=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],$n=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Aa=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],qr=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],hs=[],Wa=[],ki=[],ul=1,Eh=2,Po=[],Wn=[];ko("UpsampleRgbLinePair",Eo,3),ko("UpsampleBgrLinePair",Rn,3),ko("UpsampleRgbaLinePair",ds,4),ko("UpsampleBgraLinePair",Vi,4),ko("UpsampleArgbLinePair",Tc,4),ko("UpsampleRgba4444LinePair",il,2),ko("UpsampleRgb565LinePair",sl,2);var $l=L.UpsampleRgbLinePair,Ah=L.UpsampleBgrLinePair,Bc=L.UpsampleRgbaLinePair,sf=L.UpsampleBgraLinePair,dl=L.UpsampleArgbLinePair,Qi=L.UpsampleRgba4444LinePair,fl=L.UpsampleRgb565LinePair,si=16,Uc=1<<si-1,Wl=-227,hl=482,of=6,ml=0,Vn=s(256),lf=s(256),mm=s(256),D1=s(256),F1=s(hl-Wl),L1=s(hl-Wl);Ao("YuvToRgbRow",Eo,3),Ao("YuvToBgrRow",Rn,3),Ao("YuvToRgbaRow",ds,4),Ao("YuvToBgraRow",Vi,4),Ao("YuvToArgbRow",Tc,4),Ao("YuvToRgba4444Row",il,2),Ao("YuvToRgb565Row",sl,2);var Qa=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],qc=[0,2,8],Yu=[8,7,6,4,4,2,2,2,1,1,1,1],Xu=1;this.WebPDecodeRGBA=function(y,N,P,H,re){var oe=es,ce=new mt,he=new Vt;ce.ba=he,he.S=oe,he.width=[he.width],he.height=[he.height];var ye=he.width,Ee=he.height,Le=new zt;if(Le==null||y==null)var Ze=2;else e(Le!=null),Ze=Si(y,N,P,Le.width,Le.height,Le.Pd,Le.Qd,Le.format,null);if(Ze!=0?ye=0:(ye!=null&&(ye[0]=Le.width[0]),Ee!=null&&(Ee[0]=Le.height[0]),ye=1),ye){he.width=he.width[0],he.height=he.height[0],H!=null&&(H[0]=he.width),re!=null&&(re[0]=he.height);e:{if(H=new vo,(re=new _t).data=y,re.w=N,re.ha=P,re.kd=1,N=[0],e(re!=null),((y=Si(re.data,re.w,re.ha,null,null,null,N,null,re))==0||y==7)&&N[0]&&(y=4),(N=y)==0){if(e(ce!=null),H.data=re.data,H.w=re.w+re.offset,H.ha=re.ha-re.offset,H.put=ir,H.ac=fa,H.bc=Ea,H.ma=ce,re.xa){if((y=Xe())==null){ce=1;break e}if((function(ke,Me){var We=[0],dt=[0],Ye=[0];t:for(;;){if(ke==null)return 0;if(Me==null)return ke.a=2,0;if(ke.l=Me,ke.a=0,te(ke.m,Me.data,Me.w,Me.ha),!xn(ke.m,We,dt,Ye)){ke.a=3;break t}if(ke.xb=Eh,Me.width=We[0],Me.height=dt[0],!Ke(We[0],dt[0],1,ke,null))break t;return 1}return e(ke.a!=0),0})(y,H)){if(H=(N=Ni(H.width,H.height,ce.Oa,ce.ba))==0){t:{H=y;r:for(;;){if(H==null){H=0;break t}if(e(H.s.yc!=null),e(H.s.Ya!=null),e(0<H.s.Wb),e((P=H.l)!=null),e((re=P.ma)!=null),H.xb!=0){if(H.ca=re.ba,H.tb=re.tb,e(H.ca!=null),!Co(re.Oa,P,Qs)){H.a=2;break r}if(!Qe(H,P.width)||P.da)break r;if((P.da||Fe(H.ca.S))&&bi(),11>H.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),H.ca.f.kb.F!=null&&bi()),H.Pb&&0<H.s.ua&&H.s.vb.X==null&&!ue(H.s.vb,H.s.Wa.Xa)){H.a=1;break r}H.xb=0}if(!$e(H,H.V,H.Ba,H.c,H.i,P.o,me))break r;re.Dc=H.Ma,H=1;break t}e(H.a!=0),H=0}H=!H}H&&(N=y.a)}else N=y.a}else{if((y=new xi)==null){ce=1;break e}if(y.Fa=re.na,y.P=re.P,y.qc=re.Sa,zi(y,H)){if((N=Ni(H.width,H.height,ce.Oa,ce.ba))==0){if(y.Aa=0,P=ce.Oa,e((re=y)!=null),P!=null){if(0<(ye=0>(ye=P.Md)?0:100<ye?255:255*ye/100)){for(Ee=Le=0;4>Ee;++Ee)12>(Ze=re.pb[Ee]).lc&&(Ze.ia=ye*Yu[0>Ze.lc?0:Ze.lc]>>3),Le|=Ze.ia;Le&&(alert("todo:VP8InitRandom"),re.ia=1)}re.Ga=P.Id,100<re.Ga?re.Ga=100:0>re.Ga&&(re.Ga=0)}(function(ke,Me){if(ke==null)return 0;if(Me==null)return Qr(ke,2,"NULL VP8Io parameter in VP8Decode().");if(!ke.cb&&!zi(ke,Me))return 0;if(e(ke.cb),Me.ac==null||Me.ac(Me)){Me.ob&&(ke.L=0);var We=qc[ke.L];if(ke.L==2?(ke.yb=0,ke.zb=0):(ke.yb=Me.v-We>>4,ke.zb=Me.j-We>>4,0>ke.yb&&(ke.yb=0),0>ke.zb&&(ke.zb=0)),ke.Va=Me.o+15+We>>4,ke.Hb=Me.va+15+We>>4,ke.Hb>ke.za&&(ke.Hb=ke.za),ke.Va>ke.Ub&&(ke.Va=ke.Ub),0<ke.L){var dt=ke.ed;for(We=0;4>We;++We){var Ye;if(ke.Qa.Cb){var ut=ke.Qa.Lb[We];ke.Qa.Fb||(ut+=dt.Tb)}else ut=dt.Tb;for(Ye=0;1>=Ye;++Ye){var pt=ke.gd[We][Ye],Tt=ut;if(dt.Pc&&(Tt+=dt.vd[0],Ye&&(Tt+=dt.od[0])),0<(Tt=0>Tt?0:63<Tt?63:Tt)){var yt=Tt;0<dt.wb&&(yt=4<dt.wb?yt>>2:yt>>1)>9-dt.wb&&(yt=9-dt.wb),1>yt&&(yt=1),pt.dd=yt,pt.tc=2*Tt+yt,pt.ld=40<=Tt?2:15<=Tt?1:0}else pt.tc=0;pt.La=Ye}}}We=0}else Qr(ke,6,"Frame setup failed"),We=ke.a;if(We=We==0){if(We){ke.$c=0,0<ke.Aa||(ke.Ic=Xu);t:{We=ke.Ic,dt=4*(yt=ke.za);var ar=32*yt,Gt=yt+1,jr=0<ke.L?yt*(0<ke.Aa?2:1):0,Qt=(ke.Aa==2?2:1)*yt;if((pt=dt+832+(Ye=3*(16*We+qc[ke.L])/2*ar)+(ut=ke.Fa!=null&&0<ke.Fa.length?ke.Kc.c*ke.Kc.i:0))!=pt)We=0;else{if(pt>ke.Vb){if(ke.Vb=0,ke.Ec=s(pt),ke.Fc=0,ke.Ec==null){We=Qr(ke,1,"no memory during frame initialization.");break t}ke.Vb=pt}pt=ke.Ec,Tt=ke.Fc,ke.Ac=pt,ke.Bc=Tt,Tt+=dt,ke.Gd=l(ar,Bs),ke.Hd=0,ke.rb=l(Gt+1,da),ke.sb=1,ke.wa=jr?l(jr,Mr):null,ke.Y=0,ke.D.Nb=0,ke.D.wa=ke.wa,ke.D.Y=ke.Y,0<ke.Aa&&(ke.D.Y+=yt),e(!0),ke.oc=pt,ke.pc=Tt,Tt+=832,ke.ya=l(Qt,gi),ke.aa=0,ke.D.ya=ke.ya,ke.D.aa=ke.aa,ke.Aa==2&&(ke.D.aa+=yt),ke.R=16*yt,ke.B=8*yt,yt=(ar=qc[ke.L])*ke.R,ar=ar/2*ke.B,ke.sa=pt,ke.ta=Tt+yt,ke.qa=ke.sa,ke.ra=ke.ta+16*We*ke.R+ar,ke.Ha=ke.qa,ke.Ia=ke.ra+8*We*ke.B+ar,ke.$c=0,Tt+=Ye,ke.mb=ut?pt:null,ke.nb=ut?Tt:null,e(Tt+ut<=ke.Fc+ke.Vb),Au(ke),n(ke.Ac,ke.Bc,0,dt),We=1}}if(We){if(Me.ka=0,Me.y=ke.sa,Me.O=ke.ta,Me.f=ke.qa,Me.N=ke.ra,Me.ea=ke.Ha,Me.Vd=ke.Ia,Me.fa=ke.R,Me.Rc=ke.B,Me.F=null,Me.J=0,!Zd){for(We=-255;255>=We;++We)zl[255+We]=0>We?-We:We;for(We=-1020;1020>=We;++We)Jd[1020+We]=-128>We?-128:127<We?127:We;for(We=-112;112>=We;++We)zu[112+We]=-16>We?-16:15<We?15:We;for(We=-255;510>=We;++We)Hu[255+We]=0>We?0:255<We?255:We;Zd=1}Hs=yi,Fo=Cu,Js=us,ea=Tu,Gr=Ou,Zn=qd,ba=Yd,Za=No,Zi=Q,ji=Ae,Ul=Xd,Uu=R,Sh=Re,cm=ze,um=_o,dm=bo,Nh=Ml,jh=Pu,Wa[0]=Vd,Wa[1]=zd,Wa[2]=Wd,Wa[3]=Fu,Wa[4]=Us,Wa[5]=Lu,Wa[6]=Un,Wa[7]=Fl,Wa[8]=Ll,Wa[9]=qs,hs[0]=_i,hs[1]=Ru,hs[2]=Du,hs[3]=$d,hs[4]=xo,hs[5]=Dl,hs[6]=nl,ki[0]=kc,ki[1]=Hd,ki[2]=Hi,ki[3]=Gd,ki[4]=On,ki[5]=Ec,ki[6]=$i,We=1}else We=0}We&&(We=(function(Br,Ca){for(Br.M=0;Br.M<Br.Va;++Br.M){var Ar,Yt=Br.Jc[Br.M&Br.Xb],Bt=Br.m,Pa=Br;for(Ar=0;Ar<Pa.za;++Ar){var xr=Bt,Or=Pa,la=Or.Ac,bn=Or.Bc+4*Ar,Gn=Or.zc,wa=Or.ya[Or.aa+Ar];if(Or.Qa.Bb?wa.$b=ge(xr,Or.Pa.jb[0])?2+ge(xr,Or.Pa.jb[2]):ge(xr,Or.Pa.jb[1]):wa.$b=0,Or.kc&&(wa.Ad=ge(xr,Or.Bd)),wa.Za=!ge(xr,145)+0,wa.Za){var ln=wa.Ob,ts=0;for(Or=0;4>Or;++Or){var cn,Lr=Gn[0+Or];for(cn=0;4>cn;++cn){Lr=$n[la[bn+cn]][Lr];for(var Kr=nf[ge(xr,Lr[0])];0<Kr;)Kr=nf[2*Kr+ge(xr,Lr[Kr])];Lr=-Kr,la[bn+cn]=Lr}a(ln,ts,la,bn,4),ts+=4,Gn[0+Or]=Lr}}else Lr=ge(xr,156)?ge(xr,128)?1:3:ge(xr,163)?2:0,wa.Ob[0]=Lr,n(la,bn,Lr,4),n(Gn,0,Lr,4);wa.Dd=ge(xr,142)?ge(xr,114)?ge(xr,183)?1:3:2:0}if(Pa.m.Ka)return Qr(Br,7,"Premature end-of-partition0 encountered.");for(;Br.ja<Br.za;++Br.ja){if(Pa=Yt,xr=(Bt=Br).rb[Bt.sb-1],la=Bt.rb[Bt.sb+Bt.ja],Ar=Bt.ya[Bt.aa+Bt.ja],bn=Bt.kc?Ar.Ad:0)xr.la=la.la=0,Ar.Za||(xr.Na=la.Na=0),Ar.Hc=0,Ar.Gc=0,Ar.ia=0;else{var Ma,ta;if(xr=la,la=Pa,bn=Bt.Pa.Xc,Gn=Bt.ya[Bt.aa+Bt.ja],wa=Bt.pb[Gn.$b],Or=Gn.ad,ln=0,ts=Bt.rb[Bt.sb-1],Lr=cn=0,n(Or,ln,0,384),Gn.Za)var wn=0,Ia=bn[3];else{Kr=s(16);var Jr=xr.Na+ts.Na;if(Jr=Ws(la,bn[1],Jr,wa.Eb,0,Kr,0),xr.Na=ts.Na=(0<Jr)+0,1<Jr)Hs(Kr,0,Or,ln);else{var en=Kr[0]+3>>3;for(Kr=0;256>Kr;Kr+=16)Or[ln+Kr]=en}wn=1,Ia=bn[0]}var ca=15&xr.la,un=15&ts.la;for(Kr=0;4>Kr;++Kr){var dn=1&un;for(en=ta=0;4>en;++en)ca=ca>>1|(dn=(Jr=Ws(la,Ia,Jr=dn+(1&ca),wa.Sc,wn,Or,ln))>wn)<<7,ta=ta<<2|(3<Jr?3:1<Jr?2:Or[ln+0]!=0),ln+=16;ca>>=4,un=un>>1|dn<<7,cn=(cn<<8|ta)>>>0}for(Ia=ca,wn=un>>4,Ma=0;4>Ma;Ma+=2){for(ta=0,ca=xr.la>>4+Ma,un=ts.la>>4+Ma,Kr=0;2>Kr;++Kr){for(dn=1&un,en=0;2>en;++en)Jr=dn+(1&ca),ca=ca>>1|(dn=0<(Jr=Ws(la,bn[2],Jr,wa.Qc,0,Or,ln)))<<3,ta=ta<<2|(3<Jr?3:1<Jr?2:Or[ln+0]!=0),ln+=16;ca>>=2,un=un>>1|dn<<5}Lr|=ta<<4*Ma,Ia|=ca<<4<<Ma,wn|=(240&un)<<Ma}xr.la=Ia,ts.la=wn,Gn.Hc=cn,Gn.Gc=Lr,Gn.ia=43690&Lr?0:wa.ia,bn=!(cn|Lr)}if(0<Bt.L&&(Bt.wa[Bt.Y+Bt.ja]=Bt.gd[Ar.$b][Ar.Za],Bt.wa[Bt.Y+Bt.ja].La|=!bn),Pa.Ka)return Qr(Br,7,"Premature end-of-file encountered.")}if(Au(Br),Bt=Ca,Pa=1,Ar=(Yt=Br).D,xr=0<Yt.L&&Yt.M>=Yt.zb&&Yt.M<=Yt.Va,Yt.Aa==0)t:{if(Ar.M=Yt.M,Ar.uc=xr,zs(Yt,Ar),Pa=1,Ar=(ta=Yt.D).Nb,xr=(Lr=qc[Yt.L])*Yt.R,la=Lr/2*Yt.B,Kr=16*Ar*Yt.R,en=8*Ar*Yt.B,bn=Yt.sa,Gn=Yt.ta-xr+Kr,wa=Yt.qa,Or=Yt.ra-la+en,ln=Yt.Ha,ts=Yt.Ia-la+en,un=(ca=ta.M)==0,cn=ca>=Yt.Va-1,Yt.Aa==2&&zs(Yt,ta),ta.uc)for(dn=(Jr=Yt).D.M,e(Jr.D.uc),ta=Jr.yb;ta<Jr.Hb;++ta){wn=ta,Ia=dn;var ha=(Yr=(fn=Jr).D).Nb;Ma=fn.R;var Yr=Yr.wa[Yr.Y+wn],rs=fn.sa,Va=fn.ta+16*ha*Ma+16*wn,fr=Yr.dd,hr=Yr.tc;if(hr!=0)if(e(3<=hr),fn.L==1)0<wn&&dm(rs,Va,Ma,hr+4),Yr.La&&jh(rs,Va,Ma,hr),0<Ia&&um(rs,Va,Ma,hr+4),Yr.La&&Nh(rs,Va,Ma,hr);else{var Zr=fn.B,Ns=fn.qa,ii=fn.ra+8*ha*Zr+8*wn,ms=fn.Ha,fn=fn.Ia+8*ha*Zr+8*wn;ha=Yr.ld,0<wn&&(Za(rs,Va,Ma,hr+4,fr,ha),ji(Ns,ii,ms,fn,Zr,hr+4,fr,ha)),Yr.La&&(Uu(rs,Va,Ma,hr,fr,ha),cm(Ns,ii,ms,fn,Zr,hr,fr,ha)),0<Ia&&(ba(rs,Va,Ma,hr+4,fr,ha),Zi(Ns,ii,ms,fn,Zr,hr+4,fr,ha)),Yr.La&&(Ul(rs,Va,Ma,hr,fr,ha),Sh(Ns,ii,ms,fn,Zr,hr,fr,ha))}}if(Yt.ia&&alert("todo:DitherRow"),Bt.put!=null){if(ta=16*ca,ca=16*(ca+1),un?(Bt.y=Yt.sa,Bt.O=Yt.ta+Kr,Bt.f=Yt.qa,Bt.N=Yt.ra+en,Bt.ea=Yt.Ha,Bt.W=Yt.Ia+en):(ta-=Lr,Bt.y=bn,Bt.O=Gn,Bt.f=wa,Bt.N=Or,Bt.ea=ln,Bt.W=ts),cn||(ca-=Lr),ca>Bt.o&&(ca=Bt.o),Bt.F=null,Bt.J=null,Yt.Fa!=null&&0<Yt.Fa.length&&ta<ca&&(Bt.J=_a(Yt,Bt,ta,ca-ta),Bt.F=Yt.mb,Bt.F==null&&Bt.F.length==0)){Pa=Qr(Yt,3,"Could not decode alpha data.");break t}ta<Bt.j&&(Lr=Bt.j-ta,ta=Bt.j,e(!(1&Lr)),Bt.O+=Yt.R*Lr,Bt.N+=Yt.B*(Lr>>1),Bt.W+=Yt.B*(Lr>>1),Bt.F!=null&&(Bt.J+=Bt.width*Lr)),ta<ca&&(Bt.O+=Bt.v,Bt.N+=Bt.v>>1,Bt.W+=Bt.v>>1,Bt.F!=null&&(Bt.J+=Bt.v),Bt.ka=ta-Bt.j,Bt.U=Bt.va-Bt.v,Bt.T=ca-ta,Pa=Bt.put(Bt))}Ar+1!=Yt.Ic||cn||(a(Yt.sa,Yt.ta-xr,bn,Gn+16*Yt.R,xr),a(Yt.qa,Yt.ra-la,wa,Or+8*Yt.B,la),a(Yt.Ha,Yt.Ia-la,ln,ts+8*Yt.B,la))}if(!Pa)return Qr(Br,6,"Output aborted.")}return 1})(ke,Me)),Me.bc!=null&&Me.bc(Me),We&=1}return We?(ke.cb=0,We):0})(y,H)||(N=y.a)}}else N=y.a}N==0&&ce.Oa!=null&&ce.Oa.fd&&(N=Bu(ce.ba))}ce=N}oe=ce!=0?null:11>oe?he.f.RGBA.eb:he.f.kb.y}else oe=null;return oe};var cf=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(L,Z){for(var D="",T=0;T<4;T++)D+=String.fromCharCode(L[Z++]);return D}function m(L,Z){return L[Z+0]|L[Z+1]<<8}function v(L,Z){return(L[Z+0]|L[Z+1]<<8|L[Z+2]<<16)>>>0}function x(L,Z){return(L[Z+0]|L[Z+1]<<8|L[Z+2]<<16|L[Z+3]<<24)>>>0}new d;var g=[0],b=[0],_=[],w=new d,E=t,C=(function(L,Z){var D={},T=0,M=!1,V=0,ie=0;if(D.frames=[],!(function(j,F){for(var I=0;I<4;I++)if(j[F+I]!="RIFF".charCodeAt(I))return!0;return!1})(L,Z)){for(x(L,Z+=4),Z+=8;Z<L.length;){var X=f(L,Z),J=x(L,Z+=4);Z+=4;var K=J+(1&J);switch(X){case"VP8 ":case"VP8L":D.frames[T]===void 0&&(D.frames[T]={}),(U=D.frames[T]).src_off=M?ie:Z-8,U.src_size=V+J+8,T++,M&&(M=!1,V=0,ie=0);break;case"VP8X":(U=D.header={}).feature_flags=L[Z];var te=Z+4;U.canvas_width=1+v(L,te),te+=3,U.canvas_height=1+v(L,te),te+=3;break;case"ALPH":M=!0,V=K+8,ie=Z-8;break;case"ANIM":(U=D.header).bgcolor=x(L,Z),te=Z+4,U.loop_count=m(L,te),te+=2;break;case"ANMF":var fe,U;(U=D.frames[T]={}).offset_x=2*v(L,Z),Z+=3,U.offset_y=2*v(L,Z),Z+=3,U.width=1+v(L,Z),Z+=3,U.height=1+v(L,Z),Z+=3,U.duration=v(L,Z),Z+=3,fe=L[Z++],U.dispose=1&fe,U.blend=fe>>1&1}X!="ANMF"&&(Z+=K)}return D}})(E,0);C.response=E,C.rgbaoutput=!0,C.dataurl=!1;var A=C.header?C.header:null,O=C.frames?C.frames:null;if(A){A.loop_counter=A.loop_count,g=[A.canvas_height],b=[A.canvas_width];for(var G=0;G<O.length&&O[G].blend!=0;G++);}var W=O[0],B=w.WebPDecodeRGBA(E,W.src_off,W.src_size,b,g);W.rgba=B,W.imgwidth=b[0],W.imgheight=g[0];for(var q=0;q<b[0]*g[0]*4;q++)_[q]=B[q];return this.width=b,this.height=g,this.data=_,this}(function(t){var e,r,a,n,s,l,c,d,f,m=function(j){return j=j||{},this.isStrokeTransparent=j.isStrokeTransparent||!1,this.strokeOpacity=j.strokeOpacity||1,this.strokeStyle=j.strokeStyle||"#000000",this.fillStyle=j.fillStyle||"#000000",this.isFillTransparent=j.isFillTransparent||!1,this.fillOpacity=j.fillOpacity||1,this.font=j.font||"10px sans-serif",this.textBaseline=j.textBaseline||"alphabetic",this.textAlign=j.textAlign||"left",this.lineWidth=j.lineWidth||1,this.lineJoin=j.lineJoin||"miter",this.lineCap=j.lineCap||"butt",this.path=j.path||[],this.transform=j.transform!==void 0?j.transform.clone():new d,this.globalCompositeOperation=j.globalCompositeOperation||"normal",this.globalAlpha=j.globalAlpha||1,this.clip_path=j.clip_path||[],this.currentPoint=j.currentPoint||new l,this.miterLimit=j.miterLimit||10,this.lastPoint=j.lastPoint||new l,this.lineDashOffset=j.lineDashOffset||0,this.lineDash=j.lineDash||[],this.margin=j.margin||[0,0,0,0],this.prevPageLastElemOffset=j.prevPageLastElemOffset||0,this.ignoreClearRect=typeof j.ignoreClearRect!="boolean"||j.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new v(this),e=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,l=this.internal.Point,c=this.internal.Rectangle,d=this.internal.Matrix,f=new m}]);var v=function(j){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var F=j;Object.defineProperty(this,"pdf",{get:function(){return F}});var I=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return I},set:function(ue){I=!!ue}});var z=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return z},set:function(ue){z=!!ue}});var ne=0;Object.defineProperty(this,"posX",{get:function(){return ne},set:function(ue){isNaN(ue)||(ne=ue)}});var se=0;Object.defineProperty(this,"posY",{get:function(){return se},set:function(ue){isNaN(ue)||(se=ue)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(ue){var ot;typeof ue=="number"?ot=[ue,ue,ue,ue]:((ot=new Array(4))[0]=ue[0],ot[1]=ue.length>=2?ue[1]:ot[0],ot[2]=ue.length>=3?ue[2]:ot[0],ot[3]=ue.length>=4?ue[3]:ot[1]),f.margin=ot}});var je=!1;Object.defineProperty(this,"autoPaging",{get:function(){return je},set:function(ue){je=ue}});var Ne=0;Object.defineProperty(this,"lastBreak",{get:function(){return Ne},set:function(ue){Ne=ue}});var ge=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ge},set:function(ue){ge=ue}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(ue){ue instanceof m&&(f=ue)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(ue){f.path=ue}});var Ie=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ie},set:function(ue){Ie=ue}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ue){var ot;ot=x(ue),this.ctx.fillStyle=ot.style,this.ctx.isFillTransparent=ot.a===0,this.ctx.fillOpacity=ot.a,this.pdf.setFillColor(ot.r,ot.g,ot.b,{a:ot.a}),this.pdf.setTextColor(ot.r,ot.g,ot.b,{a:ot.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ue){var ot=x(ue);this.ctx.strokeStyle=ot.style,this.ctx.isStrokeTransparent=ot.a===0,this.ctx.strokeOpacity=ot.a,ot.a===0?this.pdf.setDrawColor(255,255,255):(ot.a,this.pdf.setDrawColor(ot.r,ot.g,ot.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ue){["butt","round","square"].indexOf(ue)!==-1&&(this.ctx.lineCap=ue,this.pdf.setLineCap(ue))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ue){isNaN(ue)||(this.ctx.lineWidth=ue,this.pdf.setLineWidth(ue))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ue){["bevel","round","miter"].indexOf(ue)!==-1&&(this.ctx.lineJoin=ue,this.pdf.setLineJoin(ue))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ue){isNaN(ue)||(this.ctx.miterLimit=ue,this.pdf.setMiterLimit(ue))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ue){this.ctx.textBaseline=ue}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ue){["right","end","center","left","start"].indexOf(ue)!==-1&&(this.ctx.textAlign=ue)}});var le=null,Ge=null,rt=null;Object.defineProperty(this,"fontFaces",{get:function(){return rt},set:function(ue){le=null,Ge=null,rt=ue}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ue){var ot;if(this.ctx.font=ue,(ot=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(ue))!==null){var xe=ot[1];ot[2];var ve=ot[3],Be=ot[4];ot[5];var jt=ot[6],Je=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Be)[2];Be=Math.floor(Je==="px"?parseFloat(Be)*this.pdf.internal.scaleFactor:Je==="em"?parseFloat(Be)*this.pdf.getFontSize():parseFloat(Be)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Be);var ct=(function(st){var Dt,At,Ct=[],Te=st.trim();if(Te==="")return qv;if(Te in bS)return[bS[Te]];for(;Te!=="";){switch(At=null,Dt=(Te=SS(Te)).charAt(0)){case'"':case"'":At=Mz(Te.substring(1),Dt);break;default:At=Iz(Te)}if(At===null||(Ct.push(At[0]),(Te=SS(At[1]))!==""&&Te.charAt(0)!==","))return qv;Te=Te.replace(/^,/,"")}return Ct})(jt);if(this.fontFaces){var St=(function(st,Dt){var At=st.getFontList(),Ct=JSON.stringify(At);if(le===null||Ge!==Ct){var Te=(function(Ve){var _e=[];return Object.keys(Ve).forEach(function(Ue){Ve[Ue].forEach(function(Fe){var gt=null;switch(Fe){case"bold":gt={family:Ue,weight:"bold"};break;case"italic":gt={family:Ue,style:"italic"};break;case"bolditalic":gt={family:Ue,weight:"bold",style:"italic"};break;case"":case"normal":gt={family:Ue}}gt!==null&&(gt.ref={name:Ue,style:Fe},_e.push(gt))})}),_e})(At);le=(function(Ve){for(var _e={},Ue=0;Ue<Ve.length;++Ue){var Fe=Uv(Ve[Ue]),gt=Fe.family,Ht=Fe.stretch,Vt=Fe.style,zt=Fe.weight;_e[gt]=_e[gt]||{},_e[gt][Ht]=_e[gt][Ht]||{},_e[gt][Ht][Vt]=_e[gt][Ht][Vt]||{},_e[gt][Ht][Vt][zt]=Fe}return _e})(Te.concat(Dt)),Ge=Ct}return le})(this.pdf,this.fontFaces),Ft=ct.map(function(st){return{family:st,stretch:"normal",weight:ve,style:xe}}),Xt=(function(st,Dt,At){for(var Ct=(At=At||{}).defaultFontFamily||"times",Te=Object.assign({},Pz,At.genericFontFamilies||{}),Ve=null,_e=null,Ue=0;Ue<Dt.length;++Ue)if(Te[(Ve=Uv(Dt[Ue])).family]&&(Ve.family=Te[Ve.family]),st.hasOwnProperty(Ve.family)){_e=st[Ve.family];break}if(!(_e=_e||st[Ct]))throw new Error("Could not find a font-family for the rule '"+wS(Ve)+"' and default family '"+Ct+"'.");if(_e=(function(Fe,gt){if(gt[Fe])return gt[Fe];var Ht=Hx[Fe],Vt=Ht<=Hx.normal?-1:1,zt=_S(gt,ik,Ht,Vt);if(!zt)throw new Error("Could not find a matching font-stretch value for "+Fe);return zt})(Ve.stretch,_e),_e=(function(Fe,gt){if(gt[Fe])return gt[Fe];for(var Ht=sk[Fe],Vt=0;Vt<Ht.length;++Vt)if(gt[Ht[Vt]])return gt[Ht[Vt]];throw new Error("Could not find a matching font-style for "+Fe)})(Ve.style,_e),!(_e=(function(Fe,gt){if(gt[Fe])return gt[Fe];if(Fe===400&&gt[500])return gt[500];if(Fe===500&&gt[400])return gt[400];var Ht=Lz[Fe],Vt=_S(gt,ok,Ht,Fe<400?-1:1);if(!Vt)throw new Error("Could not find a matching font-weight for value "+Fe);return Vt})(Ve.weight,_e)))throw new Error("Failed to resolve a font for the rule '"+wS(Ve)+"'.");return _e})(St,Ft);this.pdf.setFont(Xt.ref.name,Xt.ref.style)}else{var Ut="";(ve==="bold"||parseInt(ve,10)>=700||xe==="bold")&&(Ut="bold"),xe==="italic"&&(Ut+="italic"),Ut.length===0&&(Ut="normal");for(var Wt="",$t={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},wt=0;wt<ct.length;wt++){if(this.pdf.internal.getFont(ct[wt],Ut,{noFallback:!0,disableWarning:!0})!==void 0){Wt=ct[wt];break}if(Ut==="bolditalic"&&this.pdf.internal.getFont(ct[wt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Wt=ct[wt],Ut="bold";else if(this.pdf.internal.getFont(ct[wt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Wt=ct[wt],Ut="normal";break}}if(Wt===""){for(var Ce=0;Ce<ct.length;Ce++)if($t[ct[Ce]]){Wt=$t[ct[Ce]];break}}Wt=Wt===""?"Times":Wt,this.pdf.setFont(Wt,Ut)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ue){this.ctx.globalCompositeOperation=ue}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ue){this.ctx.globalAlpha=ue}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ue){this.ctx.lineDashOffset=ue,U.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ue){this.ctx.lineDash=ue,U.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ue){this.ctx.ignoreClearRect=!!ue}})};v.prototype.setLineDash=function(j){this.lineDash=j},v.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},v.prototype.fill=function(){O.call(this,"fill",!1)},v.prototype.stroke=function(){O.call(this,"stroke",!1)},v.prototype.beginPath=function(){this.path=[{type:"begin"}]},v.prototype.moveTo=function(j,F){if(isNaN(j)||isNaN(F))throw Oa.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var I=this.ctx.transform.applyToPoint(new l(j,F));this.path.push({type:"mt",x:I.x,y:I.y}),this.ctx.lastPoint=new l(j,F)},v.prototype.closePath=function(){var j=new l(0,0),F=0;for(F=this.path.length-1;F!==-1;F--)if(this.path[F].type==="begin"&&xa(this.path[F+1])==="object"&&typeof this.path[F+1].x=="number"){j=new l(this.path[F+1].x,this.path[F+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(j.x,j.y)},v.prototype.lineTo=function(j,F){if(isNaN(j)||isNaN(F))throw Oa.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var I=this.ctx.transform.applyToPoint(new l(j,F));this.path.push({type:"lt",x:I.x,y:I.y}),this.ctx.lastPoint=new l(I.x,I.y)},v.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),O.call(this,null,!0)},v.prototype.quadraticCurveTo=function(j,F,I,z){if(isNaN(I)||isNaN(z)||isNaN(j)||isNaN(F))throw Oa.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ne=this.ctx.transform.applyToPoint(new l(I,z)),se=this.ctx.transform.applyToPoint(new l(j,F));this.path.push({type:"qct",x1:se.x,y1:se.y,x:ne.x,y:ne.y}),this.ctx.lastPoint=new l(ne.x,ne.y)},v.prototype.bezierCurveTo=function(j,F,I,z,ne,se){if(isNaN(ne)||isNaN(se)||isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z))throw Oa.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var je=this.ctx.transform.applyToPoint(new l(ne,se)),Ne=this.ctx.transform.applyToPoint(new l(j,F)),ge=this.ctx.transform.applyToPoint(new l(I,z));this.path.push({type:"bct",x1:Ne.x,y1:Ne.y,x2:ge.x,y2:ge.y,x:je.x,y:je.y}),this.ctx.lastPoint=new l(je.x,je.y)},v.prototype.arc=function(j,F,I,z,ne,se){if(isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z)||isNaN(ne))throw Oa.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(se=!!se,!this.ctx.transform.isIdentity){var je=this.ctx.transform.applyToPoint(new l(j,F));j=je.x,F=je.y;var Ne=this.ctx.transform.applyToPoint(new l(0,I)),ge=this.ctx.transform.applyToPoint(new l(0,0));I=Math.sqrt(Math.pow(Ne.x-ge.x,2)+Math.pow(Ne.y-ge.y,2))}Math.abs(ne-z)>=2*Math.PI&&(z=0,ne=2*Math.PI),this.path.push({type:"arc",x:j,y:F,radius:I,startAngle:z,endAngle:ne,counterclockwise:se})},v.prototype.arcTo=function(j,F,I,z,ne){throw new Error("arcTo not implemented.")},v.prototype.rect=function(j,F,I,z){if(isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z))throw Oa.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(j,F),this.lineTo(j+I,F),this.lineTo(j+I,F+z),this.lineTo(j,F+z),this.lineTo(j,F),this.lineTo(j+I,F),this.lineTo(j,F)},v.prototype.fillRect=function(j,F,I,z){if(isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z))throw Oa.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var ne={};this.lineCap!=="butt"&&(ne.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ne.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(j,F,I,z),this.fill(),ne.hasOwnProperty("lineCap")&&(this.lineCap=ne.lineCap),ne.hasOwnProperty("lineJoin")&&(this.lineJoin=ne.lineJoin)}},v.prototype.strokeRect=function(j,F,I,z){if(isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z))throw Oa.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(j,F,I,z),this.stroke())},v.prototype.clearRect=function(j,F,I,z){if(isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z))throw Oa.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(j,F,I,z))},v.prototype.save=function(j){j=typeof j!="boolean"||j;for(var F=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("q");if(this.pdf.setPage(F),j){this.ctx.fontSize=this.pdf.internal.getFontSize();var z=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=z}},v.prototype.restore=function(j){j=typeof j!="boolean"||j;for(var F=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("Q");this.pdf.setPage(F),j&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},v.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(j){var F,I,z,ne;if(j.isCanvasGradient===!0&&(j=j.getColor()),!j)return{r:0,g:0,b:0,a:0,style:j};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(j))F=0,I=0,z=0,ne=0;else{var se=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(j);if(se!==null)F=parseInt(se[1]),I=parseInt(se[2]),z=parseInt(se[3]),ne=1;else if((se=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(j))!==null)F=parseInt(se[1]),I=parseInt(se[2]),z=parseInt(se[3]),ne=parseFloat(se[4]);else{if(ne=1,typeof j=="string"&&j.charAt(0)!=="#"){var je=new Zj(j);j=je.ok?je.toHex():"#000000"}j.length===4?(F=j.substring(1,2),F+=F,I=j.substring(2,3),I+=I,z=j.substring(3,4),z+=z):(F=j.substring(1,3),I=j.substring(3,5),z=j.substring(5,7)),F=parseInt(F,16),I=parseInt(I,16),z=parseInt(z,16)}}return{r:F,g:I,b:z,a:ne,style:j}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};v.prototype.fillText=function(j,F,I,z){if(isNaN(F)||isNaN(I)||typeof j!="string")throw Oa.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(z=isNaN(z)?void 0:z,!g.call(this)){var ne=K(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;T.call(this,{text:j,x:F,y:I,scale:se,angle:ne,align:this.textAlign,maxWidth:z})}},v.prototype.strokeText=function(j,F,I,z){if(isNaN(F)||isNaN(I)||typeof j!="string")throw Oa.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){z=isNaN(z)?void 0:z;var ne=K(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;T.call(this,{text:j,x:F,y:I,scale:se,renderingMode:"stroke",angle:ne,align:this.textAlign,maxWidth:z})}},v.prototype.measureText=function(j){if(typeof j!="string")throw Oa.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var F=this.pdf,I=this.pdf.internal.scaleFactor,z=F.internal.getFontSize(),ne=F.getStringUnitWidth(j)*z/F.internal.scaleFactor;return new function(se){var je=(se=se||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return je}}),this}({width:ne*=Math.round(96*I/72*1e4)/1e4})},v.prototype.scale=function(j,F){if(isNaN(j)||isNaN(F))throw Oa.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var I=new d(j,0,0,F,0,0);this.ctx.transform=this.ctx.transform.multiply(I)},v.prototype.rotate=function(j){if(isNaN(j))throw Oa.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var F=new d(Math.cos(j),Math.sin(j),-Math.sin(j),Math.cos(j),0,0);this.ctx.transform=this.ctx.transform.multiply(F)},v.prototype.translate=function(j,F){if(isNaN(j)||isNaN(F))throw Oa.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var I=new d(1,0,0,1,j,F);this.ctx.transform=this.ctx.transform.multiply(I)},v.prototype.transform=function(j,F,I,z,ne,se){if(isNaN(j)||isNaN(F)||isNaN(I)||isNaN(z)||isNaN(ne)||isNaN(se))throw Oa.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var je=new d(j,F,I,z,ne,se);this.ctx.transform=this.ctx.transform.multiply(je)},v.prototype.setTransform=function(j,F,I,z,ne,se){j=isNaN(j)?1:j,F=isNaN(F)?0:F,I=isNaN(I)?0:I,z=isNaN(z)?1:z,ne=isNaN(ne)?0:ne,se=isNaN(se)?0:se,this.ctx.transform=new d(j,F,I,z,ne,se)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};v.prototype.drawImage=function(j,F,I,z,ne,se,je,Ne,ge){var Ie=this.pdf.getImageProperties(j),le=1,Ge=1,rt=1,ue=1;z!==void 0&&Ne!==void 0&&(rt=Ne/z,ue=ge/ne,le=Ie.width/z*Ne/z,Ge=Ie.height/ne*ge/ne),se===void 0&&(se=F,je=I,F=0,I=0),z!==void 0&&Ne===void 0&&(Ne=z,ge=ne),z===void 0&&Ne===void 0&&(Ne=Ie.width,ge=Ie.height);var ot=this.ctx.transform.decompose(),xe=K(ot.rotate.shx),ve=new d,Be=(ve=(ve=(ve=ve.multiply(ot.translate)).multiply(ot.skew)).multiply(ot.scale)).applyToRectangle(new c(se-F*rt,je-I*ue,z*le,ne*Ge));if(this.autoPaging){for(var jt,Je=w.call(this,Be),ct=[],St=0;St<Je.length;St+=1)ct.indexOf(Je[St])===-1&&ct.push(Je[St]);A(ct);for(var Ft=ct[0],Xt=ct[ct.length-1],Ut=Ft;Ut<Xt+1;Ut++){this.pdf.setPage(Ut);var Wt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],$t=Ut===1?this.posY+this.margin[0]:this.margin[0],wt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ce=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],st=Ut===1?0:wt+(Ut-2)*Ce;if(this.ctx.clip_path.length!==0){var Dt=this.path;jt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(jt,this.posX+this.margin[3],-st+$t+this.ctx.prevPageLastElemOffset),G.call(this,"fill",!0),this.path=Dt}var At=JSON.parse(JSON.stringify(Be));At=C([At],this.posX+this.margin[3],-st+$t+this.ctx.prevPageLastElemOffset)[0];var Ct=(Ut>Ft||Ut<Xt)&&_.call(this);Ct&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Wt,Ce,null).clip().discardPath()),this.pdf.addImage(j,"JPEG",At.x,At.y,At.w,At.h,null,null,xe),Ct&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(j,"JPEG",Be.x,Be.y,Be.w,Be.h,null,null,xe)};var w=function(j,F,I){var z=[];F=F||this.pdf.internal.pageSize.width,I=I||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ne=this.posY+this.ctx.prevPageLastElemOffset;switch(j.type){default:case"mt":case"lt":z.push(Math.floor((j.y+ne)/I)+1);break;case"arc":z.push(Math.floor((j.y+ne-j.radius)/I)+1),z.push(Math.floor((j.y+ne+j.radius)/I)+1);break;case"qct":var se=te(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x,j.y);z.push(Math.floor((se.y+ne)/I)+1),z.push(Math.floor((se.y+se.h+ne)/I)+1);break;case"bct":var je=fe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x2,j.y2,j.x,j.y);z.push(Math.floor((je.y+ne)/I)+1),z.push(Math.floor((je.y+je.h+ne)/I)+1);break;case"rect":z.push(Math.floor((j.y+ne)/I)+1),z.push(Math.floor((j.y+j.h+ne)/I)+1)}for(var Ne=0;Ne<z.length;Ne+=1)for(;this.pdf.internal.getNumberOfPages()<z[Ne];)E.call(this);return z},E=function(){var j=this.fillStyle,F=this.strokeStyle,I=this.font,z=this.lineCap,ne=this.lineWidth,se=this.lineJoin;this.pdf.addPage(),this.fillStyle=j,this.strokeStyle=F,this.font=I,this.lineCap=z,this.lineWidth=ne,this.lineJoin=se},C=function(j,F,I){for(var z=0;z<j.length;z++)switch(j[z].type){case"bct":j[z].x2+=F,j[z].y2+=I;case"qct":j[z].x1+=F,j[z].y1+=I;default:j[z].x+=F,j[z].y+=I}return j},A=function(j){return j.sort(function(F,I){return F-I})},O=function(j,F){var I=this.fillStyle,z=this.strokeStyle,ne=this.lineCap,se=this.lineWidth,je=Math.abs(se*this.ctx.transform.scaleX),Ne=this.lineJoin;if(this.autoPaging){for(var ge,Ie,le=JSON.parse(JSON.stringify(this.path)),Ge=JSON.parse(JSON.stringify(this.path)),rt=[],ue=0;ue<Ge.length;ue++)if(Ge[ue].x!==void 0)for(var ot=w.call(this,Ge[ue]),xe=0;xe<ot.length;xe+=1)rt.indexOf(ot[xe])===-1&&rt.push(ot[xe]);for(var ve=0;ve<rt.length;ve++)for(;this.pdf.internal.getNumberOfPages()<rt[ve];)E.call(this);A(rt);for(var Be=rt[0],jt=rt[rt.length-1],Je=Be;Je<jt+1;Je++){this.pdf.setPage(Je),this.fillStyle=I,this.strokeStyle=z,this.lineCap=ne,this.lineWidth=je,this.lineJoin=Ne;var ct=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],St=Je===1?this.posY+this.margin[0]:this.margin[0],Ft=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Xt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ut=Je===1?0:Ft+(Je-2)*Xt;if(this.ctx.clip_path.length!==0){var Wt=this.path;ge=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(ge,this.posX+this.margin[3],-Ut+St+this.ctx.prevPageLastElemOffset),G.call(this,j,!0),this.path=Wt}if(Ie=JSON.parse(JSON.stringify(le)),this.path=C(Ie,this.posX+this.margin[3],-Ut+St+this.ctx.prevPageLastElemOffset),F===!1||Je===0){var $t=(Je>Be||Je<jt)&&_.call(this);$t&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ct,Xt,null).clip().discardPath()),G.call(this,j,F),$t&&this.pdf.restoreGraphicsState()}this.lineWidth=se}this.path=le}else this.lineWidth=je,G.call(this,j,F),this.lineWidth=se},G=function(j,F){if((j!=="stroke"||F||!b.call(this))&&(j==="stroke"||F||!g.call(this))){for(var I,z,ne=[],se=this.path,je=0;je<se.length;je++){var Ne=se[je];switch(Ne.type){case"begin":ne.push({begin:!0});break;case"close":ne.push({close:!0});break;case"mt":ne.push({start:Ne,deltas:[],abs:[]});break;case"lt":var ge=ne.length;if(se[je-1]&&!isNaN(se[je-1].x)&&(I=[Ne.x-se[je-1].x,Ne.y-se[je-1].y],ge>0)){for(;ge>=0;ge--)if(ne[ge-1].close!==!0&&ne[ge-1].begin!==!0){ne[ge-1].deltas.push(I),ne[ge-1].abs.push(Ne);break}}break;case"bct":I=[Ne.x1-se[je-1].x,Ne.y1-se[je-1].y,Ne.x2-se[je-1].x,Ne.y2-se[je-1].y,Ne.x-se[je-1].x,Ne.y-se[je-1].y],ne[ne.length-1].deltas.push(I);break;case"qct":var Ie=se[je-1].x+2/3*(Ne.x1-se[je-1].x),le=se[je-1].y+2/3*(Ne.y1-se[je-1].y),Ge=Ne.x+2/3*(Ne.x1-Ne.x),rt=Ne.y+2/3*(Ne.y1-Ne.y),ue=Ne.x,ot=Ne.y;I=[Ie-se[je-1].x,le-se[je-1].y,Ge-se[je-1].x,rt-se[je-1].y,ue-se[je-1].x,ot-se[je-1].y],ne[ne.length-1].deltas.push(I);break;case"arc":ne.push({deltas:[],abs:[],arc:!0}),Array.isArray(ne[ne.length-1].abs)&&ne[ne.length-1].abs.push(Ne)}}z=F?null:j==="stroke"?"stroke":"fill";for(var xe=!1,ve=0;ve<ne.length;ve++)if(ne[ve].arc)for(var Be=ne[ve].abs,jt=0;jt<Be.length;jt++){var Je=Be[jt];Je.type==="arc"?q.call(this,Je.x,Je.y,Je.radius,Je.startAngle,Je.endAngle,Je.counterclockwise,void 0,F,!xe):M.call(this,Je.x,Je.y),xe=!0}else if(ne[ve].close===!0)this.pdf.internal.out("h"),xe=!1;else if(ne[ve].begin!==!0){var ct=ne[ve].start.x,St=ne[ve].start.y;V.call(this,ne[ve].deltas,ct,St),xe=!0}z&&L.call(this,z),F&&Z.call(this)}},W=function(j){var F=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,I=F*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return j-I;case"top":return j+F-I;case"hanging":return j+F-2*I;case"middle":return j+F/2-I;default:return j}},B=function(j){return j+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};v.prototype.createLinearGradient=function(){var j=function(){};return j.colorStops=[],j.addColorStop=function(F,I){this.colorStops.push([F,I])},j.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},j.isCanvasGradient=!0,j},v.prototype.createPattern=function(){return this.createLinearGradient()},v.prototype.createRadialGradient=function(){return this.createLinearGradient()};var q=function(j,F,I,z,ne,se,je,Ne,ge){for(var Ie=X.call(this,I,z,ne,se),le=0;le<Ie.length;le++){var Ge=Ie[le];le===0&&(ge?D.call(this,Ge.x1+j,Ge.y1+F):M.call(this,Ge.x1+j,Ge.y1+F)),ie.call(this,j,F,Ge.x2,Ge.y2,Ge.x3,Ge.y3,Ge.x4,Ge.y4)}Ne?Z.call(this):L.call(this,je)},L=function(j){switch(j){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Z=function(){this.pdf.clip(),this.pdf.discardPath()},D=function(j,F){this.pdf.internal.out(r(j)+" "+a(F)+" m")},T=function(j){var F;switch(j.align){case"right":case"end":F="right";break;case"center":F="center";break;default:F="left"}var I,z,ne,se=this.pdf.getTextDimensions(j.text),je=W.call(this,j.y),Ne=B.call(this,je)-se.h,ge=this.ctx.transform.applyToPoint(new l(j.x,je));if(this.autoPaging){var Ie=this.ctx.transform.decompose(),le=new d;le=(le=(le=le.multiply(Ie.translate)).multiply(Ie.skew)).multiply(Ie.scale);for(var Ge=this.ctx.transform.applyToRectangle(new c(j.x,je,se.w,se.h)),rt=le.applyToRectangle(new c(j.x,Ne,se.w,se.h)),ue=w.call(this,rt),ot=[],xe=0;xe<ue.length;xe+=1)ot.indexOf(ue[xe])===-1&&ot.push(ue[xe]);A(ot);for(var ve=ot[0],Be=ot[ot.length-1],jt=ve;jt<Be+1;jt++){this.pdf.setPage(jt);var Je=jt===1?this.posY+this.margin[0]:this.margin[0],ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],St=this.pdf.internal.pageSize.height-this.margin[2],Ft=St-this.margin[0],Xt=this.pdf.internal.pageSize.width-this.margin[1],Ut=Xt-this.margin[3],Wt=jt===1?0:ct+(jt-2)*Ft;if(this.ctx.clip_path.length!==0){var $t=this.path;I=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(I,this.posX+this.margin[3],-1*Wt+Je),G.call(this,"fill",!0),this.path=$t}var wt=C([JSON.parse(JSON.stringify(rt))],this.posX+this.margin[3],-Wt+Je+this.ctx.prevPageLastElemOffset)[0];j.scale>=.01&&(z=this.pdf.internal.getFontSize(),this.pdf.setFontSize(z*j.scale),ne=this.lineWidth,this.lineWidth=ne*j.scale);var Ce=this.autoPaging!=="text";if(Ce||wt.y+wt.h<=St){if(Ce||wt.y>=Je&&wt.x<=Xt){var st=Ce?j.text:this.pdf.splitTextToSize(j.text,j.maxWidth||Xt-wt.x)[0],Dt=C([JSON.parse(JSON.stringify(Ge))],this.posX+this.margin[3],-Wt+Je+this.ctx.prevPageLastElemOffset)[0],At=Ce&&(jt>ve||jt<Be)&&_.call(this);At&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ut,Ft,null).clip().discardPath()),this.pdf.text(st,Dt.x,Dt.y,{angle:j.angle,align:F,renderingMode:j.renderingMode}),At&&this.pdf.restoreGraphicsState()}}else wt.y<St&&(this.ctx.prevPageLastElemOffset+=St-wt.y);j.scale>=.01&&(this.pdf.setFontSize(z),this.lineWidth=ne)}}else j.scale>=.01&&(z=this.pdf.internal.getFontSize(),this.pdf.setFontSize(z*j.scale),ne=this.lineWidth,this.lineWidth=ne*j.scale),this.pdf.text(j.text,ge.x+this.posX,ge.y+this.posY,{angle:j.angle,align:F,renderingMode:j.renderingMode,maxWidth:j.maxWidth}),j.scale>=.01&&(this.pdf.setFontSize(z),this.lineWidth=ne)},M=function(j,F,I,z){I=I||0,z=z||0,this.pdf.internal.out(r(j+I)+" "+a(F+z)+" l")},V=function(j,F,I){return this.pdf.lines(j,F,I,null,null)},ie=function(j,F,I,z,ne,se,je,Ne){this.pdf.internal.out([e(n(I+j)),e(s(z+F)),e(n(ne+j)),e(s(se+F)),e(n(je+j)),e(s(Ne+F)),"c"].join(" "))},X=function(j,F,I,z){for(var ne=2*Math.PI,se=Math.PI/2;F>I;)F-=ne;var je=Math.abs(I-F);je<ne&&z&&(je=ne-je);for(var Ne=[],ge=z?-1:1,Ie=F;je>1e-5;){var le=Ie+ge*Math.min(je,se);Ne.push(J.call(this,j,Ie,le)),je-=Math.abs(le-Ie),Ie=le}return Ne},J=function(j,F,I){var z=(I-F)/2,ne=j*Math.cos(z),se=j*Math.sin(z),je=ne,Ne=-se,ge=je*je+Ne*Ne,Ie=ge+je*ne+Ne*se,le=4/3*(Math.sqrt(2*ge*Ie)-Ie)/(je*se-Ne*ne),Ge=je-le*Ne,rt=Ne+le*je,ue=Ge,ot=-rt,xe=z+F,ve=Math.cos(xe),Be=Math.sin(xe);return{x1:j*Math.cos(F),y1:j*Math.sin(F),x2:Ge*ve-rt*Be,y2:Ge*Be+rt*ve,x3:ue*ve-ot*Be,y3:ue*Be+ot*ve,x4:j*Math.cos(I),y4:j*Math.sin(I)}},K=function(j){return 180*j/Math.PI},te=function(j,F,I,z,ne,se){var je=j+.5*(I-j),Ne=F+.5*(z-F),ge=ne+.5*(I-ne),Ie=se+.5*(z-se),le=Math.min(j,ne,je,ge),Ge=Math.max(j,ne,je,ge),rt=Math.min(F,se,Ne,Ie),ue=Math.max(F,se,Ne,Ie);return new c(le,rt,Ge-le,ue-rt)},fe=function(j,F,I,z,ne,se,je,Ne){var ge,Ie,le,Ge,rt,ue,ot,xe,ve,Be,jt,Je,ct,St,Ft=I-j,Xt=z-F,Ut=ne-I,Wt=se-z,$t=je-ne,wt=Ne-se;for(Ie=0;Ie<41;Ie++)ve=(ot=(le=j+(ge=Ie/40)*Ft)+ge*((rt=I+ge*Ut)-le))+ge*(rt+ge*(ne+ge*$t-rt)-ot),Be=(xe=(Ge=F+ge*Xt)+ge*((ue=z+ge*Wt)-Ge))+ge*(ue+ge*(se+ge*wt-ue)-xe),Ie==0?(jt=ve,Je=Be,ct=ve,St=Be):(jt=Math.min(jt,ve),Je=Math.min(Je,Be),ct=Math.max(ct,ve),St=Math.max(St,Be));return new c(Math.round(jt),Math.round(Je),Math.round(ct-jt),Math.round(St-Je))},U=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var j,F,I=(j=this.ctx.lineDash,F=this.ctx.lineDashOffset,JSON.stringify({lineDash:j,lineDashOffset:F}));this.prevLineDash!==I&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=I)}}})(ur.API),(function(t){var e=function(l){var c,d,f,m,v,x,g,b,_,w;for(d=[],f=0,m=(l+=c="\0\0\0\0".slice(l.length%4||4)).length;m>f;f+=4)(v=(l.charCodeAt(f)<<24)+(l.charCodeAt(f+1)<<16)+(l.charCodeAt(f+2)<<8)+l.charCodeAt(f+3))!==0?(x=(v=((v=((v=((v=(v-(w=v%85))/85)-(_=v%85))/85)-(b=v%85))/85)-(g=v%85))/85)%85,d.push(x+33,g+33,b+33,_+33,w+33)):d.push(122);return(function(E,C){for(var A=C;A>0;A--)E.pop()})(d,c.length),String.fromCharCode.apply(String,d)+"~>"},r=function(l){var c,d,f,m,v,x=String,g="length",b=255,_="charCodeAt",w="slice",E="replace";for(l[w](-2),l=l[w](0,-2)[E](/\s/g,"")[E]("z","!!!!!"),f=[],m=0,v=(l+=c="uuuuu"[w](l[g]%5||5))[g];v>m;m+=5)d=52200625*(l[_](m)-33)+614125*(l[_](m+1)-33)+7225*(l[_](m+2)-33)+85*(l[_](m+3)-33)+(l[_](m+4)-33),f.push(b&d>>24,b&d>>16,b&d>>8,b&d);return(function(C,A){for(var O=A;O>0;O--)C.pop()})(f,c[g]),x.fromCharCode.apply(x,f)},a=function(l){return l.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">"},n=function(l){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((l=l.replace(/\s/g,"")).indexOf(">")!==-1&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),c.test(l)===!1)return"";for(var d="",f=0;f<l.length;f+=2)d+=String.fromCharCode("0x"+(l[f]+l[f+1]));return d},s=function(l){for(var c=new Uint8Array(l.length),d=l.length;d--;)c[d]=l.charCodeAt(d);return(c=Px(c)).reduce(function(f,m){return f+String.fromCharCode(m)},"")};t.processDataByFilters=function(l,c){var d=0,f=l||"",m=[];for(typeof(c=c||[])=="string"&&(c=[c]),d=0;d<c.length;d+=1)switch(c[d]){case"ASCII85Decode":case"/ASCII85Decode":f=r(f),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=e(f),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=n(f),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=a(f),m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=s(f),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[d]+'" is not implemented')}return{data:f,reverseChain:m.reverse().join(" ")}}})(ur.API),(function(t){t.loadFile=function(e,r,a){return(function(n,s,l){s=s!==!1,l=typeof l=="function"?l:function(){};var c=void 0;try{c=(function(d,f,m){var v=new XMLHttpRequest,x=0,g=function(b){var _=b.length,w=[],E=String.fromCharCode;for(x=0;x<_;x+=1)w.push(E(255&b.charCodeAt(x)));return w.join("")};if(v.open("GET",d,!f),v.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(v.onload=function(){v.status===200?m(g(this.responseText)):m(void 0)}),v.send(null),f&&v.status===200)return g(v.responseText)})(n,s,l)}catch{}return c})(e,r,a)},t.loadImageFile=t.loadFile})(ur.API),(function(t){function e(){return(kr.html2canvas?Promise.resolve(kr.html2canvas):wv(()=>import("./html2canvas.esm-Ge7aVWlp.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function r(){return(kr.DOMPurify?Promise.resolve(kr.DOMPurify):wv(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var a=function(c){var d=xa(c);return d==="undefined"?"undefined":d==="string"||c instanceof String?"string":d==="number"||c instanceof Number?"number":d==="function"||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&c.nodeType===1?"element":d==="object"?"object":"unknown"},n=function(c,d){var f=document.createElement(c);for(var m in d.className&&(f.className=d.className),d.innerHTML&&d.dompurify&&(f.innerHTML=d.dompurify.sanitize(d.innerHTML)),d.style)f.style[m]=d.style[m];return f},s=function c(d,f){for(var m=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),v=d.firstChild;v;v=v.nextSibling)f!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||m.appendChild(c(v,f));return d.nodeType===1&&(d.nodeName==="CANVAS"?(m.width=d.width,m.height=d.height,m.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(m.value=d.value),m.addEventListener("load",function(){m.scrollTop=d.scrollTop,m.scrollLeft=d.scrollLeft},!0)),m},l=function c(d){var f=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),m=c.convert(Promise.resolve(),f);return(m=m.setProgress(1,c,1,[c])).set(d)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(c,d){return c.__proto__=d||l.prototype,c},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(c,d){return this.then(function(){switch(d=d||(function(f){switch(a(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(c),d){case"string":return this.then(r).then(function(f){return this.set({src:n("div",{innerHTML:c,dompurify:f})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},l.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},d=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);d.tagName==="BODY"&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(d),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(d){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,d(this.prop.container,f)}).then(function(d){(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(d){var f=this.opt.jsPDF,m=this.opt.fontFaces,v=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:v,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=m,m)for(var g=0;g<m.length;++g){var b=m[g],_=b.src.find(function(w){return w.format==="truetype"});_&&f.addFont(_.url,b.ref.name,b.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,f.context2d.save(!0),d(this.prop.container,x)}).then(function(d){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(c,d,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(c,d):this.outputPdf(c,d)},l.prototype.outputPdf=function(c,d){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,d)})},l.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},l.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(c){if(a(c)!=="object")return this;var d=Object.keys(c||{}).map(function(f){if(f in l.template.prop)return function(){this.prop[f]=c[f]};switch(f){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[f]=c[f]}}},this);return this.then(function(){return this.thenList(d)})},l.prototype.get=function(c,d){return this.then(function(){var f=c in l.template.prop?this.prop[c]:this.opt[c];return d?d(f):f})},l.prototype.setMargin=function(c){return this.then(function(){switch(a(c)){case"number":c=[c,c,c,c];case"array":if(c.length===2&&(c=[c[0],c[1],c[0],c[1]]),c.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},l.prototype.setPageSize=function(c){function d(f,m){return Math.floor(f*m/72*96)}return this.then(function(){(c=c||ur.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:d(c.inner.width,c.k),height:d(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},l.prototype.setProgress=function(c,d,f,m){return c!=null&&(this.progress.val=c),d!=null&&(this.progress.state=d),f!=null&&(this.progress.n=f),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(c,d,f,m){return this.setProgress(c?this.progress.val+c:null,d||null,f?this.progress.n+f:null,m?this.progress.stack.concat(m):null)},l.prototype.then=function(c,d){var f=this;return this.thenCore(c,d,function(m,v){return f.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(x){return f.updateProgress(null,m),x}).then(m,v).then(function(x){return f.updateProgress(1),x})})},l.prototype.thenCore=function(c,d,f){f=f||Promise.prototype.then;var m=this;c&&(c=c.bind(m)),d&&(d=d.bind(m));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?m:l.convert(Object.assign({},m),Promise.prototype),x=f.call(v,c,d);return l.convert(x,m.__proto__)},l.prototype.thenExternal=function(c,d){return Promise.prototype.then.call(this,c,d)},l.prototype.thenList=function(c){var d=this;return c.forEach(function(f){d=d.thenCore(f)}),d},l.prototype.catch=function(c){c&&(c=c.bind(this));var d=Promise.prototype.catch.call(this,c);return l.convert(d,this)},l.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},l.prototype.error=function(c){return this.then(function(){throw new Error(c)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,ur.getPageSize=function(c,d,f){if(xa(c)==="object"){var m=c;c=m.orientation,d=m.unit||d,f=m.format||f}d=d||"mm",f=f||"a4",c=(""+(c||"P")).toLowerCase();var v,x=(""+f).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(d){case"pt":v=1;break;case"mm":v=72/25.4;break;case"cm":v=72/2.54;break;case"in":v=72;break;case"px":v=.75;break;case"pc":case"em":v=12;break;case"ex":v=6;break;default:throw"Invalid unit: "+d}var b,_=0,w=0;if(g.hasOwnProperty(x))_=g[x][1]/v,w=g[x][0]/v;else try{_=f[1],w=f[0]}catch{throw new Error("Invalid format: "+f)}if(c==="p"||c==="portrait")c="p",w>_&&(b=w,w=_,_=b);else{if(c!=="l"&&c!=="landscape")throw"Invalid orientation: "+c;c="l",_>w&&(b=w,w=_,_=b)}return{width:w,height:_,unit:d,k:v,orientation:c}},t.html=function(c,d){(d=d||{}).callback=d.callback||function(){},d.html2canvas=d.html2canvas||{},d.html2canvas.canvas=d.html2canvas.canvas||this.canvas,d.jsPDF=d.jsPDF||this,d.fontFaces=d.fontFaces?d.fontFaces.map(Uv):null;var f=new l(d);return d.worker?f:f.from(c).doCallback()}})(ur.API),ur.API.addJS=function(t){return jS=t,this.internal.events.subscribe("postPutResources",function(){Op=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Op+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),NS=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+jS+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Op!==void 0&&NS!==void 0&&this.internal.out("/Names <</JavaScript "+Op+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),s=0;s<n.length;s++){var l=n[s],c=a.exec(l);if(c!=null){var d=c[1];r.internal.newObjectDeferredBegin(d,!1)}r.internal.write(l)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,m=[];for(s=0;s<f;s++){var v=r.internal.newObject();m.push(v);var x=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var g=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<m.length;s++)r.internal.write("(page_"+(s+1)+")"+m[s]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+g+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,s){var l={title:n,options:s,children:[]};return a==null&&(a=this.root),a.children.push(l),l},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<a.children.length;s++){var l=a.children[s];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(a)),s>0&&this.line("/Prev "+this.makeRef(a.children[s-1])),s<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[s+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var c=this.count=this.count_r({count:0},l);if(c>0&&this.line("/Count "+c),l.options&&l.options.pageNumber){var d=r.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+d.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var f=0;f<a.children.length;f++)this.renderItems(a.children[f])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var s=0;s<n.children.length;s++)a.count++,this.count_r(a,n.children[s]);return a.count}}])})(ur.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,a,n,s,l,c){var d,f=this.decode.DCT_DECODE,m=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=l||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,d=(function(v){for(var x,g=256*v.charCodeAt(4)+v.charCodeAt(5),b=v.length,_={width:0,height:0,numcomponents:1},w=4;w<b;w+=2){if(w+=g,e.indexOf(v.charCodeAt(w+1))!==-1){x=256*v.charCodeAt(w+5)+v.charCodeAt(w+6),_={width:256*v.charCodeAt(w+7)+v.charCodeAt(w+8),height:x,numcomponents:v.charCodeAt(w+9)};break}g=256*v.charCodeAt(w+2)+v.charCodeAt(w+3)}return _})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),d.numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}m={data:r,width:d.width,height:d.height,colorSpace:c,bitsPerComponent:8,filter:f,index:a,alias:n}}return m}})(ur.API),ur.API.processPNG=function(t,e,r,a){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var n,s=bz(t,{checkCrc:!0}),l=s.width,c=s.height,d=s.channels,f=s.palette,m=s.depth;n=f&&d===1?(function(q){for(var L=q.width,Z=q.height,D=q.data,T=q.palette,M=q.depth,V=!1,ie=[],X=[],J=void 0,K=!1,te=0,fe=0;fe<T.length;fe++){var U=C5(T[fe],4),j=U[0],F=U[1],I=U[2],z=U[3];ie.push(j,F,I),z!=null&&(z===0?(te++,X.length<1&&X.push(fe)):z<255&&(K=!0))}if(K||te>1){V=!0,X=void 0;var ne=L*Z;J=new Uint8Array(ne);for(var se=new DataView(D.buffer),je=0;je<ne;je++){var Ne=zv(se,je,M),ge=C5(T[Ne],4)[3];J[je]=ge}}else te===0&&(X=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:V?8:void 0,colorBytes:D,alphaBytes:J,needSMask:V,palette:ie,mask:X}})(s):d===2||d===4?(function(q){for(var L=q.data,Z=q.width,D=q.height,T=q.channels,M=q.depth,V=T===2?"DeviceGray":"DeviceRGB",ie=T-1,X=Z*D,J=ie,K=X*J,te=1*X,fe=Math.ceil(K*M/8),U=Math.ceil(te*M/8),j=new Uint8Array(fe),F=new Uint8Array(U),I=new DataView(L.buffer),z=new DataView(j.buffer),ne=new DataView(F.buffer),se=!1,je=0;je<X;je++){for(var Ne=je*T,ge=0;ge<J;ge++)FS(z,zv(I,Ne+ge,M),je*J+ge,M);var Ie=zv(I,Ne+J,M);Ie<(1<<M)-1&&(se=!0),FS(ne,Ie,1*je,M)}return{colorSpace:V,colorsPerPixel:ie,sMaskBitsPerComponent:se?M:void 0,colorBytes:j,alphaBytes:F,needSMask:se}})(s):(function(q){var L=q.data,Z=q.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:Z,colorsPerPixel:Z==="DeviceGray"?1:3,colorBytes:L instanceof Uint16Array?(function(D){for(var T=D.length,M=new Uint8Array(2*T),V=new DataView(M.buffer,M.byteOffset,M.byteLength),ie=0;ie<T;ie++)V.setUint16(2*ie,D[ie],!1);return M})(L):L,needSMask:!1}})(s);var v,x,g,b=n,_=b.colorSpace,w=b.colorsPerPixel,E=b.sMaskBitsPerComponent,C=b.colorBytes,A=b.alphaBytes,O=b.needSMask,G=b.palette,W=b.mask,B=null;return a!==ur.API.image_compression.NONE&&typeof Px=="function"?(B=(function(q){var L;switch(q){case ur.API.image_compression.FAST:L=11;break;case ur.API.image_compression.MEDIUM:L=13;break;case ur.API.image_compression.SLOW:L=14;break;default:L=12}return L})(a),v=this.decode.FLATE_DECODE,x="/Predictor ".concat(B," /Colors ").concat(w," /BitsPerComponent ").concat(m," /Columns ").concat(l),t=CS(C,Math.ceil(l*w*m/8),w,m,a),O&&(g=CS(A,Math.ceil(l*E/8),1,E,a))):(v=void 0,x=void 0,t=C,O&&(g=A)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(g&&this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),{alias:r,data:t,index:e,filter:v,decodeParameters:x,transparency:W,palette:G,sMask:g,predictor:B,width:l,height:c,bitsPerComponent:m,sMaskBitsPerComponent:E,colorSpace:_}}},(function(t){t.processGIF89A=function(e,r,a,n){var s=new zz(e),l=s.width,c=s.height,d=[];s.decodeAndBlitFrameRGBA(0,d);var f={data:d,width:l,height:c},m=new Hv(100).encode(f,100);return t.processJPEG.call(this,m,r,a,n)},t.processGIF87A=t.processGIF89A})(ur.API),$o.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:n,green:a,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},$o.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Oa.log("bit decode error:"+r)}},$o.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var a=this.bottom_up?t:this.height-1-t,n=0;n<e;n++)for(var s=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+8*n*4,c=0;c<8&&8*n+c<this.width;c++){var d=this.palette[s>>7-c&1];this.data[l+4*c]=d.blue,this.data[l+4*c+1]=d.green,this.data[l+4*c+2]=d.red,this.data[l+4*c+3]=255}r!==0&&(this.pos+=4-r)}},$o.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<t;n++){var s=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+2*n*4,c=s>>4,d=15&s,f=this.palette[c];if(this.data[l]=f.blue,this.data[l+1]=f.green,this.data[l+2]=f.red,this.data[l+3]=255,2*n+1>=this.width)break;f=this.palette[d],this.data[l+4]=f.blue,this.data[l+4+1]=f.green,this.data[l+4+2]=f.red,this.data[l+4+3]=255}e!==0&&(this.pos+=4-e)}},$o.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*a;if(n<this.palette.length){var l=this.palette[n];this.data[s]=l.red,this.data[s+1]=l.green,this.data[s+2]=l.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},$o.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&e)/e*255|0,c=(s>>5&e)/e*255|0,d=(s>>10&e)/e*255|0,f=s>>15?255:0,m=a*this.width*4+4*n;this.data[m]=d,this.data[m+1]=c,this.data[m+2]=l,this.data[m+3]=f}this.pos+=t}},$o.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,s=0;s<this.width;s++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(l&e)/e*255|0,d=(l>>5&r)/r*255|0,f=(l>>11)/e*255|0,m=n*this.width*4+4*s;this.data[m]=f,this.data[m+1]=d,this.data[m+2]=c,this.data[m+3]=255}this.pos+=t}},$o.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=s,this.data[l+1]=n,this.data[l+2]=a,this.data[l+3]=255}this.pos+=this.width%4}},$o.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),c=e*this.width*4+4*r;this.data[c]=s,this.data[c+1]=n,this.data[c+2]=a,this.data[c+3]=l}},$o.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,a,n){var s=new $o(e,!1),l=s.width,c=s.height,d={data:s.getData(),width:l,height:c},f=new Hv(100).encode(d,100);return t.processJPEG.call(this,f,r,a,n)}})(ur.API),PS.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,a,n){var s=new PS(e),l=s.width,c=s.height,d={data:s.getData(),width:l,height:c},f=new Hv(100).encode(d,100);return t.processJPEG.call(this,f,r,a,n)}})(ur.API),ur.API.processRGBA=function(t,e,r){for(var a=t.data,n=a.length,s=new Uint8Array(n/4*3),l=new Uint8Array(n/4),c=0,d=0,f=0;f<n;f+=4){var m=a[f],v=a[f+1],x=a[f+2],g=a[f+3];s[c++]=m,s[c++]=v,s[c++]=x,l[d++]=g}var b=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:b,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},ur.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Hf=ur.API,Rp=Hf.getCharWidthsArray=function(t,e){var r,a,n=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),l=e.charSpace||this.internal.getCharSpace(),c=e.widths?e.widths:n.metadata.Unicode.widths,d=c.fof?c.fof:1,f=e.kerning?e.kerning:n.metadata.Unicode.kerning,m=f.fof?f.fof:1,v=e.doKerning!==!1,x=0,g=t.length,b=0,_=c[0]||d,w=[];for(r=0;r<g;r++)a=t.charCodeAt(r),typeof n.metadata.widthOfString=="function"?w.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+l*(1e3/s)||0)/1e3):(x=v&&xa(f[a])==="object"&&!isNaN(parseInt(f[a][b],10))?f[a][b]/m:0,w.push((c[a]||_)/d+x)),b=a;return w},kS=Hf.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),a=e.font||this.internal.getFont(),n=e.charSpace||this.internal.getCharSpace();return Hf.processArabic&&(t=Hf.processArabic(t)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(t,r,n)/r:Rp.apply(this,arguments).reduce(function(s,l){return s+l},0)},ES=function(t,e,r,a){for(var n=[],s=0,l=t.length,c=0;s!==l&&c+e[s]<r;)c+=e[s],s++;n.push(t.slice(0,s));var d=s;for(c=0;s!==l;)c+e[s]>a&&(n.push(t.slice(d,s)),c=0,d=s),c+=e[s],s++;return d!==s&&n.push(t.slice(d,s)),n},AS=function(t,e,r){r||(r={});var a,n,s,l,c,d,f,m=[],v=[m],x=r.textIndent||0,g=0,b=0,_=t.split(" "),w=Rp.apply(this,[" ",r])[0];if(d=r.lineIndent===-1?_[0].length+2:r.lineIndent||0){var E=Array(d).join(" "),C=[];_.map(function(O){(O=O.split(/\s*\n/)).length>1?C=C.concat(O.map(function(G,W){return(W&&G.length?`
`:"")+G})):C.push(O[0])}),_=C,d=kS.apply(this,[E,r])}for(s=0,l=_.length;s<l;s++){var A=0;if(a=_[s],d&&a[0]==`
`&&(a=a.substr(1),A=1),x+g+(b=(n=Rp.apply(this,[a,r])).reduce(function(O,G){return O+G},0))>e||A){if(b>e){for(c=ES.apply(this,[a,n,e-(x+g),e]),m.push(c.shift()),m=[c.pop()];c.length;)v.push([c.shift()]);b=n.slice(a.length-(m[0]?m[0].length:0)).reduce(function(O,G){return O+G},0)}else m=[a];v.push(m),x=b+d,g=w}else m.push(a),x+=g+b,g=w}return f=d?function(O,G){return(G?E:"")+O.join(" ")}:function(O){return O.join(" ")},v.map(f)},Hf.splitTextToSize=function(t,e,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var v=this.internal.getFont(m.fontName,m.fontStyle),x="Unicode";return v.metadata[x]?{widths:v.metadata[x].widths||{0:1},kerning:v.metadata[x].kerning||{}}:{font:v.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(t)?t:String(t).split(/\r?\n/);var l=1*this.internal.scaleFactor*e/n;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=r.lineIndent;var c,d,f=[];for(c=0,d=a.length;c<d;c++)f=f.concat(AS.apply(this,[a[c],l,s]));return f},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",a={},n={},s=0;s<16;s++)a[r[s]]=e[s],n[e[s]]=r[s];var l=function(x){return"0x"+parseInt(x,10).toString(16)},c=t.__fontmetrics__.compress=function(x){var g,b,_,w,E=["{"];for(var C in x){if(g=x[C],isNaN(parseInt(C,10))?b="'"+C+"'":(C=parseInt(C,10),b=(b=l(C).slice(2)).slice(0,-1)+n[b.slice(-1)]),typeof g=="number")g<0?(_=l(g).slice(3),w="-"):(_=l(g).slice(2),w=""),_=w+_.slice(0,-1)+n[_.slice(-1)];else{if(xa(g)!=="object")throw new Error("Don't know what to do with value type "+xa(g)+".");_=c(g)}E.push(b+_)}return E.push("}"),E.join("")},d=t.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,b,_,w,E={},C=1,A=E,O=[],G="",W="",B=x.length-1,q=1;q<B;q+=1)(w=x[q])=="'"?g?(_=g.join(""),g=void 0):g=[]:g?g.push(w):w=="{"?(O.push([A,_]),A={},_=void 0):w=="}"?((b=O.pop())[0][b[1]]=A,_=void 0,A=b[0]):w=="-"?C=-1:_===void 0?a.hasOwnProperty(w)?(G+=a[w],_=parseInt(G,16)*C,C=1,G=""):G+=w:a.hasOwnProperty(w)?(W+=a[w],A[_]=parseInt(W,16)*C,C=1,_=void 0,W=""):W+=w;return E},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:d("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},v={Unicode:{"Courier-Oblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":d("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":d("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:d("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:d("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":d("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":d("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(x){var g=x.font,b=v.Unicode[g.postScriptName];b&&(g.metadata.Unicode={},g.metadata.Unicode.widths=b.widths,g.metadata.Unicode.kerning=b.kerning);var _=m.Unicode[g.postScriptName];_&&(g.metadata.Unicode.encoding=_,g.encoding=_.codePages[0])}])})(ur.API),(function(t){var e=function(r){for(var a=r.length,n=new Uint8Array(a),s=0;s<a;s++)n[s]=r.charCodeAt(s);return n};t.API.events.push(["addFont",function(r){var a=void 0,n=r.font,s=r.instance;if(!n.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=s.existsFileInVFS(n.postScriptName)===!1?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(l,c){c=/^\x00\x01\x00\x00/.test(c)?e(c):e(Bp(c)),l.metadata=t.API.TTFFont.open(c),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(n,a)}}])})(ur),ur.API.addSvgAsImage=function(t,e,r,a,n,s,l,c){if(isNaN(e)||isNaN(r))throw Oa.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(n))throw Oa.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=a,d.height=n;var f=d.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,d.width,d.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},v=this;return(kr.canvg?Promise.resolve(kr.canvg):wv(()=>import("./index.es-C8PJcEdC.js"),[])).catch(function(x){return Promise.reject(new Error("Could not load canvg: "+x))}).then(function(x){return x.default?x.default:x}).then(function(x){return x.fromString(f,t,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(x){return x.render(m)}).then(function(){v.addImage(d.toDataURL("image/jpeg",1),e,r,a,n,l,c)})},ur.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(e,r);return this},ur.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var a,n,s,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(l),d=[],f=0,m=0,v=0;function x(b,_){var w,E=!1;for(w=0;w<b.length;w+=1)b[w]===_&&(E=!0);return E}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var g=c.length;for(v=0;v<g;v+=1)r[c[v]].value=r[c[v]].defaultValue,r[c[v]].explicitSet=!1}if(xa(t)==="object"){for(n in t)if(s=t[n],x(c,n)&&s!==void 0){if(r[n].type==="boolean"&&typeof s=="boolean")r[n].value=s;else if(r[n].type==="name"&&x(r[n].valueSet,s))r[n].value=s;else if(r[n].type==="integer"&&Number.isInteger(s))r[n].value=s;else if(r[n].type==="array"){for(f=0;f<s.length;f+=1)if(a=!0,s[f].length===1&&typeof s[f][0]=="number")d.push(String(s[f]-1));else if(s[f].length>1){for(m=0;m<s[f].length;m+=1)typeof s[f][m]!="number"&&(a=!1);a===!0&&d.push([s[f][0]-1,s[f][1]-1].join(" "))}r[n].value="["+d.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,_=[];for(b in r)r[b].explicitSet===!0&&(r[b].type==="name"?_.push("/"+b+" /"+r[b].value):_.push("/"+b+" "+r[b].value));_.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+_.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(a)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),d=unescape(encodeURIComponent("</x:xmpmeta>")),f=s.length+l.length+c.length+n.length+d.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(n+s+l+c+d),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(ur.API),(function(t){var e=t.API,r=e.pdfEscape16=function(s,l){for(var c,d=l.metadata.Unicode.widths,f=["","0","00","000","0000"],m=[""],v=0,x=s.length;v<x;++v){if(c=l.metadata.characterToGlyph(s.charCodeAt(v)),l.metadata.glyIdsUsed.push(c),l.metadata.toUnicode[c]=s.charCodeAt(v),d.indexOf(c)==-1&&(d.push(c),d.push([parseInt(l.metadata.widthOfGlyph(c),10)])),c=="0")return m.join("");c=c.toString(16),m.push(f[4-c.length],c)}return m.join("")},a=function(s){var l,c,d,f,m,v,x;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,d=[],v=0,x=(c=Object.keys(s).sort(function(g,b){return g-b})).length;v<x;v++)l=c[v],d.length>=100&&(m+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar`,d=[]),s[l]!==void 0&&s[l]!==null&&typeof s[l].toString=="function"&&(f=("0000"+s[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),d.push("<"+l+"><"+f+">"));return d.length&&(m+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar
`),m+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(l){var c=l.font,d=l.out,f=l.newObject,m=l.putStream;if(c.metadata instanceof t.API.TTFFont&&c.encoding==="Identity-H"){for(var v=c.metadata.Unicode.widths,x=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),g="",b=0;b<x.length;b++)g+=String.fromCharCode(x[b]);var _=f();m({data:g,addLength1:!0,objectId:_}),d("endobj");var w=f();m({data:a(c.metadata.toUnicode),addLength1:!0,objectId:w}),d("endobj");var E=f();d("<<"),d("/Type /FontDescriptor"),d("/FontName /"+Yf(c.fontName)),d("/FontFile2 "+_+" 0 R"),d("/FontBBox "+t.API.PDFObject.convert(c.metadata.bbox)),d("/Flags "+c.metadata.flags),d("/StemV "+c.metadata.stemV),d("/ItalicAngle "+c.metadata.italicAngle),d("/Ascent "+c.metadata.ascender),d("/Descent "+c.metadata.decender),d("/CapHeight "+c.metadata.capHeight),d(">>"),d("endobj");var C=f();d("<<"),d("/Type /Font"),d("/BaseFont /"+Yf(c.fontName)),d("/FontDescriptor "+E+" 0 R"),d("/W "+t.API.PDFObject.convert(v)),d("/CIDToGIDMap /Identity"),d("/DW 1000"),d("/Subtype /CIDFontType2"),d("/CIDSystemInfo"),d("<<"),d("/Supplement 0"),d("/Registry (Adobe)"),d("/Ordering ("+c.encoding+")"),d(">>"),d(">>"),d("endobj"),c.objectNumber=f(),d("<<"),d("/Type /Font"),d("/Subtype /Type0"),d("/ToUnicode "+w+" 0 R"),d("/BaseFont /"+Yf(c.fontName)),d("/Encoding /"+c.encoding),d("/DescendantFonts ["+C+" 0 R]"),d(">>"),d("endobj"),c.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(l){var c=l.font,d=l.out,f=l.newObject,m=l.putStream;if(c.metadata instanceof t.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var v=c.metadata.rawData,x="",g=0;g<v.length;g++)x+=String.fromCharCode(v[g]);var b=f();m({data:x,addLength1:!0,objectId:b}),d("endobj");var _=f();m({data:a(c.metadata.toUnicode),addLength1:!0,objectId:_}),d("endobj");var w=f();d("<<"),d("/Descent "+c.metadata.decender),d("/CapHeight "+c.metadata.capHeight),d("/StemV "+c.metadata.stemV),d("/Type /FontDescriptor"),d("/FontFile2 "+b+" 0 R"),d("/Flags 96"),d("/FontBBox "+t.API.PDFObject.convert(c.metadata.bbox)),d("/FontName /"+Yf(c.fontName)),d("/ItalicAngle "+c.metadata.italicAngle),d("/Ascent "+c.metadata.ascender),d(">>"),d("endobj"),c.objectNumber=f();for(var E=0;E<c.metadata.hmtx.widths.length;E++)c.metadata.hmtx.widths[E]=parseInt(c.metadata.hmtx.widths[E]*(1e3/c.metadata.head.unitsPerEm));d("<</Subtype/TrueType/Type/Font/ToUnicode "+_+" 0 R/BaseFont/"+Yf(c.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),d("endobj"),c.isAlreadyPutted=!0}})(s)}]);var n=function(s){var l,c=s.text||"",d=s.x,f=s.y,m=s.options||{},v=s.mutex||{},x=v.pdfEscape,g=v.activeFontKey,b=v.fonts,_=g,w="",E=0,C="",A=b[_].encoding;if(b[_].encoding!=="Identity-H")return{text:c,x:d,y:f,options:m,mutex:v};for(C=c,_=g,Array.isArray(c)&&(C=c[0]),E=0;E<C.length;E+=1)b[_].metadata.hasOwnProperty("cmap")&&(l=b[_].metadata.cmap.unicode.codeMap[C[E].charCodeAt(0)]),l||C[E].charCodeAt(0)<256&&b[_].metadata.hasOwnProperty("Unicode")?w+=C[E]:w+="";var O="";return parseInt(_.slice(1))<14||A==="WinAnsiEncoding"?O=x(w,_).split("").map(function(G){return G.charCodeAt(0).toString(16)}).join(""):A==="Identity-H"&&(O=r(w,b[_])),v.isHex=!0,{text:O,x:d,y:f,options:m,mutex:v}};e.events.push(["postProcessText",function(s){var l=s.text||"",c=[],d={text:l,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(l)){var f=0;for(f=0;f<l.length;f+=1)Array.isArray(l[f])&&l[f].length===3?c.push([n(Object.assign({},d,{text:l[f][0]})).text,l[f][1],l[f][2]]):c.push(n(Object.assign({},d,{text:l[f]})).text);s.text=c}else s.text=n(Object.assign({},d,{text:l})).text}])})(ur),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,a){return e.call(this),this.internal.vFS[r]=a,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(ur.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(a){var n,s,l,c,d,f,m,v=e,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],E=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),C=!1,A=0;this.__bidiEngine__={};var O=function(D){var T=D.charCodeAt(),M=T>>8,V=_[M];return V!==void 0?v[256*V+(255&T)]:M===252||M===253?"AL":E.test(M)?"L":M===8?"R":"N"},G=function(D){for(var T,M=0;M<D.length;M++){if((T=O(D.charAt(M)))==="L")return!1;if(T==="R")return!0}return!1},W=function(D,T,M,V){var ie,X,J,K,te=T[V];switch(te){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":C=!1;break;case"N":case"AN":break;case"EN":C&&(te="AN");break;case"AL":C=!0,te="R";break;case"WS":case"BN":te="N";break;case"CS":V<1||V+1>=T.length||(ie=M[V-1])!=="EN"&&ie!=="AN"||(X=T[V+1])!=="EN"&&X!=="AN"?te="N":C&&(X="AN"),te=X===ie?X:"N";break;case"ES":te=(ie=V>0?M[V-1]:"B")==="EN"&&V+1<T.length&&T[V+1]==="EN"?"EN":"N";break;case"ET":if(V>0&&M[V-1]==="EN"){te="EN";break}if(C){te="N";break}for(J=V+1,K=T.length;J<K&&T[J]==="ET";)J++;te=J<K&&T[J]==="EN"?"EN":"N";break;case"NSM":if(l&&!c){for(K=T.length,J=V+1;J<K&&T[J]==="NSM";)J++;if(J<K){var fe=D[V],U=fe>=1425&&fe<=2303||fe===64286;if(ie=T[J],U&&(ie==="R"||ie==="AL")){te="R";break}}}te=V<1||(ie=T[V-1])==="B"?"N":M[V-1];break;case"B":C=!1,n=!0,te=A;break;case"S":s=!0,te="N"}return te},B=function(D,T,M){var V=D.split("");return M&&q(V,M,{hiLevel:A}),V.reverse(),T&&T.reverse(),V.join("")},q=function(D,T,M){var V,ie,X,J,K,te=-1,fe=D.length,U=0,j=[],F=A?g:x,I=[];for(C=!1,n=!1,s=!1,ie=0;ie<fe;ie++)I[ie]=O(D[ie]);for(X=0;X<fe;X++){if(K=U,j[X]=W(D,I,j,X),V=240&(U=F[K][b[j[X]]]),U&=15,T[X]=J=F[U][5],V>0)if(V===16){for(ie=te;ie<X;ie++)T[ie]=1;te=-1}else te=-1;if(F[U][6])te===-1&&(te=X);else if(te>-1){for(ie=te;ie<X;ie++)T[ie]=J;te=-1}I[X]==="B"&&(T[X]=0),M.hiLevel|=J}s&&(function(z,ne,se){for(var je=0;je<se;je++)if(z[je]==="S"){ne[je]=A;for(var Ne=je-1;Ne>=0&&z[Ne]==="WS";Ne--)ne[Ne]=A}})(I,T,fe)},L=function(D,T,M,V,ie){if(!(ie.hiLevel<D)){if(D===1&&A===1&&!n)return T.reverse(),void(M&&M.reverse());for(var X,J,K,te,fe=T.length,U=0;U<fe;){if(V[U]>=D){for(K=U+1;K<fe&&V[K]>=D;)K++;for(te=U,J=K-1;te<J;te++,J--)X=T[te],T[te]=T[J],T[J]=X,M&&(X=M[te],M[te]=M[J],M[J]=X);U=K}U++}}},Z=function(D,T,M){var V=D.split(""),ie={hiLevel:A};return M||(M=[]),q(V,M,ie),(function(X,J,K){if(K.hiLevel!==0&&m)for(var te,fe=0;fe<X.length;fe++)J[fe]===1&&(te=w.indexOf(X[fe]))>=0&&(X[fe]=w[te+1])})(V,M,ie),L(2,V,T,M,ie),L(1,V,T,M,ie),V.join("")};return this.__bidiEngine__.doBidiReorder=function(D,T,M){if((function(ie,X){if(X)for(var J=0;J<ie.length;J++)X[J]=J;c===void 0&&(c=G(ie)),f===void 0&&(f=G(ie))})(D,T),l||!d||f)if(l&&d&&c^f)A=c?1:0,D=B(D,T,M);else if(!l&&d&&f)A=c?1:0,D=Z(D,T,M),D=B(D,T);else if(!l||c||d||f){if(l&&!d&&c^f)D=B(D,T),c?(A=0,D=Z(D,T,M)):(A=1,D=Z(D,T,M),D=B(D,T));else if(l&&c&&!d&&f)A=1,D=Z(D,T,M),D=B(D,T);else if(!l&&!d&&c^f){var V=m;c?(A=1,D=Z(D,T,M),A=0,m=!1,D=Z(D,T,M),m=V):(A=0,D=Z(D,T,M),D=B(D,T),A=1,m=!1,D=Z(D,T,M),m=V,D=B(D,T))}}else A=0,D=Z(D,T,M);else A=c?1:0,D=Z(D,T,M);return D},this.__bidiEngine__.setOptions=function(D){D&&(l=D.isInputVisual,d=D.isOutputVisual,c=D.isInputRtl,f=D.isOutputRtl,m=D.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(a){var n=a.text;a.x,a.y;var s=a.options||{};a.mutex,s.lang;var l=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(n)==="[object Array]"){var c=0;for(l=[],c=0;c<n.length;c+=1)Object.prototype.toString.call(n[c])==="[object Array]"?l.push([r.doBidiReorder(n[c][0]),n[c][1],n[c][2]]):l.push([r.doBidiReorder(n[c])]);a.text=l}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])})(ur),ur.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new wu(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new aH(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new Hz(this.contents),this.head=new Wz(this),this.name=new Kz(this),this.cmap=new ck(this),this.toUnicode={},this.hhea=new Vz(this),this.maxp=new Jz(this),this.hmtx=new Zz(this),this.post=new Yz(this),this.os2=new Gz(this),this.loca=new rH(this),this.glyf=new Qz(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,a,n,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,c,d,f;for(f=[],l=0,c=(d=this.bbox).length;l<c;l++)e=d[l],f.push(Math.round(e*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),32768&(r=n>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,a){var n,s,l,c;for(l=0,s=0,c=(e=""+e).length;0<=c?s<c:s>c;s=0<=c?++s:--s)n=e.charCodeAt(s),l+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return l*(r/1e3)},t.prototype.lineHeight=function(e,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*e},t})();var tl,wu=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,a;for(a=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},t.prototype.writeString=function(e){var r,a,n;for(n=[],r=0,a=e.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(e.charCodeAt(r)));return n},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,a,n,s,l,c,d;return e=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),s=this.readByte(),l=this.readByte(),c=this.readByte(),d=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^s)+65536*(255^l)+256*(255^c)+(255^d)+1):72057594037927940*e+281474976710656*r+1099511627776*a+4294967296*n+16777216*s+65536*l+256*c+d},t.prototype.writeLongLong=function(e){var r,a;return r=Math.floor(e/4294967296),a=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,a;for(r=[],a=0;0<=e?a<e:a>e;a=0<=e?++a:--a)r.push(this.readByte());return r},t.prototype.write=function(e){var r,a,n,s;for(s=[],a=0,n=e.length;a<n;a++)r=e[a],s.push(this.writeByte(r));return s},t})(),Hz=(function(){var t;function e(r){var a,n,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,s=this.tableCount;0<=s?n<s:n>s;n=0<=s?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return e.prototype.encode=function(r){var a,n,s,l,c,d,f,m,v,x,g,b,_;for(_ in g=Object.keys(r).length,d=Math.log(2),v=16*Math.floor(Math.log(g)/d),l=Math.floor(v/d),m=16*g-v,(n=new wu).writeInt(this.scalarType),n.writeShort(g),n.writeShort(v),n.writeShort(l),n.writeShort(m),s=16*g,f=n.pos+s,c=null,b=[],r)for(x=r[_],n.writeString(_),n.writeInt(t(x)),n.writeInt(f),n.writeInt(x.length),b=b.concat(x),_==="head"&&(c=f),f+=x.length;f%4;)b.push(0),f++;return n.write(b),a=2981146554-t(n.data),n.pos=c+8,n.writeUInt32(a),n.data},t=function(r){var a,n,s,l;for(r=uk.call(r);r.length%4;)r.push(0);for(s=new wu(r),n=0,a=0,l=r.length;a<l;a=a+=4)n+=s.readUInt32();return 4294967295&n},e})(),$z={}.hasOwnProperty,Ol=function(t,e){for(var r in e)$z.call(e,r)&&(t[r]=e[r]);function a(){this.constructor=t}return a.prototype=e.prototype,t.prototype=new a,t.__super__=e.prototype,t};tl=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var Wz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ol(t,tl),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new wu).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t})(),MS=(function(){function t(e,r){var a,n,s,l,c,d,f,m,v,x,g,b,_,w,E,C,A;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),v=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(d=0;d<256;++d)this.codeMap[d]=e.readByte();break;case 4:for(g=e.readUInt16(),x=g/2,e.pos+=6,s=(function(){var O,G;for(G=[],d=O=0;0<=x?O<x:O>x;d=0<=x?++O:--O)G.push(e.readUInt16());return G})(),e.pos+=2,_=(function(){var O,G;for(G=[],d=O=0;0<=x?O<x:O>x;d=0<=x?++O:--O)G.push(e.readUInt16());return G})(),f=(function(){var O,G;for(G=[],d=O=0;0<=x?O<x:O>x;d=0<=x?++O:--O)G.push(e.readUInt16());return G})(),m=(function(){var O,G;for(G=[],d=O=0;0<=x?O<x:O>x;d=0<=x?++O:--O)G.push(e.readUInt16());return G})(),n=(this.length-e.pos+this.offset)/2,c=(function(){var O,G;for(G=[],d=O=0;0<=n?O<n:O>n;d=0<=n?++O:--O)G.push(e.readUInt16());return G})(),d=E=0,A=s.length;E<A;d=++E)for(w=s[d],a=C=b=_[d];b<=w?C<=w:C>=w;a=b<=w?++C:--C)m[d]===0?l=a+f[d]:(l=c[m[d]/2+(a-b)-(x-d)]||0)!==0&&(l+=f[d]),this.codeMap[a]=65535&l}e.pos=v}return t.encode=function(e,r){var a,n,s,l,c,d,f,m,v,x,g,b,_,w,E,C,A,O,G,W,B,q,L,Z,D,T,M,V,ie,X,J,K,te,fe,U,j,F,I,z,ne,se,je,Ne,ge,Ie,le;switch(V=new wu,l=Object.keys(e).sort(function(Ge,rt){return Ge-rt}),r){case"macroman":for(_=0,w=(function(){var Ge=[];for(b=0;b<256;++b)Ge.push(0);return Ge})(),C={0:0},s={},ie=0,te=l.length;ie<te;ie++)C[Ne=e[n=l[ie]]]==null&&(C[Ne]=++_),s[n]={old:e[n],new:C[e[n]]},w[n]=C[e[n]];return V.writeUInt16(1),V.writeUInt16(0),V.writeUInt32(12),V.writeUInt16(0),V.writeUInt16(262),V.writeUInt16(0),V.write(w),{charMap:s,subtable:V.data,maxGlyphID:_+1};case"unicode":for(T=[],v=[],A=0,C={},a={},E=f=null,X=0,fe=l.length;X<fe;X++)C[G=e[n=l[X]]]==null&&(C[G]=++A),a[n]={old:G,new:C[G]},c=C[G]-n,E!=null&&c===f||(E&&v.push(E),T.push(n),f=c),E=n;for(E&&v.push(E),v.push(65535),T.push(65535),Z=2*(L=T.length),q=2*Math.pow(Math.log(L)/Math.LN2,2),x=Math.log(q/2)/Math.LN2,B=2*L-q,d=[],W=[],g=[],b=J=0,U=T.length;J<U;b=++J){if(D=T[b],m=v[b],D===65535){d.push(0),W.push(0);break}if(D-(M=a[D].new)>=32768)for(d.push(0),W.push(2*(g.length+L-b)),n=K=D;D<=m?K<=m:K>=m;n=D<=m?++K:--K)g.push(a[n].new);else d.push(M-D),W.push(0)}for(V.writeUInt16(3),V.writeUInt16(1),V.writeUInt32(12),V.writeUInt16(4),V.writeUInt16(16+8*L+2*g.length),V.writeUInt16(0),V.writeUInt16(Z),V.writeUInt16(q),V.writeUInt16(x),V.writeUInt16(B),se=0,j=v.length;se<j;se++)n=v[se],V.writeUInt16(n);for(V.writeUInt16(0),je=0,F=T.length;je<F;je++)n=T[je],V.writeUInt16(n);for(ge=0,I=d.length;ge<I;ge++)c=d[ge],V.writeUInt16(c);for(Ie=0,z=W.length;Ie<z;Ie++)O=W[Ie],V.writeUInt16(O);for(le=0,ne=g.length;le<ne;le++)_=g[le],V.writeUInt16(_);return{charMap:a,subtable:V.data,maxGlyphID:A+1}}},t})(),ck=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ol(t,tl),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,a,n;for(e.pos=this.offset,this.version=e.readUInt16(),n=e.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)r=new MS(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var a,n;return r==null&&(r="macroman"),a=MS.encode(e,r),(n=new wu).writeUInt16(0),n.writeUInt16(1),a.table=n.data.concat(a.subtable),a},t})(),Vz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ol(t,tl),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),Gz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ol(t,tl),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var r,a;for(a=[],r=0;r<10;++r)a.push(e.readByte());return a})(),this.charRange=(function(){var r,a;for(a=[],r=0;r<4;++r)a.push(e.readInt());return a})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var r,a;for(a=[],r=0;r<2;r=++r)a.push(e.readInt());return a})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),Yz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ol(t,tl),t.prototype.tag="post",t.prototype.parse=function(e){var r,a,n;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(a=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],n=[];e.pos<this.offset+this.length;)r=e.readByte(),n.push(this.names.push(e.readString(r)));return n;case 151552:return a=e.readUInt16(),this.offsets=e.read(a);case 262144:return this.map=(function(){var l,c,d;for(d=[],s=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;s=0<=c?++l:--l)d.push(e.readUInt32());return d}).call(this)}},t})(),Xz=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Kz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ol(t,tl),t.prototype.tag="name",t.prototype.parse=function(e){var r,a,n,s,l,c,d,f,m,v,x;for(e.pos=this.offset,e.readShort(),r=e.readShort(),c=e.readShort(),a=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)a.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+c+e.readShort()});for(d={},s=m=0,v=a.length;m<v;s=++m)n=a[s],e.pos=n.offset,f=e.readString(n.length),l=new Xz(f,n),d[x=n.nameID]==null&&(d[x]=[]),d[n.nameID].push(l);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},t})(),Jz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ol(t,tl),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),Zz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ol(t,tl),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,a,n,s,l,c,d;for(e.pos=this.offset,this.metrics=[],r=0,c=this.file.hhea.numberOfMetrics;0<=c?r<c:r>c;r=0<=c?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var f,m;for(m=[],r=f=0;0<=n?f<n:f>n;r=0<=n?++f:--f)m.push(e.readInt16());return m})(),this.widths=(function(){var f,m,v,x;for(x=[],f=0,m=(v=this.metrics).length;f<m;f++)s=v[f],x.push(s.advance);return x}).call(this),a=this.widths[this.widths.length-1],d=[],r=l=0;0<=n?l<n:l>n;r=0<=n?++l:--l)d.push(this.widths.push(a));return d},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),uk=[].slice,Qz=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ol(t,tl),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,a,n,s,l,c,d,f,m,v;return e in this.cache?this.cache[e]:(s=this.file.loca,r=this.file.contents,a=s.indexOf(e),(n=s.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+a,l=(c=new wu(r.read(n))).readShort(),f=c.readShort(),v=c.readShort(),d=c.readShort(),m=c.readShort(),this.cache[e]=l===-1?new tH(c,f,v,d,m):new eH(c,l,f,v,d,m),this.cache[e]))},t.prototype.encode=function(e,r,a){var n,s,l,c,d;for(l=[],s=[],c=0,d=r.length;c<d;c++)n=e[r[c]],s.push(l.length),n&&(l=l.concat(n.encode(a)));return s.push(l.length),{table:l,offsets:s}},t})(),eH=(function(){function t(e,r,a,n,s,l){this.raw=e,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=s,this.yMax=l,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),tH=(function(){function t(e,r,a,n,s){var l,c;for(this.raw=e,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;c=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&c;)l.pos+=1&c?4:2,128&c?l.pos+=8:64&c?l.pos+=4:8&c&&(l.pos+=2)}return t.prototype.encode=function(){var e,r,a;for(r=new wu(uk.call(this.raw.data)),e=0,a=this.glyphIDs.length;e<a;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),rH=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Ol(t,tl),t.prototype.tag="loca",t.prototype.parse=function(e){var r,a;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var n,s;for(s=[],a=0,n=this.length;a<n;a+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var n,s;for(s=[],a=0,n=this.length;a<n;a+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var a=new Uint32Array(this.offsets.length),n=0,s=0,l=0;l<a.length;++l)if(a[l]=n,s<r.length&&r[s]==l){++s,a[l]=n;var c=this.offsets[l],d=this.offsets[l+1]-c;d>0&&(n+=d)}for(var f=new Array(4*a.length),m=0;m<a.length;++m)f[4*m+3]=255&a[m],f[4*m+2]=(65280&a[m])>>8,f[4*m+1]=(16711680&a[m])>>16,f[4*m]=(4278190080&a[m])>>24;return f},t})(),aH=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,a,n,s;for(r in n=this.font.cmap.tables[0].codeMap,e={},s=this.subset)a=s[r],e[r]=n[a];return e},t.prototype.glyphsFor=function(e){var r,a,n,s,l,c,d;for(n={},l=0,c=e.length;l<c;l++)n[s=e[l]]=this.font.glyf.glyphFor(s);for(s in r=[],n)(a=n[s])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(s in d=this.glyphsFor(r))a=d[s],n[s]=a;return n},t.prototype.encode=function(e,r){var a,n,s,l,c,d,f,m,v,x,g,b,_,w,E;for(n in a=ck.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(e),g={0:0},E=a.charMap)g[(d=E[n]).old]=d.new;for(b in x=a.maxGlyphID,l)b in g||(g[b]=x++);return m=(function(C){var A,O;for(A in O={},C)O[C[A]]=A;return O})(g),v=Object.keys(m).sort(function(C,A){return C-A}),_=(function(){var C,A,O;for(O=[],C=0,A=v.length;C<A;C++)c=v[C],O.push(m[c]);return O})(),s=this.font.glyf.encode(l,_,g),f=this.font.loca.encode(s.offsets,_),w={cmap:this.font.cmap.raw(),glyf:s.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},t})();ur.API.PDFObject=(function(){var t;function e(){}return t=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},e.convert=function(r){var a,n,s,l;if(Array.isArray(r))return"["+(function(){var c,d,f;for(f=[],c=0,d=r.length;c<d;c++)a=r[c],f.push(e.convert(a));return f})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in s=["<<"],r)l=r[n],s.push("/"+n+" "+e.convert(l));return s.push(">>"),s.join(`
`)}return""+r},e})();function dk(t,e,r,a,n){a=a||{};var s=1.15,l=n.internal.scaleFactor,c=n.internal.getFontSize()/l,d=n.getLineHeightFactor?n.getLineHeightFactor():s,f=c*d,m=/\r\n|\r|\n/g,v="",x=1;if((a.valign==="middle"||a.valign==="bottom"||a.halign==="center"||a.halign==="right")&&(v=typeof t=="string"?t.split(m):t,x=v.length||1),r+=c*(2-s),a.valign==="middle"?r-=x/2*f:a.valign==="bottom"&&(r-=x*f),a.halign==="center"||a.halign==="right"){var g=c;if(a.halign==="center"&&(g*=.5),v&&x>=1){for(var b=0;b<v.length;b++)n.text(v[b],e-n.getStringUnitWidth(v[b])*g,r),r+=f;return n}e-=n.getStringUnitWidth(t)*g}return a.halign==="justify"?n.text(t,e,r,{maxWidth:a.maxWidth||100,align:"justify"}):n.text(t,e,r),n}var IS={},lh=(function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:IS=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var a,n,s;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var l=this.jsPDFDocument.internal.getFont(),c=l.fontStyle,d=l.fontName;if(e.font&&(d=e.font),e.fontStyle){c=e.fontStyle;var f=this.getFontList()[d];f&&f.indexOf(c)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(f[0]),c=f[0])}if(this.jsPDFDocument.setFont(d,c),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var m=t.unifyColor(e.fillColor);m&&(a=this.jsPDFDocument).setFillColor.apply(a,m),m=t.unifyColor(e.textColor),m&&(n=this.jsPDFDocument).setTextColor.apply(n,m),m=t.unifyColor(e.lineColor),m&&(s=this.jsPDFDocument).setDrawColor.apply(s,m),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,a){return this.jsPDFDocument.splitTextToSize(e,r,a)},t.prototype.rect=function(e,r,a,n,s){return this.jsPDFDocument.rect(e,r,a,n,s)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return IS||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t})(),$x=function(t,e){return $x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},$x(t,e)};function fk(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");$x(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var hk=(function(t){fk(e,t);function e(r){var a=t.call(this)||this;return a._element=r,a}return e})(Array);function nH(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function sH(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function h1(t,e,r){r.applyStyles(e,!0);var a=Array.isArray(t)?t:[t],n=a.map(function(s){return r.getTextWidth(s)}).reduce(function(s,l){return Math.max(s,l)},0);return n}function mk(t,e,r,a){var n=e.settings.tableLineWidth,s=e.settings.tableLineColor;t.applyStyles({lineWidth:n,lineColor:s});var l=pk(n,!1);l&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),a.y-r.y,l)}function pk(t,e){var r=t>0,a=e||e===0;return r&&a?"DF":r?"S":a?"F":null}function O1(t,e){var r,a,n,s;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(a=t.top)!==null&&a!==void 0?a:e,right:(n=t.right)!==null&&n!==void 0?n:e,bottom:(s=t.bottom)!==null&&s!==void 0?s:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function gk(t,e){var r=O1(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function iH(t,e,r,a,n){var s={},l=1.3333333333333333,c=$v(e,function(A){return n.getComputedStyle(A).backgroundColor});c!=null&&(s.fillColor=c);var d=$v(e,function(A){return n.getComputedStyle(A).color});d!=null&&(s.textColor=d);var f=lH(a,r);f&&(s.cellPadding=f);var m="borderTopColor",v=l*r,x=a.borderTopWidth;if(a.borderBottomWidth===x&&a.borderRightWidth===x&&a.borderLeftWidth===x){var g=(parseFloat(x)||0)/v;g&&(s.lineWidth=g)}else s.lineWidth={top:(parseFloat(a.borderTopWidth)||0)/v,right:(parseFloat(a.borderRightWidth)||0)/v,bottom:(parseFloat(a.borderBottomWidth)||0)/v,left:(parseFloat(a.borderLeftWidth)||0)/v},s.lineWidth.top||(s.lineWidth.right?m="borderRightColor":s.lineWidth.bottom?m="borderBottomColor":s.lineWidth.left&&(m="borderLeftColor"));var b=$v(e,function(A){return n.getComputedStyle(A)[m]});b!=null&&(s.lineColor=b);var _=["left","right","center","justify"];_.indexOf(a.textAlign)!==-1&&(s.halign=a.textAlign),_=["middle","bottom","top"],_.indexOf(a.verticalAlign)!==-1&&(s.valign=a.verticalAlign);var w=parseInt(a.fontSize||"");isNaN(w)||(s.fontSize=w/l);var E=oH(a);E&&(s.fontStyle=E);var C=(a.fontFamily||"").toLowerCase();return t.indexOf(C)!==-1&&(s.font=C),s}function oH(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function $v(t,e){var r=vk(t,e);if(!r)return null;var a=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!a||!Array.isArray(a))return null;var n=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])],s=parseInt(a[4]);return s===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function vk(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:vk(t.parentElement,e):r}function lH(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],a=96/(72/e),n=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,s=r.map(function(c){return parseInt(c||"0")/a}),l=O1(s,0);return n>l.top&&(l.top=n),n>l.bottom&&(l.bottom=n),l}function xk(t,e,r,a,n){var s,l;a===void 0&&(a=!1),n===void 0&&(n=!1);var c;typeof e=="string"?c=r.document.querySelector(e):c=e;var d=Object.keys(t.getFontList()),f=t.scaleFactor(),m=[],v=[],x=[];if(!c)return console.error("Html table could not be found with input: ",e),{head:m,body:v,foot:x};for(var g=0;g<c.rows.length;g++){var b=c.rows[g],_=(l=(s=b?.parentElement)===null||s===void 0?void 0:s.tagName)===null||l===void 0?void 0:l.toLowerCase(),w=cH(d,f,r,b,a,n);w&&(_==="thead"?m.push(w):_==="tfoot"?x.push(w):v.push(w))}return{head:m,body:v,foot:x}}function cH(t,e,r,a,n,s){for(var l=new hk(a),c=0;c<a.cells.length;c++){var d=a.cells[c],f=r.getComputedStyle(d);if(n||f.display!=="none"){var m=void 0;s&&(m=iH(t,d,e,f,r)),l.push({rowSpan:d.rowSpan,colSpan:d.colSpan,styles:m,_element:d,content:uH(d)})}}var v=r.getComputedStyle(a);if(l.length>0&&(n||v.display!=="none"))return l}function uH(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function dH(t,e,r){for(var a=0,n=[t,e,r];a<n.length;a++){var s=n[a];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function fc(t,e,r,a,n){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),l=1;l<arguments.length;l++){var c=arguments[l];if(c!=null)for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(s[d]=c[d])}return s}function yk(t,e){var r=new lh(t),a=r.getDocumentOptions(),n=r.getGlobalOptions();dH(n,a,e);var s=fc({},n,a,e),l;typeof window<"u"&&(l=window);var c=fH(n,a,e),d=hH(n,a,e),f=mH(r,s),m=gH(r,s,l);return{id:e.tableId,content:m,hooks:d,styles:c,settings:f}}function fH(t,e,r){for(var a={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(d){if(d==="columnStyles"){var f=t[d],m=e[d],v=r[d];a.columnStyles=fc({},f,m,v)}else{var x=[t,e,r],g=x.map(function(b){return b[d]||{}});a[d]=fc({},g[0],g[1],g[2])}},s=0,l=Object.keys(a);s<l.length;s++){var c=l[s];n(c)}return a}function hH(t,e,r){for(var a=[t,e,r],n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,l=a;s<l.length;s++){var c=l[s];c.didParseCell&&n.didParseCell.push(c.didParseCell),c.willDrawCell&&n.willDrawCell.push(c.willDrawCell),c.didDrawCell&&n.didDrawCell.push(c.didDrawCell),c.willDrawPage&&n.willDrawPage.push(c.willDrawPage),c.didDrawPage&&n.didDrawPage.push(c.didDrawPage)}return n}function mH(t,e){var r,a,n,s,l,c,d,f,m,v,x,g,b=O1(e.margin,40/t.scaleFactor()),_=(r=pH(t,e.startY))!==null&&r!==void 0?r:b.top,w;e.showFoot===!0?w="everyPage":e.showFoot===!1?w="never":w=(a=e.showFoot)!==null&&a!==void 0?a:"everyPage";var E;e.showHead===!0?E="everyPage":e.showHead===!1?E="never":E=(n=e.showHead)!==null&&n!==void 0?n:"everyPage";var C=(s=e.useCss)!==null&&s!==void 0?s:!1,A=e.theme||(C?"plain":"striped"),O=!!e.horizontalPageBreak,G=(l=e.horizontalPageBreakRepeat)!==null&&l!==void 0?l:null;return{includeHiddenHtml:(c=e.includeHiddenHtml)!==null&&c!==void 0?c:!1,useCss:C,theme:A,startY:_,margin:b,pageBreak:(d=e.pageBreak)!==null&&d!==void 0?d:"auto",rowPageBreak:(f=e.rowPageBreak)!==null&&f!==void 0?f:"auto",tableWidth:(m=e.tableWidth)!==null&&m!==void 0?m:"auto",showHead:E,showFoot:w,tableLineWidth:(v=e.tableLineWidth)!==null&&v!==void 0?v:0,tableLineColor:(x=e.tableLineColor)!==null&&x!==void 0?x:200,horizontalPageBreak:O,horizontalPageBreakRepeat:G,horizontalPageBreakBehaviour:(g=e.horizontalPageBreakBehaviour)!==null&&g!==void 0?g:"afterAllRows"}}function pH(t,e){var r=t.getLastAutoTable(),a=t.scaleFactor(),n=t.pageNumber(),s=!1;if(r&&r.startPageNumber){var l=r.startPageNumber+r.pageNumber-1;s=l===n}return typeof e=="number"?e:(e==null||e===!1)&&s&&r?.finalY!=null?r.finalY+20/a:null}function gH(t,e,r){var a=e.head||[],n=e.body||[],s=e.foot||[];if(e.html){var l=e.includeHiddenHtml;if(r){var c=xk(t,e.html,r,l,e.useCss)||{};a=c.head||a,n=c.body||a,s=c.foot||a}else console.error("Cannot parse html in non browser environment")}var d=e.columns||vH(a,n,s);return{columns:d,head:a,body:n,foot:s}}function vH(t,e,r){var a=t[0]||e[0]||r[0]||[],n=[];return Object.keys(a).filter(function(s){return s!=="_element"}).forEach(function(s){var l=1,c;Array.isArray(a)?c=a[parseInt(s)]:c=a[s],typeof c=="object"&&!Array.isArray(c)&&(l=c?.colSpan||1);for(var d=0;d<l;d++){var f=void 0;Array.isArray(a)?f=n.length:f=s+(d>0?"_".concat(d):"");var m={dataKey:f};n.push(m)}}),n}var Wx=(function(){function t(e,r,a){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=a,this.doc=e.getDocument()}return t})(),xH=(function(t){fk(e,t);function e(r,a,n,s,l,c){var d=t.call(this,r,a,c)||this;return d.cell=n,d.row=s,d.column=l,d.section=s.section,d}return e})(Wx),yH=(function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,a){return r+a.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,a,n,s,l){for(var c=0,d=r;c<d.length;c++){var f=d[c],m=new xH(e,this,a,n,s,l),v=f(m)===!1;if(a.text=Array.isArray(a.text)?a.text:[a.text],v)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var a=0,n=this.hooks.didDrawPage;a<n.length;a++){var s=n[a];s(new Wx(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var a=0,n=this.hooks.willDrawPage;a<n.length;a++){var s=n[a];s(new Wx(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(n,s){return n+s.wrappedWidth},0);return r}else{var a=this.settings.margin;return e-a.left-a.right}},t})(),_k=(function(){function t(e,r,a,n,s){s===void 0&&(s=!1),this.height=0,this.raw=e,e instanceof hk&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=a,this.cells=n,this.spansMultiplePages=s}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(a,n){var s;return Math.max(a,((s=r.cells[n.index])===null||s===void 0?void 0:s.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(a){var n=r.cells[a.index];return n?n.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var a=this;return e.reduce(function(n,s){var l=a.cells[s.index];if(!l)return 0;var c=r.getLineHeight(l.styles.fontSize),d=l.padding("vertical"),f=d+c;return f>n?f:n},0)},t})(),bk=(function(){function t(e,r,a){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=a,this.raw=e;var s=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,s=(n=e.content)!==null&&n!==void 0?n:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var l=s!=null?""+s:"",c=/\r\n|\r|\n/g;this.text=l.split(c)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var a;if(this.styles.halign==="right")a=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var n=this.width-this.padding("horizontal");a=this.x+n/2+this.padding("left")}else a=this.x+this.padding("left");return{x:a,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var a=Array.isArray(this.text)?this.text.length:1,n=this.styles.fontSize/e*r,s=a*n+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=O1(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t})(),_H=(function(){function t(e,r,a){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=a}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,a=0,n=e.allRows();a<n.length;a++){var s=n[a],l=s.cells[this.index];l&&typeof l.styles.cellWidth=="number"&&(r=Math.max(r,l.styles.cellWidth))}return r},t})();function bH(t,e){wH(t,e);var r=[],a=0;e.columns.forEach(function(s){var l=s.getMaxCustomCellWidth(e);l?s.width=l:(s.width=s.wrappedWidth,r.push(s)),a+=s.width});var n=e.getWidth(t.pageSize().width)-a;n&&(n=Vx(r,n,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),n&&(n=Vx(r,n,function(s){return s.minWidth})),n=Math.abs(n),!e.settings.horizontalPageBreak&&n>.1/t.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),NH(e),jH(e,t),SH(e)}function wH(t,e){var r=t.scaleFactor(),a=e.settings.horizontalPageBreak,n=gk(t,e);e.allRows().forEach(function(s){for(var l=0,c=e.columns;l<c.length;l++){var d=c[l],f=s.cells[d.index];if(f){var m=e.hooks.didParseCell;e.callCellHooks(t,m,f,s,d,null);var v=f.padding("horizontal");f.contentWidth=h1(f.text,f.styles,t)+v;var x=h1(f.text.join(" ").split(/[^\S\u00A0]+/),f.styles,t);if(f.minReadableWidth=x+f.padding("horizontal"),typeof f.styles.cellWidth=="number")f.minWidth=f.styles.cellWidth,f.wrappedWidth=f.styles.cellWidth;else if(f.styles.cellWidth==="wrap"||a===!0)f.contentWidth>n?(f.minWidth=n,f.wrappedWidth=n):(f.minWidth=f.contentWidth,f.wrappedWidth=f.contentWidth);else{var g=10/r;f.minWidth=f.styles.minCellWidth||g,f.wrappedWidth=f.contentWidth,f.minWidth>f.wrappedWidth&&(f.wrappedWidth=f.minWidth)}}}}),e.allRows().forEach(function(s){for(var l=0,c=e.columns;l<c.length;l++){var d=c[l],f=s.cells[d.index];if(f&&f.colSpan===1)d.wrappedWidth=Math.max(d.wrappedWidth,f.wrappedWidth),d.minWidth=Math.max(d.minWidth,f.minWidth),d.minReadableWidth=Math.max(d.minReadableWidth,f.minReadableWidth);else{var m=e.styles.columnStyles[d.dataKey]||e.styles.columnStyles[d.index]||{},v=m.cellWidth||m.minCellWidth;v&&typeof v=="number"&&(d.minWidth=v,d.wrappedWidth=v)}f&&(f.colSpan>1&&!d.minWidth&&(d.minWidth=f.minWidth),f.colSpan>1&&!d.wrappedWidth&&(d.wrappedWidth=f.minWidth))}})}function Vx(t,e,r){for(var a=e,n=t.reduce(function(g,b){return g+b.wrappedWidth},0),s=0;s<t.length;s++){var l=t[s],c=l.wrappedWidth/n,d=a*c,f=l.width+d,m=r(l),v=f<m?m:f;e-=v-l.width,l.width=v}if(e=Math.round(e*1e10)/1e10,e){var x=t.filter(function(g){return e<0?g.width>r(g):!0});x.length&&(e=Vx(x,e,r))}return e}function SH(t){for(var e={},r=1,a=t.allRows(),n=0;n<a.length;n++)for(var s=a[n],l=0,c=t.columns;l<c.length;l++){var d=c[l],f=e[d.index];if(r>1)r--,delete s.cells[d.index];else if(f)f.cell.height+=s.height,r=f.cell.colSpan,delete s.cells[d.index],f.left--,f.left<=1&&delete e[d.index];else{var m=s.cells[d.index];if(!m)continue;if(m.height=s.height,m.rowSpan>1){var v=a.length-n,x=m.rowSpan>v?v:m.rowSpan;e[d.index]={cell:m,left:x,row:s}}}}}function NH(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var a=e[r],n=null,s=0,l=0,c=0;c<t.columns.length;c++){var d=t.columns[c];if(l-=1,l>1&&t.columns[c+1])s+=d.width,delete a.cells[d.index];else if(n){var f=n;delete a.cells[d.index],n=null,f.width=d.width+s}else{var f=a.cells[d.index];if(!f)continue;if(l=f.colSpan,s=0,f.colSpan>1){n=f,s+=d.width;continue}f.width=d.width+s}}}function jH(t,e){for(var r={count:0,height:0},a=0,n=t.allRows();a<n.length;a++){for(var s=n[a],l=0,c=t.columns;l<c.length;l++){var d=c[l],f=s.cells[d.index];if(f){e.applyStyles(f.styles,!0);var m=f.width-f.padding("horizontal");if(f.styles.overflow==="linebreak")f.text=e.splitTextToSize(f.text,m+1/e.scaleFactor(),{fontSize:f.styles.fontSize});else if(f.styles.overflow==="ellipsize")f.text=BS(f.text,m,f.styles,e,"...");else if(f.styles.overflow==="hidden")f.text=BS(f.text,m,f.styles,e,"");else if(typeof f.styles.overflow=="function"){var v=f.styles.overflow(f.text,m);typeof v=="string"?f.text=[v]:f.text=v}f.contentHeight=f.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var x=f.contentHeight/f.rowSpan;f.rowSpan>1&&r.count*r.height<x*f.rowSpan?r={height:x,count:f.rowSpan}:r&&r.count>0&&r.height>x&&(x=r.height),x>s.height&&(s.height=x)}}r.count--}}function BS(t,e,r,a,n){return t.map(function(s){return kH(s,e,r,a,n)})}function kH(t,e,r,a,n){var s=1e4*a.scaleFactor();if(e=Math.ceil(e*s)/s,e>=h1(t,r,a))return t;for(;e<h1(t+n,r,a)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+n}function wk(t,e){var r=new lh(t),a=EH(e,r.scaleFactor()),n=new yH(e,a);return bH(r,n),r.applyStyles(r.userStyles),n}function EH(t,e){var r=t.content,a=CH(r.columns);if(r.head.length===0){var n=US(a,"head");n&&r.head.push(n)}if(r.foot.length===0){var n=US(a,"foot");n&&r.foot.push(n)}var s=t.settings.theme,l=t.styles;return{columns:a,head:Wv("head",r.head,a,l,s,e),body:Wv("body",r.body,a,l,s,e),foot:Wv("foot",r.foot,a,l,s,e)}}function Wv(t,e,r,a,n,s){var l={},c=e.map(function(d,f){for(var m=0,v={},x=0,g=0,b=0,_=r;b<_.length;b++){var w=_[b];if(l[w.index]==null||l[w.index].left===0)if(g===0){var E=void 0;Array.isArray(d)?E=d[w.index-x-m]:E=d[w.dataKey];var C={};typeof E=="object"&&!Array.isArray(E)&&(C=E?.styles||{});var A=TH(t,w,f,n,a,s,C),O=new bk(E,A,t);v[w.dataKey]=O,v[w.index]=O,g=O.colSpan-1,l[w.index]={left:O.rowSpan-1,times:g}}else g--,x++;else l[w.index].left--,g=l[w.index].times,m++}return new _k(d,f,t,v)});return c}function US(t,e){var r={};return t.forEach(function(a){if(a.raw!=null){var n=AH(e,a.raw);n!=null&&(r[a.dataKey]=n)}}),Object.keys(r).length>0?r:null}function AH(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function CH(t){return t.map(function(e,r){var a,n;return typeof e=="object"?n=(a=e.dataKey)!==null&&a!==void 0?a:r:n=r,new _H(n,e,r)})}function TH(t,e,r,a,n,s,l){var c=sH(a),d;t==="head"?d=n.headStyles:t==="body"?d=n.bodyStyles:t==="foot"&&(d=n.footStyles);var f=fc({},c.table,c[t],n.styles,d),m=n.columnStyles[e.dataKey]||n.columnStyles[e.index]||{},v=t==="body"?m:{},x=t==="body"&&r%2===0?fc({},c.alternateRow,n.alternateRowStyles):{},g=nH(s),b=fc({},g,f,x,v);return fc(b,l)}function OH(t,e,r){var a;r===void 0&&(r={});var n=gk(t,e),s=new Map,l=[],c=[],d=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?d=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(d=[e.settings.horizontalPageBreakRepeat]),d.forEach(function(x){var g=e.columns.find(function(b){return b.dataKey===x||b.index===x});g&&!s.has(g.index)&&(s.set(g.index,!0),l.push(g.index),c.push(e.columns[g.index]),n-=g.wrappedWidth)});for(var f=!0,m=(a=r?.start)!==null&&a!==void 0?a:0;m<e.columns.length;){if(s.has(m)){m++;continue}var v=e.columns[m].wrappedWidth;if(f||n>=v)f=!1,l.push(m),c.push(e.columns[m]),n-=v;else break;m++}return{colIndexes:l,columns:c,lastIndex:m-1}}function RH(t,e){for(var r=[],a=0;a<e.columns.length;a++){var n=OH(t,e,{start:a});n.columns.length&&(r.push(n),a=n.lastIndex)}return r}function Sk(t,e){var r=e.settings,a=r.startY,n=r.margin,s={x:n.left,y:a},l=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),c=a+n.bottom+l;if(r.pageBreak==="avoid"){var d=e.body,f=d.reduce(function(x,g){return x+g.height},0);c+=f}var m=new lh(t);(r.pageBreak==="always"||r.startY!=null&&c>m.pageSize().height)&&(jk(m),s.y=n.top),e.callWillDrawPageHooks(m,s);var v=fc({},s);e.startPageNumber=m.pageNumber(),r.horizontalPageBreak?DH(m,e,v,s):(m.applyStyles(m.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(x){return xc(m,e,x,s,e.columns)}),m.applyStyles(m.userStyles),e.body.forEach(function(x,g){var b=g===e.body.length-1;m1(m,e,x,b,v,s,e.columns)}),m.applyStyles(m.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(x){return xc(m,e,x,s,e.columns)})),mk(m,e,v,s),e.callEndPageHooks(m,s),e.finalY=s.y,t.lastAutoTable=e,m.applyStyles(m.userStyles)}function DH(t,e,r,a){var n=RH(t,e),s=e.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")n.forEach(function(f,m){t.applyStyles(t.userStyles),m>0?A0(t,e,r,a,f.columns,!0):qS(t,e,a,f.columns),FH(t,e,r,a,f.columns),Vv(t,e,a,f.columns)});else for(var l=-1,c=n[0],d=function(){var f=l;if(c){t.applyStyles(t.userStyles);var m=c.columns;l>=0?A0(t,e,r,a,m,!0):qS(t,e,a,m),f=zS(t,e,l+1,a,m),Vv(t,e,a,m)}var v=f-l;n.slice(1).forEach(function(x){t.applyStyles(t.userStyles),A0(t,e,r,a,x.columns,!0),zS(t,e,l+1,a,x.columns,v),Vv(t,e,a,x.columns)}),l=f};l<e.body.length-1;)d()}function qS(t,e,r,a){var n=e.settings;t.applyStyles(t.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&e.head.forEach(function(s){return xc(t,e,s,r,a)})}function FH(t,e,r,a,n){t.applyStyles(t.userStyles),e.body.forEach(function(s,l){var c=l===e.body.length-1;m1(t,e,s,c,r,a,n)})}function zS(t,e,r,a,n,s){t.applyStyles(t.userStyles),s=s??e.body.length;var l=Math.min(r+s,e.body.length),c=-1;return e.body.slice(r,l).forEach(function(d,f){var m=r+f===e.body.length-1,v=Nk(t,e,m,a);d.canEntireRowFit(v,n)&&(xc(t,e,d,a,n),c=r+f)}),c}function Vv(t,e,r,a){var n=e.settings;t.applyStyles(t.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&e.foot.forEach(function(s){return xc(t,e,s,r,a)})}function LH(t,e,r){var a=r.getLineHeight(t.styles.fontSize),n=t.padding("vertical"),s=Math.floor((e-n)/a);return Math.max(0,s)}function PH(t,e,r,a){var n={};t.spansMultiplePages=!0,t.height=0;for(var s=0,l=0,c=r.columns;l<c.length;l++){var d=c[l],f=t.cells[d.index];if(f){Array.isArray(f.text)||(f.text=[f.text]);var m=new bk(f.raw,f.styles,f.section);m=fc(m,f),m.text=[];var v=LH(f,e,a);f.text.length>v&&(m.text=f.text.splice(v,f.text.length));var x=a.scaleFactor(),g=a.getLineHeightFactor();f.contentHeight=f.getContentHeight(x,g),f.contentHeight>=e&&(f.contentHeight=e,m.styles.minCellHeight-=e),f.contentHeight>t.height&&(t.height=f.contentHeight),m.contentHeight=m.getContentHeight(x,g),m.contentHeight>s&&(s=m.contentHeight),n[d.index]=m}}var b=new _k(t.raw,-1,t.section,n,!0);b.height=s;for(var _=0,w=r.columns;_<w.length;_++){var d=w[_],m=b.cells[d.index];m&&(m.height=b.height);var f=t.cells[d.index];f&&(f.height=t.height)}return b}function MH(t,e,r,a){var n=t.pageSize().height,s=a.settings.margin,l=s.top+s.bottom,c=n-l;e.section==="body"&&(c-=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns));var d=e.getMinimumRowHeight(a.columns,t),f=d<r;if(d>c)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!f)return!1;var m=e.hasRowSpan(a.columns),v=e.getMaxCellHeight(a.columns)>c;return v?(m&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(m||a.settings.rowPageBreak==="avoid")}function m1(t,e,r,a,n,s,l){var c=Nk(t,e,a,s);if(r.canEntireRowFit(c,l))xc(t,e,r,s,l);else if(MH(t,r,c,e)){var d=PH(r,c,e,t);xc(t,e,r,s,l),A0(t,e,n,s,l),m1(t,e,d,a,n,s,l)}else A0(t,e,n,s,l),m1(t,e,r,a,n,s,l)}function xc(t,e,r,a,n){a.x=e.settings.margin.left;for(var s=0,l=n;s<l.length;s++){var c=l[s],d=r.cells[c.index];if(!d){a.x+=c.width;continue}t.applyStyles(d.styles),d.x=a.x,d.y=a.y;var f=e.callCellHooks(t,e.hooks.willDrawCell,d,r,c,a);if(f===!1){a.x+=c.width;continue}IH(t,d,a);var m=d.getTextPos();dk(d.text,m.x,m.y,{halign:d.styles.halign,valign:d.styles.valign,maxWidth:Math.ceil(d.width-d.padding("left")-d.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,d,r,c,a),a.x+=c.width}a.y+=r.height}function IH(t,e,r){var a=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof a.lineWidth=="number"){var n=pk(a.lineWidth,a.fillColor);n&&t.rect(e.x,r.y,e.width,e.height,n)}else typeof a.lineWidth=="object"&&(a.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),BH(t,e,r,a.lineWidth))}function BH(t,e,r,a){var n,s,l,c;a.top&&(n=r.x,s=r.y,l=r.x+e.width,c=r.y,a.right&&(l+=.5*a.right),a.left&&(n-=.5*a.left),d(a.top,n,s,l,c)),a.bottom&&(n=r.x,s=r.y+e.height,l=r.x+e.width,c=r.y+e.height,a.right&&(l+=.5*a.right),a.left&&(n-=.5*a.left),d(a.bottom,n,s,l,c)),a.left&&(n=r.x,s=r.y,l=r.x,c=r.y+e.height,a.top&&(s-=.5*a.top),a.bottom&&(c+=.5*a.bottom),d(a.left,n,s,l,c)),a.right&&(n=r.x+e.width,s=r.y,l=r.x+e.width,c=r.y+e.height,a.top&&(s-=.5*a.top),a.bottom&&(c+=.5*a.bottom),d(a.right,n,s,l,c));function d(f,m,v,x,g){t.getDocument().setLineWidth(f),t.getDocument().line(m,v,x,g,"S")}}function Nk(t,e,r,a){var n=e.settings.margin.bottom,s=e.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(n+=e.getFootHeight(e.columns)),t.pageSize().height-a.y-n}function A0(t,e,r,a,n,s){n===void 0&&(n=[]),s===void 0&&(s=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!s&&e.foot.forEach(function(c){return xc(t,e,c,a,n)}),e.callEndPageHooks(t,a);var l=e.settings.margin;mk(t,e,r,a),jk(t),e.pageNumber++,a.x=l.left,a.y=l.top,r.y=l.top,e.callWillDrawPageHooks(t,a),e.settings.showHead==="everyPage"&&(e.head.forEach(function(c){return xc(t,e,c,a,n)}),t.applyStyles(t.userStyles))}function jk(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function UH(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var a=e[0],n=yk(this,a),s=wk(this,n);return Sk(this,s),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,a,n){dk(e,r,a,n,this)},t.API.autoTableSetDefaults=function(e){return lh.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){lh.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var a;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=new lh(this),s=xk(n,e,window,r,!1),l=s.head,c=s.body,d=((a=l[0])===null||a===void 0?void 0:a.map(function(f){return f.content}))||[];return{columns:d,rows:c,data:c}}}var Gv;function Jf(t,e){var r=yk(t,e),a=wk(t,r);Sk(t,a)}try{if(typeof window<"u"&&window){var HS=window,$S=HS.jsPDF||((Gv=HS.jspdf)===null||Gv===void 0?void 0:Gv.jsPDF);$S&&UH($S)}}catch(t){console.error("Could not apply autoTable plugin",t)}const WS=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},qH=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});function zH({project:t,company:e,onShowToast:r}){const{branding:a}=ph(),[n,s]=ee.useState([]),[l,c]=ee.useState(!0),[d,f]=ee.useState("all"),[m,v]=ee.useState(null),[x,g]=ee.useState(new Set),[b,_]=ee.useState("recent"),[w,E]=ee.useState(new Set),[C,A]=ee.useState({start:"",end:""}),[O,G]=ee.useState(!1),[W,B]=ee.useState(null),[q,L]=ee.useState(""),[Z,D]=ee.useState(!1),[T,M]=ee.useState(null);ee.useEffect(()=>{V();const xe=nt.subscribeToTMTickets?.(t.id,()=>{V()});return()=>{xe&&nt.unsubscribe?.(xe)}},[t.id]);const V=async()=>{try{const xe=await nt.getTMTickets(t.id);s(xe)}catch(xe){console.error("Error loading tickets:",xe),r("Error loading T&M tickets","error")}finally{c(!1)}},ie=async(xe,ve)=>{try{await nt.updateTMTicketStatus(xe,ve),s(n.map(Be=>Be.id===xe?{...Be,status:ve}:Be)),r(`Ticket ${ve}`,"success")}catch(Be){console.error("Error updating status:",Be),r("Error updating status","error")}},X=xe=>{xe.ce_pco_number?(B(xe),L(""),G(!0)):ie(xe.id,"approved")},J=async()=>{if(W)try{const xe=parseFloat(q)||0;await nt.approveTMTicket(W.id,null,null,xe),s(n.map(ve=>ve.id===W.id?{...ve,status:"approved",change_order_value:xe}:ve)),r(`Ticket approved with $${xe.toLocaleString()} change order`,"success"),G(!1),B(null),L("")}catch(xe){console.error("Error approving ticket:",xe),r("Error approving ticket","error")}},K=async xe=>{if(confirm("Delete this T&M ticket?"))try{await nt.deleteTMTicket(xe),s(n.filter(ve=>ve.id!==xe)),r("Ticket deleted","success")}catch(ve){console.error("Error deleting ticket:",ve),r("Error deleting ticket","error")}},te=xe=>{let ve=0;return xe.t_and_m_items&&xe.t_and_m_items.forEach(Be=>{Be.materials_equipment?.cost_per_unit&&(ve+=Be.quantity*Be.materials_equipment.cost_per_unit)}),ve},fe=xe=>xe.t_and_m_workers?xe.t_and_m_workers.reduce((ve,Be)=>{const jt=parseFloat(Be.hours)||0,Je=parseFloat(Be.overtime_hours)||0;return ve+jt+Je},0):0,U=xe=>new Date(xe).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),j=(xe,ve)=>{ve.stopPropagation(),g(Be=>{const jt=new Set(Be);return jt.has(xe)?jt.delete(xe):jt.add(xe),jt})},F=()=>{const xe=d==="all"?n:n.filter(Be=>Be.status===d),ve=xe.every(Be=>x.has(Be.id));g(ve?new Set:new Set(xe.map(Be=>Be.id)))},I=()=>{g(new Set)},z=()=>{const xe=d==="all"?n:n.filter(ve=>ve.status===d);return x.size>0?xe.filter(ve=>x.has(ve.id)):xe},ne=()=>{const xe=z();if(xe.length===0){r("No tickets to export","error");return}const ve=[],Be=[],jt=[];xe.forEach(Ft=>{const Xt=U(Ft.work_date),Ut=Ft.status;Ft.t_and_m_workers&&Ft.t_and_m_workers.forEach(Wt=>{const $t=parseFloat(Wt.hours)||0,wt=parseFloat(Wt.overtime_hours)||0;ve.push({Date:Xt,Status:Ut,"Worker Name":Wt.name,Role:Wt.role||"Laborer","Regular Hours":$t,"OT Hours":wt,"Total Hours":$t+wt})}),Ft.t_and_m_items&&Ft.t_and_m_items.forEach(Wt=>{const $t=Wt.custom_name||Wt.materials_equipment?.name||"Unknown",wt=Wt.custom_category||Wt.materials_equipment?.category||"Unknown",Ce=Wt.materials_equipment?.unit||"each",st=Wt.materials_equipment?.cost_per_unit||0,Dt=Wt.quantity*st;Be.push({Date:Xt,Status:Ut,Category:wt,Item:$t,Quantity:Wt.quantity,Unit:Ce,"Cost/Unit":st,Total:Dt})}),jt.push({Date:Xt,Status:Ut,Workers:Ft.t_and_m_workers?.length||0,"Total Hours":fe(Ft),Items:Ft.t_and_m_items?.length||0,"Materials Cost":te(Ft),Notes:Ft.notes||""})});const Je=uu.book_new(),ct=uu.json_to_sheet(jt);if(uu.book_append_sheet(Je,ct,"Summary"),ve.length>0){const Ft=uu.json_to_sheet(ve);uu.book_append_sheet(Je,Ft,"Workers")}if(Be.length>0){const Ft=uu.json_to_sheet(Be);uu.book_append_sheet(Je,Ft,"Materials & Equipment")}const St=`${t.name}_TM_${new Date().toISOString().split("T")[0]}.xlsx`;aU(Je,St),r("Export downloaded!","success")},se=async()=>{const xe=z();if(xe.length===0){r("No tickets to export","error");return}r("Generating PDF...","info");const ve=new ur,Be=ve.internal.pageSize.getWidth(),jt=ve.internal.pageSize.getHeight(),Je=20;let ct=Je;const St=WS(a?.primary_color||"#3B82F6"),Ft=WS(a?.secondary_color||"#1E40AF");ve.setFillColor(...St),ve.rect(0,0,Be,45,"F"),ve.setFillColor(...Ft),ve.rect(0,42,Be,3,"F");let Xt=Je;if(a?.logo_url)try{const Pt=await qH(a.logo_url);Pt&&(ve.addImage(Pt,"PNG",Je,7,30,30),Xt=Je+30+10)}catch(Pt){console.error("Error adding logo:",Pt)}ve.setTextColor(255,255,255),ve.setFontSize(22),ve.setFont("helvetica","bold"),ve.text(e?.name||"Company Name",Xt,20),ve.setFontSize(10),ve.setFont("helvetica","normal"),ve.text("TIME & MATERIALS REPORT",Xt,30),ve.setFontSize(9),ve.text(`Report Date: ${new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}`,Be-Je,18,{align:"right"}),t.job_number&&ve.text(`Job #: ${t.job_number}`,Be-Je,26,{align:"right"}),ve.text(`Status: ${d.charAt(0).toUpperCase()+d.slice(1)}`,Be-Je,34,{align:"right"}),ct=55,ve.setFillColor(248,250,252),ve.rect(Je,ct-5,Be-Je*2,30,"F"),ve.setDrawColor(...St),ve.setLineWidth(.5),ve.rect(Je,ct-5,Be-Je*2,30,"S"),ve.setTextColor(...St),ve.setFontSize(14),ve.setFont("helvetica","bold"),ve.text(`Project: ${t.name}`,Je+5,ct+7),ve.setFontSize(10),ve.setFont("helvetica","normal"),ve.setTextColor(51,65,85);const Ut=xe.map(Pt=>new Date(Pt.work_date)).sort((Pt,Zt)=>Pt-Zt),Wt=Ut[0]?.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),$t=Ut[Ut.length-1]?.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});ve.text(`Date Range: ${Wt} - ${$t}`,Je+5,ct+17),ve.text(`Total Tickets: ${xe.length}`,Be-Je-5,ct+7,{align:"right"}),ct+=40;const wt=xe.reduce((Pt,Zt)=>Pt+fe(Zt),0),Ce=xe.reduce((Pt,Zt)=>Pt+te(Zt),0),st=new Set(xe.flatMap(Pt=>Pt.t_and_m_workers?.map(Zt=>Zt.name)||[])).size;ve.setTextColor(...St),ve.setFontSize(12),ve.setFont("helvetica","bold"),ve.text("SUMMARY",Je,ct),ct+=8;const Dt=(Be-Je*2-20)/3,At=[{label:"Total Labor Hours",value:wt.toFixed(1)},{label:"Unique Workers",value:st.toString()},{label:"Materials Cost",value:`$${Ce.toFixed(2)}`}],Ct=St.map(Pt=>Math.min(255,Pt+180));At.forEach((Pt,Zt)=>{const ae=Je+Zt*(Dt+10);ve.setFillColor(...Ct),ve.rect(ae,ct,Dt,25,"F"),ve.setDrawColor(...St),ve.setLineWidth(.5),ve.rect(ae,ct,Dt,25,"S"),ve.setTextColor(...St),ve.setFontSize(16),ve.setFont("helvetica","bold"),ve.text(Pt.value,ae+Dt/2,ct+12,{align:"center"}),ve.setTextColor(100,116,139),ve.setFontSize(8),ve.setFont("helvetica","normal"),ve.text(Pt.label,ae+Dt/2,ct+20,{align:"center"})}),ct+=35;const Te=[],Ve=[],_e=[];let Ue=0,Fe=0,gt=0,Ht=0,Vt=0,zt=0;xe.forEach(Pt=>{Pt.t_and_m_workers&&Pt.t_and_m_workers.forEach(Zt=>{const ae=parseFloat(Zt.hours)||0,be=parseFloat(Zt.overtime_hours)||0,me=Zt.role||"Laborer",pe=[U(Pt.work_date),Zt.name,ae.toString(),be>0?be.toString():"-",(ae+be).toString()];me==="Foreman"||me==="Superintendent"?(Te.push(pe),Ue+=ae,Fe+=be):me==="Operator"?(Ve.push(pe),gt+=ae,Ht+=be):(_e.push(pe),Vt+=ae,zt+=be)})});const kt=(Pt,Zt,ae,be)=>{Zt.length!==0&&(ct>jt-80&&(ve.addPage(),ct=Je),ve.setTextColor(...St),ve.setFontSize(11),ve.setFont("helvetica","bold"),ve.text(Pt,Je,ct),ct+=5,Jf(ve,{startY:ct,head:[["Date","Name","Reg Hrs","OT Hrs","Total"]],body:Zt,margin:{left:Je,right:Je},headStyles:{fillColor:St,textColor:[255,255,255],fontStyle:"bold",fontSize:9},bodyStyles:{fontSize:9,textColor:[51,65,85]},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{0:{cellWidth:30},2:{halign:"center",cellWidth:22},3:{halign:"center",cellWidth:22},4:{halign:"center",cellWidth:22}},foot:[["","SUBTOTAL:",ae.toString(),be>0?be.toString():"-",(ae+be).toString()]],footStyles:{fillColor:Ft,textColor:[255,255,255],fontStyle:"bold",fontSize:9}}),ct=ve.lastAutoTable.finalY+10)};if(Te.length>0||Ve.length>0||_e.length>0){ve.setTextColor(...St),ve.setFontSize(12),ve.setFont("helvetica","bold"),ve.text("LABOR",Je,ct),ct+=8,kt("SUPERVISION",Te,Ue,Fe),kt("OPERATORS",Ve,gt,Ht),kt("LABORERS",_e,Vt,zt);const Pt=Ue+gt+Vt,Zt=Fe+Ht+zt;ve.setFillColor(...St),ve.rect(Je,ct,Be-Je*2,12,"F"),ve.setTextColor(255,255,255),ve.setFontSize(10),ve.setFont("helvetica","bold"),ve.text("LABOR TOTAL:",Je+5,ct+8),ve.text(`${Pt} Reg + ${Zt} OT = ${Pt+Zt} Hours`,Be-Je-5,ct+8,{align:"right"}),ct+=20}ct>jt-100&&(ve.addPage(),ct=Je);const sr={},Pr={},Nt=["Containment","PPE","Disposal","Equipment","Other"];xe.forEach(Pt=>{Pt.t_and_m_items&&Pt.t_and_m_items.forEach(Zt=>{const ae=Zt.custom_name||Zt.materials_equipment?.name||"Unknown",be=Zt.custom_category||Zt.materials_equipment?.category||"Other",me=Zt.materials_equipment?.unit||"each",pe=Zt.materials_equipment?.cost_per_unit||0,Se=Zt.quantity*pe;sr[be]||(sr[be]=[],Pr[be]=0),sr[be].push([U(Pt.work_date),ae,Zt.quantity.toString(),me,`$${pe.toFixed(2)}`,`$${Se.toFixed(2)}`]),Pr[be]+=Se})});const fa=(Pt,Zt,ae)=>{!Zt||Zt.length===0||(ct>jt-80&&(ve.addPage(),ct=Je),ve.setTextColor(...St),ve.setFontSize(11),ve.setFont("helvetica","bold"),ve.text(Pt.toUpperCase(),Je,ct),ct+=5,Jf(ve,{startY:ct,head:[["Date","Item","Qty","Unit","Rate","Total"]],body:Zt,margin:{left:Je,right:Je},headStyles:{fillColor:St,textColor:[255,255,255],fontStyle:"bold",fontSize:9},bodyStyles:{fontSize:9,textColor:[51,65,85]},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{2:{halign:"center",cellWidth:20},3:{halign:"center",cellWidth:25},4:{halign:"right",cellWidth:25},5:{halign:"right",cellWidth:30}},foot:[["","","","","Subtotal:",`$${ae.toFixed(2)}`]],footStyles:{fillColor:Ft,textColor:[255,255,255],fontStyle:"bold",fontSize:9}}),ct=ve.lastAutoTable.finalY+10)};Object.keys(sr).length>0&&(ve.setTextColor(...St),ve.setFontSize(12),ve.setFont("helvetica","bold"),ve.text("MATERIALS & EQUIPMENT",Je,ct),ct+=8,Nt.forEach(Pt=>{sr[Pt]&&fa(Pt,sr[Pt],Pr[Pt])}),Object.keys(sr).forEach(Pt=>{Nt.includes(Pt)||fa(Pt,sr[Pt],Pr[Pt])}),ve.setFillColor(...St),ve.rect(Je,ct,Be-Je*2,12,"F"),ve.setTextColor(255,255,255),ve.setFontSize(10),ve.setFont("helvetica","bold"),ve.text("MATERIALS TOTAL:",Je+5,ct+8),ve.text(`$${Ce.toFixed(2)}`,Be-Je-5,ct+8,{align:"right"}),ct+=20),ct>jt-80&&(ve.addPage(),ct=Je),ct+=10,ve.setDrawColor(...St),ve.setLineWidth(1),ve.line(Je,ct,Be-Je,ct),ct+=15,ve.setTextColor(...St),ve.setFontSize(12),ve.setFont("helvetica","bold"),ve.text("AUTHORIZATION",Je,ct),ct+=10,ve.setFontSize(10),ve.setFont("helvetica","normal"),ve.setTextColor(71,85,105),ve.text("I hereby authorize the above time and materials charges as accurate and approved for billing.",Je,ct),ct+=20;const Ea=ticketsToExport[0]||{},xn=(Pt,Zt,ae,be,me,pe,Se)=>{ve.setFont("helvetica","bold"),ve.setFontSize(8),ve.setTextColor(...St),ve.text(Zt,Je,Pt),ve.setFont("helvetica","normal"),ve.setFontSize(9),ve.setTextColor(100,116,139);const we=Pt+18;if(ve.setDrawColor(...Ft),ve.setLineWidth(.5),ve.line(Je,we,Je+70,we),ve.text("Signature",Je,we+8),ve.line(Je+85,we,Je+145,we),ve.text("Title / Company",Je+85,we+8),ve.line(Be-Je-40,we,Be-Je,we),ve.text("Date",Be-Je-40,we+8),ae)try{if(ve.addImage(ae,"PNG",Je,we-16,60,16),be&&(ve.setFontSize(8),ve.text(be,Je,we+15)),me||pe){const $e=[me,pe].filter(Boolean).join(" - ");ve.text($e,Je+85,we-5)}if(Se){const $e=new Date(Se).toLocaleDateString();ve.text($e,Be-Je-40,we-5)}}catch($e){console.error("Error adding signature to PDF:",$e)}return we+25};ct=xn(ct,"GC AUTHORIZATION",Ea.gc_signature_data,Ea.gc_signature_name,Ea.gc_signature_title,Ea.gc_signature_company,Ea.gc_signature_date),ct+=8,ct=xn(ct,"CLIENT AUTHORIZATION",Ea.client_signature_data,Ea.client_signature_name,Ea.client_signature_title,Ea.client_signature_company,Ea.client_signature_date);const Ra=ve.internal.getNumberOfPages();for(let Pt=1;Pt<=Ra;Pt++){ve.setPage(Pt);const Zt=jt-15;ve.setFontSize(8),ve.setTextColor(148,163,184),ve.text(`${e?.name||"Company"} - T&M Report - ${t.name}`,Je,Zt),ve.text(`Page ${Pt} of ${Ra}`,Be-Je,Zt,{align:"right"})}const nn=`${t.name}_TM_Report_${new Date().toISOString().split("T")[0]}.pdf`;ve.save(nn),r("PDF exported!","success")},je=ee.useMemo(()=>{let xe=d==="all"?[...n]:n.filter(ve=>ve.status===d);if(C.start){const ve=new Date(C.start);ve.setHours(0,0,0,0),xe=xe.filter(Be=>new Date(Be.work_date)>=ve)}if(C.end){const ve=new Date(C.end);ve.setHours(23,59,59,999),xe=xe.filter(Be=>new Date(Be.work_date)<=ve)}if(b==="recent"){const ve=new Date;ve.setDate(ve.getDate()-7),ve.setHours(0,0,0,0),xe=xe.filter(Be=>new Date(Be.work_date)>=ve)}return xe},[n,d,b,C]),Ne=ee.useMemo(()=>{if(b!=="all")return null;const xe={};return je.forEach(ve=>{const Be=new Date(ve.work_date),jt=`${Be.getFullYear()}-${String(Be.getMonth()+1).padStart(2,"0")}`,Je=Be.toLocaleDateString("en-US",{month:"long",year:"numeric"});xe[jt]||(xe[jt]={label:Je,tickets:[],hours:0,cost:0}),xe[jt].tickets.push(ve),xe[jt].hours+=fe(ve),xe[jt].cost+=te(ve)}),Object.entries(xe).sort((ve,Be)=>Be[0].localeCompare(ve[0]))},[je,b]);ee.useEffect(()=>{if(Ne&&Ne.length>0){const xe=Ne[0][0];E(new Set([xe]))}},[Ne]);const ge=xe=>{const ve=new Set(w);ve.has(xe)?ve.delete(xe):ve.add(xe),E(ve)},Ie=je.reduce((xe,ve)=>xe+fe(ve),0),le=je.reduce((xe,ve)=>xe+te(ve),0),Ge=d==="all"?n.length:n.filter(xe=>xe.status===d).length;if(l)return i.jsx("div",{className:"loading",children:"Loading T&M tickets..."});const rt=je.length>0&&je.every(xe=>x.has(xe.id)),ue=x.size>0,ot=xe=>i.jsxs("div",{className:`tm-ticket-card ${xe.status} ${x.has(xe.id)?"selected":""}`,children:[i.jsxs("div",{className:"tm-ticket-header",onClick:()=>v(m===xe.id?null:xe.id),children:[i.jsx("input",{type:"checkbox",checked:x.has(xe.id),onChange:ve=>j(xe.id,ve),onClick:ve=>ve.stopPropagation(),className:"tm-checkbox"}),i.jsxs("div",{className:"tm-ticket-info",children:[i.jsx("span",{className:"tm-ticket-date",children:U(xe.work_date)}),xe.ce_pco_number&&i.jsx("span",{className:"tm-ce-badge",children:xe.ce_pco_number}),i.jsx("span",{className:`tm-ticket-status ${xe.status}`,children:xe.status})]}),i.jsxs("div",{className:"tm-ticket-summary",children:[i.jsxs("span",{className:"tm-ticket-hours",children:[fe(xe)," hrs"]}),i.jsxs("span",{className:"tm-ticket-total",children:["$",te(xe).toFixed(2)]}),i.jsx("span",{className:"tm-expand-arrow",children:m===xe.id?"":""})]})]}),m===xe.id&&i.jsxs("div",{className:"tm-ticket-details",children:[xe.t_and_m_workers?.length>0&&i.jsxs("div",{className:"tm-detail-section",children:[i.jsxs("h4",{children:[i.jsx(bs,{size:16,className:"inline-icon"})," Workers"]}),i.jsx("div",{className:"tm-detail-list",children:xe.t_and_m_workers.map(ve=>i.jsxs("div",{className:"tm-detail-row",children:[i.jsxs("span",{children:[ve.role&&ve.role!=="Laborer"&&i.jsx("span",{className:"tm-role-badge",children:ve.role}),ve.name]}),i.jsxs("span",{children:[ve.hours," hrs",parseFloat(ve.overtime_hours)>0&&i.jsxs("span",{className:"tm-ot-badge",children:[" +",ve.overtime_hours," OT"]})]})]},ve.id))})]}),xe.t_and_m_items?.length>0&&i.jsxs("div",{className:"tm-detail-section",children:[i.jsxs("h4",{children:[i.jsx(Q0,{size:16,className:"inline-icon"})," Materials & Equipment"]}),i.jsx("div",{className:"tm-detail-list",children:xe.t_and_m_items.map(ve=>i.jsxs("div",{className:"tm-detail-row",children:[i.jsx("span",{children:ve.custom_name?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"tm-custom-badge",children:"Custom"})," ",ve.custom_name]}):ve.materials_equipment?.name}),i.jsxs("span",{className:"tm-detail-qty",children:[ve.quantity," ",ve.materials_equipment?.unit||"each",ve.materials_equipment?.cost_per_unit>0&&i.jsxs("span",{className:"tm-item-cost",children:["$",(ve.quantity*ve.materials_equipment.cost_per_unit).toFixed(2)]})]})]},ve.id))})]}),xe.notes&&i.jsxs("div",{className:"tm-detail-section",children:[i.jsxs("h4",{children:[i.jsx(ho,{size:16,className:"inline-icon"})," Description"]}),i.jsx("p",{className:"tm-notes-text",children:xe.notes})]}),xe.photos&&xe.photos.length>0&&i.jsxs("div",{className:"tm-detail-section",children:[i.jsxs("h4",{children:[i.jsx(Mp,{size:16,className:"inline-icon"})," Photos (",xe.photos.length,")"]}),i.jsx("div",{className:"tm-photos-grid",children:xe.photos.map((ve,Be)=>i.jsx("a",{href:ve,target:"_blank",rel:"noopener noreferrer",className:"tm-photo-thumb",children:i.jsx("img",{src:ve,alt:`Photo ${Be+1}`})},Be))})]}),xe.ce_pco_number&&xe.change_order_value>0&&i.jsxs("div",{className:"tm-change-order-value",children:[i.jsx("span",{className:"tm-co-label",children:"Change Order Value:"}),i.jsxs("span",{className:"tm-co-amount",children:["$",xe.change_order_value.toLocaleString()]})]}),i.jsxs("div",{className:"tm-ticket-actions",children:[xe.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{className:"btn btn-success btn-small",onClick:ve=>{ve.stopPropagation(),X(xe)},children:["Approve ",xe.ce_pco_number?"+ CO":""]}),i.jsx("button",{className:"btn btn-warning btn-small",onClick:ve=>{ve.stopPropagation(),ie(xe.id,"rejected")},children:"Reject"})]}),xe.status==="approved"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"btn btn-primary btn-small",onClick:ve=>{ve.stopPropagation(),ie(xe.id,"billed")},children:"Mark Billed"}),i.jsxs("button",{className:"btn btn-secondary btn-small",onClick:ve=>{ve.stopPropagation(),M(xe),D(!0)},children:[i.jsx(i2,{size:14})," Signature Link"]})]}),xe.status==="rejected"&&i.jsx("button",{className:"btn btn-secondary btn-small",onClick:ve=>{ve.stopPropagation(),ie(xe.id,"pending")},children:"Restore"}),i.jsx("button",{className:"btn btn-danger btn-small",onClick:ve=>{ve.stopPropagation(),K(xe.id)},children:"Delete"})]})]})]},xe.id);return i.jsxs("div",{className:"tm-list",children:[i.jsxs("div",{className:"tm-list-header",children:[i.jsxs("div",{className:"tm-list-title",children:[i.jsx("h3",{children:"T&M Tickets"}),i.jsxs("div",{className:"tm-export-buttons",children:[ue&&i.jsxs("button",{className:"btn btn-ghost btn-small",onClick:I,children:["Clear (",x.size,")"]}),i.jsxs("button",{className:"btn btn-secondary btn-small",onClick:ne,children:["Excel ",ue?`(${x.size})`:""]}),i.jsxs("button",{className:"btn btn-primary btn-small",onClick:se,children:["PDF ",ue?`(${x.size})`:""]})]})]}),i.jsx("div",{className:"tm-filter-tabs",children:["all","pending","approved","billed","rejected"].map(xe=>i.jsxs("button",{className:`tm-filter-tab ${d===xe?"active":""}`,onClick:()=>{f(xe),I()},children:[xe.charAt(0).toUpperCase()+xe.slice(1),i.jsx("span",{className:"tm-filter-count",children:xe==="all"?n.length:n.filter(ve=>ve.status===xe).length})]},xe))}),i.jsxs("div",{className:"view-mode-bar",children:[i.jsxs("div",{className:"view-mode-tabs",children:[i.jsx("button",{className:`view-mode-tab ${b==="recent"?"active":""}`,onClick:()=>{_("recent"),A({start:"",end:""})},children:"Recent (7 days)"}),i.jsxs("button",{className:`view-mode-tab ${b==="all"?"active":""}`,onClick:()=>_("all"),children:["All (",Ge,")"]})]}),b==="all"&&i.jsxs("div",{className:"date-filter",children:[i.jsx(Z0,{size:16}),i.jsx("input",{type:"date",value:C.start,onChange:xe=>A(ve=>({...ve,start:xe.target.value})),placeholder:"Start date"}),i.jsx("span",{children:"to"}),i.jsx("input",{type:"date",value:C.end,onChange:xe=>A(ve=>({...ve,end:xe.target.value})),placeholder:"End date"}),(C.start||C.end)&&i.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>A({start:"",end:""}),children:"Clear"})]})]})]}),je.length>0&&i.jsxs("div",{className:"tm-summary-bar",children:[i.jsxs("div",{className:"tm-summary-stat",children:[i.jsx("span",{className:"tm-summary-label",children:"Tickets"}),i.jsx("span",{className:"tm-summary-value",children:je.length})]}),i.jsxs("div",{className:"tm-summary-stat",children:[i.jsx("span",{className:"tm-summary-label",children:"Total Hours"}),i.jsx("span",{className:"tm-summary-value",children:Ie.toFixed(1)})]}),i.jsxs("div",{className:"tm-summary-stat",children:[i.jsx("span",{className:"tm-summary-label",children:"Materials Cost"}),i.jsxs("span",{className:"tm-summary-value",children:["$",le.toFixed(2)]})]})]}),je.length===0?i.jsxs("div",{className:"tm-empty-state",children:[i.jsxs("p",{children:["No ",d==="all"?"":d," T&M tickets",b==="recent"?" in the last 7 days":""]}),b==="recent"&&Ge>0&&i.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>_("all"),children:"View All Tickets"})]}):i.jsxs("div",{className:"tm-tickets",children:[i.jsx("div",{className:"tm-select-all-row",children:i.jsxs("label",{className:"tm-checkbox-label",onClick:F,children:[i.jsx("input",{type:"checkbox",checked:rt,onChange:F,className:"tm-checkbox"}),i.jsxs("span",{children:["Select All (",je.length,")"]})]})}),b==="all"&&Ne?Ne.map(([xe,ve])=>i.jsxs("div",{className:"month-group",children:[i.jsxs("div",{className:"month-header",onClick:()=>ge(xe),children:[i.jsxs("div",{className:"month-header-left",children:[w.has(xe)?i.jsx(_c,{size:18}):i.jsx(Od,{size:18}),i.jsx("span",{className:"month-label",children:ve.label}),i.jsxs("span",{className:"month-count",children:[ve.tickets.length," tickets"]})]}),i.jsxs("div",{className:"month-header-right",children:[i.jsxs("span",{className:"month-stat",children:[ve.hours.toFixed(1)," hrs"]}),i.jsxs("span",{className:"month-stat",children:["$",ve.cost.toFixed(2)]})]})]}),w.has(xe)&&i.jsx("div",{className:"month-tickets",children:ve.tickets.map(Be=>ot(Be))})]},xe)):je.map(xe=>ot(xe))]}),O&&W&&i.jsx("div",{className:"modal-overlay",onClick:()=>G(!1),children:i.jsxs("div",{className:"modal change-order-modal",onClick:xe=>xe.stopPropagation(),children:[i.jsx("h3",{children:"Approve Change Order Work"}),i.jsxs("p",{className:"modal-subtitle",children:["This T&M ticket is associated with ",i.jsx("strong",{children:W.ce_pco_number})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Change Order Value ($)"}),i.jsx("input",{type:"number",value:q,onChange:xe=>L(xe.target.value),placeholder:"Enter the change order amount",autoFocus:!0}),i.jsx("p",{className:"form-help",children:"This amount will be added to the project's total contract value."})]}),i.jsxs("div",{className:"modal-actions",children:[i.jsx("button",{className:"btn btn-secondary",onClick:()=>G(!1),children:"Cancel"}),i.jsxs("button",{className:"btn btn-success",onClick:J,children:["Approve with $",parseFloat(q||0).toLocaleString()]})]})]})}),Z&&T&&i.jsx(uN,{documentType:"tm_ticket",documentId:T.id,companyId:e?.id,projectId:t?.id,documentTitle:`T&M Ticket - ${new Date(T.work_date).toLocaleDateString()}${T.ce_pco_number?` (${T.ce_pco_number})`:""}`,onClose:()=>{D(!1),M(null)},onShowToast:r})]})}function HH({project:t,onClose:e,onShareCreated:r}){const{user:a}=lN(),[n,s]=ee.useState(!1),[l,c]=ee.useState(null),[d,f]=ee.useState([]),[m,v]=ee.useState(!1),[x,g]=ee.useState({progress:!0,photos:!0,daily_reports:!0,tm_tickets:!1,crew_info:!1}),[b,_]=ee.useState("never"),[w,E]=ee.useState("");ee.useEffect(()=>{C()},[t.id]);const C=async()=>{try{const T=await nt.getProjectShares(t.id);f(T)}catch(T){console.error("Error loading shares:",T)}},A=T=>{g(M=>({...M,[T]:!M[T]}))},O=()=>{if(b==="never")return null;const T=new Date;if(b==="30days")T.setDate(T.getDate()+30);else if(b==="90days")T.setDate(T.getDate()+90);else if(b==="custom"&&w)return new Date(w).toISOString();return T.toISOString()},G=async()=>{s(!0);try{const T=O(),M=await nt.createProjectShare(t.id,a.id,x,T);c({type:"success",message:"Share link created!"}),v(!1),C(),r&&r(M)}catch(T){console.error("Error creating share:",T),c({type:"error",message:"Failed to create share link"})}finally{s(!1)}},W=T=>{const M=`${window.location.origin}/view/${T}`;navigator.clipboard.writeText(M),c({type:"success",message:"Link copied to clipboard!"})},B=async T=>{if(confirm("Are you sure you want to revoke this share link?"))try{await nt.revokeProjectShare(T),c({type:"success",message:"Share link revoked"}),C()}catch(M){console.error("Error revoking share:",M),c({type:"error",message:"Failed to revoke share link"})}},q=async T=>{if(confirm("Are you sure you want to permanently delete this share link?"))try{await nt.deleteProjectShare(T),c({type:"success",message:"Share link deleted"}),C()}catch(M){console.error("Error deleting share:",M),c({type:"error",message:"Failed to delete share link"})}},L=T=>T?new Date(T).toLocaleDateString():"Never",Z=T=>T?new Date(T)<new Date:!1,D=T=>{const M=[];return T.progress&&M.push("Progress"),T.photos&&M.push("Photos"),T.daily_reports&&M.push("Reports"),T.tm_tickets&&M.push("T&M"),T.crew_info&&M.push("Crew"),M.join(", ")};return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"modal-overlay",onClick:e,children:i.jsxs("div",{className:"modal-content share-modal",onClick:T=>T.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsxs("h2",{children:["Share Project: ",t.name]}),i.jsx("button",{className:"close-btn",onClick:e,children:""})]}),i.jsxs("div",{className:"modal-body",children:[d.length>0&&i.jsxs("div",{className:"existing-shares",children:[i.jsx("h3",{children:"Active Share Links"}),i.jsx("div",{className:"shares-list",children:d.map(T=>i.jsxs("div",{className:`share-item ${!T.is_active||Z(T.expires_at)?"inactive":""}`,children:[i.jsxs("div",{className:"share-info",children:[i.jsxs("div",{className:"share-token",children:[i.jsxs("code",{children:[window.location.origin,"/view/",T.share_token]}),i.jsx("button",{className:"btn-small",onClick:()=>W(T.share_token),disabled:!T.is_active||Z(T.expires_at),children:"Copy"})]}),i.jsxs("div",{className:"share-meta",children:[i.jsx("span",{className:"permissions",children:D(T.permissions)}),i.jsxs("span",{className:"expiry",children:["Expires: ",L(T.expires_at)]}),i.jsxs("span",{className:"views",children:["Views: ",T.view_count||0,T.last_viewed_at&&` (Last: ${L(T.last_viewed_at)})`]})]}),!T.is_active&&i.jsx("div",{className:"status-badge revoked",children:"Revoked"}),Z(T.expires_at)&&T.is_active&&i.jsx("div",{className:"status-badge expired",children:"Expired"})]}),i.jsxs("div",{className:"share-actions",children:[T.is_active&&!Z(T.expires_at)&&i.jsx("button",{className:"btn-secondary",onClick:()=>B(T.id),children:"Revoke"}),i.jsx("button",{className:"btn-danger",onClick:()=>q(T.id),children:"Delete"})]})]},T.id))})]}),!m&&i.jsx("button",{className:"btn-primary",onClick:()=>v(!0),children:"+ Create New Share Link"}),m&&i.jsxs("div",{className:"new-share-form",children:[i.jsx("h3",{children:"Create New Share Link"}),i.jsxs("div",{className:"form-section",children:[i.jsx("label",{children:"Permissions"}),i.jsxs("div",{className:"checkbox-group",children:[i.jsxs("label",{children:[i.jsx("input",{type:"checkbox",checked:x.progress,onChange:()=>A("progress")}),"Progress/completion status"]}),i.jsxs("label",{children:[i.jsx("input",{type:"checkbox",checked:x.photos,onChange:()=>A("photos")}),"Photos feed"]}),i.jsxs("label",{children:[i.jsx("input",{type:"checkbox",checked:x.daily_reports,onChange:()=>A("daily_reports")}),"Daily reports"]}),i.jsxs("label",{children:[i.jsx("input",{type:"checkbox",checked:x.tm_tickets,onChange:()=>A("tm_tickets")}),"T&M tickets"]}),i.jsxs("label",{children:[i.jsx("input",{type:"checkbox",checked:x.crew_info,onChange:()=>A("crew_info")}),"Crew information"]})]})]}),i.jsxs("div",{className:"form-section",children:[i.jsx("label",{children:"Link Expiration"}),i.jsxs("div",{className:"radio-group",children:[i.jsxs("label",{children:[i.jsx("input",{type:"radio",value:"never",checked:b==="never",onChange:T=>_(T.target.value)}),"Never expires"]}),i.jsxs("label",{children:[i.jsx("input",{type:"radio",value:"30days",checked:b==="30days",onChange:T=>_(T.target.value)}),"30 days"]}),i.jsxs("label",{children:[i.jsx("input",{type:"radio",value:"90days",checked:b==="90days",onChange:T=>_(T.target.value)}),"90 days"]}),i.jsxs("label",{children:[i.jsx("input",{type:"radio",value:"custom",checked:b==="custom",onChange:T=>_(T.target.value)}),"Custom date"]})]}),b==="custom"&&i.jsx("input",{type:"date",value:w,onChange:T=>E(T.target.value),min:new Date().toISOString().split("T")[0],className:"date-input"})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{className:"btn-secondary",onClick:()=>v(!1),children:"Cancel"}),i.jsx("button",{className:"btn-primary",onClick:G,disabled:n,children:n?"Generating...":"Generate Share Link"})]})]})]})]})}),l&&i.jsx(mu,{message:l.message,type:l.type,onClose:()=>c(null)}),i.jsx("style",{children:`
        .share-modal {
          max-width: 700px;
          max-height: 80vh;
          overflow-y: auto;
        }

        .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1.5rem;
          border-bottom: 1px solid var(--border-color);
        }

        .modal-header h2 {
          margin: 0;
          font-size: 1.25rem;
          color: var(--text-primary);
        }

        .close-btn {
          background: none;
          border: none;
          font-size: 2rem;
          cursor: pointer;
          color: var(--text-secondary);
          padding: 0;
          width: 2rem;
          height: 2rem;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .close-btn:hover {
          color: var(--text-primary);
        }

        .modal-body {
          padding: 1.5rem;
        }

        .existing-shares {
          margin-bottom: 2rem;
        }

        .existing-shares h3 {
          margin-top: 0;
          margin-bottom: 1rem;
          font-size: 1.1rem;
          color: var(--text-primary);
        }

        .shares-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .share-item {
          border: 1px solid var(--border-color);
          border-radius: 8px;
          padding: 1rem;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          gap: 1rem;
          background: var(--bg-card);
        }

        .share-item.inactive {
          opacity: 0.6;
          background-color: var(--bg-elevated);
        }

        .share-info {
          flex: 1;
        }

        .share-token {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
        }

        .share-token code {
          background-color: var(--bg-elevated);
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.875rem;
          flex: 1;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
          color: var(--text-primary);
        }

        .share-meta {
          display: flex;
          flex-wrap: wrap;
          gap: 1rem;
          font-size: 0.875rem;
          color: var(--text-secondary);
        }

        .status-badge {
          display: inline-block;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.75rem;
          font-weight: 500;
          margin-top: 0.5rem;
        }

        .status-badge.revoked {
          background-color: #fee2e2;
          color: #991b1b;
        }

        .status-badge.expired {
          background-color: #fef3c7;
          color: #92400e;
        }

        .share-actions {
          display: flex;
          gap: 0.5rem;
          flex-shrink: 0;
        }

        .new-share-form {
          border: 1px solid var(--border-color);
          border-radius: 8px;
          padding: 1.5rem;
          background-color: var(--bg-elevated);
        }

        .new-share-form h3 {
          margin-top: 0;
          margin-bottom: 1.5rem;
          font-size: 1.1rem;
          color: var(--text-primary);
        }

        .form-section {
          margin-bottom: 1.5rem;
        }

        .form-section label {
          display: block;
          font-weight: 500;
          margin-bottom: 0.5rem;
          color: var(--text-primary);
        }

        .checkbox-group,
        .radio-group {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .checkbox-group label,
        .radio-group label {
          font-weight: normal;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .checkbox-group input[type="checkbox"],
        .radio-group input[type="radio"] {
          margin: 0;
        }

        .date-input {
          margin-top: 0.5rem;
          padding: 0.5rem;
          border: 1px solid var(--border-color);
          border-radius: 4px;
          width: 100%;
          background: var(--bg-card);
          color: var(--text-primary);
        }

        .form-actions {
          display: flex;
          justify-content: flex-end;
          gap: 0.5rem;
          margin-top: 1.5rem;
        }

        .btn-small {
          padding: 0.25rem 0.75rem;
          font-size: 0.875rem;
          border: 1px solid var(--border-color);
          background-color: var(--bg-card);
          color: var(--text-primary);
          border-radius: 4px;
          cursor: pointer;
        }

        .btn-small:hover:not(:disabled) {
          background-color: var(--bg-elevated);
        }

        .btn-small:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-primary,
        .btn-secondary,
        .btn-danger {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-primary:hover:not(:disabled) {
          opacity: 0.9;
        }

        .btn-primary:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .btn-secondary {
          background-color: var(--bg-elevated);
          color: var(--text-primary);
          border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
          background-color: var(--bg-tertiary);
        }

        .btn-danger {
          background-color: #ef4444;
          color: white;
        }

        .btn-danger:hover {
          background-color: #dc2626;
        }
      `})]})}const Yv=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},$H=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});function WH({project:t,companyId:e,company:r,onShowToast:a}){const{branding:n}=ph(),[s,l]=ee.useState([]),[c,d]=ee.useState(null),[f,m]=ee.useState(!1),[v,x]=ee.useState(!0),[g,b]=ee.useState(null),[_,w]=ee.useState("recent"),[E,C]=ee.useState(new Set),[A,O]=ee.useState({start:"",end:""});ee.useEffect(()=>{G();const K=e||t?.company_id,te=K?nt.subscribeToInjuryReports?.(K,()=>{G()}):null;return()=>{te&&nt.unsubscribe?.(te)}},[t?.id,e]);const G=async()=>{x(!0);try{const K=t?await nt.getInjuryReports(t.id):await nt.getCompanyInjuryReports(e);l(K)}catch(K){console.error("Error loading injury reports:",K),b({type:"error",message:"Failed to load injury reports"})}finally{x(!1)}},W=()=>{G(),m(!1),b({type:"success",message:"Injury report created successfully"})},B=K=>{d(K)},q=()=>{d(null)},L=K=>K?new Date(K).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",Z=K=>K?new Date(`2000-01-01T${K}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"",D=K=>({minor:"Minor Injury",serious:"Serious Injury",critical:"Critical Injury",near_miss:"Near Miss"})[K]||K,T=K=>({reported:"#fbbf24",under_investigation:"#3b82f6",closed:"#10b981"})[K]||"#9ca3af",M=K=>({minor:"#10b981",serious:"#f59e0b",critical:"#ef4444",near_miss:"#6b7280"})[K]||"#9ca3af",V=ee.useMemo(()=>{let K=[...s];if(A.start){const te=new Date(A.start);te.setHours(0,0,0,0),K=K.filter(fe=>new Date(fe.incident_date)>=te)}if(A.end){const te=new Date(A.end);te.setHours(23,59,59,999),K=K.filter(fe=>new Date(fe.incident_date)<=te)}if(_==="recent"){const te=new Date;te.setDate(te.getDate()-7),te.setHours(0,0,0,0),K=K.filter(fe=>new Date(fe.incident_date)>=te)}return K},[s,_,A]),ie=ee.useMemo(()=>{if(_!=="all")return null;const K={};return V.forEach(te=>{const fe=new Date(te.incident_date),U=`${fe.getFullYear()}-${String(fe.getMonth()+1).padStart(2,"0")}`,j=fe.toLocaleDateString("en-US",{month:"long",year:"numeric"});K[U]||(K[U]={label:j,reports:[]}),K[U].reports.push(te)}),Object.entries(K).sort((te,fe)=>fe[0].localeCompare(te[0]))},[V,_]);ee.useEffect(()=>{if(ie&&ie.length>0){const K=ie[0][0];C(new Set([K]))}},[ie]);const X=K=>{const te=new Set(E);te.has(K)?te.delete(K):te.add(K),C(te)},J=async()=>{if(s.length===0){b({type:"error",message:"No reports to export"});return}b({type:"info",message:"Generating PDF..."});const K=new ur,te=K.internal.pageSize.getWidth(),fe=20;let U=fe;const j=Yv(n?.primary_color||"#3B82F6"),F=Yv(n?.secondary_color||"#1E40AF");K.setFillColor(...j),K.rect(0,0,te,45,"F"),K.setFillColor(...F),K.rect(0,42,te,3,"F");let I=fe;if(n?.logo_url)try{const se=await $H(n.logo_url);se&&(K.addImage(se,"PNG",fe,7,30,30),I=fe+40)}catch(se){console.error("Error adding logo:",se)}K.setTextColor(255,255,255),K.setFontSize(22),K.setFont("helvetica","bold"),K.text(r?.name||"Company",I,20),K.setFontSize(10),K.setFont("helvetica","normal"),K.text("INJURY & INCIDENT REPORTS",I,30),K.setFontSize(9),K.text(`Generated: ${new Date().toLocaleDateString()}`,te-fe,20,{align:"right"}),K.text(`Total Reports: ${s.length}`,te-fe,28,{align:"right"}),U=55,t&&(K.setFillColor(248,250,252),K.rect(fe,U-5,te-fe*2,15,"F"),K.setTextColor(...j),K.setFontSize(12),K.setFont("helvetica","bold"),K.text(`Project: ${t.name}`,fe+5,U+5),U+=20),s.forEach(se=>{U>200&&(K.addPage(),U=fe);const je=Yv(M(se.injury_type));K.setFillColor(...je),K.rect(fe,U,te-fe*2,12,"F"),K.setTextColor(255,255,255),K.setFontSize(11),K.setFont("helvetica","bold"),K.text(`${se.employee_name} - ${D(se.injury_type)}`,fe+5,U+8),K.text(L(se.incident_date),te-fe-5,U+8,{align:"right"}),U+=17,K.setTextColor(50,50,50),K.setFontSize(9),K.setFont("helvetica","normal"),K.text(`Location: ${se.incident_location}`,fe+5,U),se.incident_time&&K.text(`Time: ${Z(se.incident_time)}`,fe+100,U),U+=6,K.setFont("helvetica","bold"),K.text("Description:",fe+5,U),K.setFont("helvetica","normal"),U+=5;const Ne=K.splitTextToSize(se.incident_description,te-fe*2-10);K.text(Ne,fe+5,U),U+=Ne.length*4+3;const ge=[];se.body_part_affected&&ge.push(`Body Part: ${se.body_part_affected}`),se.osha_recordable&&ge.push("OSHA Recordable"),se.workers_comp_claim&&ge.push("Workers' Comp Filed"),se.medical_treatment_required&&ge.push("Medical Treatment Required"),ge.length>0&&(K.setFontSize(8),K.setTextColor(100,100,100),K.text(ge.join("  |  "),fe+5,U),U+=5),K.setFontSize(8),K.text(`Reported by: ${se.reported_by_name} (${se.reported_by_title})`,fe+5,U),U+=12});const z=K.internal.getNumberOfPages();for(let se=1;se<=z;se++)K.setPage(se),K.setFontSize(8),K.setTextColor(150,150,150),K.text(`Page ${se} of ${z}`,te/2,K.internal.pageSize.getHeight()-10,{align:"center"}),K.text("CONFIDENTIAL - Injury Report",fe,K.internal.pageSize.getHeight()-10);const ne=`Injury_Reports_${new Date().toISOString().split("T")[0]}.pdf`;K.save(ne),b({type:"success",message:"PDF exported!"})};return v?i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"spinner"}),i.jsx("p",{children:"Loading injury reports..."})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"injury-reports-section",children:[i.jsxs("div",{className:"section-header",children:[i.jsx("h3",{children:"Injury & Incident Reports"}),i.jsxs("div",{className:"section-header-actions",children:[s.length>0&&i.jsx("button",{className:"btn-secondary",onClick:J,children:"PDF"}),i.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"+ File Injury Report"})]})]}),i.jsxs("div",{className:"view-mode-bar",children:[i.jsxs("div",{className:"view-mode-tabs",children:[i.jsx("button",{className:`view-mode-tab ${_==="recent"?"active":""}`,onClick:()=>{w("recent"),O({start:"",end:""})},children:"Recent (7 days)"}),i.jsxs("button",{className:`view-mode-tab ${_==="all"?"active":""}`,onClick:()=>w("all"),children:["All (",s.length,")"]})]}),_==="all"&&i.jsxs("div",{className:"date-filter",children:[i.jsx(Z0,{size:16}),i.jsx("input",{type:"date",value:A.start,onChange:K=>O(te=>({...te,start:K.target.value})),placeholder:"Start date"}),i.jsx("span",{children:"to"}),i.jsx("input",{type:"date",value:A.end,onChange:K=>O(te=>({...te,end:K.target.value})),placeholder:"End date"}),(A.start||A.end)&&i.jsx("button",{className:"btn-ghost",onClick:()=>O({start:"",end:""}),children:"Clear"})]})]}),V.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx("div",{className:"empty-state-icon",children:""}),i.jsxs("h4",{children:["No Injury Reports",_==="recent"?" in the last 7 days":""]}),i.jsx("p",{children:'Click "File Injury Report" to document a workplace incident'}),_==="recent"&&s.length>0&&i.jsx("button",{className:"btn-secondary",onClick:()=>w("all"),children:"View All Reports"})]}):i.jsx("div",{className:"reports-list",children:_==="all"&&ie?ie.map(([K,te])=>i.jsxs("div",{className:"month-group",children:[i.jsx("div",{className:"month-header",onClick:()=>X(K),children:i.jsxs("div",{className:"month-header-left",children:[E.has(K)?i.jsx(_c,{size:18}):i.jsx(Od,{size:18}),i.jsx("span",{className:"month-label",children:te.label}),i.jsxs("span",{className:"month-count",children:[te.reports.length," reports"]})]})}),E.has(K)&&i.jsx("div",{className:"month-reports",children:te.reports.map(fe=>i.jsxs("div",{className:"report-card",onClick:()=>B(fe),children:[i.jsxs("div",{className:"report-header",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"report-date",children:[L(fe.incident_date)," at ",Z(fe.incident_time)]}),i.jsx("div",{className:"employee-name",children:fe.employee_name})]}),i.jsxs("div",{className:"report-badges",children:[i.jsx("span",{className:"badge",style:{backgroundColor:M(fe.injury_type)},children:D(fe.injury_type)}),i.jsx("span",{className:"badge",style:{backgroundColor:T(fe.status)},children:fe.status.replace("_"," ")})]})]}),i.jsxs("div",{className:"report-summary",children:[i.jsxs("div",{className:"summary-item",children:[i.jsx("strong",{children:"Location:"})," ",fe.incident_location]}),i.jsxs("div",{className:"summary-item",children:[i.jsx("strong",{children:"Reported by:"})," ",fe.reported_by_name," (",fe.reported_by_title,")"]}),fe.body_part_affected&&i.jsxs("div",{className:"summary-item",children:[i.jsx("strong",{children:"Body Part:"})," ",fe.body_part_affected]}),fe.osha_recordable&&i.jsx("div",{className:"summary-item",children:i.jsx("span",{className:"osha-badge",children:"OSHA Recordable"})})]}),i.jsxs("div",{className:"report-description",children:[fe.incident_description.substring(0,150),fe.incident_description.length>150&&"..."]}),i.jsx("div",{className:"report-footer",children:i.jsx("span",{children:"Click to view full details"})})]},fe.id))})]},K)):V.map(K=>i.jsxs("div",{className:"report-card",onClick:()=>B(K),children:[i.jsxs("div",{className:"report-header",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"report-date",children:[L(K.incident_date)," at ",Z(K.incident_time)]}),i.jsx("div",{className:"employee-name",children:K.employee_name})]}),i.jsxs("div",{className:"report-badges",children:[i.jsx("span",{className:"badge",style:{backgroundColor:M(K.injury_type)},children:D(K.injury_type)}),i.jsx("span",{className:"badge",style:{backgroundColor:T(K.status)},children:K.status.replace("_"," ")})]})]}),i.jsxs("div",{className:"report-summary",children:[i.jsxs("div",{className:"summary-item",children:[i.jsx("strong",{children:"Location:"})," ",K.incident_location]}),i.jsxs("div",{className:"summary-item",children:[i.jsx("strong",{children:"Reported by:"})," ",K.reported_by_name," (",K.reported_by_title,")"]}),K.body_part_affected&&i.jsxs("div",{className:"summary-item",children:[i.jsx("strong",{children:"Body Part:"})," ",K.body_part_affected]}),K.osha_recordable&&i.jsx("div",{className:"summary-item",children:i.jsx("span",{className:"osha-badge",children:"OSHA Recordable"})})]}),i.jsxs("div",{className:"report-description",children:[K.incident_description.substring(0,150),K.incident_description.length>150&&"..."]}),i.jsx("div",{className:"report-footer",children:i.jsx("span",{children:"Click to view full details"})})]},K.id))}),c&&i.jsx("div",{className:"modal-overlay",onClick:q,children:i.jsxs("div",{className:"modal-content report-details-modal",onClick:K=>K.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{children:"Injury Report Details"}),i.jsx("button",{className:"close-btn",onClick:q,children:""})]}),i.jsxs("div",{className:"modal-body",children:[i.jsxs("section",{className:"details-section",children:[i.jsx("h3",{children:"Incident Information"}),i.jsxs("div",{className:"detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Date & Time"}),i.jsxs("div",{children:[L(c.incident_date)," at ",Z(c.incident_time)]})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Location"}),i.jsx("div",{children:c.incident_location})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Injury Type"}),i.jsx("div",{children:i.jsx("span",{className:"badge",style:{backgroundColor:M(c.injury_type)},children:D(c.injury_type)})})]}),c.body_part_affected&&i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Body Part Affected"}),i.jsx("div",{children:c.body_part_affected})]})]}),i.jsxs("div",{className:"detail-item full-width",children:[i.jsx("label",{children:"Description"}),i.jsx("div",{className:"description-box",children:c.incident_description})]})]}),i.jsxs("section",{className:"details-section",children:[i.jsx("h3",{children:"Injured Employee"}),i.jsxs("div",{className:"detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Name"}),i.jsx("div",{children:c.employee_name})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Job Title"}),i.jsx("div",{children:c.employee_job_title})]}),c.employee_phone&&i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Phone"}),i.jsx("div",{children:c.employee_phone})]}),c.employee_email&&i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Email"}),i.jsx("div",{children:c.employee_email})]}),c.employee_address&&i.jsxs("div",{className:"detail-item full-width",children:[i.jsx("label",{children:"Address"}),i.jsx("div",{children:c.employee_address})]})]})]}),i.jsxs("section",{className:"details-section",children:[i.jsx("h3",{children:"Reported By"}),i.jsxs("div",{className:"detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Name"}),i.jsx("div",{children:c.reported_by_name})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Title"}),i.jsx("div",{children:c.reported_by_title})]}),c.reported_by_phone&&i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Phone"}),i.jsx("div",{children:c.reported_by_phone})]}),c.reported_by_email&&i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Email"}),i.jsx("div",{children:c.reported_by_email})]})]})]}),c.witnesses&&c.witnesses.length>0&&i.jsxs("section",{className:"details-section",children:[i.jsx("h3",{children:"Witnesses"}),c.witnesses.map((K,te)=>i.jsxs("div",{className:"witness-card",children:[i.jsxs("div",{className:"witness-header",children:[i.jsx("strong",{children:K.name}),K.phone&&i.jsxs("span",{children:["  ",K.phone]}),K.email&&i.jsxs("span",{children:["  ",K.email]})]}),K.testimony&&i.jsx("div",{className:"witness-testimony",children:i.jsxs("em",{children:['"',K.testimony,'"']})})]},te))]}),c.medical_treatment_required&&i.jsxs("section",{className:"details-section",children:[i.jsx("h3",{children:"Medical Treatment"}),i.jsxs("div",{className:"detail-grid",children:[c.medical_facility_name&&i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Facility"}),i.jsx("div",{children:c.medical_facility_name})]}),c.medical_facility_address&&i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Address"}),i.jsx("div",{children:c.medical_facility_address})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Hospitalized"}),i.jsx("div",{children:c.hospitalized?"Yes":"No"})]})]})]}),i.jsxs("section",{className:"details-section",children:[i.jsx("h3",{children:"Actions & Safety"}),c.immediate_actions_taken&&i.jsxs("div",{className:"detail-item full-width",children:[i.jsx("label",{children:"Immediate Actions Taken"}),i.jsx("div",{className:"description-box",children:c.immediate_actions_taken})]}),c.corrective_actions_planned&&i.jsxs("div",{className:"detail-item full-width",children:[i.jsx("label",{children:"Corrective Actions Planned"}),i.jsx("div",{className:"description-box",children:c.corrective_actions_planned})]}),i.jsxs("div",{className:"detail-grid",children:[c.safety_equipment_used&&i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Safety Equipment Used"}),i.jsx("div",{children:c.safety_equipment_used})]}),c.safety_equipment_failed&&i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Safety Equipment Failed"}),i.jsx("div",{children:c.safety_equipment_failed})]})]})]}),i.jsxs("section",{className:"details-section",children:[i.jsx("h3",{children:"Regulatory & Work Impact"}),i.jsxs("div",{className:"detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"OSHA Recordable"}),i.jsx("div",{children:c.osha_recordable?"Yes":"No"})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Workers' Comp Claim"}),i.jsx("div",{children:c.workers_comp_claim?"Yes":"No"})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Days Away From Work"}),i.jsx("div",{children:c.days_away_from_work||0})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Restricted Work Days"}),i.jsx("div",{children:c.restricted_work_days||0})]})]})]}),i.jsxs("div",{className:"report-meta",children:["Filed on ",L(c.created_at)]})]})]})}),f&&i.jsx(cN,{project:t,companyId:e,onClose:()=>m(!1),onReportCreated:W}),g&&i.jsx(mu,{message:g.message,type:g.type,onClose:()=>b(null)})]}),i.jsx("style",{children:`
        .injury-reports-section {
          margin-top: 2rem;
        }

        .section-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1.5rem;
        }

        .section-header h3 {
          margin: 0;
          font-size: 1.25rem;
          color: var(--text-primary);
        }

        .view-mode-bar {
          display: flex;
          justify-content: space-between;
          align-items: center;
          gap: 1rem;
          margin-bottom: 1rem;
          padding: 0.75rem;
          background: var(--bg-elevated);
          border-radius: 8px;
          flex-wrap: wrap;
        }

        .view-mode-tabs {
          display: flex;
          gap: 0.5rem;
        }

        .view-mode-tab {
          padding: 0.5rem 1rem;
          border: none;
          border-radius: 6px;
          font-size: 0.875rem;
          cursor: pointer;
          background: transparent;
          color: var(--text-secondary);
          transition: all 0.2s;
        }

        .view-mode-tab:hover {
          background: var(--bg-tertiary);
        }

        .view-mode-tab.active {
          background: var(--primary-color, #3b82f6);
          color: white;
        }

        .date-filter {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          color: var(--text-secondary);
        }

        .date-filter input[type="date"] {
          padding: 0.4rem 0.5rem;
          border: 1px solid var(--border-color);
          border-radius: 4px;
          font-size: 0.875rem;
          background: var(--bg-card);
          color: var(--text-primary);
        }

        .btn-ghost {
          background: transparent;
          border: none;
          padding: 0.4rem 0.75rem;
          color: var(--text-secondary);
          cursor: pointer;
          border-radius: 4px;
          font-size: 0.875rem;
        }

        .btn-ghost:hover {
          background: var(--bg-tertiary);
        }

        .month-group {
          margin-bottom: 0.5rem;
        }

        .month-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 0.75rem 1rem;
          background: var(--bg-elevated);
          border-radius: 8px;
          cursor: pointer;
          transition: background 0.2s;
        }

        .month-header:hover {
          background: var(--bg-tertiary);
        }

        .month-header-left {
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .month-label {
          font-weight: 600;
          color: var(--text-primary);
        }

        .month-count {
          font-size: 0.875rem;
          color: var(--text-secondary);
        }

        .month-reports {
          margin-top: 0.5rem;
          padding-left: 0.5rem;
        }

        .reports-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .report-card {
          background: var(--bg-card);
          border: 1px solid var(--border-color);
          border-radius: 8px;
          padding: 1.5rem;
          cursor: pointer;
          transition: all 0.2s;
        }

        .report-card:hover {
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
          border-color: var(--accent-primary);
        }

        .report-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 1rem;
        }

        .report-date {
          font-size: 0.875rem;
          color: var(--text-secondary);
          margin-bottom: 0.25rem;
        }

        .employee-name {
          font-size: 1.125rem;
          font-weight: 600;
          color: var(--text-primary);
        }

        .report-badges {
          display: flex;
          gap: 0.5rem;
          flex-wrap: wrap;
        }

        .badge {
          padding: 0.25rem 0.75rem;
          border-radius: 12px;
          font-size: 0.75rem;
          font-weight: 500;
          color: white;
          text-transform: capitalize;
        }

        .osha-badge {
          background-color: #dc2626;
          color: white;
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          font-size: 0.75rem;
          font-weight: 600;
        }

        .report-summary {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 0.75rem;
          margin-bottom: 1rem;
          padding: 1rem;
          background-color: var(--bg-elevated);
          border-radius: 6px;
        }

        .summary-item {
          font-size: 0.875rem;
          color: var(--text-secondary);
        }

        .summary-item strong {
          color: var(--text-primary);
        }

        .report-description {
          color: var(--text-secondary);
          line-height: 1.6;
          margin-bottom: 1rem;
        }

        .report-footer {
          text-align: right;
          font-size: 0.875rem;
          color: var(--primary-color, #3b82f6);
        }

        .report-details-modal {
          max-width: 900px;
          max-height: 90vh;
          overflow-y: auto;
        }

        .details-section {
          margin-bottom: 2rem;
          padding-bottom: 2rem;
          border-bottom: 1px solid var(--border-color);
        }

        .details-section:last-child {
          border-bottom: none;
        }

        .details-section h3 {
          margin-top: 0;
          margin-bottom: 1rem;
          font-size: 1.125rem;
          color: var(--text-primary);
        }

        .detail-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 1rem;
        }

        .detail-item label {
          display: block;
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--text-secondary);
          margin-bottom: 0.25rem;
        }

        .detail-item div {
          color: var(--text-primary);
        }

        .detail-item.full-width {
          grid-column: 1 / -1;
        }

        .description-box {
          background-color: var(--bg-elevated);
          border: 1px solid var(--border-color);
          border-radius: 6px;
          padding: 1rem;
          white-space: pre-wrap;
          line-height: 1.6;
          color: var(--text-primary);
        }

        .witness-card {
          background-color: var(--bg-elevated);
          border-radius: 6px;
          padding: 1rem;
          margin-bottom: 0.5rem;
        }

        .witness-header {
          margin-bottom: 0.5rem;
          color: var(--text-primary);
        }

        .witness-testimony {
          color: var(--text-secondary);
          font-size: 0.875rem;
          padding-left: 1rem;
          border-left: 3px solid var(--border-color);
        }

        .report-meta {
          text-align: center;
          font-size: 0.875rem;
          color: var(--text-secondary);
          padding-top: 1rem;
          border-top: 1px solid var(--border-color);
        }

        .empty-state {
          text-align: center;
          padding: 3rem 1rem;
        }

        .empty-state-icon {
          font-size: 3rem;
          margin-bottom: 1rem;
        }

        .empty-state h4 {
          margin: 0 0 0.5rem 0;
          color: var(--text-primary);
        }

        .empty-state p {
          margin: 0;
          color: var(--text-secondary);
        }

        .section-header-actions {
          display: flex;
          gap: 0.5rem;
          align-items: center;
        }

        .btn-primary, .btn-secondary {
          padding: 0.5rem 1rem;
          border-radius: 6px;
          font-weight: 500;
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--primary-color, #3b82f6);
          color: white;
        }

        .btn-secondary {
          background-color: var(--bg-elevated);
          color: var(--text-primary);
          border: 1px solid var(--border-color);
        }

        .btn-primary:hover, .btn-secondary:hover {
          opacity: 0.9;
        }

        .loading-container {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 3rem;
        }

        .spinner {
          width: 40px;
          height: 40px;
          border: 4px solid var(--border-color);
          border-top-color: var(--accent-primary);
          border-radius: 50%;
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .report-header {
            flex-direction: column;
            gap: 0.5rem;
          }

          .report-summary {
            grid-template-columns: 1fr;
          }

          .detail-grid {
            grid-template-columns: 1fr;
          }

          .report-details-modal {
            max-width: 100%;
            height: 100vh;
            max-height: 100vh;
            border-radius: 0;
          }
        }
      `})]})}const Xv=[{id:"message",label:"Messages",Icon:lc,description:"Chat messages from field"},{id:"material_request",label:"Material Requests",Icon:bc,description:"Equipment and material requests"},{id:"injury_report",label:"Safety Reports",Icon:gh,description:"Injury and safety incident reports"},{id:"tm_ticket",label:"T&M Tickets",Icon:uo,description:"Time and materials tickets"}];function VH({project:t,company:e,onShowToast:r,onClose:a}){const[n,s]=ee.useState([]),[l,c]=ee.useState({}),[d,f]=ee.useState([]),[m,v]=ee.useState(!0),[x,g]=ee.useState(!1);ee.useEffect(()=>{b()},[t?.id,e?.id]);const b=async()=>{if(!(!t?.id||!e?.id))try{v(!0);const A=await nt.getCompanyUsers(e.id);s(A);const O=await nt.getProjectNotificationPreferences(t.id),G={};O.forEach(B=>{G[B.user_id]={types:B.notification_types||[],presetId:null}}),c(G);const W=await nt.getNotificationPresets(e.id);f(W)}catch(A){console.error("Error loading notification settings:",A),r?.("Error loading notification settings","error")}finally{v(!1)}},_=(A,O)=>{c(G=>{const W=G[A]||{types:[]},B=W.types.includes(O)?W.types.filter(q=>q!==O):[...W.types,O];return{...G,[A]:{types:B,presetId:null}}})},w=(A,O)=>{const G=d.find(W=>W.id===O);G&&c(W=>({...W,[A]:{types:[...G.notification_types],presetId:O}}))},E=(A,O)=>{c(G=>({...G,[A]:{types:O?Xv.map(W=>W.id):[],presetId:null}}))},C=async()=>{try{g(!0);const A=Object.entries(l).map(([O,G])=>({userId:O,notificationTypes:G.types}));await nt.setProjectNotificationPreferences(t.id,A),r?.("Notification settings saved","success"),a?.()}catch(A){console.error("Error saving notification settings:",A),r?.("Error saving notification settings","error")}finally{g(!1)}};return m?i.jsxs("div",{className:"notification-settings",children:[i.jsxs("div",{className:"notification-settings-header",children:[i.jsx("h3",{children:"Notification Settings"}),i.jsx("button",{className:"close-btn",onClick:a,children:""})]}),i.jsx("div",{className:"loading-message",children:"Loading..."})]}):i.jsxs("div",{className:"notification-settings",children:[i.jsxs("div",{className:"notification-settings-header",children:[i.jsxs("h3",{children:["Notification Settings for ",t?.name]}),i.jsx("button",{className:"close-btn",onClick:a,children:""})]}),i.jsx("p",{className:"settings-description",children:"Choose who receives notifications when field workers send messages, request materials, submit safety reports, or create T&M tickets for this project."}),n.length===0?i.jsxs("div",{className:"no-users-message",children:[i.jsx("p",{children:"No users found in this company."}),i.jsx("small",{children:"Users need to be added to the company to receive notifications."})]}):i.jsx("div",{className:"notification-users-list",children:n.map(A=>{const O=l[A.id]||{types:[],presetId:null},G=O.types.length===Xv.length,W=O.types.length>0&&!G;return i.jsxs("div",{className:"notification-user-row",children:[i.jsxs("div",{className:"user-info",children:[i.jsx("div",{className:"user-avatar",children:A.name?.charAt(0).toUpperCase()||A.email?.charAt(0).toUpperCase()}),i.jsxs("div",{className:"user-details",children:[i.jsx("span",{className:"user-name",children:A.name||A.email}),A.role&&i.jsx("span",{className:"user-role",children:A.role})]})]}),i.jsxs("div",{className:"notification-controls",children:[i.jsxs("select",{className:"preset-select",value:O.presetId||"",onChange:B=>B.target.value&&w(A.id,B.target.value),children:[i.jsx("option",{value:"",children:"Apply preset..."}),d.map(B=>i.jsx("option",{value:B.id,children:B.name},B.id))]}),i.jsx("button",{className:`toggle-all-btn ${G?"all-on":W?"some-on":""}`,onClick:()=>E(A.id,!G),title:G?"Disable all":"Enable all",children:G?"All On":W?"Some":"None"})]}),i.jsx("div",{className:"notification-types",children:Xv.map(B=>i.jsxs("label",{className:`notification-type-toggle ${O.types.includes(B.id)?"active":""}`,title:B.description,children:[i.jsx("input",{type:"checkbox",checked:O.types.includes(B.id),onChange:()=>_(A.id,B.id)}),i.jsx("span",{className:"type-icon",children:i.jsx(B.Icon,{size:16})}),i.jsx("span",{className:"type-label",children:B.label})]},B.id))})]},A.id)})}),i.jsxs("div",{className:"notification-settings-footer",children:[i.jsx("button",{className:"btn-secondary",onClick:a,children:"Cancel"}),i.jsx("button",{className:"btn-primary",onClick:C,disabled:x,children:x?"Saving...":"Save Settings"})]})]})}function GH({project:t,company:e,onShowToast:r}){const[a,n]=ee.useState([]),[s,l]=ee.useState(!0),[c,d]=ee.useState("all"),[f,m]=ee.useState(null),[v,x]=ee.useState("recent"),[g,b]=ee.useState(new Set),[_,w]=ee.useState({start:"",end:""});ee.useEffect(()=>{E();const M=nt.subscribeToMaterialRequests?.(t.id,()=>{E()});return()=>{M&&nt.unsubscribe?.(M)}},[t.id]);const E=async()=>{try{const M=await nt.getMaterialRequests(t.id);n(M||[])}catch(M){console.error("Error loading material requests:",M),r?.("Error loading material requests","error")}finally{l(!1)}},C=async(M,V)=>{try{await nt.updateMaterialRequest(M,V,"Office"),n(a.map(ie=>ie.id===M?{...ie,status:V}:ie)),r?.(`Request ${V}`,"success")}catch(ie){console.error("Error updating status:",ie),r?.("Error updating status","error")}},A=M=>new Date(M).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),O=M=>new Date(M).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),G=M=>{switch(M){case"urgent":return"priority-urgent";case"low":return"priority-low";default:return"priority-normal"}},W=M=>{switch(M){case"urgent":return"";case"low":return"";default:return""}},B=ee.useMemo(()=>{let M=c==="all"?[...a]:a.filter(V=>V.status===c);if(_.start){const V=new Date(_.start);V.setHours(0,0,0,0),M=M.filter(ie=>new Date(ie.created_at)>=V)}if(_.end){const V=new Date(_.end);V.setHours(23,59,59,999),M=M.filter(ie=>new Date(ie.created_at)<=V)}if(v==="recent"){const V=new Date;V.setDate(V.getDate()-7),V.setHours(0,0,0,0),M=M.filter(ie=>new Date(ie.created_at)>=V)}return M},[a,c,v,_]),q=ee.useMemo(()=>{if(v!=="all")return null;const M={};return B.forEach(V=>{const ie=new Date(V.created_at),X=`${ie.getFullYear()}-${String(ie.getMonth()+1).padStart(2,"0")}`,J=ie.toLocaleDateString("en-US",{month:"long",year:"numeric"});M[X]||(M[X]={label:J,requests:[],itemCount:0}),M[X].requests.push(V),M[X].itemCount+=V.items?.length||0}),Object.entries(M).sort((V,ie)=>ie[0].localeCompare(V[0]))},[B,v]);ee.useEffect(()=>{if(q&&q.length>0){const M=q[0][0];b(new Set([M]))}},[q]);const L=M=>{const V=new Set(g);V.has(M)?V.delete(M):V.add(M),b(V)},Z={all:a.length,pending:a.filter(M=>M.status==="pending").length,ordered:a.filter(M=>M.status==="ordered").length,delivered:a.filter(M=>M.status==="delivered").length,cancelled:a.filter(M=>M.status==="cancelled").length},D=c==="all"?a.length:a.filter(M=>M.status===c).length;if(s)return i.jsx("div",{className:"loading",children:"Loading material requests..."});const T=M=>i.jsxs("div",{className:`material-request-card ${M.status} ${M.priority==="urgent"?"urgent":""}`,children:[i.jsxs("div",{className:"material-request-header-row",onClick:()=>m(f===M.id?null:M.id),children:[i.jsxs("div",{className:"material-request-info",children:[i.jsxs("span",{className:`material-priority-badge ${G(M.priority)}`,children:[W(M.priority)," ",M.priority]}),i.jsx("span",{className:"material-request-date",children:A(M.created_at)}),i.jsx("span",{className:"material-request-time",children:O(M.created_at)})]}),i.jsxs("div",{className:"material-request-summary",children:[i.jsxs("span",{className:"material-items-count",children:[M.items?.length||0," item",(M.items?.length||0)!==1?"s":""]}),i.jsx("span",{className:`material-status ${M.status}`,children:M.status}),i.jsx("span",{className:"material-expand-arrow",children:f===M.id?"":""})]})]}),f===M.id&&i.jsxs("div",{className:"material-request-details",children:[i.jsxs("div",{className:"material-detail-section",children:[i.jsxs("div",{className:"material-requester",children:[i.jsx("span",{className:"requester-label",children:"Requested by:"}),i.jsx("span",{className:"requester-name",children:M.requested_by||"Field"})]}),M.needed_by&&i.jsxs("div",{className:"material-needed-by",children:[i.jsx("span",{className:"needed-label",children:"Needed by:"}),i.jsx("span",{className:"needed-date",children:A(M.needed_by)})]})]}),M.items?.length>0&&i.jsxs("div",{className:"material-detail-section",children:[i.jsx("h4",{children:"Items Requested"}),i.jsx("div",{className:"material-items-list",children:M.items.map((V,ie)=>i.jsxs("div",{className:"material-item-row",children:[i.jsx("span",{className:"item-name",children:V.name}),i.jsxs("span",{className:"item-quantity",children:[V.quantity," ",V.unit]})]},ie))})]}),M.notes&&i.jsxs("div",{className:"material-detail-section",children:[i.jsx("h4",{children:"Notes"}),i.jsx("p",{className:"material-notes",children:M.notes})]}),i.jsxs("div",{className:"material-request-actions",children:[M.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"btn btn-success btn-small",onClick:V=>{V.stopPropagation(),C(M.id,"ordered")},children:"Mark Ordered"}),i.jsx("button",{className:"btn btn-danger btn-small",onClick:V=>{V.stopPropagation(),C(M.id,"cancelled")},children:"Cancel"})]}),M.status==="ordered"&&i.jsx("button",{className:"btn btn-success btn-small",onClick:V=>{V.stopPropagation(),C(M.id,"delivered")},children:"Mark Delivered"}),M.status==="cancelled"&&i.jsx("button",{className:"btn btn-secondary btn-small",onClick:V=>{V.stopPropagation(),C(M.id,"pending")},children:"Restore"})]})]})]},M.id);return i.jsxs("div",{className:"material-requests-list card",children:[i.jsxs("div",{className:"material-requests-header",children:[i.jsxs("div",{className:"material-requests-title",children:[i.jsx("h3",{children:"Material Requests"}),Z.pending>0&&i.jsxs("span",{className:"pending-badge",children:[Z.pending," pending"]})]}),i.jsx("div",{className:"material-filter-tabs",children:["all","pending","ordered","delivered","cancelled"].map(M=>i.jsxs("button",{className:`material-filter-tab ${c===M?"active":""}`,onClick:()=>d(M),children:[M.charAt(0).toUpperCase()+M.slice(1),i.jsx("span",{className:"material-filter-count",children:Z[M]})]},M))}),i.jsxs("div",{className:"view-mode-bar",children:[i.jsxs("div",{className:"view-mode-tabs",children:[i.jsx("button",{className:`view-mode-tab ${v==="recent"?"active":""}`,onClick:()=>{x("recent"),w({start:"",end:""})},children:"Recent (7 days)"}),i.jsxs("button",{className:`view-mode-tab ${v==="all"?"active":""}`,onClick:()=>x("all"),children:["All (",D,")"]})]}),v==="all"&&i.jsxs("div",{className:"date-filter",children:[i.jsx(Z0,{size:16}),i.jsx("input",{type:"date",value:_.start,onChange:M=>w(V=>({...V,start:M.target.value})),placeholder:"Start date"}),i.jsx("span",{children:"to"}),i.jsx("input",{type:"date",value:_.end,onChange:M=>w(V=>({...V,end:M.target.value})),placeholder:"End date"}),(_.start||_.end)&&i.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>w({start:"",end:""}),children:"Clear"})]})]})]}),B.length===0?i.jsxs("div",{className:"material-empty-state",children:[i.jsx("span",{className:"empty-icon",children:i.jsx(bc,{size:32})}),i.jsxs("p",{children:["No ",c==="all"?"":c," material requests",v==="recent"?" in the last 7 days":""]}),v==="recent"&&D>0&&i.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>x("all"),children:"View All Requests"})]}):i.jsx("div",{className:"material-requests",children:v==="all"&&q?q.map(([M,V])=>i.jsxs("div",{className:"month-group",children:[i.jsxs("div",{className:"month-header",onClick:()=>L(M),children:[i.jsxs("div",{className:"month-header-left",children:[g.has(M)?i.jsx(_c,{size:18}):i.jsx(Od,{size:18}),i.jsx("span",{className:"month-label",children:V.label}),i.jsxs("span",{className:"month-count",children:[V.requests.length," requests"]})]}),i.jsx("div",{className:"month-header-right",children:i.jsxs("span",{className:"month-stat",children:[V.itemCount," items"]})})]}),g.has(M)&&i.jsx("div",{className:"month-requests",children:V.requests.map(ie=>T(ie))})]},M)):B.map(M=>T(M))})]})}const VS=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},YH=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});function XH({project:t,company:e,onShowToast:r}){const{branding:a}=ph(),[n,s]=ee.useState([]),[l,c]=ee.useState(!0),[d,f]=ee.useState(null),[m,v]=ee.useState(new Set),[x,g]=ee.useState(!1),[b,_]=ee.useState("recent"),[w,E]=ee.useState(new Set),[C,A]=ee.useState({start:"",end:""});ee.useEffect(()=>{O();const fe=nt.subscribeToDailyReports?.(t.id,()=>{O()});return()=>{fe&&nt.unsubscribe?.(fe)}},[t.id]);const O=async()=>{try{const fe=await nt.getDailyReports(t.id,365);s(fe||[])}catch(fe){console.error("Error loading daily reports:",fe),r?.("Error loading daily reports","error")}finally{c(!1)}},G=ee.useMemo(()=>{let fe=[...n];if(C.start){const U=new Date(C.start);U.setHours(0,0,0,0),fe=fe.filter(j=>new Date(j.report_date||j.created_at)>=U)}if(C.end){const U=new Date(C.end);U.setHours(23,59,59,999),fe=fe.filter(j=>new Date(j.report_date||j.created_at)<=U)}if(b==="recent"){const U=new Date;U.setDate(U.getDate()-7),U.setHours(0,0,0,0),fe=fe.filter(j=>new Date(j.report_date||j.created_at)>=U)}return fe},[n,b,C]),W=ee.useMemo(()=>{if(b!=="all")return null;const fe={};return G.forEach(U=>{const j=new Date(U.report_date||U.created_at),F=`${j.getFullYear()}-${String(j.getMonth()+1).padStart(2,"0")}`,I=j.toLocaleDateString("en-US",{month:"long",year:"numeric"});fe[F]||(fe[F]={label:I,reports:[]}),fe[F].reports.push(U)}),Object.entries(fe).sort((U,j)=>j[0].localeCompare(U[0]))},[G,b]);ee.useEffect(()=>{if(W&&W.length>0){const fe=W[0][0];E(new Set([fe]))}},[W]);const B=()=>{g(!x),x&&v(new Set)},q=fe=>{const U=new Set(m);U.has(fe)?U.delete(fe):U.add(fe),v(U)},L=()=>{m.size===G.length?v(new Set):v(new Set(G.map(fe=>fe.id)))},Z=fe=>{const U=new Set(w);U.has(fe)?U.delete(fe):U.add(fe),E(U)},D=()=>m.size>0?G.filter(fe=>m.has(fe.id)):G,T=fe=>new Date(fe).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}),M=fe=>new Date(fe).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),V=fe=>{switch(fe){case"submitted":return"";case"reviewed":return"";case"draft":return"";default:return""}},ie=fe=>{switch(fe){case"submitted":return"Submitted";case"reviewed":return"Reviewed";case"draft":return"Draft";default:return fe}},X=async()=>{const fe=D();if(fe.length===0){r?.("No reports to export","error");return}r?.("Generating PDF...","info");const U=new ur,j=U.internal.pageSize.getWidth(),F=20;let I=F;const z=VS(a?.primary_color||"#3B82F6"),ne=VS(a?.secondary_color||"#1E40AF");U.setFillColor(...z),U.rect(0,0,j,45,"F"),U.setFillColor(...ne),U.rect(0,42,j,3,"F");let se=F;if(a?.logo_url)try{const ge=await YH(a.logo_url);ge&&(U.addImage(ge,"PNG",F,7,30,30),se=F+40)}catch(ge){console.error("Error adding logo:",ge)}U.setTextColor(255,255,255),U.setFontSize(22),U.setFont("helvetica","bold"),U.text(e?.name||"Company Name",se,20),U.setFontSize(10),U.setFont("helvetica","normal"),U.text("DAILY REPORTS SUMMARY",se,30),U.setFontSize(9),U.text(`Generated: ${new Date().toLocaleDateString()}`,j-F,20,{align:"right"}),t.job_number&&U.text(`Job #: ${t.job_number}`,j-F,28,{align:"right"}),I=55,U.setFillColor(248,250,252),U.rect(F,I-5,j-F*2,20,"F"),U.setTextColor(...z),U.setFontSize(14),U.setFont("helvetica","bold"),U.text(`Project: ${t.name}`,F+5,I+7),U.setFontSize(10),U.setTextColor(100,100,100),U.text(`${fe.length} Report${fe.length!==1?"s":""}`,j-F-5,I+7,{align:"right"}),I+=25,fe.forEach((ge,Ie)=>{I>250&&(U.addPage(),I=F),U.setFillColor(...z),U.setTextColor(255,255,255),U.rect(F,I,j-F*2,10,"F"),U.setFontSize(11),U.setFont("helvetica","bold"),U.text(T(ge.report_date||ge.created_at),F+5,I+7),U.text(ie(ge.status),j-F-5,I+7,{align:"right"}),I+=15,U.setTextColor(50,50,50),U.setFontSize(10),U.setFont("helvetica","normal");const le=`Crew: ${ge.crew_count||0}  |  Tasks: ${ge.tasks_completed||0}  |  T&M: ${ge.tm_tickets_count||0}  |  Photos: ${ge.photos_count||0}`;if(U.text(le,F+5,I),I+=8,ge.crew_list?.length>0){U.setFont("helvetica","bold"),U.text("Crew:",F+5,I),U.setFont("helvetica","normal");const Ge=ge.crew_list.map(ue=>`${ue.name} (${ue.role})`).join(", "),rt=U.splitTextToSize(Ge,j-F*2-30);U.text(rt,F+25,I),I+=rt.length*5+3}if(ge.field_notes){U.setFont("helvetica","bold"),U.text("Notes:",F+5,I),U.setFont("helvetica","normal");const Ge=U.splitTextToSize(ge.field_notes,j-F*2-30);U.text(Ge,F+25,I),I+=Ge.length*5+3}if(ge.issues){U.setTextColor(180,50,50),U.setFont("helvetica","bold"),U.text("Issues:",F+5,I),U.setFont("helvetica","normal");const Ge=U.splitTextToSize(ge.issues,j-F*2-30);U.text(Ge,F+25,I),U.setTextColor(50,50,50),I+=Ge.length*5+3}I+=10});const je=U.internal.getNumberOfPages();for(let ge=1;ge<=je;ge++)U.setPage(ge),U.setFontSize(8),U.setTextColor(150,150,150),U.text(`Page ${ge} of ${je}`,j/2,U.internal.pageSize.getHeight()-10,{align:"center"});const Ne=`${t.name}_Daily_Reports_${new Date().toISOString().split("T")[0]}.pdf`;U.save(Ne),r?.("PDF exported!","success")},J=fe=>i.jsxs("div",{className:`daily-report-card ${fe.status} ${m.has(fe.id)?"selected":""}`,children:[i.jsxs("div",{className:"daily-report-header-row",onClick:()=>f(d===fe.id?null:fe.id),children:[x&&i.jsx("input",{type:"checkbox",className:"report-checkbox",checked:m.has(fe.id),onChange:U=>{U.stopPropagation(),q(fe.id)},onClick:U=>U.stopPropagation()}),i.jsxs("div",{className:"daily-report-info",children:[i.jsx("span",{className:"report-date",children:T(fe.report_date||fe.created_at)}),i.jsxs("span",{className:`report-status ${fe.status}`,children:[V(fe.status)," ",ie(fe.status)]})]}),i.jsxs("div",{className:"daily-report-summary",children:[i.jsxs("span",{className:"report-crew",children:[fe.crew_count||0," crew"]}),i.jsxs("span",{className:"report-tasks",children:[fe.tasks_completed||0," tasks"]}),i.jsx("span",{className:"report-expand",children:d===fe.id?"":""})]})]}),d===fe.id&&i.jsxs("div",{className:"daily-report-details",children:[i.jsxs("div",{className:"report-stats-grid",children:[i.jsxs("div",{className:"report-stat",children:[i.jsx("span",{className:"stat-value",children:fe.crew_count||0}),i.jsx("span",{className:"stat-label",children:"Crew on Site"})]}),i.jsxs("div",{className:"report-stat",children:[i.jsx("span",{className:"stat-value",children:fe.tasks_completed||0}),i.jsx("span",{className:"stat-label",children:"Tasks Done"})]}),i.jsxs("div",{className:"report-stat",children:[i.jsx("span",{className:"stat-value",children:fe.tm_tickets_count||0}),i.jsx("span",{className:"stat-label",children:"T&M Tickets"})]}),i.jsxs("div",{className:"report-stat",children:[i.jsx("span",{className:"stat-value",children:fe.photos_count||0}),i.jsx("span",{className:"stat-label",children:"Photos"})]})]}),fe.crew_list?.length>0&&i.jsxs("div",{className:"report-section",children:[i.jsx("h4",{children:"Crew"}),i.jsx("div",{className:"report-crew-list",children:fe.crew_list.map((U,j)=>i.jsxs("div",{className:"crew-member",children:[i.jsx("span",{className:"crew-name",children:U.name}),i.jsx("span",{className:"crew-role",children:U.role})]},j))})]}),fe.completed_tasks?.length>0&&i.jsxs("div",{className:"report-section",children:[i.jsx("h4",{children:"Completed Today"}),i.jsx("ul",{className:"report-tasks-list",children:fe.completed_tasks.map((U,j)=>i.jsxs("li",{children:[U.name,U.group&&i.jsx("span",{className:"task-group",children:U.group})]},j))})]}),fe.field_notes&&i.jsxs("div",{className:"report-section",children:[i.jsx("h4",{children:"Field Notes"}),i.jsx("p",{className:"report-notes",children:fe.field_notes})]}),fe.issues&&i.jsxs("div",{className:"report-section issues",children:[i.jsx("h4",{children:"Issues / Concerns"}),i.jsx("p",{className:"report-issues",children:fe.issues})]}),fe.submitted_at&&i.jsx("div",{className:"report-meta",children:i.jsxs("span",{children:["Submitted by ",fe.submitted_by||"Field"," at ",M(fe.submitted_at)]})})]})]},fe.id);if(l)return i.jsx("div",{className:"loading",children:"Loading daily reports..."});const K=n.length,te=G.length;return i.jsxs("div",{className:"daily-reports-list card",children:[i.jsxs("div",{className:"daily-reports-header",children:[i.jsx("h3",{children:"Daily Reports"}),i.jsx("div",{className:"daily-reports-actions",children:n.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:`btn btn-small ${x?"btn-primary":"btn-secondary"}`,onClick:B,children:x?"Cancel":"Select"}),i.jsxs("button",{className:"btn btn-secondary btn-small",onClick:X,children:["PDF",m.size>0?` (${m.size})`:""]})]})})]}),n.length>0&&i.jsxs("div",{className:"view-mode-bar",children:[i.jsxs("div",{className:"view-mode-tabs",children:[i.jsx("button",{className:`view-mode-tab ${b==="recent"?"active":""}`,onClick:()=>_("recent"),children:"Recent (7 days)"}),i.jsxs("button",{className:`view-mode-tab ${b==="all"?"active":""}`,onClick:()=>_("all"),children:["All (",K,")"]})]}),b==="all"&&i.jsxs("div",{className:"date-filter",children:[i.jsx(Z0,{size:14,className:"date-filter-icon"}),i.jsx("input",{type:"date",value:C.start,onChange:fe=>A(U=>({...U,start:fe.target.value})),className:"date-input"}),i.jsx("span",{className:"date-separator",children:"to"}),i.jsx("input",{type:"date",value:C.end,onChange:fe=>A(U=>({...U,end:fe.target.value})),className:"date-input"}),(C.start||C.end)&&i.jsx("button",{className:"date-clear",onClick:()=>A({start:"",end:""}),children:"Clear"})]})]}),x&&G.length>0&&i.jsxs("div",{className:"select-all-bar",children:[i.jsxs("label",{className:"select-all-label",children:[i.jsx("input",{type:"checkbox",checked:m.size===G.length&&G.length>0,onChange:L}),"Select All (",G.length,")"]}),m.size>0&&i.jsxs("span",{className:"selected-count",children:[m.size," selected"]})]}),n.length===0?i.jsxs("div",{className:"reports-empty-state",children:[i.jsx("span",{className:"empty-icon",children:i.jsx(uo,{size:32})}),i.jsx("p",{children:"No daily reports yet"}),i.jsx("small",{children:"Reports from the field will appear here"})]}):G.length===0?i.jsxs("div",{className:"reports-empty-state",children:[i.jsx("span",{className:"empty-icon",children:i.jsx(uo,{size:32})}),i.jsx("p",{children:"No reports in this time period"}),i.jsx("small",{children:b==="recent"?"No reports in the last 7 days":"Try adjusting your date filter"})]}):b==="recent"?i.jsxs("div",{className:"daily-reports",children:[G.map(fe=>J(fe)),K>te&&i.jsx("div",{className:"view-all-prompt",children:i.jsxs("button",{className:"btn btn-secondary",onClick:()=>_("all"),children:["View All ",K," Reports"]})})]}):i.jsx("div",{className:"daily-reports grouped",children:W?.map(([fe,{label:U,reports:j}])=>i.jsxs("div",{className:"month-group",children:[i.jsxs("div",{className:"month-header",onClick:()=>Z(fe),children:[w.has(fe)?i.jsx(_c,{size:18,className:"month-chevron"}):i.jsx(Od,{size:18,className:"month-chevron"}),i.jsx("span",{className:"month-label",children:U}),i.jsxs("span",{className:"month-count",children:[j.length," report",j.length!==1?"s":""]})]}),w.has(fe)&&i.jsx("div",{className:"month-reports",children:j.map(F=>J(F))})]},fe))})]})}function KH({project:t,company:e,userName:r,onShowToast:a}){const[n,s]=ee.useState([]),[l,c]=ee.useState(!0),[d,f]=ee.useState(!1),[m,v]=ee.useState(""),[x,g]=ee.useState(0),[b,_]=ee.useState(!1),w=ee.useRef(null);ee.useEffect(()=>{E();const W=nt.subscribeToMessages?.(t.id,B=>{B.new&&(s(q=>[...q,B.new]),B.new.sender_type==="field"&&g(q=>q+1))});return()=>{W&&nt.unsubscribe?.(W)}},[t.id]),ee.useEffect(()=>{b&&(w.current?.scrollIntoView({behavior:"smooth"}),nt.markMessagesRead?.(t.id,"office"),g(0))},[n,b]);const E=async()=>{try{const B=(await nt.getMessages(t.id,50)||[]).sort((L,Z)=>new Date(L.created_at)-new Date(Z.created_at));s(B);const q=B.filter(L=>L.sender_type==="field"&&!L.is_read).length;g(q)}catch(W){console.error("Error loading messages:",W)}finally{c(!1)}},C=async()=>{if(m.trim()){f(!0);try{const W=await nt.sendMessage(t.id,m.trim(),"office",r||"Office");s(B=>[...B,W]),v("")}catch(W){console.error("Error sending message:",W),a?.("Error sending message","error")}finally{f(!1)}}},A=W=>{W.key==="Enter"&&!W.shiftKey&&(W.preventDefault(),C())},O=W=>{const B=new Date(W),q=new Date;return B.toDateString()===q.toDateString()?B.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):B.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})},G=n.slice(-3);return l?i.jsxs("div",{className:"project-messages card",children:[i.jsx("div",{className:"project-messages-header",children:i.jsx("h3",{children:"Messages"})}),i.jsx("div",{className:"loading",children:"Loading messages..."})]}):i.jsxs("div",{className:`project-messages card ${b?"expanded":""}`,children:[i.jsxs("div",{className:"project-messages-header",onClick:()=>_(!b),children:[i.jsxs("div",{className:"messages-title-row",children:[i.jsx("h3",{children:"Messages"}),x>0&&i.jsxs("span",{className:"messages-unread-badge",children:[x," new"]})]}),i.jsx("button",{className:"messages-toggle-btn",children:b?" Collapse":" Expand"})]}),!b&&n.length>0&&i.jsxs("div",{className:"messages-preview",children:[G.map(W=>i.jsxs("div",{className:`preview-message ${W.sender_type}`,children:[i.jsxs("span",{className:"preview-sender",children:[W.sender_type==="office"?i.jsx(D0,{size:12,className:"inline-icon"}):i.jsx(bs,{size:12,className:"inline-icon"})," ",W.sender_name,":"]}),i.jsxs("span",{className:"preview-text",children:[W.message?.slice(0,50),W.message?.length>50?"...":""]})]},W.id)),n.length===0&&i.jsx("p",{className:"no-messages-hint",children:"No messages yet. Click to start chatting."})]}),b&&i.jsxs("div",{className:"messages-full",children:[i.jsxs("div",{className:"messages-list-container",children:[n.length===0?i.jsxs("div",{className:"messages-empty",children:[i.jsx("span",{className:"empty-icon",children:i.jsx(lc,{size:32})}),i.jsx("p",{children:"No messages yet"}),i.jsx("small",{children:"Send a message to the field crew"})]}):n.map(W=>i.jsxs("div",{className:`message-bubble ${W.sender_type==="office"?"sent":"received"}`,children:[i.jsxs("div",{className:"message-sender",children:[W.sender_type==="office"?i.jsx(D0,{size:14,className:"inline-icon"}):i.jsx(bs,{size:14,className:"inline-icon"})," ",W.sender_name]}),i.jsx("div",{className:"message-text",children:W.message}),W.photo_url&&i.jsx("img",{src:W.photo_url,alt:"Attached",className:"message-photo"}),i.jsx("div",{className:"message-time",children:O(W.created_at)})]},W.id)),i.jsx("div",{ref:w})]}),i.jsxs("div",{className:"messages-input-row",children:[i.jsx("textarea",{value:m,onChange:W=>v(W.target.value),onKeyDown:A,placeholder:"Type a message...",rows:1,disabled:d}),i.jsx("button",{className:"btn btn-primary send-btn",onClick:C,disabled:d||!m.trim(),children:d?"...":"Send"})]})]})]})}function JH({project:t,company:e,onShowToast:r}){const[a,n]=ee.useState(null),[s,l]=ee.useState(!0),[c,d]=ee.useState(!1);ee.useEffect(()=>{if(t?.id&&e?.id){f();const b=nt.subscribeToCrewCheckins?.(t.id,()=>{f()});return()=>{b&&nt.unsubscribe?.(b)}}},[t?.id,e?.id]);const f=async()=>{try{const b=await nt.calculateManDayCosts(t.id,e.id,t.work_type||"demolition",t.job_type||"standard");n(b)}catch(b){console.error("Error loading man day costs:",b)}finally{l(!1)}},m=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),v=b=>new Date(b).toLocaleDateString("en-US",{month:"short",day:"numeric"}),x=b=>({foreman:"Foreman",supervisor:"Supervisor",operator:"Operator",laborer:"Laborer"})[b]||b.charAt(0).toUpperCase()+b.slice(1);if(s)return i.jsxs("div",{className:"man-day-costs card",children:[i.jsx("div",{className:"man-day-header",children:i.jsx("h3",{children:"Man Day Costs"})}),i.jsx("div",{className:"loading",children:"Loading..."})]});if(!a||a.totalManDays===0)return i.jsxs("div",{className:"man-day-costs card",children:[i.jsx("div",{className:"man-day-header",children:i.jsx("h3",{children:"Man Day Costs"})}),i.jsxs("div",{className:"man-day-empty",children:[i.jsx("span",{className:"empty-icon",children:i.jsx(bs,{size:32})}),i.jsx("p",{children:"No crew check-ins yet"}),i.jsx("small",{children:"Costs will appear as crew checks in from the field"})]})]});const g=Object.entries(a.byRole||{});return i.jsxs("div",{className:"man-day-costs card",children:[i.jsxs("div",{className:"man-day-header",onClick:()=>d(!c),children:[i.jsxs("div",{className:"man-day-title-row",children:[i.jsx("h3",{children:"Man Day Costs"}),i.jsx("span",{className:"man-day-total",children:m(a.totalCost)})]}),i.jsx("button",{className:"man-day-toggle",children:c?" Collapse":" Details"})]}),i.jsxs("div",{className:"man-day-summary",children:[i.jsxs("div",{className:"man-day-stat",children:[i.jsx("span",{className:"stat-value",children:a.daysWorked}),i.jsx("span",{className:"stat-label",children:"Days Worked"})]}),i.jsxs("div",{className:"man-day-stat",children:[i.jsx("span",{className:"stat-value",children:a.totalManDays}),i.jsx("span",{className:"stat-label",children:"Total Man Days"})]}),i.jsxs("div",{className:"man-day-stat",children:[i.jsx("span",{className:"stat-value",children:m(a.totalCost)}),i.jsx("span",{className:"stat-label",children:"Total Labor Cost"})]}),i.jsxs("div",{className:"man-day-stat",children:[i.jsx("span",{className:"stat-value",children:a.daysWorked>0?m(a.totalCost/a.daysWorked):"$0"}),i.jsx("span",{className:"stat-label",children:"Avg Cost/Day"})]})]}),c&&i.jsxs("div",{className:"man-day-details",children:[g.length>0&&i.jsxs("div",{className:"man-day-section",children:[i.jsx("h4",{children:"By Role"}),i.jsx("div",{className:"man-day-role-list",children:g.map(([b,_])=>i.jsxs("div",{className:"man-day-role-row",children:[i.jsxs("div",{className:"role-info",children:[i.jsx("span",{className:"role-name",children:x(b)}),i.jsxs("span",{className:"role-rate",children:[m(_.rate),"/day"]})]}),i.jsxs("div",{className:"role-stats",children:[i.jsxs("span",{className:"role-count",children:[_.count," days"]}),i.jsx("span",{className:"role-cost",children:m(_.cost)})]})]},b))})]}),a.byDate?.length>0&&i.jsxs("div",{className:"man-day-section",children:[i.jsx("h4",{children:"Recent Activity"}),i.jsx("div",{className:"man-day-date-list",children:a.byDate.slice(0,7).map((b,_)=>i.jsxs("div",{className:"man-day-date-row",children:[i.jsx("span",{className:"date-label",children:v(b.date)}),i.jsxs("span",{className:"date-workers",children:[b.workers," crew"]}),i.jsx("span",{className:"date-cost",children:m(b.cost)})]},_))}),a.byDate.length>7&&i.jsxs("p",{className:"man-day-more",children:["+ ",a.byDate.length-7," more days"]})]})]})]})}const Bi=t=>((t||0)/100).toFixed(2),Kt=t=>{const e=(t||0)/100;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)},cc=t=>Math.round((parseFloat(t)||0)*100),du=t=>((t||0)/100).toFixed(2),jn=t=>`${du(t)}%`,ad=t=>Math.round((parseFloat(t)||0)*100),ZH=(t,e,r,a)=>{const n=parseFloat(t)||0,s=parseFloat(e)||0,l=parseInt(r)||0,c=parseInt(a)||0,d=Math.round(n*l),f=Math.round(s*c),m=d+f;return{regularTotal:d,overtimeTotal:f,total:m}},GS=(t,e)=>{const r=parseFloat(t)||0,a=parseInt(e)||0;return Math.round(r*a)},Dp=(t,e)=>{const r=parseInt(t)||0,a=parseInt(e)||0;return Math.round(r*a/1e4)},Kv=(t,e)=>{const r=parseInt(t)||0,a=parseInt(e)||0;return Math.round(r*a/1e4)},R1=t=>{const e=(t.change_order_labor||[]).reduce((_,w)=>_+(parseInt(w.total)||0),0),r=(t.change_order_materials||[]).reduce((_,w)=>_+(parseInt(w.total)||0),0),a=(t.change_order_equipment||[]).reduce((_,w)=>_+(parseInt(w.total)||0),0),n=(t.change_order_subcontractors||[]).reduce((_,w)=>_+(parseInt(w.total)||0),0),s=Dp(e,t.labor_markup_percent||1500),l=Dp(r,t.materials_markup_percent||1500),c=Dp(a,t.equipment_markup_percent||1500),d=Dp(n,t.subcontractors_markup_percent||500),f=e+r+a+n+s+l+c+d,m=Kv(f,t.liability_insurance_percent||144),v=Kv(f,t.bond_percent||100),x=Kv(f,t.license_fee_percent||10),g=m+v+x,b=f+g;return{labor_subtotal:e,materials_subtotal:r,equipment_subtotal:a,subcontractors_subtotal:n,labor_markup_amount:s,materials_markup_amount:l,equipment_markup_amount:c,subcontractors_markup_amount:d,liability_insurance_amount:m,bond_amount:v,license_fee_amount:x,additional_fees_total:g,cor_subtotal:f,cor_total:b}},Jv=t=>{const e=[];if(t.title?.trim()||e.push("Title is required"),t.scope_of_work?.trim()||e.push("Scope of work is required"),t.period_start||e.push("Start date is required"),t.period_end||e.push("End date is required"),t.period_start&&t.period_end){const d=new Date(t.period_start);new Date(t.period_end)<d&&e.push("End date must be after start date")}const r=(t.change_order_labor||[]).length>0,a=(t.change_order_materials||[]).length>0,n=(t.change_order_equipment||[]).length>0,s=(t.change_order_subcontractors||[]).length>0;!r&&!a&&!n&&!s&&e.push("At least one line item (labor, materials, equipment, or subcontractor) is required"),R1(t).cor_total<=0&&e.push("COR total must be greater than zero");const c=5e3;return t.labor_markup_percent>c&&e.push("Labor markup percentage seems too high (>50%)"),t.materials_markup_percent>c&&e.push("Materials markup percentage seems too high (>50%)"),t.equipment_markup_percent>c&&e.push("Equipment markup percentage seems too high (>50%)"),t.subcontractors_markup_percent>c&&e.push("Subcontractors markup percentage seems too high (>50%)"),{valid:e.length===0,errors:e}},kk=t=>{const e={draft:{label:"Draft",color:"#6b7280",bgColor:"#f3f4f6"},pending_approval:{label:"Pending Approval",color:"#d97706",bgColor:"#fef3c7"},approved:{label:"Approved",color:"#059669",bgColor:"#d1fae5"},rejected:{label:"Rejected",color:"#dc2626",bgColor:"#fee2e2"},billed:{label:"Billed",color:"#2563eb",bgColor:"#dbeafe"},closed:{label:"Closed",color:"#4b5563",bgColor:"#e5e7eb"}};return e[t]||e.draft},hc=t=>t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",ey=(t,e)=>{const r=hc(t),a=hc(e);return r&&a?`${r} - ${a}`:r||a||""},nd={labor_markup:1500,materials_markup:1500,equipment_markup:1500,subcontractors_markup:500,liability_insurance:144,bond:100,license_fee:10},YS=["Foreman","Superintendent","Operator","Laborer"],QH=[{value:"standard",label:"Standard"},{value:"pla",label:"PLA (Project Labor Agreement)"},{value:"prevailing",label:"Prevailing Wage"}],Zv={materials:[{value:"backup_sheet",label:"Backup Sheet"},{value:"invoice",label:"Invoice"},{value:"mobilization",label:"Mobilization"},{value:"custom",label:"Custom Entry"}],equipment:[{value:"backup_sheet",label:"Backup Sheet"},{value:"invoice",label:"Invoice"},{value:"custom",label:"Custom Entry"}],subcontractors:[{value:"invoice",label:"Invoice"},{value:"quote",label:"Quote"},{value:"custom",label:"Custom Entry"}]},XS=["each","day","week","month","hour","sqft","lf","gallon","pound","ton","cy","lump sum"];function e$({project:t,company:e,areas:r,refreshKey:a,onShowToast:n,onCreateCOR:s,onViewCOR:l,onEditCOR:c}){const[d,f]=ee.useState([]),[m,v]=ee.useState(!0),[x,g]=ee.useState("all"),[b,_]=ee.useState("all"),[w,E]=ee.useState(null),[C,A]=ee.useState(new Set),[O,G]=ee.useState("recent"),[W,B]=ee.useState(new Set),[q,L]=ee.useState({start:"",end:""}),[Z,D]=ee.useState(null);ee.useEffect(()=>{T(),M();const j=nt.subscribeToCORs?.(t.id,()=>{T(),M()});return()=>{j&&nt.unsubscribe?.(j)}},[t.id,a]);const T=async()=>{try{const j=await nt.getCORs(t.id);f(j||[])}catch(j){console.error("Error loading CORs:",j),n?.("Error loading change order requests","error")}finally{v(!1)}},M=async()=>{try{const j=await nt.getCORStats?.(t.id);D(j)}catch(j){console.error("Error loading COR stats:",j)}},V=async(j,F)=>{if(F?.stopPropagation(),!!confirm("Are you sure you want to delete this COR? This action cannot be undone."))try{await nt.deleteCOR(j),f(d.filter(I=>I.id!==j)),n?.("COR deleted","success"),M()}catch(I){console.error("Error deleting COR:",I),n?.("Error deleting COR","error")}},ie=async(j,F)=>{F?.stopPropagation();try{await nt.submitCORForApproval(j),await T(),n?.("COR submitted for approval","success"),M()}catch(I){console.error("Error submitting COR:",I?.message||I),n?.(I?.message||"Error submitting COR","error")}},X=ee.useMemo(()=>{let j=[...d];if(x!=="all"&&(j=j.filter(F=>F.status===x)),b!=="all"&&(j=j.filter(F=>F.area_id===b)),q.start){const F=new Date(q.start);F.setHours(0,0,0,0),j=j.filter(I=>new Date(I.created_at)>=F)}if(q.end){const F=new Date(q.end);F.setHours(23,59,59,999),j=j.filter(I=>new Date(I.created_at)<=F)}if(O==="recent"){const F=new Date;F.setDate(F.getDate()-7),F.setHours(0,0,0,0),j=j.filter(I=>new Date(I.created_at)>=F)}return j.sort((F,I)=>new Date(I.created_at)-new Date(F.created_at)),j},[d,x,b,O,q]),J=ee.useMemo(()=>{if(O!=="all")return null;const j={};return X.forEach(F=>{const I=new Date(F.created_at),z=`${I.getFullYear()}-${String(I.getMonth()+1).padStart(2,"0")}`,ne=I.toLocaleDateString("en-US",{month:"long",year:"numeric"});j[z]||(j[z]={label:ne,cors:[],totalAmount:0}),j[z].cors.push(F),j[z].totalAmount+=F.cor_total||0}),Object.entries(j).sort((F,I)=>I[0].localeCompare(F[0]))},[X,O]);ee.useEffect(()=>{if(J&&J.length>0){const j=J[0][0];B(new Set([j]))}},[J]);const K=j=>{const F=new Set(W);F.has(j)?F.delete(j):F.add(j),B(F)},te=ee.useMemo(()=>({all:d.length,draft:d.filter(j=>j.status==="draft").length,pending_approval:d.filter(j=>j.status==="pending_approval").length,approved:d.filter(j=>j.status==="approved").length,rejected:d.filter(j=>j.status==="rejected").length,billed:d.filter(j=>j.status==="billed").length,closed:d.filter(j=>j.status==="closed").length}),[d]);x==="all"?d.length:d.filter(j=>j.status===x).length;const fe=j=>r?.find(I=>I.id===j)?.name||"No Area",U=j=>{const F=kk(j.status);j.id;const I=j.status==="draft",z=["draft","pending_approval","rejected"].includes(j.status),ne=j.status==="draft";return i.jsxs("div",{className:`cor-card ${j.status}`,onClick:()=>l?.(j),onKeyDown:se=>{(se.key==="Enter"||se.key===" ")&&(se.preventDefault(),l?.(j))},tabIndex:0,role:"button","aria-label":`View COR ${j.cor_number}: ${j.title||"Untitled"}, ${F.label}, ${Kt(j.cor_total||0)}`,children:[i.jsxs("div",{className:"cor-card-header",children:[i.jsxs("div",{className:"cor-card-left",children:[i.jsx("span",{className:"cor-number",children:j.cor_number}),i.jsx("span",{className:"cor-status-badge",style:{backgroundColor:F.bgColor,color:F.color},children:F.label})]}),i.jsx("div",{className:"cor-card-right",children:i.jsx("span",{className:"cor-total",children:Kt(j.cor_total||0)})})]}),i.jsxs("div",{className:"cor-card-body",children:[i.jsx("h4",{className:"cor-title",children:j.title||"Untitled COR"}),i.jsxs("div",{className:"cor-meta",children:[j.area_id&&i.jsx("span",{className:"cor-area",children:fe(j.area_id)}),i.jsx("span",{className:"cor-period",children:ey(j.period_start,j.period_end)})]})]}),i.jsxs("div",{className:"cor-card-footer",children:[i.jsx("span",{className:"cor-created",children:hc(j.created_at)}),i.jsxs("div",{className:"cor-actions",onClick:se=>se.stopPropagation(),children:[ne&&i.jsx("button",{className:"cor-action-btn submit",onClick:se=>ie(j.id,se),title:"Submit for Approval","aria-label":`Submit COR ${j.cor_number} for approval`,children:i.jsx(nN,{size:14,"aria-hidden":"true"})}),I&&i.jsx("button",{className:"cor-action-btn edit",onClick:se=>{se.stopPropagation(),c?.(j)},title:"Edit","aria-label":`Edit COR ${j.cor_number}`,children:i.jsx(o2,{size:14,"aria-hidden":"true"})}),i.jsx("button",{className:"cor-action-btn view",onClick:se=>{se.stopPropagation(),l?.(j)},title:"View Details","aria-label":`View COR ${j.cor_number} details`,children:i.jsx(cT,{size:14,"aria-hidden":"true"})}),z&&i.jsx("button",{className:"cor-action-btn delete",onClick:se=>V(j.id,se),title:"Delete","aria-label":`Delete COR ${j.cor_number}`,children:i.jsx(uc,{size:14,"aria-hidden":"true"})})]})]})]},j.id)};return m?i.jsx("div",{className:"loading",children:"Loading change order requests..."}):i.jsxs("div",{className:"cor-list",children:[i.jsxs("div",{className:"cor-list-header",children:[i.jsxs("div",{className:"cor-list-info",children:[i.jsx("h3",{children:"Change Orders"}),i.jsxs("div",{className:"cor-stats-inline",children:[i.jsxs("span",{className:"cor-stat-item",children:[te.all," total"]}),te.pending_approval>0&&i.jsxs("span",{className:"cor-stat-item pending",children:[te.pending_approval," pending"]}),Z?.totalApproved>0&&i.jsx("span",{className:"cor-stat-item approved",children:Kt(Z.totalApproved)})]})]}),i.jsxs("button",{className:"btn btn-primary btn-small",onClick:s,children:[i.jsx(Go,{size:14})," New COR"]})]}),i.jsxs("div",{className:"cor-controls",children:[i.jsx("div",{className:"cor-filter-pills",role:"tablist",children:[{id:"all",label:"All"},{id:"draft",label:"Draft"},{id:"pending_approval",label:"Pending"},{id:"approved",label:"Approved"}].map(j=>i.jsxs("button",{role:"tab","aria-selected":x===j.id,className:`cor-pill ${x===j.id?"active":""}`,onClick:()=>g(j.id),children:[j.label,te[j.id]>0&&i.jsx("span",{className:"cor-pill-count",children:te[j.id]})]},j.id))}),i.jsxs("div",{className:"cor-view-toggle",children:[i.jsx("button",{className:`cor-toggle-btn ${O==="recent"?"active":""}`,onClick:()=>{G("recent"),L({start:"",end:""})},children:"Recent"}),i.jsx("button",{className:`cor-toggle-btn ${O==="all"?"active":""}`,onClick:()=>G("all"),children:"All"})]})]}),O==="all"&&i.jsxs("div",{className:"cor-date-filter",children:[i.jsx(Z0,{size:14}),i.jsx("input",{type:"date",value:q.start,onChange:j=>L(F=>({...F,start:j.target.value}))}),i.jsx("span",{className:"cor-date-sep",children:"to"}),i.jsx("input",{type:"date",value:q.end,onChange:j=>L(F=>({...F,end:j.target.value}))}),(q.start||q.end)&&i.jsx("button",{className:"cor-clear-btn",onClick:()=>L({start:"",end:""}),children:"Clear"})]}),X.length===0?i.jsxs("div",{className:"cor-empty",children:[i.jsx(ho,{size:24,className:"cor-empty-icon"}),i.jsxs("p",{children:["No change orders ",x!=="all"?`(${x.replace("_"," ")})`:""]}),i.jsxs("button",{className:"btn btn-primary btn-small",onClick:s,children:[i.jsx(Go,{size:14})," Create COR"]})]}):i.jsx("div",{className:"cor-cards",children:O==="all"&&J?J.map(([j,F])=>i.jsxs("div",{className:"cor-month-group",children:[i.jsxs("button",{className:"cor-month-header",onClick:()=>K(j),children:[i.jsxs("div",{className:"cor-month-left",children:[W.has(j)?i.jsx(_c,{size:16}):i.jsx(Od,{size:16}),i.jsx("span",{children:F.label}),i.jsx("span",{className:"cor-month-count",children:F.cors.length})]}),i.jsx("span",{className:"cor-month-total",children:Kt(F.totalAmount)})]}),W.has(j)&&i.jsx("div",{className:"cor-month-items",children:F.cors.map(I=>U(I))})]},j)):X.map(j=>U(j))})]})}function t$({projectId:t,corId:e,onImport:r,onClose:a,onShowToast:n}){const[s,l]=ee.useState([]),[c,d]=ee.useState(!0),[f,m]=ee.useState(new Set),[v,x]=ee.useState(null),[g,b]=ee.useState(""),[_,w]=ee.useState("unassigned");ee.useEffect(()=>{E()},[t]);const E=async()=>{try{const q=await nt.getTMTickets(t);l(q||[])}catch(q){console.error("Error loading tickets:",q),n?.("Error loading tickets","error")}finally{d(!1)}},C=ee.useMemo(()=>{let q=[...s];if(_==="unassigned"?q=q.filter(L=>!L.assigned_cor_id):_==="approved"&&(q=q.filter(L=>L.status==="approved")),g){const L=g.toLowerCase();q=q.filter(Z=>Z.work_description?.toLowerCase().includes(L)||Z.ce_pco_number?.toLowerCase().includes(L)||Z.ticket_date?.includes(L))}return q.sort((L,Z)=>new Date(Z.ticket_date)-new Date(L.ticket_date)),q},[s,_,g]),A=q=>{const L=new Set(f);L.has(q)?L.delete(q):L.add(q),m(L)},O=()=>{f.size===C.length?m(new Set):m(new Set(C.map(q=>q.id)))},G=q=>new Date(q).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),W=q=>{const L=q.workers?.length||0,Z=q.items?.length||0,D=q.materials_equipment?.filter(M=>M.type==="equipment")?.length||0;let T=0;return q.workers?.forEach(M=>{T+=(parseFloat(M.regular_hours)||0)+(parseFloat(M.overtime_hours)||0)}),{workerCount:L,itemCount:Z,equipmentCount:D,laborHours:T}},B=()=>{if(f.size===0){n?.("Please select at least one ticket","error");return}const q=s.filter(T=>f.has(T.id)),L=[],Z=[],D=[];q.forEach(T=>{T.workers?.forEach(M=>{L.push({id:`import-${T.id}-${M.id||Date.now()}`,labor_class:M.role||"Laborer",wage_type:"standard",regular_hours:parseFloat(M.regular_hours)||0,overtime_hours:parseFloat(M.overtime_hours)||0,regular_rate:0,overtime_rate:0,total:0,source_ticket_id:T.id,source_ticket_date:T.ticket_date})}),T.items?.forEach(M=>{Z.push({id:`import-${T.id}-${M.id||Date.now()}`,description:M.description||M.name,source_type:"backup_sheet",source_reference:`Ticket ${G(T.ticket_date)}`,quantity:parseFloat(M.quantity)||1,unit:M.unit||"each",unit_cost:cc(M.unit_cost||0),total:cc((M.quantity||1)*(M.unit_cost||0)),source_ticket_id:T.id})}),T.materials_equipment?.filter(M=>M.type==="equipment").forEach(M=>{D.push({id:`import-${T.id}-${M.id||Date.now()}`,description:M.description||M.name,source_type:"backup_sheet",source_reference:`Ticket ${G(T.ticket_date)}`,quantity:parseFloat(M.quantity)||1,unit:M.unit||"day",unit_cost:cc(M.unit_cost||M.cost||0),total:cc((M.quantity||1)*(M.unit_cost||M.cost||0)),source_ticket_id:T.id})})}),r?.({ticketIds:Array.from(f),laborItems:L,materialsItems:Z,equipmentItems:D}),a?.()};return c?i.jsx("div",{className:"modal-overlay",onClick:a,role:"dialog","aria-modal":"true","aria-label":"Loading tickets",children:i.jsx("div",{className:"modal-content ticket-selector-modal",onClick:q=>q.stopPropagation(),children:i.jsx("div",{className:"loading",role:"status","aria-live":"polite",children:"Loading tickets..."})})}):i.jsx("div",{className:"modal-overlay",onClick:a,role:"dialog","aria-modal":"true","aria-labelledby":"ticket-selector-title",children:i.jsxs("div",{className:"modal-content ticket-selector-modal",onClick:q=>q.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{id:"ticket-selector-title",children:"Import from T&M Tickets"}),i.jsx("button",{className:"close-btn",onClick:a,"aria-label":"Close ticket selector",children:i.jsx(Rd,{size:20,"aria-hidden":"true"})})]}),i.jsxs("div",{className:"ticket-selector-controls",children:[i.jsxs("div",{className:"ticket-search",children:[i.jsx(PT,{size:16,"aria-hidden":"true"}),i.jsx("input",{type:"text",placeholder:"Search tickets...",value:g,onChange:q=>b(q.target.value),"aria-label":"Search tickets"})]}),i.jsxs("div",{className:"ticket-filters",role:"group","aria-label":"Filter tickets by status",children:[i.jsx("button",{className:`filter-btn ${_==="unassigned"?"active":""}`,onClick:()=>w("unassigned"),"aria-pressed":_==="unassigned",children:"Unassigned"}),i.jsx("button",{className:`filter-btn ${_==="approved"?"active":""}`,onClick:()=>w("approved"),"aria-pressed":_==="approved",children:"Approved"}),i.jsx("button",{className:`filter-btn ${_==="all"?"active":""}`,onClick:()=>w("all"),"aria-pressed":_==="all",children:"All"})]})]}),i.jsxs("div",{className:"ticket-selector-header",children:[i.jsxs("label",{className:"select-all",children:[i.jsx("input",{type:"checkbox",checked:f.size===C.length&&C.length>0,onChange:O,"aria-label":`Select all ${C.length} tickets`}),i.jsxs("span",{children:["Select All (",C.length,")"]})]}),i.jsxs("span",{className:"selected-count",children:[f.size," selected"]})]}),i.jsx("div",{className:"modal-body ticket-selector-body",children:C.length===0?i.jsxs("div",{className:"ticket-empty",children:[i.jsx(ho,{size:32}),i.jsx("p",{children:"No tickets found"}),_==="unassigned"&&i.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>w("all"),children:"Show all tickets"})]}):i.jsx("div",{className:"ticket-list",children:C.map(q=>{const L=W(q),Z=f.has(q.id),D=v===q.id;return i.jsxs("div",{className:`ticket-item ${Z?"selected":""} ${q.assigned_cor_id?"assigned":""}`,children:[i.jsxs("div",{className:"ticket-item-main",children:[i.jsx("label",{className:"ticket-checkbox",children:i.jsx("input",{type:"checkbox",checked:Z,onChange:()=>A(q.id),disabled:q.assigned_cor_id&&q.assigned_cor_id!==e})}),i.jsxs("div",{className:"ticket-item-info",onClick:()=>x(D?null:q.id),children:[i.jsxs("div",{className:"ticket-item-header",children:[i.jsx("span",{className:"ticket-date",children:G(q.ticket_date)}),i.jsx("span",{className:`ticket-status ${q.status}`,children:q.status}),q.ce_pco_number&&i.jsxs("span",{className:"ticket-pco",children:["CE/PCO: ",q.ce_pco_number]})]}),i.jsx("div",{className:"ticket-item-desc",children:q.work_description||"No description"}),i.jsxs("div",{className:"ticket-item-summary",children:[L.workerCount>0&&i.jsxs("span",{children:[i.jsx(y1,{size:12})," ",L.workerCount," workers"]}),L.itemCount>0&&i.jsxs("span",{children:[i.jsx(bc,{size:12})," ",L.itemCount," items"]}),L.equipmentCount>0&&i.jsxs("span",{children:[i.jsx(vh,{size:12})," ",L.equipmentCount," equipment"]}),L.laborHours>0&&i.jsxs("span",{children:[L.laborHours," hrs"]})]})]}),i.jsx("button",{className:"ticket-expand-btn",onClick:()=>x(D?null:q.id),children:D?i.jsx(_c,{size:16}):i.jsx(Od,{size:16})})]}),D&&i.jsxs("div",{className:"ticket-item-details",children:[q.workers?.length>0&&i.jsxs("div",{className:"ticket-detail-section",children:[i.jsx("h5",{children:"Workers"}),i.jsx("ul",{children:q.workers.map((T,M)=>i.jsxs("li",{children:[T.name||T.role," - ",T.regular_hours||0," reg hrs",T.overtime_hours>0&&`, ${T.overtime_hours} OT hrs`]},M))})]}),q.items?.length>0&&i.jsxs("div",{className:"ticket-detail-section",children:[i.jsx("h5",{children:"Materials"}),i.jsx("ul",{children:q.items.map((T,M)=>i.jsxs("li",{children:[T.description||T.name," - ",T.quantity," ",T.unit]},M))})]}),q.materials_equipment?.filter(T=>T.type==="equipment").length>0&&i.jsxs("div",{className:"ticket-detail-section",children:[i.jsx("h5",{children:"Equipment"}),i.jsx("ul",{children:q.materials_equipment.filter(T=>T.type==="equipment").map((T,M)=>i.jsx("li",{children:T.description||T.name},M))})]})]})]},q.id)})})}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{className:"btn btn-secondary",onClick:a,children:"Cancel"}),i.jsxs("button",{className:"btn btn-primary",onClick:B,disabled:f.size===0,children:[i.jsx(F0,{size:16})," Import ",f.size," Ticket",f.size!==1?"s":""]})]})]})})}const Fp=[{id:1,label:"Title & Info",shortLabel:"Info"},{id:2,label:"Period",shortLabel:"Period"},{id:3,label:"Labor",shortLabel:"Labor"},{id:4,label:"Materials",shortLabel:"Materials"},{id:5,label:"Equipment",shortLabel:"Equipment"},{id:6,label:"Subcontractors",shortLabel:"Subs"},{id:7,label:"Markups & Fees",shortLabel:"Markups"},{id:8,label:"Summary",shortLabel:"Summary"},{id:9,label:"Submit",shortLabel:"Submit"}];function r$({project:t,company:e,areas:r,existingCOR:a,onClose:n,onSaved:s,onShowToast:l}){const[c,d]=ee.useState(1),[f,m]=ee.useState(!1),[v,x]=ee.useState([]),[g,b]=ee.useState(!1),[_,w]=ee.useState(a?.title||""),[E,C]=ee.useState(a?.scope_of_work||""),[A,O]=ee.useState(a?.area_id||""),[G,W]=ee.useState(a?.cor_number||""),[B,q]=ee.useState(a?.period_start||""),[L,Z]=ee.useState(a?.period_end||""),[D,T]=ee.useState(a?.change_order_labor||[]),[M,V]=ee.useState(a?.change_order_materials||[]),[ie,X]=ee.useState(a?.change_order_equipment||[]),[J,K]=ee.useState(a?.change_order_subcontractors||[]),[te,fe]=ee.useState(a?.labor_markup_percent??nd.labor_markup),[U,j]=ee.useState(a?.materials_markup_percent??nd.materials_markup),[F,I]=ee.useState(a?.equipment_markup_percent??nd.equipment_markup),[z,ne]=ee.useState(a?.subcontractors_markup_percent??nd.subcontractors_markup),[se,je]=ee.useState(a?.liability_insurance_percent??nd.liability_insurance),[Ne,ge]=ee.useState(a?.bond_percent??nd.bond),[Ie,le]=ee.useState(a?.license_fee_percent??nd.license_fee);ee.useEffect(()=>{Ge(),a||ue()},[]);const Ge=async()=>{try{const _e=await nt.getLaborRates?.(e?.id,t?.work_type,t?.job_type);x(_e||[])}catch(_e){console.error("Error loading labor rates:",_e)}},rt=_e=>{const Ue=_e?.toLowerCase()||"";return v.find(Fe=>Fe.role?.toLowerCase()===Ue)||null},ue=async()=>{try{const _e=await nt.getNextCORNumber?.(t.id);W(_e||`COR-${Date.now()}`)}catch(_e){console.error("Error generating COR number:",_e),W(`COR-${Date.now()}`)}},ot=ee.useMemo(()=>({title:_,scope_of_work:E,area_id:A||null,cor_number:G,period_start:B,period_end:L,change_order_labor:D,change_order_materials:M,change_order_equipment:ie,change_order_subcontractors:J,labor_markup_percent:te,materials_markup_percent:U,equipment_markup_percent:F,subcontractors_markup_percent:z,liability_insurance_percent:se,bond_percent:Ne,license_fee_percent:Ie}),[_,E,A,G,B,L,D,M,ie,J,te,U,F,z,se,Ne,Ie]),xe=ee.useMemo(()=>R1(ot),[ot]),ve=_e=>{switch(_e){case 1:return _.trim()?E.trim()?!0:(l?.("Scope of work is required","error"),!1):(l?.("Title is required","error"),!1);case 2:return B?L?new Date(L)<new Date(B)?(l?.("End date must be after start date","error"),!1):!0:(l?.("End date is required","error"),!1):(l?.("Start date is required","error"),!1);default:return!0}},Be=()=>{ve(c)&&d(Math.min(c+1,Fp.length))},jt=()=>{d(Math.max(c-1,1))},Je=_e=>{if(_e<c)d(_e);else if(_e>c){for(let Ue=c;Ue<_e;Ue++)if(!ve(Ue))return;d(_e)}},ct=()=>{const _e=YS[0],Ue=rt(_e);T([...D,{id:`temp-${Date.now()}`,labor_class:_e,wage_type:"standard",regular_hours:0,overtime_hours:0,regular_rate:Ue?Math.round((parseFloat(Ue.regular_rate)||0)*100):0,overtime_rate:Ue?Math.round((parseFloat(Ue.overtime_rate)||0)*100):0,total:0}])},St=(_e,Ue,Fe)=>{const gt=[...D];if(gt[_e]={...gt[_e],[Ue]:Fe},Ue==="labor_class"){const Vt=rt(Fe);Vt&&(gt[_e].regular_rate=Math.round((parseFloat(Vt.regular_rate)||0)*100),gt[_e].overtime_rate=Math.round((parseFloat(Vt.overtime_rate)||0)*100))}const{total:Ht}=ZH(gt[_e].regular_hours,gt[_e].overtime_hours,gt[_e].regular_rate,gt[_e].overtime_rate);gt[_e].total=Ht,T(gt)},Ft=_e=>{T(D.filter((Ue,Fe)=>Fe!==_e))},Xt=()=>{V([...M,{id:`temp-${Date.now()}`,description:"",source_type:"backup_sheet",source_reference:"",quantity:1,unit:"each",unit_cost:0,total:0}])},Ut=(_e,Ue,Fe)=>{const gt=[...M];gt[_e]={...gt[_e],[Ue]:Fe},gt[_e].total=GS(gt[_e].quantity,gt[_e].unit_cost),V(gt)},Wt=_e=>{V(M.filter((Ue,Fe)=>Fe!==_e))},$t=()=>{X([...ie,{id:`temp-${Date.now()}`,description:"",source_type:"backup_sheet",source_reference:"",quantity:1,unit:"day",unit_cost:0,total:0}])},wt=(_e,Ue,Fe)=>{const gt=[...ie];gt[_e]={...gt[_e],[Ue]:Fe},gt[_e].total=GS(gt[_e].quantity,gt[_e].unit_cost),X(gt)},Ce=_e=>{X(ie.filter((Ue,Fe)=>Fe!==_e))},st=()=>{K([...J,{id:`temp-${Date.now()}`,company_name:"",description:"",source_type:"invoice",source_reference:"",amount:0,total:0}])},Dt=(_e,Ue,Fe)=>{const gt=[...J];gt[_e]={...gt[_e],[Ue]:Fe},Ue==="amount"&&(gt[_e].total=parseInt(Fe)||0),K(gt)},At=_e=>{K(J.filter((Ue,Fe)=>Fe!==_e))},Ct=_e=>{_e.laborItems?.length>0&&T([...D,..._e.laborItems]),_e.materialsItems?.length>0&&V([...M,..._e.materialsItems]),_e.equipmentItems?.length>0&&X([...ie,..._e.equipmentItems]),l?.(`Imported data from ${_e.ticketIds.length} ticket(s)`,"success")},Te=async()=>{m(!0);try{const _e={company_id:e.id,project_id:t.id,...ot,...xe,status:"draft"};let Ue;a?.id?Ue=await nt.updateCOR(a.id,_e):Ue=await nt.createCOR(_e),Ue?.id&&await nt.saveCORLineItems(Ue.id,{laborItems:D,materialItems:M,equipmentItems:ie,subcontractorItems:J}),l?.("COR saved as draft","success"),s?.(Ue),n?.()}catch(_e){console.error("Error saving COR:",_e),l?.("Error saving COR","error")}finally{m(!1)}},Ve=async()=>{const _e=Jv(ot);if(!_e.valid){l?.(_e.errors[0],"error");return}m(!0);try{const Ue={company_id:e.id,project_id:t.id,...ot,...xe,status:"pending_approval"};let Fe;a?.id?(Fe=await nt.updateCOR(a.id,{...Ue,status:"draft"}),await nt.saveCORLineItems(a.id,{laborItems:D,materialItems:M,equipmentItems:ie,subcontractorItems:J}),await nt.submitCORForApproval(a.id)):(Fe=await nt.createCOR({...Ue,status:"draft"}),Fe?.id&&(await nt.saveCORLineItems(Fe.id,{laborItems:D,materialItems:M,equipmentItems:ie,subcontractorItems:J}),await nt.submitCORForApproval(Fe.id))),l?.("COR submitted for approval","success"),s?.(Fe),n?.()}catch(Ue){console.error("Error submitting COR:",Ue),l?.("Error submitting COR","error")}finally{m(!1)}};return i.jsxs("div",{className:"modal-overlay",onClick:n,children:[i.jsxs("div",{className:"modal-content cor-form-modal",onClick:_e=>_e.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{children:a?"Edit Change Order Request":"New Change Order Request"}),i.jsx("button",{className:"close-btn",onClick:n,children:i.jsx(Rd,{size:20})})]}),i.jsx("div",{className:"cor-progress-steps",children:Fp.map(_e=>i.jsxs("div",{className:`cor-step ${c>=_e.id?"active":""} ${c===_e.id?"current":""}`,onClick:()=>Je(_e.id),children:[i.jsx("span",{className:"cor-step-number",children:_e.id}),i.jsx("span",{className:"cor-step-label",children:_e.shortLabel})]},_e.id))}),i.jsxs("div",{className:"modal-body cor-form-body",children:[c===1&&i.jsxs("div",{className:"cor-form-step",children:[i.jsx("h3",{children:"Basic Information"}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"COR Number"}),i.jsx("input",{type:"text",value:G,onChange:_e=>W(_e.target.value),placeholder:"Auto-generated",className:"input-readonly",readOnly:!0})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Title *"}),i.jsx("input",{type:"text",value:_,onChange:_e=>w(_e.target.value),placeholder:"e.g., Additional Demolition Work - Building A"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Scope of Work *"}),i.jsx("textarea",{value:E,onChange:_e=>C(_e.target.value),rows:4,placeholder:"Describe the scope of work covered by this change order..."})]}),r&&r.length>0&&i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Work Area (Optional)"}),i.jsxs("select",{value:A,onChange:_e=>O(_e.target.value),children:[i.jsx("option",{value:"",children:"No specific area"}),r.map(_e=>i.jsx("option",{value:_e.id,children:_e.name},_e.id))]})]})]}),c===2&&i.jsxs("div",{className:"cor-form-step",children:[i.jsx("h3",{children:"Work Period"}),i.jsx("p",{className:"step-description",children:"Specify the date range for this change order work."}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Start Date *"}),i.jsx("input",{type:"date",value:B,onChange:_e=>q(_e.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"End Date *"}),i.jsx("input",{type:"date",value:L,onChange:_e=>Z(_e.target.value),min:B})]})]})]}),c===3&&i.jsxs("div",{className:"cor-form-step",children:[i.jsxs("div",{className:"step-header",children:[i.jsxs("div",{children:[i.jsx("h3",{children:"Labor"}),i.jsx("p",{className:"step-description",children:"Add labor costs for this change order."})]}),i.jsxs("div",{className:"step-header-actions",children:[i.jsxs("button",{className:"btn btn-ghost",onClick:()=>b(!0),children:[i.jsx(ho,{size:16})," Import from Tickets"]}),i.jsxs("button",{className:"btn btn-secondary",onClick:ct,children:[i.jsx(Go,{size:16})," Add Labor"]})]})]}),D.length===0?i.jsxs("div",{className:"empty-items",children:[i.jsx("p",{children:"No labor items added yet."}),i.jsxs("button",{className:"btn btn-primary",onClick:ct,children:[i.jsx(Go,{size:16})," Add First Labor Item"]})]}):i.jsx("div",{className:"line-items-list",children:D.map((_e,Ue)=>i.jsxs("div",{className:"line-item labor-item",children:[i.jsxs("div",{className:"line-item-header",children:[i.jsxs("span",{className:"line-item-number",children:["#",Ue+1]}),i.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>Ft(Ue),children:i.jsx(uc,{size:14})})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Labor Class"}),i.jsx("select",{value:_e.labor_class,onChange:Fe=>St(Ue,"labor_class",Fe.target.value),children:YS.map(Fe=>i.jsx("option",{value:Fe,children:Fe},Fe))})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Wage Type"}),i.jsx("select",{value:_e.wage_type,onChange:Fe=>St(Ue,"wage_type",Fe.target.value),children:QH.map(Fe=>i.jsx("option",{value:Fe.value,children:Fe.label},Fe.value))})]})]}),i.jsxs("div",{className:"form-row four-col",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Reg Hours"}),i.jsx("input",{type:"number",step:"0.5",min:"0",value:_e.regular_hours,onChange:Fe=>St(Ue,"regular_hours",Fe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Reg Rate ($/hr)"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:Bi(_e.regular_rate),onChange:Fe=>St(Ue,"regular_rate",cc(Fe.target.value))})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"OT Hours"}),i.jsx("input",{type:"number",step:"0.5",min:"0",value:_e.overtime_hours,onChange:Fe=>St(Ue,"overtime_hours",Fe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"OT Rate ($/hr)"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:Bi(_e.overtime_rate),onChange:Fe=>St(Ue,"overtime_rate",cc(Fe.target.value))})]})]}),i.jsxs("div",{className:"line-item-total",children:["Total: ",i.jsx("strong",{children:Kt(_e.total)})]})]},_e.id||Ue))}),i.jsxs("div",{className:"section-subtotal",children:["Labor Subtotal: ",i.jsx("strong",{children:Kt(xe.labor_subtotal)})]})]}),c===4&&i.jsxs("div",{className:"cor-form-step",children:[i.jsxs("div",{className:"step-header",children:[i.jsxs("div",{children:[i.jsx("h3",{children:"Materials"}),i.jsx("p",{className:"step-description",children:"Add material costs for this change order."})]}),i.jsxs("button",{className:"btn btn-secondary",onClick:Xt,children:[i.jsx(Go,{size:16})," Add Material"]})]}),M.length===0?i.jsxs("div",{className:"empty-items",children:[i.jsx("p",{children:"No materials added yet."}),i.jsxs("button",{className:"btn btn-primary",onClick:Xt,children:[i.jsx(Go,{size:16})," Add First Material"]})]}):i.jsx("div",{className:"line-items-list",children:M.map((_e,Ue)=>i.jsxs("div",{className:"line-item",children:[i.jsxs("div",{className:"line-item-header",children:[i.jsxs("span",{className:"line-item-number",children:["#",Ue+1]}),i.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>Wt(Ue),children:i.jsx(uc,{size:14})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Description"}),i.jsx("input",{type:"text",value:_e.description,onChange:Fe=>Ut(Ue,"description",Fe.target.value),placeholder:"Material description"})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Source"}),i.jsx("select",{value:_e.source_type,onChange:Fe=>Ut(Ue,"source_type",Fe.target.value),children:Zv.materials.map(Fe=>i.jsx("option",{value:Fe.value,children:Fe.label},Fe.value))})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Reference"}),i.jsx("input",{type:"text",value:_e.source_reference,onChange:Fe=>Ut(Ue,"source_reference",Fe.target.value),placeholder:"Ticket #, Invoice #"})]})]}),i.jsxs("div",{className:"form-row three-col",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Quantity"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:_e.quantity,onChange:Fe=>Ut(Ue,"quantity",Fe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Unit"}),i.jsx("select",{value:_e.unit,onChange:Fe=>Ut(Ue,"unit",Fe.target.value),children:XS.map(Fe=>i.jsx("option",{value:Fe,children:Fe},Fe))})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Unit Cost ($)"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:Bi(_e.unit_cost),onChange:Fe=>Ut(Ue,"unit_cost",cc(Fe.target.value))})]})]}),i.jsxs("div",{className:"line-item-total",children:["Total: ",i.jsx("strong",{children:Kt(_e.total)})]})]},_e.id||Ue))}),i.jsxs("div",{className:"section-subtotal",children:["Materials Subtotal: ",i.jsx("strong",{children:Kt(xe.materials_subtotal)})]})]}),c===5&&i.jsxs("div",{className:"cor-form-step",children:[i.jsxs("div",{className:"step-header",children:[i.jsxs("div",{children:[i.jsx("h3",{children:"Equipment"}),i.jsx("p",{className:"step-description",children:"Add equipment rental costs for this change order."})]}),i.jsxs("button",{className:"btn btn-secondary",onClick:$t,children:[i.jsx(Go,{size:16})," Add Equipment"]})]}),ie.length===0?i.jsxs("div",{className:"empty-items",children:[i.jsx("p",{children:"No equipment added yet."}),i.jsxs("button",{className:"btn btn-primary",onClick:$t,children:[i.jsx(Go,{size:16})," Add First Equipment"]})]}):i.jsx("div",{className:"line-items-list",children:ie.map((_e,Ue)=>i.jsxs("div",{className:"line-item",children:[i.jsxs("div",{className:"line-item-header",children:[i.jsxs("span",{className:"line-item-number",children:["#",Ue+1]}),i.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>Ce(Ue),children:i.jsx(uc,{size:14})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Description"}),i.jsx("input",{type:"text",value:_e.description,onChange:Fe=>wt(Ue,"description",Fe.target.value),placeholder:"Equipment description"})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Source"}),i.jsx("select",{value:_e.source_type,onChange:Fe=>wt(Ue,"source_type",Fe.target.value),children:Zv.equipment.map(Fe=>i.jsx("option",{value:Fe.value,children:Fe.label},Fe.value))})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Reference"}),i.jsx("input",{type:"text",value:_e.source_reference,onChange:Fe=>wt(Ue,"source_reference",Fe.target.value),placeholder:"Ticket #, Invoice #"})]})]}),i.jsxs("div",{className:"form-row three-col",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Quantity"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:_e.quantity,onChange:Fe=>wt(Ue,"quantity",Fe.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Unit"}),i.jsx("select",{value:_e.unit,onChange:Fe=>wt(Ue,"unit",Fe.target.value),children:XS.map(Fe=>i.jsx("option",{value:Fe,children:Fe},Fe))})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Unit Cost ($)"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:Bi(_e.unit_cost),onChange:Fe=>wt(Ue,"unit_cost",cc(Fe.target.value))})]})]}),i.jsxs("div",{className:"line-item-total",children:["Total: ",i.jsx("strong",{children:Kt(_e.total)})]})]},_e.id||Ue))}),i.jsxs("div",{className:"section-subtotal",children:["Equipment Subtotal: ",i.jsx("strong",{children:Kt(xe.equipment_subtotal)})]})]}),c===6&&i.jsxs("div",{className:"cor-form-step",children:[i.jsxs("div",{className:"step-header",children:[i.jsxs("div",{children:[i.jsx("h3",{children:"Subcontractors"}),i.jsx("p",{className:"step-description",children:"Add subcontractor costs for this change order."})]}),i.jsxs("button",{className:"btn btn-secondary",onClick:st,children:[i.jsx(Go,{size:16})," Add Subcontractor"]})]}),J.length===0?i.jsxs("div",{className:"empty-items",children:[i.jsx("p",{children:"No subcontractors added yet."}),i.jsxs("button",{className:"btn btn-primary",onClick:st,children:[i.jsx(Go,{size:16})," Add First Subcontractor"]})]}):i.jsx("div",{className:"line-items-list",children:J.map((_e,Ue)=>i.jsxs("div",{className:"line-item",children:[i.jsxs("div",{className:"line-item-header",children:[i.jsxs("span",{className:"line-item-number",children:["#",Ue+1]}),i.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>At(Ue),children:i.jsx(uc,{size:14})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Company Name"}),i.jsx("input",{type:"text",value:_e.company_name,onChange:Fe=>Dt(Ue,"company_name",Fe.target.value),placeholder:"Subcontractor company name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Description of Work"}),i.jsx("input",{type:"text",value:_e.description,onChange:Fe=>Dt(Ue,"description",Fe.target.value),placeholder:"Work performed"})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Source"}),i.jsx("select",{value:_e.source_type,onChange:Fe=>Dt(Ue,"source_type",Fe.target.value),children:Zv.subcontractors.map(Fe=>i.jsx("option",{value:Fe.value,children:Fe.label},Fe.value))})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Reference"}),i.jsx("input",{type:"text",value:_e.source_reference,onChange:Fe=>Dt(Ue,"source_reference",Fe.target.value),placeholder:"Invoice #, Quote #"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Amount ($)"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:Bi(_e.amount),onChange:Fe=>Dt(Ue,"amount",cc(Fe.target.value))})]})]}),i.jsxs("div",{className:"line-item-total",children:["Total: ",i.jsx("strong",{children:Kt(_e.total)})]})]},_e.id||Ue))}),i.jsxs("div",{className:"section-subtotal",children:["Subcontractors Subtotal: ",i.jsx("strong",{children:Kt(xe.subcontractors_subtotal)})]})]}),c===7&&i.jsxs("div",{className:"cor-form-step",children:[i.jsx("h3",{children:"Markups & Fees"}),i.jsx("p",{className:"step-description",children:"Configure markup percentages and additional fees."}),i.jsxs("div",{className:"markups-section",children:[i.jsx("h4",{children:"Markups"}),i.jsxs("div",{className:"markups-grid",children:[i.jsxs("div",{className:"markup-item",children:[i.jsx("label",{children:"Labor Markup"}),i.jsxs("div",{className:"markup-input",children:[i.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:du(te),onChange:_e=>fe(ad(_e.target.value))}),i.jsx("span",{children:"%"})]}),i.jsxs("span",{className:"markup-amount",children:["+",Kt(xe.labor_markup_amount)]})]}),i.jsxs("div",{className:"markup-item",children:[i.jsx("label",{children:"Materials Markup"}),i.jsxs("div",{className:"markup-input",children:[i.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:du(U),onChange:_e=>j(ad(_e.target.value))}),i.jsx("span",{children:"%"})]}),i.jsxs("span",{className:"markup-amount",children:["+",Kt(xe.materials_markup_amount)]})]}),i.jsxs("div",{className:"markup-item",children:[i.jsx("label",{children:"Equipment Markup"}),i.jsxs("div",{className:"markup-input",children:[i.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:du(F),onChange:_e=>I(ad(_e.target.value))}),i.jsx("span",{children:"%"})]}),i.jsxs("span",{className:"markup-amount",children:["+",Kt(xe.equipment_markup_amount)]})]}),i.jsxs("div",{className:"markup-item",children:[i.jsx("label",{children:"Subcontractors Markup"}),i.jsxs("div",{className:"markup-input",children:[i.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:du(z),onChange:_e=>ne(ad(_e.target.value))}),i.jsx("span",{children:"%"})]}),i.jsxs("span",{className:"markup-amount",children:["+",Kt(xe.subcontractors_markup_amount)]})]})]})]}),i.jsxs("div",{className:"fees-section",children:[i.jsx("h4",{children:"Additional Fees"}),i.jsxs("div",{className:"fees-grid",children:[i.jsxs("div",{className:"fee-item",children:[i.jsx("label",{children:"Liability Insurance"}),i.jsxs("div",{className:"fee-input",children:[i.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:du(se),onChange:_e=>je(ad(_e.target.value))}),i.jsx("span",{children:"%"})]}),i.jsxs("span",{className:"fee-amount",children:["+",Kt(xe.liability_insurance_amount)]})]}),i.jsxs("div",{className:"fee-item",children:[i.jsx("label",{children:"Bond"}),i.jsxs("div",{className:"fee-input",children:[i.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:du(Ne),onChange:_e=>ge(ad(_e.target.value))}),i.jsx("span",{children:"%"})]}),i.jsxs("span",{className:"fee-amount",children:["+",Kt(xe.bond_amount)]})]}),i.jsxs("div",{className:"fee-item",children:[i.jsx("label",{children:"City License Fee"}),i.jsxs("div",{className:"fee-input",children:[i.jsx("input",{type:"number",step:"0.001",min:"0",max:"100",value:du(Ie),onChange:_e=>le(ad(_e.target.value))}),i.jsx("span",{children:"%"})]}),i.jsxs("span",{className:"fee-amount",children:["+",Kt(xe.license_fee_amount)]})]})]})]})]}),c===8&&i.jsxs("div",{className:"cor-form-step",children:[i.jsx("h3",{children:"Summary"}),i.jsxs("div",{className:"cor-summary",children:[i.jsxs("div",{className:"summary-header",children:[i.jsx("div",{className:"summary-title",children:_||"Untitled COR"}),i.jsx("div",{className:"summary-number",children:G})]}),i.jsxs("div",{className:"summary-section",children:[i.jsx("h4",{children:"Costs Breakdown"}),i.jsxs("div",{className:"summary-line",children:[i.jsxs("span",{children:["Labor (",D.length," items)"]}),i.jsx("span",{children:Kt(xe.labor_subtotal)})]}),i.jsxs("div",{className:"summary-line indent",children:[i.jsxs("span",{children:["+ Markup (",jn(te),")"]}),i.jsx("span",{children:Kt(xe.labor_markup_amount)})]}),i.jsxs("div",{className:"summary-line",children:[i.jsxs("span",{children:["Materials (",M.length," items)"]}),i.jsx("span",{children:Kt(xe.materials_subtotal)})]}),i.jsxs("div",{className:"summary-line indent",children:[i.jsxs("span",{children:["+ Markup (",jn(U),")"]}),i.jsx("span",{children:Kt(xe.materials_markup_amount)})]}),i.jsxs("div",{className:"summary-line",children:[i.jsxs("span",{children:["Equipment (",ie.length," items)"]}),i.jsx("span",{children:Kt(xe.equipment_subtotal)})]}),i.jsxs("div",{className:"summary-line indent",children:[i.jsxs("span",{children:["+ Markup (",jn(F),")"]}),i.jsx("span",{children:Kt(xe.equipment_markup_amount)})]}),i.jsxs("div",{className:"summary-line",children:[i.jsxs("span",{children:["Subcontractors (",J.length," items)"]}),i.jsx("span",{children:Kt(xe.subcontractors_subtotal)})]}),i.jsxs("div",{className:"summary-line indent",children:[i.jsxs("span",{children:["+ Markup (",jn(z),")"]}),i.jsx("span",{children:Kt(xe.subcontractors_markup_amount)})]})]}),i.jsxs("div",{className:"summary-subtotal",children:[i.jsx("span",{children:"COR Subtotal"}),i.jsx("span",{children:Kt(xe.cor_subtotal)})]}),i.jsxs("div",{className:"summary-section",children:[i.jsx("h4",{children:"Additional Fees"}),i.jsxs("div",{className:"summary-line",children:[i.jsxs("span",{children:["Liability Insurance (",jn(se),")"]}),i.jsx("span",{children:Kt(xe.liability_insurance_amount)})]}),i.jsxs("div",{className:"summary-line",children:[i.jsxs("span",{children:["Bond (",jn(Ne),")"]}),i.jsx("span",{children:Kt(xe.bond_amount)})]}),i.jsxs("div",{className:"summary-line",children:[i.jsxs("span",{children:["City License Fee (",jn(Ie),")"]}),i.jsx("span",{children:Kt(xe.license_fee_amount)})]})]}),i.jsxs("div",{className:"summary-total",children:[i.jsx("span",{children:"COR Total"}),i.jsx("span",{children:Kt(xe.cor_total)})]})]})]}),c===9&&i.jsxs("div",{className:"cor-form-step",children:[i.jsx("h3",{children:"Submit Change Order Request"}),i.jsxs("div",{className:"submit-preview",children:[i.jsxs("div",{className:"preview-card",children:[i.jsxs("div",{className:"preview-header",children:[i.jsx("span",{className:"preview-number",children:G}),i.jsx("span",{className:"preview-total",children:Kt(xe.cor_total)})]}),i.jsx("div",{className:"preview-title",children:_}),i.jsx("div",{className:"preview-scope",children:E})]}),(()=>{const _e=Jv(ot);return _e.valid?i.jsx("div",{className:"validation-success",children:"Ready to submit for approval!"}):i.jsxs("div",{className:"validation-errors",children:[i.jsx(gh,{size:20}),i.jsxs("div",{children:[i.jsx("strong",{children:"Please fix the following issues:"}),i.jsx("ul",{children:_e.errors.map((Ue,Fe)=>i.jsx("li",{children:Ue},Fe))})]})]})})(),i.jsxs("div",{className:"submit-actions",children:[i.jsxs("button",{className:"btn btn-secondary",onClick:Te,disabled:f,children:[i.jsx(cw,{size:16})," Save as Draft"]}),i.jsxs("button",{className:"btn btn-primary",onClick:Ve,disabled:f||!Jv(ot).valid,children:[i.jsx(nN,{size:16})," Submit for Approval"]})]})]})]})]}),i.jsxs("div",{className:"modal-footer cor-form-footer",children:[i.jsx("div",{className:"footer-left",children:c>1&&i.jsxs("button",{className:"btn btn-secondary",onClick:jt,disabled:f,children:[i.jsx(YC,{size:16})," Back"]})}),i.jsx("div",{className:"footer-center",children:i.jsxs("span",{className:"step-indicator",children:["Step ",c," of ",Fp.length]})}),i.jsxs("div",{className:"footer-right",children:[c<Fp.length&&i.jsxs("button",{className:"btn btn-primary",onClick:Be,disabled:f,children:["Next ",i.jsx(Od,{size:16})]}),c>1&&c<9&&i.jsxs("button",{className:"btn btn-ghost",onClick:Te,disabled:f,children:[i.jsx(cw,{size:14})," Save Draft"]})]})]})]}),g&&i.jsx(t$,{projectId:t.id,corId:a?.id,onImport:Ct,onClose:()=>b(!1),onShowToast:l})]})}const a$=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[30,41,59]},n$=t=>new Promise(e=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const a=document.createElement("canvas");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0),e(a.toDataURL("image/png"))},r.onerror=()=>e(null),r.src=t});async function s$(t,e,r,a={}){const n=new ur,s=n.internal.pageSize.getWidth(),l=n.internal.pageSize.getHeight(),c=20;let d=c;const f=R1(t),m=a.primaryColor?a$(a.primaryColor):[30,58,138],v=[241,245,249];let x=null;if(a.logoUrl)try{x=await n$(a.logoUrl)}catch(W){console.error("Error loading logo:",W)}if(x)try{n.addImage(x,"PNG",c,d,40,15),d+=20}catch{n.setFontSize(16),n.setFont("helvetica","bold"),n.setTextColor(...m),n.text(r?.name||"Company Name",c,d+10),d+=20}else n.setFontSize(16),n.setFont("helvetica","bold"),n.setTextColor(...m),n.text(r?.name||"Company Name",c,d+10),d+=20;n.setFontSize(20),n.setFont("helvetica","bold"),n.setTextColor(0,0,0),n.text("CHANGE ORDER REQUEST",c,d),d+=10,n.setFontSize(12),n.setFont("helvetica","normal"),n.setTextColor(100,100,100),n.text(t.cor_number||"COR-XXXX",c,d);const g=t.status?.replace("_"," ").toUpperCase()||"DRAFT";n.setTextColor(...m),n.text(g,s-c-n.getTextWidth(g),d),d+=12,n.setDrawColor(...m),n.setLineWidth(.5),n.line(c,d,s-c,d),d+=10,n.setFontSize(10),n.setTextColor(0,0,0);const b=c,_=s/2;n.setFont("helvetica","bold"),n.text("Project:",b,d),n.setFont("helvetica","normal"),n.text(e?.name||"Project Name",b+25,d),n.setFont("helvetica","bold"),n.text("Job #:",_,d),n.setFont("helvetica","normal"),n.text(e?.job_number||"N/A",_+25,d),d+=6,n.setFont("helvetica","bold"),n.text("Period:",b,d),n.setFont("helvetica","normal"),n.text(ey(t.period_start,t.period_end),b+25,d),n.setFont("helvetica","bold"),n.text("Date:",_,d),n.setFont("helvetica","normal"),n.text(hc(t.created_at),_+25,d),d+=10,n.setFont("helvetica","bold"),n.setFontSize(12),n.text(t.title||"Untitled Change Order",c,d),d+=8,n.setFont("helvetica","normal"),n.setFontSize(10),n.setTextColor(80,80,80);const w=n.splitTextToSize(t.scope_of_work||"No scope of work provided.",s-c*2);n.text(w,c,d),d+=w.length*5+10,t.change_order_labor?.length>0&&(n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("LABOR",c,d),d+=6,Jf(n,{startY:d,head:[["Class","Type","Reg Hrs","Reg Rate","OT Hrs","OT Rate","Total"]],body:t.change_order_labor.map(W=>[W.labor_class,W.wage_type,W.regular_hours.toString(),`$${Bi(W.regular_rate)}/hr`,W.overtime_hours?.toString()||"-",W.overtime_hours?`$${Bi(W.overtime_rate)}/hr`:"-",Kt(W.total)]),foot:[[{content:`Subtotal: ${Kt(f.labor_subtotal)}`,colSpan:5,styles:{halign:"right",fontStyle:"bold"}},{content:`+${jn(t.labor_markup_percent||1500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Kt(f.labor_subtotal+f.labor_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:c,right:c},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),d=n.lastAutoTable.finalY+10),t.change_order_materials?.length>0&&(d>l-80&&(n.addPage(),d=c),n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("MATERIALS",c,d),d+=6,Jf(n,{startY:d,head:[["Description","Source","Qty","Unit","Unit Cost","Total"]],body:t.change_order_materials.map(W=>[W.description,W.source_reference||W.source_type,W.quantity.toString(),W.unit,`$${Bi(W.unit_cost)}`,Kt(W.total)]),foot:[[{content:`Subtotal: ${Kt(f.materials_subtotal)}`,colSpan:4,styles:{halign:"right",fontStyle:"bold"}},{content:`+${jn(t.materials_markup_percent||1500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Kt(f.materials_subtotal+f.materials_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:c,right:c},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),d=n.lastAutoTable.finalY+10),t.change_order_equipment?.length>0&&(d>l-80&&(n.addPage(),d=c),n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("EQUIPMENT",c,d),d+=6,Jf(n,{startY:d,head:[["Description","Source","Qty","Unit","Unit Cost","Total"]],body:t.change_order_equipment.map(W=>[W.description,W.source_reference||W.source_type,W.quantity.toString(),W.unit,`$${Bi(W.unit_cost)}`,Kt(W.total)]),foot:[[{content:`Subtotal: ${Kt(f.equipment_subtotal)}`,colSpan:4,styles:{halign:"right",fontStyle:"bold"}},{content:`+${jn(t.equipment_markup_percent||1500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Kt(f.equipment_subtotal+f.equipment_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:c,right:c},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),d=n.lastAutoTable.finalY+10),t.change_order_subcontractors?.length>0&&(d>l-80&&(n.addPage(),d=c),n.setFont("helvetica","bold"),n.setFontSize(11),n.setTextColor(0,0,0),n.text("SUBCONTRACTORS",c,d),d+=6,Jf(n,{startY:d,head:[["Company","Description","Source","Amount"]],body:t.change_order_subcontractors.map(W=>[W.company_name,W.description,W.source_reference||W.source_type,Kt(W.total)]),foot:[[{content:`Subtotal: ${Kt(f.subcontractors_subtotal)}`,colSpan:2,styles:{halign:"right",fontStyle:"bold"}},{content:`+${jn(t.subcontractors_markup_percent||500)} Markup`,colSpan:1,styles:{halign:"right"}},{content:Kt(f.subcontractors_subtotal+f.subcontractors_markup_amount),styles:{fontStyle:"bold"}}]],margin:{left:c,right:c},headStyles:{fillColor:m,textColor:[255,255,255],fontStyle:"bold",fontSize:8},bodyStyles:{fontSize:8},footStyles:{fillColor:v,textColor:[0,0,0],fontSize:8},theme:"striped"}),d=n.lastAutoTable.finalY+10),d>l-100&&(n.addPage(),d=c),n.setFillColor(...v),n.roundedRect(c,d,s-c*2,70,3,3,"F"),d+=10,n.setFontSize(10),n.setFont("helvetica","normal"),n.setTextColor(0,0,0);const E=c+10,C=s-c-60;n.text("COR Subtotal:",E,d),n.setFont("helvetica","bold"),n.text(Kt(f.cor_subtotal),C,d,{align:"right"}),d+=8,n.setFont("helvetica","normal"),n.setFontSize(9),n.text(`Liability Insurance (${jn(t.liability_insurance_percent||144)}):`,E,d),n.text(Kt(f.liability_insurance_amount),C,d,{align:"right"}),d+=6,n.text(`Bond (${jn(t.bond_percent||100)}):`,E,d),n.text(Kt(f.bond_amount),C,d,{align:"right"}),d+=6,n.text(`City License Fee (${jn(t.license_fee_percent||10)}):`,E,d),n.text(Kt(f.license_fee_amount),C,d,{align:"right"}),d+=10,n.setFillColor(...m),n.roundedRect(E-5,d-3,s-c*2-10,16,2,2,"F"),n.setTextColor(255,255,255),n.setFontSize(12),n.setFont("helvetica","bold"),n.text("COR TOTAL:",E,d+8),n.text(Kt(f.cor_total),C,d+8,{align:"right"}),d+=25,d>l-120&&(n.addPage(),d=c),d+=10,n.setTextColor(0,0,0),n.setFontSize(10),n.setFont("helvetica","bold"),n.text("AUTHORIZATION",c,d),d+=15,n.setFont("helvetica","normal"),n.setFontSize(9),n.setDrawColor(0,0,0);const A=(W,B,q,L,Z,D,T)=>{n.setFont("helvetica","bold"),n.setFontSize(8),n.text(B,c,W),n.setFont("helvetica","normal"),n.setFontSize(9);const M=W+20;if(n.line(c,M,c+70,M),n.text("Signature",c,M+8),n.line(c+85,M,c+145,M),n.text("Title / Company",c+85,M+8),n.line(s-c-40,M,s-c,M),n.text("Date",s-c-40,M+8),q)try{if(n.addImage(q,"PNG",c,M-18,60,18),L&&(n.setFontSize(8),n.text(L,c,M+15)),Z||D){const V=[Z,D].filter(Boolean).join(" - ");n.text(V,c+85,M-5)}T&&n.text(hc(T),s-c-40,M-5)}catch(V){console.error("Error adding signature:",V)}return M+25};d=A(d,"GC AUTHORIZATION",t.gc_signature_data||t.gc_signature,t.gc_signature_name||t.gc_signer_name,t.gc_signature_title,t.gc_signature_company,t.gc_signature_date||t.signed_at),d+=10,d=A(d,"CLIENT AUTHORIZATION",t.client_signature_data,t.client_signature_name,t.client_signature_title,t.client_signature_company,t.client_signature_date);const O=l-10;n.setFontSize(8),n.setTextColor(150,150,150),n.text(`Generated on ${new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`,c,O),n.text("Page 1",s-c,O,{align:"right"});const G=`${t.cor_number||"COR"}_${e?.job_number||"export"}.pdf`;n.save(G)}function i$({onSave:t,onClose:e,signerName:r=""}){const a=ee.useRef(null),[n,s]=ee.useState(r),[l,c]=ee.useState(!1),[d,f]=ee.useState(!1),m=()=>{const C=a.current;return C?C.getContext("2d"):null},v=C=>{const A=a.current;if(!A)return{x:0,y:0};const O=A.getBoundingClientRect(),G=A.width/O.width,W=A.height/O.height,B=C.touches?C.touches[0].clientX:C.clientX,q=C.touches?C.touches[0].clientY:C.clientY;return{x:(B-O.left)*G,y:(q-O.top)*W}},x=C=>{C.preventDefault();const A=m();if(!A)return;const{x:O,y:G}=v(C);A.beginPath(),A.moveTo(O,G),f(!0),c(!0)},g=C=>{if(!d)return;C.preventDefault();const A=m();if(!A)return;const{x:O,y:G}=v(C);A.lineTo(O,G),A.stroke()},b=()=>{f(!1)},_=()=>{const C=a.current,A=m();!C||!A||(A.clearRect(0,0,C.width,C.height),c(!1))},w=C=>{if(!C)return;a.current=C;const A=C.getContext("2d");A.strokeStyle="#1e293b",A.lineWidth=2,A.lineCap="round",A.lineJoin="round"},E=()=>{if(!l||!n.trim())return;const C=a.current;if(!C)return;const A=C.toDataURL("image/png");t({signature:A,signerName:n.trim(),signedAt:new Date().toISOString()})};return i.jsx("div",{className:"modal-overlay",onClick:e,role:"dialog","aria-modal":"true","aria-labelledby":"signature-title",children:i.jsxs("div",{className:"modal-content signature-modal",onClick:C=>C.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h2",{id:"signature-title",children:"GC Signature"}),i.jsx("button",{className:"close-btn",onClick:e,"aria-label":"Close signature modal",children:i.jsx(Rd,{size:20,"aria-hidden":"true"})})]}),i.jsxs("div",{className:"modal-body signature-body",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"signer-name",children:"Signer Name *"}),i.jsx("input",{id:"signer-name",type:"text",value:n,onChange:C=>s(C.target.value),placeholder:"Enter full name","aria-required":"true"})]}),i.jsxs("div",{className:"signature-area",children:[i.jsxs("div",{className:"signature-label",id:"signature-instructions",children:[i.jsx(tN,{size:16,"aria-hidden":"true"}),i.jsx("span",{children:"Sign below"})]}),i.jsxs("div",{className:"signature-canvas-container",children:[i.jsx("canvas",{ref:w,width:500,height:200,className:"signature-canvas",onMouseDown:x,onMouseMove:g,onMouseUp:b,onMouseLeave:b,onTouchStart:x,onTouchMove:g,onTouchEnd:b,role:"img","aria-label":"Signature drawing area. Use mouse or touch to draw your signature.","aria-describedby":"signature-instructions",tabIndex:0}),!l&&i.jsx("div",{className:"signature-placeholder",children:"Sign here"})]}),i.jsxs("button",{className:"btn btn-ghost btn-small",onClick:_,disabled:!l,"aria-label":"Clear signature",children:[i.jsx(aN,{size:14,"aria-hidden":"true"})," Clear"]})]}),i.jsx("p",{className:"signature-legal",role:"note",children:"By signing above, I acknowledge that I have reviewed and approve this Change Order Request."})]}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{className:"btn btn-secondary",onClick:e,"aria-label":"Cancel and close",children:"Cancel"}),i.jsxs("button",{className:"btn btn-primary",onClick:E,disabled:!l||!n.trim(),"aria-label":"Save signature",children:[i.jsx(F0,{size:16,"aria-hidden":"true"})," Save Signature"]})]})]})})}function o$({cor:t,project:e,company:r,areas:a,onClose:n,onEdit:s,onShowToast:l,onStatusChange:c}){const[d,f]=ee.useState(!0),[m,v]=ee.useState(t),[x,g]=ee.useState(!1),[b,_]=ee.useState(!1);ee.useEffect(()=>{(async()=>{try{const T=await nt.getCORById(t.id);T&&v(T)}catch(T){console.error("Error fetching COR details:",T),l?.("Error loading COR details","error")}finally{f(!1)}})()},[t.id]);const w=ee.useMemo(()=>R1(m),[m]),E=kk(m.status),C=m.status==="pending_approval",A=m.status==="draft",O=D=>a?.find(M=>M.id===D)?.name||null,G=async()=>{if(confirm("Approve this change order request?")){f(!0);try{await nt.approveCOR(m.id),v({...m,status:"approved",approved_at:new Date().toISOString()}),l?.("COR approved","success"),c?.()}catch(D){console.error("Error approving COR:",D),l?.("Error approving COR","error")}finally{f(!1)}}},W=async()=>{const D=prompt("Enter rejection reason (optional):");if(D!==null){f(!0);try{await nt.rejectCOR(m.id,D),v({...m,status:"rejected",rejection_reason:D}),l?.("COR rejected","success"),c?.()}catch(T){console.error("Error rejecting COR:",T),l?.("Error rejecting COR","error")}finally{f(!1)}}},B=async()=>{if(confirm("Mark this COR as billed?")){f(!0);try{await nt.markCORAsBilled(m.id),v({...m,status:"billed"}),l?.("COR marked as billed","success"),c?.()}catch(D){console.error("Error marking COR as billed:",D),l?.("Error updating status","error")}finally{f(!1)}}},q=async D=>{f(!0);try{await nt.saveCORSignature?.(m.id,{gc_signature:D.signature,gc_signer_name:D.signerName,signed_at:D.signedAt}),v({...m,gc_signature:D.signature,gc_signer_name:D.signerName,signed_at:D.signedAt}),g(!1),l?.("Signature saved","success"),c?.()}catch(T){console.error("Error saving signature:",T),l?.("Error saving signature","error")}finally{f(!1)}},L=m.status==="approved"&&!m.gc_signature,Z=async()=>{try{l?.("Generating PDF...","info"),await s$(m,e,r),l?.("PDF downloaded","success")}catch(D){console.error("Error exporting PDF:",D),l?.("Error generating PDF","error")}};return d?i.jsx("div",{className:"modal-overlay",onClick:n,children:i.jsx("div",{className:"modal-content cor-detail-modal",onClick:D=>D.stopPropagation(),children:i.jsx("div",{className:"cor-detail-loading",children:"Loading COR details..."})})}):i.jsxs("div",{className:"modal-overlay",onClick:n,role:"dialog","aria-modal":"true","aria-labelledby":"cor-detail-title",children:[i.jsxs("div",{className:"modal-content cor-detail-modal",onClick:D=>D.stopPropagation(),children:[i.jsxs("div",{className:"modal-header cor-detail-header",children:[i.jsxs("div",{className:"cor-detail-title-row",children:[i.jsxs("div",{children:[i.jsx("div",{className:"cor-detail-number",children:m.cor_number}),i.jsx("h2",{id:"cor-detail-title",children:m.title||"Untitled COR"})]}),i.jsx("button",{className:"close-btn",onClick:n,"aria-label":"Close COR details",children:i.jsx(Rd,{size:20,"aria-hidden":"true"})})]}),i.jsxs("div",{className:"cor-detail-meta",children:[i.jsx("span",{className:"cor-detail-status",style:{backgroundColor:E.bgColor,color:E.color},children:E.label}),O(m.area_id)&&i.jsx("span",{className:"cor-detail-area",children:O(m.area_id)}),i.jsxs("span",{className:"cor-detail-period",children:[i.jsx(Xp,{size:14})," ",ey(m.period_start,m.period_end)]})]})]}),i.jsxs("div",{className:"modal-body cor-detail-body",children:[i.jsxs("div",{className:"cor-detail-section",children:[i.jsxs("h3",{children:[i.jsx(ho,{size:18})," Scope of Work"]}),i.jsx("p",{className:"cor-scope-text",children:m.scope_of_work||"No scope of work provided."})]}),i.jsxs("div",{className:"cor-detail-section pricing-breakdown",children:[i.jsxs("h3",{children:[i.jsx(Qf,{size:18})," Pricing Breakdown"]}),i.jsxs("div",{className:"pricing-category",children:[i.jsxs("div",{className:"category-header",children:[i.jsxs("div",{className:"category-title",children:[i.jsx(y1,{size:16}),i.jsx("span",{children:"Labor"})]}),i.jsx("span",{className:"category-subtotal",children:Kt(w.labor_subtotal)})]}),m.change_order_labor?.length>0?i.jsx("div",{className:"category-items",children:i.jsxs("table",{className:"pricing-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Class"}),i.jsx("th",{children:"Type"}),i.jsx("th",{children:"Reg Hrs"}),i.jsx("th",{children:"Reg Rate"}),i.jsx("th",{children:"OT Hrs"}),i.jsx("th",{children:"OT Rate"}),i.jsx("th",{className:"text-right",children:"Total"})]})}),i.jsx("tbody",{children:m.change_order_labor.map((D,T)=>i.jsxs("tr",{children:[i.jsx("td",{children:D.labor_class}),i.jsx("td",{children:D.wage_type}),i.jsx("td",{children:D.regular_hours}),i.jsxs("td",{children:["$",Bi(D.regular_rate),"/hr"]}),i.jsx("td",{children:D.overtime_hours||"-"}),i.jsx("td",{children:D.overtime_hours?`$${Bi(D.overtime_rate)}/hr`:"-"}),i.jsx("td",{className:"text-right",children:Kt(D.total)})]},T))})]})}):i.jsx("div",{className:"category-empty",children:"No labor items"}),i.jsxs("div",{className:"category-markup",children:[i.jsxs("span",{children:["Markup (",jn(m.labor_markup_percent||1500),")"]}),i.jsxs("span",{children:["+",Kt(w.labor_markup_amount)]})]})]}),i.jsxs("div",{className:"pricing-category",children:[i.jsxs("div",{className:"category-header",children:[i.jsxs("div",{className:"category-title",children:[i.jsx(bc,{size:16}),i.jsx("span",{children:"Materials"})]}),i.jsx("span",{className:"category-subtotal",children:Kt(w.materials_subtotal)})]}),m.change_order_materials?.length>0?i.jsx("div",{className:"category-items",children:i.jsxs("table",{className:"pricing-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Description"}),i.jsx("th",{children:"Source"}),i.jsx("th",{children:"Qty"}),i.jsx("th",{children:"Unit"}),i.jsx("th",{children:"Unit Cost"}),i.jsx("th",{className:"text-right",children:"Total"})]})}),i.jsx("tbody",{children:m.change_order_materials.map((D,T)=>i.jsxs("tr",{children:[i.jsx("td",{children:D.description}),i.jsx("td",{children:D.source_reference||D.source_type}),i.jsx("td",{children:D.quantity}),i.jsx("td",{children:D.unit}),i.jsxs("td",{children:["$",Bi(D.unit_cost)]}),i.jsx("td",{className:"text-right",children:Kt(D.total)})]},T))})]})}):i.jsx("div",{className:"category-empty",children:"No material items"}),i.jsxs("div",{className:"category-markup",children:[i.jsxs("span",{children:["Markup (",jn(m.materials_markup_percent||1500),")"]}),i.jsxs("span",{children:["+",Kt(w.materials_markup_amount)]})]})]}),i.jsxs("div",{className:"pricing-category",children:[i.jsxs("div",{className:"category-header",children:[i.jsxs("div",{className:"category-title",children:[i.jsx(vh,{size:16}),i.jsx("span",{children:"Equipment"})]}),i.jsx("span",{className:"category-subtotal",children:Kt(w.equipment_subtotal)})]}),m.change_order_equipment?.length>0?i.jsx("div",{className:"category-items",children:i.jsxs("table",{className:"pricing-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Description"}),i.jsx("th",{children:"Source"}),i.jsx("th",{children:"Qty"}),i.jsx("th",{children:"Unit"}),i.jsx("th",{children:"Unit Cost"}),i.jsx("th",{className:"text-right",children:"Total"})]})}),i.jsx("tbody",{children:m.change_order_equipment.map((D,T)=>i.jsxs("tr",{children:[i.jsx("td",{children:D.description}),i.jsx("td",{children:D.source_reference||D.source_type}),i.jsx("td",{children:D.quantity}),i.jsx("td",{children:D.unit}),i.jsxs("td",{children:["$",Bi(D.unit_cost)]}),i.jsx("td",{className:"text-right",children:Kt(D.total)})]},T))})]})}):i.jsx("div",{className:"category-empty",children:"No equipment items"}),i.jsxs("div",{className:"category-markup",children:[i.jsxs("span",{children:["Markup (",jn(m.equipment_markup_percent||1500),")"]}),i.jsxs("span",{children:["+",Kt(w.equipment_markup_amount)]})]})]}),i.jsxs("div",{className:"pricing-category",children:[i.jsxs("div",{className:"category-header",children:[i.jsxs("div",{className:"category-title",children:[i.jsx(D0,{size:16}),i.jsx("span",{children:"Subcontractors"})]}),i.jsx("span",{className:"category-subtotal",children:Kt(w.subcontractors_subtotal)})]}),m.change_order_subcontractors?.length>0?i.jsx("div",{className:"category-items",children:i.jsxs("table",{className:"pricing-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Company"}),i.jsx("th",{children:"Description"}),i.jsx("th",{children:"Source"}),i.jsx("th",{className:"text-right",children:"Amount"})]})}),i.jsx("tbody",{children:m.change_order_subcontractors.map((D,T)=>i.jsxs("tr",{children:[i.jsx("td",{children:D.company_name}),i.jsx("td",{children:D.description}),i.jsx("td",{children:D.source_reference||D.source_type}),i.jsx("td",{className:"text-right",children:Kt(D.total)})]},T))})]})}):i.jsx("div",{className:"category-empty",children:"No subcontractor items"}),i.jsxs("div",{className:"category-markup",children:[i.jsxs("span",{children:["Markup (",jn(m.subcontractors_markup_percent||500),")"]}),i.jsxs("span",{children:["+",Kt(w.subcontractors_markup_amount)]})]})]}),i.jsxs("div",{className:"cor-subtotal-row",children:[i.jsx("span",{children:"COR Subtotal"}),i.jsx("span",{children:Kt(w.cor_subtotal)})]}),i.jsxs("div",{className:"pricing-category fees-category",children:[i.jsxs("div",{className:"category-header",children:[i.jsxs("div",{className:"category-title",children:[i.jsx(CT,{size:16}),i.jsx("span",{children:"Additional Fees"})]}),i.jsx("span",{className:"category-subtotal",children:Kt(w.additional_fees_total)})]}),i.jsxs("div",{className:"fees-list",children:[i.jsxs("div",{className:"fee-row",children:[i.jsxs("div",{className:"fee-label",children:[i.jsx(sN,{size:14}),i.jsxs("span",{children:["Liability Insurance (",jn(m.liability_insurance_percent||144),")"]})]}),i.jsx("span",{className:"fee-amount",children:Kt(w.liability_insurance_amount)})]}),i.jsxs("div",{className:"fee-row",children:[i.jsxs("div",{className:"fee-label",children:[i.jsx(ho,{size:14}),i.jsxs("span",{children:["Bond (",jn(m.bond_percent||100),")"]})]}),i.jsx("span",{className:"fee-amount",children:Kt(w.bond_amount)})]}),i.jsxs("div",{className:"fee-row",children:[i.jsxs("div",{className:"fee-label",children:[i.jsx(n2,{size:14}),i.jsxs("span",{children:["City License Fee (",jn(m.license_fee_percent||10),")"]})]}),i.jsx("span",{className:"fee-amount",children:Kt(w.license_fee_amount)})]})]})]}),i.jsxs("div",{className:"cor-total-row",children:[i.jsx("span",{children:"COR TOTAL"}),i.jsx("span",{children:Kt(w.cor_total)})]})]}),(m.gc_signature_data||m.gc_signature||m.client_signature_data)&&i.jsxs("div",{className:"cor-detail-section signature-section",children:[i.jsxs("h3",{children:[i.jsx(UT,{size:18})," Signatures"]}),i.jsxs("div",{className:"dual-signatures",children:[(m.gc_signature_data||m.gc_signature)&&i.jsxs("div",{className:"signature-block",children:[i.jsx("span",{className:"signature-label",children:"GC Authorization"}),i.jsxs("div",{className:"signature-display",children:[i.jsx("img",{src:m.gc_signature_data||m.gc_signature,alt:"GC Signature",className:"signature-image"}),i.jsxs("div",{className:"signature-info",children:[i.jsx("span",{className:"signer-name",children:m.gc_signature_name||m.gc_signer_name}),(m.gc_signature_title||m.gc_signature_company)&&i.jsxs("span",{className:"signer-org",children:[m.gc_signature_title,m.gc_signature_title&&m.gc_signature_company&&" - ",m.gc_signature_company]}),i.jsxs("span",{className:"signed-date",children:["Signed: ",hc(m.gc_signature_date||m.signed_at)]})]})]})]}),m.client_signature_data&&i.jsxs("div",{className:"signature-block",children:[i.jsx("span",{className:"signature-label",children:"Client Authorization"}),i.jsxs("div",{className:"signature-display",children:[i.jsx("img",{src:m.client_signature_data,alt:"Client Signature",className:"signature-image"}),i.jsxs("div",{className:"signature-info",children:[i.jsx("span",{className:"signer-name",children:m.client_signature_name}),(m.client_signature_title||m.client_signature_company)&&i.jsxs("span",{className:"signer-org",children:[m.client_signature_title,m.client_signature_title&&m.client_signature_company&&" - ",m.client_signature_company]}),i.jsxs("span",{className:"signed-date",children:["Signed: ",hc(m.client_signature_date)]})]})]})]})]})]}),m.status==="rejected"&&m.rejection_reason&&i.jsxs("div",{className:"cor-detail-section rejection-section",children:[i.jsxs("h3",{children:[i.jsx(sw,{size:18})," Rejection Reason"]}),i.jsx("p",{className:"rejection-text",children:m.rejection_reason})]})]}),i.jsxs("div",{className:"modal-footer cor-detail-footer",children:[i.jsxs("div",{className:"footer-info",children:[i.jsxs("span",{children:["Created: ",hc(m.created_at)]}),m.approved_at&&i.jsxs("span",{children:["Approved: ",hc(m.approved_at)]})]}),i.jsxs("div",{className:"footer-actions",role:"group","aria-label":"COR actions",children:[A&&i.jsxs("button",{className:"btn btn-secondary",onClick:()=>s?.(m),disabled:d,"aria-label":"Edit this COR",children:[i.jsx(o2,{size:16,"aria-hidden":"true"})," Edit"]}),C&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{className:"btn btn-danger",onClick:W,disabled:d,"aria-label":"Reject this COR",children:[i.jsx(sw,{size:16,"aria-hidden":"true"})," Reject"]}),i.jsxs("button",{className:"btn btn-success",onClick:G,disabled:d,"aria-label":"Approve this COR",children:[i.jsx(pd,{size:16,"aria-hidden":"true"})," Approve"]})]}),L&&i.jsxs("button",{className:"btn btn-success",onClick:()=>g(!0),disabled:d,"aria-label":"Get GC signature for this COR",children:[i.jsx(jT,{size:16,"aria-hidden":"true"})," Get GC Signature"]}),(m.status==="approved"||m.status==="pending_approval")&&i.jsxs("button",{className:"btn btn-secondary",onClick:()=>_(!0),disabled:d,"aria-label":"Get shareable signature link",children:[i.jsx(i2,{size:16,"aria-hidden":"true"})," Get Signature Link"]}),m.status==="approved"&&i.jsxs("button",{className:"btn btn-primary",onClick:B,disabled:d,"aria-label":"Mark this COR as billed",children:[i.jsx(Qf,{size:16,"aria-hidden":"true"})," Mark Billed"]}),i.jsxs("button",{className:"btn btn-secondary",onClick:Z,"aria-label":"Export COR to PDF",children:[i.jsx(sT,{size:16,"aria-hidden":"true"})," Export PDF"]})]})]})]}),x&&i.jsx(i$,{onSave:q,onClose:()=>g(!1),signerName:""}),b&&i.jsx(uN,{documentType:"cor",documentId:m.id,companyId:r?.id,projectId:e?.id,documentTitle:`COR ${m.cor_number}: ${m.title||"Untitled"}`,onClose:()=>_(!1),onShowToast:l})]})}const cu=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t||0),l$=t=>new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"});function c$({dailyBurn:t,totalBurn:e,daysWorked:r,laborCost:a,haulOffCost:n,progress:s,contractValue:l,laborByDate:c=[],haulOffByDate:d=[]}){const[f,m]=ee.useState(!1),v=l*(s/100)*.6,x=e<=v?"on-budget":e<=v*1.2?"warning":"over-budget",g={"on-budget":"On Budget",warning:"Watch Closely","over-budget":"Over Budget"}[x],b=x==="on-budget"?iN:x==="warning"?bT:$T,w=s>0?e/(s/100):0,E=[],C={};c.forEach(O=>{C[O.date]||(C[O.date]={date:O.date,labor:0,haulOff:0,total:0}),C[O.date].labor=O.cost||0,C[O.date].total+=O.cost||0}),d.forEach(O=>{C[O.date]||(C[O.date]={date:O.date,labor:0,haulOff:0,total:0}),C[O.date].haulOff=O.cost||0,C[O.date].total+=O.cost||0}),Object.values(C).sort((O,G)=>new Date(G.date)-new Date(O.date)).slice(0,10).forEach(O=>E.push(O));const A=Math.max(...E.map(O=>O.total),1);return i.jsxs("div",{className:"burn-rate-card",children:[i.jsxs("div",{className:"burn-rate-header",children:[i.jsxs("div",{className:"burn-rate-title",children:[i.jsx(fT,{size:18,className:"burn-icon"}),i.jsx("h3",{children:"Burn Rate"})]}),i.jsxs("div",{className:`burn-status ${x}`,children:[i.jsx(b,{size:14}),i.jsx("span",{children:g})]})]}),i.jsxs("div",{className:"burn-rate-hero",children:[i.jsxs("div",{className:"burn-rate-main",children:[i.jsx("span",{className:"burn-rate-value",children:cu(t)}),i.jsx("span",{className:"burn-rate-unit",children:"/day"})]}),r>0&&i.jsxs("div",{className:"burn-rate-context",children:["Based on ",r," work day",r!==1?"s":""]})]}),i.jsxs("div",{className:"burn-rate-summary",children:[i.jsxs("div",{className:"burn-summary-item",children:[i.jsx("span",{className:"burn-summary-label",children:"Total Spent"}),i.jsx("span",{className:"burn-summary-value",children:cu(e)})]}),i.jsx("div",{className:"burn-summary-divider"}),i.jsxs("div",{className:"burn-summary-item",children:[i.jsx("span",{className:"burn-summary-label",children:"Labor"}),i.jsx("span",{className:"burn-summary-value",children:cu(a)})]}),i.jsx("div",{className:"burn-summary-divider"}),i.jsxs("div",{className:"burn-summary-item",children:[i.jsx("span",{className:"burn-summary-label",children:"Disposal"}),i.jsx("span",{className:"burn-summary-value",children:cu(n)})]})]}),s>0&&i.jsxs("div",{className:"burn-projection",children:[i.jsx("span",{className:"projection-label",children:"Projected at completion:"}),i.jsx("span",{className:`projection-value ${w>l*.7?"warning":""}`,children:cu(w)})]}),E.length>0&&i.jsxs("button",{className:"burn-rate-expand",onClick:()=>m(!f),children:[f?i.jsx(s2,{size:16}):i.jsx(_c,{size:16}),i.jsxs("span",{children:[f?"Hide":"View"," Daily Breakdown"]})]}),f&&E.length>0&&i.jsxs("div",{className:"burn-rate-details",children:[i.jsxs("div",{className:"burn-details-header",children:[i.jsx("span",{children:"Date"}),i.jsx("span",{children:"Labor"}),i.jsx("span",{children:"Disposal"}),i.jsx("span",{children:"Total"})]}),E.map(O=>i.jsxs("div",{className:"burn-details-row",children:[i.jsx("span",{className:"burn-date",children:l$(O.date)}),i.jsx("span",{className:"burn-labor",children:O.labor>0?cu(O.labor):"-"}),i.jsx("span",{className:"burn-hauloff",children:O.haulOff>0?cu(O.haulOff):"-"}),i.jsxs("span",{className:"burn-total",children:[i.jsx("span",{className:"burn-bar",style:{width:`${O.total/A*100}%`}}),i.jsx("span",{className:"burn-amount",children:cu(O.total)})]})]},O.date))]})]})}const Qv=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t||0),Lp={labor:{label:"Labor",Icon:bs,color:"#3b82f6"},disposal:{label:"Disposal",Icon:vh,color:"#10b981"},equipment:{label:"Equipment",Icon:Q0,color:"#f59e0b"},materials:{label:"Materials",Icon:bc,color:"#8b5cf6"},subcontractor:{label:"Subcontractor",Icon:y1,color:"#ec4899"},other:{label:"Other",Icon:eN,color:"#6b7280"}};function u$({laborCost:t=0,haulOffCost:e=0,customCosts:r=[],onAddCost:a,onDeleteCost:n}){const[s,l]=ee.useState(!1),[c,d]=ee.useState(null),f=[];t>0&&f.push({category:"labor",label:"Labor",amount:t,source:"auto",description:"From crew check-ins"}),e>0&&f.push({category:"disposal",label:"Disposal",amount:e,source:"auto",description:"From haul-off logs"});const m={};r.forEach(g=>{m[g.category]||(m[g.category]={category:g.category,items:[],total:0}),m[g.category].items.push(g),m[g.category].total+=parseFloat(g.amount)||0}),Object.values(m).forEach(g=>{const b=Lp[g.category]||Lp.other;f.push({category:g.category,label:b.label,amount:g.total,source:"manual",items:g.items})});const v=f.reduce((g,b)=>g+b.amount,0);f.forEach(g=>{g.percentage=v>0?g.amount/v*100:0}),f.sort((g,b)=>b.amount-g.amount);const x=g=>{d(c===g?null:g)};return i.jsxs("div",{className:"cost-contributors-card",children:[i.jsxs("div",{className:"cost-contributors-header",children:[i.jsx("h3",{children:"Cost Contributors"}),i.jsx("span",{className:"cost-total",children:Qv(v)})]}),f.length===0?i.jsxs("div",{className:"cost-empty",children:[i.jsx("p",{children:"No costs recorded yet"}),i.jsx("small",{children:"Costs will appear as crew checks in and haul-offs are logged"})]}):i.jsx("div",{className:"cost-breakdown",children:f.map(g=>{const b=Lp[g.category]||Lp.other,_=b.Icon,w=g.items&&g.items.length>0,E=c===g.category;return i.jsxs("div",{className:"cost-category",children:[i.jsxs("div",{className:`cost-category-row ${w?"expandable":""}`,onClick:()=>w&&x(g.category),children:[i.jsx("div",{className:"cost-category-bar-container",children:i.jsx("div",{className:"cost-category-bar",style:{width:`${Math.max(g.percentage,2)}%`,backgroundColor:b.color}})}),i.jsxs("div",{className:"cost-category-info",children:[i.jsxs("div",{className:"cost-category-label",children:[i.jsx(_,{size:14,style:{color:b.color}}),i.jsx("span",{children:g.label}),g.source==="auto"&&i.jsx("span",{className:"cost-auto-badge",children:"Auto"}),w&&(E?i.jsx(s2,{size:14}):i.jsx(_c,{size:14}))]}),i.jsxs("div",{className:"cost-category-values",children:[i.jsx("span",{className:"cost-amount",children:Qv(g.amount)}),i.jsxs("span",{className:"cost-percent",children:[Math.round(g.percentage),"%"]})]})]})]}),E&&w&&i.jsx("div",{className:"cost-category-items",children:g.items.map(C=>i.jsxs("div",{className:"cost-item",children:[i.jsxs("div",{className:"cost-item-info",children:[i.jsx("span",{className:"cost-item-desc",children:C.description}),i.jsx("span",{className:"cost-item-date",children:new Date(C.cost_date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),i.jsxs("div",{className:"cost-item-actions",children:[i.jsx("span",{className:"cost-item-amount",children:Qv(C.amount)}),n&&i.jsx("button",{className:"cost-item-delete",onClick:A=>{A.stopPropagation(),confirm("Delete this cost entry?")&&n(C.id)},children:i.jsx(uc,{size:14})})]})]},C.id))})]},g.category)})}),a&&i.jsxs("button",{className:"cost-add-btn",onClick:a,children:[i.jsx(Go,{size:16}),i.jsx("span",{children:"Add Cost"})]})]})}const sd=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t||0);function d$({revenue:t,totalCosts:e,contractValue:r,progress:a}){const n=t-e,s=t>0?n/t*100:0,l=r,c=a>0?e/(a/100):e,d=l-c,f=l>0?d/l*100:0,m=s>=20,v=s>=0&&s<20,x=s<0,g=m?"healthy":v?"warning":"loss",b=m?"On Track":v?"Watch Margin":"Over Cost",_=m?pd:v?gh:iN;return i.jsxs("div",{className:`profitability-card ${g}`,children:[i.jsxs("div",{className:"profitability-header",children:[i.jsx("h3",{children:"Profitability"}),i.jsxs("div",{className:`profitability-status ${g}`,children:[i.jsx(_,{size:14}),i.jsx("span",{children:b})]})]}),i.jsxs("div",{className:"profitability-metrics",children:[i.jsxs("div",{className:"profit-metric",children:[i.jsxs("div",{className:"profit-metric-header",children:[i.jsx("span",{className:"profit-metric-label",children:"Current Margin"}),i.jsxs("span",{className:`profit-metric-value ${s<0?"negative":""}`,children:[Math.round(s),"%"]})]}),i.jsx("div",{className:"profit-bar-container",children:i.jsx("div",{className:`profit-bar ${s<0?"negative":s<20?"warning":"healthy"}`,style:{width:`${Math.min(Math.abs(s),100)}%`}})})]}),a>10&&i.jsxs("div",{className:"profit-metric",children:[i.jsxs("div",{className:"profit-metric-header",children:[i.jsx("span",{className:"profit-metric-label",children:"Projected Final"}),i.jsxs("span",{className:`profit-metric-value ${f<0?"negative":""}`,children:[Math.round(f),"%"]})]}),i.jsx("div",{className:"profit-bar-container",children:i.jsx("div",{className:`profit-bar ${f<0?"negative":f<20?"warning":"healthy"}`,style:{width:`${Math.min(Math.abs(f),100)}%`}})})]})]}),i.jsxs("div",{className:"profitability-summary",children:[i.jsxs("div",{className:"profit-row",children:[i.jsx("span",{className:"profit-label",children:"Revenue Earned"}),i.jsx("span",{className:"profit-value",children:sd(t)})]}),i.jsxs("div",{className:"profit-row",children:[i.jsx("span",{className:"profit-label",children:"Total Costs"}),i.jsxs("span",{className:"profit-value negative",children:["- ",sd(e)]})]}),i.jsxs("div",{className:"profit-row profit-total",children:[i.jsx("span",{className:"profit-label",children:"Current Profit"}),i.jsxs("span",{className:`profit-value ${n<0?"negative":"positive"}`,children:[n>=0?"":"-",sd(Math.abs(n))]})]})]}),a>10&&i.jsxs("div",{className:"profitability-insight",children:[m&&i.jsxs("p",{children:["At ",Math.round(a),"% complete, you're at ",sd(n)," profit.",d>0&&` Projected final profit: ${sd(d)}`]}),v&&i.jsxs("p",{children:["Margins are thin. Consider reviewing costs or scope.",d<0&&` Trending toward ${sd(d)} loss.`]}),x&&i.jsxs("p",{children:["Currently over cost by ",sd(Math.abs(n)),". Immediate review recommended."]})]})]})}const f$=[{value:"labor",label:"Labor",Icon:bs,description:"Additional labor costs"},{value:"materials",label:"Materials",Icon:bc,description:"Materials and supplies"},{value:"equipment",label:"Equipment",Icon:Q0,description:"Equipment rental or purchase"},{value:"subcontractor",label:"Subcontractor",Icon:y1,description:"Subcontractor work"},{value:"disposal",label:"Disposal",Icon:vh,description:"Additional disposal costs"},{value:"other",label:"Other",Icon:eN,description:"Miscellaneous costs"}];function h$({onClose:t,onSave:e,saving:r=!1}){const[a,n]=ee.useState({category:"materials",description:"",amount:"",cost_date:new Date().toISOString().split("T")[0],notes:""}),[s,l]=ee.useState({}),c=(m,v)=>{n(x=>({...x,[m]:v})),s[m]&&l(x=>({...x,[m]:null}))},d=()=>{const m={};a.description.trim()||(m.description="Description is required");const v=parseFloat(a.amount);return(isNaN(v)||v<=0)&&(m.amount="Enter a valid amount"),a.cost_date||(m.cost_date="Date is required"),l(m),Object.keys(m).length===0},f=m=>{m.preventDefault(),d()&&e(a)};return i.jsx("div",{className:"modal-overlay",onClick:t,role:"dialog","aria-modal":"true",children:i.jsxs("div",{className:"modal-content add-cost-modal",onClick:m=>m.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsxs("h2",{children:[i.jsx(Qf,{size:20}),"Add Cost"]}),i.jsx("button",{className:"close-btn",onClick:t,"aria-label":"Close",children:i.jsx(Rd,{size:20})})]}),i.jsxs("form",{onSubmit:f,children:[i.jsxs("div",{className:"modal-body",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Category *"}),i.jsx("div",{className:"category-grid",children:f$.map(m=>{const v=m.Icon,x=a.category===m.value;return i.jsxs("button",{type:"button",className:`category-option ${x?"selected":""}`,onClick:()=>c("category",m.value),children:[i.jsx(v,{size:18}),i.jsx("span",{className:"category-label",children:m.label})]},m.value)})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"cost-description",children:"Description *"}),i.jsx("input",{id:"cost-description",type:"text",value:a.description,onChange:m=>c("description",m.target.value),placeholder:"e.g., Excavator rental - Week 1",className:s.description?"error":""}),s.description&&i.jsx("span",{className:"form-error",children:s.description})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"cost-amount",children:"Amount *"}),i.jsxs("div",{className:"input-with-prefix",children:[i.jsx("span",{className:"input-prefix",children:"$"}),i.jsx("input",{id:"cost-amount",type:"number",step:"0.01",min:"0",value:a.amount,onChange:m=>c("amount",m.target.value),placeholder:"0.00",className:s.amount?"error":""})]}),s.amount&&i.jsx("span",{className:"form-error",children:s.amount})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"cost-date",children:"Date *"}),i.jsx("input",{id:"cost-date",type:"date",value:a.cost_date,onChange:m=>c("cost_date",m.target.value),className:s.cost_date?"error":""}),s.cost_date&&i.jsx("span",{className:"form-error",children:s.cost_date})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"cost-notes",children:"Notes (optional)"}),i.jsx("textarea",{id:"cost-notes",value:a.notes,onChange:m=>c("notes",m.target.value),placeholder:"Additional details...",rows:2})]})]}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{type:"button",className:"btn btn-secondary",onClick:t,disabled:r,children:"Cancel"}),i.jsx("button",{type:"submit",className:"btn btn-primary",disabled:r,children:r?"Saving...":"Add Cost"})]})]})]})})}function m$({company:t,onShowToast:e,navigateToProjectId:r,onProjectNavigated:a}){const[n,s]=ee.useState([]),[l,c]=ee.useState([]),[d,f]=ee.useState(null),[m,v]=ee.useState([]),[x,g]=ee.useState(!0),[b,_]=ee.useState(!1),[w,E]=ee.useState(null),[C,A]=ee.useState(!1),[O,G]=ee.useState(!1),[W,B]=ee.useState(!1),[q,L]=ee.useState("overview"),[Z,D]=ee.useState([]),[T,M]=ee.useState(!1),[V,ie]=ee.useState(null),[X,J]=ee.useState(!1),[K,te]=ee.useState(null),[fe,U]=ee.useState(0),[j,F]=ee.useState(!1),[I,z]=ee.useState(!1);ee.useEffect(()=>{if(t?.id){se(),ne();const Ce=n.map(Dt=>Dt.id),st=Ce.length>0?nt.subscribeToCompanyActivity?.(t.id,Ce,{onMessage:()=>se(),onMaterialRequest:()=>se(),onTMTicket:()=>se(),onInjuryReport:()=>se()}):null;return()=>{st&&nt.unsubscribe?.(st)}}},[t?.id,n.length]);const ne=async()=>{try{const Ce=await nt.getDumpSites(t.id);D(Ce||[])}catch(Ce){console.error("Error loading dump sites:",Ce)}};ee.useEffect(()=>{if(r&&n.length>0){const Ce=n.find(st=>st.id===r);Ce&&(f(Ce),a?.())}},[r,n]),ee.useEffect(()=>{if(d){je(d.id);const Ce=[],st=nt.subscribeToAreas?.(d.id,()=>{je(d.id),se()});st&&Ce.push(st);const Dt=nt.subscribeToDailyReports?.(d.id,()=>{se()});Dt&&Ce.push(Dt);const At=nt.subscribeToCrewCheckins?.(d.id,()=>{se()});At&&Ce.push(At);const Ct=nt.subscribeToHaulOffs?.(d.id,()=>{se()});Ct&&Ce.push(Ct);const Te=nt.subscribeToCORs?.(d.id,()=>{se(),U(Ve=>Ve+1)});return Te&&Ce.push(Te),()=>{Ce.forEach(Ve=>nt.unsubscribe?.(Ve))}}},[d]);const se=async()=>{try{const Ce=await nt.getProjects(t?.id);s(Ce);const st=await Promise.all(Ce.map(async Dt=>{const At=await nt.getAreas(Dt.id),Ct=await nt.getTMTickets(Dt.id),Te=await nt.getChangeOrderTotals(Dt.id),Ve=await nt.getDailyReports(Dt.id,100),_e=await nt.getInjuryReports(Dt.id),Ue=await nt.getMaterialRequests(Dt.id),Fe=await nt.calculateManDayCosts(Dt.id,t?.id,Dt.work_type||"demolition",Dt.job_type||"standard"),gt=await nt.calculateHaulOffCosts(Dt.id),Ht=await nt.getProjectCosts(Dt.id),Vt=uw(At),zt=Vt.progress,kt=Te?.totalApprovedValue||0,sr=Dt.contract_value+kt,Pr=Vt.isValueBased?Vt.earnedValue:zt/100*sr,Nt=Ct.filter(we=>we.status==="pending").length,fa=new Date;fa.setDate(fa.getDate()-7);const ir=Ve.filter(we=>new Date(we.report_date)>=fa).length,Ea=Ht.reduce((we,$e)=>we+(parseFloat($e.amount)||0),0),xn=Fe?.totalCost||0,Ra=gt?.totalCost||0,nn=xn+Ra+Ea,Pt=Pr-nn,Zt=Pr>0?Pt/Pr*100:0,ae=Fe?.byDate?.length||0,be=gt?.daysWithHaulOff||0,me=Math.max(ae,be),pe=xn+Ra,Se=me>0?pe/me:0;return{...Dt,areas:At,progress:zt,billable:Pr,changeOrderValue:kt,revisedContractValue:sr,changeOrderPending:Te?.pendingCount||0,totalTickets:Ct.length,pendingTickets:Nt,approvedTickets:Ct.filter(we=>we.status==="approved").length,dailyReportsCount:Ve.length,recentDailyReports:ir,injuryReportsCount:_e.length,lastDailyReport:Ve[0]?.report_date||null,pendingMaterialRequests:Ue.filter(we=>we.status==="pending").length,totalMaterialRequests:Ue.length,isValueBased:Vt.isValueBased,earnedValue:Vt.earnedValue,totalSOVValue:Vt.totalValue,laborCost:xn,laborDaysWorked:ae,laborManDays:Fe?.totalManDays||0,laborByDate:Fe?.byDate||[],dailyBurn:Se,haulOffCost:Ra,haulOffLoads:gt?.totalLoads||0,haulOffDays:be,haulOffByType:gt?.byWasteType||{},haulOffByDate:gt?.byDate||[],customCosts:Ht,customCostTotal:Ea,totalBurn:pe,totalBurnDays:me,allCostsTotal:nn,currentProfit:Pt,profitMargin:Zt}}));c(st)}catch(Ce){console.error("Error loading projects:",Ce),e("Error loading projects","error")}finally{g(!1)}},je=async Ce=>{try{const st=await nt.getAreas(Ce);v(st)}catch(st){console.error("Error loading areas:",st)}},Ne=Ce=>{f(Ce)},ge=()=>{f(null),v([]),_(!1),E(null),L("overview"),se()},Ie=()=>{E({name:d.name,job_number:d.job_number||"",address:d.address||"",general_contractor:d.general_contractor||"",client_contact:d.client_contact||"",client_phone:d.client_phone||"",contract_value:d.contract_value,work_type:d.work_type||"demolition",job_type:d.job_type||"standard",pin:d.pin||"",default_dump_site_id:d.default_dump_site_id||"",areas:m.map(Ce=>({id:Ce.id,name:Ce.name,weight:Ce.weight,isNew:!1}))}),_(!0)},le=()=>{_(!1),E(null)},Ge=(Ce,st)=>{E(Dt=>({...Dt,[Ce]:st}))},rt=(Ce,st,Dt)=>{E(At=>({...At,areas:At.areas.map((Ct,Te)=>Te===Ce?{...Ct,[st]:Dt}:Ct)}))},ue=()=>{E(Ce=>({...Ce,areas:[...Ce.areas,{id:null,name:"",weight:"",isNew:!0}]}))},ot=Ce=>{w.areas.length>1&&E(st=>({...st,areas:st.areas.filter((Dt,At)=>At!==Ce)}))},xe=async()=>{if(!w.name.trim()){e("Please enter a project name","error");return}const Ce=parseFloat(w.contract_value);if(!Ce||Ce<=0){e("Please enter a valid contract value","error");return}if(w.pin&&w.pin.length!==4){e("PIN must be 4 digits","error");return}if(w.pin&&w.pin!==d.pin&&!await nt.isPinAvailable(w.pin,d.id)){e("This PIN is already in use","error");return}const st=w.areas.filter(At=>At.name.trim()&&parseFloat(At.weight)>0);if(st.length===0){e("Please add at least one area","error");return}if(st.reduce((At,Ct)=>At+parseFloat(Ct.weight),0)!==100){e("Area weights must total 100%","error");return}A(!0);try{await nt.updateProject(d.id,{name:w.name.trim(),job_number:w.job_number?.trim()||null,address:w.address?.trim()||null,general_contractor:w.general_contractor?.trim()||null,client_contact:w.client_contact?.trim()||null,client_phone:w.client_phone?.trim()||null,contract_value:Ce,work_type:w.work_type||"demolition",job_type:w.job_type||"standard",pin:w.pin||null,default_dump_site_id:w.default_dump_site_id||null});const At=m.map(Ve=>Ve.id),Ct=w.areas.filter(Ve=>Ve.id).map(Ve=>Ve.id);for(const Ve of At)Ct.includes(Ve)||await nt.deleteArea(Ve);for(let Ve=0;Ve<st.length;Ve++){const _e=st[Ve];_e.id?await nt.updateArea(_e.id,{name:_e.name.trim(),weight:parseFloat(_e.weight),sort_order:Ve}):await nt.createArea({project_id:d.id,name:_e.name.trim(),weight:parseFloat(_e.weight),status:"not_started",sort_order:Ve})}const Te=await nt.getProject(d.id);f(Te),await je(d.id),_(!1),E(null),e("Project updated!","success")}catch(At){console.error("Error saving project:",At?.message||At),e(At?.message||"Error saving changes","error")}finally{A(!1)}},ve=async()=>{if(confirm("Are you sure you want to delete this project? This cannot be undone."))try{await nt.deleteProject(d.id),e("Project deleted","success"),ge()}catch(Ce){console.error("Error deleting project:",Ce),e("Error deleting project","error")}};if(x)return i.jsxs("div",{className:"loading",children:[i.jsx("div",{className:"spinner"}),"Loading projects..."]});if(d){const Ce=l.find(kt=>kt.id===d.id),st=uw(m),Dt=st.progress,At=Ce?.changeOrderValue||0,Ct=d.contract_value+At,Te=st.isValueBased?st.earnedValue:Dt/100*Ct,Ve=st.isValueBased;st.earnedValue;const _e=st.totalValue;if(b&&w){const kt=w.areas.reduce((sr,Pr)=>sr+(parseFloat(Pr.weight)||0),0);return i.jsxs("div",{children:[i.jsx("button",{className:"btn btn-secondary btn-small",onClick:le,style:{marginBottom:"1.5rem"},children:" Cancel"}),i.jsx("h1",{children:"Edit Project"}),i.jsx("p",{className:"subtitle",children:"Update project details"}),i.jsxs("div",{className:"card",children:[i.jsx("h3",{children:"Basic Info"}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",style:{flex:2},children:[i.jsx("label",{children:"Project Name *"}),i.jsx("input",{type:"text",value:w.name,onChange:sr=>Ge("name",sr.target.value),placeholder:"e.g., Downtown Office Demolition"})]}),i.jsxs("div",{className:"form-group",style:{flex:1},children:[i.jsx("label",{children:"Job Number"}),i.jsx("input",{type:"text",value:w.job_number,onChange:sr=>Ge("job_number",sr.target.value),placeholder:"e.g., 2024-001"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Project Address"}),i.jsx("input",{type:"text",value:w.address,onChange:sr=>Ge("address",sr.target.value),placeholder:"123 Main St, City, State 12345"})]})]}),i.jsxs("div",{className:"card",children:[i.jsx("h3",{children:"Client & Contractor"}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"General Contractor"}),i.jsx("input",{type:"text",value:w.general_contractor,onChange:sr=>Ge("general_contractor",sr.target.value),placeholder:"e.g., ABC Construction"})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Client Contact"}),i.jsx("input",{type:"text",value:w.client_contact,onChange:sr=>Ge("client_contact",sr.target.value),placeholder:"Contact name"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Client Phone"}),i.jsx("input",{type:"tel",value:w.client_phone,onChange:sr=>Ge("client_phone",sr.target.value),placeholder:"(555) 123-4567"})]})]})]}),i.jsxs("div",{className:"card",children:[i.jsx("h3",{children:"Financials & Settings"}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Contract Value ($) *"}),i.jsx("input",{type:"number",value:w.contract_value,onChange:sr=>Ge("contract_value",sr.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Foreman PIN"}),i.jsx("input",{type:"text",value:w.pin,onChange:sr=>Ge("pin",sr.target.value.replace(/\D/g,"").slice(0,4)),placeholder:"4 digits",maxLength:4}),i.jsx("span",{className:"form-hint",children:"Used for field crew access"})]})]}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Work Type"}),i.jsxs("select",{value:w.work_type,onChange:sr=>Ge("work_type",sr.target.value),children:[i.jsx("option",{value:"demolition",children:"Demolition"}),i.jsx("option",{value:"environmental",children:"Environmental"})]}),i.jsx("span",{className:"form-hint",children:"Affects labor rate calculations"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Job Type"}),i.jsxs("select",{value:w.job_type,onChange:sr=>Ge("job_type",sr.target.value),children:[i.jsx("option",{value:"standard",children:"Standard"}),i.jsx("option",{value:"prevailing_wage",children:"Prevailing Wage"})]})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Default Dump Site"}),i.jsxs("select",{value:w.default_dump_site_id,onChange:sr=>Ge("default_dump_site_id",sr.target.value),children:[i.jsx("option",{value:"",children:"-- Select Dump Site --"}),Z.map(sr=>i.jsx("option",{value:sr.id,children:sr.name},sr.id))]}),i.jsx("span",{className:"form-hint",children:"Used for haul-off tracking and cost estimates"})]})]}),i.jsxs("div",{className:"card",children:[i.jsx("h3",{children:"Areas"}),i.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",marginBottom:"1rem"},children:"Weights must total 100%."}),w.areas.map((sr,Pr)=>i.jsxs("div",{className:"area-row",children:[i.jsx("input",{type:"text",placeholder:"Area name",value:sr.name,onChange:Nt=>rt(Pr,"name",Nt.target.value)}),i.jsx("input",{type:"number",placeholder:"%",value:sr.weight,onChange:Nt=>rt(Pr,"weight",Nt.target.value)}),i.jsx("button",{className:"remove-btn",onClick:()=>ot(Pr),children:""})]},Pr)),i.jsxs("div",{className:"weight-total",children:[i.jsx("span",{className:"weight-total-label",children:"Total Weight:"}),i.jsxs("span",{className:`weight-total-value ${kt===100?"valid":"invalid"}`,children:[kt,"%"]})]}),i.jsx("button",{className:"btn btn-secondary",onClick:ue,children:"+ Add Area"})]}),i.jsx("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem"},children:i.jsx("button",{className:"btn btn-primary",onClick:xe,disabled:C,style:{flex:1},children:C?"Saving...":"Save Changes"})}),i.jsx("button",{className:"btn btn-danger btn-full",onClick:ve,children:"Delete Project"})]})}const Ue=m.filter(kt=>kt.status==="done").length,Fe=m.filter(kt=>kt.status==="working").length,gt=m.filter(kt=>kt.status==="not_started").length,Ht=Ct>0?Math.round(Te/Ct*100):0,Vt=At>0,zt=[{id:"overview",label:"Overview",Icon:lw},{id:"financials",label:"Financials",Icon:Qf},{id:"reports",label:"Reports",Icon:uo},{id:"activity",label:"Activity",Icon:lc},{id:"info",label:"Info",Icon:_x}];return i.jsxs("div",{className:"project-view tabbed",children:[i.jsxs("div",{className:"pv-sticky-header",children:[i.jsxs("div",{className:"pv-header-row",children:[i.jsxs("button",{className:"pv-back",onClick:ge,children:[i.jsx("span",{children:""}),i.jsx("span",{children:"Back"})]}),i.jsxs("div",{className:"pv-actions",children:[i.jsx("button",{className:"pv-action",onClick:()=>G(!0),children:"Share"}),i.jsx("button",{className:"pv-action",onClick:()=>B(!0),children:"Alerts"}),i.jsx("button",{className:"pv-action",onClick:Ie,children:"Edit"})]})]}),i.jsxs("div",{className:"pv-header-title",children:[i.jsx("h1",{children:d.name}),(d.job_number||d.work_type)&&i.jsxs("span",{className:"pv-header-meta",children:[d.job_number&&`Job #${d.job_number}`,d.job_number&&d.work_type&&"  ",d.work_type]})]}),i.jsxs("div",{className:"pv-metrics-bar",children:[i.jsxs("div",{className:"pv-metric",children:[i.jsxs("span",{className:"pv-metric-value",children:[Dt,"%"]}),i.jsx("span",{className:"pv-metric-label",children:"Complete"})]}),i.jsx("div",{className:"pv-metric-divider"}),i.jsxs("div",{className:"pv-metric",children:[i.jsx("span",{className:"pv-metric-value",children:Ua(Te)}),i.jsx("span",{className:"pv-metric-label",children:"Billed"})]}),i.jsx("div",{className:"pv-metric-divider"}),i.jsxs("div",{className:"pv-metric",children:[i.jsx("span",{className:"pv-metric-value highlight",children:Ua(Ct-Te)}),i.jsx("span",{className:"pv-metric-label",children:"Remaining"})]})]}),i.jsx("div",{className:"pv-tabs",children:zt.map(kt=>i.jsxs("button",{className:`pv-tab ${q===kt.id?"active":""}`,onClick:()=>L(kt.id),children:[i.jsx(kt.Icon,{size:16,className:"pv-tab-icon"}),i.jsx("span",{className:"pv-tab-label",children:kt.label})]},kt.id))})]}),i.jsxs("div",{className:"pv-tab-content",children:[q==="overview"&&i.jsxs("div",{className:"pv-tab-panel overview-tab",children:[i.jsx("div",{className:"overview-hero",children:i.jsxs("div",{className:"overview-hero-grid",children:[i.jsxs("div",{className:"overview-metric primary",children:[i.jsxs("div",{className:"overview-metric-value",children:[Dt,"%"]}),i.jsx("div",{className:"overview-metric-label",children:"Complete"}),i.jsx("div",{className:"overview-metric-bar",children:i.jsx("div",{className:"overview-metric-fill",style:{width:`${Dt}%`}})})]}),i.jsxs("div",{className:"overview-metric",children:[i.jsxs("div",{className:"overview-metric-value",children:[Ue,"/",m.length]}),i.jsx("div",{className:"overview-metric-label",children:"Areas Done"}),i.jsx("div",{className:"overview-metric-detail",children:Fe>0&&i.jsxs("span",{className:"working",children:[Fe," active"]})})]}),i.jsxs("div",{className:"overview-metric",children:[i.jsx("div",{className:"overview-metric-value",children:Ua(Ct)}),i.jsx("div",{className:"overview-metric-label",children:"Contract"}),Vt&&i.jsxs("div",{className:"overview-metric-detail green",children:["+",Ua(At)," COs"]})]}),i.jsxs("div",{className:"overview-metric",children:[i.jsx("div",{className:"overview-metric-value green",children:Ua(Te)}),i.jsx("div",{className:"overview-metric-label",children:"Earned"}),i.jsx("div",{className:"overview-metric-detail",children:Ve?i.jsxs("span",{children:["of ",Ua(_e)," SOV"]}):i.jsxs("span",{children:[Ht,"% billed"]})})]})]})}),(Ce?.pendingTickets>0||Ce?.pendingMaterialRequests>0||Ce?.changeOrderPending>0)&&i.jsxs("div",{className:"overview-attention-card",children:[i.jsxs("div",{className:"attention-header",children:[i.jsx("h3",{children:"Needs Attention"}),i.jsxs("span",{className:"attention-count",children:[(Ce?.pendingTickets||0)+(Ce?.pendingMaterialRequests||0)+(Ce?.changeOrderPending||0)," items"]})]}),i.jsxs("div",{className:"attention-items",children:[Ce?.pendingTickets>0&&i.jsxs("div",{className:"attention-item",onClick:()=>L("financials"),children:[i.jsx("div",{className:"attention-item-icon warning",children:i.jsx(uo,{size:16})}),i.jsxs("div",{className:"attention-item-content",children:[i.jsxs("span",{className:"attention-item-title",children:[Ce.pendingTickets," T&M ticket",Ce.pendingTickets!==1?"s":""," awaiting approval"]}),i.jsx("span",{className:"attention-item-action",children:"Review in Financials"})]}),i.jsx("span",{className:"attention-item-arrow",children:""})]}),Ce?.changeOrderPending>0&&i.jsxs("div",{className:"attention-item",onClick:()=>L("financials"),children:[i.jsx("div",{className:"attention-item-icon info",children:i.jsx(ho,{size:16})}),i.jsxs("div",{className:"attention-item-content",children:[i.jsxs("span",{className:"attention-item-title",children:[Ce.changeOrderPending," change order",Ce.changeOrderPending!==1?"s":""," pending"]}),i.jsx("span",{className:"attention-item-action",children:"Review in Financials"})]}),i.jsx("span",{className:"attention-item-arrow",children:""})]}),Ce?.pendingMaterialRequests>0&&i.jsxs("div",{className:"attention-item",onClick:()=>L("activity"),children:[i.jsx("div",{className:"attention-item-icon warning",children:i.jsx(lc,{size:16})}),i.jsxs("div",{className:"attention-item-content",children:[i.jsxs("span",{className:"attention-item-title",children:[Ce.pendingMaterialRequests," material request",Ce.pendingMaterialRequests!==1?"s":""," pending"]}),i.jsx("span",{className:"attention-item-action",children:"Review in Activity"})]}),i.jsx("span",{className:"attention-item-arrow",children:""})]})]})]}),i.jsxs("div",{className:"overview-section-card",children:[i.jsxs("div",{className:"section-card-header",children:[i.jsx("h3",{children:"Work Areas"}),i.jsxs("div",{className:"section-card-badges",children:[Ue>0&&i.jsxs("span",{className:"section-badge done",children:[Ue," Complete"]}),Fe>0&&i.jsxs("span",{className:"section-badge working",children:[Fe," Active"]}),gt>0&&i.jsxs("span",{className:"section-badge pending",children:[gt," Pending"]})]})]}),i.jsx("div",{className:"work-areas-list",children:m.map(kt=>i.jsxs("div",{className:`work-area-item ${kt.status}`,children:[i.jsxs("div",{className:"work-area-status",children:[kt.status==="done"&&i.jsx("span",{className:"status-icon done",children:""}),kt.status==="working"&&i.jsx("span",{className:"status-icon working",children:""}),kt.status==="not_started"&&i.jsx("span",{className:"status-icon pending",children:""})]}),i.jsxs("div",{className:"work-area-info",children:[i.jsx("span",{className:"work-area-name",children:kt.name}),i.jsx("span",{className:"work-area-weight",children:kt.scheduled_value?Ua(kt.scheduled_value):`${kt.weight}%`})]}),i.jsx("div",{className:"work-area-bar",children:i.jsx("div",{className:`work-area-fill ${kt.status}`,style:{width:kt.status==="done"?"100%":kt.status==="working"?"50%":"0%"}})})]},kt.id))})]}),i.jsxs("div",{className:"overview-stats-row",children:[i.jsxs("div",{className:"quick-stat-card",onClick:()=>L("reports"),children:[i.jsx("div",{className:"quick-stat-icon",children:i.jsx(uo,{size:20})}),i.jsxs("div",{className:"quick-stat-content",children:[i.jsx("span",{className:"quick-stat-value",children:Ce?.dailyReportsCount||0}),i.jsx("span",{className:"quick-stat-label",children:"Daily Reports"})]}),i.jsx("span",{className:"quick-stat-arrow",children:""})]}),i.jsxs("div",{className:"quick-stat-card",onClick:()=>L("financials"),children:[i.jsx("div",{className:"quick-stat-icon",children:i.jsx(Qf,{size:20})}),i.jsxs("div",{className:"quick-stat-content",children:[i.jsx("span",{className:"quick-stat-value",children:Ce?.totalTickets||0}),i.jsx("span",{className:"quick-stat-label",children:"T&M Tickets"})]}),i.jsx("span",{className:"quick-stat-arrow",children:""})]}),i.jsxs("div",{className:"quick-stat-card",onClick:()=>L("activity"),children:[i.jsx("div",{className:"quick-stat-icon",children:i.jsx(lc,{size:20})}),i.jsxs("div",{className:"quick-stat-content",children:[i.jsx("span",{className:"quick-stat-value",children:Ce?.totalMaterialRequests||0}),i.jsx("span",{className:"quick-stat-label",children:"Material Requests"})]}),i.jsx("span",{className:"quick-stat-arrow",children:""})]})]})]}),q==="financials"&&i.jsxs("div",{className:"pv-tab-panel financials-tab",children:[i.jsx("div",{className:"financials-hero",children:i.jsxs("div",{className:"financials-hero-grid",children:[i.jsxs("div",{className:"fin-metric",children:[i.jsx("div",{className:"fin-metric-label",children:"Contract"}),i.jsx("div",{className:"fin-metric-value",children:Ua(Ct)}),Vt&&i.jsxs("div",{className:"fin-metric-detail green",children:["+",Ua(At)," COs"]})]}),i.jsxs("div",{className:"fin-metric",children:[i.jsx("div",{className:"fin-metric-label",children:"Earned"}),i.jsx("div",{className:"fin-metric-value",children:Ua(Te)}),i.jsx("div",{className:"fin-metric-bar",children:i.jsx("div",{className:"fin-metric-fill",style:{width:`${Ht}%`}})})]}),i.jsxs("div",{className:"fin-metric",children:[i.jsx("div",{className:"fin-metric-label",children:"Costs"}),i.jsx("div",{className:"fin-metric-value",children:Ua(Ce?.allCostsTotal||0)}),Te>0&&i.jsxs("div",{className:`fin-metric-detail ${(Ce?.allCostsTotal||0)/Te>.6?"warning":""}`,children:[Math.round((Ce?.allCostsTotal||0)/Te*100),"% of revenue"]})]}),i.jsxs("div",{className:"fin-metric",children:[i.jsx("div",{className:"fin-metric-label",children:"Profit"}),i.jsx("div",{className:`fin-metric-value ${(Ce?.currentProfit||0)<0?"negative":"positive"}`,children:Ua(Ce?.currentProfit||0)}),i.jsxs("div",{className:`fin-metric-detail ${(Ce?.profitMargin||0)<20?"warning":""}`,children:[Math.round(Ce?.profitMargin||0),"% margin"]})]})]})}),i.jsxs("div",{className:"financials-analysis-row",children:[i.jsx(c$,{dailyBurn:Ce?.dailyBurn||0,totalBurn:Ce?.totalBurn||0,daysWorked:Ce?.totalBurnDays||0,laborCost:Ce?.laborCost||0,haulOffCost:Ce?.haulOffCost||0,progress:Dt,contractValue:Ct,laborByDate:Ce?.laborByDate||[],haulOffByDate:Ce?.haulOffByDate||[]}),i.jsx(d$,{revenue:Te,totalCosts:Ce?.allCostsTotal||0,contractValue:Ct,progress:Dt})]}),i.jsx(u$,{laborCost:Ce?.laborCost||0,haulOffCost:Ce?.haulOffCost||0,customCosts:Ce?.customCosts||[],onAddCost:()=>F(!0),onDeleteCost:async kt=>{try{await nt.deleteProjectCost(kt),se(),e("Cost deleted","success")}catch{e("Error deleting cost","error")}}}),i.jsxs("div",{className:"financials-pipeline",children:[i.jsxs("div",{className:"pipeline-header",children:[i.jsx("h2",{children:"Extra Work"}),i.jsxs("div",{className:"pipeline-flow",children:[i.jsx("span",{className:"pipeline-step",children:"T&M Tickets"}),i.jsx("span",{className:"pipeline-arrow",children:""}),i.jsx("span",{className:"pipeline-step active",children:"Change Orders"})]})]}),i.jsxs("div",{className:"pipeline-content",children:[i.jsxs("div",{className:"pipeline-section",children:[i.jsxs("div",{className:"pipeline-section-header",children:[i.jsx("h3",{children:"T&M Tickets"}),i.jsxs("span",{className:"pipeline-badge",children:[Ce?.totalTickets||0," total",Ce?.pendingTickets>0&&`  ${Ce.pendingTickets} pending`]})]}),i.jsx(zH,{project:d,company:t,onShowToast:e})]}),i.jsx("div",{className:"pipeline-section",children:i.jsx(e$,{project:d,company:t,areas:m,refreshKey:fe,onShowToast:e,onCreateCOR:()=>{ie(null),M(!0)},onViewCOR:kt=>{te(kt),J(!0)},onEditCOR:kt=>{ie(kt),M(!0)}})})]})]}),i.jsxs("details",{className:"financials-details",children:[i.jsxs("summary",{className:"financials-details-summary",children:[i.jsx(bs,{size:16}),i.jsx("span",{children:"Labor Details"}),i.jsx("span",{className:"financials-details-value",children:Ua(Ce?.laborCost||0)})]}),i.jsx("div",{className:"financials-details-content",children:i.jsx(JH,{project:d,company:t,onShowToast:e})})]})]}),q==="reports"&&i.jsxs("div",{className:"pv-tab-panel reports-tab",children:[i.jsx("div",{className:"reports-hero",children:i.jsxs("div",{className:"reports-hero-grid",children:[i.jsxs("div",{className:"reports-metric primary",children:[i.jsx("div",{className:"reports-metric-icon",children:i.jsx(uo,{size:24})}),i.jsxs("div",{className:"reports-metric-content",children:[i.jsx("div",{className:"reports-metric-value",children:Ce?.dailyReportsCount||0}),i.jsx("div",{className:"reports-metric-label",children:"Daily Reports"})]})]}),i.jsxs("div",{className:"reports-metric",children:[i.jsx("div",{className:"reports-metric-value",children:Ce?.recentDailyReports||0}),i.jsx("div",{className:"reports-metric-label",children:"This Week"}),i.jsx("div",{className:"reports-metric-bar",children:i.jsx("div",{className:"reports-metric-fill",style:{width:`${Math.min((Ce?.recentDailyReports||0)/7*100,100)}%`}})})]}),i.jsxs("div",{className:`reports-metric ${(Ce?.injuryReportsCount||0)>0?"warning":"success"}`,children:[i.jsx("div",{className:"reports-metric-value",children:Ce?.injuryReportsCount||0}),i.jsx("div",{className:"reports-metric-label",children:"Injuries"}),i.jsx("div",{className:"reports-metric-status",children:(Ce?.injuryReportsCount||0)===0?"No incidents":"Review required"})]}),i.jsxs("div",{className:"reports-metric",children:[i.jsx("div",{className:"reports-metric-value small",children:Ce?.lastDailyReport?new Date(Ce.lastDailyReport).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"None"}),i.jsx("div",{className:"reports-metric-label",children:"Last Filed"}),Ce?.lastDailyReport&&i.jsxs("div",{className:"reports-metric-detail",children:[Math.floor((new Date-new Date(Ce.lastDailyReport))/(1e3*60*60*24))," days ago"]})]})]})}),i.jsxs("div",{className:"reports-section-card",children:[i.jsxs("div",{className:"reports-section-header",children:[i.jsxs("div",{className:"reports-section-title",children:[i.jsx(uo,{size:18}),i.jsx("h3",{children:"Daily Reports"})]}),i.jsxs("span",{className:"reports-section-count",children:[Ce?.dailyReportsCount||0," total"]})]}),i.jsx("div",{className:"reports-section-content",children:i.jsx(XH,{project:d,company:t,onShowToast:e})})]}),i.jsxs("div",{className:`reports-section-card ${(Ce?.injuryReportsCount||0)>0?"has-warning":""}`,children:[i.jsxs("div",{className:"reports-section-header",children:[i.jsxs("div",{className:"reports-section-title",children:[i.jsx("span",{className:`reports-section-icon ${(Ce?.injuryReportsCount||0)>0?"warning":"success"}`,children:(Ce?.injuryReportsCount||0)>0?"":""}),i.jsx("h3",{children:"Safety & Injury Reports"})]}),i.jsx("span",{className:`reports-section-badge ${(Ce?.injuryReportsCount||0)>0?"warning":"success"}`,children:(Ce?.injuryReportsCount||0)>0?`${Ce.injuryReportsCount} incident${Ce.injuryReportsCount!==1?"s":""}`:"No incidents"})]}),i.jsx("div",{className:"reports-section-content",children:i.jsx(WH,{project:d,companyId:t?.id||d?.company_id,company:t,onShowToast:e})})]})]}),q==="activity"&&i.jsxs("div",{className:"pv-tab-panel activity-tab",children:[i.jsx("div",{className:"activity-hero",children:i.jsxs("div",{className:"activity-hero-grid",children:[i.jsxs("div",{className:`activity-metric ${(Ce?.pendingMaterialRequests||0)>0?"warning":"success"}`,children:[i.jsx("div",{className:"activity-metric-icon",children:(Ce?.pendingMaterialRequests||0)>0?"!":""}),i.jsxs("div",{className:"activity-metric-content",children:[i.jsx("div",{className:"activity-metric-value",children:Ce?.pendingMaterialRequests||0}),i.jsx("div",{className:"activity-metric-label",children:"Pending"})]})]}),i.jsxs("div",{className:"activity-metric",children:[i.jsx("div",{className:"activity-metric-value",children:Ce?.totalMaterialRequests||0}),i.jsx("div",{className:"activity-metric-label",children:"Total Requests"})]}),i.jsxs("div",{className:"activity-metric",children:[i.jsxs("div",{className:"activity-metric-value",children:[Ce?.totalMaterialRequests>0?Math.round((Ce.totalMaterialRequests-(Ce.pendingMaterialRequests||0))/Ce.totalMaterialRequests*100):100,"%"]}),i.jsx("div",{className:"activity-metric-label",children:"Fulfilled"}),i.jsx("div",{className:"activity-metric-bar",children:i.jsx("div",{className:"activity-metric-fill",style:{width:`${Ce?.totalMaterialRequests>0?(Ce.totalMaterialRequests-(Ce.pendingMaterialRequests||0))/Ce.totalMaterialRequests*100:100}%`}})})]}),i.jsxs("div",{className:"activity-metric status",children:[i.jsx("div",{className:"activity-metric-status-icon",children:i.jsx(lc,{size:20})}),i.jsx("div",{className:"activity-metric-label",children:"Messages Active"})]})]})}),(Ce?.pendingMaterialRequests||0)>0&&i.jsxs("div",{className:"activity-attention-banner",children:[i.jsx("span",{className:"attention-icon",children:"!"}),i.jsxs("span",{className:"attention-text",children:[Ce.pendingMaterialRequests," material request",Ce.pendingMaterialRequests!==1?"s":""," awaiting response"]})]}),i.jsxs("div",{className:`activity-section-card ${(Ce?.pendingMaterialRequests||0)>0?"has-pending":""}`,children:[i.jsxs("div",{className:"activity-section-header",children:[i.jsxs("div",{className:"activity-section-title",children:[i.jsx(bs,{size:18}),i.jsx("h3",{children:"Material Requests"})]}),i.jsxs("div",{className:"activity-section-badges",children:[(Ce?.pendingMaterialRequests||0)>0&&i.jsxs("span",{className:"activity-badge pending",children:[Ce.pendingMaterialRequests," pending"]}),i.jsxs("span",{className:"activity-badge total",children:[Ce?.totalMaterialRequests||0," total"]})]})]}),i.jsx("div",{className:"activity-section-content",children:i.jsx(GH,{project:d,company:t,onShowToast:e})})]}),i.jsxs("div",{className:"activity-section-card messages",children:[i.jsx("div",{className:"activity-section-header",children:i.jsxs("div",{className:"activity-section-title",children:[i.jsx(lc,{size:18}),i.jsx("h3",{children:"Project Messages"})]})}),i.jsx("div",{className:"activity-section-content",children:i.jsx(KH,{project:d,company:t,userName:t?.name||"Office",onShowToast:e})})]})]}),q==="info"&&i.jsxs("div",{className:"pv-tab-panel info-tab",children:[i.jsxs("div",{className:"info-hero",children:[i.jsxs("div",{className:"info-hero-content",children:[i.jsxs("div",{className:"info-hero-main",children:[i.jsx("h2",{className:"info-hero-title",children:d.name}),d.job_number&&i.jsxs("span",{className:"info-hero-job",children:["Job #",d.job_number]})]}),i.jsx("button",{className:"btn btn-primary btn-with-icon",onClick:Ie,children:i.jsx("span",{children:"Edit Project"})})]}),d.address&&i.jsxs("div",{className:"info-hero-address",children:[i.jsx(xT,{size:14}),i.jsx("span",{children:d.address})]})]}),i.jsxs("div",{className:"info-quick-grid",children:[i.jsxs("div",{className:"info-quick-card",children:[i.jsx("div",{className:"info-quick-icon",children:i.jsx(bs,{size:20})}),i.jsxs("div",{className:"info-quick-content",children:[i.jsx("span",{className:"info-quick-value",children:d.work_type==="environmental"?"Environmental":"Demolition"}),i.jsx("span",{className:"info-quick-label",children:"Work Type"})]})]}),i.jsxs("div",{className:"info-quick-card",children:[i.jsx("div",{className:"info-quick-icon",children:i.jsx(ho,{size:20})}),i.jsxs("div",{className:"info-quick-content",children:[i.jsx("span",{className:"info-quick-value",children:d.job_type==="prevailing_wage"?"Prevailing Wage":"Standard"}),i.jsx("span",{className:"info-quick-label",children:"Job Type"})]})]}),i.jsxs("div",{className:"info-quick-card highlight",children:[i.jsx("div",{className:"info-quick-icon",children:i.jsx(Qf,{size:20})}),i.jsxs("div",{className:"info-quick-content",children:[i.jsx("span",{className:"info-quick-value",children:Ua(Ct)}),i.jsx("span",{className:"info-quick-label",children:At>0?`Incl. +${Ua(At)} COs`:"Contract Value"})]})]}),d.pin&&i.jsxs("div",{className:"info-quick-card",children:[i.jsx("div",{className:"info-quick-icon",children:i.jsx("span",{className:"info-pin-icon",children:"#"})}),i.jsxs("div",{className:"info-quick-content",children:[i.jsx("span",{className:"info-quick-value mono",children:d.pin}),i.jsx("span",{className:"info-quick-label",children:"Foreman PIN"})]})]})]}),i.jsxs("div",{className:"info-section-card",children:[i.jsxs("div",{className:"info-section-header",children:[i.jsx(n2,{size:18}),i.jsx("h3",{children:"Client & Contractor"})]}),i.jsxs("div",{className:"info-section-content",children:[d.general_contractor?i.jsxs("div",{className:"info-detail-row",children:[i.jsx("span",{className:"info-detail-label",children:"General Contractor"}),i.jsx("span",{className:"info-detail-value",children:d.general_contractor})]}):i.jsx("div",{className:"info-detail-row empty",children:i.jsx("span",{className:"info-detail-value",children:"No general contractor specified"})}),d.client_contact&&i.jsxs("div",{className:"info-detail-row",children:[i.jsx("span",{className:"info-detail-label",children:"Client Contact"}),i.jsx("span",{className:"info-detail-value",children:d.client_contact})]}),d.client_phone&&i.jsxs("div",{className:"info-detail-row clickable",children:[i.jsxs("span",{className:"info-detail-label",children:[i.jsx(OT,{size:14}),"Phone"]}),i.jsx("a",{href:`tel:${d.client_phone}`,className:"info-detail-value link",children:d.client_phone})]})]})]}),i.jsxs("div",{className:"info-section-card",children:[i.jsxs("div",{className:"info-section-header",children:[i.jsx(lw,{size:18}),i.jsx("h3",{children:"Work Areas"}),i.jsxs("div",{className:"info-section-badges",children:[Ue>0&&i.jsxs("span",{className:"info-badge done",children:[Ue," Done"]}),Fe>0&&i.jsxs("span",{className:"info-badge working",children:[Fe," Active"]}),gt>0&&i.jsxs("span",{className:"info-badge pending",children:[gt," Pending"]})]})]}),i.jsx("div",{className:"info-areas-list",children:m.map(kt=>i.jsxs("div",{className:`info-area-item ${kt.status}`,children:[i.jsxs("div",{className:"info-area-status",children:[kt.status==="done"&&i.jsx("span",{className:"status-dot done",children:""}),kt.status==="working"&&i.jsx("span",{className:"status-dot working",children:""}),kt.status==="not_started"&&i.jsx("span",{className:"status-dot pending",children:""})]}),i.jsxs("div",{className:"info-area-details",children:[i.jsx("span",{className:"info-area-name",children:kt.name}),i.jsx("span",{className:`info-area-status-label ${kt.status}`,children:kt.status==="done"?"Complete":kt.status==="working"?"In Progress":"Not Started"})]}),i.jsxs("span",{className:"info-area-weight",children:[kt.weight,"%"]})]},kt.id))})]}),i.jsxs("details",{className:"info-details-section",children:[i.jsxs("summary",{className:"info-details-summary",children:[i.jsx(_x,{size:16}),i.jsx("span",{children:"Additional Settings"})]}),i.jsxs("div",{className:"info-details-content",children:[i.jsxs("div",{className:"info-detail-row",children:[i.jsx("span",{className:"info-detail-label",children:"Original Contract"}),i.jsx("span",{className:"info-detail-value",children:Ua(d.contract_value)})]}),At>0&&i.jsxs("div",{className:"info-detail-row",children:[i.jsx("span",{className:"info-detail-label",children:"Approved Change Orders"}),i.jsxs("span",{className:"info-detail-value positive",children:["+",Ua(At)]})]}),d.default_dump_site_id&&i.jsxs("div",{className:"info-detail-row",children:[i.jsx("span",{className:"info-detail-label",children:"Default Dump Site"}),i.jsx("span",{className:"info-detail-value",children:Z.find(kt=>kt.id===d.default_dump_site_id)?.name||"Unknown"})]})]})]})]})]}),O&&i.jsx(HH,{project:d,onClose:()=>G(!1),onShareCreated:kt=>{e("Share link created successfully!","success")}}),W&&i.jsx("div",{className:"notification-settings-modal",children:i.jsx(VH,{project:d,company:t,onShowToast:e,onClose:()=>B(!1)})}),T&&i.jsx(r$,{project:d,company:t,areas:m,existingCOR:V,onClose:()=>{M(!1),ie(null)},onSaved:()=>{M(!1),ie(null),U(kt=>kt+1)},onShowToast:e}),X&&K&&i.jsx(o$,{cor:K,project:d,company:t,areas:m,onClose:()=>{J(!1),te(null)},onEdit:kt=>{J(!1),te(null),ie(kt),M(!0)},onShowToast:e,onStatusChange:()=>{}}),j&&i.jsx(h$,{onClose:()=>F(!1),saving:I,onSave:async kt=>{try{z(!0),await nt.addProjectCost(d.id,t.id,kt),F(!1),se(),e("Cost added successfully","success")}catch(sr){console.error("Error adding cost:",sr),e("Error adding cost","error")}finally{z(!1)}}})]})}if(n.length===0)return i.jsxs("div",{className:"empty-state",children:[i.jsx(uo,{size:48,className:"empty-state-icon"}),i.jsx("h3",{children:"No Projects Yet"}),i.jsx("p",{children:"Create your first project to get started"})]});const Be=l.reduce((Ce,st)=>Ce+(st.contract_value||0),0),jt=l.reduce((Ce,st)=>Ce+(st.changeOrderValue||0),0),Je=Be+jt,ct=l.reduce((Ce,st)=>Ce+(st.billable||0),0),St=Je-ct,Ft=Je>0?Math.round(ct/Je*100):0,Xt=l.filter(Ce=>Ce.progress>=100).length,Ut=l.filter(Ce=>Ce.progress<100&&Ce.billable<=(Ce.revisedContractValue||Ce.contract_value)*(Ce.progress/100)*1.1).length,Wt=l.filter(Ce=>Ce.billable>(Ce.revisedContractValue||Ce.contract_value)*.9&&Ce.progress<90).length,$t=l.filter(Ce=>Ce.billable>(Ce.revisedContractValue||Ce.contract_value)).length,wt=l.filter(Ce=>(Ce.changeOrderValue||0)>0).length;return i.jsxs("div",{children:[i.jsxs("div",{className:"business-overview",children:[i.jsxs("div",{className:"bo-header",children:[i.jsx("h2",{className:"bo-title",children:"Portfolio Overview"}),i.jsxs("div",{className:"bo-project-count",children:[n.length," Active Project",n.length!==1?"s":""]})]}),i.jsxs("div",{className:"bo-financial",children:[i.jsx("div",{className:"bo-progress-bar",children:i.jsx("div",{className:"bo-progress-fill",style:{width:`${Math.min(Ft,100)}%`}})}),i.jsxs("div",{className:"bo-financial-row",children:[i.jsxs("div",{className:"bo-metric primary",children:[i.jsx("span",{className:"bo-metric-value",children:Ua(ct)}),i.jsx("span",{className:"bo-metric-label",children:"Earned Revenue"})]}),i.jsx("div",{className:"bo-metric-separator",children:"of"}),i.jsxs("div",{className:"bo-metric primary",children:[i.jsx("span",{className:"bo-metric-value",children:Ua(Je)}),i.jsx("span",{className:"bo-metric-label",children:"Total Portfolio"})]}),i.jsxs("div",{className:"bo-metric highlight",children:[i.jsx("span",{className:"bo-metric-value",children:Ua(St)}),i.jsx("span",{className:"bo-metric-label",children:"Remaining to Bill"})]})]}),jt>0&&i.jsxs("div",{className:"bo-change-orders",children:[i.jsxs("div",{className:"bo-co-item",children:[i.jsx("span",{className:"bo-co-label",children:"Original Contracts"}),i.jsx("span",{className:"bo-co-value",children:Ua(Be)})]}),i.jsxs("div",{className:"bo-co-item bo-co-added",children:[i.jsxs("span",{className:"bo-co-label",children:["+ Change Orders (",wt," project",wt!==1?"s":"",")"]}),i.jsxs("span",{className:"bo-co-value",children:["+",Ua(jt)]})]})]})]}),i.jsxs("div",{className:"bo-health",children:[i.jsx("div",{className:"bo-health-title",children:"Project Health"}),i.jsxs("div",{className:"bo-health-pills",children:[Xt>0&&i.jsxs("div",{className:"bo-pill complete",children:[i.jsx("span",{className:"bo-pill-count",children:Xt}),i.jsx("span",{className:"bo-pill-label",children:"Complete"})]}),Ut>0&&i.jsxs("div",{className:"bo-pill on-track",children:[i.jsx("span",{className:"bo-pill-count",children:Ut}),i.jsx("span",{className:"bo-pill-label",children:"On Track"})]}),Wt>0&&i.jsxs("div",{className:"bo-pill at-risk",children:[i.jsx("span",{className:"bo-pill-count",children:Wt}),i.jsx("span",{className:"bo-pill-label",children:"At Risk"})]}),$t>0&&i.jsxs("div",{className:"bo-pill over-budget",children:[i.jsx("span",{className:"bo-pill-count",children:$t}),i.jsx("span",{className:"bo-pill-label",children:"Over Budget"})]})]})]})]}),i.jsxs("div",{className:"dashboard-header",children:[i.jsx("h2",{children:"Projects"}),i.jsxs("span",{className:"project-count",children:[n.length," active"]})]}),i.jsx("div",{className:"project-list",children:l.map(Ce=>i.jsx(p$,{project:Ce,onClick:()=>Ne(Ce)},Ce.id))})]})}function p$({project:t,onClick:e}){const r=oN(t.areas||[]),a=n8(t.areas||[]),n=t.contract_value-t.billable,s=t.billable>t.contract_value*.9&&t.progress<90;return i.jsxs("div",{className:`project-card enhanced ${s?"at-risk":""}`,onClick:e,children:[i.jsxs("div",{className:"project-card-header",children:[i.jsxs("div",{children:[i.jsx("div",{className:"project-card-name",children:t.name}),i.jsx("div",{className:"project-card-value",children:Ua(t.contract_value)})]}),i.jsx("span",{className:`status-badge ${r}`,children:a})]}),i.jsxs("div",{className:"project-stats-row",children:[i.jsxs("div",{className:"project-stat",children:[i.jsxs("span",{className:"stat-value",children:[t.progress,"%"]}),i.jsx("span",{className:"stat-label",children:"Complete"})]}),i.jsxs("div",{className:"project-stat",children:[i.jsx("span",{className:"stat-value",children:Ua(t.billable)}),i.jsx("span",{className:"stat-label",children:"Billable"})]}),i.jsxs("div",{className:"project-stat",children:[i.jsx("span",{className:`stat-value ${n<0?"negative":""}`,children:Ua(Math.abs(n))}),i.jsx("span",{className:"stat-label",children:n>=0?"Remaining":"Over Budget"})]})]}),i.jsx("div",{className:"mini-progress-bar",children:i.jsx("div",{className:"mini-progress-fill",style:{width:`${t.progress}%`}})}),(t.pendingTickets>0||t.totalTickets>0)&&i.jsxs("div",{className:"project-badges",children:[t.pendingTickets>0&&i.jsxs("span",{className:"badge pending",children:[t.pendingTickets," Pending T&M"]}),t.approvedTickets>0&&i.jsxs("span",{className:"badge approved",children:[t.approvedTickets," Approved T&M"]})]})]})}function g$({company:t,user:e,onProjectCreated:r,onShowToast:a}){const[n,s]=ee.useState(""),[l,c]=ee.useState(""),[d,f]=ee.useState(""),[m,v]=ee.useState(""),[x,g]=ee.useState(""),[b,_]=ee.useState(""),[w,E]=ee.useState("demolition"),[C,A]=ee.useState("standard"),[O,G]=ee.useState([{name:"",weight:"",group:"",scheduledValue:null},{name:"",weight:"",group:"",scheduledValue:null},{name:"",weight:"",group:"",scheduledValue:null}]),[W,B]=ee.useState(!1),[q,L]=ee.useState(!1),[Z,D]=ee.useState(!1),[T,M]=ee.useState([]),V=ee.useRef(null),ie=O.reduce((ge,Ie)=>ge+(parseFloat(Ie.weight)||0),0),X=ge=>{const Ie=ge.replace(/\D/g,"").slice(0,4);_(Ie)},J=()=>{const ge=Math.floor(1e3+Math.random()*9e3).toString();_(ge)},K=(ge,Ie,le)=>{G(Ge=>Ge.map((rt,ue)=>ue===ge?{...rt,[Ie]:le}:rt))},te=()=>{G(ge=>[...ge,{name:"",weight:"",group:"",scheduledValue:null}])},fe=ge=>{O.length>1&&G(Ie=>Ie.filter((le,Ge)=>Ge!==ge))},U=()=>{s(""),c(""),f(""),v(""),g(""),_(""),E("demolition"),A("standard"),G([{name:"",weight:"",group:"",scheduledValue:null},{name:"",weight:"",group:"",scheduledValue:null},{name:"",weight:"",group:"",scheduledValue:null}]),D(!1),M([])},j=()=>{V.current?.click()},F=ge=>new Promise((Ie,le)=>{const Ge=new FileReader;Ge.onload=rt=>{try{const ue=new Uint8Array(rt.target.result),ot=Rx(ue,{type:"array"}),xe=ot.SheetNames[0],ve=ot.Sheets[xe],Be=uu.sheet_to_json(ve,{header:1}),jt=[];let Je="General";const ct=/^\$?\d{1,3}(,\d{3})*(\.\d{2})?$/,St=/^(\d+\.?\d*|[A-Z]\.?\d*)$/i,Ft=/^(SF|LF|EA|LS|Days?|MD|Load|CY|SY|GAL|TON)$/i,Xt=/^\d{1,3}(,\d{3})*$|^\d+$/,Ut=/^(Item|#|No\.?|Description|Scheduled|Value|Amount|Quantity|Unit|Total|Application|Balance|Completed|Stored|Retainage)/i;for(const wt of Be){if(!wt||wt.length===0)continue;const Ce=wt.map(Fe=>Fe==null?"":String(Fe).trim()).filter(Fe=>Fe.length>0);if(Ce.length===0)continue;const st=Ce.join(" ");if(Ut.test(Ce[0])||Ce.length>1&&Ut.test(Ce[1])||/^(Total|Subtotal|Grand Total|Base Bid|Contract Sum)/i.test(st))continue;const Dt=Ce.some(Fe=>ct.test(Fe.replace(/[$,]/g,"")+(Fe.includes(".")?"":".00")));if((!Dt&&Ce.length<=3&&/^(L\d|Level|Floor|\d+(?:st|nd|rd|th)|Plaza|Street|Basement|Roof|Penthouse|Site|Exterior|Interior|Misc|MEP|ABATEMENT|DEMOLITION|UNIVERSAL|SOFT|TRASH|DEMO|Phase|Division|Section|Area|Building|Wing)/i.test(Ce[0])||Ce.length===2&&St.test(Ce[0])&&!Dt&&!/^\d+\.\d+$/.test(Ce[0]))&&!Dt){Je=(Ce.find(gt=>!St.test(gt)&&gt.length>1)||Ce.join(" ")).replace(/\s*\(\d{1,3}(?:,\d{3})*\s*SF\)\s*$/i,"").replace(/\s*[-:]\s*$/,"").trim();continue}let Ct="",Te=!1,Ve="",_e=null;const Ue=[];for(let Fe=0;Fe<Ce.length;Fe++){const gt=Ce[Fe];if(Fe===0&&St.test(gt)){Ve=gt;continue}if(!/^ID-\d+$/i.test(gt)&&!/^KN\s*\d+$/i.test(gt)){if(ct.test(gt.replace(/[$,]/g,"")+(gt.includes(".")?"":".00"))||/^\$/.test(gt)){const Ht=gt.replace(/[$,]/g,""),Vt=parseFloat(Ht);!isNaN(Vt)&&Vt>100&&(_e===null||Vt>_e)&&(_e=Vt),Te=!0;continue}if(Xt.test(gt.replace(/,/g,""))){Te=!0;continue}Ft.test(gt)||/^\d+\.?\d*%$/.test(gt)||gt.length>1&&!St.test(gt)&&Ue.push(gt)}}Ct=Ue.join(" ").trim(),Ct=Ct.replace(/\s+/g," ").replace(/^[-]\s*/,"").trim(),!(Ct.length<3)&&(/^(Plan|Page|Total|Base Bid|Payment|Condition|Exclusion|Subtotal)/i.test(Ct)||Te&&Ct.length>=3&&jt.push({name:Ct,group:Je,itemNumber:Ve,scheduledValue:_e,selected:!0}))}const Wt=new Set,$t=jt.filter(wt=>{const Ce=`${wt.group}:${wt.name}`;return Wt.has(Ce)?!1:(Wt.add(Ce),!0)});Ie($t)}catch(ue){le(ue)}},Ge.onerror=()=>le(new Error("Failed to read file")),Ge.readAsArrayBuffer(ge)}),I=async ge=>{const Ie=ge.target.files?.[0];if(!Ie)return;const le=Ie.name.split(".").pop().toLowerCase();if(!["xlsx","xls","csv"].includes(le)){a("Please upload an Excel file (.xlsx, .xls, or .csv)","error");return}L(!0);try{const Ge=await F(Ie);if(Ge.length===0){a("No tasks found. Check Excel format.","error"),L(!1);return}M(Ge),D(!0),a(`Found ${Ge.length} tasks`,"success")}catch(Ge){console.error("Excel import error:",Ge),a("Error reading Excel file","error")}finally{L(!1),V.current&&(V.current.value="")}},z=ge=>{M(Ie=>Ie.map((le,Ge)=>Ge===ge?{...le,selected:!le.selected}:le))},ne=()=>{const ge=T.filter(rt=>rt.selected);if(ge.length===0){a("Please select at least one task","error");return}const Ie=Math.round(100/ge.length*100)/100,le=ge.map((rt,ue)=>({name:rt.name,weight:ue===ge.length-1?(100-Ie*(ge.length-1)).toFixed(2):Ie.toFixed(2),group:rt.group,scheduledValue:rt.scheduledValue||null})),Ge=ge.reduce((rt,ue)=>rt+(ue.scheduledValue||0),0);if(G(le),D(!1),Ge>0){const rt=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0});a(`Tasks imported! Total SOV: ${rt.format(Ge)}`,"success")}else a("Tasks imported!","success")},se=async()=>{if(!t?.id){a("No company selected. Please log in again.","error");return}if(!n.trim()){a("Please enter a project name","error");return}const ge=parseFloat(x);if(!ge||ge<=0){a("Please enter a valid contract value","error");return}if(b.length!==4){a("Please enter a 4-digit PIN","error");return}if(!await nt.isPinAvailable(b)){a("This PIN is already in use. Try another.","error");return}const le=O.filter(Ge=>Ge.name.trim()&&parseFloat(Ge.weight)>0);if(le.length===0){a("Please add at least one area","error");return}if(Math.abs(ie-100)>.1){a("Area weights must total 100%","error");return}B(!0);try{const Ge=await nt.createProject({name:n.trim(),job_number:l.trim()||null,address:d.trim()||null,general_contractor:m.trim()||null,contract_value:ge,pin:b,work_type:w,job_type:C,company_id:t?.id,created_by:e?.id});for(let rt=0;rt<le.length;rt++)await nt.createArea({project_id:Ge.id,name:le[rt].name.trim(),weight:parseFloat(le[rt].weight),scheduled_value:le[rt].scheduledValue||null,group_name:le[rt].group||null,status:"not_started",sort_order:rt});a("Project created!","success"),U(),r()}catch(Ge){console.error("Error creating project:",Ge),a("Error creating project","error")}finally{B(!1)}};if(Z){const ge=[...new Set(T.map(rt=>rt.group))],Ie=T.filter(rt=>rt.selected).length,le=T.reduce((rt,ue)=>rt+(ue.scheduledValue||0),0),Ge=T.filter(rt=>rt.selected).reduce((rt,ue)=>rt+(ue.scheduledValue||0),0);return i.jsxs("div",{children:[i.jsx("h1",{children:"Review Imported Tasks"}),i.jsx("p",{className:"subtitle",children:"Select the tasks to include in your project"}),i.jsxs("div",{className:"import-summary",children:[i.jsxs("span",{children:[Ie," of ",T.length," tasks selected"]}),le>0&&i.jsxs("span",{className:"import-sov-total",children:[" Total SOV: ",new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(Ge)]})]}),ge.map(rt=>{const ue=T.filter(xe=>xe.group===rt),ot=ue.filter(xe=>xe.selected).length;return i.jsxs("div",{className:"card import-group",children:[i.jsxs("div",{className:"import-group-header",children:[i.jsx("h3",{children:rt}),i.jsxs("span",{className:"import-group-count",children:[ot,"/",ue.length]})]}),i.jsx("div",{className:"import-task-list",children:ue.map(xe=>{const ve=T.indexOf(xe);return i.jsxs("label",{className:"import-task-item",children:[i.jsx("input",{type:"checkbox",checked:xe.selected,onChange:()=>z(ve)}),i.jsx("span",{className:"import-task-name",children:xe.name}),xe.scheduledValue>0&&i.jsx("span",{className:"import-task-value",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(xe.scheduledValue)})]},ve)})})]},rt)}),i.jsxs("div",{className:"import-actions",children:[i.jsx("button",{className:"btn btn-secondary",onClick:()=>D(!1),children:"Cancel"}),i.jsxs("button",{className:"btn btn-primary",onClick:ne,children:["Use Selected Tasks (",Ie,")"]})]})]})}const je=O.reduce((ge,Ie,le)=>{const Ge=Ie.group||"General";return ge[Ge]||(ge[Ge]=[]),ge[Ge].push({...Ie,originalIndex:le}),ge},{}),Ne=Object.keys(je).length>1||Object.keys(je).length===1&&!je.General;return i.jsxs("div",{children:[i.jsx("h1",{children:"New Project"}),i.jsx("p",{className:"subtitle",children:"Set up a new project to track"}),i.jsxs("div",{className:"card",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Project Name"}),i.jsx("input",{type:"text",placeholder:"e.g., Sunrise Apartments",value:n,onChange:ge=>s(ge.target.value)})]}),i.jsxs("div",{className:"form-row-2",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Job Number"}),i.jsx("input",{type:"text",placeholder:"e.g., 4032",value:l,onChange:ge=>c(ge.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Contract Value ($)"}),i.jsx("input",{type:"number",placeholder:"e.g., 365000",value:x,onChange:ge=>g(ge.target.value)})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Project Address"}),i.jsx("input",{type:"text",placeholder:"e.g., 123 Main St, Los Angeles, CA 90001",value:d,onChange:ge=>f(ge.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"General Contractor"}),i.jsx("input",{type:"text",placeholder:"e.g., ABC Construction Inc.",value:m,onChange:ge=>v(ge.target.value)})]}),i.jsxs("div",{className:"form-row-2",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Work Type"}),i.jsxs("div",{className:"project-type-toggle",children:[i.jsx("button",{type:"button",className:`toggle-btn ${w==="demolition"?"active":""}`,onClick:()=>E("demolition"),children:"Demolition"}),i.jsx("button",{type:"button",className:`toggle-btn ${w==="abatement"?"active":""}`,onClick:()=>E("abatement"),children:"Abatement"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Job Type"}),i.jsxs("div",{className:"project-type-toggle",children:[i.jsx("button",{type:"button",className:`toggle-btn ${C==="standard"?"active":""}`,onClick:()=>A("standard"),children:"Standard"}),i.jsx("button",{type:"button",className:`toggle-btn ${C==="pla"?"active":""}`,onClick:()=>A("pla"),children:"PLA"})]})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Foreman PIN (4 digits)"}),i.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Foremen will enter this PIN to access this project"}),i.jsxs("div",{className:"pin-input-row",children:[i.jsx("input",{type:"text",placeholder:"e.g., 2847",value:b,onChange:ge=>X(ge.target.value),maxLength:4,className:"pin-input"}),i.jsx("button",{type:"button",className:"btn btn-secondary",onClick:J,children:"Generate"})]})]})]}),i.jsxs("div",{className:"card",children:[i.jsxs("div",{className:"areas-header",children:[i.jsxs("div",{children:[i.jsx("h3",{children:"Areas / Tasks"}),i.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",marginTop:"0.25rem"},children:"Define the areas for this project. Weights must total 100%."})]}),i.jsxs("div",{className:"import-btn-container",children:[i.jsx("input",{ref:V,type:"file",accept:".xlsx,.xls,.csv",onChange:I,style:{display:"none"}}),i.jsx("button",{className:"btn btn-secondary btn-small",onClick:j,disabled:q,children:q?"Reading...":" Import Excel"})]})]}),Ne?Object.entries(je).map(([ge,Ie])=>i.jsxs("div",{className:"area-group",children:[i.jsx("div",{className:"area-group-header",children:ge}),Ie.map(le=>i.jsxs("div",{className:"area-row",children:[i.jsx("input",{type:"text",placeholder:"Task name",value:le.name,onChange:Ge=>K(le.originalIndex,"name",Ge.target.value)}),i.jsx("input",{type:"number",placeholder:"%",min:"0",max:"100",value:le.weight,onChange:Ge=>K(le.originalIndex,"weight",Ge.target.value)}),i.jsx("button",{className:"remove-btn",onClick:()=>fe(le.originalIndex),children:""})]},le.originalIndex))]},ge)):O.map((ge,Ie)=>i.jsxs("div",{className:"area-row",children:[i.jsx("input",{type:"text",placeholder:"Area name (e.g., Level 1)",value:ge.name,onChange:le=>K(Ie,"name",le.target.value)}),i.jsx("input",{type:"number",placeholder:"%",min:"0",max:"100",value:ge.weight,onChange:le=>K(Ie,"weight",le.target.value)}),i.jsx("button",{className:"remove-btn",onClick:()=>fe(Ie),children:""})]},Ie)),i.jsxs("div",{className:"weight-total",children:[i.jsx("span",{className:"weight-total-label",children:"Total Weight:"}),i.jsxs("span",{className:`weight-total-value ${Math.abs(ie-100)<.1?"valid":"invalid"}`,children:[ie.toFixed(1),"%"]})]}),i.jsx("button",{className:"btn btn-secondary",onClick:te,children:"+ Add Area"})]}),i.jsx("button",{className:"btn btn-primary btn-full",onClick:se,disabled:W,children:W?"Creating...":"Create Project"})]})}function v$({company:t,onShowToast:e}){const{branding:r,updateBranding:a,uploadBrandingImage:n,loading:s}=ph(),[l,c]=ee.useState(!1),[d,f]=ee.useState(!1),[m,v]=ee.useState(r),[x,g]=ee.useState(""),[b,_]=ee.useState(!1),w=ee.useRef(null),E=ee.useRef(null),C=ee.useRef(null);ee.useEffect(()=>{t?.id&&A()},[t?.id]);const A=async()=>{try{const{data:V,error:ie}=await De.from("companies").select("office_code").eq("id",t.id).single();!ie&&V?.office_code&&g(V.office_code)}catch(V){console.error("Error loading office code:",V)}},O=async()=>{if(confirm("Regenerate office code? Current code will stop working immediately.")){_(!0);try{const V=Math.random().toString(36).substring(2,8).toUpperCase(),{error:ie}=await De.from("companies").update({office_code:V}).eq("id",t.id);if(ie)throw ie;g(V),e?.("Office code regenerated","success")}catch(V){console.error("Error regenerating code:",V),e?.("Error regenerating code","error")}finally{_(!1)}}},G=()=>{navigator.clipboard.writeText(x),e?.("Office code copied to clipboard","success")},W=t?.subscription_tier||"free",B=["pro","business","enterprise"].includes(W),q=["business","enterprise"].includes(W),L=W==="enterprise",Z=(V,ie)=>{v(X=>({...X,[V]:ie}))},D=async(V,ie)=>{if(V){if(V.size>5*1024*1024){e?.("Image must be smaller than 5MB","error");return}if(!V.type.startsWith("image/")){e?.("Please upload an image file","error");return}try{const X=await n(V,ie);X.success?(Z(`${ie}_url`,X.url),e?.(`${ie.charAt(0).toUpperCase()+ie.slice(1)} uploaded successfully`,"success")):e?.(X.error||"Failed to upload image","error")}catch(X){console.error("Upload error:",X),e?.("Failed to upload image","error")}}},T=async()=>{try{c(!0);const V=/^#[0-9A-F]{6}$/i;if(!V.test(m.primary_color)){e?.("Primary color must be a valid hex color (e.g., #3B82F6)","error");return}if(!V.test(m.secondary_color)){e?.("Secondary color must be a valid hex color (e.g., #1E40AF)","error");return}const ie=await a(m);ie.success?e?.("Branding settings saved successfully!","success"):e?.(ie.error||"Failed to save branding settings","error")}catch(V){console.error("Save error:",V),e?.("Failed to save branding settings","error")}finally{c(!1)}},M=()=>{d?(document.documentElement.style.setProperty("--primary-color",r.primary_color),document.documentElement.style.setProperty("--secondary-color",r.secondary_color),document.title=r.custom_app_name||"FieldSync"):(document.documentElement.style.setProperty("--primary-color",m.primary_color),document.documentElement.style.setProperty("--secondary-color",m.secondary_color),document.title=m.custom_app_name||"FieldSync"),f(!d)};return s?i.jsxs("div",{className:"settings-loading",children:[i.jsx("div",{className:"spinner"}),i.jsx("p",{children:"Loading branding settings..."})]}):i.jsxs("div",{className:"branding-settings",children:[i.jsxs("div",{className:"settings-header",children:[i.jsx("h2",{children:" Branding Settings"}),W==="free"&&i.jsx("div",{className:"tier-badge tier-free",children:"Free Plan - Upgrade for branding options"}),W==="pro"&&i.jsx("div",{className:"tier-badge tier-pro",children:"Pro Plan"}),W==="business"&&i.jsx("div",{className:"tier-badge tier-business",children:"Business Plan"}),W==="enterprise"&&i.jsx("div",{className:"tier-badge tier-enterprise",children:"Enterprise Plan"})]}),i.jsxs("div",{className:"settings-section security-section",children:[i.jsx("h3",{children:"Security"}),i.jsxs("div",{className:"setting-item",children:[i.jsx("label",{children:"Office Code"}),i.jsx("p",{className:"help-text",style:{marginBottom:"0.75rem"},children:"Share this code with office staff only. Required to create new office accounts."}),i.jsxs("div",{className:"office-code-display",children:[i.jsx("code",{className:"office-code-value",children:x||"------"}),i.jsx("button",{className:"btn-secondary btn-small",onClick:G,disabled:!x,children:"Copy"}),i.jsx("button",{className:"btn-secondary btn-small",onClick:O,disabled:b,children:b?"...":"Regenerate"})]}),i.jsx("p",{className:"help-text",style:{marginTop:"0.5rem",color:"var(--accent-amber)"},children:"Field workers should NOT have this code - they use project PINs only."})]}),i.jsxs("div",{className:"setting-item",children:[i.jsx("label",{children:"Company Code"}),i.jsx("p",{className:"help-text",style:{marginBottom:"0.75rem"},children:"Public code for employees to find your company."}),i.jsxs("div",{className:"office-code-display",children:[i.jsx("code",{className:"office-code-value",children:t?.code||"------"}),i.jsx("button",{className:"btn-secondary btn-small",onClick:()=>{navigator.clipboard.writeText(t?.code||""),e?.("Company code copied","success")},disabled:!t?.code,children:"Copy"})]})]})]}),i.jsxs("div",{className:"settings-section",children:[i.jsx("h3",{children:"Visual Identity"}),i.jsxs("div",{className:"setting-item",children:[i.jsx("label",{children:"Logo"}),B?i.jsxs(i.Fragment,{children:[m.logo_url&&i.jsx("div",{className:"logo-preview",children:i.jsx("img",{src:m.logo_url,alt:"Logo preview"})}),i.jsx("input",{ref:w,type:"file",accept:"image/*",style:{display:"none"},onChange:V=>D(V.target.files[0],"logo")}),i.jsx("button",{className:"btn-secondary",onClick:()=>w.current?.click(),children:m.logo_url?"Change Logo":"Upload Logo"}),i.jsx("p",{className:"help-text",children:"Recommended: 200x60px, PNG with transparent background"})]}):i.jsx("div",{className:"upgrade-notice",children:i.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your logo"})})]}),i.jsxs("div",{className:"setting-item",children:[i.jsx("label",{htmlFor:"app-name",children:"App Name"}),B?i.jsxs(i.Fragment,{children:[i.jsx("input",{id:"app-name",type:"text",className:"input",value:m.custom_app_name||"",onChange:V=>Z("custom_app_name",V.target.value),placeholder:"FieldSync",maxLength:50}),i.jsx("p",{className:"help-text",children:"This name appears in the browser tab and throughout the app"})]}):i.jsx("div",{className:"upgrade-notice",children:i.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your app name"})})]}),i.jsxs("div",{className:"setting-item",children:[i.jsx("label",{htmlFor:"primary-color",children:"Primary Color"}),B?i.jsxs("div",{className:"color-input-group",children:[i.jsx("input",{id:"primary-color",type:"color",value:m.primary_color||"#3B82F6",onChange:V=>Z("primary_color",V.target.value),className:"color-picker"}),i.jsx("input",{type:"text",className:"input color-text",value:m.primary_color||"#3B82F6",onChange:V=>Z("primary_color",V.target.value),placeholder:"#3B82F6",pattern:"^#[0-9A-Fa-f]{6}$"})]}):i.jsx("div",{className:"upgrade-notice",children:i.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize colors"})})]}),i.jsxs("div",{className:"setting-item",children:[i.jsx("label",{htmlFor:"secondary-color",children:"Secondary Color"}),B?i.jsxs("div",{className:"color-input-group",children:[i.jsx("input",{id:"secondary-color",type:"color",value:m.secondary_color||"#1E40AF",onChange:V=>Z("secondary_color",V.target.value),className:"color-picker"}),i.jsx("input",{type:"text",className:"input color-text",value:m.secondary_color||"#1E40AF",onChange:V=>Z("secondary_color",V.target.value),placeholder:"#1E40AF",pattern:"^#[0-9A-Fa-f]{6}$"})]}):i.jsx("div",{className:"upgrade-notice",children:i.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize colors"})})]}),i.jsxs("div",{className:"setting-item",children:[i.jsx("label",{children:"Favicon"}),B?i.jsxs(i.Fragment,{children:[m.favicon_url&&i.jsx("div",{className:"favicon-preview",children:i.jsx("img",{src:m.favicon_url,alt:"Favicon preview"})}),i.jsx("input",{ref:E,type:"file",accept:"image/*",style:{display:"none"},onChange:V=>D(V.target.files[0],"favicon")}),i.jsx("button",{className:"btn-secondary",onClick:()=>E.current?.click(),children:m.favicon_url?"Change Favicon":"Upload Favicon"}),i.jsx("p",{className:"help-text",children:"Recommended: 32x32px or 64x64px, PNG or ICO format"})]}):i.jsx("div",{className:"upgrade-notice",children:i.jsx("p",{children:" Upgrade to Pro, Business, or Enterprise to customize your favicon"})})]}),i.jsxs("div",{className:"setting-item",children:[i.jsx("label",{children:"Login Background"}),q?i.jsxs(i.Fragment,{children:[m.login_background_url&&i.jsx("div",{className:"background-preview",children:i.jsx("img",{src:m.login_background_url,alt:"Background preview"})}),i.jsx("input",{ref:C,type:"file",accept:"image/*",style:{display:"none"},onChange:V=>D(V.target.files[0],"login_background")}),i.jsx("button",{className:"btn-secondary",onClick:()=>C.current?.click(),children:m.login_background_url?"Change Background":"Upload Background"}),i.jsx("p",{className:"help-text",children:"Recommended: 1920x1080px, JPG or PNG"})]}):i.jsx("div",{className:"upgrade-notice",children:i.jsx("p",{children:" Upgrade to Business or Enterprise to customize login background"})})]})]}),i.jsxs("div",{className:"settings-section",children:[i.jsx("h3",{children:"White-Label Options"}),i.jsxs("div",{className:"setting-item",children:[i.jsxs("label",{className:"checkbox-label",children:[i.jsx("input",{type:"checkbox",checked:m.hide_fieldsync_branding||!1,onChange:V=>Z("hide_fieldsync_branding",V.target.checked),disabled:!q}),i.jsx("span",{children:'Hide "Powered by FieldSync"'})]}),!q&&i.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]})]}),i.jsxs("div",{className:"settings-section",children:[i.jsx("h3",{children:"Email Branding"}),i.jsxs("div",{className:"setting-item",children:[i.jsx("label",{htmlFor:"email-from-name",children:"From Name"}),i.jsx("input",{id:"email-from-name",type:"text",className:"input",value:m.email_from_name||"",onChange:V=>Z("email_from_name",V.target.value),placeholder:"Your Company Name",disabled:!q}),!q&&i.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]}),i.jsxs("div",{className:"setting-item",children:[i.jsx("label",{htmlFor:"email-from-address",children:"From Email"}),i.jsx("input",{id:"email-from-address",type:"email",className:"input",value:m.email_from_address||"",onChange:V=>Z("email_from_address",V.target.value),placeholder:"noreply@yourcompany.com",disabled:!q}),!q&&i.jsx("p",{className:"help-text",children:" Business or Enterprise plan required"})]})]}),i.jsxs("div",{className:"settings-section",children:[i.jsx("h3",{children:"Custom Domain"}),i.jsxs("div",{className:"setting-item",children:[i.jsx("label",{htmlFor:"custom-domain",children:"Domain"}),L?i.jsxs(i.Fragment,{children:[i.jsx("input",{id:"custom-domain",type:"text",className:"input",value:m.custom_domain||"",onChange:V=>Z("custom_domain",V.target.value),placeholder:"app.yourcompany.com"}),m.custom_domain&&i.jsx("div",{className:`domain-status ${m.domain_verified?"verified":"pending"}`,children:m.domain_verified?i.jsx(i.Fragment,{children:" Connected"}):i.jsx(i.Fragment,{children:" DNS setup required"})}),i.jsx("p",{className:"help-text",children:"Contact support to configure DNS and SSL certificate for your custom domain"})]}):i.jsxs("div",{className:"upgrade-notice",children:[i.jsx("p",{children:" Enterprise plan required for custom domain support"}),i.jsx("p",{className:"help-text",children:"Custom domains allow you to host the app at your own URL (e.g., app.yourcompany.com)"})]})]})]}),i.jsxs("div",{className:"settings-actions",children:[i.jsx("button",{className:"btn-secondary",onClick:M,children:d?"Exit Preview":"Preview Changes"}),i.jsx("button",{className:"btn-primary",onClick:T,disabled:l||!B,children:l?"Saving...":"Save Changes"})]}),d&&i.jsx("div",{className:"preview-banner",children:"Preview Mode Active - Your changes are not yet saved"})]})}const ex=["foreman","operator","laborer"],tx=["demolition","abatement"],rx=["standard","pla"];function x$({company:t,onShowToast:e}){const[r,a]=ee.useState({}),[n,s]=ee.useState(!1),[l,c]=ee.useState(!1),[d,f]=ee.useState("demolition"),[m,v]=ee.useState(!0);ee.useEffect(()=>{t?.id&&g()},[t?.id]);const x=()=>{const A={};return tx.forEach(O=>{A[O]={},rx.forEach(G=>{A[O][G]={},ex.forEach(W=>{A[O][G][W]={regular:"",overtime:""}})})}),A},g=async()=>{if(!qe){a(x()),v(!1);return}const A=x();try{const{data:O,error:G}=await De.from("labor_rates").select("*").eq("company_id",t.id);if(G){a(A),v(!1);return}O&&O.length>0&&O.forEach(W=>{A[W.work_type]&&A[W.work_type][W.job_type]&&A[W.work_type][W.job_type][W.role]&&(A[W.work_type][W.job_type][W.role]={regular:W.regular_rate||"",overtime:W.overtime_rate||""})}),a(A)}catch(O){console.error("Error loading labor rates:",O),a(A)}finally{v(!1)}},b=async()=>{if(!qe){e("Labor rates require database connection","error");return}c(!0);try{await De.from("labor_rates").delete().eq("company_id",t.id);const A=[];tx.forEach(G=>{rx.forEach(W=>{ex.forEach(B=>{const q=r[G]?.[W]?.[B]||{regular:0,overtime:0};A.push({company_id:t.id,role:B,work_type:G,job_type:W,regular_rate:parseFloat(q.regular)||0,overtime_rate:parseFloat(q.overtime)||0})})})});const{error:O}=await De.from("labor_rates").insert(A);if(O)throw O;e("Labor rates saved","success"),s(!1)}catch(A){console.error("Error saving labor rates:",A),e("Error saving rates: "+(A.message||"Unknown error"),"error")}finally{c(!1)}},_=(A,O,G,W,B)=>{a(q=>({...q,[A]:{...q[A],[O]:{...q[A]?.[O],[G]:{...q[A]?.[O]?.[G],[W]:B}}}}))},w=A=>A.charAt(0).toUpperCase()+A.slice(1),E=A=>A.charAt(0).toUpperCase()+A.slice(1),C=A=>A==="pla"?"PLA (Prevailing Wage)":"Standard (Private)";return m?i.jsx("div",{className:"loading",children:"Loading labor rates..."}):i.jsxs("div",{className:"pricing-section",children:[i.jsxs("div",{className:"pricing-section-header",children:[i.jsxs("div",{children:[i.jsx("h2",{children:"Labor Rates"}),i.jsx("p",{className:"section-desc",children:"Configure hourly rates by role, work type, and job classification"})]}),n?i.jsxs("div",{className:"rate-actions",children:[i.jsx("button",{className:"btn btn-secondary",onClick:()=>{s(!1),g()},children:"Cancel"}),i.jsx("button",{className:"btn btn-primary",onClick:b,disabled:l,children:l?"Saving...":"Save All Rates"})]}):i.jsx("button",{className:"btn btn-primary",onClick:()=>s(!0),children:"Edit Rates"})]}),i.jsx("div",{className:"work-type-tabs",children:tx.map(A=>i.jsx("button",{className:`work-type-tab ${d===A?"active":""}`,onClick:()=>f(A),children:E(A)},A))}),i.jsx("div",{className:"labor-rates-container",children:rx.map(A=>i.jsxs("div",{className:"job-type-section",children:[i.jsx("h3",{className:"job-type-header",children:C(A)}),i.jsxs("div",{className:"rates-table",children:[i.jsxs("div",{className:"rates-table-header",children:[i.jsx("div",{className:"rate-cell role-cell",children:"Role"}),i.jsx("div",{className:"rate-cell",children:"Regular"}),i.jsx("div",{className:"rate-cell",children:"Overtime"})]}),ex.map(O=>{const G=r[d]?.[A]?.[O]||{regular:"",overtime:""};return i.jsxs("div",{className:"rates-table-row",children:[i.jsx("div",{className:"rate-cell role-cell",children:w(O)}),i.jsx("div",{className:"rate-cell",children:n?i.jsxs("div",{className:"rate-input-inline",children:[i.jsx("span",{children:"$"}),i.jsx("input",{type:"number",value:G.regular,onChange:W=>_(d,A,O,"regular",W.target.value),placeholder:"0.00",step:"0.01"}),i.jsx("span",{children:"/hr"})]}):i.jsxs("span",{className:"rate-value",children:["$",(parseFloat(G.regular)||0).toFixed(2),"/hr"]})}),i.jsx("div",{className:"rate-cell",children:n?i.jsxs("div",{className:"rate-input-inline",children:[i.jsx("span",{children:"$"}),i.jsx("input",{type:"number",value:G.overtime,onChange:W=>_(d,A,O,"overtime",W.target.value),placeholder:"0.00",step:"0.01"}),i.jsx("span",{children:"/hr"})]}):i.jsxs("span",{className:"rate-value ot",children:["$",(parseFloat(G.overtime)||0).toFixed(2),"/hr"]})})]},O)})]})]},A))})]})}const Pp=["Containment","PPE","Disposal","Equipment"];function y$({company:t,onShowToast:e}){const[r,a]=ee.useState([]),[n,s]=ee.useState(!0),[l,c]=ee.useState("all"),[d,f]=ee.useState(null),[m,v]=ee.useState(!1),[x,g]=ee.useState({name:"",category:"Equipment",unit:"each",cost_per_unit:""}),[b,_]=ee.useState([]),[w,E]=ee.useState(!1);ee.useEffect(()=>{t?.id&&C()},[t?.id]);const C=async()=>{s(!0);try{const D=await nt.getAllMaterialsEquipment(t.id);a(D||[]),A(D||[])}catch(D){console.error("Error loading items:",D),e("Error loading materials","error")}finally{s(!1)}},A=D=>{const T={},M=[];D.filter(ie=>ie.active!==!1).forEach(ie=>{const X=ie.name.toLowerCase().trim();T[X]||(T[X]=[]),T[X].push(ie)}),Object.entries(T).forEach(([ie,X])=>{X.length>1&&M.push({name:ie,items:X})}),_(M)},O=async D=>{try{const T=D.items.filter(ie=>ie.cost_per_unit>0),M=T.length>0?T[0]:D.items[0],V=D.items.filter(ie=>ie.id!==M.id);for(const ie of V)await nt.deleteMaterialEquipment(ie.id);e(`Merged ${D.items.length} items into one`,"success"),C()}catch(T){console.error("Error merging duplicates:",T),e("Error merging duplicates","error")}},G=async()=>{if(confirm(`Merge all ${b.length} duplicate groups?`))try{for(const D of b){const T=D.items.filter(ie=>ie.cost_per_unit>0),M=T.length>0?T[0]:D.items[0],V=D.items.filter(ie=>ie.id!==M.id);for(const ie of V)await nt.deleteMaterialEquipment(ie.id)}e("All duplicates merged!","success"),C(),E(!1)}catch(D){console.error("Error merging all duplicates:",D),e("Error merging duplicates","error")}},W=async()=>{if(!x.name.trim()){e("Enter item name","error");return}try{await nt.createMaterialEquipment({company_id:t.id,name:x.name.trim(),category:x.category,unit:x.unit||"each",cost_per_unit:parseFloat(x.cost_per_unit)||0,active:!0}),e("Item added","success"),g({name:"",category:"Equipment",unit:"each",cost_per_unit:""}),v(!1),C()}catch(D){console.error("Error adding item:",D),e("Error adding item","error")}},B=async D=>{try{await nt.updateMaterialEquipment(D.id,{name:D.name,category:D.category,unit:D.unit,cost_per_unit:parseFloat(D.cost_per_unit)||0}),e("Item updated","success"),f(null),C()}catch(T){console.error("Error updating item:",T),e("Error updating item","error")}},q=async D=>{if(confirm("Delete this item?"))try{await nt.deleteMaterialEquipment(D),e("Item deleted","success"),C()}catch(T){console.error("Error deleting item:",T),e("Error deleting item","error")}},L=l==="all"?r.filter(D=>D.active!==!1):r.filter(D=>D.category===l&&D.active!==!1),Z=L.reduce((D,T)=>{const M=T.category||"Other";return D[M]||(D[M]=[]),D[M].push(T),D},{});return n?i.jsx("div",{className:"loading",children:"Loading materials..."}):i.jsxs("div",{className:"pricing-section",children:[i.jsxs("div",{className:"materials-header",children:[i.jsxs("div",{className:"materials-title",children:[i.jsx("h2",{children:"Materials & Equipment"}),i.jsxs("span",{className:"materials-count",children:[r.filter(D=>D.active!==!1).length," items"]})]}),i.jsxs("div",{className:"materials-actions",children:[b.length>0&&i.jsxs("button",{className:`btn btn-warning ${w?"active":""}`,onClick:()=>E(!w),children:[b.length," Duplicates"]}),i.jsx("button",{className:"btn btn-primary",onClick:()=>v(!0),children:"+ Add Item"})]})]}),w&&b.length>0&&i.jsxs("div",{className:"duplicates-panel",children:[i.jsxs("div",{className:"duplicates-header",children:[i.jsx("h3",{children:"Duplicate Items Found"}),i.jsxs("button",{className:"btn btn-success btn-small",onClick:G,children:["Merge All (",b.length,")"]})]}),i.jsx("div",{className:"duplicates-list",children:b.map((D,T)=>i.jsxs("div",{className:"duplicate-group",children:[i.jsxs("div",{className:"duplicate-name",children:['"',D.name,'" x ',D.items.length]}),i.jsx("div",{className:"duplicate-items",children:D.items.map(M=>i.jsxs("span",{className:"duplicate-item",children:[M.category," - $",M.cost_per_unit||0]},M.id))}),i.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>O(D),children:"Merge"})]},T))})]}),m&&i.jsxs("div",{className:"add-item-form",children:[i.jsx("h3",{children:"Add New Item"}),i.jsxs("div",{className:"form-row",children:[i.jsx("input",{type:"text",placeholder:"Item Name",value:x.name,onChange:D=>g({...x,name:D.target.value}),autoFocus:!0}),i.jsx("select",{value:x.category,onChange:D=>g({...x,category:D.target.value}),children:Pp.map(D=>i.jsx("option",{value:D,children:D},D))})]}),i.jsxs("div",{className:"form-row",children:[i.jsx("input",{type:"text",placeholder:"Unit (e.g., each, day, hour)",value:x.unit,onChange:D=>g({...x,unit:D.target.value})}),i.jsx("input",{type:"number",placeholder:"Cost per unit",value:x.cost_per_unit,onChange:D=>g({...x,cost_per_unit:D.target.value}),step:"0.01"})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{className:"btn btn-secondary",onClick:()=>v(!1),children:"Cancel"}),i.jsx("button",{className:"btn btn-primary",onClick:W,children:"Add Item"})]})]}),i.jsxs("div",{className:"materials-filter",children:[i.jsx("button",{className:`filter-tab ${l==="all"?"active":""}`,onClick:()=>c("all"),children:"All"}),Pp.map(D=>i.jsxs("button",{className:`filter-tab ${l===D?"active":""}`,onClick:()=>c(D),children:[D,i.jsx("span",{className:"filter-count",children:r.filter(T=>T.category===D&&T.active!==!1).length})]},D))]}),i.jsxs("div",{className:"materials-list",children:[l==="all"?Object.entries(Z).map(([D,T])=>i.jsxs("div",{className:"materials-category",children:[i.jsx("h3",{className:"category-header",children:D}),i.jsx("div",{className:"category-items",children:T.map(M=>i.jsx(KS,{item:M,editingItem:d,setEditingItem:f,handleUpdateItem:B,handleDeleteItem:q,categories:Pp},M.id))})]},D)):i.jsxs("div",{className:"materials-category",children:[i.jsx("h3",{className:"category-header",children:l}),i.jsx("div",{className:"category-items",children:L.map(D=>i.jsx(KS,{item:D,editingItem:d,setEditingItem:f,handleUpdateItem:B,handleDeleteItem:q,categories:Pp},D.id))})]}),L.length===0&&i.jsx("div",{className:"empty-state",children:i.jsx("p",{children:"No items in this category"})})]})]})}function KS({item:t,editingItem:e,setEditingItem:r,handleUpdateItem:a,handleDeleteItem:n,categories:s}){return e?.id===t.id?i.jsx("div",{className:"material-item",children:i.jsxs("div",{className:"item-edit-form",children:[i.jsx("input",{type:"text",value:e.name,onChange:l=>r({...e,name:l.target.value})}),i.jsx("select",{value:e.category,onChange:l=>r({...e,category:l.target.value}),children:s.map(l=>i.jsx("option",{value:l,children:l},l))}),i.jsx("input",{type:"text",value:e.unit,onChange:l=>r({...e,unit:l.target.value}),placeholder:"Unit"}),i.jsx("input",{type:"number",value:e.cost_per_unit,onChange:l=>r({...e,cost_per_unit:l.target.value}),placeholder:"Cost",step:"0.01"}),i.jsxs("div",{className:"edit-actions",children:[i.jsx("button",{className:"btn btn-success btn-small",onClick:()=>a(e),children:"Save"}),i.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>r(null),children:"Cancel"})]})]})}):i.jsxs("div",{className:"material-item",children:[i.jsxs("div",{className:"item-info",children:[i.jsx("span",{className:"item-name",children:t.name}),i.jsx("span",{className:"item-unit",children:t.unit||"each"})]}),i.jsxs("div",{className:"item-cost",children:["$",(t.cost_per_unit||0).toFixed(2)]}),i.jsxs("div",{className:"item-actions",children:[i.jsx("button",{className:"btn-icon",onClick:()=>r({...t}),title:"Edit",children:i.jsx(rN,{size:16})}),i.jsx("button",{className:"btn-icon danger",onClick:()=>n(t.id),title:"Delete",children:i.jsx(uc,{size:16})})]})]})}const _$=[{id:"trash",label:"Trash",description:"General debris"},{id:"metal",label:"Metal",description:"Scrap metal (recyclable)"},{id:"copper",label:"Copper",description:"Copper scrap (recyclable)"},{id:"concrete",label:"Concrete",description:"Concrete/masonry"},{id:"hazardous",label:"Hazardous",description:"Hazardous materials"}];function b$({company:t,onShowToast:e}){const[r,a]=ee.useState([]),[n,s]=ee.useState(!0),[l,c]=ee.useState(!1),[d,f]=ee.useState(null),[m,v]=ee.useState({name:"",address:"",notes:""}),[x,g]=ee.useState(!1),[b,_]=ee.useState({}),w=ee.useRef({});ee.useEffect(()=>{t?.id&&E()},[t?.id]),ee.useEffect(()=>()=>{Object.values(w.current).forEach(L=>clearTimeout(L))},[]);const E=async()=>{s(!0);try{const L=await nt.getDumpSites(t.id);a(L||[])}catch(L){console.error("Error loading dump sites:",L),e("Error loading dump sites","error")}finally{s(!1)}},C=async()=>{if(!m.name.trim()){e("Please enter a site name","error");return}g(!0);try{await nt.createDumpSite(t.id,m.name,m.address,m.notes),e("Dump site added","success"),v({name:"",address:"",notes:""}),c(!1),E()}catch(L){console.error("Error adding dump site:",L),e("Error adding dump site","error")}finally{g(!1)}},A=async()=>{if(!d?.name.trim()){e("Please enter a site name","error");return}g(!0);try{await nt.updateDumpSite(d.id,{name:d.name,address:d.address,notes:d.notes}),e("Dump site updated","success"),f(null),E()}catch(L){console.error("Error updating dump site:",L),e("Error updating dump site","error")}finally{g(!1)}},O=async L=>{if(confirm("Are you sure you want to delete this dump site?"))try{await nt.deleteDumpSite(L),e("Dump site deleted","success"),E()}catch(Z){console.error("Error deleting dump site:",Z),e("Error deleting dump site","error")}},G=ee.useCallback(async(L,Z,D)=>{try{await nt.setDumpSiteRate(L,Z,D),a(T=>T.map(M=>{if(M.id===L){const V=[...M.dump_site_rates||[]],ie=V.findIndex(X=>X.waste_type===Z);return ie>=0?V[ie]={...V[ie],estimated_cost_per_load:D}:V.push({waste_type:Z,estimated_cost_per_load:D}),{...M,dump_site_rates:V}}return M})),_(T=>{const M={...T};return delete M[`${L}-${Z}`],M})}catch(T){console.error("Error saving rate:",T?.message||T),e("Error saving rate","error")}},[e]),W=(L,Z,D)=>{const T=`${L}-${Z}`;_(M=>({...M,[T]:D})),w.current[T]&&clearTimeout(w.current[T]),w.current[T]=setTimeout(()=>{const M=parseFloat(D)||0;G(L,Z,M)},500)},B=(L,Z)=>{const D=`${L.id}-${Z}`;return b[D]!==void 0?b[D]:L.dump_site_rates?.find(M=>M.waste_type===Z)?.estimated_cost_per_load??""},q=L=>{if(L===""||L===null||L===void 0)return"";const Z=parseFloat(L);return Z<0?`-$${Math.abs(Z).toFixed(0)}`:`$${Z.toFixed(0)}`};return n?i.jsx("div",{className:"loading",children:"Loading dump sites..."}):i.jsxs("div",{className:"pricing-section",children:[i.jsxs("div",{className:"dump-site-header",children:[i.jsxs("div",{children:[i.jsx("h2",{children:"Disposal & Haul-Off"}),i.jsx("p",{className:"section-desc",children:"Configure dump sites and estimated costs per load for each waste type. Use negative values for recyclables (metal, copper) to indicate revenue."})]}),i.jsx("button",{className:"btn btn-primary",onClick:()=>c(!0),children:"+ Add Dump Site"})]}),l&&i.jsxs("div",{className:"dump-site-form card",children:[i.jsx("h4",{children:"Add Dump Site"}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Site Name *"}),i.jsx("input",{type:"text",value:m.name,onChange:L=>v({...m,name:L.target.value}),placeholder:"e.g., Metro Landfill"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Address"}),i.jsx("input",{type:"text",value:m.address,onChange:L=>v({...m,address:L.target.value}),placeholder:"123 Main St, City"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Notes"}),i.jsx("input",{type:"text",value:m.notes,onChange:L=>v({...m,notes:L.target.value}),placeholder:"Operating hours, contact, etc."})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{className:"btn btn-secondary",onClick:()=>c(!1),children:"Cancel"}),i.jsx("button",{className:"btn btn-primary",onClick:C,disabled:x,children:x?"Adding...":"Add Site"})]})]}),r.length===0?i.jsxs("div",{className:"dump-site-empty",children:[i.jsx("p",{children:"No dump sites configured yet."}),i.jsx("p",{children:"Add a dump site to start tracking haul-off costs."})]}):i.jsx("div",{className:"dump-sites-list",children:r.map(L=>i.jsxs("div",{className:"dump-site-card card",children:[d?.id===L.id?i.jsxs("div",{className:"dump-site-edit",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Site Name *"}),i.jsx("input",{type:"text",value:d.name,onChange:Z=>f({...d,name:Z.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Address"}),i.jsx("input",{type:"text",value:d.address||"",onChange:Z=>f({...d,address:Z.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"Notes"}),i.jsx("input",{type:"text",value:d.notes||"",onChange:Z=>f({...d,notes:Z.target.value})})]}),i.jsxs("div",{className:"form-actions",children:[i.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>f(null),children:"Cancel"}),i.jsx("button",{className:"btn btn-primary btn-sm",onClick:A,disabled:x,children:x?"Saving...":"Save"})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"dump-site-info",children:[i.jsx("div",{className:"dump-site-name",children:L.name}),L.address&&i.jsx("div",{className:"dump-site-address",children:L.address}),L.notes&&i.jsx("div",{className:"dump-site-notes",children:L.notes})]}),i.jsxs("div",{className:"dump-site-actions",children:[i.jsx("button",{className:"btn-icon",onClick:()=>f({...L}),title:"Edit",children:i.jsx(rN,{size:16})}),i.jsx("button",{className:"btn-icon",onClick:()=>O(L.id),title:"Delete",children:i.jsx(uc,{size:16})})]})]}),i.jsxs("div",{className:"dump-site-rates",children:[i.jsx("div",{className:"rates-header",children:"Estimated Cost per Load"}),i.jsx("div",{className:"rates-grid",children:_$.map(Z=>i.jsxs("div",{className:"rate-item",children:[i.jsxs("label",{children:[i.jsx("span",{className:"rate-label",children:Z.label}),i.jsx("span",{className:"rate-desc",children:Z.description})]}),i.jsxs("div",{className:"rate-input-wrapper",children:[i.jsx("span",{className:"rate-prefix",children:"$"}),i.jsx("input",{type:"number",className:"rate-input",value:B(L,Z.id),onChange:D=>W(L.id,Z.id,D.target.value),placeholder:"0"})]}),B(L,Z.id)!==""&&i.jsxs("span",{className:`rate-preview ${parseFloat(B(L,Z.id))<0?"revenue":"cost"}`,children:[q(B(L,Z.id)),"/load"]})]},Z.id))}),i.jsx("div",{className:"rates-note",children:"Tip: Use negative values for recyclables that generate revenue (e.g., -50 for metal)"})]})]},L.id))})]})}const w$=[{id:"labor",label:"Labor Rates",Icon:bs},{id:"materials",label:"Materials & Equipment",Icon:Q0},{id:"disposal",label:"Disposal & Haul-Off",Icon:vh}];function S$({company:t,onShowToast:e}){const[r,a]=ee.useState("labor");return i.jsxs("div",{className:"pricing-manager",children:[i.jsxs("div",{className:"pricing-header",children:[i.jsx("h1",{children:"Pricing Configuration"}),i.jsx("p",{className:"pricing-subtitle",children:"Set up labor rates, materials pricing, and disposal costs"})]}),i.jsx("div",{className:"pricing-tabs",children:w$.map(n=>i.jsxs("button",{className:`pricing-tab ${r===n.id?"active":""}`,onClick:()=>a(n.id),children:[i.jsx(n.Icon,{size:18,className:"pricing-tab-icon"}),i.jsx("span",{className:"pricing-tab-label",children:n.label})]},n.id))}),i.jsxs("div",{className:"pricing-content",children:[r==="labor"&&i.jsx(x$,{company:t,onShowToast:e}),r==="materials"&&i.jsx(y$,{company:t,onShowToast:e}),r==="disposal"&&i.jsx(b$,{company:t,onShowToast:e})]})]})}function N$({shareToken:t}){const[e,r]=ee.useState(!0),[a,n]=ee.useState(null),[s,l]=ee.useState(null),[c,d]=ee.useState(0),{branding:f}=ph();ee.useEffect(()=>{m()},[t]);const m=async()=>{r(!0),n(null);try{const O=await nt.getPublicProjectData(t);if(!O){n("This share link is invalid or has expired.");return}l(O)}catch(O){console.error("Error loading public data:",O),n("Failed to load project data.")}finally{r(!1)}},v=O=>O?new Date(O).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",x=O=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(O);if(e)return i.jsxs("div",{className:"public-view",children:[i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"spinner"}),i.jsx("p",{children:"Loading project..."})]}),i.jsx("style",{children:ax})]});if(a)return i.jsxs("div",{className:"public-view",children:[i.jsxs("div",{className:"error-container",children:[i.jsx("div",{className:"error-icon",children:i.jsx(x1,{size:48})}),i.jsx("h2",{children:a}),i.jsx("p",{children:"Please contact the project owner for a valid link."})]}),i.jsx("style",{children:ax})]});const{share:g,project:b,progress:_,areas:w,photos:E,dailyReports:C,tmTickets:A}=s;return i.jsxs("div",{className:"public-view",children:[i.jsx("header",{className:"public-header",children:i.jsxs("div",{className:"container",children:[i.jsx(kl,{size:"large"}),i.jsx("div",{className:"header-meta",children:i.jsxs("span",{className:"last-updated",children:["Last updated: ",v(b.updated_at||b.created_at)]})})]})}),i.jsx("main",{className:"public-main",children:i.jsxs("div",{className:"container",children:[i.jsxs("div",{className:"project-header",children:[i.jsx("h1",{children:b.name}),b.address&&i.jsx("p",{className:"project-address",children:b.address})]}),g.permissions.progress&&i.jsxs("div",{className:"public-card progress-card",children:[i.jsx("h2",{children:"Project Progress"}),i.jsxs("div",{className:"progress-visual",children:[i.jsxs("div",{className:"progress-circle",children:[i.jsxs("svg",{viewBox:"0 0 100 100",children:[i.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),i.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"var(--primary-color, #3b82f6)",strokeWidth:"8",strokeDasharray:`${_*2.827} 282.7`,strokeLinecap:"round",transform:"rotate(-90 50 50)"})]}),i.jsxs("div",{className:"progress-percentage",children:[_,"%"]})]}),i.jsxs("div",{className:"progress-details",children:[i.jsx("div",{className:"progress-label",children:"Complete"}),w&&w.length>0&&i.jsxs("div",{className:"areas-summary",children:[w.filter(O=>O.status==="done").length," of ",w.length," areas completed"]})]})]}),w&&w.length>0&&i.jsxs("div",{className:"areas-list",children:[i.jsx("h3",{children:"Work Areas"}),w.map(O=>i.jsxs("div",{className:"area-item",children:[i.jsxs("div",{className:"area-info",children:[i.jsx("span",{className:"area-name",children:O.name}),i.jsxs("span",{className:"area-weight",children:[O.weight,"%"]})]}),i.jsx("div",{className:`area-status status-${O.status}`,children:O.status==="done"?" Complete":O.status==="working"?" In Progress":" Not Started"})]},O.id))]})]}),g.permissions.photos&&E&&E.length>0&&i.jsxs("div",{className:"public-card photos-card",children:[i.jsx("h2",{children:"Recent Photos"}),i.jsxs("div",{className:"photos-carousel",children:[i.jsxs("div",{className:"carousel-main",children:[E[c]&&i.jsx("img",{src:E[c].url,alt:`Project photo from ${v(E[c].date)}`,className:"carousel-image"}),i.jsx("div",{className:"carousel-date",children:v(E[c]?.date)})]}),i.jsx("div",{className:"carousel-thumbnails",children:E.slice(0,10).map((O,G)=>i.jsx("div",{className:`thumbnail ${G===c?"active":""}`,onClick:()=>d(G),children:i.jsx("img",{src:O.url,alt:`Thumbnail ${G+1}`})},G))}),E.length>1&&i.jsxs("div",{className:"carousel-controls",children:[i.jsx("button",{onClick:()=>d(O=>O>0?O-1:E.length-1),className:"carousel-btn",children:""}),i.jsxs("span",{className:"carousel-counter",children:[c+1," / ",E.length]}),i.jsx("button",{onClick:()=>d(O=>O<E.length-1?O+1:0),className:"carousel-btn",children:""})]})]})]}),g.permissions.daily_reports&&C&&C.length>0&&i.jsxs("div",{className:"public-card reports-card",children:[i.jsx("h2",{children:"Daily Reports"}),i.jsx("div",{className:"reports-list",children:C.map((O,G)=>i.jsxs("div",{className:"report-item",children:[i.jsx("div",{className:"report-date",children:v(O.report_date)}),i.jsxs("div",{className:"report-content",children:[O.crew_count&&i.jsxs("div",{className:"report-field",children:[i.jsx("strong",{children:"Crew:"})," ",O.crew_count," workers"]}),O.tasks_completed&&i.jsxs("div",{className:"report-field",children:[i.jsx("strong",{children:"Tasks Completed:"})," ",O.tasks_completed]}),O.weather&&i.jsxs("div",{className:"report-field",children:[i.jsx("strong",{children:"Weather:"})," ",O.weather]}),O.notes&&i.jsxs("div",{className:"report-field",children:[i.jsx("strong",{children:"Notes:"})," ",O.notes]})]})]},G))})]}),g.permissions.tm_tickets&&A&&A.length>0&&i.jsxs("div",{className:"public-card tm-card",children:[i.jsx("h2",{children:"Time & Materials Tickets"}),i.jsx("div",{className:"tm-list",children:A.map((O,G)=>i.jsxs("div",{className:"tm-item",children:[i.jsxs("div",{className:"tm-header",children:[i.jsx("span",{className:"tm-date",children:v(O.work_date)}),i.jsx("span",{className:`tm-status status-${O.status}`,children:O.status})]}),O.description&&i.jsx("div",{className:"tm-description",children:O.description}),O.total_amount&&i.jsxs("div",{className:"tm-amount",children:["Total: ",x(O.total_amount)]})]},G))})]})]})}),i.jsx("footer",{className:"public-footer",children:i.jsx("div",{className:"container",children:!f?.hide_fieldsync_branding&&i.jsx("p",{children:"Powered by FieldSync"})})}),i.jsx("style",{children:ax})]})}const ax=`
  .public-view {
    min-height: 100vh;
    background-color: #f9fafb;
    display: flex;
    flex-direction: column;
  }

  .container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 1rem;
    width: 100%;
  }

  /* Header */
  .public-header {
    background-color: white;
    border-bottom: 1px solid #e5e7eb;
    padding: 1.5rem 0;
  }

  .public-header .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .header-meta {
    font-size: 0.875rem;
    color: #6b7280;
  }

  /* Main Content */
  .public-main {
    flex: 1;
    padding: 2rem 0;
  }

  .project-header {
    margin-bottom: 2rem;
  }

  .project-header h1 {
    font-size: 2rem;
    margin: 0 0 0.5rem 0;
    color: #111827;
  }

  .project-address {
    font-size: 1rem;
    color: #6b7280;
    margin: 0;
  }

  /* Cards */
  .public-card {
    background-color: white;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .public-card h2 {
    font-size: 1.5rem;
    margin: 0 0 1.5rem 0;
    color: #111827;
  }

  .public-card h3 {
    font-size: 1.125rem;
    margin: 1.5rem 0 1rem 0;
    color: #374151;
  }

  /* Progress Card */
  .progress-visual {
    display: flex;
    align-items: center;
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .progress-circle {
    position: relative;
    width: 150px;
    height: 150px;
    flex-shrink: 0;
  }

  .progress-circle svg {
    width: 100%;
    height: 100%;
  }

  .progress-percentage {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2rem;
    font-weight: bold;
    color: var(--primary-color, #3b82f6);
  }

  .progress-details {
    flex: 1;
  }

  .progress-label {
    font-size: 1.25rem;
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.5rem;
  }

  .areas-summary {
    font-size: 1rem;
    color: #6b7280;
  }

  /* Areas List */
  .areas-list {
    border-top: 1px solid #e5e7eb;
    padding-top: 1rem;
  }

  .area-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 0;
    border-bottom: 1px solid #f3f4f6;
  }

  .area-item:last-child {
    border-bottom: none;
  }

  .area-info {
    flex: 1;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-right: 1rem;
  }

  .area-name {
    font-weight: 500;
    color: #374151;
  }

  .area-weight {
    color: #6b7280;
    font-size: 0.875rem;
  }

  .area-status {
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    white-space: nowrap;
  }

  .area-status.status-done {
    background-color: #d1fae5;
    color: #065f46;
  }

  .area-status.status-working {
    background-color: #fef3c7;
    color: #92400e;
  }

  .area-status.status-not_started {
    background-color: #f3f4f6;
    color: #6b7280;
  }

  /* Photos Carousel */
  .photos-carousel {
    position: relative;
  }

  .carousel-main {
    position: relative;
    width: 100%;
    height: 400px;
    background-color: #111827;
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 1rem;
  }

  .carousel-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }

  .carousel-date {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
    color: white;
    padding: 1rem;
    text-align: center;
  }

  .carousel-thumbnails {
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
  }

  .thumbnail {
    flex-shrink: 0;
    width: 80px;
    height: 80px;
    border-radius: 4px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: border-color 0.2s;
  }

  .thumbnail:hover {
    border-color: #d1d5db;
  }

  .thumbnail.active {
    border-color: var(--primary-color, #3b82f6);
  }

  .thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .carousel-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
  }

  .carousel-btn {
    background-color: white;
    border: 1px solid #d1d5db;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.25rem;
    transition: background-color 0.2s;
  }

  .carousel-btn:hover {
    background-color: #f3f4f6;
  }

  .carousel-counter {
    font-size: 0.875rem;
    color: #6b7280;
  }

  /* Daily Reports */
  .reports-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .report-item {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1rem;
  }

  .report-date {
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.75rem;
    font-size: 1.125rem;
  }

  .report-content {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .report-field {
    color: #374151;
    line-height: 1.5;
  }

  .report-field strong {
    color: #111827;
  }

  /* T&M Tickets */
  .tm-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .tm-item {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1rem;
  }

  .tm-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
  }

  .tm-date {
    font-weight: 600;
    color: #111827;
  }

  .tm-status {
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    text-transform: capitalize;
  }

  .tm-status.status-approved {
    background-color: #d1fae5;
    color: #065f46;
  }

  .tm-status.status-pending {
    background-color: #fef3c7;
    color: #92400e;
  }

  .tm-status.status-rejected {
    background-color: #fee2e2;
    color: #991b1b;
  }

  .tm-description {
    color: #374151;
    margin-bottom: 0.5rem;
  }

  .tm-amount {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--primary-color, #3b82f6);
  }

  /* Footer */
  .public-footer {
    background-color: white;
    border-top: 1px solid #e5e7eb;
    padding: 2rem 0;
    margin-top: auto;
  }

  .public-footer p {
    text-align: center;
    color: #6b7280;
    margin: 0;
    font-size: 0.875rem;
  }

  /* Loading & Error States */
  .loading-container,
  .error-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 2rem;
  }

  .spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #e5e7eb;
    border-top-color: var(--primary-color, #3b82f6);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .loading-container p {
    margin-top: 1rem;
    color: #6b7280;
  }

  .error-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
  }

  .error-container h2 {
    color: #111827;
    margin: 0 0 0.5rem 0;
  }

  .error-container p {
    color: #6b7280;
    margin: 0;
  }

  /* Mobile Responsive */
  @media (max-width: 768px) {
    .project-header h1 {
      font-size: 1.5rem;
    }

    .public-card {
      padding: 1.5rem;
    }

    .progress-visual {
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .progress-circle {
      width: 120px;
      height: 120px;
    }

    .progress-percentage {
      font-size: 1.5rem;
    }

    .carousel-main {
      height: 300px;
    }

    .area-item {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }

    .area-info {
      width: 100%;
      margin-right: 0;
    }
  }
`;function j$({onSave:t,onClose:e,slot:r=1,documentType:a="cor",documentTitle:n="",signerName:s="",signerTitle:l="",signerCompany:c=""}){const d=ee.useRef(null),[f,m]=ee.useState(s),[v,x]=ee.useState(l),[g,b]=ee.useState(c),[_,w]=ee.useState(!1),[E,C]=ee.useState(!1),[A,O]=ee.useState(!1),G=r===1?"GC Authorization":"Client Authorization",W=a==="cor"?"Change Order Request":"T&M Work Order",B=()=>{const X=d.current;return X?X.getContext("2d"):null},q=X=>{const J=d.current;if(!J)return{x:0,y:0};const K=J.getBoundingClientRect(),te=J.width/K.width,fe=J.height/K.height,U=X.touches?X.touches[0].clientX:X.clientX,j=X.touches?X.touches[0].clientY:X.clientY;return{x:(U-K.left)*te,y:(j-K.top)*fe}},L=X=>{X.preventDefault();const J=B();if(!J)return;const{x:K,y:te}=q(X);J.beginPath(),J.moveTo(K,te),C(!0),w(!0)},Z=X=>{if(!E)return;X.preventDefault();const J=B();if(!J)return;const{x:K,y:te}=q(X);J.lineTo(K,te),J.stroke()},D=()=>{C(!1)},T=()=>{const X=d.current,J=B();!X||!J||(J.clearRect(0,0,X.width,X.height),w(!1))},M=X=>{if(!X)return;d.current=X;const J=X.getContext("2d");J.strokeStyle="#1e293b",J.lineWidth=2,J.lineCap="round",J.lineJoin="round"},V=_&&f.trim()&&A,ie=()=>{if(!V)return;const X=d.current;if(!X)return;const J=X.toDataURL("image/png");t({signature:J,signerName:f.trim(),signerTitle:v.trim()||null,signerCompany:g.trim()||null,signedAt:new Date().toISOString()})};return i.jsx("div",{className:"modal-overlay",onClick:e,role:"dialog","aria-modal":"true","aria-labelledby":"signature-title",children:i.jsxs("div",{className:"modal-content signature-modal enhanced",onClick:X=>X.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsxs("div",{className:"signature-header-info",children:[i.jsx("h2",{id:"signature-title",children:G}),n&&i.jsx("span",{className:"signature-doc-ref",children:n})]}),i.jsx("button",{className:"close-btn",onClick:e,"aria-label":"Close signature modal",children:i.jsx(Rd,{size:20,"aria-hidden":"true"})})]}),i.jsxs("div",{className:"modal-body signature-body",children:[i.jsxs("div",{className:"signature-slot-badge",children:[i.jsx(sN,{size:14}),i.jsxs("span",{children:["Signature ",r," of 2"]})]}),i.jsxs("div",{className:"signature-fields",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"signer-name",children:"Print Name *"}),i.jsx("input",{id:"signer-name",type:"text",value:f,onChange:X=>m(X.target.value),placeholder:"Enter your full legal name","aria-required":"true"})]}),i.jsxs("div",{className:"signature-fields-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"signer-title",children:"Title"}),i.jsx("input",{id:"signer-title",type:"text",value:v,onChange:X=>x(X.target.value),placeholder:"e.g., Project Manager"})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"signer-company",children:"Company"}),i.jsx("input",{id:"signer-company",type:"text",value:g,onChange:X=>b(X.target.value),placeholder:"e.g., ABC Construction"})]})]})]}),i.jsxs("div",{className:"signature-area",children:[i.jsxs("div",{className:"signature-label",id:"signature-instructions",children:[i.jsx(tN,{size:16,"aria-hidden":"true"}),i.jsx("span",{children:"Draw your signature below"})]}),i.jsxs("div",{className:"signature-canvas-container",children:[i.jsx("canvas",{ref:M,width:500,height:180,className:"signature-canvas",onMouseDown:L,onMouseMove:Z,onMouseUp:D,onMouseLeave:D,onTouchStart:L,onTouchMove:Z,onTouchEnd:D,role:"img","aria-label":"Signature drawing area. Use mouse or touch to draw your signature.","aria-describedby":"signature-instructions",tabIndex:0}),!_&&i.jsx("div",{className:"signature-placeholder",children:"Sign here"})]}),i.jsxs("button",{className:"btn btn-ghost btn-small",onClick:T,disabled:!_,"aria-label":"Clear signature",children:[i.jsx(aN,{size:14,"aria-hidden":"true"})," Clear"]})]}),i.jsx("div",{className:"signature-acknowledgment",children:i.jsxs("label",{className:"checkbox-label",children:[i.jsx("input",{type:"checkbox",checked:A,onChange:X=>O(X.target.checked)}),i.jsxs("span",{children:["I acknowledge that this electronic signature is legally binding and that I have reviewed and approve this ",W,". I understand that my signature, name, and IP address will be recorded for verification purposes."]})]})})]}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{className:"btn btn-secondary",onClick:e,"aria-label":"Cancel and close",children:"Cancel"}),i.jsxs("button",{className:"btn btn-primary",onClick:ie,disabled:!V,"aria-label":"Submit signature",children:[i.jsx(F0,{size:16,"aria-hidden":"true"})," Submit Signature"]})]})]})})}const nx=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(t||0),c0=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"";function k$({signatureToken:t}){const[e,r]=ee.useState(!0),[a,n]=ee.useState(null),[s,l]=ee.useState(null),[c,d]=ee.useState(null),[f,m]=ee.useState(!1),[v,x]=ee.useState(null),[g,b]=ee.useState(!1),[_,w]=ee.useState(!1),[E,C]=ee.useState(null);ee.useEffect(()=>{A()},[t]);const A=async()=>{try{r(!0),n(null);const J=await nt.getSignatureRequestByToken(t);if(!J){n("This signature link is invalid or has expired.");return}if(J.status==="completed"){n("This document has already been fully signed.");return}if(J.status==="revoked"){n("This signature link has been revoked.");return}if(J.status==="expired"){n("This signature link has expired.");return}l(J);const K=await nt.getDocumentForSigning(J.document_type,J.document_id);if(!K){n("The document associated with this link could not be found.");return}d(K)}catch(J){console.error("Error loading signature data:",J),n("Unable to load signature request. Please try again.")}finally{r(!1)}},O=()=>{if(!s)return{slot1:null,slot2:null,availableSlots:[]};const J=s.signatures||[],K=J.find(U=>U.signature_slot===1),te=J.find(U=>U.signature_slot===2),fe=[];return K||fe.push(1),te||fe.push(2),{slot1:K,slot2:te,availableSlots:fe}},G=async()=>{try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch{return null}},W=async J=>{if(!(!s||!v))try{b(!0);const K=await G(),te=await nt.addSignature(s.id,v,{...J,ipAddress:K,userAgent:navigator.userAgent});await nt.syncSignatureToDocument(te,s),await A(),m(!1),x(null),C(`Signature ${v} has been recorded successfully.`),setTimeout(()=>C(null),5e3)}catch(K){console.error("Error submitting signature:",K),n("Failed to submit signature. Please try again.")}finally{b(!1)}},B=J=>{x(J),m(!0)};if(e)return i.jsx("div",{className:"signature-page",children:i.jsxs("div",{className:"signature-page-loading",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"Loading document..."})]})});if(a)return i.jsx("div",{className:"signature-page",children:i.jsxs("div",{className:"signature-page-error",children:[i.jsx(gh,{size:48}),i.jsx("h2",{children:"Unable to Load Document"}),i.jsx("p",{children:a})]})});const{slot1:q,slot2:L,availableSlots:Z}=O(),D=Z.length===0,T=s?.document_type==="cor",M=c?.projects?.companies,V=c?.projects,X=(()=>{if(T)return{title:`COR ${c.cor_number}`,subtitle:c.title||"Change Order Request",amount:c.cor_total,period:c.period_start&&c.period_end?`${c0(c.period_start)} - ${c0(c.period_end)}`:null,status:c.status};{const J=c.t_and_m_workers?.length||0,K=c.t_and_m_workers?.reduce((te,fe)=>te+(fe.hours||0),0)||0;return{title:"T&M Ticket",subtitle:c.ce_pco_number?`CE/PCO: ${c.ce_pco_number}`:"Time & Materials",amount:c.change_order_value,period:c0(c.work_date),status:c.status,workers:J,hours:K}}})();return i.jsxs("div",{className:"signature-page",children:[i.jsxs("header",{className:"signature-page-header",children:[M?.logo_url?i.jsx("img",{src:M.logo_url,alt:M.name,className:"company-logo"}):i.jsx("div",{className:"company-logo-placeholder",children:i.jsx(n2,{size:24})}),i.jsxs("div",{className:"company-info",children:[i.jsx("h1",{children:M?.name||"FieldSync"}),i.jsx("span",{className:"doc-type-label",children:"Document Signature"})]})]}),E&&i.jsxs("div",{className:"signature-success-banner",children:[i.jsx(pd,{size:18}),E]}),i.jsxs("main",{className:"signature-page-content",children:[i.jsxs("div",{className:"signature-document-card",children:[i.jsxs("div",{className:"document-card-header",children:[i.jsx(ho,{size:20}),i.jsxs("div",{className:"document-card-title",children:[i.jsx("h2",{children:X.title}),i.jsx("span",{className:"document-subtitle",children:X.subtitle})]})]}),i.jsxs("div",{className:"document-card-details",children:[i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"detail-label",children:"Project"}),i.jsx("span",{className:"detail-value",children:V?.name})]}),V?.job_number&&i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"detail-label",children:"Job #"}),i.jsx("span",{className:"detail-value",children:V.job_number})]}),X.amount>0&&i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"detail-label",children:"Amount"}),i.jsx("span",{className:"detail-value amount",children:nx(X.amount)})]}),X.period&&i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"detail-label",children:T?"Period":"Work Date"}),i.jsx("span",{className:"detail-value",children:X.period})]}),!T&&X.workers>0&&i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"detail-label",children:"Workers"}),i.jsxs("span",{className:"detail-value",children:[X.workers," (",X.hours," hrs)"]})]})]}),i.jsxs("button",{className:"expand-details-btn",onClick:()=>w(!_),children:[_?i.jsx(s2,{size:16}):i.jsx(_c,{size:16}),_?"Hide Details":"View Full Details"]}),_&&i.jsx("div",{className:"document-full-details",children:T?i.jsxs(i.Fragment,{children:[c.description&&i.jsxs("div",{className:"detail-section",children:[i.jsx("h4",{children:"Description"}),i.jsx("p",{children:c.description})]}),c.change_order_labor?.length>0&&i.jsxs("div",{className:"detail-section",children:[i.jsxs("h4",{children:["Labor (",c.change_order_labor.length," items)"]}),i.jsxs("ul",{children:[c.change_order_labor.slice(0,5).map((J,K)=>i.jsxs("li",{children:[J.description,": ",J.hours,"hrs @ ",nx(J.rate),"/hr"]},K)),c.change_order_labor.length>5&&i.jsxs("li",{className:"more-items",children:["+",c.change_order_labor.length-5," more items"]})]})]}),c.change_order_materials?.length>0&&i.jsxs("div",{className:"detail-section",children:[i.jsxs("h4",{children:["Materials (",c.change_order_materials.length," items)"]}),i.jsxs("ul",{children:[c.change_order_materials.slice(0,5).map((J,K)=>i.jsxs("li",{children:[J.description,": ",J.quantity," @ ",nx(J.unit_cost)]},K)),c.change_order_materials.length>5&&i.jsxs("li",{className:"more-items",children:["+",c.change_order_materials.length-5," more items"]})]})]})]}):i.jsxs(i.Fragment,{children:[c.notes&&i.jsxs("div",{className:"detail-section",children:[i.jsx("h4",{children:"Work Description"}),i.jsx("p",{children:c.notes})]}),c.t_and_m_workers?.length>0&&i.jsxs("div",{className:"detail-section",children:[i.jsx("h4",{children:"Workers"}),i.jsx("ul",{children:c.t_and_m_workers.map((J,K)=>i.jsxs("li",{children:[J.name,": ",J.hours,"hrs ",J.overtime_hours>0&&`(+${J.overtime_hours} OT)`]},K))})]})]})})]}),i.jsxs("div",{className:"signature-status-section",children:[i.jsx("h3",{children:"Signatures Required"}),i.jsxs("div",{className:`signature-slot-card ${q?"signed":"unsigned"}`,children:[i.jsxs("div",{className:"slot-header",children:[q?i.jsx(pd,{size:20,className:"status-icon signed"}):i.jsx(Xp,{size:20,className:"status-icon pending"}),i.jsx("span",{className:"slot-label",children:"Signature 1 - GC Authorization"})]}),q?i.jsxs("div",{className:"slot-signed-info",children:[i.jsxs("div",{className:"signer-details",children:[i.jsx("span",{className:"signer-name",children:q.signer_name}),(q.signer_title||q.signer_company)&&i.jsxs("span",{className:"signer-org",children:[q.signer_title,q.signer_title&&q.signer_company&&" - ",q.signer_company]})]}),i.jsxs("span",{className:"signed-date",children:["Signed ",c0(q.signed_at)]})]}):i.jsx("button",{className:"btn btn-primary sign-btn",onClick:()=>B(1),disabled:g,children:"Sign as GC"})]}),i.jsxs("div",{className:`signature-slot-card ${L?"signed":"unsigned"}`,children:[i.jsxs("div",{className:"slot-header",children:[L?i.jsx(pd,{size:20,className:"status-icon signed"}):i.jsx(Xp,{size:20,className:"status-icon pending"}),i.jsx("span",{className:"slot-label",children:"Signature 2 - Client Authorization"})]}),L?i.jsxs("div",{className:"slot-signed-info",children:[i.jsxs("div",{className:"signer-details",children:[i.jsx("span",{className:"signer-name",children:L.signer_name}),(L.signer_title||L.signer_company)&&i.jsxs("span",{className:"signer-org",children:[L.signer_title,L.signer_title&&L.signer_company&&" - ",L.signer_company]})]}),i.jsxs("span",{className:"signed-date",children:["Signed ",c0(L.signed_at)]})]}):i.jsx("button",{className:"btn btn-primary sign-btn",onClick:()=>B(2),disabled:g,children:"Sign as Client"})]}),D&&i.jsxs("div",{className:"fully-signed-message",children:[i.jsx(pd,{size:24}),i.jsx("p",{children:"This document has been fully signed by all parties."})]})]})]}),i.jsx("footer",{className:"signature-page-footer",children:i.jsx("p",{children:"Powered by FieldSync"})}),f&&v&&i.jsx(j$,{slot:v,documentType:s.document_type,documentTitle:X.title,onSave:W,onClose:()=>{m(!1),x(null)}})]})}function E$({company:t,projects:e,userId:r,onNotificationClick:a,onShowToast:n}){const[s,l]=ee.useState([]),[c,d]=ee.useState(0),[f,m]=ee.useState(!1),[v,x]=ee.useState(!1),[g,b]=ee.useState({}),_=ee.useRef(null);ee.useRef(null);const w=ee.useRef(null);ee.useEffect(()=>{r&&E()},[r]);const E=async()=>{try{const T=await nt.getUserNotificationPreferences(r),M={};T.forEach(V=>{M[V.project_id]=V.notification_types||[]}),b(M)}catch(T){console.error("Error loading user preferences:",T)}},C=(T,M)=>g[T]?g[T].length===0?!1:g[T].includes(M):!0;ee.useEffect(()=>{if(!t?.id||!e||e.length===0)return;A();const T=O();return()=>{T&&nt.unsubscribe(T)}},[t?.id,e,g]),ee.useEffect(()=>()=>{w.current&&(w.current.close().catch(()=>{}),w.current=null)},[]),ee.useEffect(()=>{function T(M){_.current&&!_.current.contains(M.target)&&m(!1)}return document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T)},[]);const A=async()=>{if(!e||e.length===0)return;const T=[];for(const M of e)try{C(M.id,"message")&&(await nt.getMessages(M.id,20)).filter(X=>X.sender_type==="field"&&!X.is_read).forEach(X=>{T.push({id:`msg-${X.id}`,type:"message",title:"New Message",message:X.message?.slice(0,50)+(X.message?.length>50?"...":""),projectId:M.id,projectName:M.name,senderName:X.sender_name,createdAt:X.created_at,isRead:X.is_read,data:X})}),C(M.id,"material_request")&&(await nt.getMaterialRequests(M.id,"pending")).forEach(ie=>{T.push({id:`req-${ie.id}`,type:"material_request",title:"Material Request",message:`${ie.items?.length||0} items requested`,projectId:M.id,projectName:M.name,senderName:ie.requested_by,priority:ie.priority,createdAt:ie.created_at,isRead:!1,data:ie})})}catch(V){console.error("Error loading notifications for project:",M.id,V)}try{(await nt.getCompanyInjuryReports(t.id,"open")).slice(0,5).forEach(V=>{if(C(V.project_id,"injury_report")){const ie=e.find(X=>X.id===V.project_id);T.push({id:`injury-${V.id}`,type:"injury_report",title:"Safety Report",message:`${V.injury_type} - ${V.injured_person_name}`,projectId:V.project_id,projectName:ie?.name||"Unknown Project",senderName:V.reported_by_name,createdAt:V.created_at,isRead:V.status!=="open",data:V})}})}catch(M){console.error("Error loading injury reports:",M)}T.sort((M,V)=>new Date(V.createdAt)-new Date(M.createdAt)),l(T.slice(0,50)),d(T.filter(M=>!M.isRead).length)},O=()=>{if(!t?.id||!e||e.length===0)return null;const T=e.map(V=>V.id),M=nt.subscribeToCompanyActivity(t.id,T,{onMessage:V=>{if(V.new?.sender_type==="field"){if(!C(V.new.project_id,"message"))return;G({id:`msg-${V.new.id}`,type:"message",title:"New Message",message:V.new.message?.slice(0,50)+(V.new.message?.length>50?"...":""),projectId:V.new.project_id,projectName:e.find(ie=>ie.id===V.new.project_id)?.name||"Project",senderName:V.new.sender_name,createdAt:V.new.created_at,isRead:!1,data:V.new})}},onMaterialRequest:V=>{C(V.new.project_id,"material_request")&&G({id:`req-${V.new.id}`,type:"material_request",title:"Material Request",message:`${V.new.items?.length||0} items requested`,projectId:V.new.project_id,projectName:e.find(ie=>ie.id===V.new.project_id)?.name||"Project",senderName:V.new.requested_by,priority:V.new.priority,createdAt:V.new.created_at,isRead:!1,data:V.new})},onTMTicket:V=>{if(V.eventType==="INSERT"){if(!C(V.new.project_id,"tm_ticket"))return;G({id:`tm-${V.new.id}`,type:"tm_ticket",title:"New T&M Ticket",message:`Submitted by ${V.new.created_by_name||"Field"}`,projectId:V.new.project_id,projectName:e.find(ie=>ie.id===V.new.project_id)?.name||"Project",senderName:V.new.created_by_name,createdAt:V.new.created_at,isRead:!1,data:V.new})}},onInjuryReport:V=>{C(V.new.project_id,"injury_report")&&G({id:`injury-${V.new.id}`,type:"injury_report",title:"Safety Report",message:`${V.new.injury_type} - ${V.new.injured_person_name}`,projectId:V.new.project_id,projectName:e.find(ie=>ie.id===V.new.project_id)?.name||"Project",senderName:V.new.reported_by_name,createdAt:V.new.created_at,isRead:!1,data:V.new})}});return M&&x(!0),M},G=T=>{l(V=>[T,...V.slice(0,49)]),d(V=>V+1),W();const M=B(T.type);n?.(`${M} ${T.title}: ${T.message}`,"info")},W=()=>{try{(!w.current||w.current.state==="closed")&&(w.current=new(window.AudioContext||window.webkitAudioContext));const T=w.current;T.state==="suspended"&&T.resume();const M=T.createOscillator(),V=T.createGain();M.connect(V),V.connect(T.destination),M.frequency.value=800,M.type="sine",V.gain.value=.3,M.start(),M.stop(T.currentTime+.15),setTimeout(()=>{if(!w.current||w.current.state==="closed")return;const ie=w.current.createOscillator(),X=w.current.createGain();ie.connect(X),X.connect(w.current.destination),ie.frequency.value=1e3,ie.type="sine",X.gain.value=.3,ie.start(),ie.stop(w.current.currentTime+.15)},150)}catch{}},B=T=>{switch(T){case"message":return i.jsx(lc,{size:16});case"material_request":return i.jsx(bc,{size:16});case"injury_report":return i.jsx(gh,{size:16});case"tm_ticket":return i.jsx(uo,{size:16});default:return i.jsx(UC,{size:16})}},q=T=>{switch(T){case"message":return"blue";case"material_request":return"orange";case"injury_report":return"red";case"tm_ticket":return"green";default:return"gray"}},L=T=>{l(M=>M.map(V=>V.id===T.id?{...V,isRead:!0}:V)),d(M=>Math.max(0,M-1)),m(!1),a?.(T)},Z=async()=>{for(const T of e)try{await nt.markMessagesRead(T.id,"office")}catch{}l(T=>T.map(M=>({...M,isRead:!0}))),d(0)},D=T=>{const M=new Date(T),ie=new Date-M,X=Math.floor(ie/6e4),J=Math.floor(ie/36e5),K=Math.floor(ie/864e5);return X<1?"Just now":X<60?`${X}m ago`:J<24?`${J}h ago`:K<7?`${K}d ago`:M.toLocaleDateString()};return i.jsxs("div",{className:"notification-center",ref:_,children:[i.jsxs("button",{className:`notification-bell ${c>0?"has-notifications":""}`,onClick:()=>m(!f),title:`${c} unread notifications`,children:[i.jsx("span",{className:"bell-icon",children:""}),c>0&&i.jsx("span",{className:"notification-badge",children:c>99?"99+":c}),v&&i.jsx("span",{className:"connection-dot"})]}),f&&i.jsxs("div",{className:"notification-dropdown",children:[i.jsxs("div",{className:"notification-header",children:[i.jsx("h4",{children:"Notifications"}),c>0&&i.jsx("button",{className:"mark-all-read",onClick:Z,children:"Mark all read"})]}),i.jsx("div",{className:"notification-list",children:s.length===0?i.jsxs("div",{className:"notification-empty",children:[i.jsx("span",{className:"empty-icon",children:""}),i.jsx("p",{children:"No notifications yet"}),i.jsx("small",{children:"You'll see updates from the field here"})]}):s.map(T=>i.jsxs("div",{className:`notification-item ${T.isRead?"read":"unread"} ${q(T.type)}`,onClick:()=>L(T),children:[i.jsx("div",{className:"notification-icon",children:B(T.type)}),i.jsxs("div",{className:"notification-content",children:[i.jsxs("div",{className:"notification-title",children:[T.title,T.priority==="urgent"&&i.jsx("span",{className:"priority-badge urgent",children:"URGENT"})]}),i.jsx("div",{className:"notification-message",children:T.message}),i.jsxs("div",{className:"notification-meta",children:[i.jsx("span",{className:"notification-project",children:T.projectName}),i.jsx("span",{className:"notification-time",children:D(T.createdAt)})]})]}),!T.isRead&&i.jsx("div",{className:"unread-dot"})]},T.id))}),s.length>0&&i.jsx("div",{className:"notification-footer",children:i.jsx("button",{className:"view-all-btn",onClick:()=>{m(!1),a?.({type:"view_all"})},children:"View All Activity"})})]})]})}class u0 extends ee.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,r){this.setState({error:e,errorInfo:r}),console.error("ErrorBoundary caught an error:",e,r)}handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};handleReload=()=>{window.location.reload()};render(){return this.state.hasError?i.jsx("div",{className:"error-boundary",children:i.jsxs("div",{className:"error-boundary-content",children:[i.jsx("div",{className:"error-icon",children:i.jsx(x1,{size:48})}),i.jsx("h2",{children:"Something went wrong"}),i.jsx("p",{children:"We're sorry, but something unexpected happened. Please try again."}),i.jsxs("div",{className:"error-actions",children:[i.jsx("button",{className:"btn btn-primary",onClick:this.handleRetry,children:"Try Again"}),i.jsx("button",{className:"btn btn-secondary",onClick:this.handleReload,children:"Reload Page"})]}),!1]})}):this.props.children}}function JS(){const[t,e]=ee.useState(v0()),[r,a]=ee.useState(0),[n,s]=ee.useState(!1),[l,c]=ee.useState(!1);return ee.useEffect(()=>{const d=X4(async m=>{e(m),m&&l&&(s(!0),setTimeout(()=>s(!1),3e3)),m||c(!0);const v=await sv();a(v)});sv().then(a);const f=setInterval(async()=>{if(!v0()){const m=await sv();a(m)}},5e3);return()=>{d(),clearInterval(f)}},[l]),t&&r===0&&!n?null:i.jsxs("div",{className:`offline-indicator ${t?"online":"offline"} ${n?"synced":""}`,children:[i.jsx("div",{className:"offline-indicator-content",children:t?n?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"online-icon",children:i.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("polyline",{points:"20 6 9 17 4 12"})})}),i.jsx("span",{className:"offline-text",children:"Changes synced!"})]}):r>0?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"syncing-icon",children:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("polyline",{points:"23 4 23 10 17 10"}),i.jsx("polyline",{points:"1 20 1 14 7 14"}),i.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})}),i.jsxs("span",{className:"offline-text",children:["Syncing ",r,"..."]})]}):null:i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"offline-icon",children:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),i.jsx("path",{d:"M16.72 11.06A10.94 10.94 0 0 1 19 12.55"}),i.jsx("path",{d:"M5 12.55a10.94 10.94 0 0 1 5.17-2.39"}),i.jsx("path",{d:"M10.71 5.05A16 16 0 0 1 22.58 9"}),i.jsx("path",{d:"M1.42 9a15.91 15.91 0 0 1 4.7-2.88"}),i.jsx("path",{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}),i.jsx("line",{x1:"12",y1:"20",x2:"12.01",y2:"20"})]})}),i.jsxs("span",{className:"offline-text",children:["Offline",r>0&&i.jsxs("span",{className:"pending-badge",children:[r," pending"]})]})]})}),i.jsx("style",{children:`
        .offline-indicator {
          position: fixed;
          bottom: 20px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 9999;
          padding: 10px 16px;
          border-radius: 24px;
          font-size: 14px;
          font-weight: 500;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
          from {
            transform: translateX(-50%) translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
          }
        }

        .offline-indicator.offline {
          background: #1f2937;
          color: #fbbf24;
        }

        .offline-indicator.online {
          background: #065f46;
          color: #d1fae5;
        }

        .offline-indicator.synced {
          background: #065f46;
          color: #d1fae5;
        }

        .offline-indicator-content {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .offline-icon,
        .online-icon,
        .syncing-icon {
          display: flex;
          align-items: center;
        }

        .syncing-icon svg {
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }

        .offline-text {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .pending-badge {
          background: rgba(251, 191, 36, 0.2);
          padding: 2px 8px;
          border-radius: 12px;
          font-size: 12px;
        }

        @media (max-width: 480px) {
          .offline-indicator {
            bottom: 70px; /* Above mobile nav */
            left: 16px;
            right: 16px;
            transform: none;
          }
        }
      `})]})}function A$(){const[t,e]=ee.useState("entry"),[r,a]=ee.useState(null),[n,s]=ee.useState(null),[l,c]=ee.useState([]),[d,f]=ee.useState([]),[m,v]=ee.useState(null),[x,g]=ee.useState(null),[b,_]=ee.useState(null),[w,E]=ee.useState(!0),[C,A]=ee.useState("dashboard"),[O,G]=ee.useState(null),[W,B]=ee.useState(!1),[q,L]=ee.useState(null);ee.useEffect(()=>{const U=window.location.pathname,j=U.match(/^\/view\/([a-zA-Z0-9]+)$/),F=U.match(/^\/sign\/([a-zA-Z0-9_]+)$/);j?(g(j[1]),e("public"),E(!1)):F?(_(F[1]),e("signature"),E(!1)):Z()},[]);const Z=async()=>{try{const{data:{user:U}}=await De.auth.getUser();if(!U){E(!1);return}const{data:j,error:F}=await De.from("users").select("*").eq("id",U.id).single();if(j){a(j);const I=await nt.getUserCompanies(U.id);c(I);const z=localStorage.getItem("selectedCompanyId");let ne=null;if(z&&I.find(se=>se.id===z))ne=I.find(se=>se.id===z);else if(I.length>0)ne=I[0];else if(j.company_id){const{data:se}=await De.from("companies").select("*").eq("id",j.company_id).single();ne=se}if(ne){const{data:se}=await De.from("companies").select("*").eq("id",ne.id).single();s(se),e("office")}}}catch(U){console.error("Auth check error:",U)}finally{E(!1)}},D=U=>{v(U),e("foreman")},T=async(U,j)=>{try{const{data:F,error:I}=await De.auth.signInWithPassword({email:U,password:j});if(I){X(I.message||"Invalid credentials","error");return}const{data:z,error:ne}=await De.from("users").select("*").eq("id",F.user.id).single();if(ne){console.error("User fetch error:",ne),X("Error loading profile","error");return}if(z){a(z);const se=await nt.getUserCompanies(F.user.id);c(se);const je=localStorage.getItem("selectedCompanyId");let Ne=null;if(je&&se.find(ge=>ge.id===je))Ne=se.find(ge=>ge.id===je);else if(se.length>0)Ne=se[0];else if(z.company_id){const{data:ge}=await De.from("companies").select("*").eq("id",z.company_id).single();Ne=ge}if(Ne){const{data:ge}=await De.from("companies").select("*").eq("id",Ne.id).single();s(ge),e("office")}else X("No company access. Please contact admin.","error")}else X("Profile not found. Please contact admin.","error")}catch(F){console.error("Login error:",F),X("Login failed","error")}},M=async U=>{try{const{data:j}=await De.from("companies").select("*").eq("id",U).single();j&&(s(j),localStorage.setItem("selectedCompanyId",U),B(!1),A("dashboard"),X(`Switched to ${j.name}`,"success"))}catch(j){console.error("Switch company error:",j),X("Error switching company","error")}},V=async()=>{try{await DC.signOut(),a(null),s(null),c([]),e("entry"),A("dashboard"),localStorage.removeItem("selectedCompanyId")}catch(U){console.error("Logout error:",U),X("Error signing out","error")}},ie=()=>{v(null),e("entry")},X=(U,j="")=>{G({message:U,type:j})},J=()=>{A("dashboard"),n?.id&&K()},K=async()=>{if(n?.id)try{const U=await nt.getProjects(n.id);f(U)}catch(U){console.error("Error loading projects:",U)}};ee.useEffect(()=>{n?.id&&t==="office"&&K()},[n?.id,t]);const te=U=>{if(U.type==="view_all"){A("dashboard"),L(null);return}A("dashboard"),U.projectId&&L(U.projectId)},fe=()=>{L(null)};return w?i.jsx(Mf,{companyId:n?.id,children:i.jsxs("div",{className:"loading-screen",children:[i.jsx(kl,{className:"loading-logo"}),i.jsx("div",{className:"spinner"})]})}):t==="entry"?i.jsxs(Mf,{children:[i.jsx(u0,{children:i.jsx(r8,{onForemanAccess:D,onOfficeLogin:T,onShowToast:X})}),O&&i.jsx(mu,{message:O.message,type:O.type,onClose:()=>G(null)})]}):t==="public"&&x?i.jsxs(Mf,{children:[i.jsx(u0,{children:i.jsx(N$,{shareToken:x})}),O&&i.jsx(mu,{message:O.message,type:O.type,onClose:()=>G(null)})]}):t==="signature"&&b?i.jsxs(Mf,{children:[i.jsx(u0,{children:i.jsx(k$,{signatureToken:b})}),O&&i.jsx(mu,{message:O.message,type:O.type,onClose:()=>G(null)})]}):t==="foreman"&&m?i.jsxs(Mf,{companyId:m.company_id,children:[i.jsx(u0,{children:i.jsx(f8,{project:m,companyId:m.company_id,onShowToast:X,onExit:ie})}),i.jsx(JS,{}),O&&i.jsx(mu,{message:O.message,type:O.type,onClose:()=>G(null)})]}):i.jsx(Mf,{companyId:n?.id,children:i.jsxs("div",{children:[!qe&&i.jsx("div",{className:"demo-banner",children:"Demo Mode - Data saved locally in your browser"}),i.jsx("nav",{className:"nav",children:i.jsxs("div",{className:"nav-content",children:[i.jsx(kl,{}),i.jsxs("div",{className:"nav-tabs",children:[i.jsx("button",{className:`nav-tab ${C==="dashboard"?"active":""}`,onClick:()=>A("dashboard"),children:"Dashboard"}),i.jsx("button",{className:`nav-tab ${C==="setup"?"active":""}`,onClick:()=>A("setup"),children:"+ New Project"}),i.jsx("button",{className:`nav-tab ${C==="pricing"?"active":""}`,onClick:()=>A("pricing"),children:"Pricing"}),i.jsx("button",{className:`nav-tab ${C==="branding"?"active":""}`,onClick:()=>A("branding"),children:"Branding"})]}),i.jsxs("div",{className:"nav-user",children:[i.jsx(E$,{company:n,projects:d,userId:r?.id,onNotificationClick:te,onShowToast:X}),l.length>1&&i.jsxs("div",{className:"company-switcher",children:[i.jsxs("button",{className:"company-switcher-btn",onClick:()=>B(!W),children:[n?.name||"Select Company",i.jsx("span",{className:"switcher-arrow",children:""})]}),W&&i.jsx("div",{className:"company-dropdown",children:l.map(U=>i.jsxs("button",{className:`company-option ${U.id===n?.id?"active":""}`,onClick:()=>M(U.id),children:[U.name,U.id===n?.id&&i.jsx("span",{className:"check",children:""})]},U.id))})]}),l.length<=1&&n&&i.jsx("span",{className:"nav-company-name",children:n.name}),i.jsx("span",{className:"nav-user-name",children:r?.name||r?.email}),i.jsx("button",{className:"nav-logout",onClick:V,children:"Sign Out"})]})]})}),i.jsx(u0,{children:i.jsxs("div",{className:"container",children:[C==="dashboard"&&i.jsx(m$,{company:n,onShowToast:X,navigateToProjectId:q,onProjectNavigated:fe}),C==="setup"&&i.jsx(g$,{company:n,user:r,onProjectCreated:J,onShowToast:X}),C==="pricing"&&i.jsx(S$,{company:n,onShowToast:X}),C==="branding"&&i.jsx(v$,{company:n,onShowToast:X})]},n?.id)}),i.jsx(JS,{}),O&&i.jsx(mu,{message:O.message,type:O.type,onClose:()=>G(null)})]})})}GE.createRoot(document.getElementById("root")).render(i.jsx(BE.StrictMode,{children:i.jsx(A$,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered:",t.scope),setInterval(()=>{t.update()},6e4)}).catch(t=>{console.log("SW registration failed:",t)})});export{xa as _,C$ as c,Gx as g};
