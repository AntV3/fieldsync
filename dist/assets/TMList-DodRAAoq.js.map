{"version":3,"mappings":"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","names":["getBarSize","globalSize","totalSize","selfSize","barSize","isNullish","getPercentValue","combineBarSizeList","allBars","initialValue","stackedBars","isStacked","unstackedBars","b","groupByStack","acc","bar","stackedSizeList","_ref","stackId","bars","dataKeys","unstackedSizeList","dk","ownKeys","e","r","t","o","_objectSpread","_defineProperty","_toPropertyKey","i","_toPrimitive","getBarPositions","barGap","barCategoryGap","bandSize","sizeList","maxBarSize","len","realBarGap","result","isWellBehavedNumber","useFull","fullBarSize","sum","res","entry","offset","prev","_entry$barSize","newPosition","newRes","_offset","originalSize","size","combineAllBarPositions","globalMaxBarSize","barBandSize","childMaxBarSize","allBarPositions","pos","combineStackedData","stackGroups","barSettings","stackSeriesIdentifier","getStackSeriesIdentifier","stackGroup","stackedData","sd","getZIndexFromUnknown","input","defaultZIndex","_excluded","_objectWithoutProperties","_objectWithoutPropertiesLoose","n","initialContextState","ErrorBarContext","createContext","SetErrorBarContext","props","children","rest","React.createElement","prefix","invariant","condition","message","_extends","BarRectangle","Shape","minPointSizeCallback","minPointSize","defaultValue","value","index","isNumber","isValueNumberOrNil","pickIsPanorama","_state","_id","isPanorama","pickBarId","id","selectSynchronisedBarSettings","createSelector","selectUnfilteredCartesianItems","graphicalItems","item","selectMaxBarSize","pickCells","_isPanorama","cells","selectAllVisibleBars","selectChartLayout","selectXAxisIdFromGraphicalItemId","selectYAxisIdFromGraphicalItemId","layout","allItems","xAxisId","yAxisId","selectBarStackGroups","state","selectStackGroups","selectBarCartesianAxisSize","selectCartesianAxisSize","selectBarSizeList","selectRootBarSize","selectBarBandSize","_getBandSizeOfAxis","selectRootMaxBarSize","axis","ticks","selectAxisWithScale","selectTicksOfGraphicalItem","getBandSizeOfAxis","selectAxisBandSize","selectAllBarPositions","selectBarGap","selectBarCategoryGap","selectXAxisWithScale","selectYAxisWithScale","selectXAxisTicks","selectYAxisTicks","selectBarPosition","position","p","selectStackedDataOfItem","selectBarRectangles","selectChartOffsetInternal","selectAxisViewBox","selectChartDataWithIndexesIfNotInPanoramaPosition3","axisViewBox","xAxis","yAxis","xAxisTicks","yAxisTicks","_ref2","chartData","dataStartIndex","dataEndIndex","data","displayedData","computeBarRectangles","BarStackContext","useStackId","childStackId","stackSettings","useContext","getNormalizedStackId","getClipPathId","useBarStackClipPathUrl","barStackContext","BarStackClipLayer","clipPathUrl","Layer","_excluded2","_excluded3","_excluded4","computeLegendPayloadFromBarData","dataKey","name","fill","legendType","hide","getTooltipNameProp","SetBarTooltipEntrySettings","React.memo","stroke","strokeWidth","unit","tooltipType","tooltipEntrySettings","SetTooltipEntrySettings","BarBackground","activeIndex","useAppSelector","selectActiveTooltipIndex","backgroundFromProps","allOtherBarProps","onMouseEnterFromProps","onMouseLeaveFromProps","onItemClickFromProps","restOfAllOtherProps","onMouseEnterFromContext","useMouseEnterItemDispatch","onMouseLeaveFromContext","useMouseLeaveItemDispatch","onClickFromContext","useMouseClickItemDispatch","backgroundProps","svgPropertiesNoEventsFromUnknown","ZIndexLayer","DefaultZIndexes","backgroundFromDataEntry","tooltipPosition","onMouseEnter","onMouseLeave","onClick","barRectangleProps","adaptEventsOfChild","BarLabelListProvider","showLabels","rects","labelListEntries","viewBox","CartesianLabelListContextProvider","BarRectangleWithActiveState","shape","activeBar","baseProps","activeDataKey","selectActiveTooltipDataKey","isActive","option","BarRectangleNeverActive","BarRectangles","_ref3","_svgPropertiesNoEvent","_ref4","svgPropertiesNoEvents","React.Fragment","RectanglesWithAnimation","_ref5","previousRectanglesRef","isAnimationActive","animationBegin","animationDuration","animationEasing","onAnimationEnd","onAnimationStart","prevData","animationId","useAnimationId","isAnimating","setIsAnimating","useState","handleAnimationEnd","useCallback","handleAnimationStart","JavascriptAnimate","stepData","interpolate","height","y","w","x","LabelListFromLabelProp","RenderRectangles","useRef","defaultMinPointSize","errorBarDataPointFormatter","dataPoint","getValueByDataKey","BarWithState","PureComponent","className","needClip","background","layerClass","clsx","clipPathId","GraphicalItemClipPath","defaultBarProps","BarImpl","useNeedsClip","useChartLayout","useIsPanorama","findAllByType","Cell","errorBarOffset","firstDataPoint","_ref6","minPointSizeProp","parentViewBox","numericAxis","stackedDomain","baseValue","getBaseValueOfBar","stackedBarStart","width","untruncatedValue","truncateByDomain","_ref7","baseValueScale","currentValueScale","getCateCoordinateOfBar","computedHeight","isNan","delta","mathSign","_baseValueScale","_currentValueScale","_delta","barRectangleItem","BarFn","outsideProps","resolveDefaultProps","RegisterGraphicalItemId","SetLegendPayload","SetCartesianGraphicalItem","Bar","propsAreEqual","allowedTooltipTypes","BarChart","forwardRef","ref","CartesianChart","arrayTooltipSearcher","TMDashboard","tickets","laborRates","metrics","useMemo","pending","approved","billed","rejected","totalHours","regularHours","overtimeHours","workerHoursMap","workersByRole","ticket","worker","regHrs","otHrs","role","materialsCost","costPer","uniqueWorkers","topWorkers","a","completedTickets","approvalRate","rates","calculateTicketValue","laborCost","rate","pendingValue","approvedValue","billedValue","monthlyData","date","monthKey","monthLabel","byMonth","byStatus","s","formatCurrency","CustomTooltip","active","payload","label","jsxs","jsx","ClipboardList","Clock","Users","DollarSign","AlertCircle","CheckCircle","FileText","TrendingUp","ResponsiveContainer","PieChart","Pie","percent","Tooltip","CartesianGrid","XAxis","YAxis","hours","percentage","AreaChart","Area","TMTicketCard","memo","isExpanded","isSelected","isLocked","lockInfo","hasFailedImport","isRetrying","onToggleExpand","onToggleSelect","onApprove","onUpdateStatus","onDelete","onOpenCorAssign","onRetryImport","onShowSignatureLink","formatDate","calculateTotalHours","calculateTicketTotal","totalCost","handleKeyDown","Lock","CountBadge","Camera","AlertTriangle","HardHat","Wrench","Fragment","photo","idx","Link","Link2","RefreshCw","loadXLSX","loadJsPDF","__vitePreload","TMList","project","company","onShowToast","compact","previewMode","onViewAll","branding","useBranding","setTickets","loading","setLoading","loadingMore","setLoadingMore","filter","setFilter","expandedTicket","setExpandedTicket","selectedTickets","setSelectedTickets","page","setPage","hasMore","setHasMore","totalCount","setTotalCount","TICKETS_PER_PAGE","MAX_TICKETS_IN_MEMORY","viewMode","setViewMode","displayMode","setDisplayMode","saved","expandedMonths","setExpandedMonths","dateFilter","setDateFilter","showChangeOrderModal","setShowChangeOrderModal","pendingApprovalTicket","setPendingApprovalTicket","changeOrderValue","setChangeOrderValue","showSignatureLink","setShowSignatureLink","signatureLinkTicket","setSignatureLinkTicket","showCorAssignModal","setShowCorAssignModal","pendingCorAssignTicket","setPendingCorAssignTicket","availableCors","setAvailableCors","selectedCorForAssign","setSelectedCorForAssign","loadingCors","setLoadingCors","lockedTickets","setLockedTickets","failedImports","setFailedImports","retryingImport","setRetryingImport","useEffect","loadTickets","subscription","db","pageNum","reset","combined","ticketsWithCOR","lockResults","importStatusResults","editResult","importStatus","loadMore","updateStatus","ticketId","newStatus","error","handleApprove","confirmChangeOrderApproval","deleteTicket","openCorAssignModal","cors","handleAssignToCor","cor","handleRetryImport","next","total","regHours","otHours","dateStr","toggleTicketSelection","handleToggleExpand","handleShowSignatureLink","toggleSelectAll","currentFiltered","allSelected","clearSelection","getExportTickets","filtered","exportToExcel","exportTickets","XLSX","workersData","itemsData","summaryData","ticketDate","ticketStatus","itemName","category","wb","summarySheet","workersSheet","itemsSheet","fileName","exportToPDF","jsPDFModule","autoTableModule","jsPDF","autoTable","doc","pageWidth","pageHeight","margin","yPos","primaryColor","hexToRgb","secondaryColor","logoOffset","logoBase64","loadImageAsBase64","dates","startDate","endDate","grandTotalHours","grandTotalMaterials","totalWorkers","boxWidth","summaryBoxData","lightPrimary","c","boxX","supervisionData","operatorsData","laborersData","supervisionRegHours","supervisionOTHours","operatorsRegHours","operatorsOTHours","laborersRegHours","laborersOTHours","rowData","renderLaborTable","title","totalRegHours","totalOTHours","categoryData","categoryTotals","categoryOrder","renderMaterialsTable","subtotal","cat","firstTicket","renderSignatureBlock","startY","signatureData","signerName","signerTitle","signerCompany","signedDate","sigLineY","titleCompany","formattedDate","totalPages","footerY","filteredTickets","now","currentMonth","currentYear","sevenDaysAgo","ticketsByMonth","groups","currentMonthKey","toggleMonthExpand","newExpanded","totalTicketsCount","TicketSkeleton","allFilteredSelected","someSelected","renderTicketCard","BarChart3","List","FileSpreadsheet","status","Calendar","monthData","ChevronDown","ChevronRight","SignatureLinkGenerator","X"],"ignoreList":[0,1,2,3,4,5,6,7,8,9,10],"sources":["../../node_modules/recharts/es6/state/selectors/combiners/combineBarSizeList.js","../../node_modules/recharts/es6/state/selectors/combiners/combineAllBarPositions.js","../../node_modules/recharts/es6/state/selectors/combiners/combineStackedData.js","../../node_modules/recharts/es6/zIndex/getZIndexFromUnknown.js","../../node_modules/recharts/es6/context/ErrorBarContext.js","../../node_modules/tiny-invariant/dist/esm/tiny-invariant.js","../../node_modules/recharts/es6/util/BarUtils.js","../../node_modules/recharts/es6/state/selectors/barSelectors.js","../../node_modules/recharts/es6/cartesian/BarStack.js","../../node_modules/recharts/es6/cartesian/Bar.js","../../node_modules/recharts/es6/chart/BarChart.js","../../src/components/tm/TMDashboard.jsx","../../src/components/tm/TMTicketCard.jsx","../../src/components/TMList.jsx"],"sourcesContent":["import { isStacked } from '../../types/StackedGraphicalItem';\nimport { getPercentValue, isNullish } from '../../../util/DataUtils';\nvar getBarSize = (globalSize, totalSize, selfSize) => {\n  var barSize = selfSize !== null && selfSize !== void 0 ? selfSize : globalSize;\n  if (isNullish(barSize)) {\n    return undefined;\n  }\n  return getPercentValue(barSize, totalSize, 0);\n};\nexport var combineBarSizeList = (allBars, globalSize, totalSize) => {\n  var initialValue = {};\n  var stackedBars = allBars.filter(isStacked);\n  var unstackedBars = allBars.filter(b => b.stackId == null);\n  var groupByStack = stackedBars.reduce((acc, bar) => {\n    if (!acc[bar.stackId]) {\n      acc[bar.stackId] = [];\n    }\n    acc[bar.stackId].push(bar);\n    return acc;\n  }, initialValue);\n  var stackedSizeList = Object.entries(groupByStack).map(_ref => {\n    var [stackId, bars] = _ref;\n    var dataKeys = bars.map(b => b.dataKey);\n    var barSize = getBarSize(globalSize, totalSize, bars[0].barSize);\n    return {\n      stackId,\n      dataKeys,\n      barSize\n    };\n  });\n  var unstackedSizeList = unstackedBars.map(b => {\n    var dataKeys = [b.dataKey].filter(dk => dk != null);\n    var barSize = getBarSize(globalSize, totalSize, b.barSize);\n    return {\n      stackId: undefined,\n      dataKeys,\n      barSize\n    };\n  });\n  return [...stackedSizeList, ...unstackedSizeList];\n};","function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport { getPercentValue, isNullish } from '../../../util/DataUtils';\nimport { isWellBehavedNumber } from '../../../util/isWellBehavedNumber';\nfunction getBarPositions(barGap, barCategoryGap, bandSize, sizeList, maxBarSize) {\n  var len = sizeList.length;\n  if (len < 1) {\n    return undefined;\n  }\n  var realBarGap = getPercentValue(barGap, bandSize, 0, true);\n  var result;\n  var initialValue = [];\n\n  // whether is barSize set by user\n  // Okay but why does it check only for the first element? What if the first element is set but others are not?\n  if (isWellBehavedNumber(sizeList[0].barSize)) {\n    var useFull = false;\n    var fullBarSize = bandSize / len;\n    var sum = sizeList.reduce((res, entry) => res + (entry.barSize || 0), 0);\n    sum += (len - 1) * realBarGap;\n    if (sum >= bandSize) {\n      sum -= (len - 1) * realBarGap;\n      realBarGap = 0;\n    }\n    if (sum >= bandSize && fullBarSize > 0) {\n      useFull = true;\n      fullBarSize *= 0.9;\n      sum = len * fullBarSize;\n    }\n    var offset = (bandSize - sum) / 2 >> 0;\n    var prev = {\n      offset: offset - realBarGap,\n      size: 0\n    };\n    result = sizeList.reduce((res, entry) => {\n      var _entry$barSize;\n      var newPosition = {\n        stackId: entry.stackId,\n        dataKeys: entry.dataKeys,\n        position: {\n          offset: prev.offset + prev.size + realBarGap,\n          size: useFull ? fullBarSize : (_entry$barSize = entry.barSize) !== null && _entry$barSize !== void 0 ? _entry$barSize : 0\n        }\n      };\n      var newRes = [...res, newPosition];\n      prev = newRes[newRes.length - 1].position;\n      return newRes;\n    }, initialValue);\n  } else {\n    var _offset = getPercentValue(barCategoryGap, bandSize, 0, true);\n    if (bandSize - 2 * _offset - (len - 1) * realBarGap <= 0) {\n      realBarGap = 0;\n    }\n    var originalSize = (bandSize - 2 * _offset - (len - 1) * realBarGap) / len;\n    if (originalSize > 1) {\n      originalSize >>= 0;\n    }\n    var size = isWellBehavedNumber(maxBarSize) ? Math.min(originalSize, maxBarSize) : originalSize;\n    result = sizeList.reduce((res, entry, i) => [...res, {\n      stackId: entry.stackId,\n      dataKeys: entry.dataKeys,\n      position: {\n        offset: _offset + (originalSize + realBarGap) * i + (originalSize - size) / 2,\n        size\n      }\n    }], initialValue);\n  }\n  return result;\n}\nexport var combineAllBarPositions = (sizeList, globalMaxBarSize, barGap, barCategoryGap, barBandSize, bandSize, childMaxBarSize) => {\n  var maxBarSize = isNullish(childMaxBarSize) ? globalMaxBarSize : childMaxBarSize;\n  var allBarPositions = getBarPositions(barGap, barCategoryGap, barBandSize !== bandSize ? barBandSize : bandSize, sizeList, maxBarSize);\n  if (barBandSize !== bandSize && allBarPositions != null) {\n    allBarPositions = allBarPositions.map(pos => _objectSpread(_objectSpread({}, pos), {}, {\n      position: _objectSpread(_objectSpread({}, pos.position), {}, {\n        offset: pos.position.offset - barBandSize / 2\n      })\n    }));\n  }\n  return allBarPositions;\n};","import { getStackSeriesIdentifier } from '../../../util/stacks/getStackSeriesIdentifier';\nexport var combineStackedData = (stackGroups, barSettings) => {\n  var stackSeriesIdentifier = getStackSeriesIdentifier(barSettings);\n  if (!stackGroups || stackSeriesIdentifier == null || barSettings == null) {\n    return undefined;\n  }\n  var {\n    stackId\n  } = barSettings;\n  if (stackId == null) {\n    return undefined;\n  }\n  var stackGroup = stackGroups[stackId];\n  if (!stackGroup) {\n    return undefined;\n  }\n  var {\n    stackedData\n  } = stackGroup;\n  if (!stackedData) {\n    return undefined;\n  }\n  return stackedData.find(sd => sd.key === stackSeriesIdentifier);\n};","import { isWellBehavedNumber } from '../util/isWellBehavedNumber';\nexport function getZIndexFromUnknown(input, defaultZIndex) {\n  if (input && typeof input === 'object' && 'zIndex' in input && typeof input.zIndex === 'number' && isWellBehavedNumber(input.zIndex)) {\n    return input.zIndex;\n  }\n  return defaultZIndex;\n}","var _excluded = [\"children\"];\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\nimport * as React from 'react';\nimport { createContext, useContext, useEffect, useRef } from 'react';\nimport { addErrorBar, removeErrorBar, replaceErrorBar } from '../state/errorBarSlice';\nimport { useAppDispatch } from '../state/hooks';\nimport { useGraphicalItemId } from './RegisterGraphicalItemId';\nvar initialContextState = {\n  data: [],\n  xAxisId: 'xAxis-0',\n  yAxisId: 'yAxis-0',\n  dataPointFormatter: () => ({\n    x: 0,\n    y: 0,\n    value: 0\n  }),\n  errorBarOffset: 0\n};\nvar ErrorBarContext = /*#__PURE__*/createContext(initialContextState);\nexport function SetErrorBarContext(props) {\n  var {\n      children\n    } = props,\n    rest = _objectWithoutProperties(props, _excluded);\n  return /*#__PURE__*/React.createElement(ErrorBarContext.Provider, {\n    value: rest\n  }, children);\n}\nexport var useErrorBarContext = () => useContext(ErrorBarContext);\nexport function ReportErrorBarSettings(props) {\n  var dispatch = useAppDispatch();\n  var graphicalItemId = useGraphicalItemId();\n  var prevPropsRef = useRef(null);\n  useEffect(() => {\n    if (graphicalItemId == null) {\n      // ErrorBar outside a graphical item context does not do anything.\n      return;\n    }\n    if (prevPropsRef.current === null) {\n      dispatch(addErrorBar({\n        itemId: graphicalItemId,\n        errorBar: props\n      }));\n    } else if (prevPropsRef.current !== props) {\n      dispatch(replaceErrorBar({\n        itemId: graphicalItemId,\n        prev: prevPropsRef.current,\n        next: props\n      }));\n    }\n    prevPropsRef.current = props;\n  }, [dispatch, graphicalItemId, props]);\n  useEffect(() => {\n    return () => {\n      if (prevPropsRef.current != null && graphicalItemId != null) {\n        dispatch(removeErrorBar({\n          itemId: graphicalItemId,\n          errorBar: prevPropsRef.current\n        }));\n        prevPropsRef.current = null;\n      }\n    };\n  }, [dispatch, graphicalItemId]);\n  return null;\n}","var isProduction = process.env.NODE_ENV === 'production';\nvar prefix = 'Invariant failed';\nfunction invariant(condition, message) {\n    if (condition) {\n        return;\n    }\n    if (isProduction) {\n        throw new Error(prefix);\n    }\n    var provided = typeof message === 'function' ? message() : message;\n    var value = provided ? \"\".concat(prefix, \": \").concat(provided) : prefix;\n    throw new Error(value);\n}\n\nexport { invariant as default };\n","function _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from 'react';\nimport invariant from 'tiny-invariant';\nimport { Shape } from './ActiveShapeUtils';\nimport { isNullish, isNumber } from './DataUtils';\nexport function BarRectangle(props) {\n  return /*#__PURE__*/React.createElement(Shape, _extends({\n    shapeType: \"rectangle\",\n    activeClassName: \"recharts-active-bar\"\n  }, props));\n}\n/**\n * Safely gets minPointSize from the minPointSize prop if it is a function\n * @param minPointSize minPointSize as passed to the Bar component\n * @param defaultValue default minPointSize\n * @returns minPointSize\n */\nexport var minPointSizeCallback = function minPointSizeCallback(minPointSize) {\n  var defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  return (value, index) => {\n    if (isNumber(minPointSize)) return minPointSize;\n    var isValueNumberOrNil = isNumber(value) || isNullish(value);\n    if (isValueNumberOrNil) {\n      return minPointSize(value, index);\n    }\n    !isValueNumberOrNil ? true ? invariant(false, \"minPointSize callback function received a value with type of \".concat(typeof value, \". Currently only numbers or null/undefined are supported.\")) : invariant(false) : void 0;\n    return defaultValue;\n  };\n};","import { createSelector } from 'reselect';\nimport { selectAxisWithScale, selectCartesianAxisSize, selectStackGroups, selectTicksOfGraphicalItem, selectUnfilteredCartesianItems } from './axisSelectors';\nimport { isNullish } from '../../util/DataUtils';\nimport { getBandSizeOfAxis } from '../../util/ChartUtils';\nimport { computeBarRectangles } from '../../cartesian/Bar';\nimport { selectChartLayout } from '../../context/chartLayoutContext';\nimport { selectChartDataWithIndexesIfNotInPanoramaPosition3 } from './dataSelectors';\nimport { selectAxisViewBox, selectChartOffsetInternal } from './selectChartOffsetInternal';\nimport { selectBarCategoryGap, selectBarGap, selectRootBarSize, selectRootMaxBarSize } from './rootPropsSelectors';\nimport { combineBarSizeList } from './combiners/combineBarSizeList';\nimport { combineAllBarPositions } from './combiners/combineAllBarPositions';\nimport { combineStackedData } from './combiners/combineStackedData';\nimport { selectXAxisIdFromGraphicalItemId, selectYAxisIdFromGraphicalItemId } from './graphicalItemSelectors';\nvar pickIsPanorama = (_state, _id, isPanorama) => isPanorama;\nvar pickBarId = (_state, id) => id;\nvar selectSynchronisedBarSettings = createSelector([selectUnfilteredCartesianItems, pickBarId], (graphicalItems, id) => graphicalItems.filter(item => item.type === 'bar').find(item => item.id === id));\nexport var selectMaxBarSize = createSelector([selectSynchronisedBarSettings], barSettings => barSettings === null || barSettings === void 0 ? void 0 : barSettings.maxBarSize);\nvar pickCells = (_state, _id, _isPanorama, cells) => cells;\nexport var selectAllVisibleBars = createSelector([selectChartLayout, selectUnfilteredCartesianItems, selectXAxisIdFromGraphicalItemId, selectYAxisIdFromGraphicalItemId, pickIsPanorama], (layout, allItems, xAxisId, yAxisId, isPanorama) => allItems.filter(i => {\n  if (layout === 'horizontal') {\n    return i.xAxisId === xAxisId;\n  }\n  return i.yAxisId === yAxisId;\n}).filter(i => i.isPanorama === isPanorama).filter(i => i.hide === false).filter(i => i.type === 'bar'));\nvar selectBarStackGroups = (state, id, isPanorama) => {\n  var layout = selectChartLayout(state);\n  var xAxisId = selectXAxisIdFromGraphicalItemId(state, id);\n  var yAxisId = selectYAxisIdFromGraphicalItemId(state, id);\n  if (xAxisId == null || yAxisId == null) {\n    return undefined;\n  }\n  if (layout === 'horizontal') {\n    return selectStackGroups(state, 'yAxis', yAxisId, isPanorama);\n  }\n  return selectStackGroups(state, 'xAxis', xAxisId, isPanorama);\n};\nexport var selectBarCartesianAxisSize = (state, id) => {\n  var layout = selectChartLayout(state);\n  var xAxisId = selectXAxisIdFromGraphicalItemId(state, id);\n  var yAxisId = selectYAxisIdFromGraphicalItemId(state, id);\n  if (xAxisId == null || yAxisId == null) {\n    return undefined;\n  }\n  if (layout === 'horizontal') {\n    return selectCartesianAxisSize(state, 'xAxis', xAxisId);\n  }\n  return selectCartesianAxisSize(state, 'yAxis', yAxisId);\n};\nexport var selectBarSizeList = createSelector([selectAllVisibleBars, selectRootBarSize, selectBarCartesianAxisSize], combineBarSizeList);\nexport var selectBarBandSize = (state, id, isPanorama) => {\n  var _ref, _getBandSizeOfAxis;\n  var barSettings = selectSynchronisedBarSettings(state, id);\n  if (barSettings == null) {\n    return undefined;\n  }\n  var xAxisId = selectXAxisIdFromGraphicalItemId(state, id);\n  var yAxisId = selectYAxisIdFromGraphicalItemId(state, id);\n  if (xAxisId == null || yAxisId == null) {\n    return undefined;\n  }\n  var layout = selectChartLayout(state);\n  var globalMaxBarSize = selectRootMaxBarSize(state);\n  var {\n    maxBarSize: childMaxBarSize\n  } = barSettings;\n  var maxBarSize = isNullish(childMaxBarSize) ? globalMaxBarSize : childMaxBarSize;\n  var axis, ticks;\n  if (layout === 'horizontal') {\n    axis = selectAxisWithScale(state, 'xAxis', xAxisId, isPanorama);\n    ticks = selectTicksOfGraphicalItem(state, 'xAxis', xAxisId, isPanorama);\n  } else {\n    axis = selectAxisWithScale(state, 'yAxis', yAxisId, isPanorama);\n    ticks = selectTicksOfGraphicalItem(state, 'yAxis', yAxisId, isPanorama);\n  }\n  return (_ref = (_getBandSizeOfAxis = getBandSizeOfAxis(axis, ticks, true)) !== null && _getBandSizeOfAxis !== void 0 ? _getBandSizeOfAxis : maxBarSize) !== null && _ref !== void 0 ? _ref : 0;\n};\nexport var selectAxisBandSize = (state, id, isPanorama) => {\n  var layout = selectChartLayout(state);\n  var xAxisId = selectXAxisIdFromGraphicalItemId(state, id);\n  var yAxisId = selectYAxisIdFromGraphicalItemId(state, id);\n  if (xAxisId == null || yAxisId == null) {\n    return undefined;\n  }\n  var axis, ticks;\n  if (layout === 'horizontal') {\n    axis = selectAxisWithScale(state, 'xAxis', xAxisId, isPanorama);\n    ticks = selectTicksOfGraphicalItem(state, 'xAxis', xAxisId, isPanorama);\n  } else {\n    axis = selectAxisWithScale(state, 'yAxis', yAxisId, isPanorama);\n    ticks = selectTicksOfGraphicalItem(state, 'yAxis', yAxisId, isPanorama);\n  }\n  return getBandSizeOfAxis(axis, ticks);\n};\nexport var selectAllBarPositions = createSelector([selectBarSizeList, selectRootMaxBarSize, selectBarGap, selectBarCategoryGap, selectBarBandSize, selectAxisBandSize, selectMaxBarSize], combineAllBarPositions);\nvar selectXAxisWithScale = (state, id, isPanorama) => {\n  var xAxisId = selectXAxisIdFromGraphicalItemId(state, id);\n  if (xAxisId == null) {\n    return undefined;\n  }\n  return selectAxisWithScale(state, 'xAxis', xAxisId, isPanorama);\n};\nvar selectYAxisWithScale = (state, id, isPanorama) => {\n  var yAxisId = selectYAxisIdFromGraphicalItemId(state, id);\n  if (yAxisId == null) {\n    return undefined;\n  }\n  return selectAxisWithScale(state, 'yAxis', yAxisId, isPanorama);\n};\nvar selectXAxisTicks = (state, id, isPanorama) => {\n  var xAxisId = selectXAxisIdFromGraphicalItemId(state, id);\n  if (xAxisId == null) {\n    return undefined;\n  }\n  return selectTicksOfGraphicalItem(state, 'xAxis', xAxisId, isPanorama);\n};\nvar selectYAxisTicks = (state, id, isPanorama) => {\n  var yAxisId = selectYAxisIdFromGraphicalItemId(state, id);\n  if (yAxisId == null) {\n    return undefined;\n  }\n  return selectTicksOfGraphicalItem(state, 'yAxis', yAxisId, isPanorama);\n};\nexport var selectBarPosition = createSelector([selectAllBarPositions, selectSynchronisedBarSettings], (allBarPositions, barSettings) => {\n  if (allBarPositions == null || barSettings == null) {\n    return undefined;\n  }\n  var position = allBarPositions.find(p => p.stackId === barSettings.stackId && barSettings.dataKey != null && p.dataKeys.includes(barSettings.dataKey));\n  if (position == null) {\n    return undefined;\n  }\n  return position.position;\n});\nvar selectStackedDataOfItem = createSelector([selectBarStackGroups, selectSynchronisedBarSettings], combineStackedData);\nexport var selectBarRectangles = createSelector([selectChartOffsetInternal, selectAxisViewBox, selectXAxisWithScale, selectYAxisWithScale, selectXAxisTicks, selectYAxisTicks, selectBarPosition, selectChartLayout, selectChartDataWithIndexesIfNotInPanoramaPosition3, selectAxisBandSize, selectStackedDataOfItem, selectSynchronisedBarSettings, pickCells], (offset, axisViewBox, xAxis, yAxis, xAxisTicks, yAxisTicks, pos, layout, _ref2, bandSize, stackedData, barSettings, cells) => {\n  var {\n    chartData,\n    dataStartIndex,\n    dataEndIndex\n  } = _ref2;\n  if (barSettings == null || pos == null || axisViewBox == null || layout !== 'horizontal' && layout !== 'vertical' || xAxis == null || yAxis == null || xAxisTicks == null || yAxisTicks == null || bandSize == null) {\n    return undefined;\n  }\n  var {\n    data\n  } = barSettings;\n  var displayedData;\n  if (data != null && data.length > 0) {\n    displayedData = data;\n  } else {\n    displayedData = chartData === null || chartData === void 0 ? void 0 : chartData.slice(dataStartIndex, dataEndIndex + 1);\n  }\n  if (displayedData == null) {\n    return undefined;\n  }\n  return computeBarRectangles({\n    layout,\n    barSettings,\n    pos,\n    parentViewBox: axisViewBox,\n    bandSize,\n    xAxis,\n    yAxis,\n    xAxisTicks,\n    yAxisTicks,\n    stackedData,\n    displayedData,\n    offset,\n    cells,\n    dataStartIndex\n  });\n});","var _excluded = [\"index\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\nimport * as React from 'react';\nimport { createContext, useContext, useMemo } from 'react';\nimport { getNormalizedStackId } from '../util/ChartUtils';\nimport { useUniqueId } from '../util/useUniqueId';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nimport { useAppSelector } from '../state/hooks';\nimport { selectStackRects } from '../state/selectors/barStackSelectors';\nimport { useIsPanorama } from '../context/PanoramaContext';\nimport { Layer } from '../container/Layer';\nimport { Rectangle } from '../index';\nimport { propsAreEqual } from '../util/propsAreEqual';\nvar BarStackContext = /*#__PURE__*/createContext(undefined);\n\n/**\n * Hook to resolve the stack ID for a Bar component.\n * If a stack ID is provided via props, it is used directly.\n * Otherwise, this will read stack ID from BarStack context if available.\n * If both are undefined, it returns undefined.\n * @param childStackId\n */\nexport var useStackId = childStackId => {\n  var stackSettings = useContext(BarStackContext);\n  if (stackSettings != null) {\n    return stackSettings.stackId;\n  }\n  if (childStackId == null) {\n    return undefined;\n  }\n  return getNormalizedStackId(childStackId);\n};\nexport var defaultBarStackProps = {\n  radius: 0\n};\nvar getClipPathId = (stackId, index) => {\n  return \"recharts-bar-stack-clip-path-\".concat(stackId, \"-\").concat(index);\n};\nexport var useBarStackClipPathUrl = index => {\n  var barStackContext = useContext(BarStackContext);\n  if (barStackContext == null) {\n    return undefined;\n  }\n  var {\n    stackId\n  } = barStackContext;\n  return \"url(#\".concat(getClipPathId(stackId, index), \")\");\n};\nexport var BarStackClipLayer = _ref => {\n  var {\n      index\n    } = _ref,\n    rest = _objectWithoutProperties(_ref, _excluded);\n  var clipPathUrl = useBarStackClipPathUrl(index);\n  return /*#__PURE__*/React.createElement(Layer, _extends({\n    className: \"recharts-bar-stack-layer\",\n    clipPath: clipPathUrl\n  }, rest));\n};\n\n/**\n * This React component will render a clipPath that the individual bars in the stack will reference\n * to achieve rounded corners for the entire stack.\n */\nvar BarStackClipPath = _ref2 => {\n  var {\n    stackId,\n    radius\n  } = _ref2;\n  var isPanorama = useIsPanorama();\n  var positions = useAppSelector(state => selectStackRects(state, stackId, isPanorama));\n  if (positions == null || positions.length === 0) {\n    return null;\n  }\n  /*\n   * Render one clipPath per rectangle in the stack.\n   * Each rectangle corresponds to one data entry in the chart.\n   */\n  return /*#__PURE__*/React.createElement(\"defs\", null, positions.map((pos, index) => {\n    if (pos == null) {\n      return null;\n    }\n    var clipPathId = getClipPathId(stackId, index);\n    return /*#__PURE__*/React.createElement(\"clipPath\", {\n      key: clipPathId,\n      id: clipPathId\n    }, /*#__PURE__*/React.createElement(Rectangle, {\n      isAnimationActive: false,\n      isUpdateAnimationActive: false,\n      x: pos.x,\n      y: pos.y,\n      width: pos.width,\n      height: pos.height,\n      radius: radius\n    }));\n  }));\n};\nvar BarStackImpl = props => {\n  var resolvedStackId = useUniqueId('recharts-bar-stack', getNormalizedStackId(props.stackId));\n  var {\n    children,\n    radius\n  } = resolveDefaultProps(props, defaultBarStackProps);\n  var context = useMemo(() => ({\n    stackId: resolvedStackId,\n    radius\n  }), [resolvedStackId, radius]);\n  return /*#__PURE__*/React.createElement(BarStackContext.Provider, {\n    value: context\n  }, /*#__PURE__*/React.createElement(BarStackClipPath, {\n    stackId: resolvedStackId,\n    radius: radius\n  }), children);\n};\n\n/**\n * @provides BarStackContext\n * @since 3.6\n */\nexport var BarStack = /*#__PURE__*/React.memo(BarStackImpl, propsAreEqual);","var _excluded = [\"onMouseEnter\", \"onMouseLeave\", \"onClick\"],\n  _excluded2 = [\"value\", \"background\", \"tooltipPosition\"],\n  _excluded3 = [\"id\"],\n  _excluded4 = [\"onMouseEnter\", \"onClick\", \"onMouseLeave\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\nimport * as React from 'react';\nimport { PureComponent, useCallback, useRef, useState } from 'react';\nimport { clsx } from 'clsx';\nimport { Layer } from '../container/Layer';\nimport { Cell } from '../component/Cell';\nimport { CartesianLabelListContextProvider, LabelListFromLabelProp } from '../component/LabelList';\nimport { interpolate, isNan, mathSign } from '../util/DataUtils';\nimport { findAllByType } from '../util/ReactUtils';\nimport { getBaseValueOfBar, getCateCoordinateOfBar, getTooltipNameProp, getValueByDataKey, truncateByDomain } from '../util/ChartUtils';\nimport { adaptEventsOfChild } from '../util/types';\nimport { BarRectangle, minPointSizeCallback } from '../util/BarUtils';\nimport { useMouseClickItemDispatch, useMouseEnterItemDispatch, useMouseLeaveItemDispatch } from '../context/tooltipContext';\nimport { SetTooltipEntrySettings } from '../state/SetTooltipEntrySettings';\nimport { SetErrorBarContext } from '../context/ErrorBarContext';\nimport { GraphicalItemClipPath, useNeedsClip } from './GraphicalItemClipPath';\nimport { useChartLayout } from '../context/chartLayoutContext';\nimport { selectBarRectangles } from '../state/selectors/barSelectors';\nimport { useAppSelector } from '../state/hooks';\nimport { useIsPanorama } from '../context/PanoramaContext';\nimport { selectActiveTooltipDataKey, selectActiveTooltipIndex } from '../state/selectors/tooltipSelectors';\nimport { SetLegendPayload } from '../state/SetLegendPayload';\nimport { useAnimationId } from '../util/useAnimationId';\nimport { resolveDefaultProps } from '../util/resolveDefaultProps';\nimport { RegisterGraphicalItemId } from '../context/RegisterGraphicalItemId';\nimport { SetCartesianGraphicalItem } from '../state/SetGraphicalItem';\nimport { svgPropertiesNoEvents, svgPropertiesNoEventsFromUnknown } from '../util/svgPropertiesNoEvents';\nimport { JavascriptAnimate } from '../animation/JavascriptAnimate';\nimport { ZIndexLayer } from '../zIndex/ZIndexLayer';\nimport { DefaultZIndexes } from '../zIndex/DefaultZIndexes';\nimport { getZIndexFromUnknown } from '../zIndex/getZIndexFromUnknown';\nimport { propsAreEqual } from '../util/propsAreEqual';\nimport { BarStackClipLayer, useStackId } from './BarStack';\nvar computeLegendPayloadFromBarData = props => {\n  var {\n    dataKey,\n    name,\n    fill,\n    legendType,\n    hide\n  } = props;\n  return [{\n    inactive: hide,\n    dataKey,\n    type: legendType,\n    color: fill,\n    value: getTooltipNameProp(name, dataKey),\n    payload: props\n  }];\n};\nvar SetBarTooltipEntrySettings = /*#__PURE__*/React.memo(_ref => {\n  var {\n    dataKey,\n    stroke,\n    strokeWidth,\n    fill,\n    name,\n    hide,\n    unit,\n    tooltipType,\n    id\n  } = _ref;\n  var tooltipEntrySettings = {\n    dataDefinedOnItem: undefined,\n    positions: undefined,\n    settings: {\n      stroke,\n      strokeWidth,\n      fill,\n      dataKey,\n      nameKey: undefined,\n      name: getTooltipNameProp(name, dataKey),\n      hide,\n      type: tooltipType,\n      color: fill,\n      unit,\n      graphicalItemId: id\n    }\n  };\n  return /*#__PURE__*/React.createElement(SetTooltipEntrySettings, {\n    tooltipEntrySettings: tooltipEntrySettings\n  });\n});\nfunction BarBackground(props) {\n  var activeIndex = useAppSelector(selectActiveTooltipIndex);\n  var {\n    data,\n    dataKey,\n    background: backgroundFromProps,\n    allOtherBarProps\n  } = props;\n  var {\n      onMouseEnter: onMouseEnterFromProps,\n      onMouseLeave: onMouseLeaveFromProps,\n      onClick: onItemClickFromProps\n    } = allOtherBarProps,\n    restOfAllOtherProps = _objectWithoutProperties(allOtherBarProps, _excluded);\n\n  // @ts-expect-error bar mouse events are not compatible with recharts mouse events\n  var onMouseEnterFromContext = useMouseEnterItemDispatch(onMouseEnterFromProps, dataKey, allOtherBarProps.id);\n  // @ts-expect-error bar mouse events are not compatible with recharts mouse events\n  var onMouseLeaveFromContext = useMouseLeaveItemDispatch(onMouseLeaveFromProps);\n  // @ts-expect-error bar mouse events are not compatible with recharts mouse events\n  var onClickFromContext = useMouseClickItemDispatch(onItemClickFromProps, dataKey, allOtherBarProps.id);\n  if (!backgroundFromProps || data == null) {\n    return null;\n  }\n  var backgroundProps = svgPropertiesNoEventsFromUnknown(backgroundFromProps);\n  return /*#__PURE__*/React.createElement(ZIndexLayer, {\n    zIndex: getZIndexFromUnknown(backgroundFromProps, DefaultZIndexes.barBackground)\n  }, data.map((entry, i) => {\n    var {\n        value,\n        background: backgroundFromDataEntry,\n        tooltipPosition\n      } = entry,\n      rest = _objectWithoutProperties(entry, _excluded2);\n    if (!backgroundFromDataEntry) {\n      return null;\n    }\n\n    // @ts-expect-error BarRectangleItem type definition says it's missing properties, but I can see them present in debugger!\n    var onMouseEnter = onMouseEnterFromContext(entry, i);\n    // @ts-expect-error BarRectangleItem type definition says it's missing properties, but I can see them present in debugger!\n    var onMouseLeave = onMouseLeaveFromContext(entry, i);\n    // @ts-expect-error BarRectangleItem type definition says it's missing properties, but I can see them present in debugger!\n    var onClick = onClickFromContext(entry, i);\n    var barRectangleProps = _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({\n      option: backgroundFromProps,\n      isActive: String(i) === activeIndex\n    }, rest), {}, {\n      // @ts-expect-error backgroundProps is contributing unknown props\n      fill: '#eee'\n    }, backgroundFromDataEntry), backgroundProps), adaptEventsOfChild(restOfAllOtherProps, entry, i)), {}, {\n      onMouseEnter,\n      onMouseLeave,\n      onClick,\n      dataKey,\n      index: i,\n      className: 'recharts-bar-background-rectangle'\n    });\n    return /*#__PURE__*/React.createElement(BarRectangle, _extends({\n      key: \"background-bar-\".concat(i)\n    }, barRectangleProps));\n  }));\n}\nfunction BarLabelListProvider(_ref2) {\n  var {\n    showLabels,\n    children,\n    rects\n  } = _ref2;\n  var labelListEntries = rects === null || rects === void 0 ? void 0 : rects.map(entry => {\n    var viewBox = {\n      x: entry.x,\n      y: entry.y,\n      width: entry.width,\n      lowerWidth: entry.width,\n      upperWidth: entry.width,\n      height: entry.height\n    };\n    return _objectSpread(_objectSpread({}, viewBox), {}, {\n      value: entry.value,\n      payload: entry.payload,\n      parentViewBox: entry.parentViewBox,\n      viewBox,\n      fill: entry.fill\n    });\n  });\n  return /*#__PURE__*/React.createElement(CartesianLabelListContextProvider, {\n    value: showLabels ? labelListEntries : undefined\n  }, children);\n}\nfunction BarRectangleWithActiveState(props) {\n  var {\n    shape,\n    activeBar,\n    baseProps,\n    entry,\n    index,\n    dataKey\n  } = props;\n  var activeIndex = useAppSelector(selectActiveTooltipIndex);\n  var activeDataKey = useAppSelector(selectActiveTooltipDataKey);\n  /*\n   * Bars support stacking, meaning that there can be multiple bars at the same x value.\n   * With Tooltip shared=false we only want to highlight the currently active Bar, not all.\n   *\n   * Also, if the tooltip is shared, we want to highlight all bars at the same x value\n   * regardless of the dataKey.\n   *\n   * With shared Tooltip, the activeDataKey is undefined.\n   */\n  var isActive = activeBar && String(index) === activeIndex && (activeDataKey == null || dataKey === activeDataKey);\n  var option = isActive ? activeBar : shape;\n  if (isActive) {\n    return /*#__PURE__*/React.createElement(ZIndexLayer, {\n      zIndex: DefaultZIndexes.activeBar\n    }, /*#__PURE__*/React.createElement(BarRectangle, _extends({}, baseProps, {\n      name: String(baseProps.name)\n    }, entry, {\n      isActive: isActive,\n      option: option,\n      index: index,\n      dataKey: dataKey\n    })));\n  }\n  return /*#__PURE__*/React.createElement(BarRectangle, _extends({}, baseProps, {\n    name: String(baseProps.name)\n  }, entry, {\n    isActive: isActive,\n    option: option,\n    index: index,\n    dataKey: dataKey\n  }));\n}\nfunction BarRectangleNeverActive(props) {\n  var {\n    shape,\n    baseProps,\n    entry,\n    index,\n    dataKey\n  } = props;\n  return /*#__PURE__*/React.createElement(BarRectangle, _extends({}, baseProps, {\n    name: String(baseProps.name)\n  }, entry, {\n    isActive: false,\n    option: shape,\n    index: index,\n    dataKey: dataKey\n  }));\n}\nfunction BarRectangles(_ref3) {\n  var _svgPropertiesNoEvent;\n  var {\n    data,\n    props\n  } = _ref3;\n  var _ref4 = (_svgPropertiesNoEvent = svgPropertiesNoEvents(props)) !== null && _svgPropertiesNoEvent !== void 0 ? _svgPropertiesNoEvent : {},\n    {\n      id\n    } = _ref4,\n    baseProps = _objectWithoutProperties(_ref4, _excluded3);\n  var {\n    shape,\n    dataKey,\n    activeBar\n  } = props;\n  var {\n      onMouseEnter: onMouseEnterFromProps,\n      onClick: onItemClickFromProps,\n      onMouseLeave: onMouseLeaveFromProps\n    } = props,\n    restOfAllOtherProps = _objectWithoutProperties(props, _excluded4);\n\n  // @ts-expect-error bar mouse events are not compatible with recharts mouse events\n  var onMouseEnterFromContext = useMouseEnterItemDispatch(onMouseEnterFromProps, dataKey, id);\n  // @ts-expect-error bar mouse events are not compatible with recharts mouse events\n  var onMouseLeaveFromContext = useMouseLeaveItemDispatch(onMouseLeaveFromProps);\n  // @ts-expect-error bar mouse events are not compatible with recharts mouse events\n  var onClickFromContext = useMouseClickItemDispatch(onItemClickFromProps, dataKey, id);\n  if (!data) {\n    return null;\n  }\n  return /*#__PURE__*/React.createElement(React.Fragment, null, data.map((entry, i) => {\n    return /*#__PURE__*/React.createElement(BarStackClipLayer, _extends({\n      index: i\n      // https://github.com/recharts/recharts/issues/5415\n      ,\n      key: \"rectangle-\".concat(entry === null || entry === void 0 ? void 0 : entry.x, \"-\").concat(entry === null || entry === void 0 ? void 0 : entry.y, \"-\").concat(entry === null || entry === void 0 ? void 0 : entry.value, \"-\").concat(i),\n      className: \"recharts-bar-rectangle\"\n    }, adaptEventsOfChild(restOfAllOtherProps, entry, i), {\n      // @ts-expect-error BarRectangleItem type definition says it's missing properties, but I can see them present in debugger!\n      onMouseEnter: onMouseEnterFromContext(entry, i)\n      // @ts-expect-error BarRectangleItem type definition says it's missing properties, but I can see them present in debugger!\n      ,\n      onMouseLeave: onMouseLeaveFromContext(entry, i)\n      // @ts-expect-error BarRectangleItem type definition says it's missing properties, but I can see them present in debugger!\n      ,\n      onClick: onClickFromContext(entry, i)\n    }), activeBar ? /*#__PURE__*/React.createElement(BarRectangleWithActiveState, {\n      shape: shape,\n      activeBar: activeBar,\n      baseProps: baseProps,\n      entry: entry,\n      index: i,\n      dataKey: dataKey\n    }) :\n    /*#__PURE__*/\n    /*\n     * If the `activeBar` prop is falsy, then let's call the variant without hooks.\n     * Using the `selectActiveTooltipIndex` selector is usually fast\n     * but in charts with large-ish amount of data even the few nanoseconds add up to a noticeable jank.\n     * If the activeBar is false then we don't need to know which index is active - because we won't use it anyway.\n     * So let's just skip the hooks altogether. That way, React can skip rendering the component,\n     * and can skip the tree reconciliation for its children too.\n     * Because we can't call hooks conditionally, we need to have a separate component for that.\n     */\n    React.createElement(BarRectangleNeverActive, {\n      shape: shape,\n      baseProps: baseProps,\n      entry: entry,\n      index: i,\n      dataKey: dataKey\n    }));\n  }));\n}\nfunction RectanglesWithAnimation(_ref5) {\n  var {\n    props,\n    previousRectanglesRef\n  } = _ref5;\n  var {\n    data,\n    layout,\n    isAnimationActive,\n    animationBegin,\n    animationDuration,\n    animationEasing,\n    onAnimationEnd,\n    onAnimationStart\n  } = props;\n  var prevData = previousRectanglesRef.current;\n  var animationId = useAnimationId(props, 'recharts-bar-');\n  var [isAnimating, setIsAnimating] = useState(false);\n  var showLabels = !isAnimating;\n  var handleAnimationEnd = useCallback(() => {\n    if (typeof onAnimationEnd === 'function') {\n      onAnimationEnd();\n    }\n    setIsAnimating(false);\n  }, [onAnimationEnd]);\n  var handleAnimationStart = useCallback(() => {\n    if (typeof onAnimationStart === 'function') {\n      onAnimationStart();\n    }\n    setIsAnimating(true);\n  }, [onAnimationStart]);\n  return /*#__PURE__*/React.createElement(BarLabelListProvider, {\n    showLabels: showLabels,\n    rects: data\n  }, /*#__PURE__*/React.createElement(JavascriptAnimate, {\n    animationId: animationId,\n    begin: animationBegin,\n    duration: animationDuration,\n    isActive: isAnimationActive,\n    easing: animationEasing,\n    onAnimationEnd: handleAnimationEnd,\n    onAnimationStart: handleAnimationStart,\n    key: animationId\n  }, t => {\n    var stepData = t === 1 ? data : data === null || data === void 0 ? void 0 : data.map((entry, index) => {\n      var prev = prevData && prevData[index];\n      if (prev) {\n        return _objectSpread(_objectSpread({}, entry), {}, {\n          x: interpolate(prev.x, entry.x, t),\n          y: interpolate(prev.y, entry.y, t),\n          width: interpolate(prev.width, entry.width, t),\n          height: interpolate(prev.height, entry.height, t)\n        });\n      }\n      if (layout === 'horizontal') {\n        var height = interpolate(0, entry.height, t);\n        var y = interpolate(entry.stackedBarStart, entry.y, t);\n        return _objectSpread(_objectSpread({}, entry), {}, {\n          y,\n          height\n        });\n      }\n      var w = interpolate(0, entry.width, t);\n      var x = interpolate(entry.stackedBarStart, entry.x, t);\n      return _objectSpread(_objectSpread({}, entry), {}, {\n        width: w,\n        x\n      });\n    });\n    if (t > 0) {\n      // eslint-disable-next-line no-param-reassign\n      previousRectanglesRef.current = stepData !== null && stepData !== void 0 ? stepData : null;\n    }\n    if (stepData == null) {\n      return null;\n    }\n    return /*#__PURE__*/React.createElement(Layer, null, /*#__PURE__*/React.createElement(BarRectangles, {\n      props: props,\n      data: stepData\n    }));\n  }), /*#__PURE__*/React.createElement(LabelListFromLabelProp, {\n    label: props.label\n  }), props.children);\n}\nfunction RenderRectangles(props) {\n  var previousRectanglesRef = useRef(null);\n  return /*#__PURE__*/React.createElement(RectanglesWithAnimation, {\n    previousRectanglesRef: previousRectanglesRef,\n    props: props\n  });\n}\nvar defaultMinPointSize = 0;\nvar errorBarDataPointFormatter = (dataPoint, dataKey) => {\n  /**\n   * if the value coming from `selectBarRectangles` is an array then this is a stacked bar chart.\n   * arr[1] represents end value of the bar since the data is in the form of [startValue, endValue].\n   * */\n  var value = Array.isArray(dataPoint.value) ? dataPoint.value[1] : dataPoint.value;\n  return {\n    x: dataPoint.x,\n    y: dataPoint.y,\n    value,\n    // @ts-expect-error getValueByDataKey does not validate the output type\n    errorVal: getValueByDataKey(dataPoint, dataKey)\n  };\n};\nclass BarWithState extends PureComponent {\n  render() {\n    var {\n      hide,\n      data,\n      dataKey,\n      className,\n      xAxisId,\n      yAxisId,\n      needClip,\n      background,\n      id\n    } = this.props;\n    if (hide || data == null) {\n      return null;\n    }\n    var layerClass = clsx('recharts-bar', className);\n    var clipPathId = id;\n    return /*#__PURE__*/React.createElement(Layer, {\n      className: layerClass,\n      id: id\n    }, needClip && /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(GraphicalItemClipPath, {\n      clipPathId: clipPathId,\n      xAxisId: xAxisId,\n      yAxisId: yAxisId\n    })), /*#__PURE__*/React.createElement(Layer, {\n      className: \"recharts-bar-rectangles\",\n      clipPath: needClip ? \"url(#clipPath-\".concat(clipPathId, \")\") : undefined\n    }, /*#__PURE__*/React.createElement(BarBackground, {\n      data: data,\n      dataKey: dataKey,\n      background: background,\n      allOtherBarProps: this.props\n    }), /*#__PURE__*/React.createElement(RenderRectangles, this.props)));\n  }\n}\nexport var defaultBarProps = {\n  activeBar: false,\n  animationBegin: 0,\n  animationDuration: 400,\n  animationEasing: 'ease',\n  background: false,\n  hide: false,\n  isAnimationActive: 'auto',\n  label: false,\n  legendType: 'rect',\n  minPointSize: defaultMinPointSize,\n  xAxisId: 0,\n  yAxisId: 0,\n  zIndex: DefaultZIndexes.bar\n};\nfunction BarImpl(props) {\n  var {\n    xAxisId,\n    yAxisId,\n    hide,\n    legendType,\n    minPointSize,\n    activeBar,\n    animationBegin,\n    animationDuration,\n    animationEasing,\n    isAnimationActive\n  } = props;\n  var {\n    needClip\n  } = useNeedsClip(xAxisId, yAxisId);\n  var layout = useChartLayout();\n  var isPanorama = useIsPanorama();\n  var cells = findAllByType(props.children, Cell);\n  var rects = useAppSelector(state => selectBarRectangles(state, props.id, isPanorama, cells));\n  if (layout !== 'vertical' && layout !== 'horizontal') {\n    return null;\n  }\n  var errorBarOffset;\n  var firstDataPoint = rects === null || rects === void 0 ? void 0 : rects[0];\n  if (firstDataPoint == null || firstDataPoint.height == null || firstDataPoint.width == null) {\n    errorBarOffset = 0;\n  } else {\n    errorBarOffset = layout === 'vertical' ? firstDataPoint.height / 2 : firstDataPoint.width / 2;\n  }\n  return /*#__PURE__*/React.createElement(SetErrorBarContext, {\n    xAxisId: xAxisId,\n    yAxisId: yAxisId,\n    data: rects,\n    dataPointFormatter: errorBarDataPointFormatter,\n    errorBarOffset: errorBarOffset\n  }, /*#__PURE__*/React.createElement(BarWithState, _extends({}, props, {\n    layout: layout,\n    needClip: needClip,\n    data: rects,\n    xAxisId: xAxisId,\n    yAxisId: yAxisId,\n    hide: hide,\n    legendType: legendType,\n    minPointSize: minPointSize,\n    activeBar: activeBar,\n    animationBegin: animationBegin,\n    animationDuration: animationDuration,\n    animationEasing: animationEasing,\n    isAnimationActive: isAnimationActive\n  })));\n}\nexport function computeBarRectangles(_ref6) {\n  var {\n    layout,\n    barSettings: {\n      dataKey,\n      minPointSize: minPointSizeProp\n    },\n    pos,\n    bandSize,\n    xAxis,\n    yAxis,\n    xAxisTicks,\n    yAxisTicks,\n    stackedData,\n    displayedData,\n    offset,\n    cells,\n    parentViewBox,\n    dataStartIndex\n  } = _ref6;\n  var numericAxis = layout === 'horizontal' ? yAxis : xAxis;\n  // @ts-expect-error this assumes that the domain is always numeric, but doesn't check for it\n  var stackedDomain = stackedData ? numericAxis.scale.domain() : null;\n  var baseValue = getBaseValueOfBar({\n    numericAxis\n  });\n  var stackedBarStart = numericAxis.scale(baseValue);\n  return displayedData.map((entry, index) => {\n    var value, x, y, width, height, background;\n    if (stackedData) {\n      // Use dataStartIndex to access the correct element in the full stackedData array\n      var untruncatedValue = stackedData[index + dataStartIndex];\n      if (untruncatedValue == null) {\n        return null;\n      }\n      value = truncateByDomain(untruncatedValue, stackedDomain);\n    } else {\n      value = getValueByDataKey(entry, dataKey);\n      if (!Array.isArray(value)) {\n        value = [baseValue, value];\n      }\n    }\n    var minPointSize = minPointSizeCallback(minPointSizeProp, defaultMinPointSize)(value[1], index);\n    if (layout === 'horizontal') {\n      var _ref7;\n      var [baseValueScale, currentValueScale] = [yAxis.scale(value[0]), yAxis.scale(value[1])];\n      x = getCateCoordinateOfBar({\n        axis: xAxis,\n        ticks: xAxisTicks,\n        bandSize,\n        offset: pos.offset,\n        entry,\n        index\n      });\n      y = (_ref7 = currentValueScale !== null && currentValueScale !== void 0 ? currentValueScale : baseValueScale) !== null && _ref7 !== void 0 ? _ref7 : undefined;\n      width = pos.size;\n      var computedHeight = baseValueScale - currentValueScale;\n      height = isNan(computedHeight) ? 0 : computedHeight;\n      background = {\n        x,\n        y: offset.top,\n        width,\n        height: offset.height\n      };\n      if (Math.abs(minPointSize) > 0 && Math.abs(height) < Math.abs(minPointSize)) {\n        var delta = mathSign(height || minPointSize) * (Math.abs(minPointSize) - Math.abs(height));\n        y -= delta;\n        height += delta;\n      }\n    } else {\n      var [_baseValueScale, _currentValueScale] = [xAxis.scale(value[0]), xAxis.scale(value[1])];\n      x = _baseValueScale;\n      y = getCateCoordinateOfBar({\n        axis: yAxis,\n        ticks: yAxisTicks,\n        bandSize,\n        offset: pos.offset,\n        entry,\n        index\n      });\n      width = _currentValueScale - _baseValueScale;\n      height = pos.size;\n      background = {\n        x: offset.left,\n        y,\n        width: offset.width,\n        height\n      };\n      if (Math.abs(minPointSize) > 0 && Math.abs(width) < Math.abs(minPointSize)) {\n        var _delta = mathSign(width || minPointSize) * (Math.abs(minPointSize) - Math.abs(width));\n        width += _delta;\n      }\n    }\n    if (x == null || y == null || width == null || height == null) {\n      return null;\n    }\n    var barRectangleItem = _objectSpread(_objectSpread({}, entry), {}, {\n      stackedBarStart,\n      x,\n      y,\n      width,\n      height,\n      value: stackedData ? value : value[1],\n      payload: entry,\n      background,\n      tooltipPosition: {\n        x: x + width / 2,\n        y: y + height / 2\n      },\n      parentViewBox\n    }, cells && cells[index] && cells[index].props);\n    return barRectangleItem;\n  }).filter(Boolean);\n}\nfunction BarFn(outsideProps) {\n  var props = resolveDefaultProps(outsideProps, defaultBarProps);\n  // stackId may arrive from props or from BarStack context\n  var stackId = useStackId(props.stackId);\n  var isPanorama = useIsPanorama();\n  // Report all props to Redux store first, before calling any hooks, to avoid circular dependencies.\n  return /*#__PURE__*/React.createElement(RegisterGraphicalItemId, {\n    id: props.id,\n    type: \"bar\"\n  }, id => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(SetLegendPayload, {\n    legendPayload: computeLegendPayloadFromBarData(props)\n  }), /*#__PURE__*/React.createElement(SetBarTooltipEntrySettings, {\n    dataKey: props.dataKey,\n    stroke: props.stroke,\n    strokeWidth: props.strokeWidth,\n    fill: props.fill,\n    name: props.name,\n    hide: props.hide,\n    unit: props.unit,\n    tooltipType: props.tooltipType,\n    id: id\n  }), /*#__PURE__*/React.createElement(SetCartesianGraphicalItem, {\n    type: \"bar\",\n    id: id\n    // Bar does not allow setting data directly on the graphical item (why?)\n    ,\n    data: undefined,\n    xAxisId: props.xAxisId,\n    yAxisId: props.yAxisId,\n    zAxisId: 0,\n    dataKey: props.dataKey,\n    stackId: stackId,\n    hide: props.hide,\n    barSize: props.barSize,\n    minPointSize: props.minPointSize,\n    maxBarSize: props.maxBarSize,\n    isPanorama: isPanorama\n  }), /*#__PURE__*/React.createElement(ZIndexLayer, {\n    zIndex: props.zIndex\n  }, /*#__PURE__*/React.createElement(BarImpl, _extends({}, props, {\n    id: id\n  })))));\n}\n\n/**\n * @provides ErrorBarContext\n * @provides LabelListContext\n * @provides CellReader\n * @consumes CartesianChartContext\n * @consumes BarStackContext\n */\nexport var Bar = /*#__PURE__*/React.memo(BarFn, propsAreEqual);\nBar.displayName = 'Bar';","import * as React from 'react';\nimport { forwardRef } from 'react';\nimport { arrayTooltipSearcher } from '../state/optionsSlice';\nimport { CartesianChart } from './CartesianChart';\nvar allowedTooltipTypes = ['axis', 'item'];\n\n/**\n * @provides CartesianViewBoxContext\n * @provides CartesianChartContext\n */\nexport var BarChart = /*#__PURE__*/forwardRef((props, ref) => {\n  return /*#__PURE__*/React.createElement(CartesianChart, {\n    chartName: \"BarChart\",\n    defaultTooltipEventType: \"axis\",\n    validateTooltipEventTypes: allowedTooltipTypes,\n    tooltipPayloadSearcher: arrayTooltipSearcher,\n    categoricalChartProps: props,\n    ref: ref\n  });\n});","import { useMemo } from 'react'\nimport {\n  PieChart, Pie, Cell, ResponsiveContainer,\n  BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend,\n  AreaChart, Area\n} from 'recharts'\nimport {\n  ClipboardList, Clock, DollarSign, Users, TrendingUp,\n  CheckCircle, AlertCircle, XCircle, FileText\n} from 'lucide-react'\n\n/**\n * TMDashboard - Visual summary and charts for T&M Tickets section\n * Shows key metrics, status distribution, and trends\n */\nexport default function TMDashboard({ tickets = [], laborRates = {} }) {\n  // Calculate comprehensive metrics\n  const metrics = useMemo(() => {\n    if (!tickets.length) {\n      return {\n        total: 0,\n        pending: 0,\n        approved: 0,\n        billed: 0,\n        rejected: 0,\n        totalHours: 0,\n        regularHours: 0,\n        overtimeHours: 0,\n        materialsCost: 0,\n        uniqueWorkers: 0,\n        avgHoursPerTicket: 0,\n        approvalRate: 0,\n        pendingValue: 0,\n        approvedValue: 0,\n        billedValue: 0,\n        workersByRole: {},\n        topWorkers: [],\n        byMonth: [],\n        byStatus: []\n      }\n    }\n\n    // Status counts\n    const pending = tickets.filter(t => t.status === 'pending').length\n    const approved = tickets.filter(t => t.status === 'approved').length\n    const billed = tickets.filter(t => t.status === 'billed').length\n    const rejected = tickets.filter(t => t.status === 'rejected').length\n\n    // Hours calculations\n    let totalHours = 0\n    let regularHours = 0\n    let overtimeHours = 0\n    const workerHoursMap = {}\n    const workersByRole = { Foreman: 0, Superintendent: 0, Operator: 0, Laborer: 0 }\n\n    tickets.forEach(ticket => {\n      if (ticket.t_and_m_workers) {\n        ticket.t_and_m_workers.forEach(worker => {\n          const regHrs = parseFloat(worker.hours) || 0\n          const otHrs = parseFloat(worker.overtime_hours) || 0\n          regularHours += regHrs\n          overtimeHours += otHrs\n          totalHours += regHrs + otHrs\n\n          // Track worker hours\n          const name = worker.name || 'Unknown'\n          if (!workerHoursMap[name]) {\n            workerHoursMap[name] = { name, hours: 0, role: worker.role || 'Laborer' }\n          }\n          workerHoursMap[name].hours += regHrs + otHrs\n\n          // Count by role\n          const role = worker.role || 'Laborer'\n          if (workersByRole[role] !== undefined) {\n            workersByRole[role] += regHrs + otHrs\n          } else {\n            workersByRole[role] = regHrs + otHrs\n          }\n        })\n      }\n    })\n\n    // Materials cost calculation\n    let materialsCost = 0\n    tickets.forEach(ticket => {\n      if (ticket.t_and_m_items) {\n        ticket.t_and_m_items.forEach(item => {\n          const costPer = item.materials_equipment?.cost_per_unit || 0\n          materialsCost += item.quantity * costPer\n        })\n      }\n    })\n\n    // Unique workers\n    const uniqueWorkers = Object.keys(workerHoursMap).length\n\n    // Top 5 workers by hours\n    const topWorkers = Object.values(workerHoursMap)\n      .sort((a, b) => b.hours - a.hours)\n      .slice(0, 5)\n\n    // Approval rate\n    const completedTickets = approved + billed + rejected\n    const approvalRate = completedTickets > 0\n      ? Math.round(((approved + billed) / completedTickets) * 100)\n      : 0\n\n    // Value calculations (estimate labor cost using default rates if no rates provided)\n    const defaultRates = {\n      Foreman: 85,\n      Superintendent: 95,\n      Operator: 75,\n      Laborer: 55\n    }\n    const rates = { ...defaultRates, ...laborRates }\n\n    const calculateTicketValue = (ticket) => {\n      let laborCost = 0\n      let materialsCost = 0\n\n      if (ticket.t_and_m_workers) {\n        ticket.t_and_m_workers.forEach(worker => {\n          const role = worker.role || 'Laborer'\n          const rate = rates[role] || rates.Laborer\n          const regHrs = parseFloat(worker.hours) || 0\n          const otHrs = parseFloat(worker.overtime_hours) || 0\n          laborCost += regHrs * rate + otHrs * rate * 1.5\n        })\n      }\n\n      if (ticket.t_and_m_items) {\n        ticket.t_and_m_items.forEach(item => {\n          const costPer = item.materials_equipment?.cost_per_unit || 0\n          materialsCost += item.quantity * costPer\n        })\n      }\n\n      return laborCost + materialsCost\n    }\n\n    const pendingValue = tickets\n      .filter(t => t.status === 'pending')\n      .reduce((sum, t) => sum + calculateTicketValue(t), 0)\n    const approvedValue = tickets\n      .filter(t => t.status === 'approved')\n      .reduce((sum, t) => sum + calculateTicketValue(t), 0)\n    const billedValue = tickets\n      .filter(t => t.status === 'billed')\n      .reduce((sum, t) => sum + calculateTicketValue(t), 0)\n\n    // Monthly data for trend chart\n    const monthlyData = {}\n    tickets.forEach(ticket => {\n      const date = new Date(ticket.work_date)\n      const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`\n      const monthLabel = date.toLocaleDateString('en-US', { month: 'short', year: '2-digit' })\n\n      if (!monthlyData[monthKey]) {\n        monthlyData[monthKey] = {\n          month: monthLabel,\n          monthKey,\n          tickets: 0,\n          hours: 0,\n          cost: 0,\n          value: 0\n        }\n      }\n\n      monthlyData[monthKey].tickets += 1\n      monthlyData[monthKey].cost += calculateTicketValue(ticket) - materialsCost\n\n      if (ticket.t_and_m_workers) {\n        ticket.t_and_m_workers.forEach(worker => {\n          const regHrs = parseFloat(worker.hours) || 0\n          const otHrs = parseFloat(worker.overtime_hours) || 0\n          monthlyData[monthKey].hours += regHrs + otHrs\n        })\n      }\n\n      if (ticket.t_and_m_items) {\n        ticket.t_and_m_items.forEach(item => {\n          const costPer = item.materials_equipment?.cost_per_unit || 0\n          monthlyData[monthKey].value += item.quantity * costPer\n        })\n      }\n    })\n\n    const byMonth = Object.values(monthlyData)\n      .sort((a, b) => a.monthKey.localeCompare(b.monthKey))\n      .slice(-6) // Last 6 months\n\n    // Status distribution for pie chart\n    const byStatus = [\n      { name: 'Pending', value: pending, color: '#f59e0b' },\n      { name: 'Approved', value: approved, color: '#10b981' },\n      { name: 'Billed', value: billed, color: '#3b82f6' },\n      { name: 'Rejected', value: rejected, color: '#ef4444' }\n    ].filter(s => s.value > 0)\n\n    return {\n      total: tickets.length,\n      pending,\n      approved,\n      billed,\n      rejected,\n      totalHours,\n      regularHours,\n      overtimeHours,\n      materialsCost,\n      uniqueWorkers,\n      avgHoursPerTicket: tickets.length > 0 ? totalHours / tickets.length : 0,\n      approvalRate,\n      pendingValue,\n      approvedValue,\n      billedValue,\n      workersByRole,\n      topWorkers,\n      byMonth,\n      byStatus\n    }\n  }, [tickets, laborRates])\n\n  // Format currency\n  const formatCurrency = (value) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0\n    }).format(value)\n  }\n\n  // Custom tooltip for charts\n  const CustomTooltip = ({ active, payload, label }) => {\n    if (active && payload && payload.length) {\n      return (\n        <div className=\"tm-chart-tooltip\">\n          <p className=\"tm-tooltip-label\">{label}</p>\n          {payload.map((entry, index) => (\n            <p key={index} style={{ color: entry.color }}>\n              {entry.name}: {entry.name.includes('Cost') || entry.name.includes('Value')\n                ? formatCurrency(entry.value)\n                : entry.value.toFixed(1)}\n            </p>\n          ))}\n        </div>\n      )\n    }\n    return null\n  }\n\n  if (tickets.length === 0) {\n    return (\n      <div className=\"tm-dashboard tm-dashboard-empty\">\n        <div className=\"tm-empty-icon\">\n          <ClipboardList size={48} />\n        </div>\n        <p>No T&M tickets yet</p>\n        <p className=\"tm-empty-hint\">Create tickets to see analytics and trends</p>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"tm-dashboard\">\n      {/* Summary Cards Row */}\n      <div className=\"tm-summary-cards\">\n        <div className=\"tm-summary-card\">\n          <div className=\"tm-card-icon tickets\">\n            <ClipboardList size={20} />\n          </div>\n          <div className=\"tm-card-content\">\n            <span className=\"tm-card-value\">{metrics.total}</span>\n            <span className=\"tm-card-label\">Total Tickets</span>\n          </div>\n        </div>\n\n        <div className=\"tm-summary-card\">\n          <div className=\"tm-card-icon hours\">\n            <Clock size={20} />\n          </div>\n          <div className=\"tm-card-content\">\n            <span className=\"tm-card-value\">{metrics.totalHours.toFixed(1)}</span>\n            <span className=\"tm-card-label\">Total Hours</span>\n            {metrics.overtimeHours > 0 && (\n              <span className=\"tm-card-detail\">{metrics.overtimeHours.toFixed(1)} OT</span>\n            )}\n          </div>\n        </div>\n\n        <div className=\"tm-summary-card\">\n          <div className=\"tm-card-icon workers\">\n            <Users size={20} />\n          </div>\n          <div className=\"tm-card-content\">\n            <span className=\"tm-card-value\">{metrics.uniqueWorkers}</span>\n            <span className=\"tm-card-label\">Workers</span>\n          </div>\n        </div>\n\n        <div className=\"tm-summary-card\">\n          <div className=\"tm-card-icon materials\">\n            <DollarSign size={20} />\n          </div>\n          <div className=\"tm-card-content\">\n            <span className=\"tm-card-value\">{formatCurrency(metrics.materialsCost)}</span>\n            <span className=\"tm-card-label\">Materials</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Status Overview Cards */}\n      <div className=\"tm-status-cards\">\n        <div className=\"tm-status-card pending\">\n          <div className=\"tm-status-header\">\n            <AlertCircle size={16} />\n            <span>Pending</span>\n          </div>\n          <div className=\"tm-status-count\">{metrics.pending}</div>\n          <div className=\"tm-status-value\">{formatCurrency(metrics.pendingValue)}</div>\n        </div>\n\n        <div className=\"tm-status-card approved\">\n          <div className=\"tm-status-header\">\n            <CheckCircle size={16} />\n            <span>Approved</span>\n          </div>\n          <div className=\"tm-status-count\">{metrics.approved}</div>\n          <div className=\"tm-status-value\">{formatCurrency(metrics.approvedValue)}</div>\n        </div>\n\n        <div className=\"tm-status-card billed\">\n          <div className=\"tm-status-header\">\n            <FileText size={16} />\n            <span>Billed</span>\n          </div>\n          <div className=\"tm-status-count\">{metrics.billed}</div>\n          <div className=\"tm-status-value\">{formatCurrency(metrics.billedValue)}</div>\n        </div>\n\n        <div className=\"tm-status-card rate\">\n          <div className=\"tm-status-header\">\n            <TrendingUp size={16} />\n            <span>Approval Rate</span>\n          </div>\n          <div className=\"tm-status-count\">{metrics.approvalRate}%</div>\n          <div className=\"tm-status-value\">{metrics.approved + metrics.billed} / {metrics.total - metrics.pending}</div>\n        </div>\n      </div>\n\n      {/* Charts Row */}\n      <div className=\"tm-charts-row\">\n        {/* Status Distribution Pie Chart */}\n        {metrics.byStatus.length > 0 && (\n          <div className=\"tm-chart-card\">\n            <h4 className=\"tm-chart-title\">Status Distribution</h4>\n            <div className=\"tm-chart-container\">\n              <ResponsiveContainer width=\"100%\" height={200}>\n                <PieChart>\n                  <Pie\n                    data={metrics.byStatus}\n                    cx=\"50%\"\n                    cy=\"50%\"\n                    innerRadius={50}\n                    outerRadius={80}\n                    paddingAngle={2}\n                    dataKey=\"value\"\n                    label={({ name, percent }) => `${name} ${(percent * 100).toFixed(0)}%`}\n                    labelLine={false}\n                  >\n                    {metrics.byStatus.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={entry.color} />\n                    ))}\n                  </Pie>\n                  <Tooltip />\n                </PieChart>\n              </ResponsiveContainer>\n            </div>\n            <div className=\"tm-chart-legend\">\n              {metrics.byStatus.map((entry, index) => (\n                <div key={index} className=\"tm-legend-item\">\n                  <span className=\"tm-legend-color\" style={{ background: entry.color }} />\n                  <span className=\"tm-legend-label\">{entry.name}</span>\n                  <span className=\"tm-legend-value\">{entry.value}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Hours Trend Bar Chart */}\n        {metrics.byMonth.length > 0 && (\n          <div className=\"tm-chart-card wide\">\n            <h4 className=\"tm-chart-title\">Hours by Month</h4>\n            <div className=\"tm-chart-container\">\n              <ResponsiveContainer width=\"100%\" height={200}>\n                <BarChart data={metrics.byMonth}>\n                  <CartesianGrid strokeDasharray=\"3 3\" stroke=\"var(--border-color)\" />\n                  <XAxis\n                    dataKey=\"month\"\n                    tick={{ fill: 'var(--text-secondary)', fontSize: 12 }}\n                    axisLine={{ stroke: 'var(--border-color)' }}\n                  />\n                  <YAxis\n                    tick={{ fill: 'var(--text-secondary)', fontSize: 12 }}\n                    axisLine={{ stroke: 'var(--border-color)' }}\n                  />\n                  <Tooltip content={<CustomTooltip />} />\n                  <Bar\n                    dataKey=\"hours\"\n                    name=\"Hours\"\n                    fill=\"var(--primary-color)\"\n                    radius={[4, 4, 0, 0]}\n                  />\n                </BarChart>\n              </ResponsiveContainer>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Second Charts Row */}\n      <div className=\"tm-charts-row\">\n        {/* Labor by Role */}\n        <div className=\"tm-chart-card\">\n          <h4 className=\"tm-chart-title\">Hours by Role</h4>\n          <div className=\"tm-role-breakdown\">\n            {Object.entries(metrics.workersByRole)\n              .filter(([, hours]) => hours > 0)\n              .sort((a, b) => b[1] - a[1])\n              .map(([role, hours]) => {\n                const percentage = (hours / metrics.totalHours) * 100\n                return (\n                  <div key={role} className=\"tm-role-bar\">\n                    <div className=\"tm-role-info\">\n                      <span className=\"tm-role-name\">{role}</span>\n                      <span className=\"tm-role-hours\">{hours.toFixed(1)} hrs</span>\n                    </div>\n                    <div className=\"tm-role-track\">\n                      <div\n                        className=\"tm-role-fill\"\n                        style={{ width: `${percentage}%` }}\n                      />\n                    </div>\n                  </div>\n                )\n              })}\n          </div>\n        </div>\n\n        {/* Top Workers */}\n        {metrics.topWorkers.length > 0 && (\n          <div className=\"tm-chart-card\">\n            <h4 className=\"tm-chart-title\">Top Workers</h4>\n            <div className=\"tm-top-workers\">\n              {metrics.topWorkers.map((worker, index) => (\n                <div key={worker.name} className=\"tm-worker-row\">\n                  <span className=\"tm-worker-rank\">#{index + 1}</span>\n                  <div className=\"tm-worker-info\">\n                    <span className=\"tm-worker-name\">{worker.name}</span>\n                    <span className=\"tm-worker-role\">{worker.role}</span>\n                  </div>\n                  <span className=\"tm-worker-hours\">{worker.hours.toFixed(1)} hrs</span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Tickets Trend */}\n        {metrics.byMonth.length > 1 && (\n          <div className=\"tm-chart-card\">\n            <h4 className=\"tm-chart-title\">Ticket Volume</h4>\n            <div className=\"tm-chart-container\">\n              <ResponsiveContainer width=\"100%\" height={150}>\n                <AreaChart data={metrics.byMonth}>\n                  <defs>\n                    <linearGradient id=\"ticketGradient\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                      <stop offset=\"5%\" stopColor=\"var(--primary-color)\" stopOpacity={0.3}/>\n                      <stop offset=\"95%\" stopColor=\"var(--primary-color)\" stopOpacity={0}/>\n                    </linearGradient>\n                  </defs>\n                  <XAxis\n                    dataKey=\"month\"\n                    tick={{ fill: 'var(--text-secondary)', fontSize: 10 }}\n                    axisLine={false}\n                    tickLine={false}\n                  />\n                  <YAxis hide />\n                  <Tooltip content={<CustomTooltip />} />\n                  <Area\n                    type=\"monotone\"\n                    dataKey=\"tickets\"\n                    name=\"Tickets\"\n                    stroke=\"var(--primary-color)\"\n                    fill=\"url(#ticketGradient)\"\n                    strokeWidth={2}\n                  />\n                </AreaChart>\n              </ResponsiveContainer>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Quick Stats Footer */}\n      <div className=\"tm-quick-stats\">\n        <div className=\"tm-quick-stat\">\n          <span className=\"tm-quick-label\">Avg Hours/Ticket</span>\n          <span className=\"tm-quick-value\">{metrics.avgHoursPerTicket.toFixed(1)}</span>\n        </div>\n        <div className=\"tm-quick-stat\">\n          <span className=\"tm-quick-label\">Regular Hours</span>\n          <span className=\"tm-quick-value\">{metrics.regularHours.toFixed(1)}</span>\n        </div>\n        <div className=\"tm-quick-stat\">\n          <span className=\"tm-quick-label\">Overtime Hours</span>\n          <span className=\"tm-quick-value\">{metrics.overtimeHours.toFixed(1)}</span>\n        </div>\n        <div className=\"tm-quick-stat\">\n          <span className=\"tm-quick-label\">Total Est. Value</span>\n          <span className=\"tm-quick-value\">{formatCurrency(metrics.pendingValue + metrics.approvedValue + metrics.billedValue)}</span>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import { memo } from 'react'\nimport { HardHat, FileText, Wrench, Camera, Link, Lock, Link2, RefreshCw, AlertTriangle, CheckCircle } from 'lucide-react'\nimport { CountBadge } from '../ui'\n\n/**\n * Memoized T&M Ticket Card component\n * Prevents unnecessary re-renders when parent list updates\n */\nconst TMTicketCard = memo(function TMTicketCard({\n  ticket,\n  isExpanded,\n  isSelected,\n  isLocked,\n  lockInfo,\n  hasFailedImport,\n  isRetrying,\n  onToggleExpand,\n  onToggleSelect,\n  onApprove,\n  onUpdateStatus,\n  onDelete,\n  onOpenCorAssign,\n  onRetryImport,\n  onShowSignatureLink,\n  formatDate,\n  calculateTotalHours,\n  calculateTicketTotal\n}) {\n  const totalHours = calculateTotalHours(ticket)\n  const totalCost = calculateTicketTotal(ticket)\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Enter' || e.key === ' ') {\n      e.preventDefault()\n      onToggleExpand(ticket.id)\n    }\n  }\n\n  return (\n    <div\n      className={`tm-ticket-card hover-lift animate-fade-in-up ${ticket.status} ${isSelected ? 'selected' : ''} ${isLocked ? 'locked' : ''}`}\n      role=\"article\"\n      aria-label={`T&M Ticket for ${formatDate(ticket.work_date)}, ${totalHours} hours, $${totalCost.toFixed(2)}, status: ${ticket.status}`}\n    >\n      <div\n        className=\"tm-ticket-header\"\n        onClick={() => onToggleExpand(ticket.id)}\n        onKeyDown={handleKeyDown}\n        role=\"button\"\n        tabIndex={0}\n        aria-expanded={isExpanded}\n        aria-label={`${isExpanded ? 'Collapse' : 'Expand'} ticket details`}\n      >\n        <input\n          type=\"checkbox\"\n          checked={isSelected}\n          onChange={(e) => onToggleSelect(ticket.id, e)}\n          onClick={(e) => e.stopPropagation()}\n          className=\"tm-checkbox\"\n          aria-label={`Select ticket for ${formatDate(ticket.work_date)}`}\n        />\n        <div className=\"tm-ticket-info\">\n          <span className=\"tm-ticket-date\">{formatDate(ticket.work_date)}</span>\n          {ticket.ce_pco_number && (\n            <span className=\"tm-ce-badge\">{ticket.ce_pco_number}</span>\n          )}\n          {ticket.assigned_cor_id && lockInfo?.lockedBy && (\n            <span className={`tm-cor-badge ${isLocked ? 'locked' : ''}`} title={lockInfo?.reason}>\n              {isLocked && <Lock size={10} />}\n              {lockInfo.lockedBy.cor_number}\n            </span>\n          )}\n          {ticket.photos?.length > 0 && (\n            <CountBadge\n              count={ticket.photos.length}\n              icon={Camera}\n              size=\"small\"\n              variant=\"default\"\n            />\n          )}\n          {hasFailedImport && (\n            <span className=\"tm-import-failed-badge\" title=\"COR data import failed - retry needed\">\n              <AlertTriangle size={12} /> Import Failed\n            </span>\n          )}\n          {ticket.client_signature_data && (\n            <span className=\"tm-verified-badge\" title={`Verified by ${ticket.client_signature_name || 'client'}${ticket.client_signature_date ? ` on ${formatDate(ticket.client_signature_date)}` : ''}`}>\n              <CheckCircle size={12} /> Verified\n            </span>\n          )}\n          <span className={`tm-ticket-status ${ticket.status}`}>{ticket.status}</span>\n        </div>\n        <div className=\"tm-ticket-summary\">\n          <span className=\"tm-ticket-hours\">{totalHours} hrs</span>\n          <span className=\"tm-ticket-total\">${totalCost.toFixed(2)}</span>\n          <span className=\"tm-expand-arrow\" aria-hidden=\"true\">{isExpanded ? '' : ''}</span>\n        </div>\n      </div>\n\n      {isExpanded && (\n        <div className=\"tm-ticket-details\">\n          {ticket.t_and_m_workers?.length > 0 && (\n            <div className=\"tm-detail-section\">\n              <h4><HardHat size={16} className=\"inline-icon\" /> Workers</h4>\n              <div className=\"tm-detail-list\">\n                {ticket.t_and_m_workers.map(worker => (\n                  <div key={worker.id} className=\"tm-detail-row\">\n                    <span>\n                      {worker.role && worker.role !== 'Laborer' && (\n                        <span className=\"tm-role-badge\">{worker.role}</span>\n                      )}\n                      {worker.name}\n                    </span>\n                    <span>\n                      {worker.hours} hrs\n                      {parseFloat(worker.overtime_hours) > 0 && (\n                        <span className=\"tm-ot-badge\"> +{worker.overtime_hours} OT</span>\n                      )}\n                    </span>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {ticket.t_and_m_items?.length > 0 && (\n            <div className=\"tm-detail-section\">\n              <h4><Wrench size={16} className=\"inline-icon\" /> Materials & Equipment</h4>\n              <div className=\"tm-detail-list\">\n                {ticket.t_and_m_items.map(item => (\n                  <div key={item.id} className=\"tm-detail-row\">\n                    <span>\n                      {item.custom_name ? (\n                        <><span className=\"tm-custom-badge\">Custom</span> {item.custom_name}</>\n                      ) : (\n                        item.materials_equipment?.name\n                      )}\n                    </span>\n                    <span className=\"tm-detail-qty\">\n                      {item.quantity} {item.materials_equipment?.unit || 'each'}\n                      {item.materials_equipment?.cost_per_unit > 0 && (\n                        <span className=\"tm-item-cost\">\n                          ${(item.quantity * item.materials_equipment.cost_per_unit).toFixed(2)}\n                        </span>\n                      )}\n                    </span>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {ticket.notes && (\n            <div className=\"tm-detail-section\">\n              <h4><FileText size={16} className=\"inline-icon\" /> Description</h4>\n              <p className=\"tm-notes-text\">{ticket.notes}</p>\n            </div>\n          )}\n\n          {ticket.photos && ticket.photos.length > 0 && (\n            <div className=\"tm-detail-section\">\n              <h4><Camera size={16} className=\"inline-icon\" /> Photos ({ticket.photos.length})</h4>\n              <div className=\"tm-photos-grid\">\n                {ticket.photos.map((photo, idx) => (\n                  <a key={idx} href={photo} target=\"_blank\" rel=\"noopener noreferrer\" className=\"tm-photo-thumb\">\n                    <img\n                      src={photo}\n                      alt={`Photo ${idx + 1}`}\n                      onError={(e) => {\n                        e.target.onerror = null\n                        e.target.classList.add('photo-error')\n                        e.target.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5NGEzYjgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cmVjdCB4PSIzIiB5PSIzIiB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHJ4PSIyIiByeT0iMiIvPjxjaXJjbGUgY3g9IjguNSIgY3k9IjguNSIgcj0iMS41Ii8+PHBvbHlsaW5lIHBvaW50cz0iMjEgMTUgMTYgMTAgNSAyMSIvPjwvc3ZnPg=='\n                      }}\n                    />\n                  </a>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {ticket.ce_pco_number && ticket.change_order_value > 0 && (\n            <div className=\"tm-change-order-value\">\n              <span className=\"tm-co-label\">Change Order Value:</span>\n              <span className=\"tm-co-amount\">${ticket.change_order_value.toLocaleString()}</span>\n            </div>\n          )}\n\n          {isLocked && (\n            <div className=\"tm-lock-notice\">\n              <Lock size={14} />\n              <span>{lockInfo?.reason || 'This ticket is locked (COR approved)'}</span>\n            </div>\n          )}\n\n          <div className=\"tm-ticket-actions\" role=\"group\" aria-label=\"Ticket actions\">\n            {ticket.status === 'pending' && !isLocked && (\n              <>\n                <button\n                  className=\"btn btn-success btn-small\"\n                  onClick={(e) => { e.stopPropagation(); onApprove(ticket); }}\n                  aria-label=\"Approve this ticket\"\n                >\n                  Approve\n                </button>\n                <button\n                  className=\"btn btn-warning btn-small\"\n                  onClick={(e) => { e.stopPropagation(); onUpdateStatus(ticket.id, 'rejected'); }}\n                  aria-label=\"Reject this ticket\"\n                >\n                  Reject\n                </button>\n              </>\n            )}\n            {ticket.status === 'approved' && !isLocked && (\n              <>\n                <button\n                  className=\"btn btn-primary btn-small\"\n                  onClick={(e) => { e.stopPropagation(); onUpdateStatus(ticket.id, 'billed'); }}\n                  aria-label=\"Mark ticket as billed\"\n                >\n                  Mark Billed\n                </button>\n                <button\n                  className=\"btn btn-secondary btn-small\"\n                  onClick={(e) => { e.stopPropagation(); onShowSignatureLink(ticket); }}\n                  aria-label=\"Get signature link for this ticket\"\n                >\n                  <Link size={14} aria-hidden=\"true\" /> Signature Link\n                </button>\n              </>\n            )}\n            {ticket.status === 'rejected' && !isLocked && (\n              <button\n                className=\"btn btn-secondary btn-small\"\n                onClick={(e) => { e.stopPropagation(); onUpdateStatus(ticket.id, 'pending'); }}\n                aria-label=\"Restore rejected ticket to pending\"\n              >\n                Restore\n              </button>\n            )}\n            {!isLocked && (\n              <button\n                className={`btn btn-small ${ticket.assigned_cor_id ? 'btn-ghost' : 'btn-secondary'}`}\n                onClick={(e) => { e.stopPropagation(); onOpenCorAssign(ticket); }}\n                aria-label={ticket.assigned_cor_id ? 'Change COR link' : 'Link to Change Order'}\n              >\n                <Link2 size={14} aria-hidden=\"true\" /> {ticket.assigned_cor_id ? 'COR' : 'Link COR'}\n              </button>\n            )}\n            {hasFailedImport && !isLocked && (\n              <button\n                className=\"btn btn-warning btn-small\"\n                onClick={(e) => onRetryImport(ticket, e)}\n                disabled={isRetrying}\n                aria-label=\"Retry syncing data to COR\"\n                aria-busy={isRetrying}\n              >\n                <RefreshCw size={14} className={isRetrying ? 'spin' : ''} aria-hidden=\"true\" /> {isRetrying ? 'Syncing...' : 'Retry Sync'}\n              </button>\n            )}\n            {!isLocked && (\n              <button\n                className=\"btn btn-danger btn-small\"\n                onClick={(e) => { e.stopPropagation(); onDelete(ticket.id); }}\n                aria-label=\"Delete this ticket\"\n              >\n                Delete\n              </button>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  )\n})\n\nexport default TMTicketCard\n","import { useState, useEffect, useMemo, useCallback } from 'react'\nimport { FileText, ChevronDown, ChevronRight, Calendar, X, FileSpreadsheet, BarChart3, List } from 'lucide-react'\nimport { db } from '../lib/supabase'\nimport { useBranding } from '../lib/BrandingContext'\nimport { hexToRgb, loadImageAsBase64 } from '../lib/imageUtils'\nimport SignatureLinkGenerator from './SignatureLinkGenerator'\nimport { TicketSkeleton, CountBadge } from './ui'\nimport TMDashboard from './tm/TMDashboard'\nimport TMTicketCard from './tm/TMTicketCard'\n// Dynamic imports for export libraries (loaded on-demand to reduce initial bundle)\n// jsPDF + XLSX together are ~1MB, so we only load them when user actually exports\nconst loadXLSX = () => import('xlsx')\nconst loadJsPDF = () => Promise.all([import('jspdf'), import('jspdf-autotable')])\n\nexport default function TMList({\n  project,\n  company,\n  onShowToast,\n  compact = false,\n  // Preview mode props\n  previewMode = false,   // When true, shows current month tickets with \"See All\" button\n  onViewAll              // Callback when \"See All\" is clicked\n}) {\n  const { branding } = useBranding()\n  const [tickets, setTickets] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [loadingMore, setLoadingMore] = useState(false)\n  const [filter, setFilter] = useState('all')\n  const [expandedTicket, setExpandedTicket] = useState(null)\n  const [selectedTickets, setSelectedTickets] = useState(new Set())\n\n  // Pagination state\n  const [page, setPage] = useState(0)\n  const [hasMore, setHasMore] = useState(true)\n  const [totalCount, setTotalCount] = useState(0)\n  const TICKETS_PER_PAGE = 25\n  const MAX_TICKETS_IN_MEMORY = 500 // Prevent memory bloat from infinite scroll\n\n  // View mode state - in preview mode, we filter to current month\n  const [viewMode, setViewMode] = useState('recent') // 'recent' | 'all'\n  const [displayMode, setDisplayMode] = useState(() => {\n    // Load user preference from localStorage, default to 'dashboard'\n    const saved = localStorage.getItem('fieldsync-tm-default-view')\n    return saved === 'list' || saved === 'dashboard' ? saved : 'dashboard'\n  })\n  const [expandedMonths, setExpandedMonths] = useState(new Set())\n  const [dateFilter, setDateFilter] = useState({ start: '', end: '' })\n\n  // Change order approval modal state\n  const [showChangeOrderModal, setShowChangeOrderModal] = useState(false)\n  const [pendingApprovalTicket, setPendingApprovalTicket] = useState(null)\n  const [changeOrderValue, setChangeOrderValue] = useState('')\n\n  // Signature link modal state\n  const [showSignatureLink, setShowSignatureLink] = useState(false)\n  const [signatureLinkTicket, setSignatureLinkTicket] = useState(null)\n\n  // COR association modal state\n  const [showCorAssignModal, setShowCorAssignModal] = useState(false)\n  const [pendingCorAssignTicket, setPendingCorAssignTicket] = useState(null)\n  const [availableCors, setAvailableCors] = useState([])\n  const [selectedCorForAssign, setSelectedCorForAssign] = useState('')\n  const [loadingCors, setLoadingCors] = useState(false)\n\n  // Track which tickets are locked (linked to approved COR)\n  const [lockedTickets, setLockedTickets] = useState({})\n\n  // Track failed COR imports for retry UI\n  const [failedImports, setFailedImports] = useState({})\n  const [retryingImport, setRetryingImport] = useState(null)\n\n  useEffect(() => {\n    // Reset pagination when project changes\n    setTickets([])\n    setPage(0)\n    setHasMore(true)\n    loadTickets(0, true)\n\n    // Subscribe to real-time updates for T&M tickets\n    const subscription = db.subscribeToTMTickets?.(project.id, () => {\n      // On real-time update, refresh the first page\n      loadTickets(0, true)\n    })\n\n    return () => {\n      if (subscription) db.unsubscribe?.(subscription)\n    }\n  }, [project.id])\n\n  // Save user preference when displayMode changes\n  useEffect(() => {\n    if (!compact) {\n      localStorage.setItem('fieldsync-tm-default-view', displayMode)\n    }\n  }, [displayMode, compact])\n\n  // Reset to preferred view when switching to full mode\n  useEffect(() => {\n    if (!compact) {\n      const saved = localStorage.getItem('fieldsync-tm-default-view')\n      const preferredView = saved === 'list' || saved === 'dashboard' ? saved : 'dashboard'\n      setDisplayMode(preferredView)\n    }\n  }, [compact])\n\n  // Load tickets with pagination\n  const loadTickets = async (pageNum = 0, reset = false) => {\n    try {\n      if (reset) {\n        setLoading(true)\n      } else {\n        setLoadingMore(true)\n      }\n\n      // Use paginated query for scalability\n      const result = await db.getTMTicketsPaginated(project.id, {\n        page: pageNum,\n        limit: TICKETS_PER_PAGE,\n        status: filter !== 'all' ? filter : null\n      })\n\n      if (reset) {\n        setTickets(result.tickets)\n      } else {\n        // Append new tickets but limit total to prevent memory bloat\n        setTickets(prev => {\n          const combined = [...prev, ...result.tickets]\n          // If exceeding limit, keep only the most recent tickets\n          if (combined.length > MAX_TICKETS_IN_MEMORY) {\n            return combined.slice(-MAX_TICKETS_IN_MEMORY)\n          }\n          return combined\n        })\n      }\n\n      setPage(pageNum)\n      setHasMore(result.hasMore)\n      setTotalCount(result.totalCount)\n\n      // Check editability for tickets with COR assignments\n      const ticketsWithCOR = result.tickets.filter(t => t.assigned_cor_id)\n      if (ticketsWithCOR.length > 0) {\n        const lockResults = {}\n        const importStatusResults = {}\n        await Promise.all(ticketsWithCOR.map(async (ticket) => {\n          const editResult = await db.isTicketEditable(ticket)\n          if (!editResult.editable) {\n            lockResults[ticket.id] = editResult\n          }\n          // Check import status for each ticket\n          try {\n            const importStatus = await db.getTicketImportStatus(ticket.id, ticket.assigned_cor_id)\n            if (importStatus?.import_status === 'failed') {\n              importStatusResults[ticket.id] = importStatus\n            }\n          } catch (e) {\n            // Ignore - column may not exist yet\n          }\n        }))\n        setLockedTickets(prev => reset ? lockResults : { ...prev, ...lockResults })\n        setFailedImports(prev => reset ? importStatusResults : { ...prev, ...importStatusResults })\n      }\n    } catch (error) {\n      onShowToast('Error loading T&M tickets', 'error')\n    } finally {\n      setLoading(false)\n      setLoadingMore(false)\n    }\n  }\n\n  // Load more tickets (next page)\n  const loadMore = () => {\n    if (!loadingMore && hasMore) {\n      loadTickets(page + 1, false)\n    }\n  }\n\n  // Reload tickets when filter changes\n  useEffect(() => {\n    if (project?.id) {\n      setTickets([])\n      setPage(0)\n      setHasMore(true)\n      loadTickets(0, true)\n    }\n  }, [filter])\n\n  const updateStatus = useCallback(async (ticketId, newStatus) => {\n    // Check if ticket is locked due to approved COR\n    if (lockedTickets[ticketId]) {\n      onShowToast(lockedTickets[ticketId].reason || 'This ticket is locked (COR approved)', 'error')\n      return\n    }\n\n    try {\n      await db.updateTMTicketStatus(ticketId, newStatus)\n      setTickets(prev => prev.map(t =>\n        t.id === ticketId ? { ...t, status: newStatus } : t\n      ))\n      onShowToast(`Ticket ${newStatus}`, 'success')\n    } catch (error) {\n      console.error('Error updating status:', error)\n      onShowToast('Error updating status', 'error')\n    }\n  }, [lockedTickets]) // onShowToast is stable (memoized in App.jsx)\n\n  // Handle approval - approve directly (CE/PCO is informational only)\n  const handleApprove = useCallback((ticket) => {\n    // Check if ticket is locked due to approved COR\n    if (lockedTickets[ticket.id]) {\n      onShowToast(lockedTickets[ticket.id].reason || 'This ticket is locked (COR approved)', 'error')\n      return\n    }\n\n    updateStatus(ticket.id, 'approved')\n  }, [lockedTickets, updateStatus]) // onShowToast is stable\n\n  // Confirm approval with change order value\n  const confirmChangeOrderApproval = async () => {\n    if (!pendingApprovalTicket) return\n\n    try {\n      const value = parseFloat(changeOrderValue) || 0\n      await db.approveTMTicket(pendingApprovalTicket.id, null, null, value)\n      setTickets(tickets.map(t =>\n        t.id === pendingApprovalTicket.id\n          ? { ...t, status: 'approved', change_order_value: value }\n          : t\n      ))\n      onShowToast(`Ticket approved with $${value.toLocaleString()} change order`, 'success')\n      setShowChangeOrderModal(false)\n      setPendingApprovalTicket(null)\n      setChangeOrderValue('')\n    } catch (error) {\n      console.error('Error approving ticket:', error)\n      onShowToast('Error approving ticket', 'error')\n    }\n  }\n\n  const deleteTicket = useCallback(async (ticketId) => {\n    // Check if ticket is locked due to approved COR\n    if (lockedTickets[ticketId]) {\n      onShowToast(lockedTickets[ticketId].reason || 'This ticket is locked (COR approved)', 'error')\n      return\n    }\n\n    if (!confirm('Delete this T&M ticket?')) return\n    try {\n      await db.deleteTMTicket(ticketId)\n      setTickets(prev => prev.filter(t => t.id !== ticketId))\n      onShowToast('Ticket deleted', 'success')\n    } catch (error) {\n      console.error('Error deleting ticket:', error)\n      onShowToast('Error deleting ticket', 'error')\n    }\n  }, [lockedTickets]) // onShowToast is stable (memoized in App.jsx)\n\n  // Open COR association modal\n  const openCorAssignModal = useCallback(async (ticket) => {\n    setPendingCorAssignTicket(ticket)\n    setSelectedCorForAssign(ticket.assigned_cor_id || '')\n    setShowCorAssignModal(true)\n    setLoadingCors(true)\n\n    try {\n      // Load CORs that can receive tickets (not billed/archived)\n      const cors = await db.getAssignableCORs(project.id)\n      setAvailableCors(cors || [])\n    } catch (error) {\n      console.error('Error loading CORs:', error)\n      onShowToast('Error loading change orders', 'error')\n    } finally {\n      setLoadingCors(false)\n    }\n  }, [project.id]) // onShowToast is stable (memoized in App.jsx)\n\n  // Associate ticket with selected COR\n  const handleAssignToCor = async () => {\n    if (!pendingCorAssignTicket) return\n\n    try {\n      if (selectedCorForAssign) {\n        // Associate with COR using atomic function (ticketId, corId)\n        await db.assignTicketToCOR(pendingCorAssignTicket.id, selectedCorForAssign)\n        const cor = availableCors.find(c => c.id === selectedCorForAssign)\n        onShowToast(`Ticket linked to ${cor?.cor_number || 'COR'}`, 'success')\n      } else if (pendingCorAssignTicket.assigned_cor_id) {\n        // Remove association using atomic function (ticketId, corId)\n        await db.unassignTicketFromCOR(pendingCorAssignTicket.id, pendingCorAssignTicket.assigned_cor_id)\n        onShowToast('Ticket unlinked from COR', 'success')\n      }\n\n      // Refresh tickets\n      loadTickets()\n      setShowCorAssignModal(false)\n      setPendingCorAssignTicket(null)\n      setSelectedCorForAssign('')\n    } catch (error) {\n      console.error('Error updating COR association:', error)\n      onShowToast('Error updating COR link', 'error')\n    }\n  }\n\n  // Retry a failed COR import\n  const handleRetryImport = useCallback(async (ticket, e) => {\n    e?.stopPropagation()\n    if (!ticket.assigned_cor_id) return\n\n    setRetryingImport(ticket.id)\n    try {\n      await db.importTicketDataToCOR(\n        ticket.id,\n        ticket.assigned_cor_id,\n        company.id,\n        project.work_type || 'demolition',\n        project.job_type || 'standard'\n      )\n      onShowToast('COR data import successful!', 'success')\n      // Clear the failed import state for this ticket\n      setFailedImports(prev => {\n        const next = { ...prev }\n        delete next[ticket.id]\n        return next\n      })\n      loadTickets()\n    } catch (error) {\n      console.error('Error retrying import:', error)\n      onShowToast('Import retry failed. Please try again.', 'error')\n    } finally {\n      setRetryingImport(null)\n    }\n  }, [company.id, project.work_type, project.job_type]) // onShowToast and loadTickets are stable\n\n  const calculateTicketTotal = (ticket) => {\n    let total = 0\n    if (ticket.t_and_m_items) {\n      ticket.t_and_m_items.forEach(item => {\n        if (item.materials_equipment?.cost_per_unit) {\n          total += item.quantity * item.materials_equipment.cost_per_unit\n        }\n      })\n    }\n    return total\n  }\n\n  const calculateTotalHours = (ticket) => {\n    if (!ticket.t_and_m_workers) return 0\n    return ticket.t_and_m_workers.reduce((sum, w) => {\n      const regHours = parseFloat(w.hours) || 0\n      const otHours = parseFloat(w.overtime_hours) || 0\n      return sum + regHours + otHours\n    }, 0)\n  }\n\n  const formatDate = (dateStr) => {\n    return new Date(dateStr).toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric'\n    })\n  }\n\n  // Selection helpers\n  const toggleTicketSelection = useCallback((ticketId, e) => {\n    e?.stopPropagation()\n    setSelectedTickets(prev => {\n      const next = new Set(prev)\n      if (next.has(ticketId)) {\n        next.delete(ticketId)\n      } else {\n        next.add(ticketId)\n      }\n      return next\n    })\n  }, [])\n\n  // Memoized handlers for TMTicketCard - must be before any early returns\n  const handleToggleExpand = useCallback((ticketId) => {\n    setExpandedTicket(prev => prev === ticketId ? null : ticketId)\n  }, [])\n\n  const handleShowSignatureLink = useCallback((ticket) => {\n    setSignatureLinkTicket(ticket)\n    setShowSignatureLink(true)\n  }, [])\n\n  const toggleSelectAll = () => {\n    const currentFiltered = filter === 'all' ? tickets : tickets.filter(t => t.status === filter)\n    const allSelected = currentFiltered.every(t => selectedTickets.has(t.id))\n    if (allSelected) {\n      setSelectedTickets(new Set())\n    } else {\n      setSelectedTickets(new Set(currentFiltered.map(t => t.id)))\n    }\n  }\n\n  const clearSelection = () => {\n    setSelectedTickets(new Set())\n  }\n\n  // Get tickets to export (selected or all filtered)\n  const getExportTickets = () => {\n    const filtered = filter === 'all' ? tickets : tickets.filter(t => t.status === filter)\n    if (selectedTickets.size > 0) {\n      return filtered.filter(t => selectedTickets.has(t.id))\n    }\n    return filtered\n  }\n\n  // Export to Excel (loads XLSX library on-demand)\n  const exportToExcel = async () => {\n    const exportTickets = getExportTickets()\n\n    if (exportTickets.length === 0) {\n      onShowToast('No tickets to export', 'error')\n      return\n    }\n\n    onShowToast('Preparing Excel export...', 'info')\n\n    // Dynamic import - only loads XLSX when user actually exports\n    const XLSX = (await loadXLSX()).default || await loadXLSX()\n\n    // Create workers sheet\n    const workersData = []\n    // Create items sheet\n    const itemsData = []\n    // Create summary sheet\n    const summaryData = []\n\n    exportTickets.forEach(ticket => {\n      const ticketDate = formatDate(ticket.work_date)\n      const ticketStatus = ticket.status\n      \n      // Workers\n      if (ticket.t_and_m_workers) {\n        ticket.t_and_m_workers.forEach(worker => {\n          const regHours = parseFloat(worker.hours) || 0\n          const otHours = parseFloat(worker.overtime_hours) || 0\n          workersData.push({\n            'Date': ticketDate,\n            'Status': ticketStatus,\n            'Worker Name': worker.name,\n            'Role': worker.role || 'Laborer',\n            'Regular Hours': regHours,\n            'OT Hours': otHours,\n            'Total Hours': regHours + otHours\n          })\n        })\n      }\n      \n      // Items\n      if (ticket.t_and_m_items) {\n        ticket.t_and_m_items.forEach(item => {\n          const itemName = item.custom_name || item.materials_equipment?.name || 'Unknown'\n          const category = item.custom_category || item.materials_equipment?.category || 'Unknown'\n          const unit = item.materials_equipment?.unit || 'each'\n          const costPer = item.materials_equipment?.cost_per_unit || 0\n          const total = item.quantity * costPer\n          \n          itemsData.push({\n            'Date': ticketDate,\n            'Status': ticketStatus,\n            'Category': category,\n            'Item': itemName,\n            'Quantity': item.quantity,\n            'Unit': unit,\n            'Cost/Unit': costPer,\n            'Total': total\n          })\n        })\n      }\n      \n      // Summary\n      summaryData.push({\n        'Date': ticketDate,\n        'Status': ticketStatus,\n        'Workers': ticket.t_and_m_workers?.length || 0,\n        'Total Hours': calculateTotalHours(ticket),\n        'Items': ticket.t_and_m_items?.length || 0,\n        'Materials Cost': calculateTicketTotal(ticket),\n        'Notes': ticket.notes || ''\n      })\n    })\n\n    // Create workbook\n    const wb = XLSX.utils.book_new()\n    \n    // Add sheets\n    const summarySheet = XLSX.utils.json_to_sheet(summaryData)\n    XLSX.utils.book_append_sheet(wb, summarySheet, 'Summary')\n    \n    if (workersData.length > 0) {\n      const workersSheet = XLSX.utils.json_to_sheet(workersData)\n      XLSX.utils.book_append_sheet(wb, workersSheet, 'Workers')\n    }\n    \n    if (itemsData.length > 0) {\n      const itemsSheet = XLSX.utils.json_to_sheet(itemsData)\n      XLSX.utils.book_append_sheet(wb, itemsSheet, 'Materials & Equipment')\n    }\n    \n    // Download\n    const fileName = `${project.name}_TM_${new Date().toISOString().split('T')[0]}.xlsx`\n    XLSX.writeFile(wb, fileName)\n    onShowToast('Export downloaded!', 'success')\n  }\n\n  // Export to PDF - Professional format with company branding (loads jsPDF on-demand)\n  const exportToPDF = async () => {\n    const exportTickets = getExportTickets()\n\n    if (exportTickets.length === 0) {\n      onShowToast('No tickets to export', 'error')\n      return\n    }\n\n    onShowToast('Generating PDF...', 'info')\n\n    // Dynamic import - only loads jsPDF and autoTable when user actually exports\n    const [jsPDFModule, autoTableModule] = await loadJsPDF()\n    const jsPDF = jsPDFModule.default\n    const autoTable = autoTableModule.default\n\n    const doc = new jsPDF()\n    const pageWidth = doc.internal.pageSize.getWidth()\n    const pageHeight = doc.internal.pageSize.getHeight()\n    const margin = 20\n    let yPos = margin\n\n    // Get company colors from branding\n    const primaryColor = hexToRgb(branding?.primary_color || '#3B82F6')\n    const secondaryColor = hexToRgb(branding?.secondary_color || '#1E40AF')\n\n    // Company Header with branded colors\n    doc.setFillColor(...primaryColor)\n    doc.rect(0, 0, pageWidth, 45, 'F')\n\n    // Add accent stripe\n    doc.setFillColor(...secondaryColor)\n    doc.rect(0, 42, pageWidth, 3, 'F')\n\n    // Add company logo if available\n    let logoOffset = margin\n    if (branding?.logo_url) {\n      try {\n        const logoBase64 = await loadImageAsBase64(branding.logo_url)\n        if (logoBase64) {\n          // Add logo (max height 30px, maintain aspect ratio)\n          const logoHeight = 30\n          const logoWidth = 30 // Square assumption, will be adjusted by aspect ratio\n          doc.addImage(logoBase64, 'PNG', margin, 7, logoWidth, logoHeight)\n          logoOffset = margin + logoWidth + 10\n        }\n      } catch (e) {\n        console.error('Error adding logo:', e)\n      }\n    }\n\n    doc.setTextColor(255, 255, 255)\n    doc.setFontSize(22)\n    doc.setFont('helvetica', 'bold')\n    doc.text(company?.name || 'Company Name', logoOffset, 20)\n\n    // Add company tagline/subtitle\n    doc.setFontSize(10)\n    doc.setFont('helvetica', 'normal')\n    doc.text('TIME & MATERIALS REPORT', logoOffset, 30)\n\n    // Right side info\n    doc.setFontSize(9)\n    doc.text(`Report Date: ${new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}`, pageWidth - margin, 18, { align: 'right' })\n    if (project.job_number) {\n      doc.text(`Job #: ${project.job_number}`, pageWidth - margin, 26, { align: 'right' })\n    }\n    doc.text(`Status: ${filter.charAt(0).toUpperCase() + filter.slice(1)}`, pageWidth - margin, 34, { align: 'right' })\n\n    yPos = 55\n\n    // Project Info Box\n    doc.setFillColor(248, 250, 252) // Light gray\n    doc.rect(margin, yPos - 5, pageWidth - (margin * 2), 30, 'F')\n    doc.setDrawColor(...primaryColor)\n    doc.setLineWidth(0.5)\n    doc.rect(margin, yPos - 5, pageWidth - (margin * 2), 30, 'S')\n\n    doc.setTextColor(...primaryColor)\n    doc.setFontSize(14)\n    doc.setFont('helvetica', 'bold')\n    doc.text(`Project: ${project.name}`, margin + 5, yPos + 7)\n\n    doc.setFontSize(10)\n    doc.setFont('helvetica', 'normal')\n    doc.setTextColor(51, 65, 85)\n\n    // Date range\n    const dates = exportTickets.map(t => new Date(t.work_date)).sort((a, b) => a - b)\n    const startDate = dates[0]?.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })\n    const endDate = dates[dates.length - 1]?.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })\n    doc.text(`Date Range: ${startDate} - ${endDate}`, margin + 5, yPos + 17)\n    doc.text(`Total Tickets: ${exportTickets.length}`, pageWidth - margin - 5, yPos + 7, { align: 'right' })\n\n    yPos += 40\n\n    // Summary Section\n    const grandTotalHours = exportTickets.reduce((sum, t) => sum + calculateTotalHours(t), 0)\n    const grandTotalMaterials = exportTickets.reduce((sum, t) => sum + calculateTicketTotal(t), 0)\n    const totalWorkers = new Set(exportTickets.flatMap(t => t.t_and_m_workers?.map(w => w.name) || [])).size\n\n    doc.setTextColor(...primaryColor)\n    doc.setFontSize(12)\n    doc.setFont('helvetica', 'bold')\n    doc.text('SUMMARY', margin, yPos)\n    yPos += 8\n\n    // Summary boxes with brand colors\n    const boxWidth = (pageWidth - margin * 2 - 20) / 3\n    const summaryBoxData = [\n      { label: 'Total Labor Hours', value: grandTotalHours.toFixed(1) },\n      { label: 'Unique Workers', value: totalWorkers.toString() },\n      { label: 'Materials Cost', value: `$${grandTotalMaterials.toFixed(2)}` }\n    ]\n\n    // Create lighter version of primary color for box backgrounds\n    const lightPrimary = primaryColor.map(c => Math.min(255, c + 180))\n\n    summaryBoxData.forEach((item, index) => {\n      const boxX = margin + (index * (boxWidth + 10))\n      doc.setFillColor(...lightPrimary)\n      doc.rect(boxX, yPos, boxWidth, 25, 'F')\n      doc.setDrawColor(...primaryColor)\n      doc.setLineWidth(0.5)\n      doc.rect(boxX, yPos, boxWidth, 25, 'S')\n\n      doc.setTextColor(...primaryColor)\n      doc.setFontSize(16)\n      doc.setFont('helvetica', 'bold')\n      doc.text(item.value, boxX + boxWidth / 2, yPos + 12, { align: 'center' })\n\n      doc.setTextColor(100, 116, 139)\n      doc.setFontSize(8)\n      doc.setFont('helvetica', 'normal')\n      doc.text(item.label, boxX + boxWidth / 2, yPos + 20, { align: 'center' })\n    })\n\n    yPos += 35\n\n    // Collect workers by type\n    const supervisionData = []\n    const operatorsData = []\n    const laborersData = []\n    let supervisionRegHours = 0, supervisionOTHours = 0\n    let operatorsRegHours = 0, operatorsOTHours = 0\n    let laborersRegHours = 0, laborersOTHours = 0\n\n    exportTickets.forEach(ticket => {\n      if (ticket.t_and_m_workers) {\n        ticket.t_and_m_workers.forEach(worker => {\n          const regHrs = parseFloat(worker.hours) || 0\n          const otHrs = parseFloat(worker.overtime_hours) || 0\n          const role = worker.role || 'Laborer'\n          const rowData = [\n            formatDate(ticket.work_date),\n            worker.name,\n            regHrs.toString(),\n            otHrs > 0 ? otHrs.toString() : '-',\n            (regHrs + otHrs).toString()\n          ]\n\n          if (role === 'Foreman' || role === 'Superintendent') {\n            supervisionData.push(rowData)\n            supervisionRegHours += regHrs\n            supervisionOTHours += otHrs\n          } else if (role === 'Operator') {\n            operatorsData.push(rowData)\n            operatorsRegHours += regHrs\n            operatorsOTHours += otHrs\n          } else {\n            laborersData.push(rowData)\n            laborersRegHours += regHrs\n            laborersOTHours += otHrs\n          }\n        })\n      }\n    })\n\n    // Helper function to render a labor table\n    const renderLaborTable = (title, data, regHours, otHours) => {\n      if (data.length === 0) return\n\n      // Check if we need a new page\n      if (yPos > pageHeight - 80) {\n        doc.addPage()\n        yPos = margin\n      }\n\n      doc.setTextColor(...primaryColor)\n      doc.setFontSize(11)\n      doc.setFont('helvetica', 'bold')\n      doc.text(title, margin, yPos)\n      yPos += 5\n\n      autoTable(doc, {\n        startY: yPos,\n        head: [['Date', 'Name', 'Reg Hrs', 'OT Hrs', 'Total']],\n        body: data,\n        margin: { left: margin, right: margin },\n        headStyles: {\n          fillColor: primaryColor,\n          textColor: [255, 255, 255],\n          fontStyle: 'bold',\n          fontSize: 9\n        },\n        bodyStyles: {\n          fontSize: 9,\n          textColor: [51, 65, 85]\n        },\n        alternateRowStyles: {\n          fillColor: [248, 250, 252]\n        },\n        columnStyles: {\n          0: { cellWidth: 30 },\n          2: { halign: 'center', cellWidth: 22 },\n          3: { halign: 'center', cellWidth: 22 },\n          4: { halign: 'center', cellWidth: 22 }\n        },\n        foot: [[\n          '', 'SUBTOTAL:', regHours.toString(), otHours > 0 ? otHours.toString() : '-', (regHours + otHours).toString()\n        ]],\n        footStyles: {\n          fillColor: secondaryColor,\n          textColor: [255, 255, 255],\n          fontStyle: 'bold',\n          fontSize: 9\n        }\n      })\n\n      yPos = doc.lastAutoTable.finalY + 10\n    }\n\n    // Render each labor category\n    if (supervisionData.length > 0 || operatorsData.length > 0 || laborersData.length > 0) {\n      doc.setTextColor(...primaryColor)\n      doc.setFontSize(12)\n      doc.setFont('helvetica', 'bold')\n      doc.text('LABOR', margin, yPos)\n      yPos += 8\n\n      renderLaborTable('SUPERVISION', supervisionData, supervisionRegHours, supervisionOTHours)\n      renderLaborTable('OPERATORS', operatorsData, operatorsRegHours, operatorsOTHours)\n      renderLaborTable('LABORERS', laborersData, laborersRegHours, laborersOTHours)\n\n      // Grand total for all labor\n      const totalRegHours = supervisionRegHours + operatorsRegHours + laborersRegHours\n      const totalOTHours = supervisionOTHours + operatorsOTHours + laborersOTHours\n\n      doc.setFillColor(...primaryColor)\n      doc.rect(margin, yPos, pageWidth - margin * 2, 12, 'F')\n      doc.setTextColor(255, 255, 255)\n      doc.setFontSize(10)\n      doc.setFont('helvetica', 'bold')\n      doc.text('LABOR TOTAL:', margin + 5, yPos + 8)\n      doc.text(`${totalRegHours} Reg + ${totalOTHours} OT = ${totalRegHours + totalOTHours} Hours`, pageWidth - margin - 5, yPos + 8, { align: 'right' })\n\n      yPos += 20\n    }\n\n    // Check if we need a new page\n    if (yPos > pageHeight - 100) {\n      doc.addPage()\n      yPos = margin\n    }\n\n    // Collect materials by category\n    const categoryData = {}\n    const categoryTotals = {}\n    const categoryOrder = ['Containment', 'PPE', 'Disposal', 'Equipment', 'Other']\n\n    exportTickets.forEach(ticket => {\n      if (ticket.t_and_m_items) {\n        ticket.t_and_m_items.forEach(item => {\n          const itemName = item.custom_name || item.materials_equipment?.name || 'Unknown'\n          const category = item.custom_category || item.materials_equipment?.category || 'Other'\n          const unit = item.materials_equipment?.unit || 'each'\n          const costPer = item.materials_equipment?.cost_per_unit || 0\n          const total = item.quantity * costPer\n\n          if (!categoryData[category]) {\n            categoryData[category] = []\n            categoryTotals[category] = 0\n          }\n\n          categoryData[category].push([\n            formatDate(ticket.work_date),\n            itemName,\n            item.quantity.toString(),\n            unit,\n            `$${costPer.toFixed(2)}`,\n            `$${total.toFixed(2)}`\n          ])\n          categoryTotals[category] += total\n        })\n      }\n    })\n\n    // Helper function to render a materials table for a category\n    const renderMaterialsTable = (category, data, subtotal) => {\n      if (!data || data.length === 0) return\n\n      // Check if we need a new page\n      if (yPos > pageHeight - 80) {\n        doc.addPage()\n        yPos = margin\n      }\n\n      doc.setTextColor(...primaryColor)\n      doc.setFontSize(11)\n      doc.setFont('helvetica', 'bold')\n      doc.text(category.toUpperCase(), margin, yPos)\n      yPos += 5\n\n      autoTable(doc, {\n        startY: yPos,\n        head: [['Date', 'Item', 'Qty', 'Unit', 'Rate', 'Total']],\n        body: data,\n        margin: { left: margin, right: margin },\n        headStyles: {\n          fillColor: primaryColor,\n          textColor: [255, 255, 255],\n          fontStyle: 'bold',\n          fontSize: 9\n        },\n        bodyStyles: {\n          fontSize: 9,\n          textColor: [51, 65, 85]\n        },\n        alternateRowStyles: {\n          fillColor: [248, 250, 252]\n        },\n        columnStyles: {\n          2: { halign: 'center', cellWidth: 20 },\n          3: { halign: 'center', cellWidth: 25 },\n          4: { halign: 'right', cellWidth: 25 },\n          5: { halign: 'right', cellWidth: 30 }\n        },\n        foot: [[\n          '', '', '', '', 'Subtotal:', `$${subtotal.toFixed(2)}`\n        ]],\n        footStyles: {\n          fillColor: secondaryColor,\n          textColor: [255, 255, 255],\n          fontStyle: 'bold',\n          fontSize: 9\n        }\n      })\n\n      yPos = doc.lastAutoTable.finalY + 10\n    }\n\n    // Render each category\n    const hasItems = Object.keys(categoryData).length > 0\n\n    if (hasItems) {\n      doc.setTextColor(...primaryColor)\n      doc.setFontSize(12)\n      doc.setFont('helvetica', 'bold')\n      doc.text('MATERIALS & EQUIPMENT', margin, yPos)\n      yPos += 8\n\n      // Render in order\n      categoryOrder.forEach(cat => {\n        if (categoryData[cat]) {\n          renderMaterialsTable(cat, categoryData[cat], categoryTotals[cat])\n        }\n      })\n\n      // Render any other categories not in order\n      Object.keys(categoryData).forEach(cat => {\n        if (!categoryOrder.includes(cat)) {\n          renderMaterialsTable(cat, categoryData[cat], categoryTotals[cat])\n        }\n      })\n\n      // Grand total for all materials\n      doc.setFillColor(...primaryColor)\n      doc.rect(margin, yPos, pageWidth - margin * 2, 12, 'F')\n      doc.setTextColor(255, 255, 255)\n      doc.setFontSize(10)\n      doc.setFont('helvetica', 'bold')\n      doc.text('MATERIALS TOTAL:', margin + 5, yPos + 8)\n      doc.text(`$${grandTotalMaterials.toFixed(2)}`, pageWidth - margin - 5, yPos + 8, { align: 'right' })\n\n      yPos += 20\n    }\n\n    // Check if we need a new page for signature section\n    if (yPos > pageHeight - 80) {\n      doc.addPage()\n      yPos = margin\n    }\n\n    // Authorization Signature Section (Dual Signatures)\n    yPos += 10\n    doc.setDrawColor(...primaryColor)\n    doc.setLineWidth(1)\n    doc.line(margin, yPos, pageWidth - margin, yPos)\n    yPos += 15\n\n    doc.setTextColor(...primaryColor)\n    doc.setFontSize(12)\n    doc.setFont('helvetica', 'bold')\n    doc.text('AUTHORIZATION', margin, yPos)\n    yPos += 10\n\n    doc.setFontSize(10)\n    doc.setFont('helvetica', 'normal')\n    doc.setTextColor(71, 85, 105)\n    doc.text('I hereby authorize the above time and materials charges as accurate and approved for billing.', margin, yPos)\n    yPos += 20\n\n    // Helper to get first ticket's signature data (for single-ticket exports)\n    // For multi-ticket exports, signatures would be per-ticket\n    const firstTicket = exportTickets[0] || {}\n\n    // Helper function to render a signature block\n    const renderSignatureBlock = (startY, label, signatureData, signerName, signerTitle, signerCompany, signedDate) => {\n      // Label\n      doc.setFont('helvetica', 'bold')\n      doc.setFontSize(8)\n      doc.setTextColor(...primaryColor)\n      doc.text(label, margin, startY)\n      doc.setFont('helvetica', 'normal')\n      doc.setFontSize(9)\n      doc.setTextColor(100, 116, 139)\n\n      const sigLineY = startY + 18\n\n      // Signature line\n      doc.setDrawColor(...secondaryColor)\n      doc.setLineWidth(0.5)\n      doc.line(margin, sigLineY, margin + 70, sigLineY)\n      doc.text('Signature', margin, sigLineY + 8)\n\n      // Title/Company line\n      doc.line(margin + 85, sigLineY, margin + 145, sigLineY)\n      doc.text('Title / Company', margin + 85, sigLineY + 8)\n\n      // Date line\n      doc.line(pageWidth - margin - 40, sigLineY, pageWidth - margin, sigLineY)\n      doc.text('Date', pageWidth - margin - 40, sigLineY + 8)\n\n      // If signature exists, add it\n      if (signatureData) {\n        try {\n          doc.addImage(signatureData, 'PNG', margin, sigLineY - 16, 60, 16)\n          if (signerName) {\n            doc.setFontSize(8)\n            doc.text(signerName, margin, sigLineY + 15)\n          }\n          if (signerTitle || signerCompany) {\n            const titleCompany = [signerTitle, signerCompany].filter(Boolean).join(' - ')\n            doc.text(titleCompany, margin + 85, sigLineY - 5)\n          }\n          if (signedDate) {\n            const formattedDate = new Date(signedDate).toLocaleDateString()\n            doc.text(formattedDate, pageWidth - margin - 40, sigLineY - 5)\n          }\n        } catch (e) {\n          console.error('Error adding signature to PDF:', e)\n        }\n      }\n\n      return sigLineY + 25\n    }\n\n    // GC Signature (Signature 1)\n    yPos = renderSignatureBlock(\n      yPos,\n      'GC AUTHORIZATION',\n      firstTicket.gc_signature_data,\n      firstTicket.gc_signature_name,\n      firstTicket.gc_signature_title,\n      firstTicket.gc_signature_company,\n      firstTicket.gc_signature_date\n    )\n\n    yPos += 8\n\n    // Client Signature (Signature 2)\n    yPos = renderSignatureBlock(\n      yPos,\n      'CLIENT AUTHORIZATION',\n      firstTicket.client_signature_data,\n      firstTicket.client_signature_name,\n      firstTicket.client_signature_title,\n      firstTicket.client_signature_company,\n      firstTicket.client_signature_date\n    )\n\n    // Add page numbers to all pages\n    const totalPages = doc.internal.getNumberOfPages()\n    for (let i = 1; i <= totalPages; i++) {\n      doc.setPage(i)\n      const footerY = pageHeight - 15\n      doc.setFontSize(8)\n      doc.setTextColor(148, 163, 184)\n      doc.text(`${company?.name || 'Company'} - T&M Report - ${project.name}`, margin, footerY)\n      doc.text(`Page ${i} of ${totalPages}`, pageWidth - margin, footerY, { align: 'right' })\n    }\n\n    // Download\n    const fileName = `${project.name}_TM_Report_${new Date().toISOString().split('T')[0]}.pdf`\n    doc.save(fileName)\n    onShowToast('PDF exported!', 'success')\n  }\n\n  // Filter tickets by status, view mode, and date range\n  const filteredTickets = useMemo(() => {\n    let filtered = filter === 'all'\n      ? [...tickets]\n      : tickets.filter(t => t.status === filter)\n\n    // Apply date filter if set\n    if (dateFilter.start) {\n      const startDate = new Date(dateFilter.start)\n      startDate.setHours(0, 0, 0, 0)\n      filtered = filtered.filter(t => {\n        const ticketDate = new Date(t.work_date)\n        return ticketDate >= startDate\n      })\n    }\n    if (dateFilter.end) {\n      const endDate = new Date(dateFilter.end)\n      endDate.setHours(23, 59, 59, 999)\n      filtered = filtered.filter(t => {\n        const ticketDate = new Date(t.work_date)\n        return ticketDate <= endDate\n      })\n    }\n\n    // In preview mode, show only current month's tickets\n    if (previewMode) {\n      const now = new Date()\n      const currentMonth = now.getMonth()\n      const currentYear = now.getFullYear()\n      filtered = filtered.filter(t => {\n        const ticketDate = new Date(t.work_date)\n        return ticketDate.getMonth() === currentMonth && ticketDate.getFullYear() === currentYear\n      })\n    }\n    // In recent mode (not preview), show only last 7 days\n    else if (viewMode === 'recent') {\n      const sevenDaysAgo = new Date()\n      sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7)\n      sevenDaysAgo.setHours(0, 0, 0, 0)\n      filtered = filtered.filter(t => {\n        const ticketDate = new Date(t.work_date)\n        return ticketDate >= sevenDaysAgo\n      })\n    }\n\n    return filtered\n  }, [tickets, filter, viewMode, dateFilter, previewMode])\n\n  // Group tickets by month for 'all' view\n  const ticketsByMonth = useMemo(() => {\n    if (viewMode !== 'all') return null\n\n    const groups = {}\n    filteredTickets.forEach(ticket => {\n      const date = new Date(ticket.work_date)\n      const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`\n      const monthLabel = date.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })\n\n      if (!groups[monthKey]) {\n        groups[monthKey] = { label: monthLabel, tickets: [], hours: 0, cost: 0 }\n      }\n      groups[monthKey].tickets.push(ticket)\n      groups[monthKey].hours += calculateTotalHours(ticket)\n      groups[monthKey].cost += calculateTicketTotal(ticket)\n    })\n\n    return Object.entries(groups).sort((a, b) => b[0].localeCompare(a[0]))\n  }, [filteredTickets, viewMode])\n\n  // Auto-expand current month\n  useEffect(() => {\n    if (ticketsByMonth && ticketsByMonth.length > 0) {\n      const currentMonthKey = ticketsByMonth[0][0]\n      setExpandedMonths(new Set([currentMonthKey]))\n    }\n  }, [ticketsByMonth])\n\n  const toggleMonthExpand = (monthKey) => {\n    const newExpanded = new Set(expandedMonths)\n    if (newExpanded.has(monthKey)) {\n      newExpanded.delete(monthKey)\n    } else {\n      newExpanded.add(monthKey)\n    }\n    setExpandedMonths(newExpanded)\n  }\n\n  // Calculate totals for summary\n  const totalHours = filteredTickets.reduce((sum, t) => sum + calculateTotalHours(t), 0)\n  const totalCost = filteredTickets.reduce((sum, t) => sum + calculateTicketTotal(t), 0)\n  const totalTicketsCount = filter === 'all' ? tickets.length : tickets.filter(t => t.status === filter).length\n\n  if (loading) {\n    return (\n      <div className={`tm-list ${compact ? 'tm-list-compact' : ''}`}>\n        <div className=\"tm-loading-skeletons\">\n          {[1, 2, 3].map(i => (\n            <TicketSkeleton key={i} />\n          ))}\n        </div>\n      </div>\n    )\n  }\n\n  // Check if all filtered tickets are selected\n  const allFilteredSelected = filteredTickets.length > 0 && filteredTickets.every(t => selectedTickets.has(t.id))\n  const someSelected = selectedTickets.size > 0\n\n  // Helper function to render a single ticket card using memoized component\n  const renderTicketCard = (ticket) => (\n    <TMTicketCard\n      key={ticket.id}\n      ticket={ticket}\n      isExpanded={expandedTicket === ticket.id}\n      isSelected={selectedTickets.has(ticket.id)}\n      isLocked={!!lockedTickets[ticket.id]}\n      lockInfo={lockedTickets[ticket.id]}\n      hasFailedImport={!!failedImports[ticket.id]}\n      isRetrying={retryingImport === ticket.id}\n      onToggleExpand={handleToggleExpand}\n      onToggleSelect={toggleTicketSelection}\n      onApprove={handleApprove}\n      onUpdateStatus={updateStatus}\n      onDelete={deleteTicket}\n      onOpenCorAssign={openCorAssignModal}\n      onRetryImport={handleRetryImport}\n      onShowSignatureLink={handleShowSignatureLink}\n      formatDate={formatDate}\n      calculateTotalHours={calculateTotalHours}\n      calculateTicketTotal={calculateTicketTotal}\n    />\n  )\n\n  return (\n    <div className={`tm-list ${compact ? 'tm-list-compact' : ''}`}>\n      {/* Header with export buttons - always visible */}\n      <div className=\"tm-list-header\">\n        <div className=\"tm-list-title\">\n          <h3>T&M Tickets</h3>\n          <div className=\"tm-header-controls\">\n            {/* Display Mode Toggle */}\n            {!compact && (\n              <div className=\"tm-display-toggle\">\n                <button\n                  className={`tm-display-btn ${displayMode === 'dashboard' ? 'active' : ''}`}\n                  onClick={() => setDisplayMode('dashboard')}\n                  title=\"Dashboard View\"\n                >\n                  <BarChart3 size={16} /> Dashboard\n                </button>\n                <button\n                  className={`tm-display-btn ${displayMode === 'list' ? 'active' : ''}`}\n                  onClick={() => setDisplayMode('list')}\n                  title=\"List View\"\n                >\n                  <List size={16} /> List\n                </button>\n              </div>\n            )}\n            <div className=\"tm-export-buttons\">\n              {!compact && someSelected && (\n                <button className=\"btn btn-ghost btn-small\" onClick={clearSelection}>\n                  Clear ({selectedTickets.size})\n                </button>\n              )}\n              <button className=\"btn btn-secondary btn-small\" onClick={exportToExcel} disabled={tickets.length === 0}>\n                <FileSpreadsheet size={14} /> Excel {!compact && someSelected ? `(${selectedTickets.size})` : ''}\n              </button>\n              <button className=\"btn btn-secondary btn-small\" onClick={exportToPDF} disabled={tickets.length === 0}>\n                <FileText size={14} /> PDF {!compact && someSelected ? `(${selectedTickets.size})` : ''}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n      {!compact && (\n      <div className=\"tm-list-filters\">\n\n        <div className=\"tm-filter-tabs\">\n          {['all', 'pending', 'approved', 'billed', 'rejected'].map(status => (\n            <button\n              key={status}\n              className={`tm-filter-tab ${filter === status ? 'active' : ''}`}\n              onClick={() => { setFilter(status); clearSelection(); }}\n            >\n              {status.charAt(0).toUpperCase() + status.slice(1)}\n              <span className=\"tm-filter-count\">\n                {status === 'all' ? tickets.length : tickets.filter(t => t.status === status).length}\n              </span>\n            </button>\n          ))}\n        </div>\n\n        {/* View Mode Bar */}\n        <div className=\"view-mode-bar\">\n          <div className=\"view-mode-tabs\">\n            <button\n              className={`view-mode-tab ${viewMode === 'recent' ? 'active' : ''}`}\n              onClick={() => { setViewMode('recent'); setDateFilter({ start: '', end: '' }); }}\n            >\n              Recent (7 days)\n            </button>\n            <button\n              className={`view-mode-tab ${viewMode === 'all' ? 'active' : ''}`}\n              onClick={() => setViewMode('all')}\n            >\n              All ({totalTicketsCount})\n            </button>\n          </div>\n\n          {viewMode === 'all' && (\n            <div className=\"date-filter\">\n              <Calendar size={16} />\n              <input\n                type=\"date\"\n                value={dateFilter.start}\n                onChange={(e) => setDateFilter(prev => ({ ...prev, start: e.target.value }))}\n                placeholder=\"Start date\"\n              />\n              <span>to</span>\n              <input\n                type=\"date\"\n                value={dateFilter.end}\n                onChange={(e) => setDateFilter(prev => ({ ...prev, end: e.target.value }))}\n                placeholder=\"End date\"\n              />\n              {(dateFilter.start || dateFilter.end) && (\n                <button\n                  className=\"btn btn-ghost btn-small\"\n                  onClick={() => setDateFilter({ start: '', end: '' })}\n                >\n                  Clear\n                </button>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n      )}\n\n      {/* Dashboard View */}\n      {!compact && displayMode === 'dashboard' && (\n        <TMDashboard tickets={tickets} />\n      )}\n\n      {/* List View Content */}\n      {displayMode === 'list' && (\n        <>\n          {/* Summary Bar - hidden in compact mode */}\n          {!compact && filteredTickets.length > 0 && (\n            <div className=\"tm-summary-bar\">\n              <div className=\"tm-summary-stat\">\n                <span className=\"tm-summary-label\">Tickets</span>\n                <span className=\"tm-summary-value\">{filteredTickets.length}</span>\n              </div>\n              <div className=\"tm-summary-stat\">\n                <span className=\"tm-summary-label\">Total Hours</span>\n                <span className=\"tm-summary-value\">{totalHours.toFixed(1)}</span>\n              </div>\n              <div className=\"tm-summary-stat\">\n                <span className=\"tm-summary-label\">Materials Cost</span>\n                <span className=\"tm-summary-value\">${totalCost.toFixed(2)}</span>\n              </div>\n            </div>\n          )}\n\n          {filteredTickets.length === 0 ? (\n        <div className=\"tm-empty-state\">\n          <p>No {filter === 'all' ? '' : filter} T&M tickets{viewMode === 'recent' ? ' in the last 7 days' : ''}</p>\n          {viewMode === 'recent' && totalTicketsCount > 0 && (\n            <button className=\"btn btn-secondary btn-small\" onClick={() => setViewMode('all')}>\n              View All Tickets\n            </button>\n          )}\n        </div>\n      ) : (\n        <div className=\"tm-tickets stagger-children\">\n          {/* Select All Row */}\n          <div className=\"tm-select-all-row\">\n            <label className=\"tm-checkbox-label\" onClick={toggleSelectAll}>\n              <input\n                type=\"checkbox\"\n                checked={allFilteredSelected}\n                onChange={toggleSelectAll}\n                className=\"tm-checkbox\"\n              />\n              <span>Select All ({filteredTickets.length})</span>\n            </label>\n          </div>\n\n          {/* Render tickets - with month grouping in 'all' mode */}\n          {viewMode === 'all' && ticketsByMonth ? (\n            ticketsByMonth.map(([monthKey, monthData]) => (\n              <div key={monthKey} className=\"month-group animate-fade-in\">\n                <div\n                  className=\"month-header\"\n                  onClick={() => toggleMonthExpand(monthKey)}\n                >\n                  <div className=\"month-header-left\">\n                    {expandedMonths.has(monthKey) ? (\n                      <ChevronDown size={18} />\n                    ) : (\n                      <ChevronRight size={18} />\n                    )}\n                    <span className=\"month-label\">{monthData.label}</span>\n                    <CountBadge count={monthData.tickets.length} label=\"tickets\" size=\"small\" />\n                  </div>\n                  <div className=\"month-header-right\">\n                    <span className=\"month-stat\">{monthData.hours.toFixed(1)} hrs</span>\n                    <span className=\"month-stat\">${monthData.cost.toFixed(2)}</span>\n                  </div>\n                </div>\n                {expandedMonths.has(monthKey) && (\n                  <div className=\"month-tickets stagger-children\">\n                    {monthData.tickets.map(ticket => renderTicketCard(ticket))}\n                  </div>\n                )}\n              </div>\n            ))\n          ) : (\n            // Recent view - simple list\n            filteredTickets.map(ticket => renderTicketCard(ticket))\n          )}\n          </div>\n          )}\n\n          {/* Load More Button - for pagination */}\n          {!previewMode && hasMore && !loading && tickets.length > 0 && (\n            <div className=\"tm-load-more\">\n              <button\n                className=\"btn btn-secondary\"\n                onClick={loadMore}\n                disabled={loadingMore}\n              >\n                {loadingMore ? 'Loading...' : `Load More (${tickets.length} of ${totalCount})`}\n              </button>\n            </div>\n          )}\n\n          {/* See All Footer - only in preview mode */}\n          {previewMode && tickets.length > 0 && (\n            <button className=\"tm-see-all-btn\" onClick={onViewAll}>\n              See all {totalCount || tickets.length} T&M tickets\n              <ChevronRight size={16} />\n            </button>\n          )}\n        </>\n      )}\n\n      {/* Change Order Approval Modal */}\n      {showChangeOrderModal && pendingApprovalTicket && (\n        <div className=\"modal-overlay\" onClick={() => setShowChangeOrderModal(false)}>\n          <div className=\"modal change-order-modal\" onClick={(e) => e.stopPropagation()}>\n            <h3>Approve Change Order Work</h3>\n            <p className=\"modal-subtitle\">\n              This T&M ticket is associated with <strong>{pendingApprovalTicket.ce_pco_number}</strong>\n            </p>\n\n            <div className=\"form-group\">\n              <label>Change Order Value ($)</label>\n              <input\n                type=\"number\"\n                value={changeOrderValue}\n                onChange={(e) => setChangeOrderValue(e.target.value)}\n                placeholder=\"Enter the change order amount\"\n                autoFocus\n              />\n              <p className=\"form-help\">\n                This amount will be added to the project's total contract value.\n              </p>\n            </div>\n\n            <div className=\"modal-actions\">\n              <button\n                className=\"btn btn-secondary\"\n                onClick={() => setShowChangeOrderModal(false)}\n              >\n                Cancel\n              </button>\n              <button\n                className=\"btn btn-success\"\n                onClick={confirmChangeOrderApproval}\n              >\n                Approve with ${parseFloat(changeOrderValue || 0).toLocaleString()}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Signature Link Generator Modal */}\n      {showSignatureLink && signatureLinkTicket && (\n        <SignatureLinkGenerator\n          documentType=\"tm_ticket\"\n          documentId={signatureLinkTicket.id}\n          companyId={company?.id}\n          projectId={project?.id}\n          documentTitle={`T&M Ticket - ${new Date(signatureLinkTicket.work_date).toLocaleDateString()}${signatureLinkTicket.ce_pco_number ? ` (${signatureLinkTicket.ce_pco_number})` : ''}`}\n          onClose={() => {\n            setShowSignatureLink(false)\n            setSignatureLinkTicket(null)\n          }}\n          onShowToast={onShowToast}\n        />\n      )}\n\n      {/* COR Association Modal */}\n      {showCorAssignModal && pendingCorAssignTicket && (\n        <div className=\"modal-overlay\" onClick={() => setShowCorAssignModal(false)}>\n          <div className=\"modal cor-assign-modal\" onClick={(e) => e.stopPropagation()}>\n            <div className=\"modal-header\">\n              <h3>Link Ticket to Change Order</h3>\n              <button className=\"close-btn\" onClick={() => setShowCorAssignModal(false)}>\n                <X size={20} />\n              </button>\n            </div>\n\n            <div className=\"modal-body\">\n              <p className=\"modal-subtitle\">\n                Ticket: <strong>{new Date(pendingCorAssignTicket.work_date).toLocaleDateString()}</strong>\n                {pendingCorAssignTicket.ce_pco_number && ` (${pendingCorAssignTicket.ce_pco_number})`}\n              </p>\n\n              {loadingCors ? (\n                <div className=\"loading\">Loading change orders...</div>\n              ) : availableCors.length === 0 ? (\n                <div className=\"empty-state\">\n                  <p>No change orders found for this project.</p>\n                  <p className=\"text-muted\">Create a COR first, then link tickets to it.</p>\n                </div>\n              ) : (\n                <div className=\"cor-select-wrapper\">\n                  <label>Select Change Order:</label>\n                  <select\n                    value={selectedCorForAssign}\n                    onChange={(e) => setSelectedCorForAssign(e.target.value)}\n                    className=\"cor-select\"\n                  >\n                    <option value=\"\">-- No COR (unlink) --</option>\n                    {availableCors.map(cor => (\n                      <option key={cor.id} value={cor.id}>\n                        {cor.cor_number} - {cor.title || 'Untitled'} ({cor.status})\n                      </option>\n                    ))}\n                  </select>\n                </div>\n              )}\n            </div>\n\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-secondary\"\n                onClick={() => setShowCorAssignModal(false)}\n              >\n                Cancel\n              </button>\n              <button\n                className=\"btn btn-primary\"\n                onClick={handleAssignToCor}\n                disabled={loadingCors || (availableCors.length === 0)}\n              >\n                {pendingCorAssignTicket.assigned_cor_id && !selectedCorForAssign\n                  ? 'Unlink from COR'\n                  : 'Link to COR'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n"],"file":"TMList-DodRAAoq.js"}