{"version":3,"mappings":"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","names":["STATUS_OPTIONS","CORLogRow","entry","isEditing","isSaving","onEdit","onSave","onCancel","statusDisplay","editValues","setEditValues","useState","dateSentRef","useRef","useEffect","handleKeyDown","e","handleSave","handleCancel","status","formatDateDisplay","dateStr","formatDateInput","jsxs","jsx","prev","opt","ChevronDown","Loader2","Check","X","Edit3","STATUS_DISPLAY","STATUS_CATEGORIES","CORLog","project","company","onShowToast","logEntries","setLogEntries","loading","setLoading","editingId","setEditingId","savingId","setSavingId","refreshing","setRefreshing","loadCORLog","subscription","db","data","error","handleRefresh","entryId","updates","changeOrderId","groupedEntries","useMemo","pending","approved","voided","summary","sum","exportToPDF","jsPDF","__vitePreload","n","autoTable","doc","pageWidth","tableData","formatCurrency","finalY","col1X","col2X","fileName","exportToExcel","XLSX","ws","wb","amountCol","range","row","cellRef","renderSectionTable","entries","showHeader","FileSpreadsheet","RefreshCw","FileText","Clock","CheckCircle","XCircle"],"ignoreList":[],"sources":["../../src/components/cor/CORLogRow.jsx","../../src/components/cor/CORLog.jsx"],"sourcesContent":["import { useState, useRef, useEffect } from 'react'\nimport { Edit3, Check, X, Loader2, ChevronDown } from 'lucide-react'\nimport { formatCurrency } from '../../lib/corCalculations'\n\n// Available status options for editing\nconst STATUS_OPTIONS = [\n  { value: 'draft', label: 'Draft' },\n  { value: 'pending_approval', label: 'Pending Approval' },\n  { value: 'approved', label: 'Approved' },\n  { value: 'rejected', label: 'Rejected' },\n  { value: 'billed', label: 'Billed' },\n  { value: 'closed', label: 'Closed' }\n]\n\nexport default function CORLogRow({\n  entry,\n  isEditing,\n  isSaving,\n  onEdit,\n  onSave,\n  onCancel,\n  statusDisplay\n}) {\n  const [editValues, setEditValues] = useState({\n    dateSentToClient: entry.dateSentToClient || '',\n    ceNumber: entry.ceNumber || '',\n    comments: entry.comments || '',\n    status: entry.changeOrder?.status || 'draft'\n  })\n\n  const dateSentRef = useRef(null)\n\n  // Focus first editable field when entering edit mode\n  useEffect(() => {\n    if (isEditing && dateSentRef.current) {\n      dateSentRef.current.focus()\n    }\n  }, [isEditing])\n\n  // Reset edit values when entry changes\n  useEffect(() => {\n    setEditValues({\n      dateSentToClient: entry.dateSentToClient || '',\n      ceNumber: entry.ceNumber || '',\n      comments: entry.comments || '',\n      status: entry.changeOrder?.status || 'draft'\n    })\n  }, [entry])\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault()\n      handleSave()\n    } else if (e.key === 'Escape') {\n      handleCancel()\n    }\n  }\n\n  const handleSave = () => {\n    onSave(editValues)\n  }\n\n  const handleCancel = () => {\n    setEditValues({\n      dateSentToClient: entry.dateSentToClient || '',\n      ceNumber: entry.ceNumber || '',\n      comments: entry.comments || '',\n      status: entry.changeOrder?.status || 'draft'\n    })\n    onCancel()\n  }\n\n  const status = statusDisplay[entry.changeOrder.status] || { label: entry.changeOrder.status, className: '' }\n\n  // Format date for display\n  const formatDateDisplay = (dateStr) => {\n    if (!dateStr) return '-'\n    try {\n      return new Date(dateStr).toLocaleDateString('en-US', {\n        month: 'short',\n        day: 'numeric',\n        year: 'numeric'\n      })\n    } catch {\n      return dateStr\n    }\n  }\n\n  // Format date for input\n  const formatDateInput = (dateStr) => {\n    if (!dateStr) return ''\n    try {\n      const date = new Date(dateStr)\n      return date.toISOString().split('T')[0]\n    } catch {\n      return dateStr\n    }\n  }\n\n  if (isEditing) {\n    return (\n      <tr className=\"cor-log-row editing\">\n        <td className=\"col-log-num\">{entry.logNumber}</td>\n        <td className=\"col-date-sent\">\n          <input\n            ref={dateSentRef}\n            type=\"date\"\n            value={formatDateInput(editValues.dateSentToClient)}\n            onChange={(e) => setEditValues(prev => ({ ...prev, dateSentToClient: e.target.value }))}\n            onKeyDown={handleKeyDown}\n            disabled={isSaving}\n            className=\"cor-log-input\"\n          />\n        </td>\n        <td className=\"col-ce-num\">\n          <input\n            type=\"text\"\n            value={editValues.ceNumber}\n            onChange={(e) => setEditValues(prev => ({ ...prev, ceNumber: e.target.value }))}\n            onKeyDown={handleKeyDown}\n            disabled={isSaving}\n            placeholder=\"CE-XXX\"\n            className=\"cor-log-input\"\n            maxLength={50}\n          />\n        </td>\n        <td className=\"col-description\">\n          <span className=\"cor-log-title\">{entry.changeOrder.title || 'Untitled'}</span>\n          <span className=\"cor-log-number\">{entry.changeOrder.corNumber}</span>\n        </td>\n        <td className=\"col-amount\">{formatCurrency(entry.changeOrder.corTotal || 0)}</td>\n        <td className=\"col-status\">\n          <div className=\"cor-log-status-select\">\n            <select\n              value={editValues.status}\n              onChange={(e) => setEditValues(prev => ({ ...prev, status: e.target.value }))}\n              disabled={isSaving}\n              className=\"cor-log-select\"\n            >\n              {STATUS_OPTIONS.map(opt => (\n                <option key={opt.value} value={opt.value}>{opt.label}</option>\n              ))}\n            </select>\n            <ChevronDown size={14} className=\"select-icon\" />\n          </div>\n        </td>\n        <td className=\"col-comments\">\n          <textarea\n            value={editValues.comments}\n            onChange={(e) => setEditValues(prev => ({ ...prev, comments: e.target.value }))}\n            onKeyDown={handleKeyDown}\n            disabled={isSaving}\n            placeholder=\"Add comments...\"\n            className=\"cor-log-textarea\"\n            rows={2}\n          />\n        </td>\n        <td className=\"col-actions\">\n          {isSaving ? (\n            <Loader2 size={16} className=\"spin\" />\n          ) : (\n            <div className=\"cor-log-edit-actions\">\n              <button\n                className=\"btn btn-icon btn-success\"\n                onClick={handleSave}\n                title=\"Save\"\n              >\n                <Check size={14} />\n              </button>\n              <button\n                className=\"btn btn-icon btn-ghost\"\n                onClick={handleCancel}\n                title=\"Cancel\"\n              >\n                <X size={14} />\n              </button>\n            </div>\n          )}\n        </td>\n      </tr>\n    )\n  }\n\n  return (\n    <tr className=\"cor-log-row\">\n      <td className=\"col-log-num\">{entry.logNumber}</td>\n      <td className=\"col-date-sent editable\" onClick={onEdit}>\n        {formatDateDisplay(entry.dateSentToClient)}\n      </td>\n      <td className=\"col-ce-num editable\" onClick={onEdit}>\n        {entry.ceNumber || '-'}\n      </td>\n      <td className=\"col-description\">\n        <span className=\"cor-log-title\">{entry.changeOrder.title || 'Untitled'}</span>\n        <span className=\"cor-log-number\">{entry.changeOrder.corNumber}</span>\n      </td>\n      <td className=\"col-amount\">{formatCurrency(entry.changeOrder.corTotal || 0)}</td>\n      <td className=\"col-status editable\" onClick={onEdit}>\n        <span className={`cor-log-status ${status.className}`}>{status.label}</span>\n      </td>\n      <td className=\"col-comments editable\" onClick={onEdit}>\n        {entry.comments || <span className=\"placeholder\">Click to add...</span>}\n      </td>\n      <td className=\"col-actions\">\n        <button\n          className=\"btn btn-icon btn-ghost\"\n          onClick={onEdit}\n          title=\"Edit\"\n        >\n          <Edit3 size={14} />\n        </button>\n      </td>\n    </tr>\n  )\n}\n","import { useState, useEffect, useMemo } from 'react'\nimport { FileSpreadsheet, Download, FileText, Loader2, RefreshCw, Clock, CheckCircle, XCircle } from 'lucide-react'\nimport { db } from '../../lib/supabase'\nimport { formatCurrency } from '../../lib/corCalculations'\nimport CORLogRow from './CORLogRow'\n\n// Status display mapping for client presentation\nconst STATUS_DISPLAY = {\n  draft: { label: 'Draft', className: 'draft' },\n  pending_approval: { label: 'Pending', className: 'pending' },\n  approved: { label: 'Approved', className: 'approved' },\n  rejected: { label: 'Rejected', className: 'rejected' },\n  billed: { label: 'Billed', className: 'billed' },\n  closed: { label: 'Closed', className: 'closed' }\n}\n\n// Status categories for grouping\nconst STATUS_CATEGORIES = {\n  pending: ['draft', 'pending_approval'],\n  approved: ['approved', 'billed'],\n  void: ['rejected', 'closed']\n}\n\nexport default function CORLog({ project, company, onShowToast }) {\n  const [logEntries, setLogEntries] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [editingId, setEditingId] = useState(null)\n  const [savingId, setSavingId] = useState(null)\n  const [refreshing, setRefreshing] = useState(false)\n\n  useEffect(() => {\n    loadCORLog()\n\n    // Subscribe to COR log changes\n    const subscription = db.subscribeToCORLog?.(project.id, () => {\n      loadCORLog()\n    })\n\n    return () => {\n      if (subscription) db.unsubscribe?.(subscription)\n    }\n  }, [project.id])\n\n  const loadCORLog = async () => {\n    try {\n      const data = await db.getCORLog(project.id)\n      setLogEntries(data || [])\n    } catch (error) {\n      console.error('Error loading COR log:', error)\n      onShowToast?.('Error loading COR log', 'error')\n    } finally {\n      setLoading(false)\n      setRefreshing(false)\n    }\n  }\n\n  const handleRefresh = () => {\n    setRefreshing(true)\n    loadCORLog()\n  }\n\n  const handleSave = async (entryId, updates, changeOrderId) => {\n    setSavingId(entryId)\n    try {\n      // Update log entry fields\n      await db.updateCORLogEntry(entryId, updates)\n\n      // If status changed, update the change order status too\n      if (updates.status) {\n        await db.updateChangeOrderStatus(changeOrderId, updates.status)\n      }\n\n      // Update local state\n      setLogEntries(prev => prev.map(entry =>\n        entry.id === entryId\n          ? {\n              ...entry,\n              dateSentToClient: updates.dateSentToClient,\n              ceNumber: updates.ceNumber,\n              comments: updates.comments,\n              changeOrder: {\n                ...entry.changeOrder,\n                status: updates.status || entry.changeOrder.status\n              }\n            }\n          : entry\n      ))\n      setEditingId(null)\n      onShowToast?.('Log entry updated', 'success')\n    } catch (error) {\n      console.error('Error updating log entry:', error)\n      onShowToast?.('Error updating log entry', 'error')\n    } finally {\n      setSavingId(null)\n    }\n  }\n\n  // Group entries by status category\n  const groupedEntries = useMemo(() => {\n    const pending = logEntries.filter(e => STATUS_CATEGORIES.pending.includes(e.changeOrder.status))\n    const approved = logEntries.filter(e => STATUS_CATEGORIES.approved.includes(e.changeOrder.status))\n    const voided = logEntries.filter(e => STATUS_CATEGORIES.void.includes(e.changeOrder.status))\n\n    return { pending, approved, voided }\n  }, [logEntries])\n\n  // Calculate summary statistics\n  const summary = useMemo(() => {\n    const { pending, approved, voided } = groupedEntries\n\n    return {\n      totalCORs: logEntries.length,\n      approvedCount: approved.length,\n      pendingCount: pending.length,\n      voidCount: voided.length,\n      approvedTotal: approved.reduce((sum, e) => sum + (e.changeOrder.corTotal || 0), 0),\n      pendingTotal: pending.reduce((sum, e) => sum + (e.changeOrder.corTotal || 0), 0),\n      voidTotal: voided.reduce((sum, e) => sum + (e.changeOrder.corTotal || 0), 0),\n      grandTotal: logEntries.reduce((sum, e) => sum + (e.changeOrder.corTotal || 0), 0)\n    }\n  }, [logEntries, groupedEntries])\n\n  // Export to PDF\n  const exportToPDF = async () => {\n    try {\n      // Dynamic import for jspdf\n      const { default: jsPDF } = await import('jspdf')\n      const { default: autoTable } = await import('jspdf-autotable')\n\n      const doc = new jsPDF('landscape')\n      const pageWidth = doc.internal.pageSize.width\n\n      // Header\n      doc.setFontSize(18)\n      doc.setFont(undefined, 'bold')\n      doc.text('CHANGE ORDER LOG', pageWidth / 2, 20, { align: 'center' })\n\n      doc.setFontSize(12)\n      doc.setFont(undefined, 'normal')\n      doc.text(`Project: ${project.name}`, pageWidth / 2, 28, { align: 'center' })\n      if (project.job_number) {\n        doc.text(`Job #${project.job_number}`, pageWidth / 2, 35, { align: 'center' })\n      }\n      doc.setFontSize(10)\n      doc.text(`Generated: ${new Date().toLocaleDateString()}`, pageWidth / 2, 42, { align: 'center' })\n\n      // Company info if available\n      if (company?.name) {\n        doc.setFontSize(11)\n        doc.setFont(undefined, 'bold')\n        doc.text(company.name, 14, 20)\n        doc.setFont(undefined, 'normal')\n        if (company.phone) {\n          doc.setFontSize(9)\n          doc.text(company.phone, 14, 25)\n        }\n      }\n\n      // Table data - include all editable columns\n      const tableData = logEntries.map(entry => [\n        entry.logNumber,\n        entry.changeOrder.corNumber || '-',\n        entry.dateSentToClient ? new Date(entry.dateSentToClient).toLocaleDateString() : '-',\n        entry.ceNumber || '-',\n        entry.changeOrder.title || 'Untitled',\n        formatCurrency(entry.changeOrder.corTotal || 0),\n        STATUS_DISPLAY[entry.changeOrder.status]?.label || entry.changeOrder.status,\n        entry.comments || '-'\n      ])\n\n      // Generate table with all columns\n      autoTable(doc, {\n        startY: 50,\n        head: [['Log #', 'COR #', 'Date Sent', 'CE #', 'Description', 'Amount', 'Status', 'Comments']],\n        body: tableData,\n        styles: {\n          fontSize: 8,\n          cellPadding: 3,\n          overflow: 'linebreak',\n          valign: 'top'\n        },\n        headStyles: {\n          fillColor: [51, 51, 51],\n          textColor: 255,\n          fontStyle: 'bold',\n          fontSize: 8\n        },\n        columnStyles: {\n          0: { cellWidth: 12, halign: 'center' },  // Log #\n          1: { cellWidth: 18 },                     // COR #\n          2: { cellWidth: 22 },                     // Date Sent\n          3: { cellWidth: 18 },                     // CE #\n          4: { cellWidth: 55 },                     // Description\n          5: { cellWidth: 22, halign: 'right' },    // Amount\n          6: { cellWidth: 18, halign: 'center' },   // Status\n          7: { cellWidth: 'auto', minCellWidth: 50 } // Comments - flexible width\n        },\n        alternateRowStyles: {\n          fillColor: [248, 248, 248]\n        },\n        didParseCell: (data) => {\n          // Style status cells based on value\n          if (data.column.index === 6 && data.section === 'body') {\n            const status = data.cell.raw?.toLowerCase()\n            if (status === 'approved' || status === 'billed') {\n              data.cell.styles.textColor = [5, 150, 105]\n            } else if (status === 'pending' || status === 'pending approval') {\n              data.cell.styles.textColor = [217, 119, 6]\n            } else if (status === 'rejected' || status === 'void') {\n              data.cell.styles.textColor = [220, 38, 38]\n            }\n          }\n        }\n      })\n\n      // Summary section\n      const finalY = (doc.lastAutoTable?.finalY || 100) + 10\n      doc.setFontSize(10)\n      doc.setFont(undefined, 'bold')\n      doc.text('SUMMARY', 14, finalY)\n\n      doc.setFont(undefined, 'normal')\n      doc.setFontSize(9)\n      const col1X = 14\n      const col2X = 100\n      doc.text(`Total CORs: ${summary.totalCORs}`, col1X, finalY + 7)\n      doc.text(`Approved: ${summary.approvedCount} (${formatCurrency(summary.approvedTotal)})`, col1X, finalY + 14)\n      doc.text(`Pending: ${summary.pendingCount} (${formatCurrency(summary.pendingTotal)})`, col2X, finalY + 7)\n      doc.text(`Void: ${summary.voidCount} (${formatCurrency(summary.voidTotal)})`, col2X, finalY + 14)\n\n      doc.setFont(undefined, 'bold')\n      doc.setFontSize(10)\n      doc.text(`Total Value: ${formatCurrency(summary.grandTotal)}`, col1X, finalY + 24)\n\n      // Save\n      const fileName = `COR_Log_${project.job_number || project.name.replace(/\\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.pdf`\n      doc.save(fileName)\n\n      onShowToast?.('PDF exported successfully', 'success')\n    } catch (error) {\n      console.error('Error exporting PDF:', error)\n      onShowToast?.('Error exporting PDF', 'error')\n    }\n  }\n\n  // Export to Excel\n  const exportToExcel = async () => {\n    try {\n      // Dynamic import for xlsx\n      const XLSX = await import('xlsx')\n\n      // Prepare data\n      const data = logEntries.map(entry => ({\n        'Log #': entry.logNumber,\n        'COR Number': entry.changeOrder.corNumber,\n        'Date Sent to Client': entry.dateSentToClient || '',\n        'CE Number': entry.ceNumber || '',\n        'Description': entry.changeOrder.title || 'Untitled',\n        'Amount': entry.changeOrder.corTotal || 0,\n        'Status': STATUS_DISPLAY[entry.changeOrder.status]?.label || entry.changeOrder.status,\n        'Created Date': entry.changeOrder.createdAt ? new Date(entry.changeOrder.createdAt).toLocaleDateString() : '',\n        'Approved Date': entry.changeOrder.approvedAt ? new Date(entry.changeOrder.approvedAt).toLocaleDateString() : '',\n        'Approved By': entry.changeOrder.approvedBy || '',\n        'Comments': entry.comments || ''\n      }))\n\n      // Add summary row\n      data.push({})\n      data.push({\n        'Log #': 'SUMMARY',\n        'Description': `Total CORs: ${summary.totalCORs}`,\n        'Amount': summary.grandTotal,\n        'Status': `Approved: ${summary.approvedCount}, Pending: ${summary.pendingCount}`\n      })\n\n      // Create workbook\n      const ws = XLSX.utils.json_to_sheet(data)\n      const wb = XLSX.utils.book_new()\n      XLSX.utils.book_append_sheet(wb, ws, 'COR Log')\n\n      // Format amount column\n      const amountCol = 5 // 0-indexed, 'Amount' column\n      const range = XLSX.utils.decode_range(ws['!ref'])\n      for (let row = range.s.r + 1; row <= range.e.r; row++) {\n        const cellRef = XLSX.utils.encode_cell({ r: row, c: amountCol })\n        if (ws[cellRef] && typeof ws[cellRef].v === 'number') {\n          ws[cellRef].z = '$#,##0.00'\n        }\n      }\n\n      // Column widths\n      ws['!cols'] = [\n        { wch: 8 },   // Log #\n        { wch: 12 },  // COR Number\n        { wch: 15 },  // Date Sent\n        { wch: 12 },  // CE Number\n        { wch: 40 },  // Description\n        { wch: 12 },  // Amount\n        { wch: 12 },  // Status\n        { wch: 12 },  // Created Date\n        { wch: 12 },  // Approved Date\n        { wch: 20 },  // Approved By\n        { wch: 30 }   // Comments\n      ]\n\n      // Save\n      const fileName = `COR_Log_${project.job_number || project.name}_${new Date().toISOString().split('T')[0]}.xlsx`\n      XLSX.writeFile(wb, fileName)\n\n      onShowToast?.('Excel exported successfully', 'success')\n    } catch (error) {\n      console.error('Error exporting Excel:', error)\n      onShowToast?.('Error exporting Excel', 'error')\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"cor-log cor-log-loading\">\n        <Loader2 size={24} className=\"spin\" />\n        <span>Loading COR Log...</span>\n      </div>\n    )\n  }\n\n  // Helper to render a section table\n  const renderSectionTable = (entries, showHeader = true) => (\n    <table className=\"cor-log-table\">\n      {showHeader && (\n        <thead>\n          <tr>\n            <th className=\"col-log-num\">Log #</th>\n            <th className=\"col-date-sent\">Date Sent</th>\n            <th className=\"col-ce-num\">CE #</th>\n            <th className=\"col-description\">Description</th>\n            <th className=\"col-amount\">Amount</th>\n            <th className=\"col-status\">Status</th>\n            <th className=\"col-comments\">Comments</th>\n            <th className=\"col-actions\">Actions</th>\n          </tr>\n        </thead>\n      )}\n      <tbody>\n        {entries.map(entry => (\n          <CORLogRow\n            key={entry.id}\n            entry={entry}\n            isEditing={editingId === entry.id}\n            isSaving={savingId === entry.id}\n            onEdit={() => setEditingId(entry.id)}\n            onSave={(updates) => handleSave(entry.id, updates, entry.changeOrder.id)}\n            onCancel={() => setEditingId(null)}\n            statusDisplay={STATUS_DISPLAY}\n          />\n        ))}\n      </tbody>\n    </table>\n  )\n\n  return (\n    <div className=\"cor-log cor-log-expanded\">\n      {/* Header */}\n      <div className=\"cor-log-header\">\n        <div className=\"cor-log-title\">\n          <FileSpreadsheet size={20} />\n          <h3>Change Order Log</h3>\n          <span className=\"cor-log-count\">{logEntries.length} entries</span>\n        </div>\n        <div className=\"cor-log-actions\">\n          <button\n            className=\"btn btn-icon btn-ghost\"\n            onClick={handleRefresh}\n            disabled={refreshing}\n            title=\"Refresh\"\n          >\n            <RefreshCw size={16} className={refreshing ? 'spin' : ''} />\n          </button>\n          <button className=\"btn btn-secondary btn-small\" onClick={exportToExcel}>\n            <FileSpreadsheet size={14} /> Excel\n          </button>\n          <button className=\"btn btn-secondary btn-small\" onClick={exportToPDF}>\n            <FileText size={14} /> PDF\n          </button>\n        </div>\n      </div>\n\n      {/* Summary Cards */}\n      <div className=\"cor-log-summary-cards\">\n        <div className=\"summary-card pending\">\n          <Clock size={18} />\n          <div className=\"summary-card-content\">\n            <span className=\"summary-card-label\">Pending</span>\n            <span className=\"summary-card-count\">{summary.pendingCount} CORs</span>\n            <span className=\"summary-card-amount\">{formatCurrency(summary.pendingTotal)}</span>\n          </div>\n        </div>\n        <div className=\"summary-card approved\">\n          <CheckCircle size={18} />\n          <div className=\"summary-card-content\">\n            <span className=\"summary-card-label\">Approved</span>\n            <span className=\"summary-card-count\">{summary.approvedCount} CORs</span>\n            <span className=\"summary-card-amount\">{formatCurrency(summary.approvedTotal)}</span>\n          </div>\n        </div>\n        <div className=\"summary-card void\">\n          <XCircle size={18} />\n          <div className=\"summary-card-content\">\n            <span className=\"summary-card-label\">Void</span>\n            <span className=\"summary-card-count\">{summary.voidCount} CORs</span>\n            <span className=\"summary-card-amount\">{formatCurrency(summary.voidTotal)}</span>\n          </div>\n        </div>\n        <div className=\"summary-card total\">\n          <FileSpreadsheet size={18} />\n          <div className=\"summary-card-content\">\n            <span className=\"summary-card-label\">Total</span>\n            <span className=\"summary-card-count\">{summary.totalCORs} CORs</span>\n            <span className=\"summary-card-amount\">{formatCurrency(summary.grandTotal)}</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Content */}\n      {logEntries.length === 0 ? (\n        <div className=\"cor-log-empty\">\n          <FileSpreadsheet size={32} />\n          <p>No change orders in log</p>\n          <span>CORs will appear here as they are created</span>\n        </div>\n      ) : (\n        <div className=\"cor-log-sections\">\n          {/* Pending Section */}\n          {groupedEntries.pending.length > 0 && (\n            <div className=\"cor-log-section pending\">\n              <div className=\"cor-log-section-header\">\n                <Clock size={16} />\n                <h4>Pending Change Orders</h4>\n                <span className=\"section-count\">{groupedEntries.pending.length}</span>\n                <span className=\"section-total\">{formatCurrency(summary.pendingTotal)}</span>\n              </div>\n              <div className=\"cor-log-table-wrapper\">\n                {renderSectionTable(groupedEntries.pending)}\n              </div>\n            </div>\n          )}\n\n          {/* Approved Section */}\n          {groupedEntries.approved.length > 0 && (\n            <div className=\"cor-log-section approved\">\n              <div className=\"cor-log-section-header\">\n                <CheckCircle size={16} />\n                <h4>Approved Change Orders</h4>\n                <span className=\"section-count\">{groupedEntries.approved.length}</span>\n                <span className=\"section-total\">{formatCurrency(summary.approvedTotal)}</span>\n              </div>\n              <div className=\"cor-log-table-wrapper\">\n                {renderSectionTable(groupedEntries.approved)}\n              </div>\n            </div>\n          )}\n\n          {/* Void Section */}\n          {groupedEntries.voided.length > 0 && (\n            <div className=\"cor-log-section void\">\n              <div className=\"cor-log-section-header\">\n                <XCircle size={16} />\n                <h4>Void Change Orders</h4>\n                <span className=\"section-count\">{groupedEntries.voided.length}</span>\n                <span className=\"section-total\">{formatCurrency(summary.voidTotal)}</span>\n              </div>\n              <div className=\"cor-log-table-wrapper\">\n                {renderSectionTable(groupedEntries.voided)}\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n"],"file":"CORLog-C9QrFWAV.js"}